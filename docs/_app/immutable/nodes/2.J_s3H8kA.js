var mE=Object.defineProperty;var gE=(t,e,n)=>e in t?mE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Lr=(t,e,n)=>(gE(t,typeof e!="symbol"?e+"":e,n),n);import{y as Mu,s as Ca,c as Zl,z as xr,A as To,j as ku,u as Ql,g as Wl,a as $l,r as Gh,B as _o,C as bc,D as mu,o as wc,E as km,F as rc,e as ta,G as Nh,n as Ra,H as _E,b as Il,I as j0,J as H2,l as yE,K as op}from"../chunks/scheduler.I9_GjKIr.js";import{S as Ha,i as ja,s as _r,e as Pn,h as yr,c as Dn,d as rn,g as Ai,y as al,j as yn,z as jl,t as Fi,a as Xi,A as Vh,u as Cr,v as Rr,w as Tr,x as kr,r as af,m as Zr,q as Ba,n as za,B as ws,C as Ss,D as v_,E as x_,o as _i,k as Bi,b as Fs,f as Os,l as El,F as vE,G as $u,H as j2,I as dA,J as xE,K as bE,L as am,p as Fy}from"../chunks/index.uFRP6icT.js";import{w as of}from"../chunks/index.OKv3WG0v.js";const wE=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function gu(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function xa(t,e){const n={},c={},g={$$scope:1};let v=t.length;for(;v--;){const S=t[v],a=e[v];if(a){for(const N in S)N in a||(c[N]=1);for(const N in a)g[N]||(n[N]=a[N],g[N]=1);t[v]=a}else for(const N in S)g[N]=1}for(const S in c)S in n||(n[S]=void 0);return n}function qs(t){return typeof t=="object"&&t!==null?t:{}}var Oy=function(t,e){return Oy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,c){n.__proto__=c}||function(n,c){for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(n[g]=c[g])},Oy(t,e)};function A0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Oy(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var uu=function(){return uu=Object.assign||function(e){for(var n,c=1,g=arguments.length;c<g;c++){n=arguments[c];for(var v in n)Object.prototype.hasOwnProperty.call(n,v)&&(e[v]=n[v])}return e},uu.apply(this,arguments)};function ug(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],c=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&c>=t.length&&(t=void 0),{value:t&&t[c++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Z2(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var c=n.call(t),g,v=[],S;try{for(;(e===void 0||e-- >0)&&!(g=c.next()).done;)v.push(g.value)}catch(a){S={error:a}}finally{try{g&&!g.done&&(n=c.return)&&n.call(c)}finally{if(S)throw S.error}}return v}function SE(t,e,n){if(n||arguments.length===2)for(var c=0,g=e.length,v;c<g;c++)(v||!(c in e))&&(v||(v=Array.prototype.slice.call(e,0,c)),v[c]=e[c]);return t.concat(v||Array.prototype.slice.call(e))}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var f0=function(){function t(e){e===void 0&&(e={}),this.adapter=e}return Object.defineProperty(t,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}();/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function IE(t,e){if(t.closest)return t.closest(e);for(var n=t;n;){if(S3(n,e))return n;n=n.parentElement}return null}function S3(t,e){var n=t.matches||t.webkitMatchesSelector||t.msMatchesSelector;return n.call(t,e)}function EE(t){var e=t;if(e.offsetParent!==null)return e.scrollWidth;var n=e.cloneNode(!0);n.style.setProperty("position","absolute"),n.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(n);var c=n.scrollWidth;return document.documentElement.removeChild(n),c}const Rv=Object.freeze(Object.defineProperty({__proto__:null,closest:IE,estimateScrollWidth:EE,matches:S3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var CE={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var TE=function(t){A0(e,t);function e(n){var c=t.call(this,uu(uu({},e.defaultAdapter),n))||this;return c.shakeAnimationEndHandler=function(){c.handleShakeAnimationEnd()},c}return Object.defineProperty(e,"cssClasses",{get:function(){return CE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.getWidth=function(){return this.adapter.getWidth()},e.prototype.shake=function(n){var c=e.cssClasses.LABEL_SHAKE;n?this.adapter.addClass(c):this.adapter.removeClass(c)},e.prototype.float=function(n){var c=e.cssClasses,g=c.LABEL_FLOAT_ABOVE,v=c.LABEL_SHAKE;n?this.adapter.addClass(g):(this.adapter.removeClass(g),this.adapter.removeClass(v))},e.prototype.setRequired=function(n){var c=e.cssClasses.LABEL_REQUIRED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},e.prototype.handleShakeAnimationEnd=function(){var n=e.cssClasses.LABEL_SHAKE;this.adapter.removeClass(n)},e}(f0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Zd={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kE=function(t){A0(e,t);function e(n){var c=t.call(this,uu(uu({},e.defaultAdapter),n))||this;return c.transitionEndHandler=function(g){c.handleTransitionEnd(g)},c}return Object.defineProperty(e,"cssClasses",{get:function(){return Zd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},e.prototype.activate=function(){this.adapter.removeClass(Zd.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(Zd.LINE_RIPPLE_ACTIVE)},e.prototype.setRippleCenter=function(n){this.adapter.setStyle("transform-origin",n+"px center")},e.prototype.deactivate=function(){this.adapter.addClass(Zd.LINE_RIPPLE_DEACTIVATING)},e.prototype.handleTransitionEnd=function(n){var c=this.adapter.hasClass(Zd.LINE_RIPPLE_DEACTIVATING);n.propertyName==="opacity"&&c&&(this.adapter.removeClass(Zd.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(Zd.LINE_RIPPLE_DEACTIVATING))},e}(f0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ME={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},PE={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},Ym={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30},ou;(function(t){t[t.BOTTOM=1]="BOTTOM",t[t.CENTER=2]="CENTER",t[t.RIGHT=4]="RIGHT",t[t.FLIP_RTL=8]="FLIP_RTL"})(ou||(ou={}));var ep;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=4]="TOP_RIGHT",t[t.BOTTOM_LEFT=1]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",t[t.TOP_START=8]="TOP_START",t[t.TOP_END=12]="TOP_END",t[t.BOTTOM_START=9]="BOTTOM_START",t[t.BOTTOM_END=13]="BOTTOM_END"})(ep||(ep={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var G0,Yf,da={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};G0={},G0[""+da.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",G0[""+da.LIST_ITEM_CLASS]="mdc-list-item",G0[""+da.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",G0[""+da.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",G0[""+da.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",G0[""+da.ROOT]="mdc-list";var Kp=(Yf={},Yf[""+da.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",Yf[""+da.LIST_ITEM_CLASS]="mdc-deprecated-list-item",Yf[""+da.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",Yf[""+da.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",Yf[""+da.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",Yf[""+da.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",Yf[""+da.ROOT]="mdc-deprecated-list",Yf),q0={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+da.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+da.LIST_ITEM_CLASS+` a,
    .`+Kp[da.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Kp[da.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+da.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+da.LIST_ITEM_CLASS+` a,
    .`+da.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+da.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+Kp[da.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Kp[da.LIST_ITEM_CLASS]+` a,
    .`+Kp[da.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+Kp[da.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},au={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Hs={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},Sc=new Set;Sc.add(Hs.BACKSPACE);Sc.add(Hs.ENTER);Sc.add(Hs.SPACEBAR);Sc.add(Hs.PAGE_UP);Sc.add(Hs.PAGE_DOWN);Sc.add(Hs.END);Sc.add(Hs.HOME);Sc.add(Hs.ARROW_LEFT);Sc.add(Hs.ARROW_UP);Sc.add(Hs.ARROW_RIGHT);Sc.add(Hs.ARROW_DOWN);Sc.add(Hs.DELETE);Sc.add(Hs.ESCAPE);Sc.add(Hs.TAB);var $c={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},Ic=new Map;Ic.set($c.BACKSPACE,Hs.BACKSPACE);Ic.set($c.ENTER,Hs.ENTER);Ic.set($c.SPACEBAR,Hs.SPACEBAR);Ic.set($c.PAGE_UP,Hs.PAGE_UP);Ic.set($c.PAGE_DOWN,Hs.PAGE_DOWN);Ic.set($c.END,Hs.END);Ic.set($c.HOME,Hs.HOME);Ic.set($c.ARROW_LEFT,Hs.ARROW_LEFT);Ic.set($c.ARROW_UP,Hs.ARROW_UP);Ic.set($c.ARROW_RIGHT,Hs.ARROW_RIGHT);Ic.set($c.ARROW_DOWN,Hs.ARROW_DOWN);Ic.set($c.DELETE,Hs.DELETE);Ic.set($c.ESCAPE,Hs.ESCAPE);Ic.set($c.TAB,Hs.TAB);var W0=new Set;W0.add(Hs.PAGE_UP);W0.add(Hs.PAGE_DOWN);W0.add(Hs.END);W0.add(Hs.HOME);W0.add(Hs.ARROW_LEFT);W0.add(Hs.ARROW_UP);W0.add(Hs.ARROW_RIGHT);W0.add(Hs.ARROW_DOWN);function pu(t){var e=t.key;if(Sc.has(e))return e;var n=Ic.get(t.keyCode);return n||Hs.UNKNOWN}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var DE=["input","button","textarea","select"],Fh=function(t){var e=t.target;if(e){var n=(""+e.tagName).toLowerCase();DE.indexOf(n)===-1&&t.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function LE(){var t={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return t}function BE(t,e){for(var n=new Map,c=0;c<t;c++){var g=e(c).trim();if(g){var v=g[0].toLowerCase();n.has(v)||n.set(v,[]),n.get(v).push({text:g.toLowerCase(),index:c})}}return n.forEach(function(S){S.sort(function(a,N){return a.index-N.index})}),n}function Ny(t,e){var n=t.nextChar,c=t.focusItemAtIndex,g=t.sortedIndexByFirstChar,v=t.focusedItemIndex,S=t.skipFocus,a=t.isItemAtIndexDisabled;clearTimeout(e.bufferClearTimeout),e.bufferClearTimeout=setTimeout(function(){E3(e)},au.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),e.typeaheadBuffer=e.typeaheadBuffer+n;var N;return e.typeaheadBuffer.length===1?N=zE(g,v,a,e):N=RE(g,a,e),N!==-1&&!S&&c(N),N}function zE(t,e,n,c){var g=c.typeaheadBuffer[0],v=t.get(g);if(!v)return-1;if(g===c.currentFirstChar&&v[c.sortedIndexCursor].index===e){c.sortedIndexCursor=(c.sortedIndexCursor+1)%v.length;var S=v[c.sortedIndexCursor].index;if(!n(S))return S}c.currentFirstChar=g;var a=-1,N;for(N=0;N<v.length;N++)if(!n(v[N].index)){a=N;break}for(;N<v.length;N++)if(v[N].index>e&&!n(v[N].index)){a=N;break}return a!==-1?(c.sortedIndexCursor=a,v[c.sortedIndexCursor].index):-1}function RE(t,e,n){var c=n.typeaheadBuffer[0],g=t.get(c);if(!g)return-1;var v=g[n.sortedIndexCursor];if(v.text.lastIndexOf(n.typeaheadBuffer,0)===0&&!e(v.index))return v.index;for(var S=(n.sortedIndexCursor+1)%g.length,a=-1;S!==n.sortedIndexCursor;){var N=g[S],$=N.text.lastIndexOf(n.typeaheadBuffer,0)===0,he=!e(N.index);if($&&he){a=S;break}S=(S+1)%g.length}return a!==-1?(n.sortedIndexCursor=a,g[n.sortedIndexCursor].index):-1}function I3(t){return t.typeaheadBuffer.length>0}function E3(t){t.typeaheadBuffer=""}function Q2(t,e){var n=t.event,c=t.isTargetListItem,g=t.focusedItemIndex,v=t.focusItemAtIndex,S=t.sortedIndexByFirstChar,a=t.isItemAtIndexDisabled,N=pu(n)==="ArrowLeft",$=pu(n)==="ArrowUp",he=pu(n)==="ArrowRight",oe=pu(n)==="ArrowDown",ce=pu(n)==="Home",_e=pu(n)==="End",Ze=pu(n)==="Enter",nt=pu(n)==="Spacebar";if(n.altKey||n.ctrlKey||n.metaKey||N||$||he||oe||ce||_e||Ze)return-1;var Ke=!nt&&n.key.length===1;if(Ke){Fh(n);var st={focusItemAtIndex:v,focusedItemIndex:g,nextChar:n.key.toLowerCase(),sortedIndexByFirstChar:S,skipFocus:!1,isItemAtIndexDisabled:a};return Ny(st,e)}if(!nt)return-1;c&&Fh(n);var ht=c&&I3(e);if(ht){var st={focusItemAtIndex:v,focusedItemIndex:g,nextChar:" ",sortedIndexByFirstChar:S,skipFocus:!1,isItemAtIndexDisabled:a};return Ny(st,e)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function FE(t){return t instanceof Array}var OE=["Alt","Control","Meta","Shift"];function W2(t){var e=new Set(t?OE.filter(function(n){return t.getModifierState(n)}):[]);return function(n){return n.every(function(c){return e.has(c)})&&n.length===e.size}}var NE=function(t){A0(e,t);function e(n){var c=t.call(this,uu(uu({},e.defaultAdapter),n))||this;return c.wrapFocus=!1,c.isVertical=!0,c.isSingleSelectionList=!1,c.areDisabledItemsFocusable=!0,c.selectedIndex=au.UNSET_INDEX,c.focusedItemIndex=au.UNSET_INDEX,c.useActivatedClass=!1,c.useSelectedAttr=!1,c.ariaCurrentAttrValue=null,c.isCheckboxList=!1,c.isRadioList=!1,c.lastSelectedIndex=null,c.hasTypeahead=!1,c.typeaheadState=LE(),c.sortedIndexByFirstChar=new Map,c}return Object.defineProperty(e,"strings",{get:function(){return q0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return da},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return au},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),e.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},e.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},e.prototype.setWrapFocus=function(n){this.wrapFocus=n},e.prototype.setVerticalOrientation=function(n){this.isVertical=n},e.prototype.setSingleSelection=function(n){this.isSingleSelectionList=n,n&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},e.prototype.setDisabledItemsFocusable=function(n){this.areDisabledItemsFocusable=n},e.prototype.maybeInitializeSingleSelection=function(){var n=this.getSelectedIndexFromDOM();if(n!==au.UNSET_INDEX){var c=this.adapter.listItemAtIndexHasClass(n,da.LIST_ITEM_ACTIVATED_CLASS);c&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=n}},e.prototype.getSelectedIndexFromDOM=function(){for(var n=au.UNSET_INDEX,c=this.adapter.getListItemCount(),g=0;g<c;g++){var v=this.adapter.listItemAtIndexHasClass(g,da.LIST_ITEM_SELECTED_CLASS),S=this.adapter.listItemAtIndexHasClass(g,da.LIST_ITEM_ACTIVATED_CLASS);if(v||S){n=g;break}}return n},e.prototype.setHasTypeahead=function(n){this.hasTypeahead=n,n&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},e.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&I3(this.typeaheadState)},e.prototype.setUseActivatedClass=function(n){this.useActivatedClass=n},e.prototype.setUseSelectedAttribute=function(n){this.useSelectedAttr=n},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(n,c){c===void 0&&(c={}),this.isIndexValid(n)&&(this.isCheckboxList?this.setCheckboxAtIndex(n,c):this.isRadioList?this.setRadioAtIndex(n,c):this.setSingleSelectionAtIndex(n,c))},e.prototype.handleFocusIn=function(n){n>=0&&(this.focusedItemIndex=n,this.adapter.setAttributeForElementIndex(n,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(n,"0"))},e.prototype.handleFocusOut=function(n){var c=this;n>=0&&(this.adapter.setAttributeForElementIndex(n,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(n,"-1")),setTimeout(function(){c.adapter.isFocusInsideList()||c.setTabindexToFirstSelectedOrFocusedItem()},0)},e.prototype.isIndexDisabled=function(n){return this.adapter.listItemAtIndexHasClass(n,da.LIST_ITEM_DISABLED_CLASS)},e.prototype.handleKeydown=function(n,c,g){var v=this,S,a=pu(n)==="ArrowLeft",N=pu(n)==="ArrowUp",$=pu(n)==="ArrowRight",he=pu(n)==="ArrowDown",oe=pu(n)==="Home",ce=pu(n)==="End",_e=pu(n)==="Enter",Ze=pu(n)==="Spacebar",nt=this.isVertical&&he||!this.isVertical&&$,Ke=this.isVertical&&N||!this.isVertical&&a,st=n.key==="A"||n.key==="a",ht=W2(n);if(this.adapter.isRootFocused()){if((Ke||ce)&&ht([]))n.preventDefault(),this.focusLastElement();else if((nt||oe)&&ht([]))n.preventDefault(),this.focusFirstElement();else if(Ke&&ht(["Shift"])&&this.isCheckboxList){n.preventDefault();var xt=this.focusLastElement();xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}else if(nt&&ht(["Shift"])&&this.isCheckboxList){n.preventDefault();var xt=this.focusFirstElement();xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}if(this.hasTypeahead){var zt={event:n,focusItemAtIndex:function($t){v.focusItemAtIndex($t)},focusedItemIndex:-1,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function($t){return v.isIndexDisabled($t)}};Q2(zt,this.typeaheadState)}return}var Mt=this.adapter.getFocusedElementIndex();if(!(Mt===-1&&(Mt=g,Mt<0))){if(nt&&ht([]))Fh(n),this.focusNextElement(Mt);else if(Ke&&ht([]))Fh(n),this.focusPrevElement(Mt);else if(nt&&ht(["Shift"])&&this.isCheckboxList){Fh(n);var xt=this.focusNextElement(Mt);xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}else if(Ke&&ht(["Shift"])&&this.isCheckboxList){Fh(n);var xt=this.focusPrevElement(Mt);xt!==-1&&this.setSelectedIndexOnAction(xt,!1)}else if(oe&&ht([]))Fh(n),this.focusFirstElement();else if(ce&&ht([]))Fh(n),this.focusLastElement();else if(oe&&ht(["Control","Shift"])&&this.isCheckboxList){if(Fh(n),this.isIndexDisabled(Mt))return;this.focusFirstElement(),this.toggleCheckboxRange(0,Mt,Mt)}else if(ce&&ht(["Control","Shift"])&&this.isCheckboxList){if(Fh(n),this.isIndexDisabled(Mt))return;this.focusLastElement(),this.toggleCheckboxRange(Mt,this.adapter.getListItemCount()-1,Mt)}else if(st&&ht(["Control"])&&this.isCheckboxList)n.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===au.UNSET_INDEX?[]:this.selectedIndex,!0);else if((_e||Ze)&&ht([])){if(c){var Ue=n.target;if(Ue&&Ue.tagName==="A"&&_e||(Fh(n),this.isIndexDisabled(Mt)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(Mt,!1),this.adapter.notifyAction(Mt))}}else if((_e||Ze)&&ht(["Shift"])&&this.isCheckboxList){var Ue=n.target;if(Ue&&Ue.tagName==="A"&&_e||(Fh(n),this.isIndexDisabled(Mt)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((S=this.lastSelectedIndex)!==null&&S!==void 0?S:Mt,Mt,Mt),this.adapter.notifyAction(Mt))}if(this.hasTypeahead){var zt={event:n,focusItemAtIndex:function(rt){v.focusItemAtIndex(rt)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(rt){return v.isIndexDisabled(rt)}};Q2(zt,this.typeaheadState)}}},e.prototype.handleClick=function(n,c,g){var v,S=W2(g);n!==au.UNSET_INDEX&&(this.isIndexDisabled(n)||(S([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(n,c),this.adapter.notifyAction(n)):this.isCheckboxList&&S(["Shift"])&&(this.toggleCheckboxRange((v=this.lastSelectedIndex)!==null&&v!==void 0?v:n,n,n),this.adapter.notifyAction(n))))},e.prototype.focusNextElement=function(n){var c=this.adapter.getListItemCount(),g=n,v=null;do{if(g++,g>=c)if(this.wrapFocus)g=0;else return n;if(g===v)return-1;v=v??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},e.prototype.focusPrevElement=function(n){var c=this.adapter.getListItemCount(),g=n,v=null;do{if(g--,g<0)if(this.wrapFocus)g=c-1;else return n;if(g===v)return-1;v=v??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},e.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},e.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},e.prototype.focusInitialElement=function(){var n=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(n),n},e.prototype.setEnabled=function(n,c){this.isIndexValid(n,!1)&&(c?(this.adapter.removeClassForElementIndex(n,da.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,q0.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(n,da.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,q0.ARIA_DISABLED,"true")))},e.prototype.setSingleSelectionAtIndex=function(n,c){if(c===void 0&&(c={}),!(this.selectedIndex===n&&!c.forceUpdate)){var g=da.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(g=da.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==au.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,g),this.setAriaForSingleSelectionAtIndex(n),this.setTabindexAtIndex(n),n!==au.UNSET_INDEX&&this.adapter.addClassForElementIndex(n,g),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n])}},e.prototype.setAriaForSingleSelectionAtIndex=function(n){this.selectedIndex===au.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(n,q0.ARIA_CURRENT));var c=this.ariaCurrentAttrValue!==null,g=c?q0.ARIA_CURRENT:q0.ARIA_SELECTED;if(this.selectedIndex!==au.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),n!==au.UNSET_INDEX){var v=c?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(n,g,v)}},e.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?q0.ARIA_SELECTED:q0.ARIA_CHECKED},e.prototype.setRadioAtIndex=function(n,c){c===void 0&&(c={});var g=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(n,!0),!(this.selectedIndex===n&&!c.forceUpdate)&&(this.selectedIndex!==au.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),this.adapter.setAttributeForElementIndex(n,g,"true"),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n]))},e.prototype.setCheckboxAtIndex=function(n,c){c===void 0&&(c={});for(var g=this.selectedIndex,v=c.isUserInteraction?new Set(g===au.UNSET_INDEX?[]:g):null,S=this.getSelectionAttribute(),a=[],N=0;N<this.adapter.getListItemCount();N++){var $=v==null?void 0:v.has(N),he=n.indexOf(N)>=0;he!==$&&a.push(N),this.adapter.setCheckedCheckboxOrRadioAtIndex(N,he),this.adapter.setAttributeForElementIndex(N,S,he?"true":"false")}this.selectedIndex=n,c.isUserInteraction&&a.length&&this.adapter.notifySelectionChange(a)},e.prototype.toggleCheckboxRange=function(n,c,g){this.lastSelectedIndex=g;for(var v=new Set(this.selectedIndex===au.UNSET_INDEX?[]:this.selectedIndex),S=!(v!=null&&v.has(g)),a=Z2([n,c].sort(),2),N=a[0],$=a[1],he=this.getSelectionAttribute(),oe=[],ce=N;ce<=$;ce++)if(!this.isIndexDisabled(ce)){var _e=v.has(ce);S!==_e&&(oe.push(ce),this.adapter.setCheckedCheckboxOrRadioAtIndex(ce,S),this.adapter.setAttributeForElementIndex(ce,he,""+S),S?v.add(ce):v.delete(ce))}oe.length&&(this.selectedIndex=SE([],Z2(v)),this.adapter.notifySelectionChange(oe))},e.prototype.setTabindexAtIndex=function(n){this.focusedItemIndex===au.UNSET_INDEX&&n!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==n&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==n&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),n!==au.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(n,"tabindex","0")},e.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},e.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var n=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(n)},e.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==au.UNSET_INDEX?this.selectedIndex:FE(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(n,c){return Math.min(n,c)}):0:Math.max(this.focusedItemIndex,0)},e.prototype.isIndexValid=function(n,c){var g=this;if(c===void 0&&(c=!0),n instanceof Array){if(!this.isCheckboxList&&c)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return n.length===0?!0:n.some(function(v){return g.isIndexInRange(v)})}else if(typeof n=="number"){if(this.isCheckboxList&&c)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+n);return this.isIndexInRange(n)||this.isSingleSelectionList&&n===au.UNSET_INDEX}else return!1},e.prototype.isIndexInRange=function(n){var c=this.adapter.getListItemCount();return n>=0&&n<c},e.prototype.setSelectedIndexOnAction=function(n,c){this.lastSelectedIndex=n,this.isCheckboxList?(this.toggleCheckboxAtIndex(n,c),this.adapter.notifySelectionChange([n])):this.setSelectedIndex(n,{isUserInteraction:!0})},e.prototype.toggleCheckboxAtIndex=function(n,c){var g=this.getSelectionAttribute(),v=this.adapter.isCheckboxCheckedAtIndex(n),S;c?S=v:(S=!v,this.adapter.setCheckedCheckboxOrRadioAtIndex(n,S)),this.adapter.setAttributeForElementIndex(n,g,S?"true":"false");var a=this.selectedIndex===au.UNSET_INDEX?[]:this.selectedIndex.slice();S?a.push(n):a=a.filter(function(N){return N!==n}),this.selectedIndex=a},e.prototype.focusItemAtIndex=function(n){this.adapter.focusItemAtIndex(n),this.focusedItemIndex=n},e.prototype.checkboxListToggleAll=function(n,c){var g=this.adapter.getListItemCount();if(n.length===g)this.setCheckboxAtIndex([],{isUserInteraction:c});else{for(var v=[],S=0;S<g;S++)(!this.isIndexDisabled(S)||n.indexOf(S)>-1)&&v.push(S);this.setCheckboxAtIndex(v,{isUserInteraction:c})}},e.prototype.typeaheadMatchItem=function(n,c,g){var v=this;g===void 0&&(g=!1);var S={focusItemAtIndex:function(a){v.focusItemAtIndex(a)},focusedItemIndex:c||this.focusedItemIndex,nextChar:n,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:g,isItemAtIndexDisabled:function(a){return v.isIndexDisabled(a)}};return Ny(S,this.typeaheadState)},e.prototype.typeaheadInitSortedIndex=function(){return BE(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},e.prototype.clearTypeaheadBuffer=function(){E3(this.typeaheadState)},e}(f0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var C3=function(t){A0(e,t);function e(n){var c=t.call(this,uu(uu({},e.defaultAdapter),n))||this;return c.isSurfaceOpen=!1,c.isQuickOpen=!1,c.isHoistedElement=!1,c.isFixedPosition=!1,c.isHorizontallyCenteredOnViewport=!1,c.maxHeight=0,c.openBottomBias=0,c.openAnimationEndTimerId=0,c.closeAnimationEndTimerId=0,c.animationRequestId=0,c.anchorCorner=ep.TOP_START,c.originCorner=ep.TOP_START,c.anchorMargin={top:0,right:0,bottom:0,left:0},c.position={x:0,y:0},c}return Object.defineProperty(e,"cssClasses",{get:function(){return ME},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return PE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Ym},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Corner",{get:function(){return ep},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var n=e.cssClasses,c=n.ROOT,g=n.OPEN;if(!this.adapter.hasClass(c))throw new Error(c+" class required in root element.");this.adapter.hasClass(g)&&(this.isSurfaceOpen=!0)},e.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},e.prototype.setAnchorCorner=function(n){this.anchorCorner=n},e.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^ou.RIGHT},e.prototype.setAnchorMargin=function(n){this.anchorMargin.top=n.top||0,this.anchorMargin.right=n.right||0,this.anchorMargin.bottom=n.bottom||0,this.anchorMargin.left=n.left||0},e.prototype.setIsHoisted=function(n){this.isHoistedElement=n},e.prototype.setFixedPosition=function(n){this.isFixedPosition=n},e.prototype.isFixed=function(){return this.isFixedPosition},e.prototype.setAbsolutePosition=function(n,c){this.position.x=this.isFinite(n)?n:0,this.position.y=this.isFinite(c)?c:0},e.prototype.setIsHorizontallyCenteredOnViewport=function(n){this.isHorizontallyCenteredOnViewport=n},e.prototype.setQuickOpen=function(n){this.isQuickOpen=n},e.prototype.setMaxHeight=function(n){this.maxHeight=n},e.prototype.setOpenBottomBias=function(n){this.openBottomBias=n},e.prototype.isOpen=function(){return this.isSurfaceOpen},e.prototype.open=function(){var n=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(e.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(e.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(function(){n.dimensions=n.adapter.getInnerDimensions(),n.autoposition(),n.adapter.addClass(e.cssClasses.OPEN),n.openAnimationEndTimerId=setTimeout(function(){n.openAnimationEndTimerId=0,n.adapter.removeClass(e.cssClasses.ANIMATING_OPEN),n.adapter.notifyOpen()},Ym.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0))},e.prototype.close=function(n){var c=this;if(n===void 0&&(n=!1),!!this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen){this.isSurfaceOpen=!1,n||this.maybeRestoreFocus(),this.adapter.removeClass(e.cssClasses.OPEN),this.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(e.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(function(){c.adapter.removeClass(e.cssClasses.OPEN),c.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),c.closeAnimationEndTimerId=setTimeout(function(){c.closeAnimationEndTimerId=0,c.adapter.removeClass(e.cssClasses.ANIMATING_CLOSED),c.adapter.notifyClose()},Ym.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,n||this.maybeRestoreFocus()}},e.prototype.handleBodyClick=function(n){var c=n.target;this.adapter.isElementInContainer(c)||this.close()},e.prototype.handleKeydown=function(n){var c=n.keyCode,g=n.key,v=g==="Escape"||c===27;v&&this.close()},e.prototype.autoposition=function(){var n;this.measurements=this.getAutoLayoutmeasurements();var c=this.getoriginCorner(),g=this.getMenuSurfaceMaxHeight(c),v=this.hasBit(c,ou.BOTTOM)?"bottom":"top",S=this.hasBit(c,ou.RIGHT)?"right":"left",a=this.getHorizontalOriginOffset(c),N=this.getVerticalOriginOffset(c),$=this.measurements,he=$.anchorSize,oe=$.surfaceSize,ce=(n={},n[S]=a,n[v]=N,n);he.width/oe.width>Ym.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(S="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(ce),this.adapter.setTransformOrigin(S+" "+v),this.adapter.setPosition(ce),this.adapter.setMaxHeight(g?g+"px":""),this.hasBit(c,ou.BOTTOM)||this.adapter.addClass(e.cssClasses.IS_OPEN_BELOW)},e.prototype.getAutoLayoutmeasurements=function(){var n=this.adapter.getAnchorDimensions(),c=this.adapter.getBodyDimensions(),g=this.adapter.getWindowDimensions(),v=this.adapter.getWindowScroll();return n||(n={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:n,bodySize:c,surfaceSize:this.dimensions,viewportDistance:{top:n.top,right:g.width-n.right,bottom:g.height-n.bottom,left:n.left},viewportSize:g,windowScroll:v}},e.prototype.getoriginCorner=function(){var n=this.originCorner,c=this.measurements,g=c.viewportDistance,v=c.anchorSize,S=c.surfaceSize,a=e.numbers.MARGIN_TO_EDGE,N=this.hasBit(this.anchorCorner,ou.BOTTOM),$,he;N?($=g.top-a+this.anchorMargin.bottom,he=g.bottom-a-this.anchorMargin.bottom):($=g.top-a+this.anchorMargin.top,he=g.bottom-a+v.height-this.anchorMargin.top);var oe=he-S.height>0;!oe&&$>he+this.openBottomBias&&(n=this.setBit(n,ou.BOTTOM));var ce=this.adapter.isRtl(),_e=this.hasBit(this.anchorCorner,ou.FLIP_RTL),Ze=this.hasBit(this.anchorCorner,ou.RIGHT)||this.hasBit(n,ou.RIGHT),nt=!1;ce&&_e?nt=!Ze:nt=Ze;var Ke,st;nt?(Ke=g.left+v.width+this.anchorMargin.right,st=g.right-this.anchorMargin.right):(Ke=g.left+this.anchorMargin.left,st=g.right+v.width-this.anchorMargin.left);var ht=Ke-S.width>0,xt=st-S.width>0,zt=this.hasBit(n,ou.FLIP_RTL)&&this.hasBit(n,ou.RIGHT);return xt&&zt&&ce||!ht&&zt?n=this.unsetBit(n,ou.RIGHT):(ht&&nt&&ce||ht&&!nt&&Ze||!xt&&Ke>=st)&&(n=this.setBit(n,ou.RIGHT)),n},e.prototype.getMenuSurfaceMaxHeight=function(n){if(this.maxHeight>0)return this.maxHeight;var c=this.measurements.viewportDistance,g=0,v=this.hasBit(n,ou.BOTTOM),S=this.hasBit(this.anchorCorner,ou.BOTTOM),a=e.numbers.MARGIN_TO_EDGE;return v?(g=c.top+this.anchorMargin.top-a,S||(g+=this.measurements.anchorSize.height)):(g=c.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-a,S&&(g-=this.measurements.anchorSize.height)),g},e.prototype.getHorizontalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,ou.RIGHT),v=this.hasBit(this.anchorCorner,ou.RIGHT);if(g){var S=v?c.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?S-(this.measurements.viewportSize.width-this.measurements.bodySize.width):S}return v?c.width-this.anchorMargin.right:this.anchorMargin.left},e.prototype.getVerticalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,ou.BOTTOM),v=this.hasBit(this.anchorCorner,ou.BOTTOM),S=0;return g?S=v?c.height-this.anchorMargin.top:-this.anchorMargin.bottom:S=v?c.height+this.anchorMargin.bottom:this.anchorMargin.top,S},e.prototype.adjustPositionForHoistedElement=function(n){var c,g,v=this.measurements,S=v.windowScroll,a=v.viewportDistance,N=v.surfaceSize,$=v.viewportSize,he=Object.keys(n);try{for(var oe=ug(he),ce=oe.next();!ce.done;ce=oe.next()){var _e=ce.value,Ze=n[_e]||0;if(this.isHorizontallyCenteredOnViewport&&(_e==="left"||_e==="right")){n[_e]=($.width-N.width)/2;continue}Ze+=a[_e],this.isFixedPosition||(_e==="top"?Ze+=S.y:_e==="bottom"?Ze-=S.y:_e==="left"?Ze+=S.x:Ze-=S.x),n[_e]=Ze}}catch(nt){c={error:nt}}finally{try{ce&&!ce.done&&(g=oe.return)&&g.call(oe)}finally{if(c)throw c.error}}},e.prototype.maybeRestoreFocus=function(){var n=this,c=this.adapter.isFocused(),g=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,v=g.activeElement&&this.adapter.isElementInContainer(g.activeElement);(c||v)&&setTimeout(function(){n.adapter.restoreFocus()},Ym.TOUCH_EVENT_WAIT_MS)},e.prototype.hasBit=function(n,c){return!!(n&c)},e.prototype.setBit=function(n,c){return n|c},e.prototype.unsetBit=function(n,c){return n^c},e.prototype.isFinite=function(n){return typeof n=="number"&&isFinite(n)},e}(f0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var fm={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},Jp={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},VE={FOCUS_ROOT_INDEX:-1},om;(function(t){t[t.NONE=0]="NONE",t[t.LIST_ROOT=1]="LIST_ROOT",t[t.FIRST_ITEM=2]="FIRST_ITEM",t[t.LAST_ITEM=3]="LAST_ITEM"})(om||(om={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var UE=function(t){A0(e,t);function e(n){var c=t.call(this,uu(uu({},e.defaultAdapter),n))||this;return c.closeAnimationEndTimerId=0,c.defaultFocusState=om.LIST_ROOT,c.selectedIndex=-1,c}return Object.defineProperty(e,"cssClasses",{get:function(){return fm},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Jp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return VE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},e.prototype.handleKeydown=function(n){var c=n.key,g=n.keyCode,v=c==="Tab"||g===9;v&&this.adapter.closeSurface(!0)},e.prototype.handleItemAction=function(n){var c=this,g=this.adapter.getElementIndex(n);if(!(g<0)){this.adapter.notifySelected({index:g});var v=this.adapter.getAttributeFromElementAtIndex(g,Jp.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(v),this.closeAnimationEndTimerId=setTimeout(function(){var S=c.adapter.getElementIndex(n);S>=0&&c.adapter.isSelectableItemAtIndex(S)&&c.setSelectedIndex(S)},C3.numbers.TRANSITION_CLOSE_DURATION)}},e.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case om.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case om.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case om.NONE:break;default:this.adapter.focusListRoot();break}},e.prototype.setDefaultFocusState=function(n){this.defaultFocusState=n},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(n){if(this.validatedIndex(n),!this.adapter.isSelectableItemAtIndex(n))throw new Error("MDCMenuFoundation: No selection group at specified index.");var c=this.adapter.getSelectedSiblingOfItemAtIndex(n);c>=0&&(this.adapter.removeAttributeFromElementAtIndex(c,Jp.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(c,fm.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(n,fm.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(n,Jp.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=n},e.prototype.setEnabled=function(n,c){this.validatedIndex(n),c?(this.adapter.removeClassFromElementAtIndex(n,da.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Jp.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(n,da.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Jp.ARIA_DISABLED_ATTR,"true"))},e.prototype.validatedIndex=function(n){var c=this.adapter.getMenuItemCount(),g=n>=0&&n<c;if(!g)throw new Error("MDCMenuFoundation: No list item at specified index.")},e}(f0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var GE={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},$2={NOTCH_ELEMENT_PADDING:8},qE={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var HE=function(t){A0(e,t);function e(n){return t.call(this,uu(uu({},e.defaultAdapter),n))||this}return Object.defineProperty(e,"strings",{get:function(){return GE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return qE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return $2},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),e.prototype.notch=function(n){var c=e.cssClasses.OUTLINE_NOTCHED;n>0&&(n+=$2.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(n),this.adapter.addClass(c)},e.prototype.closeNotch=function(){var n=e.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(n),this.adapter.removeNotchWidthProperty()},e}(f0);/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function jE(t){return t===void 0&&(t=window),ZE(t)?{passive:!0}:!1}function ZE(t){t===void 0&&(t=window);var e=!1;try{var n={get passive(){return e=!0,!1}},c=function(){};t.document.addEventListener("test",c,n),t.document.removeEventListener("test",c,n)}catch{e=!1}return e}const QE=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:jE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var WE={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},$E={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},X2={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},jg;function XE(t,e){e===void 0&&(e=!1);var n=t.CSS,c=jg;if(typeof jg=="boolean"&&!e)return jg;var g=n&&typeof n.supports=="function";if(!g)return!1;var v=n.supports("--css-vars","yes"),S=n.supports("(--css-vars: yes)")&&n.supports("color","#00000000");return c=v||S,e||(jg=c),c}function YE(t,e,n){if(!t)return{x:0,y:0};var c=e.x,g=e.y,v=c+n.left,S=g+n.top,a,N;if(t.type==="touchstart"){var $=t;a=$.changedTouches[0].pageX-v,N=$.changedTouches[0].pageY-S}else{var he=t;a=he.pageX-v,N=he.pageY-S}return{x:a,y:N}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Y2=["touchstart","pointerdown","mousedown","keydown"],K2=["touchend","pointerup","mouseup","contextmenu"],Zg=[],KE=function(t){A0(e,t);function e(n){var c=t.call(this,uu(uu({},e.defaultAdapter),n))||this;return c.activationAnimationHasEnded=!1,c.activationTimer=0,c.fgDeactivationRemovalTimer=0,c.fgScale="0",c.frame={width:0,height:0},c.initialSize=0,c.layoutFrame=0,c.maxRadius=0,c.unboundedCoords={left:0,top:0},c.activationState=c.defaultActivationState(),c.activationTimerCallback=function(){c.activationAnimationHasEnded=!0,c.runDeactivationUXLogicIfReady()},c.activateHandler=function(g){c.activateImpl(g)},c.deactivateHandler=function(){c.deactivateImpl()},c.focusHandler=function(){c.handleFocus()},c.blurHandler=function(){c.handleBlur()},c.resizeHandler=function(){c.layout()},c}return Object.defineProperty(e,"cssClasses",{get:function(){return WE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return $E},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return X2},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var n=this,c=this.supportsPressRipple();if(this.registerRootHandlers(c),c){var g=e.cssClasses,v=g.ROOT,S=g.UNBOUNDED;requestAnimationFrame(function(){n.adapter.addClass(v),n.adapter.isUnbounded()&&(n.adapter.addClass(S),n.layoutInternal())})}},e.prototype.destroy=function(){var n=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(e.cssClasses.FG_DEACTIVATION));var c=e.cssClasses,g=c.ROOT,v=c.UNBOUNDED;requestAnimationFrame(function(){n.adapter.removeClass(g),n.adapter.removeClass(v),n.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},e.prototype.activate=function(n){this.activateImpl(n)},e.prototype.deactivate=function(){this.deactivateImpl()},e.prototype.layout=function(){var n=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){n.layoutInternal(),n.layoutFrame=0})},e.prototype.setUnbounded=function(n){var c=e.cssClasses.UNBOUNDED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},e.prototype.handleFocus=function(){var n=this;requestAnimationFrame(function(){return n.adapter.addClass(e.cssClasses.BG_FOCUSED)})},e.prototype.handleBlur=function(){var n=this;requestAnimationFrame(function(){return n.adapter.removeClass(e.cssClasses.BG_FOCUSED)})},e.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},e.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers=function(n){var c,g;if(n){try{for(var v=ug(Y2),S=v.next();!S.done;S=v.next()){var a=S.value;this.adapter.registerInteractionHandler(a,this.activateHandler)}}catch(N){c={error:N}}finally{try{S&&!S.done&&(g=v.return)&&g.call(v)}finally{if(c)throw c.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},e.prototype.registerDeactivationHandlers=function(n){var c,g;if(n.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var v=ug(K2),S=v.next();!S.done;S=v.next()){var a=S.value;this.adapter.registerDocumentInteractionHandler(a,this.deactivateHandler)}}catch(N){c={error:N}}finally{try{S&&!S.done&&(g=v.return)&&g.call(v)}finally{if(c)throw c.error}}},e.prototype.deregisterRootHandlers=function(){var n,c;try{for(var g=ug(Y2),v=g.next();!v.done;v=g.next()){var S=v.value;this.adapter.deregisterInteractionHandler(S,this.activateHandler)}}catch(a){n={error:a}}finally{try{v&&!v.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},e.prototype.deregisterDeactivationHandlers=function(){var n,c;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var g=ug(K2),v=g.next();!v.done;v=g.next()){var S=v.value;this.adapter.deregisterDocumentInteractionHandler(S,this.deactivateHandler)}}catch(a){n={error:a}}finally{try{v&&!v.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}},e.prototype.removeCssVars=function(){var n=this,c=e.strings,g=Object.keys(c);g.forEach(function(v){v.indexOf("VAR_")===0&&n.adapter.updateCssVariable(c[v],null)})},e.prototype.activateImpl=function(n){var c=this;if(!this.adapter.isSurfaceDisabled()){var g=this.activationState;if(!g.isActivated){var v=this.previousActivationEvent,S=v&&n!==void 0&&v.type!==n.type;if(!S){g.isActivated=!0,g.isProgrammatic=n===void 0,g.activationEvent=n,g.wasActivatedByPointer=g.isProgrammatic?!1:n!==void 0&&(n.type==="mousedown"||n.type==="touchstart"||n.type==="pointerdown");var a=n!==void 0&&Zg.length>0&&Zg.some(function(N){return c.adapter.containsEventTarget(N)});if(a){this.resetActivationState();return}n!==void 0&&(Zg.push(n.target),this.registerDeactivationHandlers(n)),g.wasElementMadeActive=this.checkElementMadeActive(n),g.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Zg=[],!g.wasElementMadeActive&&n!==void 0&&(n.key===" "||n.keyCode===32)&&(g.wasElementMadeActive=c.checkElementMadeActive(n),g.wasElementMadeActive&&c.animateActivation()),g.wasElementMadeActive||(c.activationState=c.defaultActivationState())})}}}},e.prototype.checkElementMadeActive=function(n){return n!==void 0&&n.type==="keydown"?this.adapter.isSurfaceActive():!0},e.prototype.animateActivation=function(){var n=this,c=e.strings,g=c.VAR_FG_TRANSLATE_START,v=c.VAR_FG_TRANSLATE_END,S=e.cssClasses,a=S.FG_DEACTIVATION,N=S.FG_ACTIVATION,$=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var he="",oe="";if(!this.adapter.isUnbounded()){var ce=this.getFgTranslationCoordinates(),_e=ce.startPoint,Ze=ce.endPoint;he=_e.x+"px, "+_e.y+"px",oe=Ze.x+"px, "+Ze.y+"px"}this.adapter.updateCssVariable(g,he),this.adapter.updateCssVariable(v,oe),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(a),this.adapter.computeBoundingRect(),this.adapter.addClass(N),this.activationTimer=setTimeout(function(){n.activationTimerCallback()},$)},e.prototype.getFgTranslationCoordinates=function(){var n=this.activationState,c=n.activationEvent,g=n.wasActivatedByPointer,v;g?v=YE(c,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):v={x:this.frame.width/2,y:this.frame.height/2},v={x:v.x-this.initialSize/2,y:v.y-this.initialSize/2};var S={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:v,endPoint:S}},e.prototype.runDeactivationUXLogicIfReady=function(){var n=this,c=e.cssClasses.FG_DEACTIVATION,g=this.activationState,v=g.hasDeactivationUXRun,S=g.isActivated,a=v||!S;a&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(c),this.fgDeactivationRemovalTimer=setTimeout(function(){n.adapter.removeClass(c)},X2.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses=function(){var n=e.cssClasses.FG_ACTIVATION;this.adapter.removeClass(n),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},e.prototype.resetActivationState=function(){var n=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return n.previousActivationEvent=void 0},e.numbers.TAP_DELAY_MS)},e.prototype.deactivateImpl=function(){var n=this,c=this.activationState;if(c.isActivated){var g=uu({},c);c.isProgrammatic?(requestAnimationFrame(function(){n.animateDeactivation(g)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){n.activationState.hasDeactivationUXRun=!0,n.animateDeactivation(g),n.resetActivationState()}))}},e.prototype.animateDeactivation=function(n){var c=n.wasActivatedByPointer,g=n.wasElementMadeActive;(c||g)&&this.runDeactivationUXLogicIfReady()},e.prototype.layoutInternal=function(){var n=this;this.frame=this.adapter.computeBoundingRect();var c=Math.max(this.frame.height,this.frame.width),g=function(){var S=Math.sqrt(Math.pow(n.frame.width,2)+Math.pow(n.frame.height,2));return S+e.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?c:g();var v=Math.floor(c*e.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&v%2!==0?this.initialSize=v-1:this.initialSize=v,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},e.prototype.updateLayoutCssVars=function(){var n=e.strings,c=n.VAR_FG_SIZE,g=n.VAR_LEFT,v=n.VAR_TOP,S=n.VAR_FG_SCALE;this.adapter.updateCssVariable(c,this.initialSize+"px"),this.adapter.updateCssVariable(S,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(g,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(v,this.unboundedCoords.top+"px"))},e}(f0);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Nl={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},z1={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},Qd={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var JE=function(t){A0(e,t);function e(n,c){c===void 0&&(c={});var g=t.call(this,uu(uu({},e.defaultAdapter),n))||this;return g.disabled=!1,g.isMenuOpen=!1,g.useDefaultValidation=!0,g.customValidity=!0,g.lastSelectedIndex=Qd.UNSET_INDEX,g.clickDebounceTimeout=0,g.recentlyClicked=!1,g.leadingIcon=c.leadingIcon,g.helperText=c.helperText,g}return Object.defineProperty(e,"cssClasses",{get:function(){return Nl},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Qd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return z1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),e.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},e.prototype.setSelectedIndex=function(n,c,g){c===void 0&&(c=!1),g===void 0&&(g=!1),!(n>=this.adapter.getMenuItemCount())&&(n===Qd.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(n).trim()),this.adapter.setSelectedIndex(n),c&&this.adapter.closeMenu(),!g&&this.lastSelectedIndex!==n&&this.handleChange(),this.lastSelectedIndex=n)},e.prototype.setValue=function(n,c){c===void 0&&(c=!1);var g=this.adapter.getMenuItemValues().indexOf(n);this.setSelectedIndex(g,!1,c)},e.prototype.getValue=function(){var n=this.adapter.getSelectedIndex(),c=this.adapter.getMenuItemValues();return n!==Qd.UNSET_INDEX?c[n]:""},e.prototype.getDisabled=function(){return this.disabled},e.prototype.setDisabled=function(n){this.disabled=n,this.disabled?(this.adapter.addClass(Nl.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(Nl.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},e.prototype.openMenu=function(){this.adapter.addClass(Nl.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},e.prototype.setHelperTextContent=function(n){this.helperText&&this.helperText.setContent(n)},e.prototype.layout=function(){if(this.adapter.hasLabel()){var n=this.getValue().length>0,c=this.adapter.hasClass(Nl.FOCUSED),g=n||c,v=this.adapter.hasClass(Nl.REQUIRED);this.notchOutline(g),this.adapter.floatLabel(g),this.adapter.setLabelRequired(v)}},e.prototype.layoutOptions=function(){var n=this.adapter.getMenuItemValues(),c=n.indexOf(this.getValue());this.setSelectedIndex(c,!1,!0)},e.prototype.handleMenuOpened=function(){if(this.adapter.getMenuItemValues().length!==0){var n=this.getSelectedIndex(),c=n>=0?n:0;this.adapter.focusMenuItemAtIndex(c)}},e.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},e.prototype.handleMenuClosed=function(){this.adapter.removeClass(Nl.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},e.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue());var n=this.adapter.hasClass(Nl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.handleMenuItemAction=function(n){this.setSelectedIndex(n,!0)},e.prototype.handleFocus=function(){this.adapter.addClass(Nl.FOCUSED),this.layout(),this.adapter.activateBottomLine()},e.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},e.prototype.handleClick=function(n){if(!(this.disabled||this.recentlyClicked)){if(this.setClickDebounceTimeout(),this.isMenuOpen){this.adapter.closeMenu();return}this.adapter.setRippleCenter(n),this.openMenu()}},e.prototype.handleKeydown=function(n){if(!(this.isMenuOpen||!this.adapter.hasClass(Nl.FOCUSED))){var c=pu(n)===Hs.ENTER,g=pu(n)===Hs.SPACEBAR,v=pu(n)===Hs.ARROW_UP,S=pu(n)===Hs.ARROW_DOWN,a=n.ctrlKey||n.metaKey;if(!a&&(!g&&n.key&&n.key.length===1||g&&this.adapter.isTypeaheadInProgress())){var N=g?" ":n.key,$=this.adapter.typeaheadMatchItem(N,this.getSelectedIndex());$>=0&&this.setSelectedIndex($),n.preventDefault();return}!c&&!g&&!v&&!S||(this.openMenu(),n.preventDefault())}},e.prototype.notchOutline=function(n){if(this.adapter.hasOutline()){var c=this.adapter.hasClass(Nl.FOCUSED);if(n){var g=Qd.LABEL_SCALE,v=this.adapter.getLabelWidth()*g;this.adapter.notchOutline(v)}else c||this.adapter.closeOutline()}},e.prototype.setLeadingIconAriaLabel=function(n){this.leadingIcon&&this.leadingIcon.setAriaLabel(n)},e.prototype.setLeadingIconContent=function(n){this.leadingIcon&&this.leadingIcon.setContent(n)},e.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},e.prototype.setUseDefaultValidation=function(n){this.useDefaultValidation=n},e.prototype.setValid=function(n){this.useDefaultValidation||(this.customValidity=n),this.adapter.setSelectAnchorAttr("aria-invalid",(!n).toString()),n?(this.adapter.removeClass(Nl.INVALID),this.adapter.removeMenuClass(Nl.MENU_INVALID)):(this.adapter.addClass(Nl.INVALID),this.adapter.addMenuClass(Nl.MENU_INVALID)),this.syncHelperTextValidity(n)},e.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(Nl.REQUIRED)&&!this.adapter.hasClass(Nl.DISABLED)?this.getSelectedIndex()!==Qd.UNSET_INDEX&&(this.getSelectedIndex()!==0||!!this.getValue()):this.customValidity},e.prototype.setRequired=function(n){n?this.adapter.addClass(Nl.REQUIRED):this.adapter.removeClass(Nl.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",n.toString()),this.adapter.setLabelRequired(n)},e.prototype.getRequired=function(){return this.adapter.getSelectAnchorAttr("aria-required")==="true"},e.prototype.init=function(){var n=this.adapter.getAnchorElement();n&&(this.adapter.setMenuAnchorElement(n),this.adapter.setMenuAnchorCorner(ep.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(Nl.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(Nl.INVALID)),this.layout(),this.layoutOptions()},e.prototype.blur=function(){this.adapter.removeClass(Nl.FOCUSED),this.layout(),this.adapter.deactivateBottomLine();var n=this.adapter.hasClass(Nl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.syncHelperTextValidity=function(n){if(this.helperText){this.helperText.setValidity(n);var c=this.helperText.isVisible(),g=this.helperText.getId();c&&g?this.adapter.setSelectAnchorAttr(z1.ARIA_DESCRIBEDBY,g):this.adapter.removeSelectAnchorAttr(z1.ARIA_DESCRIBEDBY)}},e.prototype.setClickDebounceTimeout=function(){var n=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout(function(){n.recentlyClicked=!1},Qd.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},e}(f0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Wd={ARIA_HIDDEN:"aria-hidden",ROLE:"role"},Kf={HELPER_TEXT_VALIDATION_MSG:"mdc-select-helper-text--validation-msg",HELPER_TEXT_VALIDATION_MSG_PERSISTENT:"mdc-select-helper-text--validation-msg-persistent"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var eC=function(t){A0(e,t);function e(n){return t.call(this,uu(uu({},e.defaultAdapter),n))||this}return Object.defineProperty(e,"cssClasses",{get:function(){return Kf},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Wd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},getAttr:function(){return null},removeAttr:function(){},setContent:function(){}}},enumerable:!1,configurable:!0}),e.prototype.getId=function(){return this.adapter.getAttr("id")},e.prototype.isVisible=function(){return this.adapter.getAttr(Wd.ARIA_HIDDEN)!=="true"},e.prototype.setContent=function(n){this.adapter.setContent(n)},e.prototype.setValidation=function(n){n?this.adapter.addClass(Kf.HELPER_TEXT_VALIDATION_MSG):this.adapter.removeClass(Kf.HELPER_TEXT_VALIDATION_MSG)},e.prototype.setValidationMsgPersistent=function(n){n?this.adapter.addClass(Kf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT):this.adapter.removeClass(Kf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},e.prototype.getIsValidation=function(){return this.adapter.hasClass(Kf.HELPER_TEXT_VALIDATION_MSG)},e.prototype.getIsValidationMsgPersistent=function(){return this.adapter.hasClass(Kf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},e.prototype.setValidity=function(n){var c=this.adapter.hasClass(Kf.HELPER_TEXT_VALIDATION_MSG);if(c){var g=this.adapter.hasClass(Kf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT),v=!n||g;if(v){this.showToScreenReader(),n?this.adapter.removeAttr(Wd.ROLE):this.adapter.setAttr(Wd.ROLE,"alert");return}this.adapter.removeAttr(Wd.ROLE),this.hide()}},e.prototype.showToScreenReader=function(){this.adapter.removeAttr(Wd.ARIA_HIDDEN)},e.prototype.hide=function(){this.adapter.setAttr(Wd.ARIA_HIDDEN,"true")},e}(f0);function Ps(t){return Object.entries(t).filter(([e,n])=>e!==""&&n).map(([e])=>e).join(" ")}function lu(t,e,n,c={bubbles:!0},g=!1){if(typeof Event>"u")throw new Error("Event not defined.");if(!t)throw new Error("Tried to dipatch event without element.");const v=new CustomEvent(e,Object.assign(Object.assign({},c),{detail:n}));if(t==null||t.dispatchEvent(v),g&&e.startsWith("SMUI")){const S=new CustomEvent(e.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},c),{detail:n}));t==null||t.dispatchEvent(S),S.defaultPrevented&&v.preventDefault()}return v}function J2(t,e){let n=Object.getOwnPropertyNames(t);const c={};for(let g=0;g<n.length;g++){const v=n[g],S=v.indexOf("$");S!==-1&&e.indexOf(v.substring(0,S+1))!==-1||e.indexOf(v)===-1&&(c[v]=t[v])}return c}const ex=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,tC=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function Ec(t){let e,n=[];t.$on=(g,v)=>{let S=g,a=()=>{};return e?a=e(S,v):n.push([S,v]),S.match(ex)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',S),()=>{a()}};function c(g){const v=t.$$.callbacks[g.type];v&&v.slice().forEach(S=>S.call(this,g))}return g=>{const v=[],S={};e=(a,N)=>{let $=a,he=N,oe=!1;const ce=$.match(ex),_e=$.match(tC),Ze=ce||_e;if($.match(/^SMUI:\w+:/)){const st=$.split(":");let ht="";for(let xt=0;xt<st.length;xt++)ht+=xt===st.length-1?":"+st[xt]:st[xt].split("-").map(zt=>zt.slice(0,1).toUpperCase()+zt.slice(1)).join("");console.warn(`The event ${$.split("$")[0]} has been renamed to ${ht.split("$")[0]}.`),$=ht}if(Ze){const st=$.split(ce?":":"$");$=st[0];const ht=st.slice(1).reduce((xt,zt)=>(xt[zt]=!0,xt),{});ht.passive&&(oe=oe||{},oe.passive=!0),ht.nonpassive&&(oe=oe||{},oe.passive=!1),ht.capture&&(oe=oe||{},oe.capture=!0),ht.once&&(oe=oe||{},oe.once=!0),ht.preventDefault&&(he=iC(he)),ht.stopPropagation&&(he=nC(he)),ht.stopImmediatePropagation&&(he=rC(he)),ht.self&&(he=sC(g,he)),ht.trusted&&(he=aC(he))}const nt=tx(g,$,he,oe),Ke=()=>{nt();const st=v.indexOf(Ke);st>-1&&v.splice(st,1)};return v.push(Ke),$ in S||(S[$]=tx(g,$,c)),Ke};for(let a=0;a<n.length;a++)e(n[a][0],n[a][1]);return{destroy:()=>{for(let a=0;a<v.length;a++)v[a]();for(let a of Object.entries(S))a[1]()}}}}function tx(t,e,n,c){return t.addEventListener(e,n,c),()=>t.removeEventListener(e,n,c)}function iC(t){return function(e){return e.preventDefault(),t.call(this,e)}}function nC(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function rC(t){return function(e){return e.stopImmediatePropagation(),t.call(this,e)}}function sC(t,e){return function(n){if(n.target===t)return e.call(this,n)}}function aC(t){return function(e){if(e.isTrusted)return t.call(this,e)}}function Sl(t,e){let n=Object.getOwnPropertyNames(t);const c={};for(let g=0;g<n.length;g++){const v=n[g];v.substring(0,e.length)===e&&(c[v.substring(e.length)]=t[v])}return c}function _c(t,e){let n=[];if(e)for(let c=0;c<e.length;c++){const g=e[c],v=Array.isArray(g)?g[0]:g;Array.isArray(g)&&g.length>1?n.push(v(t,g[1])):n.push(v(t))}return{update(c){if((c&&c.length||0)!=n.length)throw new Error("You must not change the length of an actions array.");if(c)for(let g=0;g<c.length;g++){const v=n[g];if(v&&v.update){const S=c[g];Array.isArray(S)&&S.length>1?v.update(S[1]):v.update()}}},destroy(){for(let c=0;c<n.length;c++){const g=n[c];g&&g.destroy&&g.destroy()}}}}const{applyPassive:Qg}=QE,{matches:oC}=Rv;function tp(t,{ripple:e=!0,surface:n=!1,unbounded:c=!1,disabled:g=!1,color:v,active:S,rippleElement:a,eventTarget:N,activeTarget:$,addClass:he=Ze=>t.classList.add(Ze),removeClass:oe=Ze=>t.classList.remove(Ze),addStyle:ce=(Ze,nt)=>t.style.setProperty(Ze,nt),initPromise:_e=Promise.resolve()}={}){let Ze,nt=Mu("SMUI:addLayoutListener"),Ke,st=S,ht=N,xt=$;function zt(){n?(he("mdc-ripple-surface"),v==="primary"?(he("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary")):v==="secondary"?(oe("smui-ripple-surface--primary"),he("smui-ripple-surface--secondary")):(oe("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary"))):(oe("mdc-ripple-surface"),oe("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary")),Ze&&st!==S&&(st=S,S?Ze.activate():S===!1&&Ze.deactivate()),e&&!Ze?(Ze=new KE({addClass:he,browserSupportsCssVars:()=>XE(window),computeBoundingRect:()=>(a||t).getBoundingClientRect(),containsEventTarget:Ue=>t.contains(Ue),deregisterDocumentInteractionHandler:(Ue,$t)=>document.documentElement.removeEventListener(Ue,$t,Qg()),deregisterInteractionHandler:(Ue,$t)=>(N||t).removeEventListener(Ue,$t,Qg()),deregisterResizeHandler:Ue=>window.removeEventListener("resize",Ue),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>S??oC($||t,":active"),isSurfaceDisabled:()=>!!g,isUnbounded:()=>!!c,registerDocumentInteractionHandler:(Ue,$t)=>document.documentElement.addEventListener(Ue,$t,Qg()),registerInteractionHandler:(Ue,$t)=>(N||t).addEventListener(Ue,$t,Qg()),registerResizeHandler:Ue=>window.addEventListener("resize",Ue),removeClass:oe,updateCssVariable:ce}),_e.then(()=>{Ze&&(Ze.init(),Ze.setUnbounded(c))})):Ze&&!e&&_e.then(()=>{Ze&&(Ze.destroy(),Ze=void 0)}),Ze&&(ht!==N||xt!==$)&&(ht=N,xt=$,Ze.destroy(),requestAnimationFrame(()=>{Ze&&(Ze.init(),Ze.setUnbounded(c))})),!e&&c&&he("mdc-ripple-upgraded--unbounded")}zt(),nt&&(Ke=nt(Mt));function Mt(){Ze&&Ze.layout()}return{update(Ue){({ripple:e,surface:n,unbounded:c,disabled:g,color:v,active:S,rippleElement:a,eventTarget:N,activeTarget:$,addClass:he,removeClass:oe,addStyle:ce,initPromise:_e}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:$t=>t.classList.add($t),removeClass:$t=>t.classList.remove($t),addStyle:($t,rt)=>t.style.setProperty($t,rt),initPromise:Promise.resolve()},Ue)),zt()},destroy(){Ze&&(Ze.destroy(),Ze=void 0,oe("mdc-ripple-surface"),oe("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary")),Ke&&Ke()}}}const{document:lC}=wE;function uC(t){let e,n,c,g,v,S,a,N;const $=t[34].default,he=Zl($,t,t[33],null);let oe=[{class:c=Ps({[t[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":t[4],"mdc-menu-surface--open":t[3],"smui-menu-surface--static":t[3],"mdc-menu-surface--fullwidth":t[5],...t[8]})},{style:g=Object.entries(t[9]).map(ix).concat([t[2]]).join(" ")},{role:"dialog"},t[12]],ce={};for(let _e=0;_e<oe.length;_e+=1)ce=xr(ce,oe[_e]);return{c(){e=_r(),n=Pn("div"),he&&he.c(),this.h()},l(_e){e=yr(_e),n=Dn(_e,"DIV",{class:!0,style:!0,role:!0});var Ze=rn(n);he&&he.l(Ze),Ze.forEach(Ai),this.h()},h(){al(n,ce)},m(_e,Ze){yn(_e,e,Ze),yn(_e,n,Ze),he&&he.m(n,null),t[35](n),S=!0,a||(N=[jl(lC.body,"click",t[11],!0),To(v=_c.call(null,n,t[0])),To(t[10].call(null,n)),jl(n,"keydown",function(){ku(t[7]&&t[7].handleKeydown.bind(t[7]))&&(t[7]&&t[7].handleKeydown.bind(t[7])).apply(this,arguments)})],a=!0)},p(_e,Ze){t=_e,he&&he.p&&(!S||Ze[1]&4)&&Ql(he,$,t,t[33],S?$l($,t[33],Ze,null):Wl(t[33]),null),al(n,ce=xa(oe,[(!S||Ze[0]&314&&c!==(c=Ps({[t[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":t[4],"mdc-menu-surface--open":t[3],"smui-menu-surface--static":t[3],"mdc-menu-surface--fullwidth":t[5],...t[8]})))&&{class:c},(!S||Ze[0]&516&&g!==(g=Object.entries(t[9]).map(ix).concat([t[2]]).join(" ")))&&{style:g},{role:"dialog"},Ze[0]&4096&&t[12]])),v&&ku(v.update)&&Ze[0]&1&&v.update.call(null,t[0])},i(_e){S||(Fi(he,_e),S=!0)},o(_e){Xi(he,_e),S=!1},d(_e){_e&&(Ai(e),Ai(n)),he&&he.d(_e),t[35](null),a=!1,Gh(N)}}}const ix=([t,e])=>`${t}: ${e};`;function cC(t,e,n){const c=["use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","isOpen","setOpen","setAbsolutePosition","setIsHoisted","isFixed","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e;var a,N,$;const he=Ec(bc());let{use:oe=[]}=e,{class:ce=""}=e,{style:_e=""}=e,{static:Ze=!1}=e,{anchor:nt=!0}=e,{fixed:Ke=!1}=e,{open:st=Ze}=e,{managed:ht=!1}=e,{fullWidth:xt=!1}=e,{quickOpen:zt=!1}=e,{anchorElement:Mt=void 0}=e,{anchorCorner:Ue=void 0}=e,{anchorMargin:$t={top:0,right:0,bottom:0,left:0}}=e,{maxHeight:rt=0}=e,{horizontallyCenteredOnViewport:gt=!1}=e,{openBottomBias:At=0}=e,{neverRestoreFocus:yt=!1}=e,St,ut,Ye={},_t={},ct;mu("SMUI:list:role","menu"),mu("SMUI:list:item:role","menuitem");const Ut=ep;wc(()=>(n(7,ut=new C3({addClass:Vt,removeClass:yi,hasClass:Ft,hasAnchor:()=>!!Mt,notifyClose:()=>{ht||n(13,st=Ze),st||lu(St,"SMUIMenuSurface:closed",void 0,void 0,!0)},notifyClosing:()=>{ht||n(13,st=Ze),st||lu(St,"SMUIMenuSurface:closing",void 0,void 0,!0)},notifyOpen:()=>{ht||n(13,st=!0),st&&lu(St,"SMUIMenuSurface:opened",void 0,void 0,!0)},notifyOpening:()=>{st||lu(St,"SMUIMenuSurface:opening",void 0,void 0,!0)},isElementInContainer:Oi=>St.contains(Oi),isRtl:()=>getComputedStyle(St).getPropertyValue("direction")==="rtl",setTransformOrigin:Oi=>{n(9,_t["transform-origin"]=Oi,_t)},isFocused:()=>document.activeElement===St,saveFocus:()=>{var Oi;ct=(Oi=document.activeElement)!==null&&Oi!==void 0?Oi:void 0},restoreFocus:()=>{!yt&&(!St||St.contains(document.activeElement))&&ct&&document.contains(ct)&&"focus"in ct&&ct.focus()},getInnerDimensions:()=>({width:St.offsetWidth,height:St.offsetHeight}),getAnchorDimensions:()=>Mt?Mt.getBoundingClientRect():null,getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:Oi=>{n(9,_t.left="left"in Oi?`${Oi.left}px`:"",_t),n(9,_t.right="right"in Oi?`${Oi.right}px`:"",_t),n(9,_t.top="top"in Oi?`${Oi.top}px`:"",_t),n(9,_t.bottom="bottom"in Oi?`${Oi.bottom}px`:"",_t)},setMaxHeight:Oi=>{n(9,_t["max-height"]=Oi,_t)}})),lu(St,"SMUIMenuSurface:mount",{get open(){return st},set open(Oi){n(13,st=Oi)},closeProgrammatic:Ci}),ut.init(),()=>{var Oi;const Vi=ut.isHoistedElement;ut.destroy(),Vi&&((Oi=St.parentNode)===null||Oi===void 0||Oi.removeChild(St))})),km(()=>{var gi;nt&&St&&((gi=St.parentElement)===null||gi===void 0||gi.classList.remove("mdc-menu-surface--anchor"))});function Ft(gi){return gi in Ye?Ye[gi]:xn().classList.contains(gi)}function Vt(gi){Ye[gi]||n(8,Ye[gi]=!0,Ye)}function yi(gi){(!(gi in Ye)||Ye[gi])&&n(8,Ye[gi]=!1,Ye)}function Ci(gi){ut.close(gi),n(13,st=!1)}function ki(gi){ut&&st&&!ht&&ut.handleBodyClick(gi)}function Ni(){return st}function tn(gi){n(13,st=gi)}function Zi(gi,Oi){return ut.setAbsolutePosition(gi,Oi)}function Gi(gi){return ut.setIsHoisted(gi)}function sn(){return ut.isFixed()}function xn(){return St}function Ti(gi){ta[gi?"unshift":"push"](()=>{St=gi,n(6,St)})}return t.$$set=gi=>{e=xr(xr({},e),rc(gi)),n(12,g=_o(e,c)),"use"in gi&&n(0,oe=gi.use),"class"in gi&&n(1,ce=gi.class),"style"in gi&&n(2,_e=gi.style),"static"in gi&&n(3,Ze=gi.static),"anchor"in gi&&n(15,nt=gi.anchor),"fixed"in gi&&n(4,Ke=gi.fixed),"open"in gi&&n(13,st=gi.open),"managed"in gi&&n(16,ht=gi.managed),"fullWidth"in gi&&n(5,xt=gi.fullWidth),"quickOpen"in gi&&n(17,zt=gi.quickOpen),"anchorElement"in gi&&n(14,Mt=gi.anchorElement),"anchorCorner"in gi&&n(18,Ue=gi.anchorCorner),"anchorMargin"in gi&&n(19,$t=gi.anchorMargin),"maxHeight"in gi&&n(20,rt=gi.maxHeight),"horizontallyCenteredOnViewport"in gi&&n(21,gt=gi.horizontallyCenteredOnViewport),"openBottomBias"in gi&&n(22,At=gi.openBottomBias),"neverRestoreFocus"in gi&&n(23,yt=gi.neverRestoreFocus),"$$scope"in gi&&n(33,S=gi.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1073774656|t.$$.dirty[1]&3&&St&&nt&&!(!(n(30,a=St.parentElement)===null||a===void 0)&&a.classList.contains("mdc-menu-surface--anchor"))&&(n(31,N=St.parentElement)===null||N===void 0||N.classList.add("mdc-menu-surface--anchor"),n(14,Mt=n(32,$=St.parentElement)!==null&&$!==void 0?$:void 0)),t.$$.dirty[0]&8320&&ut&&ut.isOpen()!==st&&(st?ut.open():ut.close()),t.$$.dirty[0]&131200&&ut&&ut.setQuickOpen(zt),t.$$.dirty[0]&144&&ut&&ut.setFixedPosition(Ke),t.$$.dirty[0]&1048704&&ut&&ut.setMaxHeight(rt),t.$$.dirty[0]&2097280&&ut&&ut.setIsHorizontallyCenteredOnViewport(gt),t.$$.dirty[0]&262272&&ut&&Ue!=null&&(typeof Ue=="string"?ut.setAnchorCorner(Ut[Ue]):ut.setAnchorCorner(Ue)),t.$$.dirty[0]&524416&&ut&&ut.setAnchorMargin($t),t.$$.dirty[0]&4194432&&ut&&ut.setOpenBottomBias(At)},[oe,ce,_e,Ze,Ke,xt,St,ut,Ye,_t,he,ki,g,st,Mt,nt,ht,zt,Ue,$t,rt,gt,At,yt,Ni,tn,Zi,Gi,sn,xn,a,N,$,S,v,Ti]}class hC extends Ha{constructor(e){super(),ja(this,e,cC,uC,Ca,{use:0,class:1,style:2,static:3,anchor:15,fixed:4,open:13,managed:16,fullWidth:5,quickOpen:17,anchorElement:14,anchorCorner:18,anchorMargin:19,maxHeight:20,horizontallyCenteredOnViewport:21,openBottomBias:22,neverRestoreFocus:23,isOpen:24,setOpen:25,setAbsolutePosition:26,setIsHoisted:27,isFixed:28,getElement:29},null,[-1,-1])}get isOpen(){return this.$$.ctx[24]}get setOpen(){return this.$$.ctx[25]}get setAbsolutePosition(){return this.$$.ctx[26]}get setIsHoisted(){return this.$$.ctx[27]}get isFixed(){return this.$$.ctx[28]}get getElement(){return this.$$.ctx[29]}}function AC(t,{addClass:e=c=>t.classList.add(c),removeClass:n=c=>t.classList.remove(c)}={}){return e("mdc-menu-surface--anchor"),{destroy(){n("mdc-menu-surface--anchor")}}}function fC(t){let e;const n=t[17].default,c=Zl(n,t,t[22],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v&4194304)&&Ql(c,n,g,g[22],e?$l(n,g[22],v,null):Wl(g[22]),null)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function dC(t){let e,n,c;const g=[{use:t[5]},{class:Ps({[t[1]]:!0,"mdc-menu":!0})},t[9]];function v(a){t[19](a)}let S={$$slots:{default:[fC]},$$scope:{ctx:t}};for(let a=0;a<g.length;a+=1)S=xr(S,g[a]);return t[0]!==void 0&&(S.open=t[0]),e=new hC({props:S}),t[18](e),ta.push(()=>Vh(e,"open",v)),e.$on("SMUIMenuSurface:mount",t[7]),e.$on("SMUIList:mount",t[8]),e.$on("SMUIMenuSurface:opened",t[20]),e.$on("keydown",t[6]),e.$on("SMUIList:action",t[21]),{c(){Cr(e.$$.fragment)},l(a){Rr(e.$$.fragment,a)},m(a,N){Tr(e,a,N),c=!0},p(a,[N]){const $=N&546?xa(g,[N&32&&{use:a[5]},N&2&&{class:Ps({[a[1]]:!0,"mdc-menu":!0})},N&512&&qs(a[9])]):{};N&4194304&&($.$$scope={dirty:N,ctx:a}),!n&&N&1&&(n=!0,$.open=a[0],Nh(()=>n=!1)),e.$set($)},i(a){c||(Fi(e.$$.fragment,a),c=!0)},o(a){Xi(e.$$.fragment,a),c=!1},d(a){t[18](null),kr(e,a)}}}function pC(t,e,n){let c;const g=["use","class","open","isOpen","setOpen","setDefaultFocusState","getSelectedIndex","getMenuSurface","getElement"];let v=_o(e,g),{$$slots:S={},$$scope:a}=e;const{closest:N}=Rv,$=Ec(bc());let{use:he=[]}=e,{class:oe=""}=e,{open:ce=!1}=e,_e,Ze,nt,Ke;wc(()=>(n(3,Ze=new UE({addClassToElementAtIndex:(Ye,_t)=>{Ke.addClassForElementIndex(Ye,_t)},removeClassFromElementAtIndex:(Ye,_t)=>{Ke.removeClassForElementIndex(Ye,_t)},addAttributeToElementAtIndex:(Ye,_t,ct)=>{Ke.setAttributeForElementIndex(Ye,_t,ct)},removeAttributeFromElementAtIndex:(Ye,_t)=>{Ke.removeAttributeForElementIndex(Ye,_t)},getAttributeFromElementAtIndex:(Ye,_t)=>Ke.getAttributeFromElementIndex(Ye,_t),elementContainsClass:(Ye,_t)=>Ye.classList.contains(_t),closeSurface:Ye=>{nt.closeProgrammatic(Ye),lu(gt(),"SMUIMenu:closedProgrammatically")},getElementIndex:Ye=>Ke.getOrderedList().map(_t=>_t.element).indexOf(Ye),notifySelected:Ye=>lu(gt(),"SMUIMenu:selected",{index:Ye.index,item:Ke.getOrderedList()[Ye.index].element},void 0,!0),getMenuItemCount:()=>Ke.items.length,focusItemAtIndex:Ye=>Ke.focusItemAtIndex(Ye),focusListRoot:()=>"focus"in Ke.element&&Ke.element.focus(),isSelectableItemAtIndex:Ye=>!!N(Ke.getOrderedList()[Ye].element,`.${fm.MENU_SELECTION_GROUP}`),getSelectedSiblingOfItemAtIndex:Ye=>{const _t=Ke.getOrderedList(),ct=N(_t[Ye].element,`.${fm.MENU_SELECTION_GROUP}`),Ut=ct==null?void 0:ct.querySelector(`.${fm.MENU_SELECTED_LIST_ITEM}`);return Ut?_t.map(Ft=>Ft.element).indexOf(Ut):-1}})),lu(gt(),"SMUIMenu:mount",Ze),Ze.init(),()=>{Ze.destroy()}));function st(Ye){Ze&&Ze.handleKeydown(Ye)}function ht(Ye){nt||(nt=Ye.detail)}function xt(Ye){Ke||n(4,Ke=Ye.detail)}function zt(){return ce}function Mt(Ye){n(0,ce=Ye)}function Ue(Ye){Ze.setDefaultFocusState(Ye)}function $t(){return Ze.getSelectedIndex()}function rt(){return _e}function gt(){return _e.getElement()}function At(Ye){ta[Ye?"unshift":"push"](()=>{_e=Ye,n(2,_e)})}function yt(Ye){ce=Ye,n(0,ce)}const St=()=>Ze&&Ze.handleMenuSurfaceOpened(),ut=Ye=>Ze&&Ze.handleItemAction(Ke.getOrderedList()[Ye.detail.index].element);return t.$$set=Ye=>{e=xr(xr({},e),rc(Ye)),n(9,v=_o(e,g)),"use"in Ye&&n(10,he=Ye.use),"class"in Ye&&n(1,oe=Ye.class),"open"in Ye&&n(0,ce=Ye.open),"$$scope"in Ye&&n(22,a=Ye.$$scope)},t.$$.update=()=>{t.$$.dirty&1024&&n(5,c=[$,...he])},[ce,oe,_e,Ze,Ke,c,st,ht,xt,v,he,zt,Mt,Ue,$t,rt,gt,S,At,yt,St,ut,a]}let mC=class extends Ha{constructor(e){super(),ja(this,e,pC,dC,Ca,{use:10,class:1,open:0,isOpen:11,setOpen:12,setDefaultFocusState:13,getSelectedIndex:14,getMenuSurface:15,getElement:16})}get isOpen(){return this.$$.ctx[11]}get setOpen(){return this.$$.ctx[12]}get setDefaultFocusState(){return this.$$.ctx[13]}get getSelectedIndex(){return this.$$.ctx[14]}get getMenuSurface(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}};function gC(t){let e;const n=t[10].default,c=Zl(n,t,t[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v&4096)&&Ql(c,n,g,g[12],e?$l(n,g[12],v,null):Wl(g[12]),null)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function _C(t){let e,n,c;const g=[{tag:t[3]},{use:[t[5],...t[0]]},{class:Ps({[t[1]]:!0,"mdc-button__label":t[6]==="button","mdc-fab__label":t[6]==="fab","mdc-tab__text-label":t[6]==="tab","mdc-image-list__label":t[6]==="image-list","mdc-snackbar__label":t[6]==="snackbar","mdc-banner__text":t[6]==="banner","mdc-segmented-button__label":t[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":t[6]==="data-table:pagination","mdc-data-table__header-cell-label":t[6]==="data-table:sortable-header-cell"})},t[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:t[7]},t[8]];var v=t[2];function S(a,N){let $={$$slots:{default:[gC]},$$scope:{ctx:a}};if(N!==void 0&&N&491)$=xa(g,[N&8&&{tag:a[3]},N&33&&{use:[a[5],...a[0]]},N&66&&{class:Ps({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},N&64&&qs(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),N&128&&{tabindex:a[7]},N&256&&qs(a[8])]);else for(let he=0;he<g.length;he+=1)$=xr($,g[he]);return{props:$}}return v&&(e=af(v,S(t)),t[11](e)),{c(){e&&Cr(e.$$.fragment),n=Zr()},l(a){e&&Rr(e.$$.fragment,a),n=Zr()},m(a,N){e&&Tr(e,a,N),yn(a,n,N),c=!0},p(a,[N]){if(N&4&&v!==(v=a[2])){if(e){Ba();const $=e;Xi($.$$.fragment,1,0,()=>{kr($,1)}),za()}v?(e=af(v,S(a,N)),a[11](e),Cr(e.$$.fragment),Fi(e.$$.fragment,1),Tr(e,n.parentNode,n)):e=null}else if(v){const $=N&491?xa(g,[N&8&&{tag:a[3]},N&33&&{use:[a[5],...a[0]]},N&66&&{class:Ps({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},N&64&&qs(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),N&128&&{tabindex:a[7]},N&256&&qs(a[8])]):{};N&4096&&($.$$scope={dirty:N,ctx:a}),e.$set($)}},i(a){c||(e&&Fi(e.$$.fragment,a),c=!0)},o(a){e&&Xi(e.$$.fragment,a),c=!1},d(a){a&&Ai(n),t[11](null),e&&kr(e,a)}}}function yC(t,e,n){const c=["use","class","component","tag","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e;const a=Ec(bc());let{use:N=[]}=e,{class:$=""}=e,he,{component:oe=lf}=e,{tag:ce=oe===lf?"span":void 0}=e;const _e=Mu("SMUI:label:context"),Ze=Mu("SMUI:label:tabindex");function nt(){return he.getElement()}function Ke(st){ta[st?"unshift":"push"](()=>{he=st,n(4,he)})}return t.$$set=st=>{e=xr(xr({},e),rc(st)),n(8,g=_o(e,c)),"use"in st&&n(0,N=st.use),"class"in st&&n(1,$=st.class),"component"in st&&n(2,oe=st.component),"tag"in st&&n(3,ce=st.tag),"$$scope"in st&&n(12,S=st.$$scope)},[N,$,oe,ce,he,a,_e,Ze,g,nt,v,Ke,S]}class vC extends Ha{constructor(e){super(),ja(this,e,yC,_C,Ca,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function xC(t){let e=t[1],n,c,g=t[1]&&R1(t);return{c(){g&&g.c(),n=Zr()},l(v){g&&g.l(v),n=Zr()},m(v,S){g&&g.m(v,S),yn(v,n,S),c=!0},p(v,S){v[1]?e?Ca(e,v[1])?(g.d(1),g=R1(v),e=v[1],g.c(),g.m(n.parentNode,n)):g.p(v,S):(g=R1(v),e=v[1],g.c(),g.m(n.parentNode,n)):e&&(g.d(1),g=null,e=v[1])},i(v){c||(Fi(g,v),c=!0)},o(v){Xi(g,v),c=!1},d(v){v&&Ai(n),g&&g.d(v)}}}function bC(t){let e=t[1],n,c=t[1]&&F1(t);return{c(){c&&c.c(),n=Zr()},l(g){c&&c.l(g),n=Zr()},m(g,v){c&&c.m(g,v),yn(g,n,v)},p(g,v){g[1]?e?Ca(e,g[1])?(c.d(1),c=F1(g),e=g[1],c.c(),c.m(n.parentNode,n)):c.p(g,v):(c=F1(g),e=g[1],c.c(),c.m(n.parentNode,n)):e&&(c.d(1),c=null,e=g[1])},i:Ra,o:Ra,d(g){g&&Ai(n),c&&c.d(g)}}}function wC(t){let e,n,c,g,v;const S=t[8].default,a=Zl(S,t,t[7],null);let N=[t[5]],$={};for(let he=0;he<N.length;he+=1)$=xr($,N[he]);return{c(){e=ws("svg"),a&&a.c(),this.h()},l(he){e=Ss(he,"svg",{});var oe=rn(e);a&&a.l(oe),oe.forEach(Ai),this.h()},h(){v_(e,$)},m(he,oe){yn(he,e,oe),a&&a.m(e,null),t[9](e),c=!0,g||(v=[To(n=_c.call(null,e,t[0])),To(t[4].call(null,e))],g=!0)},p(he,oe){a&&a.p&&(!c||oe&128)&&Ql(a,S,he,he[7],c?$l(S,he[7],oe,null):Wl(he[7]),null),v_(e,$=xa(N,[oe&32&&he[5]])),n&&ku(n.update)&&oe&1&&n.update.call(null,he[0])},i(he){c||(Fi(a,he),c=!0)},o(he){Xi(a,he),c=!1},d(he){he&&Ai(e),a&&a.d(he),t[9](null),g=!1,Gh(v)}}}function R1(t){let e,n,c,g,v;const S=t[8].default,a=Zl(S,t,t[7],null);let N=[t[5]],$={};for(let he=0;he<N.length;he+=1)$=xr($,N[he]);return{c(){e=Pn(t[1]),a&&a.c(),this.h()},l(he){e=Dn(he,(t[1]||"null").toUpperCase(),{});var oe=rn(e);a&&a.l(oe),oe.forEach(Ai),this.h()},h(){x_(t[1])(e,$)},m(he,oe){yn(he,e,oe),a&&a.m(e,null),t[11](e),c=!0,g||(v=[To(n=_c.call(null,e,t[0])),To(t[4].call(null,e))],g=!0)},p(he,oe){a&&a.p&&(!c||oe&128)&&Ql(a,S,he,he[7],c?$l(S,he[7],oe,null):Wl(he[7]),null),x_(he[1])(e,$=xa(N,[oe&32&&he[5]])),n&&ku(n.update)&&oe&1&&n.update.call(null,he[0])},i(he){c||(Fi(a,he),c=!0)},o(he){Xi(a,he),c=!1},d(he){he&&Ai(e),a&&a.d(he),t[11](null),g=!1,Gh(v)}}}function F1(t){let e,n,c,g,v=[t[5]],S={};for(let a=0;a<v.length;a+=1)S=xr(S,v[a]);return{c(){e=Pn(t[1]),this.h()},l(a){e=Dn(a,(t[1]||"null").toUpperCase(),{}),rn(e).forEach(Ai),this.h()},h(){x_(t[1])(e,S)},m(a,N){yn(a,e,N),t[10](e),c||(g=[To(n=_c.call(null,e,t[0])),To(t[4].call(null,e))],c=!0)},p(a,N){x_(a[1])(e,S=xa(v,[N&32&&a[5]])),n&&ku(n.update)&&N&1&&n.update.call(null,a[0])},d(a){a&&Ai(e),t[10](null),c=!1,Gh(g)}}}function SC(t){let e,n,c,g;const v=[wC,bC,xC],S=[];function a(N,$){return N[1]==="svg"?0:N[3]?1:2}return e=a(t),n=S[e]=v[e](t),{c(){n.c(),c=Zr()},l(N){n.l(N),c=Zr()},m(N,$){S[e].m(N,$),yn(N,c,$),g=!0},p(N,[$]){let he=e;e=a(N),e===he?S[e].p(N,$):(Ba(),Xi(S[he],1,1,()=>{S[he]=null}),za(),n=S[e],n?n.p(N,$):(n=S[e]=v[e](N),n.c()),Fi(n,1),n.m(c.parentNode,c))},i(N){g||(Fi(n),g=!0)},o(N){Xi(n),g=!1},d(N){N&&Ai(c),S[e].d(N)}}}function IC(t,e,n){let c;const g=["use","tag","getElement"];let v=_o(e,g),{$$slots:S={},$$scope:a}=e,{use:N=[]}=e,{tag:$}=e;const he=Ec(bc());let oe;function ce(){return oe}function _e(Ke){ta[Ke?"unshift":"push"](()=>{oe=Ke,n(2,oe)})}function Ze(Ke){ta[Ke?"unshift":"push"](()=>{oe=Ke,n(2,oe)})}function nt(Ke){ta[Ke?"unshift":"push"](()=>{oe=Ke,n(2,oe)})}return t.$$set=Ke=>{e=xr(xr({},e),rc(Ke)),n(5,v=_o(e,g)),"use"in Ke&&n(0,N=Ke.use),"tag"in Ke&&n(1,$=Ke.tag),"$$scope"in Ke&&n(7,a=Ke.$$scope)},t.$$.update=()=>{t.$$.dirty&2&&n(3,c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf($)>-1)},[N,$,oe,c,he,v,ce,a,S,_e,Ze,nt]}class lf extends Ha{constructor(e){super(),ja(this,e,IC,SC,Ca,{use:0,tag:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}function EC(t){let e;const n=t[11].default,c=Zl(n,t,t[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v&8192)&&Ql(c,n,g,g[13],e?$l(n,g[13],v,null):Wl(g[13]),null)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function CC(t){let e,n,c;const g=[{tag:t[3]},{use:[t[8],...t[0]]},{class:Ps({[t[1]]:!0,[t[6]]:!0,...t[5]})},t[7],t[9]];var v=t[2];function S(a,N){let $={$$slots:{default:[EC]},$$scope:{ctx:a}};if(N!==void 0&&N&1003)$=xa(g,[N&8&&{tag:a[3]},N&257&&{use:[a[8],...a[0]]},N&98&&{class:Ps({[a[1]]:!0,[a[6]]:!0,...a[5]})},N&128&&qs(a[7]),N&512&&qs(a[9])]);else for(let he=0;he<g.length;he+=1)$=xr($,g[he]);return{props:$}}return v&&(e=af(v,S(t)),t[12](e)),{c(){e&&Cr(e.$$.fragment),n=Zr()},l(a){e&&Rr(e.$$.fragment,a),n=Zr()},m(a,N){e&&Tr(e,a,N),yn(a,n,N),c=!0},p(a,[N]){if(N&4&&v!==(v=a[2])){if(e){Ba();const $=e;Xi($.$$.fragment,1,0,()=>{kr($,1)}),za()}v?(e=af(v,S(a,N)),a[12](e),Cr(e.$$.fragment),Fi(e.$$.fragment,1),Tr(e,n.parentNode,n)):e=null}else if(v){const $=N&1003?xa(g,[N&8&&{tag:a[3]},N&257&&{use:[a[8],...a[0]]},N&98&&{class:Ps({[a[1]]:!0,[a[6]]:!0,...a[5]})},N&128&&qs(a[7]),N&512&&qs(a[9])]):{};N&8192&&($.$$scope={dirty:N,ctx:a}),e.$set($)}},i(a){c||(e&&Fi(e.$$.fragment,a),c=!0)},o(a){e&&Xi(e.$$.fragment,a),c=!1},d(a){a&&Ai(n),t[12](null),e&&kr(e,a)}}}const r0={component:lf,tag:"div",class:"",classMap:{},contexts:{},props:{}};function TC(t,e,n){const c=["use","class","component","tag","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e,{use:a=[]}=e,{class:N=""}=e,$;const he=r0.class,oe={},ce=[],_e=r0.contexts,Ze=r0.props;let{component:nt=r0.component}=e,{tag:Ke=nt===lf?r0.tag:void 0}=e;Object.entries(r0.classMap).forEach(([zt,Mt])=>{const Ue=Mu(Mt);Ue&&"subscribe"in Ue&&ce.push(Ue.subscribe($t=>{n(5,oe[zt]=$t,oe)}))});const st=Ec(bc());for(let zt in _e)_e.hasOwnProperty(zt)&&mu(zt,_e[zt]);km(()=>{for(const zt of ce)zt()});function ht(){return $.getElement()}function xt(zt){ta[zt?"unshift":"push"](()=>{$=zt,n(4,$)})}return t.$$set=zt=>{e=xr(xr({},e),rc(zt)),n(9,g=_o(e,c)),"use"in zt&&n(0,a=zt.use),"class"in zt&&n(1,N=zt.class),"component"in zt&&n(2,nt=zt.component),"tag"in zt&&n(3,Ke=zt.tag),"$$scope"in zt&&n(13,S=zt.$$scope)},[a,N,nt,Ke,$,oe,he,Ze,st,g,ht,v,xt,S]}class kC extends Ha{constructor(e){super(),ja(this,e,TC,CC,Ca,{use:0,class:1,component:2,tag:3,getElement:10})}get getElement(){return this.$$.ctx[10]}}const nx=Object.assign({},r0);function mp(t){return new Proxy(kC,{construct:function(e,n){return Object.assign(r0,nx,t),new e(...n)},get:function(e,n){return Object.assign(r0,nx,t),e[n]}})}function MC(t){let e;const n=t[42].default,c=Zl(n,t,t[44],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v[1]&8192)&&Ql(c,n,g,g[44],e?$l(n,g[44],v,null):Wl(g[44]),null)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function PC(t){let e,n,c;const g=[{tag:t[13]},{use:[t[16],...t[0]]},{class:Ps({[t[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":t[2],"mdc-deprecated-list--dense":t[3],"mdc-deprecated-list--textual-list":t[4],"mdc-deprecated-list--avatar-list":t[5]||t[17],"mdc-deprecated-list--icon-list":t[6],"mdc-deprecated-list--image-list":t[7],"mdc-deprecated-list--thumbnail-list":t[8],"mdc-deprecated-list--video-list":t[9],"mdc-deprecated-list--two-line":t[10],"smui-list--three-line":t[11]&&!t[10]})},{role:t[15]},t[25]];var v=t[12];function S(a,N){let $={$$slots:{default:[MC]},$$scope:{ctx:a}};if(N!==void 0&&N[0]&33796095)$=xa(g,[N[0]&8192&&{tag:a[13]},N[0]&65537&&{use:[a[16],...a[0]]},N[0]&135166&&{class:Ps({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},N[0]&32768&&{role:a[15]},N[0]&33554432&&qs(a[25])]);else for(let he=0;he<g.length;he+=1)$=xr($,g[he]);return{props:$}}return v&&(e=af(v,S(t)),t[43](e),e.$on("keydown",t[20]),e.$on("focusin",t[21]),e.$on("focusout",t[22]),e.$on("click",t[23]),e.$on("SMUIListItem:mount",t[18]),e.$on("SMUIListItem:unmount",t[19]),e.$on("SMUI:action",t[24])),{c(){e&&Cr(e.$$.fragment),n=Zr()},l(a){e&&Rr(e.$$.fragment,a),n=Zr()},m(a,N){e&&Tr(e,a,N),yn(a,n,N),c=!0},p(a,N){if(N[0]&4096&&v!==(v=a[12])){if(e){Ba();const $=e;Xi($.$$.fragment,1,0,()=>{kr($,1)}),za()}v?(e=af(v,S(a,N)),a[43](e),e.$on("keydown",a[20]),e.$on("focusin",a[21]),e.$on("focusout",a[22]),e.$on("click",a[23]),e.$on("SMUIListItem:mount",a[18]),e.$on("SMUIListItem:unmount",a[19]),e.$on("SMUI:action",a[24]),Cr(e.$$.fragment),Fi(e.$$.fragment,1),Tr(e,n.parentNode,n)):e=null}else if(v){const $=N[0]&33796095?xa(g,[N[0]&8192&&{tag:a[13]},N[0]&65537&&{use:[a[16],...a[0]]},N[0]&135166&&{class:Ps({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},N[0]&32768&&{role:a[15]},N[0]&33554432&&qs(a[25])]):{};N[1]&8192&&($.$$scope={dirty:N,ctx:a}),e.$set($)}},i(a){c||(e&&Fi(e.$$.fragment,a),c=!0)},o(a){e&&Xi(e.$$.fragment,a),c=!1},d(a){a&&Ai(n),t[43](null),e&&kr(e,a)}}}function DC(t,e,n){const c=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","focusItemAtIndex","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e;var a;const{closest:N,matches:$}=Rv,he=Ec(bc());let{use:oe=[]}=e,{class:ce=""}=e,{nonInteractive:_e=!1}=e,{dense:Ze=!1}=e,{textualList:nt=!1}=e,{avatarList:Ke=!1}=e,{iconList:st=!1}=e,{imageList:ht=!1}=e,{thumbnailList:xt=!1}=e,{videoList:zt=!1}=e,{twoLine:Mt=!1}=e,{threeLine:Ue=!1}=e,{vertical:$t=!0}=e,{wrapFocus:rt=(a=Mu("SMUI:list:wrapFocus"))!==null&&a!==void 0?a:!1}=e,{singleSelection:gt=!1}=e,{disabledItemsFocusable:At=!1}=e,{selectedIndex:yt=-1}=e,{radioList:St=!1}=e,{checkList:ut=!1}=e,{hasTypeahead:Ye=!1}=e,_t,ct,Ut=[],Ft=Mu("SMUI:list:role"),Vt=Mu("SMUI:list:nav");const yi=new WeakMap;let Ci=Mu("SMUI:dialog:selection"),ki=Mu("SMUI:addLayoutListener"),Ni,{component:tn=lf}=e,{tag:Zi=tn===lf?Vt?"nav":"ul":void 0}=e;mu("SMUI:list:nonInteractive",_e),mu("SMUI:separator:context","list"),Ft||(gt?(Ft="listbox",mu("SMUI:list:item:role","option")):St?(Ft="radiogroup",mu("SMUI:list:item:role","radio")):ut?(Ft="group",mu("SMUI:list:item:role","checkbox")):(Ft="list",mu("SMUI:list:item:role",void 0))),ki&&(Ni=ki(Xn)),wc(()=>{n(41,ct=new NE({addClassForElementIndex:xi,focusItemAtIndex:M,getAttributeForElementIndex:(de,be)=>{var Ee,Ce;return(Ce=(Ee=bn()[de])===null||Ee===void 0?void 0:Ee.getAttr(be))!==null&&Ce!==void 0?Ce:null},getFocusedElementIndex:()=>document.activeElement?bn().map(de=>de.element).indexOf(document.activeElement):-1,getListItemCount:()=>Ut.length,getPrimaryTextAtIndex:oi,hasCheckboxAtIndex:de=>{var be,Ee;return(Ee=(be=bn()[de])===null||be===void 0?void 0:be.hasCheckbox)!==null&&Ee!==void 0?Ee:!1},hasRadioAtIndex:de=>{var be,Ee;return(Ee=(be=bn()[de])===null||be===void 0?void 0:be.hasRadio)!==null&&Ee!==void 0?Ee:!1},isCheckboxCheckedAtIndex:de=>{var be;const Ee=bn()[de];return(be=(Ee==null?void 0:Ee.hasCheckbox)&&Ee.checked)!==null&&be!==void 0?be:!1},isFocusInsideList:()=>_t!=null&&U()!==document.activeElement&&U().contains(document.activeElement),isRootFocused:()=>_t!=null&&document.activeElement===U(),listItemAtIndexHasClass:wn,notifyAction:de=>{n(26,yt=de),_t!=null&&lu(U(),"SMUIList:action",{index:de},void 0,!0)},notifySelectionChange:de=>{_t!=null&&lu(U(),"SMUIList:selectionChange",{changedIndices:de})},removeClassForElementIndex:Bn,setAttributeForElementIndex:Ot,setCheckedCheckboxOrRadioAtIndex:(de,be)=>{bn()[de].checked=be},setTabIndexForListItemChildren:(de,be)=>{const Ee=bn()[de];Array.prototype.forEach.call(Ee.element.querySelectorAll("button:not(:disabled), a"),Re=>{Re.setAttribute("tabindex",be)})}}));const ie={get element(){return U()},get items(){return Ut},get typeaheadInProgress(){return ct.isTypeaheadInProgress()},typeaheadMatchItem(de,be){return ct.typeaheadMatchItem(de,be,!0)},getOrderedList:bn,focusItemAtIndex:M,addClassForElementIndex:xi,removeClassForElementIndex:Bn,setAttributeForElementIndex:Ot,removeAttributeForElementIndex:an,getAttributeFromElementIndex:$n,getPrimaryTextAtIndex:oi};return lu(U(),"SMUIList:mount",ie),ct.init(),ct.layout(),()=>{ct.destroy()}}),km(()=>{Ni&&Ni()});function Gi(ie){Ut.push(ie.detail),yi.set(ie.detail.element,ie.detail),gt&&ie.detail.selected&&n(26,yt=Yi(ie.detail.element)),ie.stopPropagation()}function sn(ie){var de;const be=(de=ie.detail&&Ut.indexOf(ie.detail))!==null&&de!==void 0?de:-1;be!==-1&&(Ut.splice(be,1),Ut=Ut,yi.delete(ie.detail.element)),ie.stopPropagation()}function xn(ie){ct&&ie.target&&ct.handleKeydown(ie,ie.target.classList.contains("mdc-deprecated-list-item"),Yi(ie.target))}function Ti(ie){ct&&ie.target&&ct.handleFocusIn(Yi(ie.target))}function gi(ie){ct&&ie.target&&ct.handleFocusOut(Yi(ie.target))}function Oi(ie){ct&&ie.target&&ct.handleClick(Yi(ie.target),!$(ie.target,'input[type="checkbox"], input[type="radio"]'),ie)}function Vi(ie){if(St||ut){const de=Yi(ie.target);if(de!==-1){const be=bn()[de];be&&(St&&!be.checked||ut)&&($(ie.detail.target,'input[type="checkbox"], input[type="radio"]')||(be.checked=!be.checked),be.activateRipple(),window.requestAnimationFrame(()=>{be.deactivateRipple()}))}}}function bn(){return _t==null?[]:[...U().children].map(ie=>yi.get(ie)).filter(ie=>ie&&ie._smui_list_item_accessor)}function wn(ie,de){var be;const Ee=bn()[ie];return(be=Ee&&Ee.hasClass(de))!==null&&be!==void 0?be:!1}function xi(ie,de){const be=bn()[ie];be&&be.addClass(de)}function Bn(ie,de){const be=bn()[ie];be&&be.removeClass(de)}function Ot(ie,de,be){const Ee=bn()[ie];Ee&&Ee.addAttr(de,be)}function an(ie,de){const be=bn()[ie];be&&be.removeAttr(de)}function $n(ie,de){const be=bn()[ie];return be?be.getAttr(de):null}function oi(ie){var de;const be=bn()[ie];return(de=be&&be.getPrimaryText())!==null&&de!==void 0?de:""}function Yi(ie){const de=N(ie,".mdc-deprecated-list-item, .mdc-deprecated-list");return de&&$(de,".mdc-deprecated-list-item")?bn().map(be=>be==null?void 0:be.element).indexOf(de):-1}function Xn(){return ct.layout()}function zn(ie,de){return ct.setEnabled(ie,de)}function Wn(){return ct.isTypeaheadInProgress()}function _n(){return ct.getSelectedIndex()}function b(){return ct.getFocusedItemIndex()}function M(ie){const de=bn()[ie];de&&"focus"in de.element&&de.element.focus()}function U(){return _t.getElement()}function K(ie){ta[ie?"unshift":"push"](()=>{_t=ie,n(14,_t)})}return t.$$set=ie=>{e=xr(xr({},e),rc(ie)),n(25,g=_o(e,c)),"use"in ie&&n(0,oe=ie.use),"class"in ie&&n(1,ce=ie.class),"nonInteractive"in ie&&n(2,_e=ie.nonInteractive),"dense"in ie&&n(3,Ze=ie.dense),"textualList"in ie&&n(4,nt=ie.textualList),"avatarList"in ie&&n(5,Ke=ie.avatarList),"iconList"in ie&&n(6,st=ie.iconList),"imageList"in ie&&n(7,ht=ie.imageList),"thumbnailList"in ie&&n(8,xt=ie.thumbnailList),"videoList"in ie&&n(9,zt=ie.videoList),"twoLine"in ie&&n(10,Mt=ie.twoLine),"threeLine"in ie&&n(11,Ue=ie.threeLine),"vertical"in ie&&n(27,$t=ie.vertical),"wrapFocus"in ie&&n(28,rt=ie.wrapFocus),"singleSelection"in ie&&n(29,gt=ie.singleSelection),"disabledItemsFocusable"in ie&&n(30,At=ie.disabledItemsFocusable),"selectedIndex"in ie&&n(26,yt=ie.selectedIndex),"radioList"in ie&&n(31,St=ie.radioList),"checkList"in ie&&n(32,ut=ie.checkList),"hasTypeahead"in ie&&n(33,Ye=ie.hasTypeahead),"component"in ie&&n(12,tn=ie.component),"tag"in ie&&n(13,Zi=ie.tag),"$$scope"in ie&&n(44,S=ie.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&134217728|t.$$.dirty[1]&1024&&ct&&ct.setVerticalOrientation($t),t.$$.dirty[0]&268435456|t.$$.dirty[1]&1024&&ct&&ct.setWrapFocus(rt),t.$$.dirty[1]&1028&&ct&&ct.setHasTypeahead(Ye),t.$$.dirty[0]&536870912|t.$$.dirty[1]&1024&&ct&&ct.setSingleSelection(gt),t.$$.dirty[0]&1073741824|t.$$.dirty[1]&1024&&ct&&ct.setDisabledItemsFocusable(At),t.$$.dirty[0]&603979776|t.$$.dirty[1]&1024&&ct&&gt&&_n()!==yt&&ct.setSelectedIndex(yt)},[oe,ce,_e,Ze,nt,Ke,st,ht,xt,zt,Mt,Ue,tn,Zi,_t,Ft,he,Ci,Gi,sn,xn,Ti,gi,Oi,Vi,g,yt,$t,rt,gt,At,St,ut,Ye,Xn,zn,Wn,_n,b,M,U,ct,v,K,S]}class LC extends Ha{constructor(e){super(),ja(this,e,DC,PC,Ca,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:27,wrapFocus:28,singleSelection:29,disabledItemsFocusable:30,selectedIndex:26,radioList:31,checkList:32,hasTypeahead:33,component:12,tag:13,layout:34,setEnabled:35,getTypeaheadInProgress:36,getSelectedIndex:37,getFocusedItemIndex:38,focusItemAtIndex:39,getElement:40},null,[-1,-1])}get layout(){return this.$$.ctx[34]}get setEnabled(){return this.$$.ctx[35]}get getTypeaheadInProgress(){return this.$$.ctx[36]}get getSelectedIndex(){return this.$$.ctx[37]}get getFocusedItemIndex(){return this.$$.ctx[38]}get focusItemAtIndex(){return this.$$.ctx[39]}get getElement(){return this.$$.ctx[40]}}function rx(t){let e;return{c(){e=Pn("span"),this.h()},l(n){e=Dn(n,"SPAN",{class:!0}),rn(e).forEach(Ai),this.h()},h(){_i(e,"class","mdc-deprecated-list-item__ripple")},m(n,c){yn(n,e,c)},d(n){n&&Ai(e)}}}function BC(t){let e,n,c=t[7]&&rx();const g=t[34].default,v=Zl(g,t,t[37],null);return{c(){c&&c.c(),e=Zr(),v&&v.c()},l(S){c&&c.l(S),e=Zr(),v&&v.l(S)},m(S,a){c&&c.m(S,a),yn(S,e,a),v&&v.m(S,a),n=!0},p(S,a){S[7]?c||(c=rx(),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),v&&v.p&&(!n||a[1]&64)&&Ql(v,g,S,S[37],n?$l(g,S[37],a,null):Wl(S[37]),null)},i(S){n||(Fi(v,S),n=!0)},o(S){Xi(v,S),n=!1},d(S){S&&Ai(e),c&&c.d(S),v&&v.d(S)}}}function zC(t){let e,n,c;const g=[{tag:t[14]},{use:[...t[6]?[]:[[tp,{ripple:!t[16],unbounded:!1,color:(t[1]||t[0])&&t[5]==null?"primary":t[5],disabled:t[10],addClass:t[24],removeClass:t[25],addStyle:t[26]}]],t[22],...t[2]]},{class:Ps({[t[3]]:!0,"mdc-deprecated-list-item":!t[8],"mdc-deprecated-list-item__wrapper":t[8],"mdc-deprecated-list-item--activated":t[1],"mdc-deprecated-list-item--selected":t[0],"mdc-deprecated-list-item--disabled":t[10],"mdc-menu-item--selected":!t[23]&&t[9]==="menuitem"&&t[0],"smui-menu-item--non-interactive":t[6],...t[18]})},{style:Object.entries(t[19]).map(O1).concat([t[4]]).join(" ")},t[23]&&t[1]?{"aria-current":"page"}:{},!t[23]||t[8]?{role:t[9]}:{},!t[23]&&t[9]==="option"?{"aria-selected":t[0]?"true":"false"}:{},!t[23]&&(t[9]==="radio"||t[9]==="checkbox")?{"aria-checked":t[16]&&t[16].checked?"true":"false"}:{},t[23]?{}:{"aria-disabled":t[10]?"true":"false"},{"data-menu-item-skip-restore-focus":t[11]||void 0},{tabindex:t[21]},{href:t[12]},t[20],t[29]];var v=t[13];function S(a,N){let $={$$slots:{default:[BC]},$$scope:{ctx:a}};if(N!==void 0&&N[0]&670916479)$=xa(g,[N[0]&16384&&{tag:a[14]},N[0]&121701479&&{use:[...a[6]?[]:[[tp,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},N[0]&8652619&&{class:Ps({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},N[0]&524304&&{style:Object.entries(a[19]).map(O1).concat([a[4]]).join(" ")},N[0]&8388610&&qs(a[23]&&a[1]?{"aria-current":"page"}:{}),N[0]&8389376&&qs(!a[23]||a[8]?{role:a[9]}:{}),N[0]&8389121&&qs(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),N[0]&8454656&&qs(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),N[0]&8389632&&qs(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),N[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},N[0]&2097152&&{tabindex:a[21]},N[0]&4096&&{href:a[12]},N[0]&1048576&&qs(a[20]),N[0]&536870912&&qs(a[29])]);else for(let he=0;he<g.length;he+=1)$=xr($,g[he]);return{props:$}}return v&&(e=af(v,S(t)),t[35](e),e.$on("click",t[15]),e.$on("keydown",t[27]),e.$on("SMUIGenericInput:mount",t[28]),e.$on("SMUIGenericInput:unmount",t[36])),{c(){e&&Cr(e.$$.fragment),n=Zr()},l(a){e&&Rr(e.$$.fragment,a),n=Zr()},m(a,N){e&&Tr(e,a,N),yn(a,n,N),c=!0},p(a,N){if(N[0]&8192&&v!==(v=a[13])){if(e){Ba();const $=e;Xi($.$$.fragment,1,0,()=>{kr($,1)}),za()}v?(e=af(v,S(a,N)),a[35](e),e.$on("click",a[15]),e.$on("keydown",a[27]),e.$on("SMUIGenericInput:mount",a[28]),e.$on("SMUIGenericInput:unmount",a[36]),Cr(e.$$.fragment),Fi(e.$$.fragment,1),Tr(e,n.parentNode,n)):e=null}else if(v){const $=N[0]&670916479?xa(g,[N[0]&16384&&{tag:a[14]},N[0]&121701479&&{use:[...a[6]?[]:[[tp,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},N[0]&8652619&&{class:Ps({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},N[0]&524304&&{style:Object.entries(a[19]).map(O1).concat([a[4]]).join(" ")},N[0]&8388610&&qs(a[23]&&a[1]?{"aria-current":"page"}:{}),N[0]&8389376&&qs(!a[23]||a[8]?{role:a[9]}:{}),N[0]&8389121&&qs(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),N[0]&8454656&&qs(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),N[0]&8389632&&qs(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),N[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},N[0]&2097152&&{tabindex:a[21]},N[0]&4096&&{href:a[12]},N[0]&1048576&&qs(a[20]),N[0]&536870912&&qs(a[29])]):{};N[0]&128|N[1]&64&&($.$$scope={dirty:N,ctx:a}),e.$set($)}},i(a){c||(e&&Fi(e.$$.fragment,a),c=!0)},o(a){e&&Xi(e.$$.fragment,a),c=!1},d(a){a&&Ai(n),t[35](null),e&&kr(e,a)}}}let RC=0;const O1=([t,e])=>`${t}: ${e};`;function FC(t,e,n){let c;const g=["use","class","style","color","nonInteractive","ripple","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","action","getPrimaryText","getElement"];let v=_o(e,g),{$$slots:S={},$$scope:a}=e;var N;const $=Ec(bc());let he=()=>{};function oe(xi){return xi===he}let{use:ce=[]}=e,{class:_e=""}=e,{style:Ze=""}=e,{color:nt=void 0}=e,{nonInteractive:Ke=(N=Mu("SMUI:list:nonInteractive"))!==null&&N!==void 0?N:!1}=e;mu("SMUI:list:nonInteractive",void 0);let{ripple:st=!Ke}=e,{wrapper:ht=!1}=e,{activated:xt=!1}=e,{role:zt=ht?"presentation":Mu("SMUI:list:item:role")}=e;mu("SMUI:list:item:role",void 0);let{selected:Mt=!1}=e,{disabled:Ue=!1}=e,{skipRestoreFocus:$t=!1}=e,{tabindex:rt=he}=e,{inputId:gt="SMUI-form-field-list-"+RC++}=e,{href:At=void 0}=e,yt,St={},ut={},Ye={},_t,ct,Ut=Mu("SMUI:list:item:nav"),{component:Ft=lf}=e,{tag:Vt=Ft===lf?Ut?At?"a":"span":"li":void 0}=e;mu("SMUI:generic:input:props",{id:gt}),mu("SMUI:separator:context",void 0),wc(()=>{if(!Mt&&!Ke){let Bn=!0,Ot=yt.getElement();for(;Ot.previousSibling;)if(Ot=Ot.previousSibling,Ot.nodeType===1&&Ot.classList.contains("mdc-deprecated-list-item")&&!Ot.classList.contains("mdc-deprecated-list-item--disabled")){Bn=!1;break}Bn&&(ct=window.requestAnimationFrame(()=>sn(Ot)))}const xi={_smui_list_item_accessor:!0,get element(){return Vi()},get selected(){return Mt},set selected(Bn){n(0,Mt=Bn)},hasClass:yi,addClass:Ci,removeClass:ki,getAttr:tn,addAttr:Zi,removeAttr:Gi,getPrimaryText:Oi,get checked(){var Bn;return(Bn=_t&&_t.checked)!==null&&Bn!==void 0?Bn:!1},set checked(Bn){_t&&n(16,_t.checked=!!Bn,_t)},get hasCheckbox(){return!!(_t&&"_smui_checkbox_accessor"in _t)},get hasRadio(){return!!(_t&&"_smui_radio_accessor"in _t)},activateRipple(){_t&&_t.activateRipple()},deactivateRipple(){_t&&_t.deactivateRipple()},getValue(){return v.value},action:gi,get tabindex(){return c},set tabindex(Bn){n(30,rt=Bn)},get disabled(){return Ue},get activated(){return xt},set activated(Bn){n(1,xt=Bn)}};return lu(Vi(),"SMUIListItem:mount",xi),()=>{lu(Vi(),"SMUIListItem:unmount",xi)}}),km(()=>{ct&&window.cancelAnimationFrame(ct)});function yi(xi){return xi in St?St[xi]:Vi().classList.contains(xi)}function Ci(xi){St[xi]||n(18,St[xi]=!0,St)}function ki(xi){(!(xi in St)||St[xi])&&n(18,St[xi]=!1,St)}function Ni(xi,Bn){ut[xi]!=Bn&&(Bn===""||Bn==null?(delete ut[xi],n(19,ut)):n(19,ut[xi]=Bn,ut))}function tn(xi){var Bn;return xi in Ye?(Bn=Ye[xi])!==null&&Bn!==void 0?Bn:null:Vi().getAttribute(xi)}function Zi(xi,Bn){Ye[xi]!==Bn&&n(20,Ye[xi]=Bn,Ye)}function Gi(xi){(!(xi in Ye)||Ye[xi]!=null)&&n(20,Ye[xi]=void 0,Ye)}function sn(xi){let Bn=!0;for(;xi.nextElementSibling;)if(xi=xi.nextElementSibling,xi.nodeType===1&&xi.classList.contains("mdc-deprecated-list-item")){const Ot=xi.attributes.getNamedItem("tabindex");if(Ot&&Ot.value==="0"){Bn=!1;break}}Bn&&n(21,c=0)}function xn(xi){const Bn=xi.key==="Enter",Ot=xi.key==="Space";(Bn||Ot)&&gi(xi)}function Ti(xi){("_smui_checkbox_accessor"in xi.detail||"_smui_radio_accessor"in xi.detail)&&n(16,_t=xi.detail)}function gi(xi){Ue||lu(Vi(),"SMUI:action",xi)}function Oi(){var xi,Bn,Ot;const an=Vi(),$n=an.querySelector(".mdc-deprecated-list-item__primary-text");if($n)return(xi=$n.textContent)!==null&&xi!==void 0?xi:"";const oi=an.querySelector(".mdc-deprecated-list-item__text");return oi?(Bn=oi.textContent)!==null&&Bn!==void 0?Bn:"":(Ot=an.textContent)!==null&&Ot!==void 0?Ot:""}function Vi(){return yt.getElement()}function bn(xi){ta[xi?"unshift":"push"](()=>{yt=xi,n(17,yt)})}const wn=()=>n(16,_t=void 0);return t.$$set=xi=>{e=xr(xr({},e),rc(xi)),n(29,v=_o(e,g)),"use"in xi&&n(2,ce=xi.use),"class"in xi&&n(3,_e=xi.class),"style"in xi&&n(4,Ze=xi.style),"color"in xi&&n(5,nt=xi.color),"nonInteractive"in xi&&n(6,Ke=xi.nonInteractive),"ripple"in xi&&n(7,st=xi.ripple),"wrapper"in xi&&n(8,ht=xi.wrapper),"activated"in xi&&n(1,xt=xi.activated),"role"in xi&&n(9,zt=xi.role),"selected"in xi&&n(0,Mt=xi.selected),"disabled"in xi&&n(10,Ue=xi.disabled),"skipRestoreFocus"in xi&&n(11,$t=xi.skipRestoreFocus),"tabindex"in xi&&n(30,rt=xi.tabindex),"inputId"in xi&&n(31,gt=xi.inputId),"href"in xi&&n(12,At=xi.href),"component"in xi&&n(13,Ft=xi.component),"tag"in xi&&n(14,Vt=xi.tag),"$$scope"in xi&&n(37,a=xi.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1073808449&&n(21,c=oe(rt)?!Ke&&!Ue&&(Mt||_t&&_t.checked)?0:-1:rt)},[Mt,xt,ce,_e,Ze,nt,Ke,st,ht,zt,Ue,$t,At,Ft,Vt,gi,_t,yt,St,ut,Ye,c,$,Ut,Ci,ki,Ni,xn,Ti,v,rt,gt,Oi,Vi,S,bn,wn,a]}class OC extends Ha{constructor(e){super(),ja(this,e,FC,zC,Ca,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,wrapper:8,activated:1,role:9,selected:0,disabled:10,skipRestoreFocus:11,tabindex:30,inputId:31,href:12,component:13,tag:14,action:15,getPrimaryText:32,getElement:33},null,[-1,-1])}get action(){return this.$$.ctx[15]}get getPrimaryText(){return this.$$.ctx[32]}get getElement(){return this.$$.ctx[33]}}mp({class:"mdc-deprecated-list-item__text",tag:"span"});mp({class:"mdc-deprecated-list-item__primary-text",tag:"span"});mp({class:"mdc-deprecated-list-item__secondary-text",tag:"span"});function NC(t){let e,n,c,g,v,S;const a=t[8].default,N=Zl(a,t,t[7],null);let $=[{class:n=Ps({[t[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":t[4]})},t[5]],he={};for(let oe=0;oe<$.length;oe+=1)he=xr(he,$[oe]);return{c(){e=Pn("span"),N&&N.c(),this.h()},l(oe){e=Dn(oe,"SPAN",{class:!0});var ce=rn(e);N&&N.l(ce),ce.forEach(Ai),this.h()},h(){al(e,he)},m(oe,ce){yn(oe,e,ce),N&&N.m(e,null),t[9](e),g=!0,v||(S=[To(c=_c.call(null,e,t[0])),To(t[3].call(null,e))],v=!0)},p(oe,[ce]){N&&N.p&&(!g||ce&128)&&Ql(N,a,oe,oe[7],g?$l(a,oe[7],ce,null):Wl(oe[7]),null),al(e,he=xa($,[(!g||ce&2&&n!==(n=Ps({[oe[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":oe[4]})))&&{class:n},ce&32&&oe[5]])),c&&ku(c.update)&&ce&1&&c.update.call(null,oe[0])},i(oe){g||(Fi(N,oe),g=!0)},o(oe){Xi(N,oe),g=!1},d(oe){oe&&Ai(e),N&&N.d(oe),t[9](null),v=!1,Gh(S)}}}function VC(t,e,n){const c=["use","class","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e;const a=Ec(bc());let{use:N=[]}=e,{class:$=""}=e,he,oe=Mu("SMUI:list:graphic:menu-selection-group");function ce(){return he}function _e(Ze){ta[Ze?"unshift":"push"](()=>{he=Ze,n(2,he)})}return t.$$set=Ze=>{e=xr(xr({},e),rc(Ze)),n(5,g=_o(e,c)),"use"in Ze&&n(0,N=Ze.use),"class"in Ze&&n(1,$=Ze.class),"$$scope"in Ze&&n(7,S=Ze.$$scope)},[N,$,he,a,oe,g,ce,S,v,_e]}class UC extends Ha{constructor(e){super(),ja(this,e,VC,NC,Ca,{use:0,class:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}mp({class:"mdc-deprecated-list-item__meta",tag:"span"});mp({class:"mdc-deprecated-list-group",tag:"div"});mp({class:"mdc-deprecated-list-group__subheader",tag:"h3"});mp({class:"mdc-menu__selection-group-icon",component:UC});function GC(t){let e,n,c,g,v,S,a,N;const $=t[22].default,he=Zl($,t,t[21],null);let oe=[{class:n=Ps({[t[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":t[0],"mdc-floating-label--required":t[1],...t[8]})},{style:c=Object.entries(t[9]).map(ax).concat([t[4]]).join(" ")},{for:g=t[5]||(t[11]?t[11].id:void 0)},t[12]],ce={};for(let _e=0;_e<oe.length;_e+=1)ce=xr(ce,oe[_e]);return{c(){e=Pn("label"),he&&he.c(),this.h()},l(_e){e=Dn(_e,"LABEL",{class:!0,style:!0,for:!0});var Ze=rn(e);he&&he.l(Ze),Ze.forEach(Ai),this.h()},h(){al(e,ce)},m(_e,Ze){yn(_e,e,Ze),he&&he.m(e,null),t[24](e),S=!0,a||(N=[To(v=_c.call(null,e,t[2])),To(t[10].call(null,e))],a=!0)},p(_e,Ze){he&&he.p&&(!S||Ze&2097152)&&Ql(he,$,_e,_e[21],S?$l($,_e[21],Ze,null):Wl(_e[21]),null),al(e,ce=xa(oe,[(!S||Ze&267&&n!==(n=Ps({[_e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":_e[0],"mdc-floating-label--required":_e[1],..._e[8]})))&&{class:n},(!S||Ze&528&&c!==(c=Object.entries(_e[9]).map(ax).concat([_e[4]]).join(" ")))&&{style:c},(!S||Ze&32&&g!==(g=_e[5]||(_e[11]?_e[11].id:void 0)))&&{for:g},Ze&4096&&_e[12]])),v&&ku(v.update)&&Ze&4&&v.update.call(null,_e[2])},i(_e){S||(Fi(he,_e),S=!0)},o(_e){Xi(he,_e),S=!1},d(_e){_e&&Ai(e),he&&he.d(_e),t[24](null),a=!1,Gh(N)}}}function qC(t){let e,n,c,g,v,S,a;const N=t[22].default,$=Zl(N,t,t[21],null);let he=[{class:n=Ps({[t[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":t[0],"mdc-floating-label--required":t[1],...t[8]})},{style:c=Object.entries(t[9]).map(sx).concat([t[4]]).join(" ")},t[12]],oe={};for(let ce=0;ce<he.length;ce+=1)oe=xr(oe,he[ce]);return{c(){e=Pn("span"),$&&$.c(),this.h()},l(ce){e=Dn(ce,"SPAN",{class:!0,style:!0});var _e=rn(e);$&&$.l(_e),_e.forEach(Ai),this.h()},h(){al(e,oe)},m(ce,_e){yn(ce,e,_e),$&&$.m(e,null),t[23](e),v=!0,S||(a=[To(g=_c.call(null,e,t[2])),To(t[10].call(null,e))],S=!0)},p(ce,_e){$&&$.p&&(!v||_e&2097152)&&Ql($,N,ce,ce[21],v?$l(N,ce[21],_e,null):Wl(ce[21]),null),al(e,oe=xa(he,[(!v||_e&267&&n!==(n=Ps({[ce[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":ce[0],"mdc-floating-label--required":ce[1],...ce[8]})))&&{class:n},(!v||_e&528&&c!==(c=Object.entries(ce[9]).map(sx).concat([ce[4]]).join(" ")))&&{style:c},_e&4096&&ce[12]])),g&&ku(g.update)&&_e&4&&g.update.call(null,ce[2])},i(ce){v||(Fi($,ce),v=!0)},o(ce){Xi($,ce),v=!1},d(ce){ce&&Ai(e),$&&$.d(ce),t[23](null),S=!1,Gh(a)}}}function HC(t){let e,n,c,g;const v=[qC,GC],S=[];function a(N,$){return N[6]?0:1}return e=a(t),n=S[e]=v[e](t),{c(){n.c(),c=Zr()},l(N){n.l(N),c=Zr()},m(N,$){S[e].m(N,$),yn(N,c,$),g=!0},p(N,[$]){let he=e;e=a(N),e===he?S[e].p(N,$):(Ba(),Xi(S[he],1,1,()=>{S[he]=null}),za(),n=S[e],n?n.p(N,$):(n=S[e]=v[e](N),n.c()),Fi(n,1),n.m(c.parentNode,c))},i(N){g||(Fi(n),g=!0)},o(N){Xi(n),g=!1},d(N){N&&Ai(c),S[e].d(N)}}}const sx=([t,e])=>`${t}: ${e};`,ax=([t,e])=>`${t}: ${e};`;function jC(t,e,n){const c=["use","class","style","for","floatAbove","required","wrapped","shake","float","setRequired","getWidth","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e;var a;const N=Ec(bc());let{use:$=[]}=e,{class:he=""}=e,{style:oe=""}=e,{for:ce=void 0}=e,{floatAbove:_e=!1}=e,{required:Ze=!1}=e,{wrapped:nt=!1}=e,Ke,st,ht={},xt={},zt=(a=Mu("SMUI:generic:input:props"))!==null&&a!==void 0?a:{},Mt=_e,Ue=Ze;wc(()=>{n(18,st=new TE({addClass:$t,removeClass:rt,getWidth:()=>{var Vt,yi;const Ci=_t(),ki=Ci.cloneNode(!0);(Vt=Ci.parentNode)===null||Vt===void 0||Vt.appendChild(ki),ki.classList.add("smui-floating-label--remove-transition"),ki.classList.add("smui-floating-label--force-size"),ki.classList.remove("mdc-floating-label--float-above");const Ni=ki.scrollWidth;return(yi=Ci.parentNode)===null||yi===void 0||yi.removeChild(ki),Ni},registerInteractionHandler:(Vt,yi)=>_t().addEventListener(Vt,yi),deregisterInteractionHandler:(Vt,yi)=>_t().removeEventListener(Vt,yi)}));const Ft={get element(){return _t()},addStyle:gt,removeStyle:At};return lu(Ke,"SMUIFloatingLabel:mount",Ft),st.init(),()=>{lu(Ke,"SMUIFloatingLabel:unmount",Ft),st.destroy()}});function $t(Ft){ht[Ft]||n(8,ht[Ft]=!0,ht)}function rt(Ft){(!(Ft in ht)||ht[Ft])&&n(8,ht[Ft]=!1,ht)}function gt(Ft,Vt){xt[Ft]!=Vt&&(Vt===""||Vt==null?(delete xt[Ft],n(9,xt)):n(9,xt[Ft]=Vt,xt))}function At(Ft){Ft in xt&&(delete xt[Ft],n(9,xt))}function yt(Ft){st.shake(Ft)}function St(Ft){n(0,_e=Ft)}function ut(Ft){n(1,Ze=Ft)}function Ye(){return st.getWidth()}function _t(){return Ke}function ct(Ft){ta[Ft?"unshift":"push"](()=>{Ke=Ft,n(7,Ke)})}function Ut(Ft){ta[Ft?"unshift":"push"](()=>{Ke=Ft,n(7,Ke)})}return t.$$set=Ft=>{e=xr(xr({},e),rc(Ft)),n(12,g=_o(e,c)),"use"in Ft&&n(2,$=Ft.use),"class"in Ft&&n(3,he=Ft.class),"style"in Ft&&n(4,oe=Ft.style),"for"in Ft&&n(5,ce=Ft.for),"floatAbove"in Ft&&n(0,_e=Ft.floatAbove),"required"in Ft&&n(1,Ze=Ft.required),"wrapped"in Ft&&n(6,nt=Ft.wrapped),"$$scope"in Ft&&n(21,S=Ft.$$scope)},t.$$.update=()=>{t.$$.dirty&786433&&st&&Mt!==_e&&(n(19,Mt=_e),st.float(_e)),t.$$.dirty&1310722&&st&&Ue!==Ze&&(n(20,Ue=Ze),st.setRequired(Ze))},[_e,Ze,$,he,oe,ce,nt,Ke,ht,xt,N,zt,g,yt,St,ut,Ye,_t,st,Mt,Ue,S,v,ct,Ut]}class T3 extends Ha{constructor(e){super(),ja(this,e,jC,HC,Ca,{use:2,class:3,style:4,for:5,floatAbove:0,required:1,wrapped:6,shake:13,float:14,setRequired:15,getWidth:16,getElement:17})}get shake(){return this.$$.ctx[13]}get float(){return this.$$.ctx[14]}get setRequired(){return this.$$.ctx[15]}get getWidth(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function ZC(t){let e,n,c,g,v,S,a=[{class:n=Ps({[t[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":t[3],...t[5]})},{style:c=Object.entries(t[6]).map(ox).concat([t[2]]).join(" ")},t[8]],N={};for(let $=0;$<a.length;$+=1)N=xr(N,a[$]);return{c(){e=Pn("div"),this.h()},l($){e=Dn($,"DIV",{class:!0,style:!0}),rn(e).forEach(Ai),this.h()},h(){al(e,N)},m($,he){yn($,e,he),t[13](e),v||(S=[To(g=_c.call(null,e,t[0])),To(t[7].call(null,e))],v=!0)},p($,[he]){al(e,N=xa(a,[he&42&&n!==(n=Ps({[$[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":$[3],...$[5]}))&&{class:n},he&68&&c!==(c=Object.entries($[6]).map(ox).concat([$[2]]).join(" "))&&{style:c},he&256&&$[8]])),g&&ku(g.update)&&he&1&&g.update.call(null,$[0])},i:Ra,o:Ra,d($){$&&Ai(e),t[13](null),v=!1,Gh(S)}}}const ox=([t,e])=>`${t}: ${e};`;function QC(t,e,n){const c=["use","class","style","active","activate","deactivate","setRippleCenter","getElement"];let g=_o(e,c);const v=Ec(bc());let{use:S=[]}=e,{class:a=""}=e,{style:N=""}=e,{active:$=!1}=e,he,oe,ce={},_e={};wc(()=>(oe=new kE({addClass:nt,removeClass:Ke,hasClass:Ze,setStyle:st,registerEventHandler:($t,rt)=>Mt().addEventListener($t,rt),deregisterEventHandler:($t,rt)=>Mt().removeEventListener($t,rt)}),oe.init(),()=>{oe.destroy()}));function Ze($t){return $t in ce?ce[$t]:Mt().classList.contains($t)}function nt($t){ce[$t]||n(5,ce[$t]=!0,ce)}function Ke($t){(!($t in ce)||ce[$t])&&n(5,ce[$t]=!1,ce)}function st($t,rt){_e[$t]!=rt&&(rt===""||rt==null?(delete _e[$t],n(6,_e)):n(6,_e[$t]=rt,_e))}function ht(){oe.activate()}function xt(){oe.deactivate()}function zt($t){oe.setRippleCenter($t)}function Mt(){return he}function Ue($t){ta[$t?"unshift":"push"](()=>{he=$t,n(4,he)})}return t.$$set=$t=>{e=xr(xr({},e),rc($t)),n(8,g=_o(e,c)),"use"in $t&&n(0,S=$t.use),"class"in $t&&n(1,a=$t.class),"style"in $t&&n(2,N=$t.style),"active"in $t&&n(3,$=$t.active)},[S,a,N,$,he,ce,_e,v,g,ht,xt,zt,Mt,Ue]}class WC extends Ha{constructor(e){super(),ja(this,e,QC,ZC,Ca,{use:0,class:1,style:2,active:3,activate:9,deactivate:10,setRippleCenter:11,getElement:12})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get setRippleCenter(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}function lx(t){let e,n,c;const g=t[15].default,v=Zl(g,t,t[14],null);return{c(){e=Pn("div"),v&&v.c(),this.h()},l(S){e=Dn(S,"DIV",{class:!0,style:!0});var a=rn(e);v&&v.l(a),a.forEach(Ai),this.h()},h(){_i(e,"class","mdc-notched-outline__notch"),_i(e,"style",n=Object.entries(t[7]).map(ux).join(" "))},m(S,a){yn(S,e,a),v&&v.m(e,null),c=!0},p(S,a){v&&v.p&&(!c||a&16384)&&Ql(v,g,S,S[14],c?$l(g,S[14],a,null):Wl(S[14]),null),(!c||a&128&&n!==(n=Object.entries(S[7]).map(ux).join(" ")))&&_i(e,"style",n)},i(S){c||(Fi(v,S),c=!0)},o(S){Xi(v,S),c=!1},d(S){S&&Ai(e),v&&v.d(S)}}}function $C(t){let e,n,c,g,v,S,a,N,$,he,oe=!t[3]&&lx(t),ce=[{class:S=Ps({[t[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":t[2],"mdc-notched-outline--no-label":t[3],...t[6]})},t[10]],_e={};for(let Ze=0;Ze<ce.length;Ze+=1)_e=xr(_e,ce[Ze]);return{c(){e=Pn("div"),n=Pn("div"),c=_r(),oe&&oe.c(),g=_r(),v=Pn("div"),this.h()},l(Ze){e=Dn(Ze,"DIV",{class:!0});var nt=rn(e);n=Dn(nt,"DIV",{class:!0}),rn(n).forEach(Ai),c=yr(nt),oe&&oe.l(nt),g=yr(nt),v=Dn(nt,"DIV",{class:!0}),rn(v).forEach(Ai),nt.forEach(Ai),this.h()},h(){_i(n,"class","mdc-notched-outline__leading"),_i(v,"class","mdc-notched-outline__trailing"),al(e,_e)},m(Ze,nt){yn(Ze,e,nt),Bi(e,n),Bi(e,c),oe&&oe.m(e,null),Bi(e,g),Bi(e,v),t[16](e),N=!0,$||(he=[To(a=_c.call(null,e,t[0])),To(t[8].call(null,e)),jl(e,"SMUIFloatingLabel:mount",t[9]),jl(e,"SMUIFloatingLabel:unmount",t[17])],$=!0)},p(Ze,[nt]){Ze[3]?oe&&(Ba(),Xi(oe,1,1,()=>{oe=null}),za()):oe?(oe.p(Ze,nt),nt&8&&Fi(oe,1)):(oe=lx(Ze),oe.c(),Fi(oe,1),oe.m(e,g)),al(e,_e=xa(ce,[(!N||nt&78&&S!==(S=Ps({[Ze[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":Ze[2],"mdc-notched-outline--no-label":Ze[3],...Ze[6]})))&&{class:S},nt&1024&&Ze[10]])),a&&ku(a.update)&&nt&1&&a.update.call(null,Ze[0])},i(Ze){N||(Fi(oe),N=!0)},o(Ze){Xi(oe),N=!1},d(Ze){Ze&&Ai(e),oe&&oe.d(),t[16](null),$=!1,Gh(he)}}}const ux=([t,e])=>`${t}: ${e};`;function XC(t,e,n){const c=["use","class","notched","noLabel","notch","closeNotch","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e;const a=Ec(bc());let{use:N=[]}=e,{class:$=""}=e,{notched:he=!1}=e,{noLabel:oe=!1}=e,ce,_e,Ze,nt={},Ke={};wc(()=>(_e=new HE({addClass:ht,removeClass:xt,setNotchWidthProperty:yt=>zt("width",yt+"px"),removeNotchWidthProperty:()=>Mt("width")}),_e.init(),()=>{_e.destroy()}));function st(yt){n(4,Ze=yt.detail)}function ht(yt){nt[yt]||n(6,nt[yt]=!0,nt)}function xt(yt){(!(yt in nt)||nt[yt])&&n(6,nt[yt]=!1,nt)}function zt(yt,St){Ke[yt]!=St&&(St===""||St==null?(delete Ke[yt],n(7,Ke)):n(7,Ke[yt]=St,Ke))}function Mt(yt){yt in Ke&&(delete Ke[yt],n(7,Ke))}function Ue(yt){_e.notch(yt)}function $t(){_e.closeNotch()}function rt(){return ce}function gt(yt){ta[yt?"unshift":"push"](()=>{ce=yt,n(5,ce)})}const At=()=>n(4,Ze=void 0);return t.$$set=yt=>{e=xr(xr({},e),rc(yt)),n(10,g=_o(e,c)),"use"in yt&&n(0,N=yt.use),"class"in yt&&n(1,$=yt.class),"notched"in yt&&n(2,he=yt.notched),"noLabel"in yt&&n(3,oe=yt.noLabel),"$$scope"in yt&&n(14,S=yt.$$scope)},t.$$.update=()=>{t.$$.dirty&16&&(Ze?(Ze.addStyle("transition-duration","0s"),ht("mdc-notched-outline--upgraded"),requestAnimationFrame(()=>{Ze&&Ze.removeStyle("transition-duration")})):xt("mdc-notched-outline--upgraded"))},[N,$,he,oe,Ze,ce,nt,Ke,a,st,g,Ue,$t,rt,S,v,gt,At]}class YC extends Ha{constructor(e){super(),ja(this,e,XC,$C,Ca,{use:0,class:1,notched:2,noLabel:3,notch:11,closeNotch:12,getElement:13})}get notch(){return this.$$.ctx[11]}get closeNotch(){return this.$$.ctx[12]}get getElement(){return this.$$.ctx[13]}}function KC(t){let e;return{c(){e=Fs(t[8])},l(n){e=Os(n,t[8])},m(n,c){yn(n,e,c)},p(n,c){c&256&&El(e,n[8])},i:Ra,o:Ra,d(n){n&&Ai(e)}}}function JC(t){let e;const n=t[13].default,c=Zl(n,t,t[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v&4096)&&Ql(c,n,g,g[12],e?$l(n,g[12],v,null):Wl(g[12]),null)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function eT(t){let e,n,c,g,v,S,a,N,$;const he=[JC,KC],oe=[];function ce(nt,Ke){return nt[8]==null?0:1}n=ce(t),c=oe[n]=he[n](t);let _e=[{class:g=Ps({[t[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":t[4],"mdc-select-helper-text--validation-msg-persistent":t[3],...t[6]})},{"aria-hidden":v=t[3]?void 0:"true"},{id:t[2]},t[7],t[10]],Ze={};for(let nt=0;nt<_e.length;nt+=1)Ze=xr(Ze,_e[nt]);return{c(){e=Pn("div"),c.c(),this.h()},l(nt){e=Dn(nt,"DIV",{class:!0,"aria-hidden":!0,id:!0});var Ke=rn(e);c.l(Ke),Ke.forEach(Ai),this.h()},h(){al(e,Ze)},m(nt,Ke){yn(nt,e,Ke),oe[n].m(e,null),t[14](e),a=!0,N||($=[To(S=_c.call(null,e,t[0])),To(t[9].call(null,e))],N=!0)},p(nt,[Ke]){let st=n;n=ce(nt),n===st?oe[n].p(nt,Ke):(Ba(),Xi(oe[st],1,1,()=>{oe[st]=null}),za(),c=oe[n],c?c.p(nt,Ke):(c=oe[n]=he[n](nt),c.c()),Fi(c,1),c.m(e,null)),al(e,Ze=xa(_e,[(!a||Ke&90&&g!==(g=Ps({[nt[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":nt[4],"mdc-select-helper-text--validation-msg-persistent":nt[3],...nt[6]})))&&{class:g},(!a||Ke&8&&v!==(v=nt[3]?void 0:"true"))&&{"aria-hidden":v},(!a||Ke&4)&&{id:nt[2]},Ke&128&&nt[7],Ke&1024&&nt[10]])),S&&ku(S.update)&&Ke&1&&S.update.call(null,nt[0])},i(nt){a||(Fi(c),a=!0)},o(nt){Xi(c),a=!1},d(nt){nt&&Ai(e),oe[n].d(),t[14](null),N=!1,Gh($)}}}let tT=0;function iT(t,e,n){const c=["use","class","id","persistent","validationMsg","getElement"];let g=_o(e,c),{$$slots:v={},$$scope:S}=e;const a=Ec(bc());let{use:N=[]}=e,{class:$=""}=e,{id:he="SMUI-select-helper-text-"+tT++}=e,{persistent:oe=!1}=e,{validationMsg:ce=!1}=e,_e,Ze,nt={},Ke={},st;wc(()=>(Ze=new eC({addClass:xt,removeClass:zt,hasClass:ht,getAttr:Mt,setAttr:Ue,removeAttr:$t,setContent:At=>{n(8,st=At)}}),he.startsWith("SMUI-select-helper-text-")&&lu(rt(),"SMUISelectHelperText:id",he),lu(rt(),"SMUISelectHelperText:mount",Ze),Ze.init(),()=>{lu(rt(),"SMUISelectHelperText:unmount",Ze),Ze.destroy()}));function ht(At){return At in nt?nt[At]:rt().classList.contains(At)}function xt(At){nt[At]||n(6,nt[At]=!0,nt)}function zt(At){(!(At in nt)||nt[At])&&n(6,nt[At]=!1,nt)}function Mt(At){var yt;return At in Ke?(yt=Ke[At])!==null&&yt!==void 0?yt:null:rt().getAttribute(At)}function Ue(At,yt){Ke[At]!==yt&&n(7,Ke[At]=yt,Ke)}function $t(At){(!(At in Ke)||Ke[At]!=null)&&n(7,Ke[At]=void 0,Ke)}function rt(){return _e}function gt(At){ta[At?"unshift":"push"](()=>{_e=At,n(5,_e)})}return t.$$set=At=>{e=xr(xr({},e),rc(At)),n(10,g=_o(e,c)),"use"in At&&n(0,N=At.use),"class"in At&&n(1,$=At.class),"id"in At&&n(2,he=At.id),"persistent"in At&&n(3,oe=At.persistent),"validationMsg"in At&&n(4,ce=At.validationMsg),"$$scope"in At&&n(12,S=At.$$scope)},[N,$,he,oe,ce,_e,nt,Ke,st,a,g,rt,S,v,gt]}class nT extends Ha{constructor(e){super(),ja(this,e,iT,eT,Ca,{use:0,class:1,id:2,persistent:3,validationMsg:4,getElement:11})}get getElement(){return this.$$.ctx[11]}}const rT=t=>({}),cx=t=>({}),sT=t=>({}),hx=t=>({}),aT=t=>({}),Ax=t=>({}),oT=t=>({}),fx=t=>({});function dx(t){let e,n=[{type:"hidden"},{required:t[10]},{disabled:t[6]},{value:t[0]},Sl(t[53],"input$")],c={};for(let g=0;g<n.length;g+=1)c=xr(c,n[g]);return{c(){e=Pn("input"),this.h()},l(g){e=Dn(g,"INPUT",{type:!0}),this.h()},h(){al(e,c)},m(g,v){yn(g,e,v),e.autofocus&&e.focus()},p(g,v){al(e,c=xa(n,[{type:"hidden"},v[0]&1024&&{required:g[10]},v[0]&64&&{disabled:g[6]},v[0]&1&&{value:g[0]},v[1]&4194304&&Sl(g[53],"input$")]))},d(g){g&&Ai(e)}}}function px(t){let e;return{c(){e=Pn("span"),this.h()},l(n){e=Dn(n,"SPAN",{class:!0}),rn(e).forEach(Ai),this.h()},h(){_i(e,"class","mdc-select__ripple")},m(n,c){yn(n,e,c)},d(n){n&&Ai(e)}}}function mx(t){let e,n;const c=[{id:t[11]+"-smui-label"},{floatAbove:t[42]!==""},{required:t[10]},Sl(t[53],"label$")];let g={$$slots:{default:[lT]},$$scope:{ctx:t}};for(let v=0;v<c.length;v+=1)g=xr(g,c[v]);return e=new T3({props:g}),t[67](e),{c(){Cr(e.$$.fragment)},l(v){Rr(e.$$.fragment,v)},m(v,S){Tr(e,v,S),n=!0},p(v,S){const a=S[0]&3072|S[1]&4196352?xa(c,[S[0]&2048&&{id:v[11]+"-smui-label"},S[1]&2048&&{floatAbove:v[42]!==""},S[0]&1024&&{required:v[10]},S[1]&4194304&&qs(Sl(v[53],"label$"))]):{};S[0]&512|S[2]&33554432&&(a.$$scope={dirty:S,ctx:v}),e.$set(a)},i(v){n||(Fi(e.$$.fragment,v),n=!0)},o(v){Xi(e.$$.fragment,v),n=!1},d(v){t[67](null),kr(e,v)}}}function lT(t){let e=(t[9]==null?"":t[9])+"",n,c;const g=t[64].label,v=Zl(g,t,t[87],fx);return{c(){n=Fs(e),v&&v.c()},l(S){n=Os(S,e),v&&v.l(S)},m(S,a){yn(S,n,a),v&&v.m(S,a),c=!0},p(S,a){(!c||a[0]&512)&&e!==(e=(S[9]==null?"":S[9])+"")&&El(n,e),v&&v.p&&(!c||a[2]&33554432)&&Ql(v,g,S,S[87],c?$l(g,S[87],a,oT):Wl(S[87]),fx)},i(S){c||(Fi(v,S),c=!0)},o(S){Xi(v,S),c=!1},d(S){S&&Ai(n),v&&v.d(S)}}}function gx(t){let e,n;const c=[{noLabel:t[8]||t[9]==null&&!t[54].label},Sl(t[53],"outline$")];let g={$$slots:{default:[cT]},$$scope:{ctx:t}};for(let v=0;v<c.length;v+=1)g=xr(g,c[v]);return e=new YC({props:g}),t[69](e),{c(){Cr(e.$$.fragment)},l(v){Rr(e.$$.fragment,v)},m(v,S){Tr(e,v,S),n=!0},p(v,S){const a=S[0]&768|S[1]&12582912?xa(c,[S[0]&768|S[1]&8388608&&{noLabel:v[8]||v[9]==null&&!v[54].label},S[1]&4194304&&qs(Sl(v[53],"outline$"))]):{};S[0]&3840|S[1]&12585216|S[2]&33554432&&(a.$$scope={dirty:S,ctx:v}),e.$set(a)},i(v){n||(Fi(e.$$.fragment,v),n=!0)},o(v){Xi(e.$$.fragment,v),n=!1},d(v){t[69](null),kr(e,v)}}}function _x(t){let e,n;const c=[{id:t[11]+"-smui-label"},{floatAbove:t[42]!==""},{required:t[10]},Sl(t[53],"label$")];let g={$$slots:{default:[uT]},$$scope:{ctx:t}};for(let v=0;v<c.length;v+=1)g=xr(g,c[v]);return e=new T3({props:g}),t[68](e),{c(){Cr(e.$$.fragment)},l(v){Rr(e.$$.fragment,v)},m(v,S){Tr(e,v,S),n=!0},p(v,S){const a=S[0]&3072|S[1]&4196352?xa(c,[S[0]&2048&&{id:v[11]+"-smui-label"},S[1]&2048&&{floatAbove:v[42]!==""},S[0]&1024&&{required:v[10]},S[1]&4194304&&qs(Sl(v[53],"label$"))]):{};S[0]&512|S[2]&33554432&&(a.$$scope={dirty:S,ctx:v}),e.$set(a)},i(v){n||(Fi(e.$$.fragment,v),n=!0)},o(v){Xi(e.$$.fragment,v),n=!1},d(v){t[68](null),kr(e,v)}}}function uT(t){let e=(t[9]==null?"":t[9])+"",n,c;const g=t[64].label,v=Zl(g,t,t[87],Ax);return{c(){n=Fs(e),v&&v.c()},l(S){n=Os(S,e),v&&v.l(S)},m(S,a){yn(S,n,a),v&&v.m(S,a),c=!0},p(S,a){(!c||a[0]&512)&&e!==(e=(S[9]==null?"":S[9])+"")&&El(n,e),v&&v.p&&(!c||a[2]&33554432)&&Ql(v,g,S,S[87],c?$l(g,S[87],a,aT):Wl(S[87]),Ax)},i(S){c||(Fi(v,S),c=!0)},o(S){Xi(v,S),c=!1},d(S){S&&Ai(n),v&&v.d(S)}}}function cT(t){let e,n,c=!t[8]&&(t[9]!=null||t[54].label)&&_x(t);return{c(){c&&c.c(),e=Zr()},l(g){c&&c.l(g),e=Zr()},m(g,v){c&&c.m(g,v),yn(g,e,v),n=!0},p(g,v){!g[8]&&(g[9]!=null||g[54].label)?c?(c.p(g,v),v[0]&768|v[1]&8388608&&Fi(c,1)):(c=_x(g),c.c(),Fi(c,1),c.m(e.parentNode,e)):c&&(Ba(),Xi(c,1,1,()=>{c=null}),za())},i(g){n||(Fi(c),n=!0)},o(g){Xi(c),n=!1},d(g){g&&Ai(e),c&&c.d(g)}}}function yx(t){let e,n;const c=[Sl(t[53],"ripple$")];let g={};for(let v=0;v<c.length;v+=1)g=xr(g,c[v]);return e=new WC({props:g}),t[70](e),{c(){Cr(e.$$.fragment)},l(v){Rr(e.$$.fragment,v)},m(v,S){Tr(e,v,S),n=!0},p(v,S){const a=S[1]&4194304?xa(c,[qs(Sl(v[53],"ripple$"))]):{};e.$set(a)},i(v){n||(Fi(e.$$.fragment,v),n=!0)},o(v){Xi(e.$$.fragment,v),n=!1},d(v){t[70](null),kr(e,v)}}}function hT(t){let e;const n=t[64].default,c=Zl(n,t,t[87],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v[2]&33554432)&&Ql(c,n,g,g[87],e?$l(n,g[87],v,null):Wl(g[87]),null)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function AT(t){let e,n,c;const g=[{role:"listbox"},{wrapFocus:t[35]},Sl(t[53],"list$")];function v(a){t[75](a)}let S={$$slots:{default:[hT]},$$scope:{ctx:t}};for(let a=0;a<g.length;a+=1)S=xr(S,g[a]);return t[24]!==void 0&&(S.selectedIndex=t[24]),e=new LC({props:S}),ta.push(()=>Vh(e,"selectedIndex",v)),e.$on("SMUIList:mount",t[76]),{c(){Cr(e.$$.fragment)},l(a){Rr(e.$$.fragment,a)},m(a,N){Tr(e,a,N),c=!0},p(a,N){const $=N[1]&4194320?xa(g,[g[0],N[1]&16&&{wrapFocus:a[35]},N[1]&4194304&&qs(Sl(a[53],"list$"))]):{};N[2]&33554432&&($.$$scope={dirty:N,ctx:a}),!n&&N[0]&16777216&&(n=!0,$.selectedIndex=a[24],Nh(()=>n=!1)),e.$set($)},i(a){c||(Fi(e.$$.fragment,a),c=!0)},o(a){Xi(e.$$.fragment,a),c=!1},d(a){kr(e,a)}}}function vx(t){let e,n;const c=[Sl(t[53],"helperText$")];let g={$$slots:{default:[fT]},$$scope:{ctx:t}};for(let v=0;v<c.length;v+=1)g=xr(g,c[v]);return e=new nT({props:g}),e.$on("SMUISelectHelperText:id",t[84]),e.$on("SMUISelectHelperText:mount",t[85]),e.$on("SMUISelectHelperText:unmount",t[86]),{c(){Cr(e.$$.fragment)},l(v){Rr(e.$$.fragment,v)},m(v,S){Tr(e,v,S),n=!0},p(v,S){const a=S[1]&4194304?xa(c,[qs(Sl(v[53],"helperText$"))]):{};S[2]&33554432&&(a.$$scope={dirty:S,ctx:v}),e.$set(a)},i(v){n||(Fi(e.$$.fragment,v),n=!0)},o(v){Xi(e.$$.fragment,v),n=!1},d(v){kr(e,v)}}}function fT(t){let e;const n=t[64].helperText,c=Zl(n,t,t[87],cx);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v[2]&33554432)&&Ql(c,n,g,g[87],e?$l(n,g[87],v,rT):Wl(g[87]),cx)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function dT(t){let e,n,c,g,v,S,a,N,$,he,oe,ce,_e,Ze,nt,Ke,st,ht,xt,zt,Mt,Ue,$t,rt,gt,At,yt,St,ut,Ye,_t,ct,Ut,Ft,Vt,yi,Ci,ki,Ni,tn,Zi,Gi=t[12]&&dx(t),sn=t[7]==="filled"&&px(),xn=t[7]!=="outlined"&&!t[8]&&(t[9]!=null||t[54].label)&&mx(t),Ti=t[7]==="outlined"&&gx(t);const gi=t[64].leadingIcon,Oi=Zl(gi,t,t[87],hx);let Vi=[{id:oe=t[11]+"-smui-selected-text"},{class:ce=Ps({[t[19]]:!0,"mdc-select__selected-text":!0})},{role:"button"},{"aria-haspopup":"listbox"},{"aria-labelledby":_e=t[11]+"-smui-label"},Sl(t[53],"selectedText$")],bn={};for(let M=0;M<Vi.length;M+=1)bn=xr(bn,Vi[M]);let wn=[{class:nt=Ps({[t[17]]:!0,"mdc-select__selected-text-container":!0})},Sl(t[53],"selectedTextContainer$")],xi={};for(let M=0;M<wn.length;M+=1)xi=xr(xi,wn[M]);let Bn=[{class:Ue=Ps({[t[21]]:!0,"mdc-select__dropdown-icon":!0})},Sl(t[53],"dropdownIcon$")],Ot={};for(let M=0;M<Bn.length;M+=1)Ot=xr(Ot,Bn[M]);let an=t[7]!=="outlined"&&t[5]&&yx(t),$n=[{class:gt=Ps({[t[15]]:!0,"mdc-select__anchor":!0})},{"aria-required":At=t[10]?"true":void 0},{"aria-disabled":yt=t[6]?"true":void 0},{"aria-controls":t[45]},{"aria-expanded":St=t[31]?"true":"false"},{"aria-describedby":t[30]},{role:"combobox"},{tabindex:"0"},t[29],Sl(t[53],"anchor$")],oi={};for(let M=0;M<$n.length;M+=1)oi=xr(oi,$n[M]);const Yi=[{class:Ps({[t[22]]:!0,"mdc-select__menu":!0,...t[32]})},{id:t[45]},{fullWidth:!0},{anchor:!1},{anchorElement:t[33]},{anchorCorner:t[34]},Sl(t[53],"menu$")];function Xn(M){t[77](M)}let zn={$$slots:{default:[AT]},$$scope:{ctx:t}};for(let M=0;M<Yi.length;M+=1)zn=xr(zn,Yi[M]);t[31]!==void 0&&(zn.open=t[31]),_t=new mC({props:zn}),ta.push(()=>Vh(_t,"open",Xn)),_t.$on("SMUIMenu:selected",t[78]),_t.$on("SMUIMenuSurface:closing",t[79]),_t.$on("SMUIMenuSurface:closed",t[80]),_t.$on("SMUIMenuSurface:opened",t[81]);let Wn=[{class:Ut=Ps({[t[3]]:!0,"mdc-select":!0,"mdc-select--required":t[10],"mdc-select--disabled":t[6],"mdc-select--filled":t[7]==="filled","mdc-select--outlined":t[7]==="outlined","smui-select--standard":t[7]==="standard","mdc-select--with-leading-icon":t[44](t[13])?t[54].leadingIcon:t[13],"mdc-select--no-label":t[8]||t[9]==null&&!t[54].label,"mdc-select--invalid":t[1],"mdc-select--activated":t[31],"mdc-data-table__pagination-rows-per-page-select":t[46]==="data-table:pagination",...t[26]})},{style:Ft=Object.entries(t[27]).map(xx).concat([t[4]]).join(" ")},J2(t[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])],_n={};for(let M=0;M<Wn.length;M+=1)_n=xr(_n,Wn[M]);let b=t[54].helperText&&vx(t);return{c(){e=Pn("div"),Gi&&Gi.c(),n=_r(),c=Pn("div"),sn&&sn.c(),g=_r(),xn&&xn.c(),v=_r(),Ti&&Ti.c(),S=_r(),Oi&&Oi.c(),a=_r(),N=Pn("span"),$=Pn("span"),he=Fs(t[42]),st=_r(),ht=Pn("span"),xt=ws("svg"),zt=ws("polygon"),Mt=ws("polygon"),rt=_r(),an&&an.c(),Ye=_r(),Cr(_t.$$.fragment),Ci=_r(),b&&b.c(),ki=Zr(),this.h()},l(M){e=Dn(M,"DIV",{class:!0,style:!0});var U=rn(e);Gi&&Gi.l(U),n=yr(U),c=Dn(U,"DIV",{class:!0,"aria-required":!0,"aria-disabled":!0,"aria-controls":!0,"aria-expanded":!0,"aria-describedby":!0,role:!0,tabindex:!0});var K=rn(c);sn&&sn.l(K),g=yr(K),xn&&xn.l(K),v=yr(K),Ti&&Ti.l(K),S=yr(K),Oi&&Oi.l(K),a=yr(K),N=Dn(K,"SPAN",{class:!0});var ie=rn(N);$=Dn(ie,"SPAN",{id:!0,class:!0,role:!0,"aria-haspopup":!0,"aria-labelledby":!0});var de=rn($);he=Os(de,t[42]),de.forEach(Ai),ie.forEach(Ai),st=yr(K),ht=Dn(K,"SPAN",{class:!0});var be=rn(ht);xt=Ss(be,"svg",{class:!0,viewBox:!0,focusable:!0});var Ee=rn(xt);zt=Ss(Ee,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),rn(zt).forEach(Ai),Mt=Ss(Ee,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),rn(Mt).forEach(Ai),Ee.forEach(Ai),be.forEach(Ai),rt=yr(K),an&&an.l(K),K.forEach(Ai),Ye=yr(U),Rr(_t.$$.fragment,U),U.forEach(Ai),Ci=yr(M),b&&b.l(M),ki=Zr(),this.h()},h(){al($,bn),al(N,xi),_i(zt,"class","mdc-select__dropdown-icon-inactive"),_i(zt,"stroke","none"),_i(zt,"fill-rule","evenodd"),_i(zt,"points","7 10 12 15 17 10"),_i(Mt,"class","mdc-select__dropdown-icon-active"),_i(Mt,"stroke","none"),_i(Mt,"fill-rule","evenodd"),_i(Mt,"points","7 15 12 10 17 15"),_i(xt,"class","mdc-select__dropdown-icon-graphic"),_i(xt,"viewBox","7 10 10 5"),_i(xt,"focusable","false"),al(ht,Ot),al(c,oi),al(e,_n)},m(M,U){yn(M,e,U),Gi&&Gi.m(e,null),Bi(e,n),Bi(e,c),sn&&sn.m(c,null),Bi(c,g),xn&&xn.m(c,null),Bi(c,v),Ti&&Ti.m(c,null),Bi(c,S),Oi&&Oi.m(c,null),Bi(c,a),Bi(c,N),Bi(N,$),Bi($,he),Bi(c,st),Bi(c,ht),Bi(ht,xt),Bi(xt,zt),Bi(xt,Mt),Bi(c,rt),an&&an.m(c,null),t[71](c),Bi(e,Ye),Tr(_t,e,null),t[82](e),yn(M,Ci,U),b&&b.m(M,U),yn(M,ki,U),Ni=!0,tn||(Zi=[To(Ze=_c.call(null,$,t[18])),To(Ke=_c.call(null,N,t[16])),To($t=_c.call(null,ht,t[20])),To(ut=_c.call(null,c,t[14])),jl(c,"focus",t[72]),jl(c,"blur",t[73]),jl(c,"click",t[74]),jl(c,"keydown",function(){ku(t[23]&&t[23].handleKeydown.bind(t[23]))&&(t[23]&&t[23].handleKeydown.bind(t[23])).apply(this,arguments)}),jl(c,"focus",t[65]),jl(c,"blur",t[66]),To(Vt=tp.call(null,e,{ripple:t[7]==="filled",unbounded:!1,addClass:t[50],removeClass:t[51],addStyle:t[52]})),To(AC.call(null,e,{addClass:t[50],removeClass:t[51]})),To(yi=_c.call(null,e,t[2])),To(t[43].call(null,e)),jl(e,"SMUISelectLeadingIcon:mount",t[49]),jl(e,"SMUISelectLeadingIcon:unmount",t[83])],tn=!0)},p(M,U){t=M,t[12]?Gi?Gi.p(t,U):(Gi=dx(t),Gi.c(),Gi.m(e,n)):Gi&&(Gi.d(1),Gi=null),t[7]==="filled"?sn||(sn=px(),sn.c(),sn.m(c,g)):sn&&(sn.d(1),sn=null),t[7]!=="outlined"&&!t[8]&&(t[9]!=null||t[54].label)?xn?(xn.p(t,U),U[0]&896|U[1]&8388608&&Fi(xn,1)):(xn=mx(t),xn.c(),Fi(xn,1),xn.m(c,v)):xn&&(Ba(),Xi(xn,1,1,()=>{xn=null}),za()),t[7]==="outlined"?Ti?(Ti.p(t,U),U[0]&128&&Fi(Ti,1)):(Ti=gx(t),Ti.c(),Fi(Ti,1),Ti.m(c,S)):Ti&&(Ba(),Xi(Ti,1,1,()=>{Ti=null}),za()),Oi&&Oi.p&&(!Ni||U[2]&33554432)&&Ql(Oi,gi,t,t[87],Ni?$l(gi,t[87],U,sT):Wl(t[87]),hx),(!Ni||U[1]&2048)&&vE(he,t[42],bn.contenteditable),al($,bn=xa(Vi,[(!Ni||U[0]&2048&&oe!==(oe=t[11]+"-smui-selected-text"))&&{id:oe},(!Ni||U[0]&524288&&ce!==(ce=Ps({[t[19]]:!0,"mdc-select__selected-text":!0})))&&{class:ce},{role:"button"},{"aria-haspopup":"listbox"},(!Ni||U[0]&2048&&_e!==(_e=t[11]+"-smui-label"))&&{"aria-labelledby":_e},U[1]&4194304&&Sl(t[53],"selectedText$")])),Ze&&ku(Ze.update)&&U[0]&262144&&Ze.update.call(null,t[18]),al(N,xi=xa(wn,[(!Ni||U[0]&131072&&nt!==(nt=Ps({[t[17]]:!0,"mdc-select__selected-text-container":!0})))&&{class:nt},U[1]&4194304&&Sl(t[53],"selectedTextContainer$")])),Ke&&ku(Ke.update)&&U[0]&65536&&Ke.update.call(null,t[16]),al(ht,Ot=xa(Bn,[(!Ni||U[0]&2097152&&Ue!==(Ue=Ps({[t[21]]:!0,"mdc-select__dropdown-icon":!0})))&&{class:Ue},U[1]&4194304&&Sl(t[53],"dropdownIcon$")])),$t&&ku($t.update)&&U[0]&1048576&&$t.update.call(null,t[20]),t[7]!=="outlined"&&t[5]?an?(an.p(t,U),U[0]&160&&Fi(an,1)):(an=yx(t),an.c(),Fi(an,1),an.m(c,null)):an&&(Ba(),Xi(an,1,1,()=>{an=null}),za()),al(c,oi=xa($n,[(!Ni||U[0]&32768&&gt!==(gt=Ps({[t[15]]:!0,"mdc-select__anchor":!0})))&&{class:gt},(!Ni||U[0]&1024&&At!==(At=t[10]?"true":void 0))&&{"aria-required":At},(!Ni||U[0]&64&&yt!==(yt=t[6]?"true":void 0))&&{"aria-disabled":yt},{"aria-controls":t[45]},(!Ni||U[1]&1&&St!==(St=t[31]?"true":"false"))&&{"aria-expanded":St},(!Ni||U[0]&1073741824)&&{"aria-describedby":t[30]},{role:"combobox"},{tabindex:"0"},U[0]&536870912&&t[29],U[1]&4194304&&Sl(t[53],"anchor$")])),ut&&ku(ut.update)&&U[0]&16384&&ut.update.call(null,t[14]);const K=U[0]&4194304|U[1]&4210702?xa(Yi,[U[0]&4194304|U[1]&2&&{class:Ps({[t[22]]:!0,"mdc-select__menu":!0,...t[32]})},U[1]&16384&&{id:t[45]},Yi[2],Yi[3],U[1]&4&&{anchorElement:t[33]},U[1]&8&&{anchorCorner:t[34]},U[1]&4194304&&qs(Sl(t[53],"menu$"))]):{};U[0]&16777216|U[1]&4194352|U[2]&33554432&&(K.$$scope={dirty:U,ctx:t}),!ct&&U[1]&1&&(ct=!0,K.open=t[31],Nh(()=>ct=!1)),_t.$set(K),al(e,_n=xa(Wn,[(!Ni||U[0]&67119050|U[1]&8388609&&Ut!==(Ut=Ps({[t[3]]:!0,"mdc-select":!0,"mdc-select--required":t[10],"mdc-select--disabled":t[6],"mdc-select--filled":t[7]==="filled","mdc-select--outlined":t[7]==="outlined","smui-select--standard":t[7]==="standard","mdc-select--with-leading-icon":t[44](t[13])?t[54].leadingIcon:t[13],"mdc-select--no-label":t[8]||t[9]==null&&!t[54].label,"mdc-select--invalid":t[1],"mdc-select--activated":t[31],"mdc-data-table__pagination-rows-per-page-select":t[46]==="data-table:pagination",...t[26]})))&&{class:Ut},(!Ni||U[0]&134217744&&Ft!==(Ft=Object.entries(t[27]).map(xx).concat([t[4]]).join(" ")))&&{style:Ft},U[1]&4194304&&J2(t[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])])),Vt&&ku(Vt.update)&&U[0]&128&&Vt.update.call(null,{ripple:t[7]==="filled",unbounded:!1,addClass:t[50],removeClass:t[51],addStyle:t[52]}),yi&&ku(yi.update)&&U[0]&4&&yi.update.call(null,t[2]),t[54].helperText?b?(b.p(t,U),U[1]&8388608&&Fi(b,1)):(b=vx(t),b.c(),Fi(b,1),b.m(ki.parentNode,ki)):b&&(Ba(),Xi(b,1,1,()=>{b=null}),za())},i(M){Ni||(Fi(xn),Fi(Ti),Fi(Oi,M),Fi(an),Fi(_t.$$.fragment,M),Fi(b),Ni=!0)},o(M){Xi(xn),Xi(Ti),Xi(Oi,M),Xi(an),Xi(_t.$$.fragment,M),Xi(b),Ni=!1},d(M){M&&(Ai(e),Ai(Ci),Ai(ki)),Gi&&Gi.d(),sn&&sn.d(),xn&&xn.d(),Ti&&Ti.d(),Oi&&Oi.d(M),an&&an.d(),t[71](null),kr(_t),t[82](null),b&&b.d(M),tn=!1,Gh(Zi)}}}let pT=0;function mT(t){const e=t.currentTarget.getBoundingClientRect();return(gT(t)?t.touches[0].clientX:t.clientX)-e.left}function gT(t){return"touches"in t}const xx=([t,e])=>`${t}: ${e};`;function _T(t,e,n){const c=["use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","getUseDefaultValidation","setUseDefaultValidation","focus","layout","getElement"];let g=_o(e,c),v,S,{$$slots:a={},$$scope:N}=e;const $=_E(a);var he;const oe=Ec(bc());let ce=()=>{};function _e(Jt){return Jt===ce}let{use:Ze=[]}=e,{class:nt=""}=e,{style:Ke=""}=e,{ripple:st=!0}=e,{disabled:ht=!1}=e,{variant:xt="standard"}=e,{noLabel:zt=!1}=e,{label:Mt=void 0}=e,{value:Ue=""}=e,{key:$t=Jt=>Jt}=e,{dirty:rt=!1}=e,{invalid:gt=ce}=e,{updateInvalid:At=_e(gt)}=e;const yt=_e(gt);_e(gt)&&(gt=!1);let{required:St=!1}=e,{inputId:ut="SMUI-select-"+pT++}=e,{hiddenInput:Ye=!1}=e,{withLeadingIcon:_t=ce}=e,{anchor$use:ct=[]}=e,{anchor$class:Ut=""}=e,{selectedTextContainer$use:Ft=[]}=e,{selectedTextContainer$class:Vt=""}=e,{selectedText$use:yi=[]}=e,{selectedText$class:Ci=""}=e,{dropdownIcon$use:ki=[]}=e,{dropdownIcon$class:Ni=""}=e,{menu$class:tn=""}=e,Zi,Gi,sn={},xn={},Ti,gi={},Oi=-1,Vi=(he=g.menu$id)!==null&&he!==void 0?he:ut+"-menu",bn,wn=Mu("SMUI:addLayoutListener"),xi,Bn=!1,Ot={},an,$n,oi=!1,Yi,Xn=Mu("SMUI:select:context"),zn,Wn,_n,b,M;mu("SMUI:list:role",""),mu("SMUI:list:nav",!1);const U=of("");Il(t,U,Jt=>n(42,v=Jt)),mu("SMUI:select:selectedText",U);const K=of(Ue);Il(t,K,Jt=>n(90,S=Jt)),mu("SMUI:select:value",K);let ie=Oi;wn&&(xi=wn(X)),wc(()=>(n(23,Gi=new JE({setSelectedText:Jt=>{j0(U,v=Jt,v)},isSelectAnchorFocused:()=>document.activeElement===Ti,getSelectAnchorAttr:We,setSelectAnchorAttr:Ge,removeSelectAnchorAttr:mt,addMenuClass:$e,removeMenuClass:je,openMenu:()=>{n(31,Bn=!0)},closeMenu:()=>{n(31,Bn=!1)},getAnchorElement:()=>Ti,setMenuAnchorElement:Jt=>{n(33,an=Jt)},setMenuAnchorCorner:Jt=>{n(34,$n=Jt)},setMenuWrapFocus:Jt=>{n(35,oi=Jt)},getSelectedIndex:()=>Oi,setSelectedIndex:Jt=>{n(63,ie=Jt),n(24,Oi=Jt),n(0,Ue=ot()[Oi])},focusMenuItemAtIndex:Jt=>{Yi.focusItemAtIndex(Jt)},getMenuItemCount:()=>Yi.items.length,getMenuItemValues:()=>ot().map($t),getMenuItemTextAtIndex:Jt=>Yi.getPrimaryTextAtIndex(Jt),isTypeaheadInProgress:()=>Yi.typeaheadInProgress,typeaheadMatchItem:(Jt,Sn)=>Yi.typeaheadMatchItem(Jt,Sn),addClass:Ee,removeClass:Ce,hasClass:be,setRippleCenter:Jt=>b&&b.setRippleCenter(Jt),activateBottomLine:()=>b&&b.activate(),deactivateBottomLine:()=>b&&b.deactivate(),notifyChange:Jt=>{n(55,rt=!0),At&&n(1,gt=!Gi.isValid()),lu(ne(),"SMUISelect:change",{value:Ue,index:Oi},void 0,!0)},hasOutline:()=>!!M,notchOutline:Jt=>M&&M.notch(Jt),closeOutline:()=>M&&M.closeNotch(),hasLabel:()=>!!_n,floatLabel:Jt=>_n&&_n.float(Jt),getLabelWidth:()=>_n?_n.getWidth():0,setLabelRequired:Jt=>_n&&_n.setRequired(Jt)},{get helperText(){return Wn},get leadingIcon(){return zn}})),n(24,Oi=ot().indexOf(Ue)),Gi.init(),ae(yt),()=>{Gi.destroy()})),km(()=>{xi&&xi()});function de(Jt){n(37,zn=Jt.detail)}function be(Jt){return Jt in sn?sn[Jt]:ne().classList.contains(Jt)}function Ee(Jt){sn[Jt]||n(26,sn[Jt]=!0,sn)}function Ce(Jt){(!(Jt in sn)||sn[Jt])&&n(26,sn[Jt]=!1,sn)}function Re(Jt,Sn){xn[Jt]!=Sn&&(Sn===""||Sn==null?(delete xn[Jt],n(27,xn)):n(27,xn[Jt]=Sn,xn))}function $e(Jt){Ot[Jt]||n(32,Ot[Jt]=!0,Ot)}function je(Jt){(!(Jt in Ot)||Ot[Jt])&&n(32,Ot[Jt]=!1,Ot)}function We(Jt){var Sn;return Jt in gi?(Sn=gi[Jt])!==null&&Sn!==void 0?Sn:null:ne().getAttribute(Jt)}function Ge(Jt,Sn){gi[Jt]!==Sn&&n(29,gi[Jt]=Sn,gi)}function mt(Jt){(!(Jt in gi)||gi[Jt]!=null)&&n(29,gi[Jt]=void 0,gi)}function ot(){return Yi.getOrderedList().map(Jt=>Jt.getValue())}function Pe(){return Gi.getUseDefaultValidation()}function ae(Jt){Gi.setUseDefaultValidation(Jt)}function re(){Ti.focus()}function X(){Gi.layout()}function ne(){return Zi}function pe(Jt){H2.call(this,t,Jt)}function xe(Jt){H2.call(this,t,Jt)}function ye(Jt){ta[Jt?"unshift":"push"](()=>{_n=Jt,n(39,_n)})}function De(Jt){ta[Jt?"unshift":"push"](()=>{_n=Jt,n(39,_n)})}function Oe(Jt){ta[Jt?"unshift":"push"](()=>{M=Jt,n(41,M)})}function Ve(Jt){ta[Jt?"unshift":"push"](()=>{b=Jt,n(40,b)})}function Je(Jt){ta[Jt?"unshift":"push"](()=>{Ti=Jt,n(28,Ti)})}const et=()=>Gi&&Gi.handleFocus(),Le=()=>Gi&&Gi.handleBlur(),qe=Jt=>{Ti.focus(),Gi&&Gi.handleClick(mT(Jt))};function dt(Jt){Oi=Jt,n(24,Oi)}const Pt=Jt=>n(36,Yi=Jt.detail);function o(Jt){Bn=Jt,n(31,Bn)}const Me=Jt=>Gi&&Gi.handleMenuItemAction(Jt.detail.index),li=()=>Gi&&Gi.handleMenuClosing(),di=()=>Gi&&Gi.handleMenuClosed(),fi=()=>Gi&&Gi.handleMenuOpened();function ti(Jt){ta[Jt?"unshift":"push"](()=>{Zi=Jt,n(25,Zi)})}const ui=()=>n(37,zn=void 0),Ri=Jt=>n(30,bn=Jt.detail),bi=Jt=>n(38,Wn=Jt.detail),Si=()=>{n(30,bn=void 0),n(38,Wn=void 0)};return t.$$set=Jt=>{e=xr(xr({},e),rc(Jt)),n(53,g=_o(e,c)),"use"in Jt&&n(2,Ze=Jt.use),"class"in Jt&&n(3,nt=Jt.class),"style"in Jt&&n(4,Ke=Jt.style),"ripple"in Jt&&n(5,st=Jt.ripple),"disabled"in Jt&&n(6,ht=Jt.disabled),"variant"in Jt&&n(7,xt=Jt.variant),"noLabel"in Jt&&n(8,zt=Jt.noLabel),"label"in Jt&&n(9,Mt=Jt.label),"value"in Jt&&n(0,Ue=Jt.value),"key"in Jt&&n(56,$t=Jt.key),"dirty"in Jt&&n(55,rt=Jt.dirty),"invalid"in Jt&&n(1,gt=Jt.invalid),"updateInvalid"in Jt&&n(57,At=Jt.updateInvalid),"required"in Jt&&n(10,St=Jt.required),"inputId"in Jt&&n(11,ut=Jt.inputId),"hiddenInput"in Jt&&n(12,Ye=Jt.hiddenInput),"withLeadingIcon"in Jt&&n(13,_t=Jt.withLeadingIcon),"anchor$use"in Jt&&n(14,ct=Jt.anchor$use),"anchor$class"in Jt&&n(15,Ut=Jt.anchor$class),"selectedTextContainer$use"in Jt&&n(16,Ft=Jt.selectedTextContainer$use),"selectedTextContainer$class"in Jt&&n(17,Vt=Jt.selectedTextContainer$class),"selectedText$use"in Jt&&n(18,yi=Jt.selectedText$use),"selectedText$class"in Jt&&n(19,Ci=Jt.selectedText$class),"dropdownIcon$use"in Jt&&n(20,ki=Jt.dropdownIcon$use),"dropdownIcon$class"in Jt&&n(21,Ni=Jt.dropdownIcon$class),"menu$class"in Jt&&n(22,tn=Jt.menu$class),"$$scope"in Jt&&n(87,N=Jt.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&25165825|t.$$.dirty[2]&2&&ie!==Oi)if(n(63,ie=Oi),Gi)Gi.setSelectedIndex(Oi,!1,!0);else{const Jt=ot();Ue!==Jt[Oi]&&n(0,Ue=Jt[Oi])}t.$$.dirty[0]&1&&j0(K,S=Ue,S),t.$$.dirty[0]&8388609|t.$$.dirty[1]&33554432&&Gi&&Gi.getValue()!==$t(Ue)&&Gi.setValue($t(Ue)),t.$$.dirty[0]&8388672&&Gi&&Gi.getDisabled()!==ht&&Gi.setDisabled(ht),t.$$.dirty[0]&8388610|t.$$.dirty[1]&83886080&&Gi&&rt&&Gi.isValid()!==!gt&&(At?n(1,gt=!Gi.isValid()):Gi.setValid(!gt)),t.$$.dirty[0]&8389632&&Gi&&Gi.getRequired()!==St&&Gi.setRequired(St)},[Ue,gt,Ze,nt,Ke,st,ht,xt,zt,Mt,St,ut,Ye,_t,ct,Ut,Ft,Vt,yi,Ci,ki,Ni,tn,Gi,Oi,Zi,sn,xn,Ti,gi,bn,Bn,Ot,an,$n,oi,Yi,zn,Wn,_n,b,M,v,oe,_e,Vi,Xn,U,K,de,Ee,Ce,Re,g,$,rt,$t,At,Pe,ae,re,X,ne,ie,a,pe,xe,ye,De,Oe,Ve,Je,et,Le,qe,dt,Pt,o,Me,li,di,fi,ti,ui,Ri,bi,Si,N]}class o0 extends Ha{constructor(e){super(),ja(this,e,_T,dT,Ca,{use:2,class:3,style:4,ripple:5,disabled:6,variant:7,noLabel:8,label:9,value:0,key:56,dirty:55,invalid:1,updateInvalid:57,required:10,inputId:11,hiddenInput:12,withLeadingIcon:13,anchor$use:14,anchor$class:15,selectedTextContainer$use:16,selectedTextContainer$class:17,selectedText$use:18,selectedText$class:19,dropdownIcon$use:20,dropdownIcon$class:21,menu$class:22,getUseDefaultValidation:58,setUseDefaultValidation:59,focus:60,layout:61,getElement:62},null,[-1,-1,-1,-1])}get getUseDefaultValidation(){return this.$$.ctx[58]}get setUseDefaultValidation(){return this.$$.ctx[59]}get focus(){return this.$$.ctx[60]}get layout(){return this.$$.ctx[61]}get getElement(){return this.$$.ctx[62]}}function yT(t){let e;const n=t[11].default,c=Zl(n,t,t[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,v){c&&c.m(g,v),e=!0},p(g,v){c&&c.p&&(!e||v&8192)&&Ql(c,n,g,g[13],e?$l(n,g[13],v,null):Wl(g[13]),null)},i(g){e||(Fi(c,g),e=!0)},o(g){Xi(c,g),e=!1},d(g){c&&c.d(g)}}}function vT(t){let e,n;const c=[{use:t[3]},{"data-value":t[0]},{value:t[0]},{selected:t[2]},t[6]];let g={$$slots:{default:[yT]},$$scope:{ctx:t}};for(let v=0;v<c.length;v+=1)g=xr(g,c[v]);return e=new OC({props:g}),t[12](e),{c(){Cr(e.$$.fragment)},l(v){Rr(e.$$.fragment,v)},m(v,S){Tr(e,v,S),n=!0},p(v,[S]){const a=S&77?xa(c,[S&8&&{use:v[3]},S&1&&{"data-value":v[0]},S&1&&{value:v[0]},S&4&&{selected:v[2]},S&64&&qs(v[6])]):{};S&8192&&(a.$$scope={dirty:S,ctx:v}),e.$set(a)},i(v){n||(Fi(e.$$.fragment,v),n=!0)},o(v){Xi(e.$$.fragment,v),n=!1},d(v){t[12](null),kr(e,v)}}}function xT(t,e,n){let c,g;const v=["use","class","value","getElement"];let S=_o(e,v),a,N,{$$slots:$={},$$scope:he}=e;const oe=Ec(bc());let{use:ce=[]}=e;const _e="";let{value:Ze=""}=e,nt;const Ke=Mu("SMUI:select:selectedText");Il(t,Ke,Mt=>n(14,a=Mt));const st=Mu("SMUI:select:value");Il(t,st,Mt=>n(10,N=Mt)),mu("SMUI:list:item:role","option"),wc(ht),km(ht);function ht(){g&&nt&&j0(Ke,a=nt.getPrimaryText(),a)}function xt(){return nt.getElement()}function zt(Mt){ta[Mt?"unshift":"push"](()=>{nt=Mt,n(1,nt)})}return t.$$set=Mt=>{e=xr(xr({},e),rc(Mt)),n(6,S=_o(e,v)),"use"in Mt&&n(7,ce=Mt.use),"value"in Mt&&n(0,Ze=Mt.value),"$$scope"in Mt&&n(13,he=Mt.$$scope)},t.$$.update=()=>{t.$$.dirty&128&&n(3,c=[oe,...ce]),t.$$.dirty&1025&&n(2,g=Ze!=null&&Ze!==""&&N===Ze)},[Ze,nt,g,c,Ke,st,S,ce,_e,xt,N,$,zt,he]}class d0 extends Ha{constructor(e){super(),ja(this,e,xT,vT,Ca,{use:7,class:8,value:0,getElement:9})}get class(){return this.$$.ctx[8]}get getElement(){return this.$$.ctx[9]}}function b_(t,e,n="*ibm",c=!1){let g=Fv[n](t,e);return c?["step",["get",m],"#ff00ff",-1,"#0000ff",0,"#ffffff",1,"#FF7F11"]:g}function bT(t="*ibm_flip"){return[[-1,"#dddddd"],[.5,"#648FFFcc"],[1,"#7580ed"],[1.5,"#8671db"],[2,"#9762c9"],[2.5,"#a853b7"],[5,"#b944a5"],[10,"#ca3593"],[25,"#DC267Fcc"],[75,"#FFB000cc"],[90,"#e64c5a"],[97.5,"#eb6048"],[98,"#f07436"],[98.5,"#f58824"],[99,"#fa9c12"],[99.5,"#FFB000cc"]]}function wT(t="*ibm_flip"){let e=Fv[t](0,1),n=[];for(let c of e)n.push(c[1]);return n}function jo(t,e,n){return n*(e-t)+t}const Fv={"*ibm":function(e,n){return[[-1,"#dddddd"],[e,"#648FFF","Very low"],[jo(e,n,.25),"#785EF0"],[jo(e,n,.5),"#DC267F","Expected"],[jo(e,n,.75),"#FE6100"],[n,"#FFB000","Very high"]]},"*ibm_flip":function(e,n){return[[-1,"#dddddd"],[e,"#FFB000","Very low"],[jo(e,n,.25),"#FE6100"],[jo(e,n,.5),"#DC267F","Expected"],[jo(e,n,.75),"#785EF0"],[n,"#648FFF","Very high"]]},orGrBlu:function(e,n){return[[-1,"#dddddd"],[e,"#F9A825","Very low"],[jo(e,n,.35),"#e8f4c4"],[jo(e,n,.5),"#00E676","Expected"],[jo(e,n,.75),"#3d9ab8"],[jo(e,n,.85),"#318ab5"],[n,"#2a4e9b","Very high"]]},blGr:function(e,n){return[[-1,"#dddddd"],[e,"#000000","Very low"],[n,"#00ff00","Very high"]]},blBluCyWt:function(e,n){return[[-1,"#dddddd","Missing"],[e,"#000000","Very low"],[jo(e,n,.5),"#0000ff","Expected"],[jo(e,n,.75),"#00ffff"],[n,"#ffffff","Very high"]]},rdYlGr:function(e,n){return[[-1,"#dddddd","Missing"],[e,"#fd5533","Very low"],[jo(e,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},"*mgYlGr":function(e,n){return[[-1,"#dddddd","Missing"],[e,"#F15C8E","Very low"],[jo(e,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},grYlRd:function(e,n){return[[-1,"#dddddd","Missing"],[e,"#00ff33","Very low biodiversity"],[jo(e,n,.5),"#ffff33","Normal biodiversity"],[n,"#ff3300","Very high biodiversity"]]},"*census":function(e,n){return[[-1,"#dddddd","Missing"],[e,"#efd100","Very low biodiversity"],[jo(e,n,.5),"#4eb87b","Normal biodiversity"],[n,"#007fc4","Very high biodiversity"]]},seqseq:function(e,n){return[[-1,"#dddddd","Missing"],[e,"#de4fa6","Very low biodiversity"],[jo(e,n,.5),"#4fadd0","Normal biodiversity"],[n,"#2a1a8a","Very high biodiversity"]]},"*parula":function(e,n){return[[-1,"#dddddd"],[e,"#352a87","Very low"],[jo(e,n,.167),"#0469df"],[jo(e,n,.33),"#06a0cb"],[jo(e,n,.5),"#1fb2ac","Expected"],[jo(e,n,.667),"#a3bd6a"],[jo(e,n,.833),"#fcc336"],[n,"#f8f611","Very high"]]},"*parula_flip":function(e,n){return[[-1,"#dddddd"],[e,"#f8f611","Very low"],[jo(e,n,.167),"#fcc336"],[jo(e,n,.33),"#a3bd6a"],[jo(e,n,.5),"#1fb2ac","Expected"],[jo(e,n,.667),"#06a0cb"],[jo(e,n,.833),"#0469df"],[n,"#352a87","Very high"]]}};function ym(){return{100:"#e9f6fc",200:"#b9e4f7",300:"#89d1f0",400:"#59bee9",500:"#29abe2",600:"#2186af",700:"#175f7c",800:"#0d3849",900:"#031116"}}var s0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ov(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function c(){return this instanceof c?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(c){var g=Object.getOwnPropertyDescriptor(t,c);Object.defineProperty(n,c,g.get?g:{enumerable:!0,get:function(){return t[c]}})}),n}var k3={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.0/LICENSE.txt
 */(function(t,e){(function(n,c){t.exports=c()})(s0,function(){var n={},c={};function g(S,a,N){if(c[S]=N,S==="index"){var $="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",he={};return c.shared(he),c.index(n,he),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([$],{type:"text/javascript"}))),n}}g("shared",["exports"],function(S){function a(_,h,w,P){return new(w||(w=Promise))(function(H,J){function ee(Ne){try{Te(P.next(Ne))}catch(f){J(f)}}function ge(Ne){try{Te(P.throw(Ne))}catch(f){J(f)}}function Te(Ne){var f;Ne.done?H(Ne.value):(f=Ne.value,f instanceof w?f:new w(function(u){u(f)})).then(ee,ge)}Te((P=P.apply(_,h||[])).next())})}function N(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}typeof SuppressedError=="function"&&SuppressedError;var $=he;function he(_,h){this.x=_,this.y=h}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(_){return this.clone()._add(_)},sub:function(_){return this.clone()._sub(_)},multByPoint:function(_){return this.clone()._multByPoint(_)},divByPoint:function(_){return this.clone()._divByPoint(_)},mult:function(_){return this.clone()._mult(_)},div:function(_){return this.clone()._div(_)},rotate:function(_){return this.clone()._rotate(_)},rotateAround:function(_,h){return this.clone()._rotateAround(_,h)},matMult:function(_){return this.clone()._matMult(_)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(_){return this.x===_.x&&this.y===_.y},dist:function(_){return Math.sqrt(this.distSqr(_))},distSqr:function(_){var h=_.x-this.x,w=_.y-this.y;return h*h+w*w},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(_){return Math.atan2(this.y-_.y,this.x-_.x)},angleWith:function(_){return this.angleWithSep(_.x,_.y)},angleWithSep:function(_,h){return Math.atan2(this.x*h-this.y*_,this.x*_+this.y*h)},_matMult:function(_){var h=_[2]*this.x+_[3]*this.y;return this.x=_[0]*this.x+_[1]*this.y,this.y=h,this},_add:function(_){return this.x+=_.x,this.y+=_.y,this},_sub:function(_){return this.x-=_.x,this.y-=_.y,this},_mult:function(_){return this.x*=_,this.y*=_,this},_div:function(_){return this.x/=_,this.y/=_,this},_multByPoint:function(_){return this.x*=_.x,this.y*=_.y,this},_divByPoint:function(_){return this.x/=_.x,this.y/=_.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var _=this.y;return this.y=this.x,this.x=-_,this},_rotate:function(_){var h=Math.cos(_),w=Math.sin(_),P=w*this.x+h*this.y;return this.x=h*this.x-w*this.y,this.y=P,this},_rotateAround:function(_,h){var w=Math.cos(_),P=Math.sin(_),H=h.y+P*(this.x-h.x)+w*(this.y-h.y);return this.x=h.x+w*(this.x-h.x)-P*(this.y-h.y),this.y=H,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(_){return _ instanceof he?_:Array.isArray(_)?new he(_[0],_[1]):_};var oe=N($),ce=_e;function _e(_,h,w,P){this.cx=3*_,this.bx=3*(w-_)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(P-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=_,this.p1y=h,this.p2x=w,this.p2y=P}_e.prototype={sampleCurveX:function(_){return((this.ax*_+this.bx)*_+this.cx)*_},sampleCurveY:function(_){return((this.ay*_+this.by)*_+this.cy)*_},sampleCurveDerivativeX:function(_){return(3*this.ax*_+2*this.bx)*_+this.cx},solveCurveX:function(_,h){if(h===void 0&&(h=1e-6),_<0)return 0;if(_>1)return 1;for(var w=_,P=0;P<8;P++){var H=this.sampleCurveX(w)-_;if(Math.abs(H)<h)return w;var J=this.sampleCurveDerivativeX(w);if(Math.abs(J)<1e-6)break;w-=H/J}var ee=0,ge=1;for(w=_,P=0;P<20&&(H=this.sampleCurveX(w),!(Math.abs(H-_)<h));P++)_>H?ee=w:ge=w,w=.5*(ge-ee)+ee;return w},solve:function(_,h){return this.sampleCurveY(this.solveCurveX(_,h))}};var Ze=N(ce);let nt,Ke;function st(){return nt==null&&(nt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),nt}function ht(){if(Ke==null&&(Ke=!1,st())){const h=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(h){for(let P=0;P<5*5;P++){const H=4*P;h.fillStyle=`rgb(${H},${H+1},${H+2})`,h.fillRect(P%5,Math.floor(P/5),1,1)}const w=h.getImageData(0,0,5,5).data;for(let P=0;P<5*5*4;P++)if(P%4!=3&&w[P]!==P){Ke=!0;break}}}return Ke||!1}function xt(_,h,w,P){const H=new Ze(_,h,w,P);return function(J){return H.solve(J)}}const zt=xt(.25,.1,.25,1);function Mt(_,h,w){return Math.min(w,Math.max(h,_))}function Ue(_,h,w){const P=w-h,H=((_-h)%P+P)%P+h;return H===h?w:H}function $t(_,...h){for(const w of h)for(const P in w)_[P]=w[P];return _}let rt=1;function gt(_,h,w){const P={};for(const H in _)P[H]=h.call(w||this,_[H],H,_);return P}function At(_,h,w){const P={};for(const H in _)h.call(w||this,_[H],H,_)&&(P[H]=_[H]);return P}function yt(_){return Array.isArray(_)?_.map(yt):typeof _=="object"&&_?gt(_,yt):_}const St={};function ut(_){St[_]||(typeof console<"u"&&console.warn(_),St[_]=!0)}function Ye(_,h,w){return(w.y-_.y)*(h.x-_.x)>(h.y-_.y)*(w.x-_.x)}function _t(_){let h=0;for(let w,P,H=0,J=_.length,ee=J-1;H<J;ee=H++)w=_[H],P=_[ee],h+=(P.x-w.x)*(w.y+P.y);return h}function ct(_){return typeof WorkerGlobalScope<"u"&&_!==void 0&&_ instanceof WorkerGlobalScope}let Ut=null;function Ft(_){return typeof ImageBitmap<"u"&&_ instanceof ImageBitmap}const Vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function yi(_,h,w,P,H){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const J=new VideoFrame(_,{timestamp:0});try{const ee=J==null?void 0:J.format;if(!ee||!ee.startsWith("BGR")&&!ee.startsWith("RGB"))throw new Error(`Unrecognized format ${ee}`);const ge=ee.startsWith("BGR"),Te=new Uint8ClampedArray(P*H*4);if(yield J.copyTo(Te,function(Ne,f,u,p,E){const B=4*Math.max(-f,0),q=(Math.max(0,u)-u)*p*4+B,W=4*p,se=Math.max(0,f),fe=Math.max(0,u);return{rect:{x:se,y:fe,width:Math.min(Ne.width,f+p)-se,height:Math.min(Ne.height,u+E)-fe},layout:[{offset:q,stride:W}]}}(_,h,w,P,H)),ge)for(let Ne=0;Ne<Te.length;Ne+=4){const f=Te[Ne];Te[Ne]=Te[Ne+2],Te[Ne+2]=f}return Te}finally{J.close()}})}let Ci,ki;const Ni="AbortError";function tn(){return new Error(Ni)}const Zi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Gi(_){return Zi.REGISTERED_PROTOCOLS[_.substring(0,_.indexOf("://"))]}const sn="global-dispatcher";class xn extends Error{constructor(h,w,P,H){super(`AJAXError: ${w} (${h}): ${P}`),this.status=h,this.statusText=w,this.url=P,this.body=H}}const Ti=()=>ct(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,gi=function(_,h){if(/:\/\//.test(_.url)&&!/^https?:|^file:/.test(_.url)){const P=Gi(_.url);if(P)return P(_,h);if(ct(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:_,targetMapId:sn},h)}if(!(/^file:/.test(w=_.url)||/^file:/.test(Ti())&&!/^\w+:/.test(w))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(P,H){return a(this,void 0,void 0,function*(){const J=new Request(P.url,{method:P.method||"GET",body:P.body,credentials:P.credentials,headers:P.headers,cache:P.cache,referrer:Ti(),signal:H.signal});P.type==="json"&&J.headers.set("Accept","application/json");const ee=yield fetch(J);if(!ee.ok){const Ne=yield ee.blob();throw new xn(ee.status,ee.statusText,P.url,Ne)}const ge=P.type==="arrayBuffer"||P.type==="image"?ee.arrayBuffer():P.type==="json"?ee.json():ee.text(),Te=yield ge;if(H.signal.aborted)throw tn();return{data:Te,cacheControl:ee.headers.get("Cache-Control"),expires:ee.headers.get("Expires")}})}(_,h);if(ct(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:_,mustQueue:!0,targetMapId:sn},h)}var w;return function(P,H){return new Promise((J,ee)=>{const ge=new XMLHttpRequest;ge.open(P.method||"GET",P.url,!0),P.type!=="arrayBuffer"&&P.type!=="image"||(ge.responseType="arraybuffer");for(const Te in P.headers)ge.setRequestHeader(Te,P.headers[Te]);P.type==="json"&&(ge.responseType="text",ge.setRequestHeader("Accept","application/json")),ge.withCredentials=P.credentials==="include",ge.onerror=()=>{ee(new Error(ge.statusText))},ge.onload=()=>{if(!H.signal.aborted)if((ge.status>=200&&ge.status<300||ge.status===0)&&ge.response!==null){let Te=ge.response;if(P.type==="json")try{Te=JSON.parse(ge.response)}catch(Ne){return void ee(Ne)}J({data:Te,cacheControl:ge.getResponseHeader("Cache-Control"),expires:ge.getResponseHeader("Expires")})}else{const Te=new Blob([ge.response],{type:ge.getResponseHeader("Content-Type")});ee(new xn(ge.status,ge.statusText,P.url,Te))}},H.signal.addEventListener("abort",()=>{ge.abort(),ee(tn())}),ge.send(P.body)})}(_,h)};function Oi(_){if(!_||_.indexOf("://")<=0||_.indexOf("data:image/")===0||_.indexOf("blob:")===0)return!0;const h=new URL(_),w=window.location;return h.protocol===w.protocol&&h.host===w.host}function Vi(_,h,w){w[_]&&w[_].indexOf(h)!==-1||(w[_]=w[_]||[],w[_].push(h))}function bn(_,h,w){if(w&&w[_]){const P=w[_].indexOf(h);P!==-1&&w[_].splice(P,1)}}class wn{constructor(h,w={}){$t(this,w),this.type=h}}class xi extends wn{constructor(h,w={}){super("error",$t({error:h},w))}}class Bn{on(h,w){return this._listeners=this._listeners||{},Vi(h,w,this._listeners),this}off(h,w){return bn(h,w,this._listeners),bn(h,w,this._oneTimeListeners),this}once(h,w){return w?(this._oneTimeListeners=this._oneTimeListeners||{},Vi(h,w,this._oneTimeListeners),this):new Promise(P=>this.once(h,P))}fire(h,w){typeof h=="string"&&(h=new wn(h,w||{}));const P=h.type;if(this.listens(P)){h.target=this;const H=this._listeners&&this._listeners[P]?this._listeners[P].slice():[];for(const ge of H)ge.call(this,h);const J=this._oneTimeListeners&&this._oneTimeListeners[P]?this._oneTimeListeners[P].slice():[];for(const ge of J)bn(P,ge,this._oneTimeListeners),ge.call(this,h);const ee=this._eventedParent;ee&&($t(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),ee.fire(h))}else h instanceof xi&&console.error(h.error);return this}listens(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)}setEventedParent(h,w){return this._eventedParent=h,this._eventedParentData=w,this}}var Ot={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const an=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function $n(_,h){const w={};for(const P in _)P!=="ref"&&(w[P]=_[P]);return an.forEach(P=>{P in h&&(w[P]=h[P])}),w}function oi(_,h){if(Array.isArray(_)){if(!Array.isArray(h)||_.length!==h.length)return!1;for(let w=0;w<_.length;w++)if(!oi(_[w],h[w]))return!1;return!0}if(typeof _=="object"&&_!==null&&h!==null){if(typeof h!="object"||Object.keys(_).length!==Object.keys(h).length)return!1;for(const w in _)if(!oi(_[w],h[w]))return!1;return!0}return _===h}function Yi(_,h){_.push(h)}function Xn(_,h,w){Yi(w,{command:"addSource",args:[_,h[_]]})}function zn(_,h,w){Yi(h,{command:"removeSource",args:[_]}),w[_]=!0}function Wn(_,h,w,P){zn(_,w,P),Xn(_,h,w)}function _n(_,h,w){let P;for(P in _[w])if(Object.prototype.hasOwnProperty.call(_[w],P)&&P!=="data"&&!oi(_[w][P],h[w][P]))return!1;for(P in h[w])if(Object.prototype.hasOwnProperty.call(h[w],P)&&P!=="data"&&!oi(_[w][P],h[w][P]))return!1;return!0}function b(_,h,w,P,H,J){_=_||{},h=h||{};for(const ee in _)Object.prototype.hasOwnProperty.call(_,ee)&&(oi(_[ee],h[ee])||w.push({command:J,args:[P,ee,h[ee],H]}));for(const ee in h)Object.prototype.hasOwnProperty.call(h,ee)&&!Object.prototype.hasOwnProperty.call(_,ee)&&(oi(_[ee],h[ee])||w.push({command:J,args:[P,ee,h[ee],H]}))}function M(_){return _.id}function U(_,h){return _[h.id]=h,_}class K{constructor(h,w,P,H){this.message=(h?`${h}: `:"")+P,H&&(this.identifier=H),w!=null&&w.__line__&&(this.line=w.__line__)}}function ie(_,...h){for(const w of h)for(const P in w)_[P]=w[P];return _}class de extends Error{constructor(h,w){super(w),this.message=w,this.key=h}}class be{constructor(h,w=[]){this.parent=h,this.bindings={};for(const[P,H]of w)this.bindings[P]=H}concat(h){return new be(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}const Ee={kind:"null"},Ce={kind:"number"},Re={kind:"string"},$e={kind:"boolean"},je={kind:"color"},We={kind:"object"},Ge={kind:"value"},mt={kind:"collator"},ot={kind:"formatted"},Pe={kind:"padding"},ae={kind:"resolvedImage"},re={kind:"variableAnchorOffsetCollection"};function X(_,h){return{kind:"array",itemType:_,N:h}}function ne(_){if(_.kind==="array"){const h=ne(_.itemType);return typeof _.N=="number"?`array<${h}, ${_.N}>`:_.itemType.kind==="value"?"array":`array<${h}>`}return _.kind}const pe=[Ee,Ce,Re,$e,je,ot,We,X(Ge),Pe,ae,re];function xe(_,h){if(h.kind==="error")return null;if(_.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!xe(_.itemType,h.itemType))&&(typeof _.N!="number"||_.N===h.N))return null}else{if(_.kind===h.kind)return null;if(_.kind==="value"){for(const w of pe)if(!xe(w,h))return null}}return`Expected ${ne(_)} but found ${ne(h)} instead.`}function ye(_,h){return h.some(w=>w.kind===_.kind)}function De(_,h){return h.some(w=>w==="null"?_===null:w==="array"?Array.isArray(_):w==="object"?_&&!Array.isArray(_)&&typeof _=="object":w===typeof _)}function Oe(_,h){return _.kind==="array"&&h.kind==="array"?_.itemType.kind===h.itemType.kind&&typeof _.N=="number":_.kind===h.kind}const Ve=.96422,Je=.82521,et=4/29,Le=6/29,qe=3*Le*Le,dt=Le*Le*Le,Pt=Math.PI/180,o=180/Math.PI;function Me(_){return(_%=360)<0&&(_+=360),_}function li([_,h,w,P]){let H,J;const ee=fi((.2225045*(_=di(_))+.7168786*(h=di(h))+.0606169*(w=di(w)))/1);_===h&&h===w?H=J=ee:(H=fi((.4360747*_+.3850649*h+.1430804*w)/Ve),J=fi((.0139322*_+.0971045*h+.7141733*w)/Je));const ge=116*ee-16;return[ge<0?0:ge,500*(H-ee),200*(ee-J),P]}function di(_){return _<=.04045?_/12.92:Math.pow((_+.055)/1.055,2.4)}function fi(_){return _>dt?Math.pow(_,1/3):_/qe+et}function ti([_,h,w,P]){let H=(_+16)/116,J=isNaN(h)?H:H+h/500,ee=isNaN(w)?H:H-w/200;return H=1*Ri(H),J=Ve*Ri(J),ee=Je*Ri(ee),[ui(3.1338561*J-1.6168667*H-.4906146*ee),ui(-.9787684*J+1.9161415*H+.033454*ee),ui(.0719453*J-.2289914*H+1.4052427*ee),P]}function ui(_){return(_=_<=.00304?12.92*_:1.055*Math.pow(_,1/2.4)-.055)<0?0:_>1?1:_}function Ri(_){return _>Le?_*_*_:qe*(_-et)}function bi(_){return parseInt(_.padEnd(2,_),16)/255}function Si(_,h){return Jt(h?_/100:_,0,1)}function Jt(_,h,w){return Math.min(Math.max(h,_),w)}function Sn(_){return!_.some(Number.isNaN)}const ur={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class mn{constructor(h,w,P,H=1,J=!0){this.r=h,this.g=w,this.b=P,this.a=H,J||(this.r*=H,this.g*=H,this.b*=H,H||this.overwriteGetter("rgb",[h,w,P,H]))}static parse(h){if(h instanceof mn)return h;if(typeof h!="string")return;const w=function(P){if((P=P.toLowerCase().trim())==="transparent")return[0,0,0,0];const H=ur[P];if(H){const[ee,ge,Te]=H;return[ee/255,ge/255,Te/255,1]}if(P.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(P)){const ee=P.length<6?1:2;let ge=1;return[bi(P.slice(ge,ge+=ee)),bi(P.slice(ge,ge+=ee)),bi(P.slice(ge,ge+=ee)),bi(P.slice(ge,ge+ee)||"ff")]}if(P.startsWith("rgb")){const ee=P.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(ee){const[ge,Te,Ne,f,u,p,E,B,q,W,se,fe]=ee,ve=[f||" ",E||" ",W].join("");if(ve==="  "||ve==="  /"||ve===",,"||ve===",,,"){const Be=[Ne,p,q].join(""),He=Be==="%%%"?100:Be===""?255:0;if(He){const it=[Jt(+Te/He,0,1),Jt(+u/He,0,1),Jt(+B/He,0,1),se?Si(+se,fe):1];if(Sn(it))return it}}return}}const J=P.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(J){const[ee,ge,Te,Ne,f,u,p,E,B]=J,q=[Te||" ",f||" ",p].join("");if(q==="  "||q==="  /"||q===",,"||q===",,,"){const W=[+ge,Jt(+Ne,0,100),Jt(+u,0,100),E?Si(+E,B):1];if(Sn(W))return function([se,fe,ve,Be]){function He(it){const pt=(it+se/30)%12,vt=fe*Math.min(ve,1-ve);return ve-vt*Math.max(-1,Math.min(pt-3,9-pt,1))}return se=Me(se),fe/=100,ve/=100,[He(0),He(8),He(4),Be]}(W)}}}(h);return w?new mn(...w,!1):void 0}get rgb(){const{r:h,g:w,b:P,a:H}=this,J=H||1/0;return this.overwriteGetter("rgb",[h/J,w/J,P/J,H])}get hcl(){return this.overwriteGetter("hcl",function(h){const[w,P,H,J]=li(h),ee=Math.sqrt(P*P+H*H);return[Math.round(1e4*ee)?Me(Math.atan2(H,P)*o):NaN,ee,w,J]}(this.rgb))}get lab(){return this.overwriteGetter("lab",li(this.rgb))}overwriteGetter(h,w){return Object.defineProperty(this,h,{value:w}),w}toString(){const[h,w,P,H]=this.rgb;return`rgba(${[h,w,P].map(J=>Math.round(255*J)).join(",")},${H})`}}mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);class Hn{constructor(h,w,P){this.sensitivity=h?w?"variant":"case":w?"accent":"base",this.locale=P,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,w){return this.collator.compare(h,w)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yr{constructor(h,w,P,H,J){this.text=h,this.image=w,this.scale=P,this.fontStack=H,this.textColor=J}}class Qi{constructor(h){this.sections=h}static fromString(h){return new Qi([new Yr(h,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(h=>h.text.length!==0||h.image&&h.image.name.length!==0)}static factory(h){return h instanceof Qi?h:Qi.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map(h=>h.text).join("")}}class hr{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof hr)return h;if(typeof h=="number")return new hr([h,h,h,h]);if(Array.isArray(h)&&!(h.length<1||h.length>4)){for(const w of h)if(typeof w!="number")return;switch(h.length){case 1:h=[h[0],h[0],h[0],h[0]];break;case 2:h=[h[0],h[1],h[0],h[1]];break;case 3:h=[h[0],h[1],h[2],h[1]]}return new hr(h)}}toString(){return JSON.stringify(this.values)}}const Gn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Xt{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof Xt)return h;if(Array.isArray(h)&&!(h.length<1)&&h.length%2==0){for(let w=0;w<h.length;w+=2){const P=h[w],H=h[w+1];if(typeof P!="string"||!Gn.has(P)||!Array.isArray(H)||H.length!==2||typeof H[0]!="number"||typeof H[1]!="number")return}return new Xt(h)}}toString(){return JSON.stringify(this.values)}}class en{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new en({name:h,available:!1}):null}}function qt(_,h,w,P){return typeof _=="number"&&_>=0&&_<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof w=="number"&&w>=0&&w<=255?P===void 0||typeof P=="number"&&P>=0&&P<=1?null:`Invalid rgba value [${[_,h,w,P].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof P=="number"?[_,h,w,P]:[_,h,w]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function kn(_){if(_===null||typeof _=="string"||typeof _=="boolean"||typeof _=="number"||_ instanceof mn||_ instanceof Hn||_ instanceof Qi||_ instanceof hr||_ instanceof Xt||_ instanceof en)return!0;if(Array.isArray(_)){for(const h of _)if(!kn(h))return!1;return!0}if(typeof _=="object"){for(const h in _)if(!kn(_[h]))return!1;return!0}return!1}function Ar(_){if(_===null)return Ee;if(typeof _=="string")return Re;if(typeof _=="boolean")return $e;if(typeof _=="number")return Ce;if(_ instanceof mn)return je;if(_ instanceof Hn)return mt;if(_ instanceof Qi)return ot;if(_ instanceof hr)return Pe;if(_ instanceof Xt)return re;if(_ instanceof en)return ae;if(Array.isArray(_)){const h=_.length;let w;for(const P of _){const H=Ar(P);if(w){if(w===H)continue;w=Ge;break}w=H}return X(w||Ge,h)}return We}function js(_){const h=typeof _;return _===null?"":h==="string"||h==="number"||h==="boolean"?String(_):_ instanceof mn||_ instanceof Qi||_ instanceof hr||_ instanceof Xt||_ instanceof en?_.toString():JSON.stringify(_)}class Qr{constructor(h,w){this.type=h,this.value=w}static parse(h,w){if(h.length!==2)return w.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!kn(h[1]))return w.error("invalid value");const P=h[1];let H=Ar(P);const J=w.expectedType;return H.kind!=="array"||H.N!==0||!J||J.kind!=="array"||typeof J.N=="number"&&J.N!==0||(H=J),new Qr(H,P)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Gt{constructor(h){this.name="ExpressionEvaluationError",this.message=h}toJSON(){return this.message}}const fr={string:Re,number:Ce,boolean:$e,object:We};class Bt{constructor(h,w){this.type=h,this.args=w}static parse(h,w){if(h.length<2)return w.error("Expected at least one argument.");let P,H=1;const J=h[0];if(J==="array"){let ge,Te;if(h.length>2){const Ne=h[1];if(typeof Ne!="string"||!(Ne in fr)||Ne==="object")return w.error('The item type argument of "array" must be one of string, number, boolean',1);ge=fr[Ne],H++}else ge=Ge;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return w.error('The length argument to "array" must be a positive integer literal',2);Te=h[2],H++}P=X(ge,Te)}else{if(!fr[J])throw new Error(`Types doesn't contain name = ${J}`);P=fr[J]}const ee=[];for(;H<h.length;H++){const ge=w.parse(h[H],H,Ge);if(!ge)return null;ee.push(ge)}return new Bt(P,ee)}evaluate(h){for(let w=0;w<this.args.length;w++){const P=this.args[w].evaluate(h);if(!xe(this.type,Ar(P)))return P;if(w===this.args.length-1)throw new Gt(`Expected value to be of type ${ne(this.type)}, but found ${ne(Ar(P))} instead.`)}throw new Error}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const Gr={"to-boolean":$e,"to-color":je,"to-number":Ce,"to-string":Re};class Zs{constructor(h,w){this.type=h,this.args=w}static parse(h,w){if(h.length<2)return w.error("Expected at least one argument.");const P=h[0];if(!Gr[P])throw new Error(`Can't parse ${P} as it is not part of the known types`);if((P==="to-boolean"||P==="to-string")&&h.length!==2)return w.error("Expected one argument.");const H=Gr[P],J=[];for(let ee=1;ee<h.length;ee++){const ge=w.parse(h[ee],ee,Ge);if(!ge)return null;J.push(ge)}return new Zs(H,J)}evaluate(h){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(h);case"color":{let w,P;for(const H of this.args){if(w=H.evaluate(h),P=null,w instanceof mn)return w;if(typeof w=="string"){const J=h.parseColor(w);if(J)return J}else if(Array.isArray(w)&&(P=w.length<3||w.length>4?`Invalid rbga value ${JSON.stringify(w)}: expected an array containing either three or four numeric values.`:qt(w[0],w[1],w[2],w[3]),!P))return new mn(w[0]/255,w[1]/255,w[2]/255,w[3])}throw new Gt(P||`Could not parse color from value '${typeof w=="string"?w:JSON.stringify(w)}'`)}case"padding":{let w;for(const P of this.args){w=P.evaluate(h);const H=hr.parse(w);if(H)return H}throw new Gt(`Could not parse padding from value '${typeof w=="string"?w:JSON.stringify(w)}'`)}case"variableAnchorOffsetCollection":{let w;for(const P of this.args){w=P.evaluate(h);const H=Xt.parse(w);if(H)return H}throw new Gt(`Could not parse variableAnchorOffsetCollection from value '${typeof w=="string"?w:JSON.stringify(w)}'`)}case"number":{let w=null;for(const P of this.args){if(w=P.evaluate(h),w===null)return 0;const H=Number(w);if(!isNaN(H))return H}throw new Gt(`Could not convert ${JSON.stringify(w)} to number.`)}case"formatted":return Qi.fromString(js(this.args[0].evaluate(h)));case"resolvedImage":return en.fromString(js(this.args[0].evaluate(h)));default:return js(this.args[0].evaluate(h))}}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const pa=["Unknown","Point","LineString","Polygon"];class Fr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?pa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(h){let w=this._parseColorCache[h];return w||(w=this._parseColorCache[h]=mn.parse(h)),w}}class Za{constructor(h,w,P=[],H,J=new be,ee=[]){this.registry=h,this.path=P,this.key=P.map(ge=>`[${ge}]`).join(""),this.scope=J,this.errors=ee,this.expectedType=H,this._isConstant=w}parse(h,w,P,H,J={}){return w?this.concat(w,P,H)._parse(h,J):this._parse(h,J)}_parse(h,w){function P(H,J,ee){return ee==="assert"?new Bt(J,[H]):ee==="coerce"?new Zs(J,[H]):H}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const H=h[0];if(typeof H!="string")return this.error(`Expression name must be a string, but found ${typeof H} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const J=this.registry[H];if(J){let ee=J.parse(h,this);if(!ee)return null;if(this.expectedType){const ge=this.expectedType,Te=ee.type;if(ge.kind!=="string"&&ge.kind!=="number"&&ge.kind!=="boolean"&&ge.kind!=="object"&&ge.kind!=="array"||Te.kind!=="value")if(ge.kind!=="color"&&ge.kind!=="formatted"&&ge.kind!=="resolvedImage"||Te.kind!=="value"&&Te.kind!=="string")if(ge.kind!=="padding"||Te.kind!=="value"&&Te.kind!=="number"&&Te.kind!=="array")if(ge.kind!=="variableAnchorOffsetCollection"||Te.kind!=="value"&&Te.kind!=="array"){if(this.checkSubtype(ge,Te))return null}else ee=P(ee,ge,w.typeAnnotation||"coerce");else ee=P(ee,ge,w.typeAnnotation||"coerce");else ee=P(ee,ge,w.typeAnnotation||"coerce");else ee=P(ee,ge,w.typeAnnotation||"assert")}if(!(ee instanceof Qr)&&ee.type.kind!=="resolvedImage"&&this._isConstant(ee)){const ge=new Fr;try{ee=new Qr(ee.type,ee.evaluate(ge))}catch(Te){return this.error(Te.message),null}}return ee}return this.error(`Unknown expression "${H}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,w,P){const H=typeof h=="number"?this.path.concat(h):this.path,J=P?this.scope.concat(P):this.scope;return new Za(this.registry,this._isConstant,H,w||null,J,this.errors)}error(h,...w){const P=`${this.key}${w.map(H=>`[${H}]`).join("")}`;this.errors.push(new de(P,h))}checkSubtype(h,w){const P=xe(h,w);return P&&this.error(P),P}}class Oo{constructor(h,w,P){this.type=mt,this.locale=P,this.caseSensitive=h,this.diacriticSensitive=w}static parse(h,w){if(h.length!==2)return w.error("Expected one argument.");const P=h[1];if(typeof P!="object"||Array.isArray(P))return w.error("Collator options argument must be an object.");const H=w.parse(P["case-sensitive"]!==void 0&&P["case-sensitive"],1,$e);if(!H)return null;const J=w.parse(P["diacritic-sensitive"]!==void 0&&P["diacritic-sensitive"],1,$e);if(!J)return null;let ee=null;return P.locale&&(ee=w.parse(P.locale,1,Re),!ee)?null:new Oo(H,J,ee)}evaluate(h){return new Hn(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}}const Qa=8192;function ia(_,h){_[0]=Math.min(_[0],h[0]),_[1]=Math.min(_[1],h[1]),_[2]=Math.max(_[2],h[0]),_[3]=Math.max(_[3],h[1])}function Qn(_,h){return!(_[0]<=h[0]||_[2]>=h[2]||_[1]<=h[1]||_[3]>=h[3])}function Aa(_,h){const w=(180+_[0])/360,P=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+_[1]*Math.PI/360)))/360,H=Math.pow(2,h.z);return[Math.round(w*H*Qa),Math.round(P*H*Qa)]}function ds(_,h,w){const P=_[0]-h[0],H=_[1]-h[1],J=_[0]-w[0],ee=_[1]-w[1];return P*ee-J*H==0&&P*J<=0&&H*ee<=0}function Wa(_,h){let w=!1;for(let ee=0,ge=h.length;ee<ge;ee++){const Te=h[ee];for(let Ne=0,f=Te.length;Ne<f-1;Ne++){if(ds(_,Te[Ne],Te[Ne+1]))return!1;(H=Te[Ne])[1]>(P=_)[1]!=(J=Te[Ne+1])[1]>P[1]&&P[0]<(J[0]-H[0])*(P[1]-H[1])/(J[1]-H[1])+H[0]&&(w=!w)}}var P,H,J;return w}function ol(_,h){for(let w=0;w<h.length;w++)if(Wa(_,h[w]))return!0;return!1}function ll(_,h,w,P){const H=P[0]-w[0],J=P[1]-w[1],ee=(_[0]-w[0])*J-H*(_[1]-w[1]),ge=(h[0]-w[0])*J-H*(h[1]-w[1]);return ee>0&&ge<0||ee<0&&ge>0}function lo(_,h,w){for(const Ne of w)for(let f=0;f<Ne.length-1;++f)if((ge=[(ee=Ne[f+1])[0]-(J=Ne[f])[0],ee[1]-J[1]])[0]*(Te=[(H=h)[0]-(P=_)[0],H[1]-P[1]])[1]-ge[1]*Te[0]!=0&&ll(P,H,J,ee)&&ll(J,ee,P,H))return!0;var P,H,J,ee,ge,Te;return!1}function $a(_,h){for(let w=0;w<_.length;++w)if(!Wa(_[w],h))return!1;for(let w=0;w<_.length-1;++w)if(lo(_[w],_[w+1],h))return!1;return!0}function G(_,h){for(let w=0;w<h.length;w++)if($a(_,h[w]))return!0;return!1}function we(_,h,w){const P=[];for(let H=0;H<_.length;H++){const J=[];for(let ee=0;ee<_[H].length;ee++){const ge=Aa(_[H][ee],w);ia(h,ge),J.push(ge)}P.push(J)}return P}function at(_,h,w){const P=[];for(let H=0;H<_.length;H++){const J=we(_[H],h,w);P.push(J)}return P}function Ct(_,h,w,P){if(_[0]<w[0]||_[0]>w[2]){const H=.5*P;let J=_[0]-w[0]>H?-P:w[0]-_[0]>H?P:0;J===0&&(J=_[0]-w[2]>H?-P:w[2]-_[0]>H?P:0),_[0]+=J}ia(h,_)}function Yt(_,h,w,P){const H=Math.pow(2,P.z)*Qa,J=[P.x*Qa,P.y*Qa],ee=[];for(const ge of _)for(const Te of ge){const Ne=[Te.x+J[0],Te.y+J[1]];Ct(Ne,h,w,H),ee.push(Ne)}return ee}function Ii(_,h,w,P){const H=Math.pow(2,P.z)*Qa,J=[P.x*Qa,P.y*Qa],ee=[];for(const Te of _){const Ne=[];for(const f of Te){const u=[f.x+J[0],f.y+J[1]];ia(h,u),Ne.push(u)}ee.push(Ne)}if(h[2]-h[0]<=H/2){(ge=h)[0]=ge[1]=1/0,ge[2]=ge[3]=-1/0;for(const Te of ee)for(const Ne of Te)Ct(Ne,h,w,H)}var ge;return ee}class Li{constructor(h,w){this.type=$e,this.geojson=h,this.geometries=w}static parse(h,w){if(h.length!==2)return w.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(kn(h[1])){const P=h[1];if(P.type==="FeatureCollection"){const H=[];for(const J of P.features){const{type:ee,coordinates:ge}=J.geometry;ee==="Polygon"&&H.push(ge),ee==="MultiPolygon"&&H.push(...ge)}if(H.length)return new Li(P,{type:"MultiPolygon",coordinates:H})}else if(P.type==="Feature"){const H=P.geometry.type;if(H==="Polygon"||H==="MultiPolygon")return new Li(P,P.geometry)}else if(P.type==="Polygon"||P.type==="MultiPolygon")return new Li(P,P)}return w.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(w,P){const H=[1/0,1/0,-1/0,-1/0],J=[1/0,1/0,-1/0,-1/0],ee=w.canonicalID();if(P.type==="Polygon"){const ge=we(P.coordinates,J,ee),Te=Yt(w.geometry(),H,J,ee);if(!Qn(H,J))return!1;for(const Ne of Te)if(!Wa(Ne,ge))return!1}if(P.type==="MultiPolygon"){const ge=at(P.coordinates,J,ee),Te=Yt(w.geometry(),H,J,ee);if(!Qn(H,J))return!1;for(const Ne of Te)if(!ol(Ne,ge))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(w,P){const H=[1/0,1/0,-1/0,-1/0],J=[1/0,1/0,-1/0,-1/0],ee=w.canonicalID();if(P.type==="Polygon"){const ge=we(P.coordinates,J,ee),Te=Ii(w.geometry(),H,J,ee);if(!Qn(H,J))return!1;for(const Ne of Te)if(!$a(Ne,ge))return!1}if(P.type==="MultiPolygon"){const ge=at(P.coordinates,J,ee),Te=Ii(w.geometry(),H,J,ee);if(!Qn(H,J))return!1;for(const Ne of Te)if(!G(Ne,ge))return!1}return!0}(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class An{constructor(h,w){this.type=w.type,this.name=h,this.boundExpression=w}static parse(h,w){if(h.length!==2||typeof h[1]!="string")return w.error("'var' expression requires exactly one string literal argument.");const P=h[1];return w.scope.has(P)?new An(P,w.scope.get(P)):w.error(`Unknown variable "${P}". Make sure "${P}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}}class pn{constructor(h,w,P,H){this.name=h,this.type=w,this._evaluate=P,this.args=H}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}static parse(h,w){const P=h[0],H=pn.definitions[P];if(!H)return w.error(`Unknown expression "${P}". If you wanted a literal array, use ["literal", [...]].`,0);const J=Array.isArray(H)?H[0]:H.type,ee=Array.isArray(H)?[[H[1],H[2]]]:H.overloads,ge=ee.filter(([Ne])=>!Array.isArray(Ne)||Ne.length===h.length-1);let Te=null;for(const[Ne,f]of ge){Te=new Za(w.registry,or,w.path,null,w.scope);const u=[];let p=!1;for(let E=1;E<h.length;E++){const B=h[E],q=Array.isArray(Ne)?Ne[E-1]:Ne.type,W=Te.parse(B,1+u.length,q);if(!W){p=!0;break}u.push(W)}if(!p)if(Array.isArray(Ne)&&Ne.length!==u.length)Te.error(`Expected ${Ne.length} arguments, but found ${u.length} instead.`);else{for(let E=0;E<u.length;E++){const B=Array.isArray(Ne)?Ne[E]:Ne.type,q=u[E];Te.concat(E+1).checkSubtype(B,q.type)}if(Te.errors.length===0)return new pn(P,J,f,u)}}if(ge.length===1)w.errors.push(...Te.errors);else{const Ne=(ge.length?ge:ee).map(([u])=>{return p=u,Array.isArray(p)?`(${p.map(ne).join(", ")})`:`(${ne(p.type)}...)`;var p}).join(" | "),f=[];for(let u=1;u<h.length;u++){const p=w.parse(h[u],1+f.length);if(!p)return null;f.push(ne(p.type))}w.error(`Expected arguments of type ${Ne}, but found (${f.join(", ")}) instead.`)}return null}static register(h,w){pn.definitions=w;for(const P in w)h[P]=pn}}function or(_){if(_ instanceof An)return or(_.boundExpression);if(_ instanceof pn&&_.name==="error"||_ instanceof Oo||_ instanceof Li)return!1;const h=_ instanceof Zs||_ instanceof Bt;let w=!0;return _.eachChild(P=>{w=h?w&&or(P):w&&P instanceof Qr}),!!w&&dr(_)&&Xa(_,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function dr(_){if(_ instanceof pn&&(_.name==="get"&&_.args.length===1||_.name==="feature-state"||_.name==="has"&&_.args.length===1||_.name==="properties"||_.name==="geometry-type"||_.name==="id"||/^filter-/.test(_.name))||_ instanceof Li)return!1;let h=!0;return _.eachChild(w=>{h&&!dr(w)&&(h=!1)}),h}function qr(_){if(_ instanceof pn&&_.name==="feature-state")return!1;let h=!0;return _.eachChild(w=>{h&&!qr(w)&&(h=!1)}),h}function Xa(_,h){if(_ instanceof pn&&h.indexOf(_.name)>=0)return!1;let w=!0;return _.eachChild(P=>{w&&!Xa(P,h)&&(w=!1)}),w}function Ya(_,h){const w=_.length-1;let P,H,J=0,ee=w,ge=0;for(;J<=ee;)if(ge=Math.floor((J+ee)/2),P=_[ge],H=_[ge+1],P<=h){if(ge===w||h<H)return ge;J=ge+1}else{if(!(P>h))throw new Gt("Input is not a number.");ee=ge-1}return 0}class Ka{constructor(h,w,P){this.type=h,this.input=w,this.labels=[],this.outputs=[];for(const[H,J]of P)this.labels.push(H),this.outputs.push(J)}static parse(h,w){if(h.length-1<4)return w.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return w.error("Expected an even number of arguments.");const P=w.parse(h[1],1,Ce);if(!P)return null;const H=[];let J=null;w.expectedType&&w.expectedType.kind!=="value"&&(J=w.expectedType);for(let ee=1;ee<h.length;ee+=2){const ge=ee===1?-1/0:h[ee],Te=h[ee+1],Ne=ee,f=ee+1;if(typeof ge!="number")return w.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ne);if(H.length&&H[H.length-1][0]>=ge)return w.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Ne);const u=w.parse(Te,f,J);if(!u)return null;J=J||u.type,H.push([ge,u])}return new Ka(J,P,H)}evaluate(h){const w=this.labels,P=this.outputs;if(w.length===1)return P[0].evaluate(h);const H=this.input.evaluate(h);if(H<=w[0])return P[0].evaluate(h);const J=w.length;return H>=w[J-1]?P[J-1].evaluate(h):P[Ya(w,H)].evaluate(h)}eachChild(h){h(this.input);for(const w of this.outputs)h(w)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function ml(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}var Wr=sr;function sr(_,h,w,P){this.cx=3*_,this.bx=3*(w-_)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(P-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=_,this.p1y=h,this.p2x=w,this.p2y=P}sr.prototype={sampleCurveX:function(_){return((this.ax*_+this.bx)*_+this.cx)*_},sampleCurveY:function(_){return((this.ay*_+this.by)*_+this.cy)*_},sampleCurveDerivativeX:function(_){return(3*this.ax*_+2*this.bx)*_+this.cx},solveCurveX:function(_,h){if(h===void 0&&(h=1e-6),_<0)return 0;if(_>1)return 1;for(var w=_,P=0;P<8;P++){var H=this.sampleCurveX(w)-_;if(Math.abs(H)<h)return w;var J=this.sampleCurveDerivativeX(w);if(Math.abs(J)<1e-6)break;w-=H/J}var ee=0,ge=1;for(w=_,P=0;P<20&&(H=this.sampleCurveX(w),!(Math.abs(H-_)<h));P++)_>H?ee=w:ge=w,w=.5*(ge-ee)+ee;return w},solve:function(_,h){return this.sampleCurveY(this.solveCurveX(_,h))}};var Mr=ml(Wr);function Or(_,h,w){return _+w*(h-_)}function Ys(_,h,w){return _.map((P,H)=>Or(P,h[H],w))}const Sr={number:Or,color:function(_,h,w,P="rgb"){switch(P){case"rgb":{const[H,J,ee,ge]=Ys(_.rgb,h.rgb,w);return new mn(H,J,ee,ge,!1)}case"hcl":{const[H,J,ee,ge]=_.hcl,[Te,Ne,f,u]=h.hcl;let p,E;if(isNaN(H)||isNaN(Te))isNaN(H)?isNaN(Te)?p=NaN:(p=Te,ee!==1&&ee!==0||(E=Ne)):(p=H,f!==1&&f!==0||(E=J));else{let fe=Te-H;Te>H&&fe>180?fe-=360:Te<H&&H-Te>180&&(fe+=360),p=H+w*fe}const[B,q,W,se]=function([fe,ve,Be,He]){return fe=isNaN(fe)?0:fe*Pt,ti([Be,Math.cos(fe)*ve,Math.sin(fe)*ve,He])}([p,E??Or(J,Ne,w),Or(ee,f,w),Or(ge,u,w)]);return new mn(B,q,W,se,!1)}case"lab":{const[H,J,ee,ge]=ti(Ys(_.lab,h.lab,w));return new mn(H,J,ee,ge,!1)}}},array:Ys,padding:function(_,h,w){return new hr(Ys(_.values,h.values,w))},variableAnchorOffsetCollection:function(_,h,w){const P=_.values,H=h.values;if(P.length!==H.length)throw new Gt(`Cannot interpolate values of different length. from: ${_.toString()}, to: ${h.toString()}`);const J=[];for(let ee=0;ee<P.length;ee+=2){if(P[ee]!==H[ee])throw new Gt(`Cannot interpolate values containing mismatched anchors. from[${ee}]: ${P[ee]}, to[${ee}]: ${H[ee]}`);J.push(P[ee]);const[ge,Te]=P[ee+1],[Ne,f]=H[ee+1];J.push([Or(ge,Ne,w),Or(Te,f,w)])}return new Xt(J)}};class ra{constructor(h,w,P,H,J){this.type=h,this.operator=w,this.interpolation=P,this.input=H,this.labels=[],this.outputs=[];for(const[ee,ge]of J)this.labels.push(ee),this.outputs.push(ge)}static interpolationFactor(h,w,P,H){let J=0;if(h.name==="exponential")J=Nr(w,h.base,P,H);else if(h.name==="linear")J=Nr(w,1,P,H);else if(h.name==="cubic-bezier"){const ee=h.controlPoints;J=new Mr(ee[0],ee[1],ee[2],ee[3]).solve(Nr(w,1,P,H))}return J}static parse(h,w){let[P,H,J,...ee]=h;if(!Array.isArray(H)||H.length===0)return w.error("Expected an interpolation type expression.",1);if(H[0]==="linear")H={name:"linear"};else if(H[0]==="exponential"){const Ne=H[1];if(typeof Ne!="number")return w.error("Exponential interpolation requires a numeric base.",1,1);H={name:"exponential",base:Ne}}else{if(H[0]!=="cubic-bezier")return w.error(`Unknown interpolation type ${String(H[0])}`,1,0);{const Ne=H.slice(1);if(Ne.length!==4||Ne.some(f=>typeof f!="number"||f<0||f>1))return w.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);H={name:"cubic-bezier",controlPoints:Ne}}}if(h.length-1<4)return w.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return w.error("Expected an even number of arguments.");if(J=w.parse(J,2,Ce),!J)return null;const ge=[];let Te=null;P==="interpolate-hcl"||P==="interpolate-lab"?Te=je:w.expectedType&&w.expectedType.kind!=="value"&&(Te=w.expectedType);for(let Ne=0;Ne<ee.length;Ne+=2){const f=ee[Ne],u=ee[Ne+1],p=Ne+3,E=Ne+4;if(typeof f!="number")return w.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(ge.length&&ge[ge.length-1][0]>=f)return w.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);const B=w.parse(u,E,Te);if(!B)return null;Te=Te||B.type,ge.push([f,B])}return Oe(Te,Ce)||Oe(Te,je)||Oe(Te,Pe)||Oe(Te,re)||Oe(Te,X(Ce))?new ra(Te,P,H,J,ge):w.error(`Type ${ne(Te)} is not interpolatable.`)}evaluate(h){const w=this.labels,P=this.outputs;if(w.length===1)return P[0].evaluate(h);const H=this.input.evaluate(h);if(H<=w[0])return P[0].evaluate(h);const J=w.length;if(H>=w[J-1])return P[J-1].evaluate(h);const ee=Ya(w,H),ge=ra.interpolationFactor(this.interpolation,H,w[ee],w[ee+1]),Te=P[ee].evaluate(h),Ne=P[ee+1].evaluate(h);switch(this.operator){case"interpolate":return Sr[this.type.kind](Te,Ne,ge);case"interpolate-hcl":return Sr.color(Te,Ne,ge,"hcl");case"interpolate-lab":return Sr.color(Te,Ne,ge,"lab")}}eachChild(h){h(this.input);for(const w of this.outputs)h(w)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function Nr(_,h,w,P){const H=P-w,J=_-w;return H===0?0:h===1?J/H:(Math.pow(h,J)-1)/(Math.pow(h,H)-1)}class ko{constructor(h,w){this.type=h,this.args=w}static parse(h,w){if(h.length<2)return w.error("Expectected at least one argument.");let P=null;const H=w.expectedType;H&&H.kind!=="value"&&(P=H);const J=[];for(const ge of h.slice(1)){const Te=w.parse(ge,1+J.length,P,void 0,{typeAnnotation:"omit"});if(!Te)return null;P=P||Te.type,J.push(Te)}if(!P)throw new Error("No output type");const ee=H&&J.some(ge=>xe(H,ge.type));return new ko(ee?Ge:P,J)}evaluate(h){let w,P=null,H=0;for(const J of this.args)if(H++,P=J.evaluate(h),P&&P instanceof en&&!P.available&&(w||(w=P.name),P=null,H===this.args.length&&(P=w)),P!==null)break;return P}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}class Qo{constructor(h,w){this.type=w.type,this.bindings=[].concat(h),this.result=w}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const w of this.bindings)h(w[1]);h(this.result)}static parse(h,w){if(h.length<4)return w.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const P=[];for(let J=1;J<h.length-1;J+=2){const ee=h[J];if(typeof ee!="string")return w.error(`Expected string, but found ${typeof ee} instead.`,J);if(/[^a-zA-Z0-9_]/.test(ee))return w.error("Variable names must contain only alphanumeric characters or '_'.",J);const ge=w.parse(h[J+1],J+1);if(!ge)return null;P.push([ee,ge])}const H=w.parse(h[h.length-1],h.length-1,w.expectedType,P);return H?new Qo(P,H):null}outputDefined(){return this.result.outputDefined()}}class Ns{constructor(h,w,P){this.type=h,this.index=w,this.input=P}static parse(h,w){if(h.length!==3)return w.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const P=w.parse(h[1],1,Ce),H=w.parse(h[2],2,X(w.expectedType||Ge));return P&&H?new Ns(H.type.itemType,P,H):null}evaluate(h){const w=this.index.evaluate(h),P=this.input.evaluate(h);if(w<0)throw new Gt(`Array index out of bounds: ${w} < 0.`);if(w>=P.length)throw new Gt(`Array index out of bounds: ${w} > ${P.length-1}.`);if(w!==Math.floor(w))throw new Gt(`Array index must be an integer, but found ${w} instead.`);return P[w]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}}class Tl{constructor(h,w){this.type=$e,this.needle=h,this.haystack=w}static parse(h,w){if(h.length!==3)return w.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const P=w.parse(h[1],1,Ge),H=w.parse(h[2],2,Ge);return P&&H?ye(P.type,[$e,Re,Ce,Ee,Ge])?new Tl(P,H):w.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(P.type)} instead`):null}evaluate(h){const w=this.needle.evaluate(h),P=this.haystack.evaluate(h);if(!P)return!1;if(!De(w,["boolean","string","number","null"]))throw new Gt(`Expected first argument to be of type boolean, string, number or null, but found ${ne(Ar(w))} instead.`);if(!De(P,["string","array"]))throw new Gt(`Expected second argument to be of type array or string, but found ${ne(Ar(P))} instead.`);return P.indexOf(w)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}}class yo{constructor(h,w,P){this.type=Ce,this.needle=h,this.haystack=w,this.fromIndex=P}static parse(h,w){if(h.length<=2||h.length>=5)return w.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const P=w.parse(h[1],1,Ge),H=w.parse(h[2],2,Ge);if(!P||!H)return null;if(!ye(P.type,[$e,Re,Ce,Ee,Ge]))return w.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(P.type)} instead`);if(h.length===4){const J=w.parse(h[3],3,Ce);return J?new yo(P,H,J):null}return new yo(P,H)}evaluate(h){const w=this.needle.evaluate(h),P=this.haystack.evaluate(h);if(!De(w,["boolean","string","number","null"]))throw new Gt(`Expected first argument to be of type boolean, string, number or null, but found ${ne(Ar(w))} instead.`);if(!De(P,["string","array"]))throw new Gt(`Expected second argument to be of type array or string, but found ${ne(Ar(P))} instead.`);if(this.fromIndex){const H=this.fromIndex.evaluate(h);return P.indexOf(w,H)}return P.indexOf(w)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}}class Wo{constructor(h,w,P,H,J,ee){this.inputType=h,this.type=w,this.input=P,this.cases=H,this.outputs=J,this.otherwise=ee}static parse(h,w){if(h.length<5)return w.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return w.error("Expected an even number of arguments.");let P,H;w.expectedType&&w.expectedType.kind!=="value"&&(H=w.expectedType);const J={},ee=[];for(let Ne=2;Ne<h.length-1;Ne+=2){let f=h[Ne];const u=h[Ne+1];Array.isArray(f)||(f=[f]);const p=w.concat(Ne);if(f.length===0)return p.error("Expected at least one branch label.");for(const B of f){if(typeof B!="number"&&typeof B!="string")return p.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return p.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return p.error("Numeric branch labels must be integer values.");if(P){if(p.checkSubtype(P,Ar(B)))return null}else P=Ar(B);if(J[String(B)]!==void 0)return p.error("Branch labels must be unique.");J[String(B)]=ee.length}const E=w.parse(u,Ne,H);if(!E)return null;H=H||E.type,ee.push(E)}const ge=w.parse(h[1],1,Ge);if(!ge)return null;const Te=w.parse(h[h.length-1],h.length-1,H);return Te?ge.type.kind!=="value"&&w.concat(1).checkSubtype(P,ge.type)?null:new Wo(P,H,ge,J,ee,Te):null}evaluate(h){const w=this.input.evaluate(h);return(Ar(w)===this.inputType&&this.outputs[this.cases[w]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every(h=>h.outputDefined())&&this.otherwise.outputDefined()}}class ma{constructor(h,w,P){this.type=h,this.branches=w,this.otherwise=P}static parse(h,w){if(h.length<4)return w.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return w.error("Expected an odd number of arguments.");let P;w.expectedType&&w.expectedType.kind!=="value"&&(P=w.expectedType);const H=[];for(let ee=1;ee<h.length-1;ee+=2){const ge=w.parse(h[ee],ee,$e);if(!ge)return null;const Te=w.parse(h[ee+1],ee+1,P);if(!Te)return null;H.push([ge,Te]),P=P||Te.type}const J=w.parse(h[h.length-1],h.length-1,P);if(!J)return null;if(!P)throw new Error("Can't infer output type");return new ma(P,H,J)}evaluate(h){for(const[w,P]of this.branches)if(w.evaluate(h))return P.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[w,P]of this.branches)h(w),h(P);h(this.otherwise)}outputDefined(){return this.branches.every(([h,w])=>w.outputDefined())&&this.otherwise.outputDefined()}}class na{constructor(h,w,P,H){this.type=h,this.input=w,this.beginIndex=P,this.endIndex=H}static parse(h,w){if(h.length<=2||h.length>=5)return w.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const P=w.parse(h[1],1,Ge),H=w.parse(h[2],2,Ce);if(!P||!H)return null;if(!ye(P.type,[X(Ge),Re,Ge]))return w.error(`Expected first argument to be of type array or string, but found ${ne(P.type)} instead`);if(h.length===4){const J=w.parse(h[3],3,Ce);return J?new na(P.type,P,H,J):null}return new na(P.type,P,H)}evaluate(h){const w=this.input.evaluate(h),P=this.beginIndex.evaluate(h);if(!De(w,["string","array"]))throw new Gt(`Expected first argument to be of type array or string, but found ${ne(Ar(w))} instead.`);if(this.endIndex){const H=this.endIndex.evaluate(h);return w.slice(P,H)}return w.slice(P)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}}function kl(_,h){return _==="=="||_==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function Ja(_,h,w,P){return P.compare(h,w)===0}function Fa(_,h,w){const P=_!=="=="&&_!=="!=";return class M3{constructor(J,ee,ge){this.type=$e,this.lhs=J,this.rhs=ee,this.collator=ge,this.hasUntypedArgument=J.type.kind==="value"||ee.type.kind==="value"}static parse(J,ee){if(J.length!==3&&J.length!==4)return ee.error("Expected two or three arguments.");const ge=J[0];let Te=ee.parse(J[1],1,Ge);if(!Te)return null;if(!kl(ge,Te.type))return ee.concat(1).error(`"${ge}" comparisons are not supported for type '${ne(Te.type)}'.`);let Ne=ee.parse(J[2],2,Ge);if(!Ne)return null;if(!kl(ge,Ne.type))return ee.concat(2).error(`"${ge}" comparisons are not supported for type '${ne(Ne.type)}'.`);if(Te.type.kind!==Ne.type.kind&&Te.type.kind!=="value"&&Ne.type.kind!=="value")return ee.error(`Cannot compare types '${ne(Te.type)}' and '${ne(Ne.type)}'.`);P&&(Te.type.kind==="value"&&Ne.type.kind!=="value"?Te=new Bt(Ne.type,[Te]):Te.type.kind!=="value"&&Ne.type.kind==="value"&&(Ne=new Bt(Te.type,[Ne])));let f=null;if(J.length===4){if(Te.type.kind!=="string"&&Ne.type.kind!=="string"&&Te.type.kind!=="value"&&Ne.type.kind!=="value")return ee.error("Cannot use collator to compare non-string types.");if(f=ee.parse(J[3],3,mt),!f)return null}return new M3(Te,Ne,f)}evaluate(J){const ee=this.lhs.evaluate(J),ge=this.rhs.evaluate(J);if(P&&this.hasUntypedArgument){const Te=Ar(ee),Ne=Ar(ge);if(Te.kind!==Ne.kind||Te.kind!=="string"&&Te.kind!=="number")throw new Gt(`Expected arguments for "${_}" to be (string, string) or (number, number), but found (${Te.kind}, ${Ne.kind}) instead.`)}if(this.collator&&!P&&this.hasUntypedArgument){const Te=Ar(ee),Ne=Ar(ge);if(Te.kind!=="string"||Ne.kind!=="string")return h(J,ee,ge)}return this.collator?w(J,ee,ge,this.collator.evaluate(J)):h(J,ee,ge)}eachChild(J){J(this.lhs),J(this.rhs),this.collator&&J(this.collator)}outputDefined(){return!0}}}const gl=Fa("==",function(_,h,w){return h===w},Ja),Ml=Fa("!=",function(_,h,w){return h!==w},function(_,h,w,P){return!Ja(0,h,w,P)}),yu=Fa("<",function(_,h,w){return h<w},function(_,h,w,P){return P.compare(h,w)<0}),ps=Fa(">",function(_,h,w){return h>w},function(_,h,w,P){return P.compare(h,w)>0}),lc=Fa("<=",function(_,h,w){return h<=w},function(_,h,w,P){return P.compare(h,w)<=0}),uo=Fa(">=",function(_,h,w){return h>=w},function(_,h,w,P){return P.compare(h,w)>=0});class co{constructor(h,w,P,H,J){this.type=Re,this.number=h,this.locale=w,this.currency=P,this.minFractionDigits=H,this.maxFractionDigits=J}static parse(h,w){if(h.length!==3)return w.error("Expected two arguments.");const P=w.parse(h[1],1,Ce);if(!P)return null;const H=h[2];if(typeof H!="object"||Array.isArray(H))return w.error("NumberFormat options argument must be an object.");let J=null;if(H.locale&&(J=w.parse(H.locale,1,Re),!J))return null;let ee=null;if(H.currency&&(ee=w.parse(H.currency,1,Re),!ee))return null;let ge=null;if(H["min-fraction-digits"]&&(ge=w.parse(H["min-fraction-digits"],1,Ce),!ge))return null;let Te=null;return H["max-fraction-digits"]&&(Te=w.parse(H["max-fraction-digits"],1,Ce),!Te)?null:new co(P,J,ee,ge,Te)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}}class Xl{constructor(h){this.type=ot,this.sections=h}static parse(h,w){if(h.length<2)return w.error("Expected at least one argument.");const P=h[1];if(!Array.isArray(P)&&typeof P=="object")return w.error("First argument must be an image or text section.");const H=[];let J=!1;for(let ee=1;ee<=h.length-1;++ee){const ge=h[ee];if(J&&typeof ge=="object"&&!Array.isArray(ge)){J=!1;let Te=null;if(ge["font-scale"]&&(Te=w.parse(ge["font-scale"],1,Ce),!Te))return null;let Ne=null;if(ge["text-font"]&&(Ne=w.parse(ge["text-font"],1,X(Re)),!Ne))return null;let f=null;if(ge["text-color"]&&(f=w.parse(ge["text-color"],1,je),!f))return null;const u=H[H.length-1];u.scale=Te,u.font=Ne,u.textColor=f}else{const Te=w.parse(h[ee],1,Ge);if(!Te)return null;const Ne=Te.type.kind;if(Ne!=="string"&&Ne!=="value"&&Ne!=="null"&&Ne!=="resolvedImage")return w.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");J=!0,H.push({content:Te,scale:null,font:null,textColor:null})}}return new Xl(H)}evaluate(h){return new Qi(this.sections.map(w=>{const P=w.content.evaluate(h);return Ar(P)===ae?new Yr("",P,null,null,null):new Yr(js(P),null,w.scale?w.scale.evaluate(h):null,w.font?w.font.evaluate(h).join(","):null,w.textColor?w.textColor.evaluate(h):null)}))}eachChild(h){for(const w of this.sections)h(w.content),w.scale&&h(w.scale),w.font&&h(w.font),w.textColor&&h(w.textColor)}outputDefined(){return!1}}class No{constructor(h){this.type=ae,this.input=h}static parse(h,w){if(h.length!==2)return w.error("Expected two arguments.");const P=w.parse(h[1],1,Re);return P?new No(P):w.error("No image name provided.")}evaluate(h){const w=this.input.evaluate(h),P=en.fromString(w);return P&&h.availableImages&&(P.available=h.availableImages.indexOf(w)>-1),P}eachChild(h){h(this.input)}outputDefined(){return!1}}class $o{constructor(h){this.type=Ce,this.input=h}static parse(h,w){if(h.length!==2)return w.error(`Expected 1 argument, but found ${h.length-1} instead.`);const P=w.parse(h[1],1);return P?P.type.kind!=="array"&&P.type.kind!=="string"&&P.type.kind!=="value"?w.error(`Expected argument of type string or array, but found ${ne(P.type)} instead.`):new $o(P):null}evaluate(h){const w=this.input.evaluate(h);if(typeof w=="string"||Array.isArray(w))return w.length;throw new Gt(`Expected value to be of type string or array, but found ${ne(Ar(w))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}}const Mo={"==":gl,"!=":Ml,">":ps,"<":yu,">=":uo,"<=":lc,array:Bt,at:Ns,boolean:Bt,case:ma,coalesce:ko,collator:Oo,format:Xl,image:No,in:Tl,"index-of":yo,interpolate:ra,"interpolate-hcl":ra,"interpolate-lab":ra,length:$o,let:Qo,literal:Qr,match:Wo,number:Bt,"number-format":co,object:Bt,slice:na,step:Ka,string:Bt,"to-boolean":Zs,"to-color":Zs,"to-number":Zs,"to-string":Zs,var:An,within:Li};function Qs(_,[h,w,P,H]){h=h.evaluate(_),w=w.evaluate(_),P=P.evaluate(_);const J=H?H.evaluate(_):1,ee=qt(h,w,P,J);if(ee)throw new Gt(ee);return new mn(h/255,w/255,P/255,J,!1)}function Xo(_,h){return _ in h}function Yo(_,h){const w=h[_];return w===void 0?null:w}function Ko(_){return{type:_}}function Ta(_){return{result:"success",value:_}}function eo(_){return{result:"error",value:_}}function Ds(_){return _["property-type"]==="data-driven"||_["property-type"]==="cross-faded-data-driven"}function vu(_){return!!_.expression&&_.expression.parameters.indexOf("zoom")>-1}function Pr(_){return!!_.expression&&_.expression.interpolated}function Kn(_){return _ instanceof Number?"number":_ instanceof String?"string":_ instanceof Boolean?"boolean":Array.isArray(_)?"array":_===null?"null":typeof _}function Jo(_){return typeof _=="object"&&_!==null&&!Array.isArray(_)}function Vr(_){return _}function to(_,h){const w=h.type==="color",P=_.stops&&typeof _.stops[0][0]=="object",H=P||!(P||_.property!==void 0),J=_.type||(Pr(h)?"exponential":"interval");if(w||h.type==="padding"){const f=w?mn.parse:hr.parse;(_=ie({},_)).stops&&(_.stops=_.stops.map(u=>[u[0],f(u[1])])),_.default=f(_.default?_.default:h.default)}if(_.colorSpace&&(ee=_.colorSpace)!=="rgb"&&ee!=="hcl"&&ee!=="lab")throw new Error(`Unknown color space: "${_.colorSpace}"`);var ee;let ge,Te,Ne;if(J==="exponential")ge=qn;else if(J==="interval")ge=Po;else if(J==="categorical"){ge=pr,Te=Object.create(null);for(const f of _.stops)Te[f[0]]=f[1];Ne=typeof _.stops[0][0]}else{if(J!=="identity")throw new Error(`Unknown function type "${J}"`);ge=Ul}if(P){const f={},u=[];for(let B=0;B<_.stops.length;B++){const q=_.stops[B],W=q[0].zoom;f[W]===void 0&&(f[W]={zoom:W,type:_.type,property:_.property,default:_.default,stops:[]},u.push(W)),f[W].stops.push([q[0].value,q[1]])}const p=[];for(const B of u)p.push([f[B].zoom,to(f[B],h)]);const E={name:"linear"};return{kind:"composite",interpolationType:E,interpolationFactor:ra.interpolationFactor.bind(void 0,E),zoomStops:p.map(B=>B[0]),evaluate:({zoom:B},q)=>qn({stops:p,base:_.base},h,B).evaluate(B,q)}}if(H){const f=J==="exponential"?{name:"exponential",base:_.base!==void 0?_.base:1}:null;return{kind:"camera",interpolationType:f,interpolationFactor:ra.interpolationFactor.bind(void 0,f),zoomStops:_.stops.map(u=>u[0]),evaluate:({zoom:u})=>ge(_,h,u,Te,Ne)}}return{kind:"source",evaluate(f,u){const p=u&&u.properties?u.properties[_.property]:void 0;return p===void 0?ss(_.default,h.default):ge(_,h,p,Te,Ne)}}}function ss(_,h,w){return _!==void 0?_:h!==void 0?h:w!==void 0?w:void 0}function pr(_,h,w,P,H){return ss(typeof w===H?P[w]:void 0,_.default,h.default)}function Po(_,h,w){if(Kn(w)!=="number")return ss(_.default,h.default);const P=_.stops.length;if(P===1||w<=_.stops[0][0])return _.stops[0][1];if(w>=_.stops[P-1][0])return _.stops[P-1][1];const H=Ya(_.stops.map(J=>J[0]),w);return _.stops[H][1]}function qn(_,h,w){const P=_.base!==void 0?_.base:1;if(Kn(w)!=="number")return ss(_.default,h.default);const H=_.stops.length;if(H===1||w<=_.stops[0][0])return _.stops[0][1];if(w>=_.stops[H-1][0])return _.stops[H-1][1];const J=Ya(_.stops.map(f=>f[0]),w),ee=function(f,u,p,E){const B=E-p,q=f-p;return B===0?0:u===1?q/B:(Math.pow(u,q)-1)/(Math.pow(u,B)-1)}(w,P,_.stops[J][0],_.stops[J+1][0]),ge=_.stops[J][1],Te=_.stops[J+1][1],Ne=Sr[h.type]||Vr;return typeof ge.evaluate=="function"?{evaluate(...f){const u=ge.evaluate.apply(void 0,f),p=Te.evaluate.apply(void 0,f);if(u!==void 0&&p!==void 0)return Ne(u,p,ee,_.colorSpace)}}:Ne(ge,Te,ee,_.colorSpace)}function Ul(_,h,w){switch(h.type){case"color":w=mn.parse(w);break;case"formatted":w=Qi.fromString(w.toString());break;case"resolvedImage":w=en.fromString(w.toString());break;case"padding":w=hr.parse(w);break;default:Kn(w)===h.type||h.type==="enum"&&h.values[w]||(w=void 0)}return ss(w,_.default,h.default)}pn.register(Mo,{error:[{kind:"error"},[Re],(_,[h])=>{throw new Gt(h.evaluate(_))}],typeof:[Re,[Ge],(_,[h])=>ne(Ar(h.evaluate(_)))],"to-rgba":[X(Ce,4),[je],(_,[h])=>{const[w,P,H,J]=h.evaluate(_).rgb;return[255*w,255*P,255*H,J]}],rgb:[je,[Ce,Ce,Ce],Qs],rgba:[je,[Ce,Ce,Ce,Ce],Qs],has:{type:$e,overloads:[[[Re],(_,[h])=>Xo(h.evaluate(_),_.properties())],[[Re,We],(_,[h,w])=>Xo(h.evaluate(_),w.evaluate(_))]]},get:{type:Ge,overloads:[[[Re],(_,[h])=>Yo(h.evaluate(_),_.properties())],[[Re,We],(_,[h,w])=>Yo(h.evaluate(_),w.evaluate(_))]]},"feature-state":[Ge,[Re],(_,[h])=>Yo(h.evaluate(_),_.featureState||{})],properties:[We,[],_=>_.properties()],"geometry-type":[Re,[],_=>_.geometryType()],id:[Ge,[],_=>_.id()],zoom:[Ce,[],_=>_.globals.zoom],"heatmap-density":[Ce,[],_=>_.globals.heatmapDensity||0],"line-progress":[Ce,[],_=>_.globals.lineProgress||0],accumulated:[Ge,[],_=>_.globals.accumulated===void 0?null:_.globals.accumulated],"+":[Ce,Ko(Ce),(_,h)=>{let w=0;for(const P of h)w+=P.evaluate(_);return w}],"*":[Ce,Ko(Ce),(_,h)=>{let w=1;for(const P of h)w*=P.evaluate(_);return w}],"-":{type:Ce,overloads:[[[Ce,Ce],(_,[h,w])=>h.evaluate(_)-w.evaluate(_)],[[Ce],(_,[h])=>-h.evaluate(_)]]},"/":[Ce,[Ce,Ce],(_,[h,w])=>h.evaluate(_)/w.evaluate(_)],"%":[Ce,[Ce,Ce],(_,[h,w])=>h.evaluate(_)%w.evaluate(_)],ln2:[Ce,[],()=>Math.LN2],pi:[Ce,[],()=>Math.PI],e:[Ce,[],()=>Math.E],"^":[Ce,[Ce,Ce],(_,[h,w])=>Math.pow(h.evaluate(_),w.evaluate(_))],sqrt:[Ce,[Ce],(_,[h])=>Math.sqrt(h.evaluate(_))],log10:[Ce,[Ce],(_,[h])=>Math.log(h.evaluate(_))/Math.LN10],ln:[Ce,[Ce],(_,[h])=>Math.log(h.evaluate(_))],log2:[Ce,[Ce],(_,[h])=>Math.log(h.evaluate(_))/Math.LN2],sin:[Ce,[Ce],(_,[h])=>Math.sin(h.evaluate(_))],cos:[Ce,[Ce],(_,[h])=>Math.cos(h.evaluate(_))],tan:[Ce,[Ce],(_,[h])=>Math.tan(h.evaluate(_))],asin:[Ce,[Ce],(_,[h])=>Math.asin(h.evaluate(_))],acos:[Ce,[Ce],(_,[h])=>Math.acos(h.evaluate(_))],atan:[Ce,[Ce],(_,[h])=>Math.atan(h.evaluate(_))],min:[Ce,Ko(Ce),(_,h)=>Math.min(...h.map(w=>w.evaluate(_)))],max:[Ce,Ko(Ce),(_,h)=>Math.max(...h.map(w=>w.evaluate(_)))],abs:[Ce,[Ce],(_,[h])=>Math.abs(h.evaluate(_))],round:[Ce,[Ce],(_,[h])=>{const w=h.evaluate(_);return w<0?-Math.round(-w):Math.round(w)}],floor:[Ce,[Ce],(_,[h])=>Math.floor(h.evaluate(_))],ceil:[Ce,[Ce],(_,[h])=>Math.ceil(h.evaluate(_))],"filter-==":[$e,[Re,Ge],(_,[h,w])=>_.properties()[h.value]===w.value],"filter-id-==":[$e,[Ge],(_,[h])=>_.id()===h.value],"filter-type-==":[$e,[Re],(_,[h])=>_.geometryType()===h.value],"filter-<":[$e,[Re,Ge],(_,[h,w])=>{const P=_.properties()[h.value],H=w.value;return typeof P==typeof H&&P<H}],"filter-id-<":[$e,[Ge],(_,[h])=>{const w=_.id(),P=h.value;return typeof w==typeof P&&w<P}],"filter->":[$e,[Re,Ge],(_,[h,w])=>{const P=_.properties()[h.value],H=w.value;return typeof P==typeof H&&P>H}],"filter-id->":[$e,[Ge],(_,[h])=>{const w=_.id(),P=h.value;return typeof w==typeof P&&w>P}],"filter-<=":[$e,[Re,Ge],(_,[h,w])=>{const P=_.properties()[h.value],H=w.value;return typeof P==typeof H&&P<=H}],"filter-id-<=":[$e,[Ge],(_,[h])=>{const w=_.id(),P=h.value;return typeof w==typeof P&&w<=P}],"filter->=":[$e,[Re,Ge],(_,[h,w])=>{const P=_.properties()[h.value],H=w.value;return typeof P==typeof H&&P>=H}],"filter-id->=":[$e,[Ge],(_,[h])=>{const w=_.id(),P=h.value;return typeof w==typeof P&&w>=P}],"filter-has":[$e,[Ge],(_,[h])=>h.value in _.properties()],"filter-has-id":[$e,[],_=>_.id()!==null&&_.id()!==void 0],"filter-type-in":[$e,[X(Re)],(_,[h])=>h.value.indexOf(_.geometryType())>=0],"filter-id-in":[$e,[X(Ge)],(_,[h])=>h.value.indexOf(_.id())>=0],"filter-in-small":[$e,[Re,X(Ge)],(_,[h,w])=>w.value.indexOf(_.properties()[h.value])>=0],"filter-in-large":[$e,[Re,X(Ge)],(_,[h,w])=>function(P,H,J,ee){for(;J<=ee;){const ge=J+ee>>1;if(H[ge]===P)return!0;H[ge]>P?ee=ge-1:J=ge+1}return!1}(_.properties()[h.value],w.value,0,w.value.length-1)],all:{type:$e,overloads:[[[$e,$e],(_,[h,w])=>h.evaluate(_)&&w.evaluate(_)],[Ko($e),(_,h)=>{for(const w of h)if(!w.evaluate(_))return!1;return!0}]]},any:{type:$e,overloads:[[[$e,$e],(_,[h,w])=>h.evaluate(_)||w.evaluate(_)],[Ko($e),(_,h)=>{for(const w of h)if(w.evaluate(_))return!0;return!1}]]},"!":[$e,[$e],(_,[h])=>!h.evaluate(_)],"is-supported-script":[$e,[Re],(_,[h])=>{const w=_.globals&&_.globals.isSupportedScript;return!w||w(h.evaluate(_))}],upcase:[Re,[Re],(_,[h])=>h.evaluate(_).toUpperCase()],downcase:[Re,[Re],(_,[h])=>h.evaluate(_).toLowerCase()],concat:[Re,Ko(Ge),(_,h)=>h.map(w=>js(w.evaluate(_))).join("")],"resolved-locale":[Re,[mt],(_,[h])=>h.evaluate(_).resolvedLocale()]});class as{constructor(h,w){var P;this.expression=h,this._warningHistory={},this._evaluator=new Fr,this._defaultValue=w?(P=w).type==="color"&&Jo(P.default)?new mn(0,0,0,0):P.type==="color"?mn.parse(P.default)||null:P.type==="padding"?hr.parse(P.default)||null:P.type==="variableAnchorOffsetCollection"?Xt.parse(P.default)||null:P.default===void 0?null:P.default:null,this._enumValues=w&&w.type==="enum"?w.values:null}evaluateWithoutErrorHandling(h,w,P,H,J,ee){return this._evaluator.globals=h,this._evaluator.feature=w,this._evaluator.featureState=P,this._evaluator.canonical=H,this._evaluator.availableImages=J||null,this._evaluator.formattedSection=ee,this.expression.evaluate(this._evaluator)}evaluate(h,w,P,H,J,ee){this._evaluator.globals=h,this._evaluator.feature=w||null,this._evaluator.featureState=P||null,this._evaluator.canonical=H,this._evaluator.availableImages=J||null,this._evaluator.formattedSection=ee||null;try{const ge=this.expression.evaluate(this._evaluator);if(ge==null||typeof ge=="number"&&ge!=ge)return this._defaultValue;if(this._enumValues&&!(ge in this._enumValues))throw new Gt(`Expected value to be one of ${Object.keys(this._enumValues).map(Te=>JSON.stringify(Te)).join(", ")}, but found ${JSON.stringify(ge)} instead.`);return ge}catch(ge){return this._warningHistory[ge.message]||(this._warningHistory[ge.message]=!0,typeof console<"u"&&console.warn(ge.message)),this._defaultValue}}}function Kr(_){return Array.isArray(_)&&_.length>0&&typeof _[0]=="string"&&_[0]in Mo}function Ls(_,h){const w=new Za(Mo,or,[],h?function(H){const J={color:je,string:Re,number:Ce,enum:Re,boolean:$e,formatted:ot,padding:Pe,resolvedImage:ae,variableAnchorOffsetCollection:re};return H.type==="array"?X(J[H.value]||Ge,H.length):J[H.type]}(h):void 0),P=w.parse(_,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return P?Ta(new as(P,h)):eo(w.errors)}class Br{constructor(h,w){this.kind=h,this._styleExpression=w,this.isStateDependent=h!=="constant"&&!qr(w.expression)}evaluateWithoutErrorHandling(h,w,P,H,J,ee){return this._styleExpression.evaluateWithoutErrorHandling(h,w,P,H,J,ee)}evaluate(h,w,P,H,J,ee){return this._styleExpression.evaluate(h,w,P,H,J,ee)}}class ar{constructor(h,w,P,H){this.kind=h,this.zoomStops=P,this._styleExpression=w,this.isStateDependent=h!=="camera"&&!qr(w.expression),this.interpolationType=H}evaluateWithoutErrorHandling(h,w,P,H,J,ee){return this._styleExpression.evaluateWithoutErrorHandling(h,w,P,H,J,ee)}evaluate(h,w,P,H,J,ee){return this._styleExpression.evaluate(h,w,P,H,J,ee)}interpolationFactor(h,w,P){return this.interpolationType?ra.interpolationFactor(this.interpolationType,h,w,P):0}}function ul(_,h){const w=Ls(_,h);if(w.result==="error")return w;const P=w.value.expression,H=dr(P);if(!H&&!Ds(h))return eo([new de("","data expressions not supported")]);const J=Xa(P,["zoom"]);if(!J&&!vu(h))return eo([new de("","zoom expressions not supported")]);const ee=Do(P);return ee||J?ee instanceof de?eo([ee]):ee instanceof ra&&!Pr(h)?eo([new de("",'"interpolate" expressions cannot be used with this property')]):Ta(ee?new ar(H?"camera":"composite",w.value,ee.labels,ee instanceof ra?ee.interpolation:void 0):new Br(H?"constant":"source",w.value)):eo([new de("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class is{constructor(h,w){this._parameters=h,this._specification=w,ie(this,to(this._parameters,this._specification))}static deserialize(h){return new is(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function Do(_){let h=null;if(_ instanceof Qo)h=Do(_.result);else if(_ instanceof ko){for(const w of _.args)if(h=Do(w),h)break}else(_ instanceof Ka||_ instanceof ra)&&_.input instanceof pn&&_.input.name==="zoom"&&(h=_);return h instanceof de||_.eachChild(w=>{const P=Do(w);P instanceof de?h=P:!h&&P?h=new de("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&P&&h!==P&&(h=new de("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),h}function cl(_){if(_===!0||_===!1)return!0;if(!Array.isArray(_)||_.length===0)return!1;switch(_[0]){case"has":return _.length>=2&&_[1]!=="$id"&&_[1]!=="$type";case"in":return _.length>=3&&(typeof _[1]!="string"||Array.isArray(_[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return _.length!==3||Array.isArray(_[1])||Array.isArray(_[2]);case"any":case"all":for(const h of _.slice(1))if(!cl(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}const Jr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gs(_){if(_==null)return{filter:()=>!0,needGeometry:!1};cl(_)||(_=Lo(_));const h=Ls(_,Jr);if(h.result==="error")throw new Error(h.value.map(w=>`${w.key}: ${w.message}`).join(", "));return{filter:(w,P,H)=>h.value.evaluate(w,P,{},H),needGeometry:Pl(_)}}function ka(_,h){return _<h?-1:_>h?1:0}function Pl(_){if(!Array.isArray(_))return!1;if(_[0]==="within")return!0;for(let h=1;h<_.length;h++)if(Pl(_[h]))return!0;return!1}function Lo(_){if(!_)return!0;const h=_[0];return _.length<=1?h!=="any":h==="=="?Dl(_[1],_[2],"=="):h==="!="?Ws(Dl(_[1],_[2],"==")):h==="<"||h===">"||h==="<="||h===">="?Dl(_[1],_[2],h):h==="any"?(w=_.slice(1),["any"].concat(w.map(Lo))):h==="all"?["all"].concat(_.slice(1).map(Lo)):h==="none"?["all"].concat(_.slice(1).map(Lo).map(Ws)):h==="in"?vo(_[1],_.slice(2)):h==="!in"?Ws(vo(_[1],_.slice(2))):h==="has"?sa(_[1]):h==="!has"?Ws(sa(_[1])):h!=="within"||_;var w}function Dl(_,h,w){switch(_){case"$type":return[`filter-type-${w}`,h];case"$id":return[`filter-id-${w}`,h];default:return[`filter-${w}`,_,h]}}function vo(_,h){if(h.length===0)return!1;switch(_){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some(w=>typeof w!=typeof h[0])?["filter-in-large",_,["literal",h.sort(ka)]]:["filter-in-small",_,["literal",h]]}}function sa(_){switch(_){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",_]}}function Ws(_){return["!",_]}function io(_){const h=typeof _;if(h==="number"||h==="boolean"||h==="string"||_==null)return JSON.stringify(_);if(Array.isArray(_)){let H="[";for(const J of _)H+=`${io(J)},`;return`${H}]`}const w=Object.keys(_).sort();let P="{";for(let H=0;H<w.length;H++)P+=`${JSON.stringify(w[H])}:${io(_[w[H]])},`;return`${P}}`}function el(_){let h="";for(const w of an)h+=`/${io(_[w])}`;return h}function ns(_){const h=_.value;return h?[new K(_.key,h,"constants have been deprecated as of v8")]:[]}function vr(_){return _ instanceof Number||_ instanceof String||_ instanceof Boolean?_.valueOf():_}function Hr(_){if(Array.isArray(_))return _.map(Hr);if(_ instanceof Object&&!(_ instanceof Number||_ instanceof String||_ instanceof Boolean)){const h={};for(const w in _)h[w]=Hr(_[w]);return h}return vr(_)}function ga(_){const h=_.key,w=_.value,P=_.valueSpec||{},H=_.objectElementValidators||{},J=_.style,ee=_.styleSpec,ge=_.validateSpec;let Te=[];const Ne=Kn(w);if(Ne!=="object")return[new K(h,w,`object expected, ${Ne} found`)];for(const f in w){const u=f.split(".")[0],p=P[u]||P["*"];let E;if(H[u])E=H[u];else if(P[u])E=ge;else if(H["*"])E=H["*"];else{if(!P["*"]){Te.push(new K(h,w[f],`unknown property "${f}"`));continue}E=ge}Te=Te.concat(E({key:(h&&`${h}.`)+f,value:w[f],valueSpec:p,style:J,styleSpec:ee,object:w,objectKey:f,validateSpec:ge},w))}for(const f in P)H[f]||P[f].required&&P[f].default===void 0&&w[f]===void 0&&Te.push(new K(h,w,`missing required property "${f}"`));return Te}function xo(_){const h=_.value,w=_.valueSpec,P=_.style,H=_.styleSpec,J=_.key,ee=_.arrayElementValidator||_.validateSpec;if(Kn(h)!=="array")return[new K(J,h,`array expected, ${Kn(h)} found`)];if(w.length&&h.length!==w.length)return[new K(J,h,`array length ${w.length} expected, length ${h.length} found`)];if(w["min-length"]&&h.length<w["min-length"])return[new K(J,h,`array length at least ${w["min-length"]} expected, length ${h.length} found`)];let ge={type:w.value,values:w.values};H.$version<7&&(ge.function=w.function),Kn(w.value)==="object"&&(ge=w.value);let Te=[];for(let Ne=0;Ne<h.length;Ne++)Te=Te.concat(ee({array:h,arrayIndex:Ne,value:h[Ne],valueSpec:ge,validateSpec:_.validateSpec,style:P,styleSpec:H,key:`${J}[${Ne}]`}));return Te}function aa(_){const h=_.key,w=_.value,P=_.valueSpec;let H=Kn(w);return H==="number"&&w!=w&&(H="NaN"),H!=="number"?[new K(h,w,`number expected, ${H} found`)]:"minimum"in P&&w<P.minimum?[new K(h,w,`${w} is less than the minimum value ${P.minimum}`)]:"maximum"in P&&w>P.maximum?[new K(h,w,`${w} is greater than the maximum value ${P.maximum}`)]:[]}function Ma(_){const h=_.valueSpec,w=vr(_.value.type);let P,H,J,ee={};const ge=w!=="categorical"&&_.value.property===void 0,Te=!ge,Ne=Kn(_.value.stops)==="array"&&Kn(_.value.stops[0])==="array"&&Kn(_.value.stops[0][0])==="object",f=ga({key:_.key,value:_.value,valueSpec:_.styleSpec.function,validateSpec:_.validateSpec,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{stops:function(E){if(w==="identity")return[new K(E.key,E.value,'identity function may not have a "stops" property')];let B=[];const q=E.value;return B=B.concat(xo({key:E.key,value:q,valueSpec:E.valueSpec,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec,arrayElementValidator:u})),Kn(q)==="array"&&q.length===0&&B.push(new K(E.key,q,"array must have at least one stop")),B},default:function(E){return E.validateSpec({key:E.key,value:E.value,valueSpec:h,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec})}}});return w==="identity"&&ge&&f.push(new K(_.key,_.value,'missing required property "property"')),w==="identity"||_.value.stops||f.push(new K(_.key,_.value,'missing required property "stops"')),w==="exponential"&&_.valueSpec.expression&&!Pr(_.valueSpec)&&f.push(new K(_.key,_.value,"exponential functions not supported")),_.styleSpec.$version>=8&&(Te&&!Ds(_.valueSpec)?f.push(new K(_.key,_.value,"property functions not supported")):ge&&!vu(_.valueSpec)&&f.push(new K(_.key,_.value,"zoom functions not supported"))),w!=="categorical"&&!Ne||_.value.property!==void 0||f.push(new K(_.key,_.value,'"property" property is required')),f;function u(E){let B=[];const q=E.value,W=E.key;if(Kn(q)!=="array")return[new K(W,q,`array expected, ${Kn(q)} found`)];if(q.length!==2)return[new K(W,q,`array length 2 expected, length ${q.length} found`)];if(Ne){if(Kn(q[0])!=="object")return[new K(W,q,`object expected, ${Kn(q[0])} found`)];if(q[0].zoom===void 0)return[new K(W,q,"object stop key must have zoom")];if(q[0].value===void 0)return[new K(W,q,"object stop key must have value")];if(J&&J>vr(q[0].zoom))return[new K(W,q[0].zoom,"stop zoom values must appear in ascending order")];vr(q[0].zoom)!==J&&(J=vr(q[0].zoom),H=void 0,ee={}),B=B.concat(ga({key:`${W}[0]`,value:q[0],valueSpec:{zoom:{}},validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{zoom:aa,value:p}}))}else B=B.concat(p({key:`${W}[0]`,value:q[0],valueSpec:{},validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec},q));return Kr(Hr(q[1]))?B.concat([new K(`${W}[1]`,q[1],"expressions are not allowed in function stops.")]):B.concat(E.validateSpec({key:`${W}[1]`,value:q[1],valueSpec:h,validateSpec:E.validateSpec,style:E.style,styleSpec:E.styleSpec}))}function p(E,B){const q=Kn(E.value),W=vr(E.value),se=E.value!==null?E.value:B;if(P){if(q!==P)return[new K(E.key,se,`${q} stop domain type must match previous stop domain type ${P}`)]}else P=q;if(q!=="number"&&q!=="string"&&q!=="boolean")return[new K(E.key,se,"stop domain value must be a number, string, or boolean")];if(q!=="number"&&w!=="categorical"){let fe=`number expected, ${q} found`;return Ds(h)&&w===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new K(E.key,se,fe)]}return w!=="categorical"||q!=="number"||isFinite(W)&&Math.floor(W)===W?w!=="categorical"&&q==="number"&&H!==void 0&&W<H?[new K(E.key,se,"stop domain values must appear in ascending order")]:(H=W,w==="categorical"&&W in ee?[new K(E.key,se,"stop domain values must be unique")]:(ee[W]=!0,[])):[new K(E.key,se,`integer expected, found ${W}`)]}}function Oa(_){const h=(_.expressionContext==="property"?ul:Ls)(Hr(_.value),_.valueSpec);if(h.result==="error")return h.value.map(P=>new K(`${_.key}${P.key}`,_.value,P.message));const w=h.value.expression||h.value._styleExpression.expression;if(_.expressionContext==="property"&&_.propertyKey==="text-font"&&!w.outputDefined())return[new K(_.key,_.value,`Invalid data expression for "${_.propertyKey}". Output values must be contained as literals within the expression.`)];if(_.expressionContext==="property"&&_.propertyType==="layout"&&!qr(w))return[new K(_.key,_.value,'"feature-state" data expressions are not supported with layout properties.')];if(_.expressionContext==="filter"&&!qr(w))return[new K(_.key,_.value,'"feature-state" data expressions are not supported with filters.')];if(_.expressionContext&&_.expressionContext.indexOf("cluster")===0){if(!Xa(w,["zoom","feature-state"]))return[new K(_.key,_.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(_.expressionContext==="cluster-initial"&&!dr(w))return[new K(_.key,_.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function no(_){const h=_.key,w=_.value,P=_.valueSpec,H=[];return Array.isArray(P.values)?P.values.indexOf(vr(w))===-1&&H.push(new K(h,w,`expected one of [${P.values.join(", ")}], ${JSON.stringify(w)} found`)):Object.keys(P.values).indexOf(vr(w))===-1&&H.push(new K(h,w,`expected one of [${Object.keys(P.values).join(", ")}], ${JSON.stringify(w)} found`)),H}function hl(_){return cl(Hr(_.value))?Oa(ie({},_,{expressionContext:"filter",valueSpec:{value:"boolean"}})):cu(_)}function cu(_){const h=_.value,w=_.key;if(Kn(h)!=="array")return[new K(w,h,`array expected, ${Kn(h)} found`)];const P=_.styleSpec;let H,J=[];if(h.length<1)return[new K(w,h,"filter array must have at least 1 element")];switch(J=J.concat(no({key:`${w}[0]`,value:h[0],valueSpec:P.filter_operator,style:_.style,styleSpec:_.styleSpec})),vr(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&vr(h[1])==="$type"&&J.push(new K(w,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&J.push(new K(w,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(H=Kn(h[1]),H!=="string"&&J.push(new K(`${w}[1]`,h[1],`string expected, ${H} found`)));for(let ee=2;ee<h.length;ee++)H=Kn(h[ee]),vr(h[1])==="$type"?J=J.concat(no({key:`${w}[${ee}]`,value:h[ee],valueSpec:P.geometry_type,style:_.style,styleSpec:_.styleSpec})):H!=="string"&&H!=="number"&&H!=="boolean"&&J.push(new K(`${w}[${ee}]`,h[ee],`string, number, or boolean expected, ${H} found`));break;case"any":case"all":case"none":for(let ee=1;ee<h.length;ee++)J=J.concat(cu({key:`${w}[${ee}]`,value:h[ee],style:_.style,styleSpec:_.styleSpec}));break;case"has":case"!has":H=Kn(h[1]),h.length!==2?J.push(new K(w,h,`filter array for "${h[0]}" operator must have 2 elements`)):H!=="string"&&J.push(new K(`${w}[1]`,h[1],`string expected, ${H} found`));break;case"within":H=Kn(h[1]),h.length!==2?J.push(new K(w,h,`filter array for "${h[0]}" operator must have 2 elements`)):H!=="object"&&J.push(new K(`${w}[1]`,h[1],`object expected, ${H} found`))}return J}function _l(_,h){const w=_.key,P=_.validateSpec,H=_.style,J=_.styleSpec,ee=_.value,ge=_.objectKey,Te=J[`${h}_${_.layerType}`];if(!Te)return[];const Ne=ge.match(/^(.*)-transition$/);if(h==="paint"&&Ne&&Te[Ne[1]]&&Te[Ne[1]].transition)return P({key:w,value:ee,valueSpec:J.transition,style:H,styleSpec:J});const f=_.valueSpec||Te[ge];if(!f)return[new K(w,ee,`unknown property "${ge}"`)];let u;if(Kn(ee)==="string"&&Ds(f)&&!f.tokens&&(u=/^{([^}]+)}$/.exec(ee)))return[new K(w,ee,`"${ge}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const p=[];return _.layerType==="symbol"&&(ge==="text-field"&&H&&!H.glyphs&&p.push(new K(w,ee,'use of "text-field" requires a style "glyphs" property')),ge==="text-font"&&Jo(Hr(ee))&&vr(ee.type)==="identity"&&p.push(new K(w,ee,'"text-font" does not support identity functions'))),p.concat(P({key:_.key,value:ee,valueSpec:f,style:H,styleSpec:J,expressionContext:"property",propertyType:h,propertyKey:ge}))}function ho(_){return _l(_,"paint")}function mi(_){return _l(_,"layout")}function qi(_){let h=[];const w=_.value,P=_.key,H=_.style,J=_.styleSpec;w.type||w.ref||h.push(new K(P,w,'either "type" or "ref" is required'));let ee=vr(w.type);const ge=vr(w.ref);if(w.id){const Te=vr(w.id);for(let Ne=0;Ne<_.arrayIndex;Ne++){const f=H.layers[Ne];vr(f.id)===Te&&h.push(new K(P,w.id,`duplicate layer id "${w.id}", previously used at line ${f.id.__line__}`))}}if("ref"in w){let Te;["type","source","source-layer","filter","layout"].forEach(Ne=>{Ne in w&&h.push(new K(P,w[Ne],`"${Ne}" is prohibited for ref layers`))}),H.layers.forEach(Ne=>{vr(Ne.id)===ge&&(Te=Ne)}),Te?Te.ref?h.push(new K(P,w.ref,"ref cannot reference another ref layer")):ee=vr(Te.type):h.push(new K(P,w.ref,`ref layer "${ge}" not found`))}else if(ee!=="background")if(w.source){const Te=H.sources&&H.sources[w.source],Ne=Te&&vr(Te.type);Te?Ne==="vector"&&ee==="raster"?h.push(new K(P,w.source,`layer "${w.id}" requires a raster source`)):Ne!=="raster-dem"&&ee==="hillshade"?h.push(new K(P,w.source,`layer "${w.id}" requires a raster-dem source`)):Ne==="raster"&&ee!=="raster"?h.push(new K(P,w.source,`layer "${w.id}" requires a vector source`)):Ne!=="vector"||w["source-layer"]?Ne==="raster-dem"&&ee!=="hillshade"?h.push(new K(P,w.source,"raster-dem source can only be used with layer type 'hillshade'.")):ee!=="line"||!w.paint||!w.paint["line-gradient"]||Ne==="geojson"&&Te.lineMetrics||h.push(new K(P,w,`layer "${w.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new K(P,w,`layer "${w.id}" must specify a "source-layer"`)):h.push(new K(P,w.source,`source "${w.source}" not found`))}else h.push(new K(P,w,'missing required property "source"'));return h=h.concat(ga({key:P,value:w,valueSpec:J.layer,style:_.style,styleSpec:_.styleSpec,validateSpec:_.validateSpec,objectElementValidators:{"*":()=>[],type:()=>_.validateSpec({key:`${P}.type`,value:w.type,valueSpec:J.layer.type,style:_.style,styleSpec:_.styleSpec,validateSpec:_.validateSpec,object:w,objectKey:"type"}),filter:hl,layout:Te=>ga({layer:w,key:Te.key,value:Te.value,style:Te.style,styleSpec:Te.styleSpec,validateSpec:Te.validateSpec,objectElementValidators:{"*":Ne=>mi(ie({layerType:ee},Ne))}}),paint:Te=>ga({layer:w,key:Te.key,value:Te.value,style:Te.style,styleSpec:Te.styleSpec,validateSpec:Te.validateSpec,objectElementValidators:{"*":Ne=>ho(ie({layerType:ee},Ne))}})}})),h}function Di(_){const h=_.value,w=_.key,P=Kn(h);return P!=="string"?[new K(w,h,`string expected, ${P} found`)]:[]}const Nt={promoteId:function({key:_,value:h}){if(Kn(h)==="string")return Di({key:_,value:h});{const w=[];for(const P in h)w.push(...Di({key:`${_}.${P}`,value:h[P]}));return w}}};function ni(_){const h=_.value,w=_.key,P=_.styleSpec,H=_.style,J=_.validateSpec;if(!h.type)return[new K(w,h,'"type" is required')];const ee=vr(h.type);let ge;switch(ee){case"vector":case"raster":return ge=ga({key:w,value:h,valueSpec:P[`source_${ee.replace("-","_")}`],style:_.style,styleSpec:P,objectElementValidators:Nt,validateSpec:J}),ge;case"raster-dem":return ge=function(Te){var Ne;const f=(Ne=Te.sourceName)!==null&&Ne!==void 0?Ne:"",u=Te.value,p=Te.styleSpec,E=p.source_raster_dem,B=Te.style;let q=[];const W=Kn(u);if(u===void 0)return q;if(W!=="object")return q.push(new K("source_raster_dem",u,`object expected, ${W} found`)),q;const se=vr(u.encoding)==="custom",fe=["redFactor","greenFactor","blueFactor","baseShift"],ve=Te.value.encoding?`"${Te.value.encoding}"`:"Default";for(const Be in u)!se&&fe.includes(Be)?q.push(new K(Be,u[Be],`In "${f}": "${Be}" is only valid when "encoding" is set to "custom". ${ve} encoding found`)):E[Be]?q=q.concat(Te.validateSpec({key:Be,value:u[Be],valueSpec:E[Be],validateSpec:Te.validateSpec,style:B,styleSpec:p})):q.push(new K(Be,u[Be],`unknown property "${Be}"`));return q}({sourceName:w,value:h,style:_.style,styleSpec:P,validateSpec:J}),ge;case"geojson":if(ge=ga({key:w,value:h,valueSpec:P.source_geojson,style:H,styleSpec:P,validateSpec:J,objectElementValidators:Nt}),h.cluster)for(const Te in h.clusterProperties){const[Ne,f]=h.clusterProperties[Te],u=typeof Ne=="string"?[Ne,["accumulated"],["get",Te]]:Ne;ge.push(...Oa({key:`${w}.${Te}.map`,value:f,validateSpec:J,expressionContext:"cluster-map"})),ge.push(...Oa({key:`${w}.${Te}.reduce`,value:u,validateSpec:J,expressionContext:"cluster-reduce"}))}return ge;case"video":return ga({key:w,value:h,valueSpec:P.source_video,style:H,validateSpec:J,styleSpec:P});case"image":return ga({key:w,value:h,valueSpec:P.source_image,style:H,validateSpec:J,styleSpec:P});case"canvas":return[new K(w,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return no({key:`${w}.type`,value:h.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:H,validateSpec:J,styleSpec:P})}}function wi(_){const h=_.value,w=_.styleSpec,P=w.light,H=_.style;let J=[];const ee=Kn(h);if(h===void 0)return J;if(ee!=="object")return J=J.concat([new K("light",h,`object expected, ${ee} found`)]),J;for(const ge in h){const Te=ge.match(/^(.*)-transition$/);J=J.concat(Te&&P[Te[1]]&&P[Te[1]].transition?_.validateSpec({key:ge,value:h[ge],valueSpec:w.transition,validateSpec:_.validateSpec,style:H,styleSpec:w}):P[ge]?_.validateSpec({key:ge,value:h[ge],valueSpec:P[ge],validateSpec:_.validateSpec,style:H,styleSpec:w}):[new K(ge,h[ge],`unknown property "${ge}"`)])}return J}function Ui(_){const h=_.value,w=_.styleSpec,P=w.sky,H=_.style,J=Kn(h);if(h===void 0)return[];if(J!=="object")return[new K("sky",h,`object expected, ${J} found`)];let ee=[];for(const ge in h)ee=ee.concat(P[ge]?Jn({key:ge,value:h[ge],valueSpec:P[ge],style:H,styleSpec:w}):[new K(ge,h[ge],`unknown property "${ge}"`)]);return ee}function On(_){const h=_.value,w=_.styleSpec,P=w.terrain,H=_.style;let J=[];const ee=Kn(h);if(h===void 0)return J;if(ee!=="object")return J=J.concat([new K("terrain",h,`object expected, ${ee} found`)]),J;for(const ge in h)J=J.concat(P[ge]?_.validateSpec({key:ge,value:h[ge],valueSpec:P[ge],validateSpec:_.validateSpec,style:H,styleSpec:w}):[new K(ge,h[ge],`unknown property "${ge}"`)]);return J}function jn(_){let h=[];const w=_.value,P=_.key;if(Array.isArray(w)){const H=[],J=[];for(const ee in w)w[ee].id&&H.includes(w[ee].id)&&h.push(new K(P,w,`all the sprites' ids must be unique, but ${w[ee].id} is duplicated`)),H.push(w[ee].id),w[ee].url&&J.includes(w[ee].url)&&h.push(new K(P,w,`all the sprites' URLs must be unique, but ${w[ee].url} is duplicated`)),J.push(w[ee].url),h=h.concat(ga({key:`${P}[${ee}]`,value:w[ee],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:_.validateSpec}));return h}return Di({key:P,value:w})}const cr={"*":()=>[],array:xo,boolean:function(_){const h=_.value,w=_.key,P=Kn(h);return P!=="boolean"?[new K(w,h,`boolean expected, ${P} found`)]:[]},number:aa,color:function(_){const h=_.key,w=_.value,P=Kn(w);return P!=="string"?[new K(h,w,`color expected, ${P} found`)]:mn.parse(String(w))?[]:[new K(h,w,`color expected, "${w}" found`)]},constants:ns,enum:no,filter:hl,function:Ma,layer:qi,object:ga,source:ni,light:wi,sky:Ui,terrain:On,string:Di,formatted:function(_){return Di(_).length===0?[]:Oa(_)},resolvedImage:function(_){return Di(_).length===0?[]:Oa(_)},padding:function(_){const h=_.key,w=_.value;if(Kn(w)==="array"){if(w.length<1||w.length>4)return[new K(h,w,`padding requires 1 to 4 values; ${w.length} values found`)];const P={type:"number"};let H=[];for(let J=0;J<w.length;J++)H=H.concat(_.validateSpec({key:`${h}[${J}]`,value:w[J],validateSpec:_.validateSpec,valueSpec:P}));return H}return aa({key:h,value:w,valueSpec:{}})},variableAnchorOffsetCollection:function(_){const h=_.key,w=_.value,P=Kn(w),H=_.styleSpec;if(P!=="array"||w.length<1||w.length%2!=0)return[new K(h,w,"variableAnchorOffsetCollection requires a non-empty array of even length")];let J=[];for(let ee=0;ee<w.length;ee+=2)J=J.concat(no({key:`${h}[${ee}]`,value:w[ee],valueSpec:H.layout_symbol["text-anchor"]})),J=J.concat(xo({key:`${h}[${ee+1}]`,value:w[ee+1],valueSpec:{length:2,value:"number"},validateSpec:_.validateSpec,style:_.style,styleSpec:H}));return J},sprite:jn};function Jn(_){const h=_.value,w=_.valueSpec,P=_.styleSpec;return _.validateSpec=Jn,w.expression&&Jo(vr(h))?Ma(_):w.expression&&Kr(Hr(h))?Oa(_):w.type&&cr[w.type]?cr[w.type](_):ga(ie({},_,{valueSpec:w.type?P[w.type]:w}))}function $s(_){const h=_.value,w=_.key,P=Di(_);return P.length||(h.indexOf("{fontstack}")===-1&&P.push(new K(w,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&P.push(new K(w,h,'"glyphs" url must include a "{range}" token'))),P}function Bs(_,h=Ot){let w=[];return w=w.concat(Jn({key:"",value:_,valueSpec:h.$root,styleSpec:h,style:_,validateSpec:Jn,objectElementValidators:{glyphs:$s,"*":()=>[]}})),_.constants&&(w=w.concat(ns({key:"constants",value:_.constants,style:_,styleSpec:h,validateSpec:Jn}))),ro(w)}function _s(_){return function(h){return _({...h,validateSpec:Jn})}}function ro(_){return[].concat(_).sort((h,w)=>h.line-w.line)}function bo(_){return function(...h){return ro(_.apply(this,h))}}Bs.source=bo(_s(ni)),Bs.sprite=bo(_s(jn)),Bs.glyphs=bo(_s($s)),Bs.light=bo(_s(wi)),Bs.sky=bo(_s(Ui)),Bs.terrain=bo(_s(On)),Bs.layer=bo(_s(qi)),Bs.filter=bo(_s(hl)),Bs.paintProperty=bo(_s(ho)),Bs.layoutProperty=bo(_s(mi));const cs=Bs,Yu=cs.light,Nu=cs.paintProperty,wo=cs.layoutProperty;function Ll(_,h){let w=!1;if(h&&h.length)for(const P of h)_.fire(new xi(new Error(P.message))),w=!0;return w}class Rn{constructor(h,w,P){const H=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;const ee=new Int32Array(this.arrayBuffer);h=ee[0],this.d=(w=ee[1])+2*(P=ee[2]);for(let Te=0;Te<this.d*this.d;Te++){const Ne=ee[3+Te],f=ee[3+Te+1];H.push(Ne===f?null:ee.subarray(Ne,f))}const ge=ee[3+H.length+1];this.keys=ee.subarray(ee[3+H.length],ge),this.bboxes=ee.subarray(ge),this.insert=this._insertReadonly}else{this.d=w+2*P;for(let ee=0;ee<this.d*this.d;ee++)H.push([]);this.keys=[],this.bboxes=[]}this.n=w,this.extent=h,this.padding=P,this.scale=w/h,this.uid=0;const J=P/w*h;this.min=-J,this.max=h+J}insert(h,w,P,H,J){this._forEachCell(w,P,H,J,this._insertCell,this.uid++,void 0,void 0),this.keys.push(h),this.bboxes.push(w),this.bboxes.push(P),this.bboxes.push(H),this.bboxes.push(J)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(h,w,P,H,J,ee){this.cells[J].push(ee)}query(h,w,P,H,J){const ee=this.min,ge=this.max;if(h<=ee&&w<=ee&&ge<=P&&ge<=H&&!J)return Array.prototype.slice.call(this.keys);{const Te=[];return this._forEachCell(h,w,P,H,this._queryCell,Te,{},J),Te}}_queryCell(h,w,P,H,J,ee,ge,Te){const Ne=this.cells[J];if(Ne!==null){const f=this.keys,u=this.bboxes;for(let p=0;p<Ne.length;p++){const E=Ne[p];if(ge[E]===void 0){const B=4*E;(Te?Te(u[B+0],u[B+1],u[B+2],u[B+3]):h<=u[B+2]&&w<=u[B+3]&&P>=u[B+0]&&H>=u[B+1])?(ge[E]=!0,ee.push(f[E])):ge[E]=!1}}}}_forEachCell(h,w,P,H,J,ee,ge,Te){const Ne=this._convertToCellCoord(h),f=this._convertToCellCoord(w),u=this._convertToCellCoord(P),p=this._convertToCellCoord(H);for(let E=Ne;E<=u;E++)for(let B=f;B<=p;B++){const q=this.d*B+E;if((!Te||Te(this._convertFromCellCoord(E),this._convertFromCellCoord(B),this._convertFromCellCoord(E+1),this._convertFromCellCoord(B+1)))&&J.call(this,h,w,P,H,q,ee,ge,Te))return}}_convertFromCellCoord(h){return(h-this.padding)/this.scale}_convertToCellCoord(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const h=this.cells,w=3+this.cells.length+1+1;let P=0;for(let ee=0;ee<this.cells.length;ee++)P+=this.cells[ee].length;const H=new Int32Array(w+P+this.keys.length+this.bboxes.length);H[0]=this.extent,H[1]=this.n,H[2]=this.padding;let J=w;for(let ee=0;ee<h.length;ee++){const ge=h[ee];H[3+ee]=J,H.set(ge,J),J+=ge.length}return H[3+h.length]=J,H.set(this.keys,J),J+=this.keys.length,H[3+h.length+1]=J,H.set(this.bboxes,J),J+=this.bboxes.length,H.buffer}static serialize(h,w){const P=h.toArrayBuffer();return w&&w.push(P),{buffer:P}}static deserialize(h){return new Rn(h.buffer)}}const Na={};function En(_,h,w={}){if(Na[_])throw new Error(`${_} is already registered.`);Object.defineProperty(h,"_classRegistryKey",{value:_,writeable:!1}),Na[_]={klass:h,omit:w.omit||[],shallow:w.shallow||[]}}En("Object",Object),En("TransferableGridIndex",Rn),En("Color",mn),En("Error",Error),En("AJAXError",xn),En("ResolvedImage",en),En("StylePropertyFunction",is),En("StyleExpression",as,{omit:["_evaluator"]}),En("ZoomDependentExpression",ar),En("ZoomConstantExpression",Br),En("CompoundExpression",pn,{omit:["_evaluate"]});for(const _ in Mo)Mo[_]._classRegistryKey||En(`Expression_${_}`,Mo[_]);function Vo(_){return _&&typeof ArrayBuffer<"u"&&(_ instanceof ArrayBuffer||_.constructor&&_.constructor.name==="ArrayBuffer")}function Gl(_,h){if(_==null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||_ instanceof Boolean||_ instanceof Number||_ instanceof String||_ instanceof Date||_ instanceof RegExp||_ instanceof Blob||_ instanceof Error)return _;if(Vo(_)||Ft(_))return h&&h.push(_),_;if(ArrayBuffer.isView(_)){const w=_;return h&&h.push(w.buffer),w}if(_ instanceof ImageData)return h&&h.push(_.data.buffer),_;if(Array.isArray(_)){const w=[];for(const P of _)w.push(Gl(P,h));return w}if(typeof _=="object"){const w=_.constructor,P=w._classRegistryKey;if(!P)throw new Error(`can't serialize object of unregistered class ${w.name}`);if(!Na[P])throw new Error(`${P} is not registered.`);const H=w.serialize?w.serialize(_,h):{};if(w.serialize){if(h&&H===h[h.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const J in _){if(!_.hasOwnProperty(J)||Na[P].omit.indexOf(J)>=0)continue;const ee=_[J];H[J]=Na[P].shallow.indexOf(J)>=0?ee:Gl(ee,h)}_ instanceof Error&&(H.message=_.message)}if(H.$name)throw new Error("$name property is reserved for worker serialization logic.");return P!=="Object"&&(H.$name=P),H}throw new Error("can't serialize object of type "+typeof _)}function Cn(_){if(_==null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||_ instanceof Boolean||_ instanceof Number||_ instanceof String||_ instanceof Date||_ instanceof RegExp||_ instanceof Blob||_ instanceof Error||Vo(_)||Ft(_)||ArrayBuffer.isView(_)||_ instanceof ImageData)return _;if(Array.isArray(_))return _.map(Cn);if(typeof _=="object"){const h=_.$name||"Object";if(!Na[h])throw new Error(`can't deserialize unregistered class ${h}`);const{klass:w}=Na[h];if(!w)throw new Error(`can't deserialize unregistered class ${h}`);if(w.deserialize)return w.deserialize(_);const P=Object.create(w.prototype);for(const H of Object.keys(_)){if(H==="$name")continue;const J=_[H];P[H]=Na[h].shallow.indexOf(H)>=0?J:Cn(J)}return P}throw new Error("can't deserialize object of type "+typeof _)}class Yl{constructor(){this.first=!0}update(h,w){const P=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=P,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=P,!0):(this.lastFloorZoom>P?(this.lastIntegerZoom=P+1,this.lastIntegerZoomTime=w):this.lastFloorZoom<P&&(this.lastIntegerZoom=P,this.lastIntegerZoomTime=w),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=P,!0))}}const Tn={"Latin-1 Supplement":_=>_>=128&&_<=255,Arabic:_=>_>=1536&&_<=1791,"Arabic Supplement":_=>_>=1872&&_<=1919,"Arabic Extended-A":_=>_>=2208&&_<=2303,"Hangul Jamo":_=>_>=4352&&_<=4607,"Unified Canadian Aboriginal Syllabics":_=>_>=5120&&_<=5759,Khmer:_=>_>=6016&&_<=6143,"Unified Canadian Aboriginal Syllabics Extended":_=>_>=6320&&_<=6399,"General Punctuation":_=>_>=8192&&_<=8303,"Letterlike Symbols":_=>_>=8448&&_<=8527,"Number Forms":_=>_>=8528&&_<=8591,"Miscellaneous Technical":_=>_>=8960&&_<=9215,"Control Pictures":_=>_>=9216&&_<=9279,"Optical Character Recognition":_=>_>=9280&&_<=9311,"Enclosed Alphanumerics":_=>_>=9312&&_<=9471,"Geometric Shapes":_=>_>=9632&&_<=9727,"Miscellaneous Symbols":_=>_>=9728&&_<=9983,"Miscellaneous Symbols and Arrows":_=>_>=11008&&_<=11263,"CJK Radicals Supplement":_=>_>=11904&&_<=12031,"Kangxi Radicals":_=>_>=12032&&_<=12255,"Ideographic Description Characters":_=>_>=12272&&_<=12287,"CJK Symbols and Punctuation":_=>_>=12288&&_<=12351,Hiragana:_=>_>=12352&&_<=12447,Katakana:_=>_>=12448&&_<=12543,Bopomofo:_=>_>=12544&&_<=12591,"Hangul Compatibility Jamo":_=>_>=12592&&_<=12687,Kanbun:_=>_>=12688&&_<=12703,"Bopomofo Extended":_=>_>=12704&&_<=12735,"CJK Strokes":_=>_>=12736&&_<=12783,"Katakana Phonetic Extensions":_=>_>=12784&&_<=12799,"Enclosed CJK Letters and Months":_=>_>=12800&&_<=13055,"CJK Compatibility":_=>_>=13056&&_<=13311,"CJK Unified Ideographs Extension A":_=>_>=13312&&_<=19903,"Yijing Hexagram Symbols":_=>_>=19904&&_<=19967,"CJK Unified Ideographs":_=>_>=19968&&_<=40959,"Yi Syllables":_=>_>=40960&&_<=42127,"Yi Radicals":_=>_>=42128&&_<=42191,"Hangul Jamo Extended-A":_=>_>=43360&&_<=43391,"Hangul Syllables":_=>_>=44032&&_<=55215,"Hangul Jamo Extended-B":_=>_>=55216&&_<=55295,"Private Use Area":_=>_>=57344&&_<=63743,"CJK Compatibility Ideographs":_=>_>=63744&&_<=64255,"Arabic Presentation Forms-A":_=>_>=64336&&_<=65023,"Vertical Forms":_=>_>=65040&&_<=65055,"CJK Compatibility Forms":_=>_>=65072&&_<=65103,"Small Form Variants":_=>_>=65104&&_<=65135,"Arabic Presentation Forms-B":_=>_>=65136&&_<=65279,"Halfwidth and Fullwidth Forms":_=>_>=65280&&_<=65519};function yl(_){for(const h of _)if(ql(h.charCodeAt(0)))return!0;return!1}function hu(_){for(const h of _)if(!Vu(h.charCodeAt(0)))return!1;return!0}function Vu(_){return!(Tn.Arabic(_)||Tn["Arabic Supplement"](_)||Tn["Arabic Extended-A"](_)||Tn["Arabic Presentation Forms-A"](_)||Tn["Arabic Presentation Forms-B"](_))}function ql(_){return!(_!==746&&_!==747&&(_<4352||!(Tn["Bopomofo Extended"](_)||Tn.Bopomofo(_)||Tn["CJK Compatibility Forms"](_)&&!(_>=65097&&_<=65103)||Tn["CJK Compatibility Ideographs"](_)||Tn["CJK Compatibility"](_)||Tn["CJK Radicals Supplement"](_)||Tn["CJK Strokes"](_)||!(!Tn["CJK Symbols and Punctuation"](_)||_>=12296&&_<=12305||_>=12308&&_<=12319||_===12336)||Tn["CJK Unified Ideographs Extension A"](_)||Tn["CJK Unified Ideographs"](_)||Tn["Enclosed CJK Letters and Months"](_)||Tn["Hangul Compatibility Jamo"](_)||Tn["Hangul Jamo Extended-A"](_)||Tn["Hangul Jamo Extended-B"](_)||Tn["Hangul Jamo"](_)||Tn["Hangul Syllables"](_)||Tn.Hiragana(_)||Tn["Ideographic Description Characters"](_)||Tn.Kanbun(_)||Tn["Kangxi Radicals"](_)||Tn["Katakana Phonetic Extensions"](_)||Tn.Katakana(_)&&_!==12540||!(!Tn["Halfwidth and Fullwidth Forms"](_)||_===65288||_===65289||_===65293||_>=65306&&_<=65310||_===65339||_===65341||_===65343||_>=65371&&_<=65503||_===65507||_>=65512&&_<=65519)||!(!Tn["Small Form Variants"](_)||_>=65112&&_<=65118||_>=65123&&_<=65126)||Tn["Unified Canadian Aboriginal Syllabics"](_)||Tn["Unified Canadian Aboriginal Syllabics Extended"](_)||Tn["Vertical Forms"](_)||Tn["Yijing Hexagram Symbols"](_)||Tn["Yi Syllables"](_)||Tn["Yi Radicals"](_))))}function vl(_){return!(ql(_)||function(h){return!!(Tn["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||Tn["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||Tn["Letterlike Symbols"](h)||Tn["Number Forms"](h)||Tn["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||Tn["Control Pictures"](h)&&h!==9251||Tn["Optical Character Recognition"](h)||Tn["Enclosed Alphanumerics"](h)||Tn["Geometric Shapes"](h)||Tn["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||Tn["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||Tn["CJK Symbols and Punctuation"](h)||Tn.Katakana(h)||Tn["Private Use Area"](h)||Tn["CJK Compatibility Forms"](h)||Tn["Small Form Variants"](h)||Tn["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)}(_))}function oa(_){return _>=1424&&_<=2303||Tn["Arabic Presentation Forms-A"](_)||Tn["Arabic Presentation Forms-B"](_)}function uc(_,h){return!(!h&&oa(_)||_>=2304&&_<=3583||_>=3840&&_<=4255||Tn.Khmer(_))}function Ku(_){for(const h of _)if(oa(h.charCodeAt(0)))return!0;return!1}const Kl=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(_){this.pluginStatus=_.pluginStatus,this.pluginURL=_.pluginURL}setMethods(_){this.applyArabicShaping=_.applyArabicShaping,this.processBidirectionalText=_.processBidirectionalText,this.processStyledBidirectionalText=_.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ys{constructor(h,w){this.zoom=h,w?(this.now=w.now,this.fadeDuration=w.fadeDuration,this.zoomHistory=w.zoomHistory,this.transition=w.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yl,this.transition={})}isSupportedScript(h){return function(w,P){for(const H of w)if(!uc(H.charCodeAt(0),P))return!1;return!0}(h,Kl.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const h=this.zoom,w=h-Math.floor(h),P=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:w+(1-w)*P}:{fromScale:.5,toScale:1,t:1-(1-P)*w}}}class wa{constructor(h,w){this.property=h,this.value=w,this.expression=function(P,H){if(Jo(P))return new is(P,H);if(Kr(P)){const J=ul(P,H);if(J.result==="error")throw new Error(J.value.map(ee=>`${ee.key}: ${ee.message}`).join(", "));return J.value}{let J=P;return H.type==="color"&&typeof P=="string"?J=mn.parse(P):H.type!=="padding"||typeof P!="number"&&!Array.isArray(P)?H.type==="variableAnchorOffsetCollection"&&Array.isArray(P)&&(J=Xt.parse(P)):J=hr.parse(P),{kind:"constant",evaluate:()=>J}}}(w===void 0?h.specification.default:w,h.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(h,w,P){return this.property.possiblyEvaluate(this,h,w,P)}}class tl{constructor(h){this.property=h,this.value=new wa(h,void 0)}transitioned(h,w){return new Uu(this.property,this.value,w,$t({},h.transition,this.transition),h.now)}untransitioned(){return new Uu(this.property,this.value,null,{},0)}}class xu{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)}getValue(h){return yt(this._values[h].value.value)}setValue(h,w){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new tl(this._values[h].property)),this._values[h].value=new wa(this._values[h].property,w===null?void 0:yt(w))}getTransition(h){return yt(this._values[h].transition)}setTransition(h,w){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new tl(this._values[h].property)),this._values[h].transition=yt(w)||void 0}serialize(){const h={};for(const w of Object.keys(this._values)){const P=this.getValue(w);P!==void 0&&(h[w]=P);const H=this.getTransition(w);H!==void 0&&(h[`${w}-transition`]=H)}return h}transitioned(h,w){const P=new Au(this._properties);for(const H of Object.keys(this._values))P._values[H]=this._values[H].transitioned(h,w._values[H]);return P}untransitioned(){const h=new Au(this._properties);for(const w of Object.keys(this._values))h._values[w]=this._values[w].untransitioned();return h}}class Uu{constructor(h,w,P,H,J){this.property=h,this.value=w,this.begin=J+H.delay||0,this.end=this.begin+H.duration||0,h.specification.transition&&(H.delay||H.duration)&&(this.prior=P)}possiblyEvaluate(h,w,P){const H=h.now||0,J=this.value.possiblyEvaluate(h,w,P),ee=this.prior;if(ee){if(H>this.end)return this.prior=null,J;if(this.value.isDataDriven())return this.prior=null,J;if(H<this.begin)return ee.possiblyEvaluate(h,w,P);{const ge=(H-this.begin)/(this.end-this.begin);return this.property.interpolate(ee.possiblyEvaluate(h,w,P),J,function(Te){if(Te<=0)return 0;if(Te>=1)return 1;const Ne=Te*Te,f=Ne*Te;return 4*(Te<.5?f:3*(Te-Ne)+f-.75)}(ge))}}return J}}class Au{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,w,P){const H=new vs(this._properties);for(const J of Object.keys(this._values))H._values[J]=this._values[J].possiblyEvaluate(h,w,P);return H}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class Gu{constructor(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)}hasValue(h){return this._values[h].value!==void 0}getValue(h){return yt(this._values[h].value)}setValue(h,w){this._values[h]=new wa(this._values[h].property,w===null?void 0:yt(w))}serialize(){const h={};for(const w of Object.keys(this._values)){const P=this.getValue(w);P!==void 0&&(h[w]=P)}return h}possiblyEvaluate(h,w,P){const H=new vs(this._properties);for(const J of Object.keys(this._values))H._values[J]=this._values[J].possiblyEvaluate(h,w,P);return H}}class br{constructor(h,w,P){this.property=h,this.value=w,this.parameters=P}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,w,P,H){return this.property.evaluate(this.value,this.parameters,h,w,P,H)}}class vs{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class gn{constructor(h){this.specification=h}possiblyEvaluate(h,w){if(h.isDataDriven())throw new Error("Value should not be data driven");return h.expression.evaluate(w)}interpolate(h,w,P){const H=Sr[this.specification.type];return H?H(h,w,P):h}}class Zn{constructor(h,w){this.specification=h,this.overrides=w}possiblyEvaluate(h,w,P,H){return new br(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(w,null,{},P,H)}:h.expression,w)}interpolate(h,w,P){if(h.value.kind!=="constant"||w.value.kind!=="constant")return h;if(h.value.value===void 0||w.value.value===void 0)return new br(this,{kind:"constant",value:void 0},h.parameters);const H=Sr[this.specification.type];if(H){const J=H(h.value.value,w.value.value,P);return new br(this,{kind:"constant",value:J},h.parameters)}return h}evaluate(h,w,P,H,J,ee){return h.kind==="constant"?h.value:h.evaluate(w,P,H,J,ee)}}class ir extends Zn{possiblyEvaluate(h,w,P,H){if(h.value===void 0)return new br(this,{kind:"constant",value:void 0},w);if(h.expression.kind==="constant"){const J=h.expression.evaluate(w,null,{},P,H),ee=h.property.specification.type==="resolvedImage"&&typeof J!="string"?J.name:J,ge=this._calculate(ee,ee,ee,w);return new br(this,{kind:"constant",value:ge},w)}if(h.expression.kind==="camera"){const J=this._calculate(h.expression.evaluate({zoom:w.zoom-1}),h.expression.evaluate({zoom:w.zoom}),h.expression.evaluate({zoom:w.zoom+1}),w);return new br(this,{kind:"constant",value:J},w)}return new br(this,h.expression,w)}evaluate(h,w,P,H,J,ee){if(h.kind==="source"){const ge=h.evaluate(w,P,H,J,ee);return this._calculate(ge,ge,ge,w)}return h.kind==="composite"?this._calculate(h.evaluate({zoom:Math.floor(w.zoom)-1},P,H),h.evaluate({zoom:Math.floor(w.zoom)},P,H),h.evaluate({zoom:Math.floor(w.zoom)+1},P,H),w):h.value}_calculate(h,w,P,H){return H.zoom>H.zoomHistory.lastIntegerZoom?{from:h,to:w}:{from:P,to:w}}interpolate(h){return h}}class il{constructor(h){this.specification=h}possiblyEvaluate(h,w,P,H){if(h.value!==void 0){if(h.expression.kind==="constant"){const J=h.expression.evaluate(w,null,{},P,H);return this._calculate(J,J,J,w)}return this._calculate(h.expression.evaluate(new ys(Math.floor(w.zoom-1),w)),h.expression.evaluate(new ys(Math.floor(w.zoom),w)),h.expression.evaluate(new ys(Math.floor(w.zoom+1),w)),w)}}_calculate(h,w,P,H){return H.zoom>H.zoomHistory.lastIntegerZoom?{from:h,to:w}:{from:P,to:w}}interpolate(h){return h}}class Pu{constructor(h){this.specification=h}possiblyEvaluate(h,w,P,H){return!!h.expression.evaluate(w,null,{},P,H)}interpolate(){return!1}}class fa{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const w in h){const P=h[w];P.specification.overridable&&this.overridableProperties.push(w);const H=this.defaultPropertyValues[w]=new wa(P,void 0),J=this.defaultTransitionablePropertyValues[w]=new tl(P);this.defaultTransitioningPropertyValues[w]=J.untransitioned(),this.defaultPossiblyEvaluatedValues[w]=H.possiblyEvaluate({})}}}En("DataDrivenProperty",Zn),En("DataConstantProperty",gn),En("CrossFadedDataDrivenProperty",ir),En("CrossFadedProperty",il),En("ColorRampProperty",Pu);const bu="-transition";class Is extends Bn{constructor(h,w){if(super(),this.id=h.id,this.type=h.type,this._featureFilter={filter:()=>!0,needGeometry:!1},h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter),w.layout&&(this._unevaluatedLayout=new Gu(w.layout)),w.paint)){this._transitionablePaint=new xu(w.paint);for(const P in h.paint)this.setPaintProperty(P,h.paint[P],{validate:!1});for(const P in h.layout)this.setLayoutProperty(P,h.layout[P],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vs(w.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}setLayoutProperty(h,w,P={}){w!=null&&this._validate(wo,`layers.${this.id}.layout.${h}`,h,w,P)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,w):this.visibility=w)}getPaintProperty(h){return h.endsWith(bu)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,w,P={}){if(w!=null&&this._validate(Nu,`layers.${this.id}.paint.${h}`,h,w,P))return!1;if(h.endsWith(bu))return this._transitionablePaint.setTransition(h.slice(0,-11),w||void 0),!1;{const H=this._transitionablePaint._values[h],J=H.property.specification["property-type"]==="cross-faded-data-driven",ee=H.value.isDataDriven(),ge=H.value;this._transitionablePaint.setValue(h,w),this._handleSpecialPaintPropertyUpdate(h);const Te=this._transitionablePaint._values[h].value;return Te.isDataDriven()||ee||J||this._handleOverridablePaintPropertyUpdate(h,ge,Te)}}_handleSpecialPaintPropertyUpdate(h){}_handleOverridablePaintPropertyUpdate(h,w,P){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,w){h.getCrossfadeParameters&&(this._crossfadeParameters=h.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,w)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,w)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),At(h,(w,P)=>!(w===void 0||P==="layout"&&!Object.keys(w).length||P==="paint"&&!Object.keys(w).length))}_validate(h,w,P,H,J={}){return(!J||J.validate!==!1)&&Ll(this,h.call(cs,{key:w,layerType:this.type,objectKey:P,value:H,styleSpec:Ot,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const w=this.paint.get(h);if(w instanceof br&&Ds(w.property.specification)&&(w.value.kind==="source"||w.value.kind==="composite")&&w.value.isStateDependent)return!0}return!1}}const Bo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Mi{constructor(h,w){this._structArray=h,this._pos1=w*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class zi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,w){return h._trim(),w&&(h.isTransferred=!0,w.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const w=Object.create(this.prototype);return w.arrayBuffer=h.arrayBuffer,w.length=h.length,w.capacity=h.arrayBuffer.byteLength/w.bytesPerElement,w._refreshViews(),w}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const w=this.uint8;this._refreshViews(),w&&this.uint8.set(w)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Es(_,h=1){let w=0,P=0;return{members:_.map(H=>{const J=Bo[H.type].BYTES_PER_ELEMENT,ee=w=wu(w,Math.max(h,J)),ge=H.components||1;return P=Math.max(P,J),w+=J*ge,{name:H.name,type:H.type,components:ge,offset:ee}}),size:wu(w,Math.max(P,h)),alignment:h}}function wu(_,h){return Math.ceil(_/h)*h}class Uo extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,w){const P=this.length;return this.resize(P+1),this.emplace(P,h,w)}emplace(h,w,P){const H=2*h;return this.int16[H+0]=w,this.int16[H+1]=P,h}}Uo.prototype.bytesPerElement=4,En("StructArrayLayout2i4",Uo);class ms extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,w,P){const H=this.length;return this.resize(H+1),this.emplace(H,h,w,P)}emplace(h,w,P,H){const J=3*h;return this.int16[J+0]=w,this.int16[J+1]=P,this.int16[J+2]=H,h}}ms.prototype.bytesPerElement=6,En("StructArrayLayout3i6",ms);class Al extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,w,P,H){const J=this.length;return this.resize(J+1),this.emplace(J,h,w,P,H)}emplace(h,w,P,H,J){const ee=4*h;return this.int16[ee+0]=w,this.int16[ee+1]=P,this.int16[ee+2]=H,this.int16[ee+3]=J,h}}Al.prototype.bytesPerElement=8,En("StructArrayLayout4i8",Al);class zs extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee){const ge=this.length;return this.resize(ge+1),this.emplace(ge,h,w,P,H,J,ee)}emplace(h,w,P,H,J,ee,ge){const Te=6*h;return this.int16[Te+0]=w,this.int16[Te+1]=P,this.int16[Te+2]=H,this.int16[Te+3]=J,this.int16[Te+4]=ee,this.int16[Te+5]=ge,h}}zs.prototype.bytesPerElement=12,En("StructArrayLayout2i4i12",zs);class T extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee){const ge=this.length;return this.resize(ge+1),this.emplace(ge,h,w,P,H,J,ee)}emplace(h,w,P,H,J,ee,ge){const Te=4*h,Ne=8*h;return this.int16[Te+0]=w,this.int16[Te+1]=P,this.uint8[Ne+4]=H,this.uint8[Ne+5]=J,this.uint8[Ne+6]=ee,this.uint8[Ne+7]=ge,h}}T.prototype.bytesPerElement=8,En("StructArrayLayout2i4ub8",T);class L extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,w){const P=this.length;return this.resize(P+1),this.emplace(P,h,w)}emplace(h,w,P){const H=2*h;return this.float32[H+0]=w,this.float32[H+1]=P,h}}L.prototype.bytesPerElement=8,En("StructArrayLayout2f8",L);class R extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee,ge,Te,Ne,f){const u=this.length;return this.resize(u+1),this.emplace(u,h,w,P,H,J,ee,ge,Te,Ne,f)}emplace(h,w,P,H,J,ee,ge,Te,Ne,f,u){const p=10*h;return this.uint16[p+0]=w,this.uint16[p+1]=P,this.uint16[p+2]=H,this.uint16[p+3]=J,this.uint16[p+4]=ee,this.uint16[p+5]=ge,this.uint16[p+6]=Te,this.uint16[p+7]=Ne,this.uint16[p+8]=f,this.uint16[p+9]=u,h}}R.prototype.bytesPerElement=20,En("StructArrayLayout10ui20",R);class F extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee,ge,Te,Ne,f,u,p){const E=this.length;return this.resize(E+1),this.emplace(E,h,w,P,H,J,ee,ge,Te,Ne,f,u,p)}emplace(h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E){const B=12*h;return this.int16[B+0]=w,this.int16[B+1]=P,this.int16[B+2]=H,this.int16[B+3]=J,this.uint16[B+4]=ee,this.uint16[B+5]=ge,this.uint16[B+6]=Te,this.uint16[B+7]=Ne,this.int16[B+8]=f,this.int16[B+9]=u,this.int16[B+10]=p,this.int16[B+11]=E,h}}F.prototype.bytesPerElement=24,En("StructArrayLayout4i4ui4i24",F);class te extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,w,P){const H=this.length;return this.resize(H+1),this.emplace(H,h,w,P)}emplace(h,w,P,H){const J=3*h;return this.float32[J+0]=w,this.float32[J+1]=P,this.float32[J+2]=H,h}}te.prototype.bytesPerElement=12,En("StructArrayLayout3f12",te);class ue extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const w=this.length;return this.resize(w+1),this.emplace(w,h)}emplace(h,w){return this.uint32[1*h+0]=w,h}}ue.prototype.bytesPerElement=4,En("StructArrayLayout1ul4",ue);class le extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee,ge,Te,Ne){const f=this.length;return this.resize(f+1),this.emplace(f,h,w,P,H,J,ee,ge,Te,Ne)}emplace(h,w,P,H,J,ee,ge,Te,Ne,f){const u=10*h,p=5*h;return this.int16[u+0]=w,this.int16[u+1]=P,this.int16[u+2]=H,this.int16[u+3]=J,this.int16[u+4]=ee,this.int16[u+5]=ge,this.uint32[p+3]=Te,this.uint16[u+8]=Ne,this.uint16[u+9]=f,h}}le.prototype.bytesPerElement=20,En("StructArrayLayout6i1ul2ui20",le);class Se extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee){const ge=this.length;return this.resize(ge+1),this.emplace(ge,h,w,P,H,J,ee)}emplace(h,w,P,H,J,ee,ge){const Te=6*h;return this.int16[Te+0]=w,this.int16[Te+1]=P,this.int16[Te+2]=H,this.int16[Te+3]=J,this.int16[Te+4]=ee,this.int16[Te+5]=ge,h}}Se.prototype.bytesPerElement=12,En("StructArrayLayout2i2i2i12",Se);class Xe extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J){const ee=this.length;return this.resize(ee+1),this.emplace(ee,h,w,P,H,J)}emplace(h,w,P,H,J,ee){const ge=4*h,Te=8*h;return this.float32[ge+0]=w,this.float32[ge+1]=P,this.float32[ge+2]=H,this.int16[Te+6]=J,this.int16[Te+7]=ee,h}}Xe.prototype.bytesPerElement=16,En("StructArrayLayout2f1f2i16",Xe);class bt extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,w,P,H){const J=this.length;return this.resize(J+1),this.emplace(J,h,w,P,H)}emplace(h,w,P,H,J){const ee=12*h,ge=3*h;return this.uint8[ee+0]=w,this.uint8[ee+1]=P,this.float32[ge+1]=H,this.float32[ge+2]=J,h}}bt.prototype.bytesPerElement=12,En("StructArrayLayout2ub2f12",bt);class kt extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,w,P){const H=this.length;return this.resize(H+1),this.emplace(H,h,w,P)}emplace(h,w,P,H){const J=3*h;return this.uint16[J+0]=w,this.uint16[J+1]=P,this.uint16[J+2]=H,h}}kt.prototype.bytesPerElement=6,En("StructArrayLayout3ui6",kt);class ri extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q,W,se){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q,W,se)}emplace(h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q,W,se,fe){const ve=24*h,Be=12*h,He=48*h;return this.int16[ve+0]=w,this.int16[ve+1]=P,this.uint16[ve+2]=H,this.uint16[ve+3]=J,this.uint32[Be+2]=ee,this.uint32[Be+3]=ge,this.uint32[Be+4]=Te,this.uint16[ve+10]=Ne,this.uint16[ve+11]=f,this.uint16[ve+12]=u,this.float32[Be+7]=p,this.float32[Be+8]=E,this.uint8[He+36]=B,this.uint8[He+37]=q,this.uint8[He+38]=W,this.uint32[Be+10]=se,this.int16[ve+22]=fe,h}}ri.prototype.bytesPerElement=48,En("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ri);class Ht extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei){const Zt=this.length;return this.resize(Zt+1),this.emplace(Zt,h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei)}emplace(h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei,Zt){const Wt=32*h,hi=16*h;return this.int16[Wt+0]=w,this.int16[Wt+1]=P,this.int16[Wt+2]=H,this.int16[Wt+3]=J,this.int16[Wt+4]=ee,this.int16[Wt+5]=ge,this.int16[Wt+6]=Te,this.int16[Wt+7]=Ne,this.uint16[Wt+8]=f,this.uint16[Wt+9]=u,this.uint16[Wt+10]=p,this.uint16[Wt+11]=E,this.uint16[Wt+12]=B,this.uint16[Wt+13]=q,this.uint16[Wt+14]=W,this.uint16[Wt+15]=se,this.uint16[Wt+16]=fe,this.uint16[Wt+17]=ve,this.uint16[Wt+18]=Be,this.uint16[Wt+19]=He,this.uint16[Wt+20]=it,this.uint16[Wt+21]=pt,this.uint16[Wt+22]=vt,this.uint32[hi+12]=Dt,this.float32[hi+13]=Lt,this.float32[hi+14]=Rt,this.uint16[Wt+30]=ei,this.uint16[Wt+31]=Zt,h}}Ht.prototype.bytesPerElement=64,En("StructArrayLayout8i15ui1ul2f2ui64",Ht);class Qt extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const w=this.length;return this.resize(w+1),this.emplace(w,h)}emplace(h,w){return this.float32[1*h+0]=w,h}}Qt.prototype.bytesPerElement=4,En("StructArrayLayout1f4",Qt);class Q extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,w,P){const H=this.length;return this.resize(H+1),this.emplace(H,h,w,P)}emplace(h,w,P,H){const J=3*h;return this.uint16[6*h+0]=w,this.float32[J+1]=P,this.float32[J+2]=H,h}}Q.prototype.bytesPerElement=12,En("StructArrayLayout1ui2f12",Q);class A extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,w,P){const H=this.length;return this.resize(H+1),this.emplace(H,h,w,P)}emplace(h,w,P,H){const J=4*h;return this.uint32[2*h+0]=w,this.uint16[J+2]=P,this.uint16[J+3]=H,h}}A.prototype.bytesPerElement=8,En("StructArrayLayout1ul2ui8",A);class C extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,w){const P=this.length;return this.resize(P+1),this.emplace(P,h,w)}emplace(h,w,P){const H=2*h;return this.uint16[H+0]=w,this.uint16[H+1]=P,h}}C.prototype.bytesPerElement=4,En("StructArrayLayout2ui4",C);class O extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const w=this.length;return this.resize(w+1),this.emplace(w,h)}emplace(h,w){return this.uint16[1*h+0]=w,h}}O.prototype.bytesPerElement=2,En("StructArrayLayout1ui2",O);class V extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,w,P,H){const J=this.length;return this.resize(J+1),this.emplace(J,h,w,P,H)}emplace(h,w,P,H,J){const ee=4*h;return this.float32[ee+0]=w,this.float32[ee+1]=P,this.float32[ee+2]=H,this.float32[ee+3]=J,h}}V.prototype.bytesPerElement=16,En("StructArrayLayout4f16",V);class x extends Mi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new oe(this.anchorPointX,this.anchorPointY)}}x.prototype.size=20;class s extends le{get(h){return new x(this,h)}}En("CollisionBoxArray",s);class i extends Mi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(h){this._structArray.uint8[this._pos1+37]=h}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(h){this._structArray.uint8[this._pos1+38]=h}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(h){this._structArray.uint32[this._pos4+10]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}i.prototype.size=48;class r extends ri{get(h){return new i(this,h)}}En("PlacedSymbolArray",r);class l extends Mi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(h){this._structArray.uint32[this._pos4+12]=h}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}l.prototype.size=64;class d extends Ht{get(h){return new l(this,h)}}En("SymbolInstanceArray",d);class y extends Qt{getoffsetX(h){return this.float32[1*h+0]}}En("GlyphOffsetArray",y);class I extends ms{getx(h){return this.int16[3*h+0]}gety(h){return this.int16[3*h+1]}gettileUnitDistanceFromAnchor(h){return this.int16[3*h+2]}}En("SymbolLineVertexArray",I);class k extends Mi{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}k.prototype.size=12;class z extends Q{get(h){return new k(this,h)}}En("TextAnchorOffsetArray",z);class Z extends Mi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Z.prototype.size=8;class Y extends A{get(h){return new Z(this,h)}}En("FeatureIndexArray",Y);class Ae extends Uo{}class Ie extends Uo{}class ke extends Uo{}class Fe extends zs{}class ze extends T{}class tt extends L{}class wt extends R{}class lt extends F{}class ft extends te{}class Tt extends ue{}class It extends Se{}class si extends bt{}class Kt extends kt{}class ii extends C{}const ai=Es([{name:"a_pos",components:2,type:"Int16"}],4),{members:Wi}=ai;class $i{constructor(h=[]){this.segments=h}prepareSegment(h,w,P,H){let J=this.segments[this.segments.length-1];return h>$i.MAX_VERTEX_ARRAY_LENGTH&&ut(`Max vertices per segment is ${$i.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}`),(!J||J.vertexLength+h>$i.MAX_VERTEX_ARRAY_LENGTH||J.sortKey!==H)&&(J={vertexOffset:w.length,primitiveOffset:P.length,vertexLength:0,primitiveLength:0},H!==void 0&&(J.sortKey=H),this.segments.push(J)),J}get(){return this.segments}destroy(){for(const h of this.segments)for(const w in h.vaos)h.vaos[w].destroy()}static simpleSegment(h,w,P,H){return new $i([{vertexOffset:h,primitiveOffset:w,vertexLength:P,primitiveLength:H,vaos:{},sortKey:0}])}}function Ei(_,h){return 256*(_=Mt(Math.floor(_),0,255))+Mt(Math.floor(h),0,255)}$i.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,En("SegmentVector",$i);const Hi=Es([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ji={exports:{}},cn={exports:{}};cn.exports=function(_,h){var w,P,H,J,ee,ge,Te,Ne;for(P=_.length-(w=3&_.length),H=h,ee=3432918353,ge=461845907,Ne=0;Ne<P;)Te=255&_.charCodeAt(Ne)|(255&_.charCodeAt(++Ne))<<8|(255&_.charCodeAt(++Ne))<<16|(255&_.charCodeAt(++Ne))<<24,++Ne,H=27492+(65535&(J=5*(65535&(H=(H^=Te=(65535&(Te=(Te=(65535&Te)*ee+(((Te>>>16)*ee&65535)<<16)&4294967295)<<15|Te>>>17))*ge+(((Te>>>16)*ge&65535)<<16)&4294967295)<<13|H>>>19))+((5*(H>>>16)&65535)<<16)&4294967295))+((58964+(J>>>16)&65535)<<16);switch(Te=0,w){case 3:Te^=(255&_.charCodeAt(Ne+2))<<16;case 2:Te^=(255&_.charCodeAt(Ne+1))<<8;case 1:H^=Te=(65535&(Te=(Te=(65535&(Te^=255&_.charCodeAt(Ne)))*ee+(((Te>>>16)*ee&65535)<<16)&4294967295)<<15|Te>>>17))*ge+(((Te>>>16)*ge&65535)<<16)&4294967295}return H^=_.length,H=2246822507*(65535&(H^=H>>>16))+((2246822507*(H>>>16)&65535)<<16)&4294967295,H=3266489909*(65535&(H^=H>>>13))+((3266489909*(H>>>16)&65535)<<16)&4294967295,(H^=H>>>16)>>>0};var Nn=cn.exports,nn={exports:{}};nn.exports=function(_,h){for(var w,P=_.length,H=h^P,J=0;P>=4;)w=1540483477*(65535&(w=255&_.charCodeAt(J)|(255&_.charCodeAt(++J))<<8|(255&_.charCodeAt(++J))<<16|(255&_.charCodeAt(++J))<<24))+((1540483477*(w>>>16)&65535)<<16),H=1540483477*(65535&H)+((1540483477*(H>>>16)&65535)<<16)^(w=1540483477*(65535&(w^=w>>>24))+((1540483477*(w>>>16)&65535)<<16)),P-=4,++J;switch(P){case 3:H^=(255&_.charCodeAt(J+2))<<16;case 2:H^=(255&_.charCodeAt(J+1))<<8;case 1:H=1540483477*(65535&(H^=255&_.charCodeAt(J)))+((1540483477*(H>>>16)&65535)<<16)}return H=1540483477*(65535&(H^=H>>>13))+((1540483477*(H>>>16)&65535)<<16),(H^=H>>>15)>>>0};var Mn=Nn,wr=nn.exports;ji.exports=Mn,ji.exports.murmur3=Mn,ji.exports.murmur2=wr;var nr=N(ji.exports);class Pa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,w,P,H){this.ids.push(_a(h)),this.positions.push(w,P,H)}getPositions(h){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const w=_a(h);let P=0,H=this.ids.length-1;for(;P<H;){const ee=P+H>>1;this.ids[ee]>=w?H=ee:P=ee+1}const J=[];for(;this.ids[P]===w;)J.push({index:this.positions[3*P],start:this.positions[3*P+1],end:this.positions[3*P+2]}),P++;return J}static serialize(h,w){const P=new Float64Array(h.ids),H=new Uint32Array(h.positions);return Vs(P,H,0,P.length-1),w&&w.push(P.buffer,H.buffer),{ids:P,positions:H}}static deserialize(h){const w=new Pa;return w.ids=h.ids,w.positions=h.positions,w.indexed=!0,w}}function _a(_){const h=+_;return!isNaN(h)&&h<=Number.MAX_SAFE_INTEGER?h:nr(String(_))}function Vs(_,h,w,P){for(;w<P;){const H=_[w+P>>1];let J=w-1,ee=P+1;for(;;){do J++;while(_[J]<H);do ee--;while(_[ee]>H);if(J>=ee)break;Ao(_,J,ee),Ao(h,3*J,3*ee),Ao(h,3*J+1,3*ee+1),Ao(h,3*J+2,3*ee+2)}ee-w<P-ee?(Vs(_,h,w,ee),w=ee+1):(Vs(_,h,ee+1,P),P=ee)}}function Ao(_,h,w){const P=_[h];_[h]=_[w],_[w]=P}En("FeaturePositionMap",Pa);class fo{constructor(h,w){this.gl=h.gl,this.location=w}}class $r extends fo{constructor(h,w){super(h,w),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Sa extends fo{constructor(h,w){super(h,w),this.current=[0,0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3]))}}class So extends fo{constructor(h,w){super(h,w),this.current=mn.transparent}set(h){h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a))}}const Io=new Float32Array(16);function Ks(_){return[Ei(255*_.r,255*_.g),Ei(255*_.b,255*_.a)]}class os{constructor(h,w,P){this.value=h,this.uniformNames=w.map(H=>`u_${H}`),this.type=P}setUniform(h,w,P){h.set(P.constantOr(this.value))}getBinding(h,w,P){return this.type==="color"?new So(h,w):new $r(h,w)}}class ls{constructor(h,w){this.uniformNames=w.map(P=>`u_${P}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(h,w){this.pixelRatioFrom=w.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=w.tlbr,this.patternTo=h.tlbr}setUniform(h,w,P,H){const J=H==="u_pattern_to"?this.patternTo:H==="u_pattern_from"?this.patternFrom:H==="u_pixel_ratio_to"?this.pixelRatioTo:H==="u_pixel_ratio_from"?this.pixelRatioFrom:null;J&&h.set(J)}getBinding(h,w,P){return P.substr(0,9)==="u_pattern"?new Sa(h,w):new $r(h,w)}}class Ur{constructor(h,w,P,H){this.expression=h,this.type=P,this.maxValue=0,this.paintVertexAttributes=w.map(J=>({name:`a_${J}`,type:"Float32",components:P==="color"?2:1,offset:0})),this.paintVertexArray=new H}populatePaintArray(h,w,P,H,J){const ee=this.paintVertexArray.length,ge=this.expression.evaluate(new ys(0),w,{},H,[],J);this.paintVertexArray.resize(h),this._setPaintValue(ee,h,ge)}updatePaintArray(h,w,P,H){const J=this.expression.evaluate({zoom:0},P,H);this._setPaintValue(h,w,J)}_setPaintValue(h,w,P){if(this.type==="color"){const H=Ks(P);for(let J=h;J<w;J++)this.paintVertexArray.emplace(J,H[0],H[1])}else{for(let H=h;H<w;H++)this.paintVertexArray.emplace(H,P);this.maxValue=Math.max(this.maxValue,Math.abs(P))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Cs{constructor(h,w,P,H,J,ee){this.expression=h,this.uniformNames=w.map(ge=>`u_${ge}_t`),this.type=P,this.useIntegerZoom=H,this.zoom=J,this.maxValue=0,this.paintVertexAttributes=w.map(ge=>({name:`a_${ge}`,type:"Float32",components:P==="color"?4:2,offset:0})),this.paintVertexArray=new ee}populatePaintArray(h,w,P,H,J){const ee=this.expression.evaluate(new ys(this.zoom),w,{},H,[],J),ge=this.expression.evaluate(new ys(this.zoom+1),w,{},H,[],J),Te=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(Te,h,ee,ge)}updatePaintArray(h,w,P,H){const J=this.expression.evaluate({zoom:this.zoom},P,H),ee=this.expression.evaluate({zoom:this.zoom+1},P,H);this._setPaintValue(h,w,J,ee)}_setPaintValue(h,w,P,H){if(this.type==="color"){const J=Ks(P),ee=Ks(H);for(let ge=h;ge<w;ge++)this.paintVertexArray.emplace(ge,J[0],J[1],ee[0],ee[1])}else{for(let J=h;J<w;J++)this.paintVertexArray.emplace(J,P,H);this.maxValue=Math.max(this.maxValue,Math.abs(P),Math.abs(H))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,w){const P=this.useIntegerZoom?Math.floor(w.zoom):w.zoom,H=Mt(this.expression.interpolationFactor(P,this.zoom,this.zoom+1),0,1);h.set(H)}getBinding(h,w,P){return new $r(h,w)}}class Js{constructor(h,w,P,H,J,ee){this.expression=h,this.type=w,this.useIntegerZoom=P,this.zoom=H,this.layerId=ee,this.zoomInPaintVertexArray=new J,this.zoomOutPaintVertexArray=new J}populatePaintArray(h,w,P){const H=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(H,h,w.patterns&&w.patterns[this.layerId],P)}updatePaintArray(h,w,P,H,J){this._setPaintValues(h,w,P.patterns&&P.patterns[this.layerId],J)}_setPaintValues(h,w,P,H){if(!H||!P)return;const{min:J,mid:ee,max:ge}=P,Te=H[J],Ne=H[ee],f=H[ge];if(Te&&Ne&&f)for(let u=h;u<w;u++)this.zoomInPaintVertexArray.emplace(u,Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],Te.tl[0],Te.tl[1],Te.br[0],Te.br[1],Ne.pixelRatio,Te.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],Ne.pixelRatio,f.pixelRatio)}upload(h){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,Hi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,Hi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class zo{constructor(h,w,P){this.binders={},this._buffers=[];const H=[];for(const J in h.paint._values){if(!P(J))continue;const ee=h.paint.get(J);if(!(ee instanceof br&&Ds(ee.property.specification)))continue;const ge=qo(J,h.type),Te=ee.value,Ne=ee.property.specification.type,f=ee.property.useIntegerZoom,u=ee.property.specification["property-type"],p=u==="cross-faded"||u==="cross-faded-data-driven";if(Te.kind==="constant")this.binders[J]=p?new ls(Te.value,ge):new os(Te.value,ge,Ne),H.push(`/u_${J}`);else if(Te.kind==="source"||p){const E=Cc(J,Ne,"source");this.binders[J]=p?new Js(Te,Ne,f,w,E,h.id):new Ur(Te,ge,Ne,E),H.push(`/a_${J}`)}else{const E=Cc(J,Ne,"composite");this.binders[J]=new Cs(Te,ge,Ne,f,w,E),H.push(`/z_${J}`)}}this.cacheKey=H.sort().join("")}getMaxValue(h){const w=this.binders[h];return w instanceof Ur||w instanceof Cs?w.maxValue:0}populatePaintArrays(h,w,P,H,J){for(const ee in this.binders){const ge=this.binders[ee];(ge instanceof Ur||ge instanceof Cs||ge instanceof Js)&&ge.populatePaintArray(h,w,P,H,J)}}setConstantPatternPositions(h,w){for(const P in this.binders){const H=this.binders[P];H instanceof ls&&H.setConstantPatternPositions(h,w)}}updatePaintArrays(h,w,P,H,J){let ee=!1;for(const ge in h){const Te=w.getPositions(ge);for(const Ne of Te){const f=P.feature(Ne.index);for(const u in this.binders){const p=this.binders[u];if((p instanceof Ur||p instanceof Cs||p instanceof Js)&&p.expression.isStateDependent===!0){const E=H.paint.get(u);p.expression=E.value,p.updatePaintArray(Ne.start,Ne.end,f,h[ge],J),ee=!0}}}}return ee}defines(){const h=[];for(const w in this.binders){const P=this.binders[w];(P instanceof os||P instanceof ls)&&h.push(...P.uniformNames.map(H=>`#define HAS_UNIFORM_${H}`))}return h}getBinderAttributes(){const h=[];for(const w in this.binders){const P=this.binders[w];if(P instanceof Ur||P instanceof Cs)for(let H=0;H<P.paintVertexAttributes.length;H++)h.push(P.paintVertexAttributes[H].name);else if(P instanceof Js)for(let H=0;H<Hi.members.length;H++)h.push(Hi.members[H].name)}return h}getBinderUniforms(){const h=[];for(const w in this.binders){const P=this.binders[w];if(P instanceof os||P instanceof ls||P instanceof Cs)for(const H of P.uniformNames)h.push(H)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h,w){const P=[];for(const H in this.binders){const J=this.binders[H];if(J instanceof os||J instanceof ls||J instanceof Cs){for(const ee of J.uniformNames)if(w[ee]){const ge=J.getBinding(h,w[ee],ee);P.push({name:ee,property:H,binding:ge})}}}return P}setUniforms(h,w,P,H){for(const{name:J,property:ee,binding:ge}of w)this.binders[ee].setUniform(ge,H,P.get(ee),J)}updatePaintBuffers(h){this._buffers=[];for(const w in this.binders){const P=this.binders[w];if(h&&P instanceof Js){const H=h.fromScale===2?P.zoomInPaintVertexBuffer:P.zoomOutPaintVertexBuffer;H&&this._buffers.push(H)}else(P instanceof Ur||P instanceof Cs)&&P.paintVertexBuffer&&this._buffers.push(P.paintVertexBuffer)}}upload(h){for(const w in this.binders){const P=this.binders[w];(P instanceof Ur||P instanceof Cs||P instanceof Js)&&P.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const w=this.binders[h];(w instanceof Ur||w instanceof Cs||w instanceof Js)&&w.destroy()}}}class Go{constructor(h,w,P=()=>!0){this.programConfigurations={};for(const H of h)this.programConfigurations[H.id]=new zo(H,w,P);this.needsUpload=!1,this._featureMap=new Pa,this._bufferOffset=0}populatePaintArrays(h,w,P,H,J,ee){for(const ge in this.programConfigurations)this.programConfigurations[ge].populatePaintArrays(h,w,H,J,ee);w.id!==void 0&&this._featureMap.add(w.id,P,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,w,P,H){for(const J of P)this.needsUpload=this.programConfigurations[J.id].updatePaintArrays(h,this._featureMap,w,J,H)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const w in this.programConfigurations)this.programConfigurations[w].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}function qo(_,h){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[_]||[_.replace(`${h}-`,"").replace(/-/g,"_")]}function Cc(_,h,w){const P={color:{source:L,composite:V},number:{source:Qt,composite:L}},H=function(J){return{"line-pattern":{source:wt,composite:wt},"fill-pattern":{source:wt,composite:wt},"fill-extrusion-pattern":{source:wt,composite:wt}}[J]}(_);return H&&H[w]||P[h][w]}En("ConstantBinder",os),En("CrossFadedConstantBinder",ls),En("SourceExpressionBinder",Ur),En("CrossFadedCompositeBinder",Js),En("CompositeExpressionBinder",Cs),En("ProgramConfiguration",zo,{omit:["_buffers"]}),En("ProgramConfigurationSet",Go);const ea=8192,Jl=Math.pow(2,14)-1,fu=-Jl-1;function nl(_){const h=ea/_.extent,w=_.loadGeometry();for(let P=0;P<w.length;P++){const H=w[P];for(let J=0;J<H.length;J++){const ee=H[J],ge=Math.round(ee.x*h),Te=Math.round(ee.y*h);ee.x=Mt(ge,fu,Jl),ee.y=Mt(Te,fu,Jl),(ge<ee.x||ge>ee.x+1||Te<ee.y||Te>ee.y+1)&&ut("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return w}function xl(_,h){return{type:_.type,id:_.id,properties:_.properties,geometry:h?nl(_):[]}}function Bl(_,h,w,P,H){_.emplaceBack(2*h+(P+1)/2,2*w+(H+1)/2)}class du{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(w=>w.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Ie,this.indexArray=new Kt,this.segments=new $i,this.programConfigurations=new Go(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id)}populate(h,w,P){const H=this.layers[0],J=[];let ee=null,ge=!1;H.type==="circle"&&(ee=H.layout.get("circle-sort-key"),ge=!ee.isConstant());for(const{feature:Te,id:Ne,index:f,sourceLayerIndex:u}of h){const p=this.layers[0]._featureFilter.needGeometry,E=xl(Te,p);if(!this.layers[0]._featureFilter.filter(new ys(this.zoom),E,P))continue;const B=ge?ee.evaluate(E,{},P):void 0,q={id:Ne,properties:Te.properties,type:Te.type,sourceLayerIndex:u,index:f,geometry:p?E.geometry:nl(Te),patterns:{},sortKey:B};J.push(q)}ge&&J.sort((Te,Ne)=>Te.sortKey-Ne.sortKey);for(const Te of J){const{geometry:Ne,index:f,sourceLayerIndex:u}=Te,p=h[f].feature;this.addFeature(Te,Ne,f,P),w.featureIndex.insert(p,Ne,f,u,this.index)}}update(h,w,P){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,w,this.stateDependentLayers,P)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Wi),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,w,P,H){for(const J of w)for(const ee of J){const ge=ee.x,Te=ee.y;if(ge<0||ge>=ea||Te<0||Te>=ea)continue;const Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,h.sortKey),f=Ne.vertexLength;Bl(this.layoutVertexArray,ge,Te,-1,-1),Bl(this.layoutVertexArray,ge,Te,1,-1),Bl(this.layoutVertexArray,ge,Te,1,1),Bl(this.layoutVertexArray,ge,Te,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),Ne.vertexLength+=4,Ne.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,P,{},H)}}function Af(_,h){for(let w=0;w<_.length;w++)if(Yc(h,_[w]))return!0;for(let w=0;w<h.length;w++)if(Yc(_,h[w]))return!0;return!!vh(_,h)}function qh(_,h,w){return!!Yc(_,h)||!!Tc(h,_,w)}function Va(_,h){if(_.length===1)return m0(h,_[0]);for(let w=0;w<h.length;w++){const P=h[w];for(let H=0;H<P.length;H++)if(Yc(_,P[H]))return!0}for(let w=0;w<_.length;w++)if(m0(h,_[w]))return!0;for(let w=0;w<h.length;w++)if(vh(_,h[w]))return!0;return!1}function yA(_,h,w){if(_.length>1){if(vh(_,h))return!0;for(let P=0;P<h.length;P++)if(Tc(h[P],_,w))return!0}for(let P=0;P<_.length;P++)if(Tc(_[P],h,w))return!0;return!1}function vh(_,h){if(_.length===0||h.length===0)return!1;for(let w=0;w<_.length-1;w++){const P=_[w],H=_[w+1];for(let J=0;J<h.length-1;J++)if(Hh(P,H,h[J],h[J+1]))return!0}return!1}function Hh(_,h,w,P){return Ye(_,w,P)!==Ye(h,w,P)&&Ye(_,h,w)!==Ye(_,h,P)}function Tc(_,h,w){const P=w*w;if(h.length===1)return _.distSqr(h[0])<P;for(let H=1;H<h.length;H++)if(jh(_,h[H-1],h[H])<P)return!0;return!1}function jh(_,h,w){const P=h.distSqr(w);if(P===0)return _.distSqr(h);const H=((_.x-h.x)*(w.x-h.x)+(_.y-h.y)*(w.y-h.y))/P;return _.distSqr(H<0?h:H>1?w:w.sub(h)._mult(H)._add(h))}function m0(_,h){let w,P,H,J=!1;for(let ee=0;ee<_.length;ee++){w=_[ee];for(let ge=0,Te=w.length-1;ge<w.length;Te=ge++)P=w[ge],H=w[Te],P.y>h.y!=H.y>h.y&&h.x<(H.x-P.x)*(h.y-P.y)/(H.y-P.y)+P.x&&(J=!J)}return J}function Yc(_,h){let w=!1;for(let P=0,H=_.length-1;P<_.length;H=P++){const J=_[P],ee=_[H];J.y>h.y!=ee.y>h.y&&h.x<(ee.x-J.x)*(h.y-J.y)/(ee.y-J.y)+J.x&&(w=!w)}return w}function Sp(_,h,w){const P=w[0],H=w[2];if(_.x<P.x&&h.x<P.x||_.x>H.x&&h.x>H.x||_.y<P.y&&h.y<P.y||_.y>H.y&&h.y>H.y)return!1;const J=Ye(_,h,w[0]);return J!==Ye(_,h,w[1])||J!==Ye(_,h,w[2])||J!==Ye(_,h,w[3])}function Zh(_,h,w){const P=h.paint.get(_).value;return P.kind==="constant"?P.value:w.programConfigurations.get(h.id).getMaxValue(_)}function ff(_){return Math.sqrt(_[0]*_[0]+_[1]*_[1])}function Kc(_,h,w,P,H){if(!h[0]&&!h[1])return _;const J=oe.convert(h)._mult(H);w==="viewport"&&J._rotate(-P);const ee=[];for(let ge=0;ge<_.length;ge++)ee.push(_[ge].sub(J));return ee}let Ip,df;En("CircleBucket",du,{omit:["layers"]});var X0={get paint(){return df=df||new fa({"circle-radius":new Zn(Ot.paint_circle["circle-radius"]),"circle-color":new Zn(Ot.paint_circle["circle-color"]),"circle-blur":new Zn(Ot.paint_circle["circle-blur"]),"circle-opacity":new Zn(Ot.paint_circle["circle-opacity"]),"circle-translate":new gn(Ot.paint_circle["circle-translate"]),"circle-translate-anchor":new gn(Ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gn(Ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gn(Ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zn(Ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Zn(Ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zn(Ot.paint_circle["circle-stroke-opacity"])})},get layout(){return Ip=Ip||new fa({"circle-sort-key":new Zn(Ot.layout_circle["circle-sort-key"])})}},eu=1e-6,Ju=typeof Float32Array<"u"?Float32Array:Array;function Y0(_){return _[0]=1,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=1,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=1,_[11]=0,_[12]=0,_[13]=0,_[14]=0,_[15]=1,_}function xh(_,h,w){var P=h[0],H=h[1],J=h[2],ee=h[3],ge=h[4],Te=h[5],Ne=h[6],f=h[7],u=h[8],p=h[9],E=h[10],B=h[11],q=h[12],W=h[13],se=h[14],fe=h[15],ve=w[0],Be=w[1],He=w[2],it=w[3];return _[0]=ve*P+Be*ge+He*u+it*q,_[1]=ve*H+Be*Te+He*p+it*W,_[2]=ve*J+Be*Ne+He*E+it*se,_[3]=ve*ee+Be*f+He*B+it*fe,_[4]=(ve=w[4])*P+(Be=w[5])*ge+(He=w[6])*u+(it=w[7])*q,_[5]=ve*H+Be*Te+He*p+it*W,_[6]=ve*J+Be*Ne+He*E+it*se,_[7]=ve*ee+Be*f+He*B+it*fe,_[8]=(ve=w[8])*P+(Be=w[9])*ge+(He=w[10])*u+(it=w[11])*q,_[9]=ve*H+Be*Te+He*p+it*W,_[10]=ve*J+Be*Ne+He*E+it*se,_[11]=ve*ee+Be*f+He*B+it*fe,_[12]=(ve=w[12])*P+(Be=w[13])*ge+(He=w[14])*u+(it=w[15])*q,_[13]=ve*H+Be*Te+He*p+it*W,_[14]=ve*J+Be*Ne+He*E+it*se,_[15]=ve*ee+Be*f+He*B+it*fe,_}Math.hypot||(Math.hypot=function(){for(var _=0,h=arguments.length;h--;)_+=arguments[h]*arguments[h];return Math.sqrt(_)});var Jc,vA=xh;function pf(_,h,w){var P=h[0],H=h[1],J=h[2],ee=h[3];return _[0]=w[0]*P+w[4]*H+w[8]*J+w[12]*ee,_[1]=w[1]*P+w[5]*H+w[9]*J+w[13]*ee,_[2]=w[2]*P+w[6]*H+w[10]*J+w[14]*ee,_[3]=w[3]*P+w[7]*H+w[11]*J+w[15]*ee,_}Jc=new Ju(4),Ju!=Float32Array&&(Jc[0]=0,Jc[1]=0,Jc[2]=0,Jc[3]=0);class g0 extends Is{constructor(h){super(h,X0)}createBucket(h){return new du(h)}queryRadius(h){const w=h;return Zh("circle-radius",this,w)+Zh("circle-stroke-width",this,w)+ff(this.paint.get("circle-translate"))}queryIntersectsFeature(h,w,P,H,J,ee,ge,Te){const Ne=Kc(h,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),ee.angle,ge),f=this.paint.get("circle-radius").evaluate(w,P)+this.paint.get("circle-stroke-width").evaluate(w,P),u=this.paint.get("circle-pitch-alignment")==="map",p=u?Ne:function(B,q){return B.map(W=>xs(W,q))}(Ne,Te),E=u?f*ge:f;for(const B of H)for(const q of B){const W=u?q:xs(q,Te);let se=E;const fe=pf([],[q.x,q.y,0,1],Te);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=fe[3]/ee.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=ee.cameraToCenterDistance/fe[3]),qh(p,W,se))return!0}return!1}}function xs(_,h){const w=pf([],[_.x,_.y,0,1],h);return new oe(w[0]/w[3],w[1]/w[3])}class tu extends du{}let Qh;En("HeatmapBucket",tu,{omit:["layers"]});var Wh={get paint(){return Qh=Qh||new fa({"heatmap-radius":new Zn(Ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zn(Ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gn(Ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pu(Ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gn(Ot.paint_heatmap["heatmap-opacity"])})}};function mf(_,{width:h,height:w},P,H){if(H){if(H instanceof Uint8ClampedArray)H=new Uint8Array(H.buffer);else if(H.length!==h*w*P)throw new RangeError(`mismatched image size. expected: ${H.length} but got: ${h*w*P}`)}else H=new Uint8Array(h*w*P);return _.width=h,_.height=w,_.data=H,_}function xA(_,{width:h,height:w},P){if(h===_.width&&w===_.height)return;const H=mf({},{width:h,height:w},P);K0(_,H,{x:0,y:0},{x:0,y:0},{width:Math.min(_.width,h),height:Math.min(_.height,w)},P),_.width=h,_.height=w,_.data=H.data}function K0(_,h,w,P,H,J){if(H.width===0||H.height===0)return h;if(H.width>_.width||H.height>_.height||w.x>_.width-H.width||w.y>_.height-H.height)throw new RangeError("out of range source coordinates for image copy");if(H.width>h.width||H.height>h.height||P.x>h.width-H.width||P.y>h.height-H.height)throw new RangeError("out of range destination coordinates for image copy");const ee=_.data,ge=h.data;if(ee===ge)throw new Error("srcData equals dstData, so image is already copied");for(let Te=0;Te<H.height;Te++){const Ne=((w.y+Te)*_.width+w.x)*J,f=((P.y+Te)*h.width+P.x)*J;for(let u=0;u<H.width*J;u++)ge[f+u]=ee[Ne+u]}return h}class zl{constructor(h,w){mf(this,h,1,w)}resize(h){xA(this,h,1)}clone(){return new zl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,w,P,H,J){K0(h,w,P,H,J,1)}}class qu{constructor(h,w){mf(this,h,4,w)}resize(h){xA(this,h,4)}replace(h,w){w?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new qu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,w,P,H,J){K0(h,w,P,H,J,4)}}function bA(_){const h={},w=_.resolution||256,P=_.clips?_.clips.length:1,H=_.image||new qu({width:w,height:P});if(Math.log(w)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${w}`);const J=(ee,ge,Te)=>{h[_.evaluationKey]=Te;const Ne=_.expression.evaluate(h);H.data[ee+ge+0]=Math.floor(255*Ne.r/Ne.a),H.data[ee+ge+1]=Math.floor(255*Ne.g/Ne.a),H.data[ee+ge+2]=Math.floor(255*Ne.b/Ne.a),H.data[ee+ge+3]=Math.floor(255*Ne.a)};if(_.clips)for(let ee=0,ge=0;ee<P;++ee,ge+=4*w)for(let Te=0,Ne=0;Te<w;Te++,Ne+=4){const f=Te/(w-1),{start:u,end:p}=_.clips[ee];J(ge,Ne,u*(1-f)+p*f)}else for(let ee=0,ge=0;ee<w;ee++,ge+=4)J(0,ge,ee/(w-1));return H}En("AlphaImage",zl),En("RGBAImage",qu);class _0 extends Is{createBucket(h){return new tu(h)}constructor(h){super(h,Wh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=bA({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let y0;var Ep={get paint(){return y0=y0||new fa({"hillshade-illumination-direction":new gn(Ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gn(Ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gn(Ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gn(Ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gn(Ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gn(Ot.paint_hillshade["hillshade-accent-color"])})}};class Su extends Is{constructor(h){super(h,Ep)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const eh=Es([{name:"a_pos",components:2,type:"Int16"}],4),{members:gf}=eh;var bh={exports:{}};function Rl(_,h,w){w=w||2;var P,H,J,ee,ge,Te,Ne,f=h&&h.length,u=f?h[0]*w:_.length,p=v0(_,0,u,w,!0),E=[];if(!p||p.next===p.prev)return E;if(f&&(p=function(q,W,se,fe){var ve,Be,He,it=[];for(ve=0,Be=W.length;ve<Be;ve++)(He=v0(q,W[ve]*fe,ve<Be-1?W[ve+1]*fe:q.length,fe,!1))===He.next&&(He.steiner=!0),it.push(yf(He));for(it.sort(kc),ve=0;ve<it.length;ve++)se=_f(it[ve],se);return se}(_,h,p,w)),_.length>80*w){P=J=_[0],H=ee=_[1];for(var B=w;B<u;B+=w)(ge=_[B])<P&&(P=ge),(Te=_[B+1])<H&&(H=Te),ge>J&&(J=ge),Te>ee&&(ee=Te);Ne=(Ne=Math.max(J-P,ee-H))!==0?32767/Ne:0}return $h(p,E,w,P,H,Ne,0),E}function v0(_,h,w,P,H){var J,ee;if(H===Ac(_,h,w,P)>0)for(J=h;J<w;J+=P)ee=Xh(J,_[J],_[J+1],ee);else for(J=w-P;J>=h;J-=P)ee=Xh(J,_[J],_[J+1],ee);return ee&&vf(ee,ee.next)&&(wf(ee),ee=ee.next),ee}function th(_,h){if(!_)return _;h||(h=_);var w,P=_;do if(w=!1,P.steiner||!vf(P,P.next)&&Ro(P.prev,P,P.next)!==0)P=P.next;else{if(wf(P),(P=h=P.prev)===P.next)break;w=!0}while(w||P!==h);return h}function $h(_,h,w,P,H,J,ee){if(_){!ee&&J&&function(f,u,p,E){var B=f;do B.z===0&&(B.z=cc(B.x,B.y,u,p,E)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==f);B.prevZ.nextZ=null,B.prevZ=null,function(q){var W,se,fe,ve,Be,He,it,pt,vt=1;do{for(se=q,q=null,Be=null,He=0;se;){for(He++,fe=se,it=0,W=0;W<vt&&(it++,fe=fe.nextZ);W++);for(pt=vt;it>0||pt>0&&fe;)it!==0&&(pt===0||!fe||se.z<=fe.z)?(ve=se,se=se.nextZ,it--):(ve=fe,fe=fe.nextZ,pt--),Be?Be.nextZ=ve:q=ve,ve.prevZ=Be,Be=ve;se=fe}Be.nextZ=null,vt*=2}while(He>1)}(B)}(_,P,H,J);for(var ge,Te,Ne=_;_.prev!==_.next;)if(ge=_.prev,Te=_.next,J?ed(_,P,H,J):J0(_))h.push(ge.i/w|0),h.push(_.i/w|0),h.push(Te.i/w|0),wf(_),_=Te.next,Ne=Te.next;else if((_=Te)===Ne){ee?ee===1?$h(_=wh(th(_),h,w),h,w,P,H,J,2):ee===2&&Lm(_,h,w,P,H,J):$h(th(_),h,w,P,H,J,1);break}}}function J0(_){var h=_.prev,w=_,P=_.next;if(Ro(h,w,P)>=0)return!1;for(var H=h.x,J=w.x,ee=P.x,ge=h.y,Te=w.y,Ne=P.y,f=H<J?H<ee?H:ee:J<ee?J:ee,u=ge<Te?ge<Ne?ge:Ne:Te<Ne?Te:Ne,p=H>J?H>ee?H:ee:J>ee?J:ee,E=ge>Te?ge>Ne?ge:Ne:Te>Ne?Te:Ne,B=P.next;B!==h;){if(B.x>=f&&B.x<=p&&B.y>=u&&B.y<=E&&wA(H,ge,J,Te,ee,Ne,B.x,B.y)&&Ro(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function ed(_,h,w,P){var H=_.prev,J=_,ee=_.next;if(Ro(H,J,ee)>=0)return!1;for(var ge=H.x,Te=J.x,Ne=ee.x,f=H.y,u=J.y,p=ee.y,E=ge<Te?ge<Ne?ge:Ne:Te<Ne?Te:Ne,B=f<u?f<p?f:p:u<p?u:p,q=ge>Te?ge>Ne?ge:Ne:Te>Ne?Te:Ne,W=f>u?f>p?f:p:u>p?u:p,se=cc(E,B,h,w,P),fe=cc(q,W,h,w,P),ve=_.prevZ,Be=_.nextZ;ve&&ve.z>=se&&Be&&Be.z<=fe;){if(ve.x>=E&&ve.x<=q&&ve.y>=B&&ve.y<=W&&ve!==H&&ve!==ee&&wA(ge,f,Te,u,Ne,p,ve.x,ve.y)&&Ro(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Be.x>=E&&Be.x<=q&&Be.y>=B&&Be.y<=W&&Be!==H&&Be!==ee&&wA(ge,f,Te,u,Ne,p,Be.x,Be.y)&&Ro(Be.prev,Be,Be.next)>=0))return!1;Be=Be.nextZ}for(;ve&&ve.z>=se;){if(ve.x>=E&&ve.x<=q&&ve.y>=B&&ve.y<=W&&ve!==H&&ve!==ee&&wA(ge,f,Te,u,Ne,p,ve.x,ve.y)&&Ro(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Be&&Be.z<=fe;){if(Be.x>=E&&Be.x<=q&&Be.y>=B&&Be.y<=W&&Be!==H&&Be!==ee&&wA(ge,f,Te,u,Ne,p,Be.x,Be.y)&&Ro(Be.prev,Be,Be.next)>=0)return!1;Be=Be.nextZ}return!0}function wh(_,h,w){var P=_;do{var H=P.prev,J=P.next.next;!vf(H,J)&&Cp(H,P,P.next,J)&&bl(H,J)&&bl(J,H)&&(h.push(H.i/w|0),h.push(P.i/w|0),h.push(J.i/w|0),wf(P),wf(P.next),P=_=J),P=P.next}while(P!==_);return th(P)}function Lm(_,h,w,P,H,J){var ee=_;do{for(var ge=ee.next.next;ge!==ee.prev;){if(ee.i!==ge.i&&Bm(ee,ge)){var Te=hc(ee,ge);return ee=th(ee,ee.next),Te=th(Te,Te.next),$h(ee,h,w,P,H,J,0),void $h(Te,h,w,P,H,J,0)}ge=ge.next}ee=ee.next}while(ee!==_)}function kc(_,h){return _.x-h.x}function _f(_,h){var w=function(H,J){var ee,ge=J,Te=H.x,Ne=H.y,f=-1/0;do{if(Ne<=ge.y&&Ne>=ge.next.y&&ge.next.y!==ge.y){var u=ge.x+(Ne-ge.y)*(ge.next.x-ge.x)/(ge.next.y-ge.y);if(u<=Te&&u>f&&(f=u,ee=ge.x<ge.next.x?ge:ge.next,u===Te))return ee}ge=ge.next}while(ge!==J);if(!ee)return null;var p,E=ee,B=ee.x,q=ee.y,W=1/0;ge=ee;do Te>=ge.x&&ge.x>=B&&Te!==ge.x&&wA(Ne<q?Te:f,Ne,B,q,Ne<q?f:Te,Ne,ge.x,ge.y)&&(p=Math.abs(Ne-ge.y)/(Te-ge.x),bl(ge,H)&&(p<W||p===W&&(ge.x>ee.x||ge.x===ee.x&&td(ee,ge)))&&(ee=ge,W=p)),ge=ge.next;while(ge!==E);return ee}(_,h);if(!w)return h;var P=hc(w,_);return th(P,P.next),th(w,w.next)}function td(_,h){return Ro(_.prev,_,h.prev)<0&&Ro(h.next,_,_.next)<0}function cc(_,h,w,P,H){return(_=1431655765&((_=858993459&((_=252645135&((_=16711935&((_=(_-w)*H|0)|_<<8))|_<<4))|_<<2))|_<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-P)*H|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function yf(_){var h=_,w=_;do(h.x<w.x||h.x===w.x&&h.y<w.y)&&(w=h),h=h.next;while(h!==_);return w}function wA(_,h,w,P,H,J,ee,ge){return(H-ee)*(h-ge)>=(_-ee)*(J-ge)&&(_-ee)*(P-ge)>=(w-ee)*(h-ge)&&(w-ee)*(J-ge)>=(H-ee)*(P-ge)}function Bm(_,h){return _.next.i!==h.i&&_.prev.i!==h.i&&!function(w,P){var H=w;do{if(H.i!==w.i&&H.next.i!==w.i&&H.i!==P.i&&H.next.i!==P.i&&Cp(H,H.next,w,P))return!0;H=H.next}while(H!==w);return!1}(_,h)&&(bl(_,h)&&bl(h,_)&&function(w,P){var H=w,J=!1,ee=(w.x+P.x)/2,ge=(w.y+P.y)/2;do H.y>ge!=H.next.y>ge&&H.next.y!==H.y&&ee<(H.next.x-H.x)*(ge-H.y)/(H.next.y-H.y)+H.x&&(J=!J),H=H.next;while(H!==w);return J}(_,h)&&(Ro(_.prev,_,h.prev)||Ro(_,h.prev,h))||vf(_,h)&&Ro(_.prev,_,_.next)>0&&Ro(h.prev,h,h.next)>0)}function Ro(_,h,w){return(h.y-_.y)*(w.x-h.x)-(h.x-_.x)*(w.y-h.y)}function vf(_,h){return _.x===h.x&&_.y===h.y}function Cp(_,h,w,P){var H=bf(Ro(_,h,w)),J=bf(Ro(_,h,P)),ee=bf(Ro(w,P,_)),ge=bf(Ro(w,P,h));return H!==J&&ee!==ge||!(H!==0||!xf(_,w,h))||!(J!==0||!xf(_,P,h))||!(ee!==0||!xf(w,_,P))||!(ge!==0||!xf(w,h,P))}function xf(_,h,w){return h.x<=Math.max(_.x,w.x)&&h.x>=Math.min(_.x,w.x)&&h.y<=Math.max(_.y,w.y)&&h.y>=Math.min(_.y,w.y)}function bf(_){return _>0?1:_<0?-1:0}function bl(_,h){return Ro(_.prev,_,_.next)<0?Ro(_,h,_.next)>=0&&Ro(_,_.prev,h)>=0:Ro(_,h,_.prev)<0||Ro(_,_.next,h)<0}function hc(_,h){var w=new Ua(_.i,_.x,_.y),P=new Ua(h.i,h.x,h.y),H=_.next,J=h.prev;return _.next=h,h.prev=_,w.next=H,H.prev=w,P.next=w,w.prev=P,J.next=P,P.prev=J,P}function Xh(_,h,w,P){var H=new Ua(_,h,w);return P?(H.next=P.next,H.prev=P,P.next.prev=H,P.next=H):(H.prev=H,H.next=H),H}function wf(_){_.next.prev=_.prev,_.prev.next=_.next,_.prevZ&&(_.prevZ.nextZ=_.nextZ),_.nextZ&&(_.nextZ.prevZ=_.prevZ)}function Ua(_,h,w){this.i=_,this.x=h,this.y=w,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ac(_,h,w,P){for(var H=0,J=h,ee=w-P;J<w;J+=P)H+=(_[ee]-_[J])*(_[J+1]+_[ee+1]),ee=J;return H}bh.exports=Rl,bh.exports.default=Rl,Rl.deviation=function(_,h,w,P){var H=h&&h.length,J=Math.abs(Ac(_,0,H?h[0]*w:_.length,w));if(H)for(var ee=0,ge=h.length;ee<ge;ee++)J-=Math.abs(Ac(_,h[ee]*w,ee<ge-1?h[ee+1]*w:_.length,w));var Te=0;for(ee=0;ee<P.length;ee+=3){var Ne=P[ee]*w,f=P[ee+1]*w,u=P[ee+2]*w;Te+=Math.abs((_[Ne]-_[u])*(_[f+1]-_[Ne+1])-(_[Ne]-_[f])*(_[u+1]-_[Ne+1]))}return J===0&&Te===0?0:Math.abs((Te-J)/J)},Rl.flatten=function(_){for(var h=_[0][0].length,w={vertices:[],holes:[],dimensions:h},P=0,H=0;H<_.length;H++){for(var J=0;J<_[H].length;J++)for(var ee=0;ee<h;ee++)w.vertices.push(_[H][J][ee]);H>0&&w.holes.push(P+=_[H-1].length)}return w};var x0=N(bh.exports);function Sf(_,h,w,P,H){If(_,h,w||0,P||_.length-1,H||Yh)}function If(_,h,w,P,H){for(;P>w;){if(P-w>600){var J=P-w+1,ee=h-w+1,ge=Math.log(J),Te=.5*Math.exp(2*ge/3),Ne=.5*Math.sqrt(ge*Te*(J-Te)/J)*(ee-J/2<0?-1:1);If(_,h,Math.max(w,Math.floor(h-ee*Te/J+Ne)),Math.min(P,Math.floor(h+(J-ee)*Te/J+Ne)),H)}var f=_[h],u=w,p=P;for(Mc(_,w,h),H(_[P],f)>0&&Mc(_,w,P);u<p;){for(Mc(_,u,p),u++,p--;H(_[u],f)<0;)u++;for(;H(_[p],f)>0;)p--}H(_[w],f)===0?Mc(_,w,p):Mc(_,++p,P),p<=h&&(w=p+1),h<=p&&(P=p-1)}}function Mc(_,h,w){var P=_[h];_[h]=_[w],_[w]=P}function Yh(_,h){return _<h?-1:_>h?1:0}function Sh(_,h){const w=_.length;if(w<=1)return[_];const P=[];let H,J;for(let ee=0;ee<w;ee++){const ge=_t(_[ee]);ge!==0&&(_[ee].area=Math.abs(ge),J===void 0&&(J=ge<0),J===ge<0?(H&&P.push(H),H=[_[ee]]):H.push(_[ee]))}if(H&&P.push(H),h>1)for(let ee=0;ee<P.length;ee++)P[ee].length<=h||(Sf(P[ee],h,1,P[ee].length-1,Ef),P[ee]=P[ee].slice(0,h));return P}function Ef(_,h){return h.area-_.area}function SA(_,h,w){const P=w.patternDependencies;let H=!1;for(const J of h){const ee=J.paint.get(`${_}-pattern`);ee.isConstant()||(H=!0);const ge=ee.constantOr(null);ge&&(H=!0,P[ge.to]=!0,P[ge.from]=!0)}return H}function IA(_,h,w,P,H){const J=H.patternDependencies;for(const ee of h){const ge=ee.paint.get(`${_}-pattern`).value;if(ge.kind!=="constant"){let Te=ge.evaluate({zoom:P-1},w,{},H.availableImages),Ne=ge.evaluate({zoom:P},w,{},H.availableImages),f=ge.evaluate({zoom:P+1},w,{},H.availableImages);Te=Te&&Te.name?Te.name:Te,Ne=Ne&&Ne.name?Ne.name:Ne,f=f&&f.name?f.name:f,J[Te]=!0,J[Ne]=!0,J[f]=!0,w.patterns[ee.id]={min:Te,mid:Ne,max:f}}}return w}class Kh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(w=>w.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ke,this.indexArray=new Kt,this.indexArray2=new ii,this.programConfigurations=new Go(h.layers,h.zoom),this.segments=new $i,this.segments2=new $i,this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id)}populate(h,w,P){this.hasPattern=SA("fill",this.layers,w);const H=this.layers[0].layout.get("fill-sort-key"),J=!H.isConstant(),ee=[];for(const{feature:ge,id:Te,index:Ne,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=xl(ge,u);if(!this.layers[0]._featureFilter.filter(new ys(this.zoom),p,P))continue;const E=J?H.evaluate(p,{},P,w.availableImages):void 0,B={id:Te,properties:ge.properties,type:ge.type,sourceLayerIndex:f,index:Ne,geometry:u?p.geometry:nl(ge),patterns:{},sortKey:E};ee.push(B)}J&&ee.sort((ge,Te)=>ge.sortKey-Te.sortKey);for(const ge of ee){const{geometry:Te,index:Ne,sourceLayerIndex:f}=ge;if(this.hasPattern){const u=IA("fill",this.layers,ge,this.zoom,w);this.patternFeatures.push(u)}else this.addFeature(ge,Te,Ne,P,{});w.featureIndex.insert(h[Ne].feature,Te,Ne,f,this.index)}}update(h,w,P){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,w,this.stateDependentLayers,P)}addFeatures(h,w,P){for(const H of this.patternFeatures)this.addFeature(H,H.geometry,H.index,w,P)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,gf),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,w,P,H,J){for(const ee of Sh(w,500)){let ge=0;for(const E of ee)ge+=E.length;const Te=this.segments.prepareSegment(ge,this.layoutVertexArray,this.indexArray),Ne=Te.vertexLength,f=[],u=[];for(const E of ee){if(E.length===0)continue;E!==ee[0]&&u.push(f.length/2);const B=this.segments2.prepareSegment(E.length,this.layoutVertexArray,this.indexArray2),q=B.vertexLength;this.layoutVertexArray.emplaceBack(E[0].x,E[0].y),this.indexArray2.emplaceBack(q+E.length-1,q),f.push(E[0].x),f.push(E[0].y);for(let W=1;W<E.length;W++)this.layoutVertexArray.emplaceBack(E[W].x,E[W].y),this.indexArray2.emplaceBack(q+W-1,q+W),f.push(E[W].x),f.push(E[W].y);B.vertexLength+=E.length,B.primitiveLength+=E.length}const p=x0(f,u);for(let E=0;E<p.length;E+=3)this.indexArray.emplaceBack(Ne+p[E],Ne+p[E+1],Ne+p[E+2]);Te.vertexLength+=ge,Te.primitiveLength+=p.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,P,J,H)}}let id,EA;En("FillBucket",Kh,{omit:["layers","patternFeatures"]});var Jh={get paint(){return EA=EA||new fa({"fill-antialias":new gn(Ot.paint_fill["fill-antialias"]),"fill-opacity":new Zn(Ot.paint_fill["fill-opacity"]),"fill-color":new Zn(Ot.paint_fill["fill-color"]),"fill-outline-color":new Zn(Ot.paint_fill["fill-outline-color"]),"fill-translate":new gn(Ot.paint_fill["fill-translate"]),"fill-translate-anchor":new gn(Ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new ir(Ot.paint_fill["fill-pattern"])})},get layout(){return id=id||new fa({"fill-sort-key":new Zn(Ot.layout_fill["fill-sort-key"])})}};class b0 extends Is{constructor(h){super(h,Jh)}recalculate(h,w){super.recalculate(h,w);const P=this.paint._values["fill-outline-color"];P.value.kind==="constant"&&P.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new Kh(h)}queryRadius(){return ff(this.paint.get("fill-translate"))}queryIntersectsFeature(h,w,P,H,J,ee,ge){return Va(Kc(h,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),ee.angle,ge),H)}isTileClipped(){return!0}}const nd=Es([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Tp=Es([{name:"a_centroid",components:2,type:"Int16"}],4),{members:CA}=nd;var fc={},Cf=$,rd=Ih;function Ih(_,h,w,P,H){this.properties={},this.extent=w,this.type=0,this._pbf=_,this._geometry=-1,this._keys=P,this._values=H,_.readFields(ih,this,h)}function ih(_,h,w){_==1?h.id=w.readVarint():_==2?function(P,H){for(var J=P.readVarint()+P.pos;P.pos<J;){var ee=H._keys[P.readVarint()],ge=H._values[P.readVarint()];H.properties[ee]=ge}}(w,h):_==3?h.type=w.readVarint():_==4&&(h._geometry=w.pos)}function kp(_){for(var h,w,P=0,H=0,J=_.length,ee=J-1;H<J;ee=H++)P+=((w=_[ee]).x-(h=_[H]).x)*(h.y+w.y);return P}Ih.types=["Unknown","Point","LineString","Polygon"],Ih.prototype.loadGeometry=function(){var _=this._pbf;_.pos=this._geometry;for(var h,w=_.readVarint()+_.pos,P=1,H=0,J=0,ee=0,ge=[];_.pos<w;){if(H<=0){var Te=_.readVarint();P=7&Te,H=Te>>3}if(H--,P===1||P===2)J+=_.readSVarint(),ee+=_.readSVarint(),P===1&&(h&&ge.push(h),h=[]),h.push(new Cf(J,ee));else{if(P!==7)throw new Error("unknown command "+P);h&&h.push(h[0].clone())}}return h&&ge.push(h),ge},Ih.prototype.bbox=function(){var _=this._pbf;_.pos=this._geometry;for(var h=_.readVarint()+_.pos,w=1,P=0,H=0,J=0,ee=1/0,ge=-1/0,Te=1/0,Ne=-1/0;_.pos<h;){if(P<=0){var f=_.readVarint();w=7&f,P=f>>3}if(P--,w===1||w===2)(H+=_.readSVarint())<ee&&(ee=H),H>ge&&(ge=H),(J+=_.readSVarint())<Te&&(Te=J),J>Ne&&(Ne=J);else if(w!==7)throw new Error("unknown command "+w)}return[ee,Te,ge,Ne]},Ih.prototype.toGeoJSON=function(_,h,w){var P,H,J=this.extent*Math.pow(2,w),ee=this.extent*_,ge=this.extent*h,Te=this.loadGeometry(),Ne=Ih.types[this.type];function f(E){for(var B=0;B<E.length;B++){var q=E[B];E[B]=[360*(q.x+ee)/J-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+ge)/J)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(P=0;P<Te.length;P++)u[P]=Te[P][0];f(Te=u);break;case 2:for(P=0;P<Te.length;P++)f(Te[P]);break;case 3:for(Te=function(E){var B=E.length;if(B<=1)return[E];for(var q,W,se=[],fe=0;fe<B;fe++){var ve=kp(E[fe]);ve!==0&&(W===void 0&&(W=ve<0),W===ve<0?(q&&se.push(q),q=[E[fe]]):q.push(E[fe]))}return q&&se.push(q),se}(Te),P=0;P<Te.length;P++)for(H=0;H<Te[P].length;H++)f(Te[P][H])}Te.length===1?Te=Te[0]:Ne="Multi"+Ne;var p={type:"Feature",geometry:{type:Ne,coordinates:Te},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Mp=rd,Pp=sd;function sd(_,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=_,this._keys=[],this._values=[],this._features=[],_.readFields(Eh,this,h),this.length=this._features.length}function Eh(_,h,w){_===15?h.version=w.readVarint():_===1?h.name=w.readString():_===5?h.extent=w.readVarint():_===2?h._features.push(w.pos):_===3?h._keys.push(w.readString()):_===4&&h._values.push(function(P){for(var H=null,J=P.readVarint()+P.pos;P.pos<J;){var ee=P.readVarint()>>3;H=ee===1?P.readString():ee===2?P.readFloat():ee===3?P.readDouble():ee===4?P.readVarint64():ee===5?P.readVarint():ee===6?P.readSVarint():ee===7?P.readBoolean():null}return H}(w))}sd.prototype.feature=function(_){if(_<0||_>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[_];var h=this._pbf.readVarint()+this._pbf.pos;return new Mp(this._pbf,h,this.extent,this._keys,this._values)};var zm=Pp;function Pc(_,h,w){if(_===3){var P=new zm(w,w.readVarint()+w.pos);P.length&&(h[P.name]=P)}}fc.VectorTile=function(_,h){this.layers=_.readFields(Pc,{},h)},fc.VectorTileFeature=rd,fc.VectorTileLayer=Pp;const Ch=fc.VectorTileFeature.types,Tf=Math.pow(2,13);function eA(_,h,w,P,H,J,ee,ge){_.emplaceBack(h,w,2*Math.floor(P*Tf)+ee,H*Tf*2,J*Tf*2,Math.round(ge))}class TA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(w=>w.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Fe,this.centroidVertexArray=new Ae,this.indexArray=new Kt,this.programConfigurations=new Go(h.layers,h.zoom),this.segments=new $i,this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id)}populate(h,w,P){this.features=[],this.hasPattern=SA("fill-extrusion",this.layers,w);for(const{feature:H,id:J,index:ee,sourceLayerIndex:ge}of h){const Te=this.layers[0]._featureFilter.needGeometry,Ne=xl(H,Te);if(!this.layers[0]._featureFilter.filter(new ys(this.zoom),Ne,P))continue;const f={id:J,sourceLayerIndex:ge,index:ee,geometry:Te?Ne.geometry:nl(H),properties:H.properties,type:H.type,patterns:{}};this.hasPattern?this.features.push(IA("fill-extrusion",this.layers,f,this.zoom,w)):this.addFeature(f,f.geometry,ee,P,{}),w.featureIndex.insert(H,f.geometry,ee,ge,this.index,!0)}}addFeatures(h,w,P){for(const H of this.features){const{geometry:J}=H;this.addFeature(H,J,H.index,w,P)}}update(h,w,P){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,w,this.stateDependentLayers,P)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,CA),this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,Tp.members,!0),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(h,w,P,H,J){const ee={x:0,y:0,vertexCount:0};for(const ge of Sh(w,500)){let Te=0;for(const B of ge)Te+=B.length;let Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const B of ge){if(B.length===0||Dr(B))continue;let q=0;for(let W=0;W<B.length;W++){const se=B[W];if(W>=1){const fe=B[W-1];if(!tA(se,fe)){Ne.vertexLength+4>$i.MAX_VERTEX_ARRAY_LENGTH&&(Ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ve=se.sub(fe)._perp()._unit(),Be=fe.dist(se);q+Be>32768&&(q=0),eA(this.layoutVertexArray,se.x,se.y,ve.x,ve.y,0,0,q),eA(this.layoutVertexArray,se.x,se.y,ve.x,ve.y,0,1,q),ee.x+=2*se.x,ee.y+=2*se.y,ee.vertexCount+=2,q+=Be,eA(this.layoutVertexArray,fe.x,fe.y,ve.x,ve.y,0,0,q),eA(this.layoutVertexArray,fe.x,fe.y,ve.x,ve.y,0,1,q),ee.x+=2*fe.x,ee.y+=2*fe.y,ee.vertexCount+=2;const He=Ne.vertexLength;this.indexArray.emplaceBack(He,He+2,He+1),this.indexArray.emplaceBack(He+1,He+2,He+3),Ne.vertexLength+=4,Ne.primitiveLength+=2}}}}if(Ne.vertexLength+Te>$i.MAX_VERTEX_ARRAY_LENGTH&&(Ne=this.segments.prepareSegment(Te,this.layoutVertexArray,this.indexArray)),Ch[h.type]!=="Polygon")continue;const f=[],u=[],p=Ne.vertexLength;for(const B of ge)if(B.length!==0){B!==ge[0]&&u.push(f.length/2);for(let q=0;q<B.length;q++){const W=B[q];eA(this.layoutVertexArray,W.x,W.y,0,0,1,1,0),ee.x+=W.x,ee.y+=W.y,ee.vertexCount+=1,f.push(W.x),f.push(W.y)}}const E=x0(f,u);for(let B=0;B<E.length;B+=3)this.indexArray.emplaceBack(p+E[B],p+E[B+2],p+E[B+1]);Ne.primitiveLength+=E.length/3,Ne.vertexLength+=Te}for(let ge=0;ge<ee.vertexCount;ge++)this.centroidVertexArray.emplaceBack(Math.floor(ee.x/ee.vertexCount),Math.floor(ee.y/ee.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,P,J,H)}}function tA(_,h){return _.x===h.x&&(_.x<0||_.x>ea)||_.y===h.y&&(_.y<0||_.y>ea)}function Dr(_){return _.every(h=>h.x<0)||_.every(h=>h.x>ea)||_.every(h=>h.y<0)||_.every(h=>h.y>ea)}let kf;En("FillExtrusionBucket",TA,{omit:["layers","features"]});var ad={get paint(){return kf=kf||new fa({"fill-extrusion-opacity":new gn(Ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Zn(Ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gn(Ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gn(Ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ir(Ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Zn(Ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zn(Ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gn(Ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class iA extends Is{constructor(h){super(h,ad)}createBucket(h){return new TA(h)}queryRadius(){return ff(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(h,w,P,H,J,ee,ge,Te){const Ne=Kc(h,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),ee.angle,ge),f=this.paint.get("fill-extrusion-height").evaluate(w,P),u=this.paint.get("fill-extrusion-base").evaluate(w,P),p=function(B,q,W,se){const fe=[];for(const ve of B){const Be=[ve.x,ve.y,0,1];pf(Be,Be,q),fe.push(new oe(Be[0]/Be[3],Be[1]/Be[3]))}return fe}(Ne,Te),E=function(B,q,W,se){const fe=[],ve=[],Be=se[8]*q,He=se[9]*q,it=se[10]*q,pt=se[11]*q,vt=se[8]*W,Dt=se[9]*W,Lt=se[10]*W,Rt=se[11]*W;for(const ei of B){const Zt=[],Wt=[];for(const hi of ei){const vi=hi.x,Ji=hi.y,In=se[0]*vi+se[4]*Ji+se[12],un=se[1]*vi+se[5]*Ji+se[13],ln=se[2]*vi+se[6]*Ji+se[14],dn=se[3]*vi+se[7]*Ji+se[15],Vn=ln+it,on=dn+pt,Ki=In+vt,Fn=un+Dt,Un=ln+Lt,gr=dn+Rt,jr=new oe((In+Be)/on,(un+He)/on);jr.z=Vn/on,Zt.push(jr);const Xr=new oe(Ki/gr,Fn/gr);Xr.z=Un/gr,Wt.push(Xr)}fe.push(Zt),ve.push(Wt)}return[fe,ve]}(H,u,f,Te);return function(B,q,W){let se=1/0;Va(W,q)&&(se=kA(W,q[0]));for(let fe=0;fe<q.length;fe++){const ve=q[fe],Be=B[fe];for(let He=0;He<ve.length-1;He++){const it=ve[He],pt=[it,ve[He+1],Be[He+1],Be[He],it];Af(W,pt)&&(se=Math.min(se,kA(W,pt)))}}return se!==1/0&&se}(E[0],E[1],p)}}function Mf(_,h){return _.x*h.x+_.y*h.y}function kA(_,h){if(_.length===1){let w=0;const P=h[w++];let H;for(;!H||P.equals(H);)if(H=h[w++],!H)return 1/0;for(;w<h.length;w++){const J=h[w],ee=_[0],ge=H.sub(P),Te=J.sub(P),Ne=ee.sub(P),f=Mf(ge,ge),u=Mf(ge,Te),p=Mf(Te,Te),E=Mf(Ne,ge),B=Mf(Ne,Te),q=f*p-u*u,W=(p*E-u*B)/q,se=(f*B-u*E)/q,fe=P.z*(1-W-se)+H.z*W+J.z*se;if(isFinite(fe))return fe}return 1/0}{let w=1/0;for(const P of h)w=Math.min(w,P.z);return w}}const MA=Es([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Hl}=MA,Rm=Es([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Fm}=Rm,od=fc.VectorTileFeature.types,Om=Math.cos(Math.PI/180*37.5),ld=Math.pow(2,14)/.5;class nA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(w=>w.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(w=>{this.gradients[w.id]={}}),this.layoutVertexArray=new ze,this.layoutVertexArray2=new tt,this.indexArray=new Kt,this.programConfigurations=new Go(h.layers,h.zoom),this.segments=new $i,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id)}populate(h,w,P){this.hasPattern=SA("line",this.layers,w);const H=this.layers[0].layout.get("line-sort-key"),J=!H.isConstant(),ee=[];for(const{feature:ge,id:Te,index:Ne,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=xl(ge,u);if(!this.layers[0]._featureFilter.filter(new ys(this.zoom),p,P))continue;const E=J?H.evaluate(p,{},P):void 0,B={id:Te,properties:ge.properties,type:ge.type,sourceLayerIndex:f,index:Ne,geometry:u?p.geometry:nl(ge),patterns:{},sortKey:E};ee.push(B)}J&&ee.sort((ge,Te)=>ge.sortKey-Te.sortKey);for(const ge of ee){const{geometry:Te,index:Ne,sourceLayerIndex:f}=ge;if(this.hasPattern){const u=IA("line",this.layers,ge,this.zoom,w);this.patternFeatures.push(u)}else this.addFeature(ge,Te,Ne,P,{});w.featureIndex.insert(h[Ne].feature,Te,Ne,f,this.index)}}update(h,w,P){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,w,this.stateDependentLayers,P)}addFeatures(h,w,P){for(const H of this.patternFeatures)this.addFeature(H,H.geometry,H.index,w,P)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,Fm)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Hl),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,w,P,H,J){const ee=this.layers[0].layout,ge=ee.get("line-join").evaluate(h,{}),Te=ee.get("line-cap"),Ne=ee.get("line-miter-limit"),f=ee.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const u of w)this.addLine(u,h,ge,Te,Ne,f);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,P,J,H)}addLine(h,w,P,H,J,ee){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<h.length-1;se++)this.totalDistance+=h[se].dist(h[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const ge=od[w.type]==="Polygon";let Te=h.length;for(;Te>=2&&h[Te-1].equals(h[Te-2]);)Te--;let Ne=0;for(;Ne<Te-1&&h[Ne].equals(h[Ne+1]);)Ne++;if(Te<(ge?3:2))return;P==="bevel"&&(J=1.05);const f=this.overscaling<=16?15*ea/(512*this.overscaling):0,u=this.segments.prepareSegment(10*Te,this.layoutVertexArray,this.indexArray);let p,E,B,q,W;this.e1=this.e2=-1,ge&&(p=h[Te-2],W=h[Ne].sub(p)._unit()._perp());for(let se=Ne;se<Te;se++){if(B=se===Te-1?ge?h[Ne+1]:void 0:h[se+1],B&&h[se].equals(B))continue;W&&(q=W),p&&(E=p),p=h[se],W=B?B.sub(p)._unit()._perp():q,q=q||W;let fe=q.add(W);fe.x===0&&fe.y===0||fe._unit();const ve=q.x*W.x+q.y*W.y,Be=fe.x*W.x+fe.y*W.y,He=Be!==0?1/Be:1/0,it=2*Math.sqrt(2-2*Be),pt=Be<Om&&E&&B,vt=q.x*W.y-q.y*W.x>0;if(pt&&se>Ne){const Rt=p.dist(E);if(Rt>2*f){const ei=p.sub(p.sub(E)._mult(f/Rt)._round());this.updateDistance(E,ei),this.addCurrentVertex(ei,q,0,0,u),E=ei}}const Dt=E&&B;let Lt=Dt?P:ge?"butt":H;if(Dt&&Lt==="round"&&(He<ee?Lt="miter":He<=2&&(Lt="fakeround")),Lt==="miter"&&He>J&&(Lt="bevel"),Lt==="bevel"&&(He>2&&(Lt="flipbevel"),He<J&&(Lt="miter")),E&&this.updateDistance(E,p),Lt==="miter")fe._mult(He),this.addCurrentVertex(p,fe,0,0,u);else if(Lt==="flipbevel"){if(He>100)fe=W.mult(-1);else{const Rt=He*q.add(W).mag()/q.sub(W).mag();fe._perp()._mult(Rt*(vt?-1:1))}this.addCurrentVertex(p,fe,0,0,u),this.addCurrentVertex(p,fe.mult(-1),0,0,u)}else if(Lt==="bevel"||Lt==="fakeround"){const Rt=-Math.sqrt(He*He-1),ei=vt?Rt:0,Zt=vt?0:Rt;if(E&&this.addCurrentVertex(p,q,ei,Zt,u),Lt==="fakeround"){const Wt=Math.round(180*it/Math.PI/20);for(let hi=1;hi<Wt;hi++){let vi=hi/Wt;if(vi!==.5){const In=vi-.5;vi+=vi*In*(vi-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*In*In+(.848013+ve*(.215638*ve-1.06021)))}const Ji=W.sub(q)._mult(vi)._add(q)._unit()._mult(vt?-1:1);this.addHalfVertex(p,Ji.x,Ji.y,!1,vt,0,u)}}B&&this.addCurrentVertex(p,W,-ei,-Zt,u)}else if(Lt==="butt")this.addCurrentVertex(p,fe,0,0,u);else if(Lt==="square"){const Rt=E?1:-1;this.addCurrentVertex(p,fe,Rt,Rt,u)}else Lt==="round"&&(E&&(this.addCurrentVertex(p,q,0,0,u),this.addCurrentVertex(p,q,1,1,u,!0)),B&&(this.addCurrentVertex(p,W,-1,-1,u,!0),this.addCurrentVertex(p,W,0,0,u)));if(pt&&se<Te-1){const Rt=p.dist(B);if(Rt>2*f){const ei=p.add(B.sub(p)._mult(f/Rt)._round());this.updateDistance(p,ei),this.addCurrentVertex(ei,W,0,0,u),p=ei}}}}addCurrentVertex(h,w,P,H,J,ee=!1){const ge=w.y*H-w.x,Te=-w.y-w.x*H;this.addHalfVertex(h,w.x+w.y*P,w.y-w.x*P,ee,!1,P,J),this.addHalfVertex(h,ge,Te,ee,!0,-H,J),this.distance>ld/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(h,w,P,H,J,ee))}addHalfVertex({x:h,y:w},P,H,J,ee,ge,Te){const Ne=.5*(this.lineClips?this.scaledDistance*(ld-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h<<1)+(J?1:0),(w<<1)+(ee?1:0),Math.round(63*P)+128,Math.round(63*H)+128,1+(ge===0?0:ge<0?-1:1)|(63&Ne)<<2,Ne>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const f=Te.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,f),Te.primitiveLength++),ee?this.e2=f:this.e1=f}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(h,w){this.distance+=h.dist(w),this.updateScaledDistance()}}let ud,Dp;En("LineBucket",nA,{omit:["layers","patternFeatures"]});var Dc={get paint(){return Dp=Dp||new fa({"line-opacity":new Zn(Ot.paint_line["line-opacity"]),"line-color":new Zn(Ot.paint_line["line-color"]),"line-translate":new gn(Ot.paint_line["line-translate"]),"line-translate-anchor":new gn(Ot.paint_line["line-translate-anchor"]),"line-width":new Zn(Ot.paint_line["line-width"]),"line-gap-width":new Zn(Ot.paint_line["line-gap-width"]),"line-offset":new Zn(Ot.paint_line["line-offset"]),"line-blur":new Zn(Ot.paint_line["line-blur"]),"line-dasharray":new il(Ot.paint_line["line-dasharray"]),"line-pattern":new ir(Ot.paint_line["line-pattern"]),"line-gradient":new Pu(Ot.paint_line["line-gradient"])})},get layout(){return ud=ud||new fa({"line-cap":new gn(Ot.layout_line["line-cap"]),"line-join":new Zn(Ot.layout_line["line-join"]),"line-miter-limit":new gn(Ot.layout_line["line-miter-limit"]),"line-round-limit":new gn(Ot.layout_line["line-round-limit"]),"line-sort-key":new Zn(Ot.layout_line["line-sort-key"])})}};class Iu extends Zn{possiblyEvaluate(h,w){return w=new ys(Math.floor(w.zoom),{now:w.now,fadeDuration:w.fadeDuration,zoomHistory:w.zoomHistory,transition:w.transition}),super.possiblyEvaluate(h,w)}evaluate(h,w,P,H){return w=$t({},w,{zoom:Math.floor(w.zoom)}),super.evaluate(h,w,P,H)}}let PA;class Nm extends Is{constructor(h){super(h,Dc),this.gradientVersion=0,PA||(PA=new Iu(Dc.paint.properties["line-width"].specification),PA.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const w=this.gradientExpression();this.stepInterpolant=!!function(P){return P._styleExpression!==void 0}(w)&&w._styleExpression.expression instanceof Ka,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,w){super.recalculate(h,w),this.paint._values["line-floorwidth"]=PA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new nA(h)}queryRadius(h){const w=h,P=w0(Zh("line-width",this,w),Zh("line-gap-width",this,w)),H=Zh("line-offset",this,w);return P/2+Math.abs(H)+ff(this.paint.get("line-translate"))}queryIntersectsFeature(h,w,P,H,J,ee,ge){const Te=Kc(h,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),ee.angle,ge),Ne=ge/2*w0(this.paint.get("line-width").evaluate(w,P),this.paint.get("line-gap-width").evaluate(w,P)),f=this.paint.get("line-offset").evaluate(w,P);return f&&(H=function(u,p){const E=[];for(let B=0;B<u.length;B++){const q=u[B],W=[];for(let se=0;se<q.length;se++){const fe=q[se-1],ve=q[se],Be=q[se+1],He=se===0?new oe(0,0):ve.sub(fe)._unit()._perp(),it=se===q.length-1?new oe(0,0):Be.sub(ve)._unit()._perp(),pt=He._add(it)._unit(),vt=pt.x*it.x+pt.y*it.y;vt!==0&&pt._mult(1/vt),W.push(pt._mult(p)._add(ve))}E.push(W)}return E}(H,f*ge)),function(u,p,E){for(let B=0;B<p.length;B++){const q=p[B];if(u.length>=3){for(let W=0;W<q.length;W++)if(Yc(u,q[W]))return!0}if(yA(u,q,E))return!0}return!1}(Te,H,Ne)}isTileClipped(){return!0}}function w0(_,h){return h>0?h+2*_:_}const Lp=Es([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cd=Es([{name:"a_projected_pos",components:3,type:"Float32"}],4);Es([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const DA=Es([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Es([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const S0=Es([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),hd=Es([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vm(_,h,w){return _.sections.forEach(P=>{P.text=function(H,J,ee){const ge=J.layout.get("text-transform").evaluate(ee,{});return ge==="uppercase"?H=H.toLocaleUpperCase():ge==="lowercase"&&(H=H.toLocaleLowerCase()),Kl.applyArabicShaping&&(H=Kl.applyArabicShaping(H)),H}(P.text,h,w)}),_}Es([{name:"triangle",components:3,type:"Uint16"}]),Es([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Es([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Es([{type:"Float32",name:"offsetX"}]),Es([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Es([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Th={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var fl=24,Ad=ya,fd=function(_,h,w,P,H){var J,ee,ge=8*H-P-1,Te=(1<<ge)-1,Ne=Te>>1,f=-7,u=w?H-1:0,p=w?-1:1,E=_[h+u];for(u+=p,J=E&(1<<-f)-1,E>>=-f,f+=ge;f>0;J=256*J+_[h+u],u+=p,f-=8);for(ee=J&(1<<-f)-1,J>>=-f,f+=P;f>0;ee=256*ee+_[h+u],u+=p,f-=8);if(J===0)J=1-Ne;else{if(J===Te)return ee?NaN:1/0*(E?-1:1);ee+=Math.pow(2,P),J-=Ne}return(E?-1:1)*ee*Math.pow(2,J-P)},dd=function(_,h,w,P,H,J){var ee,ge,Te,Ne=8*J-H-1,f=(1<<Ne)-1,u=f>>1,p=H===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=P?0:J-1,B=P?1:-1,q=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(ge=isNaN(h)?1:0,ee=f):(ee=Math.floor(Math.log(h)/Math.LN2),h*(Te=Math.pow(2,-ee))<1&&(ee--,Te*=2),(h+=ee+u>=1?p/Te:p*Math.pow(2,1-u))*Te>=2&&(ee++,Te/=2),ee+u>=f?(ge=0,ee=f):ee+u>=1?(ge=(h*Te-1)*Math.pow(2,H),ee+=u):(ge=h*Math.pow(2,u-1)*Math.pow(2,H),ee=0));H>=8;_[w+E]=255&ge,E+=B,ge/=256,H-=8);for(ee=ee<<H|ge,Ne+=H;Ne>0;_[w+E]=255&ee,E+=B,ee/=256,Ne-=8);_[w+E-B]|=128*q};function ya(_){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(_)?_:new Uint8Array(_||0),this.pos=0,this.type=0,this.length=this.buf.length}ya.Varint=0,ya.Fixed64=1,ya.Bytes=2,ya.Fixed32=5;var LA=4294967296,pd=1/LA,BA=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Eu(_){return _.type===ya.Bytes?_.readVarint()+_.pos:_.pos+1}function so(_,h,w){return w?4294967296*h+(_>>>0):4294967296*(h>>>0)+(_>>>0)}function I0(_,h,w){var P=h<=16383?1:h<=2097151?2:h<=268435455?3:Math.floor(Math.log(h)/(7*Math.LN2));w.realloc(P);for(var H=w.pos-1;H>=_;H--)w.buf[H+P]=w.buf[H]}function Pf(_,h){for(var w=0;w<_.length;w++)h.writeVarint(_[w])}function md(_,h){for(var w=0;w<_.length;w++)h.writeSVarint(_[w])}function bs(_,h){for(var w=0;w<_.length;w++)h.writeFloat(_[w])}function nh(_,h){for(var w=0;w<_.length;w++)h.writeDouble(_[w])}function Bp(_,h){for(var w=0;w<_.length;w++)h.writeBoolean(_[w])}function gd(_,h){for(var w=0;w<_.length;w++)h.writeFixed32(_[w])}function rh(_,h){for(var w=0;w<_.length;w++)h.writeSFixed32(_[w])}function zA(_,h){for(var w=0;w<_.length;w++)h.writeFixed64(_[w])}function zp(_,h){for(var w=0;w<_.length;w++)h.writeSFixed64(_[w])}function E0(_,h){return(_[h]|_[h+1]<<8|_[h+2]<<16)+16777216*_[h+3]}function RA(_,h,w){_[w]=h,_[w+1]=h>>>8,_[w+2]=h>>>16,_[w+3]=h>>>24}function Rp(_,h){return(_[h]|_[h+1]<<8|_[h+2]<<16)+(_[h+3]<<24)}ya.prototype={destroy:function(){this.buf=null},readFields:function(_,h,w){for(w=w||this.length;this.pos<w;){var P=this.readVarint(),H=P>>3,J=this.pos;this.type=7&P,_(H,h,this),this.pos===J&&this.skip(P)}return h},readMessage:function(_,h){return this.readFields(_,h,this.readVarint()+this.pos)},readFixed32:function(){var _=E0(this.buf,this.pos);return this.pos+=4,_},readSFixed32:function(){var _=Rp(this.buf,this.pos);return this.pos+=4,_},readFixed64:function(){var _=E0(this.buf,this.pos)+E0(this.buf,this.pos+4)*LA;return this.pos+=8,_},readSFixed64:function(){var _=E0(this.buf,this.pos)+Rp(this.buf,this.pos+4)*LA;return this.pos+=8,_},readFloat:function(){var _=fd(this.buf,this.pos,!0,23,4);return this.pos+=4,_},readDouble:function(){var _=fd(this.buf,this.pos,!0,52,8);return this.pos+=8,_},readVarint:function(_){var h,w,P=this.buf;return h=127&(w=P[this.pos++]),w<128?h:(h|=(127&(w=P[this.pos++]))<<7,w<128?h:(h|=(127&(w=P[this.pos++]))<<14,w<128?h:(h|=(127&(w=P[this.pos++]))<<21,w<128?h:function(H,J,ee){var ge,Te,Ne=ee.buf;if(ge=(112&(Te=Ne[ee.pos++]))>>4,Te<128||(ge|=(127&(Te=Ne[ee.pos++]))<<3,Te<128)||(ge|=(127&(Te=Ne[ee.pos++]))<<10,Te<128)||(ge|=(127&(Te=Ne[ee.pos++]))<<17,Te<128)||(ge|=(127&(Te=Ne[ee.pos++]))<<24,Te<128)||(ge|=(1&(Te=Ne[ee.pos++]))<<31,Te<128))return so(H,ge,J);throw new Error("Expected varint not more than 10 bytes")}(h|=(15&(w=P[this.pos]))<<28,_,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var _=this.readVarint();return _%2==1?(_+1)/-2:_/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var _=this.readVarint()+this.pos,h=this.pos;return this.pos=_,_-h>=12&&BA?function(w,P,H){return BA.decode(w.subarray(P,H))}(this.buf,h,_):function(w,P,H){for(var J="",ee=P;ee<H;){var ge,Te,Ne,f=w[ee],u=null,p=f>239?4:f>223?3:f>191?2:1;if(ee+p>H)break;p===1?f<128&&(u=f):p===2?(192&(ge=w[ee+1]))==128&&(u=(31&f)<<6|63&ge)<=127&&(u=null):p===3?(Te=w[ee+2],(192&(ge=w[ee+1]))==128&&(192&Te)==128&&((u=(15&f)<<12|(63&ge)<<6|63&Te)<=2047||u>=55296&&u<=57343)&&(u=null)):p===4&&(Te=w[ee+2],Ne=w[ee+3],(192&(ge=w[ee+1]))==128&&(192&Te)==128&&(192&Ne)==128&&((u=(15&f)<<18|(63&ge)<<12|(63&Te)<<6|63&Ne)<=65535||u>=1114112)&&(u=null)),u===null?(u=65533,p=1):u>65535&&(u-=65536,J+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),J+=String.fromCharCode(u),ee+=p}return J}(this.buf,h,_)},readBytes:function(){var _=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,_);return this.pos=_,h},readPackedVarint:function(_,h){if(this.type!==ya.Bytes)return _.push(this.readVarint(h));var w=Eu(this);for(_=_||[];this.pos<w;)_.push(this.readVarint(h));return _},readPackedSVarint:function(_){if(this.type!==ya.Bytes)return _.push(this.readSVarint());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readSVarint());return _},readPackedBoolean:function(_){if(this.type!==ya.Bytes)return _.push(this.readBoolean());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readBoolean());return _},readPackedFloat:function(_){if(this.type!==ya.Bytes)return _.push(this.readFloat());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readFloat());return _},readPackedDouble:function(_){if(this.type!==ya.Bytes)return _.push(this.readDouble());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readDouble());return _},readPackedFixed32:function(_){if(this.type!==ya.Bytes)return _.push(this.readFixed32());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readFixed32());return _},readPackedSFixed32:function(_){if(this.type!==ya.Bytes)return _.push(this.readSFixed32());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readSFixed32());return _},readPackedFixed64:function(_){if(this.type!==ya.Bytes)return _.push(this.readFixed64());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readFixed64());return _},readPackedSFixed64:function(_){if(this.type!==ya.Bytes)return _.push(this.readSFixed64());var h=Eu(this);for(_=_||[];this.pos<h;)_.push(this.readSFixed64());return _},skip:function(_){var h=7&_;if(h===ya.Varint)for(;this.buf[this.pos++]>127;);else if(h===ya.Bytes)this.pos=this.readVarint()+this.pos;else if(h===ya.Fixed32)this.pos+=4;else{if(h!==ya.Fixed64)throw new Error("Unimplemented type: "+h);this.pos+=8}},writeTag:function(_,h){this.writeVarint(_<<3|h)},realloc:function(_){for(var h=this.length||16;h<this.pos+_;)h*=2;if(h!==this.length){var w=new Uint8Array(h);w.set(this.buf),this.buf=w,this.length=h}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(_){this.realloc(4),RA(this.buf,_,this.pos),this.pos+=4},writeSFixed32:function(_){this.realloc(4),RA(this.buf,_,this.pos),this.pos+=4},writeFixed64:function(_){this.realloc(8),RA(this.buf,-1&_,this.pos),RA(this.buf,Math.floor(_*pd),this.pos+4),this.pos+=8},writeSFixed64:function(_){this.realloc(8),RA(this.buf,-1&_,this.pos),RA(this.buf,Math.floor(_*pd),this.pos+4),this.pos+=8},writeVarint:function(_){(_=+_||0)>268435455||_<0?function(h,w){var P,H;if(h>=0?(P=h%4294967296|0,H=h/4294967296|0):(H=~(-h/4294967296),4294967295^(P=~(-h%4294967296))?P=P+1|0:(P=0,H=H+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");w.realloc(10),function(J,ee,ge){ge.buf[ge.pos++]=127&J|128,J>>>=7,ge.buf[ge.pos++]=127&J|128,J>>>=7,ge.buf[ge.pos++]=127&J|128,J>>>=7,ge.buf[ge.pos++]=127&J|128,ge.buf[ge.pos]=127&(J>>>=7)}(P,0,w),function(J,ee){var ge=(7&J)<<4;ee.buf[ee.pos++]|=ge|((J>>>=3)?128:0),J&&(ee.buf[ee.pos++]=127&J|((J>>>=7)?128:0),J&&(ee.buf[ee.pos++]=127&J|((J>>>=7)?128:0),J&&(ee.buf[ee.pos++]=127&J|((J>>>=7)?128:0),J&&(ee.buf[ee.pos++]=127&J|((J>>>=7)?128:0),J&&(ee.buf[ee.pos++]=127&J)))))}(H,w)}(_,this):(this.realloc(4),this.buf[this.pos++]=127&_|(_>127?128:0),_<=127||(this.buf[this.pos++]=127&(_>>>=7)|(_>127?128:0),_<=127||(this.buf[this.pos++]=127&(_>>>=7)|(_>127?128:0),_<=127||(this.buf[this.pos++]=_>>>7&127))))},writeSVarint:function(_){this.writeVarint(_<0?2*-_-1:2*_)},writeBoolean:function(_){this.writeVarint(!!_)},writeString:function(_){_=String(_),this.realloc(4*_.length),this.pos++;var h=this.pos;this.pos=function(P,H,J){for(var ee,ge,Te=0;Te<H.length;Te++){if((ee=H.charCodeAt(Te))>55295&&ee<57344){if(!ge){ee>56319||Te+1===H.length?(P[J++]=239,P[J++]=191,P[J++]=189):ge=ee;continue}if(ee<56320){P[J++]=239,P[J++]=191,P[J++]=189,ge=ee;continue}ee=ge-55296<<10|ee-56320|65536,ge=null}else ge&&(P[J++]=239,P[J++]=191,P[J++]=189,ge=null);ee<128?P[J++]=ee:(ee<2048?P[J++]=ee>>6|192:(ee<65536?P[J++]=ee>>12|224:(P[J++]=ee>>18|240,P[J++]=ee>>12&63|128),P[J++]=ee>>6&63|128),P[J++]=63&ee|128)}return J}(this.buf,_,this.pos);var w=this.pos-h;w>=128&&I0(h,w,this),this.pos=h-1,this.writeVarint(w),this.pos+=w},writeFloat:function(_){this.realloc(4),dd(this.buf,_,this.pos,!0,23,4),this.pos+=4},writeDouble:function(_){this.realloc(8),dd(this.buf,_,this.pos,!0,52,8),this.pos+=8},writeBytes:function(_){var h=_.length;this.writeVarint(h),this.realloc(h);for(var w=0;w<h;w++)this.buf[this.pos++]=_[w]},writeRawMessage:function(_,h){this.pos++;var w=this.pos;_(h,this);var P=this.pos-w;P>=128&&I0(w,P,this),this.pos=w-1,this.writeVarint(P),this.pos+=P},writeMessage:function(_,h,w){this.writeTag(_,ya.Bytes),this.writeRawMessage(h,w)},writePackedVarint:function(_,h){h.length&&this.writeMessage(_,Pf,h)},writePackedSVarint:function(_,h){h.length&&this.writeMessage(_,md,h)},writePackedBoolean:function(_,h){h.length&&this.writeMessage(_,Bp,h)},writePackedFloat:function(_,h){h.length&&this.writeMessage(_,bs,h)},writePackedDouble:function(_,h){h.length&&this.writeMessage(_,nh,h)},writePackedFixed32:function(_,h){h.length&&this.writeMessage(_,gd,h)},writePackedSFixed32:function(_,h){h.length&&this.writeMessage(_,rh,h)},writePackedFixed64:function(_,h){h.length&&this.writeMessage(_,zA,h)},writePackedSFixed64:function(_,h){h.length&&this.writeMessage(_,zp,h)},writeBytesField:function(_,h){this.writeTag(_,ya.Bytes),this.writeBytes(h)},writeFixed32Field:function(_,h){this.writeTag(_,ya.Fixed32),this.writeFixed32(h)},writeSFixed32Field:function(_,h){this.writeTag(_,ya.Fixed32),this.writeSFixed32(h)},writeFixed64Field:function(_,h){this.writeTag(_,ya.Fixed64),this.writeFixed64(h)},writeSFixed64Field:function(_,h){this.writeTag(_,ya.Fixed64),this.writeSFixed64(h)},writeVarintField:function(_,h){this.writeTag(_,ya.Varint),this.writeVarint(h)},writeSVarintField:function(_,h){this.writeTag(_,ya.Varint),this.writeSVarint(h)},writeStringField:function(_,h){this.writeTag(_,ya.Bytes),this.writeString(h)},writeFloatField:function(_,h){this.writeTag(_,ya.Fixed32),this.writeFloat(h)},writeDoubleField:function(_,h){this.writeTag(_,ya.Fixed64),this.writeDouble(h)},writeBooleanField:function(_,h){this.writeVarintField(_,!!h)}};var _d=N(Ad);const yd=3;function Um(_,h,w){_===1&&w.readMessage(Gm,h)}function Gm(_,h,w){if(_===3){const{id:P,bitmap:H,width:J,height:ee,left:ge,top:Te,advance:Ne}=w.readMessage(qm,{});h.push({id:P,bitmap:new zl({width:J+2*yd,height:ee+2*yd},H),metrics:{width:J,height:ee,left:ge,top:Te,advance:Ne}})}}function qm(_,h,w){_===1?h.id=w.readVarint():_===2?h.bitmap=w.readBytes():_===3?h.width=w.readVarint():_===4?h.height=w.readVarint():_===5?h.left=w.readSVarint():_===6?h.top=w.readSVarint():_===7&&(h.advance=w.readVarint())}const vd=yd;function FA(_){let h=0,w=0;for(const ee of _)h+=ee.w*ee.h,w=Math.max(w,ee.w);_.sort((ee,ge)=>ge.h-ee.h);const P=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),w),h:1/0}];let H=0,J=0;for(const ee of _)for(let ge=P.length-1;ge>=0;ge--){const Te=P[ge];if(!(ee.w>Te.w||ee.h>Te.h)){if(ee.x=Te.x,ee.y=Te.y,J=Math.max(J,ee.y+ee.h),H=Math.max(H,ee.x+ee.w),ee.w===Te.w&&ee.h===Te.h){const Ne=P.pop();ge<P.length&&(P[ge]=Ne)}else ee.h===Te.h?(Te.x+=ee.w,Te.w-=ee.w):ee.w===Te.w?(Te.y+=ee.h,Te.h-=ee.h):(P.push({x:Te.x+ee.w,y:Te.y,w:Te.w-ee.w,h:ee.h}),Te.y+=ee.h,Te.h-=ee.h);break}}return{w:H,h:J,fill:h/(H*J)||0}}const dl=1;class C0{constructor(h,{pixelRatio:w,version:P,stretchX:H,stretchY:J,content:ee}){this.paddedRect=h,this.pixelRatio=w,this.stretchX=H,this.stretchY=J,this.content=ee,this.version=P}get tl(){return[this.paddedRect.x+dl,this.paddedRect.y+dl]}get br(){return[this.paddedRect.x+this.paddedRect.w-dl,this.paddedRect.y+this.paddedRect.h-dl]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*dl)/this.pixelRatio,(this.paddedRect.h-2*dl)/this.pixelRatio]}}class T0{constructor(h,w){const P={},H={};this.haveRenderCallbacks=[];const J=[];this.addImages(h,P,J),this.addImages(w,H,J);const{w:ee,h:ge}=FA(J),Te=new qu({width:ee||1,height:ge||1});for(const Ne in h){const f=h[Ne],u=P[Ne].paddedRect;qu.copy(f.data,Te,{x:0,y:0},{x:u.x+dl,y:u.y+dl},f.data)}for(const Ne in w){const f=w[Ne],u=H[Ne].paddedRect,p=u.x+dl,E=u.y+dl,B=f.data.width,q=f.data.height;qu.copy(f.data,Te,{x:0,y:0},{x:p,y:E},f.data),qu.copy(f.data,Te,{x:0,y:q-1},{x:p,y:E-1},{width:B,height:1}),qu.copy(f.data,Te,{x:0,y:0},{x:p,y:E+q},{width:B,height:1}),qu.copy(f.data,Te,{x:B-1,y:0},{x:p-1,y:E},{width:1,height:q}),qu.copy(f.data,Te,{x:0,y:0},{x:p+B,y:E},{width:1,height:q})}this.image=Te,this.iconPositions=P,this.patternPositions=H}addImages(h,w,P){for(const H in h){const J=h[H],ee={x:0,y:0,w:J.data.width+2*dl,h:J.data.height+2*dl};P.push(ee),w[H]=new C0(ee,J),J.hasRenderCallback&&this.haveRenderCallbacks.push(H)}}patchUpdatedImages(h,w){h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const P in h.updatedImages)this.patchUpdatedImage(this.iconPositions[P],h.getImage(P),w),this.patchUpdatedImage(this.patternPositions[P],h.getImage(P),w)}patchUpdatedImage(h,w,P){if(!h||!w||h.version===w.version)return;h.version=w.version;const[H,J]=h.tl;P.update(w.data,void 0,{x:H,y:J})}}var Lc;En("ImagePosition",C0),En("ImageAtlas",T0),S.ah=void 0,(Lc=S.ah||(S.ah={}))[Lc.none=0]="none",Lc[Lc.horizontal=1]="horizontal",Lc[Lc.vertical=2]="vertical",Lc[Lc.horizontalOnly=3]="horizontalOnly";const OA=-17;class Df{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(h,w){const P=new Df;return P.scale=h||1,P.fontStack=w,P}static forImage(h){const w=new Df;return w.imageName=h,w}}class NA{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,w){const P=new NA;for(let H=0;H<h.sections.length;H++){const J=h.sections[H];J.image?P.addImageSection(J):P.addTextSection(J,w)}return P}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(){this.text=function(h){let w="";for(let P=0;P<h.length;P++){const H=h.charCodeAt(P+1)||null,J=h.charCodeAt(P-1)||null;w+=H&&vl(H)&&!Th[h[P+1]]||J&&vl(J)&&!Th[h[P-1]]||!Th[h[P]]?h[P]:Th[h[P]]}return w}(this.text)}trim(){let h=0;for(let P=0;P<this.text.length&&Bf[this.text.charCodeAt(P)];P++)h++;let w=this.text.length;for(let P=this.text.length-1;P>=0&&P>=h&&Bf[this.text.charCodeAt(P)];P--)w--;this.text=this.text.substring(h,w),this.sectionIndex=this.sectionIndex.slice(h,w)}substring(h,w){const P=new NA;return P.text=this.text.substring(h,w),P.sectionIndex=this.sectionIndex.slice(h,w),P.sections=this.sections,P}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((h,w)=>Math.max(h,this.sections[w].scale),0)}addTextSection(h,w){this.text+=h.text,this.sections.push(Df.forText(h.scale,h.fontStack||w));const P=this.sections.length-1;for(let H=0;H<h.text.length;++H)this.sectionIndex.push(P)}addImageSection(h){const w=h.image?h.image.name:"";if(w.length===0)return void ut("Can't add FormattedSection with an empty image.");const P=this.getNextImageSectionCharCode();P?(this.text+=String.fromCharCode(P),this.sections.push(Df.forImage(w)),this.sectionIndex.push(this.sections.length-1)):ut("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lf(_,h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q){const W=NA.fromFeature(_,H);let se;u===S.ah.vertical&&W.verticalizePunctuation();const{processBidirectionalText:fe,processStyledBidirectionalText:ve}=Kl;if(fe&&W.sections.length===1){se=[];const it=fe(W.toString(),sh(W,Ne,J,h,P,E,B));for(const pt of it){const vt=new NA;vt.text=pt,vt.sections=W.sections;for(let Dt=0;Dt<pt.length;Dt++)vt.sectionIndex.push(0);se.push(vt)}}else if(ve){se=[];const it=ve(W.text,W.sectionIndex,sh(W,Ne,J,h,P,E,B));for(const pt of it){const vt=new NA;vt.text=pt[0],vt.sectionIndex=pt[1],vt.sections=W.sections,se.push(vt)}}else se=function(it,pt){const vt=[],Dt=it.text;let Lt=0;for(const Rt of pt)vt.push(it.substring(Lt,Rt)),Lt=Rt;return Lt<Dt.length&&vt.push(it.substring(Lt,Dt.length)),vt}(W,sh(W,Ne,J,h,P,E,B));const Be=[],He={positionedLines:Be,text:W.toString(),top:f[1],bottom:f[1],left:f[0],right:f[0],writingMode:u,iconsInText:!1,verticalizable:!1};return function(it,pt,vt,Dt,Lt,Rt,ei,Zt,Wt,hi,vi,Ji){let In=0,un=OA,ln=0,dn=0;const Vn=Zt==="right"?1:Zt==="left"?0:.5;let on=0;for(const jr of Lt){jr.trim();const Xr=jr.getMaxScale(),Us=(Xr-1)*fl,Da={positionedGlyphs:[],lineOffset:0};it.positionedLines[on]=Da;const la=Da.positionedGlyphs;let us=0;if(!jr.length()){un+=Rt,++on;continue}for(let Ts=0;Ts<jr.length();Ts++){const rr=jr.getSection(Ts),ua=jr.getSectionIndex(Ts),Rs=jr.getCharCode(Ts);let tr=0,Ga=null,ao=null,Ia=null,Ho=fl;const po=!(Wt===S.ah.horizontal||!vi&&!ql(Rs)||vi&&(Bf[Rs]||(Ki=Rs,Tn.Arabic(Ki)||Tn["Arabic Supplement"](Ki)||Tn["Arabic Extended-A"](Ki)||Tn["Arabic Presentation Forms-A"](Ki)||Tn["Arabic Presentation Forms-B"](Ki))));if(rr.imageName){const ca=Dt[rr.imageName];if(!ca)continue;Ia=rr.imageName,it.iconsInText=it.iconsInText||!0,ao=ca.paddedRect;const Er=ca.displaySize;rr.scale=rr.scale*fl/Ji,Ga={width:Er[0],height:Er[1],left:dl,top:-vd,advance:po?Er[1]:Er[0]},tr=Us+(fl-Er[1]*rr.scale),Ho=Ga.advance;const Eo=po?Er[0]*rr.scale-fl*Xr:Er[1]*rr.scale-fl*Xr;Eo>0&&Eo>us&&(us=Eo)}else{const ca=vt[rr.fontStack],Er=ca&&ca[Rs];if(Er&&Er.rect)ao=Er.rect,Ga=Er.metrics;else{const Eo=pt[rr.fontStack],rl=Eo&&Eo[Rs];if(!rl)continue;Ga=rl.metrics}tr=(Xr-rr.scale)*fl}po?(it.verticalizable=!0,la.push({glyph:Rs,imageName:Ia,x:In,y:un+tr,vertical:po,scale:rr.scale,fontStack:rr.fontStack,sectionIndex:ua,metrics:Ga,rect:ao}),In+=Ho*rr.scale+hi):(la.push({glyph:Rs,imageName:Ia,x:In,y:un+tr,vertical:po,scale:rr.scale,fontStack:rr.fontStack,sectionIndex:ua,metrics:Ga,rect:ao}),In+=Ga.advance*rr.scale+hi)}la.length!==0&&(ln=Math.max(In-hi,ln),M0(la,0,la.length-1,Vn,us)),In=0;const Yn=Rt*Xr+us;Da.lineOffset=Math.max(us,Us),un+=Yn,dn=Math.max(Yn,dn),++on}var Ki;const Fn=un-OA,{horizontalAlign:Un,verticalAlign:gr}=GA(ei);(function(jr,Xr,Us,Da,la,us,Yn,Ts,rr){const ua=(Xr-Us)*la;let Rs=0;Rs=us!==Yn?-Ts*Da-OA:(-Da*rr+.5)*Yn;for(const tr of jr)for(const Ga of tr.positionedGlyphs)Ga.x+=ua,Ga.y+=Rs})(it.positionedLines,Vn,Un,gr,ln,dn,Rt,Fn,Lt.length),it.top+=-gr*Fn,it.bottom=it.top+Fn,it.left+=-Un*ln,it.right=it.left+ln}(He,h,w,P,se,ee,ge,Te,u,Ne,p,q),!function(it){for(const pt of it)if(pt.positionedGlyphs.length!==0)return!1;return!0}(Be)&&He}const Bf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Cu={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function k0(_,h,w,P,H,J){if(h.imageName){const ee=P[h.imageName];return ee?ee.displaySize[0]*h.scale*fl/J+H:0}{const ee=w[h.fontStack],ge=ee&&ee[_];return ge?ge.metrics.advance*h.scale+H:0}}function Du(_,h,w,P){const H=Math.pow(_-h,2);return P?_<h?H/2:2*H:H+Math.abs(w)*w}function kh(_,h,w){let P=0;return _===10&&(P-=1e4),w&&(P+=150),_!==40&&_!==65288||(P+=50),h!==41&&h!==65289||(P+=50),P}function VA(_,h,w,P,H,J){let ee=null,ge=Du(h,w,H,J);for(const Te of P){const Ne=Du(h-Te.x,w,H,J)+Te.badness;Ne<=ge&&(ee=Te,ge=Ne)}return{index:_,x:h,priorBreak:ee,badness:ge}}function UA(_){return _?UA(_.priorBreak).concat(_.index):[]}function sh(_,h,w,P,H,J,ee){if(J!=="point")return[];if(!_)return[];const ge=[],Te=function(p,E,B,q,W,se){let fe=0;for(let ve=0;ve<p.length();ve++){const Be=p.getSection(ve);fe+=k0(p.getCharCode(ve),Be,q,W,E,se)}return fe/Math.max(1,Math.ceil(fe/B))}(_,h,w,P,H,ee),Ne=_.text.indexOf("")>=0;let f=0;for(let p=0;p<_.length();p++){const E=_.getSection(p),B=_.getCharCode(p);if(Bf[B]||(f+=k0(B,E,P,H,h,ee)),p<_.length()-1){const q=!((u=B)<11904||!(Tn["Bopomofo Extended"](u)||Tn.Bopomofo(u)||Tn["CJK Compatibility Forms"](u)||Tn["CJK Compatibility Ideographs"](u)||Tn["CJK Compatibility"](u)||Tn["CJK Radicals Supplement"](u)||Tn["CJK Strokes"](u)||Tn["CJK Symbols and Punctuation"](u)||Tn["CJK Unified Ideographs Extension A"](u)||Tn["CJK Unified Ideographs"](u)||Tn["Enclosed CJK Letters and Months"](u)||Tn["Halfwidth and Fullwidth Forms"](u)||Tn.Hiragana(u)||Tn["Ideographic Description Characters"](u)||Tn["Kangxi Radicals"](u)||Tn["Katakana Phonetic Extensions"](u)||Tn.Katakana(u)||Tn["Vertical Forms"](u)||Tn["Yi Radicals"](u)||Tn["Yi Syllables"](u)));(Cu[B]||q||E.imageName)&&ge.push(VA(p+1,f,Te,ge,kh(B,_.getCharCode(p+1),q&&Ne),!1))}}var u;return UA(VA(_.length(),f,Te,ge,0,!0))}function GA(_){let h=.5,w=.5;switch(_){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(_){case"bottom":case"bottom-right":case"bottom-left":w=1;break;case"top":case"top-right":case"top-left":w=0}return{horizontalAlign:h,verticalAlign:w}}function M0(_,h,w,P,H){if(!P&&!H)return;const J=_[w],ee=(_[w].x+J.metrics.advance*J.scale)*P;for(let ge=h;ge<=w;ge++)_[ge].x-=ee,_[ge].y+=H}function Hm(_,h,w){const{horizontalAlign:P,verticalAlign:H}=GA(w),J=h[0]-_.displaySize[0]*P,ee=h[1]-_.displaySize[1]*H;return{image:_,top:ee,bottom:ee+_.displaySize[1],left:J,right:J+_.displaySize[0]}}function xd(_,h,w,P,H,J){const ee=_.image;let ge;if(ee.content){const W=ee.content,se=ee.pixelRatio||1;ge=[W[0]/se,W[1]/se,ee.displaySize[0]-W[2]/se,ee.displaySize[1]-W[3]/se]}const Te=h.left*J,Ne=h.right*J;let f,u,p,E;w==="width"||w==="both"?(E=H[0]+Te-P[3],u=H[0]+Ne+P[1]):(E=H[0]+(Te+Ne-ee.displaySize[0])/2,u=E+ee.displaySize[0]);const B=h.top*J,q=h.bottom*J;return w==="height"||w==="both"?(f=H[1]+B-P[0],p=H[1]+q+P[2]):(f=H[1]+(B+q-ee.displaySize[1])/2,p=f+ee.displaySize[1]),{image:ee,top:f,right:u,bottom:p,left:E,collisionPadding:ge}}const Mh=255,Bc=128,ah=Mh*Bc;function bd(_,h){const{expression:w}=h;if(w.kind==="constant")return{kind:"constant",layoutSize:w.evaluate(new ys(_+1))};if(w.kind==="source")return{kind:"source"};{const{zoomStops:P,interpolationType:H}=w;let J=0;for(;J<P.length&&P[J]<=_;)J++;J=Math.max(0,J-1);let ee=J;for(;ee<P.length&&P[ee]<_+1;)ee++;ee=Math.min(P.length-1,ee);const ge=P[J],Te=P[ee];return w.kind==="composite"?{kind:"composite",minZoom:ge,maxZoom:Te,interpolationType:H}:{kind:"camera",minZoom:ge,maxZoom:Te,minSize:w.evaluate(new ys(ge)),maxSize:w.evaluate(new ys(Te)),interpolationType:H}}}function zf(_,h,w){let P="never";const H=_.get(h);return H?P=H:_.get(w)&&(P="always"),P}const wd=fc.VectorTileFeature.types,jm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function P0(_,h,w,P,H,J,ee,ge,Te,Ne,f,u,p){const E=ge?Math.min(ah,Math.round(ge[0])):0,B=ge?Math.min(ah,Math.round(ge[1])):0;_.emplaceBack(h,w,Math.round(32*P),Math.round(32*H),J,ee,(E<<1)+(Te?1:0),B,16*Ne,16*f,256*u,256*p)}function D0(_,h,w){_.emplaceBack(h.x,h.y,w),_.emplaceBack(h.x,h.y,w),_.emplaceBack(h.x,h.y,w),_.emplaceBack(h.x,h.y,w)}function Rf(_){for(const h of _.sections)if(Ku(h.text))return!0;return!1}class ec{constructor(h){this.layoutVertexArray=new lt,this.indexArray=new Kt,this.programConfigurations=h,this.segments=new $i,this.dynamicLayoutVertexArray=new ft,this.opacityVertexArray=new Tt,this.hasVisibleVertices=!1,this.placedSymbolArray=new r}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,w,P,H){this.isEmpty()||(P&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Lp.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,w),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,cd.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,jm,!0),this.opacityVertexBuffer.itemSize=1),(P||H)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}En("SymbolBuffers",ec);class zc{constructor(h,w,P){this.layoutVertexArray=new h,this.layoutAttributes=w,this.indexArray=new P,this.segments=new $i,this.collisionVertexArray=new si}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,DA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}En("CollisionBuffers",zc);class rA{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(ee=>ee.id),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Y0([]),this.placementViewportMatrix=Y0([]);const w=this.layers[0]._unevaluatedLayout._values;this.textSizeData=bd(this.zoom,w["text-size"]),this.iconSizeData=bd(this.zoom,w["icon-size"]);const P=this.layers[0].layout,H=P.get("symbol-sort-key"),J=P.get("symbol-z-order");this.canOverlap=zf(P,"text-overlap","text-allow-overlap")!=="never"||zf(P,"icon-overlap","icon-allow-overlap")!=="never"||P.get("text-ignore-placement")||P.get("icon-ignore-placement"),this.sortFeaturesByKey=J!=="viewport-y"&&!H.isConstant(),this.sortFeaturesByY=(J==="viewport-y"||J==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,P.get("symbol-placement")==="point"&&(this.writingModes=P.get("text-writing-mode").map(ee=>S.ah[ee])),this.stateDependentLayerIds=this.layers.filter(ee=>ee.isStateDependent()).map(ee=>ee.id),this.sourceID=h.sourceID}createArrays(){this.text=new ec(new Go(this.layers,this.zoom,h=>/^text/.test(h))),this.icon=new ec(new Go(this.layers,this.zoom,h=>/^icon/.test(h))),this.glyphOffsetArray=new y,this.lineVertexArray=new I,this.symbolInstances=new d,this.textAnchorOffsets=new z}calculateGlyphDependencies(h,w,P,H,J){for(let ee=0;ee<h.length;ee++)if(w[h.charCodeAt(ee)]=!0,(P||H)&&J){const ge=Th[h.charAt(ee)];ge&&(w[ge.charCodeAt(0)]=!0)}}populate(h,w,P){const H=this.layers[0],J=H.layout,ee=J.get("text-font"),ge=J.get("text-field"),Te=J.get("icon-image"),Ne=(ge.value.kind!=="constant"||ge.value.value instanceof Qi&&!ge.value.value.isEmpty()||ge.value.value.toString().length>0)&&(ee.value.kind!=="constant"||ee.value.value.length>0),f=Te.value.kind!=="constant"||!!Te.value.value||Object.keys(Te.parameters).length>0,u=J.get("symbol-sort-key");if(this.features=[],!Ne&&!f)return;const p=w.iconDependencies,E=w.glyphDependencies,B=w.availableImages,q=new ys(this.zoom);for(const{feature:W,id:se,index:fe,sourceLayerIndex:ve}of h){const Be=H._featureFilter.needGeometry,He=xl(W,Be);if(!H._featureFilter.filter(q,He,P))continue;let it,pt;if(Be||(He.geometry=nl(W)),Ne){const Dt=H.getValueAndResolveTokens("text-field",He,P,B),Lt=Qi.factory(Dt);Rf(Lt)&&(this.hasRTLText=!0),(!this.hasRTLText||Kl.getRTLTextPluginStatus()==="unavailable"||this.hasRTLText&&Kl.isParsed())&&(it=Vm(Lt,H,He))}if(f){const Dt=H.getValueAndResolveTokens("icon-image",He,P,B);pt=Dt instanceof en?Dt:en.fromString(Dt)}if(!it&&!pt)continue;const vt=this.sortFeaturesByKey?u.evaluate(He,{},P):void 0;if(this.features.push({id:se,text:it,icon:pt,index:fe,sourceLayerIndex:ve,geometry:He.geometry,properties:W.properties,type:wd[W.type],sortKey:vt}),pt&&(p[pt.name]=!0),it){const Dt=ee.evaluate(He,{},P).join(","),Lt=J.get("text-rotation-alignment")!=="viewport"&&J.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(S.ah.vertical)>=0;for(const Rt of it.sections)if(Rt.image)p[Rt.image.name]=!0;else{const ei=yl(it.toString()),Zt=Rt.fontStack||Dt,Wt=E[Zt]=E[Zt]||{};this.calculateGlyphDependencies(Rt.text,Wt,Lt,this.allowVerticalPlacement,ei)}}}J.get("symbol-placement")==="line"&&(this.features=function(W){const se={},fe={},ve=[];let Be=0;function He(Dt){ve.push(W[Dt]),Be++}function it(Dt,Lt,Rt){const ei=fe[Dt];return delete fe[Dt],fe[Lt]=ei,ve[ei].geometry[0].pop(),ve[ei].geometry[0]=ve[ei].geometry[0].concat(Rt[0]),ei}function pt(Dt,Lt,Rt){const ei=se[Lt];return delete se[Lt],se[Dt]=ei,ve[ei].geometry[0].shift(),ve[ei].geometry[0]=Rt[0].concat(ve[ei].geometry[0]),ei}function vt(Dt,Lt,Rt){const ei=Rt?Lt[0][Lt[0].length-1]:Lt[0][0];return`${Dt}:${ei.x}:${ei.y}`}for(let Dt=0;Dt<W.length;Dt++){const Lt=W[Dt],Rt=Lt.geometry,ei=Lt.text?Lt.text.toString():null;if(!ei){He(Dt);continue}const Zt=vt(ei,Rt),Wt=vt(ei,Rt,!0);if(Zt in fe&&Wt in se&&fe[Zt]!==se[Wt]){const hi=pt(Zt,Wt,Rt),vi=it(Zt,Wt,ve[hi].geometry);delete se[Zt],delete fe[Wt],fe[vt(ei,ve[vi].geometry,!0)]=vi,ve[hi].geometry=null}else Zt in fe?it(Zt,Wt,Rt):Wt in se?pt(Zt,Wt,Rt):(He(Dt),se[Zt]=Be-1,fe[Wt]=Be-1)}return ve.filter(Dt=>Dt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,se)=>W.sortKey-se.sortKey)}update(h,w,P){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,w,this.layers,P),this.icon.programConfigurations.updatePaintArrays(h,w,this.layers,P))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,w){const P=this.lineVertexArray.length;if(h.segment!==void 0){let H=h.dist(w[h.segment+1]),J=h.dist(w[h.segment]);const ee={};for(let ge=h.segment+1;ge<w.length;ge++)ee[ge]={x:w[ge].x,y:w[ge].y,tileUnitDistanceFromAnchor:H},ge<w.length-1&&(H+=w[ge+1].dist(w[ge]));for(let ge=h.segment||0;ge>=0;ge--)ee[ge]={x:w[ge].x,y:w[ge].y,tileUnitDistanceFromAnchor:J},ge>0&&(J+=w[ge-1].dist(w[ge]));for(let ge=0;ge<w.length;ge++){const Te=ee[ge];this.lineVertexArray.emplaceBack(Te.x,Te.y,Te.tileUnitDistanceFromAnchor)}}return{lineStartIndex:P,lineLength:this.lineVertexArray.length-P}}addSymbols(h,w,P,H,J,ee,ge,Te,Ne,f,u,p){const E=h.indexArray,B=h.layoutVertexArray,q=h.segments.prepareSegment(4*w.length,B,E,this.canOverlap?ee.sortKey:void 0),W=this.glyphOffsetArray.length,se=q.vertexLength,fe=this.allowVerticalPlacement&&ge===S.ah.vertical?Math.PI/2:0,ve=ee.text&&ee.text.sections;for(let Be=0;Be<w.length;Be++){const{tl:He,tr:it,bl:pt,br:vt,tex:Dt,pixelOffsetTL:Lt,pixelOffsetBR:Rt,minFontScaleX:ei,minFontScaleY:Zt,glyphOffset:Wt,isSDF:hi,sectionIndex:vi}=w[Be],Ji=q.vertexLength,In=Wt[1];P0(B,Te.x,Te.y,He.x,In+He.y,Dt.x,Dt.y,P,hi,Lt.x,Lt.y,ei,Zt),P0(B,Te.x,Te.y,it.x,In+it.y,Dt.x+Dt.w,Dt.y,P,hi,Rt.x,Lt.y,ei,Zt),P0(B,Te.x,Te.y,pt.x,In+pt.y,Dt.x,Dt.y+Dt.h,P,hi,Lt.x,Rt.y,ei,Zt),P0(B,Te.x,Te.y,vt.x,In+vt.y,Dt.x+Dt.w,Dt.y+Dt.h,P,hi,Rt.x,Rt.y,ei,Zt),D0(h.dynamicLayoutVertexArray,Te,fe),E.emplaceBack(Ji,Ji+1,Ji+2),E.emplaceBack(Ji+1,Ji+2,Ji+3),q.vertexLength+=4,q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Wt[0]),Be!==w.length-1&&vi===w[Be+1].sectionIndex||h.programConfigurations.populatePaintArrays(B.length,ee,ee.index,{},p,ve&&ve[vi])}h.placedSymbolArray.emplaceBack(Te.x,Te.y,W,this.glyphOffsetArray.length-W,se,Ne,f,Te.segment,P?P[0]:0,P?P[1]:0,H[0],H[1],ge,0,!1,0,u)}_addCollisionDebugVertex(h,w,P,H,J,ee){return w.emplaceBack(0,0),h.emplaceBack(P.x,P.y,H,J,Math.round(ee.x),Math.round(ee.y))}addCollisionDebugVertices(h,w,P,H,J,ee,ge){const Te=J.segments.prepareSegment(4,J.layoutVertexArray,J.indexArray),Ne=Te.vertexLength,f=J.layoutVertexArray,u=J.collisionVertexArray,p=ge.anchorX,E=ge.anchorY;this._addCollisionDebugVertex(f,u,ee,p,E,new oe(h,w)),this._addCollisionDebugVertex(f,u,ee,p,E,new oe(P,w)),this._addCollisionDebugVertex(f,u,ee,p,E,new oe(P,H)),this._addCollisionDebugVertex(f,u,ee,p,E,new oe(h,H)),Te.vertexLength+=4;const B=J.indexArray;B.emplaceBack(Ne,Ne+1),B.emplaceBack(Ne+1,Ne+2),B.emplaceBack(Ne+2,Ne+3),B.emplaceBack(Ne+3,Ne),Te.primitiveLength+=4}addDebugCollisionBoxes(h,w,P,H){for(let J=h;J<w;J++){const ee=this.collisionBoxArray.get(J);this.addCollisionDebugVertices(ee.x1,ee.y1,ee.x2,ee.y2,H?this.textCollisionBox:this.iconCollisionBox,ee.anchorPoint,P)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zc(It,S0.members,ii),this.iconCollisionBox=new zc(It,S0.members,ii);for(let h=0;h<this.symbolInstances.length;h++){const w=this.symbolInstances.get(h);this.addDebugCollisionBoxes(w.textBoxStartIndex,w.textBoxEndIndex,w,!0),this.addDebugCollisionBoxes(w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w,!0),this.addDebugCollisionBoxes(w.iconBoxStartIndex,w.iconBoxEndIndex,w,!1),this.addDebugCollisionBoxes(w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w,!1)}}_deserializeCollisionBoxesForSymbol(h,w,P,H,J,ee,ge,Te,Ne){const f={};for(let u=w;u<P;u++){const p=h.get(u);f.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.textFeatureIndex=p.featureIndex;break}for(let u=H;u<J;u++){const p=h.get(u);f.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalTextFeatureIndex=p.featureIndex;break}for(let u=ee;u<ge;u++){const p=h.get(u);f.iconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.iconFeatureIndex=p.featureIndex;break}for(let u=Te;u<Ne;u++){const p=h.get(u);f.verticalIconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalIconFeatureIndex=p.featureIndex;break}return f}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let w=0;w<this.symbolInstances.length;w++){const P=this.symbolInstances.get(w);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,P.textBoxStartIndex,P.textBoxEndIndex,P.verticalTextBoxStartIndex,P.verticalTextBoxEndIndex,P.iconBoxStartIndex,P.iconBoxEndIndex,P.verticalIconBoxStartIndex,P.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,w){const P=h.placedSymbolArray.get(w),H=P.vertexStartIndex+4*P.numGlyphs;for(let J=P.vertexStartIndex;J<H;J+=4)h.indexArray.emplaceBack(J,J+1,J+2),h.indexArray.emplaceBack(J+1,J+2,J+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const w=Math.sin(h),P=Math.cos(h),H=[],J=[],ee=[];for(let ge=0;ge<this.symbolInstances.length;++ge){ee.push(ge);const Te=this.symbolInstances.get(ge);H.push(0|Math.round(w*Te.anchorX+P*Te.anchorY)),J.push(Te.featureIndex)}return ee.sort((ge,Te)=>H[ge]-H[Te]||J[Te]-J[ge]),ee}addToSortKeyRanges(h,w){const P=this.sortKeyRanges[this.sortKeyRanges.length-1];P&&P.sortKey===w?P.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:w,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const w of this.symbolInstanceIndexes){const P=this.symbolInstances.get(w);this.featureSortOrder.push(P.featureIndex),[P.rightJustifiedTextSymbolIndex,P.centerJustifiedTextSymbolIndex,P.leftJustifiedTextSymbolIndex].forEach((H,J,ee)=>{H>=0&&ee.indexOf(H)===J&&this.addIndicesForPlacedSymbol(this.text,H)}),P.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,P.verticalPlacedTextSymbolIndex),P.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,P.placedIconSymbolIndex),P.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,P.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let L0,Fp;En("SymbolBucket",rA,{omit:["layers","collisionBoxArray","features","compareText"]}),rA.MAX_GLYPHS=65535,rA.addDynamicAttributes=D0;var Sd={get paint(){return Fp=Fp||new fa({"icon-opacity":new Zn(Ot.paint_symbol["icon-opacity"]),"icon-color":new Zn(Ot.paint_symbol["icon-color"]),"icon-halo-color":new Zn(Ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zn(Ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zn(Ot.paint_symbol["icon-halo-blur"]),"icon-translate":new gn(Ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new gn(Ot.paint_symbol["icon-translate-anchor"]),"text-opacity":new Zn(Ot.paint_symbol["text-opacity"]),"text-color":new Zn(Ot.paint_symbol["text-color"],{runtimeType:je,getOverride:_=>_.textColor,hasOverride:_=>!!_.textColor}),"text-halo-color":new Zn(Ot.paint_symbol["text-halo-color"]),"text-halo-width":new Zn(Ot.paint_symbol["text-halo-width"]),"text-halo-blur":new Zn(Ot.paint_symbol["text-halo-blur"]),"text-translate":new gn(Ot.paint_symbol["text-translate"]),"text-translate-anchor":new gn(Ot.paint_symbol["text-translate-anchor"])})},get layout(){return L0=L0||new fa({"symbol-placement":new gn(Ot.layout_symbol["symbol-placement"]),"symbol-spacing":new gn(Ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gn(Ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zn(Ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gn(Ot.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gn(Ot.layout_symbol["icon-allow-overlap"]),"icon-overlap":new gn(Ot.layout_symbol["icon-overlap"]),"icon-ignore-placement":new gn(Ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new gn(Ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gn(Ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new Zn(Ot.layout_symbol["icon-size"]),"icon-text-fit":new gn(Ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gn(Ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zn(Ot.layout_symbol["icon-image"]),"icon-rotate":new Zn(Ot.layout_symbol["icon-rotate"]),"icon-padding":new Zn(Ot.layout_symbol["icon-padding"]),"icon-keep-upright":new gn(Ot.layout_symbol["icon-keep-upright"]),"icon-offset":new Zn(Ot.layout_symbol["icon-offset"]),"icon-anchor":new Zn(Ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gn(Ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gn(Ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gn(Ot.layout_symbol["text-rotation-alignment"]),"text-field":new Zn(Ot.layout_symbol["text-field"]),"text-font":new Zn(Ot.layout_symbol["text-font"]),"text-size":new Zn(Ot.layout_symbol["text-size"]),"text-max-width":new Zn(Ot.layout_symbol["text-max-width"]),"text-line-height":new gn(Ot.layout_symbol["text-line-height"]),"text-letter-spacing":new Zn(Ot.layout_symbol["text-letter-spacing"]),"text-justify":new Zn(Ot.layout_symbol["text-justify"]),"text-radial-offset":new Zn(Ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gn(Ot.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Zn(Ot.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Zn(Ot.layout_symbol["text-anchor"]),"text-max-angle":new gn(Ot.layout_symbol["text-max-angle"]),"text-writing-mode":new gn(Ot.layout_symbol["text-writing-mode"]),"text-rotate":new Zn(Ot.layout_symbol["text-rotate"]),"text-padding":new gn(Ot.layout_symbol["text-padding"]),"text-keep-upright":new gn(Ot.layout_symbol["text-keep-upright"]),"text-transform":new Zn(Ot.layout_symbol["text-transform"]),"text-offset":new Zn(Ot.layout_symbol["text-offset"]),"text-allow-overlap":new gn(Ot.layout_symbol["text-allow-overlap"]),"text-overlap":new gn(Ot.layout_symbol["text-overlap"]),"text-ignore-placement":new gn(Ot.layout_symbol["text-ignore-placement"]),"text-optional":new gn(Ot.layout_symbol["text-optional"])})}};class Ff{constructor(h){if(h.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=h.property.overrides?h.property.overrides.runtimeType:Ee,this.defaultValue=h}evaluate(h){if(h.formattedSection){const w=this.defaultValue.property.overrides;if(w&&w.hasOverride(h.formattedSection))return w.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}En("FormatSectionOverride",Ff,{omit:["defaultValue"]});class qA extends Is{constructor(h){super(h,Sd)}recalculate(h,w){if(super.recalculate(h,w),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const P=this.layout.get("text-writing-mode");if(P){const H=[];for(const J of P)H.indexOf(J)<0&&H.push(J);this.layout._values["text-writing-mode"]=H}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(h,w,P,H){const J=this.layout.get(h).evaluate(w,{},P,H),ee=this._unevaluatedLayout._values[h];return ee.isDataDriven()||Kr(ee.value)||!J?J:function(ge,Te){return Te.replace(/{([^{}]+)}/g,(Ne,f)=>ge&&f in ge?String(ge[f]):"")}(w.properties,J)}createBucket(h){return new rA(h)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const h of Sd.paint.overridableProperties){if(!qA.hasPaintOverride(this.layout,h))continue;const w=this.paint.get(h),P=new Ff(w),H=new as(P,w.property.specification);let J=null;J=w.value.kind==="constant"||w.value.kind==="source"?new Br("source",H):new ar("composite",H,w.value.zoomStops),this.paint._values[h]=new br(w.property,J,w.parameters)}}_handleOverridablePaintPropertyUpdate(h,w,P){return!(!this.layout||w.isDataDriven()||P.isDataDriven())&&qA.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,w){const P=h.get("text-field"),H=Sd.paint.properties[w];let J=!1;const ee=ge=>{for(const Te of ge)if(H.overrides&&H.overrides.hasOverride(Te))return void(J=!0)};if(P.value.kind==="constant"&&P.value.value instanceof Qi)ee(P.value.value.sections);else if(P.value.kind==="source"){const ge=Ne=>{J||(Ne instanceof Qr&&Ar(Ne.value)===ot?ee(Ne.value.sections):Ne instanceof Xl?ee(Ne.sections):Ne.eachChild(ge))},Te=P.value;Te._styleExpression&&ge(Te._styleExpression.expression)}return J}}let Op;var Id={get paint(){return Op=Op||new fa({"background-color":new gn(Ot.paint_background["background-color"]),"background-pattern":new il(Ot.paint_background["background-pattern"]),"background-opacity":new gn(Ot.paint_background["background-opacity"])})}};class Ed extends Is{constructor(h){super(h,Id)}}let oh;var Cd={get paint(){return oh=oh||new fa({"raster-opacity":new gn(Ot.paint_raster["raster-opacity"]),"raster-hue-rotate":new gn(Ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gn(Ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gn(Ot.paint_raster["raster-brightness-max"]),"raster-saturation":new gn(Ot.paint_raster["raster-saturation"]),"raster-contrast":new gn(Ot.paint_raster["raster-contrast"]),"raster-resampling":new gn(Ot.paint_raster["raster-resampling"]),"raster-fade-duration":new gn(Ot.paint_raster["raster-fade-duration"])})}};class Np extends Is{constructor(h){super(h,Cd)}}class Td extends Is{constructor(h){super(h,{}),this.onAdd=w=>{this.implementation.onAdd&&this.implementation.onAdd(w,w.painter.context.gl)},this.onRemove=w=>{this.implementation.onRemove&&this.implementation.onRemove(w,w.painter.context.gl)},this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Vp{constructor(h){this._methodToThrottle=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const HA=63710088e-1;class lh{constructor(h,w){if(isNaN(h)||isNaN(w))throw new Error(`Invalid LngLat object: (${h}, ${w})`);if(this.lng=+h,this.lat=+w,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new lh(Ue(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const w=Math.PI/180,P=this.lat*w,H=h.lat*w,J=Math.sin(P)*Math.sin(H)+Math.cos(P)*Math.cos(H)*Math.cos((h.lng-this.lng)*w);return HA*Math.acos(Math.min(J,1))}static convert(h){if(h instanceof lh)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new lh(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new lh(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Up=2*Math.PI*HA;function Gp(_){return Up*Math.cos(_*Math.PI/180)}function kd(_){return(180+_)/360}function Md(_){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+_*Math.PI/360)))/360}function qp(_,h){return _/Gp(h)}function jA(_){return 360/Math.PI*Math.atan(Math.exp((180-360*_)*Math.PI/180))-90}class B0{constructor(h,w,P=0){this.x=+h,this.y=+w,this.z=+P}static fromLngLat(h,w=0){const P=lh.convert(h);return new B0(kd(P.lng),Md(P.lat),qp(w,P.lat))}toLngLat(){return new lh(360*this.x-180,jA(this.y))}toAltitude(){return this.z*Gp(jA(this.y))}meterInMercatorCoordinateUnits(){return 1/Up*(h=jA(this.y),1/Math.cos(h*Math.PI/180));var h}}function z0(_,h,w){var P=2*Math.PI*6378137/256/Math.pow(2,w);return[_*P-2*Math.PI*6378137/2,h*P-2*Math.PI*6378137/2]}class Rc{constructor(h,w,P){if(h<0||h>25||P<0||P>=Math.pow(2,h)||w<0||w>=Math.pow(2,h))throw new Error(`x=${w}, y=${P}, z=${h} outside of bounds. 0<=x<${Math.pow(2,h)}, 0<=y<${Math.pow(2,h)} 0<=z<=25 `);this.z=h,this.x=w,this.y=P,this.key=ZA(0,h,h,w,P)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,w,P){const H=(ee=this.y,ge=this.z,Te=z0(256*(J=this.x),256*(ee=Math.pow(2,ge)-ee-1),ge),Ne=z0(256*(J+1),256*(ee+1),ge),Te[0]+","+Te[1]+","+Ne[0]+","+Ne[1]);var J,ee,ge,Te,Ne;const f=function(u,p,E){let B,q="";for(let W=u;W>0;W--)B=1<<W-1,q+=(p&B?1:0)+(E&B?2:0);return q}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(P==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,w>1?"@2x":"").replace(/{quadkey}/g,f).replace(/{bbox-epsg-3857}/g,H)}isChildOf(h){const w=this.z-h.z;return w>0&&h.x===this.x>>w&&h.y===this.y>>w}getTilePoint(h){const w=Math.pow(2,this.z);return new oe((h.x*w-this.x)*ea,(h.y*w-this.y)*ea)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Pd{constructor(h,w){this.wrap=h,this.canonical=w,this.key=ZA(h,w.z,w.z,w.x,w.y)}}class Lu{constructor(h,w,P,H,J){if(h<P)throw new Error(`overscaledZ should be >= z; overscaledZ = ${h}; z = ${P}`);this.overscaledZ=h,this.wrap=w,this.canonical=new Rc(P,+H,+J),this.key=ZA(w,h,P,H,J)}clone(){return new Lu(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const w=this.canonical.z-h;return h>this.canonical.z?new Lu(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Lu(h,this.wrap,h,this.canonical.x>>w,this.canonical.y>>w)}calculateScaledKey(h,w){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const P=this.canonical.z-h;return h>this.canonical.z?ZA(this.wrap*+w,h,this.canonical.z,this.canonical.x,this.canonical.y):ZA(this.wrap*+w,h,h,this.canonical.x>>P,this.canonical.y>>P)}isChildOf(h){if(h.wrap!==this.wrap)return!1;const w=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>w&&h.canonical.y===this.canonical.y>>w}children(h){if(this.overscaledZ>=h)return[new Lu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const w=this.canonical.z+1,P=2*this.canonical.x,H=2*this.canonical.y;return[new Lu(w,this.wrap,w,P,H),new Lu(w,this.wrap,w,P+1,H),new Lu(w,this.wrap,w,P,H+1),new Lu(w,this.wrap,w,P+1,H+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new Lu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new Lu(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Pd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(h){return this.canonical.getTilePoint(new B0(h.x-this.wrap,h.y))}}function ZA(_,h,w,P,H){(_*=2)<0&&(_=-1*_-1);const J=1<<w;return(J*J*_+J*H+P).toString(36)+w.toString(36)+h.toString(36)}En("CanonicalTileID",Rc),En("OverscaledTileID",Lu,{omit:["posMatrix"]});class Dd{constructor(h,w,P,H=1,J=1,ee=1,ge=0){if(this.uid=h,w.height!==w.width)throw new RangeError("DEM tiles must be square");if(P&&!["mapbox","terrarium","custom"].includes(P))return void ut(`"${P}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=w.height;const Te=this.dim=w.height-2;switch(this.data=new Uint32Array(w.data.buffer),P){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=H,this.greenFactor=J,this.blueFactor=ee,this.baseShift=ge;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Ne=0;Ne<Te;Ne++)this.data[this._idx(-1,Ne)]=this.data[this._idx(0,Ne)],this.data[this._idx(Te,Ne)]=this.data[this._idx(Te-1,Ne)],this.data[this._idx(Ne,-1)]=this.data[this._idx(Ne,0)],this.data[this._idx(Ne,Te)]=this.data[this._idx(Ne,Te-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Te,-1)]=this.data[this._idx(Te-1,0)],this.data[this._idx(-1,Te)]=this.data[this._idx(0,Te-1)],this.data[this._idx(Te,Te)]=this.data[this._idx(Te-1,Te-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Ne=0;Ne<Te;Ne++)for(let f=0;f<Te;f++){const u=this.get(Ne,f);u>this.max&&(this.max=u),u<this.min&&(this.min=u)}}get(h,w){const P=new Uint8Array(this.data.buffer),H=4*this._idx(h,w);return this.unpack(P[H],P[H+1],P[H+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(h,w){if(h<-1||h>=this.dim+1||w<-1||w>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(w+1)*this.stride+(h+1)}unpack(h,w,P){return h*this.redFactor+w*this.greenFactor+P*this.blueFactor-this.baseShift}getPixels(){return new qu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(h,w,P){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let H=w*this.dim,J=w*this.dim+this.dim,ee=P*this.dim,ge=P*this.dim+this.dim;switch(w){case-1:H=J-1;break;case 1:J=H+1}switch(P){case-1:ee=ge-1;break;case 1:ge=ee+1}const Te=-w*this.dim,Ne=-P*this.dim;for(let f=ee;f<ge;f++)for(let u=H;u<J;u++)this.data[this._idx(u,f)]=h.data[this._idx(u+Te,f+Ne)]}}En("DEMData",Dd);class Ld{constructor(h){this._stringToNumber={},this._numberToString=[];for(let w=0;w<h.length;w++){const P=h[w];this._stringToNumber[P]=w,this._numberToString[w]=P}}encode(h){return this._stringToNumber[h]}decode(h){if(h>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${h} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[h]}}class Bd{constructor(h,w,P,H,J){this.type="Feature",this._vectorTileFeature=h,h._z=w,h._x=P,h._y=H,this.properties=h.properties,this.id=J}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={geometry:this.geometry};for(const w in this)w!=="_geometry"&&w!=="_vectorTileFeature"&&(h[w]=this[w]);return h}}class R0{constructor(h,w){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Rn(ea,16,0),this.grid3D=new Rn(ea,16,0),this.featureIndexArray=new Y,this.promoteId=w}insert(h,w,P,H,J,ee){const ge=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(P,H,J);const Te=ee?this.grid3D:this.grid;for(let Ne=0;Ne<w.length;Ne++){const f=w[Ne],u=[1/0,1/0,-1/0,-1/0];for(let p=0;p<f.length;p++){const E=f[p];u[0]=Math.min(u[0],E.x),u[1]=Math.min(u[1],E.y),u[2]=Math.max(u[2],E.x),u[3]=Math.max(u[3],E.y)}u[0]<ea&&u[1]<ea&&u[2]>=0&&u[3]>=0&&Te.insert(ge,u[0],u[1],u[2],u[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new fc.VectorTile(new _d(this.rawTileData)).layers,this.sourceLayerCoder=new Ld(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(h,w,P,H){this.loadVTLayers();const J=h.params||{},ee=ea/h.tileSize/h.scale,ge=gs(J.filter),Te=h.queryGeometry,Ne=h.queryPadding*ee,f=zd(Te),u=this.grid.query(f.minX-Ne,f.minY-Ne,f.maxX+Ne,f.maxY+Ne),p=zd(h.cameraQueryGeometry),E=this.grid3D.query(p.minX-Ne,p.minY-Ne,p.maxX+Ne,p.maxY+Ne,(W,se,fe,ve)=>function(Be,He,it,pt,vt){for(const Lt of Be)if(He<=Lt.x&&it<=Lt.y&&pt>=Lt.x&&vt>=Lt.y)return!0;const Dt=[new oe(He,it),new oe(He,vt),new oe(pt,vt),new oe(pt,it)];if(Be.length>2){for(const Lt of Dt)if(Yc(Be,Lt))return!0}for(let Lt=0;Lt<Be.length-1;Lt++)if(Sp(Be[Lt],Be[Lt+1],Dt))return!0;return!1}(h.cameraQueryGeometry,W-Ne,se-Ne,fe+Ne,ve+Ne));for(const W of E)u.push(W);u.sort(Rd);const B={};let q;for(let W=0;W<u.length;W++){const se=u[W];if(se===q)continue;q=se;const fe=this.featureIndexArray.get(se);let ve=null;this.loadMatchingFeature(B,fe.bucketIndex,fe.sourceLayerIndex,fe.featureIndex,ge,J.layers,J.availableImages,w,P,H,(Be,He,it)=>(ve||(ve=nl(Be)),He.queryIntersectsFeature(Te,Be,it,ve,this.z,h.transform,ee,h.pixelPosMatrix)))}return B}loadMatchingFeature(h,w,P,H,J,ee,ge,Te,Ne,f,u){const p=this.bucketLayerIDs[w];if(ee&&!function(W,se){for(let fe=0;fe<W.length;fe++)if(se.indexOf(W[fe])>=0)return!0;return!1}(ee,p))return;const E=this.sourceLayerCoder.decode(P),B=this.vtLayers[E].feature(H);if(J.needGeometry){const W=xl(B,!0);if(!J.filter(new ys(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!J.filter(new ys(this.tileID.overscaledZ),B))return;const q=this.getId(B,E);for(let W=0;W<p.length;W++){const se=p[W];if(ee&&ee.indexOf(se)<0)continue;const fe=Te[se];if(!fe)continue;let ve={};q&&f&&(ve=f.getState(fe.sourceLayer||"_geojsonTileLayer",q));const Be=$t({},Ne[se]);Be.paint=Of(Be.paint,fe.paint,B,ve,ge),Be.layout=Of(Be.layout,fe.layout,B,ve,ge);const He=!u||u(B,fe,ve);if(!He)continue;const it=new Bd(B,this.z,this.x,this.y,q);it.layer=Be;let pt=h[se];pt===void 0&&(pt=h[se]=[]),pt.push({featureIndex:H,feature:it,intersectionZ:He})}}lookupSymbolFeatures(h,w,P,H,J,ee,ge,Te){const Ne={};this.loadVTLayers();const f=gs(J);for(const u of h)this.loadMatchingFeature(Ne,P,H,u,f,ee,ge,Te,w);return Ne}hasLayer(h){for(const w of this.bucketLayerIDs)for(const P of w)if(h===P)return!0;return!1}getId(h,w){let P=h.id;return this.promoteId&&(P=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[w]],typeof P=="boolean"&&(P=Number(P))),P}}function Of(_,h,w,P,H){return gt(_,(J,ee)=>{const ge=h instanceof vs?h.get(ee):null;return ge&&ge.evaluate?ge.evaluate(w,P,H):ge})}function zd(_){let h=1/0,w=1/0,P=-1/0,H=-1/0;for(const J of _)h=Math.min(h,J.x),w=Math.min(w,J.y),P=Math.max(P,J.x),H=Math.max(H,J.y);return{minX:h,minY:w,maxX:P,maxY:H}}function Rd(_,h){return h-_}function Fd(_,h,w,P,H){const J=[];for(let ee=0;ee<_.length;ee++){const ge=_[ee];let Te;for(let Ne=0;Ne<ge.length-1;Ne++){let f=ge[Ne],u=ge[Ne+1];f.x<h&&u.x<h||(f.x<h?f=new oe(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x<h&&(u=new oe(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y<w&&u.y<w||(f.y<w?f=new oe(f.x+(w-f.y)/(u.y-f.y)*(u.x-f.x),w)._round():u.y<w&&(u=new oe(f.x+(w-f.y)/(u.y-f.y)*(u.x-f.x),w)._round()),f.x>=P&&u.x>=P||(f.x>=P?f=new oe(P,f.y+(P-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x>=P&&(u=new oe(P,f.y+(P-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y>=H&&u.y>=H||(f.y>=H?f=new oe(f.x+(H-f.y)/(u.y-f.y)*(u.x-f.x),H)._round():u.y>=H&&(u=new oe(f.x+(H-f.y)/(u.y-f.y)*(u.x-f.x),H)._round()),Te&&f.equals(Te[Te.length-1])||(Te=[f],J.push(Te)),Te.push(u)))))}}return J}En("FeatureIndex",R0,{omit:["rawTileData","sourceLayerCoder"]});class wl extends oe{constructor(h,w,P,H){super(h,w),this.angle=P,H!==void 0&&(this.segment=H)}clone(){return new wl(this.x,this.y,this.angle,this.segment)}}function QA(_,h,w,P,H){if(h.segment===void 0||w===0)return!0;let J=h,ee=h.segment+1,ge=0;for(;ge>-w/2;){if(ee--,ee<0)return!1;ge-=_[ee].dist(J),J=_[ee]}ge+=_[ee].dist(_[ee+1]),ee++;const Te=[];let Ne=0;for(;ge<w/2;){const f=_[ee],u=_[ee+1];if(!u)return!1;let p=_[ee-1].angleTo(f)-f.angleTo(u);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),Te.push({distance:ge,angleDelta:p}),Ne+=p;ge-Te[0].distance>P;)Ne-=Te.shift().angleDelta;if(Ne>H)return!1;ee++,ge+=f.dist(u)}return!0}function F0(_){let h=0;for(let w=0;w<_.length-1;w++)h+=_[w].dist(_[w+1]);return h}function O0(_,h,w){return _?.6*h*w:0}function Od(_,h){return Math.max(_?_.right-_.left:0,h?h.right-h.left:0)}function Hp(_,h,w,P,H,J){const ee=O0(w,H,J),ge=Od(w,P)*J;let Te=0;const Ne=F0(_)/2;for(let f=0;f<_.length-1;f++){const u=_[f],p=_[f+1],E=u.dist(p);if(Te+E>Ne){const B=(Ne-Te)/E,q=Sr.number(u.x,p.x,B),W=Sr.number(u.y,p.y,B),se=new wl(q,W,p.angleTo(u),f);return se._round(),!ee||QA(_,se,ge,ee,h)?se:void 0}Te+=E}}function jp(_,h,w,P,H,J,ee,ge,Te){const Ne=O0(P,J,ee),f=Od(P,H),u=f*ee,p=_[0].x===0||_[0].x===Te||_[0].y===0||_[0].y===Te;return h-u<h/4&&(h=u+h/4),Nd(_,p?h/2*ge%h:(f/2+2*J)*ee*ge%h,h,Ne,w,u,p,!1,Te)}function Nd(_,h,w,P,H,J,ee,ge,Te){const Ne=J/2,f=F0(_);let u=0,p=h-w,E=[];for(let B=0;B<_.length-1;B++){const q=_[B],W=_[B+1],se=q.dist(W),fe=W.angleTo(q);for(;p+w<u+se;){p+=w;const ve=(p-u)/se,Be=Sr.number(q.x,W.x,ve),He=Sr.number(q.y,W.y,ve);if(Be>=0&&Be<Te&&He>=0&&He<Te&&p-Ne>=0&&p+Ne<=f){const it=new wl(Be,He,fe,B);it._round(),P&&!QA(_,it,J,P,H)||E.push(it)}}u+=se}return ge||E.length||ee||(E=Nd(_,u/2,w,P,H,J,ee,!0,Te)),E}En("Anchor",wl);const uh=dl;function Vd(_,h,w,P){const H=[],J=_.image,ee=J.pixelRatio,ge=J.paddedRect.w-2*uh,Te=J.paddedRect.h-2*uh,Ne=_.right-_.left,f=_.bottom-_.top,u=J.stretchX||[[0,ge]],p=J.stretchY||[[0,Te]],E=(Rt,ei)=>Rt+ei[1]-ei[0],B=u.reduce(E,0),q=p.reduce(E,0),W=ge-B,se=Te-q;let fe=0,ve=B,Be=0,He=q,it=0,pt=W,vt=0,Dt=se;if(J.content&&P){const Rt=J.content;fe=dc(u,0,Rt[0]),Be=dc(p,0,Rt[1]),ve=dc(u,Rt[0],Rt[2]),He=dc(p,Rt[1],Rt[3]),it=Rt[0]-fe,vt=Rt[1]-Be,pt=Rt[2]-Rt[0]-ve,Dt=Rt[3]-Rt[1]-He}const Lt=(Rt,ei,Zt,Wt)=>{const hi=Nf(Rt.stretch-fe,ve,Ne,_.left),vi=Vf(Rt.fixed-it,pt,Rt.stretch,B),Ji=Nf(ei.stretch-Be,He,f,_.top),In=Vf(ei.fixed-vt,Dt,ei.stretch,q),un=Nf(Zt.stretch-fe,ve,Ne,_.left),ln=Vf(Zt.fixed-it,pt,Zt.stretch,B),dn=Nf(Wt.stretch-Be,He,f,_.top),Vn=Vf(Wt.fixed-vt,Dt,Wt.stretch,q),on=new oe(hi,Ji),Ki=new oe(un,Ji),Fn=new oe(un,dn),Un=new oe(hi,dn),gr=new oe(vi/ee,In/ee),jr=new oe(ln/ee,Vn/ee),Xr=h*Math.PI/180;if(Xr){const la=Math.sin(Xr),us=Math.cos(Xr),Yn=[us,-la,la,us];on._matMult(Yn),Ki._matMult(Yn),Un._matMult(Yn),Fn._matMult(Yn)}const Us=Rt.stretch+Rt.fixed,Da=ei.stretch+ei.fixed;return{tl:on,tr:Ki,bl:Un,br:Fn,tex:{x:J.paddedRect.x+uh+Us,y:J.paddedRect.y+uh+Da,w:Zt.stretch+Zt.fixed-Us,h:Wt.stretch+Wt.fixed-Da},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:gr,pixelOffsetBR:jr,minFontScaleX:pt/ee/Ne,minFontScaleY:Dt/ee/f,isSDF:w}};if(P&&(J.stretchX||J.stretchY)){const Rt=Ud(u,W,B),ei=Ud(p,se,q);for(let Zt=0;Zt<Rt.length-1;Zt++){const Wt=Rt[Zt],hi=Rt[Zt+1];for(let vi=0;vi<ei.length-1;vi++)H.push(Lt(Wt,ei[vi],hi,ei[vi+1]))}}else H.push(Lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:ge+1},{fixed:0,stretch:Te+1}));return H}function dc(_,h,w){let P=0;for(const H of _)P+=Math.max(h,Math.min(w,H[1]))-Math.max(h,Math.min(w,H[0]));return P}function Ud(_,h,w){const P=[{fixed:-uh,stretch:0}];for(const[H,J]of _){const ee=P[P.length-1];P.push({fixed:H-ee.stretch,stretch:ee.stretch}),P.push({fixed:H-ee.stretch,stretch:ee.stretch+(J-H)})}return P.push({fixed:h+uh,stretch:w}),P}function Nf(_,h,w,P){return _/h*w+P}function Vf(_,h,w,P){return _-h*w/P}class Uf{constructor(h,w,P,H,J,ee,ge,Te,Ne,f){if(this.boxStartIndex=h.length,Ne){let u=ee.top,p=ee.bottom;const E=ee.collisionPadding;E&&(u-=E[1],p+=E[3]);let B=p-u;B>0&&(B=Math.max(10,B),this.circleDiameter=B)}else{let u=ee.top*ge-Te[0],p=ee.bottom*ge+Te[2],E=ee.left*ge-Te[3],B=ee.right*ge+Te[1];const q=ee.collisionPadding;if(q&&(E-=q[0]*ge,u-=q[1]*ge,B+=q[2]*ge,p+=q[3]*ge),f){const W=new oe(E,u),se=new oe(B,u),fe=new oe(E,p),ve=new oe(B,p),Be=f*Math.PI/180;W._rotate(Be),se._rotate(Be),fe._rotate(Be),ve._rotate(Be),E=Math.min(W.x,se.x,fe.x,ve.x),B=Math.max(W.x,se.x,fe.x,ve.x),u=Math.min(W.y,se.y,fe.y,ve.y),p=Math.max(W.y,se.y,fe.y,ve.y)}h.emplaceBack(w.x,w.y,E,u,B,p,P,H,J)}this.boxEndIndex=h.length}}class Zm{constructor(h=[],w=Qm){if(this.data=h,this.length=this.data.length,this.compare=w,this.length>0)for(let P=(this.length>>1)-1;P>=0;P--)this._down(P)}push(h){this.data.push(h),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const h=this.data[0],w=this.data.pop();return this.length--,this.length>0&&(this.data[0]=w,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:w,compare:P}=this,H=w[h];for(;h>0;){const J=h-1>>1,ee=w[J];if(P(H,ee)>=0)break;w[h]=ee,h=J}w[h]=H}_down(h){const{data:w,compare:P}=this,H=this.length>>1,J=w[h];for(;h<H;){let ee=1+(h<<1),ge=w[ee];const Te=ee+1;if(Te<this.length&&P(w[Te],ge)<0&&(ee=Te,ge=w[Te]),P(ge,J)>=0)break;w[h]=ge,h=ee}w[h]=J}}function Qm(_,h){return _<h?-1:_>h?1:0}function Zp(_,h=1,w=!1){let P=1/0,H=1/0,J=-1/0,ee=-1/0;const ge=_[0];for(let E=0;E<ge.length;E++){const B=ge[E];(!E||B.x<P)&&(P=B.x),(!E||B.y<H)&&(H=B.y),(!E||B.x>J)&&(J=B.x),(!E||B.y>ee)&&(ee=B.y)}const Te=Math.min(J-P,ee-H);let Ne=Te/2;const f=new Zm([],WA);if(Te===0)return new oe(P,H);for(let E=P;E<J;E+=Te)for(let B=H;B<ee;B+=Te)f.push(new sA(E+Ne,B+Ne,Ne,_));let u=function(E){let B=0,q=0,W=0;const se=E[0];for(let fe=0,ve=se.length,Be=ve-1;fe<ve;Be=fe++){const He=se[fe],it=se[Be],pt=He.x*it.y-it.x*He.y;q+=(He.x+it.x)*pt,W+=(He.y+it.y)*pt,B+=3*pt}return new sA(q/B,W/B,0,E)}(_),p=f.length;for(;f.length;){const E=f.pop();(E.d>u.d||!u.d)&&(u=E,w&&console.log("found best %d after %d probes",Math.round(1e4*E.d)/1e4,p)),E.max-u.d<=h||(Ne=E.h/2,f.push(new sA(E.p.x-Ne,E.p.y-Ne,Ne,_)),f.push(new sA(E.p.x+Ne,E.p.y-Ne,Ne,_)),f.push(new sA(E.p.x-Ne,E.p.y+Ne,Ne,_)),f.push(new sA(E.p.x+Ne,E.p.y+Ne,Ne,_)),p+=4)}return w&&(console.log(`num probes: ${p}`),console.log(`best distance: ${u.d}`)),u.p}function WA(_,h){return h.max-_.max}function sA(_,h,w,P){this.p=new oe(_,h),this.h=w,this.d=function(H,J){let ee=!1,ge=1/0;for(let Te=0;Te<J.length;Te++){const Ne=J[Te];for(let f=0,u=Ne.length,p=u-1;f<u;p=f++){const E=Ne[f],B=Ne[p];E.y>H.y!=B.y>H.y&&H.x<(B.x-E.x)*(H.y-E.y)/(B.y-E.y)+E.x&&(ee=!ee),ge=Math.min(ge,jh(H,E,B))}}return(ee?1:-1)*Math.sqrt(ge)}(this.p,P),this.max=this.d+this.h*Math.SQRT2}var Fo;S.ap=void 0,(Fo=S.ap||(S.ap={}))[Fo.center=1]="center",Fo[Fo.left=2]="left",Fo[Fo.right=3]="right",Fo[Fo.top=4]="top",Fo[Fo.bottom=5]="bottom",Fo[Fo["top-left"]=6]="top-left",Fo[Fo["top-right"]=7]="top-right",Fo[Fo["bottom-left"]=8]="bottom-left",Fo[Fo["bottom-right"]=9]="bottom-right";const ch=7,aA=Number.POSITIVE_INFINITY;function $A(_,h){return h[1]!==aA?function(w,P,H){let J=0,ee=0;switch(P=Math.abs(P),H=Math.abs(H),w){case"top-right":case"top-left":case"top":ee=H-ch;break;case"bottom-right":case"bottom-left":case"bottom":ee=-H+ch}switch(w){case"top-right":case"bottom-right":case"right":J=-P;break;case"top-left":case"bottom-left":case"left":J=P}return[J,ee]}(_,h[0],h[1]):function(w,P){let H=0,J=0;P<0&&(P=0);const ee=P/Math.SQRT2;switch(w){case"top-right":case"top-left":J=ee-ch;break;case"bottom-right":case"bottom-left":J=-ee+ch;break;case"bottom":J=-P+ch;break;case"top":J=P-ch}switch(w){case"top-right":case"bottom-right":H=-ee;break;case"top-left":case"bottom-left":H=ee;break;case"left":H=P;break;case"right":H=-P}return[H,J]}(_,h[0])}function oA(_,h,w){var P;const H=_.layout,J=(P=H.get("text-variable-anchor-offset"))===null||P===void 0?void 0:P.evaluate(h,{},w);if(J){const ge=J.values,Te=[];for(let Ne=0;Ne<ge.length;Ne+=2){const f=Te[Ne]=ge[Ne],u=ge[Ne+1].map(p=>p*fl);f.startsWith("top")?u[1]-=ch:f.startsWith("bottom")&&(u[1]+=ch),Te[Ne+1]=u}return new Xt(Te)}const ee=H.get("text-variable-anchor");if(ee){let ge;ge=_._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[H.get("text-radial-offset").evaluate(h,{},w)*fl,aA]:H.get("text-offset").evaluate(h,{},w).map(Ne=>Ne*fl);const Te=[];for(const Ne of ee)Te.push(Ne,$A(Ne,ge));return new Xt(Te)}return null}function N0(_){switch(_){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Qp(_,h,w,P,H,J,ee,ge,Te,Ne,f){let u=J.textMaxSize.evaluate(h,{});u===void 0&&(u=ee);const p=_.layers[0].layout,E=p.get("icon-offset").evaluate(h,{},f),B=qd(w.horizontal),q=ee/24,W=_.tilePixelRatio*q,se=_.tilePixelRatio*u/24,fe=_.tilePixelRatio*ge,ve=_.tilePixelRatio*p.get("symbol-spacing"),Be=p.get("text-padding")*_.tilePixelRatio,He=function(Wt,hi,vi,Ji=1){const In=Wt.get("icon-padding").evaluate(hi,{},vi),un=In&&In.values;return[un[0]*Ji,un[1]*Ji,un[2]*Ji,un[3]*Ji]}(p,h,f,_.tilePixelRatio),it=p.get("text-max-angle")/180*Math.PI,pt=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",vt=p.get("icon-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point",Dt=p.get("symbol-placement"),Lt=ve/2,Rt=p.get("icon-text-fit");let ei;P&&Rt!=="none"&&(_.allowVerticalPlacement&&w.vertical&&(ei=xd(P,w.vertical,Rt,p.get("icon-text-fit-padding"),E,q)),B&&(P=xd(P,B,Rt,p.get("icon-text-fit-padding"),E,q)));const Zt=(Wt,hi)=>{hi.x<0||hi.x>=ea||hi.y<0||hi.y>=ea||function(vi,Ji,In,un,ln,dn,Vn,on,Ki,Fn,Un,gr,jr,Xr,Us,Da,la,us,Yn,Ts,rr,ua,Rs,tr,Ga){const ao=vi.addToLineVertexArray(Ji,In);let Ia,Ho,po,ca,Er=0,Eo=0,rl=0,sl=0,Bu=-1,Hu=-1;const Ol={};let Oc=nr("");if(vi.allowVerticalPlacement&&un.vertical){const nu=on.layout.get("text-rotate").evaluate(rr,{},tr)+90;po=new Uf(Ki,Ji,Fn,Un,gr,un.vertical,jr,Xr,Us,nu),Vn&&(ca=new Uf(Ki,Ji,Fn,Un,gr,Vn,la,us,Us,nu))}if(ln){const nu=on.layout.get("icon-rotate").evaluate(rr,{}),Qu=on.layout.get("icon-text-fit")!=="none",Dh=Vd(ln,nu,Rs,Qu),pc=Vn?Vd(Vn,nu,Rs,Qu):void 0;Ho=new Uf(Ki,Ji,Fn,Un,gr,ln,la,us,!1,nu),Er=4*Dh.length;const ru=vi.iconSizeData;let Wu=null;ru.kind==="source"?(Wu=[Bc*on.layout.get("icon-size").evaluate(rr,{})],Wu[0]>ah&&ut(`${vi.layerIds[0]}: Value for "icon-size" is >= ${Mh}. Reduce your "icon-size".`)):ru.kind==="composite"&&(Wu=[Bc*ua.compositeIconSizes[0].evaluate(rr,{},tr),Bc*ua.compositeIconSizes[1].evaluate(rr,{},tr)],(Wu[0]>ah||Wu[1]>ah)&&ut(`${vi.layerIds[0]}: Value for "icon-size" is >= ${Mh}. Reduce your "icon-size".`)),vi.addSymbols(vi.icon,Dh,Wu,Ts,Yn,rr,S.ah.none,Ji,ao.lineStartIndex,ao.lineLength,-1,tr),Bu=vi.icon.placedSymbolArray.length-1,pc&&(Eo=4*pc.length,vi.addSymbols(vi.icon,pc,Wu,Ts,Yn,rr,S.ah.vertical,Ji,ao.lineStartIndex,ao.lineLength,-1,tr),Hu=vi.icon.placedSymbolArray.length-1)}const ju=Object.keys(un.horizontal);for(const nu of ju){const Qu=un.horizontal[nu];if(!Ia){Oc=nr(Qu.text);const pc=on.layout.get("text-rotate").evaluate(rr,{},tr);Ia=new Uf(Ki,Ji,Fn,Un,gr,Qu,jr,Xr,Us,pc)}const Dh=Qu.positionedLines.length===1;if(rl+=Gd(vi,Ji,Qu,dn,on,Us,rr,Da,ao,un.vertical?S.ah.horizontal:S.ah.horizontalOnly,Dh?ju:[nu],Ol,Bu,ua,tr),Dh)break}un.vertical&&(sl+=Gd(vi,Ji,un.vertical,dn,on,Us,rr,Da,ao,S.ah.vertical,["vertical"],Ol,Hu,ua,tr));const Zu=Ia?Ia.boxStartIndex:vi.collisionBoxArray.length,iu=Ia?Ia.boxEndIndex:vi.collisionBoxArray.length,hh=po?po.boxStartIndex:vi.collisionBoxArray.length,lA=po?po.boxEndIndex:vi.collisionBoxArray.length,$p=Ho?Ho.boxStartIndex:vi.collisionBoxArray.length,Hd=Ho?Ho.boxEndIndex:vi.collisionBoxArray.length,jd=ca?ca.boxStartIndex:vi.collisionBoxArray.length,mo=ca?ca.boxEndIndex:vi.collisionBoxArray.length;let Co=-1;const Wf=(nu,Qu)=>nu&&nu.circleDiameter?Math.max(nu.circleDiameter,Qu):Qu;Co=Wf(Ia,Co),Co=Wf(po,Co),Co=Wf(Ho,Co),Co=Wf(ca,Co);const Xp=Co>-1?1:0;Xp&&(Co*=Ga/fl),vi.glyphOffsetArray.length>=rA.MAX_GLYPHS&&ut("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),rr.sortKey!==void 0&&vi.addToSortKeyRanges(vi.symbolInstances.length,rr.sortKey);const Wm=oA(on,rr,tr),[Yp,$m]=function(nu,Qu){const Dh=nu.length,pc=Qu==null?void 0:Qu.values;if((pc==null?void 0:pc.length)>0)for(let ru=0;ru<pc.length;ru+=2){const Wu=pc[ru+1];nu.emplaceBack(S.ap[pc[ru]],Wu[0],Wu[1])}return[Dh,nu.length]}(vi.textAnchorOffsets,Wm);vi.symbolInstances.emplaceBack(Ji.x,Ji.y,Ol.right>=0?Ol.right:-1,Ol.center>=0?Ol.center:-1,Ol.left>=0?Ol.left:-1,Ol.vertical||-1,Bu,Hu,Oc,Zu,iu,hh,lA,$p,Hd,jd,mo,Fn,rl,sl,Er,Eo,Xp,0,jr,Co,Yp,$m)}(_,hi,Wt,w,P,H,ei,_.layers[0],_.collisionBoxArray,h.index,h.sourceLayerIndex,_.index,W,[Be,Be,Be,Be],pt,Te,fe,He,vt,E,h,J,Ne,f,ee)};if(Dt==="line")for(const Wt of Fd(h.geometry,0,0,ea,ea)){const hi=jp(Wt,ve,it,w.vertical||B,P,24,se,_.overscaling,ea);for(const vi of hi)B&&XA(_,B.text,Lt,vi)||Zt(Wt,vi)}else if(Dt==="line-center"){for(const Wt of h.geometry)if(Wt.length>1){const hi=Hp(Wt,it,w.vertical||B,P,24,se);hi&&Zt(Wt,hi)}}else if(h.type==="Polygon")for(const Wt of Sh(h.geometry,0)){const hi=Zp(Wt,16);Zt(Wt[0],new wl(hi.x,hi.y,0))}else if(h.type==="LineString")for(const Wt of h.geometry)Zt(Wt,new wl(Wt[0].x,Wt[0].y,0));else if(h.type==="Point")for(const Wt of h.geometry)for(const hi of Wt)Zt([hi],new wl(hi.x,hi.y,0))}function Gd(_,h,w,P,H,J,ee,ge,Te,Ne,f,u,p,E,B){const q=function(fe,ve,Be,He,it,pt,vt,Dt){const Lt=He.layout.get("text-rotate").evaluate(pt,{})*Math.PI/180,Rt=[];for(const ei of ve.positionedLines)for(const Zt of ei.positionedGlyphs){if(!Zt.rect)continue;const Wt=Zt.rect||{};let hi=vd+1,vi=!0,Ji=1,In=0;const un=(it||Dt)&&Zt.vertical,ln=Zt.metrics.advance*Zt.scale/2;if(Dt&&ve.verticalizable&&(In=ei.lineOffset/2-(Zt.imageName?-(fl-Zt.metrics.width*Zt.scale)/2:(Zt.scale-1)*fl)),Zt.imageName){const Ts=vt[Zt.imageName];vi=Ts.sdf,Ji=Ts.pixelRatio,hi=dl/Ji}const dn=it?[Zt.x+ln,Zt.y]:[0,0];let Vn=it?[0,0]:[Zt.x+ln+Be[0],Zt.y+Be[1]-In],on=[0,0];un&&(on=Vn,Vn=[0,0]);const Ki=Zt.metrics.isDoubleResolution?2:1,Fn=(Zt.metrics.left-hi)*Zt.scale-ln+Vn[0],Un=(-Zt.metrics.top-hi)*Zt.scale+Vn[1],gr=Fn+Wt.w/Ki*Zt.scale/Ji,jr=Un+Wt.h/Ki*Zt.scale/Ji,Xr=new oe(Fn,Un),Us=new oe(gr,Un),Da=new oe(Fn,jr),la=new oe(gr,jr);if(un){const Ts=new oe(-ln,ln-OA),rr=-Math.PI/2,ua=fl/2-ln,Rs=new oe(5-OA-ua,-(Zt.imageName?ua:0)),tr=new oe(...on);Xr._rotateAround(rr,Ts)._add(Rs)._add(tr),Us._rotateAround(rr,Ts)._add(Rs)._add(tr),Da._rotateAround(rr,Ts)._add(Rs)._add(tr),la._rotateAround(rr,Ts)._add(Rs)._add(tr)}if(Lt){const Ts=Math.sin(Lt),rr=Math.cos(Lt),ua=[rr,-Ts,Ts,rr];Xr._matMult(ua),Us._matMult(ua),Da._matMult(ua),la._matMult(ua)}const us=new oe(0,0),Yn=new oe(0,0);Rt.push({tl:Xr,tr:Us,bl:Da,br:la,tex:Wt,writingMode:ve.writingMode,glyphOffset:dn,sectionIndex:Zt.sectionIndex,isSDF:vi,pixelOffsetTL:us,pixelOffsetBR:Yn,minFontScaleX:0,minFontScaleY:0})}return Rt}(0,w,ge,H,J,ee,P,_.allowVerticalPlacement),W=_.textSizeData;let se=null;W.kind==="source"?(se=[Bc*H.layout.get("text-size").evaluate(ee,{})],se[0]>ah&&ut(`${_.layerIds[0]}: Value for "text-size" is >= ${Mh}. Reduce your "text-size".`)):W.kind==="composite"&&(se=[Bc*E.compositeTextSizes[0].evaluate(ee,{},B),Bc*E.compositeTextSizes[1].evaluate(ee,{},B)],(se[0]>ah||se[1]>ah)&&ut(`${_.layerIds[0]}: Value for "text-size" is >= ${Mh}. Reduce your "text-size".`)),_.addSymbols(_.text,q,se,ge,J,ee,Ne,h,Te.lineStartIndex,Te.lineLength,p,B);for(const fe of f)u[fe]=_.text.placedSymbolArray.length-1;return 4*q.length}function qd(_){for(const h in _)return _[h];return null}function XA(_,h,w,P){const H=_.compareText;if(h in H){const J=H[h];for(let ee=J.length-1;ee>=0;ee--)if(P.dist(J[ee])<w)return!0}else H[h]=[];return H[h].push(P),!1}const Fl=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Fc{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[w,P]=new Uint8Array(h,0,2);if(w!==219)throw new Error("Data does not appear to be in a KDBush format.");const H=P>>4;if(H!==1)throw new Error(`Got v${H} data when expected v1.`);const J=Fl[15&P];if(!J)throw new Error("Unrecognized array type.");const[ee]=new Uint16Array(h,2,1),[ge]=new Uint32Array(h,4,1);return new Fc(ge,ee,J,h)}constructor(h,w=64,P=Float64Array,H){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+w,2),65535),this.ArrayType=P,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const J=Fl.indexOf(this.ArrayType),ee=2*h*this.ArrayType.BYTES_PER_ELEMENT,ge=h*this.IndexArrayType.BYTES_PER_ELEMENT,Te=(8-ge%8)%8;if(J<0)throw new Error(`Unexpected typed array class: ${P}.`);H&&H instanceof ArrayBuffer?(this.data=H,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+ge+Te,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+ee+ge+Te),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+ge+Te,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+J]),new Uint16Array(this.data,2,1)[0]=w,new Uint32Array(this.data,4,1)[0]=h)}add(h,w){const P=this._pos>>1;return this.ids[P]=P,this.coords[this._pos++]=h,this.coords[this._pos++]=w,P}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return Ph(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,w,P,H){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:J,coords:ee,nodeSize:ge}=this,Te=[0,J.length-1,0],Ne=[];for(;Te.length;){const f=Te.pop()||0,u=Te.pop()||0,p=Te.pop()||0;if(u-p<=ge){for(let W=p;W<=u;W++){const se=ee[2*W],fe=ee[2*W+1];se>=h&&se<=P&&fe>=w&&fe<=H&&Ne.push(J[W])}continue}const E=p+u>>1,B=ee[2*E],q=ee[2*E+1];B>=h&&B<=P&&q>=w&&q<=H&&Ne.push(J[E]),(f===0?h<=B:w<=q)&&(Te.push(p),Te.push(E-1),Te.push(1-f)),(f===0?P>=B:H>=q)&&(Te.push(E+1),Te.push(u),Te.push(1-f))}return Ne}within(h,w,P){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:H,coords:J,nodeSize:ee}=this,ge=[0,H.length-1,0],Te=[],Ne=P*P;for(;ge.length;){const f=ge.pop()||0,u=ge.pop()||0,p=ge.pop()||0;if(u-p<=ee){for(let W=p;W<=u;W++)V0(J[2*W],J[2*W+1],h,w)<=Ne&&Te.push(H[W]);continue}const E=p+u>>1,B=J[2*E],q=J[2*E+1];V0(B,q,h,w)<=Ne&&Te.push(H[E]),(f===0?h-P<=B:w-P<=q)&&(ge.push(p),ge.push(E-1),ge.push(1-f)),(f===0?h+P>=B:w+P>=q)&&(ge.push(E+1),ge.push(u),ge.push(1-f))}return Te}}function Ph(_,h,w,P,H,J){if(H-P<=w)return;const ee=P+H>>1;YA(_,h,ee,P,H,J),Ph(_,h,w,P,ee-1,1-J),Ph(_,h,w,ee+1,H,1-J)}function YA(_,h,w,P,H,J){for(;H>P;){if(H-P>600){const Ne=H-P+1,f=w-P+1,u=Math.log(Ne),p=.5*Math.exp(2*u/3),E=.5*Math.sqrt(u*p*(Ne-p)/Ne)*(f-Ne/2<0?-1:1);YA(_,h,w,Math.max(P,Math.floor(w-f*p/Ne+E)),Math.min(H,Math.floor(w+(Ne-f)*p/Ne+E)),J)}const ee=h[2*w+J];let ge=P,Te=H;for(KA(_,h,P,w),h[2*H+J]>ee&&KA(_,h,P,H);ge<Te;){for(KA(_,h,ge,Te),ge++,Te--;h[2*ge+J]<ee;)ge++;for(;h[2*Te+J]>ee;)Te--}h[2*P+J]===ee?KA(_,h,P,Te):(Te++,KA(_,h,Te,H)),Te<=w&&(P=Te+1),w<=Te&&(H=Te-1)}}function KA(_,h,w,P){Gf(_,w,P),Gf(h,2*w,2*P),Gf(h,2*w+1,2*P+1)}function Gf(_,h,w){const P=_[h];_[h]=_[w],_[w]=P}function V0(_,h,w,P){const H=_-w,J=h-P;return H*H+J*J}var qf;S.bc=void 0,(qf=S.bc||(S.bc={})).create="create",qf.load="load",qf.fullLoad="fullLoad";let Hf=null,jf=[];const U0=1e3/60,Zf="loadTime",Qf="fullLoadTime",Wp={mark(_){performance.mark(_)},frame(_){const h=_;Hf!=null&&jf.push(h-Hf),Hf=h},clearMetrics(){Hf=null,jf=[],performance.clearMeasures(Zf),performance.clearMeasures(Qf);for(const _ in S.bc)performance.clearMarks(S.bc[_])},getPerformanceMetrics(){performance.measure(Zf,S.bc.create,S.bc.load),performance.measure(Qf,S.bc.create,S.bc.fullLoad);const _=performance.getEntriesByName(Zf)[0].duration,h=performance.getEntriesByName(Qf)[0].duration,w=jf.length,P=1/(jf.reduce((J,ee)=>J+ee,0)/w/1e3),H=jf.filter(J=>J>U0).reduce((J,ee)=>J+(ee-U0)/U0,0);return{loadTime:_,fullLoadTime:h,fps:P,percentDroppedFrames:H/(w+H)*100,totalFrames:w}}};S.$=$i,S.A=Ju,S.B=function(_){if(Ut==null){const h=_.navigator?_.navigator.userAgent:null;Ut=!!_.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Ut},S.C=class{constructor(_,h){this.target=_,this.mapId=h,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Vp(()=>this.process()),this.subscription=function(w,P,H,J){return w.addEventListener(P,H,!1),{unsubscribe:()=>{w.removeEventListener(P,H,!1)}}}(this.target,"message",w=>this.receive(w)),this.globalScope=ct(self)?_:window}registerMessageHandler(_,h){this.messageHandlers[_]=h}sendAsync(_,h){return new Promise((w,P)=>{const H=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[H]={resolve:w,reject:P},h&&h.signal.addEventListener("abort",()=>{delete this.resolveRejects[H];const ge={id:H,type:"<cancel>",origin:location.origin,targetMapId:_.targetMapId,sourceMapId:this.mapId};this.target.postMessage(ge)},{once:!0});const J=[],ee=Object.assign(Object.assign({},_),{id:H,sourceMapId:this.mapId,origin:location.origin,data:Gl(_.data,J)});this.target.postMessage(ee,{transfer:J})})}receive(_){const h=_.data,w=h.id;if(!(h.origin!=="file://"&&location.origin!=="file://"&&h.origin!==location.origin||h.targetMapId&&this.mapId!==h.targetMapId)){if(h.type==="<cancel>"){delete this.tasks[w];const P=this.abortControllers[w];return delete this.abortControllers[w],void(P&&P.abort())}if(ct(self)||h.mustQueue)return this.tasks[w]=h,this.taskQueue.push(w),void this.invoker.trigger();this.processTask(w,h)}}process(){if(this.taskQueue.length===0)return;const _=this.taskQueue.shift(),h=this.tasks[_];delete this.tasks[_],this.taskQueue.length>0&&this.invoker.trigger(),h&&this.processTask(_,h)}processTask(_,h){return a(this,void 0,void 0,function*(){if(h.type==="<response>"){const H=this.resolveRejects[_];return delete this.resolveRejects[_],H?void(h.error?H.reject(Cn(h.error)):H.resolve(Cn(h.data))):void 0}if(!this.messageHandlers[h.type])return void this.completeTask(_,new Error(`Could not find a registered handler for ${h.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const w=Cn(h.data),P=new AbortController;this.abortControllers[_]=P;try{const H=yield this.messageHandlers[h.type](h.sourceMapId,w,P);this.completeTask(_,null,H)}catch(H){this.completeTask(_,H)}})}completeTask(_,h,w){const P=[];delete this.abortControllers[_];const H={id:_,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:h?Gl(h):null,data:Gl(w,P)};this.target.postMessage(H,{transfer:P})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},S.D=gn,S.E=Bn,S.F=function(){var _=new Ju(16);return Ju!=Float32Array&&(_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[11]=0,_[12]=0,_[13]=0,_[14]=0),_[0]=1,_[5]=1,_[10]=1,_[15]=1,_},S.G=sn,S.H=function(_,h,w){var P,H,J,ee,ge,Te,Ne,f,u,p,E,B,q=w[0],W=w[1],se=w[2];return h===_?(_[12]=h[0]*q+h[4]*W+h[8]*se+h[12],_[13]=h[1]*q+h[5]*W+h[9]*se+h[13],_[14]=h[2]*q+h[6]*W+h[10]*se+h[14],_[15]=h[3]*q+h[7]*W+h[11]*se+h[15]):(H=h[1],J=h[2],ee=h[3],ge=h[4],Te=h[5],Ne=h[6],f=h[7],u=h[8],p=h[9],E=h[10],B=h[11],_[0]=P=h[0],_[1]=H,_[2]=J,_[3]=ee,_[4]=ge,_[5]=Te,_[6]=Ne,_[7]=f,_[8]=u,_[9]=p,_[10]=E,_[11]=B,_[12]=P*q+ge*W+u*se+h[12],_[13]=H*q+Te*W+p*se+h[13],_[14]=J*q+Ne*W+E*se+h[14],_[15]=ee*q+f*W+B*se+h[15]),_},S.I=C0,S.J=function(_,h,w){var P=w[0],H=w[1],J=w[2];return _[0]=h[0]*P,_[1]=h[1]*P,_[2]=h[2]*P,_[3]=h[3]*P,_[4]=h[4]*H,_[5]=h[5]*H,_[6]=h[6]*H,_[7]=h[7]*H,_[8]=h[8]*J,_[9]=h[9]*J,_[10]=h[10]*J,_[11]=h[11]*J,_[12]=h[12],_[13]=h[13],_[14]=h[14],_[15]=h[15],_},S.K=xh,S.L=function(_,h){const w={};for(let P=0;P<h.length;P++){const H=h[P];H in _&&(w[H]=_[H])}return w},S.M=lh,S.N=kd,S.O=Md,S.P=oe,S.Q=Lu,S.R=qu,S.S=st,S.T=xu,S.U=ht,S.V=yi,S.W=ea,S.X=Es,S.Y=B0,S.Z=class extends Al{},S._=a,S.a=Zi,S.a$=function(_,h){return _[0]*h[0]+_[1]*h[1]+_[2]*h[2]+_[3]*h[3]},S.a0=Rc,S.a1=K,S.a2=_=>{const h=window.document.createElement("video");return h.muted=!0,new Promise(w=>{h.onloadstart=()=>{w(h)};for(const P of _){const H=window.document.createElement("source");Oi(P)||(h.crossOrigin="Anonymous"),H.src=P,h.appendChild(H)}})},S.a3=function(){return rt++},S.a4=s,S.a5=rA,S.a6=gs,S.a7=xl,S.a8=ys,S.a9=Bd,S.aA=yt,S.aB=function(_,h){if(!_)return[{command:"setStyle",args:[h]}];let w=[];try{if(!oi(_.version,h.version))return[{command:"setStyle",args:[h]}];oi(_.center,h.center)||w.push({command:"setCenter",args:[h.center]}),oi(_.zoom,h.zoom)||w.push({command:"setZoom",args:[h.zoom]}),oi(_.bearing,h.bearing)||w.push({command:"setBearing",args:[h.bearing]}),oi(_.pitch,h.pitch)||w.push({command:"setPitch",args:[h.pitch]}),oi(_.sprite,h.sprite)||w.push({command:"setSprite",args:[h.sprite]}),oi(_.glyphs,h.glyphs)||w.push({command:"setGlyphs",args:[h.glyphs]}),oi(_.transition,h.transition)||w.push({command:"setTransition",args:[h.transition]}),oi(_.light,h.light)||w.push({command:"setLight",args:[h.light]}),oi(_.terrain,h.terrain)||w.push({command:"setTerrain",args:[h.terrain]}),oi(_.sky,h.sky)||w.push({command:"setSky",args:[h.sky]});const P={},H=[];(function(ee,ge,Te,Ne){let f;for(f in ge=ge||{},ee=ee||{})Object.prototype.hasOwnProperty.call(ee,f)&&(Object.prototype.hasOwnProperty.call(ge,f)||zn(f,Te,Ne));for(f in ge)Object.prototype.hasOwnProperty.call(ge,f)&&(Object.prototype.hasOwnProperty.call(ee,f)?oi(ee[f],ge[f])||(ee[f].type==="geojson"&&ge[f].type==="geojson"&&_n(ee,ge,f)?Yi(Te,{command:"setGeoJSONSourceData",args:[f,ge[f].data]}):Wn(f,ge,Te,Ne)):Xn(f,ge,Te))})(_.sources,h.sources,H,P);const J=[];_.layers&&_.layers.forEach(ee=>{"source"in ee&&P[ee.source]?w.push({command:"removeLayer",args:[ee.id]}):J.push(ee)}),w=w.concat(H),function(ee,ge,Te){ge=ge||[];const Ne=(ee=ee||[]).map(M),f=ge.map(M),u=ee.reduce(U,{}),p=ge.reduce(U,{}),E=Ne.slice(),B=Object.create(null);let q,W,se,fe,ve;for(let Be=0,He=0;Be<Ne.length;Be++)q=Ne[Be],Object.prototype.hasOwnProperty.call(p,q)?He++:(Yi(Te,{command:"removeLayer",args:[q]}),E.splice(E.indexOf(q,He),1));for(let Be=0,He=0;Be<f.length;Be++)q=f[f.length-1-Be],E[E.length-1-Be]!==q&&(Object.prototype.hasOwnProperty.call(u,q)?(Yi(Te,{command:"removeLayer",args:[q]}),E.splice(E.lastIndexOf(q,E.length-He),1)):He++,fe=E[E.length-Be],Yi(Te,{command:"addLayer",args:[p[q],fe]}),E.splice(E.length-Be,0,q),B[q]=!0);for(let Be=0;Be<f.length;Be++)if(q=f[Be],W=u[q],se=p[q],!B[q]&&!oi(W,se))if(oi(W.source,se.source)&&oi(W["source-layer"],se["source-layer"])&&oi(W.type,se.type)){for(ve in b(W.layout,se.layout,Te,q,null,"setLayoutProperty"),b(W.paint,se.paint,Te,q,null,"setPaintProperty"),oi(W.filter,se.filter)||Yi(Te,{command:"setFilter",args:[q,se.filter]}),oi(W.minzoom,se.minzoom)&&oi(W.maxzoom,se.maxzoom)||Yi(Te,{command:"setLayerZoomRange",args:[q,se.minzoom,se.maxzoom]}),W)Object.prototype.hasOwnProperty.call(W,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?b(W[ve],se[ve],Te,q,ve.slice(6),"setPaintProperty"):oi(W[ve],se[ve])||Yi(Te,{command:"setLayerProperty",args:[q,ve,se[ve]]}));for(ve in se)Object.prototype.hasOwnProperty.call(se,ve)&&!Object.prototype.hasOwnProperty.call(W,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?b(W[ve],se[ve],Te,q,ve.slice(6),"setPaintProperty"):oi(W[ve],se[ve])||Yi(Te,{command:"setLayerProperty",args:[q,ve,se[ve]]}))}else Yi(Te,{command:"removeLayer",args:[q]}),fe=E[E.lastIndexOf(q)+1],Yi(Te,{command:"addLayer",args:[se,fe]})}(J,h.layers,w)}catch(P){console.warn("Unable to compute style diff:",P),w=[{command:"setStyle",args:[h]}]}return w},S.aC=function(_){const h=[],w=_.id;return w===void 0&&h.push({message:`layers.${w}: missing required property "id"`}),_.render===void 0&&h.push({message:`layers.${w}: missing required method "render"`}),_.renderingMode&&_.renderingMode!=="2d"&&_.renderingMode!=="3d"&&h.push({message:`layers.${w}: property "renderingMode" must be either "2d" or "3d"`}),h},S.aD=function _(h,w){if(Array.isArray(h)){if(!Array.isArray(w)||h.length!==w.length)return!1;for(let P=0;P<h.length;P++)if(!_(h[P],w[P]))return!1;return!0}if(typeof h=="object"&&h!==null&&w!==null){if(typeof w!="object"||Object.keys(h).length!==Object.keys(w).length)return!1;for(const P in h)if(!_(h[P],w[P]))return!1;return!0}return h===w},S.aE=gt,S.aF=At,S.aG=class extends fo{constructor(_,h){super(_,h),this.current=0}set(_){this.current!==_&&(this.current=_,this.gl.uniform1i(this.location,_))}},S.aH=$r,S.aI=class extends fo{constructor(_,h){super(_,h),this.current=Io}set(_){if(_[12]!==this.current[12]||_[0]!==this.current[0])return this.current=_,void this.gl.uniformMatrix4fv(this.location,!1,_);for(let h=1;h<16;h++)if(_[h]!==this.current[h]){this.current=_,this.gl.uniformMatrix4fv(this.location,!1,_);break}}},S.aJ=Sa,S.aK=class extends fo{constructor(_,h){super(_,h),this.current=[0,0,0]}set(_){_[0]===this.current[0]&&_[1]===this.current[1]&&_[2]===this.current[2]||(this.current=_,this.gl.uniform3f(this.location,_[0],_[1],_[2]))}},S.aL=class extends fo{constructor(_,h){super(_,h),this.current=[0,0]}set(_){_[0]===this.current[0]&&_[1]===this.current[1]||(this.current=_,this.gl.uniform2f(this.location,_[0],_[1]))}},S.aM=So,S.aN=function(_,h,w,P,H,J,ee){var ge=1/(h-w),Te=1/(P-H),Ne=1/(J-ee);return _[0]=-2*ge,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=-2*Te,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=2*Ne,_[11]=0,_[12]=(h+w)*ge,_[13]=(H+P)*Te,_[14]=(ee+J)*Ne,_[15]=1,_},S.aO=mn,S.aP=vA,S.aQ=class extends Xe{},S.aR=hd,S.aS=class extends kt{},S.aT=function(_){return _<=1?1:Math.pow(2,Math.ceil(Math.log(_)/Math.LN2))},S.aU=bA,S.aV=Ae,S.aW=class extends O{},S.aX=Kt,S.aY=function(_,h){var w=_[0],P=_[1],H=_[2],J=_[3],ee=_[4],ge=_[5],Te=_[6],Ne=_[7],f=_[8],u=_[9],p=_[10],E=_[11],B=_[12],q=_[13],W=_[14],se=_[15],fe=h[0],ve=h[1],Be=h[2],He=h[3],it=h[4],pt=h[5],vt=h[6],Dt=h[7],Lt=h[8],Rt=h[9],ei=h[10],Zt=h[11],Wt=h[12],hi=h[13],vi=h[14],Ji=h[15];return Math.abs(w-fe)<=eu*Math.max(1,Math.abs(w),Math.abs(fe))&&Math.abs(P-ve)<=eu*Math.max(1,Math.abs(P),Math.abs(ve))&&Math.abs(H-Be)<=eu*Math.max(1,Math.abs(H),Math.abs(Be))&&Math.abs(J-He)<=eu*Math.max(1,Math.abs(J),Math.abs(He))&&Math.abs(ee-it)<=eu*Math.max(1,Math.abs(ee),Math.abs(it))&&Math.abs(ge-pt)<=eu*Math.max(1,Math.abs(ge),Math.abs(pt))&&Math.abs(Te-vt)<=eu*Math.max(1,Math.abs(Te),Math.abs(vt))&&Math.abs(Ne-Dt)<=eu*Math.max(1,Math.abs(Ne),Math.abs(Dt))&&Math.abs(f-Lt)<=eu*Math.max(1,Math.abs(f),Math.abs(Lt))&&Math.abs(u-Rt)<=eu*Math.max(1,Math.abs(u),Math.abs(Rt))&&Math.abs(p-ei)<=eu*Math.max(1,Math.abs(p),Math.abs(ei))&&Math.abs(E-Zt)<=eu*Math.max(1,Math.abs(E),Math.abs(Zt))&&Math.abs(B-Wt)<=eu*Math.max(1,Math.abs(B),Math.abs(Wt))&&Math.abs(q-hi)<=eu*Math.max(1,Math.abs(q),Math.abs(hi))&&Math.abs(W-vi)<=eu*Math.max(1,Math.abs(W),Math.abs(vi))&&Math.abs(se-Ji)<=eu*Math.max(1,Math.abs(se),Math.abs(Ji))},S.aZ=function(_,h){return _[0]=h[0],_[1]=h[1],_[2]=h[2],_[3]=h[3],_[4]=h[4],_[5]=h[5],_[6]=h[6],_[7]=h[7],_[8]=h[8],_[9]=h[9],_[10]=h[10],_[11]=h[11],_[12]=h[12],_[13]=h[13],_[14]=h[14],_[15]=h[15],_},S.a_=function(_,h,w){return _[0]=h[0]*w[0],_[1]=h[1]*w[1],_[2]=h[2]*w[2],_[3]=h[3]*w[3],_},S.aa=function(_){const h={};if(_.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(w,P,H,J)=>{const ee=H||J;return h[P]=!ee||ee.toLowerCase(),""}),h["max-age"]){const w=parseInt(h["max-age"],10);isNaN(w)?delete h["max-age"]:h["max-age"]=w}return h},S.ab=function(_,h){const w=[];for(const P in _)P in h||w.push(P);return w},S.ac=Mt,S.ad=function(_,h,w){var P=Math.sin(w),H=Math.cos(w),J=h[0],ee=h[1],ge=h[2],Te=h[3],Ne=h[4],f=h[5],u=h[6],p=h[7];return h!==_&&(_[8]=h[8],_[9]=h[9],_[10]=h[10],_[11]=h[11],_[12]=h[12],_[13]=h[13],_[14]=h[14],_[15]=h[15]),_[0]=J*H+Ne*P,_[1]=ee*H+f*P,_[2]=ge*H+u*P,_[3]=Te*H+p*P,_[4]=Ne*H-J*P,_[5]=f*H-ee*P,_[6]=u*H-ge*P,_[7]=p*H-Te*P,_},S.ae=function(_){var h=new Ju(16);return h[0]=_[0],h[1]=_[1],h[2]=_[2],h[3]=_[3],h[4]=_[4],h[5]=_[5],h[6]=_[6],h[7]=_[7],h[8]=_[8],h[9]=_[9],h[10]=_[10],h[11]=_[11],h[12]=_[12],h[13]=_[13],h[14]=_[14],h[15]=_[15],h},S.af=pf,S.ag=function(_,h){let w=0,P=0;if(_.kind==="constant")P=_.layoutSize;else if(_.kind!=="source"){const{interpolationType:H,minZoom:J,maxZoom:ee}=_,ge=H?Mt(ra.interpolationFactor(H,h,J,ee),0,1):0;_.kind==="camera"?P=Sr.number(_.minSize,_.maxSize,ge):w=ge}return{uSizeT:w,uSize:P}},S.ai=function(_,{uSize:h,uSizeT:w},{lowerSize:P,upperSize:H}){return _.kind==="source"?P/Bc:_.kind==="composite"?Sr.number(P/Bc,H/Bc,w):h},S.aj=D0,S.ak=function(_,h,w,P){const H=h.y-_.y,J=h.x-_.x,ee=P.y-w.y,ge=P.x-w.x,Te=ee*J-ge*H;if(Te===0)return null;const Ne=(ge*(_.y-w.y)-ee*(_.x-w.x))/Te;return new oe(_.x+Ne*J,_.y+Ne*H)},S.al=Fd,S.am=Af,S.an=Y0,S.ao=fl,S.aq=zf,S.ar=function(_,h){var w=h[0],P=h[1],H=h[2],J=h[3],ee=h[4],ge=h[5],Te=h[6],Ne=h[7],f=h[8],u=h[9],p=h[10],E=h[11],B=h[12],q=h[13],W=h[14],se=h[15],fe=w*ge-P*ee,ve=w*Te-H*ee,Be=w*Ne-J*ee,He=P*Te-H*ge,it=P*Ne-J*ge,pt=H*Ne-J*Te,vt=f*q-u*B,Dt=f*W-p*B,Lt=f*se-E*B,Rt=u*W-p*q,ei=u*se-E*q,Zt=p*se-E*W,Wt=fe*Zt-ve*ei+Be*Rt+He*Lt-it*Dt+pt*vt;return Wt?(_[0]=(ge*Zt-Te*ei+Ne*Rt)*(Wt=1/Wt),_[1]=(H*ei-P*Zt-J*Rt)*Wt,_[2]=(q*pt-W*it+se*He)*Wt,_[3]=(p*it-u*pt-E*He)*Wt,_[4]=(Te*Lt-ee*Zt-Ne*Dt)*Wt,_[5]=(w*Zt-H*Lt+J*Dt)*Wt,_[6]=(W*Be-B*pt-se*ve)*Wt,_[7]=(f*pt-p*Be+E*ve)*Wt,_[8]=(ee*ei-ge*Lt+Ne*vt)*Wt,_[9]=(P*Lt-w*ei-J*vt)*Wt,_[10]=(B*it-q*Be+se*fe)*Wt,_[11]=(u*Be-f*it-E*fe)*Wt,_[12]=(ge*Dt-ee*Rt-Te*vt)*Wt,_[13]=(w*Rt-P*Dt+H*vt)*Wt,_[14]=(q*ve-B*He-W*fe)*Wt,_[15]=(f*He-u*ve+p*fe)*Wt,_):null},S.as=N0,S.at=GA,S.au=Fc,S.av=function(){const _={},h=Ot.$version;for(const w in Ot.$root){const P=Ot.$root[w];if(P.required){let H=null;H=w==="version"?h:P.type==="array"?[]:{},H!=null&&(_[w]=H)}}return _},S.aw=Yl,S.ax=Ti,S.ay=function(_){_=_.slice();const h=Object.create(null);for(let w=0;w<_.length;w++)h[_[w].id]=_[w];for(let w=0;w<_.length;w++)"ref"in _[w]&&(_[w]=$n(_[w],h[_[w].ref]));return _},S.az=function(_){if(_.type==="custom")return new Td(_);switch(_.type){case"background":return new Ed(_);case"circle":return new g0(_);case"fill":return new b0(_);case"fill-extrusion":return new iA(_);case"heatmap":return new _0(_);case"hillshade":return new Su(_);case"line":return new Nm(_);case"raster":return new Np(_);case"symbol":return new qA(_)}},S.b=Ft,S.b0=Ue,S.b1=Pd,S.b2=qp,S.b3=function(_,h,w,P,H){var J,ee=1/Math.tan(h/2);return _[0]=ee/w,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=ee,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[11]=-1,_[12]=0,_[13]=0,_[15]=0,H!=null&&H!==1/0?(_[10]=(H+P)*(J=1/(P-H)),_[14]=2*H*P*J):(_[10]=-1,_[14]=-2*P),_},S.b4=function(_,h,w){var P=Math.sin(w),H=Math.cos(w),J=h[4],ee=h[5],ge=h[6],Te=h[7],Ne=h[8],f=h[9],u=h[10],p=h[11];return h!==_&&(_[0]=h[0],_[1]=h[1],_[2]=h[2],_[3]=h[3],_[12]=h[12],_[13]=h[13],_[14]=h[14],_[15]=h[15]),_[4]=J*H+Ne*P,_[5]=ee*H+f*P,_[6]=ge*H+u*P,_[7]=Te*H+p*P,_[8]=Ne*H-J*P,_[9]=f*H-ee*P,_[10]=u*H-ge*P,_[11]=p*H-Te*P,_},S.b5=xt,S.b6=zt,S.b7=function(_){return _*Math.PI/180},S.b8=function(_,h){return _[0]=h[0],_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=h[1],_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=h[2],_[11]=0,_[12]=0,_[13]=0,_[14]=0,_[15]=1,_},S.b9=class extends ms{},S.ba=HA,S.bb=Wp,S.bd=xn,S.be=function(_,h){Zi.REGISTERED_PROTOCOLS[_]=h},S.bf=function(_){delete Zi.REGISTERED_PROTOCOLS[_]},S.bg=function(_,h){const w={};for(let H=0;H<_.length;H++){const J=h&&h[_[H].id]||el(_[H]);h&&(h[_[H].id]=J);let ee=w[J];ee||(ee=w[J]=[]),ee.push(_[H])}const P=[];for(const H in w)P.push(w[H]);return P},S.bh=En,S.bi=Ld,S.bj=R0,S.bk=T0,S.bl=function(_){_.bucket.createArrays(),_.bucket.tilePixelRatio=ea/(512*_.bucket.overscaling),_.bucket.compareText={},_.bucket.iconsNeedLinear=!1;const h=_.bucket.layers[0],w=h.layout,P=h._unevaluatedLayout._values,H={layoutIconSize:P["icon-size"].possiblyEvaluate(new ys(_.bucket.zoom+1),_.canonical),layoutTextSize:P["text-size"].possiblyEvaluate(new ys(_.bucket.zoom+1),_.canonical),textMaxSize:P["text-size"].possiblyEvaluate(new ys(18))};if(_.bucket.textSizeData.kind==="composite"){const{minZoom:Ne,maxZoom:f}=_.bucket.textSizeData;H.compositeTextSizes=[P["text-size"].possiblyEvaluate(new ys(Ne),_.canonical),P["text-size"].possiblyEvaluate(new ys(f),_.canonical)]}if(_.bucket.iconSizeData.kind==="composite"){const{minZoom:Ne,maxZoom:f}=_.bucket.iconSizeData;H.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new ys(Ne),_.canonical),P["icon-size"].possiblyEvaluate(new ys(f),_.canonical)]}const J=w.get("text-line-height")*fl,ee=w.get("text-rotation-alignment")!=="viewport"&&w.get("symbol-placement")!=="point",ge=w.get("text-keep-upright"),Te=w.get("text-size");for(const Ne of _.bucket.features){const f=w.get("text-font").evaluate(Ne,{},_.canonical).join(","),u=Te.evaluate(Ne,{},_.canonical),p=H.layoutTextSize.evaluate(Ne,{},_.canonical),E=H.layoutIconSize.evaluate(Ne,{},_.canonical),B={horizontal:{},vertical:void 0},q=Ne.text;let W,se=[0,0];if(q){const Be=q.toString(),He=w.get("text-letter-spacing").evaluate(Ne,{},_.canonical)*fl,it=hu(Be)?He:0,pt=w.get("text-anchor").evaluate(Ne,{},_.canonical),vt=oA(h,Ne,_.canonical);if(!vt){const Zt=w.get("text-radial-offset").evaluate(Ne,{},_.canonical);se=Zt?$A(pt,[Zt*fl,aA]):w.get("text-offset").evaluate(Ne,{},_.canonical).map(Wt=>Wt*fl)}let Dt=ee?"center":w.get("text-justify").evaluate(Ne,{},_.canonical);const Lt=w.get("symbol-placement"),Rt=Lt==="point"?w.get("text-max-width").evaluate(Ne,{},_.canonical)*fl:0,ei=()=>{_.bucket.allowVerticalPlacement&&yl(Be)&&(B.vertical=Lf(q,_.glyphMap,_.glyphPositions,_.imagePositions,f,Rt,J,pt,"left",it,se,S.ah.vertical,!0,Lt,p,u))};if(!ee&&vt){const Zt=new Set;if(Dt==="auto")for(let hi=0;hi<vt.values.length;hi+=2)Zt.add(N0(vt.values[hi]));else Zt.add(Dt);let Wt=!1;for(const hi of Zt)if(!B.horizontal[hi])if(Wt)B.horizontal[hi]=B.horizontal[0];else{const vi=Lf(q,_.glyphMap,_.glyphPositions,_.imagePositions,f,Rt,J,"center",hi,it,se,S.ah.horizontal,!1,Lt,p,u);vi&&(B.horizontal[hi]=vi,Wt=vi.positionedLines.length===1)}ei()}else{Dt==="auto"&&(Dt=N0(pt));const Zt=Lf(q,_.glyphMap,_.glyphPositions,_.imagePositions,f,Rt,J,pt,Dt,it,se,S.ah.horizontal,!1,Lt,p,u);Zt&&(B.horizontal[Dt]=Zt),ei(),yl(Be)&&ee&&ge&&(B.vertical=Lf(q,_.glyphMap,_.glyphPositions,_.imagePositions,f,Rt,J,pt,Dt,it,se,S.ah.vertical,!1,Lt,p,u))}}let fe=!1;if(Ne.icon&&Ne.icon.name){const Be=_.imageMap[Ne.icon.name];Be&&(W=Hm(_.imagePositions[Ne.icon.name],w.get("icon-offset").evaluate(Ne,{},_.canonical),w.get("icon-anchor").evaluate(Ne,{},_.canonical)),fe=!!Be.sdf,_.bucket.sdfIcons===void 0?_.bucket.sdfIcons=fe:_.bucket.sdfIcons!==fe&&ut("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Be.pixelRatio!==_.bucket.pixelRatio||w.get("icon-rotate").constantOr(1)!==0)&&(_.bucket.iconsNeedLinear=!0))}const ve=qd(B.horizontal)||B.vertical;_.bucket.iconsInText=!!ve&&ve.iconsInText,(ve||W)&&Qp(_.bucket,Ne,B,W,_.imageMap,H,p,E,se,fe,_.canonical)}_.showCollisionBoxes&&_.bucket.generateCollisionDebugBuffers()},S.bm=nA,S.bn=Kh,S.bo=TA,S.bp=fc,S.bq=_d,S.br=class{constructor(_){this._marks={start:[_.url,"start"].join("#"),end:[_.url,"end"].join("#"),measure:_.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let _=performance.getEntriesByName(this._marks.measure);return _.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),_=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),_}},S.bs=function(_,h,w,P,H){return a(this,void 0,void 0,function*(){if(ht())try{return yield yi(_,h,w,P,H)}catch{}return function(J,ee,ge,Te,Ne){const f=J.width,u=J.height;Ci&&ki||(Ci=new OffscreenCanvas(f,u),ki=Ci.getContext("2d",{willReadFrequently:!0})),Ci.width=f,Ci.height=u,ki.drawImage(J,0,0,f,u);const p=ki.getImageData(ee,ge,Te,Ne);return ki.clearRect(0,0,f,u),p.data}(_,h,w,P,H)})},S.bt=Dd,S.bu=N,S.bv=$,S.bw=Ad,S.bx=Ls,S.by=function(_){return _.message===Ni},S.bz=Kl,S.c=tn,S.d=_=>a(void 0,void 0,void 0,function*(){if(_.byteLength===0)return createImageBitmap(new ImageData(1,1));const h=new Blob([new Uint8Array(_)],{type:"image/png"});try{return createImageBitmap(h)}catch(w){throw new Error(`Could not load image because of ${w.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),S.e=$t,S.f=_=>new Promise((h,w)=>{const P=new Image;P.onload=()=>{h(P),URL.revokeObjectURL(P.src),P.onload=null,window.requestAnimationFrame(()=>{P.src=Vt})},P.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new Blob([new Uint8Array(_)],{type:"image/png"});P.src=_.byteLength?URL.createObjectURL(H):Vt}),S.g=Gi,S.h=(_,h)=>gi($t(_,{type:"json"}),h),S.i=ct,S.j=xi,S.k=wn,S.l=(_,h)=>gi($t(_,{type:"arrayBuffer"}),h),S.m=gi,S.n=function(_){return new _d(_).readFields(Um,[])},S.o=zl,S.p=FA,S.q=fa,S.r=Yu,S.s=Oi,S.t=Ll,S.u=Tn,S.v=Ot,S.w=ut,S.x=cs,S.y=function([_,h,w]){return h+=90,h*=Math.PI/180,w*=Math.PI/180,{x:_*Math.cos(h)*Math.sin(w),y:_*Math.sin(h)*Math.sin(w),z:_*Math.cos(w)}},S.z=Sr}),g("worker",["./shared"],function(S){class a{constructor(ae){this.keyCache={},ae&&this.replace(ae)}replace(ae){this._layerConfigs={},this._layers={},this.update(ae,[])}update(ae,re){for(const ne of ae){this._layerConfigs[ne.id]=ne;const pe=this._layers[ne.id]=S.az(ne);pe._featureFilter=S.a6(pe.filter),this.keyCache[ne.id]&&delete this.keyCache[ne.id]}for(const ne of re)delete this.keyCache[ne],delete this._layerConfigs[ne],delete this._layers[ne];this.familiesBySource={};const X=S.bg(Object.values(this._layerConfigs),this.keyCache);for(const ne of X){const pe=ne.map(Je=>this._layers[Je.id]),xe=pe[0];if(xe.visibility==="none")continue;const ye=xe.source||"";let De=this.familiesBySource[ye];De||(De=this.familiesBySource[ye]={});const Oe=xe.sourceLayer||"_geojsonTileLayer";let Ve=De[Oe];Ve||(Ve=De[Oe]=[]),Ve.push(pe)}}}class N{constructor(ae){const re={},X=[];for(const ye in ae){const De=ae[ye],Oe=re[ye]={};for(const Ve in De){const Je=De[+Ve];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const et={x:0,y:0,w:Je.bitmap.width+2,h:Je.bitmap.height+2};X.push(et),Oe[Ve]={rect:et,metrics:Je.metrics}}}const{w:ne,h:pe}=S.p(X),xe=new S.o({width:ne||1,height:pe||1});for(const ye in ae){const De=ae[ye];for(const Oe in De){const Ve=De[+Oe];if(!Ve||Ve.bitmap.width===0||Ve.bitmap.height===0)continue;const Je=re[ye][Oe].rect;S.o.copy(Ve.bitmap,xe,{x:0,y:0},{x:Je.x+1,y:Je.y+1},Ve.bitmap)}}this.image=xe,this.positions=re}}S.bh("GlyphAtlas",N);class ${constructor(ae){this.tileID=new S.Q(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.uid=ae.uid,this.zoom=ae.zoom,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.collectResourceTiming,this.returnDependencies=!!ae.returnDependencies,this.promoteId=ae.promoteId,this.inFlightDependencies=[]}parse(ae,re,X,ne){return S._(this,void 0,void 0,function*(){this.status="parsing",this.data=ae,this.collisionBoxArray=new S.a4;const pe=new S.bi(Object.keys(ae.layers).sort()),xe=new S.bj(this.tileID,this.promoteId);xe.bucketLayerIDs=[];const ye={},De={featureIndex:xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X},Oe=re.familiesBySource[this.source];for(const fi in Oe){const ti=ae.layers[fi];if(!ti)continue;ti.version===1&&S.w(`Vector tile source "${this.source}" layer "${fi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ui=pe.encode(fi),Ri=[];for(let bi=0;bi<ti.length;bi++){const Si=ti.feature(bi),Jt=xe.getId(Si,fi);Ri.push({feature:Si,id:Jt,index:bi,sourceLayerIndex:ui})}for(const bi of Oe[fi]){const Si=bi[0];Si.source!==this.source&&S.w(`layer.source = ${Si.source} does not equal this.source = ${this.source}`),Si.minzoom&&this.zoom<Math.floor(Si.minzoom)||Si.maxzoom&&this.zoom>=Si.maxzoom||Si.visibility!=="none"&&(he(bi,this.zoom,X),(ye[Si.id]=Si.createBucket({index:xe.bucketLayerIDs.length,layers:bi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ui,sourceID:this.source})).populate(Ri,De,this.tileID.canonical),xe.bucketLayerIDs.push(bi.map(Jt=>Jt.id)))}}const Ve=S.aE(De.glyphDependencies,fi=>Object.keys(fi).map(Number));this.inFlightDependencies.forEach(fi=>fi==null?void 0:fi.abort()),this.inFlightDependencies=[];let Je=Promise.resolve({});if(Object.keys(Ve).length){const fi=new AbortController;this.inFlightDependencies.push(fi),Je=ne.sendAsync({type:"getGlyphs",data:{stacks:Ve,source:this.source,tileID:this.tileID,type:"glyphs"}},fi)}const et=Object.keys(De.iconDependencies);let Le=Promise.resolve({});if(et.length){const fi=new AbortController;this.inFlightDependencies.push(fi),Le=ne.sendAsync({type:"getImages",data:{icons:et,source:this.source,tileID:this.tileID,type:"icons"}},fi)}const qe=Object.keys(De.patternDependencies);let dt=Promise.resolve({});if(qe.length){const fi=new AbortController;this.inFlightDependencies.push(fi),dt=ne.sendAsync({type:"getImages",data:{icons:qe,source:this.source,tileID:this.tileID,type:"patterns"}},fi)}const[Pt,o,Me]=yield Promise.all([Je,Le,dt]),li=new N(Pt),di=new S.bk(o,Me);for(const fi in ye){const ti=ye[fi];ti instanceof S.a5?(he(ti.layers,this.zoom,X),S.bl({bucket:ti,glyphMap:Pt,glyphPositions:li.positions,imageMap:o,imagePositions:di.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ti.hasPattern&&(ti instanceof S.bm||ti instanceof S.bn||ti instanceof S.bo)&&(he(ti.layers,this.zoom,X),ti.addFeatures(De,this.tileID.canonical,di.patternPositions))}return this.status="done",{buckets:Object.values(ye).filter(fi=>!fi.isEmpty()),featureIndex:xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:li.image,imageAtlas:di,glyphMap:this.returnDependencies?Pt:null,iconMap:this.returnDependencies?o:null,glyphPositions:this.returnDependencies?li.positions:null}})}}function he(Pe,ae,re){const X=new S.a8(ae);for(const ne of Pe)ne.recalculate(X,re)}class oe{constructor(ae,re,X){this.actor=ae,this.layerIndex=re,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ae,re){return S._(this,void 0,void 0,function*(){const X=yield S.l(ae.request,re);try{return{vectorTile:new S.bp.VectorTile(new S.bq(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(ne){const pe=new Uint8Array(X.data);let xe=`Unable to parse the tile at ${ae.request.url}, `;throw xe+=pe[0]===31&&pe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ne.messge}`,new Error(xe)}})}loadTile(ae){return S._(this,void 0,void 0,function*(){const re=ae.uid,X=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new S.br(ae.request),ne=new $(ae);this.loading[re]=ne;const pe=new AbortController;ne.abort=pe;try{const xe=yield this.loadVectorTile(ae,pe);if(delete this.loading[re],!xe)return null;const ye=xe.rawData,De={};xe.expires&&(De.expires=xe.expires),xe.cacheControl&&(De.cacheControl=xe.cacheControl);const Oe={};if(X){const Je=X.finish();Je&&(Oe.resourceTiming=JSON.parse(JSON.stringify(Je)))}ne.vectorTile=xe.vectorTile;const Ve=ne.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[re]=ne,this.fetching[re]={rawTileData:ye,cacheControl:De,resourceTiming:Oe};try{const Je=yield Ve;return S.e({rawTileData:ye.slice(0)},Je,De,Oe)}finally{delete this.fetching[re]}}catch(xe){throw delete this.loading[re],ne.status="done",this.loaded[re]=ne,xe}})}reloadTile(ae){return S._(this,void 0,void 0,function*(){const re=ae.uid;if(!this.loaded||!this.loaded[re])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[re];if(X.showCollisionBoxes=ae.showCollisionBoxes,X.status==="parsing"){const ne=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor);let pe;if(this.fetching[re]){const{rawTileData:xe,cacheControl:ye,resourceTiming:De}=this.fetching[re];delete this.fetching[re],pe=S.e({rawTileData:xe.slice(0)},ne,ye,De)}else pe=ne;return pe}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(ae){return S._(this,void 0,void 0,function*(){const re=this.loading,X=ae.uid;re&&re[X]&&re[X].abort&&(re[X].abort.abort(),delete re[X])})}removeTile(ae){return S._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ae.uid]&&delete this.loaded[ae.uid]})}}class ce{constructor(){this.loaded={}}loadTile(ae){return S._(this,void 0,void 0,function*(){const{uid:re,encoding:X,rawImageData:ne,redFactor:pe,greenFactor:xe,blueFactor:ye,baseShift:De}=ae,Oe=ne.width+2,Ve=ne.height+2,Je=S.b(ne)?new S.R({width:Oe,height:Ve},yield S.bs(ne,-1,-1,Oe,Ve)):ne,et=new S.bt(re,Je,X,pe,xe,ye,De);return this.loaded=this.loaded||{},this.loaded[re]=et,et})}removeTile(ae){const re=this.loaded,X=ae.uid;re&&re[X]&&delete re[X]}}function _e(Pe,ae){if(Pe.length!==0){Ze(Pe[0],ae);for(var re=1;re<Pe.length;re++)Ze(Pe[re],!ae)}}function Ze(Pe,ae){for(var re=0,X=0,ne=0,pe=Pe.length,xe=pe-1;ne<pe;xe=ne++){var ye=(Pe[ne][0]-Pe[xe][0])*(Pe[xe][1]+Pe[ne][1]),De=re+ye;X+=Math.abs(re)>=Math.abs(ye)?re-De+ye:ye-De+re,re=De}re+X>=0!=!!ae&&Pe.reverse()}var nt=S.bu(function Pe(ae,re){var X,ne=ae&&ae.type;if(ne==="FeatureCollection")for(X=0;X<ae.features.length;X++)Pe(ae.features[X],re);else if(ne==="GeometryCollection")for(X=0;X<ae.geometries.length;X++)Pe(ae.geometries[X],re);else if(ne==="Feature")Pe(ae.geometry,re);else if(ne==="Polygon")_e(ae.coordinates,re);else if(ne==="MultiPolygon")for(X=0;X<ae.coordinates.length;X++)_e(ae.coordinates[X],re);return ae});const Ke=S.bp.VectorTileFeature.prototype.toGeoJSON;var st={exports:{}},ht=S.bv,xt=S.bp.VectorTileFeature,zt=Mt;function Mt(Pe,ae){this.options=ae||{},this.features=Pe,this.length=Pe.length}function Ue(Pe,ae){this.id=typeof Pe.id=="number"?Pe.id:void 0,this.type=Pe.type,this.rawGeometry=Pe.type===1?[Pe.geometry]:Pe.geometry,this.properties=Pe.tags,this.extent=ae||4096}Mt.prototype.feature=function(Pe){return new Ue(this.features[Pe],this.options.extent)},Ue.prototype.loadGeometry=function(){var Pe=this.rawGeometry;this.geometry=[];for(var ae=0;ae<Pe.length;ae++){for(var re=Pe[ae],X=[],ne=0;ne<re.length;ne++)X.push(new ht(re[ne][0],re[ne][1]));this.geometry.push(X)}return this.geometry},Ue.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Pe=this.geometry,ae=1/0,re=-1/0,X=1/0,ne=-1/0,pe=0;pe<Pe.length;pe++)for(var xe=Pe[pe],ye=0;ye<xe.length;ye++){var De=xe[ye];ae=Math.min(ae,De.x),re=Math.max(re,De.x),X=Math.min(X,De.y),ne=Math.max(ne,De.y)}return[ae,X,re,ne]},Ue.prototype.toGeoJSON=xt.prototype.toGeoJSON;var $t=S.bw,rt=zt;function gt(Pe){var ae=new $t;return function(re,X){for(var ne in re.layers)X.writeMessage(3,At,re.layers[ne])}(Pe,ae),ae.finish()}function At(Pe,ae){var re;ae.writeVarintField(15,Pe.version||1),ae.writeStringField(1,Pe.name||""),ae.writeVarintField(5,Pe.extent||4096);var X={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<Pe.length;re++)X.feature=Pe.feature(re),ae.writeMessage(2,yt,X);var ne=X.keys;for(re=0;re<ne.length;re++)ae.writeStringField(3,ne[re]);var pe=X.values;for(re=0;re<pe.length;re++)ae.writeMessage(4,ct,pe[re])}function yt(Pe,ae){var re=Pe.feature;re.id!==void 0&&ae.writeVarintField(1,re.id),ae.writeMessage(2,St,Pe),ae.writeVarintField(3,re.type),ae.writeMessage(4,_t,re)}function St(Pe,ae){var re=Pe.feature,X=Pe.keys,ne=Pe.values,pe=Pe.keycache,xe=Pe.valuecache;for(var ye in re.properties){var De=re.properties[ye],Oe=pe[ye];if(De!==null){Oe===void 0&&(X.push(ye),pe[ye]=Oe=X.length-1),ae.writeVarint(Oe);var Ve=typeof De;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(De=JSON.stringify(De));var Je=Ve+":"+De,et=xe[Je];et===void 0&&(ne.push(De),xe[Je]=et=ne.length-1),ae.writeVarint(et)}}}function ut(Pe,ae){return(ae<<3)+(7&Pe)}function Ye(Pe){return Pe<<1^Pe>>31}function _t(Pe,ae){for(var re=Pe.loadGeometry(),X=Pe.type,ne=0,pe=0,xe=re.length,ye=0;ye<xe;ye++){var De=re[ye],Oe=1;X===1&&(Oe=De.length),ae.writeVarint(ut(1,Oe));for(var Ve=X===3?De.length-1:De.length,Je=0;Je<Ve;Je++){Je===1&&X!==1&&ae.writeVarint(ut(2,Ve-1));var et=De[Je].x-ne,Le=De[Je].y-pe;ae.writeVarint(Ye(et)),ae.writeVarint(Ye(Le)),ne+=et,pe+=Le}X===3&&ae.writeVarint(ut(7,1))}}function ct(Pe,ae){var re=typeof Pe;re==="string"?ae.writeStringField(1,Pe):re==="boolean"?ae.writeBooleanField(7,Pe):re==="number"&&(Pe%1!=0?ae.writeDoubleField(3,Pe):Pe<0?ae.writeSVarintField(6,Pe):ae.writeVarintField(5,Pe))}st.exports=gt,st.exports.fromVectorTileJs=gt,st.exports.fromGeojsonVt=function(Pe,ae){ae=ae||{};var re={};for(var X in Pe)re[X]=new rt(Pe[X].features,ae),re[X].name=X,re[X].version=ae.version,re[X].extent=ae.extent;return gt({layers:re})},st.exports.GeoJSONWrapper=rt;var Ut=S.bu(st.exports);const Ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Pe=>Pe},Vt=Math.fround||(yi=new Float32Array(1),Pe=>(yi[0]=+Pe,yi[0]));var yi;const Ci=3,ki=5,Ni=6;class tn{constructor(ae){this.options=Object.assign(Object.create(Ft),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:re,minZoom:X,maxZoom:ne}=this.options;re&&console.time("total time");const pe=`prepare ${ae.length} points`;re&&console.time(pe),this.points=ae;const xe=[];for(let De=0;De<ae.length;De++){const Oe=ae[De];if(!Oe.geometry)continue;const[Ve,Je]=Oe.geometry.coordinates,et=Vt(sn(Ve)),Le=Vt(xn(Je));xe.push(et,Le,1/0,De,-1,1),this.options.reduce&&xe.push(0)}let ye=this.trees[ne+1]=this._createTree(xe);re&&console.timeEnd(pe);for(let De=ne;De>=X;De--){const Oe=+Date.now();ye=this.trees[De]=this._createTree(this._cluster(ye,De)),re&&console.log("z%d: %d clusters in %dms",De,ye.numItems,+Date.now()-Oe)}return re&&console.timeEnd("total time"),this}getClusters(ae,re){let X=((ae[0]+180)%360+360)%360-180;const ne=Math.max(-90,Math.min(90,ae[1]));let pe=ae[2]===180?180:((ae[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)X=-180,pe=180;else if(X>pe){const Je=this.getClusters([X,ne,180,xe],re),et=this.getClusters([-180,ne,pe,xe],re);return Je.concat(et)}const ye=this.trees[this._limitZoom(re)],De=ye.range(sn(X),xn(xe),sn(pe),xn(ne)),Oe=ye.data,Ve=[];for(const Je of De){const et=this.stride*Je;Ve.push(Oe[et+ki]>1?Zi(Oe,et,this.clusterProps):this.points[Oe[et+Ci]])}return Ve}getChildren(ae){const re=this._getOriginId(ae),X=this._getOriginZoom(ae),ne="No cluster with the specified id.",pe=this.trees[X];if(!pe)throw new Error(ne);const xe=pe.data;if(re*this.stride>=xe.length)throw new Error(ne);const ye=this.options.radius/(this.options.extent*Math.pow(2,X-1)),De=pe.within(xe[re*this.stride],xe[re*this.stride+1],ye),Oe=[];for(const Ve of De){const Je=Ve*this.stride;xe[Je+4]===ae&&Oe.push(xe[Je+ki]>1?Zi(xe,Je,this.clusterProps):this.points[xe[Je+Ci]])}if(Oe.length===0)throw new Error(ne);return Oe}getLeaves(ae,re,X){const ne=[];return this._appendLeaves(ne,ae,re=re||10,X=X||0,0),ne}getTile(ae,re,X){const ne=this.trees[this._limitZoom(ae)],pe=Math.pow(2,ae),{extent:xe,radius:ye}=this.options,De=ye/xe,Oe=(X-De)/pe,Ve=(X+1+De)/pe,Je={features:[]};return this._addTileFeatures(ne.range((re-De)/pe,Oe,(re+1+De)/pe,Ve),ne.data,re,X,pe,Je),re===0&&this._addTileFeatures(ne.range(1-De/pe,Oe,1,Ve),ne.data,pe,X,pe,Je),re===pe-1&&this._addTileFeatures(ne.range(0,Oe,De/pe,Ve),ne.data,-1,X,pe,Je),Je.features.length?Je:null}getClusterExpansionZoom(ae){let re=this._getOriginZoom(ae)-1;for(;re<=this.options.maxZoom;){const X=this.getChildren(ae);if(re++,X.length!==1)break;ae=X[0].properties.cluster_id}return re}_appendLeaves(ae,re,X,ne,pe){const xe=this.getChildren(re);for(const ye of xe){const De=ye.properties;if(De&&De.cluster?pe+De.point_count<=ne?pe+=De.point_count:pe=this._appendLeaves(ae,De.cluster_id,X,ne,pe):pe<ne?pe++:ae.push(ye),ae.length===X)break}return pe}_createTree(ae){const re=new S.au(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<ae.length;X+=this.stride)re.add(ae[X],ae[X+1]);return re.finish(),re.data=ae,re}_addTileFeatures(ae,re,X,ne,pe,xe){for(const ye of ae){const De=ye*this.stride,Oe=re[De+ki]>1;let Ve,Je,et;if(Oe)Ve=Gi(re,De,this.clusterProps),Je=re[De],et=re[De+1];else{const dt=this.points[re[De+Ci]];Ve=dt.properties;const[Pt,o]=dt.geometry.coordinates;Je=sn(Pt),et=xn(o)}const Le={type:1,geometry:[[Math.round(this.options.extent*(Je*pe-X)),Math.round(this.options.extent*(et*pe-ne))]],tags:Ve};let qe;qe=Oe||this.options.generateId?re[De+Ci]:this.points[re[De+Ci]].id,qe!==void 0&&(Le.id=qe),xe.features.push(Le)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,re){const{radius:X,extent:ne,reduce:pe,minPoints:xe}=this.options,ye=X/(ne*Math.pow(2,re)),De=ae.data,Oe=[],Ve=this.stride;for(let Je=0;Je<De.length;Je+=Ve){if(De[Je+2]<=re)continue;De[Je+2]=re;const et=De[Je],Le=De[Je+1],qe=ae.within(De[Je],De[Je+1],ye),dt=De[Je+ki];let Pt=dt;for(const o of qe){const Me=o*Ve;De[Me+2]>re&&(Pt+=De[Me+ki])}if(Pt>dt&&Pt>=xe){let o,Me=et*dt,li=Le*dt,di=-1;const fi=((Je/Ve|0)<<5)+(re+1)+this.points.length;for(const ti of qe){const ui=ti*Ve;if(De[ui+2]<=re)continue;De[ui+2]=re;const Ri=De[ui+ki];Me+=De[ui]*Ri,li+=De[ui+1]*Ri,De[ui+4]=fi,pe&&(o||(o=this._map(De,Je,!0),di=this.clusterProps.length,this.clusterProps.push(o)),pe(o,this._map(De,ui)))}De[Je+4]=fi,Oe.push(Me/Pt,li/Pt,1/0,fi,-1,Pt),pe&&Oe.push(di)}else{for(let o=0;o<Ve;o++)Oe.push(De[Je+o]);if(Pt>1)for(const o of qe){const Me=o*Ve;if(!(De[Me+2]<=re)){De[Me+2]=re;for(let li=0;li<Ve;li++)Oe.push(De[Me+li])}}}}return Oe}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,re,X){if(ae[re+ki]>1){const xe=this.clusterProps[ae[re+Ni]];return X?Object.assign({},xe):xe}const ne=this.points[ae[re+Ci]].properties,pe=this.options.map(ne);return X&&pe===ne?Object.assign({},pe):pe}}function Zi(Pe,ae,re){return{type:"Feature",id:Pe[ae+Ci],properties:Gi(Pe,ae,re),geometry:{type:"Point",coordinates:[(X=Pe[ae],360*(X-.5)),Ti(Pe[ae+1])]}};var X}function Gi(Pe,ae,re){const X=Pe[ae+ki],ne=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,pe=Pe[ae+Ni],xe=pe===-1?{}:Object.assign({},re[pe]);return Object.assign(xe,{cluster:!0,cluster_id:Pe[ae+Ci],point_count:X,point_count_abbreviated:ne})}function sn(Pe){return Pe/360+.5}function xn(Pe){const ae=Math.sin(Pe*Math.PI/180),re=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return re<0?0:re>1?1:re}function Ti(Pe){const ae=(180-360*Pe)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function gi(Pe,ae,re,X){for(var ne,pe=X,xe=re-ae>>1,ye=re-ae,De=Pe[ae],Oe=Pe[ae+1],Ve=Pe[re],Je=Pe[re+1],et=ae+3;et<re;et+=3){var Le=Oi(Pe[et],Pe[et+1],De,Oe,Ve,Je);if(Le>pe)ne=et,pe=Le;else if(Le===pe){var qe=Math.abs(et-xe);qe<ye&&(ne=et,ye=qe)}}pe>X&&(ne-ae>3&&gi(Pe,ae,ne,X),Pe[ne+2]=pe,re-ne>3&&gi(Pe,ne,re,X))}function Oi(Pe,ae,re,X,ne,pe){var xe=ne-re,ye=pe-X;if(xe!==0||ye!==0){var De=((Pe-re)*xe+(ae-X)*ye)/(xe*xe+ye*ye);De>1?(re=ne,X=pe):De>0&&(re+=xe*De,X+=ye*De)}return(xe=Pe-re)*xe+(ye=ae-X)*ye}function Vi(Pe,ae,re,X){var ne={id:Pe===void 0?null:Pe,type:ae,geometry:re,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(pe){var xe=pe.geometry,ye=pe.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")bn(pe,xe);else if(ye==="Polygon"||ye==="MultiLineString")for(var De=0;De<xe.length;De++)bn(pe,xe[De]);else if(ye==="MultiPolygon")for(De=0;De<xe.length;De++)for(var Oe=0;Oe<xe[De].length;Oe++)bn(pe,xe[De][Oe])}(ne),ne}function bn(Pe,ae){for(var re=0;re<ae.length;re+=3)Pe.minX=Math.min(Pe.minX,ae[re]),Pe.minY=Math.min(Pe.minY,ae[re+1]),Pe.maxX=Math.max(Pe.maxX,ae[re]),Pe.maxY=Math.max(Pe.maxY,ae[re+1])}function wn(Pe,ae,re,X){if(ae.geometry){var ne=ae.geometry.coordinates,pe=ae.geometry.type,xe=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),ye=[],De=ae.id;if(re.promoteId?De=ae.properties[re.promoteId]:re.generateId&&(De=X||0),pe==="Point")xi(ne,ye);else if(pe==="MultiPoint")for(var Oe=0;Oe<ne.length;Oe++)xi(ne[Oe],ye);else if(pe==="LineString")Bn(ne,ye,xe,!1);else if(pe==="MultiLineString"){if(re.lineMetrics){for(Oe=0;Oe<ne.length;Oe++)Bn(ne[Oe],ye=[],xe,!1),Pe.push(Vi(De,"LineString",ye,ae.properties));return}Ot(ne,ye,xe,!1)}else if(pe==="Polygon")Ot(ne,ye,xe,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(Oe=0;Oe<ae.geometry.geometries.length;Oe++)wn(Pe,{id:De,geometry:ae.geometry.geometries[Oe],properties:ae.properties},re,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Oe=0;Oe<ne.length;Oe++){var Ve=[];Ot(ne[Oe],Ve,xe,!0),ye.push(Ve)}}Pe.push(Vi(De,pe,ye,ae.properties))}}function xi(Pe,ae){ae.push(an(Pe[0])),ae.push($n(Pe[1])),ae.push(0)}function Bn(Pe,ae,re,X){for(var ne,pe,xe=0,ye=0;ye<Pe.length;ye++){var De=an(Pe[ye][0]),Oe=$n(Pe[ye][1]);ae.push(De),ae.push(Oe),ae.push(0),ye>0&&(xe+=X?(ne*Oe-De*pe)/2:Math.sqrt(Math.pow(De-ne,2)+Math.pow(Oe-pe,2))),ne=De,pe=Oe}var Ve=ae.length-3;ae[2]=1,gi(ae,0,Ve,re),ae[Ve+2]=1,ae.size=Math.abs(xe),ae.start=0,ae.end=ae.size}function Ot(Pe,ae,re,X){for(var ne=0;ne<Pe.length;ne++){var pe=[];Bn(Pe[ne],pe,re,X),ae.push(pe)}}function an(Pe){return Pe/360+.5}function $n(Pe){var ae=Math.sin(Pe*Math.PI/180),re=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return re<0?0:re>1?1:re}function oi(Pe,ae,re,X,ne,pe,xe,ye){if(X/=ae,pe>=(re/=ae)&&xe<X)return Pe;if(xe<re||pe>=X)return null;for(var De=[],Oe=0;Oe<Pe.length;Oe++){var Ve=Pe[Oe],Je=Ve.geometry,et=Ve.type,Le=ne===0?Ve.minX:Ve.minY,qe=ne===0?Ve.maxX:Ve.maxY;if(Le>=re&&qe<X)De.push(Ve);else if(!(qe<re||Le>=X)){var dt=[];if(et==="Point"||et==="MultiPoint")Yi(Je,dt,re,X,ne);else if(et==="LineString")Xn(Je,dt,re,X,ne,!1,ye.lineMetrics);else if(et==="MultiLineString")Wn(Je,dt,re,X,ne,!1);else if(et==="Polygon")Wn(Je,dt,re,X,ne,!0);else if(et==="MultiPolygon")for(var Pt=0;Pt<Je.length;Pt++){var o=[];Wn(Je[Pt],o,re,X,ne,!0),o.length&&dt.push(o)}if(dt.length){if(ye.lineMetrics&&et==="LineString"){for(Pt=0;Pt<dt.length;Pt++)De.push(Vi(Ve.id,et,dt[Pt],Ve.tags));continue}et!=="LineString"&&et!=="MultiLineString"||(dt.length===1?(et="LineString",dt=dt[0]):et="MultiLineString"),et!=="Point"&&et!=="MultiPoint"||(et=dt.length===3?"Point":"MultiPoint"),De.push(Vi(Ve.id,et,dt,Ve.tags))}}}return De.length?De:null}function Yi(Pe,ae,re,X,ne){for(var pe=0;pe<Pe.length;pe+=3){var xe=Pe[pe+ne];xe>=re&&xe<=X&&(ae.push(Pe[pe]),ae.push(Pe[pe+1]),ae.push(Pe[pe+2]))}}function Xn(Pe,ae,re,X,ne,pe,xe){for(var ye,De,Oe=zn(Pe),Ve=ne===0?b:M,Je=Pe.start,et=0;et<Pe.length-3;et+=3){var Le=Pe[et],qe=Pe[et+1],dt=Pe[et+2],Pt=Pe[et+3],o=Pe[et+4],Me=ne===0?Le:qe,li=ne===0?Pt:o,di=!1;xe&&(ye=Math.sqrt(Math.pow(Le-Pt,2)+Math.pow(qe-o,2))),Me<re?li>re&&(De=Ve(Oe,Le,qe,Pt,o,re),xe&&(Oe.start=Je+ye*De)):Me>X?li<X&&(De=Ve(Oe,Le,qe,Pt,o,X),xe&&(Oe.start=Je+ye*De)):_n(Oe,Le,qe,dt),li<re&&Me>=re&&(De=Ve(Oe,Le,qe,Pt,o,re),di=!0),li>X&&Me<=X&&(De=Ve(Oe,Le,qe,Pt,o,X),di=!0),!pe&&di&&(xe&&(Oe.end=Je+ye*De),ae.push(Oe),Oe=zn(Pe)),xe&&(Je+=ye)}var fi=Pe.length-3;Le=Pe[fi],qe=Pe[fi+1],dt=Pe[fi+2],(Me=ne===0?Le:qe)>=re&&Me<=X&&_n(Oe,Le,qe,dt),fi=Oe.length-3,pe&&fi>=3&&(Oe[fi]!==Oe[0]||Oe[fi+1]!==Oe[1])&&_n(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&ae.push(Oe)}function zn(Pe){var ae=[];return ae.size=Pe.size,ae.start=Pe.start,ae.end=Pe.end,ae}function Wn(Pe,ae,re,X,ne,pe){for(var xe=0;xe<Pe.length;xe++)Xn(Pe[xe],ae,re,X,ne,pe,!1)}function _n(Pe,ae,re,X){Pe.push(ae),Pe.push(re),Pe.push(X)}function b(Pe,ae,re,X,ne,pe){var xe=(pe-ae)/(X-ae);return Pe.push(pe),Pe.push(re+(ne-re)*xe),Pe.push(1),xe}function M(Pe,ae,re,X,ne,pe){var xe=(pe-re)/(ne-re);return Pe.push(ae+(X-ae)*xe),Pe.push(pe),Pe.push(1),xe}function U(Pe,ae){for(var re=[],X=0;X<Pe.length;X++){var ne,pe=Pe[X],xe=pe.type;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")ne=K(pe.geometry,ae);else if(xe==="MultiLineString"||xe==="Polygon"){ne=[];for(var ye=0;ye<pe.geometry.length;ye++)ne.push(K(pe.geometry[ye],ae))}else if(xe==="MultiPolygon")for(ne=[],ye=0;ye<pe.geometry.length;ye++){for(var De=[],Oe=0;Oe<pe.geometry[ye].length;Oe++)De.push(K(pe.geometry[ye][Oe],ae));ne.push(De)}re.push(Vi(pe.id,xe,ne,pe.tags))}return re}function K(Pe,ae){var re=[];re.size=Pe.size,Pe.start!==void 0&&(re.start=Pe.start,re.end=Pe.end);for(var X=0;X<Pe.length;X+=3)re.push(Pe[X]+ae,Pe[X+1],Pe[X+2]);return re}function ie(Pe,ae){if(Pe.transformed)return Pe;var re,X,ne,pe=1<<Pe.z,xe=Pe.x,ye=Pe.y;for(re=0;re<Pe.features.length;re++){var De=Pe.features[re],Oe=De.geometry,Ve=De.type;if(De.geometry=[],Ve===1)for(X=0;X<Oe.length;X+=2)De.geometry.push(de(Oe[X],Oe[X+1],ae,pe,xe,ye));else for(X=0;X<Oe.length;X++){var Je=[];for(ne=0;ne<Oe[X].length;ne+=2)Je.push(de(Oe[X][ne],Oe[X][ne+1],ae,pe,xe,ye));De.geometry.push(Je)}}return Pe.transformed=!0,Pe}function de(Pe,ae,re,X,ne,pe){return[Math.round(re*(Pe*X-ne)),Math.round(re*(ae*X-pe))]}function be(Pe,ae,re,X,ne){for(var pe=ae===ne.maxZoom?0:ne.tolerance/((1<<ae)*ne.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:X,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ye=0;ye<Pe.length;ye++){xe.numFeatures++,Ee(xe,Pe[ye],pe,ne);var De=Pe[ye].minX,Oe=Pe[ye].minY,Ve=Pe[ye].maxX,Je=Pe[ye].maxY;De<xe.minX&&(xe.minX=De),Oe<xe.minY&&(xe.minY=Oe),Ve>xe.maxX&&(xe.maxX=Ve),Je>xe.maxY&&(xe.maxY=Je)}return xe}function Ee(Pe,ae,re,X){var ne=ae.geometry,pe=ae.type,xe=[];if(pe==="Point"||pe==="MultiPoint")for(var ye=0;ye<ne.length;ye+=3)xe.push(ne[ye]),xe.push(ne[ye+1]),Pe.numPoints++,Pe.numSimplified++;else if(pe==="LineString")Ce(xe,ne,Pe,re,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(ye=0;ye<ne.length;ye++)Ce(xe,ne[ye],Pe,re,pe==="Polygon",ye===0);else if(pe==="MultiPolygon")for(var De=0;De<ne.length;De++){var Oe=ne[De];for(ye=0;ye<Oe.length;ye++)Ce(xe,Oe[ye],Pe,re,!0,ye===0)}if(xe.length){var Ve=ae.tags||null;if(pe==="LineString"&&X.lineMetrics){for(var Je in Ve={},ae.tags)Ve[Je]=ae.tags[Je];Ve.mapbox_clip_start=ne.start/ne.size,Ve.mapbox_clip_end=ne.end/ne.size}var et={geometry:xe,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:Ve};ae.id!==null&&(et.id=ae.id),Pe.features.push(et)}}function Ce(Pe,ae,re,X,ne,pe){var xe=X*X;if(X>0&&ae.size<(ne?xe:X))re.numPoints+=ae.length/3;else{for(var ye=[],De=0;De<ae.length;De+=3)(X===0||ae[De+2]>xe)&&(re.numSimplified++,ye.push(ae[De]),ye.push(ae[De+1])),re.numPoints++;ne&&function(Oe,Ve){for(var Je=0,et=0,Le=Oe.length,qe=Le-2;et<Le;qe=et,et+=2)Je+=(Oe[et]-Oe[qe])*(Oe[et+1]+Oe[qe+1]);if(Je>0===Ve)for(et=0,Le=Oe.length;et<Le/2;et+=2){var dt=Oe[et],Pt=Oe[et+1];Oe[et]=Oe[Le-2-et],Oe[et+1]=Oe[Le-1-et],Oe[Le-2-et]=dt,Oe[Le-1-et]=Pt}}(ye,pe),Pe.push(ye)}}function Re(Pe,ae){var re=(ae=this.options=function(ne,pe){for(var xe in pe)ne[xe]=pe[xe];return ne}(Object.create(this.options),ae)).debug;if(re&&console.time("preprocess data"),ae.maxZoom<0||ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ae.promoteId&&ae.generateId)throw new Error("promoteId and generateId cannot be used together.");var X=function(ne,pe){var xe=[];if(ne.type==="FeatureCollection")for(var ye=0;ye<ne.features.length;ye++)wn(xe,ne.features[ye],pe,ye);else wn(xe,ne.type==="Feature"?ne:{geometry:ne},pe);return xe}(Pe,ae);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ae.indexMaxZoom,ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),X=function(ne,pe){var xe=pe.buffer/pe.extent,ye=ne,De=oi(ne,1,-1-xe,xe,0,-1,2,pe),Oe=oi(ne,1,1-xe,2+xe,0,-1,2,pe);return(De||Oe)&&(ye=oi(ne,1,-xe,1+xe,0,-1,2,pe)||[],De&&(ye=U(De,1).concat(ye)),Oe&&(ye=ye.concat(U(Oe,-1)))),ye}(X,ae),X.length&&this.splitTile(X,0,0,0),re&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $e(Pe,ae,re){return 32*((1<<Pe)*re+ae)+Pe}function je(Pe,ae){return ae?Pe.properties[ae]:Pe.id}function We(Pe,ae){if(Pe==null)return!0;if(Pe.type==="Feature")return je(Pe,ae)!=null;if(Pe.type==="FeatureCollection"){const re=new Set;for(const X of Pe.features){const ne=je(X,ae);if(ne==null||re.has(ne))return!1;re.add(ne)}return!0}return!1}function Ge(Pe,ae){const re=new Map;if(Pe!=null)if(Pe.type==="Feature")re.set(je(Pe,ae),Pe);else for(const X of Pe.features)re.set(je(X,ae),X);return re}Re.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Re.prototype.splitTile=function(Pe,ae,re,X,ne,pe,xe){for(var ye=[Pe,ae,re,X],De=this.options,Oe=De.debug;ye.length;){X=ye.pop(),re=ye.pop(),ae=ye.pop(),Pe=ye.pop();var Ve=1<<ae,Je=$e(ae,re,X),et=this.tiles[Je];if(!et&&(Oe>1&&console.time("creation"),et=this.tiles[Je]=be(Pe,ae,re,X,De),this.tileCoords.push({z:ae,x:re,y:X}),Oe)){Oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ae,re,X,et.numFeatures,et.numPoints,et.numSimplified),console.timeEnd("creation"));var Le="z"+ae;this.stats[Le]=(this.stats[Le]||0)+1,this.total++}if(et.source=Pe,ne){if(ae===De.maxZoom||ae===ne)continue;var qe=1<<ne-ae;if(re!==Math.floor(pe/qe)||X!==Math.floor(xe/qe))continue}else if(ae===De.indexMaxZoom||et.numPoints<=De.indexMaxPoints)continue;if(et.source=null,Pe.length!==0){Oe>1&&console.time("clipping");var dt,Pt,o,Me,li,di,fi=.5*De.buffer/De.extent,ti=.5-fi,ui=.5+fi,Ri=1+fi;dt=Pt=o=Me=null,li=oi(Pe,Ve,re-fi,re+ui,0,et.minX,et.maxX,De),di=oi(Pe,Ve,re+ti,re+Ri,0,et.minX,et.maxX,De),Pe=null,li&&(dt=oi(li,Ve,X-fi,X+ui,1,et.minY,et.maxY,De),Pt=oi(li,Ve,X+ti,X+Ri,1,et.minY,et.maxY,De),li=null),di&&(o=oi(di,Ve,X-fi,X+ui,1,et.minY,et.maxY,De),Me=oi(di,Ve,X+ti,X+Ri,1,et.minY,et.maxY,De),di=null),Oe>1&&console.timeEnd("clipping"),ye.push(dt||[],ae+1,2*re,2*X),ye.push(Pt||[],ae+1,2*re,2*X+1),ye.push(o||[],ae+1,2*re+1,2*X),ye.push(Me||[],ae+1,2*re+1,2*X+1)}}},Re.prototype.getTile=function(Pe,ae,re){var X=this.options,ne=X.extent,pe=X.debug;if(Pe<0||Pe>24)return null;var xe=1<<Pe,ye=$e(Pe,ae=(ae%xe+xe)%xe,re);if(this.tiles[ye])return ie(this.tiles[ye],ne);pe>1&&console.log("drilling down to z%d-%d-%d",Pe,ae,re);for(var De,Oe=Pe,Ve=ae,Je=re;!De&&Oe>0;)Oe--,Ve=Math.floor(Ve/2),Je=Math.floor(Je/2),De=this.tiles[$e(Oe,Ve,Je)];return De&&De.source?(pe>1&&console.log("found parent tile z%d-%d-%d",Oe,Ve,Je),pe>1&&console.time("drilling down"),this.splitTile(De.source,Oe,Ve,Je,Pe,ae,re),pe>1&&console.timeEnd("drilling down"),this.tiles[ye]?ie(this.tiles[ye],ne):null):null};class mt extends oe{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ae,re){return S._(this,void 0,void 0,function*(){const X=ae.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ne=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!ne)return null;const pe=new class{constructor(ye){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=S.W,this.length=ye.length,this._features=ye}feature(ye){return new class{constructor(De){this._feature=De,this.extent=S.W,this.type=De.type,this.properties=De.tags,"id"in De&&!isNaN(De.id)&&(this.id=parseInt(De.id,10))}loadGeometry(){if(this._feature.type===1){const De=[];for(const Oe of this._feature.geometry)De.push([new S.P(Oe[0],Oe[1])]);return De}{const De=[];for(const Oe of this._feature.geometry){const Ve=[];for(const Je of Oe)Ve.push(new S.P(Je[0],Je[1]));De.push(Ve)}return De}}toGeoJSON(De,Oe,Ve){return Ke.call(this,De,Oe,Ve)}}(this._features[ye])}}(ne.features);let xe=Ut(pe);return xe.byteOffset===0&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),{vectorTile:pe,rawData:xe.buffer}})}loadData(ae){var re;return S._(this,void 0,void 0,function*(){(re=this._pendingRequest)===null||re===void 0||re.abort();const X=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new S.br(ae.request);this._pendingRequest=new AbortController;try{let ne=yield this.loadGeoJSON(ae,this._pendingRequest);if(delete this._pendingRequest,typeof ne!="object")throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);if(nt(ne,!0),ae.filter){const xe=S.bx(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(xe.result==="error")throw new Error(xe.value.map(De=>`${De.key}: ${De.message}`).join(", "));ne={type:"FeatureCollection",features:ne.features.filter(De=>xe.value.evaluate({zoom:0},De))}}this._geoJSONIndex=ae.cluster?new tn(function({superclusterOptions:xe,clusterProperties:ye}){if(!ye||!xe)return xe;const De={},Oe={},Ve={accumulated:null,zoom:0},Je={properties:null},et=Object.keys(ye);for(const Le of et){const[qe,dt]=ye[Le],Pt=S.bx(dt),o=S.bx(typeof qe=="string"?[qe,["accumulated"],["get",Le]]:qe);De[Le]=Pt.value,Oe[Le]=o.value}return xe.map=Le=>{Je.properties=Le;const qe={};for(const dt of et)qe[dt]=De[dt].evaluate(Ve,Je);return qe},xe.reduce=(Le,qe)=>{Je.properties=qe;for(const dt of et)Ve.accumulated=Le[dt],Le[dt]=Oe[dt].evaluate(Ve,Je)},xe}(ae)).load(ne.features):function(xe,ye){return new Re(xe,ye)}(ne,ae.geojsonVtOptions),this.loaded={};const pe={};if(X){const xe=X.finish();xe&&(pe.resourceTiming={},pe.resourceTiming[ae.source]=JSON.parse(JSON.stringify(xe)))}return pe}catch(ne){if(delete this._pendingRequest,S.by(ne))return{abandoned:!0};throw ne}})}reloadTile(ae){const re=this.loaded;return re&&re[ae.uid]?super.reloadTile(ae):this.loadTile(ae)}loadGeoJSON(ae,re){return S._(this,void 0,void 0,function*(){const{promoteId:X}=ae;if(ae.request){const ne=yield S.h(ae.request,re);return this._dataUpdateable=We(ne.data,X)?Ge(ne.data,X):void 0,ne.data}if(typeof ae.data=="string")try{const ne=JSON.parse(ae.data);return this._dataUpdateable=We(ne,X)?Ge(ne,X):void 0,ne}catch{throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`)}if(!ae.dataDiff)throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ae.source}`);return function(ne,pe,xe){var ye,De,Oe,Ve;if(pe.removeAll&&ne.clear(),pe.remove)for(const Je of pe.remove)ne.delete(Je);if(pe.add)for(const Je of pe.add){const et=je(Je,xe);et!=null&&ne.set(et,Je)}if(pe.update)for(const Je of pe.update){let et=ne.get(Je.id);if(et==null)continue;const Le=!Je.removeAllProperties&&(((ye=Je.removeProperties)===null||ye===void 0?void 0:ye.length)>0||((De=Je.addOrUpdateProperties)===null||De===void 0?void 0:De.length)>0);if((Je.newGeometry||Je.removeAllProperties||Le)&&(et=Object.assign({},et),ne.set(Je.id,et),Le&&(et.properties=Object.assign({},et.properties))),Je.newGeometry&&(et.geometry=Je.newGeometry),Je.removeAllProperties)et.properties={};else if(((Oe=Je.removeProperties)===null||Oe===void 0?void 0:Oe.length)>0)for(const qe of Je.removeProperties)Object.prototype.hasOwnProperty.call(et.properties,qe)&&delete et.properties[qe];if(((Ve=Je.addOrUpdateProperties)===null||Ve===void 0?void 0:Ve.length)>0)for(const{key:qe,value:dt}of Je.addOrUpdateProperties)et.properties[qe]=dt}}(this._dataUpdateable,ae.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ae){return S._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ae){return this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId)}getClusterChildren(ae){return this._geoJSONIndex.getChildren(ae.clusterId)}getClusterLeaves(ae){return this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset)}}class ot{constructor(ae){this.self=ae,this.actor=new S.C(ae),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(re,X)=>{if(this.externalWorkerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.externalWorkerSourceTypes[re]=X},this.self.addProtocol=S.be,this.self.removeProtocol=S.bf,this.self.registerRTLTextPlugin=re=>{if(S.bz.isParsed())throw new Error("RTL text plugin already registered.");S.bz.setMethods(re)},this.actor.registerMessageHandler("loadDEMTile",(re,X)=>this._getDEMWorkerSource(re,X.source).loadTile(X)),this.actor.registerMessageHandler("removeDEMTile",(re,X)=>S._(this,void 0,void 0,function*(){this._getDEMWorkerSource(re,X.source).removeTile(X)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(re,X)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(re,X.type,X.source).getClusterExpansionZoom(X)})),this.actor.registerMessageHandler("getClusterChildren",(re,X)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(re,X.type,X.source).getClusterChildren(X)})),this.actor.registerMessageHandler("getClusterLeaves",(re,X)=>S._(this,void 0,void 0,function*(){return this._getWorkerSource(re,X.type,X.source).getClusterLeaves(X)})),this.actor.registerMessageHandler("loadData",(re,X)=>this._getWorkerSource(re,X.type,X.source).loadData(X)),this.actor.registerMessageHandler("loadTile",(re,X)=>this._getWorkerSource(re,X.type,X.source).loadTile(X)),this.actor.registerMessageHandler("reloadTile",(re,X)=>this._getWorkerSource(re,X.type,X.source).reloadTile(X)),this.actor.registerMessageHandler("abortTile",(re,X)=>this._getWorkerSource(re,X.type,X.source).abortTile(X)),this.actor.registerMessageHandler("removeTile",(re,X)=>this._getWorkerSource(re,X.type,X.source).removeTile(X)),this.actor.registerMessageHandler("removeSource",(re,X)=>S._(this,void 0,void 0,function*(){if(!this.workerSources[re]||!this.workerSources[re][X.type]||!this.workerSources[re][X.type][X.source])return;const ne=this.workerSources[re][X.type][X.source];delete this.workerSources[re][X.type][X.source],ne.removeSource!==void 0&&ne.removeSource(X)})),this.actor.registerMessageHandler("removeMap",re=>S._(this,void 0,void 0,function*(){delete this.layerIndexes[re],delete this.availableImages[re],delete this.workerSources[re],delete this.demWorkerSources[re]})),this.actor.registerMessageHandler("setReferrer",(re,X)=>S._(this,void 0,void 0,function*(){this.referrer=X})),this.actor.registerMessageHandler("syncRTLPluginState",(re,X)=>this._syncRTLPluginState(re,X)),this.actor.registerMessageHandler("importScript",(re,X)=>S._(this,void 0,void 0,function*(){this.self.importScripts(X)})),this.actor.registerMessageHandler("setImages",(re,X)=>this._setImages(re,X)),this.actor.registerMessageHandler("updateLayers",(re,X)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(re).update(X.layers,X.removedIds)})),this.actor.registerMessageHandler("setLayers",(re,X)=>S._(this,void 0,void 0,function*(){this._getLayerIndex(re).replace(X)}))}_setImages(ae,re){return S._(this,void 0,void 0,function*(){this.availableImages[ae]=re;for(const X in this.workerSources[ae]){const ne=this.workerSources[ae][X];for(const pe in ne)ne[pe].availableImages=re}})}_syncRTLPluginState(ae,re){return S._(this,void 0,void 0,function*(){S.bz.setState(re);const X=S.bz.getPluginURL();if(re.pluginStatus==="loaded"&&!S.bz.isParsed()&&X!=null){this.self.importScripts(X);const ne=S.bz.isParsed();if(ne)return ne;throw new Error(`RTL Text Plugin failed to import scripts from ${X}`)}return!1})}_getAvailableImages(ae){let re=this.availableImages[ae];return re||(re=[]),re}_getLayerIndex(ae){let re=this.layerIndexes[ae];return re||(re=this.layerIndexes[ae]=new a),re}_getWorkerSource(ae,re,X){if(this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][re]||(this.workerSources[ae][re]={}),!this.workerSources[ae][re][X]){const ne={sendAsync:(pe,xe)=>(pe.targetMapId=ae,this.actor.sendAsync(pe,xe))};switch(re){case"vector":this.workerSources[ae][re][X]=new oe(ne,this._getLayerIndex(ae),this._getAvailableImages(ae));break;case"geojson":this.workerSources[ae][re][X]=new mt(ne,this._getLayerIndex(ae),this._getAvailableImages(ae));break;default:this.workerSources[ae][re][X]=new this.externalWorkerSourceTypes[re](ne,this._getLayerIndex(ae),this._getAvailableImages(ae))}}return this.workerSources[ae][re][X]}_getDEMWorkerSource(ae,re){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][re]||(this.demWorkerSources[ae][re]=new ce),this.demWorkerSources[ae][re]}}return S.i(self)&&(self.worker=new ot(self)),ot}),g("index",["exports","./shared"],function(S,a){var N="4.1.0";let $,he;const oe={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:x=>new Promise((s,i)=>{const r=requestAnimationFrame(s);x.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),i(a.c())})}),getImageData(x,s=0){return this.getImageCanvasContext(x).getImageData(-s,-s,x.width+2*s,x.height+2*s)},getImageCanvasContext(x){const s=window.document.createElement("canvas"),i=s.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return s.width=x.width,s.height=x.height,i.drawImage(x,0,0,x.width,x.height),i},resolveURL:x=>($||($=document.createElement("a")),$.href=x,$.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(he==null&&(he=matchMedia("(prefers-reduced-motion: reduce)")),he.matches)}};class ce{static testProp(s){if(!ce.docStyle)return s[0];for(let i=0;i<s.length;i++)if(s[i]in ce.docStyle)return s[i];return s[0]}static create(s,i,r){const l=window.document.createElement(s);return i!==void 0&&(l.className=i),r&&r.appendChild(l),l}static createNS(s,i){return window.document.createElementNS(s,i)}static disableDrag(){ce.docStyle&&ce.selectProp&&(ce.userSelect=ce.docStyle[ce.selectProp],ce.docStyle[ce.selectProp]="none")}static enableDrag(){ce.docStyle&&ce.selectProp&&(ce.docStyle[ce.selectProp]=ce.userSelect)}static setTransform(s,i){s.style[ce.transformProp]=i}static addEventListener(s,i,r,l={}){s.addEventListener(i,r,"passive"in l?l:l.capture)}static removeEventListener(s,i,r,l={}){s.removeEventListener(i,r,"passive"in l?l:l.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",ce.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ce.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ce.suppressClickInternal,!0)},0)}static getScale(s){const i=s.getBoundingClientRect();return{x:i.width/s.offsetWidth||1,y:i.height/s.offsetHeight||1,boundingClientRect:i}}static getPoint(s,i,r){const l=i.boundingClientRect;return new a.P((r.clientX-l.left)/i.x-s.clientLeft,(r.clientY-l.top)/i.y-s.clientTop)}static mousePos(s,i){const r=ce.getScale(s);return ce.getPoint(s,r,i)}static touchPos(s,i){const r=[],l=ce.getScale(s);for(let d=0;d<i.length;d++)r.push(ce.getPoint(s,l,i[d]));return r}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}ce.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ce.selectProp=ce.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ce.transformProp=ce.testProp(["transform","WebkitTransform"]);const _e={supported:!1,testSupport:function(x){!Ke&&nt&&(st?ht(x):Ze=x)}};let Ze,nt,Ke=!1,st=!1;function ht(x){const s=x.createTexture();x.bindTexture(x.TEXTURE_2D,s);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,nt),x.isContextLost())return;_e.supported=!0}catch{}x.deleteTexture(s),Ke=!0}var xt,zt;typeof document<"u"&&(nt=document.createElement("img"),nt.onload=function(){Ze&&ht(Ze),Ze=null,st=!0},nt.onerror=function(){Ke=!0,Ze=null},nt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(x){let s,i,r,l;x.resetRequestQueue=()=>{s=[],i=0,r=0,l={}},x.addThrottleControl=k=>{const z=r++;return l[z]=k,z},x.removeThrottleControl=k=>{delete l[k],y()},x.getImage=(k,z,Z=!0)=>new Promise((Y,Ae)=>{_e.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),a.e(k,{type:"image"}),s.push({abortController:z,requestParameters:k,supportImageRefresh:Z,state:"queued",onError:Ie=>{Ae(Ie)},onSuccess:Ie=>{Y(Ie)}}),y()});const d=k=>a._(this,void 0,void 0,function*(){k.state="running";const{requestParameters:z,supportImageRefresh:Z,onError:Y,onSuccess:Ae,abortController:Ie}=k,ke=Z===!1&&!a.i(self)&&!a.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((tt,wt)=>tt&&wt==="accept",!0));i++;const Fe=ke?I(z,Ie):a.m(z,Ie);try{const tt=yield Fe;delete k.abortController,k.state="completed",tt.data instanceof HTMLImageElement||a.b(tt.data)?Ae(tt):tt.data&&Ae({data:yield(ze=tt.data,typeof createImageBitmap=="function"?a.d(ze):a.f(ze)),cacheControl:tt.cacheControl,expires:tt.expires})}catch(tt){delete k.abortController,Y(tt)}finally{i--,y()}var ze}),y=()=>{const k=(()=>{for(const z of Object.keys(l))if(l[z]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=i;z<k&&s.length>0;z++){const Z=s.shift();Z.abortController.signal.aborted?z--:d(Z)}},I=(k,z)=>new Promise((Z,Y)=>{const Ae=new Image,Ie=k.url,ke=k.credentials;ke&&ke==="include"?Ae.crossOrigin="use-credentials":(ke&&ke==="same-origin"||!a.s(Ie))&&(Ae.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{Ae.src="",Y(a.c())}),Ae.fetchPriority="high",Ae.onload=()=>{Ae.onerror=Ae.onload=null,Z({data:Ae})},Ae.onerror=()=>{Ae.onerror=Ae.onload=null,z.signal.aborted||Y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Ae.src=Ie})}(xt||(xt={})),xt.resetRequestQueue(),function(x){x.Glyphs="Glyphs",x.Image="Image",x.Source="Source",x.SpriteImage="SpriteImage",x.SpriteJSON="SpriteJSON",x.Style="Style",x.Tile="Tile",x.Unknown="Unknown"}(zt||(zt={}));class Mt{constructor(s){this._transformRequestFn=s}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeSpriteURL(s,i,r){const l=function(d){const y=d.match(Ue);if(!y)throw new Error(`Unable to parse URL "${d}"`);return{protocol:y[1],authority:y[2],path:y[3]||"/",params:y[4]?y[4].split("&"):[]}}(s);return l.path+=`${i}${r}`,function(d){const y=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${y}`}(l)}setTransformRequest(s){this._transformRequestFn=s}}const Ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $t(x){var s=new a.A(3);return s[0]=x[0],s[1]=x[1],s[2]=x[2],s}var rt,gt=function(x,s,i){return x[0]=s[0]-i[0],x[1]=s[1]-i[1],x[2]=s[2]-i[2],x};rt=new a.A(3),a.A!=Float32Array&&(rt[0]=0,rt[1]=0,rt[2]=0);var At=function(x){var s=x[0],i=x[1];return s*s+i*i};function yt(x){const s=[];if(typeof x=="string")s.push({id:"default",url:x});else if(x&&x.length>0){const i=[];for(const{id:r,url:l}of x){const d=`${r}${l}`;i.indexOf(d)===-1&&(i.push(d),s.push({id:r,url:l}))}}return s}(function(){var x=new a.A(2);a.A!=Float32Array&&(x[0]=0,x[1]=0)})();class St{constructor(s,i,r,l){this.context=s,this.format=r,this.texture=s.gl.createTexture(),this.update(i,l)}update(s,i,r){const{width:l,height:d}=s,y=!(this.size&&this.size[0]===l&&this.size[1]===d||r),{context:I}=this,{gl:k}=I;if(this.useMipmap=!!(i&&i.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!i||i.premultiply!==!1)),y)this.size=[l,d],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,s):k.texImage2D(k.TEXTURE_2D,0,this.format,l,d,0,this.format,k.UNSIGNED_BYTE,s.data);else{const{x:z,y:Z}=r||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?k.texSubImage2D(k.TEXTURE_2D,0,z,Z,k.RGBA,k.UNSIGNED_BYTE,s):k.texSubImage2D(k.TEXTURE_2D,0,z,Z,l,d,k.RGBA,k.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(s,i,r){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),r!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=d.LINEAR),s!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,r||s),this.filter=s),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function ut(x){const{userImage:s}=x;return!!(s&&s.render&&s.render())&&(x.data.replace(new Uint8Array(s.data.buffer)),!0)}class Ye extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:i,promiseResolve:r}of this.requestors)r(this._getImagesForIds(i));this.requestors=[]}}getImage(s){const i=this.images[s];if(i&&!i.data&&i.spriteData){const r=i.spriteData;i.data=new a.R({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),i.spriteData=null}return i}addImage(s,i){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,i)&&(this.images[s]=i)}_validate(s,i){let r=!0;const l=i.data||i.spriteData;return this._validateStretch(i.stretchX,l&&l.width)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,l&&l.height)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "content" value`))),r=!1),r}_validateStretch(s,i){if(!s)return!0;let r=0;for(const l of s){if(l[0]<r||l[1]<l[0]||i<l[1])return!1;r=l[1]}return!0}_validateContent(s,i){if(!s)return!0;if(s.length!==4)return!1;const r=i.spriteData,l=r&&r.width||i.data.width,d=r&&r.height||i.data.height;return!(s[0]<0||l<s[0]||s[1]<0||d<s[1]||s[2]<0||l<s[2]||s[3]<0||d<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,i,r=!0){const l=this.getImage(s);if(r&&(l.data.width!==i.data.width||l.data.height!==i.data.height))throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=l.version+1,this.images[s]=i,this.updatedImages[s]=!0}removeImage(s){const i=this.images[s];delete this.images[s],delete this.patterns[s],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s){return new Promise((i,r)=>{let l=!0;if(!this.isLoaded())for(const d of s)this.images[d]||(l=!1);this.isLoaded()||l?i(this._getImagesForIds(s)):this.requestors.push({ids:s,promiseResolve:i})})}_getImagesForIds(s){const i={};for(const r of s){let l=this.getImage(r);l||(this.fire(new a.k("styleimagemissing",{id:r})),l=this.getImage(r)),l?i[r]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:!!(l.userImage&&l.userImage.render)}:a.w(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:s,height:i}=this.atlasImage;return{width:s,height:i}}getPattern(s){const i=this.patterns[s],r=this.getImage(s);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{const l={w:r.data.width+2,h:r.data.height+2,x:0,y:0},d=new a.I(l,r);this.patterns[s]={bin:l,position:d}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const i=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new St(s,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const d in this.patterns)s.push(this.patterns[d].bin);const{w:i,h:r}=a.p(s),l=this.atlasImage;l.resize({width:i||1,height:r||1});for(const d in this.patterns){const{bin:y}=this.patterns[d],I=y.x+1,k=y.y+1,z=this.getImage(d).data,Z=z.width,Y=z.height;a.R.copy(z,l,{x:0,y:0},{x:I,y:k},{width:Z,height:Y}),a.R.copy(z,l,{x:0,y:Y-1},{x:I,y:k-1},{width:Z,height:1}),a.R.copy(z,l,{x:0,y:0},{x:I,y:k+Y},{width:Z,height:1}),a.R.copy(z,l,{x:Z-1,y:0},{x:I-1,y:k},{width:1,height:Y}),a.R.copy(z,l,{x:0,y:0},{x:I+Z,y:k},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const i of s){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const r=this.getImage(i);r||a.w(`Image with ID: "${i}" was not found`),ut(r)&&this.updateImage(i,r)}}}const _t=1e20;function ct(x,s,i,r,l,d,y,I,k){for(let z=s;z<s+r;z++)Ut(x,i*d+z,d,l,y,I,k);for(let z=i;z<i+l;z++)Ut(x,z*d+s,1,r,y,I,k)}function Ut(x,s,i,r,l,d,y){d[0]=0,y[0]=-_t,y[1]=_t,l[0]=x[s];for(let I=1,k=0,z=0;I<r;I++){l[I]=x[s+I*i];const Z=I*I;do{const Y=d[k];z=(l[I]-l[Y]+Z-Y*Y)/(I-Y)/2}while(z<=y[k]&&--k>-1);k++,d[k]=I,y[k]=z,y[k+1]=_t}for(let I=0,k=0;I<r;I++){for(;y[k+1]<I;)k++;const z=d[k],Z=I-z;x[s+I*i]=l[z]+Z*Z}}class Ft{constructor(s,i){this.requestManager=s,this.localIdeographFontFamily=i,this.entries={}}setURL(s){this.url=s}getGlyphs(s){return a._(this,void 0,void 0,function*(){const i=[];for(const d in s)for(const y of s[d])i.push(this._getAndCacheGlyphsPromise(d,y));const r=yield Promise.all(i),l={};for(const{stack:d,id:y,glyph:I}of r)l[d]||(l[d]={}),l[d][y]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};return l})}_getAndCacheGlyphsPromise(s,i){return a._(this,void 0,void 0,function*(){let r=this.entries[s];r||(r=this.entries[s]={glyphs:{},requests:{},ranges:{}});let l=r.glyphs[i];if(l!==void 0)return{stack:s,id:i,glyph:l};if(l=this._tinySDF(r,s,i),l)return r.glyphs[i]=l,{stack:s,id:i,glyph:l};const d=Math.floor(i/256);if(256*d>65535)throw new Error("glyphs > 65535 not supported");if(r.ranges[d])return{stack:s,id:i,glyph:l};if(!this.url)throw new Error("glyphsUrl is not set");if(!r.requests[d]){const I=Ft.loadGlyphRange(s,d,this.url,this.requestManager);r.requests[d]=I}const y=yield r.requests[d];for(const I in y)this._doesCharSupportLocalGlyph(+I)||(r.glyphs[+I]=y[+I]);return r.ranges[d]=!0,{stack:s,id:i,glyph:y[i]||null}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](s)||a.u["Hangul Syllables"](s)||a.u.Hiragana(s)||a.u.Katakana(s))}_tinySDF(s,i,r){const l=this.localIdeographFontFamily;if(!l||!this._doesCharSupportLocalGlyph(r))return;let d=s.tinySDF;if(!d){let I="400";/bold/i.test(i)?I="900":/medium/i.test(i)?I="500":/light/i.test(i)&&(I="200"),d=s.tinySDF=new Ft.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:I})}const y=d.draw(String.fromCharCode(r));return{id:r,bitmap:new a.o({width:y.width||60,height:y.height||60},y.data),metrics:{width:y.glyphWidth/2||24,height:y.glyphHeight/2||24,left:y.glyphLeft/2+.5||0,top:y.glyphTop/2-27.5||-8,advance:y.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ft.loadGlyphRange=function(x,s,i,r){return a._(this,void 0,void 0,function*(){const l=256*s,d=l+255,y=r.transformRequest(i.replace("{fontstack}",x).replace("{range}",`${l}-${d}`),zt.Glyphs),I=yield a.l(y,new AbortController);if(!I||!I.data)throw new Error(`Could not load glyph range. range: ${s}, ${l}-${d}`);const k={};for(const z of a.n(I.data))k[z.id]=z;return k})},Ft.TinySDF=class{constructor({fontSize:x=24,buffer:s=3,radius:i=8,cutoff:r=.25,fontFamily:l="sans-serif",fontWeight:d="normal",fontStyle:y="normal"}={}){this.buffer=s,this.cutoff=r,this.radius=i;const I=this.size=x+4*s,k=this._createCanvas(I),z=this.ctx=k.getContext("2d",{willReadFrequently:!0});z.font=`${y} ${d} ${x}px ${l}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(x){const s=document.createElement("canvas");return s.width=s.height=x,s}draw(x){const{width:s,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:l,actualBoundingBoxRight:d}=this.ctx.measureText(x),y=Math.ceil(i),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-l))),k=Math.min(this.size-this.buffer,y+Math.ceil(r)),z=I+2*this.buffer,Z=k+2*this.buffer,Y=Math.max(z*Z,0),Ae=new Uint8ClampedArray(Y),Ie={data:Ae,width:z,height:Z,glyphWidth:I,glyphHeight:k,glyphTop:y,glyphLeft:0,glyphAdvance:s};if(I===0||k===0)return Ie;const{ctx:ke,buffer:Fe,gridInner:ze,gridOuter:tt}=this;ke.clearRect(Fe,Fe,I,k),ke.fillText(x,Fe,Fe+y);const wt=ke.getImageData(Fe,Fe,I,k);tt.fill(_t,0,Y),ze.fill(0,0,Y);for(let lt=0;lt<k;lt++)for(let ft=0;ft<I;ft++){const Tt=wt.data[4*(lt*I+ft)+3]/255;if(Tt===0)continue;const It=(lt+Fe)*z+ft+Fe;if(Tt===1)tt[It]=0,ze[It]=_t;else{const si=.5-Tt;tt[It]=si>0?si*si:0,ze[It]=si<0?si*si:0}}ct(tt,0,0,z,Z,z,this.f,this.v,this.z),ct(ze,Fe,Fe,I,k,z,this.f,this.v,this.z);for(let lt=0;lt<Y;lt++){const ft=Math.sqrt(tt[lt])-Math.sqrt(ze[lt]);Ae[lt]=Math.round(255-255*(ft/this.radius+this.cutoff))}return Ie}};class Vt{constructor(){this.specification=a.v.light.position}possiblyEvaluate(s,i){return a.y(s.expression.evaluate(i))}interpolate(s,i,r){return{x:a.z.number(s.x,i.x,r),y:a.z.number(s.y,i.y,r),z:a.z.number(s.z,i.z,r)}}}let yi;class Ci extends a.E{constructor(s){super(),yi=yi||new a.q({anchor:new a.D(a.v.light.anchor),position:new Vt,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(yi),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,i={}){if(!this._validate(a.r,s,i))for(const r in s){const l=s[r];r.endsWith("-transition")?this._transitionable.setTransition(r.slice(0,-11),l):this._transitionable.setValue(r,l)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,i,r){return(!r||r.validate!==!1)&&a.t(this,s.call(a.x,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}class ki{constructor(s,i){this.width=s,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,i){const r=s.join(",")+String(i);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(s,i)),this.dashEntry[r]}getDashRanges(s,i,r){const l=[];let d=s.length%2==1?-s[s.length-1]*r:0,y=s[0]*r,I=!0;l.push({left:d,right:y,isDash:I,zeroLength:s[0]===0});let k=s[0];for(let z=1;z<s.length;z++){I=!I;const Z=s[z];d=k*r,k+=Z,y=k*r,l.push({left:d,right:y,isDash:I,zeroLength:Z===0})}return l}addRoundDash(s,i,r){const l=i/2;for(let d=-r;d<=r;d++){const y=this.width*(this.nextRow+r+d);let I=0,k=s[I];for(let z=0;z<this.width;z++){z/k.right>1&&(k=s[++I]);const Z=Math.abs(z-k.left),Y=Math.abs(z-k.right),Ae=Math.min(Z,Y);let Ie;const ke=d/r*(l+1);if(k.isDash){const Fe=l-Math.abs(ke);Ie=Math.sqrt(Ae*Ae+Fe*Fe)}else Ie=l-Math.sqrt(Ae*Ae+ke*ke);this.data[y+z]=Math.max(0,Math.min(255,Ie+128))}}}addRegularDash(s){for(let I=s.length-1;I>=0;--I){const k=s[I],z=s[I+1];k.zeroLength?s.splice(I,1):z&&z.isDash===k.isDash&&(z.left=k.left,s.splice(I,1))}const i=s[0],r=s[s.length-1];i.isDash===r.isDash&&(i.left=r.left-this.width,r.right=i.right+this.width);const l=this.width*this.nextRow;let d=0,y=s[d];for(let I=0;I<this.width;I++){I/y.right>1&&(y=s[++d]);const k=Math.abs(I-y.left),z=Math.abs(I-y.right),Z=Math.min(k,z);this.data[l+I]=Math.max(0,Math.min(255,(y.isDash?Z:-Z)+128))}}addDash(s,i){const r=i?7:0,l=2*r+1;if(this.nextRow+l>this.height)return a.w("LineAtlas out of space"),null;let d=0;for(let I=0;I<s.length;I++)d+=s[I];if(d!==0){const I=this.width/d,k=this.getDashRanges(s,this.width,I);i?this.addRoundDash(k,I,r):this.addRegularDash(k)}const y={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:d};return this.nextRow+=l,this.dirty=!0,y}bind(s){const i=s.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const Ni="maplibre_preloaded_worker_pool";class tn{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<tn.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ni]}numActive(){return Object.keys(this.active).length}}const Zi=Math.floor(oe.hardwareConcurrency/2);let Gi,sn;function xn(){return Gi||(Gi=new tn),Gi}tn.workerCount=a.B(globalThis)?Math.max(Math.min(Zi,3),1):1;class Ti{constructor(s,i){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=i;const r=this.workerPool.acquire(i);for(let l=0;l<r.length;l++){const d=new a.C(r[l],i);d.name=`Worker ${l}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,i){const r=[];for(const l of this.actors)r.push(l.sendAsync({type:s,data:i}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}registerMessageHandler(s,i){for(const r of this.actors)r.registerMessageHandler(s,i)}}function gi(){return sn||(sn=new Ti(xn(),a.G),sn.registerMessageHandler("getResource",(x,s,i)=>a.m(s,i))),sn}function Oi(x,s){const i=a.F();return a.H(i,i,[1,1,0]),a.J(i,i,[.5*x.width,.5*x.height,1]),a.K(i,i,x.calculatePosMatrix(s.toUnwrapped()))}function Vi(x,s,i,r,l,d){const y=function(Y,Ae,Ie){if(Y)for(const ke of Y){const Fe=Ae[ke];if(Fe&&Fe.source===Ie&&Fe.type==="fill-extrusion")return!0}else for(const ke in Ae){const Fe=Ae[ke];if(Fe.source===Ie&&Fe.type==="fill-extrusion")return!0}return!1}(l&&l.layers,s,x.id),I=d.maxPitchScaleFactor(),k=x.tilesIn(r,I,y);k.sort(bn);const z=[];for(const Y of k)z.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(s,i,x._state,Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,l,d,I,Oi(x.transform,Y.tileID))});const Z=function(Y){const Ae={},Ie={};for(const ke of Y){const Fe=ke.queryResults,ze=ke.wrappedTileID,tt=Ie[ze]=Ie[ze]||{};for(const wt in Fe){const lt=Fe[wt],ft=tt[wt]=tt[wt]||{},Tt=Ae[wt]=Ae[wt]||[];for(const It of lt)ft[It.featureIndex]||(ft[It.featureIndex]=!0,Tt.push(It))}}return Ae}(z);for(const Y in Z)Z[Y].forEach(Ae=>{const Ie=Ae.feature,ke=x.getFeatureState(Ie.layer["source-layer"],Ie.id);Ie.source=Ie.layer.source,Ie.layer["source-layer"]&&(Ie.sourceLayer=Ie.layer["source-layer"]),Ie.state=ke});return Z}function bn(x,s){const i=x.tileID,r=s.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function wn(x,s,i){return a._(this,void 0,void 0,function*(){let r=x;if(x.url?r=(yield a.h(s.transformRequest(x.url,zt.Source),i)).data:yield oe.frameAsync(i),!r)return null;const l=a.L(a.e(r,x),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(l.vectorLayerIds=r.vector_layers.map(d=>d.id)),l})}class xi{constructor(s,i){s&&(i?this.setSouthWest(s).setNorthEast(i):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}setSouthWest(s){return this._sw=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}extend(s){const i=this._sw,r=this._ne;let l,d;if(s instanceof a.M)l=s,d=s;else{if(!(s instanceof xi))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(xi.convert(s)):this.extend(a.M.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(a.M.convert(s)):this;if(l=s._sw,d=s._ne,!l||!d)return this}return i||r?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),r.lng=Math.max(d.lng,r.lng),r.lat=Math.max(d.lat,r.lat)):(this._sw=new a.M(l.lng,l.lat),this._ne=new a.M(d.lng,d.lat)),this}getCenter(){return new a.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.M(this.getWest(),this.getNorth())}getSouthEast(){return new a.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:i,lat:r}=a.M.convert(s);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&l}static convert(s){return s instanceof xi?s:s&&new xi(s)}static fromLngLat(s,i=0){const r=360*i/40075017,l=r/Math.cos(Math.PI/180*s.lat);return new xi(new a.M(s.lng-l,s.lat-r),new a.M(s.lng+l,s.lat+r))}}class Bn{constructor(s,i,r){this.bounds=xi.convert(this.validateBounds(s)),this.minzoom=i||0,this.maxzoom=r||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const i=Math.pow(2,s.z),r=Math.floor(a.N(this.bounds.getWest())*i),l=Math.floor(a.O(this.bounds.getNorth())*i),d=Math.ceil(a.N(this.bounds.getEast())*i),y=Math.ceil(a.O(this.bounds.getSouth())*i);return s.x>=r&&s.x<d&&s.y>=l&&s.y<y}}class Ot extends a.E{constructor(s,i,r,l){if(super(),this.id=s,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.L(i,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(l)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield wn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s&&(a.e(this,s),s.bounds&&(this.tileBounds=new Bn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.abort(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(i,zt.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let l="reloadTile";if(s.actor&&s.state!=="expired"){if(s.state==="loading")return new Promise((d,y)=>{s.reloadPromise={resolve:d,reject:y}})}else s.actor=this.dispatcher.getActor(),l="loadTile";s.abortController=new AbortController;try{const d=yield s.actor.sendAsync({type:l,data:r},s.abortController);if(delete s.abortController,s.aborted)return;this._afterTileLoadWorkerResponse(s,d)}catch(d){if(delete s.abortController,s.aborted)return;if(d&&d.status!==404)throw d;this._afterTileLoadWorkerResponse(s,null)}})}_afterTileLoadWorkerResponse(s,i){if(i&&i.resourceTiming&&(s.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&s.setExpiryData(i),s.loadVectorData(i,this.map.painter),s.reloadPromise){const r=s.reloadPromise;s.reloadPromise=null,this.loadTile(s).then(r.resolve).catch(r.reject)}}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.actor&&(yield s.actor.sendAsync({type:"abortTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),s.actor&&(yield s.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class an extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.setEventedParent(l),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},i),a.e(this,a.L(i,["url","scheme","tileSize"]))}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield wn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(a.e(this,s),s.bounds&&(this.tileBounds=new Bn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}serialize(){return a.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.abortController=new AbortController;try{const r=yield xt.getImage(this.map._requestManager.transformRequest(i,zt.Tile),s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&s.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const l=this.map.painter.context,d=l.gl,y=r.data;s.texture=this.map.painter.getTileTexture(y.width),s.texture?s.texture.update(y,{useMipmap:!0}):(s.texture=new St(l,y,d.RGBA,{useMipmap:!0}),s.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax)),s.state="loaded"}}catch(r){if(delete s.abortController,s.aborted)s.state="unloaded";else if(r)throw s.state="errored",r}})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController)})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.texture&&this.map.painter.saveTileTexture(s.texture)})}hasTransition(){return!1}}class $n extends an{constructor(s,i,r,l){super(s,i,r,l),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(i,zt.Tile);s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.abortController=new AbortController;try{const l=yield xt.getImage(r,s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(l&&l.data){const d=l.data;this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&s.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const y=a.b(d)&&a.S()?d:yield this.readImageNow(d),I={type:this.type,uid:s.uid,source:this.id,rawImageData:y,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!s.actor||s.state==="expired"){s.actor=this.dispatcher.getActor();const k=yield s.actor.sendAsync({type:"loadDEMTile",data:I});s.dem=k,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded"}}}catch(l){if(delete s.abortController,s.aborted)s.state="unloaded";else if(l)throw s.state="errored",l}})}readImageNow(s){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.U()){const i=s.width+2,r=s.height+2;try{return new a.R({width:i,height:r},yield a.V(s,-1,-1,i,r))}catch{}}return oe.getImageData(s,1)})}_getNeighboringTiles(s){const i=s.canonical,r=Math.pow(2,i.z),l=(i.x-1+r)%r,d=i.x===0?s.wrap-1:s.wrap,y=(i.x+1+r)%r,I=i.x+1===r?s.wrap+1:s.wrap,k={};return k[new a.Q(s.overscaledZ,d,i.z,l,i.y).key]={backfilled:!1},k[new a.Q(s.overscaledZ,I,i.z,y,i.y).key]={backfilled:!1},i.y>0&&(k[new a.Q(s.overscaledZ,d,i.z,l,i.y-1).key]={backfilled:!1},k[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},k[new a.Q(s.overscaledZ,I,i.z,y,i.y-1).key]={backfilled:!1}),i.y+1<r&&(k[new a.Q(s.overscaledZ,d,i.z,l,i.y+1).key]={backfilled:!1},k[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},k[new a.Q(s.overscaledZ,I,i.z,y,i.y+1).key]={backfilled:!1}),k}unloadTile(s){return a._(this,void 0,void 0,function*(){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&(yield s.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:s.uid,source:this.id}}))})}}class oi extends a.E{constructor(s,i,r,l){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(l),this._data=i.data,this._options=a.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const d=a.W/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*d,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*d,extent:a.W,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.W,radius:(i.clusterRadius||50)*d,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:s,source:this.id}})}getClusterChildren(s){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:s,source:this.id}})}getClusterLeaves(s,i,r){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:s,limit:i,offset:r}})}_updateWorkerData(s){return a._(this,void 0,void 0,function*(){const i=a.e({type:this.type},this.workerOptions);s?i.dataDiff=s:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(oe.resolveURL(this._data),zt.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"}));try{const r=yield this.actor.sendAsync({type:"loadData",data:i});if(this._pendingLoads--,this._removed||r.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let l=null;r.resourceTiming&&r.resourceTiming[this.id]&&(l=r.resourceTiming[this.id].slice(0));const d={dataType:"source"};this._collectResourceTiming&&l&&l.length>0&&a.e(d,{resourceTiming:l}),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"content"})))}catch(r){if(this._pendingLoads--,this._removed)return void this.fire(new a.k("dataabort",{dataType:"source"}));this.fire(new a.j(r))}})}loaded(){return this._pendingLoads===0}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const r={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.abortController=new AbortController;const l=yield this.actor.sendAsync({type:i,data:r},s.abortController);delete s.abortController,s.unloadVectorData(),s.aborted||s.loadVectorData(l,this.map.painter,i==="reloadTile")})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.aborted=!0})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Yi=a.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Xn extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(l),this.options=i}load(s){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield xt.getImage(this.map._requestManager.transformRequest(this.url,zt.Image),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,s&&(this.coordinates=s),this._finishLoading())}catch(i){this._request=null,this.fire(new a.j(i))}})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=s.url,this.load(s.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(s){this.coordinates=s;const i=s.map(a.Y.fromLngLat);this.tileID=function(l){let d=1/0,y=1/0,I=-1/0,k=-1/0;for(const Ae of l)d=Math.min(d,Ae.x),y=Math.min(y,Ae.y),I=Math.max(I,Ae.x),k=Math.max(k,Ae.y);const z=Math.max(I-d,k-y),Z=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),Y=Math.pow(2,Z);return new a.a0(Z,Math.floor((d+I)/2*Y),Math.floor((y+k)/2*Y))}(i),this.minzoom=this.maxzoom=this.tileID.z;const r=i.map(l=>this.tileID.getTilePoint(l)._round());return this._boundsArray=new a.Z,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,a.W,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,a.W),this._boundsArray.emplaceBack(r[2].x,r[2].y,a.W,a.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Yi.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new St(s,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={}):s.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class zn extends Xn{constructor(s,i,r,l){super(s,i,r,l),this.roundZoom=!0,this.type="video",this.options=i}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const s=this.options;this.urls=[];for(const i of s.urls)this.urls.push(this.map._requestManager.transformRequest(i,zt.Source).url);try{const i=yield a.a2(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new a.j(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const i=this.video.seekable;s<i.start(0)||s>i.end(0)?this.fire(new a.j(new a.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Yi.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new St(s,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Wn extends Xn{constructor(s,i,r,l){super(s,i,r,l),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(y=>typeof y!="number"))||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new a.j(new a.a1(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,r=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Yi.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new St(i,this.canvas,r.RGBA,{premultiply:!0});let l=!1;for(const d in this.tiles){const y=this.tiles[d];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,l=!0)}l&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const _n={},b=x=>{switch(x){case"geojson":return oi;case"image":return Xn;case"raster":return an;case"raster-dem":return $n;case"vector":return Ot;case"video":return zn;case"canvas":return Wn}return _n[x]};class M extends a.E{constructor(){super(...arguments),this.pluginStatus="unavailable",this.pluginURL=null,this.dispatcher=gi(),this.queue=[]}_sendPluginStateToWorker(){return a._(this,void 0,void 0,function*(){yield this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}),this.fire(new a.k("pluginStateChange",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}))})}getRTLTextPluginStatus(){return this.pluginStatus}clearRTLTextPlugin(){this.pluginStatus="unavailable",this.pluginURL=null}setRTLTextPlugin(s,i=!1){return a._(this,void 0,void 0,function*(){if(this.pluginStatus==="deferred"||this.pluginStatus==="loading"||this.pluginStatus==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");this.pluginURL=oe.resolveURL(s),this.pluginStatus="deferred",yield this._sendPluginStateToWorker(),i||(yield this._downloadRTLTextPlugin())})}_downloadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){if(this.pluginStatus!=="deferred"||!this.pluginURL)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");try{this.pluginStatus="loading",yield this._sendPluginStateToWorker(),yield a.l({url:this.pluginURL},new AbortController),this.pluginStatus="loaded"}catch{this.pluginStatus="error"}yield this._sendPluginStateToWorker()})}lazyLoadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){this.pluginStatus==="deferred"&&(yield this._downloadRTLTextPlugin())})}}let U=null;function K(){return U||(U=new M),U}class ie{constructor(s,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=a.a3(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const i=s+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,i,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(l,d){const y={};if(!d)return y;for(const I of l){const k=I.layerIds.map(z=>d.getLayer(z)).filter(Boolean);if(k.length!==0){I.layers=k,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(z=>k.filter(Z=>Z.id===z)[0]));for(const z of k)y[z.id]=I}}return y}(s.buckets,i.style),this.hasSymbolBuckets=!1;for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5&&d.hasRTLText){this.hasRTLText=!0,K().lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const l in this.buckets){const d=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(l).queryRadius(d))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new a.a4}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const r in this.buckets){const l=this.buckets[r];l.uploadPending()&&l.upload(s)}const i=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new St(s,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new St(s,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,i,r,l,d,y,I,k,z,Z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:d,scale:y,tileSize:this.tileSize,pixelPosMatrix:Z,transform:k,params:I,queryPadding:this.queryPadding*z},s,i,r):{}}querySourceFeatures(s,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const l=r.loadVTLayers(),d=i&&i.sourceLayer?i.sourceLayer:"",y=l._geojsonTileLayer||l[d];if(!y)return;const I=a.a6(i&&i.filter),{z:k,x:z,y:Z}=this.tileID.canonical,Y={z:k,x:z,y:Z};for(let Ae=0;Ae<y.length;Ae++){const Ie=y.feature(Ae);if(I.needGeometry){const ze=a.a7(Ie,!0);if(!I.filter(new a.a8(this.tileID.overscaledZ),ze,this.tileID.canonical))continue}else if(!I.filter(new a.a8(this.tileID.overscaledZ),Ie))continue;const ke=r.getId(Ie,d),Fe=new a.a9(Ie,k,z,Z,ke);Fe.tile=Y,s.push(Fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const i=this.expirationTime;if(s.cacheControl){const r=a.aa(s.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const r=Date.now();let l=!1;if(this.expirationTime>r)l=!1;else if(i)if(this.expirationTime<i)l=!0;else{const d=this.expirationTime-i;d?this.expirationTime=r+Math.max(d,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const r=this.latestFeatureIndex.loadVTLayers();for(const l in this.buckets){if(!i.style.hasLayer(l))continue;const d=this.buckets[l],y=d.layers[0].sourceLayer||"_geojsonTileLayer",I=r[y],k=s[y];if(!I||!k||Object.keys(k).length===0)continue;d.update(k,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=i&&i.style&&i.style.getLayer(l);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<oe.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=oe.now()+s}setDependencies(s,i){const r={};for(const l of i)r[l]=!0;this.dependencies[s]=r}hasDependency(s,i){for(const r of s){const l=this.dependencies[r];if(l){for(const d of i)if(l[d])return!0}}return!1}}class de{constructor(s,i){this.max=s,this.onRemove=i,this.reset()}reset(){for(const s in this.data)for(const i of this.data[s])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(s,i,r){const l=s.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const d={value:i,timeout:void 0};if(r!==void 0&&(d.timeout=setTimeout(()=>{this.remove(s,d)},r)),this.data[l].push(d),this.order.push(l),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const i=this.data[s].shift();return i.timeout&&clearTimeout(i.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),i.value}getByKey(s){const i=this.data[s];return i?i[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,i){if(!this.has(s))return this;const r=s.wrapped().key,l=i===void 0?0:this.data[r].indexOf(i),d=this.data[r][l];return this.data[r].splice(l,1),d.timeout&&clearTimeout(d.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(d.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(s){const i=[];for(const r in this.data)for(const l of this.data[r])s(l.value)||i.push(l);for(const r of i)this.remove(r.value.tileID,r)}}class be{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,i,r){const l=String(i);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][l]=this.stateChanges[s][l]||{},a.e(this.stateChanges[s][l],r),this.deletedStates[s]===null){this.deletedStates[s]={};for(const d in this.state[s])d!==l&&(this.deletedStates[s][d]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][l]===null){this.deletedStates[s][l]={};for(const d in this.state[s][l])r[d]||(this.deletedStates[s][l][d]=null)}else for(const d in r)this.deletedStates[s]&&this.deletedStates[s][l]&&this.deletedStates[s][l][d]===null&&delete this.deletedStates[s][l][d]}removeFeatureState(s,i,r){if(this.deletedStates[s]===null)return;const l=String(i);if(this.deletedStates[s]=this.deletedStates[s]||{},r&&i!==void 0)this.deletedStates[s][l]!==null&&(this.deletedStates[s][l]=this.deletedStates[s][l]||{},this.deletedStates[s][l][r]=null);else if(i!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][l])for(r in this.deletedStates[s][l]={},this.stateChanges[s][l])this.deletedStates[s][l][r]=null;else this.deletedStates[s][l]=null;else this.deletedStates[s]=null}getState(s,i){const r=String(i),l=a.e({},(this.state[s]||{})[r],(this.stateChanges[s]||{})[r]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const d=this.deletedStates[s][i];if(d===null)return{};for(const y in d)delete l[y]}return l}initializeTileState(s,i){s.setFeatureState(this.state,i)}coalesceChanges(s,i){const r={};for(const l in this.stateChanges){this.state[l]=this.state[l]||{};const d={};for(const y in this.stateChanges[l])this.state[l][y]||(this.state[l][y]={}),a.e(this.state[l][y],this.stateChanges[l][y]),d[y]=this.state[l][y];r[l]=d}for(const l in this.deletedStates){this.state[l]=this.state[l]||{};const d={};if(this.deletedStates[l]===null)for(const y in this.state[l])d[y]={},this.state[l][y]={};else for(const y in this.deletedStates[l]){if(this.deletedStates[l][y]===null)this.state[l][y]={};else for(const I of Object.keys(this.deletedStates[l][y]))delete this.state[l][y][I];d[y]=this.state[l][y]}r[l]=r[l]||{},a.e(r[l],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(const l in s)s[l].setFeatureState(r,i)}}class Ee extends a.E{constructor(s,i,r){super(),this.id=s,this.dispatcher=r,this.on("data",l=>{l.dataType==="source"&&l.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&l.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((l,d,y,I)=>{const k=new(b(d.type))(l,d,y,I);if(k.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${k.id}`);return k})(s,i,r,this),this._tiles={},this._cache=new de(0,l=>this._unloadTile(l)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new be,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const i=this._tiles[s];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,i,r){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(s),this._tileLoaded(s,i,r)}catch(l){s.state="errored",l.status!==404?this._source.fire(new a.j(l,{tile:s})):this.update(this.transform,this.terrain)}})}_unloadTile(s){this._source.unloadTile&&this._source.unloadTile(s)}_abortTile(s){this._source.abortTile&&this._source.abortTile(s),this._source.fire(new a.k("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const r=this._tiles[i];r.upload(s),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Ce).map(s=>s.key)}getRenderableIds(s){const i=[];for(const r in this._tiles)this._isIdRenderable(r,s)&&i.push(this._tiles[r]);return s?i.sort((r,l)=>{const d=r.tileID,y=l.tileID,I=new a.P(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),k=new a.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-y.overscaledZ||k.y-I.y||k.x-I.x}).map(r=>r.tileID.key):i.map(r=>r.tileID).sort(Ce).map(r=>r.key)}hasRenderableParent(s){const i=this.findLoadedParent(s,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(s,i){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(i||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(s,i){return a._(this,void 0,void 0,function*(){const r=this._tiles[s];r&&(r.state!=="loading"&&(r.state=i),yield this._loadTile(r,s,i))})}_tileLoaded(s,i,r){s.timeAdded=oe.now(),r==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(i,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const i=this.getRenderableIds();for(let l=0;l<i.length;l++){const d=i[l];if(s.neighboringTiles&&s.neighboringTiles[d]){const y=this.getTileByID(d);r(s,y),r(y,s)}}function r(l,d){l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0;let y=d.tileID.canonical.x-l.tileID.canonical.x;const I=d.tileID.canonical.y-l.tileID.canonical.y,k=Math.pow(2,l.tileID.canonical.z),z=d.tileID.key;y===0&&I===0||Math.abs(I)>1||(Math.abs(y)>1&&(Math.abs(y+k)===1?y+=k:Math.abs(y-k)===1&&(y-=k)),d.dem&&l.dem&&(l.dem.backfillBorder(d.dem,y,I),l.neighboringTiles&&l.neighboringTiles[z]&&(l.neighboringTiles[z].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,i,r,l){for(const d in this._tiles){let y=this._tiles[d];if(l[d]||!y.hasData()||y.tileID.overscaledZ<=i||y.tileID.overscaledZ>r)continue;let I=y.tileID;for(;y&&y.tileID.overscaledZ>i+1;){const z=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[z.key],y&&y.hasData()&&(I=z)}let k=I;for(;k.overscaledZ>i;)if(k=k.scaledTo(k.overscaledZ-1),s[k.key]){l[I.key]=I;break}}}findLoadedParent(s,i){if(s.key in this._loadedParentTiles){const r=this._loadedParentTiles[s.key];return r&&r.tileID.overscaledZ>=i?r:null}for(let r=s.overscaledZ-1;r>=i;r--){const l=s.scaledTo(r),d=this._getLoadedTile(l);if(d)return d}}_getLoadedTile(s){const i=this._tiles[s.key];return i&&i.hasData()?i:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const i=Math.ceil(s.width/this._source.tileSize)+1,r=Math.ceil(s.height/this._source.tileSize)+1,l=Math.floor(i*r*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,l):l;this._cache.setMaxSize(d)}handleWrapJump(s){const i=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,i){const r={};for(const l in this._tiles){const d=this._tiles[l];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+i),r[d.tileID.key]=d}this._tiles=r;for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(l,this._tiles[l])}}update(s,i){if(this.transform=s,this.terrain=i,!this._sourceLoaded||this._paused)return;let r;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new a.Q(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y)):(r=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(r=r.filter(Z=>this._source.hasTile(Z)))):r=[];const l=s.coveringZoomLevel(this._source),d=Math.max(l-Ee.maxOverzooming,this._source.minzoom),y=Math.max(l+Ee.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Z={};for(const Y of r)if(Y.canonical.z>this._source.minzoom){const Ae=Y.scaledTo(Y.canonical.z-1);Z[Ae.key]=Ae;const Ie=Y.scaledTo(Math.max(this._source.minzoom,Math.min(Y.canonical.z,5)));Z[Ie.key]=Ie}r=r.concat(Object.values(Z))}const I=r.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,I&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(r,l);if(Re(this._source.type)){const Z={},Y={},Ae=Object.keys(k),Ie=oe.now();for(const ke of Ae){const Fe=k[ke],ze=this._tiles[ke];if(!ze||ze.fadeEndTime!==0&&ze.fadeEndTime<=Ie)continue;const tt=this.findLoadedParent(Fe,d);tt&&(this._addTile(tt.tileID),Z[tt.tileID.key]=tt.tileID),Y[ke]=Fe}this._retainLoadedChildren(Y,l,y,k);for(const ke in Z)k[ke]||(this._coveredTiles[ke]=!0,k[ke]=Z[ke]);if(i){const ke={},Fe={};for(const ze of r)this._tiles[ze.key].hasData()?ke[ze.key]=ze:Fe[ze.key]=ze;for(const ze in Fe){const tt=Fe[ze].children(this._source.maxzoom);this._tiles[tt[0].key]&&this._tiles[tt[1].key]&&this._tiles[tt[2].key]&&this._tiles[tt[3].key]&&(ke[tt[0].key]=k[tt[0].key]=tt[0],ke[tt[1].key]=k[tt[1].key]=tt[1],ke[tt[2].key]=k[tt[2].key]=tt[2],ke[tt[3].key]=k[tt[3].key]=tt[3],delete Fe[ze])}for(const ze in Fe){const tt=this.findLoadedParent(Fe[ze],this._source.minzoom);if(tt){ke[tt.tileID.key]=k[tt.tileID.key]=tt.tileID;for(const wt in ke)ke[wt].isChildOf(tt.tileID)&&delete ke[wt]}}for(const ze in this._tiles)ke[ze]||(this._coveredTiles[ze]=!0)}}for(const Z in k)this._tiles[Z].clearFadeHold();const z=a.ab(this._tiles,k);for(const Z of z){const Y=this._tiles[Z];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(Z)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,i){const r={},l={},d=Math.max(i-Ee.maxOverzooming,this._source.minzoom),y=Math.max(i+Ee.maxUnderzooming,this._source.minzoom),I={};for(const k of s){const z=this._addTile(k);r[k.key]=k,z.hasData()||i<this._source.maxzoom&&(I[k.key]=k)}this._retainLoadedChildren(I,i,y,r);for(const k of s){let z=this._tiles[k.key];if(z.hasData())continue;if(i+1>this._source.maxzoom){const Y=k.children(this._source.maxzoom)[0],Ae=this.getTile(Y);if(Ae&&Ae.hasData()){r[Y.key]=Y;continue}}else{const Y=k.children(this._source.maxzoom);if(r[Y[0].key]&&r[Y[1].key]&&r[Y[2].key]&&r[Y[3].key])continue}let Z=z.wasRequested();for(let Y=k.overscaledZ-1;Y>=d;--Y){const Ae=k.scaledTo(Y);if(l[Ae.key])break;if(l[Ae.key]=!0,z=this.getTile(Ae),!z&&Z&&(z=this._addTile(Ae)),z){const Ie=z.hasData();if((Z||Ie)&&(r[Ae.key]=Ae),Z=z.wasRequested(),Ie)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const i=[];let r,l=this._tiles[s].tileID;for(;l.overscaledZ>0;){if(l.key in this._loadedParentTiles){r=this._loadedParentTiles[l.key];break}i.push(l.key);const d=l.scaledTo(l.overscaledZ-1);if(r=this._getLoadedTile(d),r)break;l=d}for(const d of i)this._loadedParentTiles[d]=r}}_addTile(s){let i=this._tiles[s.key];if(i)return i;i=this._cache.getAndRemove(s),i&&(this._setTileReloadTimer(s.key,i),i.tileID=s,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,i)));const r=i;return i||(i=new ie(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(i,s.key,i.state)),i.uses++,this._tiles[s.key]=i,r||this._source.fire(new a.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(s,i){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const r=i.getExpiryTimeout();r&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},r))}_removeTile(s){const i=this._tiles[s];i&&(i.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,i,r){const l=[],d=this.transform;if(!d)return l;const y=r?d.getCameraQueryGeometry(s):s,I=s.map(ke=>d.pointCoordinate(ke,this.terrain)),k=y.map(ke=>d.pointCoordinate(ke,this.terrain)),z=this.getIds();let Z=1/0,Y=1/0,Ae=-1/0,Ie=-1/0;for(const ke of k)Z=Math.min(Z,ke.x),Y=Math.min(Y,ke.y),Ae=Math.max(Ae,ke.x),Ie=Math.max(Ie,ke.y);for(let ke=0;ke<z.length;ke++){const Fe=this._tiles[z[ke]];if(Fe.holdingForFade())continue;const ze=Fe.tileID,tt=Math.pow(2,d.zoom-Fe.tileID.overscaledZ),wt=i*Fe.queryPadding*a.W/Fe.tileSize/tt,lt=[ze.getTilePoint(new a.Y(Z,Y)),ze.getTilePoint(new a.Y(Ae,Ie))];if(lt[0].x-wt<a.W&&lt[0].y-wt<a.W&&lt[1].x+wt>=0&&lt[1].y+wt>=0){const ft=I.map(It=>ze.getTilePoint(It)),Tt=k.map(It=>ze.getTilePoint(It));l.push({tile:Fe,tileID:ze,queryGeometry:ft,cameraQueryGeometry:Tt,scale:tt})}}return l}getVisibleCoordinates(s){const i=this.getRenderableIds(s).map(r=>this._tiles[r].tileID);for(const r of i)r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Re(this._source.type)){const s=oe.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=s)return!0}return!1}setFeatureState(s,i,r){this._state.updateState(s=s||"_geojsonTileLayer",i,r)}removeFeatureState(s,i,r){this._state.removeFeatureState(s=s||"_geojsonTileLayer",i,r)}getFeatureState(s,i){return this._state.getState(s=s||"_geojsonTileLayer",i)}setDependencies(s,i,r){const l=this._tiles[s];l&&l.setDependencies(i,r)}reloadTilesForDependencies(s,i){for(const r in this._tiles)this._tiles[r].hasDependency(s,i)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(s,i))}}function Ce(x,s){const i=Math.abs(2*x.wrap)-+(x.wrap<0),r=Math.abs(2*s.wrap)-+(s.wrap<0);return x.overscaledZ-s.overscaledZ||r-i||s.canonical.y-x.canonical.y||s.canonical.x-x.canonical.x}function Re(x){return x==="raster"||x==="image"||x==="video"}Ee.maxOverzooming=10,Ee.maxUnderzooming=3;class $e{constructor(s,i){this.reset(s,i)}reset(s,i){this.points=s||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.ac(s,0,1);let i=1,r=this._distances[i];const l=s*this.paddedLength+this.padding;for(;r<l&&i<this._distances.length;)r=this._distances[++i];const d=i-1,y=this._distances[d],I=r-y,k=I>0?(l-y)/I:0;return this.points[d].mult(1-k).add(this.points[i].mult(k))}}function je(x,s){let i=!0;return x==="always"||x!=="never"&&s!=="never"||(i=!1),i}class We{constructor(s,i,r){const l=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(s/r),this.yCellCount=Math.ceil(i/r);for(let y=0;y<this.xCellCount*this.yCellCount;y++)l.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=i,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,i,r,l,d){this._forEachCell(i,r,l,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(d)}insertCircle(s,i,r,l){this._forEachCell(i-l,r-l,i+l,r+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(i),this.circles.push(r),this.circles.push(l)}_insertBoxCell(s,i,r,l,d,y){this.boxCells[d].push(y)}_insertCircleCell(s,i,r,l,d,y){this.circleCells[d].push(y)}_query(s,i,r,l,d,y,I){if(r<0||s>this.width||l<0||i>this.height)return[];const k=[];if(s<=0&&i<=0&&this.width<=r&&this.height<=l){if(d)return[{key:null,x1:s,y1:i,x2:r,y2:l}];for(let z=0;z<this.boxKeys.length;z++)k.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const Z=this.circles[3*z],Y=this.circles[3*z+1],Ae=this.circles[3*z+2];k.push({key:this.circleKeys[z],x1:Z-Ae,y1:Y-Ae,x2:Z+Ae,y2:Y+Ae})}}else this._forEachCell(s,i,r,l,this._queryCell,k,{hitTest:d,overlapMode:y,seenUids:{box:{},circle:{}}},I);return k}query(s,i,r,l){return this._query(s,i,r,l,!1,null)}hitTest(s,i,r,l,d,y){return this._query(s,i,r,l,!0,d,y).length>0}hitTestCircle(s,i,r,l,d){const y=s-r,I=s+r,k=i-r,z=i+r;if(I<0||y>this.width||z<0||k>this.height)return!1;const Z=[];return this._forEachCell(y,k,I,z,this._queryCellCircle,Z,{hitTest:!0,overlapMode:l,circle:{x:s,y:i,radius:r},seenUids:{box:{},circle:{}}},d),Z.length>0}_queryCell(s,i,r,l,d,y,I,k){const{seenUids:z,hitTest:Z,overlapMode:Y}=I,Ae=this.boxCells[d];if(Ae!==null){const ke=this.bboxes;for(const Fe of Ae)if(!z.box[Fe]){z.box[Fe]=!0;const ze=4*Fe,tt=this.boxKeys[Fe];if(s<=ke[ze+2]&&i<=ke[ze+3]&&r>=ke[ze+0]&&l>=ke[ze+1]&&(!k||k(tt))&&(!Z||!je(Y,tt.overlapMode))&&(y.push({key:tt,x1:ke[ze],y1:ke[ze+1],x2:ke[ze+2],y2:ke[ze+3]}),Z))return!0}}const Ie=this.circleCells[d];if(Ie!==null){const ke=this.circles;for(const Fe of Ie)if(!z.circle[Fe]){z.circle[Fe]=!0;const ze=3*Fe,tt=this.circleKeys[Fe];if(this._circleAndRectCollide(ke[ze],ke[ze+1],ke[ze+2],s,i,r,l)&&(!k||k(tt))&&(!Z||!je(Y,tt.overlapMode))){const wt=ke[ze],lt=ke[ze+1],ft=ke[ze+2];if(y.push({key:tt,x1:wt-ft,y1:lt-ft,x2:wt+ft,y2:lt+ft}),Z)return!0}}}return!1}_queryCellCircle(s,i,r,l,d,y,I,k){const{circle:z,seenUids:Z,overlapMode:Y}=I,Ae=this.boxCells[d];if(Ae!==null){const ke=this.bboxes;for(const Fe of Ae)if(!Z.box[Fe]){Z.box[Fe]=!0;const ze=4*Fe,tt=this.boxKeys[Fe];if(this._circleAndRectCollide(z.x,z.y,z.radius,ke[ze+0],ke[ze+1],ke[ze+2],ke[ze+3])&&(!k||k(tt))&&!je(Y,tt.overlapMode))return y.push(!0),!0}}const Ie=this.circleCells[d];if(Ie!==null){const ke=this.circles;for(const Fe of Ie)if(!Z.circle[Fe]){Z.circle[Fe]=!0;const ze=3*Fe,tt=this.circleKeys[Fe];if(this._circlesCollide(ke[ze],ke[ze+1],ke[ze+2],z.x,z.y,z.radius)&&(!k||k(tt))&&!je(Y,tt.overlapMode))return y.push(!0),!0}}}_forEachCell(s,i,r,l,d,y,I,k){const z=this._convertToXCellCoord(s),Z=this._convertToYCellCoord(i),Y=this._convertToXCellCoord(r),Ae=this._convertToYCellCoord(l);for(let Ie=z;Ie<=Y;Ie++)for(let ke=Z;ke<=Ae;ke++)if(d.call(this,s,i,r,l,this.xCellCount*ke+Ie,y,I,k))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,i,r,l,d,y){const I=l-s,k=d-i,z=r+y;return z*z>I*I+k*k}_circleAndRectCollide(s,i,r,l,d,y,I){const k=(y-l)/2,z=Math.abs(s-(l+k));if(z>k+r)return!1;const Z=(I-d)/2,Y=Math.abs(i-(d+Z));if(Y>Z+r)return!1;if(z<=k||Y<=Z)return!0;const Ae=z-k,Ie=Y-Z;return Ae*Ae+Ie*Ie<=r*r}}function Ge(x,s,i,r,l){const d=a.F();return s?(a.J(d,d,[1/l,1/l,1]),i||a.ad(d,d,r.angle)):a.K(d,r.labelPlaneMatrix,x),d}function mt(x,s,i,r,l){if(s){const d=a.ae(x);return a.J(d,d,[l,l,1]),i||a.ad(d,d,-r.angle),d}return r.glCoordMatrix}function ot(x,s,i){let r;i?(r=[x.x,x.y,i(x.x,x.y),1],a.af(r,r,s)):(r=[x.x,x.y,0,1],Le(r,r,s));const l=r[3];return{point:new a.P(r[0]/l,r[1]/l),signedDistanceFromCamera:l}}function Pe(x,s){return .5+x/s*.5}function ae(x,s){const i=x[0]/x[3],r=x[1]/x[3];return i>=-s[0]&&i<=s[0]&&r>=-s[1]&&r<=s[1]}function re(x,s,i,r,l,d,y,I,k,z){const Z=r?x.textSizeData:x.iconSizeData,Y=a.ag(Z,i.transform.zoom),Ae=[256/i.width*2+1,256/i.height*2+1],Ie=r?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;Ie.clear();const ke=x.lineVertexArray,Fe=r?x.text.placedSymbolArray:x.icon.placedSymbolArray,ze=i.transform.width/i.transform.height;let tt=!1;for(let wt=0;wt<Fe.length;wt++){const lt=Fe.get(wt);if(lt.hidden||lt.writingMode===a.ah.vertical&&!tt){et(lt.numGlyphs,Ie);continue}let ft;if(tt=!1,z?(ft=[lt.anchorX,lt.anchorY,z(lt.anchorX,lt.anchorY),1],a.af(ft,ft,s)):(ft=[lt.anchorX,lt.anchorY,0,1],Le(ft,ft,s)),!ae(ft,Ae)){et(lt.numGlyphs,Ie);continue}const Tt=Pe(i.transform.cameraToCenterDistance,ft[3]),It=a.ai(Z,Y,lt),si=y?It/Tt:It*Tt,Kt=new a.P(lt.anchorX,lt.anchorY),ii=ot(Kt,l,z).point,ai={projections:{},offsets:{}},Wi=pe(lt,si,!1,I,s,l,d,x.glyphOffsetArray,ke,Ie,ii,Kt,ai,ze,k,z);tt=Wi.useVertical,(Wi.notEnoughRoom||tt||Wi.needsFlipping&&pe(lt,si,!0,I,s,l,d,x.glyphOffsetArray,ke,Ie,ii,Kt,ai,ze,k,z).notEnoughRoom)&&et(lt.numGlyphs,Ie)}r?x.text.dynamicLayoutVertexBuffer.updateData(Ie):x.icon.dynamicLayoutVertexBuffer.updateData(Ie)}function X(x,s,i,r,l,d,y,I,k,z,Z,Y,Ae){const Ie=I.glyphStartIndex+I.numGlyphs,ke=I.lineStartIndex,Fe=I.lineStartIndex+I.lineLength,ze=s.getoffsetX(I.glyphStartIndex),tt=s.getoffsetX(Ie-1),wt=Ve(x*ze,i,r,l,d,y,I.segment,ke,Fe,k,z,Z,Y,Ae);if(!wt)return null;const lt=Ve(x*tt,i,r,l,d,y,I.segment,ke,Fe,k,z,Z,Y,Ae);return lt?{first:wt,last:lt}:null}function ne(x,s,i,r){return x===a.ah.horizontal&&Math.abs(i.y-s.y)>Math.abs(i.x-s.x)*r?{useVertical:!0}:(x===a.ah.vertical?s.y<i.y:s.x>i.x)?{needsFlipping:!0}:null}function pe(x,s,i,r,l,d,y,I,k,z,Z,Y,Ae,Ie,ke,Fe){const ze=s/24,tt=x.lineOffsetX*ze,wt=x.lineOffsetY*ze;let lt;if(x.numGlyphs>1){const ft=x.glyphStartIndex+x.numGlyphs,Tt=x.lineStartIndex,It=x.lineStartIndex+x.lineLength,si=X(ze,I,tt,wt,i,Z,Y,x,k,d,Ae,ke,Fe);if(!si)return{notEnoughRoom:!0};const Kt=ot(si.first.point,y,Fe).point,ii=ot(si.last.point,y,Fe).point;if(r&&!i){const ai=ne(x.writingMode,Kt,ii,Ie);if(ai)return ai}lt=[si.first];for(let ai=x.glyphStartIndex+1;ai<ft-1;ai++)lt.push(Ve(ze*I.getoffsetX(ai),tt,wt,i,Z,Y,x.segment,Tt,It,k,d,Ae,ke,Fe));lt.push(si.last)}else{if(r&&!i){const Tt=ot(Y,l,Fe).point,It=x.lineStartIndex+x.segment+1,si=new a.P(k.getx(It),k.gety(It)),Kt=ot(si,l,Fe),ii=Kt.signedDistanceFromCamera>0?Kt.point:xe(Y,si,Tt,1,l,Fe),ai=ne(x.writingMode,Tt,ii,Ie);if(ai)return ai}const ft=Ve(ze*I.getoffsetX(x.glyphStartIndex),tt,wt,i,Z,Y,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,k,d,Ae,ke,Fe);if(!ft)return{notEnoughRoom:!0};lt=[ft]}for(const ft of lt)a.aj(z,ft.point,ft.angle);return{}}function xe(x,s,i,r,l,d){const y=ot(x.add(x.sub(s)._unit()),l,d).point,I=i.sub(y);return i.add(I._mult(r/I.mag()))}function ye(x,s){const{projectionCache:i,lineVertexArray:r,labelPlaneMatrix:l,tileAnchorPoint:d,distanceFromAnchor:y,getElevation:I,previousVertex:k,direction:z,absOffsetX:Z}=s;if(i.projections[x])return i.projections[x];const Y=new a.P(r.getx(x),r.gety(x)),Ae=ot(Y,l,I);if(Ae.signedDistanceFromCamera>0)return i.projections[x]=Ae.point,Ae.point;const Ie=x-z;return xe(y===0?d:new a.P(r.getx(Ie),r.gety(Ie)),Y,k,Z-y+1,l,I)}function De(x,s,i){return x._unit()._perp()._mult(s*i)}function Oe(x,s,i,r,l,d,y,I){const{projectionCache:k,direction:z}=I;if(k.offsets[x])return k.offsets[x];const Z=i.add(s);if(x+z<r||x+z>=l)return k.offsets[x]=Z,Z;const Y=ye(x+z,I),Ae=De(Y.sub(i),y,z),Ie=i.add(Ae),ke=Y.add(Ae);return k.offsets[x]=a.ak(d,Z,Ie,ke)||Z,k.offsets[x]}function Ve(x,s,i,r,l,d,y,I,k,z,Z,Y,Ae,Ie){const ke=r?x-s:x+s;let Fe=ke>0?1:-1,ze=0;r&&(Fe*=-1,ze=Math.PI),Fe<0&&(ze+=Math.PI);let tt,wt,lt=Fe>0?I+y:I+y+1,ft=l,Tt=l,It=0,si=0;const Kt=Math.abs(ke),ii=[];let ai;for(;It+si<=Kt;){if(lt+=Fe,lt<I||lt>=k)return null;It+=si,Tt=ft,wt=tt;const Ei={projectionCache:Y,lineVertexArray:z,labelPlaneMatrix:Z,tileAnchorPoint:d,distanceFromAnchor:It,getElevation:Ie,previousVertex:Tt,direction:Fe,absOffsetX:Kt};if(ft=ye(lt,Ei),i===0)ii.push(Tt),ai=ft.sub(Tt);else{let Hi;const ji=ft.sub(Tt);Hi=ji.mag()===0?De(ye(lt+Fe,Ei).sub(ft),i,Fe):De(ji,i,Fe),wt||(wt=Tt.add(Hi)),tt=Oe(lt,Hi,ft,I,k,wt,i,Ei),ii.push(wt),ai=tt.sub(wt)}si=ai.mag()}const Wi=ai._mult((Kt-It)/si)._add(wt||Tt),$i=ze+Math.atan2(ft.y-Tt.y,ft.x-Tt.x);return ii.push(Wi),{point:Wi,angle:Ae?$i:0,path:ii}}const Je=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function et(x,s){for(let i=0;i<x;i++){const r=s.length;s.resize(r+4),s.float32.set(Je,3*r)}}function Le(x,s,i){const r=s[0],l=s[1];return x[0]=i[0]*r+i[4]*l+i[12],x[1]=i[1]*r+i[5]*l+i[13],x[3]=i[3]*r+i[7]*l+i[15],x}const qe=100;class dt{constructor(s,i=new We(s.width+200,s.height+200,25),r=new We(s.width+200,s.height+200,25)){this.transform=s,this.grid=i,this.ignoredGrid=r,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+qe,this.screenBottomBoundary=s.height+qe,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,i,r,l,d,y){const I=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY,y),k=r*I.perspectiveRatio,z=s.x1*k+I.point.x,Z=s.y1*k+I.point.y,Y=s.x2*k+I.point.x,Ae=s.y2*k+I.point.y;return!this.isInsideGrid(z,Z,Y,Ae)||i!=="always"&&this.grid.hitTest(z,Z,Y,Ae,i,d)||I.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[z,Z,Y,Ae],offscreen:this.isOffscreen(z,Z,Y,Ae)}}placeCollisionCircles(s,i,r,l,d,y,I,k,z,Z,Y,Ae,Ie,ke){const Fe=[],ze=new a.P(i.anchorX,i.anchorY),tt=ot(ze,y,ke),wt=Pe(this.transform.cameraToCenterDistance,tt.signedDistanceFromCamera),lt=(Z?d/wt:d*wt)/a.ao,ft=ot(ze,I,ke).point,Tt=X(lt,l,i.lineOffsetX*lt,i.lineOffsetY*lt,!1,ft,ze,i,r,I,{projections:{},offsets:{}},!1,ke);let It=!1,si=!1,Kt=!0;if(Tt){const ii=.5*Ae*wt+Ie,ai=new a.P(-100,-100),Wi=new a.P(this.screenRightBoundary,this.screenBottomBoundary),$i=new $e,Ei=Tt.first,Hi=Tt.last;let ji=[];for(let nn=Ei.path.length-1;nn>=1;nn--)ji.push(Ei.path[nn]);for(let nn=1;nn<Hi.path.length;nn++)ji.push(Hi.path[nn]);const cn=2.5*ii;if(k){const nn=ji.map(Mn=>ot(Mn,k,ke));ji=nn.some(Mn=>Mn.signedDistanceFromCamera<=0)?[]:nn.map(Mn=>Mn.point)}let Nn=[];if(ji.length>0){const nn=ji[0].clone(),Mn=ji[0].clone();for(let wr=1;wr<ji.length;wr++)nn.x=Math.min(nn.x,ji[wr].x),nn.y=Math.min(nn.y,ji[wr].y),Mn.x=Math.max(Mn.x,ji[wr].x),Mn.y=Math.max(Mn.y,ji[wr].y);Nn=nn.x>=ai.x&&Mn.x<=Wi.x&&nn.y>=ai.y&&Mn.y<=Wi.y?[ji]:Mn.x<ai.x||nn.x>Wi.x||Mn.y<ai.y||nn.y>Wi.y?[]:a.al([ji],ai.x,ai.y,Wi.x,Wi.y)}for(const nn of Nn){$i.reset(nn,.25*ii);let Mn=0;Mn=$i.length<=.5*ii?1:Math.ceil($i.paddedLength/cn)+1;for(let wr=0;wr<Mn;wr++){const nr=wr/Math.max(Mn-1,1),Pa=$i.lerp(nr),_a=Pa.x+qe,Vs=Pa.y+qe;Fe.push(_a,Vs,ii,0);const Ao=_a-ii,fo=Vs-ii,$r=_a+ii,Sa=Vs+ii;if(Kt=Kt&&this.isOffscreen(Ao,fo,$r,Sa),si=si||this.isInsideGrid(Ao,fo,$r,Sa),s!=="always"&&this.grid.hitTestCircle(_a,Vs,ii,s,Y)&&(It=!0,!z))return{circles:[],offscreen:!1,collisionDetected:It}}}}return{circles:!z&&It||!si||wt<this.perspectiveRatioCutoff?[]:Fe,offscreen:Kt,collisionDetected:It}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let r=1/0,l=1/0,d=-1/0,y=-1/0;for(const Z of s){const Y=new a.P(Z.x+qe,Z.y+qe);r=Math.min(r,Y.x),l=Math.min(l,Y.y),d=Math.max(d,Y.x),y=Math.max(y,Y.y),i.push(Y)}const I=this.grid.query(r,l,d,y).concat(this.ignoredGrid.query(r,l,d,y)),k={},z={};for(const Z of I){const Y=Z.key;if(k[Y.bucketInstanceId]===void 0&&(k[Y.bucketInstanceId]={}),k[Y.bucketInstanceId][Y.featureIndex])continue;const Ae=[new a.P(Z.x1,Z.y1),new a.P(Z.x2,Z.y1),new a.P(Z.x2,Z.y2),new a.P(Z.x1,Z.y2)];a.am(i,Ae)&&(k[Y.bucketInstanceId][Y.featureIndex]=!0,z[Y.bucketInstanceId]===void 0&&(z[Y.bucketInstanceId]=[]),z[Y.bucketInstanceId].push(Y.featureIndex))}return z}insertCollisionBox(s,i,r,l,d,y){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:d,collisionGroupID:y,overlapMode:i},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,i,r,l,d,y){const I=r?this.ignoredGrid:this.grid,k={bucketInstanceId:l,featureIndex:d,collisionGroupID:y,overlapMode:i};for(let z=0;z<s.length;z+=4)I.insertCircle(k,s[z],s[z+1],s[z+2])}projectAndGetPerspectiveRatio(s,i,r,l){let d;return l?(d=[i,r,l(i,r),1],a.af(d,d,s)):(d=[i,r,0,1],Le(d,d,s)),{point:new a.P((d[0]/d[3]+1)/2*this.transform.width+qe,(-d[1]/d[3]+1)/2*this.transform.height+qe),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(s,i,r,l){return r<qe||s>=this.screenRightBoundary||l<qe||i>this.screenBottomBoundary}isInsideGrid(s,i,r,l){return r>=0&&s<this.gridRightBoundary&&l>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const s=a.an([]);return a.H(s,s,[-100,-100,0]),s}}function Pt(x,s,i){return s*(a.W/(x.tileSize*Math.pow(2,i-x.tileID.overscaledZ)))}class o{constructor(s,i,r,l){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?i:-i))):l&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}}class Me{constructor(s,i,r,l,d){this.text=new o(s?s.text:null,i,r,d),this.icon=new o(s?s.icon:null,i,l,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class li{constructor(s,i,r){this.text=s,this.icon=i,this.skipFade=r}}class di{constructor(){this.invProjMatrix=a.F(),this.viewportMatrix=a.F(),this.circles=[]}}class fi{constructor(s,i,r,l,d){this.bucketInstanceId=s,this.featureIndex=i,this.sourceLayerIndex=r,this.bucketIndex=l,this.tileID=d}}class ti{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const i=++this.maxGroupID;this.collisionGroups[s]={ID:i,predicate:r=>r.collisionGroupID===i}}return this.collisionGroups[s]}}function ui(x,s,i,r,l){const{horizontalAlign:d,verticalAlign:y}=a.at(x);return new a.P(-(d-.5)*s+r[0]*l,-(y-.5)*i+r[1]*l)}function Ri(x,s,i,r,l,d){const{x1:y,x2:I,y1:k,y2:z,anchorPointX:Z,anchorPointY:Y}=x,Ae=new a.P(s,i);return r&&Ae._rotate(l?d:-d),{x1:y+Ae.x,y1:k+Ae.y,x2:I+Ae.x,y2:z+Ae.y,anchorPointX:Z,anchorPointY:Y}}class bi{constructor(s,i,r,l,d){this.transform=s.clone(),this.terrain=i,this.collisionIndex=new dt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new ti(l),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,i,r,l){const d=r.getBucket(i),y=r.latestFeatureIndex;if(!d||!y||i.id!==d.layerIds[0])return;const I=r.collisionBoxArray,k=d.layers[0].layout,z=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),Z=r.tileSize/a.W,Y=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),Ae=k.get("text-pitch-alignment")==="map",Ie=k.get("text-rotation-alignment")==="map",ke=Pt(r,1,this.transform.zoom),Fe=Ge(Y,Ae,Ie,this.transform,ke);let ze=null;if(Ae){const wt=mt(Y,Ae,Ie,this.transform,ke);ze=a.K([],this.transform.labelPlaneMatrix,wt)}this.retainedQueryData[d.bucketInstanceId]=new fi(d.bucketInstanceId,y,d.sourceLayerIndex,d.index,r.tileID);const tt={bucket:d,layout:k,posMatrix:Y,textLabelPlaneMatrix:Fe,labelToScreenMatrix:ze,scale:z,textPixelRatio:Z,holdingForFade:r.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:a.ag(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(l)for(const wt of d.sortKeyRanges){const{sortKey:lt,symbolInstanceStart:ft,symbolInstanceEnd:Tt}=wt;s.push({sortKey:lt,symbolInstanceStart:ft,symbolInstanceEnd:Tt,parameters:tt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:tt})}attemptAnchorPlacement(s,i,r,l,d,y,I,k,z,Z,Y,Ae,Ie,ke,Fe,ze){const tt=a.ap[s.textAnchor],wt=[s.textOffset0,s.textOffset1],lt=ui(tt,r,l,wt,d),ft=this.collisionIndex.placeCollisionBox(Ri(i,lt.x,lt.y,y,I,this.transform.angle),Y,k,z,Z.predicate,ze);if((!Fe||this.collisionIndex.placeCollisionBox(Ri(Fe,lt.x,lt.y,y,I,this.transform.angle),Y,k,z,Z.predicate,ze).box.length!==0)&&ft.box.length>0){let Tt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ae.crossTileID]&&this.prevPlacement.placements[Ae.crossTileID]&&this.prevPlacement.placements[Ae.crossTileID].text&&(Tt=this.prevPlacement.variableOffsets[Ae.crossTileID].anchor),Ae.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ae.crossTileID]={textOffset:wt,width:r,height:l,anchor:tt,textBoxScale:d,prevAnchor:Tt},this.markUsedJustification(Ie,tt,Ae,ke),Ie.allowVerticalPlacement&&(this.markUsedOrientation(Ie,ke,Ae),this.placedOrientations[Ae.crossTileID]=ke),{shift:lt,placedGlyphBoxes:ft}}}placeLayerBucketPart(s,i,r){const{bucket:l,layout:d,posMatrix:y,textLabelPlaneMatrix:I,labelToScreenMatrix:k,textPixelRatio:z,holdingForFade:Z,collisionBoxArray:Y,partiallyEvaluatedTextSize:Ae,collisionGroup:Ie}=s.parameters,ke=d.get("text-optional"),Fe=d.get("icon-optional"),ze=a.aq(d,"text-overlap","text-allow-overlap"),tt=ze==="always",wt=a.aq(d,"icon-overlap","icon-allow-overlap"),lt=wt==="always",ft=d.get("text-rotation-alignment")==="map",Tt=d.get("text-pitch-alignment")==="map",It=d.get("icon-text-fit")!=="none",si=d.get("symbol-z-order")==="viewport-y",Kt=tt&&(lt||!l.hasIconData()||Fe),ii=lt&&(tt||!l.hasTextData()||ke);!l.collisionArrays&&Y&&l.deserializeCollisionBoxes(Y);const ai=this.retainedQueryData[l.bucketInstanceId].tileID,Wi=this.terrain?(Ei,Hi)=>this.terrain.getElevation(ai,Ei,Hi):null,$i=(Ei,Hi)=>{var ji,cn;if(i[Ei.crossTileID])return;if(Z)return void(this.placements[Ei.crossTileID]=new li(!1,!1,!1));let Nn=!1,nn=!1,Mn=!0,wr=null,nr={box:null,offscreen:null},Pa={box:null,offscreen:null},_a=null,Vs=null,Ao=null,fo=0,$r=0,Sa=0;Hi.textFeatureIndex?fo=Hi.textFeatureIndex:Ei.useRuntimeCollisionCircles&&(fo=Ei.featureIndex),Hi.verticalTextFeatureIndex&&($r=Hi.verticalTextFeatureIndex);const So=Hi.textBox;if(So){const os=Js=>{let zo=a.ah.horizontal;if(l.allowVerticalPlacement&&!Js&&this.prevPlacement){const Go=this.prevPlacement.placedOrientations[Ei.crossTileID];Go&&(this.placedOrientations[Ei.crossTileID]=Go,zo=Go,this.markUsedOrientation(l,zo,Ei))}return zo},ls=(Js,zo)=>{if(l.allowVerticalPlacement&&Ei.numVerticalGlyphVertices>0&&Hi.verticalTextBox){for(const Go of l.writingModes)if(Go===a.ah.vertical?(nr=zo(),Pa=nr):nr=Js(),nr&&nr.box&&nr.box.length)break}else nr=Js()},Ur=Ei.textAnchorOffsetStartIndex,Cs=Ei.textAnchorOffsetEndIndex;if(Cs===Ur){const Js=(zo,Go)=>{const qo=this.collisionIndex.placeCollisionBox(zo,ze,z,y,Ie.predicate,Wi);return qo&&qo.box&&qo.box.length&&(this.markUsedOrientation(l,Go,Ei),this.placedOrientations[Ei.crossTileID]=Go),qo};ls(()=>Js(So,a.ah.horizontal),()=>{const zo=Hi.verticalTextBox;return l.allowVerticalPlacement&&Ei.numVerticalGlyphVertices>0&&zo?Js(zo,a.ah.vertical):{box:null,offscreen:null}}),os(nr&&nr.box&&nr.box.length)}else{let Js=a.ap[(cn=(ji=this.prevPlacement)===null||ji===void 0?void 0:ji.variableOffsets[Ei.crossTileID])===null||cn===void 0?void 0:cn.anchor];const zo=(qo,Cc,ea)=>{const Jl=qo.x2-qo.x1,fu=qo.y2-qo.y1,nl=Ei.textBoxScale,xl=It&&wt==="never"?Cc:null;let Bl={box:[],offscreen:!1},du=ze==="never"?1:2,Af="never";Js&&du++;for(let qh=0;qh<du;qh++){for(let Va=Ur;Va<Cs;Va++){const yA=l.textAnchorOffsets.get(Va);if(Js&&yA.textAnchor!==Js)continue;const vh=this.attemptAnchorPlacement(yA,qo,Jl,fu,nl,ft,Tt,z,y,Ie,Af,Ei,l,ea,xl,Wi);if(vh&&(Bl=vh.placedGlyphBoxes,Bl&&Bl.box&&Bl.box.length))return Nn=!0,wr=vh.shift,Bl}Js?Js=null:Af=ze}return Bl};ls(()=>zo(So,Hi.iconBox,a.ah.horizontal),()=>{const qo=Hi.verticalTextBox;return l.allowVerticalPlacement&&!(nr&&nr.box&&nr.box.length)&&Ei.numVerticalGlyphVertices>0&&qo?zo(qo,Hi.verticalIconBox,a.ah.vertical):{box:null,offscreen:null}}),nr&&(Nn=nr.box,Mn=nr.offscreen);const Go=os(nr&&nr.box);if(!Nn&&this.prevPlacement){const qo=this.prevPlacement.variableOffsets[Ei.crossTileID];qo&&(this.variableOffsets[Ei.crossTileID]=qo,this.markUsedJustification(l,qo.anchor,Ei,Go))}}}if(_a=nr,Nn=_a&&_a.box&&_a.box.length>0,Mn=_a&&_a.offscreen,Ei.useRuntimeCollisionCircles){const os=l.text.placedSymbolArray.get(Ei.centerJustifiedTextSymbolIndex),ls=a.ai(l.textSizeData,Ae,os),Ur=d.get("text-padding");Vs=this.collisionIndex.placeCollisionCircles(ze,os,l.lineVertexArray,l.glyphOffsetArray,ls,y,I,k,r,Tt,Ie.predicate,Ei.collisionCircleDiameter,Ur,Wi),Vs.circles.length&&Vs.collisionDetected&&!r&&a.w("Collisions detected, but collision boxes are not shown"),Nn=tt||Vs.circles.length>0&&!Vs.collisionDetected,Mn=Mn&&Vs.offscreen}if(Hi.iconFeatureIndex&&(Sa=Hi.iconFeatureIndex),Hi.iconBox){const os=ls=>{const Ur=It&&wr?Ri(ls,wr.x,wr.y,ft,Tt,this.transform.angle):ls;return this.collisionIndex.placeCollisionBox(Ur,wt,z,y,Ie.predicate,Wi)};Pa&&Pa.box&&Pa.box.length&&Hi.verticalIconBox?(Ao=os(Hi.verticalIconBox),nn=Ao.box.length>0):(Ao=os(Hi.iconBox),nn=Ao.box.length>0),Mn=Mn&&Ao.offscreen}const Io=ke||Ei.numHorizontalGlyphVertices===0&&Ei.numVerticalGlyphVertices===0,Ks=Fe||Ei.numIconVertices===0;if(Io||Ks?Ks?Io||(nn=nn&&Nn):Nn=nn&&Nn:nn=Nn=nn&&Nn,Nn&&_a&&_a.box&&this.collisionIndex.insertCollisionBox(_a.box,ze,d.get("text-ignore-placement"),l.bucketInstanceId,Pa&&Pa.box&&$r?$r:fo,Ie.ID),nn&&Ao&&this.collisionIndex.insertCollisionBox(Ao.box,wt,d.get("icon-ignore-placement"),l.bucketInstanceId,Sa,Ie.ID),Vs&&(Nn&&this.collisionIndex.insertCollisionCircles(Vs.circles,ze,d.get("text-ignore-placement"),l.bucketInstanceId,fo,Ie.ID),r)){const os=l.bucketInstanceId;let ls=this.collisionCircleArrays[os];ls===void 0&&(ls=this.collisionCircleArrays[os]=new di);for(let Ur=0;Ur<Vs.circles.length;Ur+=4)ls.circles.push(Vs.circles[Ur+0]),ls.circles.push(Vs.circles[Ur+1]),ls.circles.push(Vs.circles[Ur+2]),ls.circles.push(Vs.collisionDetected?1:0)}if(Ei.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(l.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ei.crossTileID]=new li(Nn||Kt,nn||ii,Mn||l.justReloaded),i[Ei.crossTileID]=!0};if(si){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ei=l.getSortedSymbolIndexes(this.transform.angle);for(let Hi=Ei.length-1;Hi>=0;--Hi){const ji=Ei[Hi];$i(l.symbolInstances.get(ji),l.collisionArrays[ji])}}else for(let Ei=s.symbolInstanceStart;Ei<s.symbolInstanceEnd;Ei++)$i(l.symbolInstances.get(Ei),l.collisionArrays[Ei]);if(r&&l.bucketInstanceId in this.collisionCircleArrays){const Ei=this.collisionCircleArrays[l.bucketInstanceId];a.ar(Ei.invProjMatrix,y),Ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}l.justReloaded=!1}markUsedJustification(s,i,r,l){let d;d=l===a.ah.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[a.as(i)];const y=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const I of y)I>=0&&(s.text.placedSymbolArray.get(I).crossTileID=d>=0&&I!==d?0:r.crossTileID)}markUsedOrientation(s,i,r){const l=i===a.ah.horizontal||i===a.ah.horizontalOnly?i:0,d=i===a.ah.vertical?i:0,y=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const I of y)s.text.placedSymbolArray.get(I).placedOrientation=l;r.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let r=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const l=i?i.symbolFadeChange(s):1,d=i?i.opacities:{},y=i?i.variableOffsets:{},I=i?i.placedOrientations:{};for(const k in this.placements){const z=this.placements[k],Z=d[k];Z?(this.opacities[k]=new Me(Z,l,z.text,z.icon),r=r||z.text!==Z.text.placed||z.icon!==Z.icon.placed):(this.opacities[k]=new Me(null,l,z.text,z.icon,z.skipFade),r=r||z.text||z.icon)}for(const k in d){const z=d[k];if(!this.opacities[k]){const Z=new Me(z,l,!1,!1);Z.isHidden()||(this.opacities[k]=Z,r=r||z.text.placed||z.icon.placed)}}for(const k in y)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=y[k]);for(const k in I)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=I[k]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:s)}updateLayerOpacities(s,i){const r={};for(const l of i){const d=l.getBucket(s);d&&l.latestFeatureIndex&&s.id===d.layerIds[0]&&this.updateBucketOpacities(d,r,l.collisionBoxArray)}}updateBucketOpacities(s,i,r){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const l=s.layers[0],d=l.layout,y=new Me(null,0,!1,!1,!0),I=d.get("text-allow-overlap"),k=d.get("icon-allow-overlap"),z=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Z=d.get("text-rotation-alignment")==="map",Y=d.get("text-pitch-alignment")==="map",Ae=d.get("icon-text-fit")!=="none",Ie=new Me(null,0,I&&(k||!s.hasIconData()||d.get("icon-optional")),k&&(I||!s.hasTextData()||d.get("text-optional")),!0);!s.collisionArrays&&r&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(r);const ke=(Fe,ze,tt)=>{for(let wt=0;wt<ze/4;wt++)Fe.opacityVertexArray.emplaceBack(tt);Fe.hasVisibleVertices=Fe.hasVisibleVertices||tt!==Gn};for(let Fe=0;Fe<s.symbolInstances.length;Fe++){const ze=s.symbolInstances.get(Fe),{numHorizontalGlyphVertices:tt,numVerticalGlyphVertices:wt,crossTileID:lt}=ze;let ft=this.opacities[lt];i[lt]?ft=y:ft||(ft=Ie,this.opacities[lt]=ft),i[lt]=!0;const Tt=ze.numIconVertices>0,It=this.placedOrientations[ze.crossTileID],si=It===a.ah.vertical,Kt=It===a.ah.horizontal||It===a.ah.horizontalOnly;if(tt>0||wt>0){const ii=hr(ft.text);ke(s.text,tt,si?Gn:ii),ke(s.text,wt,Kt?Gn:ii);const ai=ft.text.isHidden();[ze.rightJustifiedTextSymbolIndex,ze.centerJustifiedTextSymbolIndex,ze.leftJustifiedTextSymbolIndex].forEach(Ei=>{Ei>=0&&(s.text.placedSymbolArray.get(Ei).hidden=ai||si?1:0)}),ze.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(ze.verticalPlacedTextSymbolIndex).hidden=ai||Kt?1:0);const Wi=this.variableOffsets[ze.crossTileID];Wi&&this.markUsedJustification(s,Wi.anchor,ze,It);const $i=this.placedOrientations[ze.crossTileID];$i&&(this.markUsedJustification(s,"left",ze,$i),this.markUsedOrientation(s,$i,ze))}if(Tt){const ii=hr(ft.icon),ai=!(Ae&&ze.verticalPlacedIconSymbolIndex&&si);ze.placedIconSymbolIndex>=0&&(ke(s.icon,ze.numIconVertices,ai?ii:Gn),s.icon.placedSymbolArray.get(ze.placedIconSymbolIndex).hidden=ft.icon.isHidden()),ze.verticalPlacedIconSymbolIndex>=0&&(ke(s.icon,ze.numVerticalIconVertices,ai?Gn:ii),s.icon.placedSymbolArray.get(ze.verticalPlacedIconSymbolIndex).hidden=ft.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const ii=s.collisionArrays[Fe];if(ii){let ai=new a.P(0,0);if(ii.textBox||ii.verticalTextBox){let $i=!0;if(z){const Ei=this.variableOffsets[lt];Ei?(ai=ui(Ei.anchor,Ei.width,Ei.height,Ei.textOffset,Ei.textBoxScale),Z&&ai._rotate(Y?this.transform.angle:-this.transform.angle)):$i=!1}ii.textBox&&Si(s.textCollisionBox.collisionVertexArray,ft.text.placed,!$i||si,ai.x,ai.y),ii.verticalTextBox&&Si(s.textCollisionBox.collisionVertexArray,ft.text.placed,!$i||Kt,ai.x,ai.y)}const Wi=!!(!Kt&&ii.verticalIconBox);ii.iconBox&&Si(s.iconCollisionBox.collisionVertexArray,ft.icon.placed,Wi,Ae?ai.x:0,Ae?ai.y:0),ii.verticalIconBox&&Si(s.iconCollisionBox.collisionVertexArray,ft.icon.placed,!Wi,Ae?ai.x:0,Ae?ai.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Fe.invProjMatrix,s.placementViewportMatrix=Fe.viewportMatrix,s.collisionCircleArray=Fe.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,i){const r=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*r>s}setStale(){this.stale=!0}}function Si(x,s,i,r,l){x.emplaceBack(s?1:0,i?1:0,r||0,l||0),x.emplaceBack(s?1:0,i?1:0,r||0,l||0),x.emplaceBack(s?1:0,i?1:0,r||0,l||0),x.emplaceBack(s?1:0,i?1:0,r||0,l||0)}const Jt=Math.pow(2,25),Sn=Math.pow(2,24),ur=Math.pow(2,17),mn=Math.pow(2,16),Hn=Math.pow(2,9),Yr=Math.pow(2,8),Qi=Math.pow(2,1);function hr(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const s=x.placed?1:0,i=Math.floor(127*x.opacity);return i*Jt+s*Sn+i*ur+s*mn+i*Hn+s*Yr+i*Qi+s}const Gn=0;class Xt{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,i,r,l,d){const y=this._bucketParts;for(;this._currentTileIndex<s.length;)if(i.getBucketParts(y,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((I,k)=>I.sortKey-k.sortKey));this._currentPartIndex<y.length;)if(i.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,d())return!0;return!1}}class en{constructor(s,i,r,l,d,y,I,k){this.placement=new bi(s,i,y,I,k),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(s,i,r){const l=oe.now(),d=()=>!this._forceFullPlacement&&oe.now()-l>2;for(;this._currentPlacementIndex>=0;){const y=i[s[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=I)&&(!y.maxzoom||y.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Xt(y)),this._inProgressLayer.continuePlacement(r[y.source],this.placement,this._showCollisionBoxes,y,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const qt=512/a.W/2;class kn{constructor(s,i,r){this.tileID=s,this.bucketInstanceId=r,this._symbolsByKey={};const l=new Map;for(let d=0;d<i.length;d++){const y=i.get(d),I=y.key,k=l.get(I);k?k.push(y):l.set(I,[y])}for(const[d,y]of l){const I={positions:y.map(k=>({x:Math.floor(k.anchorX*qt),y:Math.floor(k.anchorY*qt)})),crossTileIDs:y.map(k=>k.crossTileID)};if(I.positions.length>128){const k=new a.au(I.positions.length,16,Uint16Array);for(const{x:z,y:Z}of I.positions)k.add(z,Z);k.finish(),delete I.positions,I.index=k}this._symbolsByKey[d]=I}}getScaledCoordinates(s,i){const{x:r,y:l,z:d}=this.tileID.canonical,{x:y,y:I,z:k}=i.canonical,z=qt/Math.pow(2,k-d),Z=(I*a.W+s.anchorY)*z,Y=l*a.W*qt;return{x:Math.floor((y*a.W+s.anchorX)*z-r*a.W*qt),y:Math.floor(Z-Y)}}findMatches(s,i,r){const l=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let d=0;d<s.length;d++){const y=s.get(d);if(y.crossTileID)continue;const I=this._symbolsByKey[y.key];if(!I)continue;const k=this.getScaledCoordinates(y,i);if(I.index){const z=I.index.range(k.x-l,k.y-l,k.x+l,k.y+l).sort();for(const Z of z){const Y=I.crossTileIDs[Z];if(!r[Y]){r[Y]=!0,y.crossTileID=Y;break}}}else if(I.positions)for(let z=0;z<I.positions.length;z++){const Z=I.positions[z],Y=I.crossTileIDs[z];if(Math.abs(Z.x-k.x)<=l&&Math.abs(Z.y-k.y)<=l&&!r[Y]){r[Y]=!0,y.crossTileID=Y;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class Ar{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class js{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const i=Math.round((s-this.lng)/360);if(i!==0)for(const r in this.indexes){const l=this.indexes[r],d={};for(const y in l){const I=l[y];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+i),d[I.tileID.key]=I}this.indexes[r]=d}this.lng=s}addBucket(s,i,r){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let d=0;d<i.symbolInstances.length;d++)i.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const l=this.usedCrossTileIDs[s.overscaledZ];for(const d in this.indexes){const y=this.indexes[d];if(Number(d)>s.overscaledZ)for(const I in y){const k=y[I];k.tileID.isChildOf(s)&&k.findMatches(i.symbolInstances,s,l)}else{const I=y[s.scaledTo(Number(d)).key];I&&I.findMatches(i.symbolInstances,s,l)}}for(let d=0;d<i.symbolInstances.length;d++){const y=i.symbolInstances.get(d);y.crossTileID||(y.crossTileID=r.generate(),l[y.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new kn(s,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(s,i){for(const r of i.getCrossTileIDsLists())for(const l of r)delete this.usedCrossTileIDs[s][l]}removeStaleBuckets(s){let i=!1;for(const r in this.indexes){const l=this.indexes[r];for(const d in l)s[l[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,l[d]),delete l[d],i=!0)}return i}}class Qr{constructor(){this.layerIndexes={},this.crossTileIDs=new Ar,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,i,r){let l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new js);let d=!1;const y={};l.handleWrapJump(r);for(const I of i){const k=I.getBucket(s);k&&s.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(I.tileID,k,this.crossTileIDs)&&(d=!0),y[k.bucketInstanceId]=!0)}return l.removeStaleBuckets(y)&&(d=!0),d}pruneUnusedLayers(s){const i={};s.forEach(r=>{i[r]=!0});for(const r in this.layerIndexes)i[r]||delete this.layerIndexes[r]}}const Gt=(x,s)=>a.t(x,s&&s.filter(i=>i.identifier!=="source.canvas")),fr=a.av();class Bt extends a.E{constructor(s,i={}){super(),this._rtlTextPluginStateChange=()=>{for(const r in this.sourceCaches){const l=this.sourceCaches[r].getSource().type;l!=="vector"&&l!=="geojson"||this.sourceCaches[r].reload()}},this.map=s,this.dispatcher=new Ti(xn(),s._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(r,l)=>this.getGlyphs(r,l)),this.dispatcher.registerMessageHandler("getImages",(r,l)=>this.getImages(r,l)),this.imageManager=new Ye,this.imageManager.setEventedParent(this),this.glyphManager=new Ft(s._requestManager,i.localIdeographFontFamily),this.lineAtlas=new ki(256,512),this.crossTileSymbolIndex=new Qr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.ax()),K().on("pluginStateChange",this._rtlTextPluginStateChange),this.on("data",r=>{if(r.dataType!=="source"||r.sourceDataType!=="metadata")return;const l=this.sourceCaches[r.sourceId];if(!l)return;const d=l.getSource();if(d&&d.vectorLayerIds)for(const y in this._layers){const I=this._layers[y];I.source===d.id&&this._validateLayer(I)}})}loadURL(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const l=this.map._requestManager.transformRequest(s,zt.Style);this._loadStyleRequest=new AbortController,a.h(l,this._loadStyleRequest).then(d=>{this._loadStyleRequest=null,this._load(d.data,i,r)}).catch(d=>{this._loadStyleRequest=null,d&&this.fire(new a.j(d))})}loadJSON(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,oe.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(s,i,r)}).catch(()=>{})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(fr,{validate:!1})}_load(s,i,r){var l;const d=i.transformStyle?i.transformStyle(r,s):s;if(!i.validate||!Gt(this,a.x(d))){this._loaded=!0,this.stylesheet=d;for(const y in d.sources)this.addSource(y,d.sources[y],{validate:!1});d.sprite?this._loadSprite(d.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(d.glyphs),this._createLayers(),this.light=new Ci(this.stylesheet.light),this.map.setTerrain((l=this.stylesheet.terrain)!==null&&l!==void 0?l:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const s=a.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of s){const r=a.az(i);r.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=r}}_loadSprite(s,i=!1,r=void 0){let l;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(d,y,I,k){return a._(this,void 0,void 0,function*(){const z=yt(d),Z=I>1?"@2x":"",Y={},Ae={};for(const{id:Ie,url:ke}of z){const Fe=y.transformRequest(y.normalizeSpriteURL(ke,Z,".json"),zt.SpriteJSON);Y[Ie]=a.h(Fe,k);const ze=y.transformRequest(y.normalizeSpriteURL(ke,Z,".png"),zt.SpriteImage);Ae[Ie]=xt.getImage(ze,k)}return yield Promise.all([...Object.values(Y),...Object.values(Ae)]),function(Ie,ke){return a._(this,void 0,void 0,function*(){const Fe={};for(const ze in Ie){Fe[ze]={};const tt=oe.getImageCanvasContext((yield ke[ze]).data),wt=(yield Ie[ze]).data;for(const lt in wt){const{width:ft,height:Tt,x:It,y:si,sdf:Kt,pixelRatio:ii,stretchX:ai,stretchY:Wi,content:$i}=wt[lt];Fe[ze][lt]={data:null,pixelRatio:ii,sdf:Kt,stretchX:ai,stretchY:Wi,content:$i,spriteData:{width:ft,height:Tt,x:It,y:si,context:tt}}}}return Fe})}(Y,Ae)})}(s,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(d=>{if(this._spriteRequest=null,d)for(const y in d){this._spritesImagesIds[y]=[];const I=this._spritesImagesIds[y]?this._spritesImagesIds[y].filter(k=>!(k in d)):[];for(const k of I)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in d[y]){const z=y==="default"?k:`${y}:${k}`;this._spritesImagesIds[y].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,d[y][k],!1):this.imageManager.addImage(z,d[y][k]),i&&(this._changedImages[z]=!0)}}}).catch(d=>{this._spriteRequest=null,l=d,this.fire(new a.j(l))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),r&&r(l)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(s){const i=this.sourceCaches[s.source];if(!i)return;const r=s.sourceLayer;if(!r)return;const l=i.getSource();(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(r)===-1)&&this.fire(new a.j(new Error(`Source layer "${r}" does not exist on source "${l.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){const i=this._serializedAllLayers();if(!s||s.length===0)return Object.values(i);const r=[];for(const l of s)i[l]&&r.push(i[l]);return r}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const i=Object.keys(this._layers);for(const r of i){const l=this._layers[r];l.type!=="custom"&&(s[r]=l.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const i=this._changed;if(this._changed){const l=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(l.length||d.length)&&this._updateWorkerLayers(l,d);for(const y in this._updatedSources){const I=this._updatedSources[y];if(I==="reload")this._reloadSource(y);else{if(I!=="clear")throw new Error(`Invalid action ${I}`);this._clearSource(y)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const r={};for(const l in this.sourceCaches){const d=this.sourceCaches[l];r[l]=d.used,d.used=!1}for(const l of this._order){const d=this._layers[l];d.recalculate(s,this._availableImages),!d.isHidden(s.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const l in r){const d=this.sourceCaches[l];r[l]!==d.used&&d.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:l}))}this.light.recalculate(s),this.z=s.zoom,i&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,i){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,i={}){var r;this._checkLoaded();const l=this.serialize();if(s=i.transformStyle?i.transformStyle(l,s):s,((r=i.validate)===null||r===void 0||r)&&Gt(this,a.x(s)))return!1;(s=a.aA(s)).layers=a.ay(s.layers);const d=a.aB(l,s),y=this._getOperationsToPerform(d);if(y.unimplemented.length>0)throw new Error(`Unimplemented: ${y.unimplemented.join(", ")}.`);if(y.operations.length===0)return!1;for(const I of y.operations)I();return this.stylesheet=s,this._serializedLayers=null,!0}_getOperationsToPerform(s){const i=[],r=[];for(const l of s)switch(l.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,l.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,l.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,l.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,l.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,l.args));break;case"addSource":i.push(()=>this.addSource.apply(this,l.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,l.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,l.args));break;case"setLight":i.push(()=>this.setLight.apply(this,l.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,l.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,l.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,l.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,l.args));break;case"setTransition":i.push(()=>{});break;default:r.push(l.command)}return{operations:i,unimplemented:r}}addImage(s,i){if(this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,i),this._afterImageUpdated(s)}updateImage(s,i){this.imageManager.updateImage(s,i)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,i,r={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(a.x.source,`sources.${s}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const l=this.sourceCaches[s]=new Ee(s,i,this.dispatcher);l.style=this,l.setEventedParent(this,()=>({isSourceLoaded:l.loaded(),source:l.serialize(),sourceId:s})),l.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===s)return this.fire(new a.j(new Error(`Source "${s}" cannot be removed while layer "${r}" is using it.`)));const i=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],i.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,i){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const r=this.sourceCaches[s].getSource();if(r.type!=="geojson")throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(i),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,i,r={}){this._checkLoaded();const l=s.id;if(this.getLayer(l))return void this.fire(new a.j(new Error(`Layer "${l}" already exists on this map.`)));let d;if(s.type==="custom"){if(Gt(this,a.aC(s)))return;d=a.az(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(l,s.source),s=a.aA(s),s=a.e(s,{source:l})),this._validate(a.x.layer,`layers.${l}`,s,{arrayIndex:-1},r))return;d=a.az(s),this._validateLayer(d),d.setEventedParent(this,{layer:{id:l}})}const y=i?this._order.indexOf(i):this._order.length;if(i&&y===-1)this.fire(new a.j(new Error(`Cannot add layer "${l}" before non-existing layer "${i}".`)));else{if(this._order.splice(y,0,l),this._layerOrderChanged=!0,this._layers[l]=d,this._removedLayers[l]&&d.source&&d.type!=="custom"){const I=this._removedLayers[l];delete this._removedLayers[l],I.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(s,i){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.j(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===i)return;const r=this._order.indexOf(s);this._order.splice(r,1);const l=i?this._order.indexOf(i):this._order.length;i&&l===-1?this.fire(new a.j(new Error(`Cannot move layer "${s}" before non-existing layer "${i}".`))):(this._order.splice(l,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const i=this._layers[s];if(!i)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${s}".`)));i.setEventedParent(null);const r=this._order.indexOf(s);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=i,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],i.onRemove&&i.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,i,r){this._checkLoaded();const l=this.getLayer(s);l?l.minzoom===i&&l.maxzoom===r||(i!=null&&(l.minzoom=i),r!=null&&(l.maxzoom=r),this._updateLayer(l)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,i,r={}){this._checkLoaded();const l=this.getLayer(s);if(l){if(!a.aD(l.filter,i))return i==null?(l.filter=void 0,void this._updateLayer(l)):void(this._validate(a.x.filter,`layers.${l.id}.filter`,i,null,r)||(l.filter=a.aA(i),this._updateLayer(l)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return a.aA(this.getLayer(s).filter)}setLayoutProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getLayoutProperty(i),r)||(d.setLayoutProperty(i,r,l),this._updateLayer(d)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,i){const r=this.getLayer(s);if(r)return r.getLayoutProperty(i);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getPaintProperty(i),r)||(d.setPaintProperty(i,r,l)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,i){return this.getLayer(s).getPaintProperty(i)}setFeatureState(s,i){this._checkLoaded();const r=s.source,l=s.sourceLayer,d=this.sourceCaches[r];if(d===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const y=d.getSource().type;y==="geojson"&&l?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||l?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),d.setFeatureState(l,s.id,i)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,i){this._checkLoaded();const r=s.source,l=this.sourceCaches[r];if(l===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const d=l.getSource().type,y=d==="vector"?s.sourceLayer:void 0;d!=="vector"||y?i&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):l.removeFeatureState(y,s.id,i):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const i=s.source,r=s.sourceLayer,l=this.sourceCaches[i];if(l!==void 0)return l.getSource().type!=="vector"||r?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),l.getFeatureState(r,s.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const s=a.aE(this.sourceCaches,d=>d.serialize()),i=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,l=this.stylesheet;return a.aF({version:l.version,name:l.name,metadata:l.metadata,light:l.light,center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,sprite:l.sprite,glyphs:l.glyphs,transition:l.transition,sources:s,layers:i,terrain:r},d=>d!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const i=y=>this._layers[y].type==="fill-extrusion",r={},l=[];for(let y=this._order.length-1;y>=0;y--){const I=this._order[y];if(i(I)){r[I]=y;for(const k of s){const z=k[I];if(z)for(const Z of z)l.push(Z)}}}l.sort((y,I)=>I.intersectionZ-y.intersectionZ);const d=[];for(let y=this._order.length-1;y>=0;y--){const I=this._order[y];if(i(I))for(let k=l.length-1;k>=0;k--){const z=l[k].feature;if(r[z.layer.id]<y)break;d.push(z),l.pop()}else for(const k of s){const z=k[I];if(z)for(const Z of z)d.push(Z.feature)}}return d}queryRenderedFeatures(s,i,r){i&&i.filter&&this._validate(a.x.filter,"queryRenderedFeatures.filter",i.filter,null,i);const l={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const I of i.layers){const k=this._layers[I];if(!k)return this.fire(new a.j(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];l[k.source]=!0}}const d=[];i.availableImages=this._availableImages;const y=this._serializedAllLayers();for(const I in this.sourceCaches)i.layers&&!l[I]||d.push(Vi(this.sourceCaches[I],this._layers,y,s,i,r));return this.placement&&d.push(function(I,k,z,Z,Y,Ae,Ie){const ke={},Fe=Ae.queryRenderedSymbols(Z),ze=[];for(const tt of Object.keys(Fe).map(Number))ze.push(Ie[tt]);ze.sort(bn);for(const tt of ze){const wt=tt.featureIndex.lookupSymbolFeatures(Fe[tt.bucketInstanceId],k,tt.bucketIndex,tt.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,I);for(const lt in wt){const ft=ke[lt]=ke[lt]||[],Tt=wt[lt];Tt.sort((It,si)=>{const Kt=tt.featureSortOrder;if(Kt){const ii=Kt.indexOf(It.featureIndex);return Kt.indexOf(si.featureIndex)-ii}return si.featureIndex-It.featureIndex});for(const It of Tt)ft.push(It)}}for(const tt in ke)ke[tt].forEach(wt=>{const lt=wt.feature,ft=z[I[tt].source].getFeatureState(lt.layer["source-layer"],lt.id);lt.source=lt.layer.source,lt.layer["source-layer"]&&(lt.sourceLayer=lt.layer["source-layer"]),lt.state=ft});return ke}(this._layers,y,this.sourceCaches,s,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(s,i){i&&i.filter&&this._validate(a.x.filter,"querySourceFeatures.filter",i.filter,null,i);const r=this.sourceCaches[s];return r?function(l,d){const y=l.getRenderableIds().map(z=>l.getTileByID(z)),I=[],k={};for(let z=0;z<y.length;z++){const Z=y[z],Y=Z.tileID.canonical.key;k[Y]||(k[Y]=!0,Z.querySourceFeatures(I,d))}return I}(r,i):[]}getLight(){return this.light.getLight()}setLight(s,i={}){this._checkLoaded();const r=this.light.getLight();let l=!1;for(const y in s)if(!a.aD(s[y],r[y])){l=!0;break}if(!l)return;const d={now:oe.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,i),this.light.updateTransitions(d)}_validate(s,i,r,l,d={}){return(!d||d.validate!==!1)&&Gt(this,s.call(a.x,a.e({key:i,style:this.serialize(),value:r,styleSpec:a.v},l)))}_remove(s=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),K().off("pluginStateChange",this._rtlTextPluginStateChange);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const r=this.sourceCaches[i];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),s&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const i in this.sourceCaches)this.sourceCaches[i].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,i,r,l,d=!1){let y=!1,I=!1;const k={};for(const z of this._order){const Z=this._layers[z];if(Z.type!=="symbol")continue;if(!k[Z.source]){const Ae=this.sourceCaches[Z.source];k[Z.source]=Ae.getRenderableIds(!0).map(Ie=>Ae.getTileByID(Ie)).sort((Ie,ke)=>ke.tileID.overscaledZ-Ie.tileID.overscaledZ||(Ie.tileID.isLessThan(ke.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(Z,k[Z.source],s.center.lng);y=y||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||r===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(oe.now(),s.zoom))&&(this.pauseablePlacement=new en(s,this.map.terrain,this._order,d,i,r,l,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(oe.now()),I=!0),y&&this.pauseablePlacement.placement.setStale()),I||y)for(const z of this._order){const Z=this._layers[z];Z.type==="symbol"&&this.placement.updateLayerOpacities(Z,k[Z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(oe.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,i.icons),r})}getGlyphs(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.glyphManager.getGlyphs(i.stacks),l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,[""]),r})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,i={}){this._checkLoaded(),s&&this._validate(a.x.glyphs,"glyphs",s,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,i,r={},l){this._checkLoaded();const d=[{id:s,url:i}],y=[...yt(this.stylesheet.sprite),...d];this._validate(a.x.sprite,"sprite",y,null,r)||(this.stylesheet.sprite=y,this._loadSprite(d,!0,l))}removeSprite(s){this._checkLoaded();const i=yt(this.stylesheet.sprite);if(i.find(r=>r.id===s)){if(this._spritesImagesIds[s])for(const r of this._spritesImagesIds[s])this.imageManager.removeImage(r),this._changedImages[r]=!0;i.splice(i.findIndex(r=>r.id===s),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return yt(this.stylesheet.sprite)}setSprite(s,i={},r){this._checkLoaded(),s&&this._validate(a.x.sprite,"sprite",s,null,i)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,r):(this._unloadSprite(),r&&r(null)))}}var Gr=a.X([{name:"a_pos",type:"Int16",components:2}]),Zs="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const pa={prelude:Fr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Fr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Fr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Fr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Fr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Fr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Fr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Fr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Fr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Fr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Fr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Fr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Fr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Fr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Fr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Fr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Fr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Fr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Fr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Fr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Fr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Fr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Fr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Fr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Zs),terrainDepth:Fr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Zs),terrainCoords:Fr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Zs)};function Fr(x,s){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=s.match(/attribute ([\w]+) ([\w]+)/g),l=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=d?d.concat(l):l,I={};return{fragmentSource:x=x.replace(i,(k,z,Z,Y,Ae)=>(I[Ae]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
varying ${Z} ${Y} ${Ae};
#else
uniform ${Z} ${Y} u_${Ae};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Ae}
    ${Z} ${Y} ${Ae} = u_${Ae};
#endif
`)),vertexSource:s=s.replace(i,(k,z,Z,Y,Ae)=>{const Ie=Y==="float"?"vec2":"vec4",ke=Ae.match(/color/)?"color":Ie;return I[Ae]?z==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
uniform lowp float u_${Ae}_t;
attribute ${Z} ${Ie} a_${Ae};
varying ${Z} ${Y} ${Ae};
#else
uniform ${Z} ${Y} u_${Ae};
#endif
`:ke==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Ae} = a_${Ae};
#else
    ${Z} ${Y} ${Ae} = u_${Ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Ae} = unpack_mix_${ke}(a_${Ae}, u_${Ae}_t);
#else
    ${Z} ${Y} ${Ae} = u_${Ae};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
uniform lowp float u_${Ae}_t;
attribute ${Z} ${Ie} a_${Ae};
#else
uniform ${Z} ${Y} u_${Ae};
#endif
`:ke==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Z} ${Y} ${Ae} = a_${Ae};
#else
    ${Z} ${Y} ${Ae} = u_${Ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Z} ${Y} ${Ae} = unpack_mix_${ke}(a_${Ae}, u_${Ae}_t);
#else
    ${Z} ${Y} ${Ae} = u_${Ae};
#endif
`}),staticAttributes:r,staticUniforms:y}}class Za{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,i,r,l,d,y,I,k,z){this.context=s;let Z=this.boundPaintVertexBuffers.length!==l.length;for(let Y=0;!Z&&Y<l.length;Y++)this.boundPaintVertexBuffers[Y]!==l[Y]&&(Z=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==r||Z||this.boundIndexBuffer!==d||this.boundVertexOffset!==y||this.boundDynamicVertexBuffer!==I||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==z?this.freshBind(i,r,l,d,y,I,k,z):(s.bindVertexArray.set(this.vao),I&&I.bind(),d&&d.dynamicDraw&&d.bind(),k&&k.bind(),z&&z.bind())}freshBind(s,i,r,l,d,y,I,k){const z=s.numAttributes,Z=this.context,Y=Z.gl;this.vao&&this.destroy(),this.vao=Z.createVertexArray(),Z.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=l,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=k,i.enableAttributes(Y,s);for(const Ae of r)Ae.enableAttributes(Y,s);y&&y.enableAttributes(Y,s),I&&I.enableAttributes(Y,s),k&&k.enableAttributes(Y,s),i.bind(),i.setVertexAttribPointers(Y,s,d);for(const Ae of r)Ae.bind(),Ae.setVertexAttribPointers(Y,s,d);y&&(y.bind(),y.setVertexAttribPointers(Y,s,d)),l&&l.bind(),I&&(I.bind(),I.setVertexAttribPointers(Y,s,d)),k&&(k.bind(),k.setVertexAttribPointers(Y,s,d)),Z.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Oo(x){const s=[];for(let i=0;i<x.length;i++){if(x[i]===null)continue;const r=x[i].split(" ");s.push(r.pop())}return s}class Qa{constructor(s,i,r,l,d,y){const I=s.gl;this.program=I.createProgram();const k=Oo(i.staticAttributes),z=r?r.getBinderAttributes():[],Z=k.concat(z),Y=pa.prelude.staticUniforms?Oo(pa.prelude.staticUniforms):[],Ae=i.staticUniforms?Oo(i.staticUniforms):[],Ie=r?r.getBinderUniforms():[],ke=Y.concat(Ae).concat(Ie),Fe=[];for(const It of ke)Fe.indexOf(It)<0&&Fe.push(It);const ze=r?r.defines():[];d&&ze.push("#define OVERDRAW_INSPECTOR;"),y&&ze.push("#define TERRAIN3D;");const tt=ze.concat(pa.prelude.fragmentSource,i.fragmentSource).join(`
`),wt=ze.concat(pa.prelude.vertexSource,i.vertexSource).join(`
`),lt=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(lt,tt),I.compileShader(lt),!I.getShaderParameter(lt,I.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${I.getShaderInfoLog(lt)}`);I.attachShader(this.program,lt);const ft=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(ft,wt),I.compileShader(ft),!I.getShaderParameter(ft,I.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${I.getShaderInfoLog(ft)}`);I.attachShader(this.program,ft),this.attributes={};const Tt={};this.numAttributes=Z.length;for(let It=0;It<this.numAttributes;It++)Z[It]&&(I.bindAttribLocation(this.program,It,Z[It]),this.attributes[Z[It]]=It);if(I.linkProgram(this.program),!I.getProgramParameter(this.program,I.LINK_STATUS))throw new Error(`Program failed to link: ${I.getProgramInfoLog(this.program)}`);I.deleteShader(ft),I.deleteShader(lt);for(let It=0;It<Fe.length;It++){const si=Fe[It];if(si&&!Tt[si]){const Kt=I.getUniformLocation(this.program,si);Kt&&(Tt[si]=Kt)}}this.fixedUniforms=l(s,Tt),this.terrainUniforms=((It,si)=>({u_depth:new a.aG(It,si.u_depth),u_terrain:new a.aG(It,si.u_terrain),u_terrain_dim:new a.aH(It,si.u_terrain_dim),u_terrain_matrix:new a.aI(It,si.u_terrain_matrix),u_terrain_unpack:new a.aJ(It,si.u_terrain_unpack),u_terrain_exaggeration:new a.aH(It,si.u_terrain_exaggeration)}))(s,Tt),this.binderUniforms=r?r.getUniforms(s,Tt):[]}draw(s,i,r,l,d,y,I,k,z,Z,Y,Ae,Ie,ke,Fe,ze,tt,wt){const lt=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(r),s.setStencilMode(l),s.setColorMode(d),s.setCullFace(y),k){s.activeTexture.set(lt.TEXTURE2),lt.bindTexture(lt.TEXTURE_2D,k.depthTexture),s.activeTexture.set(lt.TEXTURE3),lt.bindTexture(lt.TEXTURE_2D,k.texture);for(const Tt in this.terrainUniforms)this.terrainUniforms[Tt].set(k[Tt])}for(const Tt in this.fixedUniforms)this.fixedUniforms[Tt].set(I[Tt]);Fe&&Fe.setUniforms(s,this.binderUniforms,Ie,{zoom:ke});let ft=0;switch(i){case lt.LINES:ft=2;break;case lt.TRIANGLES:ft=3;break;case lt.LINE_STRIP:ft=1}for(const Tt of Ae.get()){const It=Tt.vaos||(Tt.vaos={});(It[z]||(It[z]=new Za)).bind(s,this,Z,Fe?Fe.getPaintVertexBuffers():[],Y,Tt.vertexOffset,ze,tt,wt),lt.drawElements(i,Tt.primitiveLength*ft,lt.UNSIGNED_SHORT,Tt.primitiveOffset*ft*2)}}}function ia(x,s,i){const r=1/Pt(i,1,s.transform.tileZoom),l=Math.pow(2,i.tileID.overscaledZ),d=i.tileSize*Math.pow(2,s.transform.tileZoom)/l,y=d*(i.tileID.canonical.x+i.tileID.wrap*l),I=d*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[y>>16,I>>16],u_pixel_coord_lower:[65535&y,65535&I]}}const Qn=(x,s,i,r)=>{const l=s.style.light,d=l.properties.get("position"),y=[d.x,d.y,d.z],I=function(){var z=new a.A(9);return a.A!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[5]=0,z[6]=0,z[7]=0),z[0]=1,z[4]=1,z[8]=1,z}();l.properties.get("anchor")==="viewport"&&function(z,Z){var Y=Math.sin(Z),Ae=Math.cos(Z);z[0]=Ae,z[1]=Y,z[2]=0,z[3]=-Y,z[4]=Ae,z[5]=0,z[6]=0,z[7]=0,z[8]=1}(I,-s.transform.angle),function(z,Z,Y){var Ae=Z[0],Ie=Z[1],ke=Z[2];z[0]=Ae*Y[0]+Ie*Y[3]+ke*Y[6],z[1]=Ae*Y[1]+Ie*Y[4]+ke*Y[7],z[2]=Ae*Y[2]+Ie*Y[5]+ke*Y[8]}(y,y,I);const k=l.properties.get("color");return{u_matrix:x,u_lightpos:y,u_lightintensity:l.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+i,u_opacity:r}},Aa=(x,s,i,r,l,d,y)=>a.e(Qn(x,s,i,r),ia(d,s,y),{u_height_factor:-Math.pow(2,l.overscaledZ)/y.tileSize/8}),ds=x=>({u_matrix:x}),Wa=(x,s,i,r)=>a.e(ds(x),ia(i,s,r)),ol=(x,s)=>({u_matrix:x,u_world:s}),ll=(x,s,i,r,l)=>a.e(Wa(x,s,i,r),{u_world:l}),lo=(x,s,i,r)=>{const l=x.transform;let d,y;if(r.paint.get("circle-pitch-alignment")==="map"){const I=Pt(i,1,l.zoom);d=!0,y=[I,I]}else d=!1,y=l.pixelsToGLUnits;return{u_camera_to_center_distance:l.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_matrix:x.translatePosMatrix(s.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:x.pixelRatio,u_extrude_scale:y}},$a=(x,s,i)=>{const r=Pt(i,1,s.zoom),l=Math.pow(2,s.zoom-i.tileID.overscaledZ),d=i.tileID.overscaleFactor();return{u_matrix:x,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[s.pixelsToGLUnits[0]/(r*l),s.pixelsToGLUnits[1]/(r*l)],u_overscale_factor:d}},G=(x,s,i=1)=>({u_matrix:x,u_color:s,u_overlay:0,u_overlay_scale:i}),we=x=>({u_matrix:x}),at=(x,s,i,r)=>({u_matrix:x,u_extrude_scale:Pt(s,1,i),u_intensity:r});function Ct(x,s){const i=Math.pow(2,s.canonical.z),r=s.canonical.y;return[new a.Y(0,r/i).toLngLat().lat,new a.Y(0,(r+1)/i).toLngLat().lat]}const Yt=(x,s,i,r)=>{const l=x.transform;return{u_matrix:or(x,s,i,r),u_ratio:1/Pt(s,1,l.zoom),u_device_pixel_ratio:x.pixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},Ii=(x,s,i,r,l)=>a.e(Yt(x,s,i,l),{u_image:0,u_image_height:r}),Li=(x,s,i,r,l)=>{const d=x.transform,y=pn(s,d);return{u_matrix:or(x,s,i,l),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Pt(s,1,d.zoom),u_device_pixel_ratio:x.pixelRatio,u_image:0,u_scale:[y,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},An=(x,s,i,r,l,d)=>{const y=x.lineAtlas,I=pn(s,x.transform),k=i.layout.get("line-cap")==="round",z=y.getDash(r.from,k),Z=y.getDash(r.to,k),Y=z.width*l.fromScale,Ae=Z.width*l.toScale;return a.e(Yt(x,s,i,d),{u_patternscale_a:[I/Y,-z.height/2],u_patternscale_b:[I/Ae,-Z.height/2],u_sdfgamma:y.width/(256*Math.min(Y,Ae)*x.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:Z.y,u_mix:l.t})};function pn(x,s){return 1/Pt(x,1,s.tileZoom)}function or(x,s,i,r){return x.translatePosMatrix(r?r.posMatrix:s.tileID.posMatrix,s,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const dr=(x,s,i,r,l)=>{return{u_matrix:x,u_tl_parent:s,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(y=l.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(d=l.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:qr(l.paint.get("raster-hue-rotate"))};var d,y};function qr(x){x*=Math.PI/180;const s=Math.sin(x),i=Math.cos(x);return[(2*i+1)/3,(-Math.sqrt(3)*s-i+1)/3,(Math.sqrt(3)*s-i+1)/3]}const Xa=(x,s,i,r,l,d,y,I,k,z)=>{const Z=l.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:Z.width/Z.height,u_fade_change:l.options.fadeDuration?l.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:y,u_coord_matrix:I,u_is_text:+k,u_pitch_with_map:+r,u_texsize:z,u_texture:0}},Ya=(x,s,i,r,l,d,y,I,k,z,Z)=>{const Y=l.transform;return a.e(Xa(x,s,i,r,l,d,y,I,k,z),{u_gamma_scale:r?Math.cos(Y._pitch)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:l.pixelRatio,u_is_halo:+Z})},Ka=(x,s,i,r,l,d,y,I,k,z)=>a.e(Ya(x,s,i,r,l,d,y,I,!0,k,!0),{u_texsize_icon:z,u_texture_icon:1}),ml=(x,s,i)=>({u_matrix:x,u_opacity:s,u_color:i}),Wr=(x,s,i,r,l,d)=>a.e(function(y,I,k,z){const Z=k.imageManager.getPattern(y.from.toString()),Y=k.imageManager.getPattern(y.to.toString()),{width:Ae,height:Ie}=k.imageManager.getPixelSize(),ke=Math.pow(2,z.tileID.overscaledZ),Fe=z.tileSize*Math.pow(2,k.transform.tileZoom)/ke,ze=Fe*(z.tileID.canonical.x+z.tileID.wrap*ke),tt=Fe*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:Y.tl,u_pattern_br_b:Y.br,u_texsize:[Ae,Ie],u_mix:I.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:Y.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/Pt(z,1,k.transform.tileZoom),u_pixel_coord_upper:[ze>>16,tt>>16],u_pixel_coord_lower:[65535&ze,65535&tt]}}(r,d,i,l),{u_matrix:x,u_opacity:s}),sr={fillExtrusion:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_lightpos:new a.aK(x,s.u_lightpos),u_lightintensity:new a.aH(x,s.u_lightintensity),u_lightcolor:new a.aK(x,s.u_lightcolor),u_vertical_gradient:new a.aH(x,s.u_vertical_gradient),u_opacity:new a.aH(x,s.u_opacity)}),fillExtrusionPattern:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_lightpos:new a.aK(x,s.u_lightpos),u_lightintensity:new a.aH(x,s.u_lightintensity),u_lightcolor:new a.aK(x,s.u_lightcolor),u_vertical_gradient:new a.aH(x,s.u_vertical_gradient),u_height_factor:new a.aH(x,s.u_height_factor),u_image:new a.aG(x,s.u_image),u_texsize:new a.aL(x,s.u_texsize),u_pixel_coord_upper:new a.aL(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(x,s.u_pixel_coord_lower),u_scale:new a.aK(x,s.u_scale),u_fade:new a.aH(x,s.u_fade),u_opacity:new a.aH(x,s.u_opacity)}),fill:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix)}),fillPattern:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_image:new a.aG(x,s.u_image),u_texsize:new a.aL(x,s.u_texsize),u_pixel_coord_upper:new a.aL(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(x,s.u_pixel_coord_lower),u_scale:new a.aK(x,s.u_scale),u_fade:new a.aH(x,s.u_fade)}),fillOutline:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_world:new a.aL(x,s.u_world)}),fillOutlinePattern:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_world:new a.aL(x,s.u_world),u_image:new a.aG(x,s.u_image),u_texsize:new a.aL(x,s.u_texsize),u_pixel_coord_upper:new a.aL(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(x,s.u_pixel_coord_lower),u_scale:new a.aK(x,s.u_scale),u_fade:new a.aH(x,s.u_fade)}),circle:(x,s)=>({u_camera_to_center_distance:new a.aH(x,s.u_camera_to_center_distance),u_scale_with_map:new a.aG(x,s.u_scale_with_map),u_pitch_with_map:new a.aG(x,s.u_pitch_with_map),u_extrude_scale:new a.aL(x,s.u_extrude_scale),u_device_pixel_ratio:new a.aH(x,s.u_device_pixel_ratio),u_matrix:new a.aI(x,s.u_matrix)}),collisionBox:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_camera_to_center_distance:new a.aH(x,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aH(x,s.u_pixels_to_tile_units),u_extrude_scale:new a.aL(x,s.u_extrude_scale),u_overscale_factor:new a.aH(x,s.u_overscale_factor)}),collisionCircle:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_inv_matrix:new a.aI(x,s.u_inv_matrix),u_camera_to_center_distance:new a.aH(x,s.u_camera_to_center_distance),u_viewport_size:new a.aL(x,s.u_viewport_size)}),debug:(x,s)=>({u_color:new a.aM(x,s.u_color),u_matrix:new a.aI(x,s.u_matrix),u_overlay:new a.aG(x,s.u_overlay),u_overlay_scale:new a.aH(x,s.u_overlay_scale)}),clippingMask:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix)}),heatmap:(x,s)=>({u_extrude_scale:new a.aH(x,s.u_extrude_scale),u_intensity:new a.aH(x,s.u_intensity),u_matrix:new a.aI(x,s.u_matrix)}),heatmapTexture:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_world:new a.aL(x,s.u_world),u_image:new a.aG(x,s.u_image),u_color_ramp:new a.aG(x,s.u_color_ramp),u_opacity:new a.aH(x,s.u_opacity)}),hillshade:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_image:new a.aG(x,s.u_image),u_latrange:new a.aL(x,s.u_latrange),u_light:new a.aL(x,s.u_light),u_shadow:new a.aM(x,s.u_shadow),u_highlight:new a.aM(x,s.u_highlight),u_accent:new a.aM(x,s.u_accent)}),hillshadePrepare:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_image:new a.aG(x,s.u_image),u_dimension:new a.aL(x,s.u_dimension),u_zoom:new a.aH(x,s.u_zoom),u_unpack:new a.aJ(x,s.u_unpack)}),line:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_ratio:new a.aH(x,s.u_ratio),u_device_pixel_ratio:new a.aH(x,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(x,s.u_units_to_pixels)}),lineGradient:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_ratio:new a.aH(x,s.u_ratio),u_device_pixel_ratio:new a.aH(x,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(x,s.u_units_to_pixels),u_image:new a.aG(x,s.u_image),u_image_height:new a.aH(x,s.u_image_height)}),linePattern:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_texsize:new a.aL(x,s.u_texsize),u_ratio:new a.aH(x,s.u_ratio),u_device_pixel_ratio:new a.aH(x,s.u_device_pixel_ratio),u_image:new a.aG(x,s.u_image),u_units_to_pixels:new a.aL(x,s.u_units_to_pixels),u_scale:new a.aK(x,s.u_scale),u_fade:new a.aH(x,s.u_fade)}),lineSDF:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_ratio:new a.aH(x,s.u_ratio),u_device_pixel_ratio:new a.aH(x,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(x,s.u_units_to_pixels),u_patternscale_a:new a.aL(x,s.u_patternscale_a),u_patternscale_b:new a.aL(x,s.u_patternscale_b),u_sdfgamma:new a.aH(x,s.u_sdfgamma),u_image:new a.aG(x,s.u_image),u_tex_y_a:new a.aH(x,s.u_tex_y_a),u_tex_y_b:new a.aH(x,s.u_tex_y_b),u_mix:new a.aH(x,s.u_mix)}),raster:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_tl_parent:new a.aL(x,s.u_tl_parent),u_scale_parent:new a.aH(x,s.u_scale_parent),u_buffer_scale:new a.aH(x,s.u_buffer_scale),u_fade_t:new a.aH(x,s.u_fade_t),u_opacity:new a.aH(x,s.u_opacity),u_image0:new a.aG(x,s.u_image0),u_image1:new a.aG(x,s.u_image1),u_brightness_low:new a.aH(x,s.u_brightness_low),u_brightness_high:new a.aH(x,s.u_brightness_high),u_saturation_factor:new a.aH(x,s.u_saturation_factor),u_contrast_factor:new a.aH(x,s.u_contrast_factor),u_spin_weights:new a.aK(x,s.u_spin_weights)}),symbolIcon:(x,s)=>({u_is_size_zoom_constant:new a.aG(x,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(x,s.u_is_size_feature_constant),u_size_t:new a.aH(x,s.u_size_t),u_size:new a.aH(x,s.u_size),u_camera_to_center_distance:new a.aH(x,s.u_camera_to_center_distance),u_pitch:new a.aH(x,s.u_pitch),u_rotate_symbol:new a.aG(x,s.u_rotate_symbol),u_aspect_ratio:new a.aH(x,s.u_aspect_ratio),u_fade_change:new a.aH(x,s.u_fade_change),u_matrix:new a.aI(x,s.u_matrix),u_label_plane_matrix:new a.aI(x,s.u_label_plane_matrix),u_coord_matrix:new a.aI(x,s.u_coord_matrix),u_is_text:new a.aG(x,s.u_is_text),u_pitch_with_map:new a.aG(x,s.u_pitch_with_map),u_texsize:new a.aL(x,s.u_texsize),u_texture:new a.aG(x,s.u_texture)}),symbolSDF:(x,s)=>({u_is_size_zoom_constant:new a.aG(x,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(x,s.u_is_size_feature_constant),u_size_t:new a.aH(x,s.u_size_t),u_size:new a.aH(x,s.u_size),u_camera_to_center_distance:new a.aH(x,s.u_camera_to_center_distance),u_pitch:new a.aH(x,s.u_pitch),u_rotate_symbol:new a.aG(x,s.u_rotate_symbol),u_aspect_ratio:new a.aH(x,s.u_aspect_ratio),u_fade_change:new a.aH(x,s.u_fade_change),u_matrix:new a.aI(x,s.u_matrix),u_label_plane_matrix:new a.aI(x,s.u_label_plane_matrix),u_coord_matrix:new a.aI(x,s.u_coord_matrix),u_is_text:new a.aG(x,s.u_is_text),u_pitch_with_map:new a.aG(x,s.u_pitch_with_map),u_texsize:new a.aL(x,s.u_texsize),u_texture:new a.aG(x,s.u_texture),u_gamma_scale:new a.aH(x,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(x,s.u_device_pixel_ratio),u_is_halo:new a.aG(x,s.u_is_halo)}),symbolTextAndIcon:(x,s)=>({u_is_size_zoom_constant:new a.aG(x,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(x,s.u_is_size_feature_constant),u_size_t:new a.aH(x,s.u_size_t),u_size:new a.aH(x,s.u_size),u_camera_to_center_distance:new a.aH(x,s.u_camera_to_center_distance),u_pitch:new a.aH(x,s.u_pitch),u_rotate_symbol:new a.aG(x,s.u_rotate_symbol),u_aspect_ratio:new a.aH(x,s.u_aspect_ratio),u_fade_change:new a.aH(x,s.u_fade_change),u_matrix:new a.aI(x,s.u_matrix),u_label_plane_matrix:new a.aI(x,s.u_label_plane_matrix),u_coord_matrix:new a.aI(x,s.u_coord_matrix),u_is_text:new a.aG(x,s.u_is_text),u_pitch_with_map:new a.aG(x,s.u_pitch_with_map),u_texsize:new a.aL(x,s.u_texsize),u_texsize_icon:new a.aL(x,s.u_texsize_icon),u_texture:new a.aG(x,s.u_texture),u_texture_icon:new a.aG(x,s.u_texture_icon),u_gamma_scale:new a.aH(x,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(x,s.u_device_pixel_ratio),u_is_halo:new a.aG(x,s.u_is_halo)}),background:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_opacity:new a.aH(x,s.u_opacity),u_color:new a.aM(x,s.u_color)}),backgroundPattern:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_opacity:new a.aH(x,s.u_opacity),u_image:new a.aG(x,s.u_image),u_pattern_tl_a:new a.aL(x,s.u_pattern_tl_a),u_pattern_br_a:new a.aL(x,s.u_pattern_br_a),u_pattern_tl_b:new a.aL(x,s.u_pattern_tl_b),u_pattern_br_b:new a.aL(x,s.u_pattern_br_b),u_texsize:new a.aL(x,s.u_texsize),u_mix:new a.aH(x,s.u_mix),u_pattern_size_a:new a.aL(x,s.u_pattern_size_a),u_pattern_size_b:new a.aL(x,s.u_pattern_size_b),u_scale_a:new a.aH(x,s.u_scale_a),u_scale_b:new a.aH(x,s.u_scale_b),u_pixel_coord_upper:new a.aL(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(x,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aH(x,s.u_tile_units_to_pixels)}),terrain:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_texture:new a.aG(x,s.u_texture),u_ele_delta:new a.aH(x,s.u_ele_delta)}),terrainDepth:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_ele_delta:new a.aH(x,s.u_ele_delta)}),terrainCoords:(x,s)=>({u_matrix:new a.aI(x,s.u_matrix),u_texture:new a.aG(x,s.u_texture),u_terrain_coords_id:new a.aH(x,s.u_terrain_coords_id),u_ele_delta:new a.aH(x,s.u_ele_delta)})};class Mr{constructor(s,i,r){this.context=s;const l=s.gl;this.buffer=l.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Or={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ys{constructor(s,i,r,l){this.length=i.length,this.attributes=r,this.itemSize=i.bytesPerElement,this.dynamicDraw=l,this.context=s;const d=s.gl;this.buffer=d.createBuffer(),s.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,i){for(let r=0;r<this.attributes.length;r++){const l=i.attributes[this.attributes[r].name];l!==void 0&&s.enableVertexAttribArray(l)}}setVertexAttribPointers(s,i,r){for(let l=0;l<this.attributes.length;l++){const d=this.attributes[l],y=i.attributes[d.name];y!==void 0&&s.vertexAttribPointer(y,d.components,s[Or[d.type]],!1,this.itemSize,d.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Sr=new WeakMap;function ra(x){var s;if(Sr.has(x))return Sr.get(x);{const i=(s=x.getParameter(x.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return Sr.set(x,i),i}}class Nr{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ko extends Nr{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Qo extends Nr{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Ns extends Nr{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Tl extends Nr{getDefault(){return[!0,!0,!0,!0]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class yo extends Nr{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Wo extends Nr{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class ma extends Nr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const i=this.current;(s.func!==i.func||s.ref!==i.ref||s.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class na extends Nr{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class kl extends Nr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=s,this.dirty=!1}}class Ja extends Nr{getDefault(){return[0,1]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Fa extends Nr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=s,this.dirty=!1}}class gl extends Nr{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Ml extends Nr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.BLEND):i.disable(i.BLEND),this.current=s,this.dirty=!1}}class yu extends Nr{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class ps extends Nr{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class lc extends Nr{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class uo extends Nr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=s,this.dirty=!1}}class co extends Nr{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Xl extends Nr{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class No extends Nr{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class $o extends Nr{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Mo extends Nr{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Qs extends Nr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Xo extends Nr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Yo extends Nr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Ko extends Nr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Ta extends Nr{getDefault(){return null}set(s){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class eo extends Nr{getDefault(){return null}set(s){var i;if(s===this.current&&!this.dirty)return;const r=this.gl;ra(r)?r.bindVertexArray(s):(i=r.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class Ds extends Nr{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class vu extends Nr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Pr extends Nr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Kn extends Nr{constructor(s,i){super(s),this.context=s,this.parent=i}getDefault(){return null}}class Jo extends Kn{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Vr extends Kn{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class to extends Kn{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class ss{constructor(s,i,r,l,d){this.context=s,this.width=i,this.height=r;const y=s.gl,I=this.framebuffer=y.createFramebuffer();if(this.colorAttachment=new Jo(s,I),l)this.depthAttachment=d?new to(s,I):new Vr(s,I);else if(d)throw new Error("Stencil cannot be set without depth");if(y.checkFramebufferStatus(y.FRAMEBUFFER)!==y.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,i=this.colorAttachment.get();if(i&&s.deleteTexture(i),this.depthAttachment){const r=this.depthAttachment.get();r&&s.deleteRenderbuffer(r)}s.deleteFramebuffer(this.framebuffer)}}class pr{constructor(s,i,r){this.blendFunction=s,this.blendColor=i,this.mask=r}}pr.Replace=[1,0],pr.disabled=new pr(pr.Replace,a.aO.transparent,[!1,!1,!1,!1]),pr.unblended=new pr(pr.Replace,a.aO.transparent,[!0,!0,!0,!0]),pr.alphaBlended=new pr([1,771],a.aO.transparent,[!0,!0,!0,!0]);class Po{constructor(s){var i,r;if(this.gl=s,this.clearColor=new ko(this),this.clearDepth=new Qo(this),this.clearStencil=new Ns(this),this.colorMask=new Tl(this),this.depthMask=new yo(this),this.stencilMask=new Wo(this),this.stencilFunc=new ma(this),this.stencilOp=new na(this),this.stencilTest=new kl(this),this.depthRange=new Ja(this),this.depthTest=new Fa(this),this.depthFunc=new gl(this),this.blend=new Ml(this),this.blendFunc=new yu(this),this.blendColor=new ps(this),this.blendEquation=new lc(this),this.cullFace=new uo(this),this.cullFaceSide=new co(this),this.frontFace=new Xl(this),this.program=new No(this),this.activeTexture=new $o(this),this.viewport=new Mo(this),this.bindFramebuffer=new Qs(this),this.bindRenderbuffer=new Xo(this),this.bindTexture=new Yo(this),this.bindVertexBuffer=new Ko(this),this.bindElementBuffer=new Ta(this),this.bindVertexArray=new eo(this),this.pixelStoreUnpack=new Ds(this),this.pixelStoreUnpackPremultiplyAlpha=new vu(this),this.pixelStoreUnpackFlipY=new Pr(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),ra(s)){this.HALF_FLOAT=s.HALF_FLOAT;const l=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=s.RGBA16F)!==null&&i!==void 0?i:l==null?void 0:l.RGBA16F_EXT,this.RGB16F=(r=s.RGB16F)!==null&&r!==void 0?r:l==null?void 0:l.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const l=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=l==null?void 0:l.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,i){return new Mr(this,s,i)}createVertexBuffer(s,i,r){return new Ys(this,s,i,r)}createRenderbuffer(s,i,r){const l=this.gl,d=l.createRenderbuffer();return this.bindRenderbuffer.set(d),l.renderbufferStorage(l.RENDERBUFFER,s,i,r),this.bindRenderbuffer.set(null),d}createFramebuffer(s,i,r,l){return new ss(this,s,i,r,l)}clear({color:s,depth:i,stencil:r}){const l=this.gl;let d=0;s&&(d|=l.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(d|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),r!==void 0&&(d|=l.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),l.clear(d)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){a.aD(s.blendFunction,pr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return ra(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var i;return ra(this.gl)?this.gl.deleteVertexArray(s):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class qn{constructor(s,i,r){this.func=s,this.mask=i,this.range=r}}qn.ReadOnly=!1,qn.ReadWrite=!0,qn.disabled=new qn(519,qn.ReadOnly,[0,1]);const Ul=7680;class as{constructor(s,i,r,l,d,y){this.test=s,this.ref=i,this.mask=r,this.fail=l,this.depthFail=d,this.pass=y}}as.disabled=new as({func:519,mask:0},0,0,Ul,Ul,Ul);class Kr{constructor(s,i,r){this.enable=s,this.mode=i,this.frontFace=r}}let Ls;function Br(x,s,i,r,l,d,y){const I=x.context,k=I.gl,z=x.useProgram("collisionBox"),Z=[];let Y=0,Ae=0;for(let lt=0;lt<r.length;lt++){const ft=r[lt],Tt=s.getTile(ft),It=Tt.getBucket(i);if(!It)continue;let si=ft.posMatrix;l[0]===0&&l[1]===0||(si=x.translatePosMatrix(ft.posMatrix,Tt,l,d));const Kt=y?It.textCollisionBox:It.iconCollisionBox,ii=It.collisionCircleArray;if(ii.length>0){const ai=a.F(),Wi=si;a.aP(ai,It.placementInvProjMatrix,x.transform.glCoordMatrix),a.aP(ai,ai,It.placementViewportMatrix),Z.push({circleArray:ii,circleOffset:Ae,transform:Wi,invTransform:ai,coord:ft}),Y+=ii.length/4,Ae=Y}Kt&&z.draw(I,k.LINES,qn.disabled,as.disabled,x.colorModeForRenderPass(),Kr.disabled,$a(si,x.transform,Tt),x.style.map.terrain&&x.style.map.terrain.getTerrainData(ft),i.id,Kt.layoutVertexBuffer,Kt.indexBuffer,Kt.segments,null,x.transform.zoom,null,null,Kt.collisionVertexBuffer)}if(!y||!Z.length)return;const Ie=x.useProgram("collisionCircle"),ke=new a.aQ;ke.resize(4*Y),ke._trim();let Fe=0;for(const lt of Z)for(let ft=0;ft<lt.circleArray.length/4;ft++){const Tt=4*ft,It=lt.circleArray[Tt+0],si=lt.circleArray[Tt+1],Kt=lt.circleArray[Tt+2],ii=lt.circleArray[Tt+3];ke.emplace(Fe++,It,si,Kt,ii,0),ke.emplace(Fe++,It,si,Kt,ii,1),ke.emplace(Fe++,It,si,Kt,ii,2),ke.emplace(Fe++,It,si,Kt,ii,3)}(!Ls||Ls.length<2*Y)&&(Ls=function(lt){const ft=2*lt,Tt=new a.aS;Tt.resize(ft),Tt._trim();for(let It=0;It<ft;It++){const si=6*It;Tt.uint16[si+0]=4*It+0,Tt.uint16[si+1]=4*It+1,Tt.uint16[si+2]=4*It+2,Tt.uint16[si+3]=4*It+2,Tt.uint16[si+4]=4*It+3,Tt.uint16[si+5]=4*It+0}return Tt}(Y));const ze=I.createIndexBuffer(Ls,!0),tt=I.createVertexBuffer(ke,a.aR.members,!0);for(const lt of Z){const ft={u_matrix:lt.transform,u_inv_matrix:lt.invTransform,u_camera_to_center_distance:(wt=x.transform).cameraToCenterDistance,u_viewport_size:[wt.width,wt.height]};Ie.draw(I,k.TRIANGLES,qn.disabled,as.disabled,x.colorModeForRenderPass(),Kr.disabled,ft,x.style.map.terrain&&x.style.map.terrain.getTerrainData(lt.coord),i.id,tt,ze,a.$.simpleSegment(0,2*lt.circleOffset,lt.circleArray.length,lt.circleArray.length/2),null,x.transform.zoom,null,null,null)}var wt;tt.destroy(),ze.destroy()}Kr.disabled=new Kr(!1,1029,2305),Kr.backCCW=new Kr(!0,1029,2305);const ar=a.an(new Float32Array(16));function ul(x,s,i,r,l,d){const{horizontalAlign:y,verticalAlign:I}=a.at(x);return new a.P((-(y-.5)*s/l+r[0])*d,(-(I-.5)*i/l+r[1])*d)}function is(x,s,i,r,l,d,y,I,k,z,Z){const Y=x.text.placedSymbolArray,Ae=x.text.dynamicLayoutVertexArray,Ie=x.icon.dynamicLayoutVertexArray,ke={};Ae.clear();for(let Fe=0;Fe<Y.length;Fe++){const ze=Y.get(Fe),tt=ze.hidden||!ze.crossTileID||x.allowVerticalPlacement&&!ze.placedOrientation?null:r[ze.crossTileID];if(tt){const wt=new a.P(ze.anchorX,ze.anchorY),lt=ot(wt,i?y:d,Z),ft=Pe(l.cameraToCenterDistance,lt.signedDistanceFromCamera);let Tt=a.ai(x.textSizeData,k,ze)*ft/a.ao;i&&(Tt*=x.tilePixelRatio/I);const{width:It,height:si,anchor:Kt,textOffset:ii,textBoxScale:ai}=tt,Wi=ul(Kt,It,si,ii,ai,Tt),$i=i?ot(wt.add(Wi),d,Z).point:lt.point.add(s?Wi.rotate(-l.angle):Wi),Ei=x.allowVerticalPlacement&&ze.placedOrientation===a.ah.vertical?Math.PI/2:0;for(let Hi=0;Hi<ze.numGlyphs;Hi++)a.aj(Ae,$i,Ei);z&&ze.associatedIconIndex>=0&&(ke[ze.associatedIconIndex]={shiftedAnchor:$i,angle:Ei})}else et(ze.numGlyphs,Ae)}if(z){Ie.clear();const Fe=x.icon.placedSymbolArray;for(let ze=0;ze<Fe.length;ze++){const tt=Fe.get(ze);if(tt.hidden)et(tt.numGlyphs,Ie);else{const wt=ke[ze];if(wt)for(let lt=0;lt<tt.numGlyphs;lt++)a.aj(Ie,wt.shiftedAnchor,wt.angle);else et(tt.numGlyphs,Ie)}}x.icon.dynamicLayoutVertexBuffer.updateData(Ie)}x.text.dynamicLayoutVertexBuffer.updateData(Ae)}function Do(x,s,i){return i.iconsInText&&s?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function cl(x,s,i,r,l,d,y,I,k,z,Z,Y){const Ae=x.context,Ie=Ae.gl,ke=x.transform,Fe=I==="map",ze=k==="map",tt=I!=="viewport"&&i.layout.get("symbol-placement")!=="point",wt=Fe&&!ze&&!tt,lt=!i.layout.get("symbol-sort-key").isConstant();let ft=!1;const Tt=x.depthModeForSublayer(0,qn.ReadOnly),It=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),si=[];for(const Kt of r){const ii=s.getTile(Kt),ai=ii.getBucket(i);if(!ai)continue;const Wi=l?ai.text:ai.icon;if(!Wi||!Wi.segments.get().length||!Wi.hasVisibleVertices)continue;const $i=Wi.programConfigurations.get(i.id),Ei=l||ai.sdfIcons,Hi=l?ai.textSizeData:ai.iconSizeData,ji=ze||ke.pitch!==0,cn=x.useProgram(Do(Ei,l,ai),$i),Nn=a.ag(Hi,ke.zoom),nn=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Kt);let Mn,wr,nr,Pa,_a=[0,0],Vs=null;if(l)wr=ii.glyphAtlasTexture,nr=Ie.LINEAR,Mn=ii.glyphAtlasTexture.size,ai.iconsInText&&(_a=ii.imageAtlasTexture.size,Vs=ii.imageAtlasTexture,Pa=ji||x.options.rotating||x.options.zooming||Hi.kind==="composite"||Hi.kind==="camera"?Ie.LINEAR:Ie.NEAREST);else{const Js=i.layout.get("icon-size").constantOr(0)!==1||ai.iconsNeedLinear;wr=ii.imageAtlasTexture,nr=Ei||x.options.rotating||x.options.zooming||Js||ji?Ie.LINEAR:Ie.NEAREST,Mn=ii.imageAtlasTexture.size}const Ao=Pt(ii,1,x.transform.zoom),fo=Ge(Kt.posMatrix,ze,Fe,x.transform,Ao),$r=mt(Kt.posMatrix,ze,Fe,x.transform,Ao),Sa=It&&ai.hasTextData(),So=i.layout.get("icon-text-fit")!=="none"&&Sa&&ai.hasIconData();if(tt){const Js=x.style.map.terrain?(Go,qo)=>x.style.map.terrain.getElevation(Kt,Go,qo):null,zo=i.layout.get("text-rotation-alignment")==="map";re(ai,Kt.posMatrix,x,l,fo,$r,ze,z,zo,Js)}const Io=x.translatePosMatrix(Kt.posMatrix,ii,d,y),Ks=tt||l&&It||So?ar:fo,os=x.translatePosMatrix($r,ii,d,y,!0),ls=Ei&&i.paint.get(l?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ur;Ur=Ei?ai.iconsInText?Ka(Hi.kind,Nn,wt,ze,x,Io,Ks,os,Mn,_a):Ya(Hi.kind,Nn,wt,ze,x,Io,Ks,os,l,Mn,!0):Xa(Hi.kind,Nn,wt,ze,x,Io,Ks,os,l,Mn);const Cs={program:cn,buffers:Wi,uniformValues:Ur,atlasTexture:wr,atlasTextureIcon:Vs,atlasInterpolation:nr,atlasInterpolationIcon:Pa,isSDF:Ei,hasHalo:ls};if(lt&&ai.canOverlap){ft=!0;const Js=Wi.segments.get();for(const zo of Js)si.push({segments:new a.$([zo]),sortKey:zo.sortKey,state:Cs,terrainData:nn})}else si.push({segments:Wi.segments,sortKey:0,state:Cs,terrainData:nn})}ft&&si.sort((Kt,ii)=>Kt.sortKey-ii.sortKey);for(const Kt of si){const ii=Kt.state;if(Ae.activeTexture.set(Ie.TEXTURE0),ii.atlasTexture.bind(ii.atlasInterpolation,Ie.CLAMP_TO_EDGE),ii.atlasTextureIcon&&(Ae.activeTexture.set(Ie.TEXTURE1),ii.atlasTextureIcon&&ii.atlasTextureIcon.bind(ii.atlasInterpolationIcon,Ie.CLAMP_TO_EDGE)),ii.isSDF){const ai=ii.uniformValues;ii.hasHalo&&(ai.u_is_halo=1,Jr(ii.buffers,Kt.segments,i,x,ii.program,Tt,Z,Y,ai,Kt.terrainData)),ai.u_is_halo=0}Jr(ii.buffers,Kt.segments,i,x,ii.program,Tt,Z,Y,ii.uniformValues,Kt.terrainData)}}function Jr(x,s,i,r,l,d,y,I,k,z){const Z=r.context;l.draw(Z,Z.gl.TRIANGLES,d,y,I,Kr.disabled,k,z,i.id,x.layoutVertexBuffer,x.indexBuffer,s,i.paint,r.transform.zoom,x.programConfigurations.get(i.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function gs(x,s,i,r,l){if(!i||!r||!r.imageAtlas)return;const d=r.imageAtlas.patternPositions;let y=d[i.to.toString()],I=d[i.from.toString()];if(!y&&I&&(y=I),!I&&y&&(I=y),!y||!I){const k=l.getPaintProperty(s);y=d[k],I=d[k]}y&&I&&x.setConstantPatternPositions(y,I)}function ka(x,s,i,r,l,d,y){const I=x.context.gl,k="fill-pattern",z=i.paint.get(k),Z=z&&z.constantOr(1),Y=i.getCrossfadeParameters();let Ae,Ie,ke,Fe,ze;y?(Ie=Z&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ae=I.LINES):(Ie=Z?"fillPattern":"fill",Ae=I.TRIANGLES);const tt=z.constantOr(null);for(const wt of r){const lt=s.getTile(wt);if(Z&&!lt.patternsLoaded())continue;const ft=lt.getBucket(i);if(!ft)continue;const Tt=ft.programConfigurations.get(i.id),It=x.useProgram(Ie,Tt),si=x.style.map.terrain&&x.style.map.terrain.getTerrainData(wt);Z&&(x.context.activeTexture.set(I.TEXTURE0),lt.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Tt.updatePaintBuffers(Y)),gs(Tt,k,tt,lt,i);const Kt=si?wt:null,ii=x.translatePosMatrix(Kt?Kt.posMatrix:wt.posMatrix,lt,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(y){Fe=ft.indexBuffer2,ze=ft.segments2;const ai=[I.drawingBufferWidth,I.drawingBufferHeight];ke=Ie==="fillOutlinePattern"&&Z?ll(ii,x,Y,lt,ai):ol(ii,ai)}else Fe=ft.indexBuffer,ze=ft.segments,ke=Z?Wa(ii,x,Y,lt):ds(ii);It.draw(x.context,Ae,l,x.stencilModeForClipping(wt),d,Kr.disabled,ke,si,i.id,ft.layoutVertexBuffer,Fe,ze,i.paint,x.transform.zoom,Tt)}}function Pl(x,s,i,r,l,d,y){const I=x.context,k=I.gl,z="fill-extrusion-pattern",Z=i.paint.get(z),Y=Z.constantOr(1),Ae=i.getCrossfadeParameters(),Ie=i.paint.get("fill-extrusion-opacity"),ke=Z.constantOr(null);for(const Fe of r){const ze=s.getTile(Fe),tt=ze.getBucket(i);if(!tt)continue;const wt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Fe),lt=tt.programConfigurations.get(i.id),ft=x.useProgram(Y?"fillExtrusionPattern":"fillExtrusion",lt);Y&&(x.context.activeTexture.set(k.TEXTURE0),ze.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),lt.updatePaintBuffers(Ae)),gs(lt,z,ke,ze,i);const Tt=x.translatePosMatrix(Fe.posMatrix,ze,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),It=i.paint.get("fill-extrusion-vertical-gradient"),si=Y?Aa(Tt,x,It,Ie,Fe,Ae,ze):Qn(Tt,x,It,Ie);ft.draw(I,I.gl.TRIANGLES,l,d,y,Kr.backCCW,si,wt,i.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,i.paint,x.transform.zoom,lt,x.style.map.terrain&&tt.centroidVertexBuffer)}}function Lo(x,s,i,r,l,d,y){const I=x.context,k=I.gl,z=i.fbo;if(!z)return;const Z=x.useProgram("hillshade"),Y=x.style.map.terrain&&x.style.map.terrain.getTerrainData(s);I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,z.colorAttachment.get()),Z.draw(I,k.TRIANGLES,l,d,y,Kr.disabled,((Ae,Ie,ke,Fe)=>{const ze=ke.paint.get("hillshade-shadow-color"),tt=ke.paint.get("hillshade-highlight-color"),wt=ke.paint.get("hillshade-accent-color");let lt=ke.paint.get("hillshade-illumination-direction")*(Math.PI/180);ke.paint.get("hillshade-illumination-anchor")==="viewport"&&(lt-=Ae.transform.angle);const ft=!Ae.options.moving;return{u_matrix:Fe?Fe.posMatrix:Ae.transform.calculatePosMatrix(Ie.tileID.toUnwrapped(),ft),u_image:0,u_latrange:Ct(0,Ie.tileID),u_light:[ke.paint.get("hillshade-exaggeration"),lt],u_shadow:ze,u_highlight:tt,u_accent:wt}})(x,i,r,Y?s:null),Y,r.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}function Dl(x,s,i,r,l,d){const y=x.context,I=y.gl,k=s.dem;if(k&&k.data){const z=k.dim,Z=k.stride,Y=k.getPixels();if(y.activeTexture.set(I.TEXTURE1),y.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||x.getTileTexture(Z),s.demTexture){const Ie=s.demTexture;Ie.update(Y,{premultiply:!1}),Ie.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else s.demTexture=new St(y,Y,I.RGBA,{premultiply:!1}),s.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);y.activeTexture.set(I.TEXTURE0);let Ae=s.fbo;if(!Ae){const Ie=new St(y,{width:z,height:z,data:null},I.RGBA);Ie.bind(I.LINEAR,I.CLAMP_TO_EDGE),Ae=s.fbo=y.createFramebuffer(z,z,!0,!1),Ae.colorAttachment.set(Ie.texture)}y.bindFramebuffer.set(Ae.framebuffer),y.viewport.set([0,0,z,z]),x.useProgram("hillshadePrepare").draw(y,I.TRIANGLES,r,l,d,Kr.disabled,((Ie,ke)=>{const Fe=ke.stride,ze=a.F();return a.aN(ze,0,a.W,-a.W,0,0,1),a.H(ze,ze,[0,-a.W,0]),{u_matrix:ze,u_image:1,u_dimension:[Fe,Fe],u_zoom:Ie.overscaledZ,u_unpack:ke.getUnpackVector()}})(s.tileID,k),null,i.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function vo(x,s,i,r,l,d){const y=r.paint.get("raster-fade-duration");if(!d&&y>0){const I=oe.now(),k=(I-x.timeAdded)/y,z=s?(I-s.timeAdded)/y:-1,Z=i.getSource(),Y=l.coveringZoomLevel({tileSize:Z.tileSize,roundZoom:Z.roundZoom}),Ae=!s||Math.abs(s.tileID.overscaledZ-Y)>Math.abs(x.tileID.overscaledZ-Y),Ie=Ae&&x.refreshedUponExpiration?1:a.ac(Ae?k:1-z,0,1);return x.refreshedUponExpiration&&k>=1&&(x.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Ie}:{opacity:Ie,mix:0}}return{opacity:1,mix:0}}const sa=new a.aO(1,0,0,1),Ws=new a.aO(0,1,0,1),io=new a.aO(0,0,1,1),el=new a.aO(1,0,1,1),ns=new a.aO(0,1,1,1);function vr(x,s,i,r){ga(x,0,s+i/2,x.transform.width,i,r)}function Hr(x,s,i,r){ga(x,s-i/2,0,i,x.transform.height,r)}function ga(x,s,i,r,l,d){const y=x.context,I=y.gl;I.enable(I.SCISSOR_TEST),I.scissor(s*x.pixelRatio,i*x.pixelRatio,r*x.pixelRatio,l*x.pixelRatio),y.clear({color:d}),I.disable(I.SCISSOR_TEST)}function xo(x,s,i){const r=x.context,l=r.gl,d=i.posMatrix,y=x.useProgram("debug"),I=qn.disabled,k=as.disabled,z=x.colorModeForRenderPass(),Z="$debug",Y=x.style.map.terrain&&x.style.map.terrain.getTerrainData(i);r.activeTexture.set(l.TEXTURE0);const Ae=s.getTileByID(i.key).latestRawTileData,Ie=Math.floor((Ae&&Ae.byteLength||0)/1024),ke=s.getTile(i).tileSize,Fe=512/Math.min(ke,512)*(i.overscaledZ/x.transform.zoom)*.5;let ze=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(ze+=` => ${i.overscaledZ}`),function(tt,wt){tt.initDebugOverlayCanvas();const lt=tt.debugOverlayCanvas,ft=tt.context.gl,Tt=tt.debugOverlayCanvas.getContext("2d");Tt.clearRect(0,0,lt.width,lt.height),Tt.shadowColor="white",Tt.shadowBlur=2,Tt.lineWidth=1.5,Tt.strokeStyle="white",Tt.textBaseline="top",Tt.font="bold 36px Open Sans, sans-serif",Tt.fillText(wt,5,5),Tt.strokeText(wt,5,5),tt.debugOverlayTexture.update(lt),tt.debugOverlayTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE)}(x,`${ze} ${Ie}kB`),y.draw(r,l.TRIANGLES,I,k,pr.alphaBlended,Kr.disabled,G(d,a.aO.transparent,Fe),null,Z,x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),y.draw(r,l.LINE_STRIP,I,k,z,Kr.disabled,G(d,a.aO.red),Y,Z,x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}function aa(x,s,i){const r=x.context,l=r.gl,d=x.colorModeForRenderPass(),y=new qn(l.LEQUAL,qn.ReadWrite,x.depthRangeFor3D),I=x.useProgram("terrain"),k=s.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,x.width,x.height]);for(const z of i){const Z=x.renderToTexture.getTexture(z),Y=s.getTerrainData(z.tileID);r.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,Z.texture);const Ae={u_matrix:x.transform.calculatePosMatrix(z.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(x.transform.zoom)};I.draw(r,l.TRIANGLES,y,as.disabled,d,Kr.backCCW,Ae,Y,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class Ma{constructor(s,i){this.context=new Po(s),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.F(),renderTime:0},this.setup(),this.numSublayers=Ee.maxUnderzooming+Ee.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qr}resize(s,i,r){if(this.width=Math.floor(s*r),this.height=Math.floor(i*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style._order)this.style._layers[l].resize()}setup(){const s=this.context,i=new a.aV;i.emplaceBack(0,0),i.emplaceBack(a.W,0),i.emplaceBack(0,a.W),i.emplaceBack(a.W,a.W),this.tileExtentBuffer=s.createVertexBuffer(i,Gr.members),this.tileExtentSegments=a.$.simpleSegment(0,0,4,2);const r=new a.aV;r.emplaceBack(0,0),r.emplaceBack(a.W,0),r.emplaceBack(0,a.W),r.emplaceBack(a.W,a.W),this.debugBuffer=s.createVertexBuffer(r,Gr.members),this.debugSegments=a.$.simpleSegment(0,0,4,5);const l=new a.Z;l.emplaceBack(0,0,0,0),l.emplaceBack(a.W,0,a.W,0),l.emplaceBack(0,a.W,0,a.W),l.emplaceBack(a.W,a.W,a.W,a.W),this.rasterBoundsBuffer=s.createVertexBuffer(l,Yi.members),this.rasterBoundsSegments=a.$.simpleSegment(0,0,4,2);const d=new a.aV;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(d,Gr.members),this.viewportSegments=a.$.simpleSegment(0,0,4,2);const y=new a.aW;y.emplaceBack(0),y.emplaceBack(1),y.emplaceBack(3),y.emplaceBack(2),y.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(y);const I=new a.aX;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(I);const k=this.context.gl;this.stencilClearMode=new as({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const s=this.context,i=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=a.F();a.aN(r,0,this.width,this.height,0,0,1),a.J(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,i.TRIANGLES,qn.disabled,this.stencilClearMode,pr.disabled,Kr.disabled,we(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,i){if(this.currentStencilSource===s.source||!s.isTileClipped()||!i||!i.length)return;this.currentStencilSource=s.source;const r=this.context,l=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(pr.disabled),r.setDepthMode(qn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const y of i){const I=this._tileClippingMaskIDs[y.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(y);d.draw(r,l.TRIANGLES,qn.disabled,new as({func:l.ALWAYS,mask:0},I,255,l.KEEP,l.KEEP,l.REPLACE),pr.disabled,Kr.disabled,we(y.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,i=this.context.gl;return new as({func:i.NOTEQUAL,mask:255},s,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(s){const i=this.context.gl;return new as({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(s){const i=this.context.gl,r=s.sort((y,I)=>I.overscaledZ-y.overscaledZ),l=r[r.length-1].overscaledZ,d=r[0].overscaledZ-l+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const y={};for(let I=0;I<d;I++)y[I+l]=new as({func:i.GEQUAL,mask:255},I+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=d,[y,r]}return[{[l]:as.disabled},r]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new pr([s.CONSTANT_COLOR,s.ONE],new a.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?pr.unblended:pr.alphaBlended}depthModeForSublayer(s,i,r){if(!this.opaquePassEnabledForLayer())return qn.disabled;const l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new qn(r||this.context.gl.LEQUAL,i,[l,l])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,i){this.style=s,this.options=i,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(oe.now()),this.imageManager.beginFrame();const r=this.style._order,l=this.style.sourceCaches,d={},y={},I={};for(const k in l){const z=l[k];z.used&&z.prepare(this.context),d[k]=z.getVisibleCoordinates(),y[k]=d[k].slice().reverse(),I[k]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<r.length;k++)if(this.style._layers[r[k]].is3D()){this.opaquePassCutoff=k;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const k=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.aY(this.terrainFacilitator.matrix,this.transform.projMatrix)||k.length)&&(a.aZ(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(z,Z){const Y=z.context,Ae=Y.gl,Ie=pr.unblended,ke=new qn(Ae.LEQUAL,qn.ReadWrite,[0,1]),Fe=Z.getTerrainMesh(),ze=Z.sourceCache.getRenderableTiles(),tt=z.useProgram("terrainDepth");Y.bindFramebuffer.set(Z.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]),Y.clear({color:a.aO.transparent,depth:1});for(const wt of ze){const lt=Z.getTerrainData(wt.tileID),ft={u_matrix:z.transform.calculatePosMatrix(wt.tileID.toUnwrapped()),u_ele_delta:Z.getMeshFrameDelta(z.transform.zoom)};tt.draw(Y,Ae.TRIANGLES,ke,as.disabled,Ie,Kr.backCCW,ft,lt,"terrain",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,z.width,z.height])}(this,this.style.map.terrain),function(z,Z){const Y=z.context,Ae=Y.gl,Ie=pr.unblended,ke=new qn(Ae.LEQUAL,qn.ReadWrite,[0,1]),Fe=Z.getTerrainMesh(),ze=Z.getCoordsTexture(),tt=Z.sourceCache.getRenderableTiles(),wt=z.useProgram("terrainCoords");Y.bindFramebuffer.set(Z.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]),Y.clear({color:a.aO.transparent,depth:1}),Z.coordsIndex=[];for(const lt of tt){const ft=Z.getTerrainData(lt.tileID);Y.activeTexture.set(Ae.TEXTURE0),Ae.bindTexture(Ae.TEXTURE_2D,ze.texture);const Tt={u_matrix:z.transform.calculatePosMatrix(lt.tileID.toUnwrapped()),u_terrain_coords_id:(255-Z.coordsIndex.length)/255,u_texture:0,u_ele_delta:Z.getMeshFrameDelta(z.transform.zoom)};wt.draw(Y,Ae.TRIANGLES,ke,as.disabled,Ie,Kr.backCCW,Tt,ft,"terrain",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments),Z.coordsIndex.push(lt.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,z.width,z.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const k of r){const z=this.style._layers[k];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const Z=y[z.source];(z.type==="custom"||Z.length)&&this.renderLayer(this,l[z.source],z,Z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.aO.black:a.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[r[this.currentLayer]],z=l[k.source],Z=d[k.source];this._renderTileClippingMasks(k,Z),this.renderLayer(this,z,k,Z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const k=this.style._layers[r[this.currentLayer]],z=l[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const Z=(k.type==="symbol"?I:y)[k.source];this._renderTileClippingMasks(k,d[k.source]),this.renderLayer(this,z,k,Z)}if(this.options.showTileBoundaries){const k=function(z,Z){let Y=null;const Ae=Object.values(z._layers).flatMap(ze=>ze.source&&!ze.isHidden(Z)?[z.sourceCaches[ze.source]]:[]),Ie=Ae.filter(ze=>ze.getSource().type==="vector"),ke=Ae.filter(ze=>ze.getSource().type!=="vector"),Fe=ze=>{(!Y||Y.getSource().maxzoom<ze.getSource().maxzoom)&&(Y=ze)};return Ie.forEach(ze=>Fe(ze)),Y||ke.forEach(ze=>Fe(ze)),Y}(this.style,this.transform.zoom);k&&function(z,Z,Y){for(let Ae=0;Ae<Y.length;Ae++)xo(z,Z,Y[Ae])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const z=k.transform.padding;vr(k,k.transform.height-(z.top||0),3,sa),vr(k,z.bottom||0,3,Ws),Hr(k,z.left||0,3,io),Hr(k,k.transform.width-(z.right||0),3,el);const Z=k.transform.centerPoint;(function(Y,Ae,Ie,ke){ga(Y,Ae-1,Ie-10,2,20,ke),ga(Y,Ae-10,Ie-1,20,2,ke)})(k,Z.x,k.transform.height-Z.y,ns)}(this),this.context.setDefault()}renderLayer(s,i,r,l){if(!r.isHidden(this.transform.zoom)&&(r.type==="background"||r.type==="custom"||(l||[]).length))switch(this.id=r.id,r.type){case"symbol":(function(d,y,I,k,z){if(d.renderPass!=="translucent")return;const Z=as.disabled,Y=d.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Ae,Ie,ke,Fe,ze,tt,wt){const lt=Ie.transform,ft=ze==="map",Tt=tt==="map";for(const It of Ae){const si=Fe.getTile(It),Kt=si.getBucket(ke);if(!Kt||!Kt.text||!Kt.text.segments.get().length)continue;const ii=a.ag(Kt.textSizeData,lt.zoom),ai=Pt(si,1,Ie.transform.zoom),Wi=Ge(It.posMatrix,Tt,ft,Ie.transform,ai),$i=ke.layout.get("icon-text-fit")!=="none"&&Kt.hasIconData();if(ii){const Ei=Math.pow(2,lt.zoom-si.tileID.overscaledZ);is(Kt,ft,Tt,wt,lt,Wi,It.posMatrix,Ei,ii,$i,Ie.style.map.terrain?(Hi,ji)=>Ie.style.map.terrain.getElevation(It,Hi,ji):null)}}}(k,d,I,y,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),z),I.paint.get("icon-opacity").constantOr(1)!==0&&cl(d,y,I,k,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),Z,Y),I.paint.get("text-opacity").constantOr(1)!==0&&cl(d,y,I,k,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),Z,Y),y.map.showCollisionBoxes&&(Br(d,y,I,k,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),!0),Br(d,y,I,k,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),!1))})(s,i,r,l,this.style.placement.variableOffsets);break;case"circle":(function(d,y,I,k){if(d.renderPass!=="translucent")return;const z=I.paint.get("circle-opacity"),Z=I.paint.get("circle-stroke-width"),Y=I.paint.get("circle-stroke-opacity"),Ae=!I.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(Z.constantOr(1)===0||Y.constantOr(1)===0))return;const Ie=d.context,ke=Ie.gl,Fe=d.depthModeForSublayer(0,qn.ReadOnly),ze=as.disabled,tt=d.colorModeForRenderPass(),wt=[];for(let lt=0;lt<k.length;lt++){const ft=k[lt],Tt=y.getTile(ft),It=Tt.getBucket(I);if(!It)continue;const si=It.programConfigurations.get(I.id),Kt=d.useProgram("circle",si),ii=It.layoutVertexBuffer,ai=It.indexBuffer,Wi=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ft),$i={programConfiguration:si,program:Kt,layoutVertexBuffer:ii,indexBuffer:ai,uniformValues:lo(d,ft,Tt,I),terrainData:Wi};if(Ae){const Ei=It.segments.get();for(const Hi of Ei)wt.push({segments:new a.$([Hi]),sortKey:Hi.sortKey,state:$i})}else wt.push({segments:It.segments,sortKey:0,state:$i})}Ae&&wt.sort((lt,ft)=>lt.sortKey-ft.sortKey);for(const lt of wt){const{programConfiguration:ft,program:Tt,layoutVertexBuffer:It,indexBuffer:si,uniformValues:Kt,terrainData:ii}=lt.state;Tt.draw(Ie,ke.TRIANGLES,Fe,ze,tt,Kr.disabled,Kt,ii,I.id,It,si,lt.segments,I.paint,d.transform.zoom,ft)}})(s,i,r,l);break;case"heatmap":(function(d,y,I,k){if(I.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const z=d.context,Z=z.gl,Y=as.disabled,Ae=new pr([Z.ONE,Z.ONE],a.aO.transparent,[!0,!0,!0,!0]);(function(Ie,ke,Fe){const ze=Ie.gl;Ie.activeTexture.set(ze.TEXTURE1),Ie.viewport.set([0,0,ke.width/4,ke.height/4]);let tt=Fe.heatmapFbo;if(tt)ze.bindTexture(ze.TEXTURE_2D,tt.colorAttachment.get()),Ie.bindFramebuffer.set(tt.framebuffer);else{const wt=ze.createTexture();ze.bindTexture(ze.TEXTURE_2D,wt),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_WRAP_S,ze.CLAMP_TO_EDGE),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_WRAP_T,ze.CLAMP_TO_EDGE),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_MIN_FILTER,ze.LINEAR),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_MAG_FILTER,ze.LINEAR),tt=Fe.heatmapFbo=Ie.createFramebuffer(ke.width/4,ke.height/4,!1,!1),function(lt,ft,Tt,It){var si,Kt;const ii=lt.gl,ai=(si=lt.HALF_FLOAT)!==null&&si!==void 0?si:ii.UNSIGNED_BYTE,Wi=(Kt=lt.RGBA16F)!==null&&Kt!==void 0?Kt:ii.RGBA;ii.texImage2D(ii.TEXTURE_2D,0,Wi,ft.width/4,ft.height/4,0,ii.RGBA,ai,null),It.colorAttachment.set(Tt)}(Ie,ke,wt,tt)}})(z,d,I),z.clear({color:a.aO.transparent});for(let Ie=0;Ie<k.length;Ie++){const ke=k[Ie];if(y.hasRenderableParent(ke))continue;const Fe=y.getTile(ke),ze=Fe.getBucket(I);if(!ze)continue;const tt=ze.programConfigurations.get(I.id),wt=d.useProgram("heatmap",tt),{zoom:lt}=d.transform;wt.draw(z,Z.TRIANGLES,qn.disabled,Y,Ae,Kr.disabled,at(ke.posMatrix,Fe,lt,I.paint.get("heatmap-intensity")),null,I.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,I.paint,d.transform.zoom,tt)}z.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(z,Z){const Y=z.context,Ae=Y.gl,Ie=Z.heatmapFbo;if(!Ie)return;Y.activeTexture.set(Ae.TEXTURE0),Ae.bindTexture(Ae.TEXTURE_2D,Ie.colorAttachment.get()),Y.activeTexture.set(Ae.TEXTURE1);let ke=Z.colorRampTexture;ke||(ke=Z.colorRampTexture=new St(Y,Z.colorRamp,Ae.RGBA)),ke.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),z.useProgram("heatmapTexture").draw(Y,Ae.TRIANGLES,qn.disabled,as.disabled,z.colorModeForRenderPass(),Kr.disabled,((Fe,ze,tt,wt)=>{const lt=a.F();a.aN(lt,0,Fe.width,Fe.height,0,0,1);const ft=Fe.context.gl;return{u_matrix:lt,u_world:[ft.drawingBufferWidth,ft.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ze.paint.get("heatmap-opacity")}})(z,Z),null,Z.id,z.viewportBuffer,z.quadTriangleIndexBuffer,z.viewportSegments,Z.paint,z.transform.zoom)}(d,I))})(s,i,r,l);break;case"line":(function(d,y,I,k){if(d.renderPass!=="translucent")return;const z=I.paint.get("line-opacity"),Z=I.paint.get("line-width");if(z.constantOr(1)===0||Z.constantOr(1)===0)return;const Y=d.depthModeForSublayer(0,qn.ReadOnly),Ae=d.colorModeForRenderPass(),Ie=I.paint.get("line-dasharray"),ke=I.paint.get("line-pattern"),Fe=ke.constantOr(1),ze=I.paint.get("line-gradient"),tt=I.getCrossfadeParameters(),wt=Fe?"linePattern":Ie?"lineSDF":ze?"lineGradient":"line",lt=d.context,ft=lt.gl;let Tt=!0;for(const It of k){const si=y.getTile(It);if(Fe&&!si.patternsLoaded())continue;const Kt=si.getBucket(I);if(!Kt)continue;const ii=Kt.programConfigurations.get(I.id),ai=d.context.program.get(),Wi=d.useProgram(wt,ii),$i=Tt||Wi.program!==ai,Ei=d.style.map.terrain&&d.style.map.terrain.getTerrainData(It),Hi=ke.constantOr(null);if(Hi&&si.imageAtlas){const Nn=si.imageAtlas,nn=Nn.patternPositions[Hi.to.toString()],Mn=Nn.patternPositions[Hi.from.toString()];nn&&Mn&&ii.setConstantPatternPositions(nn,Mn)}const ji=Ei?It:null,cn=Fe?Li(d,si,I,tt,ji):Ie?An(d,si,I,Ie,tt,ji):ze?Ii(d,si,I,Kt.lineClipsArray.length,ji):Yt(d,si,I,ji);if(Fe)lt.activeTexture.set(ft.TEXTURE0),si.imageAtlasTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE),ii.updatePaintBuffers(tt);else if(Ie&&($i||d.lineAtlas.dirty))lt.activeTexture.set(ft.TEXTURE0),d.lineAtlas.bind(lt);else if(ze){const Nn=Kt.gradients[I.id];let nn=Nn.texture;if(I.gradientVersion!==Nn.version){let Mn=256;if(I.stepInterpolant){const wr=y.getSource().maxzoom,nr=It.canonical.z===wr?Math.ceil(1<<d.transform.maxZoom-It.canonical.z):1;Mn=a.ac(a.aT(Kt.maxLineLength/a.W*1024*nr),256,lt.maxTextureSize)}Nn.gradient=a.aU({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:Mn,image:Nn.gradient||void 0,clips:Kt.lineClipsArray}),Nn.texture?Nn.texture.update(Nn.gradient):Nn.texture=new St(lt,Nn.gradient,ft.RGBA),Nn.version=I.gradientVersion,nn=Nn.texture}lt.activeTexture.set(ft.TEXTURE0),nn.bind(I.stepInterpolant?ft.NEAREST:ft.LINEAR,ft.CLAMP_TO_EDGE)}Wi.draw(lt,ft.TRIANGLES,Y,d.stencilModeForClipping(It),Ae,Kr.disabled,cn,Ei,I.id,Kt.layoutVertexBuffer,Kt.indexBuffer,Kt.segments,I.paint,d.transform.zoom,ii,Kt.layoutVertexBuffer2),Tt=!1}})(s,i,r,l);break;case"fill":(function(d,y,I,k){const z=I.paint.get("fill-color"),Z=I.paint.get("fill-opacity");if(Z.constantOr(1)===0)return;const Y=d.colorModeForRenderPass(),Ae=I.paint.get("fill-pattern"),Ie=d.opaquePassEnabledForLayer()&&!Ae.constantOr(1)&&z.constantOr(a.aO.transparent).a===1&&Z.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===Ie){const ke=d.depthModeForSublayer(1,d.renderPass==="opaque"?qn.ReadWrite:qn.ReadOnly);ka(d,y,I,k,ke,Y,!1)}if(d.renderPass==="translucent"&&I.paint.get("fill-antialias")){const ke=d.depthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,qn.ReadOnly);ka(d,y,I,k,ke,Y,!0)}})(s,i,r,l);break;case"fill-extrusion":(function(d,y,I,k){const z=I.paint.get("fill-extrusion-opacity");if(z!==0&&d.renderPass==="translucent"){const Z=new qn(d.context.gl.LEQUAL,qn.ReadWrite,d.depthRangeFor3D);if(z!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))Pl(d,y,I,k,Z,as.disabled,pr.disabled),Pl(d,y,I,k,Z,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const Y=d.colorModeForRenderPass();Pl(d,y,I,k,Z,as.disabled,Y)}}})(s,i,r,l);break;case"hillshade":(function(d,y,I,k){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const z=d.context,Z=d.depthModeForSublayer(0,qn.ReadOnly),Y=d.colorModeForRenderPass(),[Ae,Ie]=d.renderPass==="translucent"?d.stencilConfigForOverlap(k):[{},k];for(const ke of Ie){const Fe=y.getTile(ke);Fe.needsHillshadePrepare!==void 0&&Fe.needsHillshadePrepare&&d.renderPass==="offscreen"?Dl(d,Fe,I,Z,as.disabled,Y):d.renderPass==="translucent"&&Lo(d,ke,Fe,I,Z,Ae[ke.overscaledZ],Y)}z.viewport.set([0,0,d.width,d.height])})(s,i,r,l);break;case"raster":(function(d,y,I,k){if(d.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!k.length)return;const z=d.context,Z=z.gl,Y=y.getSource(),Ae=d.useProgram("raster"),Ie=d.colorModeForRenderPass(),[ke,Fe]=Y instanceof Xn?[{},k]:d.stencilConfigForOverlap(k),ze=Fe[Fe.length-1].overscaledZ,tt=!d.options.moving;for(const wt of Fe){const lt=d.depthModeForSublayer(wt.overscaledZ-ze,I.paint.get("raster-opacity")===1?qn.ReadWrite:qn.ReadOnly,Z.LESS),ft=y.getTile(wt);ft.registerFadeDuration(I.paint.get("raster-fade-duration"));const Tt=y.findLoadedParent(wt,0),It=vo(ft,Tt,y,I,d.transform,d.style.map.terrain);let si,Kt;const ii=I.paint.get("raster-resampling")==="nearest"?Z.NEAREST:Z.LINEAR;z.activeTexture.set(Z.TEXTURE0),ft.texture.bind(ii,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(Z.TEXTURE1),Tt?(Tt.texture.bind(ii,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),si=Math.pow(2,Tt.tileID.overscaledZ-ft.tileID.overscaledZ),Kt=[ft.tileID.canonical.x*si%1,ft.tileID.canonical.y*si%1]):ft.texture.bind(ii,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST);const ai=d.style.map.terrain&&d.style.map.terrain.getTerrainData(wt),Wi=ai?wt:null,$i=Wi?Wi.posMatrix:d.transform.calculatePosMatrix(wt.toUnwrapped(),tt),Ei=dr($i,Kt||[0,0],si||1,It,I);Y instanceof Xn?Ae.draw(z,Z.TRIANGLES,lt,as.disabled,Ie,Kr.disabled,Ei,ai,I.id,Y.boundsBuffer,d.quadTriangleIndexBuffer,Y.boundsSegments):Ae.draw(z,Z.TRIANGLES,lt,ke[wt.overscaledZ],Ie,Kr.disabled,Ei,ai,I.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}})(s,i,r,l);break;case"background":(function(d,y,I,k){const z=I.paint.get("background-color"),Z=I.paint.get("background-opacity");if(Z===0)return;const Y=d.context,Ae=Y.gl,Ie=d.transform,ke=Ie.tileSize,Fe=I.paint.get("background-pattern");if(d.isPatternMissing(Fe))return;const ze=!Fe&&z.a===1&&Z===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==ze)return;const tt=as.disabled,wt=d.depthModeForSublayer(0,ze==="opaque"?qn.ReadWrite:qn.ReadOnly),lt=d.colorModeForRenderPass(),ft=d.useProgram(Fe?"backgroundPattern":"background"),Tt=k||Ie.coveringTiles({tileSize:ke,terrain:d.style.map.terrain});Fe&&(Y.activeTexture.set(Ae.TEXTURE0),d.imageManager.bind(d.context));const It=I.getCrossfadeParameters();for(const si of Tt){const Kt=k?si.posMatrix:d.transform.calculatePosMatrix(si.toUnwrapped()),ii=Fe?Wr(Kt,Z,d,Fe,{tileID:si,tileSize:ke},It):ml(Kt,Z,z),ai=d.style.map.terrain&&d.style.map.terrain.getTerrainData(si);ft.draw(Y,Ae.TRIANGLES,wt,tt,lt,Kr.disabled,ii,ai,I.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}})(s,0,r,l);break;case"custom":(function(d,y,I){const k=d.context,z=I.implementation;if(d.renderPass==="offscreen"){const Z=z.prerender;Z&&(d.setCustomLayerDefaults(),k.setColorMode(d.colorModeForRenderPass()),Z.call(z,k.gl,d.transform.customLayerMatrix()),k.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),k.setColorMode(d.colorModeForRenderPass()),k.setStencilMode(as.disabled);const Z=z.renderingMode==="3d"?new qn(d.context.gl.LEQUAL,qn.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,qn.ReadOnly);k.setDepthMode(Z),z.render(k.gl,d.transform.customLayerMatrix()),k.setDirty(),d.setBaseState(),k.bindFramebuffer.set(null)}})(s,0,r)}}translatePosMatrix(s,i,r,l,d){if(!r[0]&&!r[1])return s;const y=d?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(y){const z=Math.sin(y),Z=Math.cos(y);r=[r[0]*Z-r[1]*z,r[0]*z+r[1]*Z]}const I=[d?r[0]:Pt(i,r[0],this.transform.zoom),d?r[1]:Pt(i,r[1],this.transform.zoom),0],k=new Float32Array(16);return a.H(k,s,I),k}saveTileTexture(s){const i=this._tileTextures[s.size[0]];i?i.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const i=this._tileTextures[s];return i&&i.length>0?i.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const i=this.imageManager.getPattern(s.from.toString()),r=this.imageManager.getPattern(s.to.toString());return!i||!r}useProgram(s,i){this.cache=this.cache||{};const r=s+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new Qa(this.context,pa[s],i,sr[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new St(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:s,drawingBufferHeight:i}=this.context.gl;return this.width!==s||this.height!==i}}class Oa{constructor(s,i){this.points=s,this.planes=i}static fromInvProjectionMatrix(s,i,r){const l=Math.pow(2,r),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const k=1/(I=a.af([],I,s))[3]/i*l;return a.a_(I,I,[k,k,1/I[3],k])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const k=function(Ae,Ie){var ke=Ie[0],Fe=Ie[1],ze=Ie[2],tt=ke*ke+Fe*Fe+ze*ze;return tt>0&&(tt=1/Math.sqrt(tt)),Ae[0]=Ie[0]*tt,Ae[1]=Ie[1]*tt,Ae[2]=Ie[2]*tt,Ae}([],function(Ae,Ie,ke){var Fe=Ie[0],ze=Ie[1],tt=Ie[2],wt=ke[0],lt=ke[1],ft=ke[2];return Ae[0]=ze*ft-tt*lt,Ae[1]=tt*wt-Fe*ft,Ae[2]=Fe*lt-ze*wt,Ae}([],gt([],d[I[0]],d[I[1]]),gt([],d[I[2]],d[I[1]]))),z=-((Z=k)[0]*(Y=d[I[1]])[0]+Z[1]*Y[1]+Z[2]*Y[2]);var Z,Y;return k.concat(z)});return new Oa(d,y)}}class no{constructor(s,i){this.min=s,this.max=i,this.center=function(r,l,d){return r[0]=.5*l[0],r[1]=.5*l[1],r[2]=.5*l[2],r}([],function(r,l,d){return r[0]=l[0]+d[0],r[1]=l[1]+d[1],r[2]=l[2]+d[2],r}([],this.min,this.max))}quadrant(s){const i=[s%2==0,s<2],r=$t(this.min),l=$t(this.max);for(let d=0;d<i.length;d++)r[d]=i[d]?this.min[d]:this.center[d],l[d]=i[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new no(r,l)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let l=0;l<s.planes.length;l++){const d=s.planes[l];let y=0;for(let I=0;I<i.length;I++)a.a$(d,i[I])>=0&&y++;if(y===0)return 0;y!==i.length&&(r=!1)}if(r)return 2;for(let l=0;l<3;l++){let d=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let I=0;I<s.points.length;I++){const k=s.points[I][l]-this.min[l];d=Math.min(d,k),y=Math.max(y,k)}if(y<0||d>this.max[l]-this.min[l])return 0}return 1}}class hl{constructor(s=0,i=0,r=0,l=0){if(isNaN(s)||s<0||isNaN(i)||i<0||isNaN(r)||r<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=i,this.left=r,this.right=l}interpolate(s,i,r){return i.top!=null&&s.top!=null&&(this.top=a.z.number(s.top,i.top,r)),i.bottom!=null&&s.bottom!=null&&(this.bottom=a.z.number(s.bottom,i.bottom,r)),i.left!=null&&s.left!=null&&(this.left=a.z.number(s.left,i.left,r)),i.right!=null&&s.right!=null&&(this.right=a.z.number(s.right,i.right,r)),this}getCenter(s,i){const r=a.ac((this.left+s-this.right)/2,0,s),l=a.ac((this.top+i-this.bottom)/2,0,i);return new a.P(r,l)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new hl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class cu{constructor(s,i,r,l,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=d===void 0||!!d,this._minZoom=s||0,this._maxZoom=i||22,this._minPitch=r??0,this._maxPitch=l??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new hl,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const s=new cu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this.minElevationForCurrentTile=s.minElevationForCurrentTile,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const i=-a.b0(s,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var r=new a.A(4);return a.A!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}(),function(r,l,d){var y=l[0],I=l[1],k=l[2],z=l[3],Z=Math.sin(d),Y=Math.cos(d);r[0]=y*Y+k*Z,r[1]=I*Y+z*Z,r[2]=y*-Z+k*Y,r[3]=I*-Z+z*Y}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const i=a.ac(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const i=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.tileZoom=Math.max(0,Math.floor(i)),this.scale=this.zoomScale(i),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,i,r){this._unmodified=!1,this._edgeInsets.interpolate(s,i,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const i=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,i)}getVisibleUnwrappedCoordinates(s){const i=[new a.b1(0,s)];if(this._renderWorldCopies){const r=this.pointCoordinate(new a.P(0,0)),l=this.pointCoordinate(new a.P(this.width,0)),d=this.pointCoordinate(new a.P(this.width,this.height)),y=this.pointCoordinate(new a.P(0,this.height)),I=Math.floor(Math.min(r.x,l.x,d.x,y.x)),k=Math.floor(Math.max(r.x,l.x,d.x,y.x)),z=1;for(let Z=I-z;Z<=k+z;Z++)Z!==0&&i.push(new a.b1(Z,s))}return i}coveringTiles(s){var i,r;let l=this.coveringZoomLevel(s);const d=l;if(s.minzoom!==void 0&&l<s.minzoom)return[];s.maxzoom!==void 0&&l>s.maxzoom&&(l=s.maxzoom);const y=this.pointCoordinate(this.getCameraPoint()),I=a.Y.fromLngLat(this.center),k=Math.pow(2,l),z=[k*y.x,k*y.y,0],Z=[k*I.x,k*I.y,0],Y=Oa.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l);let Ae=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Ae=l);const Ie=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,ke=lt=>({aabb:new no([lt*k,0,0],[(lt+1)*k,k,0]),zoom:0,x:0,y:0,wrap:lt,fullyVisible:!1}),Fe=[],ze=[],tt=l,wt=s.reparseOverscaled?d:l;if(this._renderWorldCopies)for(let lt=1;lt<=3;lt++)Fe.push(ke(-lt)),Fe.push(ke(lt));for(Fe.push(ke(0));Fe.length>0;){const lt=Fe.pop(),ft=lt.x,Tt=lt.y;let It=lt.fullyVisible;if(!It){const Wi=lt.aabb.intersects(Y);if(Wi===0)continue;It=Wi===2}const si=s.terrain?z:Z,Kt=lt.aabb.distanceX(si),ii=lt.aabb.distanceY(si),ai=Math.max(Math.abs(Kt),Math.abs(ii));if(lt.zoom===tt||ai>Ie+(1<<tt-lt.zoom)-2&&lt.zoom>=Ae){const Wi=tt-lt.zoom,$i=z[0]-.5-(ft<<Wi),Ei=z[1]-.5-(Tt<<Wi);ze.push({tileID:new a.Q(lt.zoom===tt?wt:lt.zoom,lt.wrap,lt.zoom,ft,Tt),distanceSq:At([Z[0]-.5-ft,Z[1]-.5-Tt]),tileDistanceToCamera:Math.sqrt($i*$i+Ei*Ei)})}else for(let Wi=0;Wi<4;Wi++){const $i=(ft<<1)+Wi%2,Ei=(Tt<<1)+(Wi>>1),Hi=lt.zoom+1;let ji=lt.aabb.quadrant(Wi);if(s.terrain){const cn=new a.Q(Hi,lt.wrap,Hi,$i,Ei),Nn=s.terrain.getMinMaxElevation(cn),nn=(i=Nn.minElevation)!==null&&i!==void 0?i:this.elevation,Mn=(r=Nn.maxElevation)!==null&&r!==void 0?r:this.elevation;ji=new no([ji.min[0],ji.min[1],nn],[ji.max[0],ji.max[1],Mn])}Fe.push({aabb:ji,zoom:Hi,x:$i,y:Ei,wrap:lt.wrap,fullyVisible:It})}}return ze.sort((lt,ft)=>lt.distanceSq-ft.distanceSq).map(lt=>lt.tileID)}resize(s,i){this.width=s,this.height=i,this.pixelsToGLUnits=[2/s,-2/i],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const i=a.ac(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.N(s.lng)*this.worldSize,a.O(i)*this.worldSize)}unproject(s){return new a.Y(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const i=this.pointLocation(this.centerPoint,s),r=s.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-r))return;const l=this.getCameraPosition(),d=a.Y.fromLngLat(l.lngLat,l.altitude),y=a.Y.fromLngLat(i,r),I=d.x-y.x,k=d.y-y.y,z=d.z-y.z,Z=Math.sqrt(I*I+k*k+z*z),Y=this.scaleZoom(this.cameraToCenterDistance/Z/this.tileSize);this._elevation=r,this._center=i,this.zoom=Y}setLocationAtPoint(s,i){const r=this.pointCoordinate(i),l=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(s),y=new a.Y(d.x-(r.x-l.x),d.y-(r.y-l.y));this.center=this.coordinateLocation(y),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,i){return i?this.coordinatePoint(this.locationCoordinate(s),i.getElevationForLngLatZoom(s,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,i){return this.coordinateLocation(this.pointCoordinate(s,i))}locationCoordinate(s){return a.Y.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,i){if(i){const Ae=i.pointCoordinate(s);if(Ae!=null)return Ae}const r=[s.x,s.y,0,1],l=[s.x,s.y,1,1];a.af(r,r,this.pixelMatrixInverse),a.af(l,l,this.pixelMatrixInverse);const d=r[3],y=l[3],I=r[1]/d,k=l[1]/y,z=r[2]/d,Z=l[2]/y,Y=z===Z?0:(0-z)/(Z-z);return new a.Y(a.z.number(r[0]/d,l[0]/y,Y)/this.worldSize,a.z.number(I,k,Y)/this.worldSize)}coordinatePoint(s,i=0,r=this.pixelMatrix){const l=[s.x*this.worldSize,s.y*this.worldSize,i,1];return a.af(l,l,r),new a.P(l[0]/l[3],l[1]/l[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return new xi().extend(this.pointLocation(new a.P(0,s))).extend(this.pointLocation(new a.P(this.width,s))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new xi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,i=!1){const r=s.key,l=i?this._alignedPosMatrixCache:this._posMatrixCache;if(l[r])return l[r];const d=s.canonical,y=this.worldSize/this.zoomScale(d.z),I=d.x+Math.pow(2,d.z)*s.wrap,k=a.an(new Float64Array(16));return a.H(k,k,[I*y,d.y*y,0]),a.J(k,k,[y/a.W,y/a.W,1]),a.K(k,i?this.alignedProjMatrix:this.projMatrix,k),l[r]=new Float32Array(k),l[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;let s=this.lngRange;if(!this._renderWorldCopies&&s===null){const ke=179.9999999999;s=[-ke,ke]}this._constraining=!0;let i,r,l,d,y=-90,I=90,k=-180,z=180;const Z=this.size,Y=this._unmodified;if(this.latRange){const ke=this.latRange;y=a.O(ke[1])*this.worldSize,I=a.O(ke[0])*this.worldSize,i=I-y<Z.y?Z.y/(I-y):0}s&&(k=a.b0(a.N(s[0])*this.worldSize,0,this.worldSize),z=a.b0(a.N(s[1])*this.worldSize,0,this.worldSize),z<k&&(z+=this.worldSize),r=z-k<Z.x?Z.x/(z-k):0);const Ae=this.point,Ie=Math.max(r||0,i||0);if(Ie)return this.center=this.unproject(new a.P(r?(z+k)/2:Ae.x,i?(I+y)/2:Ae.y)),this.zoom+=this.scaleZoom(Ie),this._unmodified=Y,void(this._constraining=!1);if(this.latRange){const ke=Ae.y,Fe=Z.y/2;ke-Fe<y&&(d=y+Fe),ke+Fe>I&&(d=I-Fe)}if(s){const ke=(k+z)/2;let Fe=Ae.x;this._renderWorldCopies&&(Fe=a.b0(Ae.x,ke-this.worldSize/2,ke+this.worldSize/2));const ze=Z.x/2;Fe-ze<k&&(l=k+ze),Fe+ze>z&&(l=z-ze)}l===void 0&&d===void 0||(this.center=this.unproject(new a.P(l!==void 0?l:Ae.x,d!==void 0?d:Ae.y)).wrap()),this._unmodified=Y,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,i=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b2(1,this.center.lat)*this.worldSize;let l=a.an(new Float64Array(16));a.J(l,l,[this.width/2,-this.height/2,1]),a.H(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=a.an(new Float64Array(16)),a.J(l,l,[1,-1,1]),a.H(l,l,[-1,-1,0]),a.J(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l;const d=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),y=Math.min(this.elevation,this.minElevationForCurrentTile),I=d-y*this._pixelPerMeter/Math.cos(this._pitch),k=y<0?I:d,z=Math.PI/2+this._pitch,Z=this._fov*(.5+s.y/this.height),Y=Math.sin(Z)*k/Math.sin(a.ac(Math.PI-z-Z,.01,Math.PI-.01)),Ae=this.getHorizon(),Ie=2*Math.atan(Ae/this.cameraToCenterDistance)*(.5+s.y/(2*Ae)),ke=Math.sin(Ie)*k/Math.sin(a.ac(Math.PI-z-Ie,.01,Math.PI-.01)),Fe=Math.min(Y,ke),ze=1.01*(Math.cos(Math.PI/2-this._pitch)*Fe+k),tt=this.height/50;l=new Float64Array(16),a.b3(l,this._fov,this.width/this.height,tt,ze),l[8]=2*-s.x/this.width,l[9]=2*s.y/this.height,a.J(l,l,[1,-1,1]),a.H(l,l,[0,0,-this.cameraToCenterDistance]),a.b4(l,l,this._pitch),a.ad(l,l,this.angle),a.H(l,l,[-i,-r,0]),this.mercatorMatrix=a.J([],l,[this.worldSize,this.worldSize,this.worldSize]),a.J(l,l,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.K(new Float64Array(16),this.labelPlaneMatrix,l),a.H(l,l,[0,0,-this.elevation]),this.projMatrix=l,this.invProjMatrix=a.ar([],l),this.pixelMatrix3D=a.K(new Float64Array(16),this.labelPlaneMatrix,l);const wt=this.width%2/2,lt=this.height%2/2,ft=Math.cos(this.angle),Tt=Math.sin(this.angle),It=i-Math.round(i)+ft*wt+Tt*lt,si=r-Math.round(r)+ft*lt+Tt*wt,Kt=new Float64Array(l);if(a.H(Kt,Kt,[It>.5?It-1:It,si>.5?si-1:si,0]),this.alignedProjMatrix=Kt,l=a.ar(new Float64Array(16),this.pixelMatrix),!l)throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new a.P(0,0)),i=[s.x*this.worldSize,s.y*this.worldSize,0,1];return a.af(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,s))}getCameraQueryGeometry(s){const i=this.getCameraPoint();if(s.length===1)return[s[0],i];{let r=i.x,l=i.y,d=i.x,y=i.y;for(const I of s)r=Math.min(r,I.x),l=Math.min(l,I.y),d=Math.max(d,I.x),y=Math.max(y,I.y);return[new a.P(r,l),new a.P(d,l),new a.P(d,y),new a.P(r,y),new a.P(r,l)]}}lngLatToCameraDepth(s,i){const r=this.locationCoordinate(s),l=[r.x*this.worldSize,r.y*this.worldSize,i,1];return a.af(l,l,this.projMatrix),l[2]/l[3]}}function _l(x,s){let i,r=!1,l=null,d=null;const y=()=>{l=null,r&&(x.apply(d,i),l=setTimeout(y,s),r=!1)};return(...I)=>(r=!0,d=this,i=I,l||y(),l)}class ho{constructor(s){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let r;return i.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(r=l)}),(r&&r[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(i.length>=3&&!i.some(r=>isNaN(r))){const r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:r,pitch:+(i[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch{}},this._updateHash=_l(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const i=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,l=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,l),y=Math.round(i.lng*d)/d,I=Math.round(i.lat*d)/d,k=this._map.getBearing(),z=this._map.getPitch();let Z="";if(Z+=s?`/${y}/${I}/${r}`:`${r}/${I}/${y}`,(k||z)&&(Z+="/"+Math.round(10*k)/10),z&&(Z+=`/${Math.round(z)}`),this._hashName){const Y=this._hashName;let Ae=!1;const Ie=window.location.hash.slice(1).split("&").map(ke=>{const Fe=ke.split("=")[0];return Fe===Y?(Ae=!0,`${Fe}=${Z}`):ke}).filter(ke=>ke);return Ae||Ie.push(`${Y}=${Z}`),`#${Ie.join("&")}`}return`#${Z}`}}const mi={linearity:.3,easing:a.b5(0,0,.3,1)},qi=a.e({deceleration:2500,maxSpeed:1400},mi),Di=a.e({deceleration:20,maxSpeed:1400},mi),Nt=a.e({deceleration:1e3,maxSpeed:360},mi),ni=a.e({deceleration:1e3,maxSpeed:90},mi);class wi{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:oe.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,i=oe.now();for(;s.length>0&&i-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)i.zoom+=d.zoomDelta||0,i.bearing+=d.bearingDelta||0,i.pitch+=d.pitchDelta||0,d.panDelta&&i.pan._add(d.panDelta),d.around&&(i.around=d.around),d.pinchAround&&(i.pinchAround=d.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,l={};if(i.pan.mag()){const d=On(i.pan.mag(),r,a.e({},qi,s||{}));l.offset=i.pan.mult(d.amount/i.pan.mag()),l.center=this._map.transform.center,Ui(l,d)}if(i.zoom){const d=On(i.zoom,r,Di);l.zoom=this._map.transform.zoom+d.amount,Ui(l,d)}if(i.bearing){const d=On(i.bearing,r,Nt);l.bearing=this._map.transform.bearing+a.ac(d.amount,-179,179),Ui(l,d)}if(i.pitch){const d=On(i.pitch,r,ni);l.pitch=this._map.transform.pitch+d.amount,Ui(l,d)}if(l.zoom||l.bearing){const d=i.pinchAround===void 0?i.around:i.pinchAround;l.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),a.e(l,{noMoveStart:!0})}}function Ui(x,s){(!x.duration||x.duration<s.duration)&&(x.duration=s.duration,x.easing=s.easing)}function On(x,s,i){const{maxSpeed:r,linearity:l,deceleration:d}=i,y=a.ac(x*l/(s/1e3),-r,r),I=Math.abs(y)/(d*l);return{easing:i.easing,duration:1e3*I,amount:y*(I/2)}}class jn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r,l={}){const d=ce.mousePos(i.getCanvas(),r),y=i.unproject(d);super(s,a.e({point:d,lngLat:y,originalEvent:r},l)),this._defaultPrevented=!1,this.target=i}}class cr extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){const l=s==="touchend"?r.changedTouches:r.touches,d=ce.touchPos(i.getCanvasContainer(),l),y=d.map(k=>i.unproject(k)),I=d.reduce((k,z,Z,Y)=>k.add(z.div(Y.length)),new a.P(0,0));super(s,{points:d,point:I,lngLats:y,lngLat:i.unproject(I),originalEvent:r}),this._defaultPrevented=!1}}class Jn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){super(s,{originalEvent:r}),this._defaultPrevented=!1}}class $s{constructor(s,i){this._map=s,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Jn(s.type,this._map,s))}mousedown(s,i){return this._mousedownPos=i,this._firePreventable(new jn(s.type,this._map,s))}mouseup(s){this._map.fire(new jn(s.type,this._map,s))}click(s,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new jn(s.type,this._map,s))}dblclick(s){return this._firePreventable(new jn(s.type,this._map,s))}mouseover(s){this._map.fire(new jn(s.type,this._map,s))}mouseout(s){this._map.fire(new jn(s.type,this._map,s))}touchstart(s){return this._firePreventable(new cr(s.type,this._map,s))}touchmove(s){this._map.fire(new cr(s.type,this._map,s))}touchend(s){this._map.fire(new cr(s.type,this._map,s))}touchcancel(s){this._map.fire(new cr(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bs{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new jn(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new jn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new jn(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _s{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(a.P.convert(s),this._map.terrain)}}class ro{constructor(s,i){this._map=s,this._tr=new _s(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,i){this.isEnabled()&&s.shiftKey&&s.button===0&&(ce.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(s,i){if(!this._active)return;const r=i;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const l=this._startPos;this._lastPos=r,this._box||(this._box=ce.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const d=Math.min(l.x,r.x),y=Math.max(l.x,r.x),I=Math.min(l.y,r.y),k=Math.max(l.y,r.y);ce.setTransform(this._box,`translate(${d}px,${I}px)`),this._box.style.width=y-d+"px",this._box.style.height=k-I+"px"}mouseupWindow(s,i){if(!this._active||s.button!==0)return;const r=this._startPos,l=i;if(this.reset(),ce.suppressClick(),r.x!==l.x||r.y!==l.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:s})),{cameraAnimation:d=>d.fitScreenCoordinates(r,l,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ce.remove(this._box),this._box=null),ce.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,i){return this._map.fire(new a.k(s,{originalEvent:i}))}}function bo(x,s){if(x.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${x.length}, points ${s.length}`);const i={};for(let r=0;r<x.length;r++)i[x[r].identifier]=s[r];return i}class cs{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),r.length===this.numTouches&&(this.centroid=function(l){const d=new a.P(0,0);for(const y of l)d._add(y);return d.div(l.length)}(i),this.touches=bo(r,i)))}touchmove(s,i,r){if(this.aborted||!this.centroid)return;const l=bo(r,i);for(const d in this.touches){const y=l[d];(!y||y.dist(this.touches[d])>30)&&(this.aborted=!0)}}touchend(s,i,r){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),r.length===0){const l=!this.aborted&&this.centroid;if(this.reset(),l)return l}}}class Yu{constructor(s){this.singleTap=new cs(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,i,r){this.singleTap.touchstart(s,i,r)}touchmove(s,i,r){this.singleTap.touchmove(s,i,r)}touchend(s,i,r){const l=this.singleTap.touchend(s,i,r);if(l){const d=s.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(l)<30;if(d&&y||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}}}class Nu{constructor(s){this._tr=new _s(s),this._zoomIn=new Yu({numTouches:1,numTaps:2}),this._zoomOut=new Yu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,i,r){this._zoomIn.touchstart(s,i,r),this._zoomOut.touchstart(s,i,r)}touchmove(s,i,r){this._zoomIn.touchmove(s,i,r),this._zoomOut.touchmove(s,i,r)}touchend(s,i,r){const l=this._zoomIn.touchend(s,i,r),d=this._zoomOut.touchend(s,i,r),y=this._tr;return l?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:y.zoom+1,around:y.unproject(l)},{originalEvent:s})}):d?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:y.zoom-1,around:y.unproject(d)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wo{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const i=this._moveFunction(...s);if(i.bearingDelta||i.pitchDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(s,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=i.length?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,i){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const l=i.length?i[0]:i;return!this._moved&&l.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=l,this._move(r,l))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&ce.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ll={0:1,2:2};class Rn{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const i=ce.mouseButton(s);this._eventButton=i}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(i,r){const l=Ll[r];return i.buttons===void 0||(i.buttons&l)!==l}(s,this._eventButton)}isValidEndEvent(s){return ce.mouseButton(s)===this._eventButton}}class Na{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}const En=x=>{x.mousedown=x.dragStart,x.mousemoveWindow=x.dragMove,x.mouseup=x.dragEnd,x.contextmenu=function(s){s.preventDefault()}},Vo=({enable:x,clickTolerance:s,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Rn({checkCorrectEvent:l=>ce.mouseButton(l)===0&&l.ctrlKey||ce.mouseButton(l)===2});return new wo({clickTolerance:s,move:(l,d)=>({bearingDelta:(d.x-l.x)*i}),moveStateManager:r,enable:x,assignEvents:En})},Gl=({enable:x,clickTolerance:s,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Rn({checkCorrectEvent:l=>ce.mouseButton(l)===0&&l.ctrlKey||ce.mouseButton(l)===2});return new wo({clickTolerance:s,move:(l,d)=>({pitchDelta:(d.y-l.y)*i}),moveStateManager:r,enable:x,assignEvents:En})};class Cn{constructor(s,i){this._clickTolerance=s.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(s,i,r){return this._calculateTransform(s,i,r)}touchmove(s,i,r){if(this._active&&!(r.length<this.minTouchs()))return s.preventDefault(),this._calculateTransform(s,i,r)}touchend(s,i,r){this._calculateTransform(s,i,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,i,r){r.length>0&&(this._active=!0);const l=bo(r,i),d=new a.P(0,0),y=new a.P(0,0);let I=0;for(const z in l){const Z=l[z],Y=this._touches[z];Y&&(d._add(Z),y._add(Z.sub(Y)),I++,l[z]=Z)}if(this._touches=l,I<this.minTouchs()||!y.mag())return;const k=y.div(I);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(I),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,i,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([i[0],i[1]]))}touchmove(s,i,r){if(!this._firstTwoTouches)return;s.preventDefault();const[l,d]=this._firstTwoTouches,y=Tn(r,i,l),I=Tn(r,i,d);if(!y||!I)return;const k=this._aroundCenter?null:y.add(I).div(2);return this._move([y,I],k,s)}touchend(s,i,r){if(!this._firstTwoTouches)return;const[l,d]=this._firstTwoTouches,y=Tn(r,i,l),I=Tn(r,i,d);y&&I||(this._active&&ce.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Tn(x,s,i){for(let r=0;r<x.length;r++)if(x[r].identifier===i)return s[r]}function yl(x,s){return Math.log(x/s)/Math.LN2}class hu extends Yl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,i){const r=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(yl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:yl(this._distance,r),pinchAround:i}}}function Vu(x,s){return 180*x.angleWith(s)/Math.PI}class ql extends Yl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,i,r){const l=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Vu(this._vector,l),pinchAround:i}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const i=25/(Math.PI*this._minDiameter)*360,r=Vu(s,this._startVector);return Math.abs(r)<i}}function vl(x){return Math.abs(x.y)>Math.abs(x.x)}class oa extends Yl{constructor(s){super(),this._currentTouchCount=0,this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,i,r){super.touchstart(s,i,r),this._currentTouchCount=r.length}_start(s){this._lastPoints=s,vl(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,i,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const l=s[0].sub(this._lastPoints[0]),d=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(l,d,r.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(l.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(s,i,r){if(this._valid!==void 0)return this._valid;const l=s.mag()>=2,d=i.mag()>=2;if(!l&&!d)return;if(!l||!d)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<100&&void 0;const y=s.y>0==i.y>0;return vl(s)&&vl(i)&&y}}const uc={panStep:100,bearingStep:15,pitchStep:10};class Ku{constructor(s){this._tr=new _s(s);const i=uc;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let i=0,r=0,l=0,d=0,y=0;switch(s.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:s.shiftKey?r=-1:(s.preventDefault(),d=-1);break;case 39:s.shiftKey?r=1:(s.preventDefault(),d=1);break;case 38:s.shiftKey?l=1:(s.preventDefault(),y=-1);break;case 40:s.shiftKey?l=-1:(s.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(r=0,l=0),{cameraAnimation:I=>{const k=this._tr;I.easeTo({duration:300,easeId:"keyboardHandler",easing:Kl,zoom:i?Math.round(k.zoom)+i*(s.shiftKey?2:1):k.zoom,bearing:k.bearing+r*this._bearingStep,pitch:k.pitch+l*this._pitchStep,offset:[-d*this._panStep,-y*this._panStep],center:k.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Kl(x){return x*(2-x)}const ys=4.000244140625;class wa{constructor(s,i){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=s,this._tr=new _s(s),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!s[this._map.cooperativeGestures._bypassKey])return;let i=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const r=oe.now(),l=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,i!==0&&i%ys==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),s.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=s,this._delta-=i,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=ce.mousePos(this._map.getCanvas(),s),r=this._tr;this._around=i.y>r.transform.height/2-r.transform.getHorizon()?a.M.convert(this._aroundCenter?r.center:r.unproject(i)):a.M.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>ys?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&k!==0&&(k=1/k);const z=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(z*k))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,r=this._startZoom,l=this._easing;let d,y=!1;if(this._type==="wheel"&&r&&l){const I=Math.min((oe.now()-this._lastWheelEventTime)/200,1),k=l(I);d=a.z.number(r,i,k),I<1?this._frameId||(this._frameId=!0):y=!0}else d=i,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!y,zoomDelta:d-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let i=a.b6;if(this._prevEase){const r=this._prevEase,l=(oe.now()-r.start)/r.duration,d=r.easing(l+.01)-r.easing(l),y=.27/Math.sqrt(d*d+1e-4)*.01,I=Math.sqrt(.0729-y*y);i=a.b5(y,I,.25,1)}return this._prevEase={start:oe.now(),duration:s,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class tl{constructor(s,i){this._clickZoom=s,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xu{constructor(s){this._tr=new _s(s),this.reset()}reset(){this._active=!1}dblclick(s,i){return s.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uu{constructor(){this._tap=new Yu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,i,r){if(!this._swipePoint)if(this._tapTime){const l=i[0],d=s.timeStamp-this._tapTime<500,y=this._tapPoint.dist(l)<30;d&&y?r.length>0&&(this._swipePoint=l,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(s,i,r)}touchmove(s,i,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const l=i[0],d=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(s,i,r)}touchend(s,i,r){if(this._tapTime)this._swipePoint&&r.length===0&&this.reset();else{const l=this._tap.touchend(s,i,r);l&&(this._tapTime=s.timeStamp,this._tapPoint=l)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Au{constructor(s,i,r){this._el=s,this._mousePan=i,this._touchPan=r}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gu{constructor(s,i,r){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=i,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class br{constructor(s,i,r,l){this._el=s,this._touchZoom=i,this._touchRotate=r,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class vs{constructor(s,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=s,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const s=this._map.getCanvasContainer();s.classList.add("maplibregl-cooperative-gestures"),this._container=ce.create("div","maplibregl-cooperative-gesture-screen",s);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),l=document.createElement("div");l.className="maplibregl-desktop-message",l.textContent=i,this._container.appendChild(l);const d=document.createElement("div");d.className="maplibregl-mobile-message",d.textContent=r,this._container.appendChild(d),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(ce.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(s){this._onCooperativeGesture(s.touches.length===1)}wheel(s){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!s[this._bypassKey])}_onCooperativeGesture(s){this._enabled&&s&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const gn=x=>x.zoom||x.drag||x.pitch||x.rotate;class Zn extends a.k{}function ir(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class il{constructor(s,i){this.handleWindowEvent=l=>{this.handleEvent(l,`${l.type}Window`)},this.handleEvent=(l,d)=>{if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=l.type==="renderFrame"?void 0:l,I={needsRenderFrame:!1},k={},z={},Z=l.touches,Y=Z?this._getMapTouches(Z):void 0,Ae=Y?ce.touchPos(this._map.getCanvas(),Y):ce.mousePos(this._map.getCanvas(),l);for(const{handlerName:Fe,handler:ze,allowed:tt}of this._handlers){if(!ze.isEnabled())continue;let wt;this._blockedByActive(z,tt,Fe)?ze.reset():ze[d||l.type]&&(wt=ze[d||l.type](l,Ae,Y),this.mergeHandlerResult(I,k,wt,Fe,y),wt&&wt.needsRenderFrame&&this._triggerRenderFrame()),(wt||ze.isActive())&&(z[Fe]=ze)}const Ie={};for(const Fe in this._previousActiveHandlers)z[Fe]||(Ie[Fe]=y);this._previousActiveHandlers=z,(Object.keys(Ie).length||ir(I))&&(this._changes.push([I,k,Ie]),this._triggerRenderFrame()),(Object.keys(z).length||ir(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ke}=I;ke&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ke(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wi(s),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[l,d,y]of this._listeners)ce.addEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[s,i,r]of this._listeners)ce.removeEventListener(s,i,s===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(s){const i=this._map,r=i.getCanvasContainer();this._add("mapEvent",new $s(i,s));const l=i.boxZoom=new ro(i,s);this._add("boxZoom",l),s.interactive&&s.boxZoom&&l.enable();const d=i.cooperativeGestures=new vs(i,s.cooperativeGestures);this._add("cooperativeGestures",d),s.cooperativeGestures&&d.enable();const y=new Nu(i),I=new xu(i);i.doubleClickZoom=new tl(I,y),this._add("tapZoom",y),this._add("clickZoom",I),s.interactive&&s.doubleClickZoom&&i.doubleClickZoom.enable();const k=new Uu;this._add("tapDragZoom",k);const z=i.touchPitch=new oa(i);this._add("touchPitch",z),s.interactive&&s.touchPitch&&i.touchPitch.enable(s.touchPitch);const Z=Vo(s),Y=Gl(s);i.dragRotate=new Gu(s,Z,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]),s.interactive&&s.dragRotate&&i.dragRotate.enable();const Ae=(({enable:wt,clickTolerance:lt})=>{const ft=new Rn({checkCorrectEvent:Tt=>ce.mouseButton(Tt)===0&&!Tt.ctrlKey});return new wo({clickTolerance:lt,move:(Tt,It)=>({around:It,panDelta:It.sub(Tt)}),activateOnStart:!0,moveStateManager:ft,enable:wt,assignEvents:En})})(s),Ie=new Cn(s,i);i.dragPan=new Au(r,Ae,Ie),this._add("mousePan",Ae),this._add("touchPan",Ie,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&i.dragPan.enable(s.dragPan);const ke=new ql,Fe=new hu;i.touchZoomRotate=new br(r,Fe,ke,k),this._add("touchRotate",ke,["touchPan","touchZoom"]),this._add("touchZoom",Fe,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&i.touchZoomRotate.enable(s.touchZoomRotate);const ze=i.scrollZoom=new wa(i,()=>this._triggerRenderFrame());this._add("scrollZoom",ze,["mousePan"]),s.interactive&&s.scrollZoom&&i.scrollZoom.enable(s.scrollZoom);const tt=i.keyboard=new Ku(i);this._add("keyboard",tt),s.interactive&&s.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new Bs(i))}_add(s,i,r){this._handlers.push({handlerName:s,handler:i,allowed:r}),this._handlersById[s]=i}stop(s){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!gn(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,i,r){for(const l in s)if(l!==r&&(!i||i.indexOf(l)<0))return!0;return!1}_getMapTouches(s){const i=[];for(const r of s)this._el.contains(r.target)&&i.push(r);return i}mergeHandlerResult(s,i,r,l,d){if(!r)return;a.e(s,r);const y={handlerName:l,originalEvent:r.originalEvent||d};r.zoomDelta!==void 0&&(i.zoom=y),r.panDelta!==void 0&&(i.drag=y),r.pitchDelta!==void 0&&(i.pitch=y),r.bearingDelta!==void 0&&(i.rotate=y)}_applyChanges(){const s={},i={},r={};for(const[l,d,y]of this._changes)l.panDelta&&(s.panDelta=(s.panDelta||new a.P(0,0))._add(l.panDelta)),l.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+l.zoomDelta),l.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+l.bearingDelta),l.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+l.pitchDelta),l.around!==void 0&&(s.around=l.around),l.pinchAround!==void 0&&(s.pinchAround=l.pinchAround),l.noInertia&&(s.noInertia=l.noInertia),a.e(i,d),a.e(r,y);this._updateMapTransform(s,i,r),this._changes=[]}_updateMapTransform(s,i,r){const l=this._map,d=l._getTransformForUpdate(),y=l.terrain;if(!(ir(s)||y&&this._terrainMovement))return this._fireEvents(i,r,!0);let{panDelta:I,zoomDelta:k,bearingDelta:z,pitchDelta:Z,around:Y,pinchAround:Ae}=s;Ae!==void 0&&(Y=Ae),l._stop(!0),Y=Y||l.transform.centerPoint;const Ie=d.pointLocation(I?Y.sub(I):Y);z&&(d.bearing+=z),Z&&(d.pitch+=Z),k&&(d.zoom+=k),y?this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?d.center=d.pointLocation(d.centerPoint.sub(I)):d.setLocationAtPoint(Ie,Y):(this._terrainMovement=!0,this._map._elevationFreeze=!0,d.setLocationAtPoint(Ie,Y),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,d.recalculateZoom(l.terrain)})):d.setLocationAtPoint(Ie,Y),l._applyUpdatedTransform(d),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(i,r,!0)}_fireEvents(s,i,r){const l=gn(this._eventsInProgress),d=gn(s),y={};for(const Z in s){const{originalEvent:Y}=s[Z];this._eventsInProgress[Z]||(y[`${Z}start`]=Y),this._eventsInProgress[Z]=s[Z]}!l&&d&&this._fireEvent("movestart",d.originalEvent);for(const Z in y)this._fireEvent(Z,y[Z]);d&&this._fireEvent("move",d.originalEvent);for(const Z in s){const{originalEvent:Y}=s[Z];this._fireEvent(Z,Y)}const I={};let k;for(const Z in this._eventsInProgress){const{handlerName:Y,originalEvent:Ae}=this._eventsInProgress[Z];this._handlersById[Y].isActive()||(delete this._eventsInProgress[Z],k=i[Y]||Ae,I[`${Z}end`]=k)}for(const Z in I)this._fireEvent(Z,I[Z]);const z=gn(this._eventsInProgress);if(r&&(l||d)&&!z){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=Ae=>Ae!==0&&-this._bearingSnap<Ae&&Ae<this._bearingSnap;!Z||!Z.essential&&oe.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:k})),Y(this._map.getBearing())&&this._map.resetNorth()):(Y(Z.bearing||this._map.getBearing())&&(Z.bearing=0),Z.freezeElevation=!0,this._map.easeTo(Z,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(s,i){this._map.fire(new a.k(s,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new Zn("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Pu extends a.E{constructor(s,i){super(),this._renderFrameCallback=()=>{const r=Math.min((oe.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=i.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.M(this.transform.center.lng,this.transform.center.lat)}setCenter(s,i){return this.jumpTo({center:s},i)}panBy(s,i,r){return s=a.P.convert(s).mult(-1),this.panTo(this.transform.center,a.e({offset:s},i),r)}panTo(s,i,r){return this.easeTo(a.e({center:s},i),r)}getZoom(){return this.transform.zoom}setZoom(s,i){return this.jumpTo({zoom:s},i),this}zoomTo(s,i,r){return this.easeTo(a.e({zoom:s},i),r)}zoomIn(s,i){return this.zoomTo(this.getZoom()+1,s,i),this}zoomOut(s,i){return this.zoomTo(this.getZoom()-1,s,i),this}getBearing(){return this.transform.bearing}setBearing(s,i){return this.jumpTo({bearing:s},i),this}getPadding(){return this.transform.padding}setPadding(s,i){return this.jumpTo({padding:s},i),this}rotateTo(s,i,r){return this.easeTo(a.e({bearing:s},i),r)}resetNorth(s,i){return this.rotateTo(0,a.e({duration:1e3},s),i),this}resetNorthPitch(s,i){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},s),i),this}snapToNorth(s,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,i):this}getPitch(){return this.transform.pitch}setPitch(s,i){return this.jumpTo({pitch:s},i),this}cameraForBounds(s,i){s=xi.convert(s);const r=i&&i.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),r,i)}_cameraForBoxAndBearing(s,i,r,l){const d={top:0,bottom:0,right:0,left:0};if(typeof(l=a.e({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const Wi=l.padding;l.padding={top:Wi,bottom:Wi,right:Wi,left:Wi}}l.padding=a.e(d,l.padding);const y=this.transform,I=y.padding,k=new xi(s,i),z=y.project(k.getNorthWest()),Z=y.project(k.getNorthEast()),Y=y.project(k.getSouthEast()),Ae=y.project(k.getSouthWest()),Ie=a.b7(-r),ke=z.rotate(Ie),Fe=Z.rotate(Ie),ze=Y.rotate(Ie),tt=Ae.rotate(Ie),wt=new a.P(Math.max(ke.x,Fe.x,tt.x,ze.x),Math.max(ke.y,Fe.y,tt.y,ze.y)),lt=new a.P(Math.min(ke.x,Fe.x,tt.x,ze.x),Math.min(ke.y,Fe.y,tt.y,ze.y)),ft=wt.sub(lt),Tt=(y.width-(I.left+I.right+l.padding.left+l.padding.right))/ft.x,It=(y.height-(I.top+I.bottom+l.padding.top+l.padding.bottom))/ft.y;if(It<0||Tt<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const si=Math.min(y.scaleZoom(y.scale*Math.min(Tt,It)),l.maxZoom),Kt=a.P.convert(l.offset),ii=new a.P((l.padding.left-l.padding.right)/2,(l.padding.top-l.padding.bottom)/2).rotate(a.b7(r)),ai=Kt.add(ii).mult(y.scale/y.zoomScale(si));return{center:y.unproject(z.add(Y).div(2).sub(ai)),zoom:si,bearing:r}}fitBounds(s,i,r){return this._fitInternal(this.cameraForBounds(s,i),i,r)}fitScreenCoordinates(s,i,r,l,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(s)),this.transform.pointLocation(a.P.convert(i)),r,l),l,d)}_fitInternal(s,i,r){return s?(delete(i=a.e(s,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this}jumpTo(s,i){this.stop();const r=this._getTransformForUpdate();let l=!1,d=!1,y=!1;return"zoom"in s&&r.zoom!==+s.zoom&&(l=!0,r.zoom=+s.zoom),s.center!==void 0&&(r.center=a.M.convert(s.center)),"bearing"in s&&r.bearing!==+s.bearing&&(d=!0,r.bearing=+s.bearing),"pitch"in s&&r.pitch!==+s.pitch&&(y=!0,r.pitch=+s.pitch),s.padding==null||r.isPaddingEqual(s.padding)||(r.padding=s.padding),this._applyUpdatedTransform(r),this.fire(new a.k("movestart",i)).fire(new a.k("move",i)),l&&this.fire(new a.k("zoomstart",i)).fire(new a.k("zoom",i)).fire(new a.k("zoomend",i)),d&&this.fire(new a.k("rotatestart",i)).fire(new a.k("rotate",i)).fire(new a.k("rotateend",i)),y&&this.fire(new a.k("pitchstart",i)).fire(new a.k("pitch",i)).fire(new a.k("pitchend",i)),this.fire(new a.k("moveend",i))}calculateCameraOptionsFromTo(s,i,r,l=0){const d=a.Y.fromLngLat(s,i),y=a.Y.fromLngLat(r,l),I=y.x-d.x,k=y.y-d.y,z=y.z-d.z,Z=Math.hypot(I,k,z);if(Z===0)throw new Error("Can't calculate camera options with same From and To");const Y=Math.hypot(I,k),Ae=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Z/this.transform.tileSize),Ie=180*Math.atan2(I,-k)/Math.PI;let ke=180*Math.acos(Y/Z)/Math.PI;return ke=z<0?90-ke:90+ke,{center:y.toLngLat(),zoom:Ae,pitch:ke,bearing:Ie}}easeTo(s,i){this._stop(!1,s.easeId),((s=a.e({offset:[0,0],duration:500,easing:a.b6},s)).animate===!1||!s.essential&&oe.prefersReducedMotion)&&(s.duration=0);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),y=this.getPitch(),I=this.getPadding(),k="zoom"in s?+s.zoom:l,z="bearing"in s?this._normalizeBearing(s.bearing,d):d,Z="pitch"in s?+s.pitch:y,Y="padding"in s?s.padding:r.padding,Ae=a.P.convert(s.offset);let Ie=r.centerPoint.add(Ae);const ke=r.pointLocation(Ie),Fe=a.M.convert(s.center||ke);this._normalizeCenter(Fe);const ze=r.project(ke),tt=r.project(Fe).sub(ze),wt=r.zoomScale(k-l);let lt,ft;s.around&&(lt=a.M.convert(s.around),ft=r.locationPoint(lt));const Tt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||k!==l,this._rotating=this._rotating||d!==z,this._pitching=this._pitching||Z!==y,this._padding=!r.isPaddingEqual(Y),this._easeId=s.easeId,this._prepareEase(i,s.noMoveStart,Tt),this.terrain&&this._prepareElevation(Fe),this._ease(It=>{if(this._zooming&&(r.zoom=a.z.number(l,k,It)),this._rotating&&(r.bearing=a.z.number(d,z,It)),this._pitching&&(r.pitch=a.z.number(y,Z,It)),this._padding&&(r.interpolatePadding(I,Y,It),Ie=r.centerPoint.add(Ae)),this.terrain&&!s.freezeElevation&&this._updateElevation(It),lt)r.setLocationAtPoint(lt,ft);else{const si=r.zoomScale(r.zoom-l),Kt=k>l?Math.min(2,wt):Math.max(.5,wt),ii=Math.pow(Kt,1-It),ai=r.unproject(ze.add(tt.mult(It*ii)).mult(si));r.setLocationAtPoint(r.renderWorldCopies?ai.wrap():ai,Ie)}this._applyUpdatedTransform(r),this._fireMoveEvents(i)},It=>{this.terrain&&this._finalizeElevation(),this._afterEase(i,It)},s),this}_prepareEase(s,i,r={}){this._moving=!0,i||r.moving||this.fire(new a.k("movestart",s)),this._zooming&&!r.zooming&&this.fire(new a.k("zoomstart",s)),this._rotating&&!r.rotating&&this.fire(new a.k("rotatestart",s)),this._pitching&&!r.pitching&&this.fire(new a.k("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&i!==this._elevationTarget){const r=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(r-(i-(r*s+this._elevationStart))/(1-s)),this._elevationTarget=i}this.transform.elevation=a.z.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;const i=s.clone(),{center:r,zoom:l,pitch:d,bearing:y,elevation:I}=this.transformCameraUpdate(i);r&&(i.center=r),l!==void 0&&(i.zoom=l),d!==void 0&&(i.pitch=d),y!==void 0&&(i.bearing=y),I!==void 0&&(i.elevation=I),this.transform.apply(i)}_fireMoveEvents(s){this.fire(new a.k("move",s)),this._zooming&&this.fire(new a.k("zoom",s)),this._rotating&&this.fire(new a.k("rotate",s)),this._pitching&&this.fire(new a.k("pitch",s))}_afterEase(s,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const r=this._zooming,l=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new a.k("zoomend",s)),l&&this.fire(new a.k("rotateend",s)),d&&this.fire(new a.k("pitchend",s)),this.fire(new a.k("moveend",s))}flyTo(s,i){if(!s.essential&&oe.prefersReducedMotion){const ji=a.L(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ji,i)}this.stop(),s=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.b6},s);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),y=this.getPitch(),I=this.getPadding(),k="zoom"in s?a.ac(+s.zoom,r.minZoom,r.maxZoom):l,z="bearing"in s?this._normalizeBearing(s.bearing,d):d,Z="pitch"in s?+s.pitch:y,Y="padding"in s?s.padding:r.padding,Ae=r.zoomScale(k-l),Ie=a.P.convert(s.offset);let ke=r.centerPoint.add(Ie);const Fe=r.pointLocation(ke),ze=a.M.convert(s.center||Fe);this._normalizeCenter(ze);const tt=r.project(Fe),wt=r.project(ze).sub(tt);let lt=s.curve;const ft=Math.max(r.width,r.height),Tt=ft/Ae,It=wt.mag();if("minZoom"in s){const ji=a.ac(Math.min(s.minZoom,l,k),r.minZoom,r.maxZoom),cn=ft/r.zoomScale(ji-l);lt=Math.sqrt(cn/It*2)}const si=lt*lt;function Kt(ji){const cn=(Tt*Tt-ft*ft+(ji?-1:1)*si*si*It*It)/(2*(ji?Tt:ft)*si*It);return Math.log(Math.sqrt(cn*cn+1)-cn)}function ii(ji){return(Math.exp(ji)-Math.exp(-ji))/2}function ai(ji){return(Math.exp(ji)+Math.exp(-ji))/2}const Wi=Kt(!1);let $i=function(ji){return ai(Wi)/ai(Wi+lt*ji)},Ei=function(ji){return ft*((ai(Wi)*(ii(cn=Wi+lt*ji)/ai(cn))-ii(Wi))/si)/It;var cn},Hi=(Kt(!0)-Wi)/lt;if(Math.abs(It)<1e-6||!isFinite(Hi)){if(Math.abs(ft-Tt)<1e-6)return this.easeTo(s,i);const ji=Tt<ft?-1:1;Hi=Math.abs(Math.log(Tt/ft))/lt,Ei=function(){return 0},$i=function(cn){return Math.exp(ji*lt*cn)}}return s.duration="duration"in s?+s.duration:1e3*Hi/("screenSpeed"in s?+s.screenSpeed/lt:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=d!==z,this._pitching=Z!==y,this._padding=!r.isPaddingEqual(Y),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(ze),this._ease(ji=>{const cn=ji*Hi,Nn=1/$i(cn);r.zoom=ji===1?k:l+r.scaleZoom(Nn),this._rotating&&(r.bearing=a.z.number(d,z,ji)),this._pitching&&(r.pitch=a.z.number(y,Z,ji)),this._padding&&(r.interpolatePadding(I,Y,ji),ke=r.centerPoint.add(Ie)),this.terrain&&!s.freezeElevation&&this._updateElevation(ji);const nn=ji===1?ze:r.unproject(tt.add(wt.mult(Ei(cn))).mult(Nn));r.setLocationAtPoint(r.renderWorldCopies?nn.wrap():nn,ke),this._applyUpdatedTransform(r),this._fireMoveEvents(i)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(i)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,i){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,i)}if(!s){const r=this.handlers;r&&r.stop(!1)}return this}_ease(s,i,r){r.animate===!1||r.duration===0?(s(1),i()):(this._easeStart=oe.now(),this._easeOptions=r,this._onEaseFrame=s,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,i){s=a.b0(s,-180,180);const r=Math.abs(s-i);return Math.abs(s-360-i)<r&&(s-=360),Math.abs(s+360-i)<r&&(s+=360),s}_normalizeCenter(s){const i=this.transform;if(!i.renderWorldCopies||i.lngRange)return;const r=s.lng-i.center.lng;s.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(a.M.convert(s),this.transform.tileZoom)-this.transform.elevation:null}}const fa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class bu{constructor(s=fa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options.compact,this._container=ce.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ce.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ce.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ce.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,i){const r=this._map._getUIString(`AttributionControl.${i}`);s.title=r,s.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(l=>typeof l!="string"?"":l)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const l=this._map.style.stylesheet;this.styleOwner=l.owner,this.styleId=l.id}const i=this._map.style.sourceCaches;for(const l in i){const d=i[l];if(d.used||d.usedForTerrain){const y=d.getSource();y.attribution&&s.indexOf(y.attribution)<0&&s.push(y.attribution)}}s=s.filter(l=>String(l).trim()),s.sort((l,d)=>l.length-d.length),s=s.filter((l,d)=>{for(let y=d+1;y<s.length;y++)if(s[y].indexOf(l)>=0)return!1;return!0});const r=s.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,s.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Is{constructor(s={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const r=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&r.classList.add("maplibregl-compact"):r.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=ce.create("div","maplibregl-ctrl");const i=ce.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ce.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Bo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const i=++this._id;return this._queue.push({callback:s,id:i,cancelled:!1}),i}remove(s){const i=this._currentlyRunning,r=i?this._queue.concat(i):this._queue;for(const l of r)if(l.id===s)return void(l.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const r of i)if(!r.cancelled&&(r.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Mi=a.X([{name:"a_pos3d",type:"Int16",components:3}]);class zi extends a.E{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,i){this.sourceCache.update(s,i),this._renderableTilesKeys=[];const r={};for(const l of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))r[l.key]=!0,this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),a.aN(l.posMatrix,0,a.W,0,a.W,0,1),this._tiles[l.key]=new ie(l,this.tileSize));for(const l in this._tiles)r[l]||delete this._tiles[l]}freeRtt(s){for(const i in this._tiles){const r=this._tiles[i];(!s||r.tileID.equals(s)||r.tileID.isChildOf(s)||s.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const i={};for(const r of this._renderableTilesKeys){const l=this._tiles[r].tileID;if(l.canonical.equals(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16),a.aN(d.posMatrix,0,a.W,0,a.W,0,1),i[r]=d}else if(l.canonical.isChildOf(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const y=l.canonical.z-s.canonical.z,I=l.canonical.x-(l.canonical.x>>y<<y),k=l.canonical.y-(l.canonical.y>>y<<y),z=a.W>>y;a.aN(d.posMatrix,0,z,0,z,0,1),a.H(d.posMatrix,d.posMatrix,[-I*z,-k*z,0]),i[r]=d}else if(s.canonical.isChildOf(l.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const y=s.canonical.z-l.canonical.z,I=s.canonical.x-(s.canonical.x>>y<<y),k=s.canonical.y-(s.canonical.y>>y<<y),z=a.W>>y;a.aN(d.posMatrix,0,a.W,0,a.W,0,1),a.H(d.posMatrix,d.posMatrix,[I*z,k*z,0]),a.J(d.posMatrix,d.posMatrix,[1/2**y,1/2**y,0]),i[r]=d}}return i}getSourceTile(s,i){const r=this.sourceCache._source;let l=s.overscaledZ-this.deltaZoom;if(l>r.maxzoom&&(l=r.maxzoom),l<r.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(l).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!d||!d.dem)&&i)for(;l>=r.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(s.scaledTo(l--).key);return d}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(i=>i.timeAdded>=s)}}class Es{constructor(s,i,r){this.painter=s,this.sourceCache=new zi(i),this.options=r,this.exaggeration=typeof r.exaggeration=="number"?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,i,r,l=a.W){var d;if(!(i>=0&&i<l&&r>=0&&r<l))return 0;const y=this.getTerrainData(s),I=(d=y.tile)===null||d===void 0?void 0:d.dem;if(!I)return 0;const k=function(ke,Fe,ze){var tt=Fe[0],wt=Fe[1];return ke[0]=ze[0]*tt+ze[4]*wt+ze[12],ke[1]=ze[1]*tt+ze[5]*wt+ze[13],ke}([],[i/l*a.W,r/l*a.W],y.u_terrain_matrix),z=[k[0]*I.dim,k[1]*I.dim],Z=Math.floor(z[0]),Y=Math.floor(z[1]),Ae=z[0]-Z,Ie=z[1]-Y;return I.get(Z,Y)*(1-Ae)*(1-Ie)+I.get(Z+1,Y)*Ae*(1-Ie)+I.get(Z,Y+1)*(1-Ae)*Ie+I.get(Z+1,Y+1)*Ae*Ie}getElevationForLngLatZoom(s,i){const{tileID:r,mercatorX:l,mercatorY:d}=this._getOverscaledTileIDFromLngLatZoom(s,i);return this.getElevation(r,l%a.W,d%a.W,a.W)}getElevation(s,i,r,l=a.W){return this.getDEMElevation(s,i,r,l)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const l=this.painter.context,d=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new St(l,d,l.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new St(l,new a.R({width:1,height:1}),l.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.an([])}const i=this.sourceCache.getSourceTile(s,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const l=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new St(l,i.dem.getPixels(),l.gl.RGBA,{premultiply:!1}),i.demTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const r=i&&i+i.tileID.key+s.key;if(r&&!this._demMatrixCache[r]){const l=this.sourceCache.sourceCache._source.maxzoom;let d=s.canonical.z-i.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=l?d=s.canonical.z-l:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const y=s.canonical.x-(s.canonical.x>>d<<d),I=s.canonical.y-(s.canonical.y>>d<<d),k=a.b8(new Float64Array(16),[1/(a.W<<d),1/(a.W<<d),0]);a.H(k,k,[y*a.W,I*a.W,0]),this._demMatrixCache[s.key]={matrix:k,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(s){const i=this.painter,r=i.width/devicePixelRatio,l=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===l||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new St(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new St(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(r,l,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,r,l))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,y=0;d<this._coordsTextureSize;d++)for(let I=0;I<this._coordsTextureSize;I++,y+=4)i[y+0]=255&I,i[y+1]=255&d,i[y+2]=I>>8<<4|d>>8,i[y+3]=0;const r=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),l=new St(s,r,s.gl.RGBA,{premultiply:!1});return l.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=l,l}pointCoordinate(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null);const d=i[0]+(i[2]>>4<<8),y=i[1]+((15&i[2])<<8),I=this.coordsIndex[255-i[3]],k=I&&this.sourceCache.getTileByID(I);if(!k)return null;const z=this._coordsTextureSize,Z=(1<<k.tileID.canonical.z)*z;return new a.Y((k.tileID.canonical.x*z+d)/Z+k.tileID.wrap,(k.tileID.canonical.y*z+y)/Z,this.getElevation(k.tileID,d,y,z))}depthAtPoint(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.painter.context,i=new a.b9,r=new a.aX,l=this.meshSize,d=a.W/l,y=l*l;for(let Y=0;Y<=l;Y++)for(let Ae=0;Ae<=l;Ae++)i.emplaceBack(Ae*d,Y*d,0);for(let Y=0;Y<y;Y+=l+1)for(let Ae=0;Ae<l;Ae++)r.emplaceBack(Ae+Y,l+Ae+Y+1,l+Ae+Y+2),r.emplaceBack(Ae+Y,l+Ae+Y+2,Ae+Y+1);const I=i.length,k=I+2*(l+1);for(const Y of[0,1])for(let Ae=0;Ae<=l;Ae++)for(const Ie of[0,1])i.emplaceBack(Ae*d,Y*a.W,Ie);for(let Y=0;Y<2*l;Y+=2)r.emplaceBack(k+Y,k+Y+1,k+Y+3),r.emplaceBack(k+Y,k+Y+3,k+Y+2),r.emplaceBack(I+Y,I+Y+3,I+Y+1),r.emplaceBack(I+Y,I+Y+2,I+Y+3);const z=i.length,Z=z+2*(l+1);for(const Y of[0,1])for(let Ae=0;Ae<=l;Ae++)for(const Ie of[0,1])i.emplaceBack(Y*a.W,Ae*d,Ie);for(let Y=0;Y<2*l;Y+=2)r.emplaceBack(z+Y,z+Y+1,z+Y+3),r.emplaceBack(z+Y,z+Y+3,z+Y+2),r.emplaceBack(Z+Y,Z+Y+3,Z+Y+1),r.emplaceBack(Z+Y,Z+Y+2,Z+Y+3);return this._mesh={indexBuffer:s.createIndexBuffer(r),vertexBuffer:s.createVertexBuffer(i,Mi.members),segments:a.$.simpleSegment(0,0,i.length,r.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*a.ba/Math.pow(2,s)/5}getMinTileElevationForLngLatZoom(s,i){var r;const{tileID:l}=this._getOverscaledTileIDFromLngLatZoom(s,i);return(r=this.getMinMaxElevation(l).minElevation)!==null&&r!==void 0?r:0}getMinMaxElevation(s){const i=this.getTerrainData(s).tile,r={minElevation:null,maxElevation:null};return i&&i.dem&&(r.minElevation=i.dem.min*this.exaggeration,r.maxElevation=i.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(s,i){const r=a.Y.fromLngLat(s.wrap()),l=(1<<i)*a.W,d=r.x*l,y=r.y*l,I=Math.floor(d/a.W),k=Math.floor(y/a.W);return{tileID:new a.Q(i,0,i,I,k),mercatorX:d,mercatorY:y}}}class wu{constructor(s,i,r){this._context=s,this._size=i,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new St(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(r.texture),{id:s,fbo:i,texture:r,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>s.id!==i),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}const Uo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ms{constructor(s,i){this.painter=s,this.terrain=i,this.pool=new wu(s.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(r=>!s._layers[r].isHidden(i)),this._coordsDescendingInv={};for(const r in s.sourceCaches){this._coordsDescendingInv[r]={};const l=s.sourceCaches[r].getVisibleCoordinates();for(const d of l){const y=this.terrain.sourceCache.getTerrainCoords(d);for(const I in y)this._coordsDescendingInv[r][I]||(this._coordsDescendingInv[r][I]=[]),this._coordsDescendingInv[r][I].push(y[I])}}this._coordsDescendingInvStr={};for(const r of s._order){const l=s._layers[r],d=l.source;if(Uo[l.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const y in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][y]=this._coordsDescendingInv[d][y].map(I=>I.key).sort().join()}}for(const r of this._renderableTiles)for(const l in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[l][r.tileID.key];d&&d!==r.rttCoords[l]&&(r.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;const i=s.type,r=this.painter,l=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(Uo[i]&&(this._prevType&&Uo[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(s.id),!l))return!0;if(Uo[this._prevType]||Uo[i]&&l){this._prevType=i;const d=this._stacks.length-1,y=this._stacks[d]||[];for(const I of this._renderableTiles){if(this.pool.isFull()&&(aa(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[d]){const z=this.pool.getObjectForId(I.rtt[d].id);if(z.stamp===I.rtt[d].stamp){this.pool.useObject(z);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),I.rtt[d]={id:k.id,stamp:k.stamp},r.context.bindFramebuffer.set(k.fbo.framebuffer),r.context.clear({color:a.aO.transparent,stencil:0}),r.currentStencilSource=void 0;for(let z=0;z<y.length;z++){const Z=r.style._layers[y[z]],Y=Z.source?this._coordsDescendingInv[Z.source][I.tileID.key]:[I.tileID];r.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),r._renderTileClippingMasks(Z,Y),r.renderLayer(r,r.style.sourceCaches[Z.source],Z,Y),Z.source&&(I.rttCoords[Z.source]=this._coordsDescendingInvStr[Z.source][I.tileID.key])}}return aa(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Uo[i]}return!1}}const Al={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},zs=N,T={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:fa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},L=x=>{x.touchstart=x.dragStart,x.touchmoveWindow=x.dragMove,x.touchend=x.dragEnd},R={showCompass:!0,showZoom:!0,visualizePitch:!1};class F{constructor(s,i,r=!1){this.mousedown=y=>{this.startMouse(a.e({},y,{ctrlKey:!0,preventDefault:()=>y.preventDefault()}),ce.mousePos(this.element,y)),ce.addEventListener(window,"mousemove",this.mousemove),ce.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.moveMouse(y,ce.mousePos(this.element,y))},this.mouseup=y=>{this.mouseRotate.dragEnd(y),this.mousePitch&&this.mousePitch.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ce.touchPos(this.element,y.targetTouches)[0],this.startTouch(y,this._startPos),ce.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=ce.touchPos(this.element,y.targetTouches)[0],this.moveTouch(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const l=s.dragRotate._mouseRotate.getClickTolerance(),d=s.dragRotate._mousePitch.getClickTolerance();this.element=i,this.mouseRotate=Vo({clickTolerance:l,enable:!0}),this.touchRotate=(({enable:y,clickTolerance:I,bearingDegreesPerPixelMoved:k=.8})=>{const z=new Na;return new wo({clickTolerance:I,move:(Z,Y)=>({bearingDelta:(Y.x-Z.x)*k}),moveStateManager:z,enable:y,assignEvents:L})})({clickTolerance:l,enable:!0}),this.map=s,r&&(this.mousePitch=Gl({clickTolerance:d,enable:!0}),this.touchPitch=(({enable:y,clickTolerance:I,pitchDegreesPerPixelMoved:k=-.5})=>{const z=new Na;return new wo({clickTolerance:I,move:(Z,Y)=>({pitchDelta:(Y.y-Z.y)*k}),moveStateManager:z,enable:y,assignEvents:L})})({clickTolerance:d,enable:!0})),ce.addEventListener(i,"mousedown",this.mousedown),ce.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),ce.addEventListener(i,"touchcancel",this.reset)}startMouse(s,i){this.mouseRotate.dragStart(s,i),this.mousePitch&&this.mousePitch.dragStart(s,i),ce.disableDrag()}startTouch(s,i){this.touchRotate.dragStart(s,i),this.touchPitch&&this.touchPitch.dragStart(s,i),ce.disableDrag()}moveMouse(s,i){const r=this.map,{bearingDelta:l}=this.mouseRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.mousePitch){const{pitchDelta:d}=this.mousePitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}moveTouch(s,i){const r=this.map,{bearingDelta:l}=this.touchRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.touchPitch){const{pitchDelta:d}=this.touchPitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}off(){const s=this.element;ce.removeEventListener(s,"mousedown",this.mousedown),ce.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend),ce.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){ce.enableDrag(),ce.removeEventListener(window,"mousemove",this.mousemove),ce.removeEventListener(window,"mouseup",this.mouseup),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend)}}let te;function ue(x,s,i){const r=new a.M(x.lng,x.lat);if(x=new a.M(x.lng,x.lat),s){const l=new a.M(x.lng-360,x.lat),d=new a.M(x.lng+360,x.lat),y=i.locationPoint(x).distSqr(s);i.locationPoint(l).distSqr(s)<y?x=l:i.locationPoint(d).distSqr(s)<y&&(x=d)}for(;Math.abs(x.lng-i.center.lng)>180;){const l=i.locationPoint(x);if(l.x>=0&&l.y>=0&&l.x<=i.width&&l.y<=i.height)break;x.lng>i.center.lng?x.lng-=360:x.lng+=360}return x.lng!==r.lng&&i.locationPoint(x).y>i.height/2-i.getHorizon()?x:r}const le={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Se(x,s,i){const r=x.classList;for(const l in le)r.remove(`maplibregl-${i}-anchor-${l}`);r.add(`maplibregl-${i}-anchor-${s}`)}class Xe extends a.E{constructor(s){if(super(),this._onKeyPress=i=>{const r=i.code,l=i.charCode||i.keyCode;r!=="Space"&&r!=="Enter"&&l!==32&&l!==13||this.togglePopup()},this._onMapClick=i=>{const r=i.originalEvent.target,l=this._element;this._popup&&(r===l||l.contains(r))&&this.togglePopup()},this._update=i=>{var r;if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ue(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),i&&i.type!=="moveend"||(this._pos=this._pos.round()),ce.setTransform(this._element,`${le[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${d}`),oe.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const r=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(s==null?void 0:s.opacity,s==null?void 0:s.opacityWhenCovered),s&&s.element)this._element=s.element,this._offset=a.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=ce.create("div"),this._element.setAttribute("aria-label","Map marker");const i=ce.createNS("http://www.w3.org/2000/svg","svg"),r=41,l=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${r}px`),i.setAttributeNS(null,"width",`${l}px`),i.setAttributeNS(null,"viewBox",`0 0 ${l} ${r}`);const d=ce.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"stroke","none"),d.setAttributeNS(null,"stroke-width","1"),d.setAttributeNS(null,"fill","none"),d.setAttributeNS(null,"fill-rule","evenodd");const y=ce.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");const I=ce.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const tt of k){const wt=ce.createNS("http://www.w3.org/2000/svg","ellipse");wt.setAttributeNS(null,"opacity","0.04"),wt.setAttributeNS(null,"cx","10.5"),wt.setAttributeNS(null,"cy","5.80029008"),wt.setAttributeNS(null,"rx",tt.rx),wt.setAttributeNS(null,"ry",tt.ry),I.appendChild(wt)}const z=ce.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const Z=ce.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(Z);const Y=ce.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const Ae=ce.createNS("http://www.w3.org/2000/svg","path");Ae.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(Ae);const Ie=ce.createNS("http://www.w3.org/2000/svg","g");Ie.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ie.setAttributeNS(null,"fill","#FFFFFF");const ke=ce.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Fe=ce.createNS("http://www.w3.org/2000/svg","circle");Fe.setAttributeNS(null,"fill","#000000"),Fe.setAttributeNS(null,"opacity","0.25"),Fe.setAttributeNS(null,"cx","5.5"),Fe.setAttributeNS(null,"cy","5.5"),Fe.setAttributeNS(null,"r","5.4999962");const ze=ce.createNS("http://www.w3.org/2000/svg","circle");ze.setAttributeNS(null,"fill","#FFFFFF"),ze.setAttributeNS(null,"cx","5.5"),ze.setAttributeNS(null,"cy","5.5"),ze.setAttributeNS(null,"r","5.4999962"),ke.appendChild(Fe),ke.appendChild(ze),y.appendChild(I),y.appendChild(z),y.appendChild(Y),y.appendChild(Ie),y.appendChild(ke),i.appendChild(y),i.setAttributeNS(null,"height",r*this._scale+"px"),i.setAttributeNS(null,"width",l*this._scale+"px"),this._element.appendChild(i),this._offset=a.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),Se(this._element,this._anchor,"marker"),s&&s.className)for(const i of s.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ce.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.M.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const l=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(38.1-13.5+l)],"bottom-right":[-l,-1*(38.1-13.5+l)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():(s.setLngLat(this._lngLat),s.addTo(this._map)),this):this}_updateOpacity(s=!1){var i;if(!(!((i=this._map)===null||i===void 0)&&i.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(s)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const r=this._map,l=r.terrain.depthAtPoint(this._pos),d=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom);if(r.transform.lngLatToCameraDepth(this._lngLat,d)-l<.006)return void(this._element.style.opacity=this._opacity);const y=-this._offset.y/r.transform._pixelPerMeter,I=Math.sin(r.getPitch()*Math.PI/180)*y,k=r.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),z=r.transform.lngLatToCameraDepth(this._lngLat,d+I);this._element.style.opacity=z-k>.006?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(s){return this._offset=a.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(s,i){return s===void 0&&i===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),s!==void 0&&(this._opacity=s),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const bt={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let kt=0,ri=!1;const Ht={maxWidth:100,unit:"metric"};function Qt(x,s,i){const r=i&&i.maxWidth||100,l=x._container.clientHeight/2,d=x.unproject([0,l]),y=x.unproject([r,l]),I=d.distanceTo(y);if(i&&i.unit==="imperial"){const k=3.2808*I;k>5280?Q(s,r,k/5280,x._getUIString("ScaleControl.Miles")):Q(s,r,k,x._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?Q(s,r,I/1852,x._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Q(s,r,I/1e3,x._getUIString("ScaleControl.Kilometers")):Q(s,r,I,x._getUIString("ScaleControl.Meters"))}function Q(x,s,i,r){const l=function(d){const y=Math.pow(10,`${Math.floor(d)}`.length-1);let I=d/y;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(k){const z=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*z)/z}(I),y*I}(i);x.style.width=s*(l/i)+"px",x.innerHTML=`${l}&nbsp;${r}`}const A={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},C=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function O(x){if(x){if(typeof x=="number"){const s=Math.round(Math.abs(x)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,x),"top-left":new a.P(s,s),"top-right":new a.P(-s,s),bottom:new a.P(0,-x),"bottom-left":new a.P(s,-s),"bottom-right":new a.P(-s,-s),left:new a.P(x,0),right:new a.P(-x,0)}}if(x instanceof a.P||Array.isArray(x)){const s=a.P.convert(x);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:a.P.convert(x.center||[0,0]),top:a.P.convert(x.top||[0,0]),"top-left":a.P.convert(x["top-left"]||[0,0]),"top-right":a.P.convert(x["top-right"]||[0,0]),bottom:a.P.convert(x.bottom||[0,0]),"bottom-left":a.P.convert(x["bottom-left"]||[0,0]),"bottom-right":a.P.convert(x["bottom-right"]||[0,0]),left:a.P.convert(x.left||[0,0]),right:a.P.convert(x.right||[0,0])}}return O(new a.P(0,0))}const V=N;S.AJAXError=a.bd,S.Evented=a.E,S.LngLat=a.M,S.MercatorCoordinate=a.Y,S.Point=a.P,S.addProtocol=a.be,S.config=a.a,S.removeProtocol=a.bf,S.AttributionControl=bu,S.BoxZoomHandler=ro,S.CanvasSource=Wn,S.CooperativeGesturesHandler=vs,S.DoubleClickZoomHandler=tl,S.DragPanHandler=Au,S.DragRotateHandler=Gu,S.EdgeInsets=hl,S.FullscreenControl=class extends a.E{constructor(x={}){super(),this._onFullscreenChange=()=>{var s;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((s=i==null?void 0:i.shadowRoot)===null||s===void 0)&&s.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ce.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const x=this._fullscreenButton=ce.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ce.create("span","maplibregl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},S.GeoJSONSource=oi,S.GeolocateControl=class extends a.E{constructor(x){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",s)),this._finish()}},this._updateCamera=s=>{const i=new a.M(s.coords.longitude,s.coords.latitude),r=s.coords.accuracy,l=this._map.getBearing(),d=a.e({bearing:l},this.options.fitBoundsOptions),y=xi.fromLngLat(i,r);this._map.fitBounds(y,d,{geolocateSource:!0})},this._updateMarker=s=>{if(s){const i=new a.M(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(this.options.trackUserLocation)if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&ri)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=s=>{if(this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=ce.create("button","maplibregl-ctrl-geolocate",this._container),ce.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",s===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ce.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Xe({element:this._dotElement}),this._circleElement=ce.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Xe({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},bt,x)}onAdd(x){return this._map=x,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s=!1){return a._(this,void 0,void 0,function*(){if(te!==void 0&&!s)return te;if(window.navigator.permissions===void 0)return te=!!window.navigator.geolocation,te;try{te=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{te=!!window.navigator.geolocation}return te})}().then(s=>this._setupUI(s)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ce.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,kt=0,ri=!1}_isOutOfMapMaxBounds(x){const s=this._map.getMaxBounds(),i=x.coords;return s&&(i.longitude<s.getWest()||i.longitude>s.getEast()||i.latitude<s.getSouth()||i.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const x=this._map.getBounds(),s=x.getSouthEast(),i=x.getNorthEast(),r=s.distanceTo(i),l=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":kt--,ri=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),kt++,kt>1?(x={maximumAge:6e5,timeout:0},ri=!0):(x=this.options.positionOptions,ri=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},S.Hash=ho,S.ImageSource=Xn,S.KeyboardHandler=Ku,S.LngLatBounds=xi,S.LogoControl=Is,S.Map=class extends Pu{constructor(x){if(a.bb.mark(a.bc.create),(x=a.e({},T,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new cu(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies),{bearingSnap:x.bearingSnap}),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=x.interactive,this._maxTileCacheSize=x.maxTileCacheSize,this._maxTileCacheZoomLevels=x.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._crossSourceCollisions=x.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=x.collectResourceTiming,this._renderTaskQueue=new Bo,this._controls=[],this._mapId=a.a3(),this._locale=a.e({},Al,x.locale),this._clickTolerance=x.clickTolerance,this._overridePixelRatio=x.pixelRatio,this._maxCanvasSize=x.maxCanvasSize,this.transformCameraUpdate=x.transformCameraUpdate,this._imageQueueHandle=xt.addThrottleControl(()=>this.isMoving()),this._requestManager=new Mt(x.transformRequest),typeof x.container=="string"){if(this._container=document.getElementById(x.container),!this._container)throw new Error(`Container '${x.container}' not found.`)}else{if(!(x.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const i=_l(r=>{this._trackResize&&!this._removed&&this.resize(r)._update()},50);this._resizeObserver=new ResizeObserver(r=>{s?i(r):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new il(this,x),this._hash=x.hash&&new ho(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,a.e({},x.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=x.localIdeographFontFamily,this._validateStyle=x.validateStyle,x.style&&this.setStyle(x.style,{localIdeographFontFamily:x.localIdeographFontFamily}),x.attributionControl&&this.addControl(new bu(typeof x.attributionControl=="boolean"?void 0:x.attributionControl)),x.maplibreLogo&&this.addControl(new Is,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new a.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(x,s){if(s===void 0&&(s=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=x.onAdd(this);this._controls.push(x);const r=this._controlPositions[s];return s.indexOf("bottom")!==-1?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(x);return s>-1&&this._controls.splice(s,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}calculateCameraOptionsFromTo(x,s,i,r){return r==null&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(x,s,i,r)}resize(x){var s;const i=this._containerDimensions(),r=i[0],l=i[1],d=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,d),this.painter.resize(r,l,d),this.painter.overLimit()){const I=this.painter.context.gl;this._maxCanvasSize=[I.drawingBufferWidth,I.drawingBufferHeight];const k=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,k),this.painter.resize(r,l,k)}this.transform.resize(r,l),(s=this._requestedCameraState)===null||s===void 0||s.resize(r,l);const y=!this._moving;return y&&(this.stop(),this.fire(new a.k("movestart",x)).fire(new a.k("move",x))),this.fire(new a.k("resize",x)),y&&this.fire(new a.k("moveend",x)),this}_getClampedPixelRatio(x,s){const{0:i,1:r}=this._maxCanvasSize,l=this.getPixelRatio(),d=x*l,y=s*l;return Math.min(d>i?i/d:1,y>r?r/y:1)*l}getPixelRatio(){var x;return(x=this._overridePixelRatio)!==null&&x!==void 0?x:devicePixelRatio}setPixelRatio(x){this._overridePixelRatio=x,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(x){return this.transform.setMaxBounds(xi.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this._update()}project(x){return this.transform.locationPoint(a.M.convert(x),this.style&&this.terrain)}unproject(x){return this.transform.pointLocation(a.P.convert(x),this.terrain)}isMoving(){var x;return this._moving||((x=this.handlers)===null||x===void 0?void 0:x.isMoving())}isZooming(){var x;return this._zooming||((x=this.handlers)===null||x===void 0?void 0:x.isZooming())}isRotating(){var x;return this._rotating||((x=this.handlers)===null||x===void 0?void 0:x.isRotating())}_createDelegatedListener(x,s,i){if(x==="mouseenter"||x==="mouseover"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:d=>{const y=this.getLayer(s)?this.queryRenderedFeatures(d.point,{layers:[s]}):[];y.length?r||(r=!0,i.call(this,new jn(x,this,d.originalEvent,{features:y}))):r=!1},mouseout:()=>{r=!1}}}}if(x==="mouseleave"||x==="mouseout"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:y=>{(this.getLayer(s)?this.queryRenderedFeatures(y.point,{layers:[s]}):[]).length?r=!0:r&&(r=!1,i.call(this,new jn(x,this,y.originalEvent)))},mouseout:y=>{r&&(r=!1,i.call(this,new jn(x,this,y.originalEvent)))}}}}{const r=l=>{const d=this.getLayer(s)?this.queryRenderedFeatures(l.point,{layers:[s]}):[];d.length&&(l.features=d,i.call(this,l),delete l.features)};return{layer:s,listener:i,delegates:{[x]:r}}}}on(x,s,i){if(i===void 0)return super.on(x,s);const r=this._createDelegatedListener(x,s,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(r);for(const l in r.delegates)this.on(l,r.delegates[l]);return this}once(x,s,i){if(i===void 0)return super.once(x,s);const r=this._createDelegatedListener(x,s,i);for(const l in r.delegates)this.once(l,r.delegates[l]);return this}off(x,s,i){return i===void 0?super.off(x,s):(this._delegatedListeners&&this._delegatedListeners[x]&&(r=>{const l=this._delegatedListeners[x];for(let d=0;d<l.length;d++){const y=l[d];if(y.layer===s&&y.listener===i){for(const I in y.delegates)this.off(I,y.delegates[I]);return l.splice(d,1),this}}})(),this)}queryRenderedFeatures(x,s){if(!this.style)return[];let i;const r=x instanceof a.P||Array.isArray(x),l=r?x:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(r?{}:x)||{},l instanceof a.P||typeof l[0]=="number")i=[a.P.convert(l)];else{const d=a.P.convert(l[0]),y=a.P.convert(l[1]);i=[d,new a.P(y.x,d.y),y,new a.P(d.x,y.y),d]}return this.style.queryRenderedFeatures(i,s,this.transform)}querySourceFeatures(x,s){return this.style.querySourceFeatures(x,s)}setStyle(x,s){return(s=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(x,s))}setTransformRequest(x){return this._requestManager.setTransformRequest(x),this}_getUIString(x){const s=this._locale[x];if(s==null)throw new Error(`Missing UI string '${x}'`);return s}_updateStyle(x,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(x,s));const i=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!x)),x?(this.style=new Bt(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x,s,i):this.style.loadJSON(x,s,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Bt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,s){if(typeof x=="string"){const i=this._requestManager.transformRequest(x,zt.Style);a.h(i,new AbortController).then(r=>{this._updateDiff(r.data,s)}).catch(r=>{r&&this.fire(new a.j(r))})}else typeof x=="object"&&this._updateDiff(x,s)}_updateDiff(x,s){try{this.style.setState(x,s)&&this._update(!0)}catch(i){a.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(x,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(x,s){return this._lazyInitEmptyStyle(),this.style.addSource(x,s),this._update(!0)}isSourceLoaded(x){const s=this.style&&this.style.sourceCaches[x];if(s!==void 0)return s.loaded();this.fire(new a.j(new Error(`There is no source with ID '${x}'`)))}setTerrain(x){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),x){const s=this.style.sourceCaches[x.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${x.source}`);this.terrain===null&&s.reload();for(const i in this.style._layers){const r=this.style._layers[i];r.type==="hillshade"&&r.source===x.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Es(this.painter,s,x),this.painter.renderToTexture=new ms(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==x.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:x})),this}getTerrain(){var x,s;return(s=(x=this.terrain)===null||x===void 0?void 0:x.options)!==null&&s!==void 0?s:null}areTilesLoaded(){const x=this.style&&this.style.sourceCaches;for(const s in x){const i=x[s]._tiles;for(const r in i){const l=i[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}}return!0}removeSource(x){return this.style.removeSource(x),this._update(!0)}getSource(x){return this.style.getSource(x)}addImage(x,s,i={}){const{pixelRatio:r=1,sdf:l=!1,stretchX:d,stretchY:y,content:I}=i;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||a.b(s))){if(s.width===void 0||s.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:z,data:Z}=s,Y=s;return this.style.addImage(x,{data:new a.R({width:k,height:z},new Uint8Array(Z)),pixelRatio:r,stretchX:d,stretchY:y,content:I,sdf:l,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,x),this}}{const{width:k,height:z,data:Z}=oe.getImageData(s);this.style.addImage(x,{data:new a.R({width:k,height:z},Z),pixelRatio:r,stretchX:d,stretchY:y,content:I,sdf:l,version:0})}}updateImage(x,s){const i=this.style.getImage(x);if(!i)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=s instanceof HTMLImageElement||a.b(s)?oe.getImageData(s):s,{width:l,height:d,data:y}=r;if(l===void 0||d===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(l!==i.data.width||d!==i.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(s instanceof HTMLImageElement||a.b(s));return i.data.replace(y,I),this.style.updateImage(x,i),this}getImage(x){return this.style.getImage(x)}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x){return xt.getImage(this._requestManager.transformRequest(x,zt.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(x,s){return this._lazyInitEmptyStyle(),this.style.addLayer(x,s),this._update(!0)}moveLayer(x,s){return this.style.moveLayer(x,s),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(x,s,i){return this.style.setLayerZoomRange(x,s,i),this._update(!0)}setFilter(x,s,i={}){return this.style.setFilter(x,s,i),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,s,i,r={}){return this.style.setPaintProperty(x,s,i,r),this._update(!0)}getPaintProperty(x,s){return this.style.getPaintProperty(x,s)}setLayoutProperty(x,s,i,r={}){return this.style.setLayoutProperty(x,s,i,r),this._update(!0)}getLayoutProperty(x,s){return this.style.getLayoutProperty(x,s)}setGlyphs(x,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(x,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(x,s,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(x,s,i,r=>{r||this._update(!0)}),this}removeSprite(x){return this._lazyInitEmptyStyle(),this.style.removeSprite(x),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(x,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(x,s,i=>{i||this._update(!0)}),this}setLight(x,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(x,s){return this.style.setFeatureState(x,s),this._update()}removeFeatureState(x,s){return this.style.removeFeatureState(x,s),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let x=0,s=0;return this._container&&(x=this._container.clientWidth||400,s=this._container.clientHeight||300),[x,s]}_setupContainer(){const x=this._container;x.classList.add("maplibregl-map");const s=this._canvasContainer=ce.create("div","maplibregl-canvas-container",x);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=ce.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),r=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],r);const l=this._controlContainer=ce.create("div","maplibregl-control-container",x),d=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{d[y]=ce.create("div",`maplibregl-ctrl-${y} `,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,s,i){this._canvas.width=Math.floor(i*x),this._canvas.height=Math.floor(i*s),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const x={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let s=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{s={requestedAttributes:x},r&&(s.statusMessage=r.statusMessage,s.type=r.type)},{once:!0});const i=this._canvas.getContext("webgl2",x)||this._canvas.getContext("webgl",x);if(!i){const r="Failed to initialize WebGL";throw s?(s.message=r,new Error(JSON.stringify(s))):new Error(r)}this.painter=new Ma(i,this.transform),_e.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_render(x){const s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const l=this.transform.zoom,d=oe.now();this.style.zoomHistory.update(l,d);const y=new a.a8(l,{now:d,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),I=y.crossFadingFactor();I===1&&I===this._crossFadingFactor||(i=!0,this._crossFadingFactor=I),this.style.update(y)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bb.mark(a.bc.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,a.bb.mark(a.bc.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var x;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),xt.removeThrottleControl(this._imageQueueHandle),(x=this._resizeObserver)===null||x===void 0||x.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ce.remove(this._canvasContainer),ce.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),a.bb.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,oe.frameAsync(this._frameRequest).then(x=>{a.bb.frame(x),this._frameRequest=null,this._render(x)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get version(){return zs}getCameraTargetElevation(){return this.transform.elevation}},S.MapMouseEvent=jn,S.MapTouchEvent=cr,S.MapWheelEvent=Jn,S.Marker=Xe,S.NavigationControl=class{constructor(x){this._updateZoomButtons=()=>{const s=this._map.getZoom(),i=s===this._map.getMaxZoom(),r=s===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=s},this._setButtonTitle=(s,i)=>{const r=this._map._getUIString(`NavigationControl.${i}`);s.title=r,s.setAttribute("aria-label",r)},this.options=a.e({},R,x),this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),ce.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),ce.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=ce.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new F(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ce.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,s){const i=ce.create("button",x,this._container);return i.type="button",i.addEventListener("click",s),i}},S.Popup=class extends a.E{constructor(x){super(),this.remove=()=>(this._content&&ce.remove(this._content),this._container&&(ce.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{var i;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ce.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ce.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ue(this._lngLat,this._flatPos,this._map.transform):(i=this._lngLat)===null||i===void 0?void 0:i.wrap(),this._trackPointer&&!s)return;const r=this._flatPos=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&s?s:this._map.transform.locationPoint(this._lngLat));let l=this.options.anchor;const d=O(this.options.offset);if(!l){const I=this._container.offsetWidth,k=this._container.offsetHeight;let z;z=r.y+d.bottom.y<k?["top"]:r.y>this._map.transform.height-k?["bottom"]:[],r.x<I/2?z.push("left"):r.x>this._map.transform.width-I/2&&z.push("right"),l=z.length===0?"bottom":z.join("-")}let y=r.add(d[l]);this.options.subpixelPositioning||(y=y.round()),ce.setTransform(this._container,`${le[l]} translate(${y.x}px,${y.y}px)`),Se(this._container,l,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(A),x)}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=a.M.convert(x),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const s=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=x;r=i.firstChild,r;)s.appendChild(r);return this.setDOMContent(s)}getMaxWidth(){var x;return(x=this._container)===null||x===void 0?void 0:x.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ce.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){this._container&&this._container.classList.add(x)}removeClassName(x){this._container&&this._container.classList.remove(x)}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){if(this._container)return this._container.classList.toggle(x)}setSubpixelPositioning(x){this.options.subpixelPositioning=x}_createCloseButton(){this.options.closeButton&&(this._closeButton=ce.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(C);x&&x.focus()}},S.RasterDEMTileSource=$n,S.RasterTileSource=an,S.ScaleControl=class{constructor(x){this._onMove=()=>{Qt(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,Qt(this._map,this._container,this.options)},this.options=a.e({},Ht,x)}getDefaultPosition(){return"bottom-left"}onAdd(x){return this._map=x,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ce.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},S.ScrollZoomHandler=wa,S.Style=Bt,S.TerrainControl=class{constructor(x){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=x}onAdd(x){return this._map=x,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ce.create("button","maplibregl-ctrl-terrain",this._container),ce.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ce.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},S.TwoFingersTouchPitchHandler=oa,S.TwoFingersTouchRotateHandler=ql,S.TwoFingersTouchZoomHandler=hu,S.TwoFingersTouchZoomRotateHandler=br,S.VectorTileSource=Ot,S.VideoSource=zn,S.addSourceType=(x,s)=>a._(void 0,void 0,void 0,function*(){if(b(x))throw new Error(`A source type called "${x}" already exists.`);((i,r)=>{_n[i]=r})(x,s)}),S.clearPrewarmedResources=function(){const x=Gi;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(Ni),Gi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},S.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},S.getRTLTextPluginStatus=function(){return K().getRTLTextPluginStatus()},S.getVersion=function(){return V},S.getWorkerCount=function(){return tn.workerCount},S.getWorkerUrl=function(){return a.a.WORKER_URL},S.importScriptInWorkers=function(x){return gi().broadcast("importScript",x)},S.prewarm=function(){xn().acquire(Ni)},S.setMaxParallelImageRequests=function(x){a.a.MAX_PARALLEL_IMAGE_REQUESTS=x},S.setRTLTextPlugin=function(x,s){return K().setRTLTextPlugin(x,s)},S.setWorkerCount=function(x){tn.workerCount=x},S.setWorkerUrl=function(x){a.a.WORKER_URL=x}});var v=n;return v})})(k3);var bx=k3.exports;const rm=ST();function ST(){const{subscribe:t,set:e,update:n}=of(new Map);return{subscribe:t,set:e,update:n}}const Vy=of(.78),IT=of(1),cg=of({}),vg=of("hex"),tf=of("pd"),t1=ET(),ip=of(null);function ET(){const{subscribe:t,set:e,update:n}=of(null);return{subscribe:t,set:e,update:n}}function wx(t,e,n){const c=t.slice();return c[21]=e[n],c}function Sx(t){let e,n=t[21]+"",c;return{c(){e=Pn("option"),c=Fs(n),this.h()},l(g){e=Dn(g,"OPTION",{});var v=rn(e);c=Os(v,n),v.forEach(Ai),this.h()},h(){e.__value=t[21],xE(e,e.__value)},m(g,v){yn(g,e,v),Bi(e,c)},p:Ra,d(g){g&&Ai(e)}}}function CT(t){let e,n,c,g="Palette",v,S,a,N,$,he="Show county lines?",oe,ce,_e,Ze,nt,Ke="Show ecoregions?",st,ht,xt,zt,Mt,Ue="Draw Mode?",$t,rt,gt="Draw Polygon",At,yt,St="Reset",ut,Ye,_t,ct="Fill Opacity",Ut,Ft,Vt,yi,Ci=gu(t[9]),ki=[];for(let Ni=0;Ni<Ci.length;Ni+=1)ki[Ni]=Sx(wx(t,Ci,Ni));return{c(){e=Pn("div"),n=Pn("div"),c=Pn("h4"),c.textContent=g,v=_r(),S=Pn("select");for(let Ni=0;Ni<ki.length;Ni+=1)ki[Ni].c();a=_r(),N=Pn("div"),$=Pn("h4"),$.textContent=he,oe=_r(),ce=Pn("input"),_e=_r(),Ze=Pn("div"),nt=Pn("h4"),nt.textContent=Ke,st=_r(),ht=Pn("input"),xt=_r(),zt=Pn("div"),Mt=Pn("h4"),Mt.textContent=Ue,$t=_r(),rt=Pn("button"),rt.textContent=gt,At=_r(),yt=Pn("button"),yt.textContent=St,ut=_r(),Ye=Pn("div"),_t=Pn("h4"),_t.textContent=ct,Ut=_r(),Ft=Pn("input"),this.h()},l(Ni){e=Dn(Ni,"DIV",{class:!0});var tn=rn(e);n=Dn(tn,"DIV",{class:!0});var Zi=rn(n);c=Dn(Zi,"H4",{class:!0,"data-svelte-h":!0}),$u(c)!=="svelte-16skbun"&&(c.textContent=g),v=yr(Zi),S=Dn(Zi,"SELECT",{label:!0});var Gi=rn(S);for(let Oi=0;Oi<ki.length;Oi+=1)ki[Oi].l(Gi);Gi.forEach(Ai),Zi.forEach(Ai),a=yr(tn),N=Dn(tn,"DIV",{class:!0});var sn=rn(N);$=Dn(sn,"H4",{class:!0,"data-svelte-h":!0}),$u($)!=="svelte-tf6nwt"&&($.textContent=he),oe=yr(sn),ce=Dn(sn,"INPUT",{type:!0}),sn.forEach(Ai),_e=yr(tn),Ze=Dn(tn,"DIV",{class:!0});var xn=rn(Ze);nt=Dn(xn,"H4",{class:!0,"data-svelte-h":!0}),$u(nt)!=="svelte-1f8vskc"&&(nt.textContent=Ke),st=yr(xn),ht=Dn(xn,"INPUT",{type:!0}),xn.forEach(Ai),xt=yr(tn),zt=Dn(tn,"DIV",{class:!0});var Ti=rn(zt);Mt=Dn(Ti,"H4",{class:!0,"data-svelte-h":!0}),$u(Mt)!=="svelte-hi5xw8"&&(Mt.textContent=Ue),$t=yr(Ti),rt=Dn(Ti,"BUTTON",{"data-svelte-h":!0}),$u(rt)!=="svelte-o8r62u"&&(rt.textContent=gt),At=yr(Ti),yt=Dn(Ti,"BUTTON",{"data-svelte-h":!0}),$u(yt)!=="svelte-2y01av"&&(yt.textContent=St),Ti.forEach(Ai),ut=yr(tn),Ye=Dn(tn,"DIV",{class:!0});var gi=rn(Ye);_t=Dn(gi,"H4",{class:!0,"data-svelte-h":!0}),$u(_t)!=="svelte-1fb1xwq"&&(_t.textContent=ct),Ut=yr(gi),Ft=Dn(gi,"INPUT",{type:!0,min:!0,max:!0}),gi.forEach(Ai),tn.forEach(Ai),this.h()},h(){_i(c,"class","svelte-11w56ip"),_i(S,"label","Color Scheme"),t[5]===void 0&&yE(()=>t[11].call(S)),_i(n,"class","control-item svelte-11w56ip"),_i($,"class","svelte-11w56ip"),_i(ce,"type","checkbox"),_i(N,"class","control-item svelte-11w56ip"),_i(nt,"class","svelte-11w56ip"),_i(ht,"type","checkbox"),_i(Ze,"class","control-item svelte-11w56ip"),_i(Mt,"class","svelte-11w56ip"),_i(zt,"class","control-item svelte-11w56ip"),_i(_t,"class","svelte-11w56ip"),_i(Ft,"type","range"),_i(Ft,"min","0"),_i(Ft,"max","100"),Ft.value=t[8]*100,_i(Ye,"class","control-item svelte-11w56ip"),_i(e,"class","controls svelte-11w56ip")},m(Ni,tn){yn(Ni,e,tn),Bi(e,n),Bi(n,c),Bi(n,v),Bi(n,S);for(let Zi=0;Zi<ki.length;Zi+=1)ki[Zi]&&ki[Zi].m(S,null);j2(S,t[5],!0),Bi(e,a),Bi(e,N),Bi(N,$),Bi(N,oe),Bi(N,ce),ce.checked=t[6],Bi(e,_e),Bi(e,Ze),Bi(Ze,nt),Bi(Ze,st),Bi(Ze,ht),ht.checked=t[7],Bi(e,xt),Bi(e,zt),Bi(zt,Mt),Bi(zt,$t),Bi(zt,rt),Bi(zt,At),Bi(zt,yt),Bi(e,ut),Bi(e,Ye),Bi(Ye,_t),Bi(Ye,Ut),Bi(Ye,Ft),Vt||(yi=[jl(S,"change",t[11]),jl(S,"change",t[12]),jl(ce,"change",t[13]),jl(ce,"change",t[14]),jl(ht,"change",t[15]),jl(ht,"change",t[16]),jl(rt,"click",t[17]),jl(yt,"click",t[18]),jl(Ft,"input",t[19])],Vt=!0)},p(Ni,[tn]){if(tn&512){Ci=gu(Ni[9]);let Zi;for(Zi=0;Zi<Ci.length;Zi+=1){const Gi=wx(Ni,Ci,Zi);ki[Zi]?ki[Zi].p(Gi,tn):(ki[Zi]=Sx(Gi),ki[Zi].c(),ki[Zi].m(S,null))}for(;Zi<ki.length;Zi+=1)ki[Zi].d(1);ki.length=Ci.length}tn&544&&j2(S,Ni[5]),tn&64&&(ce.checked=Ni[6]),tn&128&&(ht.checked=Ni[7])},i:Ra,o:Ra,d(Ni){Ni&&Ai(e),dA(ki,Ni),Vt=!1,Gh(yi)}}}function TT(t,e,n){let c;Il(t,Vy,rt=>n(20,c=rt));let{updateColorScheme:g}=e,{updateShowCounties:v}=e,{updateShowEcoregions:S}=e,{updateDrawing:a}=e,{updateDrawnPath:N}=e,{isDrawing:$}=e,he,oe,ce,_e=c;const Ze=Object.keys(Fv);wc(()=>{g(he)});function nt(){he=bE(this),n(5,he),n(9,Ze)}const Ke=()=>g(he);function st(){oe=this.checked,n(6,oe)}const ht=()=>v(oe);function xt(){ce=this.checked,n(7,ce)}const zt=()=>S(ce),Mt=()=>a(!0),Ue=()=>N(null),$t=rt=>Vy.set(Number.parseInt(rt.target.value)/100);return t.$$set=rt=>{"updateColorScheme"in rt&&n(0,g=rt.updateColorScheme),"updateShowCounties"in rt&&n(1,v=rt.updateShowCounties),"updateShowEcoregions"in rt&&n(2,S=rt.updateShowEcoregions),"updateDrawing"in rt&&n(3,a=rt.updateDrawing),"updateDrawnPath"in rt&&n(4,N=rt.updateDrawnPath),"isDrawing"in rt&&n(10,$=rt.isDrawing)},[g,v,S,a,N,he,oe,ce,_e,Ze,$,nt,Ke,st,ht,xt,zt,Mt,Ue,$t]}class kT extends Ha{constructor(e){super(),ja(this,e,TT,CT,Ca,{updateColorScheme:0,updateShowCounties:1,updateShowEcoregions:2,updateDrawing:3,updateDrawnPath:4,isDrawing:10})}}function MT(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var P3={exports:{}};const PT={},DT=Object.freeze(Object.defineProperty({__proto__:null,default:PT},Symbol.toStringTag,{value:"Module"})),Ix=Ov(DT);var Wg={exports:{}},Ex;function LT(){return Ex||(Ex=1,function(t,e){(function(n,c){c(e)})(s0,function(n){var c=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],g=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],v="-----------------------------------------------------------------------------------------------------------------------------------------------------",S="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},N="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",$={5:N,"5module":N+" export import",6:N+" const class extends export import super"},he=/^in(stanceof)?$/,oe=new RegExp("["+S+"]"),ce=new RegExp("["+S+v+"]");function _e(G,we){for(var at=65536,Ct=0;Ct<we.length;Ct+=2){if(at+=we[Ct],at>G)return!1;if(at+=we[Ct+1],at>=G)return!0}return!1}function Ze(G,we){return G<65?G===36:G<91?!0:G<97?G===95:G<123?!0:G<=65535?G>=170&&oe.test(String.fromCharCode(G)):we===!1?!1:_e(G,g)}function nt(G,we){return G<48?G===36:G<58?!0:G<65?!1:G<91?!0:G<97?G===95:G<123?!0:G<=65535?G>=170&&ce.test(String.fromCharCode(G)):we===!1?!1:_e(G,g)||_e(G,c)}var Ke=function(we,at){at===void 0&&(at={}),this.label=we,this.keyword=at.keyword,this.beforeExpr=!!at.beforeExpr,this.startsExpr=!!at.startsExpr,this.isLoop=!!at.isLoop,this.isAssign=!!at.isAssign,this.prefix=!!at.prefix,this.postfix=!!at.postfix,this.binop=at.binop||null,this.updateContext=null};function st(G,we){return new Ke(G,{beforeExpr:!0,binop:we})}var ht={beforeExpr:!0},xt={startsExpr:!0},zt={};function Mt(G,we){return we===void 0&&(we={}),we.keyword=G,zt[G]=new Ke(G,we)}var Ue={num:new Ke("num",xt),regexp:new Ke("regexp",xt),string:new Ke("string",xt),name:new Ke("name",xt),privateId:new Ke("privateId",xt),eof:new Ke("eof"),bracketL:new Ke("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Ke("]"),braceL:new Ke("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Ke("}"),parenL:new Ke("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Ke(")"),comma:new Ke(",",ht),semi:new Ke(";",ht),colon:new Ke(":",ht),dot:new Ke("."),question:new Ke("?",ht),questionDot:new Ke("?."),arrow:new Ke("=>",ht),template:new Ke("template"),invalidTemplate:new Ke("invalidTemplate"),ellipsis:new Ke("...",ht),backQuote:new Ke("`",xt),dollarBraceL:new Ke("${",{beforeExpr:!0,startsExpr:!0}),eq:new Ke("=",{beforeExpr:!0,isAssign:!0}),assign:new Ke("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Ke("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Ke("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:st("||",1),logicalAND:st("&&",2),bitwiseOR:st("|",3),bitwiseXOR:st("^",4),bitwiseAND:st("&",5),equality:st("==/!=/===/!==",6),relational:st("</>/<=/>=",7),bitShift:st("<</>>/>>>",8),plusMin:new Ke("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:st("%",10),star:st("*",10),slash:st("/",10),starstar:new Ke("**",{beforeExpr:!0}),coalesce:st("??",1),_break:Mt("break"),_case:Mt("case",ht),_catch:Mt("catch"),_continue:Mt("continue"),_debugger:Mt("debugger"),_default:Mt("default",ht),_do:Mt("do",{isLoop:!0,beforeExpr:!0}),_else:Mt("else",ht),_finally:Mt("finally"),_for:Mt("for",{isLoop:!0}),_function:Mt("function",xt),_if:Mt("if"),_return:Mt("return",ht),_switch:Mt("switch"),_throw:Mt("throw",ht),_try:Mt("try"),_var:Mt("var"),_const:Mt("const"),_while:Mt("while",{isLoop:!0}),_with:Mt("with"),_new:Mt("new",{beforeExpr:!0,startsExpr:!0}),_this:Mt("this",xt),_super:Mt("super",xt),_class:Mt("class",xt),_extends:Mt("extends",ht),_export:Mt("export"),_import:Mt("import",xt),_null:Mt("null",xt),_true:Mt("true",xt),_false:Mt("false",xt),_in:Mt("in",{beforeExpr:!0,binop:7}),_instanceof:Mt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Mt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Mt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Mt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},$t=/\r\n?|\n|\u2028|\u2029/,rt=new RegExp($t.source,"g");function gt(G){return G===10||G===13||G===8232||G===8233}function At(G,we,at){at===void 0&&(at=G.length);for(var Ct=we;Ct<at;Ct++){var Yt=G.charCodeAt(Ct);if(gt(Yt))return Ct<at-1&&Yt===13&&G.charCodeAt(Ct+1)===10?Ct+2:Ct+1}return-1}var yt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,St=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ut=Object.prototype,Ye=ut.hasOwnProperty,_t=ut.toString,ct=Object.hasOwn||function(G,we){return Ye.call(G,we)},Ut=Array.isArray||function(G){return _t.call(G)==="[object Array]"},Ft=Object.create(null);function Vt(G){return Ft[G]||(Ft[G]=new RegExp("^(?:"+G.replace(/ /g,"|")+")$"))}function yi(G){return G<=65535?String.fromCharCode(G):(G-=65536,String.fromCharCode((G>>10)+55296,(G&1023)+56320))}var Ci=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,ki=function(we,at){this.line=we,this.column=at};ki.prototype.offset=function(we){return new ki(this.line,this.column+we)};var Ni=function(we,at,Ct){this.start=at,this.end=Ct,we.sourceFile!==null&&(this.source=we.sourceFile)};function tn(G,we){for(var at=1,Ct=0;;){var Yt=At(G,Ct,we);if(Yt<0)return new ki(at,we-Ct);++at,Ct=Yt}}var Zi={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Gi=!1;function sn(G){var we={};for(var at in Zi)we[at]=G&&ct(G,at)?G[at]:Zi[at];if(we.ecmaVersion==="latest"?we.ecmaVersion=1e8:we.ecmaVersion==null?(!Gi&&typeof console=="object"&&console.warn&&(Gi=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),we.ecmaVersion=11):we.ecmaVersion>=2015&&(we.ecmaVersion-=2009),we.allowReserved==null&&(we.allowReserved=we.ecmaVersion<5),(!G||G.allowHashBang==null)&&(we.allowHashBang=we.ecmaVersion>=14),Ut(we.onToken)){var Ct=we.onToken;we.onToken=function(Yt){return Ct.push(Yt)}}return Ut(we.onComment)&&(we.onComment=xn(we,we.onComment)),we}function xn(G,we){return function(at,Ct,Yt,Ii,Li,An){var pn={type:at?"Block":"Line",value:Ct,start:Yt,end:Ii};G.locations&&(pn.loc=new Ni(this,Li,An)),G.ranges&&(pn.range=[Yt,Ii]),we.push(pn)}}var Ti=1,gi=2,Oi=4,Vi=8,bn=16,wn=32,xi=64,Bn=128,Ot=256,an=Ti|gi|Ot;function $n(G,we){return gi|(G?Oi:0)|(we?Vi:0)}var oi=0,Yi=1,Xn=2,zn=3,Wn=4,_n=5,b=function(we,at,Ct){this.options=we=sn(we),this.sourceFile=we.sourceFile,this.keywords=Vt($[we.ecmaVersion>=6?6:we.sourceType==="module"?"5module":5]);var Yt="";we.allowReserved!==!0&&(Yt=a[we.ecmaVersion>=6?6:we.ecmaVersion===5?5:3],we.sourceType==="module"&&(Yt+=" await")),this.reservedWords=Vt(Yt);var Ii=(Yt?Yt+" ":"")+a.strict;this.reservedWordsStrict=Vt(Ii),this.reservedWordsStrictBind=Vt(Ii+" "+a.strictBind),this.input=String(at),this.containsEsc=!1,Ct?(this.pos=Ct,this.lineStart=this.input.lastIndexOf(`
`,Ct-1)+1,this.curLine=this.input.slice(0,this.lineStart).split($t).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Ue.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=we.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&we.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Ti),this.regexpState=null,this.privateNameStack=[]},M={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};b.prototype.parse=function(){var we=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(we)},M.inFunction.get=function(){return(this.currentVarScope().flags&gi)>0},M.inGenerator.get=function(){return(this.currentVarScope().flags&Vi)>0&&!this.currentVarScope().inClassFieldInit},M.inAsync.get=function(){return(this.currentVarScope().flags&Oi)>0&&!this.currentVarScope().inClassFieldInit},M.canAwait.get=function(){for(var G=this.scopeStack.length-1;G>=0;G--){var we=this.scopeStack[G];if(we.inClassFieldInit||we.flags&Ot)return!1;if(we.flags&gi)return(we.flags&Oi)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},M.allowSuper.get=function(){var G=this.currentThisScope(),we=G.flags,at=G.inClassFieldInit;return(we&xi)>0||at||this.options.allowSuperOutsideMethod},M.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Bn)>0},M.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},M.allowNewDotTarget.get=function(){var G=this.currentThisScope(),we=G.flags,at=G.inClassFieldInit;return(we&(gi|Ot))>0||at},M.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Ot)>0},b.extend=function(){for(var we=[],at=arguments.length;at--;)we[at]=arguments[at];for(var Ct=this,Yt=0;Yt<we.length;Yt++)Ct=we[Yt](Ct);return Ct},b.parse=function(we,at){return new this(at,we).parse()},b.parseExpressionAt=function(we,at,Ct){var Yt=new this(Ct,we,at);return Yt.nextToken(),Yt.parseExpression()},b.tokenizer=function(we,at){return new this(at,we)},Object.defineProperties(b.prototype,M);var U=b.prototype,K=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;U.strictDirective=function(G){if(this.options.ecmaVersion<5)return!1;for(;;){St.lastIndex=G,G+=St.exec(this.input)[0].length;var we=K.exec(this.input.slice(G));if(!we)return!1;if((we[1]||we[2])==="use strict"){St.lastIndex=G+we[0].length;var at=St.exec(this.input),Ct=at.index+at[0].length,Yt=this.input.charAt(Ct);return Yt===";"||Yt==="}"||$t.test(at[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(Yt)||Yt==="!"&&this.input.charAt(Ct+1)==="=")}G+=we[0].length,St.lastIndex=G,G+=St.exec(this.input)[0].length,this.input[G]===";"&&G++}},U.eat=function(G){return this.type===G?(this.next(),!0):!1},U.isContextual=function(G){return this.type===Ue.name&&this.value===G&&!this.containsEsc},U.eatContextual=function(G){return this.isContextual(G)?(this.next(),!0):!1},U.expectContextual=function(G){this.eatContextual(G)||this.unexpected()},U.canInsertSemicolon=function(){return this.type===Ue.eof||this.type===Ue.braceR||$t.test(this.input.slice(this.lastTokEnd,this.start))},U.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},U.semicolon=function(){!this.eat(Ue.semi)&&!this.insertSemicolon()&&this.unexpected()},U.afterTrailingComma=function(G,we){if(this.type===G)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),we||this.next(),!0},U.expect=function(G){this.eat(G)||this.unexpected()},U.unexpected=function(G){this.raise(G??this.start,"Unexpected token")};var ie=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};U.checkPatternErrors=function(G,we){if(G){G.trailingComma>-1&&this.raiseRecoverable(G.trailingComma,"Comma is not permitted after the rest element");var at=we?G.parenthesizedAssign:G.parenthesizedBind;at>-1&&this.raiseRecoverable(at,we?"Assigning to rvalue":"Parenthesized pattern")}},U.checkExpressionErrors=function(G,we){if(!G)return!1;var at=G.shorthandAssign,Ct=G.doubleProto;if(!we)return at>=0||Ct>=0;at>=0&&this.raise(at,"Shorthand property assignments are valid only in destructuring patterns"),Ct>=0&&this.raiseRecoverable(Ct,"Redefinition of __proto__ property")},U.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},U.isSimpleAssignTarget=function(G){return G.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(G.expression):G.type==="Identifier"||G.type==="MemberExpression"};var de=b.prototype;de.parseTopLevel=function(G){var we=Object.create(null);for(G.body||(G.body=[]);this.type!==Ue.eof;){var at=this.parseStatement(null,!0,we);G.body.push(at)}if(this.inModule)for(var Ct=0,Yt=Object.keys(this.undefinedExports);Ct<Yt.length;Ct+=1){var Ii=Yt[Ct];this.raiseRecoverable(this.undefinedExports[Ii].start,"Export '"+Ii+"' is not defined")}return this.adaptDirectivePrologue(G.body),this.next(),G.sourceType=this.options.sourceType,this.finishNode(G,"Program")};var be={kind:"loop"},Ee={kind:"switch"};de.isLet=function(G){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;St.lastIndex=this.pos;var we=St.exec(this.input),at=this.pos+we[0].length,Ct=this.input.charCodeAt(at);if(Ct===91||Ct===92)return!0;if(G)return!1;if(Ct===123||Ct>55295&&Ct<56320)return!0;if(Ze(Ct,!0)){for(var Yt=at+1;nt(Ct=this.input.charCodeAt(Yt),!0);)++Yt;if(Ct===92||Ct>55295&&Ct<56320)return!0;var Ii=this.input.slice(at,Yt);if(!he.test(Ii))return!0}return!1},de.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;St.lastIndex=this.pos;var G=St.exec(this.input),we=this.pos+G[0].length,at;return!$t.test(this.input.slice(this.pos,we))&&this.input.slice(we,we+8)==="function"&&(we+8===this.input.length||!(nt(at=this.input.charCodeAt(we+8))||at>55295&&at<56320))},de.parseStatement=function(G,we,at){var Ct=this.type,Yt=this.startNode(),Ii;switch(this.isLet(G)&&(Ct=Ue._var,Ii="let"),Ct){case Ue._break:case Ue._continue:return this.parseBreakContinueStatement(Yt,Ct.keyword);case Ue._debugger:return this.parseDebuggerStatement(Yt);case Ue._do:return this.parseDoStatement(Yt);case Ue._for:return this.parseForStatement(Yt);case Ue._function:return G&&(this.strict||G!=="if"&&G!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(Yt,!1,!G);case Ue._class:return G&&this.unexpected(),this.parseClass(Yt,!0);case Ue._if:return this.parseIfStatement(Yt);case Ue._return:return this.parseReturnStatement(Yt);case Ue._switch:return this.parseSwitchStatement(Yt);case Ue._throw:return this.parseThrowStatement(Yt);case Ue._try:return this.parseTryStatement(Yt);case Ue._const:case Ue._var:return Ii=Ii||this.value,G&&Ii!=="var"&&this.unexpected(),this.parseVarStatement(Yt,Ii);case Ue._while:return this.parseWhileStatement(Yt);case Ue._with:return this.parseWithStatement(Yt);case Ue.braceL:return this.parseBlock(!0,Yt);case Ue.semi:return this.parseEmptyStatement(Yt);case Ue._export:case Ue._import:if(this.options.ecmaVersion>10&&Ct===Ue._import){St.lastIndex=this.pos;var Li=St.exec(this.input),An=this.pos+Li[0].length,pn=this.input.charCodeAt(An);if(pn===40||pn===46)return this.parseExpressionStatement(Yt,this.parseExpression())}return this.options.allowImportExportEverywhere||(we||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),Ct===Ue._import?this.parseImport(Yt):this.parseExport(Yt,at);default:if(this.isAsyncFunction())return G&&this.unexpected(),this.next(),this.parseFunctionStatement(Yt,!0,!G);var or=this.value,dr=this.parseExpression();return Ct===Ue.name&&dr.type==="Identifier"&&this.eat(Ue.colon)?this.parseLabeledStatement(Yt,or,dr,G):this.parseExpressionStatement(Yt,dr)}},de.parseBreakContinueStatement=function(G,we){var at=we==="break";this.next(),this.eat(Ue.semi)||this.insertSemicolon()?G.label=null:this.type!==Ue.name?this.unexpected():(G.label=this.parseIdent(),this.semicolon());for(var Ct=0;Ct<this.labels.length;++Ct){var Yt=this.labels[Ct];if((G.label==null||Yt.name===G.label.name)&&(Yt.kind!=null&&(at||Yt.kind==="loop")||G.label&&at))break}return Ct===this.labels.length&&this.raise(G.start,"Unsyntactic "+we),this.finishNode(G,at?"BreakStatement":"ContinueStatement")},de.parseDebuggerStatement=function(G){return this.next(),this.semicolon(),this.finishNode(G,"DebuggerStatement")},de.parseDoStatement=function(G){return this.next(),this.labels.push(be),G.body=this.parseStatement("do"),this.labels.pop(),this.expect(Ue._while),G.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Ue.semi):this.semicolon(),this.finishNode(G,"DoWhileStatement")},de.parseForStatement=function(G){this.next();var we=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(be),this.enterScope(0),this.expect(Ue.parenL),this.type===Ue.semi)return we>-1&&this.unexpected(we),this.parseFor(G,null);var at=this.isLet();if(this.type===Ue._var||this.type===Ue._const||at){var Ct=this.startNode(),Yt=at?"let":this.value;return this.next(),this.parseVar(Ct,!0,Yt),this.finishNode(Ct,"VariableDeclaration"),(this.type===Ue._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&Ct.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===Ue._in?we>-1&&this.unexpected(we):G.await=we>-1),this.parseForIn(G,Ct)):(we>-1&&this.unexpected(we),this.parseFor(G,Ct))}var Ii=this.isContextual("let"),Li=!1,An=new ie,pn=this.parseExpression(we>-1?"await":!0,An);return this.type===Ue._in||(Li=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===Ue._in?we>-1&&this.unexpected(we):G.await=we>-1),Ii&&Li&&this.raise(pn.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(pn,!1,An),this.checkLValPattern(pn),this.parseForIn(G,pn)):(this.checkExpressionErrors(An,!0),we>-1&&this.unexpected(we),this.parseFor(G,pn))},de.parseFunctionStatement=function(G,we,at){return this.next(),this.parseFunction(G,Re|(at?0:$e),!1,we)},de.parseIfStatement=function(G){return this.next(),G.test=this.parseParenExpression(),G.consequent=this.parseStatement("if"),G.alternate=this.eat(Ue._else)?this.parseStatement("if"):null,this.finishNode(G,"IfStatement")},de.parseReturnStatement=function(G){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Ue.semi)||this.insertSemicolon()?G.argument=null:(G.argument=this.parseExpression(),this.semicolon()),this.finishNode(G,"ReturnStatement")},de.parseSwitchStatement=function(G){this.next(),G.discriminant=this.parseParenExpression(),G.cases=[],this.expect(Ue.braceL),this.labels.push(Ee),this.enterScope(0);for(var we,at=!1;this.type!==Ue.braceR;)if(this.type===Ue._case||this.type===Ue._default){var Ct=this.type===Ue._case;we&&this.finishNode(we,"SwitchCase"),G.cases.push(we=this.startNode()),we.consequent=[],this.next(),Ct?we.test=this.parseExpression():(at&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),at=!0,we.test=null),this.expect(Ue.colon)}else we||this.unexpected(),we.consequent.push(this.parseStatement(null));return this.exitScope(),we&&this.finishNode(we,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(G,"SwitchStatement")},de.parseThrowStatement=function(G){return this.next(),$t.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),G.argument=this.parseExpression(),this.semicolon(),this.finishNode(G,"ThrowStatement")};var Ce=[];de.parseCatchClauseParam=function(){var G=this.parseBindingAtom(),we=G.type==="Identifier";return this.enterScope(we?wn:0),this.checkLValPattern(G,we?Wn:Xn),this.expect(Ue.parenR),G},de.parseTryStatement=function(G){if(this.next(),G.block=this.parseBlock(),G.handler=null,this.type===Ue._catch){var we=this.startNode();this.next(),this.eat(Ue.parenL)?we.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),we.param=null,this.enterScope(0)),we.body=this.parseBlock(!1),this.exitScope(),G.handler=this.finishNode(we,"CatchClause")}return G.finalizer=this.eat(Ue._finally)?this.parseBlock():null,!G.handler&&!G.finalizer&&this.raise(G.start,"Missing catch or finally clause"),this.finishNode(G,"TryStatement")},de.parseVarStatement=function(G,we,at){return this.next(),this.parseVar(G,!1,we,at),this.semicolon(),this.finishNode(G,"VariableDeclaration")},de.parseWhileStatement=function(G){return this.next(),G.test=this.parseParenExpression(),this.labels.push(be),G.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(G,"WhileStatement")},de.parseWithStatement=function(G){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),G.object=this.parseParenExpression(),G.body=this.parseStatement("with"),this.finishNode(G,"WithStatement")},de.parseEmptyStatement=function(G){return this.next(),this.finishNode(G,"EmptyStatement")},de.parseLabeledStatement=function(G,we,at,Ct){for(var Yt=0,Ii=this.labels;Yt<Ii.length;Yt+=1){var Li=Ii[Yt];Li.name===we&&this.raise(at.start,"Label '"+we+"' is already declared")}for(var An=this.type.isLoop?"loop":this.type===Ue._switch?"switch":null,pn=this.labels.length-1;pn>=0;pn--){var or=this.labels[pn];if(or.statementStart===G.start)or.statementStart=this.start,or.kind=An;else break}return this.labels.push({name:we,kind:An,statementStart:this.start}),G.body=this.parseStatement(Ct?Ct.indexOf("label")===-1?Ct+"label":Ct:"label"),this.labels.pop(),G.label=at,this.finishNode(G,"LabeledStatement")},de.parseExpressionStatement=function(G,we){return G.expression=we,this.semicolon(),this.finishNode(G,"ExpressionStatement")},de.parseBlock=function(G,we,at){for(G===void 0&&(G=!0),we===void 0&&(we=this.startNode()),we.body=[],this.expect(Ue.braceL),G&&this.enterScope(0);this.type!==Ue.braceR;){var Ct=this.parseStatement(null);we.body.push(Ct)}return at&&(this.strict=!1),this.next(),G&&this.exitScope(),this.finishNode(we,"BlockStatement")},de.parseFor=function(G,we){return G.init=we,this.expect(Ue.semi),G.test=this.type===Ue.semi?null:this.parseExpression(),this.expect(Ue.semi),G.update=this.type===Ue.parenR?null:this.parseExpression(),this.expect(Ue.parenR),G.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(G,"ForStatement")},de.parseForIn=function(G,we){var at=this.type===Ue._in;return this.next(),we.type==="VariableDeclaration"&&we.declarations[0].init!=null&&(!at||this.options.ecmaVersion<8||this.strict||we.kind!=="var"||we.declarations[0].id.type!=="Identifier")&&this.raise(we.start,(at?"for-in":"for-of")+" loop variable declaration may not have an initializer"),G.left=we,G.right=at?this.parseExpression():this.parseMaybeAssign(),this.expect(Ue.parenR),G.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(G,at?"ForInStatement":"ForOfStatement")},de.parseVar=function(G,we,at,Ct){for(G.declarations=[],G.kind=at;;){var Yt=this.startNode();if(this.parseVarId(Yt,at),this.eat(Ue.eq)?Yt.init=this.parseMaybeAssign(we):!Ct&&at==="const"&&!(this.type===Ue._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!Ct&&Yt.id.type!=="Identifier"&&!(we&&(this.type===Ue._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):Yt.init=null,G.declarations.push(this.finishNode(Yt,"VariableDeclarator")),!this.eat(Ue.comma))break}return G},de.parseVarId=function(G,we){G.id=this.parseBindingAtom(),this.checkLValPattern(G.id,we==="var"?Yi:Xn,!1)};var Re=1,$e=2,je=4;de.parseFunction=function(G,we,at,Ct,Yt){this.initFunction(G),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!Ct)&&(this.type===Ue.star&&we&$e&&this.unexpected(),G.generator=this.eat(Ue.star)),this.options.ecmaVersion>=8&&(G.async=!!Ct),we&Re&&(G.id=we&je&&this.type!==Ue.name?null:this.parseIdent(),G.id&&!(we&$e)&&this.checkLValSimple(G.id,this.strict||G.generator||G.async?this.treatFunctionsAsVar?Yi:Xn:zn));var Ii=this.yieldPos,Li=this.awaitPos,An=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope($n(G.async,G.generator)),we&Re||(G.id=this.type===Ue.name?this.parseIdent():null),this.parseFunctionParams(G),this.parseFunctionBody(G,at,!1,Yt),this.yieldPos=Ii,this.awaitPos=Li,this.awaitIdentPos=An,this.finishNode(G,we&Re?"FunctionDeclaration":"FunctionExpression")},de.parseFunctionParams=function(G){this.expect(Ue.parenL),G.params=this.parseBindingList(Ue.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},de.parseClass=function(G,we){this.next();var at=this.strict;this.strict=!0,this.parseClassId(G,we),this.parseClassSuper(G);var Ct=this.enterClassBody(),Yt=this.startNode(),Ii=!1;for(Yt.body=[],this.expect(Ue.braceL);this.type!==Ue.braceR;){var Li=this.parseClassElement(G.superClass!==null);Li&&(Yt.body.push(Li),Li.type==="MethodDefinition"&&Li.kind==="constructor"?(Ii&&this.raiseRecoverable(Li.start,"Duplicate constructor in the same class"),Ii=!0):Li.key&&Li.key.type==="PrivateIdentifier"&&We(Ct,Li)&&this.raiseRecoverable(Li.key.start,"Identifier '#"+Li.key.name+"' has already been declared"))}return this.strict=at,this.next(),G.body=this.finishNode(Yt,"ClassBody"),this.exitClassBody(),this.finishNode(G,we?"ClassDeclaration":"ClassExpression")},de.parseClassElement=function(G){if(this.eat(Ue.semi))return null;var we=this.options.ecmaVersion,at=this.startNode(),Ct="",Yt=!1,Ii=!1,Li="method",An=!1;if(this.eatContextual("static")){if(we>=13&&this.eat(Ue.braceL))return this.parseClassStaticBlock(at),at;this.isClassElementNameStart()||this.type===Ue.star?An=!0:Ct="static"}if(at.static=An,!Ct&&we>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===Ue.star)&&!this.canInsertSemicolon()?Ii=!0:Ct="async"),!Ct&&(we>=9||!Ii)&&this.eat(Ue.star)&&(Yt=!0),!Ct&&!Ii&&!Yt){var pn=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Li=pn:Ct=pn)}if(Ct?(at.computed=!1,at.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),at.key.name=Ct,this.finishNode(at.key,"Identifier")):this.parseClassElementName(at),we<13||this.type===Ue.parenL||Li!=="method"||Yt||Ii){var or=!at.static&&Ge(at,"constructor"),dr=or&&G;or&&Li!=="method"&&this.raise(at.key.start,"Constructor can't have get/set modifier"),at.kind=or?"constructor":Li,this.parseClassMethod(at,Yt,Ii,dr)}else this.parseClassField(at);return at},de.isClassElementNameStart=function(){return this.type===Ue.name||this.type===Ue.privateId||this.type===Ue.num||this.type===Ue.string||this.type===Ue.bracketL||this.type.keyword},de.parseClassElementName=function(G){this.type===Ue.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),G.computed=!1,G.key=this.parsePrivateIdent()):this.parsePropertyName(G)},de.parseClassMethod=function(G,we,at,Ct){var Yt=G.key;G.kind==="constructor"?(we&&this.raise(Yt.start,"Constructor can't be a generator"),at&&this.raise(Yt.start,"Constructor can't be an async method")):G.static&&Ge(G,"prototype")&&this.raise(Yt.start,"Classes may not have a static property named prototype");var Ii=G.value=this.parseMethod(we,at,Ct);return G.kind==="get"&&Ii.params.length!==0&&this.raiseRecoverable(Ii.start,"getter should have no params"),G.kind==="set"&&Ii.params.length!==1&&this.raiseRecoverable(Ii.start,"setter should have exactly one param"),G.kind==="set"&&Ii.params[0].type==="RestElement"&&this.raiseRecoverable(Ii.params[0].start,"Setter cannot use rest params"),this.finishNode(G,"MethodDefinition")},de.parseClassField=function(G){if(Ge(G,"constructor")?this.raise(G.key.start,"Classes can't have a field named 'constructor'"):G.static&&Ge(G,"prototype")&&this.raise(G.key.start,"Classes can't have a static field named 'prototype'"),this.eat(Ue.eq)){var we=this.currentThisScope(),at=we.inClassFieldInit;we.inClassFieldInit=!0,G.value=this.parseMaybeAssign(),we.inClassFieldInit=at}else G.value=null;return this.semicolon(),this.finishNode(G,"PropertyDefinition")},de.parseClassStaticBlock=function(G){G.body=[];var we=this.labels;for(this.labels=[],this.enterScope(Ot|xi);this.type!==Ue.braceR;){var at=this.parseStatement(null);G.body.push(at)}return this.next(),this.exitScope(),this.labels=we,this.finishNode(G,"StaticBlock")},de.parseClassId=function(G,we){this.type===Ue.name?(G.id=this.parseIdent(),we&&this.checkLValSimple(G.id,Xn,!1)):(we===!0&&this.unexpected(),G.id=null)},de.parseClassSuper=function(G){G.superClass=this.eat(Ue._extends)?this.parseExprSubscripts(null,!1):null},de.enterClassBody=function(){var G={declared:Object.create(null),used:[]};return this.privateNameStack.push(G),G.declared},de.exitClassBody=function(){var G=this.privateNameStack.pop(),we=G.declared,at=G.used;if(this.options.checkPrivateFields)for(var Ct=this.privateNameStack.length,Yt=Ct===0?null:this.privateNameStack[Ct-1],Ii=0;Ii<at.length;++Ii){var Li=at[Ii];ct(we,Li.name)||(Yt?Yt.used.push(Li):this.raiseRecoverable(Li.start,"Private field '#"+Li.name+"' must be declared in an enclosing class"))}};function We(G,we){var at=we.key.name,Ct=G[at],Yt="true";return we.type==="MethodDefinition"&&(we.kind==="get"||we.kind==="set")&&(Yt=(we.static?"s":"i")+we.kind),Ct==="iget"&&Yt==="iset"||Ct==="iset"&&Yt==="iget"||Ct==="sget"&&Yt==="sset"||Ct==="sset"&&Yt==="sget"?(G[at]="true",!1):Ct?!0:(G[at]=Yt,!1)}function Ge(G,we){var at=G.computed,Ct=G.key;return!at&&(Ct.type==="Identifier"&&Ct.name===we||Ct.type==="Literal"&&Ct.value===we)}de.parseExportAllDeclaration=function(G,we){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(G.exported=this.parseModuleExportName(),this.checkExport(we,G.exported,this.lastTokStart)):G.exported=null),this.expectContextual("from"),this.type!==Ue.string&&this.unexpected(),G.source=this.parseExprAtom(),this.semicolon(),this.finishNode(G,"ExportAllDeclaration")},de.parseExport=function(G,we){if(this.next(),this.eat(Ue.star))return this.parseExportAllDeclaration(G,we);if(this.eat(Ue._default))return this.checkExport(we,"default",this.lastTokStart),G.declaration=this.parseExportDefaultDeclaration(),this.finishNode(G,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())G.declaration=this.parseExportDeclaration(G),G.declaration.type==="VariableDeclaration"?this.checkVariableExport(we,G.declaration.declarations):this.checkExport(we,G.declaration.id,G.declaration.id.start),G.specifiers=[],G.source=null;else{if(G.declaration=null,G.specifiers=this.parseExportSpecifiers(we),this.eatContextual("from"))this.type!==Ue.string&&this.unexpected(),G.source=this.parseExprAtom();else{for(var at=0,Ct=G.specifiers;at<Ct.length;at+=1){var Yt=Ct[at];this.checkUnreserved(Yt.local),this.checkLocalExport(Yt.local),Yt.local.type==="Literal"&&this.raise(Yt.local.start,"A string literal cannot be used as an exported binding without `from`.")}G.source=null}this.semicolon()}return this.finishNode(G,"ExportNamedDeclaration")},de.parseExportDeclaration=function(G){return this.parseStatement(null)},de.parseExportDefaultDeclaration=function(){var G;if(this.type===Ue._function||(G=this.isAsyncFunction())){var we=this.startNode();return this.next(),G&&this.next(),this.parseFunction(we,Re|je,!1,G)}else if(this.type===Ue._class){var at=this.startNode();return this.parseClass(at,"nullableID")}else{var Ct=this.parseMaybeAssign();return this.semicolon(),Ct}},de.checkExport=function(G,we,at){G&&(typeof we!="string"&&(we=we.type==="Identifier"?we.name:we.value),ct(G,we)&&this.raiseRecoverable(at,"Duplicate export '"+we+"'"),G[we]=!0)},de.checkPatternExport=function(G,we){var at=we.type;if(at==="Identifier")this.checkExport(G,we,we.start);else if(at==="ObjectPattern")for(var Ct=0,Yt=we.properties;Ct<Yt.length;Ct+=1){var Ii=Yt[Ct];this.checkPatternExport(G,Ii)}else if(at==="ArrayPattern")for(var Li=0,An=we.elements;Li<An.length;Li+=1){var pn=An[Li];pn&&this.checkPatternExport(G,pn)}else at==="Property"?this.checkPatternExport(G,we.value):at==="AssignmentPattern"?this.checkPatternExport(G,we.left):at==="RestElement"&&this.checkPatternExport(G,we.argument)},de.checkVariableExport=function(G,we){if(G)for(var at=0,Ct=we;at<Ct.length;at+=1){var Yt=Ct[at];this.checkPatternExport(G,Yt.id)}},de.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},de.parseExportSpecifier=function(G){var we=this.startNode();return we.local=this.parseModuleExportName(),we.exported=this.eatContextual("as")?this.parseModuleExportName():we.local,this.checkExport(G,we.exported,we.exported.start),this.finishNode(we,"ExportSpecifier")},de.parseExportSpecifiers=function(G){var we=[],at=!0;for(this.expect(Ue.braceL);!this.eat(Ue.braceR);){if(at)at=!1;else if(this.expect(Ue.comma),this.afterTrailingComma(Ue.braceR))break;we.push(this.parseExportSpecifier(G))}return we},de.parseImport=function(G){return this.next(),this.type===Ue.string?(G.specifiers=Ce,G.source=this.parseExprAtom()):(G.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),G.source=this.type===Ue.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(G,"ImportDeclaration")},de.parseImportSpecifier=function(){var G=this.startNode();return G.imported=this.parseModuleExportName(),this.eatContextual("as")?G.local=this.parseIdent():(this.checkUnreserved(G.imported),G.local=G.imported),this.checkLValSimple(G.local,Xn),this.finishNode(G,"ImportSpecifier")},de.parseImportDefaultSpecifier=function(){var G=this.startNode();return G.local=this.parseIdent(),this.checkLValSimple(G.local,Xn),this.finishNode(G,"ImportDefaultSpecifier")},de.parseImportNamespaceSpecifier=function(){var G=this.startNode();return this.next(),this.expectContextual("as"),G.local=this.parseIdent(),this.checkLValSimple(G.local,Xn),this.finishNode(G,"ImportNamespaceSpecifier")},de.parseImportSpecifiers=function(){var G=[],we=!0;if(this.type===Ue.name&&(G.push(this.parseImportDefaultSpecifier()),!this.eat(Ue.comma)))return G;if(this.type===Ue.star)return G.push(this.parseImportNamespaceSpecifier()),G;for(this.expect(Ue.braceL);!this.eat(Ue.braceR);){if(we)we=!1;else if(this.expect(Ue.comma),this.afterTrailingComma(Ue.braceR))break;G.push(this.parseImportSpecifier())}return G},de.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===Ue.string){var G=this.parseLiteral(this.value);return Ci.test(G.value)&&this.raise(G.start,"An export name cannot include a lone surrogate."),G}return this.parseIdent(!0)},de.adaptDirectivePrologue=function(G){for(var we=0;we<G.length&&this.isDirectiveCandidate(G[we]);++we)G[we].directive=G[we].expression.raw.slice(1,-1)},de.isDirectiveCandidate=function(G){return this.options.ecmaVersion>=5&&G.type==="ExpressionStatement"&&G.expression.type==="Literal"&&typeof G.expression.value=="string"&&(this.input[G.start]==='"'||this.input[G.start]==="'")};var mt=b.prototype;mt.toAssignable=function(G,we,at){if(this.options.ecmaVersion>=6&&G)switch(G.type){case"Identifier":this.inAsync&&G.name==="await"&&this.raise(G.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":G.type="ObjectPattern",at&&this.checkPatternErrors(at,!0);for(var Ct=0,Yt=G.properties;Ct<Yt.length;Ct+=1){var Ii=Yt[Ct];this.toAssignable(Ii,we),Ii.type==="RestElement"&&(Ii.argument.type==="ArrayPattern"||Ii.argument.type==="ObjectPattern")&&this.raise(Ii.argument.start,"Unexpected token")}break;case"Property":G.kind!=="init"&&this.raise(G.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(G.value,we);break;case"ArrayExpression":G.type="ArrayPattern",at&&this.checkPatternErrors(at,!0),this.toAssignableList(G.elements,we);break;case"SpreadElement":G.type="RestElement",this.toAssignable(G.argument,we),G.argument.type==="AssignmentPattern"&&this.raise(G.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":G.operator!=="="&&this.raise(G.left.end,"Only '=' operator can be used for specifying default value."),G.type="AssignmentPattern",delete G.operator,this.toAssignable(G.left,we);break;case"ParenthesizedExpression":this.toAssignable(G.expression,we,at);break;case"ChainExpression":this.raiseRecoverable(G.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!we)break;default:this.raise(G.start,"Assigning to rvalue")}else at&&this.checkPatternErrors(at,!0);return G},mt.toAssignableList=function(G,we){for(var at=G.length,Ct=0;Ct<at;Ct++){var Yt=G[Ct];Yt&&this.toAssignable(Yt,we)}if(at){var Ii=G[at-1];this.options.ecmaVersion===6&&we&&Ii&&Ii.type==="RestElement"&&Ii.argument.type!=="Identifier"&&this.unexpected(Ii.argument.start)}return G},mt.parseSpread=function(G){var we=this.startNode();return this.next(),we.argument=this.parseMaybeAssign(!1,G),this.finishNode(we,"SpreadElement")},mt.parseRestBinding=function(){var G=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==Ue.name&&this.unexpected(),G.argument=this.parseBindingAtom(),this.finishNode(G,"RestElement")},mt.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Ue.bracketL:var G=this.startNode();return this.next(),G.elements=this.parseBindingList(Ue.bracketR,!0,!0),this.finishNode(G,"ArrayPattern");case Ue.braceL:return this.parseObj(!0)}return this.parseIdent()},mt.parseBindingList=function(G,we,at,Ct){for(var Yt=[],Ii=!0;!this.eat(G);)if(Ii?Ii=!1:this.expect(Ue.comma),we&&this.type===Ue.comma)Yt.push(null);else{if(at&&this.afterTrailingComma(G))break;if(this.type===Ue.ellipsis){var Li=this.parseRestBinding();this.parseBindingListItem(Li),Yt.push(Li),this.type===Ue.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(G);break}else Yt.push(this.parseAssignableListItem(Ct))}return Yt},mt.parseAssignableListItem=function(G){var we=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(we),we},mt.parseBindingListItem=function(G){return G},mt.parseMaybeDefault=function(G,we,at){if(at=at||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Ue.eq))return at;var Ct=this.startNodeAt(G,we);return Ct.left=at,Ct.right=this.parseMaybeAssign(),this.finishNode(Ct,"AssignmentPattern")},mt.checkLValSimple=function(G,we,at){we===void 0&&(we=oi);var Ct=we!==oi;switch(G.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(G.name)&&this.raiseRecoverable(G.start,(Ct?"Binding ":"Assigning to ")+G.name+" in strict mode"),Ct&&(we===Xn&&G.name==="let"&&this.raiseRecoverable(G.start,"let is disallowed as a lexically bound name"),at&&(ct(at,G.name)&&this.raiseRecoverable(G.start,"Argument name clash"),at[G.name]=!0),we!==_n&&this.declareName(G.name,we,G.start));break;case"ChainExpression":this.raiseRecoverable(G.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":Ct&&this.raiseRecoverable(G.start,"Binding member expression");break;case"ParenthesizedExpression":return Ct&&this.raiseRecoverable(G.start,"Binding parenthesized expression"),this.checkLValSimple(G.expression,we,at);default:this.raise(G.start,(Ct?"Binding":"Assigning to")+" rvalue")}},mt.checkLValPattern=function(G,we,at){switch(we===void 0&&(we=oi),G.type){case"ObjectPattern":for(var Ct=0,Yt=G.properties;Ct<Yt.length;Ct+=1){var Ii=Yt[Ct];this.checkLValInnerPattern(Ii,we,at)}break;case"ArrayPattern":for(var Li=0,An=G.elements;Li<An.length;Li+=1){var pn=An[Li];pn&&this.checkLValInnerPattern(pn,we,at)}break;default:this.checkLValSimple(G,we,at)}},mt.checkLValInnerPattern=function(G,we,at){switch(we===void 0&&(we=oi),G.type){case"Property":this.checkLValInnerPattern(G.value,we,at);break;case"AssignmentPattern":this.checkLValPattern(G.left,we,at);break;case"RestElement":this.checkLValPattern(G.argument,we,at);break;default:this.checkLValPattern(G,we,at)}};var ot=function(we,at,Ct,Yt,Ii){this.token=we,this.isExpr=!!at,this.preserveSpace=!!Ct,this.override=Yt,this.generator=!!Ii},Pe={b_stat:new ot("{",!1),b_expr:new ot("{",!0),b_tmpl:new ot("${",!1),p_stat:new ot("(",!1),p_expr:new ot("(",!0),q_tmpl:new ot("`",!0,!0,function(G){return G.tryReadTemplateToken()}),f_stat:new ot("function",!1),f_expr:new ot("function",!0),f_expr_gen:new ot("function",!0,!1,null,!0),f_gen:new ot("function",!1,!1,null,!0)},ae=b.prototype;ae.initialContext=function(){return[Pe.b_stat]},ae.curContext=function(){return this.context[this.context.length-1]},ae.braceIsBlock=function(G){var we=this.curContext();return we===Pe.f_expr||we===Pe.f_stat?!0:G===Ue.colon&&(we===Pe.b_stat||we===Pe.b_expr)?!we.isExpr:G===Ue._return||G===Ue.name&&this.exprAllowed?$t.test(this.input.slice(this.lastTokEnd,this.start)):G===Ue._else||G===Ue.semi||G===Ue.eof||G===Ue.parenR||G===Ue.arrow?!0:G===Ue.braceL?we===Pe.b_stat:G===Ue._var||G===Ue._const||G===Ue.name?!1:!this.exprAllowed},ae.inGeneratorContext=function(){for(var G=this.context.length-1;G>=1;G--){var we=this.context[G];if(we.token==="function")return we.generator}return!1},ae.updateContext=function(G){var we,at=this.type;at.keyword&&G===Ue.dot?this.exprAllowed=!1:(we=at.updateContext)?we.call(this,G):this.exprAllowed=at.beforeExpr},ae.overrideContext=function(G){this.curContext()!==G&&(this.context[this.context.length-1]=G)},Ue.parenR.updateContext=Ue.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var G=this.context.pop();G===Pe.b_stat&&this.curContext().token==="function"&&(G=this.context.pop()),this.exprAllowed=!G.isExpr},Ue.braceL.updateContext=function(G){this.context.push(this.braceIsBlock(G)?Pe.b_stat:Pe.b_expr),this.exprAllowed=!0},Ue.dollarBraceL.updateContext=function(){this.context.push(Pe.b_tmpl),this.exprAllowed=!0},Ue.parenL.updateContext=function(G){var we=G===Ue._if||G===Ue._for||G===Ue._with||G===Ue._while;this.context.push(we?Pe.p_stat:Pe.p_expr),this.exprAllowed=!0},Ue.incDec.updateContext=function(){},Ue._function.updateContext=Ue._class.updateContext=function(G){G.beforeExpr&&G!==Ue._else&&!(G===Ue.semi&&this.curContext()!==Pe.p_stat)&&!(G===Ue._return&&$t.test(this.input.slice(this.lastTokEnd,this.start)))&&!((G===Ue.colon||G===Ue.braceL)&&this.curContext()===Pe.b_stat)?this.context.push(Pe.f_expr):this.context.push(Pe.f_stat),this.exprAllowed=!1},Ue.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},Ue.backQuote.updateContext=function(){this.curContext()===Pe.q_tmpl?this.context.pop():this.context.push(Pe.q_tmpl),this.exprAllowed=!1},Ue.star.updateContext=function(G){if(G===Ue._function){var we=this.context.length-1;this.context[we]===Pe.f_expr?this.context[we]=Pe.f_expr_gen:this.context[we]=Pe.f_gen}this.exprAllowed=!0},Ue.name.updateContext=function(G){var we=!1;this.options.ecmaVersion>=6&&G!==Ue.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(we=!0),this.exprAllowed=we};var re=b.prototype;re.checkPropClash=function(G,we,at){if(!(this.options.ecmaVersion>=9&&G.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(G.computed||G.method||G.shorthand))){var Ct=G.key,Yt;switch(Ct.type){case"Identifier":Yt=Ct.name;break;case"Literal":Yt=String(Ct.value);break;default:return}var Ii=G.kind;if(this.options.ecmaVersion>=6){Yt==="__proto__"&&Ii==="init"&&(we.proto&&(at?at.doubleProto<0&&(at.doubleProto=Ct.start):this.raiseRecoverable(Ct.start,"Redefinition of __proto__ property")),we.proto=!0);return}Yt="$"+Yt;var Li=we[Yt];if(Li){var An;Ii==="init"?An=this.strict&&Li.init||Li.get||Li.set:An=Li.init||Li[Ii],An&&this.raiseRecoverable(Ct.start,"Redefinition of property")}else Li=we[Yt]={init:!1,get:!1,set:!1};Li[Ii]=!0}},re.parseExpression=function(G,we){var at=this.start,Ct=this.startLoc,Yt=this.parseMaybeAssign(G,we);if(this.type===Ue.comma){var Ii=this.startNodeAt(at,Ct);for(Ii.expressions=[Yt];this.eat(Ue.comma);)Ii.expressions.push(this.parseMaybeAssign(G,we));return this.finishNode(Ii,"SequenceExpression")}return Yt},re.parseMaybeAssign=function(G,we,at){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(G);this.exprAllowed=!1}var Ct=!1,Yt=-1,Ii=-1,Li=-1;we?(Yt=we.parenthesizedAssign,Ii=we.trailingComma,Li=we.doubleProto,we.parenthesizedAssign=we.trailingComma=-1):(we=new ie,Ct=!0);var An=this.start,pn=this.startLoc;(this.type===Ue.parenL||this.type===Ue.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=G==="await");var or=this.parseMaybeConditional(G,we);if(at&&(or=at.call(this,or,An,pn)),this.type.isAssign){var dr=this.startNodeAt(An,pn);return dr.operator=this.value,this.type===Ue.eq&&(or=this.toAssignable(or,!1,we)),Ct||(we.parenthesizedAssign=we.trailingComma=we.doubleProto=-1),we.shorthandAssign>=or.start&&(we.shorthandAssign=-1),this.type===Ue.eq?this.checkLValPattern(or):this.checkLValSimple(or),dr.left=or,this.next(),dr.right=this.parseMaybeAssign(G),Li>-1&&(we.doubleProto=Li),this.finishNode(dr,"AssignmentExpression")}else Ct&&this.checkExpressionErrors(we,!0);return Yt>-1&&(we.parenthesizedAssign=Yt),Ii>-1&&(we.trailingComma=Ii),or},re.parseMaybeConditional=function(G,we){var at=this.start,Ct=this.startLoc,Yt=this.parseExprOps(G,we);if(this.checkExpressionErrors(we))return Yt;if(this.eat(Ue.question)){var Ii=this.startNodeAt(at,Ct);return Ii.test=Yt,Ii.consequent=this.parseMaybeAssign(),this.expect(Ue.colon),Ii.alternate=this.parseMaybeAssign(G),this.finishNode(Ii,"ConditionalExpression")}return Yt},re.parseExprOps=function(G,we){var at=this.start,Ct=this.startLoc,Yt=this.parseMaybeUnary(we,!1,!1,G);return this.checkExpressionErrors(we)||Yt.start===at&&Yt.type==="ArrowFunctionExpression"?Yt:this.parseExprOp(Yt,at,Ct,-1,G)},re.parseExprOp=function(G,we,at,Ct,Yt){var Ii=this.type.binop;if(Ii!=null&&(!Yt||this.type!==Ue._in)&&Ii>Ct){var Li=this.type===Ue.logicalOR||this.type===Ue.logicalAND,An=this.type===Ue.coalesce;An&&(Ii=Ue.logicalAND.binop);var pn=this.value;this.next();var or=this.start,dr=this.startLoc,qr=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,Yt),or,dr,Ii,Yt),Xa=this.buildBinary(we,at,G,qr,pn,Li||An);return(Li&&this.type===Ue.coalesce||An&&(this.type===Ue.logicalOR||this.type===Ue.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Xa,we,at,Ct,Yt)}return G},re.buildBinary=function(G,we,at,Ct,Yt,Ii){Ct.type==="PrivateIdentifier"&&this.raise(Ct.start,"Private identifier can only be left side of binary expression");var Li=this.startNodeAt(G,we);return Li.left=at,Li.operator=Yt,Li.right=Ct,this.finishNode(Li,Ii?"LogicalExpression":"BinaryExpression")},re.parseMaybeUnary=function(G,we,at,Ct){var Yt=this.start,Ii=this.startLoc,Li;if(this.isContextual("await")&&this.canAwait)Li=this.parseAwait(Ct),we=!0;else if(this.type.prefix){var An=this.startNode(),pn=this.type===Ue.incDec;An.operator=this.value,An.prefix=!0,this.next(),An.argument=this.parseMaybeUnary(null,!0,pn,Ct),this.checkExpressionErrors(G,!0),pn?this.checkLValSimple(An.argument):this.strict&&An.operator==="delete"&&An.argument.type==="Identifier"?this.raiseRecoverable(An.start,"Deleting local variable in strict mode"):An.operator==="delete"&&X(An.argument)?this.raiseRecoverable(An.start,"Private fields can not be deleted"):we=!0,Li=this.finishNode(An,pn?"UpdateExpression":"UnaryExpression")}else if(!we&&this.type===Ue.privateId)(Ct||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Li=this.parsePrivateIdent(),this.type!==Ue._in&&this.unexpected();else{if(Li=this.parseExprSubscripts(G,Ct),this.checkExpressionErrors(G))return Li;for(;this.type.postfix&&!this.canInsertSemicolon();){var or=this.startNodeAt(Yt,Ii);or.operator=this.value,or.prefix=!1,or.argument=Li,this.checkLValSimple(Li),this.next(),Li=this.finishNode(or,"UpdateExpression")}}if(!at&&this.eat(Ue.starstar))if(we)this.unexpected(this.lastTokStart);else return this.buildBinary(Yt,Ii,Li,this.parseMaybeUnary(null,!1,!1,Ct),"**",!1);else return Li};function X(G){return G.type==="MemberExpression"&&G.property.type==="PrivateIdentifier"||G.type==="ChainExpression"&&X(G.expression)}re.parseExprSubscripts=function(G,we){var at=this.start,Ct=this.startLoc,Yt=this.parseExprAtom(G,we);if(Yt.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return Yt;var Ii=this.parseSubscripts(Yt,at,Ct,!1,we);return G&&Ii.type==="MemberExpression"&&(G.parenthesizedAssign>=Ii.start&&(G.parenthesizedAssign=-1),G.parenthesizedBind>=Ii.start&&(G.parenthesizedBind=-1),G.trailingComma>=Ii.start&&(G.trailingComma=-1)),Ii},re.parseSubscripts=function(G,we,at,Ct,Yt){for(var Ii=this.options.ecmaVersion>=8&&G.type==="Identifier"&&G.name==="async"&&this.lastTokEnd===G.end&&!this.canInsertSemicolon()&&G.end-G.start===5&&this.potentialArrowAt===G.start,Li=!1;;){var An=this.parseSubscript(G,we,at,Ct,Ii,Li,Yt);if(An.optional&&(Li=!0),An===G||An.type==="ArrowFunctionExpression"){if(Li){var pn=this.startNodeAt(we,at);pn.expression=An,An=this.finishNode(pn,"ChainExpression")}return An}G=An}},re.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(Ue.arrow)},re.parseSubscriptAsyncArrow=function(G,we,at,Ct){return this.parseArrowExpression(this.startNodeAt(G,we),at,!0,Ct)},re.parseSubscript=function(G,we,at,Ct,Yt,Ii,Li){var An=this.options.ecmaVersion>=11,pn=An&&this.eat(Ue.questionDot);Ct&&pn&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var or=this.eat(Ue.bracketL);if(or||pn&&this.type!==Ue.parenL&&this.type!==Ue.backQuote||this.eat(Ue.dot)){var dr=this.startNodeAt(we,at);dr.object=G,or?(dr.property=this.parseExpression(),this.expect(Ue.bracketR)):this.type===Ue.privateId&&G.type!=="Super"?dr.property=this.parsePrivateIdent():dr.property=this.parseIdent(this.options.allowReserved!=="never"),dr.computed=!!or,An&&(dr.optional=pn),G=this.finishNode(dr,"MemberExpression")}else if(!Ct&&this.eat(Ue.parenL)){var qr=new ie,Xa=this.yieldPos,Ya=this.awaitPos,Ka=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var ml=this.parseExprList(Ue.parenR,this.options.ecmaVersion>=8,!1,qr);if(Yt&&!pn&&this.shouldParseAsyncArrow())return this.checkPatternErrors(qr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Xa,this.awaitPos=Ya,this.awaitIdentPos=Ka,this.parseSubscriptAsyncArrow(we,at,ml,Li);this.checkExpressionErrors(qr,!0),this.yieldPos=Xa||this.yieldPos,this.awaitPos=Ya||this.awaitPos,this.awaitIdentPos=Ka||this.awaitIdentPos;var Wr=this.startNodeAt(we,at);Wr.callee=G,Wr.arguments=ml,An&&(Wr.optional=pn),G=this.finishNode(Wr,"CallExpression")}else if(this.type===Ue.backQuote){(pn||Ii)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var sr=this.startNodeAt(we,at);sr.tag=G,sr.quasi=this.parseTemplate({isTagged:!0}),G=this.finishNode(sr,"TaggedTemplateExpression")}return G},re.parseExprAtom=function(G,we,at){this.type===Ue.slash&&this.readRegexp();var Ct,Yt=this.potentialArrowAt===this.start;switch(this.type){case Ue._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),Ct=this.startNode(),this.next(),this.type===Ue.parenL&&!this.allowDirectSuper&&this.raise(Ct.start,"super() call outside constructor of a subclass"),this.type!==Ue.dot&&this.type!==Ue.bracketL&&this.type!==Ue.parenL&&this.unexpected(),this.finishNode(Ct,"Super");case Ue._this:return Ct=this.startNode(),this.next(),this.finishNode(Ct,"ThisExpression");case Ue.name:var Ii=this.start,Li=this.startLoc,An=this.containsEsc,pn=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!An&&pn.name==="async"&&!this.canInsertSemicolon()&&this.eat(Ue._function))return this.overrideContext(Pe.f_expr),this.parseFunction(this.startNodeAt(Ii,Li),0,!1,!0,we);if(Yt&&!this.canInsertSemicolon()){if(this.eat(Ue.arrow))return this.parseArrowExpression(this.startNodeAt(Ii,Li),[pn],!1,we);if(this.options.ecmaVersion>=8&&pn.name==="async"&&this.type===Ue.name&&!An&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return pn=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Ue.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Ii,Li),[pn],!0,we)}return pn;case Ue.regexp:var or=this.value;return Ct=this.parseLiteral(or.value),Ct.regex={pattern:or.pattern,flags:or.flags},Ct;case Ue.num:case Ue.string:return this.parseLiteral(this.value);case Ue._null:case Ue._true:case Ue._false:return Ct=this.startNode(),Ct.value=this.type===Ue._null?null:this.type===Ue._true,Ct.raw=this.type.keyword,this.next(),this.finishNode(Ct,"Literal");case Ue.parenL:var dr=this.start,qr=this.parseParenAndDistinguishExpression(Yt,we);return G&&(G.parenthesizedAssign<0&&!this.isSimpleAssignTarget(qr)&&(G.parenthesizedAssign=dr),G.parenthesizedBind<0&&(G.parenthesizedBind=dr)),qr;case Ue.bracketL:return Ct=this.startNode(),this.next(),Ct.elements=this.parseExprList(Ue.bracketR,!0,!0,G),this.finishNode(Ct,"ArrayExpression");case Ue.braceL:return this.overrideContext(Pe.b_expr),this.parseObj(!1,G);case Ue._function:return Ct=this.startNode(),this.next(),this.parseFunction(Ct,0);case Ue._class:return this.parseClass(this.startNode(),!1);case Ue._new:return this.parseNew();case Ue.backQuote:return this.parseTemplate();case Ue._import:return this.options.ecmaVersion>=11?this.parseExprImport(at):this.unexpected();default:return this.parseExprAtomDefault()}},re.parseExprAtomDefault=function(){this.unexpected()},re.parseExprImport=function(G){var we=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===Ue.parenL&&!G)return this.parseDynamicImport(we);if(this.type===Ue.dot){var at=this.startNodeAt(we.start,we.loc&&we.loc.start);return at.name="import",we.meta=this.finishNode(at,"Identifier"),this.parseImportMeta(we)}else this.unexpected()},re.parseDynamicImport=function(G){if(this.next(),G.source=this.parseMaybeAssign(),!this.eat(Ue.parenR)){var we=this.start;this.eat(Ue.comma)&&this.eat(Ue.parenR)?this.raiseRecoverable(we,"Trailing comma is not allowed in import()"):this.unexpected(we)}return this.finishNode(G,"ImportExpression")},re.parseImportMeta=function(G){this.next();var we=this.containsEsc;return G.property=this.parseIdent(!0),G.property.name!=="meta"&&this.raiseRecoverable(G.property.start,"The only valid meta property for import is 'import.meta'"),we&&this.raiseRecoverable(G.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(G.start,"Cannot use 'import.meta' outside a module"),this.finishNode(G,"MetaProperty")},re.parseLiteral=function(G){var we=this.startNode();return we.value=G,we.raw=this.input.slice(this.start,this.end),we.raw.charCodeAt(we.raw.length-1)===110&&(we.bigint=we.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(we,"Literal")},re.parseParenExpression=function(){this.expect(Ue.parenL);var G=this.parseExpression();return this.expect(Ue.parenR),G},re.shouldParseArrow=function(G){return!this.canInsertSemicolon()},re.parseParenAndDistinguishExpression=function(G,we){var at=this.start,Ct=this.startLoc,Yt,Ii=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Li=this.start,An=this.startLoc,pn=[],or=!0,dr=!1,qr=new ie,Xa=this.yieldPos,Ya=this.awaitPos,Ka;for(this.yieldPos=0,this.awaitPos=0;this.type!==Ue.parenR;)if(or?or=!1:this.expect(Ue.comma),Ii&&this.afterTrailingComma(Ue.parenR,!0)){dr=!0;break}else if(this.type===Ue.ellipsis){Ka=this.start,pn.push(this.parseParenItem(this.parseRestBinding())),this.type===Ue.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else pn.push(this.parseMaybeAssign(!1,qr,this.parseParenItem));var ml=this.lastTokEnd,Wr=this.lastTokEndLoc;if(this.expect(Ue.parenR),G&&this.shouldParseArrow(pn)&&this.eat(Ue.arrow))return this.checkPatternErrors(qr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Xa,this.awaitPos=Ya,this.parseParenArrowList(at,Ct,pn,we);(!pn.length||dr)&&this.unexpected(this.lastTokStart),Ka&&this.unexpected(Ka),this.checkExpressionErrors(qr,!0),this.yieldPos=Xa||this.yieldPos,this.awaitPos=Ya||this.awaitPos,pn.length>1?(Yt=this.startNodeAt(Li,An),Yt.expressions=pn,this.finishNodeAt(Yt,"SequenceExpression",ml,Wr)):Yt=pn[0]}else Yt=this.parseParenExpression();if(this.options.preserveParens){var sr=this.startNodeAt(at,Ct);return sr.expression=Yt,this.finishNode(sr,"ParenthesizedExpression")}else return Yt},re.parseParenItem=function(G){return G},re.parseParenArrowList=function(G,we,at,Ct){return this.parseArrowExpression(this.startNodeAt(G,we),at,!1,Ct)};var ne=[];re.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var G=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===Ue.dot){var we=this.startNodeAt(G.start,G.loc&&G.loc.start);we.name="new",G.meta=this.finishNode(we,"Identifier"),this.next();var at=this.containsEsc;return G.property=this.parseIdent(!0),G.property.name!=="target"&&this.raiseRecoverable(G.property.start,"The only valid meta property for new is 'new.target'"),at&&this.raiseRecoverable(G.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(G.start,"'new.target' can only be used in functions and class static block"),this.finishNode(G,"MetaProperty")}var Ct=this.start,Yt=this.startLoc;return G.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),Ct,Yt,!0,!1),this.eat(Ue.parenL)?G.arguments=this.parseExprList(Ue.parenR,this.options.ecmaVersion>=8,!1):G.arguments=ne,this.finishNode(G,"NewExpression")},re.parseTemplateElement=function(G){var we=G.isTagged,at=this.startNode();return this.type===Ue.invalidTemplate?(we||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),at.value={raw:this.value,cooked:null}):at.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),at.tail=this.type===Ue.backQuote,this.finishNode(at,"TemplateElement")},re.parseTemplate=function(G){G===void 0&&(G={});var we=G.isTagged;we===void 0&&(we=!1);var at=this.startNode();this.next(),at.expressions=[];var Ct=this.parseTemplateElement({isTagged:we});for(at.quasis=[Ct];!Ct.tail;)this.type===Ue.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Ue.dollarBraceL),at.expressions.push(this.parseExpression()),this.expect(Ue.braceR),at.quasis.push(Ct=this.parseTemplateElement({isTagged:we}));return this.next(),this.finishNode(at,"TemplateLiteral")},re.isAsyncProp=function(G){return!G.computed&&G.key.type==="Identifier"&&G.key.name==="async"&&(this.type===Ue.name||this.type===Ue.num||this.type===Ue.string||this.type===Ue.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Ue.star)&&!$t.test(this.input.slice(this.lastTokEnd,this.start))},re.parseObj=function(G,we){var at=this.startNode(),Ct=!0,Yt={};for(at.properties=[],this.next();!this.eat(Ue.braceR);){if(Ct)Ct=!1;else if(this.expect(Ue.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Ue.braceR))break;var Ii=this.parseProperty(G,we);G||this.checkPropClash(Ii,Yt,we),at.properties.push(Ii)}return this.finishNode(at,G?"ObjectPattern":"ObjectExpression")},re.parseProperty=function(G,we){var at=this.startNode(),Ct,Yt,Ii,Li;if(this.options.ecmaVersion>=9&&this.eat(Ue.ellipsis))return G?(at.argument=this.parseIdent(!1),this.type===Ue.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(at,"RestElement")):(at.argument=this.parseMaybeAssign(!1,we),this.type===Ue.comma&&we&&we.trailingComma<0&&(we.trailingComma=this.start),this.finishNode(at,"SpreadElement"));this.options.ecmaVersion>=6&&(at.method=!1,at.shorthand=!1,(G||we)&&(Ii=this.start,Li=this.startLoc),G||(Ct=this.eat(Ue.star)));var An=this.containsEsc;return this.parsePropertyName(at),!G&&!An&&this.options.ecmaVersion>=8&&!Ct&&this.isAsyncProp(at)?(Yt=!0,Ct=this.options.ecmaVersion>=9&&this.eat(Ue.star),this.parsePropertyName(at)):Yt=!1,this.parsePropertyValue(at,G,Ct,Yt,Ii,Li,we,An),this.finishNode(at,"Property")},re.parseGetterSetter=function(G){G.kind=G.key.name,this.parsePropertyName(G),G.value=this.parseMethod(!1);var we=G.kind==="get"?0:1;if(G.value.params.length!==we){var at=G.value.start;G.kind==="get"?this.raiseRecoverable(at,"getter should have no params"):this.raiseRecoverable(at,"setter should have exactly one param")}else G.kind==="set"&&G.value.params[0].type==="RestElement"&&this.raiseRecoverable(G.value.params[0].start,"Setter cannot use rest params")},re.parsePropertyValue=function(G,we,at,Ct,Yt,Ii,Li,An){(at||Ct)&&this.type===Ue.colon&&this.unexpected(),this.eat(Ue.colon)?(G.value=we?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Li),G.kind="init"):this.options.ecmaVersion>=6&&this.type===Ue.parenL?(we&&this.unexpected(),G.kind="init",G.method=!0,G.value=this.parseMethod(at,Ct)):!we&&!An&&this.options.ecmaVersion>=5&&!G.computed&&G.key.type==="Identifier"&&(G.key.name==="get"||G.key.name==="set")&&this.type!==Ue.comma&&this.type!==Ue.braceR&&this.type!==Ue.eq?((at||Ct)&&this.unexpected(),this.parseGetterSetter(G)):this.options.ecmaVersion>=6&&!G.computed&&G.key.type==="Identifier"?((at||Ct)&&this.unexpected(),this.checkUnreserved(G.key),G.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=Yt),G.kind="init",we?G.value=this.parseMaybeDefault(Yt,Ii,this.copyNode(G.key)):this.type===Ue.eq&&Li?(Li.shorthandAssign<0&&(Li.shorthandAssign=this.start),G.value=this.parseMaybeDefault(Yt,Ii,this.copyNode(G.key))):G.value=this.copyNode(G.key),G.shorthand=!0):this.unexpected()},re.parsePropertyName=function(G){if(this.options.ecmaVersion>=6){if(this.eat(Ue.bracketL))return G.computed=!0,G.key=this.parseMaybeAssign(),this.expect(Ue.bracketR),G.key;G.computed=!1}return G.key=this.type===Ue.num||this.type===Ue.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},re.initFunction=function(G){G.id=null,this.options.ecmaVersion>=6&&(G.generator=G.expression=!1),this.options.ecmaVersion>=8&&(G.async=!1)},re.parseMethod=function(G,we,at){var Ct=this.startNode(),Yt=this.yieldPos,Ii=this.awaitPos,Li=this.awaitIdentPos;return this.initFunction(Ct),this.options.ecmaVersion>=6&&(Ct.generator=G),this.options.ecmaVersion>=8&&(Ct.async=!!we),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope($n(we,Ct.generator)|xi|(at?Bn:0)),this.expect(Ue.parenL),Ct.params=this.parseBindingList(Ue.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(Ct,!1,!0,!1),this.yieldPos=Yt,this.awaitPos=Ii,this.awaitIdentPos=Li,this.finishNode(Ct,"FunctionExpression")},re.parseArrowExpression=function(G,we,at,Ct){var Yt=this.yieldPos,Ii=this.awaitPos,Li=this.awaitIdentPos;return this.enterScope($n(at,!1)|bn),this.initFunction(G),this.options.ecmaVersion>=8&&(G.async=!!at),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,G.params=this.toAssignableList(we,!0),this.parseFunctionBody(G,!0,!1,Ct),this.yieldPos=Yt,this.awaitPos=Ii,this.awaitIdentPos=Li,this.finishNode(G,"ArrowFunctionExpression")},re.parseFunctionBody=function(G,we,at,Ct){var Yt=we&&this.type!==Ue.braceL,Ii=this.strict,Li=!1;if(Yt)G.body=this.parseMaybeAssign(Ct),G.expression=!0,this.checkParams(G,!1);else{var An=this.options.ecmaVersion>=7&&!this.isSimpleParamList(G.params);(!Ii||An)&&(Li=this.strictDirective(this.end),Li&&An&&this.raiseRecoverable(G.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var pn=this.labels;this.labels=[],Li&&(this.strict=!0),this.checkParams(G,!Ii&&!Li&&!we&&!at&&this.isSimpleParamList(G.params)),this.strict&&G.id&&this.checkLValSimple(G.id,_n),G.body=this.parseBlock(!1,void 0,Li&&!Ii),G.expression=!1,this.adaptDirectivePrologue(G.body.body),this.labels=pn}this.exitScope()},re.isSimpleParamList=function(G){for(var we=0,at=G;we<at.length;we+=1){var Ct=at[we];if(Ct.type!=="Identifier")return!1}return!0},re.checkParams=function(G,we){for(var at=Object.create(null),Ct=0,Yt=G.params;Ct<Yt.length;Ct+=1){var Ii=Yt[Ct];this.checkLValInnerPattern(Ii,Yi,we?null:at)}},re.parseExprList=function(G,we,at,Ct){for(var Yt=[],Ii=!0;!this.eat(G);){if(Ii)Ii=!1;else if(this.expect(Ue.comma),we&&this.afterTrailingComma(G))break;var Li=void 0;at&&this.type===Ue.comma?Li=null:this.type===Ue.ellipsis?(Li=this.parseSpread(Ct),Ct&&this.type===Ue.comma&&Ct.trailingComma<0&&(Ct.trailingComma=this.start)):Li=this.parseMaybeAssign(!1,Ct),Yt.push(Li)}return Yt},re.checkUnreserved=function(G){var we=G.start,at=G.end,Ct=G.name;if(this.inGenerator&&Ct==="yield"&&this.raiseRecoverable(we,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&Ct==="await"&&this.raiseRecoverable(we,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&Ct==="arguments"&&this.raiseRecoverable(we,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(Ct==="arguments"||Ct==="await")&&this.raise(we,"Cannot use "+Ct+" in class static initialization block"),this.keywords.test(Ct)&&this.raise(we,"Unexpected keyword '"+Ct+"'"),!(this.options.ecmaVersion<6&&this.input.slice(we,at).indexOf("\\")!==-1)){var Yt=this.strict?this.reservedWordsStrict:this.reservedWords;Yt.test(Ct)&&(!this.inAsync&&Ct==="await"&&this.raiseRecoverable(we,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(we,"The keyword '"+Ct+"' is reserved"))}},re.parseIdent=function(G){var we=this.parseIdentNode();return this.next(!!G),this.finishNode(we,"Identifier"),G||(this.checkUnreserved(we),we.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=we.start)),we},re.parseIdentNode=function(){var G=this.startNode();return this.type===Ue.name?G.name=this.value:this.type.keyword?(G.name=this.type.keyword,(G.name==="class"||G.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=Ue.name):this.unexpected(),G},re.parsePrivateIdent=function(){var G=this.startNode();return this.type===Ue.privateId?G.name=this.value:this.unexpected(),this.next(),this.finishNode(G,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(G.start,"Private field '#"+G.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(G)),G},re.parseYield=function(G){this.yieldPos||(this.yieldPos=this.start);var we=this.startNode();return this.next(),this.type===Ue.semi||this.canInsertSemicolon()||this.type!==Ue.star&&!this.type.startsExpr?(we.delegate=!1,we.argument=null):(we.delegate=this.eat(Ue.star),we.argument=this.parseMaybeAssign(G)),this.finishNode(we,"YieldExpression")},re.parseAwait=function(G){this.awaitPos||(this.awaitPos=this.start);var we=this.startNode();return this.next(),we.argument=this.parseMaybeUnary(null,!0,!1,G),this.finishNode(we,"AwaitExpression")};var pe=b.prototype;pe.raise=function(G,we){var at=tn(this.input,G);we+=" ("+at.line+":"+at.column+")";var Ct=new SyntaxError(we);throw Ct.pos=G,Ct.loc=at,Ct.raisedAt=this.pos,Ct},pe.raiseRecoverable=pe.raise,pe.curPosition=function(){if(this.options.locations)return new ki(this.curLine,this.pos-this.lineStart)};var xe=b.prototype,ye=function(we){this.flags=we,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};xe.enterScope=function(G){this.scopeStack.push(new ye(G))},xe.exitScope=function(){this.scopeStack.pop()},xe.treatFunctionsAsVarInScope=function(G){return G.flags&gi||!this.inModule&&G.flags&Ti},xe.declareName=function(G,we,at){var Ct=!1;if(we===Xn){var Yt=this.currentScope();Ct=Yt.lexical.indexOf(G)>-1||Yt.functions.indexOf(G)>-1||Yt.var.indexOf(G)>-1,Yt.lexical.push(G),this.inModule&&Yt.flags&Ti&&delete this.undefinedExports[G]}else if(we===Wn){var Ii=this.currentScope();Ii.lexical.push(G)}else if(we===zn){var Li=this.currentScope();this.treatFunctionsAsVar?Ct=Li.lexical.indexOf(G)>-1:Ct=Li.lexical.indexOf(G)>-1||Li.var.indexOf(G)>-1,Li.functions.push(G)}else for(var An=this.scopeStack.length-1;An>=0;--An){var pn=this.scopeStack[An];if(pn.lexical.indexOf(G)>-1&&!(pn.flags&wn&&pn.lexical[0]===G)||!this.treatFunctionsAsVarInScope(pn)&&pn.functions.indexOf(G)>-1){Ct=!0;break}if(pn.var.push(G),this.inModule&&pn.flags&Ti&&delete this.undefinedExports[G],pn.flags&an)break}Ct&&this.raiseRecoverable(at,"Identifier '"+G+"' has already been declared")},xe.checkLocalExport=function(G){this.scopeStack[0].lexical.indexOf(G.name)===-1&&this.scopeStack[0].var.indexOf(G.name)===-1&&(this.undefinedExports[G.name]=G)},xe.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},xe.currentVarScope=function(){for(var G=this.scopeStack.length-1;;G--){var we=this.scopeStack[G];if(we.flags&an)return we}},xe.currentThisScope=function(){for(var G=this.scopeStack.length-1;;G--){var we=this.scopeStack[G];if(we.flags&an&&!(we.flags&bn))return we}};var De=function(we,at,Ct){this.type="",this.start=at,this.end=0,we.options.locations&&(this.loc=new Ni(we,Ct)),we.options.directSourceFile&&(this.sourceFile=we.options.directSourceFile),we.options.ranges&&(this.range=[at,0])},Oe=b.prototype;Oe.startNode=function(){return new De(this,this.start,this.startLoc)},Oe.startNodeAt=function(G,we){return new De(this,G,we)};function Ve(G,we,at,Ct){return G.type=we,G.end=at,this.options.locations&&(G.loc.end=Ct),this.options.ranges&&(G.range[1]=at),G}Oe.finishNode=function(G,we){return Ve.call(this,G,we,this.lastTokEnd,this.lastTokEndLoc)},Oe.finishNodeAt=function(G,we,at,Ct){return Ve.call(this,G,we,at,Ct)},Oe.copyNode=function(G){var we=new De(this,G.start,this.startLoc);for(var at in G)we[at]=G[at];return we};var Je="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",et=Je+" Extended_Pictographic",Le=et,qe=Le+" EBase EComp EMod EPres ExtPict",dt=qe,Pt=dt,o={9:Je,10:et,11:Le,12:qe,13:dt,14:Pt},Me="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",li={9:"",10:"",11:"",12:"",13:"",14:Me},di="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",fi="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ti=fi+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ui=ti+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Ri=ui+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",bi=Ri+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Si=bi+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",Jt={9:fi,10:ti,11:ui,12:Ri,13:bi,14:Si},Sn={};function ur(G){var we=Sn[G]={binary:Vt(o[G]+" "+di),binaryOfStrings:Vt(li[G]),nonBinary:{General_Category:Vt(di),Script:Vt(Jt[G])}};we.nonBinary.Script_Extensions=we.nonBinary.Script,we.nonBinary.gc=we.nonBinary.General_Category,we.nonBinary.sc=we.nonBinary.Script,we.nonBinary.scx=we.nonBinary.Script_Extensions}for(var mn=0,Hn=[9,10,11,12,13,14];mn<Hn.length;mn+=1){var Yr=Hn[mn];ur(Yr)}var Qi=b.prototype,hr=function(we){this.parser=we,this.validFlags="gim"+(we.options.ecmaVersion>=6?"uy":"")+(we.options.ecmaVersion>=9?"s":"")+(we.options.ecmaVersion>=13?"d":"")+(we.options.ecmaVersion>=15?"v":""),this.unicodeProperties=Sn[we.options.ecmaVersion>=14?14:we.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};hr.prototype.reset=function(we,at,Ct){var Yt=Ct.indexOf("v")!==-1,Ii=Ct.indexOf("u")!==-1;this.start=we|0,this.source=at+"",this.flags=Ct,Yt&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Ii&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Ii&&this.parser.options.ecmaVersion>=9)},hr.prototype.raise=function(we){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+we)},hr.prototype.at=function(we,at){at===void 0&&(at=!1);var Ct=this.source,Yt=Ct.length;if(we>=Yt)return-1;var Ii=Ct.charCodeAt(we);if(!(at||this.switchU)||Ii<=55295||Ii>=57344||we+1>=Yt)return Ii;var Li=Ct.charCodeAt(we+1);return Li>=56320&&Li<=57343?(Ii<<10)+Li-56613888:Ii},hr.prototype.nextIndex=function(we,at){at===void 0&&(at=!1);var Ct=this.source,Yt=Ct.length;if(we>=Yt)return Yt;var Ii=Ct.charCodeAt(we),Li;return!(at||this.switchU)||Ii<=55295||Ii>=57344||we+1>=Yt||(Li=Ct.charCodeAt(we+1))<56320||Li>57343?we+1:we+2},hr.prototype.current=function(we){return we===void 0&&(we=!1),this.at(this.pos,we)},hr.prototype.lookahead=function(we){return we===void 0&&(we=!1),this.at(this.nextIndex(this.pos,we),we)},hr.prototype.advance=function(we){we===void 0&&(we=!1),this.pos=this.nextIndex(this.pos,we)},hr.prototype.eat=function(we,at){return at===void 0&&(at=!1),this.current(at)===we?(this.advance(at),!0):!1},hr.prototype.eatChars=function(we,at){at===void 0&&(at=!1);for(var Ct=this.pos,Yt=0,Ii=we;Yt<Ii.length;Yt+=1){var Li=Ii[Yt],An=this.at(Ct,at);if(An===-1||An!==Li)return!1;Ct=this.nextIndex(Ct,at)}return this.pos=Ct,!0},Qi.validateRegExpFlags=function(G){for(var we=G.validFlags,at=G.flags,Ct=!1,Yt=!1,Ii=0;Ii<at.length;Ii++){var Li=at.charAt(Ii);we.indexOf(Li)===-1&&this.raise(G.start,"Invalid regular expression flag"),at.indexOf(Li,Ii+1)>-1&&this.raise(G.start,"Duplicate regular expression flag"),Li==="u"&&(Ct=!0),Li==="v"&&(Yt=!0)}this.options.ecmaVersion>=15&&Ct&&Yt&&this.raise(G.start,"Invalid regular expression flag")},Qi.validateRegExpPattern=function(G){this.regexp_pattern(G),!G.switchN&&this.options.ecmaVersion>=9&&G.groupNames.length>0&&(G.switchN=!0,this.regexp_pattern(G))},Qi.regexp_pattern=function(G){G.pos=0,G.lastIntValue=0,G.lastStringValue="",G.lastAssertionIsQuantifiable=!1,G.numCapturingParens=0,G.maxBackReference=0,G.groupNames.length=0,G.backReferenceNames.length=0,this.regexp_disjunction(G),G.pos!==G.source.length&&(G.eat(41)&&G.raise("Unmatched ')'"),(G.eat(93)||G.eat(125))&&G.raise("Lone quantifier brackets")),G.maxBackReference>G.numCapturingParens&&G.raise("Invalid escape");for(var we=0,at=G.backReferenceNames;we<at.length;we+=1){var Ct=at[we];G.groupNames.indexOf(Ct)===-1&&G.raise("Invalid named capture referenced")}},Qi.regexp_disjunction=function(G){for(this.regexp_alternative(G);G.eat(124);)this.regexp_alternative(G);this.regexp_eatQuantifier(G,!0)&&G.raise("Nothing to repeat"),G.eat(123)&&G.raise("Lone quantifier brackets")},Qi.regexp_alternative=function(G){for(;G.pos<G.source.length&&this.regexp_eatTerm(G););},Qi.regexp_eatTerm=function(G){return this.regexp_eatAssertion(G)?(G.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(G)&&G.switchU&&G.raise("Invalid quantifier"),!0):(G.switchU?this.regexp_eatAtom(G):this.regexp_eatExtendedAtom(G))?(this.regexp_eatQuantifier(G),!0):!1},Qi.regexp_eatAssertion=function(G){var we=G.pos;if(G.lastAssertionIsQuantifiable=!1,G.eat(94)||G.eat(36))return!0;if(G.eat(92)){if(G.eat(66)||G.eat(98))return!0;G.pos=we}if(G.eat(40)&&G.eat(63)){var at=!1;if(this.options.ecmaVersion>=9&&(at=G.eat(60)),G.eat(61)||G.eat(33))return this.regexp_disjunction(G),G.eat(41)||G.raise("Unterminated group"),G.lastAssertionIsQuantifiable=!at,!0}return G.pos=we,!1},Qi.regexp_eatQuantifier=function(G,we){return we===void 0&&(we=!1),this.regexp_eatQuantifierPrefix(G,we)?(G.eat(63),!0):!1},Qi.regexp_eatQuantifierPrefix=function(G,we){return G.eat(42)||G.eat(43)||G.eat(63)||this.regexp_eatBracedQuantifier(G,we)},Qi.regexp_eatBracedQuantifier=function(G,we){var at=G.pos;if(G.eat(123)){var Ct=0,Yt=-1;if(this.regexp_eatDecimalDigits(G)&&(Ct=G.lastIntValue,G.eat(44)&&this.regexp_eatDecimalDigits(G)&&(Yt=G.lastIntValue),G.eat(125)))return Yt!==-1&&Yt<Ct&&!we&&G.raise("numbers out of order in {} quantifier"),!0;G.switchU&&!we&&G.raise("Incomplete quantifier"),G.pos=at}return!1},Qi.regexp_eatAtom=function(G){return this.regexp_eatPatternCharacters(G)||G.eat(46)||this.regexp_eatReverseSolidusAtomEscape(G)||this.regexp_eatCharacterClass(G)||this.regexp_eatUncapturingGroup(G)||this.regexp_eatCapturingGroup(G)},Qi.regexp_eatReverseSolidusAtomEscape=function(G){var we=G.pos;if(G.eat(92)){if(this.regexp_eatAtomEscape(G))return!0;G.pos=we}return!1},Qi.regexp_eatUncapturingGroup=function(G){var we=G.pos;if(G.eat(40)){if(G.eat(63)&&G.eat(58)){if(this.regexp_disjunction(G),G.eat(41))return!0;G.raise("Unterminated group")}G.pos=we}return!1},Qi.regexp_eatCapturingGroup=function(G){if(G.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(G):G.current()===63&&G.raise("Invalid group"),this.regexp_disjunction(G),G.eat(41))return G.numCapturingParens+=1,!0;G.raise("Unterminated group")}return!1},Qi.regexp_eatExtendedAtom=function(G){return G.eat(46)||this.regexp_eatReverseSolidusAtomEscape(G)||this.regexp_eatCharacterClass(G)||this.regexp_eatUncapturingGroup(G)||this.regexp_eatCapturingGroup(G)||this.regexp_eatInvalidBracedQuantifier(G)||this.regexp_eatExtendedPatternCharacter(G)},Qi.regexp_eatInvalidBracedQuantifier=function(G){return this.regexp_eatBracedQuantifier(G,!0)&&G.raise("Nothing to repeat"),!1},Qi.regexp_eatSyntaxCharacter=function(G){var we=G.current();return Gn(we)?(G.lastIntValue=we,G.advance(),!0):!1};function Gn(G){return G===36||G>=40&&G<=43||G===46||G===63||G>=91&&G<=94||G>=123&&G<=125}Qi.regexp_eatPatternCharacters=function(G){for(var we=G.pos,at=0;(at=G.current())!==-1&&!Gn(at);)G.advance();return G.pos!==we},Qi.regexp_eatExtendedPatternCharacter=function(G){var we=G.current();return we!==-1&&we!==36&&!(we>=40&&we<=43)&&we!==46&&we!==63&&we!==91&&we!==94&&we!==124?(G.advance(),!0):!1},Qi.regexp_groupSpecifier=function(G){if(G.eat(63)){if(this.regexp_eatGroupName(G)){G.groupNames.indexOf(G.lastStringValue)!==-1&&G.raise("Duplicate capture group name"),G.groupNames.push(G.lastStringValue);return}G.raise("Invalid group")}},Qi.regexp_eatGroupName=function(G){if(G.lastStringValue="",G.eat(60)){if(this.regexp_eatRegExpIdentifierName(G)&&G.eat(62))return!0;G.raise("Invalid capture group name")}return!1},Qi.regexp_eatRegExpIdentifierName=function(G){if(G.lastStringValue="",this.regexp_eatRegExpIdentifierStart(G)){for(G.lastStringValue+=yi(G.lastIntValue);this.regexp_eatRegExpIdentifierPart(G);)G.lastStringValue+=yi(G.lastIntValue);return!0}return!1},Qi.regexp_eatRegExpIdentifierStart=function(G){var we=G.pos,at=this.options.ecmaVersion>=11,Ct=G.current(at);return G.advance(at),Ct===92&&this.regexp_eatRegExpUnicodeEscapeSequence(G,at)&&(Ct=G.lastIntValue),Xt(Ct)?(G.lastIntValue=Ct,!0):(G.pos=we,!1)};function Xt(G){return Ze(G,!0)||G===36||G===95}Qi.regexp_eatRegExpIdentifierPart=function(G){var we=G.pos,at=this.options.ecmaVersion>=11,Ct=G.current(at);return G.advance(at),Ct===92&&this.regexp_eatRegExpUnicodeEscapeSequence(G,at)&&(Ct=G.lastIntValue),en(Ct)?(G.lastIntValue=Ct,!0):(G.pos=we,!1)};function en(G){return nt(G,!0)||G===36||G===95||G===8204||G===8205}Qi.regexp_eatAtomEscape=function(G){return this.regexp_eatBackReference(G)||this.regexp_eatCharacterClassEscape(G)||this.regexp_eatCharacterEscape(G)||G.switchN&&this.regexp_eatKGroupName(G)?!0:(G.switchU&&(G.current()===99&&G.raise("Invalid unicode escape"),G.raise("Invalid escape")),!1)},Qi.regexp_eatBackReference=function(G){var we=G.pos;if(this.regexp_eatDecimalEscape(G)){var at=G.lastIntValue;if(G.switchU)return at>G.maxBackReference&&(G.maxBackReference=at),!0;if(at<=G.numCapturingParens)return!0;G.pos=we}return!1},Qi.regexp_eatKGroupName=function(G){if(G.eat(107)){if(this.regexp_eatGroupName(G))return G.backReferenceNames.push(G.lastStringValue),!0;G.raise("Invalid named reference")}return!1},Qi.regexp_eatCharacterEscape=function(G){return this.regexp_eatControlEscape(G)||this.regexp_eatCControlLetter(G)||this.regexp_eatZero(G)||this.regexp_eatHexEscapeSequence(G)||this.regexp_eatRegExpUnicodeEscapeSequence(G,!1)||!G.switchU&&this.regexp_eatLegacyOctalEscapeSequence(G)||this.regexp_eatIdentityEscape(G)},Qi.regexp_eatCControlLetter=function(G){var we=G.pos;if(G.eat(99)){if(this.regexp_eatControlLetter(G))return!0;G.pos=we}return!1},Qi.regexp_eatZero=function(G){return G.current()===48&&!Fr(G.lookahead())?(G.lastIntValue=0,G.advance(),!0):!1},Qi.regexp_eatControlEscape=function(G){var we=G.current();return we===116?(G.lastIntValue=9,G.advance(),!0):we===110?(G.lastIntValue=10,G.advance(),!0):we===118?(G.lastIntValue=11,G.advance(),!0):we===102?(G.lastIntValue=12,G.advance(),!0):we===114?(G.lastIntValue=13,G.advance(),!0):!1},Qi.regexp_eatControlLetter=function(G){var we=G.current();return qt(we)?(G.lastIntValue=we%32,G.advance(),!0):!1};function qt(G){return G>=65&&G<=90||G>=97&&G<=122}Qi.regexp_eatRegExpUnicodeEscapeSequence=function(G,we){we===void 0&&(we=!1);var at=G.pos,Ct=we||G.switchU;if(G.eat(117)){if(this.regexp_eatFixedHexDigits(G,4)){var Yt=G.lastIntValue;if(Ct&&Yt>=55296&&Yt<=56319){var Ii=G.pos;if(G.eat(92)&&G.eat(117)&&this.regexp_eatFixedHexDigits(G,4)){var Li=G.lastIntValue;if(Li>=56320&&Li<=57343)return G.lastIntValue=(Yt-55296)*1024+(Li-56320)+65536,!0}G.pos=Ii,G.lastIntValue=Yt}return!0}if(Ct&&G.eat(123)&&this.regexp_eatHexDigits(G)&&G.eat(125)&&kn(G.lastIntValue))return!0;Ct&&G.raise("Invalid unicode escape"),G.pos=at}return!1};function kn(G){return G>=0&&G<=1114111}Qi.regexp_eatIdentityEscape=function(G){if(G.switchU)return this.regexp_eatSyntaxCharacter(G)?!0:G.eat(47)?(G.lastIntValue=47,!0):!1;var we=G.current();return we!==99&&(!G.switchN||we!==107)?(G.lastIntValue=we,G.advance(),!0):!1},Qi.regexp_eatDecimalEscape=function(G){G.lastIntValue=0;var we=G.current();if(we>=49&&we<=57){do G.lastIntValue=10*G.lastIntValue+(we-48),G.advance();while((we=G.current())>=48&&we<=57);return!0}return!1};var Ar=0,js=1,Qr=2;Qi.regexp_eatCharacterClassEscape=function(G){var we=G.current();if(Gt(we))return G.lastIntValue=-1,G.advance(),js;var at=!1;if(G.switchU&&this.options.ecmaVersion>=9&&((at=we===80)||we===112)){G.lastIntValue=-1,G.advance();var Ct;if(G.eat(123)&&(Ct=this.regexp_eatUnicodePropertyValueExpression(G))&&G.eat(125))return at&&Ct===Qr&&G.raise("Invalid property name"),Ct;G.raise("Invalid property name")}return Ar};function Gt(G){return G===100||G===68||G===115||G===83||G===119||G===87}Qi.regexp_eatUnicodePropertyValueExpression=function(G){var we=G.pos;if(this.regexp_eatUnicodePropertyName(G)&&G.eat(61)){var at=G.lastStringValue;if(this.regexp_eatUnicodePropertyValue(G)){var Ct=G.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(G,at,Ct),js}}if(G.pos=we,this.regexp_eatLoneUnicodePropertyNameOrValue(G)){var Yt=G.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(G,Yt)}return Ar},Qi.regexp_validateUnicodePropertyNameAndValue=function(G,we,at){ct(G.unicodeProperties.nonBinary,we)||G.raise("Invalid property name"),G.unicodeProperties.nonBinary[we].test(at)||G.raise("Invalid property value")},Qi.regexp_validateUnicodePropertyNameOrValue=function(G,we){if(G.unicodeProperties.binary.test(we))return js;if(G.switchV&&G.unicodeProperties.binaryOfStrings.test(we))return Qr;G.raise("Invalid property name")},Qi.regexp_eatUnicodePropertyName=function(G){var we=0;for(G.lastStringValue="";fr(we=G.current());)G.lastStringValue+=yi(we),G.advance();return G.lastStringValue!==""};function fr(G){return qt(G)||G===95}Qi.regexp_eatUnicodePropertyValue=function(G){var we=0;for(G.lastStringValue="";Bt(we=G.current());)G.lastStringValue+=yi(we),G.advance();return G.lastStringValue!==""};function Bt(G){return fr(G)||Fr(G)}Qi.regexp_eatLoneUnicodePropertyNameOrValue=function(G){return this.regexp_eatUnicodePropertyValue(G)},Qi.regexp_eatCharacterClass=function(G){if(G.eat(91)){var we=G.eat(94),at=this.regexp_classContents(G);return G.eat(93)||G.raise("Unterminated character class"),we&&at===Qr&&G.raise("Negated character class may contain strings"),!0}return!1},Qi.regexp_classContents=function(G){return G.current()===93?js:G.switchV?this.regexp_classSetExpression(G):(this.regexp_nonEmptyClassRanges(G),js)},Qi.regexp_nonEmptyClassRanges=function(G){for(;this.regexp_eatClassAtom(G);){var we=G.lastIntValue;if(G.eat(45)&&this.regexp_eatClassAtom(G)){var at=G.lastIntValue;G.switchU&&(we===-1||at===-1)&&G.raise("Invalid character class"),we!==-1&&at!==-1&&we>at&&G.raise("Range out of order in character class")}}},Qi.regexp_eatClassAtom=function(G){var we=G.pos;if(G.eat(92)){if(this.regexp_eatClassEscape(G))return!0;if(G.switchU){var at=G.current();(at===99||Qa(at))&&G.raise("Invalid class escape"),G.raise("Invalid escape")}G.pos=we}var Ct=G.current();return Ct!==93?(G.lastIntValue=Ct,G.advance(),!0):!1},Qi.regexp_eatClassEscape=function(G){var we=G.pos;if(G.eat(98))return G.lastIntValue=8,!0;if(G.switchU&&G.eat(45))return G.lastIntValue=45,!0;if(!G.switchU&&G.eat(99)){if(this.regexp_eatClassControlLetter(G))return!0;G.pos=we}return this.regexp_eatCharacterClassEscape(G)||this.regexp_eatCharacterEscape(G)},Qi.regexp_classSetExpression=function(G){var we=js,at;if(!this.regexp_eatClassSetRange(G))if(at=this.regexp_eatClassSetOperand(G)){at===Qr&&(we=Qr);for(var Ct=G.pos;G.eatChars([38,38]);){if(G.current()!==38&&(at=this.regexp_eatClassSetOperand(G))){at!==Qr&&(we=js);continue}G.raise("Invalid character in character class")}if(Ct!==G.pos)return we;for(;G.eatChars([45,45]);)this.regexp_eatClassSetOperand(G)||G.raise("Invalid character in character class");if(Ct!==G.pos)return we}else G.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(G)){if(at=this.regexp_eatClassSetOperand(G),!at)return we;at===Qr&&(we=Qr)}},Qi.regexp_eatClassSetRange=function(G){var we=G.pos;if(this.regexp_eatClassSetCharacter(G)){var at=G.lastIntValue;if(G.eat(45)&&this.regexp_eatClassSetCharacter(G)){var Ct=G.lastIntValue;return at!==-1&&Ct!==-1&&at>Ct&&G.raise("Range out of order in character class"),!0}G.pos=we}return!1},Qi.regexp_eatClassSetOperand=function(G){return this.regexp_eatClassSetCharacter(G)?js:this.regexp_eatClassStringDisjunction(G)||this.regexp_eatNestedClass(G)},Qi.regexp_eatNestedClass=function(G){var we=G.pos;if(G.eat(91)){var at=G.eat(94),Ct=this.regexp_classContents(G);if(G.eat(93))return at&&Ct===Qr&&G.raise("Negated character class may contain strings"),Ct;G.pos=we}if(G.eat(92)){var Yt=this.regexp_eatCharacterClassEscape(G);if(Yt)return Yt;G.pos=we}return null},Qi.regexp_eatClassStringDisjunction=function(G){var we=G.pos;if(G.eatChars([92,113])){if(G.eat(123)){var at=this.regexp_classStringDisjunctionContents(G);if(G.eat(125))return at}else G.raise("Invalid escape");G.pos=we}return null},Qi.regexp_classStringDisjunctionContents=function(G){for(var we=this.regexp_classString(G);G.eat(124);)this.regexp_classString(G)===Qr&&(we=Qr);return we},Qi.regexp_classString=function(G){for(var we=0;this.regexp_eatClassSetCharacter(G);)we++;return we===1?js:Qr},Qi.regexp_eatClassSetCharacter=function(G){var we=G.pos;if(G.eat(92))return this.regexp_eatCharacterEscape(G)||this.regexp_eatClassSetReservedPunctuator(G)?!0:G.eat(98)?(G.lastIntValue=8,!0):(G.pos=we,!1);var at=G.current();return at<0||at===G.lookahead()&&Gr(at)||Zs(at)?!1:(G.advance(),G.lastIntValue=at,!0)};function Gr(G){return G===33||G>=35&&G<=38||G>=42&&G<=44||G===46||G>=58&&G<=64||G===94||G===96||G===126}function Zs(G){return G===40||G===41||G===45||G===47||G>=91&&G<=93||G>=123&&G<=125}Qi.regexp_eatClassSetReservedPunctuator=function(G){var we=G.current();return pa(we)?(G.lastIntValue=we,G.advance(),!0):!1};function pa(G){return G===33||G===35||G===37||G===38||G===44||G===45||G>=58&&G<=62||G===64||G===96||G===126}Qi.regexp_eatClassControlLetter=function(G){var we=G.current();return Fr(we)||we===95?(G.lastIntValue=we%32,G.advance(),!0):!1},Qi.regexp_eatHexEscapeSequence=function(G){var we=G.pos;if(G.eat(120)){if(this.regexp_eatFixedHexDigits(G,2))return!0;G.switchU&&G.raise("Invalid escape"),G.pos=we}return!1},Qi.regexp_eatDecimalDigits=function(G){var we=G.pos,at=0;for(G.lastIntValue=0;Fr(at=G.current());)G.lastIntValue=10*G.lastIntValue+(at-48),G.advance();return G.pos!==we};function Fr(G){return G>=48&&G<=57}Qi.regexp_eatHexDigits=function(G){var we=G.pos,at=0;for(G.lastIntValue=0;Za(at=G.current());)G.lastIntValue=16*G.lastIntValue+Oo(at),G.advance();return G.pos!==we};function Za(G){return G>=48&&G<=57||G>=65&&G<=70||G>=97&&G<=102}function Oo(G){return G>=65&&G<=70?10+(G-65):G>=97&&G<=102?10+(G-97):G-48}Qi.regexp_eatLegacyOctalEscapeSequence=function(G){if(this.regexp_eatOctalDigit(G)){var we=G.lastIntValue;if(this.regexp_eatOctalDigit(G)){var at=G.lastIntValue;we<=3&&this.regexp_eatOctalDigit(G)?G.lastIntValue=we*64+at*8+G.lastIntValue:G.lastIntValue=we*8+at}else G.lastIntValue=we;return!0}return!1},Qi.regexp_eatOctalDigit=function(G){var we=G.current();return Qa(we)?(G.lastIntValue=we-48,G.advance(),!0):(G.lastIntValue=0,!1)};function Qa(G){return G>=48&&G<=55}Qi.regexp_eatFixedHexDigits=function(G,we){var at=G.pos;G.lastIntValue=0;for(var Ct=0;Ct<we;++Ct){var Yt=G.current();if(!Za(Yt))return G.pos=at,!1;G.lastIntValue=16*G.lastIntValue+Oo(Yt),G.advance()}return!0};var ia=function(we){this.type=we.type,this.value=we.value,this.start=we.start,this.end=we.end,we.options.locations&&(this.loc=new Ni(we,we.startLoc,we.endLoc)),we.options.ranges&&(this.range=[we.start,we.end])},Qn=b.prototype;Qn.next=function(G){!G&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new ia(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Qn.getToken=function(){return this.next(),new ia(this)},typeof Symbol<"u"&&(Qn[Symbol.iterator]=function(){var G=this;return{next:function(){var we=G.getToken();return{done:we.type===Ue.eof,value:we}}}}),Qn.nextToken=function(){var G=this.curContext();if((!G||!G.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(Ue.eof);if(G.override)return G.override(this);this.readToken(this.fullCharCodeAtPos())},Qn.readToken=function(G){return Ze(G,this.options.ecmaVersion>=6)||G===92?this.readWord():this.getTokenFromCode(G)},Qn.fullCharCodeAtPos=function(){var G=this.input.charCodeAt(this.pos);if(G<=55295||G>=56320)return G;var we=this.input.charCodeAt(this.pos+1);return we<=56319||we>=57344?G:(G<<10)+we-56613888},Qn.skipBlockComment=function(){var G=this.options.onComment&&this.curPosition(),we=this.pos,at=this.input.indexOf("*/",this.pos+=2);if(at===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=at+2,this.options.locations)for(var Ct=void 0,Yt=we;(Ct=At(this.input,Yt,this.pos))>-1;)++this.curLine,Yt=this.lineStart=Ct;this.options.onComment&&this.options.onComment(!0,this.input.slice(we+2,at),we,this.pos,G,this.curPosition())},Qn.skipLineComment=function(G){for(var we=this.pos,at=this.options.onComment&&this.curPosition(),Ct=this.input.charCodeAt(this.pos+=G);this.pos<this.input.length&&!gt(Ct);)Ct=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(we+G,this.pos),we,this.pos,at,this.curPosition())},Qn.skipSpace=function(){e:for(;this.pos<this.input.length;){var G=this.input.charCodeAt(this.pos);switch(G){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(G>8&&G<14||G>=5760&&yt.test(String.fromCharCode(G)))++this.pos;else break e}}},Qn.finishToken=function(G,we){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var at=this.type;this.type=G,this.value=we,this.updateContext(at)},Qn.readToken_dot=function(){var G=this.input.charCodeAt(this.pos+1);if(G>=48&&G<=57)return this.readNumber(!0);var we=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&G===46&&we===46?(this.pos+=3,this.finishToken(Ue.ellipsis)):(++this.pos,this.finishToken(Ue.dot))},Qn.readToken_slash=function(){var G=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):G===61?this.finishOp(Ue.assign,2):this.finishOp(Ue.slash,1)},Qn.readToken_mult_modulo_exp=function(G){var we=this.input.charCodeAt(this.pos+1),at=1,Ct=G===42?Ue.star:Ue.modulo;return this.options.ecmaVersion>=7&&G===42&&we===42&&(++at,Ct=Ue.starstar,we=this.input.charCodeAt(this.pos+2)),we===61?this.finishOp(Ue.assign,at+1):this.finishOp(Ct,at)},Qn.readToken_pipe_amp=function(G){var we=this.input.charCodeAt(this.pos+1);if(we===G){if(this.options.ecmaVersion>=12){var at=this.input.charCodeAt(this.pos+2);if(at===61)return this.finishOp(Ue.assign,3)}return this.finishOp(G===124?Ue.logicalOR:Ue.logicalAND,2)}return we===61?this.finishOp(Ue.assign,2):this.finishOp(G===124?Ue.bitwiseOR:Ue.bitwiseAND,1)},Qn.readToken_caret=function(){var G=this.input.charCodeAt(this.pos+1);return G===61?this.finishOp(Ue.assign,2):this.finishOp(Ue.bitwiseXOR,1)},Qn.readToken_plus_min=function(G){var we=this.input.charCodeAt(this.pos+1);return we===G?we===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||$t.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(Ue.incDec,2):we===61?this.finishOp(Ue.assign,2):this.finishOp(Ue.plusMin,1)},Qn.readToken_lt_gt=function(G){var we=this.input.charCodeAt(this.pos+1),at=1;return we===G?(at=G===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+at)===61?this.finishOp(Ue.assign,at+1):this.finishOp(Ue.bitShift,at)):we===33&&G===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(we===61&&(at=2),this.finishOp(Ue.relational,at))},Qn.readToken_eq_excl=function(G){var we=this.input.charCodeAt(this.pos+1);return we===61?this.finishOp(Ue.equality,this.input.charCodeAt(this.pos+2)===61?3:2):G===61&&we===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Ue.arrow)):this.finishOp(G===61?Ue.eq:Ue.prefix,1)},Qn.readToken_question=function(){var G=this.options.ecmaVersion;if(G>=11){var we=this.input.charCodeAt(this.pos+1);if(we===46){var at=this.input.charCodeAt(this.pos+2);if(at<48||at>57)return this.finishOp(Ue.questionDot,2)}if(we===63){if(G>=12){var Ct=this.input.charCodeAt(this.pos+2);if(Ct===61)return this.finishOp(Ue.assign,3)}return this.finishOp(Ue.coalesce,2)}}return this.finishOp(Ue.question,1)},Qn.readToken_numberSign=function(){var G=this.options.ecmaVersion,we=35;if(G>=13&&(++this.pos,we=this.fullCharCodeAtPos(),Ze(we,!0)||we===92))return this.finishToken(Ue.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+yi(we)+"'")},Qn.getTokenFromCode=function(G){switch(G){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Ue.parenL);case 41:return++this.pos,this.finishToken(Ue.parenR);case 59:return++this.pos,this.finishToken(Ue.semi);case 44:return++this.pos,this.finishToken(Ue.comma);case 91:return++this.pos,this.finishToken(Ue.bracketL);case 93:return++this.pos,this.finishToken(Ue.bracketR);case 123:return++this.pos,this.finishToken(Ue.braceL);case 125:return++this.pos,this.finishToken(Ue.braceR);case 58:return++this.pos,this.finishToken(Ue.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Ue.backQuote);case 48:var we=this.input.charCodeAt(this.pos+1);if(we===120||we===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(we===111||we===79)return this.readRadixNumber(8);if(we===98||we===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(G);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(G);case 124:case 38:return this.readToken_pipe_amp(G);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(G);case 60:case 62:return this.readToken_lt_gt(G);case 61:case 33:return this.readToken_eq_excl(G);case 63:return this.readToken_question();case 126:return this.finishOp(Ue.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+yi(G)+"'")},Qn.finishOp=function(G,we){var at=this.input.slice(this.pos,this.pos+we);return this.pos+=we,this.finishToken(G,at)},Qn.readRegexp=function(){for(var G,we,at=this.pos;;){this.pos>=this.input.length&&this.raise(at,"Unterminated regular expression");var Ct=this.input.charAt(this.pos);if($t.test(Ct)&&this.raise(at,"Unterminated regular expression"),G)G=!1;else{if(Ct==="[")we=!0;else if(Ct==="]"&&we)we=!1;else if(Ct==="/"&&!we)break;G=Ct==="\\"}++this.pos}var Yt=this.input.slice(at,this.pos);++this.pos;var Ii=this.pos,Li=this.readWord1();this.containsEsc&&this.unexpected(Ii);var An=this.regexpState||(this.regexpState=new hr(this));An.reset(at,Yt,Li),this.validateRegExpFlags(An),this.validateRegExpPattern(An);var pn=null;try{pn=new RegExp(Yt,Li)}catch{}return this.finishToken(Ue.regexp,{pattern:Yt,flags:Li,value:pn})},Qn.readInt=function(G,we,at){for(var Ct=this.options.ecmaVersion>=12&&we===void 0,Yt=at&&this.input.charCodeAt(this.pos)===48,Ii=this.pos,Li=0,An=0,pn=0,or=we??1/0;pn<or;++pn,++this.pos){var dr=this.input.charCodeAt(this.pos),qr=void 0;if(Ct&&dr===95){Yt&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),An===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),pn===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),An=dr;continue}if(dr>=97?qr=dr-97+10:dr>=65?qr=dr-65+10:dr>=48&&dr<=57?qr=dr-48:qr=1/0,qr>=G)break;An=dr,Li=Li*G+qr}return Ct&&An===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ii||we!=null&&this.pos-Ii!==we?null:Li};function Aa(G,we){return we?parseInt(G,8):parseFloat(G.replace(/_/g,""))}function ds(G){return typeof BigInt!="function"?null:BigInt(G.replace(/_/g,""))}Qn.readRadixNumber=function(G){var we=this.pos;this.pos+=2;var at=this.readInt(G);return at==null&&this.raise(this.start+2,"Expected number in radix "+G),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(at=ds(this.input.slice(we,this.pos)),++this.pos):Ze(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Ue.num,at)},Qn.readNumber=function(G){var we=this.pos;!G&&this.readInt(10,void 0,!0)===null&&this.raise(we,"Invalid number");var at=this.pos-we>=2&&this.input.charCodeAt(we)===48;at&&this.strict&&this.raise(we,"Invalid number");var Ct=this.input.charCodeAt(this.pos);if(!at&&!G&&this.options.ecmaVersion>=11&&Ct===110){var Yt=ds(this.input.slice(we,this.pos));return++this.pos,Ze(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Ue.num,Yt)}at&&/[89]/.test(this.input.slice(we,this.pos))&&(at=!1),Ct===46&&!at&&(++this.pos,this.readInt(10),Ct=this.input.charCodeAt(this.pos)),(Ct===69||Ct===101)&&!at&&(Ct=this.input.charCodeAt(++this.pos),(Ct===43||Ct===45)&&++this.pos,this.readInt(10)===null&&this.raise(we,"Invalid number")),Ze(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ii=Aa(this.input.slice(we,this.pos),at);return this.finishToken(Ue.num,Ii)},Qn.readCodePoint=function(){var G=this.input.charCodeAt(this.pos),we;if(G===123){this.options.ecmaVersion<6&&this.unexpected();var at=++this.pos;we=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,we>1114111&&this.invalidStringToken(at,"Code point out of bounds")}else we=this.readHexChar(4);return we},Qn.readString=function(G){for(var we="",at=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var Ct=this.input.charCodeAt(this.pos);if(Ct===G)break;Ct===92?(we+=this.input.slice(at,this.pos),we+=this.readEscapedChar(!1),at=this.pos):Ct===8232||Ct===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(gt(Ct)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return we+=this.input.slice(at,this.pos++),this.finishToken(Ue.string,we)};var Wa={};Qn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(G){if(G===Wa)this.readInvalidTemplateToken();else throw G}this.inTemplateElement=!1},Qn.invalidStringToken=function(G,we){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Wa;this.raise(G,we)},Qn.readTmplToken=function(){for(var G="",we=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var at=this.input.charCodeAt(this.pos);if(at===96||at===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===Ue.template||this.type===Ue.invalidTemplate)?at===36?(this.pos+=2,this.finishToken(Ue.dollarBraceL)):(++this.pos,this.finishToken(Ue.backQuote)):(G+=this.input.slice(we,this.pos),this.finishToken(Ue.template,G));if(at===92)G+=this.input.slice(we,this.pos),G+=this.readEscapedChar(!0),we=this.pos;else if(gt(at)){switch(G+=this.input.slice(we,this.pos),++this.pos,at){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:G+=`
`;break;default:G+=String.fromCharCode(at);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),we=this.pos}else++this.pos}},Qn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(Ue.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Qn.readEscapedChar=function(G){var we=this.input.charCodeAt(++this.pos);switch(++this.pos,we){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return yi(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),G){var at=this.pos-1;this.invalidStringToken(at,"Invalid escape sequence in template string")}default:if(we>=48&&we<=55){var Ct=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],Yt=parseInt(Ct,8);return Yt>255&&(Ct=Ct.slice(0,-1),Yt=parseInt(Ct,8)),this.pos+=Ct.length-1,we=this.input.charCodeAt(this.pos),(Ct!=="0"||we===56||we===57)&&(this.strict||G)&&this.invalidStringToken(this.pos-1-Ct.length,G?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(Yt)}return gt(we)?"":String.fromCharCode(we)}},Qn.readHexChar=function(G){var we=this.pos,at=this.readInt(16,G);return at===null&&this.invalidStringToken(we,"Bad character escape sequence"),at},Qn.readWord1=function(){this.containsEsc=!1;for(var G="",we=!0,at=this.pos,Ct=this.options.ecmaVersion>=6;this.pos<this.input.length;){var Yt=this.fullCharCodeAtPos();if(nt(Yt,Ct))this.pos+=Yt<=65535?1:2;else if(Yt===92){this.containsEsc=!0,G+=this.input.slice(at,this.pos);var Ii=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Li=this.readCodePoint();(we?Ze:nt)(Li,Ct)||this.invalidStringToken(Ii,"Invalid Unicode escape"),G+=yi(Li),at=this.pos}else break;we=!1}return G+this.input.slice(at,this.pos)},Qn.readWord=function(){var G=this.readWord1(),we=Ue.name;return this.keywords.test(G)&&(we=zt[G]),this.finishToken(we,G)};var ol="8.11.3";b.acorn={Parser:b,version:ol,defaultOptions:Zi,Position:ki,SourceLocation:Ni,getLineInfo:tn,Node:De,TokenType:Ke,tokTypes:Ue,keywordTypes:zt,TokContext:ot,tokContexts:Pe,isIdentifierChar:nt,isIdentifierStart:Ze,Token:ia,isNewLine:gt,lineBreak:$t,lineBreakG:rt,nonASCIIwhitespace:yt};function ll(G,we){return b.parse(G,we)}function lo(G,we,at){return b.parseExpressionAt(G,we,at)}function $a(G,we){return b.tokenizer(G,we)}n.Node=De,n.Parser=b,n.Position=ki,n.SourceLocation=Ni,n.TokContext=ot,n.Token=ia,n.TokenType=Ke,n.defaultOptions=Zi,n.getLineInfo=tn,n.isIdentifierChar=nt,n.isIdentifierStart=Ze,n.isNewLine=gt,n.keywordTypes=zt,n.lineBreak=$t,n.lineBreakG=rt,n.nonASCIIwhitespace=yt,n.parse=ll,n.parseExpressionAt=lo,n.tokContexts=Pe,n.tokTypes=Ue,n.tokenizer=$a,n.version=ol})}(Wg,Wg.exports)),Wg.exports}/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(t){(function(e,n){e=e||Ix;var c=e.window,g=e.document,v=new function(){var b=/^(statics|enumerable|beans|preserve)$/,M=[],U=M.slice,K=Object.create,ie=Object.getOwnPropertyDescriptor,de=Object.defineProperty,be=M.forEach||function(We,Ge){for(var mt=0,ot=this.length;mt<ot;mt++)We.call(Ge,this[mt],mt,this)},Ee=function(We,Ge){for(var mt in this)this.hasOwnProperty(mt)&&We.call(Ge,this[mt],mt,this)},Ce=Object.assign||function(We){for(var Ge=1,mt=arguments.length;Ge<mt;Ge++){var ot=arguments[Ge];for(var Pe in ot)ot.hasOwnProperty(Pe)&&(We[Pe]=ot[Pe])}return We},Re=function(We,Ge,mt){if(We){var ot=ie(We,"length");(ot&&typeof ot.value=="number"?be:Ee).call(We,Ge,mt=mt||We)}return mt};function $e(We,Ge,mt,ot,Pe){var ae={};function re(ye,De){De=De||(De=ie(Ge,ye))&&(De.get?De:De.value),typeof De=="string"&&De[0]==="#"&&(De=We[De.substring(1)]||De);var Oe=typeof De=="function",Ve=De,Je=Pe||Oe&&!De.base?De&&De.get?ye in We:We[ye]:null,et;(!Pe||!Je)&&(Oe&&Je&&(De.base=Je),Oe&&ot!==!1&&(et=ye.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(ae[et[3].toLowerCase()+et[4]]=et[2]),(!Ve||Oe||!Ve.get||typeof Ve.get!="function"||!je.isPlainObject(Ve))&&(Ve={value:Ve,writable:!0}),(ie(We,ye)||{configurable:!0}).configurable&&(Ve.configurable=!0,Ve.enumerable=mt??!et),de(We,ye,Ve))}if(Ge){for(var X in Ge)Ge.hasOwnProperty(X)&&!b.test(X)&&re(X);for(var X in ae){var ne=ae[X],pe=We["set"+ne],xe=We["get"+ne]||pe&&We["is"+ne];xe&&(ot===!0||xe.length===0)&&re(X,{get:xe,set:pe})}}return We}function je(){for(var We=0,Ge=arguments.length;We<Ge;We++){var mt=arguments[We];mt&&Ce(this,mt)}return this}return $e(je,{inject:function(We){if(We){var Ge=We.statics===!0?We:We.statics,mt=We.beans,ot=We.preserve;Ge!==We&&$e(this.prototype,We,We.enumerable,mt,ot),$e(this,Ge,null,mt,ot)}for(var Pe=1,ae=arguments.length;Pe<ae;Pe++)this.inject(arguments[Pe]);return this},extend:function(){for(var We=this,Ge,mt,ot=0,Pe,ae=arguments.length;ot<ae&&!(Ge&&mt);ot++)Pe=arguments[ot],Ge=Ge||Pe.initialize,mt=mt||Pe.prototype;return Ge=Ge||function(){We.apply(this,arguments)},mt=Ge.prototype=mt||K(this.prototype),de(mt,"constructor",{value:Ge,writable:!0,configurable:!0}),$e(Ge,this),arguments.length&&this.inject.apply(Ge,arguments),Ge.base=We,Ge}}).inject({enumerable:!1,initialize:je,set:je,inject:function(){for(var We=0,Ge=arguments.length;We<Ge;We++){var mt=arguments[We];mt&&$e(this,mt,mt.enumerable,mt.beans,mt.preserve)}return this},extend:function(){var We=K(this);return We.inject.apply(We,arguments)},each:function(We,Ge){return Re(this,We,Ge)},clone:function(){return new this.constructor(this)},statics:{set:Ce,each:Re,create:K,define:de,describe:ie,clone:function(We){return Ce(new We.constructor,We)},isPlainObject:function(We){var Ge=We!=null&&We.constructor;return Ge&&(Ge===Object||Ge===je||Ge.name==="Object")},pick:function(We,Ge){return We!==n?We:Ge},slice:function(We,Ge,mt){return U.call(We,Ge,mt)}}})};t.exports=v,v.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+v.each(this,function(b,M){if(!/^_/.test(M)){var U=typeof b;this.push(M+": "+(U==="number"?he.instance.number(b):U==="string"?"'"+b+"'":b))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(b){return v.importJSON(b,this)},exportJSON:function(b){return v.exportJSON(this,b)},toJSON:function(){return v.serialize(this)},set:function(b,M){return b&&v.filter(this,b,M,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function b(){var M=b.base.apply(this,arguments),U=M.prototype._class;return U&&!v.exports[U]&&(v.exports[U]=M),M},equals:function(b,M){if(b===M)return!0;if(b&&b.equals)return b.equals(M);if(M&&M.equals)return M.equals(b);if(b&&M&&typeof b=="object"&&typeof M=="object"){if(Array.isArray(b)&&Array.isArray(M)){var U=b.length;if(U!==M.length)return!1;for(;U--;)if(!v.equals(b[U],M[U]))return!1}else{var K=Object.keys(b),U=K.length;if(U!==Object.keys(M).length)return!1;for(;U--;){var ie=K[U];if(!(M.hasOwnProperty(ie)&&v.equals(b[ie],M[ie])))return!1}}return!0}return!1},read:function(b,M,U,K){if(this===v){var ie=this.peek(b,M);return b.__index++,ie}var de=this.prototype,be=de._readIndex,Ee=M||be&&b.__index||0,Ce=b.length,Re=b[Ee];if(K=K||Ce-Ee,Re instanceof this||U&&U.readNull&&Re==null&&K<=1)return be&&(b.__index=Ee+1),Re&&U&&U.clone?Re.clone():Re;if(Re=v.create(de),be&&(Re.__read=!0),Re=Re.initialize.apply(Re,Ee>0||Ee+K<Ce?v.slice(b,Ee,Ee+K):b)||Re,be){b.__index=Ee+Re.__read;var $e=Re.__filtered;$e&&(b.__filtered=$e,Re.__filtered=n),Re.__read=n}return Re},peek:function(b,M){return b[b.__index=M||b.__index||0]},remain:function(b){return b.length-(b.__index||0)},readList:function(b,M,U,K){for(var ie=[],de,be=M||0,Ee=K?be+K:b.length,Ce=be;Ce<Ee;Ce++)ie.push(Array.isArray(de=b[Ce])?this.read(de,0,U):this.read(b,Ce,U,1));return ie},readNamed:function(b,M,U,K,ie){var de=this.getNamed(b,M),be=de!==n;if(be){var Ee=b.__filtered;if(!Ee){var Ce=this.getSource(b);Ee=b.__filtered=v.create(Ce),Ee.__unfiltered=Ce}Ee[M]=n}return this.read(be?[de]:b,U,K,ie)},readSupported:function(b,M){var U=this.getSource(b),K=this,ie=!1;return U&&Object.keys(U).forEach(function(de){if(de in M){var be=K.readNamed(b,de);be!==n&&(M[de]=be),ie=!0}}),ie},getSource:function(b){var M=b.__source;if(M===n){var U=b.length===1&&b[0];M=b.__source=U&&v.isPlainObject(U)?U:null}return M},getNamed:function(b,M){var U=this.getSource(b);if(U)return M?U[M]:b.__filtered||U},hasNamed:function(b,M){return!!this.getNamed(b,M)},filter:function(b,M,U,K){var ie;function de($e){if(!(U&&$e in U)&&!(ie&&$e in ie)){var je=M[$e];je!==n&&(b[$e]=je)}}if(K){for(var be={},Ee=0,Ce,Re=K.length;Ee<Re;Ee++)(Ce=K[Ee])in M&&(de(Ce),be[Ce]=!0);ie=be}return Object.keys(M.__unfiltered||M).forEach(de),b},isPlainValue:function(b,M){return v.isPlainObject(b)||Array.isArray(b)||M&&typeof b=="string"},serialize:function(b,M,U,K){M=M||{};var ie=!K,de;if(ie&&(M.formatter=new he(M.precision),K={length:0,definitions:{},references:{},add:function(je,We){var Ge="#"+je._id,mt=this.references[Ge];if(!mt){this.length++;var ot=We.call(je),Pe=je._class;Pe&&ot[0]!==Pe&&ot.unshift(Pe),this.definitions[Ge]=ot,mt=this.references[Ge]=[Ge]}return mt}}),b&&b._serialize){de=b._serialize(M,K);var be=b._class;be&&!b._compactSerialize&&(ie||!U)&&de[0]!==be&&de.unshift(be)}else if(Array.isArray(b)){de=[];for(var Ee=0,Ce=b.length;Ee<Ce;Ee++)de[Ee]=v.serialize(b[Ee],M,U,K)}else if(v.isPlainObject(b)){de={};for(var Re=Object.keys(b),Ee=0,Ce=Re.length;Ee<Ce;Ee++){var $e=Re[Ee];de[$e]=v.serialize(b[$e],M,U,K)}}else typeof b=="number"?de=M.formatter.number(b,M.precision):de=b;return ie&&K.length>0?[["dictionary",K.definitions],de]:de},deserialize:function(b,M,U,K,ie){var de=b,be=!U,Ee=be&&b&&b.length&&b[0][0]==="dictionary";if(U=U||{},Array.isArray(b)){var Ce=b[0],Re=Ce==="dictionary";if(b.length==1&&/^#/.test(Ce))return U.dictionary[Ce];Ce=v.exports[Ce],de=[];for(var $e=Ce?1:0,je=b.length;$e<je;$e++)de.push(v.deserialize(b[$e],M,U,Re,Ee));if(Ce){var We=de;M?de=M(Ce,We,be||ie):de=new Ce(We)}}else if(v.isPlainObject(b)){de={},K&&(U.dictionary=de);for(var Ge in b)de[Ge]=v.deserialize(b[Ge],M,U)}return Ee?de[1]:de},exportJSON:function(b,M){var U=v.serialize(b,M);return M&&M.asString==!1?U:JSON.stringify(U)},importJSON:function(b,M){return v.deserialize(typeof b=="string"?JSON.parse(b):b,function(U,K,ie){var de=ie&&M&&M.constructor===U,be=de?M:v.create(U.prototype);if(K.length===1&&be instanceof Ue&&(de||!(be instanceof rt))){var Ee=K[0];v.isPlainObject(Ee)&&(Ee.insert=!1,de&&(K=K.concat([Ue.INSERT])))}return(de?be.set:U).apply(be,K),de&&(M=null),be})},push:function(b,M){var U=M.length;if(U<4096)b.push.apply(b,M);else{var K=b.length;b.length+=U;for(var ie=0;ie<U;ie++)b[K+ie]=M[ie]}return b},splice:function(b,M,U,K){var ie=M&&M.length,de=U===n;U=de?b.length:U,U>b.length&&(U=b.length);for(var be=0;be<ie;be++)M[be]._index=U+be;if(de)return v.push(b,M),[];var Ee=[U,K];M&&v.push(Ee,M);for(var Ce=b.splice.apply(b,Ee),be=0,Re=Ce.length;be<Re;be++)Ce[be]._index=n;for(var be=U+ie,Re=b.length;be<Re;be++)b[be]._index=be;return Ce},capitalize:function(b){return b.replace(/\b[a-z]/g,function(M){return M.toUpperCase()})},camelize:function(b){return b.replace(/-(.)/g,function(M,U){return U.toUpperCase()})},hyphenate:function(b){return b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var S={on:function(b,M){if(typeof b!="string")v.each(b,function(de,be){this.on(be,de)},this);else{var U=this._eventTypes,K=U&&U[b],ie=this._callbacks=this._callbacks||{};ie=ie[b]=ie[b]||[],ie.indexOf(M)===-1&&(ie.push(M),K&&K.install&&ie.length===1&&K.install.call(this,b))}return this},off:function(b,M){if(typeof b!="string"){v.each(b,function(be,Ee){this.off(Ee,be)},this);return}var U=this._eventTypes,K=U&&U[b],ie=this._callbacks&&this._callbacks[b],de;return ie&&(!M||(de=ie.indexOf(M))!==-1&&ie.length===1?(K&&K.uninstall&&K.uninstall.call(this,b),delete this._callbacks[b]):de!==-1&&ie.splice(de,1)),this},once:function(b,M){return this.on(b,function U(){M.apply(this,arguments),this.off(b,U)})},emit:function(b,M){var U=this._callbacks&&this._callbacks[b];if(!U)return!1;var K=v.slice(arguments,1),ie=M&&M.target&&!M.currentTarget;U=U.slice(),ie&&(M.currentTarget=this);for(var de=0,be=U.length;de<be;de++)if(U[de].apply(this,K)==!1){M&&M.stop&&M.stop();break}return ie&&delete M.currentTarget,!0},responds:function(b){return!!(this._callbacks&&this._callbacks[b])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(b){var M=this._eventTypes,U=this._callbacks,K=b?"install":"uninstall";if(M){for(var ie in U)if(U[ie].length>0){var de=M[ie],be=de&&de[K];be&&be.call(this,ie)}}},statics:{inject:function b(M){var U=M._events;if(U){var K={};v.each(U,function(ie,de){var be=typeof ie=="string",Ee=be?ie:de,Ce=v.capitalize(Ee),Re=Ee.substring(2).toLowerCase();K[Re]=be?{}:ie,Ee="_"+Ee,M["get"+Ce]=function(){return this[Ee]},M["set"+Ce]=function($e){var je=this[Ee];je&&this.off(Re,je),$e&&this.on(Re,$e),this[Ee]=$e}}),M._eventTypes=K}return b.base.apply(this,arguments)}}},a=v.extend({_class:"PaperScope",initialize:function b(){_n=this,this.settings=new v({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=b._id++,b._scopes[this._id]=this;var M=b.prototype;if(!this.support){var U=Yi.getContext(1,1)||{};M.support={nativeDash:"setLineDash"in U||"mozDash"in U,nativeBlendModes:Xn.nativeModes},Yi.release(U)}if(!this.agent){var K=e.navigator.userAgent.toLowerCase(),ie=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(K)||[])[0],de=ie==="darwin"?"mac":ie,be=M.agent=M.browser={platform:de};de&&(be[de]=!0),K.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(Ee,Ce,Re,$e,je){if(!be.chrome){var We=Ce==="opera"?$e:/^(node|trident)$/.test(Ce)?je:Re;be.version=We,be.versionNumber=parseFloat(We),Ce={trident:"msie",jsdom:"node"}[Ce]||Ce,be.name=Ce,be[Ce]=!0}}),be.chrome&&delete be.webkit,be.atom&&delete be.chrome}},version:"0.12.17",getView:function(){var b=this.project;return b&&b._view},getPaper:function(){return this},execute:function(b,M){var U=_n.PaperScript.execute(b,this,M);return Oi.updateFocus(),U},install:function(b){var M=this;v.each(["project","view","tool"],function(K){v.define(b,K,{configurable:!0,get:function(){return M[K]}})});for(var U in this)!/^_/.test(U)&&this[U]&&(b[U]=this[U])},setup:function(b){return _n=this,this.project=new Mt(b),this},createCanvas:function(b,M){return Yi.getCanvas(b,M)},activate:function(){_n=this},clear:function(){for(var b=this.projects,M=this.tools,U=b.length-1;U>=0;U--)b[U].remove();for(var U=M.length-1;U>=0;U--)M[U].remove()},remove:function(){this.clear(),delete a._scopes[this._id]},statics:new function(){function b(M){return M+="Attribute",function(U,K){return U[M](K)||U[M]("data-paper-"+K)}}return{_scopes:{},_id:0,get:function(M){return this._scopes[M]||null},getAttribute:b("get"),hasAttribute:b("has")}}}),N=v.extend(S,{initialize:function(b){this._scope=_n,this._index=this._scope[this._list].push(this)-1,(b||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var b=this._scope[this._reference];return b&&b!==this&&b.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",b),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(v.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),$={findItemBoundsCollisions:function(b,M,U){function K(be){for(var Ee=new Array(be.length),Ce=0;Ce<be.length;Ce++){var Re=be[Ce].getBounds();Ee[Ce]=[Re.left,Re.top,Re.right,Re.bottom]}return Ee}var ie=K(b),de=!M||M===b?ie:K(M);return this.findBoundsCollisions(ie,de,U||0)},findCurveBoundsCollisions:function(b,M,U,K){function ie(We){for(var Ge=Math.min,mt=Math.max,ot=new Array(We.length),Pe=0;Pe<We.length;Pe++){var ae=We[Pe];ot[Pe]=[Ge(ae[0],ae[2],ae[4],ae[6]),Ge(ae[1],ae[3],ae[5],ae[7]),mt(ae[0],ae[2],ae[4],ae[6]),mt(ae[1],ae[3],ae[5],ae[7])]}return ot}var de=ie(b),be=!M||M===b?de:ie(M);if(K){for(var Ee=this.findBoundsCollisions(de,be,U||0,!1,!0),Ce=this.findBoundsCollisions(de,be,U||0,!0,!0),Re=[],$e=0,je=Ee.length;$e<je;$e++)Re[$e]={hor:Ee[$e],ver:Ce[$e]};return Re}return this.findBoundsCollisions(de,be,U||0)},findBoundsCollisions:function(b,M,U,K,ie){var de=!M||b===M,be=de?b:b.concat(M),Ee=b.length,Ce=be.length;function Re(li,di,fi){for(var ti=0,ui=li.length;ti<ui;){var Ri=ui+ti>>>1;be[li[Ri]][di]<fi?ti=Ri+1:ui=Ri}return ti-1}for(var $e=K?1:0,je=$e+2,We=K?0:1,Ge=We+2,mt=new Array(Ce),ot=0;ot<Ce;ot++)mt[ot]=ot;mt.sort(function(li,di){return be[li][$e]-be[di][$e]});for(var Pe=[],ae=new Array(Ee),ot=0;ot<Ce;ot++){var re=mt[ot],X=be[re],ne=de?re:re-Ee,pe=re<Ee,xe=de||!pe,ye=pe?[]:null;if(Pe.length){var De=Re(Pe,je,X[$e]-U)+1;if(Pe.splice(0,De),de&&ie){ye=ye.concat(Pe);for(var Oe=0;Oe<Pe.length;Oe++){var Ve=Pe[Oe];ae[Ve].push(ne)}}else for(var Je=X[Ge],et=X[We],Oe=0;Oe<Pe.length;Oe++){var Ve=Pe[Oe],Le=be[Ve],qe=Ve<Ee,dt=de||Ve>=Ee;(ie||(pe&&dt||xe&&qe)&&Je>=Le[We]-U&&et<=Le[Ge]+U)&&(pe&&dt&&ye.push(de?Ve:Ve-Ee),xe&&qe&&ae[Ve].push(ne))}}if(pe&&(b===M&&ye.push(re),ae[re]=ye),Pe.length){var Pt=X[je],o=Re(Pe,je,Pt);Pe.splice(o+1,0,re)}else Pe.push(re)}for(var ot=0;ot<ae.length;ot++){var Me=ae[ot];Me&&Me.sort(function(di,fi){return di-fi})}return ae}},he=v.extend({initialize:function(b){this.precision=v.pick(b,5),this.multiplier=Math.pow(10,this.precision)},number:function(b){return this.precision<16?Math.round(b*this.multiplier)/this.multiplier:b},pair:function(b,M,U){return this.number(b)+(U||",")+this.number(M)},point:function(b,M){return this.number(b.x)+(M||",")+this.number(b.y)},size:function(b,M){return this.number(b.width)+(M||",")+this.number(b.height)},rectangle:function(b,M){return this.point(b,M)+(M||",")+this.size(b,M)}});he.instance=new he;var oe=new function(){var b=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],M=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],U=Math.abs,K=Math.sqrt,ie=Math.pow,de=Math.log2||function(je){return Math.log(je)*Math.LOG2E},be=1e-12,Ee=112e-18;function Ce(je,We,Ge){return je<We?We:je>Ge?Ge:je}function Re(je,We,Ge){function mt(De){var Oe=De*134217729,Ve=De-Oe,Je=Ve+Oe,et=De-Je;return[Je,et]}var ot=We*We-je*Ge,Pe=We*We+je*Ge;if(U(ot)*3<Pe){var ae=mt(je),re=mt(We),X=mt(Ge),ne=We*We,pe=re[0]*re[0]-ne+2*re[0]*re[1]+re[1]*re[1],xe=je*Ge,ye=ae[0]*X[0]-xe+ae[0]*X[1]+ae[1]*X[0]+ae[1]*X[1];ot=ne-xe+(pe-ye)}return ot}function $e(){var je=Math.max.apply(Math,arguments);return je&&(je<1e-8||je>1e8)?ie(2,-Math.round(de(je))):0}return{EPSILON:be,MACHINE_EPSILON:Ee,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(K(2)-1)/3,isZero:function(je){return je>=-be&&je<=be},isMachineZero:function(je){return je>=-Ee&&je<=Ee},clamp:Ce,integrate:function(je,We,Ge,mt){for(var ot=b[mt-2],Pe=M[mt-2],ae=(Ge-We)*.5,re=ae+We,X=0,ne=mt+1>>1,pe=mt&1?Pe[X++]*je(re):0;X<ne;){var xe=ae*ot[X];pe+=Pe[X++]*(je(re+xe)+je(re-xe))}return ae*pe},findRoot:function(je,We,Ge,mt,ot,Pe,ae){for(var re=0;re<Pe;re++){var X=je(Ge),ne=X/We(Ge),pe=Ge-ne;if(U(ne)<ae){Ge=pe;break}X>0?(ot=Ge,Ge=pe<=mt?(mt+ot)*.5:pe):(mt=Ge,Ge=pe>=ot?(mt+ot)*.5:pe)}return Ce(Ge,mt,ot)},solveQuadratic:function(je,We,Ge,mt,ot,Pe){var ae,re=1/0;if(U(je)<be){if(U(We)<be)return U(Ge)<be?-1:0;ae=-Ge/We}else{We*=-.5;var X=Re(je,We,Ge);if(X&&U(X)<Ee){var ne=$e(U(je),U(We),U(Ge));ne&&(je*=ne,We*=ne,Ge*=ne,X=Re(je,We,Ge))}if(X>=-Ee){var pe=X<0?0:K(X),xe=We+(We<0?-pe:pe);xe===0?(ae=Ge/je,re=-ae):(ae=xe/je,re=Ge/xe)}}var ye=0,De=ot==null,Oe=ot-be,Ve=Pe+be;return isFinite(ae)&&(De||ae>Oe&&ae<Ve)&&(mt[ye++]=De?ae:Ce(ae,ot,Pe)),re!==ae&&isFinite(re)&&(De||re>Oe&&re<Ve)&&(mt[ye++]=De?re:Ce(re,ot,Pe)),ye},solveCubic:function(je,We,Ge,mt,ot,Pe,ae){var re=$e(U(je),U(We),U(Ge),U(mt)),X,ne,pe,xe,ye;re&&(je*=re,We*=re,Ge*=re,mt*=re);function De(o){X=o;var Me=je*X;ne=Me+We,pe=ne*X+Ge,xe=(Me+ne)*X+pe,ye=pe*X+mt}if(U(je)<be)je=We,ne=Ge,pe=mt,X=1/0;else if(U(mt)<be)ne=We,pe=Ge,X=0;else{De(-(We/je)/3);var Oe=ye/je,Ve=ie(U(Oe),1/3),Je=Oe<0?-1:1,et=-xe/je,Le=et>0?1.324717957244746*Math.max(Ve,K(et)):Ve,qe=X-Je*Le;if(qe!==X){do De(qe),qe=xe===0?X:X-ye/xe/(1+Ee);while(Je*qe>Je*X);U(je)*X*X>U(mt/X)&&(pe=-mt/X,ne=(pe-Ge)/X)}}var dt=oe.solveQuadratic(je,ne,pe,ot,Pe,ae),Pt=Pe==null;return isFinite(X)&&(dt===0||dt>0&&X!==ot[0]&&X!==ot[1])&&(Pt||X>Pe-be&&X<ae+be)&&(ot[dt++]=Pt?X:Ce(X,Pe,ae)),dt}}},ce={_id:1,_pools:{},get:function(b){if(b){var M=this._pools[b];return M||(M=this._pools[b]={_id:1}),M._id++}else return this._id++}},_e=v.extend({_class:"Point",_readIndex:!0,initialize:function(M,U){var K=typeof M,ie=this.__read,de=0;if(K==="number"){var be=typeof U=="number";this._set(M,be?U:M),ie&&(de=be?2:1)}else if(K==="undefined"||M===null)this._set(0,0),ie&&(de=M===null?1:0);else{var Ee=K==="string"?M.split(/[\s,]+/)||[]:M;de=1,Array.isArray(Ee)?this._set(+Ee[0],+(Ee.length>1?Ee[1]:Ee[0])):"x"in Ee?this._set(Ee.x||0,Ee.y||0):"width"in Ee?this._set(Ee.width||0,Ee.height||0):"angle"in Ee?(this._set(Ee.length||0,0),this.setAngle(Ee.angle||0)):(this._set(0,0),de=0)}return ie&&(this.__read=de),this},set:"#initialize",_set:function(b,M){return this.x=b,this.y=M,this},equals:function(b){return this===b||b&&(this.x===b.x&&this.y===b.y||Array.isArray(b)&&this.x===b[0]&&this.y===b[1])||!1},clone:function(){return new _e(this.x,this.y)},toString:function(){var b=he.instance;return"{ x: "+b.number(this.x)+", y: "+b.number(this.y)+" }"},_serialize:function(b){var M=b.formatter;return[M.number(this.x),M.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(b){if(this.isZero()){var M=this._angle||0;this._set(Math.cos(M)*b,Math.sin(M)*b)}else{var U=b/this.getLength();oe.isZero(U)&&this.getAngle(),this._set(this.x*U,this.y*U)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(b){this.setAngleInRadians.call(this,b*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var b=_e.read(arguments),M=this.getLength()*b.getLength();if(oe.isZero(M))return NaN;var U=this.dot(b)/M;return Math.acos(U<-1?-1:U>1?1:U)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(b){if(this._angle=b,!this.isZero()){var M=this.getLength();this._set(Math.cos(b)*M,Math.sin(b)*M)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var b=_e.read(arguments);return Math.atan2(this.cross(b),this.dot(b))*180/Math.PI},getDistance:function(){var b=arguments,M=_e.read(b),U=M.x-this.x,K=M.y-this.y,ie=U*U+K*K,de=v.read(b);return de?ie:Math.sqrt(ie)},normalize:function(b){b===n&&(b=1);var M=this.getLength(),U=M!==0?b/M:0,K=new _e(this.x*U,this.y*U);return U>=0&&(K._angle=this._angle),K},rotate:function(b,M){if(b===0)return this.clone();b=b*Math.PI/180;var U=M?this.subtract(M):this,K=Math.sin(b),ie=Math.cos(b);return U=new _e(U.x*ie-U.y*K,U.x*K+U.y*ie),M?U.add(M):U},transform:function(b){return b?b._transformPoint(this):this},add:function(){var b=_e.read(arguments);return new _e(this.x+b.x,this.y+b.y)},subtract:function(){var b=_e.read(arguments);return new _e(this.x-b.x,this.y-b.y)},multiply:function(){var b=_e.read(arguments);return new _e(this.x*b.x,this.y*b.y)},divide:function(){var b=_e.read(arguments);return new _e(this.x/b.x,this.y/b.y)},modulo:function(){var b=_e.read(arguments);return new _e(this.x%b.x,this.y%b.y)},negate:function(){return new _e(-this.x,-this.y)},isInside:function(){return st.read(arguments).contains(this)},isClose:function(){var b=arguments,M=_e.read(b),U=v.read(b);return this.getDistance(M)<=U},isCollinear:function(){var b=_e.read(arguments);return _e.isCollinear(this.x,this.y,b.x,b.y)},isColinear:"#isCollinear",isOrthogonal:function(){var b=_e.read(arguments);return _e.isOrthogonal(this.x,this.y,b.x,b.y)},isZero:function(){var b=oe.isZero;return b(this.x)&&b(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(b){return this.x*(b>1&&b<4?-1:1)>=0&&this.y*(b>2?-1:1)>=0},dot:function(){var b=_e.read(arguments);return this.x*b.x+this.y*b.y},cross:function(){var b=_e.read(arguments);return this.x*b.y-this.y*b.x},project:function(){var b=_e.read(arguments),M=b.isZero()?0:this.dot(b)/b.dot(b);return new _e(b.x*M,b.y*M)},statics:{min:function(){var b=arguments,M=_e.read(b),U=_e.read(b);return new _e(Math.min(M.x,U.x),Math.min(M.y,U.y))},max:function(){var b=arguments,M=_e.read(b),U=_e.read(b);return new _e(Math.max(M.x,U.x),Math.max(M.y,U.y))},random:function(){return new _e(Math.random(),Math.random())},isCollinear:function(b,M,U,K){return Math.abs(b*K-M*U)<=Math.sqrt((b*b+M*M)*(U*U+K*K))*1e-8},isOrthogonal:function(b,M,U,K){return Math.abs(b*U+M*K)<=Math.sqrt((b*b+M*M)*(U*U+K*K))*1e-8}}},v.each(["round","ceil","floor","abs"],function(b){var M=Math[b];this[b]=function(){return new _e(M(this.x),M(this.y))}},{})),Ze=_e.extend({initialize:function(M,U,K,ie){this._x=M,this._y=U,this._owner=K,this._setter=ie},_set:function(b,M,U){return this._x=b,this._y=M,U||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(b){this._x=b,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(b){this._y=b,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(b){this._owner._changeSelection(this._getSelection(),b)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),nt=v.extend({_class:"Size",_readIndex:!0,initialize:function(M,U){var K=typeof M,ie=this.__read,de=0;if(K==="number"){var be=typeof U=="number";this._set(M,be?U:M),ie&&(de=be?2:1)}else if(K==="undefined"||M===null)this._set(0,0),ie&&(de=M===null?1:0);else{var Ee=K==="string"?M.split(/[\s,]+/)||[]:M;de=1,Array.isArray(Ee)?this._set(+Ee[0],+(Ee.length>1?Ee[1]:Ee[0])):"width"in Ee?this._set(Ee.width||0,Ee.height||0):"x"in Ee?this._set(Ee.x||0,Ee.y||0):(this._set(0,0),de=0)}return ie&&(this.__read=de),this},set:"#initialize",_set:function(b,M){return this.width=b,this.height=M,this},equals:function(b){return b===this||b&&(this.width===b.width&&this.height===b.height||Array.isArray(b)&&this.width===b[0]&&this.height===b[1])||!1},clone:function(){return new nt(this.width,this.height)},toString:function(){var b=he.instance;return"{ width: "+b.number(this.width)+", height: "+b.number(this.height)+" }"},_serialize:function(b){var M=b.formatter;return[M.number(this.width),M.number(this.height)]},add:function(){var b=nt.read(arguments);return new nt(this.width+b.width,this.height+b.height)},subtract:function(){var b=nt.read(arguments);return new nt(this.width-b.width,this.height-b.height)},multiply:function(){var b=nt.read(arguments);return new nt(this.width*b.width,this.height*b.height)},divide:function(){var b=nt.read(arguments);return new nt(this.width/b.width,this.height/b.height)},modulo:function(){var b=nt.read(arguments);return new nt(this.width%b.width,this.height%b.height)},negate:function(){return new nt(-this.width,-this.height)},isZero:function(){var b=oe.isZero;return b(this.width)&&b(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(b,M){return new nt(Math.min(b.width,M.width),Math.min(b.height,M.height))},max:function(b,M){return new nt(Math.max(b.width,M.width),Math.max(b.height,M.height))},random:function(){return new nt(Math.random(),Math.random())}}},v.each(["round","ceil","floor","abs"],function(b){var M=Math[b];this[b]=function(){return new nt(M(this.width),M(this.height))}},{})),Ke=nt.extend({initialize:function(M,U,K,ie){this._width=M,this._height=U,this._owner=K,this._setter=ie},_set:function(b,M,U){return this._width=b,this._height=M,U||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(b){this._width=b,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(b){this._height=b,this._owner[this._setter](this)}}),st=v.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(M,U,K,ie){var de=arguments,be=typeof M,Ee;if(be==="number"?(this._set(M,U,K,ie),Ee=4):be==="undefined"||M===null?(this._set(0,0,0,0),Ee=M===null?1:0):de.length===1&&(Array.isArray(M)?(this._set.apply(this,M),Ee=1):M.x!==n||M.width!==n?(this._set(M.x||0,M.y||0,M.width||0,M.height||0),Ee=1):M.from===n&&M.to===n&&(this._set(0,0,0,0),v.readSupported(de,this)&&(Ee=1))),Ee===n){var Ce=_e.readNamed(de,"from"),Re=v.peek(de),$e=Ce.x,je=Ce.y,We,Ge;if(Re&&Re.x!==n||v.hasNamed(de,"to")){var mt=_e.readNamed(de,"to");We=mt.x-$e,Ge=mt.y-je,We<0&&($e=mt.x,We=-We),Ge<0&&(je=mt.y,Ge=-Ge)}else{var ot=nt.read(de);We=ot.width,Ge=ot.height}this._set($e,je,We,Ge),Ee=de.__index}var Pe=de.__filtered;return Pe&&(this.__filtered=Pe),this.__read&&(this.__read=Ee),this},set:"#initialize",_set:function(b,M,U,K){return this.x=b,this.y=M,this.width=U,this.height=K,this},clone:function(){return new st(this.x,this.y,this.width,this.height)},equals:function(b){var M=v.isPlainValue(b)?st.read(arguments):b;return M===this||M&&this.x===M.x&&this.y===M.y&&this.width===M.width&&this.height===M.height||!1},toString:function(){var b=he.instance;return"{ x: "+b.number(this.x)+", y: "+b.number(this.y)+", width: "+b.number(this.width)+", height: "+b.number(this.height)+" }"},_serialize:function(b){var M=b.formatter;return[M.number(this.x),M.number(this.y),M.number(this.width),M.number(this.height)]},getPoint:function(b){var M=b?_e:Ze;return new M(this.x,this.y,this,"setPoint")},setPoint:function(){var b=_e.read(arguments);this.x=b.x,this.y=b.y},getSize:function(b){var M=b?nt:Ke;return new M(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var b=nt.read(arguments),M=this._sx,U=this._sy,K=b.width,ie=b.height;M&&(this.x+=(this.width-K)*M),U&&(this.y+=(this.height-ie)*U),this.width=K,this.height=ie,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(b){if(!this._fw){var M=b-this.x;this.width-=this._sx===.5?M*2:M}this.x=b,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(b){if(!this._fh){var M=b-this.y;this.height-=this._sy===.5?M*2:M}this.y=b,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(b){if(!this._fw){var M=b-this.x;this.width=this._sx===.5?M*2:M}this.x=b-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(b){if(!this._fh){var M=b-this.y;this.height=this._sy===.5?M*2:M}this.y=b-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(b){this._fw||this._sx===.5?this.x=b-this.width/2:(this._sx&&(this.x+=(b-this.x)*2*this._sx),this.width=(b-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(b){this._fh||this._sy===.5?this.y=b-this.height/2:(this._sy&&(this.y+=(b-this.y)*2*this._sy),this.height=(b-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(b){var M=b?_e:Ze;return new M(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var b=_e.read(arguments);return this.setCenterX(b.x),this.setCenterY(b.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(b){return b&&b.width!==n||(Array.isArray(b)?b:arguments).length===4?this._containsRectangle(st.read(arguments)):this._containsPoint(_e.read(arguments))},_containsPoint:function(b){var M=b.x,U=b.y;return M>=this.x&&U>=this.y&&M<=this.x+this.width&&U<=this.y+this.height},_containsRectangle:function(b){var M=b.x,U=b.y;return M>=this.x&&U>=this.y&&M+b.width<=this.x+this.width&&U+b.height<=this.y+this.height},intersects:function(){var b=st.read(arguments),M=v.read(arguments)||0;return b.x+b.width>this.x-M&&b.y+b.height>this.y-M&&b.x<this.x+this.width+M&&b.y<this.y+this.height+M},intersect:function(){var b=st.read(arguments),M=Math.max(this.x,b.x),U=Math.max(this.y,b.y),K=Math.min(this.x+this.width,b.x+b.width),ie=Math.min(this.y+this.height,b.y+b.height);return new st(M,U,K-M,ie-U)},unite:function(){var b=st.read(arguments),M=Math.min(this.x,b.x),U=Math.min(this.y,b.y),K=Math.max(this.x+this.width,b.x+b.width),ie=Math.max(this.y+this.height,b.y+b.height);return new st(M,U,K-M,ie-U)},include:function(){var b=_e.read(arguments),M=Math.min(this.x,b.x),U=Math.min(this.y,b.y),K=Math.max(this.x+this.width,b.x),ie=Math.max(this.y+this.height,b.y);return new st(M,U,K-M,ie-U)},expand:function(){var b=nt.read(arguments),M=b.width,U=b.height;return new st(this.x-M/2,this.y-U/2,this.width+M,this.height+U)},scale:function(b,M){return this.expand(this.width*b-this.width,this.height*(M===n?b:M)-this.height)}},v.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(b,M){var U=b.join(""),K=/^[RL]/.test(U);M>=4&&(b[1]+=K?"Y":"X");var ie=b[K?0:1],de=b[K?1:0],be="get"+ie,Ee="get"+de,Ce="set"+ie,Re="set"+de,$e="get"+U,je="set"+U;this[$e]=function(We){var Ge=We?_e:Ze;return new Ge(this[be](),this[Ee](),this,je)},this[je]=function(){var We=_e.read(arguments);this[Ce](We.x),this[Re](We.y)}},{beans:!0})),ht=st.extend({initialize:function(M,U,K,ie,de,be){this._set(M,U,K,ie,!0),this._owner=de,this._setter=be},_set:function(b,M,U,K,ie){return this._x=b,this._y=M,this._width=U,this._height=K,ie||this._owner[this._setter](this),this}},new function(){var b=st.prototype;return v.each(["x","y","width","height"],function(M){var U=v.capitalize(M),K="_"+M;this["get"+U]=function(){return this[K]},this["set"+U]=function(ie){this[K]=ie,this._dontNotify||this._owner[this._setter](this)}},v.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(M){var U="set"+M;this[U]=function(){this._dontNotify=!0,b[U].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(M){var U=this._owner;U._changeSelection&&U._changeSelection(2,M)}}))}),xt=v.extend({_class:"Matrix",initialize:function b(M,U){var K=arguments,ie=K.length,de=!0;if(ie>=6?this._set.apply(this,K):ie===1||ie===2?M instanceof b?this._set(M._a,M._b,M._c,M._d,M._tx,M._ty,U):Array.isArray(M)?this._set.apply(this,U?M.concat([U]):M):de=!1:ie?de=!1:this.reset(),!de)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(b,M,U,K,ie,de,be){return this._a=b,this._b=M,this._c=U,this._d=K,this._tx=ie,this._ty=de,be||this._changed(),this},_serialize:function(b,M){return v.serialize(this.getValues(),b,!0,M)},_changed:function(){var b=this._owner;b&&(b._applyMatrix?b.transform(null,!0):b._changed(25))},clone:function(){return new xt(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(b){return b===this||b&&this._a===b._a&&this._b===b._b&&this._c===b._c&&this._d===b._d&&this._tx===b._tx&&this._ty===b._ty},toString:function(){var b=he.instance;return"[["+[b.number(this._a),b.number(this._c),b.number(this._tx)].join(", ")+"], ["+[b.number(this._b),b.number(this._d),b.number(this._ty)].join(", ")+"]]"},reset:function(b){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,b||this._changed(),this},apply:function(b,M){var U=this._owner;return U?(U.transform(null,v.pick(b,!0),M),this.isIdentity()):!1},translate:function(){var b=_e.read(arguments),M=b.x,U=b.y;return this._tx+=M*this._a+U*this._c,this._ty+=M*this._b+U*this._d,this._changed(),this},scale:function(){var b=arguments,M=_e.read(b),U=_e.read(b,0,{readNull:!0});return U&&this.translate(U),this._a*=M.x,this._b*=M.x,this._c*=M.y,this._d*=M.y,U&&this.translate(U.negate()),this._changed(),this},rotate:function(b){b*=Math.PI/180;var M=_e.read(arguments,1),U=M.x,K=M.y,ie=Math.cos(b),de=Math.sin(b),be=U-U*ie+K*de,Ee=K-U*de-K*ie,Ce=this._a,Re=this._b,$e=this._c,je=this._d;return this._a=ie*Ce+de*$e,this._b=ie*Re+de*je,this._c=-de*Ce+ie*$e,this._d=-de*Re+ie*je,this._tx+=be*Ce+Ee*$e,this._ty+=be*Re+Ee*je,this._changed(),this},shear:function(){var b=arguments,M=_e.read(b),U=_e.read(b,0,{readNull:!0});U&&this.translate(U);var K=this._a,ie=this._b;return this._a+=M.y*this._c,this._b+=M.y*this._d,this._c+=M.x*K,this._d+=M.x*ie,U&&this.translate(U.negate()),this._changed(),this},skew:function(){var b=arguments,M=_e.read(b),U=_e.read(b,0,{readNull:!0}),K=Math.PI/180,ie=new _e(Math.tan(M.x*K),Math.tan(M.y*K));return this.shear(ie,U)},append:function(b,M){if(b){var U=this._a,K=this._b,ie=this._c,de=this._d,be=b._a,Ee=b._c,Ce=b._b,Re=b._d,$e=b._tx,je=b._ty;this._a=be*U+Ce*ie,this._c=Ee*U+Re*ie,this._b=be*K+Ce*de,this._d=Ee*K+Re*de,this._tx+=$e*U+je*ie,this._ty+=$e*K+je*de,M||this._changed()}return this},prepend:function(b,M){if(b){var U=this._a,K=this._b,ie=this._c,de=this._d,be=this._tx,Ee=this._ty,Ce=b._a,Re=b._c,$e=b._b,je=b._d,We=b._tx,Ge=b._ty;this._a=Ce*U+Re*K,this._c=Ce*ie+Re*de,this._b=$e*U+je*K,this._d=$e*ie+je*de,this._tx=Ce*be+Re*Ee+We,this._ty=$e*be+je*Ee+Ge,M||this._changed()}return this},appended:function(b){return this.clone().append(b)},prepended:function(b){return this.clone().prepend(b)},invert:function(){var b=this._a,M=this._b,U=this._c,K=this._d,ie=this._tx,de=this._ty,be=b*K-M*U,Ee=null;return be&&!isNaN(be)&&isFinite(ie)&&isFinite(de)&&(this._a=K/be,this._b=-M/be,this._c=-U/be,this._d=b/be,this._tx=(U*de-K*ie)/be,this._ty=(M*ie-b*de)/be,Ee=this),Ee},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new xt(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var b=this._a*this._d-this._c*this._b;return b&&!isNaN(b)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(b,M,U){return arguments.length<3?this._transformPoint(_e.read(arguments)):this._transformCoordinates(b,M,U)},_transformPoint:function(b,M,U){var K=b.x,ie=b.y;return M||(M=new _e),M._set(K*this._a+ie*this._c+this._tx,K*this._b+ie*this._d+this._ty,U)},_transformCoordinates:function(b,M,U){for(var K=0,ie=2*U;K<ie;K+=2){var de=b[K],be=b[K+1];M[K]=de*this._a+be*this._c+this._tx,M[K+1]=de*this._b+be*this._d+this._ty}return M},_transformCorners:function(b){var M=b.x,U=b.y,K=M+b.width,ie=U+b.height,de=[M,U,K,U,K,ie,M,ie];return this._transformCoordinates(de,de,4)},_transformBounds:function(b,M,U){for(var K=this._transformCorners(b),ie=K.slice(0,2),de=ie.slice(),be=2;be<8;be++){var Ee=K[be],Ce=be&1;Ee<ie[Ce]?ie[Ce]=Ee:Ee>de[Ce]&&(de[Ce]=Ee)}return M||(M=new st),M._set(ie[0],ie[1],de[0]-ie[0],de[1]-ie[1],U)},inverseTransform:function(){return this._inverseTransform(_e.read(arguments))},_inverseTransform:function(b,M,U){var K=this._a,ie=this._b,de=this._c,be=this._d,Ee=this._tx,Ce=this._ty,Re=K*be-ie*de,$e=null;if(Re&&!isNaN(Re)&&isFinite(Ee)&&isFinite(Ce)){var je=b.x-this._tx,We=b.y-this._ty;M||(M=new _e),$e=M._set((je*be-We*de)/Re,(We*K-je*ie)/Re,U)}return $e},decompose:function(){var b=this._a,M=this._b,U=this._c,K=this._d,ie=b*K-M*U,de=Math.sqrt,be=Math.atan2,Ee=180/Math.PI,Ce,Re,$e;if(b!==0||M!==0){var je=de(b*b+M*M);Ce=Math.acos(b/je)*(M>0?1:-1),Re=[je,ie/je],$e=[be(b*U+M*K,je*je),0]}else if(U!==0||K!==0){var We=de(U*U+K*K);Ce=Math.asin(U/We)*(K>0?1:-1),Re=[ie/We,We],$e=[0,be(b*U+M*K,We*We)]}else Ce=0,$e=Re=[0,0];return{translation:this.getTranslation(),rotation:Ce*Ee,scaling:new _e(Re),skewing:new _e($e[0]*Ee,$e[1]*Ee)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new _e(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(b){this.isIdentity()||b.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},v.each(["a","b","c","d","tx","ty"],function(b){var M=v.capitalize(b),U="_"+b;this["get"+M]=function(){return this[U]},this["set"+M]=function(K){this[U]=K,this._changed()}},{})),zt=v.extend({_class:"Line",initialize:function(M,U,K,ie,de){var be=!1;arguments.length>=4?(this._px=M,this._py=U,this._vx=K,this._vy=ie,be=de):(this._px=M.x,this._py=M.y,this._vx=U.x,this._vy=U.y,be=K),be||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new _e(this._px,this._py)},getVector:function(){return new _e(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(b,M){return zt.intersect(this._px,this._py,this._vx,this._vy,b._px,b._py,b._vx,b._vy,!0,M)},getSide:function(b,M){return zt.getSide(this._px,this._py,this._vx,this._vy,b.x,b.y,!0,M)},getDistance:function(b){return Math.abs(this.getSignedDistance(b))},getSignedDistance:function(b){return zt.getSignedDistance(this._px,this._py,this._vx,this._vy,b.x,b.y,!0)},isCollinear:function(b){return _e.isCollinear(this._vx,this._vy,b._vx,b._vy)},isOrthogonal:function(b){return _e.isOrthogonal(this._vx,this._vy,b._vx,b._vy)},statics:{intersect:function(b,M,U,K,ie,de,be,Ee,Ce,Re){Ce||(U-=b,K-=M,be-=ie,Ee-=de);var $e=U*Ee-K*be;if(!oe.isMachineZero($e)){var je=b-ie,We=M-de,Ge=(be*We-Ee*je)/$e,mt=(U*We-K*je)/$e,ot=1e-12,Pe=-ot,ae=1+ot;if(Re||Pe<Ge&&Ge<ae&&Pe<mt&&mt<ae)return Re||(Ge=Ge<=0?0:Ge>=1?1:Ge),new _e(b+Ge*U,M+Ge*K)}},getSide:function(b,M,U,K,ie,de,be,Ee){be||(U-=b,K-=M);var Ce=ie-b,Re=de-M,$e=Ce*K-Re*U;return!Ee&&oe.isMachineZero($e)&&($e=(Ce*U+Ce*U)/(U*U+K*K),$e>=0&&$e<=1&&($e=0)),$e<0?-1:$e>0?1:0},getSignedDistance:function(b,M,U,K,ie,de,be){return be||(U-=b,K-=M),U===0?K>0?ie-b:b-ie:K===0?U<0?de-M:M-de:((ie-b)*K-(de-M)*U)/(K>U?K*Math.sqrt(1+U*U/(K*K)):U*Math.sqrt(1+K*K/(U*U)))},getDistance:function(b,M,U,K,ie,de,be){return Math.abs(zt.getSignedDistance(b,M,U,K,ie,de,be))}}}),Mt=N.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(M){N.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new xn(null,null,this),this._view=Oi.create(this,M||Yi.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(b,M){return v.serialize(this._children,b,!0,M)},_changed:function(b,M){if(b&1){var U=this._view;U&&(U._needsUpdate=!0,!U._requested&&U._autoUpdate&&U.requestUpdate())}var K=this._changes;if(K&&M){var ie=this._changesById,de=M._id,be=ie[de];be?be.flags|=b:K.push(ie[de]={item:M,flags:b})}},clear:function(){for(var b=this._children,M=b.length-1;M>=0;M--)b[M].remove()},isEmpty:function(){return!this._children.length},remove:function b(){return b.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(b){this._currentStyle.set(b)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new rt({project:this,insert:!0})},getSymbolDefinitions:function(){var b=[],M={};return this.getItems({class:yt,match:function(U){var K=U._definition,ie=K._id;return M[ie]||(M[ie]=!0,b.push(K)),!1}}),b},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var b=this._selectionItems,M=[];for(var U in b){var K=b[U],ie=K._selection;ie&1&&K.isInserted()?M.push(K):ie||this._updateSelection(K)}return M},_updateSelection:function(b){var M=b._id,U=this._selectionItems;b._selection?U[M]!==b&&(this._selectionCount++,U[M]=b):U[M]===b&&(this._selectionCount--,delete U[M])},selectAll:function(){for(var b=this._children,M=0,U=b.length;M<U;M++)b[M].setFullySelected(!0)},deselectAll:function(){var b=this._selectionItems;for(var M in b)b[M].setFullySelected(!1)},addLayer:function(b){return this.insertLayer(n,b)},insertLayer:function(b,M){if(M instanceof rt){M._remove(!1,!0),v.splice(this._children,[M],b,0),M._setProject(this,!0);var U=M._name;U&&M.setName(U),this._changes&&M._changed(5),this._activeLayer||(this._activeLayer=M)}else M=null;return M},_insertItem:function(b,M,U){return M=this.insertLayer(b,M)||(this._activeLayer||this._insertItem(n,new rt(Ue.NO_INSERT),!0)).insertChild(b,M),U&&M.activate&&M.activate(),M},getItems:function(b){return Ue._getItems(this,b)},getItem:function(b){return Ue._getItems(this,b,null,null,!0)[0]||null},importJSON:function(b){this.activate();var M=this._activeLayer;return v.importJSON(b,M&&M.isEmpty()&&M)},removeOn:function(b){var M=this._removeSets;if(M){b==="mouseup"&&(M.mousedrag=null);var U=M[b];if(U){for(var K in U){var ie=U[K];for(var de in M){var be=M[de];be&&be!=U&&delete be[ie._id]}ie.remove()}M[b]=null}}},draw:function(b,M,U){this._updateVersion++,b.save(),M.applyToContext(b);for(var K=this._children,ie=new v({offset:new _e(0,0),pixelRatio:U,viewMatrix:M.isIdentity()?null:M,matrices:[new xt],updateMatrix:!0}),de=0,be=K.length;de<be;de++)K[de].draw(b,ie);if(b.restore(),this._selectionCount>0){b.save(),b.strokeWidth=1;var Ee=this._selectionItems,Ce=this._scope.settings.handleSize,Re=this._updateVersion;for(var $e in Ee)Ee[$e]._drawSelection(b,M,Ce,Ee,Re);b.restore()}}}),Ue=v.extend(S,{statics:{extend:function b(M){return M._serializeFields&&(M._serializeFields=v.set({},this.prototype._serializeFields,M._serializeFields)),b.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new xt,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var b=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return v.each(b,function(M){this._events[M]={install:function(U){this.getView()._countItemEvent(U,1)},uninstall:function(U){this.getView()._countItemEvent(U,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:b}})},{initialize:function(){},_initialize:function(b,M){var U=b&&v.isPlainObject(b),K=U&&b.internal===!0,ie=this._matrix=new xt,de=U&&b.project||_n.project,be=_n.settings;return this._id=K?null:ce.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&be.applyMatrix,M&&ie.translate(M),ie._owner=this,this._style=new xn(de._currentStyle,this,de),K||U&&b.insert==!1||!be.insertItems&&!(U&&b.insert==!0)?this._setProject(de):(U&&b.parent||de)._insertItem(n,this,!0),U&&b!==Ue.NO_INSERT&&b!==Ue.INSERT&&this.set(b,{internal:!0,insert:!0,project:!0,parent:!0}),U},_serialize:function(b,M){var U={},K=this;function ie(de){for(var be in de){var Ee=K[be];v.equals(Ee,be==="leading"?de.fontSize*1.2:de[be])||(U[be]=v.serialize(Ee,b,be!=="data",M))}}return ie(this._serializeFields),this instanceof $t||ie(this._style._defaults),[this._class,U]},_changed:function(b){var M=this._symbol,U=this._parent||M,K=this._project;b&8&&(this._bounds=this._position=this._decomposed=n),b&16&&(this._globalMatrix=n),U&&b&72&&Ue._clearBoundsCache(U),b&2&&Ue._clearBoundsCache(this),K&&K._changed(b,this),M&&M._changed(b)},getId:function(){return this._id},getName:function(){return this._name},setName:function(b){if(this._name&&this._removeNamed(),b===+b+"")throw new Error("Names consisting only of numbers are not supported.");var M=this._getOwner();if(b&&M){var U=M._children,K=M._namedChildren;(K[b]=K[b]||[]).push(this),b in U||(U[b]=this)}this._name=b||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(b){this.getStyle().set(b)}},v.each(["locked","visible","blendMode","opacity","guide"],function(b){var M=v.capitalize(b),U="_"+b,K={locked:256,visible:265};this["get"+M]=function(){return this[U]},this["set"+M]=function(ie){ie!=this[U]&&(this[U]=ie,this._changed(K[b]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(b){if(b!==this._selection){this._selection=b;var M=this._project;M&&(M._updateSelection(this),this._changed(257))}},_changeSelection:function(b,M){var U=this._selection;this.setSelection(M?U|b:U&~b)},isSelected:function(){if(this._selectChildren){for(var b=this._children,M=0,U=b.length;M<U;M++)if(b[M].isSelected())return!0}return!!(this._selection&1)},setSelected:function(b){if(this._selectChildren)for(var M=this._children,U=0,K=M.length;U<K;U++)M[U].setSelected(b);this._changeSelection(1,b)},isFullySelected:function(){var b=this._children,M=!!(this._selection&1);if(b&&M){for(var U=0,K=b.length;U<K;U++)if(!b[U].isFullySelected())return!1;return!0}return M},setFullySelected:function(b){var M=this._children;if(M)for(var U=0,K=M.length;U<K;U++)M[U].setFullySelected(b);this._changeSelection(1,b)},isClipMask:function(){return this._clipMask},setClipMask:function(b){this._clipMask!=(b=!!b)&&(this._clipMask=b,b&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(b){this._data=b},getPosition:function(b){var M=b?_e:Ze,U=this._position||(this._position=this._getPositionFromBounds());return new M(U.x,U.y,this,"setPosition")},setPosition:function(){this.translate(_e.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(b){return this._pivot?this._matrix._transformPoint(this._pivot):(b||this.getBounds()).getCenter(!0)},getPivot:function(){var b=this._pivot;return b?new Ze(b.x,b.y,this,"setPivot"):null},setPivot:function(){this._pivot=_e.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},v.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(b,M){this[M]=function(U){return this.getBounds(U,b)}},{beans:!0,getBounds:function(b,M){var U=M||b instanceof xt,K=v.set({},U?M:b,this._boundsOptions);(!K.stroke||this.getStrokeScaling())&&(K.cacheItem=this);var ie=this._getCachedBounds(U&&b,K).rect;return arguments.length?ie:new ht(ie.x,ie.y,ie.width,ie.height,this,"setBounds")},setBounds:function(){var b=st.read(arguments),M=this.getBounds(),U=this._matrix,K=new xt,ie=b.getCenter();K.translate(ie),(b.width!=M.width||b.height!=M.height)&&(U.isInvertible()||(U.set(U._backup||new xt().translate(U.getTranslation())),M=this.getBounds()),K.scale(M.width!==0?b.width/M.width:0,M.height!==0?b.height/M.height:0)),ie=M.getCenter(),K.translate(-ie.x,-ie.y),this.transform(K)},_getBounds:function(b,M){var U=this._children;return!U||!U.length?new st:(Ue._updateBoundsCache(this,M.cacheItem),Ue._getBounds(U,b,M))},_getBoundsCacheKey:function(b,M){return[b.stroke?1:0,b.handle?1:0,M?1:0].join("")},_getCachedBounds:function(b,M,U){b=b&&b._orNullIfIdentity();var K=M.internal&&!U,ie=M.cacheItem,de=K?null:this._matrix._orNullIfIdentity(),be=ie&&(!b||b.equals(de))&&this._getBoundsCacheKey(M,K),Ee=this._bounds;if(Ue._updateBoundsCache(this._parent||this._symbol,ie),be&&Ee&&be in Ee){var Ce=Ee[be];return{rect:Ce.rect.clone(),nonscaling:Ce.nonscaling}}var Re=this._getBounds(b||de,M),$e=Re.rect||Re,je=this._style,We=Re.nonscaling||je.hasStroke()&&!je.getStrokeScaling();if(be){Ee||(this._bounds=Ee={});var Ce=Ee[be]={rect:$e.clone(),nonscaling:We,internal:K}}return{rect:$e,nonscaling:We}},_getStrokeMatrix:function(b,M){var U=this.getStrokeScaling()?null:M&&M.internal?this:this._parent||this._symbol&&this._symbol._item,K=U?U.getViewMatrix().invert():b;return K&&K._shiftless()},statics:{_updateBoundsCache:function(b,M){if(b&&M){var U=M._id,K=b._boundsCache=b._boundsCache||{ids:{},list:[]};K.ids[U]||(K.list.push(M),K.ids[U]=M)}},_clearBoundsCache:function(b){var M=b._boundsCache;if(M){b._bounds=b._position=b._boundsCache=n;for(var U=0,K=M.list,ie=K.length;U<ie;U++){var de=K[U];de!==b&&(de._bounds=de._position=n,de._boundsCache&&Ue._clearBoundsCache(de))}}},_getBounds:function(b,M,U){var K=1/0,ie=-K,de=K,be=ie,Ee=!1;U=U||{};for(var Ce=0,Re=b.length;Ce<Re;Ce++){var $e=b[Ce];if($e._visible&&!$e.isEmpty(!0)){var je=$e._getCachedBounds(M&&M.appended($e._matrix),U,!0),We=je.rect;K=Math.min(We.x,K),de=Math.min(We.y,de),ie=Math.max(We.x+We.width,ie),be=Math.max(We.y+We.height,be),je.nonscaling&&(Ee=!0)}}return{rect:isFinite(K)?new st(K,de,ie-K,be-de):new st,nonscaling:Ee}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var b=this._decompose();return b?b.rotation:0},setRotation:function(b){var M=this.getRotation();if(M!=null&&b!=null){var U=this._decomposed;this.rotate(b-M),U&&(U.rotation=b,this._decomposed=U)}},getScaling:function(){var b=this._decompose(),M=b&&b.scaling;return new Ze(M?M.x:1,M?M.y:1,this,"setScaling")},setScaling:function(){var b=this.getScaling(),M=_e.read(arguments,0,{clone:!0,readNull:!0});if(b&&M&&!b.equals(M)){var U=this.getRotation(),K=this._decomposed,ie=new xt,de=oe.isZero;if(de(b.x)||de(b.y))ie.translate(K.translation),U&&ie.rotate(U),ie.scale(M.x,M.y),this._matrix.set(ie);else{var be=this.getPosition(!0);ie.translate(be),U&&ie.rotate(U),ie.scale(M.x/b.x,M.y/b.y),U&&ie.rotate(-U),ie.translate(be.negate()),this.transform(ie)}K&&(K.scaling=M,this._decomposed=K)}},getMatrix:function(){return this._matrix},setMatrix:function(){var b=this._matrix;b.set.apply(b,arguments)},getGlobalMatrix:function(b){var M=this._globalMatrix;if(M)for(var U=this._parent,K=[];U;){if(!U._globalMatrix){M=null;for(var ie=0,de=K.length;ie<de;ie++)K[ie]._globalMatrix=null;break}K.push(U),U=U._parent}if(!M){M=this._globalMatrix=this._matrix.clone();var U=this._parent;U&&M.prepend(U.getGlobalMatrix(!0))}return b?M:M.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(b){(this._applyMatrix=this._canApplyMatrix&&!!b)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(b,M){if(this._project!==b){this._project&&this._installEvents(!1),this._project=b;for(var U=this._children,K=0,ie=U&&U.length;K<ie;K++)U[K]._setProject(b);M=!0}M&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function b(M){b.base.call(this,M);for(var U=this._children,K=0,ie=U&&U.length;K<ie;K++)U[K]._installEvents(M)},getLayer:function(){for(var b=this;b=b._parent;)if(b instanceof rt)return b;return null},getParent:function(){return this._parent},setParent:function(b){return b.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(b){this.removeChildren(),this.addChildren(b)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var b=this._getOwner();return b&&b._children[this._index+1]||null},getPreviousSibling:function(){var b=this._getOwner();return b&&b._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(b){return b===this||b&&this._class===b._class&&this._style.equals(b._style)&&this._matrix.equals(b._matrix)&&this._locked===b._locked&&this._visible===b._visible&&this._blendMode===b._blendMode&&this._opacity===b._opacity&&this._clipMask===b._clipMask&&this._guide===b._guide&&this._equals(b)||!1},_equals:function(b){return v.equals(this._children,b._children)},clone:function(b){var M=new this.constructor(Ue.NO_INSERT),U=this._children,K=v.pick(b?b.insert:n,b===n||b===!0),ie=v.pick(b?b.deep:n,!0);U&&M.copyAttributes(this),(!U||ie)&&M.copyContent(this),U||M.copyAttributes(this),K&&M.insertAbove(this);var de=this._name,be=this._parent;if(de&&be){for(var U=be._children,Ee=de,Ce=1;U[de];)de=Ee+" "+Ce++;de!==Ee&&M.setName(de)}return M},copyContent:function(b){for(var M=b._children,U=0,K=M&&M.length;U<K;U++)this.addChild(M[U].clone(!1),!0)},copyAttributes:function(b,M){this.setStyle(b._style);for(var U=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],K=0,ie=U.length;K<ie;K++){var de=U[K];b.hasOwnProperty(de)&&(this[de]=b[de])}M||this._matrix.set(b._matrix,!0),this.setApplyMatrix(b._applyMatrix),this.setPivot(b._pivot),this.setSelection(b._selection);var be=b._data,Ee=b._name;this._data=be?v.clone(be):null,Ee&&this.setName(Ee)},rasterize:function(b,M){var U,K,ie;v.isPlainObject(b)?(U=b.resolution,K=b.insert,ie=b.raster):(U=b,K=M),ie||(ie=new At(Ue.NO_INSERT));var de=this.getStrokeBounds(),be=(U||this.getView().getResolution())/72,Ee=de.getTopLeft().floor(),Ce=de.getBottomRight().ceil(),Re=new nt(Ce.subtract(Ee)),$e=Re.multiply(be);if(ie.setSize($e,!0),!$e.isZero()){var je=ie.getContext(!0),We=new xt().scale(be).translate(Ee.negate());je.save(),We.applyToContext(je),this.draw(je,new v({matrices:[We]})),je.restore()}return ie._matrix.set(new xt().translate(Ee.add(Re.divide(2))).scale(1/be)),(K===n||K)&&ie.insertAbove(this),ie},contains:function(){var b=this._matrix;return b.isInvertible()&&!!this._contains(b._inverseTransform(_e.read(arguments)))},_contains:function(b){var M=this._children;if(M){for(var U=M.length-1;U>=0;U--)if(M[U].contains(b))return!0;return!1}return b.isInside(this.getInternalBounds())},isInside:function(){return st.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Vt.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(b,M){return b instanceof Ue?this._asPathItem().getIntersections(b._asPathItem(),null,M,!0).length>0:!1}},new function(){function b(){var K=arguments;return this._hitTest(_e.read(K),ut.getOptions(K))}function M(){var K=arguments,ie=_e.read(K),de=ut.getOptions(K),be=[];return this._hitTest(ie,new v({all:be},de)),be}function U(K,ie,de,be){var Ee=this._children;if(Ee)for(var Ce=Ee.length-1;Ce>=0;Ce--){var Re=Ee[Ce],$e=Re!==be&&Re._hitTest(K,ie,de);if($e&&!ie.all)return $e}return null}return Mt.inject({hitTest:b,hitTestAll:M,_hitTest:U}),{hitTest:b,hitTestAll:M,_hitTestChildren:U}},{_hitTest:function(b,M,U){if(this._locked||!this._visible||this._guide&&!M.guides||this.isEmpty())return null;var K=this._matrix,ie=U?U.appended(K):this.getGlobalMatrix().prepend(this.getView()._matrix),de=Math.max(M.tolerance,1e-12),be=M._tolerancePadding=new nt(Vt._getStrokePadding(de,K._shiftless().invert()));if(b=K._inverseTransform(b),!b||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(be.multiply(2))._containsPoint(b))return null;var Ee=!(M.guides&&!this._guide||M.selected&&!this.isSelected()||M.type&&M.type!==v.hyphenate(this._class)||M.class&&!(this instanceof M.class)),Ce=M.match,Re=this,$e,je;function We(X){return X&&Ce&&!Ce(X)&&(X=null),X&&M.all&&M.all.push(X),X}function Ge(X,ne){var pe=ne?$e["get"+ne]():Re.getPosition();if(b.subtract(pe).divide(be).length<=1)return new ut(X,Re,{name:ne?v.hyphenate(ne):X,point:pe})}var mt=M.position,ot=M.center,Pe=M.bounds;if(Ee&&this._parent&&(mt||ot||Pe)){if((ot||Pe)&&($e=this.getInternalBounds()),je=mt&&Ge("position")||ot&&Ge("center","Center"),!je&&Pe)for(var ae=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],re=0;re<8&&!je;re++)je=Ge("bounds",ae[re]);je=We(je)}return je||(je=this._hitTestChildren(b,M,ie)||Ee&&We(this._hitTestSelf(b,M,ie,this.getStrokeScaling()?null:ie._shiftless().invert()))||null),je&&je.point&&(je.point=K.transform(je.point)),je},_hitTestSelf:function(b,M){if(M.fill&&this.hasFill()&&this._contains(b))return new ut("fill",this)},matches:function(b,M){function U(be,Ee){for(var Ce in be)if(be.hasOwnProperty(Ce)){var Re=be[Ce],$e=Ee[Ce];if(v.isPlainObject(Re)&&v.isPlainObject($e)){if(!U(Re,$e))return!1}else if(!v.equals(Re,$e))return!1}return!0}var K=typeof b;if(K==="object"){for(var ie in b)if(b.hasOwnProperty(ie)&&!this.matches(ie,b[ie]))return!1;return!0}else{if(K==="function")return b(this);if(b==="match")return M(this);var de=/^(empty|editable)$/.test(b)?this["is"+v.capitalize(b)]():b==="type"?v.hyphenate(this._class):this[b];if(b==="class"){if(typeof M=="function")return this instanceof M;de=this._class}if(typeof M=="function")return!!M(de);if(M){if(M.test)return M.test(de);if(v.isPlainObject(M))return U(M,de)}return v.equals(de,M)}},getItems:function(b){return Ue._getItems(this,b,this._matrix)},getItem:function(b){return Ue._getItems(this,b,this._matrix,null,!0)[0]||null},statics:{_getItems:function b(M,U,K,ie,de){if(!ie){var be=typeof U=="object"&&U,Ee=be&&be.overlapping,Ce=be&&be.inside,Re=Ee||Ce,We=Re&&st.read([Re]);ie={items:[],recursive:be&&be.recursive!==!1,inside:!!Ce,overlapping:!!Ee,rect:We,path:Ee&&new Vt.Rectangle({rectangle:We,insert:!1})},be&&(U=v.filter({},U,{recursive:!0,inside:!0,overlapping:!0}))}var $e=M._children,je=ie.items,We=ie.rect;K=We&&(K||new xt);for(var Ge=0,mt=$e&&$e.length;Ge<mt;Ge++){var ot=$e[Ge],Pe=K&&K.appended(ot._matrix),ae=!0;if(We){var Re=ot.getBounds(Pe);if(!We.intersects(Re))continue;We.contains(Re)||ie.overlapping&&(Re.contains(We)||ie.path.intersects(ot,Pe))||(ae=!1)}if(ae&&ot.matches(U)&&(je.push(ot),de)||(ie.recursive!==!1&&b(ot,U,Pe,ie,de),de&&je.length>0))break}return je}}},{importJSON:function(b){var M=v.importJSON(b,this);return M!==this?this.addChild(M):M},addChild:function(b){return this.insertChild(n,b)},insertChild:function(b,M){var U=M?this.insertChildren(b,[M]):null;return U&&U[0]},addChildren:function(b){return this.insertChildren(this._children.length,b)},insertChildren:function(b,M){var U=this._children;if(U&&M&&M.length>0){M=v.slice(M);for(var K={},ie=M.length-1;ie>=0;ie--){var de=M[ie],be=de&&de._id;!de||K[be]?M.splice(ie,1):(de._remove(!1,!0),K[be]=!0)}v.splice(U,M,b,0);for(var Ee=this._project,Ce=Ee._changes,ie=0,Re=M.length;ie<Re;ie++){var de=M[ie],$e=de._name;de._parent=this,de._setProject(Ee,!0),$e&&de.setName($e),Ce&&de._changed(5)}this._changed(11)}else M=null;return M},_insertItem:"#insertChild",_insertAt:function(b,M){var U=b&&b._getOwner(),K=b!==this&&U?this:null;return K&&(K._remove(!1,!0),U._insertItem(b._index+M,K)),K},insertAbove:function(b){return this._insertAt(b,1)},insertBelow:function(b){return this._insertAt(b,0)},sendToBack:function(){var b=this._getOwner();return b?b._insertItem(0,this):null},bringToFront:function(){var b=this._getOwner();return b?b._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(b){return this.insertChild(0,b)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(b){return b._insertItem(n,this)},copyTo:function(b){return this.clone(!1).addTo(b)},reduce:function(b){var M=this._children;if(M&&M.length===1){var U=M[0].reduce(b);return this._parent?(U.insertAbove(this),this.remove()):U.remove(),U}return this},_removeNamed:function(){var b=this._getOwner();if(b){var M=b._children,U=b._namedChildren,K=this._name,ie=U[K],de=ie?ie.indexOf(this):-1;de!==-1&&(M[K]==this&&delete M[K],ie.splice(de,1),ie.length?M[K]=ie[0]:delete U[K])}},_remove:function(b,M){var U=this._getOwner(),K=this._project,ie=this._index;return this._style&&this._style._dispose(),U?(this._name&&this._removeNamed(),ie!=null&&(K._activeLayer===this&&(K._activeLayer=this.getNextSibling()||this.getPreviousSibling()),v.splice(U._children,null,ie,1)),this._installEvents(!1),b&&K._changes&&this._changed(5),M&&U._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(b){var M=b&&b.insertBelow(this);return M&&this.remove(),M},removeChildren:function(b,M){if(!this._children)return null;b=b||0,M=v.pick(M,this._children.length);for(var U=v.splice(this._children,null,b,M-b),K=U.length-1;K>=0;K--)U[K]._remove(!0,!1);return U.length>0&&this._changed(11),U},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var b=0,M=this._children.length;b<M;b++)this._children[b]._index=b;this._changed(11)}},isEmpty:function(b){var M=this._children,U=M?M.length:0;if(b){for(var K=0;K<U;K++)if(!M[K].isEmpty(b))return!1;return!0}return!U},isEditable:function(){for(var b=this;b;){if(!b._visible||b._locked)return!1;b=b._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(b){function M(be){var Ee=[];do Ee.unshift(be);while(be=be._parent);return Ee}for(var U=M(this),K=M(b),ie=0,de=Math.min(U.length,K.length);ie<de;ie++)if(U[ie]!=K[ie])return U[ie]._index<K[ie]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(b){return this._getOrder(b)===-1},isBelow:function(b){return this._getOrder(b)===1},isParent:function(b){return this._parent===b},isChild:function(b){return b&&b._parent===this},isDescendant:function(b){for(var M=this;M=M._parent;)if(M===b)return!0;return!1},isAncestor:function(b){return b?b.isDescendant(this):!1},isSibling:function(b){return this._parent===b._parent},isGroupedWith:function(b){for(var M=this._parent;M;){if(M._parent&&/^(Group|Layer|CompoundPath)$/.test(M._class)&&b.isDescendant(M))return!0;M=M._parent}return!1}},v.each(["rotate","scale","shear","skew"],function(b){var M=b==="rotate";this[b]=function(){var U=arguments,K=(M?v:_e).read(U),ie=_e.read(U,0,{readNull:!0});return this.transform(new xt()[b](K,ie||this.getPosition(!0)))}},{translate:function(){var b=new xt;return this.transform(b.translate.apply(b,arguments))},transform:function(b,M,U){var K=this._matrix,ie=b&&!b.isIdentity(),de=U&&this._canApplyMatrix||this._applyMatrix&&(ie||!K.isIdentity()||M&&this._children);if(!ie&&!de)return this;if(ie){!b.isInvertible()&&K.isInvertible()&&(K._backup=K.getValues()),K.prepend(b,!0);var be=this._style,Ee=be.getFillColor(!0),Ce=be.getStrokeColor(!0);Ee&&Ee.transform(b),Ce&&Ce.transform(b)}if(de&&(de=this._transformContent(K,M,U))){var Re=this._pivot;Re&&K._transformPoint(Re,Re,!0),K.reset(!0),U&&this._canApplyMatrix&&(this._applyMatrix=!0)}var $e=this._bounds,je=this._position;(ie||de)&&this._changed(25);var We=ie&&$e&&b.decompose();if(We&&We.skewing.isZero()&&We.rotation%90===0){for(var Ge in $e){var mt=$e[Ge];if(mt.nonscaling)delete $e[Ge];else if(de||!mt.internal){var ot=mt.rect;b._transformBounds(ot,ot)}}this._bounds=$e;var Pe=$e[this._getBoundsCacheKey(this._boundsOptions||{})];Pe&&(this._position=this._getPositionFromBounds(Pe.rect))}else ie&&je&&this._pivot&&(this._position=b._transformPoint(je,je));return this},_transformContent:function(b,M,U){var K=this._children;if(K){for(var ie=0,de=K.length;ie<de;ie++)K[ie].transform(b,M,U);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(_e.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(_e.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(_e.read(arguments))},localToParent:function(){return this._matrix._transformPoint(_e.read(arguments))},fitBounds:function(b,M){b=st.read(arguments);var U=this.getBounds(),K=U.height/U.width,ie=b.height/b.width,de=(M?K>ie:K<ie)?b.width/U.width:b.height/U.height,be=new st(new _e,new nt(U.width*de,U.height*de));be.setCenter(b.getCenter()),this.setBounds(be)}}),{_setStyles:function(b,M,U){var K=this._style,ie=this._matrix;if(K.hasFill()&&(b.fillStyle=K.getFillColor().toCanvasStyle(b,ie)),K.hasStroke()){b.strokeStyle=K.getStrokeColor().toCanvasStyle(b,ie),b.lineWidth=K.getStrokeWidth();var de=K.getStrokeJoin(),be=K.getStrokeCap(),Ee=K.getMiterLimit();if(de&&(b.lineJoin=de),be&&(b.lineCap=be),Ee&&(b.miterLimit=Ee),_n.support.nativeDash){var Ce=K.getDashArray(),Re=K.getDashOffset();Ce&&Ce.length&&("setLineDash"in b?(b.setLineDash(Ce),b.lineDashOffset=Re):(b.mozDash=Ce,b.mozDashOffset=Re))}}if(K.hasShadow()){var $e=M.pixelRatio||1,je=U._shiftless().prepend(new xt().scale($e,$e)),We=je.transform(new _e(K.getShadowBlur(),0)),Ge=je.transform(this.getShadowOffset());b.shadowColor=K.getShadowColor().toCanvasStyle(b),b.shadowBlur=We.getLength(),b.shadowOffsetX=Ge.x,b.shadowOffsetY=Ge.y}},draw:function(b,M,U){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var K=M.matrices,ie=M.viewMatrix,de=this._matrix,be=K[K.length-1].appended(de);if(be.isInvertible()){ie=ie?ie.appended(be):be,K.push(be),M.updateMatrix&&(this._globalMatrix=be);var Ee=this._blendMode,Ce=oe.clamp(this._opacity,0,1),Re=Ee==="normal",$e=Xn.nativeModes[Ee],je=Re&&Ce===1||M.dontStart||M.clip||($e||Re&&Ce<1)&&this._canComposite(),We=M.pixelRatio||1,Ge,mt,ot;if(!je){var Pe=this.getStrokeBounds(ie);if(!Pe.width||!Pe.height){K.pop();return}ot=M.offset,mt=M.offset=Pe.getTopLeft().floor(),Ge=b,b=Yi.getContext(Pe.getSize().ceil().add(1).multiply(We)),We!==1&&b.scale(We,We)}b.save();var ae=U?U.appended(de):this._canScaleStroke&&!this.getStrokeScaling(!0)&&ie,re=!je&&M.clipItem,X=!ae||re;if(je?(b.globalAlpha=Ce,$e&&(b.globalCompositeOperation=Ee)):X&&b.translate(-mt.x,-mt.y),X&&(je?de:ie).applyToContext(b),re&&M.clipItem.draw(b,M.extend({clip:!0})),ae){b.setTransform(We,0,0,We,0,0);var ne=M.offset;ne&&b.translate(-ne.x,-ne.y)}this._draw(b,M,ie,ae),b.restore(),K.pop(),M.clip&&!M.dontFinish&&b.clip(this.getFillRule()),je||(Xn.process(Ee,b,Ge,Ce,mt.subtract(ot).multiply(We)),Yi.release(b),M.offset=ot)}}},_isUpdated:function(b){var M=this._parent;if(M instanceof yi)return M._isUpdated(b);var U=this._updateVersion===b;return!U&&M&&M._visible&&M._isUpdated(b)&&(this._updateVersion=b,U=!0),U},_drawSelection:function(b,M,U,K,ie){var de=this._selection,be=de&1,Ee=de&2||be&&this._selectBounds,Ce=de&4;if(this._drawSelected||(be=!1),(be||Ee||Ce)&&this._isUpdated(ie)){var Re,$e=this.getSelectedColor(!0)||(Re=this.getLayer())&&Re.getSelectedColor(!0),je=M.appended(this.getGlobalMatrix(!0)),We=U/2;if(b.strokeStyle=b.fillStyle=$e?$e.toCanvasStyle(b):"#009dec",be&&this._drawSelected(b,je,K),Ce){var Ge=this.getPosition(!0),mt=this._parent,ot=mt?mt.localToGlobal(Ge):Ge,Pe=ot.x,ae=ot.y;b.beginPath(),b.arc(Pe,ae,We,0,Math.PI*2,!0),b.stroke();for(var re=[[0,-1],[1,0],[0,1],[-1,0]],X=We,ne=U+1,pe=0;pe<4;pe++){var xe=re[pe],ye=xe[0],De=xe[1];b.moveTo(Pe+ye*X,ae+De*X),b.lineTo(Pe+ye*ne,ae+De*ne),b.stroke()}}if(Ee){var Oe=je._transformCorners(this.getInternalBounds());b.beginPath();for(var pe=0;pe<8;pe++)b[pe?"lineTo":"moveTo"](Oe[pe],Oe[++pe]);b.closePath(),b.stroke();for(var pe=0;pe<8;pe++)b.fillRect(Oe[pe]-We,Oe[++pe]-We,U,U)}}},_canComposite:function(){return!1}},v.each(["down","drag","up","move"],function(b){this["removeOn"+v.capitalize(b)]=function(){var M={};return M[b]=!0,this.removeOn(M)}},{removeOn:function(b){for(var M in b)if(b[M]){var U="mouse"+M,K=this._project,ie=K._removeSets=K._removeSets||{};ie[U]=ie[U]||{},ie[U][this._id]=this}return this}}),{tween:function(b,M,U){U||(U=M,M=b,b=null,U||(U=M,M=null));var K=U&&U.easing,ie=U&&U.start,de=U!=null&&(typeof U=="number"?U:U.duration),be=new $n(this,b,M,de,K,ie);function Ee(Ce){be._handleFrame(Ce.time*1e3),be.running||this.off("frame",Ee)}return de&&this.on("frame",Ee),be},tweenTo:function(b,M){return this.tween(null,b,M)},tweenFrom:function(b,M){return this.tween(b,null,M)}}),$t=Ue.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(M){this._children=[],this._namedChildren={},this._initialize(M)||this.addChildren(Array.isArray(M)?M:arguments)},_changed:function b(M){b.base.call(this,M),M&2050&&(this._clipItem=n)},_getClipItem:function(){var b=this._clipItem;if(b===n){b=null;for(var M=this._children,U=0,K=M.length;U<K;U++)if(M[U]._clipMask){b=M[U];break}this._clipItem=b}return b},isClipped:function(){return!!this._getClipItem()},setClipped:function(b){var M=this.getFirstChild();M&&M.setClipMask(b)},_getBounds:function b(M,U){var K=this._getClipItem();return K?K._getCachedBounds(K._matrix.prepended(M),v.set({},U,{stroke:!1})):b.base.call(this,M,U)},_hitTestChildren:function b(M,U,K){var ie=this._getClipItem();return(!ie||ie.contains(M))&&b.base.call(this,M,U,K,ie)},_draw:function(b,M){var U=M.clip,K=!U&&this._getClipItem();M=M.extend({clipItem:K,clip:!1}),U?(b.beginPath(),M.dontStart=M.dontFinish=!0):K&&K.draw(b,M.extend({clip:!0}));for(var ie=this._children,de=0,be=ie.length;de<be;de++){var Ee=ie[de];Ee!==K&&Ee.draw(b,M)}}}),rt=$t.extend({_class:"Layer",initialize:function(){$t.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function b(){return this._parent?b.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),gt=Ue.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(M,U){this._initialize(M,U)},_equals:function(b){return this._type===b._type&&this._size.equals(b._size)&&v.equals(this._radius,b._radius)},copyContent:function(b){this.setType(b._type),this.setSize(b._size),this.setRadius(b._radius)},getType:function(){return this._type},setType:function(b){this._type=b},getShape:"#getType",setShape:"#setType",getSize:function(){var b=this._size;return new Ke(b.width,b.height,this,"setSize")},setSize:function(){var b=nt.read(arguments);if(!this._size)this._size=b.clone();else if(!this._size.equals(b)){var M=this._type,U=b.width,K=b.height;M==="rectangle"?this._radius.set(nt.min(this._radius,b.divide(2).abs())):M==="circle"?(U=K=(U+K)/2,this._radius=U/2):M==="ellipse"&&this._radius._set(U/2,K/2),this._size._set(U,K),this._changed(9)}},getRadius:function(){var b=this._radius;return this._type==="circle"?b:new Ke(b.width,b.height,this,"setRadius")},setRadius:function(b){var M=this._type;if(M==="circle"){if(b===this._radius)return;var U=b*2;this._radius=b,this._size._set(U,U)}else if(b=nt.read(arguments),!this._radius)this._radius=b.clone();else{if(this._radius.equals(b))return;if(this._radius.set(b),M==="rectangle"){var U=nt.max(this._size,b.multiply(2));this._size.set(U)}else M==="ellipse"&&this._size._set(b.width*2,b.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(b){var M=new Vt[v.capitalize(this._type)]({center:new _e,size:this._size,radius:this._radius,insert:!1});return M.copyAttributes(this),_n.settings.applyMatrix&&M.setApplyMatrix(!0),(b===n||b)&&M.insertAbove(this),M},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(b,M,U,K){var ie=this._style,de=ie.hasFill(),be=ie.hasStroke(),Ee=M.dontFinish||M.clip,Ce=!K;if(de||be||Ee){var Re=this._type,$e=this._radius,je=Re==="circle";if(M.dontStart||b.beginPath(),Ce&&je)b.arc(0,0,$e,0,Math.PI*2,!0);else{var We=je?$e:$e.width,Ge=je?$e:$e.height,mt=this._size,ot=mt.width,Pe=mt.height;if(Ce&&Re==="rectangle"&&We===0&&Ge===0)b.rect(-ot/2,-Pe/2,ot,Pe);else{var ae=ot/2,re=Pe/2,X=1-.5522847498307936,ne=We*X,pe=Ge*X,xe=[-ae,-re+Ge,-ae,-re+pe,-ae+ne,-re,-ae+We,-re,ae-We,-re,ae-ne,-re,ae,-re+pe,ae,-re+Ge,ae,re-Ge,ae,re-pe,ae-ne,re,ae-We,re,-ae+We,re,-ae+ne,re,-ae,re-pe,-ae,re-Ge];K&&K.transform(xe,xe,32),b.moveTo(xe[0],xe[1]),b.bezierCurveTo(xe[2],xe[3],xe[4],xe[5],xe[6],xe[7]),ae!==We&&b.lineTo(xe[8],xe[9]),b.bezierCurveTo(xe[10],xe[11],xe[12],xe[13],xe[14],xe[15]),re!==Ge&&b.lineTo(xe[16],xe[17]),b.bezierCurveTo(xe[18],xe[19],xe[20],xe[21],xe[22],xe[23]),ae!==We&&b.lineTo(xe[24],xe[25]),b.bezierCurveTo(xe[26],xe[27],xe[28],xe[29],xe[30],xe[31])}}b.closePath()}!Ee&&(de||be)&&(this._setStyles(b,M,U),de&&(b.fill(ie.getFillRule()),b.shadowColor="rgba(0,0,0,0)"),be&&b.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(b,M){var U=new st(this._size).setCenter(0,0),K=this._style,ie=M.stroke&&K.hasStroke()&&K.getStrokeWidth();return b&&(U=b._transformBounds(U)),ie?U.expand(Vt._getStrokePadding(ie,this._getStrokeMatrix(b,M))):U}},new function(){function b(U,K,ie){var de=U._radius;if(!de.isZero())for(var be=U._size.divide(2),Ee=1;Ee<=4;Ee++){var Ce=new _e(Ee>1&&Ee<4?-1:1,Ee>2?-1:1),Re=Ce.multiply(be),$e=Re.subtract(Ce.multiply(de)),je=new st(ie?Re.add(Ce.multiply(ie)):Re,$e);if(je.contains(K))return{point:$e,quadrant:Ee}}}function M(U,K,ie,de){var be=U.divide(K);return(!de||be.isInQuadrant(de))&&be.subtract(be.normalize()).multiply(K).divide(ie).length<=1}return{_contains:function U(K){if(this._type==="rectangle"){var ie=b(this,K);return ie?K.subtract(ie.point).divide(this._radius).getLength()<=1:U.base.call(this,K)}else return K.divide(this.size).getLength()<=.5},_hitTestSelf:function U(K,ie,de,be){var Ee=!1,Ce=this._style,Re=ie.stroke&&Ce.hasStroke(),$e=ie.fill&&Ce.hasFill();if(Re||$e){var je=this._type,We=this._radius,Ge=Re?Ce.getStrokeWidth()/2:0,mt=ie._tolerancePadding.add(Vt._getStrokePadding(Ge,!Ce.getStrokeScaling()&&be));if(je==="rectangle"){var ot=mt.multiply(2),Pe=b(this,K,ot);if(Pe)Ee=M(K.subtract(Pe.point),We,mt,Pe.quadrant);else{var ae=new st(this._size).setCenter(0,0),re=ae.expand(ot),X=ae.expand(ot.negate());Ee=re._containsPoint(K)&&!X._containsPoint(K)}}else Ee=M(K,We,mt)}return Ee?new ut(Re?"stroke":"fill",this):U.base.apply(this,arguments)}}},{statics:new function(){function b(M,U,K,ie,de){var be=v.create(gt.prototype);return be._type=M,be._size=K,be._radius=ie,be._initialize(v.getNamed(de),U),be}return{Circle:function(){var M=arguments,U=_e.readNamed(M,"center"),K=v.readNamed(M,"radius");return b("circle",U,new nt(K*2),K,M)},Rectangle:function(){var M=arguments,U=st.readNamed(M,"rectangle"),K=nt.min(nt.readNamed(M,"radius"),U.getSize(!0).divide(2));return b("rectangle",U.getCenter(!0),U.getSize(!0),K,M)},Ellipse:function(){var M=arguments,U=gt._readEllipse(M),K=U.radius;return b("ellipse",U.center,K.multiply(2),K,M)},_readEllipse:function(M){var U,K;if(v.hasNamed(M,"radius"))U=_e.readNamed(M,"center"),K=nt.readNamed(M,"radius");else{var ie=st.readNamed(M,"rectangle");U=ie.getCenter(!0),K=ie.getSize(!0).divide(2)}return{center:U,radius:K}}}}}),At=Ue.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(M,U){if(!this._initialize(M,U!==n&&_e.read(arguments))){var K,ie=typeof M,de=ie==="string"?g.getElementById(M):ie==="object"?M:null;if(de&&de!==Ue.NO_INSERT){if(de.getContext||de.naturalHeight!=null)K=de;else if(de){var be=nt.read(arguments);be.isZero()||(K=Yi.getCanvas(be))}}K?this.setImage(K):this.setSource(M)}this._size||(this._size=new nt,this._loaded=!1)},_equals:function(b){return this.getSource()===b.getSource()},copyContent:function(b){var M=b._image,U=b._canvas;if(M)this._setImage(M);else if(U){var K=Yi.getCanvas(b._size);K.getContext("2d").drawImage(U,0,0),this._setImage(K)}this._crossOrigin=b._crossOrigin},getSize:function(){var b=this._size;return new Ke(b?b.width:0,b?b.height:0,this,"setSize")},setSize:function(b,M){var U=nt.read(arguments);if(U.equals(this._size))M&&this.clear();else if(U.width>0&&U.height>0){var K=!M&&this.getElement();this._setImage(Yi.getCanvas(U)),K&&this.getContext(!0).drawImage(K,0,0,U.width,U.height)}else this._canvas&&Yi.release(this._canvas),this._size=U.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(b){this.setSize(b,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(b){this.setSize(this.getWidth(),b)},getLoaded:function(){return this._loaded},isEmpty:function(){var b=this._size;return!b||b.width===0&&b.height===0},getResolution:function(){var b=this._matrix,M=new _e(0,0).transform(b),U=new _e(1,0).transform(b).subtract(M),K=new _e(0,1).transform(b).subtract(M);return new nt(72/U.getLength(),72/K.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(b){var M=this;function U(K){var ie=M.getView(),de=K&&K.type||"load";ie&&M.responds(de)&&(_n=ie._scope,M.emit(de,new bn(K)))}this._setImage(b),this._loaded?setTimeout(U,0):b&&gi.add(b,{load:function(K){M._setImage(b),U(K)},error:U})},_setImage:function(b){this._canvas&&Yi.release(this._canvas),b&&b.getContext?(this._image=null,this._canvas=b,this._loaded=!0):(this._image=b,this._canvas=null,this._loaded=!!(b&&b.src&&b.complete)),this._size=new nt(b?b.naturalWidth||b.width:0,b?b.naturalHeight||b.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var b=Yi.getContext(this._size);try{this._image&&b.drawImage(this._image,0,0),this._canvas=b.canvas}catch{Yi.release(b)}}return this._canvas},setCanvas:"#setImage",getContext:function(b){return this._context||(this._context=this.getCanvas().getContext("2d")),b&&(this._image=null,this._changed(1025)),this._context},setContext:function(b){this._context=b},getSource:function(){var b=this._image;return b&&b.src||this.toDataURL()},setSource:function(b){var M=new e.Image,U=this._crossOrigin;U&&(M.crossOrigin=U),b&&(M.src=b),this.setImage(M)},getCrossOrigin:function(){var b=this._image;return b&&b.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(b){this._crossOrigin=b;var M=this._image;M&&(M.crossOrigin=b)},getSmoothing:function(){return this._smoothing},setSmoothing:function(b){this._smoothing=typeof b=="string"?b:b?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var b=st.read(arguments),M=Yi.getContext(b.getSize());return M.drawImage(this.getCanvas(),b.x,b.y,b.width,b.height,0,0,b.width,b.height),M.canvas},getSubRaster:function(){var b=st.read(arguments),M=new At(Ue.NO_INSERT);return M._setImage(this.getSubCanvas(b)),M.translate(b.getCenter().subtract(this.getSize().divide(2))),M._matrix.prepend(this._matrix),M.insertAbove(this),M},toDataURL:function(){var b=this._image,M=b&&b.src;if(/^data:/.test(M))return M;var U=this.getCanvas();return U?U.toDataURL.apply(U,arguments):null},drawImage:function(b){var M=_e.read(arguments,1);this.getContext(!0).drawImage(b,M.x,M.y)},getAverageColor:function(b){var M,U;if(b?b instanceof Ft?(U=b,M=b.getBounds()):typeof b=="object"&&("width"in b?M=new st(b):"x"in b&&(M=new st(b.x-.5,b.y-.5,1,1))):M=this.getBounds(),!M)return null;var K=32,ie=Math.min(M.width,K),de=Math.min(M.height,K),be=At._sampleContext;be?be.clearRect(0,0,K+1,K+1):be=At._sampleContext=Yi.getContext(new nt(K)),be.save();var Ee=new xt().scale(ie/M.width,de/M.height).translate(-M.x,-M.y);Ee.applyToContext(be),U&&U.draw(be,new v({clip:!0,matrices:[Ee]})),this._matrix.applyToContext(be);var Ce=this.getElement(),Re=this._size;Ce&&be.drawImage(Ce,-Re.width/2,-Re.height/2),be.restore();for(var $e=be.getImageData(.5,.5,Math.ceil(ie),Math.ceil(de)).data,je=[0,0,0],We=0,Ge=0,mt=$e.length;Ge<mt;Ge+=4){var ot=$e[Ge+3];We+=ot,ot/=255,je[0]+=$e[Ge]*ot,je[1]+=$e[Ge+1]*ot,je[2]+=$e[Ge+2]*ot}for(var Ge=0;Ge<3;Ge++)je[Ge]/=We;return We?Zi.read(je):null},getPixel:function(){var b=_e.read(arguments),M=this.getContext().getImageData(b.x,b.y,1,1).data;return new Zi("rgb",[M[0]/255,M[1]/255,M[2]/255],M[3]/255)},setPixel:function(){var b=arguments,M=_e.read(b),U=Zi.read(b),K=U._convert("rgb"),ie=U._alpha,de=this.getContext(!0),be=de.createImageData(1,1),Ee=be.data;Ee[0]=K[0]*255,Ee[1]=K[1]*255,Ee[2]=K[2]*255,Ee[3]=ie!=null?ie*255:255,de.putImageData(be,M.x,M.y)},clear:function(){var b=this._size;this.getContext(!0).clearRect(0,0,b.width+1,b.height+1)},createImageData:function(){var b=nt.read(arguments);return this.getContext().createImageData(b.width,b.height)},getImageData:function(){var b=st.read(arguments);return b.isEmpty()&&(b=new st(this._size)),this.getContext().getImageData(b.x,b.y,b.width,b.height)},putImageData:function(b){var M=_e.read(arguments,1);this.getContext(!0).putImageData(b,M.x,M.y)},setImageData:function(b){this.setSize(b),this.getContext(!0).putImageData(b,0,0)},_getBounds:function(b,M){var U=new st(this._size).setCenter(0,0);return b?b._transformBounds(U):U},_hitTestSelf:function(b){if(this._contains(b)){var M=this;return new ut("pixel",M,{offset:b.add(M._size.divide(2)).round(),color:{get:function(){return M.getPixel(this.offset)}}})}},_draw:function(b,M,U){var K=this.getElement();if(K&&K.width>0&&K.height>0){b.globalAlpha=oe.clamp(this._opacity,0,1),this._setStyles(b,M,U);var ie=this._smoothing,de=ie==="off";Ti.setPrefixed(b,de?"imageSmoothingEnabled":"imageSmoothingQuality",de?!1:ie),b.drawImage(K,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),yt=Ue.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(M,U){this._initialize(M,U!==n&&_e.read(arguments,1))||this.setDefinition(M instanceof St?M:new St(M))},_equals:function(b){return this._definition===b._definition},copyContent:function(b){this.setDefinition(b._definition)},getDefinition:function(){return this._definition},setDefinition:function(b){this._definition=b,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(b,M){var U=this._definition._item;return U._getCachedBounds(U._matrix.prepended(b),M)},_hitTestSelf:function(b,M,U){var K=M.extend({all:!1}),ie=this._definition._item._hitTest(b,K,U);return ie&&(ie.item=this),ie},_draw:function(b,M){this._definition._item.draw(b,M)}}),St=v.extend({_class:"SymbolDefinition",initialize:function(M,U){this._id=ce.get(),this.project=_n.project,M&&this.setItem(M,U)},_serialize:function(b,M){return M.add(this,function(){return v.serialize([this._class,this._item],b,!1,M)})},_changed:function(b){b&8&&Ue._clearBoundsCache(this),b&1&&this.project._changed(b)},getItem:function(){return this._item},setItem:function(b,M){b._symbol&&(b=b.clone()),this._item&&(this._item._symbol=null),this._item=b,b.remove(),b.setSelected(!1),M||b.setPosition(new _e),b._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(b){return new yt(this,b)},clone:function(){return new St(this._item.clone(!1))},equals:function(b){return b===this||b&&this._item.equals(b._item)||!1}}),ut=v.extend({_class:"HitResult",initialize:function(M,U,K){this.type=M,this.item=U,K&&this.inject(K)},statics:{getOptions:function(b){var M=b&&v.read(b);return new v({type:null,tolerance:_n.settings.hitTolerance,fill:!M,stroke:!M,segments:!M,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},M)}}}),Ye=v.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(M,U,K,ie,de,be){var Ee=arguments.length,Ce,Re,$e,je;Ee>0&&(M==null||typeof M=="object"?Ee===1&&M&&"point"in M?(Ce=M.point,Re=M.handleIn,$e=M.handleOut,je=M.selection):(Ce=M,Re=U,$e=K,je=ie):(Ce=[M,U],Re=K!==n?[K,ie]:null,$e=de!==n?[de,be]:null)),new _t(Ce,this,"_point"),new _t(Re,this,"_handleIn"),new _t($e,this,"_handleOut"),je&&this.setSelection(je)},_serialize:function(b,M){var U=this._point,K=this._selection,ie=K||this.hasHandles()?[U,this._handleIn,this._handleOut]:U;return K&&ie.push(K),v.serialize(ie,b,!0,M)},_changed:function(b){var M=this._path;if(M){var U=M._curves,K=this._index,ie;U&&((!b||b===this._point||b===this._handleIn)&&(ie=K>0?U[K-1]:M._closed?U[U.length-1]:null)&&ie._changed(),(!b||b===this._point||b===this._handleOut)&&(ie=U[K])&&ie._changed()),M._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(_e.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(_e.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(_e.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var b=this._handleIn,M=this._handleOut;return!b.isZero()&&!M.isZero()&&b.isCollinear(M)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(b){var M=this._selection,U=this._path;this._selection=b=b||0,U&&b!==M&&(U._updateSelection(this,M,b),U._changed(257))},_changeSelection:function(b,M){var U=this._selection;this.setSelection(M?U|b:U&~b)},isSelected:function(){return!!(this._selection&7)},setSelected:function(b){this._changeSelection(7,b)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var b=this._path,M=this._index;return b?(M>0&&!b._closed&&M===b._segments.length-1&&M--,b.getCurves()[M]||null):null},getLocation:function(){var b=this.getCurve();return b?new Ut(b,this===b._segment1?0:1):null},getNext:function(){var b=this._path&&this._path._segments;return b&&(b[this._index+1]||this._path._closed&&b[0])||null},smooth:function(b,M,U){var K=b||{},ie=K.type,de=K.factor,be=this.getPrevious(),Ee=this.getNext(),Ce=(be||this)._point,Re=this._point,$e=(Ee||this)._point,je=Ce.getDistance(Re),We=Re.getDistance($e);if(!ie||ie==="catmull-rom"){var Ge=de===n?.5:de,mt=Math.pow(je,Ge),ot=mt*mt,Pe=Math.pow(We,Ge),ae=Pe*Pe;if(!M&&be){var re=2*ae+3*Pe*mt+ot,X=3*Pe*(Pe+mt);this.setHandleIn(X!==0?new _e((ae*Ce._x+re*Re._x-ot*$e._x)/X-Re._x,(ae*Ce._y+re*Re._y-ot*$e._y)/X-Re._y):new _e)}if(!U&&Ee){var re=2*ot+3*mt*Pe+ae,X=3*mt*(mt+Pe);this.setHandleOut(X!==0?new _e((ot*$e._x+re*Re._x-ae*Ce._x)/X-Re._x,(ot*$e._y+re*Re._y-ae*Ce._y)/X-Re._y):new _e)}}else if(ie==="geometric"){if(be&&Ee){var ne=Ce.subtract($e),pe=de===n?.4:de,xe=pe*je/(je+We);M||this.setHandleIn(ne.multiply(xe)),U||this.setHandleOut(ne.multiply(xe-pe))}}else throw new Error("Smoothing method '"+ie+"' not supported.")},getPrevious:function(){var b=this._path&&this._path._segments;return b&&(b[this._index-1]||this._path._closed&&b[b.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var b=this._path;return b&&this._index===b._segments.length-1||!1},reverse:function(){var b=this._handleIn,M=this._handleOut,U=b.clone();b.set(M),M.set(U)},reversed:function(){return new Ye(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Ye(this._point,this._handleIn,this._handleOut)},equals:function(b){return b===this||b&&this._class===b._class&&this._point.equals(b._point)&&this._handleIn.equals(b._handleIn)&&this._handleOut.equals(b._handleOut)||!1},toString:function(){var b=["point: "+this._point];return this._handleIn.isZero()||b.push("handleIn: "+this._handleIn),this._handleOut.isZero()||b.push("handleOut: "+this._handleOut),"{ "+b.join(", ")+" }"},transform:function(b){this._transformCoordinates(b,new Array(6),!0),this._changed()},interpolate:function(b,M,U){var K=1-U,ie=U,de=b._point,be=M._point,Ee=b._handleIn,Ce=M._handleIn,Re=M._handleOut,$e=b._handleOut;this._point._set(K*de._x+ie*be._x,K*de._y+ie*be._y,!0),this._handleIn._set(K*Ee._x+ie*Ce._x,K*Ee._y+ie*Ce._y,!0),this._handleOut._set(K*$e._x+ie*Re._x,K*$e._y+ie*Re._y,!0),this._changed()},_transformCoordinates:function(b,M,U){var K=this._point,ie=!U||!this._handleIn.isZero()?this._handleIn:null,de=!U||!this._handleOut.isZero()?this._handleOut:null,be=K._x,Ee=K._y,Ce=2;return M[0]=be,M[1]=Ee,ie&&(M[Ce++]=ie._x+be,M[Ce++]=ie._y+Ee),de&&(M[Ce++]=de._x+be,M[Ce++]=de._y+Ee),b&&(b._transformCoordinates(M,M,Ce/2),be=M[0],Ee=M[1],U?(K._x=be,K._y=Ee,Ce=2,ie&&(ie._x=M[Ce++]-be,ie._y=M[Ce++]-Ee),de&&(de._x=M[Ce++]-be,de._y=M[Ce++]-Ee)):(ie||(M[Ce++]=be,M[Ce++]=Ee),de||(M[Ce++]=be,M[Ce++]=Ee))),M}}),_t=_e.extend({initialize:function(M,U,K){var ie,de,be;if(!M)ie=de=0;else if((ie=M[0])!==n)de=M[1];else{var Ee=M;(ie=Ee.x)===n&&(Ee=_e.read(arguments),ie=Ee.x),de=Ee.y,be=Ee.selected}this._x=ie,this._y=de,this._owner=U,U[K]=this,be&&this.setSelected(!0)},_set:function(b,M){return this._x=b,this._y=M,this._owner._changed(this),this},getX:function(){return this._x},setX:function(b){this._x=b,this._owner._changed(this)},getY:function(){return this._y},setY:function(b){this._y=b,this._owner._changed(this)},isZero:function(){var b=oe.isZero;return b(this._x)&&b(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(b){this._owner._changeSelection(this._getSelection(),b)},_getSelection:function(){var b=this._owner;return this===b._point?1:this===b._handleIn?2:this===b._handleOut?4:0}}),ct=v.extend({_class:"Curve",beans:!0,initialize:function(M,U,K,ie,de,be,Ee,Ce){var Re=arguments.length,$e,je,We,Ge,mt,ot;Re===3?(this._path=M,$e=U,je=K):Re?Re===1?"segment1"in M?($e=new Ye(M.segment1),je=new Ye(M.segment2)):"point1"in M?(We=M.point1,mt=M.handle1,ot=M.handle2,Ge=M.point2):Array.isArray(M)&&(We=[M[0],M[1]],Ge=[M[6],M[7]],mt=[M[2]-M[0],M[3]-M[1]],ot=[M[4]-M[6],M[5]-M[7]]):Re===2?($e=new Ye(M),je=new Ye(U)):Re===4?(We=M,mt=U,ot=K,Ge=ie):Re===8&&(We=[M,U],Ge=[Ee,Ce],mt=[K-M,ie-U],ot=[de-Ee,be-Ce]):($e=new Ye,je=new Ye),this._segment1=$e||new Ye(We,null,mt),this._segment2=je||new Ye(Ge,ot,null)},_serialize:function(b,M){return v.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],b,!0,M)},_changed:function(){this._length=this._bounds=n},clone:function(){return new ct(this._segment1,this._segment2)},toString:function(){var b=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||b.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||b.push("handle2: "+this._segment2._handleIn),b.push("point2: "+this._segment2._point),"{ "+b.join(", ")+" }"},classify:function(){return ct.classify(this.getValues())},remove:function(){var b=!1;if(this._path){var M=this._segment2,U=M._handleOut;b=M.remove(),b&&this._segment1._handleOut.set(U)}return b},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(_e.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(_e.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(_e.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(_e.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var b=this._path&&this._path._curves;return b&&(b[this._segment1._index+1]||this._path._closed&&b[0])||null},getPrevious:function(){var b=this._path&&this._path._curves;return b&&(b[this._segment1._index-1]||this._path._closed&&b[b.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var b=this._path;return b&&this._segment1._index===b._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(b){this.getPoint1().setSelected(b),this.getHandle1().setSelected(b),this.getHandle2().setSelected(b),this.getPoint2().setSelected(b)},getValues:function(b){return ct.getValues(this._segment1,this._segment2,b)},getPoints:function(){for(var b=this.getValues(),M=[],U=0;U<8;U+=2)M.push(new _e(b[U],b[U+1]));return M}},{getLength:function(){return this._length==null&&(this._length=ct.getLength(this.getValues(),0,1)),this._length},getArea:function(){return ct.getArea(this.getValues())},getLine:function(){return new zt(this._segment1._point,this._segment2._point)},getPart:function(b,M){return new ct(ct.getPart(this.getValues(),b,M))},getPartLength:function(b,M){return ct.getLength(this.getValues(),b,M)},divideAt:function(b){return this.divideAtTime(b&&b.curve===this?b.time:this.getTimeAt(b))},divideAtTime:function(b,M){var U=1e-8,K=1-U,ie=null;if(b>=U&&b<=K){var de=ct.subdivide(this.getValues(),b),be=de[0],Ee=de[1],Ce=M||this.hasHandles(),Re=this._segment1,$e=this._segment2,je=this._path;Ce&&(Re._handleOut._set(be[2]-be[0],be[3]-be[1]),$e._handleIn._set(Ee[4]-Ee[6],Ee[5]-Ee[7]));var We=be[6],Ge=be[7],mt=new Ye(new _e(We,Ge),Ce&&new _e(be[4]-We,be[5]-Ge),Ce&&new _e(Ee[2]-We,Ee[3]-Ge));je?(je.insert(Re._index+1,mt),ie=this.getNext()):(this._segment2=mt,this._changed(),ie=new ct(mt,$e))}return ie},splitAt:function(b){var M=this._path;return M?M.splitAt(b):null},splitAtTime:function(b){return this.splitAt(this.getLocationAtTime(b))},divide:function(b,M){return this.divideAtTime(b===n?.5:M?b:this.getTimeAt(b))},split:function(b,M){return this.splitAtTime(b===n?.5:M?b:this.getTimeAt(b))},reversed:function(){return new ct(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(b,M,U,K){var ie=b._point,de=b._handleOut,be=M._handleIn,Ee=M._point,Ce=ie.x,Re=ie.y,$e=Ee.x,je=Ee.y,We=K?[Ce,Re,Ce,Re,$e,je,$e,je]:[Ce,Re,Ce+de._x,Re+de._y,$e+be._x,je+be._y,$e,je];return U&&U._transformCoordinates(We,We,4),We},subdivide:function(b,M){var U=b[0],K=b[1],ie=b[2],de=b[3],be=b[4],Ee=b[5],Ce=b[6],Re=b[7];M===n&&(M=.5);var $e=1-M,je=$e*U+M*ie,We=$e*K+M*de,Ge=$e*ie+M*be,mt=$e*de+M*Ee,ot=$e*be+M*Ce,Pe=$e*Ee+M*Re,ae=$e*je+M*Ge,re=$e*We+M*mt,X=$e*Ge+M*ot,ne=$e*mt+M*Pe,pe=$e*ae+M*X,xe=$e*re+M*ne;return[[U,K,je,We,ae,re,pe,xe],[pe,xe,X,ne,ot,Pe,Ce,Re]]},getMonoCurves:function(b,M){var U=[],K=M?0:1,ie=b[K+0],de=b[K+2],be=b[K+4],Ee=b[K+6];if(ie>=de==de>=be&&de>=be==be>=Ee||ct.isStraight(b))U.push(b);else{var Ce=3*(de-be)-ie+Ee,Re=2*(ie+be)-4*de,$e=de-ie,je=1e-8,We=1-je,Ge=[],mt=oe.solveQuadratic(Ce,Re,$e,Ge,je,We);if(!mt)U.push(b);else{Ge.sort();var ot=Ge[0],Pe=ct.subdivide(b,ot);U.push(Pe[0]),mt>1&&(ot=(Ge[1]-ot)/(1-ot),Pe=ct.subdivide(Pe[1],ot),U.push(Pe[0])),U.push(Pe[1])}}return U},solveCubic:function(b,M,U,K,ie,de){var be=b[M],Ee=b[M+2],Ce=b[M+4],Re=b[M+6],$e=0;if(!(be<U&&Re<U&&Ee<U&&Ce<U||be>U&&Re>U&&Ee>U&&Ce>U)){var je=3*(Ee-be),We=3*(Ce-Ee)-je,Ge=Re-be-je-We;$e=oe.solveCubic(Ge,We,je,be-U,K,ie,de)}return $e},getTimeOf:function(b,M){var U=new _e(b[0],b[1]),K=new _e(b[6],b[7]),ie=1e-12,de=1e-7,be=M.isClose(U,ie)?0:M.isClose(K,ie)?1:null;if(be===null)for(var Ee=[M.x,M.y],Ce=[],Re=0;Re<2;Re++)for(var $e=ct.solveCubic(b,Re,Ee[Re],Ce,0,1),je=0;je<$e;je++){var We=Ce[je];if(M.isClose(ct.getPoint(b,We),de))return We}return M.isClose(U,de)?0:M.isClose(K,de)?1:null},getNearestTime:function(b,M){if(ct.isStraight(b)){var U=b[0],K=b[1],ie=b[6],de=b[7],be=ie-U,Ee=de-K,Ce=be*be+Ee*Ee;if(Ce===0)return 0;var Re=((M.x-U)*be+(M.y-K)*Ee)/Ce;return Re<1e-12?0:Re>.999999999999?1:ct.getTimeOf(b,new _e(U+Re*be,K+Re*Ee))}var $e=100,je=1/0,We=0;function Ge(Pe){if(Pe>=0&&Pe<=1){var ae=M.getDistance(ct.getPoint(b,Pe),!0);if(ae<je)return je=ae,We=Pe,!0}}for(var mt=0;mt<=$e;mt++)Ge(mt/$e);for(var ot=1/($e*2);ot>1e-8;)!Ge(We-ot)&&!Ge(We+ot)&&(ot/=2);return We},getPart:function(b,M,U){var K=M>U;if(K){var ie=M;M=U,U=ie}return M>0&&(b=ct.subdivide(b,M)[1]),U<1&&(b=ct.subdivide(b,(U-M)/(1-M))[0]),K?[b[6],b[7],b[4],b[5],b[2],b[3],b[0],b[1]]:b},isFlatEnough:function(b,M){var U=b[0],K=b[1],ie=b[2],de=b[3],be=b[4],Ee=b[5],Ce=b[6],Re=b[7],$e=3*ie-2*U-Ce,je=3*de-2*K-Re,We=3*be-2*Ce-U,Ge=3*Ee-2*Re-K;return Math.max($e*$e,We*We)+Math.max(je*je,Ge*Ge)<=16*M*M},getArea:function(b){var M=b[0],U=b[1],K=b[2],ie=b[3],de=b[4],be=b[5],Ee=b[6],Ce=b[7];return 3*((Ce-U)*(K+de)-(Ee-M)*(ie+be)+ie*(M-de)-K*(U-be)+Ce*(de+M/3)-Ee*(be+U/3))/20},getBounds:function(b){for(var M=b.slice(0,2),U=M.slice(),K=[0,0],ie=0;ie<2;ie++)ct._addBounds(b[ie],b[ie+2],b[ie+4],b[ie+6],ie,0,M,U,K);return new st(M[0],M[1],U[0]-M[0],U[1]-M[1])},_addBounds:function(b,M,U,K,ie,de,be,Ee,Ce){function Re(pe,xe){var ye=pe-xe,De=pe+xe;ye<be[ie]&&(be[ie]=ye),De>Ee[ie]&&(Ee[ie]=De)}de/=2;var $e=be[ie]+de,je=Ee[ie]-de;if(b<$e||M<$e||U<$e||K<$e||b>je||M>je||U>je||K>je)if(M<b!=M<K&&U<b!=U<K)Re(b,0),Re(K,0);else{var We=3*(M-U)-b+K,Ge=2*(b+U)-4*M,mt=M-b,ot=oe.solveQuadratic(We,Ge,mt,Ce),Pe=1e-8,ae=1-Pe;Re(K,0);for(var re=0;re<ot;re++){var X=Ce[re],ne=1-X;Pe<=X&&X<=ae&&Re(ne*ne*ne*b+3*ne*ne*X*M+3*ne*X*X*U+X*X*X*K,de)}}}}},v.each(["getBounds","getStrokeBounds","getHandleBounds"],function(b){this[b]=function(){this._bounds||(this._bounds={});var M=this._bounds[b];return M||(M=this._bounds[b]=Vt[b]([this._segment1,this._segment2],!1,this._path)),M.clone()}},{}),v.each({isStraight:function(b,M,U,K){if(M.isZero()&&U.isZero())return!0;var ie=K.subtract(b);if(ie.isZero())return!1;if(ie.isCollinear(M)&&ie.isCollinear(U)){var de=new zt(b,K),be=1e-7;if(de.getDistance(b.add(M))<be&&de.getDistance(K.add(U))<be){var Ee=ie.dot(ie),Ce=ie.dot(M)/Ee,Re=ie.dot(U)/Ee;return Ce>=0&&Ce<=1&&Re<=0&&Re>=-1}}return!1},isLinear:function(b,M,U,K){var ie=K.subtract(b).divide(3);return M.equals(ie)&&U.negate().equals(ie)}},function(b,M){this[M]=function(U){var K=this._segment1,ie=this._segment2;return b(K._point,K._handleOut,ie._handleIn,ie._point,U)},this.statics[M]=function(U,K){var ie=U[0],de=U[1],be=U[6],Ee=U[7];return b(new _e(ie,de),new _e(U[2]-ie,U[3]-de),new _e(U[4]-be,U[5]-Ee),new _e(be,Ee),K)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(b){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(b||0)},isCollinear:function(b){return b&&this.isStraight()&&b.isStraight()&&this.getLine().isCollinear(b.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(b,M){return this.getLocationAtTime(M?b:this.getTimeAt(b))},getLocationAtTime:function(b){return b!=null&&b>=0&&b<=1?new Ut(this,b):null},getTimeAt:function(b,M){return ct.getTimeAt(this.getValues(),b,M)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var b=_e.read(arguments);return b.isZero()?[]:ct.getTimesWithTangent(this.getValues(),b)},getOffsetAtTime:function(b){return this.getPartLength(0,b)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(_e.read(arguments)))},getOffsetOf:function(){var b=this.getLocationOf.apply(this,arguments);return b?b.getOffset():null},getTimeOf:function(){return ct.getTimeOf(this.getValues(),_e.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var b=_e.read(arguments),M=this.getValues(),U=ct.getNearestTime(M,b),K=ct.getPoint(M,U);return new Ut(this,U,K,null,b.getDistance(K))},getNearestPoint:function(){var b=this.getNearestLocation.apply(this,arguments);return b&&b.getPoint()}},new function(){var b=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return v.each(b,function(M){this[M+"At"]=function(U,K){var ie=this.getValues();return ct[M](ie,K?U:ct.getTimeAt(ie,U))},this[M+"AtTime"]=function(U){return ct[M](this.getValues(),U)}},{statics:{_evaluateMethods:b}})},new function(){function b(K){var ie=K[0],de=K[1],be=K[2],Ee=K[3],Ce=K[4],Re=K[5],$e=K[6],je=K[7],We=9*(be-Ce)+3*($e-ie),Ge=6*(ie+Ce)-12*be,mt=3*(be-ie),ot=9*(Ee-Re)+3*(je-de),Pe=6*(de+Re)-12*Ee,ae=3*(Ee-de);return function(re){var X=(We*re+Ge)*re+mt,ne=(ot*re+Pe)*re+ae;return Math.sqrt(X*X+ne*ne)}}function M(K,ie){return Math.max(2,Math.min(16,Math.ceil(Math.abs(ie-K)*32)))}function U(K,ie,de,be){if(ie==null||ie<0||ie>1)return null;var Ee=K[0],Ce=K[1],Re=K[2],$e=K[3],je=K[4],We=K[5],Ge=K[6],mt=K[7],ot=oe.isZero;ot(Re-Ee)&&ot($e-Ce)&&(Re=Ee,$e=Ce),ot(je-Ge)&&ot(We-mt)&&(je=Ge,We=mt);var Pe=3*(Re-Ee),ae=3*(je-Re)-Pe,re=Ge-Ee-Pe-ae,X=3*($e-Ce),ne=3*(We-$e)-X,pe=mt-Ce-X-ne,xe,ye;if(de===0)xe=ie===0?Ee:ie===1?Ge:((re*ie+ae)*ie+Pe)*ie+Ee,ye=ie===0?Ce:ie===1?mt:((pe*ie+ne)*ie+X)*ie+Ce;else{var De=1e-8,Oe=1-De;if(ie<De?(xe=Pe,ye=X):ie>Oe?(xe=3*(Ge-je),ye=3*(mt-We)):(xe=(3*re*ie+2*ae)*ie+Pe,ye=(3*pe*ie+2*ne)*ie+X),be){xe===0&&ye===0&&(ie<De||ie>Oe)&&(xe=je-Re,ye=We-$e);var Ve=Math.sqrt(xe*xe+ye*ye);Ve&&(xe/=Ve,ye/=Ve)}if(de===3){var je=6*re*ie+2*ae,We=6*pe*ie+2*ne,Je=Math.pow(xe*xe+ye*ye,3/2);xe=Je!==0?(xe*We-ye*je)/Je:0,ye=0}}return de===2?new _e(ye,-xe):new _e(xe,ye)}return{statics:{classify:function(K){var ie=K[0],de=K[1],be=K[2],Ee=K[3],Ce=K[4],Re=K[5],$e=K[6],je=K[7],We=ie*(je-Re)+de*(Ce-$e)+$e*Re-je*Ce,Ge=be*(de-je)+Ee*($e-ie)+ie*je-de*$e,mt=Ce*(Ee-de)+Re*(ie-be)+be*de-Ee*ie,ot=3*mt,Pe=ot-Ge,ae=Pe-Ge+We,re=Math.sqrt(ae*ae+Pe*Pe+ot*ot),X=re!==0?1/re:0,ne=oe.isZero,pe="serpentine";ae*=X,Pe*=X,ot*=X;function xe(Ve,Je,et){var Le=Je!==n,qe=Le&&Je>0&&Je<1,dt=Le&&et>0&&et<1;return Le&&(!(qe||dt)||Ve==="loop"&&!(qe&&dt))&&(Ve="arch",qe=dt=!1),{type:Ve,roots:qe||dt?qe&&dt?Je<et?[Je,et]:[et,Je]:[qe?Je:et]:null}}if(ne(ae))return ne(Pe)?xe(ne(ot)?"line":"quadratic"):xe(pe,ot/(3*Pe));var ye=3*Pe*Pe-4*ae*ot;if(ne(ye))return xe("cusp",Pe/(2*ae));var De=ye>0?Math.sqrt(ye/3):Math.sqrt(-ye),Oe=2*ae;return xe(ye>0?pe:"loop",(Pe+De)/Oe,(Pe-De)/Oe)},getLength:function(K,ie,de,be){if(ie===n&&(ie=0),de===n&&(de=1),ct.isStraight(K)){var Ee=K;de<1&&(Ee=ct.subdivide(Ee,de)[0],ie/=de),ie>0&&(Ee=ct.subdivide(Ee,ie)[1]);var Ce=Ee[6]-Ee[0],Re=Ee[7]-Ee[1];return Math.sqrt(Ce*Ce+Re*Re)}return oe.integrate(be||b(K),ie,de,M(ie,de))},getTimeAt:function(K,ie,de){if(de===n&&(de=ie<0?1:0),ie===0)return de;var be=Math.abs,Ee=1e-12,Ce=ie>0,Re=Ce?de:0,$e=Ce?1:de,je=b(K),We=ct.getLength(K,Re,$e,je),Ge=be(ie)-We;if(be(Ge)<Ee)return Ce?$e:Re;if(Ge>Ee)return null;var mt=ie/We,ot=0;function Pe(ae){return ot+=oe.integrate(je,de,ae,M(de,ae)),de=ae,ot-ie}return oe.findRoot(Pe,je,de+mt,Re,$e,32,1e-12)},getPoint:function(K,ie){return U(K,ie,0,!1)},getTangent:function(K,ie){return U(K,ie,1,!0)},getWeightedTangent:function(K,ie){return U(K,ie,1,!1)},getNormal:function(K,ie){return U(K,ie,2,!0)},getWeightedNormal:function(K,ie){return U(K,ie,2,!1)},getCurvature:function(K,ie){return U(K,ie,3,!1).x},getPeaks:function(K){var ie=K[0],de=K[1],be=K[2],Ee=K[3],Ce=K[4],Re=K[5],$e=K[6],je=K[7],We=-ie+3*be-3*Ce+$e,Ge=3*ie-6*be+3*Ce,mt=-3*ie+3*be,ot=-de+3*Ee-3*Re+je,Pe=3*de-6*Ee+3*Re,ae=-3*de+3*Ee,re=1e-8,X=1-re,ne=[];return oe.solveCubic(9*(We*We+ot*ot),9*(We*Ge+Pe*ot),2*(Ge*Ge+Pe*Pe)+3*(mt*We+ae*ot),mt*Ge+Pe*ae,ne,re,X),ne.sort()}}}},new function(){function b(Ge,mt,ot,Pe,ae,re,X){var ne=!X&&ot.getPrevious()===ae,pe=!X&&ot!==ae&&ot.getNext()===ae,xe=1e-8,ye=1-xe;if(Pe!==null&&Pe>=(ne?xe:0)&&Pe<=(pe?ye:1)&&re!==null&&re>=(pe?xe:0)&&re<=(ne?ye:1)){var De=new Ut(ot,Pe,null,X),Oe=new Ut(ae,re,null,X);De._intersection=Oe,Oe._intersection=De,(!mt||mt(De))&&Ut.insert(Ge,De,!0)}}function M(Ge,mt,ot,Pe,ae,re,X,ne,pe,xe,ye,De,Oe){if(++pe>=4096||++ne>=40)return pe;var Ve=1e-9,Je=mt[0],et=mt[1],Le=mt[6],qe=mt[7],dt=zt.getSignedDistance,Pt=dt(Je,et,Le,qe,mt[2],mt[3]),o=dt(Je,et,Le,qe,mt[4],mt[5]),Me=Pt*o>0?3/4:4/9,li=Me*Math.min(0,Pt,o),di=Me*Math.max(0,Pt,o),fi=dt(Je,et,Le,qe,Ge[0],Ge[1]),ti=dt(Je,et,Le,qe,Ge[2],Ge[3]),ui=dt(Je,et,Le,qe,Ge[4],Ge[5]),Ri=dt(Je,et,Le,qe,Ge[6],Ge[7]),bi=U(fi,ti,ui,Ri),Si=bi[0],Jt=bi[1],Sn,ur;if(Pt===0&&o===0&&fi===0&&ti===0&&ui===0&&Ri===0||(Sn=K(Si,Jt,li,di))==null||(ur=K(Si.reverse(),Jt.reverse(),li,di))==null)return pe;var mn=xe+(ye-xe)*Sn,Hn=xe+(ye-xe)*ur;if(Math.max(Oe-De,Hn-mn)<Ve){var Yr=(mn+Hn)/2,Qi=(De+Oe)/2;b(ae,re,X?Pe:ot,X?Qi:Yr,X?ot:Pe,X?Yr:Qi)}else{Ge=ct.getPart(Ge,Sn,ur);var hr=Oe-De;if(ur-Sn>.8)if(Hn-mn>hr){var Gn=ct.subdivide(Ge,.5),Yr=(mn+Hn)/2;pe=M(mt,Gn[0],Pe,ot,ae,re,!X,ne,pe,De,Oe,mn,Yr),pe=M(mt,Gn[1],Pe,ot,ae,re,!X,ne,pe,De,Oe,Yr,Hn)}else{var Gn=ct.subdivide(mt,.5),Qi=(De+Oe)/2;pe=M(Gn[0],Ge,Pe,ot,ae,re,!X,ne,pe,De,Qi,mn,Hn),pe=M(Gn[1],Ge,Pe,ot,ae,re,!X,ne,pe,Qi,Oe,mn,Hn)}else hr===0||hr>=Ve?pe=M(mt,Ge,Pe,ot,ae,re,!X,ne,pe,De,Oe,mn,Hn):pe=M(Ge,mt,ot,Pe,ae,re,X,ne,pe,mn,Hn,De,Oe)}return pe}function U(Ge,mt,ot,Pe){var ae=[0,Ge],re=[1/3,mt],X=[2/3,ot],ne=[1,Pe],pe=mt-(2*Ge+Pe)/3,xe=ot-(Ge+2*Pe)/3,ye;if(pe*xe<0)ye=[[ae,re,ne],[ae,X,ne]];else{var De=pe/xe;ye=[De>=2?[ae,re,ne]:De<=.5?[ae,X,ne]:[ae,re,X,ne],[ae,ne]]}return(pe||xe)<0?ye.reverse():ye}function K(Ge,mt,ot,Pe){return Ge[0][1]<ot?ie(Ge,!0,ot):mt[0][1]>Pe?ie(mt,!1,Pe):Ge[0][0]}function ie(Ge,mt,ot){for(var Pe=Ge[0][0],ae=Ge[0][1],re=1,X=Ge.length;re<X;re++){var ne=Ge[re][0],pe=Ge[re][1];if(mt?pe>=ot:pe<=ot)return pe===ot?ne:Pe+(ot-ae)*(ne-Pe)/(pe-ae);Pe=ne,ae=pe}return null}function de(Ge,mt,ot,Pe,ae){var re=oe.isZero;if(re(Pe)&&re(ae)){var X=ct.getTimeOf(Ge,new _e(mt,ot));return X===null?[]:[X]}for(var ne=Math.atan2(-ae,Pe),pe=Math.sin(ne),xe=Math.cos(ne),ye=[],De=[],Oe=0;Oe<8;Oe+=2){var Ve=Ge[Oe]-mt,Je=Ge[Oe+1]-ot;ye.push(Ve*xe-Je*pe,Ve*pe+Je*xe)}return ct.solveCubic(ye,1,0,De,0,1),De}function be(Ge,mt,ot,Pe,ae,re,X){for(var ne=mt[0],pe=mt[1],xe=mt[6],ye=mt[7],De=de(Ge,ne,pe,xe-ne,ye-pe),Oe=0,Ve=De.length;Oe<Ve;Oe++){var Je=De[Oe],et=ct.getPoint(Ge,Je),Le=ct.getTimeOf(mt,et);Le!==null&&b(ae,re,X?Pe:ot,X?Le:Je,X?ot:Pe,X?Je:Le)}}function Ee(Ge,mt,ot,Pe,ae,re){var X=zt.intersect(Ge[0],Ge[1],Ge[6],Ge[7],mt[0],mt[1],mt[6],mt[7]);X&&b(ae,re,ot,ct.getTimeOf(Ge,X),Pe,ct.getTimeOf(mt,X))}function Ce(Ge,mt,ot,Pe,ae,re){var X=1e-12,ne=Math.min,pe=Math.max;if(pe(Ge[0],Ge[2],Ge[4],Ge[6])+X>ne(mt[0],mt[2],mt[4],mt[6])&&ne(Ge[0],Ge[2],Ge[4],Ge[6])-X<pe(mt[0],mt[2],mt[4],mt[6])&&pe(Ge[1],Ge[3],Ge[5],Ge[7])+X>ne(mt[1],mt[3],mt[5],mt[7])&&ne(Ge[1],Ge[3],Ge[5],Ge[7])-X<pe(mt[1],mt[3],mt[5],mt[7])){var xe=je(Ge,mt);if(xe)for(var ye=0;ye<2;ye++){var De=xe[ye];b(ae,re,ot,De[0],Pe,De[1],!0)}else{var Oe=ct.isStraight(Ge),Ve=ct.isStraight(mt),Je=Oe&&Ve,et=Oe&&!Ve,Le=ae.length;if((Je?Ee:Oe||Ve?be:M)(et?mt:Ge,et?Ge:mt,et?Pe:ot,et?ot:Pe,ae,re,et,0,0,0,1,0,1),!Je||ae.length===Le)for(var ye=0;ye<4;ye++){var qe=ye>>1,dt=ye&1,Pt=qe*6,o=dt*6,Me=new _e(Ge[Pt],Ge[Pt+1]),li=new _e(mt[o],mt[o+1]);Me.isClose(li,X)&&b(ae,re,ot,qe,Pe,dt)}}}return ae}function Re(Ge,mt,ot,Pe){var ae=ct.classify(Ge);if(ae.type==="loop"){var re=ae.roots;b(ot,Pe,mt,re[0],mt,re[1])}return ot}function $e(Ge,mt,ot,Pe,ae,re){var X=1e-7,ne=!mt;ne&&(mt=Ge);for(var pe=Ge.length,xe=mt.length,ye=new Array(pe),De=ne?ye:new Array(xe),Oe=[],Ve=0;Ve<pe;Ve++)ye[Ve]=Ge[Ve].getValues(Pe);if(!ne)for(var Ve=0;Ve<xe;Ve++)De[Ve]=mt[Ve].getValues(ae);for(var Je=$.findCurveBoundsCollisions(ye,De,X),et=0;et<pe;et++){var Le=Ge[et],qe=ye[et];ne&&Re(qe,Le,Oe,ot);var dt=Je[et];if(dt)for(var Pt=0;Pt<dt.length;Pt++){if(re&&Oe.length)return Oe;var o=dt[Pt];if(!ne||o>et){var Me=mt[o],li=De[o];Ce(qe,li,Le,Me,Oe,ot)}}}return Oe}function je(Ge,mt){function ot(Ri){var bi=Ri[6]-Ri[0],Si=Ri[7]-Ri[1];return bi*bi+Si*Si}var Pe=Math.abs,ae=zt.getDistance,re=1e-8,X=1e-7,ne=ct.isStraight(Ge),pe=ct.isStraight(mt),xe=ne&&pe,ye=ot(Ge)<ot(mt),De=ye?mt:Ge,Oe=ye?Ge:mt,Ve=De[0],Je=De[1],et=De[6]-Ve,Le=De[7]-Je;if(ae(Ve,Je,et,Le,Oe[0],Oe[1],!0)<X&&ae(Ve,Je,et,Le,Oe[6],Oe[7],!0)<X)!xe&&ae(Ve,Je,et,Le,De[2],De[3],!0)<X&&ae(Ve,Je,et,Le,De[4],De[5],!0)<X&&ae(Ve,Je,et,Le,Oe[2],Oe[3],!0)<X&&ae(Ve,Je,et,Le,Oe[4],Oe[5],!0)<X&&(ne=pe=xe=!0);else if(xe)return null;if(ne^pe)return null;for(var qe=[Ge,mt],dt=[],Pt=0;Pt<4&&dt.length<2;Pt++){var o=Pt&1,Me=o^1,li=Pt>>1,di=ct.getTimeOf(qe[o],new _e(qe[Me][li?6:0],qe[Me][li?7:1]));if(di!=null){var fi=o?[li,di]:[di,li];(!dt.length||Pe(fi[0]-dt[0][0])>re&&Pe(fi[1]-dt[0][1])>re)&&dt.push(fi)}if(Pt>2&&!dt.length)break}if(dt.length!==2)dt=null;else if(!xe){var ti=ct.getPart(Ge,dt[0][0],dt[1][0]),ui=ct.getPart(mt,dt[0][1],dt[1][1]);(Pe(ui[2]-ti[2])>X||Pe(ui[3]-ti[3])>X||Pe(ui[4]-ti[4])>X||Pe(ui[5]-ti[5])>X)&&(dt=null)}return dt}function We(Ge,mt){var ot=Ge[0],Pe=Ge[1],ae=Ge[2],re=Ge[3],X=Ge[4],ne=Ge[5],pe=Ge[6],xe=Ge[7],ye=mt.normalize(),De=ye.x,Oe=ye.y,Ve=3*pe-9*X+9*ae-3*ot,Je=3*xe-9*ne+9*re-3*Pe,et=6*X-12*ae+6*ot,Le=6*ne-12*re+6*Pe,qe=3*ae-3*ot,dt=3*re-3*Pe,Pt=2*Ve*Oe-2*Je*De,o=[];if(Math.abs(Pt)<oe.CURVETIME_EPSILON){var Me=Ve*dt-Je*qe,Pt=Ve*Le-Je*et;if(Pt!=0){var li=-Me/Pt;li>=0&&li<=1&&o.push(li)}}else{var di=(et*et-4*Ve*qe)*Oe*Oe+(-2*et*Le+4*Je*qe+4*Ve*dt)*De*Oe+(Le*Le-4*Je*dt)*De*De,fi=et*Oe-Le*De;if(di>=0&&Pt!=0){var ti=Math.sqrt(di),ui=-(fi+ti)/Pt,Ri=(-fi+ti)/Pt;ui>=0&&ui<=1&&o.push(ui),Ri>=0&&Ri<=1&&o.push(Ri)}}return o}return{getIntersections:function(Ge){var mt=this.getValues(),ot=Ge&&Ge!==this&&Ge.getValues();return ot?Ce(mt,ot,this,Ge,[]):Re(mt,this,[])},statics:{getOverlaps:je,getIntersections:$e,getCurveLineIntersections:de,getTimesWithTangent:We}}}),Ut=v.extend({_class:"CurveLocation",initialize:function(M,U,K,ie,de){if(U>=.99999999){var be=M.getNext();be&&(U=0,M=be)}this._setCurve(M),this._time=U,this._point=K||M.getPointAtTime(U),this._overlap=ie,this._distance=de,this._intersection=this._next=this._previous=null},_setPath:function(b){this._path=b,this._version=b?b._version:0},_setCurve:function(b){this._setPath(b._path),this._curve=b,this._segment=null,this._segment1=b._segment1,this._segment2=b._segment2},_setSegment:function(b){var M=b.getCurve();M?this._setCurve(M):(this._setPath(b._path),this._segment1=b,this._segment2=null),this._segment=b,this._time=b===this._segment1?0:1,this._point=b._point.clone()},getSegment:function(){var b=this._segment;if(!b){var M=this.getCurve(),U=this.getTime();U===0?b=M._segment1:U===1?b=M._segment2:U!=null&&(b=M.getPartLength(0,U)<M.getPartLength(U,1)?M._segment1:M._segment2),this._segment=b}return b},getCurve:function(){var b=this._path,M=this;b&&b._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function U(K){var ie=K&&K.getCurve();if(ie&&(M._time=ie.getTimeOf(M._point))!=null)return M._setCurve(ie),ie}return this._curve||U(this._segment)||U(this._segment1)||U(this._segment2.getPrevious())},getPath:function(){var b=this.getCurve();return b&&b._path},getIndex:function(){var b=this.getCurve();return b&&b.getIndex()},getTime:function(){var b=this.getCurve(),M=this._time;return b&&M==null?this._time=b.getTimeOf(this._point):M},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var b=this._offset;if(b==null){b=0;var M=this.getPath(),U=this.getIndex();if(M&&U!=null)for(var K=M.getCurves(),ie=0;ie<U;ie++)b+=K[ie].getLength();this._offset=b+=this.getCurveOffset()}return b},getCurveOffset:function(){var b=this._curveOffset;if(b==null){var M=this.getCurve(),U=this.getTime();this._curveOffset=b=U!=null&&M&&M.getPartLength(0,U)}return b},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var b=this.getCurve(),M=b&&b.divideAtTime(this.getTime());return M&&this._setSegment(M._segment1),M},split:function(){var b=this.getCurve(),M=b._path,U=b&&b.splitAtTime(this.getTime());return U&&this._setSegment(M.getLastSegment()),U},equals:function(b,M){var U=this===b;if(!U&&b instanceof Ut){var K=this.getCurve(),ie=b.getCurve(),de=K._path,be=ie._path;if(de===be){var Ee=Math.abs,Ce=1e-7,Re=Ee(this.getOffset()-b.getOffset()),$e=!M&&this._intersection,je=!M&&b._intersection;U=(Re<Ce||de&&Ee(de.getLength()-Re)<Ce)&&(!$e&&!je||$e&&je&&$e.equals(je,!0))}}return U},toString:function(){var b=[],M=this.getPoint(),U=he.instance;M&&b.push("point: "+M);var K=this.getIndex();K!=null&&b.push("index: "+K);var ie=this.getTime();return ie!=null&&b.push("time: "+U.number(ie)),this._distance!=null&&b.push("distance: "+U.number(this._distance)),"{ "+b.join(", ")+" }"},isTouching:function(){var b=this._intersection;if(b&&this.getTangent().isCollinear(b.getTangent())){var M=this.getCurve(),U=b.getCurve();return!(M.isStraight()&&U.isStraight()&&M.getLine().intersect(U.getLine()))}return!1},isCrossing:function(){var b=this._intersection;if(!b)return!1;var M=this.getTime(),U=b.getTime(),K=1e-8,ie=1-K,de=M>=K&&M<=ie,be=U>=K&&U<=ie;if(de&&be)return!this.isTouching();var Ee=this.getCurve(),Ce=Ee&&M<K?Ee.getPrevious():Ee,Re=b.getCurve(),$e=Re&&U<K?Re.getPrevious():Re;if(M>ie&&(Ee=Ee.getNext()),U>ie&&(Re=Re.getNext()),!Ce||!Ee||!$e||!Re)return!1;var je=[];function We(De,Oe){var Ve=De.getValues(),Je=ct.classify(Ve).roots||ct.getPeaks(Ve),et=Je.length,Le=ct.getLength(Ve,Oe&&et?Je[et-1]:0,!Oe&&et?Je[0]:1);je.push(et?Le:Le/32)}function Ge(De,Oe,Ve){return Oe<Ve?De>Oe&&De<Ve:De>Oe||De<Ve}de||(We(Ce,!0),We(Ee,!1)),be||(We($e,!0),We(Re,!1));var mt=this.getPoint(),ot=Math.min.apply(Math,je),Pe=de?Ee.getTangentAtTime(M):Ee.getPointAt(ot).subtract(mt),ae=de?Pe.negate():Ce.getPointAt(-ot).subtract(mt),re=be?Re.getTangentAtTime(U):Re.getPointAt(ot).subtract(mt),X=be?re.negate():$e.getPointAt(-ot).subtract(mt),ne=ae.getAngle(),pe=Pe.getAngle(),xe=X.getAngle(),ye=re.getAngle();return!!(de?Ge(ne,xe,ye)^Ge(pe,xe,ye)&&Ge(ne,ye,xe)^Ge(pe,ye,xe):Ge(xe,ne,pe)^Ge(ye,ne,pe)&&Ge(xe,pe,ne)^Ge(ye,pe,ne))},hasOverlap:function(){return!!this._overlap}},v.each(ct._evaluateMethods,function(b){var M=b+"At";this[b]=function(){var U=this.getCurve(),K=this.getTime();return K!=null&&U&&U[M](K,!0)}},{preserve:!0}),new function(){function b(M,U,K){var ie=M.length,de=0,be=ie-1;function Ee(mt,ot){for(var Pe=mt+ot;Pe>=-1&&Pe<=ie;Pe+=ot){var ae=M[(Pe%ie+ie)%ie];if(!U.getPoint().isClose(ae.getPoint(),1e-7))break;if(U.equals(ae))return ae}return null}for(;de<=be;){var Ce=de+be>>>1,Re=M[Ce],$e;if(K&&($e=U.equals(Re)?Re:Ee(Ce,-1)||Ee(Ce,1)))return U._overlap&&($e._overlap=$e._intersection._overlap=!0),$e;var je=U.getPath(),We=Re.getPath(),Ge=je!==We?je._id-We._id:U.getIndex()+U.getTime()-(Re.getIndex()+Re.getTime());Ge<0?be=Ce-1:de=Ce+1}return M.splice(de,0,U),U}return{statics:{insert:b,expand:function(M){for(var U=M.slice(),K=M.length-1;K>=0;K--)b(U,M[K]._intersection,!1);return U}}}}),Ft=Ue.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(b){var M,U,K;if(v.isPlainObject(b)?(U=b.segments,M=b.pathData):Array.isArray(b)?U=b:typeof b=="string"&&(M=b),U){var ie=U[0];K=ie&&Array.isArray(ie[0])}else M&&(K=(M.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(M));var de=K?yi:Vt;return new de(b)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(b){this.isClockwise()!=(b=!!b)&&this.reverse()},setPathData:function(b){var M=b&&b.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),U,K=!1,ie,de,be=new _e,Ee=new _e;function Ce(X,ne){var pe=+U[X];return K&&(pe+=be[ne]),pe}function Re(X){return new _e(Ce(X,"x"),Ce(X+1,"y"))}this.clear();for(var $e=0,je=M&&M.length;$e<je;$e++){var We=M[$e],Ge=We[0],mt=Ge.toLowerCase();U=We.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var ot=U&&U.length;switch(K=Ge===mt,ie==="z"&&!/[mz]/.test(mt)&&this.moveTo(be),mt){case"m":case"l":for(var Pe=mt==="m",ae=0;ae<ot;ae+=2)this[Pe?"moveTo":"lineTo"](be=Re(ae)),Pe&&(Ee=be,Pe=!1);de=be;break;case"h":case"v":var re=mt==="h"?"x":"y";be=be.clone();for(var ae=0;ae<ot;ae++)be[re]=Ce(ae,re),this.lineTo(be);de=be;break;case"c":for(var ae=0;ae<ot;ae+=6)this.cubicCurveTo(Re(ae),de=Re(ae+2),be=Re(ae+4));break;case"s":for(var ae=0;ae<ot;ae+=4)this.cubicCurveTo(/[cs]/.test(ie)?be.multiply(2).subtract(de):be,de=Re(ae),be=Re(ae+2)),ie=mt;break;case"q":for(var ae=0;ae<ot;ae+=4)this.quadraticCurveTo(de=Re(ae),be=Re(ae+2));break;case"t":for(var ae=0;ae<ot;ae+=2)this.quadraticCurveTo(de=/[qt]/.test(ie)?be.multiply(2).subtract(de):be,be=Re(ae)),ie=mt;break;case"a":for(var ae=0;ae<ot;ae+=7)this.arcTo(be=Re(ae+5),new nt(+U[ae],+U[ae+1]),+U[ae+2],+U[ae+4],+U[ae+3]);break;case"z":this.closePath(1e-12),be=Ee;break}ie=mt}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(b){var M=b.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(b):{};return M.onPath||!!(this.getFillRule()==="evenodd"?M.windingL&1||M.windingR&1:M.winding)},getIntersections:function(b,M,U,K){var ie=this===b||!b,de=this._matrix._orNullIfIdentity(),be=ie?de:(U||b._matrix)._orNullIfIdentity();return ie||this.getBounds(de).intersects(b.getBounds(be),1e-12)?ct.getIntersections(this.getCurves(),!ie&&b.getCurves(),M,de,be,K):[]},getCrossings:function(b){return this.getIntersections(b,function(M){return M.isCrossing()})},getNearestLocation:function(){for(var b=_e.read(arguments),M=this.getCurves(),U=1/0,K=null,ie=0,de=M.length;ie<de;ie++){var be=M[ie].getNearestLocation(b);be._distance<U&&(U=be._distance,K=be)}return K},getNearestPoint:function(){var b=this.getNearestLocation.apply(this,arguments);return b&&b.getPoint()},interpolate:function(b,M,U){var K=!this._children,ie=K?"_segments":"_children",de=b[ie],be=M[ie],Ee=this[ie];if(!de||!be||de.length!==be.length)throw new Error("Invalid operands in interpolate() call: "+b+", "+M);var Ce=Ee.length,Re=be.length;if(Ce<Re)for(var $e=K?Ye:Vt,je=Ce;je<Re;je++)this.add(new $e);else Ce>Re&&this[K?"removeSegments":"removeChildren"](Re,Ce);for(var je=0;je<Re;je++)Ee[je].interpolate(de[je],be[je],U);K&&(this.setClosed(b._closed),this._changed(9))},compare:function(b){var M=!1;if(b){var U=this._children||[this],K=b._children?b._children.slice():[b],ie=U.length,de=K.length,be=[],Ee=0;M=!0;for(var Ce=$.findItemBoundsCollisions(U,K,oe.GEOMETRIC_EPSILON),Re=ie-1;Re>=0&&M;Re--){var $e=U[Re];M=!1;var je=Ce[Re];if(je)for(var We=je.length-1;We>=0&&!M;We--)$e.compare(K[je[We]])&&(be[je[We]]||(be[je[We]]=!0,Ee++),M=!0)}M=M&&Ee===de}return M}}),Vt=Ft.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(M){this._closed=!1,this._segments=[],this._version=0;var U=arguments,K=Array.isArray(M)?typeof M[0]=="object"?M:U:M&&M.size===n&&(M.x!==n||M.point!==n)?U:null;K&&K.length>0?this.setSegments(K):(this._curves=n,this._segmentSelection=0,!K&&typeof M=="string"&&(this.setPathData(M),M=null)),this._initialize(!K&&M)},_equals:function(b){return this._closed===b._closed&&v.equals(this._segments,b._segments)},copyContent:function(b){this.setSegments(b._segments),this._closed=b._closed},_changed:function b(M){if(b.base.call(this,M),M&8){if(this._length=this._area=n,M&32)this._version++;else if(this._curves)for(var U=0,K=this._curves.length;U<K;U++)this._curves[U]._changed()}else M&64&&(this._bounds=n)},getStyle:function(){var b=this._parent;return(b instanceof yi?b:this)._style},getSegments:function(){return this._segments},setSegments:function(b){var M=this.isFullySelected(),U=b&&b.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,U){var K=b[U-1];typeof K=="boolean"&&(this.setClosed(K),U--),this._add(Ye.readList(b,0,{},U))}M&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var b=this._curves,M=this._segments;if(!b){var U=this._countCurves();b=this._curves=new Array(U);for(var K=0;K<U;K++)b[K]=new ct(this,M[K],M[K+1]||M[0])}return b},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var b=this.getCurves();return b[b.length-1]},isClosed:function(){return this._closed},setClosed:function(b){if(this._closed!=(b=!!b)){if(this._closed=b,this._curves){var M=this._curves.length=this._countCurves();b&&(this._curves[M-1]=new ct(this,this._segments[M-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(b,M){var U=this._segments,K=U.length,ie=new he(M),de=new Array(6),be=!0,Ee,Ce,Re,$e,je,We,Ge,mt,ot=[];function Pe(re,X){if(re._transformCoordinates(b,de),Ee=de[0],Ce=de[1],be)ot.push("M"+ie.pair(Ee,Ce)),be=!1;else if(je=de[2],We=de[3],je===Ee&&We===Ce&&Ge===Re&&mt===$e){if(!X){var ne=Ee-Re,pe=Ce-$e;ot.push(ne===0?"v"+ie.number(pe):pe===0?"h"+ie.number(ne):"l"+ie.pair(ne,pe))}}else ot.push("c"+ie.pair(Ge-Re,mt-$e)+" "+ie.pair(je-Re,We-$e)+" "+ie.pair(Ee-Re,Ce-$e));Re=Ee,$e=Ce,Ge=de[4],mt=de[5]}if(!K)return"";for(var ae=0;ae<K;ae++)Pe(U[ae]);return this._closed&&K>0&&(Pe(U[0],!0),ot.push("z")),ot.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(b){for(var M=this._segments,U=new Array(6),K=0,ie=M.length;K<ie;K++)M[K]._transformCoordinates(b,U,!0);return!0},_add:function(b,be){for(var U=this._segments,K=this._curves,ie=b.length,de=be==null,be=de?U.length:be,Ee=0;Ee<ie;Ee++){var Ce=b[Ee];Ce._path&&(Ce=b[Ee]=Ce.clone()),Ce._path=this,Ce._index=be+Ee,Ce._selection&&this._updateSelection(Ce,0,Ce._selection)}if(de)v.push(U,b);else{U.splice.apply(U,[be,0].concat(b));for(var Ee=be+ie,Re=U.length;Ee<Re;Ee++)U[Ee]._index=Ee}if(K){var $e=this._countCurves(),je=be>0&&be+ie-1===$e?be-1:be,We=je,Ge=Math.min(je+ie,$e);b._curves&&(K.splice.apply(K,[je,0].concat(b._curves)),We+=b._curves.length);for(var Ee=We;Ee<Ge;Ee++)K.splice(Ee,0,new ct(this,null,null));this._adjustCurves(je,Ge)}return this._changed(41),b},_adjustCurves:function(b,M){for(var U=this._segments,K=this._curves,ie,de=b;de<M;de++)ie=K[de],ie._path=this,ie._segment1=U[de],ie._segment2=U[de+1]||U[0],ie._changed();(ie=K[this._closed&&!b?U.length-1:b-1])&&(ie._segment2=U[b]||U[0],ie._changed()),(ie=K[M])&&(ie._segment1=U[M],ie._changed())},_countCurves:function(){var b=this._segments.length;return!this._closed&&b>0?b-1:b},add:function(b){var M=arguments;return M.length>1&&typeof b!="number"?this._add(Ye.readList(M)):this._add([Ye.read(M)])[0]},insert:function(b,M){var U=arguments;return U.length>2&&typeof M!="number"?this._add(Ye.readList(U,1),b):this._add([Ye.read(U,1)],b)[0]},addSegment:function(){return this._add([Ye.read(arguments)])[0]},insertSegment:function(b){return this._add([Ye.read(arguments,1)],b)[0]},addSegments:function(b){return this._add(Ye.readList(b))},insertSegments:function(b,M){return this._add(Ye.readList(M),b)},removeSegment:function(b){return this.removeSegments(b,b+1)[0]||null},removeSegments:function(b,M,U){b=b||0,M=v.pick(M,this._segments.length);var K=this._segments,ie=this._curves,de=K.length,be=K.splice(b,M-b),Ee=be.length;if(!Ee)return be;for(var Ce=0;Ce<Ee;Ce++){var Re=be[Ce];Re._selection&&this._updateSelection(Re,Re._selection,0),Re._index=Re._path=null}for(var Ce=b,$e=K.length;Ce<$e;Ce++)K[Ce]._index=Ce;if(ie){for(var je=b>0&&M===de+(this._closed?1:0)?b-1:b,ie=ie.splice(je,Ee),Ce=ie.length-1;Ce>=0;Ce--)ie[Ce]._path=null;U&&(be._curves=ie.slice(1)),this._adjustCurves(je,je)}return this._changed(41),be},clear:"#removeSegments",hasHandles:function(){for(var b=this._segments,M=0,U=b.length;M<U;M++)if(b[M].hasHandles())return!0;return!1},clearHandles:function(){for(var b=this._segments,M=0,U=b.length;M<U;M++)b[M].clearHandles()},getLength:function(){if(this._length==null){for(var b=this.getCurves(),M=0,U=0,K=b.length;U<K;U++)M+=b[U].getLength();this._length=M}return this._length},getArea:function(){var b=this._area;if(b==null){var M=this._segments,U=this._closed;b=0;for(var K=0,ie=M.length;K<ie;K++){var de=K+1===ie;b+=ct.getArea(ct.getValues(M[K],M[de?0:K+1],null,de&&!U))}this._area=b}return b},isFullySelected:function(){var b=this._segments.length;return this.isSelected()&&b>0&&this._segmentSelection===b*7},setFullySelected:function(b){b&&this._selectSegments(!0),this.setSelected(b)},setSelection:function b(M){M&1||this._selectSegments(!1),b.base.call(this,M)},_selectSegments:function(b){var M=this._segments,U=M.length,K=b?7:0;this._segmentSelection=K*U;for(var ie=0;ie<U;ie++)M[ie]._selection=K},_updateSelection:function(b,M,U){b._selection=U;var K=this._segmentSelection+=U-M;K>0&&this.setSelected(!0)},divideAt:function(b){var M=this.getLocationAt(b),U;return M&&(U=M.getCurve().divideAt(M.getCurveOffset()))?U._segment1:null},splitAt:function(b){var M=this.getLocationAt(b),U=M&&M.index,K=M&&M.time,ie=1e-8,de=1-ie;K>de&&(U++,K=0);var be=this.getCurves();if(U>=0&&U<be.length){K>=ie&&be[U++].divideAtTime(K);var Ee=this.removeSegments(U,this._segments.length,!0),Ce;return this._closed?(this.setClosed(!1),Ce=this):(Ce=new Vt(Ue.NO_INSERT),Ce.insertAbove(this),Ce.copyAttributes(this)),Ce._add(Ee,0),this.addSegment(Ee[0]),Ce}return null},split:function(b,M){var U,K=M===n?b:(U=this.getCurves()[b])&&U.getLocationAtTime(M);return K!=null?this.splitAt(K):null},join:function(b,M){var U=M||0;if(b&&b!==this){var K=b._segments,ie=this.getLastSegment(),de=b.getLastSegment();if(!de)return this;ie&&ie._point.isClose(de._point,U)&&b.reverse();var be=b.getFirstSegment();if(ie&&ie._point.isClose(be._point,U))ie.setHandleOut(be._handleOut),this._add(K.slice(1));else{var Ee=this.getFirstSegment();Ee&&Ee._point.isClose(be._point,U)&&b.reverse(),de=b.getLastSegment(),Ee&&Ee._point.isClose(de._point,U)?(Ee.setHandleIn(de._handleIn),this._add(K.slice(0,K.length-1),0)):this._add(K.slice())}b._closed&&this._add([K[0]]),b.remove()}var Ce=this.getFirstSegment(),Re=this.getLastSegment();return Ce!==Re&&Ce._point.isClose(Re._point,U)&&(Ce.setHandleIn(Re._handleIn),Re.remove(),this.setClosed(!0)),this},reduce:function(b){for(var M=this.getCurves(),U=b&&b.simplify,K=U?1e-7:0,ie=M.length-1;ie>=0;ie--){var de=M[ie];!de.hasHandles()&&(!de.hasLength(K)||U&&de.isCollinear(de.getNext()))&&de.remove()}return this},reverse:function(){this._segments.reverse();for(var b=0,M=this._segments.length;b<M;b++){var U=this._segments[b],K=U._handleIn;U._handleIn=U._handleOut,U._handleOut=K,U._index=b}this._curves=null,this._changed(9)},flatten:function(b){for(var M=new Ci(this,b||.25,256,!0),U=M.parts,K=U.length,ie=[],de=0;de<K;de++)ie.push(new Ye(U[de].curve.slice(0,2)));!this._closed&&K>0&&ie.push(new Ye(U[K-1].curve.slice(6))),this.setSegments(ie)},simplify:function(b){var M=new ki(this).fit(b||2.5);return M&&this.setSegments(M),!!M},smooth:function(b){var M=this,U=b||{},K=U.type||"asymmetric",ie=this._segments,de=ie.length,be=this._closed;function Ee(Si,Jt){var Sn=Si&&Si.index;if(Sn!=null){var ur=Si.path;if(ur&&ur!==M)throw new Error(Si._class+" "+Sn+" of "+ur+" is not part of "+M);Jt&&Si instanceof ct&&Sn++}else Sn=typeof Si=="number"?Si:Jt;return Math.min(Sn<0&&be?Sn%de:Sn<0?Sn+de:Sn,de-1)}var Ce=be&&U.from===n&&U.to===n,Re=Ee(U.from,0),$e=Ee(U.to,de-1);if(Re>$e)if(be)Re-=de;else{var je=Re;Re=$e,$e=je}if(/^(?:asymmetric|continuous)$/.test(K)){var We=K==="asymmetric",Ge=Math.min,mt=$e-Re+1,ot=mt-1,Pe=Ce?Ge(mt,4):1,ae=Pe,re=Pe,X=[];if(be||(ae=Ge(1,Re),re=Ge(1,de-$e-1)),ot+=ae+re,ot<=1)return;for(var ne=0,pe=Re-ae;ne<=ot;ne++,pe++)X[ne]=ie[(pe<0?pe+de:pe)%de]._point;for(var xe=X[0]._x+2*X[1]._x,ye=X[0]._y+2*X[1]._y,De=2,Oe=ot-1,Ve=[xe],Je=[ye],et=[De],Le=[],qe=[],ne=1;ne<ot;ne++){var dt=ne<Oe,Pt=dt||We?1:2,o=dt?4:We?2:7,Me=dt?4:We?3:8,li=dt?2:We?0:1,di=Pt/De;De=et[ne]=o-di,xe=Ve[ne]=Me*X[ne]._x+li*X[ne+1]._x-di*xe,ye=Je[ne]=Me*X[ne]._y+li*X[ne+1]._y-di*ye}Le[Oe]=Ve[Oe]/et[Oe],qe[Oe]=Je[Oe]/et[Oe];for(var ne=ot-2;ne>=0;ne--)Le[ne]=(Ve[ne]-Le[ne+1])/et[ne],qe[ne]=(Je[ne]-qe[ne+1])/et[ne];Le[ot]=(3*X[ot]._x-Le[Oe])/2,qe[ot]=(3*X[ot]._y-qe[Oe])/2;for(var ne=ae,fi=ot-re,pe=Re;ne<=fi;ne++,pe++){var ti=ie[pe<0?pe+de:pe],ui=ti._point,Ri=Le[ne]-ui._x,bi=qe[ne]-ui._y;(Ce||ne<fi)&&ti.setHandleOut(Ri,bi),(Ce||ne>ae)&&ti.setHandleIn(-Ri,-bi)}}else for(var ne=Re;ne<=$e;ne++)ie[ne<0?ne+de:ne].smooth(U,!Ce&&ne===Re,!Ce&&ne===$e)},toShape:function(b){if(!this._closed)return null;var M=this._segments,U,K,ie,de;function be(We,Ge){var mt=M[We],ot=mt.getNext(),Pe=M[Ge],ae=Pe.getNext();return mt._handleOut.isZero()&&ot._handleIn.isZero()&&Pe._handleOut.isZero()&&ae._handleIn.isZero()&&ot._point.subtract(mt._point).isCollinear(ae._point.subtract(Pe._point))}function Ee(We){var Ge=M[We],mt=Ge.getPrevious(),ot=Ge.getNext();return mt._handleOut.isZero()&&Ge._handleIn.isZero()&&Ge._handleOut.isZero()&&ot._handleIn.isZero()&&Ge._point.subtract(mt._point).isOrthogonal(ot._point.subtract(Ge._point))}function Ce(We){var Ge=M[We],mt=Ge.getNext(),ot=Ge._handleOut,Pe=mt._handleIn,ae=.5522847498307936;if(ot.isOrthogonal(Pe)){var re=Ge._point,X=mt._point,ne=new zt(re,ot,!0).intersect(new zt(X,Pe,!0),!0);return ne&&oe.isZero(ot.getLength()/ne.subtract(re).getLength()-ae)&&oe.isZero(Pe.getLength()/ne.subtract(X).getLength()-ae)}return!1}function Re(We,Ge){return M[We]._point.getDistance(M[Ge]._point)}if(!this.hasHandles()&&M.length===4&&be(0,2)&&be(1,3)&&Ee(1)?(U=gt.Rectangle,K=new nt(Re(0,3),Re(0,1)),de=M[1]._point.add(M[2]._point).divide(2)):M.length===8&&Ce(0)&&Ce(2)&&Ce(4)&&Ce(6)&&be(1,5)&&be(3,7)?(U=gt.Rectangle,K=new nt(Re(1,6),Re(0,3)),ie=K.subtract(new nt(Re(0,7),Re(1,2))).divide(2),de=M[3]._point.add(M[4]._point).divide(2)):M.length===4&&Ce(0)&&Ce(1)&&Ce(2)&&Ce(3)&&(oe.isZero(Re(0,2)-Re(1,3))?(U=gt.Circle,ie=Re(0,2)/2):(U=gt.Ellipse,ie=new nt(Re(2,0)/2,Re(3,1)/2)),de=M[1]._point),U){var $e=this.getPosition(!0),je=new U({center:$e,size:K,radius:ie,insert:!1});return je.copyAttributes(this,!0),je._matrix.prepend(this._matrix),je.rotate(de.subtract($e).getAngle()+90),(b===n||b)&&je.insertAbove(this),je}return null},toPath:"#clone",compare:function b(M){if(!M||M instanceof yi)return b.base.call(this,M);var U=this.getCurves(),K=M.getCurves(),ie=U.length,de=K.length;if(!ie||!de)return ie==de;for(var be=U[0].getValues(),Ee=[],Ce=0,Re,$e=0,je,We=0;We<de;We++){var Pe=K[We].getValues();Ee.push(Pe);var Ge=ct.getOverlaps(be,Pe);if(Ge){Re=!We&&Ge[0][0]>0?de-1:We,je=Ge[0][1];break}}for(var mt=Math.abs,ot=1e-8,Pe=Ee[Re],ae;be&&Pe;){var Ge=ct.getOverlaps(be,Pe);if(Ge){var re=Ge[0][0];if(mt(re-$e)<ot){$e=Ge[1][0],$e===1&&(be=++Ce<ie?U[Ce].getValues():null,$e=0);var X=Ge[0][1];if(mt(X-je)<ot){if(ae||(ae=[Re,X]),je=Ge[1][1],je===1&&(++Re>=de&&(Re=0),Pe=Ee[Re]||K[Re].getValues(),je=0),!be)return ae[0]===Re&&ae[1]===je;continue}}}break}return!1},_hitTestSelf:function(b,M,U,K){var ie=this,de=this.getStyle(),be=this._segments,Ee=be.length,Ce=this._closed,Re=M._tolerancePadding,$e=Re,je,We,Ge,mt,ot,Pe,ae=M.stroke&&de.hasStroke(),re=M.fill&&de.hasFill(),X=M.curves,ne=ae?de.getStrokeWidth()/2:re&&M.tolerance>0||X?0:null;ne!==null&&(ne>0?(je=de.getStrokeJoin(),We=de.getStrokeCap(),Ge=de.getMiterLimit(),$e=$e.add(Vt._getStrokePadding(ne,K))):je=We="round");function pe(Le,qe){return b.subtract(Le).divide(qe).length<=1}function xe(Le,qe,dt){if(!M.selected||qe.isSelected()){var Pt=Le._point;if(qe!==Pt&&(qe=qe.add(Pt)),pe(qe,$e))return new ut(dt,ie,{segment:Le,point:qe})}}function ye(Le,qe){return(qe||M.segments)&&xe(Le,Le._point,"segment")||!qe&&M.handles&&(xe(Le,Le._handleIn,"handle-in")||xe(Le,Le._handleOut,"handle-out"))}function De(Le){mt.add(Le)}function Oe(Le){var qe=Ce||Le._index>0&&Le._index<Ee-1;if((qe?je:We)==="round")return pe(Le._point,$e);if(mt=new Vt({internal:!0,closed:!0}),qe?Le.isSmooth()||Vt._addBevelJoin(Le,je,ne,Ge,null,K,De,!0):We==="square"&&Vt._addSquareCap(Le,We,ne,null,K,De,!0),!mt.isEmpty()){var dt;return mt.contains(b)||(dt=mt.getNearestLocation(b))&&pe(dt.getPoint(),Re)}}if(M.ends&&!M.segments&&!Ce){if(Pe=ye(be[0],!0)||ye(be[Ee-1],!0))return Pe}else if(M.segments||M.handles){for(var Ve=0;Ve<Ee;Ve++)if(Pe=ye(be[Ve]))return Pe}if(ne!==null){if(ot=this.getNearestLocation(b),ot){var Je=ot.getTime();Je===0||Je===1&&Ee>1?Oe(ot.getSegment())||(ot=null):pe(ot.getPoint(),$e)||(ot=null)}if(!ot&&je==="miter"&&Ee>1)for(var Ve=0;Ve<Ee;Ve++){var et=be[Ve];if(b.getDistance(et._point)<=Ge*ne&&Oe(et)){ot=et.getLocation();break}}}return!ot&&re&&this._contains(b)||ot&&!ae&&!X?new ut("fill",this):ot?new ut(ae?"stroke":"curve",this,{location:ot,point:ot.getPoint()}):null}},v.each(ct._evaluateMethods,function(b){this[b+"At"]=function(M){var U=this.getLocationAt(M);return U&&U[b]()}},{beans:!1,getLocationOf:function(){for(var b=_e.read(arguments),M=this.getCurves(),U=0,K=M.length;U<K;U++){var ie=M[U].getLocationOf(b);if(ie)return ie}return null},getOffsetOf:function(){var b=this.getLocationOf.apply(this,arguments);return b?b.getOffset():null},getLocationAt:function(b){if(typeof b=="number"){for(var M=this.getCurves(),U=0,K=0,ie=M.length;K<ie;K++){var de=U,be=M[K];if(U+=be.getLength(),U>b)return be.getLocationAt(b-de)}if(M.length>0&&b<=this.getLength())return new Ut(M[M.length-1],1)}else if(b&&b.getPath&&b.getPath()===this)return b;return null},getOffsetsWithTangent:function(){var b=_e.read(arguments);if(b.isZero())return[];for(var M=[],U=0,K=this.getCurves(),ie=0,de=K.length;ie<de;ie++){for(var be=K[ie],Ee=be.getTimesWithTangent(b),Ce=0,Re=Ee.length;Ce<Re;Ce++){var $e=U+be.getOffsetAtTime(Ee[Ce]);M.indexOf($e)<0&&M.push($e)}U+=be.length}return M}}),new function(){function b(U,K,ie,de){if(de<=0)return;var be=de/2,Ee=de-2,Ce=be-1,Re=new Array(6),$e,je;function We(re){var X=Re[re],ne=Re[re+1];($e!=X||je!=ne)&&(U.beginPath(),U.moveTo($e,je),U.lineTo(X,ne),U.stroke(),U.beginPath(),U.arc(X,ne,be,0,Math.PI*2,!0),U.fill())}for(var Ge=0,mt=K.length;Ge<mt;Ge++){var ot=K[Ge],Pe=ot._selection;if(ot._transformCoordinates(ie,Re),$e=Re[0],je=Re[1],Pe&2&&We(2),Pe&4&&We(4),U.fillRect($e-be,je-be,de,de),Ee>0&&!(Pe&1)){var ae=U.fillStyle;U.fillStyle="#ffffff",U.fillRect($e-Ce,je-Ce,Ee,Ee),U.fillStyle=ae}}}function M(U,K,ie){var de=K._segments,be=de.length,Ee=new Array(6),Ce=!0,Re,$e,je,We,Ge,mt,ot,Pe;function ae(X){if(ie)X._transformCoordinates(ie,Ee),Re=Ee[0],$e=Ee[1];else{var ne=X._point;Re=ne._x,$e=ne._y}if(Ce)U.moveTo(Re,$e),Ce=!1;else{if(ie)Ge=Ee[2],mt=Ee[3];else{var pe=X._handleIn;Ge=Re+pe._x,mt=$e+pe._y}Ge===Re&&mt===$e&&ot===je&&Pe===We?U.lineTo(Re,$e):U.bezierCurveTo(ot,Pe,Ge,mt,Re,$e)}if(je=Re,We=$e,ie)ot=Ee[4],Pe=Ee[5];else{var pe=X._handleOut;ot=je+pe._x,Pe=We+pe._y}}for(var re=0;re<be;re++)ae(de[re]);K._closed&&be>0&&ae(de[0])}return{_draw:function(U,K,ie,de){var be=K.dontStart,Ee=K.dontFinish||K.clip,Ce=this.getStyle(),Re=Ce.hasFill(),$e=Ce.hasStroke(),je=Ce.getDashArray(),We=!_n.support.nativeDash&&$e&&je&&je.length;be||U.beginPath(),(Re||$e&&!We||Ee)&&(M(U,this,de),this._closed&&U.closePath());function Ge(X){return je[(X%We+We)%We]}if(!Ee&&(Re||$e)&&(this._setStyles(U,K,ie),Re&&(U.fill(Ce.getFillRule()),U.shadowColor="rgba(0,0,0,0)"),$e)){if(We){be||U.beginPath();for(var mt=new Ci(this,.25,32,!1,de),ot=mt.length,Pe=-Ce.getDashOffset(),ae,re=0;Pe>0;)Pe-=Ge(re--)+Ge(re--);for(;Pe<ot;)ae=Pe+Ge(re++),(Pe>0||ae>0)&&mt.drawPart(U,Math.max(Pe,0),Math.max(ae,0)),Pe=ae+Ge(re++)}U.stroke()}},_drawSelected:function(U,K){U.beginPath(),M(U,this,K),U.stroke(),b(U,this._segments,K,_n.settings.handleSize)}}},new function(){function b(M){var U=M._segments;if(!U.length)throw new Error("Use a moveTo() command first");return U[U.length-1]}return{moveTo:function(){var M=this._segments;M.length===1&&this.removeSegment(0),M.length||this._add([new Ye(_e.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Ye(_e.read(arguments))])},cubicCurveTo:function(){var M=arguments,U=_e.read(M),K=_e.read(M),ie=_e.read(M),de=b(this);de.setHandleOut(U.subtract(de._point)),this._add([new Ye(ie,K.subtract(ie))])},quadraticCurveTo:function(){var M=arguments,U=_e.read(M),K=_e.read(M),ie=b(this)._point;this.cubicCurveTo(U.add(ie.subtract(U).multiply(1/3)),U.add(K.subtract(U).multiply(1/3)),K)},curveTo:function(){var M=arguments,U=_e.read(M),K=_e.read(M),ie=v.pick(v.read(M),.5),de=1-ie,be=b(this)._point,Ee=U.subtract(be.multiply(de*de)).subtract(K.multiply(ie*ie)).divide(2*ie*de);if(Ee.isNaN())throw new Error("Cannot put a curve through points with parameter = "+ie);this.quadraticCurveTo(Ee,K)},arcTo:function(){var M=arguments,U=Math.abs,K=Math.sqrt,ie=b(this),de=ie._point,be=_e.read(M),Ee,Ce=v.peek(M),Re=v.pick(Ce,!0),$e,je,We,Ge;if(typeof Re=="boolean")var mt=de.add(be).divide(2),Ee=mt.add(mt.subtract(de).rotate(Re?-90:90));else if(v.remain(M)<=2)Ee=be,be=_e.read(M);else if(!de.equals(be)){var ot=nt.read(M),Pe=oe.isZero;if(Pe(ot.width)||Pe(ot.height))return this.lineTo(be);var ae=v.read(M),Re=!!v.read(M),re=!!v.read(M),mt=de.add(be).divide(2),X=de.subtract(mt).rotate(-ae),ne=X.x,pe=X.y,xe=U(ot.width),ye=U(ot.height),De=xe*xe,Oe=ye*ye,Ve=ne*ne,Je=pe*pe,et=K(Ve/De+Je/Oe);if(et>1&&(xe*=et,ye*=et,De=xe*xe,Oe=ye*ye),et=(De*Oe-De*Je-Oe*Ve)/(De*Je+Oe*Ve),U(et)<1e-12&&(et=0),et<0)throw new Error("Cannot create an arc with the given arguments");$e=new _e(xe*pe/ye,-ye*ne/xe).multiply((re===Re?-1:1)*K(et)).rotate(ae).add(mt),Ge=new xt().translate($e).rotate(ae).scale(xe,ye),We=Ge._inverseTransform(de),je=We.getDirectedAngle(Ge._inverseTransform(be)),!Re&&je>0?je-=360:Re&&je<0&&(je+=360)}if(Ee){var Le=new zt(de.add(Ee).divide(2),Ee.subtract(de).rotate(90),!0),qe=new zt(Ee.add(be).divide(2),be.subtract(Ee).rotate(90),!0),dt=new zt(de,be),Pt=dt.getSide(Ee);if($e=Le.intersect(qe,!0),!$e){if(!Pt)return this.lineTo(be);throw new Error("Cannot create an arc with the given arguments")}We=de.subtract($e),je=We.getDirectedAngle(be.subtract($e));var o=dt.getSide($e,!0);o===0?je=Pt*U(je):Pt===o&&(je+=je<0?360:-360)}if(je){for(var Me=1e-5,li=U(je),di=li>=360?4:Math.ceil((li-Me)/90),fi=je/di,ti=fi*Math.PI/360,ui=4/3*Math.sin(ti)/(1+Math.cos(ti)),Ri=[],bi=0;bi<=di;bi++){var X=be,Si=null;if(bi<di&&(Si=We.rotate(90).multiply(ui),Ge?(X=Ge._transformPoint(We),Si=Ge._transformPoint(We.add(Si)).subtract(X)):X=$e.add(We)),!bi)ie.setHandleOut(Si);else{var Jt=We.rotate(-90).multiply(ui);Ge&&(Jt=Ge._transformPoint(We.add(Jt)).subtract(X)),Ri.push(new Ye(X,Jt,Si))}We=We.rotate(fi)}this._add(Ri)}},lineBy:function(){var M=_e.read(arguments),U=b(this)._point;this.lineTo(U.add(M))},curveBy:function(){var M=arguments,U=_e.read(M),K=_e.read(M),ie=v.read(M),de=b(this)._point;this.curveTo(de.add(U),de.add(K),ie)},cubicCurveBy:function(){var M=arguments,U=_e.read(M),K=_e.read(M),ie=_e.read(M),de=b(this)._point;this.cubicCurveTo(de.add(U),de.add(K),de.add(ie))},quadraticCurveBy:function(){var M=arguments,U=_e.read(M),K=_e.read(M),ie=b(this)._point;this.quadraticCurveTo(ie.add(U),ie.add(K))},arcBy:function(){var M=arguments,U=b(this)._point,K=U.add(_e.read(M)),ie=v.pick(v.peek(M),!0);typeof ie=="boolean"?this.arcTo(K,ie):this.arcTo(K,U.add(_e.read(M)))},closePath:function(M){this.setClosed(!0),this.join(this,M)}}},{_getBounds:function(b,M){var U=M.handle?"getHandleBounds":M.stroke?"getStrokeBounds":"getBounds";return Vt[U](this._segments,this._closed,this,b,M)},statics:{getBounds:function(b,M,U,K,ie,de){var be=b[0];if(!be)return new st;var Ee=new Array(6),Ce=be._transformCoordinates(K,new Array(6)),Re=Ce.slice(0,2),$e=Re.slice(),je=new Array(2);function We(ot){ot._transformCoordinates(K,Ee);for(var Pe=0;Pe<2;Pe++)ct._addBounds(Ce[Pe],Ce[Pe+4],Ee[Pe+2],Ee[Pe],Pe,de?de[Pe]:0,Re,$e,je);var ae=Ce;Ce=Ee,Ee=ae}for(var Ge=1,mt=b.length;Ge<mt;Ge++)We(b[Ge]);return M&&We(be),new st(Re[0],Re[1],$e[0]-Re[0],$e[1]-Re[1])},getStrokeBounds:function(b,M,U,K,ie){var de=U.getStyle(),be=de.hasStroke(),Ee=de.getStrokeWidth(),Ce=be&&U._getStrokeMatrix(K,ie),Re=be&&Vt._getStrokePadding(Ee,Ce),$e=Vt.getBounds(b,M,U,K,ie,Re);if(!be)return $e;var je=Ee/2,We=de.getStrokeJoin(),Ge=de.getStrokeCap(),mt=de.getMiterLimit(),ot=new st(new nt(Re));function Pe(xe){$e=$e.include(xe)}function ae(xe){$e=$e.unite(ot.setCenter(xe._point.transform(K)))}function re(xe,ye){ye==="round"||xe.isSmooth()?ae(xe):Vt._addBevelJoin(xe,ye,je,mt,K,Ce,Pe)}function X(xe,ye){ye==="round"?ae(xe):Vt._addSquareCap(xe,ye,je,K,Ce,Pe)}var ne=b.length-(M?0:1);if(ne>0){for(var pe=1;pe<ne;pe++)re(b[pe],We);M?re(b[0],We):(X(b[0],Ge),X(b[b.length-1],Ge))}return $e},_getStrokePadding:function(b,M){if(!M)return[b,b];var U=new _e(b,0).transform(M),K=new _e(0,b).transform(M),ie=U.getAngleInRadians(),de=U.getLength(),be=K.getLength(),Ee=Math.sin(ie),Ce=Math.cos(ie),Re=Math.tan(ie),$e=Math.atan2(be*Re,de),je=Math.atan2(be,Re*de);return[Math.abs(de*Math.cos($e)*Ce+be*Math.sin($e)*Ee),Math.abs(be*Math.sin(je)*Ce+de*Math.cos(je)*Ee)]},_addBevelJoin:function(b,M,U,K,ie,de,be,Ee){var Ce=b.getCurve(),Re=Ce.getPrevious(),$e=Ce.getPoint1().transform(ie),je=Re.getNormalAtTime(1).multiply(U).transform(de),We=Ce.getNormalAtTime(0).multiply(U).transform(de),Ge=je.getDirectedAngle(We);if((Ge<0||Ge>=180)&&(je=je.negate(),We=We.negate()),Ee&&be($e),be($e.add(je)),M==="miter"){var mt=new zt($e.add(je),new _e(-je.y,je.x),!0).intersect(new zt($e.add(We),new _e(-We.y,We.x),!0),!0);mt&&$e.getDistance(mt)<=K*U&&be(mt)}be($e.add(We))},_addSquareCap:function(b,M,U,K,ie,de,be){var Ee=b._point.transform(K),Ce=b.getLocation(),Re=Ce.getNormal().multiply(Ce.getTime()===0?U:-U).transform(ie);M==="square"&&(be&&(de(Ee.subtract(Re)),de(Ee.add(Re))),Ee=Ee.add(Re.rotate(-90))),de(Ee.add(Re)),de(Ee.subtract(Re))},getHandleBounds:function(b,M,U,K,ie){var de=U.getStyle(),be=ie.stroke&&de.hasStroke(),Ee,Ce;if(be){var Re=U._getStrokeMatrix(K,ie),$e=de.getStrokeWidth()/2,je=$e;de.getStrokeJoin()==="miter"&&(je=$e*de.getMiterLimit()),de.getStrokeCap()==="square"&&(je=Math.max(je,$e*Math.SQRT2)),Ee=Vt._getStrokePadding($e,Re),Ce=Vt._getStrokePadding(je,Re)}for(var We=new Array(6),Ge=1/0,mt=-Ge,ot=Ge,Pe=mt,ae=0,re=b.length;ae<re;ae++){var X=b[ae];X._transformCoordinates(K,We);for(var ne=0;ne<6;ne+=2){var pe=ne?Ee:Ce,xe=pe?pe[0]:0,ye=pe?pe[1]:0,De=We[ne],Oe=We[ne+1],Ve=De-xe,Je=De+xe,et=Oe-ye,Le=Oe+ye;Ve<Ge&&(Ge=Ve),Je>mt&&(mt=Je),et<ot&&(ot=et),Le>Pe&&(Pe=Le)}}return new st(Ge,ot,mt-Ge,Pe-ot)}}});Vt.inject({statics:new function(){var b=.5522847498307936,M=[new Ye([-1,0],[0,b],[0,-b]),new Ye([0,-1],[-b,0],[b,0]),new Ye([1,0],[0,-b],[0,b]),new Ye([0,1],[b,0],[-b,0])];function U(ie,de,be){var Ee=v.getNamed(be),Ce=new Vt(Ee&&(Ee.insert==!0?Ue.INSERT:Ee.insert==!1?Ue.NO_INSERT:null));return Ce._add(ie),Ce._closed=de,Ce.set(Ee,Ue.INSERT)}function K(ie,de,be){for(var Ee=new Array(4),Ce=0;Ce<4;Ce++){var Re=M[Ce];Ee[Ce]=new Ye(Re._point.multiply(de).add(ie),Re._handleIn.multiply(de),Re._handleOut.multiply(de))}return U(Ee,!0,be)}return{Line:function(){var ie=arguments;return U([new Ye(_e.readNamed(ie,"from")),new Ye(_e.readNamed(ie,"to"))],!1,ie)},Circle:function(){var ie=arguments,de=_e.readNamed(ie,"center"),be=v.readNamed(ie,"radius");return K(de,new nt(be),ie)},Rectangle:function(){var ie=arguments,de=st.readNamed(ie,"rectangle"),be=nt.readNamed(ie,"radius",0,{readNull:!0}),Ee=de.getBottomLeft(!0),Ce=de.getTopLeft(!0),Re=de.getTopRight(!0),$e=de.getBottomRight(!0),je;if(!be||be.isZero())je=[new Ye(Ee),new Ye(Ce),new Ye(Re),new Ye($e)];else{be=nt.min(be,de.getSize(!0).divide(2));var We=be.width,Ge=be.height,mt=We*b,ot=Ge*b;je=[new Ye(Ee.add(We,0),null,[-mt,0]),new Ye(Ee.subtract(0,Ge),[0,ot]),new Ye(Ce.add(0,Ge),null,[0,-ot]),new Ye(Ce.add(We,0),[-mt,0],null),new Ye(Re.subtract(We,0),null,[mt,0]),new Ye(Re.add(0,Ge),[0,-ot],null),new Ye($e.subtract(0,Ge),null,[0,ot]),new Ye($e.subtract(We,0),[mt,0])]}return U(je,!0,ie)},RoundRectangle:"#Rectangle",Ellipse:function(){var ie=arguments,de=gt._readEllipse(ie);return K(de.center,de.radius,ie)},Oval:"#Ellipse",Arc:function(){var ie=arguments,de=_e.readNamed(ie,"from"),be=_e.readNamed(ie,"through"),Ee=_e.readNamed(ie,"to"),Ce=v.getNamed(ie),Re=new Vt(Ce&&Ce.insert==!1&&Ue.NO_INSERT);return Re.moveTo(de),Re.arcTo(be,Ee),Re.set(Ce)},RegularPolygon:function(){for(var ie=arguments,de=_e.readNamed(ie,"center"),be=v.readNamed(ie,"sides"),Ee=v.readNamed(ie,"radius"),Ce=360/be,Re=be%3===0,$e=new _e(0,Re?-Ee:Ee),je=Re?-1:.5,We=new Array(be),Ge=0;Ge<be;Ge++)We[Ge]=new Ye(de.add($e.rotate((Ge+je)*Ce)));return U(We,!0,ie)},Star:function(){for(var ie=arguments,de=_e.readNamed(ie,"center"),be=v.readNamed(ie,"points")*2,Ee=v.readNamed(ie,"radius1"),Ce=v.readNamed(ie,"radius2"),Re=360/be,$e=new _e(0,-1),je=new Array(be),We=0;We<be;We++)je[We]=new Ye(de.add($e.rotate(Re*We).multiply(We%2?Ce:Ee)));return U(je,!0,ie)}}}});var yi=Ft.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(M){this._children=[],this._namedChildren={},this._initialize(M)||(typeof M=="string"?this.setPathData(M):this.addChildren(Array.isArray(M)?M:arguments))},insertChildren:function b(M,U){var K=U,ie=K[0];ie&&typeof ie[0]=="number"&&(K=[K]);for(var de=U.length-1;de>=0;de--){var be=K[de];K===U&&!(be instanceof Vt)&&(K=v.slice(K)),Array.isArray(be)?K[de]=new Vt({segments:be,insert:!1}):be instanceof yi&&(K.splice.apply(K,[de,1].concat(be.removeChildren())),be.remove())}return b.base.call(this,M,K)},reduce:function b(M){for(var U=this._children,K=U.length-1;K>=0;K--){var ie=U[K].reduce(M);ie.isEmpty()&&ie.remove()}if(!U.length){var ie=new Vt(Ue.NO_INSERT);return ie.copyAttributes(this),ie.insertAbove(this),this.remove(),ie}return b.base.call(this)},isClosed:function(){for(var b=this._children,M=0,U=b.length;M<U;M++)if(!b[M]._closed)return!1;return!0},setClosed:function(b){for(var M=this._children,U=0,K=M.length;U<K;U++)M[U].setClosed(b)},getFirstSegment:function(){var b=this.getFirstChild();return b&&b.getFirstSegment()},getLastSegment:function(){var b=this.getLastChild();return b&&b.getLastSegment()},getCurves:function(){for(var b=this._children,M=[],U=0,K=b.length;U<K;U++)v.push(M,b[U].getCurves());return M},getFirstCurve:function(){var b=this.getFirstChild();return b&&b.getFirstCurve()},getLastCurve:function(){var b=this.getLastChild();return b&&b.getLastCurve()},getArea:function(){for(var b=this._children,M=0,U=0,K=b.length;U<K;U++)M+=b[U].getArea();return M},getLength:function(){for(var b=this._children,M=0,U=0,K=b.length;U<K;U++)M+=b[U].getLength();return M},getPathData:function(b,M){for(var U=this._children,K=[],ie=0,de=U.length;ie<de;ie++){var be=U[ie],Ee=be._matrix;K.push(be.getPathData(b&&!Ee.isIdentity()?b.appended(Ee):b,M))}return K.join("")},_hitTestChildren:function b(M,U,K){return b.base.call(this,M,U.class===Vt||U.type==="path"?U:v.set({},U,{fill:!1}),K)},_draw:function(b,M,U,K){var ie=this._children;if(ie.length){M=M.extend({dontStart:!0,dontFinish:!0}),b.beginPath();for(var de=0,be=ie.length;de<be;de++)ie[de].draw(b,M,K);if(!M.clip){this._setStyles(b,M,U);var Ee=this._style;Ee.hasFill()&&(b.fill(Ee.getFillRule()),b.shadowColor="rgba(0,0,0,0)"),Ee.hasStroke()&&b.stroke()}}},_drawSelected:function(b,M,U){for(var K=this._children,ie=0,de=K.length;ie<de;ie++){var be=K[ie],Ee=be._matrix;U[be._id]||be._drawSelected(b,Ee.isIdentity()?M:M.appended(Ee))}}},new function(){function b(M,U){var K=M._children;if(U&&!K.length)throw new Error("Use a moveTo() command first");return K[K.length-1]}return v.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(M){this[M]=function(){var U=b(this,!0);U[M].apply(U,arguments)}},{moveTo:function(){var M=b(this),U=M&&M.isEmpty()?M:new Vt(Ue.NO_INSERT);U!==M&&this.addChild(U),U.moveTo.apply(U,arguments)},moveBy:function(){var M=b(this,!0),U=M&&M.getLastSegment(),K=_e.read(arguments);this.moveTo(U?K.add(U._point):K)},closePath:function(M){b(this,!0).closePath(M)}})},v.each(["reverse","flatten","simplify","smooth"],function(b){this[b]=function(M){for(var U=this._children,K,ie=0,de=U.length;ie<de;ie++)K=U[ie][b](M)||K;return K}},{}));Ft.inject(new function(){var b=Math.min,M=Math.max,U=Math.abs,K={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function ie(ae){return ae._children||[ae]}function de(ae,re){var X=ae.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(re){for(var ne=ie(X),pe=0,xe=ne.length;pe<xe;pe++){var ae=ne[pe];!ae._closed&&!ae.isEmpty()&&(ae.closePath(1e-12),ae.getFirstSegment().setHandleIn(0,0),ae.getLastSegment().setHandleOut(0,0))}X=X.resolveCrossings().reorient(X.getFillRule()==="nonzero",!0)}return X}function be(ae,re,X,ne,pe){var xe=new yi(Ue.NO_INSERT);return xe.addChildren(ae,!0),xe=xe.reduce({simplify:re}),pe&&pe.insert==!1||xe.insertAbove(ne&&X.isSibling(ne)&&X.getIndex()<ne.getIndex()?ne:X),xe.copyAttributes(X,!0),xe}function Ee(ae){return ae.hasOverlap()||ae.isCrossing()}function Ce(ae,re,X,ne){if(ne&&(ne.trace==!1||ne.stroke)&&/^(subtract|intersect)$/.test(X))return Re(ae,re,X);var pe=de(ae,!0),xe=re&&ae!==re&&de(re,!0),ye=K[X];ye[X]=!0,xe&&(ye.subtract||ye.exclude)^(xe.isClockwise()^pe.isClockwise())&&xe.reverse();var De=Ge(Ut.expand(pe.getIntersections(xe,Ee))),Oe=ie(pe),Ve=xe&&ie(xe),Je=[],et=[],Le;function qe(Si){for(var Jt=0,Sn=Si.length;Jt<Sn;Jt++){var ur=Si[Jt];v.push(Je,ur._segments),v.push(et,ur.getCurves()),ur._overlapsOnly=!0}}function dt(Si){for(var Jt=[],Sn=0,ur=Si&&Si.length;Sn<ur;Sn++)Jt.push(et[Si[Sn]]);return Jt}if(De.length){qe(Oe),Ve&&qe(Ve);for(var Pt=new Array(et.length),o=0,Me=et.length;o<Me;o++)Pt[o]=et[o].getValues();for(var li=$.findCurveBoundsCollisions(Pt,Pt,0,!0),di={},o=0;o<et.length;o++){var fi=et[o],ti=fi._path._id,ui=di[ti]=di[ti]||{};ui[fi.getIndex()]={hor:dt(li[o].hor),ver:dt(li[o].ver)}}for(var o=0,Me=De.length;o<Me;o++)ot(De[o]._segment,pe,xe,di,ye);for(var o=0,Me=Je.length;o<Me;o++){var Ri=Je[o],bi=Ri._intersection;Ri._winding||ot(Ri,pe,xe,di,ye),bi&&bi._overlap||(Ri._path._overlapsOnly=!1)}Le=Pe(Je,ye)}else Le=We(Ve?Oe.concat(Ve):Oe.slice(),function(Si){return!!ye[Si]});return be(Le,!0,ae,re,ne)}function Re(ae,re,X){var ne=de(ae),pe=de(re),xe=ne.getIntersections(pe,Ee),ye=X==="subtract",De=X==="divide",Oe={},Ve=[];function Je(qe){if(!Oe[qe._id]&&(De||pe.contains(qe.getPointAt(qe.getLength()/2))^ye))return Ve.unshift(qe),Oe[qe._id]=!0}for(var et=xe.length-1;et>=0;et--){var Le=xe[et].split();Le&&(Je(Le)&&Le.getFirstSegment().setHandleIn(0,0),ne.getLastSegment().setHandleOut(0,0))}return Je(ne),be(Ve,!1,ae,re)}function $e(ae,re){for(var X=ae;X;){if(X===re)return;X=X._previous}for(;ae._next&&ae._next!==re;)ae=ae._next;if(!ae._next){for(;re._previous;)re=re._previous;ae._next=re,re._previous=ae}}function je(ae){for(var re=ae.length-1;re>=0;re--)ae[re].clearHandles()}function We(ae,re,X){var ne=ae&&ae.length;if(ne){var pe=v.each(ae,function(li,di){this[li._id]={container:null,winding:li.isClockwise()?1:-1,index:di}},{}),xe=ae.slice().sort(function(li,di){return U(di.getArea())-U(li.getArea())}),ye=xe[0],De=$.findItemBoundsCollisions(xe,null,oe.GEOMETRIC_EPSILON);X==null&&(X=ye.isClockwise());for(var Oe=0;Oe<ne;Oe++){var Ve=xe[Oe],Je=pe[Ve._id],et=0,Le=De[Oe];if(Le){for(var qe=null,dt=Le.length-1;dt>=0;dt--)if(Le[dt]<Oe){qe=qe||Ve.getInteriorPoint();var Pt=xe[Le[dt]];if(Pt.contains(qe)){var o=pe[Pt._id];et=o.winding,Je.winding+=et,Je.container=o.exclude?o.container:Pt;break}}}if(re(Je.winding)===re(et))Je.exclude=!0,ae[Je.index]=null;else{var Me=Je.container;Ve.setClockwise(Me?!Me.isClockwise():X)}}}return ae}function Ge(ae,re,X){var ne=re&&[],pe=1e-8,xe=1-pe,ye=!1,De=X||[],Oe=X&&{},Ve,Je,et;function Le(Jt){return Jt._path._id+"."+Jt._segment1._index}for(var qe=(X&&X.length)-1;qe>=0;qe--){var dt=X[qe];dt._path&&(Oe[Le(dt)]=!0)}for(var qe=ae.length-1;qe>=0;qe--){var Pt=ae[qe],o=Pt._time,Me=o,li=re&&!re(Pt),dt=Pt._curve,di;if(dt&&(dt!==Je?(ye=!dt.hasHandles()||Oe&&Oe[Le(dt)],Ve=[],et=null,Je=dt):et>=pe&&(o/=et)),li){Ve&&Ve.push(Pt);continue}else re&&ne.unshift(Pt);if(et=Me,o<pe)di=dt._segment1;else if(o>xe)di=dt._segment2;else{var fi=dt.divideAtTime(o,!0);ye&&De.push(dt,fi),di=fi._segment1;for(var ti=Ve.length-1;ti>=0;ti--){var ui=Ve[ti];ui._time=(ui._time-o)/(1-o)}}Pt._setSegment(di);var Ri=di._intersection,bi=Pt._intersection;if(Ri){$e(Ri,bi);for(var Si=Ri;Si;)$e(Si._intersection,Ri),Si=Si._next}else di._intersection=bi}return X||je(De),ne||ae}function mt(ae,re,X,ne,pe){var xe=Array.isArray(re)?re:re[X?"hor":"ver"],ye=X?1:0,De=ye^1,Oe=[ae.x,ae.y],Ve=Oe[ye],Je=Oe[De],et=1e-9,Le=1e-6,qe=Ve-et,dt=Ve+et,Pt=0,o=0,Me=0,li=0,di=!1,fi=!1,ti=1,ui=[],Ri,bi;function Si(Xt){var en=Xt[De+0],qt=Xt[De+6];if(!(Je<b(en,qt)||Je>M(en,qt))){var kn=Xt[ye+0],Ar=Xt[ye+2],js=Xt[ye+4],Qr=Xt[ye+6];if(en===qt){(kn<dt&&Qr>qe||Qr<dt&&kn>qe)&&(di=!0);return}var Gt=Je===en?0:Je===qt||qe>M(kn,Ar,js,Qr)||dt<b(kn,Ar,js,Qr)?1:ct.solveCubic(Xt,De,Je,ui,0,1)>0?ui[0]:1,fr=Gt===0?kn:Gt===1?Qr:ct.getPoint(Xt,Gt)[X?"y":"x"],Bt=en>qt?1:-1,Gr=Ri[De]>Ri[De+6]?1:-1,Zs=Ri[ye+6];return Je!==en?(fr<qe?Me+=Bt:fr>dt?li+=Bt:di=!0,fr>Ve-Le&&fr<Ve+Le&&(ti/=2)):(Bt!==Gr?kn<qe?Me+=Bt:kn>dt&&(li+=Bt):kn!=Zs&&(Zs<dt&&fr>dt?(li+=Bt,di=!0):Zs>qe&&fr<qe&&(Me+=Bt,di=!0)),ti/=4),Ri=Xt,!pe&&fr>qe&&fr<dt&&ct.getTangent(Xt,Gt)[X?"x":"y"]===0&&mt(ae,re,!X,ne,!0)}}function Jt(Xt){var en=Xt[De+0],qt=Xt[De+2],kn=Xt[De+4],Ar=Xt[De+6];if(Je<=M(en,qt,kn,Ar)&&Je>=b(en,qt,kn,Ar)){for(var js=Xt[ye+0],Qr=Xt[ye+2],Gt=Xt[ye+4],fr=Xt[ye+6],Bt=qe>M(js,Qr,Gt,fr)||dt<b(js,Qr,Gt,fr)?[Xt]:ct.getMonoCurves(Xt,X),Gr,Zs=0,pa=Bt.length;Zs<pa;Zs++)if(Gr=Si(Bt[Zs]))return Gr}}for(var Sn=0,ur=xe.length;Sn<ur;Sn++){var mn=xe[Sn],Hn=mn._path,Yr=mn.getValues(),Qi;if((!Sn||xe[Sn-1]._path!==Hn)&&(Ri=null,Hn._closed||(bi=ct.getValues(Hn.getLastCurve().getSegment2(),mn.getSegment1(),null,!ne),bi[De]!==bi[De+6]&&(Ri=bi)),!Ri)){Ri=Yr;for(var hr=Hn.getLastCurve();hr&&hr!==mn;){var Gn=hr.getValues();if(Gn[De]!==Gn[De+6]){Ri=Gn;break}hr=hr.getPrevious()}}if(Qi=Jt(Yr))return Qi;if(Sn+1===ur||xe[Sn+1]._path!==Hn){if(bi&&(Qi=Jt(bi)))return Qi;di&&!Me&&!li&&(Me=li=Hn.isClockwise(ne)^X?1:-1),Pt+=Me,o+=li,Me=li=0,di&&(fi=!0,di=!1),bi=null}}return Pt=U(Pt),o=U(o),{winding:M(Pt,o),windingL:Pt,windingR:o,quality:ti,onPath:fi}}function ot(ae,re,X,ne,pe){var xe=[],ye=ae,De=0,et;do{var Oe=ae.getCurve();if(Oe){var Ve=Oe.getLength();xe.push({segment:ae,curve:Oe,length:Ve}),De+=Ve}ae=ae.getNext()}while(ae&&!ae._intersection&&ae!==ye);for(var Je=[.5,.25,.75],et={winding:0,quality:-1},Le=.001,qe=1-Le,dt=0;dt<Je.length&&et.quality<.5;dt++)for(var Ve=De*Je[dt],Pt=0,o=xe.length;Pt<o;Pt++){var Me=xe[Pt],li=Me.length;if(Ve<=li){var Oe=Me.curve,di=Oe._path,fi=di._parent,ti=fi instanceof yi?fi:di,ui=oe.clamp(Oe.getTimeAt(Ve),Le,qe),Ri=Oe.getPointAtTime(ui),bi=U(Oe.getTangentAtTime(ui).y)<Math.SQRT1_2,Si=null;if(pe.subtract&&X){var Jt=ti===re?X:re,Sn=Jt._getWinding(Ri,bi,!0);if(ti===re&&Sn.winding||ti===X&&!Sn.winding){if(Sn.quality<1)continue;Si={winding:0,quality:1}}}Si=Si||mt(Ri,ne[di._id][Oe.getIndex()],bi,!0),Si.quality>et.quality&&(et=Si);break}Ve-=li}for(var Pt=xe.length-1;Pt>=0;Pt--)xe[Pt].segment._winding=et}function Pe(ae,re){var X=[],ne;function pe(ur){var mn;return!!(ur&&!ur._visited&&(!re||re[(mn=ur._winding||{}).winding]&&!(re.unite&&mn.winding===2&&mn.windingL&&mn.windingR)))}function xe(ur){if(ur){for(var mn=0,Hn=ne.length;mn<Hn;mn++)if(ur===ne[mn])return!0}return!1}function ye(ur){for(var mn=ur._segments,Hn=0,Yr=mn.length;Hn<Yr;Hn++)mn[Hn]._visited=!0}function De(ur,mn){var Hn=ur._intersection,Yr=Hn,Qi=[];mn&&(ne=[ur]);function hr(Gn,Xt){for(;Gn&&Gn!==Xt;){var en=Gn._segment,qt=en&&en._path;if(qt){var kn=en.getNext()||qt.getFirstSegment(),Ar=kn._intersection;en!==ur&&(xe(en)||xe(kn)||kn&&pe(en)&&(pe(kn)||Ar&&pe(Ar._segment)))&&Qi.push(en),mn&&ne.push(en)}Gn=Gn._next}}if(Hn){for(hr(Hn);Hn&&Hn._previous;)Hn=Hn._previous;hr(Hn,Yr)}return Qi}ae.sort(function(ur,mn){var Hn=ur._intersection,Yr=mn._intersection,Qi=!!(Hn&&Hn._overlap),hr=!!(Yr&&Yr._overlap),Gn=ur._path,Xt=mn._path;return Qi^hr?Qi?1:-1:!Hn^!Yr?Hn?1:-1:Gn!==Xt?Gn._id-Xt._id:ur._index-mn._index});for(var Oe=0,Ve=ae.length;Oe<Ve;Oe++){var Je=ae[Oe],et=pe(Je),Le=null,qe=!1,dt=!0,Pt=[],o,Me,li;if(et&&Je._path._overlapsOnly){var di=Je._path,fi=Je._intersection._segment._path;di.compare(fi)&&(di.getArea()&&X.push(di.clone(!1)),ye(di),ye(fi),et=!1)}for(;et;){var ti=!Le,ui=De(Je,ti),Ri=ui.shift(),qe=!ti&&(xe(Je)||xe(Ri)),bi=!qe&&Ri;if(ti&&(Le=new Vt(Ue.NO_INSERT),o=null),qe){(Je.isFirst()||Je.isLast())&&(dt=Je._path._closed),Je._visited=!0;break}if(bi&&o&&(Pt.push(o),o=null),o||(bi&&ui.push(Je),o={start:Le._segments.length,crossings:ui,visited:Me=[],handleIn:li}),bi&&(Je=Ri),!pe(Je)){Le.removeSegments(o.start);for(var Si=0,Jt=Me.length;Si<Jt;Si++)Me[Si]._visited=!1;Me.length=0;do Je=o&&o.crossings.shift(),(!Je||!Je._path)&&(Je=null,o=Pt.pop(),o&&(Me=o.visited,li=o.handleIn));while(o&&!pe(Je));if(!Je)break}var Sn=Je.getNext();Le.add(new Ye(Je._point,li,Sn&&Je._handleOut)),Je._visited=!0,Me.push(Je),Je=Sn||Je._path.getFirstSegment(),li=Sn&&Sn._handleIn}qe&&(dt&&(Le.getFirstSegment().setHandleIn(li),Le.setClosed(dt)),Le.getArea()!==0&&X.push(Le))}return X}return{_getWinding:function(ae,re,X){return mt(ae,this.getCurves(),re,X)},unite:function(ae,re){return Ce(this,ae,"unite",re)},intersect:function(ae,re){return Ce(this,ae,"intersect",re)},subtract:function(ae,re){return Ce(this,ae,"subtract",re)},exclude:function(ae,re){return Ce(this,ae,"exclude",re)},divide:function(ae,re){return re&&(re.trace==!1||re.stroke)?Re(this,ae,"divide"):be([this.subtract(ae,re),this.intersect(ae,re)],!0,this,ae,re)},resolveCrossings:function(){var ae=this._children,re=ae||[this];function X(o,Me){var li=o&&o._intersection;return li&&li._overlap&&li._path===Me}var ne=!1,pe=!1,xe=this.getIntersections(null,function(o){return o.hasOverlap()&&(ne=!0)||o.isCrossing()&&(pe=!0)}),ye=ne&&pe&&[];if(xe=Ut.expand(xe),ne)for(var De=Ge(xe,function(o){return o.hasOverlap()},ye),Oe=De.length-1;Oe>=0;Oe--){var Ve=De[Oe],Je=Ve._path,et=Ve._segment,Le=et.getPrevious(),qe=et.getNext();X(Le,Je)&&X(qe,Je)&&(et.remove(),Le._handleOut._set(0,0),qe._handleIn._set(0,0),Le!==et&&!Le.getCurve().hasLength()&&(qe._handleIn.set(Le._handleIn),Le.remove()))}pe&&(Ge(xe,ne&&function(o){var Me=o.getCurve(),li=o.getSegment(),di=o._intersection,fi=di._curve,ti=di._segment;if(Me&&fi&&Me._path&&fi._path)return!0;li&&(li._intersection=null),ti&&(ti._intersection=null)},ye),ye&&je(ye),re=Pe(v.each(re,function(o){v.push(this,o._segments)},[])));var dt=re.length,Pt;return dt>1&&ae?(re!==ae&&this.setChildren(re),Pt=this):dt===1&&!ae&&(re[0]!==this&&this.setSegments(re[0].removeSegments()),Pt=this),Pt||(Pt=new yi(Ue.NO_INSERT),Pt.addChildren(re),Pt=Pt.reduce(),Pt.copyAttributes(this),this.replaceWith(Pt)),Pt},reorient:function(ae,re){var X=this._children;return X&&X.length?this.setChildren(We(this.removeChildren(),function(ne){return!!(ae?ne:ne&1)},re)):re!==n&&this.setClockwise(re),this},getInteriorPoint:function(){var ae=this.getBounds(),re=ae.getCenter(!0);if(!this.contains(re)){for(var X=this.getCurves(),ne=re.y,pe=[],xe=[],ye=0,De=X.length;ye<De;ye++){var Oe=X[ye].getValues(),Ve=Oe[1],Je=Oe[3],et=Oe[5],Le=Oe[7];if(ne>=b(Ve,Je,et,Le)&&ne<=M(Ve,Je,et,Le))for(var qe=ct.getMonoCurves(Oe),dt=0,Pt=qe.length;dt<Pt;dt++){var o=qe[dt],Me=o[1],li=o[7];if(Me!==li&&(ne>=Me&&ne<=li||ne>=li&&ne<=Me)){var di=ne===Me?o[0]:ne===li?o[6]:ct.solveCubic(o,1,ne,xe,0,1)===1?ct.getPoint(o,xe[0]).x:(o[0]+o[6])/2;pe.push(di)}}}pe.length>1&&(pe.sort(function(fi,ti){return fi-ti}),re.x=(pe[0]+pe[1])/2)}return re}}});var Ci=v.extend({_class:"PathFlattener",initialize:function(b,M,U,K,ie){var de=[],be=[],Ee=0,Ce=1/(U||32),Re=b._segments,$e=Re[0],je;function We(Pe,ae){var re=ct.getValues(Pe,ae,ie);de.push(re),Ge(re,Pe._index,0,1)}function Ge(Pe,ae,re,X){if(X-re>Ce&&!(K&&ct.isStraight(Pe))&&!ct.isFlatEnough(Pe,M||.25)){var ne=ct.subdivide(Pe,.5),pe=(re+X)/2;Ge(ne[0],ae,re,pe),Ge(ne[1],ae,pe,X)}else{var xe=Pe[6]-Pe[0],ye=Pe[7]-Pe[1],De=Math.sqrt(xe*xe+ye*ye);De>0&&(Ee+=De,be.push({offset:Ee,curve:Pe,index:ae,time:X}))}}for(var mt=1,ot=Re.length;mt<ot;mt++)je=Re[mt],We($e,je),$e=je;b._closed&&We(je||$e,Re[0]),this.curves=de,this.parts=be,this.length=Ee,this.index=0},_get:function(b){for(var M=this.parts,U=M.length,K,ie=this.index;K=ie,!(!ie||M[--ie].offset<b););for(;K<U;K++){var de=M[K];if(de.offset>=b){this.index=K;var be=M[K-1],Ee=be&&be.index===de.index?be.time:0,Ce=be?be.offset:0;return{index:de.index,time:Ee+(de.time-Ee)*(b-Ce)/(de.offset-Ce)}}}return{index:M[U-1].index,time:1}},drawPart:function(b,M,U){for(var K=this._get(M),ie=this._get(U),de=K.index,be=ie.index;de<=be;de++){var Ee=ct.getPart(this.curves[de],de===K.index?K.time:0,de===ie.index?ie.time:1);de===K.index&&b.moveTo(Ee[0],Ee[1]),b.bezierCurveTo.apply(b,Ee.slice(2))}}},v.each(ct._evaluateMethods,function(b){this[b+"At"]=function(M){var U=this._get(M);return ct[b](this.curves[U.index],U.time)}},{})),ki=v.extend({initialize:function(b){for(var M=this.points=[],U=b._segments,K=b._closed,ie=0,de,be=U.length;ie<be;ie++){var Ee=U[ie].point;(!de||!de.equals(Ee))&&M.push(de=Ee.clone())}K&&(M.unshift(M[M.length-1]),M.push(M[1])),this.closed=K},fit:function(b){var M=this.points,U=M.length,K=null;return U>0&&(K=[new Ye(M[0])],U>1&&(this.fitCubic(K,b,0,U-1,M[1].subtract(M[0]),M[U-2].subtract(M[U-1])),this.closed&&(K.shift(),K.pop()))),K},fitCubic:function(b,M,U,K,ie,de){var be=this.points;if(K-U===1){var Ee=be[U],Ce=be[K],Re=Ee.getDistance(Ce)/3;this.addCurve(b,[Ee,Ee.add(ie.normalize(Re)),Ce.add(de.normalize(Re)),Ce]);return}for(var $e=this.chordLengthParameterize(U,K),je=Math.max(M,M*M),We,Ge=!0,mt=0;mt<=4;mt++){var ot=this.generateBezier(U,K,$e,ie,de),Pe=this.findMaxError(U,K,ot,$e);if(Pe.error<M&&Ge){this.addCurve(b,ot);return}if(We=Pe.index,Pe.error>=je)break;Ge=this.reparameterize(U,K,$e,ot),je=Pe.error}var ae=be[We-1].subtract(be[We+1]);this.fitCubic(b,M,U,We,ie,ae),this.fitCubic(b,M,We,K,ae.negate(),de)},addCurve:function(b,M){var U=b[b.length-1];U.setHandleOut(M[1].subtract(M[0])),b.push(new Ye(M[3],M[2].subtract(M[3])))},generateBezier:function(b,M,U,K,ie){for(var de=1e-12,be=Math.abs,Ee=this.points,Ce=Ee[b],Re=Ee[M],$e=[[0,0],[0,0]],je=[0,0],We=0,Ge=M-b+1;We<Ge;We++){var mt=U[We],ot=1-mt,Pe=3*mt*ot,ae=ot*ot*ot,re=Pe*ot,X=Pe*mt,ne=mt*mt*mt,pe=K.normalize(re),xe=ie.normalize(X),ye=Ee[b+We].subtract(Ce.multiply(ae+re)).subtract(Re.multiply(X+ne));$e[0][0]+=pe.dot(pe),$e[0][1]+=pe.dot(xe),$e[1][0]=$e[0][1],$e[1][1]+=xe.dot(xe),je[0]+=pe.dot(ye),je[1]+=xe.dot(ye)}var De=$e[0][0]*$e[1][1]-$e[1][0]*$e[0][1],Oe,Ve;if(be(De)>de){var Je=$e[0][0]*je[1]-$e[1][0]*je[0],et=je[0]*$e[1][1]-je[1]*$e[0][1];Oe=et/De,Ve=Je/De}else{var Le=$e[0][0]+$e[0][1],qe=$e[1][0]+$e[1][1];Oe=Ve=be(Le)>de?je[0]/Le:be(qe)>de?je[1]/qe:0}var dt=Re.getDistance(Ce),Pt=de*dt,o,Me;if(Oe<Pt||Ve<Pt)Oe=Ve=dt/3;else{var li=Re.subtract(Ce);o=K.normalize(Oe),Me=ie.normalize(Ve),o.dot(li)-Me.dot(li)>dt*dt&&(Oe=Ve=dt/3,o=Me=null)}return[Ce,Ce.add(o||K.normalize(Oe)),Re.add(Me||ie.normalize(Ve)),Re]},reparameterize:function(b,M,U,K){for(var ie=b;ie<=M;ie++)U[ie-b]=this.findRoot(K,this.points[ie],U[ie-b]);for(var ie=1,de=U.length;ie<de;ie++)if(U[ie]<=U[ie-1])return!1;return!0},findRoot:function(b,M,U){for(var K=[],ie=[],de=0;de<=2;de++)K[de]=b[de+1].subtract(b[de]).multiply(3);for(var de=0;de<=1;de++)ie[de]=K[de+1].subtract(K[de]).multiply(2);var be=this.evaluate(3,b,U),Ee=this.evaluate(2,K,U),Ce=this.evaluate(1,ie,U),Re=be.subtract(M),$e=Ee.dot(Ee)+Re.dot(Ce);return oe.isMachineZero($e)?U:U-Re.dot(Ee)/$e},evaluate:function(b,M,U){for(var K=M.slice(),ie=1;ie<=b;ie++)for(var de=0;de<=b-ie;de++)K[de]=K[de].multiply(1-U).add(K[de+1].multiply(U));return K[0]},chordLengthParameterize:function(b,M){for(var U=[0],K=b+1;K<=M;K++)U[K-b]=U[K-b-1]+this.points[K].getDistance(this.points[K-1]);for(var K=1,ie=M-b;K<=ie;K++)U[K]/=U[ie];return U},findMaxError:function(b,M,U,K){for(var ie=Math.floor((M-b+1)/2),de=0,be=b+1;be<M;be++){var Ee=this.evaluate(3,U,K[be-b]),Ce=Ee.subtract(this.points[be]),Re=Ce.x*Ce.x+Ce.y*Ce.y;Re>=de&&(de=Re,ie=be)}return{error:de,index:ie}}}),Ni=Ue.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(M){this._content="",this._lines=[];var U=M&&v.isPlainObject(M)&&M.x===n&&M.y===n;this._initialize(U&&M,!U&&_e.read(arguments))},_equals:function(b){return this._content===b._content},copyContent:function(b){this.setContent(b._content)},getContent:function(){return this._content},setContent:function(b){this._content=""+b,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),tn=Ni.extend({_class:"PointText",initialize:function(){Ni.apply(this,arguments)},getPoint:function(){var b=this._matrix.getTranslation();return new Ze(b.x,b.y,this,"setPoint")},setPoint:function(){var b=_e.read(arguments);this.translate(b.subtract(this._matrix.getTranslation()))},_draw:function(b,M,U){if(this._content){this._setStyles(b,M,U);var K=this._lines,ie=this._style,de=ie.hasFill(),be=ie.hasStroke(),Ee=ie.getLeading(),Ce=b.shadowColor;b.font=ie.getFontStyle(),b.textAlign=ie.getJustification();for(var Re=0,$e=K.length;Re<$e;Re++){b.shadowColor=Ce;var je=K[Re];de&&(b.fillText(je,0,0),b.shadowColor="rgba(0,0,0,0)"),be&&b.strokeText(je,0,0),b.translate(0,Ee)}}},_getBounds:function(b,M){var U=this._style,K=this._lines,ie=K.length,de=U.getJustification(),be=U.getLeading(),Ee=this.getView().getTextWidth(U.getFontStyle(),K),Ce=0;de!=="left"&&(Ce-=Ee/(de==="center"?2:1));var Re=new st(Ce,ie?-.75*be:0,Ee,ie*be);return b?b._transformBounds(Re,Re):Re}}),Zi=v.extend(new function(){var b={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},M={},U={transparent:[0,0,0,0]},K;function ie(Ee){var Ce=Ee.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||Ee.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),Re="rgb",$e;if(Ce){var je=Ce[4]?4:3;$e=new Array(je);for(var We=0;We<je;We++){var Ge=Ce[We+1];$e[We]=parseInt(Ge.length==1?Ge+Ge:Ge,16)/255}}else if(Ce=Ee.match(/^(rgb|hsl)a?\((.*)\)$/)){Re=Ce[1],$e=Ce[2].trim().split(/[,\s]+/g);for(var mt=Re==="hsl",We=0,ot=Math.min($e.length,4);We<ot;We++){var Pe=$e[We],Ge=parseFloat(Pe);if(mt)if(We===0){var ae=Pe.match(/([a-z]*)$/)[1];Ge*={turn:360,rad:180/Math.PI,grad:.9}[ae]||1}else We<3&&(Ge/=100);else We<3&&(Ge/=/%$/.test(Pe)?100:255);$e[We]=Ge}}else{var re=U[Ee];if(!re)if(c){K||(K=Yi.getContext(1,1,{willReadFrequently:!0}),K.globalCompositeOperation="copy"),K.fillStyle="rgba(0,0,0,0)",K.fillStyle=Ee,K.fillRect(0,0,1,1);var X=K.getImageData(0,0,1,1).data;re=U[Ee]=[X[0]/255,X[1]/255,X[2]/255]}else re=[0,0,0];$e=re.slice()}return[Re,$e]}var de=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],be={"rgb-hsb":function(Ee,Ce,Re){var $e=Math.max(Ee,Ce,Re),je=Math.min(Ee,Ce,Re),We=$e-je,Ge=We===0?0:($e==Ee?(Ce-Re)/We+(Ce<Re?6:0):$e==Ce?(Re-Ee)/We+2:(Ee-Ce)/We+4)*60;return[Ge,$e===0?0:We/$e,$e]},"hsb-rgb":function(Ee,Ce,Re){Ee=(Ee/60%6+6)%6;var je=Math.floor(Ee),$e=Ee-je,je=de[je],We=[Re,Re*(1-Ce),Re*(1-Ce*$e),Re*(1-Ce*(1-$e))];return[We[je[0]],We[je[1]],We[je[2]]]},"rgb-hsl":function(Ee,Ce,Re){var $e=Math.max(Ee,Ce,Re),je=Math.min(Ee,Ce,Re),We=$e-je,Ge=We===0,mt=Ge?0:($e==Ee?(Ce-Re)/We+(Ce<Re?6:0):$e==Ce?(Re-Ee)/We+2:(Ee-Ce)/We+4)*60,ot=($e+je)/2,Pe=Ge?0:ot<.5?We/($e+je):We/(2-$e-je);return[mt,Pe,ot]},"hsl-rgb":function(Ee,Ce,Re){if(Ee=(Ee/360%1+1)%1,Ce===0)return[Re,Re,Re];for(var $e=[Ee+1/3,Ee,Ee-1/3],je=Re<.5?Re*(1+Ce):Re+Ce-Re*Ce,We=2*Re-je,Ge=[],mt=0;mt<3;mt++){var ot=$e[mt];ot<0&&(ot+=1),ot>1&&(ot-=1),Ge[mt]=6*ot<1?We+(je-We)*6*ot:2*ot<1?je:3*ot<2?We+(je-We)*(2/3-ot)*6:We}return Ge},"rgb-gray":function(Ee,Ce,Re){return[Ee*.2989+Ce*.587+Re*.114]},"gray-rgb":function(Ee){return[Ee,Ee,Ee]},"gray-hsb":function(Ee){return[0,0,Ee]},"gray-hsl":function(Ee){return[0,0,Ee]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return v.each(b,function(Ee,Ce){M[Ce]=[],v.each(Ee,function(Re,$e){var je=v.capitalize(Re),We=/^(hue|saturation)$/.test(Re),Ge=M[Ce][$e]=Ce==="gradient"?Re==="gradient"?function(mt){var ot=this._components[0];return mt=Gi.read(Array.isArray(mt)?mt:arguments,0,{readNull:!0}),ot!==mt&&(ot&&ot._removeOwner(this),mt&&mt._addOwner(this)),mt}:function(){return _e.read(arguments,0,{readNull:Re==="highlight",clone:!0})}:function(mt){return mt==null||isNaN(mt)?0:+mt};this["get"+je]=function(){return this._type===Ce||We&&/^hs[bl]$/.test(this._type)?this._components[$e]:this._convert(Ce)[$e]},this["set"+je]=function(mt){this._type!==Ce&&!(We&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(Ce),this._properties=b[Ce],this._type=Ce),this._components[$e]=Ge.call(this,mt),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function Ee(Ce){var Re=arguments,$e=this.__read,je=0,We,Ge,mt,ot;Array.isArray(Ce)&&(Re=Ce,Ce=Re[0]);var Pe=Ce!=null&&typeof Ce;if(Pe==="string"&&Ce in b&&(We=Ce,Ce=Re[1],Array.isArray(Ce)?(Ge=Ce,mt=Re[2]):($e&&(je=1),Re=v.slice(Re,1),Pe=typeof Ce)),!Ge){if(ot=Pe==="number"?Re:Pe==="object"&&Ce.length!=null?Ce:null,ot){We||(We=ot.length>=3?"rgb":"gray");var ae=b[We].length;mt=ot[ae],$e&&(je+=ot===arguments?ae+(mt!=null?1:0):1),ot.length>ae&&(ot=v.slice(ot,0,ae))}else if(Pe==="string"){var re=ie(Ce);We=re[0],Ge=re[1],Ge.length===4&&(mt=Ge[3],Ge.length--)}else if(Pe==="object")if(Ce.constructor===Ee){if(We=Ce._type,Ge=Ce._components.slice(),mt=Ce._alpha,We==="gradient")for(var X=1,ne=Ge.length;X<ne;X++){var pe=Ge[X];pe&&(Ge[X]=pe.clone())}}else if(Ce.constructor===Gi)We="gradient",ot=Re;else{We="hue"in Ce?"lightness"in Ce?"hsl":"hsb":"gradient"in Ce||"stops"in Ce||"radial"in Ce?"gradient":"gray"in Ce?"gray":"rgb";var xe=b[We],ye=M[We];this._components=Ge=[];for(var X=0,ne=xe.length;X<ne;X++){var De=Ce[xe[X]];De==null&&!X&&We==="gradient"&&"stops"in Ce&&(De={stops:Ce.stops,radial:Ce.radial}),De=ye[X].call(this,De),De!=null&&(Ge[X]=De)}mt=Ce.alpha}$e&&We&&(je=1)}if(this._type=We||"rgb",!Ge){this._components=Ge=[];for(var ye=M[this._type],X=0,ne=ye.length;X<ne;X++){var De=ye[X].call(this,ot&&ot[X]);De!=null&&(Ge[X]=De)}}return this._components=Ge,this._properties=b[this._type],this._alpha=mt,$e&&(this.__read=je),this},set:"#initialize",_serialize:function(Ee,Ce){var Re=this.getComponents();return v.serialize(/^(gray|rgb)$/.test(this._type)?Re:[this._type].concat(Re),Ee,!0,Ce)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(Ee){var Ce;return this._type===Ee?this._components.slice():(Ce=be[this._type+"-"+Ee])?Ce.apply(this,this._components):be["rgb-"+Ee].apply(this,be[this._type+"-rgb"].apply(this,this._components))},convert:function(Ee){return new Zi(Ee,this._convert(Ee),this._alpha)},getType:function(){return this._type},setType:function(Ee){this._components=this._convert(Ee),this._properties=b[Ee],this._type=Ee},getComponents:function(){var Ee=this._components.slice();return this._alpha!=null&&Ee.push(this._alpha),Ee},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(Ee){this._alpha=Ee==null?null:Math.min(Math.max(Ee,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(Ee){var Ce=v.isPlainValue(Ee,!0)?Zi.read(arguments):Ee;return Ce===this||Ce&&this._class===Ce._class&&this._type===Ce._type&&this.getAlpha()===Ce.getAlpha()&&v.equals(this._components,Ce._components)||!1},toString:function(){for(var Ee=this._properties,Ce=[],Re=this._type==="gradient",$e=he.instance,je=0,We=Ee.length;je<We;je++){var Ge=this._components[je];Ge!=null&&Ce.push(Ee[je]+": "+(Re?Ge:$e.number(Ge)))}return this._alpha!=null&&Ce.push("alpha: "+$e.number(this._alpha)),"{ "+Ce.join(", ")+" }"},toCSS:function(Ee){var Ce=this._convert("rgb"),Re=Ee||this._alpha==null?1:this._alpha;function $e(je){return Math.round((je<0?0:je>1?1:je)*255)}return Ce=[$e(Ce[0]),$e(Ce[1]),$e(Ce[2])],Re<1&&Ce.push(Re<0?0:Re),Ee?"#"+((1<<24)+(Ce[0]<<16)+(Ce[1]<<8)+Ce[2]).toString(16).slice(1):(Ce.length==4?"rgba(":"rgb(")+Ce.join(",")+")"},toCanvasStyle:function(Ee,Ce){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var Re=this._components,$e=Re[0],je=$e._stops,We=Re[1],Ge=Re[2],mt=Re[3],ot=Ce&&Ce.inverted(),Pe;if(ot&&(We=ot._transformPoint(We),Ge=ot._transformPoint(Ge),mt&&(mt=ot._transformPoint(mt))),$e._radial){var ae=Ge.getDistance(We);if(mt){var re=mt.subtract(We);re.getLength()>ae&&(mt=We.add(re.normalize(ae-.1)))}var X=mt||We;Pe=Ee.createRadialGradient(X.x,X.y,0,We.x,We.y,ae)}else Pe=Ee.createLinearGradient(We.x,We.y,Ge.x,Ge.y);for(var ne=0,pe=je.length;ne<pe;ne++){var xe=je[ne],ye=xe._offset;Pe.addColorStop(ye??ne/(pe-1),xe._color.toCanvasStyle())}return this._canvasStyle=Pe},transform:function(Ee){if(this._type==="gradient"){for(var Ce=this._components,Re=1,$e=Ce.length;Re<$e;Re++){var je=Ce[Re];Ee._transformPoint(je,je,!0)}this._changed()}},statics:{_types:b,random:function(){var Ee=Math.random;return new Zi(Ee(),Ee(),Ee())},_setOwner:function(Ee,Ce,Re){return Ee&&(Ee._owner&&Ce&&Ee._owner!==Ce&&(Ee=Ee.clone()),!Ee._owner^!Ce&&(Ee._owner=Ce||null,Ee._setter=Re||null)),Ee}}})},new function(){var b={add:function(M,U){return M+U},subtract:function(M,U){return M-U},multiply:function(M,U){return M*U},divide:function(M,U){return M/U}};return v.each(b,function(M,U){this[U]=function(K){K=Zi.read(arguments);for(var ie=this._type,de=this._components,be=K._convert(ie),Ee=0,Ce=de.length;Ee<Ce;Ee++)be[Ee]=M(de[Ee],be[Ee]);return new Zi(ie,be,this._alpha!=null?M(this._alpha,K.getAlpha()):null)}},{})}),Gi=v.extend({_class:"Gradient",initialize:function(M,U){this._id=ce.get(),M&&v.isPlainObject(M)&&(this.set(M),M=U=null),this._stops==null&&this.setStops(M||["white","black"]),this._radial==null&&this.setRadial(typeof U=="string"&&U==="radial"||U||!1)},_serialize:function(b,M){return M.add(this,function(){return v.serialize([this._stops,this._radial],b,!0,M)})},_changed:function(){for(var b=0,M=this._owners&&this._owners.length;b<M;b++)this._owners[b]._changed()},_addOwner:function(b){this._owners||(this._owners=[]),this._owners.push(b)},_removeOwner:function(b){var M=this._owners?this._owners.indexOf(b):-1;M!=-1&&(this._owners.splice(M,1),this._owners.length||(this._owners=n))},clone:function(){for(var b=[],M=0,U=this._stops.length;M<U;M++)b[M]=this._stops[M].clone();return new Gi(b,this._radial)},getStops:function(){return this._stops},setStops:function(b){if(b.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var M=this._stops;if(M)for(var U=0,K=M.length;U<K;U++)M[U]._owner=n;M=this._stops=sn.readList(b,0,{clone:!0});for(var U=0,K=M.length;U<K;U++)M[U]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(b){this._radial=b,this._changed()},equals:function(b){if(b===this)return!0;if(b&&this._class===b._class){var M=this._stops,U=b._stops,K=M.length;if(K===U.length){for(var ie=0;ie<K;ie++)if(!M[ie].equals(U[ie]))return!1;return!0}}return!1}}),sn=v.extend({_class:"GradientStop",initialize:function(M,U){var K=M,ie=U;typeof M=="object"&&U===n&&(Array.isArray(M)&&typeof M[0]!="number"?(K=M[0],ie=M[1]):("color"in M||"offset"in M||"rampPoint"in M)&&(K=M.color,ie=M.offset||M.rampPoint||0)),this.setColor(K),this.setOffset(ie)},clone:function(){return new sn(this._color.clone(),this._offset)},_serialize:function(b,M){var U=this._color,K=this._offset;return v.serialize(K==null?[U]:[U,K],b,!0,M)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(b){this._offset=b,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Zi._setOwner(this._color,null),this._color=Zi._setOwner(Zi.read(arguments,0),this,"setColor"),this._changed()},equals:function(b){return b===this||b&&this._class===b._class&&this._color.equals(b._color)&&this._offset==b._offset||!1}}),xn=v.extend(new function(){var b={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new _e,selectedColor:null},M=v.set({},b,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),U=v.set({},M,{fillColor:new Zi}),K={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},ie={beans:!0},de={_class:"Style",beans:!0,initialize:function(Ee,Ce,Re){this._values={},this._owner=Ce,this._project=Ce&&Ce._project||Re||_n.project,this._defaults=!Ce||Ce instanceof $t?M:Ce instanceof Ni?U:b,Ee&&this.set(Ee)}};return v.each(M,function(be,Ee){var Ce=/Color$/.test(Ee),Re=Ee==="shadowOffset",$e=v.capitalize(Ee),je=K[Ee],We="set"+$e,Ge="get"+$e;de[We]=function(mt){var ot=this._owner,Pe=ot&&ot._children,ae=Pe&&Pe.length>0&&!(ot instanceof yi);if(ae)for(var re=0,X=Pe.length;re<X;re++)Pe[re]._style[We](mt);if((Ee==="selectedColor"||!ae)&&Ee in this._defaults){var ne=this._values[Ee];ne!==mt&&(Ce&&(ne&&(Zi._setOwner(ne,null),ne._canvasStyle=null),mt&&mt.constructor===Zi&&(mt=Zi._setOwner(mt,ot,ae&&We))),this._values[Ee]=mt,ot&&ot._changed(je||129))}},de[Ge]=function(mt){var ot=this._owner,Pe=ot&&ot._children,ae=Pe&&Pe.length>0&&!(ot instanceof yi),re;if(ae&&!mt)for(var X=0,ne=Pe.length;X<ne;X++){var pe=Pe[X]._style[Ge]();if(!X)re=pe;else if(!v.equals(re,pe))return n}else if(Ee in this._defaults){var re=this._values[Ee];if(re===n)re=this._defaults[Ee],re&&re.clone&&(re=re.clone());else{var xe=Ce?Zi:Re?_e:null;xe&&!(re&&re.constructor===xe)&&(this._values[Ee]=re=xe.read([re],0,{readNull:!0,clone:!0}))}}return re&&Ce&&(re=Zi._setOwner(re,ot,ae&&We)),re},ie[Ge]=function(mt){return this._style[Ge](mt)},ie[We]=function(mt){this._style[We](mt)}}),v.each({Font:"FontFamily",WindingRule:"FillRule"},function(be,Ee){var Ce="get"+Ee,Re="set"+Ee;de[Ce]=ie[Ce]="#get"+be,de[Re]=ie[Re]="#set"+be}),Ue.inject(ie),de},{set:function(b){var M=b instanceof xn,U=M?b._values:b;if(U){for(var K in U)if(K in this._defaults){var ie=U[K];this[K]=ie&&M&&ie.clone?ie.clone():ie}}},equals:function(b){function M(U,K,ie){var de=U._values,be=K._values,Ee=K._defaults;for(var Ce in de){var Re=de[Ce],$e=be[Ce];if(!(ie&&Ce in be)&&!v.equals(Re,$e===n?Ee[Ce]:$e))return!1}return!0}return b===this||b&&this._class===b._class&&M(this,b)&&M(b,this,!0)||!1},_dispose:function(){var b;b=this.getFillColor(),b&&(b._canvasStyle=null),b=this.getStrokeColor(),b&&(b._canvasStyle=null),b=this.getShadowColor(),b&&(b._canvasStyle=null)},hasFill:function(){var b=this.getFillColor();return!!b&&b.alpha>0},hasStroke:function(){var b=this.getStrokeColor();return!!b&&b.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var b=this.getShadowColor();return!!b&&b.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var b=this.getFontSize();return this.getFontWeight()+" "+b+(/[a-z]/i.test(b+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function b(){var M=b.base.call(this),U=this.getFontSize();return/pt|em|%|px/.test(U)&&(U=this.getView().getPixelSize(U)),M??U*1.2}}),Ti=new function(){function b(M,U,K,ie){for(var de=["","webkit","moz","Moz","ms","o"],be=U[0].toUpperCase()+U.substring(1),Ee=0;Ee<6;Ee++){var Ce=de[Ee],Re=Ce?Ce+be:U;if(Re in M){if(K)M[Re]=ie;else return M[Re];break}}}return{getStyles:function(M){var U=M&&M.nodeType!==9?M.ownerDocument:M,K=U&&U.defaultView;return K&&K.getComputedStyle(M,"")},getBounds:function(M,U){var K=M.ownerDocument,ie=K.body,de=K.documentElement,be;try{be=M.getBoundingClientRect()}catch{be={left:0,top:0,width:0,height:0}}var Ee=be.left-(de.clientLeft||ie.clientLeft||0),Ce=be.top-(de.clientTop||ie.clientTop||0);if(!U){var Re=K.defaultView;Ee+=Re.pageXOffset||de.scrollLeft||ie.scrollLeft,Ce+=Re.pageYOffset||de.scrollTop||ie.scrollTop}return new st(Ee,Ce,be.width,be.height)},getViewportBounds:function(M){var U=M.ownerDocument,K=U.defaultView,ie=U.documentElement;return new st(0,0,K.innerWidth||ie.clientWidth,K.innerHeight||ie.clientHeight)},getOffset:function(M,U){return Ti.getBounds(M,U).getPoint()},getSize:function(M){return Ti.getBounds(M,!0).getSize()},isInvisible:function(M){return Ti.getSize(M).equals(new nt(0,0))},isInView:function(M){return!Ti.isInvisible(M)&&Ti.getViewportBounds(M).intersects(Ti.getBounds(M,!0))},isInserted:function(M){return g.body.contains(M)},getPrefixed:function(M,U){return M&&b(M,U)},setPrefixed:function(M,U,K){if(typeof U=="object")for(var ie in U)b(M,ie,!0,U[ie]);else b(M,U,!0,K)}}},gi={add:function(b,M){if(b)for(var U in M)for(var K=M[U],ie=U.split(/[\s,]+/g),de=0,be=ie.length;de<be;de++){var Ee=ie[de],Ce=b===g&&(Ee==="touchstart"||Ee==="touchmove")?{passive:!1}:!1;b.addEventListener(Ee,K,Ce)}},remove:function(b,M){if(b)for(var U in M)for(var K=M[U],ie=U.split(/[\s,]+/g),de=0,be=ie.length;de<be;de++)b.removeEventListener(ie[de],K,!1)},getPoint:function(b){var M=b.targetTouches?b.targetTouches.length?b.targetTouches[0]:b.changedTouches[0]:b;return new _e(M.pageX||M.clientX+g.documentElement.scrollLeft,M.pageY||M.clientY+g.documentElement.scrollTop)},getTarget:function(b){return b.target||b.srcElement},getRelatedTarget:function(b){return b.relatedTarget||b.toElement},getOffset:function(b,M){return gi.getPoint(b).subtract(Ti.getOffset(M||gi.getTarget(b)))}};gi.requestAnimationFrame=new function(){var b=Ti.getPrefixed(c,"requestAnimationFrame"),M=!1,U=[],K;function ie(){var de=U;U=[];for(var be=0,Ee=de.length;be<Ee;be++)de[be]();M=b&&U.length,M&&b(ie)}return function(de){U.push(de),b?M||(b(ie),M=!0):K||(K=setInterval(ie,1e3/60))}};var Oi=v.extend(S,{_class:"View",initialize:function b(M,U){function K(je){return U[je]||parseInt(U.getAttribute(je),10)}function ie(){var je=Ti.getSize(U);return je.isNaN()||je.isZero()?new nt(K("width"),K("height")):je}var de;if(c&&U){this._id=U.getAttribute("id"),this._id==null&&U.setAttribute("id",this._id="paper-view-"+b._id++),gi.add(U,this._viewEvents);var be="none";if(Ti.setPrefixed(U.style,{userDrag:be,userSelect:be,touchCallout:be,contentZooming:be,tapHighlightColor:"rgba(0,0,0,0)"}),a.hasAttribute(U,"resize")){var Ee=this;gi.add(c,this._windowEvents={resize:function(){Ee.setViewSize(ie())}})}if(de=ie(),a.hasAttribute(U,"stats")&&typeof Stats<"u"){this._stats=new Stats;var Ce=this._stats.domElement,Re=Ce.style,$e=Ti.getOffset(U);Re.position="absolute",Re.left=$e.x+"px",Re.top=$e.y+"px",g.body.appendChild(Ce)}}else de=new nt(U),U=null;this._project=M,this._scope=M._scope,this._element=U,this._pixelRatio||(this._pixelRatio=c&&c.devicePixelRatio||1),this._setElementSize(de.width,de.height),this._viewSize=de,b._views.push(this),b._viewsById[this._id]=this,(this._matrix=new xt)._owner=this,b._focused||(b._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!_n.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Oi._focused===this&&(Oi._focused=null),Oi._views.splice(Oi._views.indexOf(this),1),delete Oi._viewsById[this._id];var b=this._project;return b._view===this&&(b._view=null),gi.remove(this._element,this._viewEvents),gi.remove(c,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:v.each(Ue._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(b){this[b]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(b){this._autoUpdate=b,b&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var b=this;gi.requestAnimationFrame(function(){if(b._requested=!1,b._animate){b.requestUpdate();var M=b._element;(!Ti.getPrefixed(g,"hidden")||a.getAttribute(M,"keepalive")==="true")&&Ti.isInView(M)&&b._handleFrame()}b._autoUpdate&&b.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){_n=this._scope;var b=Date.now()/1e3,M=this._last?b-this._last:0;this._last=b,this.emit("frame",new v({delta:M,time:this._time+=M,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(b,M){var U=this._frameItems;M?(U[b._id]={item:b,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete U[b._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(b){for(var M in this._frameItems){var U=this._frameItems[M];U.item.emit("frame",new v(b,{time:U.time+=b.delta,count:U.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var b=this._viewSize;return new Ke(b.width,b.height,this,"setViewSize")},setViewSize:function(){var b=nt.read(arguments),M=b.subtract(this._viewSize);M.isZero()||(this._setElementSize(b.width,b.height),this._viewSize.set(b),this._changed(),this.emit("resize",{size:b,delta:M}),this._autoUpdate&&this.update())},_setElementSize:function(b,M){var U=this._element;U&&(U.width!==b&&(U.width=b),U.height!==M&&(U.height=M))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new st(new _e,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Ti.isInView(this._element)},isInserted:function(){return Ti.isInserted(this._element)},getPixelSize:function(b){var M=this._element,U;if(M){var K=M.parentNode,ie=g.createElement("div");ie.style.fontSize=b,K.appendChild(ie),U=parseFloat(Ti.getStyles(ie).fontSize),K.removeChild(ie)}else U=parseFloat(U);return U},getTextWidth:function(b,M){return 0}},v.each(["rotate","scale","shear","skew"],function(b){var M=b==="rotate";this[b]=function(){var U=arguments,K=(M?v:_e).read(U),ie=_e.read(U,0,{readNull:!0});return this.transform(new xt()[b](K,ie||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var b=new xt;return this.transform(b.translate.apply(b,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var b=_e.read(arguments);this.translate(this.getCenter().subtract(b))},getZoom:function(){var b=this._decompose().scaling;return(b.x+b.y)/2},setZoom:function(b){this.transform(new xt().scale(b/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(b){var M=this.getRotation();M!=null&&b!=null&&this.rotate(b-M)},getScaling:function(){var b=this._decompose().scaling;return new Ze(b.x,b.y,this,"setScaling")},setScaling:function(){var b=this.getScaling(),M=_e.read(arguments,0,{clone:!0,readNull:!0});b&&M&&this.scale(M.x/b.x,M.y/b.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var b=this._matrix;b.set.apply(b,arguments)},transform:function(b){this._matrix.append(b)},scrollBy:function(){this.translate(_e.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(_e.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(_e.read(arguments))},getEventPoint:function(b){return this.viewToProject(gi.getOffset(b,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(b,M){g&&typeof M=="string"&&(M=g.getElementById(M));var U=c?Vi:Oi;return new U(b,M)}}},new function(){if(!c)return;var b,M,U=!1,K=!1;function ie(et){var Le=gi.getTarget(et);return Le.getAttribute&&Oi._viewsById[Le.getAttribute("id")]}function de(){var et=Oi._focused;if(!et||!et.isVisible()){for(var Le=0,qe=Oi._views.length;Le<qe;Le++)if((et=Oi._views[Le]).isVisible()){Oi._focused=M=et;break}}}function be(et,Le,qe){et._handleMouseEvent("mousemove",Le,qe)}var Ee=c.navigator,Ce,Re,$e;Ee.pointerEnabled||Ee.msPointerEnabled?(Ce="pointerdown MSPointerDown",Re="pointermove MSPointerMove",$e="pointerup pointercancel MSPointerUp MSPointerCancel"):(Ce="touchstart",Re="touchmove",$e="touchend touchcancel","ontouchstart"in c&&Ee.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(Ce+=" mousedown",Re+=" mousemove",$e+=" mouseup"));var je={},We={mouseout:function(et){var Le=Oi._focused,qe=gi.getRelatedTarget(et);if(Le&&(!qe||qe.nodeName==="HTML")){var dt=gi.getOffset(et,Le._element),Pt=dt.x,o=Math.abs,Me=o(Pt),li=1<<25,di=Me-li;dt.x=o(di)<Me?di*(Pt<0?-1:1):Pt,be(Le,et,Le.viewToProject(dt))}},scroll:de};je[Ce]=function(et){var Le=Oi._focused=ie(et);U||(U=!0,Le._handleMouseEvent("mousedown",et))},We[Re]=function(et){var Le=Oi._focused;if(!K){var qe=ie(et);qe?Le!==qe&&(Le&&be(Le,et),b||(b=Le),Le=Oi._focused=M=qe):M&&M===Le&&(b&&!b.isInserted()&&(b=null),Le=Oi._focused=b,b=null,de())}Le&&be(Le,et)},We[Ce]=function(){K=!0},We[$e]=function(et){var Le=Oi._focused;Le&&U&&Le._handleMouseEvent("mouseup",et),K=U=!1},gi.add(g,We),gi.add(c,{load:de});var Ge=!1,mt=!1,ot={doubleclick:"click",mousedrag:"mousemove"},Pe=!1,ae,re,X,ne,pe,xe,ye,De;function Oe(et,Le,qe,dt,Pt,o,Me){var li=!1,di;function fi(ti,ui){if(ti.responds(ui)){if(di||(di=new Bn(ui,dt,Pt,Le||ti,o?Pt.subtract(o):null)),ti.emit(ui,di)&&(Ge=!0,di.prevented&&(mt=!0),di.stopped))return li=!0}else{var Ri=ot[ui];if(Ri)return fi(ti,Ri)}}for(;et&&et!==Me&&!fi(et,qe);)et=et._parent;return li}function Ve(et,Le,qe,dt,Pt,o){return et._project.removeOn(qe),mt=Ge=!1,pe&&Oe(pe,null,qe,dt,Pt,o)||Le&&Le!==pe&&!Le.isDescendant(pe)&&Oe(Le,null,qe==="mousedrag"?"mousemove":qe,dt,Pt,o,pe)||Oe(et,pe||Le||et,qe,dt,Pt,o)}var Je={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:je,_handleMouseEvent:function(et,Le,qe){var dt=this._itemEvents,Pt=dt.native[et],o=et==="mousemove",Me=this._scope.tool,li=this;function di(Jt){return dt.virtual[Jt]||li.responds(Jt)||Me&&Me.responds(Jt)}o&&U&&di("mousedrag")&&(et="mousedrag"),qe||(qe=this.getEventPoint(Le));var fi=this.getBounds().contains(qe),ti=Pt&&fi&&li._project.hitTest(qe,{tolerance:0,fill:!0,stroke:!0}),ui=ti&&ti.item||null,Ri=!1,bi={};if(bi[et.substr(5)]=!0,Pt&&ui!==ne&&(ne&&Oe(ne,null,"mouseleave",Le,qe),ui&&Oe(ui,null,"mouseenter",Le,qe),ne=ui),Pe^fi&&(Oe(this,null,fi?"mouseenter":"mouseleave",Le,qe),Ri=!0),(fi||bi.drag)&&!qe.equals(re)&&(Ve(this,ui,o?et:"mousemove",Le,qe,re),Ri=!0),Pe=fi,bi.down&&fi||bi.up&&ae){if(Ve(this,ui,et,Le,qe,ae),bi.down){if(De=ui===xe&&Date.now()-ye<300,X=xe=ui,!mt&&ui){for(var Si=ui;Si&&!Si.responds("mousedrag");)Si=Si._parent;Si&&(pe=ui)}ae=qe}else bi.up&&(!mt&&ui===X&&(ye=Date.now(),Ve(this,ui,De?"doubleclick":"click",Le,qe,ae),De=!1),X=pe=null);Pe=!1,Ri=!0}re=qe,Ri&&Me&&(Ge=Me._handleMouseEvent(et,Le,qe,bi)||Ge),Le.cancelable!==!1&&(Ge&&!bi.move||bi.down&&di("mouseup"))&&Le.preventDefault()},_handleKeyEvent:function(et,Le,qe,dt){var Pt=this._scope,o=Pt.tool,Me;function li(di){di.responds(et)&&(_n=Pt,di.emit(et,Me=Me||new wn(et,Le,qe,dt)))}this.isVisible()&&(li(this),o&&o.responds(et)&&li(o))},_countItemEvent:function(et,Le){var qe=this._itemEvents,dt=qe.native,Pt=qe.virtual;for(var o in Je)dt[o]=(dt[o]||0)+(Je[o][et]||0)*Le;Pt[et]=(Pt[et]||0)+Le},statics:{updateFocus:de,_resetState:function(){U=K=Ge=Pe=!1,b=M=ae=re=X=ne=pe=xe=ye=De=null}}}}),Vi=Oi.extend({_class:"CanvasView",initialize:function(M,U){if(!(U instanceof c.HTMLCanvasElement)){var K=nt.read(arguments,1);if(K.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+v.slice(arguments,1));U=Yi.getCanvas(K)}var ie=this._context=U.getContext("2d");if(ie.save(),this._pixelRatio=1,!/^off|false$/.test(a.getAttribute(U,"hidpi"))){var de=c.devicePixelRatio||1,be=Ti.getPrefixed(ie,"backingStorePixelRatio")||1;this._pixelRatio=de/be}Oi.call(this,M,U),this._needsUpdate=!0},remove:function b(){return this._context.restore(),b.base.call(this)},_setElementSize:function b(M,U){var K=this._pixelRatio;if(b.base.call(this,M*K,U*K),K!==1){var ie=this._element,de=this._context;if(!a.hasAttribute(ie,"resize")){var be=ie.style;be.width=M+"px",be.height=U+"px"}de.restore(),de.save(),de.scale(K,K)}},getContext:function(){return this._context},getPixelSize:function b(M){var U=_n.agent,K;if(U&&U.firefox)K=b.base.call(this,M);else{var ie=this._context,de=ie.font;ie.font=M+" serif",K=parseFloat(ie.font),ie.font=de}return K},getTextWidth:function(b,M){var U=this._context,K=U.font,ie=0;U.font=b;for(var de=0,be=M.length;de<be;de++)ie=Math.max(ie,U.measureText(M[de]).width);return U.font=K,ie},update:function(){if(!this._needsUpdate)return!1;var b=this._project,M=this._context,U=this._viewSize;return M.clearRect(0,0,U.width+1,U.height+1),b&&b.draw(M,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),bn=v.extend({_class:"Event",initialize:function(M){this.event=M,this.type=M&&M.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return xi.modifiers}}),wn=bn.extend({_class:"KeyEvent",initialize:function(M,U,K,ie){this.type=M,this.event=U,this.key=K,this.character=ie},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),xi=new function(){var b={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},M={tab:"	",space:" ",enter:"\r"},U={},K={},ie,de,be=new v({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var Re=_n&&_n.agent;return Re&&Re.mac?this.meta:this.control}}});function Ee(Re){var $e=Re.key||Re.keyIdentifier;return $e=/^U\+/.test($e)?String.fromCharCode(parseInt($e.substr(2),16)):/^Arrow[A-Z]/.test($e)?$e.substr(5):$e==="Unidentified"||$e===n?String.fromCharCode(Re.keyCode):$e,b[$e]||($e.length>1?v.hyphenate($e):$e.toLowerCase())}function Ce(Re,$e,je,We){var Ge=Oi._focused,mt;if(U[$e]=Re,Re?K[$e]=je:delete K[$e],$e.length>1&&(mt=v.camelize($e))in be){be[mt]=Re;var ot=_n&&_n.agent;if(mt==="meta"&&ot&&ot.mac)if(Re)ie={};else{for(var Pe in ie)Pe in K&&Ce(!1,Pe,ie[Pe],We);ie=null}}else Re&&ie&&(ie[$e]=je);Ge&&Ge._handleKeyEvent(Re?"keydown":"keyup",We,$e,je)}return gi.add(g,{keydown:function(Re){var $e=Ee(Re),je=_n&&_n.agent;$e.length>1||je&&je.chrome&&(Re.altKey||je.mac&&Re.metaKey||!je.mac&&Re.ctrlKey)?Ce(!0,$e,M[$e]||($e.length>1?"":$e),Re):de=$e},keypress:function(Re){if(de){var $e=Ee(Re),je=Re.charCode,We=je>=32?String.fromCharCode(je):$e.length>1?"":$e;$e!==de&&($e=We.toLowerCase()),Ce(!0,$e,We,Re),de=null}},keyup:function(Re){var $e=Ee(Re);$e in K&&Ce(!1,$e,K[$e],Re)}}),gi.add(c,{blur:function(Re){for(var $e in K)Ce(!1,$e,K[$e],Re)}}),{modifiers:be,isDown:function(Re){return!!U[Re]}}},Bn=bn.extend({_class:"MouseEvent",initialize:function(M,U,K,ie,de){this.type=M,this.event=U,this.point=K,this.target=ie,this.delta=de},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Ot=bn.extend({_class:"ToolEvent",_item:null,initialize:function(M,U,K){this.tool=M,this.type=U,this.event=K},_choosePoint:function(b,M){return b||(M?M.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(b){this._point=b},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(b){this._lastPoint=b},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(b){this._downPoint=b},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(b){this._middlePoint=b},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(b){this._delta=b},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(b){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=b},getItem:function(){if(!this._item){var b=this.tool._scope.project.hitTest(this.getPoint());if(b){for(var M=b.item,U=M._parent;/^(Group|CompoundPath)$/.test(U._class);)M=U,U=U._parent;this._item=M}}return this._item},setItem:function(b){this._item=b},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),an=N.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(M){N.call(this),this._moveCount=-1,this._downCount=-1,this.set(M)},getMinDistance:function(){return this._minDistance},setMinDistance:function(b){this._minDistance=b,b!=null&&this._maxDistance!=null&&b>this._maxDistance&&(this._maxDistance=b)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(b){this._maxDistance=b,this._minDistance!=null&&b!=null&&b<this._minDistance&&(this._minDistance=b)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(b){this._minDistance=this._maxDistance=b},_handleMouseEvent:function(b,M,U,K){_n=this._scope,K.drag&&!this.responds(b)&&(b="mousemove");var ie=K.move||K.drag,de=this.responds(b),be=this.minDistance,Ee=this.maxDistance,Ce=!1,Re=this;function $e(We,Ge){var mt=U,ot=ie?Re._point:Re._downPoint||mt;if(ie){if(Re._moveCount>=0&&mt.equals(ot))return!1;if(ot&&(We!=null||Ge!=null)){var Pe=mt.subtract(ot),ae=Pe.getLength();if(ae<(We||0))return!1;Ge&&(mt=ot.add(Pe.normalize(Math.min(ae,Ge))))}Re._moveCount++}return Re._point=mt,Re._lastPoint=ot||mt,K.down&&(Re._moveCount=-1,Re._downPoint=mt,Re._downCount++),!0}function je(){de&&(Ce=Re.emit(b,new Ot(Re,b,M))||Ce)}if(K.down)$e(),je();else if(K.up)$e(null,Ee),je();else if(de)for(;$e(be,Ee);)je();return Ce}}),$n=v.extend(S,{_class:"Tween",statics:{easings:new v({linear:function(b){return b},easeInQuad:function(b){return b*b},easeOutQuad:function(b){return b*(2-b)},easeInOutQuad:function(b){return b<.5?2*b*b:-1+2*(2-b)*b},easeInCubic:function(b){return b*b*b},easeOutCubic:function(b){return--b*b*b+1},easeInOutCubic:function(b){return b<.5?4*b*b*b:(b-1)*(2*b-2)*(2*b-2)+1},easeInQuart:function(b){return b*b*b*b},easeOutQuart:function(b){return 1- --b*b*b*b},easeInOutQuart:function(b){return b<.5?8*b*b*b*b:1-8*--b*b*b*b},easeInQuint:function(b){return b*b*b*b*b},easeOutQuint:function(b){return 1+--b*b*b*b*b},easeInOutQuint:function(b){return b<.5?16*b*b*b*b*b:1+16*--b*b*b*b*b}})},initialize:function b(M,U,K,ie,de,be){this.object=M;var Ee=typeof de,Ce=Ee==="function";this.type=Ce?Ee:Ee==="string"?de:"linear",this.easing=Ce?de:b.easings[this.type],this.duration=ie,this.running=!1,this._then=null,this._startTime=null;var Re=U||K;this._keys=Re?Object.keys(Re):[],this._parsedKeys=this._parseKeys(this._keys),this._from=Re&&this._getState(U),this._to=Re&&this._getState(K),be!==!1&&this.start()},then:function(b){return this._then=b,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(b){if(this.running){b>=1&&(b=1,this.running=!1);for(var M=this.easing(b),U=this._keys,K=function($e){return typeof $e=="function"?$e(M,b):$e},ie=0,de=U&&U.length;ie<de;ie++){var be=U[ie],Ee=K(this._from[be]),Ce=K(this._to[be]),Re=Ee&&Ce&&Ee.__add&&Ce.__add?Ce.__subtract(Ee).__multiply(M).__add(Ee):(Ce-Ee)*M+Ee;this._setProperty(this._parsedKeys[be],Re)}this.responds("update")&&this.emit("update",new v({progress:b,factor:M})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(b){var M=this._startTime,U=M?(b-M)/this.duration:0;M||(this._startTime=b),this.update(U)},_getState:function(b){for(var M=this._keys,U={},K=0,ie=M.length;K<ie;K++){var de=M[K],be=this._parsedKeys[de],Ee=this._getProperty(be),Ce;if(b){var Re=this._resolveValue(Ee,b[de]);this._setProperty(be,Re),Ce=this._getProperty(be),Ce=Ce&&Ce.clone?Ce.clone():Ce,this._setProperty(be,Ee)}else Ce=Ee&&Ee.clone?Ee.clone():Ee;U[de]=Ce}return U},_resolveValue:function(b,M){if(M){if(Array.isArray(M)&&M.length===2){var U=M[0];return U&&U.match&&U.match(/^[+\-\*\/]=/)?this._calculate(b,U[0],M[1]):M}else if(typeof M=="string"){var K=M.match(/^[+\-*/]=(.*)/);if(K){var ie=JSON.parse(K[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(b,M[0],ie)}}}return M},_calculate:function(b,M,U){return _n.PaperScript.calculateBinary(b,M,U)},_parseKeys:function(b){for(var M={},U=0,K=b.length;U<K;U++){var ie=b[U],de=ie.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");M[ie]=de.split("/")}return M},_getProperty:function(b,M){for(var U=this.object,K=0,ie=b.length-(M||0);K<ie&&U;K++)U=U[b[K]];return U},_setProperty:function(b,M){var U=this._getProperty(b,1);U&&(U[b[b.length-1]]=M)}}),oi={request:function(b){var M=new e.XMLHttpRequest;return M.open((b.method||"get").toUpperCase(),b.url,v.pick(b.async,!0)),b.mimeType&&M.overrideMimeType(b.mimeType),M.onload=function(){var U=M.status;U===0||U===200?b.onLoad&&b.onLoad.call(M,M.responseText):M.onerror()},M.onerror=function(){var U=M.status,K='Could not load "'+b.url+'" (Status: '+U+")";if(b.onError)b.onError(K,U);else throw new Error(K)},M.send(null)}},Yi=v.exports.CanvasProvider={canvases:[],getCanvas:function(b,M,U){if(!c)return null;var K,ie=!0;typeof b=="object"&&(M=b.height,b=b.width),this.canvases.length?K=this.canvases.pop():(K=g.createElement("canvas"),ie=!1);var de=K.getContext("2d",U||{});if(!de)throw new Error("Canvas "+K+" is unable to provide a 2D context.");return K.width===b&&K.height===M?ie&&de.clearRect(0,0,b+1,M+1):(K.width=b,K.height=M),de.save(),K},getContext:function(b,M,U){var K=this.getCanvas(b,M,U);return K?K.getContext("2d",U||{}):null},release:function(b){var M=b&&b.canvas?b.canvas:b;M&&M.getContext&&(M.getContext("2d").restore(),this.canvases.push(M))}},Xn=new function(){var b=Math.min,M=Math.max,U=Math.abs,K,ie,de,be,Ee,Ce,Re,$e,je,We,Ge;function mt(pe,xe,ye){return .2989*pe+.587*xe+.114*ye}function ot(pe,xe,ye,Ve){var Oe=Ve-mt(pe,xe,ye);je=pe+Oe,We=xe+Oe,Ge=ye+Oe;var Ve=mt(je,We,Ge),Je=b(je,We,Ge),et=M(je,We,Ge);if(Je<0){var Le=Ve-Je;je=Ve+(je-Ve)*Ve/Le,We=Ve+(We-Ve)*Ve/Le,Ge=Ve+(Ge-Ve)*Ve/Le}if(et>255){var qe=255-Ve,dt=et-Ve;je=Ve+(je-Ve)*qe/dt,We=Ve+(We-Ve)*qe/dt,Ge=Ve+(Ge-Ve)*qe/dt}}function Pe(pe,xe,ye){return M(pe,xe,ye)-b(pe,xe,ye)}function ae(pe,xe,ye,De){var Oe=[pe,xe,ye],Ve=M(pe,xe,ye),Je=b(pe,xe,ye),et;Je=Je===pe?0:Je===xe?1:2,Ve=Ve===pe?0:Ve===xe?1:2,et=b(Je,Ve)===0?M(Je,Ve)===1?2:1:0,Oe[Ve]>Oe[Je]?(Oe[et]=(Oe[et]-Oe[Je])*De/(Oe[Ve]-Oe[Je]),Oe[Ve]=De):Oe[et]=Oe[Ve]=0,Oe[Je]=0,je=Oe[0],We=Oe[1],Ge=Oe[2]}var re={multiply:function(){je=Ee*K/255,We=Ce*ie/255,Ge=Re*de/255},screen:function(){je=Ee+K-Ee*K/255,We=Ce+ie-Ce*ie/255,Ge=Re+de-Re*de/255},overlay:function(){je=Ee<128?2*Ee*K/255:255-2*(255-Ee)*(255-K)/255,We=Ce<128?2*Ce*ie/255:255-2*(255-Ce)*(255-ie)/255,Ge=Re<128?2*Re*de/255:255-2*(255-Re)*(255-de)/255},"soft-light":function(){var pe=K*Ee/255;je=pe+Ee*(255-(255-Ee)*(255-K)/255-pe)/255,pe=ie*Ce/255,We=pe+Ce*(255-(255-Ce)*(255-ie)/255-pe)/255,pe=de*Re/255,Ge=pe+Re*(255-(255-Re)*(255-de)/255-pe)/255},"hard-light":function(){je=K<128?2*K*Ee/255:255-2*(255-K)*(255-Ee)/255,We=ie<128?2*ie*Ce/255:255-2*(255-ie)*(255-Ce)/255,Ge=de<128?2*de*Re/255:255-2*(255-de)*(255-Re)/255},"color-dodge":function(){je=Ee===0?0:K===255?255:b(255,255*Ee/(255-K)),We=Ce===0?0:ie===255?255:b(255,255*Ce/(255-ie)),Ge=Re===0?0:de===255?255:b(255,255*Re/(255-de))},"color-burn":function(){je=Ee===255?255:K===0?0:M(0,255-(255-Ee)*255/K),We=Ce===255?255:ie===0?0:M(0,255-(255-Ce)*255/ie),Ge=Re===255?255:de===0?0:M(0,255-(255-Re)*255/de)},darken:function(){je=Ee<K?Ee:K,We=Ce<ie?Ce:ie,Ge=Re<de?Re:de},lighten:function(){je=Ee>K?Ee:K,We=Ce>ie?Ce:ie,Ge=Re>de?Re:de},difference:function(){je=Ee-K,je<0&&(je=-je),We=Ce-ie,We<0&&(We=-We),Ge=Re-de,Ge<0&&(Ge=-Ge)},exclusion:function(){je=Ee+K*(255-Ee-Ee)/255,We=Ce+ie*(255-Ce-Ce)/255,Ge=Re+de*(255-Re-Re)/255},hue:function(){ae(K,ie,de,Pe(Ee,Ce,Re)),ot(je,We,Ge,mt(Ee,Ce,Re))},saturation:function(){ae(Ee,Ce,Re,Pe(K,ie,de)),ot(je,We,Ge,mt(Ee,Ce,Re))},luminosity:function(){ot(Ee,Ce,Re,mt(K,ie,de))},color:function(){ot(K,ie,de,mt(Ee,Ce,Re))},add:function(){je=b(Ee+K,255),We=b(Ce+ie,255),Ge=b(Re+de,255)},subtract:function(){je=M(Ee-K,0),We=M(Ce-ie,0),Ge=M(Re-de,0)},average:function(){je=(Ee+K)/2,We=(Ce+ie)/2,Ge=(Re+de)/2},negation:function(){je=255-U(255-K-Ee),We=255-U(255-ie-Ce),Ge=255-U(255-de-Re)}},X=this.nativeModes=v.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(pe){this[pe]=!0},{}),ne=Yi.getContext(1,1,{willReadFrequently:!0});ne&&(v.each(re,function(pe,xe){var ye=xe==="darken",De=!1;ne.save();try{ne.fillStyle=ye?"#300":"#a00",ne.fillRect(0,0,1,1),ne.globalCompositeOperation=xe,ne.globalCompositeOperation===xe&&(ne.fillStyle=ye?"#a00":"#300",ne.fillRect(0,0,1,1),De=ne.getImageData(0,0,1,1).data[0]!==ye?170:51)}catch{}ne.restore(),X[xe]=De}),Yi.release(ne)),this.process=function(pe,xe,ye,De,Oe){var Ve=xe.canvas,Je=pe==="normal";if(Je||X[pe])ye.save(),ye.setTransform(1,0,0,1,0,0),ye.globalAlpha=De,Je||(ye.globalCompositeOperation=pe),ye.drawImage(Ve,Oe.x,Oe.y),ye.restore();else{var et=re[pe];if(!et)return;for(var Le=ye.getImageData(Oe.x,Oe.y,Ve.width,Ve.height),qe=Le.data,dt=xe.getImageData(0,0,Ve.width,Ve.height).data,Pt=0,o=qe.length;Pt<o;Pt+=4){K=dt[Pt],Ee=qe[Pt],ie=dt[Pt+1],Ce=qe[Pt+1],de=dt[Pt+2],Re=qe[Pt+2],be=dt[Pt+3],$e=qe[Pt+3],et();var Me=be*De/255,li=1-Me;qe[Pt]=Me*je+li*Ee,qe[Pt+1]=Me*We+li*Ce,qe[Pt+2]=Me*Ge+li*Re,qe[Pt+3]=be*De+li*$e}ye.putImageData(Le,Oe.x,Oe.y)}}},zn=new function(){var b="http://www.w3.org/2000/svg",M="http://www.w3.org/2000/xmlns",U="http://www.w3.org/1999/xlink",K={href:U,xlink:M,xmlns:M+"/","xmlns:xlink":M+"/"};function ie(Ee,Ce,Re){return be(g.createElementNS(b,Ee),Ce,Re)}function de(Ee,Ce){var Re=K[Ce],$e=Re?Ee.getAttributeNS(Re,Ce):Ee.getAttribute(Ce);return $e==="null"?null:$e}function be(Ee,Ce,Re){for(var $e in Ce){var je=Ce[$e],We=K[$e];typeof je=="number"&&Re&&(je=Re.number(je)),We?Ee.setAttributeNS(We,$e,je):Ee.setAttribute($e,je)}return Ee}return{svg:b,xmlns:M,xlink:U,create:ie,get:de,set:be}},Wn=v.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(b,M){return!M&&(b instanceof Ft||b instanceof gt||b instanceof Ni)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(b,M){var U=v.capitalize(M),K=b[2];this[M]={type:b[1],property:M,attribute:b[0],toSVG:K,fromSVG:K&&v.each(K,function(ie,de){this[ie]=de},{}),exportFilter:b[3],get:"get"+U,set:"set"+U}},{});new function(){var b;function M(re,X,ne){var pe=new v,xe=re.getTranslation();if(X){var ye;re.isInvertible()?(re=re._shiftless(),ye=re._inverseTransform(xe),xe=null):ye=new _e,pe[ne?"cx":"x"]=ye.x,pe[ne?"cy":"y"]=ye.y}if(!re.isIdentity()){var De=re.decompose();if(De){var Oe=[],Ve=De.rotation,Je=De.scaling,et=De.skewing;xe&&!xe.isZero()&&Oe.push("translate("+b.point(xe)+")"),Ve&&Oe.push("rotate("+b.number(Ve)+")"),(!oe.isZero(Je.x-1)||!oe.isZero(Je.y-1))&&Oe.push("scale("+b.point(Je)+")"),et.x&&Oe.push("skewX("+b.number(et.x)+")"),et.y&&Oe.push("skewY("+b.number(et.y)+")"),pe.transform=Oe.join(" ")}else pe.transform="matrix("+re.getValues().join(",")+")"}return pe}function U(re,X){for(var ne=M(re._matrix),pe=re._children,xe=zn.create("g",ne,b),ye=0,De=pe.length;ye<De;ye++){var Oe=pe[ye],Ve=Pe(Oe,X);if(Ve)if(Oe.isClipMask()){var Je=zn.create("clipPath");Je.appendChild(Ve),mt(Oe,Je,"clip"),zn.set(xe,{"clip-path":"url(#"+Je.id+")"})}else xe.appendChild(Ve)}return xe}function K(re,X){var ne=M(re._matrix,!0),pe=re.getSize(),xe=re.getImage();return ne.x-=pe.width/2,ne.y-=pe.height/2,ne.width=pe.width,ne.height=pe.height,ne.href=X.embedImages==!1&&xe&&xe.src||re.toDataURL(),zn.create("image",ne,b)}function ie(re,X){var ne=X.matchShapes;if(ne){var pe=re.toShape(!1);if(pe)return de(pe)}var xe=re._segments,ye=xe.length,De,Oe=M(re._matrix);if(ne&&ye>=2&&!re.hasHandles())if(ye>2){De=re._closed?"polygon":"polyline";for(var Ve=[],Je=0;Je<ye;Je++)Ve.push(b.point(xe[Je]._point));Oe.points=Ve.join(" ")}else{De="line";var et=xe[0]._point,Le=xe[1]._point;Oe.set({x1:et.x,y1:et.y,x2:Le.x,y2:Le.y})}else De="path",Oe.d=re.getPathData(null,X.precision);return zn.create(De,Oe,b)}function de(re){var X=re._type,ne=re._radius,pe=M(re._matrix,!0,X!=="rectangle");if(X==="rectangle"){X="rect";var xe=re._size,ye=xe.width,De=xe.height;pe.x-=ye/2,pe.y-=De/2,pe.width=ye,pe.height=De,ne.isZero()&&(ne=null)}return ne&&(X==="circle"?pe.r=ne:(pe.rx=ne.width,pe.ry=ne.height)),zn.create(X,pe,b)}function be(re,X){var ne=M(re._matrix),pe=re.getPathData(null,X.precision);return pe&&(ne.d=pe),zn.create("path",ne,b)}function Ee(re,X){var ne=M(re._matrix,!0),pe=re._definition,xe=Ge(pe,"symbol"),ye=pe._item,De=ye.getStrokeBounds();return xe||(xe=zn.create("symbol",{viewBox:b.rectangle(De)}),xe.appendChild(Pe(ye,X)),mt(pe,xe,"symbol")),ne.href="#"+xe.id,ne.x+=De.x,ne.y+=De.y,ne.width=De.width,ne.height=De.height,ne.overflow="visible",zn.create("use",ne,b)}function Ce(re){var X=Ge(re,"color");if(!X){var ne=re.getGradient(),pe=ne._radial,xe=re.getOrigin(),ye=re.getDestination(),De;if(pe){De={cx:xe.x,cy:xe.y,r:xe.getDistance(ye)};var Oe=re.getHighlight();Oe&&(De.fx=Oe.x,De.fy=Oe.y)}else De={x1:xe.x,y1:xe.y,x2:ye.x,y2:ye.y};De.gradientUnits="userSpaceOnUse",X=zn.create((pe?"radial":"linear")+"Gradient",De,b);for(var Ve=ne._stops,Je=0,et=Ve.length;Je<et;Je++){var Le=Ve[Je],qe=Le._color,dt=qe.getAlpha(),Pt=Le._offset;De={offset:Pt??Je/(et-1)},qe&&(De["stop-color"]=qe.toCSS(!0)),dt<1&&(De["stop-opacity"]=dt),X.appendChild(zn.create("stop",De,b))}mt(re,X,"color")}return"url(#"+X.id+")"}function Re(re){var X=zn.create("text",M(re._matrix,!0),b);return X.textContent=re._content,X}var $e={Group:U,Layer:U,Raster:K,Path:ie,Shape:de,CompoundPath:be,SymbolItem:Ee,PointText:Re};function je(re,X,ne){var pe={},xe=!ne&&re.getParent(),ye=[];return re._name!=null&&(pe.id=re._name),v.each(Wn,function(De){var Oe=De.get,Ve=De.type,Je=re[Oe]();if(De.exportFilter?De.exportFilter(re,Je):!xe||!v.equals(xe[Oe](),Je)){if(Ve==="color"&&Je!=null){var et=Je.getAlpha();et<1&&(pe[De.attribute+"-opacity"]=et)}Ve==="style"?ye.push(De.attribute+": "+Je):pe[De.attribute]=Je==null?"none":Ve==="color"?Je.gradient?Ce(Je):Je.toCSS(!0):Ve==="array"?Je.join(","):Ve==="lookup"?De.toSVG[Je]:Je}}),ye.length&&(pe.style=ye.join(";")),pe.opacity===1&&delete pe.opacity,re._visible||(pe.visibility="hidden"),zn.set(X,pe,b)}var We;function Ge(re,X){return We||(We={ids:{},svgs:{}}),re&&We.svgs[X+"-"+(re._id||re.__id||(re.__id=ce.get("svg")))]}function mt(re,X,ne){We||Ge();var pe=We.ids[ne]=(We.ids[ne]||0)+1;X.id=ne+"-"+pe,We.svgs[ne+"-"+(re._id||re.__id)]=X}function ot(re,X){var ne=re,pe=null;if(We){ne=re.nodeName.toLowerCase()==="svg"&&re;for(var xe in We.svgs)pe||(ne||(ne=zn.create("svg"),ne.appendChild(re)),pe=ne.insertBefore(zn.create("defs"),ne.firstChild)),pe.appendChild(We.svgs[xe]);We=null}return X.asString?new e.XMLSerializer().serializeToString(ne):ne}function Pe(re,X,ne){var pe=$e[re._class],xe=pe&&pe(re,X);if(xe){var ye=X.onExport;ye&&(xe=ye(re,xe,X)||xe);var De=JSON.stringify(re._data);De&&De!=="{}"&&De!=="null"&&xe.setAttribute("data-paper-data",De)}return xe&&je(re,xe,ne)}function ae(re){return re||(re={}),b=new he(re.precision),re}Ue.inject({exportSVG:function(re){return re=ae(re),ot(Pe(this,re,!0),re)}}),Mt.inject({exportSVG:function(re){re=ae(re);var X=this._children,ne=this.getView(),pe=v.pick(re.bounds,"view"),xe=re.matrix||pe==="view"&&ne._matrix,ye=xe&&xt.read([xe]),De=pe==="view"?new st([0,0],ne.getViewSize()):pe==="content"?Ue._getBounds(X,ye,{stroke:!0}).rect:st.read([pe],0,{readNull:!0}),Oe={version:"1.1",xmlns:zn.svg,"xmlns:xlink":zn.xlink};De&&(Oe.width=De.width,Oe.height=De.height,(De.x||De.x===0||De.y||De.y===0)&&(Oe.viewBox=b.rectangle(De)));var Ve=zn.create("svg",Oe,b),Je=Ve;ye&&!ye.isIdentity()&&(Je=Ve.appendChild(zn.create("g",M(ye),b)));for(var et=0,Le=X.length;et<Le;et++)Je.appendChild(Pe(X[et],re,!0));return ot(Ve,re)}})},new function(){var b={},M;function U(X,ne,pe,xe,ye,De){var Oe=zn.get(X,ne)||De,Ve=Oe==null?xe?null:pe?"":0:pe?Oe:parseFloat(Oe);return/%\s*$/.test(Oe)?Ve/100*(ye?1:M[/x|^width/.test(ne)?"width":"height"]):Ve}function K(X,ne,pe,xe,ye,De,Oe){return ne=U(X,ne||"x",!1,xe,ye,De),pe=U(X,pe||"y",!1,xe,ye,Oe),xe&&(ne==null||pe==null)?null:new _e(ne,pe)}function ie(X,ne,pe,xe,ye){return ne=U(X,ne||"width",!1,xe,ye),pe=U(X,pe||"height",!1,xe,ye),xe&&(ne==null||pe==null)?null:new nt(ne,pe)}function de(X,ne,pe){return X==="none"?null:ne==="number"?parseFloat(X):ne==="array"?X?X.split(/[\s,]+/g).map(parseFloat):[]:ne==="color"?Pe(X)||X:ne==="lookup"?pe[X]:X}function be(X,ne,pe,xe){var ye=X.childNodes,De=ne==="clippath",Oe=ne==="defs",Ve=new $t,Je=Ve._project,et=Je._currentStyle,Le=[];if(!De&&!Oe&&(Ve=ot(Ve,X,xe),Je._currentStyle=Ve._style.clone()),xe)for(var qe=X.querySelectorAll("defs"),dt=0,Pt=qe.length;dt<Pt;dt++)ae(qe[dt],pe,!1);for(var dt=0,Pt=ye.length;dt<Pt;dt++){var o=ye[dt],Me;o.nodeType===1&&!/^defs$/i.test(o.nodeName)&&(Me=ae(o,pe,!1))&&!(Me instanceof St)&&Le.push(Me)}return Ve.addChildren(Le),De&&(Ve=ot(Ve.reduce(),X,xe)),Je._currentStyle=et,(De||Oe)&&(Ve.remove(),Ve=null),Ve}function Ee(X,ne){for(var pe=X.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),xe=[],ye=0,De=pe.length;ye<De;ye+=2)xe.push(new _e(parseFloat(pe[ye]),parseFloat(pe[ye+1])));var Oe=new Vt(xe);return ne==="polygon"&&Oe.closePath(),Oe}function Ce(X){return Ft.create(X.getAttribute("d"))}function Re(X,ne){var pe=(U(X,"href",!0)||"").substring(1),xe=ne==="radialgradient",ye;if(pe)ye=b[pe].getGradient(),ye._radial^xe&&(ye=ye.clone(),ye._radial=xe);else{for(var De=X.childNodes,Oe=[],Ve=0,Je=De.length;Ve<Je;Ve++){var et=De[Ve];et.nodeType===1&&Oe.push(ot(new sn,et))}ye=new Gi(Oe,xe)}var Le,qe,dt,Pt=U(X,"gradientUnits",!0)!=="userSpaceOnUse";xe?(Le=K(X,"cx","cy",!1,Pt,"50%","50%"),qe=Le.add(U(X,"r",!1,!1,Pt,"50%"),0),dt=K(X,"fx","fy",!0,Pt)):(Le=K(X,"x1","y1",!1,Pt,"0%","0%"),qe=K(X,"x2","y2",!1,Pt,"100%","0%"));var o=ot(new Zi(ye,Le,qe,dt),X);return o._scaleToBounds=Pt,null}var $e={"#document":function(X,ne,pe,xe){for(var ye=X.childNodes,De=0,Oe=ye.length;De<Oe;De++){var Ve=ye[De];if(Ve.nodeType===1)return ae(Ve,pe,xe)}},g:be,svg:be,clippath:be,polygon:Ee,polyline:Ee,path:Ce,lineargradient:Re,radialgradient:Re,image:function(X){var ne=new At(U(X,"href",!0));return ne.on("load",function(){var pe=ie(X);this.setSize(pe);var xe=K(X).add(pe.divide(2));this._matrix.append(new xt().translate(xe))}),ne},symbol:function(X,ne,pe,xe){return new St(be(X,ne,pe,xe),!0)},defs:be,use:function(X){var ne=(U(X,"href",!0)||"").substring(1),pe=b[ne],xe=K(X);return pe?pe instanceof St?pe.place(xe):pe.clone().translate(xe):null},circle:function(X){return new gt.Circle(K(X,"cx","cy"),U(X,"r"))},ellipse:function(X){return new gt.Ellipse({center:K(X,"cx","cy"),radius:ie(X,"rx","ry")})},rect:function(X){return new gt.Rectangle(new st(K(X),ie(X)),ie(X,"rx","ry"))},line:function(X){return new Vt.Line(K(X,"x1","y1"),K(X,"x2","y2"))},text:function(X){var ne=new tn(K(X).add(K(X,"dx","dy")));return ne.setContent(X.textContent.trim()||""),ne},switch:be};function je(X,ne,pe,xe){if(X.transform){for(var ye=(xe.getAttribute(pe)||"").split(/\)\s*/g),De=new xt,Oe=0,Ve=ye.length;Oe<Ve;Oe++){var Je=ye[Oe];if(!Je)break;for(var et=Je.split(/\(\s*/),Le=et[0],qe=et[1].split(/[\s,]+/g),dt=0,Pt=qe.length;dt<Pt;dt++)qe[dt]=parseFloat(qe[dt]);switch(Le){case"matrix":De.append(new xt(qe[0],qe[1],qe[2],qe[3],qe[4],qe[5]));break;case"rotate":De.rotate(qe[0],qe[1]||0,qe[2]||0);break;case"translate":De.translate(qe[0],qe[1]||0);break;case"scale":De.scale(qe);break;case"skewX":De.skew(qe[0],0);break;case"skewY":De.skew(0,qe[0]);break}}X.transform(De)}}function We(X,ne,pe){var xe=pe==="fill-opacity"?"getFillColor":"getStrokeColor",ye=X[xe]&&X[xe]();ye&&ye.setAlpha(parseFloat(ne))}var Ge=v.set(v.each(Wn,function(X){this[X.attribute]=function(ne,pe){if(ne[X.set]&&(ne[X.set](de(pe,X.type,X.fromSVG)),X.type==="color")){var xe=ne[X.get]();if(xe&&xe._scaleToBounds){var ye=ne.getBounds();xe.transform(new xt().translate(ye.getPoint()).scale(ye.getSize()))}}}},{}),{id:function(X,ne){b[ne]=X,X.setName&&X.setName(ne)},"clip-path":function(X,ne){var pe=Pe(ne);if(pe)if(pe=pe.clone(),pe.setClipMask(!0),X instanceof $t)X.insertChild(0,pe);else return new $t(pe,X)},gradientTransform:je,transform:je,"fill-opacity":We,"stroke-opacity":We,visibility:function(X,ne){X.setVisible&&X.setVisible(ne==="visible")},display:function(X,ne){X.setVisible&&X.setVisible(ne!==null)},"stop-color":function(X,ne){X.setColor&&X.setColor(ne)},"stop-opacity":function(X,ne){X._color&&X._color.setAlpha(parseFloat(ne))},offset:function(X,ne){if(X.setOffset){var pe=ne.match(/(.*)%$/);X.setOffset(pe?pe[1]/100:parseFloat(ne))}},viewBox:function(X,ne,pe,xe,ye){var De=new st(de(ne,"array")),Oe=ie(xe,null,null,!0),Ve,Je;if(X instanceof $t){var et=Oe?Oe.divide(De.getSize()):1,Je=new xt().scale(et).translate(De.getPoint().negate());Ve=X}else X instanceof St&&(Oe&&De.setSize(Oe),Ve=X._item);if(Ve){if(mt(xe,"overflow",ye)!=="visible"){var Le=new gt.Rectangle(De);Le.setClipMask(!0),Ve.addChild(Le)}Je&&Ve.transform(Je)}}});function mt(X,ne,pe){var xe=X.attributes[ne],ye=xe&&xe.value;if(!ye&&X.style){var De=v.camelize(ne);ye=X.style[De],!ye&&pe.node[De]!==pe.parent[De]&&(ye=pe.node[De])}return ye?ye==="none"?null:ye:n}function ot(X,ne,pe){var xe=ne.parentNode,ye={node:Ti.getStyles(ne)||{},parent:!pe&&!/^defs$/i.test(xe.tagName)&&Ti.getStyles(xe)||{}};return v.each(Ge,function(De,Oe){var Ve=mt(ne,Oe,ye);X=Ve!==n&&De(X,Ve,Oe,ne,ye)||X}),X}function Pe(X){var ne=X&&X.match(/\((?:["'#]*)([^"')]+)/),pe=ne&&ne[1],xe=pe&&b[c?pe.replace(c.location.href.split("#")[0]+"#",""):pe];return xe&&xe._scaleToBounds&&(xe=xe.clone(),xe._scaleToBounds=!0),xe}function ae(X,ne,pe){var xe=X.nodeName.toLowerCase(),ye=xe!=="#document",De=g.body,Oe,Ve,Je;pe&&ye&&(M=_n.getView().getSize(),M=ie(X,null,null,!0)||M,Oe=zn.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),Ve=X.parentNode,Je=X.nextSibling,Oe.appendChild(X),De.appendChild(Oe));var et=_n.settings,Le=et.applyMatrix,qe=et.insertItems;et.applyMatrix=!1,et.insertItems=!1;var dt=$e[xe],Pt=dt&&dt(X,xe,ne,pe)||null;if(et.insertItems=qe,et.applyMatrix=Le,Pt){ye&&!(Pt instanceof $t)&&(Pt=ot(Pt,X,pe));var o=ne.onImport,Me=ye&&X.getAttribute("data-paper-data");o&&(Pt=o(X,Pt,ne)||Pt),ne.expandShapes&&Pt instanceof gt&&(Pt.remove(),Pt=Pt.toPath()),Me&&(Pt._data=JSON.parse(Me))}return Oe&&(De.removeChild(Oe),Ve&&(Je?Ve.insertBefore(X,Je):Ve.appendChild(X))),pe&&(b={},Pt&&v.pick(ne.applyMatrix,Le)&&Pt.matrix.apply(!0,!0)),Pt}function re(X,ne,pe){if(!X)return null;ne=typeof ne=="function"?{onLoad:ne}:ne||{};var xe=_n,ye=null;function De(et){try{var Le=typeof et=="object"?et:new e.DOMParser().parseFromString(et.trim(),"image/svg+xml");if(!Le.nodeName)throw Le=null,new Error("Unsupported SVG source: "+X);_n=xe,ye=ae(Le,ne,!0),(!ne||ne.insert!==!1)&&pe._insertItem(n,ye);var qe=ne.onLoad;qe&&qe(ye,et)}catch(dt){Oe(dt)}}function Oe(et,Le){var qe=ne.onError;if(qe)qe(et,Le);else throw new Error(et)}if(typeof X=="string"&&!/^[\s\S]*</.test(X)){var Ve=g.getElementById(X);Ve?De(Ve):oi.request({url:X,async:!0,onLoad:De,onError:Oe})}else if(typeof File<"u"&&X instanceof File){var Je=new FileReader;return Je.onload=function(){De(Je.result)},Je.onerror=function(){Oe(Je.error)},Je.readAsText(X)}else De(X);return ye}Ue.inject({importSVG:function(X,ne){return re(X,ne,this)}}),Mt.inject({importSVG:function(X,ne){return this.activate(),re(X,ne,this)}})},v.exports.PaperScript=(function(){var b=this,M=b.acorn;if(!M&&typeof MT<"u")try{M=LT()}catch{}if(!M){var U,K;M=U=K={},function(ot,Pe){if(typeof U=="object"&&typeof K=="object")return Pe(U);if(typeof n=="function"&&n.amd)return n(["exports"],Pe);Pe(ot.acorn||(ot.acorn={}))}(this,function(ot){ot.version="0.5.0";var Pe,ae,re,X;ot.parse=function(Nt,ni){return ae=String(Nt),re=ae.length,pe(ni),yu(),Pl(Pe.program)};var ne=ot.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function pe(Nt){Pe=Nt||{};for(var ni in ne)Object.prototype.hasOwnProperty.call(Pe,ni)||(Pe[ni]=ne[ni]);X=Pe.sourceFile||null}var xe=ot.getLineInfo=function(Nt,ni){for(var wi=1,Ui=0;;){Ja.lastIndex=Ui;var On=Ja.exec(Nt);if(On&&On.index<ni)++wi,Ui=On.index+On[0].length;else break}return{line:wi,column:ni-Ui}};ot.tokenize=function(Nt,ni){ae=String(Nt),re=ae.length,pe(ni),yu();var wi={};function Ui(On){return Me=Oe,eo(On),wi.start=De,wi.end=Oe,wi.startLoc=Ve,wi.endLoc=Je,wi.type=et,wi.value=Le,wi}return Ui.jumpTo=function(On,jn){if(ye=On,Pe.locations){dt=1,Pt=Ja.lastIndex=0;for(var cr;(cr=Ja.exec(ae))&&cr.index<On;)++dt,Pt=cr.index+cr[0].length}qe=jn,co()},Ui};var ye,De,Oe,Ve,Je,et,Le,qe,dt,Pt,o,Me,li,di,fi,ti;function ui(Nt,ni){var wi=xe(ae,Nt);ni+=" ("+wi.line+":"+wi.column+")";var Ui=new SyntaxError(ni);throw Ui.pos=Nt,Ui.loc=wi,Ui.raisedAt=ye,Ui}var Ri=[],bi={type:"num"},Si={type:"regexp"},Jt={type:"string"},Sn={type:"name"},ur={type:"eof"},mn={keyword:"break"},Hn={keyword:"case",beforeExpr:!0},Yr={keyword:"catch"},Qi={keyword:"continue"},hr={keyword:"debugger"},Gn={keyword:"default"},Xt={keyword:"do",isLoop:!0},en={keyword:"else",beforeExpr:!0},qt={keyword:"finally"},kn={keyword:"for",isLoop:!0},Ar={keyword:"function"},js={keyword:"if"},Qr={keyword:"return",beforeExpr:!0},Gt={keyword:"switch"},fr={keyword:"throw",beforeExpr:!0},Bt={keyword:"try"},Gr={keyword:"var"},Zs={keyword:"while",isLoop:!0},pa={keyword:"with"},Fr={keyword:"new",beforeExpr:!0},Za={keyword:"this"},Oo={keyword:"null",atomValue:null},Qa={keyword:"true",atomValue:!0},ia={keyword:"false",atomValue:!1},Qn={keyword:"in",binop:7,beforeExpr:!0},Aa={break:mn,case:Hn,catch:Yr,continue:Qi,debugger:hr,default:Gn,do:Xt,else:en,finally:qt,for:kn,function:Ar,if:js,return:Qr,switch:Gt,throw:fr,try:Bt,var:Gr,while:Zs,with:pa,null:Oo,true:Qa,false:ia,new:Fr,in:Qn,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Za,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ds={type:"[",beforeExpr:!0},Wa={type:"]"},ol={type:"{",beforeExpr:!0},ll={type:"}"},lo={type:"(",beforeExpr:!0},$a={type:")"},G={type:",",beforeExpr:!0},we={type:";",beforeExpr:!0},at={type:":",beforeExpr:!0},Ct={type:"."},Yt={type:"?",beforeExpr:!0},Ii={binop:10,beforeExpr:!0},Li={isAssign:!0,beforeExpr:!0},An={isAssign:!0,beforeExpr:!0},pn={postfix:!0,prefix:!0,isUpdate:!0},or={prefix:!0,beforeExpr:!0},dr={binop:1,beforeExpr:!0},qr={binop:2,beforeExpr:!0},Xa={binop:3,beforeExpr:!0},Ya={binop:4,beforeExpr:!0},Ka={binop:5,beforeExpr:!0},ml={binop:6,beforeExpr:!0},Wr={binop:7,beforeExpr:!0},sr={binop:8,beforeExpr:!0},Mr={binop:9,prefix:!0,beforeExpr:!0},Or={binop:10,beforeExpr:!0};ot.tokTypes={bracketL:ds,bracketR:Wa,braceL:ol,braceR:ll,parenL:lo,parenR:$a,comma:G,semi:we,colon:at,dot:Ct,question:Yt,slash:Ii,eq:Li,name:Sn,eof:ur,num:bi,regexp:Si,string:Jt};for(var Ys in Aa)ot.tokTypes["_"+Ys]=Aa[Ys];function Sr(Nt){Nt=Nt.split(" ");var ni="",wi=[];e:for(var Ui=0;Ui<Nt.length;++Ui){for(var On=0;On<wi.length;++On)if(wi[On][0].length==Nt[Ui].length){wi[On].push(Nt[Ui]);continue e}wi.push([Nt[Ui]])}function jn(Jn){if(Jn.length==1)return ni+="return str === "+JSON.stringify(Jn[0])+";";ni+="switch(str){";for(var $s=0;$s<Jn.length;++$s)ni+="case "+JSON.stringify(Jn[$s])+":";ni+="return true}return false;"}if(wi.length>3){wi.sort(function(Jn,$s){return $s.length-Jn.length}),ni+="switch(str.length){";for(var Ui=0;Ui<wi.length;++Ui){var cr=wi[Ui];ni+="case "+cr[0].length+":",jn(cr)}ni+="}"}else jn(Nt);return new Function("str",ni)}var ra=Sr("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Nr=Sr("class enum extends super const export import"),ko=Sr("implements interface let package private protected public static yield"),Qo=Sr("eval arguments"),Ns=Sr("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Tl=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,yo="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Wo="------------------------------------------------------------------------------------------------------------------------------------------",ma=new RegExp("["+yo+"]"),na=new RegExp("["+yo+Wo+"]"),kl=/[\n\r\u2028\u2029]/,Ja=/\r\n|[\n\r\u2028\u2029]/g,Fa=ot.isIdentifierStart=function(Nt){return Nt<65?Nt===36:Nt<91?!0:Nt<97?Nt===95:Nt<123?!0:Nt>=170&&ma.test(String.fromCharCode(Nt))},gl=ot.isIdentifierChar=function(Nt){return Nt<48?Nt===36:Nt<58?!0:Nt<65?!1:Nt<91?!0:Nt<97?Nt===95:Nt<123?!0:Nt>=170&&na.test(String.fromCharCode(Nt))};function Ml(){this.line=dt,this.column=ye-Pt}function yu(){dt=1,ye=Pt=0,qe=!0,co()}function ps(Nt,ni){Oe=ye,Pe.locations&&(Je=new Ml),et=Nt,co(),Le=ni,qe=Nt.beforeExpr}function lc(){var Nt=Pe.onComment&&Pe.locations&&new Ml,ni=ye,wi=ae.indexOf("*/",ye+=2);if(wi===-1&&ui(ye-2,"Unterminated comment"),ye=wi+2,Pe.locations){Ja.lastIndex=ni;for(var Ui;(Ui=Ja.exec(ae))&&Ui.index<ye;)++dt,Pt=Ui.index+Ui[0].length}Pe.onComment&&Pe.onComment(!0,ae.slice(ni+2,wi),ni,ye,Nt,Pe.locations&&new Ml)}function uo(){for(var Nt=ye,ni=Pe.onComment&&Pe.locations&&new Ml,wi=ae.charCodeAt(ye+=2);ye<re&&wi!==10&&wi!==13&&wi!==8232&&wi!==8233;)++ye,wi=ae.charCodeAt(ye);Pe.onComment&&Pe.onComment(!1,ae.slice(Nt+2,ye),Nt,ye,ni,Pe.locations&&new Ml)}function co(){for(;ye<re;){var Nt=ae.charCodeAt(ye);if(Nt===32)++ye;else if(Nt===13){++ye;var ni=ae.charCodeAt(ye);ni===10&&++ye,Pe.locations&&(++dt,Pt=ye)}else if(Nt===10||Nt===8232||Nt===8233)++ye,Pe.locations&&(++dt,Pt=ye);else if(Nt>8&&Nt<14)++ye;else if(Nt===47){var ni=ae.charCodeAt(ye+1);if(ni===42)lc();else if(ni===47)uo();else break}else if(Nt===160)++ye;else if(Nt>=5760&&Tl.test(String.fromCharCode(Nt)))++ye;else break}}function Xl(){var Nt=ae.charCodeAt(ye+1);return Nt>=48&&Nt<=57?Jo(!0):(++ye,ps(Ct))}function No(){var Nt=ae.charCodeAt(ye+1);return qe?(++ye,vu()):Nt===61?Ds(An,2):Ds(Ii,1)}function $o(){var Nt=ae.charCodeAt(ye+1);return Nt===61?Ds(An,2):Ds(Or,1)}function Mo(Nt){var ni=ae.charCodeAt(ye+1);return ni===Nt?Ds(Nt===124?dr:qr,2):ni===61?Ds(An,2):Ds(Nt===124?Xa:Ka,1)}function Qs(){var Nt=ae.charCodeAt(ye+1);return Nt===61?Ds(An,2):Ds(Ya,1)}function Xo(Nt){var ni=ae.charCodeAt(ye+1);return ni===Nt?ni==45&&ae.charCodeAt(ye+2)==62&&kl.test(ae.slice(Me,ye))?(ye+=3,uo(),co(),eo()):Ds(pn,2):ni===61?Ds(An,2):Ds(Mr,1)}function Yo(Nt){var ni=ae.charCodeAt(ye+1),wi=1;return ni===Nt?(wi=Nt===62&&ae.charCodeAt(ye+2)===62?3:2,ae.charCodeAt(ye+wi)===61?Ds(An,wi+1):Ds(sr,wi)):ni==33&&Nt==60&&ae.charCodeAt(ye+2)==45&&ae.charCodeAt(ye+3)==45?(ye+=4,uo(),co(),eo()):(ni===61&&(wi=ae.charCodeAt(ye+2)===61?3:2),Ds(Wr,wi))}function Ko(Nt){var ni=ae.charCodeAt(ye+1);return ni===61?Ds(ml,ae.charCodeAt(ye+2)===61?3:2):Ds(Nt===61?Li:or,1)}function Ta(Nt){switch(Nt){case 46:return Xl();case 40:return++ye,ps(lo);case 41:return++ye,ps($a);case 59:return++ye,ps(we);case 44:return++ye,ps(G);case 91:return++ye,ps(ds);case 93:return++ye,ps(Wa);case 123:return++ye,ps(ol);case 125:return++ye,ps(ll);case 58:return++ye,ps(at);case 63:return++ye,ps(Yt);case 48:var ni=ae.charCodeAt(ye+1);if(ni===120||ni===88)return Kn();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Jo(!1);case 34:case 39:return Vr(Nt);case 47:return No();case 37:case 42:return $o();case 124:case 38:return Mo(Nt);case 94:return Qs();case 43:case 45:return Xo(Nt);case 60:case 62:return Yo(Nt);case 61:case 33:return Ko(Nt);case 126:return Ds(or,1)}return!1}function eo(Nt){if(Nt?ye=De+1:De=ye,Pe.locations&&(Ve=new Ml),Nt)return vu();if(ye>=re)return ps(ur);var ni=ae.charCodeAt(ye);if(Fa(ni)||ni===92)return Po();var wi=Ta(ni);if(wi===!1){var Ui=String.fromCharCode(ni);if(Ui==="\\"||ma.test(Ui))return Po();ui(ye,"Unexpected character '"+Ui+"'")}return wi}function Ds(Nt,ni){var wi=ae.slice(ye,ye+ni);ye+=ni,ps(Nt,wi)}function vu(){for(var On="",Nt,ni,wi=ye;;){ye>=re&&ui(wi,"Unterminated regular expression");var Ui=ae.charAt(ye);if(kl.test(Ui)&&ui(wi,"Unterminated regular expression"),Nt)Nt=!1;else{if(Ui==="[")ni=!0;else if(Ui==="]"&&ni)ni=!1;else if(Ui==="/"&&!ni)break;Nt=Ui==="\\"}++ye}var On=ae.slice(wi,ye);++ye;var jn=pr();jn&&!/^[gmsiy]*$/.test(jn)&&ui(wi,"Invalid regexp flag");try{var cr=new RegExp(On,jn)}catch(Jn){Jn instanceof SyntaxError&&ui(wi,Jn.message),ui(Jn)}return ps(Si,cr)}function Pr(Nt,ni){for(var wi=ye,Ui=0,On=0,jn=ni??1/0;On<jn;++On){var cr=ae.charCodeAt(ye),Jn;if(cr>=97?Jn=cr-97+10:cr>=65?Jn=cr-65+10:cr>=48&&cr<=57?Jn=cr-48:Jn=1/0,Jn>=Nt)break;++ye,Ui=Ui*Nt+Jn}return ye===wi||ni!=null&&ye-wi!==ni?null:Ui}function Kn(){ye+=2;var Nt=Pr(16);return Nt==null&&ui(De+2,"Expected hexadecimal number"),Fa(ae.charCodeAt(ye))&&ui(ye,"Identifier directly after number"),ps(bi,Nt)}function Jo(Nt){var ni=ye,wi=!1,Ui=ae.charCodeAt(ye)===48;!Nt&&Pr(10)===null&&ui(ni,"Invalid number"),ae.charCodeAt(ye)===46&&(++ye,Pr(10),wi=!0);var On=ae.charCodeAt(ye);(On===69||On===101)&&(On=ae.charCodeAt(++ye),(On===43||On===45)&&++ye,Pr(10)===null&&ui(ni,"Invalid number"),wi=!0),Fa(ae.charCodeAt(ye))&&ui(ye,"Identifier directly after number");var jn=ae.slice(ni,ye),cr;return wi?cr=parseFloat(jn):!Ui||jn.length===1?cr=parseInt(jn,10):/[89]/.test(jn)||ti?ui(ni,"Invalid number"):cr=parseInt(jn,8),ps(bi,cr)}function Vr(Nt){ye++;for(var ni="";;){ye>=re&&ui(De,"Unterminated string constant");var wi=ae.charCodeAt(ye);if(wi===Nt)return++ye,ps(Jt,ni);if(wi===92){wi=ae.charCodeAt(++ye);var Ui=/^[0-7]+/.exec(ae.slice(ye,ye+3));for(Ui&&(Ui=Ui[0]);Ui&&parseInt(Ui,8)>255;)Ui=Ui.slice(0,-1);if(Ui==="0"&&(Ui=null),++ye,Ui)ti&&ui(ye-2,"Octal literal in strict mode"),ni+=String.fromCharCode(parseInt(Ui,8)),ye+=Ui.length-1;else switch(wi){case 110:ni+=`
`;break;case 114:ni+="\r";break;case 120:ni+=String.fromCharCode(to(2));break;case 117:ni+=String.fromCharCode(to(4));break;case 85:ni+=String.fromCharCode(to(8));break;case 116:ni+="	";break;case 98:ni+="\b";break;case 118:ni+="\v";break;case 102:ni+="\f";break;case 48:ni+="\0";break;case 13:ae.charCodeAt(ye)===10&&++ye;case 10:Pe.locations&&(Pt=ye,++dt);break;default:ni+=String.fromCharCode(wi);break}}else(wi===13||wi===10||wi===8232||wi===8233)&&ui(De,"Unterminated string constant"),ni+=String.fromCharCode(wi),++ye}}function to(Nt){var ni=Pr(16,Nt);return ni===null&&ui(De,"Bad character escape sequence"),ni}var ss;function pr(){ss=!1;for(var Nt,ni=!0,wi=ye;;){var Ui=ae.charCodeAt(ye);if(gl(Ui))ss&&(Nt+=ae.charAt(ye)),++ye;else if(Ui===92){ss||(Nt=ae.slice(wi,ye)),ss=!0,ae.charCodeAt(++ye)!=117&&ui(ye,"Expecting Unicode escape sequence \\uXXXX"),++ye;var On=to(4),jn=String.fromCharCode(On);jn||ui(ye-1,"Invalid Unicode escape"),(ni?Fa(On):gl(On))||ui(ye-4,"Invalid Unicode escape"),Nt+=jn}else break;ni=!1}return ss?Nt:ae.slice(wi,ye)}function Po(){var Nt=pr(),ni=Sn;return!ss&&Ns(Nt)&&(ni=Aa[Nt]),ps(ni,Nt)}function qn(){o=De,Me=Oe,li=Je,eo()}function Ul(Nt){if(ti=Nt,ye=De,Pe.locations)for(;ye<Pt;)Pt=ae.lastIndexOf(`
`,Pt-2)+1,--dt;co(),eo()}function as(){this.type=null,this.start=De,this.end=null}function Kr(){this.start=Ve,this.end=null,X!==null&&(this.source=X)}function Ls(){var Nt=new as;return Pe.locations&&(Nt.loc=new Kr),Pe.directSourceFile&&(Nt.sourceFile=Pe.directSourceFile),Pe.ranges&&(Nt.range=[De,0]),Nt}function Br(Nt){var ni=new as;return ni.start=Nt.start,Pe.locations&&(ni.loc=new Kr,ni.loc.start=Nt.loc.start),Pe.ranges&&(ni.range=[Nt.range[0],0]),ni}function ar(Nt,ni){return Nt.type=ni,Nt.end=Me,Pe.locations&&(Nt.loc.end=li),Pe.ranges&&(Nt.range[1]=Me),Nt}function ul(Nt){return Pe.ecmaVersion>=5&&Nt.type==="ExpressionStatement"&&Nt.expression.type==="Literal"&&Nt.expression.value==="use strict"}function is(Nt){if(et===Nt)return qn(),!0}function Do(){return!Pe.strictSemicolons&&(et===ur||et===ll||kl.test(ae.slice(Me,De)))}function cl(){!is(we)&&!Do()&&gs()}function Jr(Nt){et===Nt?qn():gs()}function gs(){ui(De,"Unexpected token")}function ka(Nt){Nt.type!=="Identifier"&&Nt.type!=="MemberExpression"&&ui(Nt.start,"Assigning to rvalue"),ti&&Nt.type==="Identifier"&&Qo(Nt.name)&&ui(Nt.start,"Assigning to "+Nt.name+" in strict mode")}function Pl(Nt){o=Me=ye,Pe.locations&&(li=new Ml),di=ti=null,fi=[],eo();var ni=Nt||Ls(),wi=!0;for(Nt||(ni.body=[]);et!==ur;){var Ui=vo();ni.body.push(Ui),wi&&ul(Ui)&&Ul(!0),wi=!1}return ar(ni,"Program")}var Lo={kind:"loop"},Dl={kind:"switch"};function vo(){(et===Ii||et===An&&Le=="/=")&&eo(!0);var Nt=et,ni=Ls();switch(Nt){case mn:case Qi:qn();var wi=Nt===mn;is(we)||Do()?ni.label=null:et!==Sn?gs():(ni.label=Di(),cl());for(var Ui=0;Ui<fi.length;++Ui){var On=fi[Ui];if((ni.label==null||On.name===ni.label.name)&&(On.kind!=null&&(wi||On.kind==="loop")||ni.label&&wi))break}return Ui===fi.length&&ui(ni.start,"Unsyntactic "+Nt.keyword),ar(ni,wi?"BreakStatement":"ContinueStatement");case hr:return qn(),cl(),ar(ni,"DebuggerStatement");case Xt:return qn(),fi.push(Lo),ni.body=vo(),fi.pop(),Jr(Zs),ni.test=sa(),cl(),ar(ni,"DoWhileStatement");case kn:if(qn(),fi.push(Lo),Jr(lo),et===we)return io(ni,null);if(et===Gr){var jn=Ls();return qn(),ns(jn,!0),ar(jn,"VariableDeclaration"),jn.declarations.length===1&&is(Qn)?el(ni,jn):io(ni,jn)}var jn=vr(!1,!0);return is(Qn)?(ka(jn),el(ni,jn)):io(ni,jn);case Ar:return qn(),mi(ni,!0);case js:return qn(),ni.test=sa(),ni.consequent=vo(),ni.alternate=is(en)?vo():null,ar(ni,"IfStatement");case Qr:return!di&&!Pe.allowReturnOutsideFunction&&ui(De,"'return' outside of function"),qn(),is(we)||Do()?ni.argument=null:(ni.argument=vr(),cl()),ar(ni,"ReturnStatement");case Gt:qn(),ni.discriminant=sa(),ni.cases=[],Jr(ol),fi.push(Dl);for(var cr,Jn;et!=ll;)if(et===Hn||et===Gn){var $s=et===Hn;cr&&ar(cr,"SwitchCase"),ni.cases.push(cr=Ls()),cr.consequent=[],qn(),$s?cr.test=vr():(Jn&&ui(o,"Multiple default clauses"),Jn=!0,cr.test=null),Jr(at)}else cr||gs(),cr.consequent.push(vo());return cr&&ar(cr,"SwitchCase"),qn(),fi.pop(),ar(ni,"SwitchStatement");case fr:return qn(),kl.test(ae.slice(Me,De))&&ui(Me,"Illegal newline after throw"),ni.argument=vr(),cl(),ar(ni,"ThrowStatement");case Bt:if(qn(),ni.block=Ws(),ni.handler=null,et===Yr){var Bs=Ls();qn(),Jr(lo),Bs.param=Di(),ti&&Qo(Bs.param.name)&&ui(Bs.param.start,"Binding "+Bs.param.name+" in strict mode"),Jr($a),Bs.guard=null,Bs.body=Ws(),ni.handler=ar(Bs,"CatchClause")}return ni.guardedHandlers=Ri,ni.finalizer=is(qt)?Ws():null,!ni.handler&&!ni.finalizer&&ui(ni.start,"Missing catch or finally clause"),ar(ni,"TryStatement");case Gr:return qn(),ns(ni),cl(),ar(ni,"VariableDeclaration");case Zs:return qn(),ni.test=sa(),fi.push(Lo),ni.body=vo(),fi.pop(),ar(ni,"WhileStatement");case pa:return ti&&ui(De,"'with' in strict mode"),qn(),ni.object=sa(),ni.body=vo(),ar(ni,"WithStatement");case ol:return Ws();case we:return qn(),ar(ni,"EmptyStatement");default:var _s=Le,ro=vr();if(Nt===Sn&&ro.type==="Identifier"&&is(at)){for(var Ui=0;Ui<fi.length;++Ui)fi[Ui].name===_s&&ui(ro.start,"Label '"+_s+"' is already declared");var bo=et.isLoop?"loop":et===Gt?"switch":null;return fi.push({name:_s,kind:bo}),ni.body=vo(),fi.pop(),ni.label=ro,ar(ni,"LabeledStatement")}else return ni.expression=ro,cl(),ar(ni,"ExpressionStatement")}}function sa(){Jr(lo);var Nt=vr();return Jr($a),Nt}function Ws(Nt){var ni=Ls(),wi=!0,Ui=!1,On;for(ni.body=[],Jr(ol);!is(ll);){var jn=vo();ni.body.push(jn),wi&&Nt&&ul(jn)&&(On=Ui,Ul(Ui=!0)),wi=!1}return Ui&&!On&&Ul(!1),ar(ni,"BlockStatement")}function io(Nt,ni){return Nt.init=ni,Jr(we),Nt.test=et===we?null:vr(),Jr(we),Nt.update=et===$a?null:vr(),Jr($a),Nt.body=vo(),fi.pop(),ar(Nt,"ForStatement")}function el(Nt,ni){return Nt.left=ni,Nt.right=vr(),Jr($a),Nt.body=vo(),fi.pop(),ar(Nt,"ForInStatement")}function ns(Nt,ni){for(Nt.declarations=[],Nt.kind="var";;){var wi=Ls();if(wi.id=Di(),ti&&Qo(wi.id.name)&&ui(wi.id.start,"Binding "+wi.id.name+" in strict mode"),wi.init=is(Li)?vr(!0,ni):null,Nt.declarations.push(ar(wi,"VariableDeclarator")),!is(G))break}return Nt}function vr(Nt,ni){var wi=Hr(ni);if(!Nt&&et===G){var Ui=Br(wi);for(Ui.expressions=[wi];is(G);)Ui.expressions.push(Hr(ni));return ar(Ui,"SequenceExpression")}return wi}function Hr(Nt){var ni=ga(Nt);if(et.isAssign){var wi=Br(ni);return wi.operator=Le,wi.left=ni,qn(),wi.right=Hr(Nt),ka(ni),ar(wi,"AssignmentExpression")}return ni}function ga(Nt){var ni=xo(Nt);if(is(Yt)){var wi=Br(ni);return wi.test=ni,wi.consequent=vr(!0),Jr(at),wi.alternate=vr(!0,Nt),ar(wi,"ConditionalExpression")}return ni}function xo(Nt){return aa(Ma(),-1,Nt)}function aa(Nt,ni,wi){var Ui=et.binop;if(Ui!=null&&(!wi||et!==Qn)&&Ui>ni){var On=Br(Nt);On.left=Nt,On.operator=Le;var jn=et;qn(),On.right=aa(Ma(),Ui,wi);var cr=ar(On,jn===dr||jn===qr?"LogicalExpression":"BinaryExpression");return aa(cr,ni,wi)}return Nt}function Ma(){if(et.prefix){var Nt=Ls(),ni=et.isUpdate;return Nt.operator=Le,Nt.prefix=!0,qe=!0,qn(),Nt.argument=Ma(),ni?ka(Nt.argument):ti&&Nt.operator==="delete"&&Nt.argument.type==="Identifier"&&ui(Nt.start,"Deleting local variable in strict mode"),ar(Nt,ni?"UpdateExpression":"UnaryExpression")}for(var wi=Oa();et.postfix&&!Do();){var Nt=Br(wi);Nt.operator=Le,Nt.prefix=!1,Nt.argument=wi,ka(wi),qn(),wi=ar(Nt,"UpdateExpression")}return wi}function Oa(){return no(hl())}function no(Nt,ni){if(is(Ct)){var wi=Br(Nt);return wi.object=Nt,wi.property=Di(!0),wi.computed=!1,no(ar(wi,"MemberExpression"),ni)}else if(is(ds)){var wi=Br(Nt);return wi.object=Nt,wi.property=vr(),wi.computed=!0,Jr(Wa),no(ar(wi,"MemberExpression"),ni)}else if(!ni&&is(lo)){var wi=Br(Nt);return wi.callee=Nt,wi.arguments=qi($a,!1),no(ar(wi,"CallExpression"),ni)}else return Nt}function hl(){switch(et){case Za:var Ui=Ls();return qn(),ar(Ui,"ThisExpression");case Sn:return Di();case bi:case Jt:case Si:var Ui=Ls();return Ui.value=Le,Ui.raw=ae.slice(De,Oe),qn(),ar(Ui,"Literal");case Oo:case Qa:case ia:var Ui=Ls();return Ui.value=et.atomValue,Ui.raw=et.keyword,qn(),ar(Ui,"Literal");case lo:var Nt=Ve,ni=De;qn();var wi=vr();return wi.start=ni,wi.end=Oe,Pe.locations&&(wi.loc.start=Nt,wi.loc.end=Je),Pe.ranges&&(wi.range=[ni,Oe]),Jr($a),wi;case ds:var Ui=Ls();return qn(),Ui.elements=qi(Wa,!0,!0),ar(Ui,"ArrayExpression");case ol:return _l();case Ar:var Ui=Ls();return qn(),mi(Ui,!1);case Fr:return cu();default:gs()}}function cu(){var Nt=Ls();return qn(),Nt.callee=no(hl(),!0),is(lo)?Nt.arguments=qi($a,!1):Nt.arguments=Ri,ar(Nt,"NewExpression")}function _l(){var Nt=Ls(),ni=!0,wi=!1;for(Nt.properties=[],qn();!is(ll);){if(ni)ni=!1;else if(Jr(G),Pe.allowTrailingCommas&&is(ll))break;var Ui={key:ho()},On=!1,jn;if(is(at)?(Ui.value=vr(!0),jn=Ui.kind="init"):Pe.ecmaVersion>=5&&Ui.key.type==="Identifier"&&(Ui.key.name==="get"||Ui.key.name==="set")?(On=wi=!0,jn=Ui.kind=Ui.key.name,Ui.key=ho(),et!==lo&&gs(),Ui.value=mi(Ls(),!1)):gs(),Ui.key.type==="Identifier"&&(ti||wi))for(var cr=0;cr<Nt.properties.length;++cr){var Jn=Nt.properties[cr];if(Jn.key.name===Ui.key.name){var $s=jn==Jn.kind||On&&Jn.kind==="init"||jn==="init"&&(Jn.kind==="get"||Jn.kind==="set");$s&&!ti&&jn==="init"&&Jn.kind==="init"&&($s=!1),$s&&ui(Ui.key.start,"Redefinition of property")}}Nt.properties.push(Ui)}return ar(Nt,"ObjectExpression")}function ho(){return et===bi||et===Jt?hl():Di(!0)}function mi(Nt,ni){et===Sn?Nt.id=Di():ni?gs():Nt.id=null,Nt.params=[];var wi=!0;for(Jr(lo);!is($a);)wi?wi=!1:Jr(G),Nt.params.push(Di());var Ui=di,On=fi;if(di=!0,fi=[],Nt.body=Ws(!0),di=Ui,fi=On,ti||Nt.body.body.length&&ul(Nt.body.body[0]))for(var jn=Nt.id?-1:0;jn<Nt.params.length;++jn){var cr=jn<0?Nt.id:Nt.params[jn];if((ko(cr.name)||Qo(cr.name))&&ui(cr.start,"Defining '"+cr.name+"' in strict mode"),jn>=0)for(var Jn=0;Jn<jn;++Jn)cr.name===Nt.params[Jn].name&&ui(cr.start,"Argument name clash in strict mode")}return ar(Nt,ni?"FunctionDeclaration":"FunctionExpression")}function qi(Nt,ni,wi){for(var Ui=[],On=!0;!is(Nt);){if(On)On=!1;else if(Jr(G),ni&&Pe.allowTrailingCommas&&is(Nt))break;wi&&et===G?Ui.push(null):Ui.push(vr(!0))}return Ui}function Di(Nt){var ni=Ls();return Nt&&Pe.forbidReserved=="everywhere"&&(Nt=!1),et===Sn?(!Nt&&(Pe.forbidReserved&&(Pe.ecmaVersion===3?ra:Nr)(Le)||ti&&ko(Le))&&ae.slice(De,Oe).indexOf("\\")==-1&&ui(De,"The keyword '"+Le+"' is reserved"),ni.name=Le):Nt&&et.keyword?ni.name=et.keyword:gs(),qe=!1,qn(),ar(ni,"Identifier")}}),M.version||(M=null)}function ie(ot,Pe){return(b.acorn||M).parse(ot,Pe)}var de={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},be={"-":"__negate","+":"__self"},Ee=v.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(ot){this["__"+ot]="#"+ot},{__self:function(){return this}});_e.inject(Ee),nt.inject(Ee),Zi.inject(Ee);function Ce(ot,Pe,ae){var re=de[Pe];if(ot&&ot[re]){var X=ot[re](ae);return Pe==="!="?!X:X}switch(Pe){case"+":return ot+ae;case"-":return ot-ae;case"*":return ot*ae;case"/":return ot/ae;case"%":return ot%ae;case"==":return ot==ae;case"!=":return ot!=ae}}function Re(ot,Pe){var ae=be[ot];if(Pe&&Pe[ae])return Pe[ae]();switch(ot){case"+":return+Pe;case"-":return-Pe}}function $e(ot,Pe){if(!ot)return"";Pe=Pe||{};var ae=[];function re(ti){for(var ui=0,Ri=ae.length;ui<Ri;ui++){var bi=ae[ui];if(bi[0]>=ti)break;ti+=bi[1]}return ti}function X(ti){return ot.substring(re(ti.range[0]),re(ti.range[1]))}function ne(ti,ui){return ot.substring(re(ti.range[1]),re(ui.range[0]))}function pe(ti,ui){for(var Ri=re(ti.range[0]),bi=re(ti.range[1]),Si=0,Jt=ae.length-1;Jt>=0;Jt--)if(Ri>ae[Jt][0]){Si=Jt+1;break}ae.splice(Si,0,[Ri,ui.length-bi+Ri]),ot=ot.substring(0,Ri)+ui+ot.substring(bi)}function xe(ti,ui){switch(ti.type){case"UnaryExpression":if(ti.operator in be&&ti.argument.type!=="Literal"){var Ri=X(ti.argument);pe(ti,'$__("'+ti.operator+'", '+Ri+")")}break;case"BinaryExpression":if(ti.operator in de&&ti.left.type!=="Literal"){var bi=X(ti.left),Si=X(ti.right),Jt=ne(ti.left,ti.right),Sn=ti.operator;pe(ti,"__$__("+bi+","+Jt.replace(new RegExp("\\"+Sn),'"'+Sn+'"')+", "+Si+")")}break;case"UpdateExpression":case"AssignmentExpression":var ur=ui&&ui.type;if(!(ur==="ForStatement"||ur==="BinaryExpression"&&/^[=!<>]/.test(ui.operator)||ur==="MemberExpression"&&ui.computed)){if(ti.type==="UpdateExpression"){var Ri=X(ti.argument),mn="__$__("+Ri+', "'+ti.operator[0]+'", 1)',Hn=Ri+" = "+mn;ti.prefix?Hn="("+Hn+")":(ur==="AssignmentExpression"||ur==="VariableDeclarator"||ur==="BinaryExpression")&&(X(ui.left||ui.id)===Ri&&(Hn=mn),Hn=Ri+"; "+Hn),pe(ti,Hn)}else if(/^.=$/.test(ti.operator)&&ti.left.type!=="Literal"){var bi=X(ti.left),Si=X(ti.right),mn=bi+" = __$__("+bi+', "'+ti.operator[0]+'", '+Si+")";pe(ti,/^\(.*\)$/.test(X(ti))?"("+mn+")":mn)}}break}}function ye(ti){switch(ti.type){case"ExportDefaultDeclaration":pe({range:[ti.start,ti.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var ui=ti.declaration,Ri=ti.specifiers;if(ui){var bi=ui.declarations;bi&&(bi.forEach(function(Jt){pe(Jt,"module.exports."+X(Jt))}),pe({range:[ti.start,ui.start+ui.kind.length]},""))}else if(Ri){var Si=Ri.map(function(Jt){var Sn=X(Jt);return"module.exports."+Sn+" = "+Sn+"; "}).join("");Si&&pe(ti,Si)}break}}function De(ti,ui,Ri){if(ti){for(var bi in ti)if(bi!=="range"&&bi!=="loc"){var Si=ti[bi];if(Array.isArray(Si))for(var Jt=0,Sn=Si.length;Jt<Sn;Jt++)De(Si[Jt],ti,Ri);else Si&&typeof Si=="object"&&De(Si,ti,Ri)}Ri.operatorOverloading!==!1&&xe(ti,ui),Ri.moduleExports!==!1&&ye(ti)}}function Oe(ti){var ui="",Ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(ti=(Math.abs(ti)<<1)+(ti<0?1:0);ti||!ui;){var bi=ti&31;ti>>=5,ti&&(bi|=32),ui+=Ri[bi]}return ui}var Ve=Pe.url||"",Je=Pe.sourceMaps,et=Pe.paperFeatures||{},Le=Pe.source||ot,qe=Pe.offset||0,dt=_n.agent,Pt=dt.versionNumber,o=!1,Me=/\r\n|\n|\r/mg,li;if(Je&&(dt.chrome&&Pt>=30||dt.webkit&&Pt>=537.76||dt.firefox&&Pt>=23||dt.node)){if(dt.node)qe-=2;else if(c&&Ve&&!c.location.href.indexOf(Ve)){var di=g.getElementsByTagName("html")[0].innerHTML;qe=di.substr(0,di.indexOf(ot)+1).match(Me).length+1}o=qe>0&&!(dt.chrome&&Pt>=36||dt.safari&&Pt>=600||dt.firefox&&Pt>=40||dt.node);var fi=["AA"+Oe(o?0:qe)+"A"];fi.length=(ot.match(Me)||[]).length+1+(o?qe:0),li={version:3,file:Ve,names:[],mappings:fi.join(";AACA"),sourceRoot:"",sources:[Ve],sourcesContent:[Le]}}return(et.operatorOverloading!==!1||et.moduleExports!==!1)&&De(ie(ot,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,et),li&&(o&&(ot=new Array(qe+1).join(`
`)+ot),/^(inline|both)$/.test(Je)&&(ot+=`
//# sourceMappingURL=data:application/json;base64,`+e.btoa(unescape(encodeURIComponent(JSON.stringify(li))))),ot+=`
//# sourceURL=`+(Ve||"paperscript")),{url:Ve,source:Le,code:ot,map:li}}function je(ot,Pe,ae){_n=Pe;var re=Pe.getView(),X=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(ot)&&!/\bnew\s+Tool\b/.test(ot)?new an:null,ne=X?X._events:[],pe=["onFrame","onResize"].concat(ne),xe=[],ye=[],De,Oe=typeof ot=="object"?ot:$e(ot,ae);ot=Oe.code;function Ve(Pt,o){for(var Me in Pt)(o||!/^_/.test(Me))&&new RegExp("([\\b\\s\\W]|^)"+Me.replace(/\$/g,"\\$")+"\\b").test(ot)&&(xe.push(Me),ye.push(Pt[Me]))}Ve({__$__:Ce,$__:Re,paper:Pe,tool:X},!0),Ve(Pe),ot="var module = { exports: {} }; "+ot;var qe=v.each(pe,function(Pt){new RegExp("\\s+"+Pt+"\\b").test(ot)&&(xe.push(Pt),this.push("module.exports."+Pt+" = "+Pt+";"))},[]).join(`
`);qe&&(ot+=`
`+qe),ot+=`
return module.exports;`;var Je=_n.agent;if(g&&(Je.chrome||Je.firefox&&Je.versionNumber<40)){var et=g.createElement("script"),Le=g.head||g.getElementsByTagName("head")[0];Je.firefox&&(ot=`
`+ot),et.appendChild(g.createTextNode("document.__paperscript__ = function("+xe+") {"+ot+`
}`)),Le.appendChild(et),De=g.__paperscript__,delete g.__paperscript__,Le.removeChild(et)}else De=Function(xe,ot);var qe=De&&De.apply(Pe,ye),dt=qe||{};return v.each(ne,function(Pt){var o=dt[Pt];o&&(X[Pt]=o)}),re&&(dt.onResize&&re.setOnResize(dt.onResize),re.emit("resize",{size:re.size,delta:new _e}),dt.onFrame&&re.setOnFrame(dt.onFrame),re.requestUpdate()),qe}function We(ot){if(/^text\/(?:x-|)paperscript$/.test(ot.type)&&a.getAttribute(ot,"ignore")!=="true"){var Pe=a.getAttribute(ot,"canvas"),ae=g.getElementById(Pe),re=ot.src||ot.getAttribute("data-src"),X=a.hasAttribute(ot,"async"),ne="data-paper-scope";if(!ae)throw new Error('Unable to find canvas with id "'+Pe+'"');var pe=a.get(ae.getAttribute(ne))||new a().setup(ae);return ae.setAttribute(ne,pe._id),re?oi.request({url:re,async:X,mimeType:"text/plain",onLoad:function(xe){je(xe,pe,re)}}):je(ot.innerHTML,pe,ot.baseURI),ot.setAttribute("data-paper-ignore","true"),pe}}function Ge(){v.each(g&&g.getElementsByTagName("script"),We)}function mt(ot){return ot?We(ot):Ge()}return c&&(g.readyState==="complete"?setTimeout(Ge):gi.add(c,{load:Ge})),{compile:$e,execute:je,load:mt,parse:ie,calculateBinary:Ce,calculateUnary:Re}}).call(this);var _n=new(a.inject(v.exports,{Base:v,Numerical:oe,Key:xi,DomEvent:gi,DomElement:Ti,document:g,window:c,Symbol:St,PlacedSymbol:yt}));return _n.agent.node&&Ix(_n),typeof n=="function"&&n.amd?n("paper",_n):t&&(t.exports=_n),_n}).call(s0,typeof self=="object"?self:null)})(P3);var N1=P3.exports;function BT(t){let e,n,c="Click and drag to draw a polygon. Press Escape to exit.",g,v;return{c(){e=Pn("div"),n=Pn("span"),n.textContent=c,g=_r(),v=Pn("canvas"),this.h()},l(S){e=Dn(S,"DIV",{class:!0});var a=rn(e);n=Dn(a,"SPAN",{class:!0,"data-svelte-h":!0}),$u(n)!=="svelte-1m9xrla"&&(n.textContent=c),g=yr(a),v=Dn(a,"CANVAS",{class:!0}),rn(v).forEach(Ai),a.forEach(Ai),this.h()},h(){_i(n,"class","svelte-jrtjeu"),_i(v,"class","canvas svelte-jrtjeu"),_i(e,"class","draw-wrapper svelte-jrtjeu")},m(S,a){yn(S,e,a),Bi(e,n),Bi(e,g),Bi(e,v),t[5](v)},p:Ra,i:Ra,o:Ra,d(S){S&&Ai(e),t[5](null)}}}function zT(t,e,n){let{path:c}=e,{updatePath:g}=e,{updateIsDrawing:v}=e,{isDrawing:S}=e,a,N;wc(()=>{N1.setup(N);let he=new N1.Tool;he.onMouseDown=function(oe){n(1,c=new N1.Path),n(1,c.strokeColor="white",c),c.add(oe.point)},he.onMouseDrag=function(oe){a&&c.add(oe.point)},he.onMouseUp=function(oe){if(!a)return;c.simplify(.5),c.clearHandles(),n(1,c.closed=!0,c);let ce=[];for(let _e of c.segments){console.log();let Ze=_e.point;ce.push({x:Ze.x,y:Ze.y})}g(ce),v(!1)},he.onKeyDown=function(oe){console.log(oe),oe.key==="escape"&&v(!1)}});function $(he){ta[he?"unshift":"push"](()=>{N=he,n(0,N)})}return t.$$set=he=>{"path"in he&&n(1,c=he.path),"updatePath"in he&&n(2,g=he.updatePath),"updateIsDrawing"in he&&n(3,v=he.updateIsDrawing),"isDrawing"in he&&n(4,S=he.isDrawing)},t.$$.update=()=>{t.$$.dirty&16&&(a=S)},[N,c,g,v,S,$]}class RT extends Ha{constructor(e){super(),ja(this,e,zT,BT,Ca,{path:1,updatePath:2,updateIsDrawing:3,isDrawing:4})}}const dm=["pd","mpd","mntd","pdSigCal","mpdSigCal","mntdSigCal","pdSigEco","mpdSigEco","mntdSigEco","tree_sizes"],Cx={pd:"phylodiversity",mpd:"mean pairwise phylogenetic distance",mntd:"mean nearest-taxon phylogenetic distance"};function FT(t){if(!t||!dm.includes(t))return;const n=650;let c=new Array(n),g=[0,1];const v=Tx[1]/n;let S;switch(t){case"mntd":case"rel_mntd":S=pm.mntd;break;case"mpd":case"rel_mpd":S=pm.mpd;break;default:case"pd":S=pm.pd}let a=S.d,N=S.b,$=S.e,he=S.c,oe=S.modelHigh,ce=S.modelLow,_e=S.minY,Ze=S.maxY,nt=2;for(let Ke=0;Ke<n;Ke++){let st=(Ke+nt)*v;c[Ke]={x:st,high:oe({x:st,b:N.high,c:he.high,d:a.high,e:$.high}),low:ce({x:st,b:N.low,c:he.low,d:a.low,e:$.low})}}return g=[_e,Ze],{confidence:c,yAxis:g,xAxis:Tx,xAxisLabel:"Tree Size",yAxisLabel:S.yAxisLabel}}const Tx=[0,300],pm={pd:{b:{low:-.7505,high:-.6608},c:{low:9.567,high:123.1524},d:{low:11690.7906,high:10762.3392},e:{low:1298.4931,high:1308.4918},minY:100,maxY:5e3,yAxisLabel:"Phylodiversity (pd)",modelHigh:({x:t,b:e,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(e*(Math.log(t)-Math.log(g)))),modelLow:({x:t,b:e,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(e*(Math.log(t)-Math.log(g))))},mpd:{b:{low:-.6495,high:.4117},c:{low:-39.3099,high:93.617},d:{low:102.1695,high:152.3637},e:{low:1.2904,high:2.763},minY:0,maxY:200,yAxisLabel:"Mean pairwise phylogenetic distance (mpd)",modelHigh:({x:t,b:e,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(e*(Math.log(t)-Math.log(g)))),modelLow:({x:t,b:e,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(e*(Math.log(t)-Math.log(g))))},mntd:{b:{low:1.2883,high:.9501},c:{low:8.8277,high:5.9462},d:{low:33.4172,high:156.3706},e:{low:44.5908,high:10.2206},minY:0,maxY:150,yAxisLabel:"Mean nearest-taxon phylogenetic distance (mntd)",modelHigh:({x:t,b:e,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(e*(Math.log(t)-Math.log(g)))),modelLow:({x:t,b:e,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(e*(Math.log(t)-Math.log(g))))}};function OT(t,e,n){if(e===-1||e==NaN)return-1;let c;switch(t){case"mntd":case"rel_mntd":c=pm.mntd;break;case"mpd":case"rel_mpd":c=pm.mpd;break;default:case"pd":c=pm.pd}let g=c.d,v=c.b,S=c.e,a=c.c,N=c.modelHigh,$=c.modelLow;N({x:n,b:v.high,c:a.high,d:g.high,e:S.high});let he=$({x:n,b:v.low,c:a.low,d:g.low,e:S.low});return e-he}function kx(t){let e,n=(t[1][0]??"min")+"",c,g,v,S=(t[1][1]??"med")+"",a,N,$,he=(t[1][2]??"max")+"",oe;return{c(){e=Pn("span"),c=Fs(n),g=_r(),v=Pn("span"),a=Fs(S),N=_r(),$=Pn("span"),oe=Fs(he),this.h()},l(ce){e=Dn(ce,"SPAN",{class:!0});var _e=rn(e);c=Os(_e,n),_e.forEach(Ai),g=yr(ce),v=Dn(ce,"SPAN",{class:!0});var Ze=rn(v);a=Os(Ze,S),Ze.forEach(Ai),N=yr(ce),$=Dn(ce,"SPAN",{class:!0});var nt=rn($);oe=Os(nt,he),nt.forEach(Ai),this.h()},h(){_i(e,"class","svelte-quxlvz"),_i(v,"class","svelte-quxlvz"),_i($,"class","svelte-quxlvz")},m(ce,_e){yn(ce,e,_e),Bi(e,c),yn(ce,g,_e),yn(ce,v,_e),Bi(v,a),yn(ce,N,_e),yn(ce,$,_e),Bi($,oe)},p(ce,_e){_e&2&&n!==(n=(ce[1][0]??"min")+"")&&El(c,n),_e&2&&S!==(S=(ce[1][1]??"med")+"")&&El(a,S),_e&2&&he!==(he=(ce[1][2]??"max")+"")&&El(oe,he)},d(ce){ce&&(Ai(e),Ai(g),Ai(v),Ai(N),Ai($))}}}function NT(t){let e,n,c,g,v,S=t[1]&&kx(t);return{c(){e=Pn("div"),n=Pn("div"),g=_r(),v=Pn("div"),S&&S.c(),this.h()},l(a){e=Dn(a,"DIV",{class:!0});var N=rn(e);n=Dn(N,"DIV",{class:!0,style:!0}),rn(n).forEach(Ai),g=yr(N),v=Dn(N,"DIV",{class:!0});var $=rn(v);S&&S.l($),$.forEach(Ai),N.forEach(Ai),this.h()},h(){_i(n,"class","gradient svelte-quxlvz"),_i(n,"style",c=`background-image: none, ${t[0]}`),_i(v,"class","label-container svelte-quxlvz"),_i(e,"class","legend-container svelte-quxlvz")},m(a,N){yn(a,e,N),Bi(e,n),Bi(e,g),Bi(e,v),S&&S.m(v,null)},p(a,[N]){N&1&&c!==(c=`background-image: none, ${a[0]}`)&&_i(n,"style",c),a[1]?S?S.p(a,N):(S=kx(a),S.c(),S.m(v,null)):S&&(S.d(1),S=null)},i:Ra,o:Ra,d(a){a&&Ai(e),S&&S.d()}}}function VT(t,e,n){let c;Il(t,cg,oe=>n(6,c=oe));let g=b_(),v,{colorScheme:S}=e,{metric:a}=e,N=[0,.5,1];function $(oe){console.log(oe);let ce=`linear-gradient(${oe.map(_e=>_e[1]).flat().reverse()})`;return console.log(ce),ce}function he(oe){if(!(oe!=null&&oe.length))return;let ce=oe.length-2;n(1,N[2]=Math.round(oe[ce]??1),N),n(1,N[1]=Math.round(oe[ce-2]??.5),N),n(1,N[0]=Math.round(oe[ce-4]??0),N),console.log(oe)}return t.$$set=oe=>{"colorScheme"in oe&&n(2,S=oe.colorScheme),"metric"in oe&&n(3,a=oe.metric)},t.$$.update=()=>{t.$$.dirty&4&&n(5,g=b_(0,1,S).slice(1)),t.$$.dirty&32&&n(0,v=$(g)),t.$$.dirty&64&&c&&he(c)},[v,N,S,a,$,g,c]}class UT extends Ha{constructor(e){super(),ja(this,e,VT,NT,Ca,{colorScheme:2,metric:3,createPaletteGradient:4})}get createPaletteGradient(){return this.$$.ctx[4]}}function Mx(t){let e,n,c,g,v,S,a,N,$,he,oe,ce,_e;return{c(){e=ws("svg"),n=ws("defs"),c=ws("style"),g=Fs(`.cls-1 {
          fill: #fff;
        }
      `),v=ws("g"),S=ws("g"),a=ws("g"),N=ws("path"),$=ws("path"),he=ws("path"),oe=ws("path"),ce=ws("path"),_e=ws("polygon"),this.h()},l(Ze){e=Ss(Ze,"svg",{id:!0,"data-name":!0,xmlns:!0,viewBox:!0});var nt=rn(e);n=Ss(nt,"defs",{});var Ke=rn(n);c=Ss(Ke,"style",{});var st=rn(c);g=Os(st,`.cls-1 {
          fill: #fff;
        }
      `),st.forEach(Ai),Ke.forEach(Ai),v=Ss(nt,"g",{id:!0,"data-name":!0});var ht=rn(v);S=Ss(ht,"g",{});var xt=rn(S);a=Ss(xt,"g",{});var zt=rn(a);N=Ss(zt,"path",{class:!0,d:!0}),rn(N).forEach(Ai),$=Ss(zt,"path",{class:!0,d:!0}),rn($).forEach(Ai),he=Ss(zt,"path",{class:!0,d:!0}),rn(he).forEach(Ai),oe=Ss(zt,"path",{class:!0,d:!0}),rn(oe).forEach(Ai),ce=Ss(zt,"path",{class:!0,d:!0}),rn(ce).forEach(Ai),zt.forEach(Ai),_e=Ss(xt,"polygon",{class:!0,points:!0}),rn(_e).forEach(Ai),xt.forEach(Ai),ht.forEach(Ai),nt.forEach(Ai),this.h()},h(){_i(N,"class","cls-1"),_i(N,"d","m9.41.16c1.38,0,2.18.92,1.92,2.28-.33,1.76-1.73,2.88-3.52,2.98l-1.2.06-1.13,3.08-1.68.12L6.91.16h2.5Zm-1.4,1.58l-.8,2.12.87-.03c.93-.03,1.38-.63,1.48-1.19.1-.56-.12-.92-.86-.91h-.68Z"),_i($,"class","cls-1"),_i($,"d","m14.62,7.9l1.24-3.16-2.79.12-1.25,3.24-1.68.12L13.24.15h1.69s-1.21,3.04-1.21,3.04l2.8-.08,1.21-2.96h1.7s-3.11,7.63-3.11,7.63l-1.7.12Z"),_i(he,"class","cls-1"),_i(he,"d","m22.82,5.85l-2.81.16-1.15,1.58-1.89.14L22.88.14h1.96s-.36,7.04-.36,7.04l-1.75.13.1-1.46Zm-1.65-1.38l1.75-.08.19-2.47-1.94,2.54Z"),_i(oe,"class","cls-1"),_i(oe,"d","m29.21,4.99c.06-.27,0-.48-.4-.63l-.81-.29c-.94-.34-1.26-1.02-1.08-1.84.3-1.36,1.78-2.23,3.24-2.23,2.08,0,2.33,1.22,2.18,1.89l-1.62.26c.04-.19.1-.88-.92-.86-.62,0-1.07.4-1.15.77-.08.34.12.52.39.63l.73.28c1.08.4,1.41,1,1.22,1.82-.23,1.05-1.46,2.18-3.22,2.31-2.15.16-2.61-1.14-2.41-2.06.03-.13.05-.21.08-.27l1.6-.32s-.05.14-.07.23c-.12.58.14,1.13,1.06,1.09.65-.04,1.09-.34,1.18-.77Z"),_i(ce,"class","cls-1"),_i(ce,"d","m36.78,1.44l-2.45,5.03-1.69.12,2.44-5.13-2.22.04.67-1.38h6.04s-.67,1.28-.67,1.28l-2.12.03Z"),_i(_e,"class","cls-1"),_i(_e,"points","3.79 .23 1.5 .23 0 2.22 .8 4.21 3.09 4.21 4.59 2.22 3.79 .23"),_i(v,"id","Layer_1-2"),_i(v,"data-name","Layer 1"),_i(e,"id","Layer_2"),_i(e,"data-name","Layer 2"),_i(e,"xmlns","http://www.w3.org/2000/svg"),_i(e,"viewBox","0 0 39.57 8.68")},m(Ze,nt){yn(Ze,e,nt),Bi(e,n),Bi(n,c),Bi(c,g),Bi(e,v),Bi(v,S),Bi(S,a),Bi(a,N),Bi(a,$),Bi(a,he),Bi(a,oe),Bi(a,ce),Bi(S,_e)},d(Ze){Ze&&Ai(e)}}}function Px(t){let e,n,c,g,v,S,a,N,$,he,oe,ce,_e;return{c(){e=ws("svg"),n=ws("defs"),c=ws("style"),g=Fs(`.cls-1 {
        fill: #29abe2;
      }
    `),v=ws("g"),S=ws("g"),a=ws("g"),N=ws("path"),$=ws("path"),he=ws("path"),oe=ws("path"),ce=ws("path"),_e=ws("polygon"),this.h()},l(Ze){e=Ss(Ze,"svg",{id:!0,"data-name":!0,xmlns:!0,viewBox:!0});var nt=rn(e);n=Ss(nt,"defs",{});var Ke=rn(n);c=Ss(Ke,"style",{});var st=rn(c);g=Os(st,`.cls-1 {
        fill: #29abe2;
      }
    `),st.forEach(Ai),Ke.forEach(Ai),v=Ss(nt,"g",{id:!0,"data-name":!0});var ht=rn(v);S=Ss(ht,"g",{});var xt=rn(S);a=Ss(xt,"g",{});var zt=rn(a);N=Ss(zt,"path",{class:!0,d:!0}),rn(N).forEach(Ai),$=Ss(zt,"path",{class:!0,d:!0}),rn($).forEach(Ai),he=Ss(zt,"path",{class:!0,d:!0}),rn(he).forEach(Ai),oe=Ss(zt,"path",{class:!0,d:!0}),rn(oe).forEach(Ai),ce=Ss(zt,"path",{class:!0,d:!0}),rn(ce).forEach(Ai),zt.forEach(Ai),_e=Ss(xt,"polygon",{class:!0,points:!0}),rn(_e).forEach(Ai),xt.forEach(Ai),ht.forEach(Ai),nt.forEach(Ai),this.h()},h(){_i(N,"class","cls-1"),_i(N,"d","m9.41.16c1.38,0,2.18.92,1.92,2.28-.33,1.76-1.73,2.88-3.52,2.98l-1.2.06-1.13,3.08-1.68.12L6.91.16h2.5Zm-1.4,1.58l-.8,2.12.87-.03c.93-.03,1.38-.63,1.48-1.19.1-.56-.12-.92-.86-.91h-.68Z"),_i($,"class","cls-1"),_i($,"d","m14.62,7.9l1.24-3.16-2.79.12-1.25,3.24-1.68.12L13.24.15h1.69s-1.21,3.04-1.21,3.04l2.8-.08,1.21-2.96h1.7s-3.11,7.63-3.11,7.63l-1.7.12Z"),_i(he,"class","cls-1"),_i(he,"d","m22.82,5.85l-2.81.16-1.15,1.58-1.89.14L22.88.14h1.96s-.36,7.04-.36,7.04l-1.75.13.1-1.46Zm-1.65-1.38l1.75-.08.19-2.47-1.94,2.54Z"),_i(oe,"class","cls-1"),_i(oe,"d","m29.21,4.99c.06-.27,0-.48-.4-.63l-.81-.29c-.94-.34-1.26-1.02-1.08-1.84.3-1.36,1.78-2.23,3.24-2.23,2.08,0,2.33,1.22,2.18,1.89l-1.62.26c.04-.19.1-.88-.92-.86-.62,0-1.07.4-1.15.77-.08.34.12.52.39.63l.73.28c1.08.4,1.41,1,1.22,1.82-.23,1.05-1.46,2.18-3.22,2.31-2.15.16-2.61-1.14-2.41-2.06.03-.13.05-.21.08-.27l1.6-.32s-.05.14-.07.23c-.12.58.14,1.13,1.06,1.09.65-.04,1.09-.34,1.18-.77Z"),_i(ce,"class","cls-1"),_i(ce,"d","m36.78,1.44l-2.45,5.03-1.69.12,2.44-5.13-2.22.04.67-1.38h6.04s-.67,1.28-.67,1.28l-2.12.03Z"),_i(_e,"class","cls-1"),_i(_e,"points","3.79 .23 1.5 .23 0 2.22 .8 4.21 3.09 4.21 4.59 2.22 3.79 .23"),_i(v,"id","Layer_1-2"),_i(v,"data-name","Layer 1"),_i(e,"id","Layer_2"),_i(e,"data-name","Layer 2"),_i(e,"xmlns","http://www.w3.org/2000/svg"),_i(e,"viewBox","0 0 39.57 8.68")},m(Ze,nt){yn(Ze,e,nt),Bi(e,n),Bi(n,c),Bi(c,g),Bi(e,v),Bi(v,S),Bi(S,a),Bi(a,N),Bi(a,$),Bi(a,he),Bi(a,oe),Bi(a,ce),Bi(S,_e)},d(Ze){Ze&&Ai(e)}}}function GT(t){let e,n,c=t[0]&&Mx(),g=!t[0]&&Px();return{c(){c&&c.c(),e=_r(),g&&g.c(),n=Zr()},l(v){c&&c.l(v),e=yr(v),g&&g.l(v),n=Zr()},m(v,S){c&&c.m(v,S),yn(v,e,S),g&&g.m(v,S),yn(v,n,S)},p(v,[S]){v[0]?c||(c=Mx(),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),v[0]?g&&(g.d(1),g=null):g||(g=Px(),g.c(),g.m(n.parentNode,n))},i:Ra,o:Ra,d(v){v&&(Ai(e),Ai(n)),c&&c.d(v),g&&g.d(v)}}}function qT(t,e,n){let{white:c=!1}=e;return t.$$set=g=>{"white"in g&&n(0,c=g.white)},[c]}class Nv extends Ha{constructor(e){super(),ja(this,e,qT,GT,Ca,{white:0})}}function a_(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function HT(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function D3(t){let e,n,c;t.length!==2?(e=a_,n=(a,N)=>a_(t(a),N),c=(a,N)=>t(a)-N):(e=t===a_||t===HT?t:jT,n=t,c=t);function g(a,N,$=0,he=a.length){if($<he){if(e(N,N)!==0)return he;do{const oe=$+he>>>1;n(a[oe],N)<0?$=oe+1:he=oe}while($<he)}return $}function v(a,N,$=0,he=a.length){if($<he){if(e(N,N)!==0)return he;do{const oe=$+he>>>1;n(a[oe],N)<=0?$=oe+1:he=oe}while($<he)}return $}function S(a,N,$=0,he=a.length){const oe=g(a,N,$,he-1);return oe>$&&c(a[oe-1],N)>-c(a[oe],N)?oe-1:oe}return{left:g,center:S,right:v}}function jT(){return 0}function ZT(t){return t===null?NaN:+t}const QT=D3(a_),WT=QT.right;D3(ZT).center;function Dx(t,e){let n,c;if(e===void 0)for(const g of t)g!=null&&(n===void 0?g>=g&&(n=c=g):(n>g&&(n=g),c<g&&(c=g)));else{let g=-1;for(let v of t)(v=e(v,++g,t))!=null&&(n===void 0?v>=v&&(n=c=v):(n>v&&(n=v),c<v&&(c=v)))}return[n,c]}const $T=Math.sqrt(50),XT=Math.sqrt(10),YT=Math.sqrt(2);function w_(t,e,n){const c=(e-t)/Math.max(0,n),g=Math.floor(Math.log10(c)),v=c/Math.pow(10,g),S=v>=$T?10:v>=XT?5:v>=YT?2:1;let a,N,$;return g<0?($=Math.pow(10,-g)/S,a=Math.round(t*$),N=Math.round(e*$),a/$<t&&++a,N/$>e&&--N,$=-$):($=Math.pow(10,g)*S,a=Math.round(t/$),N=Math.round(e/$),a*$<t&&++a,N*$>e&&--N),N<a&&.5<=n&&n<2?w_(t,e,n*2):[a,N,$]}function KT(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const c=e<t,[g,v,S]=c?w_(e,t,n):w_(t,e,n);if(!(v>=g))return[];const a=v-g+1,N=new Array(a);if(c)if(S<0)for(let $=0;$<a;++$)N[$]=(v-$)/-S;else for(let $=0;$<a;++$)N[$]=(v-$)*S;else if(S<0)for(let $=0;$<a;++$)N[$]=(g+$)/-S;else for(let $=0;$<a;++$)N[$]=(g+$)*S;return N}function Uy(t,e,n){return e=+e,t=+t,n=+n,w_(t,e,n)[2]}function JT(t,e,n){e=+e,t=+t,n=+n;const c=e<t,g=c?Uy(e,t,n):Uy(t,e,n);return(c?-1:1)*(g<0?1/-g:g)}function e6(t){return t}var V1=1,U1=2,Gy=3,hg=4,Lx=1e-6;function t6(t){return"translate("+t+",0)"}function i6(t){return"translate(0,"+t+")"}function n6(t){return e=>+t(e)}function r6(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function s6(){return!this.__axis}function L3(t,e){var n=[],c=null,g=null,v=6,S=6,a=3,N=typeof window<"u"&&window.devicePixelRatio>1?0:.5,$=t===V1||t===hg?-1:1,he=t===hg||t===U1?"x":"y",oe=t===V1||t===Gy?t6:i6;function ce(_e){var Ze=c??(e.ticks?e.ticks.apply(e,n):e.domain()),nt=g??(e.tickFormat?e.tickFormat.apply(e,n):e6),Ke=Math.max(v,0)+a,st=e.range(),ht=+st[0]+N,xt=+st[st.length-1]+N,zt=(e.bandwidth?r6:n6)(e.copy(),N),Mt=_e.selection?_e.selection():_e,Ue=Mt.selectAll(".domain").data([null]),$t=Mt.selectAll(".tick").data(Ze,e).order(),rt=$t.exit(),gt=$t.enter().append("g").attr("class","tick"),At=$t.select("line"),yt=$t.select("text");Ue=Ue.merge(Ue.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),$t=$t.merge(gt),At=At.merge(gt.append("line").attr("stroke","currentColor").attr(he+"2",$*v)),yt=yt.merge(gt.append("text").attr("fill","currentColor").attr(he,$*Ke).attr("dy",t===V1?"0em":t===Gy?"0.71em":"0.32em")),_e!==Mt&&(Ue=Ue.transition(_e),$t=$t.transition(_e),At=At.transition(_e),yt=yt.transition(_e),rt=rt.transition(_e).attr("opacity",Lx).attr("transform",function(St){return isFinite(St=zt(St))?oe(St+N):this.getAttribute("transform")}),gt.attr("opacity",Lx).attr("transform",function(St){var ut=this.parentNode.__axis;return oe((ut&&isFinite(ut=ut(St))?ut:zt(St))+N)})),rt.remove(),Ue.attr("d",t===hg||t===U1?S?"M"+$*S+","+ht+"H"+N+"V"+xt+"H"+$*S:"M"+N+","+ht+"V"+xt:S?"M"+ht+","+$*S+"V"+N+"H"+xt+"V"+$*S:"M"+ht+","+N+"H"+xt),$t.attr("opacity",1).attr("transform",function(St){return oe(zt(St)+N)}),At.attr(he+"2",$*v),yt.attr(he,$*Ke).text(nt),Mt.filter(s6).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===U1?"start":t===hg?"end":"middle"),Mt.each(function(){this.__axis=zt})}return ce.scale=function(_e){return arguments.length?(e=_e,ce):e},ce.ticks=function(){return n=Array.from(arguments),ce},ce.tickArguments=function(_e){return arguments.length?(n=_e==null?[]:Array.from(_e),ce):n.slice()},ce.tickValues=function(_e){return arguments.length?(c=_e==null?null:Array.from(_e),ce):c&&c.slice()},ce.tickFormat=function(_e){return arguments.length?(g=_e,ce):g},ce.tickSize=function(_e){return arguments.length?(v=S=+_e,ce):v},ce.tickSizeInner=function(_e){return arguments.length?(v=+_e,ce):v},ce.tickSizeOuter=function(_e){return arguments.length?(S=+_e,ce):S},ce.tickPadding=function(_e){return arguments.length?(a=+_e,ce):a},ce.offset=function(_e){return arguments.length?(N=+_e,ce):N},ce}function a6(t){return L3(Gy,t)}function o6(t){return L3(hg,t)}var l6={value:()=>{}};function B3(){for(var t=0,e=arguments.length,n={},c;t<e;++t){if(!(c=arguments[t]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new o_(n)}function o_(t){this._=t}function u6(t,e){return t.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}o_.prototype=B3.prototype={constructor:o_,on:function(t,e){var n=this._,c=u6(t+"",n),g,v=-1,S=c.length;if(arguments.length<2){for(;++v<S;)if((g=(t=c[v]).type)&&(g=c6(n[g],t.name)))return g;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++v<S;)if(g=(t=c[v]).type)n[g]=Bx(n[g],t.name,e);else if(e==null)for(g in n)n[g]=Bx(n[g],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new o_(t)},call:function(t,e){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,v;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(v=this._[t],c=0,g=v.length;c<g;++c)v[c].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var c=this._[t],g=0,v=c.length;g<v;++g)c[g].value.apply(e,n)}};function c6(t,e){for(var n=0,c=t.length,g;n<c;++n)if((g=t[n]).name===e)return g.value}function Bx(t,e,n){for(var c=0,g=t.length;c<g;++c)if(t[c].name===e){t[c]=l6,t=t.slice(0,c).concat(t.slice(c+1));break}return n!=null&&t.push({name:e,value:n}),t}var qy="http://www.w3.org/1999/xhtml";const zx={svg:"http://www.w3.org/2000/svg",xhtml:qy,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function i1(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),zx.hasOwnProperty(e)?{space:zx[e],local:t}:t}function h6(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===qy&&e.documentElement.namespaceURI===qy?e.createElement(t):e.createElementNS(n,t)}}function A6(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function z3(t){var e=i1(t);return(e.local?A6:h6)(e)}function f6(){}function Vv(t){return t==null?f6:function(){return this.querySelector(t)}}function d6(t){typeof t!="function"&&(t=Vv(t));for(var e=this._groups,n=e.length,c=new Array(n),g=0;g<n;++g)for(var v=e[g],S=v.length,a=c[g]=new Array(S),N,$,he=0;he<S;++he)(N=v[he])&&($=t.call(N,N.__data__,he,v))&&("__data__"in N&&($.__data__=N.__data__),a[he]=$);return new gh(c,this._parents)}function p6(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function m6(){return[]}function R3(t){return t==null?m6:function(){return this.querySelectorAll(t)}}function g6(t){return function(){return p6(t.apply(this,arguments))}}function _6(t){typeof t=="function"?t=g6(t):t=R3(t);for(var e=this._groups,n=e.length,c=[],g=[],v=0;v<n;++v)for(var S=e[v],a=S.length,N,$=0;$<a;++$)(N=S[$])&&(c.push(t.call(N,N.__data__,$,S)),g.push(N));return new gh(c,g)}function F3(t){return function(){return this.matches(t)}}function O3(t){return function(e){return e.matches(t)}}var y6=Array.prototype.find;function v6(t){return function(){return y6.call(this.children,t)}}function x6(){return this.firstElementChild}function b6(t){return this.select(t==null?x6:v6(typeof t=="function"?t:O3(t)))}var w6=Array.prototype.filter;function S6(){return Array.from(this.children)}function I6(t){return function(){return w6.call(this.children,t)}}function E6(t){return this.selectAll(t==null?S6:I6(typeof t=="function"?t:O3(t)))}function C6(t){typeof t!="function"&&(t=F3(t));for(var e=this._groups,n=e.length,c=new Array(n),g=0;g<n;++g)for(var v=e[g],S=v.length,a=c[g]=[],N,$=0;$<S;++$)(N=v[$])&&t.call(N,N.__data__,$,v)&&a.push(N);return new gh(c,this._parents)}function N3(t){return new Array(t.length)}function T6(){return new gh(this._enter||this._groups.map(N3),this._parents)}function S_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}S_.prototype={constructor:S_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function k6(t){return function(){return t}}function M6(t,e,n,c,g,v){for(var S=0,a,N=e.length,$=v.length;S<$;++S)(a=e[S])?(a.__data__=v[S],c[S]=a):n[S]=new S_(t,v[S]);for(;S<N;++S)(a=e[S])&&(g[S]=a)}function P6(t,e,n,c,g,v,S){var a,N,$=new Map,he=e.length,oe=v.length,ce=new Array(he),_e;for(a=0;a<he;++a)(N=e[a])&&(ce[a]=_e=S.call(N,N.__data__,a,e)+"",$.has(_e)?g[a]=N:$.set(_e,N));for(a=0;a<oe;++a)_e=S.call(t,v[a],a,v)+"",(N=$.get(_e))?(c[a]=N,N.__data__=v[a],$.delete(_e)):n[a]=new S_(t,v[a]);for(a=0;a<he;++a)(N=e[a])&&$.get(ce[a])===N&&(g[a]=N)}function D6(t){return t.__data__}function L6(t,e){if(!arguments.length)return Array.from(this,D6);var n=e?P6:M6,c=this._parents,g=this._groups;typeof t!="function"&&(t=k6(t));for(var v=g.length,S=new Array(v),a=new Array(v),N=new Array(v),$=0;$<v;++$){var he=c[$],oe=g[$],ce=oe.length,_e=B6(t.call(he,he&&he.__data__,$,c)),Ze=_e.length,nt=a[$]=new Array(Ze),Ke=S[$]=new Array(Ze),st=N[$]=new Array(ce);n(he,oe,nt,Ke,st,_e,e);for(var ht=0,xt=0,zt,Mt;ht<Ze;++ht)if(zt=nt[ht]){for(ht>=xt&&(xt=ht+1);!(Mt=Ke[xt])&&++xt<Ze;);zt._next=Mt||null}}return S=new gh(S,c),S._enter=a,S._exit=N,S}function B6(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function z6(){return new gh(this._exit||this._groups.map(N3),this._parents)}function R6(t,e,n){var c=this.enter(),g=this,v=this.exit();return typeof t=="function"?(c=t(c),c&&(c=c.selection())):c=c.append(t+""),e!=null&&(g=e(g),g&&(g=g.selection())),n==null?v.remove():n(v),c&&g?c.merge(g).order():g}function F6(t){for(var e=t.selection?t.selection():t,n=this._groups,c=e._groups,g=n.length,v=c.length,S=Math.min(g,v),a=new Array(g),N=0;N<S;++N)for(var $=n[N],he=c[N],oe=$.length,ce=a[N]=new Array(oe),_e,Ze=0;Ze<oe;++Ze)(_e=$[Ze]||he[Ze])&&(ce[Ze]=_e);for(;N<g;++N)a[N]=n[N];return new gh(a,this._parents)}function O6(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var c=t[e],g=c.length-1,v=c[g],S;--g>=0;)(S=c[g])&&(v&&S.compareDocumentPosition(v)^4&&v.parentNode.insertBefore(S,v),v=S);return this}function N6(t){t||(t=V6);function e(oe,ce){return oe&&ce?t(oe.__data__,ce.__data__):!oe-!ce}for(var n=this._groups,c=n.length,g=new Array(c),v=0;v<c;++v){for(var S=n[v],a=S.length,N=g[v]=new Array(a),$,he=0;he<a;++he)($=S[he])&&(N[he]=$);N.sort(e)}return new gh(g,this._parents).order()}function V6(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function U6(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function G6(){return Array.from(this)}function q6(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var c=t[e],g=0,v=c.length;g<v;++g){var S=c[g];if(S)return S}return null}function H6(){let t=0;for(const e of this)++t;return t}function j6(){return!this.node()}function Z6(t){for(var e=this._groups,n=0,c=e.length;n<c;++n)for(var g=e[n],v=0,S=g.length,a;v<S;++v)(a=g[v])&&t.call(a,a.__data__,v,g);return this}function Q6(t){return function(){this.removeAttribute(t)}}function W6(t){return function(){this.removeAttributeNS(t.space,t.local)}}function $6(t,e){return function(){this.setAttribute(t,e)}}function X6(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Y6(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function K6(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function J6(t,e){var n=i1(t);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((e==null?n.local?W6:Q6:typeof e=="function"?n.local?K6:Y6:n.local?X6:$6)(n,e))}function V3(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ek(t){return function(){this.style.removeProperty(t)}}function tk(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ik(t,e,n){return function(){var c=e.apply(this,arguments);c==null?this.style.removeProperty(t):this.style.setProperty(t,c,n)}}function nk(t,e,n){return arguments.length>1?this.each((e==null?ek:typeof e=="function"?ik:tk)(t,e,n??"")):vm(this.node(),t)}function vm(t,e){return t.style.getPropertyValue(e)||V3(t).getComputedStyle(t,null).getPropertyValue(e)}function rk(t){return function(){delete this[t]}}function sk(t,e){return function(){this[t]=e}}function ak(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ok(t,e){return arguments.length>1?this.each((e==null?rk:typeof e=="function"?ak:sk)(t,e)):this.node()[t]}function U3(t){return t.trim().split(/^|\s+/)}function Uv(t){return t.classList||new G3(t)}function G3(t){this._node=t,this._names=U3(t.getAttribute("class")||"")}G3.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function q3(t,e){for(var n=Uv(t),c=-1,g=e.length;++c<g;)n.add(e[c])}function H3(t,e){for(var n=Uv(t),c=-1,g=e.length;++c<g;)n.remove(e[c])}function lk(t){return function(){q3(this,t)}}function uk(t){return function(){H3(this,t)}}function ck(t,e){return function(){(e.apply(this,arguments)?q3:H3)(this,t)}}function hk(t,e){var n=U3(t+"");if(arguments.length<2){for(var c=Uv(this.node()),g=-1,v=n.length;++g<v;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof e=="function"?ck:e?lk:uk)(n,e))}function Ak(){this.textContent=""}function fk(t){return function(){this.textContent=t}}function dk(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function pk(t){return arguments.length?this.each(t==null?Ak:(typeof t=="function"?dk:fk)(t)):this.node().textContent}function mk(){this.innerHTML=""}function gk(t){return function(){this.innerHTML=t}}function _k(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function yk(t){return arguments.length?this.each(t==null?mk:(typeof t=="function"?_k:gk)(t)):this.node().innerHTML}function vk(){this.nextSibling&&this.parentNode.appendChild(this)}function xk(){return this.each(vk)}function bk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wk(){return this.each(bk)}function Sk(t){var e=typeof t=="function"?t:z3(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ik(){return null}function Ek(t,e){var n=typeof t=="function"?t:z3(t),c=e==null?Ik:typeof e=="function"?e:Vv(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function Ck(){var t=this.parentNode;t&&t.removeChild(this)}function Tk(){return this.each(Ck)}function kk(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Mk(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Pk(t){return this.select(t?Mk:kk)}function Dk(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Lk(t){return function(e){t.call(this,e,this.__data__)}}function Bk(t){return t.trim().split(/^|\s+/).map(function(e){var n="",c=e.indexOf(".");return c>=0&&(n=e.slice(c+1),e=e.slice(0,c)),{type:e,name:n}})}function zk(t){return function(){var e=this.__on;if(e){for(var n=0,c=-1,g=e.length,v;n<g;++n)v=e[n],(!t.type||v.type===t.type)&&v.name===t.name?this.removeEventListener(v.type,v.listener,v.options):e[++c]=v;++c?e.length=c:delete this.__on}}}function Rk(t,e,n){return function(){var c=this.__on,g,v=Lk(e);if(c){for(var S=0,a=c.length;S<a;++S)if((g=c[S]).type===t.type&&g.name===t.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=v,g.options=n),g.value=e;return}}this.addEventListener(t.type,v,n),g={type:t.type,name:t.name,value:e,listener:v,options:n},c?c.push(g):this.__on=[g]}}function Fk(t,e,n){var c=Bk(t+""),g,v=c.length,S;if(arguments.length<2){var a=this.node().__on;if(a){for(var N=0,$=a.length,he;N<$;++N)for(g=0,he=a[N];g<v;++g)if((S=c[g]).type===he.type&&S.name===he.name)return he.value}return}for(a=e?Rk:zk,g=0;g<v;++g)this.each(a(c[g],e,n));return this}function j3(t,e,n){var c=V3(t),g=c.CustomEvent;typeof g=="function"?g=new g(e,n):(g=c.document.createEvent("Event"),n?(g.initEvent(e,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(e,!1,!1)),t.dispatchEvent(g)}function Ok(t,e){return function(){return j3(this,t,e)}}function Nk(t,e){return function(){return j3(this,t,e.apply(this,arguments))}}function Vk(t,e){return this.each((typeof e=="function"?Nk:Ok)(t,e))}function*Uk(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var c=t[e],g=0,v=c.length,S;g<v;++g)(S=c[g])&&(yield S)}var Z3=[null];function gh(t,e){this._groups=t,this._parents=e}function zg(){return new gh([[document.documentElement]],Z3)}function Gk(){return this}gh.prototype=zg.prototype={constructor:gh,select:d6,selectAll:_6,selectChild:b6,selectChildren:E6,filter:C6,data:L6,enter:T6,exit:z6,join:R6,merge:F6,selection:Gk,order:O6,sort:N6,call:U6,nodes:G6,node:q6,size:H6,empty:j6,each:Z6,attr:J6,style:nk,property:ok,classed:hk,text:pk,html:yk,raise:xk,lower:wk,append:Sk,insert:Ek,remove:Tk,clone:Pk,datum:Dk,on:Fk,dispatch:Vk,[Symbol.iterator]:Uk};function l_(t){return typeof t=="string"?new gh([[document.querySelector(t)]],[document.documentElement]):new gh([[t]],Z3)}function Gv(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Q3(t,e){var n=Object.create(t.prototype);for(var c in e)n[c]=e[c];return n}function Rg(){}var xg=.7,I_=1/xg,mm="\\s*([+-]?\\d+)\\s*",bg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qk=/^#([0-9a-f]{3,8})$/,Hk=new RegExp(`^rgb\\(${mm},${mm},${mm}\\)$`),jk=new RegExp(`^rgb\\(${nf},${nf},${nf}\\)$`),Zk=new RegExp(`^rgba\\(${mm},${mm},${mm},${bg}\\)$`),Qk=new RegExp(`^rgba\\(${nf},${nf},${nf},${bg}\\)$`),Wk=new RegExp(`^hsl\\(${bg},${nf},${nf}\\)$`),$k=new RegExp(`^hsla\\(${bg},${nf},${nf},${bg}\\)$`),Rx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gv(Rg,lp,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Fx,formatHex:Fx,formatHex8:Xk,formatHsl:Yk,formatRgb:Ox,toString:Ox});function Fx(){return this.rgb().formatHex()}function Xk(){return this.rgb().formatHex8()}function Yk(){return W3(this).formatHsl()}function Ox(){return this.rgb().formatRgb()}function lp(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=qk.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Nx(e):n===3?new qc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?$g(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?$g(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Hk.exec(t))?new qc(e[1],e[2],e[3],1):(e=jk.exec(t))?new qc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Zk.exec(t))?$g(e[1],e[2],e[3],e[4]):(e=Qk.exec(t))?$g(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Wk.exec(t))?Gx(e[1],e[2]/100,e[3]/100,1):(e=$k.exec(t))?Gx(e[1],e[2]/100,e[3]/100,e[4]):Rx.hasOwnProperty(t)?Nx(Rx[t]):t==="transparent"?new qc(NaN,NaN,NaN,0):null}function Nx(t){return new qc(t>>16&255,t>>8&255,t&255,1)}function $g(t,e,n,c){return c<=0&&(t=e=n=NaN),new qc(t,e,n,c)}function Kk(t){return t instanceof Rg||(t=lp(t)),t?(t=t.rgb(),new qc(t.r,t.g,t.b,t.opacity)):new qc}function Hy(t,e,n,c){return arguments.length===1?Kk(t):new qc(t,e,n,c??1)}function qc(t,e,n,c){this.r=+t,this.g=+e,this.b=+n,this.opacity=+c}Gv(qc,Hy,Q3(Rg,{brighter(t){return t=t==null?I_:Math.pow(I_,t),new qc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?xg:Math.pow(xg,t),new qc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new qc(np(this.r),np(this.g),np(this.b),E_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Vx,formatHex:Vx,formatHex8:Jk,formatRgb:Ux,toString:Ux}));function Vx(){return`#${Jd(this.r)}${Jd(this.g)}${Jd(this.b)}`}function Jk(){return`#${Jd(this.r)}${Jd(this.g)}${Jd(this.b)}${Jd((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ux(){const t=E_(this.opacity);return`${t===1?"rgb(":"rgba("}${np(this.r)}, ${np(this.g)}, ${np(this.b)}${t===1?")":`, ${t})`}`}function E_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function np(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jd(t){return t=np(t),(t<16?"0":"")+t.toString(16)}function Gx(t,e,n,c){return c<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new fA(t,e,n,c)}function W3(t){if(t instanceof fA)return new fA(t.h,t.s,t.l,t.opacity);if(t instanceof Rg||(t=lp(t)),!t)return new fA;if(t instanceof fA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,c=t.b/255,g=Math.min(e,n,c),v=Math.max(e,n,c),S=NaN,a=v-g,N=(v+g)/2;return a?(e===v?S=(n-c)/a+(n<c)*6:n===v?S=(c-e)/a+2:S=(e-n)/a+4,a/=N<.5?v+g:2-v-g,S*=60):a=N>0&&N<1?0:S,new fA(S,a,N,t.opacity)}function e8(t,e,n,c){return arguments.length===1?W3(t):new fA(t,e,n,c??1)}function fA(t,e,n,c){this.h=+t,this.s=+e,this.l=+n,this.opacity=+c}Gv(fA,e8,Q3(Rg,{brighter(t){return t=t==null?I_:Math.pow(I_,t),new fA(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?xg:Math.pow(xg,t),new fA(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*e,g=2*n-c;return new qc(G1(t>=240?t-240:t+120,g,c),G1(t,g,c),G1(t<120?t+240:t-120,g,c),this.opacity)},clamp(){return new fA(qx(this.h),Xg(this.s),Xg(this.l),E_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=E_(this.opacity);return`${t===1?"hsl(":"hsla("}${qx(this.h)}, ${Xg(this.s)*100}%, ${Xg(this.l)*100}%${t===1?")":`, ${t})`}`}}));function qx(t){return t=(t||0)%360,t<0?t+360:t}function Xg(t){return Math.max(0,Math.min(1,t||0))}function G1(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const qv=t=>()=>t;function t8(t,e){return function(n){return t+n*e}}function i8(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(c){return Math.pow(t+c*e,n)}}function n8(t){return(t=+t)==1?$3:function(e,n){return n-e?i8(e,n,t):qv(isNaN(e)?n:e)}}function $3(t,e){var n=e-t;return n?t8(t,n):qv(isNaN(t)?e:t)}const C_=function t(e){var n=n8(e);function c(g,v){var S=n((g=Hy(g)).r,(v=Hy(v)).r),a=n(g.g,v.g),N=n(g.b,v.b),$=$3(g.opacity,v.opacity);return function(he){return g.r=S(he),g.g=a(he),g.b=N(he),g.opacity=$(he),g+""}}return c.gamma=t,c}(1);function r8(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,c=e.slice(),g;return function(v){for(g=0;g<n;++g)c[g]=t[g]*(1-v)+e[g]*v;return c}}function s8(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function a8(t,e){var n=e?e.length:0,c=t?Math.min(n,t.length):0,g=new Array(c),v=new Array(n),S;for(S=0;S<c;++S)g[S]=Hv(t[S],e[S]);for(;S<n;++S)v[S]=e[S];return function(a){for(S=0;S<c;++S)v[S]=g[S](a);return v}}function o8(t,e){var n=new Date;return t=+t,e=+e,function(c){return n.setTime(t*(1-c)+e*c),n}}function hA(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function l8(t,e){var n={},c={},g;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(g in e)g in t?n[g]=Hv(t[g],e[g]):c[g]=e[g];return function(v){for(g in n)c[g]=n[g](v);return c}}var jy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,q1=new RegExp(jy.source,"g");function u8(t){return function(){return t}}function c8(t){return function(e){return t(e)+""}}function X3(t,e){var n=jy.lastIndex=q1.lastIndex=0,c,g,v,S=-1,a=[],N=[];for(t=t+"",e=e+"";(c=jy.exec(t))&&(g=q1.exec(e));)(v=g.index)>n&&(v=e.slice(n,v),a[S]?a[S]+=v:a[++S]=v),(c=c[0])===(g=g[0])?a[S]?a[S]+=g:a[++S]=g:(a[++S]=null,N.push({i:S,x:hA(c,g)})),n=q1.lastIndex;return n<e.length&&(v=e.slice(n),a[S]?a[S]+=v:a[++S]=v),a.length<2?N[0]?c8(N[0].x):u8(e):(e=N.length,function($){for(var he=0,oe;he<e;++he)a[(oe=N[he]).i]=oe.x($);return a.join("")})}function Hv(t,e){var n=typeof e,c;return e==null||n==="boolean"?qv(e):(n==="number"?hA:n==="string"?(c=lp(e))?(e=c,C_):X3:e instanceof lp?C_:e instanceof Date?o8:s8(e)?r8:Array.isArray(e)?a8:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?l8:hA)(t,e)}function h8(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Hx=180/Math.PI,Zy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Y3(t,e,n,c,g,v){var S,a,N;return(S=Math.sqrt(t*t+e*e))&&(t/=S,e/=S),(N=t*n+e*c)&&(n-=t*N,c-=e*N),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,N/=a),t*c<e*n&&(t=-t,e=-e,N=-N,S=-S),{translateX:g,translateY:v,rotate:Math.atan2(e,t)*Hx,skewX:Math.atan(N)*Hx,scaleX:S,scaleY:a}}var Yg;function A8(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Zy:Y3(e.a,e.b,e.c,e.d,e.e,e.f)}function f8(t){return t==null||(Yg||(Yg=document.createElementNS("http://www.w3.org/2000/svg","g")),Yg.setAttribute("transform",t),!(t=Yg.transform.baseVal.consolidate()))?Zy:(t=t.matrix,Y3(t.a,t.b,t.c,t.d,t.e,t.f))}function K3(t,e,n,c){function g($){return $.length?$.pop()+" ":""}function v($,he,oe,ce,_e,Ze){if($!==oe||he!==ce){var nt=_e.push("translate(",null,e,null,n);Ze.push({i:nt-4,x:hA($,oe)},{i:nt-2,x:hA(he,ce)})}else(oe||ce)&&_e.push("translate("+oe+e+ce+n)}function S($,he,oe,ce){$!==he?($-he>180?he+=360:he-$>180&&($+=360),ce.push({i:oe.push(g(oe)+"rotate(",null,c)-2,x:hA($,he)})):he&&oe.push(g(oe)+"rotate("+he+c)}function a($,he,oe,ce){$!==he?ce.push({i:oe.push(g(oe)+"skewX(",null,c)-2,x:hA($,he)}):he&&oe.push(g(oe)+"skewX("+he+c)}function N($,he,oe,ce,_e,Ze){if($!==oe||he!==ce){var nt=_e.push(g(_e)+"scale(",null,",",null,")");Ze.push({i:nt-4,x:hA($,oe)},{i:nt-2,x:hA(he,ce)})}else(oe!==1||ce!==1)&&_e.push(g(_e)+"scale("+oe+","+ce+")")}return function($,he){var oe=[],ce=[];return $=t($),he=t(he),v($.translateX,$.translateY,he.translateX,he.translateY,oe,ce),S($.rotate,he.rotate,oe,ce),a($.skewX,he.skewX,oe,ce),N($.scaleX,$.scaleY,he.scaleX,he.scaleY,oe,ce),$=he=null,function(_e){for(var Ze=-1,nt=ce.length,Ke;++Ze<nt;)oe[(Ke=ce[Ze]).i]=Ke.x(_e);return oe.join("")}}}var d8=K3(A8,"px, ","px)","deg)"),p8=K3(f8,", ",")",")"),xm=0,Ag=0,Km=0,J3=1e3,T_,fg,k_=0,up=0,n1=0,wg=typeof performance=="object"&&performance.now?performance:Date,e4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function jv(){return up||(e4(m8),up=wg.now()+n1)}function m8(){up=0}function M_(){this._call=this._time=this._next=null}M_.prototype=t4.prototype={constructor:M_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?jv():+n)+(e==null?0:+e),!this._next&&fg!==this&&(fg?fg._next=this:T_=this,fg=this),this._call=t,this._time=n,Qy()},stop:function(){this._call&&(this._call=null,this._time=1/0,Qy())}};function t4(t,e,n){var c=new M_;return c.restart(t,e,n),c}function g8(){jv(),++xm;for(var t=T_,e;t;)(e=up-t._time)>=0&&t._call.call(void 0,e),t=t._next;--xm}function jx(){up=(k_=wg.now())+n1,xm=Ag=0;try{g8()}finally{xm=0,y8(),up=0}}function _8(){var t=wg.now(),e=t-k_;e>J3&&(n1-=e,k_=t)}function y8(){for(var t,e=T_,n,c=1/0;e;)e._call?(c>e._time&&(c=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:T_=n);fg=t,Qy(c)}function Qy(t){if(!xm){Ag&&(Ag=clearTimeout(Ag));var e=t-up;e>24?(t<1/0&&(Ag=setTimeout(jx,t-wg.now()-n1)),Km&&(Km=clearInterval(Km))):(Km||(k_=wg.now(),Km=setInterval(_8,J3)),xm=1,e4(jx))}}function Zx(t,e,n){var c=new M_;return e=e==null?0:+e,c.restart(g=>{c.stop(),t(g+e)},e,n),c}var v8=B3("start","end","cancel","interrupt"),x8=[],i4=0,Qx=1,Wy=2,u_=3,Wx=4,$y=5,c_=6;function r1(t,e,n,c,g,v){var S=t.__transition;if(!S)t.__transition={};else if(n in S)return;b8(t,n,{name:e,index:c,group:g,on:v8,tween:x8,time:v.time,delay:v.delay,duration:v.duration,ease:v.ease,timer:null,state:i4})}function Zv(t,e){var n=pA(t,e);if(n.state>i4)throw new Error("too late; already scheduled");return n}function cf(t,e){var n=pA(t,e);if(n.state>u_)throw new Error("too late; already running");return n}function pA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function b8(t,e,n){var c=t.__transition,g;c[e]=n,n.timer=t4(v,0,n.time);function v($){n.state=Qx,n.timer.restart(S,n.delay,n.time),n.delay<=$&&S($-n.delay)}function S($){var he,oe,ce,_e;if(n.state!==Qx)return N();for(he in c)if(_e=c[he],_e.name===n.name){if(_e.state===u_)return Zx(S);_e.state===Wx?(_e.state=c_,_e.timer.stop(),_e.on.call("interrupt",t,t.__data__,_e.index,_e.group),delete c[he]):+he<e&&(_e.state=c_,_e.timer.stop(),_e.on.call("cancel",t,t.__data__,_e.index,_e.group),delete c[he])}if(Zx(function(){n.state===u_&&(n.state=Wx,n.timer.restart(a,n.delay,n.time),a($))}),n.state=Wy,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Wy){for(n.state=u_,g=new Array(ce=n.tween.length),he=0,oe=-1;he<ce;++he)(_e=n.tween[he].value.call(t,t.__data__,n.index,n.group))&&(g[++oe]=_e);g.length=oe+1}}function a($){for(var he=$<n.duration?n.ease.call(null,$/n.duration):(n.timer.restart(N),n.state=$y,1),oe=-1,ce=g.length;++oe<ce;)g[oe].call(t,he);n.state===$y&&(n.on.call("end",t,t.__data__,n.index,n.group),N())}function N(){n.state=c_,n.timer.stop(),delete c[e];for(var $ in c)return;delete t.__transition}}function w8(t,e){var n=t.__transition,c,g,v=!0,S;if(n){e=e==null?null:e+"";for(S in n){if((c=n[S]).name!==e){v=!1;continue}g=c.state>Wy&&c.state<$y,c.state=c_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",t,t.__data__,c.index,c.group),delete n[S]}v&&delete t.__transition}}function S8(t){return this.each(function(){w8(this,t)})}function I8(t,e){var n,c;return function(){var g=cf(this,t),v=g.tween;if(v!==n){c=n=v;for(var S=0,a=c.length;S<a;++S)if(c[S].name===e){c=c.slice(),c.splice(S,1);break}}g.tween=c}}function E8(t,e,n){var c,g;if(typeof n!="function")throw new Error;return function(){var v=cf(this,t),S=v.tween;if(S!==c){g=(c=S).slice();for(var a={name:e,value:n},N=0,$=g.length;N<$;++N)if(g[N].name===e){g[N]=a;break}N===$&&g.push(a)}v.tween=g}}function C8(t,e){var n=this._id;if(t+="",arguments.length<2){for(var c=pA(this.node(),n).tween,g=0,v=c.length,S;g<v;++g)if((S=c[g]).name===t)return S.value;return null}return this.each((e==null?I8:E8)(n,t,e))}function Qv(t,e,n){var c=t._id;return t.each(function(){var g=cf(this,c);(g.value||(g.value={}))[e]=n.apply(this,arguments)}),function(g){return pA(g,c).value[e]}}function n4(t,e){var n;return(typeof e=="number"?hA:e instanceof lp?C_:(n=lp(e))?(e=n,C_):X3)(t,e)}function T8(t){return function(){this.removeAttribute(t)}}function k8(t){return function(){this.removeAttributeNS(t.space,t.local)}}function M8(t,e,n){var c,g=n+"",v;return function(){var S=this.getAttribute(t);return S===g?null:S===c?v:v=e(c=S,n)}}function P8(t,e,n){var c,g=n+"",v;return function(){var S=this.getAttributeNS(t.space,t.local);return S===g?null:S===c?v:v=e(c=S,n)}}function D8(t,e,n){var c,g,v;return function(){var S,a=n(this),N;return a==null?void this.removeAttribute(t):(S=this.getAttribute(t),N=a+"",S===N?null:S===c&&N===g?v:(g=N,v=e(c=S,a)))}}function L8(t,e,n){var c,g,v;return function(){var S,a=n(this),N;return a==null?void this.removeAttributeNS(t.space,t.local):(S=this.getAttributeNS(t.space,t.local),N=a+"",S===N?null:S===c&&N===g?v:(g=N,v=e(c=S,a)))}}function B8(t,e){var n=i1(t),c=n==="transform"?p8:n4;return this.attrTween(t,typeof e=="function"?(n.local?L8:D8)(n,c,Qv(this,"attr."+t,e)):e==null?(n.local?k8:T8)(n):(n.local?P8:M8)(n,c,e))}function z8(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function R8(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function F8(t,e){var n,c;function g(){var v=e.apply(this,arguments);return v!==c&&(n=(c=v)&&R8(t,v)),n}return g._value=e,g}function O8(t,e){var n,c;function g(){var v=e.apply(this,arguments);return v!==c&&(n=(c=v)&&z8(t,v)),n}return g._value=e,g}function N8(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var c=i1(t);return this.tween(n,(c.local?F8:O8)(c,e))}function V8(t,e){return function(){Zv(this,t).delay=+e.apply(this,arguments)}}function U8(t,e){return e=+e,function(){Zv(this,t).delay=e}}function G8(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?V8:U8)(e,t)):pA(this.node(),e).delay}function q8(t,e){return function(){cf(this,t).duration=+e.apply(this,arguments)}}function H8(t,e){return e=+e,function(){cf(this,t).duration=e}}function j8(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?q8:H8)(e,t)):pA(this.node(),e).duration}function Z8(t,e){if(typeof e!="function")throw new Error;return function(){cf(this,t).ease=e}}function Q8(t){var e=this._id;return arguments.length?this.each(Z8(e,t)):pA(this.node(),e).ease}function W8(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;cf(this,t).ease=n}}function $8(t){if(typeof t!="function")throw new Error;return this.each(W8(this._id,t))}function X8(t){typeof t!="function"&&(t=F3(t));for(var e=this._groups,n=e.length,c=new Array(n),g=0;g<n;++g)for(var v=e[g],S=v.length,a=c[g]=[],N,$=0;$<S;++$)(N=v[$])&&t.call(N,N.__data__,$,v)&&a.push(N);return new u0(c,this._parents,this._name,this._id)}function Y8(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,c=e.length,g=n.length,v=Math.min(c,g),S=new Array(c),a=0;a<v;++a)for(var N=e[a],$=n[a],he=N.length,oe=S[a]=new Array(he),ce,_e=0;_e<he;++_e)(ce=N[_e]||$[_e])&&(oe[_e]=ce);for(;a<c;++a)S[a]=e[a];return new u0(S,this._parents,this._name,this._id)}function K8(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function J8(t,e,n){var c,g,v=K8(e)?Zv:cf;return function(){var S=v(this,t),a=S.on;a!==c&&(g=(c=a).copy()).on(e,n),S.on=g}}function eM(t,e){var n=this._id;return arguments.length<2?pA(this.node(),n).on.on(t):this.each(J8(n,t,e))}function tM(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function iM(){return this.on("end.remove",tM(this._id))}function nM(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Vv(t));for(var c=this._groups,g=c.length,v=new Array(g),S=0;S<g;++S)for(var a=c[S],N=a.length,$=v[S]=new Array(N),he,oe,ce=0;ce<N;++ce)(he=a[ce])&&(oe=t.call(he,he.__data__,ce,a))&&("__data__"in he&&(oe.__data__=he.__data__),$[ce]=oe,r1($[ce],e,n,ce,$,pA(he,n)));return new u0(v,this._parents,e,n)}function rM(t){var e=this._name,n=this._id;typeof t!="function"&&(t=R3(t));for(var c=this._groups,g=c.length,v=[],S=[],a=0;a<g;++a)for(var N=c[a],$=N.length,he,oe=0;oe<$;++oe)if(he=N[oe]){for(var ce=t.call(he,he.__data__,oe,N),_e,Ze=pA(he,n),nt=0,Ke=ce.length;nt<Ke;++nt)(_e=ce[nt])&&r1(_e,e,n,nt,ce,Ze);v.push(ce),S.push(he)}return new u0(v,S,e,n)}var sM=zg.prototype.constructor;function aM(){return new sM(this._groups,this._parents)}function oM(t,e){var n,c,g;return function(){var v=vm(this,t),S=(this.style.removeProperty(t),vm(this,t));return v===S?null:v===n&&S===c?g:g=e(n=v,c=S)}}function r4(t){return function(){this.style.removeProperty(t)}}function lM(t,e,n){var c,g=n+"",v;return function(){var S=vm(this,t);return S===g?null:S===c?v:v=e(c=S,n)}}function uM(t,e,n){var c,g,v;return function(){var S=vm(this,t),a=n(this),N=a+"";return a==null&&(N=a=(this.style.removeProperty(t),vm(this,t))),S===N?null:S===c&&N===g?v:(g=N,v=e(c=S,a))}}function cM(t,e){var n,c,g,v="style."+e,S="end."+v,a;return function(){var N=cf(this,t),$=N.on,he=N.value[v]==null?a||(a=r4(e)):void 0;($!==n||g!==he)&&(c=(n=$).copy()).on(S,g=he),N.on=c}}function hM(t,e,n){var c=(t+="")=="transform"?d8:n4;return e==null?this.styleTween(t,oM(t,c)).on("end.style."+t,r4(t)):typeof e=="function"?this.styleTween(t,uM(t,c,Qv(this,"style."+t,e))).each(cM(this._id,t)):this.styleTween(t,lM(t,c,e),n).on("end.style."+t,null)}function AM(t,e,n){return function(c){this.style.setProperty(t,e.call(this,c),n)}}function fM(t,e,n){var c,g;function v(){var S=e.apply(this,arguments);return S!==g&&(c=(g=S)&&AM(t,S,n)),c}return v._value=e,v}function dM(t,e,n){var c="style."+(t+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(e==null)return this.tween(c,null);if(typeof e!="function")throw new Error;return this.tween(c,fM(t,e,n??""))}function pM(t){return function(){this.textContent=t}}function mM(t){return function(){var e=t(this);this.textContent=e??""}}function gM(t){return this.tween("text",typeof t=="function"?mM(Qv(this,"text",t)):pM(t==null?"":t+""))}function _M(t){return function(e){this.textContent=t.call(this,e)}}function yM(t){var e,n;function c(){var g=t.apply(this,arguments);return g!==n&&(e=(n=g)&&_M(g)),e}return c._value=t,c}function vM(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,yM(t))}function xM(){for(var t=this._name,e=this._id,n=s4(),c=this._groups,g=c.length,v=0;v<g;++v)for(var S=c[v],a=S.length,N,$=0;$<a;++$)if(N=S[$]){var he=pA(N,e);r1(N,t,n,$,S,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new u0(c,this._parents,t,n)}function bM(){var t,e,n=this,c=n._id,g=n.size();return new Promise(function(v,S){var a={value:S},N={value:function(){--g===0&&v()}};n.each(function(){var $=cf(this,c),he=$.on;he!==t&&(e=(t=he).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(N)),$.on=e}),g===0&&v()})}var wM=0;function u0(t,e,n,c){this._groups=t,this._parents=e,this._name=n,this._id=c}function s4(){return++wM}var Jf=zg.prototype;u0.prototype={constructor:u0,select:nM,selectAll:rM,selectChild:Jf.selectChild,selectChildren:Jf.selectChildren,filter:X8,merge:Y8,selection:aM,transition:xM,call:Jf.call,nodes:Jf.nodes,node:Jf.node,size:Jf.size,empty:Jf.empty,each:Jf.each,on:eM,attr:B8,attrTween:N8,style:hM,styleTween:dM,text:gM,textTween:vM,remove:iM,tween:C8,delay:G8,duration:j8,ease:Q8,easeVarying:$8,end:bM,[Symbol.iterator]:Jf[Symbol.iterator]};function SM(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var IM={time:null,delay:0,duration:250,ease:SM};function EM(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function CM(t){var e,n;t instanceof u0?(e=t._id,t=t._name):(e=s4(),(n=IM).time=jv(),t=t==null?null:t+"");for(var c=this._groups,g=c.length,v=0;v<g;++v)for(var S=c[v],a=S.length,N,$=0;$<a;++$)(N=S[$])&&r1(N,t,e,$,S,n||EM(N,e));return new u0(c,this._parents,t,e)}zg.prototype.interrupt=S8;zg.prototype.transition=CM;const Xy=Math.PI,Yy=2*Xy,Yd=1e-6,TM=Yy-Yd;function a4(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function kM(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return a4;const n=10**e;return function(c){this._+=c[0];for(let g=1,v=c.length;g<v;++g)this._+=Math.round(arguments[g]*n)/n+c[g]}}let MM=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?a4:kM(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,c,g){this._append`Q${+e},${+n},${this._x1=+c},${this._y1=+g}`}bezierCurveTo(e,n,c,g,v,S){this._append`C${+e},${+n},${+c},${+g},${this._x1=+v},${this._y1=+S}`}arcTo(e,n,c,g,v){if(e=+e,n=+n,c=+c,g=+g,v=+v,v<0)throw new Error(`negative radius: ${v}`);let S=this._x1,a=this._y1,N=c-e,$=g-n,he=S-e,oe=a-n,ce=he*he+oe*oe;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(ce>Yd)if(!(Math.abs(oe*N-$*he)>Yd)||!v)this._append`L${this._x1=e},${this._y1=n}`;else{let _e=c-S,Ze=g-a,nt=N*N+$*$,Ke=_e*_e+Ze*Ze,st=Math.sqrt(nt),ht=Math.sqrt(ce),xt=v*Math.tan((Xy-Math.acos((nt+ce-Ke)/(2*st*ht)))/2),zt=xt/ht,Mt=xt/st;Math.abs(zt-1)>Yd&&this._append`L${e+zt*he},${n+zt*oe}`,this._append`A${v},${v},0,0,${+(oe*_e>he*Ze)},${this._x1=e+Mt*N},${this._y1=n+Mt*$}`}}arc(e,n,c,g,v,S){if(e=+e,n=+n,c=+c,S=!!S,c<0)throw new Error(`negative radius: ${c}`);let a=c*Math.cos(g),N=c*Math.sin(g),$=e+a,he=n+N,oe=1^S,ce=S?g-v:v-g;this._x1===null?this._append`M${$},${he}`:(Math.abs(this._x1-$)>Yd||Math.abs(this._y1-he)>Yd)&&this._append`L${$},${he}`,c&&(ce<0&&(ce=ce%Yy+Yy),ce>TM?this._append`A${c},${c},0,1,${oe},${e-a},${n-N}A${c},${c},0,1,${oe},${this._x1=$},${this._y1=he}`:ce>Yd&&this._append`A${c},${c},0,${+(ce>=Xy)},${oe},${this._x1=e+c*Math.cos(v)},${this._y1=n+c*Math.sin(v)}`)}rect(e,n,c,g){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${c=+c}v${+g}h${-c}Z`}toString(){return this._}};function PM(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function P_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,c=t.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+t.slice(n+1)]}function bm(t){return t=P_(Math.abs(t)),t?t[1]:NaN}function DM(t,e){return function(n,c){for(var g=n.length,v=[],S=0,a=t[0],N=0;g>0&&a>0&&(N+a+1>c&&(a=Math.max(1,c-N)),v.push(n.substring(g-=a,g+a)),!((N+=a+1)>c));)a=t[S=(S+1)%t.length];return v.reverse().join(e)}}function LM(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var BM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function D_(t){if(!(e=BM.exec(t)))throw new Error("invalid format: "+t);var e;return new Wv({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}D_.prototype=Wv.prototype;function Wv(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Wv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zM(t){e:for(var e=t.length,n=1,c=-1,g;n<e;++n)switch(t[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+t[n])break e;c>0&&(c=0);break}return c>0?t.slice(0,c)+t.slice(g+1):t}var o4;function RM(t,e){var n=P_(t,e);if(!n)return t+"";var c=n[0],g=n[1],v=g-(o4=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,S=c.length;return v===S?c:v>S?c+new Array(v-S+1).join("0"):v>0?c.slice(0,v)+"."+c.slice(v):"0."+new Array(1-v).join("0")+P_(t,Math.max(0,e+v-1))[0]}function $x(t,e){var n=P_(t,e);if(!n)return t+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const Xx={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:PM,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>$x(t*100,e),r:$x,s:RM,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Yx(t){return t}var Kx=Array.prototype.map,Jx=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function FM(t){var e=t.grouping===void 0||t.thousands===void 0?Yx:DM(Kx.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",c=t.currency===void 0?"":t.currency[1]+"",g=t.decimal===void 0?".":t.decimal+"",v=t.numerals===void 0?Yx:LM(Kx.call(t.numerals,String)),S=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",N=t.nan===void 0?"NaN":t.nan+"";function $(oe){oe=D_(oe);var ce=oe.fill,_e=oe.align,Ze=oe.sign,nt=oe.symbol,Ke=oe.zero,st=oe.width,ht=oe.comma,xt=oe.precision,zt=oe.trim,Mt=oe.type;Mt==="n"?(ht=!0,Mt="g"):Xx[Mt]||(xt===void 0&&(xt=12),zt=!0,Mt="g"),(Ke||ce==="0"&&_e==="=")&&(Ke=!0,ce="0",_e="=");var Ue=nt==="$"?n:nt==="#"&&/[boxX]/.test(Mt)?"0"+Mt.toLowerCase():"",$t=nt==="$"?c:/[%p]/.test(Mt)?S:"",rt=Xx[Mt],gt=/[defgprs%]/.test(Mt);xt=xt===void 0?6:/[gprs]/.test(Mt)?Math.max(1,Math.min(21,xt)):Math.max(0,Math.min(20,xt));function At(yt){var St=Ue,ut=$t,Ye,_t,ct;if(Mt==="c")ut=rt(yt)+ut,yt="";else{yt=+yt;var Ut=yt<0||1/yt<0;if(yt=isNaN(yt)?N:rt(Math.abs(yt),xt),zt&&(yt=zM(yt)),Ut&&+yt==0&&Ze!=="+"&&(Ut=!1),St=(Ut?Ze==="("?Ze:a:Ze==="-"||Ze==="("?"":Ze)+St,ut=(Mt==="s"?Jx[8+o4/3]:"")+ut+(Ut&&Ze==="("?")":""),gt){for(Ye=-1,_t=yt.length;++Ye<_t;)if(ct=yt.charCodeAt(Ye),48>ct||ct>57){ut=(ct===46?g+yt.slice(Ye+1):yt.slice(Ye))+ut,yt=yt.slice(0,Ye);break}}}ht&&!Ke&&(yt=e(yt,1/0));var Ft=St.length+yt.length+ut.length,Vt=Ft<st?new Array(st-Ft+1).join(ce):"";switch(ht&&Ke&&(yt=e(Vt+yt,Vt.length?st-ut.length:1/0),Vt=""),_e){case"<":yt=St+yt+ut+Vt;break;case"=":yt=St+Vt+yt+ut;break;case"^":yt=Vt.slice(0,Ft=Vt.length>>1)+St+yt+ut+Vt.slice(Ft);break;default:yt=Vt+St+yt+ut;break}return v(yt)}return At.toString=function(){return oe+""},At}function he(oe,ce){var _e=$((oe=D_(oe),oe.type="f",oe)),Ze=Math.max(-8,Math.min(8,Math.floor(bm(ce)/3)))*3,nt=Math.pow(10,-Ze),Ke=Jx[8+Ze/3];return function(st){return _e(nt*st)+Ke}}return{format:$,formatPrefix:he}}var Kg,l4,u4;OM({thousands:",",grouping:[3],currency:["$",""]});function OM(t){return Kg=FM(t),l4=Kg.format,u4=Kg.formatPrefix,Kg}function NM(t){return Math.max(0,-bm(Math.abs(t)))}function VM(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(bm(e)/3)))*3-bm(Math.abs(t)))}function UM(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,bm(e)-bm(t))+1}function GM(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function qM(t){return function(){return t}}function HM(t){return+t}var eb=[0,1];function lm(t){return t}function Ky(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:qM(isNaN(e)?NaN:.5)}function jM(t,e){var n;return t>e&&(n=t,t=e,e=n),function(c){return Math.max(t,Math.min(e,c))}}function ZM(t,e,n){var c=t[0],g=t[1],v=e[0],S=e[1];return g<c?(c=Ky(g,c),v=n(S,v)):(c=Ky(c,g),v=n(v,S)),function(a){return v(c(a))}}function QM(t,e,n){var c=Math.min(t.length,e.length)-1,g=new Array(c),v=new Array(c),S=-1;for(t[c]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++S<c;)g[S]=Ky(t[S],t[S+1]),v[S]=n(e[S],e[S+1]);return function(a){var N=WT(t,a,1,c)-1;return v[N](g[N](a))}}function WM(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function $M(){var t=eb,e=eb,n=Hv,c,g,v,S=lm,a,N,$;function he(){var ce=Math.min(t.length,e.length);return S!==lm&&(S=jM(t[0],t[ce-1])),a=ce>2?QM:ZM,N=$=null,oe}function oe(ce){return ce==null||isNaN(ce=+ce)?v:(N||(N=a(t.map(c),e,n)))(c(S(ce)))}return oe.invert=function(ce){return S(g(($||($=a(e,t.map(c),hA)))(ce)))},oe.domain=function(ce){return arguments.length?(t=Array.from(ce,HM),he()):t.slice()},oe.range=function(ce){return arguments.length?(e=Array.from(ce),he()):e.slice()},oe.rangeRound=function(ce){return e=Array.from(ce),n=h8,he()},oe.clamp=function(ce){return arguments.length?(S=ce?!0:lm,he()):S!==lm},oe.interpolate=function(ce){return arguments.length?(n=ce,he()):n},oe.unknown=function(ce){return arguments.length?(v=ce,oe):v},function(ce,_e){return c=ce,g=_e,he()}}function XM(){return $M()(lm,lm)}function YM(t,e,n,c){var g=JT(t,e,n),v;switch(c=D_(c??",f"),c.type){case"s":{var S=Math.max(Math.abs(t),Math.abs(e));return c.precision==null&&!isNaN(v=VM(g,S))&&(c.precision=v),u4(c,S)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(v=UM(g,Math.max(Math.abs(t),Math.abs(e))))&&(c.precision=v-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(v=NM(g))&&(c.precision=v-(c.type==="%")*2);break}}return l4(c)}function KM(t){var e=t.domain;return t.ticks=function(n){var c=e();return KT(c[0],c[c.length-1],n??10)},t.tickFormat=function(n,c){var g=e();return YM(g[0],g[g.length-1],n??10,c)},t.nice=function(n){n==null&&(n=10);var c=e(),g=0,v=c.length-1,S=c[g],a=c[v],N,$,he=10;for(a<S&&($=S,S=a,a=$,$=g,g=v,v=$);he-- >0;){if($=Uy(S,a,n),$===N)return c[g]=S,c[v]=a,e(c);if($>0)S=Math.floor(S/$)*$,a=Math.ceil(a/$)*$;else if($<0)S=Math.ceil(S*$)/$,a=Math.floor(a*$)/$;else break;N=$}return t},t}function Jy(){var t=XM();return t.copy=function(){return WM(t,Jy())},GM.apply(t,arguments),KM(t)}function Ru(t){return function(){return t}}function c4(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const c=Math.floor(n);if(!(c>=0))throw new RangeError(`invalid digits: ${n}`);e=c}return t},()=>new MM(e)}function h4(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function A4(t){this._context=t}A4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function f4(t){return new A4(t)}function d4(t){return t[0]}function p4(t){return t[1]}function sm(t,e){var n=Ru(!0),c=null,g=f4,v=null,S=c4(a);t=typeof t=="function"?t:t===void 0?d4:Ru(t),e=typeof e=="function"?e:e===void 0?p4:Ru(e);function a(N){var $,he=(N=h4(N)).length,oe,ce=!1,_e;for(c==null&&(v=g(_e=S())),$=0;$<=he;++$)!($<he&&n(oe=N[$],$,N))===ce&&((ce=!ce)?v.lineStart():v.lineEnd()),ce&&v.point(+t(oe,$,N),+e(oe,$,N));if(_e)return v=null,_e+""||null}return a.x=function(N){return arguments.length?(t=typeof N=="function"?N:Ru(+N),a):t},a.y=function(N){return arguments.length?(e=typeof N=="function"?N:Ru(+N),a):e},a.defined=function(N){return arguments.length?(n=typeof N=="function"?N:Ru(!!N),a):n},a.curve=function(N){return arguments.length?(g=N,c!=null&&(v=g(c)),a):g},a.context=function(N){return arguments.length?(N==null?c=v=null:v=g(c=N),a):c},a}function H1(t,e,n){var c=null,g=Ru(!0),v=null,S=f4,a=null,N=c4($);t=typeof t=="function"?t:t===void 0?d4:Ru(+t),e=typeof e=="function"?e:Ru(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?p4:Ru(+n);function $(oe){var ce,_e,Ze,nt=(oe=h4(oe)).length,Ke,st=!1,ht,xt=new Array(nt),zt=new Array(nt);for(v==null&&(a=S(ht=N())),ce=0;ce<=nt;++ce){if(!(ce<nt&&g(Ke=oe[ce],ce,oe))===st)if(st=!st)_e=ce,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),Ze=ce-1;Ze>=_e;--Ze)a.point(xt[Ze],zt[Ze]);a.lineEnd(),a.areaEnd()}st&&(xt[ce]=+t(Ke,ce,oe),zt[ce]=+e(Ke,ce,oe),a.point(c?+c(Ke,ce,oe):xt[ce],n?+n(Ke,ce,oe):zt[ce]))}if(ht)return a=null,ht+""||null}function he(){return sm().defined(g).curve(S).context(v)}return $.x=function(oe){return arguments.length?(t=typeof oe=="function"?oe:Ru(+oe),c=null,$):t},$.x0=function(oe){return arguments.length?(t=typeof oe=="function"?oe:Ru(+oe),$):t},$.x1=function(oe){return arguments.length?(c=oe==null?null:typeof oe=="function"?oe:Ru(+oe),$):c},$.y=function(oe){return arguments.length?(e=typeof oe=="function"?oe:Ru(+oe),n=null,$):e},$.y0=function(oe){return arguments.length?(e=typeof oe=="function"?oe:Ru(+oe),$):e},$.y1=function(oe){return arguments.length?(n=oe==null?null:typeof oe=="function"?oe:Ru(+oe),$):n},$.lineX0=$.lineY0=function(){return he().x(t).y(e)},$.lineY1=function(){return he().x(t).y(n)},$.lineX1=function(){return he().x(c).y(e)},$.defined=function(oe){return arguments.length?(g=typeof oe=="function"?oe:Ru(!!oe),$):g},$.curve=function(oe){return arguments.length?(S=oe,v!=null&&(a=S(v)),$):S},$.context=function(oe){return arguments.length?(oe==null?v=a=null:a=S(v=oe),$):v},$}function tb(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function m4(t){this._context=t}m4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:tb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tb(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function JM(t){return new m4(t)}function dg(t,e,n){this.k=t,this.x=e,this.y=n}dg.prototype={constructor:dg,scale:function(t){return t===1?this:new dg(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new dg(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};dg.prototype;function ib(t,e,n){const c=t.slice();return c[34]=e[n],c[36]=n,c}function nb(t){let e,n,c=Cx[t[5]]+"",g,v,S,a,N,$,he,oe,ce,_e,Ze,nt,Ke,st,ht,xt,zt,Mt,Ue,$t,rt,gt,At,yt=gu(t[0]),St=[];for(let ut=0;ut<yt.length;ut+=1)St[ut]=rb(ib(t,yt,ut));return{c(){e=Pn("div"),n=Pn("h2"),g=Fs(c),v=Fs(" by tree size"),S=_r(),a=ws("svg"),N=ws("defs"),$=ws("linearGradient"),he=ws("stop"),oe=ws("stop"),ce=ws("stop"),_e=ws("g"),nt=ws("g"),st=ws("path"),xt=ws("g");for(let ut=0;ut<St.length;ut+=1)St[ut].c();zt=ws("text"),Mt=Fs(t[11]),rt=ws("text"),gt=Fs(t[12]),this.h()},l(ut){e=Dn(ut,"DIV",{class:!0});var Ye=rn(e);n=Dn(Ye,"H2",{class:!0});var _t=rn(n);g=Os(_t,c),v=Os(_t," by tree size"),_t.forEach(Ai),S=yr(Ye),a=Ss(Ye,"svg",{id:!0,viewBox:!0,class:!0});var ct=rn(a);N=Ss(ct,"defs",{});var Ut=rn(N);$=Ss(Ut,"linearGradient",{id:!0,x1:!0,x2:!0,y1:!0,y2:!0});var Ft=rn($);he=Ss(Ft,"stop",{class:!0,offset:!0}),rn(he).forEach(Ai),oe=Ss(Ft,"stop",{class:!0,offset:!0}),rn(oe).forEach(Ai),ce=Ss(Ft,"stop",{class:!0,offset:!0}),rn(ce).forEach(Ai),Ft.forEach(Ai),Ut.forEach(Ai),_e=Ss(ct,"g",{class:!0,transform:!0}),rn(_e).forEach(Ai),nt=Ss(ct,"g",{class:!0,transform:!0}),rn(nt).forEach(Ai),st=Ss(ct,"path",{class:!0,fill:!0,stroke:!0,"stroke-width":!0,d:!0}),rn(st).forEach(Ai),xt=Ss(ct,"g",{class:!0,fill:!0,stroke:!0,"stroke-width":!0});var Vt=rn(xt);for(let ki=0;ki<St.length;ki+=1)St[ki].l(Vt);Vt.forEach(Ai),zt=Ss(ct,"text",{class:!0,"text-anchor":!0,x:!0,y:!0});var yi=rn(zt);Mt=Os(yi,t[11]),yi.forEach(Ai),rt=Ss(ct,"text",{class:!0,"text-anchor":!0,transform:!0,x:!0,y:!0});var Ci=rn(rt);gt=Os(Ci,t[12]),Ci.forEach(Ai),ct.forEach(Ai),Ye.forEach(Ai),this.h()},h(){_i(n,"class","svelte-156wt8f"),_i(he,"class","stop1 svelte-156wt8f"),_i(he,"offset","0%"),_i(oe,"class","stop2 svelte-156wt8f"),_i(oe,"offset","50%"),_i(ce,"class","stop3 svelte-156wt8f"),_i(ce,"offset","100%"),_i($,"id","Gradient1"),_i($,"x1","0"),_i($,"x2","0"),_i($,"y1","0"),_i($,"y2","0.2"),_i(_e,"class","scale x svelte-156wt8f"),_i(_e,"transform",Ze="translate(0,"+(t[2]-t[3])+")"),_i(nt,"class","scale y svelte-156wt8f"),_i(nt,"transform",Ke="translate("+t[4]+",0)"),_i(st,"class","area ci svelte-156wt8f"),_i(st,"fill",ym()[300]),_i(st,"stroke","currentColor"),_i(st,"stroke-width","0"),_i(st,"d",ht=t[14](t[10])),_i(xt,"class","point"),_i(xt,"fill",ym[700]),_i(xt,"stroke","currentColor"),_i(xt,"stroke-width","1.5"),_i(zt,"class","axis-label svelte-156wt8f"),_i(zt,"text-anchor","center"),_i(zt,"x",Ue=t[1]/2),_i(zt,"y",$t=t[2]+12),_i(rt,"class","axis-label svelte-156wt8f"),_i(rt,"text-anchor","center"),_i(rt,"transform","rotate(-90)"),_i(rt,"x",t[13]),_i(rt,"y",-10),_i(a,"id","viz"),_i(a,"viewBox",At=`0 0 ${t[1]} ${t[2]}`),_i(a,"class","svelte-156wt8f"),_i(e,"class","graph-container svelte-156wt8f")},m(ut,Ye){yn(ut,e,Ye),Bi(e,n),Bi(n,g),Bi(n,v),Bi(e,S),Bi(e,a),Bi(a,N),Bi(N,$),Bi($,he),Bi($,oe),Bi($,ce),Bi(a,_e),t[21](_e),Bi(a,nt),t[22](nt),Bi(a,st),Bi(a,xt);for(let _t=0;_t<St.length;_t+=1)St[_t]&&St[_t].m(xt,null);Bi(a,zt),Bi(zt,Mt),Bi(a,rt),Bi(rt,gt)},p(ut,Ye){if(Ye[0]&32&&c!==(c=Cx[ut[5]]+"")&&El(g,c),Ye[0]&12&&Ze!==(Ze="translate(0,"+(ut[2]-ut[3])+")")&&_i(_e,"transform",Ze),Ye[0]&16&&Ke!==(Ke="translate("+ut[4]+",0)")&&_i(nt,"transform",Ke),Ye[0]&1024&&ht!==(ht=ut[14](ut[10]))&&_i(st,"d",ht),Ye[0]&769){yt=gu(ut[0]);let _t;for(_t=0;_t<yt.length;_t+=1){const ct=ib(ut,yt,_t);St[_t]?St[_t].p(ct,Ye):(St[_t]=rb(ct),St[_t].c(),St[_t].m(xt,null))}for(;_t<St.length;_t+=1)St[_t].d(1);St.length=yt.length}Ye[0]&2048&&El(Mt,ut[11]),Ye[0]&2&&Ue!==(Ue=ut[1]/2)&&_i(zt,"x",Ue),Ye[0]&4&&$t!==($t=ut[2]+12)&&_i(zt,"y",$t),Ye[0]&4096&&El(gt,ut[12]),Ye[0]&8192&&_i(rt,"x",ut[13]),Ye[0]&6&&At!==(At=`0 0 ${ut[1]} ${ut[2]}`)&&_i(a,"viewBox",At)},d(ut){ut&&Ai(e),t[21](null),t[22](null),dA(St,ut)}}}function rb(t){let e,n,c;return{c(){e=ws("circle"),this.h()},l(g){e=Ss(g,"circle",{key:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),rn(e).forEach(Ai),this.h()},h(){_i(e,"key",t[36]),_i(e,"cx",n=t[8](t[34][0])),_i(e,"cy",c=t[9](t[34][1])),_i(e,"r","5"),_i(e,"fill",ym[700]),_i(e,"class","anim-point svelte-156wt8f")},m(g,v){yn(g,e,v)},p(g,v){v[0]&257&&n!==(n=g[8](g[34][0]))&&_i(e,"cx",n),v[0]&513&&c!==(c=g[9](g[34][1]))&&_i(e,"cy",c)},d(g){g&&Ai(e)}}}function eP(t){let e,n=t[10]&&t[5]&&nb(t);return{c(){n&&n.c(),e=Zr()},l(c){n&&n.l(c),e=Zr()},m(c,g){n&&n.m(c,g),yn(c,e,g)},p(c,g){c[10]&&c[5]?n?n.p(c,g):(n=nb(c),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:Ra,o:Ra,d(c){c&&Ai(e),n&&n.d(c)}}}function tP(t,e,n){let{data:c}=e,{point:g}=e,{width:v=640}=e,{height:S=400}=e,{marginTop:a=20}=e,{marginRight:N=20}=e,{marginBottom:$=30}=e,{marginLeft:he=40}=e,{metric:oe}=e,ce,_e,Ze=null,nt=[0,10],Ke=[0,10],st="",ht="",xt=0,zt,Mt,{colorScheme:Ue}=e,$t;function rt(ut){$t=FT(ut),console.log($t),n(10,Ze=$t.confidence),n(19,nt=$t.yAxis),n(20,Ke=$t.xAxis),n(11,st=$t.xAxisLabel),n(12,ht=$t.yAxisLabel),n(13,xt=gt(ht))}function gt(ut){return console.log("label length:",ut.length),-1*(S/2)-ut.length*2.5}const At=H1().x(ut=>zt(ut.x)).y0(ut=>Mt(Math.max(ut.low,nt[0]))).y1(ut=>Mt(Math.min(ut.high,nt[1])));sm(ut=>zt(ut.x),ut=>Mt(ut.y)),sm(ut=>zt(ut.x),ut=>Mt(ut.low)),sm(ut=>zt(ut.x),ut=>Mt(ut.high)),H1().x(ut=>zt(ut.x)).y0(ut=>Mt(ut.high)).y1(ut=>-1*Mt(nt[1])),H1().x(ut=>zt(ut.x)).y0(ut=>Mt(nt[0])).y1(ut=>Mt(ut.low)),sm(ut=>zt(ut.x),ut=>Mt(ut.y)).curve(JM);function yt(ut){ta[ut?"unshift":"push"](()=>{ce=ut,n(6,ce)})}function St(ut){ta[ut?"unshift":"push"](()=>{_e=ut,n(7,_e)})}return t.$$set=ut=>{"data"in ut&&n(15,c=ut.data),"point"in ut&&n(0,g=ut.point),"width"in ut&&n(1,v=ut.width),"height"in ut&&n(2,S=ut.height),"marginTop"in ut&&n(16,a=ut.marginTop),"marginRight"in ut&&n(17,N=ut.marginRight),"marginBottom"in ut&&n(3,$=ut.marginBottom),"marginLeft"in ut&&n(4,he=ut.marginLeft),"metric"in ut&&n(5,oe=ut.metric),"colorScheme"in ut&&n(18,Ue=ut.colorScheme)},t.$$.update=()=>{t.$$.dirty[0]&262144&&wT(Ue),t.$$.dirty[0]&32&&($t=rt(oe)),t.$$.dirty[0]&1179666&&n(8,zt=Jy(Dx(Ke),[he,v-N])),t.$$.dirty[0]&589836&&n(9,Mt=Jy(Dx(nt),[S-$,a])),t.$$.dirty[0]&768&&sm((ut,Ye)=>zt(Ye),Mt),t.$$.dirty[0]&640&&l_(_e).call(o6(Mt)),t.$$.dirty[0]&320&&l_(ce).call(a6(zt)),t.$$.dirty[0]&6&&l_("svg").append("div").classed("svg-container",!0).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${v} ${S}`).classed("svg-content-responsive",!0),t.$$.dirty[0]&33&&console.log("relative:",OT(oe,g[0][1],g[0][0]))},[g,v,S,$,he,oe,ce,_e,zt,Mt,Ze,st,ht,xt,At,c,a,N,Ue,nt,Ke,yt,St]}class iP extends Ha{constructor(e){super(),ja(this,e,tP,eP,Ca,{data:15,point:0,width:1,height:2,marginTop:16,marginRight:17,marginBottom:3,marginLeft:4,metric:5,colorScheme:18},null,[-1,-1])}}function g4(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function _4(t){let e=t,n=t;t.length===1&&(e=(S,a)=>t(S)-a,n=nP(t));function c(S,a,N,$){for(N==null&&(N=0),$==null&&($=S.length);N<$;){const he=N+$>>>1;n(S[he],a)<0?N=he+1:$=he}return N}function g(S,a,N,$){for(N==null&&(N=0),$==null&&($=S.length);N<$;){const he=N+$>>>1;n(S[he],a)>0?$=he:N=he+1}return N}function v(S,a,N,$){N==null&&(N=0),$==null&&($=S.length);const he=c(S,a,N,$-1);return he>N&&e(S[he-1],a)>-e(S[he],a)?he-1:he}return{left:c,center:v,right:g}}function nP(t){return(e,n)=>g4(t(e),n)}function rP(t){return t===null?NaN:+t}const sP=_4(g4),aP=sP.right;_4(rP).center;var ev=Math.sqrt(50),tv=Math.sqrt(10),iv=Math.sqrt(2);function oP(t,e,n){var c,g=-1,v,S,a;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((c=e<t)&&(v=t,t=e,e=v),(a=y4(t,e,n))===0||!isFinite(a))return[];if(a>0){let N=Math.round(t/a),$=Math.round(e/a);for(N*a<t&&++N,$*a>e&&--$,S=new Array(v=$-N+1);++g<v;)S[g]=(N+g)*a}else{a=-a;let N=Math.round(t*a),$=Math.round(e*a);for(N/a<t&&++N,$/a>e&&--$,S=new Array(v=$-N+1);++g<v;)S[g]=(N+g)/a}return c&&S.reverse(),S}function y4(t,e,n){var c=(e-t)/Math.max(0,n),g=Math.floor(Math.log(c)/Math.LN10),v=c/Math.pow(10,g);return g>=0?(v>=ev?10:v>=tv?5:v>=iv?2:1)*Math.pow(10,g):-Math.pow(10,-g)/(v>=ev?10:v>=tv?5:v>=iv?2:1)}function lP(t,e,n){var c=Math.abs(e-t)/Math.max(0,n),g=Math.pow(10,Math.floor(Math.log(c)/Math.LN10)),v=c/g;return v>=ev?g*=10:v>=tv?g*=5:v>=iv&&(g*=2),e<t?-g:g}function uP(t,e){let n;if(e===void 0)for(const c of t)c!=null&&(n<c||n===void 0&&c>=c)&&(n=c);else{let c=-1;for(let g of t)(g=e(g,++c,t))!=null&&(n<g||n===void 0&&g>=g)&&(n=g)}return n}var j1=Array.prototype.slice;function cP(t){return t}var h_=1,Z1=2,sb=3,Jg=4,ab=1e-6;function hP(t){return"translate("+t+",0)"}function AP(t){return"translate(0,"+t+")"}function fP(t){return e=>+t(e)}function dP(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function pP(){return!this.__axis}function mP(t,e){var n=[],c=null,g=null,v=6,S=6,a=3,N=typeof window<"u"&&window.devicePixelRatio>1?0:.5,$=t===h_||t===Jg?-1:1,he=t===Jg||t===Z1?"x":"y",oe=t===h_||t===sb?hP:AP;function ce(_e){var Ze=c??(e.ticks?e.ticks.apply(e,n):e.domain()),nt=g??(e.tickFormat?e.tickFormat.apply(e,n):cP),Ke=Math.max(v,0)+a,st=e.range(),ht=+st[0]+N,xt=+st[st.length-1]+N,zt=(e.bandwidth?dP:fP)(e.copy(),N),Mt=_e.selection?_e.selection():_e,Ue=Mt.selectAll(".domain").data([null]),$t=Mt.selectAll(".tick").data(Ze,e).order(),rt=$t.exit(),gt=$t.enter().append("g").attr("class","tick"),At=$t.select("line"),yt=$t.select("text");Ue=Ue.merge(Ue.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),$t=$t.merge(gt),At=At.merge(gt.append("line").attr("stroke","currentColor").attr(he+"2",$*v)),yt=yt.merge(gt.append("text").attr("fill","currentColor").attr(he,$*Ke).attr("dy",t===h_?"0em":t===sb?"0.71em":"0.32em")),_e!==Mt&&(Ue=Ue.transition(_e),$t=$t.transition(_e),At=At.transition(_e),yt=yt.transition(_e),rt=rt.transition(_e).attr("opacity",ab).attr("transform",function(St){return isFinite(St=zt(St))?oe(St+N):this.getAttribute("transform")}),gt.attr("opacity",ab).attr("transform",function(St){var ut=this.parentNode.__axis;return oe((ut&&isFinite(ut=ut(St))?ut:zt(St))+N)})),rt.remove(),Ue.attr("d",t===Jg||t===Z1?S?"M"+$*S+","+ht+"H"+N+"V"+xt+"H"+$*S:"M"+N+","+ht+"V"+xt:S?"M"+ht+","+$*S+"V"+N+"H"+xt+"V"+$*S:"M"+ht+","+N+"H"+xt),$t.attr("opacity",1).attr("transform",function(St){return oe(zt(St)+N)}),At.attr(he+"2",$*v),yt.attr(he,$*Ke).text(nt),Mt.filter(pP).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Z1?"start":t===Jg?"end":"middle"),Mt.each(function(){this.__axis=zt})}return ce.scale=function(_e){return arguments.length?(e=_e,ce):e},ce.ticks=function(){return n=j1.call(arguments),ce},ce.tickArguments=function(_e){return arguments.length?(n=_e==null?[]:j1.call(_e),ce):n.slice()},ce.tickValues=function(_e){return arguments.length?(c=_e==null?null:j1.call(_e),ce):c&&c.slice()},ce.tickFormat=function(_e){return arguments.length?(g=_e,ce):g},ce.tickSize=function(_e){return arguments.length?(v=S=+_e,ce):v},ce.tickSizeInner=function(_e){return arguments.length?(v=+_e,ce):v},ce.tickSizeOuter=function(_e){return arguments.length?(S=+_e,ce):S},ce.tickPadding=function(_e){return arguments.length?(a=+_e,ce):a},ce.offset=function(_e){return arguments.length?(N=+_e,ce):N},ce}function gP(t){return mP(h_,t)}var _P={value:()=>{}};function s1(){for(var t=0,e=arguments.length,n={},c;t<e;++t){if(!(c=arguments[t]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new A_(n)}function A_(t){this._=t}function yP(t,e){return t.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}A_.prototype=s1.prototype={constructor:A_,on:function(t,e){var n=this._,c=yP(t+"",n),g,v=-1,S=c.length;if(arguments.length<2){for(;++v<S;)if((g=(t=c[v]).type)&&(g=vP(n[g],t.name)))return g;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++v<S;)if(g=(t=c[v]).type)n[g]=ob(n[g],t.name,e);else if(e==null)for(g in n)n[g]=ob(n[g],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new A_(t)},call:function(t,e){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,v;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(v=this._[t],c=0,g=v.length;c<g;++c)v[c].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var c=this._[t],g=0,v=c.length;g<v;++g)c[g].value.apply(e,n)}};function vP(t,e){for(var n=0,c=t.length,g;n<c;++n)if((g=t[n]).name===e)return g.value}function ob(t,e,n){for(var c=0,g=t.length;c<g;++c)if(t[c].name===e){t[c]=_P,t=t.slice(0,c).concat(t.slice(c+1));break}return n!=null&&t.push({name:e,value:n}),t}var nv="http://www.w3.org/1999/xhtml";const lb={svg:"http://www.w3.org/2000/svg",xhtml:nv,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function a1(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),lb.hasOwnProperty(e)?{space:lb[e],local:t}:t}function xP(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===nv&&e.documentElement.namespaceURI===nv?e.createElement(t):e.createElementNS(n,t)}}function bP(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function $v(t){var e=a1(t);return(e.local?bP:xP)(e)}function wP(){}function Xv(t){return t==null?wP:function(){return this.querySelector(t)}}function SP(t){typeof t!="function"&&(t=Xv(t));for(var e=this._groups,n=e.length,c=new Array(n),g=0;g<n;++g)for(var v=e[g],S=v.length,a=c[g]=new Array(S),N,$,he=0;he<S;++he)(N=v[he])&&($=t.call(N,N.__data__,he,v))&&("__data__"in N&&($.__data__=N.__data__),a[he]=$);return new jc(c,this._parents)}function v4(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function IP(){return[]}function x4(t){return t==null?IP:function(){return this.querySelectorAll(t)}}function EP(t){return function(){var e=t.apply(this,arguments);return e==null?[]:v4(e)}}function CP(t){typeof t=="function"?t=EP(t):t=x4(t);for(var e=this._groups,n=e.length,c=[],g=[],v=0;v<n;++v)for(var S=e[v],a=S.length,N,$=0;$<a;++$)(N=S[$])&&(c.push(t.call(N,N.__data__,$,S)),g.push(N));return new jc(c,g)}function b4(t){return function(){return this.matches(t)}}function w4(t){return function(e){return e.matches(t)}}var TP=Array.prototype.find;function kP(t){return function(){return TP.call(this.children,t)}}function MP(){return this.firstElementChild}function PP(t){return this.select(t==null?MP:kP(typeof t=="function"?t:w4(t)))}var DP=Array.prototype.filter;function LP(){return this.children}function BP(t){return function(){return DP.call(this.children,t)}}function zP(t){return this.selectAll(t==null?LP:BP(typeof t=="function"?t:w4(t)))}function RP(t){typeof t!="function"&&(t=b4(t));for(var e=this._groups,n=e.length,c=new Array(n),g=0;g<n;++g)for(var v=e[g],S=v.length,a=c[g]=[],N,$=0;$<S;++$)(N=v[$])&&t.call(N,N.__data__,$,v)&&a.push(N);return new jc(c,this._parents)}function S4(t){return new Array(t.length)}function FP(){return new jc(this._enter||this._groups.map(S4),this._parents)}function L_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}L_.prototype={constructor:L_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function OP(t){return function(){return t}}function NP(t,e,n,c,g,v){for(var S=0,a,N=e.length,$=v.length;S<$;++S)(a=e[S])?(a.__data__=v[S],c[S]=a):n[S]=new L_(t,v[S]);for(;S<N;++S)(a=e[S])&&(g[S]=a)}function VP(t,e,n,c,g,v,S){var a,N,$=new Map,he=e.length,oe=v.length,ce=new Array(he),_e;for(a=0;a<he;++a)(N=e[a])&&(ce[a]=_e=S.call(N,N.__data__,a,e)+"",$.has(_e)?g[a]=N:$.set(_e,N));for(a=0;a<oe;++a)_e=S.call(t,v[a],a,v)+"",(N=$.get(_e))?(c[a]=N,N.__data__=v[a],$.delete(_e)):n[a]=new L_(t,v[a]);for(a=0;a<he;++a)(N=e[a])&&$.get(ce[a])===N&&(g[a]=N)}function UP(t){return t.__data__}function GP(t,e){if(!arguments.length)return Array.from(this,UP);var n=e?VP:NP,c=this._parents,g=this._groups;typeof t!="function"&&(t=OP(t));for(var v=g.length,S=new Array(v),a=new Array(v),N=new Array(v),$=0;$<v;++$){var he=c[$],oe=g[$],ce=oe.length,_e=v4(t.call(he,he&&he.__data__,$,c)),Ze=_e.length,nt=a[$]=new Array(Ze),Ke=S[$]=new Array(Ze),st=N[$]=new Array(ce);n(he,oe,nt,Ke,st,_e,e);for(var ht=0,xt=0,zt,Mt;ht<Ze;++ht)if(zt=nt[ht]){for(ht>=xt&&(xt=ht+1);!(Mt=Ke[xt])&&++xt<Ze;);zt._next=Mt||null}}return S=new jc(S,c),S._enter=a,S._exit=N,S}function qP(){return new jc(this._exit||this._groups.map(S4),this._parents)}function HP(t,e,n){var c=this.enter(),g=this,v=this.exit();return c=typeof t=="function"?t(c):c.append(t+""),e!=null&&(g=e(g)),n==null?v.remove():n(v),c&&g?c.merge(g).order():g}function jP(t){if(!(t instanceof jc))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,c=e.length,g=n.length,v=Math.min(c,g),S=new Array(c),a=0;a<v;++a)for(var N=e[a],$=n[a],he=N.length,oe=S[a]=new Array(he),ce,_e=0;_e<he;++_e)(ce=N[_e]||$[_e])&&(oe[_e]=ce);for(;a<c;++a)S[a]=e[a];return new jc(S,this._parents)}function ZP(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var c=t[e],g=c.length-1,v=c[g],S;--g>=0;)(S=c[g])&&(v&&S.compareDocumentPosition(v)^4&&v.parentNode.insertBefore(S,v),v=S);return this}function QP(t){t||(t=WP);function e(oe,ce){return oe&&ce?t(oe.__data__,ce.__data__):!oe-!ce}for(var n=this._groups,c=n.length,g=new Array(c),v=0;v<c;++v){for(var S=n[v],a=S.length,N=g[v]=new Array(a),$,he=0;he<a;++he)($=S[he])&&(N[he]=$);N.sort(e)}return new jc(g,this._parents).order()}function WP(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function $P(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function XP(){return Array.from(this)}function YP(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var c=t[e],g=0,v=c.length;g<v;++g){var S=c[g];if(S)return S}return null}function KP(){let t=0;for(const e of this)++t;return t}function JP(){return!this.node()}function eD(t){for(var e=this._groups,n=0,c=e.length;n<c;++n)for(var g=e[n],v=0,S=g.length,a;v<S;++v)(a=g[v])&&t.call(a,a.__data__,v,g);return this}function tD(t){return function(){this.removeAttribute(t)}}function iD(t){return function(){this.removeAttributeNS(t.space,t.local)}}function nD(t,e){return function(){this.setAttribute(t,e)}}function rD(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function sD(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function aD(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function oD(t,e){var n=a1(t);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((e==null?n.local?iD:tD:typeof e=="function"?n.local?aD:sD:n.local?rD:nD)(n,e))}function I4(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function lD(t){return function(){this.style.removeProperty(t)}}function uD(t,e,n){return function(){this.style.setProperty(t,e,n)}}function cD(t,e,n){return function(){var c=e.apply(this,arguments);c==null?this.style.removeProperty(t):this.style.setProperty(t,c,n)}}function hD(t,e,n){return arguments.length>1?this.each((e==null?lD:typeof e=="function"?cD:uD)(t,e,n??"")):wm(this.node(),t)}function wm(t,e){return t.style.getPropertyValue(e)||I4(t).getComputedStyle(t,null).getPropertyValue(e)}function AD(t){return function(){delete this[t]}}function fD(t,e){return function(){this[t]=e}}function dD(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function pD(t,e){return arguments.length>1?this.each((e==null?AD:typeof e=="function"?dD:fD)(t,e)):this.node()[t]}function E4(t){return t.trim().split(/^|\s+/)}function Yv(t){return t.classList||new C4(t)}function C4(t){this._node=t,this._names=E4(t.getAttribute("class")||"")}C4.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function T4(t,e){for(var n=Yv(t),c=-1,g=e.length;++c<g;)n.add(e[c])}function k4(t,e){for(var n=Yv(t),c=-1,g=e.length;++c<g;)n.remove(e[c])}function mD(t){return function(){T4(this,t)}}function gD(t){return function(){k4(this,t)}}function _D(t,e){return function(){(e.apply(this,arguments)?T4:k4)(this,t)}}function yD(t,e){var n=E4(t+"");if(arguments.length<2){for(var c=Yv(this.node()),g=-1,v=n.length;++g<v;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof e=="function"?_D:e?mD:gD)(n,e))}function vD(){this.textContent=""}function xD(t){return function(){this.textContent=t}}function bD(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function wD(t){return arguments.length?this.each(t==null?vD:(typeof t=="function"?bD:xD)(t)):this.node().textContent}function SD(){this.innerHTML=""}function ID(t){return function(){this.innerHTML=t}}function ED(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function CD(t){return arguments.length?this.each(t==null?SD:(typeof t=="function"?ED:ID)(t)):this.node().innerHTML}function TD(){this.nextSibling&&this.parentNode.appendChild(this)}function kD(){return this.each(TD)}function MD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function PD(){return this.each(MD)}function DD(t){var e=typeof t=="function"?t:$v(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function LD(){return null}function BD(t,e){var n=typeof t=="function"?t:$v(t),c=e==null?LD:typeof e=="function"?e:Xv(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function zD(){var t=this.parentNode;t&&t.removeChild(this)}function RD(){return this.each(zD)}function FD(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function OD(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ND(t){return this.select(t?OD:FD)}function VD(t){return arguments.length?this.property("__data__",t):this.node().__data__}function UD(t){return function(e){t.call(this,e,this.__data__)}}function GD(t){return t.trim().split(/^|\s+/).map(function(e){var n="",c=e.indexOf(".");return c>=0&&(n=e.slice(c+1),e=e.slice(0,c)),{type:e,name:n}})}function qD(t){return function(){var e=this.__on;if(e){for(var n=0,c=-1,g=e.length,v;n<g;++n)v=e[n],(!t.type||v.type===t.type)&&v.name===t.name?this.removeEventListener(v.type,v.listener,v.options):e[++c]=v;++c?e.length=c:delete this.__on}}}function HD(t,e,n){return function(){var c=this.__on,g,v=UD(e);if(c){for(var S=0,a=c.length;S<a;++S)if((g=c[S]).type===t.type&&g.name===t.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=v,g.options=n),g.value=e;return}}this.addEventListener(t.type,v,n),g={type:t.type,name:t.name,value:e,listener:v,options:n},c?c.push(g):this.__on=[g]}}function jD(t,e,n){var c=GD(t+""),g,v=c.length,S;if(arguments.length<2){var a=this.node().__on;if(a){for(var N=0,$=a.length,he;N<$;++N)for(g=0,he=a[N];g<v;++g)if((S=c[g]).type===he.type&&S.name===he.name)return he.value}return}for(a=e?HD:qD,g=0;g<v;++g)this.each(a(c[g],e,n));return this}function M4(t,e,n){var c=I4(t),g=c.CustomEvent;typeof g=="function"?g=new g(e,n):(g=c.document.createEvent("Event"),n?(g.initEvent(e,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(e,!1,!1)),t.dispatchEvent(g)}function ZD(t,e){return function(){return M4(this,t,e)}}function QD(t,e){return function(){return M4(this,t,e.apply(this,arguments))}}function WD(t,e){return this.each((typeof e=="function"?QD:ZD)(t,e))}function*$D(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var c=t[e],g=0,v=c.length,S;g<v;++g)(S=c[g])&&(yield S)}var P4=[null];function jc(t,e){this._groups=t,this._parents=e}function Fg(){return new jc([[document.documentElement]],P4)}function XD(){return this}jc.prototype=Fg.prototype={constructor:jc,select:SP,selectAll:CP,selectChild:PP,selectChildren:zP,filter:RP,data:GP,enter:FP,exit:qP,join:HP,merge:jP,selection:XD,order:ZP,sort:QP,call:$P,nodes:XP,node:YP,size:KP,empty:JP,each:eD,attr:oD,style:hD,property:pD,classed:yD,text:wD,html:CD,raise:kD,lower:PD,append:DD,insert:BD,remove:RD,clone:ND,datum:VD,on:jD,dispatch:WD,[Symbol.iterator]:$D};function pl(t){return typeof t=="string"?new jc([[document.querySelector(t)]],[document.documentElement]):new jc([[t]],P4)}function YD(t){return pl($v(t).call(document.documentElement))}function KD(t){let e;for(;e=t.sourceEvent;)t=e;return t}function n0(t,e){if(t=KD(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var c=n.createSVGPoint();return c.x=t.clientX,c.y=t.clientY,c=c.matrixTransform(e.getScreenCTM().inverse()),[c.x,c.y]}if(e.getBoundingClientRect){var g=e.getBoundingClientRect();return[t.clientX-g.left-e.clientLeft,t.clientY-g.top-e.clientTop]}}return[t.pageX,t.pageY]}function rv(t){t.preventDefault(),t.stopImmediatePropagation()}function D4(t){var e=t.document.documentElement,n=pl(t).on("dragstart.drag",rv,!0);"onselectstart"in e?n.on("selectstart.drag",rv,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function L4(t,e){var n=t.document.documentElement,c=pl(t).on("dragstart.drag",null);e&&(c.on("click.drag",rv,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in n?c.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Kv(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function B4(t,e){var n=Object.create(t.prototype);for(var c in e)n[c]=e[c];return n}function Og(){}var Sg=.7,B_=1/Sg,gm="\\s*([+-]?\\d+)\\s*",Ig="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",rf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",JD=/^#([0-9a-f]{3,8})$/,eL=new RegExp("^rgb\\("+[gm,gm,gm]+"\\)$"),tL=new RegExp("^rgb\\("+[rf,rf,rf]+"\\)$"),iL=new RegExp("^rgba\\("+[gm,gm,gm,Ig]+"\\)$"),nL=new RegExp("^rgba\\("+[rf,rf,rf,Ig]+"\\)$"),rL=new RegExp("^hsl\\("+[Ig,rf,rf]+"\\)$"),sL=new RegExp("^hsla\\("+[Ig,rf,rf,Ig]+"\\)$"),ub={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kv(Og,cp,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:cb,formatHex:cb,formatHsl:aL,formatRgb:hb,toString:hb});function cb(){return this.rgb().formatHex()}function aL(){return z4(this).formatHsl()}function hb(){return this.rgb().formatRgb()}function cp(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=JD.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Ab(e):n===3?new ph(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?e_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?e_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=eL.exec(t))?new ph(e[1],e[2],e[3],1):(e=tL.exec(t))?new ph(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=iL.exec(t))?e_(e[1],e[2],e[3],e[4]):(e=nL.exec(t))?e_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=rL.exec(t))?pb(e[1],e[2]/100,e[3]/100,1):(e=sL.exec(t))?pb(e[1],e[2]/100,e[3]/100,e[4]):ub.hasOwnProperty(t)?Ab(ub[t]):t==="transparent"?new ph(NaN,NaN,NaN,0):null}function Ab(t){return new ph(t>>16&255,t>>8&255,t&255,1)}function e_(t,e,n,c){return c<=0&&(t=e=n=NaN),new ph(t,e,n,c)}function oL(t){return t instanceof Og||(t=cp(t)),t?(t=t.rgb(),new ph(t.r,t.g,t.b,t.opacity)):new ph}function sv(t,e,n,c){return arguments.length===1?oL(t):new ph(t,e,n,c??1)}function ph(t,e,n,c){this.r=+t,this.g=+e,this.b=+n,this.opacity=+c}Kv(ph,sv,B4(Og,{brighter:function(t){return t=t==null?B_:Math.pow(B_,t),new ph(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Sg:Math.pow(Sg,t),new ph(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fb,formatHex:fb,formatRgb:db,toString:db}));function fb(){return"#"+Q1(this.r)+Q1(this.g)+Q1(this.b)}function db(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Q1(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function pb(t,e,n,c){return c<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new JA(t,e,n,c)}function z4(t){if(t instanceof JA)return new JA(t.h,t.s,t.l,t.opacity);if(t instanceof Og||(t=cp(t)),!t)return new JA;if(t instanceof JA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,c=t.b/255,g=Math.min(e,n,c),v=Math.max(e,n,c),S=NaN,a=v-g,N=(v+g)/2;return a?(e===v?S=(n-c)/a+(n<c)*6:n===v?S=(c-e)/a+2:S=(e-n)/a+4,a/=N<.5?v+g:2-v-g,S*=60):a=N>0&&N<1?0:S,new JA(S,a,N,t.opacity)}function lL(t,e,n,c){return arguments.length===1?z4(t):new JA(t,e,n,c??1)}function JA(t,e,n,c){this.h=+t,this.s=+e,this.l=+n,this.opacity=+c}Kv(JA,lL,B4(Og,{brighter:function(t){return t=t==null?B_:Math.pow(B_,t),new JA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Sg:Math.pow(Sg,t),new JA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*e,g=2*n-c;return new ph(W1(t>=240?t-240:t+120,g,c),W1(t,g,c),W1(t<120?t+240:t-120,g,c),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function W1(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Jv=t=>()=>t;function uL(t,e){return function(n){return t+n*e}}function cL(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(c){return Math.pow(t+c*e,n)}}function hL(t){return(t=+t)==1?R4:function(e,n){return n-e?cL(e,n,t):Jv(isNaN(e)?n:e)}}function R4(t,e){var n=e-t;return n?uL(t,n):Jv(isNaN(t)?e:t)}const z_=function t(e){var n=hL(e);function c(g,v){var S=n((g=sv(g)).r,(v=sv(v)).r),a=n(g.g,v.g),N=n(g.b,v.b),$=R4(g.opacity,v.opacity);return function(he){return g.r=S(he),g.g=a(he),g.b=N(he),g.opacity=$(he),g+""}}return c.gamma=t,c}(1);function AL(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,c=e.slice(),g;return function(v){for(g=0;g<n;++g)c[g]=t[g]*(1-v)+e[g]*v;return c}}function fL(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function dL(t,e){var n=e?e.length:0,c=t?Math.min(n,t.length):0,g=new Array(c),v=new Array(n),S;for(S=0;S<c;++S)g[S]=o1(t[S],e[S]);for(;S<n;++S)v[S]=e[S];return function(a){for(S=0;S<c;++S)v[S]=g[S](a);return v}}function pL(t,e){var n=new Date;return t=+t,e=+e,function(c){return n.setTime(t*(1-c)+e*c),n}}function AA(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function mL(t,e){var n={},c={},g;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(g in e)g in t?n[g]=o1(t[g],e[g]):c[g]=e[g];return function(v){for(g in n)c[g]=n[g](v);return c}}var av=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$1=new RegExp(av.source,"g");function gL(t){return function(){return t}}function _L(t){return function(e){return t(e)+""}}function F4(t,e){var n=av.lastIndex=$1.lastIndex=0,c,g,v,S=-1,a=[],N=[];for(t=t+"",e=e+"";(c=av.exec(t))&&(g=$1.exec(e));)(v=g.index)>n&&(v=e.slice(n,v),a[S]?a[S]+=v:a[++S]=v),(c=c[0])===(g=g[0])?a[S]?a[S]+=g:a[++S]=g:(a[++S]=null,N.push({i:S,x:AA(c,g)})),n=$1.lastIndex;return n<e.length&&(v=e.slice(n),a[S]?a[S]+=v:a[++S]=v),a.length<2?N[0]?_L(N[0].x):gL(e):(e=N.length,function($){for(var he=0,oe;he<e;++he)a[(oe=N[he]).i]=oe.x($);return a.join("")})}function o1(t,e){var n=typeof e,c;return e==null||n==="boolean"?Jv(e):(n==="number"?AA:n==="string"?(c=cp(e))?(e=c,z_):F4:e instanceof cp?z_:e instanceof Date?pL:fL(e)?AL:Array.isArray(e)?dL:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?mL:AA)(t,e)}function yL(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var mb=180/Math.PI,ov={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function O4(t,e,n,c,g,v){var S,a,N;return(S=Math.sqrt(t*t+e*e))&&(t/=S,e/=S),(N=t*n+e*c)&&(n-=t*N,c-=e*N),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,N/=a),t*c<e*n&&(t=-t,e=-e,N=-N,S=-S),{translateX:g,translateY:v,rotate:Math.atan2(e,t)*mb,skewX:Math.atan(N)*mb,scaleX:S,scaleY:a}}var t_;function vL(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ov:O4(e.a,e.b,e.c,e.d,e.e,e.f)}function xL(t){return t==null||(t_||(t_=document.createElementNS("http://www.w3.org/2000/svg","g")),t_.setAttribute("transform",t),!(t=t_.transform.baseVal.consolidate()))?ov:(t=t.matrix,O4(t.a,t.b,t.c,t.d,t.e,t.f))}function N4(t,e,n,c){function g($){return $.length?$.pop()+" ":""}function v($,he,oe,ce,_e,Ze){if($!==oe||he!==ce){var nt=_e.push("translate(",null,e,null,n);Ze.push({i:nt-4,x:AA($,oe)},{i:nt-2,x:AA(he,ce)})}else(oe||ce)&&_e.push("translate("+oe+e+ce+n)}function S($,he,oe,ce){$!==he?($-he>180?he+=360:he-$>180&&($+=360),ce.push({i:oe.push(g(oe)+"rotate(",null,c)-2,x:AA($,he)})):he&&oe.push(g(oe)+"rotate("+he+c)}function a($,he,oe,ce){$!==he?ce.push({i:oe.push(g(oe)+"skewX(",null,c)-2,x:AA($,he)}):he&&oe.push(g(oe)+"skewX("+he+c)}function N($,he,oe,ce,_e,Ze){if($!==oe||he!==ce){var nt=_e.push(g(_e)+"scale(",null,",",null,")");Ze.push({i:nt-4,x:AA($,oe)},{i:nt-2,x:AA(he,ce)})}else(oe!==1||ce!==1)&&_e.push(g(_e)+"scale("+oe+","+ce+")")}return function($,he){var oe=[],ce=[];return $=t($),he=t(he),v($.translateX,$.translateY,he.translateX,he.translateY,oe,ce),S($.rotate,he.rotate,oe,ce),a($.skewX,he.skewX,oe,ce),N($.scaleX,$.scaleY,he.scaleX,he.scaleY,oe,ce),$=he=null,function(_e){for(var Ze=-1,nt=ce.length,Ke;++Ze<nt;)oe[(Ke=ce[Ze]).i]=Ke.x(_e);return oe.join("")}}}var bL=N4(vL,"px, ","px)","deg)"),wL=N4(xL,", ",")",")"),SL=1e-12;function gb(t){return((t=Math.exp(t))+1/t)/2}function IL(t){return((t=Math.exp(t))-1/t)/2}function EL(t){return((t=Math.exp(2*t))-1)/(t+1)}const CL=function t(e,n,c){function g(v,S){var a=v[0],N=v[1],$=v[2],he=S[0],oe=S[1],ce=S[2],_e=he-a,Ze=oe-N,nt=_e*_e+Ze*Ze,Ke,st;if(nt<SL)st=Math.log(ce/$)/e,Ke=function($t){return[a+$t*_e,N+$t*Ze,$*Math.exp(e*$t*st)]};else{var ht=Math.sqrt(nt),xt=(ce*ce-$*$+c*nt)/(2*$*n*ht),zt=(ce*ce-$*$-c*nt)/(2*ce*n*ht),Mt=Math.log(Math.sqrt(xt*xt+1)-xt),Ue=Math.log(Math.sqrt(zt*zt+1)-zt);st=(Ue-Mt)/e,Ke=function($t){var rt=$t*st,gt=gb(Mt),At=$/(n*ht)*(gt*EL(e*rt+Mt)-IL(Mt));return[a+At*_e,N+At*Ze,$*gt/gb(e*rt+Mt)]}}return Ke.duration=st*1e3*e/Math.SQRT2,Ke}return g.rho=function(v){var S=Math.max(.001,+v),a=S*S,N=a*a;return t(S,a,N)},g}(Math.SQRT2,2,4);var Sm=0,pg=0,Jm=0,V4=1e3,R_,mg,F_=0,hp=0,l1=0,Eg=typeof performance=="object"&&performance.now?performance:Date,U4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function e2(){return hp||(U4(TL),hp=Eg.now()+l1)}function TL(){hp=0}function O_(){this._call=this._time=this._next=null}O_.prototype=G4.prototype={constructor:O_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?e2():+n)+(e==null?0:+e),!this._next&&mg!==this&&(mg?mg._next=this:R_=this,mg=this),this._call=t,this._time=n,lv()},stop:function(){this._call&&(this._call=null,this._time=1/0,lv())}};function G4(t,e,n){var c=new O_;return c.restart(t,e,n),c}function kL(){e2(),++Sm;for(var t=R_,e;t;)(e=hp-t._time)>=0&&t._call.call(null,e),t=t._next;--Sm}function _b(){hp=(F_=Eg.now())+l1,Sm=pg=0;try{kL()}finally{Sm=0,PL(),hp=0}}function ML(){var t=Eg.now(),e=t-F_;e>V4&&(l1-=e,F_=t)}function PL(){for(var t,e=R_,n,c=1/0;e;)e._call?(c>e._time&&(c=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:R_=n);mg=t,lv(c)}function lv(t){if(!Sm){pg&&(pg=clearTimeout(pg));var e=t-hp;e>24?(t<1/0&&(pg=setTimeout(_b,t-Eg.now()-l1)),Jm&&(Jm=clearInterval(Jm))):(Jm||(F_=Eg.now(),Jm=setInterval(ML,V4)),Sm=1,U4(_b))}}function yb(t,e,n){var c=new O_;return e=e==null?0:+e,c.restart(g=>{c.stop(),t(g+e)},e,n),c}var DL=s1("start","end","cancel","interrupt"),LL=[],q4=0,vb=1,uv=2,f_=3,xb=4,cv=5,d_=6;function u1(t,e,n,c,g,v){var S=t.__transition;if(!S)t.__transition={};else if(n in S)return;BL(t,n,{name:e,index:c,group:g,on:DL,tween:LL,time:v.time,delay:v.delay,duration:v.duration,ease:v.ease,timer:null,state:q4})}function t2(t,e){var n=mA(t,e);if(n.state>q4)throw new Error("too late; already scheduled");return n}function hf(t,e){var n=mA(t,e);if(n.state>f_)throw new Error("too late; already running");return n}function mA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function BL(t,e,n){var c=t.__transition,g;c[e]=n,n.timer=G4(v,0,n.time);function v($){n.state=vb,n.timer.restart(S,n.delay,n.time),n.delay<=$&&S($-n.delay)}function S($){var he,oe,ce,_e;if(n.state!==vb)return N();for(he in c)if(_e=c[he],_e.name===n.name){if(_e.state===f_)return yb(S);_e.state===xb?(_e.state=d_,_e.timer.stop(),_e.on.call("interrupt",t,t.__data__,_e.index,_e.group),delete c[he]):+he<e&&(_e.state=d_,_e.timer.stop(),_e.on.call("cancel",t,t.__data__,_e.index,_e.group),delete c[he])}if(yb(function(){n.state===f_&&(n.state=xb,n.timer.restart(a,n.delay,n.time),a($))}),n.state=uv,n.on.call("start",t,t.__data__,n.index,n.group),n.state===uv){for(n.state=f_,g=new Array(ce=n.tween.length),he=0,oe=-1;he<ce;++he)(_e=n.tween[he].value.call(t,t.__data__,n.index,n.group))&&(g[++oe]=_e);g.length=oe+1}}function a($){for(var he=$<n.duration?n.ease.call(null,$/n.duration):(n.timer.restart(N),n.state=cv,1),oe=-1,ce=g.length;++oe<ce;)g[oe].call(t,he);n.state===cv&&(n.on.call("end",t,t.__data__,n.index,n.group),N())}function N(){n.state=d_,n.timer.stop(),delete c[e];for(var $ in c)return;delete t.__transition}}function _m(t,e){var n=t.__transition,c,g,v=!0,S;if(n){e=e==null?null:e+"";for(S in n){if((c=n[S]).name!==e){v=!1;continue}g=c.state>uv&&c.state<cv,c.state=d_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",t,t.__data__,c.index,c.group),delete n[S]}v&&delete t.__transition}}function zL(t){return this.each(function(){_m(this,t)})}function RL(t,e){var n,c;return function(){var g=hf(this,t),v=g.tween;if(v!==n){c=n=v;for(var S=0,a=c.length;S<a;++S)if(c[S].name===e){c=c.slice(),c.splice(S,1);break}}g.tween=c}}function FL(t,e,n){var c,g;if(typeof n!="function")throw new Error;return function(){var v=hf(this,t),S=v.tween;if(S!==c){g=(c=S).slice();for(var a={name:e,value:n},N=0,$=g.length;N<$;++N)if(g[N].name===e){g[N]=a;break}N===$&&g.push(a)}v.tween=g}}function OL(t,e){var n=this._id;if(t+="",arguments.length<2){for(var c=mA(this.node(),n).tween,g=0,v=c.length,S;g<v;++g)if((S=c[g]).name===t)return S.value;return null}return this.each((e==null?RL:FL)(n,t,e))}function i2(t,e,n){var c=t._id;return t.each(function(){var g=hf(this,c);(g.value||(g.value={}))[e]=n.apply(this,arguments)}),function(g){return mA(g,c).value[e]}}function H4(t,e){var n;return(typeof e=="number"?AA:e instanceof cp?z_:(n=cp(e))?(e=n,z_):F4)(t,e)}function NL(t){return function(){this.removeAttribute(t)}}function VL(t){return function(){this.removeAttributeNS(t.space,t.local)}}function UL(t,e,n){var c,g=n+"",v;return function(){var S=this.getAttribute(t);return S===g?null:S===c?v:v=e(c=S,n)}}function GL(t,e,n){var c,g=n+"",v;return function(){var S=this.getAttributeNS(t.space,t.local);return S===g?null:S===c?v:v=e(c=S,n)}}function qL(t,e,n){var c,g,v;return function(){var S,a=n(this),N;return a==null?void this.removeAttribute(t):(S=this.getAttribute(t),N=a+"",S===N?null:S===c&&N===g?v:(g=N,v=e(c=S,a)))}}function HL(t,e,n){var c,g,v;return function(){var S,a=n(this),N;return a==null?void this.removeAttributeNS(t.space,t.local):(S=this.getAttributeNS(t.space,t.local),N=a+"",S===N?null:S===c&&N===g?v:(g=N,v=e(c=S,a)))}}function jL(t,e){var n=a1(t),c=n==="transform"?wL:H4;return this.attrTween(t,typeof e=="function"?(n.local?HL:qL)(n,c,i2(this,"attr."+t,e)):e==null?(n.local?VL:NL)(n):(n.local?GL:UL)(n,c,e))}function ZL(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function QL(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function WL(t,e){var n,c;function g(){var v=e.apply(this,arguments);return v!==c&&(n=(c=v)&&QL(t,v)),n}return g._value=e,g}function $L(t,e){var n,c;function g(){var v=e.apply(this,arguments);return v!==c&&(n=(c=v)&&ZL(t,v)),n}return g._value=e,g}function XL(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var c=a1(t);return this.tween(n,(c.local?WL:$L)(c,e))}function YL(t,e){return function(){t2(this,t).delay=+e.apply(this,arguments)}}function KL(t,e){return e=+e,function(){t2(this,t).delay=e}}function JL(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?YL:KL)(e,t)):mA(this.node(),e).delay}function eB(t,e){return function(){hf(this,t).duration=+e.apply(this,arguments)}}function tB(t,e){return e=+e,function(){hf(this,t).duration=e}}function iB(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?eB:tB)(e,t)):mA(this.node(),e).duration}function nB(t,e){if(typeof e!="function")throw new Error;return function(){hf(this,t).ease=e}}function rB(t){var e=this._id;return arguments.length?this.each(nB(e,t)):mA(this.node(),e).ease}function sB(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;hf(this,t).ease=n}}function aB(t){if(typeof t!="function")throw new Error;return this.each(sB(this._id,t))}function oB(t){typeof t!="function"&&(t=b4(t));for(var e=this._groups,n=e.length,c=new Array(n),g=0;g<n;++g)for(var v=e[g],S=v.length,a=c[g]=[],N,$=0;$<S;++$)(N=v[$])&&t.call(N,N.__data__,$,v)&&a.push(N);return new c0(c,this._parents,this._name,this._id)}function lB(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,c=e.length,g=n.length,v=Math.min(c,g),S=new Array(c),a=0;a<v;++a)for(var N=e[a],$=n[a],he=N.length,oe=S[a]=new Array(he),ce,_e=0;_e<he;++_e)(ce=N[_e]||$[_e])&&(oe[_e]=ce);for(;a<c;++a)S[a]=e[a];return new c0(S,this._parents,this._name,this._id)}function uB(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function cB(t,e,n){var c,g,v=uB(e)?t2:hf;return function(){var S=v(this,t),a=S.on;a!==c&&(g=(c=a).copy()).on(e,n),S.on=g}}function hB(t,e){var n=this._id;return arguments.length<2?mA(this.node(),n).on.on(t):this.each(cB(n,t,e))}function AB(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function fB(){return this.on("end.remove",AB(this._id))}function dB(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Xv(t));for(var c=this._groups,g=c.length,v=new Array(g),S=0;S<g;++S)for(var a=c[S],N=a.length,$=v[S]=new Array(N),he,oe,ce=0;ce<N;++ce)(he=a[ce])&&(oe=t.call(he,he.__data__,ce,a))&&("__data__"in he&&(oe.__data__=he.__data__),$[ce]=oe,u1($[ce],e,n,ce,$,mA(he,n)));return new c0(v,this._parents,e,n)}function pB(t){var e=this._name,n=this._id;typeof t!="function"&&(t=x4(t));for(var c=this._groups,g=c.length,v=[],S=[],a=0;a<g;++a)for(var N=c[a],$=N.length,he,oe=0;oe<$;++oe)if(he=N[oe]){for(var ce=t.call(he,he.__data__,oe,N),_e,Ze=mA(he,n),nt=0,Ke=ce.length;nt<Ke;++nt)(_e=ce[nt])&&u1(_e,e,n,nt,ce,Ze);v.push(ce),S.push(he)}return new c0(v,S,e,n)}var mB=Fg.prototype.constructor;function gB(){return new mB(this._groups,this._parents)}function _B(t,e){var n,c,g;return function(){var v=wm(this,t),S=(this.style.removeProperty(t),wm(this,t));return v===S?null:v===n&&S===c?g:g=e(n=v,c=S)}}function j4(t){return function(){this.style.removeProperty(t)}}function yB(t,e,n){var c,g=n+"",v;return function(){var S=wm(this,t);return S===g?null:S===c?v:v=e(c=S,n)}}function vB(t,e,n){var c,g,v;return function(){var S=wm(this,t),a=n(this),N=a+"";return a==null&&(N=a=(this.style.removeProperty(t),wm(this,t))),S===N?null:S===c&&N===g?v:(g=N,v=e(c=S,a))}}function xB(t,e){var n,c,g,v="style."+e,S="end."+v,a;return function(){var N=hf(this,t),$=N.on,he=N.value[v]==null?a||(a=j4(e)):void 0;($!==n||g!==he)&&(c=(n=$).copy()).on(S,g=he),N.on=c}}function bB(t,e,n){var c=(t+="")=="transform"?bL:H4;return e==null?this.styleTween(t,_B(t,c)).on("end.style."+t,j4(t)):typeof e=="function"?this.styleTween(t,vB(t,c,i2(this,"style."+t,e))).each(xB(this._id,t)):this.styleTween(t,yB(t,c,e),n).on("end.style."+t,null)}function wB(t,e,n){return function(c){this.style.setProperty(t,e.call(this,c),n)}}function SB(t,e,n){var c,g;function v(){var S=e.apply(this,arguments);return S!==g&&(c=(g=S)&&wB(t,S,n)),c}return v._value=e,v}function IB(t,e,n){var c="style."+(t+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(e==null)return this.tween(c,null);if(typeof e!="function")throw new Error;return this.tween(c,SB(t,e,n??""))}function EB(t){return function(){this.textContent=t}}function CB(t){return function(){var e=t(this);this.textContent=e??""}}function TB(t){return this.tween("text",typeof t=="function"?CB(i2(this,"text",t)):EB(t==null?"":t+""))}function kB(t){return function(e){this.textContent=t.call(this,e)}}function MB(t){var e,n;function c(){var g=t.apply(this,arguments);return g!==n&&(e=(n=g)&&kB(g)),e}return c._value=t,c}function PB(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,MB(t))}function DB(){for(var t=this._name,e=this._id,n=Z4(),c=this._groups,g=c.length,v=0;v<g;++v)for(var S=c[v],a=S.length,N,$=0;$<a;++$)if(N=S[$]){var he=mA(N,e);u1(N,t,n,$,S,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new c0(c,this._parents,t,n)}function LB(){var t,e,n=this,c=n._id,g=n.size();return new Promise(function(v,S){var a={value:S},N={value:function(){--g===0&&v()}};n.each(function(){var $=hf(this,c),he=$.on;he!==t&&(e=(t=he).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(N)),$.on=e}),g===0&&v()})}var BB=0;function c0(t,e,n,c){this._groups=t,this._parents=e,this._name=n,this._id=c}function Z4(){return++BB}var $d=Fg.prototype;c0.prototype={constructor:c0,select:dB,selectAll:pB,filter:oB,merge:lB,selection:gB,transition:DB,call:$d.call,nodes:$d.nodes,node:$d.node,size:$d.size,empty:$d.empty,each:$d.each,on:hB,attr:jL,attrTween:XL,style:bB,styleTween:IB,text:TB,textTween:PB,remove:fB,tween:OL,delay:JL,duration:iB,ease:rB,easeVarying:aB,end:LB,[Symbol.iterator]:$d[Symbol.iterator]};function zB(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var RB={time:null,delay:0,duration:250,ease:zB};function FB(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function OB(t){var e,n;t instanceof c0?(e=t._id,t=t._name):(e=Z4(),(n=RB).time=e2(),t=t==null?null:t+"");for(var c=this._groups,g=c.length,v=0;v<g;++v)for(var S=c[v],a=S.length,N,$=0;$<a;++$)(N=S[$])&&u1(N,t,e,$,S,n||FB(N,e));return new c0(c,this._parents,t,e)}Fg.prototype.interrupt=zL;Fg.prototype.transition=OB;const X1=t=>()=>t;function NB(t,{sourceEvent:e,target:n,selection:c,mode:g,dispatch:v}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:c,enumerable:!0,configurable:!0},mode:{value:g,enumerable:!0,configurable:!0},_:{value:v}})}function VB(t){t.stopImmediatePropagation()}function Y1(t){t.preventDefault(),t.stopImmediatePropagation()}var bb={name:"drag"},K1={name:"space"},em={name:"handle"},tm={name:"center"};const{abs:wb,max:tc,min:ic}=Math;function Sb(t){return[+t[0],+t[1]]}function hv(t){return[Sb(t[0]),Sb(t[1])]}var J1={name:"x",handles:["w","e"].map(Cg),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},ey={name:"y",handles:["n","s"].map(Cg),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},UB={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Cg),input:function(t){return t==null?null:hv(t)},output:function(t){return t}},e0={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ib={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Eb={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},GB={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},qB={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Cg(t){return{type:t}}function HB(t){return!t.ctrlKey&&!t.button}function jB(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function ZB(){return navigator.maxTouchPoints||"ontouchstart"in this}function ty(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function QB(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function WB(){return $B(UB)}function $B(t){var e=jB,n=HB,c=ZB,g=!0,v=s1("start","brush","end"),S=6,a;function N(Ke){var st=Ke.property("__brush",nt).selectAll(".overlay").data([Cg("overlay")]);st.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",e0.overlay).merge(st).each(function(){var xt=ty(this).extent;pl(this).attr("x",xt[0][0]).attr("y",xt[0][1]).attr("width",xt[1][0]-xt[0][0]).attr("height",xt[1][1]-xt[0][1])}),Ke.selectAll(".selection").data([Cg("selection")]).enter().append("rect").attr("class","selection").attr("cursor",e0.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var ht=Ke.selectAll(".handle").data(t.handles,function(xt){return xt.type});ht.exit().remove(),ht.enter().append("rect").attr("class",function(xt){return"handle handle--"+xt.type}).attr("cursor",function(xt){return e0[xt.type]}),Ke.each($).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",ce).filter(c).on("touchstart.brush",ce).on("touchmove.brush",_e).on("touchend.brush touchcancel.brush",Ze).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.move=function(Ke,st){Ke.tween?Ke.on("start.brush",function(ht){he(this,arguments).beforestart().start(ht)}).on("interrupt.brush end.brush",function(ht){he(this,arguments).end(ht)}).tween("brush",function(){var ht=this,xt=ht.__brush,zt=he(ht,arguments),Mt=xt.selection,Ue=t.input(typeof st=="function"?st.apply(this,arguments):st,xt.extent),$t=o1(Mt,Ue);function rt(gt){xt.selection=gt===1&&Ue===null?null:$t(gt),$.call(ht),zt.brush()}return Mt!==null&&Ue!==null?rt:rt(1)}):Ke.each(function(){var ht=this,xt=arguments,zt=ht.__brush,Mt=t.input(typeof st=="function"?st.apply(ht,xt):st,zt.extent),Ue=he(ht,xt).beforestart();_m(ht),zt.selection=Mt===null?null:Mt,$.call(ht),Ue.start().brush().end()})},N.clear=function(Ke){N.move(Ke,null)};function $(){var Ke=pl(this),st=ty(this).selection;st?(Ke.selectAll(".selection").style("display",null).attr("x",st[0][0]).attr("y",st[0][1]).attr("width",st[1][0]-st[0][0]).attr("height",st[1][1]-st[0][1]),Ke.selectAll(".handle").style("display",null).attr("x",function(ht){return ht.type[ht.type.length-1]==="e"?st[1][0]-S/2:st[0][0]-S/2}).attr("y",function(ht){return ht.type[0]==="s"?st[1][1]-S/2:st[0][1]-S/2}).attr("width",function(ht){return ht.type==="n"||ht.type==="s"?st[1][0]-st[0][0]+S:S}).attr("height",function(ht){return ht.type==="e"||ht.type==="w"?st[1][1]-st[0][1]+S:S})):Ke.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function he(Ke,st,ht){var xt=Ke.__brush.emitter;return xt&&(!ht||!xt.clean)?xt:new oe(Ke,st,ht)}function oe(Ke,st,ht){this.that=Ke,this.args=st,this.state=Ke.__brush,this.active=0,this.clean=ht}oe.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(Ke,st){return this.starting?(this.starting=!1,this.emit("start",Ke,st)):this.emit("brush",Ke),this},brush:function(Ke,st){return this.emit("brush",Ke,st),this},end:function(Ke,st){return--this.active===0&&(delete this.state.emitter,this.emit("end",Ke,st)),this},emit:function(Ke,st,ht){var xt=pl(this.that).datum();v.call(Ke,this.that,new NB(Ke,{sourceEvent:st,target:N,selection:t.output(this.state.selection),mode:ht,dispatch:v}),xt)}};function ce(Ke){if(a&&!Ke.touches||!n.apply(this,arguments))return;var st=this,ht=Ke.target.__data__.type,xt=(g&&Ke.metaKey?ht="overlay":ht)==="selection"?bb:g&&Ke.altKey?tm:em,zt=t===ey?null:GB[ht],Mt=t===J1?null:qB[ht],Ue=ty(st),$t=Ue.extent,rt=Ue.selection,gt=$t[0][0],At,yt,St=$t[0][1],ut,Ye,_t=$t[1][0],ct,Ut,Ft=$t[1][1],Vt,yi,Ci=0,ki=0,Ni,tn=zt&&Mt&&g&&Ke.shiftKey,Zi,Gi,sn=Array.from(Ke.touches||[Ke],Ot=>{const an=Ot.identifier;return Ot=n0(Ot,st),Ot.point0=Ot.slice(),Ot.identifier=an,Ot});if(ht==="overlay"){rt&&(Ni=!0);const Ot=[sn[0],sn[1]||sn[0]];Ue.selection=rt=[[At=t===ey?gt:ic(Ot[0][0],Ot[1][0]),ut=t===J1?St:ic(Ot[0][1],Ot[1][1])],[ct=t===ey?_t:tc(Ot[0][0],Ot[1][0]),Vt=t===J1?Ft:tc(Ot[0][1],Ot[1][1])]],sn.length>1&&bn()}else At=rt[0][0],ut=rt[0][1],ct=rt[1][0],Vt=rt[1][1];yt=At,Ye=ut,Ut=ct,yi=Vt;var xn=pl(st).attr("pointer-events","none"),Ti=xn.selectAll(".overlay").attr("cursor",e0[ht]);_m(st);var gi=he(st,arguments,!0).beforestart();if(Ke.touches)gi.moved=Vi,gi.ended=wn;else{var Oi=pl(Ke.view).on("mousemove.brush",Vi,!0).on("mouseup.brush",wn,!0);g&&Oi.on("keydown.brush",xi,!0).on("keyup.brush",Bn,!0),D4(Ke.view)}$.call(st),gi.start(Ke,xt.name);function Vi(Ot){for(const an of Ot.changedTouches||[Ot])for(const $n of sn)$n.identifier===an.identifier&&($n.cur=n0(an,st));if(tn&&!Zi&&!Gi&&sn.length===1){const an=sn[0];wb(an.cur[0]-an[0])>wb(an.cur[1]-an[1])?Gi=!0:Zi=!0}for(const an of sn)an.cur&&(an[0]=an.cur[0],an[1]=an.cur[1]);Ni=!0,Y1(Ot),bn(Ot)}function bn(Ot){const an=sn[0],$n=an.point0;var oi;switch(Ci=an[0]-$n[0],ki=an[1]-$n[1],xt){case K1:case bb:{zt&&(Ci=tc(gt-At,ic(_t-ct,Ci)),yt=At+Ci,Ut=ct+Ci),Mt&&(ki=tc(St-ut,ic(Ft-Vt,ki)),Ye=ut+ki,yi=Vt+ki);break}case em:{sn[1]?(zt&&(yt=tc(gt,ic(_t,sn[0][0])),Ut=tc(gt,ic(_t,sn[1][0])),zt=1),Mt&&(Ye=tc(St,ic(Ft,sn[0][1])),yi=tc(St,ic(Ft,sn[1][1])),Mt=1)):(zt<0?(Ci=tc(gt-At,ic(_t-At,Ci)),yt=At+Ci,Ut=ct):zt>0&&(Ci=tc(gt-ct,ic(_t-ct,Ci)),yt=At,Ut=ct+Ci),Mt<0?(ki=tc(St-ut,ic(Ft-ut,ki)),Ye=ut+ki,yi=Vt):Mt>0&&(ki=tc(St-Vt,ic(Ft-Vt,ki)),Ye=ut,yi=Vt+ki));break}case tm:{zt&&(yt=tc(gt,ic(_t,At-Ci*zt)),Ut=tc(gt,ic(_t,ct+Ci*zt))),Mt&&(Ye=tc(St,ic(Ft,ut-ki*Mt)),yi=tc(St,ic(Ft,Vt+ki*Mt)));break}}Ut<yt&&(zt*=-1,oi=At,At=ct,ct=oi,oi=yt,yt=Ut,Ut=oi,ht in Ib&&Ti.attr("cursor",e0[ht=Ib[ht]])),yi<Ye&&(Mt*=-1,oi=ut,ut=Vt,Vt=oi,oi=Ye,Ye=yi,yi=oi,ht in Eb&&Ti.attr("cursor",e0[ht=Eb[ht]])),Ue.selection&&(rt=Ue.selection),Zi&&(yt=rt[0][0],Ut=rt[1][0]),Gi&&(Ye=rt[0][1],yi=rt[1][1]),(rt[0][0]!==yt||rt[0][1]!==Ye||rt[1][0]!==Ut||rt[1][1]!==yi)&&(Ue.selection=[[yt,Ye],[Ut,yi]],$.call(st),gi.brush(Ot,xt.name))}function wn(Ot){if(VB(Ot),Ot.touches){if(Ot.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else L4(Ot.view,Ni),Oi.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);xn.attr("pointer-events","all"),Ti.attr("cursor",e0.overlay),Ue.selection&&(rt=Ue.selection),QB(rt)&&(Ue.selection=null,$.call(st)),gi.end(Ot,xt.name)}function xi(Ot){switch(Ot.keyCode){case 16:{tn=zt&&Mt;break}case 18:{xt===em&&(zt&&(ct=Ut-Ci*zt,At=yt+Ci*zt),Mt&&(Vt=yi-ki*Mt,ut=Ye+ki*Mt),xt=tm,bn());break}case 32:{(xt===em||xt===tm)&&(zt<0?ct=Ut-Ci:zt>0&&(At=yt-Ci),Mt<0?Vt=yi-ki:Mt>0&&(ut=Ye-ki),xt=K1,Ti.attr("cursor",e0.selection),bn());break}default:return}Y1(Ot)}function Bn(Ot){switch(Ot.keyCode){case 16:{tn&&(Zi=Gi=tn=!1,bn());break}case 18:{xt===tm&&(zt<0?ct=Ut:zt>0&&(At=yt),Mt<0?Vt=yi:Mt>0&&(ut=Ye),xt=em,bn());break}case 32:{xt===K1&&(Ot.altKey?(zt&&(ct=Ut-Ci*zt,At=yt+Ci*zt),Mt&&(Vt=yi-ki*Mt,ut=Ye+ki*Mt),xt=tm):(zt<0?ct=Ut:zt>0&&(At=yt),Mt<0?Vt=yi:Mt>0&&(ut=Ye),xt=em),Ti.attr("cursor",e0[ht]),bn());break}default:return}Y1(Ot)}}function _e(Ke){he(this,arguments).moved(Ke)}function Ze(Ke){he(this,arguments).ended(Ke)}function nt(){var Ke=this.__brush||{selection:null};return Ke.extent=hv(e.apply(this,arguments)),Ke.dim=t,Ke}return N.extent=function(Ke){return arguments.length?(e=typeof Ke=="function"?Ke:X1(hv(Ke)),N):e},N.filter=function(Ke){return arguments.length?(n=typeof Ke=="function"?Ke:X1(!!Ke),N):n},N.touchable=function(Ke){return arguments.length?(c=typeof Ke=="function"?Ke:X1(!!Ke),N):c},N.handleSize=function(Ke){return arguments.length?(S=+Ke,N):S},N.keyModifiers=function(Ke){return arguments.length?(g=!!Ke,N):g},N.on=function(){var Ke=v.on.apply(v,arguments);return Ke===v?N:Ke},N}const Av=Math.PI,fv=2*Av,Kd=1e-6,XB=fv-Kd;function dv(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Q4(){return new dv}dv.prototype=Q4.prototype={constructor:dv,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,c){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+c)},bezierCurveTo:function(t,e,n,c,g,v){this._+="C"+ +t+","+ +e+","+ +n+","+ +c+","+(this._x1=+g)+","+(this._y1=+v)},arcTo:function(t,e,n,c,g){t=+t,e=+e,n=+n,c=+c,g=+g;var v=this._x1,S=this._y1,a=n-t,N=c-e,$=v-t,he=S-e,oe=$*$+he*he;if(g<0)throw new Error("negative radius: "+g);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(oe>Kd)if(!(Math.abs(he*a-N*$)>Kd)||!g)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var ce=n-v,_e=c-S,Ze=a*a+N*N,nt=ce*ce+_e*_e,Ke=Math.sqrt(Ze),st=Math.sqrt(oe),ht=g*Math.tan((Av-Math.acos((Ze+oe-nt)/(2*Ke*st)))/2),xt=ht/st,zt=ht/Ke;Math.abs(xt-1)>Kd&&(this._+="L"+(t+xt*$)+","+(e+xt*he)),this._+="A"+g+","+g+",0,0,"+ +(he*ce>$*_e)+","+(this._x1=t+zt*a)+","+(this._y1=e+zt*N)}},arc:function(t,e,n,c,g,v){t=+t,e=+e,n=+n,v=!!v;var S=n*Math.cos(c),a=n*Math.sin(c),N=t+S,$=e+a,he=1^v,oe=v?c-g:g-c;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+N+","+$:(Math.abs(this._x1-N)>Kd||Math.abs(this._y1-$)>Kd)&&(this._+="L"+N+","+$),n&&(oe<0&&(oe=oe%fv+fv),oe>XB?this._+="A"+n+","+n+",0,1,"+he+","+(t-S)+","+(e-a)+"A"+n+","+n+",0,1,"+he+","+(this._x1=N)+","+(this._y1=$):oe>Kd&&(this._+="A"+n+","+n+",0,"+ +(oe>=Av)+","+he+","+(this._x1=t+n*Math.cos(g))+","+(this._y1=e+n*Math.sin(g))))},rect:function(t,e,n,c){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +c+"h"+-n+"Z"},toString:function(){return this._}};function YB(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function N_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,c=t.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+t.slice(n+1)]}function Im(t){return t=N_(Math.abs(t)),t?t[1]:NaN}function KB(t,e){return function(n,c){for(var g=n.length,v=[],S=0,a=t[0],N=0;g>0&&a>0&&(N+a+1>c&&(a=Math.max(1,c-N)),v.push(n.substring(g-=a,g+a)),!((N+=a+1)>c));)a=t[S=(S+1)%t.length];return v.reverse().join(e)}}function JB(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var ez=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function V_(t){if(!(e=ez.exec(t)))throw new Error("invalid format: "+t);var e;return new n2({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}V_.prototype=n2.prototype;function n2(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}n2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function tz(t){e:for(var e=t.length,n=1,c=-1,g;n<e;++n)switch(t[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+t[n])break e;c>0&&(c=0);break}return c>0?t.slice(0,c)+t.slice(g+1):t}var W4;function iz(t,e){var n=N_(t,e);if(!n)return t+"";var c=n[0],g=n[1],v=g-(W4=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,S=c.length;return v===S?c:v>S?c+new Array(v-S+1).join("0"):v>0?c.slice(0,v)+"."+c.slice(v):"0."+new Array(1-v).join("0")+N_(t,Math.max(0,e+v-1))[0]}function Cb(t,e){var n=N_(t,e);if(!n)return t+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const Tb={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:YB,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Cb(t*100,e),r:Cb,s:iz,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function kb(t){return t}var Mb=Array.prototype.map,Pb=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function nz(t){var e=t.grouping===void 0||t.thousands===void 0?kb:KB(Mb.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",c=t.currency===void 0?"":t.currency[1]+"",g=t.decimal===void 0?".":t.decimal+"",v=t.numerals===void 0?kb:JB(Mb.call(t.numerals,String)),S=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",N=t.nan===void 0?"NaN":t.nan+"";function $(oe){oe=V_(oe);var ce=oe.fill,_e=oe.align,Ze=oe.sign,nt=oe.symbol,Ke=oe.zero,st=oe.width,ht=oe.comma,xt=oe.precision,zt=oe.trim,Mt=oe.type;Mt==="n"?(ht=!0,Mt="g"):Tb[Mt]||(xt===void 0&&(xt=12),zt=!0,Mt="g"),(Ke||ce==="0"&&_e==="=")&&(Ke=!0,ce="0",_e="=");var Ue=nt==="$"?n:nt==="#"&&/[boxX]/.test(Mt)?"0"+Mt.toLowerCase():"",$t=nt==="$"?c:/[%p]/.test(Mt)?S:"",rt=Tb[Mt],gt=/[defgprs%]/.test(Mt);xt=xt===void 0?6:/[gprs]/.test(Mt)?Math.max(1,Math.min(21,xt)):Math.max(0,Math.min(20,xt));function At(yt){var St=Ue,ut=$t,Ye,_t,ct;if(Mt==="c")ut=rt(yt)+ut,yt="";else{yt=+yt;var Ut=yt<0||1/yt<0;if(yt=isNaN(yt)?N:rt(Math.abs(yt),xt),zt&&(yt=tz(yt)),Ut&&+yt==0&&Ze!=="+"&&(Ut=!1),St=(Ut?Ze==="("?Ze:a:Ze==="-"||Ze==="("?"":Ze)+St,ut=(Mt==="s"?Pb[8+W4/3]:"")+ut+(Ut&&Ze==="("?")":""),gt){for(Ye=-1,_t=yt.length;++Ye<_t;)if(ct=yt.charCodeAt(Ye),48>ct||ct>57){ut=(ct===46?g+yt.slice(Ye+1):yt.slice(Ye))+ut,yt=yt.slice(0,Ye);break}}}ht&&!Ke&&(yt=e(yt,1/0));var Ft=St.length+yt.length+ut.length,Vt=Ft<st?new Array(st-Ft+1).join(ce):"";switch(ht&&Ke&&(yt=e(Vt+yt,Vt.length?st-ut.length:1/0),Vt=""),_e){case"<":yt=St+yt+ut+Vt;break;case"=":yt=St+Vt+yt+ut;break;case"^":yt=Vt.slice(0,Ft=Vt.length>>1)+St+yt+ut+Vt.slice(Ft);break;default:yt=Vt+St+yt+ut;break}return v(yt)}return At.toString=function(){return oe+""},At}function he(oe,ce){var _e=$((oe=V_(oe),oe.type="f",oe)),Ze=Math.max(-8,Math.min(8,Math.floor(Im(ce)/3)))*3,nt=Math.pow(10,-Ze),Ke=Pb[8+Ze/3];return function(st){return _e(nt*st)+Ke}}return{format:$,formatPrefix:he}}var i_,r2,$4;rz({thousands:",",grouping:[3],currency:["$",""]});function rz(t){return i_=nz(t),r2=i_.format,$4=i_.formatPrefix,i_}function sz(t){return Math.max(0,-Im(Math.abs(t)))}function az(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Im(e)/3)))*3-Im(Math.abs(t)))}function oz(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Im(e)-Im(t))+1}function lz(t){var e=0,n=t.children,c=n&&n.length;if(!c)e=1;else for(;--c>=0;)e+=n[c].value;t.value=e}function uz(){return this.eachAfter(lz)}function cz(t,e){let n=-1;for(const c of this)t.call(e,c,++n,this);return this}function hz(t,e){for(var n=this,c=[n],g,v,S=-1;n=c.pop();)if(t.call(e,n,++S,this),g=n.children)for(v=g.length-1;v>=0;--v)c.push(g[v]);return this}function Az(t,e){for(var n=this,c=[n],g=[],v,S,a,N=-1;n=c.pop();)if(g.push(n),v=n.children)for(S=0,a=v.length;S<a;++S)c.push(v[S]);for(;n=g.pop();)t.call(e,n,++N,this);return this}function fz(t,e){let n=-1;for(const c of this)if(t.call(e,c,++n,this))return c}function dz(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,c=e.children,g=c&&c.length;--g>=0;)n+=c[g].value;e.value=n})}function pz(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function mz(t){for(var e=this,n=gz(e,t),c=[e];e!==n;)e=e.parent,c.push(e);for(var g=c.length;t!==n;)c.splice(g,0,t),t=t.parent;return c}function gz(t,e){if(t===e)return t;var n=t.ancestors(),c=e.ancestors(),g=null;for(t=n.pop(),e=c.pop();t===e;)g=t,t=n.pop(),e=c.pop();return g}function _z(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function yz(){return Array.from(this)}function vz(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function xz(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*bz(){var t=this,e,n=[t],c,g,v;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,c=t.children)for(g=0,v=c.length;g<v;++g)n.push(c[g]);while(n.length)}function rp(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=Iz)):e===void 0&&(e=Sz);for(var n=new U_(t),c,g=[n],v,S,a,N;c=g.pop();)if((S=e(c.data))&&(N=(S=Array.from(S)).length))for(c.children=S,a=N-1;a>=0;--a)g.push(v=S[a]=new U_(S[a])),v.parent=c,v.depth=c.depth+1;return n.eachBefore(Cz)}function wz(){return rp(this).eachBefore(Ez)}function Sz(t){return t.children}function Iz(t){return Array.isArray(t)?t[1]:null}function Ez(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Cz(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function U_(t){this.data=t,this.depth=this.height=0,this.parent=null}U_.prototype=rp.prototype={constructor:U_,count:uz,each:cz,eachAfter:Az,eachBefore:hz,find:fz,sum:dz,sort:pz,path:mz,ancestors:_z,descendants:yz,leaves:vz,links:xz,copy:wz,[Symbol.iterator]:bz};function Tz(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function kz(t){return function(){return t}}function Mz(t){return+t}var Db=[0,1];function um(t){return t}function pv(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:kz(isNaN(e)?NaN:.5)}function Pz(t,e){var n;return t>e&&(n=t,t=e,e=n),function(c){return Math.max(t,Math.min(e,c))}}function Dz(t,e,n){var c=t[0],g=t[1],v=e[0],S=e[1];return g<c?(c=pv(g,c),v=n(S,v)):(c=pv(c,g),v=n(v,S)),function(a){return v(c(a))}}function Lz(t,e,n){var c=Math.min(t.length,e.length)-1,g=new Array(c),v=new Array(c),S=-1;for(t[c]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++S<c;)g[S]=pv(t[S],t[S+1]),v[S]=n(e[S],e[S+1]);return function(a){var N=aP(t,a,1,c)-1;return v[N](g[N](a))}}function Bz(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function zz(){var t=Db,e=Db,n=o1,c,g,v,S=um,a,N,$;function he(){var ce=Math.min(t.length,e.length);return S!==um&&(S=Pz(t[0],t[ce-1])),a=ce>2?Lz:Dz,N=$=null,oe}function oe(ce){return ce==null||isNaN(ce=+ce)?v:(N||(N=a(t.map(c),e,n)))(c(S(ce)))}return oe.invert=function(ce){return S(g(($||($=a(e,t.map(c),AA)))(ce)))},oe.domain=function(ce){return arguments.length?(t=Array.from(ce,Mz),he()):t.slice()},oe.range=function(ce){return arguments.length?(e=Array.from(ce),he()):e.slice()},oe.rangeRound=function(ce){return e=Array.from(ce),n=yL,he()},oe.clamp=function(ce){return arguments.length?(S=ce?!0:um,he()):S!==um},oe.interpolate=function(ce){return arguments.length?(n=ce,he()):n},oe.unknown=function(ce){return arguments.length?(v=ce,oe):v},function(ce,_e){return c=ce,g=_e,he()}}function Rz(){return zz()(um,um)}function Fz(t,e,n,c){var g=lP(t,e,n),v;switch(c=V_(c??",f"),c.type){case"s":{var S=Math.max(Math.abs(t),Math.abs(e));return c.precision==null&&!isNaN(v=az(g,S))&&(c.precision=v),$4(c,S)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(v=oz(g,Math.max(Math.abs(t),Math.abs(e))))&&(c.precision=v-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(v=sz(g))&&(c.precision=v-(c.type==="%")*2);break}}return r2(c)}function Oz(t){var e=t.domain;return t.ticks=function(n){var c=e();return oP(c[0],c[c.length-1],n??10)},t.tickFormat=function(n,c){var g=e();return Fz(g[0],g[g.length-1],n??10,c)},t.nice=function(n){n==null&&(n=10);var c=e(),g=0,v=c.length-1,S=c[g],a=c[v],N,$,he=10;for(a<S&&($=S,S=a,a=$,$=g,g=v,v=$);he-- >0;){if($=y4(S,a,n),$===N)return c[g]=S,c[v]=a,e(c);if($>0)S=Math.floor(S/$)*$,a=Math.ceil(a/$)*$;else if($<0)S=Math.ceil(S*$)/$,a=Math.floor(a*$)/$;else break;N=$}return t},t}function X4(){var t=Rz();return t.copy=function(){return Bz(t,X4())},Tz.apply(t,arguments),Oz(t)}var iy=new Date,ny=new Date;function p0(t,e,n,c){function g(v){return t(v=arguments.length===0?new Date:new Date(+v)),v}return g.floor=function(v){return t(v=new Date(+v)),v},g.ceil=function(v){return t(v=new Date(v-1)),e(v,1),t(v),v},g.round=function(v){var S=g(v),a=g.ceil(v);return v-S<a-v?S:a},g.offset=function(v,S){return e(v=new Date(+v),S==null?1:Math.floor(S)),v},g.range=function(v,S,a){var N=[],$;if(v=g.ceil(v),a=a==null?1:Math.floor(a),!(v<S)||!(a>0))return N;do N.push($=new Date(+v)),e(v,a),t(v);while($<v&&v<S);return N},g.filter=function(v){return p0(function(S){if(S>=S)for(;t(S),!v(S);)S.setTime(S-1)},function(S,a){if(S>=S)if(a<0)for(;++a<=0;)for(;e(S,-1),!v(S););else for(;--a>=0;)for(;e(S,1),!v(S););})},n&&(g.count=function(v,S){return iy.setTime(+v),ny.setTime(+S),t(iy),t(ny),Math.floor(n(iy,ny))},g.every=function(v){return v=Math.floor(v),!isFinite(v)||!(v>0)?null:v>1?g.filter(c?function(S){return c(S)%v===0}:function(S){return g.count(0,S)%v===0}):g}),g}const Nz=1e3,s2=Nz*60,Vz=s2*60,a2=Vz*24,Y4=a2*7;var o2=p0(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*s2)/a2,t=>t.getDate()-1);o2.range;function gp(t){return p0(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*s2)/Y4})}var K4=gp(0),G_=gp(1),Uz=gp(2),Gz=gp(3),Em=gp(4),qz=gp(5),Hz=gp(6);K4.range;G_.range;Uz.range;Gz.range;Em.range;qz.range;Hz.range;var Ap=p0(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Ap.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:p0(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};Ap.range;var l2=p0(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/a2},function(t){return t.getUTCDate()-1});l2.range;function _p(t){return p0(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/Y4})}var J4=_p(0),q_=_p(1),jz=_p(2),Zz=_p(3),Cm=_p(4),Qz=_p(5),Wz=_p(6);J4.range;q_.range;jz.range;Zz.range;Cm.range;Qz.range;Wz.range;var fp=p0(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});fp.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:p0(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};fp.range;function ry(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function sy(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function eg(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function $z(t){var e=t.dateTime,n=t.date,c=t.time,g=t.periods,v=t.days,S=t.shortDays,a=t.months,N=t.shortMonths,$=tg(g),he=ig(g),oe=tg(v),ce=ig(v),_e=tg(S),Ze=ig(S),nt=tg(a),Ke=ig(a),st=tg(N),ht=ig(N),xt={a:Ut,A:Ft,b:Vt,B:yi,c:null,d:Ob,e:Ob,f:_R,g:TR,G:MR,H:pR,I:mR,j:gR,L:eS,m:yR,M:vR,p:Ci,q:ki,Q:Ub,s:Gb,S:xR,u:bR,U:wR,V:SR,w:IR,W:ER,x:null,X:null,y:CR,Y:kR,Z:PR,"%":Vb},zt={a:Ni,A:tn,b:Zi,B:Gi,c:null,d:Nb,e:Nb,f:zR,g:jR,G:QR,H:DR,I:LR,j:BR,L:iS,m:RR,M:FR,p:sn,q:xn,Q:Ub,s:Gb,S:OR,u:NR,U:VR,V:UR,w:GR,W:qR,x:null,X:null,y:HR,Y:ZR,Z:WR,"%":Vb},Mt={a:At,A:yt,b:St,B:ut,c:Ye,d:Rb,e:Rb,f:hR,g:zb,G:Bb,H:Fb,I:Fb,j:oR,L:cR,m:aR,M:lR,p:gt,q:sR,Q:fR,s:dR,S:uR,u:eR,U:tR,V:iR,w:Jz,W:nR,x:_t,X:ct,y:zb,Y:Bb,Z:rR,"%":AR};xt.x=Ue(n,xt),xt.X=Ue(c,xt),xt.c=Ue(e,xt),zt.x=Ue(n,zt),zt.X=Ue(c,zt),zt.c=Ue(e,zt);function Ue(Ti,gi){return function(Oi){var Vi=[],bn=-1,wn=0,xi=Ti.length,Bn,Ot,an;for(Oi instanceof Date||(Oi=new Date(+Oi));++bn<xi;)Ti.charCodeAt(bn)===37&&(Vi.push(Ti.slice(wn,bn)),(Ot=Lb[Bn=Ti.charAt(++bn)])!=null?Bn=Ti.charAt(++bn):Ot=Bn==="e"?" ":"0",(an=gi[Bn])&&(Bn=an(Oi,Ot)),Vi.push(Bn),wn=bn+1);return Vi.push(Ti.slice(wn,bn)),Vi.join("")}}function $t(Ti,gi){return function(Oi){var Vi=eg(1900,void 0,1),bn=rt(Vi,Ti,Oi+="",0),wn,xi;if(bn!=Oi.length)return null;if("Q"in Vi)return new Date(Vi.Q);if("s"in Vi)return new Date(Vi.s*1e3+("L"in Vi?Vi.L:0));if(gi&&!("Z"in Vi)&&(Vi.Z=0),"p"in Vi&&(Vi.H=Vi.H%12+Vi.p*12),Vi.m===void 0&&(Vi.m="q"in Vi?Vi.q:0),"V"in Vi){if(Vi.V<1||Vi.V>53)return null;"w"in Vi||(Vi.w=1),"Z"in Vi?(wn=sy(eg(Vi.y,0,1)),xi=wn.getUTCDay(),wn=xi>4||xi===0?q_.ceil(wn):q_(wn),wn=l2.offset(wn,(Vi.V-1)*7),Vi.y=wn.getUTCFullYear(),Vi.m=wn.getUTCMonth(),Vi.d=wn.getUTCDate()+(Vi.w+6)%7):(wn=ry(eg(Vi.y,0,1)),xi=wn.getDay(),wn=xi>4||xi===0?G_.ceil(wn):G_(wn),wn=o2.offset(wn,(Vi.V-1)*7),Vi.y=wn.getFullYear(),Vi.m=wn.getMonth(),Vi.d=wn.getDate()+(Vi.w+6)%7)}else("W"in Vi||"U"in Vi)&&("w"in Vi||(Vi.w="u"in Vi?Vi.u%7:"W"in Vi?1:0),xi="Z"in Vi?sy(eg(Vi.y,0,1)).getUTCDay():ry(eg(Vi.y,0,1)).getDay(),Vi.m=0,Vi.d="W"in Vi?(Vi.w+6)%7+Vi.W*7-(xi+5)%7:Vi.w+Vi.U*7-(xi+6)%7);return"Z"in Vi?(Vi.H+=Vi.Z/100|0,Vi.M+=Vi.Z%100,sy(Vi)):ry(Vi)}}function rt(Ti,gi,Oi,Vi){for(var bn=0,wn=gi.length,xi=Oi.length,Bn,Ot;bn<wn;){if(Vi>=xi)return-1;if(Bn=gi.charCodeAt(bn++),Bn===37){if(Bn=gi.charAt(bn++),Ot=Mt[Bn in Lb?gi.charAt(bn++):Bn],!Ot||(Vi=Ot(Ti,Oi,Vi))<0)return-1}else if(Bn!=Oi.charCodeAt(Vi++))return-1}return Vi}function gt(Ti,gi,Oi){var Vi=$.exec(gi.slice(Oi));return Vi?(Ti.p=he.get(Vi[0].toLowerCase()),Oi+Vi[0].length):-1}function At(Ti,gi,Oi){var Vi=_e.exec(gi.slice(Oi));return Vi?(Ti.w=Ze.get(Vi[0].toLowerCase()),Oi+Vi[0].length):-1}function yt(Ti,gi,Oi){var Vi=oe.exec(gi.slice(Oi));return Vi?(Ti.w=ce.get(Vi[0].toLowerCase()),Oi+Vi[0].length):-1}function St(Ti,gi,Oi){var Vi=st.exec(gi.slice(Oi));return Vi?(Ti.m=ht.get(Vi[0].toLowerCase()),Oi+Vi[0].length):-1}function ut(Ti,gi,Oi){var Vi=nt.exec(gi.slice(Oi));return Vi?(Ti.m=Ke.get(Vi[0].toLowerCase()),Oi+Vi[0].length):-1}function Ye(Ti,gi,Oi){return rt(Ti,e,gi,Oi)}function _t(Ti,gi,Oi){return rt(Ti,n,gi,Oi)}function ct(Ti,gi,Oi){return rt(Ti,c,gi,Oi)}function Ut(Ti){return S[Ti.getDay()]}function Ft(Ti){return v[Ti.getDay()]}function Vt(Ti){return N[Ti.getMonth()]}function yi(Ti){return a[Ti.getMonth()]}function Ci(Ti){return g[+(Ti.getHours()>=12)]}function ki(Ti){return 1+~~(Ti.getMonth()/3)}function Ni(Ti){return S[Ti.getUTCDay()]}function tn(Ti){return v[Ti.getUTCDay()]}function Zi(Ti){return N[Ti.getUTCMonth()]}function Gi(Ti){return a[Ti.getUTCMonth()]}function sn(Ti){return g[+(Ti.getUTCHours()>=12)]}function xn(Ti){return 1+~~(Ti.getUTCMonth()/3)}return{format:function(Ti){var gi=Ue(Ti+="",xt);return gi.toString=function(){return Ti},gi},parse:function(Ti){var gi=$t(Ti+="",!1);return gi.toString=function(){return Ti},gi},utcFormat:function(Ti){var gi=Ue(Ti+="",zt);return gi.toString=function(){return Ti},gi},utcParse:function(Ti){var gi=$t(Ti+="",!0);return gi.toString=function(){return Ti},gi}}}var Lb={"-":"",_:" ",0:"0"},Fu=/^\s*\d+/,Xz=/^%/,Yz=/[\\^$*+?|[\]().{}]/g;function qa(t,e,n){var c=t<0?"-":"",g=(c?-t:t)+"",v=g.length;return c+(v<n?new Array(n-v+1).join(e)+g:g)}function Kz(t){return t.replace(Yz,"\\$&")}function tg(t){return new RegExp("^(?:"+t.map(Kz).join("|")+")","i")}function ig(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Jz(t,e,n){var c=Fu.exec(e.slice(n,n+1));return c?(t.w=+c[0],n+c[0].length):-1}function eR(t,e,n){var c=Fu.exec(e.slice(n,n+1));return c?(t.u=+c[0],n+c[0].length):-1}function tR(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.U=+c[0],n+c[0].length):-1}function iR(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.V=+c[0],n+c[0].length):-1}function nR(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.W=+c[0],n+c[0].length):-1}function Bb(t,e,n){var c=Fu.exec(e.slice(n,n+4));return c?(t.y=+c[0],n+c[0].length):-1}function zb(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.y=+c[0]+(+c[0]>68?1900:2e3),n+c[0].length):-1}function rR(t,e,n){var c=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return c?(t.Z=c[1]?0:-(c[2]+(c[3]||"00")),n+c[0].length):-1}function sR(t,e,n){var c=Fu.exec(e.slice(n,n+1));return c?(t.q=c[0]*3-3,n+c[0].length):-1}function aR(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.m=c[0]-1,n+c[0].length):-1}function Rb(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.d=+c[0],n+c[0].length):-1}function oR(t,e,n){var c=Fu.exec(e.slice(n,n+3));return c?(t.m=0,t.d=+c[0],n+c[0].length):-1}function Fb(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.H=+c[0],n+c[0].length):-1}function lR(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.M=+c[0],n+c[0].length):-1}function uR(t,e,n){var c=Fu.exec(e.slice(n,n+2));return c?(t.S=+c[0],n+c[0].length):-1}function cR(t,e,n){var c=Fu.exec(e.slice(n,n+3));return c?(t.L=+c[0],n+c[0].length):-1}function hR(t,e,n){var c=Fu.exec(e.slice(n,n+6));return c?(t.L=Math.floor(c[0]/1e3),n+c[0].length):-1}function AR(t,e,n){var c=Xz.exec(e.slice(n,n+1));return c?n+c[0].length:-1}function fR(t,e,n){var c=Fu.exec(e.slice(n));return c?(t.Q=+c[0],n+c[0].length):-1}function dR(t,e,n){var c=Fu.exec(e.slice(n));return c?(t.s=+c[0],n+c[0].length):-1}function Ob(t,e){return qa(t.getDate(),e,2)}function pR(t,e){return qa(t.getHours(),e,2)}function mR(t,e){return qa(t.getHours()%12||12,e,2)}function gR(t,e){return qa(1+o2.count(Ap(t),t),e,3)}function eS(t,e){return qa(t.getMilliseconds(),e,3)}function _R(t,e){return eS(t,e)+"000"}function yR(t,e){return qa(t.getMonth()+1,e,2)}function vR(t,e){return qa(t.getMinutes(),e,2)}function xR(t,e){return qa(t.getSeconds(),e,2)}function bR(t){var e=t.getDay();return e===0?7:e}function wR(t,e){return qa(K4.count(Ap(t)-1,t),e,2)}function tS(t){var e=t.getDay();return e>=4||e===0?Em(t):Em.ceil(t)}function SR(t,e){return t=tS(t),qa(Em.count(Ap(t),t)+(Ap(t).getDay()===4),e,2)}function IR(t){return t.getDay()}function ER(t,e){return qa(G_.count(Ap(t)-1,t),e,2)}function CR(t,e){return qa(t.getFullYear()%100,e,2)}function TR(t,e){return t=tS(t),qa(t.getFullYear()%100,e,2)}function kR(t,e){return qa(t.getFullYear()%1e4,e,4)}function MR(t,e){var n=t.getDay();return t=n>=4||n===0?Em(t):Em.ceil(t),qa(t.getFullYear()%1e4,e,4)}function PR(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+qa(e/60|0,"0",2)+qa(e%60,"0",2)}function Nb(t,e){return qa(t.getUTCDate(),e,2)}function DR(t,e){return qa(t.getUTCHours(),e,2)}function LR(t,e){return qa(t.getUTCHours()%12||12,e,2)}function BR(t,e){return qa(1+l2.count(fp(t),t),e,3)}function iS(t,e){return qa(t.getUTCMilliseconds(),e,3)}function zR(t,e){return iS(t,e)+"000"}function RR(t,e){return qa(t.getUTCMonth()+1,e,2)}function FR(t,e){return qa(t.getUTCMinutes(),e,2)}function OR(t,e){return qa(t.getUTCSeconds(),e,2)}function NR(t){var e=t.getUTCDay();return e===0?7:e}function VR(t,e){return qa(J4.count(fp(t)-1,t),e,2)}function nS(t){var e=t.getUTCDay();return e>=4||e===0?Cm(t):Cm.ceil(t)}function UR(t,e){return t=nS(t),qa(Cm.count(fp(t),t)+(fp(t).getUTCDay()===4),e,2)}function GR(t){return t.getUTCDay()}function qR(t,e){return qa(q_.count(fp(t)-1,t),e,2)}function HR(t,e){return qa(t.getUTCFullYear()%100,e,2)}function jR(t,e){return t=nS(t),qa(t.getUTCFullYear()%100,e,2)}function ZR(t,e){return qa(t.getUTCFullYear()%1e4,e,4)}function QR(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Cm(t):Cm.ceil(t),qa(t.getUTCFullYear()%1e4,e,4)}function WR(){return"+0000"}function Vb(){return"%"}function Ub(t){return+t}function Gb(t){return Math.floor(+t/1e3)}var im,rS;$R({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function $R(t){return im=$z(t),im.format,rS=im.parse,im.utcFormat,im.utcParse,im}function nm(t){return function(){return t}}function XR(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function sS(t){this._context=t}sS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function YR(t){return new sS(t)}function KR(t){return t[0]}function JR(t){return t[1]}function mv(t,e){var n=nm(!0),c=null,g=YR,v=null;t=typeof t=="function"?t:t===void 0?KR:nm(t),e=typeof e=="function"?e:e===void 0?JR:nm(e);function S(a){var N,$=(a=XR(a)).length,he,oe=!1,ce;for(c==null&&(v=g(ce=Q4())),N=0;N<=$;++N)!(N<$&&n(he=a[N],N,a))===oe&&((oe=!oe)?v.lineStart():v.lineEnd()),oe&&v.point(+t(he,N,a),+e(he,N,a));if(ce)return v=null,ce+""||null}return S.x=function(a){return arguments.length?(t=typeof a=="function"?a:nm(+a),S):t},S.y=function(a){return arguments.length?(e=typeof a=="function"?a:nm(+a),S):e},S.defined=function(a){return arguments.length?(n=typeof a=="function"?a:nm(!!a),S):n},S.curve=function(a){return arguments.length?(g=a,c!=null&&(v=g(c)),S):g},S.context=function(a){return arguments.length?(a==null?c=v=null:v=g(c=a),S):c},S}function qb(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function aS(t){this._context=t}aS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:qb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:qb(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Hb(t){return new aS(t)}function oS(t,e){this._context=t,this._t=e}oS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function e7(t){return new oS(t,0)}const n_=t=>()=>t;function t7(t,{sourceEvent:e,target:n,transform:c,dispatch:g}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:c,enumerable:!0,configurable:!0},_:{value:g}})}function a0(t,e,n){this.k=t,this.x=e,this.y=n}a0.prototype={constructor:a0,scale:function(t){return t===1?this:new a0(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new a0(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var lS=new a0(1,0,0);a0.prototype;function ay(t){t.stopImmediatePropagation()}function ng(t){t.preventDefault(),t.stopImmediatePropagation()}function i7(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function n7(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function jb(){return this.__zoom||lS}function r7(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function s7(){return navigator.maxTouchPoints||"ontouchstart"in this}function a7(t,e,n){var c=t.invertX(e[0][0])-n[0][0],g=t.invertX(e[1][0])-n[1][0],v=t.invertY(e[0][1])-n[0][1],S=t.invertY(e[1][1])-n[1][1];return t.translate(g>c?(c+g)/2:Math.min(0,c)||Math.max(0,g),S>v?(v+S)/2:Math.min(0,v)||Math.max(0,S))}function o7(){var t=i7,e=n7,n=a7,c=r7,g=s7,v=[0,1/0],S=[[-1/0,-1/0],[1/0,1/0]],a=250,N=CL,$=s1("start","zoom","end"),he,oe,ce,_e=500,Ze=150,nt=0,Ke=10;function st(Ye){Ye.property("__zoom",jb).on("wheel.zoom",rt).on("mousedown.zoom",gt).on("dblclick.zoom",At).filter(g).on("touchstart.zoom",yt).on("touchmove.zoom",St).on("touchend.zoom touchcancel.zoom",ut).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}st.transform=function(Ye,_t,ct,Ut){var Ft=Ye.selection?Ye.selection():Ye;Ft.property("__zoom",jb),Ye!==Ft?Mt(Ye,_t,ct,Ut):Ft.interrupt().each(function(){Ue(this,arguments).event(Ut).start().zoom(null,typeof _t=="function"?_t.apply(this,arguments):_t).end()})},st.scaleBy=function(Ye,_t,ct,Ut){st.scaleTo(Ye,function(){var Ft=this.__zoom.k,Vt=typeof _t=="function"?_t.apply(this,arguments):_t;return Ft*Vt},ct,Ut)},st.scaleTo=function(Ye,_t,ct,Ut){st.transform(Ye,function(){var Ft=e.apply(this,arguments),Vt=this.__zoom,yi=ct==null?zt(Ft):typeof ct=="function"?ct.apply(this,arguments):ct,Ci=Vt.invert(yi),ki=typeof _t=="function"?_t.apply(this,arguments):_t;return n(xt(ht(Vt,ki),yi,Ci),Ft,S)},ct,Ut)},st.translateBy=function(Ye,_t,ct,Ut){st.transform(Ye,function(){return n(this.__zoom.translate(typeof _t=="function"?_t.apply(this,arguments):_t,typeof ct=="function"?ct.apply(this,arguments):ct),e.apply(this,arguments),S)},null,Ut)},st.translateTo=function(Ye,_t,ct,Ut,Ft){st.transform(Ye,function(){var Vt=e.apply(this,arguments),yi=this.__zoom,Ci=Ut==null?zt(Vt):typeof Ut=="function"?Ut.apply(this,arguments):Ut;return n(lS.translate(Ci[0],Ci[1]).scale(yi.k).translate(typeof _t=="function"?-_t.apply(this,arguments):-_t,typeof ct=="function"?-ct.apply(this,arguments):-ct),Vt,S)},Ut,Ft)};function ht(Ye,_t){return _t=Math.max(v[0],Math.min(v[1],_t)),_t===Ye.k?Ye:new a0(_t,Ye.x,Ye.y)}function xt(Ye,_t,ct){var Ut=_t[0]-ct[0]*Ye.k,Ft=_t[1]-ct[1]*Ye.k;return Ut===Ye.x&&Ft===Ye.y?Ye:new a0(Ye.k,Ut,Ft)}function zt(Ye){return[(+Ye[0][0]+ +Ye[1][0])/2,(+Ye[0][1]+ +Ye[1][1])/2]}function Mt(Ye,_t,ct,Ut){Ye.on("start.zoom",function(){Ue(this,arguments).event(Ut).start()}).on("interrupt.zoom end.zoom",function(){Ue(this,arguments).event(Ut).end()}).tween("zoom",function(){var Ft=this,Vt=arguments,yi=Ue(Ft,Vt).event(Ut),Ci=e.apply(Ft,Vt),ki=ct==null?zt(Ci):typeof ct=="function"?ct.apply(Ft,Vt):ct,Ni=Math.max(Ci[1][0]-Ci[0][0],Ci[1][1]-Ci[0][1]),tn=Ft.__zoom,Zi=typeof _t=="function"?_t.apply(Ft,Vt):_t,Gi=N(tn.invert(ki).concat(Ni/tn.k),Zi.invert(ki).concat(Ni/Zi.k));return function(sn){if(sn===1)sn=Zi;else{var xn=Gi(sn),Ti=Ni/xn[2];sn=new a0(Ti,ki[0]-xn[0]*Ti,ki[1]-xn[1]*Ti)}yi.zoom(null,sn)}})}function Ue(Ye,_t,ct){return!ct&&Ye.__zooming||new $t(Ye,_t)}function $t(Ye,_t){this.that=Ye,this.args=_t,this.active=0,this.sourceEvent=null,this.extent=e.apply(Ye,_t),this.taps=0}$t.prototype={event:function(Ye){return Ye&&(this.sourceEvent=Ye),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(Ye,_t){return this.mouse&&Ye!=="mouse"&&(this.mouse[1]=_t.invert(this.mouse[0])),this.touch0&&Ye!=="touch"&&(this.touch0[1]=_t.invert(this.touch0[0])),this.touch1&&Ye!=="touch"&&(this.touch1[1]=_t.invert(this.touch1[0])),this.that.__zoom=_t,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(Ye){var _t=pl(this.that).datum();$.call(Ye,this.that,new t7(Ye,{sourceEvent:this.sourceEvent,target:st,type:Ye,transform:this.that.__zoom,dispatch:$}),_t)}};function rt(Ye,..._t){if(!t.apply(this,arguments))return;var ct=Ue(this,_t).event(Ye),Ut=this.__zoom,Ft=Math.max(v[0],Math.min(v[1],Ut.k*Math.pow(2,c.apply(this,arguments)))),Vt=n0(Ye);if(ct.wheel)(ct.mouse[0][0]!==Vt[0]||ct.mouse[0][1]!==Vt[1])&&(ct.mouse[1]=Ut.invert(ct.mouse[0]=Vt)),clearTimeout(ct.wheel);else{if(Ut.k===Ft)return;ct.mouse=[Vt,Ut.invert(Vt)],_m(this),ct.start()}ng(Ye),ct.wheel=setTimeout(yi,Ze),ct.zoom("mouse",n(xt(ht(Ut,Ft),ct.mouse[0],ct.mouse[1]),ct.extent,S));function yi(){ct.wheel=null,ct.end()}}function gt(Ye,..._t){if(ce||!t.apply(this,arguments))return;var ct=Ue(this,_t,!0).event(Ye),Ut=pl(Ye.view).on("mousemove.zoom",ki,!0).on("mouseup.zoom",Ni,!0),Ft=n0(Ye,Vt),Vt=Ye.currentTarget,yi=Ye.clientX,Ci=Ye.clientY;D4(Ye.view),ay(Ye),ct.mouse=[Ft,this.__zoom.invert(Ft)],_m(this),ct.start();function ki(tn){if(ng(tn),!ct.moved){var Zi=tn.clientX-yi,Gi=tn.clientY-Ci;ct.moved=Zi*Zi+Gi*Gi>nt}ct.event(tn).zoom("mouse",n(xt(ct.that.__zoom,ct.mouse[0]=n0(tn,Vt),ct.mouse[1]),ct.extent,S))}function Ni(tn){Ut.on("mousemove.zoom mouseup.zoom",null),L4(tn.view,ct.moved),ng(tn),ct.event(tn).end()}}function At(Ye,..._t){if(t.apply(this,arguments)){var ct=this.__zoom,Ut=n0(Ye.changedTouches?Ye.changedTouches[0]:Ye,this),Ft=ct.invert(Ut),Vt=ct.k*(Ye.shiftKey?.5:2),yi=n(xt(ht(ct,Vt),Ut,Ft),e.apply(this,_t),S);ng(Ye),a>0?pl(this).transition().duration(a).call(Mt,yi,Ut,Ye):pl(this).call(st.transform,yi,Ut,Ye)}}function yt(Ye,..._t){if(t.apply(this,arguments)){var ct=Ye.touches,Ut=ct.length,Ft=Ue(this,_t,Ye.changedTouches.length===Ut).event(Ye),Vt,yi,Ci,ki;for(ay(Ye),yi=0;yi<Ut;++yi)Ci=ct[yi],ki=n0(Ci,this),ki=[ki,this.__zoom.invert(ki),Ci.identifier],Ft.touch0?!Ft.touch1&&Ft.touch0[2]!==ki[2]&&(Ft.touch1=ki,Ft.taps=0):(Ft.touch0=ki,Vt=!0,Ft.taps=1+!!he);he&&(he=clearTimeout(he)),Vt&&(Ft.taps<2&&(oe=ki[0],he=setTimeout(function(){he=null},_e)),_m(this),Ft.start())}}function St(Ye,..._t){if(this.__zooming){var ct=Ue(this,_t).event(Ye),Ut=Ye.changedTouches,Ft=Ut.length,Vt,yi,Ci,ki;for(ng(Ye),Vt=0;Vt<Ft;++Vt)yi=Ut[Vt],Ci=n0(yi,this),ct.touch0&&ct.touch0[2]===yi.identifier?ct.touch0[0]=Ci:ct.touch1&&ct.touch1[2]===yi.identifier&&(ct.touch1[0]=Ci);if(yi=ct.that.__zoom,ct.touch1){var Ni=ct.touch0[0],tn=ct.touch0[1],Zi=ct.touch1[0],Gi=ct.touch1[1],sn=(sn=Zi[0]-Ni[0])*sn+(sn=Zi[1]-Ni[1])*sn,xn=(xn=Gi[0]-tn[0])*xn+(xn=Gi[1]-tn[1])*xn;yi=ht(yi,Math.sqrt(sn/xn)),Ci=[(Ni[0]+Zi[0])/2,(Ni[1]+Zi[1])/2],ki=[(tn[0]+Gi[0])/2,(tn[1]+Gi[1])/2]}else if(ct.touch0)Ci=ct.touch0[0],ki=ct.touch0[1];else return;ct.zoom("touch",n(xt(yi,Ci,ki),ct.extent,S))}}function ut(Ye,..._t){if(this.__zooming){var ct=Ue(this,_t).event(Ye),Ut=Ye.changedTouches,Ft=Ut.length,Vt,yi;for(ay(Ye),ce&&clearTimeout(ce),ce=setTimeout(function(){ce=null},_e),Vt=0;Vt<Ft;++Vt)yi=Ut[Vt],ct.touch0&&ct.touch0[2]===yi.identifier?delete ct.touch0:ct.touch1&&ct.touch1[2]===yi.identifier&&delete ct.touch1;if(ct.touch1&&!ct.touch0&&(ct.touch0=ct.touch1,delete ct.touch1),ct.touch0)ct.touch0[1]=this.__zoom.invert(ct.touch0[0]);else if(ct.end(),ct.taps===2&&(yi=n0(yi,this),Math.hypot(oe[0]-yi[0],oe[1]-yi[1])<Ke)){var Ci=pl(this).on("dblclick.zoom");Ci&&Ci.apply(this,arguments)}}}return st.wheelDelta=function(Ye){return arguments.length?(c=typeof Ye=="function"?Ye:n_(+Ye),st):c},st.filter=function(Ye){return arguments.length?(t=typeof Ye=="function"?Ye:n_(!!Ye),st):t},st.touchable=function(Ye){return arguments.length?(g=typeof Ye=="function"?Ye:n_(!!Ye),st):g},st.extent=function(Ye){return arguments.length?(e=typeof Ye=="function"?Ye:n_([[+Ye[0][0],+Ye[0][1]],[+Ye[1][0],+Ye[1][1]]]),st):e},st.scaleExtent=function(Ye){return arguments.length?(v[0]=+Ye[0],v[1]=+Ye[1],st):[v[0],v[1]]},st.translateExtent=function(Ye){return arguments.length?(S[0][0]=+Ye[0][0],S[1][0]=+Ye[1][0],S[0][1]=+Ye[0][1],S[1][1]=+Ye[1][1],st):[[S[0][0],S[0][1]],[S[1][0],S[1][1]]]},st.constrain=function(Ye){return arguments.length?(n=Ye,st):n},st.duration=function(Ye){return arguments.length?(a=+Ye,st):a},st.interpolate=function(Ye){return arguments.length?(N=Ye,st):N},st.on=function(){var Ye=$.on.apply($,arguments);return Ye===$?st:Ye},st.clickDistance=function(Ye){return arguments.length?(nt=(Ye=+Ye)*Ye,st):Math.sqrt(nt)},st.tapDistance=function(Ye){return arguments.length?(Ke=+Ye,st):Ke},st}var uS="1.13.6",Zb=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},c1=Array.prototype,u2=Object.prototype,Qb=typeof Symbol<"u"?Symbol.prototype:null,l7=c1.push,Ng=c1.slice,Tg=u2.toString,u7=u2.hasOwnProperty,cS=typeof ArrayBuffer<"u",c7=typeof DataView<"u",h7=Array.isArray,Wb=Object.keys,$b=Object.create,Xb=cS&&ArrayBuffer.isView,A7=isNaN,f7=isFinite,hS=!{toString:null}.propertyIsEnumerable("toString"),Yb=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],d7=Math.pow(2,53)-1;function Zc(t,e){return e=e==null?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),c=Array(n),g=0;g<n;g++)c[g]=arguments[g+e];switch(e){case 0:return t.call(this,c);case 1:return t.call(this,arguments[0],c);case 2:return t.call(this,arguments[0],arguments[1],c)}var v=Array(e+1);for(g=0;g<e;g++)v[g]=arguments[g];return v[e]=c,t.apply(this,v)}}function yp(t){var e=typeof t;return e==="function"||e==="object"&&!!t}function p7(t){return t===null}function dp(t){return t===void 0}function AS(t){return t===!0||t===!1||Tg.call(t)==="[object Boolean]"}function m7(t){return!!(t&&t.nodeType===1)}function oc(t){var e="[object "+t+"]";return function(n){return Tg.call(n)===e}}const h1=oc("String"),fS=oc("Number"),g7=oc("Date"),_7=oc("RegExp"),y7=oc("Error"),dS=oc("Symbol"),pS=oc("ArrayBuffer");var mS=oc("Function"),v7=Zb.document&&Zb.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof v7!="function"&&(mS=function(t){return typeof t=="function"||!1});const sc=mS,gS=oc("Object");var _S=c7&&gS(new DataView(new ArrayBuffer(8))),c2=typeof Map<"u"&&gS(new Map),x7=oc("DataView");function b7(t){return t!=null&&sc(t.getInt8)&&pS(t.buffer)}const H_=_S?b7:x7,vp=h7||oc("Array");function $0(t,e){return t!=null&&u7.call(t,e)}var gv=oc("Arguments");(function(){gv(arguments)||(gv=function(t){return $0(t,"callee")})})();const h2=gv;function w7(t){return!dS(t)&&f7(t)&&!isNaN(parseFloat(t))}function yS(t){return fS(t)&&A7(t)}function vS(t){return function(){return t}}function xS(t){return function(e){var n=t(e);return typeof n=="number"&&n>=0&&n<=d7}}function bS(t){return function(e){return e==null?void 0:e[t]}}const j_=bS("byteLength"),S7=xS(j_);var I7=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function E7(t){return Xb?Xb(t)&&!H_(t):S7(t)&&I7.test(Tg.call(t))}const wS=cS?E7:vS(!1),Qc=bS("length");function C7(t){for(var e={},n=t.length,c=0;c<n;++c)e[t[c]]=!0;return{contains:function(g){return e[g]===!0},push:function(g){return e[g]=!0,t.push(g)}}}function SS(t,e){e=C7(e);var n=Yb.length,c=t.constructor,g=sc(c)&&c.prototype||u2,v="constructor";for($0(t,v)&&!e.contains(v)&&e.push(v);n--;)v=Yb[n],v in t&&t[v]!==g[v]&&!e.contains(v)&&e.push(v)}function _u(t){if(!yp(t))return[];if(Wb)return Wb(t);var e=[];for(var n in t)$0(t,n)&&e.push(n);return hS&&SS(t,e),e}function T7(t){if(t==null)return!0;var e=Qc(t);return typeof e=="number"&&(vp(t)||h1(t)||h2(t))?e===0:Qc(_u(t))===0}function IS(t,e){var n=_u(e),c=n.length;if(t==null)return!c;for(var g=Object(t),v=0;v<c;v++){var S=n[v];if(e[S]!==g[S]||!(S in g))return!1}return!0}function go(t){if(t instanceof go)return t;if(!(this instanceof go))return new go(t);this._wrapped=t}go.VERSION=uS;go.prototype.value=function(){return this._wrapped};go.prototype.valueOf=go.prototype.toJSON=go.prototype.value;go.prototype.toString=function(){return String(this._wrapped)};function Kb(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,j_(t))}var Jb="[object DataView]";function _v(t,e,n,c){if(t===e)return t!==0||1/t===1/e;if(t==null||e==null)return!1;if(t!==t)return e!==e;var g=typeof t;return g!=="function"&&g!=="object"&&typeof e!="object"?!1:ES(t,e,n,c)}function ES(t,e,n,c){t instanceof go&&(t=t._wrapped),e instanceof go&&(e=e._wrapped);var g=Tg.call(t);if(g!==Tg.call(e))return!1;if(_S&&g=="[object Object]"&&H_(t)){if(!H_(e))return!1;g=Jb}switch(g){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:+t==0?1/+t===1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return Qb.valueOf.call(t)===Qb.valueOf.call(e);case"[object ArrayBuffer]":case Jb:return ES(Kb(t),Kb(e),n,c)}var v=g==="[object Array]";if(!v&&wS(t)){var S=j_(t);if(S!==j_(e))return!1;if(t.buffer===e.buffer&&t.byteOffset===e.byteOffset)return!0;v=!0}if(!v){if(typeof t!="object"||typeof e!="object")return!1;var a=t.constructor,N=e.constructor;if(a!==N&&!(sc(a)&&a instanceof a&&sc(N)&&N instanceof N)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],c=c||[];for(var $=n.length;$--;)if(n[$]===t)return c[$]===e;if(n.push(t),c.push(e),v){if($=t.length,$!==e.length)return!1;for(;$--;)if(!_v(t[$],e[$],n,c))return!1}else{var he=_u(t),oe;if($=he.length,_u(e).length!==$)return!1;for(;$--;)if(oe=he[$],!($0(e,oe)&&_v(t[oe],e[oe],n,c)))return!1}return n.pop(),c.pop(),!0}function k7(t,e){return _v(t,e)}function Vg(t){if(!yp(t))return[];var e=[];for(var n in t)e.push(n);return hS&&SS(t,e),e}function A2(t){var e=Qc(t);return function(n){if(n==null)return!1;var c=Vg(n);if(Qc(c))return!1;for(var g=0;g<e;g++)if(!sc(n[t[g]]))return!1;return t!==kS||!sc(n[f2])}}var f2="forEach",CS="has",d2=["clear","delete"],TS=["get",CS,"set"],M7=d2.concat(f2,TS),kS=d2.concat(TS),P7=["add"].concat(d2,f2,CS);const D7=c2?A2(M7):oc("Map"),L7=c2?A2(kS):oc("WeakMap"),B7=c2?A2(P7):oc("Set"),z7=oc("WeakSet");function xp(t){for(var e=_u(t),n=e.length,c=Array(n),g=0;g<n;g++)c[g]=t[e[g]];return c}function R7(t){for(var e=_u(t),n=e.length,c=Array(n),g=0;g<n;g++)c[g]=[e[g],t[e[g]]];return c}function MS(t){for(var e={},n=_u(t),c=0,g=n.length;c<g;c++)e[t[n[c]]]=n[c];return e}function yv(t){var e=[];for(var n in t)sc(t[n])&&e.push(n);return e.sort()}function p2(t,e){return function(n){var c=arguments.length;if(e&&(n=Object(n)),c<2||n==null)return n;for(var g=1;g<c;g++)for(var v=arguments[g],S=t(v),a=S.length,N=0;N<a;N++){var $=S[N];(!e||n[$]===void 0)&&(n[$]=v[$])}return n}}const gA=p2(Vg),kg=p2(_u),m2=p2(Vg,!0);function F7(){return function(){}}function PS(t){if(!yp(t))return{};if($b)return $b(t);var e=F7();e.prototype=t;var n=new e;return e.prototype=null,n}function O7(t,e){var n=PS(t);return e&&kg(n,e),n}function DS(t){return yp(t)?vp(t)?t.slice():gA({},t):t}function N7(t,e){return e(t),t}function LS(t){return vp(t)?t:[t]}go.toPath=LS;function Ug(t){return go.toPath(t)}function g2(t,e){for(var n=e.length,c=0;c<n;c++){if(t==null)return;t=t[e[c]]}return n?t:void 0}function BS(t,e,n){var c=g2(t,Ug(e));return dp(c)?n:c}function A1(t,e){e=Ug(e);for(var n=e.length,c=0;c<n;c++){var g=e[c];if(!$0(t,g))return!1;t=t[g]}return!!n}function _2(t){return t}function Mg(t){return t=kg({},t),function(e){return IS(e,t)}}function y2(t){return t=Ug(t),function(e){return g2(e,t)}}function Gg(t,e,n){if(e===void 0)return t;switch(n??3){case 1:return function(c){return t.call(e,c)};case 3:return function(c,g,v){return t.call(e,c,g,v)};case 4:return function(c,g,v,S){return t.call(e,c,g,v,S)}}return function(){return t.apply(e,arguments)}}function zS(t,e,n){return t==null?_2:sc(t)?Gg(t,e,n):yp(t)&&!vp(t)?Mg(t):y2(t)}function v2(t,e){return zS(t,e,1/0)}go.iteratee=v2;function Xc(t,e,n){return go.iteratee!==v2?go.iteratee(t,e):zS(t,e,n)}function RS(t,e,n){e=Xc(e,n);for(var c=_u(t),g=c.length,v={},S=0;S<g;S++){var a=c[S];v[a]=e(t[a],a,t)}return v}function FS(){}function V7(t){return t==null?FS:function(e){return BS(t,e)}}function U7(t,e,n){var c=Array(Math.max(0,t));e=Gg(e,n,1);for(var g=0;g<t;g++)c[g]=e(g);return c}function vv(t,e){return e==null&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}const Pg=Date.now||function(){return new Date().getTime()};function OS(t){var e=function(v){return t[v]},n="(?:"+_u(t).join("|")+")",c=RegExp(n),g=RegExp(n,"g");return function(v){return v=v==null?"":""+v,c.test(v)?v.replace(g,e):v}}const NS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},G7=OS(NS),q7=MS(NS),H7=OS(q7),j7=go.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var oy=/(.)^/,Z7={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q7=/\\|'|\r|\n|\u2028|\u2029/g;function W7(t){return"\\"+Z7[t]}var $7=/^\s*(\w|\$)+\s*$/;function X7(t,e,n){!e&&n&&(e=n),e=m2({},e,go.templateSettings);var c=RegExp([(e.escape||oy).source,(e.interpolate||oy).source,(e.evaluate||oy).source].join("|")+"|$","g"),g=0,v="__p+='";t.replace(c,function($,he,oe,ce,_e){return v+=t.slice(g,_e).replace(Q7,W7),g=_e+$.length,he?v+=`'+
((__t=(`+he+`))==null?'':_.escape(__t))+
'`:oe?v+=`'+
((__t=(`+oe+`))==null?'':__t)+
'`:ce&&(v+=`';
`+ce+`
__p+='`),$}),v+=`';
`;var S=e.variable;if(S){if(!$7.test(S))throw new Error("variable is not a bare identifier: "+S)}else v=`with(obj||{}){
`+v+`}
`,S="obj";v=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+v+`return __p;
`;var a;try{a=new Function(S,"_",v)}catch($){throw $.source=v,$}var N=function($){return a.call(this,$,go)};return N.source="function("+S+`){
`+v+"}",N}function Y7(t,e,n){e=Ug(e);var c=e.length;if(!c)return sc(n)?n.call(t):n;for(var g=0;g<c;g++){var v=t==null?void 0:t[e[g]];v===void 0&&(v=n,g=c),t=sc(v)?v.call(t):v}return t}var K7=0;function J7(t){var e=++K7+"";return t?t+e:e}function e9(t){var e=go(t);return e._chain=!0,e}function VS(t,e,n,c,g){if(!(c instanceof e))return t.apply(n,g);var v=PS(t.prototype),S=t.apply(v,g);return yp(S)?S:v}var uf=Zc(function(t,e){var n=uf.placeholder,c=function(){for(var g=0,v=e.length,S=Array(v),a=0;a<v;a++)S[a]=e[a]===n?arguments[g++]:e[a];for(;g<arguments.length;)S.push(arguments[g++]);return VS(t,c,this,this,S)};return c});uf.placeholder=go;const US=Zc(function(t,e,n){if(!sc(t))throw new TypeError("Bind must be called on a function");var c=Zc(function(g){return VS(t,c,e,this,n.concat(g))});return c}),yh=xS(Qc);function bp(t,e,n,c){if(c=c||[],!e&&e!==0)e=1/0;else if(e<=0)return c.concat(t);for(var g=c.length,v=0,S=Qc(t);v<S;v++){var a=t[v];if(yh(a)&&(vp(a)||h2(a)))if(e>1)bp(a,e-1,n,c),g=c.length;else for(var N=0,$=a.length;N<$;)c[g++]=a[N++];else n||(c[g++]=a)}return c}const t9=Zc(function(t,e){e=bp(e,!1,!1);var n=e.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var c=e[n];t[c]=US(t[c],t)}return t});function i9(t,e){var n=function(c){var g=n.cache,v=""+(e?e.apply(this,arguments):c);return $0(g,v)||(g[v]=t.apply(this,arguments)),g[v]};return n.cache={},n}const GS=Zc(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),n9=uf(GS,go,1);function r9(t,e,n){var c,g,v,S,a=0;n||(n={});var N=function(){a=n.leading===!1?0:Pg(),c=null,S=t.apply(g,v),c||(g=v=null)},$=function(){var he=Pg();!a&&n.leading===!1&&(a=he);var oe=e-(he-a);return g=this,v=arguments,oe<=0||oe>e?(c&&(clearTimeout(c),c=null),a=he,S=t.apply(g,v),c||(g=v=null)):!c&&n.trailing!==!1&&(c=setTimeout(N,oe)),S};return $.cancel=function(){clearTimeout(c),a=0,c=g=v=null},$}function s9(t,e,n){var c,g,v,S,a,N=function(){var he=Pg()-g;e>he?c=setTimeout(N,e-he):(c=null,n||(S=t.apply(a,v)),c||(v=a=null))},$=Zc(function(he){return a=this,v=he,g=Pg(),c||(c=setTimeout(N,e),n&&(S=t.apply(a,v))),S});return $.cancel=function(){clearTimeout(c),c=v=a=null},$}function a9(t,e){return uf(e,t)}function x2(t){return function(){return!t.apply(this,arguments)}}function o9(){var t=arguments,e=t.length-1;return function(){for(var n=e,c=t[e].apply(this,arguments);n--;)c=t[n].call(this,c);return c}}function l9(t,e){return function(){if(--t<1)return e.apply(this,arguments)}}function qS(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}const u9=uf(qS,2);function HS(t,e,n){e=Xc(e,n);for(var c=_u(t),g,v=0,S=c.length;v<S;v++)if(g=c[v],e(t[g],g,t))return g}function jS(t){return function(e,n,c){n=Xc(n,c);for(var g=Qc(e),v=t>0?0:g-1;v>=0&&v<g;v+=t)if(n(e[v],v,e))return v;return-1}}const b2=jS(1),ZS=jS(-1);function QS(t,e,n,c){n=Xc(n,c,1);for(var g=n(e),v=0,S=Qc(t);v<S;){var a=Math.floor((v+S)/2);n(t[a])<g?v=a+1:S=a}return v}function WS(t,e,n){return function(c,g,v){var S=0,a=Qc(c);if(typeof v=="number")t>0?S=v>=0?v:Math.max(v+a,S):a=v>=0?Math.min(v+1,a):v+a+1;else if(n&&v&&a)return v=n(c,g),c[v]===g?v:-1;if(g!==g)return v=e(Ng.call(c,S,a),yS),v>=0?v+S:-1;for(v=t>0?S:a-1;v>=0&&v<a;v+=t)if(c[v]===g)return v;return-1}}const $S=WS(1,b2,QS),c9=WS(-1,ZS);function xv(t,e,n){var c=yh(t)?b2:HS,g=c(t,e,n);if(g!==void 0&&g!==-1)return t[g]}function h9(t,e){return xv(t,Mg(e))}function Wc(t,e,n){e=Gg(e,n);var c,g;if(yh(t))for(c=0,g=t.length;c<g;c++)e(t[c],c,t);else{var v=_u(t);for(c=0,g=v.length;c<g;c++)e(t[v[c]],v[c],t)}return t}function yc(t,e,n){e=Xc(e,n);for(var c=!yh(t)&&_u(t),g=(c||t).length,v=Array(g),S=0;S<g;S++){var a=c?c[S]:S;v[S]=e(t[a],a,t)}return v}function XS(t){var e=function(n,c,g,v){var S=!yh(n)&&_u(n),a=(S||n).length,N=t>0?0:a-1;for(v||(g=n[S?S[N]:N],N+=t);N>=0&&N<a;N+=t){var $=S?S[N]:N;g=c(g,n[$],$,n)}return g};return function(n,c,g,v){var S=arguments.length>=3;return e(n,Gg(c,v,4),g,S)}}const ly=XS(1),ew=XS(-1);function mh(t,e,n){var c=[];return e=Xc(e,n),Wc(t,function(g,v,S){e(g,v,S)&&c.push(g)}),c}function YS(t,e,n){return mh(t,x2(Xc(e)),n)}function bv(t,e,n){e=Xc(e,n);for(var c=!yh(t)&&_u(t),g=(c||t).length,v=0;v<g;v++){var S=c?c[v]:v;if(!e(t[S],S,t))return!1}return!0}function Z_(t,e,n){e=Xc(e,n);for(var c=!yh(t)&&_u(t),g=(c||t).length,v=0;v<g;v++){var S=c?c[v]:v;if(e(t[S],S,t))return!0}return!1}function sf(t,e,n,c){return yh(t)||(t=xp(t)),(typeof n!="number"||c)&&(n=0),$S(t,e,n)>=0}const A9=Zc(function(t,e,n){var c,g;return sc(e)?g=e:(e=Ug(e),c=e.slice(0,-1),e=e[e.length-1]),yc(t,function(v){var S=g;if(!S){if(c&&c.length&&(v=g2(v,c)),v==null)return;S=v[e]}return S==null?S:S.apply(v,n)})});function f1(t,e){return yc(t,y2(e))}function f9(t,e){return mh(t,Mg(e))}function w2(t,e,n){var c=-1/0,g=-1/0,v,S;if(e==null||typeof e=="number"&&typeof t[0]!="object"&&t!=null){t=yh(t)?t:xp(t);for(var a=0,N=t.length;a<N;a++)v=t[a],v!=null&&v>c&&(c=v)}else e=Xc(e,n),Wc(t,function($,he,oe){S=e($,he,oe),(S>g||S===-1/0&&c===-1/0)&&(c=$,g=S)});return c}function KS(t,e,n){var c=1/0,g=1/0,v,S;if(e==null||typeof e=="number"&&typeof t[0]!="object"&&t!=null){t=yh(t)?t:xp(t);for(var a=0,N=t.length;a<N;a++)v=t[a],v!=null&&v<c&&(c=v)}else e=Xc(e,n),Wc(t,function($,he,oe){S=e($,he,oe),(S<g||S===1/0&&c===1/0)&&(c=$,g=S)});return c}var d9=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function JS(t){return t?vp(t)?Ng.call(t):h1(t)?t.match(d9):yh(t)?yc(t,_2):xp(t):[]}function e5(t,e,n){if(e==null||n)return yh(t)||(t=xp(t)),t[vv(t.length-1)];var c=JS(t),g=Qc(c);e=Math.max(Math.min(e,g),0);for(var v=g-1,S=0;S<e;S++){var a=vv(S,v),N=c[S];c[S]=c[a],c[a]=N}return c.slice(0,e)}function p9(t){return e5(t,1/0)}function t5(t,e,n){var c=0;return e=Xc(e,n),f1(yc(t,function(g,v,S){return{value:g,index:c++,criteria:e(g,v,S)}}).sort(function(g,v){var S=g.criteria,a=v.criteria;if(S!==a){if(S>a||S===void 0)return 1;if(S<a||a===void 0)return-1}return g.index-v.index}),"value")}function d1(t,e){return function(n,c,g){var v=e?[[],[]]:{};return c=Xc(c,g),Wc(n,function(S,a){var N=c(S,a,n);t(v,S,N)}),v}}const m9=d1(function(t,e,n){$0(t,n)?t[n].push(e):t[n]=[e]}),g9=d1(function(t,e,n){t[n]=e}),_9=d1(function(t,e,n){$0(t,n)?t[n]++:t[n]=1}),y9=d1(function(t,e,n){t[n?0:1].push(e)},!0);function v9(t){return t==null?0:yh(t)?t.length:_u(t).length}function x9(t,e,n){return e in n}const S2=Zc(function(t,e){var n={},c=e[0];if(t==null)return n;sc(c)?(e.length>1&&(c=Gg(c,e[1])),e=Vg(t)):(c=x9,e=bp(e,!1,!1),t=Object(t));for(var g=0,v=e.length;g<v;g++){var S=e[g],a=t[S];c(a,S,t)&&(n[S]=a)}return n}),b9=Zc(function(t,e){var n=e[0],c;return sc(n)?(n=x2(n),e.length>1&&(c=e[1])):(e=yc(bp(e,!1,!1),String),n=function(g,v){return!sf(e,v)}),S2(t,n,c)});function i5(t,e,n){return Ng.call(t,0,Math.max(0,t.length-(e==null||n?1:e)))}function uy(t,e,n){return t==null||t.length<1?e==null||n?void 0:[]:e==null||n?t[0]:i5(t,t.length-e)}function sp(t,e,n){return Ng.call(t,e==null||n?1:e)}function w9(t,e,n){return t==null||t.length<1?e==null||n?void 0:[]:e==null||n?t[t.length-1]:sp(t,Math.max(0,t.length-e))}function n5(t){return mh(t,Boolean)}function S9(t,e){return bp(t,e,!1)}const r5=Zc(function(t,e){return e=bp(e,!0,!0),mh(t,function(n){return!sf(e,n)})}),I9=Zc(function(t,e){return r5(t,e)});function wv(t,e,n,c){AS(e)||(c=n,n=e,e=!1),n!=null&&(n=Xc(n,c));for(var g=[],v=[],S=0,a=Qc(t);S<a;S++){var N=t[S],$=n?n(N,S,t):N;e&&!n?((!S||v!==$)&&g.push(N),v=$):n?sf(v,$)||(v.push($),g.push(N)):sf(g,N)||g.push(N)}return g}const s5=Zc(function(t){return wv(bp(t,!0,!0))});function a5(t){for(var e=[],n=arguments.length,c=0,g=Qc(t);c<g;c++){var v=t[c];if(!sf(e,v)){var S;for(S=1;S<n&&sf(arguments[S],v);S++);S===n&&e.push(v)}}return e}function Sv(t){for(var e=t&&w2(t,Qc).length||0,n=Array(e),c=0;c<e;c++)n[c]=f1(t,c);return n}const E9=Zc(Sv);function p_(t,e){for(var n={},c=0,g=Qc(t);c<g;c++)e?n[t[c]]=e[c]:n[t[c][0]]=t[c][1];return n}function C9(t,e,n){e==null&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var c=Math.max(Math.ceil((e-t)/n),0),g=Array(c),v=0;v<c;v++,t+=n)g[v]=t;return g}function T9(t,e){if(e==null||e<1)return[];for(var n=[],c=0,g=t.length;c<g;)n.push(Ng.call(t,c,c+=e));return n}function I2(t,e){return t._chain?go(e).chain():e}function o5(t){return Wc(yv(t),function(e){var n=go[e]=t[e];go.prototype[e]=function(){var c=[this._wrapped];return l7.apply(c,arguments),I2(this,n.apply(go,c))}}),go}Wc(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=c1[t];go.prototype[t]=function(){var n=this._wrapped;return n!=null&&(e.apply(n,arguments),(t==="shift"||t==="splice")&&n.length===0&&delete n[0]),I2(this,n)}});Wc(["concat","join","slice"],function(t){var e=c1[t];go.prototype[t]=function(){var n=this._wrapped;return n!=null&&(n=e.apply(n,arguments)),I2(this,n)}});const k9=Object.freeze(Object.defineProperty({__proto__:null,VERSION:uS,after:l9,all:bv,allKeys:Vg,any:Z_,assign:kg,before:qS,bind:US,bindAll:t9,chain:e9,chunk:T9,clone:DS,collect:yc,compact:n5,compose:o9,constant:vS,contains:sf,countBy:_9,create:O7,debounce:s9,default:go,defaults:m2,defer:n9,delay:GS,detect:xv,difference:r5,drop:sp,each:Wc,escape:G7,every:bv,extend:gA,extendOwn:kg,filter:mh,find:xv,findIndex:b2,findKey:HS,findLastIndex:ZS,findWhere:h9,first:uy,flatten:S9,foldl:ly,foldr:ew,forEach:Wc,functions:yv,get:BS,groupBy:m9,has:A1,head:uy,identity:_2,include:sf,includes:sf,indexBy:g9,indexOf:$S,initial:i5,inject:ly,intersection:a5,invert:MS,invoke:A9,isArguments:h2,isArray:vp,isArrayBuffer:pS,isBoolean:AS,isDataView:H_,isDate:g7,isElement:m7,isEmpty:T7,isEqual:k7,isError:y7,isFinite:w7,isFunction:sc,isMap:D7,isMatch:IS,isNaN:yS,isNull:p7,isNumber:fS,isObject:yp,isRegExp:_7,isSet:B7,isString:h1,isSymbol:dS,isTypedArray:wS,isUndefined:dp,isWeakMap:L7,isWeakSet:z7,iteratee:v2,keys:_u,last:w9,lastIndexOf:c9,map:yc,mapObject:RS,matcher:Mg,matches:Mg,max:w2,memoize:i9,methods:yv,min:KS,mixin:o5,negate:x2,noop:FS,now:Pg,object:p_,omit:b9,once:u9,pairs:R7,partial:uf,partition:y9,pick:S2,pluck:f1,property:y2,propertyOf:V7,random:vv,range:C9,reduce:ly,reduceRight:ew,reject:YS,rest:sp,restArguments:Zc,result:Y7,sample:e5,select:mh,shuffle:p9,size:v9,some:Z_,sortBy:t5,sortedIndex:QS,tail:sp,take:uy,tap:N7,template:X7,templateSettings:j7,throttle:r9,times:U7,toArray:JS,toPath:LS,transpose:Sv,unescape:H7,union:s5,uniq:wv,unique:wv,uniqueId:J7,unzip:Sv,values:xp,where:f9,without:I9,wrap:a9,zip:E9},Symbol.toStringTag,{value:"Module"}));var tw=o5(k9);tw._=tw;var M9=function(t,e){var n;return parseString(t,function(c,g){n=g["nex:nexml"].trees[0].tree.map(function(v){var S=v.node.map(oe=>oe.$),a=S.reduce(function(oe,ce){return ce.edges=[],ce.name=ce.id,oe[ce.id]=ce,oe},{}),N=S.filter(oe=>oe.root),$=N>0?N[0].id:S[0].id;a[$].name="root",v.edge.map(oe=>oe.$).forEach(function(oe){a[oe.source].edges.push(oe)});function he(oe,ce){if(oe.edges){var _e=f1(oe.edges,"target");oe.children=xp(S2(a,_e)),oe.children.forEach(function(Ze,nt){Ze.attribute=oe.edges[nt].length||""}),oe.children.forEach(he),oe.annotation=""}}return he(a[$]),a[$]})}),n};function P9(t,e,n,c){let g=this.nodes.descendants();if(t.parent&&g.indexOf(t)>=0){let S=t.parent.children.indexOf(t),a={name:n,parent:t.parent,attribute:c?c[2]:null,original_child_order:t.original_child_order},N={name:e,parent:a,attribute:c?c[1]:null,original_child_order:2};a.children=[t,N],t.parent.children[S]=a,t.parent=a,t.attribute=c?c[0]:null,t.original_child_order=1}return this}function D9(t,e){return t.children?t.children.push(e):t.children=[e],t}function L9(t,e){return{data:{name:t,attribute:e?e[1]:null},parent:""}}function B9(t){let e=this.nodes.descendants();if(typeof t!="number")return this.deleteANode(e.indexOf(t));if(t>0&&t<e.length){let n=e[t];if(n.parent){let c=n.parent.children.indexOf(n);c>=0&&(e.splice(t,1),n.children&&n.children.forEach(function(g){g.original_child_order=n.parent.children.length,n.parent.children.push(g),g.parent=n.parent}),n.parent.children.length>2?n.parent.children.splice(c,1):n.parent.parent?(n.parent.parent.children[n.parent.parent.children.indexOf(n.parent)]=n.parent.children[1-c],n.parent.children[1-c].parent=n.parent.parent,e.splice(e.indexOf(n.parent),1)):(e.splice(0,1),e.parent=null,delete e.data.attribute,delete e.data.annotation,delete e.data.original_child_order,e.name="root",e.data.name="root"))}}return this}function z9(){return mh(this.nodes.descendants(),t=>!A1(t,"children"))}function R9(){return mh(this.nodes.descendants(),t=>A1(t,"children"))}function F9(){return this.nodes}function O9(){return this.nodes}function N9(t){return mh(this.nodes.descendants(),e=>e.data.name==t)[0]}function V9(t){Wc(this.nodes.descendants(),function(e){e.data&&e.data.name in t&&(e.annotations=t[e.data.name])})}function Cl(t){return!A1(t,"children")}function U9(t,e){return this.nodes.each(function(n){t in n&&(e&&(n[e]=n[t]),delete n[t])}),this}function G9(t){t||this.nodes.each(e=>{Cl(e)||(e[this.selection_attribute_name]=!1,e.data.traits||(e.data.traits={}),e.data.traits[this.selection_attribute_name]=e[this.selection_attribute_name])})}function l5(t,e,n){let c=[];function g(v){Cl(v)?e&&v!=t&&c.push(v):(n&&v!=t&&c.push(v),v.children.forEach(g))}return g(t),c}const q9=Object.freeze(Object.defineProperty({__proto__:null,addChild:D9,assignAttributes:V9,clearInternalNodes:G9,createNode:L9,deleteANode:B9,getInternals:R9,getNodeByName:N9,getNodes:O9,getRootNode:F9,getTips:z9,graftANode:P9,isLeafNode:Cl,selectAllDescendants:l5,updateKeyName:U9},Symbol.toStringTag,{value:"Module"}));function Dg(t,e={}){const n=/^-?\d+(\.\d+)?$/;let c=e.left_delimiter||"{",g=e.right_delimiter||"}",v=[];function S(){let xt={name:null},zt=v[v.length-1];"children"in zt||(zt.children=[]),v.push(xt),zt.children.push(v[v.length-1]),v[v.length-1].original_child_order=zt.children.length}function a(){let xt=v.pop();xt.name=he,"children"in xt?xt.bootstrap_values=he:xt.name=he,xt.attribute=oe,c=="["&&ce.includes("&&NHX")?ce.split(":").slice(1).forEach(zt=>{const[Mt,Ue]=zt.split("=");xt[Mt]=n.test(Ue)?+Ue:Ue}):xt.annotation=ce,he="",oe="",ce=""}function N(xt){return{json:null,error:"Unexpected '"+t[xt]+"' in '"+t.substring(xt-20,xt+1)+"[ERROR HERE]"+t.substring(xt+1,xt+20)+"'"}}let $=0,he="",oe="",ce="",_e=null,Ze={"'":1,'"':1},nt={name:"root"};v.push(nt);for(var Ke=/\s/,st=0;st<t.length;st++)try{var ht=t[st];switch($){case 0:{ht=="("&&(S(),$=1);break}case 1:case 3:{if(ht==":")$=3;else if(ht==","||ht==")")try{a(),$=1,ht==","&&S()}catch{return N(st)}else if(ht=="("){if(he.length>0)return N(st);S()}else if(ht in Ze){if($==1&&he.length===0&&oe.length===0&&ce.length===0){$=2,_e=ht;continue}return N(st)}else if(ht==c){if(ce.length)return N(st);$=4}else if($==3)oe+=ht;else{if(Ke.test(ht))continue;if(ht==";"){st=t.length;break}he+=ht}break}case 2:{if(ht==_e){if(st<t.length-1&&t[st+1]==_e){st++,he+=_e;continue}_e=0,$=1;continue}else he+=ht;break}case 4:{if(ht==g)$=3;else{if(ht==c)return N(st);ce+=ht}break}}}catch{return N(st)}return v.length!=1?N(t.length-1):{json:nt,error:null}}function H9(t,e){let n=this;t||(t=v=>"");function c(v){if(v.notshown)return;if(Cl(v)||(g.push("("),v.children.forEach(function(a,N){N&&g.push(","),c(a)}),g.push(")")),v.data.name!=="root"){const a=v.data.name.replaceAll("'","''");/\W/.test(a)?g.push("'"+a+"'"):g.push(a)}g.push(t(v));let S=n.branch_length_accessor(v);S!==void 0&&g.push(":"+S)}let g=[];return t=t||"",c(e||this.nodes),g.join("")+";"}function j9(t){let e=t,n=e.toUpperCase().indexOf("BEGIN DATA;"),c=e.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let g=c.slice(0,n);c=yc(g.split(";"),N=>N.trim());let v=mh(c,N=>N.toUpperCase().startsWith("DIMENSION"));v=v[0].split(" "),v=p_(yc(sp(v),N=>N.split("=")));let S=mh(c,N=>N.toUpperCase().startsWith("FORMAT"));S=S[0].split(" "),S=p_(yc(sp(S),N=>N.split("="))),S.symbols=YS(S.symbols.split(""),N=>N=='"');let a=mh(c,N=>N.toUpperCase().startsWith("MATRIX"));return a=a[0].split(`
`),a=p_(yc(sp(a),N=>n5(N.split(" ")))),a=RS(a,(N,$)=>N=="?"?S.symbols:Array(N)),{dimensions:v,format:S,matrix:a}}function Z9(t,e,n){Wc(t.getTips(),c=>{c.data.test=n.matrix[c.data.name]})}function u5(t){let e=t,n=e.toUpperCase().indexOf("BEGIN TREES;"),c=e.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let v=c.slice(0,n).split(`
`);return v=mh(v,S=>S.trim().toUpperCase().startsWith("TREE")),Dg(v[0])}const Q9=Object.freeze(Object.defineProperty({__proto__:null,default:u5,loadAnnotations:Z9,parseAnnotations:j9},Symbol.toStringTag,{value:"Module"}));function Iv(t){var e={};if(t.nodeType==1){if(t.attributes.length>0){e["@attributes"]={};for(var n=0;n<t.attributes.length;n++){var c=t.attributes.item(n);e["@attributes"][c.nodeName]=c.nodeValue}}}else t.nodeType==3&&(e=t.nodeValue);if(t.hasChildNodes()&&t.childNodes.length===1&&t.childNodes[0].nodeType===3)e=t.childNodes[0].nodeValue;else if(t.hasChildNodes())for(var g=0;g<t.childNodes.length;g++){var v=t.childNodes.item(g),S=v.nodeName;if(typeof e[S]>"u")e[S]=Iv(v);else{if(typeof e[S].push>"u"){var a=e[S];e[S]=[],e[S].push(a)}e[S].push(Iv(v))}}return e}var c5=function(t,e){function n(g,v){g.clade&&(g.clade.forEach(n),g.children=g.clade,delete g.clade),g.annotation=1,g.attribute="0.01",g.branch_length&&(g.attribute=g.branch_length),g.taxonomy&&(g.name=g.taxonomy.scientific_name),g.annotation=""}var c;return t=Iv(t),c=t.phyloxml.phylogeny.clade,c.name="root",n(c),{json:c,error:null}};function W9(t,e){e.left_delimiter="[",e.right_delimiter="]";const n=Dg(t,e);function c(g){if(g.annotation){g.beast={};const S=g.annotation.split(/=|,|{|}/).filter(a=>a);for(var v=0;v<S.length;v+=2){let a=S[v].replace(/&|%/g,"");/[a-df-zA-DF-Z]+/.test(S[v+2])?g.beast[a]=+S[v+1]:(g.beast[a]=[+S[v+1],+S[v+2]],v++)}}g.annotation=void 0,g.children&&g.children.forEach(c)}return c(n.json),n}var cy={nexml:M9,phyloxml:c5,nexus:u5,nwk:Dg,nhx:Dg,beast:W9};function $9(){let e=this.getTips(),n=yc(e,c=>({name:c.data.name,length:parseFloat(c.data.attribute)}));return n=t5(n,c=>-c.length),n}function X9(t,e){function n(g,v){if(v.mp=[[0,0],[!1,!1]],Cl(v))v.mp[1][0]=v.mp[1][1]=v[g]||!1,v.mp[0][0]=v.mp[1][0]?1:0,v.mp[0][1]=1-v.mp[0][0];else{v.children.forEach(c);var S=v.children.reduce(function(N,$){return $.mp[0][0]+N},0),a=v.children.reduce(function(N,$){return $.mp[0][1]+N},0);v[g]?(v.mp[0][0]=a+1,v.mp[1][0]=!0,v.mp[0][1]=a,v.mp[1][1]=!0):(S<a+1?(v.mp[0][0]=S,v.mp[1][0]=!1):(v.mp[0][0]=a+1,v.mp[1][0]=!0),a<S+1?(v.mp[0][1]=a,v.mp[1][1]=!0):(v.mp[0][1]=S+1,v.mp[1][1]=!1))}}const c=uf(n,e);c(this.nodes),this.nodes.each(g=>{g.parent?g.mp=g.mp[1][g.parent.mp?1:0]:g.mp=g.mp[1][g.mp[0][0]<g.mp[0][1]?0:1]}),this.display.modifySelection((g,v)=>Cl(g.target)?g.target[e]:g.target.mp)}var Q_={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Q_.exports;(function(t,e){(function(){var n,c="4.17.21",g=200,v="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",S="Expected a function",a="Invalid `variable` option passed into `_.template`",N="__lodash_hash_undefined__",$=500,he="__lodash_placeholder__",oe=1,ce=2,_e=4,Ze=1,nt=2,Ke=1,st=2,ht=4,xt=8,zt=16,Mt=32,Ue=64,$t=128,rt=256,gt=512,At=30,yt="...",St=800,ut=16,Ye=1,_t=2,ct=3,Ut=1/0,Ft=9007199254740991,Vt=17976931348623157e292,yi=NaN,Ci=4294967295,ki=Ci-1,Ni=Ci>>>1,tn=[["ary",$t],["bind",Ke],["bindKey",st],["curry",xt],["curryRight",zt],["flip",gt],["partial",Mt],["partialRight",Ue],["rearg",rt]],Zi="[object Arguments]",Gi="[object Array]",sn="[object AsyncFunction]",xn="[object Boolean]",Ti="[object Date]",gi="[object DOMException]",Oi="[object Error]",Vi="[object Function]",bn="[object GeneratorFunction]",wn="[object Map]",xi="[object Number]",Bn="[object Null]",Ot="[object Object]",an="[object Promise]",$n="[object Proxy]",oi="[object RegExp]",Yi="[object Set]",Xn="[object String]",zn="[object Symbol]",Wn="[object Undefined]",_n="[object WeakMap]",b="[object WeakSet]",M="[object ArrayBuffer]",U="[object DataView]",K="[object Float32Array]",ie="[object Float64Array]",de="[object Int8Array]",be="[object Int16Array]",Ee="[object Int32Array]",Ce="[object Uint8Array]",Re="[object Uint8ClampedArray]",$e="[object Uint16Array]",je="[object Uint32Array]",We=/\b__p \+= '';/g,Ge=/\b(__p \+=) '' \+/g,mt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ot=/&(?:amp|lt|gt|quot|#39);/g,Pe=/[&<>"']/g,ae=RegExp(ot.source),re=RegExp(Pe.source),X=/<%-([\s\S]+?)%>/g,ne=/<%([\s\S]+?)%>/g,pe=/<%=([\s\S]+?)%>/g,xe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ye=/^\w*$/,De=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Oe=/[\\^$.*+?()[\]{}|]/g,Ve=RegExp(Oe.source),Je=/^\s+/,et=/\s/,Le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qe=/\{\n\/\* \[wrapped with (.+)\] \*/,dt=/,? & /,Pt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,o=/[()=,{}\[\]\/\s]/,Me=/\\(\\)?/g,li=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,di=/\w*$/,fi=/^[-+]0x[0-9a-f]+$/i,ti=/^0b[01]+$/i,ui=/^\[object .+?Constructor\]$/,Ri=/^0o[0-7]+$/i,bi=/^(?:0|[1-9]\d*)$/,Si=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Jt=/($^)/,Sn=/['\n\r\u2028\u2029\\]/g,ur="\\ud800-\\udfff",mn="\\u0300-\\u036f",Hn="\\ufe20-\\ufe2f",Yr="\\u20d0-\\u20ff",Qi=mn+Hn+Yr,hr="\\u2700-\\u27bf",Gn="a-z\\xdf-\\xf6\\xf8-\\xff",Xt="\\xac\\xb1\\xd7\\xf7",en="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qt="\\u2000-\\u206f",kn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ar="A-Z\\xc0-\\xd6\\xd8-\\xde",js="\\ufe0e\\ufe0f",Qr=Xt+en+qt+kn,Gt="[']",fr="["+ur+"]",Bt="["+Qr+"]",Gr="["+Qi+"]",Zs="\\d+",pa="["+hr+"]",Fr="["+Gn+"]",Za="[^"+ur+Qr+Zs+hr+Gn+Ar+"]",Oo="\\ud83c[\\udffb-\\udfff]",Qa="(?:"+Gr+"|"+Oo+")",ia="[^"+ur+"]",Qn="(?:\\ud83c[\\udde6-\\uddff]){2}",Aa="[\\ud800-\\udbff][\\udc00-\\udfff]",ds="["+Ar+"]",Wa="\\u200d",ol="(?:"+Fr+"|"+Za+")",ll="(?:"+ds+"|"+Za+")",lo="(?:"+Gt+"(?:d|ll|m|re|s|t|ve))?",$a="(?:"+Gt+"(?:D|LL|M|RE|S|T|VE))?",G=Qa+"?",we="["+js+"]?",at="(?:"+Wa+"(?:"+[ia,Qn,Aa].join("|")+")"+we+G+")*",Ct="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Yt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ii=we+G+at,Li="(?:"+[pa,Qn,Aa].join("|")+")"+Ii,An="(?:"+[ia+Gr+"?",Gr,Qn,Aa,fr].join("|")+")",pn=RegExp(Gt,"g"),or=RegExp(Gr,"g"),dr=RegExp(Oo+"(?="+Oo+")|"+An+Ii,"g"),qr=RegExp([ds+"?"+Fr+"+"+lo+"(?="+[Bt,ds,"$"].join("|")+")",ll+"+"+$a+"(?="+[Bt,ds+ol,"$"].join("|")+")",ds+"?"+ol+"+"+lo,ds+"+"+$a,Yt,Ct,Zs,Li].join("|"),"g"),Xa=RegExp("["+Wa+ur+Qi+js+"]"),Ya=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ka=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ml=-1,Wr={};Wr[K]=Wr[ie]=Wr[de]=Wr[be]=Wr[Ee]=Wr[Ce]=Wr[Re]=Wr[$e]=Wr[je]=!0,Wr[Zi]=Wr[Gi]=Wr[M]=Wr[xn]=Wr[U]=Wr[Ti]=Wr[Oi]=Wr[Vi]=Wr[wn]=Wr[xi]=Wr[Ot]=Wr[oi]=Wr[Yi]=Wr[Xn]=Wr[_n]=!1;var sr={};sr[Zi]=sr[Gi]=sr[M]=sr[U]=sr[xn]=sr[Ti]=sr[K]=sr[ie]=sr[de]=sr[be]=sr[Ee]=sr[wn]=sr[xi]=sr[Ot]=sr[oi]=sr[Yi]=sr[Xn]=sr[zn]=sr[Ce]=sr[Re]=sr[$e]=sr[je]=!0,sr[Oi]=sr[Vi]=sr[_n]=!1;var Mr={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Or={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ys={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Sr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ra=parseFloat,Nr=parseInt,ko=typeof s0=="object"&&s0&&s0.Object===Object&&s0,Qo=typeof self=="object"&&self&&self.Object===Object&&self,Ns=ko||Qo||Function("return this")(),Tl=e&&!e.nodeType&&e,yo=Tl&&!0&&t&&!t.nodeType&&t,Wo=yo&&yo.exports===Tl,ma=Wo&&ko.process,na=function(){try{var mi=yo&&yo.require&&yo.require("util").types;return mi||ma&&ma.binding&&ma.binding("util")}catch{}}(),kl=na&&na.isArrayBuffer,Ja=na&&na.isDate,Fa=na&&na.isMap,gl=na&&na.isRegExp,Ml=na&&na.isSet,yu=na&&na.isTypedArray;function ps(mi,qi,Di){switch(Di.length){case 0:return mi.call(qi);case 1:return mi.call(qi,Di[0]);case 2:return mi.call(qi,Di[0],Di[1]);case 3:return mi.call(qi,Di[0],Di[1],Di[2])}return mi.apply(qi,Di)}function lc(mi,qi,Di,Nt){for(var ni=-1,wi=mi==null?0:mi.length;++ni<wi;){var Ui=mi[ni];qi(Nt,Ui,Di(Ui),mi)}return Nt}function uo(mi,qi){for(var Di=-1,Nt=mi==null?0:mi.length;++Di<Nt&&qi(mi[Di],Di,mi)!==!1;);return mi}function co(mi,qi){for(var Di=mi==null?0:mi.length;Di--&&qi(mi[Di],Di,mi)!==!1;);return mi}function Xl(mi,qi){for(var Di=-1,Nt=mi==null?0:mi.length;++Di<Nt;)if(!qi(mi[Di],Di,mi))return!1;return!0}function No(mi,qi){for(var Di=-1,Nt=mi==null?0:mi.length,ni=0,wi=[];++Di<Nt;){var Ui=mi[Di];qi(Ui,Di,mi)&&(wi[ni++]=Ui)}return wi}function $o(mi,qi){var Di=mi==null?0:mi.length;return!!Di&&Jo(mi,qi,0)>-1}function Mo(mi,qi,Di){for(var Nt=-1,ni=mi==null?0:mi.length;++Nt<ni;)if(Di(qi,mi[Nt]))return!0;return!1}function Qs(mi,qi){for(var Di=-1,Nt=mi==null?0:mi.length,ni=Array(Nt);++Di<Nt;)ni[Di]=qi(mi[Di],Di,mi);return ni}function Xo(mi,qi){for(var Di=-1,Nt=qi.length,ni=mi.length;++Di<Nt;)mi[ni+Di]=qi[Di];return mi}function Yo(mi,qi,Di,Nt){var ni=-1,wi=mi==null?0:mi.length;for(Nt&&wi&&(Di=mi[++ni]);++ni<wi;)Di=qi(Di,mi[ni],ni,mi);return Di}function Ko(mi,qi,Di,Nt){var ni=mi==null?0:mi.length;for(Nt&&ni&&(Di=mi[--ni]);ni--;)Di=qi(Di,mi[ni],ni,mi);return Di}function Ta(mi,qi){for(var Di=-1,Nt=mi==null?0:mi.length;++Di<Nt;)if(qi(mi[Di],Di,mi))return!0;return!1}var eo=pr("length");function Ds(mi){return mi.split("")}function vu(mi){return mi.match(Pt)||[]}function Pr(mi,qi,Di){var Nt;return Di(mi,function(ni,wi,Ui){if(qi(ni,wi,Ui))return Nt=wi,!1}),Nt}function Kn(mi,qi,Di,Nt){for(var ni=mi.length,wi=Di+(Nt?1:-1);Nt?wi--:++wi<ni;)if(qi(mi[wi],wi,mi))return wi;return-1}function Jo(mi,qi,Di){return qi===qi?Hr(mi,qi,Di):Kn(mi,to,Di)}function Vr(mi,qi,Di,Nt){for(var ni=Di-1,wi=mi.length;++ni<wi;)if(Nt(mi[ni],qi))return ni;return-1}function to(mi){return mi!==mi}function ss(mi,qi){var Di=mi==null?0:mi.length;return Di?as(mi,qi)/Di:yi}function pr(mi){return function(qi){return qi==null?n:qi[mi]}}function Po(mi){return function(qi){return mi==null?n:mi[qi]}}function qn(mi,qi,Di,Nt,ni){return ni(mi,function(wi,Ui,On){Di=Nt?(Nt=!1,wi):qi(Di,wi,Ui,On)}),Di}function Ul(mi,qi){var Di=mi.length;for(mi.sort(qi);Di--;)mi[Di]=mi[Di].value;return mi}function as(mi,qi){for(var Di,Nt=-1,ni=mi.length;++Nt<ni;){var wi=qi(mi[Nt]);wi!==n&&(Di=Di===n?wi:Di+wi)}return Di}function Kr(mi,qi){for(var Di=-1,Nt=Array(mi);++Di<mi;)Nt[Di]=qi(Di);return Nt}function Ls(mi,qi){return Qs(qi,function(Di){return[Di,mi[Di]]})}function Br(mi){return mi&&mi.slice(0,Ma(mi)+1).replace(Je,"")}function ar(mi){return function(qi){return mi(qi)}}function ul(mi,qi){return Qs(qi,function(Di){return mi[Di]})}function is(mi,qi){return mi.has(qi)}function Do(mi,qi){for(var Di=-1,Nt=mi.length;++Di<Nt&&Jo(qi,mi[Di],0)>-1;);return Di}function cl(mi,qi){for(var Di=mi.length;Di--&&Jo(qi,mi[Di],0)>-1;);return Di}function Jr(mi,qi){for(var Di=mi.length,Nt=0;Di--;)mi[Di]===qi&&++Nt;return Nt}var gs=Po(Mr),ka=Po(Or);function Pl(mi){return"\\"+Sr[mi]}function Lo(mi,qi){return mi==null?n:mi[qi]}function Dl(mi){return Xa.test(mi)}function vo(mi){return Ya.test(mi)}function sa(mi){for(var qi,Di=[];!(qi=mi.next()).done;)Di.push(qi.value);return Di}function Ws(mi){var qi=-1,Di=Array(mi.size);return mi.forEach(function(Nt,ni){Di[++qi]=[ni,Nt]}),Di}function io(mi,qi){return function(Di){return mi(qi(Di))}}function el(mi,qi){for(var Di=-1,Nt=mi.length,ni=0,wi=[];++Di<Nt;){var Ui=mi[Di];(Ui===qi||Ui===he)&&(mi[Di]=he,wi[ni++]=Di)}return wi}function ns(mi){var qi=-1,Di=Array(mi.size);return mi.forEach(function(Nt){Di[++qi]=Nt}),Di}function vr(mi){var qi=-1,Di=Array(mi.size);return mi.forEach(function(Nt){Di[++qi]=[Nt,Nt]}),Di}function Hr(mi,qi,Di){for(var Nt=Di-1,ni=mi.length;++Nt<ni;)if(mi[Nt]===qi)return Nt;return-1}function ga(mi,qi,Di){for(var Nt=Di+1;Nt--;)if(mi[Nt]===qi)return Nt;return Nt}function xo(mi){return Dl(mi)?no(mi):eo(mi)}function aa(mi){return Dl(mi)?hl(mi):Ds(mi)}function Ma(mi){for(var qi=mi.length;qi--&&et.test(mi.charAt(qi)););return qi}var Oa=Po(Ys);function no(mi){for(var qi=dr.lastIndex=0;dr.test(mi);)++qi;return qi}function hl(mi){return mi.match(dr)||[]}function cu(mi){return mi.match(qr)||[]}var _l=function mi(qi){qi=qi==null?Ns:ho.defaults(Ns.Object(),qi,ho.pick(Ns,Ka));var Di=qi.Array,Nt=qi.Date,ni=qi.Error,wi=qi.Function,Ui=qi.Math,On=qi.Object,jn=qi.RegExp,cr=qi.String,Jn=qi.TypeError,$s=Di.prototype,Bs=wi.prototype,_s=On.prototype,ro=qi["__core-js_shared__"],bo=Bs.toString,cs=_s.hasOwnProperty,Yu=0,Nu=function(){var D=/[^.]+$/.exec(ro&&ro.keys&&ro.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""}(),wo=_s.toString,Ll=bo.call(On),Rn=Ns._,Na=jn("^"+bo.call(cs).replace(Oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),En=Wo?qi.Buffer:n,Vo=qi.Symbol,Gl=qi.Uint8Array,Cn=En?En.allocUnsafe:n,Yl=io(On.getPrototypeOf,On),Tn=On.create,yl=_s.propertyIsEnumerable,hu=$s.splice,Vu=Vo?Vo.isConcatSpreadable:n,ql=Vo?Vo.iterator:n,vl=Vo?Vo.toStringTag:n,oa=function(){try{var D=iA(On,"defineProperty");return D({},"",{}),D}catch{}}(),uc=qi.clearTimeout!==Ns.clearTimeout&&qi.clearTimeout,Ku=Nt&&Nt.now!==Ns.Date.now&&Nt.now,Kl=qi.setTimeout!==Ns.setTimeout&&qi.setTimeout,ys=Ui.ceil,wa=Ui.floor,tl=On.getOwnPropertySymbols,xu=En?En.isBuffer:n,Uu=qi.isFinite,Au=$s.join,Gu=io(On.keys,On),br=Ui.max,vs=Ui.min,gn=Nt.now,Zn=qi.parseInt,ir=Ui.random,il=$s.reverse,Pu=iA(qi,"DataView"),fa=iA(qi,"Map"),bu=iA(qi,"Promise"),Is=iA(qi,"Set"),Bo=iA(qi,"WeakMap"),Mi=iA(On,"create"),zi=Bo&&new Bo,Es={},wu=nh(Pu),Uo=nh(fa),ms=nh(bu),Al=nh(Is),zs=nh(Bo),T=Vo?Vo.prototype:n,L=T?T.valueOf:n,R=T?T.toString:n;function F(D){if(Rt(D)&&!f(D)&&!(D instanceof Se)){if(D instanceof le)return D;if(cs.call(D,"__wrapped__"))return gd(D)}return new le(D)}var te=function(){function D(){}return function(j){if(!Lt(j))return{};if(Tn)return Tn(j);D.prototype=j;var me=new D;return D.prototype=n,me}}();function ue(){}function le(D,j){this.__wrapped__=D,this.__actions__=[],this.__chain__=!!j,this.__index__=0,this.__values__=n}F.templateSettings={escape:X,evaluate:ne,interpolate:pe,variable:"",imports:{_:F}},F.prototype=ue.prototype,F.prototype.constructor=F,le.prototype=te(ue.prototype),le.prototype.constructor=le;function Se(D){this.__wrapped__=D,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ci,this.__views__=[]}function Xe(){var D=new Se(this.__wrapped__);return D.__actions__=bl(this.__actions__),D.__dir__=this.__dir__,D.__filtered__=this.__filtered__,D.__iteratees__=bl(this.__iteratees__),D.__takeCount__=this.__takeCount__,D.__views__=bl(this.__views__),D}function bt(){if(this.__filtered__){var D=new Se(this);D.__dir__=-1,D.__filtered__=!0}else D=this.clone(),D.__dir__*=-1;return D}function kt(){var D=this.__wrapped__.value(),j=this.__dir__,me=f(D),Qe=j<0,Et=me?D.length:0,jt=Rm(0,Et,this.__views__),ci=jt.start,pi=jt.end,Pi=pi-ci,hn=Qe?pi:ci-1,fn=this.__iteratees__,vn=fn.length,er=0,Ir=vs(Pi,this.__takeCount__);if(!me||!Qe&&Et==Pi&&Ir==Pi)return v0(D,this.__actions__);var es=[];e:for(;Pi--&&er<Ir;){hn+=j;for(var Xs=-1,ts=D[hn];++Xs<vn;){var ha=fn[Xs],va=ha.iteratee,fh=ha.type,gc=va(ts);if(fh==_t)ts=gc;else if(!gc){if(fh==Ye)continue e;break e}}es[er++]=ts}return es}Se.prototype=te(ue.prototype),Se.prototype.constructor=Se;function ri(D){var j=-1,me=D==null?0:D.length;for(this.clear();++j<me;){var Qe=D[j];this.set(Qe[0],Qe[1])}}function Ht(){this.__data__=Mi?Mi(null):{},this.size=0}function Qt(D){var j=this.has(D)&&delete this.__data__[D];return this.size-=j?1:0,j}function Q(D){var j=this.__data__;if(Mi){var me=j[D];return me===N?n:me}return cs.call(j,D)?j[D]:n}function A(D){var j=this.__data__;return Mi?j[D]!==n:cs.call(j,D)}function C(D,j){var me=this.__data__;return this.size+=this.has(D)?0:1,me[D]=Mi&&j===n?N:j,this}ri.prototype.clear=Ht,ri.prototype.delete=Qt,ri.prototype.get=Q,ri.prototype.has=A,ri.prototype.set=C;function O(D){var j=-1,me=D==null?0:D.length;for(this.clear();++j<me;){var Qe=D[j];this.set(Qe[0],Qe[1])}}function V(){this.__data__=[],this.size=0}function x(D){var j=this.__data__,me=ii(j,D);if(me<0)return!1;var Qe=j.length-1;return me==Qe?j.pop():hu.call(j,me,1),--this.size,!0}function s(D){var j=this.__data__,me=ii(j,D);return me<0?n:j[me][1]}function i(D){return ii(this.__data__,D)>-1}function r(D,j){var me=this.__data__,Qe=ii(me,D);return Qe<0?(++this.size,me.push([D,j])):me[Qe][1]=j,this}O.prototype.clear=V,O.prototype.delete=x,O.prototype.get=s,O.prototype.has=i,O.prototype.set=r;function l(D){var j=-1,me=D==null?0:D.length;for(this.clear();++j<me;){var Qe=D[j];this.set(Qe[0],Qe[1])}}function d(){this.size=0,this.__data__={hash:new ri,map:new(fa||O),string:new ri}}function y(D){var j=kf(this,D).delete(D);return this.size-=j?1:0,j}function I(D){return kf(this,D).get(D)}function k(D){return kf(this,D).has(D)}function z(D,j){var me=kf(this,D),Qe=me.size;return me.set(D,j),this.size+=me.size==Qe?0:1,this}l.prototype.clear=d,l.prototype.delete=y,l.prototype.get=I,l.prototype.has=k,l.prototype.set=z;function Z(D){var j=-1,me=D==null?0:D.length;for(this.__data__=new l;++j<me;)this.add(D[j])}function Y(D){return this.__data__.set(D,N),this}function Ae(D){return this.__data__.has(D)}Z.prototype.add=Z.prototype.push=Y,Z.prototype.has=Ae;function Ie(D){var j=this.__data__=new O(D);this.size=j.size}function ke(){this.__data__=new O,this.size=0}function Fe(D){var j=this.__data__,me=j.delete(D);return this.size=j.size,me}function ze(D){return this.__data__.get(D)}function tt(D){return this.__data__.has(D)}function wt(D,j){var me=this.__data__;if(me instanceof O){var Qe=me.__data__;if(!fa||Qe.length<g-1)return Qe.push([D,j]),this.size=++me.size,this;me=this.__data__=new l(Qe)}return me.set(D,j),this.size=me.size,this}Ie.prototype.clear=ke,Ie.prototype.delete=Fe,Ie.prototype.get=ze,Ie.prototype.has=tt,Ie.prototype.set=wt;function lt(D,j){var me=f(D),Qe=!me&&Ne(D),Et=!me&&!Qe&&q(D),jt=!me&&!Qe&&!Et&&Un(D),ci=me||Qe||Et||jt,pi=ci?Kr(D.length,cr):[],Pi=pi.length;for(var hn in D)(j||cs.call(D,hn))&&!(ci&&(hn=="length"||Et&&(hn=="offset"||hn=="parent")||jt&&(hn=="buffer"||hn=="byteLength"||hn=="byteOffset")||Dc(hn,Pi)))&&pi.push(hn);return pi}function ft(D){var j=D.length;return j?D[vA(0,j-1)]:n}function Tt(D,j){return Pf(bl(D),ji(j,0,D.length))}function It(D){return Pf(bl(D))}function si(D,j,me){(me!==n&&!ee(D[j],me)||me===n&&!(j in D))&&Ei(D,j,me)}function Kt(D,j,me){var Qe=D[j];(!(cs.call(D,j)&&ee(Qe,me))||me===n&&!(j in D))&&Ei(D,j,me)}function ii(D,j){for(var me=D.length;me--;)if(ee(D[me][0],j))return me;return-1}function ai(D,j,me,Qe){return nr(D,function(Et,jt,ci){j(Qe,Et,me(Et),ci)}),Qe}function Wi(D,j){return D&&hc(j,mo(j),D)}function $i(D,j){return D&&hc(j,Co(j),D)}function Ei(D,j,me){j=="__proto__"&&oa?oa(D,j,{configurable:!0,enumerable:!0,value:me,writable:!0}):D[j]=me}function Hi(D,j){for(var me=-1,Qe=j.length,Et=Di(Qe),jt=D==null;++me<Qe;)Et[me]=jt?n:iu(D,j[me]);return Et}function ji(D,j,me){return D===D&&(me!==n&&(D=D<=me?D:me),j!==n&&(D=D>=j?D:j)),D}function cn(D,j,me,Qe,Et,jt){var ci,pi=j&oe,Pi=j&ce,hn=j&_e;if(me&&(ci=Et?me(D,Qe,Et,jt):me(D)),ci!==n)return ci;if(!Lt(D))return D;var fn=f(D);if(fn){if(ci=Om(D),!pi)return bl(D,ci)}else{var vn=Hl(D),er=vn==Vi||vn==bn;if(q(D))return td(D,pi);if(vn==Ot||vn==Zi||er&&!Et){if(ci=Pi||er?{}:ld(D),!pi)return Pi?wf(D,$i(ci,D)):Xh(D,Wi(ci,D))}else{if(!sr[vn])return Et?D:{};ci=nA(D,vn,pi)}}jt||(jt=new Ie);var Ir=jt.get(D);if(Ir)return Ir;jt.set(D,ci),on(D)?D.forEach(function(ts){ci.add(cn(ts,j,me,ts,D,jt))}):ei(D)&&D.forEach(function(ts,ha){ci.set(ha,cn(ts,j,me,ha,D,jt))});var es=hn?Pi?Tf:Ch:Pi?Co:mo,Xs=fn?n:es(D);return uo(Xs||D,function(ts,ha){Xs&&(ha=ts,ts=D[ha]),Kt(ci,ha,cn(ts,j,me,ha,D,jt))}),ci}function Nn(D){var j=mo(D);return function(me){return nn(me,D,j)}}function nn(D,j,me){var Qe=me.length;if(D==null)return!Qe;for(D=On(D);Qe--;){var Et=me[Qe],jt=j[Et],ci=D[Et];if(ci===n&&!(Et in D)||!jt(ci))return!1}return!0}function Mn(D,j,me){if(typeof D!="function")throw new Jn(S);return BA(function(){D.apply(n,me)},j)}function wr(D,j,me,Qe){var Et=-1,jt=$o,ci=!0,pi=D.length,Pi=[],hn=j.length;if(!pi)return Pi;me&&(j=Qs(j,ar(me))),Qe?(jt=Mo,ci=!1):j.length>=g&&(jt=is,ci=!1,j=new Z(j));e:for(;++Et<pi;){var fn=D[Et],vn=me==null?fn:me(fn);if(fn=Qe||fn!==0?fn:0,ci&&vn===vn){for(var er=hn;er--;)if(j[er]===vn)continue e;Pi.push(fn)}else jt(j,vn,Qe)||Pi.push(fn)}return Pi}var nr=x0(Io),Pa=x0(Ks,!0);function _a(D,j){var me=!0;return nr(D,function(Qe,Et,jt){return me=!!j(Qe,Et,jt),me}),me}function Vs(D,j,me){for(var Qe=-1,Et=D.length;++Qe<Et;){var jt=D[Qe],ci=j(jt);if(ci!=null&&(pi===n?ci===ci&&!Fn(ci):me(ci,pi)))var pi=ci,Pi=jt}return Pi}function Ao(D,j,me,Qe){var Et=D.length;for(me=Yn(me),me<0&&(me=-me>Et?0:Et+me),Qe=Qe===n||Qe>Et?Et:Yn(Qe),Qe<0&&(Qe+=Et),Qe=me>Qe?0:Ts(Qe);me<Qe;)D[me++]=j;return D}function fo(D,j){var me=[];return nr(D,function(Qe,Et,jt){j(Qe,Et,jt)&&me.push(Qe)}),me}function $r(D,j,me,Qe,Et){var jt=-1,ci=D.length;for(me||(me=Dp),Et||(Et=[]);++jt<ci;){var pi=D[jt];j>0&&me(pi)?j>1?$r(pi,j-1,me,Qe,Et):Xo(Et,pi):Qe||(Et[Et.length]=pi)}return Et}var Sa=Sf(),So=Sf(!0);function Io(D,j){return D&&Sa(D,j,mo)}function Ks(D,j){return D&&So(D,j,mo)}function os(D,j){return No(j,function(me){return pt(D[me])})}function ls(D,j){j=wh(j,D);for(var me=0,Qe=j.length;D!=null&&me<Qe;)D=D[bs(j[me++])];return me&&me==Qe?D:n}function Ur(D,j,me){var Qe=j(D);return f(D)?Qe:Xo(Qe,me(D))}function Cs(D){return D==null?D===n?Wn:Bn:vl&&vl in On(D)?Mf(D):Ad(D)}function Js(D,j){return D>j}function zo(D,j){return D!=null&&cs.call(D,j)}function Go(D,j){return D!=null&&j in On(D)}function qo(D,j,me){return D>=vs(j,me)&&D<br(j,me)}function Cc(D,j,me){for(var Qe=me?Mo:$o,Et=D[0].length,jt=D.length,ci=jt,pi=Di(jt),Pi=1/0,hn=[];ci--;){var fn=D[ci];ci&&j&&(fn=Qs(fn,ar(j))),Pi=vs(fn.length,Pi),pi[ci]=!me&&(j||Et>=120&&fn.length>=120)?new Z(ci&&fn):n}fn=D[0];var vn=-1,er=pi[0];e:for(;++vn<Et&&hn.length<Pi;){var Ir=fn[vn],es=j?j(Ir):Ir;if(Ir=me||Ir!==0?Ir:0,!(er?is(er,es):Qe(hn,es,me))){for(ci=jt;--ci;){var Xs=pi[ci];if(!(Xs?is(Xs,es):Qe(D[ci],es,me)))continue e}er&&er.push(es),hn.push(Ir)}}return hn}function ea(D,j,me,Qe){return Io(D,function(Et,jt,ci){j(Qe,me(Et),jt,ci)}),Qe}function Jl(D,j,me){j=wh(j,D),D=dd(D,j);var Qe=D==null?D:D[bs(Du(j))];return Qe==null?n:ps(Qe,D,me)}function fu(D){return Rt(D)&&Cs(D)==Zi}function nl(D){return Rt(D)&&Cs(D)==M}function xl(D){return Rt(D)&&Cs(D)==Ti}function Bl(D,j,me,Qe,Et){return D===j?!0:D==null||j==null||!Rt(D)&&!Rt(j)?D!==D&&j!==j:du(D,j,me,Qe,Bl,Et)}function du(D,j,me,Qe,Et,jt){var ci=f(D),pi=f(j),Pi=ci?Gi:Hl(D),hn=pi?Gi:Hl(j);Pi=Pi==Zi?Ot:Pi,hn=hn==Zi?Ot:hn;var fn=Pi==Ot,vn=hn==Ot,er=Pi==hn;if(er&&q(D)){if(!q(j))return!1;ci=!0,fn=!1}if(er&&!fn)return jt||(jt=new Ie),ci||Un(D)?sd(D,j,me,Qe,Et,jt):Eh(D,j,Pi,me,Qe,Et,jt);if(!(me&Ze)){var Ir=fn&&cs.call(D,"__wrapped__"),es=vn&&cs.call(j,"__wrapped__");if(Ir||es){var Xs=Ir?D.value():D,ts=es?j.value():j;return jt||(jt=new Ie),Et(Xs,ts,me,Qe,jt)}}return er?(jt||(jt=new Ie),zm(D,j,me,Qe,Et,jt)):!1}function Af(D){return Rt(D)&&Hl(D)==wn}function qh(D,j,me,Qe){var Et=me.length,jt=Et,ci=!Qe;if(D==null)return!jt;for(D=On(D);Et--;){var pi=me[Et];if(ci&&pi[2]?pi[1]!==D[pi[0]]:!(pi[0]in D))return!1}for(;++Et<jt;){pi=me[Et];var Pi=pi[0],hn=D[Pi],fn=pi[1];if(ci&&pi[2]){if(hn===n&&!(Pi in D))return!1}else{var vn=new Ie;if(Qe)var er=Qe(hn,fn,Pi,D,j,vn);if(!(er===n?Bl(fn,hn,Ze|nt,Qe,vn):er))return!1}}return!0}function Va(D){if(!Lt(D)||Lp(D))return!1;var j=pt(D)?Na:ui;return j.test(nh(D))}function yA(D){return Rt(D)&&Cs(D)==oi}function vh(D){return Rt(D)&&Hl(D)==Yi}function Hh(D){return Rt(D)&&Dt(D.length)&&!!Wr[Cs(D)]}function Tc(D){return typeof D=="function"?D:D==null?Vc:typeof D=="object"?f(D)?ff(D[0],D[1]):Zh(D):G2(D)}function jh(D){if(!DA(D))return Gu(D);var j=[];for(var me in On(D))cs.call(D,me)&&me!="constructor"&&j.push(me);return j}function m0(D){if(!Lt(D))return fl(D);var j=DA(D),me=[];for(var Qe in D)Qe=="constructor"&&(j||!cs.call(D,Qe))||me.push(Qe);return me}function Yc(D,j){return D<j}function Sp(D,j){var me=-1,Qe=p(D)?Di(D.length):[];return nr(D,function(Et,jt,ci){Qe[++me]=j(Et,jt,ci)}),Qe}function Zh(D){var j=ad(D);return j.length==1&&j[0][2]?hd(j[0][0],j[0][1]):function(me){return me===D||qh(me,D,j)}}function ff(D,j){return PA(D)&&S0(j)?hd(bs(D),j):function(me){var Qe=iu(me,D);return Qe===n&&Qe===j?lA(me,D):Bl(j,Qe,Ze|nt)}}function Kc(D,j,me,Qe,Et){D!==j&&Sa(j,function(jt,ci){if(Et||(Et=new Ie),Lt(jt))Ip(D,j,ci,me,Kc,Qe,Et);else{var pi=Qe?Qe(LA(D,ci),jt,ci+"",D,j,Et):n;pi===n&&(pi=jt),si(D,ci,pi)}},Co)}function Ip(D,j,me,Qe,Et,jt,ci){var pi=LA(D,me),Pi=LA(j,me),hn=ci.get(Pi);if(hn){si(D,me,hn);return}var fn=jt?jt(pi,Pi,me+"",D,j,ci):n,vn=fn===n;if(vn){var er=f(Pi),Ir=!er&&q(Pi),es=!er&&!Ir&&Un(Pi);fn=Pi,er||Ir||es?f(pi)?fn=pi:E(pi)?fn=bl(pi):Ir?(vn=!1,fn=td(Pi,!0)):es?(vn=!1,fn=Ro(Pi,!0)):fn=[]:ln(Pi)||Ne(Pi)?(fn=pi,Ne(pi)?fn=ua(pi):(!Lt(pi)||pt(pi))&&(fn=ld(Pi))):vn=!1}vn&&(ci.set(Pi,fn),Et(fn,Pi,Qe,jt,ci),ci.delete(Pi)),si(D,me,fn)}function df(D,j){var me=D.length;if(me)return j+=j<0?me:0,Dc(j,me)?D[j]:n}function X0(D,j,me){j.length?j=Qs(j,function(jt){return f(jt)?function(ci){return ls(ci,jt.length===1?jt[0]:jt)}:jt}):j=[Vc];var Qe=-1;j=Qs(j,ar(Dr()));var Et=Sp(D,function(jt,ci,pi){var Pi=Qs(j,function(hn){return hn(jt)});return{criteria:Pi,index:++Qe,value:jt}});return Ul(Et,function(jt,ci){return Cp(jt,ci,me)})}function eu(D,j){return Ju(D,j,function(me,Qe){return lA(D,Qe)})}function Ju(D,j,me){for(var Qe=-1,Et=j.length,jt={};++Qe<Et;){var ci=j[Qe],pi=ls(D,ci);me(pi,ci)&&Wh(jt,wh(ci,D),pi)}return jt}function Y0(D){return function(j){return ls(j,D)}}function xh(D,j,me,Qe){var Et=Qe?Vr:Jo,jt=-1,ci=j.length,pi=D;for(D===j&&(j=bl(j)),me&&(pi=Qs(D,ar(me)));++jt<ci;)for(var Pi=0,hn=j[jt],fn=me?me(hn):hn;(Pi=Et(pi,fn,Pi,Qe))>-1;)pi!==D&&hu.call(pi,Pi,1),hu.call(D,Pi,1);return D}function Jc(D,j){for(var me=D?j.length:0,Qe=me-1;me--;){var Et=j[me];if(me==Qe||Et!==jt){var jt=Et;Dc(Et)?hu.call(D,Et,1):gf(D,Et)}}return D}function vA(D,j){return D+wa(ir()*(j-D+1))}function pf(D,j,me,Qe){for(var Et=-1,jt=br(ys((j-D)/(me||1)),0),ci=Di(jt);jt--;)ci[Qe?jt:++Et]=D,D+=me;return ci}function g0(D,j){var me="";if(!D||j<1||j>Ft)return me;do j%2&&(me+=D),j=wa(j/2),j&&(D+=D);while(j);return me}function xs(D,j){return Eu(fd(D,j,Vc),D+"")}function tu(D){return ft(Nc(D))}function Qh(D,j){var me=Nc(D);return Pf(me,ji(j,0,me.length))}function Wh(D,j,me,Qe){if(!Lt(D))return D;j=wh(j,D);for(var Et=-1,jt=j.length,ci=jt-1,pi=D;pi!=null&&++Et<jt;){var Pi=bs(j[Et]),hn=me;if(Pi==="__proto__"||Pi==="constructor"||Pi==="prototype")return D;if(Et!=ci){var fn=pi[Pi];hn=Qe?Qe(fn,Pi,pi):n,hn===n&&(hn=Lt(fn)?fn:Dc(j[Et+1])?[]:{})}Kt(pi,Pi,hn),pi=pi[Pi]}return D}var mf=zi?function(D,j){return zi.set(D,j),D}:Vc,xA=oa?function(D,j){return oa(D,"toString",{configurable:!0,enumerable:!1,value:k1(j),writable:!0})}:Vc;function K0(D){return Pf(Nc(D))}function zl(D,j,me){var Qe=-1,Et=D.length;j<0&&(j=-j>Et?0:Et+j),me=me>Et?Et:me,me<0&&(me+=Et),Et=j>me?0:me-j>>>0,j>>>=0;for(var jt=Di(Et);++Qe<Et;)jt[Qe]=D[Qe+j];return jt}function qu(D,j){var me;return nr(D,function(Qe,Et,jt){return me=j(Qe,Et,jt),!me}),!!me}function bA(D,j,me){var Qe=0,Et=D==null?Qe:D.length;if(typeof j=="number"&&j===j&&Et<=Ni){for(;Qe<Et;){var jt=Qe+Et>>>1,ci=D[jt];ci!==null&&!Fn(ci)&&(me?ci<=j:ci<j)?Qe=jt+1:Et=jt}return Et}return _0(D,j,Vc,me)}function _0(D,j,me,Qe){var Et=0,jt=D==null?0:D.length;if(jt===0)return 0;j=me(j);for(var ci=j!==j,pi=j===null,Pi=Fn(j),hn=j===n;Et<jt;){var fn=wa((Et+jt)/2),vn=me(D[fn]),er=vn!==n,Ir=vn===null,es=vn===vn,Xs=Fn(vn);if(ci)var ts=Qe||es;else hn?ts=es&&(Qe||er):pi?ts=es&&er&&(Qe||!Ir):Pi?ts=es&&er&&!Ir&&(Qe||!Xs):Ir||Xs?ts=!1:ts=Qe?vn<=j:vn<j;ts?Et=fn+1:jt=fn}return vs(jt,ki)}function y0(D,j){for(var me=-1,Qe=D.length,Et=0,jt=[];++me<Qe;){var ci=D[me],pi=j?j(ci):ci;if(!me||!ee(pi,Pi)){var Pi=pi;jt[Et++]=ci===0?0:ci}}return jt}function Ep(D){return typeof D=="number"?D:Fn(D)?yi:+D}function Su(D){if(typeof D=="string")return D;if(f(D))return Qs(D,Su)+"";if(Fn(D))return R?R.call(D):"";var j=D+"";return j=="0"&&1/D==-Ut?"-0":j}function eh(D,j,me){var Qe=-1,Et=$o,jt=D.length,ci=!0,pi=[],Pi=pi;if(me)ci=!1,Et=Mo;else if(jt>=g){var hn=j?null:rd(D);if(hn)return ns(hn);ci=!1,Et=is,Pi=new Z}else Pi=j?[]:pi;e:for(;++Qe<jt;){var fn=D[Qe],vn=j?j(fn):fn;if(fn=me||fn!==0?fn:0,ci&&vn===vn){for(var er=Pi.length;er--;)if(Pi[er]===vn)continue e;j&&Pi.push(vn),pi.push(fn)}else Et(Pi,vn,me)||(Pi!==pi&&Pi.push(vn),pi.push(fn))}return pi}function gf(D,j){return j=wh(j,D),D=dd(D,j),D==null||delete D[bs(Du(j))]}function bh(D,j,me,Qe){return Wh(D,j,me(ls(D,j)),Qe)}function Rl(D,j,me,Qe){for(var Et=D.length,jt=Qe?Et:-1;(Qe?jt--:++jt<Et)&&j(D[jt],jt,D););return me?zl(D,Qe?0:jt,Qe?jt+1:Et):zl(D,Qe?jt+1:0,Qe?Et:jt)}function v0(D,j){var me=D;return me instanceof Se&&(me=me.value()),Yo(j,function(Qe,Et){return Et.func.apply(Et.thisArg,Xo([Qe],Et.args))},me)}function th(D,j,me){var Qe=D.length;if(Qe<2)return Qe?eh(D[0]):[];for(var Et=-1,jt=Di(Qe);++Et<Qe;)for(var ci=D[Et],pi=-1;++pi<Qe;)pi!=Et&&(jt[Et]=wr(jt[Et]||ci,D[pi],j,me));return eh($r(jt,1),j,me)}function $h(D,j,me){for(var Qe=-1,Et=D.length,jt=j.length,ci={};++Qe<Et;){var pi=Qe<jt?j[Qe]:n;me(ci,D[Qe],pi)}return ci}function J0(D){return E(D)?D:[]}function ed(D){return typeof D=="function"?D:Vc}function wh(D,j){return f(D)?D:PA(D,j)?[D]:md(tr(D))}var Lm=xs;function kc(D,j,me){var Qe=D.length;return me=me===n?Qe:me,!j&&me>=Qe?D:zl(D,j,me)}var _f=uc||function(D){return Ns.clearTimeout(D)};function td(D,j){if(j)return D.slice();var me=D.length,Qe=Cn?Cn(me):new D.constructor(me);return D.copy(Qe),Qe}function cc(D){var j=new D.constructor(D.byteLength);return new Gl(j).set(new Gl(D)),j}function yf(D,j){var me=j?cc(D.buffer):D.buffer;return new D.constructor(me,D.byteOffset,D.byteLength)}function wA(D){var j=new D.constructor(D.source,di.exec(D));return j.lastIndex=D.lastIndex,j}function Bm(D){return L?On(L.call(D)):{}}function Ro(D,j){var me=j?cc(D.buffer):D.buffer;return new D.constructor(me,D.byteOffset,D.length)}function vf(D,j){if(D!==j){var me=D!==n,Qe=D===null,Et=D===D,jt=Fn(D),ci=j!==n,pi=j===null,Pi=j===j,hn=Fn(j);if(!pi&&!hn&&!jt&&D>j||jt&&ci&&Pi&&!pi&&!hn||Qe&&ci&&Pi||!me&&Pi||!Et)return 1;if(!Qe&&!jt&&!hn&&D<j||hn&&me&&Et&&!Qe&&!jt||pi&&me&&Et||!ci&&Et||!Pi)return-1}return 0}function Cp(D,j,me){for(var Qe=-1,Et=D.criteria,jt=j.criteria,ci=Et.length,pi=me.length;++Qe<ci;){var Pi=vf(Et[Qe],jt[Qe]);if(Pi){if(Qe>=pi)return Pi;var hn=me[Qe];return Pi*(hn=="desc"?-1:1)}}return D.index-j.index}function xf(D,j,me,Qe){for(var Et=-1,jt=D.length,ci=me.length,pi=-1,Pi=j.length,hn=br(jt-ci,0),fn=Di(Pi+hn),vn=!Qe;++pi<Pi;)fn[pi]=j[pi];for(;++Et<ci;)(vn||Et<jt)&&(fn[me[Et]]=D[Et]);for(;hn--;)fn[pi++]=D[Et++];return fn}function bf(D,j,me,Qe){for(var Et=-1,jt=D.length,ci=-1,pi=me.length,Pi=-1,hn=j.length,fn=br(jt-pi,0),vn=Di(fn+hn),er=!Qe;++Et<fn;)vn[Et]=D[Et];for(var Ir=Et;++Pi<hn;)vn[Ir+Pi]=j[Pi];for(;++ci<pi;)(er||Et<jt)&&(vn[Ir+me[ci]]=D[Et++]);return vn}function bl(D,j){var me=-1,Qe=D.length;for(j||(j=Di(Qe));++me<Qe;)j[me]=D[me];return j}function hc(D,j,me,Qe){var Et=!me;me||(me={});for(var jt=-1,ci=j.length;++jt<ci;){var pi=j[jt],Pi=Qe?Qe(me[pi],D[pi],pi,me,D):n;Pi===n&&(Pi=D[pi]),Et?Ei(me,pi,Pi):Kt(me,pi,Pi)}return me}function Xh(D,j){return hc(D,kA(D),j)}function wf(D,j){return hc(D,MA(D),j)}function Ua(D,j){return function(me,Qe){var Et=f(me)?lc:ai,jt=j?j():{};return Et(me,D,Dr(Qe,2),jt)}}function Ac(D){return xs(function(j,me){var Qe=-1,Et=me.length,jt=Et>1?me[Et-1]:n,ci=Et>2?me[2]:n;for(jt=D.length>3&&typeof jt=="function"?(Et--,jt):n,ci&&Iu(me[0],me[1],ci)&&(jt=Et<3?n:jt,Et=1),j=On(j);++Qe<Et;){var pi=me[Qe];pi&&D(j,pi,Qe,jt)}return j})}function x0(D,j){return function(me,Qe){if(me==null)return me;if(!p(me))return D(me,Qe);for(var Et=me.length,jt=j?Et:-1,ci=On(me);(j?jt--:++jt<Et)&&Qe(ci[jt],jt,ci)!==!1;);return me}}function Sf(D){return function(j,me,Qe){for(var Et=-1,jt=On(j),ci=Qe(j),pi=ci.length;pi--;){var Pi=ci[D?pi:++Et];if(me(jt[Pi],Pi,jt)===!1)break}return j}}function If(D,j,me){var Qe=j&Ke,Et=Sh(D);function jt(){var ci=this&&this!==Ns&&this instanceof jt?Et:D;return ci.apply(Qe?me:this,arguments)}return jt}function Mc(D){return function(j){j=tr(j);var me=Dl(j)?aa(j):n,Qe=me?me[0]:j.charAt(0),Et=me?kc(me,1).join(""):j.slice(1);return Qe[D]()+Et}}function Yh(D){return function(j){return Yo(V2(N2(j).replace(pn,"")),D,"")}}function Sh(D){return function(){var j=arguments;switch(j.length){case 0:return new D;case 1:return new D(j[0]);case 2:return new D(j[0],j[1]);case 3:return new D(j[0],j[1],j[2]);case 4:return new D(j[0],j[1],j[2],j[3]);case 5:return new D(j[0],j[1],j[2],j[3],j[4]);case 6:return new D(j[0],j[1],j[2],j[3],j[4],j[5]);case 7:return new D(j[0],j[1],j[2],j[3],j[4],j[5],j[6])}var me=te(D.prototype),Qe=D.apply(me,j);return Lt(Qe)?Qe:me}}function Ef(D,j,me){var Qe=Sh(D);function Et(){for(var jt=arguments.length,ci=Di(jt),pi=jt,Pi=tA(Et);pi--;)ci[pi]=arguments[pi];var hn=jt<3&&ci[0]!==Pi&&ci[jt-1]!==Pi?[]:el(ci,Pi);if(jt-=hn.length,jt<me)return fc(D,j,Kh,Et.placeholder,n,ci,hn,n,n,me-jt);var fn=this&&this!==Ns&&this instanceof Et?Qe:D;return ps(fn,this,ci)}return Et}function SA(D){return function(j,me,Qe){var Et=On(j);if(!p(j)){var jt=Dr(me,3);j=mo(j),me=function(pi){return jt(Et[pi],pi,Et)}}var ci=D(j,me,Qe);return ci>-1?Et[jt?j[ci]:ci]:n}}function IA(D){return Pc(function(j){var me=j.length,Qe=me,Et=le.prototype.thru;for(D&&j.reverse();Qe--;){var jt=j[Qe];if(typeof jt!="function")throw new Jn(S);if(Et&&!ci&&TA(jt)=="wrapper")var ci=new le([],!0)}for(Qe=ci?Qe:me;++Qe<me;){jt=j[Qe];var pi=TA(jt),Pi=pi=="wrapper"?eA(jt):n;Pi&&w0(Pi[0])&&Pi[1]==($t|xt|Mt|rt)&&!Pi[4].length&&Pi[9]==1?ci=ci[TA(Pi[0])].apply(ci,Pi[3]):ci=jt.length==1&&w0(jt)?ci[pi]():ci.thru(jt)}return function(){var hn=arguments,fn=hn[0];if(ci&&hn.length==1&&f(fn))return ci.plant(fn).value();for(var vn=0,er=me?j[vn].apply(this,hn):fn;++vn<me;)er=j[vn].call(this,er);return er}})}function Kh(D,j,me,Qe,Et,jt,ci,pi,Pi,hn){var fn=j&$t,vn=j&Ke,er=j&st,Ir=j&(xt|zt),es=j&gt,Xs=er?n:Sh(D);function ts(){for(var ha=arguments.length,va=Di(ha),fh=ha;fh--;)va[fh]=arguments[fh];if(Ir)var gc=tA(ts),dh=Jr(va,gc);if(Qe&&(va=xf(va,Qe,Et,Ir)),jt&&(va=bf(va,jt,ci,Ir)),ha-=dh,Ir&&ha<hn){var su=el(va,gc);return fc(D,j,Kh,ts.placeholder,me,va,su,pi,Pi,hn-ha)}var uA=vn?me:this,Xf=er?uA[D]:D;return ha=va.length,pi?va=ya(va,pi):es&&ha>1&&va.reverse(),fn&&Pi<ha&&(va.length=Pi),this&&this!==Ns&&this instanceof ts&&(Xf=Xs||Sh(Xf)),Xf.apply(uA,va)}return ts}function id(D,j){return function(me,Qe){return ea(me,D,j(Qe),{})}}function EA(D,j){return function(me,Qe){var Et;if(me===n&&Qe===n)return j;if(me!==n&&(Et=me),Qe!==n){if(Et===n)return Qe;typeof me=="string"||typeof Qe=="string"?(me=Su(me),Qe=Su(Qe)):(me=Ep(me),Qe=Ep(Qe)),Et=D(me,Qe)}return Et}}function Jh(D){return Pc(function(j){return j=Qs(j,ar(Dr())),xs(function(me){var Qe=this;return D(j,function(Et){return ps(Et,Qe,me)})})})}function b0(D,j){j=j===n?" ":Su(j);var me=j.length;if(me<2)return me?g0(j,D):j;var Qe=g0(j,ys(D/xo(j)));return Dl(j)?kc(aa(Qe),0,D).join(""):Qe.slice(0,D)}function nd(D,j,me,Qe){var Et=j&Ke,jt=Sh(D);function ci(){for(var pi=-1,Pi=arguments.length,hn=-1,fn=Qe.length,vn=Di(fn+Pi),er=this&&this!==Ns&&this instanceof ci?jt:D;++hn<fn;)vn[hn]=Qe[hn];for(;Pi--;)vn[hn++]=arguments[++pi];return ps(er,Et?me:this,vn)}return ci}function Tp(D){return function(j,me,Qe){return Qe&&typeof Qe!="number"&&Iu(j,me,Qe)&&(me=Qe=n),j=us(j),me===n?(me=j,j=0):me=us(me),Qe=Qe===n?j<me?1:-1:us(Qe),pf(j,me,Qe,D)}}function CA(D){return function(j,me){return typeof j=="string"&&typeof me=="string"||(j=rr(j),me=rr(me)),D(j,me)}}function fc(D,j,me,Qe,Et,jt,ci,pi,Pi,hn){var fn=j&xt,vn=fn?ci:n,er=fn?n:ci,Ir=fn?jt:n,es=fn?n:jt;j|=fn?Mt:Ue,j&=~(fn?Ue:Mt),j&ht||(j&=~(Ke|st));var Xs=[D,j,Et,Ir,vn,es,er,pi,Pi,hn],ts=me.apply(n,Xs);return w0(D)&&pd(ts,Xs),ts.placeholder=Qe,so(ts,D,j)}function Cf(D){var j=Ui[D];return function(me,Qe){if(me=rr(me),Qe=Qe==null?0:vs(Yn(Qe),292),Qe&&Uu(me)){var Et=(tr(me)+"e").split("e"),jt=j(Et[0]+"e"+(+Et[1]+Qe));return Et=(tr(jt)+"e").split("e"),+(Et[0]+"e"+(+Et[1]-Qe))}return j(me)}}var rd=Is&&1/ns(new Is([,-0]))[1]==Ut?function(D){return new Is(D)}:D1;function Ih(D){return function(j){var me=Hl(j);return me==wn?Ws(j):me==Yi?vr(j):Ls(j,D(j))}}function ih(D,j,me,Qe,Et,jt,ci,pi){var Pi=j&st;if(!Pi&&typeof D!="function")throw new Jn(S);var hn=Qe?Qe.length:0;if(hn||(j&=~(Mt|Ue),Qe=Et=n),ci=ci===n?ci:br(Yn(ci),0),pi=pi===n?pi:Yn(pi),hn-=Et?Et.length:0,j&Ue){var fn=Qe,vn=Et;Qe=Et=n}var er=Pi?n:eA(D),Ir=[D,j,me,Qe,Et,fn,vn,jt,ci,pi];if(er&&Th(Ir,er),D=Ir[0],j=Ir[1],me=Ir[2],Qe=Ir[3],Et=Ir[4],pi=Ir[9]=Ir[9]===n?Pi?0:D.length:br(Ir[9]-hn,0),!pi&&j&(xt|zt)&&(j&=~(xt|zt)),!j||j==Ke)var es=If(D,j,me);else j==xt||j==zt?es=Ef(D,j,pi):(j==Mt||j==(Ke|Mt))&&!Et.length?es=nd(D,j,me,Qe):es=Kh.apply(n,Ir);var Xs=er?mf:pd;return so(Xs(es,Ir),D,j)}function kp(D,j,me,Qe){return D===n||ee(D,_s[me])&&!cs.call(Qe,me)?j:D}function Mp(D,j,me,Qe,Et,jt){return Lt(D)&&Lt(j)&&(jt.set(j,D),Kc(D,j,n,Mp,jt),jt.delete(j)),D}function Pp(D){return ln(D)?n:D}function sd(D,j,me,Qe,Et,jt){var ci=me&Ze,pi=D.length,Pi=j.length;if(pi!=Pi&&!(ci&&Pi>pi))return!1;var hn=jt.get(D),fn=jt.get(j);if(hn&&fn)return hn==j&&fn==D;var vn=-1,er=!0,Ir=me&nt?new Z:n;for(jt.set(D,j),jt.set(j,D);++vn<pi;){var es=D[vn],Xs=j[vn];if(Qe)var ts=ci?Qe(Xs,es,vn,j,D,jt):Qe(es,Xs,vn,D,j,jt);if(ts!==n){if(ts)continue;er=!1;break}if(Ir){if(!Ta(j,function(ha,va){if(!is(Ir,va)&&(es===ha||Et(es,ha,me,Qe,jt)))return Ir.push(va)})){er=!1;break}}else if(!(es===Xs||Et(es,Xs,me,Qe,jt))){er=!1;break}}return jt.delete(D),jt.delete(j),er}function Eh(D,j,me,Qe,Et,jt,ci){switch(me){case U:if(D.byteLength!=j.byteLength||D.byteOffset!=j.byteOffset)return!1;D=D.buffer,j=j.buffer;case M:return!(D.byteLength!=j.byteLength||!jt(new Gl(D),new Gl(j)));case xn:case Ti:case xi:return ee(+D,+j);case Oi:return D.name==j.name&&D.message==j.message;case oi:case Xn:return D==j+"";case wn:var pi=Ws;case Yi:var Pi=Qe&Ze;if(pi||(pi=ns),D.size!=j.size&&!Pi)return!1;var hn=ci.get(D);if(hn)return hn==j;Qe|=nt,ci.set(D,j);var fn=sd(pi(D),pi(j),Qe,Et,jt,ci);return ci.delete(D),fn;case zn:if(L)return L.call(D)==L.call(j)}return!1}function zm(D,j,me,Qe,Et,jt){var ci=me&Ze,pi=Ch(D),Pi=pi.length,hn=Ch(j),fn=hn.length;if(Pi!=fn&&!ci)return!1;for(var vn=Pi;vn--;){var er=pi[vn];if(!(ci?er in j:cs.call(j,er)))return!1}var Ir=jt.get(D),es=jt.get(j);if(Ir&&es)return Ir==j&&es==D;var Xs=!0;jt.set(D,j),jt.set(j,D);for(var ts=ci;++vn<Pi;){er=pi[vn];var ha=D[er],va=j[er];if(Qe)var fh=ci?Qe(va,ha,er,j,D,jt):Qe(ha,va,er,D,j,jt);if(!(fh===n?ha===va||Et(ha,va,me,Qe,jt):fh)){Xs=!1;break}ts||(ts=er=="constructor")}if(Xs&&!ts){var gc=D.constructor,dh=j.constructor;gc!=dh&&"constructor"in D&&"constructor"in j&&!(typeof gc=="function"&&gc instanceof gc&&typeof dh=="function"&&dh instanceof dh)&&(Xs=!1)}return jt.delete(D),jt.delete(j),Xs}function Pc(D){return Eu(fd(D,n,dl),D+"")}function Ch(D){return Ur(D,mo,kA)}function Tf(D){return Ur(D,Co,MA)}var eA=zi?function(D){return zi.get(D)}:D1;function TA(D){for(var j=D.name+"",me=Es[j],Qe=cs.call(Es,j)?me.length:0;Qe--;){var Et=me[Qe],jt=Et.func;if(jt==null||jt==D)return Et.name}return j}function tA(D){var j=cs.call(F,"placeholder")?F:D;return j.placeholder}function Dr(){var D=F.iteratee||M1;return D=D===M1?Tc:D,arguments.length?D(arguments[0],arguments[1]):D}function kf(D,j){var me=D.__data__;return Nm(j)?me[typeof j=="string"?"string":"hash"]:me.map}function ad(D){for(var j=mo(D),me=j.length;me--;){var Qe=j[me],Et=D[Qe];j[me]=[Qe,Et,S0(Et)]}return j}function iA(D,j){var me=Lo(D,j);return Va(me)?me:n}function Mf(D){var j=cs.call(D,vl),me=D[vl];try{D[vl]=n;var Qe=!0}catch{}var Et=wo.call(D);return Qe&&(j?D[vl]=me:delete D[vl]),Et}var kA=tl?function(D){return D==null?[]:(D=On(D),No(tl(D),function(j){return yl.call(D,j)}))}:L1,MA=tl?function(D){for(var j=[];D;)Xo(j,kA(D)),D=Yl(D);return j}:L1,Hl=Cs;(Pu&&Hl(new Pu(new ArrayBuffer(1)))!=U||fa&&Hl(new fa)!=wn||bu&&Hl(bu.resolve())!=an||Is&&Hl(new Is)!=Yi||Bo&&Hl(new Bo)!=_n)&&(Hl=function(D){var j=Cs(D),me=j==Ot?D.constructor:n,Qe=me?nh(me):"";if(Qe)switch(Qe){case wu:return U;case Uo:return wn;case ms:return an;case Al:return Yi;case zs:return _n}return j});function Rm(D,j,me){for(var Qe=-1,Et=me.length;++Qe<Et;){var jt=me[Qe],ci=jt.size;switch(jt.type){case"drop":D+=ci;break;case"dropRight":j-=ci;break;case"take":j=vs(j,D+ci);break;case"takeRight":D=br(D,j-ci);break}}return{start:D,end:j}}function Fm(D){var j=D.match(qe);return j?j[1].split(dt):[]}function od(D,j,me){j=wh(j,D);for(var Qe=-1,Et=j.length,jt=!1;++Qe<Et;){var ci=bs(j[Qe]);if(!(jt=D!=null&&me(D,ci)))break;D=D[ci]}return jt||++Qe!=Et?jt:(Et=D==null?0:D.length,!!Et&&Dt(Et)&&Dc(ci,Et)&&(f(D)||Ne(D)))}function Om(D){var j=D.length,me=new D.constructor(j);return j&&typeof D[0]=="string"&&cs.call(D,"index")&&(me.index=D.index,me.input=D.input),me}function ld(D){return typeof D.constructor=="function"&&!DA(D)?te(Yl(D)):{}}function nA(D,j,me){var Qe=D.constructor;switch(j){case M:return cc(D);case xn:case Ti:return new Qe(+D);case U:return yf(D,me);case K:case ie:case de:case be:case Ee:case Ce:case Re:case $e:case je:return Ro(D,me);case wn:return new Qe;case xi:case Xn:return new Qe(D);case oi:return wA(D);case Yi:return new Qe;case zn:return Bm(D)}}function ud(D,j){var me=j.length;if(!me)return D;var Qe=me-1;return j[Qe]=(me>1?"& ":"")+j[Qe],j=j.join(me>2?", ":" "),D.replace(Le,`{
/* [wrapped with `+j+`] */
`)}function Dp(D){return f(D)||Ne(D)||!!(Vu&&D&&D[Vu])}function Dc(D,j){var me=typeof D;return j=j??Ft,!!j&&(me=="number"||me!="symbol"&&bi.test(D))&&D>-1&&D%1==0&&D<j}function Iu(D,j,me){if(!Lt(me))return!1;var Qe=typeof j;return(Qe=="number"?p(me)&&Dc(j,me.length):Qe=="string"&&j in me)?ee(me[j],D):!1}function PA(D,j){if(f(D))return!1;var me=typeof D;return me=="number"||me=="symbol"||me=="boolean"||D==null||Fn(D)?!0:ye.test(D)||!xe.test(D)||j!=null&&D in On(j)}function Nm(D){var j=typeof D;return j=="string"||j=="number"||j=="symbol"||j=="boolean"?D!=="__proto__":D===null}function w0(D){var j=TA(D),me=F[j];if(typeof me!="function"||!(j in Se.prototype))return!1;if(D===me)return!0;var Qe=eA(me);return!!Qe&&D===Qe[0]}function Lp(D){return!!Nu&&Nu in D}var cd=ro?pt:B1;function DA(D){var j=D&&D.constructor,me=typeof j=="function"&&j.prototype||_s;return D===me}function S0(D){return D===D&&!Lt(D)}function hd(D,j){return function(me){return me==null?!1:me[D]===j&&(j!==n||D in On(me))}}function Vm(D){var j=Ph(D,function(Qe){return me.size===$&&me.clear(),Qe}),me=j.cache;return j}function Th(D,j){var me=D[1],Qe=j[1],Et=me|Qe,jt=Et<(Ke|st|$t),ci=Qe==$t&&me==xt||Qe==$t&&me==rt&&D[7].length<=j[8]||Qe==($t|rt)&&j[7].length<=j[8]&&me==xt;if(!(jt||ci))return D;Qe&Ke&&(D[2]=j[2],Et|=me&Ke?0:ht);var pi=j[3];if(pi){var Pi=D[3];D[3]=Pi?xf(Pi,pi,j[4]):pi,D[4]=Pi?el(D[3],he):j[4]}return pi=j[5],pi&&(Pi=D[5],D[5]=Pi?bf(Pi,pi,j[6]):pi,D[6]=Pi?el(D[5],he):j[6]),pi=j[7],pi&&(D[7]=pi),Qe&$t&&(D[8]=D[8]==null?j[8]:vs(D[8],j[8])),D[9]==null&&(D[9]=j[9]),D[0]=j[0],D[1]=Et,D}function fl(D){var j=[];if(D!=null)for(var me in On(D))j.push(me);return j}function Ad(D){return wo.call(D)}function fd(D,j,me){return j=br(j===n?D.length-1:j,0),function(){for(var Qe=arguments,Et=-1,jt=br(Qe.length-j,0),ci=Di(jt);++Et<jt;)ci[Et]=Qe[j+Et];Et=-1;for(var pi=Di(j+1);++Et<j;)pi[Et]=Qe[Et];return pi[j]=me(ci),ps(D,this,pi)}}function dd(D,j){return j.length<2?D:ls(D,zl(j,0,-1))}function ya(D,j){for(var me=D.length,Qe=vs(j.length,me),Et=bl(D);Qe--;){var jt=j[Qe];D[Qe]=Dc(jt,me)?Et[jt]:n}return D}function LA(D,j){if(!(j==="constructor"&&typeof D[j]=="function")&&j!="__proto__")return D[j]}var pd=I0(mf),BA=Kl||function(D,j){return Ns.setTimeout(D,j)},Eu=I0(xA);function so(D,j,me){var Qe=j+"";return Eu(D,ud(Qe,Bp(Fm(Qe),me)))}function I0(D){var j=0,me=0;return function(){var Qe=gn(),Et=ut-(Qe-me);if(me=Qe,Et>0){if(++j>=St)return arguments[0]}else j=0;return D.apply(n,arguments)}}function Pf(D,j){var me=-1,Qe=D.length,Et=Qe-1;for(j=j===n?Qe:j;++me<j;){var jt=vA(me,Et),ci=D[jt];D[jt]=D[me],D[me]=ci}return D.length=j,D}var md=Vm(function(D){var j=[];return D.charCodeAt(0)===46&&j.push(""),D.replace(De,function(me,Qe,Et,jt){j.push(Et?jt.replace(Me,"$1"):Qe||me)}),j});function bs(D){if(typeof D=="string"||Fn(D))return D;var j=D+"";return j=="0"&&1/D==-Ut?"-0":j}function nh(D){if(D!=null){try{return bo.call(D)}catch{}try{return D+""}catch{}}return""}function Bp(D,j){return uo(tn,function(me){var Qe="_."+me[0];j&me[1]&&!$o(D,Qe)&&D.push(Qe)}),D.sort()}function gd(D){if(D instanceof Se)return D.clone();var j=new le(D.__wrapped__,D.__chain__);return j.__actions__=bl(D.__actions__),j.__index__=D.__index__,j.__values__=D.__values__,j}function rh(D,j,me){(me?Iu(D,j,me):j===n)?j=1:j=br(Yn(j),0);var Qe=D==null?0:D.length;if(!Qe||j<1)return[];for(var Et=0,jt=0,ci=Di(ys(Qe/j));Et<Qe;)ci[jt++]=zl(D,Et,Et+=j);return ci}function zA(D){for(var j=-1,me=D==null?0:D.length,Qe=0,Et=[];++j<me;){var jt=D[j];jt&&(Et[Qe++]=jt)}return Et}function zp(){var D=arguments.length;if(!D)return[];for(var j=Di(D-1),me=arguments[0],Qe=D;Qe--;)j[Qe-1]=arguments[Qe];return Xo(f(me)?bl(me):[me],$r(j,1))}var E0=xs(function(D,j){return E(D)?wr(D,$r(j,1,E,!0)):[]}),RA=xs(function(D,j){var me=Du(j);return E(me)&&(me=n),E(D)?wr(D,$r(j,1,E,!0),Dr(me,2)):[]}),Rp=xs(function(D,j){var me=Du(j);return E(me)&&(me=n),E(D)?wr(D,$r(j,1,E,!0),n,me):[]});function _d(D,j,me){var Qe=D==null?0:D.length;return Qe?(j=me||j===n?1:Yn(j),zl(D,j<0?0:j,Qe)):[]}function yd(D,j,me){var Qe=D==null?0:D.length;return Qe?(j=me||j===n?1:Yn(j),j=Qe-j,zl(D,0,j<0?0:j)):[]}function Um(D,j){return D&&D.length?Rl(D,Dr(j,3),!0,!0):[]}function Gm(D,j){return D&&D.length?Rl(D,Dr(j,3),!0):[]}function qm(D,j,me,Qe){var Et=D==null?0:D.length;return Et?(me&&typeof me!="number"&&Iu(D,j,me)&&(me=0,Qe=Et),Ao(D,j,me,Qe)):[]}function vd(D,j,me){var Qe=D==null?0:D.length;if(!Qe)return-1;var Et=me==null?0:Yn(me);return Et<0&&(Et=br(Qe+Et,0)),Kn(D,Dr(j,3),Et)}function FA(D,j,me){var Qe=D==null?0:D.length;if(!Qe)return-1;var Et=Qe-1;return me!==n&&(Et=Yn(me),Et=me<0?br(Qe+Et,0):vs(Et,Qe-1)),Kn(D,Dr(j,3),Et,!0)}function dl(D){var j=D==null?0:D.length;return j?$r(D,1):[]}function C0(D){var j=D==null?0:D.length;return j?$r(D,Ut):[]}function T0(D,j){var me=D==null?0:D.length;return me?(j=j===n?1:Yn(j),$r(D,j)):[]}function Lc(D){for(var j=-1,me=D==null?0:D.length,Qe={};++j<me;){var Et=D[j];Qe[Et[0]]=Et[1]}return Qe}function OA(D){return D&&D.length?D[0]:n}function Df(D,j,me){var Qe=D==null?0:D.length;if(!Qe)return-1;var Et=me==null?0:Yn(me);return Et<0&&(Et=br(Qe+Et,0)),Jo(D,j,Et)}function NA(D){var j=D==null?0:D.length;return j?zl(D,0,-1):[]}var Lf=xs(function(D){var j=Qs(D,J0);return j.length&&j[0]===D[0]?Cc(j):[]}),Bf=xs(function(D){var j=Du(D),me=Qs(D,J0);return j===Du(me)?j=n:me.pop(),me.length&&me[0]===D[0]?Cc(me,Dr(j,2)):[]}),Cu=xs(function(D){var j=Du(D),me=Qs(D,J0);return j=typeof j=="function"?j:n,j&&me.pop(),me.length&&me[0]===D[0]?Cc(me,n,j):[]});function k0(D,j){return D==null?"":Au.call(D,j)}function Du(D){var j=D==null?0:D.length;return j?D[j-1]:n}function kh(D,j,me){var Qe=D==null?0:D.length;if(!Qe)return-1;var Et=Qe;return me!==n&&(Et=Yn(me),Et=Et<0?br(Qe+Et,0):vs(Et,Qe-1)),j===j?ga(D,j,Et):Kn(D,to,Et,!0)}function VA(D,j){return D&&D.length?df(D,Yn(j)):n}var UA=xs(sh);function sh(D,j){return D&&D.length&&j&&j.length?xh(D,j):D}function GA(D,j,me){return D&&D.length&&j&&j.length?xh(D,j,Dr(me,2)):D}function M0(D,j,me){return D&&D.length&&j&&j.length?xh(D,j,n,me):D}var Hm=Pc(function(D,j){var me=D==null?0:D.length,Qe=Hi(D,j);return Jc(D,Qs(j,function(Et){return Dc(Et,me)?+Et:Et}).sort(vf)),Qe});function xd(D,j){var me=[];if(!(D&&D.length))return me;var Qe=-1,Et=[],jt=D.length;for(j=Dr(j,3);++Qe<jt;){var ci=D[Qe];j(ci,Qe,D)&&(me.push(ci),Et.push(Qe))}return Jc(D,Et),me}function Mh(D){return D==null?D:il.call(D)}function Bc(D,j,me){var Qe=D==null?0:D.length;return Qe?(me&&typeof me!="number"&&Iu(D,j,me)?(j=0,me=Qe):(j=j==null?0:Yn(j),me=me===n?Qe:Yn(me)),zl(D,j,me)):[]}function ah(D,j){return bA(D,j)}function bd(D,j,me){return _0(D,j,Dr(me,2))}function zf(D,j){var me=D==null?0:D.length;if(me){var Qe=bA(D,j);if(Qe<me&&ee(D[Qe],j))return Qe}return-1}function wd(D,j){return bA(D,j,!0)}function jm(D,j,me){return _0(D,j,Dr(me,2),!0)}function P0(D,j){var me=D==null?0:D.length;if(me){var Qe=bA(D,j,!0)-1;if(ee(D[Qe],j))return Qe}return-1}function D0(D){return D&&D.length?y0(D):[]}function Rf(D,j){return D&&D.length?y0(D,Dr(j,2)):[]}function ec(D){var j=D==null?0:D.length;return j?zl(D,1,j):[]}function zc(D,j,me){return D&&D.length?(j=me||j===n?1:Yn(j),zl(D,0,j<0?0:j)):[]}function rA(D,j,me){var Qe=D==null?0:D.length;return Qe?(j=me||j===n?1:Yn(j),j=Qe-j,zl(D,j<0?0:j,Qe)):[]}function L0(D,j){return D&&D.length?Rl(D,Dr(j,3),!1,!0):[]}function Fp(D,j){return D&&D.length?Rl(D,Dr(j,3)):[]}var Sd=xs(function(D){return eh($r(D,1,E,!0))}),Ff=xs(function(D){var j=Du(D);return E(j)&&(j=n),eh($r(D,1,E,!0),Dr(j,2))}),qA=xs(function(D){var j=Du(D);return j=typeof j=="function"?j:n,eh($r(D,1,E,!0),n,j)});function Op(D){return D&&D.length?eh(D):[]}function Id(D,j){return D&&D.length?eh(D,Dr(j,2)):[]}function Ed(D,j){return j=typeof j=="function"?j:n,D&&D.length?eh(D,n,j):[]}function oh(D){if(!(D&&D.length))return[];var j=0;return D=No(D,function(me){if(E(me))return j=br(me.length,j),!0}),Kr(j,function(me){return Qs(D,pr(me))})}function Cd(D,j){if(!(D&&D.length))return[];var me=oh(D);return j==null?me:Qs(me,function(Qe){return ps(j,n,Qe)})}var Np=xs(function(D,j){return E(D)?wr(D,j):[]}),Td=xs(function(D){return th(No(D,E))}),Vp=xs(function(D){var j=Du(D);return E(j)&&(j=n),th(No(D,E),Dr(j,2))}),HA=xs(function(D){var j=Du(D);return j=typeof j=="function"?j:n,th(No(D,E),n,j)}),lh=xs(oh);function Up(D,j){return $h(D||[],j||[],Kt)}function Gp(D,j){return $h(D||[],j||[],Wh)}var kd=xs(function(D){var j=D.length,me=j>1?D[j-1]:n;return me=typeof me=="function"?(D.pop(),me):n,Cd(D,me)});function Md(D){var j=F(D);return j.__chain__=!0,j}function qp(D,j){return j(D),D}function jA(D,j){return j(D)}var B0=Pc(function(D){var j=D.length,me=j?D[0]:0,Qe=this.__wrapped__,Et=function(jt){return Hi(jt,D)};return j>1||this.__actions__.length||!(Qe instanceof Se)||!Dc(me)?this.thru(Et):(Qe=Qe.slice(me,+me+(j?1:0)),Qe.__actions__.push({func:jA,args:[Et],thisArg:n}),new le(Qe,this.__chain__).thru(function(jt){return j&&!jt.length&&jt.push(n),jt}))});function z0(){return Md(this)}function Rc(){return new le(this.value(),this.__chain__)}function Pd(){this.__values__===n&&(this.__values__=la(this.value()));var D=this.__index__>=this.__values__.length,j=D?n:this.__values__[this.__index__++];return{done:D,value:j}}function Lu(){return this}function ZA(D){for(var j,me=this;me instanceof ue;){var Qe=gd(me);Qe.__index__=0,Qe.__values__=n,j?Et.__wrapped__=Qe:j=Qe;var Et=Qe;me=me.__wrapped__}return Et.__wrapped__=D,j}function Dd(){var D=this.__wrapped__;if(D instanceof Se){var j=D;return this.__actions__.length&&(j=new Se(this)),j=j.reverse(),j.__actions__.push({func:jA,args:[Mh],thisArg:n}),new le(j,this.__chain__)}return this.thru(Mh)}function Ld(){return v0(this.__wrapped__,this.__actions__)}var Bd=Ua(function(D,j,me){cs.call(D,me)?++D[me]:Ei(D,me,1)});function R0(D,j,me){var Qe=f(D)?Xl:_a;return me&&Iu(D,j,me)&&(j=n),Qe(D,Dr(j,3))}function Of(D,j){var me=f(D)?No:fo;return me(D,Dr(j,3))}var zd=SA(vd),Rd=SA(FA);function Fd(D,j){return $r(uh(D,j),1)}function wl(D,j){return $r(uh(D,j),Ut)}function QA(D,j,me){return me=me===n?1:Yn(me),$r(uh(D,j),me)}function F0(D,j){var me=f(D)?uo:nr;return me(D,Dr(j,3))}function O0(D,j){var me=f(D)?co:Pa;return me(D,Dr(j,3))}var Od=Ua(function(D,j,me){cs.call(D,me)?D[me].push(j):Ei(D,me,[j])});function Hp(D,j,me,Qe){D=p(D)?D:Nc(D),me=me&&!Qe?Yn(me):0;var Et=D.length;return me<0&&(me=br(Et+me,0)),Ki(D)?me<=Et&&D.indexOf(j,me)>-1:!!Et&&Jo(D,j,me)>-1}var jp=xs(function(D,j,me){var Qe=-1,Et=typeof j=="function",jt=p(D)?Di(D.length):[];return nr(D,function(ci){jt[++Qe]=Et?ps(j,ci,me):Jl(ci,j,me)}),jt}),Nd=Ua(function(D,j,me){Ei(D,me,j)});function uh(D,j){var me=f(D)?Qs:Sp;return me(D,Dr(j,3))}function Vd(D,j,me,Qe){return D==null?[]:(f(j)||(j=j==null?[]:[j]),me=Qe?n:me,f(me)||(me=me==null?[]:[me]),X0(D,j,me))}var dc=Ua(function(D,j,me){D[me?0:1].push(j)},function(){return[[],[]]});function Ud(D,j,me){var Qe=f(D)?Yo:qn,Et=arguments.length<3;return Qe(D,Dr(j,4),me,Et,nr)}function Nf(D,j,me){var Qe=f(D)?Ko:qn,Et=arguments.length<3;return Qe(D,Dr(j,4),me,Et,Pa)}function Vf(D,j){var me=f(D)?No:fo;return me(D,YA(Dr(j,3)))}function Uf(D){var j=f(D)?ft:tu;return j(D)}function Zm(D,j,me){(me?Iu(D,j,me):j===n)?j=1:j=Yn(j);var Qe=f(D)?Tt:Qh;return Qe(D,j)}function Qm(D){var j=f(D)?It:K0;return j(D)}function Zp(D){if(D==null)return 0;if(p(D))return Ki(D)?xo(D):D.length;var j=Hl(D);return j==wn||j==Yi?D.size:jh(D).length}function WA(D,j,me){var Qe=f(D)?Ta:qu;return me&&Iu(D,j,me)&&(j=n),Qe(D,Dr(j,3))}var sA=xs(function(D,j){if(D==null)return[];var me=j.length;return me>1&&Iu(D,j[0],j[1])?j=[]:me>2&&Iu(j[0],j[1],j[2])&&(j=[j[0]]),X0(D,$r(j,1),[])}),Fo=Ku||function(){return Ns.Date.now()};function ch(D,j){if(typeof j!="function")throw new Jn(S);return D=Yn(D),function(){if(--D<1)return j.apply(this,arguments)}}function aA(D,j,me){return j=me?n:j,j=D&&j==null?D.length:j,ih(D,$t,n,n,n,n,j)}function $A(D,j){var me;if(typeof j!="function")throw new Jn(S);return D=Yn(D),function(){return--D>0&&(me=j.apply(this,arguments)),D<=1&&(j=n),me}}var oA=xs(function(D,j,me){var Qe=Ke;if(me.length){var Et=el(me,tA(oA));Qe|=Mt}return ih(D,Qe,j,me,Et)}),N0=xs(function(D,j,me){var Qe=Ke|st;if(me.length){var Et=el(me,tA(N0));Qe|=Mt}return ih(j,Qe,D,me,Et)});function Qp(D,j,me){j=me?n:j;var Qe=ih(D,xt,n,n,n,n,n,j);return Qe.placeholder=Qp.placeholder,Qe}function Gd(D,j,me){j=me?n:j;var Qe=ih(D,zt,n,n,n,n,n,j);return Qe.placeholder=Gd.placeholder,Qe}function qd(D,j,me){var Qe,Et,jt,ci,pi,Pi,hn=0,fn=!1,vn=!1,er=!0;if(typeof D!="function")throw new Jn(S);j=rr(j)||0,Lt(me)&&(fn=!!me.leading,vn="maxWait"in me,jt=vn?br(rr(me.maxWait)||0,j):jt,er="trailing"in me?!!me.trailing:er);function Ir(su){var uA=Qe,Xf=Et;return Qe=Et=n,hn=su,ci=D.apply(Xf,uA),ci}function es(su){return hn=su,pi=BA(ha,j),fn?Ir(su):ci}function Xs(su){var uA=su-Pi,Xf=su-hn,q2=j-uA;return vn?vs(q2,jt-Xf):q2}function ts(su){var uA=su-Pi,Xf=su-hn;return Pi===n||uA>=j||uA<0||vn&&Xf>=jt}function ha(){var su=Fo();if(ts(su))return va(su);pi=BA(ha,Xs(su))}function va(su){return pi=n,er&&Qe?Ir(su):(Qe=Et=n,ci)}function fh(){pi!==n&&_f(pi),hn=0,Qe=Pi=Et=pi=n}function gc(){return pi===n?ci:va(Fo())}function dh(){var su=Fo(),uA=ts(su);if(Qe=arguments,Et=this,Pi=su,uA){if(pi===n)return es(Pi);if(vn)return _f(pi),pi=BA(ha,j),Ir(Pi)}return pi===n&&(pi=BA(ha,j)),ci}return dh.cancel=fh,dh.flush=gc,dh}var XA=xs(function(D,j){return Mn(D,1,j)}),Fl=xs(function(D,j,me){return Mn(D,rr(j)||0,me)});function Fc(D){return ih(D,gt)}function Ph(D,j){if(typeof D!="function"||j!=null&&typeof j!="function")throw new Jn(S);var me=function(){var Qe=arguments,Et=j?j.apply(this,Qe):Qe[0],jt=me.cache;if(jt.has(Et))return jt.get(Et);var ci=D.apply(this,Qe);return me.cache=jt.set(Et,ci)||jt,ci};return me.cache=new(Ph.Cache||l),me}Ph.Cache=l;function YA(D){if(typeof D!="function")throw new Jn(S);return function(){var j=arguments;switch(j.length){case 0:return!D.call(this);case 1:return!D.call(this,j[0]);case 2:return!D.call(this,j[0],j[1]);case 3:return!D.call(this,j[0],j[1],j[2])}return!D.apply(this,j)}}function KA(D){return $A(2,D)}var Gf=Lm(function(D,j){j=j.length==1&&f(j[0])?Qs(j[0],ar(Dr())):Qs($r(j,1),ar(Dr()));var me=j.length;return xs(function(Qe){for(var Et=-1,jt=vs(Qe.length,me);++Et<jt;)Qe[Et]=j[Et].call(this,Qe[Et]);return ps(D,this,Qe)})}),V0=xs(function(D,j){var me=el(j,tA(V0));return ih(D,Mt,n,j,me)}),qf=xs(function(D,j){var me=el(j,tA(qf));return ih(D,Ue,n,j,me)}),Hf=Pc(function(D,j){return ih(D,rt,n,n,n,j)});function jf(D,j){if(typeof D!="function")throw new Jn(S);return j=j===n?j:Yn(j),xs(D,j)}function U0(D,j){if(typeof D!="function")throw new Jn(S);return j=j==null?0:br(Yn(j),0),xs(function(me){var Qe=me[j],Et=kc(me,0,j);return Qe&&Xo(Et,Qe),ps(D,this,Et)})}function Zf(D,j,me){var Qe=!0,Et=!0;if(typeof D!="function")throw new Jn(S);return Lt(me)&&(Qe="leading"in me?!!me.leading:Qe,Et="trailing"in me?!!me.trailing:Et),qd(D,j,{leading:Qe,maxWait:j,trailing:Et})}function Qf(D){return aA(D,1)}function Wp(D,j){return V0(ed(j),D)}function _(){if(!arguments.length)return[];var D=arguments[0];return f(D)?D:[D]}function h(D){return cn(D,_e)}function w(D,j){return j=typeof j=="function"?j:n,cn(D,_e,j)}function P(D){return cn(D,oe|_e)}function H(D,j){return j=typeof j=="function"?j:n,cn(D,oe|_e,j)}function J(D,j){return j==null||nn(D,j,mo(j))}function ee(D,j){return D===j||D!==D&&j!==j}var ge=CA(Js),Te=CA(function(D,j){return D>=j}),Ne=fu(function(){return arguments}())?fu:function(D){return Rt(D)&&cs.call(D,"callee")&&!yl.call(D,"callee")},f=Di.isArray,u=kl?ar(kl):nl;function p(D){return D!=null&&Dt(D.length)&&!pt(D)}function E(D){return Rt(D)&&p(D)}function B(D){return D===!0||D===!1||Rt(D)&&Cs(D)==xn}var q=xu||B1,W=Ja?ar(Ja):xl;function se(D){return Rt(D)&&D.nodeType===1&&!ln(D)}function fe(D){if(D==null)return!0;if(p(D)&&(f(D)||typeof D=="string"||typeof D.splice=="function"||q(D)||Un(D)||Ne(D)))return!D.length;var j=Hl(D);if(j==wn||j==Yi)return!D.size;if(DA(D))return!jh(D).length;for(var me in D)if(cs.call(D,me))return!1;return!0}function ve(D,j){return Bl(D,j)}function Be(D,j,me){me=typeof me=="function"?me:n;var Qe=me?me(D,j):n;return Qe===n?Bl(D,j,n,me):!!Qe}function He(D){if(!Rt(D))return!1;var j=Cs(D);return j==Oi||j==gi||typeof D.message=="string"&&typeof D.name=="string"&&!ln(D)}function it(D){return typeof D=="number"&&Uu(D)}function pt(D){if(!Lt(D))return!1;var j=Cs(D);return j==Vi||j==bn||j==sn||j==$n}function vt(D){return typeof D=="number"&&D==Yn(D)}function Dt(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=Ft}function Lt(D){var j=typeof D;return D!=null&&(j=="object"||j=="function")}function Rt(D){return D!=null&&typeof D=="object"}var ei=Fa?ar(Fa):Af;function Zt(D,j){return D===j||qh(D,j,ad(j))}function Wt(D,j,me){return me=typeof me=="function"?me:n,qh(D,j,ad(j),me)}function hi(D){return un(D)&&D!=+D}function vi(D){if(cd(D))throw new ni(v);return Va(D)}function Ji(D){return D===null}function In(D){return D==null}function un(D){return typeof D=="number"||Rt(D)&&Cs(D)==xi}function ln(D){if(!Rt(D)||Cs(D)!=Ot)return!1;var j=Yl(D);if(j===null)return!0;var me=cs.call(j,"constructor")&&j.constructor;return typeof me=="function"&&me instanceof me&&bo.call(me)==Ll}var dn=gl?ar(gl):yA;function Vn(D){return vt(D)&&D>=-Ft&&D<=Ft}var on=Ml?ar(Ml):vh;function Ki(D){return typeof D=="string"||!f(D)&&Rt(D)&&Cs(D)==Xn}function Fn(D){return typeof D=="symbol"||Rt(D)&&Cs(D)==zn}var Un=yu?ar(yu):Hh;function gr(D){return D===n}function jr(D){return Rt(D)&&Hl(D)==_n}function Xr(D){return Rt(D)&&Cs(D)==b}var Us=CA(Yc),Da=CA(function(D,j){return D<=j});function la(D){if(!D)return[];if(p(D))return Ki(D)?aa(D):bl(D);if(ql&&D[ql])return sa(D[ql]());var j=Hl(D),me=j==wn?Ws:j==Yi?ns:Nc;return me(D)}function us(D){if(!D)return D===0?D:0;if(D=rr(D),D===Ut||D===-Ut){var j=D<0?-1:1;return j*Vt}return D===D?D:0}function Yn(D){var j=us(D),me=j%1;return j===j?me?j-me:j:0}function Ts(D){return D?ji(Yn(D),0,Ci):0}function rr(D){if(typeof D=="number")return D;if(Fn(D))return yi;if(Lt(D)){var j=typeof D.valueOf=="function"?D.valueOf():D;D=Lt(j)?j+"":j}if(typeof D!="string")return D===0?D:+D;D=Br(D);var me=ti.test(D);return me||Ri.test(D)?Nr(D.slice(2),me?2:8):fi.test(D)?yi:+D}function ua(D){return hc(D,Co(D))}function Rs(D){return D?ji(Yn(D),-Ft,Ft):D===0?D:0}function tr(D){return D==null?"":Su(D)}var Ga=Ac(function(D,j){if(DA(j)||p(j)){hc(j,mo(j),D);return}for(var me in j)cs.call(j,me)&&Kt(D,me,j[me])}),ao=Ac(function(D,j){hc(j,Co(j),D)}),Ia=Ac(function(D,j,me,Qe){hc(j,Co(j),D,Qe)}),Ho=Ac(function(D,j,me,Qe){hc(j,mo(j),D,Qe)}),po=Pc(Hi);function ca(D,j){var me=te(D);return j==null?me:Wi(me,j)}var Er=xs(function(D,j){D=On(D);var me=-1,Qe=j.length,Et=Qe>2?j[2]:n;for(Et&&Iu(j[0],j[1],Et)&&(Qe=1);++me<Qe;)for(var jt=j[me],ci=Co(jt),pi=-1,Pi=ci.length;++pi<Pi;){var hn=ci[pi],fn=D[hn];(fn===n||ee(fn,_s[hn])&&!cs.call(D,hn))&&(D[hn]=jt[hn])}return D}),Eo=xs(function(D){return D.push(n,Mp),ps(Yp,n,D)});function rl(D,j){return Pr(D,Dr(j,3),Io)}function sl(D,j){return Pr(D,Dr(j,3),Ks)}function Bu(D,j){return D==null?D:Sa(D,Dr(j,3),Co)}function Hu(D,j){return D==null?D:So(D,Dr(j,3),Co)}function Ol(D,j){return D&&Io(D,Dr(j,3))}function Oc(D,j){return D&&Ks(D,Dr(j,3))}function ju(D){return D==null?[]:os(D,mo(D))}function Zu(D){return D==null?[]:os(D,Co(D))}function iu(D,j,me){var Qe=D==null?n:ls(D,j);return Qe===n?me:Qe}function hh(D,j){return D!=null&&od(D,j,zo)}function lA(D,j){return D!=null&&od(D,j,Go)}var $p=id(function(D,j,me){j!=null&&typeof j.toString!="function"&&(j=wo.call(j)),D[j]=me},k1(Vc)),Hd=id(function(D,j,me){j!=null&&typeof j.toString!="function"&&(j=wo.call(j)),cs.call(D,j)?D[j].push(me):D[j]=[me]},Dr),jd=xs(Jl);function mo(D){return p(D)?lt(D):jh(D)}function Co(D){return p(D)?lt(D,!0):m0(D)}function Wf(D,j){var me={};return j=Dr(j,3),Io(D,function(Qe,Et,jt){Ei(me,j(Qe,Et,jt),Qe)}),me}function Xp(D,j){var me={};return j=Dr(j,3),Io(D,function(Qe,Et,jt){Ei(me,Et,j(Qe,Et,jt))}),me}var Wm=Ac(function(D,j,me){Kc(D,j,me)}),Yp=Ac(function(D,j,me,Qe){Kc(D,j,me,Qe)}),$m=Pc(function(D,j){var me={};if(D==null)return me;var Qe=!1;j=Qs(j,function(jt){return jt=wh(jt,D),Qe||(Qe=jt.length>1),jt}),hc(D,Tf(D),me),Qe&&(me=cn(me,oe|ce|_e,Pp));for(var Et=j.length;Et--;)gf(me,j[Et]);return me});function nu(D,j){return Dh(D,YA(Dr(j)))}var Qu=Pc(function(D,j){return D==null?{}:eu(D,j)});function Dh(D,j){if(D==null)return{};var me=Qs(Tf(D),function(Qe){return[Qe]});return j=Dr(j),Ju(D,me,function(Qe,Et){return j(Qe,Et[0])})}function pc(D,j,me){j=wh(j,D);var Qe=-1,Et=j.length;for(Et||(Et=1,D=n);++Qe<Et;){var jt=D==null?n:D[bs(j[Qe])];jt===n&&(Qe=Et,jt=me),D=pt(jt)?jt.call(D):jt}return D}function ru(D,j,me){return D==null?D:Wh(D,j,me)}function Wu(D,j,me,Qe){return Qe=typeof Qe=="function"?Qe:n,D==null?D:Wh(D,j,me,Qe)}var Xm=Ih(mo),Hg=Ih(Co);function E1(D,j,me){var Qe=f(D),Et=Qe||q(D)||Un(D);if(j=Dr(j,4),me==null){var jt=D&&D.constructor;Et?me=Qe?new jt:[]:Lt(D)?me=pt(jt)?te(Yl(D)):{}:me={}}return(Et?uo:Io)(D,function(ci,pi,Pi){return j(me,ci,pi,Pi)}),me}function C1(D,j){return D==null?!0:gf(D,j)}function Tu(D,j,me){return D==null?D:bh(D,j,ed(me))}function mc(D,j,me,Qe){return Qe=typeof Qe=="function"?Qe:n,D==null?D:bh(D,j,ed(me),Qe)}function Nc(D){return D==null?[]:ul(D,mo(D))}function Ah(D){return D==null?[]:ul(D,Co(D))}function $f(D,j,me){return me===n&&(me=j,j=n),me!==n&&(me=rr(me),me=me===me?me:0),j!==n&&(j=rr(j),j=j===j?j:0),ji(rr(D),j,me)}function Lh(D,j,me){return j=us(j),me===n?(me=j,j=0):me=us(me),D=rr(D),qo(D,j,me)}function rI(D,j,me){if(me&&typeof me!="boolean"&&Iu(D,j,me)&&(j=me=n),me===n&&(typeof j=="boolean"?(me=j,j=n):typeof D=="boolean"&&(me=D,D=n)),D===n&&j===n?(D=0,j=1):(D=us(D),j===n?(j=D,D=0):j=us(j)),D>j){var Qe=D;D=j,j=Qe}if(me||D%1||j%1){var Et=ir();return vs(D+Et*(j-D+ra("1e-"+((Et+"").length-1))),j)}return vA(D,j)}var sI=Yh(function(D,j,me){return j=j.toLowerCase(),D+(me?O2(j):j)});function O2(D){return T1(tr(D).toLowerCase())}function N2(D){return D=tr(D),D&&D.replace(Si,gs).replace(or,"")}function aI(D,j,me){D=tr(D),j=Su(j);var Qe=D.length;me=me===n?Qe:ji(Yn(me),0,Qe);var Et=me;return me-=j.length,me>=0&&D.slice(me,Et)==j}function oI(D){return D=tr(D),D&&re.test(D)?D.replace(Pe,ka):D}function lI(D){return D=tr(D),D&&Ve.test(D)?D.replace(Oe,"\\$&"):D}var uI=Yh(function(D,j,me){return D+(me?"-":"")+j.toLowerCase()}),cI=Yh(function(D,j,me){return D+(me?" ":"")+j.toLowerCase()}),hI=Mc("toLowerCase");function AI(D,j,me){D=tr(D),j=Yn(j);var Qe=j?xo(D):0;if(!j||Qe>=j)return D;var Et=(j-Qe)/2;return b0(wa(Et),me)+D+b0(ys(Et),me)}function fI(D,j,me){D=tr(D),j=Yn(j);var Qe=j?xo(D):0;return j&&Qe<j?D+b0(j-Qe,me):D}function dI(D,j,me){D=tr(D),j=Yn(j);var Qe=j?xo(D):0;return j&&Qe<j?b0(j-Qe,me)+D:D}function pI(D,j,me){return me||j==null?j=0:j&&(j=+j),Zn(tr(D).replace(Je,""),j||0)}function mI(D,j,me){return(me?Iu(D,j,me):j===n)?j=1:j=Yn(j),g0(tr(D),j)}function gI(){var D=arguments,j=tr(D[0]);return D.length<3?j:j.replace(D[1],D[2])}var _I=Yh(function(D,j,me){return D+(me?"_":"")+j.toLowerCase()});function yI(D,j,me){return me&&typeof me!="number"&&Iu(D,j,me)&&(j=me=n),me=me===n?Ci:me>>>0,me?(D=tr(D),D&&(typeof j=="string"||j!=null&&!dn(j))&&(j=Su(j),!j&&Dl(D))?kc(aa(D),0,me):D.split(j,me)):[]}var vI=Yh(function(D,j,me){return D+(me?" ":"")+T1(j)});function xI(D,j,me){return D=tr(D),me=me==null?0:ji(Yn(me),0,D.length),j=Su(j),D.slice(me,me+j.length)==j}function bI(D,j,me){var Qe=F.templateSettings;me&&Iu(D,j,me)&&(j=n),D=tr(D),j=Ia({},j,Qe,kp);var Et=Ia({},j.imports,Qe.imports,kp),jt=mo(Et),ci=ul(Et,jt),pi,Pi,hn=0,fn=j.interpolate||Jt,vn="__p += '",er=jn((j.escape||Jt).source+"|"+fn.source+"|"+(fn===pe?li:Jt).source+"|"+(j.evaluate||Jt).source+"|$","g"),Ir="//# sourceURL="+(cs.call(j,"sourceURL")?(j.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ml+"]")+`
`;D.replace(er,function(ts,ha,va,fh,gc,dh){return va||(va=fh),vn+=D.slice(hn,dh).replace(Sn,Pl),ha&&(pi=!0,vn+=`' +
__e(`+ha+`) +
'`),gc&&(Pi=!0,vn+=`';
`+gc+`;
__p += '`),va&&(vn+=`' +
((__t = (`+va+`)) == null ? '' : __t) +
'`),hn=dh+ts.length,ts}),vn+=`';
`;var es=cs.call(j,"variable")&&j.variable;if(!es)vn=`with (obj) {
`+vn+`
}
`;else if(o.test(es))throw new ni(a);vn=(Pi?vn.replace(We,""):vn).replace(Ge,"$1").replace(mt,"$1;"),vn="function("+(es||"obj")+`) {
`+(es?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(pi?", __e = _.escape":"")+(Pi?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+vn+`return __p
}`;var Xs=U2(function(){return wi(jt,Ir+"return "+vn).apply(n,ci)});if(Xs.source=vn,He(Xs))throw Xs;return Xs}function wI(D){return tr(D).toLowerCase()}function SI(D){return tr(D).toUpperCase()}function II(D,j,me){if(D=tr(D),D&&(me||j===n))return Br(D);if(!D||!(j=Su(j)))return D;var Qe=aa(D),Et=aa(j),jt=Do(Qe,Et),ci=cl(Qe,Et)+1;return kc(Qe,jt,ci).join("")}function EI(D,j,me){if(D=tr(D),D&&(me||j===n))return D.slice(0,Ma(D)+1);if(!D||!(j=Su(j)))return D;var Qe=aa(D),Et=cl(Qe,aa(j))+1;return kc(Qe,0,Et).join("")}function CI(D,j,me){if(D=tr(D),D&&(me||j===n))return D.replace(Je,"");if(!D||!(j=Su(j)))return D;var Qe=aa(D),Et=Do(Qe,aa(j));return kc(Qe,Et).join("")}function TI(D,j){var me=At,Qe=yt;if(Lt(j)){var Et="separator"in j?j.separator:Et;me="length"in j?Yn(j.length):me,Qe="omission"in j?Su(j.omission):Qe}D=tr(D);var jt=D.length;if(Dl(D)){var ci=aa(D);jt=ci.length}if(me>=jt)return D;var pi=me-xo(Qe);if(pi<1)return Qe;var Pi=ci?kc(ci,0,pi).join(""):D.slice(0,pi);if(Et===n)return Pi+Qe;if(ci&&(pi+=Pi.length-pi),dn(Et)){if(D.slice(pi).search(Et)){var hn,fn=Pi;for(Et.global||(Et=jn(Et.source,tr(di.exec(Et))+"g")),Et.lastIndex=0;hn=Et.exec(fn);)var vn=hn.index;Pi=Pi.slice(0,vn===n?pi:vn)}}else if(D.indexOf(Su(Et),pi)!=pi){var er=Pi.lastIndexOf(Et);er>-1&&(Pi=Pi.slice(0,er))}return Pi+Qe}function kI(D){return D=tr(D),D&&ae.test(D)?D.replace(ot,Oa):D}var MI=Yh(function(D,j,me){return D+(me?" ":"")+j.toUpperCase()}),T1=Mc("toUpperCase");function V2(D,j,me){return D=tr(D),j=me?n:j,j===n?vo(D)?cu(D):vu(D):D.match(j)||[]}var U2=xs(function(D,j){try{return ps(D,n,j)}catch(me){return He(me)?me:new ni(me)}}),PI=Pc(function(D,j){return uo(j,function(me){me=bs(me),Ei(D,me,oA(D[me],D))}),D});function DI(D){var j=D==null?0:D.length,me=Dr();return D=j?Qs(D,function(Qe){if(typeof Qe[1]!="function")throw new Jn(S);return[me(Qe[0]),Qe[1]]}):[],xs(function(Qe){for(var Et=-1;++Et<j;){var jt=D[Et];if(ps(jt[0],this,Qe))return ps(jt[1],this,Qe)}})}function LI(D){return Nn(cn(D,oe))}function k1(D){return function(){return D}}function BI(D,j){return D==null||D!==D?j:D}var zI=IA(),RI=IA(!0);function Vc(D){return D}function M1(D){return Tc(typeof D=="function"?D:cn(D,oe))}function FI(D){return Zh(cn(D,oe))}function OI(D,j){return ff(D,cn(j,oe))}var NI=xs(function(D,j){return function(me){return Jl(me,D,j)}}),VI=xs(function(D,j){return function(me){return Jl(D,me,j)}});function P1(D,j,me){var Qe=mo(j),Et=os(j,Qe);me==null&&!(Lt(j)&&(Et.length||!Qe.length))&&(me=j,j=D,D=this,Et=os(j,mo(j)));var jt=!(Lt(me)&&"chain"in me)||!!me.chain,ci=pt(D);return uo(Et,function(pi){var Pi=j[pi];D[pi]=Pi,ci&&(D.prototype[pi]=function(){var hn=this.__chain__;if(jt||hn){var fn=D(this.__wrapped__),vn=fn.__actions__=bl(this.__actions__);return vn.push({func:Pi,args:arguments,thisArg:D}),fn.__chain__=hn,fn}return Pi.apply(D,Xo([this.value()],arguments))})}),D}function UI(){return Ns._===this&&(Ns._=Rn),this}function D1(){}function GI(D){return D=Yn(D),xs(function(j){return df(j,D)})}var qI=Jh(Qs),HI=Jh(Xl),jI=Jh(Ta);function G2(D){return PA(D)?pr(bs(D)):Y0(D)}function ZI(D){return function(j){return D==null?n:ls(D,j)}}var QI=Tp(),WI=Tp(!0);function L1(){return[]}function B1(){return!1}function $I(){return{}}function XI(){return""}function YI(){return!0}function KI(D,j){if(D=Yn(D),D<1||D>Ft)return[];var me=Ci,Qe=vs(D,Ci);j=Dr(j),D-=Ci;for(var Et=Kr(Qe,j);++me<D;)j(me);return Et}function JI(D){return f(D)?Qs(D,bs):Fn(D)?[D]:bl(md(tr(D)))}function eE(D){var j=++Yu;return tr(D)+j}var tE=EA(function(D,j){return D+j},0),iE=Cf("ceil"),nE=EA(function(D,j){return D/j},1),rE=Cf("floor");function sE(D){return D&&D.length?Vs(D,Vc,Js):n}function aE(D,j){return D&&D.length?Vs(D,Dr(j,2),Js):n}function oE(D){return ss(D,Vc)}function lE(D,j){return ss(D,Dr(j,2))}function uE(D){return D&&D.length?Vs(D,Vc,Yc):n}function cE(D,j){return D&&D.length?Vs(D,Dr(j,2),Yc):n}var hE=EA(function(D,j){return D*j},1),AE=Cf("round"),fE=EA(function(D,j){return D-j},0);function dE(D){return D&&D.length?as(D,Vc):0}function pE(D,j){return D&&D.length?as(D,Dr(j,2)):0}return F.after=ch,F.ary=aA,F.assign=Ga,F.assignIn=ao,F.assignInWith=Ia,F.assignWith=Ho,F.at=po,F.before=$A,F.bind=oA,F.bindAll=PI,F.bindKey=N0,F.castArray=_,F.chain=Md,F.chunk=rh,F.compact=zA,F.concat=zp,F.cond=DI,F.conforms=LI,F.constant=k1,F.countBy=Bd,F.create=ca,F.curry=Qp,F.curryRight=Gd,F.debounce=qd,F.defaults=Er,F.defaultsDeep=Eo,F.defer=XA,F.delay=Fl,F.difference=E0,F.differenceBy=RA,F.differenceWith=Rp,F.drop=_d,F.dropRight=yd,F.dropRightWhile=Um,F.dropWhile=Gm,F.fill=qm,F.filter=Of,F.flatMap=Fd,F.flatMapDeep=wl,F.flatMapDepth=QA,F.flatten=dl,F.flattenDeep=C0,F.flattenDepth=T0,F.flip=Fc,F.flow=zI,F.flowRight=RI,F.fromPairs=Lc,F.functions=ju,F.functionsIn=Zu,F.groupBy=Od,F.initial=NA,F.intersection=Lf,F.intersectionBy=Bf,F.intersectionWith=Cu,F.invert=$p,F.invertBy=Hd,F.invokeMap=jp,F.iteratee=M1,F.keyBy=Nd,F.keys=mo,F.keysIn=Co,F.map=uh,F.mapKeys=Wf,F.mapValues=Xp,F.matches=FI,F.matchesProperty=OI,F.memoize=Ph,F.merge=Wm,F.mergeWith=Yp,F.method=NI,F.methodOf=VI,F.mixin=P1,F.negate=YA,F.nthArg=GI,F.omit=$m,F.omitBy=nu,F.once=KA,F.orderBy=Vd,F.over=qI,F.overArgs=Gf,F.overEvery=HI,F.overSome=jI,F.partial=V0,F.partialRight=qf,F.partition=dc,F.pick=Qu,F.pickBy=Dh,F.property=G2,F.propertyOf=ZI,F.pull=UA,F.pullAll=sh,F.pullAllBy=GA,F.pullAllWith=M0,F.pullAt=Hm,F.range=QI,F.rangeRight=WI,F.rearg=Hf,F.reject=Vf,F.remove=xd,F.rest=jf,F.reverse=Mh,F.sampleSize=Zm,F.set=ru,F.setWith=Wu,F.shuffle=Qm,F.slice=Bc,F.sortBy=sA,F.sortedUniq=D0,F.sortedUniqBy=Rf,F.split=yI,F.spread=U0,F.tail=ec,F.take=zc,F.takeRight=rA,F.takeRightWhile=L0,F.takeWhile=Fp,F.tap=qp,F.throttle=Zf,F.thru=jA,F.toArray=la,F.toPairs=Xm,F.toPairsIn=Hg,F.toPath=JI,F.toPlainObject=ua,F.transform=E1,F.unary=Qf,F.union=Sd,F.unionBy=Ff,F.unionWith=qA,F.uniq=Op,F.uniqBy=Id,F.uniqWith=Ed,F.unset=C1,F.unzip=oh,F.unzipWith=Cd,F.update=Tu,F.updateWith=mc,F.values=Nc,F.valuesIn=Ah,F.without=Np,F.words=V2,F.wrap=Wp,F.xor=Td,F.xorBy=Vp,F.xorWith=HA,F.zip=lh,F.zipObject=Up,F.zipObjectDeep=Gp,F.zipWith=kd,F.entries=Xm,F.entriesIn=Hg,F.extend=ao,F.extendWith=Ia,P1(F,F),F.add=tE,F.attempt=U2,F.camelCase=sI,F.capitalize=O2,F.ceil=iE,F.clamp=$f,F.clone=h,F.cloneDeep=P,F.cloneDeepWith=H,F.cloneWith=w,F.conformsTo=J,F.deburr=N2,F.defaultTo=BI,F.divide=nE,F.endsWith=aI,F.eq=ee,F.escape=oI,F.escapeRegExp=lI,F.every=R0,F.find=zd,F.findIndex=vd,F.findKey=rl,F.findLast=Rd,F.findLastIndex=FA,F.findLastKey=sl,F.floor=rE,F.forEach=F0,F.forEachRight=O0,F.forIn=Bu,F.forInRight=Hu,F.forOwn=Ol,F.forOwnRight=Oc,F.get=iu,F.gt=ge,F.gte=Te,F.has=hh,F.hasIn=lA,F.head=OA,F.identity=Vc,F.includes=Hp,F.indexOf=Df,F.inRange=Lh,F.invoke=jd,F.isArguments=Ne,F.isArray=f,F.isArrayBuffer=u,F.isArrayLike=p,F.isArrayLikeObject=E,F.isBoolean=B,F.isBuffer=q,F.isDate=W,F.isElement=se,F.isEmpty=fe,F.isEqual=ve,F.isEqualWith=Be,F.isError=He,F.isFinite=it,F.isFunction=pt,F.isInteger=vt,F.isLength=Dt,F.isMap=ei,F.isMatch=Zt,F.isMatchWith=Wt,F.isNaN=hi,F.isNative=vi,F.isNil=In,F.isNull=Ji,F.isNumber=un,F.isObject=Lt,F.isObjectLike=Rt,F.isPlainObject=ln,F.isRegExp=dn,F.isSafeInteger=Vn,F.isSet=on,F.isString=Ki,F.isSymbol=Fn,F.isTypedArray=Un,F.isUndefined=gr,F.isWeakMap=jr,F.isWeakSet=Xr,F.join=k0,F.kebabCase=uI,F.last=Du,F.lastIndexOf=kh,F.lowerCase=cI,F.lowerFirst=hI,F.lt=Us,F.lte=Da,F.max=sE,F.maxBy=aE,F.mean=oE,F.meanBy=lE,F.min=uE,F.minBy=cE,F.stubArray=L1,F.stubFalse=B1,F.stubObject=$I,F.stubString=XI,F.stubTrue=YI,F.multiply=hE,F.nth=VA,F.noConflict=UI,F.noop=D1,F.now=Fo,F.pad=AI,F.padEnd=fI,F.padStart=dI,F.parseInt=pI,F.random=rI,F.reduce=Ud,F.reduceRight=Nf,F.repeat=mI,F.replace=gI,F.result=pc,F.round=AE,F.runInContext=mi,F.sample=Uf,F.size=Zp,F.snakeCase=_I,F.some=WA,F.sortedIndex=ah,F.sortedIndexBy=bd,F.sortedIndexOf=zf,F.sortedLastIndex=wd,F.sortedLastIndexBy=jm,F.sortedLastIndexOf=P0,F.startCase=vI,F.startsWith=xI,F.subtract=fE,F.sum=dE,F.sumBy=pE,F.template=bI,F.times=KI,F.toFinite=us,F.toInteger=Yn,F.toLength=Ts,F.toLower=wI,F.toNumber=rr,F.toSafeInteger=Rs,F.toString=tr,F.toUpper=SI,F.trim=II,F.trimEnd=EI,F.trimStart=CI,F.truncate=TI,F.unescape=kI,F.uniqueId=eE,F.upperCase=MI,F.upperFirst=T1,F.each=F0,F.eachRight=O0,F.first=OA,P1(F,function(){var D={};return Io(F,function(j,me){cs.call(F.prototype,me)||(D[me]=j)}),D}(),{chain:!1}),F.VERSION=c,uo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(D){F[D].placeholder=F}),uo(["drop","take"],function(D,j){Se.prototype[D]=function(me){me=me===n?1:br(Yn(me),0);var Qe=this.__filtered__&&!j?new Se(this):this.clone();return Qe.__filtered__?Qe.__takeCount__=vs(me,Qe.__takeCount__):Qe.__views__.push({size:vs(me,Ci),type:D+(Qe.__dir__<0?"Right":"")}),Qe},Se.prototype[D+"Right"]=function(me){return this.reverse()[D](me).reverse()}}),uo(["filter","map","takeWhile"],function(D,j){var me=j+1,Qe=me==Ye||me==ct;Se.prototype[D]=function(Et){var jt=this.clone();return jt.__iteratees__.push({iteratee:Dr(Et,3),type:me}),jt.__filtered__=jt.__filtered__||Qe,jt}}),uo(["head","last"],function(D,j){var me="take"+(j?"Right":"");Se.prototype[D]=function(){return this[me](1).value()[0]}}),uo(["initial","tail"],function(D,j){var me="drop"+(j?"":"Right");Se.prototype[D]=function(){return this.__filtered__?new Se(this):this[me](1)}}),Se.prototype.compact=function(){return this.filter(Vc)},Se.prototype.find=function(D){return this.filter(D).head()},Se.prototype.findLast=function(D){return this.reverse().find(D)},Se.prototype.invokeMap=xs(function(D,j){return typeof D=="function"?new Se(this):this.map(function(me){return Jl(me,D,j)})}),Se.prototype.reject=function(D){return this.filter(YA(Dr(D)))},Se.prototype.slice=function(D,j){D=Yn(D);var me=this;return me.__filtered__&&(D>0||j<0)?new Se(me):(D<0?me=me.takeRight(-D):D&&(me=me.drop(D)),j!==n&&(j=Yn(j),me=j<0?me.dropRight(-j):me.take(j-D)),me)},Se.prototype.takeRightWhile=function(D){return this.reverse().takeWhile(D).reverse()},Se.prototype.toArray=function(){return this.take(Ci)},Io(Se.prototype,function(D,j){var me=/^(?:filter|find|map|reject)|While$/.test(j),Qe=/^(?:head|last)$/.test(j),Et=F[Qe?"take"+(j=="last"?"Right":""):j],jt=Qe||/^find/.test(j);Et&&(F.prototype[j]=function(){var ci=this.__wrapped__,pi=Qe?[1]:arguments,Pi=ci instanceof Se,hn=pi[0],fn=Pi||f(ci),vn=function(ha){var va=Et.apply(F,Xo([ha],pi));return Qe&&er?va[0]:va};fn&&me&&typeof hn=="function"&&hn.length!=1&&(Pi=fn=!1);var er=this.__chain__,Ir=!!this.__actions__.length,es=jt&&!er,Xs=Pi&&!Ir;if(!jt&&fn){ci=Xs?ci:new Se(this);var ts=D.apply(ci,pi);return ts.__actions__.push({func:jA,args:[vn],thisArg:n}),new le(ts,er)}return es&&Xs?D.apply(this,pi):(ts=this.thru(vn),es?Qe?ts.value()[0]:ts.value():ts)})}),uo(["pop","push","shift","sort","splice","unshift"],function(D){var j=$s[D],me=/^(?:push|sort|unshift)$/.test(D)?"tap":"thru",Qe=/^(?:pop|shift)$/.test(D);F.prototype[D]=function(){var Et=arguments;if(Qe&&!this.__chain__){var jt=this.value();return j.apply(f(jt)?jt:[],Et)}return this[me](function(ci){return j.apply(f(ci)?ci:[],Et)})}}),Io(Se.prototype,function(D,j){var me=F[j];if(me){var Qe=me.name+"";cs.call(Es,Qe)||(Es[Qe]=[]),Es[Qe].push({name:j,func:me})}}),Es[Kh(n,st).name]=[{name:"wrapper",func:n}],Se.prototype.clone=Xe,Se.prototype.reverse=bt,Se.prototype.value=kt,F.prototype.at=B0,F.prototype.chain=z0,F.prototype.commit=Rc,F.prototype.next=Pd,F.prototype.plant=ZA,F.prototype.reverse=Dd,F.prototype.toJSON=F.prototype.valueOf=F.prototype.value=Ld,F.prototype.first=F.prototype.head,ql&&(F.prototype[ql]=Lu),F},ho=_l();yo?((yo.exports=ho)._=ho,Tl._=ho):Ns._=ho}).call(s0)})(Q_,Q_.exports);var Y9=Q_.exports;function h5(t,e,n){let c=[t],g=[],v,S,a;for(;t=c.pop();)if(!(n&&n(t))&&(g.push(t),v=t.children,v))for(S=0,a=v.length;S<a;++S)c.push(v[S]);for(;t=g.pop();)e(t);return t}function K9(t,e,n){let c=[t],g,v;for(;t=c.pop();)if(!(n&&n(t))&&(e(t),g=t.children,g))for(v=g.length-1;v>=0;--v)c.push(g[v]);return t}function J9(t,e,n){let c,g=[t],v,S,a;do for(c=g.reverse(),g=[];t=c.pop();)if(!(n&&n(t))&&(e(t),v=t.children,v))for(S=0,a=v.length;S<a;++S)g.push(v[S]);while(g.length);return t}function eF(t){return h5(t,function(c){c.children&&(c.children[0].data.multiway_parent=c,c.children[1].data.multiway_parent=c.parent)}),Y9.map(t.descendants(),c=>{let g=c.data.multiway_parent,v="unknown";return g&&(v=g.data.name),{source:c.data.multiway_parent,target:c,name:v}})}function tF(){let t=this.branch_length;return t?bv(this.nodes.descendants(),function(e){return!e.parent||!dp(t(e))}):!1}function iF(){let t=this.branch_length;return yc(this.nodes.descendants(),e=>t(e))}function Ev(t,e){let n=t.data;if("attribute"in n&&n.attribute&&n.attribute.length){e>0&&(n.attribute=String(e));let c=parseFloat(n.attribute);if(!isNaN(c))return Math.max(0,c)}if(n.name=="root")return 0;console.warn("Undefined branch length at "+n.name+"!")}function nF(t){return arguments.length?(this.branch_length_accessor=t||Ev,this):this.branch_length_accessor}function rF(t){let e=this.branch_length,n=yc(this.nodes.descendants(),function(S){return e(S)?e(S):null});const c=w2(n),g=KS(n);let v=function(S){return(S-g)/(c-g)};return Wc(this.nodes.descendants(),S=>{let a=e(S);a&&e(S,v(a))}),this}function sF(t){let e=this.branch_length;return Wc(this.nodes.descendants(),n=>{let c=e(n);c&&e(n,t(c))}),this}function aF(t){return arguments.length?(this.nodeLabel=t,this):this.nodeLabel}function oF(t,e){if(!(t instanceof rp))throw new Error("node needs to be an instance of a d3.hierarchy node!");let n=this.nodes.copy();if(e=e!==void 0?e:.5,t.parent){var c=rp({name:"new_root"});c.children=[t.copy()],c.data.__mapped_bl=void 0,n.each($=>{$.data.__mapped_bl=this.branch_length_accessor($)}),this.setBranchLength($=>$.data.__mapped_bl);let v=t,S=t.parent,a=void 0,N=t.data.__mapped_bl===void 0?void 0:t.data.__mapped_bl*e;a=S.data.__mapped_bl,S.data.__mapped_bl=t.data.__mapped_bl===void 0?void 0:t.data.__mapped_bl-N,t.data.__mapped_bl=N;var g;if(S.parent){for(c.children.push(S);S.parent;){g=S.children.indexOf(v),S.parent.parent?S.children.splice(g,1,S.parent):S.children.splice(g,1);let $=S.parent.data.__mapped_bl;$!==void 0&&(S.parent.data.__mapped_bl=a,a=$),v=S,S=S.parent}g=S.children.indexOf(v),S.children.splice(g,1)}else g=S.children.indexOf(v),S.children.splice(g,1),a=S.data.__mapped_bl,v=c;if(S.children.length==1)a&&(S.children[0].data.__mapped_bl+=a),v.children=v.children.concat(S.children);else{let $=new rp({name:"__reroot_top_clade",__mapped_bl:a});kg(c.children[0],t),$.data.__mapped_bl=a,$.children=S.children.map(function(he){return he.parent=$,he}),$.parent=v,v.children.push($)}}if(this.update(c),this.traverse_and_compute(v=>{Wc(v.children,S=>{S.parent=v})},"pre-order"),!dp(this.display)){let v=this.display.options;pl(this.display.container).select("svg").remove();let S=this.display.selection_attribute_name;delete this.display;let a=this.render(v);a.selectionLabel(S),a.update(),pl(a.container).node().appendChild(a.show()),pl(this.display.container).dispatch("reroot")}return this}function lF(t,e){if(t=t||"attribute",e=e||"y_scaled","parent"in this){let n=parseFloat(this[t]);this[e]=this.parent[e]+(isNaN(n)?.1:n)}else this[e]=0;return this[e]}function uF(t){let e=[];for(;t;)e.push(t),t=t.parent;return e}const cF=Object.freeze(Object.defineProperty({__proto__:null,pathToRoot:uF,reroot:oF,rootpath:lF},Symbol.toStringTag,{value:"Module"}));function l0(t){return t.y}function ap(t){return t.x}function W_(t,e,n){return{x:n+t*Math.sin(e),y:n+t*Math.cos(e)}}function iw(t,e,n,c,g,v){t.radius=e*(t.radius+n),t.angle=2*Math.PI*t.x*g[0]/v[0];let S=W_(t.radius,t.angle,c);return t.x=S.x,t.y=S.y,t}function nw(t,e){var n=W_(e[0].radius,e[0].angle,t),c=W_(e[0].radius,e[1].angle,t);return"M "+l0(n)+","+ap(n)+" A "+e[0].radius+","+e[0].radius+" 0,0, "+(e[1].angle>e[0].angle?1:0)+" "+l0(c)+","+ap(c)+" L "+l0(e[1])+","+ap(e[1])}function hF(t,e,n){var c=W_(t.target.radius+(t.source.radius-t.target.radius)*e,t.target.angle,n);return{x:l0(c),y:ap(c)}}var rw=mv().x(function(t){return l0(t)}).y(function(t){return ap(t)}).curve(e7);function sw(t,e){return{x:l0(t.target)+(l0(t.source)-l0(t.target))*e,y:ap(t.target)}}function E2(t){return t.tag||!1}function C2(t,e){return t[e]||!1}const Zo={"tree-container":"phylotree-container","tree-scale-bar":"tree-scale-bar",node:"node","internal-node":"internal-node","tagged-node":"node-tagged","selected-node":"node-selected","collapsed-node":"node-collapsed","root-node":"root-node",branch:"branch","selected-branch":"branch-selected","tagged-branch":"branch-tagged","tree-selection-brush":"tree-selection-brush","branch-tracer":"branch-tracer",clade:"clade",node_text:"phylotree-node-text"};function AF(t){return arguments.length?(this.options["internal-names"]=t,this):this.options["internal-names"]}function fF(t){return arguments.length?(this.options["is-radial"]=t,this):this.options["is-radial"]}function dF(t){return arguments.length?(this.options["align-tips"]=t,this):this.options["align-tips"]}function pF(t){return this.options["draw-size-bubbles"]&&this.options["bubble-styler"]?this.options["bubble-styler"](t):this.options["draw-size-bubbles"]?this.relative_nodeSpan(t)*this.scales[0]*.25:0}function mF(t){return this.options["is-radial"]?[(t.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-t.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-t.screen_x,0]:[this.right_most_leaf-t.screen_x,0]}function gF(t){return arguments.length?(this.layout_listener_handler=t,this):this.layout_listener_handler}function _F(t){return arguments.length?(this.selection_attribute_name=t,this.syncEdgeLabels(),this):this.selection_attribute_name}function m_(t){return arguments.length?(typeof t=="string"&&t=="equal"?m_=function(e){return 1}:m_=t,this):m_}var Cv={all:t=>!0,none:t=>!1,"all-leaf-nodes":t=>Cl(t.target),"all-internal-nodes":t=>!Cl(t.target)};function yF(t){return t?(this.selectionCallback=t,this):this.selectionCallback}const vF=Object.freeze(Object.defineProperty({__proto__:null,alignTips:dF,css_classes:Zo,internalNames:AF,layoutHandler:gF,nodeBubbleSize:pF,get nodeSpan(){return m_},predefined_selecters:Cv,radial:fF,selectionCallback:yF,selectionLabel:_F,shiftTip:mF},Symbol.toStringTag,{value:"Module"}));function xF(t){return this.radial()?[(t.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-t.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-t.screen_x,0]:[this.right_most_leaf-t.screen_x,0]}function bF(t,e,n){t=pl(t);var c=Cl(e);c&&(t=t.attr("data-node-name",e.data.name));var g=t.selectAll("text").data([e]),v=t.selectAll("line");if(c||this.showInternalName(e)&&!pp(e))if(g=g.enter().append("text").classed(this.css_classes.node_text,!0).merge(g).on("click",a=>{this.handle_node_click(e,a)}).attr("dy",a=>this.shown_font_size*.33).text(a=>this.options["show-labels"]?this._nodeLabel(a):"").style("font-size",a=>this.ensure_size_is_in_px(this.shown_font_size)),this.radial()?g=g.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)+this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)).attr("text-anchor",a=>a.text_align):g=g.attr("text-anchor","start").attr("transform",a=>this.options.layout=="right-to-left"?this.d3PhylotreeSvgTranslate([-20,0]):this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)),this.alignTips()?(v=v.data([e]),n?v=v.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(v).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(e)).attr("x2",0).attr("y1",0).attr("y2",0).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)):(v=v.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(v).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(e)).attr("y2",0).attr("y1",0).attr("x2",a=>this.shiftTip(a)[0]),v.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)))):v.remove(),this.options["draw-size-bubbles"]){var S=this.nodeBubbleSize(e);t.selectAll("circle").data([S]).enter().append("circle").attr("r",function(N){return N}),this.shown_font_size>=5&&(g=g.attr("dx",N=>(N.text_align=="end"?-1:1)*((this.alignTips()?0:S)+this.shown_font_size*.33)))}else this.shown_font_size>=5&&(g=g.attr("dx",a=>(a.text_align=="end"?-1:1)*this.shown_font_size*.33));if(!c){let a=t.selectAll("circle").data([e]).enter().append("circle"),N=this.node_circle_size()(e);N>0?a.merge(a).attr("r",$=>Math.min(this.shown_font_size*.75,N)).on("click",$=>{this.handle_node_click(e,$)}):a.remove()}return this.node_styler&&this.node_styler(t,e),e}function wF(){let t=this.phylotree.nodes.descendants();for(let e=t.length-1;e>=0;e-=1)Cl(t[e])?t[e].hasHiddenNodes=t[e].notshown:t[e].hasHiddenNodes=t[e].children.reduce(function(n,c){return c.notshown||n},!1);return this}function SF(t){const e=this.internalNames();return e?typeof e=="function"?e(t):e:!1}function IF(t){return arguments.length?(typeof t=="string"&&t=="equal"?this.nodeSpan=function(e){return 1}:this.nodeSpan=t,this):this.nodeSpan}function EF(t){let e=Zo[Cl(t)?"node":"internal-node"];return E2(t)&&(e+=" "+Zo["tagged-node"]),C2(t,this.selection_attribute_name)&&(e+=" "+Zo["selected-node"]),t.parent||(e+=" "+Zo["root-node"]),(pp(t)||T2(t))&&(e+=" "+Zo["collapsed-node"]),e}function Tv(t){return!(t.hidden||t.notshown)}function A5(t){return t.notshown}function T2(t){return t.hasHiddenNodes||!1}function pp(t){return t.collapsed||!1}function f5(t){return[t.node,t["internal-node"],t["collapsed-node"],t["tagged-node"],t["root-node"]].reduce(function(e,n,c,g){return e+="g."+n+(c<g.length-1?",":"")},"")}function CF(t,e){this.phylotree.clearInternalNodes(e);for(var n=this.phylotree.nodes.descendants().length-1;n>=0;n--){var c=this.phylotree.nodes.descendants()[n];Cl(c)||C2(c,this.selection_attribute_name)||(c[this.selection_attribute_name]=t(c.children))}this.modifySelection((g,v)=>Cl(g.target)?g.target[this.selection_attribute_name]:g.target[this.selection_attribute_name])}function d5(t){return t=t.data,Cl(t)?t.name||"":this.showInternalName(t)?t.name:""}function TF(t){return arguments.length?(this._nodeLabel=t||d5,this.update(),this):this._nodeLabel}const kF=Object.freeze(Object.defineProperty({__proto__:null,defNodeLabel:d5,drawNode:bF,hasHiddenNodes:T2,internalLabel:CF,isNodeCollapsed:pp,nodeCssSelectors:f5,nodeLabel:TF,nodeNotshown:A5,nodeSpan:IF,nodeVisible:Tv,reclassNode:EF,shiftTip:xF,showInternalName:SF,updateHasHiddenNodes:wF},Symbol.toStringTag,{value:"Module"}));function p5(t){return[t.clade].reduce(function(e,n,c,g){return e+="path."+n+(c<g.length-1?",":"")},"")}function MF(t){let e=this.svg.selectAll("."+this.css_classes["tree-container"]);var n=0;let c=e.selectAll(p5(this.css_classes)).data(this.phylotree.nodes.descendants().filter(pp),function(S){return S.id||(S.id=++n)}),g=function(){},v=void 0;this.radial()?(g=mv().curve(Hb).y(function(S){return S[0]}).x(function(S){return S[1]}),v=function(S,a,N,$,he){return a?[N.screen_y+(S[0]-$)/50,N.screen_x+(S[1]-he)/50]:[N.screen_y,N.screen_x]}):(g=mv().y(function(S){return S[0]}).x(function(S){return S[1]}).curve(Hb),v=function(S,a,N,$,he){return a?[N.screen_y+(S[0]-$)/50,N.screen_x+(S[1]-he)/50]:[N.screen_y,N.screen_x]}),c.exit().each(function(S){S.collapsed_clade=null}).remove(),t?c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(S){if(S.collapsed_clade)return S.collapsed_clade;let a=S.collapsed[0][0],N=S.collapsed[0][1];return g(S.collapsed.map(function($,he){return v($,he,S,a,N)}))}).attr("d",function(S){return S.collapsed_clade=g(S.collapsed)}):c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(S){return S.collapsed_clade?S.collapsed_clade:S.collapsed_clade=g(S.collapsed)})}const PF=Object.freeze(Object.defineProperty({__proto__:null,cladeCssSelectors:p5,updateCollapsedClades:MF},Symbol.toStringTag,{value:"Module"}));function DF(t,e,n){t=pl(t),t=t.attr("class",S=>this.reclassEdge(S)).on("click",S=>{this.modifySelection([e.target],this.selection_attribute_name),this.update()});let c=this.draw_branch([e.source,e.target]);n&&t.datum().existing_path&&(t=t.attr("d",function(S){return S.existing_path})),t=t.attr("d",c),e.existing_path=c;var g=this.phylotree.branch_length_accessor(e.target);if(g!==void 0){var v=t.selectAll("title");v.empty()&&(v=t.append("title")),v.text("Length = "+g)}else t.selectAll("title").remove();return this.edge_styler&&this.edge_styler(t,e,n),this.phylotree}function LF(t){let e=Zo.branch;return E2(t)&&(e+=" "+Zo["tagged-branch"]),C2(t,this.selection_attribute_name)&&(e+=" "+Zo["selected-branch"]),e}function BF(){this.links.forEach(t=>{t.target.data.annotation&&(t.target[t.target.data.annotation]=t.target.data.annotation)})}function zF(){if(this.links.forEach(t=>{t[this.selection_attribute_name]=t.target[this.selection_attribute_name]||!1,t.tag=t.target.tag||!1}),this.countHandler()){let t={};t[this.selection_attribute_name]=this.links.reduce((e,n)=>e+(n[this.selection_attribute_name]?1:0),0),t.tagged=this.links.reduce(function(e,n){return e+(E2(n)?1:0)},0),this.countUpdate(this,t,this.countHandler())}}function kv(t){return!(t.target.hidden||t.target.notshown)}function Mv(t){return[t.branch,t["selected-branch"],t["tagged-branch"]].reduce(function(e,n,c,g){return e+="path."+n+(c<g.length-1?",":"")},"")}function RF(t,e){return this.edge_placer(t,e)}const FF=Object.freeze(Object.defineProperty({__proto__:null,drawEdge:DF,edgeCssSelectors:Mv,edgeVisible:kv,initializeEdgeLabels:BF,placeAlongAnEdge:RF,reclassEdge:LF,syncEdgeLabels:zF},Symbol.toStringTag,{value:"Module"}));let p1="phylotree.event";function OF(t){if(t.collapsed){t.collapsed=!1;let e=function(n){Cl(n)||n.collapsed||n.children.forEach(e),n.hidden=!1};e(t)}else t.collapsed=!0;return this.placenodes(),this}function NF(t,e,n){let c=this.size;if(this.radial()){let g=this.pad_width(),v=this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0;c=[c[1]+2*g,c[0]+2*g+v],e&&e.selectAll("."+Zo["tree-container"]).attr("transform","translate ("+g+","+(g+v)+")")}else c=[c[0]+(this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0),c[1]+(this.options["left-right-spacing"]!="fit-to-size"?this.pad_width():0)];return e&&(n&&(e=e.transition(100)),e.attr("height",c[0]).attr("width",c[1])),this.size=c,c}function VF(t,e){e=e||"y_scaled",e in this&&(this[e]*=t)}function Pv(t){var e=new CustomEvent(p1,{detail:["refresh",t]});document.dispatchEvent(e)}function m5(t,e){var n=new CustomEvent(p1,{detail:["countUpdate",e,t.countHandler()]});document.dispatchEvent(n)}function UF(t){var e=new CustomEvent(p1,{detail:["layout",t,t.layoutHandler()]});document.dispatchEvent(e)}function g5(t){switch(t.detail[0]){case"refresh":t.detail[1].refresh();break;case"countUpdate":t.detail[2](t.detail[1]);break;case"layout":t.detail[2](t.detail[1])}return!0}function _5(){document.addEventListener(p1,g5,!1)}function GF(t){return t&&(t[0]!==null||t[1]!==null)?"translate ("+(t[0]!==null?t[0]:0)+","+(t[1]!==null?t[1]:0)+") ":""}function qF(t){return t!==null?"rotate ("+t+") ":""}const HF=Object.freeze(Object.defineProperty({__proto__:null,countUpdate:m5,d3PhylotreeAddEventListener:_5,d3PhylotreeEventListener:g5,d3PhylotreeSvgRotate:qF,d3PhylotreeSvgTranslate:GF,d3PhylotreeTriggerLayout:UF,rescale:VF,resizeSvg:NF,toggleCollapse:OF,triggerRefresh:Pv},Symbol.toStringTag,{value:"Module"}));let aw="d3_layout_phylotree_context_menu";function jF(t,e,n,c,g){let v=pl(e).select("#"+aw);if(v.empty()&&(v=pl(e).append("div").attr("id",aw).attr("class","dropdown-menu").attr("role","menu")),v.selectAll("a").remove(),v.selectAll("h6").remove(),v.selectAll("div").remove(),t){if(!Z_([!!t.menu_items,c.hide,c.selectable,c.collapsible])||!c["show-menu"])return;Cl(t)||(c.collapsible&&(v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(pp(t)?"Expand Subtree":"Collapse Subtree").on("click",$=>{v.style("display","none"),this.toggleCollapse(t).update()}),c.selectable&&(v.append("div").attr("class","dropdown-divider"),v.append("h6").attr("class","dropdown-header").text("Toggle selection"))),c.selectable&&(v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All descendant branches").on("click",function($){v.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!0,!0))}),v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All terminal branches").on("click",function($){v.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!0,!1))}),v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All internal branches").on("click",function($){v.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!1,!0))}))),t.parent&&(c.selectable&&(v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Incident branch").on("click",function($){v.style("display","none"),n.modifySelection([t])}),v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Path to root").on("click",$=>{v.style("display","none"),this.modifySelection(this.phylotree.pathToRoot(t))}),(c.reroot||c.hide)&&v.append("div").attr("class","dropdown-divider")),c.reroot&&v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Reroot on this node").on("click",$=>{v.style("display","none"),this.phylotree.reroot(t),this.update()}),c.hide&&v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Hide this "+(Cl(t)?"node":"subtree")).on("click",$=>{v.style("display","none"),this.modifySelection([t],"notshown",!0,!0).updateHasHiddenNodes().update()})),T2(t)&&v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Show all descendant nodes").on("click",function($){v.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!0,!0),"notshown",!0,!0,"false").updateHasHiddenNodes().update()});var S=[];if("menu_items"in t&&typeof t.menu_items=="object"&&t.menu_items.forEach(function($){$.length==3&&(!$[2]||$[2](t))&&S.push([$[0],$[1]])}),S.length){const $=[c.hide,c.selectable,c.collapsible];Z_($)&&v.append("div").attr("class","dropdown-divider"),S.forEach(function(he){v.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(he[0](t)).on("click",uf(he[1],t))})}let N=document.querySelector(e).getBoundingClientRect();v.style("position","absolute").style("left",""+(g.clientX-N.x+12)+"px").style("top",""+(g.clientY-N.y)+"px").style("display","block")}else v.style("display","none")}function ZF(t,e,n,c){"menu_items"in t||(t.menu_items=[]),t.menu_items.some(function(g){return g[0]==e&&g[1]==n&&g[2]==c})||t.menu_items.push([e,n,c])}function QF(t,e,n,c,g){if(e=e||this.selection_attribute_name,g=g||"toggle",this.options["restricted-selectable"].length)if(sf(_u(Cv),t))t=Cv[t];else return;if((this.options["restricted-selectable"]||this.options.selectable)&&!this.options["binary-selectable"]){var v=!1;typeof t=="function"?this.links.forEach(function(a){let N=t(a);a[e]=a[e]||!1,a[e]!=N&&(a[e]=N,v=!0,a.target[e]=N)}):(t.forEach(function(a){var N;switch(g){case"true":N=!0;break;case"false":N=!1;break;default:N=!a[e];break}a[e]!=N&&(a[e]=N,v=!0)}),this.links.forEach(function(a){a[e]=a.target[e]}));var S;v&&(c||Pv(this),this.countHandler&&(S={},S[e]=this.links.reduce(function(a,N){return a+(N[e]?1:0)},0),m5(this,S,this.countHandler)),n&&this.placenodes())}else this.options["binary-selectable"]&&(typeof t=="function"?this.links.forEach(function(a){var N=t(a);a[e]=a[e]||!1,a[e]!=N&&(a[e]=N,v=!0,a.target[e]=N),this.options["attribute-list"].forEach(function($){$!=e&&a[e]===!0&&(a[$]=!1,a.target[$]=!1)})}):(t.forEach(function(a){var N;N=!a[e],a[e]!=N&&(a[e]=N,v=!0)}),this.links.forEach(function(a){a[e]=a.target[e],this.options["attribute-list"].forEach(function(N){N!=e&&a[e]!==!0&&(a[N]=!1,a.target[N]=!1)})})),v&&(c||Pv(this),this.countHandler()&&(S={},S[e]=this.links.reduce(function(a,N){return a+(N[e]?1:0)},0),this.countUpdate(this,S,this.countHandler())),n&&this.placenodes()));return this.selectionCallback&&e!="tag"&&this.selectionCallback(this.getSelection()),this.refresh(),this.update(),this}function WF(){return this.nodes.filter(t=>t[this.selection_attribute_name])}function $F(t,e,n){let c=[];function g(v){Cl(v)?e&&v!=t&&c.push(v):(n&&v!=t&&c.push(v),v.children.forEach(g))}return g(t),c}function XF(t){return t?(this.selectionCallback=t,this):this.selectionCallback}const YF=Object.freeze(Object.defineProperty({__proto__:null,addCustomMenu:ZF,getSelection:WF,modifySelection:QF,nodeDropdownMenu:jF,selectAllDescendants:$F,selectionCallback:XF},Symbol.toStringTag,{value:"Module"}));function ow(t){return function(){return t}}class wp{constructor(e,n={}){this.css_classes=Zo,this.phylotree=e,this.container=n.container,this.separation=function(g,v){return 0},this._nodeLabel=this.defNodeLabel,this.svg=null,this.selectionCallback=null,this.scales=[1,1],this.size=[1,1],this.fixed_width=[14,30],this.scale_bar_font_size=12,this.draw_branch=rw,this.draw_scale_bar=null,this.edge_placer=sw,this.count_listener_handler=function(){},this.layout_listener_handler=function(){},this.node_styler=void 0,this.edge_styler=void 0,this.selection_attribute_name="selected",this.right_most_leaf=0,this.label_width=0,this.radial_center=0,this.radius=1,this.radius_pad_for_bubbles=0,this.rescale_nodeSpan=1,this.relative_nodeSpan=function(g){return this.nodeSpan(g)/this.rescale_nodeSpan};let c={layout:"left-to-right",logger:console,branches:"step",scaling:!0,bootstrap:!1,"color-fill":!0,"font-size":14,"internal-names":!1,selectable:!0,"restricted-selectable":!1,collapsible:!0,"left-right-spacing":"fixed-step","top-bottom-spacing":"fixed-step","left-offset":0,"show-scale":"top","draw-size-bubbles":!1,"bubble-styler":this.radius_pad_for_bubbles,"binary-selectable":!1,"is-radial":!1,"attribute-list":[],"max-radius":768,"annular-limit":.38196601125010515,compression:.2,"align-tips":!1,"maximum-per-node-spacing":100,"minimum-per-node-spacing":2,"maximum-per-level-spacing":100,"minimum-per-level-spacing":10,node_circle_size:ow(3),transitions:null,brush:!0,reroot:!0,hide:!0,"label-nodes-with-name":!1,zoom:!1,"show-menu":!0,"show-labels":!0,"node-styler":null,"edge-styler":null,"node-span":null};this.ensure_size_is_in_px=function(g){return typeof g=="number"?g+"px":g},this.options=m2(n,c),this.font_size=this.options["font-size"],this.offsets=[0,this.font_size/2],this.shown_font_size=this.font_size,this.width=this.options.width||800,this.height=this.options.height||600,this.node_styler=this.options["node-styler"],this.edge_styler=this.options["edge-styler"],this.nodeSpan=this.options["node-span"],this.nodeSpan||(this.nodeSpan=function(g){return 1}),this.rescale_nodeSpan=this.phylotree.nodes.children.map(g=>{if(Cl(g)||this.showInternalName(g))return this.nodeSpan(g)}).reduce(function(g,v){return Math.min(v,g||1e200)},null)||1,this.initialize_svg(this.container),this.links=this.phylotree.nodes.links(),this.initializeEdgeLabels(),this.update(),_5()}pad_height(){return this.draw_scale_bar?this.scale_bar_font_size+25:0}pad_width(){this.label_width=this._label_width(this.shown_font_size);const e=this.options["show-labels"]?this.label_width:0;return this.offsets[1]+this.options["left-offset"]+e}collapse_node(e){pp(e)||(e.collapsed=!0)}set_size(e){if(!arguments.length)return this.size;let n=e;return this.options["top-bottom-spacing"]!="fixed-step"&&(this.size[0]=n[0]),this.options["left-right-spacing"]!="fixed-step"&&(this.size[1]=n[1]),this}initialize_svg(e){return this.svg!==e&&(pl(e).select("svg").remove(),this.svg=YD("svg").attr("width",this.width).attr("height",this.height),this.set_size([this.height,this.width]),this.css_classes["tree-container"]=="phylotree-container"&&(this.svg.selectAll("*").remove(),this.svg.append("defs")),pl(this.container).on("click",n=>{this.handle_node_click(null)},!0)),this}update_layout(e,n){n&&(this.nodes=rp(e),this.nodes.each(function(c){c.id=null})),this.update(),this.syncEdgeLabels()}update(e){var n=this;this.placenodes(),e=this.transitions(e);let c=0,g=this.svg.selectAll("."+Zo["tree-container"]).data([0]);if(g=g.enter().append("g").attr("class",Zo["tree-container"]).merge(g).attr("transform",$=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()])),this.draw_scale_bar){let $=this.svg.selectAll("."+Zo["tree-scale-bar"]).data([0]);$.enter().append("g").attr("class",Zo["tree-scale-bar"]).style("font-size",this.ensure_size_is_in_px(this.scale_bar_font_size)).merge($).attr("transform",he=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()-10])).call(this.draw_scale_bar),$.selectAll("text").style("text-anchor","end")}else this.svg.selectAll("."+Zo["tree-scale-bar"]).remove();g=this.svg.selectAll("."+Zo["tree-container"]).data([0]),this.updateCollapsedClades(e);let v=g.selectAll(Mv(Zo)).data(this.links.filter(kv),$=>$.target.id||($.target.id=++c));v.exit().remove(),v=v.enter().insert("path",":first-child").merge(v).each(function($){n.drawEdge(this,$,e)});let S=g.selectAll(f5(Zo)).data(this.phylotree.nodes.descendants().filter(Tv),$=>$.id||($.id=++c));if(S.exit().remove(),S=S.enter().append("g").attr("class",this.reclassNode).merge(S).attr("transform",$=>{const he=this.options.layout=="right-to-left"&&Cl($);return $.screen_x=l0($),$.screen_y=ap($),this.d3PhylotreeSvgTranslate([he?0:$.screen_x,$.screen_y])}).each(function($){n.drawNode(this,$,e)}).attr("transform",$=>{if(!dp($.screen_x)&&!dp($.screen_y))return"translate("+$.screen_x+","+$.screen_y+")"}),this.options["label-nodes-with-name"]&&(S=S.attr("id",$=>"node-"+$.name)),this.resizeSvg(this.phylotree,this.svg,e),this.options.brush){var a=g.selectAll("."+Zo["tree-selection-brush"]).data([0]).enter().insert("g",":first-child").attr("class",Zo["tree-selection-brush"]),N=WB().on("brush",($,he)=>{var oe=$.selection,ce=this.links.filter(kv),_e=ce.filter((Ze,nt)=>Ze.source.screen_x>=oe[0][0]&&Ze.source.screen_x<=oe[1][0]&&Ze.source.screen_y>=oe[0][1]&&Ze.source.screen_y<=oe[1][1]&&Ze.target.screen_x>=oe[0][0]&&Ze.target.screen_x<=oe[1][0]&&Ze.target.screen_y>=oe[0][1]&&Ze.target.screen_y<=oe[1][1]).map(Ze=>Ze.target);this.modifySelection(this.phylotree.links.map(Ze=>Ze.target),"tag",!1,_e.length>0,"false"),this.modifySelection(_e,"tag",!1,!1,"true")}).on("end",()=>{});a.call(N)}if(this.syncEdgeLabels(),this.options.zoom){let $=o7().scaleExtent([.1,10]).on("zoom",he=>{pl("."+Zo["tree-container"]).attr("transform",oe=>he.transform),pl("."+Zo["tree-scale-bar"]).attr("transform",oe=>{let ce=he.transform;return ce.y-=10,ce})});this.svg.call($)}return this}_handle_single_node_layout(e){let n=this.nodeSpan(e)/this.rescale_nodeSpan;this.x=e.x=this.x+this.separation(this.last_node,e)+(this.last_span+n)*.5,this._extents[1][1]=Math.max(this._extents[1][1],e.y),this._extents[1][0]=Math.min(this._extents[1][0],e.y-n*.5),this.is_under_collapsed_parent?this._extents[0][1]=Math.max(this._extents[0][1],this.save_x+(e.x-this.save_x)*this.options.compression+this.save_span+(n*.5+this.separation(this.last_node,e))*this.options.compression):this._extents[0][1]=Math.max(this._extents[0][1],this.x+n*.5+this.separation(this.last_node,e)),this.last_node=e,this.last_span=n}tree_layout(e){if(A5(e))return;let n=Cl(e);e.text_angle=null,e.text_align=null,e.radius=null,e.angle=null;let c=!1;if(e.parent)if(this.do_scaling){if(c)return 0;if(e.y=this.phylotree.branch_length_accessor(e),typeof e.y>"u")return c=!0,0;e.y+=e.parent.y}else e.y=n?this.max_depth:e.depth;else this.x=0,e.y=0,this.last_node=null,this.last_span=0,this._extents=[[0,0],[0,0]];if(n&&this._handle_single_node_layout(e),!n)if(pp(e)&&!this.is_under_collapsed_parent){if(this.save_x=this.x,this.save_span=this.last_span*.5,this.is_under_collapsed_parent=!0,this.process_internal_node(e),this.is_under_collapsed_parent=!1,typeof e.x=="number"){e.x=this.save_x+(e.x-this.save_x)*this.options.compression+this.save_span,e.collapsed=[[e.x,e.y]];var g=v=>{v.hidden=!0,Cl(v)?(this.x=v.x=this.save_x+(v.x-this.save_x)*this.options.compression+this.save_span,e.collapsed.push([v.x,v.y])):v.children.map(g)};this.x=this.save_x,g(e),e.collapsed.splice(1,0,[this.save_x,e.y]),e.collapsed.push([this.x,e.y]),e.collapsed.push([e.x,e.y]),e.hidden=!1}}else this.process_internal_node(e);return e.x}process_internal_node(e){let n=0;if(this.showInternalName(e)){let c=e.children.length/2>>0,g=0,v=!1;for(let S=0;S<e.children.length;S++)typeof this.tree_layout(e.children[S])=="number"&&g++,g>=c&&!v&&(this._handle_single_node_layout(e),v=!0);g==0?(e.notshown=!0,e.x=void 0):v||this._handle_single_node_layout(e)}else e.x=e.children.map(this.tree_layout.bind(this)).reduce((c,g)=>typeof g=="number"?c+g:(n+=1,c),0),n==e.children.length?(e.notshown=!0,e.x=void 0):e.x/=e.children.length-n}do_lr(e){if(this.radial()&&e&&(this.offsets[1]=0),this.options["left-right-spacing"]=="fixed-step")this.size[1]=this.max_depth*this.fixed_width[1],this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"])/this._extents[1][1],this.label_width=this._label_width(this.shown_font_size),this.radial()&&(this.label_width*=2);else{this.label_width=this._label_width(this.shown_font_size),e=!0;let n=this.size[1]-this.offsets[1]-this.options["left-offset"];n*.5<this.label_width&&(this.shown_font_size*=n*.5/this.label_width,this.label_width=n*.5),this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"]-this.label_width)/this._extents[1][1]}}placenodes(){this._extents=[[0,0],[0,0]],this.x=0,this.last_span=0,this.last_node=null,this.last_span=0,this.save_x=this.x,this.save_span=this.last_span*.5,this.do_scaling=this.options.scaling;let e=!1;this.is_under_collapsed_parent=!1,this.max_depth=1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes,this.do_scaling),this.max_depth=uP(this.phylotree.nodes.descendants(),c=>c.depth),this.do_scaling&&e&&(this.do_scaling=!1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes));let n=!1;if(this.draw_scale_bar=this.options["show-scale"]&&this.do_scaling,this.offsets[1]=Math.max(this.font_size,-this._extents[1][0]*this.fixed_width[0]),this.options["top-bottom-spacing"]=="fixed-step"?(this.size[0]=this._extents[0][1]*this.fixed_width[0],this.scales[0]=this.fixed_width[0]):(this.scales[0]=(this.size[0]-this.pad_height())/this._extents[0][1],n=!0),this.shown_font_size=Math.min(this.font_size,this.scales[0]),this.radial()){this.draw_branch=uf(nw,this.radial_center),this.edge_placer=hF;let c=null,g=null,v=null,S=0,a=this._extents[0][1]*this.scales[0],N=function(ce,_e,Ze,nt,Ke){return Ke=Ke||0,Math.sqrt((_e-ce)*(_e-ce)+2*(ce+Ke)*(_e+Ke)*(1-Math.cos(Ze-nt)))},$=0;this.phylotree.nodes.each(ce=>{let _e=ce.x*this.scales[0];ce.angle=2*Math.PI*_e/a,ce.text_angle=ce.angle-Math.PI/2,ce.text_angle=ce.text_angle>0&&ce.text_angle<Math.PI,ce.text_align=ce.text_angle?"end":"start",ce.text_angle=(ce.text_angle?180:0)+ce.angle*180/Math.PI}),this.do_lr(n),this.phylotree.nodes.each(ce=>{ce.radius=ce.y*this.scales[1]/this.size[1],$=Math.max(ce.radius,$)});let he=0;this.phylotree.nodes.each(ce=>{if(!ce.children){let _e=ce.x*this.scales[0];if(c!==null){let Ze=_e-g,nt=N(ce.radius,v,ce.angle,c,he),Ke=nt>0?Ze/nt:10*this.options["max-radius"];if(Ke>this.options["max-radius"]){let st=Ze/this.options["max-radius"],ht=ce.radius+v,xt=ce.radius*v-(st*st-(v-ce.radius)*(v-ce.radius))/2/(1-Math.cos(c-ce.angle)),zt=Math.sqrt(ht*ht-4*xt);he=Math.min(this.options["annular-limit"]*$,(-ht+zt)/2),S=this.options["max-radius"]}else S=Math.max(S,Ke)}c=ce.angle,g=_e,v=ce.radius}}),this.radius=Math.min(this.options["max-radius"],Math.max(a/2/Math.PI,S)),n&&(this.radius=Math.min(this.radius,(Math.min(a,this._extents[1][1]*this.scales[1])-this.label_width)*.5-this.radius*he)),this.radial_center=this.radius_pad_for_bubbles=this.radius,this.draw_branch=uf(nw,this.radial_center);let oe=1;he&&(oe=$/($+he),this.radius*=oe),this.phylotree.nodes.each(ce=>{if(iw(ce,this.radius,he,this.radial_center,this.scales,this.size),$=Math.max($,ce.radius),this.options["draw-size-bubbles"]?this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ce.radius+this.nodeBubbleSize(ce)):this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ce.radius),ce.collapsed){ce.collapsed=ce.collapsed.map(Ze=>{let nt={};return nt.x=Ze[0],nt.y=Ze[1],nt=iw(nt,this.radius,he,this.radial_center,this.scales,this.size),[nt.x,nt.y]});let _e=ce.collapsed[1];ce.collapsed=ce.collapsed.filter(function(Ze,nt){return nt<3||nt>ce.collapsed.length-4?!0:Math.sqrt(Math.pow(Ze[0]-_e[0],2)+Math.pow(Ze[1]-_e[1],2))>3?(_e=Ze,!0):!1})}}),this.size[0]=this.radial_center+this.radius/oe,this.size[1]=this.radial_center+this.radius/oe}else this.do_lr(),this.draw_branch=rw,this.edge_placer=sw,this.right_most_leaf=0,this.phylotree.nodes.each(c=>{if(c.x*=this.scales[0],c.y*=this.scales[1]*.8,this.options.layout=="right-to-left"&&(c.y=this._extents[1][1]*this.scales[1]-c.y),Cl(c)&&(this.right_most_leaf=Math.max(this.right_most_leaf,c.y+this.nodeBubbleSize(c))),c.collapsed){c.collapsed.forEach(v=>{v[0]*=this.scales[0],v[1]*=this.scales[1]*.8});let g=c.collapsed[1][0];c.collapsed=c.collapsed.filter(function(v,S){return S<3||S>c.collapsed.length-4?!0:v[0]-g>3?(g=v[0],!0):!1})}});if(this.draw_scale_bar){let c,g;if(this.radial()){if(g=Math.min(this.radius/5,50),c=Math.pow(10,Math.ceil(Math.log(this._extents[1][1]*g/this.radius)/Math.log(10))),g=c*(this.radius/this._extents[1][1]),g<30){let a=Math.ceil(30/g);g*=a,c*=a}}else c=this._extents[1][1],g=this.size[1]-this.offsets[1]-this.options["left-offset"]-this.shown_font_size;let v=X4().domain([0,c]).range([0,g]),S=r2(".2f");if(this.draw_scale_bar=gP().scale(v).tickFormat(function(a){return a===0?"":S(a)}),this.radial())this.draw_scale_bar.tickValues([c]);else{let a=function($,he){return he?Math.round($*(he=Math.pow(10,he)))/he:Math.round($)},N=v.ticks();N=N.length>1?N[1]:N[0],this.draw_scale_bar.ticks(Math.min(10,a(g/(this.shown_font_size*S(N).length*2),0)))}}else this.draw_scale_bar=null;return this}spacing_x(e,n){return arguments.length?(this.fixed_width[0]!=e&&e>=this.options["minimum-per-node-spacing"]&&e<=this.options["maximum-per-node-spacing"]&&(this.fixed_width[0]=e,n||this.placenodes()),this):this.fixed_width[0]}spacing_y(e,n){return arguments.length?(this.fixed_width[1]!=e&&e>=this.options["minimum-per-level-spacing"]&&e<=this.options["maximum-per-level-spacing"]&&(this.fixed_width[1]=e,n||this.placenodes()),this):this.fixed_width[1]}_label_width(e){e=e||this.shown_font_size;let n=0;return this.phylotree.nodes.descendants().filter(Tv).forEach(c=>{let g=12+this._nodeLabel(c).length*e*.8;c.angle!==null&&(g*=Math.max(Math.abs(Math.cos(c.angle)),Math.abs(Math.sin(c.angle)))),n=Math.max(g,n)}),n}font_size(e){return arguments.length?(this.font_size=e===void 0?12:e,this):this.font_size}scale_bar_font_size(e){return arguments.length?(this.scale_bar_font_size=e===void 0?12:e,this):this.scale_bar_font_size}node_circle_size(e,n){return arguments.length?(this.options.node_circle_size=ow(e===void 0?3:e),this):this.options.node_circle_size}css(e){if(arguments.length===0)return this.css_classes;if(arguments.length>2){var n={};return n[e[0]]=e[1],this.css(n)}for(var c in Zo)c in e&&e[c]!=Zo[c]&&(Zo[c]=e[c]);return this}transitions(e){return e!==void 0?e:this.options.transitions!==null?this.options.transitions:this.phylotree.nodes.descendants().length<=300}css_classes(e,n){if(!arguments.length)return this.css_classes;let c=!1;for(var g in Zo)g in e&&e[g]!=this.css_classes[g]&&(c=!0,this.css_classes[g]=e[g]);return n&&c&&this.layout(),this}layout(e){return this.svg?(this.svg.selectAll("."+this.css_classes["tree-container"]+",."+this.css_classes["tree-scale-bar"]+",."+this.css_classes["tree-selection-brush"]),this.d3PhylotreeTriggerLayout(this),this.update()):(this.d3PhylotreeTriggerLayout(this),this)}handle_node_click(e,n){this.nodeDropdownMenu(e,this.container,this,this.options,n)}refresh(){if(this.svg){let n=this.svg.selectAll("."+this.css_classes["tree-container"]).selectAll(Mv(this.css_classes)).attr("class",this.reclassEdge.bind(this));this.edge_styler&&n.each(c=>{this.edge_styler(pl(this),c)})}return this}countHandler(e){return arguments.length?(this.count_listener_handler=e,this):this.count_listener_handler}style_nodes(e){return arguments.length?(this.node_styler=e,this):this.node_styler}style_edges(e){return arguments.length?(this.edge_styler=e.bind(this),this):this.edge_styler}itemSelected(e,n){return e[n]||!1}show(){return this.svg.node()}}gA(wp.prototype,PF);gA(wp.prototype,kF);gA(wp.prototype,FF);gA(wp.prototype,HF);gA(wp.prototype,YF);gA(wp.prototype,vF);function KF(t,e,n){return this.nodes.sum(function(c){return c.value}).sort(t),this.display&&(this.display.update_layout(this.nodes),this.display.update()),this}function JF(t){var e;return t=t.map(function(n){return typeof n=="string"?n:n.data.name}),this.traverse_and_compute(function(n){n.children?n.parent?(n.data.mrca=s5(...n.descendants().map(c=>c.data.mrca)),!e&&n.data.mrca.length==t.length&&(e=n)):e||(e=n):n.data.mrca=a5([n.data.name],t)}),e}let Ou=class{constructor(t,e={}){this.newick_string="",this.nodes=[],this.links=[],this.parsed_tags=[],this.partitions=[],this.branch_length_accessor=Ev,this.branch_length=Ev,this.logger=e.logger||console,this.selection_attribute_name="selected";var n=e.type||void 0,c=[],g=this;if(h1(n))n in cy?c=cy[n](t,e):g.logger.error("type "+n+" not in registry! Available types are "+_u(cy));else if(sc(n))try{c=n(t,e)}catch{g.logger.error("Could not parse custom format!")}else t.name=="root"?c={json:t,error:null}:typeof t!="string"?c=t:t.contentType=="application/xml"?c=c5(t):(this.newick_string=t,c=Dg(t,e));if(!c.json)g.nodes=[];else{g.nodes=rp(c.json);let v={};g.nodes.each(S=>{S.data.annotation&&(v[S.data.annotation]=!0)}),g.parsed_tags=Object.keys(v)}return g.links=g.nodes.links(),this.hasBranchLengths()||(console.warn("Phylotree User Warning : NO BRANCH LENGTHS DETECTED, SETTING ALL LENGTHS TO 1"),this.setBranchLength(v=>1)),g}json(t){var e=0;this.traverse_and_compute(function(c){c.json_export_index=e++},t);var n=new Array(e);return e=0,this.traverse_and_compute(function(c){let g=DS(c);delete g.json_export_index,c.parent&&(g.parent=c.parent.json_export_index),c.children&&(g.children=yc(c.children,function(v){return v.json_export_index})),n[e++]=g},t),this.traverse_and_compute(function(c){delete c.json_export_index},t),JSON.stringify(n)}traverse_and_compute(t,e,n,c){e=e||"post-order";function g(a){dp(a)||h5(a,t,c)}function v(a){K9(a,t,c)}function S(a){J9(a,t,c)}return e=="pre-order"?e=v:e=="in-order"?e=S:e=g,e(n||this.nodes),this}get_parsed_tags(){return this.parsed_tags}update(t){this.nodes=t}render(t){return this.display=new wp(this,t),this.display}};Ou.prototype.isLeafNode=Cl;Ou.prototype.selectAllDescendants=l5;Ou.prototype.mrca=JF;Ou.prototype.hasBranchLengths=tF;Ou.prototype.getBranchLengths=iF;Ou.prototype.branchName=aF;Ou.prototype.normalizeBranchLengths=rF;Ou.prototype.scaleBranchLengths=sF;Ou.prototype.getNewick=H9;Ou.prototype.resortChildren=KF;Ou.prototype.setBranchLength=nF;Ou.prototype.maxParsimony=X9;Ou.prototype.getTipLengths=$9;Ou.prototype.leftChildRightSibling=eF;gA(Ou.prototype,q9);gA(Ou.prototype,cF);gA(Ou.prototype,Q9);rS("%Y%m%d");function lw(t){let e,n="Taxa found in this area";return{c(){e=Pn("h2"),e.textContent=n,this.h()},l(c){e=Dn(c,"H2",{class:!0,"data-svelte-h":!0}),$u(e)!=="svelte-bg4wlc"&&(e.textContent=n),this.h()},h(){_i(e,"class","svelte-13bxzks")},m(c,g){yn(c,e,g)},d(c){c&&Ai(e)}}}function eO(t){let e,n,c,g,v,S,a,N,$=t[0]&&lw();return{c(){e=Pn("div"),$&&$.c(),n=_r(),c=Pn("div"),g=Pn("div"),v=Pn("span"),S=Fs(t[5]),this.h()},l(he){e=Dn(he,"DIV",{class:!0});var oe=rn(e);$&&$.l(oe),n=yr(oe),c=Dn(oe,"DIV",{id:!0,class:!0});var ce=rn(c);g=Dn(ce,"DIV",{class:!0,style:!0});var _e=rn(g);v=Dn(_e,"SPAN",{class:!0});var Ze=rn(v);S=Os(Ze,t[5]),Ze.forEach(Ai),_e.forEach(Ai),ce.forEach(Ai),oe.forEach(Ai),this.h()},h(){_i(v,"class","svelte-13bxzks"),_i(g,"class",a=op(`tree_tooltip ${t[4]?"shown":"hidden"} ${t[6]?"flip":""}`)+" svelte-13bxzks"),_i(g,"style",N=`margin-top: calc(${t[3]}px - 2rem); left: ${t[2]}px;`),_i(c,"id","tree_container"),_i(c,"class","svelte-13bxzks"),_i(e,"class","phylo-container svelte-13bxzks")},m(he,oe){yn(he,e,oe),$&&$.m(e,null),Bi(e,n),Bi(e,c),Bi(c,g),Bi(g,v),Bi(v,S),t[13](c)},p(he,[oe]){he[0]?$||($=lw(),$.c(),$.m(e,n)):$&&($.d(1),$=null),oe&32&&El(S,he[5]),oe&80&&a!==(a=op(`tree_tooltip ${he[4]?"shown":"hidden"} ${he[6]?"flip":""}`)+" svelte-13bxzks")&&_i(g,"class",a),oe&12&&N!==(N=`margin-top: calc(${he[3]}px - 2rem); left: ${he[2]}px;`)&&_i(g,"style",N)},i:Ra,o:Ra,d(he){he&&Ai(e),$&&$.d(),t[13](null)}}}let rg=1e3,hy=1e3;function y5(t){var n,c;if(!((n=t==null?void 0:t.target)!=null&&n.parent))return;let e=(c=t==null?void 0:t.target)==null?void 0:c.parent;return y5(e)}function tO(t,e,n){let c;Il(t,ip,xt=>n(12,c=xt));let{newick:g}=e,{present:v}=e,{hex_id:S}=e,{clade:a}=e,{header:N=!0}=e,$,he,oe,ce,_e=!1,Ze="",nt=!1;function Ke(xt){console.log("attempting rerender"),console.log(c),console.log($,xt);let zt="(((((((((((Tyrannus_verticalis:4.001433,(Tyrannus_tyrannus:3.53811,Tyrannus_vociferans:3.53811):0.463323):2.959154,(Myiarchus_cinerascens:2.014245,Myiarchus_tyrannulus:2.014245):4.946342):1.597191,((((Empidonax_difficilis:4.450615,((((Empidonax_oberholseri:2.161306,Empidonax_hammondii:2.161306):0.842122,Empidonax_minimus:3.003428):0.213631,Empidonax_wrightii:3.217059):0.929523,Empidonax_traillii:4.146582):0.304032):0.148682,(Contopus_sordidulus:3.526572,Contopus_cooperi:3.526571):1.072725):0.325545,(Sayornis_saya:3.781439,Sayornis_nigricans:3.781439):1.143402):3.069996,Pyrocephalus_rubinus:7.994837):0.56294):19.243085,(((((Chamaea_fasciata:12.429713,((((Riparia_riparia:6.967223,(Tachycineta_thalassina:4.679356,Tachycineta_bicolor:4.679355):2.287867):0.197341,(Stelgidopteryx_serripennis:6.278306,Progne_subis:6.278307):0.886257):0.999496,(Petrochelidon_pyrrhonota:7.596176,Hirundo_rustica:7.596175):0.567883):3.908347,Psaltriparus_minimus:12.072407):0.357305):3.198033,Eremophila_alpestris:15.627745):0.954938,(((Poecile_rufescens:3.381344,(Poecile_gambeli:2.366328,Poecile_atricapillus:2.366328):1.015016):2.5912,(Baeolophus_inornatus:1.885773,Baeolophus_ridgwayi:1.885773):4.086771):6.604761,Auriparus_flaviceps:12.577305):4.005378):1.204803,(((((Cinclus_mexicanus:14.257735,((Turdus_migratorius:9.645123,((Catharus_guttatus:5.110876,Catharus_ustulatus:5.110876):3.731149,Ixoreus_naevius:8.842026):0.803098):2.400322,(Myadestes_townsendi:11.383646,(Sialia_currucoides:3.141333,Sialia_mexicana:3.141332):8.242315):0.661799):2.21229):0.472993,(Sturnus_vulgaris:11.154101,((Mimus_polyglottos:5.122579,Oreoscoptes_montanus:5.12258):1.517727,(Toxostoma_bendirei:4.640856,((Toxostoma_lecontei:2.747447,Toxostoma_crissale:2.747447):0.857103,Toxostoma_redivivum:3.60455):1.036307):1.999449):4.513794):3.576628):2.188836,((((((Campylorhynchus_brunneicapillus:6.585247,Thryomanes_bewickii:6.585247):0.601549,(Troglodytes_aedon:5.644158,Cistothorus_palustris:5.644159):1.542638):0.934231,(Catherpes_mexicanus:6.20663,Salpinctes_obsoletus:6.20663):1.914396):3.05437,((Polioptila_californica:1.690149,Polioptila_melanura:1.690149):1.702386,Polioptila_caerulea:3.392536):7.782861):2.80982,Certhia_americana:13.985217):1.128942,((Sitta_canadensis:6.561379,Sitta_pygmaea:6.56138):1.810662,Sitta_carolinensis:8.37204):6.742118):1.805406):0.407621,(((Bombycilla_garrulus:3.757978,Bombycilla_cedrorum:3.757978):8.174507,Phainopepla_nitens:11.932485):4.887578,Regulus_satrapa:16.820063):0.507124):0.145318,(((((((((Passerina_caerulea:2.570987,Passerina_amoena:2.570987):1.680228,Passerina_cyanea:4.251215):2.855821,((Piranga_ludoviciana:4.343958,Piranga_rubra:4.343958):2.254702,Cardinalis_cardinalis:6.598661):0.508374):0.258533,Pheucticus_melanocephalus:7.365567):1.805195,(((((((Euphagus_cyanocephalus:4.083924,(Molothrus_aeneus:1.212313,Molothrus_ater:1.212313):2.871611):0.187559,(Agelaius_phoeniceus:3.000792,Agelaius_tricolor:3.000792):1.270691):2.148377,(Icterus_cucullatus:4.501935,(Icterus_parisorum:3.486088,Icterus_galbula:3.486089):1.015845):1.917926):0.524545,(Sturnella_neglecta:6.36353,Xanthocephalus_xanthocephalus:6.36353):0.580875):0.481912,Icteria_virens:7.426317):0.371308,((((((((Setophaga_townsendi:0.205227,Setophaga_occidentalis:0.205227):0.950551,Setophaga_nigrescens:1.155778):0.925938,(Setophaga_coronata:1.835635,Setophaga_palmarum:1.835635):0.246081):0.150194,Setophaga_petechia:2.231909):0.420317,Setophaga_ruticilla:2.652226):1.343903,(Cardellina_rubrifrons:2.573805,Cardellina_pusilla:2.573805):1.422325):0.307199,(Geothlypis_trichas:3.17745,Geothlypis_tolmiei:3.17745):1.125879):0.24755,(Parkesia_noveboracensis:3.921106,Mniotilta_varia:3.921106):0.629773):3.246746):0.860785,((Ammodramus_savannarum:7.22603,((Spizella_atrogularis:3.327185,(Spizella_breweri:2.319898,Spizella_passerina:2.319898):1.007287):3.419478,((Calamospiza_melanocorys:5.462612,Amphispiza_bilineata:5.462613):0.473245,Chondestes_grammacus:5.935857):0.810805):0.479369):0.284235,(((Pooecetes_gramineus:4.482169,(((Melospiza_lincolnii:1.264886,Melospiza_georgiana:1.264886):0.837596,Melospiza_melodia:2.102483):1.773568,Passerculus_sandwichensis:3.876051):0.606118):1.04583,((Pipilo_maculatus:2.033152,Pipilo_chlorurus:2.033153):2.918452,((Melozone_aberti:0.89701,Melozone_crissalis:0.89701):3.214586,Aimophila_ruficeps:4.111597):0.840007):0.576396):0.208553,(Junco_hyemalis:4.32944,(Zonotrichia_albicollis:1.482363,(Zonotrichia_atricapilla:0.331305,Zonotrichia_leucophrys:0.331305):1.151058):2.847076):1.407113):1.773713):1.148145):0.512351):0.561069,Calcarius_lapponicus:9.731831):1.359019,(((Spinus_pinus:3.142395,(Spinus_tristis:2.540467,(Spinus_psaltria:1.162173,Spinus_lawrencei:1.162173):1.378294):0.601928):1.6301,(Loxia_leucoptera:1.210478,Loxia_curvirostra:1.210477):3.562017):2.7703,(Leucosticte_tephrocotis:6.423852,Pinicola_enucleator:6.423852):1.11894):3.548056):0.547327,(Anthus_rubescens:5.935911,Anthus_spragueii:5.935912):5.702265):0.415079,Passer_domesticus:12.053257):5.419249):0.314981):2.469957,((Vireo_gilvus:3.302798,(((Vireo_cassinii:0.402464,Vireo_plumbeus:0.402464):1.942187,(Vireo_vicinior:2.056349,Vireo_huttoni:2.056349):0.288302):0.466454,Vireo_bellii:2.811106):0.491692):12.019837,(Lanius_ludovicianus:11.409307,(((((Corvus_corax:4.701119,Corvus_brachyrhynchos:4.701119):1.990164,Nucifraga_columbiana:6.691283):1.298672,Pica_hudsonia:7.989953):0.514906,((Gymnorhinus_cyanocephalus:6.126222,Aphelocoma_californica:6.126222):0.683341,Cyanocitta_stelleri:6.809564):1.695297):0.40107,Perisoreus_canadensis:8.905929):2.503378):3.913326):4.934811):7.543419):10.368133,(Brotogeris_chiriri:10.109007,(Amazona_finschi:1.862114,Amazona_viridigenalis:1.862114):8.246892):28.059987):0.875789,((Falco_mexicanus:3.250519,Falco_peregrinus:3.250519):1.551005,(Falco_columbarius:4.340078,Falco_sparverius:4.340078):0.461445):34.243259):18.167212,(((((((Sphyrapicus_ruber:0.691321,Sphyrapicus_nuchalis:0.691321):4.673796,Sphyrapicus_thyroideus:5.365118):3.383365,(Melanerpes_uropygialis:7.684308,(Melanerpes_formicivorus:7.035306,Melanerpes_lewis:7.035306):0.649002):1.064176):0.729339,Picoides_arcticus:9.477822):26.111884,Megaceryle_alcyon:35.589708):21.232651,(((((Megascops_kennicottii:9.535534,Bubo_virginianus:9.535534):0.399666,(Strix_nebulosa:8.157754,(Strix_varia:6.649511,Strix_occidentalis:6.649511):1.508244):1.777446):0.688896,(Asio_otus:6.154249,Asio_flammeus:6.154249):4.469847):2.862398,(((Glaucidium_gnoma:10.483593,Athene_cunicularia:10.483593):0.73703,Aegolius_acadicus:11.220624):0.978771,Micrathene_whitneyi:12.199394):1.2871):8.747286,Tyto_alba:22.233781):34.588578):0.214221,((((Aquila_chrysaetos:7.964539,((((((Buteo_swainsoni:1.391803,(Buteo_albonotatus:1.258194,(Buteo_regalis:0.408815,Buteo_lagopus:0.408815):0.84938):0.13361):0.246285,Buteo_jamaicensis:1.638089):0.602243,Buteo_lineatus:2.240332):1.894991,Parabuteo_unicinctus:4.135322):2.246454,Haliaeetus_leucocephalus:6.381778):0.568816,(Accipiter_striatus:5.309671,Accipiter_cooperii:5.30967):1.640922):1.013948):2.988594,Elanus_leucurus:10.953135):1.124614,Pandion_haliaetus:12.07775):4.511346,((Coragyps_atratus:3.554197,Gymnogyps_californianus:3.554197):2.188988,Cathartes_aura:5.743185):10.84591):40.447484):0.175416):0.552342,(((((((((((Calidris_bairdii:4.228354,Calidris_melanotos:4.228355):0.721063,Calidris_mauri:4.949417):0.597188,(Calidris_alba:4.799257,Calidris_minutilla:4.799257):0.747348):0.928535,(Calidris_ptilocnemis:4.342482,Calidris_alpina:4.342482):2.132658):1.149079,Calidris_canutus:7.62422):3.509313,(Arenaria_interpres:3.533248,Arenaria_melanocephala:3.533248):7.600284):1.234303,((Gallinago_delicata:10.711284,(Limnodromus_griseus:5.529963,Limnodromus_scolopaceus:5.529963):5.181322):1.375692,(((Tringa_solitaria:7.846535,((Tringa_melanoleuca:6.221306,(Tringa_flavipes:5.250045,Tringa_semipalmata:5.250045):0.971262):0.372349,Tringa_incana:6.593656):1.252879):2.273961,Phalaropus_fulicarius:10.120496):0.508933,Actitis_macularius:10.629429):1.457548):0.280858):0.808214,Limosa_fedoa:13.176049):0.875709,(Numenius_americanus:7.01717,Numenius_phaeopus:7.01717):7.034588):7.503049,((((((Chlidonias_niger:4.717037,((Sterna_hirundo:3.62124,Sterna_forsteri:3.62124):0.268369,(Thalasseus_elegans:1.230911,Thalasseus_maximus:1.230912):2.658698):0.827428):0.955816,(Gelochelidon_nilotica:4.350884,Hydroprogne_caspia:4.350884):1.321968):1.505717,Sternula_antillarum:7.178569):4.533572,Rynchops_niger:11.712141):0.654253,(((((((Larus_hyperboreus:0.185546,Larus_glaucoides:0.185546):0.003055,Larus_glaucescens:0.188601):0.263007,Larus_californicus:0.451609):0.374466,Larus_occidentalis:0.826074):0.18028,Larus_delawarensis:1.006355):0.196994,Larus_heermanni:1.203348):3.257797,(Xema_sabini:3.479007,Rissa_tridactyla:3.479007):0.982139):7.905248):0.839622,((((Cerorhinca_monocerata:4.962971,Fratercula_cirrhata:4.962971):4.069719,Ptychoramphus_aleuticus:9.03269):0.727745,(((Uria_aalge:7.923653,(Synthliboramphus_antiquus:3.720373,(Synthliboramphus_hypoleucus:0.671056,Synthliboramphus_craveri:0.671056):3.049317):4.20328):0.407386,Cepphus_columba:8.331039):0.426139,Brachyramphus_marmoratus:8.757178):1.003257):1.771281,Stercorarius_pomarinus:11.531716):1.6743):8.348792):1.743606,(((Charadrius_montanus:9.995173,(Charadrius_semipalmatus:6.536113,Charadrius_vociferus:6.536113):3.45906):1.702327,Recurvirostra_americana:11.697501):0.798071,((Pluvialis_fulva:2.455897,Pluvialis_dominica:2.455897):1.178289,Pluvialis_squatarola:3.634185):8.861386):10.802842):34.465924):0.473736,((((Columbina_inca:3.404918,Columbina_passerina:3.404918):8.482142,((Zenaida_asiatica:6.129893,Zenaida_macroura:6.129893):3.814154,Patagioenas_fasciata:9.944047):1.943014):22.893088,(Podilymbus_podiceps:7.533322,(((Podiceps_auritus:3.080437,Podiceps_grisegena:3.080437):1.451611,Podiceps_nigricollis:4.532048):0.835204,(Aechmophorus_clarkii:0.649792,Aechmophorus_occidentalis:0.649792):4.71746):2.166071):27.246826):0.63047,(((Cypseloides_niger:10.552193,(Aeronautes_saxatalis:7.70865,Chaetura_vauxi:7.708649):2.843543):21.460899,(Archilochus_alexandri:4.492772,(((Selasphorus_sasin:1.25153,(Selasphorus_calliope:0.828849,Selasphorus_rufus:0.828849):0.422681):0.256848,Selasphorus_platycercus:1.508378):0.915832,(Calypte_anna:1.752307,Calypte_costae:1.752307):0.671904):2.068562):27.52032):2.173856,(Phalaenoptilus_nuttallii:9.381208,(Chordeiles_acutipennis:4.827009,Chordeiles_minor:4.827009):4.554198):24.805739):1.223671):22.827456):3.416457,(((((((((Botaurus_lentiginosus:7.844435,Ixobrychus_exilis:7.844434):4.109641,((((Bubulcus_ibis:5.166884,Ardea_alba:5.166884):0.893851,Ardea_herodias:6.060735):2.772452,Nycticorax_nycticorax:8.833187):0.574409,(Egretta_caerulea:4.018093,Egretta_thula:4.018093):5.389502):2.546481):12.342126,(Pelecanus_erythrorhynchos:4.196515,Pelecanus_occidentalis:4.196516):20.099686):1.029739,Plegadis_chihi:25.325942):23.512005,Fregata_magnificens:48.837946):1.031774,Mycteria_americana:49.869719):10.866735,(((Pterodroma_cookii:8.933823,Puffinus_opisthomelas:8.933826):0.331096,Fulmarus_glacialis:9.26492):3.849296,((Phoebastria_immutabilis:1.85668,Phoebastria_nigripes:1.85668):0.562903,Phoebastria_albatrus:2.419582):10.694634):47.622239):0.137649,((Gavia_immer:1.471913,Gavia_pacifica:1.471913):4.785063,Gavia_stellata:6.256976):54.617128):0.372954,((Coccyzus_americanus:20.634502,Geococcyx_californianus:20.634503):10.43379,(((Fulica_americana:5.83685,Gallinula_galeata:5.836849):3.314091,Porzana_carolina:9.15094):2.511697,(Laterallus_jamaicensis:11.336317,Rallus_limicola:11.336317):0.32632):19.405654):30.178765):0.407474):2.979476,((((((Anas_platyrhynchos:3.223317,Anas_acuta:3.223318):2.598536,((Aythya_marila:0.342269,Aythya_affinis:0.342269):1.154018,((Aythya_americana:0.805757,Aythya_collaris:0.805757):0.461603,Aythya_valisineria:1.26736):0.228926):4.325566):1.213051,(Aix_sponsa:6.70241,((((Bucephala_albeola:3.701376,(Bucephala_clangula:1.11771,Bucephala_islandica:1.11771):2.583666):1.514894,((Mergus_merganser:1.873201,Mergus_serrator:1.873201):1.916388,Lophodytes_cucullatus:3.789589):1.426681):0.502879,Melanitta_perspicillata:5.719149):0.771899,Histrionicus_histrionicus:6.491048):0.211362):0.332494):2.655406,(((((Branta_hutchinsii:0.999185,Branta_canadensis:0.999184):2.080501,Branta_bernicla:3.079685):1.059406,Anser_albifrons:4.13909):2.225437,(Cygnus_columbianus:0.874443,Cygnus_buccinator:0.874443):5.490085):2.888657,Oxyura_jamaicensis:9.253185):0.437126):3.174907,Dendrocygna_bicolor:12.865217):41.141001,((((((Lagopus_leucura:4.060241,Centrocercus_urophasianus:4.06024):1.450073,Bonasa_umbellus:5.510314):1.796859,Meleagris_gallopavo:7.307173):0.657843,Phasianus_colchicus:7.965017):3.942481,Alectoris_chukar:11.907496):3.85599,((Callipepla_californica:0.906981,Callipepla_gambelii:0.906981):6.06878,Oreortyx_pictus:6.975761):8.787725):38.242733):10.627788);",Mt=new Ou(zt),Ue=Mt.render({height:hy,width:rg,"left-right-spacing":"fit-to-size","top-bottom-spacing":"fit-to-size","is-radial":!0,brush:!1,collapsible:!1,selectable:!1,reroot:!1,hide:!1,container:"#tree_container"});if(console.log(Ue),console.log(Mt.display),console.log(he),console.log(xt),!he||!xt){Ue.update();return}let $t=[];Ue.style_edges(function(gt,At){var yt;he&&((yt=he[xt])!=null&&yt.includes(At.target.data.name))&&(gt.style("stroke",ym()[500]),gt.style("stroke-width","2px"),$t.push(y5(At)))}),console.log($t),Ue.update();let rt=Mt.display.show();rt.querySelectorAll(".node-circle").forEach(gt=>gt.attr("r",0));for(let gt of he[xt]){let At=rt.querySelector(`[data-node-name="${gt}"]`);At&&(At.firstChild,l_(At).append("circle").classed("node-circle",!0).attr("r",3).attr("title",gt).style("fill",ym()[500]))}for(let gt of Mt.getNodes())console.log(gt);rt.setAttribute("width",rg),rt.setAttribute("height",hy),rt.setAttribute("viewBox",`${rg/16} ${rg/16} ${rg/3.3} ${hy/3.3}`),console.log(rt),$.appendChild(rt),console.log($.querySelectorAll(".node-circle")),$.querySelectorAll(".node-circle").forEach(gt=>{gt.addEventListener("mouseover",At=>{document.querySelector("#tree_container").clientWidth,n(6,nt=!1);let yt=document.querySelector(".tree_tooltip").clientWidth;window.innerWidth-At.screenX<yt+0&&n(6,nt=!0),n(4,_e=!0),n(5,Ze=At.target.attributes.title.value)}),gt.addEventListener("mouseout",At=>{n(4,_e=!1)})}),rt.addEventListener("mousemove",gt=>{gt.target.localName==="svg"&&(n(2,oe=gt.layerX),n(3,ce=gt.layerY))})}async function st(xt){return fetch(`/phast/data/${xt}_hex_species.json`).then(zt=>zt.json()).then(zt=>(n(11,he=JSON.parse(zt[0])),he))}wc(async()=>{st(a).then(xt=>Ke(S)).then(()=>console.log("built node map"))});function ht(xt){ta[xt?"unshift":"push"](()=>{$=xt,n(1,$)})}return t.$$set=xt=>{"newick"in xt&&n(7,g=xt.newick),"present"in xt&&n(8,v=xt.present),"hex_id"in xt&&n(9,S=xt.hex_id),"clade"in xt&&n(10,a=xt.clade),"header"in xt&&n(0,N=xt.header)},t.$$.update=()=>{t.$$.dirty&4096&&c&&Ke(c.hex),t.$$.dirty&2304&&v&&!he&&st(v)},[N,$,oe,ce,_e,Ze,nt,g,v,S,a,he,c,ht]}class v5 extends Ha{constructor(e){super(),ja(this,e,tO,eO,Ca,{newick:7,present:8,hex_id:9,clade:10,header:0})}}function uw(t){let e;return{c(){e=Pn("div"),this.h()},l(n){e=Dn(n,"DIV",{class:!0}),rn(e).forEach(Ai),this.h()},h(){_i(e,"class","mdc-button__touch")},m(n,c){yn(n,e,c)},d(n){n&&Ai(e)}}}function iO(t){let e,n,c,g;const v=t[28].default,S=Zl(v,t,t[30],null);let a=t[6]&&uw();return{c(){e=Pn("div"),n=_r(),S&&S.c(),a&&a.c(),c=Zr(),this.h()},l(N){e=Dn(N,"DIV",{class:!0}),rn(e).forEach(Ai),n=yr(N),S&&S.l(N),a&&a.l(N),c=Zr(),this.h()},h(){_i(e,"class","mdc-button__ripple")},m(N,$){yn(N,e,$),yn(N,n,$),S&&S.m(N,$),a&&a.m(N,$),yn(N,c,$),g=!0},p(N,$){S&&S.p&&(!g||$[0]&1073741824)&&Ql(S,v,N,N[30],g?$l(v,N[30],$,null):Wl(N[30]),null),N[6]?a||(a=uw(),a.c(),a.m(c.parentNode,c)):a&&(a.d(1),a=null)},i(N){g||(Fi(S,N),g=!0)},o(N){Xi(S,N),g=!1},d(N){N&&(Ai(e),Ai(n),Ai(c)),S&&S.d(N),a&&a.d(N)}}}function nO(t){let e,n,c;const g=[{tag:t[10]},{use:[[tp,{ripple:t[3],unbounded:!1,color:t[4],disabled:!!t[23].disabled,addClass:t[19],removeClass:t[20],addStyle:t[21]}],t[17],...t[0]]},{class:Ps({[t[1]]:!0,"mdc-button":!0,"mdc-button--raised":t[5]==="raised","mdc-button--unelevated":t[5]==="unelevated","mdc-button--outlined":t[5]==="outlined","smui-button--color-secondary":t[4]==="secondary","mdc-button--touch":t[6],"mdc-card__action":t[18]==="card:action","mdc-card__action--button":t[18]==="card:action","mdc-dialog__button":t[18]==="dialog:action","mdc-top-app-bar__navigation-icon":t[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":t[18]==="top-app-bar:action","mdc-snackbar__action":t[18]==="snackbar:actions","mdc-banner__secondary-action":t[18]==="banner"&&t[8],"mdc-banner__primary-action":t[18]==="banner"&&!t[8],"mdc-tooltip__action":t[18]==="tooltip:rich-actions",...t[12]})},{style:Object.entries(t[13]).map(Ay).concat([t[2]]).join(" ")},t[16],t[15],t[14],{href:t[7]},t[23]];var v=t[9];function S(a,N){let $={$$slots:{default:[iO]},$$scope:{ctx:a}};if(N!==void 0&&N[0]&12580351)$=xa(g,[N[0]&1024&&{tag:a[10]},N[0]&12189721&&{use:[[tp,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},N[0]&266610&&{class:Ps({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},N[0]&8196&&{style:Object.entries(a[13]).map(Ay).concat([a[2]]).join(" ")},N[0]&65536&&qs(a[16]),N[0]&32768&&qs(a[15]),N[0]&16384&&qs(a[14]),N[0]&128&&{href:a[7]},N[0]&8388608&&qs(a[23])]);else for(let he=0;he<g.length;he+=1)$=xr($,g[he]);return{props:$}}return v&&(e=af(v,S(t)),t[29](e),e.$on("click",t[22])),{c(){e&&Cr(e.$$.fragment),n=Zr()},l(a){e&&Rr(e.$$.fragment,a),n=Zr()},m(a,N){e&&Tr(e,a,N),yn(a,n,N),c=!0},p(a,N){if(N[0]&512&&v!==(v=a[9])){if(e){Ba();const $=e;Xi($.$$.fragment,1,0,()=>{kr($,1)}),za()}v?(e=af(v,S(a,N)),a[29](e),e.$on("click",a[22]),Cr(e.$$.fragment),Fi(e.$$.fragment,1),Tr(e,n.parentNode,n)):e=null}else if(v){const $=N[0]&12580351?xa(g,[N[0]&1024&&{tag:a[10]},N[0]&12189721&&{use:[[tp,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},N[0]&266610&&{class:Ps({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},N[0]&8196&&{style:Object.entries(a[13]).map(Ay).concat([a[2]]).join(" ")},N[0]&65536&&qs(a[16]),N[0]&32768&&qs(a[15]),N[0]&16384&&qs(a[14]),N[0]&128&&{href:a[7]},N[0]&8388608&&qs(a[23])]):{};N[0]&1073741888&&($.$$scope={dirty:N,ctx:a}),e.$set($)}},i(a){c||(e&&Fi(e.$$.fragment,a),c=!0)},o(a){e&&Xi(e.$$.fragment,a),c=!1},d(a){a&&Ai(n),t[29](null),e&&kr(e,a)}}}const Ay=([t,e])=>`${t}: ${e};`;function rO(t,e,n){let c,g,v;const S=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let a=_o(e,S),{$$slots:N={},$$scope:$}=e;const he=Ec(bc());let{use:oe=[]}=e,{class:ce=""}=e,{style:_e=""}=e,{ripple:Ze=!0}=e,{color:nt="primary"}=e,{variant:Ke="text"}=e,{touch:st=!1}=e,{href:ht=void 0}=e,{action:xt="close"}=e,{defaultAction:zt=!1}=e,{secondary:Mt=!1}=e,Ue,$t={},rt={},gt=Mu("SMUI:button:context"),{component:At=lf}=e,{tag:yt=At===lf?ht==null?"button":"a":void 0}=e,St=a.disabled;mu("SMUI:label:context","button"),mu("SMUI:icon:context","button");function ut(Vt){$t[Vt]||n(12,$t[Vt]=!0,$t)}function Ye(Vt){(!(Vt in $t)||$t[Vt])&&n(12,$t[Vt]=!1,$t)}function _t(Vt,yi){rt[Vt]!=yi&&(yi===""||yi==null?(delete rt[Vt],n(13,rt)):n(13,rt[Vt]=yi,rt))}function ct(){gt==="banner"&&lu(Ut(),Mt?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function Ut(){return Ue.getElement()}function Ft(Vt){ta[Vt?"unshift":"push"](()=>{Ue=Vt,n(11,Ue)})}return t.$$set=Vt=>{n(31,e=xr(xr({},e),rc(Vt))),n(23,a=_o(e,S)),"use"in Vt&&n(0,oe=Vt.use),"class"in Vt&&n(1,ce=Vt.class),"style"in Vt&&n(2,_e=Vt.style),"ripple"in Vt&&n(3,Ze=Vt.ripple),"color"in Vt&&n(4,nt=Vt.color),"variant"in Vt&&n(5,Ke=Vt.variant),"touch"in Vt&&n(6,st=Vt.touch),"href"in Vt&&n(7,ht=Vt.href),"action"in Vt&&n(24,xt=Vt.action),"defaultAction"in Vt&&n(25,zt=Vt.defaultAction),"secondary"in Vt&&n(8,Mt=Vt.secondary),"component"in Vt&&n(9,At=Vt.component),"tag"in Vt&&n(10,yt=Vt.tag),"$$scope"in Vt&&n(30,$=Vt.$$scope)},t.$$.update=()=>{if(n(16,c=gt==="dialog:action"&&xt!=null?{"data-mdc-dialog-action":xt}:{action:e.action}),n(15,g=gt==="dialog:action"&&zt?{"data-mdc-dialog-button-default":""}:{default:e.default}),n(14,v=gt==="banner"?{}:{secondary:e.secondary}),St!==a.disabled){const Vt=Ut();"blur"in Vt&&Vt.blur(),n(27,St=a.disabled)}},e=rc(e),[oe,ce,_e,Ze,nt,Ke,st,ht,Mt,At,yt,Ue,$t,rt,v,g,c,he,gt,ut,Ye,_t,ct,a,xt,zt,Ut,St,N,Ft,$]}class sO extends Ha{constructor(e){super(),ja(this,e,rO,nO,Ca,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}function aO(t){let e,n,c;const g=t[2].default,v=Zl(g,t,t[1],null);return{c(){e=Pn("div"),v&&v.c(),this.h()},l(S){e=Dn(S,"DIV",{class:!0});var a=rn(e);v&&v.l(a),a.forEach(Ai),this.h()},h(){_i(e,"class",n="s-app theme--"+t[0])},m(S,a){yn(S,e,a),v&&v.m(e,null),c=!0},p(S,[a]){v&&v.p&&(!c||a&2)&&Ql(v,g,S,S[1],c?$l(g,S[1],a,null):Wl(S[1]),null),(!c||a&1&&n!==(n="s-app theme--"+S[0]))&&_i(e,"class",n)},i(S){c||(Fi(v,S),c=!0)},o(S){Xi(v,S),c=!1},d(S){S&&Ai(e),v&&v.d(S)}}}function oO(t,e,n){let{$$slots:c={},$$scope:g}=e,{theme:v="light"}=e;return t.$$set=S=>{"theme"in S&&n(0,v=S.theme),"$$scope"in S&&n(1,g=S.$$scope)},[v,g,c]}class lO extends Ha{constructor(e){super(),ja(this,e,oO,aO,Ca,{theme:0})}}function uO(t){return t.split(" ").map(e=>/^(lighten|darken|accent)-/.test(e)?`text-${e}`:`${e}-text`)}function cw(t,e){if(/^(#|rgb|hsl|currentColor)/.test(e))return t.style.color=e,!1;if(e.startsWith("--"))return t.style.color=`var(${e})`,!1;const n=uO(e);return t.classList.add(...n),n}const cO=(t,e)=>{let n;return typeof e=="string"&&(n=cw(t,e)),{update(c){n?t.classList.remove(...n):t.style.color=null,typeof c=="string"&&(n=cw(t,c))}}};let hw=36,hO="";for(;hw--;)hO+=hw.toString(36);function Aw(t){let e,n=[{class:"underlay"},t[9],{"stroke-dashoffset":"0"}],c={};for(let g=0;g<n.length;g+=1)c=xr(c,n[g]);return{c(){e=ws("circle"),this.h()},l(g){e=Ss(g,"circle",{class:!0,"stroke-dashoffset":!0}),rn(e).forEach(Ai),this.h()},h(){v_(e,c),am(e,"svelte-kiaiot",!0)},m(g,v){yn(g,e,v)},p(g,v){am(e,"svelte-kiaiot",!0)},d(g){g&&Ai(e)}}}function AO(t){let e,n,c,g,v,S,a,N,$,he,oe,ce=!t[1]&&Aw(t),_e=[{class:"overlay"},t[9],{"stroke-dashoffset":t[8]}],Ze={};for(let st=0;st<_e.length;st+=1)Ze=xr(Ze,_e[st]);const nt=t[12].default,Ke=Zl(nt,t,t[11],null);return{c(){e=Pn("div"),n=ws("svg"),ce&&ce.c(),c=ws("circle"),g=_r(),v=Pn("div"),Ke&&Ke.c(),this.h()},l(st){e=Dn(st,"DIV",{role:!0,"aria-valuemin":!0,"aria-valuemax":!0,"aria-valuenow":!0,class:!0,style:!0});var ht=rn(e);n=Ss(ht,"svg",{xmlns:!0,viewBox:!0,style:!0,class:!0});var xt=rn(n);ce&&ce.l(xt),c=Ss(xt,"circle",{class:!0,"stroke-dashoffset":!0}),rn(c).forEach(Ai),xt.forEach(Ai),g=yr(ht),v=Dn(ht,"DIV",{class:!0});var zt=rn(v);Ke&&Ke.l(zt),zt.forEach(Ai),ht.forEach(Ai),this.h()},h(){v_(c,Ze),am(c,"svelte-kiaiot",!0),_i(n,"xmlns","http://www.w3.org/2000/svg"),_i(n,"viewBox",t[7]+`
    `+t[7]+`
    `+2*t[7]+`
    `+2*t[7]),Fy(n,"transform","rotate("+t[3]+"deg)"),_i(n,"class","svelte-kiaiot"),_i(v,"class","s-progress-circular__content svelte-kiaiot"),_i(e,"role","progressbar"),_i(e,"aria-valuemin","0"),_i(e,"aria-valuemax","100"),_i(e,"aria-valuenow",t[5]),_i(e,"class",S="s-progress-circular "+t[0]+" svelte-kiaiot"),_i(e,"style",a="width:"+t[4]+"px;height:"+t[4]+"px;"+t[6]),am(e,"indeterminate",t[1])},m(st,ht){yn(st,e,ht),Bi(e,n),ce&&ce.m(n,null),Bi(n,c),Bi(e,g),Bi(e,v),Ke&&Ke.m(v,null),$=!0,he||(oe=To(N=cO.call(null,e,t[2])),he=!0)},p(st,[ht]){st[1]?ce&&(ce.d(1),ce=null):ce?ce.p(st,ht):(ce=Aw(st),ce.c(),ce.m(n,c)),am(c,"svelte-kiaiot",!0),(!$||ht&8)&&Fy(n,"transform","rotate("+st[3]+"deg)"),Ke&&Ke.p&&(!$||ht&2048)&&Ql(Ke,nt,st,st[11],$?$l(nt,st[11],ht,null):Wl(st[11]),null),(!$||ht&32)&&_i(e,"aria-valuenow",st[5]),(!$||ht&1&&S!==(S="s-progress-circular "+st[0]+" svelte-kiaiot"))&&_i(e,"class",S),(!$||ht&80&&a!==(a="width:"+st[4]+"px;height:"+st[4]+"px;"+st[6]))&&_i(e,"style",a),N&&ku(N.update)&&ht&4&&N.update.call(null,st[2]),(!$||ht&3)&&am(e,"indeterminate",st[1])},i(st){$||(Fi(Ke,st),$=!0)},o(st){Xi(Ke,st),$=!1},d(st){st&&Ai(e),ce&&ce.d(),Ke&&Ke.d(st),he=!1,oe()}}}const fy=20;function fO(t,e,n){let{$$slots:c={},$$scope:g}=e,{class:v=""}=e,{indeterminate:S=!1}=e,{color:a="secondary"}=e,{rotate:N=0}=e,{size:$=32}=e,{value:he=0}=e,{width:oe=4}=e,{style:ce=""}=e;const _e=2*3.1416*fy,Ze=fy/(1-Number(oe)/+$),nt=Number(oe)/+$*Ze*2,Ke=(100-he)/100*_e,st={fill:"transparent",cx:2*Ze,cy:2*Ze,r:fy,"stroke-width":nt,"stroke-dasharray":_e};return t.$$set=ht=>{"class"in ht&&n(0,v=ht.class),"indeterminate"in ht&&n(1,S=ht.indeterminate),"color"in ht&&n(2,a=ht.color),"rotate"in ht&&n(3,N=ht.rotate),"size"in ht&&n(4,$=ht.size),"value"in ht&&n(5,he=ht.value),"width"in ht&&n(10,oe=ht.width),"style"in ht&&n(6,ce=ht.style),"$$scope"in ht&&n(11,g=ht.$$scope)},[v,S,a,N,$,he,ce,Ze,Ke,st,oe,g,c]}class dO extends Ha{constructor(e){super(),ja(this,e,fO,AO,Ca,{class:0,indeterminate:1,color:2,rotate:3,size:4,value:5,width:10,style:6})}}function pO(t){let e,n;return e=new dO({props:{size:50,indeterminate:!0,color:ym()[500]}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p:Ra,i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function fw(t){let e,n;return{c(){e=Pn("h3"),n=Fs(t[0]),this.h()},l(c){e=Dn(c,"H3",{class:!0});var g=rn(e);n=Os(g,t[0]),g.forEach(Ai),this.h()},h(){_i(e,"class","svelte-10jlhi")},m(c,g){yn(c,e,g),Bi(e,n)},p(c,g){g&1&&El(n,c[0])},d(c){c&&Ai(e)}}}function mO(t){let e,n,c,g;n=new lO({props:{$$slots:{default:[pO]},$$scope:{ctx:t}}});let v=t[0]&&fw(t);return{c(){e=Pn("div"),Cr(n.$$.fragment),c=_r(),v&&v.c(),this.h()},l(S){e=Dn(S,"DIV",{class:!0});var a=rn(e);Rr(n.$$.fragment,a),c=yr(a),v&&v.l(a),a.forEach(Ai),this.h()},h(){_i(e,"class","loading-container svelte-10jlhi")},m(S,a){yn(S,e,a),Tr(n,e,null),Bi(e,c),v&&v.m(e,null),g=!0},p(S,[a]){const N={};a&2&&(N.$$scope={dirty:a,ctx:S}),n.$set(N),S[0]?v?v.p(S,a):(v=fw(S),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i(S){g||(Fi(n.$$.fragment,S),g=!0)},o(S){Xi(n.$$.fragment,S),g=!1},d(S){S&&Ai(e),kr(n),v&&v.d()}}}function gO(t,e,n){let{message:c}=e;return t.$$set=g=>{"message"in g&&n(0,c=g.message)},[c]}class x5 extends Ha{constructor(e){super(),ja(this,e,gO,mO,Ca,{message:0})}}function dw(t,e,n){const c=t.slice();return c[16]=e[n],c}function pw(t,e,n){const c=t.slice();return c[16]=e[n],c}function mw(t,e,n){const c=t.slice();return c[16]=e[n],c}function _O(t){let e=t[16].name+"",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p(c,g){g&16&&e!==(e=c[16].name+"")&&El(n,e)},d(c){c&&Ai(n)}}}function gw(t){let e,n;return e=new d0({props:{value:t[16],$$slots:{default:[_O]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&16&&(v.value=c[16]),g&8388624&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function yO(t){let e,n,c=gu(t[4]),g=[];for(let S=0;S<c.length;S+=1)g[S]=gw(mw(t,c,S));const v=S=>Xi(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();e=Zr()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);e=Zr()},m(S,a){for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(S,a);yn(S,e,a),n=!0},p(S,a){if(a&16){c=gu(S[4]);let N;for(N=0;N<c.length;N+=1){const $=mw(S,c,N);g[N]?(g[N].p($,a),Fi(g[N],1)):(g[N]=gw($),g[N].c(),Fi(g[N],1),g[N].m(e.parentNode,e))}for(Ba(),N=c.length;N<g.length;N+=1)v(N);za()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Fi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)Xi(g[a]);n=!1},d(S){S&&Ai(e),dA(g,S)}}}function _w(t){var _e,Ze,nt,Ke,st,ht;let e,n,c,g=((Ze=(_e=t[0])==null?void 0:_e.next)==null?void 0:Ze.name)+"",v,S,a,N,$,he,oe=((Ke=(nt=t[0])==null?void 0:nt.next)==null?void 0:Ke.options.length)>0&&yw(t),ce=((ht=(st=t[0])==null?void 0:st.next)==null?void 0:ht.options.length)==0&&xw();return{c(){e=Pn("div"),n=Pn("h2"),c=Fs("Select which "),v=Fs(g),S=Fs(" to use"),a=_r(),oe&&oe.c(),N=_r(),ce&&ce.c(),this.h()},l(xt){e=Dn(xt,"DIV",{class:!0});var zt=rn(e);n=Dn(zt,"H2",{class:!0});var Mt=rn(n);c=Os(Mt,"Select which "),v=Os(Mt,g),S=Os(Mt," to use"),Mt.forEach(Ai),a=yr(zt),oe&&oe.l(zt),N=yr(zt),ce&&ce.l(zt),zt.forEach(Ai),this.h()},h(){var xt;_i(n,"class","svelte-wgfovm"),_i(e,"class",$=op(`step ${!((xt=t[0])!=null&&xt.next)||!t[3]&&"grayed"}`)+" svelte-wgfovm")},m(xt,zt){yn(xt,e,zt),Bi(e,n),Bi(n,c),Bi(n,v),Bi(n,S),Bi(e,a),oe&&oe.m(e,null),Bi(e,N),ce&&ce.m(e,null),he=!0},p(xt,zt){var Mt,Ue,$t,rt,gt,At,yt;(!he||zt&1)&&g!==(g=((Ue=(Mt=xt[0])==null?void 0:Mt.next)==null?void 0:Ue.name)+"")&&El(v,g),((rt=($t=xt[0])==null?void 0:$t.next)==null?void 0:rt.options.length)>0?oe?(oe.p(xt,zt),zt&1&&Fi(oe,1)):(oe=yw(xt),oe.c(),Fi(oe,1),oe.m(e,N)):oe&&(Ba(),Xi(oe,1,1,()=>{oe=null}),za()),((At=(gt=xt[0])==null?void 0:gt.next)==null?void 0:At.options.length)==0?ce?zt&1&&Fi(ce,1):(ce=xw(),ce.c(),Fi(ce,1),ce.m(e,null)):ce&&(Ba(),Xi(ce,1,1,()=>{ce=null}),za()),(!he||zt&9&&$!==($=op(`step ${!((yt=xt[0])!=null&&yt.next)||!xt[3]&&"grayed"}`)+" svelte-wgfovm"))&&_i(e,"class",$)},i(xt){he||(Fi(oe),Fi(ce),he=!0)},o(xt){Xi(oe),Xi(ce),he=!1},d(xt){xt&&Ai(e),oe&&oe.d(),ce&&ce.d()}}}function yw(t){let e,n,c;function g(S){t[10](S)}let v={class:"shaped",variant:"filled",$$slots:{default:[xO]},$$scope:{ctx:t}};return t[1]!==void 0&&(v.value=t[1]),e=new o0({props:v}),ta.push(()=>Vh(e,"value",g)),{c(){Cr(e.$$.fragment)},l(S){Rr(e.$$.fragment,S)},m(S,a){Tr(e,S,a),c=!0},p(S,a){const N={};a&8388609&&(N.$$scope={dirty:a,ctx:S}),!n&&a&2&&(n=!0,N.value=S[1],Nh(()=>n=!1)),e.$set(N)},i(S){c||(Fi(e.$$.fragment,S),c=!0)},o(S){Xi(e.$$.fragment,S),c=!1},d(S){kr(e,S)}}}function vO(t){let e=t[16].name+"",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p(c,g){g&1&&e!==(e=c[16].name+"")&&El(n,e)},d(c){c&&Ai(n)}}}function vw(t){let e,n;return e=new d0({props:{value:t[16],$$slots:{default:[vO]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&1&&(v.value=c[16]),g&8388609&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function xO(t){var S,a;let e,n,c=gu((a=(S=t[0])==null?void 0:S.next)==null?void 0:a.options),g=[];for(let N=0;N<c.length;N+=1)g[N]=vw(pw(t,c,N));const v=N=>Xi(g[N],1,1,()=>{g[N]=null});return{c(){for(let N=0;N<g.length;N+=1)g[N].c();e=Zr()},l(N){for(let $=0;$<g.length;$+=1)g[$].l(N);e=Zr()},m(N,$){for(let he=0;he<g.length;he+=1)g[he]&&g[he].m(N,$);yn(N,e,$),n=!0},p(N,$){var he,oe;if($&1){c=gu((oe=(he=N[0])==null?void 0:he.next)==null?void 0:oe.options);let ce;for(ce=0;ce<c.length;ce+=1){const _e=pw(N,c,ce);g[ce]?(g[ce].p(_e,$),Fi(g[ce],1)):(g[ce]=vw(_e),g[ce].c(),Fi(g[ce],1),g[ce].m(e.parentNode,e))}for(Ba(),ce=c.length;ce<g.length;ce+=1)v(ce);za()}},i(N){if(!n){for(let $=0;$<c.length;$+=1)Fi(g[$]);n=!0}},o(N){g=g.filter(Boolean);for(let $=0;$<g.length;$+=1)Xi(g[$]);n=!1},d(N){N&&Ai(e),dA(g,N)}}}function xw(t){let e,n;return e=new x5({}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function bO(t){let e=t[16]+"",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p:Ra,d(c){c&&Ai(n)}}}function bw(t){let e,n;return e=new d0({props:{value:t[16],$$slots:{default:[bO]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&8388608&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function wO(t){let e,n,c=gu(t[5]),g=[];for(let S=0;S<c.length;S+=1)g[S]=bw(dw(t,c,S));const v=S=>Xi(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();e=Zr()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);e=Zr()},m(S,a){for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(S,a);yn(S,e,a),n=!0},p(S,a){if(a&32){c=gu(S[5]);let N;for(N=0;N<c.length;N+=1){const $=dw(S,c,N);g[N]?(g[N].p($,a),Fi(g[N],1)):(g[N]=bw($),g[N].c(),Fi(g[N],1),g[N].m(e.parentNode,e))}for(Ba(),N=c.length;N<g.length;N+=1)v(N);za()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Fi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)Xi(g[a]);n=!1},d(S){S&&Ai(e),dA(g,S)}}}function SO(t){let e=t[0]?"Build":"Select a null model",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p(c,g){g&1&&e!==(e=c[0]?"Build":"Select a null model")&&El(n,e)},d(c){c&&Ai(n)}}}function IO(t){let e,n;return e=new vC({props:{$$slots:{default:[SO]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&8388609&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function EO(t){var ut;let e,n,c,g,v,S,a,N="Select a null model",$,he,oe,ce,_e,Ze,nt,Ke="Select a different region to compare",st,ht,xt,zt,Mt,Ue,$t;c=new Nv({});function rt(Ye){t[9](Ye)}let gt={class:"shaped",variant:"filled",$$slots:{default:[yO]},$$scope:{ctx:t}};t[0]!==void 0&&(gt.value=t[0]),he=new o0({props:gt}),ta.push(()=>Vh(he,"value",rt));let At=((ut=t[0])==null?void 0:ut.next)&&_w(t);function yt(Ye){t[11](Ye)}let St={class:"shaped",variant:"filled",$$slots:{default:[wO]},$$scope:{ctx:t}};return t[2]!==void 0&&(St.value=t[2]),ht=new o0({props:St}),ta.push(()=>Vh(ht,"value",yt)),Ue=new sO({props:{class:"theme-button",variant:"raised",disabled:!t[0],$$slots:{default:[IO]},$$scope:{ctx:t}}}),Ue.$on("click",t[12]),{c(){e=Pn("div"),n=Pn("div"),Cr(c.$$.fragment),g=_r(),v=Pn("div"),S=Pn("div"),a=Pn("h2"),a.textContent=N,$=_r(),Cr(he.$$.fragment),ce=_r(),At&&At.c(),_e=_r(),Ze=Pn("div"),nt=Pn("h2"),nt.textContent=Ke,st=_r(),Cr(ht.$$.fragment),Mt=_r(),Cr(Ue.$$.fragment),this.h()},l(Ye){e=Dn(Ye,"DIV",{class:!0});var _t=rn(e);n=Dn(_t,"DIV",{class:!0});var ct=rn(n);Rr(c.$$.fragment,ct),ct.forEach(Ai),g=yr(_t),v=Dn(_t,"DIV",{class:!0});var Ut=rn(v);S=Dn(Ut,"DIV",{class:!0});var Ft=rn(S);a=Dn(Ft,"H2",{class:!0,"data-svelte-h":!0}),$u(a)!=="svelte-1vw7qz9"&&(a.textContent=N),$=yr(Ft),Rr(he.$$.fragment,Ft),Ft.forEach(Ai),ce=yr(Ut),At&&At.l(Ut),_e=yr(Ut),Ze=Dn(Ut,"DIV",{class:!0});var Vt=rn(Ze);nt=Dn(Vt,"H2",{class:!0,"data-svelte-h":!0}),$u(nt)!=="svelte-1y5wjwe"&&(nt.textContent=Ke),st=yr(Vt),Rr(ht.$$.fragment,Vt),Vt.forEach(Ai),Mt=yr(Ut),Rr(Ue.$$.fragment,Ut),Ut.forEach(Ai),_t.forEach(Ai),this.h()},h(){_i(n,"class","logo svelte-wgfovm"),_i(a,"class","svelte-wgfovm"),_i(S,"class","step svelte-wgfovm"),_i(nt,"class","svelte-wgfovm"),_i(Ze,"class",zt=op(`step ${!t[0]&&"grayed"}`)+" svelte-wgfovm"),_i(v,"class","steps svelte-wgfovm"),_i(e,"class","builder svelte-wgfovm")},m(Ye,_t){yn(Ye,e,_t),Bi(e,n),Tr(c,n,null),Bi(e,g),Bi(e,v),Bi(v,S),Bi(S,a),Bi(S,$),Tr(he,S,null),Bi(v,ce),At&&At.m(v,null),Bi(v,_e),Bi(v,Ze),Bi(Ze,nt),Bi(Ze,st),Tr(ht,Ze,null),Bi(v,Mt),Tr(Ue,v,null),$t=!0},p(Ye,[_t]){var Vt;const ct={};_t&8388624&&(ct.$$scope={dirty:_t,ctx:Ye}),!oe&&_t&1&&(oe=!0,ct.value=Ye[0],Nh(()=>oe=!1)),he.$set(ct),(Vt=Ye[0])!=null&&Vt.next?At?(At.p(Ye,_t),_t&1&&Fi(At,1)):(At=_w(Ye),At.c(),Fi(At,1),At.m(v,_e)):At&&(Ba(),Xi(At,1,1,()=>{At=null}),za());const Ut={};_t&8388608&&(Ut.$$scope={dirty:_t,ctx:Ye}),!xt&&_t&4&&(xt=!0,Ut.value=Ye[2],Nh(()=>xt=!1)),ht.$set(Ut),(!$t||_t&1&&zt!==(zt=op(`step ${!Ye[0]&&"grayed"}`)+" svelte-wgfovm"))&&_i(Ze,"class",zt);const Ft={};_t&1&&(Ft.disabled=!Ye[0]),_t&8388609&&(Ft.$$scope={dirty:_t,ctx:Ye}),Ue.$set(Ft)},i(Ye){$t||(Fi(c.$$.fragment,Ye),Fi(he.$$.fragment,Ye),Fi(At),Fi(ht.$$.fragment,Ye),Fi(Ue.$$.fragment,Ye),$t=!0)},o(Ye){Xi(c.$$.fragment,Ye),Xi(he.$$.fragment,Ye),Xi(At),Xi(ht.$$.fragment,Ye),Xi(Ue.$$.fragment,Ye),$t=!1},d(Ye){Ye&&Ai(e),kr(c),kr(he),At&&At.d(),kr(ht),kr(Ue)}}}function CO(t,e,n){let c;Il(t,rm,ht=>n(8,c=ht));let{showEcoregions:g}=e,v=!1,{nullRegion:S}=e;const a=[{name:"All of California",type:"CALIFORNIA",next:null},{name:"By Ecoregion",type:"ECOREGION",next:{name:"ecoregion",options:[{name:"Ecoregion 1"},{name:"Ecoregion 2"},{name:"Ecoregion 3"}]}},{name:"Surface",next:"object"}];let{subNullRegion:N}=e,{altRegion:$}=e;const he=a;function oe(){if(!c.querySourceFeatures)return;let ht=c.querySourceFeatures("ecoregions"),xt=[];for(let zt of ht)if(xt.filter(Mt=>Mt.ids.includes(zt.id)).length==0){let Mt=`${zt.properties.US_L3NAME}`,Ue=xt.filter($t=>$t.name===Mt)[0];!Ue||(Ue==null?void 0:Ue.length)==0?xt.push({ids:[zt.id],name:`${zt.properties.US_L3NAME}`,type:"ECOREGION",value:`${zt.properties.US_L3CODE}`}):Ue.ids=[...Ue.ids,zt.id]}xt=xt.sort((zt,Mt)=>zt.name.localeCompare(Mt.name)),n(4,a[1].next.options=xt,a),n(3,v=!0)}function ce(ht){if(!ht)return;let xt=c.querySourceFeatures("ecoregions");for(let zt of xt)c.setFeatureState({source:"ecoregions",id:zt.id},{hover:!1});for(let zt of ht.ids)c.setFeatureState({source:"ecoregions",id:zt},{hover:!0})}async function _e(){t1.set({type:S.type,sub:N})}wc(()=>{oe()});function Ze(ht){S=ht,n(0,S)}function nt(ht){N=ht,n(1,N)}function Ke(ht){$=ht,n(2,$)}const st=()=>_e();return t.$$set=ht=>{"showEcoregions"in ht&&n(7,g=ht.showEcoregions),"nullRegion"in ht&&n(0,S=ht.nullRegion),"subNullRegion"in ht&&n(1,N=ht.subNullRegion),"altRegion"in ht&&n(2,$=ht.altRegion)},t.$$.update=()=>{var ht;t.$$.dirty&256&&c&&oe(),t.$$.dirty&129&&(S&&((ht=S.next)==null?void 0:ht.name)==="ecoregion"?g(!0):g(!1)),t.$$.dirty&2&&ce(N)},[S,N,$,v,a,he,_e,g,c,Ze,nt,Ke,st]}class TO extends Ha{constructor(e){super(),ja(this,e,CO,EO,Ca,{showEcoregions:7,nullRegion:0,subNullRegion:1,altRegion:2})}}function kO(t){let e,n,c,g='<td class="svelte-123tfyw">Hex</td> <td class="svelte-123tfyw">Tree Size</td> <td class="svelte-123tfyw">PD</td> <td class="svelte-123tfyw">MPD</td> <td class="svelte-123tfyw">MNTD</td>',v,S,a,N=t[0].hex+"",$,he,oe,ce=(t[1](t[0].properties.tree_sizes)??"Unknown")+"",_e,Ze,nt,Ke=(t[1](t[0].properties.pd)??"Unknown")+"",st,ht,xt,zt=(t[1](t[0].properties.mpd)??"Unknown")+"",Mt,Ue,$t,rt=(t[1](t[0].properties.mntd)??"Unknown")+"",gt;return{c(){e=Pn("div"),n=Pn("table"),c=Pn("thead"),c.innerHTML=g,v=_r(),S=Pn("tr"),a=Pn("td"),$=Fs(N),he=_r(),oe=Pn("td"),_e=Fs(ce),Ze=_r(),nt=Pn("td"),st=Fs(Ke),ht=_r(),xt=Pn("td"),Mt=Fs(zt),Ue=_r(),$t=Pn("td"),gt=Fs(rt),this.h()},l(At){e=Dn(At,"DIV",{class:!0});var yt=rn(e);n=Dn(yt,"TABLE",{});var St=rn(n);c=Dn(St,"THEAD",{class:!0,"data-svelte-h":!0}),$u(c)!=="svelte-i8fsz9"&&(c.innerHTML=g),v=yr(St),S=Dn(St,"TR",{class:!0});var ut=rn(S);a=Dn(ut,"TD",{class:!0});var Ye=rn(a);$=Os(Ye,N),Ye.forEach(Ai),he=yr(ut),oe=Dn(ut,"TD",{class:!0});var _t=rn(oe);_e=Os(_t,ce),_t.forEach(Ai),Ze=yr(ut),nt=Dn(ut,"TD",{class:!0});var ct=rn(nt);st=Os(ct,Ke),ct.forEach(Ai),ht=yr(ut),xt=Dn(ut,"TD",{class:!0});var Ut=rn(xt);Mt=Os(Ut,zt),Ut.forEach(Ai),Ue=yr(ut),$t=Dn(ut,"TD",{class:!0});var Ft=rn($t);gt=Os(Ft,rt),Ft.forEach(Ai),ut.forEach(Ai),St.forEach(Ai),yt.forEach(Ai),this.h()},h(){_i(c,"class","svelte-123tfyw"),_i(a,"class","svelte-123tfyw"),_i(oe,"class","svelte-123tfyw"),_i(nt,"class","svelte-123tfyw"),_i(xt,"class","svelte-123tfyw"),_i($t,"class","svelte-123tfyw"),_i(S,"class","mono svelte-123tfyw"),_i(e,"class","summary-container svelte-123tfyw")},m(At,yt){yn(At,e,yt),Bi(e,n),Bi(n,c),Bi(n,v),Bi(n,S),Bi(S,a),Bi(a,$),Bi(S,he),Bi(S,oe),Bi(oe,_e),Bi(S,Ze),Bi(S,nt),Bi(nt,st),Bi(S,ht),Bi(S,xt),Bi(xt,Mt),Bi(S,Ue),Bi(S,$t),Bi($t,gt)},p(At,[yt]){yt&1&&N!==(N=At[0].hex+"")&&El($,N),yt&1&&ce!==(ce=(At[1](At[0].properties.tree_sizes)??"Unknown")+"")&&El(_e,ce),yt&1&&Ke!==(Ke=(At[1](At[0].properties.pd)??"Unknown")+"")&&El(st,Ke),yt&1&&zt!==(zt=(At[1](At[0].properties.mpd)??"Unknown")+"")&&El(Mt,zt),yt&1&&rt!==(rt=(At[1](At[0].properties.mntd)??"Unknown")+"")&&El(gt,rt)},i:Ra,o:Ra,d(At){At&&Ai(e)}}}const ww=3;function MO(t,e,n){let{data:c}=e;const g=v=>Math.round(v*10**ww)/10**ww;return t.$$set=v=>{"data"in v&&n(0,c=v.data)},[c,g]}class PO extends Ha{constructor(e){super(),ja(this,e,MO,kO,Ca,{data:0})}}function DO(t){let e,n,c,g,v,S='<strong class="svelte-1b48uq5">PH</strong>ylogenetic <strong class="svelte-1b48uq5">A</strong>nalysis at <strong class="svelte-1b48uq5">S</strong>peedy <strong class="svelte-1b48uq5">T</strong>ime',a,N,$="To start, set the options at the top right to the metric and taxon you want to look at.",he,oe,ce="This is a description of the program for users to be able to read in lieu of specific metrics so that we don't have a big white space when users start the application. This way we can describe useful information and context about the project at the right time, while also making the most of the whitespace on the page. This description should change once we decide exactly what information we want to convey to the user and finalize certain UX flows that are in development.",_e;return c=new Nv({}),{c(){e=Pn("div"),n=Pn("h1"),Cr(c.$$.fragment),g=_r(),v=Pn("h3"),v.innerHTML=S,a=_r(),N=Pn("p"),N.textContent=$,he=_r(),oe=Pn("p"),oe.textContent=ce,this.h()},l(Ze){e=Dn(Ze,"DIV",{class:!0});var nt=rn(e);n=Dn(nt,"H1",{});var Ke=rn(n);Rr(c.$$.fragment,Ke),Ke.forEach(Ai),g=yr(nt),v=Dn(nt,"H3",{class:!0,"data-svelte-h":!0}),$u(v)!=="svelte-12h6mrz"&&(v.innerHTML=S),a=yr(nt),N=Dn(nt,"P",{"data-svelte-h":!0}),$u(N)!=="svelte-4cip2g"&&(N.textContent=$),he=yr(nt),oe=Dn(nt,"P",{"data-svelte-h":!0}),$u(oe)!=="svelte-1icmnw4"&&(oe.textContent=ce),nt.forEach(Ai),this.h()},h(){_i(v,"class","svelte-1b48uq5"),_i(e,"class","about svelte-1b48uq5")},m(Ze,nt){yn(Ze,e,nt),Bi(e,n),Tr(c,n,null),Bi(e,g),Bi(e,v),Bi(e,a),Bi(e,N),Bi(e,he),Bi(e,oe),_e=!0},p:Ra,i(Ze){_e||(Fi(c.$$.fragment,Ze),_e=!0)},o(Ze){Xi(c.$$.fragment,Ze),_e=!1},d(Ze){Ze&&Ai(e),kr(c)}}}class LO extends Ha{constructor(e){super(),ja(this,e,null,DO,Ca,{})}}function Sw(t,e,n){const c=t.slice();return c[18]=e[n],c}function Iw(t,e,n){const c=t.slice();return c[18]=e[n],c}function BO(t,e,n){const c=t.slice();return c[18]=e[n],c}function Ew(t){let e,n,c,g,v,S,a,N,$,he,oe,ce,_e,Ze,nt,Ke,st,ht;function xt(ut){t[14](ut)}let zt={class:"shaped",variant:"outlined",$$slots:{default:[FO]},$$scope:{ctx:t}};t[9]!==void 0&&(zt.value=t[9]),g=new o0({props:zt}),ta.push(()=>Vh(g,"value",xt));function Mt(ut){t[15](ut)}let Ue={class:"shaped",variant:"outlined",$$slots:{default:[NO]},$$scope:{ctx:t}};t[0]!==void 0&&(Ue.value=t[0]),a=new o0({props:Ue}),ta.push(()=>Vh(a,"value",Mt));function $t(ut){t[16](ut)}let rt={class:"shaped",variant:"outlined",$$slots:{default:[UO]},$$scope:{ctx:t}};t[10]!==void 0&&(rt.value=t[10]),he=new o0({props:rt}),ta.push(()=>Vh(he,"value",$t));let gt=t[7]&&kw(t),At=!t[5]&&Mw(),yt=!t[7]&&Pw(),St=t[7]&&Dw(t);return{c(){e=Pn("div"),n=Pn("div"),c=Fs(`Testing
                `),Cr(g.$$.fragment),S=Fs(`
                of
                `),Cr(a.$$.fragment),$=Fs(`
                at the
                `),Cr(he.$$.fragment),ce=Fs(`
                level`),_e=_r(),gt&&gt.c(),Ze=_r(),At&&At.c(),nt=_r(),yt&&yt.c(),Ke=_r(),St&&St.c(),st=Zr(),this.h()},l(ut){e=Dn(ut,"DIV",{class:!0});var Ye=rn(e);n=Dn(Ye,"DIV",{class:!0});var _t=rn(n);c=Os(_t,`Testing
                `),Rr(g.$$.fragment,_t),S=Os(_t,`
                of
                `),Rr(a.$$.fragment,_t),$=Os(_t,`
                at the
                `),Rr(he.$$.fragment,_t),ce=Os(_t,`
                level`),_t.forEach(Ai),_e=yr(Ye),gt&&gt.l(Ye),Ye.forEach(Ai),Ze=yr(ut),At&&At.l(ut),nt=yr(ut),yt&&yt.l(ut),Ke=yr(ut),St&&St.l(ut),st=Zr(),this.h()},h(){_i(n,"class","test svelte-8myhro"),_i(e,"class","header svelte-8myhro")},m(ut,Ye){yn(ut,e,Ye),Bi(e,n),Bi(n,c),Tr(g,n,null),Bi(n,S),Tr(a,n,null),Bi(n,$),Tr(he,n,null),Bi(n,ce),Bi(e,_e),gt&&gt.m(e,null),yn(ut,Ze,Ye),At&&At.m(ut,Ye),yn(ut,nt,Ye),yt&&yt.m(ut,Ye),yn(ut,Ke,Ye),St&&St.m(ut,Ye),yn(ut,st,Ye),ht=!0},p(ut,Ye){const _t={};Ye&33554432&&(_t.$$scope={dirty:Ye,ctx:ut}),!v&&Ye&512&&(v=!0,_t.value=ut[9],Nh(()=>v=!1)),g.$set(_t);const ct={};Ye&33554436&&(ct.$$scope={dirty:Ye,ctx:ut}),!N&&Ye&1&&(N=!0,ct.value=ut[0],Nh(()=>N=!1)),a.$set(ct);const Ut={};Ye&33554440&&(Ut.$$scope={dirty:Ye,ctx:ut}),!oe&&Ye&1024&&(oe=!0,Ut.value=ut[10],Nh(()=>oe=!1)),he.$set(Ut),ut[7]?gt?gt.p(ut,Ye):(gt=kw(ut),gt.c(),gt.m(e,null)):gt&&(gt.d(1),gt=null),ut[5]?At&&(Ba(),Xi(At,1,1,()=>{At=null}),za()):At?Ye&32&&Fi(At,1):(At=Mw(),At.c(),Fi(At,1),At.m(nt.parentNode,nt)),ut[7]?yt&&(Ba(),Xi(yt,1,1,()=>{yt=null}),za()):yt?Ye&128&&Fi(yt,1):(yt=Pw(),yt.c(),Fi(yt,1),yt.m(Ke.parentNode,Ke)),ut[7]?St?(St.p(ut,Ye),Ye&128&&Fi(St,1)):(St=Dw(ut),St.c(),Fi(St,1),St.m(st.parentNode,st)):St&&(Ba(),Xi(St,1,1,()=>{St=null}),za())},i(ut){ht||(Fi(g.$$.fragment,ut),Fi(a.$$.fragment,ut),Fi(he.$$.fragment,ut),Fi(At),Fi(yt),Fi(St),ht=!0)},o(ut){Xi(g.$$.fragment,ut),Xi(a.$$.fragment,ut),Xi(he.$$.fragment,ut),Xi(At),Xi(yt),Xi(St),ht=!1},d(ut){ut&&(Ai(e),Ai(Ze),Ai(nt),Ai(Ke),Ai(st)),kr(g),kr(a),kr(he),gt&&gt.d(),At&&At.d(ut),yt&&yt.d(ut),St&&St.d(ut)}}}function zO(t){let e;return{c(){e=Fs(t[18])},l(n){e=Os(n,t[18])},m(n,c){yn(n,e,c)},p:Ra,d(n){n&&Ai(e)}}}function RO(t){let e,n;return e=new d0({props:{value:t[18],$$slots:{default:[zO]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&33554432&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function FO(t){let e,n,c=gu(dm),g=[];for(let v=0;v<c.length;v+=1)g[v]=RO(BO(t,c,v));return{c(){for(let v=0;v<g.length;v+=1)g[v].c();e=Zr()},l(v){for(let S=0;S<g.length;S+=1)g[S].l(v);e=Zr()},m(v,S){for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(v,S);yn(v,e,S),n=!0},p:Ra,i(v){if(!n){for(let S=0;S<c.length;S+=1)Fi(g[S]);n=!0}},o(v){g=g.filter(Boolean);for(let S=0;S<g.length;S+=1)Xi(g[S]);n=!1},d(v){v&&Ai(e),dA(g,v)}}}function OO(t){let e=t[18]+"",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p(c,g){g&4&&e!==(e=c[18]+"")&&El(n,e)},d(c){c&&Ai(n)}}}function Cw(t){let e,n;return e=new d0({props:{value:t[18],$$slots:{default:[OO]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&4&&(v.value=c[18]),g&33554436&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function NO(t){let e,n,c=gu(t[2]),g=[];for(let S=0;S<c.length;S+=1)g[S]=Cw(Iw(t,c,S));const v=S=>Xi(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();e=Zr()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);e=Zr()},m(S,a){for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(S,a);yn(S,e,a),n=!0},p(S,a){if(a&4){c=gu(S[2]);let N;for(N=0;N<c.length;N+=1){const $=Iw(S,c,N);g[N]?(g[N].p($,a),Fi(g[N],1)):(g[N]=Cw($),g[N].c(),Fi(g[N],1),g[N].m(e.parentNode,e))}for(Ba(),N=c.length;N<g.length;N+=1)v(N);za()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Fi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)Xi(g[a]);n=!1},d(S){S&&Ai(e),dA(g,S)}}}function VO(t){let e=t[18]+"",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p(c,g){g&8&&e!==(e=c[18]+"")&&El(n,e)},d(c){c&&Ai(n)}}}function Tw(t){let e,n;return e=new d0({props:{value:t[18],$$slots:{default:[VO]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&8&&(v.value=c[18]),g&33554440&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function UO(t){let e,n,c=gu(t[3]),g=[];for(let S=0;S<c.length;S+=1)g[S]=Tw(Sw(t,c,S));const v=S=>Xi(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();e=Zr()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);e=Zr()},m(S,a){for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(S,a);yn(S,e,a),n=!0},p(S,a){if(a&8){c=gu(S[3]);let N;for(N=0;N<c.length;N+=1){const $=Sw(S,c,N);g[N]?(g[N].p($,a),Fi(g[N],1)):(g[N]=Tw($),g[N].c(),Fi(g[N],1),g[N].m(e.parentNode,e))}for(Ba(),N=c.length;N<g.length;N+=1)v(N);za()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Fi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)Xi(g[a]);n=!1},d(S){S&&Ai(e),dA(g,S)}}}function kw(t){let e,n,c="x",g,v;return{c(){e=Pn("div"),n=Pn("button"),n.textContent=c,this.h()},l(S){e=Dn(S,"DIV",{class:!0});var a=rn(e);n=Dn(a,"BUTTON",{class:!0,"data-svelte-h":!0}),$u(n)!=="svelte-1iv3129"&&(n.textContent=c),a.forEach(Ai),this.h()},h(){_i(n,"class","svelte-8myhro"),_i(e,"class","close svelte-8myhro")},m(S,a){yn(S,e,a),Bi(e,n),g||(v=jl(n,"click",t[17]),g=!0)},p:Ra,d(S){S&&Ai(e),g=!1,v()}}}function Mw(t){let e,n,c;return n=new x5({props:{message:"Building model..."}}),{c(){e=Pn("div"),Cr(n.$$.fragment),this.h()},l(g){e=Dn(g,"DIV",{class:!0});var v=rn(e);Rr(n.$$.fragment,v),v.forEach(Ai),this.h()},h(){_i(e,"class","load svelte-8myhro")},m(g,v){yn(g,e,v),Tr(n,e,null),c=!0},i(g){c||(Fi(n.$$.fragment,g),c=!0)},o(g){Xi(n.$$.fragment,g),c=!1},d(g){g&&Ai(e),kr(n)}}}function Pw(t){let e,n;return e=new LO({}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function Dw(t){var a,N,$,he,oe,ce,_e,Ze,nt;let e,n,c,g,v,S;return e=new PO({props:{data:t[6]}}),c=new iP({props:{colorScheme:t[1],metric:tf,point:[[(N=(a=t[6])==null?void 0:a.properties)==null?void 0:N.tree_sizes,($=t[6])==null?void 0:$.properties[tf]]]}}),v=new v5({props:{clade:t[0],present:(oe=(he=t[6])==null?void 0:he.properties)==null?void 0:oe.present,newick:(_e=(ce=t[6])==null?void 0:ce.properties)==null?void 0:_e.tree,hex_id:(nt=(Ze=t[6])==null?void 0:Ze.properties)==null?void 0:nt.id}}),{c(){Cr(e.$$.fragment),n=_r(),Cr(c.$$.fragment),g=_r(),Cr(v.$$.fragment)},l(Ke){Rr(e.$$.fragment,Ke),n=yr(Ke),Rr(c.$$.fragment,Ke),g=yr(Ke),Rr(v.$$.fragment,Ke)},m(Ke,st){Tr(e,Ke,st),yn(Ke,n,st),Tr(c,Ke,st),yn(Ke,g,st),Tr(v,Ke,st),S=!0},p(Ke,st){var Mt,Ue,$t,rt,gt,At,yt,St,ut;const ht={};st&64&&(ht.data=Ke[6]),e.$set(ht);const xt={};st&2&&(xt.colorScheme=Ke[1]),st&64&&(xt.point=[[(Ue=(Mt=Ke[6])==null?void 0:Mt.properties)==null?void 0:Ue.tree_sizes,($t=Ke[6])==null?void 0:$t.properties[tf]]]),c.$set(xt);const zt={};st&1&&(zt.clade=Ke[0]),st&64&&(zt.present=(gt=(rt=Ke[6])==null?void 0:rt.properties)==null?void 0:gt.present),st&64&&(zt.newick=(yt=(At=Ke[6])==null?void 0:At.properties)==null?void 0:yt.tree),st&64&&(zt.hex_id=(ut=(St=Ke[6])==null?void 0:St.properties)==null?void 0:ut.id),v.$set(zt)},i(Ke){S||(Fi(e.$$.fragment,Ke),Fi(c.$$.fragment,Ke),Fi(v.$$.fragment,Ke),S=!0)},o(Ke){Xi(e.$$.fragment,Ke),Xi(c.$$.fragment,Ke),Xi(v.$$.fragment,Ke),S=!1},d(Ke){Ke&&(Ai(n),Ai(g)),kr(e,Ke),kr(c,Ke),kr(v,Ke)}}}function Lw(t){let e,n;return e=new TO({props:{showEcoregions:t[4]}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&16&&(v.showEcoregions=c[4]),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function GO(t){let e,n,c,g=t[8]&&Ew(t),v=!t[8]&&Lw(t);return{c(){e=Pn("div"),g&&g.c(),n=_r(),v&&v.c(),this.h()},l(S){e=Dn(S,"DIV",{class:!0});var a=rn(e);g&&g.l(a),n=yr(a),v&&v.l(a),a.forEach(Ai),this.h()},h(){_i(e,"class",op("modal")+" svelte-8myhro")},m(S,a){yn(S,e,a),g&&g.m(e,null),Bi(e,n),v&&v.m(e,null),c=!0},p(S,[a]){S[8]?g?(g.p(S,a),a&256&&Fi(g,1)):(g=Ew(S),g.c(),Fi(g,1),g.m(e,n)):g&&(Ba(),Xi(g,1,1,()=>{g=null}),za()),S[8]?v&&(Ba(),Xi(v,1,1,()=>{v=null}),za()):v?(v.p(S,a),a&256&&Fi(v,1)):(v=Lw(S),v.c(),Fi(v,1),v.m(e,null))},i(S){c||(Fi(g),Fi(v),c=!0)},o(S){Xi(g),Xi(v),c=!1},d(S){S&&Ai(e),g&&g.d(),v&&v.d()}}}function qO(t,e,n){let c,g,v,S;Il(t,ip,Mt=>n(6,c=Mt)),Il(t,t1,Mt=>n(8,g=Mt)),Il(t,tf,Mt=>n(9,v=Mt)),Il(t,vg,Mt=>n(10,S=Mt));let{colorScheme:a}=e,{clade:N}=e,{updateClade:$}=e,{clades:he}=e,{visualLayers:oe}=e,{isBuilt:ce}=e,{showEcoregions:_e}=e,{isFinishedBuilding:Ze}=e,nt;const Ke=Mt=>{n(7,nt=(Mt==null?void 0:Mt.properties)&&(Mt==null?void 0:Mt.properties[tf])!==-1)};function st(Mt){v=Mt,tf.set(v)}function ht(Mt){N=Mt,n(0,N)}function xt(Mt){S=Mt,vg.set(S)}const zt=()=>{Ke(null),ip.set(null),console.log(c)};return t.$$set=Mt=>{"colorScheme"in Mt&&n(1,a=Mt.colorScheme),"clade"in Mt&&n(0,N=Mt.clade),"updateClade"in Mt&&n(12,$=Mt.updateClade),"clades"in Mt&&n(2,he=Mt.clades),"visualLayers"in Mt&&n(3,oe=Mt.visualLayers),"isBuilt"in Mt&&n(13,ce=Mt.isBuilt),"showEcoregions"in Mt&&n(4,_e=Mt.showEcoregions),"isFinishedBuilding"in Mt&&n(5,Ze=Mt.isFinishedBuilding)},t.$$.update=()=>{t.$$.dirty&64&&Ke(c),t.$$.dirty&4097&&$(N)},[N,a,he,oe,_e,Ze,c,nt,g,v,S,Ke,$,ce,st,ht,xt,zt]}class HO extends Ha{constructor(e){super(),ja(this,e,qO,GO,Ca,{colorScheme:1,clade:0,updateClade:12,clades:2,visualLayers:3,isBuilt:13,showEcoregions:4,isFinishedBuilding:5})}}var jO={exports:{}};(function(t,e){(function(n,c){t.exports=c()})(s0,function(){var n,c,g;function v(a,N){if(!n)n=N;else if(!c)c=N;else{var $="var sharedChunk = {}; ("+n+")(sharedChunk); ("+c+")(sharedChunk);",he={};n(he),g=N(he),typeof window<"u"&&(g.workerUrl=window.URL.createObjectURL(new Blob([$],{type:"text/javascript"})))}}v(["exports"],function(a){function N(f,u,p,E){return new(p||(p=Promise))(function(B,q){function W(ve){try{fe(E.next(ve))}catch(Be){q(Be)}}function se(ve){try{fe(E.throw(ve))}catch(Be){q(Be)}}function fe(ve){var Be;ve.done?B(ve.value):(Be=ve.value,Be instanceof p?Be:new p(function(He){He(Be)})).then(W,se)}fe((E=E.apply(f,u||[])).next())})}function $(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}typeof SuppressedError=="function"&&SuppressedError;var he=oe;function oe(f,u){this.x=f,this.y=u}oe.prototype={clone:function(){return new oe(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,p=f.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),p=Math.sin(f),E=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=E,this},_rotateAround:function(f,u){var p=Math.cos(f),E=Math.sin(f),B=u.y+E*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-E*(this.y-u.y),this.y=B,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},oe.convert=function(f){return f instanceof oe?f:Array.isArray(f)?new oe(f[0],f[1]):f};var ce=$(he),_e=Ze;function Ze(f,u,p,E){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(E-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=p,this.p2y=E}Ze.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,E=0;E<8;E++){var B=this.sampleCurveX(p)-f;if(Math.abs(B)<u)return p;var q=this.sampleCurveDerivativeX(p);if(Math.abs(q)<1e-6)break;p-=B/q}var W=0,se=1;for(p=f,E=0;E<20&&(B=this.sampleCurveX(p),!(Math.abs(B-f)<u));E++)f>B?W=p:se=p,p=.5*(se-W)+W;return p},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};var nt=$(_e);let Ke,st;function ht(){return Ke==null&&(Ke=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ke}function xt(){if(st==null&&(st=!1,ht())){const u=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(u){for(let E=0;E<5*5;E++){const B=4*E;u.fillStyle=`rgb(${B},${B+1},${B+2})`,u.fillRect(E%5,Math.floor(E/5),1,1)}const p=u.getImageData(0,0,5,5).data;for(let E=0;E<5*5*4;E++)if(E%4!=3&&p[E]!==E){st=!0;break}}}return st||!1}function zt(f,u,p,E){const B=new nt(f,u,p,E);return function(q){return B.solve(q)}}const Mt=zt(.25,.1,.25,1);function Ue(f,u,p){return Math.min(p,Math.max(u,f))}function $t(f,u,p){const E=p-u,B=((f-u)%E+E)%E+u;return B===u?p:B}function rt(f,...u){for(const p of u)for(const E in p)f[E]=p[E];return f}let gt=1;function At(f,u,p){const E={};for(const B in f)E[B]=u.call(p||this,f[B],B,f);return E}function yt(f,u,p){const E={};for(const B in f)u.call(p||this,f[B],B,f)&&(E[B]=f[B]);return E}function St(f){return Array.isArray(f)?f.map(St):typeof f=="object"&&f?At(f,St):f}const ut={};function Ye(f){ut[f]||(typeof console<"u"&&console.warn(f),ut[f]=!0)}function _t(f,u,p){return(p.y-f.y)*(u.x-f.x)>(u.y-f.y)*(p.x-f.x)}function ct(f){let u=0;for(let p,E,B=0,q=f.length,W=q-1;B<q;W=B++)p=f[B],E=f[W],u+=(E.x-p.x)*(p.y+E.y);return u}function Ut(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Ft=null;function Vt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const yi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ci(f,u,p,E,B){return N(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const q=new VideoFrame(f,{timestamp:0});try{const W=q==null?void 0:q.format;if(!W||!W.startsWith("BGR")&&!W.startsWith("RGB"))throw new Error(`Unrecognized format ${W}`);const se=W.startsWith("BGR"),fe=new Uint8ClampedArray(E*B*4);if(yield q.copyTo(fe,function(ve,Be,He,it,pt){const vt=4*Math.max(-Be,0),Dt=(Math.max(0,He)-He)*it*4+vt,Lt=4*it,Rt=Math.max(0,Be),ei=Math.max(0,He);return{rect:{x:Rt,y:ei,width:Math.min(ve.width,Be+it)-Rt,height:Math.min(ve.height,He+pt)-ei},layout:[{offset:Dt,stride:Lt}]}}(f,u,p,E,B)),se)for(let ve=0;ve<fe.length;ve+=4){const Be=fe[ve];fe[ve]=fe[ve+2],fe[ve+2]=Be}return fe}finally{q.close()}})}let ki,Ni,tn,Zi;const Gi={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){return this.getImageCanvasContext(f).getImageData(-u,-u,f.width+2*u,f.height+2*u)},getImageCanvasContext(f){const u=window.document.createElement("canvas"),p=u.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return u.width=f.width,u.height=f.height,p.drawImage(f,0,0,f.width,f.height),p},resolveURL:f=>(tn||(tn=document.createElement("a")),tn.href=f,tn.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Zi==null&&(Zi=matchMedia("(prefers-reduced-motion: reduce)")),Zi.matches)}},sn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class xn extends Error{constructor(u,p,E,B){super(`AJAXError: ${p} (${u}): ${E}`),this.status=u,this.statusText=p,this.url=E,this.body=B}}const Ti=Ut()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,gi=f=>sn.REGISTERED_PROTOCOLS[f.substring(0,f.indexOf("://"))];function Oi(f,u){const p=new AbortController,E=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Ti(),signal:p.signal});let B=!1,q=!1;return f.type==="json"&&E.headers.set("Accept","application/json"),q||fetch(E).then(W=>W.ok?(se=>{(f.type==="arrayBuffer"||f.type==="image"?se.arrayBuffer():f.type==="json"?se.json():se.text()).then(fe=>{q||(B=!0,u(null,fe,se.headers.get("Cache-Control"),se.headers.get("Expires")))}).catch(fe=>{q||u(new Error(fe.message))})})(W):W.blob().then(se=>u(new xn(W.status,W.statusText,f.url,se)))).catch(W=>{W.code!==20&&u(new Error(W.message))}),{cancel:()=>{q=!0,B||p.abort()}}}const Vi=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Ut()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Ut())return(gi(f.url)||Oi)(f,u)}if(!(/^file:/.test(p=f.url)||/^file:/.test(Ti())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Oi(f,u);if(Ut()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var p;return function(E,B){const q=new XMLHttpRequest;q.open(E.method||"GET",E.url,!0),E.type!=="arrayBuffer"&&E.type!=="image"||(q.responseType="arraybuffer");for(const W in E.headers)q.setRequestHeader(W,E.headers[W]);return E.type==="json"&&(q.responseType="text",q.setRequestHeader("Accept","application/json")),q.withCredentials=E.credentials==="include",q.onerror=()=>{B(new Error(q.statusText))},q.onload=()=>{if((q.status>=200&&q.status<300||q.status===0)&&q.response!==null){let W=q.response;if(E.type==="json")try{W=JSON.parse(q.response)}catch(se){return B(se)}B(null,W,q.getResponseHeader("Cache-Control"),q.getResponseHeader("Expires"))}else{const W=new Blob([q.response],{type:q.getResponseHeader("Content-Type")});B(new xn(q.status,q.statusText,E.url,W))}},q.send(E.body),{cancel:()=>q.abort()}}(f,u)},bn=function(f,u){return Vi(rt(f,{type:"arrayBuffer"}),u)};function wn(f){if(!f||f.indexOf("://")<=0||f.indexOf("data:image/")===0||f.indexOf("blob:")===0)return!0;const u=new URL(f),p=window.location;return u.protocol===p.protocol&&u.host===p.host}function xi(f,u,p){p[f]&&p[f].indexOf(u)!==-1||(p[f]=p[f]||[],p[f].push(u))}function Bn(f,u,p){if(p&&p[f]){const E=p[f].indexOf(u);E!==-1&&p[f].splice(E,1)}}class Ot{constructor(u,p={}){rt(this,p),this.type=u}}class an extends Ot{constructor(u,p={}){super("error",rt({error:u},p))}}class $n{on(u,p){return this._listeners=this._listeners||{},xi(u,p,this._listeners),this}off(u,p){return Bn(u,p,this._listeners),Bn(u,p,this._oneTimeListeners),this}once(u,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},xi(u,p,this._oneTimeListeners),this):new Promise(E=>this.once(u,E))}fire(u,p){typeof u=="string"&&(u=new Ot(u,p||{}));const E=u.type;if(this.listens(E)){u.target=this;const B=this._listeners&&this._listeners[E]?this._listeners[E].slice():[];for(const se of B)se.call(this,u);const q=this._oneTimeListeners&&this._oneTimeListeners[E]?this._oneTimeListeners[E].slice():[];for(const se of q)Bn(E,se,this._oneTimeListeners),se.call(this,u);const W=this._eventedParent;W&&(rt(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),W.fire(u))}else u instanceof an&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var oi={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Yi=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Xn(f,u){const p={};for(const E in f)E!=="ref"&&(p[E]=f[E]);return Yi.forEach(E=>{E in u&&(p[E]=u[E])}),p}function zn(f,u){if(Array.isArray(f)){if(!Array.isArray(u)||f.length!==u.length)return!1;for(let p=0;p<f.length;p++)if(!zn(f[p],u[p]))return!1;return!0}if(typeof f=="object"&&f!==null&&u!==null){if(typeof u!="object"||Object.keys(f).length!==Object.keys(u).length)return!1;for(const p in f)if(!zn(f[p],u[p]))return!1;return!0}return f===u}const Wn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function _n(f,u,p){p.push({command:Wn.addSource,args:[f,u[f]]})}function b(f,u,p){u.push({command:Wn.removeSource,args:[f]}),p[f]=!0}function M(f,u,p,E){b(f,p,E),_n(f,u,p)}function U(f,u,p){let E;for(E in f[p])if(Object.prototype.hasOwnProperty.call(f[p],E)&&E!=="data"&&!zn(f[p][E],u[p][E]))return!1;for(E in u[p])if(Object.prototype.hasOwnProperty.call(u[p],E)&&E!=="data"&&!zn(f[p][E],u[p][E]))return!1;return!0}function K(f,u,p,E,B,q){let W;for(W in u=u||{},f=f||{})Object.prototype.hasOwnProperty.call(f,W)&&(zn(f[W],u[W])||p.push({command:q,args:[E,W,u[W],B]}));for(W in u)Object.prototype.hasOwnProperty.call(u,W)&&!Object.prototype.hasOwnProperty.call(f,W)&&(zn(f[W],u[W])||p.push({command:q,args:[E,W,u[W],B]}))}function ie(f){return f.id}function de(f,u){return f[u.id]=u,f}class be{constructor(u,p,E,B){this.message=(u?`${u}: `:"")+E,B&&(this.identifier=B),p!=null&&p.__line__&&(this.line=p.__line__)}}function Ee(f,...u){for(const p of u)for(const E in p)f[E]=p[E];return f}class Ce extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class Re{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[E,B]of p)this.bindings[E]=B}concat(u){return new Re(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const $e={kind:"null"},je={kind:"number"},We={kind:"string"},Ge={kind:"boolean"},mt={kind:"color"},ot={kind:"object"},Pe={kind:"value"},ae={kind:"collator"},re={kind:"formatted"},X={kind:"padding"},ne={kind:"resolvedImage"},pe={kind:"variableAnchorOffsetCollection"};function xe(f,u){return{kind:"array",itemType:f,N:u}}function ye(f){if(f.kind==="array"){const u=ye(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const De=[$e,je,We,Ge,mt,re,ot,xe(Pe),X,ne,pe];function Oe(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Oe(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const p of De)if(!Oe(p,u))return null}}return`Expected ${ye(f)} but found ${ye(u)} instead.`}function Ve(f,u){return u.some(p=>p.kind===f.kind)}function Je(f,u){return u.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}function et(f,u){return f.kind==="array"&&u.kind==="array"?f.itemType.kind===u.itemType.kind&&typeof f.N=="number":f.kind===u.kind}const Le=.96422,qe=.82521,dt=4/29,Pt=6/29,o=3*Pt*Pt,Me=Pt*Pt*Pt,li=Math.PI/180,di=180/Math.PI;function fi(f){return(f%=360)<0&&(f+=360),f}function ti([f,u,p,E]){let B,q;const W=Ri((.2225045*(f=ui(f))+.7168786*(u=ui(u))+.0606169*(p=ui(p)))/1);f===u&&u===p?B=q=W:(B=Ri((.4360747*f+.3850649*u+.1430804*p)/Le),q=Ri((.0139322*f+.0971045*u+.7141733*p)/qe));const se=116*W-16;return[se<0?0:se,500*(B-W),200*(W-q),E]}function ui(f){return f<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Ri(f){return f>Me?Math.pow(f,1/3):f/o+dt}function bi([f,u,p,E]){let B=(f+16)/116,q=isNaN(u)?B:B+u/500,W=isNaN(p)?B:B-p/200;return B=1*Jt(B),q=Le*Jt(q),W=qe*Jt(W),[Si(3.1338561*q-1.6168667*B-.4906146*W),Si(-.9787684*q+1.9161415*B+.033454*W),Si(.0719453*q-.2289914*B+1.4052427*W),E]}function Si(f){return(f=f<=.00304?12.92*f:1.055*Math.pow(f,1/2.4)-.055)<0?0:f>1?1:f}function Jt(f){return f>Pt?f*f*f:o*(f-dt)}function Sn(f){return parseInt(f.padEnd(2,f),16)/255}function ur(f,u){return mn(u?f/100:f,0,1)}function mn(f,u,p){return Math.min(Math.max(u,f),p)}function Hn(f){return!f.some(Number.isNaN)}const Yr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Qi{constructor(u,p,E,B=1,q=!0){this.r=u,this.g=p,this.b=E,this.a=B,q||(this.r*=B,this.g*=B,this.b*=B,B||this.overwriteGetter("rgb",[u,p,E,B]))}static parse(u){if(u instanceof Qi)return u;if(typeof u!="string")return;const p=function(E){if((E=E.toLowerCase().trim())==="transparent")return[0,0,0,0];const B=Yr[E];if(B){const[W,se,fe]=B;return[W/255,se/255,fe/255,1]}if(E.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(E)){const W=E.length<6?1:2;let se=1;return[Sn(E.slice(se,se+=W)),Sn(E.slice(se,se+=W)),Sn(E.slice(se,se+=W)),Sn(E.slice(se,se+W)||"ff")]}if(E.startsWith("rgb")){const W=E.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(W){const[se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei]=W,Zt=[Be||" ",pt||" ",Lt].join("");if(Zt==="  "||Zt==="  /"||Zt===",,"||Zt===",,,"){const Wt=[ve,it,Dt].join(""),hi=Wt==="%%%"?100:Wt===""?255:0;if(hi){const vi=[mn(+fe/hi,0,1),mn(+He/hi,0,1),mn(+vt/hi,0,1),Rt?ur(+Rt,ei):1];if(Hn(vi))return vi}}return}}const q=E.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(q){const[W,se,fe,ve,Be,He,it,pt,vt]=q,Dt=[fe||" ",Be||" ",it].join("");if(Dt==="  "||Dt==="  /"||Dt===",,"||Dt===",,,"){const Lt=[+se,mn(+ve,0,100),mn(+He,0,100),pt?ur(+pt,vt):1];if(Hn(Lt))return function([Rt,ei,Zt,Wt]){function hi(vi){const Ji=(vi+Rt/30)%12,In=ei*Math.min(Zt,1-Zt);return Zt-In*Math.max(-1,Math.min(Ji-3,9-Ji,1))}return Rt=fi(Rt),ei/=100,Zt/=100,[hi(0),hi(8),hi(4),Wt]}(Lt)}}}(u);return p?new Qi(...p,!1):void 0}get rgb(){const{r:u,g:p,b:E,a:B}=this,q=B||1/0;return this.overwriteGetter("rgb",[u/q,p/q,E/q,B])}get hcl(){return this.overwriteGetter("hcl",function(u){const[p,E,B,q]=ti(u),W=Math.sqrt(E*E+B*B);return[Math.round(1e4*W)?fi(Math.atan2(B,E)*di):NaN,W,p,q]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ti(this.rgb))}overwriteGetter(u,p){return Object.defineProperty(this,u,{value:p}),p}toString(){const[u,p,E,B]=this.rgb;return`rgba(${[u,p,E].map(q=>Math.round(255*q)).join(",")},${B})`}}Qi.black=new Qi(0,0,0,1),Qi.white=new Qi(1,1,1,1),Qi.transparent=new Qi(0,0,0,0),Qi.red=new Qi(1,0,0,1);class hr{constructor(u,p,E){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=E,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gn{constructor(u,p,E,B,q){this.text=u,this.image=p,this.scale=E,this.fontStack=B,this.textColor=q}}class Xt{constructor(u){this.sections=u}static fromString(u){return new Xt([new Gn(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Xt?u:Xt.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class en{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof en)return u;if(typeof u=="number")return new en([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const p of u)if(typeof p!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new en(u)}}toString(){return JSON.stringify(this.values)}}const qt=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class kn{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof kn)return u;if(Array.isArray(u)&&!(u.length<1)&&u.length%2==0){for(let p=0;p<u.length;p+=2){const E=u[p],B=u[p+1];if(typeof E!="string"||!qt.has(E)||!Array.isArray(B)||B.length!==2||typeof B[0]!="number"||typeof B[1]!="number")return}return new kn(u)}}toString(){return JSON.stringify(this.values)}}class Ar{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new Ar({name:u,available:!1}):null}}function js(f,u,p,E){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?E===void 0||typeof E=="number"&&E>=0&&E<=1?null:`Invalid rgba value [${[f,u,p,E].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof E=="number"?[f,u,p,E]:[f,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qr(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof Qi||f instanceof hr||f instanceof Xt||f instanceof en||f instanceof kn||f instanceof Ar)return!0;if(Array.isArray(f)){for(const u of f)if(!Qr(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!Qr(f[u]))return!1;return!0}return!1}function Gt(f){if(f===null)return $e;if(typeof f=="string")return We;if(typeof f=="boolean")return Ge;if(typeof f=="number")return je;if(f instanceof Qi)return mt;if(f instanceof hr)return ae;if(f instanceof Xt)return re;if(f instanceof en)return X;if(f instanceof kn)return pe;if(f instanceof Ar)return ne;if(Array.isArray(f)){const u=f.length;let p;for(const E of f){const B=Gt(E);if(p){if(p===B)continue;p=Pe;break}p=B}return xe(p||Pe,u)}return ot}function fr(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof Qi||f instanceof Xt||f instanceof en||f instanceof kn||f instanceof Ar?f.toString():JSON.stringify(f)}class Bt{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!Qr(u[1]))return p.error("invalid value");const E=u[1];let B=Gt(E);const q=p.expectedType;return B.kind!=="array"||B.N!==0||!q||q.kind!=="array"||typeof q.N=="number"&&q.N!==0||(B=q),new Bt(B,E)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Gr{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const Zs={string:We,number:je,boolean:Ge,object:ot};class pa{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let E,B=1;const q=u[0];if(q==="array"){let se,fe;if(u.length>2){const ve=u[1];if(typeof ve!="string"||!(ve in Zs)||ve==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);se=Zs[ve],B++}else se=Pe;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);fe=u[2],B++}E=xe(se,fe)}else{if(!Zs[q])throw new Error(`Types doesn't contain name = ${q}`);E=Zs[q]}const W=[];for(;B<u.length;B++){const se=p.parse(u[B],B,Pe);if(!se)return null;W.push(se)}return new pa(E,W)}evaluate(u){for(let p=0;p<this.args.length;p++){const E=this.args[p].evaluate(u);if(!Oe(this.type,Gt(E)))return E;if(p===this.args.length-1)throw new Gr(`Expected value to be of type ${ye(this.type)}, but found ${ye(Gt(E))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Fr={"to-boolean":Ge,"to-color":mt,"to-number":je,"to-string":We};class Za{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const E=u[0];if(!Fr[E])throw new Error(`Can't parse ${E} as it is not part of the known types`);if((E==="to-boolean"||E==="to-string")&&u.length!==2)return p.error("Expected one argument.");const B=Fr[E],q=[];for(let W=1;W<u.length;W++){const se=p.parse(u[W],W,Pe);if(!se)return null;q.push(se)}return new Za(B,q)}evaluate(u){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(u);case"color":{let p,E;for(const B of this.args){if(p=B.evaluate(u),E=null,p instanceof Qi)return p;if(typeof p=="string"){const q=u.parseColor(p);if(q)return q}else if(Array.isArray(p)&&(E=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:js(p[0],p[1],p[2],p[3]),!E))return new Qi(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Gr(E||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const E of this.args){p=E.evaluate(u);const B=en.parse(p);if(B)return B}throw new Gr(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const E of this.args){p=E.evaluate(u);const B=kn.parse(p);if(B)return B}throw new Gr(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const E of this.args){if(p=E.evaluate(u),p===null)return 0;const B=Number(p);if(!isNaN(B))return B}throw new Gr(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return Xt.fromString(fr(this.args[0].evaluate(u)));case"resolvedImage":return Ar.fromString(fr(this.args[0].evaluate(u)));default:return fr(this.args[0].evaluate(u))}}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Oo=["Unknown","Point","LineString","Polygon"];class Qa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Oo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=Qi.parse(u)),p}}class ia{constructor(u,p,E=[],B,q=new Re,W=[]){this.registry=u,this.path=E,this.key=E.map(se=>`[${se}]`).join(""),this.scope=q,this.errors=W,this.expectedType=B,this._isConstant=p}parse(u,p,E,B,q={}){return p?this.concat(p,E,B)._parse(u,q):this._parse(u,q)}_parse(u,p){function E(B,q,W){return W==="assert"?new pa(q,[B]):W==="coerce"?new Za(q,[B]):B}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const B=u[0];if(typeof B!="string")return this.error(`Expression name must be a string, but found ${typeof B} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const q=this.registry[B];if(q){let W=q.parse(u,this);if(!W)return null;if(this.expectedType){const se=this.expectedType,fe=W.type;if(se.kind!=="string"&&se.kind!=="number"&&se.kind!=="boolean"&&se.kind!=="object"&&se.kind!=="array"||fe.kind!=="value")if(se.kind!=="color"&&se.kind!=="formatted"&&se.kind!=="resolvedImage"||fe.kind!=="value"&&fe.kind!=="string")if(se.kind!=="padding"||fe.kind!=="value"&&fe.kind!=="number"&&fe.kind!=="array")if(se.kind!=="variableAnchorOffsetCollection"||fe.kind!=="value"&&fe.kind!=="array"){if(this.checkSubtype(se,fe))return null}else W=E(W,se,p.typeAnnotation||"coerce");else W=E(W,se,p.typeAnnotation||"coerce");else W=E(W,se,p.typeAnnotation||"coerce");else W=E(W,se,p.typeAnnotation||"assert")}if(!(W instanceof Bt)&&W.type.kind!=="resolvedImage"&&this._isConstant(W)){const se=new Qa;try{W=new Bt(W.type,W.evaluate(se))}catch(fe){return this.error(fe.message),null}}return W}return this.error(`Unknown expression "${B}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,E){const B=typeof u=="number"?this.path.concat(u):this.path,q=E?this.scope.concat(E):this.scope;return new ia(this.registry,this._isConstant,B,p||null,q,this.errors)}error(u,...p){const E=`${this.key}${p.map(B=>`[${B}]`).join("")}`;this.errors.push(new Ce(E,u))}checkSubtype(u,p){const E=Oe(u,p);return E&&this.error(E),E}}class Qn{constructor(u,p,E){this.type=ae,this.locale=E,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const E=u[1];if(typeof E!="object"||Array.isArray(E))return p.error("Collator options argument must be an object.");const B=p.parse(E["case-sensitive"]!==void 0&&E["case-sensitive"],1,Ge);if(!B)return null;const q=p.parse(E["diacritic-sensitive"]!==void 0&&E["diacritic-sensitive"],1,Ge);if(!q)return null;let W=null;return E.locale&&(W=p.parse(E.locale,1,We),!W)?null:new Qn(B,q,W)}evaluate(u){return new hr(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const Aa=8192;function ds(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function Wa(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function ol(f,u){const p=(180+f[0])/360,E=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,B=Math.pow(2,u.z);return[Math.round(p*B*Aa),Math.round(E*B*Aa)]}function ll(f,u,p){const E=f[0]-u[0],B=f[1]-u[1],q=f[0]-p[0],W=f[1]-p[1];return E*W-q*B==0&&E*q<=0&&B*W<=0}function lo(f,u){let p=!1;for(let W=0,se=u.length;W<se;W++){const fe=u[W];for(let ve=0,Be=fe.length;ve<Be-1;ve++){if(ll(f,fe[ve],fe[ve+1]))return!1;(B=fe[ve])[1]>(E=f)[1]!=(q=fe[ve+1])[1]>E[1]&&E[0]<(q[0]-B[0])*(E[1]-B[1])/(q[1]-B[1])+B[0]&&(p=!p)}}var E,B,q;return p}function $a(f,u){for(let p=0;p<u.length;p++)if(lo(f,u[p]))return!0;return!1}function G(f,u,p,E){const B=E[0]-p[0],q=E[1]-p[1],W=(f[0]-p[0])*q-B*(f[1]-p[1]),se=(u[0]-p[0])*q-B*(u[1]-p[1]);return W>0&&se<0||W<0&&se>0}function we(f,u,p){for(const ve of p)for(let Be=0;Be<ve.length-1;++Be)if((se=[(W=ve[Be+1])[0]-(q=ve[Be])[0],W[1]-q[1]])[0]*(fe=[(B=u)[0]-(E=f)[0],B[1]-E[1]])[1]-se[1]*fe[0]!=0&&G(E,B,q,W)&&G(q,W,E,B))return!0;var E,B,q,W,se,fe;return!1}function at(f,u){for(let p=0;p<f.length;++p)if(!lo(f[p],u))return!1;for(let p=0;p<f.length-1;++p)if(we(f[p],f[p+1],u))return!1;return!0}function Ct(f,u){for(let p=0;p<u.length;p++)if(at(f,u[p]))return!0;return!1}function Yt(f,u,p){const E=[];for(let B=0;B<f.length;B++){const q=[];for(let W=0;W<f[B].length;W++){const se=ol(f[B][W],p);ds(u,se),q.push(se)}E.push(q)}return E}function Ii(f,u,p){const E=[];for(let B=0;B<f.length;B++){const q=Yt(f[B],u,p);E.push(q)}return E}function Li(f,u,p,E){if(f[0]<p[0]||f[0]>p[2]){const B=.5*E;let q=f[0]-p[0]>B?-E:p[0]-f[0]>B?E:0;q===0&&(q=f[0]-p[2]>B?-E:p[2]-f[0]>B?E:0),f[0]+=q}ds(u,f)}function An(f,u,p,E){const B=Math.pow(2,E.z)*Aa,q=[E.x*Aa,E.y*Aa],W=[];for(const se of f)for(const fe of se){const ve=[fe.x+q[0],fe.y+q[1]];Li(ve,u,p,B),W.push(ve)}return W}function pn(f,u,p,E){const B=Math.pow(2,E.z)*Aa,q=[E.x*Aa,E.y*Aa],W=[];for(const fe of f){const ve=[];for(const Be of fe){const He=[Be.x+q[0],Be.y+q[1]];ds(u,He),ve.push(He)}W.push(ve)}if(u[2]-u[0]<=B/2){(se=u)[0]=se[1]=1/0,se[2]=se[3]=-1/0;for(const fe of W)for(const ve of fe)Li(ve,u,p,B)}var se;return W}class or{constructor(u,p){this.type=Ge,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Qr(u[1])){const E=u[1];if(E.type==="FeatureCollection")for(let B=0;B<E.features.length;++B){const q=E.features[B].geometry.type;if(q==="Polygon"||q==="MultiPolygon")return new or(E,E.features[B].geometry)}else if(E.type==="Feature"){const B=E.geometry.type;if(B==="Polygon"||B==="MultiPolygon")return new or(E,E.geometry)}else if(E.type==="Polygon"||E.type==="MultiPolygon")return new or(E,E)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,E){const B=[1/0,1/0,-1/0,-1/0],q=[1/0,1/0,-1/0,-1/0],W=p.canonicalID();if(E.type==="Polygon"){const se=Yt(E.coordinates,q,W),fe=An(p.geometry(),B,q,W);if(!Wa(B,q))return!1;for(const ve of fe)if(!lo(ve,se))return!1}if(E.type==="MultiPolygon"){const se=Ii(E.coordinates,q,W),fe=An(p.geometry(),B,q,W);if(!Wa(B,q))return!1;for(const ve of fe)if(!$a(ve,se))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,E){const B=[1/0,1/0,-1/0,-1/0],q=[1/0,1/0,-1/0,-1/0],W=p.canonicalID();if(E.type==="Polygon"){const se=Yt(E.coordinates,q,W),fe=pn(p.geometry(),B,q,W);if(!Wa(B,q))return!1;for(const ve of fe)if(!at(ve,se))return!1}if(E.type==="MultiPolygon"){const se=Ii(E.coordinates,q,W),fe=pn(p.geometry(),B,q,W);if(!Wa(B,q))return!1;for(const ve of fe)if(!Ct(ve,se))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class dr{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const E=u[1];return p.scope.has(E)?new dr(E,p.scope.get(E)):p.error(`Unknown variable "${E}". Make sure "${E}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class qr{constructor(u,p,E,B){this.name=u,this.type=p,this._evaluate=E,this.args=B}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,p){const E=u[0],B=qr.definitions[E];if(!B)return p.error(`Unknown expression "${E}". If you wanted a literal array, use ["literal", [...]].`,0);const q=Array.isArray(B)?B[0]:B.type,W=Array.isArray(B)?[[B[1],B[2]]]:B.overloads,se=W.filter(([ve])=>!Array.isArray(ve)||ve.length===u.length-1);let fe=null;for(const[ve,Be]of se){fe=new ia(p.registry,Xa,p.path,null,p.scope);const He=[];let it=!1;for(let pt=1;pt<u.length;pt++){const vt=u[pt],Dt=Array.isArray(ve)?ve[pt-1]:ve.type,Lt=fe.parse(vt,1+He.length,Dt);if(!Lt){it=!0;break}He.push(Lt)}if(!it)if(Array.isArray(ve)&&ve.length!==He.length)fe.error(`Expected ${ve.length} arguments, but found ${He.length} instead.`);else{for(let pt=0;pt<He.length;pt++){const vt=Array.isArray(ve)?ve[pt]:ve.type,Dt=He[pt];fe.concat(pt+1).checkSubtype(vt,Dt.type)}if(fe.errors.length===0)return new qr(E,q,Be,He)}}if(se.length===1)p.errors.push(...fe.errors);else{const ve=(se.length?se:W).map(([He])=>{return it=He,Array.isArray(it)?`(${it.map(ye).join(", ")})`:`(${ye(it.type)}...)`;var it}).join(" | "),Be=[];for(let He=1;He<u.length;He++){const it=p.parse(u[He],1+Be.length);if(!it)return null;Be.push(ye(it.type))}p.error(`Expected arguments of type ${ve}, but found (${Be.join(", ")}) instead.`)}return null}static register(u,p){qr.definitions=p;for(const E in p)u[E]=qr}}function Xa(f){if(f instanceof dr)return Xa(f.boundExpression);if(f instanceof qr&&f.name==="error"||f instanceof Qn||f instanceof or)return!1;const u=f instanceof Za||f instanceof pa;let p=!0;return f.eachChild(E=>{p=u?p&&Xa(E):p&&E instanceof Bt}),!!p&&Ya(f)&&ml(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ya(f){if(f instanceof qr&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof or)return!1;let u=!0;return f.eachChild(p=>{u&&!Ya(p)&&(u=!1)}),u}function Ka(f){if(f instanceof qr&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(p=>{u&&!Ka(p)&&(u=!1)}),u}function ml(f,u){if(f instanceof qr&&u.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(E=>{p&&!ml(E,u)&&(p=!1)}),p}function Wr(f,u){const p=f.length-1;let E,B,q=0,W=p,se=0;for(;q<=W;)if(se=Math.floor((q+W)/2),E=f[se],B=f[se+1],E<=u){if(se===p||u<B)return se;q=se+1}else{if(!(E>u))throw new Gr("Input is not a number.");W=se-1}return 0}class sr{constructor(u,p,E){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[B,q]of E)this.labels.push(B),this.outputs.push(q)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const E=p.parse(u[1],1,je);if(!E)return null;const B=[];let q=null;p.expectedType&&p.expectedType.kind!=="value"&&(q=p.expectedType);for(let W=1;W<u.length;W+=2){const se=W===1?-1/0:u[W],fe=u[W+1],ve=W,Be=W+1;if(typeof se!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ve);if(B.length&&B[B.length-1][0]>=se)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ve);const He=p.parse(fe,Be,q);if(!He)return null;q=q||He.type,B.push([se,He])}return new sr(q,E,B)}evaluate(u){const p=this.labels,E=this.outputs;if(p.length===1)return E[0].evaluate(u);const B=this.input.evaluate(u);if(B<=p[0])return E[0].evaluate(u);const q=p.length;return B>=p[q-1]?E[q-1].evaluate(u):E[Wr(p,B)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Mr(f,u,p){return f+p*(u-f)}function Or(f,u,p){return f.map((E,B)=>Mr(E,u[B],p))}const Ys={number:Mr,color:function(f,u,p,E="rgb"){switch(E){case"rgb":{const[B,q,W,se]=Or(f.rgb,u.rgb,p);return new Qi(B,q,W,se,!1)}case"hcl":{const[B,q,W,se]=f.hcl,[fe,ve,Be,He]=u.hcl;let it,pt;if(isNaN(B)||isNaN(fe))isNaN(B)?isNaN(fe)?it=NaN:(it=fe,W!==1&&W!==0||(pt=ve)):(it=B,Be!==1&&Be!==0||(pt=q));else{let ei=fe-B;fe>B&&ei>180?ei-=360:fe<B&&B-fe>180&&(ei+=360),it=B+p*ei}const[vt,Dt,Lt,Rt]=function([ei,Zt,Wt,hi]){return ei=isNaN(ei)?0:ei*li,bi([Wt,Math.cos(ei)*Zt,Math.sin(ei)*Zt,hi])}([it,pt??Mr(q,ve,p),Mr(W,Be,p),Mr(se,He,p)]);return new Qi(vt,Dt,Lt,Rt,!1)}case"lab":{const[B,q,W,se]=bi(Or(f.lab,u.lab,p));return new Qi(B,q,W,se,!1)}}},array:Or,padding:function(f,u,p){return new en(Or(f.values,u.values,p))},variableAnchorOffsetCollection:function(f,u,p){const E=f.values,B=u.values;if(E.length!==B.length)throw new Gr(`Cannot interpolate values of different length. from: ${f.toString()}, to: ${u.toString()}`);const q=[];for(let W=0;W<E.length;W+=2){if(E[W]!==B[W])throw new Gr(`Cannot interpolate values containing mismatched anchors. from[${W}]: ${E[W]}, to[${W}]: ${B[W]}`);q.push(E[W]);const[se,fe]=E[W+1],[ve,Be]=B[W+1];q.push([Mr(se,ve,p),Mr(fe,Be,p)])}return new kn(q)}};class Sr{constructor(u,p,E,B,q){this.type=u,this.operator=p,this.interpolation=E,this.input=B,this.labels=[],this.outputs=[];for(const[W,se]of q)this.labels.push(W),this.outputs.push(se)}static interpolationFactor(u,p,E,B){let q=0;if(u.name==="exponential")q=ra(p,u.base,E,B);else if(u.name==="linear")q=ra(p,1,E,B);else if(u.name==="cubic-bezier"){const W=u.controlPoints;q=new nt(W[0],W[1],W[2],W[3]).solve(ra(p,1,E,B))}return q}static parse(u,p){let[E,B,q,...W]=u;if(!Array.isArray(B)||B.length===0)return p.error("Expected an interpolation type expression.",1);if(B[0]==="linear")B={name:"linear"};else if(B[0]==="exponential"){const ve=B[1];if(typeof ve!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);B={name:"exponential",base:ve}}else{if(B[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(B[0])}`,1,0);{const ve=B.slice(1);if(ve.length!==4||ve.some(Be=>typeof Be!="number"||Be<0||Be>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);B={name:"cubic-bezier",controlPoints:ve}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(q=p.parse(q,2,je),!q)return null;const se=[];let fe=null;E==="interpolate-hcl"||E==="interpolate-lab"?fe=mt:p.expectedType&&p.expectedType.kind!=="value"&&(fe=p.expectedType);for(let ve=0;ve<W.length;ve+=2){const Be=W[ve],He=W[ve+1],it=ve+3,pt=ve+4;if(typeof Be!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',it);if(se.length&&se[se.length-1][0]>=Be)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',it);const vt=p.parse(He,pt,fe);if(!vt)return null;fe=fe||vt.type,se.push([Be,vt])}return et(fe,je)||et(fe,mt)||et(fe,X)||et(fe,pe)||et(fe,xe(je))?new Sr(fe,E,B,q,se):p.error(`Type ${ye(fe)} is not interpolatable.`)}evaluate(u){const p=this.labels,E=this.outputs;if(p.length===1)return E[0].evaluate(u);const B=this.input.evaluate(u);if(B<=p[0])return E[0].evaluate(u);const q=p.length;if(B>=p[q-1])return E[q-1].evaluate(u);const W=Wr(p,B),se=Sr.interpolationFactor(this.interpolation,B,p[W],p[W+1]),fe=E[W].evaluate(u),ve=E[W+1].evaluate(u);switch(this.operator){case"interpolate":return Ys[this.type.kind](fe,ve,se);case"interpolate-hcl":return Ys.color(fe,ve,se,"hcl");case"interpolate-lab":return Ys.color(fe,ve,se,"lab")}}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function ra(f,u,p,E){const B=E-p,q=f-p;return B===0?0:u===1?q/B:(Math.pow(u,q)-1)/(Math.pow(u,B)-1)}class Nr{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let E=null;const B=p.expectedType;B&&B.kind!=="value"&&(E=B);const q=[];for(const se of u.slice(1)){const fe=p.parse(se,1+q.length,E,void 0,{typeAnnotation:"omit"});if(!fe)return null;E=E||fe.type,q.push(fe)}if(!E)throw new Error("No output type");const W=B&&q.some(se=>Oe(B,se.type));return new Nr(W?Pe:E,q)}evaluate(u){let p,E=null,B=0;for(const q of this.args)if(B++,E=q.evaluate(u),E&&E instanceof Ar&&!E.available&&(p||(p=E.name),E=null,B===this.args.length&&(E=p)),E!==null)break;return E}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class ko{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const E=[];for(let q=1;q<u.length-1;q+=2){const W=u[q];if(typeof W!="string")return p.error(`Expected string, but found ${typeof W} instead.`,q);if(/[^a-zA-Z0-9_]/.test(W))return p.error("Variable names must contain only alphanumeric characters or '_'.",q);const se=p.parse(u[q+1],q+1);if(!se)return null;E.push([W,se])}const B=p.parse(u[u.length-1],u.length-1,p.expectedType,E);return B?new ko(E,B):null}outputDefined(){return this.result.outputDefined()}}class Qo{constructor(u,p,E){this.type=u,this.index=p,this.input=E}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const E=p.parse(u[1],1,je),B=p.parse(u[2],2,xe(p.expectedType||Pe));return E&&B?new Qo(B.type.itemType,E,B):null}evaluate(u){const p=this.index.evaluate(u),E=this.input.evaluate(u);if(p<0)throw new Gr(`Array index out of bounds: ${p} < 0.`);if(p>=E.length)throw new Gr(`Array index out of bounds: ${p} > ${E.length-1}.`);if(p!==Math.floor(p))throw new Gr(`Array index must be an integer, but found ${p} instead.`);return E[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Ns{constructor(u,p){this.type=Ge,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const E=p.parse(u[1],1,Pe),B=p.parse(u[2],2,Pe);return E&&B?Ve(E.type,[Ge,We,je,$e,Pe])?new Ns(E,B):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ye(E.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),E=this.haystack.evaluate(u);if(!E)return!1;if(!Je(p,["boolean","string","number","null"]))throw new Gr(`Expected first argument to be of type boolean, string, number or null, but found ${ye(Gt(p))} instead.`);if(!Je(E,["string","array"]))throw new Gr(`Expected second argument to be of type array or string, but found ${ye(Gt(E))} instead.`);return E.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class Tl{constructor(u,p,E){this.type=je,this.needle=u,this.haystack=p,this.fromIndex=E}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const E=p.parse(u[1],1,Pe),B=p.parse(u[2],2,Pe);if(!E||!B)return null;if(!Ve(E.type,[Ge,We,je,$e,Pe]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ye(E.type)} instead`);if(u.length===4){const q=p.parse(u[3],3,je);return q?new Tl(E,B,q):null}return new Tl(E,B)}evaluate(u){const p=this.needle.evaluate(u),E=this.haystack.evaluate(u);if(!Je(p,["boolean","string","number","null"]))throw new Gr(`Expected first argument to be of type boolean, string, number or null, but found ${ye(Gt(p))} instead.`);if(!Je(E,["string","array"]))throw new Gr(`Expected second argument to be of type array or string, but found ${ye(Gt(E))} instead.`);if(this.fromIndex){const B=this.fromIndex.evaluate(u);return E.indexOf(p,B)}return E.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class yo{constructor(u,p,E,B,q,W){this.inputType=u,this.type=p,this.input=E,this.cases=B,this.outputs=q,this.otherwise=W}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let E,B;p.expectedType&&p.expectedType.kind!=="value"&&(B=p.expectedType);const q={},W=[];for(let ve=2;ve<u.length-1;ve+=2){let Be=u[ve];const He=u[ve+1];Array.isArray(Be)||(Be=[Be]);const it=p.concat(ve);if(Be.length===0)return it.error("Expected at least one branch label.");for(const vt of Be){if(typeof vt!="number"&&typeof vt!="string")return it.error("Branch labels must be numbers or strings.");if(typeof vt=="number"&&Math.abs(vt)>Number.MAX_SAFE_INTEGER)return it.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof vt=="number"&&Math.floor(vt)!==vt)return it.error("Numeric branch labels must be integer values.");if(E){if(it.checkSubtype(E,Gt(vt)))return null}else E=Gt(vt);if(q[String(vt)]!==void 0)return it.error("Branch labels must be unique.");q[String(vt)]=W.length}const pt=p.parse(He,ve,B);if(!pt)return null;B=B||pt.type,W.push(pt)}const se=p.parse(u[1],1,Pe);if(!se)return null;const fe=p.parse(u[u.length-1],u.length-1,B);return fe?se.type.kind!=="value"&&p.concat(1).checkSubtype(E,se.type)?null:new yo(E,B,se,q,W,fe):null}evaluate(u){const p=this.input.evaluate(u);return(Gt(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class Wo{constructor(u,p,E){this.type=u,this.branches=p,this.otherwise=E}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let E;p.expectedType&&p.expectedType.kind!=="value"&&(E=p.expectedType);const B=[];for(let W=1;W<u.length-1;W+=2){const se=p.parse(u[W],W,Ge);if(!se)return null;const fe=p.parse(u[W+1],W+1,E);if(!fe)return null;B.push([se,fe]),E=E||fe.type}const q=p.parse(u[u.length-1],u.length-1,E);if(!q)return null;if(!E)throw new Error("Can't infer output type");return new Wo(E,B,q)}evaluate(u){for(const[p,E]of this.branches)if(p.evaluate(u))return E.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,E]of this.branches)u(p),u(E);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class ma{constructor(u,p,E,B){this.type=u,this.input=p,this.beginIndex=E,this.endIndex=B}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const E=p.parse(u[1],1,Pe),B=p.parse(u[2],2,je);if(!E||!B)return null;if(!Ve(E.type,[xe(Pe),We,Pe]))return p.error(`Expected first argument to be of type array or string, but found ${ye(E.type)} instead`);if(u.length===4){const q=p.parse(u[3],3,je);return q?new ma(E.type,E,B,q):null}return new ma(E.type,E,B)}evaluate(u){const p=this.input.evaluate(u),E=this.beginIndex.evaluate(u);if(!Je(p,["string","array"]))throw new Gr(`Expected first argument to be of type array or string, but found ${ye(Gt(p))} instead.`);if(this.endIndex){const B=this.endIndex.evaluate(u);return p.slice(E,B)}return p.slice(E)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function na(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function kl(f,u,p,E){return E.compare(u,p)===0}function Ja(f,u,p){const E=f!=="=="&&f!=="!=";return class b5{constructor(q,W,se){this.type=Ge,this.lhs=q,this.rhs=W,this.collator=se,this.hasUntypedArgument=q.type.kind==="value"||W.type.kind==="value"}static parse(q,W){if(q.length!==3&&q.length!==4)return W.error("Expected two or three arguments.");const se=q[0];let fe=W.parse(q[1],1,Pe);if(!fe)return null;if(!na(se,fe.type))return W.concat(1).error(`"${se}" comparisons are not supported for type '${ye(fe.type)}'.`);let ve=W.parse(q[2],2,Pe);if(!ve)return null;if(!na(se,ve.type))return W.concat(2).error(`"${se}" comparisons are not supported for type '${ye(ve.type)}'.`);if(fe.type.kind!==ve.type.kind&&fe.type.kind!=="value"&&ve.type.kind!=="value")return W.error(`Cannot compare types '${ye(fe.type)}' and '${ye(ve.type)}'.`);E&&(fe.type.kind==="value"&&ve.type.kind!=="value"?fe=new pa(ve.type,[fe]):fe.type.kind!=="value"&&ve.type.kind==="value"&&(ve=new pa(fe.type,[ve])));let Be=null;if(q.length===4){if(fe.type.kind!=="string"&&ve.type.kind!=="string"&&fe.type.kind!=="value"&&ve.type.kind!=="value")return W.error("Cannot use collator to compare non-string types.");if(Be=W.parse(q[3],3,ae),!Be)return null}return new b5(fe,ve,Be)}evaluate(q){const W=this.lhs.evaluate(q),se=this.rhs.evaluate(q);if(E&&this.hasUntypedArgument){const fe=Gt(W),ve=Gt(se);if(fe.kind!==ve.kind||fe.kind!=="string"&&fe.kind!=="number")throw new Gr(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${fe.kind}, ${ve.kind}) instead.`)}if(this.collator&&!E&&this.hasUntypedArgument){const fe=Gt(W),ve=Gt(se);if(fe.kind!=="string"||ve.kind!=="string")return u(q,W,se)}return this.collator?p(q,W,se,this.collator.evaluate(q)):u(q,W,se)}eachChild(q){q(this.lhs),q(this.rhs),this.collator&&q(this.collator)}outputDefined(){return!0}}}const Fa=Ja("==",function(f,u,p){return u===p},kl),gl=Ja("!=",function(f,u,p){return u!==p},function(f,u,p,E){return!kl(0,u,p,E)}),Ml=Ja("<",function(f,u,p){return u<p},function(f,u,p,E){return E.compare(u,p)<0}),yu=Ja(">",function(f,u,p){return u>p},function(f,u,p,E){return E.compare(u,p)>0}),ps=Ja("<=",function(f,u,p){return u<=p},function(f,u,p,E){return E.compare(u,p)<=0}),lc=Ja(">=",function(f,u,p){return u>=p},function(f,u,p,E){return E.compare(u,p)>=0});class uo{constructor(u,p,E,B,q){this.type=We,this.number=u,this.locale=p,this.currency=E,this.minFractionDigits=B,this.maxFractionDigits=q}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const E=p.parse(u[1],1,je);if(!E)return null;const B=u[2];if(typeof B!="object"||Array.isArray(B))return p.error("NumberFormat options argument must be an object.");let q=null;if(B.locale&&(q=p.parse(B.locale,1,We),!q))return null;let W=null;if(B.currency&&(W=p.parse(B.currency,1,We),!W))return null;let se=null;if(B["min-fraction-digits"]&&(se=p.parse(B["min-fraction-digits"],1,je),!se))return null;let fe=null;return B["max-fraction-digits"]&&(fe=p.parse(B["max-fraction-digits"],1,je),!fe)?null:new uo(E,q,W,se,fe)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class co{constructor(u){this.type=re,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const E=u[1];if(!Array.isArray(E)&&typeof E=="object")return p.error("First argument must be an image or text section.");const B=[];let q=!1;for(let W=1;W<=u.length-1;++W){const se=u[W];if(q&&typeof se=="object"&&!Array.isArray(se)){q=!1;let fe=null;if(se["font-scale"]&&(fe=p.parse(se["font-scale"],1,je),!fe))return null;let ve=null;if(se["text-font"]&&(ve=p.parse(se["text-font"],1,xe(We)),!ve))return null;let Be=null;if(se["text-color"]&&(Be=p.parse(se["text-color"],1,mt),!Be))return null;const He=B[B.length-1];He.scale=fe,He.font=ve,He.textColor=Be}else{const fe=p.parse(u[W],1,Pe);if(!fe)return null;const ve=fe.type.kind;if(ve!=="string"&&ve!=="value"&&ve!=="null"&&ve!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");q=!0,B.push({content:fe,scale:null,font:null,textColor:null})}}return new co(B)}evaluate(u){return new Xt(this.sections.map(p=>{const E=p.content.evaluate(u);return Gt(E)===ne?new Gn("",E,null,null,null):new Gn(fr(E),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}}class Xl{constructor(u){this.type=ne,this.input=u}static parse(u,p){if(u.length!==2)return p.error("Expected two arguments.");const E=p.parse(u[1],1,We);return E?new Xl(E):p.error("No image name provided.")}evaluate(u){const p=this.input.evaluate(u),E=Ar.fromString(p);return E&&u.availableImages&&(E.available=u.availableImages.indexOf(p)>-1),E}eachChild(u){u(this.input)}outputDefined(){return!1}}class No{constructor(u){this.type=je,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const E=p.parse(u[1],1);return E?E.type.kind!=="array"&&E.type.kind!=="string"&&E.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${ye(E.type)} instead.`):new No(E):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Gr(`Expected value to be of type string or array, but found ${ye(Gt(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const $o={"==":Fa,"!=":gl,">":yu,"<":Ml,">=":lc,"<=":ps,array:pa,at:Qo,boolean:pa,case:Wo,coalesce:Nr,collator:Qn,format:co,image:Xl,in:Ns,"index-of":Tl,interpolate:Sr,"interpolate-hcl":Sr,"interpolate-lab":Sr,length:No,let:ko,literal:Bt,match:yo,number:pa,"number-format":uo,object:pa,slice:ma,step:sr,string:pa,"to-boolean":Za,"to-color":Za,"to-number":Za,"to-string":Za,var:dr,within:or};function Mo(f,[u,p,E,B]){u=u.evaluate(f),p=p.evaluate(f),E=E.evaluate(f);const q=B?B.evaluate(f):1,W=js(u,p,E,q);if(W)throw new Gr(W);return new Qi(u/255,p/255,E/255,q,!1)}function Qs(f,u){return f in u}function Xo(f,u){const p=u[f];return p===void 0?null:p}function Yo(f){return{type:f}}function Ko(f){return{result:"success",value:f}}function Ta(f){return{result:"error",value:f}}function eo(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Ds(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function vu(f){return!!f.expression&&f.expression.interpolated}function Pr(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Kn(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function Jo(f){return f}function Vr(f,u){const p=u.type==="color",E=f.stops&&typeof f.stops[0][0]=="object",B=E||!(E||f.property!==void 0),q=f.type||(vu(u)?"exponential":"interval");if(p||u.type==="padding"){const Be=p?Qi.parse:en.parse;(f=Ee({},f)).stops&&(f.stops=f.stops.map(He=>[He[0],Be(He[1])])),f.default=Be(f.default?f.default:u.default)}if(f.colorSpace&&(W=f.colorSpace)!=="rgb"&&W!=="hcl"&&W!=="lab")throw new Error(`Unknown color space: "${f.colorSpace}"`);var W;let se,fe,ve;if(q==="exponential")se=Po;else if(q==="interval")se=pr;else if(q==="categorical"){se=ss,fe=Object.create(null);for(const Be of f.stops)fe[Be[0]]=Be[1];ve=typeof f.stops[0][0]}else{if(q!=="identity")throw new Error(`Unknown function type "${q}"`);se=qn}if(E){const Be={},He=[];for(let vt=0;vt<f.stops.length;vt++){const Dt=f.stops[vt],Lt=Dt[0].zoom;Be[Lt]===void 0&&(Be[Lt]={zoom:Lt,type:f.type,property:f.property,default:f.default,stops:[]},He.push(Lt)),Be[Lt].stops.push([Dt[0].value,Dt[1]])}const it=[];for(const vt of He)it.push([Be[vt].zoom,Vr(Be[vt],u)]);const pt={name:"linear"};return{kind:"composite",interpolationType:pt,interpolationFactor:Sr.interpolationFactor.bind(void 0,pt),zoomStops:it.map(vt=>vt[0]),evaluate:({zoom:vt},Dt)=>Po({stops:it,base:f.base},u,vt).evaluate(vt,Dt)}}if(B){const Be=q==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Be,interpolationFactor:Sr.interpolationFactor.bind(void 0,Be),zoomStops:f.stops.map(He=>He[0]),evaluate:({zoom:He})=>se(f,u,He,fe,ve)}}return{kind:"source",evaluate(Be,He){const it=He&&He.properties?He.properties[f.property]:void 0;return it===void 0?to(f.default,u.default):se(f,u,it,fe,ve)}}}function to(f,u,p){return f!==void 0?f:u!==void 0?u:p!==void 0?p:void 0}function ss(f,u,p,E,B){return to(typeof p===B?E[p]:void 0,f.default,u.default)}function pr(f,u,p){if(Pr(p)!=="number")return to(f.default,u.default);const E=f.stops.length;if(E===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[E-1][0])return f.stops[E-1][1];const B=Wr(f.stops.map(q=>q[0]),p);return f.stops[B][1]}function Po(f,u,p){const E=f.base!==void 0?f.base:1;if(Pr(p)!=="number")return to(f.default,u.default);const B=f.stops.length;if(B===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[B-1][0])return f.stops[B-1][1];const q=Wr(f.stops.map(Be=>Be[0]),p),W=function(Be,He,it,pt){const vt=pt-it,Dt=Be-it;return vt===0?0:He===1?Dt/vt:(Math.pow(He,Dt)-1)/(Math.pow(He,vt)-1)}(p,E,f.stops[q][0],f.stops[q+1][0]),se=f.stops[q][1],fe=f.stops[q+1][1],ve=Ys[u.type]||Jo;return typeof se.evaluate=="function"?{evaluate(...Be){const He=se.evaluate.apply(void 0,Be),it=fe.evaluate.apply(void 0,Be);if(He!==void 0&&it!==void 0)return ve(He,it,W,f.colorSpace)}}:ve(se,fe,W,f.colorSpace)}function qn(f,u,p){switch(u.type){case"color":p=Qi.parse(p);break;case"formatted":p=Xt.fromString(p.toString());break;case"resolvedImage":p=Ar.fromString(p.toString());break;case"padding":p=en.parse(p);break;default:Pr(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0)}return to(p,f.default,u.default)}qr.register($o,{error:[{kind:"error"},[We],(f,[u])=>{throw new Gr(u.evaluate(f))}],typeof:[We,[Pe],(f,[u])=>ye(Gt(u.evaluate(f)))],"to-rgba":[xe(je,4),[mt],(f,[u])=>{const[p,E,B,q]=u.evaluate(f).rgb;return[255*p,255*E,255*B,q]}],rgb:[mt,[je,je,je],Mo],rgba:[mt,[je,je,je,je],Mo],has:{type:Ge,overloads:[[[We],(f,[u])=>Qs(u.evaluate(f),f.properties())],[[We,ot],(f,[u,p])=>Qs(u.evaluate(f),p.evaluate(f))]]},get:{type:Pe,overloads:[[[We],(f,[u])=>Xo(u.evaluate(f),f.properties())],[[We,ot],(f,[u,p])=>Xo(u.evaluate(f),p.evaluate(f))]]},"feature-state":[Pe,[We],(f,[u])=>Xo(u.evaluate(f),f.featureState||{})],properties:[ot,[],f=>f.properties()],"geometry-type":[We,[],f=>f.geometryType()],id:[Pe,[],f=>f.id()],zoom:[je,[],f=>f.globals.zoom],"heatmap-density":[je,[],f=>f.globals.heatmapDensity||0],"line-progress":[je,[],f=>f.globals.lineProgress||0],accumulated:[Pe,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[je,Yo(je),(f,u)=>{let p=0;for(const E of u)p+=E.evaluate(f);return p}],"*":[je,Yo(je),(f,u)=>{let p=1;for(const E of u)p*=E.evaluate(f);return p}],"-":{type:je,overloads:[[[je,je],(f,[u,p])=>u.evaluate(f)-p.evaluate(f)],[[je],(f,[u])=>-u.evaluate(f)]]},"/":[je,[je,je],(f,[u,p])=>u.evaluate(f)/p.evaluate(f)],"%":[je,[je,je],(f,[u,p])=>u.evaluate(f)%p.evaluate(f)],ln2:[je,[],()=>Math.LN2],pi:[je,[],()=>Math.PI],e:[je,[],()=>Math.E],"^":[je,[je,je],(f,[u,p])=>Math.pow(u.evaluate(f),p.evaluate(f))],sqrt:[je,[je],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[je,[je],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[je,[je],(f,[u])=>Math.log(u.evaluate(f))],log2:[je,[je],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[je,[je],(f,[u])=>Math.sin(u.evaluate(f))],cos:[je,[je],(f,[u])=>Math.cos(u.evaluate(f))],tan:[je,[je],(f,[u])=>Math.tan(u.evaluate(f))],asin:[je,[je],(f,[u])=>Math.asin(u.evaluate(f))],acos:[je,[je],(f,[u])=>Math.acos(u.evaluate(f))],atan:[je,[je],(f,[u])=>Math.atan(u.evaluate(f))],min:[je,Yo(je),(f,u)=>Math.min(...u.map(p=>p.evaluate(f)))],max:[je,Yo(je),(f,u)=>Math.max(...u.map(p=>p.evaluate(f)))],abs:[je,[je],(f,[u])=>Math.abs(u.evaluate(f))],round:[je,[je],(f,[u])=>{const p=u.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[je,[je],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[je,[je],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[Ge,[We,Pe],(f,[u,p])=>f.properties()[u.value]===p.value],"filter-id-==":[Ge,[Pe],(f,[u])=>f.id()===u.value],"filter-type-==":[Ge,[We],(f,[u])=>f.geometryType()===u.value],"filter-<":[Ge,[We,Pe],(f,[u,p])=>{const E=f.properties()[u.value],B=p.value;return typeof E==typeof B&&E<B}],"filter-id-<":[Ge,[Pe],(f,[u])=>{const p=f.id(),E=u.value;return typeof p==typeof E&&p<E}],"filter->":[Ge,[We,Pe],(f,[u,p])=>{const E=f.properties()[u.value],B=p.value;return typeof E==typeof B&&E>B}],"filter-id->":[Ge,[Pe],(f,[u])=>{const p=f.id(),E=u.value;return typeof p==typeof E&&p>E}],"filter-<=":[Ge,[We,Pe],(f,[u,p])=>{const E=f.properties()[u.value],B=p.value;return typeof E==typeof B&&E<=B}],"filter-id-<=":[Ge,[Pe],(f,[u])=>{const p=f.id(),E=u.value;return typeof p==typeof E&&p<=E}],"filter->=":[Ge,[We,Pe],(f,[u,p])=>{const E=f.properties()[u.value],B=p.value;return typeof E==typeof B&&E>=B}],"filter-id->=":[Ge,[Pe],(f,[u])=>{const p=f.id(),E=u.value;return typeof p==typeof E&&p>=E}],"filter-has":[Ge,[Pe],(f,[u])=>u.value in f.properties()],"filter-has-id":[Ge,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[Ge,[xe(We)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[Ge,[xe(Pe)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[Ge,[We,xe(Pe)],(f,[u,p])=>p.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[Ge,[We,xe(Pe)],(f,[u,p])=>function(E,B,q,W){for(;q<=W;){const se=q+W>>1;if(B[se]===E)return!0;B[se]>E?W=se-1:q=se+1}return!1}(f.properties()[u.value],p.value,0,p.value.length-1)],all:{type:Ge,overloads:[[[Ge,Ge],(f,[u,p])=>u.evaluate(f)&&p.evaluate(f)],[Yo(Ge),(f,u)=>{for(const p of u)if(!p.evaluate(f))return!1;return!0}]]},any:{type:Ge,overloads:[[[Ge,Ge],(f,[u,p])=>u.evaluate(f)||p.evaluate(f)],[Yo(Ge),(f,u)=>{for(const p of u)if(p.evaluate(f))return!0;return!1}]]},"!":[Ge,[Ge],(f,[u])=>!u.evaluate(f)],"is-supported-script":[Ge,[We],(f,[u])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(u.evaluate(f))}],upcase:[We,[We],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[We,[We],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[We,Yo(Pe),(f,u)=>u.map(p=>fr(p.evaluate(f))).join("")],"resolved-locale":[We,[ae],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Ul{constructor(u,p){var E;this.expression=u,this._warningHistory={},this._evaluator=new Qa,this._defaultValue=p?(E=p).type==="color"&&Kn(E.default)?new Qi(0,0,0,0):E.type==="color"?Qi.parse(E.default)||null:E.type==="padding"?en.parse(E.default)||null:E.type==="variableAnchorOffsetCollection"?kn.parse(E.default)||null:E.default===void 0?null:E.default:null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,E,B,q,W){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=E,this._evaluator.canonical=B,this._evaluator.availableImages=q||null,this._evaluator.formattedSection=W,this.expression.evaluate(this._evaluator)}evaluate(u,p,E,B,q,W){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=E||null,this._evaluator.canonical=B,this._evaluator.availableImages=q||null,this._evaluator.formattedSection=W||null;try{const se=this.expression.evaluate(this._evaluator);if(se==null||typeof se=="number"&&se!=se)return this._defaultValue;if(this._enumValues&&!(se in this._enumValues))throw new Gr(`Expected value to be one of ${Object.keys(this._enumValues).map(fe=>JSON.stringify(fe)).join(", ")}, but found ${JSON.stringify(se)} instead.`);return se}catch(se){return this._warningHistory[se.message]||(this._warningHistory[se.message]=!0,typeof console<"u"&&console.warn(se.message)),this._defaultValue}}}function as(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in $o}function Kr(f,u){const p=new ia($o,Xa,[],u?function(B){const q={color:mt,string:We,number:je,enum:We,boolean:Ge,formatted:re,padding:X,resolvedImage:ne,variableAnchorOffsetCollection:pe};return B.type==="array"?xe(q[B.value]||Pe,B.length):q[B.type]}(u):void 0),E=p.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return E?Ko(new Ul(E,u)):Ta(p.errors)}class Ls{constructor(u,p){this.kind=u,this._styleExpression=p,this.isStateDependent=u!=="constant"&&!Ka(p.expression)}evaluateWithoutErrorHandling(u,p,E,B,q,W){return this._styleExpression.evaluateWithoutErrorHandling(u,p,E,B,q,W)}evaluate(u,p,E,B,q,W){return this._styleExpression.evaluate(u,p,E,B,q,W)}}class Br{constructor(u,p,E,B){this.kind=u,this.zoomStops=E,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!Ka(p.expression),this.interpolationType=B}evaluateWithoutErrorHandling(u,p,E,B,q,W){return this._styleExpression.evaluateWithoutErrorHandling(u,p,E,B,q,W)}evaluate(u,p,E,B,q,W){return this._styleExpression.evaluate(u,p,E,B,q,W)}interpolationFactor(u,p,E){return this.interpolationType?Sr.interpolationFactor(this.interpolationType,u,p,E):0}}function ar(f,u){const p=Kr(f,u);if(p.result==="error")return p;const E=p.value.expression,B=Ya(E);if(!B&&!eo(u))return Ta([new Ce("","data expressions not supported")]);const q=ml(E,["zoom"]);if(!q&&!Ds(u))return Ta([new Ce("","zoom expressions not supported")]);const W=is(E);return W||q?W instanceof Ce?Ta([W]):W instanceof Sr&&!vu(u)?Ta([new Ce("",'"interpolate" expressions cannot be used with this property')]):Ko(W?new Br(B?"camera":"composite",p.value,W.labels,W instanceof Sr?W.interpolation:void 0):new Ls(B?"constant":"source",p.value)):Ta([new Ce("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ul{constructor(u,p){this._parameters=u,this._specification=p,Ee(this,Vr(this._parameters,this._specification))}static deserialize(u){return new ul(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function is(f){let u=null;if(f instanceof ko)u=is(f.result);else if(f instanceof Nr){for(const p of f.args)if(u=is(p),u)break}else(f instanceof sr||f instanceof Sr)&&f.input instanceof qr&&f.input.name==="zoom"&&(u=f);return u instanceof Ce||f.eachChild(p=>{const E=is(p);E instanceof Ce?u=E:!u&&E?u=new Ce("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&E&&u!==E&&(u=new Ce("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function Do(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!Do(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const cl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Jr(f){if(f==null)return{filter:()=>!0,needGeometry:!1};Do(f)||(f=Pl(f));const u=Kr(f,cl);if(u.result==="error")throw new Error(u.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,E,B)=>u.value.evaluate(p,E,{},B),needGeometry:ka(f)}}function gs(f,u){return f<u?-1:f>u?1:0}function ka(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(ka(f[u]))return!0;return!1}function Pl(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?Lo(f[1],f[2],"=="):u==="!="?sa(Lo(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Lo(f[1],f[2],u):u==="any"?(p=f.slice(1),["any"].concat(p.map(Pl))):u==="all"?["all"].concat(f.slice(1).map(Pl)):u==="none"?["all"].concat(f.slice(1).map(Pl).map(sa)):u==="in"?Dl(f[1],f.slice(2)):u==="!in"?sa(Dl(f[1],f.slice(2))):u==="has"?vo(f[1]):u==="!has"?sa(vo(f[1])):u!=="within"||f;var p}function Lo(f,u,p){switch(f){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,f,u]}}function Dl(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",f,["literal",u.sort(gs)]]:["filter-in-small",f,["literal",u]]}}function vo(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function sa(f){return["!",f]}function Ws(f){const u=typeof f;if(u==="number"||u==="boolean"||u==="string"||f==null)return JSON.stringify(f);if(Array.isArray(f)){let B="[";for(const q of f)B+=`${Ws(q)},`;return`${B}]`}const p=Object.keys(f).sort();let E="{";for(let B=0;B<p.length;B++)E+=`${JSON.stringify(p[B])}:${Ws(f[p[B]])},`;return`${E}}`}function io(f){let u="";for(const p of Yi)u+=`/${Ws(f[p])}`;return u}function el(f){const u=f.value;return u?[new be(f.key,u,"constants have been deprecated as of v8")]:[]}function ns(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function vr(f){if(Array.isArray(f))return f.map(vr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const p in f)u[p]=vr(f[p]);return u}return ns(f)}function Hr(f){const u=f.key,p=f.value,E=f.valueSpec||{},B=f.objectElementValidators||{},q=f.style,W=f.styleSpec,se=f.validateSpec;let fe=[];const ve=Pr(p);if(ve!=="object")return[new be(u,p,`object expected, ${ve} found`)];for(const Be in p){const He=Be.split(".")[0],it=E[He]||E["*"];let pt;if(B[He])pt=B[He];else if(E[He])pt=se;else if(B["*"])pt=B["*"];else{if(!E["*"]){fe.push(new be(u,p[Be],`unknown property "${Be}"`));continue}pt=se}fe=fe.concat(pt({key:(u&&`${u}.`)+Be,value:p[Be],valueSpec:it,style:q,styleSpec:W,object:p,objectKey:Be,validateSpec:se},p))}for(const Be in E)B[Be]||E[Be].required&&E[Be].default===void 0&&p[Be]===void 0&&fe.push(new be(u,p,`missing required property "${Be}"`));return fe}function ga(f){const u=f.value,p=f.valueSpec,E=f.style,B=f.styleSpec,q=f.key,W=f.arrayElementValidator||f.validateSpec;if(Pr(u)!=="array")return[new be(q,u,`array expected, ${Pr(u)} found`)];if(p.length&&u.length!==p.length)return[new be(q,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new be(q,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let se={type:p.value,values:p.values};B.$version<7&&(se.function=p.function),Pr(p.value)==="object"&&(se=p.value);let fe=[];for(let ve=0;ve<u.length;ve++)fe=fe.concat(W({array:u,arrayIndex:ve,value:u[ve],valueSpec:se,validateSpec:f.validateSpec,style:E,styleSpec:B,key:`${q}[${ve}]`}));return fe}function xo(f){const u=f.key,p=f.value,E=f.valueSpec;let B=Pr(p);return B==="number"&&p!=p&&(B="NaN"),B!=="number"?[new be(u,p,`number expected, ${B} found`)]:"minimum"in E&&p<E.minimum?[new be(u,p,`${p} is less than the minimum value ${E.minimum}`)]:"maximum"in E&&p>E.maximum?[new be(u,p,`${p} is greater than the maximum value ${E.maximum}`)]:[]}function aa(f){const u=f.valueSpec,p=ns(f.value.type);let E,B,q,W={};const se=p!=="categorical"&&f.value.property===void 0,fe=!se,ve=Pr(f.value.stops)==="array"&&Pr(f.value.stops[0])==="array"&&Pr(f.value.stops[0][0])==="object",Be=Hr({key:f.key,value:f.value,valueSpec:f.styleSpec.function,validateSpec:f.validateSpec,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(pt){if(p==="identity")return[new be(pt.key,pt.value,'identity function may not have a "stops" property')];let vt=[];const Dt=pt.value;return vt=vt.concat(ga({key:pt.key,value:Dt,valueSpec:pt.valueSpec,validateSpec:pt.validateSpec,style:pt.style,styleSpec:pt.styleSpec,arrayElementValidator:He})),Pr(Dt)==="array"&&Dt.length===0&&vt.push(new be(pt.key,Dt,"array must have at least one stop")),vt},default:function(pt){return pt.validateSpec({key:pt.key,value:pt.value,valueSpec:u,validateSpec:pt.validateSpec,style:pt.style,styleSpec:pt.styleSpec})}}});return p==="identity"&&se&&Be.push(new be(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Be.push(new be(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!vu(f.valueSpec)&&Be.push(new be(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(fe&&!eo(f.valueSpec)?Be.push(new be(f.key,f.value,"property functions not supported")):se&&!Ds(f.valueSpec)&&Be.push(new be(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!ve||f.value.property!==void 0||Be.push(new be(f.key,f.value,'"property" property is required')),Be;function He(pt){let vt=[];const Dt=pt.value,Lt=pt.key;if(Pr(Dt)!=="array")return[new be(Lt,Dt,`array expected, ${Pr(Dt)} found`)];if(Dt.length!==2)return[new be(Lt,Dt,`array length 2 expected, length ${Dt.length} found`)];if(ve){if(Pr(Dt[0])!=="object")return[new be(Lt,Dt,`object expected, ${Pr(Dt[0])} found`)];if(Dt[0].zoom===void 0)return[new be(Lt,Dt,"object stop key must have zoom")];if(Dt[0].value===void 0)return[new be(Lt,Dt,"object stop key must have value")];if(q&&q>ns(Dt[0].zoom))return[new be(Lt,Dt[0].zoom,"stop zoom values must appear in ascending order")];ns(Dt[0].zoom)!==q&&(q=ns(Dt[0].zoom),B=void 0,W={}),vt=vt.concat(Hr({key:`${Lt}[0]`,value:Dt[0],valueSpec:{zoom:{}},validateSpec:pt.validateSpec,style:pt.style,styleSpec:pt.styleSpec,objectElementValidators:{zoom:xo,value:it}}))}else vt=vt.concat(it({key:`${Lt}[0]`,value:Dt[0],valueSpec:{},validateSpec:pt.validateSpec,style:pt.style,styleSpec:pt.styleSpec},Dt));return as(vr(Dt[1]))?vt.concat([new be(`${Lt}[1]`,Dt[1],"expressions are not allowed in function stops.")]):vt.concat(pt.validateSpec({key:`${Lt}[1]`,value:Dt[1],valueSpec:u,validateSpec:pt.validateSpec,style:pt.style,styleSpec:pt.styleSpec}))}function it(pt,vt){const Dt=Pr(pt.value),Lt=ns(pt.value),Rt=pt.value!==null?pt.value:vt;if(E){if(Dt!==E)return[new be(pt.key,Rt,`${Dt} stop domain type must match previous stop domain type ${E}`)]}else E=Dt;if(Dt!=="number"&&Dt!=="string"&&Dt!=="boolean")return[new be(pt.key,Rt,"stop domain value must be a number, string, or boolean")];if(Dt!=="number"&&p!=="categorical"){let ei=`number expected, ${Dt} found`;return eo(u)&&p===void 0&&(ei+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new be(pt.key,Rt,ei)]}return p!=="categorical"||Dt!=="number"||isFinite(Lt)&&Math.floor(Lt)===Lt?p!=="categorical"&&Dt==="number"&&B!==void 0&&Lt<B?[new be(pt.key,Rt,"stop domain values must appear in ascending order")]:(B=Lt,p==="categorical"&&Lt in W?[new be(pt.key,Rt,"stop domain values must be unique")]:(W[Lt]=!0,[])):[new be(pt.key,Rt,`integer expected, found ${Lt}`)]}}function Ma(f){const u=(f.expressionContext==="property"?ar:Kr)(vr(f.value),f.valueSpec);if(u.result==="error")return u.value.map(E=>new be(`${f.key}${E.key}`,f.value,E.message));const p=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new be(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Ka(p))return[new be(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Ka(p))return[new be(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!ml(p,["zoom","feature-state"]))return[new be(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!Ya(p))return[new be(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Oa(f){const u=f.key,p=f.value,E=f.valueSpec,B=[];return Array.isArray(E.values)?E.values.indexOf(ns(p))===-1&&B.push(new be(u,p,`expected one of [${E.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(E.values).indexOf(ns(p))===-1&&B.push(new be(u,p,`expected one of [${Object.keys(E.values).join(", ")}], ${JSON.stringify(p)} found`)),B}function no(f){return Do(vr(f.value))?Ma(Ee({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):hl(f)}function hl(f){const u=f.value,p=f.key;if(Pr(u)!=="array")return[new be(p,u,`array expected, ${Pr(u)} found`)];const E=f.styleSpec;let B,q=[];if(u.length<1)return[new be(p,u,"filter array must have at least 1 element")];switch(q=q.concat(Oa({key:`${p}[0]`,value:u[0],valueSpec:E.filter_operator,style:f.style,styleSpec:f.styleSpec})),ns(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&ns(u[1])==="$type"&&q.push(new be(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&q.push(new be(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(B=Pr(u[1]),B!=="string"&&q.push(new be(`${p}[1]`,u[1],`string expected, ${B} found`)));for(let W=2;W<u.length;W++)B=Pr(u[W]),ns(u[1])==="$type"?q=q.concat(Oa({key:`${p}[${W}]`,value:u[W],valueSpec:E.geometry_type,style:f.style,styleSpec:f.styleSpec})):B!=="string"&&B!=="number"&&B!=="boolean"&&q.push(new be(`${p}[${W}]`,u[W],`string, number, or boolean expected, ${B} found`));break;case"any":case"all":case"none":for(let W=1;W<u.length;W++)q=q.concat(hl({key:`${p}[${W}]`,value:u[W],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":B=Pr(u[1]),u.length!==2?q.push(new be(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):B!=="string"&&q.push(new be(`${p}[1]`,u[1],`string expected, ${B} found`));break;case"within":B=Pr(u[1]),u.length!==2?q.push(new be(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):B!=="object"&&q.push(new be(`${p}[1]`,u[1],`object expected, ${B} found`))}return q}function cu(f,u){const p=f.key,E=f.validateSpec,B=f.style,q=f.styleSpec,W=f.value,se=f.objectKey,fe=q[`${u}_${f.layerType}`];if(!fe)return[];const ve=se.match(/^(.*)-transition$/);if(u==="paint"&&ve&&fe[ve[1]]&&fe[ve[1]].transition)return E({key:p,value:W,valueSpec:q.transition,style:B,styleSpec:q});const Be=f.valueSpec||fe[se];if(!Be)return[new be(p,W,`unknown property "${se}"`)];let He;if(Pr(W)==="string"&&eo(Be)&&!Be.tokens&&(He=/^{([^}]+)}$/.exec(W)))return[new be(p,W,`"${se}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(He[1])} }\`.`)];const it=[];return f.layerType==="symbol"&&(se==="text-field"&&B&&!B.glyphs&&it.push(new be(p,W,'use of "text-field" requires a style "glyphs" property')),se==="text-font"&&Kn(vr(W))&&ns(W.type)==="identity"&&it.push(new be(p,W,'"text-font" does not support identity functions'))),it.concat(E({key:f.key,value:W,valueSpec:Be,style:B,styleSpec:q,expressionContext:"property",propertyType:u,propertyKey:se}))}function _l(f){return cu(f,"paint")}function ho(f){return cu(f,"layout")}function mi(f){let u=[];const p=f.value,E=f.key,B=f.style,q=f.styleSpec;p.type||p.ref||u.push(new be(E,p,'either "type" or "ref" is required'));let W=ns(p.type);const se=ns(p.ref);if(p.id){const fe=ns(p.id);for(let ve=0;ve<f.arrayIndex;ve++){const Be=B.layers[ve];ns(Be.id)===fe&&u.push(new be(E,p.id,`duplicate layer id "${p.id}", previously used at line ${Be.id.__line__}`))}}if("ref"in p){let fe;["type","source","source-layer","filter","layout"].forEach(ve=>{ve in p&&u.push(new be(E,p[ve],`"${ve}" is prohibited for ref layers`))}),B.layers.forEach(ve=>{ns(ve.id)===se&&(fe=ve)}),fe?fe.ref?u.push(new be(E,p.ref,"ref cannot reference another ref layer")):W=ns(fe.type):u.push(new be(E,p.ref,`ref layer "${se}" not found`))}else if(W!=="background")if(p.source){const fe=B.sources&&B.sources[p.source],ve=fe&&ns(fe.type);fe?ve==="vector"&&W==="raster"?u.push(new be(E,p.source,`layer "${p.id}" requires a raster source`)):ve!=="raster-dem"&&W==="hillshade"?u.push(new be(E,p.source,`layer "${p.id}" requires a raster-dem source`)):ve==="raster"&&W!=="raster"?u.push(new be(E,p.source,`layer "${p.id}" requires a vector source`)):ve!=="vector"||p["source-layer"]?ve==="raster-dem"&&W!=="hillshade"?u.push(new be(E,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):W!=="line"||!p.paint||!p.paint["line-gradient"]||ve==="geojson"&&fe.lineMetrics||u.push(new be(E,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new be(E,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new be(E,p.source,`source "${p.source}" not found`))}else u.push(new be(E,p,'missing required property "source"'));return u=u.concat(Hr({key:E,value:p,valueSpec:q.layer,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,objectElementValidators:{"*":()=>[],type:()=>f.validateSpec({key:`${E}.type`,value:p.type,valueSpec:q.layer.type,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,object:p,objectKey:"type"}),filter:no,layout:fe=>Hr({layer:p,key:fe.key,value:fe.value,style:fe.style,styleSpec:fe.styleSpec,validateSpec:fe.validateSpec,objectElementValidators:{"*":ve=>ho(Ee({layerType:W},ve))}}),paint:fe=>Hr({layer:p,key:fe.key,value:fe.value,style:fe.style,styleSpec:fe.styleSpec,validateSpec:fe.validateSpec,objectElementValidators:{"*":ve=>_l(Ee({layerType:W},ve))}})}})),u}function qi(f){const u=f.value,p=f.key,E=Pr(u);return E!=="string"?[new be(p,u,`string expected, ${E} found`)]:[]}const Di={promoteId:function({key:f,value:u}){if(Pr(u)==="string")return qi({key:f,value:u});{const p=[];for(const E in u)p.push(...qi({key:`${f}.${E}`,value:u[E]}));return p}}};function Nt(f){const u=f.value,p=f.key,E=f.styleSpec,B=f.style,q=f.validateSpec;if(!u.type)return[new be(p,u,'"type" is required')];const W=ns(u.type);let se;switch(W){case"vector":case"raster":return se=Hr({key:p,value:u,valueSpec:E[`source_${W.replace("-","_")}`],style:f.style,styleSpec:E,objectElementValidators:Di,validateSpec:q}),se;case"raster-dem":return se=function(fe){var ve;const Be=(ve=fe.sourceName)!==null&&ve!==void 0?ve:"",He=fe.value,it=fe.styleSpec,pt=it.source_raster_dem,vt=fe.style;let Dt=[];const Lt=Pr(He);if(He===void 0)return Dt;if(Lt!=="object")return Dt.push(new be("source_raster_dem",He,`object expected, ${Lt} found`)),Dt;const Rt=ns(He.encoding)==="custom",ei=["redFactor","greenFactor","blueFactor","baseShift"],Zt=fe.value.encoding?`"${fe.value.encoding}"`:"Default";for(const Wt in He)!Rt&&ei.includes(Wt)?Dt.push(new be(Wt,He[Wt],`In "${Be}": "${Wt}" is only valid when "encoding" is set to "custom". ${Zt} encoding found`)):pt[Wt]?Dt=Dt.concat(fe.validateSpec({key:Wt,value:He[Wt],valueSpec:pt[Wt],validateSpec:fe.validateSpec,style:vt,styleSpec:it})):Dt.push(new be(Wt,He[Wt],`unknown property "${Wt}"`));return Dt}({sourceName:p,value:u,style:f.style,styleSpec:E,validateSpec:q}),se;case"geojson":if(se=Hr({key:p,value:u,valueSpec:E.source_geojson,style:B,styleSpec:E,validateSpec:q,objectElementValidators:Di}),u.cluster)for(const fe in u.clusterProperties){const[ve,Be]=u.clusterProperties[fe],He=typeof ve=="string"?[ve,["accumulated"],["get",fe]]:ve;se.push(...Ma({key:`${p}.${fe}.map`,value:Be,validateSpec:q,expressionContext:"cluster-map"})),se.push(...Ma({key:`${p}.${fe}.reduce`,value:He,validateSpec:q,expressionContext:"cluster-reduce"}))}return se;case"video":return Hr({key:p,value:u,valueSpec:E.source_video,style:B,validateSpec:q,styleSpec:E});case"image":return Hr({key:p,value:u,valueSpec:E.source_image,style:B,validateSpec:q,styleSpec:E});case"canvas":return[new be(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Oa({key:`${p}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:B,validateSpec:q,styleSpec:E})}}function ni(f){const u=f.value,p=f.styleSpec,E=p.light,B=f.style;let q=[];const W=Pr(u);if(u===void 0)return q;if(W!=="object")return q=q.concat([new be("light",u,`object expected, ${W} found`)]),q;for(const se in u){const fe=se.match(/^(.*)-transition$/);q=q.concat(fe&&E[fe[1]]&&E[fe[1]].transition?f.validateSpec({key:se,value:u[se],valueSpec:p.transition,validateSpec:f.validateSpec,style:B,styleSpec:p}):E[se]?f.validateSpec({key:se,value:u[se],valueSpec:E[se],validateSpec:f.validateSpec,style:B,styleSpec:p}):[new be(se,u[se],`unknown property "${se}"`)])}return q}function wi(f){const u=f.value,p=f.styleSpec,E=p.terrain,B=f.style;let q=[];const W=Pr(u);if(u===void 0)return q;if(W!=="object")return q=q.concat([new be("terrain",u,`object expected, ${W} found`)]),q;for(const se in u)q=q.concat(E[se]?f.validateSpec({key:se,value:u[se],valueSpec:E[se],validateSpec:f.validateSpec,style:B,styleSpec:p}):[new be(se,u[se],`unknown property "${se}"`)]);return q}function Ui(f){let u=[];const p=f.value,E=f.key;if(Array.isArray(p)){const B=[],q=[];for(const W in p)p[W].id&&B.includes(p[W].id)&&u.push(new be(E,p,`all the sprites' ids must be unique, but ${p[W].id} is duplicated`)),B.push(p[W].id),p[W].url&&q.includes(p[W].url)&&u.push(new be(E,p,`all the sprites' URLs must be unique, but ${p[W].url} is duplicated`)),q.push(p[W].url),u=u.concat(Hr({key:`${E}[${W}]`,value:p[W],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:f.validateSpec}));return u}return qi({key:E,value:p})}const On={"*":()=>[],array:ga,boolean:function(f){const u=f.value,p=f.key,E=Pr(u);return E!=="boolean"?[new be(p,u,`boolean expected, ${E} found`)]:[]},number:xo,color:function(f){const u=f.key,p=f.value,E=Pr(p);return E!=="string"?[new be(u,p,`color expected, ${E} found`)]:Qi.parse(String(p))?[]:[new be(u,p,`color expected, "${p}" found`)]},constants:el,enum:Oa,filter:no,function:aa,layer:mi,object:Hr,source:Nt,light:ni,terrain:wi,string:qi,formatted:function(f){return qi(f).length===0?[]:Ma(f)},resolvedImage:function(f){return qi(f).length===0?[]:Ma(f)},padding:function(f){const u=f.key,p=f.value;if(Pr(p)==="array"){if(p.length<1||p.length>4)return[new be(u,p,`padding requires 1 to 4 values; ${p.length} values found`)];const E={type:"number"};let B=[];for(let q=0;q<p.length;q++)B=B.concat(f.validateSpec({key:`${u}[${q}]`,value:p[q],validateSpec:f.validateSpec,valueSpec:E}));return B}return xo({key:u,value:p,valueSpec:{}})},variableAnchorOffsetCollection:function(f){const u=f.key,p=f.value,E=Pr(p),B=f.styleSpec;if(E!=="array"||p.length<1||p.length%2!=0)return[new be(u,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let q=[];for(let W=0;W<p.length;W+=2)q=q.concat(Oa({key:`${u}[${W}]`,value:p[W],valueSpec:B.layout_symbol["text-anchor"]})),q=q.concat(ga({key:`${u}[${W+1}]`,value:p[W+1],valueSpec:{length:2,value:"number"},validateSpec:f.validateSpec,style:f.style,styleSpec:B}));return q},sprite:Ui};function jn(f){const u=f.value,p=f.valueSpec,E=f.styleSpec;return f.validateSpec=jn,p.expression&&Kn(ns(u))?aa(f):p.expression&&as(vr(u))?Ma(f):p.type&&On[p.type]?On[p.type](f):Hr(Ee({},f,{valueSpec:p.type?E[p.type]:p}))}function cr(f){const u=f.value,p=f.key,E=qi(f);return E.length||(u.indexOf("{fontstack}")===-1&&E.push(new be(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&E.push(new be(p,u,'"glyphs" url must include a "{range}" token'))),E}function Jn(f,u=oi){let p=[];return p=p.concat(jn({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,validateSpec:jn,objectElementValidators:{glyphs:cr,"*":()=>[]}})),f.constants&&(p=p.concat(el({key:"constants",value:f.constants,style:f,styleSpec:u,validateSpec:jn}))),Bs(p)}function $s(f){return function(u){return f({...u,validateSpec:jn})}}function Bs(f){return[].concat(f).sort((u,p)=>u.line-p.line)}function _s(f){return function(...u){return Bs(f.apply(this,u))}}Jn.source=_s($s(Nt)),Jn.sprite=_s($s(Ui)),Jn.glyphs=_s($s(cr)),Jn.light=_s($s(ni)),Jn.terrain=_s($s(wi)),Jn.layer=_s($s(mi)),Jn.filter=_s($s(no)),Jn.paintProperty=_s($s(_l)),Jn.layoutProperty=_s($s(ho));const ro=Jn,bo=ro.light,cs=ro.paintProperty,Yu=ro.layoutProperty;function Nu(f,u){let p=!1;if(u&&u.length)for(const E of u)f.fire(new an(new Error(E.message))),p=!0;return p}class wo{constructor(u,p,E){const B=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const W=new Int32Array(this.arrayBuffer);u=W[0],this.d=(p=W[1])+2*(E=W[2]);for(let fe=0;fe<this.d*this.d;fe++){const ve=W[3+fe],Be=W[3+fe+1];B.push(ve===Be?null:W.subarray(ve,Be))}const se=W[3+B.length+1];this.keys=W.subarray(W[3+B.length],se),this.bboxes=W.subarray(se),this.insert=this._insertReadonly}else{this.d=p+2*E;for(let W=0;W<this.d*this.d;W++)B.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=E,this.scale=p/u,this.uid=0;const q=E/p*u;this.min=-q,this.max=u+q}insert(u,p,E,B,q){this._forEachCell(p,E,B,q,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(E),this.bboxes.push(B),this.bboxes.push(q)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,p,E,B,q,W){this.cells[q].push(W)}query(u,p,E,B,q){const W=this.min,se=this.max;if(u<=W&&p<=W&&se<=E&&se<=B&&!q)return Array.prototype.slice.call(this.keys);{const fe=[];return this._forEachCell(u,p,E,B,this._queryCell,fe,{},q),fe}}_queryCell(u,p,E,B,q,W,se,fe){const ve=this.cells[q];if(ve!==null){const Be=this.keys,He=this.bboxes;for(let it=0;it<ve.length;it++){const pt=ve[it];if(se[pt]===void 0){const vt=4*pt;(fe?fe(He[vt+0],He[vt+1],He[vt+2],He[vt+3]):u<=He[vt+2]&&p<=He[vt+3]&&E>=He[vt+0]&&B>=He[vt+1])?(se[pt]=!0,W.push(Be[pt])):se[pt]=!1}}}}_forEachCell(u,p,E,B,q,W,se,fe){const ve=this._convertToCellCoord(u),Be=this._convertToCellCoord(p),He=this._convertToCellCoord(E),it=this._convertToCellCoord(B);for(let pt=ve;pt<=He;pt++)for(let vt=Be;vt<=it;vt++){const Dt=this.d*vt+pt;if((!fe||fe(this._convertFromCellCoord(pt),this._convertFromCellCoord(vt),this._convertFromCellCoord(pt+1),this._convertFromCellCoord(vt+1)))&&q.call(this,u,p,E,B,Dt,W,se,fe))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,p=3+this.cells.length+1+1;let E=0;for(let W=0;W<this.cells.length;W++)E+=this.cells[W].length;const B=new Int32Array(p+E+this.keys.length+this.bboxes.length);B[0]=this.extent,B[1]=this.n,B[2]=this.padding;let q=p;for(let W=0;W<u.length;W++){const se=u[W];B[3+W]=q,B.set(se,q),q+=se.length}return B[3+u.length]=q,B.set(this.keys,q),q+=this.keys.length,B[3+u.length+1]=q,B.set(this.bboxes,q),q+=this.bboxes.length,B.buffer}static serialize(u,p){const E=u.toArrayBuffer();return p&&p.push(E),{buffer:E}}static deserialize(u){return new wo(u.buffer)}}const Ll={};function Rn(f,u,p={}){if(Ll[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),Ll[f]={klass:u,omit:p.omit||[],shallow:p.shallow||[]}}Rn("Object",Object),Rn("TransferableGridIndex",wo),Rn("Color",Qi),Rn("Error",Error),Rn("AJAXError",xn),Rn("ResolvedImage",Ar),Rn("StylePropertyFunction",ul),Rn("StyleExpression",Ul,{omit:["_evaluator"]}),Rn("ZoomDependentExpression",Br),Rn("ZoomConstantExpression",Ls),Rn("CompoundExpression",qr,{omit:["_evaluate"]});for(const f in $o)$o[f]._classRegistryKey||Rn(`Expression_${f}`,$o[f]);function Na(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function En(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(Na(f)||Vt(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return u&&u.push(p.buffer),p}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const E of f)p.push(En(E,u));return p}if(typeof f=="object"){const p=f.constructor,E=p._classRegistryKey;if(!E)throw new Error("can't serialize object of unregistered class");if(!Ll[E])throw new Error(`${E} is not registered.`);const B=p.serialize?p.serialize(f,u):{};if(p.serialize){if(u&&B===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const q in f){if(!f.hasOwnProperty(q)||Ll[E].omit.indexOf(q)>=0)continue;const W=f[q];B[q]=Ll[E].shallow.indexOf(q)>=0?W:En(W,u)}f instanceof Error&&(B.message=f.message)}if(B.$name)throw new Error("$name property is reserved for worker serialization logic.");return E!=="Object"&&(B.$name=E),B}throw new Error("can't serialize object of type "+typeof f)}function Vo(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||Na(f)||Vt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(Vo);if(typeof f=="object"){const u=f.$name||"Object";if(!Ll[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:p}=Ll[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(f);const E=Object.create(p.prototype);for(const B of Object.keys(f)){if(B==="$name")continue;const q=f[B];E[B]=Ll[u].shallow.indexOf(B)>=0?q:Vo(q)}return E}throw new Error("can't deserialize object of type "+typeof f)}class Gl{constructor(){this.first=!0}update(u,p){const E=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=E,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=E,!0):(this.lastFloorZoom>E?(this.lastIntegerZoom=E+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<E&&(this.lastIntegerZoom=E,this.lastIntegerZoomTime=p),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=E,!0))}}const Cn={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function Yl(f){for(const u of f)if(hu(u.charCodeAt(0)))return!0;return!1}function Tn(f){for(const u of f)if(!yl(u.charCodeAt(0)))return!1;return!0}function yl(f){return!(Cn.Arabic(f)||Cn["Arabic Supplement"](f)||Cn["Arabic Extended-A"](f)||Cn["Arabic Presentation Forms-A"](f)||Cn["Arabic Presentation Forms-B"](f))}function hu(f){return!(f!==746&&f!==747&&(f<4352||!(Cn["Bopomofo Extended"](f)||Cn.Bopomofo(f)||Cn["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Cn["CJK Compatibility Ideographs"](f)||Cn["CJK Compatibility"](f)||Cn["CJK Radicals Supplement"](f)||Cn["CJK Strokes"](f)||!(!Cn["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Cn["CJK Unified Ideographs Extension A"](f)||Cn["CJK Unified Ideographs"](f)||Cn["Enclosed CJK Letters and Months"](f)||Cn["Hangul Compatibility Jamo"](f)||Cn["Hangul Jamo Extended-A"](f)||Cn["Hangul Jamo Extended-B"](f)||Cn["Hangul Jamo"](f)||Cn["Hangul Syllables"](f)||Cn.Hiragana(f)||Cn["Ideographic Description Characters"](f)||Cn.Kanbun(f)||Cn["Kangxi Radicals"](f)||Cn["Katakana Phonetic Extensions"](f)||Cn.Katakana(f)&&f!==12540||!(!Cn["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Cn["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Cn["Unified Canadian Aboriginal Syllabics"](f)||Cn["Unified Canadian Aboriginal Syllabics Extended"](f)||Cn["Vertical Forms"](f)||Cn["Yijing Hexagram Symbols"](f)||Cn["Yi Syllables"](f)||Cn["Yi Radicals"](f))))}function Vu(f){return!(hu(f)||function(u){return!!(Cn["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Cn["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Cn["Letterlike Symbols"](u)||Cn["Number Forms"](u)||Cn["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Cn["Control Pictures"](u)&&u!==9251||Cn["Optical Character Recognition"](u)||Cn["Enclosed Alphanumerics"](u)||Cn["Geometric Shapes"](u)||Cn["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Cn["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Cn["CJK Symbols and Punctuation"](u)||Cn.Katakana(u)||Cn["Private Use Area"](u)||Cn["CJK Compatibility Forms"](u)||Cn["Small Form Variants"](u)||Cn["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function ql(f){return f>=1424&&f<=2303||Cn["Arabic Presentation Forms-A"](f)||Cn["Arabic Presentation Forms-B"](f)}function vl(f,u){return!(!u&&ql(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Cn.Khmer(f))}function oa(f){for(const u of f)if(ql(u.charCodeAt(0)))return!0;return!1}const uc="deferred",Ku="loading",Kl="loaded";let ys=null,wa="unavailable",tl=null;const xu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(wa="error"),ys&&ys(f)};function Uu(){Au.fire(new Ot("pluginStateChange",{pluginStatus:wa,pluginURL:tl}))}const Au=new $n,Gu=function(){return wa},br=function(){if(wa!==uc||!tl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");wa=Ku,Uu(),tl&&bn({url:tl},f=>{f?xu(f):(wa=Kl,Uu())})},vs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>wa===Kl||vs.applyArabicShaping!=null,isLoading:()=>wa===Ku,setState(f){if(!Ut())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");wa=f.pluginStatus,tl=f.pluginURL},isParsed(){if(!Ut())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return vs.applyArabicShaping!=null&&vs.processBidirectionalText!=null&&vs.processStyledBidirectionalText!=null},getPluginURL(){if(!Ut())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return tl}};class gn{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gl,this.transition={})}isSupportedScript(u){return function(p,E){for(const B of p)if(!vl(B.charCodeAt(0),E))return!1;return!0}(u,vs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,p=u-Math.floor(u),E=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*E}:{fromScale:.5,toScale:1,t:1-(1-E)*p}}}class Zn{constructor(u,p){this.property=u,this.value=p,this.expression=function(E,B){if(Kn(E))return new ul(E,B);if(as(E)){const q=ar(E,B);if(q.result==="error")throw new Error(q.value.map(W=>`${W.key}: ${W.message}`).join(", "));return q.value}{let q=E;return B.type==="color"&&typeof E=="string"?q=Qi.parse(E):B.type!=="padding"||typeof E!="number"&&!Array.isArray(E)?B.type==="variableAnchorOffsetCollection"&&Array.isArray(E)&&(q=kn.parse(E)):q=en.parse(E),{kind:"constant",evaluate:()=>q}}}(p===void 0?u.specification.default:p,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,E){return this.property.possiblyEvaluate(this,u,p,E)}}class ir{constructor(u){this.property=u,this.value=new Zn(u,void 0)}transitioned(u,p){return new Pu(this.property,this.value,p,rt({},u.transition,this.transition),u.now)}untransitioned(){return new Pu(this.property,this.value,null,{},0)}}class il{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return St(this._values[u].value.value)}setValue(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new ir(this._values[u].property)),this._values[u].value=new Zn(this._values[u].property,p===null?void 0:St(p))}getTransition(u){return St(this._values[u].transition)}setTransition(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new ir(this._values[u].property)),this._values[u].transition=St(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const E=this.getValue(p);E!==void 0&&(u[p]=E);const B=this.getTransition(p);B!==void 0&&(u[`${p}-transition`]=B)}return u}transitioned(u,p){const E=new fa(this._properties);for(const B of Object.keys(this._values))E._values[B]=this._values[B].transitioned(u,p._values[B]);return E}untransitioned(){const u=new fa(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class Pu{constructor(u,p,E,B,q){this.property=u,this.value=p,this.begin=q+B.delay||0,this.end=this.begin+B.duration||0,u.specification.transition&&(B.delay||B.duration)&&(this.prior=E)}possiblyEvaluate(u,p,E){const B=u.now||0,q=this.value.possiblyEvaluate(u,p,E),W=this.prior;if(W){if(B>this.end)return this.prior=null,q;if(this.value.isDataDriven())return this.prior=null,q;if(B<this.begin)return W.possiblyEvaluate(u,p,E);{const se=(B-this.begin)/(this.end-this.begin);return this.property.interpolate(W.possiblyEvaluate(u,p,E),q,function(fe){if(fe<=0)return 0;if(fe>=1)return 1;const ve=fe*fe,Be=ve*fe;return 4*(fe<.5?Be:3*(fe-ve)+Be-.75)}(se))}}return q}}class fa{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,E){const B=new Bo(this._properties);for(const q of Object.keys(this._values))B._values[q]=this._values[q].possiblyEvaluate(u,p,E);return B}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class bu{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}hasValue(u){return this._values[u].value!==void 0}getValue(u){return St(this._values[u].value)}setValue(u,p){this._values[u]=new Zn(this._values[u].property,p===null?void 0:St(p))}serialize(){const u={};for(const p of Object.keys(this._values)){const E=this.getValue(p);E!==void 0&&(u[p]=E)}return u}possiblyEvaluate(u,p,E){const B=new Bo(this._properties);for(const q of Object.keys(this._values))B._values[q]=this._values[q].possiblyEvaluate(u,p,E);return B}}class Is{constructor(u,p,E){this.property=u,this.value=p,this.parameters=E}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,E,B){return this.property.evaluate(this.value,this.parameters,u,p,E,B)}}class Bo{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Mi{constructor(u){this.specification=u}possiblyEvaluate(u,p){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(p)}interpolate(u,p,E){const B=Ys[this.specification.type];return B?B(u,p,E):u}}class zi{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,E,B){return new Is(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},E,B)}:u.expression,p)}interpolate(u,p,E){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new Is(this,{kind:"constant",value:void 0},u.parameters);const B=Ys[this.specification.type];if(B){const q=B(u.value.value,p.value.value,E);return new Is(this,{kind:"constant",value:q},u.parameters)}return u}evaluate(u,p,E,B,q,W){return u.kind==="constant"?u.value:u.evaluate(p,E,B,q,W)}}class Es extends zi{possiblyEvaluate(u,p,E,B){if(u.value===void 0)return new Is(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){const q=u.expression.evaluate(p,null,{},E,B),W=u.property.specification.type==="resolvedImage"&&typeof q!="string"?q.name:q,se=this._calculate(W,W,W,p);return new Is(this,{kind:"constant",value:se},p)}if(u.expression.kind==="camera"){const q=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new Is(this,{kind:"constant",value:q},p)}return new Is(this,u.expression,p)}evaluate(u,p,E,B,q,W){if(u.kind==="source"){const se=u.evaluate(p,E,B,q,W);return this._calculate(se,se,se,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},E,B),u.evaluate({zoom:Math.floor(p.zoom)},E,B),u.evaluate({zoom:Math.floor(p.zoom)+1},E,B),p):u.value}_calculate(u,p,E,B){return B.zoom>B.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:E,to:p}}interpolate(u){return u}}class wu{constructor(u){this.specification=u}possiblyEvaluate(u,p,E,B){if(u.value!==void 0){if(u.expression.kind==="constant"){const q=u.expression.evaluate(p,null,{},E,B);return this._calculate(q,q,q,p)}return this._calculate(u.expression.evaluate(new gn(Math.floor(p.zoom-1),p)),u.expression.evaluate(new gn(Math.floor(p.zoom),p)),u.expression.evaluate(new gn(Math.floor(p.zoom+1),p)),p)}}_calculate(u,p,E,B){return B.zoom>B.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:E,to:p}}interpolate(u){return u}}class Uo{constructor(u){this.specification=u}possiblyEvaluate(u,p,E,B){return!!u.expression.evaluate(p,null,{},E,B)}interpolate(){return!1}}class ms{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in u){const E=u[p];E.specification.overridable&&this.overridableProperties.push(p);const B=this.defaultPropertyValues[p]=new Zn(E,void 0),q=this.defaultTransitionablePropertyValues[p]=new ir(E);this.defaultTransitioningPropertyValues[p]=q.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=B.possiblyEvaluate({})}}}Rn("DataDrivenProperty",zi),Rn("DataConstantProperty",Mi),Rn("CrossFadedDataDrivenProperty",Es),Rn("CrossFadedProperty",wu),Rn("ColorRampProperty",Uo);const Al="-transition";class zs extends $n{constructor(u,p){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new bu(p.layout)),p.paint)){this._transitionablePaint=new il(p.paint);for(const E in u.paint)this.setPaintProperty(E,u.paint[E],{validate:!1});for(const E in u.layout)this.setLayoutProperty(E,u.layout[E],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bo(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p,E={}){p!=null&&this._validate(Yu,`layers.${this.id}.layout.${u}`,u,p,E)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)}getPaintProperty(u){return u.endsWith(Al)?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p,E={}){if(p!=null&&this._validate(cs,`layers.${this.id}.paint.${u}`,u,p,E))return!1;if(u.endsWith(Al))return this._transitionablePaint.setTransition(u.slice(0,-11),p||void 0),!1;{const B=this._transitionablePaint._values[u],q=B.property.specification["property-type"]==="cross-faded-data-driven",W=B.value.isDataDriven(),se=B.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);const fe=this._transitionablePaint._values[u].value;return fe.isDataDriven()||W||q||this._handleOverridablePaintPropertyUpdate(u,se,fe)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,p,E){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),yt(u,(p,E)=>!(p===void 0||E==="layout"&&!Object.keys(p).length||E==="paint"&&!Object.keys(p).length))}_validate(u,p,E,B,q={}){return(!q||q.validate!==!1)&&Nu(this,u.call(ro,{key:p,layerType:this.type,objectKey:E,value:B,styleSpec:oi,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof Is&&eo(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const T={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class L{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class R{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function F(f,u=1){let p=0,E=0;return{members:f.map(B=>{const q=T[B.type].BYTES_PER_ELEMENT,W=p=te(p,Math.max(u,q)),se=B.components||1;return E=Math.max(E,q),p+=q*se,{name:B.name,type:B.type,components:se,offset:W}}),size:te(p,Math.max(E,u)),alignment:u}}function te(f,u){return Math.ceil(f/u)*u}class ue extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const E=this.length;return this.resize(E+1),this.emplace(E,u,p)}emplace(u,p,E){const B=2*u;return this.int16[B+0]=p,this.int16[B+1]=E,u}}ue.prototype.bytesPerElement=4,Rn("StructArrayLayout2i4",ue);class le extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,E){const B=this.length;return this.resize(B+1),this.emplace(B,u,p,E)}emplace(u,p,E,B){const q=3*u;return this.int16[q+0]=p,this.int16[q+1]=E,this.int16[q+2]=B,u}}le.prototype.bytesPerElement=6,Rn("StructArrayLayout3i6",le);class Se extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,E,B){const q=this.length;return this.resize(q+1),this.emplace(q,u,p,E,B)}emplace(u,p,E,B,q){const W=4*u;return this.int16[W+0]=p,this.int16[W+1]=E,this.int16[W+2]=B,this.int16[W+3]=q,u}}Se.prototype.bytesPerElement=8,Rn("StructArrayLayout4i8",Se);class Xe extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W){const se=this.length;return this.resize(se+1),this.emplace(se,u,p,E,B,q,W)}emplace(u,p,E,B,q,W,se){const fe=6*u;return this.int16[fe+0]=p,this.int16[fe+1]=E,this.int16[fe+2]=B,this.int16[fe+3]=q,this.int16[fe+4]=W,this.int16[fe+5]=se,u}}Xe.prototype.bytesPerElement=12,Rn("StructArrayLayout2i4i12",Xe);class bt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W){const se=this.length;return this.resize(se+1),this.emplace(se,u,p,E,B,q,W)}emplace(u,p,E,B,q,W,se){const fe=4*u,ve=8*u;return this.int16[fe+0]=p,this.int16[fe+1]=E,this.uint8[ve+4]=B,this.uint8[ve+5]=q,this.uint8[ve+6]=W,this.uint8[ve+7]=se,u}}bt.prototype.bytesPerElement=8,Rn("StructArrayLayout2i4ub8",bt);class kt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const E=this.length;return this.resize(E+1),this.emplace(E,u,p)}emplace(u,p,E){const B=2*u;return this.float32[B+0]=p,this.float32[B+1]=E,u}}kt.prototype.bytesPerElement=8,Rn("StructArrayLayout2f8",kt);class ri extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W,se,fe,ve,Be){const He=this.length;return this.resize(He+1),this.emplace(He,u,p,E,B,q,W,se,fe,ve,Be)}emplace(u,p,E,B,q,W,se,fe,ve,Be,He){const it=10*u;return this.uint16[it+0]=p,this.uint16[it+1]=E,this.uint16[it+2]=B,this.uint16[it+3]=q,this.uint16[it+4]=W,this.uint16[it+5]=se,this.uint16[it+6]=fe,this.uint16[it+7]=ve,this.uint16[it+8]=Be,this.uint16[it+9]=He,u}}ri.prototype.bytesPerElement=20,Rn("StructArrayLayout10ui20",ri);class Ht extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W,se,fe,ve,Be,He,it){const pt=this.length;return this.resize(pt+1),this.emplace(pt,u,p,E,B,q,W,se,fe,ve,Be,He,it)}emplace(u,p,E,B,q,W,se,fe,ve,Be,He,it,pt){const vt=12*u;return this.int16[vt+0]=p,this.int16[vt+1]=E,this.int16[vt+2]=B,this.int16[vt+3]=q,this.uint16[vt+4]=W,this.uint16[vt+5]=se,this.uint16[vt+6]=fe,this.uint16[vt+7]=ve,this.int16[vt+8]=Be,this.int16[vt+9]=He,this.int16[vt+10]=it,this.int16[vt+11]=pt,u}}Ht.prototype.bytesPerElement=24,Rn("StructArrayLayout4i4ui4i24",Ht);class Qt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,E){const B=this.length;return this.resize(B+1),this.emplace(B,u,p,E)}emplace(u,p,E,B){const q=3*u;return this.float32[q+0]=p,this.float32[q+1]=E,this.float32[q+2]=B,u}}Qt.prototype.bytesPerElement=12,Rn("StructArrayLayout3f12",Qt);class Q extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}Q.prototype.bytesPerElement=4,Rn("StructArrayLayout1ul4",Q);class A extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W,se,fe,ve){const Be=this.length;return this.resize(Be+1),this.emplace(Be,u,p,E,B,q,W,se,fe,ve)}emplace(u,p,E,B,q,W,se,fe,ve,Be){const He=10*u,it=5*u;return this.int16[He+0]=p,this.int16[He+1]=E,this.int16[He+2]=B,this.int16[He+3]=q,this.int16[He+4]=W,this.int16[He+5]=se,this.uint32[it+3]=fe,this.uint16[He+8]=ve,this.uint16[He+9]=Be,u}}A.prototype.bytesPerElement=20,Rn("StructArrayLayout6i1ul2ui20",A);class C extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W){const se=this.length;return this.resize(se+1),this.emplace(se,u,p,E,B,q,W)}emplace(u,p,E,B,q,W,se){const fe=6*u;return this.int16[fe+0]=p,this.int16[fe+1]=E,this.int16[fe+2]=B,this.int16[fe+3]=q,this.int16[fe+4]=W,this.int16[fe+5]=se,u}}C.prototype.bytesPerElement=12,Rn("StructArrayLayout2i2i2i12",C);class O extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q){const W=this.length;return this.resize(W+1),this.emplace(W,u,p,E,B,q)}emplace(u,p,E,B,q,W){const se=4*u,fe=8*u;return this.float32[se+0]=p,this.float32[se+1]=E,this.float32[se+2]=B,this.int16[fe+6]=q,this.int16[fe+7]=W,u}}O.prototype.bytesPerElement=16,Rn("StructArrayLayout2f1f2i16",O);class V extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,E,B){const q=this.length;return this.resize(q+1),this.emplace(q,u,p,E,B)}emplace(u,p,E,B,q){const W=12*u,se=3*u;return this.uint8[W+0]=p,this.uint8[W+1]=E,this.float32[se+1]=B,this.float32[se+2]=q,u}}V.prototype.bytesPerElement=12,Rn("StructArrayLayout2ub2f12",V);class x extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,E){const B=this.length;return this.resize(B+1),this.emplace(B,u,p,E)}emplace(u,p,E,B){const q=3*u;return this.uint16[q+0]=p,this.uint16[q+1]=E,this.uint16[q+2]=B,u}}x.prototype.bytesPerElement=6,Rn("StructArrayLayout3ui6",x);class s extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt){const ei=this.length;return this.resize(ei+1),this.emplace(ei,u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt)}emplace(u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei){const Zt=24*u,Wt=12*u,hi=48*u;return this.int16[Zt+0]=p,this.int16[Zt+1]=E,this.uint16[Zt+2]=B,this.uint16[Zt+3]=q,this.uint32[Wt+2]=W,this.uint32[Wt+3]=se,this.uint32[Wt+4]=fe,this.uint16[Zt+10]=ve,this.uint16[Zt+11]=Be,this.uint16[Zt+12]=He,this.float32[Wt+7]=it,this.float32[Wt+8]=pt,this.uint8[hi+36]=vt,this.uint8[hi+37]=Dt,this.uint8[hi+38]=Lt,this.uint32[Wt+10]=Rt,this.int16[Zt+22]=ei,u}}s.prototype.bytesPerElement=48,Rn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",s);class i extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei,Zt,Wt,hi,vi,Ji,In,un,ln,dn,Vn){const on=this.length;return this.resize(on+1),this.emplace(on,u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei,Zt,Wt,hi,vi,Ji,In,un,ln,dn,Vn)}emplace(u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt,Lt,Rt,ei,Zt,Wt,hi,vi,Ji,In,un,ln,dn,Vn,on){const Ki=32*u,Fn=16*u;return this.int16[Ki+0]=p,this.int16[Ki+1]=E,this.int16[Ki+2]=B,this.int16[Ki+3]=q,this.int16[Ki+4]=W,this.int16[Ki+5]=se,this.int16[Ki+6]=fe,this.int16[Ki+7]=ve,this.uint16[Ki+8]=Be,this.uint16[Ki+9]=He,this.uint16[Ki+10]=it,this.uint16[Ki+11]=pt,this.uint16[Ki+12]=vt,this.uint16[Ki+13]=Dt,this.uint16[Ki+14]=Lt,this.uint16[Ki+15]=Rt,this.uint16[Ki+16]=ei,this.uint16[Ki+17]=Zt,this.uint16[Ki+18]=Wt,this.uint16[Ki+19]=hi,this.uint16[Ki+20]=vi,this.uint16[Ki+21]=Ji,this.uint16[Ki+22]=In,this.uint32[Fn+12]=un,this.float32[Fn+13]=ln,this.float32[Fn+14]=dn,this.uint16[Ki+30]=Vn,this.uint16[Ki+31]=on,u}}i.prototype.bytesPerElement=64,Rn("StructArrayLayout8i15ui1ul2f2ui64",i);class r extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}r.prototype.bytesPerElement=4,Rn("StructArrayLayout1f4",r);class l extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,E){const B=this.length;return this.resize(B+1),this.emplace(B,u,p,E)}emplace(u,p,E,B){const q=3*u;return this.uint16[6*u+0]=p,this.float32[q+1]=E,this.float32[q+2]=B,u}}l.prototype.bytesPerElement=12,Rn("StructArrayLayout1ui2f12",l);class d extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,E){const B=this.length;return this.resize(B+1),this.emplace(B,u,p,E)}emplace(u,p,E,B){const q=4*u;return this.uint32[2*u+0]=p,this.uint16[q+2]=E,this.uint16[q+3]=B,u}}d.prototype.bytesPerElement=8,Rn("StructArrayLayout1ul2ui8",d);class y extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const E=this.length;return this.resize(E+1),this.emplace(E,u,p)}emplace(u,p,E){const B=2*u;return this.uint16[B+0]=p,this.uint16[B+1]=E,u}}y.prototype.bytesPerElement=4,Rn("StructArrayLayout2ui4",y);class I extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}I.prototype.bytesPerElement=2,Rn("StructArrayLayout1ui2",I);class k extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,E,B){const q=this.length;return this.resize(q+1),this.emplace(q,u,p,E,B)}emplace(u,p,E,B,q){const W=4*u;return this.float32[W+0]=p,this.float32[W+1]=E,this.float32[W+2]=B,this.float32[W+3]=q,u}}k.prototype.bytesPerElement=16,Rn("StructArrayLayout4f16",k);class z extends L{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ce(this.anchorPointX,this.anchorPointY)}}z.prototype.size=20;class Z extends A{get(u){return new z(this,u)}}Rn("CollisionBoxArray",Z);class Y extends L{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Y.prototype.size=48;class Ae extends s{get(u){return new Y(this,u)}}Rn("PlacedSymbolArray",Ae);class Ie extends L{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ie.prototype.size=64;class ke extends i{get(u){return new Ie(this,u)}}Rn("SymbolInstanceArray",ke);class Fe extends r{getoffsetX(u){return this.float32[1*u+0]}}Rn("GlyphOffsetArray",Fe);class ze extends le{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Rn("SymbolLineVertexArray",ze);class tt extends L{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}tt.prototype.size=12;class wt extends l{get(u){return new tt(this,u)}}Rn("TextAnchorOffsetArray",wt);class lt extends L{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}lt.prototype.size=8;class ft extends d{get(u){return new lt(this,u)}}Rn("FeatureIndexArray",ft);class Tt extends ue{}class It extends ue{}class si extends ue{}class Kt extends Xe{}class ii extends bt{}class ai extends kt{}class Wi extends ri{}class $i extends Ht{}class Ei extends Qt{}class Hi extends Q{}class ji extends C{}class cn extends V{}class Nn extends x{}class nn extends y{}const Mn=F([{name:"a_pos",components:2,type:"Int16"}],4),{members:wr}=Mn;class nr{constructor(u=[]){this.segments=u}prepareSegment(u,p,E,B){let q=this.segments[this.segments.length-1];return u>nr.MAX_VERTEX_ARRAY_LENGTH&&Ye(`Max vertices per segment is ${nr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!q||q.vertexLength+u>nr.MAX_VERTEX_ARRAY_LENGTH||q.sortKey!==B)&&(q={vertexOffset:p.length,primitiveOffset:E.length,vertexLength:0,primitiveLength:0},B!==void 0&&(q.sortKey=B),this.segments.push(q)),q}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,E,B){return new nr([{vertexOffset:u,primitiveOffset:p,vertexLength:E,primitiveLength:B,vaos:{},sortKey:0}])}}function Pa(f,u){return 256*(f=Ue(Math.floor(f),0,255))+Ue(Math.floor(u),0,255)}nr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rn("SegmentVector",nr);const _a=F([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Vs={exports:{}},Ao={exports:{}};Ao.exports=function(f,u){var p,E,B,q,W,se,fe,ve;for(E=f.length-(p=3&f.length),B=u,W=3432918353,se=461845907,ve=0;ve<E;)fe=255&f.charCodeAt(ve)|(255&f.charCodeAt(++ve))<<8|(255&f.charCodeAt(++ve))<<16|(255&f.charCodeAt(++ve))<<24,++ve,B=27492+(65535&(q=5*(65535&(B=(B^=fe=(65535&(fe=(fe=(65535&fe)*W+(((fe>>>16)*W&65535)<<16)&4294967295)<<15|fe>>>17))*se+(((fe>>>16)*se&65535)<<16)&4294967295)<<13|B>>>19))+((5*(B>>>16)&65535)<<16)&4294967295))+((58964+(q>>>16)&65535)<<16);switch(fe=0,p){case 3:fe^=(255&f.charCodeAt(ve+2))<<16;case 2:fe^=(255&f.charCodeAt(ve+1))<<8;case 1:B^=fe=(65535&(fe=(fe=(65535&(fe^=255&f.charCodeAt(ve)))*W+(((fe>>>16)*W&65535)<<16)&4294967295)<<15|fe>>>17))*se+(((fe>>>16)*se&65535)<<16)&4294967295}return B^=f.length,B=2246822507*(65535&(B^=B>>>16))+((2246822507*(B>>>16)&65535)<<16)&4294967295,B=3266489909*(65535&(B^=B>>>13))+((3266489909*(B>>>16)&65535)<<16)&4294967295,(B^=B>>>16)>>>0};var fo=Ao.exports,$r={exports:{}};$r.exports=function(f,u){for(var p,E=f.length,B=u^E,q=0;E>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(q)|(255&f.charCodeAt(++q))<<8|(255&f.charCodeAt(++q))<<16|(255&f.charCodeAt(++q))<<24))+((1540483477*(p>>>16)&65535)<<16),B=1540483477*(65535&B)+((1540483477*(B>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),E-=4,++q;switch(E){case 3:B^=(255&f.charCodeAt(q+2))<<16;case 2:B^=(255&f.charCodeAt(q+1))<<8;case 1:B=1540483477*(65535&(B^=255&f.charCodeAt(q)))+((1540483477*(B>>>16)&65535)<<16)}return B=1540483477*(65535&(B^=B>>>13))+((1540483477*(B>>>16)&65535)<<16),(B^=B>>>15)>>>0};var Sa=fo,So=$r.exports;Vs.exports=Sa,Vs.exports.murmur3=Sa,Vs.exports.murmur2=So;var Io=$(Vs.exports);class Ks{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,p,E,B){this.ids.push(os(u)),this.positions.push(p,E,B)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=os(u);let E=0,B=this.ids.length-1;for(;E<B;){const W=E+B>>1;this.ids[W]>=p?B=W:E=W+1}const q=[];for(;this.ids[E]===p;)q.push({index:this.positions[3*E],start:this.positions[3*E+1],end:this.positions[3*E+2]}),E++;return q}static serialize(u,p){const E=new Float64Array(u.ids),B=new Uint32Array(u.positions);return ls(E,B,0,E.length-1),p&&p.push(E.buffer,B.buffer),{ids:E,positions:B}}static deserialize(u){const p=new Ks;return p.ids=u.ids,p.positions=u.positions,p.indexed=!0,p}}function os(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:Io(String(f))}function ls(f,u,p,E){for(;p<E;){const B=f[p+E>>1];let q=p-1,W=E+1;for(;;){do q++;while(f[q]<B);do W--;while(f[W]>B);if(q>=W)break;Ur(f,q,W),Ur(u,3*q,3*W),Ur(u,3*q+1,3*W+1),Ur(u,3*q+2,3*W+2)}W-p<E-W?(ls(f,u,p,W),p=W+1):(ls(f,u,W+1,E),E=W)}}function Ur(f,u,p){const E=f[u];f[u]=f[p],f[p]=E}Rn("FeaturePositionMap",Ks);class Cs{constructor(u,p){this.gl=u.gl,this.location=p}}class Js extends Cs{constructor(u,p){super(u,p),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class zo extends Cs{constructor(u,p){super(u,p),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class Go extends Cs{constructor(u,p){super(u,p),this.current=Qi.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const qo=new Float32Array(16);function Cc(f){return[Pa(255*f.r,255*f.g),Pa(255*f.b,255*f.a)]}class ea{constructor(u,p,E){this.value=u,this.uniformNames=p.map(B=>`u_${B}`),this.type=E}setUniform(u,p,E){u.set(E.constantOr(this.value))}getBinding(u,p,E){return this.type==="color"?new Go(u,p):new Js(u,p)}}class Jl{constructor(u,p){this.uniformNames=p.map(E=>`u_${E}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=u.tlbr}setUniform(u,p,E,B){const q=B==="u_pattern_to"?this.patternTo:B==="u_pattern_from"?this.patternFrom:B==="u_pixel_ratio_to"?this.pixelRatioTo:B==="u_pixel_ratio_from"?this.pixelRatioFrom:null;q&&u.set(q)}getBinding(u,p,E){return E.substr(0,9)==="u_pattern"?new zo(u,p):new Js(u,p)}}class fu{constructor(u,p,E,B){this.expression=u,this.type=E,this.maxValue=0,this.paintVertexAttributes=p.map(q=>({name:`a_${q}`,type:"Float32",components:E==="color"?2:1,offset:0})),this.paintVertexArray=new B}populatePaintArray(u,p,E,B,q){const W=this.paintVertexArray.length,se=this.expression.evaluate(new gn(0),p,{},B,[],q);this.paintVertexArray.resize(u),this._setPaintValue(W,u,se)}updatePaintArray(u,p,E,B){const q=this.expression.evaluate({zoom:0},E,B);this._setPaintValue(u,p,q)}_setPaintValue(u,p,E){if(this.type==="color"){const B=Cc(E);for(let q=u;q<p;q++)this.paintVertexArray.emplace(q,B[0],B[1])}else{for(let B=u;B<p;B++)this.paintVertexArray.emplace(B,E);this.maxValue=Math.max(this.maxValue,Math.abs(E))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nl{constructor(u,p,E,B,q,W){this.expression=u,this.uniformNames=p.map(se=>`u_${se}_t`),this.type=E,this.useIntegerZoom=B,this.zoom=q,this.maxValue=0,this.paintVertexAttributes=p.map(se=>({name:`a_${se}`,type:"Float32",components:E==="color"?4:2,offset:0})),this.paintVertexArray=new W}populatePaintArray(u,p,E,B,q){const W=this.expression.evaluate(new gn(this.zoom),p,{},B,[],q),se=this.expression.evaluate(new gn(this.zoom+1),p,{},B,[],q),fe=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(fe,u,W,se)}updatePaintArray(u,p,E,B){const q=this.expression.evaluate({zoom:this.zoom},E,B),W=this.expression.evaluate({zoom:this.zoom+1},E,B);this._setPaintValue(u,p,q,W)}_setPaintValue(u,p,E,B){if(this.type==="color"){const q=Cc(E),W=Cc(B);for(let se=u;se<p;se++)this.paintVertexArray.emplace(se,q[0],q[1],W[0],W[1])}else{for(let q=u;q<p;q++)this.paintVertexArray.emplace(q,E,B);this.maxValue=Math.max(this.maxValue,Math.abs(E),Math.abs(B))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p){const E=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,B=Ue(this.expression.interpolationFactor(E,this.zoom,this.zoom+1),0,1);u.set(B)}getBinding(u,p,E){return new Js(u,p)}}class xl{constructor(u,p,E,B,q,W){this.expression=u,this.type=p,this.useIntegerZoom=E,this.zoom=B,this.layerId=W,this.zoomInPaintVertexArray=new q,this.zoomOutPaintVertexArray=new q}populatePaintArray(u,p,E){const B=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(B,u,p.patterns&&p.patterns[this.layerId],E)}updatePaintArray(u,p,E,B,q){this._setPaintValues(u,p,E.patterns&&E.patterns[this.layerId],q)}_setPaintValues(u,p,E,B){if(!B||!E)return;const{min:q,mid:W,max:se}=E,fe=B[q],ve=B[W],Be=B[se];if(fe&&ve&&Be)for(let He=u;He<p;He++)this.zoomInPaintVertexArray.emplace(He,ve.tl[0],ve.tl[1],ve.br[0],ve.br[1],fe.tl[0],fe.tl[1],fe.br[0],fe.br[1],ve.pixelRatio,fe.pixelRatio),this.zoomOutPaintVertexArray.emplace(He,ve.tl[0],ve.tl[1],ve.br[0],ve.br[1],Be.tl[0],Be.tl[1],Be.br[0],Be.br[1],ve.pixelRatio,Be.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,_a.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,_a.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Bl{constructor(u,p,E){this.binders={},this._buffers=[];const B=[];for(const q in u.paint._values){if(!E(q))continue;const W=u.paint.get(q);if(!(W instanceof Is&&eo(W.property.specification)))continue;const se=Af(q,u.type),fe=W.value,ve=W.property.specification.type,Be=W.property.useIntegerZoom,He=W.property.specification["property-type"],it=He==="cross-faded"||He==="cross-faded-data-driven";if(fe.kind==="constant")this.binders[q]=it?new Jl(fe.value,se):new ea(fe.value,se,ve),B.push(`/u_${q}`);else if(fe.kind==="source"||it){const pt=qh(q,ve,"source");this.binders[q]=it?new xl(fe,ve,Be,p,pt,u.id):new fu(fe,se,ve,pt),B.push(`/a_${q}`)}else{const pt=qh(q,ve,"composite");this.binders[q]=new nl(fe,se,ve,Be,p,pt),B.push(`/z_${q}`)}}this.cacheKey=B.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof fu||p instanceof nl?p.maxValue:0}populatePaintArrays(u,p,E,B,q){for(const W in this.binders){const se=this.binders[W];(se instanceof fu||se instanceof nl||se instanceof xl)&&se.populatePaintArray(u,p,E,B,q)}}setConstantPatternPositions(u,p){for(const E in this.binders){const B=this.binders[E];B instanceof Jl&&B.setConstantPatternPositions(u,p)}}updatePaintArrays(u,p,E,B,q){let W=!1;for(const se in u){const fe=p.getPositions(se);for(const ve of fe){const Be=E.feature(ve.index);for(const He in this.binders){const it=this.binders[He];if((it instanceof fu||it instanceof nl||it instanceof xl)&&it.expression.isStateDependent===!0){const pt=B.paint.get(He);it.expression=pt.value,it.updatePaintArray(ve.start,ve.end,Be,u[se],q),W=!0}}}}return W}defines(){const u=[];for(const p in this.binders){const E=this.binders[p];(E instanceof ea||E instanceof Jl)&&u.push(...E.uniformNames.map(B=>`#define HAS_UNIFORM_${B}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const E=this.binders[p];if(E instanceof fu||E instanceof nl)for(let B=0;B<E.paintVertexAttributes.length;B++)u.push(E.paintVertexAttributes[B].name);else if(E instanceof xl)for(let B=0;B<_a.members.length;B++)u.push(_a.members[B].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const E=this.binders[p];if(E instanceof ea||E instanceof Jl||E instanceof nl)for(const B of E.uniformNames)u.push(B)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,p){const E=[];for(const B in this.binders){const q=this.binders[B];if(q instanceof ea||q instanceof Jl||q instanceof nl){for(const W of q.uniformNames)if(p[W]){const se=q.getBinding(u,p[W],W);E.push({name:W,property:B,binding:se})}}}return E}setUniforms(u,p,E,B){for(const{name:q,property:W,binding:se}of p)this.binders[W].setUniform(se,B,E.get(W),q)}updatePaintBuffers(u){this._buffers=[];for(const p in this.binders){const E=this.binders[p];if(u&&E instanceof xl){const B=u.fromScale===2?E.zoomInPaintVertexBuffer:E.zoomOutPaintVertexBuffer;B&&this._buffers.push(B)}else(E instanceof fu||E instanceof nl)&&E.paintVertexBuffer&&this._buffers.push(E.paintVertexBuffer)}}upload(u){for(const p in this.binders){const E=this.binders[p];(E instanceof fu||E instanceof nl||E instanceof xl)&&E.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof fu||p instanceof nl||p instanceof xl)&&p.destroy()}}}class du{constructor(u,p,E=()=>!0){this.programConfigurations={};for(const B of u)this.programConfigurations[B.id]=new Bl(B,p,E);this.needsUpload=!1,this._featureMap=new Ks,this._bufferOffset=0}populatePaintArrays(u,p,E,B,q,W){for(const se in this.programConfigurations)this.programConfigurations[se].populatePaintArrays(u,p,B,q,W);p.id!==void 0&&this._featureMap.add(p.id,E,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,E,B){for(const q of E)this.needsUpload=this.programConfigurations[q.id].updatePaintArrays(u,this._featureMap,p,q,B)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function Af(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function qh(f,u,p){const E={color:{source:kt,composite:k},number:{source:r,composite:kt}},B=function(q){return{"line-pattern":{source:Wi,composite:Wi},"fill-pattern":{source:Wi,composite:Wi},"fill-extrusion-pattern":{source:Wi,composite:Wi}}[q]}(f);return B&&B[p]||E[u][p]}Rn("ConstantBinder",ea),Rn("CrossFadedConstantBinder",Jl),Rn("SourceExpressionBinder",fu),Rn("CrossFadedCompositeBinder",xl),Rn("CompositeExpressionBinder",nl),Rn("ProgramConfiguration",Bl,{omit:["_buffers"]}),Rn("ProgramConfigurationSet",du);const Va=8192,yA=Math.pow(2,14)-1,vh=-yA-1;function Hh(f){const u=Va/f.extent,p=f.loadGeometry();for(let E=0;E<p.length;E++){const B=p[E];for(let q=0;q<B.length;q++){const W=B[q],se=Math.round(W.x*u),fe=Math.round(W.y*u);W.x=Ue(se,vh,yA),W.y=Ue(fe,vh,yA),(se<W.x||se>W.x+1||fe<W.y||fe>W.y+1)&&Ye("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function Tc(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Hh(f):[]}}function jh(f,u,p,E,B){f.emplaceBack(2*u+(E+1)/2,2*p+(B+1)/2)}class m0{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new It,this.indexArray=new Nn,this.segments=new nr,this.programConfigurations=new du(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,E){const B=this.layers[0],q=[];let W=null,se=!1;B.type==="circle"&&(W=B.layout.get("circle-sort-key"),se=!W.isConstant());for(const{feature:fe,id:ve,index:Be,sourceLayerIndex:He}of u){const it=this.layers[0]._featureFilter.needGeometry,pt=Tc(fe,it);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),pt,E))continue;const vt=se?W.evaluate(pt,{},E):void 0,Dt={id:ve,properties:fe.properties,type:fe.type,sourceLayerIndex:He,index:Be,geometry:it?pt.geometry:Hh(fe),patterns:{},sortKey:vt};q.push(Dt)}se&&q.sort((fe,ve)=>fe.sortKey-ve.sortKey);for(const fe of q){const{geometry:ve,index:Be,sourceLayerIndex:He}=fe,it=u[Be].feature;this.addFeature(fe,ve,Be,E),p.featureIndex.insert(it,ve,Be,He,this.index)}}update(u,p,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,wr),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,E,B){for(const q of p)for(const W of q){const se=W.x,fe=W.y;if(se<0||se>=Va||fe<0||fe>=Va)continue;const ve=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Be=ve.vertexLength;jh(this.layoutVertexArray,se,fe,-1,-1),jh(this.layoutVertexArray,se,fe,1,-1),jh(this.layoutVertexArray,se,fe,1,1),jh(this.layoutVertexArray,se,fe,-1,1),this.indexArray.emplaceBack(Be,Be+1,Be+2),this.indexArray.emplaceBack(Be,Be+3,Be+2),ve.vertexLength+=4,ve.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,E,{},B)}}function Yc(f,u){for(let p=0;p<f.length;p++)if(Ju(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Ju(f,u[p]))return!0;return!!Kc(f,u)}function Sp(f,u,p){return!!Ju(f,u)||!!df(u,f,p)}function Zh(f,u){if(f.length===1)return eu(u,f[0]);for(let p=0;p<u.length;p++){const E=u[p];for(let B=0;B<E.length;B++)if(Ju(f,E[B]))return!0}for(let p=0;p<f.length;p++)if(eu(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Kc(f,u[p]))return!0;return!1}function ff(f,u,p){if(f.length>1){if(Kc(f,u))return!0;for(let E=0;E<u.length;E++)if(df(u[E],f,p))return!0}for(let E=0;E<f.length;E++)if(df(f[E],u,p))return!0;return!1}function Kc(f,u){if(f.length===0||u.length===0)return!1;for(let p=0;p<f.length-1;p++){const E=f[p],B=f[p+1];for(let q=0;q<u.length-1;q++)if(Ip(E,B,u[q],u[q+1]))return!0}return!1}function Ip(f,u,p,E){return _t(f,p,E)!==_t(u,p,E)&&_t(f,u,p)!==_t(f,u,E)}function df(f,u,p){const E=p*p;if(u.length===1)return f.distSqr(u[0])<E;for(let B=1;B<u.length;B++)if(X0(f,u[B-1],u[B])<E)return!0;return!1}function X0(f,u,p){const E=u.distSqr(p);if(E===0)return f.distSqr(u);const B=((f.x-u.x)*(p.x-u.x)+(f.y-u.y)*(p.y-u.y))/E;return f.distSqr(B<0?u:B>1?p:p.sub(u)._mult(B)._add(u))}function eu(f,u){let p,E,B,q=!1;for(let W=0;W<f.length;W++){p=f[W];for(let se=0,fe=p.length-1;se<p.length;fe=se++)E=p[se],B=p[fe],E.y>u.y!=B.y>u.y&&u.x<(B.x-E.x)*(u.y-E.y)/(B.y-E.y)+E.x&&(q=!q)}return q}function Ju(f,u){let p=!1;for(let E=0,B=f.length-1;E<f.length;B=E++){const q=f[E],W=f[B];q.y>u.y!=W.y>u.y&&u.x<(W.x-q.x)*(u.y-q.y)/(W.y-q.y)+q.x&&(p=!p)}return p}function Y0(f,u,p){const E=p[0],B=p[2];if(f.x<E.x&&u.x<E.x||f.x>B.x&&u.x>B.x||f.y<E.y&&u.y<E.y||f.y>B.y&&u.y>B.y)return!1;const q=_t(f,u,p[0]);return q!==_t(f,u,p[1])||q!==_t(f,u,p[2])||q!==_t(f,u,p[3])}function xh(f,u,p){const E=u.paint.get(f).value;return E.kind==="constant"?E.value:p.programConfigurations.get(u.id).getMaxValue(f)}function Jc(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function vA(f,u,p,E,B){if(!u[0]&&!u[1])return f;const q=ce.convert(u)._mult(B);p==="viewport"&&q._rotate(-E);const W=[];for(let se=0;se<f.length;se++)W.push(f[se].sub(q));return W}let pf,g0;Rn("CircleBucket",m0,{omit:["layers"]});var xs={get paint(){return g0=g0||new ms({"circle-radius":new zi(oi.paint_circle["circle-radius"]),"circle-color":new zi(oi.paint_circle["circle-color"]),"circle-blur":new zi(oi.paint_circle["circle-blur"]),"circle-opacity":new zi(oi.paint_circle["circle-opacity"]),"circle-translate":new Mi(oi.paint_circle["circle-translate"]),"circle-translate-anchor":new Mi(oi.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Mi(oi.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Mi(oi.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new zi(oi.paint_circle["circle-stroke-width"]),"circle-stroke-color":new zi(oi.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new zi(oi.paint_circle["circle-stroke-opacity"])})},get layout(){return pf=pf||new ms({"circle-sort-key":new zi(oi.layout_circle["circle-sort-key"])})}},tu=1e-6,Qh=typeof Float32Array<"u"?Float32Array:Array;function Wh(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function mf(f,u,p){var E=u[0],B=u[1],q=u[2],W=u[3],se=u[4],fe=u[5],ve=u[6],Be=u[7],He=u[8],it=u[9],pt=u[10],vt=u[11],Dt=u[12],Lt=u[13],Rt=u[14],ei=u[15],Zt=p[0],Wt=p[1],hi=p[2],vi=p[3];return f[0]=Zt*E+Wt*se+hi*He+vi*Dt,f[1]=Zt*B+Wt*fe+hi*it+vi*Lt,f[2]=Zt*q+Wt*ve+hi*pt+vi*Rt,f[3]=Zt*W+Wt*Be+hi*vt+vi*ei,f[4]=(Zt=p[4])*E+(Wt=p[5])*se+(hi=p[6])*He+(vi=p[7])*Dt,f[5]=Zt*B+Wt*fe+hi*it+vi*Lt,f[6]=Zt*q+Wt*ve+hi*pt+vi*Rt,f[7]=Zt*W+Wt*Be+hi*vt+vi*ei,f[8]=(Zt=p[8])*E+(Wt=p[9])*se+(hi=p[10])*He+(vi=p[11])*Dt,f[9]=Zt*B+Wt*fe+hi*it+vi*Lt,f[10]=Zt*q+Wt*ve+hi*pt+vi*Rt,f[11]=Zt*W+Wt*Be+hi*vt+vi*ei,f[12]=(Zt=p[12])*E+(Wt=p[13])*se+(hi=p[14])*He+(vi=p[15])*Dt,f[13]=Zt*B+Wt*fe+hi*it+vi*Lt,f[14]=Zt*q+Wt*ve+hi*pt+vi*Rt,f[15]=Zt*W+Wt*Be+hi*vt+vi*ei,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var xA,K0=mf;function zl(f,u,p){var E=u[0],B=u[1],q=u[2],W=u[3];return f[0]=p[0]*E+p[4]*B+p[8]*q+p[12]*W,f[1]=p[1]*E+p[5]*B+p[9]*q+p[13]*W,f[2]=p[2]*E+p[6]*B+p[10]*q+p[14]*W,f[3]=p[3]*E+p[7]*B+p[11]*q+p[15]*W,f}xA=new Qh(4),Qh!=Float32Array&&(xA[0]=0,xA[1]=0,xA[2]=0,xA[3]=0);class qu extends zs{constructor(u){super(u,xs)}createBucket(u){return new m0(u)}queryRadius(u){const p=u;return xh("circle-radius",this,p)+xh("circle-stroke-width",this,p)+Jc(this.paint.get("circle-translate"))}queryIntersectsFeature(u,p,E,B,q,W,se,fe){const ve=vA(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),W.angle,se),Be=this.paint.get("circle-radius").evaluate(p,E)+this.paint.get("circle-stroke-width").evaluate(p,E),He=this.paint.get("circle-pitch-alignment")==="map",it=He?ve:function(vt,Dt){return vt.map(Lt=>bA(Lt,Dt))}(ve,fe),pt=He?Be*se:Be;for(const vt of B)for(const Dt of vt){const Lt=He?Dt:bA(Dt,fe);let Rt=pt;const ei=zl([],[Dt.x,Dt.y,0,1],fe);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Rt*=ei[3]/W.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Rt*=W.cameraToCenterDistance/ei[3]),Sp(it,Lt,Rt))return!0}return!1}}function bA(f,u){const p=zl([],[f.x,f.y,0,1],u);return new ce(p[0]/p[3],p[1]/p[3])}class _0 extends m0{}let y0;Rn("HeatmapBucket",_0,{omit:["layers"]});var Ep={get paint(){return y0=y0||new ms({"heatmap-radius":new zi(oi.paint_heatmap["heatmap-radius"]),"heatmap-weight":new zi(oi.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Mi(oi.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Uo(oi.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Mi(oi.paint_heatmap["heatmap-opacity"])})}};function Su(f,{width:u,height:p},E,B){if(B){if(B instanceof Uint8ClampedArray)B=new Uint8Array(B.buffer);else if(B.length!==u*p*E)throw new RangeError(`mismatched image size. expected: ${B.length} but got: ${u*p*E}`)}else B=new Uint8Array(u*p*E);return f.width=u,f.height=p,f.data=B,f}function eh(f,{width:u,height:p},E){if(u===f.width&&p===f.height)return;const B=Su({},{width:u,height:p},E);gf(f,B,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,p)},E),f.width=u,f.height=p,f.data=B.data}function gf(f,u,p,E,B,q){if(B.width===0||B.height===0)return u;if(B.width>f.width||B.height>f.height||p.x>f.width-B.width||p.y>f.height-B.height)throw new RangeError("out of range source coordinates for image copy");if(B.width>u.width||B.height>u.height||E.x>u.width-B.width||E.y>u.height-B.height)throw new RangeError("out of range destination coordinates for image copy");const W=f.data,se=u.data;if(W===se)throw new Error("srcData equals dstData, so image is already copied");for(let fe=0;fe<B.height;fe++){const ve=((p.y+fe)*f.width+p.x)*q,Be=((E.y+fe)*u.width+E.x)*q;for(let He=0;He<B.width*q;He++)se[Be+He]=W[ve+He]}return u}class bh{constructor(u,p){Su(this,u,1,p)}resize(u){eh(this,u,1)}clone(){return new bh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,E,B,q){gf(u,p,E,B,q,1)}}class Rl{constructor(u,p){Su(this,u,4,p)}resize(u){eh(this,u,4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Rl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,E,B,q){gf(u,p,E,B,q,4)}}function v0(f){const u={},p=f.resolution||256,E=f.clips?f.clips.length:1,B=f.image||new Rl({width:p,height:E});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const q=(W,se,fe)=>{u[f.evaluationKey]=fe;const ve=f.expression.evaluate(u);B.data[W+se+0]=Math.floor(255*ve.r/ve.a),B.data[W+se+1]=Math.floor(255*ve.g/ve.a),B.data[W+se+2]=Math.floor(255*ve.b/ve.a),B.data[W+se+3]=Math.floor(255*ve.a)};if(f.clips)for(let W=0,se=0;W<E;++W,se+=4*p)for(let fe=0,ve=0;fe<p;fe++,ve+=4){const Be=fe/(p-1),{start:He,end:it}=f.clips[W];q(se,ve,He*(1-Be)+it*Be)}else for(let W=0,se=0;W<p;W++,se+=4)q(0,se,W/(p-1));return B}Rn("AlphaImage",bh),Rn("RGBAImage",Rl);class th extends zs{createBucket(u){return new _0(u)}constructor(u){super(u,Ep),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=v0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let $h;var J0={get paint(){return $h=$h||new ms({"hillshade-illumination-direction":new Mi(oi.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Mi(oi.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Mi(oi.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Mi(oi.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Mi(oi.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Mi(oi.paint_hillshade["hillshade-accent-color"])})}};class ed extends zs{constructor(u){super(u,J0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const wh=F([{name:"a_pos",components:2,type:"Int16"}],4),{members:Lm}=wh;var kc={exports:{}};function _f(f,u,p){p=p||2;var E,B,q,W,se,fe,ve,Be=u&&u.length,He=Be?u[0]*p:f.length,it=td(f,0,He,p,!0),pt=[];if(!it||it.next===it.prev)return pt;if(Be&&(it=function(Dt,Lt,Rt,ei){var Zt,Wt,hi,vi=[];for(Zt=0,Wt=Lt.length;Zt<Wt;Zt++)(hi=td(Dt,Lt[Zt]*ei,Zt<Wt-1?Lt[Zt+1]*ei:Dt.length,ei,!1))===hi.next&&(hi.steiner=!0),vi.push(hc(hi));for(vi.sort(Cp),Zt=0;Zt<vi.length;Zt++)Rt=xf(vi[Zt],Rt);return Rt}(f,u,it,p)),f.length>80*p){E=q=f[0],B=W=f[1];for(var vt=p;vt<He;vt+=p)(se=f[vt])<E&&(E=se),(fe=f[vt+1])<B&&(B=fe),se>q&&(q=se),fe>W&&(W=fe);ve=(ve=Math.max(q-E,W-B))!==0?32767/ve:0}return yf(it,pt,p,E,B,ve,0),pt}function td(f,u,p,E,B){var q,W;if(B===IA(f,u,p,E)>0)for(q=u;q<p;q+=E)W=Sh(q,f[q],f[q+1],W);else for(q=p-E;q>=u;q-=E)W=Sh(q,f[q],f[q+1],W);return W&&Ac(W,W.next)&&(Ef(W),W=W.next),W}function cc(f,u){if(!f)return f;u||(u=f);var p,E=f;do if(p=!1,E.steiner||!Ac(E,E.next)&&Ua(E.prev,E,E.next)!==0)E=E.next;else{if(Ef(E),(E=u=E.prev)===E.next)break;p=!0}while(p||E!==u);return u}function yf(f,u,p,E,B,q,W){if(f){!W&&q&&function(Be,He,it,pt){var vt=Be;do vt.z===0&&(vt.z=bl(vt.x,vt.y,He,it,pt)),vt.prevZ=vt.prev,vt.nextZ=vt.next,vt=vt.next;while(vt!==Be);vt.prevZ.nextZ=null,vt.prevZ=null,function(Dt){var Lt,Rt,ei,Zt,Wt,hi,vi,Ji,In=1;do{for(Rt=Dt,Dt=null,Wt=null,hi=0;Rt;){for(hi++,ei=Rt,vi=0,Lt=0;Lt<In&&(vi++,ei=ei.nextZ);Lt++);for(Ji=In;vi>0||Ji>0&&ei;)vi!==0&&(Ji===0||!ei||Rt.z<=ei.z)?(Zt=Rt,Rt=Rt.nextZ,vi--):(Zt=ei,ei=ei.nextZ,Ji--),Wt?Wt.nextZ=Zt:Dt=Zt,Zt.prevZ=Wt,Wt=Zt;Rt=ei}Wt.nextZ=null,In*=2}while(hi>1)}(vt)}(f,E,B,q);for(var se,fe,ve=f;f.prev!==f.next;)if(se=f.prev,fe=f.next,q?Bm(f,E,B,q):wA(f))u.push(se.i/p|0),u.push(f.i/p|0),u.push(fe.i/p|0),Ef(f),f=fe.next,ve=fe.next;else if((f=fe)===ve){W?W===1?yf(f=Ro(cc(f),u,p),u,p,E,B,q,2):W===2&&vf(f,u,p,E,B,q):yf(cc(f),u,p,E,B,q,1);break}}}function wA(f){var u=f.prev,p=f,E=f.next;if(Ua(u,p,E)>=0)return!1;for(var B=u.x,q=p.x,W=E.x,se=u.y,fe=p.y,ve=E.y,Be=B<q?B<W?B:W:q<W?q:W,He=se<fe?se<ve?se:ve:fe<ve?fe:ve,it=B>q?B>W?B:W:q>W?q:W,pt=se>fe?se>ve?se:ve:fe>ve?fe:ve,vt=E.next;vt!==u;){if(vt.x>=Be&&vt.x<=it&&vt.y>=He&&vt.y<=pt&&Xh(B,se,q,fe,W,ve,vt.x,vt.y)&&Ua(vt.prev,vt,vt.next)>=0)return!1;vt=vt.next}return!0}function Bm(f,u,p,E){var B=f.prev,q=f,W=f.next;if(Ua(B,q,W)>=0)return!1;for(var se=B.x,fe=q.x,ve=W.x,Be=B.y,He=q.y,it=W.y,pt=se<fe?se<ve?se:ve:fe<ve?fe:ve,vt=Be<He?Be<it?Be:it:He<it?He:it,Dt=se>fe?se>ve?se:ve:fe>ve?fe:ve,Lt=Be>He?Be>it?Be:it:He>it?He:it,Rt=bl(pt,vt,u,p,E),ei=bl(Dt,Lt,u,p,E),Zt=f.prevZ,Wt=f.nextZ;Zt&&Zt.z>=Rt&&Wt&&Wt.z<=ei;){if(Zt.x>=pt&&Zt.x<=Dt&&Zt.y>=vt&&Zt.y<=Lt&&Zt!==B&&Zt!==W&&Xh(se,Be,fe,He,ve,it,Zt.x,Zt.y)&&Ua(Zt.prev,Zt,Zt.next)>=0||(Zt=Zt.prevZ,Wt.x>=pt&&Wt.x<=Dt&&Wt.y>=vt&&Wt.y<=Lt&&Wt!==B&&Wt!==W&&Xh(se,Be,fe,He,ve,it,Wt.x,Wt.y)&&Ua(Wt.prev,Wt,Wt.next)>=0))return!1;Wt=Wt.nextZ}for(;Zt&&Zt.z>=Rt;){if(Zt.x>=pt&&Zt.x<=Dt&&Zt.y>=vt&&Zt.y<=Lt&&Zt!==B&&Zt!==W&&Xh(se,Be,fe,He,ve,it,Zt.x,Zt.y)&&Ua(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.prevZ}for(;Wt&&Wt.z<=ei;){if(Wt.x>=pt&&Wt.x<=Dt&&Wt.y>=vt&&Wt.y<=Lt&&Wt!==B&&Wt!==W&&Xh(se,Be,fe,He,ve,it,Wt.x,Wt.y)&&Ua(Wt.prev,Wt,Wt.next)>=0)return!1;Wt=Wt.nextZ}return!0}function Ro(f,u,p){var E=f;do{var B=E.prev,q=E.next.next;!Ac(B,q)&&x0(B,E,E.next,q)&&Mc(B,q)&&Mc(q,B)&&(u.push(B.i/p|0),u.push(E.i/p|0),u.push(q.i/p|0),Ef(E),Ef(E.next),E=f=q),E=E.next}while(E!==f);return cc(E)}function vf(f,u,p,E,B,q){var W=f;do{for(var se=W.next.next;se!==W.prev;){if(W.i!==se.i&&wf(W,se)){var fe=Yh(W,se);return W=cc(W,W.next),fe=cc(fe,fe.next),yf(W,u,p,E,B,q,0),void yf(fe,u,p,E,B,q,0)}se=se.next}W=W.next}while(W!==f)}function Cp(f,u){return f.x-u.x}function xf(f,u){var p=function(B,q){var W,se=q,fe=B.x,ve=B.y,Be=-1/0;do{if(ve<=se.y&&ve>=se.next.y&&se.next.y!==se.y){var He=se.x+(ve-se.y)*(se.next.x-se.x)/(se.next.y-se.y);if(He<=fe&&He>Be&&(Be=He,W=se.x<se.next.x?se:se.next,He===fe))return W}se=se.next}while(se!==q);if(!W)return null;var it,pt=W,vt=W.x,Dt=W.y,Lt=1/0;se=W;do fe>=se.x&&se.x>=vt&&fe!==se.x&&Xh(ve<Dt?fe:Be,ve,vt,Dt,ve<Dt?Be:fe,ve,se.x,se.y)&&(it=Math.abs(ve-se.y)/(fe-se.x),Mc(se,B)&&(it<Lt||it===Lt&&(se.x>W.x||se.x===W.x&&bf(W,se)))&&(W=se,Lt=it)),se=se.next;while(se!==pt);return W}(f,u);if(!p)return u;var E=Yh(p,f);return cc(E,E.next),cc(p,p.next)}function bf(f,u){return Ua(f.prev,f,u.prev)<0&&Ua(u.next,f,f.next)<0}function bl(f,u,p,E,B){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*B|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-E)*B|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function hc(f){var u=f,p=f;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==f);return p}function Xh(f,u,p,E,B,q,W,se){return(B-W)*(u-se)>=(f-W)*(q-se)&&(f-W)*(E-se)>=(p-W)*(u-se)&&(p-W)*(q-se)>=(B-W)*(E-se)}function wf(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(p,E){var B=p;do{if(B.i!==p.i&&B.next.i!==p.i&&B.i!==E.i&&B.next.i!==E.i&&x0(B,B.next,p,E))return!0;B=B.next}while(B!==p);return!1}(f,u)&&(Mc(f,u)&&Mc(u,f)&&function(p,E){var B=p,q=!1,W=(p.x+E.x)/2,se=(p.y+E.y)/2;do B.y>se!=B.next.y>se&&B.next.y!==B.y&&W<(B.next.x-B.x)*(se-B.y)/(B.next.y-B.y)+B.x&&(q=!q),B=B.next;while(B!==p);return q}(f,u)&&(Ua(f.prev,f,u.prev)||Ua(f,u.prev,u))||Ac(f,u)&&Ua(f.prev,f,f.next)>0&&Ua(u.prev,u,u.next)>0)}function Ua(f,u,p){return(u.y-f.y)*(p.x-u.x)-(u.x-f.x)*(p.y-u.y)}function Ac(f,u){return f.x===u.x&&f.y===u.y}function x0(f,u,p,E){var B=If(Ua(f,u,p)),q=If(Ua(f,u,E)),W=If(Ua(p,E,f)),se=If(Ua(p,E,u));return B!==q&&W!==se||!(B!==0||!Sf(f,p,u))||!(q!==0||!Sf(f,E,u))||!(W!==0||!Sf(p,f,E))||!(se!==0||!Sf(p,u,E))}function Sf(f,u,p){return u.x<=Math.max(f.x,p.x)&&u.x>=Math.min(f.x,p.x)&&u.y<=Math.max(f.y,p.y)&&u.y>=Math.min(f.y,p.y)}function If(f){return f>0?1:f<0?-1:0}function Mc(f,u){return Ua(f.prev,f,f.next)<0?Ua(f,u,f.next)>=0&&Ua(f,f.prev,u)>=0:Ua(f,u,f.prev)<0||Ua(f,f.next,u)<0}function Yh(f,u){var p=new SA(f.i,f.x,f.y),E=new SA(u.i,u.x,u.y),B=f.next,q=u.prev;return f.next=u,u.prev=f,p.next=B,B.prev=p,E.next=p,p.prev=E,q.next=E,E.prev=q,E}function Sh(f,u,p,E){var B=new SA(f,u,p);return E?(B.next=E.next,B.prev=E,E.next.prev=B,E.next=B):(B.prev=B,B.next=B),B}function Ef(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function SA(f,u,p){this.i=f,this.x=u,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function IA(f,u,p,E){for(var B=0,q=u,W=p-E;q<p;q+=E)B+=(f[W]-f[q])*(f[q+1]+f[W+1]),W=q;return B}kc.exports=_f,kc.exports.default=_f,_f.deviation=function(f,u,p,E){var B=u&&u.length,q=Math.abs(IA(f,0,B?u[0]*p:f.length,p));if(B)for(var W=0,se=u.length;W<se;W++)q-=Math.abs(IA(f,u[W]*p,W<se-1?u[W+1]*p:f.length,p));var fe=0;for(W=0;W<E.length;W+=3){var ve=E[W]*p,Be=E[W+1]*p,He=E[W+2]*p;fe+=Math.abs((f[ve]-f[He])*(f[Be+1]-f[ve+1])-(f[ve]-f[Be])*(f[He+1]-f[ve+1]))}return q===0&&fe===0?0:Math.abs((fe-q)/q)},_f.flatten=function(f){for(var u=f[0][0].length,p={vertices:[],holes:[],dimensions:u},E=0,B=0;B<f.length;B++){for(var q=0;q<f[B].length;q++)for(var W=0;W<u;W++)p.vertices.push(f[B][q][W]);B>0&&p.holes.push(E+=f[B-1].length)}return p};var Kh=$(kc.exports);function id(f,u,p,E,B){EA(f,u,p||0,E||f.length-1,B||b0)}function EA(f,u,p,E,B){for(;E>p;){if(E-p>600){var q=E-p+1,W=u-p+1,se=Math.log(q),fe=.5*Math.exp(2*se/3),ve=.5*Math.sqrt(se*fe*(q-fe)/q)*(W-q/2<0?-1:1);EA(f,u,Math.max(p,Math.floor(u-W*fe/q+ve)),Math.min(E,Math.floor(u+(q-W)*fe/q+ve)),B)}var Be=f[u],He=p,it=E;for(Jh(f,p,u),B(f[E],Be)>0&&Jh(f,p,E);He<it;){for(Jh(f,He,it),He++,it--;B(f[He],Be)<0;)He++;for(;B(f[it],Be)>0;)it--}B(f[p],Be)===0?Jh(f,p,it):Jh(f,++it,E),it<=u&&(p=it+1),u<=it&&(E=it-1)}}function Jh(f,u,p){var E=f[u];f[u]=f[p],f[p]=E}function b0(f,u){return f<u?-1:f>u?1:0}function nd(f,u){const p=f.length;if(p<=1)return[f];const E=[];let B,q;for(let W=0;W<p;W++){const se=ct(f[W]);se!==0&&(f[W].area=Math.abs(se),q===void 0&&(q=se<0),q===se<0?(B&&E.push(B),B=[f[W]]):B.push(f[W]))}if(B&&E.push(B),u>1)for(let W=0;W<E.length;W++)E[W].length<=u||(id(E[W],u,1,E[W].length-1,Tp),E[W]=E[W].slice(0,u));return E}function Tp(f,u){return u.area-f.area}function CA(f,u,p){const E=p.patternDependencies;let B=!1;for(const q of u){const W=q.paint.get(`${f}-pattern`);W.isConstant()||(B=!0);const se=W.constantOr(null);se&&(B=!0,E[se.to]=!0,E[se.from]=!0)}return B}function fc(f,u,p,E,B){const q=B.patternDependencies;for(const W of u){const se=W.paint.get(`${f}-pattern`).value;if(se.kind!=="constant"){let fe=se.evaluate({zoom:E-1},p,{},B.availableImages),ve=se.evaluate({zoom:E},p,{},B.availableImages),Be=se.evaluate({zoom:E+1},p,{},B.availableImages);fe=fe&&fe.name?fe.name:fe,ve=ve&&ve.name?ve.name:ve,Be=Be&&Be.name?Be.name:Be,q[fe]=!0,q[ve]=!0,q[Be]=!0,p.patterns[W.id]={min:fe,mid:ve,max:Be}}}return p}class Cf{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new si,this.indexArray=new Nn,this.indexArray2=new nn,this.programConfigurations=new du(u.layers,u.zoom),this.segments=new nr,this.segments2=new nr,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,E){this.hasPattern=CA("fill",this.layers,p);const B=this.layers[0].layout.get("fill-sort-key"),q=!B.isConstant(),W=[];for(const{feature:se,id:fe,index:ve,sourceLayerIndex:Be}of u){const He=this.layers[0]._featureFilter.needGeometry,it=Tc(se,He);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),it,E))continue;const pt=q?B.evaluate(it,{},E,p.availableImages):void 0,vt={id:fe,properties:se.properties,type:se.type,sourceLayerIndex:Be,index:ve,geometry:He?it.geometry:Hh(se),patterns:{},sortKey:pt};W.push(vt)}q&&W.sort((se,fe)=>se.sortKey-fe.sortKey);for(const se of W){const{geometry:fe,index:ve,sourceLayerIndex:Be}=se;if(this.hasPattern){const He=fc("fill",this.layers,se,this.zoom,p);this.patternFeatures.push(He)}else this.addFeature(se,fe,ve,E,{});p.featureIndex.insert(u[ve].feature,fe,ve,Be,this.index)}}update(u,p,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,E)}addFeatures(u,p,E){for(const B of this.patternFeatures)this.addFeature(B,B.geometry,B.index,p,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Lm),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,E,B,q){for(const W of nd(p,500)){let se=0;for(const pt of W)se+=pt.length;const fe=this.segments.prepareSegment(se,this.layoutVertexArray,this.indexArray),ve=fe.vertexLength,Be=[],He=[];for(const pt of W){if(pt.length===0)continue;pt!==W[0]&&He.push(Be.length/2);const vt=this.segments2.prepareSegment(pt.length,this.layoutVertexArray,this.indexArray2),Dt=vt.vertexLength;this.layoutVertexArray.emplaceBack(pt[0].x,pt[0].y),this.indexArray2.emplaceBack(Dt+pt.length-1,Dt),Be.push(pt[0].x),Be.push(pt[0].y);for(let Lt=1;Lt<pt.length;Lt++)this.layoutVertexArray.emplaceBack(pt[Lt].x,pt[Lt].y),this.indexArray2.emplaceBack(Dt+Lt-1,Dt+Lt),Be.push(pt[Lt].x),Be.push(pt[Lt].y);vt.vertexLength+=pt.length,vt.primitiveLength+=pt.length}const it=Kh(Be,He);for(let pt=0;pt<it.length;pt+=3)this.indexArray.emplaceBack(ve+it[pt],ve+it[pt+1],ve+it[pt+2]);fe.vertexLength+=se,fe.primitiveLength+=it.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,E,q,B)}}let rd,Ih;Rn("FillBucket",Cf,{omit:["layers","patternFeatures"]});var ih={get paint(){return Ih=Ih||new ms({"fill-antialias":new Mi(oi.paint_fill["fill-antialias"]),"fill-opacity":new zi(oi.paint_fill["fill-opacity"]),"fill-color":new zi(oi.paint_fill["fill-color"]),"fill-outline-color":new zi(oi.paint_fill["fill-outline-color"]),"fill-translate":new Mi(oi.paint_fill["fill-translate"]),"fill-translate-anchor":new Mi(oi.paint_fill["fill-translate-anchor"]),"fill-pattern":new Es(oi.paint_fill["fill-pattern"])})},get layout(){return rd=rd||new ms({"fill-sort-key":new zi(oi.layout_fill["fill-sort-key"])})}};class kp extends zs{constructor(u){super(u,ih)}recalculate(u,p){super.recalculate(u,p);const E=this.paint._values["fill-outline-color"];E.value.kind==="constant"&&E.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new Cf(u)}queryRadius(){return Jc(this.paint.get("fill-translate"))}queryIntersectsFeature(u,p,E,B,q,W,se){return Zh(vA(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),W.angle,se),B)}isTileClipped(){return!0}}const Mp=F([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Pp=F([{name:"a_centroid",components:2,type:"Int16"}],4),{members:sd}=Mp;var Eh={},zm=he,Pc=Ch;function Ch(f,u,p,E,B){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=E,this._values=B,f.readFields(Tf,this,u)}function Tf(f,u,p){f==1?u.id=p.readVarint():f==2?function(E,B){for(var q=E.readVarint()+E.pos;E.pos<q;){var W=B._keys[E.readVarint()],se=B._values[E.readVarint()];B.properties[W]=se}}(p,u):f==3?u.type=p.readVarint():f==4&&(u._geometry=p.pos)}function eA(f){for(var u,p,E=0,B=0,q=f.length,W=q-1;B<q;W=B++)E+=((p=f[W]).x-(u=f[B]).x)*(u.y+p.y);return E}Ch.types=["Unknown","Point","LineString","Polygon"],Ch.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,p=f.readVarint()+f.pos,E=1,B=0,q=0,W=0,se=[];f.pos<p;){if(B<=0){var fe=f.readVarint();E=7&fe,B=fe>>3}if(B--,E===1||E===2)q+=f.readSVarint(),W+=f.readSVarint(),E===1&&(u&&se.push(u),u=[]),u.push(new zm(q,W));else{if(E!==7)throw new Error("unknown command "+E);u&&u.push(u[0].clone())}}return u&&se.push(u),se},Ch.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,p=1,E=0,B=0,q=0,W=1/0,se=-1/0,fe=1/0,ve=-1/0;f.pos<u;){if(E<=0){var Be=f.readVarint();p=7&Be,E=Be>>3}if(E--,p===1||p===2)(B+=f.readSVarint())<W&&(W=B),B>se&&(se=B),(q+=f.readSVarint())<fe&&(fe=q),q>ve&&(ve=q);else if(p!==7)throw new Error("unknown command "+p)}return[W,fe,se,ve]},Ch.prototype.toGeoJSON=function(f,u,p){var E,B,q=this.extent*Math.pow(2,p),W=this.extent*f,se=this.extent*u,fe=this.loadGeometry(),ve=Ch.types[this.type];function Be(pt){for(var vt=0;vt<pt.length;vt++){var Dt=pt[vt];pt[vt]=[360*(Dt.x+W)/q-180,360/Math.PI*Math.atan(Math.exp((180-360*(Dt.y+se)/q)*Math.PI/180))-90]}}switch(this.type){case 1:var He=[];for(E=0;E<fe.length;E++)He[E]=fe[E][0];Be(fe=He);break;case 2:for(E=0;E<fe.length;E++)Be(fe[E]);break;case 3:for(fe=function(pt){var vt=pt.length;if(vt<=1)return[pt];for(var Dt,Lt,Rt=[],ei=0;ei<vt;ei++){var Zt=eA(pt[ei]);Zt!==0&&(Lt===void 0&&(Lt=Zt<0),Lt===Zt<0?(Dt&&Rt.push(Dt),Dt=[pt[ei]]):Dt.push(pt[ei]))}return Dt&&Rt.push(Dt),Rt}(fe),E=0;E<fe.length;E++)for(B=0;B<fe[E].length;B++)Be(fe[E][B])}fe.length===1?fe=fe[0]:ve="Multi"+ve;var it={type:"Feature",geometry:{type:ve,coordinates:fe},properties:this.properties};return"id"in this&&(it.id=this.id),it};var TA=Pc,tA=Dr;function Dr(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(kf,this,u),this.length=this._features.length}function kf(f,u,p){f===15?u.version=p.readVarint():f===1?u.name=p.readString():f===5?u.extent=p.readVarint():f===2?u._features.push(p.pos):f===3?u._keys.push(p.readString()):f===4&&u._values.push(function(E){for(var B=null,q=E.readVarint()+E.pos;E.pos<q;){var W=E.readVarint()>>3;B=W===1?E.readString():W===2?E.readFloat():W===3?E.readDouble():W===4?E.readVarint64():W===5?E.readVarint():W===6?E.readSVarint():W===7?E.readBoolean():null}return B}(p))}Dr.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new TA(this._pbf,u,this.extent,this._keys,this._values)};var ad=tA;function iA(f,u,p){if(f===3){var E=new ad(p,p.readVarint()+p.pos);E.length&&(u[E.name]=E)}}Eh.VectorTile=function(f,u){this.layers=f.readFields(iA,{},u)},Eh.VectorTileFeature=Pc,Eh.VectorTileLayer=tA;const Mf=Eh.VectorTileFeature.types,kA=Math.pow(2,13);function MA(f,u,p,E,B,q,W,se){f.emplaceBack(u,p,2*Math.floor(E*kA)+W,B*kA*2,q*kA*2,Math.round(se))}class Hl{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new Kt,this.centroidVertexArray=new Tt,this.indexArray=new Nn,this.programConfigurations=new du(u.layers,u.zoom),this.segments=new nr,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,E){this.features=[],this.hasPattern=CA("fill-extrusion",this.layers,p);for(const{feature:B,id:q,index:W,sourceLayerIndex:se}of u){const fe=this.layers[0]._featureFilter.needGeometry,ve=Tc(B,fe);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),ve,E))continue;const Be={id:q,sourceLayerIndex:se,index:W,geometry:fe?ve.geometry:Hh(B),properties:B.properties,type:B.type,patterns:{}};this.hasPattern?this.features.push(fc("fill-extrusion",this.layers,Be,this.zoom,p)):this.addFeature(Be,Be.geometry,W,E,{}),p.featureIndex.insert(B,Be.geometry,W,se,this.index,!0)}}addFeatures(u,p,E){for(const B of this.features){const{geometry:q}=B;this.addFeature(B,q,B.index,p,E)}}update(u,p,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,E)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,sd),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,Pp.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,p,E,B,q){const W={x:0,y:0,vertexCount:0};for(const se of nd(p,500)){let fe=0;for(const vt of se)fe+=vt.length;let ve=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const vt of se){if(vt.length===0||Fm(vt))continue;let Dt=0;for(let Lt=0;Lt<vt.length;Lt++){const Rt=vt[Lt];if(Lt>=1){const ei=vt[Lt-1];if(!Rm(Rt,ei)){ve.vertexLength+4>nr.MAX_VERTEX_ARRAY_LENGTH&&(ve=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Zt=Rt.sub(ei)._perp()._unit(),Wt=ei.dist(Rt);Dt+Wt>32768&&(Dt=0),MA(this.layoutVertexArray,Rt.x,Rt.y,Zt.x,Zt.y,0,0,Dt),MA(this.layoutVertexArray,Rt.x,Rt.y,Zt.x,Zt.y,0,1,Dt),W.x+=2*Rt.x,W.y+=2*Rt.y,W.vertexCount+=2,Dt+=Wt,MA(this.layoutVertexArray,ei.x,ei.y,Zt.x,Zt.y,0,0,Dt),MA(this.layoutVertexArray,ei.x,ei.y,Zt.x,Zt.y,0,1,Dt),W.x+=2*ei.x,W.y+=2*ei.y,W.vertexCount+=2;const hi=ve.vertexLength;this.indexArray.emplaceBack(hi,hi+2,hi+1),this.indexArray.emplaceBack(hi+1,hi+2,hi+3),ve.vertexLength+=4,ve.primitiveLength+=2}}}}if(ve.vertexLength+fe>nr.MAX_VERTEX_ARRAY_LENGTH&&(ve=this.segments.prepareSegment(fe,this.layoutVertexArray,this.indexArray)),Mf[u.type]!=="Polygon")continue;const Be=[],He=[],it=ve.vertexLength;for(const vt of se)if(vt.length!==0){vt!==se[0]&&He.push(Be.length/2);for(let Dt=0;Dt<vt.length;Dt++){const Lt=vt[Dt];MA(this.layoutVertexArray,Lt.x,Lt.y,0,0,1,1,0),W.x+=Lt.x,W.y+=Lt.y,W.vertexCount+=1,Be.push(Lt.x),Be.push(Lt.y)}}const pt=Kh(Be,He);for(let vt=0;vt<pt.length;vt+=3)this.indexArray.emplaceBack(it+pt[vt],it+pt[vt+2],it+pt[vt+1]);ve.primitiveLength+=pt.length/3,ve.vertexLength+=fe}for(let se=0;se<W.vertexCount;se++)this.centroidVertexArray.emplaceBack(Math.floor(W.x/W.vertexCount),Math.floor(W.y/W.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,E,q,B)}}function Rm(f,u){return f.x===u.x&&(f.x<0||f.x>Va)||f.y===u.y&&(f.y<0||f.y>Va)}function Fm(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Va)||f.every(u=>u.y<0)||f.every(u=>u.y>Va)}let od;Rn("FillExtrusionBucket",Hl,{omit:["layers","features"]});var Om={get paint(){return od=od||new ms({"fill-extrusion-opacity":new Mi(oi["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new zi(oi["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Mi(oi["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Mi(oi["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Es(oi["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new zi(oi["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new zi(oi["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Mi(oi["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ld extends zs{constructor(u){super(u,Om)}createBucket(u){return new Hl(u)}queryRadius(){return Jc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(u,p,E,B,q,W,se,fe){const ve=vA(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),W.angle,se),Be=this.paint.get("fill-extrusion-height").evaluate(p,E),He=this.paint.get("fill-extrusion-base").evaluate(p,E),it=function(vt,Dt,Lt,Rt){const ei=[];for(const Zt of vt){const Wt=[Zt.x,Zt.y,0,1];zl(Wt,Wt,Dt),ei.push(new ce(Wt[0]/Wt[3],Wt[1]/Wt[3]))}return ei}(ve,fe),pt=function(vt,Dt,Lt,Rt){const ei=[],Zt=[],Wt=Rt[8]*Dt,hi=Rt[9]*Dt,vi=Rt[10]*Dt,Ji=Rt[11]*Dt,In=Rt[8]*Lt,un=Rt[9]*Lt,ln=Rt[10]*Lt,dn=Rt[11]*Lt;for(const Vn of vt){const on=[],Ki=[];for(const Fn of Vn){const Un=Fn.x,gr=Fn.y,jr=Rt[0]*Un+Rt[4]*gr+Rt[12],Xr=Rt[1]*Un+Rt[5]*gr+Rt[13],Us=Rt[2]*Un+Rt[6]*gr+Rt[14],Da=Rt[3]*Un+Rt[7]*gr+Rt[15],la=Us+vi,us=Da+Ji,Yn=jr+In,Ts=Xr+un,rr=Us+ln,ua=Da+dn,Rs=new ce((jr+Wt)/us,(Xr+hi)/us);Rs.z=la/us,on.push(Rs);const tr=new ce(Yn/ua,Ts/ua);tr.z=rr/ua,Ki.push(tr)}ei.push(on),Zt.push(Ki)}return[ei,Zt]}(B,He,Be,fe);return function(vt,Dt,Lt){let Rt=1/0;Zh(Lt,Dt)&&(Rt=ud(Lt,Dt[0]));for(let ei=0;ei<Dt.length;ei++){const Zt=Dt[ei],Wt=vt[ei];for(let hi=0;hi<Zt.length-1;hi++){const vi=Zt[hi],Ji=[vi,Zt[hi+1],Wt[hi+1],Wt[hi],vi];Yc(Lt,Ji)&&(Rt=Math.min(Rt,ud(Lt,Ji)))}}return Rt!==1/0&&Rt}(pt[0],pt[1],it)}}function nA(f,u){return f.x*u.x+f.y*u.y}function ud(f,u){if(f.length===1){let p=0;const E=u[p++];let B;for(;!B||E.equals(B);)if(B=u[p++],!B)return 1/0;for(;p<u.length;p++){const q=u[p],W=f[0],se=B.sub(E),fe=q.sub(E),ve=W.sub(E),Be=nA(se,se),He=nA(se,fe),it=nA(fe,fe),pt=nA(ve,se),vt=nA(ve,fe),Dt=Be*it-He*He,Lt=(it*pt-He*vt)/Dt,Rt=(Be*vt-He*pt)/Dt,ei=E.z*(1-Lt-Rt)+B.z*Lt+q.z*Rt;if(isFinite(ei))return ei}return 1/0}{let p=1/0;for(const E of u)p=Math.min(p,E.z);return p}}const Dp=F([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Dc}=Dp,Iu=F([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:PA}=Iu,Nm=Eh.VectorTileFeature.types,w0=Math.cos(Math.PI/180*37.5),Lp=Math.pow(2,14)/.5;class cd{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new ii,this.layoutVertexArray2=new ai,this.indexArray=new Nn,this.programConfigurations=new du(u.layers,u.zoom),this.segments=new nr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,E){this.hasPattern=CA("line",this.layers,p);const B=this.layers[0].layout.get("line-sort-key"),q=!B.isConstant(),W=[];for(const{feature:se,id:fe,index:ve,sourceLayerIndex:Be}of u){const He=this.layers[0]._featureFilter.needGeometry,it=Tc(se,He);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),it,E))continue;const pt=q?B.evaluate(it,{},E):void 0,vt={id:fe,properties:se.properties,type:se.type,sourceLayerIndex:Be,index:ve,geometry:He?it.geometry:Hh(se),patterns:{},sortKey:pt};W.push(vt)}q&&W.sort((se,fe)=>se.sortKey-fe.sortKey);for(const se of W){const{geometry:fe,index:ve,sourceLayerIndex:Be}=se;if(this.hasPattern){const He=fc("line",this.layers,se,this.zoom,p);this.patternFeatures.push(He)}else this.addFeature(se,fe,ve,E,{});p.featureIndex.insert(u[ve].feature,fe,ve,Be,this.index)}}update(u,p,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,E)}addFeatures(u,p,E){for(const B of this.patternFeatures)this.addFeature(B,B.geometry,B.index,p,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,PA)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Dc),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,E,B,q){const W=this.layers[0].layout,se=W.get("line-join").evaluate(u,{}),fe=W.get("line-cap"),ve=W.get("line-miter-limit"),Be=W.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const He of p)this.addLine(He,u,se,fe,ve,Be);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,E,q,B)}addLine(u,p,E,B,q,W){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Rt=0;Rt<u.length-1;Rt++)this.totalDistance+=u[Rt].dist(u[Rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const se=Nm[p.type]==="Polygon";let fe=u.length;for(;fe>=2&&u[fe-1].equals(u[fe-2]);)fe--;let ve=0;for(;ve<fe-1&&u[ve].equals(u[ve+1]);)ve++;if(fe<(se?3:2))return;E==="bevel"&&(q=1.05);const Be=this.overscaling<=16?15*Va/(512*this.overscaling):0,He=this.segments.prepareSegment(10*fe,this.layoutVertexArray,this.indexArray);let it,pt,vt,Dt,Lt;this.e1=this.e2=-1,se&&(it=u[fe-2],Lt=u[ve].sub(it)._unit()._perp());for(let Rt=ve;Rt<fe;Rt++){if(vt=Rt===fe-1?se?u[ve+1]:void 0:u[Rt+1],vt&&u[Rt].equals(vt))continue;Lt&&(Dt=Lt),it&&(pt=it),it=u[Rt],Lt=vt?vt.sub(it)._unit()._perp():Dt,Dt=Dt||Lt;let ei=Dt.add(Lt);ei.x===0&&ei.y===0||ei._unit();const Zt=Dt.x*Lt.x+Dt.y*Lt.y,Wt=ei.x*Lt.x+ei.y*Lt.y,hi=Wt!==0?1/Wt:1/0,vi=2*Math.sqrt(2-2*Wt),Ji=Wt<w0&&pt&&vt,In=Dt.x*Lt.y-Dt.y*Lt.x>0;if(Ji&&Rt>ve){const dn=it.dist(pt);if(dn>2*Be){const Vn=it.sub(it.sub(pt)._mult(Be/dn)._round());this.updateDistance(pt,Vn),this.addCurrentVertex(Vn,Dt,0,0,He),pt=Vn}}const un=pt&&vt;let ln=un?E:se?"butt":B;if(un&&ln==="round"&&(hi<W?ln="miter":hi<=2&&(ln="fakeround")),ln==="miter"&&hi>q&&(ln="bevel"),ln==="bevel"&&(hi>2&&(ln="flipbevel"),hi<q&&(ln="miter")),pt&&this.updateDistance(pt,it),ln==="miter")ei._mult(hi),this.addCurrentVertex(it,ei,0,0,He);else if(ln==="flipbevel"){if(hi>100)ei=Lt.mult(-1);else{const dn=hi*Dt.add(Lt).mag()/Dt.sub(Lt).mag();ei._perp()._mult(dn*(In?-1:1))}this.addCurrentVertex(it,ei,0,0,He),this.addCurrentVertex(it,ei.mult(-1),0,0,He)}else if(ln==="bevel"||ln==="fakeround"){const dn=-Math.sqrt(hi*hi-1),Vn=In?dn:0,on=In?0:dn;if(pt&&this.addCurrentVertex(it,Dt,Vn,on,He),ln==="fakeround"){const Ki=Math.round(180*vi/Math.PI/20);for(let Fn=1;Fn<Ki;Fn++){let Un=Fn/Ki;if(Un!==.5){const jr=Un-.5;Un+=Un*jr*(Un-1)*((1.0904+Zt*(Zt*(3.55645-1.43519*Zt)-3.2452))*jr*jr+(.848013+Zt*(.215638*Zt-1.06021)))}const gr=Lt.sub(Dt)._mult(Un)._add(Dt)._unit()._mult(In?-1:1);this.addHalfVertex(it,gr.x,gr.y,!1,In,0,He)}}vt&&this.addCurrentVertex(it,Lt,-Vn,-on,He)}else if(ln==="butt")this.addCurrentVertex(it,ei,0,0,He);else if(ln==="square"){const dn=pt?1:-1;this.addCurrentVertex(it,ei,dn,dn,He)}else ln==="round"&&(pt&&(this.addCurrentVertex(it,Dt,0,0,He),this.addCurrentVertex(it,Dt,1,1,He,!0)),vt&&(this.addCurrentVertex(it,Lt,-1,-1,He,!0),this.addCurrentVertex(it,Lt,0,0,He)));if(Ji&&Rt<fe-1){const dn=it.dist(vt);if(dn>2*Be){const Vn=it.add(vt.sub(it)._mult(Be/dn)._round());this.updateDistance(it,Vn),this.addCurrentVertex(Vn,Lt,0,0,He),it=Vn}}}}addCurrentVertex(u,p,E,B,q,W=!1){const se=p.y*B-p.x,fe=-p.y-p.x*B;this.addHalfVertex(u,p.x+p.y*E,p.y-p.x*E,W,!1,E,q),this.addHalfVertex(u,se,fe,W,!0,-B,q),this.distance>Lp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(u,p,E,B,q,W))}addHalfVertex({x:u,y:p},E,B,q,W,se,fe){const ve=.5*(this.lineClips?this.scaledDistance*(Lp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(q?1:0),(p<<1)+(W?1:0),Math.round(63*E)+128,Math.round(63*B)+128,1+(se===0?0:se<0?-1:1)|(63&ve)<<2,ve>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Be=fe.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Be),fe.primitiveLength++),W?this.e2=Be:this.e1=Be}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}let DA,S0;Rn("LineBucket",cd,{omit:["layers","patternFeatures"]});var hd={get paint(){return S0=S0||new ms({"line-opacity":new zi(oi.paint_line["line-opacity"]),"line-color":new zi(oi.paint_line["line-color"]),"line-translate":new Mi(oi.paint_line["line-translate"]),"line-translate-anchor":new Mi(oi.paint_line["line-translate-anchor"]),"line-width":new zi(oi.paint_line["line-width"]),"line-gap-width":new zi(oi.paint_line["line-gap-width"]),"line-offset":new zi(oi.paint_line["line-offset"]),"line-blur":new zi(oi.paint_line["line-blur"]),"line-dasharray":new wu(oi.paint_line["line-dasharray"]),"line-pattern":new Es(oi.paint_line["line-pattern"]),"line-gradient":new Uo(oi.paint_line["line-gradient"])})},get layout(){return DA=DA||new ms({"line-cap":new Mi(oi.layout_line["line-cap"]),"line-join":new zi(oi.layout_line["line-join"]),"line-miter-limit":new Mi(oi.layout_line["line-miter-limit"]),"line-round-limit":new Mi(oi.layout_line["line-round-limit"]),"line-sort-key":new zi(oi.layout_line["line-sort-key"])})}};class Vm extends zi{possiblyEvaluate(u,p){return p=new gn(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),super.possiblyEvaluate(u,p)}evaluate(u,p,E,B){return p=rt({},p,{zoom:Math.floor(p.zoom)}),super.evaluate(u,p,E,B)}}let Th;class fl extends zs{constructor(u){super(u,hd),this.gradientVersion=0,Th||(Th=new Vm(hd.paint.properties["line-width"].specification),Th.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const p=this.gradientExpression();this.stepInterpolant=!!function(E){return E._styleExpression!==void 0}(p)&&p._styleExpression.expression instanceof sr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,p){super.recalculate(u,p),this.paint._values["line-floorwidth"]=Th.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new cd(u)}queryRadius(u){const p=u,E=Ad(xh("line-width",this,p),xh("line-gap-width",this,p)),B=xh("line-offset",this,p);return E/2+Math.abs(B)+Jc(this.paint.get("line-translate"))}queryIntersectsFeature(u,p,E,B,q,W,se){const fe=vA(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),W.angle,se),ve=se/2*Ad(this.paint.get("line-width").evaluate(p,E),this.paint.get("line-gap-width").evaluate(p,E)),Be=this.paint.get("line-offset").evaluate(p,E);return Be&&(B=function(He,it){const pt=[];for(let vt=0;vt<He.length;vt++){const Dt=He[vt],Lt=[];for(let Rt=0;Rt<Dt.length;Rt++){const ei=Dt[Rt-1],Zt=Dt[Rt],Wt=Dt[Rt+1],hi=Rt===0?new ce(0,0):Zt.sub(ei)._unit()._perp(),vi=Rt===Dt.length-1?new ce(0,0):Wt.sub(Zt)._unit()._perp(),Ji=hi._add(vi)._unit(),In=Ji.x*vi.x+Ji.y*vi.y;In!==0&&Ji._mult(1/In),Lt.push(Ji._mult(it)._add(Zt))}pt.push(Lt)}return pt}(B,Be*se)),function(He,it,pt){for(let vt=0;vt<it.length;vt++){const Dt=it[vt];if(He.length>=3){for(let Lt=0;Lt<Dt.length;Lt++)if(Ju(He,Dt[Lt]))return!0}if(ff(He,Dt,pt))return!0}return!1}(fe,B,ve)}isTileClipped(){return!0}}function Ad(f,u){return u>0?u+2*f:f}const fd=F([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),dd=F([{name:"a_projected_pos",components:3,type:"Float32"}],4);F([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ya=F([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);F([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const LA=F([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),pd=F([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function BA(f,u,p){return f.sections.forEach(E=>{E.text=function(B,q,W){const se=q.layout.get("text-transform").evaluate(W,{});return se==="uppercase"?B=B.toLocaleUpperCase():se==="lowercase"&&(B=B.toLocaleLowerCase()),vs.applyArabicShaping&&(B=vs.applyArabicShaping(B)),B}(E.text,u,p)}),f}F([{name:"triangle",components:3,type:"Uint16"}]),F([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),F([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),F([{type:"Float32",name:"offsetX"}]),F([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),F([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Eu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var so=24,I0=bs,Pf=function(f,u,p,E,B){var q,W,se=8*B-E-1,fe=(1<<se)-1,ve=fe>>1,Be=-7,He=p?B-1:0,it=p?-1:1,pt=f[u+He];for(He+=it,q=pt&(1<<-Be)-1,pt>>=-Be,Be+=se;Be>0;q=256*q+f[u+He],He+=it,Be-=8);for(W=q&(1<<-Be)-1,q>>=-Be,Be+=E;Be>0;W=256*W+f[u+He],He+=it,Be-=8);if(q===0)q=1-ve;else{if(q===fe)return W?NaN:1/0*(pt?-1:1);W+=Math.pow(2,E),q-=ve}return(pt?-1:1)*W*Math.pow(2,q-E)},md=function(f,u,p,E,B,q){var W,se,fe,ve=8*q-B-1,Be=(1<<ve)-1,He=Be>>1,it=B===23?Math.pow(2,-24)-Math.pow(2,-77):0,pt=E?0:q-1,vt=E?1:-1,Dt=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(se=isNaN(u)?1:0,W=Be):(W=Math.floor(Math.log(u)/Math.LN2),u*(fe=Math.pow(2,-W))<1&&(W--,fe*=2),(u+=W+He>=1?it/fe:it*Math.pow(2,1-He))*fe>=2&&(W++,fe/=2),W+He>=Be?(se=0,W=Be):W+He>=1?(se=(u*fe-1)*Math.pow(2,B),W+=He):(se=u*Math.pow(2,He-1)*Math.pow(2,B),W=0));B>=8;f[p+pt]=255&se,pt+=vt,se/=256,B-=8);for(W=W<<B|se,ve+=B;ve>0;f[p+pt]=255&W,pt+=vt,W/=256,ve-=8);f[p+pt-vt]|=128*Dt};function bs(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}bs.Varint=0,bs.Fixed64=1,bs.Bytes=2,bs.Fixed32=5;var nh=4294967296,Bp=1/nh,gd=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function rh(f){return f.type===bs.Bytes?f.readVarint()+f.pos:f.pos+1}function zA(f,u,p){return p?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function zp(f,u,p){var E=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));p.realloc(E);for(var B=p.pos-1;B>=f;B--)p.buf[B+E]=p.buf[B]}function E0(f,u){for(var p=0;p<f.length;p++)u.writeVarint(f[p])}function RA(f,u){for(var p=0;p<f.length;p++)u.writeSVarint(f[p])}function Rp(f,u){for(var p=0;p<f.length;p++)u.writeFloat(f[p])}function _d(f,u){for(var p=0;p<f.length;p++)u.writeDouble(f[p])}function yd(f,u){for(var p=0;p<f.length;p++)u.writeBoolean(f[p])}function Um(f,u){for(var p=0;p<f.length;p++)u.writeFixed32(f[p])}function Gm(f,u){for(var p=0;p<f.length;p++)u.writeSFixed32(f[p])}function qm(f,u){for(var p=0;p<f.length;p++)u.writeFixed64(f[p])}function vd(f,u){for(var p=0;p<f.length;p++)u.writeSFixed64(f[p])}function FA(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function dl(f,u,p){f[p]=u,f[p+1]=u>>>8,f[p+2]=u>>>16,f[p+3]=u>>>24}function C0(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}bs.prototype={destroy:function(){this.buf=null},readFields:function(f,u,p){for(p=p||this.length;this.pos<p;){var E=this.readVarint(),B=E>>3,q=this.pos;this.type=7&E,f(B,u,this),this.pos===q&&this.skip(E)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=FA(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=C0(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=FA(this.buf,this.pos)+FA(this.buf,this.pos+4)*nh;return this.pos+=8,f},readSFixed64:function(){var f=FA(this.buf,this.pos)+C0(this.buf,this.pos+4)*nh;return this.pos+=8,f},readFloat:function(){var f=Pf(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=Pf(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,p,E=this.buf;return u=127&(p=E[this.pos++]),p<128?u:(u|=(127&(p=E[this.pos++]))<<7,p<128?u:(u|=(127&(p=E[this.pos++]))<<14,p<128?u:(u|=(127&(p=E[this.pos++]))<<21,p<128?u:function(B,q,W){var se,fe,ve=W.buf;if(se=(112&(fe=ve[W.pos++]))>>4,fe<128||(se|=(127&(fe=ve[W.pos++]))<<3,fe<128)||(se|=(127&(fe=ve[W.pos++]))<<10,fe<128)||(se|=(127&(fe=ve[W.pos++]))<<17,fe<128)||(se|=(127&(fe=ve[W.pos++]))<<24,fe<128)||(se|=(1&(fe=ve[W.pos++]))<<31,fe<128))return zA(B,se,q);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(p=E[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&gd?function(p,E,B){return gd.decode(p.subarray(E,B))}(this.buf,u,f):function(p,E,B){for(var q="",W=E;W<B;){var se,fe,ve,Be=p[W],He=null,it=Be>239?4:Be>223?3:Be>191?2:1;if(W+it>B)break;it===1?Be<128&&(He=Be):it===2?(192&(se=p[W+1]))==128&&(He=(31&Be)<<6|63&se)<=127&&(He=null):it===3?(fe=p[W+2],(192&(se=p[W+1]))==128&&(192&fe)==128&&((He=(15&Be)<<12|(63&se)<<6|63&fe)<=2047||He>=55296&&He<=57343)&&(He=null)):it===4&&(fe=p[W+2],ve=p[W+3],(192&(se=p[W+1]))==128&&(192&fe)==128&&(192&ve)==128&&((He=(15&Be)<<18|(63&se)<<12|(63&fe)<<6|63&ve)<=65535||He>=1114112)&&(He=null)),He===null?(He=65533,it=1):He>65535&&(He-=65536,q+=String.fromCharCode(He>>>10&1023|55296),He=56320|1023&He),q+=String.fromCharCode(He),W+=it}return q}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==bs.Bytes)return f.push(this.readVarint(u));var p=rh(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==bs.Bytes)return f.push(this.readSVarint());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==bs.Bytes)return f.push(this.readBoolean());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==bs.Bytes)return f.push(this.readFloat());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==bs.Bytes)return f.push(this.readDouble());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==bs.Bytes)return f.push(this.readFixed32());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==bs.Bytes)return f.push(this.readSFixed32());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==bs.Bytes)return f.push(this.readFixed64());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==bs.Bytes)return f.push(this.readSFixed64());var u=rh(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===bs.Varint)for(;this.buf[this.pos++]>127;);else if(u===bs.Bytes)this.pos=this.readVarint()+this.pos;else if(u===bs.Fixed32)this.pos+=4;else{if(u!==bs.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),dl(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),dl(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),dl(this.buf,-1&f,this.pos),dl(this.buf,Math.floor(f*Bp),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),dl(this.buf,-1&f,this.pos),dl(this.buf,Math.floor(f*Bp),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,p){var E,B;if(u>=0?(E=u%4294967296|0,B=u/4294967296|0):(B=~(-u/4294967296),4294967295^(E=~(-u%4294967296))?E=E+1|0:(E=0,B=B+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(q,W,se){se.buf[se.pos++]=127&q|128,q>>>=7,se.buf[se.pos++]=127&q|128,q>>>=7,se.buf[se.pos++]=127&q|128,q>>>=7,se.buf[se.pos++]=127&q|128,se.buf[se.pos]=127&(q>>>=7)}(E,0,p),function(q,W){var se=(7&q)<<4;W.buf[W.pos++]|=se|((q>>>=3)?128:0),q&&(W.buf[W.pos++]=127&q|((q>>>=7)?128:0),q&&(W.buf[W.pos++]=127&q|((q>>>=7)?128:0),q&&(W.buf[W.pos++]=127&q|((q>>>=7)?128:0),q&&(W.buf[W.pos++]=127&q|((q>>>=7)?128:0),q&&(W.buf[W.pos++]=127&q)))))}(B,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(E,B,q){for(var W,se,fe=0;fe<B.length;fe++){if((W=B.charCodeAt(fe))>55295&&W<57344){if(!se){W>56319||fe+1===B.length?(E[q++]=239,E[q++]=191,E[q++]=189):se=W;continue}if(W<56320){E[q++]=239,E[q++]=191,E[q++]=189,se=W;continue}W=se-55296<<10|W-56320|65536,se=null}else se&&(E[q++]=239,E[q++]=191,E[q++]=189,se=null);W<128?E[q++]=W:(W<2048?E[q++]=W>>6|192:(W<65536?E[q++]=W>>12|224:(E[q++]=W>>18|240,E[q++]=W>>12&63|128),E[q++]=W>>6&63|128),E[q++]=63&W|128)}return q}(this.buf,f,this.pos);var p=this.pos-u;p>=128&&zp(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),md(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),md(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var p=0;p<u;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,u){this.pos++;var p=this.pos;f(u,this);var E=this.pos-p;E>=128&&zp(p,E,this),this.pos=p-1,this.writeVarint(E),this.pos+=E},writeMessage:function(f,u,p){this.writeTag(f,bs.Bytes),this.writeRawMessage(u,p)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,E0,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,RA,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,yd,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,Rp,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,_d,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,Um,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,Gm,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,qm,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,vd,u)},writeBytesField:function(f,u){this.writeTag(f,bs.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,bs.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,bs.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,bs.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,bs.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,bs.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,bs.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,bs.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,bs.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,bs.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};var T0=$(I0);const Lc=3;function OA(f,u,p){f===1&&p.readMessage(Df,u)}function Df(f,u,p){if(f===3){const{id:E,bitmap:B,width:q,height:W,left:se,top:fe,advance:ve}=p.readMessage(NA,{});u.push({id:E,bitmap:new bh({width:q+2*Lc,height:W+2*Lc},B),metrics:{width:q,height:W,left:se,top:fe,advance:ve}})}}function NA(f,u,p){f===1?u.id=p.readVarint():f===2?u.bitmap=p.readBytes():f===3?u.width=p.readVarint():f===4?u.height=p.readVarint():f===5?u.left=p.readSVarint():f===6?u.top=p.readSVarint():f===7&&(u.advance=p.readVarint())}const Lf=Lc;function Bf(f){let u=0,p=0;for(const W of f)u+=W.w*W.h,p=Math.max(p,W.w);f.sort((W,se)=>se.h-W.h);const E=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let B=0,q=0;for(const W of f)for(let se=E.length-1;se>=0;se--){const fe=E[se];if(!(W.w>fe.w||W.h>fe.h)){if(W.x=fe.x,W.y=fe.y,q=Math.max(q,W.y+W.h),B=Math.max(B,W.x+W.w),W.w===fe.w&&W.h===fe.h){const ve=E.pop();se<E.length&&(E[se]=ve)}else W.h===fe.h?(fe.x+=W.w,fe.w-=W.w):W.w===fe.w?(fe.y+=W.h,fe.h-=W.h):(E.push({x:fe.x+W.w,y:fe.y,w:fe.w-W.w,h:W.h}),fe.y+=W.h,fe.h-=W.h);break}}return{w:B,h:q,fill:u/(B*q)||0}}const Cu=1;class k0{constructor(u,{pixelRatio:p,version:E,stretchX:B,stretchY:q,content:W}){this.paddedRect=u,this.pixelRatio=p,this.stretchX=B,this.stretchY=q,this.content=W,this.version=E}get tl(){return[this.paddedRect.x+Cu,this.paddedRect.y+Cu]}get br(){return[this.paddedRect.x+this.paddedRect.w-Cu,this.paddedRect.y+this.paddedRect.h-Cu]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Cu)/this.pixelRatio,(this.paddedRect.h-2*Cu)/this.pixelRatio]}}class Du{constructor(u,p){const E={},B={};this.haveRenderCallbacks=[];const q=[];this.addImages(u,E,q),this.addImages(p,B,q);const{w:W,h:se}=Bf(q),fe=new Rl({width:W||1,height:se||1});for(const ve in u){const Be=u[ve],He=E[ve].paddedRect;Rl.copy(Be.data,fe,{x:0,y:0},{x:He.x+Cu,y:He.y+Cu},Be.data)}for(const ve in p){const Be=p[ve],He=B[ve].paddedRect,it=He.x+Cu,pt=He.y+Cu,vt=Be.data.width,Dt=Be.data.height;Rl.copy(Be.data,fe,{x:0,y:0},{x:it,y:pt},Be.data),Rl.copy(Be.data,fe,{x:0,y:Dt-1},{x:it,y:pt-1},{width:vt,height:1}),Rl.copy(Be.data,fe,{x:0,y:0},{x:it,y:pt+Dt},{width:vt,height:1}),Rl.copy(Be.data,fe,{x:vt-1,y:0},{x:it-1,y:pt},{width:1,height:Dt}),Rl.copy(Be.data,fe,{x:0,y:0},{x:it+vt,y:pt},{width:1,height:Dt})}this.image=fe,this.iconPositions=E,this.patternPositions=B}addImages(u,p,E){for(const B in u){const q=u[B],W={x:0,y:0,w:q.data.width+2*Cu,h:q.data.height+2*Cu};E.push(W),p[B]=new k0(W,q),q.hasRenderCallback&&this.haveRenderCallbacks.push(B)}}patchUpdatedImages(u,p){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const E in u.updatedImages)this.patchUpdatedImage(this.iconPositions[E],u.getImage(E),p),this.patchUpdatedImage(this.patternPositions[E],u.getImage(E),p)}patchUpdatedImage(u,p,E){if(!u||!p||u.version===p.version)return;u.version=p.version;const[B,q]=u.tl;E.update(p.data,void 0,{x:B,y:q})}}var kh;Rn("ImagePosition",k0),Rn("ImageAtlas",Du),a.ai=void 0,(kh=a.ai||(a.ai={}))[kh.none=0]="none",kh[kh.horizontal=1]="horizontal",kh[kh.vertical=2]="vertical",kh[kh.horizontalOnly=3]="horizontalOnly";const VA=-17;class UA{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const E=new UA;return E.scale=u||1,E.fontStack=p,E}static forImage(u){const p=new UA;return p.imageName=u,p}}class sh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const E=new sh;for(let B=0;B<u.sections.length;B++){const q=u.sections[B];q.image?E.addImageSection(q):E.addTextSection(q,p)}return E}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let p="";for(let E=0;E<u.length;E++){const B=u.charCodeAt(E+1)||null,q=u.charCodeAt(E-1)||null;p+=B&&Vu(B)&&!Eu[u[E+1]]||q&&Vu(q)&&!Eu[u[E-1]]||!Eu[u[E]]?u[E]:Eu[u[E]]}return p}(this.text)}trim(){let u=0;for(let E=0;E<this.text.length&&M0[this.text.charCodeAt(E)];E++)u++;let p=this.text.length;for(let E=this.text.length-1;E>=0&&E>=u&&M0[this.text.charCodeAt(E)];E--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const E=new sh;return E.text=this.text.substring(u,p),E.sectionIndex=this.sectionIndex.slice(u,p),E.sections=this.sections,E}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(UA.forText(u.scale,u.fontStack||p));const E=this.sections.length-1;for(let B=0;B<u.text.length;++B)this.sectionIndex.push(E)}addImageSection(u){const p=u.image?u.image.name:"";if(p.length===0)return void Ye("Can't add FormattedSection with an empty image.");const E=this.getNextImageSectionCharCode();E?(this.text+=String.fromCharCode(E),this.sections.push(UA.forImage(p)),this.sectionIndex.push(this.sections.length-1)):Ye("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function GA(f,u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt){const Lt=sh.fromFeature(f,B);let Rt;He===a.ai.vertical&&Lt.verticalizePunctuation();const{processBidirectionalText:ei,processStyledBidirectionalText:Zt}=vs;if(ei&&Lt.sections.length===1){Rt=[];const vi=ei(Lt.toString(),zf(Lt,ve,q,u,E,pt,vt));for(const Ji of vi){const In=new sh;In.text=Ji,In.sections=Lt.sections;for(let un=0;un<Ji.length;un++)In.sectionIndex.push(0);Rt.push(In)}}else if(Zt){Rt=[];const vi=Zt(Lt.text,Lt.sectionIndex,zf(Lt,ve,q,u,E,pt,vt));for(const Ji of vi){const In=new sh;In.text=Ji[0],In.sectionIndex=Ji[1],In.sections=Lt.sections,Rt.push(In)}}else Rt=function(vi,Ji){const In=[],un=vi.text;let ln=0;for(const dn of Ji)In.push(vi.substring(ln,dn)),ln=dn;return ln<un.length&&In.push(vi.substring(ln,un.length)),In}(Lt,zf(Lt,ve,q,u,E,pt,vt));const Wt=[],hi={positionedLines:Wt,text:Lt.toString(),top:Be[1],bottom:Be[1],left:Be[0],right:Be[0],writingMode:He,iconsInText:!1,verticalizable:!1};return function(vi,Ji,In,un,ln,dn,Vn,on,Ki,Fn,Un,gr){let jr=0,Xr=VA,Us=0,Da=0;const la=on==="right"?1:on==="left"?0:.5;let us=0;for(const Rs of ln){Rs.trim();const tr=Rs.getMaxScale(),Ga=(tr-1)*so,ao={positionedGlyphs:[],lineOffset:0};vi.positionedLines[us]=ao;const Ia=ao.positionedGlyphs;let Ho=0;if(!Rs.length()){Xr+=dn,++us;continue}for(let ca=0;ca<Rs.length();ca++){const Er=Rs.getSection(ca),Eo=Rs.getSectionIndex(ca),rl=Rs.getCharCode(ca);let sl=0,Bu=null,Hu=null,Ol=null,Oc=so;const ju=!(Ki===a.ai.horizontal||!Un&&!hu(rl)||Un&&(M0[rl]||(Yn=rl,Cn.Arabic(Yn)||Cn["Arabic Supplement"](Yn)||Cn["Arabic Extended-A"](Yn)||Cn["Arabic Presentation Forms-A"](Yn)||Cn["Arabic Presentation Forms-B"](Yn))));if(Er.imageName){const Zu=un[Er.imageName];if(!Zu)continue;Ol=Er.imageName,vi.iconsInText=vi.iconsInText||!0,Hu=Zu.paddedRect;const iu=Zu.displaySize;Er.scale=Er.scale*so/gr,Bu={width:iu[0],height:iu[1],left:Cu,top:-Lf,advance:ju?iu[1]:iu[0]},sl=Ga+(so-iu[1]*Er.scale),Oc=Bu.advance;const hh=ju?iu[0]*Er.scale-so*tr:iu[1]*Er.scale-so*tr;hh>0&&hh>Ho&&(Ho=hh)}else{const Zu=In[Er.fontStack],iu=Zu&&Zu[rl];if(iu&&iu.rect)Hu=iu.rect,Bu=iu.metrics;else{const hh=Ji[Er.fontStack],lA=hh&&hh[rl];if(!lA)continue;Bu=lA.metrics}sl=(tr-Er.scale)*so}ju?(vi.verticalizable=!0,Ia.push({glyph:rl,imageName:Ol,x:jr,y:Xr+sl,vertical:ju,scale:Er.scale,fontStack:Er.fontStack,sectionIndex:Eo,metrics:Bu,rect:Hu}),jr+=Oc*Er.scale+Fn):(Ia.push({glyph:rl,imageName:Ol,x:jr,y:Xr+sl,vertical:ju,scale:Er.scale,fontStack:Er.fontStack,sectionIndex:Eo,metrics:Bu,rect:Hu}),jr+=Bu.advance*Er.scale+Fn)}Ia.length!==0&&(Us=Math.max(jr-Fn,Us),jm(Ia,0,Ia.length-1,la,Ho)),jr=0;const po=dn*tr+Ho;ao.lineOffset=Math.max(Ho,Ga),Xr+=po,Da=Math.max(po,Da),++us}var Yn;const Ts=Xr-VA,{horizontalAlign:rr,verticalAlign:ua}=wd(Vn);(function(Rs,tr,Ga,ao,Ia,Ho,po,ca,Er){const Eo=(tr-Ga)*Ia;let rl=0;rl=Ho!==po?-ca*ao-VA:(-ao*Er+.5)*po;for(const sl of Rs)for(const Bu of sl.positionedGlyphs)Bu.x+=Eo,Bu.y+=rl})(vi.positionedLines,la,rr,ua,Us,Da,dn,Ts,ln.length),vi.top+=-ua*Ts,vi.bottom=vi.top+Ts,vi.left+=-rr*Us,vi.right=vi.left+Us}(hi,u,p,E,Rt,W,se,fe,He,ve,it,Dt),!function(vi){for(const Ji of vi)if(Ji.positionedGlyphs.length!==0)return!1;return!0}(Wt)&&hi}const M0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Hm={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xd(f,u,p,E,B,q){if(u.imageName){const W=E[u.imageName];return W?W.displaySize[0]*u.scale*so/q+B:0}{const W=p[u.fontStack],se=W&&W[f];return se?se.metrics.advance*u.scale+B:0}}function Mh(f,u,p,E){const B=Math.pow(f-u,2);return E?f<u?B/2:2*B:B+Math.abs(p)*p}function Bc(f,u,p){let E=0;return f===10&&(E-=1e4),p&&(E+=150),f!==40&&f!==65288||(E+=50),u!==41&&u!==65289||(E+=50),E}function ah(f,u,p,E,B,q){let W=null,se=Mh(u,p,B,q);for(const fe of E){const ve=Mh(u-fe.x,p,B,q)+fe.badness;ve<=se&&(W=fe,se=ve)}return{index:f,x:u,priorBreak:W,badness:se}}function bd(f){return f?bd(f.priorBreak).concat(f.index):[]}function zf(f,u,p,E,B,q,W){if(q!=="point")return[];if(!f)return[];const se=[],fe=function(it,pt,vt,Dt,Lt,Rt){let ei=0;for(let Zt=0;Zt<it.length();Zt++){const Wt=it.getSection(Zt);ei+=xd(it.getCharCode(Zt),Wt,Dt,Lt,pt,Rt)}return ei/Math.max(1,Math.ceil(ei/vt))}(f,u,p,E,B,W),ve=f.text.indexOf("")>=0;let Be=0;for(let it=0;it<f.length();it++){const pt=f.getSection(it),vt=f.getCharCode(it);if(M0[vt]||(Be+=xd(vt,pt,E,B,u,W)),it<f.length()-1){const Dt=!((He=vt)<11904||!(Cn["Bopomofo Extended"](He)||Cn.Bopomofo(He)||Cn["CJK Compatibility Forms"](He)||Cn["CJK Compatibility Ideographs"](He)||Cn["CJK Compatibility"](He)||Cn["CJK Radicals Supplement"](He)||Cn["CJK Strokes"](He)||Cn["CJK Symbols and Punctuation"](He)||Cn["CJK Unified Ideographs Extension A"](He)||Cn["CJK Unified Ideographs"](He)||Cn["Enclosed CJK Letters and Months"](He)||Cn["Halfwidth and Fullwidth Forms"](He)||Cn.Hiragana(He)||Cn["Ideographic Description Characters"](He)||Cn["Kangxi Radicals"](He)||Cn["Katakana Phonetic Extensions"](He)||Cn.Katakana(He)||Cn["Vertical Forms"](He)||Cn["Yi Radicals"](He)||Cn["Yi Syllables"](He)));(Hm[vt]||Dt||pt.imageName)&&se.push(ah(it+1,Be,fe,se,Bc(vt,f.getCharCode(it+1),Dt&&ve),!1))}}var He;return bd(ah(f.length(),Be,fe,se,0,!0))}function wd(f){let u=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function jm(f,u,p,E,B){if(!E&&!B)return;const q=f[p],W=(f[p].x+q.metrics.advance*q.scale)*E;for(let se=u;se<=p;se++)f[se].x-=W,f[se].y+=B}function P0(f,u,p){const{horizontalAlign:E,verticalAlign:B}=wd(p),q=u[0]-f.displaySize[0]*E,W=u[1]-f.displaySize[1]*B;return{image:f,top:W,bottom:W+f.displaySize[1],left:q,right:q+f.displaySize[0]}}function D0(f,u,p,E,B,q){const W=f.image;let se;if(W.content){const Lt=W.content,Rt=W.pixelRatio||1;se=[Lt[0]/Rt,Lt[1]/Rt,W.displaySize[0]-Lt[2]/Rt,W.displaySize[1]-Lt[3]/Rt]}const fe=u.left*q,ve=u.right*q;let Be,He,it,pt;p==="width"||p==="both"?(pt=B[0]+fe-E[3],He=B[0]+ve+E[1]):(pt=B[0]+(fe+ve-W.displaySize[0])/2,He=pt+W.displaySize[0]);const vt=u.top*q,Dt=u.bottom*q;return p==="height"||p==="both"?(Be=B[1]+vt-E[0],it=B[1]+Dt+E[2]):(Be=B[1]+(vt+Dt-W.displaySize[1])/2,it=Be+W.displaySize[1]),{image:W,top:Be,right:He,bottom:it,left:pt,collisionPadding:se}}const Rf=255,ec=128,zc=Rf*ec;function rA(f,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new gn(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:E,interpolationType:B}=p;let q=0;for(;q<E.length&&E[q]<=f;)q++;q=Math.max(0,q-1);let W=q;for(;W<E.length&&E[W]<f+1;)W++;W=Math.min(E.length-1,W);const se=E[q],fe=E[W];return p.kind==="composite"?{kind:"composite",minZoom:se,maxZoom:fe,interpolationType:B}:{kind:"camera",minZoom:se,maxZoom:fe,minSize:p.evaluate(new gn(se)),maxSize:p.evaluate(new gn(fe)),interpolationType:B}}}function L0(f,u,p){let E="never";const B=f.get(u);return B?E=B:f.get(p)&&(E="always"),E}const Fp=Eh.VectorTileFeature.types,Sd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ff(f,u,p,E,B,q,W,se,fe,ve,Be,He,it){const pt=se?Math.min(zc,Math.round(se[0])):0,vt=se?Math.min(zc,Math.round(se[1])):0;f.emplaceBack(u,p,Math.round(32*E),Math.round(32*B),q,W,(pt<<1)+(fe?1:0),vt,16*ve,16*Be,256*He,256*it)}function qA(f,u,p){f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p)}function Op(f){for(const u of f.sections)if(oa(u.text))return!0;return!1}class Id{constructor(u){this.layoutVertexArray=new $i,this.indexArray=new Nn,this.programConfigurations=u,this.segments=new nr,this.dynamicLayoutVertexArray=new Ei,this.opacityVertexArray=new Hi,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ae}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,p,E,B){this.isEmpty()||(E&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,fd.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,dd.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,Sd,!0),this.opacityVertexBuffer.itemSize=1),(E||B)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Rn("SymbolBuffers",Id);class Ed{constructor(u,p,E){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new E,this.segments=new nr,this.collisionVertexArray=new cn}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,ya.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Rn("CollisionBuffers",Ed);class oh{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(W=>W.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Wh([]),this.placementViewportMatrix=Wh([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=rA(this.zoom,p["text-size"]),this.iconSizeData=rA(this.zoom,p["icon-size"]);const E=this.layers[0].layout,B=E.get("symbol-sort-key"),q=E.get("symbol-z-order");this.canOverlap=L0(E,"text-overlap","text-allow-overlap")!=="never"||L0(E,"icon-overlap","icon-allow-overlap")!=="never"||E.get("text-ignore-placement")||E.get("icon-ignore-placement"),this.sortFeaturesByKey=q!=="viewport-y"&&!B.isConstant(),this.sortFeaturesByY=(q==="viewport-y"||q==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,E.get("symbol-placement")==="point"&&(this.writingModes=E.get("text-writing-mode").map(W=>a.ai[W])),this.stateDependentLayerIds=this.layers.filter(W=>W.isStateDependent()).map(W=>W.id),this.sourceID=u.sourceID}createArrays(){this.text=new Id(new du(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new Id(new du(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new Fe,this.lineVertexArray=new ze,this.symbolInstances=new ke,this.textAnchorOffsets=new wt}calculateGlyphDependencies(u,p,E,B,q){for(let W=0;W<u.length;W++)if(p[u.charCodeAt(W)]=!0,(E||B)&&q){const se=Eu[u.charAt(W)];se&&(p[se.charCodeAt(0)]=!0)}}populate(u,p,E){const B=this.layers[0],q=B.layout,W=q.get("text-font"),se=q.get("text-field"),fe=q.get("icon-image"),ve=(se.value.kind!=="constant"||se.value.value instanceof Xt&&!se.value.value.isEmpty()||se.value.value.toString().length>0)&&(W.value.kind!=="constant"||W.value.value.length>0),Be=fe.value.kind!=="constant"||!!fe.value.value||Object.keys(fe.parameters).length>0,He=q.get("symbol-sort-key");if(this.features=[],!ve&&!Be)return;const it=p.iconDependencies,pt=p.glyphDependencies,vt=p.availableImages,Dt=new gn(this.zoom);for(const{feature:Lt,id:Rt,index:ei,sourceLayerIndex:Zt}of u){const Wt=B._featureFilter.needGeometry,hi=Tc(Lt,Wt);if(!B._featureFilter.filter(Dt,hi,E))continue;let vi,Ji;if(Wt||(hi.geometry=Hh(Lt)),ve){const un=B.getValueAndResolveTokens("text-field",hi,E,vt),ln=Xt.factory(un);Op(ln)&&(this.hasRTLText=!0),(!this.hasRTLText||Gu()==="unavailable"||this.hasRTLText&&vs.isParsed())&&(vi=BA(ln,B,hi))}if(Be){const un=B.getValueAndResolveTokens("icon-image",hi,E,vt);Ji=un instanceof Ar?un:Ar.fromString(un)}if(!vi&&!Ji)continue;const In=this.sortFeaturesByKey?He.evaluate(hi,{},E):void 0;if(this.features.push({id:Rt,text:vi,icon:Ji,index:ei,sourceLayerIndex:Zt,geometry:hi.geometry,properties:Lt.properties,type:Fp[Lt.type],sortKey:In}),Ji&&(it[Ji.name]=!0),vi){const un=W.evaluate(hi,{},E).join(","),ln=q.get("text-rotation-alignment")!=="viewport"&&q.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ai.vertical)>=0;for(const dn of vi.sections)if(dn.image)it[dn.image.name]=!0;else{const Vn=Yl(vi.toString()),on=dn.fontStack||un,Ki=pt[on]=pt[on]||{};this.calculateGlyphDependencies(dn.text,Ki,ln,this.allowVerticalPlacement,Vn)}}}q.get("symbol-placement")==="line"&&(this.features=function(Lt){const Rt={},ei={},Zt=[];let Wt=0;function hi(un){Zt.push(Lt[un]),Wt++}function vi(un,ln,dn){const Vn=ei[un];return delete ei[un],ei[ln]=Vn,Zt[Vn].geometry[0].pop(),Zt[Vn].geometry[0]=Zt[Vn].geometry[0].concat(dn[0]),Vn}function Ji(un,ln,dn){const Vn=Rt[ln];return delete Rt[ln],Rt[un]=Vn,Zt[Vn].geometry[0].shift(),Zt[Vn].geometry[0]=dn[0].concat(Zt[Vn].geometry[0]),Vn}function In(un,ln,dn){const Vn=dn?ln[0][ln[0].length-1]:ln[0][0];return`${un}:${Vn.x}:${Vn.y}`}for(let un=0;un<Lt.length;un++){const ln=Lt[un],dn=ln.geometry,Vn=ln.text?ln.text.toString():null;if(!Vn){hi(un);continue}const on=In(Vn,dn),Ki=In(Vn,dn,!0);if(on in ei&&Ki in Rt&&ei[on]!==Rt[Ki]){const Fn=Ji(on,Ki,dn),Un=vi(on,Ki,Zt[Fn].geometry);delete Rt[on],delete ei[Ki],ei[In(Vn,Zt[Un].geometry,!0)]=Un,Zt[Fn].geometry=null}else on in ei?vi(on,Ki,dn):Ki in Rt?Ji(on,Ki,dn):(hi(un),Rt[on]=Wt-1,ei[Ki]=Wt-1)}return Zt.filter(un=>un.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Lt,Rt)=>Lt.sortKey-Rt.sortKey)}update(u,p,E){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,p,this.layers,E),this.icon.programConfigurations.updatePaintArrays(u,p,this.layers,E))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const E=this.lineVertexArray.length;if(u.segment!==void 0){let B=u.dist(p[u.segment+1]),q=u.dist(p[u.segment]);const W={};for(let se=u.segment+1;se<p.length;se++)W[se]={x:p[se].x,y:p[se].y,tileUnitDistanceFromAnchor:B},se<p.length-1&&(B+=p[se+1].dist(p[se]));for(let se=u.segment||0;se>=0;se--)W[se]={x:p[se].x,y:p[se].y,tileUnitDistanceFromAnchor:q},se>0&&(q+=p[se-1].dist(p[se]));for(let se=0;se<p.length;se++){const fe=W[se];this.lineVertexArray.emplaceBack(fe.x,fe.y,fe.tileUnitDistanceFromAnchor)}}return{lineStartIndex:E,lineLength:this.lineVertexArray.length-E}}addSymbols(u,p,E,B,q,W,se,fe,ve,Be,He,it){const pt=u.indexArray,vt=u.layoutVertexArray,Dt=u.segments.prepareSegment(4*p.length,vt,pt,this.canOverlap?W.sortKey:void 0),Lt=this.glyphOffsetArray.length,Rt=Dt.vertexLength,ei=this.allowVerticalPlacement&&se===a.ai.vertical?Math.PI/2:0,Zt=W.text&&W.text.sections;for(let Wt=0;Wt<p.length;Wt++){const{tl:hi,tr:vi,bl:Ji,br:In,tex:un,pixelOffsetTL:ln,pixelOffsetBR:dn,minFontScaleX:Vn,minFontScaleY:on,glyphOffset:Ki,isSDF:Fn,sectionIndex:Un}=p[Wt],gr=Dt.vertexLength,jr=Ki[1];Ff(vt,fe.x,fe.y,hi.x,jr+hi.y,un.x,un.y,E,Fn,ln.x,ln.y,Vn,on),Ff(vt,fe.x,fe.y,vi.x,jr+vi.y,un.x+un.w,un.y,E,Fn,dn.x,ln.y,Vn,on),Ff(vt,fe.x,fe.y,Ji.x,jr+Ji.y,un.x,un.y+un.h,E,Fn,ln.x,dn.y,Vn,on),Ff(vt,fe.x,fe.y,In.x,jr+In.y,un.x+un.w,un.y+un.h,E,Fn,dn.x,dn.y,Vn,on),qA(u.dynamicLayoutVertexArray,fe,ei),pt.emplaceBack(gr,gr+1,gr+2),pt.emplaceBack(gr+1,gr+2,gr+3),Dt.vertexLength+=4,Dt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ki[0]),Wt!==p.length-1&&Un===p[Wt+1].sectionIndex||u.programConfigurations.populatePaintArrays(vt.length,W,W.index,{},it,Zt&&Zt[Un])}u.placedSymbolArray.emplaceBack(fe.x,fe.y,Lt,this.glyphOffsetArray.length-Lt,Rt,ve,Be,fe.segment,E?E[0]:0,E?E[1]:0,B[0],B[1],se,0,!1,0,He)}_addCollisionDebugVertex(u,p,E,B,q,W){return p.emplaceBack(0,0),u.emplaceBack(E.x,E.y,B,q,Math.round(W.x),Math.round(W.y))}addCollisionDebugVertices(u,p,E,B,q,W,se){const fe=q.segments.prepareSegment(4,q.layoutVertexArray,q.indexArray),ve=fe.vertexLength,Be=q.layoutVertexArray,He=q.collisionVertexArray,it=se.anchorX,pt=se.anchorY;this._addCollisionDebugVertex(Be,He,W,it,pt,new ce(u,p)),this._addCollisionDebugVertex(Be,He,W,it,pt,new ce(E,p)),this._addCollisionDebugVertex(Be,He,W,it,pt,new ce(E,B)),this._addCollisionDebugVertex(Be,He,W,it,pt,new ce(u,B)),fe.vertexLength+=4;const vt=q.indexArray;vt.emplaceBack(ve,ve+1),vt.emplaceBack(ve+1,ve+2),vt.emplaceBack(ve+2,ve+3),vt.emplaceBack(ve+3,ve),fe.primitiveLength+=4}addDebugCollisionBoxes(u,p,E,B){for(let q=u;q<p;q++){const W=this.collisionBoxArray.get(q);this.addCollisionDebugVertices(W.x1,W.y1,W.x2,W.y2,B?this.textCollisionBox:this.iconCollisionBox,W.anchorPoint,E)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ed(ji,LA.members,nn),this.iconCollisionBox=new Ed(ji,LA.members,nn);for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(u,p,E,B,q,W,se,fe,ve){const Be={};for(let He=p;He<E;He++){const it=u.get(He);Be.textBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},Be.textFeatureIndex=it.featureIndex;break}for(let He=B;He<q;He++){const it=u.get(He);Be.verticalTextBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},Be.verticalTextFeatureIndex=it.featureIndex;break}for(let He=W;He<se;He++){const it=u.get(He);Be.iconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},Be.iconFeatureIndex=it.featureIndex;break}for(let He=fe;He<ve;He++){const it=u.get(He);Be.verticalIconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},Be.verticalIconFeatureIndex=it.featureIndex;break}return Be}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const E=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,E.textBoxStartIndex,E.textBoxEndIndex,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E.iconBoxStartIndex,E.iconBoxEndIndex,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,p){const E=u.placedSymbolArray.get(p),B=E.vertexStartIndex+4*E.numGlyphs;for(let q=E.vertexStartIndex;q<B;q+=4)u.indexArray.emplaceBack(q,q+1,q+2),u.indexArray.emplaceBack(q+1,q+2,q+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),E=Math.cos(u),B=[],q=[],W=[];for(let se=0;se<this.symbolInstances.length;++se){W.push(se);const fe=this.symbolInstances.get(se);B.push(0|Math.round(p*fe.anchorX+E*fe.anchorY)),q.push(fe.featureIndex)}return W.sort((se,fe)=>B[se]-B[fe]||q[fe]-q[se]),W}addToSortKeyRanges(u,p){const E=this.sortKeyRanges[this.sortKeyRanges.length-1];E&&E.sortKey===p?E.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const E=this.symbolInstances.get(p);this.featureSortOrder.push(E.featureIndex),[E.rightJustifiedTextSymbolIndex,E.centerJustifiedTextSymbolIndex,E.leftJustifiedTextSymbolIndex].forEach((B,q,W)=>{B>=0&&W.indexOf(B)===q&&this.addIndicesForPlacedSymbol(this.text,B)}),E.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,E.verticalPlacedTextSymbolIndex),E.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,E.placedIconSymbolIndex),E.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,E.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Cd,Np;Rn("SymbolBucket",oh,{omit:["layers","collisionBoxArray","features","compareText"]}),oh.MAX_GLYPHS=65535,oh.addDynamicAttributes=qA;var Td={get paint(){return Np=Np||new ms({"icon-opacity":new zi(oi.paint_symbol["icon-opacity"]),"icon-color":new zi(oi.paint_symbol["icon-color"]),"icon-halo-color":new zi(oi.paint_symbol["icon-halo-color"]),"icon-halo-width":new zi(oi.paint_symbol["icon-halo-width"]),"icon-halo-blur":new zi(oi.paint_symbol["icon-halo-blur"]),"icon-translate":new Mi(oi.paint_symbol["icon-translate"]),"icon-translate-anchor":new Mi(oi.paint_symbol["icon-translate-anchor"]),"text-opacity":new zi(oi.paint_symbol["text-opacity"]),"text-color":new zi(oi.paint_symbol["text-color"],{runtimeType:mt,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new zi(oi.paint_symbol["text-halo-color"]),"text-halo-width":new zi(oi.paint_symbol["text-halo-width"]),"text-halo-blur":new zi(oi.paint_symbol["text-halo-blur"]),"text-translate":new Mi(oi.paint_symbol["text-translate"]),"text-translate-anchor":new Mi(oi.paint_symbol["text-translate-anchor"])})},get layout(){return Cd=Cd||new ms({"symbol-placement":new Mi(oi.layout_symbol["symbol-placement"]),"symbol-spacing":new Mi(oi.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Mi(oi.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new zi(oi.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Mi(oi.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Mi(oi.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Mi(oi.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Mi(oi.layout_symbol["icon-ignore-placement"]),"icon-optional":new Mi(oi.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Mi(oi.layout_symbol["icon-rotation-alignment"]),"icon-size":new zi(oi.layout_symbol["icon-size"]),"icon-text-fit":new Mi(oi.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Mi(oi.layout_symbol["icon-text-fit-padding"]),"icon-image":new zi(oi.layout_symbol["icon-image"]),"icon-rotate":new zi(oi.layout_symbol["icon-rotate"]),"icon-padding":new zi(oi.layout_symbol["icon-padding"]),"icon-keep-upright":new Mi(oi.layout_symbol["icon-keep-upright"]),"icon-offset":new zi(oi.layout_symbol["icon-offset"]),"icon-anchor":new zi(oi.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Mi(oi.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Mi(oi.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Mi(oi.layout_symbol["text-rotation-alignment"]),"text-field":new zi(oi.layout_symbol["text-field"]),"text-font":new zi(oi.layout_symbol["text-font"]),"text-size":new zi(oi.layout_symbol["text-size"]),"text-max-width":new zi(oi.layout_symbol["text-max-width"]),"text-line-height":new Mi(oi.layout_symbol["text-line-height"]),"text-letter-spacing":new zi(oi.layout_symbol["text-letter-spacing"]),"text-justify":new zi(oi.layout_symbol["text-justify"]),"text-radial-offset":new zi(oi.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Mi(oi.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new zi(oi.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new zi(oi.layout_symbol["text-anchor"]),"text-max-angle":new Mi(oi.layout_symbol["text-max-angle"]),"text-writing-mode":new Mi(oi.layout_symbol["text-writing-mode"]),"text-rotate":new zi(oi.layout_symbol["text-rotate"]),"text-padding":new Mi(oi.layout_symbol["text-padding"]),"text-keep-upright":new Mi(oi.layout_symbol["text-keep-upright"]),"text-transform":new zi(oi.layout_symbol["text-transform"]),"text-offset":new zi(oi.layout_symbol["text-offset"]),"text-allow-overlap":new Mi(oi.layout_symbol["text-allow-overlap"]),"text-overlap":new Mi(oi.layout_symbol["text-overlap"]),"text-ignore-placement":new Mi(oi.layout_symbol["text-ignore-placement"]),"text-optional":new Mi(oi.layout_symbol["text-optional"])})}};class Vp{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:$e,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rn("FormatSectionOverride",Vp,{omit:["defaultValue"]});class HA extends zs{constructor(u){super(u,Td)}recalculate(u,p){if(super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const E=this.layout.get("text-writing-mode");if(E){const B=[];for(const q of E)B.indexOf(q)<0&&B.push(q);this.layout._values["text-writing-mode"]=B}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,p,E,B){const q=this.layout.get(u).evaluate(p,{},E,B),W=this._unevaluatedLayout._values[u];return W.isDataDriven()||as(W.value)||!q?q:function(se,fe){return fe.replace(/{([^{}]+)}/g,(ve,Be)=>se&&Be in se?String(se[Be]):"")}(p.properties,q)}createBucket(u){return new oh(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of Td.paint.overridableProperties){if(!HA.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),E=new Vp(p),B=new Ul(E,p.property.specification);let q=null;q=p.value.kind==="constant"||p.value.kind==="source"?new Ls("source",B):new Br("composite",B,p.value.zoomStops),this.paint._values[u]=new Is(p.property,q,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,E){return!(!this.layout||p.isDataDriven()||E.isDataDriven())&&HA.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const E=u.get("text-field"),B=Td.paint.properties[p];let q=!1;const W=se=>{for(const fe of se)if(B.overrides&&B.overrides.hasOverride(fe))return void(q=!0)};if(E.value.kind==="constant"&&E.value.value instanceof Xt)W(E.value.value.sections);else if(E.value.kind==="source"){const se=ve=>{q||(ve instanceof Bt&&Gt(ve.value)===re?W(ve.value.sections):ve instanceof co?W(ve.sections):ve.eachChild(se))},fe=E.value;fe._styleExpression&&se(fe._styleExpression.expression)}return q}}let lh;var Up={get paint(){return lh=lh||new ms({"background-color":new Mi(oi.paint_background["background-color"]),"background-pattern":new wu(oi.paint_background["background-pattern"]),"background-opacity":new Mi(oi.paint_background["background-opacity"])})}};class Gp extends zs{constructor(u){super(u,Up)}}let kd;var Md={get paint(){return kd=kd||new ms({"raster-opacity":new Mi(oi.paint_raster["raster-opacity"]),"raster-hue-rotate":new Mi(oi.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Mi(oi.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Mi(oi.paint_raster["raster-brightness-max"]),"raster-saturation":new Mi(oi.paint_raster["raster-saturation"]),"raster-contrast":new Mi(oi.paint_raster["raster-contrast"]),"raster-resampling":new Mi(oi.paint_raster["raster-resampling"]),"raster-fade-duration":new Mi(oi.paint_raster["raster-fade-duration"])})}};class qp extends zs{constructor(u){super(u,Md)}}class jA extends zs{constructor(u){super(u,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class B0{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const z0=63710088e-1;class Rc{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Rc($t(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,E=this.lat*p,B=u.lat*p,q=Math.sin(E)*Math.sin(B)+Math.cos(E)*Math.cos(B)*Math.cos((u.lng-this.lng)*p);return z0*Math.acos(Math.min(q,1))}static convert(u){if(u instanceof Rc)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new Rc(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new Rc(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Pd=2*Math.PI*z0;function Lu(f){return Pd*Math.cos(f*Math.PI/180)}function ZA(f){return(180+f)/360}function Dd(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Ld(f,u){return f/Lu(u)}function Bd(f){return 360*f-180}function R0(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class Of{constructor(u,p,E=0){this.x=+u,this.y=+p,this.z=+E}static fromLngLat(u,p=0){const E=Rc.convert(u);return new Of(ZA(E.lng),Dd(E.lat),Ld(p,E.lat))}toLngLat(){return new Rc(Bd(this.x),R0(this.y))}toAltitude(){return this.z*Lu(R0(this.y))}meterInMercatorCoordinateUnits(){return 1/Pd*(u=R0(this.y),1/Math.cos(u*Math.PI/180));var u}}function zd(f,u,p){var E=2*Math.PI*6378137/256/Math.pow(2,p);return[f*E-2*Math.PI*6378137/2,u*E-2*Math.PI*6378137/2]}class Rd{constructor(u,p,E){if(u<0||u>25||E<0||E>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))throw new Error(`x=${p}, y=${E}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=p,this.y=E,this.key=QA(0,u,u,p,E)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p,E){const B=(W=this.y,se=this.z,fe=zd(256*(q=this.x),256*(W=Math.pow(2,se)-W-1),se),ve=zd(256*(q+1),256*(W+1),se),fe[0]+","+fe[1]+","+ve[0]+","+ve[1]);var q,W,se,fe,ve;const Be=function(He,it,pt){let vt,Dt="";for(let Lt=He;Lt>0;Lt--)vt=1<<Lt-1,Dt+=(it&vt?1:0)+(pt&vt?2:0);return Dt}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(E==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Be).replace(/{bbox-epsg-3857}/g,B)}isChildOf(u){const p=this.z-u.z;return p>0&&u.x===this.x>>p&&u.y===this.y>>p}getTilePoint(u){const p=Math.pow(2,this.z);return new ce((u.x*p-this.x)*Va,(u.y*p-this.y)*Va)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Fd{constructor(u,p){this.wrap=u,this.canonical=p,this.key=QA(u,p.z,p.z,p.x,p.y)}}class wl{constructor(u,p,E,B,q){if(u<E)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${E}`);this.overscaledZ=u,this.wrap=p,this.canonical=new Rd(E,+B,+q),this.key=QA(p,u,E,B,q)}clone(){return new wl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-u;return u>this.canonical.z?new wl(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new wl(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const E=this.canonical.z-u;return u>this.canonical.z?QA(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y):QA(this.wrap*+p,u,u,this.canonical.x>>E,this.canonical.y>>E)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new wl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,E=2*this.canonical.x,B=2*this.canonical.y;return[new wl(p,this.wrap,p,E,B),new wl(p,this.wrap,p,E+1,B),new wl(p,this.wrap,p,E,B+1),new wl(p,this.wrap,p,E+1,B+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new wl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new wl(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Fd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new Of(u.x-this.wrap,u.y))}}function QA(f,u,p,E,B){(f*=2)<0&&(f=-1*f-1);const q=1<<p;return(q*q*f+q*B+E).toString(36)+p.toString(36)+u.toString(36)}Rn("CanonicalTileID",Rd),Rn("OverscaledTileID",wl,{omit:["posMatrix"]});class F0{constructor(u,p,E,B=1,q=1,W=1,se=0){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(E&&!["mapbox","terrarium","custom"].includes(E))return void Ye(`"${E}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=p.height;const fe=this.dim=p.height-2;switch(this.data=new Uint32Array(p.data.buffer),E){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=B,this.greenFactor=q,this.blueFactor=W,this.baseShift=se;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let ve=0;ve<fe;ve++)this.data[this._idx(-1,ve)]=this.data[this._idx(0,ve)],this.data[this._idx(fe,ve)]=this.data[this._idx(fe-1,ve)],this.data[this._idx(ve,-1)]=this.data[this._idx(ve,0)],this.data[this._idx(ve,fe)]=this.data[this._idx(ve,fe-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(fe,-1)]=this.data[this._idx(fe-1,0)],this.data[this._idx(-1,fe)]=this.data[this._idx(0,fe-1)],this.data[this._idx(fe,fe)]=this.data[this._idx(fe-1,fe-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let ve=0;ve<fe;ve++)for(let Be=0;Be<fe;Be++){const He=this.get(ve,Be);He>this.max&&(this.max=He),He<this.min&&(this.min=He)}}get(u,p){const E=new Uint8Array(this.data.buffer),B=4*this._idx(u,p);return this.unpack(E[B],E[B+1],E[B+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}unpack(u,p,E){return u*this.redFactor+p*this.greenFactor+E*this.blueFactor-this.baseShift}getPixels(){return new Rl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,p,E){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let B=p*this.dim,q=p*this.dim+this.dim,W=E*this.dim,se=E*this.dim+this.dim;switch(p){case-1:B=q-1;break;case 1:q=B+1}switch(E){case-1:W=se-1;break;case 1:se=W+1}const fe=-p*this.dim,ve=-E*this.dim;for(let Be=W;Be<se;Be++)for(let He=B;He<q;He++)this.data[this._idx(He,Be)]=u.data[this._idx(He+fe,Be+ve)]}}Rn("DEMData",F0);class O0{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const E=u[p];this._stringToNumber[E]=p,this._numberToString[p]=E}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class Od{constructor(u,p,E,B,q){this.type="Feature",this._vectorTileFeature=u,u._z=p,u._x=E,u._y=B,this.properties=u.properties,this.id=q}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(u[p]=this[p]);return u}}class Hp{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new wo(Va,16,0),this.grid3D=new wo(Va,16,0),this.featureIndexArray=new ft,this.promoteId=p}insert(u,p,E,B,q,W){const se=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(E,B,q);const fe=W?this.grid3D:this.grid;for(let ve=0;ve<p.length;ve++){const Be=p[ve],He=[1/0,1/0,-1/0,-1/0];for(let it=0;it<Be.length;it++){const pt=Be[it];He[0]=Math.min(He[0],pt.x),He[1]=Math.min(He[1],pt.y),He[2]=Math.max(He[2],pt.x),He[3]=Math.max(He[3],pt.y)}He[0]<Va&&He[1]<Va&&He[2]>=0&&He[3]>=0&&fe.insert(se,He[0],He[1],He[2],He[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Eh.VectorTile(new T0(this.rawTileData)).layers,this.sourceLayerCoder=new O0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,p,E,B){this.loadVTLayers();const q=u.params||{},W=Va/u.tileSize/u.scale,se=Jr(q.filter),fe=u.queryGeometry,ve=u.queryPadding*W,Be=Nd(fe),He=this.grid.query(Be.minX-ve,Be.minY-ve,Be.maxX+ve,Be.maxY+ve),it=Nd(u.cameraQueryGeometry),pt=this.grid3D.query(it.minX-ve,it.minY-ve,it.maxX+ve,it.maxY+ve,(Lt,Rt,ei,Zt)=>function(Wt,hi,vi,Ji,In){for(const ln of Wt)if(hi<=ln.x&&vi<=ln.y&&Ji>=ln.x&&In>=ln.y)return!0;const un=[new ce(hi,vi),new ce(hi,In),new ce(Ji,In),new ce(Ji,vi)];if(Wt.length>2){for(const ln of un)if(Ju(Wt,ln))return!0}for(let ln=0;ln<Wt.length-1;ln++)if(Y0(Wt[ln],Wt[ln+1],un))return!0;return!1}(u.cameraQueryGeometry,Lt-ve,Rt-ve,ei+ve,Zt+ve));for(const Lt of pt)He.push(Lt);He.sort(uh);const vt={};let Dt;for(let Lt=0;Lt<He.length;Lt++){const Rt=He[Lt];if(Rt===Dt)continue;Dt=Rt;const ei=this.featureIndexArray.get(Rt);let Zt=null;this.loadMatchingFeature(vt,ei.bucketIndex,ei.sourceLayerIndex,ei.featureIndex,se,q.layers,q.availableImages,p,E,B,(Wt,hi,vi)=>(Zt||(Zt=Hh(Wt)),hi.queryIntersectsFeature(fe,Wt,vi,Zt,this.z,u.transform,W,u.pixelPosMatrix)))}return vt}loadMatchingFeature(u,p,E,B,q,W,se,fe,ve,Be,He){const it=this.bucketLayerIDs[p];if(W&&!function(Lt,Rt){for(let ei=0;ei<Lt.length;ei++)if(Rt.indexOf(Lt[ei])>=0)return!0;return!1}(W,it))return;const pt=this.sourceLayerCoder.decode(E),vt=this.vtLayers[pt].feature(B);if(q.needGeometry){const Lt=Tc(vt,!0);if(!q.filter(new gn(this.tileID.overscaledZ),Lt,this.tileID.canonical))return}else if(!q.filter(new gn(this.tileID.overscaledZ),vt))return;const Dt=this.getId(vt,pt);for(let Lt=0;Lt<it.length;Lt++){const Rt=it[Lt];if(W&&W.indexOf(Rt)<0)continue;const ei=fe[Rt];if(!ei)continue;let Zt={};Dt&&Be&&(Zt=Be.getState(ei.sourceLayer||"_geojsonTileLayer",Dt));const Wt=rt({},ve[Rt]);Wt.paint=jp(Wt.paint,ei.paint,vt,Zt,se),Wt.layout=jp(Wt.layout,ei.layout,vt,Zt,se);const hi=!He||He(vt,ei,Zt);if(!hi)continue;const vi=new Od(vt,this.z,this.x,this.y,Dt);vi.layer=Wt;let Ji=u[Rt];Ji===void 0&&(Ji=u[Rt]=[]),Ji.push({featureIndex:B,feature:vi,intersectionZ:hi})}}lookupSymbolFeatures(u,p,E,B,q,W,se,fe){const ve={};this.loadVTLayers();const Be=Jr(q);for(const He of u)this.loadMatchingFeature(ve,E,B,He,Be,W,se,fe,p);return ve}hasLayer(u){for(const p of this.bucketLayerIDs)for(const E of p)if(u===E)return!0;return!1}getId(u,p){let E=u.id;return this.promoteId&&(E=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof E=="boolean"&&(E=Number(E))),E}}function jp(f,u,p,E,B){return At(f,(q,W)=>{const se=u instanceof Bo?u.get(W):null;return se&&se.evaluate?se.evaluate(p,E,B):se})}function Nd(f){let u=1/0,p=1/0,E=-1/0,B=-1/0;for(const q of f)u=Math.min(u,q.x),p=Math.min(p,q.y),E=Math.max(E,q.x),B=Math.max(B,q.y);return{minX:u,minY:p,maxX:E,maxY:B}}function uh(f,u){return u-f}function Vd(f,u,p,E,B){const q=[];for(let W=0;W<f.length;W++){const se=f[W];let fe;for(let ve=0;ve<se.length-1;ve++){let Be=se[ve],He=se[ve+1];Be.x<u&&He.x<u||(Be.x<u?Be=new ce(u,Be.y+(u-Be.x)/(He.x-Be.x)*(He.y-Be.y))._round():He.x<u&&(He=new ce(u,Be.y+(u-Be.x)/(He.x-Be.x)*(He.y-Be.y))._round()),Be.y<p&&He.y<p||(Be.y<p?Be=new ce(Be.x+(p-Be.y)/(He.y-Be.y)*(He.x-Be.x),p)._round():He.y<p&&(He=new ce(Be.x+(p-Be.y)/(He.y-Be.y)*(He.x-Be.x),p)._round()),Be.x>=E&&He.x>=E||(Be.x>=E?Be=new ce(E,Be.y+(E-Be.x)/(He.x-Be.x)*(He.y-Be.y))._round():He.x>=E&&(He=new ce(E,Be.y+(E-Be.x)/(He.x-Be.x)*(He.y-Be.y))._round()),Be.y>=B&&He.y>=B||(Be.y>=B?Be=new ce(Be.x+(B-Be.y)/(He.y-Be.y)*(He.x-Be.x),B)._round():He.y>=B&&(He=new ce(Be.x+(B-Be.y)/(He.y-Be.y)*(He.x-Be.x),B)._round()),fe&&Be.equals(fe[fe.length-1])||(fe=[Be],q.push(fe)),fe.push(He)))))}}return q}Rn("FeatureIndex",Hp,{omit:["rawTileData","sourceLayerCoder"]});class dc extends ce{constructor(u,p,E,B){super(u,p),this.angle=E,B!==void 0&&(this.segment=B)}clone(){return new dc(this.x,this.y,this.angle,this.segment)}}function Ud(f,u,p,E,B){if(u.segment===void 0||p===0)return!0;let q=u,W=u.segment+1,se=0;for(;se>-p/2;){if(W--,W<0)return!1;se-=f[W].dist(q),q=f[W]}se+=f[W].dist(f[W+1]),W++;const fe=[];let ve=0;for(;se<p/2;){const Be=f[W],He=f[W+1];if(!He)return!1;let it=f[W-1].angleTo(Be)-Be.angleTo(He);for(it=Math.abs((it+3*Math.PI)%(2*Math.PI)-Math.PI),fe.push({distance:se,angleDelta:it}),ve+=it;se-fe[0].distance>E;)ve-=fe.shift().angleDelta;if(ve>B)return!1;W++,se+=Be.dist(He)}return!0}function Nf(f){let u=0;for(let p=0;p<f.length-1;p++)u+=f[p].dist(f[p+1]);return u}function Vf(f,u,p){return f?.6*u*p:0}function Uf(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function Zm(f,u,p,E,B,q){const W=Vf(p,B,q),se=Uf(p,E)*q;let fe=0;const ve=Nf(f)/2;for(let Be=0;Be<f.length-1;Be++){const He=f[Be],it=f[Be+1],pt=He.dist(it);if(fe+pt>ve){const vt=(ve-fe)/pt,Dt=Ys.number(He.x,it.x,vt),Lt=Ys.number(He.y,it.y,vt),Rt=new dc(Dt,Lt,it.angleTo(He),Be);return Rt._round(),!W||Ud(f,Rt,se,W,u)?Rt:void 0}fe+=pt}}function Qm(f,u,p,E,B,q,W,se,fe){const ve=Vf(E,q,W),Be=Uf(E,B),He=Be*W,it=f[0].x===0||f[0].x===fe||f[0].y===0||f[0].y===fe;return u-He<u/4&&(u=He+u/4),Zp(f,it?u/2*se%u:(Be/2+2*q)*W*se%u,u,ve,p,He,it,!1,fe)}function Zp(f,u,p,E,B,q,W,se,fe){const ve=q/2,Be=Nf(f);let He=0,it=u-p,pt=[];for(let vt=0;vt<f.length-1;vt++){const Dt=f[vt],Lt=f[vt+1],Rt=Dt.dist(Lt),ei=Lt.angleTo(Dt);for(;it+p<He+Rt;){it+=p;const Zt=(it-He)/Rt,Wt=Ys.number(Dt.x,Lt.x,Zt),hi=Ys.number(Dt.y,Lt.y,Zt);if(Wt>=0&&Wt<fe&&hi>=0&&hi<fe&&it-ve>=0&&it+ve<=Be){const vi=new dc(Wt,hi,ei,vt);vi._round(),E&&!Ud(f,vi,q,E,B)||pt.push(vi)}}He+=Rt}return se||pt.length||W||(pt=Zp(f,He/2,p,E,B,q,W,!0,fe)),pt}Rn("Anchor",dc);const WA=Cu;function sA(f,u,p,E){const B=[],q=f.image,W=q.pixelRatio,se=q.paddedRect.w-2*WA,fe=q.paddedRect.h-2*WA,ve=f.right-f.left,Be=f.bottom-f.top,He=q.stretchX||[[0,se]],it=q.stretchY||[[0,fe]],pt=(dn,Vn)=>dn+Vn[1]-Vn[0],vt=He.reduce(pt,0),Dt=it.reduce(pt,0),Lt=se-vt,Rt=fe-Dt;let ei=0,Zt=vt,Wt=0,hi=Dt,vi=0,Ji=Lt,In=0,un=Rt;if(q.content&&E){const dn=q.content;ei=Fo(He,0,dn[0]),Wt=Fo(it,0,dn[1]),Zt=Fo(He,dn[0],dn[2]),hi=Fo(it,dn[1],dn[3]),vi=dn[0]-ei,In=dn[1]-Wt,Ji=dn[2]-dn[0]-Zt,un=dn[3]-dn[1]-hi}const ln=(dn,Vn,on,Ki)=>{const Fn=aA(dn.stretch-ei,Zt,ve,f.left),Un=$A(dn.fixed-vi,Ji,dn.stretch,vt),gr=aA(Vn.stretch-Wt,hi,Be,f.top),jr=$A(Vn.fixed-In,un,Vn.stretch,Dt),Xr=aA(on.stretch-ei,Zt,ve,f.left),Us=$A(on.fixed-vi,Ji,on.stretch,vt),Da=aA(Ki.stretch-Wt,hi,Be,f.top),la=$A(Ki.fixed-In,un,Ki.stretch,Dt),us=new ce(Fn,gr),Yn=new ce(Xr,gr),Ts=new ce(Xr,Da),rr=new ce(Fn,Da),ua=new ce(Un/W,jr/W),Rs=new ce(Us/W,la/W),tr=u*Math.PI/180;if(tr){const Ia=Math.sin(tr),Ho=Math.cos(tr),po=[Ho,-Ia,Ia,Ho];us._matMult(po),Yn._matMult(po),rr._matMult(po),Ts._matMult(po)}const Ga=dn.stretch+dn.fixed,ao=Vn.stretch+Vn.fixed;return{tl:us,tr:Yn,bl:rr,br:Ts,tex:{x:q.paddedRect.x+WA+Ga,y:q.paddedRect.y+WA+ao,w:on.stretch+on.fixed-Ga,h:Ki.stretch+Ki.fixed-ao},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ua,pixelOffsetBR:Rs,minFontScaleX:Ji/W/ve,minFontScaleY:un/W/Be,isSDF:p}};if(E&&(q.stretchX||q.stretchY)){const dn=ch(He,Lt,vt),Vn=ch(it,Rt,Dt);for(let on=0;on<dn.length-1;on++){const Ki=dn[on],Fn=dn[on+1];for(let Un=0;Un<Vn.length-1;Un++)B.push(ln(Ki,Vn[Un],Fn,Vn[Un+1]))}}else B.push(ln({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:se+1},{fixed:0,stretch:fe+1}));return B}function Fo(f,u,p){let E=0;for(const B of f)E+=Math.max(u,Math.min(p,B[1]))-Math.max(u,Math.min(p,B[0]));return E}function ch(f,u,p){const E=[{fixed:-WA,stretch:0}];for(const[B,q]of f){const W=E[E.length-1];E.push({fixed:B-W.stretch,stretch:W.stretch}),E.push({fixed:B-W.stretch,stretch:W.stretch+(q-B)})}return E.push({fixed:u+WA,stretch:p}),E}function aA(f,u,p,E){return f/u*p+E}function $A(f,u,p,E){return f-u*p/E}class oA{constructor(u,p,E,B,q,W,se,fe,ve,Be){if(this.boxStartIndex=u.length,ve){let He=W.top,it=W.bottom;const pt=W.collisionPadding;pt&&(He-=pt[1],it+=pt[3]);let vt=it-He;vt>0&&(vt=Math.max(10,vt),this.circleDiameter=vt)}else{let He=W.top*se-fe[0],it=W.bottom*se+fe[2],pt=W.left*se-fe[3],vt=W.right*se+fe[1];const Dt=W.collisionPadding;if(Dt&&(pt-=Dt[0]*se,He-=Dt[1]*se,vt+=Dt[2]*se,it+=Dt[3]*se),Be){const Lt=new ce(pt,He),Rt=new ce(vt,He),ei=new ce(pt,it),Zt=new ce(vt,it),Wt=Be*Math.PI/180;Lt._rotate(Wt),Rt._rotate(Wt),ei._rotate(Wt),Zt._rotate(Wt),pt=Math.min(Lt.x,Rt.x,ei.x,Zt.x),vt=Math.max(Lt.x,Rt.x,ei.x,Zt.x),He=Math.min(Lt.y,Rt.y,ei.y,Zt.y),it=Math.max(Lt.y,Rt.y,ei.y,Zt.y)}u.emplaceBack(p.x,p.y,pt,He,vt,it,E,B,q)}this.boxEndIndex=u.length}}class N0{constructor(u=[],p=Qp){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let E=(this.length>>1)-1;E>=0;E--)this._down(E)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:E}=this,B=p[u];for(;u>0;){const q=u-1>>1,W=p[q];if(E(B,W)>=0)break;p[u]=W,u=q}p[u]=B}_down(u){const{data:p,compare:E}=this,B=this.length>>1,q=p[u];for(;u<B;){let W=1+(u<<1),se=p[W];const fe=W+1;if(fe<this.length&&E(p[fe],se)<0&&(W=fe,se=p[fe]),E(se,q)>=0)break;p[u]=se,u=W}p[u]=q}}function Qp(f,u){return f<u?-1:f>u?1:0}function Gd(f,u=1,p=!1){let E=1/0,B=1/0,q=-1/0,W=-1/0;const se=f[0];for(let pt=0;pt<se.length;pt++){const vt=se[pt];(!pt||vt.x<E)&&(E=vt.x),(!pt||vt.y<B)&&(B=vt.y),(!pt||vt.x>q)&&(q=vt.x),(!pt||vt.y>W)&&(W=vt.y)}const fe=Math.min(q-E,W-B);let ve=fe/2;const Be=new N0([],qd);if(fe===0)return new ce(E,B);for(let pt=E;pt<q;pt+=fe)for(let vt=B;vt<W;vt+=fe)Be.push(new XA(pt+ve,vt+ve,ve,f));let He=function(pt){let vt=0,Dt=0,Lt=0;const Rt=pt[0];for(let ei=0,Zt=Rt.length,Wt=Zt-1;ei<Zt;Wt=ei++){const hi=Rt[ei],vi=Rt[Wt],Ji=hi.x*vi.y-vi.x*hi.y;Dt+=(hi.x+vi.x)*Ji,Lt+=(hi.y+vi.y)*Ji,vt+=3*Ji}return new XA(Dt/vt,Lt/vt,0,pt)}(f),it=Be.length;for(;Be.length;){const pt=Be.pop();(pt.d>He.d||!He.d)&&(He=pt,p&&console.log("found best %d after %d probes",Math.round(1e4*pt.d)/1e4,it)),pt.max-He.d<=u||(ve=pt.h/2,Be.push(new XA(pt.p.x-ve,pt.p.y-ve,ve,f)),Be.push(new XA(pt.p.x+ve,pt.p.y-ve,ve,f)),Be.push(new XA(pt.p.x-ve,pt.p.y+ve,ve,f)),Be.push(new XA(pt.p.x+ve,pt.p.y+ve,ve,f)),it+=4)}return p&&(console.log(`num probes: ${it}`),console.log(`best distance: ${He.d}`)),He.p}function qd(f,u){return u.max-f.max}function XA(f,u,p,E){this.p=new ce(f,u),this.h=p,this.d=function(B,q){let W=!1,se=1/0;for(let fe=0;fe<q.length;fe++){const ve=q[fe];for(let Be=0,He=ve.length,it=He-1;Be<He;it=Be++){const pt=ve[Be],vt=ve[it];pt.y>B.y!=vt.y>B.y&&B.x<(vt.x-pt.x)*(B.y-pt.y)/(vt.y-pt.y)+pt.x&&(W=!W),se=Math.min(se,X0(B,pt,vt))}}return(W?1:-1)*Math.sqrt(se)}(this.p,E),this.max=this.d+this.h*Math.SQRT2}var Fl;a.aq=void 0,(Fl=a.aq||(a.aq={}))[Fl.center=1]="center",Fl[Fl.left=2]="left",Fl[Fl.right=3]="right",Fl[Fl.top=4]="top",Fl[Fl.bottom=5]="bottom",Fl[Fl["top-left"]=6]="top-left",Fl[Fl["top-right"]=7]="top-right",Fl[Fl["bottom-left"]=8]="bottom-left",Fl[Fl["bottom-right"]=9]="bottom-right";const Fc=7,Ph=Number.POSITIVE_INFINITY;function YA(f,u){return u[1]!==Ph?function(p,E,B){let q=0,W=0;switch(E=Math.abs(E),B=Math.abs(B),p){case"top-right":case"top-left":case"top":W=B-Fc;break;case"bottom-right":case"bottom-left":case"bottom":W=-B+Fc}switch(p){case"top-right":case"bottom-right":case"right":q=-E;break;case"top-left":case"bottom-left":case"left":q=E}return[q,W]}(f,u[0],u[1]):function(p,E){let B=0,q=0;E<0&&(E=0);const W=E/Math.SQRT2;switch(p){case"top-right":case"top-left":q=W-Fc;break;case"bottom-right":case"bottom-left":q=-W+Fc;break;case"bottom":q=-E+Fc;break;case"top":q=E-Fc}switch(p){case"top-right":case"bottom-right":B=-W;break;case"top-left":case"bottom-left":B=W;break;case"left":B=E;break;case"right":B=-E}return[B,q]}(f,u[0])}function KA(f,u,p){var E;const B=f.layout,q=(E=B.get("text-variable-anchor-offset"))===null||E===void 0?void 0:E.evaluate(u,{},p);if(q){const se=q.values,fe=[];for(let ve=0;ve<se.length;ve+=2){const Be=fe[ve]=se[ve],He=se[ve+1].map(it=>it*so);Be.startsWith("top")?He[1]-=Fc:Be.startsWith("bottom")&&(He[1]+=Fc),fe[ve+1]=He}return new kn(fe)}const W=B.get("text-variable-anchor");if(W){let se;se=f._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[B.get("text-radial-offset").evaluate(u,{},p)*so,Ph]:B.get("text-offset").evaluate(u,{},p).map(ve=>ve*so);const fe=[];for(const ve of W)fe.push(ve,YA(ve,se));return new kn(fe)}return null}function Gf(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function V0(f,u,p,E,B,q,W,se,fe,ve,Be){let He=q.textMaxSize.evaluate(u,{});He===void 0&&(He=W);const it=f.layers[0].layout,pt=it.get("icon-offset").evaluate(u,{},Be),vt=Hf(p.horizontal),Dt=W/24,Lt=f.tilePixelRatio*Dt,Rt=f.tilePixelRatio*He/24,ei=f.tilePixelRatio*se,Zt=f.tilePixelRatio*it.get("symbol-spacing"),Wt=it.get("text-padding")*f.tilePixelRatio,hi=function(Ki,Fn,Un,gr=1){const jr=Ki.get("icon-padding").evaluate(Fn,{},Un),Xr=jr&&jr.values;return[Xr[0]*gr,Xr[1]*gr,Xr[2]*gr,Xr[3]*gr]}(it,u,Be,f.tilePixelRatio),vi=it.get("text-max-angle")/180*Math.PI,Ji=it.get("text-rotation-alignment")!=="viewport"&&it.get("symbol-placement")!=="point",In=it.get("icon-rotation-alignment")==="map"&&it.get("symbol-placement")!=="point",un=it.get("symbol-placement"),ln=Zt/2,dn=it.get("icon-text-fit");let Vn;E&&dn!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(Vn=D0(E,p.vertical,dn,it.get("icon-text-fit-padding"),pt,Dt)),vt&&(E=D0(E,vt,dn,it.get("icon-text-fit-padding"),pt,Dt)));const on=(Ki,Fn)=>{Fn.x<0||Fn.x>=Va||Fn.y<0||Fn.y>=Va||function(Un,gr,jr,Xr,Us,Da,la,us,Yn,Ts,rr,ua,Rs,tr,Ga,ao,Ia,Ho,po,ca,Er,Eo,rl,sl,Bu){const Hu=Un.addToLineVertexArray(gr,jr);let Ol,Oc,ju,Zu,iu=0,hh=0,lA=0,$p=0,Hd=-1,jd=-1;const mo={};let Co=Io("");if(Un.allowVerticalPlacement&&Xr.vertical){const Tu=us.layout.get("text-rotate").evaluate(Er,{},sl)+90;ju=new oA(Yn,gr,Ts,rr,ua,Xr.vertical,Rs,tr,Ga,Tu),la&&(Zu=new oA(Yn,gr,Ts,rr,ua,la,Ia,Ho,Ga,Tu))}if(Us){const Tu=us.layout.get("icon-rotate").evaluate(Er,{}),mc=us.layout.get("icon-text-fit")!=="none",Nc=sA(Us,Tu,rl,mc),Ah=la?sA(la,Tu,rl,mc):void 0;Oc=new oA(Yn,gr,Ts,rr,ua,Us,Ia,Ho,!1,Tu),iu=4*Nc.length;const $f=Un.iconSizeData;let Lh=null;$f.kind==="source"?(Lh=[ec*us.layout.get("icon-size").evaluate(Er,{})],Lh[0]>zc&&Ye(`${Un.layerIds[0]}: Value for "icon-size" is >= ${Rf}. Reduce your "icon-size".`)):$f.kind==="composite"&&(Lh=[ec*Eo.compositeIconSizes[0].evaluate(Er,{},sl),ec*Eo.compositeIconSizes[1].evaluate(Er,{},sl)],(Lh[0]>zc||Lh[1]>zc)&&Ye(`${Un.layerIds[0]}: Value for "icon-size" is >= ${Rf}. Reduce your "icon-size".`)),Un.addSymbols(Un.icon,Nc,Lh,ca,po,Er,a.ai.none,gr,Hu.lineStartIndex,Hu.lineLength,-1,sl),Hd=Un.icon.placedSymbolArray.length-1,Ah&&(hh=4*Ah.length,Un.addSymbols(Un.icon,Ah,Lh,ca,po,Er,a.ai.vertical,gr,Hu.lineStartIndex,Hu.lineLength,-1,sl),jd=Un.icon.placedSymbolArray.length-1)}const Wf=Object.keys(Xr.horizontal);for(const Tu of Wf){const mc=Xr.horizontal[Tu];if(!Ol){Co=Io(mc.text);const Ah=us.layout.get("text-rotate").evaluate(Er,{},sl);Ol=new oA(Yn,gr,Ts,rr,ua,mc,Rs,tr,Ga,Ah)}const Nc=mc.positionedLines.length===1;if(lA+=qf(Un,gr,mc,Da,us,Ga,Er,ao,Hu,Xr.vertical?a.ai.horizontal:a.ai.horizontalOnly,Nc?Wf:[Tu],mo,Hd,Eo,sl),Nc)break}Xr.vertical&&($p+=qf(Un,gr,Xr.vertical,Da,us,Ga,Er,ao,Hu,a.ai.vertical,["vertical"],mo,jd,Eo,sl));const Xp=Ol?Ol.boxStartIndex:Un.collisionBoxArray.length,Wm=Ol?Ol.boxEndIndex:Un.collisionBoxArray.length,Yp=ju?ju.boxStartIndex:Un.collisionBoxArray.length,$m=ju?ju.boxEndIndex:Un.collisionBoxArray.length,nu=Oc?Oc.boxStartIndex:Un.collisionBoxArray.length,Qu=Oc?Oc.boxEndIndex:Un.collisionBoxArray.length,Dh=Zu?Zu.boxStartIndex:Un.collisionBoxArray.length,pc=Zu?Zu.boxEndIndex:Un.collisionBoxArray.length;let ru=-1;const Wu=(Tu,mc)=>Tu&&Tu.circleDiameter?Math.max(Tu.circleDiameter,mc):mc;ru=Wu(Ol,ru),ru=Wu(ju,ru),ru=Wu(Oc,ru),ru=Wu(Zu,ru);const Xm=ru>-1?1:0;Xm&&(ru*=Bu/so),Un.glyphOffsetArray.length>=oh.MAX_GLYPHS&&Ye("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Er.sortKey!==void 0&&Un.addToSortKeyRanges(Un.symbolInstances.length,Er.sortKey);const Hg=KA(us,Er,sl),[E1,C1]=function(Tu,mc){const Nc=Tu.length,Ah=mc==null?void 0:mc.values;if((Ah==null?void 0:Ah.length)>0)for(let $f=0;$f<Ah.length;$f+=2){const Lh=Ah[$f+1];Tu.emplaceBack(a.aq[Ah[$f]],Lh[0],Lh[1])}return[Nc,Tu.length]}(Un.textAnchorOffsets,Hg);Un.symbolInstances.emplaceBack(gr.x,gr.y,mo.right>=0?mo.right:-1,mo.center>=0?mo.center:-1,mo.left>=0?mo.left:-1,mo.vertical||-1,Hd,jd,Co,Xp,Wm,Yp,$m,nu,Qu,Dh,pc,Ts,lA,$p,iu,hh,Xm,0,Rs,ru,E1,C1)}(f,Fn,Ki,p,E,B,Vn,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,Lt,[Wt,Wt,Wt,Wt],Ji,fe,ei,hi,In,pt,u,q,ve,Be,W)};if(un==="line")for(const Ki of Vd(u.geometry,0,0,Va,Va)){const Fn=Qm(Ki,Zt,vi,p.vertical||vt,E,24,Rt,f.overscaling,Va);for(const Un of Fn)vt&&jf(f,vt.text,ln,Un)||on(Ki,Un)}else if(un==="line-center"){for(const Ki of u.geometry)if(Ki.length>1){const Fn=Zm(Ki,vi,p.vertical||vt,E,24,Rt);Fn&&on(Ki,Fn)}}else if(u.type==="Polygon")for(const Ki of nd(u.geometry,0)){const Fn=Gd(Ki,16);on(Ki[0],new dc(Fn.x,Fn.y,0))}else if(u.type==="LineString")for(const Ki of u.geometry)on(Ki,new dc(Ki[0].x,Ki[0].y,0));else if(u.type==="Point")for(const Ki of u.geometry)for(const Fn of Ki)on([Fn],new dc(Fn.x,Fn.y,0))}function qf(f,u,p,E,B,q,W,se,fe,ve,Be,He,it,pt,vt){const Dt=function(ei,Zt,Wt,hi,vi,Ji,In,un){const ln=hi.layout.get("text-rotate").evaluate(Ji,{})*Math.PI/180,dn=[];for(const Vn of Zt.positionedLines)for(const on of Vn.positionedGlyphs){if(!on.rect)continue;const Ki=on.rect||{};let Fn=Lf+1,Un=!0,gr=1,jr=0;const Xr=(vi||un)&&on.vertical,Us=on.metrics.advance*on.scale/2;if(un&&Zt.verticalizable&&(jr=Vn.lineOffset/2-(on.imageName?-(so-on.metrics.width*on.scale)/2:(on.scale-1)*so)),on.imageName){const ca=In[on.imageName];Un=ca.sdf,gr=ca.pixelRatio,Fn=Cu/gr}const Da=vi?[on.x+Us,on.y]:[0,0];let la=vi?[0,0]:[on.x+Us+Wt[0],on.y+Wt[1]-jr],us=[0,0];Xr&&(us=la,la=[0,0]);const Yn=on.metrics.isDoubleResolution?2:1,Ts=(on.metrics.left-Fn)*on.scale-Us+la[0],rr=(-on.metrics.top-Fn)*on.scale+la[1],ua=Ts+Ki.w/Yn*on.scale/gr,Rs=rr+Ki.h/Yn*on.scale/gr,tr=new ce(Ts,rr),Ga=new ce(ua,rr),ao=new ce(Ts,Rs),Ia=new ce(ua,Rs);if(Xr){const ca=new ce(-Us,Us-VA),Er=-Math.PI/2,Eo=so/2-Us,rl=new ce(5-VA-Eo,-(on.imageName?Eo:0)),sl=new ce(...us);tr._rotateAround(Er,ca)._add(rl)._add(sl),Ga._rotateAround(Er,ca)._add(rl)._add(sl),ao._rotateAround(Er,ca)._add(rl)._add(sl),Ia._rotateAround(Er,ca)._add(rl)._add(sl)}if(ln){const ca=Math.sin(ln),Er=Math.cos(ln),Eo=[Er,-ca,ca,Er];tr._matMult(Eo),Ga._matMult(Eo),ao._matMult(Eo),Ia._matMult(Eo)}const Ho=new ce(0,0),po=new ce(0,0);dn.push({tl:tr,tr:Ga,bl:ao,br:Ia,tex:Ki,writingMode:Zt.writingMode,glyphOffset:Da,sectionIndex:on.sectionIndex,isSDF:Un,pixelOffsetTL:Ho,pixelOffsetBR:po,minFontScaleX:0,minFontScaleY:0})}return dn}(0,p,se,B,q,W,E,f.allowVerticalPlacement),Lt=f.textSizeData;let Rt=null;Lt.kind==="source"?(Rt=[ec*B.layout.get("text-size").evaluate(W,{})],Rt[0]>zc&&Ye(`${f.layerIds[0]}: Value for "text-size" is >= ${Rf}. Reduce your "text-size".`)):Lt.kind==="composite"&&(Rt=[ec*pt.compositeTextSizes[0].evaluate(W,{},vt),ec*pt.compositeTextSizes[1].evaluate(W,{},vt)],(Rt[0]>zc||Rt[1]>zc)&&Ye(`${f.layerIds[0]}: Value for "text-size" is >= ${Rf}. Reduce your "text-size".`)),f.addSymbols(f.text,Dt,Rt,se,q,W,ve,u,fe.lineStartIndex,fe.lineLength,it,vt);for(const ei of Be)He[ei]=f.text.placedSymbolArray.length-1;return 4*Dt.length}function Hf(f){for(const u in f)return f[u];return null}function jf(f,u,p,E){const B=f.compareText;if(u in B){const q=B[u];for(let W=q.length-1;W>=0;W--)if(E.dist(q[W])<p)return!0}else B[u]=[];return B[u].push(E),!1}const U0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Zf{static from(u){if(!(u instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[p,E]=new Uint8Array(u,0,2);if(p!==219)throw new Error("Data does not appear to be in a KDBush format.");const B=E>>4;if(B!==1)throw new Error(`Got v${B} data when expected v1.`);const q=U0[15&E];if(!q)throw new Error("Unrecognized array type.");const[W]=new Uint16Array(u,2,1),[se]=new Uint32Array(u,4,1);return new Zf(se,W,q,u)}constructor(u,p=64,E=Float64Array,B){if(isNaN(u)||u<0)throw new Error(`Unpexpected numItems value: ${u}.`);this.numItems=+u,this.nodeSize=Math.min(Math.max(+p,2),65535),this.ArrayType=E,this.IndexArrayType=u<65536?Uint16Array:Uint32Array;const q=U0.indexOf(this.ArrayType),W=2*u*this.ArrayType.BYTES_PER_ELEMENT,se=u*this.IndexArrayType.BYTES_PER_ELEMENT,fe=(8-se%8)%8;if(q<0)throw new Error(`Unexpected typed array class: ${E}.`);B&&B instanceof ArrayBuffer?(this.data=B,this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+se+fe,2*u),this._pos=2*u,this._finished=!0):(this.data=new ArrayBuffer(8+W+se+fe),this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+se+fe,2*u),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+q]),new Uint16Array(this.data,2,1)[0]=p,new Uint32Array(this.data,4,1)[0]=u)}add(u,p){const E=this._pos>>1;return this.ids[E]=E,this.coords[this._pos++]=u,this.coords[this._pos++]=p,E}finish(){const u=this._pos>>1;if(u!==this.numItems)throw new Error(`Added ${u} items when expected ${this.numItems}.`);return Qf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(u,p,E,B){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:q,coords:W,nodeSize:se}=this,fe=[0,q.length-1,0],ve=[];for(;fe.length;){const Be=fe.pop()||0,He=fe.pop()||0,it=fe.pop()||0;if(He-it<=se){for(let Lt=it;Lt<=He;Lt++){const Rt=W[2*Lt],ei=W[2*Lt+1];Rt>=u&&Rt<=E&&ei>=p&&ei<=B&&ve.push(q[Lt])}continue}const pt=it+He>>1,vt=W[2*pt],Dt=W[2*pt+1];vt>=u&&vt<=E&&Dt>=p&&Dt<=B&&ve.push(q[pt]),(Be===0?u<=vt:p<=Dt)&&(fe.push(it),fe.push(pt-1),fe.push(1-Be)),(Be===0?E>=vt:B>=Dt)&&(fe.push(pt+1),fe.push(He),fe.push(1-Be))}return ve}within(u,p,E){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:B,coords:q,nodeSize:W}=this,se=[0,B.length-1,0],fe=[],ve=E*E;for(;se.length;){const Be=se.pop()||0,He=se.pop()||0,it=se.pop()||0;if(He-it<=W){for(let Lt=it;Lt<=He;Lt++)w(q[2*Lt],q[2*Lt+1],u,p)<=ve&&fe.push(B[Lt]);continue}const pt=it+He>>1,vt=q[2*pt],Dt=q[2*pt+1];w(vt,Dt,u,p)<=ve&&fe.push(B[pt]),(Be===0?u-E<=vt:p-E<=Dt)&&(se.push(it),se.push(pt-1),se.push(1-Be)),(Be===0?u+E>=vt:p+E>=Dt)&&(se.push(pt+1),se.push(He),se.push(1-Be))}return fe}}function Qf(f,u,p,E,B,q){if(B-E<=p)return;const W=E+B>>1;Wp(f,u,W,E,B,q),Qf(f,u,p,E,W-1,1-q),Qf(f,u,p,W+1,B,1-q)}function Wp(f,u,p,E,B,q){for(;B>E;){if(B-E>600){const ve=B-E+1,Be=p-E+1,He=Math.log(ve),it=.5*Math.exp(2*He/3),pt=.5*Math.sqrt(He*it*(ve-it)/ve)*(Be-ve/2<0?-1:1);Wp(f,u,p,Math.max(E,Math.floor(p-Be*it/ve+pt)),Math.min(B,Math.floor(p+(ve-Be)*it/ve+pt)),q)}const W=u[2*p+q];let se=E,fe=B;for(_(f,u,E,p),u[2*B+q]>W&&_(f,u,E,B);se<fe;){for(_(f,u,se,fe),se++,fe--;u[2*se+q]<W;)se++;for(;u[2*fe+q]>W;)fe--}u[2*E+q]===W?_(f,u,E,fe):(fe++,_(f,u,fe,B)),fe<=p&&(E=fe+1),p<=fe&&(B=fe-1)}}function _(f,u,p,E){h(f,p,E),h(u,2*p,2*E),h(u,2*p+1,2*E+1)}function h(f,u,p){const E=f[u];f[u]=f[p],f[p]=E}function w(f,u,p,E){const B=f-p,q=u-E;return B*B+q*q}var P;a.bh=void 0,(P=a.bh||(a.bh={})).create="create",P.load="load",P.fullLoad="fullLoad";let H=null,J=[];const ee=1e3/60,ge="loadTime",Te="fullLoadTime",Ne={mark(f){performance.mark(f)},frame(f){const u=f;H!=null&&J.push(u-H),H=u},clearMetrics(){H=null,J=[],performance.clearMeasures(ge),performance.clearMeasures(Te);for(const f in a.bh)performance.clearMarks(a.bh[f])},getPerformanceMetrics(){performance.measure(ge,a.bh.create,a.bh.load),performance.measure(Te,a.bh.create,a.bh.fullLoad);const f=performance.getEntriesByName(ge)[0].duration,u=performance.getEntriesByName(Te)[0].duration,p=J.length,E=1/(J.reduce((q,W)=>q+W,0)/p/1e3),B=J.filter(q=>q>ee).reduce((q,W)=>q+(W-ee)/ee,0);return{loadTime:f,fullLoadTime:u,fps:E,percentDroppedFrames:B/(p+B)*100,totalFrames:p}}};a.$=function(f,u,p){var E,B,q,W,se,fe,ve,Be,He,it,pt,vt,Dt=p[0],Lt=p[1],Rt=p[2];return u===f?(f[12]=u[0]*Dt+u[4]*Lt+u[8]*Rt+u[12],f[13]=u[1]*Dt+u[5]*Lt+u[9]*Rt+u[13],f[14]=u[2]*Dt+u[6]*Lt+u[10]*Rt+u[14],f[15]=u[3]*Dt+u[7]*Lt+u[11]*Rt+u[15]):(B=u[1],q=u[2],W=u[3],se=u[4],fe=u[5],ve=u[6],Be=u[7],He=u[8],it=u[9],pt=u[10],vt=u[11],f[0]=E=u[0],f[1]=B,f[2]=q,f[3]=W,f[4]=se,f[5]=fe,f[6]=ve,f[7]=Be,f[8]=He,f[9]=it,f[10]=pt,f[11]=vt,f[12]=E*Dt+se*Lt+He*Rt+u[12],f[13]=B*Dt+fe*Lt+it*Rt+u[13],f[14]=q*Dt+ve*Lt+pt*Rt+u[14],f[15]=W*Dt+Be*Lt+vt*Rt+u[15]),f},a.A=Qh,a.B=Ys,a.C=class{constructor(f,u,p){this.receive=E=>{const B=E.data,q=B.id;if(q&&(!B.targetMapId||this.mapId===B.targetMapId))if(B.type==="<cancel>"){delete this.tasks[q];const W=this.cancelCallbacks[q];delete this.cancelCallbacks[q],W&&W()}else Ut()||B.mustQueue?(this.tasks[q]=B,this.taskQueue.push(q),this.invoker.trigger()):this.processTask(q,B)},this.process=()=>{if(!this.taskQueue.length)return;const E=this.taskQueue.shift(),B=this.tasks[E];delete this.tasks[E],this.taskQueue.length&&this.invoker.trigger(),B&&this.processTask(E,B)},this.target=f,this.parent=u,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new B0(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ut()?f:window}send(f,u,p,E,B=!1){const q=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[q]=p);const W=[],se={id:q,type:f,hasCallback:!!p,targetMapId:E,mustQueue:B,sourceMapId:this.mapId,data:En(u,W)};return this.target.postMessage(se,{transfer:W}),{cancel:()=>{p&&delete this.callbacks[q],this.target.postMessage({id:q,type:"<cancel>",targetMapId:E,sourceMapId:this.mapId})}}}processTask(f,u){if(u.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(u.error?p(Vo(u.error)):p(null,Vo(u.data)))}else{let p=!1;const E=[],B=u.hasCallback?(se,fe)=>{p=!0,delete this.cancelCallbacks[f];const ve={id:f,type:"<response>",sourceMapId:this.mapId,error:se?En(se):null,data:En(fe,E)};this.target.postMessage(ve,{transfer:E})}:se=>{p=!0};let q=null;const W=Vo(u.data);if(this.parent[u.type])q=this.parent[u.type](u.sourceMapId,W,B);else if("getWorkerSource"in this.parent){const se=u.type.split(".");q=this.parent.getWorkerSource(u.sourceMapId,se[0],W.source)[se[1]](W,B)}else B(new Error(`Could not find function ${u.type}`));!p&&q&&q.cancel&&(this.cancelCallbacks[f]=q.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.D=Mi,a.E=$n,a.F=function(f,u){const p={};for(let E=0;E<u.length;E++){const B=u[E];B in f&&(p[B]=f[B])}return p},a.G=ZA,a.H=Dd,a.I=k0,a.J=ht,a.K=xt,a.L=Rc,a.M=Ci,a.N=Va,a.O=wl,a.P=ce,a.Q=F,a.R=Rl,a.S=nr,a.T=il,a.U=Of,a.V=class extends Se{},a.W=Rd,a.X=function(f,u){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let E=0;E<f.length;E++){const B=window.document.createElement("source");wn(f[E])||(p.crossOrigin="Anonymous"),B.src=f[E],p.appendChild(B)}return{cancel:()=>{}}},a.Y=be,a.Z=function(){var f=new Qh(16);return Qh!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},a._=N,a.a=Vt,a.a$=class extends I{},a.a0=function(f,u,p){var E=p[0],B=p[1],q=p[2];return f[0]=u[0]*E,f[1]=u[1]*E,f[2]=u[2]*E,f[3]=u[3]*E,f[4]=u[4]*B,f[5]=u[5]*B,f[6]=u[6]*B,f[7]=u[7]*B,f[8]=u[8]*q,f[9]=u[9]*q,f[10]=u[10]*q,f[11]=u[11]*q,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.a1=mf,a.a2=function(){return gt++},a.a3=Z,a.a4=oh,a.a5=function(){vs.isLoading()||vs.isLoaded()||Gu()!=="deferred"||br()},a.a6=Jr,a.a7=Tc,a.a8=gn,a.a9=Od,a.aA=xu,a.aB=function(f){f=f.slice();const u=Object.create(null);for(let p=0;p<f.length;p++)u[f[p].id]=f[p];for(let p=0;p<f.length;p++)"ref"in f[p]&&(f[p]=Xn(f[p],u[f[p].ref]));return f},a.aC=function(f){if(f.type==="custom")return new jA(f);switch(f.type){case"background":return new Gp(f);case"circle":return new qu(f);case"fill":return new kp(f);case"fill-extrusion":return new ld(f);case"heatmap":return new th(f);case"hillshade":return new ed(f);case"line":return new fl(f);case"raster":return new qp(f);case"symbol":return new HA(f)}},a.aD=St,a.aE=function(f,u){if(!f)return[{command:Wn.setStyle,args:[u]}];let p=[];try{if(!zn(f.version,u.version))return[{command:Wn.setStyle,args:[u]}];zn(f.center,u.center)||p.push({command:Wn.setCenter,args:[u.center]}),zn(f.zoom,u.zoom)||p.push({command:Wn.setZoom,args:[u.zoom]}),zn(f.bearing,u.bearing)||p.push({command:Wn.setBearing,args:[u.bearing]}),zn(f.pitch,u.pitch)||p.push({command:Wn.setPitch,args:[u.pitch]}),zn(f.sprite,u.sprite)||p.push({command:Wn.setSprite,args:[u.sprite]}),zn(f.glyphs,u.glyphs)||p.push({command:Wn.setGlyphs,args:[u.glyphs]}),zn(f.transition,u.transition)||p.push({command:Wn.setTransition,args:[u.transition]}),zn(f.light,u.light)||p.push({command:Wn.setLight,args:[u.light]});const E={},B=[];(function(W,se,fe,ve){let Be;for(Be in se=se||{},W=W||{})Object.prototype.hasOwnProperty.call(W,Be)&&(Object.prototype.hasOwnProperty.call(se,Be)||b(Be,fe,ve));for(Be in se)Object.prototype.hasOwnProperty.call(se,Be)&&(Object.prototype.hasOwnProperty.call(W,Be)?zn(W[Be],se[Be])||(W[Be].type==="geojson"&&se[Be].type==="geojson"&&U(W,se,Be)?fe.push({command:Wn.setGeoJSONSourceData,args:[Be,se[Be].data]}):M(Be,se,fe,ve)):_n(Be,se,fe))})(f.sources,u.sources,B,E);const q=[];f.layers&&f.layers.forEach(W=>{E[W.source]?p.push({command:Wn.removeLayer,args:[W.id]}):q.push(W)}),p=p.concat(B),function(W,se,fe){se=se||[];const ve=(W=W||[]).map(ie),Be=se.map(ie),He=W.reduce(de,{}),it=se.reduce(de,{}),pt=ve.slice(),vt=Object.create(null);let Dt,Lt,Rt,ei,Zt,Wt,hi;for(Dt=0,Lt=0;Dt<ve.length;Dt++)Rt=ve[Dt],Object.prototype.hasOwnProperty.call(it,Rt)?Lt++:(fe.push({command:Wn.removeLayer,args:[Rt]}),pt.splice(pt.indexOf(Rt,Lt),1));for(Dt=0,Lt=0;Dt<Be.length;Dt++)Rt=Be[Be.length-1-Dt],pt[pt.length-1-Dt]!==Rt&&(Object.prototype.hasOwnProperty.call(He,Rt)?(fe.push({command:Wn.removeLayer,args:[Rt]}),pt.splice(pt.lastIndexOf(Rt,pt.length-Lt),1)):Lt++,Wt=pt[pt.length-Dt],fe.push({command:Wn.addLayer,args:[it[Rt],Wt]}),pt.splice(pt.length-Dt,0,Rt),vt[Rt]=!0);for(Dt=0;Dt<Be.length;Dt++)if(Rt=Be[Dt],ei=He[Rt],Zt=it[Rt],!vt[Rt]&&!zn(ei,Zt))if(zn(ei.source,Zt.source)&&zn(ei["source-layer"],Zt["source-layer"])&&zn(ei.type,Zt.type)){for(hi in K(ei.layout,Zt.layout,fe,Rt,null,Wn.setLayoutProperty),K(ei.paint,Zt.paint,fe,Rt,null,Wn.setPaintProperty),zn(ei.filter,Zt.filter)||fe.push({command:Wn.setFilter,args:[Rt,Zt.filter]}),zn(ei.minzoom,Zt.minzoom)&&zn(ei.maxzoom,Zt.maxzoom)||fe.push({command:Wn.setLayerZoomRange,args:[Rt,Zt.minzoom,Zt.maxzoom]}),ei)Object.prototype.hasOwnProperty.call(ei,hi)&&hi!=="layout"&&hi!=="paint"&&hi!=="filter"&&hi!=="metadata"&&hi!=="minzoom"&&hi!=="maxzoom"&&(hi.indexOf("paint.")===0?K(ei[hi],Zt[hi],fe,Rt,hi.slice(6),Wn.setPaintProperty):zn(ei[hi],Zt[hi])||fe.push({command:Wn.setLayerProperty,args:[Rt,hi,Zt[hi]]}));for(hi in Zt)Object.prototype.hasOwnProperty.call(Zt,hi)&&!Object.prototype.hasOwnProperty.call(ei,hi)&&hi!=="layout"&&hi!=="paint"&&hi!=="filter"&&hi!=="metadata"&&hi!=="minzoom"&&hi!=="maxzoom"&&(hi.indexOf("paint.")===0?K(ei[hi],Zt[hi],fe,Rt,hi.slice(6),Wn.setPaintProperty):zn(ei[hi],Zt[hi])||fe.push({command:Wn.setLayerProperty,args:[Rt,hi,Zt[hi]]}))}else fe.push({command:Wn.removeLayer,args:[Rt]}),Wt=pt[pt.lastIndexOf(Rt)+1],fe.push({command:Wn.addLayer,args:[Zt,Wt]})}(q,u.layers,p)}catch(E){console.warn("Unable to compute style diff:",E),p=[{command:Wn.setStyle,args:[u]}]}return p},a.aF=function(f){const u=[],p=f.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},a.aG=function f(u,p){if(Array.isArray(u)){if(!Array.isArray(p)||u.length!==p.length)return!1;for(let E=0;E<u.length;E++)if(!f(u[E],p[E]))return!1;return!0}if(typeof u=="object"&&u!==null&&p!==null){if(typeof p!="object"||Object.keys(u).length!==Object.keys(p).length)return!1;for(const E in u)if(!f(u[E],p[E]))return!1;return!0}return u===p},a.aH=At,a.aI=yt,a.aJ=Au,a.aK=function(f){return f({pluginStatus:wa,pluginURL:tl}),Au.on("pluginStateChange",f),f},a.aL=class extends Cs{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},a.aM=Js,a.aN=class extends Cs{constructor(f,u){super(f,u),this.current=qo}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},a.aO=zo,a.aP=class extends Cs{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},a.aQ=class extends Cs{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},a.aR=Go,a.aS=function(f,u,p,E,B,q,W){var se=1/(u-p),fe=1/(E-B),ve=1/(q-W);return f[0]=-2*se,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*fe,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*ve,f[11]=0,f[12]=(u+p)*se,f[13]=(B+E)*fe,f[14]=(W+q)*ve,f[15]=1,f},a.aT=Qi,a.aU=K0,a.aV=class extends O{},a.aW=pd,a.aX=class extends x{},a.aY=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},a.aZ=v0,a.a_=Tt,a.aa=function(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,E,B,q)=>{const W=B||q;return u[E]=!W||W.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u},a.ab=function(f,u){const p=[];for(const E in f)E in u||p.push(E);return p},a.ac=function(f){if(Ft==null){const u=f.navigator?f.navigator.userAgent:null;Ft=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Ft},a.ad=Ue,a.ae=function(f,u,p){var E=Math.sin(p),B=Math.cos(p),q=u[0],W=u[1],se=u[2],fe=u[3],ve=u[4],Be=u[5],He=u[6],it=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=q*B+ve*E,f[1]=W*B+Be*E,f[2]=se*B+He*E,f[3]=fe*B+it*E,f[4]=ve*B-q*E,f[5]=Be*B-W*E,f[6]=He*B-se*E,f[7]=it*B-fe*E,f},a.af=function(f){var u=new Qh(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},a.ag=zl,a.ah=function(f,u){let p=0,E=0;if(f.kind==="constant")E=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:B,minZoom:q,maxZoom:W}=f,se=B?Ue(Sr.interpolationFactor(B,u,q,W),0,1):0;f.kind==="camera"?E=Ys.number(f.minSize,f.maxSize,se):p=se}return{uSizeT:p,uSize:E}},a.aj=function(f,{uSize:u,uSizeT:p},{lowerSize:E,upperSize:B}){return f.kind==="source"?E/ec:f.kind==="composite"?Ys.number(E/ec,B/ec,p):u},a.ak=qA,a.al=function(f,u,p,E){const B=u.y-f.y,q=u.x-f.x,W=E.y-p.y,se=E.x-p.x,fe=W*q-se*B;if(fe===0)return null;const ve=(se*(f.y-p.y)-W*(f.x-p.x))/fe;return new ce(f.x+ve*q,f.y+ve*B)},a.am=Vd,a.an=Yc,a.ao=Wh,a.ap=so,a.ar=L0,a.as=function(f,u){var p=u[0],E=u[1],B=u[2],q=u[3],W=u[4],se=u[5],fe=u[6],ve=u[7],Be=u[8],He=u[9],it=u[10],pt=u[11],vt=u[12],Dt=u[13],Lt=u[14],Rt=u[15],ei=p*se-E*W,Zt=p*fe-B*W,Wt=p*ve-q*W,hi=E*fe-B*se,vi=E*ve-q*se,Ji=B*ve-q*fe,In=Be*Dt-He*vt,un=Be*Lt-it*vt,ln=Be*Rt-pt*vt,dn=He*Lt-it*Dt,Vn=He*Rt-pt*Dt,on=it*Rt-pt*Lt,Ki=ei*on-Zt*Vn+Wt*dn+hi*ln-vi*un+Ji*In;return Ki?(f[0]=(se*on-fe*Vn+ve*dn)*(Ki=1/Ki),f[1]=(B*Vn-E*on-q*dn)*Ki,f[2]=(Dt*Ji-Lt*vi+Rt*hi)*Ki,f[3]=(it*vi-He*Ji-pt*hi)*Ki,f[4]=(fe*ln-W*on-ve*un)*Ki,f[5]=(p*on-B*ln+q*un)*Ki,f[6]=(Lt*Wt-vt*Ji-Rt*Zt)*Ki,f[7]=(Be*Ji-it*Wt+pt*Zt)*Ki,f[8]=(W*Vn-se*ln+ve*In)*Ki,f[9]=(E*ln-p*Vn-q*In)*Ki,f[10]=(vt*vi-Dt*Wt+Rt*ei)*Ki,f[11]=(He*Wt-Be*vi-pt*ei)*Ki,f[12]=(se*un-W*dn-fe*In)*Ki,f[13]=(p*dn-E*un+B*In)*Ki,f[14]=(Dt*Zt-vt*hi-Lt*ei)*Ki,f[15]=(Be*hi-He*Zt+it*ei)*Ki,f):null},a.at=Gf,a.au=wd,a.av=Zf,a.aw=function(){const f={},u=oi.$version;for(const p in oi.$root){const E=oi.$root[p];if(E.required){let B=null;B=p==="version"?u:E.type==="array"?[]:{},B!=null&&(f[p]=B)}}return f},a.ax=Wn,a.ay=Gl,a.az=Ti,a.b=function(f,u){const p=new Blob([new Uint8Array(f)],{type:"image/png"});createImageBitmap(p).then(E=>{u(null,E)}).catch(E=>{u(new Error(`Could not load image because of ${E.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},a.b0=Nn,a.b1=function(f,u){var p=f[0],E=f[1],B=f[2],q=f[3],W=f[4],se=f[5],fe=f[6],ve=f[7],Be=f[8],He=f[9],it=f[10],pt=f[11],vt=f[12],Dt=f[13],Lt=f[14],Rt=f[15],ei=u[0],Zt=u[1],Wt=u[2],hi=u[3],vi=u[4],Ji=u[5],In=u[6],un=u[7],ln=u[8],dn=u[9],Vn=u[10],on=u[11],Ki=u[12],Fn=u[13],Un=u[14],gr=u[15];return Math.abs(p-ei)<=tu*Math.max(1,Math.abs(p),Math.abs(ei))&&Math.abs(E-Zt)<=tu*Math.max(1,Math.abs(E),Math.abs(Zt))&&Math.abs(B-Wt)<=tu*Math.max(1,Math.abs(B),Math.abs(Wt))&&Math.abs(q-hi)<=tu*Math.max(1,Math.abs(q),Math.abs(hi))&&Math.abs(W-vi)<=tu*Math.max(1,Math.abs(W),Math.abs(vi))&&Math.abs(se-Ji)<=tu*Math.max(1,Math.abs(se),Math.abs(Ji))&&Math.abs(fe-In)<=tu*Math.max(1,Math.abs(fe),Math.abs(In))&&Math.abs(ve-un)<=tu*Math.max(1,Math.abs(ve),Math.abs(un))&&Math.abs(Be-ln)<=tu*Math.max(1,Math.abs(Be),Math.abs(ln))&&Math.abs(He-dn)<=tu*Math.max(1,Math.abs(He),Math.abs(dn))&&Math.abs(it-Vn)<=tu*Math.max(1,Math.abs(it),Math.abs(Vn))&&Math.abs(pt-on)<=tu*Math.max(1,Math.abs(pt),Math.abs(on))&&Math.abs(vt-Ki)<=tu*Math.max(1,Math.abs(vt),Math.abs(Ki))&&Math.abs(Dt-Fn)<=tu*Math.max(1,Math.abs(Dt),Math.abs(Fn))&&Math.abs(Lt-Un)<=tu*Math.max(1,Math.abs(Lt),Math.abs(Un))&&Math.abs(Rt-gr)<=tu*Math.max(1,Math.abs(Rt),Math.abs(gr))},a.b2=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.b3=function(f,u,p){return f[0]=u[0]*p[0],f[1]=u[1]*p[1],f[2]=u[2]*p[2],f[3]=u[3]*p[3],f},a.b4=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},a.b5=$t,a.b6=Fd,a.b7=Ld,a.b8=function(f,u,p,E,B){var q,W=1/Math.tan(u/2);return f[0]=W/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=W,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,B!=null&&B!==1/0?(f[10]=(B+E)*(q=1/(E-B)),f[14]=2*B*E*q):(f[10]=-1,f[14]=-2*E),f},a.b9=function(f,u,p){var E=Math.sin(p),B=Math.cos(p),q=u[4],W=u[5],se=u[6],fe=u[7],ve=u[8],Be=u[9],He=u[10],it=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=q*B+ve*E,f[5]=W*B+Be*E,f[6]=se*B+He*E,f[7]=fe*B+it*E,f[8]=ve*B-q*E,f[9]=Be*B-W*E,f[10]=He*B-se*E,f[11]=it*B-fe*E,f},a.bA=he,a.bB=I0,a.bC=Kr,a.bD=vs,a.ba=zt,a.bb=Mt,a.bc=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},a.bd=class extends le{},a.be=z0,a.bf=Bd,a.bg=Ne,a.bi=xn,a.bj=function(f,u,p=!1){if(wa===uc||wa===Ku||wa===Kl)throw new Error("setRTLTextPlugin cannot be called multiple times.");tl=Gi.resolveURL(f),wa=uc,ys=u,Uu(),p||br()},a.bk=Gu,a.bl=function(f,u){const p={};for(let B=0;B<f.length;B++){const q=u&&u[f[B].id]||io(f[B]);u&&(u[f[B].id]=q);let W=p[q];W||(W=p[q]=[]),W.push(f[B])}const E=[];for(const B in p)E.push(p[B]);return E},a.bm=Rn,a.bn=O0,a.bo=Hp,a.bp=Du,a.bq=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Va/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0],p=u.layout,E=u._unevaluatedLayout._values,B={layoutIconSize:E["icon-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),layoutTextSize:E["text-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),textMaxSize:E["text-size"].possiblyEvaluate(new gn(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:ve,maxZoom:Be}=f.bucket.textSizeData;B.compositeTextSizes=[E["text-size"].possiblyEvaluate(new gn(ve),f.canonical),E["text-size"].possiblyEvaluate(new gn(Be),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:ve,maxZoom:Be}=f.bucket.iconSizeData;B.compositeIconSizes=[E["icon-size"].possiblyEvaluate(new gn(ve),f.canonical),E["icon-size"].possiblyEvaluate(new gn(Be),f.canonical)]}const q=p.get("text-line-height")*so,W=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",se=p.get("text-keep-upright"),fe=p.get("text-size");for(const ve of f.bucket.features){const Be=p.get("text-font").evaluate(ve,{},f.canonical).join(","),He=fe.evaluate(ve,{},f.canonical),it=B.layoutTextSize.evaluate(ve,{},f.canonical),pt=B.layoutIconSize.evaluate(ve,{},f.canonical),vt={horizontal:{},vertical:void 0},Dt=ve.text;let Lt,Rt=[0,0];if(Dt){const Wt=Dt.toString(),hi=p.get("text-letter-spacing").evaluate(ve,{},f.canonical)*so,vi=Tn(Wt)?hi:0,Ji=p.get("text-anchor").evaluate(ve,{},f.canonical),In=KA(u,ve,f.canonical);if(!In){const on=p.get("text-radial-offset").evaluate(ve,{},f.canonical);Rt=on?YA(Ji,[on*so,Ph]):p.get("text-offset").evaluate(ve,{},f.canonical).map(Ki=>Ki*so)}let un=W?"center":p.get("text-justify").evaluate(ve,{},f.canonical);const ln=p.get("symbol-placement"),dn=ln==="point"?p.get("text-max-width").evaluate(ve,{},f.canonical)*so:0,Vn=()=>{f.bucket.allowVerticalPlacement&&Yl(Wt)&&(vt.vertical=GA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Be,dn,q,Ji,"left",vi,Rt,a.ai.vertical,!0,ln,it,He))};if(!W&&In){const on=new Set;if(un==="auto")for(let Fn=0;Fn<In.values.length;Fn+=2)on.add(Gf(In.values[Fn]));else on.add(un);let Ki=!1;for(const Fn of on)if(!vt.horizontal[Fn])if(Ki)vt.horizontal[Fn]=vt.horizontal[0];else{const Un=GA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Be,dn,q,"center",Fn,vi,Rt,a.ai.horizontal,!1,ln,it,He);Un&&(vt.horizontal[Fn]=Un,Ki=Un.positionedLines.length===1)}Vn()}else{un==="auto"&&(un=Gf(Ji));const on=GA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Be,dn,q,Ji,un,vi,Rt,a.ai.horizontal,!1,ln,it,He);on&&(vt.horizontal[un]=on),Vn(),Yl(Wt)&&W&&se&&(vt.vertical=GA(Dt,f.glyphMap,f.glyphPositions,f.imagePositions,Be,dn,q,Ji,un,vi,Rt,a.ai.vertical,!1,ln,it,He))}}let ei=!1;if(ve.icon&&ve.icon.name){const Wt=f.imageMap[ve.icon.name];Wt&&(Lt=P0(f.imagePositions[ve.icon.name],p.get("icon-offset").evaluate(ve,{},f.canonical),p.get("icon-anchor").evaluate(ve,{},f.canonical)),ei=!!Wt.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=ei:f.bucket.sdfIcons!==ei&&Ye("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Wt.pixelRatio!==f.bucket.pixelRatio||p.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const Zt=Hf(vt.horizontal)||vt.vertical;f.bucket.iconsInText=!!Zt&&Zt.iconsInText,(Zt||Lt)&&V0(f.bucket,ve,vt,Lt,f.imageMap,B,it,pt,Rt,ei,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},a.br=cd,a.bs=Cf,a.bt=Hl,a.bu=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},a.bv=T0,a.bw=Eh,a.bx=function(f,u,p,E,B){return N(this,void 0,void 0,function*(){if(xt())try{return yield Ci(f,u,p,E,B)}catch{}return function(q,W,se,fe,ve){const Be=q.width,He=q.height;ki&&Ni||(ki=new OffscreenCanvas(Be,He),Ni=ki.getContext("2d",{willReadFrequently:!0})),ki.width=Be,ki.height=He,Ni.drawImage(q,0,0,Be,He);const it=Ni.getImageData(W,se,fe,ve);return Ni.clearRect(0,0,Be,He),it.data}(f,u,p,E,B)})},a.by=F0,a.bz=$,a.c=sn,a.d=function(f,u){const p=new Image;p.onload=()=>{u(null,p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=yi})},p.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const E=new Blob([new Uint8Array(f)],{type:"image/png"});p.src=f.byteLength?URL.createObjectURL(E):yi},a.e=rt,a.f=function(f,u){return Vi(rt(f,{type:"json"}),u)},a.g=gi,a.h=Gi,a.i=Ut,a.j=an,a.k=Ot,a.l=bn,a.m=Vi,a.n=function(f){return new T0(f).readFields(OA,[])},a.o=function(f,u,p){if(!f.length)return p(null,[]);let E=f.length;const B=new Array(f.length);let q=null;f.forEach((W,se)=>{u(W,(fe,ve)=>{fe&&(q=fe),B[se]=ve,--E==0&&p(q,B)})})},a.p=Bf,a.q=bh,a.r=ms,a.s=wn,a.t=bo,a.u=Cn,a.v=oi,a.w=Ye,a.x=Nu,a.y=ro,a.z=function([f,u,p]){return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(p),y:f*Math.sin(u)*Math.sin(p),z:f*Math.cos(p)}}}),v(["./shared"],function(a){class N{constructor(X){this.keyCache={},X&&this.replace(X)}replace(X){this._layerConfigs={},this._layers={},this.update(X,[])}update(X,ne){for(const xe of X){this._layerConfigs[xe.id]=xe;const ye=this._layers[xe.id]=a.aC(xe);ye._featureFilter=a.a6(ye.filter),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(const xe of ne)delete this.keyCache[xe],delete this._layerConfigs[xe],delete this._layers[xe];this.familiesBySource={};const pe=a.bl(Object.values(this._layerConfigs),this.keyCache);for(const xe of pe){const ye=xe.map(Le=>this._layers[Le.id]),De=ye[0];if(De.visibility==="none")continue;const Oe=De.source||"";let Ve=this.familiesBySource[Oe];Ve||(Ve=this.familiesBySource[Oe]={});const Je=De.sourceLayer||"_geojsonTileLayer";let et=Ve[Je];et||(et=Ve[Je]=[]),et.push(ye)}}}class ${constructor(X){const ne={},pe=[];for(const Oe in X){const Ve=X[Oe],Je=ne[Oe]={};for(const et in Ve){const Le=Ve[+et];if(!Le||Le.bitmap.width===0||Le.bitmap.height===0)continue;const qe={x:0,y:0,w:Le.bitmap.width+2,h:Le.bitmap.height+2};pe.push(qe),Je[et]={rect:qe,metrics:Le.metrics}}}const{w:xe,h:ye}=a.p(pe),De=new a.q({width:xe||1,height:ye||1});for(const Oe in X){const Ve=X[Oe];for(const Je in Ve){const et=Ve[+Je];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const Le=ne[Oe][Je].rect;a.q.copy(et.bitmap,De,{x:0,y:0},{x:Le.x+1,y:Le.y+1},et.bitmap)}}this.image=De,this.positions=ne}}a.bm("GlyphAtlas",$);class he{constructor(X){this.tileID=new a.O(X.tileID.overscaledZ,X.tileID.wrap,X.tileID.canonical.z,X.tileID.canonical.x,X.tileID.canonical.y),this.uid=X.uid,this.zoom=X.zoom,this.pixelRatio=X.pixelRatio,this.tileSize=X.tileSize,this.source=X.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=X.showCollisionBoxes,this.collectResourceTiming=!!X.collectResourceTiming,this.returnDependencies=!!X.returnDependencies,this.promoteId=X.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(X,ne,pe,xe,ye){this.status="parsing",this.data=X,this.collisionBoxArray=new a.a3;const De=new a.bn(Object.keys(X.layers).sort()),Oe=new a.bo(this.tileID,this.promoteId);Oe.bucketLayerIDs=[];const Ve={},Je={featureIndex:Oe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:pe},et=ne.familiesBySource[this.source];for(const ti in et){const ui=X.layers[ti];if(!ui)continue;ui.version===1&&a.w(`Vector tile source "${this.source}" layer "${ti}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ri=De.encode(ti),bi=[];for(let Si=0;Si<ui.length;Si++){const Jt=ui.feature(Si),Sn=Oe.getId(Jt,ti);bi.push({feature:Jt,id:Sn,index:Si,sourceLayerIndex:Ri})}for(const Si of et[ti]){const Jt=Si[0];Jt.source!==this.source&&a.w(`layer.source = ${Jt.source} does not equal this.source = ${this.source}`),Jt.minzoom&&this.zoom<Math.floor(Jt.minzoom)||Jt.maxzoom&&this.zoom>=Jt.maxzoom||Jt.visibility!=="none"&&(oe(Si,this.zoom,pe),(Ve[Jt.id]=Jt.createBucket({index:Oe.bucketLayerIDs.length,layers:Si,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ri,sourceID:this.source})).populate(bi,Je,this.tileID.canonical),Oe.bucketLayerIDs.push(Si.map(Sn=>Sn.id)))}}let Le,qe,dt,Pt;const o=a.aH(Je.glyphDependencies,ti=>Object.keys(ti).map(Number));this.inFlightDependencies.forEach(ti=>ti==null?void 0:ti.cancel()),this.inFlightDependencies=[];const Me=++this.dependencySentinel;Object.keys(o).length?this.inFlightDependencies.push(xe.send("getGlyphs",{uid:this.uid,stacks:o,source:this.source,tileID:this.tileID,type:"glyphs"},(ti,ui)=>{Me===this.dependencySentinel&&(Le||(Le=ti,qe=ui,fi.call(this)))})):qe={};const li=Object.keys(Je.iconDependencies);li.length?this.inFlightDependencies.push(xe.send("getImages",{icons:li,source:this.source,tileID:this.tileID,type:"icons"},(ti,ui)=>{Me===this.dependencySentinel&&(Le||(Le=ti,dt=ui,fi.call(this)))})):dt={};const di=Object.keys(Je.patternDependencies);function fi(){if(Le)return ye(Le);if(qe&&dt&&Pt){const ti=new $(qe),ui=new a.bp(dt,Pt);for(const Ri in Ve){const bi=Ve[Ri];bi instanceof a.a4?(oe(bi.layers,this.zoom,pe),a.bq({bucket:bi,glyphMap:qe,glyphPositions:ti.positions,imageMap:dt,imagePositions:ui.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):bi.hasPattern&&(bi instanceof a.br||bi instanceof a.bs||bi instanceof a.bt)&&(oe(bi.layers,this.zoom,pe),bi.addFeatures(Je,this.tileID.canonical,ui.patternPositions))}this.status="done",ye(null,{buckets:Object.values(Ve).filter(Ri=>!Ri.isEmpty()),featureIndex:Oe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ti.image,imageAtlas:ui,glyphMap:this.returnDependencies?qe:null,iconMap:this.returnDependencies?dt:null,glyphPositions:this.returnDependencies?ti.positions:null})}}di.length?this.inFlightDependencies.push(xe.send("getImages",{icons:di,source:this.source,tileID:this.tileID,type:"patterns"},(ti,ui)=>{Me===this.dependencySentinel&&(Le||(Le=ti,Pt=ui,fi.call(this)))})):Pt={},fi.call(this)}}function oe(re,X,ne){const pe=new a.a8(X);for(const xe of re)xe.recalculate(pe,ne)}function ce(re,X){const ne=a.l(re.request,(pe,xe,ye,De)=>{if(pe)X(pe);else if(xe)try{const Oe=new a.bw.VectorTile(new a.bv(xe));X(null,{vectorTile:Oe,rawData:xe,cacheControl:ye,expires:De})}catch(Oe){const Ve=new Uint8Array(xe);let Je=`Unable to parse the tile at ${re.request.url}, `;Je+=Ve[0]===31&&Ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Oe.messge}`,X(new Error(Je))}});return()=>{ne.cancel(),X()}}class _e{constructor(X,ne,pe,xe){this.actor=X,this.layerIndex=ne,this.availableImages=pe,this.loadVectorData=xe||ce,this.fetching={},this.loading={},this.loaded={}}loadTile(X,ne){const pe=X.uid;this.loading||(this.loading={});const xe=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bu(X.request),ye=this.loading[pe]=new he(X);ye.abort=this.loadVectorData(X,(De,Oe)=>{if(delete this.loading[pe],De||!Oe)return ye.status="done",this.loaded[pe]=ye,ne(De);const Ve=Oe.rawData,Je={};Oe.expires&&(Je.expires=Oe.expires),Oe.cacheControl&&(Je.cacheControl=Oe.cacheControl);const et={};if(xe){const Le=xe.finish();Le&&(et.resourceTiming=JSON.parse(JSON.stringify(Le)))}ye.vectorTile=Oe.vectorTile,ye.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Le,qe)=>{if(delete this.fetching[pe],Le||!qe)return ne(Le);ne(null,a.e({rawTileData:Ve.slice(0)},qe,Je,et))}),this.loaded=this.loaded||{},this.loaded[pe]=ye,this.fetching[pe]={rawTileData:Ve,cacheControl:Je,resourceTiming:et}})}reloadTile(X,ne){const pe=this.loaded,xe=X.uid;if(pe&&pe[xe]){const ye=pe[xe];ye.showCollisionBoxes=X.showCollisionBoxes,ye.status==="parsing"?ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,(De,Oe)=>{if(De||!Oe)return ne(De,Oe);let Ve;if(this.fetching[xe]){const{rawTileData:Je,cacheControl:et,resourceTiming:Le}=this.fetching[xe];delete this.fetching[xe],Ve=a.e({rawTileData:Je.slice(0)},Oe,et,Le)}else Ve=Oe;ne(null,Ve)}):ye.status==="done"&&(ye.vectorTile?ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,ne):ne())}}abortTile(X,ne){const pe=this.loading,xe=X.uid;pe&&pe[xe]&&pe[xe].abort&&(pe[xe].abort(),delete pe[xe]),ne()}removeTile(X,ne){const pe=this.loaded,xe=X.uid;pe&&pe[xe]&&delete pe[xe],ne()}}class Ze{constructor(){this.loaded={}}loadTile(X,ne){return a._(this,void 0,void 0,function*(){const{uid:pe,encoding:xe,rawImageData:ye,redFactor:De,greenFactor:Oe,blueFactor:Ve,baseShift:Je}=X,et=ye.width+2,Le=ye.height+2,qe=a.a(ye)?new a.R({width:et,height:Le},yield a.bx(ye,-1,-1,et,Le)):ye,dt=new a.by(pe,qe,xe,De,Oe,Ve,Je);this.loaded=this.loaded||{},this.loaded[pe]=dt,ne(null,dt)})}removeTile(X){const ne=this.loaded,pe=X.uid;ne&&ne[pe]&&delete ne[pe]}}function nt(re,X){if(re.length!==0){Ke(re[0],X);for(var ne=1;ne<re.length;ne++)Ke(re[ne],!X)}}function Ke(re,X){for(var ne=0,pe=0,xe=0,ye=re.length,De=ye-1;xe<ye;De=xe++){var Oe=(re[xe][0]-re[De][0])*(re[De][1]+re[xe][1]),Ve=ne+Oe;pe+=Math.abs(ne)>=Math.abs(Oe)?ne-Ve+Oe:Oe-Ve+ne,ne=Ve}ne+pe>=0!=!!X&&re.reverse()}var st=a.bz(function re(X,ne){var pe,xe=X&&X.type;if(xe==="FeatureCollection")for(pe=0;pe<X.features.length;pe++)re(X.features[pe],ne);else if(xe==="GeometryCollection")for(pe=0;pe<X.geometries.length;pe++)re(X.geometries[pe],ne);else if(xe==="Feature")re(X.geometry,ne);else if(xe==="Polygon")nt(X.coordinates,ne);else if(xe==="MultiPolygon")for(pe=0;pe<X.coordinates.length;pe++)nt(X.coordinates[pe],ne);return X});const ht=a.bw.VectorTileFeature.prototype.toGeoJSON;var xt={exports:{}},zt=a.bA,Mt=a.bw.VectorTileFeature,Ue=$t;function $t(re,X){this.options=X||{},this.features=re,this.length=re.length}function rt(re,X){this.id=typeof re.id=="number"?re.id:void 0,this.type=re.type,this.rawGeometry=re.type===1?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=X||4096}$t.prototype.feature=function(re){return new rt(this.features[re],this.options.extent)},rt.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var X=0;X<re.length;X++){for(var ne=re[X],pe=[],xe=0;xe<ne.length;xe++)pe.push(new zt(ne[xe][0],ne[xe][1]));this.geometry.push(pe)}return this.geometry},rt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,X=1/0,ne=-1/0,pe=1/0,xe=-1/0,ye=0;ye<re.length;ye++)for(var De=re[ye],Oe=0;Oe<De.length;Oe++){var Ve=De[Oe];X=Math.min(X,Ve.x),ne=Math.max(ne,Ve.x),pe=Math.min(pe,Ve.y),xe=Math.max(xe,Ve.y)}return[X,pe,ne,xe]},rt.prototype.toGeoJSON=Mt.prototype.toGeoJSON;var gt=a.bB,At=Ue;function yt(re){var X=new gt;return function(ne,pe){for(var xe in ne.layers)pe.writeMessage(3,St,ne.layers[xe])}(re,X),X.finish()}function St(re,X){var ne;X.writeVarintField(15,re.version||1),X.writeStringField(1,re.name||""),X.writeVarintField(5,re.extent||4096);var pe={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<re.length;ne++)pe.feature=re.feature(ne),X.writeMessage(2,ut,pe);var xe=pe.keys;for(ne=0;ne<xe.length;ne++)X.writeStringField(3,xe[ne]);var ye=pe.values;for(ne=0;ne<ye.length;ne++)X.writeMessage(4,Ft,ye[ne])}function ut(re,X){var ne=re.feature;ne.id!==void 0&&X.writeVarintField(1,ne.id),X.writeMessage(2,Ye,re),X.writeVarintField(3,ne.type),X.writeMessage(4,Ut,ne)}function Ye(re,X){var ne=re.feature,pe=re.keys,xe=re.values,ye=re.keycache,De=re.valuecache;for(var Oe in ne.properties){var Ve=ne.properties[Oe],Je=ye[Oe];if(Ve!==null){Je===void 0&&(pe.push(Oe),ye[Oe]=Je=pe.length-1),X.writeVarint(Je);var et=typeof Ve;et!=="string"&&et!=="boolean"&&et!=="number"&&(Ve=JSON.stringify(Ve));var Le=et+":"+Ve,qe=De[Le];qe===void 0&&(xe.push(Ve),De[Le]=qe=xe.length-1),X.writeVarint(qe)}}}function _t(re,X){return(X<<3)+(7&re)}function ct(re){return re<<1^re>>31}function Ut(re,X){for(var ne=re.loadGeometry(),pe=re.type,xe=0,ye=0,De=ne.length,Oe=0;Oe<De;Oe++){var Ve=ne[Oe],Je=1;pe===1&&(Je=Ve.length),X.writeVarint(_t(1,Je));for(var et=pe===3?Ve.length-1:Ve.length,Le=0;Le<et;Le++){Le===1&&pe!==1&&X.writeVarint(_t(2,et-1));var qe=Ve[Le].x-xe,dt=Ve[Le].y-ye;X.writeVarint(ct(qe)),X.writeVarint(ct(dt)),xe+=qe,ye+=dt}pe===3&&X.writeVarint(_t(7,1))}}function Ft(re,X){var ne=typeof re;ne==="string"?X.writeStringField(1,re):ne==="boolean"?X.writeBooleanField(7,re):ne==="number"&&(re%1!=0?X.writeDoubleField(3,re):re<0?X.writeSVarintField(6,re):X.writeVarintField(5,re))}xt.exports=yt,xt.exports.fromVectorTileJs=yt,xt.exports.fromGeojsonVt=function(re,X){X=X||{};var ne={};for(var pe in re)ne[pe]=new At(re[pe].features,X),ne[pe].name=pe,ne[pe].version=X.version,ne[pe].extent=X.extent;return yt({layers:ne})},xt.exports.GeoJSONWrapper=At;var Vt=a.bz(xt.exports);const yi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},Ci=Math.fround||(ki=new Float32Array(1),re=>(ki[0]=+re,ki[0]));var ki;const Ni=3,tn=5,Zi=6;class Gi{constructor(X){this.options=Object.assign(Object.create(yi),X),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(X){const{log:ne,minZoom:pe,maxZoom:xe}=this.options;ne&&console.time("total time");const ye=`prepare ${X.length} points`;ne&&console.time(ye),this.points=X;const De=[];for(let Ve=0;Ve<X.length;Ve++){const Je=X[Ve];if(!Je.geometry)continue;const[et,Le]=Je.geometry.coordinates,qe=Ci(Ti(et)),dt=Ci(gi(Le));De.push(qe,dt,1/0,Ve,-1,1),this.options.reduce&&De.push(0)}let Oe=this.trees[xe+1]=this._createTree(De);ne&&console.timeEnd(ye);for(let Ve=xe;Ve>=pe;Ve--){const Je=+Date.now();Oe=this.trees[Ve]=this._createTree(this._cluster(Oe,Ve)),ne&&console.log("z%d: %d clusters in %dms",Ve,Oe.numItems,+Date.now()-Je)}return ne&&console.timeEnd("total time"),this}getClusters(X,ne){let pe=((X[0]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,X[1]));let ye=X[2]===180?180:((X[2]+180)%360+360)%360-180;const De=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)pe=-180,ye=180;else if(pe>ye){const Le=this.getClusters([pe,xe,180,De],ne),qe=this.getClusters([-180,xe,ye,De],ne);return Le.concat(qe)}const Oe=this.trees[this._limitZoom(ne)],Ve=Oe.range(Ti(pe),gi(De),Ti(ye),gi(xe)),Je=Oe.data,et=[];for(const Le of Ve){const qe=this.stride*Le;et.push(Je[qe+tn]>1?sn(Je,qe,this.clusterProps):this.points[Je[qe+Ni]])}return et}getChildren(X){const ne=this._getOriginId(X),pe=this._getOriginZoom(X),xe="No cluster with the specified id.",ye=this.trees[pe];if(!ye)throw new Error(xe);const De=ye.data;if(ne*this.stride>=De.length)throw new Error(xe);const Oe=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),Ve=ye.within(De[ne*this.stride],De[ne*this.stride+1],Oe),Je=[];for(const et of Ve){const Le=et*this.stride;De[Le+4]===X&&Je.push(De[Le+tn]>1?sn(De,Le,this.clusterProps):this.points[De[Le+Ni]])}if(Je.length===0)throw new Error(xe);return Je}getLeaves(X,ne,pe){const xe=[];return this._appendLeaves(xe,X,ne=ne||10,pe=pe||0,0),xe}getTile(X,ne,pe){const xe=this.trees[this._limitZoom(X)],ye=Math.pow(2,X),{extent:De,radius:Oe}=this.options,Ve=Oe/De,Je=(pe-Ve)/ye,et=(pe+1+Ve)/ye,Le={features:[]};return this._addTileFeatures(xe.range((ne-Ve)/ye,Je,(ne+1+Ve)/ye,et),xe.data,ne,pe,ye,Le),ne===0&&this._addTileFeatures(xe.range(1-Ve/ye,Je,1,et),xe.data,ye,pe,ye,Le),ne===ye-1&&this._addTileFeatures(xe.range(0,Je,Ve/ye,et),xe.data,-1,pe,ye,Le),Le.features.length?Le:null}getClusterExpansionZoom(X){let ne=this._getOriginZoom(X)-1;for(;ne<=this.options.maxZoom;){const pe=this.getChildren(X);if(ne++,pe.length!==1)break;X=pe[0].properties.cluster_id}return ne}_appendLeaves(X,ne,pe,xe,ye){const De=this.getChildren(ne);for(const Oe of De){const Ve=Oe.properties;if(Ve&&Ve.cluster?ye+Ve.point_count<=xe?ye+=Ve.point_count:ye=this._appendLeaves(X,Ve.cluster_id,pe,xe,ye):ye<xe?ye++:X.push(Oe),X.length===pe)break}return ye}_createTree(X){const ne=new a.av(X.length/this.stride|0,this.options.nodeSize,Float32Array);for(let pe=0;pe<X.length;pe+=this.stride)ne.add(X[pe],X[pe+1]);return ne.finish(),ne.data=X,ne}_addTileFeatures(X,ne,pe,xe,ye,De){for(const Oe of X){const Ve=Oe*this.stride,Je=ne[Ve+tn]>1;let et,Le,qe;if(Je)et=xn(ne,Ve,this.clusterProps),Le=ne[Ve],qe=ne[Ve+1];else{const o=this.points[ne[Ve+Ni]];et=o.properties;const[Me,li]=o.geometry.coordinates;Le=Ti(Me),qe=gi(li)}const dt={type:1,geometry:[[Math.round(this.options.extent*(Le*ye-pe)),Math.round(this.options.extent*(qe*ye-xe))]],tags:et};let Pt;Pt=Je||this.options.generateId?ne[Ve+Ni]:this.points[ne[Ve+Ni]].id,Pt!==void 0&&(dt.id=Pt),De.features.push(dt)}}_limitZoom(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))}_cluster(X,ne){const{radius:pe,extent:xe,reduce:ye,minPoints:De}=this.options,Oe=pe/(xe*Math.pow(2,ne)),Ve=X.data,Je=[],et=this.stride;for(let Le=0;Le<Ve.length;Le+=et){if(Ve[Le+2]<=ne)continue;Ve[Le+2]=ne;const qe=Ve[Le],dt=Ve[Le+1],Pt=X.within(Ve[Le],Ve[Le+1],Oe),o=Ve[Le+tn];let Me=o;for(const li of Pt){const di=li*et;Ve[di+2]>ne&&(Me+=Ve[di+tn])}if(Me>o&&Me>=De){let li,di=qe*o,fi=dt*o,ti=-1;const ui=((Le/et|0)<<5)+(ne+1)+this.points.length;for(const Ri of Pt){const bi=Ri*et;if(Ve[bi+2]<=ne)continue;Ve[bi+2]=ne;const Si=Ve[bi+tn];di+=Ve[bi]*Si,fi+=Ve[bi+1]*Si,Ve[bi+4]=ui,ye&&(li||(li=this._map(Ve,Le,!0),ti=this.clusterProps.length,this.clusterProps.push(li)),ye(li,this._map(Ve,bi)))}Ve[Le+4]=ui,Je.push(di/Me,fi/Me,1/0,ui,-1,Me),ye&&Je.push(ti)}else{for(let li=0;li<et;li++)Je.push(Ve[Le+li]);if(Me>1)for(const li of Pt){const di=li*et;if(!(Ve[di+2]<=ne)){Ve[di+2]=ne;for(let fi=0;fi<et;fi++)Je.push(Ve[di+fi])}}}}return Je}_getOriginId(X){return X-this.points.length>>5}_getOriginZoom(X){return(X-this.points.length)%32}_map(X,ne,pe){if(X[ne+tn]>1){const De=this.clusterProps[X[ne+Zi]];return pe?Object.assign({},De):De}const xe=this.points[X[ne+Ni]].properties,ye=this.options.map(xe);return pe&&ye===xe?Object.assign({},ye):ye}}function sn(re,X,ne){return{type:"Feature",id:re[X+Ni],properties:xn(re,X,ne),geometry:{type:"Point",coordinates:[(pe=re[X],360*(pe-.5)),Oi(re[X+1])]}};var pe}function xn(re,X,ne){const pe=re[X+tn],xe=pe>=1e4?`${Math.round(pe/1e3)}k`:pe>=1e3?Math.round(pe/100)/10+"k":pe,ye=re[X+Zi],De=ye===-1?{}:Object.assign({},ne[ye]);return Object.assign(De,{cluster:!0,cluster_id:re[X+Ni],point_count:pe,point_count_abbreviated:xe})}function Ti(re){return re/360+.5}function gi(re){const X=Math.sin(re*Math.PI/180),ne=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return ne<0?0:ne>1?1:ne}function Oi(re){const X=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function Vi(re,X,ne,pe){for(var xe,ye=pe,De=ne-X>>1,Oe=ne-X,Ve=re[X],Je=re[X+1],et=re[ne],Le=re[ne+1],qe=X+3;qe<ne;qe+=3){var dt=bn(re[qe],re[qe+1],Ve,Je,et,Le);if(dt>ye)xe=qe,ye=dt;else if(dt===ye){var Pt=Math.abs(qe-De);Pt<Oe&&(xe=qe,Oe=Pt)}}ye>pe&&(xe-X>3&&Vi(re,X,xe,pe),re[xe+2]=ye,ne-xe>3&&Vi(re,xe,ne,pe))}function bn(re,X,ne,pe,xe,ye){var De=xe-ne,Oe=ye-pe;if(De!==0||Oe!==0){var Ve=((re-ne)*De+(X-pe)*Oe)/(De*De+Oe*Oe);Ve>1?(ne=xe,pe=ye):Ve>0&&(ne+=De*Ve,pe+=Oe*Ve)}return(De=re-ne)*De+(Oe=X-pe)*Oe}function wn(re,X,ne,pe){var xe={id:re===void 0?null:re,type:X,geometry:ne,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ye){var De=ye.geometry,Oe=ye.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")xi(ye,De);else if(Oe==="Polygon"||Oe==="MultiLineString")for(var Ve=0;Ve<De.length;Ve++)xi(ye,De[Ve]);else if(Oe==="MultiPolygon")for(Ve=0;Ve<De.length;Ve++)for(var Je=0;Je<De[Ve].length;Je++)xi(ye,De[Ve][Je])}(xe),xe}function xi(re,X){for(var ne=0;ne<X.length;ne+=3)re.minX=Math.min(re.minX,X[ne]),re.minY=Math.min(re.minY,X[ne+1]),re.maxX=Math.max(re.maxX,X[ne]),re.maxY=Math.max(re.maxY,X[ne+1])}function Bn(re,X,ne,pe){if(X.geometry){var xe=X.geometry.coordinates,ye=X.geometry.type,De=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),Oe=[],Ve=X.id;if(ne.promoteId?Ve=X.properties[ne.promoteId]:ne.generateId&&(Ve=pe||0),ye==="Point")Ot(xe,Oe);else if(ye==="MultiPoint")for(var Je=0;Je<xe.length;Je++)Ot(xe[Je],Oe);else if(ye==="LineString")an(xe,Oe,De,!1);else if(ye==="MultiLineString"){if(ne.lineMetrics){for(Je=0;Je<xe.length;Je++)an(xe[Je],Oe=[],De,!1),re.push(wn(Ve,"LineString",Oe,X.properties));return}$n(xe,Oe,De,!1)}else if(ye==="Polygon")$n(xe,Oe,De,!0);else{if(ye!=="MultiPolygon"){if(ye==="GeometryCollection"){for(Je=0;Je<X.geometry.geometries.length;Je++)Bn(re,{id:Ve,geometry:X.geometry.geometries[Je],properties:X.properties},ne,pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Je=0;Je<xe.length;Je++){var et=[];$n(xe[Je],et,De,!0),Oe.push(et)}}re.push(wn(Ve,ye,Oe,X.properties))}}function Ot(re,X){X.push(oi(re[0])),X.push(Yi(re[1])),X.push(0)}function an(re,X,ne,pe){for(var xe,ye,De=0,Oe=0;Oe<re.length;Oe++){var Ve=oi(re[Oe][0]),Je=Yi(re[Oe][1]);X.push(Ve),X.push(Je),X.push(0),Oe>0&&(De+=pe?(xe*Je-Ve*ye)/2:Math.sqrt(Math.pow(Ve-xe,2)+Math.pow(Je-ye,2))),xe=Ve,ye=Je}var et=X.length-3;X[2]=1,Vi(X,0,et,ne),X[et+2]=1,X.size=Math.abs(De),X.start=0,X.end=X.size}function $n(re,X,ne,pe){for(var xe=0;xe<re.length;xe++){var ye=[];an(re[xe],ye,ne,pe),X.push(ye)}}function oi(re){return re/360+.5}function Yi(re){var X=Math.sin(re*Math.PI/180),ne=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return ne<0?0:ne>1?1:ne}function Xn(re,X,ne,pe,xe,ye,De,Oe){if(pe/=X,ye>=(ne/=X)&&De<pe)return re;if(De<ne||ye>=pe)return null;for(var Ve=[],Je=0;Je<re.length;Je++){var et=re[Je],Le=et.geometry,qe=et.type,dt=xe===0?et.minX:et.minY,Pt=xe===0?et.maxX:et.maxY;if(dt>=ne&&Pt<pe)Ve.push(et);else if(!(Pt<ne||dt>=pe)){var o=[];if(qe==="Point"||qe==="MultiPoint")zn(Le,o,ne,pe,xe);else if(qe==="LineString")Wn(Le,o,ne,pe,xe,!1,Oe.lineMetrics);else if(qe==="MultiLineString")b(Le,o,ne,pe,xe,!1);else if(qe==="Polygon")b(Le,o,ne,pe,xe,!0);else if(qe==="MultiPolygon")for(var Me=0;Me<Le.length;Me++){var li=[];b(Le[Me],li,ne,pe,xe,!0),li.length&&o.push(li)}if(o.length){if(Oe.lineMetrics&&qe==="LineString"){for(Me=0;Me<o.length;Me++)Ve.push(wn(et.id,qe,o[Me],et.tags));continue}qe!=="LineString"&&qe!=="MultiLineString"||(o.length===1?(qe="LineString",o=o[0]):qe="MultiLineString"),qe!=="Point"&&qe!=="MultiPoint"||(qe=o.length===3?"Point":"MultiPoint"),Ve.push(wn(et.id,qe,o,et.tags))}}}return Ve.length?Ve:null}function zn(re,X,ne,pe,xe){for(var ye=0;ye<re.length;ye+=3){var De=re[ye+xe];De>=ne&&De<=pe&&(X.push(re[ye]),X.push(re[ye+1]),X.push(re[ye+2]))}}function Wn(re,X,ne,pe,xe,ye,De){for(var Oe,Ve,Je=_n(re),et=xe===0?U:K,Le=re.start,qe=0;qe<re.length-3;qe+=3){var dt=re[qe],Pt=re[qe+1],o=re[qe+2],Me=re[qe+3],li=re[qe+4],di=xe===0?dt:Pt,fi=xe===0?Me:li,ti=!1;De&&(Oe=Math.sqrt(Math.pow(dt-Me,2)+Math.pow(Pt-li,2))),di<ne?fi>ne&&(Ve=et(Je,dt,Pt,Me,li,ne),De&&(Je.start=Le+Oe*Ve)):di>pe?fi<pe&&(Ve=et(Je,dt,Pt,Me,li,pe),De&&(Je.start=Le+Oe*Ve)):M(Je,dt,Pt,o),fi<ne&&di>=ne&&(Ve=et(Je,dt,Pt,Me,li,ne),ti=!0),fi>pe&&di<=pe&&(Ve=et(Je,dt,Pt,Me,li,pe),ti=!0),!ye&&ti&&(De&&(Je.end=Le+Oe*Ve),X.push(Je),Je=_n(re)),De&&(Le+=Oe)}var ui=re.length-3;dt=re[ui],Pt=re[ui+1],o=re[ui+2],(di=xe===0?dt:Pt)>=ne&&di<=pe&&M(Je,dt,Pt,o),ui=Je.length-3,ye&&ui>=3&&(Je[ui]!==Je[0]||Je[ui+1]!==Je[1])&&M(Je,Je[0],Je[1],Je[2]),Je.length&&X.push(Je)}function _n(re){var X=[];return X.size=re.size,X.start=re.start,X.end=re.end,X}function b(re,X,ne,pe,xe,ye){for(var De=0;De<re.length;De++)Wn(re[De],X,ne,pe,xe,ye,!1)}function M(re,X,ne,pe){re.push(X),re.push(ne),re.push(pe)}function U(re,X,ne,pe,xe,ye){var De=(ye-X)/(pe-X);return re.push(ye),re.push(ne+(xe-ne)*De),re.push(1),De}function K(re,X,ne,pe,xe,ye){var De=(ye-ne)/(xe-ne);return re.push(X+(pe-X)*De),re.push(ye),re.push(1),De}function ie(re,X){for(var ne=[],pe=0;pe<re.length;pe++){var xe,ye=re[pe],De=ye.type;if(De==="Point"||De==="MultiPoint"||De==="LineString")xe=de(ye.geometry,X);else if(De==="MultiLineString"||De==="Polygon"){xe=[];for(var Oe=0;Oe<ye.geometry.length;Oe++)xe.push(de(ye.geometry[Oe],X))}else if(De==="MultiPolygon")for(xe=[],Oe=0;Oe<ye.geometry.length;Oe++){for(var Ve=[],Je=0;Je<ye.geometry[Oe].length;Je++)Ve.push(de(ye.geometry[Oe][Je],X));xe.push(Ve)}ne.push(wn(ye.id,De,xe,ye.tags))}return ne}function de(re,X){var ne=[];ne.size=re.size,re.start!==void 0&&(ne.start=re.start,ne.end=re.end);for(var pe=0;pe<re.length;pe+=3)ne.push(re[pe]+X,re[pe+1],re[pe+2]);return ne}function be(re,X){if(re.transformed)return re;var ne,pe,xe,ye=1<<re.z,De=re.x,Oe=re.y;for(ne=0;ne<re.features.length;ne++){var Ve=re.features[ne],Je=Ve.geometry,et=Ve.type;if(Ve.geometry=[],et===1)for(pe=0;pe<Je.length;pe+=2)Ve.geometry.push(Ee(Je[pe],Je[pe+1],X,ye,De,Oe));else for(pe=0;pe<Je.length;pe++){var Le=[];for(xe=0;xe<Je[pe].length;xe+=2)Le.push(Ee(Je[pe][xe],Je[pe][xe+1],X,ye,De,Oe));Ve.geometry.push(Le)}}return re.transformed=!0,re}function Ee(re,X,ne,pe,xe,ye){return[Math.round(ne*(re*pe-xe)),Math.round(ne*(X*pe-ye))]}function Ce(re,X,ne,pe,xe){for(var ye=X===xe.maxZoom?0:xe.tolerance/((1<<X)*xe.extent),De={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:pe,z:X,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Oe=0;Oe<re.length;Oe++){De.numFeatures++,Re(De,re[Oe],ye,xe);var Ve=re[Oe].minX,Je=re[Oe].minY,et=re[Oe].maxX,Le=re[Oe].maxY;Ve<De.minX&&(De.minX=Ve),Je<De.minY&&(De.minY=Je),et>De.maxX&&(De.maxX=et),Le>De.maxY&&(De.maxY=Le)}return De}function Re(re,X,ne,pe){var xe=X.geometry,ye=X.type,De=[];if(ye==="Point"||ye==="MultiPoint")for(var Oe=0;Oe<xe.length;Oe+=3)De.push(xe[Oe]),De.push(xe[Oe+1]),re.numPoints++,re.numSimplified++;else if(ye==="LineString")$e(De,xe,re,ne,!1,!1);else if(ye==="MultiLineString"||ye==="Polygon")for(Oe=0;Oe<xe.length;Oe++)$e(De,xe[Oe],re,ne,ye==="Polygon",Oe===0);else if(ye==="MultiPolygon")for(var Ve=0;Ve<xe.length;Ve++){var Je=xe[Ve];for(Oe=0;Oe<Je.length;Oe++)$e(De,Je[Oe],re,ne,!0,Oe===0)}if(De.length){var et=X.tags||null;if(ye==="LineString"&&pe.lineMetrics){for(var Le in et={},X.tags)et[Le]=X.tags[Le];et.mapbox_clip_start=xe.start/xe.size,et.mapbox_clip_end=xe.end/xe.size}var qe={geometry:De,type:ye==="Polygon"||ye==="MultiPolygon"?3:ye==="LineString"||ye==="MultiLineString"?2:1,tags:et};X.id!==null&&(qe.id=X.id),re.features.push(qe)}}function $e(re,X,ne,pe,xe,ye){var De=pe*pe;if(pe>0&&X.size<(xe?De:pe))ne.numPoints+=X.length/3;else{for(var Oe=[],Ve=0;Ve<X.length;Ve+=3)(pe===0||X[Ve+2]>De)&&(ne.numSimplified++,Oe.push(X[Ve]),Oe.push(X[Ve+1])),ne.numPoints++;xe&&function(Je,et){for(var Le=0,qe=0,dt=Je.length,Pt=dt-2;qe<dt;Pt=qe,qe+=2)Le+=(Je[qe]-Je[Pt])*(Je[qe+1]+Je[Pt+1]);if(Le>0===et)for(qe=0,dt=Je.length;qe<dt/2;qe+=2){var o=Je[qe],Me=Je[qe+1];Je[qe]=Je[dt-2-qe],Je[qe+1]=Je[dt-1-qe],Je[dt-2-qe]=o,Je[dt-1-qe]=Me}}(Oe,ye),re.push(Oe)}}function je(re,X){var ne=(X=this.options=function(xe,ye){for(var De in ye)xe[De]=ye[De];return xe}(Object.create(this.options),X)).debug;if(ne&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");var pe=function(xe,ye){var De=[];if(xe.type==="FeatureCollection")for(var Oe=0;Oe<xe.features.length;Oe++)Bn(De,xe.features[Oe],ye,Oe);else Bn(De,xe.type==="Feature"?xe:{geometry:xe},ye);return De}(re,X);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),pe=function(xe,ye){var De=ye.buffer/ye.extent,Oe=xe,Ve=Xn(xe,1,-1-De,De,0,-1,2,ye),Je=Xn(xe,1,1-De,2+De,0,-1,2,ye);return(Ve||Je)&&(Oe=Xn(xe,1,-De,1+De,0,-1,2,ye)||[],Ve&&(Oe=ie(Ve,1).concat(Oe)),Je&&(Oe=Oe.concat(ie(Je,-1)))),Oe}(pe,X),pe.length&&this.splitTile(pe,0,0,0),ne&&(pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function We(re,X,ne){return 32*((1<<re)*ne+X)+re}function Ge(re,X){return X?re.properties[X]:re.id}function mt(re,X){if(re==null)return!0;if(re.type==="Feature")return Ge(re,X)!=null;if(re.type==="FeatureCollection"){const ne=new Set;for(const pe of re.features){const xe=Ge(pe,X);if(xe==null||ne.has(xe))return!1;ne.add(xe)}return!0}return!1}function ot(re,X){const ne=new Map;if(re!=null)if(re.type==="Feature")ne.set(Ge(re,X),re);else for(const pe of re.features)ne.set(Ge(pe,X),pe);return ne}je.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},je.prototype.splitTile=function(re,X,ne,pe,xe,ye,De){for(var Oe=[re,X,ne,pe],Ve=this.options,Je=Ve.debug;Oe.length;){pe=Oe.pop(),ne=Oe.pop(),X=Oe.pop(),re=Oe.pop();var et=1<<X,Le=We(X,ne,pe),qe=this.tiles[Le];if(!qe&&(Je>1&&console.time("creation"),qe=this.tiles[Le]=Ce(re,X,ne,pe,Ve),this.tileCoords.push({z:X,x:ne,y:pe}),Je)){Je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,ne,pe,qe.numFeatures,qe.numPoints,qe.numSimplified),console.timeEnd("creation"));var dt="z"+X;this.stats[dt]=(this.stats[dt]||0)+1,this.total++}if(qe.source=re,xe){if(X===Ve.maxZoom||X===xe)continue;var Pt=1<<xe-X;if(ne!==Math.floor(ye/Pt)||pe!==Math.floor(De/Pt))continue}else if(X===Ve.indexMaxZoom||qe.numPoints<=Ve.indexMaxPoints)continue;if(qe.source=null,re.length!==0){Je>1&&console.time("clipping");var o,Me,li,di,fi,ti,ui=.5*Ve.buffer/Ve.extent,Ri=.5-ui,bi=.5+ui,Si=1+ui;o=Me=li=di=null,fi=Xn(re,et,ne-ui,ne+bi,0,qe.minX,qe.maxX,Ve),ti=Xn(re,et,ne+Ri,ne+Si,0,qe.minX,qe.maxX,Ve),re=null,fi&&(o=Xn(fi,et,pe-ui,pe+bi,1,qe.minY,qe.maxY,Ve),Me=Xn(fi,et,pe+Ri,pe+Si,1,qe.minY,qe.maxY,Ve),fi=null),ti&&(li=Xn(ti,et,pe-ui,pe+bi,1,qe.minY,qe.maxY,Ve),di=Xn(ti,et,pe+Ri,pe+Si,1,qe.minY,qe.maxY,Ve),ti=null),Je>1&&console.timeEnd("clipping"),Oe.push(o||[],X+1,2*ne,2*pe),Oe.push(Me||[],X+1,2*ne,2*pe+1),Oe.push(li||[],X+1,2*ne+1,2*pe),Oe.push(di||[],X+1,2*ne+1,2*pe+1)}}},je.prototype.getTile=function(re,X,ne){var pe=this.options,xe=pe.extent,ye=pe.debug;if(re<0||re>24)return null;var De=1<<re,Oe=We(re,X=(X%De+De)%De,ne);if(this.tiles[Oe])return be(this.tiles[Oe],xe);ye>1&&console.log("drilling down to z%d-%d-%d",re,X,ne);for(var Ve,Je=re,et=X,Le=ne;!Ve&&Je>0;)Je--,et=Math.floor(et/2),Le=Math.floor(Le/2),Ve=this.tiles[We(Je,et,Le)];return Ve&&Ve.source?(ye>1&&console.log("found parent tile z%d-%d-%d",Je,et,Le),ye>1&&console.time("drilling down"),this.splitTile(Ve.source,Je,et,Le,re,X,ne),ye>1&&console.timeEnd("drilling down"),this.tiles[Oe]?be(this.tiles[Oe],xe):null):null};class Pe extends _e{constructor(X,ne,pe,xe){super(X,ne,pe),this._dataUpdateable=new Map,this.loadGeoJSON=(ye,De)=>{const{promoteId:Oe}=ye;if(ye.request)return a.f(ye.request,(Ve,Je,et,Le)=>{this._dataUpdateable=mt(Je,Oe)?ot(Je,Oe):void 0,De(Ve,Je,et,Le)});if(typeof ye.data=="string")try{const Ve=JSON.parse(ye.data);this._dataUpdateable=mt(Ve,Oe)?ot(Ve,Oe):void 0,De(null,Ve)}catch{De(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`))}else ye.dataDiff?this._dataUpdateable?(function(Ve,Je,et){var Le,qe,dt,Pt;if(Je.removeAll&&Ve.clear(),Je.remove)for(const o of Je.remove)Ve.delete(o);if(Je.add)for(const o of Je.add){const Me=Ge(o,et);Me!=null&&Ve.set(Me,o)}if(Je.update)for(const o of Je.update){let Me=Ve.get(o.id);if(Me==null)continue;const li=!o.removeAllProperties&&(((Le=o.removeProperties)===null||Le===void 0?void 0:Le.length)>0||((qe=o.addOrUpdateProperties)===null||qe===void 0?void 0:qe.length)>0);if((o.newGeometry||o.removeAllProperties||li)&&(Me=Object.assign({},Me),Ve.set(o.id,Me),li&&(Me.properties=Object.assign({},Me.properties))),o.newGeometry&&(Me.geometry=o.newGeometry),o.removeAllProperties)Me.properties={};else if(((dt=o.removeProperties)===null||dt===void 0?void 0:dt.length)>0)for(const di of o.removeProperties)Object.prototype.hasOwnProperty.call(Me.properties,di)&&delete Me.properties[di];if(((Pt=o.addOrUpdateProperties)===null||Pt===void 0?void 0:Pt.length)>0)for(const{key:di,value:fi}of o.addOrUpdateProperties)Me.properties[di]=fi}}(this._dataUpdateable,ye.dataDiff,Oe),De(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):De(new Error(`Cannot update existing geojson data in ${ye.source}`)):De(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,xe&&(this.loadGeoJSON=xe)}loadGeoJSONTile(X,ne){const pe=X.tileID.canonical;if(!this._geoJSONIndex)return ne(null,null);const xe=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!xe)return ne(null,null);const ye=new class{constructor(Oe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.N,this.length=Oe.length,this._features=Oe}feature(Oe){return new class{constructor(Ve){this._feature=Ve,this.extent=a.N,this.type=Ve.type,this.properties=Ve.tags,"id"in Ve&&!isNaN(Ve.id)&&(this.id=parseInt(Ve.id,10))}loadGeometry(){if(this._feature.type===1){const Ve=[];for(const Je of this._feature.geometry)Ve.push([new a.P(Je[0],Je[1])]);return Ve}{const Ve=[];for(const Je of this._feature.geometry){const et=[];for(const Le of Je)et.push(new a.P(Le[0],Le[1]));Ve.push(et)}return Ve}}toGeoJSON(Ve,Je,et){return ht.call(this,Ve,Je,et)}}(this._features[Oe])}}(xe.features);let De=Vt(ye);De.byteOffset===0&&De.byteLength===De.buffer.byteLength||(De=new Uint8Array(De)),ne(null,{vectorTile:ye,rawData:De.buffer})}loadData(X,ne){var pe;(pe=this._pendingRequest)===null||pe===void 0||pe.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const xe=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bu(X.request);this._pendingCallback=ne,this._pendingRequest=this.loadGeoJSON(X,(ye,De)=>{if(delete this._pendingCallback,delete this._pendingRequest,ye||!De)return ne(ye);if(typeof De!="object")return ne(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));{st(De,!0);try{if(X.filter){const Ve=a.bC(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(et=>`${et.key}: ${et.message}`).join(", "));De={type:"FeatureCollection",features:De.features.filter(et=>Ve.value.evaluate({zoom:0},et))}}this._geoJSONIndex=X.cluster?new Gi(function({superclusterOptions:Ve,clusterProperties:Je}){if(!Je||!Ve)return Ve;const et={},Le={},qe={accumulated:null,zoom:0},dt={properties:null},Pt=Object.keys(Je);for(const o of Pt){const[Me,li]=Je[o],di=a.bC(li),fi=a.bC(typeof Me=="string"?[Me,["accumulated"],["get",o]]:Me);et[o]=di.value,Le[o]=fi.value}return Ve.map=o=>{dt.properties=o;const Me={};for(const li of Pt)Me[li]=et[li].evaluate(qe,dt);return Me},Ve.reduce=(o,Me)=>{dt.properties=Me;for(const li of Pt)qe.accumulated=o[li],o[li]=Le[li].evaluate(qe,dt)},Ve}(X)).load(De.features):function(Ve,Je){return new je(Ve,Je)}(De,X.geojsonVtOptions)}catch(Ve){return ne(Ve)}this.loaded={};const Oe={};if(xe){const Ve=xe.finish();Ve&&(Oe.resourceTiming={},Oe.resourceTiming[X.source]=JSON.parse(JSON.stringify(Ve)))}ne(null,Oe)}})}reloadTile(X,ne){const pe=this.loaded;return pe&&pe[X.uid]?super.reloadTile(X,ne):this.loadTile(X,ne)}removeSource(X,ne){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ne()}getClusterExpansionZoom(X,ne){try{ne(null,this._geoJSONIndex.getClusterExpansionZoom(X.clusterId))}catch(pe){ne(pe)}}getClusterChildren(X,ne){try{ne(null,this._geoJSONIndex.getChildren(X.clusterId))}catch(pe){ne(pe)}}getClusterLeaves(X,ne){try{ne(null,this._geoJSONIndex.getLeaves(X.clusterId,X.limit,X.offset))}catch(pe){ne(pe)}}}class ae{constructor(X){this.self=X,this.actor=new a.C(X,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:_e,geojson:Pe},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ne,pe)=>{if(this.workerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.workerSourceTypes[ne]=pe},this.self.registerRTLTextPlugin=ne=>{if(a.bD.isParsed())throw new Error("RTL text plugin already registered.");a.bD.applyArabicShaping=ne.applyArabicShaping,a.bD.processBidirectionalText=ne.processBidirectionalText,a.bD.processStyledBidirectionalText=ne.processStyledBidirectionalText}}setReferrer(X,ne){this.referrer=ne}setImages(X,ne,pe){this.availableImages[X]=ne;for(const xe in this.workerSources[X]){const ye=this.workerSources[X][xe];for(const De in ye)ye[De].availableImages=ne}pe()}setLayers(X,ne,pe){this.getLayerIndex(X).replace(ne),pe()}updateLayers(X,ne,pe){this.getLayerIndex(X).update(ne.layers,ne.removedIds),pe()}loadTile(X,ne,pe){this.getWorkerSource(X,ne.type,ne.source).loadTile(ne,pe)}loadDEMTile(X,ne,pe){this.getDEMWorkerSource(X,ne.source).loadTile(ne,pe)}reloadTile(X,ne,pe){this.getWorkerSource(X,ne.type,ne.source).reloadTile(ne,pe)}abortTile(X,ne,pe){this.getWorkerSource(X,ne.type,ne.source).abortTile(ne,pe)}removeTile(X,ne,pe){this.getWorkerSource(X,ne.type,ne.source).removeTile(ne,pe)}removeDEMTile(X,ne){this.getDEMWorkerSource(X,ne.source).removeTile(ne)}removeSource(X,ne,pe){if(!this.workerSources[X]||!this.workerSources[X][ne.type]||!this.workerSources[X][ne.type][ne.source])return;const xe=this.workerSources[X][ne.type][ne.source];delete this.workerSources[X][ne.type][ne.source],xe.removeSource!==void 0?xe.removeSource(ne,pe):pe()}loadWorkerSource(X,ne,pe){try{this.self.importScripts(ne.url),pe()}catch(xe){pe(xe.toString())}}syncRTLPluginState(X,ne,pe){try{a.bD.setState(ne);const xe=a.bD.getPluginURL();if(a.bD.isLoaded()&&!a.bD.isParsed()&&xe!=null){this.self.importScripts(xe);const ye=a.bD.isParsed();pe(ye?void 0:new Error(`RTL Text Plugin failed to import scripts from ${xe}`),ye)}}catch(xe){pe(xe.toString())}}getAvailableImages(X){let ne=this.availableImages[X];return ne||(ne=[]),ne}getLayerIndex(X){let ne=this.layerIndexes[X];return ne||(ne=this.layerIndexes[X]=new N),ne}getWorkerSource(X,ne,pe){return this.workerSources[X]||(this.workerSources[X]={}),this.workerSources[X][ne]||(this.workerSources[X][ne]={}),this.workerSources[X][ne][pe]||(this.workerSources[X][ne][pe]=new this.workerSourceTypes[ne]({send:(xe,ye,De)=>{this.actor.send(xe,ye,De,X)}},this.getLayerIndex(X),this.getAvailableImages(X))),this.workerSources[X][ne][pe]}getDEMWorkerSource(X,ne){return this.demWorkerSources[X]||(this.demWorkerSources[X]={}),this.demWorkerSources[X][ne]||(this.demWorkerSources[X][ne]=new Ze),this.demWorkerSources[X][ne]}}return a.i()&&(self.worker=new ae(self)),ae}),v(["./shared"],function(a){var N="3.6.2";class ${static testProp(A){if(!$.docStyle)return A[0];for(let C=0;C<A.length;C++)if(A[C]in $.docStyle)return A[C];return A[0]}static create(A,C,O){const V=window.document.createElement(A);return C!==void 0&&(V.className=C),O&&O.appendChild(V),V}static createNS(A,C){return window.document.createElementNS(A,C)}static disableDrag(){$.docStyle&&$.selectProp&&($.userSelect=$.docStyle[$.selectProp],$.docStyle[$.selectProp]="none")}static enableDrag(){$.docStyle&&$.selectProp&&($.docStyle[$.selectProp]=$.userSelect)}static setTransform(A,C){A.style[$.transformProp]=C}static addEventListener(A,C,O,V={}){A.addEventListener(C,O,"passive"in V?V:V.capture)}static removeEventListener(A,C,O,V={}){A.removeEventListener(C,O,"passive"in V?V:V.capture)}static suppressClickInternal(A){A.preventDefault(),A.stopPropagation(),window.removeEventListener("click",$.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",$.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",$.suppressClickInternal,!0)},0)}static mousePos(A,C){const O=A.getBoundingClientRect();return new a.P(C.clientX-O.left-A.clientLeft,C.clientY-O.top-A.clientTop)}static touchPos(A,C){const O=A.getBoundingClientRect(),V=[];for(let x=0;x<C.length;x++)V.push(new a.P(C[x].clientX-O.left-A.clientLeft,C[x].clientY-O.top-A.clientTop));return V}static mouseButton(A){return A.button}static remove(A){A.parentNode&&A.parentNode.removeChild(A)}}$.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,$.selectProp=$.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),$.transformProp=$.testProp(["transform","WebkitTransform"]);const he={supported:!1,testSupport:function(Q){!_e&&ce&&(Ze?nt(Q):oe=Q)}};let oe,ce,_e=!1,Ze=!1;function nt(Q){const A=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,A);try{if(Q.texImage2D(Q.TEXTURE_2D,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,ce),Q.isContextLost())return;he.supported=!0}catch{}Q.deleteTexture(A),_e=!0}var Ke,st;typeof document<"u"&&(ce=document.createElement("img"),ce.onload=function(){oe&&nt(oe),oe=null,Ze=!0},ce.onerror=function(){_e=!0,oe=null},ce.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(Q){let A,C,O,V;Q.resetRequestQueue=()=>{A=[],C=0,O=0,V={}},Q.addThrottleControl=l=>{const d=O++;return V[d]=l,d},Q.removeThrottleControl=l=>{delete V[l],i()},Q.getImage=(l,d,y=!0)=>{he.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*");const I={requestParameters:l,supportImageRefresh:y,callback:d,cancelled:!1,completed:!1,cancel:()=>{I.completed||I.cancelled||(I.cancelled=!0,I.innerRequest&&(I.innerRequest.cancel(),C--),i())}};return A.push(I),i(),I};const x=l=>{const{requestParameters:d,supportImageRefresh:y,callback:I}=l;return a.e(d,{type:"image"}),(y!==!1||a.i()||a.g(d.url)||d.headers&&!Object.keys(d.headers).reduce((k,z)=>k&&z==="accept",!0)?a.m:r)(d,(k,z,Z,Y)=>{s(l,I,k,z,Z,Y)})},s=(l,d,y,I,k,z)=>{y?d(y):I instanceof HTMLImageElement||a.a(I)?d(null,I):I&&((Z,Y)=>{typeof createImageBitmap=="function"?a.b(Z,Y):a.d(Z,Y)})(I,(Z,Y)=>{Z!=null?d(Z):Y!=null&&d(null,Y,{cacheControl:k,expires:z})}),l.cancelled||(l.completed=!0,C--,i())},i=()=>{const l=(()=>{const d=Object.keys(V);let y=!1;if(d.length>0){for(const I of d)if(y=V[I](),y)break}return y})()?a.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let d=C;d<l&&A.length>0;d++){const y=A.shift();if(y.cancelled){d--;continue}const I=x(y);C++,y.innerRequest=I}},r=(l,d)=>{const y=new Image,I=l.url;let k=!1;const z=l.credentials;return z&&z==="include"?y.crossOrigin="use-credentials":(z&&z==="same-origin"||!a.s(I))&&(y.crossOrigin="anonymous"),y.fetchPriority="high",y.onload=()=>{d(null,y),y.onerror=y.onload=null},y.onerror=()=>{k||d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),y.onerror=y.onload=null},y.src=I,{cancel:()=>{k=!0,y.src=""}}}}(Ke||(Ke={})),Ke.resetRequestQueue(),function(Q){Q.Glyphs="Glyphs",Q.Image="Image",Q.Source="Source",Q.SpriteImage="SpriteImage",Q.SpriteJSON="SpriteJSON",Q.Style="Style",Q.Tile="Tile",Q.Unknown="Unknown"}(st||(st={}));class ht{constructor(A){this._transformRequestFn=A}transformRequest(A,C){return this._transformRequestFn&&this._transformRequestFn(A,C)||{url:A}}normalizeSpriteURL(A,C,O){const V=function(x){const s=x.match(xt);if(!s)throw new Error(`Unable to parse URL "${x}"`);return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}(A);return V.path+=`${C}${O}`,function(x){const s=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${s}`}(V)}setTransformRequest(A){this._transformRequestFn=A}}const xt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function zt(Q){var A=new a.A(3);return A[0]=Q[0],A[1]=Q[1],A[2]=Q[2],A}var Mt,Ue=function(Q,A,C){return Q[0]=A[0]-C[0],Q[1]=A[1]-C[1],Q[2]=A[2]-C[2],Q};Mt=new a.A(3),a.A!=Float32Array&&(Mt[0]=0,Mt[1]=0,Mt[2]=0);var $t=function(Q){var A=Q[0],C=Q[1];return A*A+C*C};function rt(Q){const A=[];if(typeof Q=="string")A.push({id:"default",url:Q});else if(Q&&Q.length>0){const C=[];for(const{id:O,url:V}of Q){const x=`${O}${V}`;C.indexOf(x)===-1&&(C.push(x),A.push({id:O,url:V}))}}return A}function gt(Q,A,C,O,V){if(O)return void Q(O);if(V!==Object.values(A).length||V!==Object.values(C).length)return;const x={};for(const s in A){x[s]={};const i=a.h.getImageCanvasContext(C[s]),r=A[s];for(const l in r){const{width:d,height:y,x:I,y:k,sdf:z,pixelRatio:Z,stretchX:Y,stretchY:Ae,content:Ie}=r[l];x[s][l]={data:null,pixelRatio:Z,sdf:z,stretchX:Y,stretchY:Ae,content:Ie,spriteData:{width:d,height:y,x:I,y:k,context:i}}}}Q(null,x)}(function(){var Q=new a.A(2);a.A!=Float32Array&&(Q[0]=0,Q[1]=0)})();class At{constructor(A,C,O,V){this.context=A,this.format=O,this.texture=A.gl.createTexture(),this.update(C,V)}update(A,C,O){const{width:V,height:x}=A,s=!(this.size&&this.size[0]===V&&this.size[1]===x||O),{context:i}=this,{gl:r}=i;if(this.useMipmap=!!(C&&C.useMipmap),r.bindTexture(r.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===r.RGBA&&(!C||C.premultiply!==!1)),s)this.size=[V,x],A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texImage2D(r.TEXTURE_2D,0,this.format,this.format,r.UNSIGNED_BYTE,A):r.texImage2D(r.TEXTURE_2D,0,this.format,V,x,0,this.format,r.UNSIGNED_BYTE,A.data);else{const{x:l,y:d}=O||{x:0,y:0};A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texSubImage2D(r.TEXTURE_2D,0,l,d,r.RGBA,r.UNSIGNED_BYTE,A):r.texSubImage2D(r.TEXTURE_2D,0,l,d,V,x,r.RGBA,r.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&r.generateMipmap(r.TEXTURE_2D)}bind(A,C,O){const{context:V}=this,{gl:x}=V;x.bindTexture(x.TEXTURE_2D,this.texture),O!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(O=x.LINEAR),A!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,A),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,O||A),this.filter=A),C!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,C),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,C),this.wrap=C)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:A}=this.context;A.deleteTexture(this.texture),this.texture=null}}function yt(Q){const{userImage:A}=Q;return!!(A&&A.render&&A.render())&&(Q.data.replace(new Uint8Array(A.data.buffer)),!0)}class St extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(A){if(this.loaded!==A&&(this.loaded=A,A)){for(const{ids:C,callback:O}of this.requestors)this._notify(C,O);this.requestors=[]}}getImage(A){const C=this.images[A];if(C&&!C.data&&C.spriteData){const O=C.spriteData;C.data=new a.R({width:O.width,height:O.height},O.context.getImageData(O.x,O.y,O.width,O.height).data),C.spriteData=null}return C}addImage(A,C){if(this.images[A])throw new Error(`Image id ${A} already exist, use updateImage instead`);this._validate(A,C)&&(this.images[A]=C)}_validate(A,C){let O=!0;const V=C.data||C.spriteData;return this._validateStretch(C.stretchX,V&&V.width)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchX" value`))),O=!1),this._validateStretch(C.stretchY,V&&V.height)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchY" value`))),O=!1),this._validateContent(C.content,C)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "content" value`))),O=!1),O}_validateStretch(A,C){if(!A)return!0;let O=0;for(const V of A){if(V[0]<O||V[1]<V[0]||C<V[1])return!1;O=V[1]}return!0}_validateContent(A,C){if(!A)return!0;if(A.length!==4)return!1;const O=C.spriteData,V=O&&O.width||C.data.width,x=O&&O.height||C.data.height;return!(A[0]<0||V<A[0]||A[1]<0||x<A[1]||A[2]<0||V<A[2]||A[3]<0||x<A[3]||A[2]<A[0]||A[3]<A[1])}updateImage(A,C,O=!0){const V=this.getImage(A);if(O&&(V.data.width!==C.data.width||V.data.height!==C.data.height))throw new Error(`size mismatch between old image (${V.data.width}x${V.data.height}) and new image (${C.data.width}x${C.data.height}).`);C.version=V.version+1,this.images[A]=C,this.updatedImages[A]=!0}removeImage(A){const C=this.images[A];delete this.images[A],delete this.patterns[A],C.userImage&&C.userImage.onRemove&&C.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(A,C){let O=!0;if(!this.isLoaded())for(const V of A)this.images[V]||(O=!1);this.isLoaded()||O?this._notify(A,C):this.requestors.push({ids:A,callback:C})}_notify(A,C){const O={};for(const V of A){let x=this.getImage(V);x||(this.fire(new a.k("styleimagemissing",{id:V})),x=this.getImage(V)),x?O[V]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:a.w(`Image "${V}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}C(null,O)}getPixelSize(){const{width:A,height:C}=this.atlasImage;return{width:A,height:C}}getPattern(A){const C=this.patterns[A],O=this.getImage(A);if(!O)return null;if(C&&C.position.version===O.version)return C.position;if(C)C.position.version=O.version;else{const V={w:O.data.width+2,h:O.data.height+2,x:0,y:0},x=new a.I(V,O);this.patterns[A]={bin:V,position:x}}return this._updatePatternAtlas(),this.patterns[A].position}bind(A){const C=A.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new At(A,this.atlasImage,C.RGBA),this.atlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE)}_updatePatternAtlas(){const A=[];for(const x in this.patterns)A.push(this.patterns[x].bin);const{w:C,h:O}=a.p(A),V=this.atlasImage;V.resize({width:C||1,height:O||1});for(const x in this.patterns){const{bin:s}=this.patterns[x],i=s.x+1,r=s.y+1,l=this.getImage(x).data,d=l.width,y=l.height;a.R.copy(l,V,{x:0,y:0},{x:i,y:r},{width:d,height:y}),a.R.copy(l,V,{x:0,y:y-1},{x:i,y:r-1},{width:d,height:1}),a.R.copy(l,V,{x:0,y:0},{x:i,y:r+y},{width:d,height:1}),a.R.copy(l,V,{x:d-1,y:0},{x:i-1,y:r},{width:1,height:y}),a.R.copy(l,V,{x:0,y:0},{x:i+d,y:r},{width:1,height:y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(A){for(const C of A){if(this.callbackDispatchedThisFrame[C])continue;this.callbackDispatchedThisFrame[C]=!0;const O=this.getImage(C);O||a.w(`Image with ID: "${C}" was not found`),yt(O)&&this.updateImage(C,O)}}}const ut=1e20;function Ye(Q,A,C,O,V,x,s,i,r){for(let l=A;l<A+O;l++)_t(Q,C*x+l,x,V,s,i,r);for(let l=C;l<C+V;l++)_t(Q,l*x+A,1,O,s,i,r)}function _t(Q,A,C,O,V,x,s){x[0]=0,s[0]=-ut,s[1]=ut,V[0]=Q[A];for(let i=1,r=0,l=0;i<O;i++){V[i]=Q[A+i*C];const d=i*i;do{const y=x[r];l=(V[i]-V[y]+d-y*y)/(i-y)/2}while(l<=s[r]&&--r>-1);r++,x[r]=i,s[r]=l,s[r+1]=ut}for(let i=0,r=0;i<O;i++){for(;s[r+1]<i;)r++;const l=x[r],d=i-l;Q[A+i*C]=V[l]+d*d}}class ct{constructor(A,C){this.requestManager=A,this.localIdeographFontFamily=C,this.entries={}}setURL(A){this.url=A}getGlyphs(A,C){const O=[];for(const V in A)for(const x of A[V])O.push({stack:V,id:x});a.o(O,({stack:V,id:x},s)=>{let i=this.entries[V];i||(i=this.entries[V]={glyphs:{},requests:{},ranges:{}});let r=i.glyphs[x];if(r!==void 0)return void s(null,{stack:V,id:x,glyph:r});if(r=this._tinySDF(i,V,x),r)return i.glyphs[x]=r,void s(null,{stack:V,id:x,glyph:r});const l=Math.floor(x/256);if(256*l>65535)return void s(new Error("glyphs > 65535 not supported"));if(i.ranges[l])return void s(null,{stack:V,id:x,glyph:r});if(!this.url)return void s(new Error("glyphsUrl is not set"));let d=i.requests[l];d||(d=i.requests[l]=[],ct.loadGlyphRange(V,l,this.url,this.requestManager,(y,I)=>{if(I){for(const k in I)this._doesCharSupportLocalGlyph(+k)||(i.glyphs[+k]=I[+k]);i.ranges[l]=!0}for(const k of d)k(y,I);delete i.requests[l]})),d.push((y,I)=>{y?s(y):I&&s(null,{stack:V,id:x,glyph:I[x]||null})})},(V,x)=>{if(V)C(V);else if(x){const s={};for(const{stack:i,id:r,glyph:l}of x)(s[i]||(s[i]={}))[r]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics};C(null,s)}})}_doesCharSupportLocalGlyph(A){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](A)||a.u["Hangul Syllables"](A)||a.u.Hiragana(A)||a.u.Katakana(A))}_tinySDF(A,C,O){const V=this.localIdeographFontFamily;if(!V||!this._doesCharSupportLocalGlyph(O))return;let x=A.tinySDF;if(!x){let i="400";/bold/i.test(C)?i="900":/medium/i.test(C)?i="500":/light/i.test(C)&&(i="200"),x=A.tinySDF=new ct.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:V,fontWeight:i})}const s=x.draw(String.fromCharCode(O));return{id:O,bitmap:new a.q({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}ct.loadGlyphRange=function(Q,A,C,O,V){const x=256*A,s=x+255,i=O.transformRequest(C.replace("{fontstack}",Q).replace("{range}",`${x}-${s}`),st.Glyphs);a.l(i,(r,l)=>{if(r)V(r);else if(l){const d={};for(const y of a.n(l))d[y.id]=y;V(null,d)}})},ct.TinySDF=class{constructor({fontSize:Q=24,buffer:A=3,radius:C=8,cutoff:O=.25,fontFamily:V="sans-serif",fontWeight:x="normal",fontStyle:s="normal"}={}){this.buffer=A,this.cutoff=O,this.radius=C;const i=this.size=Q+4*A,r=this._createCanvas(i),l=this.ctx=r.getContext("2d",{willReadFrequently:!0});l.font=`${s} ${x} ${Q}px ${V}`,l.textBaseline="alphabetic",l.textAlign="left",l.fillStyle="black",this.gridOuter=new Float64Array(i*i),this.gridInner=new Float64Array(i*i),this.f=new Float64Array(i),this.z=new Float64Array(i+1),this.v=new Uint16Array(i)}_createCanvas(Q){const A=document.createElement("canvas");return A.width=A.height=Q,A}draw(Q){const{width:A,actualBoundingBoxAscent:C,actualBoundingBoxDescent:O,actualBoundingBoxLeft:V,actualBoundingBoxRight:x}=this.ctx.measureText(Q),s=Math.ceil(C),i=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-V))),r=Math.min(this.size-this.buffer,s+Math.ceil(O)),l=i+2*this.buffer,d=r+2*this.buffer,y=Math.max(l*d,0),I=new Uint8ClampedArray(y),k={data:I,width:l,height:d,glyphWidth:i,glyphHeight:r,glyphTop:s,glyphLeft:0,glyphAdvance:A};if(i===0||r===0)return k;const{ctx:z,buffer:Z,gridInner:Y,gridOuter:Ae}=this;z.clearRect(Z,Z,i,r),z.fillText(Q,Z,Z+s);const Ie=z.getImageData(Z,Z,i,r);Ae.fill(ut,0,y),Y.fill(0,0,y);for(let ke=0;ke<r;ke++)for(let Fe=0;Fe<i;Fe++){const ze=Ie.data[4*(ke*i+Fe)+3]/255;if(ze===0)continue;const tt=(ke+Z)*l+Fe+Z;if(ze===1)Ae[tt]=0,Y[tt]=ut;else{const wt=.5-ze;Ae[tt]=wt>0?wt*wt:0,Y[tt]=wt<0?wt*wt:0}}Ye(Ae,0,0,l,d,l,this.f,this.v,this.z),Ye(Y,Z,Z,i,r,l,this.f,this.v,this.z);for(let ke=0;ke<y;ke++){const Fe=Math.sqrt(Ae[ke])-Math.sqrt(Y[ke]);I[ke]=Math.round(255-255*(Fe/this.radius+this.cutoff))}return k}};class Ut{constructor(){this.specification=a.v.light.position}possiblyEvaluate(A,C){return a.z(A.expression.evaluate(C))}interpolate(A,C,O){return{x:a.B.number(A.x,C.x,O),y:a.B.number(A.y,C.y,O),z:a.B.number(A.z,C.z,O)}}}let Ft;class Vt extends a.E{constructor(A){super(),Ft=Ft||new a.r({anchor:new a.D(a.v.light.anchor),position:new Ut,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(Ft),this.setLight(A),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(A,C={}){if(!this._validate(a.t,A,C))for(const O in A){const V=A[O];O.endsWith("-transition")?this._transitionable.setTransition(O.slice(0,-11),V):this._transitionable.setValue(O,V)}}updateTransitions(A){this._transitioning=this._transitionable.transitioned(A,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(A){this.properties=this._transitioning.possiblyEvaluate(A)}_validate(A,C,O){return(!O||O.validate!==!1)&&a.x(this,A.call(a.y,a.e({value:C,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}}class yi{constructor(A,C){this.width=A,this.height=C,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(A,C){const O=A.join(",")+String(C);return this.dashEntry[O]||(this.dashEntry[O]=this.addDash(A,C)),this.dashEntry[O]}getDashRanges(A,C,O){const V=[];let x=A.length%2==1?-A[A.length-1]*O:0,s=A[0]*O,i=!0;V.push({left:x,right:s,isDash:i,zeroLength:A[0]===0});let r=A[0];for(let l=1;l<A.length;l++){i=!i;const d=A[l];x=r*O,r+=d,s=r*O,V.push({left:x,right:s,isDash:i,zeroLength:d===0})}return V}addRoundDash(A,C,O){const V=C/2;for(let x=-O;x<=O;x++){const s=this.width*(this.nextRow+O+x);let i=0,r=A[i];for(let l=0;l<this.width;l++){l/r.right>1&&(r=A[++i]);const d=Math.abs(l-r.left),y=Math.abs(l-r.right),I=Math.min(d,y);let k;const z=x/O*(V+1);if(r.isDash){const Z=V-Math.abs(z);k=Math.sqrt(I*I+Z*Z)}else k=V-Math.sqrt(I*I+z*z);this.data[s+l]=Math.max(0,Math.min(255,k+128))}}}addRegularDash(A){for(let i=A.length-1;i>=0;--i){const r=A[i],l=A[i+1];r.zeroLength?A.splice(i,1):l&&l.isDash===r.isDash&&(l.left=r.left,A.splice(i,1))}const C=A[0],O=A[A.length-1];C.isDash===O.isDash&&(C.left=O.left-this.width,O.right=C.right+this.width);const V=this.width*this.nextRow;let x=0,s=A[x];for(let i=0;i<this.width;i++){i/s.right>1&&(s=A[++x]);const r=Math.abs(i-s.left),l=Math.abs(i-s.right),d=Math.min(r,l);this.data[V+i]=Math.max(0,Math.min(255,(s.isDash?d:-d)+128))}}addDash(A,C){const O=C?7:0,V=2*O+1;if(this.nextRow+V>this.height)return a.w("LineAtlas out of space"),null;let x=0;for(let i=0;i<A.length;i++)x+=A[i];if(x!==0){const i=this.width/x,r=this.getDashRanges(A,this.width,i);C?this.addRoundDash(r,i,O):this.addRegularDash(r)}const s={y:(this.nextRow+O+.5)/this.height,height:2*O/this.height,width:x};return this.nextRow+=V,this.dirty=!0,s}bind(A){const C=A.gl;this.texture?(C.bindTexture(C.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,C.texSubImage2D(C.TEXTURE_2D,0,0,0,this.width,this.height,C.ALPHA,C.UNSIGNED_BYTE,this.data))):(this.texture=C.createTexture(),C.bindTexture(C.TEXTURE_2D,this.texture),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,C.LINEAR),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,C.LINEAR),C.texImage2D(C.TEXTURE_2D,0,C.ALPHA,this.width,this.height,0,C.ALPHA,C.UNSIGNED_BYTE,this.data))}}class Ci{constructor(A,C,O){this.workerPool=A,this.actors=[],this.currentActor=0,this.id=O;const V=this.workerPool.acquire(O);for(let x=0;x<V.length;x++){const s=new a.C(V[x],C,O);s.name=`Worker ${x}`,this.actors.push(s)}if(!this.actors.length)throw new Error("No actors found")}broadcast(A,C,O){a.o(this.actors,(V,x)=>{V.send(A,C,x)},O=O||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(A=!0){this.actors.forEach(C=>{C.remove()}),this.actors=[],A&&this.workerPool.release(this.id)}}function ki(Q,A,C){const O=function(V,x){if(V)return C(V);if(x){const s=a.F(a.e(x,Q),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(s.vectorLayers=x.vector_layers,s.vectorLayerIds=s.vectorLayers.map(i=>i.id)),C(null,s)}};return Q.url?a.f(A.transformRequest(Q.url,st.Source),O):a.h.frame(()=>O(null,Q))}class Ni{constructor(A,C){A&&(C?this.setSouthWest(A).setNorthEast(C):Array.isArray(A)&&(A.length===4?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1])))}setNorthEast(A){return this._ne=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}setSouthWest(A){return this._sw=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}extend(A){const C=this._sw,O=this._ne;let V,x;if(A instanceof a.L)V=A,x=A;else{if(!(A instanceof Ni))return Array.isArray(A)?A.length===4||A.every(Array.isArray)?this.extend(Ni.convert(A)):this.extend(a.L.convert(A)):A&&("lng"in A||"lon"in A)&&"lat"in A?this.extend(a.L.convert(A)):this;if(V=A._sw,x=A._ne,!V||!x)return this}return C||O?(C.lng=Math.min(V.lng,C.lng),C.lat=Math.min(V.lat,C.lat),O.lng=Math.max(x.lng,O.lng),O.lat=Math.max(x.lat,O.lat)):(this._sw=new a.L(V.lng,V.lat),this._ne=new a.L(x.lng,x.lat)),this}getCenter(){return new a.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.L(this.getWest(),this.getNorth())}getSouthEast(){return new a.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(A){const{lng:C,lat:O}=a.L.convert(A);let V=this._sw.lng<=C&&C<=this._ne.lng;return this._sw.lng>this._ne.lng&&(V=this._sw.lng>=C&&C>=this._ne.lng),this._sw.lat<=O&&O<=this._ne.lat&&V}static convert(A){return A instanceof Ni?A:A&&new Ni(A)}static fromLngLat(A,C=0){const O=360*C/40075017,V=O/Math.cos(Math.PI/180*A.lat);return new Ni(new a.L(A.lng-V,A.lat-O),new a.L(A.lng+V,A.lat+O))}}class tn{constructor(A,C,O){this.bounds=Ni.convert(this.validateBounds(A)),this.minzoom=C||0,this.maxzoom=O||24}validateBounds(A){return Array.isArray(A)&&A.length===4?[Math.max(-180,A[0]),Math.max(-90,A[1]),Math.min(180,A[2]),Math.min(90,A[3])]:[-180,-90,180,90]}contains(A){const C=Math.pow(2,A.z),O=Math.floor(a.G(this.bounds.getWest())*C),V=Math.floor(a.H(this.bounds.getNorth())*C),x=Math.ceil(a.G(this.bounds.getEast())*C),s=Math.ceil(a.H(this.bounds.getSouth())*C);return A.x>=O&&A.x<x&&A.y>=V&&A.y<s}}class Zi extends a.E{constructor(A,C,O,V){if(super(),this.load=()=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ki(this._options,this.map._requestManager,(x,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),x?this.fire(new a.j(x)):s&&(a.e(this,s),s.bounds&&(this.tileBounds=new tn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>a.e({},this._options),this.id=A,this.dispatcher=O,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.F(C,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},C),this._collectResourceTiming=C.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(V)}loaded(){return this._loaded}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}onAdd(A){this.map=A,this.load()}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}setUrl(A){return this.setSourceProperty(()=>{this.url=A,this._options.url=A}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(A,C){const O=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),V={request:this.map._requestManager.transformRequest(O,st.Tile),uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,tileSize:this.tileSize*A.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function x(s,i){return delete A.request,A.aborted?C(null):s&&s.status!==404?C(s):(i&&i.resourceTiming&&(A.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&A.setExpiryData(i),A.loadVectorData(i,this.map.painter),C(null),void(A.reloadCallback&&(this.loadTile(A,A.reloadCallback),A.reloadCallback=null)))}V.request.collectResourceTiming=this._collectResourceTiming,A.actor&&A.state!=="expired"?A.state==="loading"?A.reloadCallback=C:A.request=A.actor.send("reloadTile",V,x.bind(this)):(A.actor=this.dispatcher.getActor(),A.request=A.actor.send("loadTile",V,x.bind(this)))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.actor&&A.actor.send("abortTile",{uid:A.uid,type:this.type,source:this.id},void 0)}unloadTile(A){A.unloadVectorData(),A.actor&&A.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Gi extends a.E{constructor(A,C,O,V){super(),this.id=A,this.dispatcher=O,this.setEventedParent(V),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},C),a.e(this,a.F(C,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ki(this._options,this.map._requestManager,(A,C)=>{this._tileJSONRequest=null,this._loaded=!0,A?this.fire(new a.j(A)):C&&(a.e(this,C),C.bounds&&(this.tileBounds=new tn(C.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(A){this.map=A,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}serialize(){return a.e({},this._options)}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}loadTile(A,C){const O=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);A.request=Ke.getImage(this.map._requestManager.transformRequest(O,st.Tile),(V,x,s)=>{if(delete A.request,A.aborted)A.state="unloaded",C(null);else if(V)A.state="errored",C(V);else if(x){this.map._refreshExpiredTiles&&s&&A.setExpiryData(s);const i=this.map.painter.context,r=i.gl;A.texture=this.map.painter.getTileTexture(x.width),A.texture?A.texture.update(x,{useMipmap:!0}):(A.texture=new At(i,x,r.RGBA,{useMipmap:!0}),A.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),A.state="loaded",C(null)}},this.map._refreshExpiredTiles)}abortTile(A,C){A.request&&(A.request.cancel(),delete A.request),C()}unloadTile(A,C){A.texture&&this.map.painter.saveTileTexture(A.texture),C()}hasTransition(){return!1}}class sn extends Gi{constructor(A,C,O,V){super(A,C,O,V),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},C),this.encoding=C.encoding||"mapbox",this.redFactor=C.redFactor,this.greenFactor=C.greenFactor,this.blueFactor=C.blueFactor,this.baseShift=C.baseShift}loadTile(A,C){const O=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),V=this.map._requestManager.transformRequest(O,st.Tile);function x(s,i){s&&(A.state="errored",C(s)),i&&(A.dem=i,A.needsHillshadePrepare=!0,A.needsTerrainPrepare=!0,A.state="loaded",C(null))}A.neighboringTiles=this._getNeighboringTiles(A.tileID),A.request=Ke.getImage(V,(s,i,r)=>a._(this,void 0,void 0,function*(){if(delete A.request,A.aborted)A.state="unloaded",C(null);else if(s)A.state="errored",C(s);else if(i){this.map._refreshExpiredTiles&&A.setExpiryData(r);const l=a.a(i)&&a.J()?i:yield function(y){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.K()){const I=y.width+2,k=y.height+2;try{return new a.R({width:I,height:k},yield a.M(y,-1,-1,I,k))}catch{}}return a.h.getImageData(y,1)})}(i),d={uid:A.uid,coord:A.tileID,source:this.id,rawImageData:l,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};A.actor&&A.state!=="expired"||(A.actor=this.dispatcher.getActor(),A.actor.send("loadDEMTile",d,x))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(A){const C=A.canonical,O=Math.pow(2,C.z),V=(C.x-1+O)%O,x=C.x===0?A.wrap-1:A.wrap,s=(C.x+1+O)%O,i=C.x+1===O?A.wrap+1:A.wrap,r={};return r[new a.O(A.overscaledZ,x,C.z,V,C.y).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,C.z,s,C.y).key]={backfilled:!1},C.y>0&&(r[new a.O(A.overscaledZ,x,C.z,V,C.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,C.z,C.x,C.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,C.z,s,C.y-1).key]={backfilled:!1}),C.y+1<O&&(r[new a.O(A.overscaledZ,x,C.z,V,C.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,C.z,C.x,C.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,C.z,s,C.y+1).key]={backfilled:!1}),r}unloadTile(A){A.demTexture&&this.map.painter.saveTileTexture(A.demTexture),A.fbo&&(A.fbo.destroy(),delete A.fbo),A.dem&&delete A.dem,delete A.neighboringTiles,A.state="unloaded",A.actor&&A.actor.send("removeDEMTile",{uid:A.uid,source:this.id})}}class xn extends a.E{constructor(A,C,O,V){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>a.e({},this._options,{type:this.type,data:this._data}),this.id=A,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=O.getActor(),this.setEventedParent(V),this._data=C.data,this._options=a.e({},C),this._collectResourceTiming=C.collectResourceTiming,C.maxzoom!==void 0&&(this.maxzoom=C.maxzoom),C.type&&(this.type=C.type),C.attribution&&(this.attribution=C.attribution),this.promoteId=C.promoteId;const x=a.N/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:C.cluster||!1,geojsonVtOptions:{buffer:(C.buffer!==void 0?C.buffer:128)*x,tolerance:(C.tolerance!==void 0?C.tolerance:.375)*x,extent:a.N,maxZoom:this.maxzoom,lineMetrics:C.lineMetrics||!1,generateId:C.generateId||!1},superclusterOptions:{maxZoom:C.clusterMaxZoom!==void 0?C.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,C.clusterMinPoints||2),extent:a.N,radius:(C.clusterRadius||50)*x,log:!1,generateId:C.generateId||!1},clusterProperties:C.clusterProperties,filter:C.filter},C.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(A){this.map=A,this.load()}setData(A){return this._data=A,this._updateWorkerData(),this}updateData(A){return this._updateWorkerData(A),this}setClusterOptions(A){return this.workerOptions.cluster=A.cluster,A&&(A.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=A.clusterRadius),A.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=A.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(A,C){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:A,source:this.id},C),this}getClusterChildren(A,C){return this.actor.send("geojson.getClusterChildren",{clusterId:A,source:this.id},C),this}getClusterLeaves(A,C,O,V){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:A,limit:C,offset:O},V),this}_updateWorkerData(A){const C=a.e({},this.workerOptions);A?C.dataDiff=A:typeof this._data=="string"?(C.request=this.map._requestManager.transformRequest(a.h.resolveURL(this._data),st.Source),C.request.collectResourceTiming=this._collectResourceTiming):C.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,C,(O,V)=>{if(this._pendingLoads--,this._removed||V&&V.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let x=null;if(V&&V.resourceTiming&&V.resourceTiming[this.id]&&(x=V.resourceTiming[this.id].slice(0)),O)return void this.fire(new a.j(O));const s={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&a.e(s,{resourceTiming:x}),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(A,C){const O=A.actor?"reloadTile":"loadTile";A.actor=this.actor;const V={type:this.type,uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};A.request=this.actor.send(O,V,(x,s)=>(delete A.request,A.unloadVectorData(),A.aborted?C(null):x?C(x):(A.loadVectorData(s,this.map.painter,O==="reloadTile"),C(null))))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.aborted=!0}unloadTile(A){A.unloadVectorData(),this.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Ti=a.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class gi extends a.E{constructor(A,C,O,V){super(),this.load=(x,s)=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Ke.getImage(this.map._requestManager.transformRequest(this.url,st.Image),(i,r)=>{this._request=null,this._loaded=!0,i?this.fire(new a.j(i)):r&&(this.image=r,x&&(this.coordinates=x),s&&s(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const x=this.map.painter.context,s=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,Ti.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new At(x,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=A,this.dispatcher=O,this.coordinates=C.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(V),this.options=C}loaded(){return this._loaded}updateImage(A){return A.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=A.url,this.load(A.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(A){this.map=A,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(A){this.coordinates=A;const C=A.map(a.U.fromLngLat);this.tileID=function(V){let x=1/0,s=1/0,i=-1/0,r=-1/0;for(const I of V)x=Math.min(x,I.x),s=Math.min(s,I.y),i=Math.max(i,I.x),r=Math.max(r,I.y);const l=Math.max(i-x,r-s),d=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),y=Math.pow(2,d);return new a.W(d,Math.floor((x+i)/2*y),Math.floor((s+r)/2*y))}(C),this.minzoom=this.maxzoom=this.tileID.z;const O=C.map(V=>this.tileID.getTilePoint(V)._round());return this._boundsArray=new a.V,this._boundsArray.emplaceBack(O[0].x,O[0].y,0,0),this._boundsArray.emplaceBack(O[1].x,O[1].y,a.N,0),this._boundsArray.emplaceBack(O[3].x,O[3].y,0,a.N),this._boundsArray.emplaceBack(O[2].x,O[2].y,a.N,a.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(A,C){this.tileID&&this.tileID.equals(A.tileID.canonical)?(this.tiles[String(A.tileID.wrap)]=A,A.buckets={},C(null)):(A.state="errored",C(null))}hasTransition(){return!1}}class Oi extends gi{constructor(A,C,O,V){super(A,C,O,V),this.load=()=>{this._loaded=!1;const x=this.options;this.urls=[];for(const s of x.urls)this.urls.push(this.map._requestManager.transformRequest(s,st.Source).url);a.X(this.urls,(s,i)=>{this._loaded=!0,s?this.fire(new a.j(s)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const x=this.map.painter.context,s=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,Ti.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new At(x,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=C}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(A){if(this.video){const C=this.video.seekable;A<C.start(0)||A>C.end(0)?this.fire(new a.j(new a.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${C.start(0)} and ${C.end(0)}-second mark.`))):this.video.currentTime=A}}getVideo(){return this.video}onAdd(A){this.map||(this.map=A,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Vi extends gi{constructor(A,C,O,V){super(A,C,O,V),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Ti.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?(x||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new At(s,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),C.coordinates?Array.isArray(C.coordinates)&&C.coordinates.length===4&&!C.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(s=>typeof s!="number"))||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "coordinates"'))),C.animate&&typeof C.animate!="boolean"&&this.fire(new a.j(new a.Y(`sources.${A}`,null,'optional "animate" property must be a boolean value'))),C.canvas?typeof C.canvas=="string"||C.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "canvas"'))),this.options=C,this.animate=C.animate===void 0||C.animate}getCanvas(){return this.canvas}onAdd(A){this.map=A,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const A of[this.canvas.width,this.canvas.height])if(isNaN(A)||A<=0)return!0;return!1}}const bn={},wn=Q=>{switch(Q){case"geojson":return xn;case"image":return gi;case"raster":return Gi;case"raster-dem":return sn;case"vector":return Zi;case"video":return Oi;case"canvas":return Vi}return bn[Q]};function xi(Q,A){const C=a.Z();return a.$(C,C,[1,1,0]),a.a0(C,C,[.5*Q.width,.5*Q.height,1]),a.a1(C,C,Q.calculatePosMatrix(A.toUnwrapped()))}function Bn(Q,A,C,O,V,x){const s=function(y,I,k){if(y)for(const z of y){const Z=I[z];if(Z&&Z.source===k&&Z.type==="fill-extrusion")return!0}else for(const z in I){const Z=I[z];if(Z.source===k&&Z.type==="fill-extrusion")return!0}return!1}(V&&V.layers,A,Q.id),i=x.maxPitchScaleFactor(),r=Q.tilesIn(O,i,s);r.sort(Ot);const l=[];for(const y of r)l.push({wrappedTileID:y.tileID.wrapped().key,queryResults:y.tile.queryRenderedFeatures(A,C,Q._state,y.queryGeometry,y.cameraQueryGeometry,y.scale,V,x,i,xi(Q.transform,y.tileID))});const d=function(y){const I={},k={};for(const z of y){const Z=z.queryResults,Y=z.wrappedTileID,Ae=k[Y]=k[Y]||{};for(const Ie in Z){const ke=Z[Ie],Fe=Ae[Ie]=Ae[Ie]||{},ze=I[Ie]=I[Ie]||[];for(const tt of ke)Fe[tt.featureIndex]||(Fe[tt.featureIndex]=!0,ze.push(tt))}}return I}(l);for(const y in d)d[y].forEach(I=>{const k=I.feature,z=Q.getFeatureState(k.layer["source-layer"],k.id);k.source=k.layer.source,k.layer["source-layer"]&&(k.sourceLayer=k.layer["source-layer"]),k.state=z});return d}function Ot(Q,A){const C=Q.tileID,O=A.tileID;return C.overscaledZ-O.overscaledZ||C.canonical.y-O.canonical.y||C.wrap-O.wrap||C.canonical.x-O.canonical.x}class an{constructor(A,C){this.timeAdded=0,this.fadeEndTime=0,this.tileID=A,this.uid=a.a2(),this.uses=0,this.tileSize=C,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(A){const C=A+this.timeAdded;C<this.fadeEndTime||(this.fadeEndTime=C)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(A){this.demTexture&&A.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(A,C,O){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(V,x){const s={};if(!x)return s;for(const i of V){const r=i.layerIds.map(l=>x.getLayer(l)).filter(Boolean);if(r.length!==0){i.layers=r,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(l=>r.filter(d=>d.id===l)[0]));for(const l of r)s[l.id]=i}}return s}(A.buckets,C.style),this.hasSymbolBuckets=!1;for(const V in this.buckets){const x=this.buckets[V];if(x instanceof a.a4){if(this.hasSymbolBuckets=!0,!O)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const V in this.buckets){const x=this.buckets[V];if(x instanceof a.a4&&x.hasRTLText){this.hasRTLText=!0,a.a5();break}}this.queryPadding=0;for(const V in this.buckets){const x=this.buckets[V];this.queryPadding=Math.max(this.queryPadding,C.style.getLayer(V).queryRadius(x))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new a.a3}unloadVectorData(){for(const A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(A){return this.buckets[A.id]}upload(A){for(const O in this.buckets){const V=this.buckets[O];V.uploadPending()&&V.upload(A)}const C=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new At(A,this.imageAtlas.image,C.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new At(A,this.glyphAtlasImage,C.ALPHA),this.glyphAtlasImage=null)}prepare(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)}queryRenderedFeatures(A,C,O,V,x,s,i,r,l,d){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:V,cameraQueryGeometry:x,scale:s,tileSize:this.tileSize,pixelPosMatrix:d,transform:r,params:i,queryPadding:this.queryPadding*l},A,C,O):{}}querySourceFeatures(A,C){const O=this.latestFeatureIndex;if(!O||!O.rawTileData)return;const V=O.loadVTLayers(),x=C&&C.sourceLayer?C.sourceLayer:"",s=V._geojsonTileLayer||V[x];if(!s)return;const i=a.a6(C&&C.filter),{z:r,x:l,y:d}=this.tileID.canonical,y={z:r,x:l,y:d};for(let I=0;I<s.length;I++){const k=s.feature(I);if(i.needGeometry){const Y=a.a7(k,!0);if(!i.filter(new a.a8(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!i.filter(new a.a8(this.tileID.overscaledZ),k))continue;const z=O.getId(k,x),Z=new a.a9(k,r,l,d,z);Z.tile=y,A.push(Z)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(A){const C=this.expirationTime;if(A.cacheControl){const O=a.aa(A.cacheControl);O["max-age"]&&(this.expirationTime=Date.now()+1e3*O["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){const O=Date.now();let V=!1;if(this.expirationTime>O)V=!1;else if(C)if(this.expirationTime<C)V=!0;else{const x=this.expirationTime-C;x?this.expirationTime=O+Math.max(x,3e4):V=!0}else V=!0;V?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(A,C){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(A).length===0)return;const O=this.latestFeatureIndex.loadVTLayers();for(const V in this.buckets){if(!C.style.hasLayer(V))continue;const x=this.buckets[V],s=x.layers[0].sourceLayer||"_geojsonTileLayer",i=O[s],r=A[s];if(!i||!r||Object.keys(r).length===0)continue;x.update(r,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=C&&C.style&&C.style.getLayer(V);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(A){this.symbolFadeHoldUntil=a.h.now()+A}setDependencies(A,C){const O={};for(const V of C)O[V]=!0;this.dependencies[A]=O}hasDependency(A,C){for(const O of A){const V=this.dependencies[O];if(V){for(const x of C)if(V[x])return!0}}return!1}}class $n{constructor(A,C){this.max=A,this.onRemove=C,this.reset()}reset(){for(const A in this.data)for(const C of this.data[A])C.timeout&&clearTimeout(C.timeout),this.onRemove(C.value);return this.data={},this.order=[],this}add(A,C,O){const V=A.wrapped().key;this.data[V]===void 0&&(this.data[V]=[]);const x={value:C,timeout:void 0};if(O!==void 0&&(x.timeout=setTimeout(()=>{this.remove(A,x)},O)),this.data[V].push(x),this.order.push(V),this.order.length>this.max){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}has(A){return A.wrapped().key in this.data}getAndRemove(A){return this.has(A)?this._getAndRemoveByKey(A.wrapped().key):null}_getAndRemoveByKey(A){const C=this.data[A].shift();return C.timeout&&clearTimeout(C.timeout),this.data[A].length===0&&delete this.data[A],this.order.splice(this.order.indexOf(A),1),C.value}getByKey(A){const C=this.data[A];return C?C[0].value:null}get(A){return this.has(A)?this.data[A.wrapped().key][0].value:null}remove(A,C){if(!this.has(A))return this;const O=A.wrapped().key,V=C===void 0?0:this.data[O].indexOf(C),x=this.data[O][V];return this.data[O].splice(V,1),x.timeout&&clearTimeout(x.timeout),this.data[O].length===0&&delete this.data[O],this.onRemove(x.value),this.order.splice(this.order.indexOf(O),1),this}setMaxSize(A){for(this.max=A;this.order.length>this.max;){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}filter(A){const C=[];for(const O in this.data)for(const V of this.data[O])A(V.value)||C.push(V);for(const O of C)this.remove(O.value.tileID,O)}}class oi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(A,C,O){const V=String(C);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][V]=this.stateChanges[A][V]||{},a.e(this.stateChanges[A][V],O),this.deletedStates[A]===null){this.deletedStates[A]={};for(const x in this.state[A])x!==V&&(this.deletedStates[A][x]=null)}else if(this.deletedStates[A]&&this.deletedStates[A][V]===null){this.deletedStates[A][V]={};for(const x in this.state[A][V])O[x]||(this.deletedStates[A][V][x]=null)}else for(const x in O)this.deletedStates[A]&&this.deletedStates[A][V]&&this.deletedStates[A][V][x]===null&&delete this.deletedStates[A][V][x]}removeFeatureState(A,C,O){if(this.deletedStates[A]===null)return;const V=String(C);if(this.deletedStates[A]=this.deletedStates[A]||{},O&&C!==void 0)this.deletedStates[A][V]!==null&&(this.deletedStates[A][V]=this.deletedStates[A][V]||{},this.deletedStates[A][V][O]=null);else if(C!==void 0)if(this.stateChanges[A]&&this.stateChanges[A][V])for(O in this.deletedStates[A][V]={},this.stateChanges[A][V])this.deletedStates[A][V][O]=null;else this.deletedStates[A][V]=null;else this.deletedStates[A]=null}getState(A,C){const O=String(C),V=a.e({},(this.state[A]||{})[O],(this.stateChanges[A]||{})[O]);if(this.deletedStates[A]===null)return{};if(this.deletedStates[A]){const x=this.deletedStates[A][C];if(x===null)return{};for(const s in x)delete V[s]}return V}initializeTileState(A,C){A.setFeatureState(this.state,C)}coalesceChanges(A,C){const O={};for(const V in this.stateChanges){this.state[V]=this.state[V]||{};const x={};for(const s in this.stateChanges[V])this.state[V][s]||(this.state[V][s]={}),a.e(this.state[V][s],this.stateChanges[V][s]),x[s]=this.state[V][s];O[V]=x}for(const V in this.deletedStates){this.state[V]=this.state[V]||{};const x={};if(this.deletedStates[V]===null)for(const s in this.state[V])x[s]={},this.state[V][s]={};else for(const s in this.deletedStates[V]){if(this.deletedStates[V][s]===null)this.state[V][s]={};else for(const i of Object.keys(this.deletedStates[V][s]))delete this.state[V][s][i];x[s]=this.state[V][s]}O[V]=O[V]||{},a.e(O[V],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(O).length!==0)for(const V in A)A[V].setFeatureState(O,C)}}class Yi extends a.E{constructor(A,C,O){super(),this.id=A,this.dispatcher=O,this.on("data",V=>{V.dataType==="source"&&V.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&V.dataType==="source"&&V.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((V,x,s,i)=>{const r=new(wn(x.type))(V,x,s,i);if(r.id!==V)throw new Error(`Expected Source id to be ${V} instead of ${r.id}`);return r})(A,C,O,this),this._tiles={},this._cache=new $n(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new oi,this._didEmitContent=!1,this._updated=!1}onAdd(A){this.map=A,this._maxTileCacheSize=A?A._maxTileCacheSize:null,this._maxTileCacheZoomLevels=A?A._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(A)}onRemove(A){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(A)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const A in this._tiles){const C=this._tiles[A];if(C.state!=="loaded"&&C.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const A=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,A&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(A,C){return this._source.loadTile(A,C)}_unloadTile(A){if(this._source.unloadTile)return this._source.unloadTile(A,()=>{})}_abortTile(A){this._source.abortTile&&this._source.abortTile(A,()=>{}),this._source.fire(new a.k("dataabort",{tile:A,coord:A.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(A){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const C in this._tiles){const O=this._tiles[C];O.upload(A),O.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(A=>A.tileID).sort(Xn).map(A=>A.key)}getRenderableIds(A){const C=[];for(const O in this._tiles)this._isIdRenderable(O,A)&&C.push(this._tiles[O]);return A?C.sort((O,V)=>{const x=O.tileID,s=V.tileID,i=new a.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),r=new a.P(s.canonical.x,s.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-s.overscaledZ||r.y-i.y||r.x-i.x}).map(O=>O.tileID.key):C.map(O=>O.tileID).sort(Xn).map(O=>O.key)}hasRenderableParent(A){const C=this.findLoadedParent(A,0);return!!C&&this._isIdRenderable(C.tileID.key)}_isIdRenderable(A,C){return this._tiles[A]&&this._tiles[A].hasData()&&!this._coveredTiles[A]&&(C||!this._tiles[A].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const A in this._tiles)this._tiles[A].state!=="errored"&&this._reloadTile(A,"reloading")}}_reloadTile(A,C){const O=this._tiles[A];O&&(O.state!=="loading"&&(O.state=C),this._loadTile(O,this._tileLoaded.bind(this,O,A,C)))}_tileLoaded(A,C,O,V){if(V)return A.state="errored",void(V.status!==404?this._source.fire(new a.j(V,{tile:A})):this.update(this.transform,this.terrain));A.timeAdded=a.h.now(),O==="expired"&&(A.refreshedUponExpiration=!0),this._setTileReloadTimer(C,A),this.getSource().type==="raster-dem"&&A.dem&&this._backfillDEM(A),this._state.initializeTileState(A,this.map?this.map.painter:null),A.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:A,coord:A.tileID}))}_backfillDEM(A){const C=this.getRenderableIds();for(let V=0;V<C.length;V++){const x=C[V];if(A.neighboringTiles&&A.neighboringTiles[x]){const s=this.getTileByID(x);O(A,s),O(s,A)}}function O(V,x){V.needsHillshadePrepare=!0,V.needsTerrainPrepare=!0;let s=x.tileID.canonical.x-V.tileID.canonical.x;const i=x.tileID.canonical.y-V.tileID.canonical.y,r=Math.pow(2,V.tileID.canonical.z),l=x.tileID.key;s===0&&i===0||Math.abs(i)>1||(Math.abs(s)>1&&(Math.abs(s+r)===1?s+=r:Math.abs(s-r)===1&&(s-=r)),x.dem&&V.dem&&(V.dem.backfillBorder(x.dem,s,i),V.neighboringTiles&&V.neighboringTiles[l]&&(V.neighboringTiles[l].backfilled=!0)))}}getTile(A){return this.getTileByID(A.key)}getTileByID(A){return this._tiles[A]}_retainLoadedChildren(A,C,O,V){for(const x in this._tiles){let s=this._tiles[x];if(V[x]||!s.hasData()||s.tileID.overscaledZ<=C||s.tileID.overscaledZ>O)continue;let i=s.tileID;for(;s&&s.tileID.overscaledZ>C+1;){const l=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[l.key],s&&s.hasData()&&(i=l)}let r=i;for(;r.overscaledZ>C;)if(r=r.scaledTo(r.overscaledZ-1),A[r.key]){V[i.key]=i;break}}}findLoadedParent(A,C){if(A.key in this._loadedParentTiles){const O=this._loadedParentTiles[A.key];return O&&O.tileID.overscaledZ>=C?O:null}for(let O=A.overscaledZ-1;O>=C;O--){const V=A.scaledTo(O),x=this._getLoadedTile(V);if(x)return x}}_getLoadedTile(A){const C=this._tiles[A.key];return C&&C.hasData()?C:this._cache.getByKey(A.wrapped().key)}updateCacheSize(A){const C=Math.ceil(A.width/this._source.tileSize)+1,O=Math.ceil(A.height/this._source.tileSize)+1,V=Math.floor(C*O*(this._maxTileCacheZoomLevels===null?a.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,V):V;this._cache.setMaxSize(x)}handleWrapJump(A){const C=Math.round((A-(this._prevLng===void 0?A:this._prevLng))/360);if(this._prevLng=A,C){const O={};for(const V in this._tiles){const x=this._tiles[V];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+C),O[x.tileID.key]=x}this._tiles=O;for(const V in this._timers)clearTimeout(this._timers[V]),delete this._timers[V];for(const V in this._tiles)this._setTileReloadTimer(V,this._tiles[V])}}update(A,C){if(this.transform=A,this.terrain=C,!this._sourceLoaded||this._paused)return;let O;this.updateCacheSize(A),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?O=A.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new a.O(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(O=A.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:C}),this._source.hasTile&&(O=O.filter(d=>this._source.hasTile(d)))):O=[];const V=A.coveringZoomLevel(this._source),x=Math.max(V-Yi.maxOverzooming,this._source.minzoom),s=Math.max(V+Yi.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const d={};for(const y of O)if(y.canonical.z>this._source.minzoom){const I=y.scaledTo(y.canonical.z-1);d[I.key]=I;const k=y.scaledTo(Math.max(this._source.minzoom,Math.min(y.canonical.z,5)));d[k.key]=k}O=O.concat(Object.values(d))}const i=O.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,i&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const r=this._updateRetainedTiles(O,V);if(zn(this._source.type)){const d={},y={},I=Object.keys(r),k=a.h.now();for(const z of I){const Z=r[z],Y=this._tiles[z];if(!Y||Y.fadeEndTime!==0&&Y.fadeEndTime<=k)continue;const Ae=this.findLoadedParent(Z,x);Ae&&(this._addTile(Ae.tileID),d[Ae.tileID.key]=Ae.tileID),y[z]=Z}this._retainLoadedChildren(y,V,s,r);for(const z in d)r[z]||(this._coveredTiles[z]=!0,r[z]=d[z]);if(C){const z={},Z={};for(const Y of O)this._tiles[Y.key].hasData()?z[Y.key]=Y:Z[Y.key]=Y;for(const Y in Z){const Ae=Z[Y].children(this._source.maxzoom);this._tiles[Ae[0].key]&&this._tiles[Ae[1].key]&&this._tiles[Ae[2].key]&&this._tiles[Ae[3].key]&&(z[Ae[0].key]=r[Ae[0].key]=Ae[0],z[Ae[1].key]=r[Ae[1].key]=Ae[1],z[Ae[2].key]=r[Ae[2].key]=Ae[2],z[Ae[3].key]=r[Ae[3].key]=Ae[3],delete Z[Y])}for(const Y in Z){const Ae=this.findLoadedParent(Z[Y],this._source.minzoom);if(Ae){z[Ae.tileID.key]=r[Ae.tileID.key]=Ae.tileID;for(const Ie in z)z[Ie].isChildOf(Ae.tileID)&&delete z[Ie]}}for(const Y in this._tiles)z[Y]||(this._coveredTiles[Y]=!0)}}for(const d in r)this._tiles[d].clearFadeHold();const l=a.ab(this._tiles,r);for(const d of l){const y=this._tiles[d];y.hasSymbolBuckets&&!y.holdingForFade()?y.setHoldDuration(this.map._fadeDuration):y.hasSymbolBuckets&&!y.symbolFadeFinished()||this._removeTile(d)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const A in this._tiles)this._tiles[A].holdingForFade()&&this._removeTile(A)}_updateRetainedTiles(A,C){const O={},V={},x=Math.max(C-Yi.maxOverzooming,this._source.minzoom),s=Math.max(C+Yi.maxUnderzooming,this._source.minzoom),i={};for(const r of A){const l=this._addTile(r);O[r.key]=r,l.hasData()||C<this._source.maxzoom&&(i[r.key]=r)}this._retainLoadedChildren(i,C,s,O);for(const r of A){let l=this._tiles[r.key];if(l.hasData())continue;if(C+1>this._source.maxzoom){const y=r.children(this._source.maxzoom)[0],I=this.getTile(y);if(I&&I.hasData()){O[y.key]=y;continue}}else{const y=r.children(this._source.maxzoom);if(O[y[0].key]&&O[y[1].key]&&O[y[2].key]&&O[y[3].key])continue}let d=l.wasRequested();for(let y=r.overscaledZ-1;y>=x;--y){const I=r.scaledTo(y);if(V[I.key])break;if(V[I.key]=!0,l=this.getTile(I),!l&&d&&(l=this._addTile(I)),l){const k=l.hasData();if((d||k)&&(O[I.key]=I),d=l.wasRequested(),k)break}}}return O}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const A in this._tiles){const C=[];let O,V=this._tiles[A].tileID;for(;V.overscaledZ>0;){if(V.key in this._loadedParentTiles){O=this._loadedParentTiles[V.key];break}C.push(V.key);const x=V.scaledTo(V.overscaledZ-1);if(O=this._getLoadedTile(x),O)break;V=x}for(const x of C)this._loadedParentTiles[x]=O}}_addTile(A){let C=this._tiles[A.key];if(C)return C;C=this._cache.getAndRemove(A),C&&(this._setTileReloadTimer(A.key,C),C.tileID=A,this._state.initializeTileState(C,this.map?this.map.painter:null),this._cacheTimers[A.key]&&(clearTimeout(this._cacheTimers[A.key]),delete this._cacheTimers[A.key],this._setTileReloadTimer(A.key,C)));const O=C;return C||(C=new an(A,this._source.tileSize*A.overscaleFactor()),this._loadTile(C,this._tileLoaded.bind(this,C,A.key,C.state))),C.uses++,this._tiles[A.key]=C,O||this._source.fire(new a.k("dataloading",{tile:C,coord:C.tileID,dataType:"source"})),C}_setTileReloadTimer(A,C){A in this._timers&&(clearTimeout(this._timers[A]),delete this._timers[A]);const O=C.getExpiryTimeout();O&&(this._timers[A]=setTimeout(()=>{this._reloadTile(A,"expired"),delete this._timers[A]},O))}_removeTile(A){const C=this._tiles[A];C&&(C.uses--,delete this._tiles[A],this._timers[A]&&(clearTimeout(this._timers[A]),delete this._timers[A]),C.uses>0||(C.hasData()&&C.state!=="reloading"?this._cache.add(C.tileID,C,C.getExpiryTimeout()):(C.aborted=!0,this._abortTile(C),this._unloadTile(C))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const A in this._tiles)this._removeTile(A);this._cache.reset()}tilesIn(A,C,O){const V=[],x=this.transform;if(!x)return V;const s=O?x.getCameraQueryGeometry(A):A,i=A.map(z=>x.pointCoordinate(z,this.terrain)),r=s.map(z=>x.pointCoordinate(z,this.terrain)),l=this.getIds();let d=1/0,y=1/0,I=-1/0,k=-1/0;for(const z of r)d=Math.min(d,z.x),y=Math.min(y,z.y),I=Math.max(I,z.x),k=Math.max(k,z.y);for(let z=0;z<l.length;z++){const Z=this._tiles[l[z]];if(Z.holdingForFade())continue;const Y=Z.tileID,Ae=Math.pow(2,x.zoom-Z.tileID.overscaledZ),Ie=C*Z.queryPadding*a.N/Z.tileSize/Ae,ke=[Y.getTilePoint(new a.U(d,y)),Y.getTilePoint(new a.U(I,k))];if(ke[0].x-Ie<a.N&&ke[0].y-Ie<a.N&&ke[1].x+Ie>=0&&ke[1].y+Ie>=0){const Fe=i.map(tt=>Y.getTilePoint(tt)),ze=r.map(tt=>Y.getTilePoint(tt));V.push({tile:Z,tileID:Y,queryGeometry:Fe,cameraQueryGeometry:ze,scale:Ae})}}return V}getVisibleCoordinates(A){const C=this.getRenderableIds(A).map(O=>this._tiles[O].tileID);for(const O of C)O.posMatrix=this.transform.calculatePosMatrix(O.toUnwrapped());return C}hasTransition(){if(this._source.hasTransition())return!0;if(zn(this._source.type)){const A=a.h.now();for(const C in this._tiles)if(this._tiles[C].fadeEndTime>=A)return!0}return!1}setFeatureState(A,C,O){this._state.updateState(A=A||"_geojsonTileLayer",C,O)}removeFeatureState(A,C,O){this._state.removeFeatureState(A=A||"_geojsonTileLayer",C,O)}getFeatureState(A,C){return this._state.getState(A=A||"_geojsonTileLayer",C)}setDependencies(A,C,O){const V=this._tiles[A];V&&V.setDependencies(C,O)}reloadTilesForDependencies(A,C){for(const O in this._tiles)this._tiles[O].hasDependency(A,C)&&this._reloadTile(O,"reloading");this._cache.filter(O=>!O.hasDependency(A,C))}}function Xn(Q,A){const C=Math.abs(2*Q.wrap)-+(Q.wrap<0),O=Math.abs(2*A.wrap)-+(A.wrap<0);return Q.overscaledZ-A.overscaledZ||O-C||A.canonical.y-Q.canonical.y||A.canonical.x-Q.canonical.x}function zn(Q){return Q==="raster"||Q==="image"||Q==="video"}Yi.maxOverzooming=10,Yi.maxUnderzooming=3;const Wn="mapboxgl_preloaded_worker_pool";class _n{constructor(){this.active={}}acquire(A){if(!this.workers)for(this.workers=[];this.workers.length<_n.workerCount;)this.workers.push(new Worker(a.c.WORKER_URL));return this.active[A]=!0,this.workers.slice()}release(A){delete this.active[A],this.numActive()===0&&(this.workers.forEach(C=>{C.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Wn]}numActive(){return Object.keys(this.active).length}}const b=Math.floor(a.h.hardwareConcurrency/2);let M;function U(){return M||(M=new _n),M}_n.workerCount=a.ac(globalThis)?Math.max(Math.min(b,3),1):1;class K{constructor(A,C){this.reset(A,C)}reset(A,C){this.points=A||[],this._distances=[0];for(let O=1;O<this.points.length;O++)this._distances[O]=this._distances[O-1]+this.points[O].dist(this.points[O-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(C||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(A){if(this.points.length===1)return this.points[0];A=a.ad(A,0,1);let C=1,O=this._distances[C];const V=A*this.paddedLength+this.padding;for(;O<V&&C<this._distances.length;)O=this._distances[++C];const x=C-1,s=this._distances[x],i=O-s,r=i>0?(V-s)/i:0;return this.points[x].mult(1-r).add(this.points[C].mult(r))}}function ie(Q,A){let C=!0;return Q==="always"||Q!=="never"&&A!=="never"||(C=!1),C}class de{constructor(A,C,O){const V=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(A/O),this.yCellCount=Math.ceil(C/O);for(let s=0;s<this.xCellCount*this.yCellCount;s++)V.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=A,this.height=C,this.xScale=this.xCellCount/A,this.yScale=this.yCellCount/C,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(A,C,O,V,x){this._forEachCell(C,O,V,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(A),this.bboxes.push(C),this.bboxes.push(O),this.bboxes.push(V),this.bboxes.push(x)}insertCircle(A,C,O,V){this._forEachCell(C-V,O-V,C+V,O+V,this._insertCircleCell,this.circleUid++),this.circleKeys.push(A),this.circles.push(C),this.circles.push(O),this.circles.push(V)}_insertBoxCell(A,C,O,V,x,s){this.boxCells[x].push(s)}_insertCircleCell(A,C,O,V,x,s){this.circleCells[x].push(s)}_query(A,C,O,V,x,s,i){if(O<0||A>this.width||V<0||C>this.height)return[];const r=[];if(A<=0&&C<=0&&this.width<=O&&this.height<=V){if(x)return[{key:null,x1:A,y1:C,x2:O,y2:V}];for(let l=0;l<this.boxKeys.length;l++)r.push({key:this.boxKeys[l],x1:this.bboxes[4*l],y1:this.bboxes[4*l+1],x2:this.bboxes[4*l+2],y2:this.bboxes[4*l+3]});for(let l=0;l<this.circleKeys.length;l++){const d=this.circles[3*l],y=this.circles[3*l+1],I=this.circles[3*l+2];r.push({key:this.circleKeys[l],x1:d-I,y1:y-I,x2:d+I,y2:y+I})}}else this._forEachCell(A,C,O,V,this._queryCell,r,{hitTest:x,overlapMode:s,seenUids:{box:{},circle:{}}},i);return r}query(A,C,O,V){return this._query(A,C,O,V,!1,null)}hitTest(A,C,O,V,x,s){return this._query(A,C,O,V,!0,x,s).length>0}hitTestCircle(A,C,O,V,x){const s=A-O,i=A+O,r=C-O,l=C+O;if(i<0||s>this.width||l<0||r>this.height)return!1;const d=[];return this._forEachCell(s,r,i,l,this._queryCellCircle,d,{hitTest:!0,overlapMode:V,circle:{x:A,y:C,radius:O},seenUids:{box:{},circle:{}}},x),d.length>0}_queryCell(A,C,O,V,x,s,i,r){const{seenUids:l,hitTest:d,overlapMode:y}=i,I=this.boxCells[x];if(I!==null){const z=this.bboxes;for(const Z of I)if(!l.box[Z]){l.box[Z]=!0;const Y=4*Z,Ae=this.boxKeys[Z];if(A<=z[Y+2]&&C<=z[Y+3]&&O>=z[Y+0]&&V>=z[Y+1]&&(!r||r(Ae))&&(!d||!ie(y,Ae.overlapMode))&&(s.push({key:Ae,x1:z[Y],y1:z[Y+1],x2:z[Y+2],y2:z[Y+3]}),d))return!0}}const k=this.circleCells[x];if(k!==null){const z=this.circles;for(const Z of k)if(!l.circle[Z]){l.circle[Z]=!0;const Y=3*Z,Ae=this.circleKeys[Z];if(this._circleAndRectCollide(z[Y],z[Y+1],z[Y+2],A,C,O,V)&&(!r||r(Ae))&&(!d||!ie(y,Ae.overlapMode))){const Ie=z[Y],ke=z[Y+1],Fe=z[Y+2];if(s.push({key:Ae,x1:Ie-Fe,y1:ke-Fe,x2:Ie+Fe,y2:ke+Fe}),d)return!0}}}return!1}_queryCellCircle(A,C,O,V,x,s,i,r){const{circle:l,seenUids:d,overlapMode:y}=i,I=this.boxCells[x];if(I!==null){const z=this.bboxes;for(const Z of I)if(!d.box[Z]){d.box[Z]=!0;const Y=4*Z,Ae=this.boxKeys[Z];if(this._circleAndRectCollide(l.x,l.y,l.radius,z[Y+0],z[Y+1],z[Y+2],z[Y+3])&&(!r||r(Ae))&&!ie(y,Ae.overlapMode))return s.push(!0),!0}}const k=this.circleCells[x];if(k!==null){const z=this.circles;for(const Z of k)if(!d.circle[Z]){d.circle[Z]=!0;const Y=3*Z,Ae=this.circleKeys[Z];if(this._circlesCollide(z[Y],z[Y+1],z[Y+2],l.x,l.y,l.radius)&&(!r||r(Ae))&&!ie(y,Ae.overlapMode))return s.push(!0),!0}}}_forEachCell(A,C,O,V,x,s,i,r){const l=this._convertToXCellCoord(A),d=this._convertToYCellCoord(C),y=this._convertToXCellCoord(O),I=this._convertToYCellCoord(V);for(let k=l;k<=y;k++)for(let z=d;z<=I;z++)if(x.call(this,A,C,O,V,this.xCellCount*z+k,s,i,r))return}_convertToXCellCoord(A){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(A*this.xScale)))}_convertToYCellCoord(A){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(A*this.yScale)))}_circlesCollide(A,C,O,V,x,s){const i=V-A,r=x-C,l=O+s;return l*l>i*i+r*r}_circleAndRectCollide(A,C,O,V,x,s,i){const r=(s-V)/2,l=Math.abs(A-(V+r));if(l>r+O)return!1;const d=(i-x)/2,y=Math.abs(C-(x+d));if(y>d+O)return!1;if(l<=r||y<=d)return!0;const I=l-r,k=y-d;return I*I+k*k<=O*O}}function be(Q,A,C,O,V){const x=a.Z();return A?(a.a0(x,x,[1/V,1/V,1]),C||a.ae(x,x,O.angle)):a.a1(x,O.labelPlaneMatrix,Q),x}function Ee(Q,A,C,O,V){if(A){const x=a.af(Q);return a.a0(x,x,[V,V,1]),C||a.ae(x,x,-O.angle),x}return O.glCoordMatrix}function Ce(Q,A,C){let O;C?(O=[Q.x,Q.y,C(Q.x,Q.y),1],a.ag(O,O,A)):(O=[Q.x,Q.y,0,1],xe(O,O,A));const V=O[3];return{point:new a.P(O[0]/V,O[1]/V),signedDistanceFromCamera:V}}function Re(Q,A){return .5+Q/A*.5}function $e(Q,A){const C=Q[0]/Q[3],O=Q[1]/Q[3];return C>=-A[0]&&C<=A[0]&&O>=-A[1]&&O<=A[1]}function je(Q,A,C,O,V,x,s,i,r,l){const d=O?Q.textSizeData:Q.iconSizeData,y=a.ah(d,C.transform.zoom),I=[256/C.width*2+1,256/C.height*2+1],k=O?Q.text.dynamicLayoutVertexArray:Q.icon.dynamicLayoutVertexArray;k.clear();const z=Q.lineVertexArray,Z=O?Q.text.placedSymbolArray:Q.icon.placedSymbolArray,Y=C.transform.width/C.transform.height;let Ae=!1;for(let Ie=0;Ie<Z.length;Ie++){const ke=Z.get(Ie);if(ke.hidden||ke.writingMode===a.ai.vertical&&!Ae){pe(ke.numGlyphs,k);continue}let Fe;if(Ae=!1,l?(Fe=[ke.anchorX,ke.anchorY,l(ke.anchorX,ke.anchorY),1],a.ag(Fe,Fe,A)):(Fe=[ke.anchorX,ke.anchorY,0,1],xe(Fe,Fe,A)),!$e(Fe,I)){pe(ke.numGlyphs,k);continue}const ze=Re(C.transform.cameraToCenterDistance,Fe[3]),tt=a.aj(d,y,ke),wt=s?tt/ze:tt*ze,lt=new a.P(ke.anchorX,ke.anchorY),ft=Ce(lt,V,l).point,Tt={projections:{},offsets:{}},It=mt(ke,wt,!1,i,A,V,x,Q.glyphOffsetArray,z,k,ft,lt,Tt,Y,r,l);Ae=It.useVertical,(It.notEnoughRoom||Ae||It.needsFlipping&&mt(ke,wt,!0,i,A,V,x,Q.glyphOffsetArray,z,k,ft,lt,Tt,Y,r,l).notEnoughRoom)&&pe(ke.numGlyphs,k)}O?Q.text.dynamicLayoutVertexBuffer.updateData(k):Q.icon.dynamicLayoutVertexBuffer.updateData(k)}function We(Q,A,C,O,V,x,s,i,r,l,d,y,I){const k=i.glyphStartIndex+i.numGlyphs,z=i.lineStartIndex,Z=i.lineStartIndex+i.lineLength,Y=A.getoffsetX(i.glyphStartIndex),Ae=A.getoffsetX(k-1),Ie=X(Q*Y,C,O,V,x,s,i.segment,z,Z,r,l,d,y,I);if(!Ie)return null;const ke=X(Q*Ae,C,O,V,x,s,i.segment,z,Z,r,l,d,y,I);return ke?{first:Ie,last:ke}:null}function Ge(Q,A,C,O){return Q===a.ai.horizontal&&Math.abs(C.y-A.y)>Math.abs(C.x-A.x)*O?{useVertical:!0}:(Q===a.ai.vertical?A.y<C.y:A.x>C.x)?{needsFlipping:!0}:null}function mt(Q,A,C,O,V,x,s,i,r,l,d,y,I,k,z,Z){const Y=A/24,Ae=Q.lineOffsetX*Y,Ie=Q.lineOffsetY*Y;let ke;if(Q.numGlyphs>1){const Fe=Q.glyphStartIndex+Q.numGlyphs,ze=Q.lineStartIndex,tt=Q.lineStartIndex+Q.lineLength,wt=We(Y,i,Ae,Ie,C,d,y,Q,r,x,I,z,Z);if(!wt)return{notEnoughRoom:!0};const lt=Ce(wt.first.point,s,Z).point,ft=Ce(wt.last.point,s,Z).point;if(O&&!C){const Tt=Ge(Q.writingMode,lt,ft,k);if(Tt)return Tt}ke=[wt.first];for(let Tt=Q.glyphStartIndex+1;Tt<Fe-1;Tt++)ke.push(X(Y*i.getoffsetX(Tt),Ae,Ie,C,d,y,Q.segment,ze,tt,r,x,I,z,Z));ke.push(wt.last)}else{if(O&&!C){const ze=Ce(y,V,Z).point,tt=Q.lineStartIndex+Q.segment+1,wt=new a.P(r.getx(tt),r.gety(tt)),lt=Ce(wt,V,Z),ft=lt.signedDistanceFromCamera>0?lt.point:ot(y,wt,ze,1,V,Z),Tt=Ge(Q.writingMode,ze,ft,k);if(Tt)return Tt}const Fe=X(Y*i.getoffsetX(Q.glyphStartIndex),Ae,Ie,C,d,y,Q.segment,Q.lineStartIndex,Q.lineStartIndex+Q.lineLength,r,x,I,z,Z);if(!Fe)return{notEnoughRoom:!0};ke=[Fe]}for(const Fe of ke)a.ak(l,Fe.point,Fe.angle);return{}}function ot(Q,A,C,O,V,x){const s=Ce(Q.add(Q.sub(A)._unit()),V,x).point,i=C.sub(s);return C.add(i._mult(O/i.mag()))}function Pe(Q,A){const{projectionCache:C,lineVertexArray:O,labelPlaneMatrix:V,tileAnchorPoint:x,distanceFromAnchor:s,getElevation:i,previousVertex:r,direction:l,absOffsetX:d}=A;if(C.projections[Q])return C.projections[Q];const y=new a.P(O.getx(Q),O.gety(Q)),I=Ce(y,V,i);if(I.signedDistanceFromCamera>0)return C.projections[Q]=I.point,I.point;const k=Q-l;return ot(s===0?x:new a.P(O.getx(k),O.gety(k)),y,r,d-s+1,V,i)}function ae(Q,A,C){return Q._unit()._perp()._mult(A*C)}function re(Q,A,C,O,V,x,s,i){const{projectionCache:r,direction:l}=i;if(r.offsets[Q])return r.offsets[Q];const d=C.add(A);if(Q+l<O||Q+l>=V)return r.offsets[Q]=d,d;const y=Pe(Q+l,i),I=ae(y.sub(C),s,l),k=C.add(I),z=y.add(I);return r.offsets[Q]=a.al(x,d,k,z)||d,r.offsets[Q]}function X(Q,A,C,O,V,x,s,i,r,l,d,y,I,k){const z=O?Q-A:Q+A;let Z=z>0?1:-1,Y=0;O&&(Z*=-1,Y=Math.PI),Z<0&&(Y+=Math.PI);let Ae,Ie,ke=Z>0?i+s:i+s+1,Fe=V,ze=V,tt=0,wt=0;const lt=Math.abs(z),ft=[];let Tt;for(;tt+wt<=lt;){if(ke+=Z,ke<i||ke>=r)return null;tt+=wt,ze=Fe,Ie=Ae;const Kt={projectionCache:y,lineVertexArray:l,labelPlaneMatrix:d,tileAnchorPoint:x,distanceFromAnchor:tt,getElevation:k,previousVertex:ze,direction:Z,absOffsetX:lt};if(Fe=Pe(ke,Kt),C===0)ft.push(ze),Tt=Fe.sub(ze);else{let ii;const ai=Fe.sub(ze);ii=ai.mag()===0?ae(Pe(ke+Z,Kt).sub(Fe),C,Z):ae(ai,C,Z),Ie||(Ie=ze.add(ii)),Ae=re(ke,ii,Fe,i,r,Ie,C,Kt),ft.push(Ie),Tt=Ae.sub(Ie)}wt=Tt.mag()}const It=Tt._mult((lt-tt)/wt)._add(Ie||ze),si=Y+Math.atan2(Fe.y-ze.y,Fe.x-ze.x);return ft.push(It),{point:It,angle:I?si:0,path:ft}}const ne=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function pe(Q,A){for(let C=0;C<Q;C++){const O=A.length;A.resize(O+4),A.float32.set(ne,3*O)}}function xe(Q,A,C){const O=A[0],V=A[1];return Q[0]=C[0]*O+C[4]*V+C[12],Q[1]=C[1]*O+C[5]*V+C[13],Q[3]=C[3]*O+C[7]*V+C[15],Q}const ye=100;class De{constructor(A,C=new de(A.width+200,A.height+200,25),O=new de(A.width+200,A.height+200,25)){this.transform=A,this.grid=C,this.ignoredGrid=O,this.pitchfactor=Math.cos(A._pitch)*A.cameraToCenterDistance,this.screenRightBoundary=A.width+ye,this.screenBottomBoundary=A.height+ye,this.gridRightBoundary=A.width+200,this.gridBottomBoundary=A.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(A,C,O,V,x,s){const i=this.projectAndGetPerspectiveRatio(V,A.anchorPointX,A.anchorPointY,s),r=O*i.perspectiveRatio,l=A.x1*r+i.point.x,d=A.y1*r+i.point.y,y=A.x2*r+i.point.x,I=A.y2*r+i.point.y;return!this.isInsideGrid(l,d,y,I)||C!=="always"&&this.grid.hitTest(l,d,y,I,C,x)||i.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,d,y,I],offscreen:this.isOffscreen(l,d,y,I)}}placeCollisionCircles(A,C,O,V,x,s,i,r,l,d,y,I,k,z){const Z=[],Y=new a.P(C.anchorX,C.anchorY),Ae=Ce(Y,s,z),Ie=Re(this.transform.cameraToCenterDistance,Ae.signedDistanceFromCamera),ke=(d?x/Ie:x*Ie)/a.ap,Fe=Ce(Y,i,z).point,ze=We(ke,V,C.lineOffsetX*ke,C.lineOffsetY*ke,!1,Fe,Y,C,O,i,{projections:{},offsets:{}},!1,z);let tt=!1,wt=!1,lt=!0;if(ze){const ft=.5*I*Ie+k,Tt=new a.P(-100,-100),It=new a.P(this.screenRightBoundary,this.screenBottomBoundary),si=new K,Kt=ze.first,ii=ze.last;let ai=[];for(let Ei=Kt.path.length-1;Ei>=1;Ei--)ai.push(Kt.path[Ei]);for(let Ei=1;Ei<ii.path.length;Ei++)ai.push(ii.path[Ei]);const Wi=2.5*ft;if(r){const Ei=ai.map(Hi=>Ce(Hi,r,z));ai=Ei.some(Hi=>Hi.signedDistanceFromCamera<=0)?[]:Ei.map(Hi=>Hi.point)}let $i=[];if(ai.length>0){const Ei=ai[0].clone(),Hi=ai[0].clone();for(let ji=1;ji<ai.length;ji++)Ei.x=Math.min(Ei.x,ai[ji].x),Ei.y=Math.min(Ei.y,ai[ji].y),Hi.x=Math.max(Hi.x,ai[ji].x),Hi.y=Math.max(Hi.y,ai[ji].y);$i=Ei.x>=Tt.x&&Hi.x<=It.x&&Ei.y>=Tt.y&&Hi.y<=It.y?[ai]:Hi.x<Tt.x||Ei.x>It.x||Hi.y<Tt.y||Ei.y>It.y?[]:a.am([ai],Tt.x,Tt.y,It.x,It.y)}for(const Ei of $i){si.reset(Ei,.25*ft);let Hi=0;Hi=si.length<=.5*ft?1:Math.ceil(si.paddedLength/Wi)+1;for(let ji=0;ji<Hi;ji++){const cn=ji/Math.max(Hi-1,1),Nn=si.lerp(cn),nn=Nn.x+ye,Mn=Nn.y+ye;Z.push(nn,Mn,ft,0);const wr=nn-ft,nr=Mn-ft,Pa=nn+ft,_a=Mn+ft;if(lt=lt&&this.isOffscreen(wr,nr,Pa,_a),wt=wt||this.isInsideGrid(wr,nr,Pa,_a),A!=="always"&&this.grid.hitTestCircle(nn,Mn,ft,A,y)&&(tt=!0,!l))return{circles:[],offscreen:!1,collisionDetected:tt}}}}return{circles:!l&&tt||!wt||Ie<this.perspectiveRatioCutoff?[]:Z,offscreen:lt,collisionDetected:tt}}queryRenderedSymbols(A){if(A.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const C=[];let O=1/0,V=1/0,x=-1/0,s=-1/0;for(const d of A){const y=new a.P(d.x+ye,d.y+ye);O=Math.min(O,y.x),V=Math.min(V,y.y),x=Math.max(x,y.x),s=Math.max(s,y.y),C.push(y)}const i=this.grid.query(O,V,x,s).concat(this.ignoredGrid.query(O,V,x,s)),r={},l={};for(const d of i){const y=d.key;if(r[y.bucketInstanceId]===void 0&&(r[y.bucketInstanceId]={}),r[y.bucketInstanceId][y.featureIndex])continue;const I=[new a.P(d.x1,d.y1),new a.P(d.x2,d.y1),new a.P(d.x2,d.y2),new a.P(d.x1,d.y2)];a.an(C,I)&&(r[y.bucketInstanceId][y.featureIndex]=!0,l[y.bucketInstanceId]===void 0&&(l[y.bucketInstanceId]=[]),l[y.bucketInstanceId].push(y.featureIndex))}return l}insertCollisionBox(A,C,O,V,x,s){(O?this.ignoredGrid:this.grid).insert({bucketInstanceId:V,featureIndex:x,collisionGroupID:s,overlapMode:C},A[0],A[1],A[2],A[3])}insertCollisionCircles(A,C,O,V,x,s){const i=O?this.ignoredGrid:this.grid,r={bucketInstanceId:V,featureIndex:x,collisionGroupID:s,overlapMode:C};for(let l=0;l<A.length;l+=4)i.insertCircle(r,A[l],A[l+1],A[l+2])}projectAndGetPerspectiveRatio(A,C,O,V){let x;return V?(x=[C,O,V(C,O),1],a.ag(x,x,A)):(x=[C,O,0,1],xe(x,x,A)),{point:new a.P((x[0]/x[3]+1)/2*this.transform.width+ye,(-x[1]/x[3]+1)/2*this.transform.height+ye),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}}isOffscreen(A,C,O,V){return O<ye||A>=this.screenRightBoundary||V<ye||C>this.screenBottomBoundary}isInsideGrid(A,C,O,V){return O>=0&&A<this.gridRightBoundary&&V>=0&&C<this.gridBottomBoundary}getViewportMatrix(){const A=a.ao([]);return a.$(A,A,[-100,-100,0]),A}}function Oe(Q,A,C){return A*(a.N/(Q.tileSize*Math.pow(2,C-Q.tileID.overscaledZ)))}class Ve{constructor(A,C,O,V){this.opacity=A?Math.max(0,Math.min(1,A.opacity+(A.placed?C:-C))):V&&O?1:0,this.placed=O}isHidden(){return this.opacity===0&&!this.placed}}class Je{constructor(A,C,O,V,x){this.text=new Ve(A?A.text:null,C,O,x),this.icon=new Ve(A?A.icon:null,C,V,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class et{constructor(A,C,O){this.text=A,this.icon=C,this.skipFade=O}}class Le{constructor(){this.invProjMatrix=a.Z(),this.viewportMatrix=a.Z(),this.circles=[]}}class qe{constructor(A,C,O,V,x){this.bucketInstanceId=A,this.featureIndex=C,this.sourceLayerIndex=O,this.bucketIndex=V,this.tileID=x}}class dt{constructor(A){this.crossSourceCollisions=A,this.maxGroupID=0,this.collisionGroups={}}get(A){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[A]){const C=++this.maxGroupID;this.collisionGroups[A]={ID:C,predicate:O=>O.collisionGroupID===C}}return this.collisionGroups[A]}}function Pt(Q,A,C,O,V){const{horizontalAlign:x,verticalAlign:s}=a.au(Q);return new a.P(-(x-.5)*A+O[0]*V,-(s-.5)*C+O[1]*V)}function o(Q,A,C,O,V,x){const{x1:s,x2:i,y1:r,y2:l,anchorPointX:d,anchorPointY:y}=Q,I=new a.P(A,C);return O&&I._rotate(V?x:-x),{x1:s+I.x,y1:r+I.y,x2:i+I.x,y2:l+I.y,anchorPointX:d,anchorPointY:y}}class Me{constructor(A,C,O,V,x){this.transform=A.clone(),this.terrain=C,this.collisionIndex=new De(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=O,this.retainedQueryData={},this.collisionGroups=new dt(V),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(A,C,O,V){const x=O.getBucket(C),s=O.latestFeatureIndex;if(!x||!s||C.id!==x.layerIds[0])return;const i=O.collisionBoxArray,r=x.layers[0].layout,l=Math.pow(2,this.transform.zoom-O.tileID.overscaledZ),d=O.tileSize/a.N,y=this.transform.calculatePosMatrix(O.tileID.toUnwrapped()),I=r.get("text-pitch-alignment")==="map",k=r.get("text-rotation-alignment")==="map",z=Oe(O,1,this.transform.zoom),Z=be(y,I,k,this.transform,z);let Y=null;if(I){const Ie=Ee(y,I,k,this.transform,z);Y=a.a1([],this.transform.labelPlaneMatrix,Ie)}this.retainedQueryData[x.bucketInstanceId]=new qe(x.bucketInstanceId,s,x.sourceLayerIndex,x.index,O.tileID);const Ae={bucket:x,layout:r,posMatrix:y,textLabelPlaneMatrix:Z,labelToScreenMatrix:Y,scale:l,textPixelRatio:d,holdingForFade:O.holdingForFade(),collisionBoxArray:i,partiallyEvaluatedTextSize:a.ah(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(V)for(const Ie of x.sortKeyRanges){const{sortKey:ke,symbolInstanceStart:Fe,symbolInstanceEnd:ze}=Ie;A.push({sortKey:ke,symbolInstanceStart:Fe,symbolInstanceEnd:ze,parameters:Ae})}else A.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:Ae})}attemptAnchorPlacement(A,C,O,V,x,s,i,r,l,d,y,I,k,z,Z,Y){const Ae=a.aq[A.textAnchor],Ie=[A.textOffset0,A.textOffset1],ke=Pt(Ae,O,V,Ie,x),Fe=this.collisionIndex.placeCollisionBox(o(C,ke.x,ke.y,s,i,this.transform.angle),y,r,l,d.predicate,Y);if((!Z||this.collisionIndex.placeCollisionBox(o(Z,ke.x,ke.y,s,i,this.transform.angle),y,r,l,d.predicate,Y).box.length!==0)&&Fe.box.length>0){let ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[I.crossTileID]&&this.prevPlacement.placements[I.crossTileID]&&this.prevPlacement.placements[I.crossTileID].text&&(ze=this.prevPlacement.variableOffsets[I.crossTileID].anchor),I.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[I.crossTileID]={textOffset:Ie,width:O,height:V,anchor:Ae,textBoxScale:x,prevAnchor:ze},this.markUsedJustification(k,Ae,I,z),k.allowVerticalPlacement&&(this.markUsedOrientation(k,z,I),this.placedOrientations[I.crossTileID]=z),{shift:ke,placedGlyphBoxes:Fe}}}placeLayerBucketPart(A,C,O){const{bucket:V,layout:x,posMatrix:s,textLabelPlaneMatrix:i,labelToScreenMatrix:r,textPixelRatio:l,holdingForFade:d,collisionBoxArray:y,partiallyEvaluatedTextSize:I,collisionGroup:k}=A.parameters,z=x.get("text-optional"),Z=x.get("icon-optional"),Y=a.ar(x,"text-overlap","text-allow-overlap"),Ae=Y==="always",Ie=a.ar(x,"icon-overlap","icon-allow-overlap"),ke=Ie==="always",Fe=x.get("text-rotation-alignment")==="map",ze=x.get("text-pitch-alignment")==="map",tt=x.get("icon-text-fit")!=="none",wt=x.get("symbol-z-order")==="viewport-y",lt=Ae&&(ke||!V.hasIconData()||Z),ft=ke&&(Ae||!V.hasTextData()||z);!V.collisionArrays&&y&&V.deserializeCollisionBoxes(y);const Tt=this.retainedQueryData[V.bucketInstanceId].tileID,It=this.terrain?(Kt,ii)=>this.terrain.getElevation(Tt,Kt,ii):null,si=(Kt,ii)=>{var ai,Wi;if(C[Kt.crossTileID])return;if(d)return void(this.placements[Kt.crossTileID]=new et(!1,!1,!1));let $i=!1,Ei=!1,Hi=!0,ji=null,cn={box:null,offscreen:null},Nn={box:null,offscreen:null},nn=null,Mn=null,wr=null,nr=0,Pa=0,_a=0;ii.textFeatureIndex?nr=ii.textFeatureIndex:Kt.useRuntimeCollisionCircles&&(nr=Kt.featureIndex),ii.verticalTextFeatureIndex&&(Pa=ii.verticalTextFeatureIndex);const Vs=ii.textBox;if(Vs){const $r=Ks=>{let os=a.ai.horizontal;if(V.allowVerticalPlacement&&!Ks&&this.prevPlacement){const ls=this.prevPlacement.placedOrientations[Kt.crossTileID];ls&&(this.placedOrientations[Kt.crossTileID]=ls,os=ls,this.markUsedOrientation(V,os,Kt))}return os},Sa=(Ks,os)=>{if(V.allowVerticalPlacement&&Kt.numVerticalGlyphVertices>0&&ii.verticalTextBox){for(const ls of V.writingModes)if(ls===a.ai.vertical?(cn=os(),Nn=cn):cn=Ks(),cn&&cn.box&&cn.box.length)break}else cn=Ks()},So=Kt.textAnchorOffsetStartIndex,Io=Kt.textAnchorOffsetEndIndex;if(Io===So){const Ks=(os,ls)=>{const Ur=this.collisionIndex.placeCollisionBox(os,Y,l,s,k.predicate,It);return Ur&&Ur.box&&Ur.box.length&&(this.markUsedOrientation(V,ls,Kt),this.placedOrientations[Kt.crossTileID]=ls),Ur};Sa(()=>Ks(Vs,a.ai.horizontal),()=>{const os=ii.verticalTextBox;return V.allowVerticalPlacement&&Kt.numVerticalGlyphVertices>0&&os?Ks(os,a.ai.vertical):{box:null,offscreen:null}}),$r(cn&&cn.box&&cn.box.length)}else{let Ks=a.aq[(Wi=(ai=this.prevPlacement)===null||ai===void 0?void 0:ai.variableOffsets[Kt.crossTileID])===null||Wi===void 0?void 0:Wi.anchor];const os=(Ur,Cs,Js)=>{const zo=Ur.x2-Ur.x1,Go=Ur.y2-Ur.y1,qo=Kt.textBoxScale,Cc=tt&&Ie==="never"?Cs:null;let ea={box:[],offscreen:!1},Jl=Y==="never"?1:2,fu="never";Ks&&Jl++;for(let nl=0;nl<Jl;nl++){for(let xl=So;xl<Io;xl++){const Bl=V.textAnchorOffsets.get(xl);if(Ks&&Bl.textAnchor!==Ks)continue;const du=this.attemptAnchorPlacement(Bl,Ur,zo,Go,qo,Fe,ze,l,s,k,fu,Kt,V,Js,Cc,It);if(du&&(ea=du.placedGlyphBoxes,ea&&ea.box&&ea.box.length))return $i=!0,ji=du.shift,ea}Ks?Ks=null:fu=Y}return ea};Sa(()=>os(Vs,ii.iconBox,a.ai.horizontal),()=>{const Ur=ii.verticalTextBox;return V.allowVerticalPlacement&&!(cn&&cn.box&&cn.box.length)&&Kt.numVerticalGlyphVertices>0&&Ur?os(Ur,ii.verticalIconBox,a.ai.vertical):{box:null,offscreen:null}}),cn&&($i=cn.box,Hi=cn.offscreen);const ls=$r(cn&&cn.box);if(!$i&&this.prevPlacement){const Ur=this.prevPlacement.variableOffsets[Kt.crossTileID];Ur&&(this.variableOffsets[Kt.crossTileID]=Ur,this.markUsedJustification(V,Ur.anchor,Kt,ls))}}}if(nn=cn,$i=nn&&nn.box&&nn.box.length>0,Hi=nn&&nn.offscreen,Kt.useRuntimeCollisionCircles){const $r=V.text.placedSymbolArray.get(Kt.centerJustifiedTextSymbolIndex),Sa=a.aj(V.textSizeData,I,$r),So=x.get("text-padding");Mn=this.collisionIndex.placeCollisionCircles(Y,$r,V.lineVertexArray,V.glyphOffsetArray,Sa,s,i,r,O,ze,k.predicate,Kt.collisionCircleDiameter,So,It),Mn.circles.length&&Mn.collisionDetected&&!O&&a.w("Collisions detected, but collision boxes are not shown"),$i=Ae||Mn.circles.length>0&&!Mn.collisionDetected,Hi=Hi&&Mn.offscreen}if(ii.iconFeatureIndex&&(_a=ii.iconFeatureIndex),ii.iconBox){const $r=Sa=>{const So=tt&&ji?o(Sa,ji.x,ji.y,Fe,ze,this.transform.angle):Sa;return this.collisionIndex.placeCollisionBox(So,Ie,l,s,k.predicate,It)};Nn&&Nn.box&&Nn.box.length&&ii.verticalIconBox?(wr=$r(ii.verticalIconBox),Ei=wr.box.length>0):(wr=$r(ii.iconBox),Ei=wr.box.length>0),Hi=Hi&&wr.offscreen}const Ao=z||Kt.numHorizontalGlyphVertices===0&&Kt.numVerticalGlyphVertices===0,fo=Z||Kt.numIconVertices===0;if(Ao||fo?fo?Ao||(Ei=Ei&&$i):$i=Ei&&$i:Ei=$i=Ei&&$i,$i&&nn&&nn.box&&this.collisionIndex.insertCollisionBox(nn.box,Y,x.get("text-ignore-placement"),V.bucketInstanceId,Nn&&Nn.box&&Pa?Pa:nr,k.ID),Ei&&wr&&this.collisionIndex.insertCollisionBox(wr.box,Ie,x.get("icon-ignore-placement"),V.bucketInstanceId,_a,k.ID),Mn&&($i&&this.collisionIndex.insertCollisionCircles(Mn.circles,Y,x.get("text-ignore-placement"),V.bucketInstanceId,nr,k.ID),O)){const $r=V.bucketInstanceId;let Sa=this.collisionCircleArrays[$r];Sa===void 0&&(Sa=this.collisionCircleArrays[$r]=new Le);for(let So=0;So<Mn.circles.length;So+=4)Sa.circles.push(Mn.circles[So+0]),Sa.circles.push(Mn.circles[So+1]),Sa.circles.push(Mn.circles[So+2]),Sa.circles.push(Mn.collisionDetected?1:0)}if(Kt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(V.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Kt.crossTileID]=new et($i||lt,Ei||ft,Hi||V.justReloaded),C[Kt.crossTileID]=!0};if(wt){if(A.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Kt=V.getSortedSymbolIndexes(this.transform.angle);for(let ii=Kt.length-1;ii>=0;--ii){const ai=Kt[ii];si(V.symbolInstances.get(ai),V.collisionArrays[ai])}}else for(let Kt=A.symbolInstanceStart;Kt<A.symbolInstanceEnd;Kt++)si(V.symbolInstances.get(Kt),V.collisionArrays[Kt]);if(O&&V.bucketInstanceId in this.collisionCircleArrays){const Kt=this.collisionCircleArrays[V.bucketInstanceId];a.as(Kt.invProjMatrix,s),Kt.viewportMatrix=this.collisionIndex.getViewportMatrix()}V.justReloaded=!1}markUsedJustification(A,C,O,V){let x;x=V===a.ai.vertical?O.verticalPlacedTextSymbolIndex:{left:O.leftJustifiedTextSymbolIndex,center:O.centerJustifiedTextSymbolIndex,right:O.rightJustifiedTextSymbolIndex}[a.at(C)];const s=[O.leftJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.rightJustifiedTextSymbolIndex,O.verticalPlacedTextSymbolIndex];for(const i of s)i>=0&&(A.text.placedSymbolArray.get(i).crossTileID=x>=0&&i!==x?0:O.crossTileID)}markUsedOrientation(A,C,O){const V=C===a.ai.horizontal||C===a.ai.horizontalOnly?C:0,x=C===a.ai.vertical?C:0,s=[O.leftJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.rightJustifiedTextSymbolIndex];for(const i of s)A.text.placedSymbolArray.get(i).placedOrientation=V;O.verticalPlacedTextSymbolIndex&&(A.text.placedSymbolArray.get(O.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(A){this.commitTime=A,this.zoomAtLastRecencyCheck=this.transform.zoom;const C=this.prevPlacement;let O=!1;this.prevZoomAdjustment=C?C.zoomAdjustment(this.transform.zoom):0;const V=C?C.symbolFadeChange(A):1,x=C?C.opacities:{},s=C?C.variableOffsets:{},i=C?C.placedOrientations:{};for(const r in this.placements){const l=this.placements[r],d=x[r];d?(this.opacities[r]=new Je(d,V,l.text,l.icon),O=O||l.text!==d.text.placed||l.icon!==d.icon.placed):(this.opacities[r]=new Je(null,V,l.text,l.icon,l.skipFade),O=O||l.text||l.icon)}for(const r in x){const l=x[r];if(!this.opacities[r]){const d=new Je(l,V,!1,!1);d.isHidden()||(this.opacities[r]=d,O=O||l.text.placed||l.icon.placed)}}for(const r in s)this.variableOffsets[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.variableOffsets[r]=s[r]);for(const r in i)this.placedOrientations[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.placedOrientations[r]=i[r]);if(C&&C.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");O?this.lastPlacementChangeTime=A:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=C?C.lastPlacementChangeTime:A)}updateLayerOpacities(A,C){const O={};for(const V of C){const x=V.getBucket(A);x&&V.latestFeatureIndex&&A.id===x.layerIds[0]&&this.updateBucketOpacities(x,O,V.collisionBoxArray)}}updateBucketOpacities(A,C,O){A.hasTextData()&&(A.text.opacityVertexArray.clear(),A.text.hasVisibleVertices=!1),A.hasIconData()&&(A.icon.opacityVertexArray.clear(),A.icon.hasVisibleVertices=!1),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexArray.clear(),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexArray.clear();const V=A.layers[0],x=V.layout,s=new Je(null,0,!1,!1,!0),i=x.get("text-allow-overlap"),r=x.get("icon-allow-overlap"),l=V._unevaluatedLayout.hasValue("text-variable-anchor")||V._unevaluatedLayout.hasValue("text-variable-anchor-offset"),d=x.get("text-rotation-alignment")==="map",y=x.get("text-pitch-alignment")==="map",I=x.get("icon-text-fit")!=="none",k=new Je(null,0,i&&(r||!A.hasIconData()||x.get("icon-optional")),r&&(i||!A.hasTextData()||x.get("text-optional")),!0);!A.collisionArrays&&O&&(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData())&&A.deserializeCollisionBoxes(O);const z=(Z,Y,Ae)=>{for(let Ie=0;Ie<Y/4;Ie++)Z.opacityVertexArray.emplaceBack(Ae);Z.hasVisibleVertices=Z.hasVisibleVertices||Ae!==Sn};for(let Z=0;Z<A.symbolInstances.length;Z++){const Y=A.symbolInstances.get(Z),{numHorizontalGlyphVertices:Ae,numVerticalGlyphVertices:Ie,crossTileID:ke}=Y;let Fe=this.opacities[ke];C[ke]?Fe=s:Fe||(Fe=k,this.opacities[ke]=Fe),C[ke]=!0;const ze=Y.numIconVertices>0,tt=this.placedOrientations[Y.crossTileID],wt=tt===a.ai.vertical,lt=tt===a.ai.horizontal||tt===a.ai.horizontalOnly;if(Ae>0||Ie>0){const ft=Jt(Fe.text);z(A.text,Ae,wt?Sn:ft),z(A.text,Ie,lt?Sn:ft);const Tt=Fe.text.isHidden();[Y.rightJustifiedTextSymbolIndex,Y.centerJustifiedTextSymbolIndex,Y.leftJustifiedTextSymbolIndex].forEach(Kt=>{Kt>=0&&(A.text.placedSymbolArray.get(Kt).hidden=Tt||wt?1:0)}),Y.verticalPlacedTextSymbolIndex>=0&&(A.text.placedSymbolArray.get(Y.verticalPlacedTextSymbolIndex).hidden=Tt||lt?1:0);const It=this.variableOffsets[Y.crossTileID];It&&this.markUsedJustification(A,It.anchor,Y,tt);const si=this.placedOrientations[Y.crossTileID];si&&(this.markUsedJustification(A,"left",Y,si),this.markUsedOrientation(A,si,Y))}if(ze){const ft=Jt(Fe.icon),Tt=!(I&&Y.verticalPlacedIconSymbolIndex&&wt);Y.placedIconSymbolIndex>=0&&(z(A.icon,Y.numIconVertices,Tt?ft:Sn),A.icon.placedSymbolArray.get(Y.placedIconSymbolIndex).hidden=Fe.icon.isHidden()),Y.verticalPlacedIconSymbolIndex>=0&&(z(A.icon,Y.numVerticalIconVertices,Tt?Sn:ft),A.icon.placedSymbolArray.get(Y.verticalPlacedIconSymbolIndex).hidden=Fe.icon.isHidden())}if(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData()){const ft=A.collisionArrays[Z];if(ft){let Tt=new a.P(0,0);if(ft.textBox||ft.verticalTextBox){let si=!0;if(l){const Kt=this.variableOffsets[ke];Kt?(Tt=Pt(Kt.anchor,Kt.width,Kt.height,Kt.textOffset,Kt.textBoxScale),d&&Tt._rotate(y?this.transform.angle:-this.transform.angle)):si=!1}ft.textBox&&li(A.textCollisionBox.collisionVertexArray,Fe.text.placed,!si||wt,Tt.x,Tt.y),ft.verticalTextBox&&li(A.textCollisionBox.collisionVertexArray,Fe.text.placed,!si||lt,Tt.x,Tt.y)}const It=!!(!lt&&ft.verticalIconBox);ft.iconBox&&li(A.iconCollisionBox.collisionVertexArray,Fe.icon.placed,It,I?Tt.x:0,I?Tt.y:0),ft.verticalIconBox&&li(A.iconCollisionBox.collisionVertexArray,Fe.icon.placed,!It,I?Tt.x:0,I?Tt.y:0)}}}if(A.sortFeatures(this.transform.angle),this.retainedQueryData[A.bucketInstanceId]&&(this.retainedQueryData[A.bucketInstanceId].featureSortOrder=A.featureSortOrder),A.hasTextData()&&A.text.opacityVertexBuffer&&A.text.opacityVertexBuffer.updateData(A.text.opacityVertexArray),A.hasIconData()&&A.icon.opacityVertexBuffer&&A.icon.opacityVertexBuffer.updateData(A.icon.opacityVertexArray),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexBuffer&&A.iconCollisionBox.collisionVertexBuffer.updateData(A.iconCollisionBox.collisionVertexArray),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexBuffer&&A.textCollisionBox.collisionVertexBuffer.updateData(A.textCollisionBox.collisionVertexArray),A.text.opacityVertexArray.length!==A.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${A.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${A.text.layoutVertexArray.length}) / 4`);if(A.icon.opacityVertexArray.length!==A.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${A.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${A.icon.layoutVertexArray.length}) / 4`);if(A.bucketInstanceId in this.collisionCircleArrays){const Z=this.collisionCircleArrays[A.bucketInstanceId];A.placementInvProjMatrix=Z.invProjMatrix,A.placementViewportMatrix=Z.viewportMatrix,A.collisionCircleArray=Z.circles,delete this.collisionCircleArrays[A.bucketInstanceId]}}symbolFadeChange(A){return this.fadeDuration===0?1:(A-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(A){return Math.max(0,(this.transform.zoom-A)/1.5)}hasTransitions(A){return this.stale||A-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(A,C){const O=this.zoomAtLastRecencyCheck===C?1-this.zoomAdjustment(C):1;return this.zoomAtLastRecencyCheck=C,this.commitTime+this.fadeDuration*O>A}setStale(){this.stale=!0}}function li(Q,A,C,O,V){Q.emplaceBack(A?1:0,C?1:0,O||0,V||0),Q.emplaceBack(A?1:0,C?1:0,O||0,V||0),Q.emplaceBack(A?1:0,C?1:0,O||0,V||0),Q.emplaceBack(A?1:0,C?1:0,O||0,V||0)}const di=Math.pow(2,25),fi=Math.pow(2,24),ti=Math.pow(2,17),ui=Math.pow(2,16),Ri=Math.pow(2,9),bi=Math.pow(2,8),Si=Math.pow(2,1);function Jt(Q){if(Q.opacity===0&&!Q.placed)return 0;if(Q.opacity===1&&Q.placed)return 4294967295;const A=Q.placed?1:0,C=Math.floor(127*Q.opacity);return C*di+A*fi+C*ti+A*ui+C*Ri+A*bi+C*Si+A}const Sn=0;class ur{constructor(A){this._sortAcrossTiles=A.layout.get("symbol-z-order")!=="viewport-y"&&!A.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(A,C,O,V,x){const s=this._bucketParts;for(;this._currentTileIndex<A.length;)if(C.getBucketParts(s,V,A[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((i,r)=>i.sortKey-r.sortKey));this._currentPartIndex<s.length;)if(C.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,O),this._currentPartIndex++,x())return!0;return!1}}class mn{constructor(A,C,O,V,x,s,i,r){this.placement=new Me(A,C,s,i,r),this._currentPlacementIndex=O.length-1,this._forceFullPlacement=V,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(A,C,O){const V=a.h.now(),x=()=>!this._forceFullPlacement&&a.h.now()-V>2;for(;this._currentPlacementIndex>=0;){const s=C[A[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=i)&&(!s.maxzoom||s.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new ur(s)),this._inProgressLayer.continuePlacement(O[s.source],this.placement,this._showCollisionBoxes,s,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(A){return this.placement.commit(A),this.placement}}const Hn=512/a.N/2;class Yr{constructor(A,C,O){this.tileID=A,this.bucketInstanceId=O,this._symbolsByKey={};const V=new Map;for(let x=0;x<C.length;x++){const s=C.get(x),i=s.key,r=V.get(i);r?r.push(s):V.set(i,[s])}for(const[x,s]of V){const i={positions:s.map(r=>({x:Math.floor(r.anchorX*Hn),y:Math.floor(r.anchorY*Hn)})),crossTileIDs:s.map(r=>r.crossTileID)};if(i.positions.length>128){const r=new a.av(i.positions.length,16,Uint16Array);for(const{x:l,y:d}of i.positions)r.add(l,d);r.finish(),delete i.positions,i.index=r}this._symbolsByKey[x]=i}}getScaledCoordinates(A,C){const{x:O,y:V,z:x}=this.tileID.canonical,{x:s,y:i,z:r}=C.canonical,l=Hn/Math.pow(2,r-x),d=(i*a.N+A.anchorY)*l,y=V*a.N*Hn;return{x:Math.floor((s*a.N+A.anchorX)*l-O*a.N*Hn),y:Math.floor(d-y)}}findMatches(A,C,O){const V=this.tileID.canonical.z<C.canonical.z?1:Math.pow(2,this.tileID.canonical.z-C.canonical.z);for(let x=0;x<A.length;x++){const s=A.get(x);if(s.crossTileID)continue;const i=this._symbolsByKey[s.key];if(!i)continue;const r=this.getScaledCoordinates(s,C);if(i.index){const l=i.index.range(r.x-V,r.y-V,r.x+V,r.y+V).sort();for(const d of l){const y=i.crossTileIDs[d];if(!O[y]){O[y]=!0,s.crossTileID=y;break}}}else if(i.positions)for(let l=0;l<i.positions.length;l++){const d=i.positions[l],y=i.crossTileIDs[l];if(Math.abs(d.x-r.x)<=V&&Math.abs(d.y-r.y)<=V&&!O[y]){O[y]=!0,s.crossTileID=y;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:A})=>A)}}class Qi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class hr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(A){const C=Math.round((A-this.lng)/360);if(C!==0)for(const O in this.indexes){const V=this.indexes[O],x={};for(const s in V){const i=V[s];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+C),x[i.tileID.key]=i}this.indexes[O]=x}this.lng=A}addBucket(A,C,O){if(this.indexes[A.overscaledZ]&&this.indexes[A.overscaledZ][A.key]){if(this.indexes[A.overscaledZ][A.key].bucketInstanceId===C.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(A.overscaledZ,this.indexes[A.overscaledZ][A.key])}for(let x=0;x<C.symbolInstances.length;x++)C.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[A.overscaledZ]||(this.usedCrossTileIDs[A.overscaledZ]={});const V=this.usedCrossTileIDs[A.overscaledZ];for(const x in this.indexes){const s=this.indexes[x];if(Number(x)>A.overscaledZ)for(const i in s){const r=s[i];r.tileID.isChildOf(A)&&r.findMatches(C.symbolInstances,A,V)}else{const i=s[A.scaledTo(Number(x)).key];i&&i.findMatches(C.symbolInstances,A,V)}}for(let x=0;x<C.symbolInstances.length;x++){const s=C.symbolInstances.get(x);s.crossTileID||(s.crossTileID=O.generate(),V[s.crossTileID]=!0)}return this.indexes[A.overscaledZ]===void 0&&(this.indexes[A.overscaledZ]={}),this.indexes[A.overscaledZ][A.key]=new Yr(A,C.symbolInstances,C.bucketInstanceId),!0}removeBucketCrossTileIDs(A,C){for(const O of C.getCrossTileIDsLists())for(const V of O)delete this.usedCrossTileIDs[A][V]}removeStaleBuckets(A){let C=!1;for(const O in this.indexes){const V=this.indexes[O];for(const x in V)A[V[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(O,V[x]),delete V[x],C=!0)}return C}}class Gn{constructor(){this.layerIndexes={},this.crossTileIDs=new Qi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(A,C,O){let V=this.layerIndexes[A.id];V===void 0&&(V=this.layerIndexes[A.id]=new hr);let x=!1;const s={};V.handleWrapJump(O);for(const i of C){const r=i.getBucket(A);r&&A.id===r.layerIds[0]&&(r.bucketInstanceId||(r.bucketInstanceId=++this.maxBucketInstanceId),V.addBucket(i.tileID,r,this.crossTileIDs)&&(x=!0),s[r.bucketInstanceId]=!0)}return V.removeStaleBuckets(s)&&(x=!0),x}pruneUnusedLayers(A){const C={};A.forEach(O=>{C[O]=!0});for(const O in this.layerIndexes)C[O]||delete this.layerIndexes[O]}}const Xt=(Q,A)=>a.x(Q,A&&A.filter(C=>C.identifier!=="source.canvas")),en=a.F(a.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),qt=a.F(a.ax,["setCenter","setZoom","setBearing","setPitch"]),kn=a.aw();class Ar extends a.E{constructor(A,C={}){super(),this.map=A,this.dispatcher=new Ci(U(),this,A._getMapId()),this.imageManager=new St,this.imageManager.setEventedParent(this),this.glyphManager=new ct(A._requestManager,C.localIdeographFontFamily),this.lineAtlas=new yi(256,512),this.crossTileSymbolIndex=new Gn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.az());const O=this;this._rtlTextPluginCallback=Ar.registerForPluginStateChange(V=>{O.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:V.pluginStatus,pluginURL:V.pluginURL},(x,s)=>{if(a.aA(x),s&&s.every(i=>i))for(const i in O.sourceCaches){const r=O.sourceCaches[i].getSource().type;r!=="vector"&&r!=="geojson"||O.sourceCaches[i].reload()}})}),this.on("data",V=>{if(V.dataType!=="source"||V.sourceDataType!=="metadata")return;const x=this.sourceCaches[V.sourceId];if(!x)return;const s=x.getSource();if(s&&s.vectorLayerIds)for(const i in this._layers){const r=this._layers[i];r.source===s.id&&this._validateLayer(r)}})}loadURL(A,C={},O){this.fire(new a.k("dataloading",{dataType:"style"})),C.validate=typeof C.validate!="boolean"||C.validate;const V=this.map._requestManager.transformRequest(A,st.Style);this._request=a.f(V,(x,s)=>{this._request=null,x?this.fire(new a.j(x)):s&&this._load(s,C,O)})}loadJSON(A,C={},O){this.fire(new a.k("dataloading",{dataType:"style"})),this._request=a.h.frame(()=>{this._request=null,C.validate=C.validate!==!1,this._load(A,C,O)})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(kn,{validate:!1})}_load(A,C,O){var V;const x=C.transformStyle?C.transformStyle(O,A):A;if(!C.validate||!Xt(this,a.y(x))){this._loaded=!0,this.stylesheet=x;for(const s in x.sources)this.addSource(s,x.sources[s],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new Vt(this.stylesheet.light),this.map.setTerrain((V=this.stylesheet.terrain)!==null&&V!==void 0?V:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const A=a.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",A),this._order=A.map(C=>C.id),this._layers={},this._serializedLayers=null;for(const C of A){const O=a.aC(C);O.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=O}}_loadSprite(A,C=!1,O=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(V,x,s,i){const r=rt(V),l=r.length,d=s>1?"@2x":"",y={},I={},k={};for(const{id:z,url:Z}of r){const Y=x.transformRequest(x.normalizeSpriteURL(Z,d,".json"),st.SpriteJSON),Ae=`${z}_${Y.url}`;y[Ae]=a.f(Y,(Fe,ze)=>{delete y[Ae],I[z]=ze,gt(i,I,k,Fe,l)});const Ie=x.transformRequest(x.normalizeSpriteURL(Z,d,".png"),st.SpriteImage),ke=`${z}_${Ie.url}`;y[ke]=Ke.getImage(Ie,(Fe,ze)=>{delete y[ke],k[z]=ze,gt(i,I,k,Fe,l)})}return{cancel(){for(const z of Object.values(y))z.cancel()}}}(A,this.map._requestManager,this.map.getPixelRatio(),(V,x)=>{if(this._spriteRequest=null,V)this.fire(new a.j(V));else if(x)for(const s in x){this._spritesImagesIds[s]=[];const i=this._spritesImagesIds[s]?this._spritesImagesIds[s].filter(r=>!(r in x)):[];for(const r of i)this.imageManager.removeImage(r),this._changedImages[r]=!0;for(const r in x[s]){const l=s==="default"?r:`${s}:${r}`;this._spritesImagesIds[s].push(l),l in this.imageManager.images?this.imageManager.updateImage(l,x[s][r],!1):this.imageManager.addImage(l,x[s][r]),C&&(this._changedImages[l]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),C&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),O&&O(V)})}_unloadSprite(){for(const A of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(A),this._changedImages[A]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(A){const C=this.sourceCaches[A.source];if(!C)return;const O=A.sourceLayer;if(!O)return;const V=C.getSource();(V.type==="geojson"||V.vectorLayerIds&&V.vectorLayerIds.indexOf(O)===-1)&&this.fire(new a.j(new Error(`Source layer "${O}" does not exist on source "${V.id}" as specified by style layer "${A.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const A in this.sourceCaches)if(!this.sourceCaches[A].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(A){const C=this._serializedAllLayers();if(!A||A.length===0)return Object.values(C);const O=[];for(const V of A)C[V]&&O.push(C[V]);return O}_serializedAllLayers(){let A=this._serializedLayers;if(A)return A;A=this._serializedLayers={};const C=Object.keys(this._layers);for(const O of C){const V=this._layers[O];V.type!=="custom"&&(A[O]=V.serialize())}return A}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const A in this.sourceCaches)if(this.sourceCaches[A].hasTransition())return!0;for(const A in this._layers)if(this._layers[A].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(A){if(!this._loaded)return;const C=this._changed;if(this._changed){const V=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(V.length||x.length)&&this._updateWorkerLayers(V,x);for(const s in this._updatedSources){const i=this._updatedSources[s];if(i==="reload")this._reloadSource(s);else{if(i!=="clear")throw new Error(`Invalid action ${i}`);this._clearSource(s)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const s in this._updatedPaintProps)this._layers[s].updateTransitions(A);this.light.updateTransitions(A),this._resetUpdates()}const O={};for(const V in this.sourceCaches){const x=this.sourceCaches[V];O[V]=x.used,x.used=!1}for(const V of this._order){const x=this._layers[V];x.recalculate(A,this._availableImages),!x.isHidden(A.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const V in O){const x=this.sourceCaches[V];O[V]!==x.used&&x.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:V}))}this.light.recalculate(A),this.z=A.zoom,C&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const A=Object.keys(this._changedImages);if(A.length){for(const C in this.sourceCaches)this.sourceCaches[C].reloadTilesForDependencies(["icons","patterns"],A);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(A,C){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(A),removedIds:C})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(A,C={}){this._checkLoaded();const O=this.serialize();if(A=C.transformStyle?C.transformStyle(O,A):A,Xt(this,a.y(A)))return!1;(A=a.aD(A)).layers=a.aB(A.layers);const V=a.aE(O,A).filter(s=>!(s.command in qt));if(V.length===0)return!1;const x=V.filter(s=>!(s.command in en));if(x.length>0)throw new Error(`Unimplemented: ${x.map(s=>s.command).join(", ")}.`);for(const s of V)s.command!=="setTransition"&&this[s.command].apply(this,s.args);return this.stylesheet=A,this._serializedLayers=null,!0}addImage(A,C){if(this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" already exists.`)));this.imageManager.addImage(A,C),this._afterImageUpdated(A)}updateImage(A,C){this.imageManager.updateImage(A,C)}getImage(A){return this.imageManager.getImage(A)}removeImage(A){if(!this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" does not exist.`)));this.imageManager.removeImage(A),this._afterImageUpdated(A)}_afterImageUpdated(A){this._availableImages=this.imageManager.listImages(),this._changedImages[A]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(A,C,O={}){if(this._checkLoaded(),this.sourceCaches[A]!==void 0)throw new Error(`Source "${A}" already exists.`);if(!C.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(C).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(C.type)>=0&&this._validate(a.y.source,`sources.${A}`,C,null,O))return;this.map&&this.map._collectResourceTiming&&(C.collectResourceTiming=!0);const V=this.sourceCaches[A]=new Yi(A,C,this.dispatcher);V.style=this,V.setEventedParent(this,()=>({isSourceLoaded:V.loaded(),source:V.serialize(),sourceId:A})),V.onAdd(this.map),this._changed=!0}removeSource(A){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error("There is no source with this ID");for(const O in this._layers)if(this._layers[O].source===A)return this.fire(new a.j(new Error(`Source "${A}" cannot be removed while layer "${O}" is using it.`)));const C=this.sourceCaches[A];delete this.sourceCaches[A],delete this._updatedSources[A],C.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:A})),C.setEventedParent(null),C.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(A,C){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error(`There is no source with this ID=${A}`);const O=this.sourceCaches[A].getSource();if(O.type!=="geojson")throw new Error(`geojsonSource.type is ${O.type}, which is !== 'geojson`);O.setData(C),this._changed=!0}getSource(A){return this.sourceCaches[A]&&this.sourceCaches[A].getSource()}addLayer(A,C,O={}){this._checkLoaded();const V=A.id;if(this.getLayer(V))return void this.fire(new a.j(new Error(`Layer "${V}" already exists on this map.`)));let x;if(A.type==="custom"){if(Xt(this,a.aF(A)))return;x=a.aC(A)}else{if("source"in A&&typeof A.source=="object"&&(this.addSource(V,A.source),A=a.aD(A),A=a.e(A,{source:V})),this._validate(a.y.layer,`layers.${V}`,A,{arrayIndex:-1},O))return;x=a.aC(A),this._validateLayer(x),x.setEventedParent(this,{layer:{id:V}})}const s=C?this._order.indexOf(C):this._order.length;if(C&&s===-1)this.fire(new a.j(new Error(`Cannot add layer "${V}" before non-existing layer "${C}".`)));else{if(this._order.splice(s,0,V),this._layerOrderChanged=!0,this._layers[V]=x,this._removedLayers[V]&&x.source&&x.type!=="custom"){const i=this._removedLayers[V];delete this._removedLayers[V],i.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(A,C){if(this._checkLoaded(),this._changed=!0,!this._layers[A])return void this.fire(new a.j(new Error(`The layer '${A}' does not exist in the map's style and cannot be moved.`)));if(A===C)return;const O=this._order.indexOf(A);this._order.splice(O,1);const V=C?this._order.indexOf(C):this._order.length;C&&V===-1?this.fire(new a.j(new Error(`Cannot move layer "${A}" before non-existing layer "${C}".`))):(this._order.splice(V,0,A),this._layerOrderChanged=!0)}removeLayer(A){this._checkLoaded();const C=this._layers[A];if(!C)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${A}".`)));C.setEventedParent(null);const O=this._order.indexOf(A);this._order.splice(O,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[A]=C,delete this._layers[A],this._serializedLayers&&delete this._serializedLayers[A],delete this._updatedLayers[A],delete this._updatedPaintProps[A],C.onRemove&&C.onRemove(this.map)}getLayer(A){return this._layers[A]}getLayersOrder(){return[...this._order]}hasLayer(A){return A in this._layers}setLayerZoomRange(A,C,O){this._checkLoaded();const V=this.getLayer(A);V?V.minzoom===C&&V.maxzoom===O||(C!=null&&(V.minzoom=C),O!=null&&(V.maxzoom=O),this._updateLayer(V)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${A}".`)))}setFilter(A,C,O={}){this._checkLoaded();const V=this.getLayer(A);if(V){if(!a.aG(V.filter,C))return C==null?(V.filter=void 0,void this._updateLayer(V)):void(this._validate(a.y.filter,`layers.${V.id}.filter`,C,null,O)||(V.filter=a.aD(C),this._updateLayer(V)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${A}".`)))}getFilter(A){return a.aD(this.getLayer(A).filter)}setLayoutProperty(A,C,O,V={}){this._checkLoaded();const x=this.getLayer(A);x?a.aG(x.getLayoutProperty(C),O)||(x.setLayoutProperty(C,O,V),this._updateLayer(x)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getLayoutProperty(A,C){const O=this.getLayer(A);if(O)return O.getLayoutProperty(C);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${A}".`)))}setPaintProperty(A,C,O,V={}){this._checkLoaded();const x=this.getLayer(A);x?a.aG(x.getPaintProperty(C),O)||(x.setPaintProperty(C,O,V)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[A]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getPaintProperty(A,C){return this.getLayer(A).getPaintProperty(C)}setFeatureState(A,C){this._checkLoaded();const O=A.source,V=A.sourceLayer,x=this.sourceCaches[O];if(x===void 0)return void this.fire(new a.j(new Error(`The source '${O}' does not exist in the map's style.`)));const s=x.getSource().type;s==="geojson"&&V?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):s!=="vector"||V?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(V,A.id,C)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(A,C){this._checkLoaded();const O=A.source,V=this.sourceCaches[O];if(V===void 0)return void this.fire(new a.j(new Error(`The source '${O}' does not exist in the map's style.`)));const x=V.getSource().type,s=x==="vector"?A.sourceLayer:void 0;x!=="vector"||s?C&&typeof A.id!="string"&&typeof A.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):V.removeFeatureState(s,A.id,C):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(A){this._checkLoaded();const C=A.source,O=A.sourceLayer,V=this.sourceCaches[C];if(V!==void 0)return V.getSource().type!=="vector"||O?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),V.getFeatureState(O,A.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${C}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const A=a.aH(this.sourceCaches,x=>x.serialize()),C=this._serializeByIds(this._order),O=this.map.getTerrain()||void 0,V=this.stylesheet;return a.aI({version:V.version,name:V.name,metadata:V.metadata,light:V.light,center:V.center,zoom:V.zoom,bearing:V.bearing,pitch:V.pitch,sprite:V.sprite,glyphs:V.glyphs,transition:V.transition,sources:A,layers:C,terrain:O},x=>x!==void 0)}_updateLayer(A){this._updatedLayers[A.id]=!0,A.source&&!this._updatedSources[A.source]&&this.sourceCaches[A.source].getSource().type!=="raster"&&(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(A){const C=s=>this._layers[s].type==="fill-extrusion",O={},V=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(C(i)){O[i]=s;for(const r of A){const l=r[i];if(l)for(const d of l)V.push(d)}}}V.sort((s,i)=>i.intersectionZ-s.intersectionZ);const x=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(C(i))for(let r=V.length-1;r>=0;r--){const l=V[r].feature;if(O[l.layer.id]<s)break;x.push(l),V.pop()}else for(const r of A){const l=r[i];if(l)for(const d of l)x.push(d.feature)}}return x}queryRenderedFeatures(A,C,O){C&&C.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",C.filter,null,C);const V={};if(C&&C.layers){if(!Array.isArray(C.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const i of C.layers){const r=this._layers[i];if(!r)return this.fire(new a.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be queried for features.`))),[];V[r.source]=!0}}const x=[];C.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const i in this.sourceCaches)C.layers&&!V[i]||x.push(Bn(this.sourceCaches[i],this._layers,s,A,C,O));return this.placement&&x.push(function(i,r,l,d,y,I,k){const z={},Z=I.queryRenderedSymbols(d),Y=[];for(const Ae of Object.keys(Z).map(Number))Y.push(k[Ae]);Y.sort(Ot);for(const Ae of Y){const Ie=Ae.featureIndex.lookupSymbolFeatures(Z[Ae.bucketInstanceId],r,Ae.bucketIndex,Ae.sourceLayerIndex,y.filter,y.layers,y.availableImages,i);for(const ke in Ie){const Fe=z[ke]=z[ke]||[],ze=Ie[ke];ze.sort((tt,wt)=>{const lt=Ae.featureSortOrder;if(lt){const ft=lt.indexOf(tt.featureIndex);return lt.indexOf(wt.featureIndex)-ft}return wt.featureIndex-tt.featureIndex});for(const tt of ze)Fe.push(tt)}}for(const Ae in z)z[Ae].forEach(Ie=>{const ke=Ie.feature,Fe=l[i[Ae].source].getFeatureState(ke.layer["source-layer"],ke.id);ke.source=ke.layer.source,ke.layer["source-layer"]&&(ke.sourceLayer=ke.layer["source-layer"]),ke.state=Fe});return z}(this._layers,s,this.sourceCaches,A,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(A,C){C&&C.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",C.filter,null,C);const O=this.sourceCaches[A];return O?function(V,x){const s=V.getRenderableIds().map(l=>V.getTileByID(l)),i=[],r={};for(let l=0;l<s.length;l++){const d=s[l],y=d.tileID.canonical.key;r[y]||(r[y]=!0,d.querySourceFeatures(i,x))}return i}(O,C):[]}addSourceType(A,C,O){return wn(A)?O(new Error(`A source type called "${A}" already exists.`)):(((V,x)=>{bn[V]=x})(A,C),C.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:A,url:C.workerSourceURL},O):O(null,null))}getLight(){return this.light.getLight()}setLight(A,C={}){this._checkLoaded();const O=this.light.getLight();let V=!1;for(const s in A)if(!a.aG(A[s],O[s])){V=!0;break}if(!V)return;const x={now:a.h.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(A,C),this.light.updateTransitions(x)}_validate(A,C,O,V,x={}){return(!x||x.validate!==!1)&&Xt(this,A.call(a.y,a.e({key:C,style:this.serialize(),value:O,styleSpec:a.v},V)))}_remove(A=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const C in this._layers)this._layers[C].setEventedParent(null);for(const C in this.sourceCaches){const O=this.sourceCaches[C];O.setEventedParent(null),O.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(A)}_clearSource(A){this.sourceCaches[A].clearTiles()}_reloadSource(A){this.sourceCaches[A].resume(),this.sourceCaches[A].reload()}_updateSources(A){for(const C in this.sourceCaches)this.sourceCaches[C].update(A,this.map.terrain)}_generateCollisionBoxes(){for(const A in this.sourceCaches)this._reloadSource(A)}_updatePlacement(A,C,O,V,x=!1){let s=!1,i=!1;const r={};for(const l of this._order){const d=this._layers[l];if(d.type!=="symbol")continue;if(!r[d.source]){const I=this.sourceCaches[d.source];r[d.source]=I.getRenderableIds(!0).map(k=>I.getTileByID(k)).sort((k,z)=>z.tileID.overscaledZ-k.tileID.overscaledZ||(k.tileID.isLessThan(z.tileID)?-1:1))}const y=this.crossTileSymbolIndex.addLayer(d,r[d.source],A.center.lng);s=s||y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||O===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.h.now(),A.zoom))&&(this.pauseablePlacement=new mn(A,this.map.terrain,this._order,x,C,O,V,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,r),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.h.now()),i=!0),s&&this.pauseablePlacement.placement.setStale()),i||s)for(const l of this._order){const d=this._layers[l];d.type==="symbol"&&this.placement.updateLayerOpacities(d,r[d.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.h.now())}_releaseSymbolFadeTiles(){for(const A in this.sourceCaches)this.sourceCaches[A].releaseSymbolFadeTiles()}getImages(A,C,O){this.imageManager.getImages(C.icons,O),this._updateTilesForChangedImages();const V=this.sourceCaches[C.source];V&&V.setDependencies(C.tileID.key,C.type,C.icons)}getGlyphs(A,C,O){this.glyphManager.getGlyphs(C.stacks,O);const V=this.sourceCaches[C.source];V&&V.setDependencies(C.tileID.key,C.type,[""])}getResource(A,C,O){return a.m(C,O)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(A,C={}){this._checkLoaded(),A&&this._validate(a.y.glyphs,"glyphs",A,null,C)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=A,this.glyphManager.entries={},this.glyphManager.setURL(A))}addSprite(A,C,O={},V){this._checkLoaded();const x=[{id:A,url:C}],s=[...rt(this.stylesheet.sprite),...x];this._validate(a.y.sprite,"sprite",s,null,O)||(this.stylesheet.sprite=s,this._loadSprite(x,!0,V))}removeSprite(A){this._checkLoaded();const C=rt(this.stylesheet.sprite);if(C.find(O=>O.id===A)){if(this._spritesImagesIds[A])for(const O of this._spritesImagesIds[A])this.imageManager.removeImage(O),this._changedImages[O]=!0;C.splice(C.findIndex(O=>O.id===A),1),this.stylesheet.sprite=C.length>0?C:void 0,delete this._spritesImagesIds[A],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${A}" doesn't exists on this map.`)))}getSprite(){return rt(this.stylesheet.sprite)}setSprite(A,C={},O){this._checkLoaded(),A&&this._validate(a.y.sprite,"sprite",A,null,C)||(this.stylesheet.sprite=A,A?this._loadSprite(A,!0,O):(this._unloadSprite(),O&&O(null)))}}Ar.registerForPluginStateChange=a.aK;var js=a.Q([{name:"a_pos",type:"Int16",components:2}]),Qr="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Gt={prelude:fr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:fr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:fr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:fr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:fr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:fr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:fr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:fr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:fr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:fr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:fr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:fr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:fr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:fr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:fr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:fr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:fr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:fr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Qr),terrainDepth:fr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Qr),terrainCoords:fr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Qr)};function fr(Q,A){const C=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,O=A.match(/attribute ([\w]+) ([\w]+)/g),V=Q.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=A.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=x?x.concat(V):V,i={};return{fragmentSource:Q=Q.replace(C,(r,l,d,y,I)=>(i[I]=!0,l==="define"?`
#ifndef HAS_UNIFORM_u_${I}
varying ${d} ${y} ${I};
#else
uniform ${d} ${y} u_${I};
#endif
`:`
#ifdef HAS_UNIFORM_u_${I}
    ${d} ${y} ${I} = u_${I};
#endif
`)),vertexSource:A=A.replace(C,(r,l,d,y,I)=>{const k=y==="float"?"vec2":"vec4",z=I.match(/color/)?"color":k;return i[I]?l==="define"?`
#ifndef HAS_UNIFORM_u_${I}
uniform lowp float u_${I}_t;
attribute ${d} ${k} a_${I};
varying ${d} ${y} ${I};
#else
uniform ${d} ${y} u_${I};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${I}
    ${I} = a_${I};
#else
    ${d} ${y} ${I} = u_${I};
#endif
`:`
#ifndef HAS_UNIFORM_u_${I}
    ${I} = unpack_mix_${z}(a_${I}, u_${I}_t);
#else
    ${d} ${y} ${I} = u_${I};
#endif
`:l==="define"?`
#ifndef HAS_UNIFORM_u_${I}
uniform lowp float u_${I}_t;
attribute ${d} ${k} a_${I};
#else
uniform ${d} ${y} u_${I};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${I}
    ${d} ${y} ${I} = a_${I};
#else
    ${d} ${y} ${I} = u_${I};
#endif
`:`
#ifndef HAS_UNIFORM_u_${I}
    ${d} ${y} ${I} = unpack_mix_${z}(a_${I}, u_${I}_t);
#else
    ${d} ${y} ${I} = u_${I};
#endif
`}),staticAttributes:O,staticUniforms:s}}class Bt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(A,C,O,V,x,s,i,r,l){this.context=A;let d=this.boundPaintVertexBuffers.length!==V.length;for(let y=0;!d&&y<V.length;y++)this.boundPaintVertexBuffers[y]!==V[y]&&(d=!0);!this.vao||this.boundProgram!==C||this.boundLayoutVertexBuffer!==O||d||this.boundIndexBuffer!==x||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==i||this.boundDynamicVertexBuffer2!==r||this.boundDynamicVertexBuffer3!==l?this.freshBind(C,O,V,x,s,i,r,l):(A.bindVertexArray.set(this.vao),i&&i.bind(),x&&x.dynamicDraw&&x.bind(),r&&r.bind(),l&&l.bind())}freshBind(A,C,O,V,x,s,i,r){const l=A.numAttributes,d=this.context,y=d.gl;this.vao&&this.destroy(),this.vao=d.createVertexArray(),d.bindVertexArray.set(this.vao),this.boundProgram=A,this.boundLayoutVertexBuffer=C,this.boundPaintVertexBuffers=O,this.boundIndexBuffer=V,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=i,this.boundDynamicVertexBuffer3=r,C.enableAttributes(y,A);for(const I of O)I.enableAttributes(y,A);s&&s.enableAttributes(y,A),i&&i.enableAttributes(y,A),r&&r.enableAttributes(y,A),C.bind(),C.setVertexAttribPointers(y,A,x);for(const I of O)I.bind(),I.setVertexAttribPointers(y,A,x);s&&(s.bind(),s.setVertexAttribPointers(y,A,x)),V&&V.bind(),i&&(i.bind(),i.setVertexAttribPointers(y,A,x)),r&&(r.bind(),r.setVertexAttribPointers(y,A,x)),d.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Gr(Q){const A=[];for(let C=0;C<Q.length;C++){if(Q[C]===null)continue;const O=Q[C].split(" ");A.push(O.pop())}return A}class Zs{constructor(A,C,O,V,x,s){const i=A.gl;this.program=i.createProgram();const r=Gr(C.staticAttributes),l=O?O.getBinderAttributes():[],d=r.concat(l),y=Gt.prelude.staticUniforms?Gr(Gt.prelude.staticUniforms):[],I=C.staticUniforms?Gr(C.staticUniforms):[],k=O?O.getBinderUniforms():[],z=y.concat(I).concat(k),Z=[];for(const tt of z)Z.indexOf(tt)<0&&Z.push(tt);const Y=O?O.defines():[];x&&Y.push("#define OVERDRAW_INSPECTOR;"),s&&Y.push("#define TERRAIN3D;");const Ae=Y.concat(Gt.prelude.fragmentSource,C.fragmentSource).join(`
`),Ie=Y.concat(Gt.prelude.vertexSource,C.vertexSource).join(`
`),ke=i.createShader(i.FRAGMENT_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(ke,Ae),i.compileShader(ke),!i.getShaderParameter(ke,i.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${i.getShaderInfoLog(ke)}`);i.attachShader(this.program,ke);const Fe=i.createShader(i.VERTEX_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Fe,Ie),i.compileShader(Fe),!i.getShaderParameter(Fe,i.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${i.getShaderInfoLog(Fe)}`);i.attachShader(this.program,Fe),this.attributes={};const ze={};this.numAttributes=d.length;for(let tt=0;tt<this.numAttributes;tt++)d[tt]&&(i.bindAttribLocation(this.program,tt,d[tt]),this.attributes[d[tt]]=tt);if(i.linkProgram(this.program),!i.getProgramParameter(this.program,i.LINK_STATUS))throw new Error(`Program failed to link: ${i.getProgramInfoLog(this.program)}`);i.deleteShader(Fe),i.deleteShader(ke);for(let tt=0;tt<Z.length;tt++){const wt=Z[tt];if(wt&&!ze[wt]){const lt=i.getUniformLocation(this.program,wt);lt&&(ze[wt]=lt)}}this.fixedUniforms=V(A,ze),this.terrainUniforms=((tt,wt)=>({u_depth:new a.aL(tt,wt.u_depth),u_terrain:new a.aL(tt,wt.u_terrain),u_terrain_dim:new a.aM(tt,wt.u_terrain_dim),u_terrain_matrix:new a.aN(tt,wt.u_terrain_matrix),u_terrain_unpack:new a.aO(tt,wt.u_terrain_unpack),u_terrain_exaggeration:new a.aM(tt,wt.u_terrain_exaggeration)}))(A,ze),this.binderUniforms=O?O.getUniforms(A,ze):[]}draw(A,C,O,V,x,s,i,r,l,d,y,I,k,z,Z,Y,Ae,Ie){const ke=A.gl;if(this.failedToCreate)return;if(A.program.set(this.program),A.setDepthMode(O),A.setStencilMode(V),A.setColorMode(x),A.setCullFace(s),r){A.activeTexture.set(ke.TEXTURE2),ke.bindTexture(ke.TEXTURE_2D,r.depthTexture),A.activeTexture.set(ke.TEXTURE3),ke.bindTexture(ke.TEXTURE_2D,r.texture);for(const ze in this.terrainUniforms)this.terrainUniforms[ze].set(r[ze])}for(const ze in this.fixedUniforms)this.fixedUniforms[ze].set(i[ze]);Z&&Z.setUniforms(A,this.binderUniforms,k,{zoom:z});let Fe=0;switch(C){case ke.LINES:Fe=2;break;case ke.TRIANGLES:Fe=3;break;case ke.LINE_STRIP:Fe=1}for(const ze of I.get()){const tt=ze.vaos||(ze.vaos={});(tt[l]||(tt[l]=new Bt)).bind(A,this,d,Z?Z.getPaintVertexBuffers():[],y,ze.vertexOffset,Y,Ae,Ie),ke.drawElements(C,ze.primitiveLength*Fe,ke.UNSIGNED_SHORT,ze.primitiveOffset*Fe*2)}}}function pa(Q,A,C){const O=1/Oe(C,1,A.transform.tileZoom),V=Math.pow(2,C.tileID.overscaledZ),x=C.tileSize*Math.pow(2,A.transform.tileZoom)/V,s=x*(C.tileID.canonical.x+C.tileID.wrap*V),i=x*C.tileID.canonical.y;return{u_image:0,u_texsize:C.imageAtlasTexture.size,u_scale:[O,Q.fromScale,Q.toScale],u_fade:Q.t,u_pixel_coord_upper:[s>>16,i>>16],u_pixel_coord_lower:[65535&s,65535&i]}}const Fr=(Q,A,C,O)=>{const V=A.style.light,x=V.properties.get("position"),s=[x.x,x.y,x.z],i=function(){var l=new a.A(9);return a.A!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}();V.properties.get("anchor")==="viewport"&&function(l,d){var y=Math.sin(d),I=Math.cos(d);l[0]=I,l[1]=y,l[2]=0,l[3]=-y,l[4]=I,l[5]=0,l[6]=0,l[7]=0,l[8]=1}(i,-A.transform.angle),function(l,d,y){var I=d[0],k=d[1],z=d[2];l[0]=I*y[0]+k*y[3]+z*y[6],l[1]=I*y[1]+k*y[4]+z*y[7],l[2]=I*y[2]+k*y[5]+z*y[8]}(s,s,i);const r=V.properties.get("color");return{u_matrix:Q,u_lightpos:s,u_lightintensity:V.properties.get("intensity"),u_lightcolor:[r.r,r.g,r.b],u_vertical_gradient:+C,u_opacity:O}},Za=(Q,A,C,O,V,x,s)=>a.e(Fr(Q,A,C,O),pa(x,A,s),{u_height_factor:-Math.pow(2,V.overscaledZ)/s.tileSize/8}),Oo=Q=>({u_matrix:Q}),Qa=(Q,A,C,O)=>a.e(Oo(Q),pa(C,A,O)),ia=(Q,A)=>({u_matrix:Q,u_world:A}),Qn=(Q,A,C,O,V)=>a.e(Qa(Q,A,C,O),{u_world:V}),Aa=(Q,A,C,O)=>{const V=Q.transform;let x,s;if(O.paint.get("circle-pitch-alignment")==="map"){const i=Oe(C,1,V.zoom);x=!0,s=[i,i]}else x=!1,s=V.pixelsToGLUnits;return{u_camera_to_center_distance:V.cameraToCenterDistance,u_scale_with_map:+(O.paint.get("circle-pitch-scale")==="map"),u_matrix:Q.translatePosMatrix(A.posMatrix,C,O.paint.get("circle-translate"),O.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:Q.pixelRatio,u_extrude_scale:s}},ds=(Q,A,C)=>{const O=Oe(C,1,A.zoom),V=Math.pow(2,A.zoom-C.tileID.overscaledZ),x=C.tileID.overscaleFactor();return{u_matrix:Q,u_camera_to_center_distance:A.cameraToCenterDistance,u_pixels_to_tile_units:O,u_extrude_scale:[A.pixelsToGLUnits[0]/(O*V),A.pixelsToGLUnits[1]/(O*V)],u_overscale_factor:x}},Wa=(Q,A,C=1)=>({u_matrix:Q,u_color:A,u_overlay:0,u_overlay_scale:C}),ol=Q=>({u_matrix:Q}),ll=(Q,A,C,O)=>({u_matrix:Q,u_extrude_scale:Oe(A,1,C),u_intensity:O});function lo(Q,A){const C=Math.pow(2,A.canonical.z),O=A.canonical.y;return[new a.U(0,O/C).toLngLat().lat,new a.U(0,(O+1)/C).toLngLat().lat]}const $a=(Q,A,C,O)=>{const V=Q.transform;return{u_matrix:Yt(Q,A,C,O),u_ratio:1/Oe(A,1,V.zoom),u_device_pixel_ratio:Q.pixelRatio,u_units_to_pixels:[1/V.pixelsToGLUnits[0],1/V.pixelsToGLUnits[1]]}},G=(Q,A,C,O,V)=>a.e($a(Q,A,C,V),{u_image:0,u_image_height:O}),we=(Q,A,C,O,V)=>{const x=Q.transform,s=Ct(A,x);return{u_matrix:Yt(Q,A,C,V),u_texsize:A.imageAtlasTexture.size,u_ratio:1/Oe(A,1,x.zoom),u_device_pixel_ratio:Q.pixelRatio,u_image:0,u_scale:[s,O.fromScale,O.toScale],u_fade:O.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},at=(Q,A,C,O,V,x)=>{const s=Q.lineAtlas,i=Ct(A,Q.transform),r=C.layout.get("line-cap")==="round",l=s.getDash(O.from,r),d=s.getDash(O.to,r),y=l.width*V.fromScale,I=d.width*V.toScale;return a.e($a(Q,A,C,x),{u_patternscale_a:[i/y,-l.height/2],u_patternscale_b:[i/I,-d.height/2],u_sdfgamma:s.width/(256*Math.min(y,I)*Q.pixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:d.y,u_mix:V.t})};function Ct(Q,A){return 1/Oe(Q,1,A.tileZoom)}function Yt(Q,A,C,O){return Q.translatePosMatrix(O?O.posMatrix:A.tileID.posMatrix,A,C.paint.get("line-translate"),C.paint.get("line-translate-anchor"))}const Ii=(Q,A,C,O,V)=>{return{u_matrix:Q,u_tl_parent:A,u_scale_parent:C,u_buffer_scale:1,u_fade_t:O.mix,u_opacity:O.opacity*V.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:V.paint.get("raster-brightness-min"),u_brightness_high:V.paint.get("raster-brightness-max"),u_saturation_factor:(s=V.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(x=V.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Li(V.paint.get("raster-hue-rotate"))};var x,s};function Li(Q){Q*=Math.PI/180;const A=Math.sin(Q),C=Math.cos(Q);return[(2*C+1)/3,(-Math.sqrt(3)*A-C+1)/3,(Math.sqrt(3)*A-C+1)/3]}const An=(Q,A,C,O,V,x,s,i,r,l)=>{const d=V.transform;return{u_is_size_zoom_constant:+(Q==="constant"||Q==="source"),u_is_size_feature_constant:+(Q==="constant"||Q==="camera"),u_size_t:A?A.uSizeT:0,u_size:A?A.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+C,u_aspect_ratio:d.width/d.height,u_fade_change:V.options.fadeDuration?V.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:s,u_coord_matrix:i,u_is_text:+r,u_pitch_with_map:+O,u_texsize:l,u_texture:0}},pn=(Q,A,C,O,V,x,s,i,r,l,d)=>{const y=V.transform;return a.e(An(Q,A,C,O,V,x,s,i,r,l),{u_gamma_scale:O?Math.cos(y._pitch)*y.cameraToCenterDistance:1,u_device_pixel_ratio:V.pixelRatio,u_is_halo:+d})},or=(Q,A,C,O,V,x,s,i,r,l)=>a.e(pn(Q,A,C,O,V,x,s,i,!0,r,!0),{u_texsize_icon:l,u_texture_icon:1}),dr=(Q,A,C)=>({u_matrix:Q,u_opacity:A,u_color:C}),qr=(Q,A,C,O,V,x)=>a.e(function(s,i,r,l){const d=r.imageManager.getPattern(s.from.toString()),y=r.imageManager.getPattern(s.to.toString()),{width:I,height:k}=r.imageManager.getPixelSize(),z=Math.pow(2,l.tileID.overscaledZ),Z=l.tileSize*Math.pow(2,r.transform.tileZoom)/z,Y=Z*(l.tileID.canonical.x+l.tileID.wrap*z),Ae=Z*l.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:d.tl,u_pattern_br_a:d.br,u_pattern_tl_b:y.tl,u_pattern_br_b:y.br,u_texsize:[I,k],u_mix:i.t,u_pattern_size_a:d.displaySize,u_pattern_size_b:y.displaySize,u_scale_a:i.fromScale,u_scale_b:i.toScale,u_tile_units_to_pixels:1/Oe(l,1,r.transform.tileZoom),u_pixel_coord_upper:[Y>>16,Ae>>16],u_pixel_coord_lower:[65535&Y,65535&Ae]}}(O,x,C,V),{u_matrix:Q,u_opacity:A}),Xa={fillExtrusion:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_lightpos:new a.aP(Q,A.u_lightpos),u_lightintensity:new a.aM(Q,A.u_lightintensity),u_lightcolor:new a.aP(Q,A.u_lightcolor),u_vertical_gradient:new a.aM(Q,A.u_vertical_gradient),u_opacity:new a.aM(Q,A.u_opacity)}),fillExtrusionPattern:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_lightpos:new a.aP(Q,A.u_lightpos),u_lightintensity:new a.aM(Q,A.u_lightintensity),u_lightcolor:new a.aP(Q,A.u_lightcolor),u_vertical_gradient:new a.aM(Q,A.u_vertical_gradient),u_height_factor:new a.aM(Q,A.u_height_factor),u_image:new a.aL(Q,A.u_image),u_texsize:new a.aQ(Q,A.u_texsize),u_pixel_coord_upper:new a.aQ(Q,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Q,A.u_pixel_coord_lower),u_scale:new a.aP(Q,A.u_scale),u_fade:new a.aM(Q,A.u_fade),u_opacity:new a.aM(Q,A.u_opacity)}),fill:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix)}),fillPattern:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_image:new a.aL(Q,A.u_image),u_texsize:new a.aQ(Q,A.u_texsize),u_pixel_coord_upper:new a.aQ(Q,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Q,A.u_pixel_coord_lower),u_scale:new a.aP(Q,A.u_scale),u_fade:new a.aM(Q,A.u_fade)}),fillOutline:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_world:new a.aQ(Q,A.u_world)}),fillOutlinePattern:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_world:new a.aQ(Q,A.u_world),u_image:new a.aL(Q,A.u_image),u_texsize:new a.aQ(Q,A.u_texsize),u_pixel_coord_upper:new a.aQ(Q,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Q,A.u_pixel_coord_lower),u_scale:new a.aP(Q,A.u_scale),u_fade:new a.aM(Q,A.u_fade)}),circle:(Q,A)=>({u_camera_to_center_distance:new a.aM(Q,A.u_camera_to_center_distance),u_scale_with_map:new a.aL(Q,A.u_scale_with_map),u_pitch_with_map:new a.aL(Q,A.u_pitch_with_map),u_extrude_scale:new a.aQ(Q,A.u_extrude_scale),u_device_pixel_ratio:new a.aM(Q,A.u_device_pixel_ratio),u_matrix:new a.aN(Q,A.u_matrix)}),collisionBox:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_camera_to_center_distance:new a.aM(Q,A.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aM(Q,A.u_pixels_to_tile_units),u_extrude_scale:new a.aQ(Q,A.u_extrude_scale),u_overscale_factor:new a.aM(Q,A.u_overscale_factor)}),collisionCircle:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_inv_matrix:new a.aN(Q,A.u_inv_matrix),u_camera_to_center_distance:new a.aM(Q,A.u_camera_to_center_distance),u_viewport_size:new a.aQ(Q,A.u_viewport_size)}),debug:(Q,A)=>({u_color:new a.aR(Q,A.u_color),u_matrix:new a.aN(Q,A.u_matrix),u_overlay:new a.aL(Q,A.u_overlay),u_overlay_scale:new a.aM(Q,A.u_overlay_scale)}),clippingMask:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix)}),heatmap:(Q,A)=>({u_extrude_scale:new a.aM(Q,A.u_extrude_scale),u_intensity:new a.aM(Q,A.u_intensity),u_matrix:new a.aN(Q,A.u_matrix)}),heatmapTexture:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_world:new a.aQ(Q,A.u_world),u_image:new a.aL(Q,A.u_image),u_color_ramp:new a.aL(Q,A.u_color_ramp),u_opacity:new a.aM(Q,A.u_opacity)}),hillshade:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_image:new a.aL(Q,A.u_image),u_latrange:new a.aQ(Q,A.u_latrange),u_light:new a.aQ(Q,A.u_light),u_shadow:new a.aR(Q,A.u_shadow),u_highlight:new a.aR(Q,A.u_highlight),u_accent:new a.aR(Q,A.u_accent)}),hillshadePrepare:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_image:new a.aL(Q,A.u_image),u_dimension:new a.aQ(Q,A.u_dimension),u_zoom:new a.aM(Q,A.u_zoom),u_unpack:new a.aO(Q,A.u_unpack)}),line:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_ratio:new a.aM(Q,A.u_ratio),u_device_pixel_ratio:new a.aM(Q,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Q,A.u_units_to_pixels)}),lineGradient:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_ratio:new a.aM(Q,A.u_ratio),u_device_pixel_ratio:new a.aM(Q,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Q,A.u_units_to_pixels),u_image:new a.aL(Q,A.u_image),u_image_height:new a.aM(Q,A.u_image_height)}),linePattern:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_texsize:new a.aQ(Q,A.u_texsize),u_ratio:new a.aM(Q,A.u_ratio),u_device_pixel_ratio:new a.aM(Q,A.u_device_pixel_ratio),u_image:new a.aL(Q,A.u_image),u_units_to_pixels:new a.aQ(Q,A.u_units_to_pixels),u_scale:new a.aP(Q,A.u_scale),u_fade:new a.aM(Q,A.u_fade)}),lineSDF:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_ratio:new a.aM(Q,A.u_ratio),u_device_pixel_ratio:new a.aM(Q,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Q,A.u_units_to_pixels),u_patternscale_a:new a.aQ(Q,A.u_patternscale_a),u_patternscale_b:new a.aQ(Q,A.u_patternscale_b),u_sdfgamma:new a.aM(Q,A.u_sdfgamma),u_image:new a.aL(Q,A.u_image),u_tex_y_a:new a.aM(Q,A.u_tex_y_a),u_tex_y_b:new a.aM(Q,A.u_tex_y_b),u_mix:new a.aM(Q,A.u_mix)}),raster:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_tl_parent:new a.aQ(Q,A.u_tl_parent),u_scale_parent:new a.aM(Q,A.u_scale_parent),u_buffer_scale:new a.aM(Q,A.u_buffer_scale),u_fade_t:new a.aM(Q,A.u_fade_t),u_opacity:new a.aM(Q,A.u_opacity),u_image0:new a.aL(Q,A.u_image0),u_image1:new a.aL(Q,A.u_image1),u_brightness_low:new a.aM(Q,A.u_brightness_low),u_brightness_high:new a.aM(Q,A.u_brightness_high),u_saturation_factor:new a.aM(Q,A.u_saturation_factor),u_contrast_factor:new a.aM(Q,A.u_contrast_factor),u_spin_weights:new a.aP(Q,A.u_spin_weights)}),symbolIcon:(Q,A)=>({u_is_size_zoom_constant:new a.aL(Q,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Q,A.u_is_size_feature_constant),u_size_t:new a.aM(Q,A.u_size_t),u_size:new a.aM(Q,A.u_size),u_camera_to_center_distance:new a.aM(Q,A.u_camera_to_center_distance),u_pitch:new a.aM(Q,A.u_pitch),u_rotate_symbol:new a.aL(Q,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Q,A.u_aspect_ratio),u_fade_change:new a.aM(Q,A.u_fade_change),u_matrix:new a.aN(Q,A.u_matrix),u_label_plane_matrix:new a.aN(Q,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Q,A.u_coord_matrix),u_is_text:new a.aL(Q,A.u_is_text),u_pitch_with_map:new a.aL(Q,A.u_pitch_with_map),u_texsize:new a.aQ(Q,A.u_texsize),u_texture:new a.aL(Q,A.u_texture)}),symbolSDF:(Q,A)=>({u_is_size_zoom_constant:new a.aL(Q,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Q,A.u_is_size_feature_constant),u_size_t:new a.aM(Q,A.u_size_t),u_size:new a.aM(Q,A.u_size),u_camera_to_center_distance:new a.aM(Q,A.u_camera_to_center_distance),u_pitch:new a.aM(Q,A.u_pitch),u_rotate_symbol:new a.aL(Q,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Q,A.u_aspect_ratio),u_fade_change:new a.aM(Q,A.u_fade_change),u_matrix:new a.aN(Q,A.u_matrix),u_label_plane_matrix:new a.aN(Q,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Q,A.u_coord_matrix),u_is_text:new a.aL(Q,A.u_is_text),u_pitch_with_map:new a.aL(Q,A.u_pitch_with_map),u_texsize:new a.aQ(Q,A.u_texsize),u_texture:new a.aL(Q,A.u_texture),u_gamma_scale:new a.aM(Q,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Q,A.u_device_pixel_ratio),u_is_halo:new a.aL(Q,A.u_is_halo)}),symbolTextAndIcon:(Q,A)=>({u_is_size_zoom_constant:new a.aL(Q,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Q,A.u_is_size_feature_constant),u_size_t:new a.aM(Q,A.u_size_t),u_size:new a.aM(Q,A.u_size),u_camera_to_center_distance:new a.aM(Q,A.u_camera_to_center_distance),u_pitch:new a.aM(Q,A.u_pitch),u_rotate_symbol:new a.aL(Q,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Q,A.u_aspect_ratio),u_fade_change:new a.aM(Q,A.u_fade_change),u_matrix:new a.aN(Q,A.u_matrix),u_label_plane_matrix:new a.aN(Q,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Q,A.u_coord_matrix),u_is_text:new a.aL(Q,A.u_is_text),u_pitch_with_map:new a.aL(Q,A.u_pitch_with_map),u_texsize:new a.aQ(Q,A.u_texsize),u_texsize_icon:new a.aQ(Q,A.u_texsize_icon),u_texture:new a.aL(Q,A.u_texture),u_texture_icon:new a.aL(Q,A.u_texture_icon),u_gamma_scale:new a.aM(Q,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Q,A.u_device_pixel_ratio),u_is_halo:new a.aL(Q,A.u_is_halo)}),background:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_opacity:new a.aM(Q,A.u_opacity),u_color:new a.aR(Q,A.u_color)}),backgroundPattern:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_opacity:new a.aM(Q,A.u_opacity),u_image:new a.aL(Q,A.u_image),u_pattern_tl_a:new a.aQ(Q,A.u_pattern_tl_a),u_pattern_br_a:new a.aQ(Q,A.u_pattern_br_a),u_pattern_tl_b:new a.aQ(Q,A.u_pattern_tl_b),u_pattern_br_b:new a.aQ(Q,A.u_pattern_br_b),u_texsize:new a.aQ(Q,A.u_texsize),u_mix:new a.aM(Q,A.u_mix),u_pattern_size_a:new a.aQ(Q,A.u_pattern_size_a),u_pattern_size_b:new a.aQ(Q,A.u_pattern_size_b),u_scale_a:new a.aM(Q,A.u_scale_a),u_scale_b:new a.aM(Q,A.u_scale_b),u_pixel_coord_upper:new a.aQ(Q,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Q,A.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aM(Q,A.u_tile_units_to_pixels)}),terrain:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_texture:new a.aL(Q,A.u_texture),u_ele_delta:new a.aM(Q,A.u_ele_delta)}),terrainDepth:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_ele_delta:new a.aM(Q,A.u_ele_delta)}),terrainCoords:(Q,A)=>({u_matrix:new a.aN(Q,A.u_matrix),u_texture:new a.aL(Q,A.u_texture),u_terrain_coords_id:new a.aM(Q,A.u_terrain_coords_id),u_ele_delta:new a.aM(Q,A.u_ele_delta)})};class Ya{constructor(A,C,O){this.context=A;const V=A.gl;this.buffer=V.createBuffer(),this.dynamicDraw=!!O,this.context.unbindVAO(),A.bindElementBuffer.set(this.buffer),V.bufferData(V.ELEMENT_ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?V.DYNAMIC_DRAW:V.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(A){const C=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),C.bufferSubData(C.ELEMENT_ARRAY_BUFFER,0,A.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ka={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ml{constructor(A,C,O,V){this.length=C.length,this.attributes=O,this.itemSize=C.bytesPerElement,this.dynamicDraw=V,this.context=A;const x=A.gl;this.buffer=x.createBuffer(),A.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(A){if(A.length!==this.length)throw new Error(`Length of new data is ${A.length}, which doesn't match current length of ${this.length}`);const C=this.context.gl;this.bind(),C.bufferSubData(C.ARRAY_BUFFER,0,A.arrayBuffer)}enableAttributes(A,C){for(let O=0;O<this.attributes.length;O++){const V=C.attributes[this.attributes[O].name];V!==void 0&&A.enableVertexAttribArray(V)}}setVertexAttribPointers(A,C,O){for(let V=0;V<this.attributes.length;V++){const x=this.attributes[V],s=C.attributes[x.name];s!==void 0&&A.vertexAttribPointer(s,x.components,A[Ka[x.type]],!1,this.itemSize,x.offset+this.itemSize*(O||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Wr=new WeakMap;function sr(Q){var A;if(Wr.has(Q))return Wr.get(Q);{const C=(A=Q.getParameter(Q.VERSION))===null||A===void 0?void 0:A.startsWith("WebGL 2.0");return Wr.set(Q,C),C}}class Mr{constructor(A){this.gl=A.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(A){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Or extends Mr{getDefault(){return a.aT.transparent}set(A){const C=this.current;(A.r!==C.r||A.g!==C.g||A.b!==C.b||A.a!==C.a||this.dirty)&&(this.gl.clearColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Ys extends Mr{getDefault(){return 1}set(A){(A!==this.current||this.dirty)&&(this.gl.clearDepth(A),this.current=A,this.dirty=!1)}}class Sr extends Mr{getDefault(){return 0}set(A){(A!==this.current||this.dirty)&&(this.gl.clearStencil(A),this.current=A,this.dirty=!1)}}class ra extends Mr{getDefault(){return[!0,!0,!0,!0]}set(A){const C=this.current;(A[0]!==C[0]||A[1]!==C[1]||A[2]!==C[2]||A[3]!==C[3]||this.dirty)&&(this.gl.colorMask(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class Nr extends Mr{getDefault(){return!0}set(A){(A!==this.current||this.dirty)&&(this.gl.depthMask(A),this.current=A,this.dirty=!1)}}class ko extends Mr{getDefault(){return 255}set(A){(A!==this.current||this.dirty)&&(this.gl.stencilMask(A),this.current=A,this.dirty=!1)}}class Qo extends Mr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(A){const C=this.current;(A.func!==C.func||A.ref!==C.ref||A.mask!==C.mask||this.dirty)&&(this.gl.stencilFunc(A.func,A.ref,A.mask),this.current=A,this.dirty=!1)}}class Ns extends Mr{getDefault(){const A=this.gl;return[A.KEEP,A.KEEP,A.KEEP]}set(A){const C=this.current;(A[0]!==C[0]||A[1]!==C[1]||A[2]!==C[2]||this.dirty)&&(this.gl.stencilOp(A[0],A[1],A[2]),this.current=A,this.dirty=!1)}}class Tl extends Mr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;A?C.enable(C.STENCIL_TEST):C.disable(C.STENCIL_TEST),this.current=A,this.dirty=!1}}class yo extends Mr{getDefault(){return[0,1]}set(A){const C=this.current;(A[0]!==C[0]||A[1]!==C[1]||this.dirty)&&(this.gl.depthRange(A[0],A[1]),this.current=A,this.dirty=!1)}}class Wo extends Mr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;A?C.enable(C.DEPTH_TEST):C.disable(C.DEPTH_TEST),this.current=A,this.dirty=!1}}class ma extends Mr{getDefault(){return this.gl.LESS}set(A){(A!==this.current||this.dirty)&&(this.gl.depthFunc(A),this.current=A,this.dirty=!1)}}class na extends Mr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;A?C.enable(C.BLEND):C.disable(C.BLEND),this.current=A,this.dirty=!1}}class kl extends Mr{getDefault(){const A=this.gl;return[A.ONE,A.ZERO]}set(A){const C=this.current;(A[0]!==C[0]||A[1]!==C[1]||this.dirty)&&(this.gl.blendFunc(A[0],A[1]),this.current=A,this.dirty=!1)}}class Ja extends Mr{getDefault(){return a.aT.transparent}set(A){const C=this.current;(A.r!==C.r||A.g!==C.g||A.b!==C.b||A.a!==C.a||this.dirty)&&(this.gl.blendColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Fa extends Mr{getDefault(){return this.gl.FUNC_ADD}set(A){(A!==this.current||this.dirty)&&(this.gl.blendEquation(A),this.current=A,this.dirty=!1)}}class gl extends Mr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;A?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE),this.current=A,this.dirty=!1}}class Ml extends Mr{getDefault(){return this.gl.BACK}set(A){(A!==this.current||this.dirty)&&(this.gl.cullFace(A),this.current=A,this.dirty=!1)}}class yu extends Mr{getDefault(){return this.gl.CCW}set(A){(A!==this.current||this.dirty)&&(this.gl.frontFace(A),this.current=A,this.dirty=!1)}}class ps extends Mr{getDefault(){return null}set(A){(A!==this.current||this.dirty)&&(this.gl.useProgram(A),this.current=A,this.dirty=!1)}}class lc extends Mr{getDefault(){return this.gl.TEXTURE0}set(A){(A!==this.current||this.dirty)&&(this.gl.activeTexture(A),this.current=A,this.dirty=!1)}}class uo extends Mr{getDefault(){const A=this.gl;return[0,0,A.drawingBufferWidth,A.drawingBufferHeight]}set(A){const C=this.current;(A[0]!==C[0]||A[1]!==C[1]||A[2]!==C[2]||A[3]!==C[3]||this.dirty)&&(this.gl.viewport(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class co extends Mr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;C.bindFramebuffer(C.FRAMEBUFFER,A),this.current=A,this.dirty=!1}}class Xl extends Mr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;C.bindRenderbuffer(C.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class No extends Mr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;C.bindTexture(C.TEXTURE_2D,A),this.current=A,this.dirty=!1}}class $o extends Mr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;C.bindBuffer(C.ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Mo extends Mr{getDefault(){return null}set(A){const C=this.gl;C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Qs extends Mr{getDefault(){return null}set(A){var C;if(A===this.current&&!this.dirty)return;const O=this.gl;sr(O)?O.bindVertexArray(A):(C=O.getExtension("OES_vertex_array_object"))===null||C===void 0||C.bindVertexArrayOES(A),this.current=A,this.dirty=!1}}class Xo extends Mr{getDefault(){return 4}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;C.pixelStorei(C.UNPACK_ALIGNMENT,A),this.current=A,this.dirty=!1}}class Yo extends Mr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),this.current=A,this.dirty=!1}}class Ko extends Mr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const C=this.gl;C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,A),this.current=A,this.dirty=!1}}class Ta extends Mr{constructor(A,C){super(A),this.context=A,this.parent=C}getDefault(){return null}}class eo extends Ta{setDirty(){this.dirty=!0}set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const C=this.gl;C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_2D,A,0),this.current=A,this.dirty=!1}}class Ds extends Ta{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const C=this.gl;C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class vu extends Ta{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const C=this.gl;C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_STENCIL_ATTACHMENT,C.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Pr{constructor(A,C,O,V,x){this.context=A,this.width=C,this.height=O;const s=A.gl,i=this.framebuffer=s.createFramebuffer();if(this.colorAttachment=new eo(A,i),V)this.depthAttachment=x?new vu(A,i):new Ds(A,i);else if(x)throw new Error("Stencil cannot be setted without depth");if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const A=this.context.gl,C=this.colorAttachment.get();if(C&&A.deleteTexture(C),this.depthAttachment){const O=this.depthAttachment.get();O&&A.deleteRenderbuffer(O)}A.deleteFramebuffer(this.framebuffer)}}class Kn{constructor(A,C,O){this.blendFunction=A,this.blendColor=C,this.mask=O}}Kn.Replace=[1,0],Kn.disabled=new Kn(Kn.Replace,a.aT.transparent,[!1,!1,!1,!1]),Kn.unblended=new Kn(Kn.Replace,a.aT.transparent,[!0,!0,!0,!0]),Kn.alphaBlended=new Kn([1,771],a.aT.transparent,[!0,!0,!0,!0]);class Jo{constructor(A){var C,O;if(this.gl=A,this.clearColor=new Or(this),this.clearDepth=new Ys(this),this.clearStencil=new Sr(this),this.colorMask=new ra(this),this.depthMask=new Nr(this),this.stencilMask=new ko(this),this.stencilFunc=new Qo(this),this.stencilOp=new Ns(this),this.stencilTest=new Tl(this),this.depthRange=new yo(this),this.depthTest=new Wo(this),this.depthFunc=new ma(this),this.blend=new na(this),this.blendFunc=new kl(this),this.blendColor=new Ja(this),this.blendEquation=new Fa(this),this.cullFace=new gl(this),this.cullFaceSide=new Ml(this),this.frontFace=new yu(this),this.program=new ps(this),this.activeTexture=new lc(this),this.viewport=new uo(this),this.bindFramebuffer=new co(this),this.bindRenderbuffer=new Xl(this),this.bindTexture=new No(this),this.bindVertexBuffer=new $o(this),this.bindElementBuffer=new Mo(this),this.bindVertexArray=new Qs(this),this.pixelStoreUnpack=new Xo(this),this.pixelStoreUnpackPremultiplyAlpha=new Yo(this),this.pixelStoreUnpackFlipY=new Ko(this),this.extTextureFilterAnisotropic=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=A.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=A.getParameter(A.MAX_TEXTURE_SIZE),sr(A)){this.HALF_FLOAT=A.HALF_FLOAT;const V=A.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(C=A.RGBA16F)!==null&&C!==void 0?C:V==null?void 0:V.RGBA16F_EXT,this.RGB16F=(O=A.RGB16F)!==null&&O!==void 0?O:V==null?void 0:V.RGB16F_EXT,A.getExtension("EXT_color_buffer_float")}else{A.getExtension("EXT_color_buffer_half_float"),A.getExtension("OES_texture_half_float_linear");const V=A.getExtension("OES_texture_half_float");this.HALF_FLOAT=V==null?void 0:V.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(A,C){return new Ya(this,A,C)}createVertexBuffer(A,C,O){return new ml(this,A,C,O)}createRenderbuffer(A,C,O){const V=this.gl,x=V.createRenderbuffer();return this.bindRenderbuffer.set(x),V.renderbufferStorage(V.RENDERBUFFER,A,C,O),this.bindRenderbuffer.set(null),x}createFramebuffer(A,C,O,V){return new Pr(this,A,C,O,V)}clear({color:A,depth:C,stencil:O}){const V=this.gl;let x=0;A&&(x|=V.COLOR_BUFFER_BIT,this.clearColor.set(A),this.colorMask.set([!0,!0,!0,!0])),C!==void 0&&(x|=V.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(C),this.depthMask.set(!0)),O!==void 0&&(x|=V.STENCIL_BUFFER_BIT,this.clearStencil.set(O),this.stencilMask.set(255)),V.clear(x)}setCullFace(A){A.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(A.mode),this.frontFace.set(A.frontFace))}setDepthMode(A){A.func!==this.gl.ALWAYS||A.mask?(this.depthTest.set(!0),this.depthFunc.set(A.func),this.depthMask.set(A.mask),this.depthRange.set(A.range)):this.depthTest.set(!1)}setStencilMode(A){A.test.func!==this.gl.ALWAYS||A.mask?(this.stencilTest.set(!0),this.stencilMask.set(A.mask),this.stencilOp.set([A.fail,A.depthFail,A.pass]),this.stencilFunc.set({func:A.test.func,ref:A.ref,mask:A.test.mask})):this.stencilTest.set(!1)}setColorMode(A){a.aG(A.blendFunction,Kn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(A.blendFunction),this.blendColor.set(A.blendColor)),this.colorMask.set(A.mask)}createVertexArray(){var A;return sr(this.gl)?this.gl.createVertexArray():(A=this.gl.getExtension("OES_vertex_array_object"))===null||A===void 0?void 0:A.createVertexArrayOES()}deleteVertexArray(A){var C;return sr(this.gl)?this.gl.deleteVertexArray(A):(C=this.gl.getExtension("OES_vertex_array_object"))===null||C===void 0?void 0:C.deleteVertexArrayOES(A)}unbindVAO(){this.bindVertexArray.set(null)}}class Vr{constructor(A,C,O){this.func=A,this.mask=C,this.range=O}}Vr.ReadOnly=!1,Vr.ReadWrite=!0,Vr.disabled=new Vr(519,Vr.ReadOnly,[0,1]);const to=7680;class ss{constructor(A,C,O,V,x,s){this.test=A,this.ref=C,this.mask=O,this.fail=V,this.depthFail=x,this.pass=s}}ss.disabled=new ss({func:519,mask:0},0,0,to,to,to);class pr{constructor(A,C,O){this.enable=A,this.mode=C,this.frontFace=O}}let Po;function qn(Q,A,C,O,V,x,s){const i=Q.context,r=i.gl,l=Q.useProgram("collisionBox"),d=[];let y=0,I=0;for(let ke=0;ke<O.length;ke++){const Fe=O[ke],ze=A.getTile(Fe),tt=ze.getBucket(C);if(!tt)continue;let wt=Fe.posMatrix;V[0]===0&&V[1]===0||(wt=Q.translatePosMatrix(Fe.posMatrix,ze,V,x));const lt=s?tt.textCollisionBox:tt.iconCollisionBox,ft=tt.collisionCircleArray;if(ft.length>0){const Tt=a.Z(),It=wt;a.aU(Tt,tt.placementInvProjMatrix,Q.transform.glCoordMatrix),a.aU(Tt,Tt,tt.placementViewportMatrix),d.push({circleArray:ft,circleOffset:I,transform:It,invTransform:Tt,coord:Fe}),y+=ft.length/4,I=y}lt&&l.draw(i,r.LINES,Vr.disabled,ss.disabled,Q.colorModeForRenderPass(),pr.disabled,ds(wt,Q.transform,ze),Q.style.map.terrain&&Q.style.map.terrain.getTerrainData(Fe),C.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,null,Q.transform.zoom,null,null,lt.collisionVertexBuffer)}if(!s||!d.length)return;const k=Q.useProgram("collisionCircle"),z=new a.aV;z.resize(4*y),z._trim();let Z=0;for(const ke of d)for(let Fe=0;Fe<ke.circleArray.length/4;Fe++){const ze=4*Fe,tt=ke.circleArray[ze+0],wt=ke.circleArray[ze+1],lt=ke.circleArray[ze+2],ft=ke.circleArray[ze+3];z.emplace(Z++,tt,wt,lt,ft,0),z.emplace(Z++,tt,wt,lt,ft,1),z.emplace(Z++,tt,wt,lt,ft,2),z.emplace(Z++,tt,wt,lt,ft,3)}(!Po||Po.length<2*y)&&(Po=function(ke){const Fe=2*ke,ze=new a.aX;ze.resize(Fe),ze._trim();for(let tt=0;tt<Fe;tt++){const wt=6*tt;ze.uint16[wt+0]=4*tt+0,ze.uint16[wt+1]=4*tt+1,ze.uint16[wt+2]=4*tt+2,ze.uint16[wt+3]=4*tt+2,ze.uint16[wt+4]=4*tt+3,ze.uint16[wt+5]=4*tt+0}return ze}(y));const Y=i.createIndexBuffer(Po,!0),Ae=i.createVertexBuffer(z,a.aW.members,!0);for(const ke of d){const Fe={u_matrix:ke.transform,u_inv_matrix:ke.invTransform,u_camera_to_center_distance:(Ie=Q.transform).cameraToCenterDistance,u_viewport_size:[Ie.width,Ie.height]};k.draw(i,r.TRIANGLES,Vr.disabled,ss.disabled,Q.colorModeForRenderPass(),pr.disabled,Fe,Q.style.map.terrain&&Q.style.map.terrain.getTerrainData(ke.coord),C.id,Ae,Y,a.S.simpleSegment(0,2*ke.circleOffset,ke.circleArray.length,ke.circleArray.length/2),null,Q.transform.zoom,null,null,null)}var Ie;Ae.destroy(),Y.destroy()}pr.disabled=new pr(!1,1029,2305),pr.backCCW=new pr(!0,1029,2305);const Ul=a.ao(new Float32Array(16));function as(Q,A,C,O,V,x){const{horizontalAlign:s,verticalAlign:i}=a.au(Q);return new a.P((-(s-.5)*A/V+O[0])*x,(-(i-.5)*C/V+O[1])*x)}function Kr(Q,A,C,O,V,x,s,i,r,l,d){const y=Q.text.placedSymbolArray,I=Q.text.dynamicLayoutVertexArray,k=Q.icon.dynamicLayoutVertexArray,z={};I.clear();for(let Z=0;Z<y.length;Z++){const Y=y.get(Z),Ae=Y.hidden||!Y.crossTileID||Q.allowVerticalPlacement&&!Y.placedOrientation?null:O[Y.crossTileID];if(Ae){const Ie=new a.P(Y.anchorX,Y.anchorY),ke=Ce(Ie,C?s:x,d),Fe=Re(V.cameraToCenterDistance,ke.signedDistanceFromCamera);let ze=a.aj(Q.textSizeData,r,Y)*Fe/a.ap;C&&(ze*=Q.tilePixelRatio/i);const{width:tt,height:wt,anchor:lt,textOffset:ft,textBoxScale:Tt}=Ae,It=as(lt,tt,wt,ft,Tt,ze),si=C?Ce(Ie.add(It),x,d).point:ke.point.add(A?It.rotate(-V.angle):It),Kt=Q.allowVerticalPlacement&&Y.placedOrientation===a.ai.vertical?Math.PI/2:0;for(let ii=0;ii<Y.numGlyphs;ii++)a.ak(I,si,Kt);l&&Y.associatedIconIndex>=0&&(z[Y.associatedIconIndex]={shiftedAnchor:si,angle:Kt})}else pe(Y.numGlyphs,I)}if(l){k.clear();const Z=Q.icon.placedSymbolArray;for(let Y=0;Y<Z.length;Y++){const Ae=Z.get(Y);if(Ae.hidden)pe(Ae.numGlyphs,k);else{const Ie=z[Y];if(Ie)for(let ke=0;ke<Ae.numGlyphs;ke++)a.ak(k,Ie.shiftedAnchor,Ie.angle);else pe(Ae.numGlyphs,k)}}Q.icon.dynamicLayoutVertexBuffer.updateData(k)}Q.text.dynamicLayoutVertexBuffer.updateData(I)}function Ls(Q,A,C){return C.iconsInText&&A?"symbolTextAndIcon":Q?"symbolSDF":"symbolIcon"}function Br(Q,A,C,O,V,x,s,i,r,l,d,y){const I=Q.context,k=I.gl,z=Q.transform,Z=i==="map",Y=r==="map",Ae=i!=="viewport"&&C.layout.get("symbol-placement")!=="point",Ie=Z&&!Y&&!Ae,ke=!C.layout.get("symbol-sort-key").isConstant();let Fe=!1;const ze=Q.depthModeForSublayer(0,Vr.ReadOnly),tt=C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"),wt=[];for(const lt of O){const ft=A.getTile(lt),Tt=ft.getBucket(C);if(!Tt)continue;const It=V?Tt.text:Tt.icon;if(!It||!It.segments.get().length||!It.hasVisibleVertices)continue;const si=It.programConfigurations.get(C.id),Kt=V||Tt.sdfIcons,ii=V?Tt.textSizeData:Tt.iconSizeData,ai=Y||z.pitch!==0,Wi=Q.useProgram(Ls(Kt,V,Tt),si),$i=a.ah(ii,z.zoom),Ei=Q.style.map.terrain&&Q.style.map.terrain.getTerrainData(lt);let Hi,ji,cn,Nn,nn=[0,0],Mn=null;if(V)ji=ft.glyphAtlasTexture,cn=k.LINEAR,Hi=ft.glyphAtlasTexture.size,Tt.iconsInText&&(nn=ft.imageAtlasTexture.size,Mn=ft.imageAtlasTexture,Nn=ai||Q.options.rotating||Q.options.zooming||ii.kind==="composite"||ii.kind==="camera"?k.LINEAR:k.NEAREST);else{const Ks=C.layout.get("icon-size").constantOr(0)!==1||Tt.iconsNeedLinear;ji=ft.imageAtlasTexture,cn=Kt||Q.options.rotating||Q.options.zooming||Ks||ai?k.LINEAR:k.NEAREST,Hi=ft.imageAtlasTexture.size}const wr=Oe(ft,1,Q.transform.zoom),nr=be(lt.posMatrix,Y,Z,Q.transform,wr),Pa=Ee(lt.posMatrix,Y,Z,Q.transform,wr),_a=tt&&Tt.hasTextData(),Vs=C.layout.get("icon-text-fit")!=="none"&&_a&&Tt.hasIconData();if(Ae){const Ks=Q.style.map.terrain?(ls,Ur)=>Q.style.map.terrain.getElevation(lt,ls,Ur):null,os=C.layout.get("text-rotation-alignment")==="map";je(Tt,lt.posMatrix,Q,V,nr,Pa,Y,l,os,Ks)}const Ao=Q.translatePosMatrix(lt.posMatrix,ft,x,s),fo=Ae||V&&tt||Vs?Ul:nr,$r=Q.translatePosMatrix(Pa,ft,x,s,!0),Sa=Kt&&C.paint.get(V?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let So;So=Kt?Tt.iconsInText?or(ii.kind,$i,Ie,Y,Q,Ao,fo,$r,Hi,nn):pn(ii.kind,$i,Ie,Y,Q,Ao,fo,$r,V,Hi,!0):An(ii.kind,$i,Ie,Y,Q,Ao,fo,$r,V,Hi);const Io={program:Wi,buffers:It,uniformValues:So,atlasTexture:ji,atlasTextureIcon:Mn,atlasInterpolation:cn,atlasInterpolationIcon:Nn,isSDF:Kt,hasHalo:Sa};if(ke&&Tt.canOverlap){Fe=!0;const Ks=It.segments.get();for(const os of Ks)wt.push({segments:new a.S([os]),sortKey:os.sortKey,state:Io,terrainData:Ei})}else wt.push({segments:It.segments,sortKey:0,state:Io,terrainData:Ei})}Fe&&wt.sort((lt,ft)=>lt.sortKey-ft.sortKey);for(const lt of wt){const ft=lt.state;if(I.activeTexture.set(k.TEXTURE0),ft.atlasTexture.bind(ft.atlasInterpolation,k.CLAMP_TO_EDGE),ft.atlasTextureIcon&&(I.activeTexture.set(k.TEXTURE1),ft.atlasTextureIcon&&ft.atlasTextureIcon.bind(ft.atlasInterpolationIcon,k.CLAMP_TO_EDGE)),ft.isSDF){const Tt=ft.uniformValues;ft.hasHalo&&(Tt.u_is_halo=1,ar(ft.buffers,lt.segments,C,Q,ft.program,ze,d,y,Tt,lt.terrainData)),Tt.u_is_halo=0}ar(ft.buffers,lt.segments,C,Q,ft.program,ze,d,y,ft.uniformValues,lt.terrainData)}}function ar(Q,A,C,O,V,x,s,i,r,l){const d=O.context;V.draw(d,d.gl.TRIANGLES,x,s,i,pr.disabled,r,l,C.id,Q.layoutVertexBuffer,Q.indexBuffer,A,C.paint,O.transform.zoom,Q.programConfigurations.get(C.id),Q.dynamicLayoutVertexBuffer,Q.opacityVertexBuffer)}function ul(Q,A,C,O,V){if(!C||!O||!O.imageAtlas)return;const x=O.imageAtlas.patternPositions;let s=x[C.to.toString()],i=x[C.from.toString()];if(!s&&i&&(s=i),!i&&s&&(i=s),!s||!i){const r=V.getPaintProperty(A);s=x[r],i=x[r]}s&&i&&Q.setConstantPatternPositions(s,i)}function is(Q,A,C,O,V,x,s){const i=Q.context.gl,r="fill-pattern",l=C.paint.get(r),d=l&&l.constantOr(1),y=C.getCrossfadeParameters();let I,k,z,Z,Y;s?(k=d&&!C.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",I=i.LINES):(k=d?"fillPattern":"fill",I=i.TRIANGLES);const Ae=l.constantOr(null);for(const Ie of O){const ke=A.getTile(Ie);if(d&&!ke.patternsLoaded())continue;const Fe=ke.getBucket(C);if(!Fe)continue;const ze=Fe.programConfigurations.get(C.id),tt=Q.useProgram(k,ze),wt=Q.style.map.terrain&&Q.style.map.terrain.getTerrainData(Ie);d&&(Q.context.activeTexture.set(i.TEXTURE0),ke.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),ze.updatePaintBuffers(y)),ul(ze,r,Ae,ke,C);const lt=wt?Ie:null,ft=Q.translatePosMatrix(lt?lt.posMatrix:Ie.posMatrix,ke,C.paint.get("fill-translate"),C.paint.get("fill-translate-anchor"));if(s){Z=Fe.indexBuffer2,Y=Fe.segments2;const Tt=[i.drawingBufferWidth,i.drawingBufferHeight];z=k==="fillOutlinePattern"&&d?Qn(ft,Q,y,ke,Tt):ia(ft,Tt)}else Z=Fe.indexBuffer,Y=Fe.segments,z=d?Qa(ft,Q,y,ke):Oo(ft);tt.draw(Q.context,I,V,Q.stencilModeForClipping(Ie),x,pr.disabled,z,wt,C.id,Fe.layoutVertexBuffer,Z,Y,C.paint,Q.transform.zoom,ze)}}function Do(Q,A,C,O,V,x,s){const i=Q.context,r=i.gl,l="fill-extrusion-pattern",d=C.paint.get(l),y=d.constantOr(1),I=C.getCrossfadeParameters(),k=C.paint.get("fill-extrusion-opacity"),z=d.constantOr(null);for(const Z of O){const Y=A.getTile(Z),Ae=Y.getBucket(C);if(!Ae)continue;const Ie=Q.style.map.terrain&&Q.style.map.terrain.getTerrainData(Z),ke=Ae.programConfigurations.get(C.id),Fe=Q.useProgram(y?"fillExtrusionPattern":"fillExtrusion",ke);y&&(Q.context.activeTexture.set(r.TEXTURE0),Y.imageAtlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE),ke.updatePaintBuffers(I)),ul(ke,l,z,Y,C);const ze=Q.translatePosMatrix(Z.posMatrix,Y,C.paint.get("fill-extrusion-translate"),C.paint.get("fill-extrusion-translate-anchor")),tt=C.paint.get("fill-extrusion-vertical-gradient"),wt=y?Za(ze,Q,tt,k,Z,I,Y):Fr(ze,Q,tt,k);Fe.draw(i,i.gl.TRIANGLES,V,x,s,pr.backCCW,wt,Ie,C.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,C.paint,Q.transform.zoom,ke,Q.style.map.terrain&&Ae.centroidVertexBuffer)}}function cl(Q,A,C,O,V,x,s){const i=Q.context,r=i.gl,l=C.fbo;if(!l)return;const d=Q.useProgram("hillshade"),y=Q.style.map.terrain&&Q.style.map.terrain.getTerrainData(A);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.colorAttachment.get()),d.draw(i,r.TRIANGLES,V,x,s,pr.disabled,((I,k,z,Z)=>{const Y=z.paint.get("hillshade-shadow-color"),Ae=z.paint.get("hillshade-highlight-color"),Ie=z.paint.get("hillshade-accent-color");let ke=z.paint.get("hillshade-illumination-direction")*(Math.PI/180);z.paint.get("hillshade-illumination-anchor")==="viewport"&&(ke-=I.transform.angle);const Fe=!I.options.moving;return{u_matrix:Z?Z.posMatrix:I.transform.calculatePosMatrix(k.tileID.toUnwrapped(),Fe),u_image:0,u_latrange:lo(0,k.tileID),u_light:[z.paint.get("hillshade-exaggeration"),ke],u_shadow:Y,u_highlight:Ae,u_accent:Ie}})(Q,C,O,y?A:null),y,O.id,Q.rasterBoundsBuffer,Q.quadTriangleIndexBuffer,Q.rasterBoundsSegments)}function Jr(Q,A,C,O,V,x){const s=Q.context,i=s.gl,r=A.dem;if(r&&r.data){const l=r.dim,d=r.stride,y=r.getPixels();if(s.activeTexture.set(i.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),A.demTexture=A.demTexture||Q.getTileTexture(d),A.demTexture){const k=A.demTexture;k.update(y,{premultiply:!1}),k.bind(i.NEAREST,i.CLAMP_TO_EDGE)}else A.demTexture=new At(s,y,i.RGBA,{premultiply:!1}),A.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE);s.activeTexture.set(i.TEXTURE0);let I=A.fbo;if(!I){const k=new At(s,{width:l,height:l,data:null},i.RGBA);k.bind(i.LINEAR,i.CLAMP_TO_EDGE),I=A.fbo=s.createFramebuffer(l,l,!0,!1),I.colorAttachment.set(k.texture)}s.bindFramebuffer.set(I.framebuffer),s.viewport.set([0,0,l,l]),Q.useProgram("hillshadePrepare").draw(s,i.TRIANGLES,O,V,x,pr.disabled,((k,z)=>{const Z=z.stride,Y=a.Z();return a.aS(Y,0,a.N,-a.N,0,0,1),a.$(Y,Y,[0,-a.N,0]),{u_matrix:Y,u_image:1,u_dimension:[Z,Z],u_zoom:k.overscaledZ,u_unpack:z.getUnpackVector()}})(A.tileID,r),null,C.id,Q.rasterBoundsBuffer,Q.quadTriangleIndexBuffer,Q.rasterBoundsSegments),A.needsHillshadePrepare=!1}}function gs(Q,A,C,O,V,x){const s=O.paint.get("raster-fade-duration");if(!x&&s>0){const i=a.h.now(),r=(i-Q.timeAdded)/s,l=A?(i-A.timeAdded)/s:-1,d=C.getSource(),y=V.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),I=!A||Math.abs(A.tileID.overscaledZ-y)>Math.abs(Q.tileID.overscaledZ-y),k=I&&Q.refreshedUponExpiration?1:a.ad(I?r:1-l,0,1);return Q.refreshedUponExpiration&&r>=1&&(Q.refreshedUponExpiration=!1),A?{opacity:1,mix:1-k}:{opacity:k,mix:0}}return{opacity:1,mix:0}}const ka=new a.aT(1,0,0,1),Pl=new a.aT(0,1,0,1),Lo=new a.aT(0,0,1,1),Dl=new a.aT(1,0,1,1),vo=new a.aT(0,1,1,1);function sa(Q,A,C,O){io(Q,0,A+C/2,Q.transform.width,C,O)}function Ws(Q,A,C,O){io(Q,A-C/2,0,C,Q.transform.height,O)}function io(Q,A,C,O,V,x){const s=Q.context,i=s.gl;i.enable(i.SCISSOR_TEST),i.scissor(A*Q.pixelRatio,C*Q.pixelRatio,O*Q.pixelRatio,V*Q.pixelRatio),s.clear({color:x}),i.disable(i.SCISSOR_TEST)}function el(Q,A,C){const O=Q.context,V=O.gl,x=C.posMatrix,s=Q.useProgram("debug"),i=Vr.disabled,r=ss.disabled,l=Q.colorModeForRenderPass(),d="$debug",y=Q.style.map.terrain&&Q.style.map.terrain.getTerrainData(C);O.activeTexture.set(V.TEXTURE0);const I=A.getTileByID(C.key).latestRawTileData,k=Math.floor((I&&I.byteLength||0)/1024),z=A.getTile(C).tileSize,Z=512/Math.min(z,512)*(C.overscaledZ/Q.transform.zoom)*.5;let Y=C.canonical.toString();C.overscaledZ!==C.canonical.z&&(Y+=` => ${C.overscaledZ}`),function(Ae,Ie){Ae.initDebugOverlayCanvas();const ke=Ae.debugOverlayCanvas,Fe=Ae.context.gl,ze=Ae.debugOverlayCanvas.getContext("2d");ze.clearRect(0,0,ke.width,ke.height),ze.shadowColor="white",ze.shadowBlur=2,ze.lineWidth=1.5,ze.strokeStyle="white",ze.textBaseline="top",ze.font="bold 36px Open Sans, sans-serif",ze.fillText(Ie,5,5),ze.strokeText(Ie,5,5),Ae.debugOverlayTexture.update(ke),Ae.debugOverlayTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}(Q,`${Y} ${k}kB`),s.draw(O,V.TRIANGLES,i,r,Kn.alphaBlended,pr.disabled,Wa(x,a.aT.transparent,Z),null,d,Q.debugBuffer,Q.quadTriangleIndexBuffer,Q.debugSegments),s.draw(O,V.LINE_STRIP,i,r,l,pr.disabled,Wa(x,a.aT.red),y,d,Q.debugBuffer,Q.tileBorderIndexBuffer,Q.debugSegments)}function ns(Q,A,C){const O=Q.context,V=O.gl,x=Q.colorModeForRenderPass(),s=new Vr(V.LEQUAL,Vr.ReadWrite,Q.depthRangeFor3D),i=Q.useProgram("terrain"),r=A.getTerrainMesh();O.bindFramebuffer.set(null),O.viewport.set([0,0,Q.width,Q.height]);for(const l of C){const d=Q.renderToTexture.getTexture(l),y=A.getTerrainData(l.tileID);O.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,d.texture);const I={u_matrix:Q.transform.calculatePosMatrix(l.tileID.toUnwrapped()),u_texture:0,u_ele_delta:A.getMeshFrameDelta(Q.transform.zoom)};i.draw(O,V.TRIANGLES,s,ss.disabled,x,pr.backCCW,I,y,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}class vr{constructor(A,C){this.context=new Jo(A),this.transform=C,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.Z(),renderTime:0},this.setup(),this.numSublayers=Yi.maxUnderzooming+Yi.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gn}resize(A,C,O){if(this.width=Math.floor(A*O),this.height=Math.floor(C*O),this.pixelRatio=O,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const V of this.style._order)this.style._layers[V].resize()}setup(){const A=this.context,C=new a.a_;C.emplaceBack(0,0),C.emplaceBack(a.N,0),C.emplaceBack(0,a.N),C.emplaceBack(a.N,a.N),this.tileExtentBuffer=A.createVertexBuffer(C,js.members),this.tileExtentSegments=a.S.simpleSegment(0,0,4,2);const O=new a.a_;O.emplaceBack(0,0),O.emplaceBack(a.N,0),O.emplaceBack(0,a.N),O.emplaceBack(a.N,a.N),this.debugBuffer=A.createVertexBuffer(O,js.members),this.debugSegments=a.S.simpleSegment(0,0,4,5);const V=new a.V;V.emplaceBack(0,0,0,0),V.emplaceBack(a.N,0,a.N,0),V.emplaceBack(0,a.N,0,a.N),V.emplaceBack(a.N,a.N,a.N,a.N),this.rasterBoundsBuffer=A.createVertexBuffer(V,Ti.members),this.rasterBoundsSegments=a.S.simpleSegment(0,0,4,2);const x=new a.a_;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=A.createVertexBuffer(x,js.members),this.viewportSegments=a.S.simpleSegment(0,0,4,2);const s=new a.a$;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=A.createIndexBuffer(s);const i=new a.b0;i.emplaceBack(0,1,2),i.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=A.createIndexBuffer(i);const r=this.context.gl;this.stencilClearMode=new ss({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO)}clearStencil(){const A=this.context,C=A.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const O=a.Z();a.aS(O,0,this.width,this.height,0,0,1),a.a0(O,O,[C.drawingBufferWidth,C.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(A,C.TRIANGLES,Vr.disabled,this.stencilClearMode,Kn.disabled,pr.disabled,ol(O),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(A,C){if(this.currentStencilSource===A.source||!A.isTileClipped()||!C||!C.length)return;this.currentStencilSource=A.source;const O=this.context,V=O.gl;this.nextStencilID+C.length>256&&this.clearStencil(),O.setColorMode(Kn.disabled),O.setDepthMode(Vr.disabled);const x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const s of C){const i=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,r=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s);x.draw(O,V.TRIANGLES,Vr.disabled,new ss({func:V.ALWAYS,mask:0},i,255,V.KEEP,V.KEEP,V.REPLACE),Kn.disabled,pr.disabled,ol(s.posMatrix),r,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const A=this.nextStencilID++,C=this.context.gl;return new ss({func:C.NOTEQUAL,mask:255},A,255,C.KEEP,C.KEEP,C.REPLACE)}stencilModeForClipping(A){const C=this.context.gl;return new ss({func:C.EQUAL,mask:255},this._tileClippingMaskIDs[A.key],0,C.KEEP,C.KEEP,C.REPLACE)}stencilConfigForOverlap(A){const C=this.context.gl,O=A.sort((s,i)=>i.overscaledZ-s.overscaledZ),V=O[O.length-1].overscaledZ,x=O[0].overscaledZ-V+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const s={};for(let i=0;i<x;i++)s[i+V]=new ss({func:C.GEQUAL,mask:255},i+this.nextStencilID,255,C.KEEP,C.KEEP,C.REPLACE);return this.nextStencilID+=x,[s,O]}return[{[V]:ss.disabled},O]}colorModeForRenderPass(){const A=this.context.gl;return this._showOverdrawInspector?new Kn([A.CONSTANT_COLOR,A.ONE],new a.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Kn.unblended:Kn.alphaBlended}depthModeForSublayer(A,C,O){if(!this.opaquePassEnabledForLayer())return Vr.disabled;const V=1-((1+this.currentLayer)*this.numSublayers+A)*this.depthEpsilon;return new Vr(O||this.context.gl.LEQUAL,C,[V,V])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(A,C){this.style=A,this.options=C,this.lineAtlas=A.lineAtlas,this.imageManager=A.imageManager,this.glyphManager=A.glyphManager,this.symbolFadeChange=A.placement.symbolFadeChange(a.h.now()),this.imageManager.beginFrame();const O=this.style._order,V=this.style.sourceCaches,x={},s={},i={};for(const r in V){const l=V[r];l.used&&l.prepare(this.context),x[r]=l.getVisibleCoordinates(),s[r]=x[r].slice().reverse(),i[r]=l.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let r=0;r<O.length;r++)if(this.style._layers[O[r]].is3D()){this.opaquePassCutoff=r;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||r.length)&&(a.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(l,d){const y=l.context,I=y.gl,k=Kn.unblended,z=new Vr(I.LEQUAL,Vr.ReadWrite,[0,1]),Z=d.getTerrainMesh(),Y=d.sourceCache.getRenderableTiles(),Ae=l.useProgram("terrainDepth");y.bindFramebuffer.set(d.getFramebuffer("depth").framebuffer),y.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),y.clear({color:a.aT.transparent,depth:1});for(const Ie of Y){const ke=d.getTerrainData(Ie.tileID),Fe={u_matrix:l.transform.calculatePosMatrix(Ie.tileID.toUnwrapped()),u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};Ae.draw(y,I.TRIANGLES,z,ss.disabled,k,pr.backCCW,Fe,ke,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments)}y.bindFramebuffer.set(null),y.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain),function(l,d){const y=l.context,I=y.gl,k=Kn.unblended,z=new Vr(I.LEQUAL,Vr.ReadWrite,[0,1]),Z=d.getTerrainMesh(),Y=d.getCoordsTexture(),Ae=d.sourceCache.getRenderableTiles(),Ie=l.useProgram("terrainCoords");y.bindFramebuffer.set(d.getFramebuffer("coords").framebuffer),y.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),y.clear({color:a.aT.transparent,depth:1}),d.coordsIndex=[];for(const ke of Ae){const Fe=d.getTerrainData(ke.tileID);y.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,Y.texture);const ze={u_matrix:l.transform.calculatePosMatrix(ke.tileID.toUnwrapped()),u_terrain_coords_id:(255-d.coordsIndex.length)/255,u_texture:0,u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};Ie.draw(y,I.TRIANGLES,z,ss.disabled,k,pr.backCCW,ze,Fe,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments),d.coordsIndex.push(ke.tileID.key)}y.bindFramebuffer.set(null),y.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const r of O){const l=this.style._layers[r];if(!l.hasOffscreenPass()||l.isHidden(this.transform.zoom))continue;const d=s[l.source];(l.type==="custom"||d.length)&&this.renderLayer(this,V[l.source],l,d)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:C.showOverdrawInspector?a.aT.black:a.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=C.showOverdrawInspector,this.depthRangeFor3D=[0,1-(A._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=O.length-1;this.currentLayer>=0;this.currentLayer--){const r=this.style._layers[O[this.currentLayer]],l=V[r.source],d=x[r.source];this._renderTileClippingMasks(r,d),this.renderLayer(this,l,r,d)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<O.length;this.currentLayer++){const r=this.style._layers[O[this.currentLayer]],l=V[r.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(r))continue;const d=(r.type==="symbol"?i:s)[r.source];this._renderTileClippingMasks(r,x[r.source]),this.renderLayer(this,l,r,d)}if(this.options.showTileBoundaries){const r=function(l,d){let y=null;const I=Object.values(l._layers).flatMap(Y=>Y.source&&!Y.isHidden(d)?[l.sourceCaches[Y.source]]:[]),k=I.filter(Y=>Y.getSource().type==="vector"),z=I.filter(Y=>Y.getSource().type!=="vector"),Z=Y=>{(!y||y.getSource().maxzoom<Y.getSource().maxzoom)&&(y=Y)};return k.forEach(Y=>Z(Y)),y||z.forEach(Y=>Z(Y)),y}(this.style,this.transform.zoom);r&&function(l,d,y){for(let I=0;I<y.length;I++)el(l,d,y[I])}(this,r,r.getVisibleCoordinates())}this.options.showPadding&&function(r){const l=r.transform.padding;sa(r,r.transform.height-(l.top||0),3,ka),sa(r,l.bottom||0,3,Pl),Ws(r,l.left||0,3,Lo),Ws(r,r.transform.width-(l.right||0),3,Dl);const d=r.transform.centerPoint;(function(y,I,k,z){io(y,I-1,k-10,2,20,z),io(y,I-10,k-1,20,2,z)})(r,d.x,r.transform.height-d.y,vo)}(this),this.context.setDefault()}renderLayer(A,C,O,V){if(!O.isHidden(this.transform.zoom)&&(O.type==="background"||O.type==="custom"||(V||[]).length))switch(this.id=O.id,O.type){case"symbol":(function(x,s,i,r,l){if(x.renderPass!=="translucent")return;const d=ss.disabled,y=x.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(I,k,z,Z,Y,Ae,Ie){const ke=k.transform,Fe=Y==="map",ze=Ae==="map";for(const tt of I){const wt=Z.getTile(tt),lt=wt.getBucket(z);if(!lt||!lt.text||!lt.text.segments.get().length)continue;const ft=a.ah(lt.textSizeData,ke.zoom),Tt=Oe(wt,1,k.transform.zoom),It=be(tt.posMatrix,ze,Fe,k.transform,Tt),si=z.layout.get("icon-text-fit")!=="none"&&lt.hasIconData();if(ft){const Kt=Math.pow(2,ke.zoom-wt.tileID.overscaledZ);Kr(lt,Fe,ze,Ie,ke,It,tt.posMatrix,Kt,ft,si,k.style.map.terrain?(ii,ai)=>k.style.map.terrain.getElevation(tt,ii,ai):null)}}}(r,x,i,s,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),l),i.paint.get("icon-opacity").constantOr(1)!==0&&Br(x,s,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),d,y),i.paint.get("text-opacity").constantOr(1)!==0&&Br(x,s,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),d,y),s.map.showCollisionBoxes&&(qn(x,s,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),qn(x,s,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))})(A,C,O,V,this.style.placement.variableOffsets);break;case"circle":(function(x,s,i,r){if(x.renderPass!=="translucent")return;const l=i.paint.get("circle-opacity"),d=i.paint.get("circle-stroke-width"),y=i.paint.get("circle-stroke-opacity"),I=!i.layout.get("circle-sort-key").isConstant();if(l.constantOr(1)===0&&(d.constantOr(1)===0||y.constantOr(1)===0))return;const k=x.context,z=k.gl,Z=x.depthModeForSublayer(0,Vr.ReadOnly),Y=ss.disabled,Ae=x.colorModeForRenderPass(),Ie=[];for(let ke=0;ke<r.length;ke++){const Fe=r[ke],ze=s.getTile(Fe),tt=ze.getBucket(i);if(!tt)continue;const wt=tt.programConfigurations.get(i.id),lt=x.useProgram("circle",wt),ft=tt.layoutVertexBuffer,Tt=tt.indexBuffer,It=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Fe),si={programConfiguration:wt,program:lt,layoutVertexBuffer:ft,indexBuffer:Tt,uniformValues:Aa(x,Fe,ze,i),terrainData:It};if(I){const Kt=tt.segments.get();for(const ii of Kt)Ie.push({segments:new a.S([ii]),sortKey:ii.sortKey,state:si})}else Ie.push({segments:tt.segments,sortKey:0,state:si})}I&&Ie.sort((ke,Fe)=>ke.sortKey-Fe.sortKey);for(const ke of Ie){const{programConfiguration:Fe,program:ze,layoutVertexBuffer:tt,indexBuffer:wt,uniformValues:lt,terrainData:ft}=ke.state;ze.draw(k,z.TRIANGLES,Z,Y,Ae,pr.disabled,lt,ft,i.id,tt,wt,ke.segments,i.paint,x.transform.zoom,Fe)}})(A,C,O,V);break;case"heatmap":(function(x,s,i,r){if(i.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){const l=x.context,d=l.gl,y=ss.disabled,I=new Kn([d.ONE,d.ONE],a.aT.transparent,[!0,!0,!0,!0]);(function(k,z,Z){const Y=k.gl;k.activeTexture.set(Y.TEXTURE1),k.viewport.set([0,0,z.width/4,z.height/4]);let Ae=Z.heatmapFbo;if(Ae)Y.bindTexture(Y.TEXTURE_2D,Ae.colorAttachment.get()),k.bindFramebuffer.set(Ae.framebuffer);else{const Ie=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,Ie),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),Ae=Z.heatmapFbo=k.createFramebuffer(z.width/4,z.height/4,!1,!1),function(ke,Fe,ze,tt){var wt,lt;const ft=ke.gl,Tt=(wt=ke.HALF_FLOAT)!==null&&wt!==void 0?wt:ft.UNSIGNED_BYTE,It=(lt=ke.RGBA16F)!==null&&lt!==void 0?lt:ft.RGBA;ft.texImage2D(ft.TEXTURE_2D,0,It,Fe.width/4,Fe.height/4,0,ft.RGBA,Tt,null),tt.colorAttachment.set(ze)}(k,z,Ie,Ae)}})(l,x,i),l.clear({color:a.aT.transparent});for(let k=0;k<r.length;k++){const z=r[k];if(s.hasRenderableParent(z))continue;const Z=s.getTile(z),Y=Z.getBucket(i);if(!Y)continue;const Ae=Y.programConfigurations.get(i.id),Ie=x.useProgram("heatmap",Ae),{zoom:ke}=x.transform;Ie.draw(l,d.TRIANGLES,Vr.disabled,y,I,pr.disabled,ll(z.posMatrix,Z,ke,i.paint.get("heatmap-intensity")),null,i.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,i.paint,x.transform.zoom,Ae)}l.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(l,d){const y=l.context,I=y.gl,k=d.heatmapFbo;if(!k)return;y.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,k.colorAttachment.get()),y.activeTexture.set(I.TEXTURE1);let z=d.colorRampTexture;z||(z=d.colorRampTexture=new At(y,d.colorRamp,I.RGBA)),z.bind(I.LINEAR,I.CLAMP_TO_EDGE),l.useProgram("heatmapTexture").draw(y,I.TRIANGLES,Vr.disabled,ss.disabled,l.colorModeForRenderPass(),pr.disabled,((Z,Y,Ae,Ie)=>{const ke=a.Z();a.aS(ke,0,Z.width,Z.height,0,0,1);const Fe=Z.context.gl;return{u_matrix:ke,u_world:[Fe.drawingBufferWidth,Fe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}})(l,d),null,d.id,l.viewportBuffer,l.quadTriangleIndexBuffer,l.viewportSegments,d.paint,l.transform.zoom)}(x,i))})(A,C,O,V);break;case"line":(function(x,s,i,r){if(x.renderPass!=="translucent")return;const l=i.paint.get("line-opacity"),d=i.paint.get("line-width");if(l.constantOr(1)===0||d.constantOr(1)===0)return;const y=x.depthModeForSublayer(0,Vr.ReadOnly),I=x.colorModeForRenderPass(),k=i.paint.get("line-dasharray"),z=i.paint.get("line-pattern"),Z=z.constantOr(1),Y=i.paint.get("line-gradient"),Ae=i.getCrossfadeParameters(),Ie=Z?"linePattern":k?"lineSDF":Y?"lineGradient":"line",ke=x.context,Fe=ke.gl;let ze=!0;for(const tt of r){const wt=s.getTile(tt);if(Z&&!wt.patternsLoaded())continue;const lt=wt.getBucket(i);if(!lt)continue;const ft=lt.programConfigurations.get(i.id),Tt=x.context.program.get(),It=x.useProgram(Ie,ft),si=ze||It.program!==Tt,Kt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(tt),ii=z.constantOr(null);if(ii&&wt.imageAtlas){const $i=wt.imageAtlas,Ei=$i.patternPositions[ii.to.toString()],Hi=$i.patternPositions[ii.from.toString()];Ei&&Hi&&ft.setConstantPatternPositions(Ei,Hi)}const ai=Kt?tt:null,Wi=Z?we(x,wt,i,Ae,ai):k?at(x,wt,i,k,Ae,ai):Y?G(x,wt,i,lt.lineClipsArray.length,ai):$a(x,wt,i,ai);if(Z)ke.activeTexture.set(Fe.TEXTURE0),wt.imageAtlasTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),ft.updatePaintBuffers(Ae);else if(k&&(si||x.lineAtlas.dirty))ke.activeTexture.set(Fe.TEXTURE0),x.lineAtlas.bind(ke);else if(Y){const $i=lt.gradients[i.id];let Ei=$i.texture;if(i.gradientVersion!==$i.version){let Hi=256;if(i.stepInterpolant){const ji=s.getSource().maxzoom,cn=tt.canonical.z===ji?Math.ceil(1<<x.transform.maxZoom-tt.canonical.z):1;Hi=a.ad(a.aY(lt.maxLineLength/a.N*1024*cn),256,ke.maxTextureSize)}$i.gradient=a.aZ({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Hi,image:$i.gradient||void 0,clips:lt.lineClipsArray}),$i.texture?$i.texture.update($i.gradient):$i.texture=new At(ke,$i.gradient,Fe.RGBA),$i.version=i.gradientVersion,Ei=$i.texture}ke.activeTexture.set(Fe.TEXTURE0),Ei.bind(i.stepInterpolant?Fe.NEAREST:Fe.LINEAR,Fe.CLAMP_TO_EDGE)}It.draw(ke,Fe.TRIANGLES,y,x.stencilModeForClipping(tt),I,pr.disabled,Wi,Kt,i.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,i.paint,x.transform.zoom,ft,lt.layoutVertexBuffer2),ze=!1}})(A,C,O,V);break;case"fill":(function(x,s,i,r){const l=i.paint.get("fill-color"),d=i.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const y=x.colorModeForRenderPass(),I=i.paint.get("fill-pattern"),k=x.opaquePassEnabledForLayer()&&!I.constantOr(1)&&l.constantOr(a.aT.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===k){const z=x.depthModeForSublayer(1,x.renderPass==="opaque"?Vr.ReadWrite:Vr.ReadOnly);is(x,s,i,r,z,y,!1)}if(x.renderPass==="translucent"&&i.paint.get("fill-antialias")){const z=x.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Vr.ReadOnly);is(x,s,i,r,z,y,!0)}})(A,C,O,V);break;case"fill-extrusion":(function(x,s,i,r){const l=i.paint.get("fill-extrusion-opacity");if(l!==0&&x.renderPass==="translucent"){const d=new Vr(x.context.gl.LEQUAL,Vr.ReadWrite,x.depthRangeFor3D);if(l!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))Do(x,s,i,r,d,ss.disabled,Kn.disabled),Do(x,s,i,r,d,x.stencilModeFor3D(),x.colorModeForRenderPass());else{const y=x.colorModeForRenderPass();Do(x,s,i,r,d,ss.disabled,y)}}})(A,C,O,V);break;case"hillshade":(function(x,s,i,r){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const l=x.context,d=x.depthModeForSublayer(0,Vr.ReadOnly),y=x.colorModeForRenderPass(),[I,k]=x.renderPass==="translucent"?x.stencilConfigForOverlap(r):[{},r];for(const z of k){const Z=s.getTile(z);Z.needsHillshadePrepare!==void 0&&Z.needsHillshadePrepare&&x.renderPass==="offscreen"?Jr(x,Z,i,d,ss.disabled,y):x.renderPass==="translucent"&&cl(x,z,Z,i,d,I[z.overscaledZ],y)}l.viewport.set([0,0,x.width,x.height])})(A,C,O,V);break;case"raster":(function(x,s,i,r){if(x.renderPass!=="translucent"||i.paint.get("raster-opacity")===0||!r.length)return;const l=x.context,d=l.gl,y=s.getSource(),I=x.useProgram("raster"),k=x.colorModeForRenderPass(),[z,Z]=y instanceof gi?[{},r]:x.stencilConfigForOverlap(r),Y=Z[Z.length-1].overscaledZ,Ae=!x.options.moving;for(const Ie of Z){const ke=x.depthModeForSublayer(Ie.overscaledZ-Y,i.paint.get("raster-opacity")===1?Vr.ReadWrite:Vr.ReadOnly,d.LESS),Fe=s.getTile(Ie);Fe.registerFadeDuration(i.paint.get("raster-fade-duration"));const ze=s.findLoadedParent(Ie,0),tt=gs(Fe,ze,s,i,x.transform,x.style.map.terrain);let wt,lt;const ft=i.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;l.activeTexture.set(d.TEXTURE0),Fe.texture.bind(ft,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.activeTexture.set(d.TEXTURE1),ze?(ze.texture.bind(ft,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),wt=Math.pow(2,ze.tileID.overscaledZ-Fe.tileID.overscaledZ),lt=[Fe.tileID.canonical.x*wt%1,Fe.tileID.canonical.y*wt%1]):Fe.texture.bind(ft,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Tt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ie),It=Tt?Ie:null,si=It?It.posMatrix:x.transform.calculatePosMatrix(Ie.toUnwrapped(),Ae),Kt=Ii(si,lt||[0,0],wt||1,tt,i);y instanceof gi?I.draw(l,d.TRIANGLES,ke,ss.disabled,k,pr.disabled,Kt,Tt,i.id,y.boundsBuffer,x.quadTriangleIndexBuffer,y.boundsSegments):I.draw(l,d.TRIANGLES,ke,z[Ie.overscaledZ],k,pr.disabled,Kt,Tt,i.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}})(A,C,O,V);break;case"background":(function(x,s,i,r){const l=i.paint.get("background-color"),d=i.paint.get("background-opacity");if(d===0)return;const y=x.context,I=y.gl,k=x.transform,z=k.tileSize,Z=i.paint.get("background-pattern");if(x.isPatternMissing(Z))return;const Y=!Z&&l.a===1&&d===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==Y)return;const Ae=ss.disabled,Ie=x.depthModeForSublayer(0,Y==="opaque"?Vr.ReadWrite:Vr.ReadOnly),ke=x.colorModeForRenderPass(),Fe=x.useProgram(Z?"backgroundPattern":"background"),ze=r||k.coveringTiles({tileSize:z,terrain:x.style.map.terrain});Z&&(y.activeTexture.set(I.TEXTURE0),x.imageManager.bind(x.context));const tt=i.getCrossfadeParameters();for(const wt of ze){const lt=r?wt.posMatrix:x.transform.calculatePosMatrix(wt.toUnwrapped()),ft=Z?qr(lt,d,x,Z,{tileID:wt,tileSize:z},tt):dr(lt,d,l),Tt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(wt);Fe.draw(y,I.TRIANGLES,Ie,Ae,ke,pr.disabled,ft,Tt,i.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}})(A,0,O,V);break;case"custom":(function(x,s,i){const r=x.context,l=i.implementation;if(x.renderPass==="offscreen"){const d=l.prerender;d&&(x.setCustomLayerDefaults(),r.setColorMode(x.colorModeForRenderPass()),d.call(l,r.gl,x.transform.customLayerMatrix()),r.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),r.setColorMode(x.colorModeForRenderPass()),r.setStencilMode(ss.disabled);const d=l.renderingMode==="3d"?new Vr(x.context.gl.LEQUAL,Vr.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,Vr.ReadOnly);r.setDepthMode(d),l.render(r.gl,x.transform.customLayerMatrix()),r.setDirty(),x.setBaseState(),r.bindFramebuffer.set(null)}})(A,0,O)}}translatePosMatrix(A,C,O,V,x){if(!O[0]&&!O[1])return A;const s=x?V==="map"?this.transform.angle:0:V==="viewport"?-this.transform.angle:0;if(s){const l=Math.sin(s),d=Math.cos(s);O=[O[0]*d-O[1]*l,O[0]*l+O[1]*d]}const i=[x?O[0]:Oe(C,O[0],this.transform.zoom),x?O[1]:Oe(C,O[1],this.transform.zoom),0],r=new Float32Array(16);return a.$(r,A,i),r}saveTileTexture(A){const C=this._tileTextures[A.size[0]];C?C.push(A):this._tileTextures[A.size[0]]=[A]}getTileTexture(A){const C=this._tileTextures[A];return C&&C.length>0?C.pop():null}isPatternMissing(A){if(!A)return!1;if(!A.from||!A.to)return!0;const C=this.imageManager.getPattern(A.from.toString()),O=this.imageManager.getPattern(A.to.toString());return!C||!O}useProgram(A,C){this.cache=this.cache||{};const O=A+(C?C.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[O]||(this.cache[O]=new Zs(this.context,Gt[A],C,Xa[A],this._showOverdrawInspector,this.style.map.terrain)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const A=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(A.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new At(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:A,drawingBufferHeight:C}=this.context.gl;return this.width!==A||this.height!==C}}class Hr{constructor(A,C){this.points=A,this.planes=C}static fromInvProjectionMatrix(A,C,O){const V=Math.pow(2,O),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const r=1/(i=a.ag([],i,A))[3]/C*V;return a.b3(i,i,[r,r,1/i[3],r])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(i=>{const r=function(I,k){var z=k[0],Z=k[1],Y=k[2],Ae=z*z+Z*Z+Y*Y;return Ae>0&&(Ae=1/Math.sqrt(Ae)),I[0]=k[0]*Ae,I[1]=k[1]*Ae,I[2]=k[2]*Ae,I}([],function(I,k,z){var Z=k[0],Y=k[1],Ae=k[2],Ie=z[0],ke=z[1],Fe=z[2];return I[0]=Y*Fe-Ae*ke,I[1]=Ae*Ie-Z*Fe,I[2]=Z*ke-Y*Ie,I}([],Ue([],x[i[0]],x[i[1]]),Ue([],x[i[2]],x[i[1]]))),l=-((d=r)[0]*(y=x[i[1]])[0]+d[1]*y[1]+d[2]*y[2]);var d,y;return r.concat(l)});return new Hr(x,s)}}class ga{constructor(A,C){this.min=A,this.max=C,this.center=function(O,V,x){return O[0]=.5*V[0],O[1]=.5*V[1],O[2]=.5*V[2],O}([],function(O,V,x){return O[0]=V[0]+x[0],O[1]=V[1]+x[1],O[2]=V[2]+x[2],O}([],this.min,this.max))}quadrant(A){const C=[A%2==0,A<2],O=zt(this.min),V=zt(this.max);for(let x=0;x<C.length;x++)O[x]=C[x]?this.min[x]:this.center[x],V[x]=C[x]?this.center[x]:this.max[x];return V[2]=this.max[2],new ga(O,V)}distanceX(A){return Math.max(Math.min(this.max[0],A[0]),this.min[0])-A[0]}distanceY(A){return Math.max(Math.min(this.max[1],A[1]),this.min[1])-A[1]}intersects(A){const C=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let O=!0;for(let V=0;V<A.planes.length;V++){const x=A.planes[V];let s=0;for(let i=0;i<C.length;i++)a.b4(x,C[i])>=0&&s++;if(s===0)return 0;s!==C.length&&(O=!1)}if(O)return 2;for(let V=0;V<3;V++){let x=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let i=0;i<A.points.length;i++){const r=A.points[i][V]-this.min[V];x=Math.min(x,r),s=Math.max(s,r)}if(s<0||x>this.max[V]-this.min[V])return 0}return 1}}class xo{constructor(A=0,C=0,O=0,V=0){if(isNaN(A)||A<0||isNaN(C)||C<0||isNaN(O)||O<0||isNaN(V)||V<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=A,this.bottom=C,this.left=O,this.right=V}interpolate(A,C,O){return C.top!=null&&A.top!=null&&(this.top=a.B.number(A.top,C.top,O)),C.bottom!=null&&A.bottom!=null&&(this.bottom=a.B.number(A.bottom,C.bottom,O)),C.left!=null&&A.left!=null&&(this.left=a.B.number(A.left,C.left,O)),C.right!=null&&A.right!=null&&(this.right=a.B.number(A.right,C.right,O)),this}getCenter(A,C){const O=a.ad((this.left+A-this.right)/2,0,A),V=a.ad((this.top+C-this.bottom)/2,0,C);return new a.P(O,V)}equals(A){return this.top===A.top&&this.bottom===A.bottom&&this.left===A.left&&this.right===A.right}clone(){return new xo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class aa{constructor(A,C,O,V,x){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=x===void 0||!!x,this._minZoom=A||0,this._maxZoom=C||22,this._minPitch=O??0,this._maxPitch=V??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new xo,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const A=new aa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return A.apply(this),A}apply(A){this.tileSize=A.tileSize,this.latRange=A.latRange,this.width=A.width,this.height=A.height,this._center=A._center,this._elevation=A._elevation,this._minEleveationForCurrentTile=A._minEleveationForCurrentTile,this.zoom=A.zoom,this.angle=A.angle,this._fov=A._fov,this._pitch=A._pitch,this._unmodified=A._unmodified,this._edgeInsets=A._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(A){this._minZoom!==A&&(this._minZoom=A,this.zoom=Math.max(this.zoom,A))}get maxZoom(){return this._maxZoom}set maxZoom(A){this._maxZoom!==A&&(this._maxZoom=A,this.zoom=Math.min(this.zoom,A))}get minPitch(){return this._minPitch}set minPitch(A){this._minPitch!==A&&(this._minPitch=A,this.pitch=Math.max(this.pitch,A))}get maxPitch(){return this._maxPitch}set maxPitch(A){this._maxPitch!==A&&(this._maxPitch=A,this.pitch=Math.min(this.pitch,A))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(A){A===void 0?A=!0:A===null&&(A=!1),this._renderWorldCopies=A}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(A){const C=-a.b5(A,-180,180)*Math.PI/180;this.angle!==C&&(this._unmodified=!1,this.angle=C,this._calcMatrices(),this.rotationMatrix=function(){var O=new a.A(4);return a.A!=Float32Array&&(O[1]=0,O[2]=0),O[0]=1,O[3]=1,O}(),function(O,V,x){var s=V[0],i=V[1],r=V[2],l=V[3],d=Math.sin(x),y=Math.cos(x);O[0]=s*y+r*d,O[1]=i*y+l*d,O[2]=s*-d+r*y,O[3]=i*-d+l*y}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(A){const C=a.ad(A,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==C&&(this._unmodified=!1,this._pitch=C,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(A){A=Math.max(.01,Math.min(60,A)),this._fov!==A&&(this._unmodified=!1,this._fov=A/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(A){const C=Math.min(Math.max(A,this.minZoom),this.maxZoom);this._zoom!==C&&(this._unmodified=!1,this._zoom=C,this.tileZoom=Math.max(0,Math.floor(C)),this.scale=this.zoomScale(C),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(A){A.lat===this._center.lat&&A.lng===this._center.lng||(this._unmodified=!1,this._center=A,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(A){A!==this._elevation&&(this._elevation=A,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(A){this._edgeInsets.equals(A)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,A,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(A){return this._edgeInsets.equals(A)}interpolatePadding(A,C,O){this._unmodified=!1,this._edgeInsets.interpolate(A,C,O),this._constrain(),this._calcMatrices()}coveringZoomLevel(A){const C=(A.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/A.tileSize));return Math.max(0,C)}getVisibleUnwrappedCoordinates(A){const C=[new a.b6(0,A)];if(this._renderWorldCopies){const O=this.pointCoordinate(new a.P(0,0)),V=this.pointCoordinate(new a.P(this.width,0)),x=this.pointCoordinate(new a.P(this.width,this.height)),s=this.pointCoordinate(new a.P(0,this.height)),i=Math.floor(Math.min(O.x,V.x,x.x,s.x)),r=Math.floor(Math.max(O.x,V.x,x.x,s.x)),l=1;for(let d=i-l;d<=r+l;d++)d!==0&&C.push(new a.b6(d,A))}return C}coveringTiles(A){var C,O;let V=this.coveringZoomLevel(A);const x=V;if(A.minzoom!==void 0&&V<A.minzoom)return[];A.maxzoom!==void 0&&V>A.maxzoom&&(V=A.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),i=a.U.fromLngLat(this.center),r=Math.pow(2,V),l=[r*s.x,r*s.y,0],d=[r*i.x,r*i.y,0],y=Hr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,V);let I=A.minzoom||0;!A.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(I=V);const k=A.terrain?2/Math.min(this.tileSize,A.tileSize)*this.tileSize:3,z=ke=>({aabb:new ga([ke*r,0,0],[(ke+1)*r,r,0]),zoom:0,x:0,y:0,wrap:ke,fullyVisible:!1}),Z=[],Y=[],Ae=V,Ie=A.reparseOverscaled?x:V;if(this._renderWorldCopies)for(let ke=1;ke<=3;ke++)Z.push(z(-ke)),Z.push(z(ke));for(Z.push(z(0));Z.length>0;){const ke=Z.pop(),Fe=ke.x,ze=ke.y;let tt=ke.fullyVisible;if(!tt){const It=ke.aabb.intersects(y);if(It===0)continue;tt=It===2}const wt=A.terrain?l:d,lt=ke.aabb.distanceX(wt),ft=ke.aabb.distanceY(wt),Tt=Math.max(Math.abs(lt),Math.abs(ft));if(ke.zoom===Ae||Tt>k+(1<<Ae-ke.zoom)-2&&ke.zoom>=I){const It=Ae-ke.zoom,si=l[0]-.5-(Fe<<It),Kt=l[1]-.5-(ze<<It);Y.push({tileID:new a.O(ke.zoom===Ae?Ie:ke.zoom,ke.wrap,ke.zoom,Fe,ze),distanceSq:$t([d[0]-.5-Fe,d[1]-.5-ze]),tileDistanceToCamera:Math.sqrt(si*si+Kt*Kt)})}else for(let It=0;It<4;It++){const si=(Fe<<1)+It%2,Kt=(ze<<1)+(It>>1),ii=ke.zoom+1;let ai=ke.aabb.quadrant(It);if(A.terrain){const Wi=new a.O(ii,ke.wrap,ii,si,Kt),$i=A.terrain.getMinMaxElevation(Wi),Ei=(C=$i.minElevation)!==null&&C!==void 0?C:this.elevation,Hi=(O=$i.maxElevation)!==null&&O!==void 0?O:this.elevation;ai=new ga([ai.min[0],ai.min[1],Ei],[ai.max[0],ai.max[1],Hi])}Z.push({aabb:ai,zoom:ii,x:si,y:Kt,wrap:ke.wrap,fullyVisible:tt})}}return Y.sort((ke,Fe)=>ke.distanceSq-Fe.distanceSq).map(ke=>ke.tileID)}resize(A,C){this.width=A,this.height=C,this.pixelsToGLUnits=[2/A,-2/C],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(A){return Math.pow(2,A)}scaleZoom(A){return Math.log(A)/Math.LN2}project(A){const C=a.ad(A.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.G(A.lng)*this.worldSize,a.H(C)*this.worldSize)}unproject(A){return new a.U(A.x/this.worldSize,A.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(A){const C=this.pointLocation(this.centerPoint,A),O=A.getElevationForLngLatZoom(C,this.tileZoom);if(!(this.elevation-O))return;const V=this.getCameraPosition(),x=a.U.fromLngLat(V.lngLat,V.altitude),s=a.U.fromLngLat(C,O),i=x.x-s.x,r=x.y-s.y,l=x.z-s.z,d=Math.sqrt(i*i+r*r+l*l),y=this.scaleZoom(this.cameraToCenterDistance/d/this.tileSize);this._elevation=O,this._center=C,this.zoom=y}setLocationAtPoint(A,C){const O=this.pointCoordinate(C),V=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(A),s=new a.U(x.x-(O.x-V.x),x.y-(O.y-V.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(A,C){return C?this.coordinatePoint(this.locationCoordinate(A),C.getElevationForLngLatZoom(A,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(A))}pointLocation(A,C){return this.coordinateLocation(this.pointCoordinate(A,C))}locationCoordinate(A){return a.U.fromLngLat(A)}coordinateLocation(A){return A&&A.toLngLat()}pointCoordinate(A,C){if(C){const I=C.pointCoordinate(A);if(I!=null)return I}const O=[A.x,A.y,0,1],V=[A.x,A.y,1,1];a.ag(O,O,this.pixelMatrixInverse),a.ag(V,V,this.pixelMatrixInverse);const x=O[3],s=V[3],i=O[1]/x,r=V[1]/s,l=O[2]/x,d=V[2]/s,y=l===d?0:(0-l)/(d-l);return new a.U(a.B.number(O[0]/x,V[0]/s,y)/this.worldSize,a.B.number(i,r,y)/this.worldSize)}coordinatePoint(A,C=0,O=this.pixelMatrix){const V=[A.x*this.worldSize,A.y*this.worldSize,C,1];return a.ag(V,V,O),new a.P(V[0]/V[3],V[1]/V[3])}getBounds(){const A=Math.max(0,this.height/2-this.getHorizon());return new Ni().extend(this.pointLocation(new a.P(0,A))).extend(this.pointLocation(new a.P(this.width,A))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ni([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(A){A?(this.lngRange=[A.getWest(),A.getEast()],this.latRange=[A.getSouth(),A.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(A,C=!1){const O=A.key,V=C?this._alignedPosMatrixCache:this._posMatrixCache;if(V[O])return V[O];const x=A.canonical,s=this.worldSize/this.zoomScale(x.z),i=x.x+Math.pow(2,x.z)*A.wrap,r=a.ao(new Float64Array(16));return a.$(r,r,[i*s,x.y*s,0]),a.a0(r,r,[s/a.N,s/a.N,1]),a.a1(r,C?this.alignedProjMatrix:this.projMatrix,r),V[O]=new Float32Array(r),V[O]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let A,C,O,V,x=-90,s=90,i=-180,r=180;const l=this.size,d=this._unmodified;if(this.latRange){const k=this.latRange;x=a.H(k[1])*this.worldSize,s=a.H(k[0])*this.worldSize,A=s-x<l.y?l.y/(s-x):0}if(this.lngRange){const k=this.lngRange;i=a.b5(a.G(k[0])*this.worldSize,0,this.worldSize),r=a.b5(a.G(k[1])*this.worldSize,0,this.worldSize),r<i&&(r+=this.worldSize),C=r-i<l.x?l.x/(r-i):0}const y=this.point,I=Math.max(C||0,A||0);if(I)return this.center=this.unproject(new a.P(C?(r+i)/2:y.x,A?(s+x)/2:y.y)),this.zoom+=this.scaleZoom(I),this._unmodified=d,void(this._constraining=!1);if(this.latRange){const k=y.y,z=l.y/2;k-z<x&&(V=x+z),k+z>s&&(V=s-z)}if(this.lngRange){const k=(i+r)/2,z=a.b5(y.x,k-this.worldSize/2,k+this.worldSize/2),Z=l.x/2;z-Z<i&&(O=i+Z),z+Z>r&&(O=r-Z)}O===void 0&&V===void 0||(this.center=this.unproject(new a.P(O!==void 0?O:y.x,V!==void 0?V:y.y)).wrap()),this._unmodified=d,this._constraining=!1}_calcMatrices(){if(!this.height)return;const A=this.centerOffset,C=this.point.x,O=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b7(1,this.center.lat)*this.worldSize;let V=a.ao(new Float64Array(16));a.a0(V,V,[this.width/2,-this.height/2,1]),a.$(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=a.ao(new Float64Array(16)),a.a0(V,V,[1,-1,1]),a.$(V,V,[-1,-1,0]),a.a0(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V;const x=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this._minEleveationForCurrentTile),i=x-s*this._pixelPerMeter/Math.cos(this._pitch),r=s<0?i:x,l=Math.PI/2+this._pitch,d=this._fov*(.5+A.y/this.height),y=Math.sin(d)*r/Math.sin(a.ad(Math.PI-l-d,.01,Math.PI-.01)),I=this.getHorizon(),k=2*Math.atan(I/this.cameraToCenterDistance)*(.5+A.y/(2*I)),z=Math.sin(k)*r/Math.sin(a.ad(Math.PI-l-k,.01,Math.PI-.01)),Z=Math.min(y,z),Y=1.01*(Math.cos(Math.PI/2-this._pitch)*Z+r),Ae=this.height/50;V=new Float64Array(16),a.b8(V,this._fov,this.width/this.height,Ae,Y),V[8]=2*-A.x/this.width,V[9]=2*A.y/this.height,a.a0(V,V,[1,-1,1]),a.$(V,V,[0,0,-this.cameraToCenterDistance]),a.b9(V,V,this._pitch),a.ae(V,V,this.angle),a.$(V,V,[-C,-O,0]),this.mercatorMatrix=a.a0([],V,[this.worldSize,this.worldSize,this.worldSize]),a.a0(V,V,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.a1(new Float64Array(16),this.labelPlaneMatrix,V),a.$(V,V,[0,0,-this.elevation]),this.projMatrix=V,this.invProjMatrix=a.as([],V),this.pixelMatrix3D=a.a1(new Float64Array(16),this.labelPlaneMatrix,V);const Ie=this.width%2/2,ke=this.height%2/2,Fe=Math.cos(this.angle),ze=Math.sin(this.angle),tt=C-Math.round(C)+Fe*Ie+ze*ke,wt=O-Math.round(O)+Fe*ke+ze*Ie,lt=new Float64Array(V);if(a.$(lt,lt,[tt>.5?tt-1:tt,wt>.5?wt-1:wt,0]),this.alignedProjMatrix=lt,V=a.as(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");this.pixelMatrixInverse=V,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const A=this.pointCoordinate(new a.P(0,0)),C=[A.x*this.worldSize,A.y*this.worldSize,0,1];return a.ag(C,C,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const A=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,A))}getCameraQueryGeometry(A){const C=this.getCameraPoint();if(A.length===1)return[A[0],C];{let O=C.x,V=C.y,x=C.x,s=C.y;for(const i of A)O=Math.min(O,i.x),V=Math.min(V,i.y),x=Math.max(x,i.x),s=Math.max(s,i.y);return[new a.P(O,V),new a.P(x,V),new a.P(x,s),new a.P(O,s),new a.P(O,V)]}}}function Ma(Q,A){let C,O=!1,V=null,x=null;const s=()=>{V=null,O&&(Q.apply(x,C),V=setTimeout(s,A),O=!1)};return(...i)=>(O=!0,x=this,C=i,V||s(),V)}class Oa{constructor(A){this._getCurrentHash=()=>{const C=window.location.hash.replace("#","");if(this._hashName){let O;return C.split("&").map(V=>V.split("=")).forEach(V=>{V[0]===this._hashName&&(O=V)}),(O&&O[1]||"").split("/")}return C.split("/")},this._onHashChange=()=>{const C=this._getCurrentHash();if(C.length>=3&&!C.some(O=>isNaN(O))){const O=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(C[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+C[2],+C[1]],zoom:+C[0],bearing:O,pitch:+(C[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const C=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,C)}catch{}},this._updateHash=Ma(this._updateHashUnthrottled,300),this._hashName=A&&encodeURIComponent(A)}addTo(A){return this._map=A,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(A){const C=this._map.getCenter(),O=Math.round(100*this._map.getZoom())/100,V=Math.ceil((O*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,V),s=Math.round(C.lng*x)/x,i=Math.round(C.lat*x)/x,r=this._map.getBearing(),l=this._map.getPitch();let d="";if(d+=A?`/${s}/${i}/${O}`:`${O}/${i}/${s}`,(r||l)&&(d+="/"+Math.round(10*r)/10),l&&(d+=`/${Math.round(l)}`),this._hashName){const y=this._hashName;let I=!1;const k=window.location.hash.slice(1).split("&").map(z=>{const Z=z.split("=")[0];return Z===y?(I=!0,`${Z}=${d}`):z}).filter(z=>z);return I||k.push(`${y}=${d}`),`#${k.join("&")}`}return`#${d}`}}const no={linearity:.3,easing:a.ba(0,0,.3,1)},hl=a.e({deceleration:2500,maxSpeed:1400},no),cu=a.e({deceleration:20,maxSpeed:1400},no),_l=a.e({deceleration:1e3,maxSpeed:360},no),ho=a.e({deceleration:1e3,maxSpeed:90},no);class mi{constructor(A){this._map=A,this.clear()}clear(){this._inertiaBuffer=[]}record(A){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.h.now(),settings:A})}_drainInertiaBuffer(){const A=this._inertiaBuffer,C=a.h.now();for(;A.length>0&&C-A[0].time>160;)A.shift()}_onMoveEnd(A){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const C={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)C.zoom+=x.zoomDelta||0,C.bearing+=x.bearingDelta||0,C.pitch+=x.pitchDelta||0,x.panDelta&&C.pan._add(x.panDelta),x.around&&(C.around=x.around),x.pinchAround&&(C.pinchAround=x.pinchAround);const O=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,V={};if(C.pan.mag()){const x=Di(C.pan.mag(),O,a.e({},hl,A||{}));V.offset=C.pan.mult(x.amount/C.pan.mag()),V.center=this._map.transform.center,qi(V,x)}if(C.zoom){const x=Di(C.zoom,O,cu);V.zoom=this._map.transform.zoom+x.amount,qi(V,x)}if(C.bearing){const x=Di(C.bearing,O,_l);V.bearing=this._map.transform.bearing+a.ad(x.amount,-179,179),qi(V,x)}if(C.pitch){const x=Di(C.pitch,O,ho);V.pitch=this._map.transform.pitch+x.amount,qi(V,x)}if(V.zoom||V.bearing){const x=C.pinchAround===void 0?C.around:C.pinchAround;V.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),a.e(V,{noMoveStart:!0})}}function qi(Q,A){(!Q.duration||Q.duration<A.duration)&&(Q.duration=A.duration,Q.easing=A.easing)}function Di(Q,A,C){const{maxSpeed:O,linearity:V,deceleration:x}=C,s=a.ad(Q*V/(A/1e3),-O,O),i=Math.abs(s)/(x*V);return{easing:C.easing,duration:1e3*i,amount:s*(i/2)}}class Nt extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,C,O,V={}){const x=$.mousePos(C.getCanvasContainer(),O),s=C.unproject(x);super(A,a.e({point:x,lngLat:s,originalEvent:O},V)),this._defaultPrevented=!1,this.target=C}}class ni extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,C,O){const V=A==="touchend"?O.changedTouches:O.touches,x=$.touchPos(C.getCanvasContainer(),V),s=x.map(r=>C.unproject(r)),i=x.reduce((r,l,d,y)=>r.add(l.div(y.length)),new a.P(0,0));super(A,{points:x,point:i,lngLats:s,lngLat:C.unproject(i),originalEvent:O}),this._defaultPrevented=!1}}class wi extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,C,O){super(A,{originalEvent:O}),this._defaultPrevented=!1}}class Ui{constructor(A,C){this._map=A,this._clickTolerance=C.clickTolerance}reset(){delete this._mousedownPos}wheel(A){return this._firePreventable(new wi(A.type,this._map,A))}mousedown(A,C){return this._mousedownPos=C,this._firePreventable(new Nt(A.type,this._map,A))}mouseup(A){this._map.fire(new Nt(A.type,this._map,A))}click(A,C){this._mousedownPos&&this._mousedownPos.dist(C)>=this._clickTolerance||this._map.fire(new Nt(A.type,this._map,A))}dblclick(A){return this._firePreventable(new Nt(A.type,this._map,A))}mouseover(A){this._map.fire(new Nt(A.type,this._map,A))}mouseout(A){this._map.fire(new Nt(A.type,this._map,A))}touchstart(A){return this._firePreventable(new ni(A.type,this._map,A))}touchmove(A){this._map.fire(new ni(A.type,this._map,A))}touchend(A){this._map.fire(new ni(A.type,this._map,A))}touchcancel(A){this._map.fire(new ni(A.type,this._map,A))}_firePreventable(A){if(this._map.fire(A),A.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class On{constructor(A){this._map=A}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(A){this._map.fire(new Nt(A.type,this._map,A))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Nt("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(A){this._delayContextMenu?this._contextMenuEvent=A:this._ignoreContextMenu||this._map.fire(new Nt(A.type,this._map,A)),this._map.listens("contextmenu")&&A.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jn{constructor(A){this._map=A}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(A){return this.transform.pointLocation(a.P.convert(A),this._map.terrain)}}class cr{constructor(A,C){this._map=A,this._tr=new jn(A),this._el=A.getCanvasContainer(),this._container=A.getContainer(),this._clickTolerance=C.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(A,C){this.isEnabled()&&A.shiftKey&&A.button===0&&($.disableDrag(),this._startPos=this._lastPos=C,this._active=!0)}mousemoveWindow(A,C){if(!this._active)return;const O=C;if(this._lastPos.equals(O)||!this._box&&O.dist(this._startPos)<this._clickTolerance)return;const V=this._startPos;this._lastPos=O,this._box||(this._box=$.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",A));const x=Math.min(V.x,O.x),s=Math.max(V.x,O.x),i=Math.min(V.y,O.y),r=Math.max(V.y,O.y);$.setTransform(this._box,`translate(${x}px,${i}px)`),this._box.style.width=s-x+"px",this._box.style.height=r-i+"px"}mouseupWindow(A,C){if(!this._active||A.button!==0)return;const O=this._startPos,V=C;if(this.reset(),$.suppressClick(),O.x!==V.x||O.y!==V.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:A})),{cameraAnimation:x=>x.fitScreenCoordinates(O,V,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",A)}keydown(A){this._active&&A.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",A))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&($.remove(this._box),this._box=null),$.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(A,C){return this._map.fire(new a.k(A,{originalEvent:C}))}}function Jn(Q,A){if(Q.length!==A.length)throw new Error(`The number of touches and points are not equal - touches ${Q.length}, points ${A.length}`);const C={};for(let O=0;O<Q.length;O++)C[Q[O].identifier]=A[O];return C}class $s{constructor(A){this.reset(),this.numTouches=A.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(A,C,O){(this.centroid||O.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=A.timeStamp),O.length===this.numTouches&&(this.centroid=function(V){const x=new a.P(0,0);for(const s of V)x._add(s);return x.div(V.length)}(C),this.touches=Jn(O,C)))}touchmove(A,C,O){if(this.aborted||!this.centroid)return;const V=Jn(O,C);for(const x in this.touches){const s=V[x];(!s||s.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(A,C,O){if((!this.centroid||A.timeStamp-this.startTime>500)&&(this.aborted=!0),O.length===0){const V=!this.aborted&&this.centroid;if(this.reset(),V)return V}}}class Bs{constructor(A){this.singleTap=new $s(A),this.numTaps=A.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(A,C,O){this.singleTap.touchstart(A,C,O)}touchmove(A,C,O){this.singleTap.touchmove(A,C,O)}touchend(A,C,O){const V=this.singleTap.touchend(A,C,O);if(V){const x=A.timeStamp-this.lastTime<500,s=!this.lastTap||this.lastTap.dist(V)<30;if(x&&s||this.reset(),this.count++,this.lastTime=A.timeStamp,this.lastTap=V,this.count===this.numTaps)return this.reset(),V}}}class _s{constructor(A){this._tr=new jn(A),this._zoomIn=new Bs({numTouches:1,numTaps:2}),this._zoomOut=new Bs({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(A,C,O){this._zoomIn.touchstart(A,C,O),this._zoomOut.touchstart(A,C,O)}touchmove(A,C,O){this._zoomIn.touchmove(A,C,O),this._zoomOut.touchmove(A,C,O)}touchend(A,C,O){const V=this._zoomIn.touchend(A,C,O),x=this._zoomOut.touchend(A,C,O),s=this._tr;return V?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom+1,around:s.unproject(V)},{originalEvent:A})}):x?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom-1,around:s.unproject(x)},{originalEvent:A})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ro{constructor(A){this._enabled=!!A.enable,this._moveStateManager=A.moveStateManager,this._clickTolerance=A.clickTolerance||1,this._moveFunction=A.move,this._activateOnStart=!!A.activateOnStart,A.assignEvents(this),this.reset()}reset(A){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(A)}_move(...A){const C=this._moveFunction(...A);if(C.bearingDelta||C.pitchDelta||C.around||C.panDelta)return this._active=!0,C}dragStart(A,C){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(A)&&(this._moveStateManager.startMove(A),this._lastPoint=C.length?C[0]:C,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(A,C){if(!this.isEnabled())return;const O=this._lastPoint;if(!O)return;if(A.preventDefault(),!this._moveStateManager.isValidMoveEvent(A))return void this.reset(A);const V=C.length?C[0]:C;return!this._moved&&V.dist(O)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=V,this._move(O,V))}dragEnd(A){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(A)&&(this._moved&&$.suppressClick(),this.reset(A))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const bo={0:1,2:2};class cs{constructor(A){this._correctEvent=A.checkCorrectEvent}startMove(A){const C=$.mouseButton(A);this._eventButton=C}endMove(A){delete this._eventButton}isValidStartEvent(A){return this._correctEvent(A)}isValidMoveEvent(A){return!function(C,O){const V=bo[O];return C.buttons===void 0||(C.buttons&V)!==V}(A,this._eventButton)}isValidEndEvent(A){return $.mouseButton(A)===this._eventButton}}class Yu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(A){return A.targetTouches.length===1}_isSameTouchEvent(A){return A.targetTouches[0].identifier===this._firstTouch}startMove(A){this._firstTouch=A.targetTouches[0].identifier}endMove(A){delete this._firstTouch}isValidStartEvent(A){return this._isOneFingerTouch(A)}isValidMoveEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}isValidEndEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}}const Nu=Q=>{Q.mousedown=Q.dragStart,Q.mousemoveWindow=Q.dragMove,Q.mouseup=Q.dragEnd,Q.contextmenu=function(A){A.preventDefault()}},wo=({enable:Q,clickTolerance:A,bearingDegreesPerPixelMoved:C=.8})=>{const O=new cs({checkCorrectEvent:V=>$.mouseButton(V)===0&&V.ctrlKey||$.mouseButton(V)===2});return new ro({clickTolerance:A,move:(V,x)=>({bearingDelta:(x.x-V.x)*C}),moveStateManager:O,enable:Q,assignEvents:Nu})},Ll=({enable:Q,clickTolerance:A,pitchDegreesPerPixelMoved:C=-.5})=>{const O=new cs({checkCorrectEvent:V=>$.mouseButton(V)===0&&V.ctrlKey||$.mouseButton(V)===2});return new ro({clickTolerance:A,move:(V,x)=>({pitchDelta:(x.y-V.y)*C}),moveStateManager:O,enable:Q,assignEvents:Nu})};class Rn{constructor(A,C){this._minTouches=A.cooperativeGestures?2:1,this._clickTolerance=A.clickTolerance||1,this._map=C,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(A,C,O){return this._calculateTransform(A,C,O)}touchmove(A,C,O){if(this._map._cooperativeGestures&&(this._minTouches===2&&O.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(A,!1,O.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(O.length<this._minTouches))return A.preventDefault(),this._calculateTransform(A,C,O)}touchend(A,C,O){this._calculateTransform(A,C,O),this._active&&O.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(A,C,O){O.length>0&&(this._active=!0);const V=Jn(O,C),x=new a.P(0,0),s=new a.P(0,0);let i=0;for(const l in V){const d=V[l],y=this._touches[l];y&&(x._add(d),s._add(d.sub(y)),i++,V[l]=d)}if(this._touches=V,i<this._minTouches||!s.mag())return;const r=s.div(i);return this._sum._add(r),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(i),panDelta:r}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Na{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(A,C,O){this._firstTwoTouches||O.length<2||(this._firstTwoTouches=[O[0].identifier,O[1].identifier],this._start([C[0],C[1]]))}touchmove(A,C,O){if(!this._firstTwoTouches)return;A.preventDefault();const[V,x]=this._firstTwoTouches,s=En(O,C,V),i=En(O,C,x);if(!s||!i)return;const r=this._aroundCenter?null:s.add(i).div(2);return this._move([s,i],r,A)}touchend(A,C,O){if(!this._firstTwoTouches)return;const[V,x]=this._firstTwoTouches,s=En(O,C,V),i=En(O,C,x);s&&i||(this._active&&$.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(A){this._enabled=!0,this._aroundCenter=!!A&&A.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function En(Q,A,C){for(let O=0;O<Q.length;O++)if(Q[O].identifier===C)return A[O]}function Vo(Q,A){return Math.log(Q/A)/Math.LN2}class Gl extends Na{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(A){this._startDistance=this._distance=A[0].dist(A[1])}_move(A,C){const O=this._distance;if(this._distance=A[0].dist(A[1]),this._active||!(Math.abs(Vo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Vo(this._distance,O),pinchAround:C}}}function Cn(Q,A){return 180*Q.angleWith(A)/Math.PI}class Yl extends Na{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(A){this._startVector=this._vector=A[0].sub(A[1]),this._minDiameter=A[0].dist(A[1])}_move(A,C){const O=this._vector;if(this._vector=A[0].sub(A[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Cn(this._vector,O),pinchAround:C}}_isBelowThreshold(A){this._minDiameter=Math.min(this._minDiameter,A.mag());const C=25/(Math.PI*this._minDiameter)*360,O=Cn(A,this._startVector);return Math.abs(O)<C}}function Tn(Q){return Math.abs(Q.y)>Math.abs(Q.x)}class yl extends Na{constructor(A){super(),this._map=A}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(A,C,O){super.touchstart(A,C,O),this._currentTouchCount=O.length}_start(A){this._lastPoints=A,Tn(A[0].sub(A[1]))&&(this._valid=!1)}_move(A,C,O){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const V=A[0].sub(this._lastPoints[0]),x=A[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(V,x,O.timeStamp),this._valid?(this._lastPoints=A,this._active=!0,{pitchDelta:(V.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(A,C,O){if(this._valid!==void 0)return this._valid;const V=A.mag()>=2,x=C.mag()>=2;if(!V&&!x)return;if(!V||!x)return this._firstMove===void 0&&(this._firstMove=O),O-this._firstMove<100&&void 0;const s=A.y>0==C.y>0;return Tn(A)&&Tn(C)&&s}}const hu={panStep:100,bearingStep:15,pitchStep:10};class Vu{constructor(A){this._tr=new jn(A);const C=hu;this._panStep=C.panStep,this._bearingStep=C.bearingStep,this._pitchStep=C.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(A){if(A.altKey||A.ctrlKey||A.metaKey)return;let C=0,O=0,V=0,x=0,s=0;switch(A.keyCode){case 61:case 107:case 171:case 187:C=1;break;case 189:case 109:case 173:C=-1;break;case 37:A.shiftKey?O=-1:(A.preventDefault(),x=-1);break;case 39:A.shiftKey?O=1:(A.preventDefault(),x=1);break;case 38:A.shiftKey?V=1:(A.preventDefault(),s=-1);break;case 40:A.shiftKey?V=-1:(A.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(O=0,V=0),{cameraAnimation:i=>{const r=this._tr;i.easeTo({duration:300,easeId:"keyboardHandler",easing:ql,zoom:C?Math.round(r.zoom)+C*(A.shiftKey?2:1):r.zoom,bearing:r.bearing+O*this._bearingStep,pitch:r.pitch+V*this._pitchStep,offset:[-x*this._panStep,-s*this._panStep],center:r.center},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ql(Q){return Q*(2-Q)}const vl=4.000244140625;class oa{constructor(A,C){this._onTimeout=O=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(O)},this._map=A,this._tr=new jn(A),this._el=A.getCanvasContainer(),this._triggerRenderFrame=C,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(A){this._defaultZoomRate=A}setWheelZoomRate(A){this._wheelZoomRate=A}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(A){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!A&&A.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(A){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!A[this._map._metaKey])return;A.preventDefault()}let C=A.deltaMode===WheelEvent.DOM_DELTA_LINE?40*A.deltaY:A.deltaY;const O=a.h.now(),V=O-(this._lastWheelEventTime||0);this._lastWheelEventTime=O,C!==0&&C%vl==0?this._type="wheel":C!==0&&Math.abs(C)<4?this._type="trackpad":V>400?(this._type=null,this._lastValue=C,this._timeout=setTimeout(this._onTimeout,40,A)):this._type||(this._type=Math.abs(V*C)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,C+=this._lastValue)),A.shiftKey&&C&&(C/=4),this._type&&(this._lastWheelEvent=A,this._delta-=C,this._active||this._start(A)),A.preventDefault()}_start(A){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const C=$.mousePos(this._el,A),O=this._tr;this._around=a.L.convert(this._aroundCenter?O.center:O.unproject(C)),this._aroundPoint=O.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const A=this._tr.transform;if(this._delta!==0){const i=this._type==="wheel"&&Math.abs(this._delta)>vl?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&r!==0&&(r=1/r);const l=typeof this._targetZoom=="number"?A.zoomScale(this._targetZoom):A.scale;this._targetZoom=Math.min(A.maxZoom,Math.max(A.minZoom,A.scaleZoom(l*r))),this._type==="wheel"&&(this._startZoom=A.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const C=typeof this._targetZoom=="number"?this._targetZoom:A.zoom,O=this._startZoom,V=this._easing;let x,s=!1;if(this._type==="wheel"&&O&&V){const i=Math.min((a.h.now()-this._lastWheelEventTime)/200,1),r=V(i);x=a.B.number(O,C,r),i<1?this._frameId||(this._frameId=!0):s=!0}else x=C,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:x-A.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(A){let C=a.bb;if(this._prevEase){const O=this._prevEase,V=(a.h.now()-O.start)/O.duration,x=O.easing(V+.01)-O.easing(V),s=.27/Math.sqrt(x*x+1e-4)*.01,i=Math.sqrt(.0729-s*s);C=a.ba(s,i,.25,1)}return this._prevEase={start:a.h.now(),duration:A,easing:C},C}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class uc{constructor(A,C){this._clickZoom=A,this._tapZoom=C}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ku{constructor(A){this._tr=new jn(A),this.reset()}reset(){this._active=!1}dblclick(A,C){return A.preventDefault(),{cameraAnimation:O=>{O.easeTo({duration:300,zoom:this._tr.zoom+(A.shiftKey?-1:1),around:this._tr.unproject(C)},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kl{constructor(){this._tap=new Bs({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(A,C,O){if(!this._swipePoint)if(this._tapTime){const V=C[0],x=A.timeStamp-this._tapTime<500,s=this._tapPoint.dist(V)<30;x&&s?O.length>0&&(this._swipePoint=V,this._swipeTouch=O[0].identifier):this.reset()}else this._tap.touchstart(A,C,O)}touchmove(A,C,O){if(this._tapTime){if(this._swipePoint){if(O[0].identifier!==this._swipeTouch)return;const V=C[0],x=V.y-this._swipePoint.y;return this._swipePoint=V,A.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(A,C,O)}touchend(A,C,O){if(this._tapTime)this._swipePoint&&O.length===0&&this.reset();else{const V=this._tap.touchend(A,C,O);V&&(this._tapTime=A.timeStamp,this._tapPoint=V)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ys{constructor(A,C,O){this._el=A,this._mousePan=C,this._touchPan=O}enable(A){this._inertiaOptions=A||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wa{constructor(A,C,O){this._pitchWithRotate=A.pitchWithRotate,this._mouseRotate=C,this._mousePitch=O}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class tl{constructor(A,C,O,V){this._el=A,this._touchZoom=C,this._touchRotate=O,this._tapDragZoom=V,this._rotationDisabled=!1,this._enabled=!0}enable(A){this._touchZoom.enable(A),this._rotationDisabled||this._touchRotate.enable(A),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const xu=Q=>Q.zoom||Q.drag||Q.pitch||Q.rotate;class Uu extends a.k{}function Au(Q){return Q.panDelta&&Q.panDelta.mag()||Q.zoomDelta||Q.bearingDelta||Q.pitchDelta}class Gu{constructor(A,C){this.handleWindowEvent=V=>{this.handleEvent(V,`${V.type}Window`)},this.handleEvent=(V,x)=>{if(V.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const s=V.type==="renderFrame"?void 0:V,i={needsRenderFrame:!1},r={},l={},d=V.touches,y=d?this._getMapTouches(d):void 0,I=y?$.touchPos(this._el,y):$.mousePos(this._el,V);for(const{handlerName:Z,handler:Y,allowed:Ae}of this._handlers){if(!Y.isEnabled())continue;let Ie;this._blockedByActive(l,Ae,Z)?Y.reset():Y[x||V.type]&&(Ie=Y[x||V.type](V,I,y),this.mergeHandlerResult(i,r,Ie,Z,s),Ie&&Ie.needsRenderFrame&&this._triggerRenderFrame()),(Ie||Y.isActive())&&(l[Z]=Y)}const k={};for(const Z in this._previousActiveHandlers)l[Z]||(k[Z]=s);this._previousActiveHandlers=l,(Object.keys(k).length||Au(i))&&(this._changes.push([i,r,k]),this._triggerRenderFrame()),(Object.keys(l).length||Au(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:z}=i;z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],z(this._map))},this._map=A,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mi(A),this._bearingSnap=C.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(C);const O=this._el;this._listeners=[[O,"touchstart",{passive:!0}],[O,"touchmove",{passive:!1}],[O,"touchend",void 0],[O,"touchcancel",void 0],[O,"mousedown",void 0],[O,"mousemove",void 0],[O,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[O,"mouseover",void 0],[O,"mouseout",void 0],[O,"dblclick",void 0],[O,"click",void 0],[O,"keydown",{capture:!1}],[O,"keyup",void 0],[O,"wheel",{passive:!1}],[O,"contextmenu",void 0],[window,"blur",void 0]];for(const[V,x,s]of this._listeners)$.addEventListener(V,x,V===document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[A,C,O]of this._listeners)$.removeEventListener(A,C,A===document?this.handleWindowEvent:this.handleEvent,O)}_addDefaultHandlers(A){const C=this._map,O=C.getCanvasContainer();this._add("mapEvent",new Ui(C,A));const V=C.boxZoom=new cr(C,A);this._add("boxZoom",V),A.interactive&&A.boxZoom&&V.enable();const x=new _s(C),s=new Ku(C);C.doubleClickZoom=new uc(s,x),this._add("tapZoom",x),this._add("clickZoom",s),A.interactive&&A.doubleClickZoom&&C.doubleClickZoom.enable();const i=new Kl;this._add("tapDragZoom",i);const r=C.touchPitch=new yl(C);this._add("touchPitch",r),A.interactive&&A.touchPitch&&C.touchPitch.enable(A.touchPitch);const l=wo(A),d=Ll(A);C.dragRotate=new wa(A,l,d),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",d,["mouseRotate"]),A.interactive&&A.dragRotate&&C.dragRotate.enable();const y=(({enable:Ae,clickTolerance:Ie})=>{const ke=new cs({checkCorrectEvent:Fe=>$.mouseButton(Fe)===0&&!Fe.ctrlKey});return new ro({clickTolerance:Ie,move:(Fe,ze)=>({around:ze,panDelta:ze.sub(Fe)}),activateOnStart:!0,moveStateManager:ke,enable:Ae,assignEvents:Nu})})(A),I=new Rn(A,C);C.dragPan=new ys(O,y,I),this._add("mousePan",y),this._add("touchPan",I,["touchZoom","touchRotate"]),A.interactive&&A.dragPan&&C.dragPan.enable(A.dragPan);const k=new Yl,z=new Gl;C.touchZoomRotate=new tl(O,z,k,i),this._add("touchRotate",k,["touchPan","touchZoom"]),this._add("touchZoom",z,["touchPan","touchRotate"]),A.interactive&&A.touchZoomRotate&&C.touchZoomRotate.enable(A.touchZoomRotate);const Z=C.scrollZoom=new oa(C,()=>this._triggerRenderFrame());this._add("scrollZoom",Z,["mousePan"]),A.interactive&&A.scrollZoom&&C.scrollZoom.enable(A.scrollZoom);const Y=C.keyboard=new Vu(C);this._add("keyboard",Y),A.interactive&&A.keyboard&&C.keyboard.enable(),this._add("blockableMapEvent",new On(C))}_add(A,C,O){this._handlers.push({handlerName:A,handler:C,allowed:O}),this._handlersById[A]=C}stop(A){if(!this._updatingCamera){for(const{handler:C}of this._handlers)C.reset();this._inertia.clear(),this._fireEvents({},{},A),this._changes=[]}}isActive(){for(const{handler:A}of this._handlers)if(A.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!xu(this._eventsInProgress)||this.isZooming()}_blockedByActive(A,C,O){for(const V in A)if(V!==O&&(!C||C.indexOf(V)<0))return!0;return!1}_getMapTouches(A){const C=[];for(const O of A)this._el.contains(O.target)&&C.push(O);return C}mergeHandlerResult(A,C,O,V,x){if(!O)return;a.e(A,O);const s={handlerName:V,originalEvent:O.originalEvent||x};O.zoomDelta!==void 0&&(C.zoom=s),O.panDelta!==void 0&&(C.drag=s),O.pitchDelta!==void 0&&(C.pitch=s),O.bearingDelta!==void 0&&(C.rotate=s)}_applyChanges(){const A={},C={},O={};for(const[V,x,s]of this._changes)V.panDelta&&(A.panDelta=(A.panDelta||new a.P(0,0))._add(V.panDelta)),V.zoomDelta&&(A.zoomDelta=(A.zoomDelta||0)+V.zoomDelta),V.bearingDelta&&(A.bearingDelta=(A.bearingDelta||0)+V.bearingDelta),V.pitchDelta&&(A.pitchDelta=(A.pitchDelta||0)+V.pitchDelta),V.around!==void 0&&(A.around=V.around),V.pinchAround!==void 0&&(A.pinchAround=V.pinchAround),V.noInertia&&(A.noInertia=V.noInertia),a.e(C,x),a.e(O,s);this._updateMapTransform(A,C,O),this._changes=[]}_updateMapTransform(A,C,O){const V=this._map,x=V._getTransformForUpdate(),s=V.terrain;if(!(Au(A)||s&&this._terrainMovement))return this._fireEvents(C,O,!0);let{panDelta:i,zoomDelta:r,bearingDelta:l,pitchDelta:d,around:y,pinchAround:I}=A;I!==void 0&&(y=I),V._stop(!0),y=y||V.transform.centerPoint;const k=x.pointLocation(i?y.sub(i):y);l&&(x.bearing+=l),d&&(x.pitch+=d),r&&(x.zoom+=r),s?this._terrainMovement||!C.drag&&!C.zoom?C.drag&&this._terrainMovement?x.center=x.pointLocation(x.centerPoint.sub(i)):x.setLocationAtPoint(k,y):(this._terrainMovement=!0,this._map._elevationFreeze=!0,x.setLocationAtPoint(k,y),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,x.recalculateZoom(V.terrain)})):x.setLocationAtPoint(k,y),V._applyUpdatedTransform(x),this._map._update(),A.noInertia||this._inertia.record(A),this._fireEvents(C,O,!0)}_fireEvents(A,C,O){const V=xu(this._eventsInProgress),x=xu(A),s={};for(const d in A){const{originalEvent:y}=A[d];this._eventsInProgress[d]||(s[`${d}start`]=y),this._eventsInProgress[d]=A[d]}!V&&x&&this._fireEvent("movestart",x.originalEvent);for(const d in s)this._fireEvent(d,s[d]);x&&this._fireEvent("move",x.originalEvent);for(const d in A){const{originalEvent:y}=A[d];this._fireEvent(d,y)}const i={};let r;for(const d in this._eventsInProgress){const{handlerName:y,originalEvent:I}=this._eventsInProgress[d];this._handlersById[y].isActive()||(delete this._eventsInProgress[d],r=C[y]||I,i[`${d}end`]=r)}for(const d in i)this._fireEvent(d,i[d]);const l=xu(this._eventsInProgress);if(O&&(V||x)&&!l){this._updatingCamera=!0;const d=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),y=I=>I!==0&&-this._bearingSnap<I&&I<this._bearingSnap;!d||!d.essential&&a.h.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:r})),y(this._map.getBearing())&&this._map.resetNorth()):(y(d.bearing||this._map.getBearing())&&(d.bearing=0),d.freezeElevation=!0,this._map.easeTo(d,{originalEvent:r})),this._updatingCamera=!1}}_fireEvent(A,C){this._map.fire(new a.k(A,C?{originalEvent:C}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(A=>{delete this._frameId,this.handleEvent(new Uu("renderFrame",{timeStamp:A})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class br extends a.E{constructor(A,C){super(),this._renderFrameCallback=()=>{const O=Math.min((a.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(O)),O<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=A,this._bearingSnap=C.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.L(this.transform.center.lng,this.transform.center.lat)}setCenter(A,C){return this.jumpTo({center:A},C)}panBy(A,C,O){return A=a.P.convert(A).mult(-1),this.panTo(this.transform.center,a.e({offset:A},C),O)}panTo(A,C,O){return this.easeTo(a.e({center:A},C),O)}getZoom(){return this.transform.zoom}setZoom(A,C){return this.jumpTo({zoom:A},C),this}zoomTo(A,C,O){return this.easeTo(a.e({zoom:A},C),O)}zoomIn(A,C){return this.zoomTo(this.getZoom()+1,A,C),this}zoomOut(A,C){return this.zoomTo(this.getZoom()-1,A,C),this}getBearing(){return this.transform.bearing}setBearing(A,C){return this.jumpTo({bearing:A},C),this}getPadding(){return this.transform.padding}setPadding(A,C){return this.jumpTo({padding:A},C),this}rotateTo(A,C,O){return this.easeTo(a.e({bearing:A},C),O)}resetNorth(A,C){return this.rotateTo(0,a.e({duration:1e3},A),C),this}resetNorthPitch(A,C){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},A),C),this}snapToNorth(A,C){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(A,C):this}getPitch(){return this.transform.pitch}setPitch(A,C){return this.jumpTo({pitch:A},C),this}cameraForBounds(A,C){A=Ni.convert(A);const O=C&&C.bearing||0;return this._cameraForBoxAndBearing(A.getNorthWest(),A.getSouthEast(),O,C)}_cameraForBoxAndBearing(A,C,O,V){const x={top:0,bottom:0,right:0,left:0};if(typeof(V=a.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},V)).padding=="number"){const ze=V.padding;V.padding={top:ze,bottom:ze,right:ze,left:ze}}V.padding=a.e(x,V.padding);const s=this.transform,i=s.padding,r=s.project(a.L.convert(A)),l=s.project(a.L.convert(C)),d=r.rotate(-O*Math.PI/180),y=l.rotate(-O*Math.PI/180),I=new a.P(Math.max(d.x,y.x),Math.max(d.y,y.y)),k=new a.P(Math.min(d.x,y.x),Math.min(d.y,y.y)),z=I.sub(k),Z=(s.width-(i.left+i.right+V.padding.left+V.padding.right))/z.x,Y=(s.height-(i.top+i.bottom+V.padding.top+V.padding.bottom))/z.y;if(Y<0||Z<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ae=Math.min(s.scaleZoom(s.scale*Math.min(Z,Y)),V.maxZoom),Ie=a.P.convert(V.offset),ke=new a.P((V.padding.left-V.padding.right)/2,(V.padding.top-V.padding.bottom)/2).rotate(O*Math.PI/180),Fe=Ie.add(ke).mult(s.scale/s.zoomScale(Ae));return{center:s.unproject(r.add(l).div(2).sub(Fe)),zoom:Ae,bearing:O}}fitBounds(A,C,O){return this._fitInternal(this.cameraForBounds(A,C),C,O)}fitScreenCoordinates(A,C,O,V,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(A)),this.transform.pointLocation(a.P.convert(C)),O,V),V,x)}_fitInternal(A,C,O){return A?(delete(C=a.e(A,C)).padding,C.linear?this.easeTo(C,O):this.flyTo(C,O)):this}jumpTo(A,C){this.stop();const O=this._getTransformForUpdate();let V=!1,x=!1,s=!1;return"zoom"in A&&O.zoom!==+A.zoom&&(V=!0,O.zoom=+A.zoom),A.center!==void 0&&(O.center=a.L.convert(A.center)),"bearing"in A&&O.bearing!==+A.bearing&&(x=!0,O.bearing=+A.bearing),"pitch"in A&&O.pitch!==+A.pitch&&(s=!0,O.pitch=+A.pitch),A.padding==null||O.isPaddingEqual(A.padding)||(O.padding=A.padding),this._applyUpdatedTransform(O),this.fire(new a.k("movestart",C)).fire(new a.k("move",C)),V&&this.fire(new a.k("zoomstart",C)).fire(new a.k("zoom",C)).fire(new a.k("zoomend",C)),x&&this.fire(new a.k("rotatestart",C)).fire(new a.k("rotate",C)).fire(new a.k("rotateend",C)),s&&this.fire(new a.k("pitchstart",C)).fire(new a.k("pitch",C)).fire(new a.k("pitchend",C)),this.fire(new a.k("moveend",C))}calculateCameraOptionsFromTo(A,C,O,V=0){const x=a.U.fromLngLat(A,C),s=a.U.fromLngLat(O,V),i=s.x-x.x,r=s.y-x.y,l=s.z-x.z,d=Math.hypot(i,r,l);if(d===0)throw new Error("Can't calculate camera options with same From and To");const y=Math.hypot(i,r),I=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),k=180*Math.atan2(i,-r)/Math.PI;let z=180*Math.acos(y/d)/Math.PI;return z=l<0?90-z:90+z,{center:s.toLngLat(),zoom:I,pitch:z,bearing:k}}easeTo(A,C){this._stop(!1,A.easeId),((A=a.e({offset:[0,0],duration:500,easing:a.bb},A)).animate===!1||!A.essential&&a.h.prefersReducedMotion)&&(A.duration=0);const O=this._getTransformForUpdate(),V=this.getZoom(),x=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?+A.zoom:V,l="bearing"in A?this._normalizeBearing(A.bearing,x):x,d="pitch"in A?+A.pitch:s,y="padding"in A?A.padding:O.padding,I=a.P.convert(A.offset);let k=O.centerPoint.add(I);const z=O.pointLocation(k),Z=a.L.convert(A.center||z);this._normalizeCenter(Z);const Y=O.project(z),Ae=O.project(Z).sub(Y),Ie=O.zoomScale(r-V);let ke,Fe;A.around&&(ke=a.L.convert(A.around),Fe=O.locationPoint(ke));const ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||r!==V,this._rotating=this._rotating||x!==l,this._pitching=this._pitching||d!==s,this._padding=!O.isPaddingEqual(y),this._easeId=A.easeId,this._prepareEase(C,A.noMoveStart,ze),this.terrain&&this._prepareElevation(Z),this._ease(tt=>{if(this._zooming&&(O.zoom=a.B.number(V,r,tt)),this._rotating&&(O.bearing=a.B.number(x,l,tt)),this._pitching&&(O.pitch=a.B.number(s,d,tt)),this._padding&&(O.interpolatePadding(i,y,tt),k=O.centerPoint.add(I)),this.terrain&&!A.freezeElevation&&this._updateElevation(tt),ke)O.setLocationAtPoint(ke,Fe);else{const wt=O.zoomScale(O.zoom-V),lt=r>V?Math.min(2,Ie):Math.max(.5,Ie),ft=Math.pow(lt,1-tt),Tt=O.unproject(Y.add(Ae.mult(tt*ft)).mult(wt));O.setLocationAtPoint(O.renderWorldCopies?Tt.wrap():Tt,k)}this._applyUpdatedTransform(O),this._fireMoveEvents(C)},tt=>{this.terrain&&this._finalizeElevation(),this._afterEase(C,tt)},A),this}_prepareEase(A,C,O={}){this._moving=!0,C||O.moving||this.fire(new a.k("movestart",A)),this._zooming&&!O.zooming&&this.fire(new a.k("zoomstart",A)),this._rotating&&!O.rotating&&this.fire(new a.k("rotatestart",A)),this._pitching&&!O.pitching&&this.fire(new a.k("pitchstart",A))}_prepareElevation(A){this._elevationCenter=A,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(A,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(A){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const C=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(A<1&&C!==this._elevationTarget){const O=this._elevationTarget-this._elevationStart;this._elevationStart+=A*(O-(C-(O*A+this._elevationStart))/(1-A)),this._elevationTarget=C}this.transform.elevation=a.B.number(this._elevationStart,this._elevationTarget,A)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(A){if(!this.transformCameraUpdate)return;const C=A.clone(),{center:O,zoom:V,pitch:x,bearing:s,elevation:i}=this.transformCameraUpdate(C);O&&(C.center=O),V!==void 0&&(C.zoom=V),x!==void 0&&(C.pitch=x),s!==void 0&&(C.bearing=s),i!==void 0&&(C.elevation=i),this.transform.apply(C)}_fireMoveEvents(A){this.fire(new a.k("move",A)),this._zooming&&this.fire(new a.k("zoom",A)),this._rotating&&this.fire(new a.k("rotate",A)),this._pitching&&this.fire(new a.k("pitch",A))}_afterEase(A,C){if(this._easeId&&C&&this._easeId===C)return;delete this._easeId;const O=this._zooming,V=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,O&&this.fire(new a.k("zoomend",A)),V&&this.fire(new a.k("rotateend",A)),x&&this.fire(new a.k("pitchend",A)),this.fire(new a.k("moveend",A))}flyTo(A,C){if(!A.essential&&a.h.prefersReducedMotion){const ai=a.F(A,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ai,C)}this.stop(),A=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.bb},A);const O=this._getTransformForUpdate(),V=this.getZoom(),x=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?a.ad(+A.zoom,O.minZoom,O.maxZoom):V,l="bearing"in A?this._normalizeBearing(A.bearing,x):x,d="pitch"in A?+A.pitch:s,y="padding"in A?A.padding:O.padding,I=O.zoomScale(r-V),k=a.P.convert(A.offset);let z=O.centerPoint.add(k);const Z=O.pointLocation(z),Y=a.L.convert(A.center||Z);this._normalizeCenter(Y);const Ae=O.project(Z),Ie=O.project(Y).sub(Ae);let ke=A.curve;const Fe=Math.max(O.width,O.height),ze=Fe/I,tt=Ie.mag();if("minZoom"in A){const ai=a.ad(Math.min(A.minZoom,V,r),O.minZoom,O.maxZoom),Wi=Fe/O.zoomScale(ai-V);ke=Math.sqrt(Wi/tt*2)}const wt=ke*ke;function lt(ai){const Wi=(ze*ze-Fe*Fe+(ai?-1:1)*wt*wt*tt*tt)/(2*(ai?ze:Fe)*wt*tt);return Math.log(Math.sqrt(Wi*Wi+1)-Wi)}function ft(ai){return(Math.exp(ai)-Math.exp(-ai))/2}function Tt(ai){return(Math.exp(ai)+Math.exp(-ai))/2}const It=lt(!1);let si=function(ai){return Tt(It)/Tt(It+ke*ai)},Kt=function(ai){return Fe*((Tt(It)*(ft(Wi=It+ke*ai)/Tt(Wi))-ft(It))/wt)/tt;var Wi},ii=(lt(!0)-It)/ke;if(Math.abs(tt)<1e-6||!isFinite(ii)){if(Math.abs(Fe-ze)<1e-6)return this.easeTo(A,C);const ai=ze<Fe?-1:1;ii=Math.abs(Math.log(ze/Fe))/ke,Kt=function(){return 0},si=function(Wi){return Math.exp(ai*ke*Wi)}}return A.duration="duration"in A?+A.duration:1e3*ii/("screenSpeed"in A?+A.screenSpeed/ke:+A.speed),A.maxDuration&&A.duration>A.maxDuration&&(A.duration=0),this._zooming=!0,this._rotating=x!==l,this._pitching=d!==s,this._padding=!O.isPaddingEqual(y),this._prepareEase(C,!1),this.terrain&&this._prepareElevation(Y),this._ease(ai=>{const Wi=ai*ii,$i=1/si(Wi);O.zoom=ai===1?r:V+O.scaleZoom($i),this._rotating&&(O.bearing=a.B.number(x,l,ai)),this._pitching&&(O.pitch=a.B.number(s,d,ai)),this._padding&&(O.interpolatePadding(i,y,ai),z=O.centerPoint.add(k)),this.terrain&&!A.freezeElevation&&this._updateElevation(ai);const Ei=ai===1?Y:O.unproject(Ae.add(Ie.mult(Kt(Wi))).mult($i));O.setLocationAtPoint(O.renderWorldCopies?Ei.wrap():Ei,z),this._applyUpdatedTransform(O),this._fireMoveEvents(C)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(C)},A),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(A,C){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const O=this._onEaseEnd;delete this._onEaseEnd,O.call(this,C)}if(!A){const O=this.handlers;O&&O.stop(!1)}return this}_ease(A,C,O){O.animate===!1||O.duration===0?(A(1),C()):(this._easeStart=a.h.now(),this._easeOptions=O,this._onEaseFrame=A,this._onEaseEnd=C,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(A,C){A=a.b5(A,-180,180);const O=Math.abs(A-C);return Math.abs(A-360-C)<O&&(A-=360),Math.abs(A+360-C)<O&&(A+=360),A}_normalizeCenter(A){const C=this.transform;if(!C.renderWorldCopies||C.lngRange)return;const O=A.lng-C.center.lng;A.lng+=O>180?-360:O<-180?360:0}queryTerrainElevation(A){return this.terrain?this.terrain.getElevationForLngLatZoom(a.L.convert(A),this.transform.tileZoom)-this.transform.elevation:null}}class vs{constructor(A={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=C=>{!C||C.sourceDataType!=="metadata"&&C.sourceDataType!=="visibility"&&C.dataType!=="style"&&C.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=A}getDefaultPosition(){return"bottom-right"}onAdd(A){return this._map=A,this._compact=this.options&&this.options.compact,this._container=$.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=$.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=$.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){$.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(A,C){const O=this._map._getUIString(`AttributionControl.${C}`);A.title=O,A.setAttribute("aria-label",O)}_updateAttributions(){if(!this._map.style)return;let A=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?A=A.concat(this.options.customAttribution.map(V=>typeof V!="string"?"":V)):typeof this.options.customAttribution=="string"&&A.push(this.options.customAttribution)),this._map.style.stylesheet){const V=this._map.style.stylesheet;this.styleOwner=V.owner,this.styleId=V.id}const C=this._map.style.sourceCaches;for(const V in C){const x=C[V];if(x.used||x.usedForTerrain){const s=x.getSource();s.attribution&&A.indexOf(s.attribution)<0&&A.push(s.attribution)}}A=A.filter(V=>String(V).trim()),A.sort((V,x)=>V.length-x.length),A=A.filter((V,x)=>{for(let s=x+1;s<A.length;s++)if(A[s].indexOf(V)>=0)return!1;return!0});const O=A.join(" | ");O!==this._attribHTML&&(this._attribHTML=O,A.length?(this._innerContainer.innerHTML=O,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class gn{constructor(A={}){this._updateCompact=()=>{const C=this._container.children;if(C.length){const O=C[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&O.classList.add("maplibregl-compact"):O.classList.remove("maplibregl-compact")}},this.options=A}getDefaultPosition(){return"bottom-left"}onAdd(A){this._map=A,this._compact=this.options&&this.options.compact,this._container=$.create("div","maplibregl-ctrl");const C=$.create("a","maplibregl-ctrl-logo");return C.target="_blank",C.rel="noopener nofollow",C.href="https://maplibre.org/",C.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),C.setAttribute("rel","noopener nofollow"),this._container.appendChild(C),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){$.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Zn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(A){const C=++this._id;return this._queue.push({callback:A,id:C,cancelled:!1}),C}remove(A){const C=this._currentlyRunning,O=C?this._queue.concat(C):this._queue;for(const V of O)if(V.id===A)return void(V.cancelled=!0)}run(A=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const C=this._currentlyRunning=this._queue;this._queue=[];for(const O of C)if(!O.cancelled&&(O.callback(A),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const ir={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var il=a.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Pu extends a.E{constructor(A){super(),this.sourceCache=A,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,A.usedForTerrain=!0,A.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(A,C){this.sourceCache.update(A,C),this._renderableTilesKeys=[];const O={};for(const V of A.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:C}))O[V.key]=!0,this._renderableTilesKeys.push(V.key),this._tiles[V.key]||(V.posMatrix=new Float64Array(16),a.aS(V.posMatrix,0,a.N,0,a.N,0,1),this._tiles[V.key]=new an(V,this.tileSize));for(const V in this._tiles)O[V]||delete this._tiles[V]}freeRtt(A){for(const C in this._tiles){const O=this._tiles[C];(!A||O.tileID.equals(A)||O.tileID.isChildOf(A)||A.isChildOf(O.tileID))&&(O.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(A=>this.getTileByID(A))}getTileByID(A){return this._tiles[A]}getTerrainCoords(A){const C={};for(const O of this._renderableTilesKeys){const V=this._tiles[O].tileID;if(V.canonical.equals(A.canonical)){const x=A.clone();x.posMatrix=new Float64Array(16),a.aS(x.posMatrix,0,a.N,0,a.N,0,1),C[O]=x}else if(V.canonical.isChildOf(A.canonical)){const x=A.clone();x.posMatrix=new Float64Array(16);const s=V.canonical.z-A.canonical.z,i=V.canonical.x-(V.canonical.x>>s<<s),r=V.canonical.y-(V.canonical.y>>s<<s),l=a.N>>s;a.aS(x.posMatrix,0,l,0,l,0,1),a.$(x.posMatrix,x.posMatrix,[-i*l,-r*l,0]),C[O]=x}else if(A.canonical.isChildOf(V.canonical)){const x=A.clone();x.posMatrix=new Float64Array(16);const s=A.canonical.z-V.canonical.z,i=A.canonical.x-(A.canonical.x>>s<<s),r=A.canonical.y-(A.canonical.y>>s<<s),l=a.N>>s;a.aS(x.posMatrix,0,a.N,0,a.N,0,1),a.$(x.posMatrix,x.posMatrix,[i*l,r*l,0]),a.a0(x.posMatrix,x.posMatrix,[1/2**s,1/2**s,0]),C[O]=x}}return C}getSourceTile(A,C){const O=this.sourceCache._source;let V=A.overscaledZ-this.deltaZoom;if(V>O.maxzoom&&(V=O.maxzoom),V<O.minzoom)return null;this._sourceTileCache[A.key]||(this._sourceTileCache[A.key]=A.scaledTo(V).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[A.key]);if((!x||!x.dem)&&C)for(;V>=O.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(A.scaledTo(V--).key);return x}tilesAfterTime(A=Date.now()){return Object.values(this._tiles).filter(C=>C.timeAdded>=A)}}class fa{constructor(A,C,O){this.painter=A,this.sourceCache=new Pu(C),this.options=O,this.exaggeration=typeof O.exaggeration=="number"?O.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(A,C,O,V=a.N){var x;if(!(C>=0&&C<V&&O>=0&&O<V))return 0;const s=this.getTerrainData(A),i=(x=s.tile)===null||x===void 0?void 0:x.dem;if(!i)return 0;const r=function(z,Z,Y){var Ae=Z[0],Ie=Z[1];return z[0]=Y[0]*Ae+Y[4]*Ie+Y[12],z[1]=Y[1]*Ae+Y[5]*Ie+Y[13],z}([],[C/V*a.N,O/V*a.N],s.u_terrain_matrix),l=[r[0]*i.dim,r[1]*i.dim],d=Math.floor(l[0]),y=Math.floor(l[1]),I=l[0]-d,k=l[1]-y;return i.get(d,y)*(1-I)*(1-k)+i.get(d+1,y)*I*(1-k)+i.get(d,y+1)*(1-I)*k+i.get(d+1,y+1)*I*k}getElevationForLngLatZoom(A,C){const{tileID:O,mercatorX:V,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(A,C);return this.getElevation(O,V%a.N,x%a.N,a.N)}getElevation(A,C,O,V=a.N){return this.getDEMElevation(A,C,O,V)*this.exaggeration}getTerrainData(A){if(!this._emptyDemTexture){const V=this.painter.context,x=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new At(V,x,V.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new At(V,new a.R({width:1,height:1}),V.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(V.gl.NEAREST,V.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ao([])}const C=this.sourceCache.getSourceTile(A,!0);if(C&&C.dem&&(!C.demTexture||C.needsTerrainPrepare)){const V=this.painter.context;C.demTexture=this.painter.getTileTexture(C.dem.stride),C.demTexture?C.demTexture.update(C.dem.getPixels(),{premultiply:!1}):C.demTexture=new At(V,C.dem.getPixels(),V.gl.RGBA,{premultiply:!1}),C.demTexture.bind(V.gl.NEAREST,V.gl.CLAMP_TO_EDGE),C.needsTerrainPrepare=!1}const O=C&&C+C.tileID.key+A.key;if(O&&!this._demMatrixCache[O]){const V=this.sourceCache.sourceCache._source.maxzoom;let x=A.canonical.z-C.tileID.canonical.z;A.overscaledZ>A.canonical.z&&(A.canonical.z>=V?x=A.canonical.z-V:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const s=A.canonical.x-(A.canonical.x>>x<<x),i=A.canonical.y-(A.canonical.y>>x<<x),r=a.bc(new Float64Array(16),[1/(a.N<<x),1/(a.N<<x),0]);a.$(r,r,[s*a.N,i*a.N,0]),this._demMatrixCache[A.key]={matrix:r,coord:A}}return{u_depth:2,u_terrain:3,u_terrain_dim:C&&C.dem&&C.dem.dim||1,u_terrain_matrix:O?this._demMatrixCache[A.key].matrix:this._emptyDemMatrix,u_terrain_unpack:C&&C.dem&&C.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(C&&C.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:C}}getFramebuffer(A){const C=this.painter,O=C.width/devicePixelRatio,V=C.height/devicePixelRatio;return!this._fbo||this._fbo.width===O&&this._fbo.height===V||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new At(C.context,{width:O,height:V,data:null},C.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(C.context.gl.NEAREST,C.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new At(C.context,{width:O,height:V,data:null},C.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(C.context.gl.NEAREST,C.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=C.context.createFramebuffer(O,V,!0,!1),this._fbo.depthAttachment.set(C.context.createRenderbuffer(C.context.gl.DEPTH_COMPONENT16,O,V))),this._fbo.colorAttachment.set(A==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const A=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const C=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,s=0;x<this._coordsTextureSize;x++)for(let i=0;i<this._coordsTextureSize;i++,s+=4)C[s+0]=255&i,C[s+1]=255&x,C[s+2]=i>>8<<4|x>>8,C[s+3]=0;const O=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(C.buffer)),V=new At(A,O,A.gl.RGBA,{premultiply:!1});return V.bind(A.gl.NEAREST,A.gl.CLAMP_TO_EDGE),this._coordsTexture=V,V}pointCoordinate(A){const C=new Uint8Array(4),O=this.painter.context,V=O.gl;O.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),V.readPixels(A.x,this.painter.height/devicePixelRatio-A.y-1,1,1,V.RGBA,V.UNSIGNED_BYTE,C),O.bindFramebuffer.set(null);const x=C[0]+(C[2]>>4<<8),s=C[1]+((15&C[2])<<8),i=this.coordsIndex[255-C[3]],r=i&&this.sourceCache.getTileByID(i);if(!r)return null;const l=this._coordsTextureSize,d=(1<<r.tileID.canonical.z)*l;return new a.U(this._allowMercatorOverflow(A,(r.tileID.canonical.x*l+x)/d),(r.tileID.canonical.y*l+s)/d,this.getElevation(r.tileID,x,s,l))}getTerrainMesh(){if(this._mesh)return this._mesh;const A=this.painter.context,C=new a.bd,O=new a.b0,V=this.meshSize,x=a.N/V,s=V*V;for(let y=0;y<=V;y++)for(let I=0;I<=V;I++)C.emplaceBack(I*x,y*x,0);for(let y=0;y<s;y+=V+1)for(let I=0;I<V;I++)O.emplaceBack(I+y,V+I+y+1,V+I+y+2),O.emplaceBack(I+y,V+I+y+2,I+y+1);const i=C.length,r=i+2*(V+1);for(const y of[0,1])for(let I=0;I<=V;I++)for(const k of[0,1])C.emplaceBack(I*x,y*a.N,k);for(let y=0;y<2*V;y+=2)O.emplaceBack(r+y,r+y+1,r+y+3),O.emplaceBack(r+y,r+y+3,r+y+2),O.emplaceBack(i+y,i+y+3,i+y+1),O.emplaceBack(i+y,i+y+2,i+y+3);const l=C.length,d=l+2*(V+1);for(const y of[0,1])for(let I=0;I<=V;I++)for(const k of[0,1])C.emplaceBack(y*a.N,I*x,k);for(let y=0;y<2*V;y+=2)O.emplaceBack(l+y,l+y+1,l+y+3),O.emplaceBack(l+y,l+y+3,l+y+2),O.emplaceBack(d+y,d+y+3,d+y+1),O.emplaceBack(d+y,d+y+2,d+y+3);return this._mesh={indexBuffer:A.createIndexBuffer(O),vertexBuffer:A.createVertexBuffer(C,il.members),segments:a.S.simpleSegment(0,0,C.length,O.length)},this._mesh}getMeshFrameDelta(A){return 2*Math.PI*a.be/Math.pow(2,A)/5}getMinTileElevationForLngLatZoom(A,C){var O;const{tileID:V}=this._getOverscaledTileIDFromLngLatZoom(A,C);return(O=this.getMinMaxElevation(V).minElevation)!==null&&O!==void 0?O:0}getMinMaxElevation(A){const C=this.getTerrainData(A).tile,O={minElevation:null,maxElevation:null};return C&&C.dem&&(O.minElevation=C.dem.min*this.exaggeration,O.maxElevation=C.dem.max*this.exaggeration),O}_getOverscaledTileIDFromLngLatZoom(A,C){const O=a.U.fromLngLat(A.wrap()),V=(1<<C)*a.N,x=O.x*V,s=O.y*V,i=Math.floor(x/a.N),r=Math.floor(s/a.N);return{tileID:new a.O(C,0,C,i,r),mercatorX:x,mercatorY:s}}_allowMercatorOverflow(A,C){const O=A.x<this.painter.width/2;let V=a.bf(C);const x=this.painter.transform.center.lng;return O&&Math.sign(V)>0&&Math.sign(x)<0||!O&&Math.sign(V)<0&&Math.sign(x)>0?(V=360*Math.sign(x)+V,a.G(V)):C}}class bu{constructor(A,C,O){this._context=A,this._size=C,this._tileSize=O,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const A of this._objects)A.texture.destroy(),A.fbo.destroy()}_createObject(A){const C=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),O=new At(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return O.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),C.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),C.colorAttachment.set(O.texture),{id:A,fbo:C,texture:O,stamp:-1,inUse:!1}}getObjectForId(A){return this._objects[A]}useObject(A){A.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(C=>A.id!==C),this._recentlyUsed.push(A.id)}stampObject(A){A.stamp=++this._stamp}getOrCreateFreeObject(){for(const C of this._recentlyUsed)if(!this._objects[C].inUse)return this._objects[C];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const A=this._createObject(this._objects.length);return this._objects.push(A),A}freeObject(A){A.inUse=!1}freeAllObjects(){for(const A of this._objects)this.freeObject(A)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(A=>!A.inUse)===!1}}const Is={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Bo{constructor(A,C){this.painter=A,this.terrain=C,this.pool=new bu(A.context,30,C.sourceCache.tileSize*C.qualityFactor)}destruct(){this.pool.destruct()}getTexture(A){return this.pool.getObjectForId(A.rtt[this._stacks.length-1].id).texture}prepareForRender(A,C){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=A._order.filter(O=>!A._layers[O].isHidden(C)),this._coordsDescendingInv={};for(const O in A.sourceCaches){this._coordsDescendingInv[O]={};const V=A.sourceCaches[O].getVisibleCoordinates();for(const x of V){const s=this.terrain.sourceCache.getTerrainCoords(x);for(const i in s)this._coordsDescendingInv[O][i]||(this._coordsDescendingInv[O][i]=[]),this._coordsDescendingInv[O][i].push(s[i])}}this._coordsDescendingInvStr={};for(const O of A._order){const V=A._layers[O],x=V.source;if(Is[V.type]&&!this._coordsDescendingInvStr[x]){this._coordsDescendingInvStr[x]={};for(const s in this._coordsDescendingInv[x])this._coordsDescendingInvStr[x][s]=this._coordsDescendingInv[x][s].map(i=>i.key).sort().join()}}for(const O of this._renderableTiles)for(const V in this._coordsDescendingInvStr){const x=this._coordsDescendingInvStr[V][O.tileID.key];x&&x!==O.rttCoords[V]&&(O.rtt=[])}}renderLayer(A){if(A.isHidden(this.painter.transform.zoom))return!1;const C=A.type,O=this.painter,V=this._renderableLayerIds[this._renderableLayerIds.length-1]===A.id;if(Is[C]&&(this._prevType&&Is[this._prevType]||this._stacks.push([]),this._prevType=C,this._stacks[this._stacks.length-1].push(A.id),!V))return!0;if(Is[this._prevType]||Is[C]&&V){this._prevType=C;const x=this._stacks.length-1,s=this._stacks[x]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(ns(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[x]){const l=this.pool.getObjectForId(i.rtt[x].id);if(l.stamp===i.rtt[x].stamp){this.pool.useObject(l);continue}}const r=this.pool.getOrCreateFreeObject();this.pool.useObject(r),this.pool.stampObject(r),i.rtt[x]={id:r.id,stamp:r.stamp},O.context.bindFramebuffer.set(r.fbo.framebuffer),O.context.clear({color:a.aT.transparent,stencil:0}),O.currentStencilSource=void 0;for(let l=0;l<s.length;l++){const d=O.style._layers[s[l]],y=d.source?this._coordsDescendingInv[d.source][i.tileID.key]:[i.tileID];O.context.viewport.set([0,0,r.fbo.width,r.fbo.height]),O._renderTileClippingMasks(d,y),O.renderLayer(O,O.style.sourceCaches[d.source],d,y),d.source&&(i.rttCoords[d.source]=this._coordsDescendingInvStr[d.source][i.tileID.key])}}return ns(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Is[C]}return!1}}const Mi=N,zi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Es=Q=>{Q.touchstart=Q.dragStart,Q.touchmoveWindow=Q.dragMove,Q.touchend=Q.dragEnd},wu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Uo{constructor(A,C,O=!1){this.mousedown=s=>{this.startMouse(a.e({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),$.mousePos(this.element,s)),$.addEventListener(window,"mousemove",this.mousemove),$.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=s=>{this.moveMouse(s,$.mousePos(this.element,s))},this.mouseup=s=>{this.mouseRotate.dragEnd(s),this.mousePitch&&this.mousePitch.dragEnd(s),this.offTemp()},this.touchstart=s=>{s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=$.touchPos(this.element,s.targetTouches)[0],this.startTouch(s,this._startPos),$.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),$.addEventListener(window,"touchend",this.touchend))},this.touchmove=s=>{s.targetTouches.length!==1?this.reset():(this._lastPos=$.touchPos(this.element,s.targetTouches)[0],this.moveTouch(s,this._lastPos))},this.touchend=s=>{s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const V=A.dragRotate._mouseRotate.getClickTolerance(),x=A.dragRotate._mousePitch.getClickTolerance();this.element=C,this.mouseRotate=wo({clickTolerance:V,enable:!0}),this.touchRotate=(({enable:s,clickTolerance:i,bearingDegreesPerPixelMoved:r=.8})=>{const l=new Yu;return new ro({clickTolerance:i,move:(d,y)=>({bearingDelta:(y.x-d.x)*r}),moveStateManager:l,enable:s,assignEvents:Es})})({clickTolerance:V,enable:!0}),this.map=A,O&&(this.mousePitch=Ll({clickTolerance:x,enable:!0}),this.touchPitch=(({enable:s,clickTolerance:i,pitchDegreesPerPixelMoved:r=-.5})=>{const l=new Yu;return new ro({clickTolerance:i,move:(d,y)=>({pitchDelta:(y.y-d.y)*r}),moveStateManager:l,enable:s,assignEvents:Es})})({clickTolerance:x,enable:!0})),$.addEventListener(C,"mousedown",this.mousedown),$.addEventListener(C,"touchstart",this.touchstart,{passive:!1}),$.addEventListener(C,"touchcancel",this.reset)}startMouse(A,C){this.mouseRotate.dragStart(A,C),this.mousePitch&&this.mousePitch.dragStart(A,C),$.disableDrag()}startTouch(A,C){this.touchRotate.dragStart(A,C),this.touchPitch&&this.touchPitch.dragStart(A,C),$.disableDrag()}moveMouse(A,C){const O=this.map,{bearingDelta:V}=this.mouseRotate.dragMove(A,C)||{};if(V&&O.setBearing(O.getBearing()+V),this.mousePitch){const{pitchDelta:x}=this.mousePitch.dragMove(A,C)||{};x&&O.setPitch(O.getPitch()+x)}}moveTouch(A,C){const O=this.map,{bearingDelta:V}=this.touchRotate.dragMove(A,C)||{};if(V&&O.setBearing(O.getBearing()+V),this.touchPitch){const{pitchDelta:x}=this.touchPitch.dragMove(A,C)||{};x&&O.setPitch(O.getPitch()+x)}}off(){const A=this.element;$.removeEventListener(A,"mousedown",this.mousedown),$.removeEventListener(A,"touchstart",this.touchstart,{passive:!1}),$.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),$.removeEventListener(window,"touchend",this.touchend),$.removeEventListener(A,"touchcancel",this.reset),this.offTemp()}offTemp(){$.enableDrag(),$.removeEventListener(window,"mousemove",this.mousemove),$.removeEventListener(window,"mouseup",this.mouseup),$.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),$.removeEventListener(window,"touchend",this.touchend)}}let ms;function Al(Q,A,C){if(Q=new a.L(Q.lng,Q.lat),A){const O=new a.L(Q.lng-360,Q.lat),V=new a.L(Q.lng+360,Q.lat),x=C.locationPoint(Q).distSqr(A);C.locationPoint(O).distSqr(A)<x?Q=O:C.locationPoint(V).distSqr(A)<x&&(Q=V)}for(;Math.abs(Q.lng-C.center.lng)>180;){const O=C.locationPoint(Q);if(O.x>=0&&O.y>=0&&O.x<=C.width&&O.y<=C.height)break;Q.lng>C.center.lng?Q.lng-=360:Q.lng+=360}return Q}const zs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function T(Q,A,C){const O=Q.classList;for(const V in zs)O.remove(`maplibregl-${C}-anchor-${V}`);O.add(`maplibregl-${C}-anchor-${A}`)}class L extends a.E{constructor(A){if(super(),this._onKeyPress=C=>{const O=C.code,V=C.charCode||C.keyCode;O!=="Space"&&O!=="Enter"&&V!==32&&V!==13||this.togglePopup()},this._onMapClick=C=>{const O=C.originalEvent.target,V=this._element;this._popup&&(O===V||V.contains(O))&&this.togglePopup()},this._update=C=>{if(!this._map)return;const O=this._map.loaded()&&!this._map.isMoving();((C==null?void 0:C.type)==="terrain"||(C==null?void 0:C.type)==="render"&&!O)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Al(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let V="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?V=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(V=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),C&&C.type!=="moveend"||(this._pos=this._pos.round()),$.setTransform(this._element,`${zs[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${V}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const s=this._map.unproject(this._pos),i=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=s.distanceTo(this._lngLat)>20*i?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=C=>{if(!this._isDragging){const O=this._clickTolerance||this._map._clickTolerance;this._isDragging=C.point.dist(this._pointerdownPos)>=O}this._isDragging&&(this._pos=C.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=C=>{this._element.contains(C.originalEvent.target)&&(C.preventDefault(),this._positionDelta=C.point.sub(this._pos).add(this._offset),this._pointerdownPos=C.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=A&&A.anchor||"center",this._color=A&&A.color||"#3FB1CE",this._scale=A&&A.scale||1,this._draggable=A&&A.draggable||!1,this._clickTolerance=A&&A.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=A&&A.rotation||0,this._rotationAlignment=A&&A.rotationAlignment||"auto",this._pitchAlignment=A&&A.pitchAlignment&&A.pitchAlignment!=="auto"?A.pitchAlignment:this._rotationAlignment,A&&A.element)this._element=A.element,this._offset=a.P.convert(A&&A.offset||[0,0]);else{this._defaultMarker=!0,this._element=$.create("div"),this._element.setAttribute("aria-label","Map marker");const C=$.createNS("http://www.w3.org/2000/svg","svg"),O=41,V=27;C.setAttributeNS(null,"display","block"),C.setAttributeNS(null,"height",`${O}px`),C.setAttributeNS(null,"width",`${V}px`),C.setAttributeNS(null,"viewBox",`0 0 ${V} ${O}`);const x=$.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const s=$.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const i=$.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"transform","translate(3.0, 29.0)"),i.setAttributeNS(null,"fill","#000000");const r=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ae of r){const Ie=$.createNS("http://www.w3.org/2000/svg","ellipse");Ie.setAttributeNS(null,"opacity","0.04"),Ie.setAttributeNS(null,"cx","10.5"),Ie.setAttributeNS(null,"cy","5.80029008"),Ie.setAttributeNS(null,"rx",Ae.rx),Ie.setAttributeNS(null,"ry",Ae.ry),i.appendChild(Ie)}const l=$.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill",this._color);const d=$.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),l.appendChild(d);const y=$.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"fill","#000000");const I=$.createNS("http://www.w3.org/2000/svg","path");I.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),y.appendChild(I);const k=$.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(6.0, 7.0)"),k.setAttributeNS(null,"fill","#FFFFFF");const z=$.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Z=$.createNS("http://www.w3.org/2000/svg","circle");Z.setAttributeNS(null,"fill","#000000"),Z.setAttributeNS(null,"opacity","0.25"),Z.setAttributeNS(null,"cx","5.5"),Z.setAttributeNS(null,"cy","5.5"),Z.setAttributeNS(null,"r","5.4999962");const Y=$.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),z.appendChild(Z),z.appendChild(Y),s.appendChild(i),s.appendChild(l),s.appendChild(y),s.appendChild(k),s.appendChild(z),C.appendChild(s),C.setAttributeNS(null,"height",O*this._scale+"px"),C.setAttributeNS(null,"width",V*this._scale+"px"),this._element.appendChild(C),this._offset=a.P.convert(A&&A.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",C=>{C.preventDefault()}),this._element.addEventListener("mousedown",C=>{C.preventDefault()}),T(this._element,this._anchor,"marker"),A&&A.className)for(const C of A.className.split(" "))this._element.classList.add(C);this._popup=null}addTo(A){return this.remove(),this._map=A,A.getCanvasContainer().appendChild(this._element),A.on("move",this._update),A.on("moveend",this._update),A.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),$.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(A){return this._lngLat=a.L.convert(A),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(A){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),A){if(!("offset"in A.options)){const V=Math.abs(13.5)/Math.SQRT2;A.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[V,-1*(38.1-13.5+V)],"bottom-right":[-V,-1*(38.1-13.5+V)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=A,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const A=this._popup;return A?(A.isOpen()?A.remove():A.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(A){return this._offset=a.P.convert(A),this._update(),this}addClassName(A){this._element.classList.add(A)}removeClassName(A){this._element.classList.remove(A)}toggleClassName(A){return this._element.classList.toggle(A)}setDraggable(A){return this._draggable=!!A,this._map&&(A?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(A){return this._rotation=A||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(A){return this._rotationAlignment=A||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(A){return this._pitchAlignment=A&&A!=="auto"?A:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const R={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let F=0,te=!1;const ue={maxWidth:100,unit:"metric"};function le(Q,A,C){const O=C&&C.maxWidth||100,V=Q._container.clientHeight/2,x=Q.unproject([0,V]),s=Q.unproject([O,V]),i=x.distanceTo(s);if(C&&C.unit==="imperial"){const r=3.2808*i;r>5280?Se(A,O,r/5280,Q._getUIString("ScaleControl.Miles")):Se(A,O,r,Q._getUIString("ScaleControl.Feet"))}else C&&C.unit==="nautical"?Se(A,O,i/1852,Q._getUIString("ScaleControl.NauticalMiles")):i>=1e3?Se(A,O,i/1e3,Q._getUIString("ScaleControl.Kilometers")):Se(A,O,i,Q._getUIString("ScaleControl.Meters"))}function Se(Q,A,C,O){const V=function(x){const s=Math.pow(10,`${Math.floor(x)}`.length-1);let i=x/s;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(r){const l=Math.pow(10,Math.ceil(-Math.log(r)/Math.LN10));return Math.round(r*l)/l}(i),s*i}(C);Q.style.width=A*(V/C)+"px",Q.innerHTML=`${V}&nbsp;${O}`}const Xe={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},bt=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function kt(Q){if(Q){if(typeof Q=="number"){const A=Math.round(Math.abs(Q)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,Q),"top-left":new a.P(A,A),"top-right":new a.P(-A,A),bottom:new a.P(0,-Q),"bottom-left":new a.P(A,-A),"bottom-right":new a.P(-A,-A),left:new a.P(Q,0),right:new a.P(-Q,0)}}if(Q instanceof a.P||Array.isArray(Q)){const A=a.P.convert(Q);return{center:A,top:A,"top-left":A,"top-right":A,bottom:A,"bottom-left":A,"bottom-right":A,left:A,right:A}}return{center:a.P.convert(Q.center||[0,0]),top:a.P.convert(Q.top||[0,0]),"top-left":a.P.convert(Q["top-left"]||[0,0]),"top-right":a.P.convert(Q["top-right"]||[0,0]),bottom:a.P.convert(Q.bottom||[0,0]),"bottom-left":a.P.convert(Q["bottom-left"]||[0,0]),"bottom-right":a.P.convert(Q["bottom-right"]||[0,0]),left:a.P.convert(Q.left||[0,0]),right:a.P.convert(Q.right||[0,0])}}return kt(new a.P(0,0))}const ri={extend:(Q,...A)=>a.e(Q,...A),run(Q){Q()},logToElement(Q,A=!1,C="log"){const O=window.document.getElementById(C);O&&(A&&(O.innerHTML=""),O.innerHTML+=`<br>${Q}`)}},Ht=N;class Qt{static get version(){return Ht}static get workerCount(){return _n.workerCount}static set workerCount(A){_n.workerCount=A}static get maxParallelImageRequests(){return a.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(A){a.c.MAX_PARALLEL_IMAGE_REQUESTS=A}static get workerUrl(){return a.c.WORKER_URL}static set workerUrl(A){a.c.WORKER_URL=A}static addProtocol(A,C){a.c.REGISTERED_PROTOCOLS[A]=C}static removeProtocol(A){delete a.c.REGISTERED_PROTOCOLS[A]}}return Qt.Map=class extends br{constructor(Q){if(a.bg.mark(a.bh.create),(Q=a.e({},zi,Q)).minZoom!=null&&Q.maxZoom!=null&&Q.minZoom>Q.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Q.minPitch!=null&&Q.maxPitch!=null&&Q.minPitch>Q.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Q.minPitch!=null&&Q.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(Q.maxPitch!=null&&Q.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new aa(Q.minZoom,Q.maxZoom,Q.minPitch,Q.maxPitch,Q.renderWorldCopies),{bearingSnap:Q.bearingSnap}),this._cooperativeGesturesOnWheel=A=>{this._onCooperativeGesture(A,A[this._metaKey],1)},this._contextLost=A=>{A.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.k("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=Q.interactive,this._cooperativeGestures=Q.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=Q.maxTileCacheSize,this._maxTileCacheZoomLevels=Q.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=Q.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Q.preserveDrawingBuffer,this._antialias=Q.antialias,this._trackResize=Q.trackResize,this._bearingSnap=Q.bearingSnap,this._refreshExpiredTiles=Q.refreshExpiredTiles,this._fadeDuration=Q.fadeDuration,this._crossSourceCollisions=Q.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Q.collectResourceTiming,this._renderTaskQueue=new Zn,this._controls=[],this._mapId=a.a2(),this._locale=a.e({},ir,Q.locale),this._clickTolerance=Q.clickTolerance,this._overridePixelRatio=Q.pixelRatio,this._maxCanvasSize=Q.maxCanvasSize,this.transformCameraUpdate=Q.transformCameraUpdate,this._imageQueueHandle=Ke.addThrottleControl(()=>this.isMoving()),this._requestManager=new ht(Q.transformRequest),typeof Q.container=="string"){if(this._container=document.getElementById(Q.container),!this._container)throw new Error(`Container '${Q.container}' not found.`)}else{if(!(Q.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Q.container}if(Q.maxBounds&&this.setMaxBounds(Q.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const C=Ma(O=>{this._trackResize&&!this._removed&&this.resize(O)._update()},50);this._resizeObserver=new ResizeObserver(O=>{A?C(O):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Gu(this,Q),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=Q.hash&&new Oa(typeof Q.hash=="string"&&Q.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:Q.center,zoom:Q.zoom,bearing:Q.bearing,pitch:Q.pitch}),Q.bounds&&(this.resize(),this.fitBounds(Q.bounds,a.e({},Q.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Q.localIdeographFontFamily,this._validateStyle=Q.validateStyle,Q.style&&this.setStyle(Q.style,{localIdeographFontFamily:Q.localIdeographFontFamily}),Q.attributionControl&&this.addControl(new vs({customAttribution:Q.customAttribution})),Q.maplibreLogo&&this.addControl(new gn,Q.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new a.k(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new a.k(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new a.k("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(Q,A){if(A===void 0&&(A=Q.getDefaultPosition?Q.getDefaultPosition():"top-right"),!Q||!Q.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const C=Q.onAdd(this);this._controls.push(Q);const O=this._controlPositions[A];return A.indexOf("bottom")!==-1?O.insertBefore(C,O.firstChild):O.appendChild(C),this}removeControl(Q){if(!Q||!Q.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const A=this._controls.indexOf(Q);return A>-1&&this._controls.splice(A,1),Q.onRemove(this),this}hasControl(Q){return this._controls.indexOf(Q)>-1}calculateCameraOptionsFromTo(Q,A,C,O){return O==null&&this.terrain&&(O=this.terrain.getElevationForLngLatZoom(C,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(Q,A,C,O)}resize(Q){var A;const C=this._containerDimensions(),O=C[0],V=C[1],x=this._getClampedPixelRatio(O,V);if(this._resizeCanvas(O,V,x),this.painter.resize(O,V,x),this.painter.overLimit()){const i=this.painter.context.gl;this._maxCanvasSize=[i.drawingBufferWidth,i.drawingBufferHeight];const r=this._getClampedPixelRatio(O,V);this._resizeCanvas(O,V,r),this.painter.resize(O,V,r)}this.transform.resize(O,V),(A=this._requestedCameraState)===null||A===void 0||A.resize(O,V);const s=!this._moving;return s&&(this.stop(),this.fire(new a.k("movestart",Q)).fire(new a.k("move",Q))),this.fire(new a.k("resize",Q)),s&&this.fire(new a.k("moveend",Q)),this}_getClampedPixelRatio(Q,A){const{0:C,1:O}=this._maxCanvasSize,V=this.getPixelRatio(),x=Q*V,s=A*V;return Math.min(x>C?C/x:1,s>O?O/s:1)*V}getPixelRatio(){var Q;return(Q=this._overridePixelRatio)!==null&&Q!==void 0?Q:devicePixelRatio}setPixelRatio(Q){this._overridePixelRatio=Q,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(Q){return this.transform.setMaxBounds(Ni.convert(Q)),this._update()}setMinZoom(Q){if((Q=Q??-2)>=-2&&Q<=this.transform.maxZoom)return this.transform.minZoom=Q,this._update(),this.getZoom()<Q&&this.setZoom(Q),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(Q){if((Q=Q??22)>=this.transform.minZoom)return this.transform.maxZoom=Q,this._update(),this.getZoom()>Q&&this.setZoom(Q),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(Q){if((Q=Q??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(Q>=0&&Q<=this.transform.maxPitch)return this.transform.minPitch=Q,this._update(),this.getPitch()<Q&&this.setPitch(Q),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(Q){if((Q=Q??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(Q>=this.transform.minPitch)return this.transform.maxPitch=Q,this._update(),this.getPitch()>Q&&this.setPitch(Q),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(Q){return this.transform.renderWorldCopies=Q,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(Q){return this._cooperativeGestures=Q,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(Q){return this.transform.locationPoint(a.L.convert(Q),this.style&&this.terrain)}unproject(Q){return this.transform.pointLocation(a.P.convert(Q),this.terrain)}isMoving(){var Q;return this._moving||((Q=this.handlers)===null||Q===void 0?void 0:Q.isMoving())}isZooming(){var Q;return this._zooming||((Q=this.handlers)===null||Q===void 0?void 0:Q.isZooming())}isRotating(){var Q;return this._rotating||((Q=this.handlers)===null||Q===void 0?void 0:Q.isRotating())}_createDelegatedListener(Q,A,C){if(Q==="mouseenter"||Q==="mouseover"){let O=!1;return{layer:A,listener:C,delegates:{mousemove:x=>{const s=this.getLayer(A)?this.queryRenderedFeatures(x.point,{layers:[A]}):[];s.length?O||(O=!0,C.call(this,new Nt(Q,this,x.originalEvent,{features:s}))):O=!1},mouseout:()=>{O=!1}}}}if(Q==="mouseleave"||Q==="mouseout"){let O=!1;return{layer:A,listener:C,delegates:{mousemove:s=>{(this.getLayer(A)?this.queryRenderedFeatures(s.point,{layers:[A]}):[]).length?O=!0:O&&(O=!1,C.call(this,new Nt(Q,this,s.originalEvent)))},mouseout:s=>{O&&(O=!1,C.call(this,new Nt(Q,this,s.originalEvent)))}}}}{const O=V=>{const x=this.getLayer(A)?this.queryRenderedFeatures(V.point,{layers:[A]}):[];x.length&&(V.features=x,C.call(this,V),delete V.features)};return{layer:A,listener:C,delegates:{[Q]:O}}}}on(Q,A,C){if(C===void 0)return super.on(Q,A);const O=this._createDelegatedListener(Q,A,C);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Q]=this._delegatedListeners[Q]||[],this._delegatedListeners[Q].push(O);for(const V in O.delegates)this.on(V,O.delegates[V]);return this}once(Q,A,C){if(C===void 0)return super.once(Q,A);const O=this._createDelegatedListener(Q,A,C);for(const V in O.delegates)this.once(V,O.delegates[V]);return this}off(Q,A,C){return C===void 0?super.off(Q,A):(this._delegatedListeners&&this._delegatedListeners[Q]&&(O=>{const V=this._delegatedListeners[Q];for(let x=0;x<V.length;x++){const s=V[x];if(s.layer===A&&s.listener===C){for(const i in s.delegates)this.off(i,s.delegates[i]);return V.splice(x,1),this}}})(),this)}queryRenderedFeatures(Q,A){if(!this.style)return[];let C;const O=Q instanceof a.P||Array.isArray(Q),V=O?Q:[[0,0],[this.transform.width,this.transform.height]];if(A=A||(O?{}:Q)||{},V instanceof a.P||typeof V[0]=="number")C=[a.P.convert(V)];else{const x=a.P.convert(V[0]),s=a.P.convert(V[1]);C=[x,new a.P(s.x,x.y),s,new a.P(x.x,s.y),x]}return this.style.queryRenderedFeatures(C,A,this.transform)}querySourceFeatures(Q,A){return this.style.querySourceFeatures(Q,A)}setStyle(Q,A){return(A=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},A)).diff!==!1&&A.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&Q?(this._diffStyle(Q,A),this):(this._localIdeographFontFamily=A.localIdeographFontFamily,this._updateStyle(Q,A))}setTransformRequest(Q){return this._requestManager.setTransformRequest(Q),this}_getUIString(Q){const A=this._locale[Q];if(A==null)throw new Error(`Missing UI string '${Q}'`);return A}_updateStyle(Q,A){if(A.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(Q,A));const C=this.style&&A.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!Q)),Q?(this.style=new Ar(this,A||{}),this.style.setEventedParent(this,{style:this.style}),typeof Q=="string"?this.style.loadURL(Q,A,C):this.style.loadJSON(Q,A,C),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ar(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(Q,A){if(typeof Q=="string"){const C=this._requestManager.transformRequest(Q,st.Style);a.f(C,(O,V)=>{O?this.fire(new a.j(O)):V&&this._updateDiff(V,A)})}else typeof Q=="object"&&this._updateDiff(Q,A)}_updateDiff(Q,A){try{this.style.setState(Q,A)&&this._update(!0)}catch(C){a.w(`Unable to perform style diff: ${C.message||C.error||C}.  Rebuilding the style from scratch.`),this._updateStyle(Q,A)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(Q,A){return this._lazyInitEmptyStyle(),this.style.addSource(Q,A),this._update(!0)}isSourceLoaded(Q){const A=this.style&&this.style.sourceCaches[Q];if(A!==void 0)return A.loaded();this.fire(new a.j(new Error(`There is no source with ID '${Q}'`)))}setTerrain(Q){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),Q){const A=this.style.sourceCaches[Q.source];if(!A)throw new Error(`cannot load terrain, because there exists no source with ID: ${Q.source}`);for(const C in this.style._layers){const O=this.style._layers[C];O.type==="hillshade"&&O.source===Q.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new fa(this.painter,A,Q),this.painter.renderToTexture=new Bo(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=C=>{C.dataType==="style"?this.terrain.sourceCache.freeRtt():C.dataType==="source"&&C.tile&&(C.sourceId!==Q.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(C.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:Q})),this}getTerrain(){var Q,A;return(A=(Q=this.terrain)===null||Q===void 0?void 0:Q.options)!==null&&A!==void 0?A:null}areTilesLoaded(){const Q=this.style&&this.style.sourceCaches;for(const A in Q){const C=Q[A]._tiles;for(const O in C){const V=C[O];if(V.state!=="loaded"&&V.state!=="errored")return!1}}return!0}addSourceType(Q,A,C){return this._lazyInitEmptyStyle(),this.style.addSourceType(Q,A,C)}removeSource(Q){return this.style.removeSource(Q),this._update(!0)}getSource(Q){return this.style.getSource(Q)}addImage(Q,A,C={}){const{pixelRatio:O=1,sdf:V=!1,stretchX:x,stretchY:s,content:i}=C;if(this._lazyInitEmptyStyle(),!(A instanceof HTMLImageElement||a.a(A))){if(A.width===void 0||A.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:l,data:d}=A,y=A;return this.style.addImage(Q,{data:new a.R({width:r,height:l},new Uint8Array(d)),pixelRatio:O,stretchX:x,stretchY:s,content:i,sdf:V,version:0,userImage:y}),y.onAdd&&y.onAdd(this,Q),this}}{const{width:r,height:l,data:d}=a.h.getImageData(A);this.style.addImage(Q,{data:new a.R({width:r,height:l},d),pixelRatio:O,stretchX:x,stretchY:s,content:i,sdf:V,version:0})}}updateImage(Q,A){const C=this.style.getImage(Q);if(!C)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const O=A instanceof HTMLImageElement||a.a(A)?a.h.getImageData(A):A,{width:V,height:x,data:s}=O;if(V===void 0||x===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(V!==C.data.width||x!==C.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const i=!(A instanceof HTMLImageElement||a.a(A));return C.data.replace(s,i),this.style.updateImage(Q,C),this}getImage(Q){return this.style.getImage(Q)}hasImage(Q){return Q?!!this.style.getImage(Q):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(Q){this.style.removeImage(Q)}loadImage(Q,A){Ke.getImage(this._requestManager.transformRequest(Q,st.Image),A)}listImages(){return this.style.listImages()}addLayer(Q,A){return this._lazyInitEmptyStyle(),this.style.addLayer(Q,A),this._update(!0)}moveLayer(Q,A){return this.style.moveLayer(Q,A),this._update(!0)}removeLayer(Q){return this.style.removeLayer(Q),this._update(!0)}getLayer(Q){return this.style.getLayer(Q)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(Q,A,C){return this.style.setLayerZoomRange(Q,A,C),this._update(!0)}setFilter(Q,A,C={}){return this.style.setFilter(Q,A,C),this._update(!0)}getFilter(Q){return this.style.getFilter(Q)}setPaintProperty(Q,A,C,O={}){return this.style.setPaintProperty(Q,A,C,O),this._update(!0)}getPaintProperty(Q,A){return this.style.getPaintProperty(Q,A)}setLayoutProperty(Q,A,C,O={}){return this.style.setLayoutProperty(Q,A,C,O),this._update(!0)}getLayoutProperty(Q,A){return this.style.getLayoutProperty(Q,A)}setGlyphs(Q,A={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(Q,A),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(Q,A,C={}){return this._lazyInitEmptyStyle(),this.style.addSprite(Q,A,C,O=>{O||this._update(!0)}),this}removeSprite(Q){return this._lazyInitEmptyStyle(),this.style.removeSprite(Q),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(Q,A={}){return this._lazyInitEmptyStyle(),this.style.setSprite(Q,A,C=>{C||this._update(!0)}),this}setLight(Q,A={}){return this._lazyInitEmptyStyle(),this.style.setLight(Q,A),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(Q,A){return this.style.setFeatureState(Q,A),this._update()}removeFeatureState(Q,A){return this.style.removeFeatureState(Q,A),this._update()}getFeatureState(Q){return this.style.getFeatureState(Q)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let Q=0,A=0;return this._container&&(Q=this._container.clientWidth||400,A=this._container.clientHeight||300),[Q,A]}_setupContainer(){const Q=this._container;Q.classList.add("maplibregl-map");const A=this._canvasContainer=$.create("div","maplibregl-canvas-container",Q);this._interactive&&A.classList.add("maplibregl-interactive"),this._canvas=$.create("canvas","maplibregl-canvas",A),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const C=this._containerDimensions(),O=this._getClampedPixelRatio(C[0],C[1]);this._resizeCanvas(C[0],C[1],O);const V=this._controlContainer=$.create("div","maplibregl-control-container",Q),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{x[s]=$.create("div",`maplibregl-ctrl-${s} `,V)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=$.create("div","maplibregl-cooperative-gesture-screen",this._container);let Q=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(Q=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${Q}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){$.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(Q,A,C){this._canvas.width=Math.floor(C*Q),this._canvas.height=Math.floor(C*A),this._canvas.style.width=`${Q}px`,this._canvas.style.height=`${A}px`}_setupPainter(){const Q={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let A=null;this._canvas.addEventListener("webglcontextcreationerror",O=>{A={requestedAttributes:Q},O&&(A.statusMessage=O.statusMessage,A.type=O.type)},{once:!0});const C=this._canvas.getContext("webgl2",Q)||this._canvas.getContext("webgl",Q);if(!C){const O="Failed to initialize WebGL";throw A?(A.message=O,new Error(JSON.stringify(A))):new Error(O)}this.painter=new vr(C,this.transform),he.testSupport(C)}_onCooperativeGesture(Q,A,C){return!A&&C<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(Q){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||Q,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(Q){return this._update(),this._renderTaskQueue.add(Q)}_cancelRenderFrame(Q){this._renderTaskQueue.remove(Q)}_render(Q){const A=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(Q),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,x=a.h.now();this.style.zoomHistory.update(V,x);const s=new a.a8(V,{now:x,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=s.crossFadingFactor();i===1&&i===this._crossFadingFactor||(C=!0,this._crossFadingFactor=i),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bg.mark(a.bh.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const O=this._sourcesDirty||this._styleDirty||this._placementDirty;return O||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,a.bg.mark(a.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var Q;this._hash&&this._hash.remove();for(const C of this._controls)C.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ke.removeThrottleControl(this._imageQueueHandle),(Q=this._resizeObserver)===null||Q===void 0||Q.disconnect();const A=this.painter.context.gl.getExtension("WEBGL_lose_context");A&&A.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),$.remove(this._canvasContainer),$.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),a.bg.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.h.frame(Q=>{a.bg.frame(Q),this._frame=null,this._render(Q)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(Q){this._showTileBoundaries!==Q&&(this._showTileBoundaries=Q,this._update())}get showPadding(){return!!this._showPadding}set showPadding(Q){this._showPadding!==Q&&(this._showPadding=Q,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(Q){this._showCollisionBoxes!==Q&&(this._showCollisionBoxes=Q,Q?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(Q){this._showOverdrawInspector!==Q&&(this._showOverdrawInspector=Q,this._update())}get repaint(){return!!this._repaint}set repaint(Q){this._repaint!==Q&&(this._repaint=Q,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(Q){this._vertices=Q,this._update()}get version(){return Mi}getCameraTargetElevation(){return this.transform.elevation}},Qt.NavigationControl=class{constructor(Q){this._updateZoomButtons=()=>{const A=this._map.getZoom(),C=A===this._map.getMaxZoom(),O=A===this._map.getMinZoom();this._zoomInButton.disabled=C,this._zoomOutButton.disabled=O,this._zoomInButton.setAttribute("aria-disabled",C.toString()),this._zoomOutButton.setAttribute("aria-disabled",O.toString())},this._rotateCompassArrow=()=>{const A=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=A},this._setButtonTitle=(A,C)=>{const O=this._map._getUIString(`NavigationControl.${C}`);A.title=O,A.setAttribute("aria-label",O)},this.options=a.e({},wu,Q),this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",A=>A.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",A=>this._map.zoomIn({},{originalEvent:A})),$.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",A=>this._map.zoomOut({},{originalEvent:A})),$.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",A=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:A}):this._map.resetNorth({},{originalEvent:A})}),this._compassIcon=$.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(Q){return this._map=Q,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Uo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){$.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(Q,A){const C=$.create("button",Q,this._container);return C.type="button",C.addEventListener("click",A),C}},Qt.GeolocateControl=class extends a.E{constructor(Q){super(),this._onSuccess=A=>{if(this._map){if(this._isOutOfMapMaxBounds(A))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",A)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=A,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(A),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(A),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",A)),this._finish()}},this._updateCamera=A=>{const C=new a.L(A.coords.longitude,A.coords.latitude),O=A.coords.accuracy,V=this._map.getBearing(),x=a.e({bearing:V},this.options.fitBoundsOptions),s=Ni.fromLngLat(C,O);this._map.fitBounds(s,x,{geolocateSource:!0})},this._updateMarker=A=>{if(A){const C=new a.L(A.coords.longitude,A.coords.latitude);this._accuracyCircleMarker.setLngLat(C).addTo(this._map),this._userLocationDotMarker.setLngLat(C).addTo(this._map),this._accuracy=A.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=A=>{if(this._map){if(this.options.trackUserLocation)if(A.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const C=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(A.code===3&&te)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",A)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=A=>{if(this._map){if(this._container.addEventListener("contextmenu",C=>C.preventDefault()),this._geolocateButton=$.create("button","maplibregl-ctrl-geolocate",this._container),$.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",A===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const C=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C)}else{const C=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=$.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new L({element:this._dotElement}),this._circleElement=$.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new L({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",C=>{C.geolocateSource||this._watchState!=="ACTIVE_LOCK"||C.originalEvent&&C.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},R,Q)}onAdd(Q){return this._map=Q,this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(A,C=!1){ms===void 0||C?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(O=>{ms=O.state!=="denied",A(ms)}).catch(()=>{ms=!!window.navigator.geolocation,A(ms)}):(ms=!!window.navigator.geolocation,A(ms)):A(ms)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),$.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,F=0,te=!1}_isOutOfMapMaxBounds(Q){const A=this._map.getMaxBounds(),C=Q.coords;return A&&(C.longitude<A.getWest()||C.longitude>A.getEast()||C.latitude<A.getSouth()||C.latitude>A.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const Q=this._map.getBounds(),A=Q.getSouthEast(),C=Q.getNorthEast(),O=A.distanceTo(C),V=Math.ceil(this._accuracy/(O/this._map._container.clientHeight)*2);this._circleElement.style.width=`${V}px`,this._circleElement.style.height=`${V}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":F--,te=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let Q;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),F++,F>1?(Q={maximumAge:6e5,timeout:0},te=!0):(Q=this.options.positionOptions,te=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Q)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Qt.AttributionControl=vs,Qt.LogoControl=gn,Qt.ScaleControl=class{constructor(Q){this._onMove=()=>{le(this._map,this._container,this.options)},this.setUnit=A=>{this.options.unit=A,le(this._map,this._container,this.options)},this.options=a.e({},ue,Q)}getDefaultPosition(){return"bottom-left"}onAdd(Q){return this._map=Q,this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-scale",Q.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){$.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Qt.FullscreenControl=class extends a.E{constructor(Q={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,Q&&Q.container&&(Q.container instanceof HTMLElement?this._container=Q.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(Q){return this._map=Q,this._container||(this._container=this._map.getContainer()),this._controlContainer=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){$.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const Q=this._fullscreenButton=$.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);$.create("span","maplibregl-ctrl-icon",Q).setAttribute("aria-hidden","true"),Q.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const Q=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Q),this._fullscreenButton.title=Q}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Qt.TerrainControl=class{constructor(Q){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=Q}onAdd(Q){return this._map=Q,this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=$.create("button","maplibregl-ctrl-terrain",this._container),$.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){$.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Qt.Popup=class extends a.E{constructor(Q){super(),this.remove=()=>(this._content&&$.remove(this._content),this._container&&($.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=A=>{this._update(A.point)},this._onMouseMove=A=>{this._update(A.point)},this._onDrag=A=>{this._update(A.point)},this._update=A=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=$.create("div","maplibregl-popup",this._map.getContainer()),this._tip=$.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const s of this.options.className.split(" "))this._container.classList.add(s);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Al(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!A)return;const C=this._pos=this._trackPointer&&A?A:this._map.project(this._lngLat);let O=this.options.anchor;const V=kt(this.options.offset);if(!O){const s=this._container.offsetWidth,i=this._container.offsetHeight;let r;r=C.y+V.bottom.y<i?["top"]:C.y>this._map.transform.height-i?["bottom"]:[],C.x<s/2?r.push("left"):C.x>this._map.transform.width-s/2&&r.push("right"),O=r.length===0?"bottom":r.join("-")}const x=C.add(V[O]).round();$.setTransform(this._container,`${zs[O]} translate(${x.x}px,${x.y}px)`),T(this._container,O,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(Xe),Q)}addTo(Q){return this._map&&this.remove(),this._map=Q,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(Q){return this._lngLat=a.L.convert(Q),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(Q){return this.setDOMContent(document.createTextNode(Q))}setHTML(Q){const A=document.createDocumentFragment(),C=document.createElement("body");let O;for(C.innerHTML=Q;O=C.firstChild,O;)A.appendChild(O);return this.setDOMContent(A)}getMaxWidth(){var Q;return(Q=this._container)===null||Q===void 0?void 0:Q.style.maxWidth}setMaxWidth(Q){return this.options.maxWidth=Q,this._update(),this}setDOMContent(Q){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=$.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(Q),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(Q){this._container&&this._container.classList.add(Q)}removeClassName(Q){this._container&&this._container.classList.remove(Q)}setOffset(Q){return this.options.offset=Q,this._update(),this}toggleClassName(Q){if(this._container)return this._container.classList.toggle(Q)}_createCloseButton(){this.options.closeButton&&(this._closeButton=$.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const Q=this._container.querySelector(bt);Q&&Q.focus()}},Qt.Marker=L,Qt.Style=Ar,Qt.LngLat=a.L,Qt.LngLatBounds=Ni,Qt.Point=a.P,Qt.MercatorCoordinate=a.U,Qt.Evented=a.E,Qt.AJAXError=a.bi,Qt.config=a.c,Qt.CanvasSource=Vi,Qt.GeoJSONSource=xn,Qt.ImageSource=gi,Qt.RasterDEMTileSource=sn,Qt.RasterTileSource=Gi,Qt.VectorTileSource=Zi,Qt.VideoSource=Oi,Qt.setRTLTextPlugin=a.bj,Qt.getRTLTextPluginStatus=a.bk,Qt.prewarm=function(){U().acquire(Wn)},Qt.clearPrewarmedResources=function(){const Q=M;Q&&(Q.isPreloaded()&&Q.numActive()===1?(Q.release(Wn),M=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},ri.extend(Qt,{isSafari:a.ac,getPerformanceMetrics:a.bg.getPerformanceMetrics}),Qt});var S=g;return S})})(jO);var qg=Uint8Array,w5=Uint16Array,ZO=Int32Array,QO=new qg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),WO=new qg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),S5=function(t,e){for(var n=new w5(31),c=0;c<31;++c)n[c]=e+=1<<t[c-1];for(var g=new ZO(n[30]),c=1;c<30;++c)for(var v=n[c];v<n[c+1];++v)g[v]=v-n[c]<<5|c;return{b:n,r:g}},I5=S5(QO,2),$O=I5.b,XO=I5.r;$O[28]=258,XO[258]=28;S5(WO,0);var YO=new w5(32768);for(oo=0;oo<32768;++oo)t0=(oo&43690)>>1|(oo&21845)<<1,t0=(t0&52428)>>2|(t0&13107)<<2,t0=(t0&61680)>>4|(t0&3855)<<4,YO[oo]=((t0&65280)>>8|(t0&255)<<8)>>1;var t0,oo,m1=new qg(288);for(oo=0;oo<144;++oo)m1[oo]=8;var oo;for(oo=144;oo<256;++oo)m1[oo]=9;var oo;for(oo=256;oo<280;++oo)m1[oo]=7;var oo;for(oo=280;oo<288;++oo)m1[oo]=8;var oo,KO=new qg(32);for(oo=0;oo<32;++oo)KO[oo]=5;var oo,JO=new qg(0),eN=typeof TextDecoder<"u"&&new TextDecoder,tN=0;try{eN.decode(JO,{stream:!0}),tN=1}catch{}var k2={exports:{}},iN=rN,nN={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function rN(t){if(!t||!t.type)return null;var e=nN[t.type];if(!e)return null;if(e==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if(e==="feature")return{type:"FeatureCollection",features:[t]};if(e==="featurecollection")return t}function g_(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(e,n){return e.concat(g_(n))},[]),t;case"Feature":return t.geometry?g_(t.geometry).map(function(e){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:e};return t.id!==void 0&&(n.id=t.id),n}):[t];case"MultiPoint":return t.coordinates.map(function(e){return{type:"Point",coordinates:e}});case"MultiPolygon":return t.coordinates.map(function(e){return{type:"Polygon",coordinates:e}});case"MultiLineString":return t.coordinates.map(function(e){return{type:"LineString",coordinates:e}});case"GeometryCollection":return t.geometries.map(g_).reduce(function(e,n){return e.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[t]}}const sN=Object.freeze(Object.defineProperty({__proto__:null,default:g_},Symbol.toStringTag,{value:"Module"})),aN=Ov(sN);var oN=function(e){return n(e);function n(c){return Array.isArray(c)&&c.length&&typeof c[0]=="number"?[c]:c.reduce(function(g,v){return Array.isArray(v)&&Array.isArray(v[0])?g.concat(n(v)):(g.push(v),g)},[])}},lN=iN,__=aN,uN=oN;__ instanceof Function||(__=__.default);var cN=function(t){if(!t)return[];var e=__(lN(t)),n=[];return e.features.forEach(function(c){c.geometry&&(n=n.concat(uN(c.geometry.coordinates)))}),n};function Mm(t){return Object.prototype.toString.call(t)}function hN(t){return Mm(t)==="[object Date]"}function AN(t){return Mm(t)==="[object RegExp]"}function fN(t){return Mm(t)==="[object Error]"}function dN(t){return Mm(t)==="[object Boolean]"}function pN(t){return Mm(t)==="[object Number]"}function mN(t){return Mm(t)==="[object String]"}var E5=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function g1(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)}var gN=Object.keys||function(e){var n=[];for(var c in e)n.push(c);return n},_N=Object.prototype.propertyIsEnumerable,Bw=Object.getOwnPropertySymbols;function _1(t){var e=gN(t);if(Bw)for(var n=Bw(t),c=0;c<n.length;c++)_N.call(t,n[c])&&e.push(n[c]);return e}var y1=Object.prototype.hasOwnProperty||function(t,e){return e in t};function C5(t){if(typeof t=="object"&&t!==null){var e;if(E5(t))e=[];else if(hN(t))e=new Date(t.getTime?t.getTime():t);else if(AN(t))e=new RegExp(t);else if(fN(t))e={message:t.message};else if(dN(t)||pN(t)||mN(t))e=Object(t);else if(Object.create&&Object.getPrototypeOf)e=Object.create(Object.getPrototypeOf(t));else if(t.constructor===Object)e={};else{var n=t.constructor&&t.constructor.prototype||t.__proto__||{},c=function(){};c.prototype=n,e=new c}return g1(_1(t),function(g){e[g]=t[g]}),e}return t}function T5(t,e,n){var c=[],g=[],v=!0;return function S(a){var N=n?C5(a):a,$={},he=!0,oe={node:N,node_:a,path:[].concat(c),parent:g[g.length-1],parents:g,key:c[c.length-1],isRoot:c.length===0,level:c.length,circular:null,update:function(Ze,nt){oe.isRoot||(oe.parent.node[oe.key]=Ze),oe.node=Ze,nt&&(he=!1)},delete:function(Ze){delete oe.parent.node[oe.key],Ze&&(he=!1)},remove:function(Ze){E5(oe.parent.node)?oe.parent.node.splice(oe.key,1):delete oe.parent.node[oe.key],Ze&&(he=!1)},keys:null,before:function(Ze){$.before=Ze},after:function(Ze){$.after=Ze},pre:function(Ze){$.pre=Ze},post:function(Ze){$.post=Ze},stop:function(){v=!1},block:function(){he=!1}};if(!v)return oe;function ce(){if(typeof oe.node=="object"&&oe.node!==null){(!oe.keys||oe.node_!==oe.node)&&(oe.keys=_1(oe.node)),oe.isLeaf=oe.keys.length===0;for(var Ze=0;Ze<g.length;Ze++)if(g[Ze].node_===a){oe.circular=g[Ze];break}}else oe.isLeaf=!0,oe.keys=null;oe.notLeaf=!oe.isLeaf,oe.notRoot=!oe.isRoot}ce();var _e=e.call(oe,oe.node);return _e!==void 0&&oe.update&&oe.update(_e),$.before&&$.before.call(oe,oe.node),he&&(typeof oe.node=="object"&&oe.node!==null&&!oe.circular&&(g.push(oe),ce(),g1(oe.keys,function(Ze,nt){c.push(Ze),$.pre&&$.pre.call(oe,oe.node[Ze],Ze);var Ke=S(oe.node[Ze]);n&&y1.call(oe.node,Ze)&&(oe.node[Ze]=Ke.node),Ke.isLast=nt===oe.keys.length-1,Ke.isFirst=nt===0,$.post&&$.post.call(oe,Ke),c.pop()}),g.pop()),$.after&&$.after.call(oe,oe.node)),oe}(t).node}function Uh(t){this.value=t}Uh.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var c=t[n];if(!e||!y1.call(e,c))return;e=e[c]}return e};Uh.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var c=t[n];if(!e||!y1.call(e,c))return!1;e=e[c]}return!0};Uh.prototype.set=function(t,e){for(var n=this.value,c=0;c<t.length-1;c++){var g=t[c];y1.call(n,g)||(n[g]={}),n=n[g]}return n[t[c]]=e,e};Uh.prototype.map=function(t){return T5(this.value,t,!0)};Uh.prototype.forEach=function(t){return this.value=T5(this.value,t,!1),this.value};Uh.prototype.reduce=function(t,e){var n=arguments.length===1,c=n?this.value:e;return this.forEach(function(g){(!this.isRoot||!n)&&(c=t.call(this,c,g))}),c};Uh.prototype.paths=function(){var t=[];return this.forEach(function(){t.push(this.path)}),t};Uh.prototype.nodes=function(){var t=[];return this.forEach(function(){t.push(this.node)}),t};Uh.prototype.clone=function(){var t=[],e=[];return function n(c){for(var g=0;g<t.length;g++)if(t[g]===c)return e[g];if(typeof c=="object"&&c!==null){var v=C5(c);return t.push(c),e.push(v),g1(_1(c),function(S){v[S]=n(c[S])}),t.pop(),e.pop(),v}return c}(this.value)};function k5(t){return new Uh(t)}g1(_1(Uh.prototype),function(t){k5[t]=function(e){var n=[].slice.call(arguments,1),c=new Uh(e);return c[t].apply(c,n)}});var yN=k5,vN=xc;function xc(t){if(!(this instanceof xc))return new xc(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}xc.prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this};xc.prototype.equals=function(t){var e;return t instanceof xc?e=t.bbox():e=t,this._bbox[0]==e[0]&&this._bbox[1]==e[1]&&this._bbox[2]==e[2]&&this._bbox[3]==e[3]};xc.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};xc.prototype.union=function(t){this._valid=!0;var e;return t instanceof xc?e=t.bbox():e=t,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this};xc.prototype.bbox=function(){return this._valid?this._bbox:null};xc.prototype.contains=function(t){if(!t)return this._fastContains();if(!this._valid)return null;var e=t[0],n=t[1];return this._bbox[0]<=e&&this._bbox[1]<=n&&this._bbox[2]>=e&&this._bbox[3]>=n};xc.prototype.intersect=function(t){if(!this._valid)return null;var e;return t instanceof xc?e=t.bbox():e=t,!(this._bbox[0]>e[2]||this._bbox[2]<e[0]||this._bbox[3]<e[1]||this._bbox[1]>e[3])};xc.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",t)};xc.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var xN=cN,bN=yN,wN=vN,M5={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},SN=Object.keys(M5);k2.exports=function(t){return M2(t).bbox()};k2.exports.polygon=function(t){return M2(t).polygon()};k2.exports.bboxify=function(t){return bN(t).map(function(e){if(e){var n=SN.some(function(c){return e[c]?M5[c].indexOf(e.type)!==-1:!1});n&&(e.bbox=M2(e).bbox(),this.update(e))}})};function M2(t){for(var e=wN(),n=xN(t),c=0;c<n.length;c++)e.include(n[c]);return e}var Ln=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},c;for(c in e)e.hasOwnProperty(c)&&(n[c]=e[c]);var g="";function v(Le){return e.locateFile?e.locateFile(Le,g):g+Le}var S;document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",S=function(qe,dt,Pt){var o=new XMLHttpRequest;o.open("GET",qe,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){dt(o.response);return}var li=mt(qe);if(li){dt(li.buffer);return}Pt()},o.onerror=Pt,o.send(null)};var a=e.print||console.log.bind(console),N=e.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(e[c]=n[c]);n=null,e.arguments&&e.arguments;var $=0,he=function(Le){$=Le},oe=function(){return $},ce=8;function _e(Le,qe,dt,Pt){switch(dt=dt||"i8",dt.charAt(dt.length-1)==="*"&&(dt="i32"),dt){case"i1":St[Le>>0]=qe;break;case"i8":St[Le>>0]=qe;break;case"i16":Ye[Le>>1]=qe;break;case"i32":_t[Le>>2]=qe;break;case"i64":_n=[qe>>>0,(Wn=qe,+bn(Wn)>=1?Wn>0?(Bn(+xi(Wn/4294967296),4294967295)|0)>>>0:~~+wn((Wn-+(~~Wn>>>0))/4294967296)>>>0:0)],_t[Le>>2]=_n[0],_t[Le+4>>2]=_n[1];break;case"float":ct[Le>>2]=qe;break;case"double":Ut[Le>>3]=qe;break;default:et("invalid type for setValue: "+dt)}}function Ze(Le,qe,dt){switch(qe=qe||"i8",qe.charAt(qe.length-1)==="*"&&(qe="i32"),qe){case"i1":return St[Le>>0];case"i8":return St[Le>>0];case"i16":return Ye[Le>>1];case"i32":return _t[Le>>2];case"i64":return _t[Le>>2];case"float":return ct[Le>>2];case"double":return Ut[Le>>3];default:et("invalid type for getValue: "+qe)}return null}var nt=!1;function Ke(Le,qe){Le||et("Assertion failed: "+qe)}function st(Le){var qe=e["_"+Le];return Ke(qe,"Cannot call unknown function "+Le+", make sure it is exported"),qe}function ht(Le,qe,dt,Pt,o){var Me={string:function(Si){var Jt=0;if(Si!=null&&Si!==0){var Sn=(Si.length<<2)+1;Jt=X(Sn),rt(Si,Jt,Sn)}return Jt},array:function(Si){var Jt=X(Si.length);return gt(Si,Jt),Jt}};function li(Si){return qe==="string"?Ue(Si):qe==="boolean"?!!Si:Si}var di=st(Le),fi=[],ti=0;if(Pt)for(var ui=0;ui<Pt.length;ui++){var Ri=Me[dt[ui]];Ri?(ti===0&&(ti=pe()),fi[ui]=Ri(Pt[ui])):fi[ui]=Pt[ui]}var bi=di.apply(null,fi);return bi=li(bi),ti!==0&&ne(ti),bi}function xt(Le,qe,dt,Pt){dt=dt||[];var o=dt.every(function(li){return li==="number"}),Me=qe!=="string";return Me&&o&&!Pt?st(Le):function(){return ht(Le,qe,dt,arguments)}}var zt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Mt(Le,qe,dt){for(var Pt=qe+dt,o=qe;Le[o]&&!(o>=Pt);)++o;if(o-qe>16&&Le.subarray&&zt)return zt.decode(Le.subarray(qe,o));for(var Me="";qe<o;){var li=Le[qe++];if(!(li&128)){Me+=String.fromCharCode(li);continue}var di=Le[qe++]&63;if((li&224)==192){Me+=String.fromCharCode((li&31)<<6|di);continue}var fi=Le[qe++]&63;if((li&240)==224?li=(li&15)<<12|di<<6|fi:li=(li&7)<<18|di<<12|fi<<6|Le[qe++]&63,li<65536)Me+=String.fromCharCode(li);else{var ti=li-65536;Me+=String.fromCharCode(55296|ti>>10,56320|ti&1023)}}return Me}function Ue(Le,qe){return Le?Mt(ut,Le,qe):""}function $t(Le,qe,dt,Pt){if(!(Pt>0))return 0;for(var o=dt,Me=dt+Pt-1,li=0;li<Le.length;++li){var di=Le.charCodeAt(li);if(di>=55296&&di<=57343){var fi=Le.charCodeAt(++li);di=65536+((di&1023)<<10)|fi&1023}if(di<=127){if(dt>=Me)break;qe[dt++]=di}else if(di<=2047){if(dt+1>=Me)break;qe[dt++]=192|di>>6,qe[dt++]=128|di&63}else if(di<=65535){if(dt+2>=Me)break;qe[dt++]=224|di>>12,qe[dt++]=128|di>>6&63,qe[dt++]=128|di&63}else{if(dt+3>=Me)break;qe[dt++]=240|di>>18,qe[dt++]=128|di>>12&63,qe[dt++]=128|di>>6&63,qe[dt++]=128|di&63}}return qe[dt]=0,dt-o}function rt(Le,qe,dt){return $t(Le,ut,qe,dt)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function gt(Le,qe){St.set(Le,qe)}function At(Le,qe){return Le%qe>0&&(Le+=qe-Le%qe),Le}var yt,St,ut,Ye,_t,ct,Ut;function Ft(Le){yt=Le,e.HEAP8=St=new Int8Array(Le),e.HEAP16=Ye=new Int16Array(Le),e.HEAP32=_t=new Int32Array(Le),e.HEAPU8=ut=new Uint8Array(Le),e.HEAPU16=new Uint16Array(Le),e.HEAPU32=new Uint32Array(Le),e.HEAPF32=ct=new Float32Array(Le),e.HEAPF64=Ut=new Float64Array(Le)}var Vt=5266928,yi=24016,Ci=e.TOTAL_MEMORY||33554432;e.buffer?yt=e.buffer:yt=new ArrayBuffer(Ci),Ci=yt.byteLength,Ft(yt),_t[yi>>2]=Vt;function ki(Le){for(;Le.length>0;){var qe=Le.shift();if(typeof qe=="function"){qe();continue}var dt=qe.func;typeof dt=="number"?qe.arg===void 0?e.dynCall_v(dt):e.dynCall_vi(dt,qe.arg):dt(qe.arg===void 0?null:qe.arg)}}var Ni=[],tn=[],Zi=[],Gi=[];function sn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Oi(e.preRun.shift());ki(Ni)}function xn(){ki(tn)}function Ti(){ki(Zi)}function gi(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Vi(e.postRun.shift());ki(Gi)}function Oi(Le){Ni.unshift(Le)}function Vi(Le){Gi.unshift(Le)}var bn=Math.abs,wn=Math.ceil,xi=Math.floor,Bn=Math.min,Ot=0,an=null;function $n(Le){Ot++,e.monitorRunDependencies&&e.monitorRunDependencies(Ot)}function oi(Le){if(Ot--,e.monitorRunDependencies&&e.monitorRunDependencies(Ot),Ot==0&&an){var qe=an;an=null,qe()}}e.preloadedImages={},e.preloadedAudios={};var Yi=null,Xn="data:application/octet-stream;base64,";function zn(Le){return String.prototype.startsWith?Le.startsWith(Xn):Le.indexOf(Xn)===0}var Wn,_n;Yi="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var b=24032;function M(Le){return Le}function U(Le){var qe=/\b__Z[\w\d_]+/g;return Le.replace(qe,function(dt){var Pt=dt;return dt===Pt?dt:Pt+" ["+dt+"]"})}function K(){var Le=new Error;if(!Le.stack){try{throw new Error(0)}catch(qe){Le=qe}if(!Le.stack)return"(no stack trace available)"}return Le.stack.toString()}function ie(){var Le=K();return e.extraStackTrace&&(Le+=`
`+e.extraStackTrace()),U(Le)}function de(Le,qe,dt,Pt){et("Assertion failed: "+Ue(Le)+", at: "+[qe?Ue(qe):"unknown filename",dt,Pt?Ue(Pt):"unknown function"])}function be(){return St.length}function Ee(Le,qe,dt){ut.set(ut.subarray(qe,qe+dt),Le)}function Ce(Le){return e.___errno_location&&(_t[e.___errno_location()>>2]=Le),Le}function Re(Le){et("OOM")}function $e(Le){try{var qe=new ArrayBuffer(Le);return qe.byteLength!=Le?void 0:(new Int8Array(qe).set(St),re(qe),Ft(qe),1)}catch{}}function je(Le){var qe=be(),dt=16777216,Pt=2147483648-dt;if(Le>Pt)return!1;for(var o=16777216,Me=Math.max(qe,o);Me<Le;)Me<=536870912?Me=At(2*Me,dt):Me=Math.min(At((3*Me+2147483648)/4,dt),Pt);var li=$e(Me);return!!li}var We=typeof atob=="function"?atob:function(Le){var qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",dt="",Pt,o,Me,li,di,fi,ti,ui=0;Le=Le.replace(/[^A-Za-z0-9\+\/\=]/g,"");do li=qe.indexOf(Le.charAt(ui++)),di=qe.indexOf(Le.charAt(ui++)),fi=qe.indexOf(Le.charAt(ui++)),ti=qe.indexOf(Le.charAt(ui++)),Pt=li<<2|di>>4,o=(di&15)<<4|fi>>2,Me=(fi&3)<<6|ti,dt=dt+String.fromCharCode(Pt),fi!==64&&(dt=dt+String.fromCharCode(o)),ti!==64&&(dt=dt+String.fromCharCode(Me));while(ui<Le.length);return dt};function Ge(Le){try{for(var qe=We(Le),dt=new Uint8Array(qe.length),Pt=0;Pt<qe.length;++Pt)dt[Pt]=qe.charCodeAt(Pt);return dt}catch{throw new Error("Converting base64 string to bytes failed.")}}function mt(Le){if(zn(Le))return Ge(Le.slice(Xn.length))}var ot={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Pe={a:et,b:he,c:oe,d:de,e:Ce,f:be,g:Ee,h:je,i:Re,j:M,k:U,l:$e,m:K,n:ie,o:b,p:yi},ae=function(Le,qe,dt){"almost asm";var Pt=new Le.Int8Array(dt),o=new Le.Int32Array(dt);new Le.Uint8Array(dt),new Le.Float32Array(dt);var Me=new Le.Float64Array(dt),li=qe.p|0,di=Le.Math.floor,fi=Le.Math.abs,ti=Le.Math.sqrt,ui=Le.Math.pow,Ri=Le.Math.cos,bi=Le.Math.sin,Si=Le.Math.tan,Jt=Le.Math.acos,Sn=Le.Math.asin,ur=Le.Math.atan,mn=Le.Math.atan2,Hn=Le.Math.ceil,Yr=Le.Math.imul,Qi=Le.Math.min,hr=Le.Math.clz32,Gn=qe.b,Xt=qe.c,en=qe.d,qt=qe.e,kn=qe.f,Ar=qe.g,js=qe.h,Qr=qe.i,Gt=24048;function fr(T){return Pt=new Int8Array(T),o=new Int32Array(T),Me=new Float64Array(T),dt=T,!0}function Bt(T){T=T|0;var L=0;return L=Gt,Gt=Gt+T|0,Gt=Gt+15&-16,L|0}function Gr(){return Gt|0}function Zs(T){T=T|0,Gt=T}function pa(T,L){T=T|0,Gt=T}function Fr(T){return T=T|0,(Yr(T*3|0,T+1|0)|0)+1|0}function Za(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0;Qa(T,L,R,F,0)|0&&(ue=(Yr(R*3|0,R+1|0)|0)+1|0,ms(F|0,0,ue<<3|0)|0,te=il(ue,4)|0,te&&(ia(T,L,R,F,te,ue,0),ir(te)))}function Oo(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0;if(Qa(T,L,R,F,te)|0){if(ue=(Yr(R*3|0,R+1|0)|0)+1|0,ms(F|0,0,ue<<3|0)|0,te|0){ms(te|0,0,ue<<2|0)|0,ia(T,L,R,F,te,ue,0);return}te=il(ue,4)|0,te&&(ia(T,L,R,F,te,ue,0),ir(te))}}function Qa(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0;if(Qt=Gt,Gt=Gt+16|0,Ht=Qt,ue=F,o[ue>>2]=T,o[ue+4>>2]=L,ue=(te|0)!=0,ue&&(o[te>>2]=0),gs(T,L)|0)return Ht=1,Gt=Qt,Ht|0;o[Ht>>2]=0;e:do if((R|0)>=1)if(ue)for(bt=0,kt=1,ri=1,le=0,ue=T;;){if(!(le|bt)){if(ue=Qn(ue,L,4,Ht)|0,L=Xt()|0,(ue|0)==0&(L|0)==0){ue=2;break e}if(gs(ue,L)|0){ue=1;break e}}if(ue=Qn(ue,L,o[16+(bt<<2)>>2]|0,Ht)|0,L=Xt()|0,(ue|0)==0&(L|0)==0){ue=2;break e}if(T=F+(ri<<3)|0,o[T>>2]=ue,o[T+4>>2]=L,o[te+(ri<<2)>>2]=kt,le=le+1|0,T=(le|0)==(kt|0),Se=bt+1|0,Xe=(Se|0)==6,gs(ue,L)|0){ue=1;break e}if(kt=kt+(Xe&T&1)|0,(kt|0)>(R|0)){ue=0;break}else bt=T?Xe?0:Se:bt,ri=ri+1|0,le=T?0:le}else for(bt=0,kt=1,ri=1,le=0,ue=T;;){if(!(le|bt)){if(ue=Qn(ue,L,4,Ht)|0,L=Xt()|0,(ue|0)==0&(L|0)==0){ue=2;break e}if(gs(ue,L)|0){ue=1;break e}}if(ue=Qn(ue,L,o[16+(bt<<2)>>2]|0,Ht)|0,L=Xt()|0,(ue|0)==0&(L|0)==0){ue=2;break e}if(T=F+(ri<<3)|0,o[T>>2]=ue,o[T+4>>2]=L,le=le+1|0,T=(le|0)==(kt|0),Se=bt+1|0,Xe=(Se|0)==6,gs(ue,L)|0){ue=1;break e}if(kt=kt+(Xe&T&1)|0,(kt|0)>(R|0)){ue=0;break}else bt=T?Xe?0:Se:bt,ri=ri+1|0,le=T?0:le}else ue=0;while(!1);return Ht=ue,Gt=Qt,Ht|0}function ia(T,L,R,F,te,ue,le){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0,ue=ue|0,le=le|0;var Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0;if(ri=Gt,Gt=Gt+16|0,kt=ri,(T|0)==0&(L|0)==0){Gt=ri;return}if(Se=Bo(T|0,L|0,ue|0,((ue|0)<0)<<31>>31|0)|0,Xt()|0,Xe=F+(Se<<3)|0,Ht=Xe,Qt=o[Ht>>2]|0,Ht=o[Ht+4>>2]|0,bt=(Qt|0)==(T|0)&(Ht|0)==(L|0),!((Qt|0)==0&(Ht|0)==0|bt))do Se=(Se+1|0)%(ue|0)|0,Xe=F+(Se<<3)|0,Qt=Xe,Ht=o[Qt>>2]|0,Qt=o[Qt+4>>2]|0,bt=(Ht|0)==(T|0)&(Qt|0)==(L|0);while(!((Ht|0)==0&(Qt|0)==0|bt));if(Se=te+(Se<<2)|0,bt&&(o[Se>>2]|0)<=(le|0)){Gt=ri;return}if(Qt=Xe,o[Qt>>2]=T,o[Qt+4>>2]=L,o[Se>>2]=le,(le|0)>=(R|0)){Gt=ri;return}Qt=le+1|0,o[kt>>2]=0,Ht=Qn(T,L,2,kt)|0,ia(Ht,Xt()|0,R,F,te,ue,Qt),o[kt>>2]=0,Ht=Qn(T,L,3,kt)|0,ia(Ht,Xt()|0,R,F,te,ue,Qt),o[kt>>2]=0,Ht=Qn(T,L,1,kt)|0,ia(Ht,Xt()|0,R,F,te,ue,Qt),o[kt>>2]=0,Ht=Qn(T,L,5,kt)|0,ia(Ht,Xt()|0,R,F,te,ue,Qt),o[kt>>2]=0,Ht=Qn(T,L,4,kt)|0,ia(Ht,Xt()|0,R,F,te,ue,Qt),o[kt>>2]=0,Ht=Qn(T,L,6,kt)|0,ia(Ht,Xt()|0,R,F,te,ue,Qt),Gt=ri}function Qn(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0;if((o[F>>2]|0)>0){te=0;do R=ma(R)|0,te=te+1|0;while((te|0)<(o[F>>2]|0))}Se=Mi(T|0,L|0,45)|0,Xt()|0,Xe=Se&127,ue=sa(T,L)|0,te=Mi(T|0,L|0,52)|0,Xt()|0,te=te&15;e:do if(!te)le=6;else for(;;){if(ri=(15-te|0)*3|0,Ht=Mi(T|0,L|0,ri|0)|0,Xt()|0,Ht=Ht&7,Qt=(Hr(te)|0)==0,te=te+-1|0,kt=zi(7,0,ri|0)|0,L=L&~(Xt()|0),ri=zi(o[(Qt?464:48)+(Ht*28|0)+(R<<2)>>2]|0,0,ri|0)|0,bt=Xt()|0,R=o[(Qt?672:256)+(Ht*28|0)+(R<<2)>>2]|0,T=ri|T&~kt,L=bt|L,!R){R=0;break e}if(!te){le=6;break}}while(!1);(le|0)==6&&(Qt=o[880+(Xe*28|0)+(R<<2)>>2]|0,Ht=zi(Qt|0,0,45)|0,T=Ht|T,L=Xt()|0|L&-1040385,R=o[4304+(Xe*28|0)+(R<<2)>>2]|0,(Qt&127|0)==127&&(Qt=zi(o[880+(Xe*28|0)+20>>2]|0,0,45)|0,L=Xt()|0|L&-1040385,R=o[4304+(Xe*28|0)+20>>2]|0,T=io(Qt|T,L)|0,L=Xt()|0,o[F>>2]=(o[F>>2]|0)+1)),le=Mi(T|0,L|0,45)|0,Xt()|0,le=le&127;e:do if(G(le)|0){t:do if((sa(T,L)|0)==1){if((Xe|0)!=(le|0))if(Li(le,o[7728+(Xe*28|0)>>2]|0)|0){T=ns(T,L)|0,ue=1,L=Xt()|0;break}else{T=io(T,L)|0,ue=1,L=Xt()|0;break}switch(ue|0){case 5:{T=ns(T,L)|0,L=Xt()|0,o[F>>2]=(o[F>>2]|0)+5,ue=0;break t}case 3:{T=io(T,L)|0,L=Xt()|0,o[F>>2]=(o[F>>2]|0)+1,ue=0;break t}default:return Ht=0,Qt=0,Gn(Ht|0),Qt|0}}else ue=0;while(!1);if((R|0)>0){te=0;do T=Ws(T,L)|0,L=Xt()|0,te=te+1|0;while((te|0)!=(R|0))}if((Xe|0)!=(le|0)){if(!(we(le)|0)){if((ue|0)!=0|(sa(T,L)|0)!=5)break;o[F>>2]=(o[F>>2]|0)+1;break}switch(Se&127){case 8:case 118:break e}(sa(T,L)|0)!=3&&(o[F>>2]=(o[F>>2]|0)+1)}}else if((R|0)>0){te=0;do T=io(T,L)|0,L=Xt()|0,te=te+1|0;while((te|0)!=(R|0))}while(!1);return o[F>>2]=((o[F>>2]|0)+R|0)%6|0,Ht=L,Qt=T,Gn(Ht|0),Qt|0}function Aa(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0;if(ri=Gt,Gt=Gt+16|0,kt=ri,!R)return kt=F,o[kt>>2]=T,o[kt+4>>2]=L,kt=0,Gt=ri,kt|0;o[kt>>2]=0;e:do if(gs(T,L)|0)T=1;else{if(ue=(R|0)>0,ue){te=0,bt=T;do{if(bt=Qn(bt,L,4,kt)|0,L=Xt()|0,(bt|0)==0&(L|0)==0){T=2;break e}if(te=te+1|0,gs(bt,L)|0){T=1;break e}}while((te|0)<(R|0));if(Xe=F,o[Xe>>2]=bt,o[Xe+4>>2]=L,Xe=R+-1|0,ue){ue=0,le=1,te=bt,T=L;do{if(te=Qn(te,T,2,kt)|0,T=Xt()|0,(te|0)==0&(T|0)==0){T=2;break e}if(Se=F+(le<<3)|0,o[Se>>2]=te,o[Se+4>>2]=T,le=le+1|0,gs(te,T)|0){T=1;break e}ue=ue+1|0}while((ue|0)<(R|0));Se=0,ue=le;do{if(te=Qn(te,T,3,kt)|0,T=Xt()|0,(te|0)==0&(T|0)==0){T=2;break e}if(le=F+(ue<<3)|0,o[le>>2]=te,o[le+4>>2]=T,ue=ue+1|0,gs(te,T)|0){T=1;break e}Se=Se+1|0}while((Se|0)<(R|0));le=0;do{if(te=Qn(te,T,1,kt)|0,T=Xt()|0,(te|0)==0&(T|0)==0){T=2;break e}if(Se=F+(ue<<3)|0,o[Se>>2]=te,o[Se+4>>2]=T,ue=ue+1|0,gs(te,T)|0){T=1;break e}le=le+1|0}while((le|0)<(R|0));le=0;do{if(te=Qn(te,T,5,kt)|0,T=Xt()|0,(te|0)==0&(T|0)==0){T=2;break e}if(Se=F+(ue<<3)|0,o[Se>>2]=te,o[Se+4>>2]=T,ue=ue+1|0,gs(te,T)|0){T=1;break e}le=le+1|0}while((le|0)<(R|0));le=0;do{if(te=Qn(te,T,4,kt)|0,T=Xt()|0,(te|0)==0&(T|0)==0){T=2;break e}if(Se=F+(ue<<3)|0,o[Se>>2]=te,o[Se+4>>2]=T,ue=ue+1|0,gs(te,T)|0){T=1;break e}le=le+1|0}while((le|0)<(R|0));for(le=0;;){if(te=Qn(te,T,6,kt)|0,T=Xt()|0,(te|0)==0&(T|0)==0){T=2;break e}if((le|0)!=(Xe|0))if(Se=F+(ue<<3)|0,o[Se>>2]=te,o[Se+4>>2]=T,!(gs(te,T)|0))ue=ue+1|0;else{T=1;break e}if(le=le+1|0,(le|0)>=(R|0)){le=bt,ue=L;break}}}else le=bt,te=bt,ue=L,T=L}else le=F,o[le>>2]=T,o[le+4>>2]=L,le=T,te=T,ue=L,T=L;T=((le|0)!=(te|0)|(ue|0)!=(T|0))&1}while(!1);return kt=T,Gt=ri,kt|0}function ds(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0;if(ue=Gt,Gt=Gt+48|0,te=ue+8|0,F=ue,Se=T,le=o[Se+4>>2]|0,R=F,o[R>>2]=o[Se>>2],o[R+4>>2]=le,Rn(F,te),te=Ya(te,L)|0,L=o[F>>2]|0,F=o[T+8>>2]|0,(F|0)<=0)return Se=L,le=(te|0)<(Se|0),Se=le?Se:te,Se=Se+12|0,Gt=ue,Se|0;R=o[T+12>>2]|0,T=0;do L=(o[R+(T<<3)>>2]|0)+L|0,T=T+1|0;while((T|0)<(F|0));return Se=(te|0)<(L|0),Se=Se?L:te,Se=Se+12|0,Gt=ue,Se|0}function Wa(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0;if(Se=Gt,Gt=Gt+48|0,F=Se+8|0,te=Se,!(ol(T,L,R)|0)){Gt=Se;return}if(Xe=T,ue=o[Xe+4>>2]|0,le=te,o[le>>2]=o[Xe>>2],o[le+4>>2]=ue,Rn(te,F),le=Ya(F,L)|0,L=o[te>>2]|0,ue=o[T+8>>2]|0,(ue|0)>0){te=o[T+12>>2]|0,F=0;do L=(o[te+(F<<3)>>2]|0)+L|0,F=F+1|0;while((F|0)!=(ue|0))}if(L=(le|0)<(L|0)?L:le,(L|0)<=-12){Gt=Se;return}Xe=L+11|0,ms(R|0,0,(((Xe|0)>0?Xe:0)<<3)+8|0)|0,Gt=Se}function ol(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0,l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0;if(Ie=Gt,Gt=Gt+112|0,z=Ie+80|0,Xe=Ie+72|0,Z=Ie,Y=Ie+56|0,bt=T+8|0,Ae=Zn((o[bt>>2]<<5)+32|0)|0,Ae||en(22848,22448,800,22456),Na(T,Ae),ue=T,F=o[ue+4>>2]|0,Se=Xe,o[Se>>2]=o[ue>>2],o[Se+4>>2]=F,Rn(Xe,z),Se=Ya(z,L)|0,F=o[Xe>>2]|0,ue=o[bt>>2]|0,(ue|0)>0){le=o[T+12>>2]|0,te=0;do F=(o[le+(te<<3)>>2]|0)+F|0,te=te+1|0;while((te|0)!=(ue|0))}if(Se=(Se|0)<(F|0)?F:Se,k=Se+12|0,te=il(k,8)|0,kt=il(k,8)|0,o[z>>2]=0,y=T,I=o[y+4>>2]|0,F=Xe,o[F>>2]=o[y>>2],o[F+4>>2]=I,F=ll(Xe,k,L,z,te,kt)|0,F|0)return ir(te),ir(kt),ir(Ae),Ae=F,Gt=Ie,Ae|0;e:do if((o[bt>>2]|0)>0){for(ue=T+12|0,F=0;le=ll((o[ue>>2]|0)+(F<<3)|0,k,L,z,te,kt)|0,F=F+1|0,!(le|0);)if((F|0)>=(o[bt>>2]|0))break e;return ir(te),ir(kt),ir(Ae),Ae=le,Gt=Ie,Ae|0}while(!1);(Se|0)>-12&&ms(kt|0,0,((k|0)>1?k:1)<<3|0)|0;e:do if((o[z>>2]|0)>0){I=((k|0)<0)<<31>>31,s=te,i=kt,r=te,l=te,d=kt,y=te,F=te,C=te,O=kt,V=kt,x=kt,te=kt;t:for(;;){for(A=o[z>>2]|0,Qt=0,Q=0,ue=0;;){le=Z,Se=le+56|0;do o[le>>2]=0,le=le+4|0;while((le|0)<(Se|0));if(L=s+(Qt<<3)|0,Xe=o[L>>2]|0,L=o[L+4>>2]|0,Qa(Xe,L,1,Z,0)|0){le=Z,Se=le+56|0;do o[le>>2]=0,le=le+4|0;while((le|0)<(Se|0));le=il(7,4)|0,le|0&&(ia(Xe,L,1,Z,le,7,0),ir(le))}Ht=0;do{ri=Z+(Ht<<3)|0,kt=o[ri>>2]|0,ri=o[ri+4>>2]|0;i:do if(!((kt|0)==0&(ri|0)==0)){if(Xe=Bo(kt|0,ri|0,k|0,I|0)|0,Xt()|0,le=R+(Xe<<3)|0,Se=le,L=o[Se>>2]|0,Se=o[Se+4>>2]|0,!((L|0)==0&(Se|0)==0))for(bt=0;;){if((bt|0)>(k|0))break t;if((L|0)==(kt|0)&(Se|0)==(ri|0))break i;if(Xe=(Xe+1|0)%(k|0)|0,le=R+(Xe<<3)|0,Se=le,L=o[Se>>2]|0,Se=o[Se+4>>2]|0,(L|0)==0&(Se|0)==0)break;bt=bt+1|0}(kt|0)==0&(ri|0)==0||(Ma(kt,ri,Y),En(T,Ae,Y)|0&&(bt=le,o[bt>>2]=kt,o[bt+4>>2]=ri,bt=i+(ue<<3)|0,o[bt>>2]=kt,o[bt+4>>2]=ri,ue=ue+1|0))}while(!1);Ht=Ht+1|0}while(Ht>>>0<7);if(Q=Q+1|0,(Q|0)>=(A|0))break;Qt=Qt+1|0}if((A|0)>0&&ms(r|0,0,A<<3|0)|0,o[z>>2]=ue,(ue|0)>0)kt=te,ri=x,Ht=y,Qt=V,Q=O,A=i,te=C,x=F,V=l,O=r,C=kt,F=ri,y=d,d=Ht,l=Qt,r=Q,i=s,s=A;else break e}return ir(l),ir(d),ir(Ae),Ae=-1,Gt=Ie,Ae|0}else F=kt;while(!1);return ir(Ae),ir(te),ir(F),Ae=0,Gt=Ie,Ae|0}function ll(T,L,R,F,te,ue){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0,ue=ue|0;var le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0,l=0,d=0,y=0,I=0,k=0,z=0;if(I=Gt,Gt=Gt+48|0,r=I+32|0,l=I+16|0,d=I,le=o[T>>2]|0,(le|0)<=0)return y=0,Gt=I,y|0;O=T+4|0,V=r+8|0,x=l+8|0,s=d+8|0,i=((L|0)<0)<<31>>31,C=0;e:for(;;){Se=o[O>>2]|0,Q=Se+(C<<4)|0,o[r>>2]=o[Q>>2],o[r+4>>2]=o[Q+4>>2],o[r+8>>2]=o[Q+8>>2],o[r+12>>2]=o[Q+12>>2],(C|0)==(le+-1|0)?(o[l>>2]=o[Se>>2],o[l+4>>2]=o[Se+4>>2],o[l+8>>2]=o[Se+8>>2],o[l+12>>2]=o[Se+12>>2]):(Q=Se+(C+1<<4)|0,o[l>>2]=o[Q>>2],o[l+4>>2]=o[Q+4>>2],o[l+8>>2]=o[Q+8>>2],o[l+12>>2]=o[Q+12>>2]),Q=Ka(r,l,R)|0;t:do if((Q|0)>0){A=+(Q|0),Qt=0;i:for(;;){z=+(Q-Qt|0),k=+(Qt|0),Me[d>>3]=+Me[r>>3]*z/A+ +Me[l>>3]*k/A,Me[s>>3]=+Me[V>>3]*z/A+ +Me[x>>3]*k/A,ri=ga(d,R)|0,Ht=Xt()|0,Se=Bo(ri|0,Ht|0,L|0,i|0)|0,Xt()|0,le=ue+(Se<<3)|0,Xe=le,bt=o[Xe>>2]|0,Xe=o[Xe+4>>2]|0;n:do if((bt|0)==0&(Xe|0)==0)y=14;else for(kt=0;;){if((kt|0)>(L|0)){le=1;break n}if((bt|0)==(ri|0)&(Xe|0)==(Ht|0)){le=7;break n}if(Se=(Se+1|0)%(L|0)|0,le=ue+(Se<<3)|0,Xe=le,bt=o[Xe>>2]|0,Xe=o[Xe+4>>2]|0,(bt|0)==0&(Xe|0)==0){y=14;break}else kt=kt+1|0}while(!1);switch((y|0)==14&&(y=0,(ri|0)==0&(Ht|0)==0?le=7:(o[le>>2]=ri,o[le+4>>2]=Ht,le=o[F>>2]|0,kt=te+(le<<3)|0,o[kt>>2]=ri,o[kt+4>>2]=Ht,o[F>>2]=le+1,le=0)),le&7){case 7:case 0:break;default:break i}if(Qt=Qt+1|0,(Q|0)<=(Qt|0)){y=8;break t}}if(le|0){le=-1,y=20;break e}}else y=8;while(!1);if((y|0)==8&&(y=0),C=C+1|0,le=o[T>>2]|0,(C|0)>=(le|0)){le=0,y=20;break}}return(y|0)==20?(Gt=I,le|0):0}function lo(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0;if(bt=Gt,Gt=Gt+176|0,Xe=bt,(L|0)<1){ys(R,0,0),Gt=bt;return}le=T,le=Mi(o[le>>2]|0,o[le+4>>2]|0,52)|0,Xt()|0,ys(R,(L|0)>6?L:6,le&15),le=0;do{if(F=T+(le<<3)|0,Oa(o[F>>2]|0,o[F+4>>2]|0,Xe),F=o[Xe>>2]|0,(F|0)>0){Se=0;do ue=Xe+8+(Se<<4)|0,Se=Se+1|0,F=Xe+8+(((Se|0)%(F|0)|0)<<4)|0,te=Au(R,F,ue)|0,te?xu(R,te)|0:Uu(R,ue,F)|0,F=o[Xe>>2]|0;while((Se|0)<(F|0))}le=le+1|0}while((le|0)!=(L|0));Gt=bt}function $a(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0;if(ue=Gt,Gt=Gt+32|0,F=ue,te=ue+16|0,lo(T,L,te),o[R>>2]=0,o[R+4>>2]=0,o[R+8>>2]=0,T=tl(te)|0,!T){Jn(R)|0,wa(te),Gt=ue;return}do{L=On(R)|0;do jn(L,T)|0,le=T+16|0,o[F>>2]=o[le>>2],o[F+4>>2]=o[le+4>>2],o[F+8>>2]=o[le+8>>2],o[F+12>>2]=o[le+12>>2],xu(te,T)|0,T=Gu(te,F)|0;while(T|0);T=tl(te)|0}while(T|0);Jn(R)|0,wa(te),Gt=ue}function G(T){return T=T|0,o[7728+(T*28|0)+16>>2]|0}function we(T){return T=T|0,(T|0)==4|(T|0)==117|0}function at(T){return T=T|0,o[11152+((o[T>>2]|0)*216|0)+((o[T+4>>2]|0)*72|0)+((o[T+8>>2]|0)*24|0)+(o[T+12>>2]<<3)>>2]|0}function Ct(T){return T=T|0,o[11152+((o[T>>2]|0)*216|0)+((o[T+4>>2]|0)*72|0)+((o[T+8>>2]|0)*24|0)+(o[T+12>>2]<<3)+4>>2]|0}function Yt(T,L){T=T|0,L=L|0,T=7728+(T*28|0)|0,o[L>>2]=o[T>>2],o[L+4>>2]=o[T+4>>2],o[L+8>>2]=o[T+8>>2],o[L+12>>2]=o[T+12>>2]}function Ii(T,L){T=T|0,L=L|0;var R=0,F=0;if(L>>>0>20)return L=-1,L|0;do if((o[11152+(L*216|0)>>2]|0)!=(T|0))if((o[11152+(L*216|0)+8>>2]|0)!=(T|0))if((o[11152+(L*216|0)+16>>2]|0)!=(T|0))if((o[11152+(L*216|0)+24>>2]|0)!=(T|0))if((o[11152+(L*216|0)+32>>2]|0)!=(T|0))if((o[11152+(L*216|0)+40>>2]|0)!=(T|0))if((o[11152+(L*216|0)+48>>2]|0)!=(T|0))if((o[11152+(L*216|0)+56>>2]|0)!=(T|0))if((o[11152+(L*216|0)+64>>2]|0)!=(T|0))if((o[11152+(L*216|0)+72>>2]|0)!=(T|0))if((o[11152+(L*216|0)+80>>2]|0)!=(T|0))if((o[11152+(L*216|0)+88>>2]|0)!=(T|0))if((o[11152+(L*216|0)+96>>2]|0)!=(T|0))if((o[11152+(L*216|0)+104>>2]|0)!=(T|0))if((o[11152+(L*216|0)+112>>2]|0)!=(T|0))if((o[11152+(L*216|0)+120>>2]|0)!=(T|0))if((o[11152+(L*216|0)+128>>2]|0)!=(T|0))if((o[11152+(L*216|0)+136>>2]|0)==(T|0))T=2,R=1,F=2;else{if((o[11152+(L*216|0)+144>>2]|0)==(T|0)){T=0,R=2,F=0;break}if((o[11152+(L*216|0)+152>>2]|0)==(T|0)){T=0,R=2,F=1;break}if((o[11152+(L*216|0)+160>>2]|0)==(T|0)){T=0,R=2,F=2;break}if((o[11152+(L*216|0)+168>>2]|0)==(T|0)){T=1,R=2,F=0;break}if((o[11152+(L*216|0)+176>>2]|0)==(T|0)){T=1,R=2,F=1;break}if((o[11152+(L*216|0)+184>>2]|0)==(T|0)){T=1,R=2,F=2;break}if((o[11152+(L*216|0)+192>>2]|0)==(T|0)){T=2,R=2,F=0;break}if((o[11152+(L*216|0)+200>>2]|0)==(T|0)){T=2,R=2,F=1;break}if((o[11152+(L*216|0)+208>>2]|0)==(T|0)){T=2,R=2,F=2;break}else T=-1;return T|0}else T=2,R=1,F=1;else T=2,R=1,F=0;else T=1,R=1,F=2;else T=1,R=1,F=1;else T=1,R=1,F=0;else T=0,R=1,F=2;else T=0,R=1,F=1;else T=0,R=1,F=0;else T=2,R=0,F=2;else T=2,R=0,F=1;else T=2,R=0,F=0;else T=1,R=0,F=2;else T=1,R=0,F=1;else T=1,R=0,F=0;else T=0,R=0,F=2;else T=0,R=0,F=1;else T=0,R=0,F=0;while(!1);return L=o[11152+(L*216|0)+(R*72|0)+(T*24|0)+(F<<3)+4>>2]|0,L|0}function Li(T,L){return T=T|0,L=L|0,(o[7728+(T*28|0)+20>>2]|0)==(L|0)?(L=1,L|0):(L=(o[7728+(T*28|0)+24>>2]|0)==(L|0),L|0)}function An(T,L){return T=T|0,L=L|0,o[880+(T*28|0)+(L<<2)>>2]|0}function pn(T,L){return T=T|0,L=L|0,(o[880+(T*28|0)>>2]|0)==(L|0)?(L=0,L|0):(o[880+(T*28|0)+4>>2]|0)==(L|0)?(L=1,L|0):(o[880+(T*28|0)+8>>2]|0)==(L|0)?(L=2,L|0):(o[880+(T*28|0)+12>>2]|0)==(L|0)?(L=3,L|0):(o[880+(T*28|0)+16>>2]|0)==(L|0)?(L=4,L|0):(o[880+(T*28|0)+20>>2]|0)==(L|0)?(L=5,L|0):((o[880+(T*28|0)+24>>2]|0)==(L|0)?6:7)|0}function or(){return 122}function dr(T){T=T|0;var L=0,R=0,F=0;L=0;do zi(L|0,0,45)|0,F=Xt()|0|134225919,R=T+(L<<3)|0,o[R>>2]=-1,o[R+4>>2]=F,L=L+1|0;while((L|0)!=122)}function qr(T){return T=T|0,+Me[T+16>>3]<+Me[T+24>>3]|0}function Xa(T,L){T=T|0,L=L|0;var R=0,F=0,te=0;return R=+Me[L>>3],!(R>=+Me[T+8>>3])||!(R<=+Me[T>>3])?(L=0,L|0):(F=+Me[T+16>>3],R=+Me[T+24>>3],te=+Me[L+8>>3],L=te>=R,T=te<=F&1,F<R?L&&(T=1):L||(T=0),L=(T|0)!=0,L|0)}function Ya(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0;le=Gt,Gt=Gt+288|0,R=le+264|0,F=le+96|0,te=le,ue=te,Se=ue+96|0;do o[ue>>2]=0,ue=ue+4|0;while((ue|0)<(Se|0));return _l(L,te),ue=te,Se=o[ue>>2]|0,ue=o[ue+4>>2]|0,Ma(Se,ue,R),Oa(Se,ue,F),Xe=+Ds(R,F+8|0),Me[R>>3]=+Me[T>>3],ue=R+8|0,Me[ue>>3]=+Me[T+16>>3],Me[F>>3]=+Me[T+8>>3],Se=F+8|0,Me[Se>>3]=+Me[T+24>>3],bt=+Ds(R,F),Se=~~+Hn(+(bt*bt/+Es(+ +fi(+((+Me[ue>>3]-+Me[Se>>3])/(+Me[R>>3]-+Me[F>>3]))),3)/(Xe*(Xe*2.59807621135)*.8))),Gt=le,(Se|0?Se:1)|0}function Ka(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0;Se=Gt,Gt=Gt+288|0,F=Se+264|0,te=Se+96|0,ue=Se,le=ue,Xe=le+96|0;do o[le>>2]=0,le=le+4|0;while((le|0)<(Xe|0));return _l(R,ue),Xe=ue,le=o[Xe>>2]|0,Xe=o[Xe+4>>2]|0,Ma(le,Xe,F),Oa(le,Xe,te),bt=+Ds(F,te+8|0),Xe=~~+Hn(+(+Ds(T,L)/(bt*2))),Gt=Se,(Xe|0?Xe:1)|0}function ml(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0,o[T>>2]=L,o[T+4>>2]=R,o[T+8>>2]=F}function Wr(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0;ri=L+8|0,o[ri>>2]=0,Xe=+Me[T>>3],le=+fi(+Xe),bt=+Me[T+8>>3],Se=+fi(+bt)/.8660254037844386,le=le+Se*.5,R=~~le,T=~~Se,le=le-+(R|0),Se=Se-+(T|0);do if(le<.5)if(le<.3333333333333333)if(o[L>>2]=R,Se<(le+1)*.5){o[L+4>>2]=T;break}else{T=T+1|0,o[L+4>>2]=T;break}else if(Ht=1-le,T=(!(Se<Ht)&1)+T|0,o[L+4>>2]=T,Ht<=Se&Se<le*2){R=R+1|0,o[L>>2]=R;break}else{o[L>>2]=R;break}else{if(!(le<.6666666666666666))if(R=R+1|0,o[L>>2]=R,Se<le*.5){o[L+4>>2]=T;break}else{T=T+1|0,o[L+4>>2]=T;break}if(Se<1-le){if(o[L+4>>2]=T,le*2+-1<Se){o[L>>2]=R;break}}else T=T+1|0,o[L+4>>2]=T;R=R+1|0,o[L>>2]=R}while(!1);do if(Xe<0)if(T&1){kt=(T+1|0)/2|0,kt=fa(R|0,((R|0)<0)<<31>>31|0,kt|0,((kt|0)<0)<<31>>31|0)|0,R=~~(+(R|0)-((+(kt>>>0)+4294967296*+(Xt()|0))*2+1)),o[L>>2]=R;break}else{kt=(T|0)/2|0,kt=fa(R|0,((R|0)<0)<<31>>31|0,kt|0,((kt|0)<0)<<31>>31|0)|0,R=~~(+(R|0)-(+(kt>>>0)+4294967296*+(Xt()|0))*2),o[L>>2]=R;break}while(!1);kt=L+4|0,bt<0&&(R=R-((T<<1|1|0)/2|0)|0,o[L>>2]=R,T=0-T|0,o[kt>>2]=T),F=T-R|0,(R|0)<0?(te=0-R|0,o[kt>>2]=F,o[ri>>2]=te,o[L>>2]=0,T=F,R=0):te=0,(T|0)<0&&(R=R-T|0,o[L>>2]=R,te=te-T|0,o[ri>>2]=te,o[kt>>2]=0,T=0),ue=R-te|0,F=T-te|0,(te|0)<0&&(o[L>>2]=ue,o[kt>>2]=F,o[ri>>2]=0,T=F,R=ue,te=0),F=(T|0)<(R|0)?T:R,F=(te|0)<(F|0)?te:F,!((F|0)<=0)&&(o[L>>2]=R-F,o[kt>>2]=T-F,o[ri>>2]=te-F)}function sr(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0;L=o[T>>2]|0,le=T+4|0,R=o[le>>2]|0,(L|0)<0&&(R=R-L|0,o[le>>2]=R,ue=T+8|0,o[ue>>2]=(o[ue>>2]|0)-L,o[T>>2]=0,L=0),(R|0)<0?(L=L-R|0,o[T>>2]=L,ue=T+8|0,te=(o[ue>>2]|0)-R|0,o[ue>>2]=te,o[le>>2]=0,R=0):(te=T+8|0,ue=te,te=o[te>>2]|0),(te|0)<0&&(L=L-te|0,o[T>>2]=L,R=R-te|0,o[le>>2]=R,o[ue>>2]=0,te=0),F=(R|0)<(L|0)?R:L,F=(te|0)<(F|0)?te:F,!((F|0)<=0)&&(o[T>>2]=L-F,o[le>>2]=R-F,o[ue>>2]=te-F)}function Mr(T,L){T=T|0,L=L|0;var R=0,F=0;F=o[T+8>>2]|0,R=+((o[T+4>>2]|0)-F|0),Me[L>>3]=+((o[T>>2]|0)-F|0)-R*.5,Me[L+8>>3]=R*.8660254037844386}function Or(T,L,R){T=T|0,L=L|0,R=R|0,o[R>>2]=(o[L>>2]|0)+(o[T>>2]|0),o[R+4>>2]=(o[L+4>>2]|0)+(o[T+4>>2]|0),o[R+8>>2]=(o[L+8>>2]|0)+(o[T+8>>2]|0)}function Ys(T,L,R){T=T|0,L=L|0,R=R|0,o[R>>2]=(o[T>>2]|0)-(o[L>>2]|0),o[R+4>>2]=(o[T+4>>2]|0)-(o[L+4>>2]|0),o[R+8>>2]=(o[T+8>>2]|0)-(o[L+8>>2]|0)}function Sr(T,L){T=T|0,L=L|0;var R=0,F=0;R=Yr(o[T>>2]|0,L)|0,o[T>>2]=R,R=T+4|0,F=Yr(o[R>>2]|0,L)|0,o[R>>2]=F,T=T+8|0,L=Yr(o[T>>2]|0,L)|0,o[T>>2]=L}function ra(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;le=o[T>>2]|0,Se=(le|0)<0,F=(o[T+4>>2]|0)-(Se?le:0)|0,ue=(F|0)<0,te=(ue?0-F|0:0)+((o[T+8>>2]|0)-(Se?le:0))|0,R=(te|0)<0,T=R?0:te,L=(ue?0:F)-(R?te:0)|0,te=(Se?0:le)-(ue?F:0)-(R?te:0)|0,R=(L|0)<(te|0)?L:te,R=(T|0)<(R|0)?T:R,F=(R|0)>0,T=T-(F?R:0)|0,L=L-(F?R:0)|0;e:do switch(te-(F?R:0)|0){case 0:switch(L|0){case 0:return Se=T|0?(T|0)==1?1:7:0,Se|0;case 1:return Se=T|0?(T|0)==1?3:7:2,Se|0;default:break e}case 1:switch(L|0){case 0:return Se=T|0?(T|0)==1?5:7:4,Se|0;case 1:{if(!T)T=6;else break e;return T|0}default:break e}}while(!1);return Se=7,Se|0}function Nr(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;le=T+8|0,R=o[le>>2]|0,L=(o[T>>2]|0)-R|0,Se=T+4|0,R=(o[Se>>2]|0)-R|0,F=gn(+((L*3|0)-R|0)/7)|0,o[T>>2]=F,L=gn(+((R<<1)+L|0)/7)|0,o[Se>>2]=L,o[le>>2]=0,R=L-F|0,(F|0)<0?(ue=0-F|0,o[Se>>2]=R,o[le>>2]=ue,o[T>>2]=0,L=R,F=0,R=ue):R=0,(L|0)<0&&(F=F-L|0,o[T>>2]=F,R=R-L|0,o[le>>2]=R,o[Se>>2]=0,L=0),ue=F-R|0,te=L-R|0,(R|0)<0?(o[T>>2]=ue,o[Se>>2]=te,o[le>>2]=0,L=te,te=ue,R=0):te=F,F=(L|0)<(te|0)?L:te,F=(R|0)<(F|0)?R:F,!((F|0)<=0)&&(o[T>>2]=te-F,o[Se>>2]=L-F,o[le>>2]=R-F)}function ko(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;le=T+8|0,R=o[le>>2]|0,L=(o[T>>2]|0)-R|0,Se=T+4|0,R=(o[Se>>2]|0)-R|0,F=gn(+((L<<1)+R|0)/7)|0,o[T>>2]=F,L=gn(+((R*3|0)-L|0)/7)|0,o[Se>>2]=L,o[le>>2]=0,R=L-F|0,(F|0)<0?(ue=0-F|0,o[Se>>2]=R,o[le>>2]=ue,o[T>>2]=0,L=R,F=0,R=ue):R=0,(L|0)<0&&(F=F-L|0,o[T>>2]=F,R=R-L|0,o[le>>2]=R,o[Se>>2]=0,L=0),ue=F-R|0,te=L-R|0,(R|0)<0?(o[T>>2]=ue,o[Se>>2]=te,o[le>>2]=0,L=te,te=ue,R=0):te=F,F=(L|0)<(te|0)?L:te,F=(R|0)<(F|0)?R:F,!((F|0)<=0)&&(o[T>>2]=te-F,o[Se>>2]=L-F,o[le>>2]=R-F)}function Qo(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;L=o[T>>2]|0,le=T+4|0,R=o[le>>2]|0,Se=T+8|0,F=o[Se>>2]|0,te=R+(L*3|0)|0,o[T>>2]=te,R=F+(R*3|0)|0,o[le>>2]=R,L=(F*3|0)+L|0,o[Se>>2]=L,F=R-te|0,(te|0)<0?(L=L-te|0,o[le>>2]=F,o[Se>>2]=L,o[T>>2]=0,R=F,F=0):F=te,(R|0)<0&&(F=F-R|0,o[T>>2]=F,L=L-R|0,o[Se>>2]=L,o[le>>2]=0,R=0),ue=F-L|0,te=R-L|0,(L|0)<0?(o[T>>2]=ue,o[le>>2]=te,o[Se>>2]=0,F=ue,L=0):te=R,R=(te|0)<(F|0)?te:F,R=(L|0)<(R|0)?L:R,!((R|0)<=0)&&(o[T>>2]=F-R,o[le>>2]=te-R,o[Se>>2]=L-R)}function Ns(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;te=o[T>>2]|0,le=T+4|0,L=o[le>>2]|0,Se=T+8|0,R=o[Se>>2]|0,F=(L*3|0)+te|0,te=R+(te*3|0)|0,o[T>>2]=te,o[le>>2]=F,L=(R*3|0)+L|0,o[Se>>2]=L,R=F-te|0,(te|0)<0?(L=L-te|0,o[le>>2]=R,o[Se>>2]=L,o[T>>2]=0,te=0):R=F,(R|0)<0&&(te=te-R|0,o[T>>2]=te,L=L-R|0,o[Se>>2]=L,o[le>>2]=0,R=0),ue=te-L|0,F=R-L|0,(L|0)<0?(o[T>>2]=ue,o[le>>2]=F,o[Se>>2]=0,te=ue,L=0):F=R,R=(F|0)<(te|0)?F:te,R=(L|0)<(R|0)?L:R,!((R|0)<=0)&&(o[T>>2]=te-R,o[le>>2]=F-R,o[Se>>2]=L-R)}function Tl(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0;(L+-1|0)>>>0>=6||(te=(o[15472+(L*12|0)>>2]|0)+(o[T>>2]|0)|0,o[T>>2]=te,Se=T+4|0,F=(o[15472+(L*12|0)+4>>2]|0)+(o[Se>>2]|0)|0,o[Se>>2]=F,le=T+8|0,L=(o[15472+(L*12|0)+8>>2]|0)+(o[le>>2]|0)|0,o[le>>2]=L,R=F-te|0,(te|0)<0?(L=L-te|0,o[Se>>2]=R,o[le>>2]=L,o[T>>2]=0,F=0):(R=F,F=te),(R|0)<0&&(F=F-R|0,o[T>>2]=F,L=L-R|0,o[le>>2]=L,o[Se>>2]=0,R=0),ue=F-L|0,te=R-L|0,(L|0)<0?(o[T>>2]=ue,o[Se>>2]=te,o[le>>2]=0,F=ue,L=0):te=R,R=(te|0)<(F|0)?te:F,R=(L|0)<(R|0)?L:R,!((R|0)<=0)&&(o[T>>2]=F-R,o[Se>>2]=te-R,o[le>>2]=L-R))}function yo(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;te=o[T>>2]|0,le=T+4|0,L=o[le>>2]|0,Se=T+8|0,R=o[Se>>2]|0,F=L+te|0,te=R+te|0,o[T>>2]=te,o[le>>2]=F,L=R+L|0,o[Se>>2]=L,R=F-te|0,(te|0)<0?(L=L-te|0,o[le>>2]=R,o[Se>>2]=L,o[T>>2]=0,F=0):(R=F,F=te),(R|0)<0&&(F=F-R|0,o[T>>2]=F,L=L-R|0,o[Se>>2]=L,o[le>>2]=0,R=0),ue=F-L|0,te=R-L|0,(L|0)<0?(o[T>>2]=ue,o[le>>2]=te,o[Se>>2]=0,F=ue,L=0):te=R,R=(te|0)<(F|0)?te:F,R=(L|0)<(R|0)?L:R,!((R|0)<=0)&&(o[T>>2]=F-R,o[le>>2]=te-R,o[Se>>2]=L-R)}function Wo(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;L=o[T>>2]|0,le=T+4|0,F=o[le>>2]|0,Se=T+8|0,R=o[Se>>2]|0,te=F+L|0,o[T>>2]=te,F=R+F|0,o[le>>2]=F,L=R+L|0,o[Se>>2]=L,R=F-te|0,(te|0)<0?(L=L-te|0,o[le>>2]=R,o[Se>>2]=L,o[T>>2]=0,F=0):(R=F,F=te),(R|0)<0&&(F=F-R|0,o[T>>2]=F,L=L-R|0,o[Se>>2]=L,o[le>>2]=0,R=0),ue=F-L|0,te=R-L|0,(L|0)<0?(o[T>>2]=ue,o[le>>2]=te,o[Se>>2]=0,F=ue,L=0):te=R,R=(te|0)<(F|0)?te:F,R=(L|0)<(R|0)?L:R,!((R|0)<=0)&&(o[T>>2]=F-R,o[le>>2]=te-R,o[Se>>2]=L-R)}function ma(T){switch(T=T|0,T|0){case 1:{T=5;break}case 5:{T=4;break}case 4:{T=6;break}case 6:{T=2;break}case 2:{T=3;break}case 3:{T=1;break}}return T|0}function na(T){switch(T=T|0,T|0){case 1:{T=3;break}case 3:{T=2;break}case 2:{T=6;break}case 6:{T=4;break}case 4:{T=5;break}case 5:{T=1;break}}return T|0}function kl(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;L=o[T>>2]|0,le=T+4|0,R=o[le>>2]|0,Se=T+8|0,F=o[Se>>2]|0,te=R+(L<<1)|0,o[T>>2]=te,R=F+(R<<1)|0,o[le>>2]=R,L=(F<<1)+L|0,o[Se>>2]=L,F=R-te|0,(te|0)<0?(L=L-te|0,o[le>>2]=F,o[Se>>2]=L,o[T>>2]=0,R=F,F=0):F=te,(R|0)<0&&(F=F-R|0,o[T>>2]=F,L=L-R|0,o[Se>>2]=L,o[le>>2]=0,R=0),ue=F-L|0,te=R-L|0,(L|0)<0?(o[T>>2]=ue,o[le>>2]=te,o[Se>>2]=0,F=ue,L=0):te=R,R=(te|0)<(F|0)?te:F,R=(L|0)<(R|0)?L:R,!((R|0)<=0)&&(o[T>>2]=F-R,o[le>>2]=te-R,o[Se>>2]=L-R)}function Ja(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;te=o[T>>2]|0,le=T+4|0,L=o[le>>2]|0,Se=T+8|0,R=o[Se>>2]|0,F=(L<<1)+te|0,te=R+(te<<1)|0,o[T>>2]=te,o[le>>2]=F,L=(R<<1)+L|0,o[Se>>2]=L,R=F-te|0,(te|0)<0?(L=L-te|0,o[le>>2]=R,o[Se>>2]=L,o[T>>2]=0,te=0):R=F,(R|0)<0&&(te=te-R|0,o[T>>2]=te,L=L-R|0,o[Se>>2]=L,o[le>>2]=0,R=0),ue=te-L|0,F=R-L|0,(L|0)<0?(o[T>>2]=ue,o[le>>2]=F,o[Se>>2]=0,te=ue,L=0):F=R,R=(F|0)<(te|0)?F:te,R=(L|0)<(R|0)?L:R,!((R|0)<=0)&&(o[T>>2]=te-R,o[le>>2]=F-R,o[Se>>2]=L-R)}function Fa(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0;return le=(o[T>>2]|0)-(o[L>>2]|0)|0,Se=(le|0)<0,F=(o[T+4>>2]|0)-(o[L+4>>2]|0)-(Se?le:0)|0,ue=(F|0)<0,te=(Se?0-le|0:0)+(o[T+8>>2]|0)-(o[L+8>>2]|0)+(ue?0-F|0:0)|0,T=(te|0)<0,L=T?0:te,R=(ue?0:F)-(T?te:0)|0,te=(Se?0:le)-(ue?F:0)-(T?te:0)|0,T=(R|0)<(te|0)?R:te,T=(L|0)<(T|0)?L:T,F=(T|0)>0,L=L-(F?T:0)|0,R=R-(F?T:0)|0,T=te-(F?T:0)|0,T=(T|0)>-1?T:0-T|0,R=(R|0)>-1?R:0-R|0,L=(L|0)>-1?L:0-L|0,L=(R|0)>(L|0)?R:L,((T|0)>(L|0)?T:L)|0}function gl(T,L){T=T|0,L=L|0;var R=0;R=o[T+8>>2]|0,o[L>>2]=(o[T>>2]|0)-R,o[L+4>>2]=(o[T+4>>2]|0)-R}function Ml(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0;F=o[T>>2]|0,o[L>>2]=F,T=o[T+4>>2]|0,le=L+4|0,o[le>>2]=T,Se=L+8|0,o[Se>>2]=0,R=T-F|0,(F|0)<0?(T=0-F|0,o[le>>2]=R,o[Se>>2]=T,o[L>>2]=0,F=0):(R=T,T=0),(R|0)<0&&(F=F-R|0,o[L>>2]=F,T=T-R|0,o[Se>>2]=T,o[le>>2]=0,R=0),ue=F-T|0,te=R-T|0,(T|0)<0?(o[L>>2]=ue,o[le>>2]=te,o[Se>>2]=0,R=te,te=ue,T=0):te=F,F=(R|0)<(te|0)?R:te,F=(T|0)<(F|0)?T:F,!((F|0)<=0)&&(o[L>>2]=te-F,o[le>>2]=R-F,o[Se>>2]=T-F)}function yu(T){T=T|0;var L=0,R=0,F=0,te=0;L=T+8|0,te=o[L>>2]|0,R=te-(o[T>>2]|0)|0,o[T>>2]=R,F=T+4|0,T=(o[F>>2]|0)-te|0,o[F>>2]=T,o[L>>2]=0-(T+R)}function ps(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;R=o[T>>2]|0,L=0-R|0,o[T>>2]=L,le=T+8|0,o[le>>2]=0,Se=T+4|0,F=o[Se>>2]|0,te=F+R|0,(R|0)>0?(o[Se>>2]=te,o[le>>2]=R,o[T>>2]=0,L=0,F=te):R=0,(F|0)<0?(ue=L-F|0,o[T>>2]=ue,R=R-F|0,o[le>>2]=R,o[Se>>2]=0,te=ue-R|0,L=0-R|0,(R|0)<0?(o[T>>2]=te,o[Se>>2]=L,o[le>>2]=0,F=L,R=0):(F=0,te=ue)):te=L,L=(F|0)<(te|0)?F:te,L=(R|0)<(L|0)?R:L,!((L|0)<=0)&&(o[T>>2]=te-L,o[Se>>2]=F-L,o[le>>2]=R-L)}function lc(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;F=Gt,Gt=Gt+16|0,te=F,uo(T,L,R,te),Wr(te,R+4|0),Gt=F}function uo(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0;if(Xe=Gt,Gt=Gt+32|0,ue=Xe,uc(T,ue),o[R>>2]=0,te=+oa(15888,ue),le=+oa(15912,ue),le<te&&(o[R>>2]=1,te=le),le=+oa(15936,ue),le<te&&(o[R>>2]=2,te=le),le=+oa(15960,ue),le<te&&(o[R>>2]=3,te=le),le=+oa(15984,ue),le<te&&(o[R>>2]=4,te=le),le=+oa(16008,ue),le<te&&(o[R>>2]=5,te=le),le=+oa(16032,ue),le<te&&(o[R>>2]=6,te=le),le=+oa(16056,ue),le<te&&(o[R>>2]=7,te=le),le=+oa(16080,ue),le<te&&(o[R>>2]=8,te=le),le=+oa(16104,ue),le<te&&(o[R>>2]=9,te=le),le=+oa(16128,ue),le<te&&(o[R>>2]=10,te=le),le=+oa(16152,ue),le<te&&(o[R>>2]=11,te=le),le=+oa(16176,ue),le<te&&(o[R>>2]=12,te=le),le=+oa(16200,ue),le<te&&(o[R>>2]=13,te=le),le=+oa(16224,ue),le<te&&(o[R>>2]=14,te=le),le=+oa(16248,ue),le<te&&(o[R>>2]=15,te=le),le=+oa(16272,ue),le<te&&(o[R>>2]=16,te=le),le=+oa(16296,ue),le<te&&(o[R>>2]=17,te=le),le=+oa(16320,ue),le<te&&(o[R>>2]=18,te=le),le=+oa(16344,ue),le<te&&(o[R>>2]=19,te=le),le=+Jt(+(1-te*.5)),le<1e-16){o[F>>2]=0,o[F+4>>2]=0,o[F+8>>2]=0,o[F+12>>2]=0,Gt=Xe;return}if(R=o[R>>2]|0,te=+Me[16368+(R*24|0)>>3],te=+Ko(te-+Ko(+Pr(15568+(R<<4)|0,T))),Hr(L)|0?Se=+Ko(te+-.3334731722518321):Se=te,te=+Si(+le)/.381966011250105,(L|0)>0){ue=0;do te=te*2.6457513110645907,ue=ue+1|0;while((ue|0)!=(L|0))}le=+Ri(+Se)*te,Me[F>>3]=le,Se=+bi(+Se)*te,Me[F+8>>3]=Se,Gt=Xe}function co(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0;if(ue=+Vu(T),ue<1e-16){L=15568+(L<<4)|0,o[te>>2]=o[L>>2],o[te+4>>2]=o[L+4>>2],o[te+8>>2]=o[L+8>>2],o[te+12>>2]=o[L+12>>2];return}if(le=+mn(+ +Me[T+8>>3],+ +Me[T>>3]),(R|0)>0){T=0;do ue=ue/2.6457513110645907,T=T+1|0;while((T|0)!=(R|0))}F?(ue=ue/3,R=(Hr(R)|0)==0,ue=+ur(+((R?ue:ue/2.6457513110645907)*.381966011250105))):(ue=+ur(+(ue*.381966011250105)),Hr(R)|0&&(le=+Ko(le+.3334731722518321))),Kn(15568+(L<<4)|0,+Ko(+Me[16368+(L*24|0)>>3]-le),ue,te)}function Xl(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;F=Gt,Gt=Gt+16|0,te=F,Mr(T+4|0,te),co(te,o[T>>2]|0,L,0,R),Gt=F}function No(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0,l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0;if(Y=Gt,Gt=Gt+272|0,ue=Y+256|0,V=Y+240|0,k=Y,z=Y+224|0,Z=Y+208|0,x=Y+176|0,s=Y+160|0,i=Y+192|0,r=Y+144|0,l=Y+128|0,d=Y+112|0,y=Y+96|0,I=Y+80|0,o[ue>>2]=L,o[V>>2]=o[T>>2],o[V+4>>2]=o[T+4>>2],o[V+8>>2]=o[T+8>>2],o[V+12>>2]=o[T+12>>2],$o(V,ue,k),o[te>>2]=0,V=F+R+((F|0)==5&1)|0,(V|0)<=(R|0)){Gt=Y;return}Xe=o[ue>>2]|0,bt=z+4|0,kt=x+4|0,ri=R+5|0,Ht=16848+(Xe<<2)|0,Qt=16928+(Xe<<2)|0,Q=l+8|0,A=d+8|0,C=y+8|0,O=Z+4|0,Se=R;e:for(;;){le=k+(((Se|0)%5|0)<<4)|0,o[Z>>2]=o[le>>2],o[Z+4>>2]=o[le+4>>2],o[Z+8>>2]=o[le+8>>2],o[Z+12>>2]=o[le+12>>2];do;while((Mo(Z,Xe,0,1)|0)==2);if((Se|0)>(R|0)&(Hr(L)|0)!=0){if(o[x>>2]=o[Z>>2],o[x+4>>2]=o[Z+4>>2],o[x+8>>2]=o[Z+8>>2],o[x+12>>2]=o[Z+12>>2],Mr(bt,s),F=o[x>>2]|0,ue=o[17008+(F*80|0)+(o[z>>2]<<2)>>2]|0,o[x>>2]=o[18608+(F*80|0)+(ue*20|0)>>2],le=o[18608+(F*80|0)+(ue*20|0)+16>>2]|0,(le|0)>0){T=0;do yo(kt),T=T+1|0;while((T|0)<(le|0))}switch(le=18608+(F*80|0)+(ue*20|0)+4|0,o[i>>2]=o[le>>2],o[i+4>>2]=o[le+4>>2],o[i+8>>2]=o[le+8>>2],Sr(i,(o[Ht>>2]|0)*3|0),Or(kt,i,kt),sr(kt),Mr(kt,r),Ae=+(o[Qt>>2]|0),Me[l>>3]=Ae*3,Me[Q>>3]=0,Ie=Ae*-1.5,Me[d>>3]=Ie,Me[A>>3]=Ae*2.598076211353316,Me[y>>3]=Ie,Me[C>>3]=Ae*-2.598076211353316,o[17008+((o[x>>2]|0)*80|0)+(o[Z>>2]<<2)>>2]|0){case 1:{T=d,F=l;break}case 3:{T=y,F=d;break}case 2:{T=l,F=y;break}default:{T=12;break e}}ql(s,r,F,T,I),co(I,o[x>>2]|0,Xe,1,te+8+(o[te>>2]<<4)|0),o[te>>2]=(o[te>>2]|0)+1}if((Se|0)<(ri|0)&&(Mr(O,x),co(x,o[Z>>2]|0,Xe,1,te+8+(o[te>>2]<<4)|0),o[te>>2]=(o[te>>2]|0)+1),o[z>>2]=o[Z>>2],o[z+4>>2]=o[Z+4>>2],o[z+8>>2]=o[Z+8>>2],o[z+12>>2]=o[Z+12>>2],Se=Se+1|0,(Se|0)>=(V|0)){T=3;break}}if((T|0)==3){Gt=Y;return}else(T|0)==12&&en(22474,22521,581,22531)}function $o(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0;Xe=Gt,Gt=Gt+128|0,F=Xe+64|0,te=Xe,ue=F,le=20208,Se=ue+60|0;do o[ue>>2]=o[le>>2],ue=ue+4|0,le=le+4|0;while((ue|0)<(Se|0));ue=te,le=20272,Se=ue+60|0;do o[ue>>2]=o[le>>2],ue=ue+4|0,le=le+4|0;while((ue|0)<(Se|0));Se=(Hr(o[L>>2]|0)|0)==0,F=Se?F:te,te=T+4|0,kl(te),Ja(te),Hr(o[L>>2]|0)|0&&(Ns(te),o[L>>2]=(o[L>>2]|0)+1),o[R>>2]=o[T>>2],L=R+4|0,Or(te,F,L),sr(L),o[R+16>>2]=o[T>>2],L=R+20|0,Or(te,F+12|0,L),sr(L),o[R+32>>2]=o[T>>2],L=R+36|0,Or(te,F+24|0,L),sr(L),o[R+48>>2]=o[T>>2],L=R+52|0,Or(te,F+36|0,L),sr(L),o[R+64>>2]=o[T>>2],R=R+68|0,Or(te,F+48|0,R),sr(R),Gt=Xe}function Mo(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0;if(Q=Gt,Gt=Gt+32|0,Ht=Q+12|0,Se=Q,Qt=T+4|0,ri=o[16928+(L<<2)>>2]|0,kt=(F|0)!=0,ri=kt?ri*3|0:ri,te=o[Qt>>2]|0,bt=T+8|0,le=o[bt>>2]|0,kt){if(ue=T+12|0,F=o[ue>>2]|0,te=le+te+F|0,(te|0)==(ri|0))return Qt=1,Gt=Q,Qt|0;Xe=ue}else Xe=T+12|0,F=o[Xe>>2]|0,te=le+te+F|0;if((te|0)<=(ri|0))return Qt=0,Gt=Q,Qt|0;do if((F|0)>0){if(F=o[T>>2]|0,(le|0)>0){ue=18608+(F*80|0)+60|0,F=T;break}F=18608+(F*80|0)+40|0,R?(ml(Ht,ri,0,0),Ys(Qt,Ht,Se),Wo(Se),Or(Se,Ht,Qt),ue=F,F=T):(ue=F,F=T)}else ue=18608+((o[T>>2]|0)*80|0)+20|0,F=T;while(!1);if(o[F>>2]=o[ue>>2],te=ue+16|0,(o[te>>2]|0)>0){F=0;do yo(Qt),F=F+1|0;while((F|0)<(o[te>>2]|0))}return T=ue+4|0,o[Ht>>2]=o[T>>2],o[Ht+4>>2]=o[T+4>>2],o[Ht+8>>2]=o[T+8>>2],L=o[16848+(L<<2)>>2]|0,Sr(Ht,kt?L*3|0:L),Or(Qt,Ht,Qt),sr(Qt),kt?F=((o[bt>>2]|0)+(o[Qt>>2]|0)+(o[Xe>>2]|0)|0)==(ri|0)?1:2:F=2,Qt=F,Gt=Q,Qt|0}function Qs(T,L){T=T|0,L=L|0;var R=0;do R=Mo(T,L,0,1)|0;while((R|0)==2);return R|0}function Xo(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0,l=0,d=0,y=0,I=0,k=0;if(y=Gt,Gt=Gt+240|0,ue=y+224|0,i=y+208|0,r=y,l=y+192|0,d=y+176|0,C=y+160|0,O=y+144|0,V=y+128|0,x=y+112|0,s=y+96|0,o[ue>>2]=L,o[i>>2]=o[T>>2],o[i+4>>2]=o[T+4>>2],o[i+8>>2]=o[T+8>>2],o[i+12>>2]=o[T+12>>2],Yo(i,ue,r),o[te>>2]=0,A=F+R+((F|0)==6&1)|0,(A|0)<=(R|0)){Gt=y;return}Xe=o[ue>>2]|0,bt=R+6|0,kt=16928+(Xe<<2)|0,ri=O+8|0,Ht=V+8|0,Qt=x+8|0,Q=l+4|0,le=0,Se=R,F=-1;e:for(;;){if(ue=(Se|0)%6|0,T=r+(ue<<4)|0,o[l>>2]=o[T>>2],o[l+4>>2]=o[T+4>>2],o[l+8>>2]=o[T+8>>2],o[l+12>>2]=o[T+12>>2],T=le,le=Mo(l,Xe,0,1)|0,(Se|0)>(R|0)&(Hr(L)|0)!=0&&(T|0)!=1&&(o[l>>2]|0)!=(F|0)){switch(Mr(r+(((ue+5|0)%6|0)<<4)+4|0,d),Mr(r+(ue<<4)+4|0,C),I=+(o[kt>>2]|0),Me[O>>3]=I*3,Me[ri>>3]=0,k=I*-1.5,Me[V>>3]=k,Me[Ht>>3]=I*2.598076211353316,Me[x>>3]=k,Me[Qt>>3]=I*-2.598076211353316,ue=o[i>>2]|0,o[17008+(ue*80|0)+(((F|0)==(ue|0)?o[l>>2]|0:F)<<2)>>2]|0){case 1:{T=V,F=O;break}case 3:{T=x,F=V;break}case 2:{T=O,F=x;break}default:{T=8;break e}}ql(d,C,F,T,s),!(vl(d,s)|0)&&!(vl(C,s)|0)&&(co(s,o[i>>2]|0,Xe,1,te+8+(o[te>>2]<<4)|0),o[te>>2]=(o[te>>2]|0)+1)}if((Se|0)<(bt|0)&&(Mr(Q,d),co(d,o[l>>2]|0,Xe,1,te+8+(o[te>>2]<<4)|0),o[te>>2]=(o[te>>2]|0)+1),Se=Se+1|0,(Se|0)>=(A|0)){T=3;break}else F=o[l>>2]|0}if((T|0)==3){Gt=y;return}else(T|0)==8&&en(22557,22521,746,22602)}function Yo(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0;Xe=Gt,Gt=Gt+160|0,F=Xe+80|0,te=Xe,ue=F,le=20336,Se=ue+72|0;do o[ue>>2]=o[le>>2],ue=ue+4|0,le=le+4|0;while((ue|0)<(Se|0));ue=te,le=20416,Se=ue+72|0;do o[ue>>2]=o[le>>2],ue=ue+4|0,le=le+4|0;while((ue|0)<(Se|0));Se=(Hr(o[L>>2]|0)|0)==0,F=Se?F:te,te=T+4|0,kl(te),Ja(te),Hr(o[L>>2]|0)|0&&(Ns(te),o[L>>2]=(o[L>>2]|0)+1),o[R>>2]=o[T>>2],L=R+4|0,Or(te,F,L),sr(L),o[R+16>>2]=o[T>>2],L=R+20|0,Or(te,F+12|0,L),sr(L),o[R+32>>2]=o[T>>2],L=R+36|0,Or(te,F+24|0,L),sr(L),o[R+48>>2]=o[T>>2],L=R+52|0,Or(te,F+36|0,L),sr(L),o[R+64>>2]=o[T>>2],L=R+68|0,Or(te,F+48|0,L),sr(L),o[R+80>>2]=o[T>>2],R=R+84|0,Or(te,F+60|0,R),sr(R),Gt=Xe}function Ko(T){T=+T;var L=0;return L=T<0?T+6.283185307179586:T,+(T>=6.283185307179586?L+-6.283185307179586:L)}function Ta(T,L){return T=T|0,L=L|0,+fi(+(+Me[T>>3]-+Me[L>>3]))<17453292519943298e-27?(L=+fi(+(+Me[T+8>>3]-+Me[L+8>>3]))<17453292519943298e-27,L|0):(L=0,L|0)}function eo(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0;return te=+Me[L>>3],F=+Me[T>>3],ue=+bi(+((te-F)*.5)),R=+bi(+((+Me[L+8>>3]-+Me[T+8>>3])*.5)),R=ue*ue+R*(+Ri(+te)*+Ri(+F)*R),+(+mn(+ +ti(+R),+ +ti(+(1-R)))*2)}function Ds(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0;return te=+Me[L>>3],F=+Me[T>>3],ue=+bi(+((te-F)*.5)),R=+bi(+((+Me[L+8>>3]-+Me[T+8>>3])*.5)),R=ue*ue+R*(+Ri(+te)*+Ri(+F)*R),+(+mn(+ +ti(+R),+ +ti(+(1-R)))*2*6371.007180918475)}function vu(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0;return te=+Me[L>>3],F=+Me[T>>3],ue=+bi(+((te-F)*.5)),R=+bi(+((+Me[L+8>>3]-+Me[T+8>>3])*.5)),R=ue*ue+R*(+Ri(+te)*+Ri(+F)*R),+(+mn(+ +ti(+R),+ +ti(+(1-R)))*2*6371.007180918475*1e3)}function Pr(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0;return ue=+Me[L>>3],F=+Ri(+ue),te=+Me[L+8>>3]-+Me[T+8>>3],le=F*+bi(+te),R=+Me[T>>3],+ +mn(+le,+(+bi(+ue)*+Ri(+R)-+Ri(+te)*(F*+bi(+R))))}function Kn(T,L,R,F){T=T|0,L=+L,R=+R,F=F|0;var te=0,ue=0,le=0,Se=0;if(R<1e-16){o[F>>2]=o[T>>2],o[F+4>>2]=o[T+4>>2],o[F+8>>2]=o[T+8>>2],o[F+12>>2]=o[T+12>>2];return}ue=L<0?L+6.283185307179586:L,ue=L>=6.283185307179586?ue+-6.283185307179586:ue;do if(ue<1e-16)L=+Me[T>>3]+R,Me[F>>3]=L,te=F;else{if(te=+fi(+(ue+-3.141592653589793))<1e-16,L=+Me[T>>3],te){L=L-R,Me[F>>3]=L,te=F;break}if(le=+Ri(+R),R=+bi(+R),L=le*+bi(+L)+ +Ri(+ue)*(R*+Ri(+L)),L=L>1?1:L,L=+Sn(+(L<-1?-1:L)),Me[F>>3]=L,+fi(+(L+-1.5707963267948966))<1e-16){Me[F>>3]=1.5707963267948966,Me[F+8>>3]=0;return}if(+fi(+(L+1.5707963267948966))<1e-16){Me[F>>3]=-1.5707963267948966,Me[F+8>>3]=0;return}if(Se=+Ri(+L),ue=R*+bi(+ue)/Se,R=+Me[T>>3],L=(le-+bi(+L)*+bi(+R))/+Ri(+R)/Se,le=ue>1?1:ue,L=L>1?1:L,L=+Me[T+8>>3]+ +mn(+(le<-1?-1:le),+(L<-1?-1:L)),L>3.141592653589793)do L=L+-6.283185307179586;while(L>3.141592653589793);if(L<-3.141592653589793)do L=L+6.283185307179586;while(L<-3.141592653589793);Me[F+8>>3]=L;return}while(!1);if(+fi(+(L+-1.5707963267948966))<1e-16){Me[te>>3]=1.5707963267948966,Me[F+8>>3]=0;return}if(+fi(+(L+1.5707963267948966))<1e-16){Me[te>>3]=-1.5707963267948966,Me[F+8>>3]=0;return}if(L=+Me[T+8>>3],L>3.141592653589793)do L=L+-6.283185307179586;while(L>3.141592653589793);if(L<-3.141592653589793)do L=L+6.283185307179586;while(L<-3.141592653589793);Me[F+8>>3]=L}function Jo(T){return T=T|0,+ +Me[20496+(T<<3)>>3]}function Vr(T){return T=T|0,+ +Me[20624+(T<<3)>>3]}function to(T){return T=T|0,+ +Me[20752+(T<<3)>>3]}function ss(T){return T=T|0,+ +Me[20880+(T<<3)>>3]}function pr(T){T=T|0;var L=0;return L=21008+(T<<3)|0,T=o[L>>2]|0,Gn(o[L+4>>2]|0),T|0}function Po(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0;return Ht=+Me[L>>3],kt=+Me[T>>3],Xe=+bi(+((Ht-kt)*.5)),ue=+Me[L+8>>3],bt=+Me[T+8>>3],le=+bi(+((ue-bt)*.5)),Se=+Ri(+kt),ri=+Ri(+Ht),le=Xe*Xe+le*(ri*Se*le),le=+mn(+ +ti(+le),+ +ti(+(1-le)))*2,Xe=+Me[R>>3],Ht=+bi(+((Xe-Ht)*.5)),F=+Me[R+8>>3],ue=+bi(+((F-ue)*.5)),te=+Ri(+Xe),ue=Ht*Ht+ue*(ri*te*ue),ue=+mn(+ +ti(+ue),+ +ti(+(1-ue)))*2,Xe=+bi(+((kt-Xe)*.5)),F=+bi(+((bt-F)*.5)),F=Xe*Xe+F*(Se*te*F),F=+mn(+ +ti(+F),+ +ti(+(1-F)))*2,te=(le+ue+F)*.5,+(+ur(+ +ti(+(+Si(+(te*.5))*+Si(+((te-le)*.5))*+Si(+((te-ue)*.5))*+Si(+((te-F)*.5)))))*4)}function qn(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0;if(ue=Gt,Gt=Gt+192|0,F=ue+168|0,te=ue,Ma(T,L,F),Oa(T,L,te),L=o[te>>2]|0,(L|0)<=0)return R=0,Gt=ue,+R;if(R=+Po(te+8|0,te+8+(((L|0)!=1&1)<<4)|0,F)+0,(L|0)==1)return Gt=ue,+R;T=1;do le=T,T=T+1|0,R=R+ +Po(te+8+(le<<4)|0,te+8+(((T|0)%(L|0)|0)<<4)|0,F);while((T|0)<(L|0));return Gt=ue,+R}function Ul(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0;if(ue=Gt,Gt=Gt+192|0,F=ue+168|0,te=ue,Ma(T,L,F),Oa(T,L,te),L=o[te>>2]|0,(L|0)>0){if(R=+Po(te+8|0,te+8+(((L|0)!=1&1)<<4)|0,F)+0,(L|0)!=1){T=1;do le=T,T=T+1|0,R=R+ +Po(te+8+(le<<4)|0,te+8+(((T|0)%(L|0)|0)<<4)|0,F);while((T|0)<(L|0))}}else R=0;return Gt=ue,+(R*6371.007180918475*6371.007180918475)}function as(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0;if(ue=Gt,Gt=Gt+192|0,F=ue+168|0,te=ue,Ma(T,L,F),Oa(T,L,te),L=o[te>>2]|0,(L|0)>0){if(R=+Po(te+8|0,te+8+(((L|0)!=1&1)<<4)|0,F)+0,(L|0)!=1){T=1;do le=T,T=T+1|0,R=R+ +Po(te+8+(le<<4)|0,te+8+(((T|0)%(L|0)|0)<<4)|0,F);while((T|0)<(L|0))}}else R=0;return Gt=ue,+(R*6371.007180918475*6371.007180918475*1e3*1e3)}function Kr(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0;if(le=Gt,Gt=Gt+176|0,ue=le,Ui(T,L,ue),T=o[ue>>2]|0,(T|0)<=1)return te=0,Gt=le,+te;L=T+-1|0,T=0,R=0,F=+Me[ue+8>>3],te=+Me[ue+16>>3];do T=T+1|0,Xe=F,F=+Me[ue+8+(T<<4)>>3],bt=+bi(+((F-Xe)*.5)),Se=te,te=+Me[ue+8+(T<<4)+8>>3],Se=+bi(+((te-Se)*.5)),Se=bt*bt+Se*(+Ri(+F)*+Ri(+Xe)*Se),R=R+ +mn(+ +ti(+Se),+ +ti(+(1-Se)))*2;while((T|0)<(L|0));return Gt=le,+R}function Ls(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0;if(le=Gt,Gt=Gt+176|0,ue=le,Ui(T,L,ue),T=o[ue>>2]|0,(T|0)<=1)return te=0,Gt=le,+te;L=T+-1|0,T=0,R=0,F=+Me[ue+8>>3],te=+Me[ue+16>>3];do T=T+1|0,Xe=F,F=+Me[ue+8+(T<<4)>>3],bt=+bi(+((F-Xe)*.5)),Se=te,te=+Me[ue+8+(T<<4)+8>>3],Se=+bi(+((te-Se)*.5)),Se=bt*bt+Se*(+Ri(+Xe)*+Ri(+F)*Se),R=R+ +mn(+ +ti(+Se),+ +ti(+(1-Se)))*2;while((T|0)!=(L|0));return bt=R*6371.007180918475,Gt=le,+bt}function Br(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0;if(le=Gt,Gt=Gt+176|0,ue=le,Ui(T,L,ue),T=o[ue>>2]|0,(T|0)<=1)return te=0,Gt=le,+te;L=T+-1|0,T=0,R=0,F=+Me[ue+8>>3],te=+Me[ue+16>>3];do T=T+1|0,Xe=F,F=+Me[ue+8+(T<<4)>>3],bt=+bi(+((F-Xe)*.5)),Se=te,te=+Me[ue+8+(T<<4)+8>>3],Se=+bi(+((te-Se)*.5)),Se=bt*bt+Se*(+Ri(+Xe)*+Ri(+F)*Se),R=R+ +mn(+ +ti(+Se),+ +ti(+(1-Se)))*2;while((T|0)!=(L|0));return bt=R*6371.007180918475*1e3,Gt=le,+bt}function ar(T,L){return T=T|0,L=L|0,L=Mi(T|0,L|0,52)|0,Xt()|0,L&15|0}function ul(T,L){return T=T|0,L=L|0,L=Mi(T|0,L|0,45)|0,Xt()|0,L&127|0}function is(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0;if(!(!0&(L&-16777216|0)==134217728)||(le=Mi(T|0,L|0,45)|0,Xt()|0,le=le&127,le>>>0>121))return L=0,L|0;R=Mi(T|0,L|0,52)|0,Xt()|0,R=R&15;do if(R|0){for(te=1,F=0;;){if(ue=Mi(T|0,L|0,(15-te|0)*3|0)|0,Xt()|0,ue=ue&7,(ue|0)!=0&(F^1))if((ue|0)==1&(G(le)|0)!=0){Se=0,F=13;break}else F=1;if((ue|0)==7){Se=0,F=13;break}if(te>>>0<R>>>0)te=te+1|0;else{F=9;break}}if((F|0)==9){if((R|0)==15)Se=1;else break;return Se|0}else if((F|0)==13)return Se|0}while(!1);for(;;){if(Se=Mi(T|0,L|0,(14-R|0)*3|0)|0,Xt()|0,!((Se&7|0)==7&!0)){Se=0,F=13;break}if(R>>>0<14)R=R+1|0;else{Se=1,F=13;break}}return(F|0)==13?Se|0:0}function Do(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;if(F=Mi(T|0,L|0,52)|0,Xt()|0,F=F&15,(F|0)>=(R|0)){if((F|0)!=(R|0))if(R>>>0<=15){if(te=zi(R|0,0,52)|0,T=te|T,L=Xt()|0|L&-15728641,(F|0)>(R|0))do te=zi(7,0,(14-R|0)*3|0)|0,R=R+1|0,T=te|T,L=Xt()|0|L;while((R|0)<(F|0))}else L=0,T=0}else L=0,T=0;return Gn(L|0),T|0}function cl(T,L,R){return T=T|0,L=L|0,R=R|0,T=Mi(T|0,L|0,52)|0,Xt()|0,T=T&15,(R|0)<16&(T|0)<=(R|0)?(R=wo(7,R-T|0)|0,R|0):(R=0,R|0)}function Jr(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0;if(le=Mi(T|0,L|0,52)|0,Xt()|0,le=le&15,!!((R|0)<16&(le|0)<=(R|0))){if((le|0)==(R|0)){R=F,o[R>>2]=T,o[R+4>>2]=L;return}if(Xe=wo(7,R-le|0)|0,bt=(Xe|0)/7|0,Se=Mi(T|0,L|0,45)|0,Xt()|0,!(G(Se&127)|0))ue=0;else{e:do if(!le)te=0;else for(ue=1;;){if(te=Mi(T|0,L|0,(15-ue|0)*3|0)|0,Xt()|0,te=te&7,te|0)break e;if(ue>>>0<le>>>0)ue=ue+1|0;else{te=0;break}}while(!1);ue=(te|0)==0}if(kt=zi(le+1|0,0,52)|0,te=Xt()|0|L&-15728641,Se=(14-le|0)*3|0,L=zi(7,0,Se|0)|0,L=(kt|T)&~L,le=te&~(Xt()|0),Jr(L,le,R,F),te=F+(bt<<3)|0,!ue){kt=zi(1,0,Se|0)|0,Jr(kt|L,Xt()|0|le,R,te),kt=te+(bt<<3)|0,Xe=zi(2,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt),kt=kt+(bt<<3)|0,Xe=zi(3,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt),kt=kt+(bt<<3)|0,Xe=zi(4,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt),kt=kt+(bt<<3)|0,Xe=zi(5,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt),Xe=zi(6,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt+(bt<<3)|0);return}ue=te+(bt<<3)|0,(Xe|0)>6&&(Xe=te+8|0,kt=(ue>>>0>Xe>>>0?ue:Xe)+-1+(0-te)|0,ms(te|0,0,kt+8&-8|0)|0,te=Xe+(kt>>>3<<3)|0),kt=zi(2,0,Se|0)|0,Jr(kt|L,Xt()|0|le,R,te),kt=te+(bt<<3)|0,Xe=zi(3,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt),kt=kt+(bt<<3)|0,Xe=zi(4,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt),kt=kt+(bt<<3)|0,Xe=zi(5,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt),Xe=zi(6,0,Se|0)|0,Jr(Xe|L,Xt()|0|le,R,kt+(bt<<3)|0)}}function gs(T,L){T=T|0,L=L|0;var R=0,F=0,te=0;if(te=Mi(T|0,L|0,45)|0,Xt()|0,!(G(te&127)|0))return te=0,te|0;te=Mi(T|0,L|0,52)|0,Xt()|0,te=te&15;e:do if(!te)R=0;else for(F=1;;){if(R=Mi(T|0,L|0,(15-F|0)*3|0)|0,Xt()|0,R=R&7,R|0)break e;if(F>>>0<te>>>0)F=F+1|0;else{R=0;break}}while(!1);return te=(R|0)==0&1,te|0}function ka(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;if(F=Mi(T|0,L|0,52)|0,Xt()|0,F=F&15,(R|0)<16&(F|0)<=(R|0)){if((F|0)!=(R|0)&&(te=zi(R|0,0,52)|0,T=te|T,L=Xt()|0|L&-15728641,(F|0)<(R|0)))do te=zi(7,0,(14-F|0)*3|0)|0,F=F+1|0,T=T&~te,L=L&~(Xt()|0);while((F|0)<(R|0))}else L=0,T=0;return Gn(L|0),T|0}function Pl(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0,l=0,d=0;if(!R)return l=0,l|0;if(te=T,F=o[te>>2]|0,te=o[te+4>>2]|0,!0&(te&15728640|0)==0){if((R|0)<=0||(l=L,o[l>>2]=F,o[l+4>>2]=te,(R|0)==1))return l=0,l|0;F=1;do i=T+(F<<3)|0,r=o[i+4>>2]|0,l=L+(F<<3)|0,o[l>>2]=o[i>>2],o[l+4>>2]=r,F=F+1|0;while((F|0)!=(R|0));return F=0,F|0}if(i=R<<3,r=Zn(i)|0,!r)return l=-3,l|0;if(Uo(r|0,T|0,i|0)|0,s=il(R,8)|0,!s)return ir(r),l=-3,l|0;F=R;e:for(;;){le=r,kt=o[le>>2]|0,le=o[le+4>>2]|0,V=Mi(kt|0,le|0,52)|0,Xt()|0,V=V&15,x=V+-1|0,O=(F|0)>0;t:do if(O){if(C=((F|0)<0)<<31>>31,Q=zi(x|0,0,52)|0,A=Xt()|0,x>>>0>15)for(te=0,T=kt,R=le;;){if(!((T|0)==0&(R|0)==0)){if(ue=Mi(T|0,R|0,52)|0,Xt()|0,ue=ue&15,Se=(ue|0)<(x|0),ue=(ue|0)==(x|0),bt=Se?0:ue?T:0,T=Se?0:ue?R:0,R=Bo(bt|0,T|0,F|0,C|0)|0,Xt()|0,ue=s+(R<<3)|0,Se=ue,Xe=o[Se>>2]|0,Se=o[Se+4>>2]|0,(Xe|0)==0&(Se|0)==0)R=bt;else for(Q=0,Qt=R,Ht=Se,R=bt;;){if((Q|0)>(F|0)){l=41;break e}if((Xe|0)==(R|0)&(Ht&-117440513|0)==(T|0)){bt=Mi(Xe|0,Ht|0,56)|0,Xt()|0,bt=bt&7,ri=bt+1|0,A=Mi(Xe|0,Ht|0,45)|0,Xt()|0;i:do if(!(G(A&127)|0))Se=7;else{if(Xe=Mi(Xe|0,Ht|0,52)|0,Xt()|0,Xe=Xe&15,!Xe){Se=6;break}for(Se=1;;){if(A=zi(7,0,(15-Se|0)*3|0)|0,!((A&R|0)==0&((Xt()|0)&T|0)==0)){Se=7;break i}if(Se>>>0<Xe>>>0)Se=Se+1|0;else{Se=6;break}}}while(!1);if((bt+2|0)>>>0>Se>>>0){l=51;break e}A=zi(ri|0,0,56)|0,T=Xt()|0|T&-117440513,Se=ue,o[Se>>2]=0,o[Se+4>>2]=0,Se=Qt,R=A|R}else Se=(Qt+1|0)%(F|0)|0;if(ue=s+(Se<<3)|0,Ht=ue,Xe=o[Ht>>2]|0,Ht=o[Ht+4>>2]|0,(Xe|0)==0&(Ht|0)==0)break;Q=Q+1|0,Qt=Se}A=ue,o[A>>2]=R,o[A+4>>2]=T}if(te=te+1|0,(te|0)>=(F|0))break t;R=r+(te<<3)|0,T=o[R>>2]|0,R=o[R+4>>2]|0}for(te=0,T=kt,R=le;;){if(!((T|0)==0&(R|0)==0)){if(Se=Mi(T|0,R|0,52)|0,Xt()|0,Se=Se&15,(Se|0)>=(x|0)){if((Se|0)!=(x|0)&&(T=T|Q,R=R&-15728641|A,Se>>>0>=V>>>0)){ue=x;do Qt=zi(7,0,(14-ue|0)*3|0)|0,ue=ue+1|0,T=Qt|T,R=Xt()|0|R;while(ue>>>0<Se>>>0)}}else T=0,R=0;if(Se=Bo(T|0,R|0,F|0,C|0)|0,Xt()|0,ue=s+(Se<<3)|0,Xe=ue,bt=o[Xe>>2]|0,Xe=o[Xe+4>>2]|0,!((bt|0)==0&(Xe|0)==0))for(Qt=0;;){if((Qt|0)>(F|0)){l=41;break e}if((bt|0)==(T|0)&(Xe&-117440513|0)==(R|0)){ri=Mi(bt|0,Xe|0,56)|0,Xt()|0,ri=ri&7,Ht=ri+1|0,d=Mi(bt|0,Xe|0,45)|0,Xt()|0;i:do if(!(G(d&127)|0))Xe=7;else{if(bt=Mi(bt|0,Xe|0,52)|0,Xt()|0,bt=bt&15,!bt){Xe=6;break}for(Xe=1;;){if(d=zi(7,0,(15-Xe|0)*3|0)|0,!((d&T|0)==0&((Xt()|0)&R|0)==0)){Xe=7;break i}if(Xe>>>0<bt>>>0)Xe=Xe+1|0;else{Xe=6;break}}}while(!1);if((ri+2|0)>>>0>Xe>>>0){l=51;break e}d=zi(Ht|0,0,56)|0,R=Xt()|0|R&-117440513,Ht=ue,o[Ht>>2]=0,o[Ht+4>>2]=0,T=d|T}else Se=(Se+1|0)%(F|0)|0;if(ue=s+(Se<<3)|0,Xe=ue,bt=o[Xe>>2]|0,Xe=o[Xe+4>>2]|0,(bt|0)==0&(Xe|0)==0)break;Qt=Qt+1|0}d=ue,o[d>>2]=T,o[d+4>>2]=R}if(te=te+1|0,(te|0)>=(F|0))break t;R=r+(te<<3)|0,T=o[R>>2]|0,R=o[R+4>>2]|0}}while(!1);if((F+5|0)>>>0<11){l=99;break}if(A=il((F|0)/6|0,8)|0,!A){l=58;break}t:do if(O){Qt=0,Ht=0;do{if(Se=s+(Qt<<3)|0,T=Se,te=o[T>>2]|0,T=o[T+4>>2]|0,!((te|0)==0&(T|0)==0)){Xe=Mi(te|0,T|0,56)|0,Xt()|0,Xe=Xe&7,R=Xe+1|0,bt=T&-117440513,d=Mi(te|0,T|0,45)|0,Xt()|0;i:do if(G(d&127)|0){if(ri=Mi(te|0,T|0,52)|0,Xt()|0,ri=ri&15,ri|0)for(ue=1;;){if(d=zi(7,0,(15-ue|0)*3|0)|0,!((te&d|0)==0&(bt&(Xt()|0)|0)==0))break i;if(ue>>>0<ri>>>0)ue=ue+1|0;else break}T=zi(R|0,0,56)|0,te=T|te,T=Xt()|0|bt,R=Se,o[R>>2]=te,o[R+4>>2]=T,R=Xe+2|0}while(!1);(R|0)==7&&(d=A+(Ht<<3)|0,o[d>>2]=te,o[d+4>>2]=T&-117440513,Ht=Ht+1|0)}Qt=Qt+1|0}while((Qt|0)!=(F|0));if(O){if(Q=((F|0)<0)<<31>>31,ri=zi(x|0,0,52)|0,Qt=Xt()|0,x>>>0>15)for(T=0,te=0;;){do if(!((kt|0)==0&(le|0)==0)){for(Xe=Mi(kt|0,le|0,52)|0,Xt()|0,Xe=Xe&15,ue=(Xe|0)<(x|0),Xe=(Xe|0)==(x|0),Se=ue?0:Xe?kt:0,Xe=ue?0:Xe?le:0,ue=Bo(Se|0,Xe|0,F|0,Q|0)|0,Xt()|0,R=0;;){if((R|0)>(F|0)){l=98;break e}if(d=s+(ue<<3)|0,bt=o[d+4>>2]|0,(bt&-117440513|0)==(Xe|0)&&(o[d>>2]|0)==(Se|0)){l=70;break}if(ue=(ue+1|0)%(F|0)|0,d=s+(ue<<3)|0,(o[d>>2]|0)==(Se|0)&&(o[d+4>>2]|0)==(Xe|0))break;R=R+1|0}if((l|0)==70&&(l=0,!0&(bt&117440512|0)==100663296))break;d=L+(te<<3)|0,o[d>>2]=kt,o[d+4>>2]=le,te=te+1|0}while(!1);if(T=T+1|0,(T|0)>=(F|0)){F=Ht;break t}le=r+(T<<3)|0,kt=o[le>>2]|0,le=o[le+4>>2]|0}for(T=0,te=0;;){do if(!((kt|0)==0&(le|0)==0)){if(Xe=Mi(kt|0,le|0,52)|0,Xt()|0,Xe=Xe&15,(Xe|0)>=(x|0))if((Xe|0)!=(x|0))if(R=kt|ri,ue=le&-15728641|Qt,Xe>>>0<V>>>0)Xe=ue;else{Se=x;do d=zi(7,0,(14-Se|0)*3|0)|0,Se=Se+1|0,R=d|R,ue=Xt()|0|ue;while(Se>>>0<Xe>>>0);Xe=ue}else R=kt,Xe=le;else R=0,Xe=0;for(Se=Bo(R|0,Xe|0,F|0,Q|0)|0,Xt()|0,ue=0;;){if((ue|0)>(F|0)){l=98;break e}if(d=s+(Se<<3)|0,bt=o[d+4>>2]|0,(bt&-117440513|0)==(Xe|0)&&(o[d>>2]|0)==(R|0)){l=93;break}if(Se=(Se+1|0)%(F|0)|0,d=s+(Se<<3)|0,(o[d>>2]|0)==(R|0)&&(o[d+4>>2]|0)==(Xe|0))break;ue=ue+1|0}if((l|0)==93&&(l=0,!0&(bt&117440512|0)==100663296))break;d=L+(te<<3)|0,o[d>>2]=kt,o[d+4>>2]=le,te=te+1|0}while(!1);if(T=T+1|0,(T|0)>=(F|0)){F=Ht;break t}le=r+(T<<3)|0,kt=o[le>>2]|0,le=o[le+4>>2]|0}}else te=0,F=Ht}else te=0,F=0;while(!1);if(ms(s|0,0,i|0)|0,Uo(r|0,A|0,F<<3|0)|0,ir(A),F)L=L+(te<<3)|0;else break}return(l|0)==41?(ir(r),ir(s),d=-1,d|0):(l|0)==51?(ir(r),ir(s),d=-2,d|0):(l|0)==58?(ir(r),ir(s),d=-3,d|0):(l|0)==98?(ir(A),ir(r),ir(s),d=-1,d|0):((l|0)==99&&Uo(L|0,r|0,F<<3|0)|0,ir(r),ir(s),d=0,d|0)}function Lo(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0;if((L|0)<=0)return te=0,te|0;if((te|0)>=16){for(ue=0;;){if(kt=T+(ue<<3)|0,!((o[kt>>2]|0)==0&(o[kt+4>>2]|0)==0)){ue=14;break}if(ue=ue+1|0,(ue|0)>=(L|0)){le=0,ue=16;break}}if((ue|0)==14)return((F|0)>0?-2:-1)|0;if((ue|0)==16)return le|0}ue=0,kt=0;e:for(;;){bt=T+(kt<<3)|0,Se=bt,le=o[Se>>2]|0,Se=o[Se+4>>2]|0;do if(!((le|0)==0&(Se|0)==0)){if((ue|0)>=(F|0)){le=-1,ue=16;break e}if(Xe=Mi(le|0,Se|0,52)|0,Xt()|0,Xe=Xe&15,(Xe|0)>(te|0)){le=-2,ue=16;break e}if((Xe|0)==(te|0)){bt=R+(ue<<3)|0,o[bt>>2]=le,o[bt+4>>2]=Se,ue=ue+1|0;break}if(le=(wo(7,te-Xe|0)|0)+ue|0,(le|0)>(F|0)){le=-1,ue=16;break e}Jr(o[bt>>2]|0,o[bt+4>>2]|0,te,R+(ue<<3)|0),ue=le}while(!1);if(kt=kt+1|0,(kt|0)>=(L|0)){le=0,ue=16;break}}return(ue|0)==16?le|0:0}function Dl(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0;if((L|0)<=0)return R=0,R|0;if((R|0)>=16){for(F=0;;){if(le=T+(F<<3)|0,!((o[le>>2]|0)==0&(o[le+4>>2]|0)==0)){F=-1,te=13;break}if(F=F+1|0,(F|0)>=(L|0)){F=0,te=13;break}}if((te|0)==13)return F|0}F=0,le=0;e:for(;;){te=T+(le<<3)|0,ue=o[te>>2]|0,te=o[te+4>>2]|0;do if(!((ue|0)==0&(te|0)==0)){if(te=Mi(ue|0,te|0,52)|0,Xt()|0,te=te&15,(te|0)>(R|0)){F=-1,te=13;break e}if((te|0)==(R|0)){F=F+1|0;break}else{F=(wo(7,R-te|0)|0)+F|0;break}}while(!1);if(le=le+1|0,(le|0)>=(L|0)){te=13;break}}return(te|0)==13?F|0:0}function vo(T,L){return T=T|0,L=L|0,L=Mi(T|0,L|0,52)|0,Xt()|0,L&1|0}function sa(T,L){T=T|0,L=L|0;var R=0,F=0,te=0;if(te=Mi(T|0,L|0,52)|0,Xt()|0,te=te&15,!te)return te=0,te|0;for(F=1;;){if(R=Mi(T|0,L|0,(15-F|0)*3|0)|0,Xt()|0,R=R&7,R|0){F=5;break}if(F>>>0<te>>>0)F=F+1|0;else{R=0,F=5;break}}return(F|0)==5?R|0:0}function Ws(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0;if(Xe=Mi(T|0,L|0,52)|0,Xt()|0,Xe=Xe&15,!Xe)return Se=L,Xe=T,Gn(Se|0),Xe|0;for(Se=1,R=0;;){ue=(15-Se|0)*3|0,F=zi(7,0,ue|0)|0,te=Xt()|0,le=Mi(T|0,L|0,ue|0)|0,Xt()|0,ue=zi(ma(le&7)|0,0,ue|0)|0,le=Xt()|0,T=ue|T&~F,L=le|L&~te;e:do if(!R)if((ue&F|0)==0&(le&te|0)==0)R=0;else if(F=Mi(T|0,L|0,52)|0,Xt()|0,F=F&15,!F)R=1;else{R=1;t:for(;;){switch(le=Mi(T|0,L|0,(15-R|0)*3|0)|0,Xt()|0,le&7){case 1:break t;case 0:break;default:{R=1;break e}}if(R>>>0<F>>>0)R=R+1|0;else{R=1;break e}}for(R=1;;)if(le=(15-R|0)*3|0,te=Mi(T|0,L|0,le|0)|0,Xt()|0,ue=zi(7,0,le|0)|0,L=L&~(Xt()|0),le=zi(ma(te&7)|0,0,le|0)|0,T=T&~ue|le,L=L|(Xt()|0),R>>>0<F>>>0)R=R+1|0;else{R=1;break}}while(!1);if(Se>>>0<Xe>>>0)Se=Se+1|0;else break}return Gn(L|0),T|0}function io(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0;if(F=Mi(T|0,L|0,52)|0,Xt()|0,F=F&15,!F)return R=L,F=T,Gn(R|0),F|0;for(R=1;ue=(15-R|0)*3|0,le=Mi(T|0,L|0,ue|0)|0,Xt()|0,te=zi(7,0,ue|0)|0,L=L&~(Xt()|0),ue=zi(ma(le&7)|0,0,ue|0)|0,T=ue|T&~te,L=Xt()|0|L,R>>>0<F>>>0;)R=R+1|0;return Gn(L|0),T|0}function el(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0;if(Xe=Mi(T|0,L|0,52)|0,Xt()|0,Xe=Xe&15,!Xe)return Se=L,Xe=T,Gn(Se|0),Xe|0;for(Se=1,R=0;;){ue=(15-Se|0)*3|0,F=zi(7,0,ue|0)|0,te=Xt()|0,le=Mi(T|0,L|0,ue|0)|0,Xt()|0,ue=zi(na(le&7)|0,0,ue|0)|0,le=Xt()|0,T=ue|T&~F,L=le|L&~te;e:do if(!R)if((ue&F|0)==0&(le&te|0)==0)R=0;else if(F=Mi(T|0,L|0,52)|0,Xt()|0,F=F&15,!F)R=1;else{R=1;t:for(;;){switch(le=Mi(T|0,L|0,(15-R|0)*3|0)|0,Xt()|0,le&7){case 1:break t;case 0:break;default:{R=1;break e}}if(R>>>0<F>>>0)R=R+1|0;else{R=1;break e}}for(R=1;;)if(te=(15-R|0)*3|0,ue=zi(7,0,te|0)|0,le=L&~(Xt()|0),L=Mi(T|0,L|0,te|0)|0,Xt()|0,L=zi(na(L&7)|0,0,te|0)|0,T=T&~ue|L,L=le|(Xt()|0),R>>>0<F>>>0)R=R+1|0;else{R=1;break}}while(!1);if(Se>>>0<Xe>>>0)Se=Se+1|0;else break}return Gn(L|0),T|0}function ns(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0;if(F=Mi(T|0,L|0,52)|0,Xt()|0,F=F&15,!F)return R=L,F=T,Gn(R|0),F|0;for(R=1;le=(15-R|0)*3|0,ue=zi(7,0,le|0)|0,te=L&~(Xt()|0),L=Mi(T|0,L|0,le|0)|0,Xt()|0,L=zi(na(L&7)|0,0,le|0)|0,T=L|T&~ue,L=Xt()|0|te,R>>>0<F>>>0;)R=R+1|0;return Gn(L|0),T|0}function vr(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0;if(Xe=Gt,Gt=Gt+64|0,Se=Xe+40|0,F=Xe+24|0,te=Xe+12|0,ue=Xe,zi(L|0,0,52)|0,R=Xt()|0|134225919,!L)return(o[T+4>>2]|0)>2||(o[T+8>>2]|0)>2||(o[T+12>>2]|0)>2?(le=0,Se=0,Gn(le|0),Gt=Xe,Se|0):(zi(at(T)|0,0,45)|0,le=Xt()|0|R,Se=-1,Gn(le|0),Gt=Xe,Se|0);if(o[Se>>2]=o[T>>2],o[Se+4>>2]=o[T+4>>2],o[Se+8>>2]=o[T+8>>2],o[Se+12>>2]=o[T+12>>2],le=Se+4|0,(L|0)>0)for(T=-1;o[F>>2]=o[le>>2],o[F+4>>2]=o[le+4>>2],o[F+8>>2]=o[le+8>>2],L&1?(Nr(le),o[te>>2]=o[le>>2],o[te+4>>2]=o[le+4>>2],o[te+8>>2]=o[le+8>>2],Qo(te)):(ko(le),o[te>>2]=o[le>>2],o[te+4>>2]=o[le+4>>2],o[te+8>>2]=o[le+8>>2],Ns(te)),Ys(F,te,ue),sr(ue),kt=(15-L|0)*3|0,bt=zi(7,0,kt|0)|0,R=R&~(Xt()|0),kt=zi(ra(ue)|0,0,kt|0)|0,T=kt|T&~bt,R=Xt()|0|R,(L|0)>1;)L=L+-1|0;else T=-1;e:do if((o[le>>2]|0)<=2&&(o[Se+8>>2]|0)<=2&&(o[Se+12>>2]|0)<=2){if(F=at(Se)|0,L=zi(F|0,0,45)|0,L=L|T,T=Xt()|0|R&-1040385,ue=Ct(Se)|0,!(G(F)|0)){if((ue|0)<=0)break;for(te=0;;){if(F=Mi(L|0,T|0,52)|0,Xt()|0,F=F&15,F)for(R=1;kt=(15-R|0)*3|0,Se=Mi(L|0,T|0,kt|0)|0,Xt()|0,bt=zi(7,0,kt|0)|0,T=T&~(Xt()|0),kt=zi(ma(Se&7)|0,0,kt|0)|0,L=L&~bt|kt,T=T|(Xt()|0),R>>>0<F>>>0;)R=R+1|0;if(te=te+1|0,(te|0)==(ue|0))break e}}te=Mi(L|0,T|0,52)|0,Xt()|0,te=te&15;t:do if(te){R=1;i:for(;;){switch(kt=Mi(L|0,T|0,(15-R|0)*3|0)|0,Xt()|0,kt&7){case 1:break i;case 0:break;default:break t}if(R>>>0<te>>>0)R=R+1|0;else break t}if(Li(F,o[Se>>2]|0)|0)for(R=1;Se=(15-R|0)*3|0,bt=zi(7,0,Se|0)|0,kt=T&~(Xt()|0),T=Mi(L|0,T|0,Se|0)|0,Xt()|0,T=zi(na(T&7)|0,0,Se|0)|0,L=L&~bt|T,T=kt|(Xt()|0),R>>>0<te>>>0;)R=R+1|0;else for(R=1;kt=(15-R|0)*3|0,Se=Mi(L|0,T|0,kt|0)|0,Xt()|0,bt=zi(7,0,kt|0)|0,T=T&~(Xt()|0),kt=zi(ma(Se&7)|0,0,kt|0)|0,L=L&~bt|kt,T=T|(Xt()|0),R>>>0<te>>>0;)R=R+1|0}while(!1);if((ue|0)>0){R=0;do L=Ws(L,T)|0,T=Xt()|0,R=R+1|0;while((R|0)!=(ue|0))}}else L=0,T=0;while(!1);return bt=T,kt=L,Gn(bt|0),Gt=Xe,kt|0}function Hr(T){return T=T|0,(T|0)%2|0|0}function ga(T,L){T=T|0,L=L|0;var R=0,F=0;return F=Gt,Gt=Gt+16|0,R=F,L>>>0<=15&&(o[T+4>>2]&2146435072|0)!=2146435072&&(o[T+8+4>>2]&2146435072|0)!=2146435072?(lc(T,L,R),L=vr(R,L)|0,T=Xt()|0):(T=0,L=0),Gn(T|0),Gt=F,L|0}function xo(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0;if(te=R+4|0,ue=Mi(T|0,L|0,52)|0,Xt()|0,ue=ue&15,le=Mi(T|0,L|0,45)|0,Xt()|0,F=(ue|0)==0,G(le&127)|0){if(F)return le=1,le|0;F=1}else{if(F)return le=0,le|0;!(o[te>>2]|0)&&!(o[R+8>>2]|0)?F=(o[R+12>>2]|0)!=0&1:F=1}for(R=1;R&1?Qo(te):Ns(te),le=Mi(T|0,L|0,(15-R|0)*3|0)|0,Xt()|0,Tl(te,le&7),R>>>0<ue>>>0;)R=R+1|0;return F|0}function aa(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0;kt=Gt,Gt=Gt+16|0,Xe=kt,bt=Mi(T|0,L|0,45)|0,Xt()|0,bt=bt&127;e:do if(G(bt)|0&&(ue=Mi(T|0,L|0,52)|0,Xt()|0,ue=ue&15,(ue|0)!=0)){F=1;t:for(;;){switch(Se=Mi(T|0,L|0,(15-F|0)*3|0)|0,Xt()|0,Se&7){case 5:break t;case 0:break;default:{F=L;break e}}if(F>>>0<ue>>>0)F=F+1|0;else{F=L;break e}}for(te=1,F=L;L=(15-te|0)*3|0,le=zi(7,0,L|0)|0,Se=F&~(Xt()|0),F=Mi(T|0,F|0,L|0)|0,Xt()|0,F=zi(na(F&7)|0,0,L|0)|0,T=T&~le|F,F=Se|(Xt()|0),te>>>0<ue>>>0;)te=te+1|0}else F=L;while(!1);if(Se=7728+(bt*28|0)|0,o[R>>2]=o[Se>>2],o[R+4>>2]=o[Se+4>>2],o[R+8>>2]=o[Se+8>>2],o[R+12>>2]=o[Se+12>>2],!(xo(T,F,R)|0)){Gt=kt;return}if(le=R+4|0,o[Xe>>2]=o[le>>2],o[Xe+4>>2]=o[le+4>>2],o[Xe+8>>2]=o[le+8>>2],ue=Mi(T|0,F|0,52)|0,Xt()|0,Se=ue&15,ue&1?(Ns(le),ue=Se+1|0):ue=Se,!(G(bt)|0))F=0;else{e:do if(!Se)F=0;else for(L=1;;){if(te=Mi(T|0,F|0,(15-L|0)*3|0)|0,Xt()|0,te=te&7,te|0){F=te;break e}if(L>>>0<Se>>>0)L=L+1|0;else{F=0;break}}while(!1);F=(F|0)==4&1}if(!(Mo(R,ue,F,0)|0))(ue|0)!=(Se|0)&&(o[le>>2]=o[Xe>>2],o[le+4>>2]=o[Xe+4>>2],o[le+8>>2]=o[Xe+8>>2]);else{if(G(bt)|0)do;while(Mo(R,ue,0,0)|0);(ue|0)!=(Se|0)&&ko(le)}Gt=kt}function Ma(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;F=Gt,Gt=Gt+16|0,te=F,aa(T,L,te),L=Mi(T|0,L|0,52)|0,Xt()|0,Xl(te,L&15,R),Gt=F}function Oa(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0;le=Gt,Gt=Gt+16|0,ue=le,aa(T,L,ue),F=Mi(T|0,L|0,45)|0,Xt()|0,F=(G(F&127)|0)==0,te=Mi(T|0,L|0,52)|0,Xt()|0,te=te&15;e:do if(!F){if(te|0)for(F=1;;){if(Se=zi(7,0,(15-F|0)*3|0)|0,!((Se&T|0)==0&((Xt()|0)&L|0)==0))break e;if(F>>>0<te>>>0)F=F+1|0;else break}No(ue,te,0,5,R),Gt=le;return}while(!1);Xo(ue,te,0,6,R),Gt=le}function no(T,L){T=T|0,L=L|0;var R=0,F=0,te=0;if(F=Mi(T|0,L|0,45)|0,Xt()|0,!(G(F&127)|0))return F=2,F|0;if(F=Mi(T|0,L|0,52)|0,Xt()|0,F=F&15,!F)return F=5,F|0;for(R=1;;){if(te=zi(7,0,(15-R|0)*3|0)|0,!((te&T|0)==0&((Xt()|0)&L|0)==0)){R=2,T=6;break}if(R>>>0<F>>>0)R=R+1|0;else{R=5,T=6;break}}return(T|0)==6?R|0:0}function hl(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0;ri=Gt,Gt=Gt+128|0,bt=ri+112|0,ue=ri+96|0,kt=ri,te=Mi(T|0,L|0,52)|0,Xt()|0,Se=te&15,o[bt>>2]=Se,le=Mi(T|0,L|0,45)|0,Xt()|0,le=le&127;e:do if(G(le)|0){if(Se|0)for(F=1;;){if(Xe=zi(7,0,(15-F|0)*3|0)|0,!((Xe&T|0)==0&((Xt()|0)&L|0)==0)){te=0;break e}if(F>>>0<Se>>>0)F=F+1|0;else break}if(te&1)te=1;else{Xe=zi(Se+1|0,0,52)|0,kt=Xt()|0|L&-15728641,bt=zi(7,0,(14-Se|0)*3|0)|0,hl((Xe|T)&~bt,kt&~(Xt()|0),R),Gt=ri;return}}else te=0;while(!1);aa(T,L,ue),te?($o(ue,bt,kt),Xe=5):(Yo(ue,bt,kt),Xe=6);e:do if(G(le)|0)if(!Se)F=20;else for(F=1;;){if(le=zi(7,0,(15-F|0)*3|0)|0,!((le&T|0)==0&((Xt()|0)&L|0)==0)){F=8;break e}if(F>>>0<Se>>>0)F=F+1|0;else{F=20;break}}else F=8;while(!1);if(ms(R|0,-1,F|0)|0,te){te=0;do{for(ue=kt+(te<<4)|0,Qs(ue,o[bt>>2]|0)|0,ue=o[ue>>2]|0,F=0;le=R+(F<<2)|0,Se=o[le>>2]|0,!((Se|0)==-1|(Se|0)==(ue|0));)F=F+1|0;o[le>>2]=ue,te=te+1|0}while((te|0)!=(Xe|0))}else{te=0;do{for(ue=kt+(te<<4)|0,Mo(ue,o[bt>>2]|0,0,1)|0,ue=o[ue>>2]|0,F=0;le=R+(F<<2)|0,Se=o[le>>2]|0,!((Se|0)==-1|(Se|0)==(ue|0));)F=F+1|0;o[le>>2]=ue,te=te+1|0}while((te|0)!=(Xe|0))}Gt=ri}function cu(){return 12}function _l(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0;if(zi(T|0,0,52)|0,Se=Xt()|0|134225919,(T|0)<1){F=0,R=0;do G(F)|0&&(zi(F|0,0,45)|0,le=Se|(Xt()|0),T=L+(R<<3)|0,o[T>>2]=-1,o[T+4>>2]=le,R=R+1|0),F=F+1|0;while((F|0)!=122);return}le=0,R=0;do{if(G(le)|0){for(zi(le|0,0,45)|0,F=1,te=-1,ue=Se|(Xt()|0);Xe=zi(7,0,(15-F|0)*3|0)|0,te=te&~Xe,ue=ue&~(Xt()|0),(F|0)!=(T|0);)F=F+1|0;Xe=L+(R<<3)|0,o[Xe>>2]=te,o[Xe+4>>2]=ue,R=R+1|0}le=le+1|0}while((le|0)!=122)}function ho(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0,bt=0;if(Se=Gt,Gt=Gt+64|0,le=Se,(T|0)==(R|0)&(L|0)==(F|0)|(!1|(L&2013265920|0)!=134217728|(!1|(F&2013265920|0)!=134217728))||(te=Mi(T|0,L|0,52)|0,Xt()|0,te=te&15,ue=Mi(R|0,F|0,52)|0,Xt()|0,(te|0)!=(ue&15|0)))return le=0,Gt=Se,le|0;if(ue=te+-1|0,te>>>0>1&&(bt=Do(T,L,ue)|0,Xe=Xt()|0,ue=Do(R,F,ue)|0,(bt|0)==(ue|0)&(Xe|0)==(Xt()|0))&&(ue=(te^15)*3|0,te=Mi(T|0,L|0,ue|0)|0,Xt()|0,te=te&7,ue=Mi(R|0,F|0,ue|0)|0,Xt()|0,ue=ue&7,(te|0)==0|(ue|0)==0||(o[21136+(te<<2)>>2]|0)==(ue|0)||(o[21168+(te<<2)>>2]|0)==(ue|0)))return bt=1,Gt=Se,bt|0;te=le,ue=te+56|0;do o[te>>2]=0,te=te+4|0;while((te|0)<(ue|0));return Za(T,L,1,le),bt=le,!((o[bt>>2]|0)==(R|0)&&(o[bt+4>>2]|0)==(F|0))&&(bt=le+8|0,!((o[bt>>2]|0)==(R|0)&&(o[bt+4>>2]|0)==(F|0)))&&(bt=le+16|0,!((o[bt>>2]|0)==(R|0)&&(o[bt+4>>2]|0)==(F|0)))&&(bt=le+24|0,!((o[bt>>2]|0)==(R|0)&&(o[bt+4>>2]|0)==(F|0)))&&(bt=le+32|0,!((o[bt>>2]|0)==(R|0)&&(o[bt+4>>2]|0)==(F|0)))&&(bt=le+40|0,!((o[bt>>2]|0)==(R|0)&&(o[bt+4>>2]|0)==(F|0)))?(te=le+48|0,te=((o[te>>2]|0)==(R|0)?(o[te+4>>2]|0)==(F|0):0)&1):te=1,bt=te,Gt=Se,bt|0}function mi(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0;if(bt=Gt,Gt=Gt+16|0,le=bt,!(ho(T,L,R,F)|0))return Se=0,Xe=0,Gn(Se|0),Gt=bt,Xe|0;for(Se=L&-2130706433,te=(gs(T,L)|0)==0,te=te?1:2;o[le>>2]=0,kt=Qn(T,L,te,le)|0,ue=te+1|0,!((kt|0)==(R|0)&(Xt()|0)==(F|0));)if(ue>>>0<7)te=ue;else{te=0,T=0,Xe=6;break}return(Xe|0)==6?(Gn(te|0),Gt=bt,T|0):(kt=zi(te|0,0,56)|0,Xe=Se|(Xt()|0)|268435456,kt=T|kt,Gn(Xe|0),Gt=bt,kt|0)}function qi(T,L){T=T|0,L=L|0;var R=0;return R=!0&(L&2013265920|0)==268435456,Gn((R?L&-2130706433|134217728:0)|0),(R?T:0)|0}function Di(T,L){T=T|0,L=L|0;var R=0,F=0,te=0;return F=Gt,Gt=Gt+16|0,R=F,!0&(L&2013265920|0)==268435456?(te=Mi(T|0,L|0,56)|0,Xt()|0,o[R>>2]=0,R=Qn(T,L&-2130706433|134217728,te&7,R)|0,L=Xt()|0,Gn(L|0),Gt=F,R|0):(L=0,R=0,Gn(L|0),Gt=F,R|0)}function Nt(T,L){T=T|0,L=L|0;var R=0;if(!(!0&(L&2013265920|0)==268435456))return R=0,R|0;switch(R=Mi(T|0,L|0,56)|0,Xt()|0,R&7){case 0:case 7:return R=0,R|0}return R=L&-2130706433|134217728,!0&(L&117440512|0)==16777216&(gs(T,R)|0)!=0?(R=0,R|0):(R=is(T,R)|0,R|0)}function ni(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0;ue=Gt,Gt=Gt+16|0,F=ue,le=!0&(L&2013265920|0)==268435456,te=L&-2130706433|134217728,Se=R,o[Se>>2]=le?T:0,o[Se+4>>2]=le?te:0,le?(L=Mi(T|0,L|0,56)|0,Xt()|0,o[F>>2]=0,T=Qn(T,te,L&7,F)|0,L=Xt()|0):(T=0,L=0),Se=R+8|0,o[Se>>2]=T,o[Se+4>>2]=L,Gt=ue}function wi(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;te=(gs(T,L)|0)==0,L=L&-2130706433,F=R,o[F>>2]=te?T:0,o[F+4>>2]=te?L|285212672:0,F=R+8|0,o[F>>2]=T,o[F+4>>2]=L|301989888,F=R+16|0,o[F>>2]=T,o[F+4>>2]=L|318767104,F=R+24|0,o[F>>2]=T,o[F+4>>2]=L|335544320,F=R+32|0,o[F>>2]=T,o[F+4>>2]=L|352321536,R=R+40|0,o[R>>2]=T,o[R+4>>2]=L|369098752}function Ui(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0;if(le=Gt,Gt=Gt+16|0,ue=le,F=Mi(T|0,L|0,56)|0,Xt()|0,Se=!0&(L&2013265920|0)==268435456,te=Se?T:0,T=Se?L&-2130706433|134217728:0,L=Kl(te,T,F&7)|0,(L|0)==-1){o[R>>2]=0,Gt=le;return}aa(te,T,ue),F=Mi(te|0,T|0,52)|0,Xt()|0,F=F&15,gs(te,T)|0?No(ue,F,L,2,R):Xo(ue,F,L,2,R),Gt=le}function On(T){T=T|0;var L=0,R=0,F=0;return L=il(1,12)|0,L||en(22691,22646,49,22704),R=T+4|0,F=o[R>>2]|0,F|0?(F=F+8|0,o[F>>2]=L,o[R>>2]=L,L|0):(o[T>>2]|0&&en(22721,22646,61,22744),F=T,o[F>>2]=L,o[R>>2]=L,L|0)}function jn(T,L){T=T|0,L=L|0;var R=0,F=0;return F=Zn(24)|0,F||en(22758,22646,78,22772),o[F>>2]=o[L>>2],o[F+4>>2]=o[L+4>>2],o[F+8>>2]=o[L+8>>2],o[F+12>>2]=o[L+12>>2],o[F+16>>2]=0,L=T+4|0,R=o[L>>2]|0,R|0?(o[R+16>>2]=F,o[L>>2]=F,F|0):(o[T>>2]|0&&en(22787,22646,82,22772),o[T>>2]=F,o[L>>2]=F,F|0)}function cr(T){T=T|0;var L=0,R=0,F=0,te=0;if(T)for(F=1;;){if(L=o[T>>2]|0,L|0)do{if(R=o[L>>2]|0,R|0)do te=R,R=o[R+16>>2]|0,ir(te);while(R|0);te=L,L=o[L+8>>2]|0,ir(te)}while(L|0);if(L=T,T=o[T+8>>2]|0,F||ir(L),T)F=0;else break}}function Jn(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0,l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0;if(te=T+8|0,o[te>>2]|0)return Ie=1,Ie|0;if(F=o[T>>2]|0,!F)return Ie=0,Ie|0;L=F,R=0;do R=R+1|0,L=o[L+8>>2]|0;while(L|0);if(R>>>0<2)return Ie=0,Ie|0;Y=Zn(R<<2)|0,Y||en(22807,22646,317,22826),Z=Zn(R<<5)|0,Z||en(22848,22646,321,22826),o[T>>2]=0,r=T+4|0,o[r>>2]=0,o[te>>2]=0,R=0,z=0,i=0,ri=0;e:for(;;){if(kt=o[F>>2]|0,kt){ue=0,le=kt;do{if(Xe=+Me[le+8>>3],L=le,le=o[le+16>>2]|0,bt=(le|0)==0,te=bt?kt:le,Se=+Me[te+8>>3],+fi(+(Xe-Se))>3.141592653589793){Ie=14;break}ue=ue+(Se-Xe)*(+Me[L>>3]+ +Me[te>>3])}while(!bt);if((Ie|0)==14){Ie=0,ue=0,L=kt;do s=+Me[L+8>>3],k=L+16|0,I=o[k>>2]|0,I=I|0?I:kt,x=+Me[I+8>>3],ue=ue+(+Me[L>>3]+ +Me[I>>3])*((x<0?x+6.283185307179586:x)-(s<0?s+6.283185307179586:s)),L=o[(L|0?k:F)>>2]|0;while(L|0)}ue>0?(o[Y+(z<<2)>>2]=F,z=z+1|0,te=i,L=ri):Ie=19}else Ie=19;if((Ie|0)==19){Ie=0;do if(R){if(L=R+8|0,o[L>>2]|0){Ie=21;break e}if(R=il(1,12)|0,!R){Ie=23;break e}o[L>>2]=R,te=R+4|0,le=R,L=ri}else if(ri){te=r,le=ri+8|0,L=F,R=T;break}else if(o[T>>2]|0){Ie=27;break e}else{te=r,le=T,L=F,R=T;break}while(!1);if(o[le>>2]=F,o[te>>2]=F,le=Z+(i<<5)|0,bt=o[F>>2]|0,bt){for(kt=Z+(i<<5)+8|0,Me[kt>>3]=17976931348623157e292,ri=Z+(i<<5)+24|0,Me[ri>>3]=17976931348623157e292,Me[le>>3]=-17976931348623157e292,Ht=Z+(i<<5)+16|0,Me[Ht>>3]=-17976931348623157e292,O=17976931348623157e292,V=-17976931348623157e292,te=0,Qt=bt,Xe=17976931348623157e292,A=17976931348623157e292,C=-17976931348623157e292,Se=-17976931348623157e292;ue=+Me[Qt>>3],s=+Me[Qt+8>>3],Qt=o[Qt+16>>2]|0,Q=(Qt|0)==0,x=+Me[(Q?bt:Qt)+8>>3],ue<Xe&&(Me[kt>>3]=ue,Xe=ue),s<A&&(Me[ri>>3]=s,A=s),ue>C?Me[le>>3]=ue:ue=C,s>Se&&(Me[Ht>>3]=s,Se=s),O=s>0&s<O?s:O,V=s<0&s>V?s:V,te=te|+fi(+(s-x))>3.141592653589793,!Q;)C=ue;te&&(Me[Ht>>3]=V,Me[ri>>3]=O)}else o[le>>2]=0,o[le+4>>2]=0,o[le+8>>2]=0,o[le+12>>2]=0,o[le+16>>2]=0,o[le+20>>2]=0,o[le+24>>2]=0,o[le+28>>2]=0;te=i+1|0}if(k=F+8|0,F=o[k>>2]|0,o[k>>2]=0,F)i=te,ri=L;else{Ie=45;break}}if((Ie|0)==21)en(22624,22646,35,22658);else if((Ie|0)==23)en(22678,22646,37,22658);else if((Ie|0)==27)en(22721,22646,61,22744);else if((Ie|0)==45){e:do if((z|0)>0){for(k=(te|0)==0,y=te<<2,I=(T|0)==0,d=0,L=0;;){if(l=o[Y+(d<<2)>>2]|0,k)Ie=73;else{if(i=Zn(y)|0,!i){Ie=50;break}if(r=Zn(y)|0,!r){Ie=52;break}t:do if(I)R=0;else{for(te=0,R=0,le=T;F=Z+(te<<5)|0,$s(o[le>>2]|0,F,o[l>>2]|0)|0?(o[i+(R<<2)>>2]=le,o[r+(R<<2)>>2]=F,Q=R+1|0):Q=R,le=o[le+8>>2]|0,le;)te=te+1|0,R=Q;if((Q|0)>0)if(F=o[i>>2]|0,(Q|0)==1)R=F;else for(Ht=0,Qt=-1,R=F,ri=F;;){for(bt=o[ri>>2]|0,F=0,le=0;te=o[o[i+(le<<2)>>2]>>2]|0,(te|0)==(bt|0)?kt=F:kt=F+(($s(te,o[r+(le<<2)>>2]|0,o[bt>>2]|0)|0)&1)|0,le=le+1|0,(le|0)!=(Q|0);)F=kt;if(te=(kt|0)>(Qt|0),R=te?ri:R,F=Ht+1|0,(F|0)==(Q|0))break t;Ht=F,Qt=te?kt:Qt,ri=o[i+(F<<2)>>2]|0}else R=0}while(!1);if(ir(i),ir(r),R){if(te=R+4|0,F=o[te>>2]|0,F)R=F+8|0;else if(o[R>>2]|0){Ie=70;break}o[R>>2]=l,o[te>>2]=l}else Ie=73}if((Ie|0)==73){if(Ie=0,L=o[l>>2]|0,L|0)do r=L,L=o[L+16>>2]|0,ir(r);while(L|0);ir(l),L=2}if(d=d+1|0,(d|0)>=(z|0)){Ae=L;break e}}(Ie|0)==50?en(22863,22646,249,22882):(Ie|0)==52?en(22901,22646,252,22882):(Ie|0)==70&&en(22721,22646,61,22744)}else Ae=0;while(!1);return ir(Y),ir(Z),Ie=Ae,Ie|0}return 0}function $s(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0;if(!(Xa(L,R)|0)||(L=qr(L)|0,bt=+Me[R>>3],F=+Me[R+8>>3],F=L&F<0?F+6.283185307179586:F,T=o[T>>2]|0,!T))return T=0,T|0;if(L){L=0,R=T;e:for(;;){for(;le=+Me[R>>3],Xe=+Me[R+8>>3],R=R+16|0,kt=o[R>>2]|0,kt=kt|0?kt:T,ue=+Me[kt>>3],te=+Me[kt+8>>3],le>ue?(Se=le,le=Xe):(Se=ue,ue=le,le=te,te=Xe),!!(bt<ue|bt>Se);)if(R=o[R>>2]|0,!R){R=22;break e}if(Xe=te<0?te+6.283185307179586:te,le=le<0?le+6.283185307179586:le,F=le==F|Xe==F?F+-2220446049250313e-31:F,Xe=Xe+(bt-ue)/(Se-ue)*(le-Xe),(Xe<0?Xe+6.283185307179586:Xe)>F&&(L=L^1),R=o[R>>2]|0,!R){R=22;break}}if((R|0)==22)return L|0}else{L=0,R=T;e:for(;;){for(;le=+Me[R>>3],Xe=+Me[R+8>>3],R=R+16|0,kt=o[R>>2]|0,kt=kt|0?kt:T,ue=+Me[kt>>3],te=+Me[kt+8>>3],le>ue?(Se=le,le=Xe):(Se=ue,ue=le,le=te,te=Xe),!!(bt<ue|bt>Se);)if(R=o[R>>2]|0,!R){R=22;break e}if(F=le==F|te==F?F+-2220446049250313e-31:F,te+(bt-ue)/(Se-ue)*(le-te)>F&&(L=L^1),R=o[R>>2]|0,!R){R=22;break}}if((R|0)==22)return L|0}return 0}function Bs(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0;if(V=Gt,Gt=Gt+32|0,O=V+16|0,C=V,ue=Mi(T|0,L|0,52)|0,Xt()|0,ue=ue&15,Qt=Mi(R|0,F|0,52)|0,Xt()|0,(ue|0)!=(Qt&15|0))return O=1,Gt=V,O|0;if(bt=Mi(T|0,L|0,45)|0,Xt()|0,bt=bt&127,kt=Mi(R|0,F|0,45)|0,Xt()|0,kt=kt&127,Qt=(bt|0)!=(kt|0),Qt){if(Se=pn(bt,kt)|0,(Se|0)==7)return O=2,Gt=V,O|0;Xe=pn(kt,bt)|0,(Xe|0)==7?en(22925,22949,151,22959):(Q=Se,le=Xe)}else Q=0,le=0;ri=G(bt)|0,Ht=G(kt)|0,o[O>>2]=0,o[O+4>>2]=0,o[O+8>>2]=0,o[O+12>>2]=0;do if(Q){if(kt=o[4304+(bt*28|0)+(Q<<2)>>2]|0,Se=(kt|0)>0,Ht)if(Se){bt=0,Xe=R,Se=F;do Xe=el(Xe,Se)|0,Se=Xt()|0,le=na(le)|0,(le|0)==1&&(le=na(1)|0),bt=bt+1|0;while((bt|0)!=(kt|0));kt=le,bt=Xe,Xe=Se}else kt=le,bt=R,Xe=F;else if(Se){bt=0,Xe=R,Se=F;do Xe=ns(Xe,Se)|0,Se=Xt()|0,le=na(le)|0,bt=bt+1|0;while((bt|0)!=(kt|0));kt=le,bt=Xe,Xe=Se}else kt=le,bt=R,Xe=F;if(xo(bt,Xe,O)|0,Qt||en(22972,22949,181,22959),Se=(ri|0)!=0,le=(Ht|0)!=0,Se&le&&en(22999,22949,182,22959),Se){if(le=sa(T,L)|0,Pt[22032+(le*7|0)+Q>>0]|0){ue=3;break}Xe=o[21200+(le*28|0)+(Q<<2)>>2]|0,bt=Xe,A=26}else if(le){if(le=sa(bt,Xe)|0,Pt[22032+(le*7|0)+kt>>0]|0){ue=4;break}bt=0,Xe=o[21200+(kt*28|0)+(le<<2)>>2]|0,A=26}else le=0;if((A|0)==26)if((Xe|0)<=-1&&en(23030,22949,212,22959),(bt|0)<=-1&&en(23053,22949,213,22959),(Xe|0)>0){Se=O+4|0,le=0;do Wo(Se),le=le+1|0;while((le|0)!=(Xe|0));le=bt}else le=bt;if(o[C>>2]=0,o[C+4>>2]=0,o[C+8>>2]=0,Tl(C,Q),ue|0)for(;Hr(ue)|0?Qo(C):Ns(C),(ue|0)>1;)ue=ue+-1|0;if((le|0)>0){ue=0;do Wo(C),ue=ue+1|0;while((ue|0)!=(le|0))}A=O+4|0,Or(A,C,A),sr(A),A=50}else if(xo(R,F,O)|0,(ri|0)!=0&(Ht|0)!=0)if((kt|0)!=(bt|0)&&en(23077,22949,243,22959),le=sa(T,L)|0,ue=sa(R,F)|0,Pt[22032+(le*7|0)+ue>>0]|0)ue=5;else if(le=o[21200+(le*28|0)+(ue<<2)>>2]|0,(le|0)>0){Se=O+4|0,ue=0;do Wo(Se),ue=ue+1|0;while((ue|0)!=(le|0));A=50}else A=50;else A=50;while(!1);return(A|0)==50&&(ue=O+4|0,o[te>>2]=o[ue>>2],o[te+4>>2]=o[ue+4>>2],o[te+8>>2]=o[ue+8>>2],ue=0),O=ue,Gt=V,O|0}function _s(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0;if(Q=Gt,Gt=Gt+48|0,le=Q+36|0,Se=Q+24|0,Xe=Q+12|0,bt=Q,ue=Mi(T|0,L|0,52)|0,Xt()|0,ue=ue&15,Ht=Mi(T|0,L|0,45)|0,Xt()|0,Ht=Ht&127,kt=G(Ht)|0,zi(ue|0,0,52)|0,C=Xt()|0|134225919,A=F,o[A>>2]=-1,o[A+4>>2]=C,!ue)return(o[R>>2]|0)>1||(o[R+4>>2]|0)>1||(o[R+8>>2]|0)>1||(te=An(Ht,ra(R)|0)|0,(te|0)==127)?(C=1,Gt=Q,C|0):(Qt=zi(te|0,0,45)|0,A=Xt()|0,Ht=F,A=o[Ht+4>>2]&-1040385|A,C=F,o[C>>2]=o[Ht>>2]|Qt,o[C+4>>2]=A,C=0,Gt=Q,C|0);for(o[le>>2]=o[R>>2],o[le+4>>2]=o[R+4>>2],o[le+8>>2]=o[R+8>>2];o[Se>>2]=o[le>>2],o[Se+4>>2]=o[le+4>>2],o[Se+8>>2]=o[le+8>>2],Hr(ue)|0?(Nr(le),o[Xe>>2]=o[le>>2],o[Xe+4>>2]=o[le+4>>2],o[Xe+8>>2]=o[le+8>>2],Qo(Xe)):(ko(le),o[Xe>>2]=o[le>>2],o[Xe+4>>2]=o[le+4>>2],o[Xe+8>>2]=o[le+8>>2],Ns(Xe)),Ys(Se,Xe,bt),sr(bt),A=F,O=o[A>>2]|0,A=o[A+4>>2]|0,V=(15-ue|0)*3|0,R=zi(7,0,V|0)|0,A=A&~(Xt()|0),V=zi(ra(bt)|0,0,V|0)|0,A=Xt()|0|A,C=F,o[C>>2]=V|O&~R,o[C+4>>2]=A,(ue|0)>1;)ue=ue+-1|0;e:do if((o[le>>2]|0)<=1&&(o[le+4>>2]|0)<=1&&(o[le+8>>2]|0)<=1){ue=ra(le)|0,Se=An(Ht,ue)|0,(Se|0)==127?bt=0:bt=G(Se)|0;t:do if(ue){if(kt){if(le=21408+((sa(T,L)|0)*28|0)+(ue<<2)|0,le=o[le>>2]|0,(le|0)>0){R=0;do ue=ma(ue)|0,R=R+1|0;while((R|0)!=(le|0))}if((ue|0)==1){te=3;break e}R=An(Ht,ue)|0,(R|0)==127&&en(23104,22949,376,23134),G(R)|0?en(23147,22949,377,23134):(Qt=le,ri=ue,te=R)}else Qt=0,ri=ue,te=Se;if(Xe=o[4304+(Ht*28|0)+(ri<<2)>>2]|0,(Xe|0)<=-1&&en(23178,22949,384,23134),!bt){if((Qt|0)<=-1&&en(23030,22949,417,23134),Qt|0){le=F,ue=0,R=o[le>>2]|0,le=o[le+4>>2]|0;do R=io(R,le)|0,le=Xt()|0,V=F,o[V>>2]=R,o[V+4>>2]=le,ue=ue+1|0;while((ue|0)<(Qt|0))}if((Xe|0)<=0){ue=54;break}for(le=F,ue=0,R=o[le>>2]|0,le=o[le+4>>2]|0;;)if(R=io(R,le)|0,le=Xt()|0,V=F,o[V>>2]=R,o[V+4>>2]=le,ue=ue+1|0,(ue|0)==(Xe|0)){ue=54;break t}}if(Se=pn(te,Ht)|0,(Se|0)==7&&en(22925,22949,393,23134),ue=F,R=o[ue>>2]|0,ue=o[ue+4>>2]|0,(Xe|0)>0){le=0;do R=io(R,ue)|0,ue=Xt()|0,V=F,o[V>>2]=R,o[V+4>>2]=ue,le=le+1|0;while((le|0)!=(Xe|0))}if(R=sa(R,ue)|0,V=we(te)|0,R=o[(V?21824:21616)+(Se*28|0)+(R<<2)>>2]|0,(R|0)<=-1&&en(23030,22949,412,23134),!R)ue=54;else{Se=F,ue=0,le=o[Se>>2]|0,Se=o[Se+4>>2]|0;do le=Ws(le,Se)|0,Se=Xt()|0,V=F,o[V>>2]=le,o[V+4>>2]=Se,ue=ue+1|0;while((ue|0)<(R|0));ue=54}}else if((kt|0)!=0&(bt|0)!=0)if(V=sa(T,L)|0,ue=F,ue=21408+(V*28|0)+((sa(o[ue>>2]|0,o[ue+4>>2]|0)|0)<<2)|0,ue=o[ue>>2]|0,(ue|0)<=-1&&en(23201,22949,433,23134),!ue)te=Se,ue=55;else{le=F,te=0,R=o[le>>2]|0,le=o[le+4>>2]|0;do R=io(R,le)|0,le=Xt()|0,V=F,o[V>>2]=R,o[V+4>>2]=le,te=te+1|0;while((te|0)<(ue|0));te=Se,ue=54}else te=Se,ue=54;while(!1);if((ue|0)==54&&bt&&(ue=55),(ue|0)==55&&(V=F,(sa(o[V>>2]|0,o[V+4>>2]|0)|0)==1)){te=4;break}V=F,C=o[V>>2]|0,V=o[V+4>>2]&-1040385,O=zi(te|0,0,45)|0,V=V|(Xt()|0),te=F,o[te>>2]=C|O,o[te+4>>2]=V,te=0}else te=2;while(!1);return V=te,Gt=Q,V|0}function ro(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0;return le=Gt,Gt=Gt+16|0,ue=le,T=Bs(T,L,R,F,ue)|0,T||(gl(ue,te),T=0),Gt=le,T|0}function bo(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0;return te=Gt,Gt=Gt+16|0,ue=te,Ml(R,ue),F=_s(T,L,ue,F)|0,Gt=te,F|0}function cs(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0;return le=Gt,Gt=Gt+32|0,te=le+12|0,ue=le,!(Bs(T,L,T,L,te)|0)&&!(Bs(T,L,R,F,ue)|0)?T=Fa(te,ue)|0:T=-1,Gt=le,T|0}function Yu(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0,le=0;return le=Gt,Gt=Gt+32|0,te=le+12|0,ue=le,!(Bs(T,L,T,L,te)|0)&&!(Bs(T,L,R,F,ue)|0)?T=Fa(te,ue)|0:T=-1,Gt=le,(T>>>31^1)+T|0}function Nu(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0;if(i=Gt,Gt=Gt+48|0,ue=i+24|0,le=i+12|0,s=i,!(Bs(T,L,T,L,ue)|0)&&!(Bs(T,L,R,F,le)|0)){if(x=Fa(ue,le)|0,(x|0)<0)return s=x,Gt=i,s|0;for(o[ue>>2]=0,o[ue+4>>2]=0,o[ue+8>>2]=0,o[le>>2]=0,o[le+4>>2]=0,o[le+8>>2]=0,Bs(T,L,T,L,ue)|0,Bs(T,L,R,F,le)|0,yu(ue),yu(le),x?(kt=o[ue>>2]|0,Qt=+(x|0),C=ue+4|0,ri=o[C>>2]|0,O=ue+8|0,Ht=o[O>>2]|0,V=ue,R=kt,F=ri,ue=Ht,Q=+((o[le>>2]|0)-kt|0)/Qt,A=+((o[le+4>>2]|0)-ri|0)/Qt,Qt=+((o[le+8>>2]|0)-Ht|0)/Qt):(F=ue+4|0,Ht=ue+8|0,C=F,O=Ht,V=ue,R=o[ue>>2]|0,F=o[F>>2]|0,ue=o[Ht>>2]|0,Q=0,A=0,Qt=0),o[s>>2]=R,Ht=s+4|0,o[Ht>>2]=F,ri=s+8|0,o[ri>>2]=ue,kt=0;;){Xe=+(kt|0),r=Q*Xe+ +(R|0),Se=A*Xe+ +(o[C>>2]|0),Xe=Qt*Xe+ +(o[O>>2]|0),F=~~+wu(+r),le=~~+wu(+Se),R=~~+wu(+Xe),r=+fi(+(+(F|0)-r)),Se=+fi(+(+(le|0)-Se)),Xe=+fi(+(+(R|0)-Xe));do if(r>Se&r>Xe)F=0-(le+R)|0,ue=le;else if(bt=0-F|0,Se>Xe){ue=bt-R|0;break}else{ue=le,R=bt-le|0;break}while(!1);if(o[s>>2]=F,o[Ht>>2]=ue,o[ri>>2]=R,ps(s),_s(T,L,s,te+(kt<<3)|0)|0,(kt|0)==(x|0))break;kt=kt+1|0,R=o[V>>2]|0}return s=0,Gt=i,s|0}return s=-1,Gt=i,s|0}function wo(T,L){T=T|0,L=L|0;var R=0;if(!L)return R=1,R|0;R=T,T=1;do T=Yr(L&1|0?R:1,T)|0,L=L>>1,R=Yr(R,R)|0;while(L|0);return T|0}function Ll(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0;if(!(Xa(L,R)|0)||(L=qr(L)|0,Ht=+Me[R>>3],F=+Me[R+8>>3],F=L&F<0?F+6.283185307179586:F,ri=o[T>>2]|0,(ri|0)<=0))return ri=0,ri|0;if(kt=o[T+4>>2]|0,L){L=0,R=-1,T=0;e:for(;;){for(bt=T;le=+Me[kt+(bt<<4)>>3],Xe=+Me[kt+(bt<<4)+8>>3],T=(R+2|0)%(ri|0)|0,ue=+Me[kt+(T<<4)>>3],te=+Me[kt+(T<<4)+8>>3],le>ue?(Se=le,le=Xe):(Se=ue,ue=le,le=te,te=Xe),!!(Ht<ue|Ht>Se);)if(R=bt+1|0,(R|0)<(ri|0))T=bt,bt=R,R=T;else{R=22;break e}if(Xe=te<0?te+6.283185307179586:te,le=le<0?le+6.283185307179586:le,F=le==F|Xe==F?F+-2220446049250313e-31:F,Xe=Xe+(Ht-ue)/(Se-ue)*(le-Xe),(Xe<0?Xe+6.283185307179586:Xe)>F&&(L=L^1),T=bt+1|0,(T|0)>=(ri|0)){R=22;break}else R=bt}if((R|0)==22)return L|0}else{L=0,R=-1,T=0;e:for(;;){for(bt=T;le=+Me[kt+(bt<<4)>>3],Xe=+Me[kt+(bt<<4)+8>>3],T=(R+2|0)%(ri|0)|0,ue=+Me[kt+(T<<4)>>3],te=+Me[kt+(T<<4)+8>>3],le>ue?(Se=le,le=Xe):(Se=ue,ue=le,le=te,te=Xe),!!(Ht<ue|Ht>Se);)if(R=bt+1|0,(R|0)<(ri|0))T=bt,bt=R,R=T;else{R=22;break e}if(F=le==F|te==F?F+-2220446049250313e-31:F,te+(Ht-ue)/(Se-ue)*(le-te)>F&&(L=L^1),T=bt+1|0,(T|0)>=(ri|0)){R=22;break}else R=bt}if((R|0)==22)return L|0}return 0}function Rn(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0;if(Q=o[T>>2]|0,!Q){o[L>>2]=0,o[L+4>>2]=0,o[L+8>>2]=0,o[L+12>>2]=0,o[L+16>>2]=0,o[L+20>>2]=0,o[L+24>>2]=0,o[L+28>>2]=0;return}if(A=L+8|0,Me[A>>3]=17976931348623157e292,C=L+24|0,Me[C>>3]=17976931348623157e292,Me[L>>3]=-17976931348623157e292,O=L+16|0,Me[O>>3]=-17976931348623157e292,!((Q|0)<=0)){for(Ht=o[T+4>>2]|0,bt=17976931348623157e292,kt=-17976931348623157e292,ri=0,T=-1,ue=17976931348623157e292,le=17976931348623157e292,Xe=-17976931348623157e292,F=-17976931348623157e292,Qt=0;R=+Me[Ht+(Qt<<4)>>3],Se=+Me[Ht+(Qt<<4)+8>>3],T=T+2|0,te=+Me[Ht+(((T|0)==(Q|0)?0:T)<<4)+8>>3],R<ue&&(Me[A>>3]=R,ue=R),Se<le&&(Me[C>>3]=Se,le=Se),R>Xe?Me[L>>3]=R:R=Xe,Se>F&&(Me[O>>3]=Se,F=Se),bt=Se>0&Se<bt?Se:bt,kt=Se<0&Se>kt?Se:kt,ri=ri|+fi(+(Se-te))>3.141592653589793,T=Qt+1|0,(T|0)!=(Q|0);)V=Qt,Xe=R,Qt=T,T=V;ri&&(Me[O>>3]=kt,Me[C>>3]=bt)}}function Na(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0,r=0,l=0;if(Q=o[T>>2]|0,Q){if(A=L+8|0,Me[A>>3]=17976931348623157e292,C=L+24|0,Me[C>>3]=17976931348623157e292,Me[L>>3]=-17976931348623157e292,O=L+16|0,Me[O>>3]=-17976931348623157e292,(Q|0)>0){for(te=o[T+4>>2]|0,Ht=17976931348623157e292,Qt=-17976931348623157e292,F=0,R=-1,Xe=17976931348623157e292,bt=17976931348623157e292,ri=-17976931348623157e292,le=-17976931348623157e292,V=0;ue=+Me[te+(V<<4)>>3],kt=+Me[te+(V<<4)+8>>3],r=R+2|0,Se=+Me[te+(((r|0)==(Q|0)?0:r)<<4)+8>>3],ue<Xe&&(Me[A>>3]=ue,Xe=ue),kt<bt&&(Me[C>>3]=kt,bt=kt),ue>ri?Me[L>>3]=ue:ue=ri,kt>le&&(Me[O>>3]=kt,le=kt),Ht=kt>0&kt<Ht?kt:Ht,Qt=kt<0&kt>Qt?kt:Qt,F=F|+fi(+(kt-Se))>3.141592653589793,R=V+1|0,(R|0)!=(Q|0);)r=V,ri=ue,V=R,R=r;F&&(Me[O>>3]=Qt,Me[C>>3]=Ht)}}else o[L>>2]=0,o[L+4>>2]=0,o[L+8>>2]=0,o[L+12>>2]=0,o[L+16>>2]=0,o[L+20>>2]=0,o[L+24>>2]=0,o[L+28>>2]=0;if(r=T+8|0,R=o[r>>2]|0,!((R|0)<=0)){i=T+12|0,s=0;do if(te=o[i>>2]|0,F=s,s=s+1|0,C=L+(s<<5)|0,O=o[te+(F<<3)>>2]|0,O){if(V=L+(s<<5)+8|0,Me[V>>3]=17976931348623157e292,T=L+(s<<5)+24|0,Me[T>>3]=17976931348623157e292,Me[C>>3]=-17976931348623157e292,x=L+(s<<5)+16|0,Me[x>>3]=-17976931348623157e292,(O|0)>0){for(Q=o[te+(F<<3)+4>>2]|0,Ht=17976931348623157e292,Qt=-17976931348623157e292,te=0,F=-1,A=0,Xe=17976931348623157e292,bt=17976931348623157e292,kt=-17976931348623157e292,le=-17976931348623157e292;ue=+Me[Q+(A<<4)>>3],ri=+Me[Q+(A<<4)+8>>3],F=F+2|0,Se=+Me[Q+(((F|0)==(O|0)?0:F)<<4)+8>>3],ue<Xe&&(Me[V>>3]=ue,Xe=ue),ri<bt&&(Me[T>>3]=ri,bt=ri),ue>kt?Me[C>>3]=ue:ue=kt,ri>le&&(Me[x>>3]=ri,le=ri),Ht=ri>0&ri<Ht?ri:Ht,Qt=ri<0&ri>Qt?ri:Qt,te=te|+fi(+(ri-Se))>3.141592653589793,F=A+1|0,(F|0)!=(O|0);)l=A,A=F,kt=ue,F=l;te&&(Me[x>>3]=Qt,Me[T>>3]=Ht)}}else o[C>>2]=0,o[C+4>>2]=0,o[C+8>>2]=0,o[C+12>>2]=0,o[C+16>>2]=0,o[C+20>>2]=0,o[C+24>>2]=0,o[C+28>>2]=0,R=o[r>>2]|0;while((s|0)<(R|0))}}function En(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0;if(!(Ll(T,L,R)|0))return te=0,te|0;if(te=T+8|0,(o[te>>2]|0)<=0)return te=1,te|0;for(F=T+12|0,T=0;;){if(ue=T,T=T+1|0,Ll((o[F>>2]|0)+(ue<<3)|0,L+(T<<5)|0,R)|0){T=0,F=6;break}if((T|0)>=(o[te>>2]|0)){T=1,F=6;break}}return(F|0)==6?T|0:0}function Vo(){return 8}function Gl(){return 16}function Cn(){return 168}function Yl(){return 8}function Tn(){return 16}function yl(){return 12}function hu(){return 8}function Vu(T){T=T|0;var L=0,R=0;return R=+Me[T>>3],L=+Me[T+8>>3],+ +ti(+(R*R+L*L))}function ql(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0;bt=+Me[T>>3],Xe=+Me[L>>3]-bt,Se=+Me[T+8>>3],le=+Me[L+8>>3]-Se,ri=+Me[R>>3],ue=+Me[F>>3]-ri,Ht=+Me[R+8>>3],kt=+Me[F+8>>3]-Ht,ue=(ue*(Se-Ht)-(bt-ri)*kt)/(Xe*kt-le*ue),Me[te>>3]=bt+Xe*ue,Me[te+8>>3]=Se+le*ue}function vl(T,L){return T=T|0,L=L|0,+Me[T>>3]!=+Me[L>>3]?(L=0,L|0):(L=+Me[T+8>>3]==+Me[L+8>>3],L|0)}function oa(T,L){T=T|0,L=L|0;var R=0,F=0,te=0;return te=+Me[T>>3]-+Me[L>>3],F=+Me[T+8>>3]-+Me[L+8>>3],R=+Me[T+16>>3]-+Me[L+16>>3],+(te*te+F*F+R*R)}function uc(T,L){T=T|0,L=L|0;var R=0,F=0,te=0;R=+Me[T>>3],F=+Ri(+R),R=+bi(+R),Me[L+16>>3]=R,R=+Me[T+8>>3],te=F*+Ri(+R),Me[L>>3]=te,R=F*+bi(+R),Me[L+8>>3]=R}function Ku(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0;if(bt=Gt,Gt=Gt+32|0,te=bt+16|0,ue=bt,aa(T,L,te),le=ul(T,L)|0,Xe=sa(T,L)|0,Yt(le,ue),L=Ii(le,o[te>>2]|0)|0,!(G(le)|0))return Xe=L,Gt=bt,Xe|0;do switch(le|0){case 4:{T=0,R=14;break}case 14:{T=1,R=14;break}case 24:{T=2,R=14;break}case 38:{T=3,R=14;break}case 49:{T=4,R=14;break}case 58:{T=5,R=14;break}case 63:{T=6,R=14;break}case 72:{T=7,R=14;break}case 83:{T=8,R=14;break}case 97:{T=9,R=14;break}case 107:{T=10,R=14;break}case 117:{T=11,R=14;break}default:Se=0,F=0}while(!1);return(R|0)==14&&(Se=o[22096+(T*24|0)+8>>2]|0,F=o[22096+(T*24|0)+16>>2]|0),T=o[te>>2]|0,(T|0)!=(o[ue>>2]|0)&&(le=we(le)|0,T=o[te>>2]|0,le|(T|0)==(F|0)&&(L=(L+1|0)%6|0)),(Xe|0)==3&(T|0)==(F|0)?(Xe=(L+5|0)%6|0,Gt=bt,Xe|0):(Xe|0)==5&(T|0)==(Se|0)?(Xe=(L+1|0)%6|0,Gt=bt,Xe|0):(Xe=L,Gt=bt,Xe|0)}function Kl(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;return F=gs(T,L)|0,(R+-1|0)>>>0>5||(te=(F|0)!=0,(R|0)==1&te)?(R=-1,R|0):(F=Ku(T,L)|0,te?(R=(5-F+(o[22384+(R<<2)>>2]|0)|0)%5|0,R|0):(R=(6-F+(o[22416+(R<<2)>>2]|0)|0)%6|0,R|0))}function ys(T,L,R){T=T|0,L=L|0,R=R|0;var F=0;(L|0)>0?(F=il(L,4)|0,o[T>>2]=F,F||en(23230,23253,40,23267)):o[T>>2]=0,o[T+4>>2]=L,o[T+8>>2]=0,o[T+12>>2]=R}function wa(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0;te=T+4|0,ue=T+12|0,le=T+8|0;e:for(;;){for(R=o[te>>2]|0,L=0;;){if((L|0)>=(R|0))break e;if(F=o[T>>2]|0,Se=o[F+(L<<2)>>2]|0,!Se)L=L+1|0;else break}L=F+(~~(+fi(+(+ui(10,+ +(15-(o[ue>>2]|0)|0))*(+Me[Se>>3]+ +Me[Se+8>>3])))%+(R|0))>>>0<<2)|0,R=o[L>>2]|0;t:do if(R|0){if(F=Se+32|0,(R|0)==(Se|0))o[L>>2]=o[F>>2];else{if(R=R+32|0,L=o[R>>2]|0,!L)break;for(;(L|0)!=(Se|0);)if(R=L+32|0,L=o[R>>2]|0,!L)break t;o[R>>2]=o[F>>2]}ir(Se),o[le>>2]=(o[le>>2]|0)+-1}while(!1)}ir(o[T>>2]|0)}function tl(T){T=T|0;var L=0,R=0,F=0;for(F=o[T+4>>2]|0,R=0;;){if((R|0)>=(F|0)){L=0,R=4;break}if(L=o[(o[T>>2]|0)+(R<<2)>>2]|0,!L)R=R+1|0;else{R=4;break}}return(R|0)==4?L|0:0}function xu(T,L){T=T|0,L=L|0;var R=0,F=0,te=0,ue=0;if(R=~~(+fi(+(+ui(10,+ +(15-(o[T+12>>2]|0)|0))*(+Me[L>>3]+ +Me[L+8>>3])))%+(o[T+4>>2]|0))>>>0,R=(o[T>>2]|0)+(R<<2)|0,F=o[R>>2]|0,!F)return ue=1,ue|0;ue=L+32|0;do if((F|0)!=(L|0)){if(R=o[F+32>>2]|0,!R)return ue=1,ue|0;for(te=R;;){if((te|0)==(L|0)){te=8;break}if(R=o[te+32>>2]|0,R)F=te,te=R;else{R=1,te=10;break}}if((te|0)==8){o[F+32>>2]=o[ue>>2];break}else if((te|0)==10)return R|0}else o[R>>2]=o[ue>>2];while(!1);return ir(L),ue=T+8|0,o[ue>>2]=(o[ue>>2]|0)+-1,ue=0,ue|0}function Uu(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0;ue=Zn(40)|0,ue||en(23283,23253,98,23296),o[ue>>2]=o[L>>2],o[ue+4>>2]=o[L+4>>2],o[ue+8>>2]=o[L+8>>2],o[ue+12>>2]=o[L+12>>2],te=ue+16|0,o[te>>2]=o[R>>2],o[te+4>>2]=o[R+4>>2],o[te+8>>2]=o[R+8>>2],o[te+12>>2]=o[R+12>>2],o[ue+32>>2]=0,te=~~(+fi(+(+ui(10,+ +(15-(o[T+12>>2]|0)|0))*(+Me[L>>3]+ +Me[L+8>>3])))%+(o[T+4>>2]|0))>>>0,te=(o[T>>2]|0)+(te<<2)|0,F=o[te>>2]|0;do if(!F)o[te>>2]=ue;else{for(;!(Ta(F,L)|0&&Ta(F+16|0,R)|0);)if(te=o[F+32>>2]|0,F=te|0?te:F,!(o[F+32>>2]|0)){le=10;break}if((le|0)==10){o[F+32>>2]=ue;break}return ir(ue),le=F,le|0}while(!1);return le=T+8|0,o[le>>2]=(o[le>>2]|0)+1,le=ue,le|0}function Au(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0;if(te=~~(+fi(+(+ui(10,+ +(15-(o[T+12>>2]|0)|0))*(+Me[L>>3]+ +Me[L+8>>3])))%+(o[T+4>>2]|0))>>>0,te=o[(o[T>>2]|0)+(te<<2)>>2]|0,!te)return R=0,R|0;if(!R){for(T=te;;){if(Ta(T,L)|0){F=10;break}if(T=o[T+32>>2]|0,!T){T=0,F=10;break}}if((F|0)==10)return T|0}for(T=te;;){if(Ta(T,L)|0&&Ta(T+16|0,R)|0){F=10;break}if(T=o[T+32>>2]|0,!T){T=0,F=10;break}}return(F|0)==10?T|0:0}function Gu(T,L){T=T|0,L=L|0;var R=0;if(R=~~(+fi(+(+ui(10,+ +(15-(o[T+12>>2]|0)|0))*(+Me[L>>3]+ +Me[L+8>>3])))%+(o[T+4>>2]|0))>>>0,T=o[(o[T>>2]|0)+(R<<2)>>2]|0,!T)return R=0,R|0;for(;;){if(Ta(T,L)|0){L=5;break}if(T=o[T+32>>2]|0,!T){T=0,L=5;break}}return(L|0)==5?T|0:0}function br(){return 23312}function vs(T){return T=+T,+ +Al(+T)}function gn(T){return T=+T,~~+vs(T)|0}function Zn(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0,A=0,C=0,O=0,V=0,x=0,s=0,i=0;i=Gt,Gt=Gt+16|0,Ht=i;do if(T>>>0<245){if(bt=T>>>0<11?16:T+11&-8,T=bt>>>3,ri=o[5829]|0,R=ri>>>T,R&3|0)return L=(R&1^1)+T|0,T=23356+(L<<1<<2)|0,R=T+8|0,F=o[R>>2]|0,te=F+8|0,ue=o[te>>2]|0,(ue|0)==(T|0)?o[5829]=ri&~(1<<L):(o[ue+12>>2]=T,o[R>>2]=ue),s=L<<3,o[F+4>>2]=s|3,s=F+s+4|0,o[s>>2]=o[s>>2]|1,s=te,Gt=i,s|0;if(kt=o[5831]|0,bt>>>0>kt>>>0){if(R|0)return L=2<<T,L=R<<T&(L|0-L),L=(L&0-L)+-1|0,Se=L>>>12&16,L=L>>>Se,R=L>>>5&8,L=L>>>R,ue=L>>>2&4,L=L>>>ue,T=L>>>1&2,L=L>>>T,F=L>>>1&1,F=(R|Se|ue|T|F)+(L>>>F)|0,L=23356+(F<<1<<2)|0,T=L+8|0,ue=o[T>>2]|0,Se=ue+8|0,R=o[Se>>2]|0,(R|0)==(L|0)?(T=ri&~(1<<F),o[5829]=T):(o[R+12>>2]=L,o[T>>2]=R,T=ri),s=F<<3,le=s-bt|0,o[ue+4>>2]=bt|3,te=ue+bt|0,o[te+4>>2]=le|1,o[ue+s>>2]=le,kt|0&&(F=o[5834]|0,L=kt>>>3,R=23356+(L<<1<<2)|0,L=1<<L,T&L?(T=R+8|0,L=o[T>>2]|0):(o[5829]=T|L,L=R,T=R+8|0),o[T>>2]=F,o[L+12>>2]=F,o[F+8>>2]=L,o[F+12>>2]=R),o[5831]=le,o[5834]=te,s=Se,Gt=i,s|0;if(ue=o[5830]|0,ue){for(R=(ue&0-ue)+-1|0,te=R>>>12&16,R=R>>>te,F=R>>>5&8,R=R>>>F,le=R>>>2&4,R=R>>>le,Se=R>>>1&2,R=R>>>Se,Xe=R>>>1&1,Xe=o[23620+((F|te|le|Se|Xe)+(R>>>Xe)<<2)>>2]|0,R=Xe,Se=Xe,Xe=(o[Xe+4>>2]&-8)-bt|0;T=o[R+16>>2]|0,!(!T&&(T=o[R+20>>2]|0,!T));)le=(o[T+4>>2]&-8)-bt|0,te=le>>>0<Xe>>>0,R=T,Se=te?T:Se,Xe=te?le:Xe;if(le=Se+bt|0,le>>>0>Se>>>0){te=o[Se+24>>2]|0,L=o[Se+12>>2]|0;do if((L|0)==(Se|0)){if(T=Se+20|0,L=o[T>>2]|0,!L&&(T=Se+16|0,L=o[T>>2]|0,!L)){R=0;break}for(;;)if(F=L+20|0,R=o[F>>2]|0,R)L=R,T=F;else if(F=L+16|0,R=o[F>>2]|0,R)L=R,T=F;else break;o[T>>2]=0,R=L}else R=o[Se+8>>2]|0,o[R+12>>2]=L,o[L+8>>2]=R,R=L;while(!1);do if(te|0){if(L=o[Se+28>>2]|0,T=23620+(L<<2)|0,(Se|0)==(o[T>>2]|0)){if(o[T>>2]=R,!R){o[5830]=ue&~(1<<L);break}}else if(s=te+16|0,o[((o[s>>2]|0)==(Se|0)?s:te+20|0)>>2]=R,!R)break;o[R+24>>2]=te,L=o[Se+16>>2]|0,L|0&&(o[R+16>>2]=L,o[L+24>>2]=R),L=o[Se+20>>2]|0,L|0&&(o[R+20>>2]=L,o[L+24>>2]=R)}while(!1);return Xe>>>0<16?(s=Xe+bt|0,o[Se+4>>2]=s|3,s=Se+s+4|0,o[s>>2]=o[s>>2]|1):(o[Se+4>>2]=bt|3,o[le+4>>2]=Xe|1,o[le+Xe>>2]=Xe,kt|0&&(F=o[5834]|0,L=kt>>>3,R=23356+(L<<1<<2)|0,L=1<<L,L&ri?(T=R+8|0,L=o[T>>2]|0):(o[5829]=L|ri,L=R,T=R+8|0),o[T>>2]=F,o[L+12>>2]=F,o[F+8>>2]=L,o[F+12>>2]=R),o[5831]=Xe,o[5834]=le),s=Se+8|0,Gt=i,s|0}else ri=bt}else ri=bt}else ri=bt}else if(T>>>0<=4294967231)if(T=T+11|0,bt=T&-8,F=o[5830]|0,F){te=0-bt|0,T=T>>>8,T?bt>>>0>16777215?Xe=31:(ri=(T+1048320|0)>>>16&8,A=T<<ri,Se=(A+520192|0)>>>16&4,A=A<<Se,Xe=(A+245760|0)>>>16&2,Xe=14-(Se|ri|Xe)+(A<<Xe>>>15)|0,Xe=bt>>>(Xe+7|0)&1|Xe<<1):Xe=0,R=o[23620+(Xe<<2)>>2]|0;e:do if(!R)R=0,T=0,A=61;else for(T=0,Se=bt<<((Xe|0)==31?0:25-(Xe>>>1)|0),ue=0;;){if(le=(o[R+4>>2]&-8)-bt|0,le>>>0<te>>>0)if(le)T=R,te=le;else{T=R,te=0,A=65;break e}if(A=o[R+20>>2]|0,R=o[R+16+(Se>>>31<<2)>>2]|0,ue=(A|0)==0|(A|0)==(R|0)?ue:A,R)Se=Se<<1;else{R=ue,A=61;break}}while(!1);if((A|0)==61){if((R|0)==0&(T|0)==0){if(T=2<<Xe,T=(T|0-T)&F,!T){ri=bt;break}ri=(T&0-T)+-1|0,le=ri>>>12&16,ri=ri>>>le,ue=ri>>>5&8,ri=ri>>>ue,Se=ri>>>2&4,ri=ri>>>Se,Xe=ri>>>1&2,ri=ri>>>Xe,R=ri>>>1&1,T=0,R=o[23620+((ue|le|Se|Xe|R)+(ri>>>R)<<2)>>2]|0}R?A=65:(Se=T,le=te)}if((A|0)==65)for(ue=R;;)if(ri=(o[ue+4>>2]&-8)-bt|0,R=ri>>>0<te>>>0,te=R?ri:te,T=R?ue:T,R=o[ue+16>>2]|0,R||(R=o[ue+20>>2]|0),R)ue=R;else{Se=T,le=te;break}if(Se|0&&le>>>0<((o[5831]|0)-bt|0)>>>0&&(kt=Se+bt|0,kt>>>0>Se>>>0)){ue=o[Se+24>>2]|0,L=o[Se+12>>2]|0;do if((L|0)==(Se|0)){if(T=Se+20|0,L=o[T>>2]|0,!L&&(T=Se+16|0,L=o[T>>2]|0,!L)){L=0;break}for(;;)if(te=L+20|0,R=o[te>>2]|0,R)L=R,T=te;else if(te=L+16|0,R=o[te>>2]|0,R)L=R,T=te;else break;o[T>>2]=0}else s=o[Se+8>>2]|0,o[s+12>>2]=L,o[L+8>>2]=s;while(!1);do if(ue){if(T=o[Se+28>>2]|0,R=23620+(T<<2)|0,(Se|0)==(o[R>>2]|0)){if(o[R>>2]=L,!L){F=F&~(1<<T),o[5830]=F;break}}else if(s=ue+16|0,o[((o[s>>2]|0)==(Se|0)?s:ue+20|0)>>2]=L,!L)break;o[L+24>>2]=ue,T=o[Se+16>>2]|0,T|0&&(o[L+16>>2]=T,o[T+24>>2]=L),T=o[Se+20>>2]|0,T&&(o[L+20>>2]=T,o[T+24>>2]=L)}while(!1);e:do if(le>>>0<16)s=le+bt|0,o[Se+4>>2]=s|3,s=Se+s+4|0,o[s>>2]=o[s>>2]|1;else{if(o[Se+4>>2]=bt|3,o[kt+4>>2]=le|1,o[kt+le>>2]=le,L=le>>>3,le>>>0<256){R=23356+(L<<1<<2)|0,T=o[5829]|0,L=1<<L,T&L?(T=R+8|0,L=o[T>>2]|0):(o[5829]=T|L,L=R,T=R+8|0),o[T>>2]=kt,o[L+12>>2]=kt,o[kt+8>>2]=L,o[kt+12>>2]=R;break}if(L=le>>>8,L?le>>>0>16777215?R=31:(x=(L+1048320|0)>>>16&8,s=L<<x,V=(s+520192|0)>>>16&4,s=s<<V,R=(s+245760|0)>>>16&2,R=14-(V|x|R)+(s<<R>>>15)|0,R=le>>>(R+7|0)&1|R<<1):R=0,L=23620+(R<<2)|0,o[kt+28>>2]=R,T=kt+16|0,o[T+4>>2]=0,o[T>>2]=0,T=1<<R,!(F&T)){o[5830]=F|T,o[L>>2]=kt,o[kt+24>>2]=L,o[kt+12>>2]=kt,o[kt+8>>2]=kt;break}L=o[L>>2]|0;t:do if((o[L+4>>2]&-8|0)!=(le|0)){for(F=le<<((R|0)==31?0:25-(R>>>1)|0);R=L+16+(F>>>31<<2)|0,T=o[R>>2]|0,!!T;)if((o[T+4>>2]&-8|0)==(le|0)){L=T;break t}else F=F<<1,L=T;o[R>>2]=kt,o[kt+24>>2]=L,o[kt+12>>2]=kt,o[kt+8>>2]=kt;break e}while(!1);x=L+8|0,s=o[x>>2]|0,o[s+12>>2]=kt,o[x>>2]=kt,o[kt+8>>2]=s,o[kt+12>>2]=L,o[kt+24>>2]=0}while(!1);return s=Se+8|0,Gt=i,s|0}else ri=bt}else ri=bt;else ri=-1;while(!1);if(R=o[5831]|0,R>>>0>=ri>>>0)return L=R-ri|0,T=o[5834]|0,L>>>0>15?(s=T+ri|0,o[5834]=s,o[5831]=L,o[s+4>>2]=L|1,o[T+R>>2]=L,o[T+4>>2]=ri|3):(o[5831]=0,o[5834]=0,o[T+4>>2]=R|3,s=T+R+4|0,o[s>>2]=o[s>>2]|1),s=T+8|0,Gt=i,s|0;if(le=o[5832]|0,le>>>0>ri>>>0)return V=le-ri|0,o[5832]=V,s=o[5835]|0,x=s+ri|0,o[5835]=x,o[x+4>>2]=V|1,o[s+4>>2]=ri|3,s=s+8|0,Gt=i,s|0;if(o[5947]|0?T=o[5949]|0:(o[5949]=4096,o[5948]=4096,o[5950]=-1,o[5951]=-1,o[5952]=0,o[5940]=0,o[5947]=Ht&-16^1431655768,T=4096),Se=ri+48|0,Xe=ri+47|0,ue=T+Xe|0,te=0-T|0,bt=ue&te,bt>>>0<=ri>>>0||(T=o[5939]|0,T|0&&(kt=o[5937]|0,Ht=kt+bt|0,Ht>>>0<=kt>>>0|Ht>>>0>T>>>0)))return s=0,Gt=i,s|0;e:do if(o[5940]&4)L=0,A=143;else{R=o[5835]|0;t:do if(R){for(F=23764;Ht=o[F>>2]|0,!(Ht>>>0<=R>>>0&&(Ht+(o[F+4>>2]|0)|0)>>>0>R>>>0);)if(T=o[F+8>>2]|0,T)F=T;else{A=128;break t}if(L=ue-le&te,L>>>0<2147483647)if(T=zs(L|0)|0,(T|0)==((o[F>>2]|0)+(o[F+4>>2]|0)|0)){if((T|0)!=-1){le=L,ue=T,A=145;break e}}else F=T,A=136;else L=0}else A=128;while(!1);do if((A|0)==128)if(R=zs(0)|0,(R|0)!=-1&&(L=R,Qt=o[5948]|0,Q=Qt+-1|0,L=(Q&L|0?(Q+L&0-Qt)-L|0:0)+bt|0,Qt=o[5937]|0,Q=L+Qt|0,L>>>0>ri>>>0&L>>>0<2147483647)){if(Ht=o[5939]|0,Ht|0&&Q>>>0<=Qt>>>0|Q>>>0>Ht>>>0){L=0;break}if(T=zs(L|0)|0,(T|0)==(R|0)){le=L,ue=R,A=145;break e}else F=T,A=136}else L=0;while(!1);do if((A|0)==136){if(R=0-L|0,!(Se>>>0>L>>>0&(L>>>0<2147483647&(F|0)!=-1)))if((F|0)==-1){L=0;break}else{le=L,ue=F,A=145;break e}if(T=o[5949]|0,T=Xe-L+T&0-T,T>>>0>=2147483647){le=L,ue=F,A=145;break e}if((zs(T|0)|0)==-1){zs(R|0)|0,L=0;break}else{le=T+L|0,ue=F,A=145;break e}}while(!1);o[5940]=o[5940]|4,A=143}while(!1);if((A|0)==143&&bt>>>0<2147483647&&(V=zs(bt|0)|0,Q=zs(0)|0,C=Q-V|0,O=C>>>0>(ri+40|0)>>>0,!((V|0)==-1|O^1|V>>>0<Q>>>0&((V|0)!=-1&(Q|0)!=-1)^1))&&(le=O?C:L,ue=V,A=145),(A|0)==145){L=(o[5937]|0)+le|0,o[5937]=L,L>>>0>(o[5938]|0)>>>0&&(o[5938]=L),Xe=o[5835]|0;e:do if(Xe){for(L=23764;;){if(T=o[L>>2]|0,R=o[L+4>>2]|0,(ue|0)==(T+R|0)){A=154;break}if(F=o[L+8>>2]|0,F)L=F;else break}if((A|0)==154&&(x=L+4|0,(o[L+12>>2]&8|0)==0)&&ue>>>0>Xe>>>0&T>>>0<=Xe>>>0){o[x>>2]=R+le,s=(o[5832]|0)+le|0,V=Xe+8|0,V=V&7|0?0-V&7:0,x=Xe+V|0,V=s-V|0,o[5835]=x,o[5832]=V,o[x+4>>2]=V|1,o[Xe+s+4>>2]=40,o[5836]=o[5951];break}for(ue>>>0<(o[5833]|0)>>>0&&(o[5833]=ue),R=ue+le|0,L=23764;;){if((o[L>>2]|0)==(R|0)){A=162;break}if(T=o[L+8>>2]|0,T)L=T;else break}if((A|0)==162&&!(o[L+12>>2]&8|0)){o[L>>2]=ue,kt=L+4|0,o[kt>>2]=(o[kt>>2]|0)+le,kt=ue+8|0,kt=ue+(kt&7|0?0-kt&7:0)|0,L=R+8|0,L=R+(L&7|0?0-L&7:0)|0,bt=kt+ri|0,Se=L-kt-ri|0,o[kt+4>>2]=ri|3;t:do if((Xe|0)==(L|0))s=(o[5832]|0)+Se|0,o[5832]=s,o[5835]=bt,o[bt+4>>2]=s|1;else{if((o[5834]|0)==(L|0)){s=(o[5831]|0)+Se|0,o[5831]=s,o[5834]=bt,o[bt+4>>2]=s|1,o[bt+s>>2]=s;break}if(T=o[L+4>>2]|0,(T&3|0)==1){le=T&-8,F=T>>>3;i:do if(T>>>0<256)if(T=o[L+8>>2]|0,R=o[L+12>>2]|0,(R|0)==(T|0)){o[5829]=o[5829]&~(1<<F);break}else{o[T+12>>2]=R,o[R+8>>2]=T;break}else{ue=o[L+24>>2]|0,T=o[L+12>>2]|0;do if((T|0)==(L|0)){if(R=L+16|0,F=R+4|0,T=o[F>>2]|0,T)R=F;else if(T=o[R>>2]|0,!T){T=0;break}for(;;)if(te=T+20|0,F=o[te>>2]|0,F)T=F,R=te;else if(te=T+16|0,F=o[te>>2]|0,F)T=F,R=te;else break;o[R>>2]=0}else s=o[L+8>>2]|0,o[s+12>>2]=T,o[T+8>>2]=s;while(!1);if(!ue)break;R=o[L+28>>2]|0,F=23620+(R<<2)|0;do if((o[F>>2]|0)!=(L|0)){if(s=ue+16|0,o[((o[s>>2]|0)==(L|0)?s:ue+20|0)>>2]=T,!T)break i}else{if(o[F>>2]=T,T|0)break;o[5830]=o[5830]&~(1<<R);break i}while(!1);if(o[T+24>>2]=ue,R=L+16|0,F=o[R>>2]|0,F|0&&(o[T+16>>2]=F,o[F+24>>2]=T),R=o[R+4>>2]|0,!R)break;o[T+20>>2]=R,o[R+24>>2]=T}while(!1);L=L+le|0,te=le+Se|0}else te=Se;if(L=L+4|0,o[L>>2]=o[L>>2]&-2,o[bt+4>>2]=te|1,o[bt+te>>2]=te,L=te>>>3,te>>>0<256){R=23356+(L<<1<<2)|0,T=o[5829]|0,L=1<<L,T&L?(T=R+8|0,L=o[T>>2]|0):(o[5829]=T|L,L=R,T=R+8|0),o[T>>2]=bt,o[L+12>>2]=bt,o[bt+8>>2]=L,o[bt+12>>2]=R;break}L=te>>>8;do if(!L)F=0;else{if(te>>>0>16777215){F=31;break}x=(L+1048320|0)>>>16&8,s=L<<x,V=(s+520192|0)>>>16&4,s=s<<V,F=(s+245760|0)>>>16&2,F=14-(V|x|F)+(s<<F>>>15)|0,F=te>>>(F+7|0)&1|F<<1}while(!1);if(L=23620+(F<<2)|0,o[bt+28>>2]=F,T=bt+16|0,o[T+4>>2]=0,o[T>>2]=0,T=o[5830]|0,R=1<<F,!(T&R)){o[5830]=T|R,o[L>>2]=bt,o[bt+24>>2]=L,o[bt+12>>2]=bt,o[bt+8>>2]=bt;break}L=o[L>>2]|0;i:do if((o[L+4>>2]&-8|0)!=(te|0)){for(F=te<<((F|0)==31?0:25-(F>>>1)|0);R=L+16+(F>>>31<<2)|0,T=o[R>>2]|0,!!T;)if((o[T+4>>2]&-8|0)==(te|0)){L=T;break i}else F=F<<1,L=T;o[R>>2]=bt,o[bt+24>>2]=L,o[bt+12>>2]=bt,o[bt+8>>2]=bt;break t}while(!1);x=L+8|0,s=o[x>>2]|0,o[s+12>>2]=bt,o[x>>2]=bt,o[bt+8>>2]=s,o[bt+12>>2]=L,o[bt+24>>2]=0}while(!1);return s=kt+8|0,Gt=i,s|0}for(L=23764;T=o[L>>2]|0,!(T>>>0<=Xe>>>0&&(s=T+(o[L+4>>2]|0)|0,s>>>0>Xe>>>0));)L=o[L+8>>2]|0;te=s+-47|0,T=te+8|0,T=te+(T&7|0?0-T&7:0)|0,te=Xe+16|0,T=T>>>0<te>>>0?Xe:T,L=T+8|0,R=le+-40|0,V=ue+8|0,V=V&7|0?0-V&7:0,x=ue+V|0,V=R-V|0,o[5835]=x,o[5832]=V,o[x+4>>2]=V|1,o[ue+R+4>>2]=40,o[5836]=o[5951],R=T+4|0,o[R>>2]=27,o[L>>2]=o[5941],o[L+4>>2]=o[5942],o[L+8>>2]=o[5943],o[L+12>>2]=o[5944],o[5941]=ue,o[5942]=le,o[5944]=0,o[5943]=L,L=T+24|0;do x=L,L=L+4|0,o[L>>2]=7;while((x+8|0)>>>0<s>>>0);if((T|0)!=(Xe|0)){if(ue=T-Xe|0,o[R>>2]=o[R>>2]&-2,o[Xe+4>>2]=ue|1,o[T>>2]=ue,L=ue>>>3,ue>>>0<256){R=23356+(L<<1<<2)|0,T=o[5829]|0,L=1<<L,T&L?(T=R+8|0,L=o[T>>2]|0):(o[5829]=T|L,L=R,T=R+8|0),o[T>>2]=Xe,o[L+12>>2]=Xe,o[Xe+8>>2]=L,o[Xe+12>>2]=R;break}if(L=ue>>>8,L?ue>>>0>16777215?F=31:(x=(L+1048320|0)>>>16&8,s=L<<x,V=(s+520192|0)>>>16&4,s=s<<V,F=(s+245760|0)>>>16&2,F=14-(V|x|F)+(s<<F>>>15)|0,F=ue>>>(F+7|0)&1|F<<1):F=0,R=23620+(F<<2)|0,o[Xe+28>>2]=F,o[Xe+20>>2]=0,o[te>>2]=0,L=o[5830]|0,T=1<<F,!(L&T)){o[5830]=L|T,o[R>>2]=Xe,o[Xe+24>>2]=R,o[Xe+12>>2]=Xe,o[Xe+8>>2]=Xe;break}L=o[R>>2]|0;t:do if((o[L+4>>2]&-8|0)!=(ue|0)){for(F=ue<<((F|0)==31?0:25-(F>>>1)|0);R=L+16+(F>>>31<<2)|0,T=o[R>>2]|0,!!T;)if((o[T+4>>2]&-8|0)==(ue|0)){L=T;break t}else F=F<<1,L=T;o[R>>2]=Xe,o[Xe+24>>2]=L,o[Xe+12>>2]=Xe,o[Xe+8>>2]=Xe;break e}while(!1);x=L+8|0,s=o[x>>2]|0,o[s+12>>2]=Xe,o[x>>2]=Xe,o[Xe+8>>2]=s,o[Xe+12>>2]=L,o[Xe+24>>2]=0}}else s=o[5833]|0,(s|0)==0|ue>>>0<s>>>0&&(o[5833]=ue),o[5941]=ue,o[5942]=le,o[5944]=0,o[5838]=o[5947],o[5837]=-1,o[5842]=23356,o[5841]=23356,o[5844]=23364,o[5843]=23364,o[5846]=23372,o[5845]=23372,o[5848]=23380,o[5847]=23380,o[5850]=23388,o[5849]=23388,o[5852]=23396,o[5851]=23396,o[5854]=23404,o[5853]=23404,o[5856]=23412,o[5855]=23412,o[5858]=23420,o[5857]=23420,o[5860]=23428,o[5859]=23428,o[5862]=23436,o[5861]=23436,o[5864]=23444,o[5863]=23444,o[5866]=23452,o[5865]=23452,o[5868]=23460,o[5867]=23460,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,s=le+-40|0,V=ue+8|0,V=V&7|0?0-V&7:0,x=ue+V|0,V=s-V|0,o[5835]=x,o[5832]=V,o[x+4>>2]=V|1,o[ue+s+4>>2]=40,o[5836]=o[5951];while(!1);if(L=o[5832]|0,L>>>0>ri>>>0)return V=L-ri|0,o[5832]=V,s=o[5835]|0,x=s+ri|0,o[5835]=x,o[x+4>>2]=V|1,o[s+4>>2]=ri|3,s=s+8|0,Gt=i,s|0}return s=br()|0,o[s>>2]=12,s=0,Gt=i,s|0}function ir(T){T=T|0;var L=0,R=0,F=0,te=0,ue=0,le=0,Se=0,Xe=0;if(T){R=T+-8|0,te=o[5833]|0,T=o[T+-4>>2]|0,L=T&-8,Xe=R+L|0;do if(T&1)Se=R,le=R;else{if(F=o[R>>2]|0,!(T&3)||(le=R+(0-F)|0,ue=F+L|0,le>>>0<te>>>0))return;if((o[5834]|0)==(le|0)){if(T=Xe+4|0,L=o[T>>2]|0,(L&3|0)!=3){Se=le,L=ue;break}o[5831]=ue,o[T>>2]=L&-2,o[le+4>>2]=ue|1,o[le+ue>>2]=ue;return}if(R=F>>>3,F>>>0<256)if(T=o[le+8>>2]|0,L=o[le+12>>2]|0,(L|0)==(T|0)){o[5829]=o[5829]&~(1<<R),Se=le,L=ue;break}else{o[T+12>>2]=L,o[L+8>>2]=T,Se=le,L=ue;break}te=o[le+24>>2]|0,T=o[le+12>>2]|0;do if((T|0)==(le|0)){if(L=le+16|0,R=L+4|0,T=o[R>>2]|0,T)L=R;else if(T=o[L>>2]|0,!T){T=0;break}for(;;)if(F=T+20|0,R=o[F>>2]|0,R)T=R,L=F;else if(F=T+16|0,R=o[F>>2]|0,R)T=R,L=F;else break;o[L>>2]=0}else Se=o[le+8>>2]|0,o[Se+12>>2]=T,o[T+8>>2]=Se;while(!1);if(te){if(L=o[le+28>>2]|0,R=23620+(L<<2)|0,(o[R>>2]|0)==(le|0)){if(o[R>>2]=T,!T){o[5830]=o[5830]&~(1<<L),Se=le,L=ue;break}}else if(Se=te+16|0,o[((o[Se>>2]|0)==(le|0)?Se:te+20|0)>>2]=T,!T){Se=le,L=ue;break}o[T+24>>2]=te,L=le+16|0,R=o[L>>2]|0,R|0&&(o[T+16>>2]=R,o[R+24>>2]=T),L=o[L+4>>2]|0,L?(o[T+20>>2]=L,o[L+24>>2]=T,Se=le,L=ue):(Se=le,L=ue)}else Se=le,L=ue}while(!1);if(!(le>>>0>=Xe>>>0)&&(T=Xe+4|0,F=o[T>>2]|0,!!(F&1))){if(F&2)o[T>>2]=F&-2,o[Se+4>>2]=L|1,o[le+L>>2]=L,te=L;else{if((o[5835]|0)==(Xe|0)){if(Xe=(o[5832]|0)+L|0,o[5832]=Xe,o[5835]=Se,o[Se+4>>2]=Xe|1,(Se|0)!=(o[5834]|0))return;o[5834]=0,o[5831]=0;return}if((o[5834]|0)==(Xe|0)){Xe=(o[5831]|0)+L|0,o[5831]=Xe,o[5834]=le,o[Se+4>>2]=Xe|1,o[le+Xe>>2]=Xe;return}te=(F&-8)+L|0,R=F>>>3;do if(F>>>0<256)if(L=o[Xe+8>>2]|0,T=o[Xe+12>>2]|0,(T|0)==(L|0)){o[5829]=o[5829]&~(1<<R);break}else{o[L+12>>2]=T,o[T+8>>2]=L;break}else{ue=o[Xe+24>>2]|0,T=o[Xe+12>>2]|0;do if((T|0)==(Xe|0)){if(L=Xe+16|0,R=L+4|0,T=o[R>>2]|0,T)L=R;else if(T=o[L>>2]|0,!T){R=0;break}for(;;)if(F=T+20|0,R=o[F>>2]|0,R)T=R,L=F;else if(F=T+16|0,R=o[F>>2]|0,R)T=R,L=F;else break;o[L>>2]=0,R=T}else R=o[Xe+8>>2]|0,o[R+12>>2]=T,o[T+8>>2]=R,R=T;while(!1);if(ue|0){if(T=o[Xe+28>>2]|0,L=23620+(T<<2)|0,(o[L>>2]|0)==(Xe|0)){if(o[L>>2]=R,!R){o[5830]=o[5830]&~(1<<T);break}}else if(F=ue+16|0,o[((o[F>>2]|0)==(Xe|0)?F:ue+20|0)>>2]=R,!R)break;o[R+24>>2]=ue,T=Xe+16|0,L=o[T>>2]|0,L|0&&(o[R+16>>2]=L,o[L+24>>2]=R),T=o[T+4>>2]|0,T|0&&(o[R+20>>2]=T,o[T+24>>2]=R)}}while(!1);if(o[Se+4>>2]=te|1,o[le+te>>2]=te,(Se|0)==(o[5834]|0)){o[5831]=te;return}}if(T=te>>>3,te>>>0<256){R=23356+(T<<1<<2)|0,L=o[5829]|0,T=1<<T,L&T?(L=R+8|0,T=o[L>>2]|0):(o[5829]=L|T,T=R,L=R+8|0),o[L>>2]=Se,o[T+12>>2]=Se,o[Se+8>>2]=T,o[Se+12>>2]=R;return}T=te>>>8,T?te>>>0>16777215?F=31:(le=(T+1048320|0)>>>16&8,Xe=T<<le,ue=(Xe+520192|0)>>>16&4,Xe=Xe<<ue,F=(Xe+245760|0)>>>16&2,F=14-(ue|le|F)+(Xe<<F>>>15)|0,F=te>>>(F+7|0)&1|F<<1):F=0,T=23620+(F<<2)|0,o[Se+28>>2]=F,o[Se+20>>2]=0,o[Se+16>>2]=0,L=o[5830]|0,R=1<<F;e:do if(!(L&R))o[5830]=L|R,o[T>>2]=Se,o[Se+24>>2]=T,o[Se+12>>2]=Se,o[Se+8>>2]=Se;else{T=o[T>>2]|0;t:do if((o[T+4>>2]&-8|0)!=(te|0)){for(F=te<<((F|0)==31?0:25-(F>>>1)|0);R=T+16+(F>>>31<<2)|0,L=o[R>>2]|0,!!L;)if((o[L+4>>2]&-8|0)==(te|0)){T=L;break t}else F=F<<1,T=L;o[R>>2]=Se,o[Se+24>>2]=T,o[Se+12>>2]=Se,o[Se+8>>2]=Se;break e}while(!1);le=T+8|0,Xe=o[le>>2]|0,o[Xe+12>>2]=Se,o[le>>2]=Se,o[Se+8>>2]=Xe,o[Se+12>>2]=T,o[Se+24>>2]=0}while(!1);if(Xe=(o[5837]|0)+-1|0,o[5837]=Xe,!(Xe|0)){for(T=23772;T=o[T>>2]|0,T;)T=T+8|0;o[5837]=-1}}}}function il(T,L){T=T|0,L=L|0;var R=0;return T?(R=Yr(L,T)|0,(L|T)>>>0>65535&&(R=((R>>>0)/(T>>>0)|0|0)==(L|0)?R:-1)):R=0,T=Zn(R)|0,!T||!(o[T+-4>>2]&3)||ms(T|0,0,R|0)|0,T|0}function Pu(T,L,R,F){return T=T|0,L=L|0,R=R|0,F=F|0,R=T+R>>>0,Gn(L+F+(R>>>0<T>>>0|0)>>>0|0),R|0|0}function fa(T,L,R,F){return T=T|0,L=L|0,R=R|0,F=F|0,F=L-F-(R>>>0>T>>>0|0)>>>0,Gn(F|0),T-R>>>0|0|0}function bu(T){return T=T|0,(T?31-(hr(T^T-1)|0)|0:32)|0}function Is(T,L,R,F,te){T=T|0,L=L|0,R=R|0,F=F|0,te=te|0;var ue=0,le=0,Se=0,Xe=0,bt=0,kt=0,ri=0,Ht=0,Qt=0,Q=0;if(kt=T,Xe=L,bt=Xe,le=R,Ht=F,Se=Ht,!bt)return ue=(te|0)!=0,Se?ue?(o[te>>2]=T|0,o[te+4>>2]=L&0,Ht=0,te=0,Gn(Ht|0),te|0):(Ht=0,te=0,Gn(Ht|0),te|0):(ue&&(o[te>>2]=(kt>>>0)%(le>>>0),o[te+4>>2]=0),Ht=0,te=(kt>>>0)/(le>>>0)>>>0,Gn(Ht|0),te|0);ue=(Se|0)==0;do if(le){if(!ue){if(ue=(hr(Se|0)|0)-(hr(bt|0)|0)|0,ue>>>0<=31){ri=ue+1|0,Se=31-ue|0,L=ue-31>>31,le=ri,T=kt>>>(ri>>>0)&L|bt<<Se,L=bt>>>(ri>>>0)&L,ue=0,Se=kt<<Se;break}return te?(o[te>>2]=T|0,o[te+4>>2]=Xe|L&0,Ht=0,te=0,Gn(Ht|0),te|0):(Ht=0,te=0,Gn(Ht|0),te|0)}if(ue=le-1|0,ue&le|0){Se=(hr(le|0)|0)+33-(hr(bt|0)|0)|0,Q=64-Se|0,ri=32-Se|0,Xe=ri>>31,Qt=Se-32|0,L=Qt>>31,le=Se,T=ri-1>>31&bt>>>(Qt>>>0)|(bt<<ri|kt>>>(Se>>>0))&L,L=L&bt>>>(Se>>>0),ue=kt<<Q&Xe,Se=(bt<<Q|kt>>>(Qt>>>0))&Xe|kt<<ri&Se-33>>31;break}return te|0&&(o[te>>2]=ue&kt,o[te+4>>2]=0),(le|0)==1?(Qt=Xe|L&0,Q=T|0|0,Gn(Qt|0),Q|0):(Q=bu(le|0)|0,Qt=bt>>>(Q>>>0)|0,Q=bt<<32-Q|kt>>>(Q>>>0)|0,Gn(Qt|0),Q|0)}else{if(ue)return te|0&&(o[te>>2]=(bt>>>0)%(le>>>0),o[te+4>>2]=0),Qt=0,Q=(bt>>>0)/(le>>>0)>>>0,Gn(Qt|0),Q|0;if(!kt)return te|0&&(o[te>>2]=0,o[te+4>>2]=(bt>>>0)%(Se>>>0)),Qt=0,Q=(bt>>>0)/(Se>>>0)>>>0,Gn(Qt|0),Q|0;if(ue=Se-1|0,!(ue&Se))return te|0&&(o[te>>2]=T|0,o[te+4>>2]=ue&bt|L&0),Qt=0,Q=bt>>>((bu(Se|0)|0)>>>0),Gn(Qt|0),Q|0;if(ue=(hr(Se|0)|0)-(hr(bt|0)|0)|0,ue>>>0<=30){L=ue+1|0,Se=31-ue|0,le=L,T=bt<<Se|kt>>>(L>>>0),L=bt>>>(L>>>0),ue=0,Se=kt<<Se;break}return te?(o[te>>2]=T|0,o[te+4>>2]=Xe|L&0,Qt=0,Q=0,Gn(Qt|0),Q|0):(Qt=0,Q=0,Gn(Qt|0),Q|0)}while(!1);if(!le)bt=Se,Xe=0,Se=0;else{ri=R|0|0,kt=Ht|F&0,bt=Pu(ri|0,kt|0,-1,-1)|0,R=Xt()|0,Xe=Se,Se=0;do F=Xe,Xe=ue>>>31|Xe<<1,ue=Se|ue<<1,F=T<<1|F>>>31|0,Ht=T>>>31|L<<1|0,fa(bt|0,R|0,F|0,Ht|0)|0,Q=Xt()|0,Qt=Q>>31|((Q|0)<0?-1:0)<<1,Se=Qt&1,T=fa(F|0,Ht|0,Qt&ri|0,(((Q|0)<0?-1:0)>>31|((Q|0)<0?-1:0)<<1)&kt|0)|0,L=Xt()|0,le=le-1|0;while(le|0);bt=Xe,Xe=0}return le=0,te|0&&(o[te>>2]=T,o[te+4>>2]=L),Qt=(ue|0)>>>31|(bt|le)<<1|(le<<1|ue>>>31)&0|Xe,Q=(ue<<1|0)&-2|Se,Gn(Qt|0),Q|0}function Bo(T,L,R,F){T=T|0,L=L|0,R=R|0,F=F|0;var te=0,ue=0;return ue=Gt,Gt=Gt+16|0,te=ue|0,Is(T,L,R,F,te)|0,Gt=ue,Gn(o[te+4>>2]|0),o[te>>2]|0|0}function Mi(T,L,R){return T=T|0,L=L|0,R=R|0,(R|0)<32?(Gn(L>>>R|0),T>>>R|(L&(1<<R)-1)<<32-R):(Gn(0),L>>>R-32|0)}function zi(T,L,R){return T=T|0,L=L|0,R=R|0,(R|0)<32?(Gn(L<<R|(T&(1<<R)-1<<32-R)>>>32-R|0),T<<R):(Gn(T<<R-32|0),0)}function Es(T,L){return T=+T,L=+L,T!=T?+L:L!=L?+T:+Qi(+T,+L)}function wu(T){return T=+T,T>=0?+di(T+.5):+Hn(T-.5)}function Uo(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0;if((R|0)>=8192)return Ar(T|0,L|0,R|0)|0,T|0;if(ue=T|0,te=T+R|0,(T&3)==(L&3)){for(;T&3;){if(!R)return ue|0;Pt[T>>0]=Pt[L>>0]|0,T=T+1|0,L=L+1|0,R=R-1|0}for(R=te&-4|0,F=R-64|0;(T|0)<=(F|0);)o[T>>2]=o[L>>2],o[T+4>>2]=o[L+4>>2],o[T+8>>2]=o[L+8>>2],o[T+12>>2]=o[L+12>>2],o[T+16>>2]=o[L+16>>2],o[T+20>>2]=o[L+20>>2],o[T+24>>2]=o[L+24>>2],o[T+28>>2]=o[L+28>>2],o[T+32>>2]=o[L+32>>2],o[T+36>>2]=o[L+36>>2],o[T+40>>2]=o[L+40>>2],o[T+44>>2]=o[L+44>>2],o[T+48>>2]=o[L+48>>2],o[T+52>>2]=o[L+52>>2],o[T+56>>2]=o[L+56>>2],o[T+60>>2]=o[L+60>>2],T=T+64|0,L=L+64|0;for(;(T|0)<(R|0);)o[T>>2]=o[L>>2],T=T+4|0,L=L+4|0}else for(R=te-4|0;(T|0)<(R|0);)Pt[T>>0]=Pt[L>>0]|0,Pt[T+1>>0]=Pt[L+1>>0]|0,Pt[T+2>>0]=Pt[L+2>>0]|0,Pt[T+3>>0]=Pt[L+3>>0]|0,T=T+4|0,L=L+4|0;for(;(T|0)<(te|0);)Pt[T>>0]=Pt[L>>0]|0,T=T+1|0,L=L+1|0;return ue|0}function ms(T,L,R){T=T|0,L=L|0,R=R|0;var F=0,te=0,ue=0,le=0;if(ue=T+R|0,L=L&255,(R|0)>=67){for(;T&3;)Pt[T>>0]=L,T=T+1|0;for(F=ue&-4|0,le=L|L<<8|L<<16|L<<24,te=F-64|0;(T|0)<=(te|0);)o[T>>2]=le,o[T+4>>2]=le,o[T+8>>2]=le,o[T+12>>2]=le,o[T+16>>2]=le,o[T+20>>2]=le,o[T+24>>2]=le,o[T+28>>2]=le,o[T+32>>2]=le,o[T+36>>2]=le,o[T+40>>2]=le,o[T+44>>2]=le,o[T+48>>2]=le,o[T+52>>2]=le,o[T+56>>2]=le,o[T+60>>2]=le,T=T+64|0;for(;(T|0)<(F|0);)o[T>>2]=le,T=T+4|0}for(;(T|0)<(ue|0);)Pt[T>>0]=L,T=T+1|0;return ue-R|0}function Al(T){return T=+T,T>=0?+di(T+.5):+Hn(T-.5)}function zs(T){T=T|0;var L=0,R=0,F=0;return F=kn()|0,R=o[li>>2]|0,L=R+T|0,(T|0)>0&(L|0)<(R|0)|(L|0)<0?(Qr(L|0)|0,qt(12),-1):(L|0)>(F|0)&&!(js(L|0)|0)?(qt(12),-1):(o[li>>2]=L,R|0)}return{___uremdi3:Bo,_bitshift64Lshr:Mi,_bitshift64Shl:zi,_calloc:il,_cellAreaKm2:Ul,_cellAreaM2:as,_cellAreaRads2:qn,_compact:Pl,_destroyLinkedPolygon:cr,_edgeLengthKm:to,_edgeLengthM:ss,_emscripten_replace_memory:fr,_exactEdgeLengthKm:Ls,_exactEdgeLengthM:Br,_exactEdgeLengthRads:Kr,_experimentalH3ToLocalIj:ro,_experimentalLocalIjToH3:bo,_free:ir,_geoToH3:ga,_getDestinationH3IndexFromUnidirectionalEdge:Di,_getH3IndexesFromUnidirectionalEdge:ni,_getH3UnidirectionalEdge:mi,_getH3UnidirectionalEdgeBoundary:Ui,_getH3UnidirectionalEdgesFromHexagon:wi,_getOriginH3IndexFromUnidirectionalEdge:qi,_getPentagonIndexes:_l,_getRes0Indexes:dr,_h3Distance:cs,_h3GetBaseCell:ul,_h3GetFaces:hl,_h3GetResolution:ar,_h3IndexesAreNeighbors:ho,_h3IsPentagon:gs,_h3IsResClassIII:vo,_h3IsValid:is,_h3Line:Nu,_h3LineSize:Yu,_h3SetToLinkedGeo:$a,_h3ToCenterChild:ka,_h3ToChildren:Jr,_h3ToGeo:Ma,_h3ToGeoBoundary:Oa,_h3ToParent:Do,_h3UnidirectionalEdgeIsValid:Nt,_hexAreaKm2:Jo,_hexAreaM2:Vr,_hexRing:Aa,_i64Subtract:fa,_kRing:Za,_kRingDistances:Oo,_llvm_minnum_f64:Es,_llvm_round_f64:wu,_malloc:Zn,_maxFaceCount:no,_maxH3ToChildrenSize:cl,_maxKringSize:Fr,_maxPolyfillSize:ds,_maxUncompactSize:Dl,_memcpy:Uo,_memset:ms,_numHexagons:pr,_pentagonIndexCount:cu,_pointDistKm:Ds,_pointDistM:vu,_pointDistRads:eo,_polyfill:Wa,_res0IndexCount:or,_round:Al,_sbrk:zs,_sizeOfCoordIJ:hu,_sizeOfGeoBoundary:Cn,_sizeOfGeoCoord:Gl,_sizeOfGeoPolygon:Tn,_sizeOfGeofence:Yl,_sizeOfH3Index:Vo,_sizeOfLinkedGeoPolygon:yl,_uncompact:Lo,establishStackSpace:pa,stackAlloc:Bt,stackRestore:Zs,stackSave:Gr}}(ot,Pe,yt);e.___uremdi3=ae.___uremdi3,e._bitshift64Lshr=ae._bitshift64Lshr,e._bitshift64Shl=ae._bitshift64Shl,e._calloc=ae._calloc,e._cellAreaKm2=ae._cellAreaKm2,e._cellAreaM2=ae._cellAreaM2,e._cellAreaRads2=ae._cellAreaRads2,e._compact=ae._compact,e._destroyLinkedPolygon=ae._destroyLinkedPolygon,e._edgeLengthKm=ae._edgeLengthKm,e._edgeLengthM=ae._edgeLengthM;var re=e._emscripten_replace_memory=ae._emscripten_replace_memory;e._exactEdgeLengthKm=ae._exactEdgeLengthKm,e._exactEdgeLengthM=ae._exactEdgeLengthM,e._exactEdgeLengthRads=ae._exactEdgeLengthRads,e._experimentalH3ToLocalIj=ae._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=ae._experimentalLocalIjToH3,e._free=ae._free,e._geoToH3=ae._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=ae._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=ae._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=ae._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=ae._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=ae._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=ae._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=ae._getPentagonIndexes,e._getRes0Indexes=ae._getRes0Indexes,e._h3Distance=ae._h3Distance,e._h3GetBaseCell=ae._h3GetBaseCell,e._h3GetFaces=ae._h3GetFaces,e._h3GetResolution=ae._h3GetResolution,e._h3IndexesAreNeighbors=ae._h3IndexesAreNeighbors,e._h3IsPentagon=ae._h3IsPentagon,e._h3IsResClassIII=ae._h3IsResClassIII,e._h3IsValid=ae._h3IsValid,e._h3Line=ae._h3Line,e._h3LineSize=ae._h3LineSize,e._h3SetToLinkedGeo=ae._h3SetToLinkedGeo,e._h3ToCenterChild=ae._h3ToCenterChild,e._h3ToChildren=ae._h3ToChildren,e._h3ToGeo=ae._h3ToGeo,e._h3ToGeoBoundary=ae._h3ToGeoBoundary,e._h3ToParent=ae._h3ToParent,e._h3UnidirectionalEdgeIsValid=ae._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=ae._hexAreaKm2,e._hexAreaM2=ae._hexAreaM2,e._hexRing=ae._hexRing,e._i64Subtract=ae._i64Subtract,e._kRing=ae._kRing,e._kRingDistances=ae._kRingDistances,e._llvm_minnum_f64=ae._llvm_minnum_f64,e._llvm_round_f64=ae._llvm_round_f64,e._malloc=ae._malloc,e._maxFaceCount=ae._maxFaceCount,e._maxH3ToChildrenSize=ae._maxH3ToChildrenSize,e._maxKringSize=ae._maxKringSize,e._maxPolyfillSize=ae._maxPolyfillSize,e._maxUncompactSize=ae._maxUncompactSize,e._memcpy=ae._memcpy,e._memset=ae._memset,e._numHexagons=ae._numHexagons,e._pentagonIndexCount=ae._pentagonIndexCount,e._pointDistKm=ae._pointDistKm,e._pointDistM=ae._pointDistM,e._pointDistRads=ae._pointDistRads,e._polyfill=ae._polyfill,e._res0IndexCount=ae._res0IndexCount,e._round=ae._round,e._sbrk=ae._sbrk,e._sizeOfCoordIJ=ae._sizeOfCoordIJ,e._sizeOfGeoBoundary=ae._sizeOfGeoBoundary,e._sizeOfGeoCoord=ae._sizeOfGeoCoord,e._sizeOfGeoPolygon=ae._sizeOfGeoPolygon,e._sizeOfGeofence=ae._sizeOfGeofence,e._sizeOfH3Index=ae._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=ae._sizeOfLinkedGeoPolygon,e._uncompact=ae._uncompact,e.establishStackSpace=ae.establishStackSpace;var X=e.stackAlloc=ae.stackAlloc,ne=e.stackRestore=ae.stackRestore,pe=e.stackSave=ae.stackSave;if(e.asm=ae,e.cwrap=xt,e.setValue=_e,e.getValue=Ze,e.getTempRet0=oe,Yi){zn(Yi)||(Yi=v(Yi));{$n();var xe=function(Le){Le.byteLength&&(Le=new Uint8Array(Le)),ut.set(Le,ce),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,oi()},ye=function(){S(Yi,xe,function(){throw"could not load memory initializer "+Yi})},De=mt(Yi);if(De)xe(De.buffer);else if(e.memoryInitializerRequest){var Oe=function(){var Le=e.memoryInitializerRequest,qe=Le.response;if(Le.status!==200&&Le.status!==0){var dt=mt(e.memoryInitializerRequestURL);if(dt)qe=dt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Le.status+", retrying "+Yi),ye();return}}xe(qe)};e.memoryInitializerRequest.response?setTimeout(Oe,0):e.memoryInitializerRequest.addEventListener("load",Oe)}else ye()}}var Ve;an=function Le(){Ve||Je(),Ve||(an=Le)};function Je(Le){if(Ot>0||(sn(),Ot>0))return;function qe(){Ve||(Ve=!0,!nt&&(xn(),Ti(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),gi()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),qe()},1)):qe()}e.run=Je;function et(Le){throw e.onAbort&&e.onAbort(Le),Le+="",a(Le),N(Le),nt=!0,"abort("+Le+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=et,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Je(),t}(typeof Ln=="object"?Ln:{}),zr="number",sg=zr,hs=zr,Gs=zr,Uc=zr,Ea=zr,IN=[["sizeOfH3Index",zr],["sizeOfGeoCoord",zr],["sizeOfGeoBoundary",zr],["sizeOfGeoPolygon",zr],["sizeOfGeofence",zr],["sizeOfLinkedGeoPolygon",zr],["sizeOfCoordIJ",zr],["h3IsValid",sg,[hs,Gs]],["geoToH3",hs,[zr,zr,Uc]],["h3ToGeo",null,[hs,Gs,Ea]],["h3ToGeoBoundary",null,[hs,Gs,Ea]],["maxKringSize",zr,[zr]],["kRing",null,[hs,Gs,zr,Ea]],["kRingDistances",null,[hs,Gs,zr,Ea,Ea]],["hexRing",null,[hs,Gs,zr,Ea]],["maxPolyfillSize",zr,[Ea,Uc]],["polyfill",null,[Ea,Uc,Ea]],["h3SetToLinkedGeo",null,[Ea,zr,Ea]],["destroyLinkedPolygon",null,[Ea]],["compact",zr,[Ea,Ea,zr]],["uncompact",zr,[Ea,zr,Ea,zr,Uc]],["maxUncompactSize",zr,[Ea,zr,Uc]],["h3IsPentagon",sg,[hs,Gs]],["h3IsResClassIII",sg,[hs,Gs]],["h3GetBaseCell",zr,[hs,Gs]],["h3GetResolution",zr,[hs,Gs]],["maxFaceCount",zr,[hs,Gs]],["h3GetFaces",null,[hs,Gs,Ea]],["h3ToParent",hs,[hs,Gs,Uc]],["h3ToChildren",null,[hs,Gs,Uc,Ea]],["h3ToCenterChild",hs,[hs,Gs,Uc]],["maxH3ToChildrenSize",zr,[hs,Gs,Uc]],["h3IndexesAreNeighbors",sg,[hs,Gs,hs,Gs]],["getH3UnidirectionalEdge",hs,[hs,Gs,hs,Gs]],["getOriginH3IndexFromUnidirectionalEdge",hs,[hs,Gs]],["getDestinationH3IndexFromUnidirectionalEdge",hs,[hs,Gs]],["h3UnidirectionalEdgeIsValid",sg,[hs,Gs]],["getH3IndexesFromUnidirectionalEdge",null,[hs,Gs,Ea]],["getH3UnidirectionalEdgesFromHexagon",null,[hs,Gs,Ea]],["getH3UnidirectionalEdgeBoundary",null,[hs,Gs,Ea]],["h3Distance",zr,[hs,Gs,hs,Gs]],["h3Line",zr,[hs,Gs,hs,Gs,Ea]],["h3LineSize",zr,[hs,Gs,hs,Gs]],["experimentalH3ToLocalIj",zr,[hs,Gs,hs,Gs,Ea]],["experimentalLocalIjToH3",zr,[hs,Gs,Ea,Ea]],["hexAreaM2",zr,[Uc]],["hexAreaKm2",zr,[Uc]],["edgeLengthM",zr,[Uc]],["edgeLengthKm",zr,[Uc]],["pointDistM",zr,[Ea,Ea]],["pointDistKm",zr,[Ea,Ea]],["pointDistRads",zr,[Ea,Ea]],["cellAreaM2",zr,[hs,Gs]],["cellAreaKm2",zr,[hs,Gs]],["cellAreaRads2",zr,[hs,Gs]],["exactEdgeLengthM",zr,[hs,Gs]],["exactEdgeLengthKm",zr,[hs,Gs]],["exactEdgeLengthRads",zr,[hs,Gs]],["numHexagons",zr,[Uc]],["getRes0Indexes",null,[Ea]],["res0IndexCount",zr],["getPentagonIndexes",null,[zr,Ea]],["pentagonIndexCount",zr]],lr={};IN.forEach(function(e){lr[e[0]]=Ln.cwrap.apply(Ln,e)});var cm=16,vc=4,zw=4,Q0=8,ac=lr.sizeOfH3Index(),v1=lr.sizeOfGeoCoord(),P5=lr.sizeOfGeoBoundary(),EN=lr.sizeOfGeoPolygon(),_g=lr.sizeOfGeofence(),CN=lr.sizeOfLinkedGeoPolygon(),D5=lr.sizeOfCoordIJ(),Hc={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Pm(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var TN=/[^0-9a-fA-F]/;function ba(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||TN.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),cm),n=parseInt(t.substring(t.length-8),cm);return[n,e]}function Rw(t){if(t>=0)return t.toString(cm);t=t&2147483647;var e=L5(8,t.toString(cm)),n=(parseInt(e[0],cm)+8).toString(cm);return e=n+e.substring(1),e}function x1(t,e){return Rw(e)+L5(8,Rw(t))}function L5(t,e){for(var n=t-e.length,c="",g=0;g<n;g++)c+="0";return c=c+e,c}function Fw(t,e,n){for(var c=t.length,g=Ln._calloc(c,v1),v=n?1:0,S=n?0:1,a=0;a<c*2;a+=2)Ln.HEAPF64.set([t[a/2][v],t[a/2][S]].map(b1),g/Q0+a);return Ln.HEAPU32.set([c,g],e/vc),e}function kN(t,e){var n=t.length-1,c=Ln._calloc(EN),g=0,v=g+_g,S=v+vc;Fw(t[0],c+g,e);var a;if(n>0){a=Ln._calloc(n,_g);for(var N=0;N<n;N++)Fw(t[N+1],a+_g*N,e)}return Ln.setValue(c+v,n,"i32"),Ln.setValue(c+S,a,"i32"),c}function MN(t){var e=0,n=e+_g,c=n+vc,g=vc;Ln._free(Ln.getValue(t+e+g,"i8*"));var v=Ln.getValue(t+n,"i32");if(v>0){for(var S=Ln.getValue(t+c,"i32"),a=0;a<v;a++)Ln._free(Ln.getValue(S+_g*a+g,"i8*"));Ln._free(S)}Ln._free(t)}function B5(t){var e=Ln.getTempRet0();return[t,e]}function Dm(t){var e=B5(t),n=e[0],c=e[1];return c?x1(n,c):null}function z5(t,e){e===void 0&&(e=0);var n=Ln.getValue(t+vc*e*2,"i32"),c=Ln.getValue(t+vc*(e*2+1),"i32");return c?x1(n,c):null}function PN(t,e,n){Ln.HEAPU32.set(ba(t),e/vc+2*n)}function _A(t,e){for(var n=[],c=0;c<e;c++){var g=z5(t,c);g!==null&&n.push(g)}return n}function P2(t,e){for(var n=e.length,c=0;c<n;c++)PN(e[c],t,c)}function Ow(t,e){var n=Ln._calloc(1,v1);return Ln.HEAPF64.set([t,e].map(b1),n/Q0),n}function $_(t){return N5(Ln.getValue(t,"double"))}function D2(t){return[$_(t),$_(t+Q0)]}function R5(t){return[$_(t+Q0),$_(t)]}function F5(t,e,n){for(var c=Ln.getValue(t,"i32"),g=t+Q0,v=[],S=e?R5:D2,a=0;a<c*2;a+=2)v.push(S(g+Q0*a));return n&&v.push(v[0]),v}function DN(t,e){for(var n=[],c=e?R5:D2,g,v,S,a;t;){for(n.push(g=[]),v=Ln.getValue(t,"i8*");v;){for(g.push(S=[]),a=Ln.getValue(v,"i8*");a;)S.push(c(a)),a=Ln.getValue(a+Q0*2,"i8*");e&&S.push(S[0]),v=Ln.getValue(v+zw*2,"i8*")}t=Ln.getValue(t+zw*2,"i8*")}return n}function LN(t){return{i:Ln.getValue(t,"i32"),j:Ln.getValue(t+vc,"i32")}}function BN(t,e){var n=e.i,c=e.j;Ln.setValue(t,n,"i32"),Ln.setValue(t+vc,c,"i32")}function zN(t,e){for(var n=[],c=0;c<e;c++){var g=Ln.getValue(t+vc*c,"i32");g>=0&&n.push(g)}return n}function O5(t){var e=ba(t),n=e[0],c=e[1];return!!lr.h3IsValid(n,c)}function RN(t){var e=ba(t),n=e[0],c=e[1];return!!lr.h3IsPentagon(n,c)}function FN(t){var e=ba(t),n=e[0],c=e[1];return!!lr.h3IsResClassIII(n,c)}function ON(t){var e=ba(t),n=e[0],c=e[1];return lr.h3GetBaseCell(n,c)}function NN(t){var e=ba(t),n=e[0],c=e[1],g=lr.maxFaceCount(n,c),v=Ln._malloc(vc*g);lr.h3GetFaces(n,c,v);var S=zN(v,g);return Ln._free(v),S}function VN(t){var e=ba(t),n=e[0],c=e[1];return lr.h3IsValid(n,c)?lr.h3GetResolution(n,c):-1}function UN(t,e,n){var c=Ln._malloc(v1);Ln.HEAPF64.set([t,e].map(b1),c/Q0);var g=Dm(lr.geoToH3(c,n));return Ln._free(c),g}function GN(t){var e=Ln._malloc(v1),n=ba(t),c=n[0],g=n[1];lr.h3ToGeo(c,g,e);var v=D2(e);return Ln._free(e),v}function qN(t,e){var n=Ln._malloc(P5),c=ba(t),g=c[0],v=c[1];lr.h3ToGeoBoundary(g,v,n);var S=F5(n,e,e);return Ln._free(n),S}function HN(t,e){var n=ba(t),c=n[0],g=n[1];return Dm(lr.h3ToParent(c,g,e))}function jN(t,e){if(!O5(t))return[];var n=ba(t),c=n[0],g=n[1],v=lr.maxH3ToChildrenSize(c,g,e),S=Ln._calloc(v,ac);lr.h3ToChildren(c,g,e,S);var a=_A(S,v);return Ln._free(S),a}function ZN(t,e){var n=ba(t),c=n[0],g=n[1];return Dm(lr.h3ToCenterChild(c,g,e))}function QN(t,e){var n=ba(t),c=n[0],g=n[1],v=lr.maxKringSize(e),S=Ln._calloc(v,ac);lr.kRing(c,g,e,S);var a=_A(S,v);return Ln._free(S),a}function WN(t,e){var n=ba(t),c=n[0],g=n[1],v=lr.maxKringSize(e),S=Ln._calloc(v,ac),a=Ln._calloc(v,vc);lr.kRingDistances(c,g,e,S,a);for(var N=[],$=0;$<e+1;$++)N.push([]);for(var he=0;he<v*2;he+=2){var oe=Ln.getValue(S+vc*he,"i32"),ce=Ln.getValue(S+vc*(he+1),"i32"),_e=Ln.getValue(a+vc*(he/2),"i32");(oe!==0||ce!==0)&&N[_e].push(x1(oe,ce))}return Ln._free(S),Ln._free(a),N}function $N(t,e){var n=e===0?1:6*e,c=Ln._calloc(n,ac),g=lr.hexRing.apply(lr,ba(t).concat([e],[c]));if(g!==0)throw Ln._free(c),new Error("Failed to get hexRing (encountered a pentagon?)");var v=_A(c,n);return Ln._free(c),v}function XN(t,e,n){if(Pm(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var c=kN(t,n),g=lr.maxPolyfillSize(c,e),v=Ln._calloc(g,ac);lr.polyfill(c,e,v);var S=_A(v,g);return Ln._free(v),MN(c),S}function YN(t,e){if(!t||!t.length)return[];var n=t.length,c=Ln._calloc(n,ac);P2(c,t);var g=Ln._calloc(CN),v=g;lr.h3SetToLinkedGeo(c,n,g);var S=DN(g,e);return lr.destroyLinkedPolygon(v),Ln._free(v),Ln._free(c),S}function KN(t){if(!t||!t.length)return[];var e=t.length,n=Ln._calloc(e,ac);P2(n,t);var c=Ln._calloc(e,ac),g=lr.compact(n,c,e);if(g!==0)throw Ln._free(n),Ln._free(c),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var v=_A(c,e);return Ln._free(n),Ln._free(c),v}function JN(t,e){if(Pm(e),!t||!t.length)return[];var n=t.length,c=Ln._calloc(n,ac);P2(c,t);var g=lr.maxUncompactSize(c,n,e),v=Ln._calloc(g,ac),S=lr.uncompact(c,n,v,g,e);if(S!==0)throw Ln._free(c),Ln._free(v),new Error("Failed to uncompact (bad resolution?)");var a=_A(v,g);return Ln._free(c),Ln._free(v),a}function eV(t,e){var n=ba(t),c=n[0],g=n[1],v=ba(e),S=v[0],a=v[1];return!!lr.h3IndexesAreNeighbors(c,g,S,a)}function tV(t,e){var n=ba(t),c=n[0],g=n[1],v=ba(e),S=v[0],a=v[1];return Dm(lr.getH3UnidirectionalEdge(c,g,S,a))}function iV(t){var e=ba(t),n=e[0],c=e[1];return Dm(lr.getOriginH3IndexFromUnidirectionalEdge(n,c))}function nV(t){var e=ba(t),n=e[0],c=e[1];return Dm(lr.getDestinationH3IndexFromUnidirectionalEdge(n,c))}function rV(t){var e=ba(t),n=e[0],c=e[1];return!!lr.h3UnidirectionalEdgeIsValid(n,c)}function sV(t){var e=ba(t),n=e[0],c=e[1],g=2,v=Ln._calloc(g,ac);lr.getH3IndexesFromUnidirectionalEdge(n,c,v);var S=_A(v,g);return Ln._free(v),S}function aV(t){var e=ba(t),n=e[0],c=e[1],g=6,v=Ln._calloc(g,ac);lr.getH3UnidirectionalEdgesFromHexagon(n,c,v);var S=_A(v,g);return Ln._free(v),S}function oV(t,e){var n=Ln._malloc(P5),c=ba(t),g=c[0],v=c[1];lr.getH3UnidirectionalEdgeBoundary(g,v,n);var S=F5(n,e);return Ln._free(n),S}function lV(t,e){var n=ba(t),c=n[0],g=n[1],v=ba(e),S=v[0],a=v[1];return lr.h3Distance(c,g,S,a)}function uV(t,e){var n=ba(t),c=n[0],g=n[1],v=ba(e),S=v[0],a=v[1],N=lr.h3LineSize(c,g,S,a);if(N<0)throw new Error("Line cannot be calculated");var $=Ln._calloc(N,ac);lr.h3Line(c,g,S,a,$);var he=_A($,N);return Ln._free($),he}function cV(t,e){var n=Ln._malloc(D5),c=lr.experimentalH3ToLocalIj.apply(lr,ba(t).concat(ba(e),[n])),g=LN(n);switch(Ln._free(n),c){case 0:return g;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function hV(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=Ln._malloc(D5),c=Ln._malloc(ac);BN(n,e);var g=lr.experimentalLocalIjToH3.apply(lr,ba(t).concat([n],[c])),v=z5(c);if(Ln._free(n),Ln._free(c),g!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return v}function AV(t,e,n){var c=Ow(t[0],t[1]),g=Ow(e[0],e[1]),v;switch(n){case Hc.m:v=lr.pointDistM(c,g);break;case Hc.km:v=lr.pointDistKm(c,g);break;case Hc.rads:v=lr.pointDistRads(c,g);break;default:v=null}if(Ln._free(c),Ln._free(g),v===null)throw new Error("Unknown unit: "+n);return v}function fV(t,e){var n=ba(t),c=n[0],g=n[1];switch(e){case Hc.m2:return lr.cellAreaM2(c,g);case Hc.km2:return lr.cellAreaKm2(c,g);case Hc.rads2:return lr.cellAreaRads2(c,g);default:throw new Error("Unknown unit: "+e)}}function dV(t,e){var n=ba(t),c=n[0],g=n[1];switch(e){case Hc.m:return lr.exactEdgeLengthM(c,g);case Hc.km:return lr.exactEdgeLengthKm(c,g);case Hc.rads:return lr.exactEdgeLengthRads(c,g);default:throw new Error("Unknown unit: "+e)}}function pV(t,e){switch(Pm(t),e){case Hc.m2:return lr.hexAreaM2(t);case Hc.km2:return lr.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function mV(t,e){switch(Pm(t),e){case Hc.m:return lr.edgeLengthM(t);case Hc.km:return lr.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function gV(t){Pm(t);var e=B5(lr.numHexagons(t)),n=e[0],c=e[1];return c?c*Math.pow(2,32)+n:n}function _V(){var t=lr.res0IndexCount(),e=Ln._malloc(ac*t);lr.getRes0Indexes(e);var n=_A(e,t);return Ln._free(e),n}function yV(t){Pm(t);var e=lr.pentagonIndexCount(),n=Ln._malloc(ac*e);lr.getPentagonIndexes(t,n);var c=_A(n,e);return Ln._free(n),c}function b1(t){return t*Math.PI/180}function N5(t){return t*180/Math.PI}const vV=Object.freeze(Object.defineProperty({__proto__:null,UNITS:Hc,cellArea:fV,compact:KN,degsToRads:b1,edgeLength:mV,exactEdgeLength:dV,experimentalH3ToLocalIj:cV,experimentalLocalIjToH3:hV,geoToH3:UN,getDestinationH3IndexFromUnidirectionalEdge:nV,getH3IndexesFromUnidirectionalEdge:sV,getH3UnidirectionalEdge:tV,getH3UnidirectionalEdgeBoundary:oV,getH3UnidirectionalEdgesFromHexagon:aV,getOriginH3IndexFromUnidirectionalEdge:iV,getPentagonIndexes:yV,getRes0Indexes:_V,h3Distance:lV,h3GetBaseCell:ON,h3GetFaces:NN,h3GetResolution:VN,h3IndexToSplitLong:ba,h3IndexesAreNeighbors:eV,h3IsPentagon:RN,h3IsResClassIII:FN,h3IsValid:O5,h3Line:uV,h3SetToMultiPolygon:YN,h3ToCenterChild:ZN,h3ToChildren:jN,h3ToGeo:GN,h3ToGeoBoundary:qN,h3ToParent:HN,h3UnidirectionalEdgeIsValid:rV,hexArea:pV,hexRing:$N,kRing:QN,kRingDistances:WN,numHexagons:gV,pointDist:AV,polyfill:XN,radsToDegs:N5,splitLongToh3Index:x1,uncompact:JN},Symbol.toStringTag,{value:"Module"})),xV=Ov(vV);var Lg=xV,w1="Feature",V5="FeatureCollection",X_="Polygon",L2="MultiPolygon";function U5(t){for(var e=null,n=0;n<t.length;n++)if(e!==null)for(var c=0;c<t[n].length;c++)e.push(t[n][c]);else e=t[n];return Array.from(new Set(e))}function bV(t){for(var e=0,n=0,c=0,g=t[0],v=0;v<g.length;v++)e+=g[v][0],n+=g[v][1],c++;return[e/c,n/c]}function wV(t,e){var n=t.features;if(!n)throw new Error("No features found");return U5(n.map(function(c){return G5(c,e)}))}function G5(t,e,n){n===void 0&&(n={});var c=t.type,g=t.geometry,v=g&&g.type;if(c===V5)return wV(t,e);if(c!==w1)throw new Error("Unhandled type: "+c);if(v!==X_&&v!==L2)throw new Error("Unhandled geometry type: "+v);var S=v===X_?[g.coordinates]:g.coordinates;return U5(S.map(function(a){var N=Lg.polyfill(a,e,!0);if(N.length||!n.ensureOutput)return N;var $=bV(a),he=$[0],oe=$[1];return[Lg.geoToH3(oe,he,e)]}))}function q5(t,e){e===void 0&&(e={});var n=[Lg.h3ToGeoBoundary(t,!0)];return{type:w1,id:t,properties:e,geometry:{type:X_,coordinates:n}}}function SV(t,e){e===void 0&&(e={});var n=Lg.h3SetToMultiPolygon(t,!0),c=n.length>1,g=c?L2:X_,v=c?n:n[0]||[];return{type:w1,properties:e,geometry:{type:g,coordinates:v}}}function IV(t,e){e===void 0&&(e={});var n=t.map(function(c){return[Lg.h3ToGeoBoundary(c,{geoJson:!0})]});return{type:w1,properties:e,geometry:{type:L2,coordinates:n}}}function EV(t,e){for(var n=[],c=0;c<t.length;c++){var g=t[c],v=e?e(g):{};n.push(q5(g,v))}return{type:V5,features:n}}var CV={featureToH3Set:G5,h3ToFeature:q5,h3SetToFeature:SV,h3SetToMultiPolygonFeature:IV,h3SetToFeatureCollection:EV},TV=CV,La=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},c;for(c in e)e.hasOwnProperty(c)&&(n[c]=e[c]);var g="";function v(Le){return e.locateFile?e.locateFile(Le,g):g+Le}var S;typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",S=function(qe,dt,Pt){var o=new XMLHttpRequest;o.open("GET",qe,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){dt(o.response);return}var li=mt(qe);if(li){dt(li.buffer);return}Pt()},o.onerror=Pt,o.send(null)};var a=e.print||console.log.bind(console),N=e.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(e[c]=n[c]);n=null,e.arguments&&e.arguments;var $=0,he=function(Le){$=Le},oe=function(){return $},ce=8;function _e(Le,qe,dt,Pt){switch(dt=dt||"i8",dt.charAt(dt.length-1)==="*"&&(dt="i32"),dt){case"i1":St[Le>>0]=qe;break;case"i8":St[Le>>0]=qe;break;case"i16":Ye[Le>>1]=qe;break;case"i32":_t[Le>>2]=qe;break;case"i64":_n=[qe>>>0,(Wn=qe,+bn(Wn)>=1?Wn>0?(Bn(+xi(Wn/4294967296),4294967295)|0)>>>0:~~+wn((Wn-+(~~Wn>>>0))/4294967296)>>>0:0)],_t[Le>>2]=_n[0],_t[Le+4>>2]=_n[1];break;case"float":ct[Le>>2]=qe;break;case"double":Ut[Le>>3]=qe;break;default:et("invalid type for setValue: "+dt)}}function Ze(Le,qe,dt){switch(qe=qe||"i8",qe.charAt(qe.length-1)==="*"&&(qe="i32"),qe){case"i1":return St[Le>>0];case"i8":return St[Le>>0];case"i16":return Ye[Le>>1];case"i32":return _t[Le>>2];case"i64":return _t[Le>>2];case"float":return ct[Le>>2];case"double":return Ut[Le>>3];default:et("invalid type for getValue: "+qe)}return null}var nt=!1;function Ke(Le,qe){Le||et("Assertion failed: "+qe)}function st(Le){var qe=e["_"+Le];return Ke(qe,"Cannot call unknown function "+Le+", make sure it is exported"),qe}function ht(Le,qe,dt,Pt,o){var Me={string:function(Si){var Jt=0;if(Si!=null&&Si!==0){var Sn=(Si.length<<2)+1;Jt=X(Sn),rt(Si,Jt,Sn)}return Jt},array:function(Si){var Jt=X(Si.length);return gt(Si,Jt),Jt}};function li(Si){return qe==="string"?Ue(Si):qe==="boolean"?!!Si:Si}var di=st(Le),fi=[],ti=0;if(Pt)for(var ui=0;ui<Pt.length;ui++){var Ri=Me[dt[ui]];Ri?(ti===0&&(ti=pe()),fi[ui]=Ri(Pt[ui])):fi[ui]=Pt[ui]}var bi=di.apply(null,fi);return bi=li(bi),ti!==0&&ne(ti),bi}function xt(Le,qe,dt,Pt){dt=dt||[];var o=dt.every(function(li){return li==="number"}),Me=qe!=="string";return Me&&o&&!Pt?st(Le):function(){return ht(Le,qe,dt,arguments)}}var zt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Mt(Le,qe,dt){for(var Pt=qe+dt,o=qe;Le[o]&&!(o>=Pt);)++o;if(o-qe>16&&Le.subarray&&zt)return zt.decode(Le.subarray(qe,o));for(var Me="";qe<o;){var li=Le[qe++];if(!(li&128)){Me+=String.fromCharCode(li);continue}var di=Le[qe++]&63;if((li&224)==192){Me+=String.fromCharCode((li&31)<<6|di);continue}var fi=Le[qe++]&63;if((li&240)==224?li=(li&15)<<12|di<<6|fi:li=(li&7)<<18|di<<12|fi<<6|Le[qe++]&63,li<65536)Me+=String.fromCharCode(li);else{var ti=li-65536;Me+=String.fromCharCode(55296|ti>>10,56320|ti&1023)}}return Me}function Ue(Le,qe){return Le?Mt(ut,Le,qe):""}function $t(Le,qe,dt,Pt){if(!(Pt>0))return 0;for(var o=dt,Me=dt+Pt-1,li=0;li<Le.length;++li){var di=Le.charCodeAt(li);if(di>=55296&&di<=57343){var fi=Le.charCodeAt(++li);di=65536+((di&1023)<<10)|fi&1023}if(di<=127){if(dt>=Me)break;qe[dt++]=di}else if(di<=2047){if(dt+1>=Me)break;qe[dt++]=192|di>>6,qe[dt++]=128|di&63}else if(di<=65535){if(dt+2>=Me)break;qe[dt++]=224|di>>12,qe[dt++]=128|di>>6&63,qe[dt++]=128|di&63}else{if(dt+3>=Me)break;qe[dt++]=240|di>>18,qe[dt++]=128|di>>12&63,qe[dt++]=128|di>>6&63,qe[dt++]=128|di&63}}return qe[dt]=0,dt-o}function rt(Le,qe,dt){return $t(Le,ut,qe,dt)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function gt(Le,qe){St.set(Le,qe)}function At(Le,qe){return Le%qe>0&&(Le+=qe-Le%qe),Le}var yt,St,ut,Ye,_t,ct,Ut;function Ft(Le){yt=Le,e.HEAP8=St=new Int8Array(Le),e.HEAP16=Ye=new Int16Array(Le),e.HEAP32=_t=new Int32Array(Le),e.HEAPU8=ut=new Uint8Array(Le),e.HEAPU16=new Uint16Array(Le),e.HEAPU32=new Uint32Array(Le),e.HEAPF32=ct=new Float32Array(Le),e.HEAPF64=Ut=new Float64Array(Le)}var Vt=5267040,yi=24128,Ci=e.TOTAL_MEMORY||33554432;e.buffer?yt=e.buffer:yt=new ArrayBuffer(Ci),Ci=yt.byteLength,Ft(yt),_t[yi>>2]=Vt;function ki(Le){for(;Le.length>0;){var qe=Le.shift();if(typeof qe=="function"){qe();continue}var dt=qe.func;typeof dt=="number"?qe.arg===void 0?e.dynCall_v(dt):e.dynCall_vi(dt,qe.arg):dt(qe.arg===void 0?null:qe.arg)}}var Ni=[],tn=[],Zi=[],Gi=[];function sn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Oi(e.preRun.shift());ki(Ni)}function xn(){ki(tn)}function Ti(){ki(Zi)}function gi(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Vi(e.postRun.shift());ki(Gi)}function Oi(Le){Ni.unshift(Le)}function Vi(Le){Gi.unshift(Le)}var bn=Math.abs,wn=Math.ceil,xi=Math.floor,Bn=Math.min,Ot=0,an=null;function $n(Le){Ot++,e.monitorRunDependencies&&e.monitorRunDependencies(Ot)}function oi(Le){if(Ot--,e.monitorRunDependencies&&e.monitorRunDependencies(Ot),Ot==0&&an){var qe=an;an=null,qe()}}e.preloadedImages={},e.preloadedAudios={};var Yi=null,Xn="data:application/octet-stream;base64,";function zn(Le){return String.prototype.startsWith?Le.startsWith(Xn):Le.indexOf(Xn)===0}var Wn,_n;Yi="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var b=24144;function M(Le){return Le}function U(Le){var qe=/\b__Z[\w\d_]+/g;return Le.replace(qe,function(dt){var Pt=dt;return dt===Pt?dt:Pt+" ["+dt+"]"})}function K(){var Le=new Error;if(!Le.stack){try{throw new Error(0)}catch(qe){Le=qe}if(!Le.stack)return"(no stack trace available)"}return Le.stack.toString()}function ie(){var Le=K();return e.extraStackTrace&&(Le+=`
`+e.extraStackTrace()),U(Le)}function de(Le,qe,dt,Pt){et("Assertion failed: "+Ue(Le)+", at: "+[qe?Ue(qe):"unknown filename",dt,Pt?Ue(Pt):"unknown function"])}function be(){return St.length}function Ee(Le,qe,dt){ut.set(ut.subarray(qe,qe+dt),Le)}function Ce(Le){return e.___errno_location&&(_t[e.___errno_location()>>2]=Le),Le}function Re(Le){et("OOM")}function $e(Le){try{var qe=new ArrayBuffer(Le);return qe.byteLength!=Le?void 0:(new Int8Array(qe).set(St),re(qe),Ft(qe),1)}catch{}}function je(Le){var qe=be(),dt=16777216,Pt=2147483648-dt;if(Le>Pt)return!1;for(var o=16777216,Me=Math.max(qe,o);Me<Le;)Me<=536870912?Me=At(2*Me,dt):Me=Math.min(At((3*Me+2147483648)/4,dt),Pt);var li=$e(Me);return!!li}var We=typeof atob=="function"?atob:function(Le){var qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",dt="",Pt,o,Me,li,di,fi,ti,ui=0;Le=Le.replace(/[^A-Za-z0-9\+\/\=]/g,"");do li=qe.indexOf(Le.charAt(ui++)),di=qe.indexOf(Le.charAt(ui++)),fi=qe.indexOf(Le.charAt(ui++)),ti=qe.indexOf(Le.charAt(ui++)),Pt=li<<2|di>>4,o=(di&15)<<4|fi>>2,Me=(fi&3)<<6|ti,dt=dt+String.fromCharCode(Pt),fi!==64&&(dt=dt+String.fromCharCode(o)),ti!==64&&(dt=dt+String.fromCharCode(Me));while(ui<Le.length);return dt};function Ge(Le){try{for(var qe=We(Le),dt=new Uint8Array(qe.length),Pt=0;Pt<qe.length;++Pt)dt[Pt]=qe.charCodeAt(Pt);return dt}catch{throw new Error("Converting base64 string to bytes failed.")}}function mt(Le){if(zn(Le))return Ge(Le.slice(Xn.length))}var ot={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Pe={a:et,b:he,c:oe,d:de,e:Ce,f:be,g:Ee,h:je,i:Re,j:M,k:U,l:$e,m:K,n:ie,o:b,p:yi},ae=function(Le,qe,dt){"almost asm";var Pt=new Le.Int8Array(dt),o=new Le.Int32Array(dt);new Le.Uint8Array(dt),new Le.Float32Array(dt);var Me=new Le.Float64Array(dt),li=qe.o|0,di=qe.p|0,fi=Le.Math.floor,ti=Le.Math.abs,ui=Le.Math.sqrt,Ri=Le.Math.pow,bi=Le.Math.cos,Si=Le.Math.sin,Jt=Le.Math.tan,Sn=Le.Math.acos,ur=Le.Math.asin,mn=Le.Math.atan,Hn=Le.Math.atan2,Yr=Le.Math.ceil,Qi=Le.Math.imul,hr=Le.Math.min,Gn=Le.Math.max,Xt=Le.Math.clz32,en=qe.b,qt=qe.c,kn=qe.d,Ar=qe.e,js=qe.f,Qr=qe.g,Gt=qe.h,fr=qe.i,Bt=24160;function Gr(i){return Pt=new Int8Array(i),o=new Int32Array(i),Me=new Float64Array(i),dt=i,!0}function Zs(i){i=i|0;var r=0;return r=Bt,Bt=Bt+i|0,Bt=Bt+15&-16,r|0}function pa(){return Bt|0}function Fr(i){i=i|0,Bt=i}function Za(i,r){i=i|0,Bt=i}function Oo(i,r){i=i|0,r=r|0;var l=0,d=0,y=0;return(i|0)<0?(r=2,r|0):(i|0)>13780509?(r=cr(15,r)|0,r|0):(l=((i|0)<0)<<31>>31,y=Xe(i|0,l|0,3,0)|0,d=qt()|0,l=R(i|0,l|0,1,0)|0,l=Xe(y|0,d|0,l|0,qt()|0)|0,l=R(l|0,qt()|0,1,0)|0,i=qt()|0,o[r>>2]=l,o[r+4>>2]=i,r=0,r|0)}function Qa(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,ia(i,r,l,d,0)|0}function ia(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0;if(Z=Bt,Bt=Bt+16|0,k=Z,!(Qn(i,r,l,d,y)|0))return d=0,Bt=Z,d|0;do if((l|0)>=0){if((l|0)>13780509){if(I=cr(15,k)|0,I|0)break;z=k,k=o[z>>2]|0,z=o[z+4>>2]|0}else I=((l|0)<0)<<31>>31,Y=Xe(l|0,I|0,3,0)|0,z=qt()|0,I=R(l|0,I|0,1,0)|0,I=Xe(Y|0,z|0,I|0,qt()|0)|0,I=R(I|0,qt()|0,1,0)|0,z=qt()|0,o[k>>2]=I,o[k+4>>2]=z,k=I;if(V(d|0,0,k<<3|0)|0,y|0){V(y|0,0,k<<2|0)|0,I=Aa(i,r,l,d,y,k,z,0)|0;break}I=L(k,4)|0,I?(Y=Aa(i,r,l,d,I,k,z,0)|0,T(I),I=Y):I=13}else I=2;while(!1);return Y=I,Bt=Z,Y|0}function Qn(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0;if(tt=Bt,Bt=Bt+16|0,Fe=tt,ze=tt+8|0,ke=Fe,o[ke>>2]=i,o[ke+4>>2]=r,(l|0)<0)return ze=2,Bt=tt,ze|0;if(I=d,o[I>>2]=i,o[I+4>>2]=r,I=(y|0)!=0,I&&(o[y>>2]=0),Br(i,r)|0)return ze=9,Bt=tt,ze|0;o[ze>>2]=0;e:do if((l|0)>=1)if(I)for(Ae=1,Y=0,Ie=0,ke=1,I=i;;){if(!(Y|Ie)){if(I=ds(I,r,4,ze,Fe)|0,I|0)break e;if(r=Fe,I=o[r>>2]|0,r=o[r+4>>2]|0,Br(I,r)|0){I=9;break e}}if(I=ds(I,r,o[22384+(Ie<<2)>>2]|0,ze,Fe)|0,I|0)break e;if(r=Fe,I=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(Ae<<3)|0,o[i>>2]=I,o[i+4>>2]=r,o[y+(Ae<<2)>>2]=ke,i=Y+1|0,k=(i|0)==(ke|0),z=Ie+1|0,Z=(z|0)==6,Br(I,r)|0){I=9;break e}if(ke=ke+(Z&k&1)|0,(ke|0)>(l|0)){I=0;break}else Ae=Ae+1|0,Y=k?0:i,Ie=k?Z?0:z:Ie}else for(Ae=1,Y=0,Ie=0,ke=1,I=i;;){if(!(Y|Ie)){if(I=ds(I,r,4,ze,Fe)|0,I|0)break e;if(r=Fe,I=o[r>>2]|0,r=o[r+4>>2]|0,Br(I,r)|0){I=9;break e}}if(I=ds(I,r,o[22384+(Ie<<2)>>2]|0,ze,Fe)|0,I|0)break e;if(r=Fe,I=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(Ae<<3)|0,o[i>>2]=I,o[i+4>>2]=r,i=Y+1|0,k=(i|0)==(ke|0),z=Ie+1|0,Z=(z|0)==6,Br(I,r)|0){I=9;break e}if(ke=ke+(Z&k&1)|0,(ke|0)>(l|0)){I=0;break}else Ae=Ae+1|0,Y=k?0:i,Ie=k?Z?0:z:Ie}else I=0;while(!1);return ze=I,Bt=tt,ze|0}function Aa(i,r,l,d,y,I,k,z){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0,I=I|0,k=k|0,z=z|0;var Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0;if(tt=Bt,Bt=Bt+16|0,Fe=tt+8|0,ze=tt,Z=kt(i|0,r|0,I|0,k|0)|0,Ae=qt()|0,Ie=d+(Z<<3)|0,wt=Ie,lt=o[wt>>2]|0,wt=o[wt+4>>2]|0,Y=(lt|0)==(i|0)&(wt|0)==(r|0),!((lt|0)==0&(wt|0)==0|Y))do Z=R(Z|0,Ae|0,1,0)|0,Z=bt(Z|0,qt()|0,I|0,k|0)|0,Ae=qt()|0,Ie=d+(Z<<3)|0,lt=Ie,wt=o[lt>>2]|0,lt=o[lt+4>>2]|0,Y=(wt|0)==(i|0)&(lt|0)==(r|0);while(!((wt|0)==0&(lt|0)==0|Y));if(Z=y+(Z<<2)|0,Y&&(o[Z>>2]|0)<=(z|0)||(lt=Ie,o[lt>>2]=i,o[lt+4>>2]=r,o[Z>>2]=z,(z|0)>=(l|0)))return lt=0,Bt=tt,lt|0;switch(Y=z+1|0,o[Fe>>2]=0,Z=ds(i,r,2,Fe,ze)|0,Z|0){case 9:{ke=9;break}case 0:{Z=ze,Z=Aa(o[Z>>2]|0,o[Z+4>>2]|0,l,d,y,I,k,Y)|0,Z||(ke=9);break}}e:do if((ke|0)==9){switch(o[Fe>>2]=0,Z=ds(i,r,3,Fe,ze)|0,Z|0){case 9:break;case 0:{if(Z=ze,Z=Aa(o[Z>>2]|0,o[Z+4>>2]|0,l,d,y,I,k,Y)|0,Z|0)break e;break}default:break e}switch(o[Fe>>2]=0,Z=ds(i,r,1,Fe,ze)|0,Z|0){case 9:break;case 0:{if(Z=ze,Z=Aa(o[Z>>2]|0,o[Z+4>>2]|0,l,d,y,I,k,Y)|0,Z|0)break e;break}default:break e}switch(o[Fe>>2]=0,Z=ds(i,r,5,Fe,ze)|0,Z|0){case 9:break;case 0:{if(Z=ze,Z=Aa(o[Z>>2]|0,o[Z+4>>2]|0,l,d,y,I,k,Y)|0,Z|0)break e;break}default:break e}switch(o[Fe>>2]=0,Z=ds(i,r,4,Fe,ze)|0,Z|0){case 9:break;case 0:{if(Z=ze,Z=Aa(o[Z>>2]|0,o[Z+4>>2]|0,l,d,y,I,k,Y)|0,Z|0)break e;break}default:break e}switch(o[Fe>>2]=0,Z=ds(i,r,6,Fe,ze)|0,Z|0){case 9:break;case 0:{if(Z=ze,Z=Aa(o[Z>>2]|0,o[Z+4>>2]|0,l,d,y,I,k,Y)|0,Z|0)break e;break}default:break e}return lt=0,Bt=tt,lt|0}while(!1);return lt=Z,Bt=tt,lt|0}function ds(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0;if(l>>>0>6)return y=1,y|0;if(Ie=(o[d>>2]|0)%6|0,o[d>>2]=Ie,(Ie|0)>0){I=0;do l=Fa(l)|0,I=I+1|0;while((I|0)<(o[d>>2]|0))}if(Ie=Ht(i|0,r|0,45)|0,qt()|0,Ae=Ie&127,Ae>>>0>121)return y=5,y|0;Z=ka(i,r)|0,I=Ht(i|0,r|0,52)|0,qt()|0,I=I&15;e:do if(!I)Y=8;else{for(;;){if(k=(15-I|0)*3|0,z=Ht(i|0,r|0,k|0)|0,qt()|0,z=z&7,(z|0)==7){r=5;break}if(ze=(Ws(I)|0)==0,I=I+-1|0,ke=Qt(7,0,k|0)|0,r=r&~(qt()|0),Fe=Qt(o[(ze?432:16)+(z*28|0)+(l<<2)>>2]|0,0,k|0)|0,k=qt()|0,l=o[(ze?640:224)+(z*28|0)+(l<<2)>>2]|0,i=Fe|i&~ke,r=k|r,!l){l=0;break e}if(!I){Y=8;break e}}return r|0}while(!1);(Y|0)==8&&(ze=o[848+(Ae*28|0)+(l<<2)>>2]|0,Fe=Qt(ze|0,0,45)|0,i=Fe|i,r=qt()|0|r&-1040385,l=o[4272+(Ae*28|0)+(l<<2)>>2]|0,(ze&127|0)==127&&(ze=Qt(o[848+(Ae*28|0)+20>>2]|0,0,45)|0,r=qt()|0|r&-1040385,l=o[4272+(Ae*28|0)+20>>2]|0,i=Lo(ze|i,r)|0,r=qt()|0,o[d>>2]=(o[d>>2]|0)+1)),z=Ht(i|0,r|0,45)|0,qt()|0,z=z&127;e:do if(at(z)|0){t:do if((ka(i,r)|0)==1){if((Ae|0)!=(z|0))if(pn(z,o[7696+(Ae*28|0)>>2]|0)|0){i=vo(i,r)|0,k=1,r=qt()|0;break}else kn(23313,22416,436,22424);switch(Z|0){case 3:{i=Lo(i,r)|0,r=qt()|0,o[d>>2]=(o[d>>2]|0)+1,k=0;break t}case 5:{i=vo(i,r)|0,r=qt()|0,o[d>>2]=(o[d>>2]|0)+5,k=0;break t}case 0:return ze=9,ze|0;default:return ze=1,ze|0}}else k=0;while(!1);if((l|0)>0){I=0;do i=Pl(i,r)|0,r=qt()|0,I=I+1|0;while((I|0)!=(l|0))}if((Ae|0)!=(z|0)){if(!(Ct(z)|0)){if((k|0)!=0|(ka(i,r)|0)!=5)break;o[d>>2]=(o[d>>2]|0)+1;break}switch(Ie&127){case 8:case 118:break e}(ka(i,r)|0)!=3&&(o[d>>2]=(o[d>>2]|0)+1)}}else if((l|0)>0){I=0;do i=Lo(i,r)|0,r=qt()|0,I=I+1|0;while((I|0)!=(l|0))}while(!1);return o[d>>2]=((o[d>>2]|0)+l|0)%6|0,ze=y,o[ze>>2]=i,o[ze+4>>2]=r,ze=0,ze|0}function Wa(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0;for(z=Bt,Bt=Bt+16|0,I=z,k=z+8|0,y=(Br(i,r)|0)==0,y=y?1:2;;){if(o[k>>2]=0,Y=(ds(i,r,y,k,I)|0)==0,Z=I,Y&((o[Z>>2]|0)==(l|0)?(o[Z+4>>2]|0)==(d|0):0)){i=4;break}if(y=y+1|0,y>>>0>=7){y=7,i=4;break}}return(i|0)==4?(Bt=z,y|0):0}function ol(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0;if(ze=Bt,Bt=Bt+16|0,ke=ze,Fe=ze+8|0,Ie=ke,o[Ie>>2]=i,o[Ie+4>>2]=r,!l)return Fe=d,o[Fe>>2]=i,o[Fe+4>>2]=r,Fe=0,Bt=ze,Fe|0;o[Fe>>2]=0;e:do if(Br(i,r)|0)i=9;else{if(I=(l|0)>0,I){y=0,Ie=i;do{if(i=ds(Ie,r,4,Fe,ke)|0,i|0)break e;if(r=ke,Ie=o[r>>2]|0,r=o[r+4>>2]|0,y=y+1|0,Br(Ie,r)|0){i=9;break e}}while((y|0)<(l|0));if(Ae=d,o[Ae>>2]=Ie,o[Ae+4>>2]=r,Ae=l+-1|0,I){Y=0,i=1;do{if(y=22384+(Y<<2)|0,(Y|0)==5)for(k=o[y>>2]|0,I=0,y=i;;){if(i=ke,i=ds(o[i>>2]|0,o[i+4>>2]|0,k,Fe,ke)|0,i|0)break e;if((I|0)!=(Ae|0))if(Z=ke,z=o[Z>>2]|0,Z=o[Z+4>>2]|0,i=d+(y<<3)|0,o[i>>2]=z,o[i+4>>2]=Z,!(Br(z,Z)|0))i=y+1|0;else{i=9;break e}else i=y;if(I=I+1|0,(I|0)>=(l|0))break;y=i}else for(k=ke,Z=o[y>>2]|0,z=0,y=i,I=o[k>>2]|0,k=o[k+4>>2]|0;;){if(i=ds(I,k,Z,Fe,ke)|0,i|0)break e;if(k=ke,I=o[k>>2]|0,k=o[k+4>>2]|0,i=d+(y<<3)|0,o[i>>2]=I,o[i+4>>2]=k,i=y+1|0,Br(I,k)|0){i=9;break e}if(z=z+1|0,(z|0)>=(l|0))break;y=i}Y=Y+1|0}while(Y>>>0<6);i=ke,k=Ie,y=o[i>>2]|0,I=r,i=o[i+4>>2]|0}else k=Ie,y=Ie,I=r,i=r}else k=d,o[k>>2]=i,o[k+4>>2]=r,k=i,y=i,I=r,i=r;i=(k|0)==(y|0)&(I|0)==(i|0)?0:9}while(!1);return Fe=i,Bt=ze,Fe|0}function ll(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0;if(z=Bt,Bt=Bt+48|0,y=z+16|0,I=z+8|0,k=z,l|0)return k=15,Bt=z,k|0;if(Y=i,Z=o[Y+4>>2]|0,l=I,o[l>>2]=o[Y>>2],o[l+4>>2]=Z,Vu(I,y),r=ml(y,r,k)|0,!r){if(l=o[I>>2]|0,I=o[i+8>>2]|0,(I|0)>0){y=o[i+12>>2]|0,r=0;do l=(o[y+(r<<3)>>2]|0)+l|0,r=r+1|0;while((r|0)<(I|0))}r=k,y=o[r>>2]|0,r=o[r+4>>2]|0,I=((l|0)<0)<<31>>31,(r|0)<(I|0)|(r|0)==(I|0)&y>>>0<l>>>0?(r=k,o[r>>2]=l,o[r+4>>2]=I,r=I):l=y,Z=R(l|0,r|0,12,0)|0,Y=qt()|0,r=k,o[r>>2]=Z,o[r+4>>2]=Y,r=d,o[r>>2]=Z,o[r+4>>2]=Y,r=0}return Y=r,Bt=z,Y|0}function lo(i,r,l,d,y,I,k){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0,I=I|0,k=k|0;var z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0,ai=0,Wi=0,$i=0,Ei=0,Hi=0,ji=0,cn=0,Nn=0,nn=0,Mn=0,wr=0,nr=0;if(Nn=Bt,Bt=Bt+64|0,Ei=Nn+48|0,Hi=Nn+32|0,ji=Nn+24|0,si=Nn+8|0,Kt=Nn,Z=o[i>>2]|0,(Z|0)<=0)return cn=0,Bt=Nn,cn|0;for(ii=i+4|0,ai=Ei+8|0,Wi=Hi+8|0,$i=si+8|0,z=0,Tt=0;;){Y=o[ii>>2]|0,ft=Y+(Tt<<4)|0,o[Ei>>2]=o[ft>>2],o[Ei+4>>2]=o[ft+4>>2],o[Ei+8>>2]=o[ft+8>>2],o[Ei+12>>2]=o[ft+12>>2],(Tt|0)==(Z+-1|0)?(o[Hi>>2]=o[Y>>2],o[Hi+4>>2]=o[Y+4>>2],o[Hi+8>>2]=o[Y+8>>2],o[Hi+12>>2]=o[Y+12>>2]):(ft=Y+(Tt+1<<4)|0,o[Hi>>2]=o[ft>>2],o[Hi+4>>2]=o[ft+4>>2],o[Hi+8>>2]=o[ft+8>>2],o[Hi+12>>2]=o[ft+12>>2]),Z=Wr(Ei,Hi,d,ji)|0;e:do if(Z)Y=0,z=Z;else if(Y=ji,Z=o[Y>>2]|0,Y=o[Y+4>>2]|0,(Y|0)>0|(Y|0)==0&Z>>>0>0){lt=0,ft=0;t:for(;;){if(nr=+Me[Ei>>3],wt=F(Z|0,Y|0,lt|0,ft|0)|0,wr=+(wt>>>0)+4294967296*+(qt()|0),nn=+(Z>>>0)+4294967296*+(Y|0),Mn=+(lt>>>0)+4294967296*+(ft|0),Me[si>>3]=nr*wr/nn+ +Me[Hi>>3]*Mn/nn,Me[$i>>3]=+Me[ai>>3]*wr/nn+ +Me[Wi>>3]*Mn/nn,Z=io(si,d,Kt)|0,Z|0){z=Z;break}wt=Kt,tt=o[wt>>2]|0,wt=o[wt+4>>2]|0,ke=kt(tt|0,wt|0,r|0,l|0)|0,Ae=qt()|0,Z=k+(ke<<3)|0,Ie=Z,Y=o[Ie>>2]|0,Ie=o[Ie+4>>2]|0;i:do if((Y|0)==0&(Ie|0)==0)It=Z,cn=16;else for(Fe=0,ze=0;;){if((Fe|0)>(l|0)|(Fe|0)==(l|0)&ze>>>0>r>>>0){z=1;break t}if((Y|0)==(tt|0)&(Ie|0)==(wt|0))break i;if(Z=R(ke|0,Ae|0,1,0)|0,ke=bt(Z|0,qt()|0,r|0,l|0)|0,Ae=qt()|0,ze=R(ze|0,Fe|0,1,0)|0,Fe=qt()|0,Z=k+(ke<<3)|0,Ie=Z,Y=o[Ie>>2]|0,Ie=o[Ie+4>>2]|0,(Y|0)==0&(Ie|0)==0){It=Z,cn=16;break}}while(!1);if((cn|0)==16&&(cn=0,!((tt|0)==0&(wt|0)==0))&&(ze=It,o[ze>>2]=tt,o[ze+4>>2]=wt,ze=I+(o[y>>2]<<3)|0,o[ze>>2]=tt,o[ze+4>>2]=wt,ze=y,ze=R(o[ze>>2]|0,o[ze+4>>2]|0,1,0)|0,tt=qt()|0,wt=y,o[wt>>2]=ze,o[wt+4>>2]=tt),lt=R(lt|0,ft|0,1,0)|0,ft=qt()|0,Y=ji,Z=o[Y>>2]|0,Y=o[Y+4>>2]|0,!((Y|0)>(ft|0)|(Y|0)==(ft|0)&Z>>>0>lt>>>0)){Y=1;break e}}Y=0}else Y=1;while(!1);if(Tt=Tt+1|0,!Y){cn=21;break}if(Z=o[i>>2]|0,(Tt|0)>=(Z|0)){z=0,cn=21;break}}return(cn|0)==21?(Bt=Nn,z|0):0}function $a(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0,ai=0,Wi=0,$i=0,Ei=0,Hi=0,ji=0,cn=0,Nn=0,nn=0,Mn=0,wr=0;if(wr=Bt,Bt=Bt+112|0,cn=wr+80|0,Z=wr+72|0,Nn=wr,nn=wr+56|0,l|0)return Mn=15,Bt=wr,Mn|0;if(Y=i+8|0,Mn=zs((o[Y>>2]<<5)+32|0)|0,!Mn)return Mn=13,Bt=wr,Mn|0;if(ql(i,Mn),Hi=i,ji=o[Hi+4>>2]|0,l=Z,o[l>>2]=o[Hi>>2],o[l+4>>2]=ji,Vu(Z,cn),l=ml(cn,r,Nn)|0,l)Hi=0,ji=0;else{if(l=o[Z>>2]|0,I=o[Y>>2]|0,(I|0)>0){k=o[i+12>>2]|0,y=0;do l=(o[k+(y<<3)>>2]|0)+l|0,y=y+1|0;while((y|0)!=(I|0));y=l}else y=l;l=Nn,I=o[l>>2]|0,l=o[l+4>>2]|0,k=((y|0)<0)<<31>>31,(l|0)<(k|0)|(l|0)==(k|0)&I>>>0<y>>>0?(l=Nn,o[l>>2]=y,o[l+4>>2]=k,l=k):y=I,Hi=R(y|0,l|0,12,0)|0,ji=qt()|0,l=Nn,o[l>>2]=Hi,o[l+4>>2]=ji,l=0}if(l|0)return T(Mn),Mn=l,Bt=wr,Mn|0;if(y=L(Hi,8)|0,!y)return T(Mn),Mn=13,Bt=wr,Mn|0;if(z=L(Hi,8)|0,!z)return T(Mn),T(y),Mn=13,Bt=wr,Mn|0;$i=cn,o[$i>>2]=0,o[$i+4>>2]=0,$i=i,Ei=o[$i+4>>2]|0,l=Z,o[l>>2]=o[$i>>2],o[l+4>>2]=Ei,l=lo(Z,Hi,ji,r,cn,y,z)|0;e:do if(l)T(y),T(z),T(Mn);else{t:do if((o[Y>>2]|0)>0){for(k=i+12|0,I=0;l=lo((o[k>>2]|0)+(I<<3)|0,Hi,ji,r,cn,y,z)|0,I=I+1|0,!(l|0);)if((I|0)>=(o[Y>>2]|0))break t;T(y),T(z),T(Mn);break e}while(!1);(ji|0)>0|(ji|0)==0&Hi>>>0>0&&V(z|0,0,Hi<<3|0)|0,Ei=cn,$i=o[Ei+4>>2]|0;t:do if(($i|0)>0|($i|0)==0&(o[Ei>>2]|0)>>>0>0){ii=y,ai=z,Wi=y,$i=z,Ei=y,l=y,It=y,si=z,Kt=z,y=z;i:for(;;){for(wt=0,lt=0,ft=0,Tt=0,I=0,k=0;;){z=Nn,Z=z+56|0;do o[z>>2]=0,z=z+4|0;while((z|0)<(Z|0));if(r=ii+(wt<<3)|0,Y=o[r>>2]|0,r=o[r+4>>2]|0,Qn(Y,r,1,Nn,0)|0){z=Nn,Z=z+56|0;do o[z>>2]=0,z=z+4|0;while((z|0)<(Z|0));z=L(7,4)|0,z|0&&(Aa(Y,r,1,Nn,z,7,0,0)|0,T(z))}for(tt=0;;){ze=Nn+(tt<<3)|0,Fe=o[ze>>2]|0,ze=o[ze+4>>2]|0;n:do if((Fe|0)==0&(ze|0)==0)z=I,Z=k;else{if(Ae=kt(Fe|0,ze|0,Hi|0,ji|0)|0,Y=qt()|0,z=d+(Ae<<3)|0,r=z,Z=o[r>>2]|0,r=o[r+4>>2]|0,!((Z|0)==0&(r|0)==0)){Ie=0,ke=0;do{if((Ie|0)>(ji|0)|(Ie|0)==(ji|0)&ke>>>0>Hi>>>0)break i;if((Z|0)==(Fe|0)&(r|0)==(ze|0)){z=I,Z=k;break n}z=R(Ae|0,Y|0,1,0)|0,Ae=bt(z|0,qt()|0,Hi|0,ji|0)|0,Y=qt()|0,ke=R(ke|0,Ie|0,1,0)|0,Ie=qt()|0,z=d+(Ae<<3)|0,r=z,Z=o[r>>2]|0,r=o[r+4>>2]|0}while(!((Z|0)==0&(r|0)==0))}(Fe|0)==0&(ze|0)==0?(z=I,Z=k):(vr(Fe,ze,nn)|0,vl(i,Mn,nn)|0&&(ke=R(I|0,k|0,1,0)|0,k=qt()|0,Ie=z,o[Ie>>2]=Fe,o[Ie+4>>2]=ze,I=ai+(I<<3)|0,o[I>>2]=Fe,o[I+4>>2]=ze,I=ke),z=I,Z=k)}while(!1);if(tt=tt+1|0,tt>>>0>=7)break;I=z,k=Z}if(wt=R(wt|0,lt|0,1,0)|0,lt=qt()|0,ft=R(ft|0,Tt|0,1,0)|0,Tt=qt()|0,k=cn,I=o[k>>2]|0,k=o[k+4>>2]|0,(Tt|0)<(k|0)|(Tt|0)==(k|0)&ft>>>0<I>>>0)I=z,k=Z;else break}if((k|0)>0|(k|0)==0&I>>>0>0){I=0,k=0;do Tt=ii+(I<<3)|0,o[Tt>>2]=0,o[Tt+4>>2]=0,I=R(I|0,k|0,1,0)|0,k=qt()|0,Tt=cn,ft=o[Tt+4>>2]|0;while((k|0)<(ft|0)|((k|0)==(ft|0)?I>>>0<(o[Tt>>2]|0)>>>0:0))}if(Tt=cn,o[Tt>>2]=z,o[Tt+4>>2]=Z,(Z|0)>0|(Z|0)==0&z>>>0>0)tt=y,wt=Kt,lt=Ei,ft=si,Tt=ai,y=It,Kt=l,si=Wi,It=tt,l=wt,Ei=$i,$i=lt,Wi=ft,ai=ii,ii=Tt;else break t}T(Wi),T($i),T(Mn),l=1;break e}else l=z;while(!1);T(Mn),T(y),T(l),l=0}while(!1);return Mn=l,Bt=wr,Mn|0}function G(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;if(Ae=Bt,Bt=Bt+176|0,Z=Ae,(r|0)<1)return bu(l,0,0),Y=0,Bt=Ae,Y|0;for(z=i,z=Ht(o[z>>2]|0,o[z+4>>2]|0,52)|0,qt()|0,bu(l,(r|0)>6?r:6,z&15),z=0;d=i+(z<<3)|0,d=Hr(o[d>>2]|0,o[d+4>>2]|0,Z)|0,!(d|0);){if(d=o[Z>>2]|0,(d|0)>0){k=0;do I=Z+8+(k<<4)|0,k=k+1|0,d=Z+8+(((k|0)%(d|0)|0)<<4)|0,y=Es(l,d,I)|0,y?Mi(l,y)|0:zi(l,I,d)|0,d=o[Z>>2]|0;while((k|0)<(d|0))}if(z=z+1|0,(z|0)>=(r|0)){d=0,Y=13;break}}return(Y|0)==13?(Bt=Ae,d|0):(Is(l),Y=d,Bt=Ae,Y|0)}function we(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0;if(I=Bt,Bt=Bt+32|0,d=I,y=I+16|0,i=G(i,r,y)|0,i|0)return l=i,Bt=I,l|0;if(o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,i=Bo(y)|0,i|0)do{r=Yu(l)|0;do Nu(r,i)|0,k=i+16|0,o[d>>2]=o[k>>2],o[d+4>>2]=o[k+4>>2],o[d+8>>2]=o[k+8>>2],o[d+12>>2]=o[k+12>>2],Mi(y,i)|0,i=wu(y,d)|0;while(i|0);i=Bo(y)|0}while(i|0);return Is(y),i=Ll(l)|0,i?(wo(l),k=i,Bt=I,k|0):(k=0,Bt=I,k|0)}function at(i){return i=i|0,i>>>0>121?(i=0,i|0):(i=o[7696+(i*28|0)+16>>2]|0,i|0)}function Ct(i){return i=i|0,(i|0)==4|(i|0)==117|0}function Yt(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)>>2]|0}function Ii(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)+4>>2]|0}function Li(i,r){i=i|0,r=r|0,i=7696+(i*28|0)|0,o[r>>2]=o[i>>2],o[r+4>>2]=o[i+4>>2],o[r+8>>2]=o[i+8>>2],o[r+12>>2]=o[i+12>>2]}function An(i,r){i=i|0,r=r|0;var l=0,d=0;if(r>>>0>20)return r=-1,r|0;do if((o[11120+(r*216|0)>>2]|0)!=(i|0))if((o[11120+(r*216|0)+8>>2]|0)!=(i|0))if((o[11120+(r*216|0)+16>>2]|0)!=(i|0))if((o[11120+(r*216|0)+24>>2]|0)!=(i|0))if((o[11120+(r*216|0)+32>>2]|0)!=(i|0))if((o[11120+(r*216|0)+40>>2]|0)!=(i|0))if((o[11120+(r*216|0)+48>>2]|0)!=(i|0))if((o[11120+(r*216|0)+56>>2]|0)!=(i|0))if((o[11120+(r*216|0)+64>>2]|0)!=(i|0))if((o[11120+(r*216|0)+72>>2]|0)!=(i|0))if((o[11120+(r*216|0)+80>>2]|0)!=(i|0))if((o[11120+(r*216|0)+88>>2]|0)!=(i|0))if((o[11120+(r*216|0)+96>>2]|0)!=(i|0))if((o[11120+(r*216|0)+104>>2]|0)!=(i|0))if((o[11120+(r*216|0)+112>>2]|0)!=(i|0))if((o[11120+(r*216|0)+120>>2]|0)!=(i|0))if((o[11120+(r*216|0)+128>>2]|0)!=(i|0))if((o[11120+(r*216|0)+136>>2]|0)==(i|0))i=2,l=1,d=2;else{if((o[11120+(r*216|0)+144>>2]|0)==(i|0)){i=0,l=2,d=0;break}if((o[11120+(r*216|0)+152>>2]|0)==(i|0)){i=0,l=2,d=1;break}if((o[11120+(r*216|0)+160>>2]|0)==(i|0)){i=0,l=2,d=2;break}if((o[11120+(r*216|0)+168>>2]|0)==(i|0)){i=1,l=2,d=0;break}if((o[11120+(r*216|0)+176>>2]|0)==(i|0)){i=1,l=2,d=1;break}if((o[11120+(r*216|0)+184>>2]|0)==(i|0)){i=1,l=2,d=2;break}if((o[11120+(r*216|0)+192>>2]|0)==(i|0)){i=2,l=2,d=0;break}if((o[11120+(r*216|0)+200>>2]|0)==(i|0)){i=2,l=2,d=1;break}if((o[11120+(r*216|0)+208>>2]|0)==(i|0)){i=2,l=2,d=2;break}else i=-1;return i|0}else i=2,l=1,d=1;else i=2,l=1,d=0;else i=1,l=1,d=2;else i=1,l=1,d=1;else i=1,l=1,d=0;else i=0,l=1,d=2;else i=0,l=1,d=1;else i=0,l=1,d=0;else i=2,l=0,d=2;else i=2,l=0,d=1;else i=2,l=0,d=0;else i=1,l=0,d=2;else i=1,l=0,d=1;else i=1,l=0,d=0;else i=0,l=0,d=2;else i=0,l=0,d=1;else i=0,l=0,d=0;while(!1);return r=o[11120+(r*216|0)+(l*72|0)+(i*24|0)+(d<<3)+4>>2]|0,r|0}function pn(i,r){return i=i|0,r=r|0,(o[7696+(i*28|0)+20>>2]|0)==(r|0)?(r=1,r|0):(r=(o[7696+(i*28|0)+24>>2]|0)==(r|0),r|0)}function or(i,r){return i=i|0,r=r|0,o[848+(i*28|0)+(r<<2)>>2]|0}function dr(i,r){return i=i|0,r=r|0,(o[848+(i*28|0)>>2]|0)==(r|0)?(r=0,r|0):(o[848+(i*28|0)+4>>2]|0)==(r|0)?(r=1,r|0):(o[848+(i*28|0)+8>>2]|0)==(r|0)?(r=2,r|0):(o[848+(i*28|0)+12>>2]|0)==(r|0)?(r=3,r|0):(o[848+(i*28|0)+16>>2]|0)==(r|0)?(r=4,r|0):(o[848+(i*28|0)+20>>2]|0)==(r|0)?(r=5,r|0):((o[848+(i*28|0)+24>>2]|0)==(r|0)?6:7)|0}function qr(){return 122}function Xa(i){i=i|0;var r=0,l=0,d=0;r=0;do Qt(r|0,0,45)|0,d=qt()|0|134225919,l=i+(r<<3)|0,o[l>>2]=-1,o[l+4>>2]=d,r=r+1|0;while((r|0)!=122);return 0}function Ya(i){return i=i|0,+Me[i+16>>3]<+Me[i+24>>3]|0}function Ka(i,r){i=i|0,r=r|0;var l=0,d=0,y=0;return l=+Me[r>>3],!(l>=+Me[i+8>>3])||!(l<=+Me[i>>3])?(r=0,r|0):(d=+Me[i+16>>3],l=+Me[i+24>>3],y=+Me[r+8>>3],r=y>=l,i=y<=d&1,d<l?r&&(i=1):r||(i=0),r=(i|0)!=0,r|0)}function ml(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0;ze=Bt,Bt=Bt+288|0,Ae=ze+264|0,Ie=ze+96|0,Y=ze,z=Y,Z=z+96|0;do o[z>>2]=0,z=z+4|0;while((z|0)<(Z|0));return r=Ma(r,Y)|0,r|0?(Fe=r,Bt=ze,Fe|0):(Z=Y,Y=o[Z>>2]|0,Z=o[Z+4>>2]|0,vr(Y,Z,Ae)|0,Hr(Y,Z,Ie)|0,k=+qi(Ae,Ie+8|0),Me[Ae>>3]=+Me[i>>3],Z=Ae+8|0,Me[Z>>3]=+Me[i+16>>3],Me[Ie>>3]=+Me[i+8>>3],Y=Ie+8|0,Me[Y>>3]=+Me[i+24>>3],y=+qi(Ae,Ie),wt=+Me[Z>>3]-+Me[Y>>3],I=+ti(+wt),tt=+Me[Ae>>3]-+Me[Ie>>3],d=+ti(+tt),!(wt==0|tt==0)&&(wt=+Q(+I,+d),wt=+Yr(+(y*y/+A(+(wt/+A(+I,+d)),3)/(k*(k*2.59807621135)*.8))),Me[li>>3]=wt,ke=~~wt>>>0,Fe=+ti(wt)>=1?wt>0?~~+hr(+fi(wt/4294967296),4294967295)>>>0:~~+Yr((wt-+(~~wt>>>0))/4294967296)>>>0:0,(o[li+4>>2]&2146435072|0)!=2146435072)?(Ie=(ke|0)==0&(Fe|0)==0,r=l,o[r>>2]=Ie?1:ke,o[r+4>>2]=Ie?0:Fe,r=0):r=1,Fe=r,Bt=ze,Fe|0)}function Wr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;Y=Bt,Bt=Bt+288|0,k=Y+264|0,z=Y+96|0,Z=Y,y=Z,I=y+96|0;do o[y>>2]=0,y=y+4|0;while((y|0)<(I|0));return l=Ma(l,Z)|0,l|0?(d=l,Bt=Y,d|0):(l=Z,y=o[l>>2]|0,l=o[l+4>>2]|0,vr(y,l,k)|0,Hr(y,l,z)|0,Ae=+qi(k,z+8|0),Ae=+Yr(+(+qi(i,r)/(Ae*2))),Me[li>>3]=Ae,l=~~Ae>>>0,y=+ti(Ae)>=1?Ae>0?~~+hr(+fi(Ae/4294967296),4294967295)>>>0:~~+Yr((Ae-+(~~Ae>>>0))/4294967296)>>>0:0,(o[li+4>>2]&2146435072|0)==2146435072?(d=1,Bt=Y,d|0):(Z=(l|0)==0&(y|0)==0,o[d>>2]=Z?1:l,o[d+4>>2]=Z?0:y,d=0,Bt=Y,d|0))}function sr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0,o[i>>2]=r,o[i+4>>2]=l,o[i+8>>2]=d}function Mr(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0;Ie=r+8|0,o[Ie>>2]=0,Z=+Me[i>>3],k=+ti(+Z),Y=+Me[i+8>>3],z=+ti(+Y)/.8660254037844386,k=k+z*.5,l=~~k,i=~~z,k=k-+(l|0),z=z-+(i|0);do if(k<.5)if(k<.3333333333333333)if(o[r>>2]=l,z<(k+1)*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}else if(ke=1-k,i=(!(z<ke)&1)+i|0,o[r+4>>2]=i,ke<=z&z<k*2){l=l+1|0,o[r>>2]=l;break}else{o[r>>2]=l;break}else{if(!(k<.6666666666666666))if(l=l+1|0,o[r>>2]=l,z<k*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}if(z<1-k){if(o[r+4>>2]=i,k*2+-1<z){o[r>>2]=l;break}}else i=i+1|0,o[r+4>>2]=i;l=l+1|0,o[r>>2]=l}while(!1);do if(Z<0)if(i&1){Ae=(i+1|0)/2|0,Ae=F(l|0,((l|0)<0)<<31>>31|0,Ae|0,((Ae|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-((+(Ae>>>0)+4294967296*+(qt()|0))*2+1)),o[r>>2]=l;break}else{Ae=(i|0)/2|0,Ae=F(l|0,((l|0)<0)<<31>>31|0,Ae|0,((Ae|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-(+(Ae>>>0)+4294967296*+(qt()|0))*2),o[r>>2]=l;break}while(!1);Ae=r+4|0,Y<0&&(l=l-((i<<1|1|0)/2|0)|0,o[r>>2]=l,i=0-i|0,o[Ae>>2]=i),d=i-l|0,(l|0)<0?(y=0-l|0,o[Ae>>2]=d,o[Ie>>2]=y,o[r>>2]=0,i=d,l=0):y=0,(i|0)<0&&(l=l-i|0,o[r>>2]=l,y=y-i|0,o[Ie>>2]=y,o[Ae>>2]=0,i=0),I=l-y|0,d=i-y|0,(y|0)<0&&(o[r>>2]=I,o[Ae>>2]=d,o[Ie>>2]=0,i=d,l=I,y=0),d=(i|0)<(l|0)?i:l,d=(y|0)<(d|0)?y:d,!((d|0)<=0)&&(o[r>>2]=l-d,o[Ae>>2]=i-d,o[Ie>>2]=y-d)}function Or(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0;r=o[i>>2]|0,k=i+4|0,l=o[k>>2]|0,(r|0)<0&&(l=l-r|0,o[k>>2]=l,I=i+8|0,o[I>>2]=(o[I>>2]|0)-r,o[i>>2]=0,r=0),(l|0)<0?(r=r-l|0,o[i>>2]=r,I=i+8|0,y=(o[I>>2]|0)-l|0,o[I>>2]=y,o[k>>2]=0,l=0):(y=i+8|0,I=y,y=o[y>>2]|0),(y|0)<0&&(r=r-y|0,o[i>>2]=r,l=l-y|0,o[k>>2]=l,o[I>>2]=0,y=0),d=(l|0)<(r|0)?l:r,d=(y|0)<(d|0)?y:d,!((d|0)<=0)&&(o[i>>2]=r-d,o[k>>2]=l-d,o[I>>2]=y-d)}function Ys(i,r){i=i|0,r=r|0;var l=0,d=0;d=o[i+8>>2]|0,l=+((o[i+4>>2]|0)-d|0),Me[r>>3]=+((o[i>>2]|0)-d|0)-l*.5,Me[r+8>>3]=l*.8660254037844386}function Sr(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[r>>2]|0)+(o[i>>2]|0),o[l+4>>2]=(o[r+4>>2]|0)+(o[i+4>>2]|0),o[l+8>>2]=(o[r+8>>2]|0)+(o[i+8>>2]|0)}function ra(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[i>>2]|0)-(o[r>>2]|0),o[l+4>>2]=(o[i+4>>2]|0)-(o[r+4>>2]|0),o[l+8>>2]=(o[i+8>>2]|0)-(o[r+8>>2]|0)}function Nr(i,r){i=i|0,r=r|0;var l=0,d=0;l=Qi(o[i>>2]|0,r)|0,o[i>>2]=l,l=i+4|0,d=Qi(o[l>>2]|0,r)|0,o[l>>2]=d,i=i+8|0,r=Qi(o[i>>2]|0,r)|0,o[i>>2]=r}function ko(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;k=o[i>>2]|0,z=(k|0)<0,d=(o[i+4>>2]|0)-(z?k:0)|0,I=(d|0)<0,y=(I?0-d|0:0)+((o[i+8>>2]|0)-(z?k:0))|0,l=(y|0)<0,i=l?0:y,r=(I?0:d)-(l?y:0)|0,y=(z?0:k)-(I?d:0)-(l?y:0)|0,l=(r|0)<(y|0)?r:y,l=(i|0)<(l|0)?i:l,d=(l|0)>0,i=i-(d?l:0)|0,r=r-(d?l:0)|0;e:do switch(y-(d?l:0)|0){case 0:switch(r|0){case 0:return z=i|0?(i|0)==1?1:7:0,z|0;case 1:return z=i|0?(i|0)==1?3:7:2,z|0;default:break e}case 1:switch(r|0){case 0:return z=i|0?(i|0)==1?5:7:4,z|0;case 1:{if(!i)i=6;else break e;return i|0}default:break e}}while(!1);return z=7,z|0}function Qo(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;k=i+8|0,y=o[k>>2]|0,I=(o[i>>2]|0)-y|0,z=i+4|0,y=(o[z>>2]|0)-y|0;do if(I>>>0>715827881|y>>>0>715827881){if(l=(I|0)>0,l){if((2147483647-I|0)<(I|0)||(2147483647-(I<<1)|0)<(I|0))return z=1,z|0}else if((-2147483648-I|0)>(I|0)||(-2147483648-(I<<1)|0)>(I|0))return z=1,z|0;if(r=I*3|0,(y|0)>0){if((2147483647-y|0)<(y|0))return z=1,z|0}else if((-2147483648-y|0)>(y|0))return z=1,z|0;if(d=y<<1,(I|0)>-1){if((r|-2147483648|0)>=(y|0))return z=1,z|0}else if((r^-2147483648|0)<(y|0))return z=1,z|0;if(l){if((2147483647-I|0)<(d|0))r=1;else{l=d;break}return r|0}else{if((-2147483648-I|0)>(d|0))r=1;else{l=d;break}return r|0}}else l=y<<1,r=I*3|0;while(!1);d=Al(+(r-y|0)/7)|0,o[i>>2]=d,y=Al(+(l+I|0)/7)|0,o[z>>2]=y,o[k>>2]=0,l=(y|0)<(d|0),r=l?d:y,l=l?y:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;kn(23313,22444,355,22455)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&kn(23313,22444,355,22455),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;kn(23313,22444,355,22455)}else{if((r^-2147483648|0)>=(l|0))break;kn(23313,22444,355,22455)}}while(!1);return r=y-d|0,(d|0)<0?(l=0-d|0,o[z>>2]=r,o[k>>2]=l,o[i>>2]=0,d=0):(r=y,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[k>>2]=l,o[z>>2]=0,r=0),I=d-l|0,y=r-l|0,(l|0)<0?(o[i>>2]=I,o[z>>2]=y,o[k>>2]=0,r=y,y=I,l=0):y=d,d=(r|0)<(y|0)?r:y,d=(l|0)<(d|0)?l:d,(d|0)<=0?(z=0,z|0):(o[i>>2]=y-d,o[z>>2]=r-d,o[k>>2]=l-d,z=0,z|0)}function Ns(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;k=i+8|0,y=o[k>>2]|0,I=(o[i>>2]|0)-y|0,z=i+4|0,y=(o[z>>2]|0)-y|0;do if(I>>>0>715827881|y>>>0>715827881){if(l=(I|0)>0,l){if((2147483647-I|0)<(I|0))return z=1,z|0}else if((-2147483648-I|0)>(I|0))return z=1,z|0;if(r=I<<1,(y|0)>0){if((2147483647-y|0)<(y|0)||(2147483647-(y<<1)|0)<(y|0))return z=1,z|0}else if((-2147483648-y|0)>(y|0)||(-2147483648-(y<<1)|0)>(y|0))return z=1,z|0;if(d=y*3|0,l){if((2147483647-r|0)<(y|0))return z=1,z|0}else if((-2147483648-r|0)>(y|0))return z=1,z|0;if((y|0)>-1){if((d|-2147483648|0)<(I|0)){l=d;break}else r=1;return r|0}else{if((d^-2147483648|0)<(I|0))r=1;else{l=d;break}return r|0}}else l=y*3|0,r=I<<1;while(!1);d=Al(+(r+y|0)/7)|0,o[i>>2]=d,y=Al(+(l-I|0)/7)|0,o[z>>2]=y,o[k>>2]=0,l=(y|0)<(d|0),r=l?d:y,l=l?y:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;kn(23313,22444,404,22469)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&kn(23313,22444,404,22469),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;kn(23313,22444,404,22469)}else{if((r^-2147483648|0)>=(l|0))break;kn(23313,22444,404,22469)}}while(!1);return r=y-d|0,(d|0)<0?(l=0-d|0,o[z>>2]=r,o[k>>2]=l,o[i>>2]=0,d=0):(r=y,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[k>>2]=l,o[z>>2]=0,r=0),I=d-l|0,y=r-l|0,(l|0)<0?(o[i>>2]=I,o[z>>2]=y,o[k>>2]=0,r=y,y=I,l=0):y=d,d=(r|0)<(y|0)?r:y,d=(l|0)<(d|0)?l:d,(d|0)<=0?(z=0,z|0):(o[i>>2]=y-d,o[z>>2]=r-d,o[k>>2]=l-d,z=0,z|0)}function Tl(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;k=i+8|0,l=o[k>>2]|0,r=(o[i>>2]|0)-l|0,z=i+4|0,l=(o[z>>2]|0)-l|0,d=Al(+((r*3|0)-l|0)/7)|0,o[i>>2]=d,r=Al(+((l<<1)+r|0)/7)|0,o[z>>2]=r,o[k>>2]=0,l=r-d|0,(d|0)<0?(I=0-d|0,o[z>>2]=l,o[k>>2]=I,o[i>>2]=0,r=l,d=0,l=I):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[k>>2]=l,o[z>>2]=0,r=0),I=d-l|0,y=r-l|0,(l|0)<0?(o[i>>2]=I,o[z>>2]=y,o[k>>2]=0,r=y,y=I,l=0):y=d,d=(r|0)<(y|0)?r:y,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=y-d,o[z>>2]=r-d,o[k>>2]=l-d)}function yo(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;k=i+8|0,l=o[k>>2]|0,r=(o[i>>2]|0)-l|0,z=i+4|0,l=(o[z>>2]|0)-l|0,d=Al(+((r<<1)+l|0)/7)|0,o[i>>2]=d,r=Al(+((l*3|0)-r|0)/7)|0,o[z>>2]=r,o[k>>2]=0,l=r-d|0,(d|0)<0?(I=0-d|0,o[z>>2]=l,o[k>>2]=I,o[i>>2]=0,r=l,d=0,l=I):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[k>>2]=l,o[z>>2]=0,r=0),I=d-l|0,y=r-l|0,(l|0)<0?(o[i>>2]=I,o[z>>2]=y,o[k>>2]=0,r=y,y=I,l=0):y=d,d=(r|0)<(y|0)?r:y,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=y-d,o[z>>2]=r-d,o[k>>2]=l-d)}function Wo(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;r=o[i>>2]|0,k=i+4|0,l=o[k>>2]|0,z=i+8|0,d=o[z>>2]|0,y=l+(r*3|0)|0,o[i>>2]=y,l=d+(l*3|0)|0,o[k>>2]=l,r=(d*3|0)+r|0,o[z>>2]=r,d=l-y|0,(y|0)<0?(r=r-y|0,o[k>>2]=d,o[z>>2]=r,o[i>>2]=0,l=d,d=0):d=y,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[z>>2]=r,o[k>>2]=0,l=0),I=d-r|0,y=l-r|0,(r|0)<0?(o[i>>2]=I,o[k>>2]=y,o[z>>2]=0,d=I,r=0):y=l,l=(y|0)<(d|0)?y:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[k>>2]=y-l,o[z>>2]=r-l)}function ma(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;y=o[i>>2]|0,k=i+4|0,r=o[k>>2]|0,z=i+8|0,l=o[z>>2]|0,d=(r*3|0)+y|0,y=l+(y*3|0)|0,o[i>>2]=y,o[k>>2]=d,r=(l*3|0)+r|0,o[z>>2]=r,l=d-y|0,(y|0)<0?(r=r-y|0,o[k>>2]=l,o[z>>2]=r,o[i>>2]=0,y=0):l=d,(l|0)<0&&(y=y-l|0,o[i>>2]=y,r=r-l|0,o[z>>2]=r,o[k>>2]=0,l=0),I=y-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=I,o[k>>2]=d,o[z>>2]=0,y=I,r=0):d=l,l=(d|0)<(y|0)?d:y,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=y-l,o[k>>2]=d-l,o[z>>2]=r-l)}function na(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0;(r+-1|0)>>>0>=6||(y=(o[15440+(r*12|0)>>2]|0)+(o[i>>2]|0)|0,o[i>>2]=y,z=i+4|0,d=(o[15440+(r*12|0)+4>>2]|0)+(o[z>>2]|0)|0,o[z>>2]=d,k=i+8|0,r=(o[15440+(r*12|0)+8>>2]|0)+(o[k>>2]|0)|0,o[k>>2]=r,l=d-y|0,(y|0)<0?(r=r-y|0,o[z>>2]=l,o[k>>2]=r,o[i>>2]=0,d=0):(l=d,d=y),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[k>>2]=r,o[z>>2]=0,l=0),I=d-r|0,y=l-r|0,(r|0)<0?(o[i>>2]=I,o[z>>2]=y,o[k>>2]=0,d=I,r=0):y=l,l=(y|0)<(d|0)?y:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[z>>2]=y-l,o[k>>2]=r-l))}function kl(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;y=o[i>>2]|0,k=i+4|0,r=o[k>>2]|0,z=i+8|0,l=o[z>>2]|0,d=r+y|0,y=l+y|0,o[i>>2]=y,o[k>>2]=d,r=l+r|0,o[z>>2]=r,l=d-y|0,(y|0)<0?(r=r-y|0,o[k>>2]=l,o[z>>2]=r,o[i>>2]=0,d=0):(l=d,d=y),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[z>>2]=r,o[k>>2]=0,l=0),I=d-r|0,y=l-r|0,(r|0)<0?(o[i>>2]=I,o[k>>2]=y,o[z>>2]=0,d=I,r=0):y=l,l=(y|0)<(d|0)?y:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[k>>2]=y-l,o[z>>2]=r-l)}function Ja(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;r=o[i>>2]|0,k=i+4|0,d=o[k>>2]|0,z=i+8|0,l=o[z>>2]|0,y=d+r|0,o[i>>2]=y,d=l+d|0,o[k>>2]=d,r=l+r|0,o[z>>2]=r,l=d-y|0,(y|0)<0?(r=r-y|0,o[k>>2]=l,o[z>>2]=r,o[i>>2]=0,d=0):(l=d,d=y),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[z>>2]=r,o[k>>2]=0,l=0),I=d-r|0,y=l-r|0,(r|0)<0?(o[i>>2]=I,o[k>>2]=y,o[z>>2]=0,d=I,r=0):y=l,l=(y|0)<(d|0)?y:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[k>>2]=y-l,o[z>>2]=r-l)}function Fa(i){switch(i=i|0,i|0){case 1:{i=5;break}case 5:{i=4;break}case 4:{i=6;break}case 6:{i=2;break}case 2:{i=3;break}case 3:{i=1;break}}return i|0}function gl(i){switch(i=i|0,i|0){case 1:{i=3;break}case 3:{i=2;break}case 2:{i=6;break}case 6:{i=4;break}case 4:{i=5;break}case 5:{i=1;break}}return i|0}function Ml(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;r=o[i>>2]|0,k=i+4|0,l=o[k>>2]|0,z=i+8|0,d=o[z>>2]|0,y=l+(r<<1)|0,o[i>>2]=y,l=d+(l<<1)|0,o[k>>2]=l,r=(d<<1)+r|0,o[z>>2]=r,d=l-y|0,(y|0)<0?(r=r-y|0,o[k>>2]=d,o[z>>2]=r,o[i>>2]=0,l=d,d=0):d=y,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[z>>2]=r,o[k>>2]=0,l=0),I=d-r|0,y=l-r|0,(r|0)<0?(o[i>>2]=I,o[k>>2]=y,o[z>>2]=0,d=I,r=0):y=l,l=(y|0)<(d|0)?y:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[k>>2]=y-l,o[z>>2]=r-l)}function yu(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;y=o[i>>2]|0,k=i+4|0,r=o[k>>2]|0,z=i+8|0,l=o[z>>2]|0,d=(r<<1)+y|0,y=l+(y<<1)|0,o[i>>2]=y,o[k>>2]=d,r=(l<<1)+r|0,o[z>>2]=r,l=d-y|0,(y|0)<0?(r=r-y|0,o[k>>2]=l,o[z>>2]=r,o[i>>2]=0,y=0):l=d,(l|0)<0&&(y=y-l|0,o[i>>2]=y,r=r-l|0,o[z>>2]=r,o[k>>2]=0,l=0),I=y-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=I,o[k>>2]=d,o[z>>2]=0,y=I,r=0):d=l,l=(d|0)<(y|0)?d:y,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=y-l,o[k>>2]=d-l,o[z>>2]=r-l)}function ps(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0;return k=(o[i>>2]|0)-(o[r>>2]|0)|0,z=(k|0)<0,d=(o[i+4>>2]|0)-(o[r+4>>2]|0)-(z?k:0)|0,I=(d|0)<0,y=(z?0-k|0:0)+(o[i+8>>2]|0)-(o[r+8>>2]|0)+(I?0-d|0:0)|0,i=(y|0)<0,r=i?0:y,l=(I?0:d)-(i?y:0)|0,y=(z?0:k)-(I?d:0)-(i?y:0)|0,i=(l|0)<(y|0)?l:y,i=(r|0)<(i|0)?r:i,d=(i|0)>0,r=r-(d?i:0)|0,l=l-(d?i:0)|0,i=y-(d?i:0)|0,i=(i|0)>-1?i:0-i|0,l=(l|0)>-1?l:0-l|0,r=(r|0)>-1?r:0-r|0,r=(l|0)>(r|0)?l:r,((i|0)>(r|0)?i:r)|0}function lc(i,r){i=i|0,r=r|0;var l=0;l=o[i+8>>2]|0,o[r>>2]=(o[i>>2]|0)-l,o[r+4>>2]=(o[i+4>>2]|0)-l}function uo(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0;d=o[i>>2]|0,o[r>>2]=d,y=o[i+4>>2]|0,k=r+4|0,o[k>>2]=y,z=r+8|0,o[z>>2]=0,l=(y|0)<(d|0),i=l?d:y,l=l?y:d;do if((l|0)<0){if((i|0)>0){if((i|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-i|0)>=(l|0)))break;return i=1,i|0}if((l|0)==-2147483648|(-2147483648-i|0)>(l|0))return r=1,r|0;if((i|0)>-1){if((i|-2147483648|0)<(l|0))break;return i=1,i|0}else{if((i^-2147483648|0)<(l|0))i=1;else break;return i|0}}while(!1);return i=y-d|0,(d|0)<0?(l=0-d|0,o[k>>2]=i,o[z>>2]=l,o[r>>2]=0,d=0):(i=y,l=0),(i|0)<0&&(d=d-i|0,o[r>>2]=d,l=l-i|0,o[z>>2]=l,o[k>>2]=0,i=0),I=d-l|0,y=i-l|0,(l|0)<0?(o[r>>2]=I,o[k>>2]=y,o[z>>2]=0,i=y,y=I,l=0):y=d,d=(i|0)<(y|0)?i:y,d=(l|0)<(d|0)?l:d,(d|0)<=0?(r=0,r|0):(o[r>>2]=y-d,o[k>>2]=i-d,o[z>>2]=l-d,r=0,r|0)}function co(i){i=i|0;var r=0,l=0,d=0,y=0;r=i+8|0,y=o[r>>2]|0,l=y-(o[i>>2]|0)|0,o[i>>2]=l,d=i+4|0,i=(o[d>>2]|0)-y|0,o[d>>2]=i,o[r>>2]=0-(i+l)}function Xl(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;l=o[i>>2]|0,r=0-l|0,o[i>>2]=r,k=i+8|0,o[k>>2]=0,z=i+4|0,d=o[z>>2]|0,y=d+l|0,(l|0)>0?(o[z>>2]=y,o[k>>2]=l,o[i>>2]=0,r=0,d=y):l=0,(d|0)<0?(I=r-d|0,o[i>>2]=I,l=l-d|0,o[k>>2]=l,o[z>>2]=0,y=I-l|0,r=0-l|0,(l|0)<0?(o[i>>2]=y,o[z>>2]=r,o[k>>2]=0,d=r,l=0):(d=0,y=I)):y=r,r=(d|0)<(y|0)?d:y,r=(l|0)<(r|0)?l:r,!((r|0)<=0)&&(o[i>>2]=y-r,o[z>>2]=d-r,o[k>>2]=l-r)}function No(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0;if(Ie=Bt,Bt=Bt+64|0,Ae=Ie,z=Ie+56|0,!(!0&(r&2013265920|0)==134217728&(!0&(d&2013265920|0)==134217728)))return y=5,Bt=Ie,y|0;if((i|0)==(l|0)&(r|0)==(d|0))return o[y>>2]=0,y=0,Bt=Ie,y|0;if(k=Ht(i|0,r|0,52)|0,qt()|0,k=k&15,Y=Ht(l|0,d|0,52)|0,qt()|0,(k|0)!=(Y&15|0))return y=12,Bt=Ie,y|0;if(I=k+-1|0,k>>>0>1){Kr(i,r,I,Ae)|0,Kr(l,d,I,z)|0,Y=Ae,Z=o[Y>>2]|0,Y=o[Y+4>>2]|0;e:do if((Z|0)==(o[z>>2]|0)&&(Y|0)==(o[z+4>>2]|0)){k=(k^15)*3|0,I=Ht(i|0,r|0,k|0)|0,qt()|0,I=I&7,k=Ht(l|0,d|0,k|0)|0,qt()|0,k=k&7;do if((I|0)==0|(k|0)==0)o[y>>2]=1,I=0;else if((I|0)==7)I=5;else{if((I|0)==1|(k|0)==1&&Br(Z,Y)|0){I=5;break}if((o[15536+(I<<2)>>2]|0)!=(k|0)&&(o[15568+(I<<2)>>2]|0)!=(k|0))break e;o[y>>2]=1,I=0}while(!1);return y=I,Bt=Ie,y|0}while(!1)}I=Ae,k=I+56|0;do o[I>>2]=0,I=I+4|0;while((I|0)<(k|0));return Qa(i,r,1,Ae)|0,r=Ae,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0))&&(r=Ae+8|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=Ae+16|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=Ae+24|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=Ae+32|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=Ae+40|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))?(I=Ae+48|0,I=((o[I>>2]|0)==(l|0)?(o[I+4>>2]|0)==(d|0):0)&1):I=1,o[y>>2]=I,y=0,Bt=Ie,y|0}function $o(i,r,l,d,y){return i=i|0,r=r|0,l=l|0,d=d|0,y=y|0,l=Wa(i,r,l,d)|0,(l|0)==7?(y=11,y|0):(d=Qt(l|0,0,56)|0,r=r&-2130706433|(qt()|0)|268435456,o[y>>2]=i|d,o[y+4>>2]=r,y=0,y|0)}function Mo(i,r,l){return i=i|0,r=r|0,l=l|0,!0&(r&2013265920|0)==268435456?(o[l>>2]=i,o[l+4>>2]=r&-2130706433|134217728,l=0,l|0):(l=6,l|0)}function Qs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;return y=Bt,Bt=Bt+16|0,d=y,o[d>>2]=0,!0&(r&2013265920|0)==268435456?(I=Ht(i|0,r|0,56)|0,qt()|0,d=ds(i,r&-2130706433|134217728,I&7,d,l)|0,Bt=y,d|0):(d=6,Bt=y,d|0)}function Xo(i,r){i=i|0,r=r|0;var l=0;switch(l=Ht(i|0,r|0,56)|0,qt()|0,l&7){case 0:case 7:return l=0,l|0}return l=r&-2130706433|134217728,!(!0&(r&2013265920|0)==268435456)||!0&(r&117440512|0)==16777216&(Br(i,l)|0)!=0?(l=0,l|0):(l=as(i,l)|0,l|0)}function Yo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0;return y=Bt,Bt=Bt+16|0,d=y,!0&(r&2013265920|0)==268435456?(I=r&-2130706433|134217728,k=l,o[k>>2]=i,o[k+4>>2]=I,o[d>>2]=0,r=Ht(i|0,r|0,56)|0,qt()|0,d=ds(i,I,r&7,d,l+8|0)|0,Bt=y,d|0):(d=6,Bt=y,d|0)}function Ko(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0;return y=(Br(i,r)|0)==0,r=r&-2130706433,d=l,o[d>>2]=y?i:0,o[d+4>>2]=y?r|285212672:0,d=l+8|0,o[d>>2]=i,o[d+4>>2]=r|301989888,d=l+16|0,o[d>>2]=i,o[d+4>>2]=r|318767104,d=l+24|0,o[d>>2]=i,o[d+4>>2]=r|335544320,d=l+32|0,o[d>>2]=i,o[d+4>>2]=r|352321536,l=l+40|0,o[l>>2]=i,o[l+4>>2]=r|369098752,0}function Ta(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0;return k=Bt,Bt=Bt+16|0,y=k,I=r&-2130706433|134217728,!0&(r&2013265920|0)==268435456?(d=Ht(i|0,r|0,56)|0,qt()|0,d=gn(i,I,d&7)|0,(d|0)==-1?(o[l>>2]=0,I=6,Bt=k,I|0):(ns(i,I,y)|0&&kn(23313,22484,282,22499),r=Ht(i|0,r|0,52)|0,qt()|0,r=r&15,Br(i,I)|0?Jo(y,r,d,2,l):pr(y,r,d,2,l),I=0,Bt=k,I|0)):(I=6,Bt=k,I|0)}function eo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0;d=Bt,Bt=Bt+16|0,y=d,Ds(i,r,l,y),Mr(y,l+4|0),Bt=d}function Ds(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0;if(z=Bt,Bt=Bt+16|0,Z=z,vu(i,l,Z),I=+Sn(+(1-+Me[Z>>3]*.5)),I<1e-16){o[d>>2]=0,o[d+4>>2]=0,o[d+8>>2]=0,o[d+12>>2]=0,Bt=z;return}if(Z=o[l>>2]|0,y=+Me[15920+(Z*24|0)>>3],y=+_l(y-+_l(+Nt(15600+(Z<<4)|0,i))),Ws(r)|0?k=+_l(y+-.3334731722518321):k=y,y=+Jt(+I)/.381966011250105,(r|0)>0){i=0;do y=y*2.6457513110645907,i=i+1|0;while((i|0)!=(r|0))}I=+bi(+k)*y,Me[d>>3]=I,k=+Si(+k)*y,Me[d+8>>3]=k,Bt=z}function vu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;if(I=Bt,Bt=Bt+32|0,y=I,vs(i,y),o[r>>2]=0,Me[l>>3]=5,d=+br(16400,y),d<+Me[l>>3]&&(o[r>>2]=0,Me[l>>3]=d),d=+br(16424,y),d<+Me[l>>3]&&(o[r>>2]=1,Me[l>>3]=d),d=+br(16448,y),d<+Me[l>>3]&&(o[r>>2]=2,Me[l>>3]=d),d=+br(16472,y),d<+Me[l>>3]&&(o[r>>2]=3,Me[l>>3]=d),d=+br(16496,y),d<+Me[l>>3]&&(o[r>>2]=4,Me[l>>3]=d),d=+br(16520,y),d<+Me[l>>3]&&(o[r>>2]=5,Me[l>>3]=d),d=+br(16544,y),d<+Me[l>>3]&&(o[r>>2]=6,Me[l>>3]=d),d=+br(16568,y),d<+Me[l>>3]&&(o[r>>2]=7,Me[l>>3]=d),d=+br(16592,y),d<+Me[l>>3]&&(o[r>>2]=8,Me[l>>3]=d),d=+br(16616,y),d<+Me[l>>3]&&(o[r>>2]=9,Me[l>>3]=d),d=+br(16640,y),d<+Me[l>>3]&&(o[r>>2]=10,Me[l>>3]=d),d=+br(16664,y),d<+Me[l>>3]&&(o[r>>2]=11,Me[l>>3]=d),d=+br(16688,y),d<+Me[l>>3]&&(o[r>>2]=12,Me[l>>3]=d),d=+br(16712,y),d<+Me[l>>3]&&(o[r>>2]=13,Me[l>>3]=d),d=+br(16736,y),d<+Me[l>>3]&&(o[r>>2]=14,Me[l>>3]=d),d=+br(16760,y),d<+Me[l>>3]&&(o[r>>2]=15,Me[l>>3]=d),d=+br(16784,y),d<+Me[l>>3]&&(o[r>>2]=16,Me[l>>3]=d),d=+br(16808,y),d<+Me[l>>3]&&(o[r>>2]=17,Me[l>>3]=d),d=+br(16832,y),d<+Me[l>>3]&&(o[r>>2]=18,Me[l>>3]=d),d=+br(16856,y),!(d<+Me[l>>3])){Bt=I;return}o[r>>2]=19,Me[l>>3]=d,Bt=I}function Pr(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0;if(I=+Uu(i),I<1e-16){r=15600+(r<<4)|0,o[y>>2]=o[r>>2],o[y+4>>2]=o[r+4>>2],o[y+8>>2]=o[r+8>>2],o[y+12>>2]=o[r+12>>2];return}if(k=+Hn(+ +Me[i+8>>3],+ +Me[i>>3]),(l|0)>0){i=0;do I=I/2.6457513110645907,i=i+1|0;while((i|0)!=(l|0))}d?(I=I/3,l=(Ws(l)|0)==0,I=+mn(+((l?I:I/2.6457513110645907)*.381966011250105))):(I=+mn(+(I*.381966011250105)),Ws(l)|0&&(k=+_l(k+.3334731722518321))),ni(15600+(r<<4)|0,+_l(+Me[15920+(r*24|0)>>3]-k),I,y)}function Kn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0;d=Bt,Bt=Bt+16|0,y=d,Ys(i+4|0,y),Pr(y,o[i>>2]|0,r,0,l),Bt=d}function Jo(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0,ai=0,Wi=0,$i=0,Ei=0,Hi=0,ji=0,cn=0,Nn=0,nn=0;if(cn=Bt,Bt=Bt+272|0,I=cn+256|0,ft=cn+240|0,Ei=cn,Hi=cn+224|0,ji=cn+208|0,Tt=cn+176|0,It=cn+160|0,si=cn+192|0,Kt=cn+144|0,ii=cn+128|0,ai=cn+112|0,Wi=cn+96|0,$i=cn+80|0,o[I>>2]=r,o[ft>>2]=o[i>>2],o[ft+4>>2]=o[i+4>>2],o[ft+8>>2]=o[i+8>>2],o[ft+12>>2]=o[i+12>>2],Vr(ft,I,Ei),o[y>>2]=0,ft=d+l+((d|0)==5&1)|0,(ft|0)<=(l|0)){Bt=cn;return}Z=o[I>>2]|0,Y=Hi+4|0,Ae=Tt+4|0,Ie=l+5|0,ke=16880+(Z<<2)|0,Fe=16960+(Z<<2)|0,ze=ii+8|0,tt=ai+8|0,wt=Wi+8|0,lt=ji+4|0,z=l;e:for(;;){k=Ei+(((z|0)%5|0)<<4)|0,o[ji>>2]=o[k>>2],o[ji+4>>2]=o[k+4>>2],o[ji+8>>2]=o[k+8>>2],o[ji+12>>2]=o[k+12>>2];do;while((to(ji,Z,0,1)|0)==2);if((z|0)>(l|0)&(Ws(r)|0)!=0){if(o[Tt>>2]=o[ji>>2],o[Tt+4>>2]=o[ji+4>>2],o[Tt+8>>2]=o[ji+8>>2],o[Tt+12>>2]=o[ji+12>>2],Ys(Y,It),d=o[Tt>>2]|0,I=o[17040+(d*80|0)+(o[Hi>>2]<<2)>>2]|0,o[Tt>>2]=o[18640+(d*80|0)+(I*20|0)>>2],k=o[18640+(d*80|0)+(I*20|0)+16>>2]|0,(k|0)>0){i=0;do kl(Ae),i=i+1|0;while((i|0)<(k|0))}switch(k=18640+(d*80|0)+(I*20|0)+4|0,o[si>>2]=o[k>>2],o[si+4>>2]=o[k+4>>2],o[si+8>>2]=o[k+8>>2],Nr(si,(o[ke>>2]|0)*3|0),Sr(Ae,si,Ae),Or(Ae),Ys(Ae,Kt),Nn=+(o[Fe>>2]|0),Me[ii>>3]=Nn*3,Me[ze>>3]=0,nn=Nn*-1.5,Me[ai>>3]=nn,Me[tt>>3]=Nn*2.598076211353316,Me[Wi>>3]=nn,Me[wt>>3]=Nn*-2.598076211353316,o[17040+((o[Tt>>2]|0)*80|0)+(o[ji>>2]<<2)>>2]|0){case 1:{i=ai,d=ii;break}case 3:{i=Wi,d=ai;break}case 2:{i=ii,d=Wi;break}default:{i=12;break e}}Au(It,Kt,d,i,$i),Pr($i,o[Tt>>2]|0,Z,1,y+8+(o[y>>2]<<4)|0),o[y>>2]=(o[y>>2]|0)+1}if((z|0)<(Ie|0)&&(Ys(lt,Tt),Pr(Tt,o[ji>>2]|0,Z,1,y+8+(o[y>>2]<<4)|0),o[y>>2]=(o[y>>2]|0)+1),o[Hi>>2]=o[ji>>2],o[Hi+4>>2]=o[ji+4>>2],o[Hi+8>>2]=o[ji+8>>2],o[Hi+12>>2]=o[ji+12>>2],z=z+1|0,(z|0)>=(ft|0)){i=3;break}}if((i|0)==3){Bt=cn;return}else(i|0)==12&&kn(22522,22569,571,22579)}function Vr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0;Z=Bt,Bt=Bt+128|0,d=Z+64|0,y=Z,I=d,k=20240,z=I+60|0;do o[I>>2]=o[k>>2],I=I+4|0,k=k+4|0;while((I|0)<(z|0));I=y,k=20304,z=I+60|0;do o[I>>2]=o[k>>2],I=I+4|0,k=k+4|0;while((I|0)<(z|0));z=(Ws(o[r>>2]|0)|0)==0,d=z?d:y,y=i+4|0,Ml(y),yu(y),Ws(o[r>>2]|0)|0&&(ma(y),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,Sr(y,d,r),Or(r),o[l+16>>2]=o[i>>2],r=l+20|0,Sr(y,d+12|0,r),Or(r),o[l+32>>2]=o[i>>2],r=l+36|0,Sr(y,d+24|0,r),Or(r),o[l+48>>2]=o[i>>2],r=l+52|0,Sr(y,d+36|0,r),Or(r),o[l+64>>2]=o[i>>2],l=l+68|0,Sr(y,d+48|0,l),Or(l),Bt=Z}function to(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0;if(ze=Bt,Bt=Bt+32|0,ke=ze+12|0,z=ze,Fe=i+4|0,Ie=o[16960+(r<<2)>>2]|0,Ae=(d|0)!=0,Ie=Ae?Ie*3|0:Ie,y=o[Fe>>2]|0,Y=i+8|0,k=o[Y>>2]|0,Ae){if(I=i+12|0,d=o[I>>2]|0,y=k+y+d|0,(y|0)==(Ie|0))return Fe=1,Bt=ze,Fe|0;Z=I}else Z=i+12|0,d=o[Z>>2]|0,y=k+y+d|0;if((y|0)<=(Ie|0))return Fe=0,Bt=ze,Fe|0;do if((d|0)>0){if(d=o[i>>2]|0,(k|0)>0){I=18640+(d*80|0)+60|0,d=i;break}d=18640+(d*80|0)+40|0,l?(sr(ke,Ie,0,0),ra(Fe,ke,z),Ja(z),Sr(z,ke,Fe),I=d,d=i):(I=d,d=i)}else I=18640+((o[i>>2]|0)*80|0)+20|0,d=i;while(!1);if(o[d>>2]=o[I>>2],y=I+16|0,(o[y>>2]|0)>0){d=0;do kl(Fe),d=d+1|0;while((d|0)<(o[y>>2]|0))}return i=I+4|0,o[ke>>2]=o[i>>2],o[ke+4>>2]=o[i+4>>2],o[ke+8>>2]=o[i+8>>2],r=o[16880+(r<<2)>>2]|0,Nr(ke,Ae?r*3|0:r),Sr(Fe,ke,Fe),Or(Fe),Ae?d=((o[Y>>2]|0)+(o[Fe>>2]|0)+(o[Z>>2]|0)|0)==(Ie|0)?1:2:d=2,Fe=d,Bt=ze,Fe|0}function ss(i,r){i=i|0,r=r|0;var l=0;do l=to(i,r,0,1)|0;while((l|0)==2);return l|0}function pr(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0,ai=0,Wi=0,$i=0,Ei=0;if(Wi=Bt,Bt=Bt+240|0,I=Wi+224|0,si=Wi+208|0,Kt=Wi,ii=Wi+192|0,ai=Wi+176|0,wt=Wi+160|0,lt=Wi+144|0,ft=Wi+128|0,Tt=Wi+112|0,It=Wi+96|0,o[I>>2]=r,o[si>>2]=o[i>>2],o[si+4>>2]=o[i+4>>2],o[si+8>>2]=o[i+8>>2],o[si+12>>2]=o[i+12>>2],Po(si,I,Kt),o[y>>2]=0,tt=d+l+((d|0)==6&1)|0,(tt|0)<=(l|0)){Bt=Wi;return}Z=o[I>>2]|0,Y=l+6|0,Ae=16960+(Z<<2)|0,Ie=lt+8|0,ke=ft+8|0,Fe=Tt+8|0,ze=ii+4|0,k=0,z=l,d=-1;e:for(;;){if(I=(z|0)%6|0,i=Kt+(I<<4)|0,o[ii>>2]=o[i>>2],o[ii+4>>2]=o[i+4>>2],o[ii+8>>2]=o[i+8>>2],o[ii+12>>2]=o[i+12>>2],i=k,k=to(ii,Z,0,1)|0,(z|0)>(l|0)&(Ws(r)|0)!=0&&(i|0)!=1&&(o[ii>>2]|0)!=(d|0)){switch(Ys(Kt+(((I+5|0)%6|0)<<4)+4|0,ai),Ys(Kt+(I<<4)+4|0,wt),$i=+(o[Ae>>2]|0),Me[lt>>3]=$i*3,Me[Ie>>3]=0,Ei=$i*-1.5,Me[ft>>3]=Ei,Me[ke>>3]=$i*2.598076211353316,Me[Tt>>3]=Ei,Me[Fe>>3]=$i*-2.598076211353316,I=o[si>>2]|0,o[17040+(I*80|0)+(((d|0)==(I|0)?o[ii>>2]|0:d)<<2)>>2]|0){case 1:{i=ft,d=lt;break}case 3:{i=Tt,d=ft;break}case 2:{i=lt,d=Tt;break}default:{i=8;break e}}Au(ai,wt,d,i,It),!(Gu(ai,It)|0)&&!(Gu(wt,It)|0)&&(Pr(It,o[si>>2]|0,Z,1,y+8+(o[y>>2]<<4)|0),o[y>>2]=(o[y>>2]|0)+1)}if((z|0)<(Y|0)&&(Ys(ze,ai),Pr(ai,o[ii>>2]|0,Z,1,y+8+(o[y>>2]<<4)|0),o[y>>2]=(o[y>>2]|0)+1),z=z+1|0,(z|0)>=(tt|0)){i=3;break}else d=o[ii>>2]|0}if((i|0)==3){Bt=Wi;return}else(i|0)==8&&kn(22606,22569,736,22651)}function Po(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0;Z=Bt,Bt=Bt+160|0,d=Z+80|0,y=Z,I=d,k=20368,z=I+72|0;do o[I>>2]=o[k>>2],I=I+4|0,k=k+4|0;while((I|0)<(z|0));I=y,k=20448,z=I+72|0;do o[I>>2]=o[k>>2],I=I+4|0,k=k+4|0;while((I|0)<(z|0));z=(Ws(o[r>>2]|0)|0)==0,d=z?d:y,y=i+4|0,Ml(y),yu(y),Ws(o[r>>2]|0)|0&&(ma(y),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,Sr(y,d,r),Or(r),o[l+16>>2]=o[i>>2],r=l+20|0,Sr(y,d+12|0,r),Or(r),o[l+32>>2]=o[i>>2],r=l+36|0,Sr(y,d+24|0,r),Or(r),o[l+48>>2]=o[i>>2],r=l+52|0,Sr(y,d+36|0,r),Or(r),o[l+64>>2]=o[i>>2],r=l+68|0,Sr(y,d+48|0,r),Or(r),o[l+80>>2]=o[i>>2],l=l+84|0,Sr(y,d+60|0,l),Or(l),Bt=Z}function qn(i,r){return i=i|0,r=r|0,r=Ht(i|0,r|0,52)|0,qt()|0,r&15|0}function Ul(i,r){return i=i|0,r=r|0,r=Ht(i|0,r|0,45)|0,qt()|0,r&127|0}function as(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0;if(!(!0&(r&-16777216|0)==134217728)||(k=Ht(i|0,r|0,45)|0,qt()|0,k=k&127,k>>>0>121))return r=0,r|0;l=Ht(i|0,r|0,52)|0,qt()|0,l=l&15;do if(l|0){for(y=1,d=0;;){if(I=Ht(i|0,r|0,(15-y|0)*3|0)|0,qt()|0,I=I&7,(I|0)!=0&(d^1))if((I|0)==1&(at(k)|0)!=0){z=0,d=13;break}else d=1;if((I|0)==7){z=0,d=13;break}if(y>>>0<l>>>0)y=y+1|0;else{d=9;break}}if((d|0)==9){if((l|0)==15)z=1;else break;return z|0}else if((d|0)==13)return z|0}while(!1);for(;;){if(z=Ht(i|0,r|0,(14-l|0)*3|0)|0,qt()|0,!((z&7|0)==7&!0)){z=0,d=13;break}if(l>>>0<14)l=l+1|0;else{z=1,d=13;break}}return(d|0)==13?z|0:0}function Kr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0;if(I=Ht(i|0,r|0,52)|0,qt()|0,I=I&15,l>>>0>15)return d=4,d|0;if((I|0)<(l|0))return d=12,d|0;if((I|0)==(l|0))return o[d>>2]=i,o[d+4>>2]=r,d=0,d|0;if(y=Qt(l|0,0,52)|0,y=y|i,i=qt()|0|r&-15728641,(I|0)>(l|0))do r=Qt(7,0,(14-l|0)*3|0)|0,l=l+1|0,y=r|y,i=qt()|0|i;while((l|0)<(I|0));return o[d>>2]=y,o[d+4>>2]=i,d=0,d|0}function Ls(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0;if(I=Ht(i|0,r|0,52)|0,qt()|0,I=I&15,!((l|0)<16&(I|0)<=(l|0)))return d=4,d|0;y=l-I|0,l=Ht(i|0,r|0,45)|0,qt()|0;e:do if(!(at(l&127)|0))l=yl(7,0,y,((y|0)<0)<<31>>31)|0,y=qt()|0;else{t:do if(I|0){for(l=1;k=Qt(7,0,(15-l|0)*3|0)|0,!!((k&i|0)==0&((qt()|0)&r|0)==0);)if(l>>>0<I>>>0)l=l+1|0;else break t;l=yl(7,0,y,((y|0)<0)<<31>>31)|0,y=qt()|0;break e}while(!1);l=yl(7,0,y,((y|0)<0)<<31>>31)|0,l=Xe(l|0,qt()|0,5,0)|0,l=R(l|0,qt()|0,-5,-1)|0,l=le(l|0,qt()|0,6,0)|0,l=R(l|0,qt()|0,1,0)|0,y=qt()|0}while(!1);return k=d,o[k>>2]=l,o[k+4>>2]=y,k=0,k|0}function Br(i,r){i=i|0,r=r|0;var l=0,d=0,y=0;if(y=Ht(i|0,r|0,45)|0,qt()|0,!(at(y&127)|0))return y=0,y|0;y=Ht(i|0,r|0,52)|0,qt()|0,y=y&15;e:do if(!y)l=0;else for(d=1;;){if(l=Ht(i|0,r|0,(15-d|0)*3|0)|0,qt()|0,l=l&7,l|0)break e;if(d>>>0<y>>>0)d=d+1|0;else{l=0;break}}while(!1);return y=(l|0)==0&1,y|0}function ar(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0;if(k=Bt,Bt=Bt+16|0,I=k,hl(I,i,r,l),r=I,i=o[r>>2]|0,r=o[r+4>>2]|0,(i|0)==0&(r|0)==0)return Bt=k,0;y=0,l=0;do z=d+(y<<3)|0,o[z>>2]=i,o[z+4>>2]=r,y=R(y|0,l|0,1,0)|0,l=qt()|0,cu(I),z=I,i=o[z>>2]|0,r=o[z+4>>2]|0;while(!((i|0)==0&(r|0)==0));return Bt=k,0}function ul(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,(d|0)<(l|0)?(l=r,d=i,en(l|0),d|0):(l=Qt(-1,-1,((d-l|0)*3|0)+3|0)|0,d=Qt(~l|0,~(qt()|0)|0,(15-d|0)*3|0)|0,l=~(qt()|0)&r,d=~d&i,en(l|0),d|0)}function is(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0;return y=Ht(i|0,r|0,52)|0,qt()|0,y=y&15,(l|0)<16&(y|0)<=(l|0)?((y|0)<(l|0)&&(y=Qt(-1,-1,((l+-1-y|0)*3|0)+3|0)|0,y=Qt(~y|0,~(qt()|0)|0,(15-l|0)*3|0)|0,r=~(qt()|0)&r,i=~y&i),y=Qt(l|0,0,52)|0,l=r&-15728641|(qt()|0),o[d>>2]=i|y,o[d+4>>2]=l,d=0,d|0):(d=4,d|0)}function Do(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0,ai=0;if((l|0)==0&(d|0)==0)return ii=0,ii|0;if(y=i,I=o[y>>2]|0,y=o[y+4>>2]|0,!0&(y&15728640|0)==0){if(!((d|0)>0|(d|0)==0&l>>>0>0)||(ii=r,o[ii>>2]=I,o[ii+4>>2]=y,(l|0)==1&(d|0)==0))return ii=0,ii|0;y=1;do si=i+(y<<3)|0,Kt=o[si+4>>2]|0,ii=r+(y<<3)|0,o[ii>>2]=o[si>>2],o[ii+4>>2]=Kt,y=y+1|0;while(0<(d|0)|(d|0)==0&y>>>0<l>>>0);return y=0,y|0}if(It=l<<3,Kt=zs(It)|0,!Kt)return ii=13,ii|0;if(O(Kt|0,i|0,It|0)|0,si=L(l,8)|0,!si)return T(Kt),ii=13,ii|0;e:do if(l|0){t:for(;;){y=Kt,lt=o[y>>2]|0,y=o[y+4>>2]|0,ft=Ht(lt|0,y|0,52)|0,qt()|0,ft=ft&15,Tt=ft+-1|0,wt=(l|0)>0;i:do if((ft|0)!=0&wt){if(Fe=((l|0)<0)<<31>>31,ze=Qt(Tt|0,0,52)|0,tt=qt()|0,Tt>>>0>15){if(!((lt|0)==0&(y|0)==0)){ii=17;break t}for(I=0;;){if(I=I+1|0,(I|0)>=(l|0))break i;if(d=Kt+(I<<3)|0,tt=o[d>>2]|0,d=o[d+4>>2]|0,!((tt|0)==0&(d|0)==0)){y=d,ii=17;break t}}}for(I=0,i=lt,d=y;;){if(!((i|0)==0&(d|0)==0)){if(!(!0&(d&117440512|0)==0)){ii=22;break t}if(z=Ht(i|0,d|0,52)|0,qt()|0,z=z&15,(z|0)<(Tt|0)){y=12,ii=28;break t}if((z|0)!=(Tt|0)&&(i=i|ze,d=d&-15728641|tt,z>>>0>=ft>>>0)){k=Tt;do ke=Qt(7,0,(14-k|0)*3|0)|0,k=k+1|0,i=ke|i,d=qt()|0|d;while(k>>>0<z>>>0)}if(k=kt(i|0,d|0,l|0,Fe|0)|0,qt()|0,Y=si+(k<<3)|0,z=Y,Z=o[z>>2]|0,z=o[z+4>>2]|0,(Z|0)==0&(z|0)==0)k=Y;else for(ke=0;;){if((ke|0)>(l|0)){ii=32;break t}if((Z|0)==(i|0)&(z&-117440513|0)==(d|0)){Ae=Ht(Z|0,z|0,56)|0,qt()|0,Ae=Ae&7,Ie=Ae+1|0,ai=Ht(Z|0,z|0,45)|0,qt()|0;n:do if(!(at(ai&127)|0))z=7;else{if(Z=Ht(Z|0,z|0,52)|0,qt()|0,Z=Z&15,!Z){z=6;break}for(z=1;;){if(ai=Qt(7,0,(15-z|0)*3|0)|0,!((ai&i|0)==0&((qt()|0)&d|0)==0)){z=7;break n}if(z>>>0<Z>>>0)z=z+1|0;else{z=6;break}}}while(!1);if((Ae+2|0)>>>0>z>>>0){ii=42;break t}ai=Qt(Ie|0,0,56)|0,d=qt()|0|d&-117440513,Ie=Y,o[Ie>>2]=0,o[Ie+4>>2]=0,i=ai|i}else k=(k+1|0)%(l|0)|0;if(Y=si+(k<<3)|0,z=Y,Z=o[z>>2]|0,z=o[z+4>>2]|0,(Z|0)==0&(z|0)==0){k=Y;break}else ke=ke+1|0}ai=k,o[ai>>2]=i,o[ai+4>>2]=d}if(I=I+1|0,(I|0)>=(l|0))break i;d=Kt+(I<<3)|0,i=o[d>>2]|0,d=o[d+4>>2]|0}}while(!1);if((l+5|0)>>>0<11){ii=85;break}if(tt=L((l|0)/6|0,8)|0,!tt){ii=49;break}i:do if(wt){ke=0,Ie=0;do{if(z=si+(ke<<3)|0,d=z,I=o[d>>2]|0,d=o[d+4>>2]|0,!((I|0)==0&(d|0)==0)){Z=Ht(I|0,d|0,56)|0,qt()|0,Z=Z&7,i=Z+1|0,Y=d&-117440513,ai=Ht(I|0,d|0,45)|0,qt()|0;n:do if(at(ai&127)|0){if(Ae=Ht(I|0,d|0,52)|0,qt()|0,Ae=Ae&15,Ae|0)for(k=1;;){if(ai=Qt(7,0,(15-k|0)*3|0)|0,!((I&ai|0)==0&(Y&(qt()|0)|0)==0))break n;if(k>>>0<Ae>>>0)k=k+1|0;else break}d=Qt(i|0,0,56)|0,I=d|I,d=qt()|0|Y,i=z,o[i>>2]=I,o[i+4>>2]=d,i=Z+2|0}while(!1);(i|0)==7&&(ai=tt+(Ie<<3)|0,o[ai>>2]=I,o[ai+4>>2]=d&-117440513,Ie=Ie+1|0)}ke=ke+1|0}while((ke|0)!=(l|0));if(wt){if(ke=((l|0)<0)<<31>>31,Fe=Qt(Tt|0,0,52)|0,ze=qt()|0,Tt>>>0>15){if(!((lt|0)==0&(y|0)==0)){y=4,ii=84;break t}for(y=0;;){if(y=y+1|0,(y|0)>=(l|0)){I=0,y=Ie;break i}if(ai=Kt+(y<<3)|0,!((o[ai>>2]|0)==0&(o[ai+4>>2]|0)==0)){y=4,ii=84;break t}}}for(Ae=0,I=0,Y=lt;;){do if(!((Y|0)==0&(y|0)==0)){if(z=Ht(Y|0,y|0,52)|0,qt()|0,z=z&15,(z|0)<(Tt|0)){y=12,ii=84;break t}do if((z|0)==(Tt|0))d=Y,z=y;else{if(d=Y|Fe,i=y&-15728641|ze,z>>>0<ft>>>0){z=i;break}k=Tt;do ai=Qt(7,0,(14-k|0)*3|0)|0,k=k+1|0,d=ai|d,i=qt()|0|i;while(k>>>0<z>>>0);z=i}while(!1);for(k=kt(d|0,z|0,l|0,ke|0)|0,qt()|0,i=0;;){if((i|0)>(l|0)){ii=77;break t}if(ai=si+(k<<3)|0,Z=o[ai+4>>2]|0,(Z&-117440513|0)==(z|0)&&(o[ai>>2]|0)==(d|0)){ii=79;break}if(k=(k+1|0)%(l|0)|0,ai=si+(k<<3)|0,(o[ai>>2]|0)==(d|0)&&(o[ai+4>>2]|0)==(z|0))break;i=i+1|0}if((ii|0)==79&&(ii=0,!0&(Z&117440512|0)==100663296))break;ai=r+(I<<3)|0,o[ai>>2]=Y,o[ai+4>>2]=y,I=I+1|0}while(!1);if(y=Ae+1|0,(y|0)>=(l|0)){y=Ie;break i}ai=Kt+(y<<3)|0,Ae=y,Y=o[ai>>2]|0,y=o[ai+4>>2]|0}}else I=0,y=Ie}else I=0,y=0;while(!1);if(V(si|0,0,It|0)|0,O(Kt|0,tt|0,y<<3|0)|0,T(tt),y)r=r+(I<<3)|0,l=y;else break e}if((ii|0)==17)!0&(y&117440512|0)==0?(y=4,ii=28):ii=22;else if((ii|0)==32)kn(23313,22674,362,22684);else{if((ii|0)==42)return T(Kt),T(si),ai=10,ai|0;if((ii|0)==49)return T(Kt),T(si),ai=13,ai|0;if((ii|0)==77)kn(23313,22674,462,22684);else{if((ii|0)==84)return T(tt),T(Kt),T(si),ai=y,ai|0;if((ii|0)==85){O(r|0,Kt|0,l<<3|0)|0;break}}}if((ii|0)==22)return T(Kt),T(si),ai=5,ai|0;if((ii|0)==28)return T(Kt),T(si),ai=y,ai|0}while(!1);return T(Kt),T(si),ai=0,ai|0}function cl(i,r,l,d,y,I,k){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0,I=I|0,k=k|0;var z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0;if(tt=Bt,Bt=Bt+16|0,ze=tt,!((l|0)>0|(l|0)==0&r>>>0>0))return ze=0,Bt=tt,ze|0;if((k|0)>=16)return ze=12,Bt=tt,ze|0;ke=0,Fe=0,Ie=0,z=0;e:for(;;){if(Y=i+(ke<<3)|0,Z=o[Y>>2]|0,Y=o[Y+4>>2]|0,Ae=Ht(Z|0,Y|0,52)|0,qt()|0,(Ae&15|0)>(k|0)){z=12,Z=11;break}if(hl(ze,Z,Y,k),Ae=ze,Y=o[Ae>>2]|0,Ae=o[Ae+4>>2]|0,(Y|0)==0&(Ae|0)==0)Z=Ie;else{Z=Ie;do{if(!((z|0)<(I|0)|(z|0)==(I|0)&Z>>>0<y>>>0)){Z=10;break e}Ie=d+(Z<<3)|0,o[Ie>>2]=Y,o[Ie+4>>2]=Ae,Z=R(Z|0,z|0,1,0)|0,z=qt()|0,cu(ze),Ie=ze,Y=o[Ie>>2]|0,Ae=o[Ie+4>>2]|0}while(!((Y|0)==0&(Ae|0)==0))}if(ke=R(ke|0,Fe|0,1,0)|0,Fe=qt()|0,(Fe|0)<(l|0)|(Fe|0)==(l|0)&ke>>>0<r>>>0)Ie=Z;else{z=0,Z=11;break}}return(Z|0)==10?(ze=14,Bt=tt,ze|0):(Z|0)==11?(Bt=tt,z|0):0}function Jr(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0;ke=Bt,Bt=Bt+16|0,Ie=ke;e:do if((l|0)>0|(l|0)==0&r>>>0>0){for(Y=0,k=0,I=0,Ae=0;;){if(Z=i+(Y<<3)|0,z=o[Z>>2]|0,Z=o[Z+4>>2]|0,!((z|0)==0&(Z|0)==0)&&(Z=(Ls(z,Z,d,Ie)|0)==0,z=Ie,k=R(o[z>>2]|0,o[z+4>>2]|0,k|0,I|0)|0,I=qt()|0,!Z)){I=12;break}if(Y=R(Y|0,Ae|0,1,0)|0,Ae=qt()|0,!((Ae|0)<(l|0)|(Ae|0)==(l|0)&Y>>>0<r>>>0))break e}return Bt=ke,I|0}else k=0,I=0;while(!1);return o[y>>2]=k,o[y+4>>2]=I,y=0,Bt=ke,y|0}function gs(i,r){return i=i|0,r=r|0,r=Ht(i|0,r|0,52)|0,qt()|0,r&1|0}function ka(i,r){i=i|0,r=r|0;var l=0,d=0,y=0;if(y=Ht(i|0,r|0,52)|0,qt()|0,y=y&15,!y)return y=0,y|0;for(d=1;;){if(l=Ht(i|0,r|0,(15-d|0)*3|0)|0,qt()|0,l=l&7,l|0){d=5;break}if(d>>>0<y>>>0)d=d+1|0;else{l=0,d=5;break}}return(d|0)==5?l|0:0}function Pl(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0,Z=0;if(Z=Ht(i|0,r|0,52)|0,qt()|0,Z=Z&15,!Z)return z=r,Z=i,en(z|0),Z|0;for(z=1,l=0;;){I=(15-z|0)*3|0,d=Qt(7,0,I|0)|0,y=qt()|0,k=Ht(i|0,r|0,I|0)|0,qt()|0,I=Qt(Fa(k&7)|0,0,I|0)|0,k=qt()|0,i=I|i&~d,r=k|r&~y;e:do if(!l)if((I&d|0)==0&(k&y|0)==0)l=0;else if(d=Ht(i|0,r|0,52)|0,qt()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(k=Ht(i|0,r|0,(15-l|0)*3|0)|0,qt()|0,k&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(k=(15-l|0)*3|0,y=Ht(i|0,r|0,k|0)|0,qt()|0,I=Qt(7,0,k|0)|0,r=r&~(qt()|0),k=Qt(Fa(y&7)|0,0,k|0)|0,i=i&~I|k,r=r|(qt()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(z>>>0<Z>>>0)z=z+1|0;else break}return en(r|0),i|0}function Lo(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0;if(d=Ht(i|0,r|0,52)|0,qt()|0,d=d&15,!d)return l=r,d=i,en(l|0),d|0;for(l=1;I=(15-l|0)*3|0,k=Ht(i|0,r|0,I|0)|0,qt()|0,y=Qt(7,0,I|0)|0,r=r&~(qt()|0),I=Qt(Fa(k&7)|0,0,I|0)|0,i=I|i&~y,r=qt()|0|r,l>>>0<d>>>0;)l=l+1|0;return en(r|0),i|0}function Dl(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0,Z=0;if(Z=Ht(i|0,r|0,52)|0,qt()|0,Z=Z&15,!Z)return z=r,Z=i,en(z|0),Z|0;for(z=1,l=0;;){I=(15-z|0)*3|0,d=Qt(7,0,I|0)|0,y=qt()|0,k=Ht(i|0,r|0,I|0)|0,qt()|0,I=Qt(gl(k&7)|0,0,I|0)|0,k=qt()|0,i=I|i&~d,r=k|r&~y;e:do if(!l)if((I&d|0)==0&(k&y|0)==0)l=0;else if(d=Ht(i|0,r|0,52)|0,qt()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(k=Ht(i|0,r|0,(15-l|0)*3|0)|0,qt()|0,k&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(y=(15-l|0)*3|0,I=Qt(7,0,y|0)|0,k=r&~(qt()|0),r=Ht(i|0,r|0,y|0)|0,qt()|0,r=Qt(gl(r&7)|0,0,y|0)|0,i=i&~I|r,r=k|(qt()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(z>>>0<Z>>>0)z=z+1|0;else break}return en(r|0),i|0}function vo(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0;if(d=Ht(i|0,r|0,52)|0,qt()|0,d=d&15,!d)return l=r,d=i,en(l|0),d|0;for(l=1;k=(15-l|0)*3|0,I=Qt(7,0,k|0)|0,y=r&~(qt()|0),r=Ht(i|0,r|0,k|0)|0,qt()|0,r=Qt(gl(r&7)|0,0,k|0)|0,i=r|i&~I,r=qt()|0|y,l>>>0<d>>>0;)l=l+1|0;return en(r|0),i|0}function sa(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;if(Z=Bt,Bt=Bt+64|0,z=Z+40|0,d=Z+24|0,y=Z+12|0,I=Z,Qt(r|0,0,52)|0,l=qt()|0|134225919,!r)return(o[i+4>>2]|0)>2||(o[i+8>>2]|0)>2||(o[i+12>>2]|0)>2?(k=0,z=0,en(k|0),Bt=Z,z|0):(Qt(Yt(i)|0,0,45)|0,k=qt()|0|l,z=-1,en(k|0),Bt=Z,z|0);if(o[z>>2]=o[i>>2],o[z+4>>2]=o[i+4>>2],o[z+8>>2]=o[i+8>>2],o[z+12>>2]=o[i+12>>2],k=z+4|0,(r|0)>0)for(i=-1;o[d>>2]=o[k>>2],o[d+4>>2]=o[k+4>>2],o[d+8>>2]=o[k+8>>2],r&1?(Tl(k),o[y>>2]=o[k>>2],o[y+4>>2]=o[k+4>>2],o[y+8>>2]=o[k+8>>2],Wo(y)):(yo(k),o[y>>2]=o[k>>2],o[y+4>>2]=o[k+4>>2],o[y+8>>2]=o[k+8>>2],ma(y)),ra(d,y,I),Or(I),Ae=(15-r|0)*3|0,Y=Qt(7,0,Ae|0)|0,l=l&~(qt()|0),Ae=Qt(ko(I)|0,0,Ae|0)|0,i=Ae|i&~Y,l=qt()|0|l,(r|0)>1;)r=r+-1|0;else i=-1;e:do if((o[k>>2]|0)<=2&&(o[z+8>>2]|0)<=2&&(o[z+12>>2]|0)<=2){if(d=Yt(z)|0,r=Qt(d|0,0,45)|0,r=r|i,i=qt()|0|l&-1040385,I=Ii(z)|0,!(at(d)|0)){if((I|0)<=0)break;for(y=0;;){if(d=Ht(r|0,i|0,52)|0,qt()|0,d=d&15,d)for(l=1;Ae=(15-l|0)*3|0,z=Ht(r|0,i|0,Ae|0)|0,qt()|0,Y=Qt(7,0,Ae|0)|0,i=i&~(qt()|0),Ae=Qt(Fa(z&7)|0,0,Ae|0)|0,r=r&~Y|Ae,i=i|(qt()|0),l>>>0<d>>>0;)l=l+1|0;if(y=y+1|0,(y|0)==(I|0))break e}}y=Ht(r|0,i|0,52)|0,qt()|0,y=y&15;t:do if(y){l=1;i:for(;;){switch(Ae=Ht(r|0,i|0,(15-l|0)*3|0)|0,qt()|0,Ae&7){case 1:break i;case 0:break;default:break t}if(l>>>0<y>>>0)l=l+1|0;else break t}if(pn(d,o[z>>2]|0)|0)for(l=1;z=(15-l|0)*3|0,Y=Qt(7,0,z|0)|0,Ae=i&~(qt()|0),i=Ht(r|0,i|0,z|0)|0,qt()|0,i=Qt(gl(i&7)|0,0,z|0)|0,r=r&~Y|i,i=Ae|(qt()|0),l>>>0<y>>>0;)l=l+1|0;else for(l=1;Ae=(15-l|0)*3|0,z=Ht(r|0,i|0,Ae|0)|0,qt()|0,Y=Qt(7,0,Ae|0)|0,i=i&~(qt()|0),Ae=Qt(Fa(z&7)|0,0,Ae|0)|0,r=r&~Y|Ae,i=i|(qt()|0),l>>>0<y>>>0;)l=l+1|0}while(!1);if((I|0)>0){l=0;do r=Pl(r,i)|0,i=qt()|0,l=l+1|0;while((l|0)!=(I|0))}}else r=0,i=0;while(!1);return Y=i,Ae=r,en(Y|0),Bt=Z,Ae|0}function Ws(i){return i=i|0,(i|0)%2|0|0}function io(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0;return y=Bt,Bt=Bt+16|0,d=y,r>>>0>15?(d=4,Bt=y,d|0):(o[i+4>>2]&2146435072|0)==2146435072||(o[i+8+4>>2]&2146435072|0)==2146435072?(d=3,Bt=y,d|0):(eo(i,r,d),r=sa(d,r)|0,d=qt()|0,o[l>>2]=r,o[l+4>>2]=d,(r|0)==0&(d|0)==0&&kn(23313,22674,786,22697),d=0,Bt=y,d|0)}function el(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0;if(y=l+4|0,I=Ht(i|0,r|0,52)|0,qt()|0,I=I&15,k=Ht(i|0,r|0,45)|0,qt()|0,d=(I|0)==0,at(k&127)|0){if(d)return k=1,k|0;d=1}else{if(d)return k=0,k|0;!(o[y>>2]|0)&&!(o[l+8>>2]|0)?d=(o[l+12>>2]|0)!=0&1:d=1}for(l=1;l&1?Wo(y):ma(y),k=Ht(i|0,r|0,(15-l|0)*3|0)|0,qt()|0,na(y,k&7),l>>>0<I>>>0;)l=l+1|0;return d|0}function ns(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;if(Ae=Bt,Bt=Bt+16|0,Z=Ae,Y=Ht(i|0,r|0,45)|0,qt()|0,Y=Y&127,Y>>>0>121)return o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,o[l+12>>2]=0,Y=5,Bt=Ae,Y|0;e:do if(at(Y)|0&&(I=Ht(i|0,r|0,52)|0,qt()|0,I=I&15,(I|0)!=0)){d=1;t:for(;;){switch(z=Ht(i|0,r|0,(15-d|0)*3|0)|0,qt()|0,z&7){case 5:break t;case 0:break;default:{d=r;break e}}if(d>>>0<I>>>0)d=d+1|0;else{d=r;break e}}for(y=1,d=r;r=(15-y|0)*3|0,k=Qt(7,0,r|0)|0,z=d&~(qt()|0),d=Ht(i|0,d|0,r|0)|0,qt()|0,d=Qt(gl(d&7)|0,0,r|0)|0,i=i&~k|d,d=z|(qt()|0),y>>>0<I>>>0;)y=y+1|0}else d=r;while(!1);if(z=7696+(Y*28|0)|0,o[l>>2]=o[z>>2],o[l+4>>2]=o[z+4>>2],o[l+8>>2]=o[z+8>>2],o[l+12>>2]=o[z+12>>2],!(el(i,d,l)|0))return Y=0,Bt=Ae,Y|0;if(k=l+4|0,o[Z>>2]=o[k>>2],o[Z+4>>2]=o[k+4>>2],o[Z+8>>2]=o[k+8>>2],I=Ht(i|0,d|0,52)|0,qt()|0,z=I&15,I&1?(ma(k),I=z+1|0):I=z,!(at(Y)|0))d=0;else{e:do if(!z)d=0;else for(r=1;;){if(y=Ht(i|0,d|0,(15-r|0)*3|0)|0,qt()|0,y=y&7,y|0){d=y;break e}if(r>>>0<z>>>0)r=r+1|0;else{d=0;break}}while(!1);d=(d|0)==4&1}if(!(to(l,I,d,0)|0))(I|0)!=(z|0)&&(o[k>>2]=o[Z>>2],o[k+4>>2]=o[Z+4>>2],o[k+8>>2]=o[Z+8>>2]);else{if(at(Y)|0)do;while(to(l,I,0,0)|0);(I|0)!=(z|0)&&yo(k)}return Y=0,Bt=Ae,Y|0}function vr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;return I=Bt,Bt=Bt+16|0,d=I,y=ns(i,r,d)|0,y|0?(Bt=I,y|0):(y=Ht(i|0,r|0,52)|0,qt()|0,Kn(d,y&15,l),y=0,Bt=I,y|0)}function Hr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0;if(k=Bt,Bt=Bt+16|0,I=k,d=ns(i,r,I)|0,d|0)return I=d,Bt=k,I|0;d=Ht(i|0,r|0,45)|0,qt()|0,d=(at(d&127)|0)==0,y=Ht(i|0,r|0,52)|0,qt()|0,y=y&15;e:do if(!d){if(y|0)for(d=1;;){if(z=Qt(7,0,(15-d|0)*3|0)|0,!((z&i|0)==0&((qt()|0)&r|0)==0))break e;if(d>>>0<y>>>0)d=d+1|0;else break}return Jo(I,y,0,5,l),z=0,Bt=k,z|0}while(!1);return pr(I,y,0,6,l),z=0,Bt=k,z|0}function ga(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;if(y=Ht(i|0,r|0,45)|0,qt()|0,!(at(y&127)|0))return y=2,o[l>>2]=y,0;if(y=Ht(i|0,r|0,52)|0,qt()|0,y=y&15,!y)return y=5,o[l>>2]=y,0;for(d=1;;){if(I=Qt(7,0,(15-d|0)*3|0)|0,!((I&i|0)==0&((qt()|0)&r|0)==0)){d=2,i=6;break}if(d>>>0<y>>>0)d=d+1|0;else{d=5,i=6;break}}return(i|0)==6&&(o[l>>2]=d),0}function xo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0;Ie=Bt,Bt=Bt+128|0,Y=Ie+112|0,I=Ie+96|0,Ae=Ie,y=Ht(i|0,r|0,52)|0,qt()|0,z=y&15,o[Y>>2]=z,k=Ht(i|0,r|0,45)|0,qt()|0,k=k&127;e:do if(at(k)|0){if(z|0)for(d=1;;){if(Z=Qt(7,0,(15-d|0)*3|0)|0,!((Z&i|0)==0&((qt()|0)&r|0)==0)){y=0;break e}if(d>>>0<z>>>0)d=d+1|0;else break}if(y&1)y=1;else return Z=Qt(z+1|0,0,52)|0,Ae=qt()|0|r&-15728641,Y=Qt(7,0,(14-z|0)*3|0)|0,Ae=xo((Z|i)&~Y,Ae&~(qt()|0),l)|0,Bt=Ie,Ae|0}else y=0;while(!1);if(d=ns(i,r,I)|0,!d){y?(Vr(I,Y,Ae),Z=5):(Po(I,Y,Ae),Z=6);e:do if(at(k)|0)if(!z)i=5;else for(d=1;;){if(k=Qt(7,0,(15-d|0)*3|0)|0,!((k&i|0)==0&((qt()|0)&r|0)==0)){i=2;break e}if(d>>>0<z>>>0)d=d+1|0;else{i=5;break}}else i=2;while(!1);V(l|0,-1,i<<2|0)|0;e:do if(y)for(I=0;;){if(k=Ae+(I<<4)|0,ss(k,o[Y>>2]|0)|0,k=o[k>>2]|0,z=o[l>>2]|0,(z|0)==-1|(z|0)==(k|0))d=l;else{y=0;do{if(y=y+1|0,y>>>0>=i>>>0){d=1;break e}d=l+(y<<2)|0,z=o[d>>2]|0}while(!((z|0)==-1|(z|0)==(k|0)))}if(o[d>>2]=k,I=I+1|0,I>>>0>=Z>>>0){d=0;break}}else for(I=0;;){if(k=Ae+(I<<4)|0,to(k,o[Y>>2]|0,0,1)|0,k=o[k>>2]|0,z=o[l>>2]|0,(z|0)==-1|(z|0)==(k|0))d=l;else{y=0;do{if(y=y+1|0,y>>>0>=i>>>0){d=1;break e}d=l+(y<<2)|0,z=o[d>>2]|0}while(!((z|0)==-1|(z|0)==(k|0)))}if(o[d>>2]=k,I=I+1|0,I>>>0>=Z>>>0){d=0;break}}while(!1)}return Ae=d,Bt=Ie,Ae|0}function aa(){return 12}function Ma(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0,Z=0;if(i>>>0>15)return z=4,z|0;if(Qt(i|0,0,52)|0,z=qt()|0|134225919,!i){l=0,d=0;do at(d)|0&&(Qt(d|0,0,45)|0,k=z|(qt()|0),i=r+(l<<3)|0,o[i>>2]=-1,o[i+4>>2]=k,l=l+1|0),d=d+1|0;while((d|0)!=122);return l=0,l|0}l=0,k=0;do{if(at(k)|0){for(Qt(k|0,0,45)|0,d=1,y=-1,I=z|(qt()|0);Z=Qt(7,0,(15-d|0)*3|0)|0,y=y&~Z,I=I&~(qt()|0),(d|0)!=(i|0);)d=d+1|0;Z=r+(l<<3)|0,o[Z>>2]=y,o[Z+4>>2]=I,l=l+1|0}k=k+1|0}while((k|0)!=122);return l=0,l|0}function Oa(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0;if(ft=Bt,Bt=Bt+16|0,wt=ft,lt=Ht(i|0,r|0,52)|0,qt()|0,lt=lt&15,l>>>0>15)return lt=4,Bt=ft,lt|0;if((lt|0)<(l|0))return lt=12,Bt=ft,lt|0;if((lt|0)!=(l|0))if(I=Qt(l|0,0,52)|0,I=I|i,z=qt()|0|r&-15728641,(lt|0)>(l|0)){Z=l;do tt=Qt(7,0,(14-Z|0)*3|0)|0,Z=Z+1|0,I=tt|I,z=qt()|0|z;while((Z|0)<(lt|0));tt=I}else tt=I;else tt=i,z=r;ze=Ht(tt|0,z|0,45)|0,qt()|0;e:do if(at(ze&127)|0){if(Z=Ht(tt|0,z|0,52)|0,qt()|0,Z=Z&15,Z|0)for(I=1;;){if(ze=Qt(7,0,(15-I|0)*3|0)|0,!((ze&tt|0)==0&((qt()|0)&z|0)==0)){Y=33;break e}if(I>>>0<Z>>>0)I=I+1|0;else break}if(ze=d,o[ze>>2]=0,o[ze+4>>2]=0,(lt|0)>(l|0)){for(ze=r&-15728641,Fe=lt;;){if(ke=Fe,Fe=Fe+-1|0,Fe>>>0>15|(lt|0)<(Fe|0)){Y=19;break}if((lt|0)!=(Fe|0))if(I=Qt(Fe|0,0,52)|0,I=I|i,Z=qt()|0|ze,(lt|0)<(ke|0))Ie=I;else{Y=Fe;do Ie=Qt(7,0,(14-Y|0)*3|0)|0,Y=Y+1|0,I=Ie|I,Z=qt()|0|Z;while((Y|0)<(lt|0));Ie=I}else Ie=i,Z=r;if(Ae=Ht(Ie|0,Z|0,45)|0,qt()|0,!(at(Ae&127)|0))I=0;else{Ae=Ht(Ie|0,Z|0,52)|0,qt()|0,Ae=Ae&15;t:do if(!Ae)I=0;else for(Y=1;;){if(I=Ht(Ie|0,Z|0,(15-Y|0)*3|0)|0,qt()|0,I=I&7,I|0)break t;if(Y>>>0<Ae>>>0)Y=Y+1|0;else{I=0;break}}while(!1);I=(I|0)==0&1}if(Z=Ht(i|0,r|0,(15-ke|0)*3|0)|0,qt()|0,Z=Z&7,(Z|0)==7){y=5,Y=42;break}if(I=(I|0)!=0,(Z|0)==1&I){y=5,Y=42;break}if(Ie=Z+(((Z|0)!=0&I)<<31>>31)|0,Ie|0&&(Y=lt-ke|0,Y=yl(7,0,Y,((Y|0)<0)<<31>>31)|0,Ae=qt()|0,I?(I=Xe(Y|0,Ae|0,5,0)|0,I=R(I|0,qt()|0,-5,-1)|0,I=le(I|0,qt()|0,6,0)|0,I=R(I|0,qt()|0,1,0)|0,Z=qt()|0):(I=Y,Z=Ae),ke=Ie+-1|0,ke=Xe(Y|0,Ae|0,ke|0,((ke|0)<0)<<31>>31|0)|0,ke=R(I|0,Z|0,ke|0,qt()|0)|0,Ie=qt()|0,Ae=d,Ae=R(ke|0,Ie|0,o[Ae>>2]|0,o[Ae+4>>2]|0)|0,Ie=qt()|0,ke=d,o[ke>>2]=Ae,o[ke+4>>2]=Ie),(Fe|0)<=(l|0)){Y=37;break}}if((Y|0)==19)kn(23313,22674,1099,22710);else if((Y|0)==37){k=d,y=o[k+4>>2]|0,k=o[k>>2]|0;break}else if((Y|0)==42)return Bt=ft,y|0}else y=0,k=0}else Y=33;while(!1);e:do if((Y|0)==33)if(ze=d,o[ze>>2]=0,o[ze+4>>2]=0,(lt|0)>(l|0)){for(I=lt;;){if(y=Ht(i|0,r|0,(15-I|0)*3|0)|0,qt()|0,y=y&7,(y|0)==7){y=5;break}if(k=lt-I|0,k=yl(7,0,k,((k|0)<0)<<31>>31)|0,y=Xe(k|0,qt()|0,y|0,0)|0,k=qt()|0,ze=d,k=R(o[ze>>2]|0,o[ze+4>>2]|0,y|0,k|0)|0,y=qt()|0,ze=d,o[ze>>2]=k,o[ze+4>>2]=y,I=I+-1|0,(I|0)<=(l|0))break e}return Bt=ft,y|0}else y=0,k=0;while(!1);return Ls(tt,z,lt,wt)|0&&kn(23313,22674,1063,22725),lt=wt,wt=o[lt+4>>2]|0,((y|0)>-1|(y|0)==-1&k>>>0>4294967295)&((wt|0)>(y|0)|((wt|0)==(y|0)?(o[lt>>2]|0)>>>0>k>>>0:0))?(lt=0,Bt=ft,lt|0):(kn(23313,22674,1139,22710),0)}function no(i,r,l,d,y,I){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0,I=I|0;var k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0;if(Ie=Bt,Bt=Bt+16|0,k=Ie,y>>>0>15)return I=4,Bt=Ie,I|0;if(z=Ht(l|0,d|0,52)|0,qt()|0,z=z&15,(z|0)>(y|0))return I=12,Bt=Ie,I|0;if(Ls(l,d,y,k)|0&&kn(23313,22674,1063,22725),Ae=k,Y=o[Ae+4>>2]|0,!(((r|0)>-1|(r|0)==-1&i>>>0>4294967295)&((Y|0)>(r|0)|((Y|0)==(r|0)?(o[Ae>>2]|0)>>>0>i>>>0:0))))return I=2,Bt=Ie,I|0;Ae=y-z|0,y=Qt(y|0,0,52)|0,Z=qt()|0|d&-15728641,Y=I,o[Y>>2]=y|l,o[Y+4>>2]=Z,Y=Ht(l|0,d|0,45)|0,qt()|0;e:do if(at(Y&127)|0){if(z|0)for(k=1;;){if(Y=Qt(7,0,(15-k|0)*3|0)|0,!((Y&l|0)==0&((qt()|0)&d|0)==0))break e;if(k>>>0<z>>>0)k=k+1|0;else break}if((Ae|0)<1)return I=0,Bt=Ie,I|0;for(Y=z^15,d=-1,Z=1,k=1;;){z=Ae-Z|0,z=yl(7,0,z,((z|0)<0)<<31>>31)|0,l=qt()|0;do if(k)if(k=Xe(z|0,l|0,5,0)|0,k=R(k|0,qt()|0,-5,-1)|0,k=le(k|0,qt()|0,6,0)|0,y=qt()|0,(r|0)>(y|0)|(r|0)==(y|0)&i>>>0>k>>>0){r=R(i|0,r|0,-1,-1)|0,r=F(r|0,qt()|0,k|0,y|0)|0,k=qt()|0,ke=I,ze=o[ke>>2]|0,ke=o[ke+4>>2]|0,tt=(Y+d|0)*3|0,Fe=Qt(7,0,tt|0)|0,ke=ke&~(qt()|0),d=le(r|0,k|0,z|0,l|0)|0,i=qt()|0,y=R(d|0,i|0,2,0)|0,tt=Qt(y|0,qt()|0,tt|0)|0,ke=qt()|0|ke,y=I,o[y>>2]=tt|ze&~Fe,o[y+4>>2]=ke,i=Xe(d|0,i|0,z|0,l|0)|0,i=F(r|0,k|0,i|0,qt()|0)|0,k=0,r=qt()|0;break}else{tt=I,Fe=o[tt>>2]|0,tt=o[tt+4>>2]|0,ze=Qt(7,0,(Y+d|0)*3|0)|0,tt=tt&~(qt()|0),k=I,o[k>>2]=Fe&~ze,o[k+4>>2]=tt,k=1;break}else Fe=I,y=o[Fe>>2]|0,Fe=o[Fe+4>>2]|0,d=(Y+d|0)*3|0,ke=Qt(7,0,d|0)|0,Fe=Fe&~(qt()|0),tt=le(i|0,r|0,z|0,l|0)|0,k=qt()|0,d=Qt(tt|0,k|0,d|0)|0,Fe=qt()|0|Fe,ze=I,o[ze>>2]=d|y&~ke,o[ze+4>>2]=Fe,k=Xe(tt|0,k|0,z|0,l|0)|0,i=F(i|0,r|0,k|0,qt()|0)|0,k=0,r=qt()|0;while(!1);if((Ae|0)>(Z|0))d=~Z,Z=Z+1|0;else{r=0;break}}return Bt=Ie,r|0}while(!1);if((Ae|0)<1)return tt=0,Bt=Ie,tt|0;for(y=z^15,k=1;;)if(ze=Ae-k|0,ze=yl(7,0,ze,((ze|0)<0)<<31>>31)|0,tt=qt()|0,Z=I,l=o[Z>>2]|0,Z=o[Z+4>>2]|0,z=(y-k|0)*3|0,d=Qt(7,0,z|0)|0,Z=Z&~(qt()|0),ke=le(i|0,r|0,ze|0,tt|0)|0,Fe=qt()|0,z=Qt(ke|0,Fe|0,z|0)|0,Z=qt()|0|Z,Y=I,o[Y>>2]=z|l&~d,o[Y+4>>2]=Z,tt=Xe(ke|0,Fe|0,ze|0,tt|0)|0,i=F(i|0,r|0,tt|0,qt()|0)|0,r=qt()|0,(Ae|0)<=(k|0)){r=0;break}else k=k+1|0;return Bt=Ie,r|0}function hl(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0;y=Ht(r|0,l|0,52)|0,qt()|0,y=y&15,(r|0)==0&(l|0)==0|((d|0)>15|(y|0)>(d|0))?(d=-1,y=-1,r=0,l=0):(I=ul(r,l,y+1|0,d)|0,l=(qt()|0)&-15728641,r=Qt(d|0,0,52)|0,r=I|r,l=l|(qt()|0),I=(Br(r,l)|0)==0,d=I?-1:d),I=i,o[I>>2]=r,o[I+4>>2]=l,o[i+8>>2]=y,o[i+12>>2]=d}function cu(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0;if(l=i,r=o[l>>2]|0,l=o[l+4>>2]|0,!((r|0)==0&(l|0)==0)&&(d=Ht(r|0,l|0,52)|0,qt()|0,d=d&15,z=Qt(1,0,(d^15)*3|0)|0,r=R(z|0,qt()|0,r|0,l|0)|0,l=qt()|0,z=i,o[z>>2]=r,o[z+4>>2]=l,z=i+8|0,k=o[z>>2]|0,!((d|0)<(k|0)))){for(Z=i+12|0,I=d;;){if((I|0)==(k|0)){d=5;break}if(Y=(I|0)==(o[Z>>2]|0),y=(15-I|0)*3|0,d=Ht(r|0,l|0,y|0)|0,qt()|0,d=d&7,Y&((d|0)==1&!0)){d=7;break}if(!((d|0)==7&!0)){d=10;break}if(Y=Qt(1,0,y|0)|0,r=R(r|0,l|0,Y|0,qt()|0)|0,l=qt()|0,Y=i,o[Y>>2]=r,o[Y+4>>2]=l,(I|0)>(k|0))I=I+-1|0;else{d=10;break}}if((d|0)==5){Y=i,o[Y>>2]=0,o[Y+4>>2]=0,o[z>>2]=-1,o[Z>>2]=-1;return}else if((d|0)==7){k=Qt(1,0,y|0)|0,k=R(r|0,l|0,k|0,qt()|0)|0,z=qt()|0,Y=i,o[Y>>2]=k,o[Y+4>>2]=z,o[Z>>2]=I+-1;return}else if((d|0)==10)return}}function _l(i){i=+i;var r=0;return r=i<0?i+6.283185307179586:i,+(i>=6.283185307179586?r+-6.283185307179586:r)}function ho(i,r){return i=i|0,r=r|0,+ti(+(+Me[i>>3]-+Me[r>>3]))<17453292519943298e-27?(r=+ti(+(+Me[i+8>>3]-+Me[r+8>>3]))<17453292519943298e-27,r|0):(r=0,r|0)}function mi(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0;return y=+Me[r>>3],d=+Me[i>>3],I=+Si(+((y-d)*.5)),l=+Si(+((+Me[r+8>>3]-+Me[i+8>>3])*.5)),l=I*I+l*(+bi(+y)*+bi(+d)*l),+(+Hn(+ +ui(+l),+ +ui(+(1-l)))*2)}function qi(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0;return y=+Me[r>>3],d=+Me[i>>3],I=+Si(+((y-d)*.5)),l=+Si(+((+Me[r+8>>3]-+Me[i+8>>3])*.5)),l=I*I+l*(+bi(+y)*+bi(+d)*l),+(+Hn(+ +ui(+l),+ +ui(+(1-l)))*2*6371.007180918475)}function Di(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0;return y=+Me[r>>3],d=+Me[i>>3],I=+Si(+((y-d)*.5)),l=+Si(+((+Me[r+8>>3]-+Me[i+8>>3])*.5)),l=I*I+l*(+bi(+y)*+bi(+d)*l),+(+Hn(+ +ui(+l),+ +ui(+(1-l)))*2*6371.007180918475*1e3)}function Nt(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0;return I=+Me[r>>3],d=+bi(+I),y=+Me[r+8>>3]-+Me[i+8>>3],k=d*+Si(+y),l=+Me[i>>3],+ +Hn(+k,+(+Si(+I)*+bi(+l)-+bi(+y)*(d*+Si(+l))))}function ni(i,r,l,d){i=i|0,r=+r,l=+l,d=d|0;var y=0,I=0,k=0,z=0;if(l<1e-16){o[d>>2]=o[i>>2],o[d+4>>2]=o[i+4>>2],o[d+8>>2]=o[i+8>>2],o[d+12>>2]=o[i+12>>2];return}I=r<0?r+6.283185307179586:r,I=r>=6.283185307179586?I+-6.283185307179586:I;do if(I<1e-16)r=+Me[i>>3]+l,Me[d>>3]=r,y=d;else{if(y=+ti(+(I+-3.141592653589793))<1e-16,r=+Me[i>>3],y){r=r-l,Me[d>>3]=r,y=d;break}if(k=+bi(+l),l=+Si(+l),r=k*+Si(+r)+ +bi(+I)*(l*+bi(+r)),r=r>1?1:r,r=+ur(+(r<-1?-1:r)),Me[d>>3]=r,+ti(+(r+-1.5707963267948966))<1e-16){Me[d>>3]=1.5707963267948966,Me[d+8>>3]=0;return}if(+ti(+(r+1.5707963267948966))<1e-16){Me[d>>3]=-1.5707963267948966,Me[d+8>>3]=0;return}if(z=+bi(+r),I=l*+Si(+I)/z,l=+Me[i>>3],r=(k-+Si(+r)*+Si(+l))/+bi(+l)/z,k=I>1?1:I,r=r>1?1:r,r=+Me[i+8>>3]+ +Hn(+(k<-1?-1:k),+(r<-1?-1:r)),r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);Me[d+8>>3]=r;return}while(!1);if(+ti(+(r+-1.5707963267948966))<1e-16){Me[y>>3]=1.5707963267948966,Me[d+8>>3]=0;return}if(+ti(+(r+1.5707963267948966))<1e-16){Me[y>>3]=-1.5707963267948966,Me[d+8>>3]=0;return}if(r=+Me[i+8>>3],r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);Me[d+8>>3]=r}function wi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(Me[r>>3]=+Me[20528+(i<<3)>>3],r=0,r|0)}function Ui(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(Me[r>>3]=+Me[20656+(i<<3)>>3],r=0,r|0)}function On(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(Me[r>>3]=+Me[20784+(i<<3)>>3],r=0,r|0)}function jn(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(Me[r>>3]=+Me[20912+(i<<3)>>3],r=0,r|0)}function cr(i,r){i=i|0,r=r|0;var l=0;return i>>>0>15?(r=4,r|0):(l=yl(7,0,i,((i|0)<0)<<31>>31)|0,l=Xe(l|0,qt()|0,120,0)|0,i=qt()|0,o[r>>2]=l|2,o[r+4>>2]=i,r=0,r|0)}function Jn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0;return ke=+Me[r>>3],Ae=+Me[i>>3],Z=+Si(+((ke-Ae)*.5)),I=+Me[r+8>>3],Y=+Me[i+8>>3],k=+Si(+((I-Y)*.5)),z=+bi(+Ae),Ie=+bi(+ke),k=Z*Z+k*(Ie*z*k),k=+Hn(+ +ui(+k),+ +ui(+(1-k)))*2,Z=+Me[l>>3],ke=+Si(+((Z-ke)*.5)),d=+Me[l+8>>3],I=+Si(+((d-I)*.5)),y=+bi(+Z),I=ke*ke+I*(Ie*y*I),I=+Hn(+ +ui(+I),+ +ui(+(1-I)))*2,Z=+Si(+((Ae-Z)*.5)),d=+Si(+((Y-d)*.5)),d=Z*Z+d*(z*y*d),d=+Hn(+ +ui(+d),+ +ui(+(1-d)))*2,y=(k+I+d)*.5,+(+mn(+ +ui(+(+Jt(+(y*.5))*+Jt(+((y-k)*.5))*+Jt(+((y-I)*.5))*+Jt(+((y-d)*.5)))))*4)}function $s(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0;if(z=Bt,Bt=Bt+192|0,I=z+168|0,k=z,y=vr(i,r,I)|0,y|0)return l=y,Bt=z,l|0;if(Hr(i,r,k)|0&&kn(23313,22742,386,22751),r=o[k>>2]|0,(r|0)>0){if(d=+Jn(k+8|0,k+8+(((r|0)!=1&1)<<4)|0,I)+0,(r|0)!=1){i=1;do y=i,i=i+1|0,d=d+ +Jn(k+8+(y<<4)|0,k+8+(((i|0)%(r|0)|0)<<4)|0,I);while((i|0)<(r|0))}}else d=0;return Me[l>>3]=d,l=0,Bt=z,l|0}function Bs(i,r,l){return i=i|0,r=r|0,l=l|0,i=$s(i,r,l)|0,i|0||(Me[l>>3]=+Me[l>>3]*6371.007180918475*6371.007180918475),i|0}function _s(i,r,l){return i=i|0,r=r|0,l=l|0,i=$s(i,r,l)|0,i|0||(Me[l>>3]=+Me[l>>3]*6371.007180918475*6371.007180918475*1e3*1e3),i|0}function ro(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;if(z=Bt,Bt=Bt+176|0,k=z,i=Ta(i,r,k)|0,i|0)return k=i,Bt=z,k|0;if(Me[l>>3]=0,i=o[k>>2]|0,(i|0)<=1)return k=0,Bt=z,k|0;r=i+-1|0,i=0,d=+Me[k+8>>3],y=+Me[k+16>>3],I=0;do i=i+1|0,Y=d,d=+Me[k+8+(i<<4)>>3],Ae=+Si(+((d-Y)*.5)),Z=y,y=+Me[k+8+(i<<4)+8>>3],Z=+Si(+((y-Z)*.5)),Z=Ae*Ae+Z*(+bi(+d)*+bi(+Y)*Z),I=I+ +Hn(+ +ui(+Z),+ +ui(+(1-Z)))*2;while((i|0)<(r|0));return Me[l>>3]=I,k=0,Bt=z,k|0}function bo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;if(z=Bt,Bt=Bt+176|0,k=z,i=Ta(i,r,k)|0,i|0)return k=i,I=+Me[l>>3],I=I*6371.007180918475,Me[l>>3]=I,Bt=z,k|0;if(Me[l>>3]=0,i=o[k>>2]|0,(i|0)<=1)return k=0,I=0,I=I*6371.007180918475,Me[l>>3]=I,Bt=z,k|0;r=i+-1|0,i=0,d=+Me[k+8>>3],y=+Me[k+16>>3],I=0;do i=i+1|0,Y=d,d=+Me[k+8+(i<<4)>>3],Ae=+Si(+((d-Y)*.5)),Z=y,y=+Me[k+8+(i<<4)+8>>3],Z=+Si(+((y-Z)*.5)),Z=Ae*Ae+Z*(+bi(+Y)*+bi(+d)*Z),I=I+ +Hn(+ +ui(+Z),+ +ui(+(1-Z)))*2;while((i|0)!=(r|0));return Me[l>>3]=I,k=0,Ae=I,Ae=Ae*6371.007180918475,Me[l>>3]=Ae,Bt=z,k|0}function cs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;if(z=Bt,Bt=Bt+176|0,k=z,i=Ta(i,r,k)|0,i|0)return k=i,I=+Me[l>>3],I=I*6371.007180918475,I=I*1e3,Me[l>>3]=I,Bt=z,k|0;if(Me[l>>3]=0,i=o[k>>2]|0,(i|0)<=1)return k=0,I=0,I=I*6371.007180918475,I=I*1e3,Me[l>>3]=I,Bt=z,k|0;r=i+-1|0,i=0,d=+Me[k+8>>3],y=+Me[k+16>>3],I=0;do i=i+1|0,Y=d,d=+Me[k+8+(i<<4)>>3],Ae=+Si(+((d-Y)*.5)),Z=y,y=+Me[k+8+(i<<4)+8>>3],Z=+Si(+((y-Z)*.5)),Z=Ae*Ae+Z*(+bi(+Y)*+bi(+d)*Z),I=I+ +Hn(+ +ui(+Z),+ +ui(+(1-Z)))*2;while((i|0)!=(r|0));return Me[l>>3]=I,k=0,Ae=I,Ae=Ae*6371.007180918475,Ae=Ae*1e3,Me[l>>3]=Ae,Bt=z,k|0}function Yu(i){i=i|0;var r=0,l=0,d=0;return r=L(1,12)|0,r||kn(22832,22787,49,22845),l=i+4|0,d=o[l>>2]|0,d|0?(d=d+8|0,o[d>>2]=r,o[l>>2]=r,r|0):(o[i>>2]|0&&kn(22862,22787,61,22885),d=i,o[d>>2]=r,o[l>>2]=r,r|0)}function Nu(i,r){i=i|0,r=r|0;var l=0,d=0;return d=zs(24)|0,d||kn(22899,22787,78,22913),o[d>>2]=o[r>>2],o[d+4>>2]=o[r+4>>2],o[d+8>>2]=o[r+8>>2],o[d+12>>2]=o[r+12>>2],o[d+16>>2]=0,r=i+4|0,l=o[r>>2]|0,l|0?(o[l+16>>2]=d,o[r>>2]=d,d|0):(o[i>>2]|0&&kn(22928,22787,82,22913),o[i>>2]=d,o[r>>2]=d,d|0)}function wo(i){i=i|0;var r=0,l=0,d=0,y=0;if(i)for(d=1;;){if(r=o[i>>2]|0,r|0)do{if(l=o[r>>2]|0,l|0)do y=l,l=o[l+16>>2]|0,T(y);while(l|0);y=r,r=o[r+8>>2]|0,T(y)}while(r|0);if(r=i,i=o[i+8>>2]|0,d||T(r),i)d=0;else break}}function Ll(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0,ai=0,Wi=0,$i=0,Ei=0,Hi=0,ji=0,cn=0,Nn=0,nn=0;if(y=i+8|0,o[y>>2]|0)return nn=1,nn|0;if(d=o[i>>2]|0,!d)return nn=0,nn|0;r=d,l=0;do l=l+1|0,r=o[r+8>>2]|0;while(r|0);if(l>>>0<2)return nn=0,nn|0;cn=zs(l<<2)|0,cn||kn(22948,22787,317,22967),ji=zs(l<<5)|0,ji||kn(22989,22787,321,22967),o[i>>2]=0,Kt=i+4|0,o[Kt>>2]=0,o[y>>2]=0,l=0,Hi=0,si=0,Ie=0;e:for(;;){if(Ae=o[d>>2]|0,Ae){I=0,k=Ae;do{if(Z=+Me[k+8>>3],r=k,k=o[k+16>>2]|0,Y=(k|0)==0,y=Y?Ae:k,z=+Me[y+8>>3],+ti(+(Z-z))>3.141592653589793){nn=14;break}I=I+(z-Z)*(+Me[r>>3]+ +Me[y>>3])}while(!Y);if((nn|0)==14){nn=0,I=0,r=Ae;do It=+Me[r+8>>3],Ei=r+16|0,$i=o[Ei>>2]|0,$i=$i|0?$i:Ae,Tt=+Me[$i+8>>3],I=I+(+Me[r>>3]+ +Me[$i>>3])*((Tt<0?Tt+6.283185307179586:Tt)-(It<0?It+6.283185307179586:It)),r=o[(r|0?Ei:d)>>2]|0;while(r|0)}I>0?(o[cn+(Hi<<2)>>2]=d,Hi=Hi+1|0,y=si,r=Ie):nn=19}else nn=19;if((nn|0)==19){nn=0;do if(l){if(r=l+8|0,o[r>>2]|0){nn=21;break e}if(l=L(1,12)|0,!l){nn=23;break e}o[r>>2]=l,y=l+4|0,k=l,r=Ie}else if(Ie){y=Kt,k=Ie+8|0,r=d,l=i;break}else if(o[i>>2]|0){nn=27;break e}else{y=Kt,k=i,r=d,l=i;break}while(!1);if(o[k>>2]=d,o[y>>2]=d,k=ji+(si<<5)|0,Y=o[d>>2]|0,Y){for(Ae=ji+(si<<5)+8|0,Me[Ae>>3]=17976931348623157e292,Ie=ji+(si<<5)+24|0,Me[Ie>>3]=17976931348623157e292,Me[k>>3]=-17976931348623157e292,ke=ji+(si<<5)+16|0,Me[ke>>3]=-17976931348623157e292,lt=17976931348623157e292,ft=-17976931348623157e292,y=0,Fe=Y,Z=17976931348623157e292,tt=17976931348623157e292,wt=-17976931348623157e292,z=-17976931348623157e292;I=+Me[Fe>>3],It=+Me[Fe+8>>3],Fe=o[Fe+16>>2]|0,ze=(Fe|0)==0,Tt=+Me[(ze?Y:Fe)+8>>3],I<Z&&(Me[Ae>>3]=I,Z=I),It<tt&&(Me[Ie>>3]=It,tt=It),I>wt?Me[k>>3]=I:I=wt,It>z&&(Me[ke>>3]=It,z=It),lt=It>0&It<lt?It:lt,ft=It<0&It>ft?It:ft,y=y|+ti(+(It-Tt))>3.141592653589793,!ze;)wt=I;y&&(Me[ke>>3]=ft,Me[Ie>>3]=lt)}else o[k>>2]=0,o[k+4>>2]=0,o[k+8>>2]=0,o[k+12>>2]=0,o[k+16>>2]=0,o[k+20>>2]=0,o[k+24>>2]=0,o[k+28>>2]=0;y=si+1|0}if(Ei=d+8|0,d=o[Ei>>2]|0,o[Ei>>2]=0,d)si=y,Ie=r;else{nn=45;break}}if((nn|0)==21)kn(22765,22787,35,22799);else if((nn|0)==23)kn(22819,22787,37,22799);else if((nn|0)==27)kn(22862,22787,61,22885);else if((nn|0)==45){e:do if((Hi|0)>0){for(Ei=(y|0)==0,Wi=y<<2,$i=(i|0)==0,ai=0,r=0;;){if(ii=o[cn+(ai<<2)>>2]|0,Ei)nn=73;else{if(si=zs(Wi)|0,!si){nn=50;break}if(Kt=zs(Wi)|0,!Kt){nn=52;break}t:do if($i)l=0;else{for(y=0,l=0,k=i;d=ji+(y<<5)|0,Rn(o[k>>2]|0,d,o[ii>>2]|0)|0?(o[si+(l<<2)>>2]=k,o[Kt+(l<<2)>>2]=d,ze=l+1|0):ze=l,k=o[k+8>>2]|0,k;)y=y+1|0,l=ze;if((ze|0)>0)if(d=o[si>>2]|0,(ze|0)==1)l=d;else for(ke=0,Fe=-1,l=d,Ie=d;;){for(Y=o[Ie>>2]|0,d=0,k=0;y=o[o[si+(k<<2)>>2]>>2]|0,(y|0)==(Y|0)?Ae=d:Ae=d+((Rn(y,o[Kt+(k<<2)>>2]|0,o[Y>>2]|0)|0)&1)|0,k=k+1|0,(k|0)!=(ze|0);)d=Ae;if(y=(Ae|0)>(Fe|0),l=y?Ie:l,d=ke+1|0,(d|0)==(ze|0))break t;ke=d,Fe=y?Ae:Fe,Ie=o[si+(d<<2)>>2]|0}else l=0}while(!1);if(T(si),T(Kt),l){if(y=l+4|0,d=o[y>>2]|0,d)l=d+8|0;else if(o[l>>2]|0){nn=70;break}o[l>>2]=ii,o[y>>2]=ii}else nn=73}if((nn|0)==73){if(nn=0,r=o[ii>>2]|0,r|0)do Kt=r,r=o[r+16>>2]|0,T(Kt);while(r|0);T(ii),r=1}if(ai=ai+1|0,(ai|0)>=(Hi|0)){Nn=r;break e}}(nn|0)==50?kn(23004,22787,249,23023):(nn|0)==52?kn(23042,22787,252,23023):(nn|0)==70&&kn(22862,22787,61,22885)}else Nn=0;while(!1);return T(cn),T(ji),nn=Nn,nn|0}return 0}function Rn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0;if(!(Ka(r,l)|0)||(r=Ya(r)|0,d=+Me[l>>3],y=+Me[l+8>>3],y=r&y<0?y+6.283185307179586:y,i=o[i>>2]|0,!i))return i=0,i|0;if(r){r=0,Y=y,l=i;e:for(;;){for(;k=+Me[l>>3],y=+Me[l+8>>3],l=l+16|0,Ae=o[l>>2]|0,Ae=Ae|0?Ae:i,I=+Me[Ae>>3],z=+Me[Ae+8>>3],k>I?(Z=k,k=z):(Z=I,I=k,k=y,y=z),d=d==I|d==Z?d+2220446049250313e-31:d,!!(d<I|d>Z);)if(l=o[l>>2]|0,!l){l=22;break e}if(z=k<0?k+6.283185307179586:k,k=y<0?y+6.283185307179586:y,Y=z==Y|k==Y?Y+-2220446049250313e-31:Y,Z=z+(k-z)*((d-I)/(Z-I)),(Z<0?Z+6.283185307179586:Z)>Y&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}else{r=0,Y=y,l=i;e:for(;;){for(;k=+Me[l>>3],y=+Me[l+8>>3],l=l+16|0,Ae=o[l>>2]|0,Ae=Ae|0?Ae:i,I=+Me[Ae>>3],z=+Me[Ae+8>>3],k>I?(Z=k,k=z):(Z=I,I=k,k=y,y=z),d=d==I|d==Z?d+2220446049250313e-31:d,!!(d<I|d>Z);)if(l=o[l>>2]|0,!l){l=22;break e}if(Y=k==Y|y==Y?Y+-2220446049250313e-31:Y,k+(y-k)*((d-I)/(Z-I))>Y&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}return 0}function Na(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0;if(ft=Bt,Bt=Bt+32|0,lt=ft+16|0,wt=ft,I=Ht(i|0,r|0,52)|0,qt()|0,I=I&15,Fe=Ht(l|0,d|0,52)|0,qt()|0,(I|0)!=(Fe&15|0))return lt=12,Bt=ft,lt|0;if(Y=Ht(i|0,r|0,45)|0,qt()|0,Y=Y&127,Ae=Ht(l|0,d|0,45)|0,qt()|0,Ae=Ae&127,Y>>>0>121|Ae>>>0>121)return lt=5,Bt=ft,lt|0;if(Fe=(Y|0)!=(Ae|0),Fe){if(z=dr(Y,Ae)|0,(z|0)==7)return lt=1,Bt=ft,lt|0;Z=dr(Ae,Y)|0,(Z|0)==7?kn(23066,23090,161,23100):(ze=z,k=Z)}else ze=0,k=0;Ie=at(Y)|0,ke=at(Ae)|0,o[lt>>2]=0,o[lt+4>>2]=0,o[lt+8>>2]=0,o[lt+12>>2]=0;do if(ze){if(Ae=o[4272+(Y*28|0)+(ze<<2)>>2]|0,z=(Ae|0)>0,ke)if(z){Y=0,Z=l,z=d;do Z=Dl(Z,z)|0,z=qt()|0,k=gl(k)|0,(k|0)==1&&(k=gl(1)|0),Y=Y+1|0;while((Y|0)!=(Ae|0));Ae=k,Y=Z,Z=z}else Ae=k,Y=l,Z=d;else if(z){Y=0,Z=l,z=d;do Z=vo(Z,z)|0,z=qt()|0,k=gl(k)|0,Y=Y+1|0;while((Y|0)!=(Ae|0));Ae=k,Y=Z,Z=z}else Ae=k,Y=l,Z=d;if(el(Y,Z,lt)|0,Fe||kn(23115,23090,191,23100),z=(Ie|0)!=0,k=(ke|0)!=0,z&k&&kn(23142,23090,192,23100),z){if(k=ka(i,r)|0,(k|0)==7){I=5;break}if(Pt[21872+(k*7|0)+ze>>0]|0){I=1;break}Z=o[21040+(k*28|0)+(ze<<2)>>2]|0,Y=Z}else if(k){if(k=ka(Y,Z)|0,(k|0)==7){I=5;break}if(Pt[21872+(k*7|0)+Ae>>0]|0){I=1;break}Y=0,Z=o[21040+(Ae*28|0)+(k<<2)>>2]|0}else Y=0,Z=0;if((Y|Z|0)<0)I=5;else{if((Z|0)>0){z=lt+4|0,k=0;do Ja(z),k=k+1|0;while((k|0)!=(Z|0))}if(o[wt>>2]=0,o[wt+4>>2]=0,o[wt+8>>2]=0,na(wt,ze),I|0)for(;Ws(I)|0?Wo(wt):ma(wt),(I|0)>1;)I=I+-1|0;if((Y|0)>0){I=0;do Ja(wt),I=I+1|0;while((I|0)!=(Y|0))}tt=lt+4|0,Sr(tt,wt,tt),Or(tt),tt=51}}else if(el(l,d,lt)|0,(Ie|0)!=0&(ke|0)!=0)if((Ae|0)!=(Y|0)&&kn(23173,23090,261,23100),k=ka(i,r)|0,I=ka(l,d)|0,(k|0)==7|(I|0)==7)I=5;else if(Pt[21872+(k*7|0)+I>>0]|0)I=1;else if(k=o[21040+(k*28|0)+(I<<2)>>2]|0,(k|0)>0){z=lt+4|0,I=0;do Ja(z),I=I+1|0;while((I|0)!=(k|0));tt=51}else tt=51;else tt=51;while(!1);return(tt|0)==51&&(I=lt+4|0,o[y>>2]=o[I>>2],o[y+4>>2]=o[I+4>>2],o[y+8>>2]=o[I+8>>2],I=0),lt=I,Bt=ft,lt|0}function En(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0;if(tt=Bt,Bt=Bt+48|0,Y=tt+36|0,k=tt+24|0,z=tt+12|0,Z=tt,y=Ht(i|0,r|0,52)|0,qt()|0,y=y&15,ke=Ht(i|0,r|0,45)|0,qt()|0,ke=ke&127,ke>>>0>121)return d=5,Bt=tt,d|0;if(Ae=at(ke)|0,Qt(y|0,0,52)|0,wt=qt()|0|134225919,I=d,o[I>>2]=-1,o[I+4>>2]=wt,!y)return y=ko(l)|0,(y|0)==7||(y=or(ke,y)|0,(y|0)==127)?(wt=1,Bt=tt,wt|0):(Fe=Qt(y|0,0,45)|0,ze=qt()|0,ke=d,ze=o[ke+4>>2]&-1040385|ze,wt=d,o[wt>>2]=o[ke>>2]|Fe,o[wt+4>>2]=ze,wt=0,Bt=tt,wt|0);for(o[Y>>2]=o[l>>2],o[Y+4>>2]=o[l+4>>2],o[Y+8>>2]=o[l+8>>2],l=y;;){if(I=l,l=l+-1|0,o[k>>2]=o[Y>>2],o[k+4>>2]=o[Y+4>>2],o[k+8>>2]=o[Y+8>>2],Ws(I)|0){if(y=Qo(Y)|0,y|0){l=13;break}o[z>>2]=o[Y>>2],o[z+4>>2]=o[Y+4>>2],o[z+8>>2]=o[Y+8>>2],Wo(z)}else{if(y=Ns(Y)|0,y|0){l=13;break}o[z>>2]=o[Y>>2],o[z+4>>2]=o[Y+4>>2],o[z+8>>2]=o[Y+8>>2],ma(z)}if(ra(k,z,Z),Or(Z),y=d,ft=o[y>>2]|0,y=o[y+4>>2]|0,Tt=(15-I|0)*3|0,lt=Qt(7,0,Tt|0)|0,y=y&~(qt()|0),Tt=Qt(ko(Z)|0,0,Tt|0)|0,y=qt()|0|y,wt=d,o[wt>>2]=Tt|ft&~lt,o[wt+4>>2]=y,(I|0)<=1){l=14;break}}e:do if((l|0)!=13&&(l|0)==14)if((o[Y>>2]|0)<=1&&(o[Y+4>>2]|0)<=1&&(o[Y+8>>2]|0)<=1){l=ko(Y)|0,y=or(ke,l)|0,(y|0)==127?Z=0:Z=at(y)|0;t:do if(l){if(Ae){if(y=ka(i,r)|0,(y|0)==7){y=5;break e}if(I=o[21248+(y*28|0)+(l<<2)>>2]|0,(I|0)>0){y=l,l=0;do y=Fa(y)|0,l=l+1|0;while((l|0)!=(I|0))}else y=l;if((y|0)==1){y=9;break e}l=or(ke,y)|0,(l|0)==127&&kn(23200,23090,411,23230),at(l)|0?kn(23245,23090,412,23230):(ze=l,Fe=I,Ie=y)}else ze=y,Fe=0,Ie=l;if(z=o[4272+(ke*28|0)+(Ie<<2)>>2]|0,(z|0)<=-1&&kn(23276,23090,419,23230),!Z){if((Fe|0)<0){y=5;break e}if(Fe|0){I=d,y=0,l=o[I>>2]|0,I=o[I+4>>2]|0;do l=Lo(l,I)|0,I=qt()|0,Tt=d,o[Tt>>2]=l,o[Tt+4>>2]=I,y=y+1|0;while((y|0)<(Fe|0))}if((z|0)<=0){y=ze,l=58;break}for(I=d,y=0,l=o[I>>2]|0,I=o[I+4>>2]|0;;)if(l=Lo(l,I)|0,I=qt()|0,Tt=d,o[Tt>>2]=l,o[Tt+4>>2]=I,y=y+1|0,(y|0)==(z|0)){y=ze,l=58;break t}}if(k=dr(ze,ke)|0,(k|0)==7&&kn(23066,23090,428,23230),y=d,l=o[y>>2]|0,y=o[y+4>>2]|0,(z|0)>0){I=0;do l=Lo(l,y)|0,y=qt()|0,Tt=d,o[Tt>>2]=l,o[Tt+4>>2]=y,I=I+1|0;while((I|0)!=(z|0))}if(y=ka(l,y)|0,(y|0)==7&&kn(23313,23090,440,23230),l=Ct(ze)|0,l=o[(l?21664:21456)+(k*28|0)+(y<<2)>>2]|0,(l|0)<0&&kn(23313,23090,454,23230),!l)y=ze,l=58;else{k=d,y=0,I=o[k>>2]|0,k=o[k+4>>2]|0;do I=Pl(I,k)|0,k=qt()|0,Tt=d,o[Tt>>2]=I,o[Tt+4>>2]=k,y=y+1|0;while((y|0)<(l|0));y=ze,l=58}}else if((Ae|0)!=0&(Z|0)!=0){if(l=ka(i,r)|0,I=d,I=ka(o[I>>2]|0,o[I+4>>2]|0)|0,(l|0)==7|(I|0)==7){y=5;break e}if(I=o[21248+(l*28|0)+(I<<2)>>2]|0,(I|0)<0){y=5;break e}if(!I)l=59;else{z=d,l=0,k=o[z>>2]|0,z=o[z+4>>2]|0;do k=Lo(k,z)|0,z=qt()|0,Tt=d,o[Tt>>2]=k,o[Tt+4>>2]=z,l=l+1|0;while((l|0)<(I|0));l=58}}else l=58;while(!1);if((l|0)==58&&Z&&(l=59),(l|0)==59&&(Tt=d,(ka(o[Tt>>2]|0,o[Tt+4>>2]|0)|0)==1)){y=9;break}Tt=d,lt=o[Tt>>2]|0,Tt=o[Tt+4>>2]&-1040385,ft=Qt(y|0,0,45)|0,Tt=Tt|(qt()|0),y=d,o[y>>2]=lt|ft,o[y+4>>2]=Tt,y=0}else y=1;while(!1);return Tt=y,Bt=tt,Tt|0}function Vo(i,r,l,d,y,I){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0,I=I|0;var k=0,z=0;return z=Bt,Bt=Bt+16|0,k=z,y?i=15:(i=Na(i,r,l,d,k)|0,i||(lc(k,I),i=0)),Bt=z,i|0}function Gl(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0;return k=Bt,Bt=Bt+16|0,I=k,d?l=15:(l=uo(l,I)|0,l||(l=En(i,r,I,y)|0)),Bt=k,l|0}function Cn(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0;return Z=Bt,Bt=Bt+32|0,k=Z+12|0,z=Z,I=Na(i,r,i,r,k)|0,I|0?(z=I,Bt=Z,z|0):(i=Na(i,r,l,d,z)|0,i|0?(z=i,Bt=Z,z|0):(k=ps(k,z)|0,z=y,o[z>>2]=k,o[z+4>>2]=((k|0)<0)<<31>>31,z=0,Bt=Z,z|0))}function Yl(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0;return Z=Bt,Bt=Bt+32|0,k=Z+12|0,z=Z,I=Na(i,r,i,r,k)|0,!I&&(I=Na(i,r,l,d,z)|0,!I)?(d=ps(k,z)|0,d=R(d|0,((d|0)<0)<<31>>31|0,1,0)|0,k=qt()|0,z=y,o[z>>2]=d,o[z+4>>2]=k,z=0,Bt=Z,z|0):(z=I,Bt=Z,z|0)}function Tn(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0,ai=0;if(ii=Bt,Bt=Bt+48|0,k=ii+24|0,z=ii+12|0,Kt=ii,I=Na(i,r,i,r,k)|0,!I&&(I=Na(i,r,l,d,z)|0,!I)){It=ps(k,z)|0,si=((It|0)<0)<<31>>31,o[k>>2]=0,o[k+4>>2]=0,o[k+8>>2]=0,o[z>>2]=0,o[z+4>>2]=0,o[z+8>>2]=0,Na(i,r,i,r,k)|0&&kn(23313,23090,691,23299),Na(i,r,l,d,z)|0&&kn(23313,23090,696,23299),co(k),co(z),It?(Ie=o[k>>2]|0,ze=+(It|0),lt=k+4|0,ke=o[lt>>2]|0,ft=k+8|0,Fe=o[ft>>2]|0,Tt=k,d=Ie,I=ke,l=Fe,tt=+((o[z>>2]|0)-Ie|0)/ze,wt=+((o[z+4>>2]|0)-ke|0)/ze,ze=+((o[z+8>>2]|0)-Fe|0)/ze):(I=k+4|0,l=k+8|0,lt=I,ft=l,Tt=k,d=o[k>>2]|0,I=o[I>>2]|0,l=o[l>>2]|0,tt=0,wt=0,ze=0),o[Kt>>2]=d,Fe=Kt+4|0,o[Fe>>2]=I,ke=Kt+8|0,o[ke>>2]=l;e:do if((It|0)<0)I=0;else for(Ae=0,Ie=0,I=d;;){Y=+(Ie>>>0)+4294967296*+(Ae|0),ai=tt*Y+ +(I|0),Z=wt*Y+ +(o[lt>>2]|0),Y=ze*Y+ +(o[ft>>2]|0),l=~~+C(+ai),k=~~+C(+Z),I=~~+C(+Y),ai=+ti(+(+(l|0)-ai)),Z=+ti(+(+(k|0)-Z)),Y=+ti(+(+(I|0)-Y));do if(ai>Z&ai>Y)l=0-(k+I)|0,d=k;else if(z=0-l|0,Z>Y){d=z-I|0;break}else{d=k,I=z-k|0;break}while(!1);if(o[Kt>>2]=l,o[Fe>>2]=d,o[ke>>2]=I,Xl(Kt),I=En(i,r,Kt,y+(Ie<<3)|0)|0,I|0)break e;if(!((Ae|0)<(si|0)|(Ae|0)==(si|0)&Ie>>>0<It>>>0)){I=0;break e}I=R(Ie|0,Ae|0,1,0)|0,z=qt()|0,Ae=z,Ie=I,I=o[Tt>>2]|0}while(!1);return Kt=I,Bt=ii,Kt|0}return Kt=I,Bt=ii,Kt|0}function yl(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0;if((l|0)==0&(d|0)==0)return y=0,I=1,en(y|0),I|0;I=i,y=r,i=1,r=0;do k=(l&1|0)==0&!0,i=Xe((k?1:I)|0,(k?0:y)|0,i|0,r|0)|0,r=qt()|0,l=ri(l|0,d|0,1)|0,d=qt()|0,I=Xe(I|0,y|0,I|0,y|0)|0,y=qt()|0;while(!((l|0)==0&(d|0)==0));return en(r|0),i|0}function hu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0;if(!(Ka(r,l)|0)||(r=Ya(r)|0,d=+Me[l>>3],y=+Me[l+8>>3],y=r&y<0?y+6.283185307179586:y,ke=o[i>>2]|0,(ke|0)<=0))return ke=0,ke|0;if(Ie=o[i+4>>2]|0,r){r=0,Ae=y,l=-1,i=0;e:for(;;){for(Y=i;k=+Me[Ie+(Y<<4)>>3],y=+Me[Ie+(Y<<4)+8>>3],i=(l+2|0)%(ke|0)|0,I=+Me[Ie+(i<<4)>>3],z=+Me[Ie+(i<<4)+8>>3],k>I?(Z=k,k=z):(Z=I,I=k,k=y,y=z),d=d==I|d==Z?d+2220446049250313e-31:d,!!(d<I|d>Z);)if(l=Y+1|0,(l|0)>=(ke|0)){l=22;break e}else i=Y,Y=l,l=i;if(z=k<0?k+6.283185307179586:k,k=y<0?y+6.283185307179586:y,Ae=z==Ae|k==Ae?Ae+-2220446049250313e-31:Ae,Z=z+(k-z)*((d-I)/(Z-I)),(Z<0?Z+6.283185307179586:Z)>Ae&&(r=r^1),i=Y+1|0,(i|0)>=(ke|0)){l=22;break}else l=Y}if((l|0)==22)return r|0}else{r=0,Ae=y,l=-1,i=0;e:for(;;){for(Y=i;k=+Me[Ie+(Y<<4)>>3],y=+Me[Ie+(Y<<4)+8>>3],i=(l+2|0)%(ke|0)|0,I=+Me[Ie+(i<<4)>>3],z=+Me[Ie+(i<<4)+8>>3],k>I?(Z=k,k=z):(Z=I,I=k,k=y,y=z),d=d==I|d==Z?d+2220446049250313e-31:d,!!(d<I|d>Z);)if(l=Y+1|0,(l|0)>=(ke|0)){l=22;break e}else i=Y,Y=l,l=i;if(Ae=k==Ae|y==Ae?Ae+-2220446049250313e-31:Ae,k+(y-k)*((d-I)/(Z-I))>Ae&&(r=r^1),i=Y+1|0,(i|0)>=(ke|0)){l=22;break}else l=Y}if((l|0)==22)return r|0}return 0}function Vu(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0;if(ze=o[i>>2]|0,!ze){o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;return}if(tt=r+8|0,Me[tt>>3]=17976931348623157e292,wt=r+24|0,Me[wt>>3]=17976931348623157e292,Me[r>>3]=-17976931348623157e292,lt=r+16|0,Me[lt>>3]=-17976931348623157e292,!((ze|0)<=0)){for(ke=o[i+4>>2]|0,Y=17976931348623157e292,Ae=-17976931348623157e292,Ie=0,i=-1,I=17976931348623157e292,k=17976931348623157e292,Z=-17976931348623157e292,d=-17976931348623157e292,Fe=0;l=+Me[ke+(Fe<<4)>>3],z=+Me[ke+(Fe<<4)+8>>3],i=i+2|0,y=+Me[ke+(((i|0)==(ze|0)?0:i)<<4)+8>>3],l<I&&(Me[tt>>3]=l,I=l),z<k&&(Me[wt>>3]=z,k=z),l>Z?Me[r>>3]=l:l=Z,z>d&&(Me[lt>>3]=z,d=z),Y=z>0&z<Y?z:Y,Ae=z<0&z>Ae?z:Ae,Ie=Ie|+ti(+(z-y))>3.141592653589793,i=Fe+1|0,(i|0)!=(ze|0);)ft=Fe,Z=l,Fe=i,i=ft;Ie&&(Me[lt>>3]=Ae,Me[wt>>3]=Y)}}function ql(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0,Kt=0,ii=0;if(ze=o[i>>2]|0,ze){if(tt=r+8|0,Me[tt>>3]=17976931348623157e292,wt=r+24|0,Me[wt>>3]=17976931348623157e292,Me[r>>3]=-17976931348623157e292,lt=r+16|0,Me[lt>>3]=-17976931348623157e292,(ze|0)>0){for(y=o[i+4>>2]|0,ke=17976931348623157e292,Fe=-17976931348623157e292,d=0,l=-1,Z=17976931348623157e292,Y=17976931348623157e292,Ie=-17976931348623157e292,k=-17976931348623157e292,ft=0;I=+Me[y+(ft<<4)>>3],Ae=+Me[y+(ft<<4)+8>>3],Kt=l+2|0,z=+Me[y+(((Kt|0)==(ze|0)?0:Kt)<<4)+8>>3],I<Z&&(Me[tt>>3]=I,Z=I),Ae<Y&&(Me[wt>>3]=Ae,Y=Ae),I>Ie?Me[r>>3]=I:I=Ie,Ae>k&&(Me[lt>>3]=Ae,k=Ae),ke=Ae>0&Ae<ke?Ae:ke,Fe=Ae<0&Ae>Fe?Ae:Fe,d=d|+ti(+(Ae-z))>3.141592653589793,l=ft+1|0,(l|0)!=(ze|0);)Kt=ft,Ie=I,ft=l,l=Kt;d&&(Me[lt>>3]=Fe,Me[wt>>3]=ke)}}else o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;if(Kt=i+8|0,l=o[Kt>>2]|0,!((l|0)<=0)){si=i+12|0,It=0;do if(y=o[si>>2]|0,d=It,It=It+1|0,wt=r+(It<<5)|0,lt=o[y+(d<<3)>>2]|0,lt){if(ft=r+(It<<5)+8|0,Me[ft>>3]=17976931348623157e292,i=r+(It<<5)+24|0,Me[i>>3]=17976931348623157e292,Me[wt>>3]=-17976931348623157e292,Tt=r+(It<<5)+16|0,Me[Tt>>3]=-17976931348623157e292,(lt|0)>0){for(ze=o[y+(d<<3)+4>>2]|0,ke=17976931348623157e292,Fe=-17976931348623157e292,y=0,d=-1,tt=0,Z=17976931348623157e292,Y=17976931348623157e292,Ae=-17976931348623157e292,k=-17976931348623157e292;I=+Me[ze+(tt<<4)>>3],Ie=+Me[ze+(tt<<4)+8>>3],d=d+2|0,z=+Me[ze+(((d|0)==(lt|0)?0:d)<<4)+8>>3],I<Z&&(Me[ft>>3]=I,Z=I),Ie<Y&&(Me[i>>3]=Ie,Y=Ie),I>Ae?Me[wt>>3]=I:I=Ae,Ie>k&&(Me[Tt>>3]=Ie,k=Ie),ke=Ie>0&Ie<ke?Ie:ke,Fe=Ie<0&Ie>Fe?Ie:Fe,y=y|+ti(+(Ie-z))>3.141592653589793,d=tt+1|0,(d|0)!=(lt|0);)ii=tt,tt=d,Ae=I,d=ii;y&&(Me[Tt>>3]=Fe,Me[i>>3]=ke)}}else o[wt>>2]=0,o[wt+4>>2]=0,o[wt+8>>2]=0,o[wt+12>>2]=0,o[wt+16>>2]=0,o[wt+20>>2]=0,o[wt+24>>2]=0,o[wt+28>>2]=0,l=o[Kt>>2]|0;while((It|0)<(l|0))}}function vl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;if(!(hu(i,r,l)|0))return y=0,y|0;if(y=i+8|0,(o[y>>2]|0)<=0)return y=1,y|0;for(d=i+12|0,i=0;;){if(I=i,i=i+1|0,hu((o[d>>2]|0)+(I<<3)|0,r+(i<<5)|0,l)|0){i=0,d=6;break}if((i|0)>=(o[y>>2]|0)){i=1,d=6;break}}return(d|0)==6?i|0:0}function oa(){return 8}function uc(){return 16}function Ku(){return 168}function Kl(){return 8}function ys(){return 16}function wa(){return 12}function tl(){return 8}function xu(i){return i=i|0,+(+((o[i>>2]|0)>>>0)+4294967296*+(o[i+4>>2]|0))}function Uu(i){i=i|0;var r=0,l=0;return l=+Me[i>>3],r=+Me[i+8>>3],+ +ui(+(l*l+r*r))}function Au(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0;Y=+Me[i>>3],Z=+Me[r>>3]-Y,z=+Me[i+8>>3],k=+Me[r+8>>3]-z,Ie=+Me[l>>3],I=+Me[d>>3]-Ie,ke=+Me[l+8>>3],Ae=+Me[d+8>>3]-ke,I=(I*(z-ke)-(Y-Ie)*Ae)/(Z*Ae-k*I),Me[y>>3]=Y+Z*I,Me[y+8>>3]=z+k*I}function Gu(i,r){return i=i|0,r=r|0,+ti(+(+Me[i>>3]-+Me[r>>3]))<11920928955078125e-23?(r=+ti(+(+Me[i+8>>3]-+Me[r+8>>3]))<11920928955078125e-23,r|0):(r=0,r|0)}function br(i,r){i=i|0,r=r|0;var l=0,d=0,y=0;return y=+Me[i>>3]-+Me[r>>3],d=+Me[i+8>>3]-+Me[r+8>>3],l=+Me[i+16>>3]-+Me[r+16>>3],+(y*y+d*d+l*l)}function vs(i,r){i=i|0,r=r|0;var l=0,d=0,y=0;l=+Me[i>>3],d=+bi(+l),l=+Si(+l),Me[r+16>>3]=l,l=+Me[i+8>>3],y=d*+bi(+l),Me[r>>3]=y,l=d*+Si(+l),Me[r+8>>3]=l}function gn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;if(I=Bt,Bt=Bt+16|0,y=I,d=Br(i,r)|0,(l+-1|0)>>>0>5||(d=(d|0)!=0,(l|0)==1&d))return y=-1,Bt=I,y|0;do if(Zn(i,r,y)|0)d=-1;else if(d){d=((o[21936+(l<<2)>>2]|0)+5-(o[y>>2]|0)|0)%5|0;break}else{d=((o[21968+(l<<2)>>2]|0)+6-(o[y>>2]|0)|0)%6|0;break}while(!1);return y=d,Bt=I,y|0}function Zn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0,Y=0;if(Y=Bt,Bt=Bt+32|0,k=Y+16|0,z=Y,d=ns(i,r,k)|0,d|0)return l=d,Bt=Y,l|0;I=Ul(i,r)|0,Z=ka(i,r)|0,Li(I,z),d=An(I,o[k>>2]|0)|0;e:do if(at(I)|0){do switch(I|0){case 4:{i=0;break}case 14:{i=1;break}case 24:{i=2;break}case 38:{i=3;break}case 49:{i=4;break}case 58:{i=5;break}case 63:{i=6;break}case 72:{i=7;break}case 83:{i=8;break}case 97:{i=9;break}case 107:{i=10;break}case 117:{i=11;break}default:{d=1;break e}}while(!1);if(y=o[22e3+(i*24|0)+8>>2]|0,r=o[22e3+(i*24|0)+16>>2]|0,i=o[k>>2]|0,(i|0)!=(o[z>>2]|0)&&(z=Ct(I)|0,i=o[k>>2]|0,z|(i|0)==(r|0)&&(d=(d+1|0)%6|0)),(Z|0)==3&(i|0)==(r|0)){d=(d+5|0)%6|0,y=22;break}(Z|0)==5&(i|0)==(y|0)&&(d=(d+1|0)%6|0),y=22}else y=22;while(!1);return(y|0)==22&&(o[l>>2]=d,d=0),l=d,Bt=Y,l|0}function ir(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0;if(Tt=Bt,Bt=Bt+32|0,ft=Tt+24|0,wt=Tt+20|0,ze=Tt+8|0,Fe=Tt+16|0,ke=Tt,Z=(Br(i,r)|0)==0,Z=Z?6:5,Ae=Ht(i|0,r|0,52)|0,qt()|0,Ae=Ae&15,Z>>>0<=l>>>0)return d=2,Bt=Tt,d|0;Ie=(Ae|0)==0,!Ie&&(tt=Qt(7,0,(Ae^15)*3|0)|0,(tt&i|0)==0&((qt()|0)&r|0)==0)?y=l:I=4;e:do if((I|0)==4){if(y=(Br(i,r)|0)!=0,((y?4:5)|0)<(l|0)||Zn(i,r,ft)|0||(I=(o[ft>>2]|0)+l|0,y?y=22288+(((I|0)%5|0)<<2)|0:y=22320+(((I|0)%6|0)<<2)|0,tt=o[y>>2]|0,(tt|0)==7))return d=1,Bt=Tt,d|0;o[wt>>2]=0,y=ds(i,r,tt,wt,ze)|0;do if(!y){if(z=ze,Y=o[z>>2]|0,z=o[z+4>>2]|0,k=z>>>0<r>>>0|(z|0)==(r|0)&Y>>>0<i>>>0,I=k?Y:i,k=k?z:r,!Ie&&(Ie=Qt(7,0,(Ae^15)*3|0)|0,(Y&Ie|0)==0&(z&(qt()|0)|0)==0))y=l;else{if(z=(l+-1+Z|0)%(Z|0)|0,y=Br(i,r)|0,(z|0)<0&&kn(23313,23315,245,23324),Z=(y|0)!=0,((Z?4:5)|0)<(z|0)&&kn(23313,23315,245,23324),Zn(i,r,ft)|0&&kn(23313,23315,245,23324),y=(o[ft>>2]|0)+z|0,Z?y=22288+(((y|0)%5|0)<<2)|0:y=22320+(((y|0)%6|0)<<2)|0,z=o[y>>2]|0,(z|0)==7&&kn(23313,23315,245,23324),o[Fe>>2]=0,y=ds(i,r,z,Fe,ke)|0,y|0)break;Y=ke,Z=o[Y>>2]|0,Y=o[Y+4>>2]|0;do if(Y>>>0<k>>>0|(Y|0)==(k|0)&Z>>>0<I>>>0){if(Br(Z,Y)|0?I=Wa(Z,Y,i,r)|0:I=o[22384+((((o[Fe>>2]|0)+(o[22352+(z<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,y=Br(Z,Y)|0,(I+-1|0)>>>0>5){y=-1,I=Z,k=Y;break}if(y=(y|0)!=0,(I|0)==1&y){y=-1,I=Z,k=Y;break}do if(Zn(Z,Y,ft)|0)y=-1;else if(y){y=((o[21936+(I<<2)>>2]|0)+5-(o[ft>>2]|0)|0)%5|0;break}else{y=((o[21968+(I<<2)>>2]|0)+6-(o[ft>>2]|0)|0)%6|0;break}while(!1);I=Z,k=Y}else y=l;while(!1);z=ze,Y=o[z>>2]|0,z=o[z+4>>2]|0}if((I|0)==(Y|0)&(k|0)==(z|0)){if(Z=(Br(Y,z)|0)!=0,Z?i=Wa(Y,z,i,r)|0:i=o[22384+((((o[wt>>2]|0)+(o[22352+(tt<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,y=Br(Y,z)|0,(i+-1|0)>>>0<=5&&(lt=(y|0)!=0,!((i|0)==1&lt)))do if(Zn(Y,z,ft)|0)y=-1;else if(lt){y=((o[21936+(i<<2)>>2]|0)+5-(o[ft>>2]|0)|0)%5|0;break}else{y=((o[21968+(i<<2)>>2]|0)+6-(o[ft>>2]|0)|0)%6|0;break}while(!1);else y=-1;y=y+1|0,y=(y|0)==6|Z&(y|0)==5?0:y}r=k,i=I;break e}while(!1);return d=y,Bt=Tt,d|0}while(!1);return lt=Qt(y|0,0,56)|0,ft=qt()|0|r&-2130706433|536870912,o[d>>2]=lt|i,o[d+4>>2]=ft,d=0,Bt=Tt,d|0}function il(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;return I=(Br(i,r)|0)==0,d=ir(i,r,0,l)|0,y=(d|0)==0,I?!y||(d=ir(i,r,1,l+8|0)|0,d|0)||(d=ir(i,r,2,l+16|0)|0,d|0)||(d=ir(i,r,3,l+24|0)|0,d|0)||(d=ir(i,r,4,l+32|0)|0,d)?(I=d,I|0):ir(i,r,5,l+40|0)|0:!y||(d=ir(i,r,1,l+8|0)|0,d|0)||(d=ir(i,r,2,l+16|0)|0,d|0)||(d=ir(i,r,3,l+24|0)|0,d|0)||(d=ir(i,r,4,l+32|0)|0,d|0)?(I=d,I|0):(I=l+40|0,o[I>>2]=0,o[I+4>>2]=0,I=0,I|0)}function Pu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0,z=0,Z=0;return Z=Bt,Bt=Bt+192|0,y=Z,I=Z+168|0,k=Ht(i|0,r|0,56)|0,qt()|0,k=k&7,z=r&-2130706433|134217728,d=ns(i,z,I)|0,d|0?(z=d,Bt=Z,z|0):(r=Ht(i|0,r|0,52)|0,qt()|0,r=r&15,Br(i,z)|0?Jo(I,r,k,1,y):pr(I,r,k,1,y),z=y+8|0,o[l>>2]=o[z>>2],o[l+4>>2]=o[z+4>>2],o[l+8>>2]=o[z+8>>2],o[l+12>>2]=o[z+12>>2],z=0,Bt=Z,z|0)}function fa(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0;return y=Bt,Bt=Bt+16|0,l=y,!(!0&(r&2013265920|0)==536870912)||(d=r&-2130706433|134217728,!(as(i,d)|0))?(d=0,Bt=y,d|0):(I=Ht(i|0,r|0,56)|0,qt()|0,I=(ir(i,d,I&7,l)|0)==0,d=l,d=I&((o[d>>2]|0)==(i|0)?(o[d+4>>2]|0)==(r|0):0)&1,Bt=y,d|0)}function bu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0;(r|0)>0?(d=L(r,4)|0,o[i>>2]=d,d||kn(23337,23360,40,23374)):o[i>>2]=0,o[i+4>>2]=r,o[i+8>>2]=0,o[i+12>>2]=l}function Is(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0;y=i+4|0,I=i+12|0,k=i+8|0;e:for(;;){for(l=o[y>>2]|0,r=0;;){if((r|0)>=(l|0))break e;if(d=o[i>>2]|0,z=o[d+(r<<2)>>2]|0,!z)r=r+1|0;else break}r=d+(~~(+ti(+(+Ri(10,+ +(15-(o[I>>2]|0)|0))*(+Me[z>>3]+ +Me[z+8>>3])))%+(l|0))>>>0<<2)|0,l=o[r>>2]|0;t:do if(l|0){if(d=z+32|0,(l|0)==(z|0))o[r>>2]=o[d>>2];else{if(l=l+32|0,r=o[l>>2]|0,!r)break;for(;(r|0)!=(z|0);)if(l=r+32|0,r=o[l>>2]|0,!r)break t;o[l>>2]=o[d>>2]}T(z),o[k>>2]=(o[k>>2]|0)+-1}while(!1)}T(o[i>>2]|0)}function Bo(i){i=i|0;var r=0,l=0,d=0;for(d=o[i+4>>2]|0,l=0;;){if((l|0)>=(d|0)){r=0,l=4;break}if(r=o[(o[i>>2]|0)+(l<<2)>>2]|0,!r)l=l+1|0;else{l=4;break}}return(l|0)==4?r|0:0}function Mi(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0;if(l=~~(+ti(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+Me[r>>3]+ +Me[r+8>>3])))%+(o[i+4>>2]|0))>>>0,l=(o[i>>2]|0)+(l<<2)|0,d=o[l>>2]|0,!d)return I=1,I|0;I=r+32|0;do if((d|0)!=(r|0)){if(l=o[d+32>>2]|0,!l)return I=1,I|0;for(y=l;;){if((y|0)==(r|0)){y=8;break}if(l=o[y+32>>2]|0,l)d=y,y=l;else{l=1,y=10;break}}if((y|0)==8){o[d+32>>2]=o[I>>2];break}else if((y|0)==10)return l|0}else o[l>>2]=o[I>>2];while(!1);return T(r),I=i+8|0,o[I>>2]=(o[I>>2]|0)+-1,I=0,I|0}function zi(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0;I=zs(40)|0,I||kn(23390,23360,98,23403),o[I>>2]=o[r>>2],o[I+4>>2]=o[r+4>>2],o[I+8>>2]=o[r+8>>2],o[I+12>>2]=o[r+12>>2],y=I+16|0,o[y>>2]=o[l>>2],o[y+4>>2]=o[l+4>>2],o[y+8>>2]=o[l+8>>2],o[y+12>>2]=o[l+12>>2],o[I+32>>2]=0,y=~~(+ti(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+Me[r>>3]+ +Me[r+8>>3])))%+(o[i+4>>2]|0))>>>0,y=(o[i>>2]|0)+(y<<2)|0,d=o[y>>2]|0;do if(!d)o[y>>2]=I;else{for(;!(ho(d,r)|0&&ho(d+16|0,l)|0);)if(y=o[d+32>>2]|0,d=y|0?y:d,!(o[d+32>>2]|0)){k=10;break}if((k|0)==10){o[d+32>>2]=I;break}return T(I),k=d,k|0}while(!1);return k=i+8|0,o[k>>2]=(o[k>>2]|0)+1,k=I,k|0}function Es(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0;if(y=~~(+ti(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+Me[r>>3]+ +Me[r+8>>3])))%+(o[i+4>>2]|0))>>>0,y=o[(o[i>>2]|0)+(y<<2)>>2]|0,!y)return l=0,l|0;if(!l){for(i=y;;){if(ho(i,r)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}if((d|0)==10)return i|0}for(i=y;;){if(ho(i,r)|0&&ho(i+16|0,l)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}return(d|0)==10?i|0:0}function wu(i,r){i=i|0,r=r|0;var l=0;if(l=~~(+ti(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+Me[r>>3]+ +Me[r+8>>3])))%+(o[i+4>>2]|0))>>>0,i=o[(o[i>>2]|0)+(l<<2)>>2]|0,!i)return l=0,l|0;for(;;){if(ho(i,r)|0){r=5;break}if(i=o[i+32>>2]|0,!i){i=0,r=5;break}}return(r|0)==5?i|0:0}function Uo(){return 23424}function ms(i){return i=+i,+ +x(+i)}function Al(i){return i=+i,~~+ms(i)|0}function zs(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0,tt=0,wt=0,lt=0,ft=0,Tt=0,It=0,si=0;si=Bt,Bt=Bt+16|0,ke=si;do if(i>>>0<245){if(Y=i>>>0<11?16:i+11&-8,i=Y>>>3,Ie=o[5857]|0,l=Ie>>>i,l&3|0)return r=(l&1^1)+i|0,i=23468+(r<<1<<2)|0,l=i+8|0,d=o[l>>2]|0,y=d+8|0,I=o[y>>2]|0,(I|0)==(i|0)?o[5857]=Ie&~(1<<r):(o[I+12>>2]=i,o[l>>2]=I),It=r<<3,o[d+4>>2]=It|3,It=d+It+4|0,o[It>>2]=o[It>>2]|1,It=y,Bt=si,It|0;if(Ae=o[5859]|0,Y>>>0>Ae>>>0){if(l|0)return r=2<<i,r=l<<i&(r|0-r),r=(r&0-r)+-1|0,z=r>>>12&16,r=r>>>z,l=r>>>5&8,r=r>>>l,I=r>>>2&4,r=r>>>I,i=r>>>1&2,r=r>>>i,d=r>>>1&1,d=(l|z|I|i|d)+(r>>>d)|0,r=23468+(d<<1<<2)|0,i=r+8|0,I=o[i>>2]|0,z=I+8|0,l=o[z>>2]|0,(l|0)==(r|0)?(i=Ie&~(1<<d),o[5857]=i):(o[l+12>>2]=r,o[i>>2]=l,i=Ie),It=d<<3,k=It-Y|0,o[I+4>>2]=Y|3,y=I+Y|0,o[y+4>>2]=k|1,o[I+It>>2]=k,Ae|0&&(d=o[5862]|0,r=Ae>>>3,l=23468+(r<<1<<2)|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=k,o[5862]=y,It=z,Bt=si,It|0;if(I=o[5858]|0,I){for(l=(I&0-I)+-1|0,y=l>>>12&16,l=l>>>y,d=l>>>5&8,l=l>>>d,k=l>>>2&4,l=l>>>k,z=l>>>1&2,l=l>>>z,Z=l>>>1&1,Z=o[23732+((d|y|k|z|Z)+(l>>>Z)<<2)>>2]|0,l=Z,z=Z,Z=(o[Z+4>>2]&-8)-Y|0;i=o[l+16>>2]|0,!(!i&&(i=o[l+20>>2]|0,!i));)k=(o[i+4>>2]&-8)-Y|0,y=k>>>0<Z>>>0,l=i,z=y?i:z,Z=y?k:Z;if(k=z+Y|0,k>>>0>z>>>0){y=o[z+24>>2]|0,r=o[z+12>>2]|0;do if((r|0)==(z|0)){if(i=z+20|0,r=o[i>>2]|0,!r&&(i=z+16|0,r=o[i>>2]|0,!r)){l=0;break}for(;;)if(d=r+20|0,l=o[d>>2]|0,l)r=l,i=d;else if(d=r+16|0,l=o[d>>2]|0,l)r=l,i=d;else break;o[i>>2]=0,l=r}else l=o[z+8>>2]|0,o[l+12>>2]=r,o[r+8>>2]=l,l=r;while(!1);do if(y|0){if(r=o[z+28>>2]|0,i=23732+(r<<2)|0,(z|0)==(o[i>>2]|0)){if(o[i>>2]=l,!l){o[5858]=I&~(1<<r);break}}else if(It=y+16|0,o[((o[It>>2]|0)==(z|0)?It:y+20|0)>>2]=l,!l)break;o[l+24>>2]=y,r=o[z+16>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),r=o[z+20>>2]|0,r|0&&(o[l+20>>2]=r,o[r+24>>2]=l)}while(!1);return Z>>>0<16?(It=Z+Y|0,o[z+4>>2]=It|3,It=z+It+4|0,o[It>>2]=o[It>>2]|1):(o[z+4>>2]=Y|3,o[k+4>>2]=Z|1,o[k+Z>>2]=Z,Ae|0&&(d=o[5862]|0,r=Ae>>>3,l=23468+(r<<1<<2)|0,r=1<<r,r&Ie?(i=l+8|0,r=o[i>>2]|0):(o[5857]=r|Ie,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=Z,o[5862]=k),It=z+8|0,Bt=si,It|0}else Ie=Y}else Ie=Y}else Ie=Y}else if(i>>>0<=4294967231)if(i=i+11|0,Y=i&-8,d=o[5858]|0,d){y=0-Y|0,i=i>>>8,i?Y>>>0>16777215?Z=31:(Ie=(i+1048320|0)>>>16&8,tt=i<<Ie,z=(tt+520192|0)>>>16&4,tt=tt<<z,Z=(tt+245760|0)>>>16&2,Z=14-(z|Ie|Z)+(tt<<Z>>>15)|0,Z=Y>>>(Z+7|0)&1|Z<<1):Z=0,l=o[23732+(Z<<2)>>2]|0;e:do if(!l)l=0,i=0,tt=61;else for(i=0,z=Y<<((Z|0)==31?0:25-(Z>>>1)|0),I=0;;){if(k=(o[l+4>>2]&-8)-Y|0,k>>>0<y>>>0)if(k)i=l,y=k;else{i=l,y=0,tt=65;break e}if(tt=o[l+20>>2]|0,l=o[l+16+(z>>>31<<2)>>2]|0,I=(tt|0)==0|(tt|0)==(l|0)?I:tt,l)z=z<<1;else{l=I,tt=61;break}}while(!1);if((tt|0)==61){if((l|0)==0&(i|0)==0){if(i=2<<Z,i=(i|0-i)&d,!i){Ie=Y;break}Ie=(i&0-i)+-1|0,k=Ie>>>12&16,Ie=Ie>>>k,I=Ie>>>5&8,Ie=Ie>>>I,z=Ie>>>2&4,Ie=Ie>>>z,Z=Ie>>>1&2,Ie=Ie>>>Z,l=Ie>>>1&1,i=0,l=o[23732+((I|k|z|Z|l)+(Ie>>>l)<<2)>>2]|0}l?tt=65:(z=i,k=y)}if((tt|0)==65)for(I=l;;)if(Ie=(o[I+4>>2]&-8)-Y|0,l=Ie>>>0<y>>>0,y=l?Ie:y,i=l?I:i,l=o[I+16>>2]|0,l||(l=o[I+20>>2]|0),l)I=l;else{z=i,k=y;break}if(z|0&&k>>>0<((o[5859]|0)-Y|0)>>>0&&(Ae=z+Y|0,Ae>>>0>z>>>0)){I=o[z+24>>2]|0,r=o[z+12>>2]|0;do if((r|0)==(z|0)){if(i=z+20|0,r=o[i>>2]|0,!r&&(i=z+16|0,r=o[i>>2]|0,!r)){r=0;break}for(;;)if(y=r+20|0,l=o[y>>2]|0,l)r=l,i=y;else if(y=r+16|0,l=o[y>>2]|0,l)r=l,i=y;else break;o[i>>2]=0}else It=o[z+8>>2]|0,o[It+12>>2]=r,o[r+8>>2]=It;while(!1);do if(I){if(i=o[z+28>>2]|0,l=23732+(i<<2)|0,(z|0)==(o[l>>2]|0)){if(o[l>>2]=r,!r){d=d&~(1<<i),o[5858]=d;break}}else if(It=I+16|0,o[((o[It>>2]|0)==(z|0)?It:I+20|0)>>2]=r,!r)break;o[r+24>>2]=I,i=o[z+16>>2]|0,i|0&&(o[r+16>>2]=i,o[i+24>>2]=r),i=o[z+20>>2]|0,i&&(o[r+20>>2]=i,o[i+24>>2]=r)}while(!1);e:do if(k>>>0<16)It=k+Y|0,o[z+4>>2]=It|3,It=z+It+4|0,o[It>>2]=o[It>>2]|1;else{if(o[z+4>>2]=Y|3,o[Ae+4>>2]=k|1,o[Ae+k>>2]=k,r=k>>>3,k>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=Ae,o[r+12>>2]=Ae,o[Ae+8>>2]=r,o[Ae+12>>2]=l;break}if(r=k>>>8,r?k>>>0>16777215?l=31:(Tt=(r+1048320|0)>>>16&8,It=r<<Tt,ft=(It+520192|0)>>>16&4,It=It<<ft,l=(It+245760|0)>>>16&2,l=14-(ft|Tt|l)+(It<<l>>>15)|0,l=k>>>(l+7|0)&1|l<<1):l=0,r=23732+(l<<2)|0,o[Ae+28>>2]=l,i=Ae+16|0,o[i+4>>2]=0,o[i>>2]=0,i=1<<l,!(d&i)){o[5858]=d|i,o[r>>2]=Ae,o[Ae+24>>2]=r,o[Ae+12>>2]=Ae,o[Ae+8>>2]=Ae;break}r=o[r>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(k|0)){for(d=k<<((l|0)==31?0:25-(l>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(k|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=Ae,o[Ae+24>>2]=r,o[Ae+12>>2]=Ae,o[Ae+8>>2]=Ae;break e}while(!1);Tt=r+8|0,It=o[Tt>>2]|0,o[It+12>>2]=Ae,o[Tt>>2]=Ae,o[Ae+8>>2]=It,o[Ae+12>>2]=r,o[Ae+24>>2]=0}while(!1);return It=z+8|0,Bt=si,It|0}else Ie=Y}else Ie=Y;else Ie=-1;while(!1);if(l=o[5859]|0,l>>>0>=Ie>>>0)return r=l-Ie|0,i=o[5862]|0,r>>>0>15?(It=i+Ie|0,o[5862]=It,o[5859]=r,o[It+4>>2]=r|1,o[i+l>>2]=r,o[i+4>>2]=Ie|3):(o[5859]=0,o[5862]=0,o[i+4>>2]=l|3,It=i+l+4|0,o[It>>2]=o[It>>2]|1),It=i+8|0,Bt=si,It|0;if(k=o[5860]|0,k>>>0>Ie>>>0)return ft=k-Ie|0,o[5860]=ft,It=o[5863]|0,Tt=It+Ie|0,o[5863]=Tt,o[Tt+4>>2]=ft|1,o[It+4>>2]=Ie|3,It=It+8|0,Bt=si,It|0;if(o[5975]|0?i=o[5977]|0:(o[5977]=4096,o[5976]=4096,o[5978]=-1,o[5979]=-1,o[5980]=0,o[5968]=0,o[5975]=ke&-16^1431655768,i=4096),z=Ie+48|0,Z=Ie+47|0,I=i+Z|0,y=0-i|0,Y=I&y,Y>>>0<=Ie>>>0||(i=o[5967]|0,i|0&&(Ae=o[5965]|0,ke=Ae+Y|0,ke>>>0<=Ae>>>0|ke>>>0>i>>>0)))return It=0,Bt=si,It|0;e:do if(o[5968]&4)r=0,tt=143;else{l=o[5863]|0;t:do if(l){for(d=23876;ke=o[d>>2]|0,!(ke>>>0<=l>>>0&&(ke+(o[d+4>>2]|0)|0)>>>0>l>>>0);)if(i=o[d+8>>2]|0,i)d=i;else{tt=128;break t}if(r=I-k&y,r>>>0<2147483647)if(i=s(r|0)|0,(i|0)==((o[d>>2]|0)+(o[d+4>>2]|0)|0)){if((i|0)!=-1){k=r,I=i,tt=145;break e}}else d=i,tt=136;else r=0}else tt=128;while(!1);do if((tt|0)==128)if(l=s(0)|0,(l|0)!=-1&&(r=l,Fe=o[5976]|0,ze=Fe+-1|0,r=(ze&r|0?(ze+r&0-Fe)-r|0:0)+Y|0,Fe=o[5965]|0,ze=r+Fe|0,r>>>0>Ie>>>0&r>>>0<2147483647)){if(ke=o[5967]|0,ke|0&&ze>>>0<=Fe>>>0|ze>>>0>ke>>>0){r=0;break}if(i=s(r|0)|0,(i|0)==(l|0)){k=r,I=l,tt=145;break e}else d=i,tt=136}else r=0;while(!1);do if((tt|0)==136){if(l=0-r|0,!(z>>>0>r>>>0&(r>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){r=0;break}else{k=r,I=d,tt=145;break e}if(i=o[5977]|0,i=Z-r+i&0-i,i>>>0>=2147483647){k=r,I=d,tt=145;break e}if((s(i|0)|0)==-1){s(l|0)|0,r=0;break}else{k=i+r|0,I=d,tt=145;break e}}while(!1);o[5968]=o[5968]|4,tt=143}while(!1);if((tt|0)==143&&Y>>>0<2147483647&&(ft=s(Y|0)|0,ze=s(0)|0,wt=ze-ft|0,lt=wt>>>0>(Ie+40|0)>>>0,!((ft|0)==-1|lt^1|ft>>>0<ze>>>0&((ft|0)!=-1&(ze|0)!=-1)^1))&&(k=lt?wt:r,I=ft,tt=145),(tt|0)==145){r=(o[5965]|0)+k|0,o[5965]=r,r>>>0>(o[5966]|0)>>>0&&(o[5966]=r),Z=o[5863]|0;e:do if(Z){for(r=23876;;){if(i=o[r>>2]|0,l=o[r+4>>2]|0,(I|0)==(i+l|0)){tt=154;break}if(d=o[r+8>>2]|0,d)r=d;else break}if((tt|0)==154&&(Tt=r+4|0,(o[r+12>>2]&8|0)==0)&&I>>>0>Z>>>0&i>>>0<=Z>>>0){o[Tt>>2]=l+k,It=(o[5860]|0)+k|0,ft=Z+8|0,ft=ft&7|0?0-ft&7:0,Tt=Z+ft|0,ft=It-ft|0,o[5863]=Tt,o[5860]=ft,o[Tt+4>>2]=ft|1,o[Z+It+4>>2]=40,o[5864]=o[5979];break}for(I>>>0<(o[5861]|0)>>>0&&(o[5861]=I),l=I+k|0,r=23876;;){if((o[r>>2]|0)==(l|0)){tt=162;break}if(i=o[r+8>>2]|0,i)r=i;else break}if((tt|0)==162&&!(o[r+12>>2]&8|0)){o[r>>2]=I,Ae=r+4|0,o[Ae>>2]=(o[Ae>>2]|0)+k,Ae=I+8|0,Ae=I+(Ae&7|0?0-Ae&7:0)|0,r=l+8|0,r=l+(r&7|0?0-r&7:0)|0,Y=Ae+Ie|0,z=r-Ae-Ie|0,o[Ae+4>>2]=Ie|3;t:do if((Z|0)==(r|0))It=(o[5860]|0)+z|0,o[5860]=It,o[5863]=Y,o[Y+4>>2]=It|1;else{if((o[5862]|0)==(r|0)){It=(o[5859]|0)+z|0,o[5859]=It,o[5862]=Y,o[Y+4>>2]=It|1,o[Y+It>>2]=It;break}if(i=o[r+4>>2]|0,(i&3|0)==1){k=i&-8,d=i>>>3;i:do if(i>>>0<256)if(i=o[r+8>>2]|0,l=o[r+12>>2]|0,(l|0)==(i|0)){o[5857]=o[5857]&~(1<<d);break}else{o[i+12>>2]=l,o[l+8>>2]=i;break}else{I=o[r+24>>2]|0,i=o[r+12>>2]|0;do if((i|0)==(r|0)){if(l=r+16|0,d=l+4|0,i=o[d>>2]|0,i)l=d;else if(i=o[l>>2]|0,!i){i=0;break}for(;;)if(y=i+20|0,d=o[y>>2]|0,d)i=d,l=y;else if(y=i+16|0,d=o[y>>2]|0,d)i=d,l=y;else break;o[l>>2]=0}else It=o[r+8>>2]|0,o[It+12>>2]=i,o[i+8>>2]=It;while(!1);if(!I)break;l=o[r+28>>2]|0,d=23732+(l<<2)|0;do if((o[d>>2]|0)!=(r|0)){if(It=I+16|0,o[((o[It>>2]|0)==(r|0)?It:I+20|0)>>2]=i,!i)break i}else{if(o[d>>2]=i,i|0)break;o[5858]=o[5858]&~(1<<l);break i}while(!1);if(o[i+24>>2]=I,l=r+16|0,d=o[l>>2]|0,d|0&&(o[i+16>>2]=d,o[d+24>>2]=i),l=o[l+4>>2]|0,!l)break;o[i+20>>2]=l,o[l+24>>2]=i}while(!1);r=r+k|0,y=k+z|0}else y=z;if(r=r+4|0,o[r>>2]=o[r>>2]&-2,o[Y+4>>2]=y|1,o[Y+y>>2]=y,r=y>>>3,y>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=Y,o[r+12>>2]=Y,o[Y+8>>2]=r,o[Y+12>>2]=l;break}r=y>>>8;do if(!r)d=0;else{if(y>>>0>16777215){d=31;break}Tt=(r+1048320|0)>>>16&8,It=r<<Tt,ft=(It+520192|0)>>>16&4,It=It<<ft,d=(It+245760|0)>>>16&2,d=14-(ft|Tt|d)+(It<<d>>>15)|0,d=y>>>(d+7|0)&1|d<<1}while(!1);if(r=23732+(d<<2)|0,o[Y+28>>2]=d,i=Y+16|0,o[i+4>>2]=0,o[i>>2]=0,i=o[5858]|0,l=1<<d,!(i&l)){o[5858]=i|l,o[r>>2]=Y,o[Y+24>>2]=r,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break}r=o[r>>2]|0;i:do if((o[r+4>>2]&-8|0)!=(y|0)){for(d=y<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(y|0)){r=i;break i}else d=d<<1,r=i;o[l>>2]=Y,o[Y+24>>2]=r,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break t}while(!1);Tt=r+8|0,It=o[Tt>>2]|0,o[It+12>>2]=Y,o[Tt>>2]=Y,o[Y+8>>2]=It,o[Y+12>>2]=r,o[Y+24>>2]=0}while(!1);return It=Ae+8|0,Bt=si,It|0}for(r=23876;i=o[r>>2]|0,!(i>>>0<=Z>>>0&&(It=i+(o[r+4>>2]|0)|0,It>>>0>Z>>>0));)r=o[r+8>>2]|0;y=It+-47|0,i=y+8|0,i=y+(i&7|0?0-i&7:0)|0,y=Z+16|0,i=i>>>0<y>>>0?Z:i,r=i+8|0,l=k+-40|0,ft=I+8|0,ft=ft&7|0?0-ft&7:0,Tt=I+ft|0,ft=l-ft|0,o[5863]=Tt,o[5860]=ft,o[Tt+4>>2]=ft|1,o[I+l+4>>2]=40,o[5864]=o[5979],l=i+4|0,o[l>>2]=27,o[r>>2]=o[5969],o[r+4>>2]=o[5970],o[r+8>>2]=o[5971],o[r+12>>2]=o[5972],o[5969]=I,o[5970]=k,o[5972]=0,o[5971]=r,r=i+24|0;do Tt=r,r=r+4|0,o[r>>2]=7;while((Tt+8|0)>>>0<It>>>0);if((i|0)!=(Z|0)){if(I=i-Z|0,o[l>>2]=o[l>>2]&-2,o[Z+4>>2]=I|1,o[i>>2]=I,r=I>>>3,I>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=Z,o[r+12>>2]=Z,o[Z+8>>2]=r,o[Z+12>>2]=l;break}if(r=I>>>8,r?I>>>0>16777215?d=31:(Tt=(r+1048320|0)>>>16&8,It=r<<Tt,ft=(It+520192|0)>>>16&4,It=It<<ft,d=(It+245760|0)>>>16&2,d=14-(ft|Tt|d)+(It<<d>>>15)|0,d=I>>>(d+7|0)&1|d<<1):d=0,l=23732+(d<<2)|0,o[Z+28>>2]=d,o[Z+20>>2]=0,o[y>>2]=0,r=o[5858]|0,i=1<<d,!(r&i)){o[5858]=r|i,o[l>>2]=Z,o[Z+24>>2]=l,o[Z+12>>2]=Z,o[Z+8>>2]=Z;break}r=o[l>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(I|0)){for(d=I<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(I|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=Z,o[Z+24>>2]=r,o[Z+12>>2]=Z,o[Z+8>>2]=Z;break e}while(!1);Tt=r+8|0,It=o[Tt>>2]|0,o[It+12>>2]=Z,o[Tt>>2]=Z,o[Z+8>>2]=It,o[Z+12>>2]=r,o[Z+24>>2]=0}}else It=o[5861]|0,(It|0)==0|I>>>0<It>>>0&&(o[5861]=I),o[5969]=I,o[5970]=k,o[5972]=0,o[5866]=o[5975],o[5865]=-1,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,o[5906]=23612,o[5905]=23612,o[5908]=23620,o[5907]=23620,o[5910]=23628,o[5909]=23628,o[5912]=23636,o[5911]=23636,o[5914]=23644,o[5913]=23644,o[5916]=23652,o[5915]=23652,o[5918]=23660,o[5917]=23660,o[5920]=23668,o[5919]=23668,o[5922]=23676,o[5921]=23676,o[5924]=23684,o[5923]=23684,o[5926]=23692,o[5925]=23692,o[5928]=23700,o[5927]=23700,o[5930]=23708,o[5929]=23708,o[5932]=23716,o[5931]=23716,It=k+-40|0,ft=I+8|0,ft=ft&7|0?0-ft&7:0,Tt=I+ft|0,ft=It-ft|0,o[5863]=Tt,o[5860]=ft,o[Tt+4>>2]=ft|1,o[I+It+4>>2]=40,o[5864]=o[5979];while(!1);if(r=o[5860]|0,r>>>0>Ie>>>0)return ft=r-Ie|0,o[5860]=ft,It=o[5863]|0,Tt=It+Ie|0,o[5863]=Tt,o[Tt+4>>2]=ft|1,o[It+4>>2]=Ie|3,It=It+8|0,Bt=si,It|0}return It=Uo()|0,o[It>>2]=12,It=0,Bt=si,It|0}function T(i){i=i|0;var r=0,l=0,d=0,y=0,I=0,k=0,z=0,Z=0;if(i){l=i+-8|0,y=o[5861]|0,i=o[i+-4>>2]|0,r=i&-8,Z=l+r|0;do if(i&1)z=l,k=l;else{if(d=o[l>>2]|0,!(i&3)||(k=l+(0-d)|0,I=d+r|0,k>>>0<y>>>0))return;if((o[5862]|0)==(k|0)){if(i=Z+4|0,r=o[i>>2]|0,(r&3|0)!=3){z=k,r=I;break}o[5859]=I,o[i>>2]=r&-2,o[k+4>>2]=I|1,o[k+I>>2]=I;return}if(l=d>>>3,d>>>0<256)if(i=o[k+8>>2]|0,r=o[k+12>>2]|0,(r|0)==(i|0)){o[5857]=o[5857]&~(1<<l),z=k,r=I;break}else{o[i+12>>2]=r,o[r+8>>2]=i,z=k,r=I;break}y=o[k+24>>2]|0,i=o[k+12>>2]|0;do if((i|0)==(k|0)){if(r=k+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){i=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0}else z=o[k+8>>2]|0,o[z+12>>2]=i,o[i+8>>2]=z;while(!1);if(y){if(r=o[k+28>>2]|0,l=23732+(r<<2)|0,(o[l>>2]|0)==(k|0)){if(o[l>>2]=i,!i){o[5858]=o[5858]&~(1<<r),z=k,r=I;break}}else if(z=y+16|0,o[((o[z>>2]|0)==(k|0)?z:y+20|0)>>2]=i,!i){z=k,r=I;break}o[i+24>>2]=y,r=k+16|0,l=o[r>>2]|0,l|0&&(o[i+16>>2]=l,o[l+24>>2]=i),r=o[r+4>>2]|0,r?(o[i+20>>2]=r,o[r+24>>2]=i,z=k,r=I):(z=k,r=I)}else z=k,r=I}while(!1);if(!(k>>>0>=Z>>>0)&&(i=Z+4|0,d=o[i>>2]|0,!!(d&1))){if(d&2)o[i>>2]=d&-2,o[z+4>>2]=r|1,o[k+r>>2]=r,y=r;else{if((o[5863]|0)==(Z|0)){if(Z=(o[5860]|0)+r|0,o[5860]=Z,o[5863]=z,o[z+4>>2]=Z|1,(z|0)!=(o[5862]|0))return;o[5862]=0,o[5859]=0;return}if((o[5862]|0)==(Z|0)){Z=(o[5859]|0)+r|0,o[5859]=Z,o[5862]=k,o[z+4>>2]=Z|1,o[k+Z>>2]=Z;return}y=(d&-8)+r|0,l=d>>>3;do if(d>>>0<256)if(r=o[Z+8>>2]|0,i=o[Z+12>>2]|0,(i|0)==(r|0)){o[5857]=o[5857]&~(1<<l);break}else{o[r+12>>2]=i,o[i+8>>2]=r;break}else{I=o[Z+24>>2]|0,i=o[Z+12>>2]|0;do if((i|0)==(Z|0)){if(r=Z+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){l=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0,l=i}else l=o[Z+8>>2]|0,o[l+12>>2]=i,o[i+8>>2]=l,l=i;while(!1);if(I|0){if(i=o[Z+28>>2]|0,r=23732+(i<<2)|0,(o[r>>2]|0)==(Z|0)){if(o[r>>2]=l,!l){o[5858]=o[5858]&~(1<<i);break}}else if(d=I+16|0,o[((o[d>>2]|0)==(Z|0)?d:I+20|0)>>2]=l,!l)break;o[l+24>>2]=I,i=Z+16|0,r=o[i>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),i=o[i+4>>2]|0,i|0&&(o[l+20>>2]=i,o[i+24>>2]=l)}}while(!1);if(o[z+4>>2]=y|1,o[k+y>>2]=y,(z|0)==(o[5862]|0)){o[5859]=y;return}}if(i=y>>>3,y>>>0<256){l=23468+(i<<1<<2)|0,r=o[5857]|0,i=1<<i,r&i?(r=l+8|0,i=o[r>>2]|0):(o[5857]=r|i,i=l,r=l+8|0),o[r>>2]=z,o[i+12>>2]=z,o[z+8>>2]=i,o[z+12>>2]=l;return}i=y>>>8,i?y>>>0>16777215?d=31:(k=(i+1048320|0)>>>16&8,Z=i<<k,I=(Z+520192|0)>>>16&4,Z=Z<<I,d=(Z+245760|0)>>>16&2,d=14-(I|k|d)+(Z<<d>>>15)|0,d=y>>>(d+7|0)&1|d<<1):d=0,i=23732+(d<<2)|0,o[z+28>>2]=d,o[z+20>>2]=0,o[z+16>>2]=0,r=o[5858]|0,l=1<<d;e:do if(!(r&l))o[5858]=r|l,o[i>>2]=z,o[z+24>>2]=i,o[z+12>>2]=z,o[z+8>>2]=z;else{i=o[i>>2]|0;t:do if((o[i+4>>2]&-8|0)!=(y|0)){for(d=y<<((d|0)==31?0:25-(d>>>1)|0);l=i+16+(d>>>31<<2)|0,r=o[l>>2]|0,!!r;)if((o[r+4>>2]&-8|0)==(y|0)){i=r;break t}else d=d<<1,i=r;o[l>>2]=z,o[z+24>>2]=i,o[z+12>>2]=z,o[z+8>>2]=z;break e}while(!1);k=i+8|0,Z=o[k>>2]|0,o[Z+12>>2]=z,o[k>>2]=z,o[z+8>>2]=Z,o[z+12>>2]=i,o[z+24>>2]=0}while(!1);if(Z=(o[5865]|0)+-1|0,o[5865]=Z,!(Z|0)){for(i=23884;i=o[i>>2]|0,i;)i=i+8|0;o[5865]=-1}}}}function L(i,r){i=i|0,r=r|0;var l=0;return i?(l=Qi(r,i)|0,(r|i)>>>0>65535&&(l=((l>>>0)/(i>>>0)|0|0)==(r|0)?l:-1)):l=0,i=zs(l)|0,!i||!(o[i+-4>>2]&3)||V(i|0,0,l|0)|0,i|0}function R(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,l=i+l>>>0,en(r+d+(l>>>0<i>>>0|0)>>>0|0),l|0|0}function F(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,d=r-d-(l>>>0>i>>>0|0)>>>0,en(d|0),i-l>>>0|0|0}function te(i){return i=i|0,(i?31-(Xt(i^i-1)|0)|0:32)|0}function ue(i,r,l,d,y){i=i|0,r=r|0,l=l|0,d=d|0,y=y|0;var I=0,k=0,z=0,Z=0,Y=0,Ae=0,Ie=0,ke=0,Fe=0,ze=0;if(Ae=i,Z=r,Y=Z,k=l,ke=d,z=ke,!Y)return I=(y|0)!=0,z?I?(o[y>>2]=i|0,o[y+4>>2]=r&0,ke=0,y=0,en(ke|0),y|0):(ke=0,y=0,en(ke|0),y|0):(I&&(o[y>>2]=(Ae>>>0)%(k>>>0),o[y+4>>2]=0),ke=0,y=(Ae>>>0)/(k>>>0)>>>0,en(ke|0),y|0);I=(z|0)==0;do if(k){if(!I){if(I=(Xt(z|0)|0)-(Xt(Y|0)|0)|0,I>>>0<=31){Ie=I+1|0,z=31-I|0,r=I-31>>31,k=Ie,i=Ae>>>(Ie>>>0)&r|Y<<z,r=Y>>>(Ie>>>0)&r,I=0,z=Ae<<z;break}return y?(o[y>>2]=i|0,o[y+4>>2]=Z|r&0,ke=0,y=0,en(ke|0),y|0):(ke=0,y=0,en(ke|0),y|0)}if(I=k-1|0,I&k|0){z=(Xt(k|0)|0)+33-(Xt(Y|0)|0)|0,ze=64-z|0,Ie=32-z|0,Z=Ie>>31,Fe=z-32|0,r=Fe>>31,k=z,i=Ie-1>>31&Y>>>(Fe>>>0)|(Y<<Ie|Ae>>>(z>>>0))&r,r=r&Y>>>(z>>>0),I=Ae<<ze&Z,z=(Y<<ze|Ae>>>(Fe>>>0))&Z|Ae<<Ie&z-33>>31;break}return y|0&&(o[y>>2]=I&Ae,o[y+4>>2]=0),(k|0)==1?(Fe=Z|r&0,ze=i|0|0,en(Fe|0),ze|0):(ze=te(k|0)|0,Fe=Y>>>(ze>>>0)|0,ze=Y<<32-ze|Ae>>>(ze>>>0)|0,en(Fe|0),ze|0)}else{if(I)return y|0&&(o[y>>2]=(Y>>>0)%(k>>>0),o[y+4>>2]=0),Fe=0,ze=(Y>>>0)/(k>>>0)>>>0,en(Fe|0),ze|0;if(!Ae)return y|0&&(o[y>>2]=0,o[y+4>>2]=(Y>>>0)%(z>>>0)),Fe=0,ze=(Y>>>0)/(z>>>0)>>>0,en(Fe|0),ze|0;if(I=z-1|0,!(I&z))return y|0&&(o[y>>2]=i|0,o[y+4>>2]=I&Y|r&0),Fe=0,ze=Y>>>((te(z|0)|0)>>>0),en(Fe|0),ze|0;if(I=(Xt(z|0)|0)-(Xt(Y|0)|0)|0,I>>>0<=30){r=I+1|0,z=31-I|0,k=r,i=Y<<z|Ae>>>(r>>>0),r=Y>>>(r>>>0),I=0,z=Ae<<z;break}return y?(o[y>>2]=i|0,o[y+4>>2]=Z|r&0,Fe=0,ze=0,en(Fe|0),ze|0):(Fe=0,ze=0,en(Fe|0),ze|0)}while(!1);if(!k)Y=z,Z=0,z=0;else{Ie=l|0|0,Ae=ke|d&0,Y=R(Ie|0,Ae|0,-1,-1)|0,l=qt()|0,Z=z,z=0;do d=Z,Z=I>>>31|Z<<1,I=z|I<<1,d=i<<1|d>>>31|0,ke=i>>>31|r<<1|0,F(Y|0,l|0,d|0,ke|0)|0,ze=qt()|0,Fe=ze>>31|((ze|0)<0?-1:0)<<1,z=Fe&1,i=F(d|0,ke|0,Fe&Ie|0,(((ze|0)<0?-1:0)>>31|((ze|0)<0?-1:0)<<1)&Ae|0)|0,r=qt()|0,k=k-1|0;while(k|0);Y=Z,Z=0}return k=0,y|0&&(o[y>>2]=i,o[y+4>>2]=r),Fe=(I|0)>>>31|(Y|k)<<1|(k<<1|I>>>31)&0|Z,ze=(I<<1|0)&-2|z,en(Fe|0),ze|0}function le(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0;return Y=r>>31|((r|0)<0?-1:0)<<1,Z=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,I=d>>31|((d|0)<0?-1:0)<<1,y=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,z=F(Y^i|0,Z^r|0,Y|0,Z|0)|0,k=qt()|0,i=I^Y,r=y^Z,F((ue(z,k,F(I^l|0,y^d|0,I|0,y|0)|0,qt()|0,0)|0)^i|0,(qt()|0)^r|0,i|0,r|0)|0}function Se(i,r){i=i|0,r=r|0;var l=0,d=0,y=0,I=0;return I=i&65535,y=r&65535,l=Qi(y,I)|0,d=i>>>16,i=(l>>>16)+(Qi(y,d)|0)|0,y=r>>>16,r=Qi(y,I)|0,en((i>>>16)+(Qi(y,d)|0)+(((i&65535)+r|0)>>>16)|0),i+r<<16|l&65535|0|0}function Xe(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0;return y=i,I=l,l=Se(y,I)|0,i=qt()|0,en((Qi(r,I)|0)+(Qi(d,y)|0)+i|i&0|0),l|0|0|0}function bt(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0,k=0,z=0,Z=0,Y=0;return y=Bt,Bt=Bt+16|0,z=y|0,k=r>>31|((r|0)<0?-1:0)<<1,I=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,Y=d>>31|((d|0)<0?-1:0)<<1,Z=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,i=F(k^i|0,I^r|0,k|0,I|0)|0,r=qt()|0,ue(i,r,F(Y^l|0,Z^d|0,Y|0,Z|0)|0,qt()|0,z)|0,d=F(o[z>>2]^k|0,o[z+4>>2]^I|0,k|0,I|0)|0,l=qt()|0,Bt=y,en(l|0),d|0}function kt(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var y=0,I=0;return I=Bt,Bt=Bt+16|0,y=I|0,ue(i,r,l,d,y)|0,Bt=I,en(o[y+4>>2]|0),o[y>>2]|0|0}function ri(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(en(r>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(en(((r|0)<0?-1:0)|0),r>>l-32|0)}function Ht(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(en(r>>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(en(0),r>>>l-32|0)}function Qt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(en(r<<l|(i&(1<<l)-1<<32-l)>>>32-l|0),i<<l):(en(i<<l-32|0),0)}function Q(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+Gn(+i,+r)}function A(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+hr(+i,+r)}function C(i){return i=+i,i>=0?+fi(i+.5):+Yr(i-.5)}function O(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0;if((l|0)>=8192)return Qr(i|0,r|0,l|0)|0,i|0;if(I=i|0,y=i+l|0,(i&3)==(r&3)){for(;i&3;){if(!l)return I|0;Pt[i>>0]=Pt[r>>0]|0,i=i+1|0,r=r+1|0,l=l-1|0}for(l=y&-4|0,d=l-64|0;(i|0)<=(d|0);)o[i>>2]=o[r>>2],o[i+4>>2]=o[r+4>>2],o[i+8>>2]=o[r+8>>2],o[i+12>>2]=o[r+12>>2],o[i+16>>2]=o[r+16>>2],o[i+20>>2]=o[r+20>>2],o[i+24>>2]=o[r+24>>2],o[i+28>>2]=o[r+28>>2],o[i+32>>2]=o[r+32>>2],o[i+36>>2]=o[r+36>>2],o[i+40>>2]=o[r+40>>2],o[i+44>>2]=o[r+44>>2],o[i+48>>2]=o[r+48>>2],o[i+52>>2]=o[r+52>>2],o[i+56>>2]=o[r+56>>2],o[i+60>>2]=o[r+60>>2],i=i+64|0,r=r+64|0;for(;(i|0)<(l|0);)o[i>>2]=o[r>>2],i=i+4|0,r=r+4|0}else for(l=y-4|0;(i|0)<(l|0);)Pt[i>>0]=Pt[r>>0]|0,Pt[i+1>>0]=Pt[r+1>>0]|0,Pt[i+2>>0]=Pt[r+2>>0]|0,Pt[i+3>>0]=Pt[r+3>>0]|0,i=i+4|0,r=r+4|0;for(;(i|0)<(y|0);)Pt[i>>0]=Pt[r>>0]|0,i=i+1|0,r=r+1|0;return I|0}function V(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,y=0,I=0,k=0;if(I=i+l|0,r=r&255,(l|0)>=67){for(;i&3;)Pt[i>>0]=r,i=i+1|0;for(d=I&-4|0,k=r|r<<8|r<<16|r<<24,y=d-64|0;(i|0)<=(y|0);)o[i>>2]=k,o[i+4>>2]=k,o[i+8>>2]=k,o[i+12>>2]=k,o[i+16>>2]=k,o[i+20>>2]=k,o[i+24>>2]=k,o[i+28>>2]=k,o[i+32>>2]=k,o[i+36>>2]=k,o[i+40>>2]=k,o[i+44>>2]=k,o[i+48>>2]=k,o[i+52>>2]=k,o[i+56>>2]=k,o[i+60>>2]=k,i=i+64|0;for(;(i|0)<(d|0);)o[i>>2]=k,i=i+4|0}for(;(i|0)<(I|0);)Pt[i>>0]=r,i=i+1|0;return I-l|0}function x(i){return i=+i,i>=0?+fi(i+.5):+Yr(i-.5)}function s(i){i=i|0;var r=0,l=0,d=0;return d=js()|0,l=o[di>>2]|0,r=l+i|0,(i|0)>0&(r|0)<(l|0)|(r|0)<0?(fr(r|0)|0,Ar(12),-1):(r|0)>(d|0)&&!(Gt(r|0)|0)?(Ar(12),-1):(o[di>>2]=r,l|0)}return{___divdi3:le,___muldi3:Xe,___remdi3:bt,___uremdi3:kt,_areNeighborCells:No,_bitshift64Ashr:ri,_bitshift64Lshr:Ht,_bitshift64Shl:Qt,_calloc:L,_cellAreaKm2:Bs,_cellAreaM2:_s,_cellAreaRads2:$s,_cellToBoundary:Hr,_cellToCenterChild:is,_cellToChildPos:Oa,_cellToChildren:ar,_cellToChildrenSize:Ls,_cellToLatLng:vr,_cellToLocalIj:Vo,_cellToParent:Kr,_cellToVertex:ir,_cellToVertexes:il,_cellsToDirectedEdge:$o,_cellsToLinkedMultiPolygon:we,_childPosToCell:no,_compactCells:Do,_destroyLinkedMultiPolygon:wo,_directedEdgeToBoundary:Ta,_directedEdgeToCells:Yo,_edgeLengthKm:bo,_edgeLengthM:cs,_edgeLengthRads:ro,_emscripten_replace_memory:Gr,_free:T,_getBaseCellNumber:Ul,_getDirectedEdgeDestination:Qs,_getDirectedEdgeOrigin:Mo,_getHexagonAreaAvgKm2:wi,_getHexagonAreaAvgM2:Ui,_getHexagonEdgeLengthAvgKm:On,_getHexagonEdgeLengthAvgM:jn,_getIcosahedronFaces:xo,_getNumCells:cr,_getPentagons:Ma,_getRes0Cells:Xa,_getResolution:qn,_greatCircleDistanceKm:qi,_greatCircleDistanceM:Di,_greatCircleDistanceRads:mi,_gridDisk:Qa,_gridDiskDistances:ia,_gridDistance:Cn,_gridPathCells:Tn,_gridPathCellsSize:Yl,_gridRingUnsafe:ol,_i64Add:R,_i64Subtract:F,_isPentagon:Br,_isResClassIII:gs,_isValidCell:as,_isValidDirectedEdge:Xo,_isValidVertex:fa,_latLngToCell:io,_llvm_maxnum_f64:Q,_llvm_minnum_f64:A,_llvm_round_f64:C,_localIjToCell:Gl,_malloc:zs,_maxFaceCount:ga,_maxGridDiskSize:Oo,_maxPolygonToCellsSize:ll,_memcpy:O,_memset:V,_originToDirectedEdges:Ko,_pentagonCount:aa,_polygonToCells:$a,_readInt64AsDoubleFromPointer:xu,_res0CellCount:qr,_round:x,_sbrk:s,_sizeOfCellBoundary:Ku,_sizeOfCoordIJ:tl,_sizeOfGeoLoop:Kl,_sizeOfGeoPolygon:ys,_sizeOfH3Index:oa,_sizeOfLatLng:uc,_sizeOfLinkedGeoPolygon:wa,_uncompactCells:cl,_uncompactCellsSize:Jr,_vertexToLatLng:Pu,establishStackSpace:Za,stackAlloc:Zs,stackRestore:Fr,stackSave:pa}}(ot,Pe,yt);e.___divdi3=ae.___divdi3,e.___muldi3=ae.___muldi3,e.___remdi3=ae.___remdi3,e.___uremdi3=ae.___uremdi3,e._areNeighborCells=ae._areNeighborCells,e._bitshift64Ashr=ae._bitshift64Ashr,e._bitshift64Lshr=ae._bitshift64Lshr,e._bitshift64Shl=ae._bitshift64Shl,e._calloc=ae._calloc,e._cellAreaKm2=ae._cellAreaKm2,e._cellAreaM2=ae._cellAreaM2,e._cellAreaRads2=ae._cellAreaRads2,e._cellToBoundary=ae._cellToBoundary,e._cellToCenterChild=ae._cellToCenterChild,e._cellToChildPos=ae._cellToChildPos,e._cellToChildren=ae._cellToChildren,e._cellToChildrenSize=ae._cellToChildrenSize,e._cellToLatLng=ae._cellToLatLng,e._cellToLocalIj=ae._cellToLocalIj,e._cellToParent=ae._cellToParent,e._cellToVertex=ae._cellToVertex,e._cellToVertexes=ae._cellToVertexes,e._cellsToDirectedEdge=ae._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=ae._cellsToLinkedMultiPolygon,e._childPosToCell=ae._childPosToCell,e._compactCells=ae._compactCells,e._destroyLinkedMultiPolygon=ae._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=ae._directedEdgeToBoundary,e._directedEdgeToCells=ae._directedEdgeToCells,e._edgeLengthKm=ae._edgeLengthKm,e._edgeLengthM=ae._edgeLengthM,e._edgeLengthRads=ae._edgeLengthRads;var re=e._emscripten_replace_memory=ae._emscripten_replace_memory;e._free=ae._free,e._getBaseCellNumber=ae._getBaseCellNumber,e._getDirectedEdgeDestination=ae._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=ae._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=ae._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=ae._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=ae._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=ae._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=ae._getIcosahedronFaces,e._getNumCells=ae._getNumCells,e._getPentagons=ae._getPentagons,e._getRes0Cells=ae._getRes0Cells,e._getResolution=ae._getResolution,e._greatCircleDistanceKm=ae._greatCircleDistanceKm,e._greatCircleDistanceM=ae._greatCircleDistanceM,e._greatCircleDistanceRads=ae._greatCircleDistanceRads,e._gridDisk=ae._gridDisk,e._gridDiskDistances=ae._gridDiskDistances,e._gridDistance=ae._gridDistance,e._gridPathCells=ae._gridPathCells,e._gridPathCellsSize=ae._gridPathCellsSize,e._gridRingUnsafe=ae._gridRingUnsafe,e._i64Add=ae._i64Add,e._i64Subtract=ae._i64Subtract,e._isPentagon=ae._isPentagon,e._isResClassIII=ae._isResClassIII,e._isValidCell=ae._isValidCell,e._isValidDirectedEdge=ae._isValidDirectedEdge,e._isValidVertex=ae._isValidVertex,e._latLngToCell=ae._latLngToCell,e._llvm_maxnum_f64=ae._llvm_maxnum_f64,e._llvm_minnum_f64=ae._llvm_minnum_f64,e._llvm_round_f64=ae._llvm_round_f64,e._localIjToCell=ae._localIjToCell,e._malloc=ae._malloc,e._maxFaceCount=ae._maxFaceCount,e._maxGridDiskSize=ae._maxGridDiskSize,e._maxPolygonToCellsSize=ae._maxPolygonToCellsSize,e._memcpy=ae._memcpy,e._memset=ae._memset,e._originToDirectedEdges=ae._originToDirectedEdges,e._pentagonCount=ae._pentagonCount,e._polygonToCells=ae._polygonToCells,e._readInt64AsDoubleFromPointer=ae._readInt64AsDoubleFromPointer,e._res0CellCount=ae._res0CellCount,e._round=ae._round,e._sbrk=ae._sbrk,e._sizeOfCellBoundary=ae._sizeOfCellBoundary,e._sizeOfCoordIJ=ae._sizeOfCoordIJ,e._sizeOfGeoLoop=ae._sizeOfGeoLoop,e._sizeOfGeoPolygon=ae._sizeOfGeoPolygon,e._sizeOfH3Index=ae._sizeOfH3Index,e._sizeOfLatLng=ae._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=ae._sizeOfLinkedGeoPolygon,e._uncompactCells=ae._uncompactCells,e._uncompactCellsSize=ae._uncompactCellsSize,e._vertexToLatLng=ae._vertexToLatLng,e.establishStackSpace=ae.establishStackSpace;var X=e.stackAlloc=ae.stackAlloc,ne=e.stackRestore=ae.stackRestore,pe=e.stackSave=ae.stackSave;if(e.asm=ae,e.cwrap=xt,e.setValue=_e,e.getValue=Ze,Yi){zn(Yi)||(Yi=v(Yi));{$n();var xe=function(Le){Le.byteLength&&(Le=new Uint8Array(Le)),ut.set(Le,ce),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,oi()},ye=function(){S(Yi,xe,function(){throw"could not load memory initializer "+Yi})},De=mt(Yi);if(De)xe(De.buffer);else if(e.memoryInitializerRequest){var Oe=function(){var Le=e.memoryInitializerRequest,qe=Le.response;if(Le.status!==200&&Le.status!==0){var dt=mt(e.memoryInitializerRequestURL);if(dt)qe=dt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Le.status+", retrying "+Yi),ye();return}}xe(qe)};e.memoryInitializerRequest.response?setTimeout(Oe,0):e.memoryInitializerRequest.addEventListener("load",Oe)}else ye()}}var Ve;an=function Le(){Ve||Je(),Ve||(an=Le)};function Je(Le){if(Ot>0||(sn(),Ot>0))return;function qe(){Ve||(Ve=!0,!nt&&(xn(),Ti(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),gi()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),qe()},1)):qe()}e.run=Je;function et(Le){throw e.onAbort&&e.onAbort(Le),Le+="",a(Le),N(Le),nt=!0,"abort("+Le+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=et,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Je(),t}(typeof La=="object"?La:{}),Ms="number",rs=Ms,ag=Ms,As=Ms,fs=Ms,nc=Ms,mr=Ms,kV=[["sizeOfH3Index",Ms],["sizeOfLatLng",Ms],["sizeOfCellBoundary",Ms],["sizeOfGeoLoop",Ms],["sizeOfGeoPolygon",Ms],["sizeOfLinkedGeoPolygon",Ms],["sizeOfCoordIJ",Ms],["readInt64AsDoubleFromPointer",Ms],["isValidCell",ag,[As,fs]],["latLngToCell",rs,[Ms,Ms,nc,mr]],["cellToLatLng",rs,[As,fs,mr]],["cellToBoundary",rs,[As,fs,mr]],["maxGridDiskSize",rs,[Ms,mr]],["gridDisk",rs,[As,fs,Ms,mr]],["gridDiskDistances",rs,[As,fs,Ms,mr,mr]],["gridRingUnsafe",rs,[As,fs,Ms,mr]],["maxPolygonToCellsSize",rs,[mr,nc,Ms,mr]],["polygonToCells",rs,[mr,nc,Ms,mr]],["cellsToLinkedMultiPolygon",rs,[mr,Ms,mr]],["destroyLinkedMultiPolygon",null,[mr]],["compactCells",rs,[mr,mr,Ms,Ms]],["uncompactCells",rs,[mr,Ms,Ms,mr,Ms,nc]],["uncompactCellsSize",rs,[mr,Ms,Ms,nc,mr]],["isPentagon",ag,[As,fs]],["isResClassIII",ag,[As,fs]],["getBaseCellNumber",Ms,[As,fs]],["getResolution",Ms,[As,fs]],["maxFaceCount",rs,[As,fs,mr]],["getIcosahedronFaces",rs,[As,fs,mr]],["cellToParent",rs,[As,fs,nc,mr]],["cellToChildren",rs,[As,fs,nc,mr]],["cellToCenterChild",rs,[As,fs,nc,mr]],["cellToChildrenSize",rs,[As,fs,nc,mr]],["cellToChildPos",rs,[As,fs,nc,mr]],["childPosToCell",rs,[Ms,Ms,As,fs,nc,mr]],["areNeighborCells",rs,[As,fs,As,fs,mr]],["cellsToDirectedEdge",rs,[As,fs,As,fs,mr]],["getDirectedEdgeOrigin",rs,[As,fs,mr]],["getDirectedEdgeDestination",rs,[As,fs,mr]],["isValidDirectedEdge",ag,[As,fs]],["directedEdgeToCells",rs,[As,fs,mr]],["originToDirectedEdges",rs,[As,fs,mr]],["directedEdgeToBoundary",rs,[As,fs,mr]],["gridDistance",rs,[As,fs,As,fs,mr]],["gridPathCells",rs,[As,fs,As,fs,mr]],["gridPathCellsSize",rs,[As,fs,As,fs,mr]],["cellToLocalIj",rs,[As,fs,As,fs,Ms,mr]],["localIjToCell",rs,[As,fs,mr,Ms,mr]],["getHexagonAreaAvgM2",rs,[nc,mr]],["getHexagonAreaAvgKm2",rs,[nc,mr]],["getHexagonEdgeLengthAvgM",rs,[nc,mr]],["getHexagonEdgeLengthAvgKm",rs,[nc,mr]],["greatCircleDistanceM",Ms,[mr,mr]],["greatCircleDistanceKm",Ms,[mr,mr]],["greatCircleDistanceRads",Ms,[mr,mr]],["cellAreaM2",rs,[As,fs,mr]],["cellAreaKm2",rs,[As,fs,mr]],["cellAreaRads2",rs,[As,fs,mr]],["edgeLengthM",rs,[As,fs,mr]],["edgeLengthKm",rs,[As,fs,mr]],["edgeLengthRads",rs,[As,fs,mr]],["getNumCells",rs,[nc,mr]],["getRes0Cells",rs,[mr]],["res0CellCount",Ms],["getPentagons",rs,[Ms,mr]],["pentagonCount",Ms],["cellToVertex",rs,[As,fs,Ms,mr]],["cellToVertexes",rs,[As,fs,mr]],["vertexToLatLng",rs,[As,fs,mr]],["isValidVertex",ag,[As,fs]]],MV=0,PV=1,DV=2,LV=3,H5=4,BV=5,zV=6,RV=7,FV=8,OV=9,NV=10,VV=11,UV=12,GV=13,qV=14,HV=15,Xu={};Xu[MV]="Success";Xu[PV]="The operation failed but a more specific error is not available";Xu[DV]="Argument was outside of acceptable range";Xu[LV]="Latitude or longitude arguments were outside of acceptable range";Xu[H5]="Resolution argument was outside of acceptable range";Xu[BV]="Cell argument was not valid";Xu[zV]="Directed edge argument was not valid";Xu[RV]="Undirected edge argument was not valid";Xu[FV]="Vertex argument was not valid";Xu[OV]="Pentagon distortion was encountered";Xu[NV]="Duplicate input";Xu[VV]="Cell arguments were not neighbors";Xu[UV]="Cell arguments had incompatible resolutions";Xu[GV]="Memory allocation failed";Xu[qV]="Bounds of provided memory were insufficient";Xu[HV]="Mode or flags argument was not valid";var jV=1e3,j5=1001,Z5=1002,S1={};S1[jV]="Unknown unit";S1[j5]="Array length out of bounds";S1[Z5]="Got unexpected null value for H3 index";var ZV="Unknown error";function Q5(t,e,n){var c=n&&"value"in n,g=new Error((t[e]||ZV)+" (code: "+e+(c?", value: "+n.value:"")+")");return g.code=e,g}function W5(t,e){var n=arguments.length===2?{value:e}:{};return Q5(Xu,t,n)}function $5(t,e){var n=arguments.length===2?{value:e}:{};return Q5(S1,t,n)}function Y_(t){if(t!==0)throw W5(t)}var _h={};kV.forEach(function(e){_h[e[0]]=La.cwrap.apply(La,e)});var hm=16,Bg=4,B2=8,QV=8,K_=_h.sizeOfH3Index(),z2=_h.sizeOfLatLng();_h.sizeOfCellBoundary();var WV=_h.sizeOfGeoPolygon(),yg=_h.sizeOfGeoLoop();_h.sizeOfLinkedGeoPolygon();_h.sizeOfCoordIJ();function $V(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw W5(H5,t);return t}function XV(t){if(!t)throw $5(Z5);return t}var YV=Math.pow(2,32)-1;function KV(t){if(t>YV)throw $5(j5,t);return t}var JV=/[^0-9a-fA-F]/;function eU(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||JV.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),hm),n=parseInt(t.substring(t.length-8),hm);return[n,e]}function Nw(t){if(t>=0)return t.toString(hm);t=t&2147483647;var e=X5(8,t.toString(hm)),n=(parseInt(e[0],hm)+8).toString(hm);return e=n+e.substring(1),e}function tU(t,e){return Nw(e)+X5(8,Nw(t))}function X5(t,e){for(var n=t-e.length,c="",g=0;g<n;g++)c+="0";return c=c+e,c}function Vw(t,e,n){for(var c=t.length,g=La._calloc(c,z2),v=n?1:0,S=n?0:1,a=0;a<c*2;a+=2)La.HEAPF64.set([t[a/2][v],t[a/2][S]].map(K5),g/B2+a);return La.HEAPU32.set([c,g],e/Bg),e}function iU(t,e){var n=t.length-1,c=La._calloc(WV),g=0,v=g+yg,S=v+Bg;Vw(t[0],c+g,e);var a;if(n>0){a=La._calloc(n,yg);for(var N=0;N<n;N++)Vw(t[N+1],a+yg*N,e)}return La.setValue(c+v,n,"i32"),La.setValue(c+S,a,"i32"),c}function nU(t){var e=0,n=e+yg,c=n+Bg,g=Bg;La._free(La.getValue(t+e+g,"i8*"));var v=La.getValue(t+n,"i32");if(v>0){for(var S=La.getValue(t+c,"i32"),a=0;a<v;a++)La._free(La.getValue(S+yg*a+g,"i8*"));La._free(S)}La._free(t)}function Y5(t,e){e===void 0&&(e=0);var n=La.getValue(t+K_*e,"i32"),c=La.getValue(t+K_*e+Bg,"i32");return c?tU(n,c):null}function rU(t){return _h.readInt64AsDoubleFromPointer(t)}function sU(t,e){for(var n=[],c=0;c<e;c++){var g=Y5(t,c);g!==null&&n.push(g)}return n}function Uw(t){return uU(La.getValue(t,"double"))}function aU(t){return[Uw(t),Uw(t+B2)]}function oU(t,e,n){var c=La._malloc(z2);La.HEAPF64.set([t,e].map(K5),c/B2);var g=La._malloc(K_);try{return Y_(_h.latLngToCell(c,n,g)),XV(Y5(g))}finally{La._free(g),La._free(c)}}function Gw(t){var e=La._malloc(z2),n=eU(t),c=n[0],g=n[1];try{return Y_(_h.cellToLatLng(c,g,e)),aU(e)}finally{La._free(e)}}function lU(t,e,n){if($V(e),n=!!n,t.length===0||t[0].length===0)return[];var c=typeof t[0][0]=="number"?[t]:t,g=iU(c,n),v=La._malloc(QV);try{Y_(_h.maxPolygonToCellsSize(g,e,0,v));var S=KV(rU(v)),a=La._calloc(S,K_);try{return Y_(_h.polygonToCells(g,e,0,a)),sU(a,S)}finally{La._free(a)}}finally{La._free(v),nU(g)}}function K5(t){return t*Math.PI/180}function uU(t){return t*180/Math.PI}function cU(t,e,n){n===void 0&&(n={});var c={type:"Feature"};return(n.id===0||n.id)&&(c.id=n.id),n.bbox&&(c.bbox=n.bbox),c.properties=e||{},c.geometry=t,c}function hU(t,e){e===void 0&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function AU(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var n=0;n<t.features.length&&e(t.features[n],n)!==!1;n++);}function fU(t){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return AU(t,function(n){var c,g,v,S;switch((S=n.geometry)===null||S===void 0?void 0:S.type){case"Point":e.MultiPoint.coordinates.push(n.geometry.coordinates),e.MultiPoint.properties.push(n.properties);break;case"MultiPoint":(c=e.MultiPoint.coordinates).push.apply(c,n.geometry.coordinates),e.MultiPoint.properties.push(n.properties);break;case"LineString":e.MultiLineString.coordinates.push(n.geometry.coordinates),e.MultiLineString.properties.push(n.properties);break;case"MultiLineString":(g=e.MultiLineString.coordinates).push.apply(g,n.geometry.coordinates),e.MultiLineString.properties.push(n.properties);break;case"Polygon":e.MultiPolygon.coordinates.push(n.geometry.coordinates),e.MultiPolygon.properties.push(n.properties);break;case"MultiPolygon":(v=e.MultiPolygon.coordinates).push.apply(v,n.geometry.coordinates),e.MultiPolygon.properties.push(n.properties);break}}),hU(Object.keys(e).filter(function(n){return e[n].coordinates.length}).sort().map(function(n){var c={type:n,coordinates:e[n].coordinates},g={collectedProperties:e[n].properties};return cU(c,g)}))}const J5=t=>()=>t,Dv=t=>{const e=t?(n,c)=>c.minus(n).abs().isLessThanOrEqualTo(t):J5(!1);return(n,c)=>e(n,c)?0:n.comparedTo(c)};function dU(t){const e=t?(n,c,g,v,S)=>n.exponentiatedBy(2).isLessThanOrEqualTo(v.minus(c).exponentiatedBy(2).plus(S.minus(g).exponentiatedBy(2)).times(t)):J5(!1);return(n,c,g)=>{const v=n.x,S=n.y,a=g.x,N=g.y,$=S.minus(N).times(c.x.minus(a)).minus(v.minus(a).times(c.y.minus(N)));return e($,v,S,a,N)?0:$.comparedTo(0)}}var pU=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,dy=Math.ceil,zh=Math.floor,Gc="[BigNumber Error] ",qw=Gc+"Number primitive has more than 15 significant digits: ",cA=1e14,ks=14,py=9007199254740991,my=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],H0=1e7,zu=1e9;function eI(t){var e,n,c,g=ht.prototype={constructor:ht,toString:null,valueOf:null},v=new ht(1),S=20,a=4,N=-7,$=21,he=-1e7,oe=1e7,ce=!1,_e=1,Ze=0,nt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Ke="0123456789abcdefghijklmnopqrstuvwxyz",st=!0;function ht(rt,gt){var At,yt,St,ut,Ye,_t,ct,Ut,Ft=this;if(!(Ft instanceof ht))return new ht(rt,gt);if(gt==null){if(rt&&rt._isBigNumber===!0){Ft.s=rt.s,!rt.c||rt.e>oe?Ft.c=Ft.e=null:rt.e<he?Ft.c=[Ft.e=0]:(Ft.e=rt.e,Ft.c=rt.c.slice());return}if((_t=typeof rt=="number")&&rt*0==0){if(Ft.s=1/rt<0?(rt=-rt,-1):1,rt===~~rt){for(ut=0,Ye=rt;Ye>=10;Ye/=10,ut++);ut>oe?Ft.c=Ft.e=null:(Ft.e=ut,Ft.c=[rt]);return}Ut=String(rt)}else{if(!pU.test(Ut=String(rt)))return c(Ft,Ut,_t);Ft.s=Ut.charCodeAt(0)==45?(Ut=Ut.slice(1),-1):1}(ut=Ut.indexOf("."))>-1&&(Ut=Ut.replace(".","")),(Ye=Ut.search(/e/i))>0?(ut<0&&(ut=Ye),ut+=+Ut.slice(Ye+1),Ut=Ut.substring(0,Ye)):ut<0&&(ut=Ut.length)}else{if(Vl(gt,2,Ke.length,"Base"),gt==10&&st)return Ft=new ht(rt),Ue(Ft,S+Ft.e+1,a);if(Ut=String(rt),_t=typeof rt=="number"){if(rt*0!=0)return c(Ft,Ut,_t,gt);if(Ft.s=1/rt<0?(Ut=Ut.slice(1),-1):1,ht.DEBUG&&Ut.replace(/^0\.0*|\./,"").length>15)throw Error(qw+rt)}else Ft.s=Ut.charCodeAt(0)===45?(Ut=Ut.slice(1),-1):1;for(At=Ke.slice(0,gt),ut=Ye=0,ct=Ut.length;Ye<ct;Ye++)if(At.indexOf(yt=Ut.charAt(Ye))<0){if(yt=="."){if(Ye>ut){ut=ct;continue}}else if(!St&&(Ut==Ut.toUpperCase()&&(Ut=Ut.toLowerCase())||Ut==Ut.toLowerCase()&&(Ut=Ut.toUpperCase()))){St=!0,Ye=-1,ut=0;continue}return c(Ft,String(rt),_t,gt)}_t=!1,Ut=n(Ut,gt,10,Ft.s),(ut=Ut.indexOf("."))>-1?Ut=Ut.replace(".",""):ut=Ut.length}for(Ye=0;Ut.charCodeAt(Ye)===48;Ye++);for(ct=Ut.length;Ut.charCodeAt(--ct)===48;);if(Ut=Ut.slice(Ye,++ct)){if(ct-=Ye,_t&&ht.DEBUG&&ct>15&&(rt>py||rt!==zh(rt)))throw Error(qw+Ft.s*rt);if((ut=ut-Ye-1)>oe)Ft.c=Ft.e=null;else if(ut<he)Ft.c=[Ft.e=0];else{if(Ft.e=ut,Ft.c=[],Ye=(ut+1)%ks,ut<0&&(Ye+=ks),Ye<ct){for(Ye&&Ft.c.push(+Ut.slice(0,Ye)),ct-=ks;Ye<ct;)Ft.c.push(+Ut.slice(Ye,Ye+=ks));Ye=ks-(Ut=Ut.slice(Ye)).length}else Ye-=ct;for(;Ye--;Ut+="0");Ft.c.push(+Ut)}}else Ft.c=[Ft.e=0]}ht.clone=eI,ht.ROUND_UP=0,ht.ROUND_DOWN=1,ht.ROUND_CEIL=2,ht.ROUND_FLOOR=3,ht.ROUND_HALF_UP=4,ht.ROUND_HALF_DOWN=5,ht.ROUND_HALF_EVEN=6,ht.ROUND_HALF_CEIL=7,ht.ROUND_HALF_FLOOR=8,ht.EUCLID=9,ht.config=ht.set=function(rt){var gt,At;if(rt!=null)if(typeof rt=="object"){if(rt.hasOwnProperty(gt="DECIMAL_PLACES")&&(At=rt[gt],Vl(At,0,zu,gt),S=At),rt.hasOwnProperty(gt="ROUNDING_MODE")&&(At=rt[gt],Vl(At,0,8,gt),a=At),rt.hasOwnProperty(gt="EXPONENTIAL_AT")&&(At=rt[gt],At&&At.pop?(Vl(At[0],-zu,0,gt),Vl(At[1],0,zu,gt),N=At[0],$=At[1]):(Vl(At,-zu,zu,gt),N=-($=At<0?-At:At))),rt.hasOwnProperty(gt="RANGE"))if(At=rt[gt],At&&At.pop)Vl(At[0],-zu,-1,gt),Vl(At[1],1,zu,gt),he=At[0],oe=At[1];else if(Vl(At,-zu,zu,gt),At)he=-(oe=At<0?-At:At);else throw Error(Gc+gt+" cannot be zero: "+At);if(rt.hasOwnProperty(gt="CRYPTO"))if(At=rt[gt],At===!!At)if(At)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ce=At;else throw ce=!At,Error(Gc+"crypto unavailable");else ce=At;else throw Error(Gc+gt+" not true or false: "+At);if(rt.hasOwnProperty(gt="MODULO_MODE")&&(At=rt[gt],Vl(At,0,9,gt),_e=At),rt.hasOwnProperty(gt="POW_PRECISION")&&(At=rt[gt],Vl(At,0,zu,gt),Ze=At),rt.hasOwnProperty(gt="FORMAT"))if(At=rt[gt],typeof At=="object")nt=At;else throw Error(Gc+gt+" not an object: "+At);if(rt.hasOwnProperty(gt="ALPHABET"))if(At=rt[gt],typeof At=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(At))st=At.slice(0,10)=="0123456789",Ke=At;else throw Error(Gc+gt+" invalid: "+At)}else throw Error(Gc+"Object expected: "+rt);return{DECIMAL_PLACES:S,ROUNDING_MODE:a,EXPONENTIAL_AT:[N,$],RANGE:[he,oe],CRYPTO:ce,MODULO_MODE:_e,POW_PRECISION:Ze,FORMAT:nt,ALPHABET:Ke}},ht.isBigNumber=function(rt){if(!rt||rt._isBigNumber!==!0)return!1;if(!ht.DEBUG)return!0;var gt,At,yt=rt.c,St=rt.e,ut=rt.s;e:if({}.toString.call(yt)=="[object Array]"){if((ut===1||ut===-1)&&St>=-zu&&St<=zu&&St===zh(St)){if(yt[0]===0){if(St===0&&yt.length===1)return!0;break e}if(gt=(St+1)%ks,gt<1&&(gt+=ks),String(yt[0]).length==gt){for(gt=0;gt<yt.length;gt++)if(At=yt[gt],At<0||At>=cA||At!==zh(At))break e;if(At!==0)return!0}}}else if(yt===null&&St===null&&(ut===null||ut===1||ut===-1))return!0;throw Error(Gc+"Invalid BigNumber: "+rt)},ht.maximum=ht.max=function(){return zt(arguments,-1)},ht.minimum=ht.min=function(){return zt(arguments,1)},ht.random=function(){var rt=9007199254740992,gt=Math.random()*rt&2097151?function(){return zh(Math.random()*rt)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(At){var yt,St,ut,Ye,_t,ct=0,Ut=[],Ft=new ht(v);if(At==null?At=S:Vl(At,0,zu),Ye=dy(At/ks),ce)if(crypto.getRandomValues){for(yt=crypto.getRandomValues(new Uint32Array(Ye*=2));ct<Ye;)_t=yt[ct]*131072+(yt[ct+1]>>>11),_t>=9e15?(St=crypto.getRandomValues(new Uint32Array(2)),yt[ct]=St[0],yt[ct+1]=St[1]):(Ut.push(_t%1e14),ct+=2);ct=Ye/2}else if(crypto.randomBytes){for(yt=crypto.randomBytes(Ye*=7);ct<Ye;)_t=(yt[ct]&31)*281474976710656+yt[ct+1]*1099511627776+yt[ct+2]*4294967296+yt[ct+3]*16777216+(yt[ct+4]<<16)+(yt[ct+5]<<8)+yt[ct+6],_t>=9e15?crypto.randomBytes(7).copy(yt,ct):(Ut.push(_t%1e14),ct+=7);ct=Ye/7}else throw ce=!1,Error(Gc+"crypto unavailable");if(!ce)for(;ct<Ye;)_t=gt(),_t<9e15&&(Ut[ct++]=_t%1e14);for(Ye=Ut[--ct],At%=ks,Ye&&At&&(_t=my[ks-At],Ut[ct]=zh(Ye/_t)*_t);Ut[ct]===0;Ut.pop(),ct--);if(ct<0)Ut=[ut=0];else{for(ut=-1;Ut[0]===0;Ut.splice(0,1),ut-=ks);for(ct=1,_t=Ut[0];_t>=10;_t/=10,ct++);ct<ks&&(ut-=ks-ct)}return Ft.e=ut,Ft.c=Ut,Ft}}(),ht.sum=function(){for(var rt=1,gt=arguments,At=new ht(gt[0]);rt<gt.length;)At=At.plus(gt[rt++]);return At},n=function(){var rt="0123456789";function gt(At,yt,St,ut){for(var Ye,_t=[0],ct,Ut=0,Ft=At.length;Ut<Ft;){for(ct=_t.length;ct--;_t[ct]*=yt);for(_t[0]+=ut.indexOf(At.charAt(Ut++)),Ye=0;Ye<_t.length;Ye++)_t[Ye]>St-1&&(_t[Ye+1]==null&&(_t[Ye+1]=0),_t[Ye+1]+=_t[Ye]/St|0,_t[Ye]%=St)}return _t.reverse()}return function(At,yt,St,ut,Ye){var _t,ct,Ut,Ft,Vt,yi,Ci,ki,Ni=At.indexOf("."),tn=S,Zi=a;for(Ni>=0&&(Ft=Ze,Ze=0,At=At.replace(".",""),ki=new ht(yt),yi=ki.pow(At.length-Ni),Ze=Ft,ki.c=gt(i0(Bh(yi.c),yi.e,"0"),10,St,rt),ki.e=ki.c.length),Ci=gt(At,yt,St,Ye?(_t=Ke,rt):(_t=rt,Ke)),Ut=Ft=Ci.length;Ci[--Ft]==0;Ci.pop());if(!Ci[0])return _t.charAt(0);if(Ni<0?--Ut:(yi.c=Ci,yi.e=Ut,yi.s=ut,yi=e(yi,ki,tn,Zi,St),Ci=yi.c,Vt=yi.r,Ut=yi.e),ct=Ut+tn+1,Ni=Ci[ct],Ft=St/2,Vt=Vt||ct<0||Ci[ct+1]!=null,Vt=Zi<4?(Ni!=null||Vt)&&(Zi==0||Zi==(yi.s<0?3:2)):Ni>Ft||Ni==Ft&&(Zi==4||Vt||Zi==6&&Ci[ct-1]&1||Zi==(yi.s<0?8:7)),ct<1||!Ci[0])At=Vt?i0(_t.charAt(1),-tn,_t.charAt(0)):_t.charAt(0);else{if(Ci.length=ct,Vt)for(--St;++Ci[--ct]>St;)Ci[ct]=0,ct||(++Ut,Ci=[1].concat(Ci));for(Ft=Ci.length;!Ci[--Ft];);for(Ni=0,At="";Ni<=Ft;At+=_t.charAt(Ci[Ni++]));At=i0(At,Ut,_t.charAt(0))}return At}}(),e=function(){function rt(yt,St,ut){var Ye,_t,ct,Ut,Ft=0,Vt=yt.length,yi=St%H0,Ci=St/H0|0;for(yt=yt.slice();Vt--;)ct=yt[Vt]%H0,Ut=yt[Vt]/H0|0,Ye=Ci*ct+Ut*yi,_t=yi*ct+Ye%H0*H0+Ft,Ft=(_t/ut|0)+(Ye/H0|0)+Ci*Ut,yt[Vt]=_t%ut;return Ft&&(yt=[Ft].concat(yt)),yt}function gt(yt,St,ut,Ye){var _t,ct;if(ut!=Ye)ct=ut>Ye?1:-1;else for(_t=ct=0;_t<ut;_t++)if(yt[_t]!=St[_t]){ct=yt[_t]>St[_t]?1:-1;break}return ct}function At(yt,St,ut,Ye){for(var _t=0;ut--;)yt[ut]-=_t,_t=yt[ut]<St[ut]?1:0,yt[ut]=_t*Ye+yt[ut]-St[ut];for(;!yt[0]&&yt.length>1;yt.splice(0,1));}return function(yt,St,ut,Ye,_t){var ct,Ut,Ft,Vt,yi,Ci,ki,Ni,tn,Zi,Gi,sn,xn,Ti,gi,Oi,Vi,bn=yt.s==St.s?1:-1,wn=yt.c,xi=St.c;if(!wn||!wn[0]||!xi||!xi[0])return new ht(!yt.s||!St.s||(wn?xi&&wn[0]==xi[0]:!xi)?NaN:wn&&wn[0]==0||!xi?bn*0:bn/0);for(Ni=new ht(bn),tn=Ni.c=[],Ut=yt.e-St.e,bn=ut+Ut+1,_t||(_t=cA,Ut=Rh(yt.e/ks)-Rh(St.e/ks),bn=bn/ks|0),Ft=0;xi[Ft]==(wn[Ft]||0);Ft++);if(xi[Ft]>(wn[Ft]||0)&&Ut--,bn<0)tn.push(1),Vt=!0;else{for(Ti=wn.length,Oi=xi.length,Ft=0,bn+=2,yi=zh(_t/(xi[0]+1)),yi>1&&(xi=rt(xi,yi,_t),wn=rt(wn,yi,_t),Oi=xi.length,Ti=wn.length),xn=Oi,Zi=wn.slice(0,Oi),Gi=Zi.length;Gi<Oi;Zi[Gi++]=0);Vi=xi.slice(),Vi=[0].concat(Vi),gi=xi[0],xi[1]>=_t/2&&gi++;do{if(yi=0,ct=gt(xi,Zi,Oi,Gi),ct<0){if(sn=Zi[0],Oi!=Gi&&(sn=sn*_t+(Zi[1]||0)),yi=zh(sn/gi),yi>1)for(yi>=_t&&(yi=_t-1),Ci=rt(xi,yi,_t),ki=Ci.length,Gi=Zi.length;gt(Ci,Zi,ki,Gi)==1;)yi--,At(Ci,Oi<ki?Vi:xi,ki,_t),ki=Ci.length,ct=1;else yi==0&&(ct=yi=1),Ci=xi.slice(),ki=Ci.length;if(ki<Gi&&(Ci=[0].concat(Ci)),At(Zi,Ci,Gi,_t),Gi=Zi.length,ct==-1)for(;gt(xi,Zi,Oi,Gi)<1;)yi++,At(Zi,Oi<Gi?Vi:xi,Gi,_t),Gi=Zi.length}else ct===0&&(yi++,Zi=[0]);tn[Ft++]=yi,Zi[0]?Zi[Gi++]=wn[xn]||0:(Zi=[wn[xn]],Gi=1)}while((xn++<Ti||Zi[0]!=null)&&bn--);Vt=Zi[0]!=null,tn[0]||tn.splice(0,1)}if(_t==cA){for(Ft=1,bn=tn[0];bn>=10;bn/=10,Ft++);Ue(Ni,ut+(Ni.e=Ft+Ut*ks-1)+1,Ye,Vt)}else Ni.e=Ut,Ni.r=+Vt;return Ni}}();function xt(rt,gt,At,yt){var St,ut,Ye,_t,ct;if(At==null?At=a:Vl(At,0,8),!rt.c)return rt.toString();if(St=rt.c[0],Ye=rt.e,gt==null)ct=Bh(rt.c),ct=yt==1||yt==2&&(Ye<=N||Ye>=$)?s_(ct,Ye):i0(ct,Ye,"0");else if(rt=Ue(new ht(rt),gt,At),ut=rt.e,ct=Bh(rt.c),_t=ct.length,yt==1||yt==2&&(gt<=ut||ut<=N)){for(;_t<gt;ct+="0",_t++);ct=s_(ct,ut)}else if(gt-=Ye,ct=i0(ct,ut,"0"),ut+1>_t){if(--gt>0)for(ct+=".";gt--;ct+="0");}else if(gt+=ut-_t,gt>0)for(ut+1==_t&&(ct+=".");gt--;ct+="0");return rt.s<0&&St?"-"+ct:ct}function zt(rt,gt){for(var At,yt,St=1,ut=new ht(rt[0]);St<rt.length;St++)yt=new ht(rt[St]),(!yt.s||(At=Xd(ut,yt))===gt||At===0&&ut.s===gt)&&(ut=yt);return ut}function Mt(rt,gt,At){for(var yt=1,St=gt.length;!gt[--St];gt.pop());for(St=gt[0];St>=10;St/=10,yt++);return(At=yt+At*ks-1)>oe?rt.c=rt.e=null:At<he?rt.c=[rt.e=0]:(rt.e=At,rt.c=gt),rt}c=function(){var rt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,gt=/^([^.]+)\.$/,At=/^\.([^.]+)$/,yt=/^-?(Infinity|NaN)$/,St=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(ut,Ye,_t,ct){var Ut,Ft=_t?Ye:Ye.replace(St,"");if(yt.test(Ft))ut.s=isNaN(Ft)?null:Ft<0?-1:1;else{if(!_t&&(Ft=Ft.replace(rt,function(Vt,yi,Ci){return Ut=(Ci=Ci.toLowerCase())=="x"?16:Ci=="b"?2:8,!ct||ct==Ut?yi:Vt}),ct&&(Ut=ct,Ft=Ft.replace(gt,"$1").replace(At,"0.$1")),Ye!=Ft))return new ht(Ft,Ut);if(ht.DEBUG)throw Error(Gc+"Not a"+(ct?" base "+ct:"")+" number: "+Ye);ut.s=null}ut.c=ut.e=null}}();function Ue(rt,gt,At,yt){var St,ut,Ye,_t,ct,Ut,Ft,Vt=rt.c,yi=my;if(Vt){e:{for(St=1,_t=Vt[0];_t>=10;_t/=10,St++);if(ut=gt-St,ut<0)ut+=ks,Ye=gt,ct=Vt[Ut=0],Ft=zh(ct/yi[St-Ye-1]%10);else if(Ut=dy((ut+1)/ks),Ut>=Vt.length)if(yt){for(;Vt.length<=Ut;Vt.push(0));ct=Ft=0,St=1,ut%=ks,Ye=ut-ks+1}else break e;else{for(ct=_t=Vt[Ut],St=1;_t>=10;_t/=10,St++);ut%=ks,Ye=ut-ks+St,Ft=Ye<0?0:zh(ct/yi[St-Ye-1]%10)}if(yt=yt||gt<0||Vt[Ut+1]!=null||(Ye<0?ct:ct%yi[St-Ye-1]),yt=At<4?(Ft||yt)&&(At==0||At==(rt.s<0?3:2)):Ft>5||Ft==5&&(At==4||yt||At==6&&(ut>0?Ye>0?ct/yi[St-Ye]:0:Vt[Ut-1])%10&1||At==(rt.s<0?8:7)),gt<1||!Vt[0])return Vt.length=0,yt?(gt-=rt.e+1,Vt[0]=yi[(ks-gt%ks)%ks],rt.e=-gt||0):Vt[0]=rt.e=0,rt;if(ut==0?(Vt.length=Ut,_t=1,Ut--):(Vt.length=Ut+1,_t=yi[ks-ut],Vt[Ut]=Ye>0?zh(ct/yi[St-Ye]%yi[Ye])*_t:0),yt)for(;;)if(Ut==0){for(ut=1,Ye=Vt[0];Ye>=10;Ye/=10,ut++);for(Ye=Vt[0]+=_t,_t=1;Ye>=10;Ye/=10,_t++);ut!=_t&&(rt.e++,Vt[0]==cA&&(Vt[0]=1));break}else{if(Vt[Ut]+=_t,Vt[Ut]!=cA)break;Vt[Ut--]=0,_t=1}for(ut=Vt.length;Vt[--ut]===0;Vt.pop());}rt.e>oe?rt.c=rt.e=null:rt.e<he&&(rt.c=[rt.e=0])}return rt}function $t(rt){var gt,At=rt.e;return At===null?rt.toString():(gt=Bh(rt.c),gt=At<=N||At>=$?s_(gt,At):i0(gt,At,"0"),rt.s<0?"-"+gt:gt)}return g.absoluteValue=g.abs=function(){var rt=new ht(this);return rt.s<0&&(rt.s=1),rt},g.comparedTo=function(rt,gt){return Xd(this,new ht(rt,gt))},g.decimalPlaces=g.dp=function(rt,gt){var At,yt,St,ut=this;if(rt!=null)return Vl(rt,0,zu),gt==null?gt=a:Vl(gt,0,8),Ue(new ht(ut),rt+ut.e+1,gt);if(!(At=ut.c))return null;if(yt=((St=At.length-1)-Rh(this.e/ks))*ks,St=At[St])for(;St%10==0;St/=10,yt--);return yt<0&&(yt=0),yt},g.dividedBy=g.div=function(rt,gt){return e(this,new ht(rt,gt),S,a)},g.dividedToIntegerBy=g.idiv=function(rt,gt){return e(this,new ht(rt,gt),0,1)},g.exponentiatedBy=g.pow=function(rt,gt){var At,yt,St,ut,Ye,_t,ct,Ut,Ft,Vt=this;if(rt=new ht(rt),rt.c&&!rt.isInteger())throw Error(Gc+"Exponent not an integer: "+$t(rt));if(gt!=null&&(gt=new ht(gt)),_t=rt.e>14,!Vt.c||!Vt.c[0]||Vt.c[0]==1&&!Vt.e&&Vt.c.length==1||!rt.c||!rt.c[0])return Ft=new ht(Math.pow(+$t(Vt),_t?rt.s*(2-r_(rt)):+$t(rt))),gt?Ft.mod(gt):Ft;if(ct=rt.s<0,gt){if(gt.c?!gt.c[0]:!gt.s)return new ht(NaN);yt=!ct&&Vt.isInteger()&&gt.isInteger(),yt&&(Vt=Vt.mod(gt))}else{if(rt.e>9&&(Vt.e>0||Vt.e<-1||(Vt.e==0?Vt.c[0]>1||_t&&Vt.c[1]>=24e7:Vt.c[0]<8e13||_t&&Vt.c[0]<=9999975e7)))return ut=Vt.s<0&&r_(rt)?-0:0,Vt.e>-1&&(ut=1/ut),new ht(ct?1/ut:ut);Ze&&(ut=dy(Ze/ks+2))}for(_t?(At=new ht(.5),ct&&(rt.s=1),Ut=r_(rt)):(St=Math.abs(+$t(rt)),Ut=St%2),Ft=new ht(v);;){if(Ut){if(Ft=Ft.times(Vt),!Ft.c)break;ut?Ft.c.length>ut&&(Ft.c.length=ut):yt&&(Ft=Ft.mod(gt))}if(St){if(St=zh(St/2),St===0)break;Ut=St%2}else if(rt=rt.times(At),Ue(rt,rt.e+1,1),rt.e>14)Ut=r_(rt);else{if(St=+$t(rt),St===0)break;Ut=St%2}Vt=Vt.times(Vt),ut?Vt.c&&Vt.c.length>ut&&(Vt.c.length=ut):yt&&(Vt=Vt.mod(gt))}return yt?Ft:(ct&&(Ft=v.div(Ft)),gt?Ft.mod(gt):ut?Ue(Ft,Ze,a,Ye):Ft)},g.integerValue=function(rt){var gt=new ht(this);return rt==null?rt=a:Vl(rt,0,8),Ue(gt,gt.e+1,rt)},g.isEqualTo=g.eq=function(rt,gt){return Xd(this,new ht(rt,gt))===0},g.isFinite=function(){return!!this.c},g.isGreaterThan=g.gt=function(rt,gt){return Xd(this,new ht(rt,gt))>0},g.isGreaterThanOrEqualTo=g.gte=function(rt,gt){return(gt=Xd(this,new ht(rt,gt)))===1||gt===0},g.isInteger=function(){return!!this.c&&Rh(this.e/ks)>this.c.length-2},g.isLessThan=g.lt=function(rt,gt){return Xd(this,new ht(rt,gt))<0},g.isLessThanOrEqualTo=g.lte=function(rt,gt){return(gt=Xd(this,new ht(rt,gt)))===-1||gt===0},g.isNaN=function(){return!this.s},g.isNegative=function(){return this.s<0},g.isPositive=function(){return this.s>0},g.isZero=function(){return!!this.c&&this.c[0]==0},g.minus=function(rt,gt){var At,yt,St,ut,Ye=this,_t=Ye.s;if(rt=new ht(rt,gt),gt=rt.s,!_t||!gt)return new ht(NaN);if(_t!=gt)return rt.s=-gt,Ye.plus(rt);var ct=Ye.e/ks,Ut=rt.e/ks,Ft=Ye.c,Vt=rt.c;if(!ct||!Ut){if(!Ft||!Vt)return Ft?(rt.s=-gt,rt):new ht(Vt?Ye:NaN);if(!Ft[0]||!Vt[0])return Vt[0]?(rt.s=-gt,rt):new ht(Ft[0]?Ye:a==3?-0:0)}if(ct=Rh(ct),Ut=Rh(Ut),Ft=Ft.slice(),_t=ct-Ut){for((ut=_t<0)?(_t=-_t,St=Ft):(Ut=ct,St=Vt),St.reverse(),gt=_t;gt--;St.push(0));St.reverse()}else for(yt=(ut=(_t=Ft.length)<(gt=Vt.length))?_t:gt,_t=gt=0;gt<yt;gt++)if(Ft[gt]!=Vt[gt]){ut=Ft[gt]<Vt[gt];break}if(ut&&(St=Ft,Ft=Vt,Vt=St,rt.s=-rt.s),gt=(yt=Vt.length)-(At=Ft.length),gt>0)for(;gt--;Ft[At++]=0);for(gt=cA-1;yt>_t;){if(Ft[--yt]<Vt[yt]){for(At=yt;At&&!Ft[--At];Ft[At]=gt);--Ft[At],Ft[yt]+=cA}Ft[yt]-=Vt[yt]}for(;Ft[0]==0;Ft.splice(0,1),--Ut);return Ft[0]?Mt(rt,Ft,Ut):(rt.s=a==3?-1:1,rt.c=[rt.e=0],rt)},g.modulo=g.mod=function(rt,gt){var At,yt,St=this;return rt=new ht(rt,gt),!St.c||!rt.s||rt.c&&!rt.c[0]?new ht(NaN):!rt.c||St.c&&!St.c[0]?new ht(St):(_e==9?(yt=rt.s,rt.s=1,At=e(St,rt,0,3),rt.s=yt,At.s*=yt):At=e(St,rt,0,_e),rt=St.minus(At.times(rt)),!rt.c[0]&&_e==1&&(rt.s=St.s),rt)},g.multipliedBy=g.times=function(rt,gt){var At,yt,St,ut,Ye,_t,ct,Ut,Ft,Vt,yi,Ci,ki,Ni,tn,Zi=this,Gi=Zi.c,sn=(rt=new ht(rt,gt)).c;if(!Gi||!sn||!Gi[0]||!sn[0])return!Zi.s||!rt.s||Gi&&!Gi[0]&&!sn||sn&&!sn[0]&&!Gi?rt.c=rt.e=rt.s=null:(rt.s*=Zi.s,!Gi||!sn?rt.c=rt.e=null:(rt.c=[0],rt.e=0)),rt;for(yt=Rh(Zi.e/ks)+Rh(rt.e/ks),rt.s*=Zi.s,ct=Gi.length,Vt=sn.length,ct<Vt&&(ki=Gi,Gi=sn,sn=ki,St=ct,ct=Vt,Vt=St),St=ct+Vt,ki=[];St--;ki.push(0));for(Ni=cA,tn=H0,St=Vt;--St>=0;){for(At=0,yi=sn[St]%tn,Ci=sn[St]/tn|0,Ye=ct,ut=St+Ye;ut>St;)Ut=Gi[--Ye]%tn,Ft=Gi[Ye]/tn|0,_t=Ci*Ut+Ft*yi,Ut=yi*Ut+_t%tn*tn+ki[ut]+At,At=(Ut/Ni|0)+(_t/tn|0)+Ci*Ft,ki[ut--]=Ut%Ni;ki[ut]=At}return At?++yt:ki.splice(0,1),Mt(rt,ki,yt)},g.negated=function(){var rt=new ht(this);return rt.s=-rt.s||null,rt},g.plus=function(rt,gt){var At,yt=this,St=yt.s;if(rt=new ht(rt,gt),gt=rt.s,!St||!gt)return new ht(NaN);if(St!=gt)return rt.s=-gt,yt.minus(rt);var ut=yt.e/ks,Ye=rt.e/ks,_t=yt.c,ct=rt.c;if(!ut||!Ye){if(!_t||!ct)return new ht(St/0);if(!_t[0]||!ct[0])return ct[0]?rt:new ht(_t[0]?yt:St*0)}if(ut=Rh(ut),Ye=Rh(Ye),_t=_t.slice(),St=ut-Ye){for(St>0?(Ye=ut,At=ct):(St=-St,At=_t),At.reverse();St--;At.push(0));At.reverse()}for(St=_t.length,gt=ct.length,St-gt<0&&(At=ct,ct=_t,_t=At,gt=St),St=0;gt;)St=(_t[--gt]=_t[gt]+ct[gt]+St)/cA|0,_t[gt]=cA===_t[gt]?0:_t[gt]%cA;return St&&(_t=[St].concat(_t),++Ye),Mt(rt,_t,Ye)},g.precision=g.sd=function(rt,gt){var At,yt,St,ut=this;if(rt!=null&&rt!==!!rt)return Vl(rt,1,zu),gt==null?gt=a:Vl(gt,0,8),Ue(new ht(ut),rt,gt);if(!(At=ut.c))return null;if(St=At.length-1,yt=St*ks+1,St=At[St]){for(;St%10==0;St/=10,yt--);for(St=At[0];St>=10;St/=10,yt++);}return rt&&ut.e+1>yt&&(yt=ut.e+1),yt},g.shiftedBy=function(rt){return Vl(rt,-py,py),this.times("1e"+rt)},g.squareRoot=g.sqrt=function(){var rt,gt,At,yt,St,ut=this,Ye=ut.c,_t=ut.s,ct=ut.e,Ut=S+4,Ft=new ht("0.5");if(_t!==1||!Ye||!Ye[0])return new ht(!_t||_t<0&&(!Ye||Ye[0])?NaN:Ye?ut:1/0);if(_t=Math.sqrt(+$t(ut)),_t==0||_t==1/0?(gt=Bh(Ye),(gt.length+ct)%2==0&&(gt+="0"),_t=Math.sqrt(+gt),ct=Rh((ct+1)/2)-(ct<0||ct%2),_t==1/0?gt="5e"+ct:(gt=_t.toExponential(),gt=gt.slice(0,gt.indexOf("e")+1)+ct),At=new ht(gt)):At=new ht(_t+""),At.c[0]){for(ct=At.e,_t=ct+Ut,_t<3&&(_t=0);;)if(St=At,At=Ft.times(St.plus(e(ut,St,Ut,1))),Bh(St.c).slice(0,_t)===(gt=Bh(At.c)).slice(0,_t))if(At.e<ct&&--_t,gt=gt.slice(_t-3,_t+1),gt=="9999"||!yt&&gt=="4999"){if(!yt&&(Ue(St,St.e+S+2,0),St.times(St).eq(ut))){At=St;break}Ut+=4,_t+=4,yt=1}else{(!+gt||!+gt.slice(1)&&gt.charAt(0)=="5")&&(Ue(At,At.e+S+2,1),rt=!At.times(At).eq(ut));break}}return Ue(At,At.e+S+1,a,rt)},g.toExponential=function(rt,gt){return rt!=null&&(Vl(rt,0,zu),rt++),xt(this,rt,gt,1)},g.toFixed=function(rt,gt){return rt!=null&&(Vl(rt,0,zu),rt=rt+this.e+1),xt(this,rt,gt)},g.toFormat=function(rt,gt,At){var yt,St=this;if(At==null)rt!=null&&gt&&typeof gt=="object"?(At=gt,gt=null):rt&&typeof rt=="object"?(At=rt,rt=gt=null):At=nt;else if(typeof At!="object")throw Error(Gc+"Argument not an object: "+At);if(yt=St.toFixed(rt,gt),St.c){var ut,Ye=yt.split("."),_t=+At.groupSize,ct=+At.secondaryGroupSize,Ut=At.groupSeparator||"",Ft=Ye[0],Vt=Ye[1],yi=St.s<0,Ci=yi?Ft.slice(1):Ft,ki=Ci.length;if(ct&&(ut=_t,_t=ct,ct=ut,ki-=ut),_t>0&&ki>0){for(ut=ki%_t||_t,Ft=Ci.substr(0,ut);ut<ki;ut+=_t)Ft+=Ut+Ci.substr(ut,_t);ct>0&&(Ft+=Ut+Ci.slice(ut)),yi&&(Ft="-"+Ft)}yt=Vt?Ft+(At.decimalSeparator||"")+((ct=+At.fractionGroupSize)?Vt.replace(new RegExp("\\d{"+ct+"}\\B","g"),"$&"+(At.fractionGroupSeparator||"")):Vt):Ft}return(At.prefix||"")+yt+(At.suffix||"")},g.toFraction=function(rt){var gt,At,yt,St,ut,Ye,_t,ct,Ut,Ft,Vt,yi,Ci=this,ki=Ci.c;if(rt!=null&&(_t=new ht(rt),!_t.isInteger()&&(_t.c||_t.s!==1)||_t.lt(v)))throw Error(Gc+"Argument "+(_t.isInteger()?"out of range: ":"not an integer: ")+$t(_t));if(!ki)return new ht(Ci);for(gt=new ht(v),Ut=At=new ht(v),yt=ct=new ht(v),yi=Bh(ki),ut=gt.e=yi.length-Ci.e-1,gt.c[0]=my[(Ye=ut%ks)<0?ks+Ye:Ye],rt=!rt||_t.comparedTo(gt)>0?ut>0?gt:Ut:_t,Ye=oe,oe=1/0,_t=new ht(yi),ct.c[0]=0;Ft=e(_t,gt,0,1),St=At.plus(Ft.times(yt)),St.comparedTo(rt)!=1;)At=yt,yt=St,Ut=ct.plus(Ft.times(St=Ut)),ct=St,gt=_t.minus(Ft.times(St=gt)),_t=St;return St=e(rt.minus(At),yt,0,1),ct=ct.plus(St.times(Ut)),At=At.plus(St.times(yt)),ct.s=Ut.s=Ci.s,ut=ut*2,Vt=e(Ut,yt,ut,a).minus(Ci).abs().comparedTo(e(ct,At,ut,a).minus(Ci).abs())<1?[Ut,yt]:[ct,At],oe=Ye,Vt},g.toNumber=function(){return+$t(this)},g.toPrecision=function(rt,gt){return rt!=null&&Vl(rt,1,zu),xt(this,rt,gt,2)},g.toString=function(rt){var gt,At=this,yt=At.s,St=At.e;return St===null?yt?(gt="Infinity",yt<0&&(gt="-"+gt)):gt="NaN":(rt==null?gt=St<=N||St>=$?s_(Bh(At.c),St):i0(Bh(At.c),St,"0"):rt===10&&st?(At=Ue(new ht(At),S+St+1,a),gt=i0(Bh(At.c),At.e,"0")):(Vl(rt,2,Ke.length,"Base"),gt=n(i0(Bh(At.c),St,"0"),10,rt,yt,!0)),yt<0&&At.c[0]&&(gt="-"+gt)),gt},g.valueOf=g.toJSON=function(){return $t(this)},g._isBigNumber=!0,g[Symbol.toStringTag]="BigNumber",g[Symbol.for("nodejs.util.inspect.custom")]=g.valueOf,t!=null&&ht.set(t),ht}function Rh(t){var e=t|0;return t>0||t===e?e:e-1}function Bh(t){for(var e,n,c=1,g=t.length,v=t[0]+"";c<g;){for(e=t[c++]+"",n=ks-e.length;n--;e="0"+e);v+=e}for(g=v.length;v.charCodeAt(--g)===48;);return v.slice(0,g+1||1)}function Xd(t,e){var n,c,g=t.c,v=e.c,S=t.s,a=e.s,N=t.e,$=e.e;if(!S||!a)return null;if(n=g&&!g[0],c=v&&!v[0],n||c)return n?c?0:-a:S;if(S!=a)return S;if(n=S<0,c=N==$,!g||!v)return c?0:!g^n?1:-1;if(!c)return N>$^n?1:-1;for(a=(N=g.length)<($=v.length)?N:$,S=0;S<a;S++)if(g[S]!=v[S])return g[S]>v[S]^n?1:-1;return N==$?0:N>$^n?1:-1}function Vl(t,e,n,c){if(t<e||t>n||t!==zh(t))throw Error(Gc+(c||"Argument")+(typeof t=="number"?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function r_(t){var e=t.c.length-1;return Rh(t.e/ks)==e&&t.c[e]%2!=0}function s_(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function i0(t,e,n){var c,g;if(e<0){for(g=n+".";++e;g+=n);t=g+t}else if(c=t.length,++e>c){for(g=n,e-=c;--e;g+=n);t+=g}else e<c&&(t=t.slice(0,e)+"."+t.slice(e));return t}var ef=eI();class mU{constructor(e){Lr(this,"key");Lr(this,"left",null);Lr(this,"right",null);this.key=e}}class og extends mU{constructor(e){super(e)}}class gU{constructor(){Lr(this,"size",0);Lr(this,"modificationCount",0);Lr(this,"splayCount",0)}splay(e){const n=this.root;if(n==null)return this.compare(e,e),-1;let c=null,g=null,v=null,S=null,a=n;const N=this.compare;let $;for(;;)if($=N(a.key,e),$>0){let he=a.left;if(he==null||($=N(he.key,e),$>0&&(a.left=he.right,he.right=a,a=he,he=a.left,he==null)))break;c==null?g=a:c.left=a,c=a,a=he}else if($<0){let he=a.right;if(he==null||($=N(he.key,e),$<0&&(a.right=he.left,he.left=a,a=he,he=a.right,he==null)))break;v==null?S=a:v.right=a,v=a,a=he}else break;return v!=null&&(v.right=a.left,a.left=S),c!=null&&(c.left=a.right,a.right=g),this.root!==a&&(this.root=a,this.splayCount++),$}splayMin(e){let n=e,c=n.left;for(;c!=null;){const g=c;n.left=g.right,g.right=n,n=g,c=n.left}return n}splayMax(e){let n=e,c=n.right;for(;c!=null;){const g=c;n.right=g.left,g.left=n,n=g,c=n.right}return n}_delete(e){if(this.root==null||this.splay(e)!=0)return null;let c=this.root;const g=c,v=c.left;if(this.size--,v==null)this.root=c.right;else{const S=c.right;c=this.splayMax(v),c.right=S,this.root=c}return this.modificationCount++,g}addNewRoot(e,n){this.size++,this.modificationCount++;const c=this.root;if(c==null){this.root=e;return}n<0?(e.left=c,e.right=c.right,c.right=null):(e.right=c,e.left=c.left,c.left=null),this.root=e}_first(){const e=this.root;return e==null?null:(this.root=this.splayMin(e),this.root)}_last(){const e=this.root;return e==null?null:(this.root=this.splayMax(e),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(e){return this.validKey(e)&&this.splay(e)==0}defaultCompare(){return(e,n)=>e<n?-1:e>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:e=>{this.root=e},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:e=>{this.splayCount=e},splay:e=>this.splay(e),has:e=>this.has(e)}}}var mG;const Am=class Am extends gU{constructor(n,c){super();Lr(this,"root",null);Lr(this,"compare");Lr(this,"validKey");Lr(this,mG,"[object Set]");this.compare=n??this.defaultCompare(),this.validKey=c??(g=>g!=null&&g!=null)}delete(n){return this.validKey(n)?this._delete(n)!=null:!1}deleteAll(n){for(const c of n)this.delete(c)}forEach(n){const c=this[Symbol.iterator]();let g;for(;g=c.next(),!g.done;)n(g.value,g.value,this)}add(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new og(n),c),this}addAndReturn(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new og(n),c),this.root.key}addAll(n){for(const c of n)this.add(c)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)<0)return this.root.key;let g=this.root.left;if(g==null)return null;let v=g.right;for(;v!=null;)g=v,v=g.right;return g.key}firstAfter(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)>0)return this.root.key;let g=this.root.right;if(g==null)return null;let v=g.left;for(;v!=null;)g=v,v=g.left;return g.key}retainAll(n){const c=new Am(this.compare,this.validKey),g=this.modificationCount;for(const v of n){if(g!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(v)&&this.splay(v)==0&&c.add(this.root.key)}c.size!=this.size&&(this.root=c.root,this.size=c.size,this.modificationCount++)}lookup(n){return!this.validKey(n)||this.splay(n)!=0?null:this.root.key}intersection(n){const c=new Am(this.compare,this.validKey);for(const g of this)n.has(g)&&c.add(g);return c}difference(n){const c=new Am(this.compare,this.validKey);for(const g of this)n.has(g)||c.add(g);return c}union(n){const c=this.clone();return c.addAll(n),c}clone(){const n=new Am(this.compare,this.validKey);return n.size=this.size,n.root=this.copyNode(this.root),n}copyNode(n){if(n==null)return null;function c(v,S){let a,N;do{if(a=v.left,N=v.right,a!=null){const $=new og(a.key);S.left=$,c(a,$)}if(N!=null){const $=new og(N.key);S.right=$,v=N,S=$}}while(N!=null)}const g=new og(n.key);return c(n,g),g}toSet(){return this.clone()}entries(){return new yU(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new _U(this.wrap())}};mG=Symbol.toStringTag;let Tm=Am;class tI{constructor(e){Lr(this,"tree");Lr(this,"path",new Array);Lr(this,"modificationCount",null);Lr(this,"splayCount");this.tree=e,this.splayCount=e.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const e=this.path[this.path.length-1];return this.getValue(e)}rebuildPath(e){this.path.splice(0,this.path.length),this.tree.splay(e),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(e){for(;e!=null;)this.path.push(e),e=e.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let c=this.tree.getRoot();for(;c!=null;)this.path.push(c),c=c.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let e=this.path[this.path.length-1],n=e.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===e;)e=this.path.pop();return this.path.length>0}}class _U extends tI{getValue(e){return e.key}}class yU extends tI{getValue(e){return[e.key,e.key]}}const vU=t=>t,xU=t=>{if(t){const e=new Tm(Dv(t)),n=new Tm(Dv(t)),c=(v,S)=>S.addAndReturn(v),g=v=>({x:c(v.x,e),y:c(v.y,n)});return g({x:new ef(0),y:new ef(0)}),g}return vU},Lv=t=>({set:e=>{h0=Lv(e)},reset:()=>Lv(t),compare:Dv(t),snap:xU(t),orient:dU(t)});let h0=Lv();const lg=(t,e)=>t.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(t.ur.x)&&t.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(t.ur.y),Bv=(t,e)=>{if(e.ur.x.isLessThan(t.ll.x)||t.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(t.ll.y)||t.ur.y.isLessThan(e.ll.y))return null;const n=t.ll.x.isLessThan(e.ll.x)?e.ll.x:t.ll.x,c=t.ur.x.isLessThan(e.ur.x)?t.ur.x:e.ur.x,g=t.ll.y.isLessThan(e.ll.y)?e.ll.y:t.ll.y,v=t.ur.y.isLessThan(e.ur.y)?t.ur.y:e.ur.y;return{ll:{x:n,y:g},ur:{x:c,y:v}}},y_=(t,e)=>t.x.times(e.y).minus(t.y.times(e.x)),iI=(t,e)=>t.x.times(e.x).plus(t.y.times(e.y)),J_=t=>iI(t,t).sqrt(),bU=(t,e,n)=>{const c={x:e.x.minus(t.x),y:e.y.minus(t.y)},g={x:n.x.minus(t.x),y:n.y.minus(t.y)};return y_(g,c).div(J_(g)).div(J_(c))},wU=(t,e,n)=>{const c={x:e.x.minus(t.x),y:e.y.minus(t.y)},g={x:n.x.minus(t.x),y:n.y.minus(t.y)};return iI(g,c).div(J_(g)).div(J_(c))},Hw=(t,e,n)=>e.y.isZero()?null:{x:t.x.plus(e.x.div(e.y).times(n.minus(t.y))),y:n},jw=(t,e,n)=>e.x.isZero()?null:{x:n,y:t.y.plus(e.y.div(e.x).times(n.minus(t.x)))},SU=(t,e,n,c)=>{if(e.x.isZero())return jw(n,c,t.x);if(c.x.isZero())return jw(t,e,n.x);if(e.y.isZero())return Hw(n,c,t.y);if(c.y.isZero())return Hw(t,e,n.y);const g=y_(e,c);if(g.isZero())return null;const v={x:n.x.minus(t.x),y:n.y.minus(t.y)},S=y_(v,e).div(g),a=y_(v,c).div(g),N=t.x.plus(a.times(e.x)),$=n.x.plus(S.times(c.x)),he=t.y.plus(a.times(e.y)),oe=n.y.plus(S.times(c.y)),ce=N.plus($).div(2),_e=he.plus(oe).div(2);return{x:ce,y:_e}};class Oh{constructor(e,n){Lr(this,"point");Lr(this,"isLeft");Lr(this,"segment");Lr(this,"otherSE");Lr(this,"consumedBy");e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}static compare(e,n){const c=Oh.comparePoints(e.point,n.point);return c!==0?c:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:Z0.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x.isLessThan(n.x)?-1:e.x.isGreaterThan(n.x)?1:e.y.isLessThan(n.y)?-1:e.y.isGreaterThan(n.y)?1:0}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let c=0,g=n.length;c<g;c++){const v=n[c];this.point.events.push(v),v.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const c=this.point.events[n];if(c.segment.consumedBy===void 0)for(let g=n+1;g<e;g++){const v=this.point.events[g];v.consumedBy===void 0&&c.otherSE.point.events===v.otherSE.point.events&&c.segment.consume(v.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,c=this.point.events.length;n<c;n++){const g=this.point.events[n];g!==this&&!g.segment.ringOut&&g.segment.isInResult()&&e.push(g)}return e}getLeftmostComparator(e){const n=new Map,c=g=>{const v=g.otherSE;n.set(g,{sine:bU(this.point,e.point,v.point),cosine:wU(this.point,e.point,v.point)})};return(g,v)=>{n.has(g)||c(g),n.has(v)||c(v);const{sine:S,cosine:a}=n.get(g),{sine:N,cosine:$}=n.get(v);return S.isGreaterThanOrEqualTo(0)&&N.isGreaterThanOrEqualTo(0)?a.isLessThan($)?1:a.isGreaterThan($)?-1:0:S.isLessThan(0)&&N.isLessThan(0)?a.isLessThan($)?-1:a.isGreaterThan($)?1:0:N.isLessThan(S)?-1:N.isGreaterThan(S)?1:0}}}let IU=0;class Z0{constructor(e,n,c,g){Lr(this,"id");Lr(this,"leftSE");Lr(this,"rightSE");Lr(this,"rings");Lr(this,"windings");Lr(this,"ringOut");Lr(this,"consumedBy");Lr(this,"prev");Lr(this,"_prevInResult");Lr(this,"_beforeState");Lr(this,"_afterState");Lr(this,"_isInResult");this.id=++IU,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=c,this.windings=g}static compare(e,n){const c=e.leftSE.point.x,g=n.leftSE.point.x,v=e.rightSE.point.x,S=n.rightSE.point.x;if(S.isLessThan(c))return 1;if(v.isLessThan(g))return-1;const a=e.leftSE.point.y,N=n.leftSE.point.y,$=e.rightSE.point.y,he=n.rightSE.point.y;if(c.isLessThan(g)){if(N.isLessThan(a)&&N.isLessThan($))return 1;if(N.isGreaterThan(a)&&N.isGreaterThan($))return-1;const oe=e.comparePoint(n.leftSE.point);if(oe<0)return 1;if(oe>0)return-1;const ce=n.comparePoint(e.rightSE.point);return ce!==0?ce:-1}if(c.isGreaterThan(g)){if(a.isLessThan(N)&&a.isLessThan(he))return-1;if(a.isGreaterThan(N)&&a.isGreaterThan(he))return 1;const oe=n.comparePoint(e.leftSE.point);if(oe!==0)return oe;const ce=e.comparePoint(n.rightSE.point);return ce<0?1:ce>0?-1:1}if(a.isLessThan(N))return-1;if(a.isGreaterThan(N))return 1;if(v.isLessThan(S)){const oe=n.comparePoint(e.rightSE.point);if(oe!==0)return oe}if(v.isGreaterThan(S)){const oe=e.comparePoint(n.rightSE.point);if(oe<0)return 1;if(oe>0)return-1}if(!v.eq(S)){const oe=$.minus(a),ce=v.minus(c),_e=he.minus(N),Ze=S.minus(g);if(oe.isGreaterThan(ce)&&_e.isLessThan(Ze))return 1;if(oe.isLessThan(ce)&&_e.isGreaterThan(Ze))return-1}return v.isGreaterThan(S)?1:v.isLessThan(S)||$.isLessThan(he)?-1:$.isGreaterThan(he)?1:e.id<n.id?-1:e.id>n.id?1:0}static fromRing(e,n,c){let g,v,S;const a=Oh.comparePoints(e,n);if(a<0)g=e,v=n,S=1;else if(a>0)g=n,v=e,S=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const N=new Oh(g,!0),$=new Oh(v,!1);return new Z0(N,$,[c],[S])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e.isLessThan(n)?e:n},ur:{x:this.rightSE.point.x,y:e.isGreaterThan(n)?e:n}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(e){return e.x.eq(this.leftSE.point.x)&&e.y.eq(this.leftSE.point.y)||e.x.eq(this.rightSE.point.x)&&e.y.eq(this.rightSE.point.y)}comparePoint(e){return h0.orient(this.leftSE.point,e,this.rightSE.point)}getIntersection(e){const n=this.bbox(),c=e.bbox(),g=Bv(n,c);if(g===null)return null;const v=this.leftSE.point,S=this.rightSE.point,a=e.leftSE.point,N=e.rightSE.point,$=lg(n,a)&&this.comparePoint(a)===0,he=lg(c,v)&&e.comparePoint(v)===0,oe=lg(n,N)&&this.comparePoint(N)===0,ce=lg(c,S)&&e.comparePoint(S)===0;if(he&&$)return ce&&!oe?S:!ce&&oe?N:null;if(he)return oe&&v.x.eq(N.x)&&v.y.eq(N.y)?null:v;if($)return ce&&S.x.eq(a.x)&&S.y.eq(a.y)?null:a;if(ce&&oe)return null;if(ce)return S;if(oe)return N;const _e=SU(v,this.vector(),a,e.vector());return _e===null||!lg(g,_e)?null:h0.snap(_e)}split(e){const n=[],c=e.events!==void 0,g=new Oh(e,!0),v=new Oh(e,!1),S=this.rightSE;this.replaceRightSE(v),n.push(v),n.push(g);const a=new Z0(g,S,this.rings.slice(),this.windings.slice());return Oh.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Oh.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(g.checkForConsuming(),v.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,c=this.windings.length;n<c;n++)this.windings[n]*=-1}consume(e){let n=this,c=e;for(;n.consumedBy;)n=n.consumedBy;for(;c.consumedBy;)c=c.consumedBy;const g=Z0.compare(n,c);if(g!==0){if(g>0){const v=n;n=c,c=v}if(n.prev===c){const v=n;n=c,c=v}for(let v=0,S=c.rings.length;v<S;v++){const a=c.rings[v],N=c.windings[v],$=n.rings.indexOf(a);$===-1?(n.rings.push(a),n.windings.push(N)):n.windings[$]+=N}c.rings=null,c.windings=null,c.consumedBy=n,c.leftSE.consumedBy=n.leftSE,c.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,c=this._afterState.windings,g=this._afterState.multiPolys;for(let a=0,N=this.rings.length;a<N;a++){const $=this.rings[a],he=this.windings[a],oe=n.indexOf($);oe===-1?(n.push($),c.push(he)):c[oe]+=he}const v=[],S=[];for(let a=0,N=n.length;a<N;a++){if(c[a]===0)continue;const $=n[a],he=$.poly;if(S.indexOf(he)===-1)if($.isExterior)v.push(he);else{S.indexOf(he)===-1&&S.push(he);const oe=v.indexOf($.poly);oe!==-1&&v.splice(oe,1)}}for(let a=0,N=v.length;a<N;a++){const $=v[a].multiPoly;g.indexOf($)===-1&&g.push($)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(zv.type){case"union":{const c=e.length===0,g=n.length===0;this._isInResult=c!==g;break}case"intersection":{let c,g;e.length<n.length?(c=e.length,g=n.length):(c=n.length,g=e.length),this._isInResult=g===zv.numMultiPolys&&c<g;break}case"xor":{const c=Math.abs(e.length-n.length);this._isInResult=c%2===1;break}case"difference":{const c=g=>g.length===1&&g[0].isSubject;this._isInResult=c(e)!==c(n);break}}return this._isInResult}}class Zw{constructor(e,n,c){Lr(this,"poly");Lr(this,"isExterior");Lr(this,"segments");Lr(this,"bbox");if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=c,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const g=h0.snap({x:new ef(e[0][0]),y:new ef(e[0][1])});this.bbox={ll:{x:g.x,y:g.y},ur:{x:g.x,y:g.y}};let v=g;for(let S=1,a=e.length;S<a;S++){if(typeof e[S][0]!="number"||typeof e[S][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const N=h0.snap({x:new ef(e[S][0]),y:new ef(e[S][1])});N.x.eq(v.x)&&N.y.eq(v.y)||(this.segments.push(Z0.fromRing(v,N,this)),N.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=N.x),N.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=N.y),N.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=N.x),N.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=N.y),v=N)}(!g.x.eq(v.x)||!g.y.eq(v.y))&&this.segments.push(Z0.fromRing(v,g,this))}getSweepEvents(){const e=[];for(let n=0,c=this.segments.length;n<c;n++){const g=this.segments[n];e.push(g.leftSE),e.push(g.rightSE)}return e}}class EU{constructor(e,n){Lr(this,"multiPoly");Lr(this,"exteriorRing");Lr(this,"interiorRings");Lr(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Zw(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let c=1,g=e.length;c<g;c++){const v=new Zw(e[c],this,!1);v.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=v.bbox.ll.x),v.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=v.bbox.ll.y),v.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=v.bbox.ur.x),v.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=v.bbox.ur.y),this.interiorRings.push(v)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getSweepEvents();for(let v=0,S=g.length;v<S;v++)e.push(g[v])}return e}}class Qw{constructor(e,n){Lr(this,"isSubject");Lr(this,"polys");Lr(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new ef(Number.POSITIVE_INFINITY),y:new ef(Number.POSITIVE_INFINITY)},ur:{x:new ef(Number.NEGATIVE_INFINITY),y:new ef(Number.NEGATIVE_INFINITY)}};for(let c=0,g=e.length;c<g;c++){const v=new EU(e[c],this);v.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=v.bbox.ll.x),v.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=v.bbox.ll.y),v.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=v.bbox.ur.x),v.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=v.bbox.ur.y),this.polys.push(v)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getSweepEvents();for(let v=0,S=g.length;v<S;v++)e.push(g[v])}return e}}class e1{constructor(e){Lr(this,"events");Lr(this,"poly");Lr(this,"_isExteriorRing");Lr(this,"_enclosingRing");this.events=e;for(let n=0,c=e.length;n<c;n++)e[n].segment.ringOut=this;this.poly=null}static factory(e){const n=[];for(let c=0,g=e.length;c<g;c++){const v=e[c];if(!v.isInResult()||v.ringOut)continue;let S=null,a=v.leftSE,N=v.rightSE;const $=[a],he=a.point,oe=[];for(;S=a,a=N,$.push(a),a.point!==he;)for(;;){const ce=a.getAvailableLinkedEvents();if(ce.length===0){const nt=$[0].point,Ke=$[$.length-1].point;throw new Error(`Unable to complete output ring starting at [${nt.x}, ${nt.y}]. Last matching segment found ends at [${Ke.x}, ${Ke.y}].`)}if(ce.length===1){N=ce[0].otherSE;break}let _e=null;for(let nt=0,Ke=oe.length;nt<Ke;nt++)if(oe[nt].point===a.point){_e=nt;break}if(_e!==null){const nt=oe.splice(_e)[0],Ke=$.splice(nt.index);Ke.unshift(Ke[0].otherSE),n.push(new e1(Ke.reverse()));continue}oe.push({index:$.length,point:a.point});const Ze=a.getLeftmostComparator(S);N=ce.sort(Ze)[0].otherSE;break}n.push(new e1($))}return n}getGeom(){let e=this.events[0].point;const n=[e];for(let $=1,he=this.events.length-1;$<he;$++){const oe=this.events[$].point,ce=this.events[$+1].point;h0.orient(oe,e,ce)!==0&&(n.push(oe),e=oe)}if(n.length===1)return null;const c=n[0],g=n[1];h0.orient(c,e,g)===0&&n.shift(),n.push(n[0]);const v=this.isExteriorRing()?1:-1,S=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,N=[];for(let $=S;$!=a;$+=v)N.push([n[$].x.toNumber(),n[$].y.toNumber()]);return N}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var g,v;let e=this.events[0];for(let S=1,a=this.events.length;S<a;S++){const N=this.events[S];Oh.compare(e,N)>0&&(e=N)}let n=e.segment.prevInResult(),c=n?n.prevInResult():null;for(;;){if(!n)return null;if(!c)return n.ringOut;if(c.ringOut!==n.ringOut)return((g=c.ringOut)==null?void 0:g.enclosingRing())!==n.ringOut?n.ringOut:(v=n.ringOut)==null?void 0:v.enclosingRing();n=c.prevInResult(),c=n?n.prevInResult():null}}}class Ww{constructor(e){Lr(this,"exteriorRing");Lr(this,"interiorRings");this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getGeom();g!==null&&e.push(g)}return e}}class CU{constructor(e){Lr(this,"rings");Lr(this,"polys");this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getGeom();g!==null&&e.push(g)}return e}_composePolys(e){var c;const n=[];for(let g=0,v=e.length;g<v;g++){const S=e[g];if(!S.poly)if(S.isExteriorRing())n.push(new Ww(S));else{const a=S.enclosingRing();a!=null&&a.poly||n.push(new Ww(a)),(c=a==null?void 0:a.poly)==null||c.addInterior(S)}}return n}}class TU{constructor(e,n=Z0.compare){Lr(this,"queue");Lr(this,"tree");Lr(this,"segments");this.queue=e,this.tree=new Tm(n),this.segments=[]}process(e){const n=e.segment,c=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(n),c;e.isLeft&&this.tree.add(n);let g=n,v=n;do g=this.tree.lastBefore(g);while(g!=null&&g.consumedBy!=null);do v=this.tree.firstAfter(v);while(v!=null&&v.consumedBy!=null);if(e.isLeft){let S=null;if(g){const N=g.getIntersection(n);if(N!==null&&(n.isAnEndpoint(N)||(S=N),!g.isAnEndpoint(N))){const $=this._splitSafely(g,N);for(let he=0,oe=$.length;he<oe;he++)c.push($[he])}}let a=null;if(v){const N=v.getIntersection(n);if(N!==null&&(n.isAnEndpoint(N)||(a=N),!v.isAnEndpoint(N))){const $=this._splitSafely(v,N);for(let he=0,oe=$.length;he<oe;he++)c.push($[he])}}if(S!==null||a!==null){let N=null;S===null?N=a:a===null?N=S:N=Oh.comparePoints(S,a)<=0?S:a,this.queue.delete(n.rightSE),c.push(n.rightSE);const $=n.split(N);for(let he=0,oe=$.length;he<oe;he++)c.push($[he])}c.length>0?(this.tree.delete(n),c.push(e)):(this.segments.push(n),n.prev=g)}else{if(g&&v){const S=g.getIntersection(v);if(S!==null){if(!g.isAnEndpoint(S)){const a=this._splitSafely(g,S);for(let N=0,$=a.length;N<$;N++)c.push(a[N])}if(!v.isAnEndpoint(S)){const a=this._splitSafely(v,S);for(let N=0,$=a.length;N<$;N++)c.push(a[N])}}}this.tree.delete(n)}return c}_splitSafely(e,n){this.tree.delete(e);const c=e.rightSE;this.queue.delete(c);const g=e.split(n);return g.push(c),e.consumedBy===void 0&&this.tree.add(e),g}}class kU{constructor(){Lr(this,"type");Lr(this,"numMultiPolys")}run(e,n,c){gg.type=e;const g=[new Qw(n,!0)];for(let he=0,oe=c.length;he<oe;he++)g.push(new Qw(c[he],!1));if(gg.numMultiPolys=g.length,gg.type==="difference"){const he=g[0];let oe=1;for(;oe<g.length;)Bv(g[oe].bbox,he.bbox)!==null?oe++:g.splice(oe,1)}if(gg.type==="intersection")for(let he=0,oe=g.length;he<oe;he++){const ce=g[he];for(let _e=he+1,Ze=g.length;_e<Ze;_e++)if(Bv(ce.bbox,g[_e].bbox)===null)return[]}const v=new Tm(Oh.compare);for(let he=0,oe=g.length;he<oe;he++){const ce=g[he].getSweepEvents();for(let _e=0,Ze=ce.length;_e<Ze;_e++)v.add(ce[_e])}const S=new TU(v);let a=null;for(v.size!=0&&(a=v.first(),v.delete(a));a;){const he=S.process(a);for(let oe=0,ce=he.length;oe<ce;oe++){const _e=he[oe];_e.consumedBy===void 0&&v.add(_e)}v.size!=0?(a=v.first(),v.delete(a)):a=null}h0.reset();const N=e1.factory(S.segments);return new CU(N).getGeom()}}const gg=new kU,zv=gg,MU=(t,...e)=>zv.run("intersection",t,e);h0.set;var PU={exports:{}},gy,$w;function DU(){return $w||($w=1,gy=function(e){return function n(c){return arguments.length===0||c!=null&&c["@@functional/placeholder"]===!0?n:e.apply(this,arguments)}}),gy}var _y,Xw;function LU(){if(Xw)return _y;Xw=1;var t=DU();return _y=t(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),_y}var yy,Yw;function R2(){if(Yw)return yy;Yw=1;function t(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}return yy=t,yy}var vy,Kw;function BU(){if(Kw)return vy;Kw=1;var t=R2();function e(n){return t(n)?n:Object(n)}return vy=e,vy}var xy,Jw;function zU(){if(Jw)return xy;Jw=1;var t=BU();function e(n){return function(c,g,v){for(var S=t(c),a=v(c),N=a.length,$=n?N:-1;n?$--:++$<N;){var he=a[$];if(g(S[he],he,S)===!1)break}return c}}return xy=e,xy}var by,e3;function RU(){if(e3)return by;e3=1;var t=zU(),e=t();return by=e,by}var wy,t3;function FU(){if(t3)return wy;t3=1;function t(e){return function(n){return n==null?void 0:n[e]}}return wy=t,wy}var Sy,i3;function OU(){if(i3)return Sy;i3=1;var t=FU(),e=t("length");return Sy=e,Sy}var Iy,n3;function F2(){if(n3)return Iy;n3=1;var t=9007199254740991;function e(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=t}return Iy=e,Iy}var Ey,r3;function NU(){if(r3)return Ey;r3=1;var t=OU(),e=F2();function n(c){return c!=null&&e(t(c))}return Ey=n,Ey}var Cy,s3;function I1(){if(s3)return Cy;s3=1;function t(e){return!!e&&typeof e=="object"}return Cy=t,Cy}var Ty,a3;function nI(){if(a3)return Ty;a3=1;var t=NU(),e=I1(),n=Object.prototype,c=n.hasOwnProperty,g=n.propertyIsEnumerable;function v(S){return e(S)&&t(S)&&c.call(S,"callee")&&!g.call(S,"callee")}return Ty=v,Ty}var ky,o3;function VU(){if(o3)return ky;o3=1;var t=R2(),e="[object Function]",n=Object.prototype,c=n.toString;function g(v){return t(v)&&c.call(v)==e}return ky=g,ky}var My,l3;function UU(){if(l3)return My;l3=1;var t=VU(),e=I1(),n=/^\[object .+?Constructor\]$/,c=Object.prototype,g=Function.prototype.toString,v=c.hasOwnProperty,S=RegExp("^"+g.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function a(N){return N==null?!1:t(N)?S.test(g.call(N)):e(N)&&n.test(N)}return My=a,My}var Py,u3;function GU(){if(u3)return Py;u3=1;var t=UU();function e(n,c){var g=n==null?void 0:n[c];return t(g)?g:void 0}return Py=e,Py}var Dy,c3;function qU(){if(c3)return Dy;c3=1;var t=GU(),e=F2(),n=I1(),c="[object Array]",g=Object.prototype,v=g.toString,S=t(Array,"isArray"),a=S||function(N){return n(N)&&e(N.length)&&v.call(N)==c};return Dy=a,Dy}var Ly,h3;function HU(){if(h3)return Ly;h3=1;var t=/^\d+$/,e=9007199254740991;function n(c,g){return c=typeof c=="number"||t.test(c)?+c:-1,g=g??e,c>-1&&c%1==0&&c<g}return Ly=n,Ly}var By,A3;function jU(){if(A3)return By;A3=1;var t=nI(),e=qU(),n=HU(),c=F2(),g=R2(),v=Object.prototype,S=v.hasOwnProperty;function a(N){if(N==null)return[];g(N)||(N=Object(N));var $=N.length;$=$&&c($)&&(e(N)||t(N))&&$||0;for(var he=N.constructor,oe=-1,ce=typeof he=="function"&&he.prototype===N,_e=Array($),Ze=$>0;++oe<$;)_e[oe]=oe+"";for(var nt in N)!(Ze&&n(nt,$))&&!(nt=="constructor"&&(ce||!S.call(N,nt)))&&_e.push(nt);return _e}return By=a,By}var zy,f3;function ZU(){if(f3)return zy;f3=1;var t=RU(),e=jU();function n(c,g){return t(c,g,e)}return zy=n,zy}var Ry,d3;function QU(){if(d3)return Ry;d3=1;var t=ZU(),e=nI(),n=I1(),c="[object Object]",g=Object.prototype,v=g.hasOwnProperty,S=g.toString;function a(N){var $;if(!(n(N)&&S.call(N)==c&&!e(N))||!v.call(N,"constructor")&&($=N.constructor,typeof $=="function"&&!($ instanceof $)))return!1;var he;return t(N,function(oe,ce){he=ce}),he===void 0||v.call(N,he)}return Ry=a,Ry}(function(t){t.exports=function(e){var n={};function c(g){if(n[g])return n[g].exports;var v=n[g]={exports:{},id:g,loaded:!1};return e[g].call(v.exports,v,v.exports,c),v.loaded=!0,v.exports}return c.m=e,c.c=n,c.p="/lib/",c(0)}([function(e,n,c){e.exports=c(1)},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.union=c(2).default,n.any=c(12).default,n.nil=c(14).default,n.mapOf=c(16).default,n.arrayOf=c(18).default,n.record=c(20).default,n.optional=c(23).default,n.validate=c(25).default,n.deferred=c(26).default,n.createValidator=c(4).default,n.isValid=c(28).default},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(3),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(){for(var N=arguments.length,$=Array(N),he=0;he<N;he++)$[he]=arguments[he];return new v.default($)}},function(e,n,c){var g=function(){function he(oe,ce){for(var _e=0;_e<ce.length;_e++){var Ze=ce[_e];Ze.enumerable=Ze.enumerable||!1,Ze.configurable=!0,"value"in Ze&&(Ze.writable=!0),Object.defineProperty(oe,Ze.key,Ze)}}return function(oe,ce,_e){return ce&&he(oe.prototype,ce),_e&&he(oe,_e),oe}}();Object.defineProperty(n,"__esModule",{value:!0});var v=c(4),S=a(v);c(5),c(6);function a(he){return he&&he.__esModule?he:{default:he}}function N(he,oe){if(!(he instanceof oe))throw new TypeError("Cannot call a class as a function")}var $=function(){function he(oe){N(this,he),this.validators=[];var ce=!0,_e=!1,Ze=void 0;try{for(var nt=oe[Symbol.iterator](),Ke;!(ce=(Ke=nt.next()).done);ce=!0){var st=Ke.value;this.validators.push((0,S.default)(st))}}catch(ht){_e=!0,Ze=ht}finally{try{!ce&&nt.return&&nt.return()}finally{if(_e)throw Ze}}}return g(he,[{key:"isValid",value:function(ce){var _e=!0,Ze=!1,nt=void 0;try{for(var Ke=this.validators[Symbol.iterator](),st;!(_e=(st=Ke.next()).done);_e=!0){var ht=st.value;if(ht.isValid(ce))return!0}}catch(xt){Ze=!0,nt=xt}finally{try{!_e&&Ke.return&&Ke.return()}finally{if(Ze)throw nt}}return!1}},{key:"getValidationResult",value:function(ce){if(this.isValid(ce))return{isValid:"true"};var _e=this._getValidationDetails(ce);return{isValid:"false",message:`Value doesn't match any of the expected variants.
Value: `+JSON.stringify(ce)+`
Details: 
`+_e.message,score:_e.score}}},{key:"_getValidationDetails",value:function(ce){var _e=[],Ze=!0,nt=!1,Ke=void 0;try{for(var st=this.validators[Symbol.iterator](),ht;!(Ze=(ht=st.next()).done);Ze=!0){var xt=ht.value;_e.push(xt.getValidationResult(ce))}}catch(Mt){nt=!0,Ke=Mt}finally{try{!Ze&&st.return&&st.return()}finally{if(nt)throw Ke}}_e.sort(function(Mt,Ue){return Mt.score<Ue.score?1:Mt.score>Ue.score?-1:0}),_e.length>3&&(_e.length=3);var zt=_e.map(function(Mt){return Mt.message}).join(`
`);return{message:zt,score:_e[0].score}}}]),he}();n.default=$},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=nt,c(5);var g=c(7),v=_e(g),S=c(9),a=_e(S),N=c(10),$=_e(N),he=c(3);_e(he);var oe=c(11),ce=_e(oe);function _e(Ke){return Ke&&Ke.__esModule?Ke:{default:Ke}}function Ze(Ke){return Ke&&typeof Symbol<"u"&&Ke.constructor===Symbol?"symbol":typeof Ke}function nt(Ke){if(Ke==null)throw Error("Null cannot be a valid validation descriptor");if(Ke===String)return v.default;if(Ke===Number)return a.default;if(Ke===Boolean)return $.default;if((typeof Ke>"u"?"undefined":Ze(Ke))==="object"&&Ke&&typeof Ke.isValid=="function"&&typeof Ke.getValidationResult=="function")return Ke;if(typeof Ke=="string"||typeof Ke=="number"||typeof Ke=="boolean")return new ce.default(Ke);throw new Error("Can't recognize this descriptor: "+Ke)}},function(e,n,c){c(6)},function(e,n){},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),v=S(g);c(6),c(5);function S(N){return N&&N.__esModule?N:{default:N}}var a={isValid:function($){return typeof $=="string"},getValidationResult:function($){return a.isValid($)?{isValid:"true"}:{isValid:"false",message:"String expected, "+(0,v.default)($)+" given.",score:0}}};n.default=a},function(e,n){e.exports=LU()},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),v=S(g);c(6),c(5);function S(N){return N&&N.__esModule?N:{default:N}}var a={isValid:function($){return typeof $=="number"},getValidationResult:function($){return a.isValid($)?{isValid:"true"}:{isValid:"false",message:"Number expected. '"+(0,v.default)($)+"' given.",score:0}}};n.default=a},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),v=S(g);c(6),c(5);function S(N){return N&&N.__esModule?N:{default:N}}var a={isValid:function($){return typeof $=="boolean"},getValidationResult:function($){return a.isValid($)?{isValid:"true"}:{isValid:"false",message:"Boolean expected. "+(0,v.default)($)+" given.",score:0}}};n.default=a},function(e,n,c){var g=function(){function $(he,oe){for(var ce=0;ce<oe.length;ce++){var _e=oe[ce];_e.enumerable=_e.enumerable||!1,_e.configurable=!0,"value"in _e&&(_e.writable=!0),Object.defineProperty(he,_e.key,_e)}}return function(he,oe,ce){return oe&&$(he.prototype,oe),ce&&$(he,ce),he}}();Object.defineProperty(n,"__esModule",{value:!0});var v=c(4);S(v),c(5),c(6);function S($){return $&&$.__esModule?$:{default:$}}function a($,he){if(!($ instanceof he))throw new TypeError("Cannot call a class as a function")}var N=function(){function $(he){a(this,$),this.expectedValue=he}return g($,[{key:"isValid",value:function(oe){return oe===this.expectedValue}},{key:"getValidationResult",value:function(oe){return this.isValid(oe)?{isValid:"true"}:{isValid:"false",message:"Expected: "+JSON.stringify(this.expectedValue)+". Given: "+oe,score:0}}}]),$}();n.default=N},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(13),v=S(g);function S(a){return a&&a.__esModule?a:{default:a}}n.default=v.default},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8);v(g),c(6),c(5);function v(a){return a&&a.__esModule?a:{default:a}}var S={isValid:function(N){return!0},getValidationResult:function(N){return{isValid:"true"}}};n.default=S},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(15),v=S(g);function S(a){return a&&a.__esModule?a:{default:a}}n.default=v.default},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),v=S(g);c(6),c(5);function S(N){return N&&N.__esModule?N:{default:N}}var a={isValid:function($){return $==null},getValidationResult:function($){return a.isValid($)?{isValid:"true"}:{isValid:"false",message:"Null expected. "+(0,v.default)($)+" given.",score:0}}};n.default=a},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(17),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(N){return new v.default(N)}},function(e,n,c){var g=function(){function _e(Ze,nt){for(var Ke=0;Ke<nt.length;Ke++){var st=nt[Ke];st.enumerable=st.enumerable||!1,st.configurable=!0,"value"in st&&(st.writable=!0),Object.defineProperty(Ze,st.key,st)}}return function(Ze,nt,Ke){return nt&&_e(Ze.prototype,nt),Ke&&_e(Ze,Ke),Ze}}();Object.defineProperty(n,"__esModule",{value:!0});var v=c(8),S=$(v),a=c(4),N=$(a);c(6),c(5);function $(_e){return _e&&_e.__esModule?_e:{default:_e}}function he(_e,Ze){if(!(_e instanceof Ze))throw new TypeError("Cannot call a class as a function")}function oe(_e){return _e&&typeof Symbol<"u"&&_e.constructor===Symbol?"symbol":typeof _e}var ce=function(){function _e(Ze){he(this,_e),this.validator=(0,N.default)(Ze)}return g(_e,[{key:"isValid",value:function(nt){if(!((typeof nt>"u"?"undefined":oe(nt))==="object"&&nt))return!1;var Ke=Object.keys(nt),st=!0,ht=!1,xt=void 0;try{for(var zt=Ke[Symbol.iterator](),Mt;!(st=(Mt=zt.next()).done);st=!0){var Ue=Mt.value,$t=nt[Ue];if(this.validator.isValid($t)===!1)return!1}}catch(rt){ht=!0,xt=rt}finally{try{!st&&zt.return&&zt.return()}finally{if(ht)throw xt}}return!0}},{key:"getValidationResult",value:function(nt){if(!((typeof nt>"u"?"undefined":oe(nt))==="object"&&nt))return{isValid:"false",message:"Object expected. "+(0,S.default)(nt)+" given.",score:0};var Ke=Object.keys(nt),st=!0,ht=!1,xt=void 0;try{for(var zt=Ke[Symbol.iterator](),Mt;!(st=(Mt=zt.next()).done);st=!0){var Ue=Mt.value,$t=nt[Ue],rt=this.validator.getValidationResult($t);if(rt.isValid==="false")return{isValid:"false",message:"Validation failed for key '"+Ue+"': "+rt.message,score:1}}}catch(gt){ht=!0,xt=gt}finally{try{!st&&zt.return&&zt.return()}finally{if(ht)throw xt}}return{isValid:"true"}}}]),_e}();n.default=ce},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(19),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(N){return new v.default(N)}},function(e,n,c){var g=function(){function ce(_e,Ze){for(var nt=0;nt<Ze.length;nt++){var Ke=Ze[nt];Ke.enumerable=Ke.enumerable||!1,Ke.configurable=!0,"value"in Ke&&(Ke.writable=!0),Object.defineProperty(_e,Ke.key,Ke)}}return function(_e,Ze,nt){return Ze&&ce(_e.prototype,Ze),nt&&ce(_e,nt),_e}}();Object.defineProperty(n,"__esModule",{value:!0});var v=c(8),S=$(v),a=c(4),N=$(a);c(6),c(5);function $(ce){return ce&&ce.__esModule?ce:{default:ce}}function he(ce,_e){if(!(ce instanceof _e))throw new TypeError("Cannot call a class as a function")}var oe=function(){function ce(_e){he(this,ce),this.validator=(0,N.default)(_e)}return g(ce,[{key:"isValid",value:function(Ze){if(!Array.isArray(Ze))return!1;var nt=!0,Ke=!1,st=void 0;try{for(var ht=Ze[Symbol.iterator](),xt;!(nt=(xt=ht.next()).done);nt=!0){var zt=xt.value;if(this.validator.isValid(zt)===!1)return!1}}catch(Mt){Ke=!0,st=Mt}finally{try{!nt&&ht.return&&ht.return()}finally{if(Ke)throw st}}return!0}},{key:"getValidationResult",value:function(Ze){if(!Array.isArray(Ze))return{isValid:"false",message:"Array expected. "+(0,S.default)(Ze)+" given.",score:0};for(var nt=0;nt<Ze.length;nt++){var Ke=Ze[nt],st=this.validator.getValidationResult(Ke);if(st.isValid==="false")return{isValid:"false",message:"Validation failed on item #"+nt+": "+st.message,score:1}}return{isValid:"true"}}}]),ce}();n.default=oe},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(21),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(N){return new v.default(N)}},function(e,n,c){var g=function(){function nt(Ke,st){for(var ht=0;ht<st.length;ht++){var xt=st[ht];xt.enumerable=xt.enumerable||!1,xt.configurable=!0,"value"in xt&&(xt.writable=!0),Object.defineProperty(Ke,xt.key,xt)}}return function(Ke,st,ht){return st&&nt(Ke.prototype,st),ht&&nt(Ke,ht),Ke}}();Object.defineProperty(n,"__esModule",{value:!0});var v=c(8),S=oe(v),a=c(22),N=oe(a),$=c(4),he=oe($);c(5),c(6);function oe(nt){return nt&&nt.__esModule?nt:{default:nt}}function ce(nt,Ke){if(!(nt instanceof Ke))throw new TypeError("Cannot call a class as a function")}function _e(nt){return nt&&typeof Symbol<"u"&&nt.constructor===Symbol?"symbol":typeof nt}var Ze=function(){function nt(Ke){if(ce(this,nt),!((typeof Ke>"u"?"undefined":_e(Ke))==="object"&&Ke&&(0,N.default)(Ke)))throw Error("A record must be defined by an object.");this.shape={};var st=!0,ht=!1,xt=void 0;try{for(var zt=Object.getOwnPropertyNames(Ke)[Symbol.iterator](),Mt;!(st=(Mt=zt.next()).done);st=!0){var Ue=Mt.value;try{this.shape[Ue]=(0,he.default)(Ke[Ue])}catch(gt){var $t=Ue,rt=gt.stack;throw gt.originalStack?(rt=gt.originalStack,$t+="."+gt.propertyName,gt.propertyName=$t):gt.originalStack=gt.stack,gt.stack="Error defining prop '"+$t+"': "+gt.originalStack,gt}}}catch(gt){ht=!0,xt=gt}finally{try{!st&&zt.return&&zt.return()}finally{if(ht)throw xt}}}return g(nt,[{key:"isValid",value:function(st){if(!((typeof st>"u"?"undefined":_e(st))==="object"&&st))return!1;var ht=!0,xt=!1,zt=void 0;try{for(var Mt=Object.keys(this.shape)[Symbol.iterator](),Ue;!(ht=(Ue=Mt.next()).done);ht=!0){var $t=Ue.value,rt=this.shape[$t];if(rt.isValid(st[$t])===!1)return!1}}catch(gt){xt=!0,zt=gt}finally{try{!ht&&Mt.return&&Mt.return()}finally{if(xt)throw zt}}return!0}},{key:"getValidationResult",value:function(st){if(!((typeof st>"u"?"undefined":_e(st))==="object"&&st))return{isValid:"false",message:"Object expected, "+(0,S.default)(st)+" given.",score:0};var ht=0,xt=!0,zt=!1,Mt=void 0;try{for(var Ue=Object.keys(this.shape)[Symbol.iterator](),$t;!(xt=($t=Ue.next()).done);xt=!0){var rt=$t.value,gt=this.shape[rt],At=gt.getValidationResult(st[rt]);if(At.isValid==="false")return{isValid:"false",message:"Error validating prop "+rt+`:
 `+At.message,score:1+ht};ht++}}catch(yt){zt=!0,Mt=yt}finally{try{!xt&&Ue.return&&Ue.return()}finally{if(zt)throw Mt}}return{isValid:"true"}}}]),nt}();n.default=Ze},function(e,n){e.exports=QU()},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(24),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(N){return new v.default(N)}},function(e,n,c){var g=function(){function he(oe,ce){for(var _e=0;_e<ce.length;_e++){var Ze=ce[_e];Ze.enumerable=Ze.enumerable||!1,Ze.configurable=!0,"value"in Ze&&(Ze.writable=!0),Object.defineProperty(oe,Ze.key,Ze)}}return function(oe,ce,_e){return ce&&he(oe.prototype,ce),_e&&he(oe,_e),oe}}();Object.defineProperty(n,"__esModule",{value:!0});var v=c(4),S=a(v);c(6),c(5);function a(he){return he&&he.__esModule?he:{default:he}}function N(he,oe){if(!(he instanceof oe))throw new TypeError("Cannot call a class as a function")}var $=function(){function he(oe){N(this,he),this.validator=(0,S.default)(oe)}return g(he,[{key:"isValid",value:function(ce){return ce?this.validator.isValid(ce):!0}},{key:"getValidationResult",value:function(ce){return ce?this.validator.getValidationResult(ce):{isValid:"true"}}}]),he}();n.default=$},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(N,$){var he=(0,v.default)(N),oe=he.getValidationResult($);if(oe.isValid==="false")throw Error(oe.message);return $}},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(27),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(N){return new v.default(N)}},function(e,n,c){var g=function(){function oe(ce,_e){for(var Ze=0;Ze<_e.length;Ze++){var nt=_e[Ze];nt.enumerable=nt.enumerable||!1,nt.configurable=!0,"value"in nt&&(nt.writable=!0),Object.defineProperty(ce,nt.key,nt)}}return function(ce,_e,Ze){return _e&&oe(ce.prototype,_e),Ze&&oe(ce,Ze),ce}}();Object.defineProperty(n,"__esModule",{value:!0});var v=c(8),S=N(v),a=c(4);N(a),c(6),c(5);function N(oe){return oe&&oe.__esModule?oe:{default:oe}}function $(oe,ce){if(!(oe instanceof ce))throw new TypeError("Cannot call a class as a function")}var he=function(){function oe(ce){if($(this,oe),typeof ce!="function")throw Error("Deferred validator only accepts a function. "+(0,S.default)(ce)+" given");this.deferredValidator=ce}return g(oe,[{key:"isValid",value:function(_e){return this._getValidator().isValid(_e)}},{key:"getValidationResult",value:function(_e){return this._getValidator().getValidationResult(_e)}},{key:"_getValidator",value:function(){return this.validator||(this.validator=this.deferredValidator()),this.validator}}]),oe}();n.default=he},function(e,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),v=S(g);function S(N){return N&&N.__esModule?N:{default:N}}function a(N,$){var he=(0,v.default)(N);return he.isValid($)}}])})(PU);function WU(t){let e,n,c,g=`<svg class="marker-svg" id="Layer_2" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70.46 62.88"><defs><style>.fill {
                fill: #000;
                stroke: solid 1px red;
            }
            .stroke {
                stroke: #fff;
            }
        </style></defs><g id="Layer_1-2" data-name="Layer 1"><g><path class="fill" d="m35.23,60.88c-1.81,0-3.43-.93-4.33-2.5L2.68,9.5c-.9-1.57-.9-3.44,0-5,.9-1.57,2.52-2.5,4.33-2.5h56.44c1.81,0,3.43.93,4.33,2.5.9,1.56.9,3.43,0,5l-28.22,48.88c-.9,1.57-2.52,2.5-4.33,2.5Z"></path><path d="m63.45,4c1.56,0,2.34,1.05,2.6,1.5.26.45.78,1.65,0,3l-28.22,48.88c-.78,1.35-2.08,1.5-2.6,1.5s-1.82-.15-2.6-1.5L4.41,8.5c-.78-1.35-.26-2.55,0-3,.26-.45,1.03-1.5,2.6-1.5h56.44m0-4H7.01C1.62,0-1.75,5.83.95,10.5l28.22,48.88c1.35,2.33,3.7,3.5,6.06,3.5s4.72-1.17,6.06-3.5l28.22-48.88c2.69-4.67-.67-10.5-6.06-10.5h0Z"></path></g></g></svg>`;return{c(){e=Pn("div"),n=_r(),c=Pn("div"),c.innerHTML=g,this.h()},l(v){e=Dn(v,"DIV",{id:!0,class:!0}),rn(e).forEach(Ai),n=yr(v),c=Dn(v,"DIV",{id:!0,class:!0,style:!0,"data-svelte-h":!0}),$u(c)!=="svelte-1sgleu8"&&(c.innerHTML=g),this.h()},h(){_i(e,"id","map"),_i(e,"class","map"),_i(c,"id","marker-template"),_i(c,"class","hex-marker"),Fy(c,"display","none")},m(v,S){yn(v,e,S),yn(v,n,S),yn(v,c,S)},p:Ra,i:Ra,o:Ra,d(v){v&&(Ai(e),Ai(n),Ai(c))}}}let p3=6;const $U=500;let XU=!1;function YU(t,e,n){let c,g,v,S,a,N,$;Il(t,rm,Ot=>n(11,c=Ot)),Il(t,IT,Ot=>n(26,g=Ot)),Il(t,Vy,Ot=>n(12,v=Ot)),Il(t,ip,Ot=>n(13,S=Ot)),Il(t,cg,Ot=>n(27,a=Ot)),Il(t,vg,Ot=>n(14,N=Ot)),Il(t,t1,Ot=>n(15,$=Ot));const he=[-119.449444,37.166111];let{metric:oe}=e,{colorScheme:ce}=e,{showCounties:_e}=e,{showEcoregions:Ze}=e,{drawnPath:nt}=e,{clade:Ke}=e,{clades:st}=e,{finishBuilding:ht}=e;const xt=[-124.40971816218747,32.534154544948464,-114.13120909272375,42.009518182466415];let zt,Mt,Ue,$t=!1,rt=[-119.449444,37.166111],gt={hex:{},eco:{}},At={hex:{},eco:{}};function yt(Ot){if(!c.getStyle)return;console.log(c.getStyle().layers);let an=c.getStyle().layers.filter($n=>{var Yi;let oi=(Yi=$n.source)==null?void 0:Yi.split("-");return oi&&oi[1]!==Ot});for(let $n of an)c.setPaintProperty($n.id,"fill-opacity",0)}function St(Ot){$t=Ot!==null,Ue&&(console.log("SHOW?",$t),$t?Ue.addTo(c):Ue.remove())}async function ut(Ot){if(!Ni||!c.getLayer)return;if(Ot===null){c.getLayer("drawLayer")&&c.removeLayer("drawnPolygon"),c.getSource("drawnPolygon")&&c.removeSource("drawnPolygon");return}console.log(c.transform),console.log(Ot[0]),console.log(c.transform.pointLocation({x:10,y:10})),console.log(c.transform.pointLocation(Ot[0]));let an=[];for(let Wn of Ot){let _n=c.transform.pointLocation(Wn);an.push([_n.lat,_n.lng])}let $n=lU(an,p3),oi=TV.h3SetToMultiPolygonFeature($n);console.log(oi),console.log(Ni);let Yi=fU(Ni);console.log(Yi),console.log(oi.geometry),console.log(Yi.features[0].geometry);let Xn=MU(oi.geometry.coordinates,Yi.features[0].geometry.coordinates);console.log(Xn);let zn={type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:Xn}};c.addSource("drawnPolygon",{type:"geojson",data:zn}),c.addLayer({id:"drawLayer",type:"fill",source:"drawnPolygon",layout:{},paint:{"fill-color":"#00ffff","fill-opacity":v,"fill-color-transition":{duration:500,delay:0}}},Mt)}function Ye(Ot,an,$n=N){if(console.log(Ot),!c.moveLayer)return;let oi=`${$n}-${Ot}-${an}`;console.log(oi),c.moveLayer(oi,"place_hamlet"),setTimeout(()=>{ct([oi])},$U/4),c.setPaintProperty(oi,"fill-opacity",v),j0(cg,a=c.getPaintProperty(oi,"fill-color"),a)}const _t=["ecoregions-fill","ecoregions-line"];function ct(Ot=[]){if(!c.getStyle)return;let an=c.getStyle().layers.filter($n=>{var oi,Yi;return(((oi=$n.source)==null?void 0:oi.includes("ecolayer"))||((Yi=$n.source)==null?void 0:Yi.includes("hexlayer")))&&!(Ot.includes($n.id)||_t.includes($n.id))});console.log(an);for(let $n of an)c.setPaintProperty($n.id,"fill-opacity",0)}function Ut(Ot){if(!c.getStyle)return;let an=c.getStyle().layers.filter($n=>{var oi;return((oi=$n.source)==null?void 0:oi.includes(`${N}layer`))&&!_t.includes($n.id)});for(let $n of an){let oi=$n.id.split("-")[1],Yi=Gi(oi,Ot,!0);console.log("palette:",Yi),c.setPaintProperty($n.id,"fill-color",Yi),j0(cg,a=Yi,a),console.log($n.id,c.getPaintProperty($n.id,"fill-color"))}}function Ft(){Ye(oe,Ke),Ut(ce)}function Vt(Ot){c.setPaintProperty&&(Ot?c.setPaintProperty("counties","line-opacity",g):c.setPaintProperty("counties","line-opacity",0))}function yi(Ot){c.setPaintProperty&&(console.log("ecoregions",Ot),Ot?(c.setPaintProperty("ecoregions-line","line-opacity",g),c.setPaintProperty("ecoregions-fill","fill-opacity",v)):(c.setPaintProperty("ecoregions-line","line-opacity",0),c.setPaintProperty("ecoregions-fill","fill-opacity",0)))}function Ci(Ot){Ot?(c.setPaintProperty("california-line","line-opacity",g),c.setPaintProperty("california-fill","fill-opacity",v)):(c.setPaintProperty("california-line","line-opacity",0),c.setPaintProperty("california-fill","fill-opacity",0))}let ki,Ni,tn=b_(0,5e3,ce),Zi;function Gi(Ot,an,$n=!0){if(!(!gt||!At))if(console.log("generating for ",Ot,"interpolate: ",$n),$n){tn=b_(At[N][Ot],gt[N][Ot],an),Ot==="quartile"&&(tn=bT(an)),console.log(tn),tn.length;let oi=tn.map((Xn,zn)=>[Xn[0],Xn[1]]);oi=oi.flat(),console.log(oi);let Yi=["interpolate",["linear"],["get",Ot],...oi];return a||cg.set(Yi),Yi}else return["step",["get",Ot],"#ff00ff",-1,"#0000ff",0,"#ffffff",1,"#FF7F11"]}async function sn(Ot){var oi,Yi;gt.eco=(oi=Zi.properties)==null?void 0:oi.maxes,At.eco=(Yi=Zi.properties)==null?void 0:Yi.mins;let $n=c.getStyle().layers[71].id;for(let Xn of dm){let zn=`eco-${Xn}-${Ot}`;c.addLayer({id:zn,type:"fill",source:"ecolayer",layout:{},paint:{"fill-color":Gi(Xn,ce,!0),"fill-opacity":v,"fill-color-transition":{duration:500,delay:0}}},$n),console.log("added layer ",zn)}}async function xn(Ot,an){var $n;if(console.log(Ot),!(c&&(($n=c==null?void 0:c.getStyle())!=null&&$n.sources[`hexlayer-${Ot}`])))return fetch("/phast/data/hex_data_sf/polygon_data.geojson").then(oi=>oi.json()).then(oi=>Ni=oi).then(()=>{var zn,Wn,_n;gt.hex=(zn=Ni.properties)==null?void 0:zn.maxes,At.hex=(Wn=Ni.properties)==null?void 0:Wn.mins,(_n=Ni.properties)!=null&&_n.rel_pd_exp&&Ni.properties.rel_pd_exp;let Yi=c.getStyle().layers[71].id;c.getSource(`hexlayer-${Ot}`)||c.addSource(`hexlayer-${Ot}`,{type:"geojson",data:Ni});for(let b of dm){let M=`hex-${b}-${Ot}`;c.addLayer({id:M,type:"fill",source:`hexlayer-${Ot}`,layout:{},paint:{"fill-color":Gi(b,ce,b.search("Sig")==-1),"fill-opacity":v,"fill-color-transition":{duration:500,delay:0}}},Yi),console.log("added layer ",M)}let Xn=`hex-${dm[0]}-${Ot}`;return c.on("click",Xn,b=>{console.log(b);let M=oU(b.lngLat.lat,b.lngLat.lng,an);if(bn(M),M===(S==null?void 0:S.hex)){ip.set(null);return}console.log(c.getStyle().layers);let U=Gw(M);rt={lng:U[1],lat:U[0]},console.log(M),ip.set({latlng:b.lngLat,hex:M,properties:b.features[0].properties})}),c.on("mouseenter",Xn,()=>{c.getCanvas().style.cursor="pointer"}),c.on("mouseleave",Xn,()=>{c.getCanvas().style.cursor=""}),c.on("dragstart",Xn,()=>{c.getCanvas().style.cursor="grabbing"}),c.on("dragend",Xn,()=>{c.getCanvas().style.cursor="pointer"}),!0})}async function Ti(){fetch("/phast/data/ecoregions.geojson").then(Ot=>Ot.json()).then(Ot=>{Zi=Ot,console.log(Ot),c.addSource("ecolayer",{type:"geojson",data:Ot,generateId:!0}),c.addLayer({id:"ecoregions-fill",type:"fill",source:"ecolayer",layout:{},paint:{"fill-opacity":0,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"ecoregions-line",type:"line",source:"ecolayer",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":0}}),console.log("added ecoregions")})}async function gi(){rm&&fetch("/phast/data/california.geojson").then(Ot=>Ot.json()).then(Ot=>{console.log(Ot),c.addSource("california",{type:"geojson",data:Ot,generateId:!0}),c.addLayer({id:"california-fill",type:"fill",source:"california",layout:{},paint:{"fill-opacity":v,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"california-line",type:"line",source:"california",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":g}})})}function Oi(Ot){if(!Ot)return;console.log("started building");let an=Date.now();xn("Birds",p3).then(()=>sn("Birds")).then(()=>{ht(),Ye(oe,Ke),console.log(`finished building in ${Date.now()-an}ms`)}),yi(!1),Ci(!1)}wc(()=>{j0(rm,c=new bx.Map({container:"map",style:`https://basemaps.cartocdn.com/gl/${Bn}-gl-style/style.json`,center:he,zoom:4}),c),c.on("load",()=>{Ti(),gi(),console.log("loaded"),Vi()}),setTimeout(()=>{console.log("no load on timeout"),j0(rm,c._canvas.style.filter="none",c),Vi()},3e3)});async function Vi(){let Ot=xt;ki=window.innerWidth/3,c.fitBounds(Ot,{padding:{top:50,left:10,bottom:50,right:ki}}),j0(rm,c._canvas.style.filter="none",c)}function bn(Ot){Ue||wn();let an=Gw(Ot);console.log(an),ki=2*window.innerWidth/5,xi([an[1],an[0]]),c.flyTo({center:[an[1],an[0]],essential:!0,padding:{right:ki},duration:750})}function wn(){let Ot=document.getElementById("marker-template");Ot.style.display="block",Ue=new bx.Marker({element:Ot}).setLngLat(rt).addTo(c)}function xi(Ot){Ue.setLngLat(Ot)}let Bn="positron";return t.$$set=Ot=>{"metric"in Ot&&n(0,oe=Ot.metric),"colorScheme"in Ot&&n(1,ce=Ot.colorScheme),"showCounties"in Ot&&n(2,_e=Ot.showCounties),"showEcoregions"in Ot&&n(3,Ze=Ot.showEcoregions),"drawnPath"in Ot&&n(4,nt=Ot.drawnPath),"clade"in Ot&&n(5,Ke=Ot.clade),"clades"in Ot&&n(6,st=Ot.clades),"finishBuilding"in Ot&&n(7,ht=Ot.finishBuilding)},t.$$.update=()=>{t.$$.dirty[0]&3072&&c&&XU&&(n(10,zt=c.getStyle().layers.filter(Ot=>Ot["source-layer"]==="place")),console.log(zt)),t.$$.dirty[0]&33&&Ye(oe,Ke),t.$$.dirty[0]&16384&&Ft(),t.$$.dirty[0]&4129&&v&&Ye(oe,Ke),t.$$.dirty[0]&2&&Ut(ce),t.$$.dirty[0]&4&&Vt(_e),t.$$.dirty[0]&8&&yi(Ze),t.$$.dirty[0]&16&&ut(nt),t.$$.dirty[0]&32&&yt(Ke),t.$$.dirty[0]&8192&&St(S),t.$$.dirty[0]&32768&&Oi($)},[oe,ce,_e,Ze,nt,Ke,st,ht,yi,Ci,zt,c,v,S,N,$]}let KU=class extends Ha{constructor(e){super(),ja(this,e,YU,WU,Ca,{metric:0,colorScheme:1,showCounties:2,showEcoregions:3,drawnPath:4,clade:5,clades:6,finishBuilding:7,updateShowEcoregions:8,updateShowCalifornia:9},null,[-1,-1])}get updateShowEcoregions(){return this.$$.ctx[8]}get updateShowCalifornia(){return this.$$.ctx[9]}};function JU(t){var g,v,S,a,N,$;let e,n,c;return n=new v5({props:{header:!1,clade:t[0],present:(v=(g=t[1])==null?void 0:g.properties)==null?void 0:v.present,newick:(a=(S=t[1])==null?void 0:S.properties)==null?void 0:a.tree,hex_id:($=(N=t[1])==null?void 0:N.properties)==null?void 0:$.id}}),{c(){e=Pn("div"),Cr(n.$$.fragment),this.h()},l(he){e=Dn(he,"DIV",{class:!0});var oe=rn(e);Rr(n.$$.fragment,oe),oe.forEach(Ai),this.h()},h(){_i(e,"class","float svelte-ftcigg")},m(he,oe){yn(he,e,oe),Tr(n,e,null),c=!0},p(he,[oe]){var _e,Ze,nt,Ke,st,ht;const ce={};oe&1&&(ce.clade=he[0]),oe&2&&(ce.present=(Ze=(_e=he[1])==null?void 0:_e.properties)==null?void 0:Ze.present),oe&2&&(ce.newick=(Ke=(nt=he[1])==null?void 0:nt.properties)==null?void 0:Ke.tree),oe&2&&(ce.hex_id=(ht=(st=he[1])==null?void 0:st.properties)==null?void 0:ht.id),n.$set(ce)},i(he){c||(Fi(n.$$.fragment,he),c=!0)},o(he){Xi(n.$$.fragment,he),c=!1},d(he){he&&Ai(e),kr(n)}}}function eG(t,e,n){let c;Il(t,ip,v=>n(1,c=v));let{clade:g="Birds"}=e;return t.$$set=v=>{"clade"in v&&n(0,g=v.clade)},[g,c]}class tG extends Ha{constructor(e){super(),ja(this,e,eG,JU,Ca,{clade:0})}}function m3(t,e,n){const c=t.slice();return c[11]=e[n],c}function g3(t,e,n){const c=t.slice();return c[11]=e[n],c}function iG(t,e,n){const c=t.slice();return c[11]=e[n],c}function nG(t){let e;return{c(){e=Fs(t[11])},l(n){e=Os(n,t[11])},m(n,c){yn(n,e,c)},p:Ra,d(n){n&&Ai(e)}}}function rG(t){let e,n;return e=new d0({props:{value:t[11],$$slots:{default:[nG]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&262144&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function sG(t){let e,n,c=gu(dm),g=[];for(let v=0;v<c.length;v+=1)g[v]=rG(iG(t,c,v));return{c(){for(let v=0;v<g.length;v+=1)g[v].c();e=Zr()},l(v){for(let S=0;S<g.length;S+=1)g[S].l(v);e=Zr()},m(v,S){for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(v,S);yn(v,e,S),n=!0},p:Ra,i(v){if(!n){for(let S=0;S<c.length;S+=1)Fi(g[S]);n=!0}},o(v){g=g.filter(Boolean);for(let S=0;S<g.length;S+=1)Xi(g[S]);n=!1},d(v){v&&Ai(e),dA(g,v)}}}function aG(t){let e=t[11]+"",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p(c,g){g&4&&e!==(e=c[11]+"")&&El(n,e)},d(c){c&&Ai(n)}}}function _3(t){let e,n;return e=new d0({props:{value:t[11],$$slots:{default:[aG]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&4&&(v.value=c[11]),g&262148&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function oG(t){let e,n,c=gu(t[2]),g=[];for(let S=0;S<c.length;S+=1)g[S]=_3(g3(t,c,S));const v=S=>Xi(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();e=Zr()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);e=Zr()},m(S,a){for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(S,a);yn(S,e,a),n=!0},p(S,a){if(a&4){c=gu(S[2]);let N;for(N=0;N<c.length;N+=1){const $=g3(S,c,N);g[N]?(g[N].p($,a),Fi(g[N],1)):(g[N]=_3($),g[N].c(),Fi(g[N],1),g[N].m(e.parentNode,e))}for(Ba(),N=c.length;N<g.length;N+=1)v(N);za()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Fi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)Xi(g[a]);n=!1},d(S){S&&Ai(e),dA(g,S)}}}function lG(t){let e=t[11]+"",n;return{c(){n=Fs(e)},l(c){n=Os(c,e)},m(c,g){yn(c,n,g)},p(c,g){g&8&&e!==(e=c[11]+"")&&El(n,e)},d(c){c&&Ai(n)}}}function y3(t){let e,n;return e=new d0({props:{value:t[11],$$slots:{default:[lG]},$$scope:{ctx:t}}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&8&&(v.value=c[11]),g&262152&&(v.$$scope={dirty:g,ctx:c}),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function uG(t){let e,n,c=gu(t[3]),g=[];for(let S=0;S<c.length;S+=1)g[S]=y3(m3(t,c,S));const v=S=>Xi(g[S],1,1,()=>{g[S]=null});return{c(){for(let S=0;S<g.length;S+=1)g[S].c();e=Zr()},l(S){for(let a=0;a<g.length;a+=1)g[a].l(S);e=Zr()},m(S,a){for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(S,a);yn(S,e,a),n=!0},p(S,a){if(a&8){c=gu(S[3]);let N;for(N=0;N<c.length;N+=1){const $=m3(S,c,N);g[N]?(g[N].p($,a),Fi(g[N],1)):(g[N]=y3($),g[N].c(),Fi(g[N],1),g[N].m(e.parentNode,e))}for(Ba(),N=c.length;N<g.length;N+=1)v(N);za()}},i(S){if(!n){for(let a=0;a<c.length;a+=1)Fi(g[a]);n=!0}},o(S){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)Xi(g[a]);n=!1},d(S){S&&Ai(e),dA(g,S)}}}function cG(t){let e,n,c,g,v,S,a,N,$,he,oe,ce,_e,Ze,nt,Ke;c=new Nv({props:{white:!0}});function st($t){t[7]($t)}let ht={class:"shaped",variant:"outlined",$$slots:{default:[sG]},$$scope:{ctx:t}};t[4]!==void 0&&(ht.value=t[4]),a=new o0({props:ht}),ta.push(()=>Vh(a,"value",st)),a.$on("change",t[8]);function xt($t){t[9]($t)}let zt={class:"shaped",variant:"outlined",$$slots:{default:[oG]},$$scope:{ctx:t}};t[0]!==void 0&&(zt.value=t[0]),he=new o0({props:zt}),ta.push(()=>Vh(he,"value",xt));function Mt($t){t[10]($t)}let Ue={class:"shaped",variant:"outlined",$$slots:{default:[uG]},$$scope:{ctx:t}};return t[5]!==void 0&&(Ue.value=t[5]),_e=new o0({props:Ue}),ta.push(()=>Vh(_e,"value",Mt)),{c(){e=Pn("div"),n=Pn("div"),Cr(c.$$.fragment),g=_r(),v=Pn("div"),S=Fs(`Testing
        `),Cr(a.$$.fragment),$=Fs(`
        of
        `),Cr(he.$$.fragment),ce=Fs(`
        at the
        `),Cr(_e.$$.fragment),nt=Fs(`
        level`),this.h()},l($t){e=Dn($t,"DIV",{class:!0});var rt=rn(e);n=Dn(rt,"DIV",{class:!0});var gt=rn(n);Rr(c.$$.fragment,gt),gt.forEach(Ai),g=yr(rt),v=Dn(rt,"DIV",{class:!0});var At=rn(v);S=Os(At,`Testing
        `),Rr(a.$$.fragment,At),$=Os(At,`
        of
        `),Rr(he.$$.fragment,At),ce=Os(At,`
        at the
        `),Rr(_e.$$.fragment,At),nt=Os(At,`
        level`),At.forEach(Ai),rt.forEach(Ai),this.h()},h(){_i(n,"class","logo svelte-ttkvsf"),_i(v,"class","test"),_i(e,"class","menu svelte-ttkvsf")},m($t,rt){yn($t,e,rt),Bi(e,n),Tr(c,n,null),Bi(e,g),Bi(e,v),Bi(v,S),Tr(a,v,null),Bi(v,$),Tr(he,v,null),Bi(v,ce),Tr(_e,v,null),Bi(v,nt),Ke=!0},p($t,[rt]){const gt={};rt&262144&&(gt.$$scope={dirty:rt,ctx:$t}),!N&&rt&16&&(N=!0,gt.value=$t[4],Nh(()=>N=!1)),a.$set(gt);const At={};rt&262148&&(At.$$scope={dirty:rt,ctx:$t}),!oe&&rt&1&&(oe=!0,At.value=$t[0],Nh(()=>oe=!1)),he.$set(At);const yt={};rt&262152&&(yt.$$scope={dirty:rt,ctx:$t}),!Ze&&rt&32&&(Ze=!0,yt.value=$t[5],Nh(()=>Ze=!1)),_e.$set(yt)},i($t){Ke||(Fi(c.$$.fragment,$t),Fi(a.$$.fragment,$t),Fi(he.$$.fragment,$t),Fi(_e.$$.fragment,$t),Ke=!0)},o($t){Xi(c.$$.fragment,$t),Xi(a.$$.fragment,$t),Xi(he.$$.fragment,$t),Xi(_e.$$.fragment,$t),Ke=!1},d($t){$t&&Ai(e),kr(c),kr(a),kr(he),kr(_e)}}}function hG(t,e,n){let c,g;Il(t,tf,Ze=>n(4,c=Ze)),Il(t,vg,Ze=>n(5,g=Ze));let{updateMetricLayer:v}=e,{clade:S}=e,{updateClade:a}=e,{clades:N=[]}=e,{visualLayers:$=[]}=e;function he(Ze){c=Ze,tf.set(c)}const oe=()=>v(tf);function ce(Ze){S=Ze,n(0,S)}function _e(Ze){g=Ze,vg.set(g)}return t.$$set=Ze=>{"updateMetricLayer"in Ze&&n(1,v=Ze.updateMetricLayer),"clade"in Ze&&n(0,S=Ze.clade),"updateClade"in Ze&&n(6,a=Ze.updateClade),"clades"in Ze&&n(2,N=Ze.clades),"visualLayers"in Ze&&n(3,$=Ze.visualLayers)},[S,v,N,$,c,g,a,he,oe,ce,_e]}class AG extends Ha{constructor(e){super(),ja(this,e,hG,cG,Ca,{updateMetricLayer:1,clade:0,updateClade:6,clades:2,visualLayers:3})}}function v3(t){let e,n;return e=new HO({props:{isBuilt:dG,isFinishedBuilding:t[7],visualLayers:t[16],showEcoregions:t[11],colorScheme:t[1],metric:t[8],clade:t[6],clades:t[15],updateClade:t[14]}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&128&&(v.isFinishedBuilding=c[7]),g&2&&(v.colorScheme=c[1]),g&256&&(v.metric=c[8]),g&64&&(v.clade=c[6]),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function x3(t){let e,n,c,g,v;return n=new kT({props:{updateColorScheme:t[9],updateShowCounties:t[10],updateShowEcoregions:t[11],updateDrawing:t[12],drawing:t[4],updateDrawnPath:t[13]}}),g=new UT({props:{colorScheme:t[1],metric:t[8]}}),{c(){e=Pn("div"),Cr(n.$$.fragment),c=_r(),Cr(g.$$.fragment),this.h()},l(S){e=Dn(S,"DIV",{class:!0});var a=rn(e);Rr(n.$$.fragment,a),c=yr(a),Rr(g.$$.fragment,a),a.forEach(Ai),this.h()},h(){_i(e,"class","control-container svelte-eoojfj")},m(S,a){yn(S,e,a),Tr(n,e,null),Bi(e,c),Tr(g,e,null),v=!0},p(S,a){const N={};a&16&&(N.drawing=S[4]),n.$set(N);const $={};a&2&&($.colorScheme=S[1]),a&256&&($.metric=S[8]),g.$set($)},i(S){v||(Fi(n.$$.fragment,S),Fi(g.$$.fragment,S),v=!0)},o(S){Xi(n.$$.fragment,S),Xi(g.$$.fragment,S),v=!1},d(S){S&&Ai(e),kr(n),kr(g)}}}function b3(t){let e,n;return e=new RT({props:{updatePath:t[13],updateIsDrawing:t[12],isDrawing:t[4]}}),{c(){Cr(e.$$.fragment)},l(c){Rr(e.$$.fragment,c)},m(c,g){Tr(e,c,g),n=!0},p(c,g){const v={};g&16&&(v.isDrawing=c[4]),e.$set(v)},i(c){n||(Fi(e.$$.fragment,c),n=!0)},o(c){Xi(e.$$.fragment,c),n=!1},d(c){kr(e,c)}}}function w3(t){let e,n,c,g;return e=new AG({props:{visualLayers:t[16],showEcoregions:t[11],colorScheme:t[1],metric:t[8],clade:t[6],clades:t[15],updateClade:t[14]}}),c=new tG({props:{clade:t[6]}}),{c(){Cr(e.$$.fragment),n=_r(),Cr(c.$$.fragment)},l(v){Rr(e.$$.fragment,v),n=yr(v),Rr(c.$$.fragment,v)},m(v,S){Tr(e,v,S),yn(v,n,S),Tr(c,v,S),g=!0},p(v,S){const a={};S&2&&(a.colorScheme=v[1]),S&256&&(a.metric=v[8]),S&64&&(a.clade=v[6]),e.$set(a);const N={};S&64&&(N.clade=v[6]),c.$set(N)},i(v){g||(Fi(e.$$.fragment,v),Fi(c.$$.fragment,v),g=!0)},o(v){Xi(e.$$.fragment,v),Xi(c.$$.fragment,v),g=!1},d(v){v&&Ai(n),kr(e,v),kr(c,v)}}}function fG(t){let e,n,c,g,v,S,a,N;n=new KU({props:{finishBuilding:t[17],metric:t[8],colorScheme:t[1],showCounties:t[2],showEcoregions:t[3],drawnPath:t[5],clade:t[6],clades:t[15]}});let $=!t[7]&&v3(t),he=t[0]&&x3(t),oe=t[4]&&b3(t),ce=t[0]&&w3(t);return{c(){e=Pn("main"),Cr(n.$$.fragment),c=_r(),$&&$.c(),g=_r(),he&&he.c(),v=_r(),oe&&oe.c(),S=_r(),ce&&ce.c(),a=Zr(),this.h()},l(_e){e=Dn(_e,"MAIN",{class:!0});var Ze=rn(e);Rr(n.$$.fragment,Ze),c=yr(Ze),$&&$.l(Ze),Ze.forEach(Ai),g=yr(_e),he&&he.l(_e),v=yr(_e),oe&&oe.l(_e),S=yr(_e),ce&&ce.l(_e),a=Zr(),this.h()},h(){_i(e,"class","svelte-eoojfj")},m(_e,Ze){yn(_e,e,Ze),Tr(n,e,null),Bi(e,c),$&&$.m(e,null),yn(_e,g,Ze),he&&he.m(_e,Ze),yn(_e,v,Ze),oe&&oe.m(_e,Ze),yn(_e,S,Ze),ce&&ce.m(_e,Ze),yn(_e,a,Ze),N=!0},p(_e,[Ze]){const nt={};Ze&256&&(nt.metric=_e[8]),Ze&2&&(nt.colorScheme=_e[1]),Ze&4&&(nt.showCounties=_e[2]),Ze&8&&(nt.showEcoregions=_e[3]),Ze&32&&(nt.drawnPath=_e[5]),Ze&64&&(nt.clade=_e[6]),n.$set(nt),_e[7]?$&&(Ba(),Xi($,1,1,()=>{$=null}),za()):$?($.p(_e,Ze),Ze&128&&Fi($,1)):($=v3(_e),$.c(),Fi($,1),$.m(e,null)),_e[0]?he?(he.p(_e,Ze),Ze&1&&Fi(he,1)):(he=x3(_e),he.c(),Fi(he,1),he.m(v.parentNode,v)):he&&(Ba(),Xi(he,1,1,()=>{he=null}),za()),_e[4]?oe?(oe.p(_e,Ze),Ze&16&&Fi(oe,1)):(oe=b3(_e),oe.c(),Fi(oe,1),oe.m(S.parentNode,S)):oe&&(Ba(),Xi(oe,1,1,()=>{oe=null}),za()),_e[0]?ce?(ce.p(_e,Ze),Ze&1&&Fi(ce,1)):(ce=w3(_e),ce.c(),Fi(ce,1),ce.m(a.parentNode,a)):ce&&(Ba(),Xi(ce,1,1,()=>{ce=null}),za())},i(_e){N||(Fi(n.$$.fragment,_e),Fi($),Fi(he),Fi(oe),Fi(ce),N=!0)},o(_e){Xi(n.$$.fragment,_e),Xi($),Xi(he),Xi(oe),Xi(ce),N=!1},d(_e){_e&&(Ai(e),Ai(g),Ai(v),Ai(S),Ai(a)),kr(n),$&&$.d(),he&&he.d(_e),oe&&oe.d(_e),ce&&ce.d(_e)}}}let dG=!1;function pG(t,e,n){let c,g;Il(t,t1,Mt=>n(0,c=Mt)),Il(t,tf,Mt=>n(8,g=Mt));let v="*ibm";function S(Mt){n(1,v=Mt)}let a=!1;function N(Mt){n(2,a=Mt)}let $=!1;function he(Mt){n(3,$=Mt)}let oe=!1;function ce(Mt){n(4,oe=Mt)}let _e=null;function Ze(Mt){n(5,_e=Mt)}let nt="Birds";function Ke(Mt){n(6,nt=Mt)}const st=["Birds","Plants"],ht=["hex","eco"];let xt=!1;function zt(){n(7,xt=!0)}return t.$$.update=()=>{t.$$.dirty&1&&console.log(c)},[c,v,a,$,oe,_e,nt,xt,g,S,N,he,ce,Ze,Ke,st,ht,zt]}class SG extends Ha{constructor(e){super(),ja(this,e,pG,fG,Ca,{})}}export{SG as component};
