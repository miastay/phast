var KI=Object.defineProperty;var JI=(e,t,n)=>t in e?KI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Er=(e,t,n)=>(JI(e,typeof t!="symbol"?t+"":t,n),n);import{y as Cu,s as ho,c as ru,z as gr,A as bo,j as Eu,u as su,g as au,a as ou,r as Nh,B as co,C as yc,D as du,o as vc,E as wm,F as ec,e as pa,G as O0,n as wo,H as eE,b as Vc,I as om,J as N2,l as tE,K as Jd}from"../chunks/scheduler.I9_GjKIr.js";import{S as Lo,i as Bo,s as Cr,e as Nn,h as Tr,c as Vn,d as bn,g as bi,y as sl,j as Gn,z as Gl,t as $i,a as dn,A as N0,u as gs,v as Xs,w as _s,x as ys,r as ef,m as Ds,q as Ho,n as jo,B as Ba,C as za,D as d_,E as p_,o as Pi,k as Zi,b as Ja,f as eo,l as tu,F as iE,G as dc,H as V2,I as up,J as nE,K as rE,L as em,p as Ly}from"../chunks/index.uFRP6icT.js";import{w as ep}from"../chunks/index.OKv3WG0v.js";const sE=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ph(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ma(e,t){const n={},c={},g={$$scope:1};let b=e.length;for(;b--;){const I=e[b],a=t[b];if(a){for(const G in I)G in a||(c[G]=1);for(const G in a)g[G]||(n[G]=a[G],g[G]=1);e[b]=a}else for(const G in I)g[G]=1}for(const I in c)I in n||(n[I]=void 0);return n}function Fs(e){return typeof e=="object"&&e!==null?e:{}}var By=function(e,t){return By=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,c){n.__proto__=c}||function(n,c){for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(n[g]=c[g])},By(e,t)};function s0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");By(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var nu=function(){return nu=Object.assign||function(t){for(var n,c=1,g=arguments.length;c<g;c++){n=arguments[c];for(var b in n)Object.prototype.hasOwnProperty.call(n,b)&&(t[b]=n[b])}return t},nu.apply(this,arguments)};function ig(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],c=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&c>=e.length&&(e=void 0),{value:e&&e[c++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function U2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var c=n.call(e),g,b=[],I;try{for(;(t===void 0||t-- >0)&&!(g=c.next()).done;)b.push(g.value)}catch(a){I={error:a}}finally{try{g&&!g.done&&(n=c.return)&&n.call(c)}finally{if(I)throw I.error}}return b}function aE(e,t,n){if(n||arguments.length===2)for(var c=0,g=t.length,b;c<g;c++)(b||!(c in t))&&(b||(b=Array.prototype.slice.call(t,0,c)),b[c]=t[c]);return e.concat(b||Array.prototype.slice.call(t))}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var a0=function(){function e(t){t===void 0&&(t={}),this.adapter=t}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function oE(e,t){if(e.closest)return e.closest(t);for(var n=e;n;){if(o3(n,t))return n;n=n.parentElement}return null}function o3(e,t){var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return n.call(e,t)}function lE(e){var t=e;if(t.offsetParent!==null)return t.scrollWidth;var n=t.cloneNode(!0);n.style.setProperty("position","absolute"),n.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(n);var c=n.scrollWidth;return document.documentElement.removeChild(n),c}const Dv=Object.freeze(Object.defineProperty({__proto__:null,closest:oE,estimateScrollWidth:lE,matches:o3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var uE={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var cE=function(e){s0(t,e);function t(n){var c=e.call(this,nu(nu({},t.defaultAdapter),n))||this;return c.shakeAnimationEndHandler=function(){c.handleShakeAnimationEnd()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return uE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.getWidth=function(){return this.adapter.getWidth()},t.prototype.shake=function(n){var c=t.cssClasses.LABEL_SHAKE;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.float=function(n){var c=t.cssClasses,g=c.LABEL_FLOAT_ABOVE,b=c.LABEL_SHAKE;n?this.adapter.addClass(g):(this.adapter.removeClass(g),this.adapter.removeClass(b))},t.prototype.setRequired=function(n){var c=t.cssClasses.LABEL_REQUIRED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleShakeAnimationEnd=function(){var n=t.cssClasses.LABEL_SHAKE;this.adapter.removeClass(n)},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Nd={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var hE=function(e){s0(t,e);function t(n){var c=e.call(this,nu(nu({},t.defaultAdapter),n))||this;return c.transitionEndHandler=function(g){c.handleTransitionEnd(g)},c}return Object.defineProperty(t,"cssClasses",{get:function(){return Nd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},t.prototype.activate=function(){this.adapter.removeClass(Nd.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(Nd.LINE_RIPPLE_ACTIVE)},t.prototype.setRippleCenter=function(n){this.adapter.setStyle("transform-origin",n+"px center")},t.prototype.deactivate=function(){this.adapter.addClass(Nd.LINE_RIPPLE_DEACTIVATING)},t.prototype.handleTransitionEnd=function(n){var c=this.adapter.hasClass(Nd.LINE_RIPPLE_DEACTIVATING);n.propertyName==="opacity"&&c&&(this.adapter.removeClass(Nd.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(Nd.LINE_RIPPLE_DEACTIVATING))},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var AE={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},fE={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},jm={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30},eu;(function(e){e[e.BOTTOM=1]="BOTTOM",e[e.CENTER=2]="CENTER",e[e.RIGHT=4]="RIGHT",e[e.FLIP_RTL=8]="FLIP_RTL"})(eu||(eu={}));var Qd;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=4]="TOP_RIGHT",e[e.BOTTOM_LEFT=1]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",e[e.TOP_START=8]="TOP_START",e[e.TOP_END=12]="TOP_END",e[e.BOTTOM_START=9]="BOTTOM_START",e[e.BOTTOM_END=13]="BOTTOM_END"})(Qd||(Qd={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var B0,jf,la={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};B0={},B0[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",B0[""+la.LIST_ITEM_CLASS]="mdc-list-item",B0[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",B0[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",B0[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",B0[""+la.ROOT]="mdc-list";var Zp=(jf={},jf[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",jf[""+la.LIST_ITEM_CLASS]="mdc-deprecated-list-item",jf[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",jf[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",jf[""+la.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",jf[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",jf[""+la.ROOT]="mdc-deprecated-list",jf),z0={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+Zp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+la.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` a,
    .`+Zp[la.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+Zp[la.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},Jl={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Os={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},xc=new Set;xc.add(Os.BACKSPACE);xc.add(Os.ENTER);xc.add(Os.SPACEBAR);xc.add(Os.PAGE_UP);xc.add(Os.PAGE_DOWN);xc.add(Os.END);xc.add(Os.HOME);xc.add(Os.ARROW_LEFT);xc.add(Os.ARROW_UP);xc.add(Os.ARROW_RIGHT);xc.add(Os.ARROW_DOWN);xc.add(Os.DELETE);xc.add(Os.ESCAPE);xc.add(Os.TAB);var Qc={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},bc=new Map;bc.set(Qc.BACKSPACE,Os.BACKSPACE);bc.set(Qc.ENTER,Os.ENTER);bc.set(Qc.SPACEBAR,Os.SPACEBAR);bc.set(Qc.PAGE_UP,Os.PAGE_UP);bc.set(Qc.PAGE_DOWN,Os.PAGE_DOWN);bc.set(Qc.END,Os.END);bc.set(Qc.HOME,Os.HOME);bc.set(Qc.ARROW_LEFT,Os.ARROW_LEFT);bc.set(Qc.ARROW_UP,Os.ARROW_UP);bc.set(Qc.ARROW_RIGHT,Os.ARROW_RIGHT);bc.set(Qc.ARROW_DOWN,Os.ARROW_DOWN);bc.set(Qc.DELETE,Os.DELETE);bc.set(Qc.ESCAPE,Os.ESCAPE);bc.set(Qc.TAB,Os.TAB);var U0=new Set;U0.add(Os.PAGE_UP);U0.add(Os.PAGE_DOWN);U0.add(Os.END);U0.add(Os.HOME);U0.add(Os.ARROW_LEFT);U0.add(Os.ARROW_UP);U0.add(Os.ARROW_RIGHT);U0.add(Os.ARROW_DOWN);function fu(e){var t=e.key;if(xc.has(t))return t;var n=bc.get(e.keyCode);return n||Os.UNKNOWN}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var dE=["input","button","textarea","select"],Rh=function(e){var t=e.target;if(t){var n=(""+t.tagName).toLowerCase();dE.indexOf(n)===-1&&e.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function pE(){var e={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return e}function mE(e,t){for(var n=new Map,c=0;c<e;c++){var g=t(c).trim();if(g){var b=g[0].toLowerCase();n.has(b)||n.set(b,[]),n.get(b).push({text:g.toLowerCase(),index:c})}}return n.forEach(function(I){I.sort(function(a,G){return a.index-G.index})}),n}function zy(e,t){var n=e.nextChar,c=e.focusItemAtIndex,g=e.sortedIndexByFirstChar,b=e.focusedItemIndex,I=e.skipFocus,a=e.isItemAtIndexDisabled;clearTimeout(t.bufferClearTimeout),t.bufferClearTimeout=setTimeout(function(){u3(t)},Jl.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),t.typeaheadBuffer=t.typeaheadBuffer+n;var G;return t.typeaheadBuffer.length===1?G=gE(g,b,a,t):G=_E(g,a,t),G!==-1&&!I&&c(G),G}function gE(e,t,n,c){var g=c.typeaheadBuffer[0],b=e.get(g);if(!b)return-1;if(g===c.currentFirstChar&&b[c.sortedIndexCursor].index===t){c.sortedIndexCursor=(c.sortedIndexCursor+1)%b.length;var I=b[c.sortedIndexCursor].index;if(!n(I))return I}c.currentFirstChar=g;var a=-1,G;for(G=0;G<b.length;G++)if(!n(b[G].index)){a=G;break}for(;G<b.length;G++)if(b[G].index>t&&!n(b[G].index)){a=G;break}return a!==-1?(c.sortedIndexCursor=a,b[c.sortedIndexCursor].index):-1}function _E(e,t,n){var c=n.typeaheadBuffer[0],g=e.get(c);if(!g)return-1;var b=g[n.sortedIndexCursor];if(b.text.lastIndexOf(n.typeaheadBuffer,0)===0&&!t(b.index))return b.index;for(var I=(n.sortedIndexCursor+1)%g.length,a=-1;I!==n.sortedIndexCursor;){var G=g[I],W=G.text.lastIndexOf(n.typeaheadBuffer,0)===0,he=!t(G.index);if(W&&he){a=I;break}I=(I+1)%g.length}return a!==-1?(n.sortedIndexCursor=a,g[n.sortedIndexCursor].index):-1}function l3(e){return e.typeaheadBuffer.length>0}function u3(e){e.typeaheadBuffer=""}function G2(e,t){var n=e.event,c=e.isTargetListItem,g=e.focusedItemIndex,b=e.focusItemAtIndex,I=e.sortedIndexByFirstChar,a=e.isItemAtIndexDisabled,G=fu(n)==="ArrowLeft",W=fu(n)==="ArrowUp",he=fu(n)==="ArrowRight",ae=fu(n)==="ArrowDown",ue=fu(n)==="Home",be=fu(n)==="End",Ke=fu(n)==="Enter",ot=fu(n)==="Spacebar";if(n.altKey||n.ctrlKey||n.metaKey||G||W||he||ae||ue||be||Ke)return-1;var tt=!ot&&n.key.length===1;if(tt){Rh(n);var lt={focusItemAtIndex:b,focusedItemIndex:g,nextChar:n.key.toLowerCase(),sortedIndexByFirstChar:I,skipFocus:!1,isItemAtIndexDisabled:a};return zy(lt,t)}if(!ot)return-1;c&&Rh(n);var ut=c&&l3(t);if(ut){var lt={focusItemAtIndex:b,focusedItemIndex:g,nextChar:" ",sortedIndexByFirstChar:I,skipFocus:!1,isItemAtIndexDisabled:a};return zy(lt,t)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function yE(e){return e instanceof Array}var vE=["Alt","Control","Meta","Shift"];function q2(e){var t=new Set(e?vE.filter(function(n){return e.getModifierState(n)}):[]);return function(n){return n.every(function(c){return t.has(c)})&&n.length===t.size}}var xE=function(e){s0(t,e);function t(n){var c=e.call(this,nu(nu({},t.defaultAdapter),n))||this;return c.wrapFocus=!1,c.isVertical=!0,c.isSingleSelectionList=!1,c.areDisabledItemsFocusable=!0,c.selectedIndex=Jl.UNSET_INDEX,c.focusedItemIndex=Jl.UNSET_INDEX,c.useActivatedClass=!1,c.useSelectedAttr=!1,c.ariaCurrentAttrValue=null,c.isCheckboxList=!1,c.isRadioList=!1,c.lastSelectedIndex=null,c.hasTypeahead=!1,c.typeaheadState=pE(),c.sortedIndexByFirstChar=new Map,c}return Object.defineProperty(t,"strings",{get:function(){return z0},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return la},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Jl},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),t.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},t.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},t.prototype.setWrapFocus=function(n){this.wrapFocus=n},t.prototype.setVerticalOrientation=function(n){this.isVertical=n},t.prototype.setSingleSelection=function(n){this.isSingleSelectionList=n,n&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},t.prototype.setDisabledItemsFocusable=function(n){this.areDisabledItemsFocusable=n},t.prototype.maybeInitializeSingleSelection=function(){var n=this.getSelectedIndexFromDOM();if(n!==Jl.UNSET_INDEX){var c=this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_ACTIVATED_CLASS);c&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=n}},t.prototype.getSelectedIndexFromDOM=function(){for(var n=Jl.UNSET_INDEX,c=this.adapter.getListItemCount(),g=0;g<c;g++){var b=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_SELECTED_CLASS),I=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_ACTIVATED_CLASS);if(b||I){n=g;break}}return n},t.prototype.setHasTypeahead=function(n){this.hasTypeahead=n,n&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},t.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&l3(this.typeaheadState)},t.prototype.setUseActivatedClass=function(n){this.useActivatedClass=n},t.prototype.setUseSelectedAttribute=function(n){this.useSelectedAttr=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n,c){c===void 0&&(c={}),this.isIndexValid(n)&&(this.isCheckboxList?this.setCheckboxAtIndex(n,c):this.isRadioList?this.setRadioAtIndex(n,c):this.setSingleSelectionAtIndex(n,c))},t.prototype.handleFocusIn=function(n){n>=0&&(this.focusedItemIndex=n,this.adapter.setAttributeForElementIndex(n,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(n,"0"))},t.prototype.handleFocusOut=function(n){var c=this;n>=0&&(this.adapter.setAttributeForElementIndex(n,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(n,"-1")),setTimeout(function(){c.adapter.isFocusInsideList()||c.setTabindexToFirstSelectedOrFocusedItem()},0)},t.prototype.isIndexDisabled=function(n){return this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_DISABLED_CLASS)},t.prototype.handleKeydown=function(n,c,g){var b=this,I,a=fu(n)==="ArrowLeft",G=fu(n)==="ArrowUp",W=fu(n)==="ArrowRight",he=fu(n)==="ArrowDown",ae=fu(n)==="Home",ue=fu(n)==="End",be=fu(n)==="Enter",Ke=fu(n)==="Spacebar",ot=this.isVertical&&he||!this.isVertical&&W,tt=this.isVertical&&G||!this.isVertical&&a,lt=n.key==="A"||n.key==="a",ut=q2(n);if(this.adapter.isRootFocused()){if((tt||ue)&&ut([]))n.preventDefault(),this.focusLastElement();else if((ot||ae)&&ut([]))n.preventDefault(),this.focusFirstElement();else if(tt&&ut(["Shift"])&&this.isCheckboxList){n.preventDefault();var Tt=this.focusLastElement();Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}else if(ot&&ut(["Shift"])&&this.isCheckboxList){n.preventDefault();var Tt=this.focusFirstElement();Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}if(this.hasTypeahead){var Pt={event:n,focusItemAtIndex:function(Xt){b.focusItemAtIndex(Xt)},focusedItemIndex:-1,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Xt){return b.isIndexDisabled(Xt)}};G2(Pt,this.typeaheadState)}return}var zt=this.adapter.getFocusedElementIndex();if(!(zt===-1&&(zt=g,zt<0))){if(ot&&ut([]))Rh(n),this.focusNextElement(zt);else if(tt&&ut([]))Rh(n),this.focusPrevElement(zt);else if(ot&&ut(["Shift"])&&this.isCheckboxList){Rh(n);var Tt=this.focusNextElement(zt);Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}else if(tt&&ut(["Shift"])&&this.isCheckboxList){Rh(n);var Tt=this.focusPrevElement(zt);Tt!==-1&&this.setSelectedIndexOnAction(Tt,!1)}else if(ae&&ut([]))Rh(n),this.focusFirstElement();else if(ue&&ut([]))Rh(n),this.focusLastElement();else if(ae&&ut(["Control","Shift"])&&this.isCheckboxList){if(Rh(n),this.isIndexDisabled(zt))return;this.focusFirstElement(),this.toggleCheckboxRange(0,zt,zt)}else if(ue&&ut(["Control","Shift"])&&this.isCheckboxList){if(Rh(n),this.isIndexDisabled(zt))return;this.focusLastElement(),this.toggleCheckboxRange(zt,this.adapter.getListItemCount()-1,zt)}else if(lt&&ut(["Control"])&&this.isCheckboxList)n.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===Jl.UNSET_INDEX?[]:this.selectedIndex,!0);else if((be||Ke)&&ut([])){if(c){var Ge=n.target;if(Ge&&Ge.tagName==="A"&&be||(Rh(n),this.isIndexDisabled(zt)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(zt,!1),this.adapter.notifyAction(zt))}}else if((be||Ke)&&ut(["Shift"])&&this.isCheckboxList){var Ge=n.target;if(Ge&&Ge.tagName==="A"&&be||(Rh(n),this.isIndexDisabled(zt)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((I=this.lastSelectedIndex)!==null&&I!==void 0?I:zt,zt,zt),this.adapter.notifyAction(zt))}if(this.hasTypeahead){var Pt={event:n,focusItemAtIndex:function(rt){b.focusItemAtIndex(rt)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(rt){return b.isIndexDisabled(rt)}};G2(Pt,this.typeaheadState)}}},t.prototype.handleClick=function(n,c,g){var b,I=q2(g);n!==Jl.UNSET_INDEX&&(this.isIndexDisabled(n)||(I([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(n,c),this.adapter.notifyAction(n)):this.isCheckboxList&&I(["Shift"])&&(this.toggleCheckboxRange((b=this.lastSelectedIndex)!==null&&b!==void 0?b:n,n,n),this.adapter.notifyAction(n))))},t.prototype.focusNextElement=function(n){var c=this.adapter.getListItemCount(),g=n,b=null;do{if(g++,g>=c)if(this.wrapFocus)g=0;else return n;if(g===b)return-1;b=b??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusPrevElement=function(n){var c=this.adapter.getListItemCount(),g=n,b=null;do{if(g--,g<0)if(this.wrapFocus)g=c-1;else return n;if(g===b)return-1;b=b??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},t.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},t.prototype.focusInitialElement=function(){var n=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(n),n},t.prototype.setEnabled=function(n,c){this.isIndexValid(n,!1)&&(c?(this.adapter.removeClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,z0.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,z0.ARIA_DISABLED,"true")))},t.prototype.setSingleSelectionAtIndex=function(n,c){if(c===void 0&&(c={}),!(this.selectedIndex===n&&!c.forceUpdate)){var g=la.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(g=la.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==Jl.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,g),this.setAriaForSingleSelectionAtIndex(n),this.setTabindexAtIndex(n),n!==Jl.UNSET_INDEX&&this.adapter.addClassForElementIndex(n,g),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n])}},t.prototype.setAriaForSingleSelectionAtIndex=function(n){this.selectedIndex===Jl.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(n,z0.ARIA_CURRENT));var c=this.ariaCurrentAttrValue!==null,g=c?z0.ARIA_CURRENT:z0.ARIA_SELECTED;if(this.selectedIndex!==Jl.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),n!==Jl.UNSET_INDEX){var b=c?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(n,g,b)}},t.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?z0.ARIA_SELECTED:z0.ARIA_CHECKED},t.prototype.setRadioAtIndex=function(n,c){c===void 0&&(c={});var g=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(n,!0),!(this.selectedIndex===n&&!c.forceUpdate)&&(this.selectedIndex!==Jl.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),this.adapter.setAttributeForElementIndex(n,g,"true"),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n]))},t.prototype.setCheckboxAtIndex=function(n,c){c===void 0&&(c={});for(var g=this.selectedIndex,b=c.isUserInteraction?new Set(g===Jl.UNSET_INDEX?[]:g):null,I=this.getSelectionAttribute(),a=[],G=0;G<this.adapter.getListItemCount();G++){var W=b==null?void 0:b.has(G),he=n.indexOf(G)>=0;he!==W&&a.push(G),this.adapter.setCheckedCheckboxOrRadioAtIndex(G,he),this.adapter.setAttributeForElementIndex(G,I,he?"true":"false")}this.selectedIndex=n,c.isUserInteraction&&a.length&&this.adapter.notifySelectionChange(a)},t.prototype.toggleCheckboxRange=function(n,c,g){this.lastSelectedIndex=g;for(var b=new Set(this.selectedIndex===Jl.UNSET_INDEX?[]:this.selectedIndex),I=!(b!=null&&b.has(g)),a=U2([n,c].sort(),2),G=a[0],W=a[1],he=this.getSelectionAttribute(),ae=[],ue=G;ue<=W;ue++)if(!this.isIndexDisabled(ue)){var be=b.has(ue);I!==be&&(ae.push(ue),this.adapter.setCheckedCheckboxOrRadioAtIndex(ue,I),this.adapter.setAttributeForElementIndex(ue,he,""+I),I?b.add(ue):b.delete(ue))}ae.length&&(this.selectedIndex=aE([],U2(b)),this.adapter.notifySelectionChange(ae))},t.prototype.setTabindexAtIndex=function(n){this.focusedItemIndex===Jl.UNSET_INDEX&&n!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==n&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==n&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),n!==Jl.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(n,"tabindex","0")},t.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},t.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var n=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(n)},t.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==Jl.UNSET_INDEX?this.selectedIndex:yE(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(n,c){return Math.min(n,c)}):0:Math.max(this.focusedItemIndex,0)},t.prototype.isIndexValid=function(n,c){var g=this;if(c===void 0&&(c=!0),n instanceof Array){if(!this.isCheckboxList&&c)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return n.length===0?!0:n.some(function(b){return g.isIndexInRange(b)})}else if(typeof n=="number"){if(this.isCheckboxList&&c)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+n);return this.isIndexInRange(n)||this.isSingleSelectionList&&n===Jl.UNSET_INDEX}else return!1},t.prototype.isIndexInRange=function(n){var c=this.adapter.getListItemCount();return n>=0&&n<c},t.prototype.setSelectedIndexOnAction=function(n,c){this.lastSelectedIndex=n,this.isCheckboxList?(this.toggleCheckboxAtIndex(n,c),this.adapter.notifySelectionChange([n])):this.setSelectedIndex(n,{isUserInteraction:!0})},t.prototype.toggleCheckboxAtIndex=function(n,c){var g=this.getSelectionAttribute(),b=this.adapter.isCheckboxCheckedAtIndex(n),I;c?I=b:(I=!b,this.adapter.setCheckedCheckboxOrRadioAtIndex(n,I)),this.adapter.setAttributeForElementIndex(n,g,I?"true":"false");var a=this.selectedIndex===Jl.UNSET_INDEX?[]:this.selectedIndex.slice();I?a.push(n):a=a.filter(function(G){return G!==n}),this.selectedIndex=a},t.prototype.focusItemAtIndex=function(n){this.adapter.focusItemAtIndex(n),this.focusedItemIndex=n},t.prototype.checkboxListToggleAll=function(n,c){var g=this.adapter.getListItemCount();if(n.length===g)this.setCheckboxAtIndex([],{isUserInteraction:c});else{for(var b=[],I=0;I<g;I++)(!this.isIndexDisabled(I)||n.indexOf(I)>-1)&&b.push(I);this.setCheckboxAtIndex(b,{isUserInteraction:c})}},t.prototype.typeaheadMatchItem=function(n,c,g){var b=this;g===void 0&&(g=!1);var I={focusItemAtIndex:function(a){b.focusItemAtIndex(a)},focusedItemIndex:c||this.focusedItemIndex,nextChar:n,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:g,isItemAtIndexDisabled:function(a){return b.isIndexDisabled(a)}};return zy(I,this.typeaheadState)},t.prototype.typeaheadInitSortedIndex=function(){return mE(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},t.prototype.clearTypeaheadBuffer=function(){u3(this.typeaheadState)},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var c3=function(e){s0(t,e);function t(n){var c=e.call(this,nu(nu({},t.defaultAdapter),n))||this;return c.isSurfaceOpen=!1,c.isQuickOpen=!1,c.isHoistedElement=!1,c.isFixedPosition=!1,c.isHorizontallyCenteredOnViewport=!1,c.maxHeight=0,c.openBottomBias=0,c.openAnimationEndTimerId=0,c.closeAnimationEndTimerId=0,c.animationRequestId=0,c.anchorCorner=Qd.TOP_START,c.originCorner=Qd.TOP_START,c.anchorMargin={top:0,right:0,bottom:0,left:0},c.position={x:0,y:0},c}return Object.defineProperty(t,"cssClasses",{get:function(){return AE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return fE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return jm},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Corner",{get:function(){return Qd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=t.cssClasses,c=n.ROOT,g=n.OPEN;if(!this.adapter.hasClass(c))throw new Error(c+" class required in root element.");this.adapter.hasClass(g)&&(this.isSurfaceOpen=!0)},t.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},t.prototype.setAnchorCorner=function(n){this.anchorCorner=n},t.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^eu.RIGHT},t.prototype.setAnchorMargin=function(n){this.anchorMargin.top=n.top||0,this.anchorMargin.right=n.right||0,this.anchorMargin.bottom=n.bottom||0,this.anchorMargin.left=n.left||0},t.prototype.setIsHoisted=function(n){this.isHoistedElement=n},t.prototype.setFixedPosition=function(n){this.isFixedPosition=n},t.prototype.isFixed=function(){return this.isFixedPosition},t.prototype.setAbsolutePosition=function(n,c){this.position.x=this.isFinite(n)?n:0,this.position.y=this.isFinite(c)?c:0},t.prototype.setIsHorizontallyCenteredOnViewport=function(n){this.isHorizontallyCenteredOnViewport=n},t.prototype.setQuickOpen=function(n){this.isQuickOpen=n},t.prototype.setMaxHeight=function(n){this.maxHeight=n},t.prototype.setOpenBottomBias=function(n){this.openBottomBias=n},t.prototype.isOpen=function(){return this.isSurfaceOpen},t.prototype.open=function(){var n=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(t.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(t.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(function(){n.dimensions=n.adapter.getInnerDimensions(),n.autoposition(),n.adapter.addClass(t.cssClasses.OPEN),n.openAnimationEndTimerId=setTimeout(function(){n.openAnimationEndTimerId=0,n.adapter.removeClass(t.cssClasses.ANIMATING_OPEN),n.adapter.notifyOpen()},jm.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0))},t.prototype.close=function(n){var c=this;if(n===void 0&&(n=!1),!!this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen){this.isSurfaceOpen=!1,n||this.maybeRestoreFocus(),this.adapter.removeClass(t.cssClasses.OPEN),this.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(t.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(function(){c.adapter.removeClass(t.cssClasses.OPEN),c.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),c.closeAnimationEndTimerId=setTimeout(function(){c.closeAnimationEndTimerId=0,c.adapter.removeClass(t.cssClasses.ANIMATING_CLOSED),c.adapter.notifyClose()},jm.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,n||this.maybeRestoreFocus()}},t.prototype.handleBodyClick=function(n){var c=n.target;this.adapter.isElementInContainer(c)||this.close()},t.prototype.handleKeydown=function(n){var c=n.keyCode,g=n.key,b=g==="Escape"||c===27;b&&this.close()},t.prototype.autoposition=function(){var n;this.measurements=this.getAutoLayoutmeasurements();var c=this.getoriginCorner(),g=this.getMenuSurfaceMaxHeight(c),b=this.hasBit(c,eu.BOTTOM)?"bottom":"top",I=this.hasBit(c,eu.RIGHT)?"right":"left",a=this.getHorizontalOriginOffset(c),G=this.getVerticalOriginOffset(c),W=this.measurements,he=W.anchorSize,ae=W.surfaceSize,ue=(n={},n[I]=a,n[b]=G,n);he.width/ae.width>jm.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(I="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(ue),this.adapter.setTransformOrigin(I+" "+b),this.adapter.setPosition(ue),this.adapter.setMaxHeight(g?g+"px":""),this.hasBit(c,eu.BOTTOM)||this.adapter.addClass(t.cssClasses.IS_OPEN_BELOW)},t.prototype.getAutoLayoutmeasurements=function(){var n=this.adapter.getAnchorDimensions(),c=this.adapter.getBodyDimensions(),g=this.adapter.getWindowDimensions(),b=this.adapter.getWindowScroll();return n||(n={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:n,bodySize:c,surfaceSize:this.dimensions,viewportDistance:{top:n.top,right:g.width-n.right,bottom:g.height-n.bottom,left:n.left},viewportSize:g,windowScroll:b}},t.prototype.getoriginCorner=function(){var n=this.originCorner,c=this.measurements,g=c.viewportDistance,b=c.anchorSize,I=c.surfaceSize,a=t.numbers.MARGIN_TO_EDGE,G=this.hasBit(this.anchorCorner,eu.BOTTOM),W,he;G?(W=g.top-a+this.anchorMargin.bottom,he=g.bottom-a-this.anchorMargin.bottom):(W=g.top-a+this.anchorMargin.top,he=g.bottom-a+b.height-this.anchorMargin.top);var ae=he-I.height>0;!ae&&W>he+this.openBottomBias&&(n=this.setBit(n,eu.BOTTOM));var ue=this.adapter.isRtl(),be=this.hasBit(this.anchorCorner,eu.FLIP_RTL),Ke=this.hasBit(this.anchorCorner,eu.RIGHT)||this.hasBit(n,eu.RIGHT),ot=!1;ue&&be?ot=!Ke:ot=Ke;var tt,lt;ot?(tt=g.left+b.width+this.anchorMargin.right,lt=g.right-this.anchorMargin.right):(tt=g.left+this.anchorMargin.left,lt=g.right+b.width-this.anchorMargin.left);var ut=tt-I.width>0,Tt=lt-I.width>0,Pt=this.hasBit(n,eu.FLIP_RTL)&&this.hasBit(n,eu.RIGHT);return Tt&&Pt&&ue||!ut&&Pt?n=this.unsetBit(n,eu.RIGHT):(ut&&ot&&ue||ut&&!ot&&Ke||!Tt&&tt>=lt)&&(n=this.setBit(n,eu.RIGHT)),n},t.prototype.getMenuSurfaceMaxHeight=function(n){if(this.maxHeight>0)return this.maxHeight;var c=this.measurements.viewportDistance,g=0,b=this.hasBit(n,eu.BOTTOM),I=this.hasBit(this.anchorCorner,eu.BOTTOM),a=t.numbers.MARGIN_TO_EDGE;return b?(g=c.top+this.anchorMargin.top-a,I||(g+=this.measurements.anchorSize.height)):(g=c.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-a,I&&(g-=this.measurements.anchorSize.height)),g},t.prototype.getHorizontalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,eu.RIGHT),b=this.hasBit(this.anchorCorner,eu.RIGHT);if(g){var I=b?c.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?I-(this.measurements.viewportSize.width-this.measurements.bodySize.width):I}return b?c.width-this.anchorMargin.right:this.anchorMargin.left},t.prototype.getVerticalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,eu.BOTTOM),b=this.hasBit(this.anchorCorner,eu.BOTTOM),I=0;return g?I=b?c.height-this.anchorMargin.top:-this.anchorMargin.bottom:I=b?c.height+this.anchorMargin.bottom:this.anchorMargin.top,I},t.prototype.adjustPositionForHoistedElement=function(n){var c,g,b=this.measurements,I=b.windowScroll,a=b.viewportDistance,G=b.surfaceSize,W=b.viewportSize,he=Object.keys(n);try{for(var ae=ig(he),ue=ae.next();!ue.done;ue=ae.next()){var be=ue.value,Ke=n[be]||0;if(this.isHorizontallyCenteredOnViewport&&(be==="left"||be==="right")){n[be]=(W.width-G.width)/2;continue}Ke+=a[be],this.isFixedPosition||(be==="top"?Ke+=I.y:be==="bottom"?Ke-=I.y:be==="left"?Ke+=I.x:Ke-=I.x),n[be]=Ke}}catch(ot){c={error:ot}}finally{try{ue&&!ue.done&&(g=ae.return)&&g.call(ae)}finally{if(c)throw c.error}}},t.prototype.maybeRestoreFocus=function(){var n=this,c=this.adapter.isFocused(),g=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,b=g.activeElement&&this.adapter.isElementInContainer(g.activeElement);(c||b)&&setTimeout(function(){n.adapter.restoreFocus()},jm.TOUCH_EVENT_WAIT_MS)},t.prototype.hasBit=function(n,c){return!!(n&c)},t.prototype.setBit=function(n,c){return n|c},t.prototype.unsetBit=function(n,c){return n^c},t.prototype.isFinite=function(n){return typeof n=="number"&&isFinite(n)},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var lm={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},Qp={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},bE={FOCUS_ROOT_INDEX:-1},tm;(function(e){e[e.NONE=0]="NONE",e[e.LIST_ROOT=1]="LIST_ROOT",e[e.FIRST_ITEM=2]="FIRST_ITEM",e[e.LAST_ITEM=3]="LAST_ITEM"})(tm||(tm={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var wE=function(e){s0(t,e);function t(n){var c=e.call(this,nu(nu({},t.defaultAdapter),n))||this;return c.closeAnimationEndTimerId=0,c.defaultFocusState=tm.LIST_ROOT,c.selectedIndex=-1,c}return Object.defineProperty(t,"cssClasses",{get:function(){return lm},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return Qp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return bE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},t.prototype.handleKeydown=function(n){var c=n.key,g=n.keyCode,b=c==="Tab"||g===9;b&&this.adapter.closeSurface(!0)},t.prototype.handleItemAction=function(n){var c=this,g=this.adapter.getElementIndex(n);if(!(g<0)){this.adapter.notifySelected({index:g});var b=this.adapter.getAttributeFromElementAtIndex(g,Qp.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(b),this.closeAnimationEndTimerId=setTimeout(function(){var I=c.adapter.getElementIndex(n);I>=0&&c.adapter.isSelectableItemAtIndex(I)&&c.setSelectedIndex(I)},c3.numbers.TRANSITION_CLOSE_DURATION)}},t.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case tm.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case tm.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case tm.NONE:break;default:this.adapter.focusListRoot();break}},t.prototype.setDefaultFocusState=function(n){this.defaultFocusState=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n){if(this.validatedIndex(n),!this.adapter.isSelectableItemAtIndex(n))throw new Error("MDCMenuFoundation: No selection group at specified index.");var c=this.adapter.getSelectedSiblingOfItemAtIndex(n);c>=0&&(this.adapter.removeAttributeFromElementAtIndex(c,Qp.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(c,lm.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(n,lm.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=n},t.prototype.setEnabled=function(n,c){this.validatedIndex(n),c?(this.adapter.removeClassFromElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Qp.ARIA_DISABLED_ATTR,"true"))},t.prototype.validatedIndex=function(n){var c=this.adapter.getMenuItemCount(),g=n>=0&&n<c;if(!g)throw new Error("MDCMenuFoundation: No list item at specified index.")},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var SE={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},H2={NOTCH_ELEMENT_PADDING:8},IE={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var EE=function(e){s0(t,e);function t(n){return e.call(this,nu(nu({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"strings",{get:function(){return SE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return IE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return H2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),t.prototype.notch=function(n){var c=t.cssClasses.OUTLINE_NOTCHED;n>0&&(n+=H2.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(n),this.adapter.addClass(c)},t.prototype.closeNotch=function(){var n=t.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(n),this.adapter.removeNotchWidthProperty()},t}(a0);/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function CE(e){return e===void 0&&(e=window),TE(e)?{passive:!0}:!1}function TE(e){e===void 0&&(e=window);var t=!1;try{var n={get passive(){return t=!0,!1}},c=function(){};e.document.addEventListener("test",c,n),e.document.removeEventListener("test",c,n)}catch{t=!1}return t}const kE=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:CE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ME={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},PE={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},j2={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},Og;function DE(e,t){t===void 0&&(t=!1);var n=e.CSS,c=Og;if(typeof Og=="boolean"&&!t)return Og;var g=n&&typeof n.supports=="function";if(!g)return!1;var b=n.supports("--css-vars","yes"),I=n.supports("(--css-vars: yes)")&&n.supports("color","#00000000");return c=b||I,t||(Og=c),c}function LE(e,t,n){if(!e)return{x:0,y:0};var c=t.x,g=t.y,b=c+n.left,I=g+n.top,a,G;if(e.type==="touchstart"){var W=e;a=W.changedTouches[0].pageX-b,G=W.changedTouches[0].pageY-I}else{var he=e;a=he.pageX-b,G=he.pageY-I}return{x:a,y:G}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Z2=["touchstart","pointerdown","mousedown","keydown"],Q2=["touchend","pointerup","mouseup","contextmenu"],Ng=[],BE=function(e){s0(t,e);function t(n){var c=e.call(this,nu(nu({},t.defaultAdapter),n))||this;return c.activationAnimationHasEnded=!1,c.activationTimer=0,c.fgDeactivationRemovalTimer=0,c.fgScale="0",c.frame={width:0,height:0},c.initialSize=0,c.layoutFrame=0,c.maxRadius=0,c.unboundedCoords={left:0,top:0},c.activationState=c.defaultActivationState(),c.activationTimerCallback=function(){c.activationAnimationHasEnded=!0,c.runDeactivationUXLogicIfReady()},c.activateHandler=function(g){c.activateImpl(g)},c.deactivateHandler=function(){c.deactivateImpl()},c.focusHandler=function(){c.handleFocus()},c.blurHandler=function(){c.handleBlur()},c.resizeHandler=function(){c.layout()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return ME},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return PE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return j2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=this,c=this.supportsPressRipple();if(this.registerRootHandlers(c),c){var g=t.cssClasses,b=g.ROOT,I=g.UNBOUNDED;requestAnimationFrame(function(){n.adapter.addClass(b),n.adapter.isUnbounded()&&(n.adapter.addClass(I),n.layoutInternal())})}},t.prototype.destroy=function(){var n=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(t.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(t.cssClasses.FG_DEACTIVATION));var c=t.cssClasses,g=c.ROOT,b=c.UNBOUNDED;requestAnimationFrame(function(){n.adapter.removeClass(g),n.adapter.removeClass(b),n.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},t.prototype.activate=function(n){this.activateImpl(n)},t.prototype.deactivate=function(){this.deactivateImpl()},t.prototype.layout=function(){var n=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){n.layoutInternal(),n.layoutFrame=0})},t.prototype.setUnbounded=function(n){var c=t.cssClasses.UNBOUNDED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleFocus=function(){var n=this;requestAnimationFrame(function(){return n.adapter.addClass(t.cssClasses.BG_FOCUSED)})},t.prototype.handleBlur=function(){var n=this;requestAnimationFrame(function(){return n.adapter.removeClass(t.cssClasses.BG_FOCUSED)})},t.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},t.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},t.prototype.registerRootHandlers=function(n){var c,g;if(n){try{for(var b=ig(Z2),I=b.next();!I.done;I=b.next()){var a=I.value;this.adapter.registerInteractionHandler(a,this.activateHandler)}}catch(G){c={error:G}}finally{try{I&&!I.done&&(g=b.return)&&g.call(b)}finally{if(c)throw c.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},t.prototype.registerDeactivationHandlers=function(n){var c,g;if(n.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var b=ig(Q2),I=b.next();!I.done;I=b.next()){var a=I.value;this.adapter.registerDocumentInteractionHandler(a,this.deactivateHandler)}}catch(G){c={error:G}}finally{try{I&&!I.done&&(g=b.return)&&g.call(b)}finally{if(c)throw c.error}}},t.prototype.deregisterRootHandlers=function(){var n,c;try{for(var g=ig(Z2),b=g.next();!b.done;b=g.next()){var I=b.value;this.adapter.deregisterInteractionHandler(I,this.activateHandler)}}catch(a){n={error:a}}finally{try{b&&!b.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},t.prototype.deregisterDeactivationHandlers=function(){var n,c;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var g=ig(Q2),b=g.next();!b.done;b=g.next()){var I=b.value;this.adapter.deregisterDocumentInteractionHandler(I,this.deactivateHandler)}}catch(a){n={error:a}}finally{try{b&&!b.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}},t.prototype.removeCssVars=function(){var n=this,c=t.strings,g=Object.keys(c);g.forEach(function(b){b.indexOf("VAR_")===0&&n.adapter.updateCssVariable(c[b],null)})},t.prototype.activateImpl=function(n){var c=this;if(!this.adapter.isSurfaceDisabled()){var g=this.activationState;if(!g.isActivated){var b=this.previousActivationEvent,I=b&&n!==void 0&&b.type!==n.type;if(!I){g.isActivated=!0,g.isProgrammatic=n===void 0,g.activationEvent=n,g.wasActivatedByPointer=g.isProgrammatic?!1:n!==void 0&&(n.type==="mousedown"||n.type==="touchstart"||n.type==="pointerdown");var a=n!==void 0&&Ng.length>0&&Ng.some(function(G){return c.adapter.containsEventTarget(G)});if(a){this.resetActivationState();return}n!==void 0&&(Ng.push(n.target),this.registerDeactivationHandlers(n)),g.wasElementMadeActive=this.checkElementMadeActive(n),g.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Ng=[],!g.wasElementMadeActive&&n!==void 0&&(n.key===" "||n.keyCode===32)&&(g.wasElementMadeActive=c.checkElementMadeActive(n),g.wasElementMadeActive&&c.animateActivation()),g.wasElementMadeActive||(c.activationState=c.defaultActivationState())})}}}},t.prototype.checkElementMadeActive=function(n){return n!==void 0&&n.type==="keydown"?this.adapter.isSurfaceActive():!0},t.prototype.animateActivation=function(){var n=this,c=t.strings,g=c.VAR_FG_TRANSLATE_START,b=c.VAR_FG_TRANSLATE_END,I=t.cssClasses,a=I.FG_DEACTIVATION,G=I.FG_ACTIVATION,W=t.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var he="",ae="";if(!this.adapter.isUnbounded()){var ue=this.getFgTranslationCoordinates(),be=ue.startPoint,Ke=ue.endPoint;he=be.x+"px, "+be.y+"px",ae=Ke.x+"px, "+Ke.y+"px"}this.adapter.updateCssVariable(g,he),this.adapter.updateCssVariable(b,ae),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(a),this.adapter.computeBoundingRect(),this.adapter.addClass(G),this.activationTimer=setTimeout(function(){n.activationTimerCallback()},W)},t.prototype.getFgTranslationCoordinates=function(){var n=this.activationState,c=n.activationEvent,g=n.wasActivatedByPointer,b;g?b=LE(c,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):b={x:this.frame.width/2,y:this.frame.height/2},b={x:b.x-this.initialSize/2,y:b.y-this.initialSize/2};var I={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:b,endPoint:I}},t.prototype.runDeactivationUXLogicIfReady=function(){var n=this,c=t.cssClasses.FG_DEACTIVATION,g=this.activationState,b=g.hasDeactivationUXRun,I=g.isActivated,a=b||!I;a&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(c),this.fgDeactivationRemovalTimer=setTimeout(function(){n.adapter.removeClass(c)},j2.FG_DEACTIVATION_MS))},t.prototype.rmBoundedActivationClasses=function(){var n=t.cssClasses.FG_ACTIVATION;this.adapter.removeClass(n),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},t.prototype.resetActivationState=function(){var n=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return n.previousActivationEvent=void 0},t.numbers.TAP_DELAY_MS)},t.prototype.deactivateImpl=function(){var n=this,c=this.activationState;if(c.isActivated){var g=nu({},c);c.isProgrammatic?(requestAnimationFrame(function(){n.animateDeactivation(g)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){n.activationState.hasDeactivationUXRun=!0,n.animateDeactivation(g),n.resetActivationState()}))}},t.prototype.animateDeactivation=function(n){var c=n.wasActivatedByPointer,g=n.wasElementMadeActive;(c||g)&&this.runDeactivationUXLogicIfReady()},t.prototype.layoutInternal=function(){var n=this;this.frame=this.adapter.computeBoundingRect();var c=Math.max(this.frame.height,this.frame.width),g=function(){var I=Math.sqrt(Math.pow(n.frame.width,2)+Math.pow(n.frame.height,2));return I+t.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?c:g();var b=Math.floor(c*t.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&b%2!==0?this.initialSize=b-1:this.initialSize=b,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},t.prototype.updateLayoutCssVars=function(){var n=t.strings,c=n.VAR_FG_SIZE,g=n.VAR_LEFT,b=n.VAR_TOP,I=n.VAR_FG_SCALE;this.adapter.updateCssVariable(c,this.initialSize+"px"),this.adapter.updateCssVariable(I,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(g,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(b,this.unboundedCoords.top+"px"))},t}(a0);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Rl={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},M1={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},Vd={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var zE=function(e){s0(t,e);function t(n,c){c===void 0&&(c={});var g=e.call(this,nu(nu({},t.defaultAdapter),n))||this;return g.disabled=!1,g.isMenuOpen=!1,g.useDefaultValidation=!0,g.customValidity=!0,g.lastSelectedIndex=Vd.UNSET_INDEX,g.clickDebounceTimeout=0,g.recentlyClicked=!1,g.leadingIcon=c.leadingIcon,g.helperText=c.helperText,g}return Object.defineProperty(t,"cssClasses",{get:function(){return Rl},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Vd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return M1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),t.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},t.prototype.setSelectedIndex=function(n,c,g){c===void 0&&(c=!1),g===void 0&&(g=!1),!(n>=this.adapter.getMenuItemCount())&&(n===Vd.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(n).trim()),this.adapter.setSelectedIndex(n),c&&this.adapter.closeMenu(),!g&&this.lastSelectedIndex!==n&&this.handleChange(),this.lastSelectedIndex=n)},t.prototype.setValue=function(n,c){c===void 0&&(c=!1);var g=this.adapter.getMenuItemValues().indexOf(n);this.setSelectedIndex(g,!1,c)},t.prototype.getValue=function(){var n=this.adapter.getSelectedIndex(),c=this.adapter.getMenuItemValues();return n!==Vd.UNSET_INDEX?c[n]:""},t.prototype.getDisabled=function(){return this.disabled},t.prototype.setDisabled=function(n){this.disabled=n,this.disabled?(this.adapter.addClass(Rl.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(Rl.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},t.prototype.openMenu=function(){this.adapter.addClass(Rl.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},t.prototype.setHelperTextContent=function(n){this.helperText&&this.helperText.setContent(n)},t.prototype.layout=function(){if(this.adapter.hasLabel()){var n=this.getValue().length>0,c=this.adapter.hasClass(Rl.FOCUSED),g=n||c,b=this.adapter.hasClass(Rl.REQUIRED);this.notchOutline(g),this.adapter.floatLabel(g),this.adapter.setLabelRequired(b)}},t.prototype.layoutOptions=function(){var n=this.adapter.getMenuItemValues(),c=n.indexOf(this.getValue());this.setSelectedIndex(c,!1,!0)},t.prototype.handleMenuOpened=function(){if(this.adapter.getMenuItemValues().length!==0){var n=this.getSelectedIndex(),c=n>=0?n:0;this.adapter.focusMenuItemAtIndex(c)}},t.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},t.prototype.handleMenuClosed=function(){this.adapter.removeClass(Rl.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},t.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue());var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.handleMenuItemAction=function(n){this.setSelectedIndex(n,!0)},t.prototype.handleFocus=function(){this.adapter.addClass(Rl.FOCUSED),this.layout(),this.adapter.activateBottomLine()},t.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},t.prototype.handleClick=function(n){if(!(this.disabled||this.recentlyClicked)){if(this.setClickDebounceTimeout(),this.isMenuOpen){this.adapter.closeMenu();return}this.adapter.setRippleCenter(n),this.openMenu()}},t.prototype.handleKeydown=function(n){if(!(this.isMenuOpen||!this.adapter.hasClass(Rl.FOCUSED))){var c=fu(n)===Os.ENTER,g=fu(n)===Os.SPACEBAR,b=fu(n)===Os.ARROW_UP,I=fu(n)===Os.ARROW_DOWN,a=n.ctrlKey||n.metaKey;if(!a&&(!g&&n.key&&n.key.length===1||g&&this.adapter.isTypeaheadInProgress())){var G=g?" ":n.key,W=this.adapter.typeaheadMatchItem(G,this.getSelectedIndex());W>=0&&this.setSelectedIndex(W),n.preventDefault();return}!c&&!g&&!b&&!I||(this.openMenu(),n.preventDefault())}},t.prototype.notchOutline=function(n){if(this.adapter.hasOutline()){var c=this.adapter.hasClass(Rl.FOCUSED);if(n){var g=Vd.LABEL_SCALE,b=this.adapter.getLabelWidth()*g;this.adapter.notchOutline(b)}else c||this.adapter.closeOutline()}},t.prototype.setLeadingIconAriaLabel=function(n){this.leadingIcon&&this.leadingIcon.setAriaLabel(n)},t.prototype.setLeadingIconContent=function(n){this.leadingIcon&&this.leadingIcon.setContent(n)},t.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},t.prototype.setUseDefaultValidation=function(n){this.useDefaultValidation=n},t.prototype.setValid=function(n){this.useDefaultValidation||(this.customValidity=n),this.adapter.setSelectAnchorAttr("aria-invalid",(!n).toString()),n?(this.adapter.removeClass(Rl.INVALID),this.adapter.removeMenuClass(Rl.MENU_INVALID)):(this.adapter.addClass(Rl.INVALID),this.adapter.addMenuClass(Rl.MENU_INVALID)),this.syncHelperTextValidity(n)},t.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(Rl.REQUIRED)&&!this.adapter.hasClass(Rl.DISABLED)?this.getSelectedIndex()!==Vd.UNSET_INDEX&&(this.getSelectedIndex()!==0||!!this.getValue()):this.customValidity},t.prototype.setRequired=function(n){n?this.adapter.addClass(Rl.REQUIRED):this.adapter.removeClass(Rl.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",n.toString()),this.adapter.setLabelRequired(n)},t.prototype.getRequired=function(){return this.adapter.getSelectAnchorAttr("aria-required")==="true"},t.prototype.init=function(){var n=this.adapter.getAnchorElement();n&&(this.adapter.setMenuAnchorElement(n),this.adapter.setMenuAnchorCorner(Qd.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(Rl.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(Rl.INVALID)),this.layout(),this.layoutOptions()},t.prototype.blur=function(){this.adapter.removeClass(Rl.FOCUSED),this.layout(),this.adapter.deactivateBottomLine();var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.syncHelperTextValidity=function(n){if(this.helperText){this.helperText.setValidity(n);var c=this.helperText.isVisible(),g=this.helperText.getId();c&&g?this.adapter.setSelectAnchorAttr(M1.ARIA_DESCRIBEDBY,g):this.adapter.removeSelectAnchorAttr(M1.ARIA_DESCRIBEDBY)}},t.prototype.setClickDebounceTimeout=function(){var n=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout(function(){n.recentlyClicked=!1},Vd.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},t}(a0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ud={ARIA_HIDDEN:"aria-hidden",ROLE:"role"},Zf={HELPER_TEXT_VALIDATION_MSG:"mdc-select-helper-text--validation-msg",HELPER_TEXT_VALIDATION_MSG_PERSISTENT:"mdc-select-helper-text--validation-msg-persistent"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var RE=function(e){s0(t,e);function t(n){return e.call(this,nu(nu({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"cssClasses",{get:function(){return Zf},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return Ud},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},getAttr:function(){return null},removeAttr:function(){},setContent:function(){}}},enumerable:!1,configurable:!0}),t.prototype.getId=function(){return this.adapter.getAttr("id")},t.prototype.isVisible=function(){return this.adapter.getAttr(Ud.ARIA_HIDDEN)!=="true"},t.prototype.setContent=function(n){this.adapter.setContent(n)},t.prototype.setValidation=function(n){n?this.adapter.addClass(Zf.HELPER_TEXT_VALIDATION_MSG):this.adapter.removeClass(Zf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.setValidationMsgPersistent=function(n){n?this.adapter.addClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT):this.adapter.removeClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.getIsValidation=function(){return this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.getIsValidationMsgPersistent=function(){return this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.setValidity=function(n){var c=this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG);if(c){var g=this.adapter.hasClass(Zf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT),b=!n||g;if(b){this.showToScreenReader(),n?this.adapter.removeAttr(Ud.ROLE):this.adapter.setAttr(Ud.ROLE,"alert");return}this.adapter.removeAttr(Ud.ROLE),this.hide()}},t.prototype.showToScreenReader=function(){this.adapter.removeAttr(Ud.ARIA_HIDDEN)},t.prototype.hide=function(){this.adapter.setAttr(Ud.ARIA_HIDDEN,"true")},t}(a0);function Es(e){return Object.entries(e).filter(([t,n])=>t!==""&&n).map(([t])=>t).join(" ")}function iu(e,t,n,c={bubbles:!0},g=!1){if(typeof Event>"u")throw new Error("Event not defined.");if(!e)throw new Error("Tried to dipatch event without element.");const b=new CustomEvent(t,Object.assign(Object.assign({},c),{detail:n}));if(e==null||e.dispatchEvent(b),g&&t.startsWith("SMUI")){const I=new CustomEvent(t.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},c),{detail:n}));e==null||e.dispatchEvent(I),I.defaultPrevented&&b.preventDefault()}return b}function W2(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const b=n[g],I=b.indexOf("$");I!==-1&&t.indexOf(b.substring(0,I+1))!==-1||t.indexOf(b)===-1&&(c[b]=e[b])}return c}const X2=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,FE=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function wc(e){let t,n=[];e.$on=(g,b)=>{let I=g,a=()=>{};return t?a=t(I,b):n.push([I,b]),I.match(X2)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',I),()=>{a()}};function c(g){const b=e.$$.callbacks[g.type];b&&b.slice().forEach(I=>I.call(this,g))}return g=>{const b=[],I={};t=(a,G)=>{let W=a,he=G,ae=!1;const ue=W.match(X2),be=W.match(FE),Ke=ue||be;if(W.match(/^SMUI:\w+:/)){const lt=W.split(":");let ut="";for(let Tt=0;Tt<lt.length;Tt++)ut+=Tt===lt.length-1?":"+lt[Tt]:lt[Tt].split("-").map(Pt=>Pt.slice(0,1).toUpperCase()+Pt.slice(1)).join("");console.warn(`The event ${W.split("$")[0]} has been renamed to ${ut.split("$")[0]}.`),W=ut}if(Ke){const lt=W.split(ue?":":"$");W=lt[0];const ut=lt.slice(1).reduce((Tt,Pt)=>(Tt[Pt]=!0,Tt),{});ut.passive&&(ae=ae||{},ae.passive=!0),ut.nonpassive&&(ae=ae||{},ae.passive=!1),ut.capture&&(ae=ae||{},ae.capture=!0),ut.once&&(ae=ae||{},ae.once=!0),ut.preventDefault&&(he=OE(he)),ut.stopPropagation&&(he=NE(he)),ut.stopImmediatePropagation&&(he=VE(he)),ut.self&&(he=UE(g,he)),ut.trusted&&(he=GE(he))}const ot=Y2(g,W,he,ae),tt=()=>{ot();const lt=b.indexOf(tt);lt>-1&&b.splice(lt,1)};return b.push(tt),W in I||(I[W]=Y2(g,W,c)),tt};for(let a=0;a<n.length;a++)t(n[a][0],n[a][1]);return{destroy:()=>{for(let a=0;a<b.length;a++)b[a]();for(let a of Object.entries(I))a[1]()}}}}function Y2(e,t,n,c){return e.addEventListener(t,n,c),()=>e.removeEventListener(t,n,c)}function OE(e){return function(t){return t.preventDefault(),e.call(this,t)}}function NE(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function VE(e){return function(t){return t.stopImmediatePropagation(),e.call(this,t)}}function UE(e,t){return function(n){if(n.target===e)return t.call(this,n)}}function GE(e){return function(t){if(t.isTrusted)return e.call(this,t)}}function wl(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const b=n[g];b.substring(0,t.length)===t&&(c[b.substring(t.length)]=e[b])}return c}function pc(e,t){let n=[];if(t)for(let c=0;c<t.length;c++){const g=t[c],b=Array.isArray(g)?g[0]:g;Array.isArray(g)&&g.length>1?n.push(b(e,g[1])):n.push(b(e))}return{update(c){if((c&&c.length||0)!=n.length)throw new Error("You must not change the length of an actions array.");if(c)for(let g=0;g<c.length;g++){const b=n[g];if(b&&b.update){const I=c[g];Array.isArray(I)&&I.length>1?b.update(I[1]):b.update()}}},destroy(){for(let c=0;c<n.length;c++){const g=n[c];g&&g.destroy&&g.destroy()}}}}const{applyPassive:Vg}=kE,{matches:qE}=Dv;function Wd(e,{ripple:t=!0,surface:n=!1,unbounded:c=!1,disabled:g=!1,color:b,active:I,rippleElement:a,eventTarget:G,activeTarget:W,addClass:he=Ke=>e.classList.add(Ke),removeClass:ae=Ke=>e.classList.remove(Ke),addStyle:ue=(Ke,ot)=>e.style.setProperty(Ke,ot),initPromise:be=Promise.resolve()}={}){let Ke,ot=Cu("SMUI:addLayoutListener"),tt,lt=I,ut=G,Tt=W;function Pt(){n?(he("mdc-ripple-surface"),b==="primary"?(he("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")):b==="secondary"?(ae("smui-ripple-surface--primary"),he("smui-ripple-surface--secondary")):(ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary"))):(ae("mdc-ripple-surface"),ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")),Ke&&lt!==I&&(lt=I,I?Ke.activate():I===!1&&Ke.deactivate()),t&&!Ke?(Ke=new BE({addClass:he,browserSupportsCssVars:()=>DE(window),computeBoundingRect:()=>(a||e).getBoundingClientRect(),containsEventTarget:Ge=>e.contains(Ge),deregisterDocumentInteractionHandler:(Ge,Xt)=>document.documentElement.removeEventListener(Ge,Xt,Vg()),deregisterInteractionHandler:(Ge,Xt)=>(G||e).removeEventListener(Ge,Xt,Vg()),deregisterResizeHandler:Ge=>window.removeEventListener("resize",Ge),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>I??qE(W||e,":active"),isSurfaceDisabled:()=>!!g,isUnbounded:()=>!!c,registerDocumentInteractionHandler:(Ge,Xt)=>document.documentElement.addEventListener(Ge,Xt,Vg()),registerInteractionHandler:(Ge,Xt)=>(G||e).addEventListener(Ge,Xt,Vg()),registerResizeHandler:Ge=>window.addEventListener("resize",Ge),removeClass:ae,updateCssVariable:ue}),be.then(()=>{Ke&&(Ke.init(),Ke.setUnbounded(c))})):Ke&&!t&&be.then(()=>{Ke&&(Ke.destroy(),Ke=void 0)}),Ke&&(ut!==G||Tt!==W)&&(ut=G,Tt=W,Ke.destroy(),requestAnimationFrame(()=>{Ke&&(Ke.init(),Ke.setUnbounded(c))})),!t&&c&&he("mdc-ripple-upgraded--unbounded")}Pt(),ot&&(tt=ot(zt));function zt(){Ke&&Ke.layout()}return{update(Ge){({ripple:t,surface:n,unbounded:c,disabled:g,color:b,active:I,rippleElement:a,eventTarget:G,activeTarget:W,addClass:he,removeClass:ae,addStyle:ue,initPromise:be}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:Xt=>e.classList.add(Xt),removeClass:Xt=>e.classList.remove(Xt),addStyle:(Xt,rt)=>e.style.setProperty(Xt,rt),initPromise:Promise.resolve()},Ge)),Pt()},destroy(){Ke&&(Ke.destroy(),Ke=void 0,ae("mdc-ripple-surface"),ae("smui-ripple-surface--primary"),ae("smui-ripple-surface--secondary")),tt&&tt()}}}const{document:HE}=sE;function jE(e){let t,n,c,g,b,I,a,G;const W=e[34].default,he=ru(W,e,e[33],null);let ae=[{class:c=Es({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})},{style:g=Object.entries(e[9]).map($2).concat([e[2]]).join(" ")},{role:"dialog"},e[12]],ue={};for(let be=0;be<ae.length;be+=1)ue=gr(ue,ae[be]);return{c(){t=Cr(),n=Nn("div"),he&&he.c(),this.h()},l(be){t=Tr(be),n=Vn(be,"DIV",{class:!0,style:!0,role:!0});var Ke=bn(n);he&&he.l(Ke),Ke.forEach(bi),this.h()},h(){sl(n,ue)},m(be,Ke){Gn(be,t,Ke),Gn(be,n,Ke),he&&he.m(n,null),e[35](n),I=!0,a||(G=[Gl(HE.body,"click",e[11],!0),bo(b=pc.call(null,n,e[0])),bo(e[10].call(null,n)),Gl(n,"keydown",function(){Eu(e[7]&&e[7].handleKeydown.bind(e[7]))&&(e[7]&&e[7].handleKeydown.bind(e[7])).apply(this,arguments)})],a=!0)},p(be,Ke){e=be,he&&he.p&&(!I||Ke[1]&4)&&su(he,W,e,e[33],I?ou(W,e[33],Ke,null):au(e[33]),null),sl(n,ue=ma(ae,[(!I||Ke[0]&314&&c!==(c=Es({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})))&&{class:c},(!I||Ke[0]&516&&g!==(g=Object.entries(e[9]).map($2).concat([e[2]]).join(" ")))&&{style:g},{role:"dialog"},Ke[0]&4096&&e[12]])),b&&Eu(b.update)&&Ke[0]&1&&b.update.call(null,e[0])},i(be){I||($i(he,be),I=!0)},o(be){dn(he,be),I=!1},d(be){be&&(bi(t),bi(n)),he&&he.d(be),e[35](null),a=!1,Nh(G)}}}const $2=([e,t])=>`${e}: ${t};`;function ZE(e,t,n){const c=["use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","isOpen","setOpen","setAbsolutePosition","setIsHoisted","isFixed","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t;var a,G,W;const he=wc(yc());let{use:ae=[]}=t,{class:ue=""}=t,{style:be=""}=t,{static:Ke=!1}=t,{anchor:ot=!0}=t,{fixed:tt=!1}=t,{open:lt=Ke}=t,{managed:ut=!1}=t,{fullWidth:Tt=!1}=t,{quickOpen:Pt=!1}=t,{anchorElement:zt=void 0}=t,{anchorCorner:Ge=void 0}=t,{anchorMargin:Xt={top:0,right:0,bottom:0,left:0}}=t,{maxHeight:rt=0}=t,{horizontallyCenteredOnViewport:yt=!1}=t,{openBottomBias:pt=0}=t,{neverRestoreFocus:gt=!1}=t,bt,dt,$e={},mt={},st;du("SMUI:list:role","menu"),du("SMUI:list:item:role","menuitem");const Nt=Qd;vc(()=>(n(7,dt=new c3({addClass:Ot,removeClass:_i,hasClass:Rt,hasAnchor:()=>!!zt,notifyClose:()=>{ut||n(13,lt=Ke),lt||iu(bt,"SMUIMenuSurface:closed",void 0,void 0,!0)},notifyClosing:()=>{ut||n(13,lt=Ke),lt||iu(bt,"SMUIMenuSurface:closing",void 0,void 0,!0)},notifyOpen:()=>{ut||n(13,lt=!0),lt&&iu(bt,"SMUIMenuSurface:opened",void 0,void 0,!0)},notifyOpening:()=>{lt||iu(bt,"SMUIMenuSurface:opening",void 0,void 0,!0)},isElementInContainer:Ri=>bt.contains(Ri),isRtl:()=>getComputedStyle(bt).getPropertyValue("direction")==="rtl",setTransformOrigin:Ri=>{n(9,mt["transform-origin"]=Ri,mt)},isFocused:()=>document.activeElement===bt,saveFocus:()=>{var Ri;st=(Ri=document.activeElement)!==null&&Ri!==void 0?Ri:void 0},restoreFocus:()=>{!gt&&(!bt||bt.contains(document.activeElement))&&st&&document.contains(st)&&"focus"in st&&st.focus()},getInnerDimensions:()=>({width:bt.offsetWidth,height:bt.offsetHeight}),getAnchorDimensions:()=>zt?zt.getBoundingClientRect():null,getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:Ri=>{n(9,mt.left="left"in Ri?`${Ri.left}px`:"",mt),n(9,mt.right="right"in Ri?`${Ri.right}px`:"",mt),n(9,mt.top="top"in Ri?`${Ri.top}px`:"",mt),n(9,mt.bottom="bottom"in Ri?`${Ri.bottom}px`:"",mt)},setMaxHeight:Ri=>{n(9,mt["max-height"]=Ri,mt)}})),iu(bt,"SMUIMenuSurface:mount",{get open(){return lt},set open(Ri){n(13,lt=Ri)},closeProgrammatic:Si}),dt.init(),()=>{var Ri;const ai=dt.isHoistedElement;dt.destroy(),ai&&((Ri=bt.parentNode)===null||Ri===void 0||Ri.removeChild(bt))})),wm(()=>{var gi;ot&&bt&&((gi=bt.parentElement)===null||gi===void 0||gi.classList.remove("mdc-menu-surface--anchor"))});function Rt(gi){return gi in $e?$e[gi]:yn().classList.contains(gi)}function Ot(gi){$e[gi]||n(8,$e[gi]=!0,$e)}function _i(gi){(!(gi in $e)||$e[gi])&&n(8,$e[gi]=!1,$e)}function Si(gi){dt.close(gi),n(13,lt=!1)}function Ti(gi){dt&&lt&&!ut&&dt.handleBodyClick(gi)}function Oi(){return lt}function tn(gi){n(13,lt=gi)}function qi(gi,Ri){return dt.setAbsolutePosition(gi,Ri)}function Ni(gi){return dt.setIsHoisted(gi)}function nn(){return dt.isFixed()}function yn(){return bt}function Ci(gi){pa[gi?"unshift":"push"](()=>{bt=gi,n(6,bt)})}return e.$$set=gi=>{t=gr(gr({},t),ec(gi)),n(12,g=co(t,c)),"use"in gi&&n(0,ae=gi.use),"class"in gi&&n(1,ue=gi.class),"style"in gi&&n(2,be=gi.style),"static"in gi&&n(3,Ke=gi.static),"anchor"in gi&&n(15,ot=gi.anchor),"fixed"in gi&&n(4,tt=gi.fixed),"open"in gi&&n(13,lt=gi.open),"managed"in gi&&n(16,ut=gi.managed),"fullWidth"in gi&&n(5,Tt=gi.fullWidth),"quickOpen"in gi&&n(17,Pt=gi.quickOpen),"anchorElement"in gi&&n(14,zt=gi.anchorElement),"anchorCorner"in gi&&n(18,Ge=gi.anchorCorner),"anchorMargin"in gi&&n(19,Xt=gi.anchorMargin),"maxHeight"in gi&&n(20,rt=gi.maxHeight),"horizontallyCenteredOnViewport"in gi&&n(21,yt=gi.horizontallyCenteredOnViewport),"openBottomBias"in gi&&n(22,pt=gi.openBottomBias),"neverRestoreFocus"in gi&&n(23,gt=gi.neverRestoreFocus),"$$scope"in gi&&n(33,I=gi.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073774656|e.$$.dirty[1]&3&&bt&&ot&&!(!(n(30,a=bt.parentElement)===null||a===void 0)&&a.classList.contains("mdc-menu-surface--anchor"))&&(n(31,G=bt.parentElement)===null||G===void 0||G.classList.add("mdc-menu-surface--anchor"),n(14,zt=n(32,W=bt.parentElement)!==null&&W!==void 0?W:void 0)),e.$$.dirty[0]&8320&&dt&&dt.isOpen()!==lt&&(lt?dt.open():dt.close()),e.$$.dirty[0]&131200&&dt&&dt.setQuickOpen(Pt),e.$$.dirty[0]&144&&dt&&dt.setFixedPosition(tt),e.$$.dirty[0]&1048704&&dt&&dt.setMaxHeight(rt),e.$$.dirty[0]&2097280&&dt&&dt.setIsHorizontallyCenteredOnViewport(yt),e.$$.dirty[0]&262272&&dt&&Ge!=null&&(typeof Ge=="string"?dt.setAnchorCorner(Nt[Ge]):dt.setAnchorCorner(Ge)),e.$$.dirty[0]&524416&&dt&&dt.setAnchorMargin(Xt),e.$$.dirty[0]&4194432&&dt&&dt.setOpenBottomBias(pt)},[ae,ue,be,Ke,tt,Tt,bt,dt,$e,mt,he,Ti,g,lt,zt,ot,ut,Pt,Ge,Xt,rt,yt,pt,gt,Oi,tn,qi,Ni,nn,yn,a,G,W,I,b,Ci]}class QE extends Lo{constructor(t){super(),Bo(this,t,ZE,jE,ho,{use:0,class:1,style:2,static:3,anchor:15,fixed:4,open:13,managed:16,fullWidth:5,quickOpen:17,anchorElement:14,anchorCorner:18,anchorMargin:19,maxHeight:20,horizontallyCenteredOnViewport:21,openBottomBias:22,neverRestoreFocus:23,isOpen:24,setOpen:25,setAbsolutePosition:26,setIsHoisted:27,isFixed:28,getElement:29},null,[-1,-1])}get isOpen(){return this.$$.ctx[24]}get setOpen(){return this.$$.ctx[25]}get setAbsolutePosition(){return this.$$.ctx[26]}get setIsHoisted(){return this.$$.ctx[27]}get isFixed(){return this.$$.ctx[28]}get getElement(){return this.$$.ctx[29]}}function WE(e,{addClass:t=c=>e.classList.add(c),removeClass:n=c=>e.classList.remove(c)}={}){return t("mdc-menu-surface--anchor"),{destroy(){n("mdc-menu-surface--anchor")}}}function XE(e){let t;const n=e[17].default,c=ru(n,e,e[22],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&4194304)&&su(c,n,g,g[22],t?ou(n,g[22],b,null):au(g[22]),null)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function YE(e){let t,n,c;const g=[{use:e[5]},{class:Es({[e[1]]:!0,"mdc-menu":!0})},e[9]];function b(a){e[19](a)}let I={$$slots:{default:[XE]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)I=gr(I,g[a]);return e[0]!==void 0&&(I.open=e[0]),t=new QE({props:I}),e[18](t),pa.push(()=>N0(t,"open",b)),t.$on("SMUIMenuSurface:mount",e[7]),t.$on("SMUIList:mount",e[8]),t.$on("SMUIMenuSurface:opened",e[20]),t.$on("keydown",e[6]),t.$on("SMUIList:action",e[21]),{c(){gs(t.$$.fragment)},l(a){Xs(t.$$.fragment,a)},m(a,G){_s(t,a,G),c=!0},p(a,[G]){const W=G&546?ma(g,[G&32&&{use:a[5]},G&2&&{class:Es({[a[1]]:!0,"mdc-menu":!0})},G&512&&Fs(a[9])]):{};G&4194304&&(W.$$scope={dirty:G,ctx:a}),!n&&G&1&&(n=!0,W.open=a[0],O0(()=>n=!1)),t.$set(W)},i(a){c||($i(t.$$.fragment,a),c=!0)},o(a){dn(t.$$.fragment,a),c=!1},d(a){e[18](null),ys(t,a)}}}function $E(e,t,n){let c;const g=["use","class","open","isOpen","setOpen","setDefaultFocusState","getSelectedIndex","getMenuSurface","getElement"];let b=co(t,g),{$$slots:I={},$$scope:a}=t;const{closest:G}=Dv,W=wc(yc());let{use:he=[]}=t,{class:ae=""}=t,{open:ue=!1}=t,be,Ke,ot,tt;vc(()=>(n(3,Ke=new wE({addClassToElementAtIndex:($e,mt)=>{tt.addClassForElementIndex($e,mt)},removeClassFromElementAtIndex:($e,mt)=>{tt.removeClassForElementIndex($e,mt)},addAttributeToElementAtIndex:($e,mt,st)=>{tt.setAttributeForElementIndex($e,mt,st)},removeAttributeFromElementAtIndex:($e,mt)=>{tt.removeAttributeForElementIndex($e,mt)},getAttributeFromElementAtIndex:($e,mt)=>tt.getAttributeFromElementIndex($e,mt),elementContainsClass:($e,mt)=>$e.classList.contains(mt),closeSurface:$e=>{ot.closeProgrammatic($e),iu(yt(),"SMUIMenu:closedProgrammatically")},getElementIndex:$e=>tt.getOrderedList().map(mt=>mt.element).indexOf($e),notifySelected:$e=>iu(yt(),"SMUIMenu:selected",{index:$e.index,item:tt.getOrderedList()[$e.index].element},void 0,!0),getMenuItemCount:()=>tt.items.length,focusItemAtIndex:$e=>tt.focusItemAtIndex($e),focusListRoot:()=>"focus"in tt.element&&tt.element.focus(),isSelectableItemAtIndex:$e=>!!G(tt.getOrderedList()[$e].element,`.${lm.MENU_SELECTION_GROUP}`),getSelectedSiblingOfItemAtIndex:$e=>{const mt=tt.getOrderedList(),st=G(mt[$e].element,`.${lm.MENU_SELECTION_GROUP}`),Nt=st==null?void 0:st.querySelector(`.${lm.MENU_SELECTED_LIST_ITEM}`);return Nt?mt.map(Rt=>Rt.element).indexOf(Nt):-1}})),iu(yt(),"SMUIMenu:mount",Ke),Ke.init(),()=>{Ke.destroy()}));function lt($e){Ke&&Ke.handleKeydown($e)}function ut($e){ot||(ot=$e.detail)}function Tt($e){tt||n(4,tt=$e.detail)}function Pt(){return ue}function zt($e){n(0,ue=$e)}function Ge($e){Ke.setDefaultFocusState($e)}function Xt(){return Ke.getSelectedIndex()}function rt(){return be}function yt(){return be.getElement()}function pt($e){pa[$e?"unshift":"push"](()=>{be=$e,n(2,be)})}function gt($e){ue=$e,n(0,ue)}const bt=()=>Ke&&Ke.handleMenuSurfaceOpened(),dt=$e=>Ke&&Ke.handleItemAction(tt.getOrderedList()[$e.detail.index].element);return e.$$set=$e=>{t=gr(gr({},t),ec($e)),n(9,b=co(t,g)),"use"in $e&&n(10,he=$e.use),"class"in $e&&n(1,ae=$e.class),"open"in $e&&n(0,ue=$e.open),"$$scope"in $e&&n(22,a=$e.$$scope)},e.$$.update=()=>{e.$$.dirty&1024&&n(5,c=[W,...he])},[ue,ae,be,Ke,tt,c,lt,ut,Tt,b,he,Pt,zt,Ge,Xt,rt,yt,I,pt,gt,bt,dt,a]}class KE extends Lo{constructor(t){super(),Bo(this,t,$E,YE,ho,{use:10,class:1,open:0,isOpen:11,setOpen:12,setDefaultFocusState:13,getSelectedIndex:14,getMenuSurface:15,getElement:16})}get isOpen(){return this.$$.ctx[11]}get setOpen(){return this.$$.ctx[12]}get setDefaultFocusState(){return this.$$.ctx[13]}get getSelectedIndex(){return this.$$.ctx[14]}get getMenuSurface(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}}function JE(e){let t;const n=e[10].default,c=ru(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&4096)&&su(c,n,g,g[12],t?ou(n,g[12],b,null):au(g[12]),null)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function eC(e){let t,n,c;const g=[{tag:e[3]},{use:[e[5],...e[0]]},{class:Es({[e[1]]:!0,"mdc-button__label":e[6]==="button","mdc-fab__label":e[6]==="fab","mdc-tab__text-label":e[6]==="tab","mdc-image-list__label":e[6]==="image-list","mdc-snackbar__label":e[6]==="snackbar","mdc-banner__text":e[6]==="banner","mdc-segmented-button__label":e[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":e[6]==="data-table:pagination","mdc-data-table__header-cell-label":e[6]==="data-table:sortable-header-cell"})},e[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:e[7]},e[8]];var b=e[2];function I(a,G){let W={$$slots:{default:[JE]},$$scope:{ctx:a}};if(G!==void 0&&G&491)W=ma(g,[G&8&&{tag:a[3]},G&33&&{use:[a[5],...a[0]]},G&66&&{class:Es({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},G&64&&Fs(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),G&128&&{tabindex:a[7]},G&256&&Fs(a[8])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return b&&(t=ef(b,I(e)),e[11](t)),{c(){t&&gs(t.$$.fragment),n=Ds()},l(a){t&&Xs(t.$$.fragment,a),n=Ds()},m(a,G){t&&_s(t,a,G),Gn(a,n,G),c=!0},p(a,[G]){if(G&4&&b!==(b=a[2])){if(t){Ho();const W=t;dn(W.$$.fragment,1,0,()=>{ys(W,1)}),jo()}b?(t=ef(b,I(a,G)),a[11](t),gs(t.$$.fragment),$i(t.$$.fragment,1),_s(t,n.parentNode,n)):t=null}else if(b){const W=G&491?ma(g,[G&8&&{tag:a[3]},G&33&&{use:[a[5],...a[0]]},G&66&&{class:Es({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},G&64&&Fs(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),G&128&&{tabindex:a[7]},G&256&&Fs(a[8])]):{};G&4096&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&dn(t.$$.fragment,a),c=!1},d(a){a&&bi(n),e[11](null),t&&ys(t,a)}}}function tC(e,t,n){const c=["use","class","component","tag","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t;const a=wc(yc());let{use:G=[]}=t,{class:W=""}=t,he,{component:ae=tf}=t,{tag:ue=ae===tf?"span":void 0}=t;const be=Cu("SMUI:label:context"),Ke=Cu("SMUI:label:tabindex");function ot(){return he.getElement()}function tt(lt){pa[lt?"unshift":"push"](()=>{he=lt,n(4,he)})}return e.$$set=lt=>{t=gr(gr({},t),ec(lt)),n(8,g=co(t,c)),"use"in lt&&n(0,G=lt.use),"class"in lt&&n(1,W=lt.class),"component"in lt&&n(2,ae=lt.component),"tag"in lt&&n(3,ue=lt.tag),"$$scope"in lt&&n(12,I=lt.$$scope)},[G,W,ae,ue,he,a,be,Ke,g,ot,b,tt,I]}class iC extends Lo{constructor(t){super(),Bo(this,t,tC,eC,ho,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function nC(e){let t=e[1],n,c,g=e[1]&&P1(e);return{c(){g&&g.c(),n=Ds()},l(b){g&&g.l(b),n=Ds()},m(b,I){g&&g.m(b,I),Gn(b,n,I),c=!0},p(b,I){b[1]?t?ho(t,b[1])?(g.d(1),g=P1(b),t=b[1],g.c(),g.m(n.parentNode,n)):g.p(b,I):(g=P1(b),t=b[1],g.c(),g.m(n.parentNode,n)):t&&(g.d(1),g=null,t=b[1])},i(b){c||($i(g,b),c=!0)},o(b){dn(g,b),c=!1},d(b){b&&bi(n),g&&g.d(b)}}}function rC(e){let t=e[1],n,c=e[1]&&D1(e);return{c(){c&&c.c(),n=Ds()},l(g){c&&c.l(g),n=Ds()},m(g,b){c&&c.m(g,b),Gn(g,n,b)},p(g,b){g[1]?t?ho(t,g[1])?(c.d(1),c=D1(g),t=g[1],c.c(),c.m(n.parentNode,n)):c.p(g,b):(c=D1(g),t=g[1],c.c(),c.m(n.parentNode,n)):t&&(c.d(1),c=null,t=g[1])},i:wo,o:wo,d(g){g&&bi(n),c&&c.d(g)}}}function sC(e){let t,n,c,g,b;const I=e[8].default,a=ru(I,e,e[7],null);let G=[e[5]],W={};for(let he=0;he<G.length;he+=1)W=gr(W,G[he]);return{c(){t=Ba("svg"),a&&a.c(),this.h()},l(he){t=za(he,"svg",{});var ae=bn(t);a&&a.l(ae),ae.forEach(bi),this.h()},h(){d_(t,W)},m(he,ae){Gn(he,t,ae),a&&a.m(t,null),e[9](t),c=!0,g||(b=[bo(n=pc.call(null,t,e[0])),bo(e[4].call(null,t))],g=!0)},p(he,ae){a&&a.p&&(!c||ae&128)&&su(a,I,he,he[7],c?ou(I,he[7],ae,null):au(he[7]),null),d_(t,W=ma(G,[ae&32&&he[5]])),n&&Eu(n.update)&&ae&1&&n.update.call(null,he[0])},i(he){c||($i(a,he),c=!0)},o(he){dn(a,he),c=!1},d(he){he&&bi(t),a&&a.d(he),e[9](null),g=!1,Nh(b)}}}function P1(e){let t,n,c,g,b;const I=e[8].default,a=ru(I,e,e[7],null);let G=[e[5]],W={};for(let he=0;he<G.length;he+=1)W=gr(W,G[he]);return{c(){t=Nn(e[1]),a&&a.c(),this.h()},l(he){t=Vn(he,(e[1]||"null").toUpperCase(),{});var ae=bn(t);a&&a.l(ae),ae.forEach(bi),this.h()},h(){p_(e[1])(t,W)},m(he,ae){Gn(he,t,ae),a&&a.m(t,null),e[11](t),c=!0,g||(b=[bo(n=pc.call(null,t,e[0])),bo(e[4].call(null,t))],g=!0)},p(he,ae){a&&a.p&&(!c||ae&128)&&su(a,I,he,he[7],c?ou(I,he[7],ae,null):au(he[7]),null),p_(he[1])(t,W=ma(G,[ae&32&&he[5]])),n&&Eu(n.update)&&ae&1&&n.update.call(null,he[0])},i(he){c||($i(a,he),c=!0)},o(he){dn(a,he),c=!1},d(he){he&&bi(t),a&&a.d(he),e[11](null),g=!1,Nh(b)}}}function D1(e){let t,n,c,g,b=[e[5]],I={};for(let a=0;a<b.length;a+=1)I=gr(I,b[a]);return{c(){t=Nn(e[1]),this.h()},l(a){t=Vn(a,(e[1]||"null").toUpperCase(),{}),bn(t).forEach(bi),this.h()},h(){p_(e[1])(t,I)},m(a,G){Gn(a,t,G),e[10](t),c||(g=[bo(n=pc.call(null,t,e[0])),bo(e[4].call(null,t))],c=!0)},p(a,G){p_(a[1])(t,I=ma(b,[G&32&&a[5]])),n&&Eu(n.update)&&G&1&&n.update.call(null,a[0])},d(a){a&&bi(t),e[10](null),c=!1,Nh(g)}}}function aC(e){let t,n,c,g;const b=[sC,rC,nC],I=[];function a(G,W){return G[1]==="svg"?0:G[3]?1:2}return t=a(e),n=I[t]=b[t](e),{c(){n.c(),c=Ds()},l(G){n.l(G),c=Ds()},m(G,W){I[t].m(G,W),Gn(G,c,W),g=!0},p(G,[W]){let he=t;t=a(G),t===he?I[t].p(G,W):(Ho(),dn(I[he],1,1,()=>{I[he]=null}),jo(),n=I[t],n?n.p(G,W):(n=I[t]=b[t](G),n.c()),$i(n,1),n.m(c.parentNode,c))},i(G){g||($i(n),g=!0)},o(G){dn(n),g=!1},d(G){G&&bi(c),I[t].d(G)}}}function oC(e,t,n){let c;const g=["use","tag","getElement"];let b=co(t,g),{$$slots:I={},$$scope:a}=t,{use:G=[]}=t,{tag:W}=t;const he=wc(yc());let ae;function ue(){return ae}function be(tt){pa[tt?"unshift":"push"](()=>{ae=tt,n(2,ae)})}function Ke(tt){pa[tt?"unshift":"push"](()=>{ae=tt,n(2,ae)})}function ot(tt){pa[tt?"unshift":"push"](()=>{ae=tt,n(2,ae)})}return e.$$set=tt=>{t=gr(gr({},t),ec(tt)),n(5,b=co(t,g)),"use"in tt&&n(0,G=tt.use),"tag"in tt&&n(1,W=tt.tag),"$$scope"in tt&&n(7,a=tt.$$scope)},e.$$.update=()=>{e.$$.dirty&2&&n(3,c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(W)>-1)},[G,W,ae,c,he,b,ue,a,I,be,Ke,ot]}class tf extends Lo{constructor(t){super(),Bo(this,t,oC,aC,ho,{use:0,tag:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}function lC(e){let t;const n=e[11].default,c=ru(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&8192)&&su(c,n,g,g[13],t?ou(n,g[13],b,null):au(g[13]),null)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function uC(e){let t,n,c;const g=[{tag:e[3]},{use:[e[8],...e[0]]},{class:Es({[e[1]]:!0,[e[6]]:!0,...e[5]})},e[7],e[9]];var b=e[2];function I(a,G){let W={$$slots:{default:[lC]},$$scope:{ctx:a}};if(G!==void 0&&G&1003)W=ma(g,[G&8&&{tag:a[3]},G&257&&{use:[a[8],...a[0]]},G&98&&{class:Es({[a[1]]:!0,[a[6]]:!0,...a[5]})},G&128&&Fs(a[7]),G&512&&Fs(a[9])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return b&&(t=ef(b,I(e)),e[12](t)),{c(){t&&gs(t.$$.fragment),n=Ds()},l(a){t&&Xs(t.$$.fragment,a),n=Ds()},m(a,G){t&&_s(t,a,G),Gn(a,n,G),c=!0},p(a,[G]){if(G&4&&b!==(b=a[2])){if(t){Ho();const W=t;dn(W.$$.fragment,1,0,()=>{ys(W,1)}),jo()}b?(t=ef(b,I(a,G)),a[12](t),gs(t.$$.fragment),$i(t.$$.fragment,1),_s(t,n.parentNode,n)):t=null}else if(b){const W=G&1003?ma(g,[G&8&&{tag:a[3]},G&257&&{use:[a[8],...a[0]]},G&98&&{class:Es({[a[1]]:!0,[a[6]]:!0,...a[5]})},G&128&&Fs(a[7]),G&512&&Fs(a[9])]):{};G&8192&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&dn(t.$$.fragment,a),c=!1},d(a){a&&bi(n),e[12](null),t&&ys(t,a)}}}const Kf={component:tf,tag:"div",class:"",classMap:{},contexts:{},props:{}};function cC(e,t,n){const c=["use","class","component","tag","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t,{use:a=[]}=t,{class:G=""}=t,W;const he=Kf.class,ae={},ue=[],be=Kf.contexts,Ke=Kf.props;let{component:ot=Kf.component}=t,{tag:tt=ot===tf?Kf.tag:void 0}=t;Object.entries(Kf.classMap).forEach(([Pt,zt])=>{const Ge=Cu(zt);Ge&&"subscribe"in Ge&&ue.push(Ge.subscribe(Xt=>{n(5,ae[Pt]=Xt,ae)}))});const lt=wc(yc());for(let Pt in be)be.hasOwnProperty(Pt)&&du(Pt,be[Pt]);wm(()=>{for(const Pt of ue)Pt()});function ut(){return W.getElement()}function Tt(Pt){pa[Pt?"unshift":"push"](()=>{W=Pt,n(4,W)})}return e.$$set=Pt=>{t=gr(gr({},t),ec(Pt)),n(9,g=co(t,c)),"use"in Pt&&n(0,a=Pt.use),"class"in Pt&&n(1,G=Pt.class),"component"in Pt&&n(2,ot=Pt.component),"tag"in Pt&&n(3,tt=Pt.tag),"$$scope"in Pt&&n(13,I=Pt.$$scope)},[a,G,ot,tt,W,ae,he,Ke,lt,g,ut,b,Tt,I]}class hC extends Lo{constructor(t){super(),Bo(this,t,cC,uC,ho,{use:0,class:1,component:2,tag:3,getElement:10})}get getElement(){return this.$$.ctx[10]}}const K2=Object.assign({},Kf);function cp(e){return new Proxy(hC,{construct:function(t,n){return Object.assign(Kf,K2,e),new t(...n)},get:function(t,n){return Object.assign(Kf,K2,e),t[n]}})}function AC(e){let t;const n=e[42].default,c=ru(n,e,e[44],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b[1]&8192)&&su(c,n,g,g[44],t?ou(n,g[44],b,null):au(g[44]),null)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function fC(e){let t,n,c;const g=[{tag:e[13]},{use:[e[16],...e[0]]},{class:Es({[e[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":e[2],"mdc-deprecated-list--dense":e[3],"mdc-deprecated-list--textual-list":e[4],"mdc-deprecated-list--avatar-list":e[5]||e[17],"mdc-deprecated-list--icon-list":e[6],"mdc-deprecated-list--image-list":e[7],"mdc-deprecated-list--thumbnail-list":e[8],"mdc-deprecated-list--video-list":e[9],"mdc-deprecated-list--two-line":e[10],"smui-list--three-line":e[11]&&!e[10]})},{role:e[15]},e[25]];var b=e[12];function I(a,G){let W={$$slots:{default:[AC]},$$scope:{ctx:a}};if(G!==void 0&&G[0]&33796095)W=ma(g,[G[0]&8192&&{tag:a[13]},G[0]&65537&&{use:[a[16],...a[0]]},G[0]&135166&&{class:Es({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},G[0]&32768&&{role:a[15]},G[0]&33554432&&Fs(a[25])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return b&&(t=ef(b,I(e)),e[43](t),t.$on("keydown",e[20]),t.$on("focusin",e[21]),t.$on("focusout",e[22]),t.$on("click",e[23]),t.$on("SMUIListItem:mount",e[18]),t.$on("SMUIListItem:unmount",e[19]),t.$on("SMUI:action",e[24])),{c(){t&&gs(t.$$.fragment),n=Ds()},l(a){t&&Xs(t.$$.fragment,a),n=Ds()},m(a,G){t&&_s(t,a,G),Gn(a,n,G),c=!0},p(a,G){if(G[0]&4096&&b!==(b=a[12])){if(t){Ho();const W=t;dn(W.$$.fragment,1,0,()=>{ys(W,1)}),jo()}b?(t=ef(b,I(a,G)),a[43](t),t.$on("keydown",a[20]),t.$on("focusin",a[21]),t.$on("focusout",a[22]),t.$on("click",a[23]),t.$on("SMUIListItem:mount",a[18]),t.$on("SMUIListItem:unmount",a[19]),t.$on("SMUI:action",a[24]),gs(t.$$.fragment),$i(t.$$.fragment,1),_s(t,n.parentNode,n)):t=null}else if(b){const W=G[0]&33796095?ma(g,[G[0]&8192&&{tag:a[13]},G[0]&65537&&{use:[a[16],...a[0]]},G[0]&135166&&{class:Es({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},G[0]&32768&&{role:a[15]},G[0]&33554432&&Fs(a[25])]):{};G[1]&8192&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&dn(t.$$.fragment,a),c=!1},d(a){a&&bi(n),e[43](null),t&&ys(t,a)}}}function dC(e,t,n){const c=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","focusItemAtIndex","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t;var a;const{closest:G,matches:W}=Dv,he=wc(yc());let{use:ae=[]}=t,{class:ue=""}=t,{nonInteractive:be=!1}=t,{dense:Ke=!1}=t,{textualList:ot=!1}=t,{avatarList:tt=!1}=t,{iconList:lt=!1}=t,{imageList:ut=!1}=t,{thumbnailList:Tt=!1}=t,{videoList:Pt=!1}=t,{twoLine:zt=!1}=t,{threeLine:Ge=!1}=t,{vertical:Xt=!0}=t,{wrapFocus:rt=(a=Cu("SMUI:list:wrapFocus"))!==null&&a!==void 0?a:!1}=t,{singleSelection:yt=!1}=t,{disabledItemsFocusable:pt=!1}=t,{selectedIndex:gt=-1}=t,{radioList:bt=!1}=t,{checkList:dt=!1}=t,{hasTypeahead:$e=!1}=t,mt,st,Nt=[],Rt=Cu("SMUI:list:role"),Ot=Cu("SMUI:list:nav");const _i=new WeakMap;let Si=Cu("SMUI:dialog:selection"),Ti=Cu("SMUI:addLayoutListener"),Oi,{component:tn=tf}=t,{tag:qi=tn===tf?Ot?"nav":"ul":void 0}=t;du("SMUI:list:nonInteractive",be),du("SMUI:separator:context","list"),Rt||(yt?(Rt="listbox",du("SMUI:list:item:role","option")):bt?(Rt="radiogroup",du("SMUI:list:item:role","radio")):dt?(Rt="group",du("SMUI:list:item:role","checkbox")):(Rt="list",du("SMUI:list:item:role",void 0))),Ti&&(Oi=Ti(tr)),vc(()=>{n(41,st=new xE({addClassForElementIndex:fi,focusItemAtIndex:k,getAttributeForElementIndex:(fe,ve)=>{var Ie,Ee;return(Ee=(Ie=Ki()[fe])===null||Ie===void 0?void 0:Ie.getAttr(ve))!==null&&Ee!==void 0?Ee:null},getFocusedElementIndex:()=>document.activeElement?Ki().map(fe=>fe.element).indexOf(document.activeElement):-1,getListItemCount:()=>Nt.length,getPrimaryTextAtIndex:hi,hasCheckboxAtIndex:fe=>{var ve,Ie;return(Ie=(ve=Ki()[fe])===null||ve===void 0?void 0:ve.hasCheckbox)!==null&&Ie!==void 0?Ie:!1},hasRadioAtIndex:fe=>{var ve,Ie;return(Ie=(ve=Ki()[fe])===null||ve===void 0?void 0:ve.hasRadio)!==null&&Ie!==void 0?Ie:!1},isCheckboxCheckedAtIndex:fe=>{var ve;const Ie=Ki()[fe];return(ve=(Ie==null?void 0:Ie.hasCheckbox)&&Ie.checked)!==null&&ve!==void 0?ve:!1},isFocusInsideList:()=>mt!=null&&V()!==document.activeElement&&V().contains(document.activeElement),isRootFocused:()=>mt!=null&&document.activeElement===V(),listItemAtIndexHasClass:Ji,notifyAction:fe=>{n(26,gt=fe),mt!=null&&iu(V(),"SMUIList:action",{index:fe},void 0,!0)},notifySelectionChange:fe=>{mt!=null&&iu(V(),"SMUIList:selectionChange",{changedIndices:fe})},removeClassForElementIndex:pn,setAttributeForElementIndex:ii,setCheckedCheckboxOrRadioAtIndex:(fe,ve)=>{Ki()[fe].checked=ve},setTabIndexForListItemChildren:(fe,ve)=>{const Ie=Ki()[fe];Array.prototype.forEach.call(Ie.element.querySelectorAll("button:not(:disabled), a"),ze=>{ze.setAttribute("tabindex",ve)})}}));const te={get element(){return V()},get items(){return Nt},get typeaheadInProgress(){return st.isTypeaheadInProgress()},typeaheadMatchItem(fe,ve){return st.typeaheadMatchItem(fe,ve,!0)},getOrderedList:Ki,focusItemAtIndex:k,addClassForElementIndex:fi,removeClassForElementIndex:pn,setAttributeForElementIndex:ii,removeAttributeForElementIndex:wn,getAttributeFromElementIndex:Rr,getPrimaryTextAtIndex:hi};return iu(V(),"SMUIList:mount",te),st.init(),st.layout(),()=>{st.destroy()}}),wm(()=>{Oi&&Oi()});function Ni(te){Nt.push(te.detail),_i.set(te.detail.element,te.detail),yt&&te.detail.selected&&n(26,gt=en(te.detail.element)),te.stopPropagation()}function nn(te){var fe;const ve=(fe=te.detail&&Nt.indexOf(te.detail))!==null&&fe!==void 0?fe:-1;ve!==-1&&(Nt.splice(ve,1),Nt=Nt,_i.delete(te.detail.element)),te.stopPropagation()}function yn(te){st&&te.target&&st.handleKeydown(te,te.target.classList.contains("mdc-deprecated-list-item"),en(te.target))}function Ci(te){st&&te.target&&st.handleFocusIn(en(te.target))}function gi(te){st&&te.target&&st.handleFocusOut(en(te.target))}function Ri(te){st&&te.target&&st.handleClick(en(te.target),!W(te.target,'input[type="checkbox"], input[type="radio"]'),te)}function ai(te){if(bt||dt){const fe=en(te.target);if(fe!==-1){const ve=Ki()[fe];ve&&(bt&&!ve.checked||dt)&&(W(te.detail.target,'input[type="checkbox"], input[type="radio"]')||(ve.checked=!ve.checked),ve.activateRipple(),window.requestAnimationFrame(()=>{ve.deactivateRipple()}))}}}function Ki(){return mt==null?[]:[...V().children].map(te=>_i.get(te)).filter(te=>te&&te._smui_list_item_accessor)}function Ji(te,fe){var ve;const Ie=Ki()[te];return(ve=Ie&&Ie.hasClass(fe))!==null&&ve!==void 0?ve:!1}function fi(te,fe){const ve=Ki()[te];ve&&ve.addClass(fe)}function pn(te,fe){const ve=Ki()[te];ve&&ve.removeClass(fe)}function ii(te,fe,ve){const Ie=Ki()[te];Ie&&Ie.addAttr(fe,ve)}function wn(te,fe){const ve=Ki()[te];ve&&ve.removeAttr(fe)}function Rr(te,fe){const ve=Ki()[te];return ve?ve.getAttr(fe):null}function hi(te){var fe;const ve=Ki()[te];return(fe=ve&&ve.getPrimaryText())!==null&&fe!==void 0?fe:""}function en(te){const fe=G(te,".mdc-deprecated-list-item, .mdc-deprecated-list");return fe&&W(fe,".mdc-deprecated-list-item")?Ki().map(ve=>ve==null?void 0:ve.element).indexOf(fe):-1}function tr(){return st.layout()}function Fn(te,fe){return st.setEnabled(te,fe)}function Qn(){return st.isTypeaheadInProgress()}function In(){return st.getSelectedIndex()}function v(){return st.getFocusedItemIndex()}function k(te){const fe=Ki()[te];fe&&"focus"in fe.element&&fe.element.focus()}function V(){return mt.getElement()}function $(te){pa[te?"unshift":"push"](()=>{mt=te,n(14,mt)})}return e.$$set=te=>{t=gr(gr({},t),ec(te)),n(25,g=co(t,c)),"use"in te&&n(0,ae=te.use),"class"in te&&n(1,ue=te.class),"nonInteractive"in te&&n(2,be=te.nonInteractive),"dense"in te&&n(3,Ke=te.dense),"textualList"in te&&n(4,ot=te.textualList),"avatarList"in te&&n(5,tt=te.avatarList),"iconList"in te&&n(6,lt=te.iconList),"imageList"in te&&n(7,ut=te.imageList),"thumbnailList"in te&&n(8,Tt=te.thumbnailList),"videoList"in te&&n(9,Pt=te.videoList),"twoLine"in te&&n(10,zt=te.twoLine),"threeLine"in te&&n(11,Ge=te.threeLine),"vertical"in te&&n(27,Xt=te.vertical),"wrapFocus"in te&&n(28,rt=te.wrapFocus),"singleSelection"in te&&n(29,yt=te.singleSelection),"disabledItemsFocusable"in te&&n(30,pt=te.disabledItemsFocusable),"selectedIndex"in te&&n(26,gt=te.selectedIndex),"radioList"in te&&n(31,bt=te.radioList),"checkList"in te&&n(32,dt=te.checkList),"hasTypeahead"in te&&n(33,$e=te.hasTypeahead),"component"in te&&n(12,tn=te.component),"tag"in te&&n(13,qi=te.tag),"$$scope"in te&&n(44,I=te.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&134217728|e.$$.dirty[1]&1024&&st&&st.setVerticalOrientation(Xt),e.$$.dirty[0]&268435456|e.$$.dirty[1]&1024&&st&&st.setWrapFocus(rt),e.$$.dirty[1]&1028&&st&&st.setHasTypeahead($e),e.$$.dirty[0]&536870912|e.$$.dirty[1]&1024&&st&&st.setSingleSelection(yt),e.$$.dirty[0]&1073741824|e.$$.dirty[1]&1024&&st&&st.setDisabledItemsFocusable(pt),e.$$.dirty[0]&603979776|e.$$.dirty[1]&1024&&st&&yt&&In()!==gt&&st.setSelectedIndex(gt)},[ae,ue,be,Ke,ot,tt,lt,ut,Tt,Pt,zt,Ge,tn,qi,mt,Rt,he,Si,Ni,nn,yn,Ci,gi,Ri,ai,g,gt,Xt,rt,yt,pt,bt,dt,$e,tr,Fn,Qn,In,v,k,V,st,b,$,I]}class pC extends Lo{constructor(t){super(),Bo(this,t,dC,fC,ho,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:27,wrapFocus:28,singleSelection:29,disabledItemsFocusable:30,selectedIndex:26,radioList:31,checkList:32,hasTypeahead:33,component:12,tag:13,layout:34,setEnabled:35,getTypeaheadInProgress:36,getSelectedIndex:37,getFocusedItemIndex:38,focusItemAtIndex:39,getElement:40},null,[-1,-1])}get layout(){return this.$$.ctx[34]}get setEnabled(){return this.$$.ctx[35]}get getTypeaheadInProgress(){return this.$$.ctx[36]}get getSelectedIndex(){return this.$$.ctx[37]}get getFocusedItemIndex(){return this.$$.ctx[38]}get focusItemAtIndex(){return this.$$.ctx[39]}get getElement(){return this.$$.ctx[40]}}function J2(e){let t;return{c(){t=Nn("span"),this.h()},l(n){t=Vn(n,"SPAN",{class:!0}),bn(t).forEach(bi),this.h()},h(){Pi(t,"class","mdc-deprecated-list-item__ripple")},m(n,c){Gn(n,t,c)},d(n){n&&bi(t)}}}function mC(e){let t,n,c=e[7]&&J2();const g=e[34].default,b=ru(g,e,e[37],null);return{c(){c&&c.c(),t=Ds(),b&&b.c()},l(I){c&&c.l(I),t=Ds(),b&&b.l(I)},m(I,a){c&&c.m(I,a),Gn(I,t,a),b&&b.m(I,a),n=!0},p(I,a){I[7]?c||(c=J2(),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),b&&b.p&&(!n||a[1]&64)&&su(b,g,I,I[37],n?ou(g,I[37],a,null):au(I[37]),null)},i(I){n||($i(b,I),n=!0)},o(I){dn(b,I),n=!1},d(I){I&&bi(t),c&&c.d(I),b&&b.d(I)}}}function gC(e){let t,n,c;const g=[{tag:e[14]},{use:[...e[6]?[]:[[Wd,{ripple:!e[16],unbounded:!1,color:(e[1]||e[0])&&e[5]==null?"primary":e[5],disabled:e[10],addClass:e[24],removeClass:e[25],addStyle:e[26]}]],e[22],...e[2]]},{class:Es({[e[3]]:!0,"mdc-deprecated-list-item":!e[8],"mdc-deprecated-list-item__wrapper":e[8],"mdc-deprecated-list-item--activated":e[1],"mdc-deprecated-list-item--selected":e[0],"mdc-deprecated-list-item--disabled":e[10],"mdc-menu-item--selected":!e[23]&&e[9]==="menuitem"&&e[0],"smui-menu-item--non-interactive":e[6],...e[18]})},{style:Object.entries(e[19]).map(L1).concat([e[4]]).join(" ")},e[23]&&e[1]?{"aria-current":"page"}:{},!e[23]||e[8]?{role:e[9]}:{},!e[23]&&e[9]==="option"?{"aria-selected":e[0]?"true":"false"}:{},!e[23]&&(e[9]==="radio"||e[9]==="checkbox")?{"aria-checked":e[16]&&e[16].checked?"true":"false"}:{},e[23]?{}:{"aria-disabled":e[10]?"true":"false"},{"data-menu-item-skip-restore-focus":e[11]||void 0},{tabindex:e[21]},{href:e[12]},e[20],e[29]];var b=e[13];function I(a,G){let W={$$slots:{default:[mC]},$$scope:{ctx:a}};if(G!==void 0&&G[0]&670916479)W=ma(g,[G[0]&16384&&{tag:a[14]},G[0]&121701479&&{use:[...a[6]?[]:[[Wd,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},G[0]&8652619&&{class:Es({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},G[0]&524304&&{style:Object.entries(a[19]).map(L1).concat([a[4]]).join(" ")},G[0]&8388610&&Fs(a[23]&&a[1]?{"aria-current":"page"}:{}),G[0]&8389376&&Fs(!a[23]||a[8]?{role:a[9]}:{}),G[0]&8389121&&Fs(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),G[0]&8454656&&Fs(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),G[0]&8389632&&Fs(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),G[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},G[0]&2097152&&{tabindex:a[21]},G[0]&4096&&{href:a[12]},G[0]&1048576&&Fs(a[20]),G[0]&536870912&&Fs(a[29])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return b&&(t=ef(b,I(e)),e[35](t),t.$on("click",e[15]),t.$on("keydown",e[27]),t.$on("SMUIGenericInput:mount",e[28]),t.$on("SMUIGenericInput:unmount",e[36])),{c(){t&&gs(t.$$.fragment),n=Ds()},l(a){t&&Xs(t.$$.fragment,a),n=Ds()},m(a,G){t&&_s(t,a,G),Gn(a,n,G),c=!0},p(a,G){if(G[0]&8192&&b!==(b=a[13])){if(t){Ho();const W=t;dn(W.$$.fragment,1,0,()=>{ys(W,1)}),jo()}b?(t=ef(b,I(a,G)),a[35](t),t.$on("click",a[15]),t.$on("keydown",a[27]),t.$on("SMUIGenericInput:mount",a[28]),t.$on("SMUIGenericInput:unmount",a[36]),gs(t.$$.fragment),$i(t.$$.fragment,1),_s(t,n.parentNode,n)):t=null}else if(b){const W=G[0]&670916479?ma(g,[G[0]&16384&&{tag:a[14]},G[0]&121701479&&{use:[...a[6]?[]:[[Wd,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},G[0]&8652619&&{class:Es({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},G[0]&524304&&{style:Object.entries(a[19]).map(L1).concat([a[4]]).join(" ")},G[0]&8388610&&Fs(a[23]&&a[1]?{"aria-current":"page"}:{}),G[0]&8389376&&Fs(!a[23]||a[8]?{role:a[9]}:{}),G[0]&8389121&&Fs(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),G[0]&8454656&&Fs(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),G[0]&8389632&&Fs(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),G[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},G[0]&2097152&&{tabindex:a[21]},G[0]&4096&&{href:a[12]},G[0]&1048576&&Fs(a[20]),G[0]&536870912&&Fs(a[29])]):{};G[0]&128|G[1]&64&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&dn(t.$$.fragment,a),c=!1},d(a){a&&bi(n),e[35](null),t&&ys(t,a)}}}let _C=0;const L1=([e,t])=>`${e}: ${t};`;function yC(e,t,n){let c;const g=["use","class","style","color","nonInteractive","ripple","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","action","getPrimaryText","getElement"];let b=co(t,g),{$$slots:I={},$$scope:a}=t;var G;const W=wc(yc());let he=()=>{};function ae(fi){return fi===he}let{use:ue=[]}=t,{class:be=""}=t,{style:Ke=""}=t,{color:ot=void 0}=t,{nonInteractive:tt=(G=Cu("SMUI:list:nonInteractive"))!==null&&G!==void 0?G:!1}=t;du("SMUI:list:nonInteractive",void 0);let{ripple:lt=!tt}=t,{wrapper:ut=!1}=t,{activated:Tt=!1}=t,{role:Pt=ut?"presentation":Cu("SMUI:list:item:role")}=t;du("SMUI:list:item:role",void 0);let{selected:zt=!1}=t,{disabled:Ge=!1}=t,{skipRestoreFocus:Xt=!1}=t,{tabindex:rt=he}=t,{inputId:yt="SMUI-form-field-list-"+_C++}=t,{href:pt=void 0}=t,gt,bt={},dt={},$e={},mt,st,Nt=Cu("SMUI:list:item:nav"),{component:Rt=tf}=t,{tag:Ot=Rt===tf?Nt?pt?"a":"span":"li":void 0}=t;du("SMUI:generic:input:props",{id:yt}),du("SMUI:separator:context",void 0),vc(()=>{if(!zt&&!tt){let pn=!0,ii=gt.getElement();for(;ii.previousSibling;)if(ii=ii.previousSibling,ii.nodeType===1&&ii.classList.contains("mdc-deprecated-list-item")&&!ii.classList.contains("mdc-deprecated-list-item--disabled")){pn=!1;break}pn&&(st=window.requestAnimationFrame(()=>nn(ii)))}const fi={_smui_list_item_accessor:!0,get element(){return ai()},get selected(){return zt},set selected(pn){n(0,zt=pn)},hasClass:_i,addClass:Si,removeClass:Ti,getAttr:tn,addAttr:qi,removeAttr:Ni,getPrimaryText:Ri,get checked(){var pn;return(pn=mt&&mt.checked)!==null&&pn!==void 0?pn:!1},set checked(pn){mt&&n(16,mt.checked=!!pn,mt)},get hasCheckbox(){return!!(mt&&"_smui_checkbox_accessor"in mt)},get hasRadio(){return!!(mt&&"_smui_radio_accessor"in mt)},activateRipple(){mt&&mt.activateRipple()},deactivateRipple(){mt&&mt.deactivateRipple()},getValue(){return b.value},action:gi,get tabindex(){return c},set tabindex(pn){n(30,rt=pn)},get disabled(){return Ge},get activated(){return Tt},set activated(pn){n(1,Tt=pn)}};return iu(ai(),"SMUIListItem:mount",fi),()=>{iu(ai(),"SMUIListItem:unmount",fi)}}),wm(()=>{st&&window.cancelAnimationFrame(st)});function _i(fi){return fi in bt?bt[fi]:ai().classList.contains(fi)}function Si(fi){bt[fi]||n(18,bt[fi]=!0,bt)}function Ti(fi){(!(fi in bt)||bt[fi])&&n(18,bt[fi]=!1,bt)}function Oi(fi,pn){dt[fi]!=pn&&(pn===""||pn==null?(delete dt[fi],n(19,dt)):n(19,dt[fi]=pn,dt))}function tn(fi){var pn;return fi in $e?(pn=$e[fi])!==null&&pn!==void 0?pn:null:ai().getAttribute(fi)}function qi(fi,pn){$e[fi]!==pn&&n(20,$e[fi]=pn,$e)}function Ni(fi){(!(fi in $e)||$e[fi]!=null)&&n(20,$e[fi]=void 0,$e)}function nn(fi){let pn=!0;for(;fi.nextElementSibling;)if(fi=fi.nextElementSibling,fi.nodeType===1&&fi.classList.contains("mdc-deprecated-list-item")){const ii=fi.attributes.getNamedItem("tabindex");if(ii&&ii.value==="0"){pn=!1;break}}pn&&n(21,c=0)}function yn(fi){const pn=fi.key==="Enter",ii=fi.key==="Space";(pn||ii)&&gi(fi)}function Ci(fi){("_smui_checkbox_accessor"in fi.detail||"_smui_radio_accessor"in fi.detail)&&n(16,mt=fi.detail)}function gi(fi){Ge||iu(ai(),"SMUI:action",fi)}function Ri(){var fi,pn,ii;const wn=ai(),Rr=wn.querySelector(".mdc-deprecated-list-item__primary-text");if(Rr)return(fi=Rr.textContent)!==null&&fi!==void 0?fi:"";const hi=wn.querySelector(".mdc-deprecated-list-item__text");return hi?(pn=hi.textContent)!==null&&pn!==void 0?pn:"":(ii=wn.textContent)!==null&&ii!==void 0?ii:""}function ai(){return gt.getElement()}function Ki(fi){pa[fi?"unshift":"push"](()=>{gt=fi,n(17,gt)})}const Ji=()=>n(16,mt=void 0);return e.$$set=fi=>{t=gr(gr({},t),ec(fi)),n(29,b=co(t,g)),"use"in fi&&n(2,ue=fi.use),"class"in fi&&n(3,be=fi.class),"style"in fi&&n(4,Ke=fi.style),"color"in fi&&n(5,ot=fi.color),"nonInteractive"in fi&&n(6,tt=fi.nonInteractive),"ripple"in fi&&n(7,lt=fi.ripple),"wrapper"in fi&&n(8,ut=fi.wrapper),"activated"in fi&&n(1,Tt=fi.activated),"role"in fi&&n(9,Pt=fi.role),"selected"in fi&&n(0,zt=fi.selected),"disabled"in fi&&n(10,Ge=fi.disabled),"skipRestoreFocus"in fi&&n(11,Xt=fi.skipRestoreFocus),"tabindex"in fi&&n(30,rt=fi.tabindex),"inputId"in fi&&n(31,yt=fi.inputId),"href"in fi&&n(12,pt=fi.href),"component"in fi&&n(13,Rt=fi.component),"tag"in fi&&n(14,Ot=fi.tag),"$$scope"in fi&&n(37,a=fi.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073808449&&n(21,c=ae(rt)?!tt&&!Ge&&(zt||mt&&mt.checked)?0:-1:rt)},[zt,Tt,ue,be,Ke,ot,tt,lt,ut,Pt,Ge,Xt,pt,Rt,Ot,gi,mt,gt,bt,dt,$e,c,W,Nt,Si,Ti,Oi,yn,Ci,b,rt,yt,Ri,ai,I,Ki,Ji,a]}class vC extends Lo{constructor(t){super(),Bo(this,t,yC,gC,ho,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,wrapper:8,activated:1,role:9,selected:0,disabled:10,skipRestoreFocus:11,tabindex:30,inputId:31,href:12,component:13,tag:14,action:15,getPrimaryText:32,getElement:33},null,[-1,-1])}get action(){return this.$$.ctx[15]}get getPrimaryText(){return this.$$.ctx[32]}get getElement(){return this.$$.ctx[33]}}cp({class:"mdc-deprecated-list-item__text",tag:"span"});cp({class:"mdc-deprecated-list-item__primary-text",tag:"span"});cp({class:"mdc-deprecated-list-item__secondary-text",tag:"span"});function xC(e){let t,n,c,g,b,I;const a=e[8].default,G=ru(a,e,e[7],null);let W=[{class:n=Es({[e[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":e[4]})},e[5]],he={};for(let ae=0;ae<W.length;ae+=1)he=gr(he,W[ae]);return{c(){t=Nn("span"),G&&G.c(),this.h()},l(ae){t=Vn(ae,"SPAN",{class:!0});var ue=bn(t);G&&G.l(ue),ue.forEach(bi),this.h()},h(){sl(t,he)},m(ae,ue){Gn(ae,t,ue),G&&G.m(t,null),e[9](t),g=!0,b||(I=[bo(c=pc.call(null,t,e[0])),bo(e[3].call(null,t))],b=!0)},p(ae,[ue]){G&&G.p&&(!g||ue&128)&&su(G,a,ae,ae[7],g?ou(a,ae[7],ue,null):au(ae[7]),null),sl(t,he=ma(W,[(!g||ue&2&&n!==(n=Es({[ae[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":ae[4]})))&&{class:n},ue&32&&ae[5]])),c&&Eu(c.update)&&ue&1&&c.update.call(null,ae[0])},i(ae){g||($i(G,ae),g=!0)},o(ae){dn(G,ae),g=!1},d(ae){ae&&bi(t),G&&G.d(ae),e[9](null),b=!1,Nh(I)}}}function bC(e,t,n){const c=["use","class","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t;const a=wc(yc());let{use:G=[]}=t,{class:W=""}=t,he,ae=Cu("SMUI:list:graphic:menu-selection-group");function ue(){return he}function be(Ke){pa[Ke?"unshift":"push"](()=>{he=Ke,n(2,he)})}return e.$$set=Ke=>{t=gr(gr({},t),ec(Ke)),n(5,g=co(t,c)),"use"in Ke&&n(0,G=Ke.use),"class"in Ke&&n(1,W=Ke.class),"$$scope"in Ke&&n(7,I=Ke.$$scope)},[G,W,he,a,ae,g,ue,I,b,be]}class wC extends Lo{constructor(t){super(),Bo(this,t,bC,xC,ho,{use:0,class:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}cp({class:"mdc-deprecated-list-item__meta",tag:"span"});cp({class:"mdc-deprecated-list-group",tag:"div"});cp({class:"mdc-deprecated-list-group__subheader",tag:"h3"});cp({class:"mdc-menu__selection-group-icon",component:wC});function SC(e){let t,n,c,g,b,I,a,G;const W=e[22].default,he=ru(W,e,e[21],null);let ae=[{class:n=Es({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(tx).concat([e[4]]).join(" ")},{for:g=e[5]||(e[11]?e[11].id:void 0)},e[12]],ue={};for(let be=0;be<ae.length;be+=1)ue=gr(ue,ae[be]);return{c(){t=Nn("label"),he&&he.c(),this.h()},l(be){t=Vn(be,"LABEL",{class:!0,style:!0,for:!0});var Ke=bn(t);he&&he.l(Ke),Ke.forEach(bi),this.h()},h(){sl(t,ue)},m(be,Ke){Gn(be,t,Ke),he&&he.m(t,null),e[24](t),I=!0,a||(G=[bo(b=pc.call(null,t,e[2])),bo(e[10].call(null,t))],a=!0)},p(be,Ke){he&&he.p&&(!I||Ke&2097152)&&su(he,W,be,be[21],I?ou(W,be[21],Ke,null):au(be[21]),null),sl(t,ue=ma(ae,[(!I||Ke&267&&n!==(n=Es({[be[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":be[0],"mdc-floating-label--required":be[1],...be[8]})))&&{class:n},(!I||Ke&528&&c!==(c=Object.entries(be[9]).map(tx).concat([be[4]]).join(" ")))&&{style:c},(!I||Ke&32&&g!==(g=be[5]||(be[11]?be[11].id:void 0)))&&{for:g},Ke&4096&&be[12]])),b&&Eu(b.update)&&Ke&4&&b.update.call(null,be[2])},i(be){I||($i(he,be),I=!0)},o(be){dn(he,be),I=!1},d(be){be&&bi(t),he&&he.d(be),e[24](null),a=!1,Nh(G)}}}function IC(e){let t,n,c,g,b,I,a;const G=e[22].default,W=ru(G,e,e[21],null);let he=[{class:n=Es({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(ex).concat([e[4]]).join(" ")},e[12]],ae={};for(let ue=0;ue<he.length;ue+=1)ae=gr(ae,he[ue]);return{c(){t=Nn("span"),W&&W.c(),this.h()},l(ue){t=Vn(ue,"SPAN",{class:!0,style:!0});var be=bn(t);W&&W.l(be),be.forEach(bi),this.h()},h(){sl(t,ae)},m(ue,be){Gn(ue,t,be),W&&W.m(t,null),e[23](t),b=!0,I||(a=[bo(g=pc.call(null,t,e[2])),bo(e[10].call(null,t))],I=!0)},p(ue,be){W&&W.p&&(!b||be&2097152)&&su(W,G,ue,ue[21],b?ou(G,ue[21],be,null):au(ue[21]),null),sl(t,ae=ma(he,[(!b||be&267&&n!==(n=Es({[ue[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":ue[0],"mdc-floating-label--required":ue[1],...ue[8]})))&&{class:n},(!b||be&528&&c!==(c=Object.entries(ue[9]).map(ex).concat([ue[4]]).join(" ")))&&{style:c},be&4096&&ue[12]])),g&&Eu(g.update)&&be&4&&g.update.call(null,ue[2])},i(ue){b||($i(W,ue),b=!0)},o(ue){dn(W,ue),b=!1},d(ue){ue&&bi(t),W&&W.d(ue),e[23](null),I=!1,Nh(a)}}}function EC(e){let t,n,c,g;const b=[IC,SC],I=[];function a(G,W){return G[6]?0:1}return t=a(e),n=I[t]=b[t](e),{c(){n.c(),c=Ds()},l(G){n.l(G),c=Ds()},m(G,W){I[t].m(G,W),Gn(G,c,W),g=!0},p(G,[W]){let he=t;t=a(G),t===he?I[t].p(G,W):(Ho(),dn(I[he],1,1,()=>{I[he]=null}),jo(),n=I[t],n?n.p(G,W):(n=I[t]=b[t](G),n.c()),$i(n,1),n.m(c.parentNode,c))},i(G){g||($i(n),g=!0)},o(G){dn(n),g=!1},d(G){G&&bi(c),I[t].d(G)}}}const ex=([e,t])=>`${e}: ${t};`,tx=([e,t])=>`${e}: ${t};`;function CC(e,t,n){const c=["use","class","style","for","floatAbove","required","wrapped","shake","float","setRequired","getWidth","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t;var a;const G=wc(yc());let{use:W=[]}=t,{class:he=""}=t,{style:ae=""}=t,{for:ue=void 0}=t,{floatAbove:be=!1}=t,{required:Ke=!1}=t,{wrapped:ot=!1}=t,tt,lt,ut={},Tt={},Pt=(a=Cu("SMUI:generic:input:props"))!==null&&a!==void 0?a:{},zt=be,Ge=Ke;vc(()=>{n(18,lt=new cE({addClass:Xt,removeClass:rt,getWidth:()=>{var Ot,_i;const Si=mt(),Ti=Si.cloneNode(!0);(Ot=Si.parentNode)===null||Ot===void 0||Ot.appendChild(Ti),Ti.classList.add("smui-floating-label--remove-transition"),Ti.classList.add("smui-floating-label--force-size"),Ti.classList.remove("mdc-floating-label--float-above");const Oi=Ti.scrollWidth;return(_i=Si.parentNode)===null||_i===void 0||_i.removeChild(Ti),Oi},registerInteractionHandler:(Ot,_i)=>mt().addEventListener(Ot,_i),deregisterInteractionHandler:(Ot,_i)=>mt().removeEventListener(Ot,_i)}));const Rt={get element(){return mt()},addStyle:yt,removeStyle:pt};return iu(tt,"SMUIFloatingLabel:mount",Rt),lt.init(),()=>{iu(tt,"SMUIFloatingLabel:unmount",Rt),lt.destroy()}});function Xt(Rt){ut[Rt]||n(8,ut[Rt]=!0,ut)}function rt(Rt){(!(Rt in ut)||ut[Rt])&&n(8,ut[Rt]=!1,ut)}function yt(Rt,Ot){Tt[Rt]!=Ot&&(Ot===""||Ot==null?(delete Tt[Rt],n(9,Tt)):n(9,Tt[Rt]=Ot,Tt))}function pt(Rt){Rt in Tt&&(delete Tt[Rt],n(9,Tt))}function gt(Rt){lt.shake(Rt)}function bt(Rt){n(0,be=Rt)}function dt(Rt){n(1,Ke=Rt)}function $e(){return lt.getWidth()}function mt(){return tt}function st(Rt){pa[Rt?"unshift":"push"](()=>{tt=Rt,n(7,tt)})}function Nt(Rt){pa[Rt?"unshift":"push"](()=>{tt=Rt,n(7,tt)})}return e.$$set=Rt=>{t=gr(gr({},t),ec(Rt)),n(12,g=co(t,c)),"use"in Rt&&n(2,W=Rt.use),"class"in Rt&&n(3,he=Rt.class),"style"in Rt&&n(4,ae=Rt.style),"for"in Rt&&n(5,ue=Rt.for),"floatAbove"in Rt&&n(0,be=Rt.floatAbove),"required"in Rt&&n(1,Ke=Rt.required),"wrapped"in Rt&&n(6,ot=Rt.wrapped),"$$scope"in Rt&&n(21,I=Rt.$$scope)},e.$$.update=()=>{e.$$.dirty&786433&&lt&&zt!==be&&(n(19,zt=be),lt.float(be)),e.$$.dirty&1310722&&lt&&Ge!==Ke&&(n(20,Ge=Ke),lt.setRequired(Ke))},[be,Ke,W,he,ae,ue,ot,tt,ut,Tt,G,Pt,g,gt,bt,dt,$e,mt,lt,zt,Ge,I,b,st,Nt]}class h3 extends Lo{constructor(t){super(),Bo(this,t,CC,EC,ho,{use:2,class:3,style:4,for:5,floatAbove:0,required:1,wrapped:6,shake:13,float:14,setRequired:15,getWidth:16,getElement:17})}get shake(){return this.$$.ctx[13]}get float(){return this.$$.ctx[14]}get setRequired(){return this.$$.ctx[15]}get getWidth(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function TC(e){let t,n,c,g,b,I,a=[{class:n=Es({[e[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":e[3],...e[5]})},{style:c=Object.entries(e[6]).map(ix).concat([e[2]]).join(" ")},e[8]],G={};for(let W=0;W<a.length;W+=1)G=gr(G,a[W]);return{c(){t=Nn("div"),this.h()},l(W){t=Vn(W,"DIV",{class:!0,style:!0}),bn(t).forEach(bi),this.h()},h(){sl(t,G)},m(W,he){Gn(W,t,he),e[13](t),b||(I=[bo(g=pc.call(null,t,e[0])),bo(e[7].call(null,t))],b=!0)},p(W,[he]){sl(t,G=ma(a,[he&42&&n!==(n=Es({[W[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":W[3],...W[5]}))&&{class:n},he&68&&c!==(c=Object.entries(W[6]).map(ix).concat([W[2]]).join(" "))&&{style:c},he&256&&W[8]])),g&&Eu(g.update)&&he&1&&g.update.call(null,W[0])},i:wo,o:wo,d(W){W&&bi(t),e[13](null),b=!1,Nh(I)}}}const ix=([e,t])=>`${e}: ${t};`;function kC(e,t,n){const c=["use","class","style","active","activate","deactivate","setRippleCenter","getElement"];let g=co(t,c);const b=wc(yc());let{use:I=[]}=t,{class:a=""}=t,{style:G=""}=t,{active:W=!1}=t,he,ae,ue={},be={};vc(()=>(ae=new hE({addClass:ot,removeClass:tt,hasClass:Ke,setStyle:lt,registerEventHandler:(Xt,rt)=>zt().addEventListener(Xt,rt),deregisterEventHandler:(Xt,rt)=>zt().removeEventListener(Xt,rt)}),ae.init(),()=>{ae.destroy()}));function Ke(Xt){return Xt in ue?ue[Xt]:zt().classList.contains(Xt)}function ot(Xt){ue[Xt]||n(5,ue[Xt]=!0,ue)}function tt(Xt){(!(Xt in ue)||ue[Xt])&&n(5,ue[Xt]=!1,ue)}function lt(Xt,rt){be[Xt]!=rt&&(rt===""||rt==null?(delete be[Xt],n(6,be)):n(6,be[Xt]=rt,be))}function ut(){ae.activate()}function Tt(){ae.deactivate()}function Pt(Xt){ae.setRippleCenter(Xt)}function zt(){return he}function Ge(Xt){pa[Xt?"unshift":"push"](()=>{he=Xt,n(4,he)})}return e.$$set=Xt=>{t=gr(gr({},t),ec(Xt)),n(8,g=co(t,c)),"use"in Xt&&n(0,I=Xt.use),"class"in Xt&&n(1,a=Xt.class),"style"in Xt&&n(2,G=Xt.style),"active"in Xt&&n(3,W=Xt.active)},[I,a,G,W,he,ue,be,b,g,ut,Tt,Pt,zt,Ge]}class MC extends Lo{constructor(t){super(),Bo(this,t,kC,TC,ho,{use:0,class:1,style:2,active:3,activate:9,deactivate:10,setRippleCenter:11,getElement:12})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get setRippleCenter(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}function nx(e){let t,n,c;const g=e[15].default,b=ru(g,e,e[14],null);return{c(){t=Nn("div"),b&&b.c(),this.h()},l(I){t=Vn(I,"DIV",{class:!0,style:!0});var a=bn(t);b&&b.l(a),a.forEach(bi),this.h()},h(){Pi(t,"class","mdc-notched-outline__notch"),Pi(t,"style",n=Object.entries(e[7]).map(rx).join(" "))},m(I,a){Gn(I,t,a),b&&b.m(t,null),c=!0},p(I,a){b&&b.p&&(!c||a&16384)&&su(b,g,I,I[14],c?ou(g,I[14],a,null):au(I[14]),null),(!c||a&128&&n!==(n=Object.entries(I[7]).map(rx).join(" ")))&&Pi(t,"style",n)},i(I){c||($i(b,I),c=!0)},o(I){dn(b,I),c=!1},d(I){I&&bi(t),b&&b.d(I)}}}function PC(e){let t,n,c,g,b,I,a,G,W,he,ae=!e[3]&&nx(e),ue=[{class:I=Es({[e[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":e[2],"mdc-notched-outline--no-label":e[3],...e[6]})},e[10]],be={};for(let Ke=0;Ke<ue.length;Ke+=1)be=gr(be,ue[Ke]);return{c(){t=Nn("div"),n=Nn("div"),c=Cr(),ae&&ae.c(),g=Cr(),b=Nn("div"),this.h()},l(Ke){t=Vn(Ke,"DIV",{class:!0});var ot=bn(t);n=Vn(ot,"DIV",{class:!0}),bn(n).forEach(bi),c=Tr(ot),ae&&ae.l(ot),g=Tr(ot),b=Vn(ot,"DIV",{class:!0}),bn(b).forEach(bi),ot.forEach(bi),this.h()},h(){Pi(n,"class","mdc-notched-outline__leading"),Pi(b,"class","mdc-notched-outline__trailing"),sl(t,be)},m(Ke,ot){Gn(Ke,t,ot),Zi(t,n),Zi(t,c),ae&&ae.m(t,null),Zi(t,g),Zi(t,b),e[16](t),G=!0,W||(he=[bo(a=pc.call(null,t,e[0])),bo(e[8].call(null,t)),Gl(t,"SMUIFloatingLabel:mount",e[9]),Gl(t,"SMUIFloatingLabel:unmount",e[17])],W=!0)},p(Ke,[ot]){Ke[3]?ae&&(Ho(),dn(ae,1,1,()=>{ae=null}),jo()):ae?(ae.p(Ke,ot),ot&8&&$i(ae,1)):(ae=nx(Ke),ae.c(),$i(ae,1),ae.m(t,g)),sl(t,be=ma(ue,[(!G||ot&78&&I!==(I=Es({[Ke[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":Ke[2],"mdc-notched-outline--no-label":Ke[3],...Ke[6]})))&&{class:I},ot&1024&&Ke[10]])),a&&Eu(a.update)&&ot&1&&a.update.call(null,Ke[0])},i(Ke){G||($i(ae),G=!0)},o(Ke){dn(ae),G=!1},d(Ke){Ke&&bi(t),ae&&ae.d(),e[16](null),W=!1,Nh(he)}}}const rx=([e,t])=>`${e}: ${t};`;function DC(e,t,n){const c=["use","class","notched","noLabel","notch","closeNotch","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t;const a=wc(yc());let{use:G=[]}=t,{class:W=""}=t,{notched:he=!1}=t,{noLabel:ae=!1}=t,ue,be,Ke,ot={},tt={};vc(()=>(be=new EE({addClass:ut,removeClass:Tt,setNotchWidthProperty:gt=>Pt("width",gt+"px"),removeNotchWidthProperty:()=>zt("width")}),be.init(),()=>{be.destroy()}));function lt(gt){n(4,Ke=gt.detail)}function ut(gt){ot[gt]||n(6,ot[gt]=!0,ot)}function Tt(gt){(!(gt in ot)||ot[gt])&&n(6,ot[gt]=!1,ot)}function Pt(gt,bt){tt[gt]!=bt&&(bt===""||bt==null?(delete tt[gt],n(7,tt)):n(7,tt[gt]=bt,tt))}function zt(gt){gt in tt&&(delete tt[gt],n(7,tt))}function Ge(gt){be.notch(gt)}function Xt(){be.closeNotch()}function rt(){return ue}function yt(gt){pa[gt?"unshift":"push"](()=>{ue=gt,n(5,ue)})}const pt=()=>n(4,Ke=void 0);return e.$$set=gt=>{t=gr(gr({},t),ec(gt)),n(10,g=co(t,c)),"use"in gt&&n(0,G=gt.use),"class"in gt&&n(1,W=gt.class),"notched"in gt&&n(2,he=gt.notched),"noLabel"in gt&&n(3,ae=gt.noLabel),"$$scope"in gt&&n(14,I=gt.$$scope)},e.$$.update=()=>{e.$$.dirty&16&&(Ke?(Ke.addStyle("transition-duration","0s"),ut("mdc-notched-outline--upgraded"),requestAnimationFrame(()=>{Ke&&Ke.removeStyle("transition-duration")})):Tt("mdc-notched-outline--upgraded"))},[G,W,he,ae,Ke,ue,ot,tt,a,lt,g,Ge,Xt,rt,I,b,yt,pt]}class LC extends Lo{constructor(t){super(),Bo(this,t,DC,PC,ho,{use:0,class:1,notched:2,noLabel:3,notch:11,closeNotch:12,getElement:13})}get notch(){return this.$$.ctx[11]}get closeNotch(){return this.$$.ctx[12]}get getElement(){return this.$$.ctx[13]}}function BC(e){let t;return{c(){t=Ja(e[8])},l(n){t=eo(n,e[8])},m(n,c){Gn(n,t,c)},p(n,c){c&256&&tu(t,n[8])},i:wo,o:wo,d(n){n&&bi(t)}}}function zC(e){let t;const n=e[13].default,c=ru(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&4096)&&su(c,n,g,g[12],t?ou(n,g[12],b,null):au(g[12]),null)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function RC(e){let t,n,c,g,b,I,a,G,W;const he=[zC,BC],ae=[];function ue(ot,tt){return ot[8]==null?0:1}n=ue(e),c=ae[n]=he[n](e);let be=[{class:g=Es({[e[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":e[4],"mdc-select-helper-text--validation-msg-persistent":e[3],...e[6]})},{"aria-hidden":b=e[3]?void 0:"true"},{id:e[2]},e[7],e[10]],Ke={};for(let ot=0;ot<be.length;ot+=1)Ke=gr(Ke,be[ot]);return{c(){t=Nn("div"),c.c(),this.h()},l(ot){t=Vn(ot,"DIV",{class:!0,"aria-hidden":!0,id:!0});var tt=bn(t);c.l(tt),tt.forEach(bi),this.h()},h(){sl(t,Ke)},m(ot,tt){Gn(ot,t,tt),ae[n].m(t,null),e[14](t),a=!0,G||(W=[bo(I=pc.call(null,t,e[0])),bo(e[9].call(null,t))],G=!0)},p(ot,[tt]){let lt=n;n=ue(ot),n===lt?ae[n].p(ot,tt):(Ho(),dn(ae[lt],1,1,()=>{ae[lt]=null}),jo(),c=ae[n],c?c.p(ot,tt):(c=ae[n]=he[n](ot),c.c()),$i(c,1),c.m(t,null)),sl(t,Ke=ma(be,[(!a||tt&90&&g!==(g=Es({[ot[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":ot[4],"mdc-select-helper-text--validation-msg-persistent":ot[3],...ot[6]})))&&{class:g},(!a||tt&8&&b!==(b=ot[3]?void 0:"true"))&&{"aria-hidden":b},(!a||tt&4)&&{id:ot[2]},tt&128&&ot[7],tt&1024&&ot[10]])),I&&Eu(I.update)&&tt&1&&I.update.call(null,ot[0])},i(ot){a||($i(c),a=!0)},o(ot){dn(c),a=!1},d(ot){ot&&bi(t),ae[n].d(),e[14](null),G=!1,Nh(W)}}}let FC=0;function OC(e,t,n){const c=["use","class","id","persistent","validationMsg","getElement"];let g=co(t,c),{$$slots:b={},$$scope:I}=t;const a=wc(yc());let{use:G=[]}=t,{class:W=""}=t,{id:he="SMUI-select-helper-text-"+FC++}=t,{persistent:ae=!1}=t,{validationMsg:ue=!1}=t,be,Ke,ot={},tt={},lt;vc(()=>(Ke=new RE({addClass:Tt,removeClass:Pt,hasClass:ut,getAttr:zt,setAttr:Ge,removeAttr:Xt,setContent:pt=>{n(8,lt=pt)}}),he.startsWith("SMUI-select-helper-text-")&&iu(rt(),"SMUISelectHelperText:id",he),iu(rt(),"SMUISelectHelperText:mount",Ke),Ke.init(),()=>{iu(rt(),"SMUISelectHelperText:unmount",Ke),Ke.destroy()}));function ut(pt){return pt in ot?ot[pt]:rt().classList.contains(pt)}function Tt(pt){ot[pt]||n(6,ot[pt]=!0,ot)}function Pt(pt){(!(pt in ot)||ot[pt])&&n(6,ot[pt]=!1,ot)}function zt(pt){var gt;return pt in tt?(gt=tt[pt])!==null&&gt!==void 0?gt:null:rt().getAttribute(pt)}function Ge(pt,gt){tt[pt]!==gt&&n(7,tt[pt]=gt,tt)}function Xt(pt){(!(pt in tt)||tt[pt]!=null)&&n(7,tt[pt]=void 0,tt)}function rt(){return be}function yt(pt){pa[pt?"unshift":"push"](()=>{be=pt,n(5,be)})}return e.$$set=pt=>{t=gr(gr({},t),ec(pt)),n(10,g=co(t,c)),"use"in pt&&n(0,G=pt.use),"class"in pt&&n(1,W=pt.class),"id"in pt&&n(2,he=pt.id),"persistent"in pt&&n(3,ae=pt.persistent),"validationMsg"in pt&&n(4,ue=pt.validationMsg),"$$scope"in pt&&n(12,I=pt.$$scope)},[G,W,he,ae,ue,be,ot,tt,lt,a,g,rt,I,b,yt]}class NC extends Lo{constructor(t){super(),Bo(this,t,OC,RC,ho,{use:0,class:1,id:2,persistent:3,validationMsg:4,getElement:11})}get getElement(){return this.$$.ctx[11]}}const VC=e=>({}),sx=e=>({}),UC=e=>({}),ax=e=>({}),GC=e=>({}),ox=e=>({}),qC=e=>({}),lx=e=>({});function ux(e){let t,n=[{type:"hidden"},{required:e[10]},{disabled:e[6]},{value:e[0]},wl(e[53],"input$")],c={};for(let g=0;g<n.length;g+=1)c=gr(c,n[g]);return{c(){t=Nn("input"),this.h()},l(g){t=Vn(g,"INPUT",{type:!0}),this.h()},h(){sl(t,c)},m(g,b){Gn(g,t,b),t.autofocus&&t.focus()},p(g,b){sl(t,c=ma(n,[{type:"hidden"},b[0]&1024&&{required:g[10]},b[0]&64&&{disabled:g[6]},b[0]&1&&{value:g[0]},b[1]&4194304&&wl(g[53],"input$")]))},d(g){g&&bi(t)}}}function cx(e){let t;return{c(){t=Nn("span"),this.h()},l(n){t=Vn(n,"SPAN",{class:!0}),bn(t).forEach(bi),this.h()},h(){Pi(t,"class","mdc-select__ripple")},m(n,c){Gn(n,t,c)},d(n){n&&bi(t)}}}function hx(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[HC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new h3({props:g}),e[67](t),{c(){gs(t.$$.fragment)},l(b){Xs(t.$$.fragment,b)},m(b,I){_s(t,b,I),n=!0},p(b,I){const a=I[0]&3072|I[1]&4196352?ma(c,[I[0]&2048&&{id:b[11]+"-smui-label"},I[1]&2048&&{floatAbove:b[42]!==""},I[0]&1024&&{required:b[10]},I[1]&4194304&&Fs(wl(b[53],"label$"))]):{};I[0]&512|I[2]&33554432&&(a.$$scope={dirty:I,ctx:b}),t.$set(a)},i(b){n||($i(t.$$.fragment,b),n=!0)},o(b){dn(t.$$.fragment,b),n=!1},d(b){e[67](null),ys(t,b)}}}function HC(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,b=ru(g,e,e[87],lx);return{c(){n=Ja(t),b&&b.c()},l(I){n=eo(I,t),b&&b.l(I)},m(I,a){Gn(I,n,a),b&&b.m(I,a),c=!0},p(I,a){(!c||a[0]&512)&&t!==(t=(I[9]==null?"":I[9])+"")&&tu(n,t),b&&b.p&&(!c||a[2]&33554432)&&su(b,g,I,I[87],c?ou(g,I[87],a,qC):au(I[87]),lx)},i(I){c||($i(b,I),c=!0)},o(I){dn(b,I),c=!1},d(I){I&&bi(n),b&&b.d(I)}}}function Ax(e){let t,n;const c=[{noLabel:e[8]||e[9]==null&&!e[54].label},wl(e[53],"outline$")];let g={$$slots:{default:[ZC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new LC({props:g}),e[69](t),{c(){gs(t.$$.fragment)},l(b){Xs(t.$$.fragment,b)},m(b,I){_s(t,b,I),n=!0},p(b,I){const a=I[0]&768|I[1]&12582912?ma(c,[I[0]&768|I[1]&8388608&&{noLabel:b[8]||b[9]==null&&!b[54].label},I[1]&4194304&&Fs(wl(b[53],"outline$"))]):{};I[0]&3840|I[1]&12585216|I[2]&33554432&&(a.$$scope={dirty:I,ctx:b}),t.$set(a)},i(b){n||($i(t.$$.fragment,b),n=!0)},o(b){dn(t.$$.fragment,b),n=!1},d(b){e[69](null),ys(t,b)}}}function fx(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[jC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new h3({props:g}),e[68](t),{c(){gs(t.$$.fragment)},l(b){Xs(t.$$.fragment,b)},m(b,I){_s(t,b,I),n=!0},p(b,I){const a=I[0]&3072|I[1]&4196352?ma(c,[I[0]&2048&&{id:b[11]+"-smui-label"},I[1]&2048&&{floatAbove:b[42]!==""},I[0]&1024&&{required:b[10]},I[1]&4194304&&Fs(wl(b[53],"label$"))]):{};I[0]&512|I[2]&33554432&&(a.$$scope={dirty:I,ctx:b}),t.$set(a)},i(b){n||($i(t.$$.fragment,b),n=!0)},o(b){dn(t.$$.fragment,b),n=!1},d(b){e[68](null),ys(t,b)}}}function jC(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,b=ru(g,e,e[87],ox);return{c(){n=Ja(t),b&&b.c()},l(I){n=eo(I,t),b&&b.l(I)},m(I,a){Gn(I,n,a),b&&b.m(I,a),c=!0},p(I,a){(!c||a[0]&512)&&t!==(t=(I[9]==null?"":I[9])+"")&&tu(n,t),b&&b.p&&(!c||a[2]&33554432)&&su(b,g,I,I[87],c?ou(g,I[87],a,GC):au(I[87]),ox)},i(I){c||($i(b,I),c=!0)},o(I){dn(b,I),c=!1},d(I){I&&bi(n),b&&b.d(I)}}}function ZC(e){let t,n,c=!e[8]&&(e[9]!=null||e[54].label)&&fx(e);return{c(){c&&c.c(),t=Ds()},l(g){c&&c.l(g),t=Ds()},m(g,b){c&&c.m(g,b),Gn(g,t,b),n=!0},p(g,b){!g[8]&&(g[9]!=null||g[54].label)?c?(c.p(g,b),b[0]&768|b[1]&8388608&&$i(c,1)):(c=fx(g),c.c(),$i(c,1),c.m(t.parentNode,t)):c&&(Ho(),dn(c,1,1,()=>{c=null}),jo())},i(g){n||($i(c),n=!0)},o(g){dn(c),n=!1},d(g){g&&bi(t),c&&c.d(g)}}}function dx(e){let t,n;const c=[wl(e[53],"ripple$")];let g={};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new MC({props:g}),e[70](t),{c(){gs(t.$$.fragment)},l(b){Xs(t.$$.fragment,b)},m(b,I){_s(t,b,I),n=!0},p(b,I){const a=I[1]&4194304?ma(c,[Fs(wl(b[53],"ripple$"))]):{};t.$set(a)},i(b){n||($i(t.$$.fragment,b),n=!0)},o(b){dn(t.$$.fragment,b),n=!1},d(b){e[70](null),ys(t,b)}}}function QC(e){let t;const n=e[64].default,c=ru(n,e,e[87],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b[2]&33554432)&&su(c,n,g,g[87],t?ou(n,g[87],b,null):au(g[87]),null)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function WC(e){let t,n,c;const g=[{role:"listbox"},{wrapFocus:e[35]},wl(e[53],"list$")];function b(a){e[75](a)}let I={$$slots:{default:[QC]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)I=gr(I,g[a]);return e[24]!==void 0&&(I.selectedIndex=e[24]),t=new pC({props:I}),pa.push(()=>N0(t,"selectedIndex",b)),t.$on("SMUIList:mount",e[76]),{c(){gs(t.$$.fragment)},l(a){Xs(t.$$.fragment,a)},m(a,G){_s(t,a,G),c=!0},p(a,G){const W=G[1]&4194320?ma(g,[g[0],G[1]&16&&{wrapFocus:a[35]},G[1]&4194304&&Fs(wl(a[53],"list$"))]):{};G[2]&33554432&&(W.$$scope={dirty:G,ctx:a}),!n&&G[0]&16777216&&(n=!0,W.selectedIndex=a[24],O0(()=>n=!1)),t.$set(W)},i(a){c||($i(t.$$.fragment,a),c=!0)},o(a){dn(t.$$.fragment,a),c=!1},d(a){ys(t,a)}}}function px(e){let t,n;const c=[wl(e[53],"helperText$")];let g={$$slots:{default:[XC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new NC({props:g}),t.$on("SMUISelectHelperText:id",e[84]),t.$on("SMUISelectHelperText:mount",e[85]),t.$on("SMUISelectHelperText:unmount",e[86]),{c(){gs(t.$$.fragment)},l(b){Xs(t.$$.fragment,b)},m(b,I){_s(t,b,I),n=!0},p(b,I){const a=I[1]&4194304?ma(c,[Fs(wl(b[53],"helperText$"))]):{};I[2]&33554432&&(a.$$scope={dirty:I,ctx:b}),t.$set(a)},i(b){n||($i(t.$$.fragment,b),n=!0)},o(b){dn(t.$$.fragment,b),n=!1},d(b){ys(t,b)}}}function XC(e){let t;const n=e[64].helperText,c=ru(n,e,e[87],sx);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b[2]&33554432)&&su(c,n,g,g[87],t?ou(n,g[87],b,VC):au(g[87]),sx)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function YC(e){let t,n,c,g,b,I,a,G,W,he,ae,ue,be,Ke,ot,tt,lt,ut,Tt,Pt,zt,Ge,Xt,rt,yt,pt,gt,bt,dt,$e,mt,st,Nt,Rt,Ot,_i,Si,Ti,Oi,tn,qi,Ni=e[12]&&ux(e),nn=e[7]==="filled"&&cx(),yn=e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)&&hx(e),Ci=e[7]==="outlined"&&Ax(e);const gi=e[64].leadingIcon,Ri=ru(gi,e,e[87],ax);let ai=[{id:ae=e[11]+"-smui-selected-text"},{class:ue=Es({[e[19]]:!0,"mdc-select__selected-text":!0})},{role:"button"},{"aria-haspopup":"listbox"},{"aria-labelledby":be=e[11]+"-smui-label"},wl(e[53],"selectedText$")],Ki={};for(let k=0;k<ai.length;k+=1)Ki=gr(Ki,ai[k]);let Ji=[{class:ot=Es({[e[17]]:!0,"mdc-select__selected-text-container":!0})},wl(e[53],"selectedTextContainer$")],fi={};for(let k=0;k<Ji.length;k+=1)fi=gr(fi,Ji[k]);let pn=[{class:Ge=Es({[e[21]]:!0,"mdc-select__dropdown-icon":!0})},wl(e[53],"dropdownIcon$")],ii={};for(let k=0;k<pn.length;k+=1)ii=gr(ii,pn[k]);let wn=e[7]!=="outlined"&&e[5]&&dx(e),Rr=[{class:yt=Es({[e[15]]:!0,"mdc-select__anchor":!0})},{"aria-required":pt=e[10]?"true":void 0},{"aria-disabled":gt=e[6]?"true":void 0},{"aria-controls":e[45]},{"aria-expanded":bt=e[31]?"true":"false"},{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},e[29],wl(e[53],"anchor$")],hi={};for(let k=0;k<Rr.length;k+=1)hi=gr(hi,Rr[k]);const en=[{class:Es({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},{id:e[45]},{fullWidth:!0},{anchor:!1},{anchorElement:e[33]},{anchorCorner:e[34]},wl(e[53],"menu$")];function tr(k){e[77](k)}let Fn={$$slots:{default:[WC]},$$scope:{ctx:e}};for(let k=0;k<en.length;k+=1)Fn=gr(Fn,en[k]);e[31]!==void 0&&(Fn.open=e[31]),mt=new KE({props:Fn}),pa.push(()=>N0(mt,"open",tr)),mt.$on("SMUIMenu:selected",e[78]),mt.$on("SMUIMenuSurface:closing",e[79]),mt.$on("SMUIMenuSurface:closed",e[80]),mt.$on("SMUIMenuSurface:opened",e[81]);let Qn=[{class:Nt=Es({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})},{style:Rt=Object.entries(e[27]).map(mx).concat([e[4]]).join(" ")},W2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])],In={};for(let k=0;k<Qn.length;k+=1)In=gr(In,Qn[k]);let v=e[54].helperText&&px(e);return{c(){t=Nn("div"),Ni&&Ni.c(),n=Cr(),c=Nn("div"),nn&&nn.c(),g=Cr(),yn&&yn.c(),b=Cr(),Ci&&Ci.c(),I=Cr(),Ri&&Ri.c(),a=Cr(),G=Nn("span"),W=Nn("span"),he=Ja(e[42]),lt=Cr(),ut=Nn("span"),Tt=Ba("svg"),Pt=Ba("polygon"),zt=Ba("polygon"),rt=Cr(),wn&&wn.c(),$e=Cr(),gs(mt.$$.fragment),Si=Cr(),v&&v.c(),Ti=Ds(),this.h()},l(k){t=Vn(k,"DIV",{class:!0,style:!0});var V=bn(t);Ni&&Ni.l(V),n=Tr(V),c=Vn(V,"DIV",{class:!0,"aria-required":!0,"aria-disabled":!0,"aria-controls":!0,"aria-expanded":!0,"aria-describedby":!0,role:!0,tabindex:!0});var $=bn(c);nn&&nn.l($),g=Tr($),yn&&yn.l($),b=Tr($),Ci&&Ci.l($),I=Tr($),Ri&&Ri.l($),a=Tr($),G=Vn($,"SPAN",{class:!0});var te=bn(G);W=Vn(te,"SPAN",{id:!0,class:!0,role:!0,"aria-haspopup":!0,"aria-labelledby":!0});var fe=bn(W);he=eo(fe,e[42]),fe.forEach(bi),te.forEach(bi),lt=Tr($),ut=Vn($,"SPAN",{class:!0});var ve=bn(ut);Tt=za(ve,"svg",{class:!0,viewBox:!0,focusable:!0});var Ie=bn(Tt);Pt=za(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),bn(Pt).forEach(bi),zt=za(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),bn(zt).forEach(bi),Ie.forEach(bi),ve.forEach(bi),rt=Tr($),wn&&wn.l($),$.forEach(bi),$e=Tr(V),Xs(mt.$$.fragment,V),V.forEach(bi),Si=Tr(k),v&&v.l(k),Ti=Ds(),this.h()},h(){sl(W,Ki),sl(G,fi),Pi(Pt,"class","mdc-select__dropdown-icon-inactive"),Pi(Pt,"stroke","none"),Pi(Pt,"fill-rule","evenodd"),Pi(Pt,"points","7 10 12 15 17 10"),Pi(zt,"class","mdc-select__dropdown-icon-active"),Pi(zt,"stroke","none"),Pi(zt,"fill-rule","evenodd"),Pi(zt,"points","7 15 12 10 17 15"),Pi(Tt,"class","mdc-select__dropdown-icon-graphic"),Pi(Tt,"viewBox","7 10 10 5"),Pi(Tt,"focusable","false"),sl(ut,ii),sl(c,hi),sl(t,In)},m(k,V){Gn(k,t,V),Ni&&Ni.m(t,null),Zi(t,n),Zi(t,c),nn&&nn.m(c,null),Zi(c,g),yn&&yn.m(c,null),Zi(c,b),Ci&&Ci.m(c,null),Zi(c,I),Ri&&Ri.m(c,null),Zi(c,a),Zi(c,G),Zi(G,W),Zi(W,he),Zi(c,lt),Zi(c,ut),Zi(ut,Tt),Zi(Tt,Pt),Zi(Tt,zt),Zi(c,rt),wn&&wn.m(c,null),e[71](c),Zi(t,$e),_s(mt,t,null),e[82](t),Gn(k,Si,V),v&&v.m(k,V),Gn(k,Ti,V),Oi=!0,tn||(qi=[bo(Ke=pc.call(null,W,e[18])),bo(tt=pc.call(null,G,e[16])),bo(Xt=pc.call(null,ut,e[20])),bo(dt=pc.call(null,c,e[14])),Gl(c,"focus",e[72]),Gl(c,"blur",e[73]),Gl(c,"click",e[74]),Gl(c,"keydown",function(){Eu(e[23]&&e[23].handleKeydown.bind(e[23]))&&(e[23]&&e[23].handleKeydown.bind(e[23])).apply(this,arguments)}),Gl(c,"focus",e[65]),Gl(c,"blur",e[66]),bo(Ot=Wd.call(null,t,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]})),bo(WE.call(null,t,{addClass:e[50],removeClass:e[51]})),bo(_i=pc.call(null,t,e[2])),bo(e[43].call(null,t)),Gl(t,"SMUISelectLeadingIcon:mount",e[49]),Gl(t,"SMUISelectLeadingIcon:unmount",e[83])],tn=!0)},p(k,V){e=k,e[12]?Ni?Ni.p(e,V):(Ni=ux(e),Ni.c(),Ni.m(t,n)):Ni&&(Ni.d(1),Ni=null),e[7]==="filled"?nn||(nn=cx(),nn.c(),nn.m(c,g)):nn&&(nn.d(1),nn=null),e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)?yn?(yn.p(e,V),V[0]&896|V[1]&8388608&&$i(yn,1)):(yn=hx(e),yn.c(),$i(yn,1),yn.m(c,b)):yn&&(Ho(),dn(yn,1,1,()=>{yn=null}),jo()),e[7]==="outlined"?Ci?(Ci.p(e,V),V[0]&128&&$i(Ci,1)):(Ci=Ax(e),Ci.c(),$i(Ci,1),Ci.m(c,I)):Ci&&(Ho(),dn(Ci,1,1,()=>{Ci=null}),jo()),Ri&&Ri.p&&(!Oi||V[2]&33554432)&&su(Ri,gi,e,e[87],Oi?ou(gi,e[87],V,UC):au(e[87]),ax),(!Oi||V[1]&2048)&&iE(he,e[42],Ki.contenteditable),sl(W,Ki=ma(ai,[(!Oi||V[0]&2048&&ae!==(ae=e[11]+"-smui-selected-text"))&&{id:ae},(!Oi||V[0]&524288&&ue!==(ue=Es({[e[19]]:!0,"mdc-select__selected-text":!0})))&&{class:ue},{role:"button"},{"aria-haspopup":"listbox"},(!Oi||V[0]&2048&&be!==(be=e[11]+"-smui-label"))&&{"aria-labelledby":be},V[1]&4194304&&wl(e[53],"selectedText$")])),Ke&&Eu(Ke.update)&&V[0]&262144&&Ke.update.call(null,e[18]),sl(G,fi=ma(Ji,[(!Oi||V[0]&131072&&ot!==(ot=Es({[e[17]]:!0,"mdc-select__selected-text-container":!0})))&&{class:ot},V[1]&4194304&&wl(e[53],"selectedTextContainer$")])),tt&&Eu(tt.update)&&V[0]&65536&&tt.update.call(null,e[16]),sl(ut,ii=ma(pn,[(!Oi||V[0]&2097152&&Ge!==(Ge=Es({[e[21]]:!0,"mdc-select__dropdown-icon":!0})))&&{class:Ge},V[1]&4194304&&wl(e[53],"dropdownIcon$")])),Xt&&Eu(Xt.update)&&V[0]&1048576&&Xt.update.call(null,e[20]),e[7]!=="outlined"&&e[5]?wn?(wn.p(e,V),V[0]&160&&$i(wn,1)):(wn=dx(e),wn.c(),$i(wn,1),wn.m(c,null)):wn&&(Ho(),dn(wn,1,1,()=>{wn=null}),jo()),sl(c,hi=ma(Rr,[(!Oi||V[0]&32768&&yt!==(yt=Es({[e[15]]:!0,"mdc-select__anchor":!0})))&&{class:yt},(!Oi||V[0]&1024&&pt!==(pt=e[10]?"true":void 0))&&{"aria-required":pt},(!Oi||V[0]&64&&gt!==(gt=e[6]?"true":void 0))&&{"aria-disabled":gt},{"aria-controls":e[45]},(!Oi||V[1]&1&&bt!==(bt=e[31]?"true":"false"))&&{"aria-expanded":bt},(!Oi||V[0]&1073741824)&&{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},V[0]&536870912&&e[29],V[1]&4194304&&wl(e[53],"anchor$")])),dt&&Eu(dt.update)&&V[0]&16384&&dt.update.call(null,e[14]);const $=V[0]&4194304|V[1]&4210702?ma(en,[V[0]&4194304|V[1]&2&&{class:Es({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},V[1]&16384&&{id:e[45]},en[2],en[3],V[1]&4&&{anchorElement:e[33]},V[1]&8&&{anchorCorner:e[34]},V[1]&4194304&&Fs(wl(e[53],"menu$"))]):{};V[0]&16777216|V[1]&4194352|V[2]&33554432&&($.$$scope={dirty:V,ctx:e}),!st&&V[1]&1&&(st=!0,$.open=e[31],O0(()=>st=!1)),mt.$set($),sl(t,In=ma(Qn,[(!Oi||V[0]&67119050|V[1]&8388609&&Nt!==(Nt=Es({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})))&&{class:Nt},(!Oi||V[0]&134217744&&Rt!==(Rt=Object.entries(e[27]).map(mx).concat([e[4]]).join(" ")))&&{style:Rt},V[1]&4194304&&W2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])])),Ot&&Eu(Ot.update)&&V[0]&128&&Ot.update.call(null,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]}),_i&&Eu(_i.update)&&V[0]&4&&_i.update.call(null,e[2]),e[54].helperText?v?(v.p(e,V),V[1]&8388608&&$i(v,1)):(v=px(e),v.c(),$i(v,1),v.m(Ti.parentNode,Ti)):v&&(Ho(),dn(v,1,1,()=>{v=null}),jo())},i(k){Oi||($i(yn),$i(Ci),$i(Ri,k),$i(wn),$i(mt.$$.fragment,k),$i(v),Oi=!0)},o(k){dn(yn),dn(Ci),dn(Ri,k),dn(wn),dn(mt.$$.fragment,k),dn(v),Oi=!1},d(k){k&&(bi(t),bi(Si),bi(Ti)),Ni&&Ni.d(),nn&&nn.d(),yn&&yn.d(),Ci&&Ci.d(),Ri&&Ri.d(k),wn&&wn.d(),e[71](null),ys(mt),e[82](null),v&&v.d(k),tn=!1,Nh(qi)}}}let $C=0;function KC(e){const t=e.currentTarget.getBoundingClientRect();return(JC(e)?e.touches[0].clientX:e.clientX)-t.left}function JC(e){return"touches"in e}const mx=([e,t])=>`${e}: ${t};`;function eT(e,t,n){const c=["use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","getUseDefaultValidation","setUseDefaultValidation","focus","layout","getElement"];let g=co(t,c),b,I,{$$slots:a={},$$scope:G}=t;const W=eE(a);var he;const ae=wc(yc());let ue=()=>{};function be($t){return $t===ue}let{use:Ke=[]}=t,{class:ot=""}=t,{style:tt=""}=t,{ripple:lt=!0}=t,{disabled:ut=!1}=t,{variant:Tt="standard"}=t,{noLabel:Pt=!1}=t,{label:zt=void 0}=t,{value:Ge=""}=t,{key:Xt=$t=>$t}=t,{dirty:rt=!1}=t,{invalid:yt=ue}=t,{updateInvalid:pt=be(yt)}=t;const gt=be(yt);be(yt)&&(yt=!1);let{required:bt=!1}=t,{inputId:dt="SMUI-select-"+$C++}=t,{hiddenInput:$e=!1}=t,{withLeadingIcon:mt=ue}=t,{anchor$use:st=[]}=t,{anchor$class:Nt=""}=t,{selectedTextContainer$use:Rt=[]}=t,{selectedTextContainer$class:Ot=""}=t,{selectedText$use:_i=[]}=t,{selectedText$class:Si=""}=t,{dropdownIcon$use:Ti=[]}=t,{dropdownIcon$class:Oi=""}=t,{menu$class:tn=""}=t,qi,Ni,nn={},yn={},Ci,gi={},Ri=-1,ai=(he=g.menu$id)!==null&&he!==void 0?he:dt+"-menu",Ki,Ji=Cu("SMUI:addLayoutListener"),fi,pn=!1,ii={},wn,Rr,hi=!1,en,tr=Cu("SMUI:select:context"),Fn,Qn,In,v,k;du("SMUI:list:role",""),du("SMUI:list:nav",!1);const V=ep("");Vc(e,V,$t=>n(42,b=$t)),du("SMUI:select:selectedText",V);const $=ep(Ge);Vc(e,$,$t=>n(90,I=$t)),du("SMUI:select:value",$);let te=Ri;Ji&&(fi=Ji(X)),vc(()=>(n(23,Ni=new zE({setSelectedText:$t=>{om(V,b=$t,b)},isSelectAnchorFocused:()=>document.activeElement===Ci,getSelectAnchorAttr:Ze,setSelectAnchorAttr:Ve,removeSelectAnchorAttr:ft,addMenuClass:Qe,removeMenuClass:He,openMenu:()=>{n(31,pn=!0)},closeMenu:()=>{n(31,pn=!1)},getAnchorElement:()=>Ci,setMenuAnchorElement:$t=>{n(33,wn=$t)},setMenuAnchorCorner:$t=>{n(34,Rr=$t)},setMenuWrapFocus:$t=>{n(35,hi=$t)},getSelectedIndex:()=>Ri,setSelectedIndex:$t=>{n(63,te=$t),n(24,Ri=$t),n(0,Ge=nt()[Ri])},focusMenuItemAtIndex:$t=>{en.focusItemAtIndex($t)},getMenuItemCount:()=>en.items.length,getMenuItemValues:()=>nt().map(Xt),getMenuItemTextAtIndex:$t=>en.getPrimaryTextAtIndex($t),isTypeaheadInProgress:()=>en.typeaheadInProgress,typeaheadMatchItem:($t,vn)=>en.typeaheadMatchItem($t,vn),addClass:Ie,removeClass:Ee,hasClass:ve,setRippleCenter:$t=>v&&v.setRippleCenter($t),activateBottomLine:()=>v&&v.activate(),deactivateBottomLine:()=>v&&v.deactivate(),notifyChange:$t=>{n(55,rt=!0),pt&&n(1,yt=!Ni.isValid()),iu(ie(),"SMUISelect:change",{value:Ge,index:Ri},void 0,!0)},hasOutline:()=>!!k,notchOutline:$t=>k&&k.notch($t),closeOutline:()=>k&&k.closeNotch(),hasLabel:()=>!!In,floatLabel:$t=>In&&In.float($t),getLabelWidth:()=>In?In.getWidth():0,setLabelRequired:$t=>In&&In.setRequired($t)},{get helperText(){return Qn},get leadingIcon(){return Fn}})),n(24,Ri=nt().indexOf(Ge)),Ni.init(),se(gt),()=>{Ni.destroy()})),wm(()=>{fi&&fi()});function fe($t){n(37,Fn=$t.detail)}function ve($t){return $t in nn?nn[$t]:ie().classList.contains($t)}function Ie($t){nn[$t]||n(26,nn[$t]=!0,nn)}function Ee($t){(!($t in nn)||nn[$t])&&n(26,nn[$t]=!1,nn)}function ze($t,vn){yn[$t]!=vn&&(vn===""||vn==null?(delete yn[$t],n(27,yn)):n(27,yn[$t]=vn,yn))}function Qe($t){ii[$t]||n(32,ii[$t]=!0,ii)}function He($t){(!($t in ii)||ii[$t])&&n(32,ii[$t]=!1,ii)}function Ze($t){var vn;return $t in gi?(vn=gi[$t])!==null&&vn!==void 0?vn:null:ie().getAttribute($t)}function Ve($t,vn){gi[$t]!==vn&&n(29,gi[$t]=vn,gi)}function ft($t){(!($t in gi)||gi[$t]!=null)&&n(29,gi[$t]=void 0,gi)}function nt(){return en.getOrderedList().map($t=>$t.getValue())}function Me(){return Ni.getUseDefaultValidation()}function se($t){Ni.setUseDefaultValidation($t)}function ne(){Ci.focus()}function X(){Ni.layout()}function ie(){return qi}function de($t){N2.call(this,e,$t)}function ye($t){N2.call(this,e,$t)}function ge($t){pa[$t?"unshift":"push"](()=>{In=$t,n(39,In)})}function Pe($t){pa[$t?"unshift":"push"](()=>{In=$t,n(39,In)})}function Fe($t){pa[$t?"unshift":"push"](()=>{k=$t,n(41,k)})}function Ne($t){pa[$t?"unshift":"push"](()=>{v=$t,n(40,v)})}function Xe($t){pa[$t?"unshift":"push"](()=>{Ci=$t,n(28,Ci)})}const Ye=()=>Ni&&Ni.handleFocus(),De=()=>Ni&&Ni.handleBlur(),Ue=$t=>{Ci.focus(),Ni&&Ni.handleClick(KC($t))};function ht($t){Ri=$t,n(24,Ri)}const kt=$t=>n(36,en=$t.detail);function o($t){pn=$t,n(31,pn)}const ke=$t=>Ni&&Ni.handleMenuItemAction($t.detail.index),oi=()=>Ni&&Ni.handleMenuClosing(),di=()=>Ni&&Ni.handleMenuClosed(),Ai=()=>Ni&&Ni.handleMenuOpened();function Jt($t){pa[$t?"unshift":"push"](()=>{qi=$t,n(25,qi)})}const li=()=>n(37,Fn=void 0),zi=$t=>n(30,Ki=$t.detail),vi=$t=>n(38,Qn=$t.detail),wi=()=>{n(30,Ki=void 0),n(38,Qn=void 0)};return e.$$set=$t=>{t=gr(gr({},t),ec($t)),n(53,g=co(t,c)),"use"in $t&&n(2,Ke=$t.use),"class"in $t&&n(3,ot=$t.class),"style"in $t&&n(4,tt=$t.style),"ripple"in $t&&n(5,lt=$t.ripple),"disabled"in $t&&n(6,ut=$t.disabled),"variant"in $t&&n(7,Tt=$t.variant),"noLabel"in $t&&n(8,Pt=$t.noLabel),"label"in $t&&n(9,zt=$t.label),"value"in $t&&n(0,Ge=$t.value),"key"in $t&&n(56,Xt=$t.key),"dirty"in $t&&n(55,rt=$t.dirty),"invalid"in $t&&n(1,yt=$t.invalid),"updateInvalid"in $t&&n(57,pt=$t.updateInvalid),"required"in $t&&n(10,bt=$t.required),"inputId"in $t&&n(11,dt=$t.inputId),"hiddenInput"in $t&&n(12,$e=$t.hiddenInput),"withLeadingIcon"in $t&&n(13,mt=$t.withLeadingIcon),"anchor$use"in $t&&n(14,st=$t.anchor$use),"anchor$class"in $t&&n(15,Nt=$t.anchor$class),"selectedTextContainer$use"in $t&&n(16,Rt=$t.selectedTextContainer$use),"selectedTextContainer$class"in $t&&n(17,Ot=$t.selectedTextContainer$class),"selectedText$use"in $t&&n(18,_i=$t.selectedText$use),"selectedText$class"in $t&&n(19,Si=$t.selectedText$class),"dropdownIcon$use"in $t&&n(20,Ti=$t.dropdownIcon$use),"dropdownIcon$class"in $t&&n(21,Oi=$t.dropdownIcon$class),"menu$class"in $t&&n(22,tn=$t.menu$class),"$$scope"in $t&&n(87,G=$t.$$scope)},e.$$.update=()=>{if(e.$$.dirty[0]&25165825|e.$$.dirty[2]&2&&te!==Ri)if(n(63,te=Ri),Ni)Ni.setSelectedIndex(Ri,!1,!0);else{const $t=nt();Ge!==$t[Ri]&&n(0,Ge=$t[Ri])}e.$$.dirty[0]&1&&om($,I=Ge,I),e.$$.dirty[0]&8388609|e.$$.dirty[1]&33554432&&Ni&&Ni.getValue()!==Xt(Ge)&&Ni.setValue(Xt(Ge)),e.$$.dirty[0]&8388672&&Ni&&Ni.getDisabled()!==ut&&Ni.setDisabled(ut),e.$$.dirty[0]&8388610|e.$$.dirty[1]&83886080&&Ni&&rt&&Ni.isValid()!==!yt&&(pt?n(1,yt=!Ni.isValid()):Ni.setValid(!yt)),e.$$.dirty[0]&8389632&&Ni&&Ni.getRequired()!==bt&&Ni.setRequired(bt)},[Ge,yt,Ke,ot,tt,lt,ut,Tt,Pt,zt,bt,dt,$e,mt,st,Nt,Rt,Ot,_i,Si,Ti,Oi,tn,Ni,Ri,qi,nn,yn,Ci,gi,Ki,pn,ii,wn,Rr,hi,en,Fn,Qn,In,v,k,b,ae,be,ai,tr,V,$,fe,Ie,Ee,ze,g,W,rt,Xt,pt,Me,se,ne,X,ie,te,a,de,ye,ge,Pe,Fe,Ne,Xe,Ye,De,Ue,ht,kt,o,ke,oi,di,Ai,Jt,li,zi,vi,wi,G]}class Ag extends Lo{constructor(t){super(),Bo(this,t,eT,YC,ho,{use:2,class:3,style:4,ripple:5,disabled:6,variant:7,noLabel:8,label:9,value:0,key:56,dirty:55,invalid:1,updateInvalid:57,required:10,inputId:11,hiddenInput:12,withLeadingIcon:13,anchor$use:14,anchor$class:15,selectedTextContainer$use:16,selectedTextContainer$class:17,selectedText$use:18,selectedText$class:19,dropdownIcon$use:20,dropdownIcon$class:21,menu$class:22,getUseDefaultValidation:58,setUseDefaultValidation:59,focus:60,layout:61,getElement:62},null,[-1,-1,-1,-1])}get getUseDefaultValidation(){return this.$$.ctx[58]}get setUseDefaultValidation(){return this.$$.ctx[59]}get focus(){return this.$$.ctx[60]}get layout(){return this.$$.ctx[61]}get getElement(){return this.$$.ctx[62]}}function tT(e){let t;const n=e[11].default,c=ru(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&8192)&&su(c,n,g,g[13],t?ou(n,g[13],b,null):au(g[13]),null)},i(g){t||($i(c,g),t=!0)},o(g){dn(c,g),t=!1},d(g){c&&c.d(g)}}}function iT(e){let t,n;const c=[{use:e[3]},{"data-value":e[0]},{value:e[0]},{selected:e[2]},e[6]];let g={$$slots:{default:[tT]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new vC({props:g}),e[12](t),{c(){gs(t.$$.fragment)},l(b){Xs(t.$$.fragment,b)},m(b,I){_s(t,b,I),n=!0},p(b,[I]){const a=I&77?ma(c,[I&8&&{use:b[3]},I&1&&{"data-value":b[0]},I&1&&{value:b[0]},I&4&&{selected:b[2]},I&64&&Fs(b[6])]):{};I&8192&&(a.$$scope={dirty:I,ctx:b}),t.$set(a)},i(b){n||($i(t.$$.fragment,b),n=!0)},o(b){dn(t.$$.fragment,b),n=!1},d(b){e[12](null),ys(t,b)}}}function nT(e,t,n){let c,g;const b=["use","class","value","getElement"];let I=co(t,b),a,G,{$$slots:W={},$$scope:he}=t;const ae=wc(yc());let{use:ue=[]}=t;const be="";let{value:Ke=""}=t,ot;const tt=Cu("SMUI:select:selectedText");Vc(e,tt,zt=>n(14,a=zt));const lt=Cu("SMUI:select:value");Vc(e,lt,zt=>n(10,G=zt)),du("SMUI:list:item:role","option"),vc(ut),wm(ut);function ut(){g&&ot&&om(tt,a=ot.getPrimaryText(),a)}function Tt(){return ot.getElement()}function Pt(zt){pa[zt?"unshift":"push"](()=>{ot=zt,n(1,ot)})}return e.$$set=zt=>{t=gr(gr({},t),ec(zt)),n(6,I=co(t,b)),"use"in zt&&n(7,ue=zt.use),"value"in zt&&n(0,Ke=zt.value),"$$scope"in zt&&n(13,he=zt.$$scope)},e.$$.update=()=>{e.$$.dirty&128&&n(3,c=[ae,...ue]),e.$$.dirty&1025&&n(2,g=Ke!=null&&Ke!==""&&G===Ke)},[Ke,ot,g,c,tt,lt,I,ue,be,Tt,G,W,Pt,he]}class Cg extends Lo{constructor(t){super(),Bo(this,t,nT,iT,ho,{use:7,class:8,value:0,getElement:9})}get class(){return this.$$.ctx[8]}get getElement(){return this.$$.ctx[9]}}function m_(e,t,n="*ibm"){return Lv[n](e,t)}function rT(e="*ibm_flip"){return[[-1,"#dddddd"],[.5,"#648FFFcc"],[1,"#7580ed"],[1.5,"#8671db"],[2,"#9762c9"],[2.5,"#a853b7"],[5,"#b944a5"],[10,"#ca3593"],[25,"#DC267Fcc"],[75,"#FFB000cc"],[90,"#e64c5a"],[97.5,"#eb6048"],[98,"#f07436"],[98.5,"#f58824"],[99,"#fa9c12"],[99.5,"#FFB000cc"]]}function sT(e="*ibm_flip"){let t=Lv[e](0,1),n=[];for(let c of t)n.push(c[1]);return n}function Go(e,t,n){return n*(t-e)+e}const Lv={"*ibm":function(t,n){return[[-1,"#dddddd"],[t,"#648FFF","Very low"],[Go(t,n,.25),"#785EF0"],[Go(t,n,.5),"#DC267F","Expected"],[Go(t,n,.75),"#FE6100"],[n,"#FFB000","Very high"]]},"*ibm_flip":function(t,n){return[[-1,"#dddddd"],[t,"#FFB000","Very low"],[Go(t,n,.25),"#FE6100"],[Go(t,n,.5),"#DC267F","Expected"],[Go(t,n,.75),"#785EF0"],[n,"#648FFF","Very high"]]},orGrBlu:function(t,n){return[[-1,"#dddddd"],[t,"#F9A825","Very low"],[Go(t,n,.35),"#e8f4c4"],[Go(t,n,.5),"#00E676","Expected"],[Go(t,n,.75),"#3d9ab8"],[Go(t,n,.85),"#318ab5"],[n,"#2a4e9b","Very high"]]},blGr:function(t,n){return[[-1,"#dddddd"],[t,"#000000","Very low"],[n,"#00ff00","Very high"]]},blBluCyWt:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#000000","Very low"],[Go(t,n,.5),"#0000ff","Expected"],[Go(t,n,.75),"#00ffff"],[n,"#ffffff","Very high"]]},rdYlGr:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#fd5533","Very low"],[Go(t,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},"*mgYlGr":function(t,n){return[[-1,"#dddddd","Missing"],[t,"#F15C8E","Very low"],[Go(t,n,.5),"#f8f611","Normal"],[n,"#4eb87b","Very high"]]},grYlRd:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#00ff33","Very low biodiversity"],[Go(t,n,.5),"#ffff33","Normal biodiversity"],[n,"#ff3300","Very high biodiversity"]]},"*census":function(t,n){return[[-1,"#dddddd","Missing"],[t,"#efd100","Very low biodiversity"],[Go(t,n,.5),"#4eb87b","Normal biodiversity"],[n,"#007fc4","Very high biodiversity"]]},seqseq:function(t,n){return[[-1,"#dddddd","Missing"],[t,"#de4fa6","Very low biodiversity"],[Go(t,n,.5),"#4fadd0","Normal biodiversity"],[n,"#2a1a8a","Very high biodiversity"]]},"*parula":function(t,n){return[[-1,"#dddddd"],[t,"#352a87","Very low"],[Go(t,n,.167),"#0469df"],[Go(t,n,.33),"#06a0cb"],[Go(t,n,.5),"#1fb2ac","Expected"],[Go(t,n,.667),"#a3bd6a"],[Go(t,n,.833),"#fcc336"],[n,"#f8f611","Very high"]]},"*parula_flip":function(t,n){return[[-1,"#dddddd"],[t,"#f8f611","Very low"],[Go(t,n,.167),"#fcc336"],[Go(t,n,.33),"#a3bd6a"],[Go(t,n,.5),"#1fb2ac","Expected"],[Go(t,n,.667),"#06a0cb"],[Go(t,n,.833),"#0469df"],[n,"#352a87","Very high"]]}};function fm(){return{100:"#e9f6fc",200:"#b9e4f7",300:"#89d1f0",400:"#59bee9",500:"#29abe2",600:"#2186af",700:"#175f7c",800:"#0d3849",900:"#031116"}}var Jf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function c(){return this instanceof c?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(c){var g=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(n,c,g.get?g:{enumerable:!0,get:function(){return e[c]}})}),n}var A3={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.0/LICENSE.txt
 */(function(e,t){(function(n,c){e.exports=c()})(Jf,function(){var n={},c={};function g(I,a,G){if(c[I]=G,I==="index"){var W="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",he={};return c.shared(he),c.index(n,he),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),n}}g("shared",["exports"],function(I){function a(m,h,x,M){return new(x||(x=Promise))(function(q,K){function J(Oe){try{Ce(M.next(Oe))}catch(f){K(f)}}function me(Oe){try{Ce(M.throw(Oe))}catch(f){K(f)}}function Ce(Oe){var f;Oe.done?q(Oe.value):(f=Oe.value,f instanceof x?f:new x(function(u){u(f)})).then(J,me)}Ce((M=M.apply(m,h||[])).next())})}function G(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}typeof SuppressedError=="function"&&SuppressedError;var W=he;function he(m,h){this.x=m,this.y=h}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(m){return this.clone()._add(m)},sub:function(m){return this.clone()._sub(m)},multByPoint:function(m){return this.clone()._multByPoint(m)},divByPoint:function(m){return this.clone()._divByPoint(m)},mult:function(m){return this.clone()._mult(m)},div:function(m){return this.clone()._div(m)},rotate:function(m){return this.clone()._rotate(m)},rotateAround:function(m,h){return this.clone()._rotateAround(m,h)},matMult:function(m){return this.clone()._matMult(m)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(m){return this.x===m.x&&this.y===m.y},dist:function(m){return Math.sqrt(this.distSqr(m))},distSqr:function(m){var h=m.x-this.x,x=m.y-this.y;return h*h+x*x},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(m){return Math.atan2(this.y-m.y,this.x-m.x)},angleWith:function(m){return this.angleWithSep(m.x,m.y)},angleWithSep:function(m,h){return Math.atan2(this.x*h-this.y*m,this.x*m+this.y*h)},_matMult:function(m){var h=m[2]*this.x+m[3]*this.y;return this.x=m[0]*this.x+m[1]*this.y,this.y=h,this},_add:function(m){return this.x+=m.x,this.y+=m.y,this},_sub:function(m){return this.x-=m.x,this.y-=m.y,this},_mult:function(m){return this.x*=m,this.y*=m,this},_div:function(m){return this.x/=m,this.y/=m,this},_multByPoint:function(m){return this.x*=m.x,this.y*=m.y,this},_divByPoint:function(m){return this.x/=m.x,this.y/=m.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var m=this.y;return this.y=this.x,this.x=-m,this},_rotate:function(m){var h=Math.cos(m),x=Math.sin(m),M=x*this.x+h*this.y;return this.x=h*this.x-x*this.y,this.y=M,this},_rotateAround:function(m,h){var x=Math.cos(m),M=Math.sin(m),q=h.y+M*(this.x-h.x)+x*(this.y-h.y);return this.x=h.x+x*(this.x-h.x)-M*(this.y-h.y),this.y=q,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(m){return m instanceof he?m:Array.isArray(m)?new he(m[0],m[1]):m};var ae=G(W),ue=be;function be(m,h,x,M){this.cx=3*m,this.bx=3*(x-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=x,this.p2y=M}be.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var x=m,M=0;M<8;M++){var q=this.sampleCurveX(x)-m;if(Math.abs(q)<h)return x;var K=this.sampleCurveDerivativeX(x);if(Math.abs(K)<1e-6)break;x-=q/K}var J=0,me=1;for(x=m,M=0;M<20&&(q=this.sampleCurveX(x),!(Math.abs(q-m)<h));M++)m>q?J=x:me=x,x=.5*(me-J)+J;return x},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var Ke=G(ue);let ot,tt;function lt(){return ot==null&&(ot=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ot}function ut(){if(tt==null&&(tt=!1,lt())){const h=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(h){for(let M=0;M<5*5;M++){const q=4*M;h.fillStyle=`rgb(${q},${q+1},${q+2})`,h.fillRect(M%5,Math.floor(M/5),1,1)}const x=h.getImageData(0,0,5,5).data;for(let M=0;M<5*5*4;M++)if(M%4!=3&&x[M]!==M){tt=!0;break}}}return tt||!1}function Tt(m,h,x,M){const q=new Ke(m,h,x,M);return function(K){return q.solve(K)}}const Pt=Tt(.25,.1,.25,1);function zt(m,h,x){return Math.min(x,Math.max(h,m))}function Ge(m,h,x){const M=x-h,q=((m-h)%M+M)%M+h;return q===h?x:q}function Xt(m,...h){for(const x of h)for(const M in x)m[M]=x[M];return m}let rt=1;function yt(m,h,x){const M={};for(const q in m)M[q]=h.call(x||this,m[q],q,m);return M}function pt(m,h,x){const M={};for(const q in m)h.call(x||this,m[q],q,m)&&(M[q]=m[q]);return M}function gt(m){return Array.isArray(m)?m.map(gt):typeof m=="object"&&m?yt(m,gt):m}const bt={};function dt(m){bt[m]||(typeof console<"u"&&console.warn(m),bt[m]=!0)}function $e(m,h,x){return(x.y-m.y)*(h.x-m.x)>(h.y-m.y)*(x.x-m.x)}function mt(m){let h=0;for(let x,M,q=0,K=m.length,J=K-1;q<K;J=q++)x=m[q],M=m[J],h+=(M.x-x.x)*(x.y+M.y);return h}function st(m){return typeof WorkerGlobalScope<"u"&&m!==void 0&&m instanceof WorkerGlobalScope}let Nt=null;function Rt(m){return typeof ImageBitmap<"u"&&m instanceof ImageBitmap}const Ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function _i(m,h,x,M,q){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const K=new VideoFrame(m,{timestamp:0});try{const J=K==null?void 0:K.format;if(!J||!J.startsWith("BGR")&&!J.startsWith("RGB"))throw new Error(`Unrecognized format ${J}`);const me=J.startsWith("BGR"),Ce=new Uint8ClampedArray(M*q*4);if(yield K.copyTo(Ce,function(Oe,f,u,p,S){const L=4*Math.max(-f,0),U=(Math.max(0,u)-u)*p*4+L,Q=4*p,re=Math.max(0,f),Ae=Math.max(0,u);return{rect:{x:re,y:Ae,width:Math.min(Oe.width,f+p)-re,height:Math.min(Oe.height,u+S)-Ae},layout:[{offset:U,stride:Q}]}}(m,h,x,M,q)),me)for(let Oe=0;Oe<Ce.length;Oe+=4){const f=Ce[Oe];Ce[Oe]=Ce[Oe+2],Ce[Oe+2]=f}return Ce}finally{K.close()}})}let Si,Ti;const Oi="AbortError";function tn(){return new Error(Oi)}const qi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ni(m){return qi.REGISTERED_PROTOCOLS[m.substring(0,m.indexOf("://"))]}const nn="global-dispatcher";class yn extends Error{constructor(h,x,M,q){super(`AJAXError: ${x} (${h}): ${M}`),this.status=h,this.statusText=x,this.url=M,this.body=q}}const Ci=()=>st(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,gi=function(m,h){if(/:\/\//.test(m.url)&&!/^https?:|^file:/.test(m.url)){const M=Ni(m.url);if(M)return M(m,h);if(st(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,targetMapId:nn},h)}if(!(/^file:/.test(x=m.url)||/^file:/.test(Ci())&&!/^\w+:/.test(x))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(M,q){return a(this,void 0,void 0,function*(){const K=new Request(M.url,{method:M.method||"GET",body:M.body,credentials:M.credentials,headers:M.headers,cache:M.cache,referrer:Ci(),signal:q.signal});M.type==="json"&&K.headers.set("Accept","application/json");const J=yield fetch(K);if(!J.ok){const Oe=yield J.blob();throw new yn(J.status,J.statusText,M.url,Oe)}const me=M.type==="arrayBuffer"||M.type==="image"?J.arrayBuffer():M.type==="json"?J.json():J.text(),Ce=yield me;if(q.signal.aborted)throw tn();return{data:Ce,cacheControl:J.headers.get("Cache-Control"),expires:J.headers.get("Expires")}})}(m,h);if(st(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,mustQueue:!0,targetMapId:nn},h)}var x;return function(M,q){return new Promise((K,J)=>{const me=new XMLHttpRequest;me.open(M.method||"GET",M.url,!0),M.type!=="arrayBuffer"&&M.type!=="image"||(me.responseType="arraybuffer");for(const Ce in M.headers)me.setRequestHeader(Ce,M.headers[Ce]);M.type==="json"&&(me.responseType="text",me.setRequestHeader("Accept","application/json")),me.withCredentials=M.credentials==="include",me.onerror=()=>{J(new Error(me.statusText))},me.onload=()=>{if(!q.signal.aborted)if((me.status>=200&&me.status<300||me.status===0)&&me.response!==null){let Ce=me.response;if(M.type==="json")try{Ce=JSON.parse(me.response)}catch(Oe){return void J(Oe)}K({data:Ce,cacheControl:me.getResponseHeader("Cache-Control"),expires:me.getResponseHeader("Expires")})}else{const Ce=new Blob([me.response],{type:me.getResponseHeader("Content-Type")});J(new yn(me.status,me.statusText,M.url,Ce))}},q.signal.addEventListener("abort",()=>{me.abort(),J(tn())}),me.send(M.body)})}(m,h)};function Ri(m){if(!m||m.indexOf("://")<=0||m.indexOf("data:image/")===0||m.indexOf("blob:")===0)return!0;const h=new URL(m),x=window.location;return h.protocol===x.protocol&&h.host===x.host}function ai(m,h,x){x[m]&&x[m].indexOf(h)!==-1||(x[m]=x[m]||[],x[m].push(h))}function Ki(m,h,x){if(x&&x[m]){const M=x[m].indexOf(h);M!==-1&&x[m].splice(M,1)}}class Ji{constructor(h,x={}){Xt(this,x),this.type=h}}class fi extends Ji{constructor(h,x={}){super("error",Xt({error:h},x))}}class pn{on(h,x){return this._listeners=this._listeners||{},ai(h,x,this._listeners),this}off(h,x){return Ki(h,x,this._listeners),Ki(h,x,this._oneTimeListeners),this}once(h,x){return x?(this._oneTimeListeners=this._oneTimeListeners||{},ai(h,x,this._oneTimeListeners),this):new Promise(M=>this.once(h,M))}fire(h,x){typeof h=="string"&&(h=new Ji(h,x||{}));const M=h.type;if(this.listens(M)){h.target=this;const q=this._listeners&&this._listeners[M]?this._listeners[M].slice():[];for(const me of q)me.call(this,h);const K=this._oneTimeListeners&&this._oneTimeListeners[M]?this._oneTimeListeners[M].slice():[];for(const me of K)Ki(M,me,this._oneTimeListeners),me.call(this,h);const J=this._eventedParent;J&&(Xt(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),J.fire(h))}else h instanceof fi&&console.error(h.error);return this}listens(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)}setEventedParent(h,x){return this._eventedParent=h,this._eventedParentData=x,this}}var ii={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const wn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Rr(m,h){const x={};for(const M in m)M!=="ref"&&(x[M]=m[M]);return wn.forEach(M=>{M in h&&(x[M]=h[M])}),x}function hi(m,h){if(Array.isArray(m)){if(!Array.isArray(h)||m.length!==h.length)return!1;for(let x=0;x<m.length;x++)if(!hi(m[x],h[x]))return!1;return!0}if(typeof m=="object"&&m!==null&&h!==null){if(typeof h!="object"||Object.keys(m).length!==Object.keys(h).length)return!1;for(const x in m)if(!hi(m[x],h[x]))return!1;return!0}return m===h}function en(m,h){m.push(h)}function tr(m,h,x){en(x,{command:"addSource",args:[m,h[m]]})}function Fn(m,h,x){en(h,{command:"removeSource",args:[m]}),x[m]=!0}function Qn(m,h,x,M){Fn(m,x,M),tr(m,h,x)}function In(m,h,x){let M;for(M in m[x])if(Object.prototype.hasOwnProperty.call(m[x],M)&&M!=="data"&&!hi(m[x][M],h[x][M]))return!1;for(M in h[x])if(Object.prototype.hasOwnProperty.call(h[x],M)&&M!=="data"&&!hi(m[x][M],h[x][M]))return!1;return!0}function v(m,h,x,M,q,K){m=m||{},h=h||{};for(const J in m)Object.prototype.hasOwnProperty.call(m,J)&&(hi(m[J],h[J])||x.push({command:K,args:[M,J,h[J],q]}));for(const J in h)Object.prototype.hasOwnProperty.call(h,J)&&!Object.prototype.hasOwnProperty.call(m,J)&&(hi(m[J],h[J])||x.push({command:K,args:[M,J,h[J],q]}))}function k(m){return m.id}function V(m,h){return m[h.id]=h,m}class ${constructor(h,x,M,q){this.message=(h?`${h}: `:"")+M,q&&(this.identifier=q),x!=null&&x.__line__&&(this.line=x.__line__)}}function te(m,...h){for(const x of h)for(const M in x)m[M]=x[M];return m}class fe extends Error{constructor(h,x){super(x),this.message=x,this.key=h}}class ve{constructor(h,x=[]){this.parent=h,this.bindings={};for(const[M,q]of x)this.bindings[M]=q}concat(h){return new ve(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}const Ie={kind:"null"},Ee={kind:"number"},ze={kind:"string"},Qe={kind:"boolean"},He={kind:"color"},Ze={kind:"object"},Ve={kind:"value"},ft={kind:"collator"},nt={kind:"formatted"},Me={kind:"padding"},se={kind:"resolvedImage"},ne={kind:"variableAnchorOffsetCollection"};function X(m,h){return{kind:"array",itemType:m,N:h}}function ie(m){if(m.kind==="array"){const h=ie(m.itemType);return typeof m.N=="number"?`array<${h}, ${m.N}>`:m.itemType.kind==="value"?"array":`array<${h}>`}return m.kind}const de=[Ie,Ee,ze,Qe,He,nt,Ze,X(Ve),Me,se,ne];function ye(m,h){if(h.kind==="error")return null;if(m.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!ye(m.itemType,h.itemType))&&(typeof m.N!="number"||m.N===h.N))return null}else{if(m.kind===h.kind)return null;if(m.kind==="value"){for(const x of de)if(!ye(x,h))return null}}return`Expected ${ie(m)} but found ${ie(h)} instead.`}function ge(m,h){return h.some(x=>x.kind===m.kind)}function Pe(m,h){return h.some(x=>x==="null"?m===null:x==="array"?Array.isArray(m):x==="object"?m&&!Array.isArray(m)&&typeof m=="object":x===typeof m)}function Fe(m,h){return m.kind==="array"&&h.kind==="array"?m.itemType.kind===h.itemType.kind&&typeof m.N=="number":m.kind===h.kind}const Ne=.96422,Xe=.82521,Ye=4/29,De=6/29,Ue=3*De*De,ht=De*De*De,kt=Math.PI/180,o=180/Math.PI;function ke(m){return(m%=360)<0&&(m+=360),m}function oi([m,h,x,M]){let q,K;const J=Ai((.2225045*(m=di(m))+.7168786*(h=di(h))+.0606169*(x=di(x)))/1);m===h&&h===x?q=K=J:(q=Ai((.4360747*m+.3850649*h+.1430804*x)/Ne),K=Ai((.0139322*m+.0971045*h+.7141733*x)/Xe));const me=116*J-16;return[me<0?0:me,500*(q-J),200*(J-K),M]}function di(m){return m<=.04045?m/12.92:Math.pow((m+.055)/1.055,2.4)}function Ai(m){return m>ht?Math.pow(m,1/3):m/Ue+Ye}function Jt([m,h,x,M]){let q=(m+16)/116,K=isNaN(h)?q:q+h/500,J=isNaN(x)?q:q-x/200;return q=1*zi(q),K=Ne*zi(K),J=Xe*zi(J),[li(3.1338561*K-1.6168667*q-.4906146*J),li(-.9787684*K+1.9161415*q+.033454*J),li(.0719453*K-.2289914*q+1.4052427*J),M]}function li(m){return(m=m<=.00304?12.92*m:1.055*Math.pow(m,1/2.4)-.055)<0?0:m>1?1:m}function zi(m){return m>De?m*m*m:Ue*(m-Ye)}function vi(m){return parseInt(m.padEnd(2,m),16)/255}function wi(m,h){return $t(h?m/100:m,0,1)}function $t(m,h,x){return Math.min(Math.max(h,m),x)}function vn(m){return!m.some(Number.isNaN)}const or={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class mn{constructor(h,x,M,q=1,K=!0){this.r=h,this.g=x,this.b=M,this.a=q,K||(this.r*=q,this.g*=q,this.b*=q,q||this.overwriteGetter("rgb",[h,x,M,q]))}static parse(h){if(h instanceof mn)return h;if(typeof h!="string")return;const x=function(M){if((M=M.toLowerCase().trim())==="transparent")return[0,0,0,0];const q=or[M];if(q){const[J,me,Ce]=q;return[J/255,me/255,Ce/255,1]}if(M.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(M)){const J=M.length<6?1:2;let me=1;return[vi(M.slice(me,me+=J)),vi(M.slice(me,me+=J)),vi(M.slice(me,me+=J)),vi(M.slice(me,me+J)||"ff")]}if(M.startsWith("rgb")){const J=M.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(J){const[me,Ce,Oe,f,u,p,S,L,U,Q,re,Ae]=J,_e=[f||" ",S||" ",Q].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const Le=[Oe,p,U].join(""),qe=Le==="%%%"?100:Le===""?255:0;if(qe){const et=[$t(+Ce/qe,0,1),$t(+u/qe,0,1),$t(+L/qe,0,1),re?wi(+re,Ae):1];if(vn(et))return et}}return}}const K=M.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(K){const[J,me,Ce,Oe,f,u,p,S,L]=K,U=[Ce||" ",f||" ",p].join("");if(U==="  "||U==="  /"||U===",,"||U===",,,"){const Q=[+me,$t(+Oe,0,100),$t(+u,0,100),S?wi(+S,L):1];if(vn(Q))return function([re,Ae,_e,Le]){function qe(et){const At=(et+re/30)%12,_t=Ae*Math.min(_e,1-_e);return _e-_t*Math.max(-1,Math.min(At-3,9-At,1))}return re=ke(re),Ae/=100,_e/=100,[qe(0),qe(8),qe(4),Le]}(Q)}}}(h);return x?new mn(...x,!1):void 0}get rgb(){const{r:h,g:x,b:M,a:q}=this,K=q||1/0;return this.overwriteGetter("rgb",[h/K,x/K,M/K,q])}get hcl(){return this.overwriteGetter("hcl",function(h){const[x,M,q,K]=oi(h),J=Math.sqrt(M*M+q*q);return[Math.round(1e4*J)?ke(Math.atan2(q,M)*o):NaN,J,x,K]}(this.rgb))}get lab(){return this.overwriteGetter("lab",oi(this.rgb))}overwriteGetter(h,x){return Object.defineProperty(this,h,{value:x}),x}toString(){const[h,x,M,q]=this.rgb;return`rgba(${[h,x,M].map(K=>Math.round(255*K)).join(",")},${q})`}}mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);class qn{constructor(h,x,M){this.sensitivity=h?x?"variant":"case":x?"accent":"base",this.locale=M,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,x){return this.collator.compare(h,x)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class jr{constructor(h,x,M,q,K){this.text=h,this.image=x,this.scale=M,this.fontStack=q,this.textColor=K}}class Hi{constructor(h){this.sections=h}static fromString(h){return new Hi([new jr(h,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(h=>h.text.length!==0||h.image&&h.image.name.length!==0)}static factory(h){return h instanceof Hi?h:Hi.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map(h=>h.text).join("")}}class ur{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof ur)return h;if(typeof h=="number")return new ur([h,h,h,h]);if(Array.isArray(h)&&!(h.length<1||h.length>4)){for(const x of h)if(typeof x!="number")return;switch(h.length){case 1:h=[h[0],h[0],h[0],h[0]];break;case 2:h=[h[0],h[1],h[0],h[1]];break;case 3:h=[h[0],h[1],h[2],h[1]]}return new ur(h)}}toString(){return JSON.stringify(this.values)}}const On=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Qt{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof Qt)return h;if(Array.isArray(h)&&!(h.length<1)&&h.length%2==0){for(let x=0;x<h.length;x+=2){const M=h[x],q=h[x+1];if(typeof M!="string"||!On.has(M)||!Array.isArray(q)||q.length!==2||typeof q[0]!="number"||typeof q[1]!="number")return}return new Qt(h)}}toString(){return JSON.stringify(this.values)}}class Yi{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new Yi({name:h,available:!1}):null}}function Ut(m,h,x,M){return typeof m=="number"&&m>=0&&m<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof x=="number"&&x>=0&&x<=255?M===void 0||typeof M=="number"&&M>=0&&M<=1?null:`Invalid rgba value [${[m,h,x,M].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof M=="number"?[m,h,x,M]:[m,h,x]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Tn(m){if(m===null||typeof m=="string"||typeof m=="boolean"||typeof m=="number"||m instanceof mn||m instanceof qn||m instanceof Hi||m instanceof ur||m instanceof Qt||m instanceof Yi)return!0;if(Array.isArray(m)){for(const h of m)if(!Tn(h))return!1;return!0}if(typeof m=="object"){for(const h in m)if(!Tn(m[h]))return!1;return!0}return!1}function cr(m){if(m===null)return Ie;if(typeof m=="string")return ze;if(typeof m=="boolean")return Qe;if(typeof m=="number")return Ee;if(m instanceof mn)return He;if(m instanceof qn)return ft;if(m instanceof Hi)return nt;if(m instanceof ur)return Me;if(m instanceof Qt)return ne;if(m instanceof Yi)return se;if(Array.isArray(m)){const h=m.length;let x;for(const M of m){const q=cr(M);if(x){if(x===q)continue;x=Ve;break}x=q}return X(x||Ve,h)}return Ze}function Ns(m){const h=typeof m;return m===null?"":h==="string"||h==="number"||h==="boolean"?String(m):m instanceof mn||m instanceof Hi||m instanceof ur||m instanceof Qt||m instanceof Yi?m.toString():JSON.stringify(m)}class Ur{constructor(h,x){this.type=h,this.value=x}static parse(h,x){if(h.length!==2)return x.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!Tn(h[1]))return x.error("invalid value");const M=h[1];let q=cr(M);const K=x.expectedType;return q.kind!=="array"||q.N!==0||!K||K.kind!=="array"||typeof K.N=="number"&&K.N!==0||(q=K),new Ur(q,M)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Vt{constructor(h){this.name="ExpressionEvaluationError",this.message=h}toJSON(){return this.message}}const hr={string:ze,number:Ee,boolean:Qe,object:Ze};class Lt{constructor(h,x){this.type=h,this.args=x}static parse(h,x){if(h.length<2)return x.error("Expected at least one argument.");let M,q=1;const K=h[0];if(K==="array"){let me,Ce;if(h.length>2){const Oe=h[1];if(typeof Oe!="string"||!(Oe in hr)||Oe==="object")return x.error('The item type argument of "array" must be one of string, number, boolean',1);me=hr[Oe],q++}else me=Ve;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return x.error('The length argument to "array" must be a positive integer literal',2);Ce=h[2],q++}M=X(me,Ce)}else{if(!hr[K])throw new Error(`Types doesn't contain name = ${K}`);M=hr[K]}const J=[];for(;q<h.length;q++){const me=x.parse(h[q],q,Ve);if(!me)return null;J.push(me)}return new Lt(M,J)}evaluate(h){for(let x=0;x<this.args.length;x++){const M=this.args[x].evaluate(h);if(!ye(this.type,cr(M)))return M;if(x===this.args.length-1)throw new Vt(`Expected value to be of type ${ie(this.type)}, but found ${ie(cr(M))} instead.`)}throw new Error}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const Fr={"to-boolean":Qe,"to-color":He,"to-number":Ee,"to-string":ze};class Vs{constructor(h,x){this.type=h,this.args=x}static parse(h,x){if(h.length<2)return x.error("Expected at least one argument.");const M=h[0];if(!Fr[M])throw new Error(`Can't parse ${M} as it is not part of the known types`);if((M==="to-boolean"||M==="to-string")&&h.length!==2)return x.error("Expected one argument.");const q=Fr[M],K=[];for(let J=1;J<h.length;J++){const me=x.parse(h[J],J,Ve);if(!me)return null;K.push(me)}return new Vs(q,K)}evaluate(h){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(h);case"color":{let x,M;for(const q of this.args){if(x=q.evaluate(h),M=null,x instanceof mn)return x;if(typeof x=="string"){const K=h.parseColor(x);if(K)return K}else if(Array.isArray(x)&&(M=x.length<3||x.length>4?`Invalid rbga value ${JSON.stringify(x)}: expected an array containing either three or four numeric values.`:Ut(x[0],x[1],x[2],x[3]),!M))return new mn(x[0]/255,x[1]/255,x[2]/255,x[3])}throw new Vt(M||`Could not parse color from value '${typeof x=="string"?x:JSON.stringify(x)}'`)}case"padding":{let x;for(const M of this.args){x=M.evaluate(h);const q=ur.parse(x);if(q)return q}throw new Vt(`Could not parse padding from value '${typeof x=="string"?x:JSON.stringify(x)}'`)}case"variableAnchorOffsetCollection":{let x;for(const M of this.args){x=M.evaluate(h);const q=Qt.parse(x);if(q)return q}throw new Vt(`Could not parse variableAnchorOffsetCollection from value '${typeof x=="string"?x:JSON.stringify(x)}'`)}case"number":{let x=null;for(const M of this.args){if(x=M.evaluate(h),x===null)return 0;const q=Number(x);if(!isNaN(q))return q}throw new Vt(`Could not convert ${JSON.stringify(x)} to number.`)}case"formatted":return Hi.fromString(Ns(this.args[0].evaluate(h)));case"resolvedImage":return Yi.fromString(Ns(this.args[0].evaluate(h)));default:return Ns(this.args[0].evaluate(h))}}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const ua=["Unknown","Point","LineString","Polygon"];class Pr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ua[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(h){let x=this._parseColorCache[h];return x||(x=this._parseColorCache[h]=mn.parse(h)),x}}class Fa{constructor(h,x,M=[],q,K=new ve,J=[]){this.registry=h,this.path=M,this.key=M.map(me=>`[${me}]`).join(""),this.scope=K,this.errors=J,this.expectedType=q,this._isConstant=x}parse(h,x,M,q,K={}){return x?this.concat(x,M,q)._parse(h,K):this._parse(h,K)}_parse(h,x){function M(q,K,J){return J==="assert"?new Lt(K,[q]):J==="coerce"?new Vs(K,[q]):q}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const q=h[0];if(typeof q!="string")return this.error(`Expression name must be a string, but found ${typeof q} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const K=this.registry[q];if(K){let J=K.parse(h,this);if(!J)return null;if(this.expectedType){const me=this.expectedType,Ce=J.type;if(me.kind!=="string"&&me.kind!=="number"&&me.kind!=="boolean"&&me.kind!=="object"&&me.kind!=="array"||Ce.kind!=="value")if(me.kind!=="color"&&me.kind!=="formatted"&&me.kind!=="resolvedImage"||Ce.kind!=="value"&&Ce.kind!=="string")if(me.kind!=="padding"||Ce.kind!=="value"&&Ce.kind!=="number"&&Ce.kind!=="array")if(me.kind!=="variableAnchorOffsetCollection"||Ce.kind!=="value"&&Ce.kind!=="array"){if(this.checkSubtype(me,Ce))return null}else J=M(J,me,x.typeAnnotation||"coerce");else J=M(J,me,x.typeAnnotation||"coerce");else J=M(J,me,x.typeAnnotation||"coerce");else J=M(J,me,x.typeAnnotation||"assert")}if(!(J instanceof Ur)&&J.type.kind!=="resolvedImage"&&this._isConstant(J)){const me=new Pr;try{J=new Ur(J.type,J.evaluate(me))}catch(Ce){return this.error(Ce.message),null}}return J}return this.error(`Unknown expression "${q}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,x,M){const q=typeof h=="number"?this.path.concat(h):this.path,K=M?this.scope.concat(M):this.scope;return new Fa(this.registry,this._isConstant,q,x||null,K,this.errors)}error(h,...x){const M=`${this.key}${x.map(q=>`[${q}]`).join("")}`;this.errors.push(new fe(M,h))}checkSubtype(h,x){const M=ye(h,x);return M&&this.error(M),M}}class zo{constructor(h,x,M){this.type=ft,this.locale=M,this.caseSensitive=h,this.diacriticSensitive=x}static parse(h,x){if(h.length!==2)return x.error("Expected one argument.");const M=h[1];if(typeof M!="object"||Array.isArray(M))return x.error("Collator options argument must be an object.");const q=x.parse(M["case-sensitive"]!==void 0&&M["case-sensitive"],1,Qe);if(!q)return null;const K=x.parse(M["diacritic-sensitive"]!==void 0&&M["diacritic-sensitive"],1,Qe);if(!K)return null;let J=null;return M.locale&&(J=x.parse(M.locale,1,ze),!J)?null:new zo(q,K,J)}evaluate(h){return new qn(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}}const Oa=8192;function Ys(m,h){m[0]=Math.min(m[0],h[0]),m[1]=Math.min(m[1],h[1]),m[2]=Math.max(m[2],h[0]),m[3]=Math.max(m[3],h[1])}function Zn(m,h){return!(m[0]<=h[0]||m[2]>=h[2]||m[1]<=h[1]||m[3]>=h[3])}function aa(m,h){const x=(180+m[0])/360,M=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m[1]*Math.PI/360)))/360,q=Math.pow(2,h.z);return[Math.round(x*q*Oa),Math.round(M*q*Oa)]}function ls(m,h,x){const M=m[0]-h[0],q=m[1]-h[1],K=m[0]-x[0],J=m[1]-x[1];return M*J-K*q==0&&M*K<=0&&q*J<=0}function Na(m,h){let x=!1;for(let J=0,me=h.length;J<me;J++){const Ce=h[J];for(let Oe=0,f=Ce.length;Oe<f-1;Oe++){if(ls(m,Ce[Oe],Ce[Oe+1]))return!1;(q=Ce[Oe])[1]>(M=m)[1]!=(K=Ce[Oe+1])[1]>M[1]&&M[0]<(K[0]-q[0])*(M[1]-q[1])/(K[1]-q[1])+q[0]&&(x=!x)}}var M,q,K;return x}function al(m,h){for(let x=0;x<h.length;x++)if(Na(m,h[x]))return!0;return!1}function ol(m,h,x,M){const q=M[0]-x[0],K=M[1]-x[1],J=(m[0]-x[0])*K-q*(m[1]-x[1]),me=(h[0]-x[0])*K-q*(h[1]-x[1]);return J>0&&me<0||J<0&&me>0}function to(m,h,x){for(const Oe of x)for(let f=0;f<Oe.length-1;++f)if((me=[(J=Oe[f+1])[0]-(K=Oe[f])[0],J[1]-K[1]])[0]*(Ce=[(q=h)[0]-(M=m)[0],q[1]-M[1]])[1]-me[1]*Ce[0]!=0&&ol(M,q,K,J)&&ol(K,J,M,q))return!0;var M,q,K,J,me,Ce;return!1}function Va(m,h){for(let x=0;x<m.length;++x)if(!Na(m[x],h))return!1;for(let x=0;x<m.length-1;++x)if(to(m[x],m[x+1],h))return!1;return!0}function N(m,h){for(let x=0;x<h.length;x++)if(Va(m,h[x]))return!0;return!1}function xe(m,h,x){const M=[];for(let q=0;q<m.length;q++){const K=[];for(let J=0;J<m[q].length;J++){const me=aa(m[q][J],x);Ys(h,me),K.push(me)}M.push(K)}return M}function it(m,h,x){const M=[];for(let q=0;q<m.length;q++){const K=xe(m[q],h,x);M.push(K)}return M}function It(m,h,x,M){if(m[0]<x[0]||m[0]>x[2]){const q=.5*M;let K=m[0]-x[0]>q?-M:x[0]-m[0]>q?M:0;K===0&&(K=m[0]-x[2]>q?-M:x[2]-m[0]>q?M:0),m[0]+=K}Ys(h,m)}function Wt(m,h,x,M){const q=Math.pow(2,M.z)*Oa,K=[M.x*Oa,M.y*Oa],J=[];for(const me of m)for(const Ce of me){const Oe=[Ce.x+K[0],Ce.y+K[1]];It(Oe,h,x,q),J.push(Oe)}return J}function Ii(m,h,x,M){const q=Math.pow(2,M.z)*Oa,K=[M.x*Oa,M.y*Oa],J=[];for(const Ce of m){const Oe=[];for(const f of Ce){const u=[f.x+K[0],f.y+K[1]];Ys(h,u),Oe.push(u)}J.push(Oe)}if(h[2]-h[0]<=q/2){(me=h)[0]=me[1]=1/0,me[2]=me[3]=-1/0;for(const Ce of J)for(const Oe of Ce)It(Oe,h,x,q)}var me;return J}class Li{constructor(h,x){this.type=Qe,this.geojson=h,this.geometries=x}static parse(h,x){if(h.length!==2)return x.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(Tn(h[1])){const M=h[1];if(M.type==="FeatureCollection"){const q=[];for(const K of M.features){const{type:J,coordinates:me}=K.geometry;J==="Polygon"&&q.push(me),J==="MultiPolygon"&&q.push(...me)}if(q.length)return new Li(M,{type:"MultiPolygon",coordinates:q})}else if(M.type==="Feature"){const q=M.geometry.type;if(q==="Polygon"||q==="MultiPolygon")return new Li(M,M.geometry)}else if(M.type==="Polygon"||M.type==="MultiPolygon")return new Li(M,M)}return x.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(x,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=x.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=Wt(x.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Oe of Ce)if(!Na(Oe,me))return!1}if(M.type==="MultiPolygon"){const me=it(M.coordinates,K,J),Ce=Wt(x.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Oe of Ce)if(!al(Oe,me))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(x,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=x.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=Ii(x.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Oe of Ce)if(!Va(Oe,me))return!1}if(M.type==="MultiPolygon"){const me=it(M.coordinates,K,J),Ce=Ii(x.geometry(),q,K,J);if(!Zn(q,K))return!1;for(const Oe of Ce)if(!N(Oe,me))return!1}return!0}(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class cn{constructor(h,x){this.type=x.type,this.name=h,this.boundExpression=x}static parse(h,x){if(h.length!==2||typeof h[1]!="string")return x.error("'var' expression requires exactly one string literal argument.");const M=h[1];return x.scope.has(M)?new cn(M,x.scope.get(M)):x.error(`Unknown variable "${M}". Make sure "${M}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}}class fn{constructor(h,x,M,q){this.name=h,this.type=x,this._evaluate=M,this.args=q}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}static parse(h,x){const M=h[0],q=fn.definitions[M];if(!q)return x.error(`Unknown expression "${M}". If you wanted a literal array, use ["literal", [...]].`,0);const K=Array.isArray(q)?q[0]:q.type,J=Array.isArray(q)?[[q[1],q[2]]]:q.overloads,me=J.filter(([Oe])=>!Array.isArray(Oe)||Oe.length===h.length-1);let Ce=null;for(const[Oe,f]of me){Ce=new Fa(x.registry,sr,x.path,null,x.scope);const u=[];let p=!1;for(let S=1;S<h.length;S++){const L=h[S],U=Array.isArray(Oe)?Oe[S-1]:Oe.type,Q=Ce.parse(L,1+u.length,U);if(!Q){p=!0;break}u.push(Q)}if(!p)if(Array.isArray(Oe)&&Oe.length!==u.length)Ce.error(`Expected ${Oe.length} arguments, but found ${u.length} instead.`);else{for(let S=0;S<u.length;S++){const L=Array.isArray(Oe)?Oe[S]:Oe.type,U=u[S];Ce.concat(S+1).checkSubtype(L,U.type)}if(Ce.errors.length===0)return new fn(M,K,f,u)}}if(me.length===1)x.errors.push(...Ce.errors);else{const Oe=(me.length?me:J).map(([u])=>{return p=u,Array.isArray(p)?`(${p.map(ie).join(", ")})`:`(${ie(p.type)}...)`;var p}).join(" | "),f=[];for(let u=1;u<h.length;u++){const p=x.parse(h[u],1+f.length);if(!p)return null;f.push(ie(p.type))}x.error(`Expected arguments of type ${Oe}, but found (${f.join(", ")}) instead.`)}return null}static register(h,x){fn.definitions=x;for(const M in x)h[M]=fn}}function sr(m){if(m instanceof cn)return sr(m.boundExpression);if(m instanceof fn&&m.name==="error"||m instanceof zo||m instanceof Li)return!1;const h=m instanceof Vs||m instanceof Lt;let x=!0;return m.eachChild(M=>{x=h?x&&sr(M):x&&M instanceof Ur}),!!x&&Ar(m)&&Ua(m,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ar(m){if(m instanceof fn&&(m.name==="get"&&m.args.length===1||m.name==="feature-state"||m.name==="has"&&m.args.length===1||m.name==="properties"||m.name==="geometry-type"||m.name==="id"||/^filter-/.test(m.name))||m instanceof Li)return!1;let h=!0;return m.eachChild(x=>{h&&!Ar(x)&&(h=!1)}),h}function Or(m){if(m instanceof fn&&m.name==="feature-state")return!1;let h=!0;return m.eachChild(x=>{h&&!Or(x)&&(h=!1)}),h}function Ua(m,h){if(m instanceof fn&&h.indexOf(m.name)>=0)return!1;let x=!0;return m.eachChild(M=>{x&&!Ua(M,h)&&(x=!1)}),x}function Ga(m,h){const x=m.length-1;let M,q,K=0,J=x,me=0;for(;K<=J;)if(me=Math.floor((K+J)/2),M=m[me],q=m[me+1],M<=h){if(me===x||h<q)return me;K=me+1}else{if(!(M>h))throw new Vt("Input is not a number.");J=me-1}return 0}class qa{constructor(h,x,M){this.type=h,this.input=x,this.labels=[],this.outputs=[];for(const[q,K]of M)this.labels.push(q),this.outputs.push(K)}static parse(h,x){if(h.length-1<4)return x.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return x.error("Expected an even number of arguments.");const M=x.parse(h[1],1,Ee);if(!M)return null;const q=[];let K=null;x.expectedType&&x.expectedType.kind!=="value"&&(K=x.expectedType);for(let J=1;J<h.length;J+=2){const me=J===1?-1/0:h[J],Ce=h[J+1],Oe=J,f=J+1;if(typeof me!="number")return x.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Oe);if(q.length&&q[q.length-1][0]>=me)return x.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Oe);const u=x.parse(Ce,f,K);if(!u)return null;K=K||u.type,q.push([me,u])}return new qa(K,M,q)}evaluate(h){const x=this.labels,M=this.outputs;if(x.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=x[0])return M[0].evaluate(h);const K=x.length;return q>=x[K-1]?M[K-1].evaluate(h):M[Ga(x,q)].evaluate(h)}eachChild(h){h(this.input);for(const x of this.outputs)h(x)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function pl(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var Gr=nr;function nr(m,h,x,M){this.cx=3*m,this.bx=3*(x-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=x,this.p2y=M}nr.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var x=m,M=0;M<8;M++){var q=this.sampleCurveX(x)-m;if(Math.abs(q)<h)return x;var K=this.sampleCurveDerivativeX(x);if(Math.abs(K)<1e-6)break;x-=q/K}var J=0,me=1;for(x=m,M=0;M<20&&(q=this.sampleCurveX(x),!(Math.abs(q-m)<h));M++)m>q?J=x:me=x,x=.5*(me-J)+J;return x},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var wr=pl(Gr);function Dr(m,h,x){return m+x*(h-m)}function js(m,h,x){return m.map((M,q)=>Dr(M,h[q],x))}const vr={number:Dr,color:function(m,h,x,M="rgb"){switch(M){case"rgb":{const[q,K,J,me]=js(m.rgb,h.rgb,x);return new mn(q,K,J,me,!1)}case"hcl":{const[q,K,J,me]=m.hcl,[Ce,Oe,f,u]=h.hcl;let p,S;if(isNaN(q)||isNaN(Ce))isNaN(q)?isNaN(Ce)?p=NaN:(p=Ce,J!==1&&J!==0||(S=Oe)):(p=q,f!==1&&f!==0||(S=K));else{let Ae=Ce-q;Ce>q&&Ae>180?Ae-=360:Ce<q&&q-Ce>180&&(Ae+=360),p=q+x*Ae}const[L,U,Q,re]=function([Ae,_e,Le,qe]){return Ae=isNaN(Ae)?0:Ae*kt,Jt([Le,Math.cos(Ae)*_e,Math.sin(Ae)*_e,qe])}([p,S??Dr(K,Oe,x),Dr(J,f,x),Dr(me,u,x)]);return new mn(L,U,Q,re,!1)}case"lab":{const[q,K,J,me]=Jt(js(m.lab,h.lab,x));return new mn(q,K,J,me,!1)}}},array:js,padding:function(m,h,x){return new ur(js(m.values,h.values,x))},variableAnchorOffsetCollection:function(m,h,x){const M=m.values,q=h.values;if(M.length!==q.length)throw new Vt(`Cannot interpolate values of different length. from: ${m.toString()}, to: ${h.toString()}`);const K=[];for(let J=0;J<M.length;J+=2){if(M[J]!==q[J])throw new Vt(`Cannot interpolate values containing mismatched anchors. from[${J}]: ${M[J]}, to[${J}]: ${q[J]}`);K.push(M[J]);const[me,Ce]=M[J+1],[Oe,f]=q[J+1];K.push([Dr(me,Oe,x),Dr(Ce,f,x)])}return new Qt(K)}};class Ks{constructor(h,x,M,q,K){this.type=h,this.operator=x,this.interpolation=M,this.input=q,this.labels=[],this.outputs=[];for(const[J,me]of K)this.labels.push(J),this.outputs.push(me)}static interpolationFactor(h,x,M,q){let K=0;if(h.name==="exponential")K=Lr(x,h.base,M,q);else if(h.name==="linear")K=Lr(x,1,M,q);else if(h.name==="cubic-bezier"){const J=h.controlPoints;K=new wr(J[0],J[1],J[2],J[3]).solve(Lr(x,1,M,q))}return K}static parse(h,x){let[M,q,K,...J]=h;if(!Array.isArray(q)||q.length===0)return x.error("Expected an interpolation type expression.",1);if(q[0]==="linear")q={name:"linear"};else if(q[0]==="exponential"){const Oe=q[1];if(typeof Oe!="number")return x.error("Exponential interpolation requires a numeric base.",1,1);q={name:"exponential",base:Oe}}else{if(q[0]!=="cubic-bezier")return x.error(`Unknown interpolation type ${String(q[0])}`,1,0);{const Oe=q.slice(1);if(Oe.length!==4||Oe.some(f=>typeof f!="number"||f<0||f>1))return x.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);q={name:"cubic-bezier",controlPoints:Oe}}}if(h.length-1<4)return x.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return x.error("Expected an even number of arguments.");if(K=x.parse(K,2,Ee),!K)return null;const me=[];let Ce=null;M==="interpolate-hcl"||M==="interpolate-lab"?Ce=He:x.expectedType&&x.expectedType.kind!=="value"&&(Ce=x.expectedType);for(let Oe=0;Oe<J.length;Oe+=2){const f=J[Oe],u=J[Oe+1],p=Oe+3,S=Oe+4;if(typeof f!="number")return x.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(me.length&&me[me.length-1][0]>=f)return x.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);const L=x.parse(u,S,Ce);if(!L)return null;Ce=Ce||L.type,me.push([f,L])}return Fe(Ce,Ee)||Fe(Ce,He)||Fe(Ce,Me)||Fe(Ce,ne)||Fe(Ce,X(Ee))?new Ks(Ce,M,q,K,me):x.error(`Type ${ie(Ce)} is not interpolatable.`)}evaluate(h){const x=this.labels,M=this.outputs;if(x.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=x[0])return M[0].evaluate(h);const K=x.length;if(q>=x[K-1])return M[K-1].evaluate(h);const J=Ga(x,q),me=Ks.interpolationFactor(this.interpolation,q,x[J],x[J+1]),Ce=M[J].evaluate(h),Oe=M[J+1].evaluate(h);switch(this.operator){case"interpolate":return vr[this.type.kind](Ce,Oe,me);case"interpolate-hcl":return vr.color(Ce,Oe,me,"hcl");case"interpolate-lab":return vr.color(Ce,Oe,me,"lab")}}eachChild(h){h(this.input);for(const x of this.outputs)h(x)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function Lr(m,h,x,M){const q=M-x,K=m-x;return q===0?0:h===1?K/q:(Math.pow(h,K)-1)/(Math.pow(h,q)-1)}class So{constructor(h,x){this.type=h,this.args=x}static parse(h,x){if(h.length<2)return x.error("Expectected at least one argument.");let M=null;const q=x.expectedType;q&&q.kind!=="value"&&(M=q);const K=[];for(const me of h.slice(1)){const Ce=x.parse(me,1+K.length,M,void 0,{typeAnnotation:"omit"});if(!Ce)return null;M=M||Ce.type,K.push(Ce)}if(!M)throw new Error("No output type");const J=q&&K.some(me=>ye(q,me.type));return new So(J?Ve:M,K)}evaluate(h){let x,M=null,q=0;for(const K of this.args)if(q++,M=K.evaluate(h),M&&M instanceof Yi&&!M.available&&(x||(x=M.name),M=null,q===this.args.length&&(M=x)),M!==null)break;return M}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}class Zo{constructor(h,x){this.type=x.type,this.bindings=[].concat(h),this.result=x}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const x of this.bindings)h(x[1]);h(this.result)}static parse(h,x){if(h.length<4)return x.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const M=[];for(let K=1;K<h.length-1;K+=2){const J=h[K];if(typeof J!="string")return x.error(`Expected string, but found ${typeof J} instead.`,K);if(/[^a-zA-Z0-9_]/.test(J))return x.error("Variable names must contain only alphanumeric characters or '_'.",K);const me=x.parse(h[K+1],K+1);if(!me)return null;M.push([J,me])}const q=x.parse(h[h.length-1],h.length-1,x.expectedType,M);return q?new Zo(M,q):null}outputDefined(){return this.result.outputDefined()}}class Ls{constructor(h,x,M){this.type=h,this.index=x,this.input=M}static parse(h,x){if(h.length!==3)return x.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ee),q=x.parse(h[2],2,X(x.expectedType||Ve));return M&&q?new Ls(q.type.itemType,M,q):null}evaluate(h){const x=this.index.evaluate(h),M=this.input.evaluate(h);if(x<0)throw new Vt(`Array index out of bounds: ${x} < 0.`);if(x>=M.length)throw new Vt(`Array index out of bounds: ${x} > ${M.length-1}.`);if(x!==Math.floor(x))throw new Vt(`Array index must be an integer, but found ${x} instead.`);return M[x]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}}class Il{constructor(h,x){this.type=Qe,this.needle=h,this.haystack=x}static parse(h,x){if(h.length!==3)return x.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ve),q=x.parse(h[2],2,Ve);return M&&q?ge(M.type,[Qe,ze,Ee,Ie,Ve])?new Il(M,q):x.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`):null}evaluate(h){const x=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!M)return!1;if(!Pe(x,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(cr(x))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(cr(M))} instead.`);return M.indexOf(x)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}}class Ao{constructor(h,x,M){this.type=Ee,this.needle=h,this.haystack=x,this.fromIndex=M}static parse(h,x){if(h.length<=2||h.length>=5)return x.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ve),q=x.parse(h[2],2,Ve);if(!M||!q)return null;if(!ge(M.type,[Qe,ze,Ee,Ie,Ve]))return x.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`);if(h.length===4){const K=x.parse(h[3],3,Ee);return K?new Ao(M,q,K):null}return new Ao(M,q)}evaluate(h){const x=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!Pe(x,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(cr(x))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(cr(M))} instead.`);if(this.fromIndex){const q=this.fromIndex.evaluate(h);return M.indexOf(x,q)}return M.indexOf(x)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}}class Qo{constructor(h,x,M,q,K,J){this.inputType=h,this.type=x,this.input=M,this.cases=q,this.outputs=K,this.otherwise=J}static parse(h,x){if(h.length<5)return x.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return x.error("Expected an even number of arguments.");let M,q;x.expectedType&&x.expectedType.kind!=="value"&&(q=x.expectedType);const K={},J=[];for(let Oe=2;Oe<h.length-1;Oe+=2){let f=h[Oe];const u=h[Oe+1];Array.isArray(f)||(f=[f]);const p=x.concat(Oe);if(f.length===0)return p.error("Expected at least one branch label.");for(const L of f){if(typeof L!="number"&&typeof L!="string")return p.error("Branch labels must be numbers or strings.");if(typeof L=="number"&&Math.abs(L)>Number.MAX_SAFE_INTEGER)return p.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof L=="number"&&Math.floor(L)!==L)return p.error("Numeric branch labels must be integer values.");if(M){if(p.checkSubtype(M,cr(L)))return null}else M=cr(L);if(K[String(L)]!==void 0)return p.error("Branch labels must be unique.");K[String(L)]=J.length}const S=x.parse(u,Oe,q);if(!S)return null;q=q||S.type,J.push(S)}const me=x.parse(h[1],1,Ve);if(!me)return null;const Ce=x.parse(h[h.length-1],h.length-1,q);return Ce?me.type.kind!=="value"&&x.concat(1).checkSubtype(M,me.type)?null:new Qo(M,q,me,K,J,Ce):null}evaluate(h){const x=this.input.evaluate(h);return(cr(x)===this.inputType&&this.outputs[this.cases[x]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every(h=>h.outputDefined())&&this.otherwise.outputDefined()}}class ca{constructor(h,x,M){this.type=h,this.branches=x,this.otherwise=M}static parse(h,x){if(h.length<4)return x.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return x.error("Expected an odd number of arguments.");let M;x.expectedType&&x.expectedType.kind!=="value"&&(M=x.expectedType);const q=[];for(let J=1;J<h.length-1;J+=2){const me=x.parse(h[J],J,Qe);if(!me)return null;const Ce=x.parse(h[J+1],J+1,M);if(!Ce)return null;q.push([me,Ce]),M=M||Ce.type}const K=x.parse(h[h.length-1],h.length-1,M);if(!K)return null;if(!M)throw new Error("Can't infer output type");return new ca(M,q,K)}evaluate(h){for(const[x,M]of this.branches)if(x.evaluate(h))return M.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[x,M]of this.branches)h(x),h(M);h(this.otherwise)}outputDefined(){return this.branches.every(([h,x])=>x.outputDefined())&&this.otherwise.outputDefined()}}class $s{constructor(h,x,M,q){this.type=h,this.input=x,this.beginIndex=M,this.endIndex=q}static parse(h,x){if(h.length<=2||h.length>=5)return x.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ve),q=x.parse(h[2],2,Ee);if(!M||!q)return null;if(!ge(M.type,[X(Ve),ze,Ve]))return x.error(`Expected first argument to be of type array or string, but found ${ie(M.type)} instead`);if(h.length===4){const K=x.parse(h[3],3,Ee);return K?new $s(M.type,M,q,K):null}return new $s(M.type,M,q)}evaluate(h){const x=this.input.evaluate(h),M=this.beginIndex.evaluate(h);if(!Pe(x,["string","array"]))throw new Vt(`Expected first argument to be of type array or string, but found ${ie(cr(x))} instead.`);if(this.endIndex){const q=this.endIndex.evaluate(h);return x.slice(M,q)}return x.slice(M)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}}function El(m,h){return m==="=="||m==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function Ha(m,h,x,M){return M.compare(h,x)===0}function Ta(m,h,x){const M=m!=="=="&&m!=="!=";return class f3{constructor(K,J,me){this.type=Qe,this.lhs=K,this.rhs=J,this.collator=me,this.hasUntypedArgument=K.type.kind==="value"||J.type.kind==="value"}static parse(K,J){if(K.length!==3&&K.length!==4)return J.error("Expected two or three arguments.");const me=K[0];let Ce=J.parse(K[1],1,Ve);if(!Ce)return null;if(!El(me,Ce.type))return J.concat(1).error(`"${me}" comparisons are not supported for type '${ie(Ce.type)}'.`);let Oe=J.parse(K[2],2,Ve);if(!Oe)return null;if(!El(me,Oe.type))return J.concat(2).error(`"${me}" comparisons are not supported for type '${ie(Oe.type)}'.`);if(Ce.type.kind!==Oe.type.kind&&Ce.type.kind!=="value"&&Oe.type.kind!=="value")return J.error(`Cannot compare types '${ie(Ce.type)}' and '${ie(Oe.type)}'.`);M&&(Ce.type.kind==="value"&&Oe.type.kind!=="value"?Ce=new Lt(Oe.type,[Ce]):Ce.type.kind!=="value"&&Oe.type.kind==="value"&&(Oe=new Lt(Ce.type,[Oe])));let f=null;if(K.length===4){if(Ce.type.kind!=="string"&&Oe.type.kind!=="string"&&Ce.type.kind!=="value"&&Oe.type.kind!=="value")return J.error("Cannot use collator to compare non-string types.");if(f=J.parse(K[3],3,ft),!f)return null}return new f3(Ce,Oe,f)}evaluate(K){const J=this.lhs.evaluate(K),me=this.rhs.evaluate(K);if(M&&this.hasUntypedArgument){const Ce=cr(J),Oe=cr(me);if(Ce.kind!==Oe.kind||Ce.kind!=="string"&&Ce.kind!=="number")throw new Vt(`Expected arguments for "${m}" to be (string, string) or (number, number), but found (${Ce.kind}, ${Oe.kind}) instead.`)}if(this.collator&&!M&&this.hasUntypedArgument){const Ce=cr(J),Oe=cr(me);if(Ce.kind!=="string"||Oe.kind!=="string")return h(K,J,me)}return this.collator?x(K,J,me,this.collator.evaluate(K)):h(K,J,me)}eachChild(K){K(this.lhs),K(this.rhs),this.collator&&K(this.collator)}outputDefined(){return!0}}}const ml=Ta("==",function(m,h,x){return h===x},Ha),Cl=Ta("!=",function(m,h,x){return h!==x},function(m,h,x,M){return!Ha(0,h,x,M)}),mu=Ta("<",function(m,h,x){return h<x},function(m,h,x,M){return M.compare(h,x)<0}),us=Ta(">",function(m,h,x){return h>x},function(m,h,x,M){return M.compare(h,x)>0}),rc=Ta("<=",function(m,h,x){return h<=x},function(m,h,x,M){return M.compare(h,x)<=0}),io=Ta(">=",function(m,h,x){return h>=x},function(m,h,x,M){return M.compare(h,x)>=0});class no{constructor(h,x,M,q,K){this.type=ze,this.number=h,this.locale=x,this.currency=M,this.minFractionDigits=q,this.maxFractionDigits=K}static parse(h,x){if(h.length!==3)return x.error("Expected two arguments.");const M=x.parse(h[1],1,Ee);if(!M)return null;const q=h[2];if(typeof q!="object"||Array.isArray(q))return x.error("NumberFormat options argument must be an object.");let K=null;if(q.locale&&(K=x.parse(q.locale,1,ze),!K))return null;let J=null;if(q.currency&&(J=x.parse(q.currency,1,ze),!J))return null;let me=null;if(q["min-fraction-digits"]&&(me=x.parse(q["min-fraction-digits"],1,Ee),!me))return null;let Ce=null;return q["max-fraction-digits"]&&(Ce=x.parse(q["max-fraction-digits"],1,Ee),!Ce)?null:new no(M,K,J,me,Ce)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}}class ql{constructor(h){this.type=nt,this.sections=h}static parse(h,x){if(h.length<2)return x.error("Expected at least one argument.");const M=h[1];if(!Array.isArray(M)&&typeof M=="object")return x.error("First argument must be an image or text section.");const q=[];let K=!1;for(let J=1;J<=h.length-1;++J){const me=h[J];if(K&&typeof me=="object"&&!Array.isArray(me)){K=!1;let Ce=null;if(me["font-scale"]&&(Ce=x.parse(me["font-scale"],1,Ee),!Ce))return null;let Oe=null;if(me["text-font"]&&(Oe=x.parse(me["text-font"],1,X(ze)),!Oe))return null;let f=null;if(me["text-color"]&&(f=x.parse(me["text-color"],1,He),!f))return null;const u=q[q.length-1];u.scale=Ce,u.font=Oe,u.textColor=f}else{const Ce=x.parse(h[J],1,Ve);if(!Ce)return null;const Oe=Ce.type.kind;if(Oe!=="string"&&Oe!=="value"&&Oe!=="null"&&Oe!=="resolvedImage")return x.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");K=!0,q.push({content:Ce,scale:null,font:null,textColor:null})}}return new ql(q)}evaluate(h){return new Hi(this.sections.map(x=>{const M=x.content.evaluate(h);return cr(M)===se?new jr("",M,null,null,null):new jr(Ns(M),null,x.scale?x.scale.evaluate(h):null,x.font?x.font.evaluate(h).join(","):null,x.textColor?x.textColor.evaluate(h):null)}))}eachChild(h){for(const x of this.sections)h(x.content),x.scale&&h(x.scale),x.font&&h(x.font),x.textColor&&h(x.textColor)}outputDefined(){return!1}}class Ro{constructor(h){this.type=se,this.input=h}static parse(h,x){if(h.length!==2)return x.error("Expected two arguments.");const M=x.parse(h[1],1,ze);return M?new Ro(M):x.error("No image name provided.")}evaluate(h){const x=this.input.evaluate(h),M=Yi.fromString(x);return M&&h.availableImages&&(M.available=h.availableImages.indexOf(x)>-1),M}eachChild(h){h(this.input)}outputDefined(){return!1}}class Wo{constructor(h){this.type=Ee,this.input=h}static parse(h,x){if(h.length!==2)return x.error(`Expected 1 argument, but found ${h.length-1} instead.`);const M=x.parse(h[1],1);return M?M.type.kind!=="array"&&M.type.kind!=="string"&&M.type.kind!=="value"?x.error(`Expected argument of type string or array, but found ${ie(M.type)} instead.`):new Wo(M):null}evaluate(h){const x=this.input.evaluate(h);if(typeof x=="string"||Array.isArray(x))return x.length;throw new Vt(`Expected value to be of type string or array, but found ${ie(cr(x))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}}const Io={"==":ml,"!=":Cl,">":us,"<":mu,">=":io,"<=":rc,array:Lt,at:Ls,boolean:Lt,case:ca,coalesce:So,collator:zo,format:ql,image:Ro,in:Il,"index-of":Ao,interpolate:Ks,"interpolate-hcl":Ks,"interpolate-lab":Ks,length:Wo,let:Zo,literal:Ur,match:Qo,number:Lt,"number-format":no,object:Lt,slice:$s,step:qa,string:Lt,"to-boolean":Vs,"to-color":Vs,"to-number":Vs,"to-string":Vs,var:cn,within:Li};function Us(m,[h,x,M,q]){h=h.evaluate(m),x=x.evaluate(m),M=M.evaluate(m);const K=q?q.evaluate(m):1,J=Ut(h,x,M,K);if(J)throw new Vt(J);return new mn(h/255,x/255,M/255,K,!1)}function Xo(m,h){return m in h}function Yo(m,h){const x=h[m];return x===void 0?null:x}function $o(m){return{type:m}}function ba(m){return{result:"success",value:m}}function ja(m){return{result:"error",value:m}}function Cs(m){return m["property-type"]==="data-driven"||m["property-type"]==="cross-faded-data-driven"}function gu(m){return!!m.expression&&m.expression.parameters.indexOf("zoom")>-1}function Sr(m){return!!m.expression&&m.expression.interpolated}function Xn(m){return m instanceof Number?"number":m instanceof String?"string":m instanceof Boolean?"boolean":Array.isArray(m)?"array":m===null?"null":typeof m}function Ko(m){return typeof m=="object"&&m!==null&&!Array.isArray(m)}function Br(m){return m}function Za(m,h){const x=h.type==="color",M=m.stops&&typeof m.stops[0][0]=="object",q=M||!(M||m.property!==void 0),K=m.type||(Sr(h)?"exponential":"interval");if(x||h.type==="padding"){const f=x?mn.parse:ur.parse;(m=te({},m)).stops&&(m.stops=m.stops.map(u=>[u[0],f(u[1])])),m.default=f(m.default?m.default:h.default)}if(m.colorSpace&&(J=m.colorSpace)!=="rgb"&&J!=="hcl"&&J!=="lab")throw new Error(`Unknown color space: "${m.colorSpace}"`);var J;let me,Ce,Oe;if(K==="exponential")me=Un;else if(K==="interval")me=Eo;else if(K==="categorical"){me=fr,Ce=Object.create(null);for(const f of m.stops)Ce[f[0]]=f[1];Oe=typeof m.stops[0][0]}else{if(K!=="identity")throw new Error(`Unknown function type "${K}"`);me=Ol}if(M){const f={},u=[];for(let L=0;L<m.stops.length;L++){const U=m.stops[L],Q=U[0].zoom;f[Q]===void 0&&(f[Q]={zoom:Q,type:m.type,property:m.property,default:m.default,stops:[]},u.push(Q)),f[Q].stops.push([U[0].value,U[1]])}const p=[];for(const L of u)p.push([f[L].zoom,Za(f[L],h)]);const S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:Ks.interpolationFactor.bind(void 0,S),zoomStops:p.map(L=>L[0]),evaluate:({zoom:L},U)=>Un({stops:p,base:m.base},h,L).evaluate(L,U)}}if(q){const f=K==="exponential"?{name:"exponential",base:m.base!==void 0?m.base:1}:null;return{kind:"camera",interpolationType:f,interpolationFactor:Ks.interpolationFactor.bind(void 0,f),zoomStops:m.stops.map(u=>u[0]),evaluate:({zoom:u})=>me(m,h,u,Ce,Oe)}}return{kind:"source",evaluate(f,u){const p=u&&u.properties?u.properties[m.property]:void 0;return p===void 0?Jr(m.default,h.default):me(m,h,p,Ce,Oe)}}}function Jr(m,h,x){return m!==void 0?m:h!==void 0?h:x!==void 0?x:void 0}function fr(m,h,x,M,q){return Jr(typeof x===q?M[x]:void 0,m.default,h.default)}function Eo(m,h,x){if(Xn(x)!=="number")return Jr(m.default,h.default);const M=m.stops.length;if(M===1||x<=m.stops[0][0])return m.stops[0][1];if(x>=m.stops[M-1][0])return m.stops[M-1][1];const q=Ga(m.stops.map(K=>K[0]),x);return m.stops[q][1]}function Un(m,h,x){const M=m.base!==void 0?m.base:1;if(Xn(x)!=="number")return Jr(m.default,h.default);const q=m.stops.length;if(q===1||x<=m.stops[0][0])return m.stops[0][1];if(x>=m.stops[q-1][0])return m.stops[q-1][1];const K=Ga(m.stops.map(f=>f[0]),x),J=function(f,u,p,S){const L=S-p,U=f-p;return L===0?0:u===1?U/L:(Math.pow(u,U)-1)/(Math.pow(u,L)-1)}(x,M,m.stops[K][0],m.stops[K+1][0]),me=m.stops[K][1],Ce=m.stops[K+1][1],Oe=vr[h.type]||Br;return typeof me.evaluate=="function"?{evaluate(...f){const u=me.evaluate.apply(void 0,f),p=Ce.evaluate.apply(void 0,f);if(u!==void 0&&p!==void 0)return Oe(u,p,J,m.colorSpace)}}:Oe(me,Ce,J,m.colorSpace)}function Ol(m,h,x){switch(h.type){case"color":x=mn.parse(x);break;case"formatted":x=Hi.fromString(x.toString());break;case"resolvedImage":x=Yi.fromString(x.toString());break;case"padding":x=ur.parse(x);break;default:Xn(x)===h.type||h.type==="enum"&&h.values[x]||(x=void 0)}return Jr(x,m.default,h.default)}fn.register(Io,{error:[{kind:"error"},[ze],(m,[h])=>{throw new Vt(h.evaluate(m))}],typeof:[ze,[Ve],(m,[h])=>ie(cr(h.evaluate(m)))],"to-rgba":[X(Ee,4),[He],(m,[h])=>{const[x,M,q,K]=h.evaluate(m).rgb;return[255*x,255*M,255*q,K]}],rgb:[He,[Ee,Ee,Ee],Us],rgba:[He,[Ee,Ee,Ee,Ee],Us],has:{type:Qe,overloads:[[[ze],(m,[h])=>Xo(h.evaluate(m),m.properties())],[[ze,Ze],(m,[h,x])=>Xo(h.evaluate(m),x.evaluate(m))]]},get:{type:Ve,overloads:[[[ze],(m,[h])=>Yo(h.evaluate(m),m.properties())],[[ze,Ze],(m,[h,x])=>Yo(h.evaluate(m),x.evaluate(m))]]},"feature-state":[Ve,[ze],(m,[h])=>Yo(h.evaluate(m),m.featureState||{})],properties:[Ze,[],m=>m.properties()],"geometry-type":[ze,[],m=>m.geometryType()],id:[Ve,[],m=>m.id()],zoom:[Ee,[],m=>m.globals.zoom],"heatmap-density":[Ee,[],m=>m.globals.heatmapDensity||0],"line-progress":[Ee,[],m=>m.globals.lineProgress||0],accumulated:[Ve,[],m=>m.globals.accumulated===void 0?null:m.globals.accumulated],"+":[Ee,$o(Ee),(m,h)=>{let x=0;for(const M of h)x+=M.evaluate(m);return x}],"*":[Ee,$o(Ee),(m,h)=>{let x=1;for(const M of h)x*=M.evaluate(m);return x}],"-":{type:Ee,overloads:[[[Ee,Ee],(m,[h,x])=>h.evaluate(m)-x.evaluate(m)],[[Ee],(m,[h])=>-h.evaluate(m)]]},"/":[Ee,[Ee,Ee],(m,[h,x])=>h.evaluate(m)/x.evaluate(m)],"%":[Ee,[Ee,Ee],(m,[h,x])=>h.evaluate(m)%x.evaluate(m)],ln2:[Ee,[],()=>Math.LN2],pi:[Ee,[],()=>Math.PI],e:[Ee,[],()=>Math.E],"^":[Ee,[Ee,Ee],(m,[h,x])=>Math.pow(h.evaluate(m),x.evaluate(m))],sqrt:[Ee,[Ee],(m,[h])=>Math.sqrt(h.evaluate(m))],log10:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN10],ln:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))],log2:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN2],sin:[Ee,[Ee],(m,[h])=>Math.sin(h.evaluate(m))],cos:[Ee,[Ee],(m,[h])=>Math.cos(h.evaluate(m))],tan:[Ee,[Ee],(m,[h])=>Math.tan(h.evaluate(m))],asin:[Ee,[Ee],(m,[h])=>Math.asin(h.evaluate(m))],acos:[Ee,[Ee],(m,[h])=>Math.acos(h.evaluate(m))],atan:[Ee,[Ee],(m,[h])=>Math.atan(h.evaluate(m))],min:[Ee,$o(Ee),(m,h)=>Math.min(...h.map(x=>x.evaluate(m)))],max:[Ee,$o(Ee),(m,h)=>Math.max(...h.map(x=>x.evaluate(m)))],abs:[Ee,[Ee],(m,[h])=>Math.abs(h.evaluate(m))],round:[Ee,[Ee],(m,[h])=>{const x=h.evaluate(m);return x<0?-Math.round(-x):Math.round(x)}],floor:[Ee,[Ee],(m,[h])=>Math.floor(h.evaluate(m))],ceil:[Ee,[Ee],(m,[h])=>Math.ceil(h.evaluate(m))],"filter-==":[Qe,[ze,Ve],(m,[h,x])=>m.properties()[h.value]===x.value],"filter-id-==":[Qe,[Ve],(m,[h])=>m.id()===h.value],"filter-type-==":[Qe,[ze],(m,[h])=>m.geometryType()===h.value],"filter-<":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M<q}],"filter-id-<":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x<M}],"filter->":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M>q}],"filter-id->":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x>M}],"filter-<=":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M<=q}],"filter-id-<=":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x<=M}],"filter->=":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M>=q}],"filter-id->=":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x>=M}],"filter-has":[Qe,[Ve],(m,[h])=>h.value in m.properties()],"filter-has-id":[Qe,[],m=>m.id()!==null&&m.id()!==void 0],"filter-type-in":[Qe,[X(ze)],(m,[h])=>h.value.indexOf(m.geometryType())>=0],"filter-id-in":[Qe,[X(Ve)],(m,[h])=>h.value.indexOf(m.id())>=0],"filter-in-small":[Qe,[ze,X(Ve)],(m,[h,x])=>x.value.indexOf(m.properties()[h.value])>=0],"filter-in-large":[Qe,[ze,X(Ve)],(m,[h,x])=>function(M,q,K,J){for(;K<=J;){const me=K+J>>1;if(q[me]===M)return!0;q[me]>M?J=me-1:K=me+1}return!1}(m.properties()[h.value],x.value,0,x.value.length-1)],all:{type:Qe,overloads:[[[Qe,Qe],(m,[h,x])=>h.evaluate(m)&&x.evaluate(m)],[$o(Qe),(m,h)=>{for(const x of h)if(!x.evaluate(m))return!1;return!0}]]},any:{type:Qe,overloads:[[[Qe,Qe],(m,[h,x])=>h.evaluate(m)||x.evaluate(m)],[$o(Qe),(m,h)=>{for(const x of h)if(x.evaluate(m))return!0;return!1}]]},"!":[Qe,[Qe],(m,[h])=>!h.evaluate(m)],"is-supported-script":[Qe,[ze],(m,[h])=>{const x=m.globals&&m.globals.isSupportedScript;return!x||x(h.evaluate(m))}],upcase:[ze,[ze],(m,[h])=>h.evaluate(m).toUpperCase()],downcase:[ze,[ze],(m,[h])=>h.evaluate(m).toLowerCase()],concat:[ze,$o(Ve),(m,h)=>h.map(x=>Ns(x.evaluate(m))).join("")],"resolved-locale":[ze,[ft],(m,[h])=>h.evaluate(m).resolvedLocale()]});class es{constructor(h,x){var M;this.expression=h,this._warningHistory={},this._evaluator=new Pr,this._defaultValue=x?(M=x).type==="color"&&Ko(M.default)?new mn(0,0,0,0):M.type==="color"?mn.parse(M.default)||null:M.type==="padding"?ur.parse(M.default)||null:M.type==="variableAnchorOffsetCollection"?Qt.parse(M.default)||null:M.default===void 0?null:M.default:null,this._enumValues=x&&x.type==="enum"?x.values:null}evaluateWithoutErrorHandling(h,x,M,q,K,J){return this._evaluator.globals=h,this._evaluator.feature=x,this._evaluator.featureState=M,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J,this.expression.evaluate(this._evaluator)}evaluate(h,x,M,q,K,J){this._evaluator.globals=h,this._evaluator.feature=x||null,this._evaluator.featureState=M||null,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J||null;try{const me=this.expression.evaluate(this._evaluator);if(me==null||typeof me=="number"&&me!=me)return this._defaultValue;if(this._enumValues&&!(me in this._enumValues))throw new Vt(`Expected value to be one of ${Object.keys(this._enumValues).map(Ce=>JSON.stringify(Ce)).join(", ")}, but found ${JSON.stringify(me)} instead.`);return me}catch(me){return this._warningHistory[me.message]||(this._warningHistory[me.message]=!0,typeof console<"u"&&console.warn(me.message)),this._defaultValue}}}function Zr(m){return Array.isArray(m)&&m.length>0&&typeof m[0]=="string"&&m[0]in Io}function Ts(m,h){const x=new Fa(Io,sr,[],h?function(q){const K={color:He,string:ze,number:Ee,enum:ze,boolean:Qe,formatted:nt,padding:Me,resolvedImage:se,variableAnchorOffsetCollection:ne};return q.type==="array"?X(K[q.value]||Ve,q.length):K[q.type]}(h):void 0),M=x.parse(m,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return M?ba(new es(M,h)):ja(x.errors)}class kr{constructor(h,x){this.kind=h,this._styleExpression=x,this.isStateDependent=h!=="constant"&&!Or(x.expression)}evaluateWithoutErrorHandling(h,x,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,x,M,q,K,J)}evaluate(h,x,M,q,K,J){return this._styleExpression.evaluate(h,x,M,q,K,J)}}class rr{constructor(h,x,M,q){this.kind=h,this.zoomStops=M,this._styleExpression=x,this.isStateDependent=h!=="camera"&&!Or(x.expression),this.interpolationType=q}evaluateWithoutErrorHandling(h,x,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,x,M,q,K,J)}evaluate(h,x,M,q,K,J){return this._styleExpression.evaluate(h,x,M,q,K,J)}interpolationFactor(h,x,M){return this.interpolationType?Ks.interpolationFactor(this.interpolationType,h,x,M):0}}function ll(m,h){const x=Ts(m,h);if(x.result==="error")return x;const M=x.value.expression,q=Ar(M);if(!q&&!Cs(h))return ja([new fe("","data expressions not supported")]);const K=Ua(M,["zoom"]);if(!K&&!gu(h))return ja([new fe("","zoom expressions not supported")]);const J=Co(M);return J||K?J instanceof fe?ja([J]):J instanceof Ks&&!Sr(h)?ja([new fe("",'"interpolate" expressions cannot be used with this property')]):ba(J?new rr(q?"camera":"composite",x.value,J.labels,J instanceof Ks?J.interpolation:void 0):new kr(q?"constant":"source",x.value)):ja([new fe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Yr{constructor(h,x){this._parameters=h,this._specification=x,te(this,Za(this._parameters,this._specification))}static deserialize(h){return new Yr(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function Co(m){let h=null;if(m instanceof Zo)h=Co(m.result);else if(m instanceof So){for(const x of m.args)if(h=Co(x),h)break}else(m instanceof qa||m instanceof Ks)&&m.input instanceof fn&&m.input.name==="zoom"&&(h=m);return h instanceof fe||m.eachChild(x=>{const M=Co(x);M instanceof fe?h=M:!h&&M?h=new fe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&M&&h!==M&&(h=new fe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),h}function ul(m){if(m===!0||m===!1)return!0;if(!Array.isArray(m)||m.length===0)return!1;switch(m[0]){case"has":return m.length>=2&&m[1]!=="$id"&&m[1]!=="$type";case"in":return m.length>=3&&(typeof m[1]!="string"||Array.isArray(m[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return m.length!==3||Array.isArray(m[1])||Array.isArray(m[2]);case"any":case"all":for(const h of m.slice(1))if(!ul(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}const Qr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hs(m){if(m==null)return{filter:()=>!0,needGeometry:!1};ul(m)||(m=To(m));const h=Ts(m,Qr);if(h.result==="error")throw new Error(h.value.map(x=>`${x.key}: ${x.message}`).join(", "));return{filter:(x,M,q)=>h.value.evaluate(x,M,{},q),needGeometry:Tl(m)}}function wa(m,h){return m<h?-1:m>h?1:0}function Tl(m){if(!Array.isArray(m))return!1;if(m[0]==="within")return!0;for(let h=1;h<m.length;h++)if(Tl(m[h]))return!0;return!1}function To(m){if(!m)return!0;const h=m[0];return m.length<=1?h!=="any":h==="=="?kl(m[1],m[2],"=="):h==="!="?Gs(kl(m[1],m[2],"==")):h==="<"||h===">"||h==="<="||h===">="?kl(m[1],m[2],h):h==="any"?(x=m.slice(1),["any"].concat(x.map(To))):h==="all"?["all"].concat(m.slice(1).map(To)):h==="none"?["all"].concat(m.slice(1).map(To).map(Gs)):h==="in"?fo(m[1],m.slice(2)):h==="!in"?Gs(fo(m[1],m.slice(2))):h==="has"?Js(m[1]):h==="!has"?Gs(Js(m[1])):h!=="within"||m;var x}function kl(m,h,x){switch(m){case"$type":return[`filter-type-${x}`,h];case"$id":return[`filter-id-${x}`,h];default:return[`filter-${x}`,m,h]}}function fo(m,h){if(h.length===0)return!1;switch(m){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some(x=>typeof x!=typeof h[0])?["filter-in-large",m,["literal",h.sort(wa)]]:["filter-in-small",m,["literal",h]]}}function Js(m){switch(m){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",m]}}function Gs(m){return["!",m]}function Qa(m){const h=typeof m;if(h==="number"||h==="boolean"||h==="string"||m==null)return JSON.stringify(m);if(Array.isArray(m)){let q="[";for(const K of m)q+=`${Qa(K)},`;return`${q}]`}const x=Object.keys(m).sort();let M="{";for(let q=0;q<x.length;q++)M+=`${JSON.stringify(x[q])}:${Qa(m[x[q]])},`;return`${M}}`}function Jo(m){let h="";for(const x of wn)h+=`/${Qa(m[x])}`;return h}function $r(m){const h=m.value;return h?[new $(m.key,h,"constants have been deprecated as of v8")]:[]}function mr(m){return m instanceof Number||m instanceof String||m instanceof Boolean?m.valueOf():m}function Nr(m){if(Array.isArray(m))return m.map(Nr);if(m instanceof Object&&!(m instanceof Number||m instanceof String||m instanceof Boolean)){const h={};for(const x in m)h[x]=Nr(m[x]);return h}return mr(m)}function ha(m){const h=m.key,x=m.value,M=m.valueSpec||{},q=m.objectElementValidators||{},K=m.style,J=m.styleSpec,me=m.validateSpec;let Ce=[];const Oe=Xn(x);if(Oe!=="object")return[new $(h,x,`object expected, ${Oe} found`)];for(const f in x){const u=f.split(".")[0],p=M[u]||M["*"];let S;if(q[u])S=q[u];else if(M[u])S=me;else if(q["*"])S=q["*"];else{if(!M["*"]){Ce.push(new $(h,x[f],`unknown property "${f}"`));continue}S=me}Ce=Ce.concat(S({key:(h&&`${h}.`)+f,value:x[f],valueSpec:p,style:K,styleSpec:J,object:x,objectKey:f,validateSpec:me},x))}for(const f in M)q[f]||M[f].required&&M[f].default===void 0&&x[f]===void 0&&Ce.push(new $(h,x,`missing required property "${f}"`));return Ce}function po(m){const h=m.value,x=m.valueSpec,M=m.style,q=m.styleSpec,K=m.key,J=m.arrayElementValidator||m.validateSpec;if(Xn(h)!=="array")return[new $(K,h,`array expected, ${Xn(h)} found`)];if(x.length&&h.length!==x.length)return[new $(K,h,`array length ${x.length} expected, length ${h.length} found`)];if(x["min-length"]&&h.length<x["min-length"])return[new $(K,h,`array length at least ${x["min-length"]} expected, length ${h.length} found`)];let me={type:x.value,values:x.values};q.$version<7&&(me.function=x.function),Xn(x.value)==="object"&&(me=x.value);let Ce=[];for(let Oe=0;Oe<h.length;Oe++)Ce=Ce.concat(J({array:h,arrayIndex:Oe,value:h[Oe],valueSpec:me,validateSpec:m.validateSpec,style:M,styleSpec:q,key:`${K}[${Oe}]`}));return Ce}function ea(m){const h=m.key,x=m.value,M=m.valueSpec;let q=Xn(x);return q==="number"&&x!=x&&(q="NaN"),q!=="number"?[new $(h,x,`number expected, ${q} found`)]:"minimum"in M&&x<M.minimum?[new $(h,x,`${x} is less than the minimum value ${M.minimum}`)]:"maximum"in M&&x>M.maximum?[new $(h,x,`${x} is greater than the maximum value ${M.maximum}`)]:[]}function Sa(m){const h=m.valueSpec,x=mr(m.value.type);let M,q,K,J={};const me=x!=="categorical"&&m.value.property===void 0,Ce=!me,Oe=Xn(m.value.stops)==="array"&&Xn(m.value.stops[0])==="array"&&Xn(m.value.stops[0][0])==="object",f=ha({key:m.key,value:m.value,valueSpec:m.styleSpec.function,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(S){if(x==="identity")return[new $(S.key,S.value,'identity function may not have a "stops" property')];let L=[];const U=S.value;return L=L.concat(po({key:S.key,value:U,valueSpec:S.valueSpec,validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec,arrayElementValidator:u})),Xn(U)==="array"&&U.length===0&&L.push(new $(S.key,U,"array must have at least one stop")),L},default:function(S){return S.validateSpec({key:S.key,value:S.value,valueSpec:h,validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec})}}});return x==="identity"&&me&&f.push(new $(m.key,m.value,'missing required property "property"')),x==="identity"||m.value.stops||f.push(new $(m.key,m.value,'missing required property "stops"')),x==="exponential"&&m.valueSpec.expression&&!Sr(m.valueSpec)&&f.push(new $(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(Ce&&!Cs(m.valueSpec)?f.push(new $(m.key,m.value,"property functions not supported")):me&&!gu(m.valueSpec)&&f.push(new $(m.key,m.value,"zoom functions not supported"))),x!=="categorical"&&!Oe||m.value.property!==void 0||f.push(new $(m.key,m.value,'"property" property is required')),f;function u(S){let L=[];const U=S.value,Q=S.key;if(Xn(U)!=="array")return[new $(Q,U,`array expected, ${Xn(U)} found`)];if(U.length!==2)return[new $(Q,U,`array length 2 expected, length ${U.length} found`)];if(Oe){if(Xn(U[0])!=="object")return[new $(Q,U,`object expected, ${Xn(U[0])} found`)];if(U[0].zoom===void 0)return[new $(Q,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new $(Q,U,"object stop key must have value")];if(K&&K>mr(U[0].zoom))return[new $(Q,U[0].zoom,"stop zoom values must appear in ascending order")];mr(U[0].zoom)!==K&&(K=mr(U[0].zoom),q=void 0,J={}),L=L.concat(ha({key:`${Q}[0]`,value:U[0],valueSpec:{zoom:{}},validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{zoom:ea,value:p}}))}else L=L.concat(p({key:`${Q}[0]`,value:U[0],valueSpec:{},validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec},U));return Zr(Nr(U[1]))?L.concat([new $(`${Q}[1]`,U[1],"expressions are not allowed in function stops.")]):L.concat(S.validateSpec({key:`${Q}[1]`,value:U[1],valueSpec:h,validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec}))}function p(S,L){const U=Xn(S.value),Q=mr(S.value),re=S.value!==null?S.value:L;if(M){if(U!==M)return[new $(S.key,re,`${U} stop domain type must match previous stop domain type ${M}`)]}else M=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new $(S.key,re,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&x!=="categorical"){let Ae=`number expected, ${U} found`;return Cs(h)&&x===void 0&&(Ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $(S.key,re,Ae)]}return x!=="categorical"||U!=="number"||isFinite(Q)&&Math.floor(Q)===Q?x!=="categorical"&&U==="number"&&q!==void 0&&Q<q?[new $(S.key,re,"stop domain values must appear in ascending order")]:(q=Q,x==="categorical"&&Q in J?[new $(S.key,re,"stop domain values must be unique")]:(J[Q]=!0,[])):[new $(S.key,re,`integer expected, found ${Q}`)]}}function ka(m){const h=(m.expressionContext==="property"?ll:Ts)(Nr(m.value),m.valueSpec);if(h.result==="error")return h.value.map(M=>new $(`${m.key}${M.key}`,m.value,M.message));const x=h.value.expression||h.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!x.outputDefined())return[new $(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!Or(x))return[new $(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter"&&!Or(x))return[new $(m.key,m.value,'"feature-state" data expressions are not supported with filters.')];if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!Ua(x,["zoom","feature-state"]))return[new $(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!Ar(x))return[new $(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wa(m){const h=m.key,x=m.value,M=m.valueSpec,q=[];return Array.isArray(M.values)?M.values.indexOf(mr(x))===-1&&q.push(new $(h,x,`expected one of [${M.values.join(", ")}], ${JSON.stringify(x)} found`)):Object.keys(M.values).indexOf(mr(x))===-1&&q.push(new $(h,x,`expected one of [${Object.keys(M.values).join(", ")}], ${JSON.stringify(x)} found`)),q}function cl(m){return ul(Nr(m.value))?ka(te({},m,{expressionContext:"filter",valueSpec:{value:"boolean"}})):lu(m)}function lu(m){const h=m.value,x=m.key;if(Xn(h)!=="array")return[new $(x,h,`array expected, ${Xn(h)} found`)];const M=m.styleSpec;let q,K=[];if(h.length<1)return[new $(x,h,"filter array must have at least 1 element")];switch(K=K.concat(Wa({key:`${x}[0]`,value:h[0],valueSpec:M.filter_operator,style:m.style,styleSpec:m.styleSpec})),mr(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&mr(h[1])==="$type"&&K.push(new $(x,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&K.push(new $(x,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(q=Xn(h[1]),q!=="string"&&K.push(new $(`${x}[1]`,h[1],`string expected, ${q} found`)));for(let J=2;J<h.length;J++)q=Xn(h[J]),mr(h[1])==="$type"?K=K.concat(Wa({key:`${x}[${J}]`,value:h[J],valueSpec:M.geometry_type,style:m.style,styleSpec:m.styleSpec})):q!=="string"&&q!=="number"&&q!=="boolean"&&K.push(new $(`${x}[${J}]`,h[J],`string, number, or boolean expected, ${q} found`));break;case"any":case"all":case"none":for(let J=1;J<h.length;J++)K=K.concat(lu({key:`${x}[${J}]`,value:h[J],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":q=Xn(h[1]),h.length!==2?K.push(new $(x,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="string"&&K.push(new $(`${x}[1]`,h[1],`string expected, ${q} found`));break;case"within":q=Xn(h[1]),h.length!==2?K.push(new $(x,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="object"&&K.push(new $(`${x}[1]`,h[1],`object expected, ${q} found`))}return K}function gl(m,h){const x=m.key,M=m.validateSpec,q=m.style,K=m.styleSpec,J=m.value,me=m.objectKey,Ce=K[`${h}_${m.layerType}`];if(!Ce)return[];const Oe=me.match(/^(.*)-transition$/);if(h==="paint"&&Oe&&Ce[Oe[1]]&&Ce[Oe[1]].transition)return M({key:x,value:J,valueSpec:K.transition,style:q,styleSpec:K});const f=m.valueSpec||Ce[me];if(!f)return[new $(x,J,`unknown property "${me}"`)];let u;if(Xn(J)==="string"&&Cs(f)&&!f.tokens&&(u=/^{([^}]+)}$/.exec(J)))return[new $(x,J,`"${me}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const p=[];return m.layerType==="symbol"&&(me==="text-field"&&q&&!q.glyphs&&p.push(new $(x,J,'use of "text-field" requires a style "glyphs" property')),me==="text-font"&&Ko(Nr(J))&&mr(J.type)==="identity"&&p.push(new $(x,J,'"text-font" does not support identity functions'))),p.concat(M({key:m.key,value:J,valueSpec:f,style:q,styleSpec:K,expressionContext:"property",propertyType:h,propertyKey:me}))}function ro(m){return gl(m,"paint")}function mi(m){return gl(m,"layout")}function Vi(m){let h=[];const x=m.value,M=m.key,q=m.style,K=m.styleSpec;x.type||x.ref||h.push(new $(M,x,'either "type" or "ref" is required'));let J=mr(x.type);const me=mr(x.ref);if(x.id){const Ce=mr(x.id);for(let Oe=0;Oe<m.arrayIndex;Oe++){const f=q.layers[Oe];mr(f.id)===Ce&&h.push(new $(M,x.id,`duplicate layer id "${x.id}", previously used at line ${f.id.__line__}`))}}if("ref"in x){let Ce;["type","source","source-layer","filter","layout"].forEach(Oe=>{Oe in x&&h.push(new $(M,x[Oe],`"${Oe}" is prohibited for ref layers`))}),q.layers.forEach(Oe=>{mr(Oe.id)===me&&(Ce=Oe)}),Ce?Ce.ref?h.push(new $(M,x.ref,"ref cannot reference another ref layer")):J=mr(Ce.type):h.push(new $(M,x.ref,`ref layer "${me}" not found`))}else if(J!=="background")if(x.source){const Ce=q.sources&&q.sources[x.source],Oe=Ce&&mr(Ce.type);Ce?Oe==="vector"&&J==="raster"?h.push(new $(M,x.source,`layer "${x.id}" requires a raster source`)):Oe!=="raster-dem"&&J==="hillshade"?h.push(new $(M,x.source,`layer "${x.id}" requires a raster-dem source`)):Oe==="raster"&&J!=="raster"?h.push(new $(M,x.source,`layer "${x.id}" requires a vector source`)):Oe!=="vector"||x["source-layer"]?Oe==="raster-dem"&&J!=="hillshade"?h.push(new $(M,x.source,"raster-dem source can only be used with layer type 'hillshade'.")):J!=="line"||!x.paint||!x.paint["line-gradient"]||Oe==="geojson"&&Ce.lineMetrics||h.push(new $(M,x,`layer "${x.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new $(M,x,`layer "${x.id}" must specify a "source-layer"`)):h.push(new $(M,x.source,`source "${x.source}" not found`))}else h.push(new $(M,x,'missing required property "source"'));return h=h.concat(ha({key:M,value:x,valueSpec:K.layer,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,objectElementValidators:{"*":()=>[],type:()=>m.validateSpec({key:`${M}.type`,value:x.type,valueSpec:K.layer.type,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,object:x,objectKey:"type"}),filter:cl,layout:Ce=>ha({layer:x,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Oe=>mi(te({layerType:J},Oe))}}),paint:Ce=>ha({layer:x,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Oe=>ro(te({layerType:J},Oe))}})}})),h}function Di(m){const h=m.value,x=m.key,M=Xn(h);return M!=="string"?[new $(x,h,`string expected, ${M} found`)]:[]}const Ft={promoteId:function({key:m,value:h}){if(Xn(h)==="string")return Di({key:m,value:h});{const x=[];for(const M in h)x.push(...Di({key:`${m}.${M}`,value:h[M]}));return x}}};function ti(m){const h=m.value,x=m.key,M=m.styleSpec,q=m.style,K=m.validateSpec;if(!h.type)return[new $(x,h,'"type" is required')];const J=mr(h.type);let me;switch(J){case"vector":case"raster":return me=ha({key:x,value:h,valueSpec:M[`source_${J.replace("-","_")}`],style:m.style,styleSpec:M,objectElementValidators:Ft,validateSpec:K}),me;case"raster-dem":return me=function(Ce){var Oe;const f=(Oe=Ce.sourceName)!==null&&Oe!==void 0?Oe:"",u=Ce.value,p=Ce.styleSpec,S=p.source_raster_dem,L=Ce.style;let U=[];const Q=Xn(u);if(u===void 0)return U;if(Q!=="object")return U.push(new $("source_raster_dem",u,`object expected, ${Q} found`)),U;const re=mr(u.encoding)==="custom",Ae=["redFactor","greenFactor","blueFactor","baseShift"],_e=Ce.value.encoding?`"${Ce.value.encoding}"`:"Default";for(const Le in u)!re&&Ae.includes(Le)?U.push(new $(Le,u[Le],`In "${f}": "${Le}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):S[Le]?U=U.concat(Ce.validateSpec({key:Le,value:u[Le],valueSpec:S[Le],validateSpec:Ce.validateSpec,style:L,styleSpec:p})):U.push(new $(Le,u[Le],`unknown property "${Le}"`));return U}({sourceName:x,value:h,style:m.style,styleSpec:M,validateSpec:K}),me;case"geojson":if(me=ha({key:x,value:h,valueSpec:M.source_geojson,style:q,styleSpec:M,validateSpec:K,objectElementValidators:Ft}),h.cluster)for(const Ce in h.clusterProperties){const[Oe,f]=h.clusterProperties[Ce],u=typeof Oe=="string"?[Oe,["accumulated"],["get",Ce]]:Oe;me.push(...ka({key:`${x}.${Ce}.map`,value:f,validateSpec:K,expressionContext:"cluster-map"})),me.push(...ka({key:`${x}.${Ce}.reduce`,value:u,validateSpec:K,expressionContext:"cluster-reduce"}))}return me;case"video":return ha({key:x,value:h,valueSpec:M.source_video,style:q,validateSpec:K,styleSpec:M});case"image":return ha({key:x,value:h,valueSpec:M.source_image,style:q,validateSpec:K,styleSpec:M});case"canvas":return[new $(x,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wa({key:`${x}.type`,value:h.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:q,validateSpec:K,styleSpec:M})}}function xi(m){const h=m.value,x=m.styleSpec,M=x.light,q=m.style;let K=[];const J=Xn(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new $("light",h,`object expected, ${J} found`)]),K;for(const me in h){const Ce=me.match(/^(.*)-transition$/);K=K.concat(Ce&&M[Ce[1]]&&M[Ce[1]].transition?m.validateSpec({key:me,value:h[me],valueSpec:x.transition,validateSpec:m.validateSpec,style:q,styleSpec:x}):M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:x}):[new $(me,h[me],`unknown property "${me}"`)])}return K}function Fi(m){const h=m.value,x=m.styleSpec,M=x.sky,q=m.style,K=Xn(h);if(h===void 0)return[];if(K!=="object")return[new $("sky",h,`object expected, ${K} found`)];let J=[];for(const me in h)J=J.concat(M[me]?Yn({key:me,value:h[me],valueSpec:M[me],style:q,styleSpec:x}):[new $(me,h[me],`unknown property "${me}"`)]);return J}function Ln(m){const h=m.value,x=m.styleSpec,M=x.terrain,q=m.style;let K=[];const J=Xn(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new $("terrain",h,`object expected, ${J} found`)]),K;for(const me in h)K=K.concat(M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:x}):[new $(me,h[me],`unknown property "${me}"`)]);return K}function Hn(m){let h=[];const x=m.value,M=m.key;if(Array.isArray(x)){const q=[],K=[];for(const J in x)x[J].id&&q.includes(x[J].id)&&h.push(new $(M,x,`all the sprites' ids must be unique, but ${x[J].id} is duplicated`)),q.push(x[J].id),x[J].url&&K.includes(x[J].url)&&h.push(new $(M,x,`all the sprites' URLs must be unique, but ${x[J].url} is duplicated`)),K.push(x[J].url),h=h.concat(ha({key:`${M}[${J}]`,value:x[J],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:m.validateSpec}));return h}return Di({key:M,value:x})}const lr={"*":()=>[],array:po,boolean:function(m){const h=m.value,x=m.key,M=Xn(h);return M!=="boolean"?[new $(x,h,`boolean expected, ${M} found`)]:[]},number:ea,color:function(m){const h=m.key,x=m.value,M=Xn(x);return M!=="string"?[new $(h,x,`color expected, ${M} found`)]:mn.parse(String(x))?[]:[new $(h,x,`color expected, "${x}" found`)]},constants:$r,enum:Wa,filter:cl,function:Sa,layer:Vi,object:ha,source:ti,light:xi,sky:Fi,terrain:Ln,string:Di,formatted:function(m){return Di(m).length===0?[]:ka(m)},resolvedImage:function(m){return Di(m).length===0?[]:ka(m)},padding:function(m){const h=m.key,x=m.value;if(Xn(x)==="array"){if(x.length<1||x.length>4)return[new $(h,x,`padding requires 1 to 4 values; ${x.length} values found`)];const M={type:"number"};let q=[];for(let K=0;K<x.length;K++)q=q.concat(m.validateSpec({key:`${h}[${K}]`,value:x[K],validateSpec:m.validateSpec,valueSpec:M}));return q}return ea({key:h,value:x,valueSpec:{}})},variableAnchorOffsetCollection:function(m){const h=m.key,x=m.value,M=Xn(x),q=m.styleSpec;if(M!=="array"||x.length<1||x.length%2!=0)return[new $(h,x,"variableAnchorOffsetCollection requires a non-empty array of even length")];let K=[];for(let J=0;J<x.length;J+=2)K=K.concat(Wa({key:`${h}[${J}]`,value:x[J],valueSpec:q.layout_symbol["text-anchor"]})),K=K.concat(po({key:`${h}[${J+1}]`,value:x[J+1],valueSpec:{length:2,value:"number"},validateSpec:m.validateSpec,style:m.style,styleSpec:q}));return K},sprite:Hn};function Yn(m){const h=m.value,x=m.valueSpec,M=m.styleSpec;return m.validateSpec=Yn,x.expression&&Ko(mr(h))?Sa(m):x.expression&&Zr(Nr(h))?ka(m):x.type&&lr[x.type]?lr[x.type](m):ha(te({},m,{valueSpec:x.type?M[x.type]:x}))}function qs(m){const h=m.value,x=m.key,M=Di(m);return M.length||(h.indexOf("{fontstack}")===-1&&M.push(new $(x,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&M.push(new $(x,h,'"glyphs" url must include a "{range}" token'))),M}function ks(m,h=ii){let x=[];return x=x.concat(Yn({key:"",value:m,valueSpec:h.$root,styleSpec:h,style:m,validateSpec:Yn,objectElementValidators:{glyphs:qs,"*":()=>[]}})),m.constants&&(x=x.concat($r({key:"constants",value:m.constants,style:m,styleSpec:h,validateSpec:Yn}))),Xa(x)}function As(m){return function(h){return m({...h,validateSpec:Yn})}}function Xa(m){return[].concat(m).sort((h,x)=>h.line-x.line)}function mo(m){return function(...h){return Xa(m.apply(this,h))}}ks.source=mo(As(ti)),ks.sprite=mo(As(Hn)),ks.glyphs=mo(As(qs)),ks.light=mo(As(xi)),ks.sky=mo(As(Fi)),ks.terrain=mo(As(Ln)),ks.layer=mo(As(Vi)),ks.filter=mo(As(cl)),ks.paintProperty=mo(As(ro)),ks.layoutProperty=mo(As(mi));const rs=ks,Qu=rs.light,Ru=rs.paintProperty,go=rs.layoutProperty;function Ml(m,h){let x=!1;if(h&&h.length)for(const M of h)m.fire(new fi(new Error(M.message))),x=!0;return x}class Pn{constructor(h,x,M){const q=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;const J=new Int32Array(this.arrayBuffer);h=J[0],this.d=(x=J[1])+2*(M=J[2]);for(let Ce=0;Ce<this.d*this.d;Ce++){const Oe=J[3+Ce],f=J[3+Ce+1];q.push(Oe===f?null:J.subarray(Oe,f))}const me=J[3+q.length+1];this.keys=J.subarray(J[3+q.length],me),this.bboxes=J.subarray(me),this.insert=this._insertReadonly}else{this.d=x+2*M;for(let J=0;J<this.d*this.d;J++)q.push([]);this.keys=[],this.bboxes=[]}this.n=x,this.extent=h,this.padding=M,this.scale=x/h,this.uid=0;const K=M/x*h;this.min=-K,this.max=h+K}insert(h,x,M,q,K){this._forEachCell(x,M,q,K,this._insertCell,this.uid++,void 0,void 0),this.keys.push(h),this.bboxes.push(x),this.bboxes.push(M),this.bboxes.push(q),this.bboxes.push(K)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(h,x,M,q,K,J){this.cells[K].push(J)}query(h,x,M,q,K){const J=this.min,me=this.max;if(h<=J&&x<=J&&me<=M&&me<=q&&!K)return Array.prototype.slice.call(this.keys);{const Ce=[];return this._forEachCell(h,x,M,q,this._queryCell,Ce,{},K),Ce}}_queryCell(h,x,M,q,K,J,me,Ce){const Oe=this.cells[K];if(Oe!==null){const f=this.keys,u=this.bboxes;for(let p=0;p<Oe.length;p++){const S=Oe[p];if(me[S]===void 0){const L=4*S;(Ce?Ce(u[L+0],u[L+1],u[L+2],u[L+3]):h<=u[L+2]&&x<=u[L+3]&&M>=u[L+0]&&q>=u[L+1])?(me[S]=!0,J.push(f[S])):me[S]=!1}}}}_forEachCell(h,x,M,q,K,J,me,Ce){const Oe=this._convertToCellCoord(h),f=this._convertToCellCoord(x),u=this._convertToCellCoord(M),p=this._convertToCellCoord(q);for(let S=Oe;S<=u;S++)for(let L=f;L<=p;L++){const U=this.d*L+S;if((!Ce||Ce(this._convertFromCellCoord(S),this._convertFromCellCoord(L),this._convertFromCellCoord(S+1),this._convertFromCellCoord(L+1)))&&K.call(this,h,x,M,q,U,J,me,Ce))return}}_convertFromCellCoord(h){return(h-this.padding)/this.scale}_convertToCellCoord(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const h=this.cells,x=3+this.cells.length+1+1;let M=0;for(let J=0;J<this.cells.length;J++)M+=this.cells[J].length;const q=new Int32Array(x+M+this.keys.length+this.bboxes.length);q[0]=this.extent,q[1]=this.n,q[2]=this.padding;let K=x;for(let J=0;J<h.length;J++){const me=h[J];q[3+J]=K,q.set(me,K),K+=me.length}return q[3+h.length]=K,q.set(this.keys,K),K+=this.keys.length,q[3+h.length+1]=K,q.set(this.bboxes,K),K+=this.bboxes.length,q.buffer}static serialize(h,x){const M=h.toArrayBuffer();return x&&x.push(M),{buffer:M}}static deserialize(h){return new Pn(h.buffer)}}const Ma={};function Sn(m,h,x={}){if(Ma[m])throw new Error(`${m} is already registered.`);Object.defineProperty(h,"_classRegistryKey",{value:m,writeable:!1}),Ma[m]={klass:h,omit:x.omit||[],shallow:x.shallow||[]}}Sn("Object",Object),Sn("TransferableGridIndex",Pn),Sn("Color",mn),Sn("Error",Error),Sn("AJAXError",yn),Sn("ResolvedImage",Yi),Sn("StylePropertyFunction",Yr),Sn("StyleExpression",es,{omit:["_evaluator"]}),Sn("ZoomDependentExpression",rr),Sn("ZoomConstantExpression",kr),Sn("CompoundExpression",fn,{omit:["_evaluate"]});for(const m in Io)Io[m]._classRegistryKey||Sn(`Expression_${m}`,Io[m]);function Fo(m){return m&&typeof ArrayBuffer<"u"&&(m instanceof ArrayBuffer||m.constructor&&m.constructor.name==="ArrayBuffer")}function Nl(m,h){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error)return m;if(Fo(m)||Rt(m))return h&&h.push(m),m;if(ArrayBuffer.isView(m)){const x=m;return h&&h.push(x.buffer),x}if(m instanceof ImageData)return h&&h.push(m.data.buffer),m;if(Array.isArray(m)){const x=[];for(const M of m)x.push(Nl(M,h));return x}if(typeof m=="object"){const x=m.constructor,M=x._classRegistryKey;if(!M)throw new Error(`can't serialize object of unregistered class ${x.name}`);if(!Ma[M])throw new Error(`${M} is not registered.`);const q=x.serialize?x.serialize(m,h):{};if(x.serialize){if(h&&q===h[h.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const K in m){if(!m.hasOwnProperty(K)||Ma[M].omit.indexOf(K)>=0)continue;const J=m[K];q[K]=Ma[M].shallow.indexOf(K)>=0?J:Nl(J,h)}m instanceof Error&&(q.message=m.message)}if(q.$name)throw new Error("$name property is reserved for worker serialization logic.");return M!=="Object"&&(q.$name=M),q}throw new Error("can't serialize object of type "+typeof m)}function En(m){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error||Fo(m)||Rt(m)||ArrayBuffer.isView(m)||m instanceof ImageData)return m;if(Array.isArray(m))return m.map(En);if(typeof m=="object"){const h=m.$name||"Object";if(!Ma[h])throw new Error(`can't deserialize unregistered class ${h}`);const{klass:x}=Ma[h];if(!x)throw new Error(`can't deserialize unregistered class ${h}`);if(x.deserialize)return x.deserialize(m);const M=Object.create(x.prototype);for(const q of Object.keys(m)){if(q==="$name")continue;const K=m[q];M[q]=Ma[h].shallow.indexOf(q)>=0?K:En(K)}return M}throw new Error("can't deserialize object of type "+typeof m)}class Hl{constructor(){this.first=!0}update(h,x){const M=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=M,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=M,!0):(this.lastFloorZoom>M?(this.lastIntegerZoom=M+1,this.lastIntegerZoomTime=x):this.lastFloorZoom<M&&(this.lastIntegerZoom=M,this.lastIntegerZoomTime=x),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=M,!0))}}const Cn={"Latin-1 Supplement":m=>m>=128&&m<=255,Arabic:m=>m>=1536&&m<=1791,"Arabic Supplement":m=>m>=1872&&m<=1919,"Arabic Extended-A":m=>m>=2208&&m<=2303,"Hangul Jamo":m=>m>=4352&&m<=4607,"Unified Canadian Aboriginal Syllabics":m=>m>=5120&&m<=5759,Khmer:m=>m>=6016&&m<=6143,"Unified Canadian Aboriginal Syllabics Extended":m=>m>=6320&&m<=6399,"General Punctuation":m=>m>=8192&&m<=8303,"Letterlike Symbols":m=>m>=8448&&m<=8527,"Number Forms":m=>m>=8528&&m<=8591,"Miscellaneous Technical":m=>m>=8960&&m<=9215,"Control Pictures":m=>m>=9216&&m<=9279,"Optical Character Recognition":m=>m>=9280&&m<=9311,"Enclosed Alphanumerics":m=>m>=9312&&m<=9471,"Geometric Shapes":m=>m>=9632&&m<=9727,"Miscellaneous Symbols":m=>m>=9728&&m<=9983,"Miscellaneous Symbols and Arrows":m=>m>=11008&&m<=11263,"CJK Radicals Supplement":m=>m>=11904&&m<=12031,"Kangxi Radicals":m=>m>=12032&&m<=12255,"Ideographic Description Characters":m=>m>=12272&&m<=12287,"CJK Symbols and Punctuation":m=>m>=12288&&m<=12351,Hiragana:m=>m>=12352&&m<=12447,Katakana:m=>m>=12448&&m<=12543,Bopomofo:m=>m>=12544&&m<=12591,"Hangul Compatibility Jamo":m=>m>=12592&&m<=12687,Kanbun:m=>m>=12688&&m<=12703,"Bopomofo Extended":m=>m>=12704&&m<=12735,"CJK Strokes":m=>m>=12736&&m<=12783,"Katakana Phonetic Extensions":m=>m>=12784&&m<=12799,"Enclosed CJK Letters and Months":m=>m>=12800&&m<=13055,"CJK Compatibility":m=>m>=13056&&m<=13311,"CJK Unified Ideographs Extension A":m=>m>=13312&&m<=19903,"Yijing Hexagram Symbols":m=>m>=19904&&m<=19967,"CJK Unified Ideographs":m=>m>=19968&&m<=40959,"Yi Syllables":m=>m>=40960&&m<=42127,"Yi Radicals":m=>m>=42128&&m<=42191,"Hangul Jamo Extended-A":m=>m>=43360&&m<=43391,"Hangul Syllables":m=>m>=44032&&m<=55215,"Hangul Jamo Extended-B":m=>m>=55216&&m<=55295,"Private Use Area":m=>m>=57344&&m<=63743,"CJK Compatibility Ideographs":m=>m>=63744&&m<=64255,"Arabic Presentation Forms-A":m=>m>=64336&&m<=65023,"Vertical Forms":m=>m>=65040&&m<=65055,"CJK Compatibility Forms":m=>m>=65072&&m<=65103,"Small Form Variants":m=>m>=65104&&m<=65135,"Arabic Presentation Forms-B":m=>m>=65136&&m<=65279,"Halfwidth and Fullwidth Forms":m=>m>=65280&&m<=65519};function _l(m){for(const h of m)if(Vl(h.charCodeAt(0)))return!0;return!1}function uu(m){for(const h of m)if(!Fu(h.charCodeAt(0)))return!1;return!0}function Fu(m){return!(Cn.Arabic(m)||Cn["Arabic Supplement"](m)||Cn["Arabic Extended-A"](m)||Cn["Arabic Presentation Forms-A"](m)||Cn["Arabic Presentation Forms-B"](m))}function Vl(m){return!(m!==746&&m!==747&&(m<4352||!(Cn["Bopomofo Extended"](m)||Cn.Bopomofo(m)||Cn["CJK Compatibility Forms"](m)&&!(m>=65097&&m<=65103)||Cn["CJK Compatibility Ideographs"](m)||Cn["CJK Compatibility"](m)||Cn["CJK Radicals Supplement"](m)||Cn["CJK Strokes"](m)||!(!Cn["CJK Symbols and Punctuation"](m)||m>=12296&&m<=12305||m>=12308&&m<=12319||m===12336)||Cn["CJK Unified Ideographs Extension A"](m)||Cn["CJK Unified Ideographs"](m)||Cn["Enclosed CJK Letters and Months"](m)||Cn["Hangul Compatibility Jamo"](m)||Cn["Hangul Jamo Extended-A"](m)||Cn["Hangul Jamo Extended-B"](m)||Cn["Hangul Jamo"](m)||Cn["Hangul Syllables"](m)||Cn.Hiragana(m)||Cn["Ideographic Description Characters"](m)||Cn.Kanbun(m)||Cn["Kangxi Radicals"](m)||Cn["Katakana Phonetic Extensions"](m)||Cn.Katakana(m)&&m!==12540||!(!Cn["Halfwidth and Fullwidth Forms"](m)||m===65288||m===65289||m===65293||m>=65306&&m<=65310||m===65339||m===65341||m===65343||m>=65371&&m<=65503||m===65507||m>=65512&&m<=65519)||!(!Cn["Small Form Variants"](m)||m>=65112&&m<=65118||m>=65123&&m<=65126)||Cn["Unified Canadian Aboriginal Syllabics"](m)||Cn["Unified Canadian Aboriginal Syllabics Extended"](m)||Cn["Vertical Forms"](m)||Cn["Yijing Hexagram Symbols"](m)||Cn["Yi Syllables"](m)||Cn["Yi Radicals"](m))))}function yl(m){return!(Vl(m)||function(h){return!!(Cn["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||Cn["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||Cn["Letterlike Symbols"](h)||Cn["Number Forms"](h)||Cn["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||Cn["Control Pictures"](h)&&h!==9251||Cn["Optical Character Recognition"](h)||Cn["Enclosed Alphanumerics"](h)||Cn["Geometric Shapes"](h)||Cn["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||Cn["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||Cn["CJK Symbols and Punctuation"](h)||Cn.Katakana(h)||Cn["Private Use Area"](h)||Cn["CJK Compatibility Forms"](h)||Cn["Small Form Variants"](h)||Cn["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)}(m))}function ta(m){return m>=1424&&m<=2303||Cn["Arabic Presentation Forms-A"](m)||Cn["Arabic Presentation Forms-B"](m)}function sc(m,h){return!(!h&&ta(m)||m>=2304&&m<=3583||m>=3840&&m<=4255||Cn.Khmer(m))}function Wu(m){for(const h of m)if(ta(h.charCodeAt(0)))return!0;return!1}const jl=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(m){this.pluginStatus=m.pluginStatus,this.pluginURL=m.pluginURL}setMethods(m){this.applyArabicShaping=m.applyArabicShaping,this.processBidirectionalText=m.processBidirectionalText,this.processStyledBidirectionalText=m.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class fs{constructor(h,x){this.zoom=h,x?(this.now=x.now,this.fadeDuration=x.fadeDuration,this.zoomHistory=x.zoomHistory,this.transition=x.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Hl,this.transition={})}isSupportedScript(h){return function(x,M){for(const q of x)if(!sc(q.charCodeAt(0),M))return!1;return!0}(h,jl.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const h=this.zoom,x=h-Math.floor(h),M=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:x+(1-x)*M}:{fromScale:.5,toScale:1,t:1-(1-M)*x}}}class _a{constructor(h,x){this.property=h,this.value=x,this.expression=function(M,q){if(Ko(M))return new Yr(M,q);if(Zr(M)){const K=ll(M,q);if(K.result==="error")throw new Error(K.value.map(J=>`${J.key}: ${J.message}`).join(", "));return K.value}{let K=M;return q.type==="color"&&typeof M=="string"?K=mn.parse(M):q.type!=="padding"||typeof M!="number"&&!Array.isArray(M)?q.type==="variableAnchorOffsetCollection"&&Array.isArray(M)&&(K=Qt.parse(M)):K=ur.parse(M),{kind:"constant",evaluate:()=>K}}}(x===void 0?h.specification.default:x,h.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(h,x,M){return this.property.possiblyEvaluate(this,h,x,M)}}class el{constructor(h){this.property=h,this.value=new _a(h,void 0)}transitioned(h,x){return new Ou(this.property,this.value,x,Xt({},h.transition,this.transition),h.now)}untransitioned(){return new Ou(this.property,this.value,null,{},0)}}class _u{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)}getValue(h){return gt(this._values[h].value.value)}setValue(h,x){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new el(this._values[h].property)),this._values[h].value=new _a(this._values[h].property,x===null?void 0:gt(x))}getTransition(h){return gt(this._values[h].transition)}setTransition(h,x){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new el(this._values[h].property)),this._values[h].transition=gt(x)||void 0}serialize(){const h={};for(const x of Object.keys(this._values)){const M=this.getValue(x);M!==void 0&&(h[x]=M);const q=this.getTransition(x);q!==void 0&&(h[`${x}-transition`]=q)}return h}transitioned(h,x){const M=new cu(this._properties);for(const q of Object.keys(this._values))M._values[q]=this._values[q].transitioned(h,x._values[q]);return M}untransitioned(){const h=new cu(this._properties);for(const x of Object.keys(this._values))h._values[x]=this._values[x].untransitioned();return h}}class Ou{constructor(h,x,M,q,K){this.property=h,this.value=x,this.begin=K+q.delay||0,this.end=this.begin+q.duration||0,h.specification.transition&&(q.delay||q.duration)&&(this.prior=M)}possiblyEvaluate(h,x,M){const q=h.now||0,K=this.value.possiblyEvaluate(h,x,M),J=this.prior;if(J){if(q>this.end)return this.prior=null,K;if(this.value.isDataDriven())return this.prior=null,K;if(q<this.begin)return J.possiblyEvaluate(h,x,M);{const me=(q-this.begin)/(this.end-this.begin);return this.property.interpolate(J.possiblyEvaluate(h,x,M),K,function(Ce){if(Ce<=0)return 0;if(Ce>=1)return 1;const Oe=Ce*Ce,f=Oe*Ce;return 4*(Ce<.5?f:3*(Ce-Oe)+f-.75)}(me))}}return K}}class cu{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,x,M){const q=new ds(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,x,M);return q}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class Nu{constructor(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)}hasValue(h){return this._values[h].value!==void 0}getValue(h){return gt(this._values[h].value)}setValue(h,x){this._values[h]=new _a(this._values[h].property,x===null?void 0:gt(x))}serialize(){const h={};for(const x of Object.keys(this._values)){const M=this.getValue(x);M!==void 0&&(h[x]=M)}return h}possiblyEvaluate(h,x,M){const q=new ds(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,x,M);return q}}class _r{constructor(h,x,M){this.property=h,this.value=x,this.parameters=M}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,x,M,q){return this.property.evaluate(this.value,this.parameters,h,x,M,q)}}class ds{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class gn{constructor(h){this.specification=h}possiblyEvaluate(h,x){if(h.isDataDriven())throw new Error("Value should not be data driven");return h.expression.evaluate(x)}interpolate(h,x,M){const q=vr[this.specification.type];return q?q(h,x,M):h}}class jn{constructor(h,x){this.specification=h,this.overrides=x}possiblyEvaluate(h,x,M,q){return new _r(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(x,null,{},M,q)}:h.expression,x)}interpolate(h,x,M){if(h.value.kind!=="constant"||x.value.kind!=="constant")return h;if(h.value.value===void 0||x.value.value===void 0)return new _r(this,{kind:"constant",value:void 0},h.parameters);const q=vr[this.specification.type];if(q){const K=q(h.value.value,x.value.value,M);return new _r(this,{kind:"constant",value:K},h.parameters)}return h}evaluate(h,x,M,q,K,J){return h.kind==="constant"?h.value:h.evaluate(x,M,q,K,J)}}class Jn extends jn{possiblyEvaluate(h,x,M,q){if(h.value===void 0)return new _r(this,{kind:"constant",value:void 0},x);if(h.expression.kind==="constant"){const K=h.expression.evaluate(x,null,{},M,q),J=h.property.specification.type==="resolvedImage"&&typeof K!="string"?K.name:K,me=this._calculate(J,J,J,x);return new _r(this,{kind:"constant",value:me},x)}if(h.expression.kind==="camera"){const K=this._calculate(h.expression.evaluate({zoom:x.zoom-1}),h.expression.evaluate({zoom:x.zoom}),h.expression.evaluate({zoom:x.zoom+1}),x);return new _r(this,{kind:"constant",value:K},x)}return new _r(this,h.expression,x)}evaluate(h,x,M,q,K,J){if(h.kind==="source"){const me=h.evaluate(x,M,q,K,J);return this._calculate(me,me,me,x)}return h.kind==="composite"?this._calculate(h.evaluate({zoom:Math.floor(x.zoom)-1},M,q),h.evaluate({zoom:Math.floor(x.zoom)},M,q),h.evaluate({zoom:Math.floor(x.zoom)+1},M,q),x):h.value}_calculate(h,x,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:x}:{from:M,to:x}}interpolate(h){return h}}class tl{constructor(h){this.specification=h}possiblyEvaluate(h,x,M,q){if(h.value!==void 0){if(h.expression.kind==="constant"){const K=h.expression.evaluate(x,null,{},M,q);return this._calculate(K,K,K,x)}return this._calculate(h.expression.evaluate(new fs(Math.floor(x.zoom-1),x)),h.expression.evaluate(new fs(Math.floor(x.zoom),x)),h.expression.evaluate(new fs(Math.floor(x.zoom+1),x)),x)}}_calculate(h,x,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:x}:{from:M,to:x}}interpolate(h){return h}}class Tu{constructor(h){this.specification=h}possiblyEvaluate(h,x,M,q){return!!h.expression.evaluate(x,null,{},M,q)}interpolate(){return!1}}class oa{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const x in h){const M=h[x];M.specification.overridable&&this.overridableProperties.push(x);const q=this.defaultPropertyValues[x]=new _a(M,void 0),K=this.defaultTransitionablePropertyValues[x]=new el(M);this.defaultTransitioningPropertyValues[x]=K.untransitioned(),this.defaultPossiblyEvaluatedValues[x]=q.possiblyEvaluate({})}}}Sn("DataDrivenProperty",jn),Sn("DataConstantProperty",gn),Sn("CrossFadedDataDrivenProperty",Jn),Sn("CrossFadedProperty",tl),Sn("ColorRampProperty",Tu);const yu="-transition";class vs extends pn{constructor(h,x){if(super(),this.id=h.id,this.type=h.type,this._featureFilter={filter:()=>!0,needGeometry:!1},h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter),x.layout&&(this._unevaluatedLayout=new Nu(x.layout)),x.paint)){this._transitionablePaint=new _u(x.paint);for(const M in h.paint)this.setPaintProperty(M,h.paint[M],{validate:!1});for(const M in h.layout)this.setLayoutProperty(M,h.layout[M],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ds(x.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}setLayoutProperty(h,x,M={}){x!=null&&this._validate(go,`layers.${this.id}.layout.${h}`,h,x,M)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,x):this.visibility=x)}getPaintProperty(h){return h.endsWith(yu)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,x,M={}){if(x!=null&&this._validate(Ru,`layers.${this.id}.paint.${h}`,h,x,M))return!1;if(h.endsWith(yu))return this._transitionablePaint.setTransition(h.slice(0,-11),x||void 0),!1;{const q=this._transitionablePaint._values[h],K=q.property.specification["property-type"]==="cross-faded-data-driven",J=q.value.isDataDriven(),me=q.value;this._transitionablePaint.setValue(h,x),this._handleSpecialPaintPropertyUpdate(h);const Ce=this._transitionablePaint._values[h].value;return Ce.isDataDriven()||J||K||this._handleOverridablePaintPropertyUpdate(h,me,Ce)}}_handleSpecialPaintPropertyUpdate(h){}_handleOverridablePaintPropertyUpdate(h,x,M){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,x){h.getCrossfadeParameters&&(this._crossfadeParameters=h.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,x)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,x)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),pt(h,(x,M)=>!(x===void 0||M==="layout"&&!Object.keys(x).length||M==="paint"&&!Object.keys(x).length))}_validate(h,x,M,q,K={}){return(!K||K.validate!==!1)&&Ml(this,h.call(rs,{key:x,layerType:this.type,objectKey:M,value:q,styleSpec:ii,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const x=this.paint.get(h);if(x instanceof _r&&Cs(x.property.specification)&&(x.value.kind==="source"||x.value.kind==="composite")&&x.value.isStateDependent)return!0}return!1}}const ko={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ki{constructor(h,x){this._structArray=h,this._pos1=x*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,x){return h._trim(),x&&(h.isTransferred=!0,x.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const x=Object.create(this.prototype);return x.arrayBuffer=h.arrayBuffer,x.length=h.length,x.capacity=h.arrayBuffer.byteLength/x.bytesPerElement,x._refreshViews(),x}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const x=this.uint8;this._refreshViews(),x&&this.uint8.set(x)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function xs(m,h=1){let x=0,M=0;return{members:m.map(q=>{const K=ko[q.type].BYTES_PER_ELEMENT,J=x=vu(x,Math.max(h,K)),me=q.components||1;return M=Math.max(M,K),x+=K*me,{name:q.name,type:q.type,components:me,offset:J}}),size:vu(x,Math.max(M,h)),alignment:h}}function vu(m,h){return Math.ceil(m/h)*h}class Oo extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x){const M=this.length;return this.resize(M+1),this.emplace(M,h,x)}emplace(h,x,M){const q=2*h;return this.int16[q+0]=x,this.int16[q+1]=M,h}}Oo.prototype.bytesPerElement=4,Sn("StructArrayLayout2i4",Oo);class cs extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.int16[K+0]=x,this.int16[K+1]=M,this.int16[K+2]=q,h}}cs.prototype.bytesPerElement=6,Sn("StructArrayLayout3i6",cs);class hl extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,x,M,q)}emplace(h,x,M,q,K){const J=4*h;return this.int16[J+0]=x,this.int16[J+1]=M,this.int16[J+2]=q,this.int16[J+3]=K,h}}hl.prototype.bytesPerElement=8,Sn("StructArrayLayout4i8",hl);class Ms extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,x,M,q,K,J)}emplace(h,x,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=x,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}Ms.prototype.bytesPerElement=12,Sn("StructArrayLayout2i4i12",Ms);class C extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,x,M,q,K,J)}emplace(h,x,M,q,K,J,me){const Ce=4*h,Oe=8*h;return this.int16[Ce+0]=x,this.int16[Ce+1]=M,this.uint8[Oe+4]=q,this.uint8[Oe+5]=K,this.uint8[Oe+6]=J,this.uint8[Oe+7]=me,h}}C.prototype.bytesPerElement=8,Sn("StructArrayLayout2i4ub8",C);class D extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x){const M=this.length;return this.resize(M+1),this.emplace(M,h,x)}emplace(h,x,M){const q=2*h;return this.float32[q+0]=x,this.float32[q+1]=M,h}}D.prototype.bytesPerElement=8,Sn("StructArrayLayout2f8",D);class z extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f){const u=this.length;return this.resize(u+1),this.emplace(u,h,x,M,q,K,J,me,Ce,Oe,f)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u){const p=10*h;return this.uint16[p+0]=x,this.uint16[p+1]=M,this.uint16[p+2]=q,this.uint16[p+3]=K,this.uint16[p+4]=J,this.uint16[p+5]=me,this.uint16[p+6]=Ce,this.uint16[p+7]=Oe,this.uint16[p+8]=f,this.uint16[p+9]=u,h}}z.prototype.bytesPerElement=20,Sn("StructArrayLayout10ui20",z);class R extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f,u,p){const S=this.length;return this.resize(S+1),this.emplace(S,h,x,M,q,K,J,me,Ce,Oe,f,u,p)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S){const L=12*h;return this.int16[L+0]=x,this.int16[L+1]=M,this.int16[L+2]=q,this.int16[L+3]=K,this.uint16[L+4]=J,this.uint16[L+5]=me,this.uint16[L+6]=Ce,this.uint16[L+7]=Oe,this.int16[L+8]=f,this.int16[L+9]=u,this.int16[L+10]=p,this.int16[L+11]=S,h}}R.prototype.bytesPerElement=24,Sn("StructArrayLayout4i4ui4i24",R);class ee extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.float32[K+0]=x,this.float32[K+1]=M,this.float32[K+2]=q,h}}ee.prototype.bytesPerElement=12,Sn("StructArrayLayout3f12",ee);class le extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const x=this.length;return this.resize(x+1),this.emplace(x,h)}emplace(h,x){return this.uint32[1*h+0]=x,h}}le.prototype.bytesPerElement=4,Sn("StructArrayLayout1ul4",le);class oe extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe){const f=this.length;return this.resize(f+1),this.emplace(f,h,x,M,q,K,J,me,Ce,Oe)}emplace(h,x,M,q,K,J,me,Ce,Oe,f){const u=10*h,p=5*h;return this.int16[u+0]=x,this.int16[u+1]=M,this.int16[u+2]=q,this.int16[u+3]=K,this.int16[u+4]=J,this.int16[u+5]=me,this.uint32[p+3]=Ce,this.uint16[u+8]=Oe,this.uint16[u+9]=f,h}}oe.prototype.bytesPerElement=20,Sn("StructArrayLayout6i1ul2ui20",oe);class we extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,x,M,q,K,J)}emplace(h,x,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=x,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}we.prototype.bytesPerElement=12,Sn("StructArrayLayout2i2i2i12",we);class We extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K){const J=this.length;return this.resize(J+1),this.emplace(J,h,x,M,q,K)}emplace(h,x,M,q,K,J){const me=4*h,Ce=8*h;return this.float32[me+0]=x,this.float32[me+1]=M,this.float32[me+2]=q,this.int16[Ce+6]=K,this.int16[Ce+7]=J,h}}We.prototype.bytesPerElement=16,Sn("StructArrayLayout2f1f2i16",We);class vt extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,x,M,q)}emplace(h,x,M,q,K){const J=12*h,me=3*h;return this.uint8[J+0]=x,this.uint8[J+1]=M,this.float32[me+1]=q,this.float32[me+2]=K,h}}vt.prototype.bytesPerElement=12,Sn("StructArrayLayout2ub2f12",vt);class Ct extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.uint16[K+0]=x,this.uint16[K+1]=M,this.uint16[K+2]=q,h}}Ct.prototype.bytesPerElement=6,Sn("StructArrayLayout3ui6",Ct);class ni extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,U,Q,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,U,Q,re)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,U,Q,re,Ae){const _e=24*h,Le=12*h,qe=48*h;return this.int16[_e+0]=x,this.int16[_e+1]=M,this.uint16[_e+2]=q,this.uint16[_e+3]=K,this.uint32[Le+2]=J,this.uint32[Le+3]=me,this.uint32[Le+4]=Ce,this.uint16[_e+10]=Oe,this.uint16[_e+11]=f,this.uint16[_e+12]=u,this.float32[Le+7]=p,this.float32[Le+8]=S,this.uint8[qe+36]=L,this.uint8[qe+37]=U,this.uint8[qe+38]=Q,this.uint32[Le+10]=re,this.int16[_e+22]=Ae,h}}ni.prototype.bytesPerElement=48,Sn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ni);class Gt extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt){const Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt,Ht){const Zt=32*h,ci=16*h;return this.int16[Zt+0]=x,this.int16[Zt+1]=M,this.int16[Zt+2]=q,this.int16[Zt+3]=K,this.int16[Zt+4]=J,this.int16[Zt+5]=me,this.int16[Zt+6]=Ce,this.int16[Zt+7]=Oe,this.uint16[Zt+8]=f,this.uint16[Zt+9]=u,this.uint16[Zt+10]=p,this.uint16[Zt+11]=S,this.uint16[Zt+12]=L,this.uint16[Zt+13]=U,this.uint16[Zt+14]=Q,this.uint16[Zt+15]=re,this.uint16[Zt+16]=Ae,this.uint16[Zt+17]=_e,this.uint16[Zt+18]=Le,this.uint16[Zt+19]=qe,this.uint16[Zt+20]=et,this.uint16[Zt+21]=At,this.uint16[Zt+22]=_t,this.uint32[ci+12]=Mt,this.float32[ci+13]=Dt,this.float32[ci+14]=Bt,this.uint16[Zt+30]=Kt,this.uint16[Zt+31]=Ht,h}}Gt.prototype.bytesPerElement=64,Sn("StructArrayLayout8i15ui1ul2f2ui64",Gt);class jt extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const x=this.length;return this.resize(x+1),this.emplace(x,h)}emplace(h,x){return this.float32[1*h+0]=x,h}}jt.prototype.bytesPerElement=4,Sn("StructArrayLayout1f4",jt);class Z extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.uint16[6*h+0]=x,this.float32[K+1]=M,this.float32[K+2]=q,h}}Z.prototype.bytesPerElement=12,Sn("StructArrayLayout1ui2f12",Z);class A extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=4*h;return this.uint32[2*h+0]=x,this.uint16[K+2]=M,this.uint16[K+3]=q,h}}A.prototype.bytesPerElement=8,Sn("StructArrayLayout1ul2ui8",A);class E extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x){const M=this.length;return this.resize(M+1),this.emplace(M,h,x)}emplace(h,x,M){const q=2*h;return this.uint16[q+0]=x,this.uint16[q+1]=M,h}}E.prototype.bytesPerElement=4,Sn("StructArrayLayout2ui4",E);class F extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const x=this.length;return this.resize(x+1),this.emplace(x,h)}emplace(h,x){return this.uint16[1*h+0]=x,h}}F.prototype.bytesPerElement=2,Sn("StructArrayLayout1ui2",F);class O extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,x,M,q)}emplace(h,x,M,q,K){const J=4*h;return this.float32[J+0]=x,this.float32[J+1]=M,this.float32[J+2]=q,this.float32[J+3]=K,h}}O.prototype.bytesPerElement=16,Sn("StructArrayLayout4f16",O);class y extends ki{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ae(this.anchorPointX,this.anchorPointY)}}y.prototype.size=20;class s extends oe{get(h){return new y(this,h)}}Sn("CollisionBoxArray",s);class i extends ki{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(h){this._structArray.uint8[this._pos1+37]=h}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(h){this._structArray.uint8[this._pos1+38]=h}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(h){this._structArray.uint32[this._pos4+10]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}i.prototype.size=48;class r extends ni{get(h){return new i(this,h)}}Sn("PlacedSymbolArray",r);class l extends ki{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(h){this._structArray.uint32[this._pos4+12]=h}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}l.prototype.size=64;class d extends Gt{get(h){return new l(this,h)}}Sn("SymbolInstanceArray",d);class _ extends jt{getoffsetX(h){return this.float32[1*h+0]}}Sn("GlyphOffsetArray",_);class w extends cs{getx(h){return this.int16[3*h+0]}gety(h){return this.int16[3*h+1]}gettileUnitDistanceFromAnchor(h){return this.int16[3*h+2]}}Sn("SymbolLineVertexArray",w);class T extends ki{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}T.prototype.size=12;class B extends Z{get(h){return new T(this,h)}}Sn("TextAnchorOffsetArray",B);class j extends ki{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}j.prototype.size=8;class Y extends A{get(h){return new j(this,h)}}Sn("FeatureIndexArray",Y);class ce extends Oo{}class Se extends Oo{}class Te extends Oo{}class Re extends Ms{}class Be extends C{}class Je extends D{}class xt extends z{}class at extends R{}class ct extends ee{}class Et extends le{}class wt extends we{}class ri extends vt{}class Yt extends Ct{}class ei extends E{}const si=xs([{name:"a_pos",components:2,type:"Int16"}],4),{members:ji}=si;class Qi{constructor(h=[]){this.segments=h}prepareSegment(h,x,M,q){let K=this.segments[this.segments.length-1];return h>Qi.MAX_VERTEX_ARRAY_LENGTH&&dt(`Max vertices per segment is ${Qi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}`),(!K||K.vertexLength+h>Qi.MAX_VERTEX_ARRAY_LENGTH||K.sortKey!==q)&&(K={vertexOffset:x.length,primitiveOffset:M.length,vertexLength:0,primitiveLength:0},q!==void 0&&(K.sortKey=q),this.segments.push(K)),K}get(){return this.segments}destroy(){for(const h of this.segments)for(const x in h.vaos)h.vaos[x].destroy()}static simpleSegment(h,x,M,q){return new Qi([{vertexOffset:h,primitiveOffset:x,vertexLength:M,primitiveLength:q,vaos:{},sortKey:0}])}}function Ei(m,h){return 256*(m=zt(Math.floor(m),0,255))+zt(Math.floor(h),0,255)}Qi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Sn("SegmentVector",Qi);const Ui=xs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Gi={exports:{}},ln={exports:{}};ln.exports=function(m,h){var x,M,q,K,J,me,Ce,Oe;for(M=m.length-(x=3&m.length),q=h,J=3432918353,me=461845907,Oe=0;Oe<M;)Ce=255&m.charCodeAt(Oe)|(255&m.charCodeAt(++Oe))<<8|(255&m.charCodeAt(++Oe))<<16|(255&m.charCodeAt(++Oe))<<24,++Oe,q=27492+(65535&(K=5*(65535&(q=(q^=Ce=(65535&(Ce=(Ce=(65535&Ce)*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295)<<13|q>>>19))+((5*(q>>>16)&65535)<<16)&4294967295))+((58964+(K>>>16)&65535)<<16);switch(Ce=0,x){case 3:Ce^=(255&m.charCodeAt(Oe+2))<<16;case 2:Ce^=(255&m.charCodeAt(Oe+1))<<8;case 1:q^=Ce=(65535&(Ce=(Ce=(65535&(Ce^=255&m.charCodeAt(Oe)))*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295}return q^=m.length,q=2246822507*(65535&(q^=q>>>16))+((2246822507*(q>>>16)&65535)<<16)&4294967295,q=3266489909*(65535&(q^=q>>>13))+((3266489909*(q>>>16)&65535)<<16)&4294967295,(q^=q>>>16)>>>0};var Bn=ln.exports,rn={exports:{}};rn.exports=function(m,h){for(var x,M=m.length,q=h^M,K=0;M>=4;)x=1540483477*(65535&(x=255&m.charCodeAt(K)|(255&m.charCodeAt(++K))<<8|(255&m.charCodeAt(++K))<<16|(255&m.charCodeAt(++K))<<24))+((1540483477*(x>>>16)&65535)<<16),q=1540483477*(65535&q)+((1540483477*(q>>>16)&65535)<<16)^(x=1540483477*(65535&(x^=x>>>24))+((1540483477*(x>>>16)&65535)<<16)),M-=4,++K;switch(M){case 3:q^=(255&m.charCodeAt(K+2))<<16;case 2:q^=(255&m.charCodeAt(K+1))<<8;case 1:q=1540483477*(65535&(q^=255&m.charCodeAt(K)))+((1540483477*(q>>>16)&65535)<<16)}return q=1540483477*(65535&(q^=q>>>13))+((1540483477*(q>>>16)&65535)<<16),(q^=q>>>15)>>>0};var kn=Bn,yr=rn.exports;Gi.exports=kn,Gi.exports.murmur3=kn,Gi.exports.murmur2=yr;var er=G(Gi.exports);class Ia{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,x,M,q){this.ids.push(Aa(h)),this.positions.push(x,M,q)}getPositions(h){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const x=Aa(h);let M=0,q=this.ids.length-1;for(;M<q;){const J=M+q>>1;this.ids[J]>=x?q=J:M=J+1}const K=[];for(;this.ids[M]===x;)K.push({index:this.positions[3*M],start:this.positions[3*M+1],end:this.positions[3*M+2]}),M++;return K}static serialize(h,x){const M=new Float64Array(h.ids),q=new Uint32Array(h.positions);return Bs(M,q,0,M.length-1),x&&x.push(M.buffer,q.buffer),{ids:M,positions:q}}static deserialize(h){const x=new Ia;return x.ids=h.ids,x.positions=h.positions,x.indexed=!0,x}}function Aa(m){const h=+m;return!isNaN(h)&&h<=Number.MAX_SAFE_INTEGER?h:er(String(m))}function Bs(m,h,x,M){for(;x<M;){const q=m[x+M>>1];let K=x-1,J=M+1;for(;;){do K++;while(m[K]<q);do J--;while(m[J]>q);if(K>=J)break;so(m,K,J),so(h,3*K,3*J),so(h,3*K+1,3*J+1),so(h,3*K+2,3*J+2)}J-x<M-J?(Bs(m,h,x,J),x=J+1):(Bs(m,h,J+1,M),M=J)}}function so(m,h,x){const M=m[h];m[h]=m[x],m[x]=M}Sn("FeaturePositionMap",Ia);class ao{constructor(h,x){this.gl=h.gl,this.location=x}}class qr extends ao{constructor(h,x){super(h,x),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class ya extends ao{constructor(h,x){super(h,x),this.current=[0,0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3]))}}class _o extends ao{constructor(h,x){super(h,x),this.current=mn.transparent}set(h){h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a))}}const yo=new Float32Array(16);function Zs(m){return[Ei(255*m.r,255*m.g),Ei(255*m.b,255*m.a)]}class ts{constructor(h,x,M){this.value=h,this.uniformNames=x.map(q=>`u_${q}`),this.type=M}setUniform(h,x,M){h.set(M.constantOr(this.value))}getBinding(h,x,M){return this.type==="color"?new _o(h,x):new qr(h,x)}}class is{constructor(h,x){this.uniformNames=x.map(M=>`u_${M}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(h,x){this.pixelRatioFrom=x.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=x.tlbr,this.patternTo=h.tlbr}setUniform(h,x,M,q){const K=q==="u_pattern_to"?this.patternTo:q==="u_pattern_from"?this.patternFrom:q==="u_pixel_ratio_to"?this.pixelRatioTo:q==="u_pixel_ratio_from"?this.pixelRatioFrom:null;K&&h.set(K)}getBinding(h,x,M){return M.substr(0,9)==="u_pattern"?new ya(h,x):new qr(h,x)}}class zr{constructor(h,x,M,q){this.expression=h,this.type=M,this.maxValue=0,this.paintVertexAttributes=x.map(K=>({name:`a_${K}`,type:"Float32",components:M==="color"?2:1,offset:0})),this.paintVertexArray=new q}populatePaintArray(h,x,M,q,K){const J=this.paintVertexArray.length,me=this.expression.evaluate(new fs(0),x,{},q,[],K);this.paintVertexArray.resize(h),this._setPaintValue(J,h,me)}updatePaintArray(h,x,M,q){const K=this.expression.evaluate({zoom:0},M,q);this._setPaintValue(h,x,K)}_setPaintValue(h,x,M){if(this.type==="color"){const q=Zs(M);for(let K=h;K<x;K++)this.paintVertexArray.emplace(K,q[0],q[1])}else{for(let q=h;q<x;q++)this.paintVertexArray.emplace(q,M);this.maxValue=Math.max(this.maxValue,Math.abs(M))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bs{constructor(h,x,M,q,K,J){this.expression=h,this.uniformNames=x.map(me=>`u_${me}_t`),this.type=M,this.useIntegerZoom=q,this.zoom=K,this.maxValue=0,this.paintVertexAttributes=x.map(me=>({name:`a_${me}`,type:"Float32",components:M==="color"?4:2,offset:0})),this.paintVertexArray=new J}populatePaintArray(h,x,M,q,K){const J=this.expression.evaluate(new fs(this.zoom),x,{},q,[],K),me=this.expression.evaluate(new fs(this.zoom+1),x,{},q,[],K),Ce=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(Ce,h,J,me)}updatePaintArray(h,x,M,q){const K=this.expression.evaluate({zoom:this.zoom},M,q),J=this.expression.evaluate({zoom:this.zoom+1},M,q);this._setPaintValue(h,x,K,J)}_setPaintValue(h,x,M,q){if(this.type==="color"){const K=Zs(M),J=Zs(q);for(let me=h;me<x;me++)this.paintVertexArray.emplace(me,K[0],K[1],J[0],J[1])}else{for(let K=h;K<x;K++)this.paintVertexArray.emplace(K,M,q);this.maxValue=Math.max(this.maxValue,Math.abs(M),Math.abs(q))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,x){const M=this.useIntegerZoom?Math.floor(x.zoom):x.zoom,q=zt(this.expression.interpolationFactor(M,this.zoom,this.zoom+1),0,1);h.set(q)}getBinding(h,x,M){return new qr(h,x)}}class Qs{constructor(h,x,M,q,K,J){this.expression=h,this.type=x,this.useIntegerZoom=M,this.zoom=q,this.layerId=J,this.zoomInPaintVertexArray=new K,this.zoomOutPaintVertexArray=new K}populatePaintArray(h,x,M){const q=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(q,h,x.patterns&&x.patterns[this.layerId],M)}updatePaintArray(h,x,M,q,K){this._setPaintValues(h,x,M.patterns&&M.patterns[this.layerId],K)}_setPaintValues(h,x,M,q){if(!q||!M)return;const{min:K,mid:J,max:me}=M,Ce=q[K],Oe=q[J],f=q[me];if(Ce&&Oe&&f)for(let u=h;u<x;u++)this.zoomInPaintVertexArray.emplace(u,Oe.tl[0],Oe.tl[1],Oe.br[0],Oe.br[1],Ce.tl[0],Ce.tl[1],Ce.br[0],Ce.br[1],Oe.pixelRatio,Ce.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,Oe.tl[0],Oe.tl[1],Oe.br[0],Oe.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],Oe.pixelRatio,f.pixelRatio)}upload(h){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,Ui.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,Ui.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Mo{constructor(h,x,M){this.binders={},this._buffers=[];const q=[];for(const K in h.paint._values){if(!M(K))continue;const J=h.paint.get(K);if(!(J instanceof _r&&Cs(J.property.specification)))continue;const me=Vo(K,h.type),Ce=J.value,Oe=J.property.specification.type,f=J.property.useIntegerZoom,u=J.property.specification["property-type"],p=u==="cross-faded"||u==="cross-faded-data-driven";if(Ce.kind==="constant")this.binders[K]=p?new is(Ce.value,me):new ts(Ce.value,me,Oe),q.push(`/u_${K}`);else if(Ce.kind==="source"||p){const S=Sc(K,Oe,"source");this.binders[K]=p?new Qs(Ce,Oe,f,x,S,h.id):new zr(Ce,me,Oe,S),q.push(`/a_${K}`)}else{const S=Sc(K,Oe,"composite");this.binders[K]=new bs(Ce,me,Oe,f,x,S),q.push(`/z_${K}`)}}this.cacheKey=q.sort().join("")}getMaxValue(h){const x=this.binders[h];return x instanceof zr||x instanceof bs?x.maxValue:0}populatePaintArrays(h,x,M,q,K){for(const J in this.binders){const me=this.binders[J];(me instanceof zr||me instanceof bs||me instanceof Qs)&&me.populatePaintArray(h,x,M,q,K)}}setConstantPatternPositions(h,x){for(const M in this.binders){const q=this.binders[M];q instanceof is&&q.setConstantPatternPositions(h,x)}}updatePaintArrays(h,x,M,q,K){let J=!1;for(const me in h){const Ce=x.getPositions(me);for(const Oe of Ce){const f=M.feature(Oe.index);for(const u in this.binders){const p=this.binders[u];if((p instanceof zr||p instanceof bs||p instanceof Qs)&&p.expression.isStateDependent===!0){const S=q.paint.get(u);p.expression=S.value,p.updatePaintArray(Oe.start,Oe.end,f,h[me],K),J=!0}}}}return J}defines(){const h=[];for(const x in this.binders){const M=this.binders[x];(M instanceof ts||M instanceof is)&&h.push(...M.uniformNames.map(q=>`#define HAS_UNIFORM_${q}`))}return h}getBinderAttributes(){const h=[];for(const x in this.binders){const M=this.binders[x];if(M instanceof zr||M instanceof bs)for(let q=0;q<M.paintVertexAttributes.length;q++)h.push(M.paintVertexAttributes[q].name);else if(M instanceof Qs)for(let q=0;q<Ui.members.length;q++)h.push(Ui.members[q].name)}return h}getBinderUniforms(){const h=[];for(const x in this.binders){const M=this.binders[x];if(M instanceof ts||M instanceof is||M instanceof bs)for(const q of M.uniformNames)h.push(q)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h,x){const M=[];for(const q in this.binders){const K=this.binders[q];if(K instanceof ts||K instanceof is||K instanceof bs){for(const J of K.uniformNames)if(x[J]){const me=K.getBinding(h,x[J],J);M.push({name:J,property:q,binding:me})}}}return M}setUniforms(h,x,M,q){for(const{name:K,property:J,binding:me}of x)this.binders[J].setUniform(me,q,M.get(J),K)}updatePaintBuffers(h){this._buffers=[];for(const x in this.binders){const M=this.binders[x];if(h&&M instanceof Qs){const q=h.fromScale===2?M.zoomInPaintVertexBuffer:M.zoomOutPaintVertexBuffer;q&&this._buffers.push(q)}else(M instanceof zr||M instanceof bs)&&M.paintVertexBuffer&&this._buffers.push(M.paintVertexBuffer)}}upload(h){for(const x in this.binders){const M=this.binders[x];(M instanceof zr||M instanceof bs||M instanceof Qs)&&M.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const x=this.binders[h];(x instanceof zr||x instanceof bs||x instanceof Qs)&&x.destroy()}}}class No{constructor(h,x,M=()=>!0){this.programConfigurations={};for(const q of h)this.programConfigurations[q.id]=new Mo(q,x,M);this.needsUpload=!1,this._featureMap=new Ia,this._bufferOffset=0}populatePaintArrays(h,x,M,q,K,J){for(const me in this.programConfigurations)this.programConfigurations[me].populatePaintArrays(h,x,q,K,J);x.id!==void 0&&this._featureMap.add(x.id,M,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,x,M,q){for(const K of M)this.needsUpload=this.programConfigurations[K.id].updatePaintArrays(h,this._featureMap,x,K,q)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const x in this.programConfigurations)this.programConfigurations[x].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}function Vo(m,h){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[m]||[m.replace(`${h}-`,"").replace(/-/g,"_")]}function Sc(m,h,x){const M={color:{source:D,composite:O},number:{source:jt,composite:D}},q=function(K){return{"line-pattern":{source:xt,composite:xt},"fill-pattern":{source:xt,composite:xt},"fill-extrusion-pattern":{source:xt,composite:xt}}[K]}(m);return q&&q[x]||M[h][x]}Sn("ConstantBinder",ts),Sn("CrossFadedConstantBinder",is),Sn("SourceExpressionBinder",zr),Sn("CrossFadedCompositeBinder",Qs),Sn("CompositeExpressionBinder",bs),Sn("ProgramConfiguration",Mo,{omit:["_buffers"]}),Sn("ProgramConfigurationSet",No);const Ws=8192,Zl=Math.pow(2,14)-1,hu=-Zl-1;function il(m){const h=Ws/m.extent,x=m.loadGeometry();for(let M=0;M<x.length;M++){const q=x[M];for(let K=0;K<q.length;K++){const J=q[K],me=Math.round(J.x*h),Ce=Math.round(J.y*h);J.x=zt(me,hu,Zl),J.y=zt(Ce,hu,Zl),(me<J.x||me>J.x+1||Ce<J.y||Ce>J.y+1)&&dt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return x}function vl(m,h){return{type:m.type,id:m.id,properties:m.properties,geometry:h?il(m):[]}}function Pl(m,h,x,M,q){m.emplaceBack(2*h+(M+1)/2,2*x+(q+1)/2)}class Au{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Se,this.indexArray=new Yt,this.segments=new Qi,this.programConfigurations=new No(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){const q=this.layers[0],K=[];let J=null,me=!1;q.type==="circle"&&(J=q.layout.get("circle-sort-key"),me=!J.isConstant());for(const{feature:Ce,id:Oe,index:f,sourceLayerIndex:u}of h){const p=this.layers[0]._featureFilter.needGeometry,S=vl(Ce,p);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),S,M))continue;const L=me?J.evaluate(S,{},M):void 0,U={id:Oe,properties:Ce.properties,type:Ce.type,sourceLayerIndex:u,index:f,geometry:p?S.geometry:il(Ce),patterns:{},sortKey:L};K.push(U)}me&&K.sort((Ce,Oe)=>Ce.sortKey-Oe.sortKey);for(const Ce of K){const{geometry:Oe,index:f,sourceLayerIndex:u}=Ce,p=h[f].feature;this.addFeature(Ce,Oe,f,M),x.featureIndex.insert(p,Oe,f,u,this.index)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,ji),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,x,M,q){for(const K of x)for(const J of K){const me=J.x,Ce=J.y;if(me<0||me>=Ws||Ce<0||Ce>=Ws)continue;const Oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,h.sortKey),f=Oe.vertexLength;Pl(this.layoutVertexArray,me,Ce,-1,-1),Pl(this.layoutVertexArray,me,Ce,1,-1),Pl(this.layoutVertexArray,me,Ce,1,1),Pl(this.layoutVertexArray,me,Ce,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),Oe.vertexLength+=4,Oe.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,{},q)}}function af(m,h){for(let x=0;x<m.length;x++)if(Xc(h,m[x]))return!0;for(let x=0;x<h.length;x++)if(Xc(m,h[x]))return!0;return!!yh(m,h)}function Vh(m,h,x){return!!Xc(m,h)||!!Ic(h,m,x)}function Pa(m,h){if(m.length===1)return l0(h,m[0]);for(let x=0;x<h.length;x++){const M=h[x];for(let q=0;q<M.length;q++)if(Xc(m,M[q]))return!0}for(let x=0;x<m.length;x++)if(l0(h,m[x]))return!0;for(let x=0;x<h.length;x++)if(yh(m,h[x]))return!0;return!1}function pA(m,h,x){if(m.length>1){if(yh(m,h))return!0;for(let M=0;M<h.length;M++)if(Ic(h[M],m,x))return!0}for(let M=0;M<m.length;M++)if(Ic(m[M],h,x))return!0;return!1}function yh(m,h){if(m.length===0||h.length===0)return!1;for(let x=0;x<m.length-1;x++){const M=m[x],q=m[x+1];for(let K=0;K<h.length-1;K++)if(Uh(M,q,h[K],h[K+1]))return!0}return!1}function Uh(m,h,x,M){return $e(m,x,M)!==$e(h,x,M)&&$e(m,h,x)!==$e(m,h,M)}function Ic(m,h,x){const M=x*x;if(h.length===1)return m.distSqr(h[0])<M;for(let q=1;q<h.length;q++)if(Gh(m,h[q-1],h[q])<M)return!0;return!1}function Gh(m,h,x){const M=h.distSqr(x);if(M===0)return m.distSqr(h);const q=((m.x-h.x)*(x.x-h.x)+(m.y-h.y)*(x.y-h.y))/M;return m.distSqr(q<0?h:q>1?x:x.sub(h)._mult(q)._add(h))}function l0(m,h){let x,M,q,K=!1;for(let J=0;J<m.length;J++){x=m[J];for(let me=0,Ce=x.length-1;me<x.length;Ce=me++)M=x[me],q=x[Ce],M.y>h.y!=q.y>h.y&&h.x<(q.x-M.x)*(h.y-M.y)/(q.y-M.y)+M.x&&(K=!K)}return K}function Xc(m,h){let x=!1;for(let M=0,q=m.length-1;M<m.length;q=M++){const K=m[M],J=m[q];K.y>h.y!=J.y>h.y&&h.x<(J.x-K.x)*(h.y-K.y)/(J.y-K.y)+K.x&&(x=!x)}return x}function _p(m,h,x){const M=x[0],q=x[2];if(m.x<M.x&&h.x<M.x||m.x>q.x&&h.x>q.x||m.y<M.y&&h.y<M.y||m.y>q.y&&h.y>q.y)return!1;const K=$e(m,h,x[0]);return K!==$e(m,h,x[1])||K!==$e(m,h,x[2])||K!==$e(m,h,x[3])}function qh(m,h,x){const M=h.paint.get(m).value;return M.kind==="constant"?M.value:x.programConfigurations.get(h.id).getMaxValue(m)}function of(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function Yc(m,h,x,M,q){if(!h[0]&&!h[1])return m;const K=ae.convert(h)._mult(q);x==="viewport"&&K._rotate(-M);const J=[];for(let me=0;me<m.length;me++)J.push(m[me].sub(K));return J}let yp,lf;Sn("CircleBucket",Au,{omit:["layers"]});var q0={get paint(){return lf=lf||new oa({"circle-radius":new jn(ii.paint_circle["circle-radius"]),"circle-color":new jn(ii.paint_circle["circle-color"]),"circle-blur":new jn(ii.paint_circle["circle-blur"]),"circle-opacity":new jn(ii.paint_circle["circle-opacity"]),"circle-translate":new gn(ii.paint_circle["circle-translate"]),"circle-translate-anchor":new gn(ii.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gn(ii.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gn(ii.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jn(ii.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jn(ii.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jn(ii.paint_circle["circle-stroke-opacity"])})},get layout(){return yp=yp||new oa({"circle-sort-key":new jn(ii.layout_circle["circle-sort-key"])})}},Ql=1e-6,Xu=typeof Float32Array<"u"?Float32Array:Array;function H0(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function vh(m,h,x){var M=h[0],q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Oe=h[6],f=h[7],u=h[8],p=h[9],S=h[10],L=h[11],U=h[12],Q=h[13],re=h[14],Ae=h[15],_e=x[0],Le=x[1],qe=x[2],et=x[3];return m[0]=_e*M+Le*me+qe*u+et*U,m[1]=_e*q+Le*Ce+qe*p+et*Q,m[2]=_e*K+Le*Oe+qe*S+et*re,m[3]=_e*J+Le*f+qe*L+et*Ae,m[4]=(_e=x[4])*M+(Le=x[5])*me+(qe=x[6])*u+(et=x[7])*U,m[5]=_e*q+Le*Ce+qe*p+et*Q,m[6]=_e*K+Le*Oe+qe*S+et*re,m[7]=_e*J+Le*f+qe*L+et*Ae,m[8]=(_e=x[8])*M+(Le=x[9])*me+(qe=x[10])*u+(et=x[11])*U,m[9]=_e*q+Le*Ce+qe*p+et*Q,m[10]=_e*K+Le*Oe+qe*S+et*re,m[11]=_e*J+Le*f+qe*L+et*Ae,m[12]=(_e=x[12])*M+(Le=x[13])*me+(qe=x[14])*u+(et=x[15])*U,m[13]=_e*q+Le*Ce+qe*p+et*Q,m[14]=_e*K+Le*Oe+qe*S+et*re,m[15]=_e*J+Le*f+qe*L+et*Ae,m}Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)});var $c,mA=vh;function uf(m,h,x){var M=h[0],q=h[1],K=h[2],J=h[3];return m[0]=x[0]*M+x[4]*q+x[8]*K+x[12]*J,m[1]=x[1]*M+x[5]*q+x[9]*K+x[13]*J,m[2]=x[2]*M+x[6]*q+x[10]*K+x[14]*J,m[3]=x[3]*M+x[7]*q+x[11]*K+x[15]*J,m}$c=new Xu(4),Xu!=Float32Array&&($c[0]=0,$c[1]=0,$c[2]=0,$c[3]=0);class u0 extends vs{constructor(h){super(h,q0)}createBucket(h){return new Au(h)}queryRadius(h){const x=h;return qh("circle-radius",this,x)+qh("circle-stroke-width",this,x)+of(this.paint.get("circle-translate"))}queryIntersectsFeature(h,x,M,q,K,J,me,Ce){const Oe=Yc(h,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),J.angle,me),f=this.paint.get("circle-radius").evaluate(x,M)+this.paint.get("circle-stroke-width").evaluate(x,M),u=this.paint.get("circle-pitch-alignment")==="map",p=u?Oe:function(L,U){return L.map(Q=>ps(Q,U))}(Oe,Ce),S=u?f*me:f;for(const L of q)for(const U of L){const Q=u?U:ps(U,Ce);let re=S;const Ae=uf([],[U.x,U.y,0,1],Ce);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?re*=Ae[3]/J.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(re*=J.cameraToCenterDistance/Ae[3]),Vh(p,Q,re))return!0}return!1}}function ps(m,h){const x=uf([],[m.x,m.y,0,1],h);return new ae(x[0]/x[3],x[1]/x[3])}class Wl extends Au{}let Hh;Sn("HeatmapBucket",Wl,{omit:["layers"]});var jh={get paint(){return Hh=Hh||new oa({"heatmap-radius":new jn(ii.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jn(ii.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gn(ii.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Tu(ii.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gn(ii.paint_heatmap["heatmap-opacity"])})}};function cf(m,{width:h,height:x},M,q){if(q){if(q instanceof Uint8ClampedArray)q=new Uint8Array(q.buffer);else if(q.length!==h*x*M)throw new RangeError(`mismatched image size. expected: ${q.length} but got: ${h*x*M}`)}else q=new Uint8Array(h*x*M);return m.width=h,m.height=x,m.data=q,m}function gA(m,{width:h,height:x},M){if(h===m.width&&x===m.height)return;const q=cf({},{width:h,height:x},M);j0(m,q,{x:0,y:0},{x:0,y:0},{width:Math.min(m.width,h),height:Math.min(m.height,x)},M),m.width=h,m.height=x,m.data=q.data}function j0(m,h,x,M,q,K){if(q.width===0||q.height===0)return h;if(q.width>m.width||q.height>m.height||x.x>m.width-q.width||x.y>m.height-q.height)throw new RangeError("out of range source coordinates for image copy");if(q.width>h.width||q.height>h.height||M.x>h.width-q.width||M.y>h.height-q.height)throw new RangeError("out of range destination coordinates for image copy");const J=m.data,me=h.data;if(J===me)throw new Error("srcData equals dstData, so image is already copied");for(let Ce=0;Ce<q.height;Ce++){const Oe=((x.y+Ce)*m.width+x.x)*K,f=((M.y+Ce)*h.width+M.x)*K;for(let u=0;u<q.width*K;u++)me[f+u]=J[Oe+u]}return h}class Dl{constructor(h,x){cf(this,h,1,x)}resize(h){gA(this,h,1)}clone(){return new Dl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,x,M,q,K){j0(h,x,M,q,K,1)}}class Vu{constructor(h,x){cf(this,h,4,x)}resize(h){gA(this,h,4)}replace(h,x){x?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new Vu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,x,M,q,K){j0(h,x,M,q,K,4)}}function _A(m){const h={},x=m.resolution||256,M=m.clips?m.clips.length:1,q=m.image||new Vu({width:x,height:M});if(Math.log(x)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${x}`);const K=(J,me,Ce)=>{h[m.evaluationKey]=Ce;const Oe=m.expression.evaluate(h);q.data[J+me+0]=Math.floor(255*Oe.r/Oe.a),q.data[J+me+1]=Math.floor(255*Oe.g/Oe.a),q.data[J+me+2]=Math.floor(255*Oe.b/Oe.a),q.data[J+me+3]=Math.floor(255*Oe.a)};if(m.clips)for(let J=0,me=0;J<M;++J,me+=4*x)for(let Ce=0,Oe=0;Ce<x;Ce++,Oe+=4){const f=Ce/(x-1),{start:u,end:p}=m.clips[J];K(me,Oe,u*(1-f)+p*f)}else for(let J=0,me=0;J<x;J++,me+=4)K(0,me,J/(x-1));return q}Sn("AlphaImage",Dl),Sn("RGBAImage",Vu);class c0 extends vs{createBucket(h){return new Wl(h)}constructor(h){super(h,jh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_A({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let h0;var vp={get paint(){return h0=h0||new oa({"hillshade-illumination-direction":new gn(ii.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gn(ii.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gn(ii.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gn(ii.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gn(ii.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gn(ii.paint_hillshade["hillshade-accent-color"])})}};class xu extends vs{constructor(h){super(h,vp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Kc=xs([{name:"a_pos",components:2,type:"Int16"}],4),{members:hf}=Kc;var xh={exports:{}};function Ll(m,h,x){x=x||2;var M,q,K,J,me,Ce,Oe,f=h&&h.length,u=f?h[0]*x:m.length,p=A0(m,0,u,x,!0),S=[];if(!p||p.next===p.prev)return S;if(f&&(p=function(U,Q,re,Ae){var _e,Le,qe,et=[];for(_e=0,Le=Q.length;_e<Le;_e++)(qe=A0(U,Q[_e]*Ae,_e<Le-1?Q[_e+1]*Ae:U.length,Ae,!1))===qe.next&&(qe.steiner=!0),et.push(ff(qe));for(et.sort(Ec),_e=0;_e<et.length;_e++)re=Af(et[_e],re);return re}(m,h,p,x)),m.length>80*x){M=K=m[0],q=J=m[1];for(var L=x;L<u;L+=x)(me=m[L])<M&&(M=me),(Ce=m[L+1])<q&&(q=Ce),me>K&&(K=me),Ce>J&&(J=Ce);Oe=(Oe=Math.max(K-M,J-q))!==0?32767/Oe:0}return Zh(p,S,x,M,q,Oe,0),S}function A0(m,h,x,M,q){var K,J;if(q===lc(m,h,x,M)>0)for(K=h;K<x;K+=M)J=Qh(K,m[K],m[K+1],J);else for(K=x-M;K>=h;K-=M)J=Qh(K,m[K],m[K+1],J);return J&&df(J,J.next)&&(gf(J),J=J.next),J}function Jc(m,h){if(!m)return m;h||(h=m);var x,M=m;do if(x=!1,M.steiner||!df(M,M.next)&&Po(M.prev,M,M.next)!==0)M=M.next;else{if(gf(M),(M=h=M.prev)===M.next)break;x=!0}while(x||M!==h);return h}function Zh(m,h,x,M,q,K,J){if(m){!J&&K&&function(f,u,p,S){var L=f;do L.z===0&&(L.z=ac(L.x,L.y,u,p,S)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==f);L.prevZ.nextZ=null,L.prevZ=null,function(U){var Q,re,Ae,_e,Le,qe,et,At,_t=1;do{for(re=U,U=null,Le=null,qe=0;re;){for(qe++,Ae=re,et=0,Q=0;Q<_t&&(et++,Ae=Ae.nextZ);Q++);for(At=_t;et>0||At>0&&Ae;)et!==0&&(At===0||!Ae||re.z<=Ae.z)?(_e=re,re=re.nextZ,et--):(_e=Ae,Ae=Ae.nextZ,At--),Le?Le.nextZ=_e:U=_e,_e.prevZ=Le,Le=_e;re=Ae}Le.nextZ=null,_t*=2}while(qe>1)}(L)}(m,M,q,K);for(var me,Ce,Oe=m;m.prev!==m.next;)if(me=m.prev,Ce=m.next,K?Q0(m,M,q,K):Z0(m))h.push(me.i/x|0),h.push(m.i/x|0),h.push(Ce.i/x|0),gf(m),m=Ce.next,Oe=Ce.next;else if((m=Ce)===Oe){J?J===1?Zh(m=bh(Jc(m),h,x),h,x,M,q,K,2):J===2&&Cm(m,h,x,M,q,K):Zh(Jc(m),h,x,M,q,K,1);break}}}function Z0(m){var h=m.prev,x=m,M=m.next;if(Po(h,x,M)>=0)return!1;for(var q=h.x,K=x.x,J=M.x,me=h.y,Ce=x.y,Oe=M.y,f=q<K?q<J?q:J:K<J?K:J,u=me<Ce?me<Oe?me:Oe:Ce<Oe?Ce:Oe,p=q>K?q>J?q:J:K>J?K:J,S=me>Ce?me>Oe?me:Oe:Ce>Oe?Ce:Oe,L=M.next;L!==h;){if(L.x>=f&&L.x<=p&&L.y>=u&&L.y<=S&&yA(q,me,K,Ce,J,Oe,L.x,L.y)&&Po(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function Q0(m,h,x,M){var q=m.prev,K=m,J=m.next;if(Po(q,K,J)>=0)return!1;for(var me=q.x,Ce=K.x,Oe=J.x,f=q.y,u=K.y,p=J.y,S=me<Ce?me<Oe?me:Oe:Ce<Oe?Ce:Oe,L=f<u?f<p?f:p:u<p?u:p,U=me>Ce?me>Oe?me:Oe:Ce>Oe?Ce:Oe,Q=f>u?f>p?f:p:u>p?u:p,re=ac(S,L,h,x,M),Ae=ac(U,Q,h,x,M),_e=m.prevZ,Le=m.nextZ;_e&&_e.z>=re&&Le&&Le.z<=Ae;){if(_e.x>=S&&_e.x<=U&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&yA(me,f,Ce,u,Oe,p,_e.x,_e.y)&&Po(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,Le.x>=S&&Le.x<=U&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&yA(me,f,Ce,u,Oe,p,Le.x,Le.y)&&Po(Le.prev,Le,Le.next)>=0))return!1;Le=Le.nextZ}for(;_e&&_e.z>=re;){if(_e.x>=S&&_e.x<=U&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&yA(me,f,Ce,u,Oe,p,_e.x,_e.y)&&Po(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Le&&Le.z<=Ae;){if(Le.x>=S&&Le.x<=U&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&yA(me,f,Ce,u,Oe,p,Le.x,Le.y)&&Po(Le.prev,Le,Le.next)>=0)return!1;Le=Le.nextZ}return!0}function bh(m,h,x){var M=m;do{var q=M.prev,K=M.next.next;!df(q,K)&&xp(q,M,M.next,K)&&xl(q,K)&&xl(K,q)&&(h.push(q.i/x|0),h.push(M.i/x|0),h.push(K.i/x|0),gf(M),gf(M.next),M=m=K),M=M.next}while(M!==m);return Jc(M)}function Cm(m,h,x,M,q,K){var J=m;do{for(var me=J.next.next;me!==J.prev;){if(J.i!==me.i&&Tm(J,me)){var Ce=oc(J,me);return J=Jc(J,J.next),Ce=Jc(Ce,Ce.next),Zh(J,h,x,M,q,K,0),void Zh(Ce,h,x,M,q,K,0)}me=me.next}J=J.next}while(J!==m)}function Ec(m,h){return m.x-h.x}function Af(m,h){var x=function(q,K){var J,me=K,Ce=q.x,Oe=q.y,f=-1/0;do{if(Oe<=me.y&&Oe>=me.next.y&&me.next.y!==me.y){var u=me.x+(Oe-me.y)*(me.next.x-me.x)/(me.next.y-me.y);if(u<=Ce&&u>f&&(f=u,J=me.x<me.next.x?me:me.next,u===Ce))return J}me=me.next}while(me!==K);if(!J)return null;var p,S=J,L=J.x,U=J.y,Q=1/0;me=J;do Ce>=me.x&&me.x>=L&&Ce!==me.x&&yA(Oe<U?Ce:f,Oe,L,U,Oe<U?f:Ce,Oe,me.x,me.y)&&(p=Math.abs(Oe-me.y)/(Ce-me.x),xl(me,q)&&(p<Q||p===Q&&(me.x>J.x||me.x===J.x&&W0(J,me)))&&(J=me,Q=p)),me=me.next;while(me!==S);return J}(m,h);if(!x)return h;var M=oc(x,m);return Jc(M,M.next),Jc(x,x.next)}function W0(m,h){return Po(m.prev,m,h.prev)<0&&Po(h.next,m,m.next)<0}function ac(m,h,x,M,q){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=(m-x)*q|0)|m<<8))|m<<4))|m<<2))|m<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-M)*q|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function ff(m){var h=m,x=m;do(h.x<x.x||h.x===x.x&&h.y<x.y)&&(x=h),h=h.next;while(h!==m);return x}function yA(m,h,x,M,q,K,J,me){return(q-J)*(h-me)>=(m-J)*(K-me)&&(m-J)*(M-me)>=(x-J)*(h-me)&&(x-J)*(K-me)>=(q-J)*(M-me)}function Tm(m,h){return m.next.i!==h.i&&m.prev.i!==h.i&&!function(x,M){var q=x;do{if(q.i!==x.i&&q.next.i!==x.i&&q.i!==M.i&&q.next.i!==M.i&&xp(q,q.next,x,M))return!0;q=q.next}while(q!==x);return!1}(m,h)&&(xl(m,h)&&xl(h,m)&&function(x,M){var q=x,K=!1,J=(x.x+M.x)/2,me=(x.y+M.y)/2;do q.y>me!=q.next.y>me&&q.next.y!==q.y&&J<(q.next.x-q.x)*(me-q.y)/(q.next.y-q.y)+q.x&&(K=!K),q=q.next;while(q!==x);return K}(m,h)&&(Po(m.prev,m,h.prev)||Po(m,h.prev,h))||df(m,h)&&Po(m.prev,m,m.next)>0&&Po(h.prev,h,h.next)>0)}function Po(m,h,x){return(h.y-m.y)*(x.x-h.x)-(h.x-m.x)*(x.y-h.y)}function df(m,h){return m.x===h.x&&m.y===h.y}function xp(m,h,x,M){var q=mf(Po(m,h,x)),K=mf(Po(m,h,M)),J=mf(Po(x,M,m)),me=mf(Po(x,M,h));return q!==K&&J!==me||!(q!==0||!pf(m,x,h))||!(K!==0||!pf(m,M,h))||!(J!==0||!pf(x,m,M))||!(me!==0||!pf(x,h,M))}function pf(m,h,x){return h.x<=Math.max(m.x,x.x)&&h.x>=Math.min(m.x,x.x)&&h.y<=Math.max(m.y,x.y)&&h.y>=Math.min(m.y,x.y)}function mf(m){return m>0?1:m<0?-1:0}function xl(m,h){return Po(m.prev,m,m.next)<0?Po(m,h,m.next)>=0&&Po(m,m.prev,h)>=0:Po(m,h,m.prev)<0||Po(m,m.next,h)<0}function oc(m,h){var x=new Da(m.i,m.x,m.y),M=new Da(h.i,h.x,h.y),q=m.next,K=h.prev;return m.next=h,h.prev=m,x.next=q,q.prev=x,M.next=x,x.prev=M,K.next=M,M.prev=K,M}function Qh(m,h,x,M){var q=new Da(m,h,x);return M?(q.next=M.next,q.prev=M,M.next.prev=q,M.next=q):(q.prev=q,q.next=q),q}function gf(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function Da(m,h,x){this.i=m,this.x=h,this.y=x,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lc(m,h,x,M){for(var q=0,K=h,J=x-M;K<x;K+=M)q+=(m[J]-m[K])*(m[K+1]+m[J+1]),J=K;return q}xh.exports=Ll,xh.exports.default=Ll,Ll.deviation=function(m,h,x,M){var q=h&&h.length,K=Math.abs(lc(m,0,q?h[0]*x:m.length,x));if(q)for(var J=0,me=h.length;J<me;J++)K-=Math.abs(lc(m,h[J]*x,J<me-1?h[J+1]*x:m.length,x));var Ce=0;for(J=0;J<M.length;J+=3){var Oe=M[J]*x,f=M[J+1]*x,u=M[J+2]*x;Ce+=Math.abs((m[Oe]-m[u])*(m[f+1]-m[Oe+1])-(m[Oe]-m[f])*(m[u+1]-m[Oe+1]))}return K===0&&Ce===0?0:Math.abs((Ce-K)/K)},Ll.flatten=function(m){for(var h=m[0][0].length,x={vertices:[],holes:[],dimensions:h},M=0,q=0;q<m.length;q++){for(var K=0;K<m[q].length;K++)for(var J=0;J<h;J++)x.vertices.push(m[q][K][J]);q>0&&x.holes.push(M+=m[q-1].length)}return x};var f0=G(xh.exports);function _f(m,h,x,M,q){yf(m,h,x||0,M||m.length-1,q||Wh)}function yf(m,h,x,M,q){for(;M>x;){if(M-x>600){var K=M-x+1,J=h-x+1,me=Math.log(K),Ce=.5*Math.exp(2*me/3),Oe=.5*Math.sqrt(me*Ce*(K-Ce)/K)*(J-K/2<0?-1:1);yf(m,h,Math.max(x,Math.floor(h-J*Ce/K+Oe)),Math.min(M,Math.floor(h+(K-J)*Ce/K+Oe)),q)}var f=m[h],u=x,p=M;for(Cc(m,x,h),q(m[M],f)>0&&Cc(m,x,M);u<p;){for(Cc(m,u,p),u++,p--;q(m[u],f)<0;)u++;for(;q(m[p],f)>0;)p--}q(m[x],f)===0?Cc(m,x,p):Cc(m,++p,M),p<=h&&(x=p+1),h<=p&&(M=p-1)}}function Cc(m,h,x){var M=m[h];m[h]=m[x],m[x]=M}function Wh(m,h){return m<h?-1:m>h?1:0}function wh(m,h){const x=m.length;if(x<=1)return[m];const M=[];let q,K;for(let J=0;J<x;J++){const me=mt(m[J]);me!==0&&(m[J].area=Math.abs(me),K===void 0&&(K=me<0),K===me<0?(q&&M.push(q),q=[m[J]]):q.push(m[J]))}if(q&&M.push(q),h>1)for(let J=0;J<M.length;J++)M[J].length<=h||(_f(M[J],h,1,M[J].length-1,vf),M[J]=M[J].slice(0,h));return M}function vf(m,h){return h.area-m.area}function vA(m,h,x){const M=x.patternDependencies;let q=!1;for(const K of h){const J=K.paint.get(`${m}-pattern`);J.isConstant()||(q=!0);const me=J.constantOr(null);me&&(q=!0,M[me.to]=!0,M[me.from]=!0)}return q}function xA(m,h,x,M,q){const K=q.patternDependencies;for(const J of h){const me=J.paint.get(`${m}-pattern`).value;if(me.kind!=="constant"){let Ce=me.evaluate({zoom:M-1},x,{},q.availableImages),Oe=me.evaluate({zoom:M},x,{},q.availableImages),f=me.evaluate({zoom:M+1},x,{},q.availableImages);Ce=Ce&&Ce.name?Ce.name:Ce,Oe=Oe&&Oe.name?Oe.name:Oe,f=f&&f.name?f.name:f,K[Ce]=!0,K[Oe]=!0,K[f]=!0,x.patterns[J.id]={min:Ce,mid:Oe,max:f}}}return x}class Xh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Te,this.indexArray=new Yt,this.indexArray2=new ei,this.programConfigurations=new No(h.layers,h.zoom),this.segments=new Qi,this.segments2=new Qi,this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){this.hasPattern=vA("fill",this.layers,x);const q=this.layers[0].layout.get("fill-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Oe,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),p,M))continue;const S=K?q.evaluate(p,{},M,x.availableImages):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Oe,geometry:u?p.geometry:il(me),patterns:{},sortKey:S};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Oe,sourceLayerIndex:f}=me;if(this.hasPattern){const u=xA("fill",this.layers,me,this.zoom,x);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Oe,M,{});x.featureIndex.insert(h[Oe].feature,Ce,Oe,f,this.index)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}addFeatures(h,x,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,x,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,hf),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,x,M,q,K){for(const J of wh(x,500)){let me=0;for(const S of J)me+=S.length;const Ce=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray),Oe=Ce.vertexLength,f=[],u=[];for(const S of J){if(S.length===0)continue;S!==J[0]&&u.push(f.length/2);const L=this.segments2.prepareSegment(S.length,this.layoutVertexArray,this.indexArray2),U=L.vertexLength;this.layoutVertexArray.emplaceBack(S[0].x,S[0].y),this.indexArray2.emplaceBack(U+S.length-1,U),f.push(S[0].x),f.push(S[0].y);for(let Q=1;Q<S.length;Q++)this.layoutVertexArray.emplaceBack(S[Q].x,S[Q].y),this.indexArray2.emplaceBack(U+Q-1,U+Q),f.push(S[Q].x),f.push(S[Q].y);L.vertexLength+=S.length,L.primitiveLength+=S.length}const p=f0(f,u);for(let S=0;S<p.length;S+=3)this.indexArray.emplaceBack(Oe+p[S],Oe+p[S+1],Oe+p[S+2]);Ce.vertexLength+=me,Ce.primitiveLength+=p.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}let X0,bA;Sn("FillBucket",Xh,{omit:["layers","patternFeatures"]});var Yh={get paint(){return bA=bA||new oa({"fill-antialias":new gn(ii.paint_fill["fill-antialias"]),"fill-opacity":new jn(ii.paint_fill["fill-opacity"]),"fill-color":new jn(ii.paint_fill["fill-color"]),"fill-outline-color":new jn(ii.paint_fill["fill-outline-color"]),"fill-translate":new gn(ii.paint_fill["fill-translate"]),"fill-translate-anchor":new gn(ii.paint_fill["fill-translate-anchor"]),"fill-pattern":new Jn(ii.paint_fill["fill-pattern"])})},get layout(){return X0=X0||new oa({"fill-sort-key":new jn(ii.layout_fill["fill-sort-key"])})}};class d0 extends vs{constructor(h){super(h,Yh)}recalculate(h,x){super.recalculate(h,x);const M=this.paint._values["fill-outline-color"];M.value.kind==="constant"&&M.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new Xh(h)}queryRadius(){return of(this.paint.get("fill-translate"))}queryIntersectsFeature(h,x,M,q,K,J,me){return Pa(Yc(h,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),J.angle,me),q)}isTileClipped(){return!0}}const Y0=xs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),bp=xs([{name:"a_centroid",components:2,type:"Int16"}],4),{members:wA}=Y0;var uc={},xf=W,$0=Sh;function Sh(m,h,x,M,q){this.properties={},this.extent=x,this.type=0,this._pbf=m,this._geometry=-1,this._keys=M,this._values=q,m.readFields(eh,this,h)}function eh(m,h,x){m==1?h.id=x.readVarint():m==2?function(M,q){for(var K=M.readVarint()+M.pos;M.pos<K;){var J=q._keys[M.readVarint()],me=q._values[M.readVarint()];q.properties[J]=me}}(x,h):m==3?h.type=x.readVarint():m==4&&(h._geometry=x.pos)}function wp(m){for(var h,x,M=0,q=0,K=m.length,J=K-1;q<K;J=q++)M+=((x=m[J]).x-(h=m[q]).x)*(h.y+x.y);return M}Sh.types=["Unknown","Point","LineString","Polygon"],Sh.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,x=m.readVarint()+m.pos,M=1,q=0,K=0,J=0,me=[];m.pos<x;){if(q<=0){var Ce=m.readVarint();M=7&Ce,q=Ce>>3}if(q--,M===1||M===2)K+=m.readSVarint(),J+=m.readSVarint(),M===1&&(h&&me.push(h),h=[]),h.push(new xf(K,J));else{if(M!==7)throw new Error("unknown command "+M);h&&h.push(h[0].clone())}}return h&&me.push(h),me},Sh.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,x=1,M=0,q=0,K=0,J=1/0,me=-1/0,Ce=1/0,Oe=-1/0;m.pos<h;){if(M<=0){var f=m.readVarint();x=7&f,M=f>>3}if(M--,x===1||x===2)(q+=m.readSVarint())<J&&(J=q),q>me&&(me=q),(K+=m.readSVarint())<Ce&&(Ce=K),K>Oe&&(Oe=K);else if(x!==7)throw new Error("unknown command "+x)}return[J,Ce,me,Oe]},Sh.prototype.toGeoJSON=function(m,h,x){var M,q,K=this.extent*Math.pow(2,x),J=this.extent*m,me=this.extent*h,Ce=this.loadGeometry(),Oe=Sh.types[this.type];function f(S){for(var L=0;L<S.length;L++){var U=S[L];S[L]=[360*(U.x+J)/K-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+me)/K)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(M=0;M<Ce.length;M++)u[M]=Ce[M][0];f(Ce=u);break;case 2:for(M=0;M<Ce.length;M++)f(Ce[M]);break;case 3:for(Ce=function(S){var L=S.length;if(L<=1)return[S];for(var U,Q,re=[],Ae=0;Ae<L;Ae++){var _e=wp(S[Ae]);_e!==0&&(Q===void 0&&(Q=_e<0),Q===_e<0?(U&&re.push(U),U=[S[Ae]]):U.push(S[Ae]))}return U&&re.push(U),re}(Ce),M=0;M<Ce.length;M++)for(q=0;q<Ce[M].length;q++)f(Ce[M][q])}Ce.length===1?Ce=Ce[0]:Oe="Multi"+Oe;var p={type:"Feature",geometry:{type:Oe,coordinates:Ce},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Sp=$0,Ip=K0;function K0(m,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=m,this._keys=[],this._values=[],this._features=[],m.readFields(Ih,this,h),this.length=this._features.length}function Ih(m,h,x){m===15?h.version=x.readVarint():m===1?h.name=x.readString():m===5?h.extent=x.readVarint():m===2?h._features.push(x.pos):m===3?h._keys.push(x.readString()):m===4&&h._values.push(function(M){for(var q=null,K=M.readVarint()+M.pos;M.pos<K;){var J=M.readVarint()>>3;q=J===1?M.readString():J===2?M.readFloat():J===3?M.readDouble():J===4?M.readVarint64():J===5?M.readVarint():J===6?M.readSVarint():J===7?M.readBoolean():null}return q}(x))}K0.prototype.feature=function(m){if(m<0||m>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[m];var h=this._pbf.readVarint()+this._pbf.pos;return new Sp(this._pbf,h,this.extent,this._keys,this._values)};var km=Ip;function Tc(m,h,x){if(m===3){var M=new km(x,x.readVarint()+x.pos);M.length&&(h[M.name]=M)}}uc.VectorTile=function(m,h){this.layers=m.readFields(Tc,{},h)},uc.VectorTileFeature=$0,uc.VectorTileLayer=Ip;const Eh=uc.VectorTileFeature.types,bf=Math.pow(2,13);function $h(m,h,x,M,q,K,J,me){m.emplaceBack(h,x,2*Math.floor(M*bf)+J,q*bf*2,K*bf*2,Math.round(me))}class SA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Re,this.centroidVertexArray=new ce,this.indexArray=new Yt,this.programConfigurations=new No(h.layers,h.zoom),this.segments=new Qi,this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){this.features=[],this.hasPattern=vA("fill-extrusion",this.layers,x);for(const{feature:q,id:K,index:J,sourceLayerIndex:me}of h){const Ce=this.layers[0]._featureFilter.needGeometry,Oe=vl(q,Ce);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),Oe,M))continue;const f={id:K,sourceLayerIndex:me,index:J,geometry:Ce?Oe.geometry:il(q),properties:q.properties,type:q.type,patterns:{}};this.hasPattern?this.features.push(xA("fill-extrusion",this.layers,f,this.zoom,x)):this.addFeature(f,f.geometry,J,M,{}),x.featureIndex.insert(q,f.geometry,J,me,this.index,!0)}}addFeatures(h,x,M){for(const q of this.features){const{geometry:K}=q;this.addFeature(q,K,q.index,x,M)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,wA),this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,bp.members,!0),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(h,x,M,q,K){const J={x:0,y:0,vertexCount:0};for(const me of wh(x,500)){let Ce=0;for(const L of me)Ce+=L.length;let Oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const L of me){if(L.length===0||Ir(L))continue;let U=0;for(let Q=0;Q<L.length;Q++){const re=L[Q];if(Q>=1){const Ae=L[Q-1];if(!Kh(re,Ae)){Oe.vertexLength+4>Qi.MAX_VERTEX_ARRAY_LENGTH&&(Oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const _e=re.sub(Ae)._perp()._unit(),Le=Ae.dist(re);U+Le>32768&&(U=0),$h(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,0,U),$h(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,1,U),J.x+=2*re.x,J.y+=2*re.y,J.vertexCount+=2,U+=Le,$h(this.layoutVertexArray,Ae.x,Ae.y,_e.x,_e.y,0,0,U),$h(this.layoutVertexArray,Ae.x,Ae.y,_e.x,_e.y,0,1,U),J.x+=2*Ae.x,J.y+=2*Ae.y,J.vertexCount+=2;const qe=Oe.vertexLength;this.indexArray.emplaceBack(qe,qe+2,qe+1),this.indexArray.emplaceBack(qe+1,qe+2,qe+3),Oe.vertexLength+=4,Oe.primitiveLength+=2}}}}if(Oe.vertexLength+Ce>Qi.MAX_VERTEX_ARRAY_LENGTH&&(Oe=this.segments.prepareSegment(Ce,this.layoutVertexArray,this.indexArray)),Eh[h.type]!=="Polygon")continue;const f=[],u=[],p=Oe.vertexLength;for(const L of me)if(L.length!==0){L!==me[0]&&u.push(f.length/2);for(let U=0;U<L.length;U++){const Q=L[U];$h(this.layoutVertexArray,Q.x,Q.y,0,0,1,1,0),J.x+=Q.x,J.y+=Q.y,J.vertexCount+=1,f.push(Q.x),f.push(Q.y)}}const S=f0(f,u);for(let L=0;L<S.length;L+=3)this.indexArray.emplaceBack(p+S[L],p+S[L+2],p+S[L+1]);Oe.primitiveLength+=S.length/3,Oe.vertexLength+=Ce}for(let me=0;me<J.vertexCount;me++)this.centroidVertexArray.emplaceBack(Math.floor(J.x/J.vertexCount),Math.floor(J.y/J.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}function Kh(m,h){return m.x===h.x&&(m.x<0||m.x>Ws)||m.y===h.y&&(m.y<0||m.y>Ws)}function Ir(m){return m.every(h=>h.x<0)||m.every(h=>h.x>Ws)||m.every(h=>h.y<0)||m.every(h=>h.y>Ws)}let wf;Sn("FillExtrusionBucket",SA,{omit:["layers","features"]});var J0={get paint(){return wf=wf||new oa({"fill-extrusion-opacity":new gn(ii["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jn(ii["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gn(ii["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gn(ii["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Jn(ii["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jn(ii["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jn(ii["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gn(ii["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Jh extends vs{constructor(h){super(h,J0)}createBucket(h){return new SA(h)}queryRadius(){return of(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(h,x,M,q,K,J,me,Ce){const Oe=Yc(h,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),J.angle,me),f=this.paint.get("fill-extrusion-height").evaluate(x,M),u=this.paint.get("fill-extrusion-base").evaluate(x,M),p=function(L,U,Q,re){const Ae=[];for(const _e of L){const Le=[_e.x,_e.y,0,1];uf(Le,Le,U),Ae.push(new ae(Le[0]/Le[3],Le[1]/Le[3]))}return Ae}(Oe,Ce),S=function(L,U,Q,re){const Ae=[],_e=[],Le=re[8]*U,qe=re[9]*U,et=re[10]*U,At=re[11]*U,_t=re[8]*Q,Mt=re[9]*Q,Dt=re[10]*Q,Bt=re[11]*Q;for(const Kt of L){const Ht=[],Zt=[];for(const ci of Kt){const yi=ci.x,Xi=ci.y,xn=re[0]*yi+re[4]*Xi+re[12],on=re[1]*yi+re[5]*Xi+re[13],an=re[2]*yi+re[6]*Xi+re[14],An=re[3]*yi+re[7]*Xi+re[15],zn=an+et,sn=An+At,Wi=xn+_t,Dn=on+Mt,Rn=an+Dt,pr=An+Bt,Vr=new ae((xn+Le)/sn,(on+qe)/sn);Vr.z=zn/sn,Ht.push(Vr);const Hr=new ae(Wi/pr,Dn/pr);Hr.z=Rn/pr,Zt.push(Hr)}Ae.push(Ht),_e.push(Zt)}return[Ae,_e]}(q,u,f,Ce);return function(L,U,Q){let re=1/0;Pa(Q,U)&&(re=IA(Q,U[0]));for(let Ae=0;Ae<U.length;Ae++){const _e=U[Ae],Le=L[Ae];for(let qe=0;qe<_e.length-1;qe++){const et=_e[qe],At=[et,_e[qe+1],Le[qe+1],Le[qe],et];af(Q,At)&&(re=Math.min(re,IA(Q,At)))}}return re!==1/0&&re}(S[0],S[1],p)}}function Sf(m,h){return m.x*h.x+m.y*h.y}function IA(m,h){if(m.length===1){let x=0;const M=h[x++];let q;for(;!q||M.equals(q);)if(q=h[x++],!q)return 1/0;for(;x<h.length;x++){const K=h[x],J=m[0],me=q.sub(M),Ce=K.sub(M),Oe=J.sub(M),f=Sf(me,me),u=Sf(me,Ce),p=Sf(Ce,Ce),S=Sf(Oe,me),L=Sf(Oe,Ce),U=f*p-u*u,Q=(p*S-u*L)/U,re=(f*L-u*S)/U,Ae=M.z*(1-Q-re)+q.z*Q+K.z*re;if(isFinite(Ae))return Ae}return 1/0}{let x=1/0;for(const M of h)x=Math.min(x,M.z);return x}}const EA=xs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ul}=EA,Mm=xs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Pm}=Mm,ed=uc.VectorTileFeature.types,Dm=Math.cos(Math.PI/180*37.5),td=Math.pow(2,14)/.5;class eA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(x=>{this.gradients[x.id]={}}),this.layoutVertexArray=new Be,this.layoutVertexArray2=new Je,this.indexArray=new Yt,this.programConfigurations=new No(h.layers,h.zoom),this.segments=new Qi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){this.hasPattern=vA("line",this.layers,x);const q=this.layers[0].layout.get("line-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Oe,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),p,M))continue;const S=K?q.evaluate(p,{},M):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Oe,geometry:u?p.geometry:il(me),patterns:{},sortKey:S};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Oe,sourceLayerIndex:f}=me;if(this.hasPattern){const u=xA("line",this.layers,me,this.zoom,x);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Oe,M,{});x.featureIndex.insert(h[Oe].feature,Ce,Oe,f,this.index)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}addFeatures(h,x,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,x,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,Pm)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Ul),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,x,M,q,K){const J=this.layers[0].layout,me=J.get("line-join").evaluate(h,{}),Ce=J.get("line-cap"),Oe=J.get("line-miter-limit"),f=J.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const u of x)this.addLine(u,h,me,Ce,Oe,f);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}addLine(h,x,M,q,K,J){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<h.length-1;re++)this.totalDistance+=h[re].dist(h[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const me=ed[x.type]==="Polygon";let Ce=h.length;for(;Ce>=2&&h[Ce-1].equals(h[Ce-2]);)Ce--;let Oe=0;for(;Oe<Ce-1&&h[Oe].equals(h[Oe+1]);)Oe++;if(Ce<(me?3:2))return;M==="bevel"&&(K=1.05);const f=this.overscaling<=16?15*Ws/(512*this.overscaling):0,u=this.segments.prepareSegment(10*Ce,this.layoutVertexArray,this.indexArray);let p,S,L,U,Q;this.e1=this.e2=-1,me&&(p=h[Ce-2],Q=h[Oe].sub(p)._unit()._perp());for(let re=Oe;re<Ce;re++){if(L=re===Ce-1?me?h[Oe+1]:void 0:h[re+1],L&&h[re].equals(L))continue;Q&&(U=Q),p&&(S=p),p=h[re],Q=L?L.sub(p)._unit()._perp():U,U=U||Q;let Ae=U.add(Q);Ae.x===0&&Ae.y===0||Ae._unit();const _e=U.x*Q.x+U.y*Q.y,Le=Ae.x*Q.x+Ae.y*Q.y,qe=Le!==0?1/Le:1/0,et=2*Math.sqrt(2-2*Le),At=Le<Dm&&S&&L,_t=U.x*Q.y-U.y*Q.x>0;if(At&&re>Oe){const Bt=p.dist(S);if(Bt>2*f){const Kt=p.sub(p.sub(S)._mult(f/Bt)._round());this.updateDistance(S,Kt),this.addCurrentVertex(Kt,U,0,0,u),S=Kt}}const Mt=S&&L;let Dt=Mt?M:me?"butt":q;if(Mt&&Dt==="round"&&(qe<J?Dt="miter":qe<=2&&(Dt="fakeround")),Dt==="miter"&&qe>K&&(Dt="bevel"),Dt==="bevel"&&(qe>2&&(Dt="flipbevel"),qe<K&&(Dt="miter")),S&&this.updateDistance(S,p),Dt==="miter")Ae._mult(qe),this.addCurrentVertex(p,Ae,0,0,u);else if(Dt==="flipbevel"){if(qe>100)Ae=Q.mult(-1);else{const Bt=qe*U.add(Q).mag()/U.sub(Q).mag();Ae._perp()._mult(Bt*(_t?-1:1))}this.addCurrentVertex(p,Ae,0,0,u),this.addCurrentVertex(p,Ae.mult(-1),0,0,u)}else if(Dt==="bevel"||Dt==="fakeround"){const Bt=-Math.sqrt(qe*qe-1),Kt=_t?Bt:0,Ht=_t?0:Bt;if(S&&this.addCurrentVertex(p,U,Kt,Ht,u),Dt==="fakeround"){const Zt=Math.round(180*et/Math.PI/20);for(let ci=1;ci<Zt;ci++){let yi=ci/Zt;if(yi!==.5){const xn=yi-.5;yi+=yi*xn*(yi-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*xn*xn+(.848013+_e*(.215638*_e-1.06021)))}const Xi=Q.sub(U)._mult(yi)._add(U)._unit()._mult(_t?-1:1);this.addHalfVertex(p,Xi.x,Xi.y,!1,_t,0,u)}}L&&this.addCurrentVertex(p,Q,-Kt,-Ht,u)}else if(Dt==="butt")this.addCurrentVertex(p,Ae,0,0,u);else if(Dt==="square"){const Bt=S?1:-1;this.addCurrentVertex(p,Ae,Bt,Bt,u)}else Dt==="round"&&(S&&(this.addCurrentVertex(p,U,0,0,u),this.addCurrentVertex(p,U,1,1,u,!0)),L&&(this.addCurrentVertex(p,Q,-1,-1,u,!0),this.addCurrentVertex(p,Q,0,0,u)));if(At&&re<Ce-1){const Bt=p.dist(L);if(Bt>2*f){const Kt=p.add(L.sub(p)._mult(f/Bt)._round());this.updateDistance(p,Kt),this.addCurrentVertex(Kt,Q,0,0,u),p=Kt}}}}addCurrentVertex(h,x,M,q,K,J=!1){const me=x.y*q-x.x,Ce=-x.y-x.x*q;this.addHalfVertex(h,x.x+x.y*M,x.y-x.x*M,J,!1,M,K),this.addHalfVertex(h,me,Ce,J,!0,-q,K),this.distance>td/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(h,x,M,q,K,J))}addHalfVertex({x:h,y:x},M,q,K,J,me,Ce){const Oe=.5*(this.lineClips?this.scaledDistance*(td-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h<<1)+(K?1:0),(x<<1)+(J?1:0),Math.round(63*M)+128,Math.round(63*q)+128,1+(me===0?0:me<0?-1:1)|(63&Oe)<<2,Oe>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const f=Ce.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,f),Ce.primitiveLength++),J?this.e2=f:this.e1=f}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(h,x){this.distance+=h.dist(x),this.updateScaledDistance()}}let id,Ep;Sn("LineBucket",eA,{omit:["layers","patternFeatures"]});var kc={get paint(){return Ep=Ep||new oa({"line-opacity":new jn(ii.paint_line["line-opacity"]),"line-color":new jn(ii.paint_line["line-color"]),"line-translate":new gn(ii.paint_line["line-translate"]),"line-translate-anchor":new gn(ii.paint_line["line-translate-anchor"]),"line-width":new jn(ii.paint_line["line-width"]),"line-gap-width":new jn(ii.paint_line["line-gap-width"]),"line-offset":new jn(ii.paint_line["line-offset"]),"line-blur":new jn(ii.paint_line["line-blur"]),"line-dasharray":new tl(ii.paint_line["line-dasharray"]),"line-pattern":new Jn(ii.paint_line["line-pattern"]),"line-gradient":new Tu(ii.paint_line["line-gradient"])})},get layout(){return id=id||new oa({"line-cap":new gn(ii.layout_line["line-cap"]),"line-join":new jn(ii.layout_line["line-join"]),"line-miter-limit":new gn(ii.layout_line["line-miter-limit"]),"line-round-limit":new gn(ii.layout_line["line-round-limit"]),"line-sort-key":new jn(ii.layout_line["line-sort-key"])})}};class bu extends jn{possiblyEvaluate(h,x){return x=new fs(Math.floor(x.zoom),{now:x.now,fadeDuration:x.fadeDuration,zoomHistory:x.zoomHistory,transition:x.transition}),super.possiblyEvaluate(h,x)}evaluate(h,x,M,q){return x=Xt({},x,{zoom:Math.floor(x.zoom)}),super.evaluate(h,x,M,q)}}let CA;class Lm extends vs{constructor(h){super(h,kc),this.gradientVersion=0,CA||(CA=new bu(kc.paint.properties["line-width"].specification),CA.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const x=this.gradientExpression();this.stepInterpolant=!!function(M){return M._styleExpression!==void 0}(x)&&x._styleExpression.expression instanceof qa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,x){super.recalculate(h,x),this.paint._values["line-floorwidth"]=CA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new eA(h)}queryRadius(h){const x=h,M=p0(qh("line-width",this,x),qh("line-gap-width",this,x)),q=qh("line-offset",this,x);return M/2+Math.abs(q)+of(this.paint.get("line-translate"))}queryIntersectsFeature(h,x,M,q,K,J,me){const Ce=Yc(h,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),J.angle,me),Oe=me/2*p0(this.paint.get("line-width").evaluate(x,M),this.paint.get("line-gap-width").evaluate(x,M)),f=this.paint.get("line-offset").evaluate(x,M);return f&&(q=function(u,p){const S=[];for(let L=0;L<u.length;L++){const U=u[L],Q=[];for(let re=0;re<U.length;re++){const Ae=U[re-1],_e=U[re],Le=U[re+1],qe=re===0?new ae(0,0):_e.sub(Ae)._unit()._perp(),et=re===U.length-1?new ae(0,0):Le.sub(_e)._unit()._perp(),At=qe._add(et)._unit(),_t=At.x*et.x+At.y*et.y;_t!==0&&At._mult(1/_t),Q.push(At._mult(p)._add(_e))}S.push(Q)}return S}(q,f*me)),function(u,p,S){for(let L=0;L<p.length;L++){const U=p[L];if(u.length>=3){for(let Q=0;Q<U.length;Q++)if(Xc(u,U[Q]))return!0}if(pA(u,U,S))return!0}return!1}(Ce,q,Oe)}isTileClipped(){return!0}}function p0(m,h){return h>0?h+2*m:m}const Cp=xs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nd=xs([{name:"a_projected_pos",components:3,type:"Float32"}],4);xs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const TA=xs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);xs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const m0=xs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),rd=xs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Bm(m,h,x){return m.sections.forEach(M=>{M.text=function(q,K,J){const me=K.layout.get("text-transform").evaluate(J,{});return me==="uppercase"?q=q.toLocaleUpperCase():me==="lowercase"&&(q=q.toLocaleLowerCase()),jl.applyArabicShaping&&(q=jl.applyArabicShaping(q)),q}(M.text,h,x)}),m}xs([{name:"triangle",components:3,type:"Uint16"}]),xs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),xs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),xs([{type:"Float32",name:"offsetX"}]),xs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),xs([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ch={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Al=24,sd=fa,ad=function(m,h,x,M,q){var K,J,me=8*q-M-1,Ce=(1<<me)-1,Oe=Ce>>1,f=-7,u=x?q-1:0,p=x?-1:1,S=m[h+u];for(u+=p,K=S&(1<<-f)-1,S>>=-f,f+=me;f>0;K=256*K+m[h+u],u+=p,f-=8);for(J=K&(1<<-f)-1,K>>=-f,f+=M;f>0;J=256*J+m[h+u],u+=p,f-=8);if(K===0)K=1-Oe;else{if(K===Ce)return J?NaN:1/0*(S?-1:1);J+=Math.pow(2,M),K-=Oe}return(S?-1:1)*J*Math.pow(2,K-M)},od=function(m,h,x,M,q,K){var J,me,Ce,Oe=8*K-q-1,f=(1<<Oe)-1,u=f>>1,p=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=M?0:K-1,L=M?1:-1,U=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(me=isNaN(h)?1:0,J=f):(J=Math.floor(Math.log(h)/Math.LN2),h*(Ce=Math.pow(2,-J))<1&&(J--,Ce*=2),(h+=J+u>=1?p/Ce:p*Math.pow(2,1-u))*Ce>=2&&(J++,Ce/=2),J+u>=f?(me=0,J=f):J+u>=1?(me=(h*Ce-1)*Math.pow(2,q),J+=u):(me=h*Math.pow(2,u-1)*Math.pow(2,q),J=0));q>=8;m[x+S]=255&me,S+=L,me/=256,q-=8);for(J=J<<q|me,Oe+=q;Oe>0;m[x+S]=255&J,S+=L,J/=256,Oe-=8);m[x+S-L]|=128*U};function fa(m){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(m)?m:new Uint8Array(m||0),this.pos=0,this.type=0,this.length=this.buf.length}fa.Varint=0,fa.Fixed64=1,fa.Bytes=2,fa.Fixed32=5;var kA=4294967296,ld=1/kA,MA=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function wu(m){return m.type===fa.Bytes?m.readVarint()+m.pos:m.pos+1}function Ya(m,h,x){return x?4294967296*h+(m>>>0):4294967296*(h>>>0)+(m>>>0)}function g0(m,h,x){var M=h<=16383?1:h<=2097151?2:h<=268435455?3:Math.floor(Math.log(h)/(7*Math.LN2));x.realloc(M);for(var q=x.pos-1;q>=m;q--)x.buf[q+M]=x.buf[q]}function If(m,h){for(var x=0;x<m.length;x++)h.writeVarint(m[x])}function ud(m,h){for(var x=0;x<m.length;x++)h.writeSVarint(m[x])}function ms(m,h){for(var x=0;x<m.length;x++)h.writeFloat(m[x])}function th(m,h){for(var x=0;x<m.length;x++)h.writeDouble(m[x])}function Tp(m,h){for(var x=0;x<m.length;x++)h.writeBoolean(m[x])}function cd(m,h){for(var x=0;x<m.length;x++)h.writeFixed32(m[x])}function ih(m,h){for(var x=0;x<m.length;x++)h.writeSFixed32(m[x])}function PA(m,h){for(var x=0;x<m.length;x++)h.writeFixed64(m[x])}function kp(m,h){for(var x=0;x<m.length;x++)h.writeSFixed64(m[x])}function _0(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+16777216*m[h+3]}function DA(m,h,x){m[x]=h,m[x+1]=h>>>8,m[x+2]=h>>>16,m[x+3]=h>>>24}function Mp(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+(m[h+3]<<24)}fa.prototype={destroy:function(){this.buf=null},readFields:function(m,h,x){for(x=x||this.length;this.pos<x;){var M=this.readVarint(),q=M>>3,K=this.pos;this.type=7&M,m(q,h,this),this.pos===K&&this.skip(M)}return h},readMessage:function(m,h){return this.readFields(m,h,this.readVarint()+this.pos)},readFixed32:function(){var m=_0(this.buf,this.pos);return this.pos+=4,m},readSFixed32:function(){var m=Mp(this.buf,this.pos);return this.pos+=4,m},readFixed64:function(){var m=_0(this.buf,this.pos)+_0(this.buf,this.pos+4)*kA;return this.pos+=8,m},readSFixed64:function(){var m=_0(this.buf,this.pos)+Mp(this.buf,this.pos+4)*kA;return this.pos+=8,m},readFloat:function(){var m=ad(this.buf,this.pos,!0,23,4);return this.pos+=4,m},readDouble:function(){var m=ad(this.buf,this.pos,!0,52,8);return this.pos+=8,m},readVarint:function(m){var h,x,M=this.buf;return h=127&(x=M[this.pos++]),x<128?h:(h|=(127&(x=M[this.pos++]))<<7,x<128?h:(h|=(127&(x=M[this.pos++]))<<14,x<128?h:(h|=(127&(x=M[this.pos++]))<<21,x<128?h:function(q,K,J){var me,Ce,Oe=J.buf;if(me=(112&(Ce=Oe[J.pos++]))>>4,Ce<128||(me|=(127&(Ce=Oe[J.pos++]))<<3,Ce<128)||(me|=(127&(Ce=Oe[J.pos++]))<<10,Ce<128)||(me|=(127&(Ce=Oe[J.pos++]))<<17,Ce<128)||(me|=(127&(Ce=Oe[J.pos++]))<<24,Ce<128)||(me|=(1&(Ce=Oe[J.pos++]))<<31,Ce<128))return Ya(q,me,K);throw new Error("Expected varint not more than 10 bytes")}(h|=(15&(x=M[this.pos]))<<28,m,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var m=this.readVarint();return m%2==1?(m+1)/-2:m/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var m=this.readVarint()+this.pos,h=this.pos;return this.pos=m,m-h>=12&&MA?function(x,M,q){return MA.decode(x.subarray(M,q))}(this.buf,h,m):function(x,M,q){for(var K="",J=M;J<q;){var me,Ce,Oe,f=x[J],u=null,p=f>239?4:f>223?3:f>191?2:1;if(J+p>q)break;p===1?f<128&&(u=f):p===2?(192&(me=x[J+1]))==128&&(u=(31&f)<<6|63&me)<=127&&(u=null):p===3?(Ce=x[J+2],(192&(me=x[J+1]))==128&&(192&Ce)==128&&((u=(15&f)<<12|(63&me)<<6|63&Ce)<=2047||u>=55296&&u<=57343)&&(u=null)):p===4&&(Ce=x[J+2],Oe=x[J+3],(192&(me=x[J+1]))==128&&(192&Ce)==128&&(192&Oe)==128&&((u=(15&f)<<18|(63&me)<<12|(63&Ce)<<6|63&Oe)<=65535||u>=1114112)&&(u=null)),u===null?(u=65533,p=1):u>65535&&(u-=65536,K+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),K+=String.fromCharCode(u),J+=p}return K}(this.buf,h,m)},readBytes:function(){var m=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,m);return this.pos=m,h},readPackedVarint:function(m,h){if(this.type!==fa.Bytes)return m.push(this.readVarint(h));var x=wu(this);for(m=m||[];this.pos<x;)m.push(this.readVarint(h));return m},readPackedSVarint:function(m){if(this.type!==fa.Bytes)return m.push(this.readSVarint());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSVarint());return m},readPackedBoolean:function(m){if(this.type!==fa.Bytes)return m.push(this.readBoolean());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readBoolean());return m},readPackedFloat:function(m){if(this.type!==fa.Bytes)return m.push(this.readFloat());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFloat());return m},readPackedDouble:function(m){if(this.type!==fa.Bytes)return m.push(this.readDouble());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readDouble());return m},readPackedFixed32:function(m){if(this.type!==fa.Bytes)return m.push(this.readFixed32());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed32());return m},readPackedSFixed32:function(m){if(this.type!==fa.Bytes)return m.push(this.readSFixed32());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed32());return m},readPackedFixed64:function(m){if(this.type!==fa.Bytes)return m.push(this.readFixed64());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed64());return m},readPackedSFixed64:function(m){if(this.type!==fa.Bytes)return m.push(this.readSFixed64());var h=wu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed64());return m},skip:function(m){var h=7&m;if(h===fa.Varint)for(;this.buf[this.pos++]>127;);else if(h===fa.Bytes)this.pos=this.readVarint()+this.pos;else if(h===fa.Fixed32)this.pos+=4;else{if(h!==fa.Fixed64)throw new Error("Unimplemented type: "+h);this.pos+=8}},writeTag:function(m,h){this.writeVarint(m<<3|h)},realloc:function(m){for(var h=this.length||16;h<this.pos+m;)h*=2;if(h!==this.length){var x=new Uint8Array(h);x.set(this.buf),this.buf=x,this.length=h}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(m){this.realloc(4),DA(this.buf,m,this.pos),this.pos+=4},writeSFixed32:function(m){this.realloc(4),DA(this.buf,m,this.pos),this.pos+=4},writeFixed64:function(m){this.realloc(8),DA(this.buf,-1&m,this.pos),DA(this.buf,Math.floor(m*ld),this.pos+4),this.pos+=8},writeSFixed64:function(m){this.realloc(8),DA(this.buf,-1&m,this.pos),DA(this.buf,Math.floor(m*ld),this.pos+4),this.pos+=8},writeVarint:function(m){(m=+m||0)>268435455||m<0?function(h,x){var M,q;if(h>=0?(M=h%4294967296|0,q=h/4294967296|0):(q=~(-h/4294967296),4294967295^(M=~(-h%4294967296))?M=M+1|0:(M=0,q=q+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");x.realloc(10),function(K,J,me){me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,me.buf[me.pos]=127&(K>>>=7)}(M,0,x),function(K,J){var me=(7&K)<<4;J.buf[J.pos++]|=me|((K>>>=3)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K)))))}(q,x)}(m,this):(this.realloc(4),this.buf[this.pos++]=127&m|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=m>>>7&127))))},writeSVarint:function(m){this.writeVarint(m<0?2*-m-1:2*m)},writeBoolean:function(m){this.writeVarint(!!m)},writeString:function(m){m=String(m),this.realloc(4*m.length),this.pos++;var h=this.pos;this.pos=function(M,q,K){for(var J,me,Ce=0;Ce<q.length;Ce++){if((J=q.charCodeAt(Ce))>55295&&J<57344){if(!me){J>56319||Ce+1===q.length?(M[K++]=239,M[K++]=191,M[K++]=189):me=J;continue}if(J<56320){M[K++]=239,M[K++]=191,M[K++]=189,me=J;continue}J=me-55296<<10|J-56320|65536,me=null}else me&&(M[K++]=239,M[K++]=191,M[K++]=189,me=null);J<128?M[K++]=J:(J<2048?M[K++]=J>>6|192:(J<65536?M[K++]=J>>12|224:(M[K++]=J>>18|240,M[K++]=J>>12&63|128),M[K++]=J>>6&63|128),M[K++]=63&J|128)}return K}(this.buf,m,this.pos);var x=this.pos-h;x>=128&&g0(h,x,this),this.pos=h-1,this.writeVarint(x),this.pos+=x},writeFloat:function(m){this.realloc(4),od(this.buf,m,this.pos,!0,23,4),this.pos+=4},writeDouble:function(m){this.realloc(8),od(this.buf,m,this.pos,!0,52,8),this.pos+=8},writeBytes:function(m){var h=m.length;this.writeVarint(h),this.realloc(h);for(var x=0;x<h;x++)this.buf[this.pos++]=m[x]},writeRawMessage:function(m,h){this.pos++;var x=this.pos;m(h,this);var M=this.pos-x;M>=128&&g0(x,M,this),this.pos=x-1,this.writeVarint(M),this.pos+=M},writeMessage:function(m,h,x){this.writeTag(m,fa.Bytes),this.writeRawMessage(h,x)},writePackedVarint:function(m,h){h.length&&this.writeMessage(m,If,h)},writePackedSVarint:function(m,h){h.length&&this.writeMessage(m,ud,h)},writePackedBoolean:function(m,h){h.length&&this.writeMessage(m,Tp,h)},writePackedFloat:function(m,h){h.length&&this.writeMessage(m,ms,h)},writePackedDouble:function(m,h){h.length&&this.writeMessage(m,th,h)},writePackedFixed32:function(m,h){h.length&&this.writeMessage(m,cd,h)},writePackedSFixed32:function(m,h){h.length&&this.writeMessage(m,ih,h)},writePackedFixed64:function(m,h){h.length&&this.writeMessage(m,PA,h)},writePackedSFixed64:function(m,h){h.length&&this.writeMessage(m,kp,h)},writeBytesField:function(m,h){this.writeTag(m,fa.Bytes),this.writeBytes(h)},writeFixed32Field:function(m,h){this.writeTag(m,fa.Fixed32),this.writeFixed32(h)},writeSFixed32Field:function(m,h){this.writeTag(m,fa.Fixed32),this.writeSFixed32(h)},writeFixed64Field:function(m,h){this.writeTag(m,fa.Fixed64),this.writeFixed64(h)},writeSFixed64Field:function(m,h){this.writeTag(m,fa.Fixed64),this.writeSFixed64(h)},writeVarintField:function(m,h){this.writeTag(m,fa.Varint),this.writeVarint(h)},writeSVarintField:function(m,h){this.writeTag(m,fa.Varint),this.writeSVarint(h)},writeStringField:function(m,h){this.writeTag(m,fa.Bytes),this.writeString(h)},writeFloatField:function(m,h){this.writeTag(m,fa.Fixed32),this.writeFloat(h)},writeDoubleField:function(m,h){this.writeTag(m,fa.Fixed64),this.writeDouble(h)},writeBooleanField:function(m,h){this.writeVarintField(m,!!h)}};var hd=G(sd);const Ad=3;function zm(m,h,x){m===1&&x.readMessage(Rm,h)}function Rm(m,h,x){if(m===3){const{id:M,bitmap:q,width:K,height:J,left:me,top:Ce,advance:Oe}=x.readMessage(Fm,{});h.push({id:M,bitmap:new Dl({width:K+2*Ad,height:J+2*Ad},q),metrics:{width:K,height:J,left:me,top:Ce,advance:Oe}})}}function Fm(m,h,x){m===1?h.id=x.readVarint():m===2?h.bitmap=x.readBytes():m===3?h.width=x.readVarint():m===4?h.height=x.readVarint():m===5?h.left=x.readSVarint():m===6?h.top=x.readSVarint():m===7&&(h.advance=x.readVarint())}const fd=Ad;function LA(m){let h=0,x=0;for(const J of m)h+=J.w*J.h,x=Math.max(x,J.w);m.sort((J,me)=>me.h-J.h);const M=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),x),h:1/0}];let q=0,K=0;for(const J of m)for(let me=M.length-1;me>=0;me--){const Ce=M[me];if(!(J.w>Ce.w||J.h>Ce.h)){if(J.x=Ce.x,J.y=Ce.y,K=Math.max(K,J.y+J.h),q=Math.max(q,J.x+J.w),J.w===Ce.w&&J.h===Ce.h){const Oe=M.pop();me<M.length&&(M[me]=Oe)}else J.h===Ce.h?(Ce.x+=J.w,Ce.w-=J.w):J.w===Ce.w?(Ce.y+=J.h,Ce.h-=J.h):(M.push({x:Ce.x+J.w,y:Ce.y,w:Ce.w-J.w,h:J.h}),Ce.y+=J.h,Ce.h-=J.h);break}}return{w:q,h:K,fill:h/(q*K)||0}}const fl=1;class y0{constructor(h,{pixelRatio:x,version:M,stretchX:q,stretchY:K,content:J}){this.paddedRect=h,this.pixelRatio=x,this.stretchX=q,this.stretchY=K,this.content=J,this.version=M}get tl(){return[this.paddedRect.x+fl,this.paddedRect.y+fl]}get br(){return[this.paddedRect.x+this.paddedRect.w-fl,this.paddedRect.y+this.paddedRect.h-fl]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*fl)/this.pixelRatio,(this.paddedRect.h-2*fl)/this.pixelRatio]}}class v0{constructor(h,x){const M={},q={};this.haveRenderCallbacks=[];const K=[];this.addImages(h,M,K),this.addImages(x,q,K);const{w:J,h:me}=LA(K),Ce=new Vu({width:J||1,height:me||1});for(const Oe in h){const f=h[Oe],u=M[Oe].paddedRect;Vu.copy(f.data,Ce,{x:0,y:0},{x:u.x+fl,y:u.y+fl},f.data)}for(const Oe in x){const f=x[Oe],u=q[Oe].paddedRect,p=u.x+fl,S=u.y+fl,L=f.data.width,U=f.data.height;Vu.copy(f.data,Ce,{x:0,y:0},{x:p,y:S},f.data),Vu.copy(f.data,Ce,{x:0,y:U-1},{x:p,y:S-1},{width:L,height:1}),Vu.copy(f.data,Ce,{x:0,y:0},{x:p,y:S+U},{width:L,height:1}),Vu.copy(f.data,Ce,{x:L-1,y:0},{x:p-1,y:S},{width:1,height:U}),Vu.copy(f.data,Ce,{x:0,y:0},{x:p+L,y:S},{width:1,height:U})}this.image=Ce,this.iconPositions=M,this.patternPositions=q}addImages(h,x,M){for(const q in h){const K=h[q],J={x:0,y:0,w:K.data.width+2*fl,h:K.data.height+2*fl};M.push(J),x[q]=new y0(J,K),K.hasRenderCallback&&this.haveRenderCallbacks.push(q)}}patchUpdatedImages(h,x){h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const M in h.updatedImages)this.patchUpdatedImage(this.iconPositions[M],h.getImage(M),x),this.patchUpdatedImage(this.patternPositions[M],h.getImage(M),x)}patchUpdatedImage(h,x,M){if(!h||!x||h.version===x.version)return;h.version=x.version;const[q,K]=h.tl;M.update(x.data,void 0,{x:q,y:K})}}var Mc;Sn("ImagePosition",y0),Sn("ImageAtlas",v0),I.ah=void 0,(Mc=I.ah||(I.ah={}))[Mc.none=0]="none",Mc[Mc.horizontal=1]="horizontal",Mc[Mc.vertical=2]="vertical",Mc[Mc.horizontalOnly=3]="horizontalOnly";const BA=-17;class Ef{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(h,x){const M=new Ef;return M.scale=h||1,M.fontStack=x,M}static forImage(h){const x=new Ef;return x.imageName=h,x}}class zA{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,x){const M=new zA;for(let q=0;q<h.sections.length;q++){const K=h.sections[q];K.image?M.addImageSection(K):M.addTextSection(K,x)}return M}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(){this.text=function(h){let x="";for(let M=0;M<h.length;M++){const q=h.charCodeAt(M+1)||null,K=h.charCodeAt(M-1)||null;x+=q&&yl(q)&&!Ch[h[M+1]]||K&&yl(K)&&!Ch[h[M-1]]||!Ch[h[M]]?h[M]:Ch[h[M]]}return x}(this.text)}trim(){let h=0;for(let M=0;M<this.text.length&&Tf[this.text.charCodeAt(M)];M++)h++;let x=this.text.length;for(let M=this.text.length-1;M>=0&&M>=h&&Tf[this.text.charCodeAt(M)];M--)x--;this.text=this.text.substring(h,x),this.sectionIndex=this.sectionIndex.slice(h,x)}substring(h,x){const M=new zA;return M.text=this.text.substring(h,x),M.sectionIndex=this.sectionIndex.slice(h,x),M.sections=this.sections,M}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((h,x)=>Math.max(h,this.sections[x].scale),0)}addTextSection(h,x){this.text+=h.text,this.sections.push(Ef.forText(h.scale,h.fontStack||x));const M=this.sections.length-1;for(let q=0;q<h.text.length;++q)this.sectionIndex.push(M)}addImageSection(h){const x=h.image?h.image.name:"";if(x.length===0)return void dt("Can't add FormattedSection with an empty image.");const M=this.getNextImageSectionCharCode();M?(this.text+=String.fromCharCode(M),this.sections.push(Ef.forImage(x)),this.sectionIndex.push(this.sections.length-1)):dt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cf(m,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,U){const Q=zA.fromFeature(m,q);let re;u===I.ah.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:Ae,processStyledBidirectionalText:_e}=jl;if(Ae&&Q.sections.length===1){re=[];const et=Ae(Q.toString(),nh(Q,Oe,K,h,M,S,L));for(const At of et){const _t=new zA;_t.text=At,_t.sections=Q.sections;for(let Mt=0;Mt<At.length;Mt++)_t.sectionIndex.push(0);re.push(_t)}}else if(_e){re=[];const et=_e(Q.text,Q.sectionIndex,nh(Q,Oe,K,h,M,S,L));for(const At of et){const _t=new zA;_t.text=At[0],_t.sectionIndex=At[1],_t.sections=Q.sections,re.push(_t)}}else re=function(et,At){const _t=[],Mt=et.text;let Dt=0;for(const Bt of At)_t.push(et.substring(Dt,Bt)),Dt=Bt;return Dt<Mt.length&&_t.push(et.substring(Dt,Mt.length)),_t}(Q,nh(Q,Oe,K,h,M,S,L));const Le=[],qe={positionedLines:Le,text:Q.toString(),top:f[1],bottom:f[1],left:f[0],right:f[0],writingMode:u,iconsInText:!1,verticalizable:!1};return function(et,At,_t,Mt,Dt,Bt,Kt,Ht,Zt,ci,yi,Xi){let xn=0,on=BA,an=0,An=0;const zn=Ht==="right"?1:Ht==="left"?0:.5;let sn=0;for(const Vr of Dt){Vr.trim();const Hr=Vr.getMaxScale(),zs=(Hr-1)*Al,Ea={positionedGlyphs:[],lineOffset:0};et.positionedLines[sn]=Ea;const ia=Ea.positionedGlyphs;let ns=0;if(!Vr.length()){on+=Bt,++sn;continue}for(let ws=0;ws<Vr.length();ws++){const ir=Vr.getSection(ws),na=Vr.getSectionIndex(ws),Ps=Vr.getCharCode(ws);let Kn=0,La=null,$a=null,va=null,Uo=Al;const oo=!(Zt===I.ah.horizontal||!yi&&!Vl(Ps)||yi&&(Tf[Ps]||(Wi=Ps,Cn.Arabic(Wi)||Cn["Arabic Supplement"](Wi)||Cn["Arabic Extended-A"](Wi)||Cn["Arabic Presentation Forms-A"](Wi)||Cn["Arabic Presentation Forms-B"](Wi))));if(ir.imageName){const ra=Mt[ir.imageName];if(!ra)continue;va=ir.imageName,et.iconsInText=et.iconsInText||!0,$a=ra.paddedRect;const br=ra.displaySize;ir.scale=ir.scale*Al/Xi,La={width:br[0],height:br[1],left:fl,top:-fd,advance:oo?br[1]:br[0]},Kn=zs+(Al-br[1]*ir.scale),Uo=La.advance;const vo=oo?br[0]*ir.scale-Al*Hr:br[1]*ir.scale-Al*Hr;vo>0&&vo>ns&&(ns=vo)}else{const ra=_t[ir.fontStack],br=ra&&ra[Ps];if(br&&br.rect)$a=br.rect,La=br.metrics;else{const vo=At[ir.fontStack],nl=vo&&vo[Ps];if(!nl)continue;La=nl.metrics}Kn=(Hr-ir.scale)*Al}oo?(et.verticalizable=!0,ia.push({glyph:Ps,imageName:va,x:xn,y:on+Kn,vertical:oo,scale:ir.scale,fontStack:ir.fontStack,sectionIndex:na,metrics:La,rect:$a}),xn+=Uo*ir.scale+ci):(ia.push({glyph:Ps,imageName:va,x:xn,y:on+Kn,vertical:oo,scale:ir.scale,fontStack:ir.fontStack,sectionIndex:na,metrics:La,rect:$a}),xn+=La.advance*ir.scale+ci)}ia.length!==0&&(an=Math.max(xn-ci,an),b0(ia,0,ia.length-1,zn,ns)),xn=0;const Wn=Bt*Hr+ns;Ea.lineOffset=Math.max(ns,zs),on+=Wn,An=Math.max(Wn,An),++sn}var Wi;const Dn=on-BA,{horizontalAlign:Rn,verticalAlign:pr}=OA(Kt);(function(Vr,Hr,zs,Ea,ia,ns,Wn,ws,ir){const na=(Hr-zs)*ia;let Ps=0;Ps=ns!==Wn?-ws*Ea-BA:(-Ea*ir+.5)*Wn;for(const Kn of Vr)for(const La of Kn.positionedGlyphs)La.x+=na,La.y+=Ps})(et.positionedLines,zn,Rn,pr,an,An,Bt,Dn,Dt.length),et.top+=-pr*Dn,et.bottom=et.top+Dn,et.left+=-Rn*an,et.right=et.left+an}(qe,h,x,M,re,J,me,Ce,u,Oe,p,U),!function(et){for(const At of et)if(At.positionedGlyphs.length!==0)return!1;return!0}(Le)&&qe}const Tf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Su={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function x0(m,h,x,M,q,K){if(h.imageName){const J=M[h.imageName];return J?J.displaySize[0]*h.scale*Al/K+q:0}{const J=x[h.fontStack],me=J&&J[m];return me?me.metrics.advance*h.scale+q:0}}function ku(m,h,x,M){const q=Math.pow(m-h,2);return M?m<h?q/2:2*q:q+Math.abs(x)*x}function Th(m,h,x){let M=0;return m===10&&(M-=1e4),x&&(M+=150),m!==40&&m!==65288||(M+=50),h!==41&&h!==65289||(M+=50),M}function RA(m,h,x,M,q,K){let J=null,me=ku(h,x,q,K);for(const Ce of M){const Oe=ku(h-Ce.x,x,q,K)+Ce.badness;Oe<=me&&(J=Ce,me=Oe)}return{index:m,x:h,priorBreak:J,badness:me}}function FA(m){return m?FA(m.priorBreak).concat(m.index):[]}function nh(m,h,x,M,q,K,J){if(K!=="point")return[];if(!m)return[];const me=[],Ce=function(p,S,L,U,Q,re){let Ae=0;for(let _e=0;_e<p.length();_e++){const Le=p.getSection(_e);Ae+=x0(p.getCharCode(_e),Le,U,Q,S,re)}return Ae/Math.max(1,Math.ceil(Ae/L))}(m,h,x,M,q,J),Oe=m.text.indexOf("​")>=0;let f=0;for(let p=0;p<m.length();p++){const S=m.getSection(p),L=m.getCharCode(p);if(Tf[L]||(f+=x0(L,S,M,q,h,J)),p<m.length()-1){const U=!((u=L)<11904||!(Cn["Bopomofo Extended"](u)||Cn.Bopomofo(u)||Cn["CJK Compatibility Forms"](u)||Cn["CJK Compatibility Ideographs"](u)||Cn["CJK Compatibility"](u)||Cn["CJK Radicals Supplement"](u)||Cn["CJK Strokes"](u)||Cn["CJK Symbols and Punctuation"](u)||Cn["CJK Unified Ideographs Extension A"](u)||Cn["CJK Unified Ideographs"](u)||Cn["Enclosed CJK Letters and Months"](u)||Cn["Halfwidth and Fullwidth Forms"](u)||Cn.Hiragana(u)||Cn["Ideographic Description Characters"](u)||Cn["Kangxi Radicals"](u)||Cn["Katakana Phonetic Extensions"](u)||Cn.Katakana(u)||Cn["Vertical Forms"](u)||Cn["Yi Radicals"](u)||Cn["Yi Syllables"](u)));(Su[L]||U||S.imageName)&&me.push(RA(p+1,f,Ce,me,Th(L,m.getCharCode(p+1),U&&Oe),!1))}}var u;return FA(RA(m.length(),f,Ce,me,0,!0))}function OA(m){let h=.5,x=.5;switch(m){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(m){case"bottom":case"bottom-right":case"bottom-left":x=1;break;case"top":case"top-right":case"top-left":x=0}return{horizontalAlign:h,verticalAlign:x}}function b0(m,h,x,M,q){if(!M&&!q)return;const K=m[x],J=(m[x].x+K.metrics.advance*K.scale)*M;for(let me=h;me<=x;me++)m[me].x-=J,m[me].y+=q}function Om(m,h,x){const{horizontalAlign:M,verticalAlign:q}=OA(x),K=h[0]-m.displaySize[0]*M,J=h[1]-m.displaySize[1]*q;return{image:m,top:J,bottom:J+m.displaySize[1],left:K,right:K+m.displaySize[0]}}function dd(m,h,x,M,q,K){const J=m.image;let me;if(J.content){const Q=J.content,re=J.pixelRatio||1;me=[Q[0]/re,Q[1]/re,J.displaySize[0]-Q[2]/re,J.displaySize[1]-Q[3]/re]}const Ce=h.left*K,Oe=h.right*K;let f,u,p,S;x==="width"||x==="both"?(S=q[0]+Ce-M[3],u=q[0]+Oe+M[1]):(S=q[0]+(Ce+Oe-J.displaySize[0])/2,u=S+J.displaySize[0]);const L=h.top*K,U=h.bottom*K;return x==="height"||x==="both"?(f=q[1]+L-M[0],p=q[1]+U+M[2]):(f=q[1]+(L+U-J.displaySize[1])/2,p=f+J.displaySize[1]),{image:J,top:f,right:u,bottom:p,left:S,collisionPadding:me}}const kh=255,Pc=128,rh=kh*Pc;function pd(m,h){const{expression:x}=h;if(x.kind==="constant")return{kind:"constant",layoutSize:x.evaluate(new fs(m+1))};if(x.kind==="source")return{kind:"source"};{const{zoomStops:M,interpolationType:q}=x;let K=0;for(;K<M.length&&M[K]<=m;)K++;K=Math.max(0,K-1);let J=K;for(;J<M.length&&M[J]<m+1;)J++;J=Math.min(M.length-1,J);const me=M[K],Ce=M[J];return x.kind==="composite"?{kind:"composite",minZoom:me,maxZoom:Ce,interpolationType:q}:{kind:"camera",minZoom:me,maxZoom:Ce,minSize:x.evaluate(new fs(me)),maxSize:x.evaluate(new fs(Ce)),interpolationType:q}}}function kf(m,h,x){let M="never";const q=m.get(h);return q?M=q:m.get(x)&&(M="always"),M}const md=uc.VectorTileFeature.types,Nm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function w0(m,h,x,M,q,K,J,me,Ce,Oe,f,u,p){const S=me?Math.min(rh,Math.round(me[0])):0,L=me?Math.min(rh,Math.round(me[1])):0;m.emplaceBack(h,x,Math.round(32*M),Math.round(32*q),K,J,(S<<1)+(Ce?1:0),L,16*Oe,16*f,256*u,256*p)}function S0(m,h,x){m.emplaceBack(h.x,h.y,x),m.emplaceBack(h.x,h.y,x),m.emplaceBack(h.x,h.y,x),m.emplaceBack(h.x,h.y,x)}function Mf(m){for(const h of m.sections)if(Wu(h.text))return!0;return!1}class Yu{constructor(h){this.layoutVertexArray=new at,this.indexArray=new Yt,this.programConfigurations=h,this.segments=new Qi,this.dynamicLayoutVertexArray=new ct,this.opacityVertexArray=new Et,this.hasVisibleVertices=!1,this.placedSymbolArray=new r}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,x,M,q){this.isEmpty()||(M&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Cp.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,x),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,nd.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,Nm,!0),this.opacityVertexBuffer.itemSize=1),(M||q)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Sn("SymbolBuffers",Yu);class Dc{constructor(h,x,M){this.layoutVertexArray=new h,this.layoutAttributes=x,this.indexArray=new M,this.segments=new Qi,this.collisionVertexArray=new ri}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,TA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Sn("CollisionBuffers",Dc);class tA{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(J=>J.id),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=H0([]),this.placementViewportMatrix=H0([]);const x=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pd(this.zoom,x["text-size"]),this.iconSizeData=pd(this.zoom,x["icon-size"]);const M=this.layers[0].layout,q=M.get("symbol-sort-key"),K=M.get("symbol-z-order");this.canOverlap=kf(M,"text-overlap","text-allow-overlap")!=="never"||kf(M,"icon-overlap","icon-allow-overlap")!=="never"||M.get("text-ignore-placement")||M.get("icon-ignore-placement"),this.sortFeaturesByKey=K!=="viewport-y"&&!q.isConstant(),this.sortFeaturesByY=(K==="viewport-y"||K==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,M.get("symbol-placement")==="point"&&(this.writingModes=M.get("text-writing-mode").map(J=>I.ah[J])),this.stateDependentLayerIds=this.layers.filter(J=>J.isStateDependent()).map(J=>J.id),this.sourceID=h.sourceID}createArrays(){this.text=new Yu(new No(this.layers,this.zoom,h=>/^text/.test(h))),this.icon=new Yu(new No(this.layers,this.zoom,h=>/^icon/.test(h))),this.glyphOffsetArray=new _,this.lineVertexArray=new w,this.symbolInstances=new d,this.textAnchorOffsets=new B}calculateGlyphDependencies(h,x,M,q,K){for(let J=0;J<h.length;J++)if(x[h.charCodeAt(J)]=!0,(M||q)&&K){const me=Ch[h.charAt(J)];me&&(x[me.charCodeAt(0)]=!0)}}populate(h,x,M){const q=this.layers[0],K=q.layout,J=K.get("text-font"),me=K.get("text-field"),Ce=K.get("icon-image"),Oe=(me.value.kind!=="constant"||me.value.value instanceof Hi&&!me.value.value.isEmpty()||me.value.value.toString().length>0)&&(J.value.kind!=="constant"||J.value.value.length>0),f=Ce.value.kind!=="constant"||!!Ce.value.value||Object.keys(Ce.parameters).length>0,u=K.get("symbol-sort-key");if(this.features=[],!Oe&&!f)return;const p=x.iconDependencies,S=x.glyphDependencies,L=x.availableImages,U=new fs(this.zoom);for(const{feature:Q,id:re,index:Ae,sourceLayerIndex:_e}of h){const Le=q._featureFilter.needGeometry,qe=vl(Q,Le);if(!q._featureFilter.filter(U,qe,M))continue;let et,At;if(Le||(qe.geometry=il(Q)),Oe){const Mt=q.getValueAndResolveTokens("text-field",qe,M,L),Dt=Hi.factory(Mt);Mf(Dt)&&(this.hasRTLText=!0),(!this.hasRTLText||jl.getRTLTextPluginStatus()==="unavailable"||this.hasRTLText&&jl.isParsed())&&(et=Bm(Dt,q,qe))}if(f){const Mt=q.getValueAndResolveTokens("icon-image",qe,M,L);At=Mt instanceof Yi?Mt:Yi.fromString(Mt)}if(!et&&!At)continue;const _t=this.sortFeaturesByKey?u.evaluate(qe,{},M):void 0;if(this.features.push({id:re,text:et,icon:At,index:Ae,sourceLayerIndex:_e,geometry:qe.geometry,properties:Q.properties,type:md[Q.type],sortKey:_t}),At&&(p[At.name]=!0),et){const Mt=J.evaluate(qe,{},M).join(","),Dt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(I.ah.vertical)>=0;for(const Bt of et.sections)if(Bt.image)p[Bt.image.name]=!0;else{const Kt=_l(et.toString()),Ht=Bt.fontStack||Mt,Zt=S[Ht]=S[Ht]||{};this.calculateGlyphDependencies(Bt.text,Zt,Dt,this.allowVerticalPlacement,Kt)}}}K.get("symbol-placement")==="line"&&(this.features=function(Q){const re={},Ae={},_e=[];let Le=0;function qe(Mt){_e.push(Q[Mt]),Le++}function et(Mt,Dt,Bt){const Kt=Ae[Mt];return delete Ae[Mt],Ae[Dt]=Kt,_e[Kt].geometry[0].pop(),_e[Kt].geometry[0]=_e[Kt].geometry[0].concat(Bt[0]),Kt}function At(Mt,Dt,Bt){const Kt=re[Dt];return delete re[Dt],re[Mt]=Kt,_e[Kt].geometry[0].shift(),_e[Kt].geometry[0]=Bt[0].concat(_e[Kt].geometry[0]),Kt}function _t(Mt,Dt,Bt){const Kt=Bt?Dt[0][Dt[0].length-1]:Dt[0][0];return`${Mt}:${Kt.x}:${Kt.y}`}for(let Mt=0;Mt<Q.length;Mt++){const Dt=Q[Mt],Bt=Dt.geometry,Kt=Dt.text?Dt.text.toString():null;if(!Kt){qe(Mt);continue}const Ht=_t(Kt,Bt),Zt=_t(Kt,Bt,!0);if(Ht in Ae&&Zt in re&&Ae[Ht]!==re[Zt]){const ci=At(Ht,Zt,Bt),yi=et(Ht,Zt,_e[ci].geometry);delete re[Ht],delete Ae[Zt],Ae[_t(Kt,_e[yi].geometry,!0)]=yi,_e[ci].geometry=null}else Ht in Ae?et(Ht,Zt,Bt):Zt in re?At(Ht,Zt,Bt):(qe(Mt),re[Ht]=Le-1,Ae[Zt]=Le-1)}return _e.filter(Mt=>Mt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,re)=>Q.sortKey-re.sortKey)}update(h,x,M){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,x,this.layers,M),this.icon.programConfigurations.updatePaintArrays(h,x,this.layers,M))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,x){const M=this.lineVertexArray.length;if(h.segment!==void 0){let q=h.dist(x[h.segment+1]),K=h.dist(x[h.segment]);const J={};for(let me=h.segment+1;me<x.length;me++)J[me]={x:x[me].x,y:x[me].y,tileUnitDistanceFromAnchor:q},me<x.length-1&&(q+=x[me+1].dist(x[me]));for(let me=h.segment||0;me>=0;me--)J[me]={x:x[me].x,y:x[me].y,tileUnitDistanceFromAnchor:K},me>0&&(K+=x[me-1].dist(x[me]));for(let me=0;me<x.length;me++){const Ce=J[me];this.lineVertexArray.emplaceBack(Ce.x,Ce.y,Ce.tileUnitDistanceFromAnchor)}}return{lineStartIndex:M,lineLength:this.lineVertexArray.length-M}}addSymbols(h,x,M,q,K,J,me,Ce,Oe,f,u,p){const S=h.indexArray,L=h.layoutVertexArray,U=h.segments.prepareSegment(4*x.length,L,S,this.canOverlap?J.sortKey:void 0),Q=this.glyphOffsetArray.length,re=U.vertexLength,Ae=this.allowVerticalPlacement&&me===I.ah.vertical?Math.PI/2:0,_e=J.text&&J.text.sections;for(let Le=0;Le<x.length;Le++){const{tl:qe,tr:et,bl:At,br:_t,tex:Mt,pixelOffsetTL:Dt,pixelOffsetBR:Bt,minFontScaleX:Kt,minFontScaleY:Ht,glyphOffset:Zt,isSDF:ci,sectionIndex:yi}=x[Le],Xi=U.vertexLength,xn=Zt[1];w0(L,Ce.x,Ce.y,qe.x,xn+qe.y,Mt.x,Mt.y,M,ci,Dt.x,Dt.y,Kt,Ht),w0(L,Ce.x,Ce.y,et.x,xn+et.y,Mt.x+Mt.w,Mt.y,M,ci,Bt.x,Dt.y,Kt,Ht),w0(L,Ce.x,Ce.y,At.x,xn+At.y,Mt.x,Mt.y+Mt.h,M,ci,Dt.x,Bt.y,Kt,Ht),w0(L,Ce.x,Ce.y,_t.x,xn+_t.y,Mt.x+Mt.w,Mt.y+Mt.h,M,ci,Bt.x,Bt.y,Kt,Ht),S0(h.dynamicLayoutVertexArray,Ce,Ae),S.emplaceBack(Xi,Xi+1,Xi+2),S.emplaceBack(Xi+1,Xi+2,Xi+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Zt[0]),Le!==x.length-1&&yi===x[Le+1].sectionIndex||h.programConfigurations.populatePaintArrays(L.length,J,J.index,{},p,_e&&_e[yi])}h.placedSymbolArray.emplaceBack(Ce.x,Ce.y,Q,this.glyphOffsetArray.length-Q,re,Oe,f,Ce.segment,M?M[0]:0,M?M[1]:0,q[0],q[1],me,0,!1,0,u)}_addCollisionDebugVertex(h,x,M,q,K,J){return x.emplaceBack(0,0),h.emplaceBack(M.x,M.y,q,K,Math.round(J.x),Math.round(J.y))}addCollisionDebugVertices(h,x,M,q,K,J,me){const Ce=K.segments.prepareSegment(4,K.layoutVertexArray,K.indexArray),Oe=Ce.vertexLength,f=K.layoutVertexArray,u=K.collisionVertexArray,p=me.anchorX,S=me.anchorY;this._addCollisionDebugVertex(f,u,J,p,S,new ae(h,x)),this._addCollisionDebugVertex(f,u,J,p,S,new ae(M,x)),this._addCollisionDebugVertex(f,u,J,p,S,new ae(M,q)),this._addCollisionDebugVertex(f,u,J,p,S,new ae(h,q)),Ce.vertexLength+=4;const L=K.indexArray;L.emplaceBack(Oe,Oe+1),L.emplaceBack(Oe+1,Oe+2),L.emplaceBack(Oe+2,Oe+3),L.emplaceBack(Oe+3,Oe),Ce.primitiveLength+=4}addDebugCollisionBoxes(h,x,M,q){for(let K=h;K<x;K++){const J=this.collisionBoxArray.get(K);this.addCollisionDebugVertices(J.x1,J.y1,J.x2,J.y2,q?this.textCollisionBox:this.iconCollisionBox,J.anchorPoint,M)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dc(wt,m0.members,ei),this.iconCollisionBox=new Dc(wt,m0.members,ei);for(let h=0;h<this.symbolInstances.length;h++){const x=this.symbolInstances.get(h);this.addDebugCollisionBoxes(x.textBoxStartIndex,x.textBoxEndIndex,x,!0),this.addDebugCollisionBoxes(x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x,!0),this.addDebugCollisionBoxes(x.iconBoxStartIndex,x.iconBoxEndIndex,x,!1),this.addDebugCollisionBoxes(x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x,!1)}}_deserializeCollisionBoxesForSymbol(h,x,M,q,K,J,me,Ce,Oe){const f={};for(let u=x;u<M;u++){const p=h.get(u);f.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.textFeatureIndex=p.featureIndex;break}for(let u=q;u<K;u++){const p=h.get(u);f.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalTextFeatureIndex=p.featureIndex;break}for(let u=J;u<me;u++){const p=h.get(u);f.iconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.iconFeatureIndex=p.featureIndex;break}for(let u=Ce;u<Oe;u++){const p=h.get(u);f.verticalIconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalIconFeatureIndex=p.featureIndex;break}return f}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let x=0;x<this.symbolInstances.length;x++){const M=this.symbolInstances.get(x);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,M.textBoxStartIndex,M.textBoxEndIndex,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M.iconBoxStartIndex,M.iconBoxEndIndex,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,x){const M=h.placedSymbolArray.get(x),q=M.vertexStartIndex+4*M.numGlyphs;for(let K=M.vertexStartIndex;K<q;K+=4)h.indexArray.emplaceBack(K,K+1,K+2),h.indexArray.emplaceBack(K+1,K+2,K+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const x=Math.sin(h),M=Math.cos(h),q=[],K=[],J=[];for(let me=0;me<this.symbolInstances.length;++me){J.push(me);const Ce=this.symbolInstances.get(me);q.push(0|Math.round(x*Ce.anchorX+M*Ce.anchorY)),K.push(Ce.featureIndex)}return J.sort((me,Ce)=>q[me]-q[Ce]||K[Ce]-K[me]),J}addToSortKeyRanges(h,x){const M=this.sortKeyRanges[this.sortKeyRanges.length-1];M&&M.sortKey===x?M.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:x,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const x of this.symbolInstanceIndexes){const M=this.symbolInstances.get(x);this.featureSortOrder.push(M.featureIndex),[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach((q,K,J)=>{q>=0&&J.indexOf(q)===K&&this.addIndicesForPlacedSymbol(this.text,q)}),M.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,M.verticalPlacedTextSymbolIndex),M.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.placedIconSymbolIndex),M.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let I0,Pp;Sn("SymbolBucket",tA,{omit:["layers","collisionBoxArray","features","compareText"]}),tA.MAX_GLYPHS=65535,tA.addDynamicAttributes=S0;var gd={get paint(){return Pp=Pp||new oa({"icon-opacity":new jn(ii.paint_symbol["icon-opacity"]),"icon-color":new jn(ii.paint_symbol["icon-color"]),"icon-halo-color":new jn(ii.paint_symbol["icon-halo-color"]),"icon-halo-width":new jn(ii.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jn(ii.paint_symbol["icon-halo-blur"]),"icon-translate":new gn(ii.paint_symbol["icon-translate"]),"icon-translate-anchor":new gn(ii.paint_symbol["icon-translate-anchor"]),"text-opacity":new jn(ii.paint_symbol["text-opacity"]),"text-color":new jn(ii.paint_symbol["text-color"],{runtimeType:He,getOverride:m=>m.textColor,hasOverride:m=>!!m.textColor}),"text-halo-color":new jn(ii.paint_symbol["text-halo-color"]),"text-halo-width":new jn(ii.paint_symbol["text-halo-width"]),"text-halo-blur":new jn(ii.paint_symbol["text-halo-blur"]),"text-translate":new gn(ii.paint_symbol["text-translate"]),"text-translate-anchor":new gn(ii.paint_symbol["text-translate-anchor"])})},get layout(){return I0=I0||new oa({"symbol-placement":new gn(ii.layout_symbol["symbol-placement"]),"symbol-spacing":new gn(ii.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gn(ii.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jn(ii.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gn(ii.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gn(ii.layout_symbol["icon-allow-overlap"]),"icon-overlap":new gn(ii.layout_symbol["icon-overlap"]),"icon-ignore-placement":new gn(ii.layout_symbol["icon-ignore-placement"]),"icon-optional":new gn(ii.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gn(ii.layout_symbol["icon-rotation-alignment"]),"icon-size":new jn(ii.layout_symbol["icon-size"]),"icon-text-fit":new gn(ii.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gn(ii.layout_symbol["icon-text-fit-padding"]),"icon-image":new jn(ii.layout_symbol["icon-image"]),"icon-rotate":new jn(ii.layout_symbol["icon-rotate"]),"icon-padding":new jn(ii.layout_symbol["icon-padding"]),"icon-keep-upright":new gn(ii.layout_symbol["icon-keep-upright"]),"icon-offset":new jn(ii.layout_symbol["icon-offset"]),"icon-anchor":new jn(ii.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gn(ii.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gn(ii.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gn(ii.layout_symbol["text-rotation-alignment"]),"text-field":new jn(ii.layout_symbol["text-field"]),"text-font":new jn(ii.layout_symbol["text-font"]),"text-size":new jn(ii.layout_symbol["text-size"]),"text-max-width":new jn(ii.layout_symbol["text-max-width"]),"text-line-height":new gn(ii.layout_symbol["text-line-height"]),"text-letter-spacing":new jn(ii.layout_symbol["text-letter-spacing"]),"text-justify":new jn(ii.layout_symbol["text-justify"]),"text-radial-offset":new jn(ii.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gn(ii.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new jn(ii.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new jn(ii.layout_symbol["text-anchor"]),"text-max-angle":new gn(ii.layout_symbol["text-max-angle"]),"text-writing-mode":new gn(ii.layout_symbol["text-writing-mode"]),"text-rotate":new jn(ii.layout_symbol["text-rotate"]),"text-padding":new gn(ii.layout_symbol["text-padding"]),"text-keep-upright":new gn(ii.layout_symbol["text-keep-upright"]),"text-transform":new jn(ii.layout_symbol["text-transform"]),"text-offset":new jn(ii.layout_symbol["text-offset"]),"text-allow-overlap":new gn(ii.layout_symbol["text-allow-overlap"]),"text-overlap":new gn(ii.layout_symbol["text-overlap"]),"text-ignore-placement":new gn(ii.layout_symbol["text-ignore-placement"]),"text-optional":new gn(ii.layout_symbol["text-optional"])})}};class Pf{constructor(h){if(h.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=h.property.overrides?h.property.overrides.runtimeType:Ie,this.defaultValue=h}evaluate(h){if(h.formattedSection){const x=this.defaultValue.property.overrides;if(x&&x.hasOverride(h.formattedSection))return x.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Sn("FormatSectionOverride",Pf,{omit:["defaultValue"]});class NA extends vs{constructor(h){super(h,gd)}recalculate(h,x){if(super.recalculate(h,x),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const M=this.layout.get("text-writing-mode");if(M){const q=[];for(const K of M)q.indexOf(K)<0&&q.push(K);this.layout._values["text-writing-mode"]=q}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(h,x,M,q){const K=this.layout.get(h).evaluate(x,{},M,q),J=this._unevaluatedLayout._values[h];return J.isDataDriven()||Zr(J.value)||!K?K:function(me,Ce){return Ce.replace(/{([^{}]+)}/g,(Oe,f)=>me&&f in me?String(me[f]):"")}(x.properties,K)}createBucket(h){return new tA(h)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const h of gd.paint.overridableProperties){if(!NA.hasPaintOverride(this.layout,h))continue;const x=this.paint.get(h),M=new Pf(x),q=new es(M,x.property.specification);let K=null;K=x.value.kind==="constant"||x.value.kind==="source"?new kr("source",q):new rr("composite",q,x.value.zoomStops),this.paint._values[h]=new _r(x.property,K,x.parameters)}}_handleOverridablePaintPropertyUpdate(h,x,M){return!(!this.layout||x.isDataDriven()||M.isDataDriven())&&NA.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,x){const M=h.get("text-field"),q=gd.paint.properties[x];let K=!1;const J=me=>{for(const Ce of me)if(q.overrides&&q.overrides.hasOverride(Ce))return void(K=!0)};if(M.value.kind==="constant"&&M.value.value instanceof Hi)J(M.value.value.sections);else if(M.value.kind==="source"){const me=Oe=>{K||(Oe instanceof Ur&&cr(Oe.value)===nt?J(Oe.value.sections):Oe instanceof ql?J(Oe.sections):Oe.eachChild(me))},Ce=M.value;Ce._styleExpression&&me(Ce._styleExpression.expression)}return K}}let Dp;var _d={get paint(){return Dp=Dp||new oa({"background-color":new gn(ii.paint_background["background-color"]),"background-pattern":new tl(ii.paint_background["background-pattern"]),"background-opacity":new gn(ii.paint_background["background-opacity"])})}};class yd extends vs{constructor(h){super(h,_d)}}let sh;var vd={get paint(){return sh=sh||new oa({"raster-opacity":new gn(ii.paint_raster["raster-opacity"]),"raster-hue-rotate":new gn(ii.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gn(ii.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gn(ii.paint_raster["raster-brightness-max"]),"raster-saturation":new gn(ii.paint_raster["raster-saturation"]),"raster-contrast":new gn(ii.paint_raster["raster-contrast"]),"raster-resampling":new gn(ii.paint_raster["raster-resampling"]),"raster-fade-duration":new gn(ii.paint_raster["raster-fade-duration"])})}};class Lp extends vs{constructor(h){super(h,vd)}}class xd extends vs{constructor(h){super(h,{}),this.onAdd=x=>{this.implementation.onAdd&&this.implementation.onAdd(x,x.painter.context.gl)},this.onRemove=x=>{this.implementation.onRemove&&this.implementation.onRemove(x,x.painter.context.gl)},this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Bp{constructor(h){this._methodToThrottle=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const VA=63710088e-1;class ah{constructor(h,x){if(isNaN(h)||isNaN(x))throw new Error(`Invalid LngLat object: (${h}, ${x})`);if(this.lng=+h,this.lat=+x,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ah(Ge(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const x=Math.PI/180,M=this.lat*x,q=h.lat*x,K=Math.sin(M)*Math.sin(q)+Math.cos(M)*Math.cos(q)*Math.cos((h.lng-this.lng)*x);return VA*Math.acos(Math.min(K,1))}static convert(h){if(h instanceof ah)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new ah(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new ah(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const zp=2*Math.PI*VA;function Rp(m){return zp*Math.cos(m*Math.PI/180)}function bd(m){return(180+m)/360}function wd(m){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m*Math.PI/360)))/360}function Fp(m,h){return m/Rp(h)}function UA(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}class E0{constructor(h,x,M=0){this.x=+h,this.y=+x,this.z=+M}static fromLngLat(h,x=0){const M=ah.convert(h);return new E0(bd(M.lng),wd(M.lat),Fp(x,M.lat))}toLngLat(){return new ah(360*this.x-180,UA(this.y))}toAltitude(){return this.z*Rp(UA(this.y))}meterInMercatorCoordinateUnits(){return 1/zp*(h=UA(this.y),1/Math.cos(h*Math.PI/180));var h}}function C0(m,h,x){var M=2*Math.PI*6378137/256/Math.pow(2,x);return[m*M-2*Math.PI*6378137/2,h*M-2*Math.PI*6378137/2]}class Lc{constructor(h,x,M){if(h<0||h>25||M<0||M>=Math.pow(2,h)||x<0||x>=Math.pow(2,h))throw new Error(`x=${x}, y=${M}, z=${h} outside of bounds. 0<=x<${Math.pow(2,h)}, 0<=y<${Math.pow(2,h)} 0<=z<=25 `);this.z=h,this.x=x,this.y=M,this.key=GA(0,h,h,x,M)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,x,M){const q=(J=this.y,me=this.z,Ce=C0(256*(K=this.x),256*(J=Math.pow(2,me)-J-1),me),Oe=C0(256*(K+1),256*(J+1),me),Ce[0]+","+Ce[1]+","+Oe[0]+","+Oe[1]);var K,J,me,Ce,Oe;const f=function(u,p,S){let L,U="";for(let Q=u;Q>0;Q--)L=1<<Q-1,U+=(p&L?1:0)+(S&L?2:0);return U}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(M==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,x>1?"@2x":"").replace(/{quadkey}/g,f).replace(/{bbox-epsg-3857}/g,q)}isChildOf(h){const x=this.z-h.z;return x>0&&h.x===this.x>>x&&h.y===this.y>>x}getTilePoint(h){const x=Math.pow(2,this.z);return new ae((h.x*x-this.x)*Ws,(h.y*x-this.y)*Ws)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Sd{constructor(h,x){this.wrap=h,this.canonical=x,this.key=GA(h,x.z,x.z,x.x,x.y)}}class Mu{constructor(h,x,M,q,K){if(h<M)throw new Error(`overscaledZ should be >= z; overscaledZ = ${h}; z = ${M}`);this.overscaledZ=h,this.wrap=x,this.canonical=new Lc(M,+q,+K),this.key=GA(x,h,M,q,K)}clone(){return new Mu(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const x=this.canonical.z-h;return h>this.canonical.z?new Mu(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Mu(h,this.wrap,h,this.canonical.x>>x,this.canonical.y>>x)}calculateScaledKey(h,x){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const M=this.canonical.z-h;return h>this.canonical.z?GA(this.wrap*+x,h,this.canonical.z,this.canonical.x,this.canonical.y):GA(this.wrap*+x,h,h,this.canonical.x>>M,this.canonical.y>>M)}isChildOf(h){if(h.wrap!==this.wrap)return!1;const x=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>x&&h.canonical.y===this.canonical.y>>x}children(h){if(this.overscaledZ>=h)return[new Mu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const x=this.canonical.z+1,M=2*this.canonical.x,q=2*this.canonical.y;return[new Mu(x,this.wrap,x,M,q),new Mu(x,this.wrap,x,M+1,q),new Mu(x,this.wrap,x,M,q+1),new Mu(x,this.wrap,x,M+1,q+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new Mu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new Mu(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Sd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(h){return this.canonical.getTilePoint(new E0(h.x-this.wrap,h.y))}}function GA(m,h,x,M,q){(m*=2)<0&&(m=-1*m-1);const K=1<<x;return(K*K*m+K*q+M).toString(36)+x.toString(36)+h.toString(36)}Sn("CanonicalTileID",Lc),Sn("OverscaledTileID",Mu,{omit:["posMatrix"]});class Id{constructor(h,x,M,q=1,K=1,J=1,me=0){if(this.uid=h,x.height!==x.width)throw new RangeError("DEM tiles must be square");if(M&&!["mapbox","terrarium","custom"].includes(M))return void dt(`"${M}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=x.height;const Ce=this.dim=x.height-2;switch(this.data=new Uint32Array(x.data.buffer),M){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=q,this.greenFactor=K,this.blueFactor=J,this.baseShift=me;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Oe=0;Oe<Ce;Oe++)this.data[this._idx(-1,Oe)]=this.data[this._idx(0,Oe)],this.data[this._idx(Ce,Oe)]=this.data[this._idx(Ce-1,Oe)],this.data[this._idx(Oe,-1)]=this.data[this._idx(Oe,0)],this.data[this._idx(Oe,Ce)]=this.data[this._idx(Oe,Ce-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Ce,-1)]=this.data[this._idx(Ce-1,0)],this.data[this._idx(-1,Ce)]=this.data[this._idx(0,Ce-1)],this.data[this._idx(Ce,Ce)]=this.data[this._idx(Ce-1,Ce-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Oe=0;Oe<Ce;Oe++)for(let f=0;f<Ce;f++){const u=this.get(Oe,f);u>this.max&&(this.max=u),u<this.min&&(this.min=u)}}get(h,x){const M=new Uint8Array(this.data.buffer),q=4*this._idx(h,x);return this.unpack(M[q],M[q+1],M[q+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(h,x){if(h<-1||h>=this.dim+1||x<-1||x>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(x+1)*this.stride+(h+1)}unpack(h,x,M){return h*this.redFactor+x*this.greenFactor+M*this.blueFactor-this.baseShift}getPixels(){return new Vu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(h,x,M){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let q=x*this.dim,K=x*this.dim+this.dim,J=M*this.dim,me=M*this.dim+this.dim;switch(x){case-1:q=K-1;break;case 1:K=q+1}switch(M){case-1:J=me-1;break;case 1:me=J+1}const Ce=-x*this.dim,Oe=-M*this.dim;for(let f=J;f<me;f++)for(let u=q;u<K;u++)this.data[this._idx(u,f)]=h.data[this._idx(u+Ce,f+Oe)]}}Sn("DEMData",Id);class Ed{constructor(h){this._stringToNumber={},this._numberToString=[];for(let x=0;x<h.length;x++){const M=h[x];this._stringToNumber[M]=x,this._numberToString[x]=M}}encode(h){return this._stringToNumber[h]}decode(h){if(h>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${h} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[h]}}class Cd{constructor(h,x,M,q,K){this.type="Feature",this._vectorTileFeature=h,h._z=x,h._x=M,h._y=q,this.properties=h.properties,this.id=K}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={geometry:this.geometry};for(const x in this)x!=="_geometry"&&x!=="_vectorTileFeature"&&(h[x]=this[x]);return h}}class T0{constructor(h,x){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Pn(Ws,16,0),this.grid3D=new Pn(Ws,16,0),this.featureIndexArray=new Y,this.promoteId=x}insert(h,x,M,q,K,J){const me=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(M,q,K);const Ce=J?this.grid3D:this.grid;for(let Oe=0;Oe<x.length;Oe++){const f=x[Oe],u=[1/0,1/0,-1/0,-1/0];for(let p=0;p<f.length;p++){const S=f[p];u[0]=Math.min(u[0],S.x),u[1]=Math.min(u[1],S.y),u[2]=Math.max(u[2],S.x),u[3]=Math.max(u[3],S.y)}u[0]<Ws&&u[1]<Ws&&u[2]>=0&&u[3]>=0&&Ce.insert(me,u[0],u[1],u[2],u[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new uc.VectorTile(new hd(this.rawTileData)).layers,this.sourceLayerCoder=new Ed(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(h,x,M,q){this.loadVTLayers();const K=h.params||{},J=Ws/h.tileSize/h.scale,me=hs(K.filter),Ce=h.queryGeometry,Oe=h.queryPadding*J,f=Td(Ce),u=this.grid.query(f.minX-Oe,f.minY-Oe,f.maxX+Oe,f.maxY+Oe),p=Td(h.cameraQueryGeometry),S=this.grid3D.query(p.minX-Oe,p.minY-Oe,p.maxX+Oe,p.maxY+Oe,(Q,re,Ae,_e)=>function(Le,qe,et,At,_t){for(const Dt of Le)if(qe<=Dt.x&&et<=Dt.y&&At>=Dt.x&&_t>=Dt.y)return!0;const Mt=[new ae(qe,et),new ae(qe,_t),new ae(At,_t),new ae(At,et)];if(Le.length>2){for(const Dt of Mt)if(Xc(Le,Dt))return!0}for(let Dt=0;Dt<Le.length-1;Dt++)if(_p(Le[Dt],Le[Dt+1],Mt))return!0;return!1}(h.cameraQueryGeometry,Q-Oe,re-Oe,Ae+Oe,_e+Oe));for(const Q of S)u.push(Q);u.sort(kd);const L={};let U;for(let Q=0;Q<u.length;Q++){const re=u[Q];if(re===U)continue;U=re;const Ae=this.featureIndexArray.get(re);let _e=null;this.loadMatchingFeature(L,Ae.bucketIndex,Ae.sourceLayerIndex,Ae.featureIndex,me,K.layers,K.availableImages,x,M,q,(Le,qe,et)=>(_e||(_e=il(Le)),qe.queryIntersectsFeature(Ce,Le,et,_e,this.z,h.transform,J,h.pixelPosMatrix)))}return L}loadMatchingFeature(h,x,M,q,K,J,me,Ce,Oe,f,u){const p=this.bucketLayerIDs[x];if(J&&!function(Q,re){for(let Ae=0;Ae<Q.length;Ae++)if(re.indexOf(Q[Ae])>=0)return!0;return!1}(J,p))return;const S=this.sourceLayerCoder.decode(M),L=this.vtLayers[S].feature(q);if(K.needGeometry){const Q=vl(L,!0);if(!K.filter(new fs(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!K.filter(new fs(this.tileID.overscaledZ),L))return;const U=this.getId(L,S);for(let Q=0;Q<p.length;Q++){const re=p[Q];if(J&&J.indexOf(re)<0)continue;const Ae=Ce[re];if(!Ae)continue;let _e={};U&&f&&(_e=f.getState(Ae.sourceLayer||"_geojsonTileLayer",U));const Le=Xt({},Oe[re]);Le.paint=Df(Le.paint,Ae.paint,L,_e,me),Le.layout=Df(Le.layout,Ae.layout,L,_e,me);const qe=!u||u(L,Ae,_e);if(!qe)continue;const et=new Cd(L,this.z,this.x,this.y,U);et.layer=Le;let At=h[re];At===void 0&&(At=h[re]=[]),At.push({featureIndex:q,feature:et,intersectionZ:qe})}}lookupSymbolFeatures(h,x,M,q,K,J,me,Ce){const Oe={};this.loadVTLayers();const f=hs(K);for(const u of h)this.loadMatchingFeature(Oe,M,q,u,f,J,me,Ce,x);return Oe}hasLayer(h){for(const x of this.bucketLayerIDs)for(const M of x)if(h===M)return!0;return!1}getId(h,x){let M=h.id;return this.promoteId&&(M=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[x]],typeof M=="boolean"&&(M=Number(M))),M}}function Df(m,h,x,M,q){return yt(m,(K,J)=>{const me=h instanceof ds?h.get(J):null;return me&&me.evaluate?me.evaluate(x,M,q):me})}function Td(m){let h=1/0,x=1/0,M=-1/0,q=-1/0;for(const K of m)h=Math.min(h,K.x),x=Math.min(x,K.y),M=Math.max(M,K.x),q=Math.max(q,K.y);return{minX:h,minY:x,maxX:M,maxY:q}}function kd(m,h){return h-m}function Md(m,h,x,M,q){const K=[];for(let J=0;J<m.length;J++){const me=m[J];let Ce;for(let Oe=0;Oe<me.length-1;Oe++){let f=me[Oe],u=me[Oe+1];f.x<h&&u.x<h||(f.x<h?f=new ae(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x<h&&(u=new ae(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y<x&&u.y<x||(f.y<x?f=new ae(f.x+(x-f.y)/(u.y-f.y)*(u.x-f.x),x)._round():u.y<x&&(u=new ae(f.x+(x-f.y)/(u.y-f.y)*(u.x-f.x),x)._round()),f.x>=M&&u.x>=M||(f.x>=M?f=new ae(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x>=M&&(u=new ae(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y>=q&&u.y>=q||(f.y>=q?f=new ae(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round():u.y>=q&&(u=new ae(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round()),Ce&&f.equals(Ce[Ce.length-1])||(Ce=[f],K.push(Ce)),Ce.push(u)))))}}return K}Sn("FeatureIndex",T0,{omit:["rawTileData","sourceLayerCoder"]});class bl extends ae{constructor(h,x,M,q){super(h,x),this.angle=M,q!==void 0&&(this.segment=q)}clone(){return new bl(this.x,this.y,this.angle,this.segment)}}function qA(m,h,x,M,q){if(h.segment===void 0||x===0)return!0;let K=h,J=h.segment+1,me=0;for(;me>-x/2;){if(J--,J<0)return!1;me-=m[J].dist(K),K=m[J]}me+=m[J].dist(m[J+1]),J++;const Ce=[];let Oe=0;for(;me<x/2;){const f=m[J],u=m[J+1];if(!u)return!1;let p=m[J-1].angleTo(f)-f.angleTo(u);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),Ce.push({distance:me,angleDelta:p}),Oe+=p;me-Ce[0].distance>M;)Oe-=Ce.shift().angleDelta;if(Oe>q)return!1;J++,me+=f.dist(u)}return!0}function k0(m){let h=0;for(let x=0;x<m.length-1;x++)h+=m[x].dist(m[x+1]);return h}function M0(m,h,x){return m?.6*h*x:0}function Pd(m,h){return Math.max(m?m.right-m.left:0,h?h.right-h.left:0)}function Op(m,h,x,M,q,K){const J=M0(x,q,K),me=Pd(x,M)*K;let Ce=0;const Oe=k0(m)/2;for(let f=0;f<m.length-1;f++){const u=m[f],p=m[f+1],S=u.dist(p);if(Ce+S>Oe){const L=(Oe-Ce)/S,U=vr.number(u.x,p.x,L),Q=vr.number(u.y,p.y,L),re=new bl(U,Q,p.angleTo(u),f);return re._round(),!J||qA(m,re,me,J,h)?re:void 0}Ce+=S}}function Np(m,h,x,M,q,K,J,me,Ce){const Oe=M0(M,K,J),f=Pd(M,q),u=f*J,p=m[0].x===0||m[0].x===Ce||m[0].y===0||m[0].y===Ce;return h-u<h/4&&(h=u+h/4),Dd(m,p?h/2*me%h:(f/2+2*K)*J*me%h,h,Oe,x,u,p,!1,Ce)}function Dd(m,h,x,M,q,K,J,me,Ce){const Oe=K/2,f=k0(m);let u=0,p=h-x,S=[];for(let L=0;L<m.length-1;L++){const U=m[L],Q=m[L+1],re=U.dist(Q),Ae=Q.angleTo(U);for(;p+x<u+re;){p+=x;const _e=(p-u)/re,Le=vr.number(U.x,Q.x,_e),qe=vr.number(U.y,Q.y,_e);if(Le>=0&&Le<Ce&&qe>=0&&qe<Ce&&p-Oe>=0&&p+Oe<=f){const et=new bl(Le,qe,Ae,L);et._round(),M&&!qA(m,et,K,M,q)||S.push(et)}}u+=re}return me||S.length||J||(S=Dd(m,u/2,x,M,q,K,J,!0,Ce)),S}Sn("Anchor",bl);const oh=fl;function Ld(m,h,x,M){const q=[],K=m.image,J=K.pixelRatio,me=K.paddedRect.w-2*oh,Ce=K.paddedRect.h-2*oh,Oe=m.right-m.left,f=m.bottom-m.top,u=K.stretchX||[[0,me]],p=K.stretchY||[[0,Ce]],S=(Bt,Kt)=>Bt+Kt[1]-Kt[0],L=u.reduce(S,0),U=p.reduce(S,0),Q=me-L,re=Ce-U;let Ae=0,_e=L,Le=0,qe=U,et=0,At=Q,_t=0,Mt=re;if(K.content&&M){const Bt=K.content;Ae=cc(u,0,Bt[0]),Le=cc(p,0,Bt[1]),_e=cc(u,Bt[0],Bt[2]),qe=cc(p,Bt[1],Bt[3]),et=Bt[0]-Ae,_t=Bt[1]-Le,At=Bt[2]-Bt[0]-_e,Mt=Bt[3]-Bt[1]-qe}const Dt=(Bt,Kt,Ht,Zt)=>{const ci=Lf(Bt.stretch-Ae,_e,Oe,m.left),yi=Bf(Bt.fixed-et,At,Bt.stretch,L),Xi=Lf(Kt.stretch-Le,qe,f,m.top),xn=Bf(Kt.fixed-_t,Mt,Kt.stretch,U),on=Lf(Ht.stretch-Ae,_e,Oe,m.left),an=Bf(Ht.fixed-et,At,Ht.stretch,L),An=Lf(Zt.stretch-Le,qe,f,m.top),zn=Bf(Zt.fixed-_t,Mt,Zt.stretch,U),sn=new ae(ci,Xi),Wi=new ae(on,Xi),Dn=new ae(on,An),Rn=new ae(ci,An),pr=new ae(yi/J,xn/J),Vr=new ae(an/J,zn/J),Hr=h*Math.PI/180;if(Hr){const ia=Math.sin(Hr),ns=Math.cos(Hr),Wn=[ns,-ia,ia,ns];sn._matMult(Wn),Wi._matMult(Wn),Rn._matMult(Wn),Dn._matMult(Wn)}const zs=Bt.stretch+Bt.fixed,Ea=Kt.stretch+Kt.fixed;return{tl:sn,tr:Wi,bl:Rn,br:Dn,tex:{x:K.paddedRect.x+oh+zs,y:K.paddedRect.y+oh+Ea,w:Ht.stretch+Ht.fixed-zs,h:Zt.stretch+Zt.fixed-Ea},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:pr,pixelOffsetBR:Vr,minFontScaleX:At/J/Oe,minFontScaleY:Mt/J/f,isSDF:x}};if(M&&(K.stretchX||K.stretchY)){const Bt=Bd(u,Q,L),Kt=Bd(p,re,U);for(let Ht=0;Ht<Bt.length-1;Ht++){const Zt=Bt[Ht],ci=Bt[Ht+1];for(let yi=0;yi<Kt.length-1;yi++)q.push(Dt(Zt,Kt[yi],ci,Kt[yi+1]))}}else q.push(Dt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:me+1},{fixed:0,stretch:Ce+1}));return q}function cc(m,h,x){let M=0;for(const q of m)M+=Math.max(h,Math.min(x,q[1]))-Math.max(h,Math.min(x,q[0]));return M}function Bd(m,h,x){const M=[{fixed:-oh,stretch:0}];for(const[q,K]of m){const J=M[M.length-1];M.push({fixed:q-J.stretch,stretch:J.stretch}),M.push({fixed:q-J.stretch,stretch:J.stretch+(K-q)})}return M.push({fixed:h+oh,stretch:x}),M}function Lf(m,h,x,M){return m/h*x+M}function Bf(m,h,x,M){return m-h*x/M}class zf{constructor(h,x,M,q,K,J,me,Ce,Oe,f){if(this.boxStartIndex=h.length,Oe){let u=J.top,p=J.bottom;const S=J.collisionPadding;S&&(u-=S[1],p+=S[3]);let L=p-u;L>0&&(L=Math.max(10,L),this.circleDiameter=L)}else{let u=J.top*me-Ce[0],p=J.bottom*me+Ce[2],S=J.left*me-Ce[3],L=J.right*me+Ce[1];const U=J.collisionPadding;if(U&&(S-=U[0]*me,u-=U[1]*me,L+=U[2]*me,p+=U[3]*me),f){const Q=new ae(S,u),re=new ae(L,u),Ae=new ae(S,p),_e=new ae(L,p),Le=f*Math.PI/180;Q._rotate(Le),re._rotate(Le),Ae._rotate(Le),_e._rotate(Le),S=Math.min(Q.x,re.x,Ae.x,_e.x),L=Math.max(Q.x,re.x,Ae.x,_e.x),u=Math.min(Q.y,re.y,Ae.y,_e.y),p=Math.max(Q.y,re.y,Ae.y,_e.y)}h.emplaceBack(x.x,x.y,S,u,L,p,M,q,K)}this.boxEndIndex=h.length}}class Vm{constructor(h=[],x=Um){if(this.data=h,this.length=this.data.length,this.compare=x,this.length>0)for(let M=(this.length>>1)-1;M>=0;M--)this._down(M)}push(h){this.data.push(h),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const h=this.data[0],x=this.data.pop();return this.length--,this.length>0&&(this.data[0]=x,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:x,compare:M}=this,q=x[h];for(;h>0;){const K=h-1>>1,J=x[K];if(M(q,J)>=0)break;x[h]=J,h=K}x[h]=q}_down(h){const{data:x,compare:M}=this,q=this.length>>1,K=x[h];for(;h<q;){let J=1+(h<<1),me=x[J];const Ce=J+1;if(Ce<this.length&&M(x[Ce],me)<0&&(J=Ce,me=x[Ce]),M(me,K)>=0)break;x[h]=me,h=J}x[h]=K}}function Um(m,h){return m<h?-1:m>h?1:0}function Vp(m,h=1,x=!1){let M=1/0,q=1/0,K=-1/0,J=-1/0;const me=m[0];for(let S=0;S<me.length;S++){const L=me[S];(!S||L.x<M)&&(M=L.x),(!S||L.y<q)&&(q=L.y),(!S||L.x>K)&&(K=L.x),(!S||L.y>J)&&(J=L.y)}const Ce=Math.min(K-M,J-q);let Oe=Ce/2;const f=new Vm([],HA);if(Ce===0)return new ae(M,q);for(let S=M;S<K;S+=Ce)for(let L=q;L<J;L+=Ce)f.push(new iA(S+Oe,L+Oe,Oe,m));let u=function(S){let L=0,U=0,Q=0;const re=S[0];for(let Ae=0,_e=re.length,Le=_e-1;Ae<_e;Le=Ae++){const qe=re[Ae],et=re[Le],At=qe.x*et.y-et.x*qe.y;U+=(qe.x+et.x)*At,Q+=(qe.y+et.y)*At,L+=3*At}return new iA(U/L,Q/L,0,S)}(m),p=f.length;for(;f.length;){const S=f.pop();(S.d>u.d||!u.d)&&(u=S,x&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,p)),S.max-u.d<=h||(Oe=S.h/2,f.push(new iA(S.p.x-Oe,S.p.y-Oe,Oe,m)),f.push(new iA(S.p.x+Oe,S.p.y-Oe,Oe,m)),f.push(new iA(S.p.x-Oe,S.p.y+Oe,Oe,m)),f.push(new iA(S.p.x+Oe,S.p.y+Oe,Oe,m)),p+=4)}return x&&(console.log(`num probes: ${p}`),console.log(`best distance: ${u.d}`)),u.p}function HA(m,h){return h.max-m.max}function iA(m,h,x,M){this.p=new ae(m,h),this.h=x,this.d=function(q,K){let J=!1,me=1/0;for(let Ce=0;Ce<K.length;Ce++){const Oe=K[Ce];for(let f=0,u=Oe.length,p=u-1;f<u;p=f++){const S=Oe[f],L=Oe[p];S.y>q.y!=L.y>q.y&&q.x<(L.x-S.x)*(q.y-S.y)/(L.y-S.y)+S.x&&(J=!J),me=Math.min(me,Gh(q,S,L))}}return(J?1:-1)*Math.sqrt(me)}(this.p,M),this.max=this.d+this.h*Math.SQRT2}var Do;I.ap=void 0,(Do=I.ap||(I.ap={}))[Do.center=1]="center",Do[Do.left=2]="left",Do[Do.right=3]="right",Do[Do.top=4]="top",Do[Do.bottom=5]="bottom",Do[Do["top-left"]=6]="top-left",Do[Do["top-right"]=7]="top-right",Do[Do["bottom-left"]=8]="bottom-left",Do[Do["bottom-right"]=9]="bottom-right";const lh=7,nA=Number.POSITIVE_INFINITY;function jA(m,h){return h[1]!==nA?function(x,M,q){let K=0,J=0;switch(M=Math.abs(M),q=Math.abs(q),x){case"top-right":case"top-left":case"top":J=q-lh;break;case"bottom-right":case"bottom-left":case"bottom":J=-q+lh}switch(x){case"top-right":case"bottom-right":case"right":K=-M;break;case"top-left":case"bottom-left":case"left":K=M}return[K,J]}(m,h[0],h[1]):function(x,M){let q=0,K=0;M<0&&(M=0);const J=M/Math.SQRT2;switch(x){case"top-right":case"top-left":K=J-lh;break;case"bottom-right":case"bottom-left":K=-J+lh;break;case"bottom":K=-M+lh;break;case"top":K=M-lh}switch(x){case"top-right":case"bottom-right":q=-J;break;case"top-left":case"bottom-left":q=J;break;case"left":q=M;break;case"right":q=-M}return[q,K]}(m,h[0])}function rA(m,h,x){var M;const q=m.layout,K=(M=q.get("text-variable-anchor-offset"))===null||M===void 0?void 0:M.evaluate(h,{},x);if(K){const me=K.values,Ce=[];for(let Oe=0;Oe<me.length;Oe+=2){const f=Ce[Oe]=me[Oe],u=me[Oe+1].map(p=>p*Al);f.startsWith("top")?u[1]-=lh:f.startsWith("bottom")&&(u[1]+=lh),Ce[Oe+1]=u}return new Qt(Ce)}const J=q.get("text-variable-anchor");if(J){let me;me=m._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[q.get("text-radial-offset").evaluate(h,{},x)*Al,nA]:q.get("text-offset").evaluate(h,{},x).map(Oe=>Oe*Al);const Ce=[];for(const Oe of J)Ce.push(Oe,jA(Oe,me));return new Qt(Ce)}return null}function P0(m){switch(m){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Up(m,h,x,M,q,K,J,me,Ce,Oe,f){let u=K.textMaxSize.evaluate(h,{});u===void 0&&(u=J);const p=m.layers[0].layout,S=p.get("icon-offset").evaluate(h,{},f),L=Rd(x.horizontal),U=J/24,Q=m.tilePixelRatio*U,re=m.tilePixelRatio*u/24,Ae=m.tilePixelRatio*me,_e=m.tilePixelRatio*p.get("symbol-spacing"),Le=p.get("text-padding")*m.tilePixelRatio,qe=function(Zt,ci,yi,Xi=1){const xn=Zt.get("icon-padding").evaluate(ci,{},yi),on=xn&&xn.values;return[on[0]*Xi,on[1]*Xi,on[2]*Xi,on[3]*Xi]}(p,h,f,m.tilePixelRatio),et=p.get("text-max-angle")/180*Math.PI,At=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",_t=p.get("icon-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point",Mt=p.get("symbol-placement"),Dt=_e/2,Bt=p.get("icon-text-fit");let Kt;M&&Bt!=="none"&&(m.allowVerticalPlacement&&x.vertical&&(Kt=dd(M,x.vertical,Bt,p.get("icon-text-fit-padding"),S,U)),L&&(M=dd(M,L,Bt,p.get("icon-text-fit-padding"),S,U)));const Ht=(Zt,ci)=>{ci.x<0||ci.x>=Ws||ci.y<0||ci.y>=Ws||function(yi,Xi,xn,on,an,An,zn,sn,Wi,Dn,Rn,pr,Vr,Hr,zs,Ea,ia,ns,Wn,ws,ir,na,Ps,Kn,La){const $a=yi.addToLineVertexArray(Xi,xn);let va,Uo,oo,ra,br=0,vo=0,nl=0,rl=0,Pu=-1,Uu=-1;const zl={};let zc=er("");if(yi.allowVerticalPlacement&&on.vertical){const Yl=sn.layout.get("text-rotate").evaluate(ir,{},Kn)+90;oo=new zf(Wi,Xi,Dn,Rn,pr,on.vertical,Vr,Hr,zs,Yl),zn&&(ra=new zf(Wi,Xi,Dn,Rn,pr,zn,ia,ns,zs,Yl))}if(an){const Yl=sn.layout.get("icon-rotate").evaluate(ir,{}),Hu=sn.layout.get("icon-text-fit")!=="none",Ph=Ld(an,Yl,Ps,Hu),hc=zn?Ld(zn,Yl,Ps,Hu):void 0;Uo=new zf(Wi,Xi,Dn,Rn,pr,an,ia,ns,!1,Yl),br=4*Ph.length;const $l=yi.iconSizeData;let ju=null;$l.kind==="source"?(ju=[Pc*sn.layout.get("icon-size").evaluate(ir,{})],ju[0]>rh&&dt(`${yi.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)):$l.kind==="composite"&&(ju=[Pc*na.compositeIconSizes[0].evaluate(ir,{},Kn),Pc*na.compositeIconSizes[1].evaluate(ir,{},Kn)],(ju[0]>rh||ju[1]>rh)&&dt(`${yi.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)),yi.addSymbols(yi.icon,Ph,ju,ws,Wn,ir,I.ah.none,Xi,$a.lineStartIndex,$a.lineLength,-1,Kn),Pu=yi.icon.placedSymbolArray.length-1,hc&&(vo=4*hc.length,yi.addSymbols(yi.icon,hc,ju,ws,Wn,ir,I.ah.vertical,Xi,$a.lineStartIndex,$a.lineLength,-1,Kn),Uu=yi.icon.placedSymbolArray.length-1)}const Gu=Object.keys(on.horizontal);for(const Yl of Gu){const Hu=on.horizontal[Yl];if(!va){zc=er(Hu.text);const hc=sn.layout.get("text-rotate").evaluate(ir,{},Kn);va=new zf(Wi,Xi,Dn,Rn,pr,Hu,Vr,Hr,zs,hc)}const Ph=Hu.positionedLines.length===1;if(nl+=zd(yi,Xi,Hu,An,sn,zs,ir,Ea,$a,on.vertical?I.ah.horizontal:I.ah.horizontalOnly,Ph?Gu:[Yl],zl,Pu,na,Kn),Ph)break}on.vertical&&(rl+=zd(yi,Xi,on.vertical,An,sn,zs,ir,Ea,$a,I.ah.vertical,["vertical"],zl,Uu,na,Kn));const qu=va?va.boxStartIndex:yi.collisionBoxArray.length,Xl=va?va.boxEndIndex:yi.collisionBoxArray.length,uh=oo?oo.boxStartIndex:yi.collisionBoxArray.length,sA=oo?oo.boxEndIndex:yi.collisionBoxArray.length,qp=Uo?Uo.boxStartIndex:yi.collisionBoxArray.length,Fd=Uo?Uo.boxEndIndex:yi.collisionBoxArray.length,Od=ra?ra.boxStartIndex:yi.collisionBoxArray.length,lo=ra?ra.boxEndIndex:yi.collisionBoxArray.length;let xo=-1;const Gf=(Yl,Hu)=>Yl&&Yl.circleDiameter?Math.max(Yl.circleDiameter,Hu):Hu;xo=Gf(va,xo),xo=Gf(oo,xo),xo=Gf(Uo,xo),xo=Gf(ra,xo);const Hp=xo>-1?1:0;Hp&&(xo*=La/Al),yi.glyphOffsetArray.length>=tA.MAX_GLYPHS&&dt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ir.sortKey!==void 0&&yi.addToSortKeyRanges(yi.symbolInstances.length,ir.sortKey);const Gm=rA(sn,ir,Kn),[jp,qm]=function(Yl,Hu){const Ph=Yl.length,hc=Hu==null?void 0:Hu.values;if((hc==null?void 0:hc.length)>0)for(let $l=0;$l<hc.length;$l+=2){const ju=hc[$l+1];Yl.emplaceBack(I.ap[hc[$l]],ju[0],ju[1])}return[Ph,Yl.length]}(yi.textAnchorOffsets,Gm);yi.symbolInstances.emplaceBack(Xi.x,Xi.y,zl.right>=0?zl.right:-1,zl.center>=0?zl.center:-1,zl.left>=0?zl.left:-1,zl.vertical||-1,Pu,Uu,zc,qu,Xl,uh,sA,qp,Fd,Od,lo,Dn,nl,rl,br,vo,Hp,0,Vr,xo,jp,qm)}(m,ci,Zt,x,M,q,Kt,m.layers[0],m.collisionBoxArray,h.index,h.sourceLayerIndex,m.index,Q,[Le,Le,Le,Le],At,Ce,Ae,qe,_t,S,h,K,Oe,f,J)};if(Mt==="line")for(const Zt of Md(h.geometry,0,0,Ws,Ws)){const ci=Np(Zt,_e,et,x.vertical||L,M,24,re,m.overscaling,Ws);for(const yi of ci)L&&ZA(m,L.text,Dt,yi)||Ht(Zt,yi)}else if(Mt==="line-center"){for(const Zt of h.geometry)if(Zt.length>1){const ci=Op(Zt,et,x.vertical||L,M,24,re);ci&&Ht(Zt,ci)}}else if(h.type==="Polygon")for(const Zt of wh(h.geometry,0)){const ci=Vp(Zt,16);Ht(Zt[0],new bl(ci.x,ci.y,0))}else if(h.type==="LineString")for(const Zt of h.geometry)Ht(Zt,new bl(Zt[0].x,Zt[0].y,0));else if(h.type==="Point")for(const Zt of h.geometry)for(const ci of Zt)Ht([ci],new bl(ci.x,ci.y,0))}function zd(m,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L){const U=function(Ae,_e,Le,qe,et,At,_t,Mt){const Dt=qe.layout.get("text-rotate").evaluate(At,{})*Math.PI/180,Bt=[];for(const Kt of _e.positionedLines)for(const Ht of Kt.positionedGlyphs){if(!Ht.rect)continue;const Zt=Ht.rect||{};let ci=fd+1,yi=!0,Xi=1,xn=0;const on=(et||Mt)&&Ht.vertical,an=Ht.metrics.advance*Ht.scale/2;if(Mt&&_e.verticalizable&&(xn=Kt.lineOffset/2-(Ht.imageName?-(Al-Ht.metrics.width*Ht.scale)/2:(Ht.scale-1)*Al)),Ht.imageName){const ws=_t[Ht.imageName];yi=ws.sdf,Xi=ws.pixelRatio,ci=fl/Xi}const An=et?[Ht.x+an,Ht.y]:[0,0];let zn=et?[0,0]:[Ht.x+an+Le[0],Ht.y+Le[1]-xn],sn=[0,0];on&&(sn=zn,zn=[0,0]);const Wi=Ht.metrics.isDoubleResolution?2:1,Dn=(Ht.metrics.left-ci)*Ht.scale-an+zn[0],Rn=(-Ht.metrics.top-ci)*Ht.scale+zn[1],pr=Dn+Zt.w/Wi*Ht.scale/Xi,Vr=Rn+Zt.h/Wi*Ht.scale/Xi,Hr=new ae(Dn,Rn),zs=new ae(pr,Rn),Ea=new ae(Dn,Vr),ia=new ae(pr,Vr);if(on){const ws=new ae(-an,an-BA),ir=-Math.PI/2,na=Al/2-an,Ps=new ae(5-BA-na,-(Ht.imageName?na:0)),Kn=new ae(...sn);Hr._rotateAround(ir,ws)._add(Ps)._add(Kn),zs._rotateAround(ir,ws)._add(Ps)._add(Kn),Ea._rotateAround(ir,ws)._add(Ps)._add(Kn),ia._rotateAround(ir,ws)._add(Ps)._add(Kn)}if(Dt){const ws=Math.sin(Dt),ir=Math.cos(Dt),na=[ir,-ws,ws,ir];Hr._matMult(na),zs._matMult(na),Ea._matMult(na),ia._matMult(na)}const ns=new ae(0,0),Wn=new ae(0,0);Bt.push({tl:Hr,tr:zs,bl:Ea,br:ia,tex:Zt,writingMode:_e.writingMode,glyphOffset:An,sectionIndex:Ht.sectionIndex,isSDF:yi,pixelOffsetTL:ns,pixelOffsetBR:Wn,minFontScaleX:0,minFontScaleY:0})}return Bt}(0,x,me,q,K,J,M,m.allowVerticalPlacement),Q=m.textSizeData;let re=null;Q.kind==="source"?(re=[Pc*q.layout.get("text-size").evaluate(J,{})],re[0]>rh&&dt(`${m.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)):Q.kind==="composite"&&(re=[Pc*S.compositeTextSizes[0].evaluate(J,{},L),Pc*S.compositeTextSizes[1].evaluate(J,{},L)],(re[0]>rh||re[1]>rh)&&dt(`${m.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)),m.addSymbols(m.text,U,re,me,K,J,Oe,h,Ce.lineStartIndex,Ce.lineLength,p,L);for(const Ae of f)u[Ae]=m.text.placedSymbolArray.length-1;return 4*U.length}function Rd(m){for(const h in m)return m[h];return null}function ZA(m,h,x,M){const q=m.compareText;if(h in q){const K=q[h];for(let J=K.length-1;J>=0;J--)if(M.dist(K[J])<x)return!0}else q[h]=[];return q[h].push(M),!1}const Bl=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Bc{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[x,M]=new Uint8Array(h,0,2);if(x!==219)throw new Error("Data does not appear to be in a KDBush format.");const q=M>>4;if(q!==1)throw new Error(`Got v${q} data when expected v1.`);const K=Bl[15&M];if(!K)throw new Error("Unrecognized array type.");const[J]=new Uint16Array(h,2,1),[me]=new Uint32Array(h,4,1);return new Bc(me,J,K,h)}constructor(h,x=64,M=Float64Array,q){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+x,2),65535),this.ArrayType=M,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const K=Bl.indexOf(this.ArrayType),J=2*h*this.ArrayType.BYTES_PER_ELEMENT,me=h*this.IndexArrayType.BYTES_PER_ELEMENT,Ce=(8-me%8)%8;if(K<0)throw new Error(`Unexpected typed array class: ${M}.`);q&&q instanceof ArrayBuffer?(this.data=q,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+J+me+Ce),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+K]),new Uint16Array(this.data,2,1)[0]=x,new Uint32Array(this.data,4,1)[0]=h)}add(h,x){const M=this._pos>>1;return this.ids[M]=M,this.coords[this._pos++]=h,this.coords[this._pos++]=x,M}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return Mh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,x,M,q){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:K,coords:J,nodeSize:me}=this,Ce=[0,K.length-1,0],Oe=[];for(;Ce.length;){const f=Ce.pop()||0,u=Ce.pop()||0,p=Ce.pop()||0;if(u-p<=me){for(let Q=p;Q<=u;Q++){const re=J[2*Q],Ae=J[2*Q+1];re>=h&&re<=M&&Ae>=x&&Ae<=q&&Oe.push(K[Q])}continue}const S=p+u>>1,L=J[2*S],U=J[2*S+1];L>=h&&L<=M&&U>=x&&U<=q&&Oe.push(K[S]),(f===0?h<=L:x<=U)&&(Ce.push(p),Ce.push(S-1),Ce.push(1-f)),(f===0?M>=L:q>=U)&&(Ce.push(S+1),Ce.push(u),Ce.push(1-f))}return Oe}within(h,x,M){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:q,coords:K,nodeSize:J}=this,me=[0,q.length-1,0],Ce=[],Oe=M*M;for(;me.length;){const f=me.pop()||0,u=me.pop()||0,p=me.pop()||0;if(u-p<=J){for(let Q=p;Q<=u;Q++)D0(K[2*Q],K[2*Q+1],h,x)<=Oe&&Ce.push(q[Q]);continue}const S=p+u>>1,L=K[2*S],U=K[2*S+1];D0(L,U,h,x)<=Oe&&Ce.push(q[S]),(f===0?h-M<=L:x-M<=U)&&(me.push(p),me.push(S-1),me.push(1-f)),(f===0?h+M>=L:x+M>=U)&&(me.push(S+1),me.push(u),me.push(1-f))}return Ce}}function Mh(m,h,x,M,q,K){if(q-M<=x)return;const J=M+q>>1;QA(m,h,J,M,q,K),Mh(m,h,x,M,J-1,1-K),Mh(m,h,x,J+1,q,1-K)}function QA(m,h,x,M,q,K){for(;q>M;){if(q-M>600){const Oe=q-M+1,f=x-M+1,u=Math.log(Oe),p=.5*Math.exp(2*u/3),S=.5*Math.sqrt(u*p*(Oe-p)/Oe)*(f-Oe/2<0?-1:1);QA(m,h,x,Math.max(M,Math.floor(x-f*p/Oe+S)),Math.min(q,Math.floor(x+(Oe-f)*p/Oe+S)),K)}const J=h[2*x+K];let me=M,Ce=q;for(WA(m,h,M,x),h[2*q+K]>J&&WA(m,h,M,q);me<Ce;){for(WA(m,h,me,Ce),me++,Ce--;h[2*me+K]<J;)me++;for(;h[2*Ce+K]>J;)Ce--}h[2*M+K]===J?WA(m,h,M,Ce):(Ce++,WA(m,h,Ce,q)),Ce<=x&&(M=Ce+1),x<=Ce&&(q=Ce-1)}}function WA(m,h,x,M){Rf(m,x,M),Rf(h,2*x,2*M),Rf(h,2*x+1,2*M+1)}function Rf(m,h,x){const M=m[h];m[h]=m[x],m[x]=M}function D0(m,h,x,M){const q=m-x,K=h-M;return q*q+K*K}var Ff;I.bc=void 0,(Ff=I.bc||(I.bc={})).create="create",Ff.load="load",Ff.fullLoad="fullLoad";let Of=null,Nf=[];const L0=1e3/60,Vf="loadTime",Uf="fullLoadTime",Gp={mark(m){performance.mark(m)},frame(m){const h=m;Of!=null&&Nf.push(h-Of),Of=h},clearMetrics(){Of=null,Nf=[],performance.clearMeasures(Vf),performance.clearMeasures(Uf);for(const m in I.bc)performance.clearMarks(I.bc[m])},getPerformanceMetrics(){performance.measure(Vf,I.bc.create,I.bc.load),performance.measure(Uf,I.bc.create,I.bc.fullLoad);const m=performance.getEntriesByName(Vf)[0].duration,h=performance.getEntriesByName(Uf)[0].duration,x=Nf.length,M=1/(Nf.reduce((K,J)=>K+J,0)/x/1e3),q=Nf.filter(K=>K>L0).reduce((K,J)=>K+(J-L0)/L0,0);return{loadTime:m,fullLoadTime:h,fps:M,percentDroppedFrames:q/(x+q)*100,totalFrames:x}}};I.$=Qi,I.A=Xu,I.B=function(m){if(Nt==null){const h=m.navigator?m.navigator.userAgent:null;Nt=!!m.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Nt},I.C=class{constructor(m,h){this.target=m,this.mapId=h,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Bp(()=>this.process()),this.subscription=function(x,M,q,K){return x.addEventListener(M,q,!1),{unsubscribe:()=>{x.removeEventListener(M,q,!1)}}}(this.target,"message",x=>this.receive(x)),this.globalScope=st(self)?m:window}registerMessageHandler(m,h){this.messageHandlers[m]=h}sendAsync(m,h){return new Promise((x,M)=>{const q=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[q]={resolve:x,reject:M},h&&h.signal.addEventListener("abort",()=>{delete this.resolveRejects[q];const me={id:q,type:"<cancel>",origin:location.origin,targetMapId:m.targetMapId,sourceMapId:this.mapId};this.target.postMessage(me)},{once:!0});const K=[],J=Object.assign(Object.assign({},m),{id:q,sourceMapId:this.mapId,origin:location.origin,data:Nl(m.data,K)});this.target.postMessage(J,{transfer:K})})}receive(m){const h=m.data,x=h.id;if(!(h.origin!=="file://"&&location.origin!=="file://"&&h.origin!==location.origin||h.targetMapId&&this.mapId!==h.targetMapId)){if(h.type==="<cancel>"){delete this.tasks[x];const M=this.abortControllers[x];return delete this.abortControllers[x],void(M&&M.abort())}if(st(self)||h.mustQueue)return this.tasks[x]=h,this.taskQueue.push(x),void this.invoker.trigger();this.processTask(x,h)}}process(){if(this.taskQueue.length===0)return;const m=this.taskQueue.shift(),h=this.tasks[m];delete this.tasks[m],this.taskQueue.length>0&&this.invoker.trigger(),h&&this.processTask(m,h)}processTask(m,h){return a(this,void 0,void 0,function*(){if(h.type==="<response>"){const q=this.resolveRejects[m];return delete this.resolveRejects[m],q?void(h.error?q.reject(En(h.error)):q.resolve(En(h.data))):void 0}if(!this.messageHandlers[h.type])return void this.completeTask(m,new Error(`Could not find a registered handler for ${h.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const x=En(h.data),M=new AbortController;this.abortControllers[m]=M;try{const q=yield this.messageHandlers[h.type](h.sourceMapId,x,M);this.completeTask(m,null,q)}catch(q){this.completeTask(m,q)}})}completeTask(m,h,x){const M=[];delete this.abortControllers[m];const q={id:m,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:h?Nl(h):null,data:Nl(x,M)};this.target.postMessage(q,{transfer:M})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},I.D=gn,I.E=pn,I.F=function(){var m=new Xu(16);return Xu!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0),m[0]=1,m[5]=1,m[10]=1,m[15]=1,m},I.G=nn,I.H=function(m,h,x){var M,q,K,J,me,Ce,Oe,f,u,p,S,L,U=x[0],Q=x[1],re=x[2];return h===m?(m[12]=h[0]*U+h[4]*Q+h[8]*re+h[12],m[13]=h[1]*U+h[5]*Q+h[9]*re+h[13],m[14]=h[2]*U+h[6]*Q+h[10]*re+h[14],m[15]=h[3]*U+h[7]*Q+h[11]*re+h[15]):(q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Oe=h[6],f=h[7],u=h[8],p=h[9],S=h[10],L=h[11],m[0]=M=h[0],m[1]=q,m[2]=K,m[3]=J,m[4]=me,m[5]=Ce,m[6]=Oe,m[7]=f,m[8]=u,m[9]=p,m[10]=S,m[11]=L,m[12]=M*U+me*Q+u*re+h[12],m[13]=q*U+Ce*Q+p*re+h[13],m[14]=K*U+Oe*Q+S*re+h[14],m[15]=J*U+f*Q+L*re+h[15]),m},I.I=y0,I.J=function(m,h,x){var M=x[0],q=x[1],K=x[2];return m[0]=h[0]*M,m[1]=h[1]*M,m[2]=h[2]*M,m[3]=h[3]*M,m[4]=h[4]*q,m[5]=h[5]*q,m[6]=h[6]*q,m[7]=h[7]*q,m[8]=h[8]*K,m[9]=h[9]*K,m[10]=h[10]*K,m[11]=h[11]*K,m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},I.K=vh,I.L=function(m,h){const x={};for(let M=0;M<h.length;M++){const q=h[M];q in m&&(x[q]=m[q])}return x},I.M=ah,I.N=bd,I.O=wd,I.P=ae,I.Q=Mu,I.R=Vu,I.S=lt,I.T=_u,I.U=ut,I.V=_i,I.W=Ws,I.X=xs,I.Y=E0,I.Z=class extends hl{},I._=a,I.a=qi,I.a$=function(m,h){return m[0]*h[0]+m[1]*h[1]+m[2]*h[2]+m[3]*h[3]},I.a0=Lc,I.a1=$,I.a2=m=>{const h=window.document.createElement("video");return h.muted=!0,new Promise(x=>{h.onloadstart=()=>{x(h)};for(const M of m){const q=window.document.createElement("source");Ri(M)||(h.crossOrigin="Anonymous"),q.src=M,h.appendChild(q)}})},I.a3=function(){return rt++},I.a4=s,I.a5=tA,I.a6=hs,I.a7=vl,I.a8=fs,I.a9=Cd,I.aA=gt,I.aB=function(m,h){if(!m)return[{command:"setStyle",args:[h]}];let x=[];try{if(!hi(m.version,h.version))return[{command:"setStyle",args:[h]}];hi(m.center,h.center)||x.push({command:"setCenter",args:[h.center]}),hi(m.zoom,h.zoom)||x.push({command:"setZoom",args:[h.zoom]}),hi(m.bearing,h.bearing)||x.push({command:"setBearing",args:[h.bearing]}),hi(m.pitch,h.pitch)||x.push({command:"setPitch",args:[h.pitch]}),hi(m.sprite,h.sprite)||x.push({command:"setSprite",args:[h.sprite]}),hi(m.glyphs,h.glyphs)||x.push({command:"setGlyphs",args:[h.glyphs]}),hi(m.transition,h.transition)||x.push({command:"setTransition",args:[h.transition]}),hi(m.light,h.light)||x.push({command:"setLight",args:[h.light]}),hi(m.terrain,h.terrain)||x.push({command:"setTerrain",args:[h.terrain]}),hi(m.sky,h.sky)||x.push({command:"setSky",args:[h.sky]});const M={},q=[];(function(J,me,Ce,Oe){let f;for(f in me=me||{},J=J||{})Object.prototype.hasOwnProperty.call(J,f)&&(Object.prototype.hasOwnProperty.call(me,f)||Fn(f,Ce,Oe));for(f in me)Object.prototype.hasOwnProperty.call(me,f)&&(Object.prototype.hasOwnProperty.call(J,f)?hi(J[f],me[f])||(J[f].type==="geojson"&&me[f].type==="geojson"&&In(J,me,f)?en(Ce,{command:"setGeoJSONSourceData",args:[f,me[f].data]}):Qn(f,me,Ce,Oe)):tr(f,me,Ce))})(m.sources,h.sources,q,M);const K=[];m.layers&&m.layers.forEach(J=>{"source"in J&&M[J.source]?x.push({command:"removeLayer",args:[J.id]}):K.push(J)}),x=x.concat(q),function(J,me,Ce){me=me||[];const Oe=(J=J||[]).map(k),f=me.map(k),u=J.reduce(V,{}),p=me.reduce(V,{}),S=Oe.slice(),L=Object.create(null);let U,Q,re,Ae,_e;for(let Le=0,qe=0;Le<Oe.length;Le++)U=Oe[Le],Object.prototype.hasOwnProperty.call(p,U)?qe++:(en(Ce,{command:"removeLayer",args:[U]}),S.splice(S.indexOf(U,qe),1));for(let Le=0,qe=0;Le<f.length;Le++)U=f[f.length-1-Le],S[S.length-1-Le]!==U&&(Object.prototype.hasOwnProperty.call(u,U)?(en(Ce,{command:"removeLayer",args:[U]}),S.splice(S.lastIndexOf(U,S.length-qe),1)):qe++,Ae=S[S.length-Le],en(Ce,{command:"addLayer",args:[p[U],Ae]}),S.splice(S.length-Le,0,U),L[U]=!0);for(let Le=0;Le<f.length;Le++)if(U=f[Le],Q=u[U],re=p[U],!L[U]&&!hi(Q,re))if(hi(Q.source,re.source)&&hi(Q["source-layer"],re["source-layer"])&&hi(Q.type,re.type)){for(_e in v(Q.layout,re.layout,Ce,U,null,"setLayoutProperty"),v(Q.paint,re.paint,Ce,U,null,"setPaintProperty"),hi(Q.filter,re.filter)||en(Ce,{command:"setFilter",args:[U,re.filter]}),hi(Q.minzoom,re.minzoom)&&hi(Q.maxzoom,re.maxzoom)||en(Ce,{command:"setLayerZoomRange",args:[U,re.minzoom,re.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,U,_e.slice(6),"setPaintProperty"):hi(Q[_e],re[_e])||en(Ce,{command:"setLayerProperty",args:[U,_e,re[_e]]}));for(_e in re)Object.prototype.hasOwnProperty.call(re,_e)&&!Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,U,_e.slice(6),"setPaintProperty"):hi(Q[_e],re[_e])||en(Ce,{command:"setLayerProperty",args:[U,_e,re[_e]]}))}else en(Ce,{command:"removeLayer",args:[U]}),Ae=S[S.lastIndexOf(U)+1],en(Ce,{command:"addLayer",args:[re,Ae]})}(K,h.layers,x)}catch(M){console.warn("Unable to compute style diff:",M),x=[{command:"setStyle",args:[h]}]}return x},I.aC=function(m){const h=[],x=m.id;return x===void 0&&h.push({message:`layers.${x}: missing required property "id"`}),m.render===void 0&&h.push({message:`layers.${x}: missing required method "render"`}),m.renderingMode&&m.renderingMode!=="2d"&&m.renderingMode!=="3d"&&h.push({message:`layers.${x}: property "renderingMode" must be either "2d" or "3d"`}),h},I.aD=function m(h,x){if(Array.isArray(h)){if(!Array.isArray(x)||h.length!==x.length)return!1;for(let M=0;M<h.length;M++)if(!m(h[M],x[M]))return!1;return!0}if(typeof h=="object"&&h!==null&&x!==null){if(typeof x!="object"||Object.keys(h).length!==Object.keys(x).length)return!1;for(const M in h)if(!m(h[M],x[M]))return!1;return!0}return h===x},I.aE=yt,I.aF=pt,I.aG=class extends ao{constructor(m,h){super(m,h),this.current=0}set(m){this.current!==m&&(this.current=m,this.gl.uniform1i(this.location,m))}},I.aH=qr,I.aI=class extends ao{constructor(m,h){super(m,h),this.current=yo}set(m){if(m[12]!==this.current[12]||m[0]!==this.current[0])return this.current=m,void this.gl.uniformMatrix4fv(this.location,!1,m);for(let h=1;h<16;h++)if(m[h]!==this.current[h]){this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);break}}},I.aJ=ya,I.aK=class extends ao{constructor(m,h){super(m,h),this.current=[0,0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]||(this.current=m,this.gl.uniform3f(this.location,m[0],m[1],m[2]))}},I.aL=class extends ao{constructor(m,h){super(m,h),this.current=[0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]||(this.current=m,this.gl.uniform2f(this.location,m[0],m[1]))}},I.aM=_o,I.aN=function(m,h,x,M,q,K,J){var me=1/(h-x),Ce=1/(M-q),Oe=1/(K-J);return m[0]=-2*me,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=-2*Ce,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2*Oe,m[11]=0,m[12]=(h+x)*me,m[13]=(q+M)*Ce,m[14]=(J+K)*Oe,m[15]=1,m},I.aO=mn,I.aP=mA,I.aQ=class extends We{},I.aR=rd,I.aS=class extends Ct{},I.aT=function(m){return m<=1?1:Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))},I.aU=_A,I.aV=ce,I.aW=class extends F{},I.aX=Yt,I.aY=function(m,h){var x=m[0],M=m[1],q=m[2],K=m[3],J=m[4],me=m[5],Ce=m[6],Oe=m[7],f=m[8],u=m[9],p=m[10],S=m[11],L=m[12],U=m[13],Q=m[14],re=m[15],Ae=h[0],_e=h[1],Le=h[2],qe=h[3],et=h[4],At=h[5],_t=h[6],Mt=h[7],Dt=h[8],Bt=h[9],Kt=h[10],Ht=h[11],Zt=h[12],ci=h[13],yi=h[14],Xi=h[15];return Math.abs(x-Ae)<=Ql*Math.max(1,Math.abs(x),Math.abs(Ae))&&Math.abs(M-_e)<=Ql*Math.max(1,Math.abs(M),Math.abs(_e))&&Math.abs(q-Le)<=Ql*Math.max(1,Math.abs(q),Math.abs(Le))&&Math.abs(K-qe)<=Ql*Math.max(1,Math.abs(K),Math.abs(qe))&&Math.abs(J-et)<=Ql*Math.max(1,Math.abs(J),Math.abs(et))&&Math.abs(me-At)<=Ql*Math.max(1,Math.abs(me),Math.abs(At))&&Math.abs(Ce-_t)<=Ql*Math.max(1,Math.abs(Ce),Math.abs(_t))&&Math.abs(Oe-Mt)<=Ql*Math.max(1,Math.abs(Oe),Math.abs(Mt))&&Math.abs(f-Dt)<=Ql*Math.max(1,Math.abs(f),Math.abs(Dt))&&Math.abs(u-Bt)<=Ql*Math.max(1,Math.abs(u),Math.abs(Bt))&&Math.abs(p-Kt)<=Ql*Math.max(1,Math.abs(p),Math.abs(Kt))&&Math.abs(S-Ht)<=Ql*Math.max(1,Math.abs(S),Math.abs(Ht))&&Math.abs(L-Zt)<=Ql*Math.max(1,Math.abs(L),Math.abs(Zt))&&Math.abs(U-ci)<=Ql*Math.max(1,Math.abs(U),Math.abs(ci))&&Math.abs(Q-yi)<=Ql*Math.max(1,Math.abs(Q),Math.abs(yi))&&Math.abs(re-Xi)<=Ql*Math.max(1,Math.abs(re),Math.abs(Xi))},I.aZ=function(m,h){return m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[4]=h[4],m[5]=h[5],m[6]=h[6],m[7]=h[7],m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},I.a_=function(m,h,x){return m[0]=h[0]*x[0],m[1]=h[1]*x[1],m[2]=h[2]*x[2],m[3]=h[3]*x[3],m},I.aa=function(m){const h={};if(m.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(x,M,q,K)=>{const J=q||K;return h[M]=!J||J.toLowerCase(),""}),h["max-age"]){const x=parseInt(h["max-age"],10);isNaN(x)?delete h["max-age"]:h["max-age"]=x}return h},I.ab=function(m,h){const x=[];for(const M in m)M in h||x.push(M);return x},I.ac=zt,I.ad=function(m,h,x){var M=Math.sin(x),q=Math.cos(x),K=h[0],J=h[1],me=h[2],Ce=h[3],Oe=h[4],f=h[5],u=h[6],p=h[7];return h!==m&&(m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[0]=K*q+Oe*M,m[1]=J*q+f*M,m[2]=me*q+u*M,m[3]=Ce*q+p*M,m[4]=Oe*q-K*M,m[5]=f*q-J*M,m[6]=u*q-me*M,m[7]=p*q-Ce*M,m},I.ae=function(m){var h=new Xu(16);return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h[6]=m[6],h[7]=m[7],h[8]=m[8],h[9]=m[9],h[10]=m[10],h[11]=m[11],h[12]=m[12],h[13]=m[13],h[14]=m[14],h[15]=m[15],h},I.af=uf,I.ag=function(m,h){let x=0,M=0;if(m.kind==="constant")M=m.layoutSize;else if(m.kind!=="source"){const{interpolationType:q,minZoom:K,maxZoom:J}=m,me=q?zt(Ks.interpolationFactor(q,h,K,J),0,1):0;m.kind==="camera"?M=vr.number(m.minSize,m.maxSize,me):x=me}return{uSizeT:x,uSize:M}},I.ai=function(m,{uSize:h,uSizeT:x},{lowerSize:M,upperSize:q}){return m.kind==="source"?M/Pc:m.kind==="composite"?vr.number(M/Pc,q/Pc,x):h},I.aj=S0,I.ak=function(m,h,x,M){const q=h.y-m.y,K=h.x-m.x,J=M.y-x.y,me=M.x-x.x,Ce=J*K-me*q;if(Ce===0)return null;const Oe=(me*(m.y-x.y)-J*(m.x-x.x))/Ce;return new ae(m.x+Oe*K,m.y+Oe*q)},I.al=Md,I.am=af,I.an=H0,I.ao=Al,I.aq=kf,I.ar=function(m,h){var x=h[0],M=h[1],q=h[2],K=h[3],J=h[4],me=h[5],Ce=h[6],Oe=h[7],f=h[8],u=h[9],p=h[10],S=h[11],L=h[12],U=h[13],Q=h[14],re=h[15],Ae=x*me-M*J,_e=x*Ce-q*J,Le=x*Oe-K*J,qe=M*Ce-q*me,et=M*Oe-K*me,At=q*Oe-K*Ce,_t=f*U-u*L,Mt=f*Q-p*L,Dt=f*re-S*L,Bt=u*Q-p*U,Kt=u*re-S*U,Ht=p*re-S*Q,Zt=Ae*Ht-_e*Kt+Le*Bt+qe*Dt-et*Mt+At*_t;return Zt?(m[0]=(me*Ht-Ce*Kt+Oe*Bt)*(Zt=1/Zt),m[1]=(q*Kt-M*Ht-K*Bt)*Zt,m[2]=(U*At-Q*et+re*qe)*Zt,m[3]=(p*et-u*At-S*qe)*Zt,m[4]=(Ce*Dt-J*Ht-Oe*Mt)*Zt,m[5]=(x*Ht-q*Dt+K*Mt)*Zt,m[6]=(Q*Le-L*At-re*_e)*Zt,m[7]=(f*At-p*Le+S*_e)*Zt,m[8]=(J*Kt-me*Dt+Oe*_t)*Zt,m[9]=(M*Dt-x*Kt-K*_t)*Zt,m[10]=(L*et-U*Le+re*Ae)*Zt,m[11]=(u*Le-f*et-S*Ae)*Zt,m[12]=(me*Mt-J*Bt-Ce*_t)*Zt,m[13]=(x*Bt-M*Mt+q*_t)*Zt,m[14]=(U*_e-L*qe-Q*Ae)*Zt,m[15]=(f*qe-u*_e+p*Ae)*Zt,m):null},I.as=P0,I.at=OA,I.au=Bc,I.av=function(){const m={},h=ii.$version;for(const x in ii.$root){const M=ii.$root[x];if(M.required){let q=null;q=x==="version"?h:M.type==="array"?[]:{},q!=null&&(m[x]=q)}}return m},I.aw=Hl,I.ax=Ci,I.ay=function(m){m=m.slice();const h=Object.create(null);for(let x=0;x<m.length;x++)h[m[x].id]=m[x];for(let x=0;x<m.length;x++)"ref"in m[x]&&(m[x]=Rr(m[x],h[m[x].ref]));return m},I.az=function(m){if(m.type==="custom")return new xd(m);switch(m.type){case"background":return new yd(m);case"circle":return new u0(m);case"fill":return new d0(m);case"fill-extrusion":return new Jh(m);case"heatmap":return new c0(m);case"hillshade":return new xu(m);case"line":return new Lm(m);case"raster":return new Lp(m);case"symbol":return new NA(m)}},I.b=Rt,I.b0=Ge,I.b1=Sd,I.b2=Fp,I.b3=function(m,h,x,M,q){var K,J=1/Math.tan(h/2);return m[0]=J/x,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=J,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=-1,m[12]=0,m[13]=0,m[15]=0,q!=null&&q!==1/0?(m[10]=(q+M)*(K=1/(M-q)),m[14]=2*q*M*K):(m[10]=-1,m[14]=-2*M),m},I.b4=function(m,h,x){var M=Math.sin(x),q=Math.cos(x),K=h[4],J=h[5],me=h[6],Ce=h[7],Oe=h[8],f=h[9],u=h[10],p=h[11];return h!==m&&(m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[4]=K*q+Oe*M,m[5]=J*q+f*M,m[6]=me*q+u*M,m[7]=Ce*q+p*M,m[8]=Oe*q-K*M,m[9]=f*q-J*M,m[10]=u*q-me*M,m[11]=p*q-Ce*M,m},I.b5=Tt,I.b6=Pt,I.b7=function(m){return m*Math.PI/180},I.b8=function(m,h){return m[0]=h[0],m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=h[1],m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=h[2],m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},I.b9=class extends cs{},I.ba=VA,I.bb=Gp,I.bd=yn,I.be=function(m,h){qi.REGISTERED_PROTOCOLS[m]=h},I.bf=function(m){delete qi.REGISTERED_PROTOCOLS[m]},I.bg=function(m,h){const x={};for(let q=0;q<m.length;q++){const K=h&&h[m[q].id]||Jo(m[q]);h&&(h[m[q].id]=K);let J=x[K];J||(J=x[K]=[]),J.push(m[q])}const M=[];for(const q in x)M.push(x[q]);return M},I.bh=Sn,I.bi=Ed,I.bj=T0,I.bk=v0,I.bl=function(m){m.bucket.createArrays(),m.bucket.tilePixelRatio=Ws/(512*m.bucket.overscaling),m.bucket.compareText={},m.bucket.iconsNeedLinear=!1;const h=m.bucket.layers[0],x=h.layout,M=h._unevaluatedLayout._values,q={layoutIconSize:M["icon-size"].possiblyEvaluate(new fs(m.bucket.zoom+1),m.canonical),layoutTextSize:M["text-size"].possiblyEvaluate(new fs(m.bucket.zoom+1),m.canonical),textMaxSize:M["text-size"].possiblyEvaluate(new fs(18))};if(m.bucket.textSizeData.kind==="composite"){const{minZoom:Oe,maxZoom:f}=m.bucket.textSizeData;q.compositeTextSizes=[M["text-size"].possiblyEvaluate(new fs(Oe),m.canonical),M["text-size"].possiblyEvaluate(new fs(f),m.canonical)]}if(m.bucket.iconSizeData.kind==="composite"){const{minZoom:Oe,maxZoom:f}=m.bucket.iconSizeData;q.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new fs(Oe),m.canonical),M["icon-size"].possiblyEvaluate(new fs(f),m.canonical)]}const K=x.get("text-line-height")*Al,J=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point",me=x.get("text-keep-upright"),Ce=x.get("text-size");for(const Oe of m.bucket.features){const f=x.get("text-font").evaluate(Oe,{},m.canonical).join(","),u=Ce.evaluate(Oe,{},m.canonical),p=q.layoutTextSize.evaluate(Oe,{},m.canonical),S=q.layoutIconSize.evaluate(Oe,{},m.canonical),L={horizontal:{},vertical:void 0},U=Oe.text;let Q,re=[0,0];if(U){const Le=U.toString(),qe=x.get("text-letter-spacing").evaluate(Oe,{},m.canonical)*Al,et=uu(Le)?qe:0,At=x.get("text-anchor").evaluate(Oe,{},m.canonical),_t=rA(h,Oe,m.canonical);if(!_t){const Ht=x.get("text-radial-offset").evaluate(Oe,{},m.canonical);re=Ht?jA(At,[Ht*Al,nA]):x.get("text-offset").evaluate(Oe,{},m.canonical).map(Zt=>Zt*Al)}let Mt=J?"center":x.get("text-justify").evaluate(Oe,{},m.canonical);const Dt=x.get("symbol-placement"),Bt=Dt==="point"?x.get("text-max-width").evaluate(Oe,{},m.canonical)*Al:0,Kt=()=>{m.bucket.allowVerticalPlacement&&_l(Le)&&(L.vertical=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Bt,K,At,"left",et,re,I.ah.vertical,!0,Dt,p,u))};if(!J&&_t){const Ht=new Set;if(Mt==="auto")for(let ci=0;ci<_t.values.length;ci+=2)Ht.add(P0(_t.values[ci]));else Ht.add(Mt);let Zt=!1;for(const ci of Ht)if(!L.horizontal[ci])if(Zt)L.horizontal[ci]=L.horizontal[0];else{const yi=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Bt,K,"center",ci,et,re,I.ah.horizontal,!1,Dt,p,u);yi&&(L.horizontal[ci]=yi,Zt=yi.positionedLines.length===1)}Kt()}else{Mt==="auto"&&(Mt=P0(At));const Ht=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Bt,K,At,Mt,et,re,I.ah.horizontal,!1,Dt,p,u);Ht&&(L.horizontal[Mt]=Ht),Kt(),_l(Le)&&J&&me&&(L.vertical=Cf(U,m.glyphMap,m.glyphPositions,m.imagePositions,f,Bt,K,At,Mt,et,re,I.ah.vertical,!1,Dt,p,u))}}let Ae=!1;if(Oe.icon&&Oe.icon.name){const Le=m.imageMap[Oe.icon.name];Le&&(Q=Om(m.imagePositions[Oe.icon.name],x.get("icon-offset").evaluate(Oe,{},m.canonical),x.get("icon-anchor").evaluate(Oe,{},m.canonical)),Ae=!!Le.sdf,m.bucket.sdfIcons===void 0?m.bucket.sdfIcons=Ae:m.bucket.sdfIcons!==Ae&&dt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==m.bucket.pixelRatio||x.get("icon-rotate").constantOr(1)!==0)&&(m.bucket.iconsNeedLinear=!0))}const _e=Rd(L.horizontal)||L.vertical;m.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||Q)&&Up(m.bucket,Oe,L,Q,m.imageMap,q,p,S,re,Ae,m.canonical)}m.showCollisionBoxes&&m.bucket.generateCollisionDebugBuffers()},I.bm=eA,I.bn=Xh,I.bo=SA,I.bp=uc,I.bq=hd,I.br=class{constructor(m){this._marks={start:[m.url,"start"].join("#"),end:[m.url,"end"].join("#"),measure:m.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let m=performance.getEntriesByName(this._marks.measure);return m.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),m=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),m}},I.bs=function(m,h,x,M,q){return a(this,void 0,void 0,function*(){if(ut())try{return yield _i(m,h,x,M,q)}catch{}return function(K,J,me,Ce,Oe){const f=K.width,u=K.height;Si&&Ti||(Si=new OffscreenCanvas(f,u),Ti=Si.getContext("2d",{willReadFrequently:!0})),Si.width=f,Si.height=u,Ti.drawImage(K,0,0,f,u);const p=Ti.getImageData(J,me,Ce,Oe);return Ti.clearRect(0,0,f,u),p.data}(m,h,x,M,q)})},I.bt=Id,I.bu=G,I.bv=W,I.bw=sd,I.bx=Ts,I.by=function(m){return m.message===Oi},I.bz=jl,I.c=tn,I.d=m=>a(void 0,void 0,void 0,function*(){if(m.byteLength===0)return createImageBitmap(new ImageData(1,1));const h=new Blob([new Uint8Array(m)],{type:"image/png"});try{return createImageBitmap(h)}catch(x){throw new Error(`Could not load image because of ${x.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),I.e=Xt,I.f=m=>new Promise((h,x)=>{const M=new Image;M.onload=()=>{h(M),URL.revokeObjectURL(M.src),M.onload=null,window.requestAnimationFrame(()=>{M.src=Ot})},M.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(m)],{type:"image/png"});M.src=m.byteLength?URL.createObjectURL(q):Ot}),I.g=Ni,I.h=(m,h)=>gi(Xt(m,{type:"json"}),h),I.i=st,I.j=fi,I.k=Ji,I.l=(m,h)=>gi(Xt(m,{type:"arrayBuffer"}),h),I.m=gi,I.n=function(m){return new hd(m).readFields(zm,[])},I.o=Dl,I.p=LA,I.q=oa,I.r=Qu,I.s=Ri,I.t=Ml,I.u=Cn,I.v=ii,I.w=dt,I.x=rs,I.y=function([m,h,x]){return h+=90,h*=Math.PI/180,x*=Math.PI/180,{x:m*Math.cos(h)*Math.sin(x),y:m*Math.sin(h)*Math.sin(x),z:m*Math.cos(x)}},I.z=vr}),g("worker",["./shared"],function(I){class a{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,ne){for(const ie of se){this._layerConfigs[ie.id]=ie;const de=this._layers[ie.id]=I.az(ie);de._featureFilter=I.a6(de.filter),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of ne)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const X=I.bg(Object.values(this._layerConfigs),this.keyCache);for(const ie of X){const de=ie.map(Xe=>this._layers[Xe.id]),ye=de[0];if(ye.visibility==="none")continue;const ge=ye.source||"";let Pe=this.familiesBySource[ge];Pe||(Pe=this.familiesBySource[ge]={});const Fe=ye.sourceLayer||"_geojsonTileLayer";let Ne=Pe[Fe];Ne||(Ne=Pe[Fe]=[]),Ne.push(de)}}}class G{constructor(se){const ne={},X=[];for(const ge in se){const Pe=se[ge],Fe=ne[ge]={};for(const Ne in Pe){const Xe=Pe[+Ne];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Ye={x:0,y:0,w:Xe.bitmap.width+2,h:Xe.bitmap.height+2};X.push(Ye),Fe[Ne]={rect:Ye,metrics:Xe.metrics}}}const{w:ie,h:de}=I.p(X),ye=new I.o({width:ie||1,height:de||1});for(const ge in se){const Pe=se[ge];for(const Fe in Pe){const Ne=Pe[+Fe];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const Xe=ne[ge][Fe].rect;I.o.copy(Ne.bitmap,ye,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},Ne.bitmap)}}this.image=ye,this.positions=ne}}I.bh("GlyphAtlas",G);class W{constructor(se){this.tileID=new I.Q(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),this.uid=se.uid,this.zoom=se.zoom,this.pixelRatio=se.pixelRatio,this.tileSize=se.tileSize,this.source=se.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=se.showCollisionBoxes,this.collectResourceTiming=!!se.collectResourceTiming,this.returnDependencies=!!se.returnDependencies,this.promoteId=se.promoteId,this.inFlightDependencies=[]}parse(se,ne,X,ie){return I._(this,void 0,void 0,function*(){this.status="parsing",this.data=se,this.collisionBoxArray=new I.a4;const de=new I.bi(Object.keys(se.layers).sort()),ye=new I.bj(this.tileID,this.promoteId);ye.bucketLayerIDs=[];const ge={},Pe={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X},Fe=ne.familiesBySource[this.source];for(const Ai in Fe){const Jt=se.layers[Ai];if(!Jt)continue;Jt.version===1&&I.w(`Vector tile source "${this.source}" layer "${Ai}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const li=de.encode(Ai),zi=[];for(let vi=0;vi<Jt.length;vi++){const wi=Jt.feature(vi),$t=ye.getId(wi,Ai);zi.push({feature:wi,id:$t,index:vi,sourceLayerIndex:li})}for(const vi of Fe[Ai]){const wi=vi[0];wi.source!==this.source&&I.w(`layer.source = ${wi.source} does not equal this.source = ${this.source}`),wi.minzoom&&this.zoom<Math.floor(wi.minzoom)||wi.maxzoom&&this.zoom>=wi.maxzoom||wi.visibility!=="none"&&(he(vi,this.zoom,X),(ge[wi.id]=wi.createBucket({index:ye.bucketLayerIDs.length,layers:vi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:li,sourceID:this.source})).populate(zi,Pe,this.tileID.canonical),ye.bucketLayerIDs.push(vi.map($t=>$t.id)))}}const Ne=I.aE(Pe.glyphDependencies,Ai=>Object.keys(Ai).map(Number));this.inFlightDependencies.forEach(Ai=>Ai==null?void 0:Ai.abort()),this.inFlightDependencies=[];let Xe=Promise.resolve({});if(Object.keys(Ne).length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),Xe=ie.sendAsync({type:"getGlyphs",data:{stacks:Ne,source:this.source,tileID:this.tileID,type:"glyphs"}},Ai)}const Ye=Object.keys(Pe.iconDependencies);let De=Promise.resolve({});if(Ye.length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),De=ie.sendAsync({type:"getImages",data:{icons:Ye,source:this.source,tileID:this.tileID,type:"icons"}},Ai)}const Ue=Object.keys(Pe.patternDependencies);let ht=Promise.resolve({});if(Ue.length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),ht=ie.sendAsync({type:"getImages",data:{icons:Ue,source:this.source,tileID:this.tileID,type:"patterns"}},Ai)}const[kt,o,ke]=yield Promise.all([Xe,De,ht]),oi=new G(kt),di=new I.bk(o,ke);for(const Ai in ge){const Jt=ge[Ai];Jt instanceof I.a5?(he(Jt.layers,this.zoom,X),I.bl({bucket:Jt,glyphMap:kt,glyphPositions:oi.positions,imageMap:o,imagePositions:di.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Jt.hasPattern&&(Jt instanceof I.bm||Jt instanceof I.bn||Jt instanceof I.bo)&&(he(Jt.layers,this.zoom,X),Jt.addFeatures(Pe,this.tileID.canonical,di.patternPositions))}return this.status="done",{buckets:Object.values(ge).filter(Ai=>!Ai.isEmpty()),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:oi.image,imageAtlas:di,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?o:null,glyphPositions:this.returnDependencies?oi.positions:null}})}}function he(Me,se,ne){const X=new I.a8(se);for(const ie of Me)ie.recalculate(X,ne)}class ae{constructor(se,ne,X){this.actor=se,this.layerIndex=ne,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(se,ne){return I._(this,void 0,void 0,function*(){const X=yield I.l(se.request,ne);try{return{vectorTile:new I.bp.VectorTile(new I.bq(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(ie){const de=new Uint8Array(X.data);let ye=`Unable to parse the tile at ${se.request.url}, `;throw ye+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ie.messge}`,new Error(ye)}})}loadTile(se){return I._(this,void 0,void 0,function*(){const ne=se.uid,X=!!(se&&se.request&&se.request.collectResourceTiming)&&new I.br(se.request),ie=new W(se);this.loading[ne]=ie;const de=new AbortController;ie.abort=de;try{const ye=yield this.loadVectorTile(se,de);if(delete this.loading[ne],!ye)return null;const ge=ye.rawData,Pe={};ye.expires&&(Pe.expires=ye.expires),ye.cacheControl&&(Pe.cacheControl=ye.cacheControl);const Fe={};if(X){const Xe=X.finish();Xe&&(Fe.resourceTiming=JSON.parse(JSON.stringify(Xe)))}ie.vectorTile=ye.vectorTile;const Ne=ie.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[ne]=ie,this.fetching[ne]={rawTileData:ge,cacheControl:Pe,resourceTiming:Fe};try{const Xe=yield Ne;return I.e({rawTileData:ge.slice(0)},Xe,Pe,Fe)}finally{delete this.fetching[ne]}}catch(ye){throw delete this.loading[ne],ie.status="done",this.loaded[ne]=ie,ye}})}reloadTile(se){return I._(this,void 0,void 0,function*(){const ne=se.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[ne];if(X.showCollisionBoxes=se.showCollisionBoxes,X.status==="parsing"){const ie=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor);let de;if(this.fetching[ne]){const{rawTileData:ye,cacheControl:ge,resourceTiming:Pe}=this.fetching[ne];delete this.fetching[ne],de=I.e({rawTileData:ye.slice(0)},ie,ge,Pe)}else de=ie;return de}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(se){return I._(this,void 0,void 0,function*(){const ne=this.loading,X=se.uid;ne&&ne[X]&&ne[X].abort&&(ne[X].abort.abort(),delete ne[X])})}removeTile(se){return I._(this,void 0,void 0,function*(){this.loaded&&this.loaded[se.uid]&&delete this.loaded[se.uid]})}}class ue{constructor(){this.loaded={}}loadTile(se){return I._(this,void 0,void 0,function*(){const{uid:ne,encoding:X,rawImageData:ie,redFactor:de,greenFactor:ye,blueFactor:ge,baseShift:Pe}=se,Fe=ie.width+2,Ne=ie.height+2,Xe=I.b(ie)?new I.R({width:Fe,height:Ne},yield I.bs(ie,-1,-1,Fe,Ne)):ie,Ye=new I.bt(ne,Xe,X,de,ye,ge,Pe);return this.loaded=this.loaded||{},this.loaded[ne]=Ye,Ye})}removeTile(se){const ne=this.loaded,X=se.uid;ne&&ne[X]&&delete ne[X]}}function be(Me,se){if(Me.length!==0){Ke(Me[0],se);for(var ne=1;ne<Me.length;ne++)Ke(Me[ne],!se)}}function Ke(Me,se){for(var ne=0,X=0,ie=0,de=Me.length,ye=de-1;ie<de;ye=ie++){var ge=(Me[ie][0]-Me[ye][0])*(Me[ye][1]+Me[ie][1]),Pe=ne+ge;X+=Math.abs(ne)>=Math.abs(ge)?ne-Pe+ge:ge-Pe+ne,ne=Pe}ne+X>=0!=!!se&&Me.reverse()}var ot=I.bu(function Me(se,ne){var X,ie=se&&se.type;if(ie==="FeatureCollection")for(X=0;X<se.features.length;X++)Me(se.features[X],ne);else if(ie==="GeometryCollection")for(X=0;X<se.geometries.length;X++)Me(se.geometries[X],ne);else if(ie==="Feature")Me(se.geometry,ne);else if(ie==="Polygon")be(se.coordinates,ne);else if(ie==="MultiPolygon")for(X=0;X<se.coordinates.length;X++)be(se.coordinates[X],ne);return se});const tt=I.bp.VectorTileFeature.prototype.toGeoJSON;var lt={exports:{}},ut=I.bv,Tt=I.bp.VectorTileFeature,Pt=zt;function zt(Me,se){this.options=se||{},this.features=Me,this.length=Me.length}function Ge(Me,se){this.id=typeof Me.id=="number"?Me.id:void 0,this.type=Me.type,this.rawGeometry=Me.type===1?[Me.geometry]:Me.geometry,this.properties=Me.tags,this.extent=se||4096}zt.prototype.feature=function(Me){return new Ge(this.features[Me],this.options.extent)},Ge.prototype.loadGeometry=function(){var Me=this.rawGeometry;this.geometry=[];for(var se=0;se<Me.length;se++){for(var ne=Me[se],X=[],ie=0;ie<ne.length;ie++)X.push(new ut(ne[ie][0],ne[ie][1]));this.geometry.push(X)}return this.geometry},Ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Me=this.geometry,se=1/0,ne=-1/0,X=1/0,ie=-1/0,de=0;de<Me.length;de++)for(var ye=Me[de],ge=0;ge<ye.length;ge++){var Pe=ye[ge];se=Math.min(se,Pe.x),ne=Math.max(ne,Pe.x),X=Math.min(X,Pe.y),ie=Math.max(ie,Pe.y)}return[se,X,ne,ie]},Ge.prototype.toGeoJSON=Tt.prototype.toGeoJSON;var Xt=I.bw,rt=Pt;function yt(Me){var se=new Xt;return function(ne,X){for(var ie in ne.layers)X.writeMessage(3,pt,ne.layers[ie])}(Me,se),se.finish()}function pt(Me,se){var ne;se.writeVarintField(15,Me.version||1),se.writeStringField(1,Me.name||""),se.writeVarintField(5,Me.extent||4096);var X={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<Me.length;ne++)X.feature=Me.feature(ne),se.writeMessage(2,gt,X);var ie=X.keys;for(ne=0;ne<ie.length;ne++)se.writeStringField(3,ie[ne]);var de=X.values;for(ne=0;ne<de.length;ne++)se.writeMessage(4,st,de[ne])}function gt(Me,se){var ne=Me.feature;ne.id!==void 0&&se.writeVarintField(1,ne.id),se.writeMessage(2,bt,Me),se.writeVarintField(3,ne.type),se.writeMessage(4,mt,ne)}function bt(Me,se){var ne=Me.feature,X=Me.keys,ie=Me.values,de=Me.keycache,ye=Me.valuecache;for(var ge in ne.properties){var Pe=ne.properties[ge],Fe=de[ge];if(Pe!==null){Fe===void 0&&(X.push(ge),de[ge]=Fe=X.length-1),se.writeVarint(Fe);var Ne=typeof Pe;Ne!=="string"&&Ne!=="boolean"&&Ne!=="number"&&(Pe=JSON.stringify(Pe));var Xe=Ne+":"+Pe,Ye=ye[Xe];Ye===void 0&&(ie.push(Pe),ye[Xe]=Ye=ie.length-1),se.writeVarint(Ye)}}}function dt(Me,se){return(se<<3)+(7&Me)}function $e(Me){return Me<<1^Me>>31}function mt(Me,se){for(var ne=Me.loadGeometry(),X=Me.type,ie=0,de=0,ye=ne.length,ge=0;ge<ye;ge++){var Pe=ne[ge],Fe=1;X===1&&(Fe=Pe.length),se.writeVarint(dt(1,Fe));for(var Ne=X===3?Pe.length-1:Pe.length,Xe=0;Xe<Ne;Xe++){Xe===1&&X!==1&&se.writeVarint(dt(2,Ne-1));var Ye=Pe[Xe].x-ie,De=Pe[Xe].y-de;se.writeVarint($e(Ye)),se.writeVarint($e(De)),ie+=Ye,de+=De}X===3&&se.writeVarint(dt(7,1))}}function st(Me,se){var ne=typeof Me;ne==="string"?se.writeStringField(1,Me):ne==="boolean"?se.writeBooleanField(7,Me):ne==="number"&&(Me%1!=0?se.writeDoubleField(3,Me):Me<0?se.writeSVarintField(6,Me):se.writeVarintField(5,Me))}lt.exports=yt,lt.exports.fromVectorTileJs=yt,lt.exports.fromGeojsonVt=function(Me,se){se=se||{};var ne={};for(var X in Me)ne[X]=new rt(Me[X].features,se),ne[X].name=X,ne[X].version=se.version,ne[X].extent=se.extent;return yt({layers:ne})},lt.exports.GeoJSONWrapper=rt;var Nt=I.bu(lt.exports);const Rt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Ot=Math.fround||(_i=new Float32Array(1),Me=>(_i[0]=+Me,_i[0]));var _i;const Si=3,Ti=5,Oi=6;class tn{constructor(se){this.options=Object.assign(Object.create(Rt),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:ne,minZoom:X,maxZoom:ie}=this.options;ne&&console.time("total time");const de=`prepare ${se.length} points`;ne&&console.time(de),this.points=se;const ye=[];for(let Pe=0;Pe<se.length;Pe++){const Fe=se[Pe];if(!Fe.geometry)continue;const[Ne,Xe]=Fe.geometry.coordinates,Ye=Ot(nn(Ne)),De=Ot(yn(Xe));ye.push(Ye,De,1/0,Pe,-1,1),this.options.reduce&&ye.push(0)}let ge=this.trees[ie+1]=this._createTree(ye);ne&&console.timeEnd(de);for(let Pe=ie;Pe>=X;Pe--){const Fe=+Date.now();ge=this.trees[Pe]=this._createTree(this._cluster(ge,Pe)),ne&&console.log("z%d: %d clusters in %dms",Pe,ge.numItems,+Date.now()-Fe)}return ne&&console.timeEnd("total time"),this}getClusters(se,ne){let X=((se[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,se[1]));let de=se[2]===180?180:((se[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)X=-180,de=180;else if(X>de){const Xe=this.getClusters([X,ie,180,ye],ne),Ye=this.getClusters([-180,ie,de,ye],ne);return Xe.concat(Ye)}const ge=this.trees[this._limitZoom(ne)],Pe=ge.range(nn(X),yn(ye),nn(de),yn(ie)),Fe=ge.data,Ne=[];for(const Xe of Pe){const Ye=this.stride*Xe;Ne.push(Fe[Ye+Ti]>1?qi(Fe,Ye,this.clusterProps):this.points[Fe[Ye+Si]])}return Ne}getChildren(se){const ne=this._getOriginId(se),X=this._getOriginZoom(se),ie="No cluster with the specified id.",de=this.trees[X];if(!de)throw new Error(ie);const ye=de.data;if(ne*this.stride>=ye.length)throw new Error(ie);const ge=this.options.radius/(this.options.extent*Math.pow(2,X-1)),Pe=de.within(ye[ne*this.stride],ye[ne*this.stride+1],ge),Fe=[];for(const Ne of Pe){const Xe=Ne*this.stride;ye[Xe+4]===se&&Fe.push(ye[Xe+Ti]>1?qi(ye,Xe,this.clusterProps):this.points[ye[Xe+Si]])}if(Fe.length===0)throw new Error(ie);return Fe}getLeaves(se,ne,X){const ie=[];return this._appendLeaves(ie,se,ne=ne||10,X=X||0,0),ie}getTile(se,ne,X){const ie=this.trees[this._limitZoom(se)],de=Math.pow(2,se),{extent:ye,radius:ge}=this.options,Pe=ge/ye,Fe=(X-Pe)/de,Ne=(X+1+Pe)/de,Xe={features:[]};return this._addTileFeatures(ie.range((ne-Pe)/de,Fe,(ne+1+Pe)/de,Ne),ie.data,ne,X,de,Xe),ne===0&&this._addTileFeatures(ie.range(1-Pe/de,Fe,1,Ne),ie.data,de,X,de,Xe),ne===de-1&&this._addTileFeatures(ie.range(0,Fe,Pe/de,Ne),ie.data,-1,X,de,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(se){let ne=this._getOriginZoom(se)-1;for(;ne<=this.options.maxZoom;){const X=this.getChildren(se);if(ne++,X.length!==1)break;se=X[0].properties.cluster_id}return ne}_appendLeaves(se,ne,X,ie,de){const ye=this.getChildren(ne);for(const ge of ye){const Pe=ge.properties;if(Pe&&Pe.cluster?de+Pe.point_count<=ie?de+=Pe.point_count:de=this._appendLeaves(se,Pe.cluster_id,X,ie,de):de<ie?de++:se.push(ge),se.length===X)break}return de}_createTree(se){const ne=new I.au(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<se.length;X+=this.stride)ne.add(se[X],se[X+1]);return ne.finish(),ne.data=se,ne}_addTileFeatures(se,ne,X,ie,de,ye){for(const ge of se){const Pe=ge*this.stride,Fe=ne[Pe+Ti]>1;let Ne,Xe,Ye;if(Fe)Ne=Ni(ne,Pe,this.clusterProps),Xe=ne[Pe],Ye=ne[Pe+1];else{const ht=this.points[ne[Pe+Si]];Ne=ht.properties;const[kt,o]=ht.geometry.coordinates;Xe=nn(kt),Ye=yn(o)}const De={type:1,geometry:[[Math.round(this.options.extent*(Xe*de-X)),Math.round(this.options.extent*(Ye*de-ie))]],tags:Ne};let Ue;Ue=Fe||this.options.generateId?ne[Pe+Si]:this.points[ne[Pe+Si]].id,Ue!==void 0&&(De.id=Ue),ye.features.push(De)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,ne){const{radius:X,extent:ie,reduce:de,minPoints:ye}=this.options,ge=X/(ie*Math.pow(2,ne)),Pe=se.data,Fe=[],Ne=this.stride;for(let Xe=0;Xe<Pe.length;Xe+=Ne){if(Pe[Xe+2]<=ne)continue;Pe[Xe+2]=ne;const Ye=Pe[Xe],De=Pe[Xe+1],Ue=se.within(Pe[Xe],Pe[Xe+1],ge),ht=Pe[Xe+Ti];let kt=ht;for(const o of Ue){const ke=o*Ne;Pe[ke+2]>ne&&(kt+=Pe[ke+Ti])}if(kt>ht&&kt>=ye){let o,ke=Ye*ht,oi=De*ht,di=-1;const Ai=((Xe/Ne|0)<<5)+(ne+1)+this.points.length;for(const Jt of Ue){const li=Jt*Ne;if(Pe[li+2]<=ne)continue;Pe[li+2]=ne;const zi=Pe[li+Ti];ke+=Pe[li]*zi,oi+=Pe[li+1]*zi,Pe[li+4]=Ai,de&&(o||(o=this._map(Pe,Xe,!0),di=this.clusterProps.length,this.clusterProps.push(o)),de(o,this._map(Pe,li)))}Pe[Xe+4]=Ai,Fe.push(ke/kt,oi/kt,1/0,Ai,-1,kt),de&&Fe.push(di)}else{for(let o=0;o<Ne;o++)Fe.push(Pe[Xe+o]);if(kt>1)for(const o of Ue){const ke=o*Ne;if(!(Pe[ke+2]<=ne)){Pe[ke+2]=ne;for(let oi=0;oi<Ne;oi++)Fe.push(Pe[ke+oi])}}}}return Fe}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,ne,X){if(se[ne+Ti]>1){const ye=this.clusterProps[se[ne+Oi]];return X?Object.assign({},ye):ye}const ie=this.points[se[ne+Si]].properties,de=this.options.map(ie);return X&&de===ie?Object.assign({},de):de}}function qi(Me,se,ne){return{type:"Feature",id:Me[se+Si],properties:Ni(Me,se,ne),geometry:{type:"Point",coordinates:[(X=Me[se],360*(X-.5)),Ci(Me[se+1])]}};var X}function Ni(Me,se,ne){const X=Me[se+Ti],ie=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,de=Me[se+Oi],ye=de===-1?{}:Object.assign({},ne[de]);return Object.assign(ye,{cluster:!0,cluster_id:Me[se+Si],point_count:X,point_count_abbreviated:ie})}function nn(Me){return Me/360+.5}function yn(Me){const se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function Ci(Me){const se=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function gi(Me,se,ne,X){for(var ie,de=X,ye=ne-se>>1,ge=ne-se,Pe=Me[se],Fe=Me[se+1],Ne=Me[ne],Xe=Me[ne+1],Ye=se+3;Ye<ne;Ye+=3){var De=Ri(Me[Ye],Me[Ye+1],Pe,Fe,Ne,Xe);if(De>de)ie=Ye,de=De;else if(De===de){var Ue=Math.abs(Ye-ye);Ue<ge&&(ie=Ye,ge=Ue)}}de>X&&(ie-se>3&&gi(Me,se,ie,X),Me[ie+2]=de,ne-ie>3&&gi(Me,ie,ne,X))}function Ri(Me,se,ne,X,ie,de){var ye=ie-ne,ge=de-X;if(ye!==0||ge!==0){var Pe=((Me-ne)*ye+(se-X)*ge)/(ye*ye+ge*ge);Pe>1?(ne=ie,X=de):Pe>0&&(ne+=ye*Pe,X+=ge*Pe)}return(ye=Me-ne)*ye+(ge=se-X)*ge}function ai(Me,se,ne,X){var ie={id:Me===void 0?null:Me,type:se,geometry:ne,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var ye=de.geometry,ge=de.type;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")Ki(de,ye);else if(ge==="Polygon"||ge==="MultiLineString")for(var Pe=0;Pe<ye.length;Pe++)Ki(de,ye[Pe]);else if(ge==="MultiPolygon")for(Pe=0;Pe<ye.length;Pe++)for(var Fe=0;Fe<ye[Pe].length;Fe++)Ki(de,ye[Pe][Fe])}(ie),ie}function Ki(Me,se){for(var ne=0;ne<se.length;ne+=3)Me.minX=Math.min(Me.minX,se[ne]),Me.minY=Math.min(Me.minY,se[ne+1]),Me.maxX=Math.max(Me.maxX,se[ne]),Me.maxY=Math.max(Me.maxY,se[ne+1])}function Ji(Me,se,ne,X){if(se.geometry){var ie=se.geometry.coordinates,de=se.geometry.type,ye=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),ge=[],Pe=se.id;if(ne.promoteId?Pe=se.properties[ne.promoteId]:ne.generateId&&(Pe=X||0),de==="Point")fi(ie,ge);else if(de==="MultiPoint")for(var Fe=0;Fe<ie.length;Fe++)fi(ie[Fe],ge);else if(de==="LineString")pn(ie,ge,ye,!1);else if(de==="MultiLineString"){if(ne.lineMetrics){for(Fe=0;Fe<ie.length;Fe++)pn(ie[Fe],ge=[],ye,!1),Me.push(ai(Pe,"LineString",ge,se.properties));return}ii(ie,ge,ye,!1)}else if(de==="Polygon")ii(ie,ge,ye,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(Fe=0;Fe<se.geometry.geometries.length;Fe++)Ji(Me,{id:Pe,geometry:se.geometry.geometries[Fe],properties:se.properties},ne,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Fe=0;Fe<ie.length;Fe++){var Ne=[];ii(ie[Fe],Ne,ye,!0),ge.push(Ne)}}Me.push(ai(Pe,de,ge,se.properties))}}function fi(Me,se){se.push(wn(Me[0])),se.push(Rr(Me[1])),se.push(0)}function pn(Me,se,ne,X){for(var ie,de,ye=0,ge=0;ge<Me.length;ge++){var Pe=wn(Me[ge][0]),Fe=Rr(Me[ge][1]);se.push(Pe),se.push(Fe),se.push(0),ge>0&&(ye+=X?(ie*Fe-Pe*de)/2:Math.sqrt(Math.pow(Pe-ie,2)+Math.pow(Fe-de,2))),ie=Pe,de=Fe}var Ne=se.length-3;se[2]=1,gi(se,0,Ne,ne),se[Ne+2]=1,se.size=Math.abs(ye),se.start=0,se.end=se.size}function ii(Me,se,ne,X){for(var ie=0;ie<Me.length;ie++){var de=[];pn(Me[ie],de,ne,X),se.push(de)}}function wn(Me){return Me/360+.5}function Rr(Me){var se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function hi(Me,se,ne,X,ie,de,ye,ge){if(X/=se,de>=(ne/=se)&&ye<X)return Me;if(ye<ne||de>=X)return null;for(var Pe=[],Fe=0;Fe<Me.length;Fe++){var Ne=Me[Fe],Xe=Ne.geometry,Ye=Ne.type,De=ie===0?Ne.minX:Ne.minY,Ue=ie===0?Ne.maxX:Ne.maxY;if(De>=ne&&Ue<X)Pe.push(Ne);else if(!(Ue<ne||De>=X)){var ht=[];if(Ye==="Point"||Ye==="MultiPoint")en(Xe,ht,ne,X,ie);else if(Ye==="LineString")tr(Xe,ht,ne,X,ie,!1,ge.lineMetrics);else if(Ye==="MultiLineString")Qn(Xe,ht,ne,X,ie,!1);else if(Ye==="Polygon")Qn(Xe,ht,ne,X,ie,!0);else if(Ye==="MultiPolygon")for(var kt=0;kt<Xe.length;kt++){var o=[];Qn(Xe[kt],o,ne,X,ie,!0),o.length&&ht.push(o)}if(ht.length){if(ge.lineMetrics&&Ye==="LineString"){for(kt=0;kt<ht.length;kt++)Pe.push(ai(Ne.id,Ye,ht[kt],Ne.tags));continue}Ye!=="LineString"&&Ye!=="MultiLineString"||(ht.length===1?(Ye="LineString",ht=ht[0]):Ye="MultiLineString"),Ye!=="Point"&&Ye!=="MultiPoint"||(Ye=ht.length===3?"Point":"MultiPoint"),Pe.push(ai(Ne.id,Ye,ht,Ne.tags))}}}return Pe.length?Pe:null}function en(Me,se,ne,X,ie){for(var de=0;de<Me.length;de+=3){var ye=Me[de+ie];ye>=ne&&ye<=X&&(se.push(Me[de]),se.push(Me[de+1]),se.push(Me[de+2]))}}function tr(Me,se,ne,X,ie,de,ye){for(var ge,Pe,Fe=Fn(Me),Ne=ie===0?v:k,Xe=Me.start,Ye=0;Ye<Me.length-3;Ye+=3){var De=Me[Ye],Ue=Me[Ye+1],ht=Me[Ye+2],kt=Me[Ye+3],o=Me[Ye+4],ke=ie===0?De:Ue,oi=ie===0?kt:o,di=!1;ye&&(ge=Math.sqrt(Math.pow(De-kt,2)+Math.pow(Ue-o,2))),ke<ne?oi>ne&&(Pe=Ne(Fe,De,Ue,kt,o,ne),ye&&(Fe.start=Xe+ge*Pe)):ke>X?oi<X&&(Pe=Ne(Fe,De,Ue,kt,o,X),ye&&(Fe.start=Xe+ge*Pe)):In(Fe,De,Ue,ht),oi<ne&&ke>=ne&&(Pe=Ne(Fe,De,Ue,kt,o,ne),di=!0),oi>X&&ke<=X&&(Pe=Ne(Fe,De,Ue,kt,o,X),di=!0),!de&&di&&(ye&&(Fe.end=Xe+ge*Pe),se.push(Fe),Fe=Fn(Me)),ye&&(Xe+=ge)}var Ai=Me.length-3;De=Me[Ai],Ue=Me[Ai+1],ht=Me[Ai+2],(ke=ie===0?De:Ue)>=ne&&ke<=X&&In(Fe,De,Ue,ht),Ai=Fe.length-3,de&&Ai>=3&&(Fe[Ai]!==Fe[0]||Fe[Ai+1]!==Fe[1])&&In(Fe,Fe[0],Fe[1],Fe[2]),Fe.length&&se.push(Fe)}function Fn(Me){var se=[];return se.size=Me.size,se.start=Me.start,se.end=Me.end,se}function Qn(Me,se,ne,X,ie,de){for(var ye=0;ye<Me.length;ye++)tr(Me[ye],se,ne,X,ie,de,!1)}function In(Me,se,ne,X){Me.push(se),Me.push(ne),Me.push(X)}function v(Me,se,ne,X,ie,de){var ye=(de-se)/(X-se);return Me.push(de),Me.push(ne+(ie-ne)*ye),Me.push(1),ye}function k(Me,se,ne,X,ie,de){var ye=(de-ne)/(ie-ne);return Me.push(se+(X-se)*ye),Me.push(de),Me.push(1),ye}function V(Me,se){for(var ne=[],X=0;X<Me.length;X++){var ie,de=Me[X],ye=de.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")ie=$(de.geometry,se);else if(ye==="MultiLineString"||ye==="Polygon"){ie=[];for(var ge=0;ge<de.geometry.length;ge++)ie.push($(de.geometry[ge],se))}else if(ye==="MultiPolygon")for(ie=[],ge=0;ge<de.geometry.length;ge++){for(var Pe=[],Fe=0;Fe<de.geometry[ge].length;Fe++)Pe.push($(de.geometry[ge][Fe],se));ie.push(Pe)}ne.push(ai(de.id,ye,ie,de.tags))}return ne}function $(Me,se){var ne=[];ne.size=Me.size,Me.start!==void 0&&(ne.start=Me.start,ne.end=Me.end);for(var X=0;X<Me.length;X+=3)ne.push(Me[X]+se,Me[X+1],Me[X+2]);return ne}function te(Me,se){if(Me.transformed)return Me;var ne,X,ie,de=1<<Me.z,ye=Me.x,ge=Me.y;for(ne=0;ne<Me.features.length;ne++){var Pe=Me.features[ne],Fe=Pe.geometry,Ne=Pe.type;if(Pe.geometry=[],Ne===1)for(X=0;X<Fe.length;X+=2)Pe.geometry.push(fe(Fe[X],Fe[X+1],se,de,ye,ge));else for(X=0;X<Fe.length;X++){var Xe=[];for(ie=0;ie<Fe[X].length;ie+=2)Xe.push(fe(Fe[X][ie],Fe[X][ie+1],se,de,ye,ge));Pe.geometry.push(Xe)}}return Me.transformed=!0,Me}function fe(Me,se,ne,X,ie,de){return[Math.round(ne*(Me*X-ie)),Math.round(ne*(se*X-de))]}function ve(Me,se,ne,X,ie){for(var de=se===ie.maxZoom?0:ie.tolerance/((1<<se)*ie.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:X,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ge=0;ge<Me.length;ge++){ye.numFeatures++,Ie(ye,Me[ge],de,ie);var Pe=Me[ge].minX,Fe=Me[ge].minY,Ne=Me[ge].maxX,Xe=Me[ge].maxY;Pe<ye.minX&&(ye.minX=Pe),Fe<ye.minY&&(ye.minY=Fe),Ne>ye.maxX&&(ye.maxX=Ne),Xe>ye.maxY&&(ye.maxY=Xe)}return ye}function Ie(Me,se,ne,X){var ie=se.geometry,de=se.type,ye=[];if(de==="Point"||de==="MultiPoint")for(var ge=0;ge<ie.length;ge+=3)ye.push(ie[ge]),ye.push(ie[ge+1]),Me.numPoints++,Me.numSimplified++;else if(de==="LineString")Ee(ye,ie,Me,ne,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(ge=0;ge<ie.length;ge++)Ee(ye,ie[ge],Me,ne,de==="Polygon",ge===0);else if(de==="MultiPolygon")for(var Pe=0;Pe<ie.length;Pe++){var Fe=ie[Pe];for(ge=0;ge<Fe.length;ge++)Ee(ye,Fe[ge],Me,ne,!0,ge===0)}if(ye.length){var Ne=se.tags||null;if(de==="LineString"&&X.lineMetrics){for(var Xe in Ne={},se.tags)Ne[Xe]=se.tags[Xe];Ne.mapbox_clip_start=ie.start/ie.size,Ne.mapbox_clip_end=ie.end/ie.size}var Ye={geometry:ye,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Ne};se.id!==null&&(Ye.id=se.id),Me.features.push(Ye)}}function Ee(Me,se,ne,X,ie,de){var ye=X*X;if(X>0&&se.size<(ie?ye:X))ne.numPoints+=se.length/3;else{for(var ge=[],Pe=0;Pe<se.length;Pe+=3)(X===0||se[Pe+2]>ye)&&(ne.numSimplified++,ge.push(se[Pe]),ge.push(se[Pe+1])),ne.numPoints++;ie&&function(Fe,Ne){for(var Xe=0,Ye=0,De=Fe.length,Ue=De-2;Ye<De;Ue=Ye,Ye+=2)Xe+=(Fe[Ye]-Fe[Ue])*(Fe[Ye+1]+Fe[Ue+1]);if(Xe>0===Ne)for(Ye=0,De=Fe.length;Ye<De/2;Ye+=2){var ht=Fe[Ye],kt=Fe[Ye+1];Fe[Ye]=Fe[De-2-Ye],Fe[Ye+1]=Fe[De-1-Ye],Fe[De-2-Ye]=ht,Fe[De-1-Ye]=kt}}(ge,de),Me.push(ge)}}function ze(Me,se){var ne=(se=this.options=function(ie,de){for(var ye in de)ie[ye]=de[ye];return ie}(Object.create(this.options),se)).debug;if(ne&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var X=function(ie,de){var ye=[];if(ie.type==="FeatureCollection")for(var ge=0;ge<ie.features.length;ge++)Ji(ye,ie.features[ge],de,ge);else Ji(ye,ie.type==="Feature"?ie:{geometry:ie},de);return ye}(Me,se);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),X=function(ie,de){var ye=de.buffer/de.extent,ge=ie,Pe=hi(ie,1,-1-ye,ye,0,-1,2,de),Fe=hi(ie,1,1-ye,2+ye,0,-1,2,de);return(Pe||Fe)&&(ge=hi(ie,1,-ye,1+ye,0,-1,2,de)||[],Pe&&(ge=V(Pe,1).concat(ge)),Fe&&(ge=ge.concat(V(Fe,-1)))),ge}(X,se),X.length&&this.splitTile(X,0,0,0),ne&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Qe(Me,se,ne){return 32*((1<<Me)*ne+se)+Me}function He(Me,se){return se?Me.properties[se]:Me.id}function Ze(Me,se){if(Me==null)return!0;if(Me.type==="Feature")return He(Me,se)!=null;if(Me.type==="FeatureCollection"){const ne=new Set;for(const X of Me.features){const ie=He(X,se);if(ie==null||ne.has(ie))return!1;ne.add(ie)}return!0}return!1}function Ve(Me,se){const ne=new Map;if(Me!=null)if(Me.type==="Feature")ne.set(He(Me,se),Me);else for(const X of Me.features)ne.set(He(X,se),X);return ne}ze.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ze.prototype.splitTile=function(Me,se,ne,X,ie,de,ye){for(var ge=[Me,se,ne,X],Pe=this.options,Fe=Pe.debug;ge.length;){X=ge.pop(),ne=ge.pop(),se=ge.pop(),Me=ge.pop();var Ne=1<<se,Xe=Qe(se,ne,X),Ye=this.tiles[Xe];if(!Ye&&(Fe>1&&console.time("creation"),Ye=this.tiles[Xe]=ve(Me,se,ne,X,Pe),this.tileCoords.push({z:se,x:ne,y:X}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,ne,X,Ye.numFeatures,Ye.numPoints,Ye.numSimplified),console.timeEnd("creation"));var De="z"+se;this.stats[De]=(this.stats[De]||0)+1,this.total++}if(Ye.source=Me,ie){if(se===Pe.maxZoom||se===ie)continue;var Ue=1<<ie-se;if(ne!==Math.floor(de/Ue)||X!==Math.floor(ye/Ue))continue}else if(se===Pe.indexMaxZoom||Ye.numPoints<=Pe.indexMaxPoints)continue;if(Ye.source=null,Me.length!==0){Fe>1&&console.time("clipping");var ht,kt,o,ke,oi,di,Ai=.5*Pe.buffer/Pe.extent,Jt=.5-Ai,li=.5+Ai,zi=1+Ai;ht=kt=o=ke=null,oi=hi(Me,Ne,ne-Ai,ne+li,0,Ye.minX,Ye.maxX,Pe),di=hi(Me,Ne,ne+Jt,ne+zi,0,Ye.minX,Ye.maxX,Pe),Me=null,oi&&(ht=hi(oi,Ne,X-Ai,X+li,1,Ye.minY,Ye.maxY,Pe),kt=hi(oi,Ne,X+Jt,X+zi,1,Ye.minY,Ye.maxY,Pe),oi=null),di&&(o=hi(di,Ne,X-Ai,X+li,1,Ye.minY,Ye.maxY,Pe),ke=hi(di,Ne,X+Jt,X+zi,1,Ye.minY,Ye.maxY,Pe),di=null),Fe>1&&console.timeEnd("clipping"),ge.push(ht||[],se+1,2*ne,2*X),ge.push(kt||[],se+1,2*ne,2*X+1),ge.push(o||[],se+1,2*ne+1,2*X),ge.push(ke||[],se+1,2*ne+1,2*X+1)}}},ze.prototype.getTile=function(Me,se,ne){var X=this.options,ie=X.extent,de=X.debug;if(Me<0||Me>24)return null;var ye=1<<Me,ge=Qe(Me,se=(se%ye+ye)%ye,ne);if(this.tiles[ge])return te(this.tiles[ge],ie);de>1&&console.log("drilling down to z%d-%d-%d",Me,se,ne);for(var Pe,Fe=Me,Ne=se,Xe=ne;!Pe&&Fe>0;)Fe--,Ne=Math.floor(Ne/2),Xe=Math.floor(Xe/2),Pe=this.tiles[Qe(Fe,Ne,Xe)];return Pe&&Pe.source?(de>1&&console.log("found parent tile z%d-%d-%d",Fe,Ne,Xe),de>1&&console.time("drilling down"),this.splitTile(Pe.source,Fe,Ne,Xe,Me,se,ne),de>1&&console.timeEnd("drilling down"),this.tiles[ge]?te(this.tiles[ge],ie):null):null};class ft extends ae{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(se,ne){return I._(this,void 0,void 0,function*(){const X=se.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ie=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!ie)return null;const de=new class{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=I.W,this.length=ge.length,this._features=ge}feature(ge){return new class{constructor(Pe){this._feature=Pe,this.extent=I.W,this.type=Pe.type,this.properties=Pe.tags,"id"in Pe&&!isNaN(Pe.id)&&(this.id=parseInt(Pe.id,10))}loadGeometry(){if(this._feature.type===1){const Pe=[];for(const Fe of this._feature.geometry)Pe.push([new I.P(Fe[0],Fe[1])]);return Pe}{const Pe=[];for(const Fe of this._feature.geometry){const Ne=[];for(const Xe of Fe)Ne.push(new I.P(Xe[0],Xe[1]));Pe.push(Ne)}return Pe}}toGeoJSON(Pe,Fe,Ne){return tt.call(this,Pe,Fe,Ne)}}(this._features[ge])}}(ie.features);let ye=Nt(de);return ye.byteOffset===0&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),{vectorTile:de,rawData:ye.buffer}})}loadData(se){var ne;return I._(this,void 0,void 0,function*(){(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const X=!!(se&&se.request&&se.request.collectResourceTiming)&&new I.br(se.request);this._pendingRequest=new AbortController;try{let ie=yield this.loadGeoJSON(se,this._pendingRequest);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(ot(ie,!0),se.filter){const ye=I.bx(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(Pe=>ye.value.evaluate({zoom:0},Pe))}}this._geoJSONIndex=se.cluster?new tn(function({superclusterOptions:ye,clusterProperties:ge}){if(!ge||!ye)return ye;const Pe={},Fe={},Ne={accumulated:null,zoom:0},Xe={properties:null},Ye=Object.keys(ge);for(const De of Ye){const[Ue,ht]=ge[De],kt=I.bx(ht),o=I.bx(typeof Ue=="string"?[Ue,["accumulated"],["get",De]]:Ue);Pe[De]=kt.value,Fe[De]=o.value}return ye.map=De=>{Xe.properties=De;const Ue={};for(const ht of Ye)Ue[ht]=Pe[ht].evaluate(Ne,Xe);return Ue},ye.reduce=(De,Ue)=>{Xe.properties=Ue;for(const ht of Ye)Ne.accumulated=De[ht],De[ht]=Fe[ht].evaluate(Ne,Xe)},ye}(se)).load(ie.features):function(ye,ge){return new ze(ye,ge)}(ie,se.geojsonVtOptions),this.loaded={};const de={};if(X){const ye=X.finish();ye&&(de.resourceTiming={},de.resourceTiming[se.source]=JSON.parse(JSON.stringify(ye)))}return de}catch(ie){if(delete this._pendingRequest,I.by(ie))return{abandoned:!0};throw ie}})}reloadTile(se){const ne=this.loaded;return ne&&ne[se.uid]?super.reloadTile(se):this.loadTile(se)}loadGeoJSON(se,ne){return I._(this,void 0,void 0,function*(){const{promoteId:X}=se;if(se.request){const ie=yield I.h(se.request,ne);return this._dataUpdateable=Ze(ie.data,X)?Ve(ie.data,X):void 0,ie.data}if(typeof se.data=="string")try{const ie=JSON.parse(se.data);return this._dataUpdateable=Ze(ie,X)?Ve(ie,X):void 0,ie}catch{throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`)}if(!se.dataDiff)throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${se.source}`);return function(ie,de,ye){var ge,Pe,Fe,Ne;if(de.removeAll&&ie.clear(),de.remove)for(const Xe of de.remove)ie.delete(Xe);if(de.add)for(const Xe of de.add){const Ye=He(Xe,ye);Ye!=null&&ie.set(Ye,Xe)}if(de.update)for(const Xe of de.update){let Ye=ie.get(Xe.id);if(Ye==null)continue;const De=!Xe.removeAllProperties&&(((ge=Xe.removeProperties)===null||ge===void 0?void 0:ge.length)>0||((Pe=Xe.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0);if((Xe.newGeometry||Xe.removeAllProperties||De)&&(Ye=Object.assign({},Ye),ie.set(Xe.id,Ye),De&&(Ye.properties=Object.assign({},Ye.properties))),Xe.newGeometry&&(Ye.geometry=Xe.newGeometry),Xe.removeAllProperties)Ye.properties={};else if(((Fe=Xe.removeProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const Ue of Xe.removeProperties)Object.prototype.hasOwnProperty.call(Ye.properties,Ue)&&delete Ye.properties[Ue];if(((Ne=Xe.addOrUpdateProperties)===null||Ne===void 0?void 0:Ne.length)>0)for(const{key:Ue,value:ht}of Xe.addOrUpdateProperties)Ye.properties[Ue]=ht}}(this._dataUpdateable,se.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(se){return I._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(se){return this._geoJSONIndex.getClusterExpansionZoom(se.clusterId)}getClusterChildren(se){return this._geoJSONIndex.getChildren(se.clusterId)}getClusterLeaves(se){return this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset)}}class nt{constructor(se){this.self=se,this.actor=new I.C(se),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,X)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=X},this.self.addProtocol=I.be,this.self.removeProtocol=I.bf,this.self.registerRTLTextPlugin=ne=>{if(I.bz.isParsed())throw new Error("RTL text plugin already registered.");I.bz.setMethods(ne)},this.actor.registerMessageHandler("loadDEMTile",(ne,X)=>this._getDEMWorkerSource(ne,X.source).loadTile(X)),this.actor.registerMessageHandler("removeDEMTile",(ne,X)=>I._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,X.source).removeTile(X)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(ne,X)=>I._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,X.type,X.source).getClusterExpansionZoom(X)})),this.actor.registerMessageHandler("getClusterChildren",(ne,X)=>I._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,X.type,X.source).getClusterChildren(X)})),this.actor.registerMessageHandler("getClusterLeaves",(ne,X)=>I._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,X.type,X.source).getClusterLeaves(X)})),this.actor.registerMessageHandler("loadData",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).loadData(X)),this.actor.registerMessageHandler("loadTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).loadTile(X)),this.actor.registerMessageHandler("reloadTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).reloadTile(X)),this.actor.registerMessageHandler("abortTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).abortTile(X)),this.actor.registerMessageHandler("removeTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).removeTile(X)),this.actor.registerMessageHandler("removeSource",(ne,X)=>I._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][X.type]||!this.workerSources[ne][X.type][X.source])return;const ie=this.workerSources[ne][X.type][X.source];delete this.workerSources[ne][X.type][X.source],ie.removeSource!==void 0&&ie.removeSource(X)})),this.actor.registerMessageHandler("removeMap",ne=>I._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("setReferrer",(ne,X)=>I._(this,void 0,void 0,function*(){this.referrer=X})),this.actor.registerMessageHandler("syncRTLPluginState",(ne,X)=>this._syncRTLPluginState(ne,X)),this.actor.registerMessageHandler("importScript",(ne,X)=>I._(this,void 0,void 0,function*(){this.self.importScripts(X)})),this.actor.registerMessageHandler("setImages",(ne,X)=>this._setImages(ne,X)),this.actor.registerMessageHandler("updateLayers",(ne,X)=>I._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(X.layers,X.removedIds)})),this.actor.registerMessageHandler("setLayers",(ne,X)=>I._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(X)}))}_setImages(se,ne){return I._(this,void 0,void 0,function*(){this.availableImages[se]=ne;for(const X in this.workerSources[se]){const ie=this.workerSources[se][X];for(const de in ie)ie[de].availableImages=ne}})}_syncRTLPluginState(se,ne){return I._(this,void 0,void 0,function*(){I.bz.setState(ne);const X=I.bz.getPluginURL();if(ne.pluginStatus==="loaded"&&!I.bz.isParsed()&&X!=null){this.self.importScripts(X);const ie=I.bz.isParsed();if(ie)return ie;throw new Error(`RTL Text Plugin failed to import scripts from ${X}`)}return!1})}_getAvailableImages(se){let ne=this.availableImages[se];return ne||(ne=[]),ne}_getLayerIndex(se){let ne=this.layerIndexes[se];return ne||(ne=this.layerIndexes[se]=new a),ne}_getWorkerSource(se,ne,X){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][ne]||(this.workerSources[se][ne]={}),!this.workerSources[se][ne][X]){const ie={sendAsync:(de,ye)=>(de.targetMapId=se,this.actor.sendAsync(de,ye))};switch(ne){case"vector":this.workerSources[se][ne][X]=new ae(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;case"geojson":this.workerSources[se][ne][X]=new ft(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;default:this.workerSources[se][ne][X]=new this.externalWorkerSourceTypes[ne](ie,this._getLayerIndex(se),this._getAvailableImages(se))}}return this.workerSources[se][ne][X]}_getDEMWorkerSource(se,ne){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][ne]||(this.demWorkerSources[se][ne]=new ue),this.demWorkerSources[se][ne]}}return I.i(self)&&(self.worker=new nt(self)),nt}),g("index",["exports","./shared"],function(I,a){var G="4.1.0";let W,he;const ae={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((s,i)=>{const r=requestAnimationFrame(s);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),i(a.c())})}),getImageData(y,s=0){return this.getImageCanvasContext(y).getImageData(-s,-s,y.width+2*s,y.height+2*s)},getImageCanvasContext(y){const s=window.document.createElement("canvas"),i=s.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return s.width=y.width,s.height=y.height,i.drawImage(y,0,0,y.width,y.height),i},resolveURL:y=>(W||(W=document.createElement("a")),W.href=y,W.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(he==null&&(he=matchMedia("(prefers-reduced-motion: reduce)")),he.matches)}};class ue{static testProp(s){if(!ue.docStyle)return s[0];for(let i=0;i<s.length;i++)if(s[i]in ue.docStyle)return s[i];return s[0]}static create(s,i,r){const l=window.document.createElement(s);return i!==void 0&&(l.className=i),r&&r.appendChild(l),l}static createNS(s,i){return window.document.createElementNS(s,i)}static disableDrag(){ue.docStyle&&ue.selectProp&&(ue.userSelect=ue.docStyle[ue.selectProp],ue.docStyle[ue.selectProp]="none")}static enableDrag(){ue.docStyle&&ue.selectProp&&(ue.docStyle[ue.selectProp]=ue.userSelect)}static setTransform(s,i){s.style[ue.transformProp]=i}static addEventListener(s,i,r,l={}){s.addEventListener(i,r,"passive"in l?l:l.capture)}static removeEventListener(s,i,r,l={}){s.removeEventListener(i,r,"passive"in l?l:l.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",ue.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ue.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ue.suppressClickInternal,!0)},0)}static getScale(s){const i=s.getBoundingClientRect();return{x:i.width/s.offsetWidth||1,y:i.height/s.offsetHeight||1,boundingClientRect:i}}static getPoint(s,i,r){const l=i.boundingClientRect;return new a.P((r.clientX-l.left)/i.x-s.clientLeft,(r.clientY-l.top)/i.y-s.clientTop)}static mousePos(s,i){const r=ue.getScale(s);return ue.getPoint(s,r,i)}static touchPos(s,i){const r=[],l=ue.getScale(s);for(let d=0;d<i.length;d++)r.push(ue.getPoint(s,l,i[d]));return r}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}ue.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ue.selectProp=ue.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ue.transformProp=ue.testProp(["transform","WebkitTransform"]);const be={supported:!1,testSupport:function(y){!tt&&ot&&(lt?ut(y):Ke=y)}};let Ke,ot,tt=!1,lt=!1;function ut(y){const s=y.createTexture();y.bindTexture(y.TEXTURE_2D,s);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,ot),y.isContextLost())return;be.supported=!0}catch{}y.deleteTexture(s),tt=!0}var Tt,Pt;typeof document<"u"&&(ot=document.createElement("img"),ot.onload=function(){Ke&&ut(Ke),Ke=null,lt=!0},ot.onerror=function(){tt=!0,Ke=null},ot.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let s,i,r,l;y.resetRequestQueue=()=>{s=[],i=0,r=0,l={}},y.addThrottleControl=T=>{const B=r++;return l[B]=T,B},y.removeThrottleControl=T=>{delete l[T],_()},y.getImage=(T,B,j=!0)=>new Promise((Y,ce)=>{be.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),a.e(T,{type:"image"}),s.push({abortController:B,requestParameters:T,supportImageRefresh:j,state:"queued",onError:Se=>{ce(Se)},onSuccess:Se=>{Y(Se)}}),_()});const d=T=>a._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:B,supportImageRefresh:j,onError:Y,onSuccess:ce,abortController:Se}=T,Te=j===!1&&!a.i(self)&&!a.g(B.url)&&(!B.headers||Object.keys(B.headers).reduce((Je,xt)=>Je&&xt==="accept",!0));i++;const Re=Te?w(B,Se):a.m(B,Se);try{const Je=yield Re;delete T.abortController,T.state="completed",Je.data instanceof HTMLImageElement||a.b(Je.data)?ce(Je):Je.data&&ce({data:yield(Be=Je.data,typeof createImageBitmap=="function"?a.d(Be):a.f(Be)),cacheControl:Je.cacheControl,expires:Je.expires})}catch(Je){delete T.abortController,Y(Je)}finally{i--,_()}var Be}),_=()=>{const T=(()=>{for(const B of Object.keys(l))if(l[B]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let B=i;B<T&&s.length>0;B++){const j=s.shift();j.abortController.signal.aborted?B--:d(j)}},w=(T,B)=>new Promise((j,Y)=>{const ce=new Image,Se=T.url,Te=T.credentials;Te&&Te==="include"?ce.crossOrigin="use-credentials":(Te&&Te==="same-origin"||!a.s(Se))&&(ce.crossOrigin="anonymous"),B.signal.addEventListener("abort",()=>{ce.src="",Y(a.c())}),ce.fetchPriority="high",ce.onload=()=>{ce.onerror=ce.onload=null,j({data:ce})},ce.onerror=()=>{ce.onerror=ce.onload=null,B.signal.aborted||Y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ce.src=Se})}(Tt||(Tt={})),Tt.resetRequestQueue(),function(y){y.Glyphs="Glyphs",y.Image="Image",y.Source="Source",y.SpriteImage="SpriteImage",y.SpriteJSON="SpriteJSON",y.Style="Style",y.Tile="Tile",y.Unknown="Unknown"}(Pt||(Pt={}));class zt{constructor(s){this._transformRequestFn=s}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeSpriteURL(s,i,r){const l=function(d){const _=d.match(Ge);if(!_)throw new Error(`Unable to parse URL "${d}"`);return{protocol:_[1],authority:_[2],path:_[3]||"/",params:_[4]?_[4].split("&"):[]}}(s);return l.path+=`${i}${r}`,function(d){const _=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${_}`}(l)}setTransformRequest(s){this._transformRequestFn=s}}const Ge=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Xt(y){var s=new a.A(3);return s[0]=y[0],s[1]=y[1],s[2]=y[2],s}var rt,yt=function(y,s,i){return y[0]=s[0]-i[0],y[1]=s[1]-i[1],y[2]=s[2]-i[2],y};rt=new a.A(3),a.A!=Float32Array&&(rt[0]=0,rt[1]=0,rt[2]=0);var pt=function(y){var s=y[0],i=y[1];return s*s+i*i};function gt(y){const s=[];if(typeof y=="string")s.push({id:"default",url:y});else if(y&&y.length>0){const i=[];for(const{id:r,url:l}of y){const d=`${r}${l}`;i.indexOf(d)===-1&&(i.push(d),s.push({id:r,url:l}))}}return s}(function(){var y=new a.A(2);a.A!=Float32Array&&(y[0]=0,y[1]=0)})();class bt{constructor(s,i,r,l){this.context=s,this.format=r,this.texture=s.gl.createTexture(),this.update(i,l)}update(s,i,r){const{width:l,height:d}=s,_=!(this.size&&this.size[0]===l&&this.size[1]===d||r),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(i&&i.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!i||i.premultiply!==!1)),_)this.size=[l,d],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,s):T.texImage2D(T.TEXTURE_2D,0,this.format,l,d,0,this.format,T.UNSIGNED_BYTE,s.data);else{const{x:B,y:j}=r||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texSubImage2D(T.TEXTURE_2D,0,B,j,T.RGBA,T.UNSIGNED_BYTE,s):T.texSubImage2D(T.TEXTURE_2D,0,B,j,l,d,T.RGBA,T.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(s,i,r){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),r!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=d.LINEAR),s!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,r||s),this.filter=s),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function dt(y){const{userImage:s}=y;return!!(s&&s.render&&s.render())&&(y.data.replace(new Uint8Array(s.data.buffer)),!0)}class $e extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:i,promiseResolve:r}of this.requestors)r(this._getImagesForIds(i));this.requestors=[]}}getImage(s){const i=this.images[s];if(i&&!i.data&&i.spriteData){const r=i.spriteData;i.data=new a.R({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),i.spriteData=null}return i}addImage(s,i){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,i)&&(this.images[s]=i)}_validate(s,i){let r=!0;const l=i.data||i.spriteData;return this._validateStretch(i.stretchX,l&&l.width)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,l&&l.height)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "content" value`))),r=!1),r}_validateStretch(s,i){if(!s)return!0;let r=0;for(const l of s){if(l[0]<r||l[1]<l[0]||i<l[1])return!1;r=l[1]}return!0}_validateContent(s,i){if(!s)return!0;if(s.length!==4)return!1;const r=i.spriteData,l=r&&r.width||i.data.width,d=r&&r.height||i.data.height;return!(s[0]<0||l<s[0]||s[1]<0||d<s[1]||s[2]<0||l<s[2]||s[3]<0||d<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,i,r=!0){const l=this.getImage(s);if(r&&(l.data.width!==i.data.width||l.data.height!==i.data.height))throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=l.version+1,this.images[s]=i,this.updatedImages[s]=!0}removeImage(s){const i=this.images[s];delete this.images[s],delete this.patterns[s],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s){return new Promise((i,r)=>{let l=!0;if(!this.isLoaded())for(const d of s)this.images[d]||(l=!1);this.isLoaded()||l?i(this._getImagesForIds(s)):this.requestors.push({ids:s,promiseResolve:i})})}_getImagesForIds(s){const i={};for(const r of s){let l=this.getImage(r);l||(this.fire(new a.k("styleimagemissing",{id:r})),l=this.getImage(r)),l?i[r]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:!!(l.userImage&&l.userImage.render)}:a.w(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:s,height:i}=this.atlasImage;return{width:s,height:i}}getPattern(s){const i=this.patterns[s],r=this.getImage(s);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{const l={w:r.data.width+2,h:r.data.height+2,x:0,y:0},d=new a.I(l,r);this.patterns[s]={bin:l,position:d}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const i=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new bt(s,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const d in this.patterns)s.push(this.patterns[d].bin);const{w:i,h:r}=a.p(s),l=this.atlasImage;l.resize({width:i||1,height:r||1});for(const d in this.patterns){const{bin:_}=this.patterns[d],w=_.x+1,T=_.y+1,B=this.getImage(d).data,j=B.width,Y=B.height;a.R.copy(B,l,{x:0,y:0},{x:w,y:T},{width:j,height:Y}),a.R.copy(B,l,{x:0,y:Y-1},{x:w,y:T-1},{width:j,height:1}),a.R.copy(B,l,{x:0,y:0},{x:w,y:T+Y},{width:j,height:1}),a.R.copy(B,l,{x:j-1,y:0},{x:w-1,y:T},{width:1,height:Y}),a.R.copy(B,l,{x:0,y:0},{x:w+j,y:T},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const i of s){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const r=this.getImage(i);r||a.w(`Image with ID: "${i}" was not found`),dt(r)&&this.updateImage(i,r)}}}const mt=1e20;function st(y,s,i,r,l,d,_,w,T){for(let B=s;B<s+r;B++)Nt(y,i*d+B,d,l,_,w,T);for(let B=i;B<i+l;B++)Nt(y,B*d+s,1,r,_,w,T)}function Nt(y,s,i,r,l,d,_){d[0]=0,_[0]=-mt,_[1]=mt,l[0]=y[s];for(let w=1,T=0,B=0;w<r;w++){l[w]=y[s+w*i];const j=w*w;do{const Y=d[T];B=(l[w]-l[Y]+j-Y*Y)/(w-Y)/2}while(B<=_[T]&&--T>-1);T++,d[T]=w,_[T]=B,_[T+1]=mt}for(let w=0,T=0;w<r;w++){for(;_[T+1]<w;)T++;const B=d[T],j=w-B;y[s+w*i]=l[B]+j*j}}class Rt{constructor(s,i){this.requestManager=s,this.localIdeographFontFamily=i,this.entries={}}setURL(s){this.url=s}getGlyphs(s){return a._(this,void 0,void 0,function*(){const i=[];for(const d in s)for(const _ of s[d])i.push(this._getAndCacheGlyphsPromise(d,_));const r=yield Promise.all(i),l={};for(const{stack:d,id:_,glyph:w}of r)l[d]||(l[d]={}),l[d][_]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return l})}_getAndCacheGlyphsPromise(s,i){return a._(this,void 0,void 0,function*(){let r=this.entries[s];r||(r=this.entries[s]={glyphs:{},requests:{},ranges:{}});let l=r.glyphs[i];if(l!==void 0)return{stack:s,id:i,glyph:l};if(l=this._tinySDF(r,s,i),l)return r.glyphs[i]=l,{stack:s,id:i,glyph:l};const d=Math.floor(i/256);if(256*d>65535)throw new Error("glyphs > 65535 not supported");if(r.ranges[d])return{stack:s,id:i,glyph:l};if(!this.url)throw new Error("glyphsUrl is not set");if(!r.requests[d]){const w=Rt.loadGlyphRange(s,d,this.url,this.requestManager);r.requests[d]=w}const _=yield r.requests[d];for(const w in _)this._doesCharSupportLocalGlyph(+w)||(r.glyphs[+w]=_[+w]);return r.ranges[d]=!0,{stack:s,id:i,glyph:_[i]||null}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](s)||a.u["Hangul Syllables"](s)||a.u.Hiragana(s)||a.u.Katakana(s))}_tinySDF(s,i,r){const l=this.localIdeographFontFamily;if(!l||!this._doesCharSupportLocalGlyph(r))return;let d=s.tinySDF;if(!d){let w="400";/bold/i.test(i)?w="900":/medium/i.test(i)?w="500":/light/i.test(i)&&(w="200"),d=s.tinySDF=new Rt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:w})}const _=d.draw(String.fromCharCode(r));return{id:r,bitmap:new a.o({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}Rt.loadGlyphRange=function(y,s,i,r){return a._(this,void 0,void 0,function*(){const l=256*s,d=l+255,_=r.transformRequest(i.replace("{fontstack}",y).replace("{range}",`${l}-${d}`),Pt.Glyphs),w=yield a.l(_,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${s}, ${l}-${d}`);const T={};for(const B of a.n(w.data))T[B.id]=B;return T})},Rt.TinySDF=class{constructor({fontSize:y=24,buffer:s=3,radius:i=8,cutoff:r=.25,fontFamily:l="sans-serif",fontWeight:d="normal",fontStyle:_="normal"}={}){this.buffer=s,this.cutoff=r,this.radius=i;const w=this.size=y+4*s,T=this._createCanvas(w),B=this.ctx=T.getContext("2d",{willReadFrequently:!0});B.font=`${_} ${d} ${y}px ${l}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(y){const s=document.createElement("canvas");return s.width=s.height=y,s}draw(y){const{width:s,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:l,actualBoundingBoxRight:d}=this.ctx.measureText(y),_=Math.ceil(i),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-l))),T=Math.min(this.size-this.buffer,_+Math.ceil(r)),B=w+2*this.buffer,j=T+2*this.buffer,Y=Math.max(B*j,0),ce=new Uint8ClampedArray(Y),Se={data:ce,width:B,height:j,glyphWidth:w,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:s};if(w===0||T===0)return Se;const{ctx:Te,buffer:Re,gridInner:Be,gridOuter:Je}=this;Te.clearRect(Re,Re,w,T),Te.fillText(y,Re,Re+_);const xt=Te.getImageData(Re,Re,w,T);Je.fill(mt,0,Y),Be.fill(0,0,Y);for(let at=0;at<T;at++)for(let ct=0;ct<w;ct++){const Et=xt.data[4*(at*w+ct)+3]/255;if(Et===0)continue;const wt=(at+Re)*B+ct+Re;if(Et===1)Je[wt]=0,Be[wt]=mt;else{const ri=.5-Et;Je[wt]=ri>0?ri*ri:0,Be[wt]=ri<0?ri*ri:0}}st(Je,0,0,B,j,B,this.f,this.v,this.z),st(Be,Re,Re,w,T,B,this.f,this.v,this.z);for(let at=0;at<Y;at++){const ct=Math.sqrt(Je[at])-Math.sqrt(Be[at]);ce[at]=Math.round(255-255*(ct/this.radius+this.cutoff))}return Se}};class Ot{constructor(){this.specification=a.v.light.position}possiblyEvaluate(s,i){return a.y(s.expression.evaluate(i))}interpolate(s,i,r){return{x:a.z.number(s.x,i.x,r),y:a.z.number(s.y,i.y,r),z:a.z.number(s.z,i.z,r)}}}let _i;class Si extends a.E{constructor(s){super(),_i=_i||new a.q({anchor:new a.D(a.v.light.anchor),position:new Ot,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(_i),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,i={}){if(!this._validate(a.r,s,i))for(const r in s){const l=s[r];r.endsWith("-transition")?this._transitionable.setTransition(r.slice(0,-11),l):this._transitionable.setValue(r,l)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,i,r){return(!r||r.validate!==!1)&&a.t(this,s.call(a.x,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}class Ti{constructor(s,i){this.width=s,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,i){const r=s.join(",")+String(i);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(s,i)),this.dashEntry[r]}getDashRanges(s,i,r){const l=[];let d=s.length%2==1?-s[s.length-1]*r:0,_=s[0]*r,w=!0;l.push({left:d,right:_,isDash:w,zeroLength:s[0]===0});let T=s[0];for(let B=1;B<s.length;B++){w=!w;const j=s[B];d=T*r,T+=j,_=T*r,l.push({left:d,right:_,isDash:w,zeroLength:j===0})}return l}addRoundDash(s,i,r){const l=i/2;for(let d=-r;d<=r;d++){const _=this.width*(this.nextRow+r+d);let w=0,T=s[w];for(let B=0;B<this.width;B++){B/T.right>1&&(T=s[++w]);const j=Math.abs(B-T.left),Y=Math.abs(B-T.right),ce=Math.min(j,Y);let Se;const Te=d/r*(l+1);if(T.isDash){const Re=l-Math.abs(Te);Se=Math.sqrt(ce*ce+Re*Re)}else Se=l-Math.sqrt(ce*ce+Te*Te);this.data[_+B]=Math.max(0,Math.min(255,Se+128))}}}addRegularDash(s){for(let w=s.length-1;w>=0;--w){const T=s[w],B=s[w+1];T.zeroLength?s.splice(w,1):B&&B.isDash===T.isDash&&(B.left=T.left,s.splice(w,1))}const i=s[0],r=s[s.length-1];i.isDash===r.isDash&&(i.left=r.left-this.width,r.right=i.right+this.width);const l=this.width*this.nextRow;let d=0,_=s[d];for(let w=0;w<this.width;w++){w/_.right>1&&(_=s[++d]);const T=Math.abs(w-_.left),B=Math.abs(w-_.right),j=Math.min(T,B);this.data[l+w]=Math.max(0,Math.min(255,(_.isDash?j:-j)+128))}}addDash(s,i){const r=i?7:0,l=2*r+1;if(this.nextRow+l>this.height)return a.w("LineAtlas out of space"),null;let d=0;for(let w=0;w<s.length;w++)d+=s[w];if(d!==0){const w=this.width/d,T=this.getDashRanges(s,this.width,w);i?this.addRoundDash(T,w,r):this.addRegularDash(T)}const _={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:d};return this.nextRow+=l,this.dirty=!0,_}bind(s){const i=s.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const Oi="maplibre_preloaded_worker_pool";class tn{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<tn.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Oi]}numActive(){return Object.keys(this.active).length}}const qi=Math.floor(ae.hardwareConcurrency/2);let Ni,nn;function yn(){return Ni||(Ni=new tn),Ni}tn.workerCount=a.B(globalThis)?Math.max(Math.min(qi,3),1):1;class Ci{constructor(s,i){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=i;const r=this.workerPool.acquire(i);for(let l=0;l<r.length;l++){const d=new a.C(r[l],i);d.name=`Worker ${l}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,i){const r=[];for(const l of this.actors)r.push(l.sendAsync({type:s,data:i}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}registerMessageHandler(s,i){for(const r of this.actors)r.registerMessageHandler(s,i)}}function gi(){return nn||(nn=new Ci(yn(),a.G),nn.registerMessageHandler("getResource",(y,s,i)=>a.m(s,i))),nn}function Ri(y,s){const i=a.F();return a.H(i,i,[1,1,0]),a.J(i,i,[.5*y.width,.5*y.height,1]),a.K(i,i,y.calculatePosMatrix(s.toUnwrapped()))}function ai(y,s,i,r,l,d){const _=function(Y,ce,Se){if(Y)for(const Te of Y){const Re=ce[Te];if(Re&&Re.source===Se&&Re.type==="fill-extrusion")return!0}else for(const Te in ce){const Re=ce[Te];if(Re.source===Se&&Re.type==="fill-extrusion")return!0}return!1}(l&&l.layers,s,y.id),w=d.maxPitchScaleFactor(),T=y.tilesIn(r,w,_);T.sort(Ki);const B=[];for(const Y of T)B.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(s,i,y._state,Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,l,d,w,Ri(y.transform,Y.tileID))});const j=function(Y){const ce={},Se={};for(const Te of Y){const Re=Te.queryResults,Be=Te.wrappedTileID,Je=Se[Be]=Se[Be]||{};for(const xt in Re){const at=Re[xt],ct=Je[xt]=Je[xt]||{},Et=ce[xt]=ce[xt]||[];for(const wt of at)ct[wt.featureIndex]||(ct[wt.featureIndex]=!0,Et.push(wt))}}return ce}(B);for(const Y in j)j[Y].forEach(ce=>{const Se=ce.feature,Te=y.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Te});return j}function Ki(y,s){const i=y.tileID,r=s.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function Ji(y,s,i){return a._(this,void 0,void 0,function*(){let r=y;if(y.url?r=(yield a.h(s.transformRequest(y.url,Pt.Source),i)).data:yield ae.frameAsync(i),!r)return null;const l=a.L(a.e(r,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(l.vectorLayerIds=r.vector_layers.map(d=>d.id)),l})}class fi{constructor(s,i){s&&(i?this.setSouthWest(s).setNorthEast(i):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}setSouthWest(s){return this._sw=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}extend(s){const i=this._sw,r=this._ne;let l,d;if(s instanceof a.M)l=s,d=s;else{if(!(s instanceof fi))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(fi.convert(s)):this.extend(a.M.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(a.M.convert(s)):this;if(l=s._sw,d=s._ne,!l||!d)return this}return i||r?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),r.lng=Math.max(d.lng,r.lng),r.lat=Math.max(d.lat,r.lat)):(this._sw=new a.M(l.lng,l.lat),this._ne=new a.M(d.lng,d.lat)),this}getCenter(){return new a.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.M(this.getWest(),this.getNorth())}getSouthEast(){return new a.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:i,lat:r}=a.M.convert(s);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&l}static convert(s){return s instanceof fi?s:s&&new fi(s)}static fromLngLat(s,i=0){const r=360*i/40075017,l=r/Math.cos(Math.PI/180*s.lat);return new fi(new a.M(s.lng-l,s.lat-r),new a.M(s.lng+l,s.lat+r))}}class pn{constructor(s,i,r){this.bounds=fi.convert(this.validateBounds(s)),this.minzoom=i||0,this.maxzoom=r||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const i=Math.pow(2,s.z),r=Math.floor(a.N(this.bounds.getWest())*i),l=Math.floor(a.O(this.bounds.getNorth())*i),d=Math.ceil(a.N(this.bounds.getEast())*i),_=Math.ceil(a.O(this.bounds.getSouth())*i);return s.x>=r&&s.x<d&&s.y>=l&&s.y<_}}class ii extends a.E{constructor(s,i,r,l){if(super(),this.id=s,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.L(i,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(l)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield Ji(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s&&(a.e(this,s),s.bounds&&(this.tileBounds=new pn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.abort(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(i,Pt.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let l="reloadTile";if(s.actor&&s.state!=="expired"){if(s.state==="loading")return new Promise((d,_)=>{s.reloadPromise={resolve:d,reject:_}})}else s.actor=this.dispatcher.getActor(),l="loadTile";s.abortController=new AbortController;try{const d=yield s.actor.sendAsync({type:l,data:r},s.abortController);if(delete s.abortController,s.aborted)return;this._afterTileLoadWorkerResponse(s,d)}catch(d){if(delete s.abortController,s.aborted)return;if(d&&d.status!==404)throw d;this._afterTileLoadWorkerResponse(s,null)}})}_afterTileLoadWorkerResponse(s,i){if(i&&i.resourceTiming&&(s.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&s.setExpiryData(i),s.loadVectorData(i,this.map.painter),s.reloadPromise){const r=s.reloadPromise;s.reloadPromise=null,this.loadTile(s).then(r.resolve).catch(r.reject)}}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.actor&&(yield s.actor.sendAsync({type:"abortTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),s.actor&&(yield s.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class wn extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.setEventedParent(l),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},i),a.e(this,a.L(i,["url","scheme","tileSize"]))}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield Ji(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(a.e(this,s),s.bounds&&(this.tileBounds=new pn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}serialize(){return a.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.abortController=new AbortController;try{const r=yield Tt.getImage(this.map._requestManager.transformRequest(i,Pt.Tile),s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&s.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const l=this.map.painter.context,d=l.gl,_=r.data;s.texture=this.map.painter.getTileTexture(_.width),s.texture?s.texture.update(_,{useMipmap:!0}):(s.texture=new bt(l,_,d.RGBA,{useMipmap:!0}),s.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax)),s.state="loaded"}}catch(r){if(delete s.abortController,s.aborted)s.state="unloaded";else if(r)throw s.state="errored",r}})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController)})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.texture&&this.map.painter.saveTileTexture(s.texture)})}hasTransition(){return!1}}class Rr extends wn{constructor(s,i,r,l){super(s,i,r,l),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(i,Pt.Tile);s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.abortController=new AbortController;try{const l=yield Tt.getImage(r,s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(l&&l.data){const d=l.data;this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&s.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const _=a.b(d)&&a.S()?d:yield this.readImageNow(d),w={type:this.type,uid:s.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!s.actor||s.state==="expired"){s.actor=this.dispatcher.getActor();const T=yield s.actor.sendAsync({type:"loadDEMTile",data:w});s.dem=T,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded"}}}catch(l){if(delete s.abortController,s.aborted)s.state="unloaded";else if(l)throw s.state="errored",l}})}readImageNow(s){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.U()){const i=s.width+2,r=s.height+2;try{return new a.R({width:i,height:r},yield a.V(s,-1,-1,i,r))}catch{}}return ae.getImageData(s,1)})}_getNeighboringTiles(s){const i=s.canonical,r=Math.pow(2,i.z),l=(i.x-1+r)%r,d=i.x===0?s.wrap-1:s.wrap,_=(i.x+1+r)%r,w=i.x+1===r?s.wrap+1:s.wrap,T={};return T[new a.Q(s.overscaledZ,d,i.z,l,i.y).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y).key]={backfilled:!1},i.y>0&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y-1).key]={backfilled:!1}),i.y+1<r&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y+1).key]={backfilled:!1}),T}unloadTile(s){return a._(this,void 0,void 0,function*(){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&(yield s.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:s.uid,source:this.id}}))})}}class hi extends a.E{constructor(s,i,r,l){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(l),this._data=i.data,this._options=a.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const d=a.W/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*d,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*d,extent:a.W,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.W,radius:(i.clusterRadius||50)*d,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:s,source:this.id}})}getClusterChildren(s){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:s,source:this.id}})}getClusterLeaves(s,i,r){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:s,limit:i,offset:r}})}_updateWorkerData(s){return a._(this,void 0,void 0,function*(){const i=a.e({type:this.type},this.workerOptions);s?i.dataDiff=s:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(ae.resolveURL(this._data),Pt.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"}));try{const r=yield this.actor.sendAsync({type:"loadData",data:i});if(this._pendingLoads--,this._removed||r.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let l=null;r.resourceTiming&&r.resourceTiming[this.id]&&(l=r.resourceTiming[this.id].slice(0));const d={dataType:"source"};this._collectResourceTiming&&l&&l.length>0&&a.e(d,{resourceTiming:l}),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"content"})))}catch(r){if(this._pendingLoads--,this._removed)return void this.fire(new a.k("dataabort",{dataType:"source"}));this.fire(new a.j(r))}})}loaded(){return this._pendingLoads===0}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const r={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.abortController=new AbortController;const l=yield this.actor.sendAsync({type:i,data:r},s.abortController);delete s.abortController,s.unloadVectorData(),s.aborted||s.loadVectorData(l,this.map.painter,i==="reloadTile")})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.aborted=!0})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var en=a.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class tr extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(l),this.options=i}load(s){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield Tt.getImage(this.map._requestManager.transformRequest(this.url,Pt.Image),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,s&&(this.coordinates=s),this._finishLoading())}catch(i){this._request=null,this.fire(new a.j(i))}})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=s.url,this.load(s.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(s){this.coordinates=s;const i=s.map(a.Y.fromLngLat);this.tileID=function(l){let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const ce of l)d=Math.min(d,ce.x),_=Math.min(_,ce.y),w=Math.max(w,ce.x),T=Math.max(T,ce.y);const B=Math.max(w-d,T-_),j=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),Y=Math.pow(2,j);return new a.a0(j,Math.floor((d+w)/2*Y),Math.floor((_+T)/2*Y))}(i),this.minzoom=this.maxzoom=this.tileID.z;const r=i.map(l=>this.tileID.getTilePoint(l)._round());return this._boundsArray=new a.Z,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,a.W,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,a.W),this._boundsArray.emplaceBack(r[2].x,r[2].y,a.W,a.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,en.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new bt(s,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={}):s.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Fn extends tr{constructor(s,i,r,l){super(s,i,r,l),this.roundZoom=!0,this.type="video",this.options=i}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const s=this.options;this.urls=[];for(const i of s.urls)this.urls.push(this.map._requestManager.transformRequest(i,Pt.Source).url);try{const i=yield a.a2(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new a.j(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const i=this.video.seekable;s<i.start(0)||s>i.end(0)?this.fire(new a.j(new a.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,en.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new bt(s,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Qn extends tr{constructor(s,i,r,l){super(s,i,r,l),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(_=>typeof _!="number"))||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new a.j(new a.a1(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,r=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,en.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new bt(i,this.canvas,r.RGBA,{premultiply:!0});let l=!1;for(const d in this.tiles){const _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,l=!0)}l&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const In={},v=y=>{switch(y){case"geojson":return hi;case"image":return tr;case"raster":return wn;case"raster-dem":return Rr;case"vector":return ii;case"video":return Fn;case"canvas":return Qn}return In[y]};class k extends a.E{constructor(){super(...arguments),this.pluginStatus="unavailable",this.pluginURL=null,this.dispatcher=gi(),this.queue=[]}_sendPluginStateToWorker(){return a._(this,void 0,void 0,function*(){yield this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}),this.fire(new a.k("pluginStateChange",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}))})}getRTLTextPluginStatus(){return this.pluginStatus}clearRTLTextPlugin(){this.pluginStatus="unavailable",this.pluginURL=null}setRTLTextPlugin(s,i=!1){return a._(this,void 0,void 0,function*(){if(this.pluginStatus==="deferred"||this.pluginStatus==="loading"||this.pluginStatus==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");this.pluginURL=ae.resolveURL(s),this.pluginStatus="deferred",yield this._sendPluginStateToWorker(),i||(yield this._downloadRTLTextPlugin())})}_downloadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){if(this.pluginStatus!=="deferred"||!this.pluginURL)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");try{this.pluginStatus="loading",yield this._sendPluginStateToWorker(),yield a.l({url:this.pluginURL},new AbortController),this.pluginStatus="loaded"}catch{this.pluginStatus="error"}yield this._sendPluginStateToWorker()})}lazyLoadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){this.pluginStatus==="deferred"&&(yield this._downloadRTLTextPlugin())})}}let V=null;function $(){return V||(V=new k),V}class te{constructor(s,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=a.a3(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const i=s+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,i,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(l,d){const _={};if(!d)return _;for(const w of l){const T=w.layerIds.map(B=>d.getLayer(B)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(B=>T.filter(j=>j.id===B)[0]));for(const B of T)_[B.id]=w}}return _}(s.buckets,i.style),this.hasSymbolBuckets=!1;for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5&&d.hasRTLText){this.hasRTLText=!0,$().lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const l in this.buckets){const d=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(l).queryRadius(d))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new a.a4}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const r in this.buckets){const l=this.buckets[r];l.uploadPending()&&l.upload(s)}const i=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new bt(s,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new bt(s,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,i,r,l,d,_,w,T,B,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:d,scale:_,tileSize:this.tileSize,pixelPosMatrix:j,transform:T,params:w,queryPadding:this.queryPadding*B},s,i,r):{}}querySourceFeatures(s,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const l=r.loadVTLayers(),d=i&&i.sourceLayer?i.sourceLayer:"",_=l._geojsonTileLayer||l[d];if(!_)return;const w=a.a6(i&&i.filter),{z:T,x:B,y:j}=this.tileID.canonical,Y={z:T,x:B,y:j};for(let ce=0;ce<_.length;ce++){const Se=_.feature(ce);if(w.needGeometry){const Be=a.a7(Se,!0);if(!w.filter(new a.a8(this.tileID.overscaledZ),Be,this.tileID.canonical))continue}else if(!w.filter(new a.a8(this.tileID.overscaledZ),Se))continue;const Te=r.getId(Se,d),Re=new a.a9(Se,T,B,j,Te);Re.tile=Y,s.push(Re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const i=this.expirationTime;if(s.cacheControl){const r=a.aa(s.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const r=Date.now();let l=!1;if(this.expirationTime>r)l=!1;else if(i)if(this.expirationTime<i)l=!0;else{const d=this.expirationTime-i;d?this.expirationTime=r+Math.max(d,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const r=this.latestFeatureIndex.loadVTLayers();for(const l in this.buckets){if(!i.style.hasLayer(l))continue;const d=this.buckets[l],_=d.layers[0].sourceLayer||"_geojsonTileLayer",w=r[_],T=s[_];if(!w||!T||Object.keys(T).length===0)continue;d.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const B=i&&i.style&&i.style.getLayer(l);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ae.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=ae.now()+s}setDependencies(s,i){const r={};for(const l of i)r[l]=!0;this.dependencies[s]=r}hasDependency(s,i){for(const r of s){const l=this.dependencies[r];if(l){for(const d of i)if(l[d])return!0}}return!1}}class fe{constructor(s,i){this.max=s,this.onRemove=i,this.reset()}reset(){for(const s in this.data)for(const i of this.data[s])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(s,i,r){const l=s.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const d={value:i,timeout:void 0};if(r!==void 0&&(d.timeout=setTimeout(()=>{this.remove(s,d)},r)),this.data[l].push(d),this.order.push(l),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const i=this.data[s].shift();return i.timeout&&clearTimeout(i.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),i.value}getByKey(s){const i=this.data[s];return i?i[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,i){if(!this.has(s))return this;const r=s.wrapped().key,l=i===void 0?0:this.data[r].indexOf(i),d=this.data[r][l];return this.data[r].splice(l,1),d.timeout&&clearTimeout(d.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(d.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(s){const i=[];for(const r in this.data)for(const l of this.data[r])s(l.value)||i.push(l);for(const r of i)this.remove(r.value.tileID,r)}}class ve{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,i,r){const l=String(i);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][l]=this.stateChanges[s][l]||{},a.e(this.stateChanges[s][l],r),this.deletedStates[s]===null){this.deletedStates[s]={};for(const d in this.state[s])d!==l&&(this.deletedStates[s][d]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][l]===null){this.deletedStates[s][l]={};for(const d in this.state[s][l])r[d]||(this.deletedStates[s][l][d]=null)}else for(const d in r)this.deletedStates[s]&&this.deletedStates[s][l]&&this.deletedStates[s][l][d]===null&&delete this.deletedStates[s][l][d]}removeFeatureState(s,i,r){if(this.deletedStates[s]===null)return;const l=String(i);if(this.deletedStates[s]=this.deletedStates[s]||{},r&&i!==void 0)this.deletedStates[s][l]!==null&&(this.deletedStates[s][l]=this.deletedStates[s][l]||{},this.deletedStates[s][l][r]=null);else if(i!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][l])for(r in this.deletedStates[s][l]={},this.stateChanges[s][l])this.deletedStates[s][l][r]=null;else this.deletedStates[s][l]=null;else this.deletedStates[s]=null}getState(s,i){const r=String(i),l=a.e({},(this.state[s]||{})[r],(this.stateChanges[s]||{})[r]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const d=this.deletedStates[s][i];if(d===null)return{};for(const _ in d)delete l[_]}return l}initializeTileState(s,i){s.setFeatureState(this.state,i)}coalesceChanges(s,i){const r={};for(const l in this.stateChanges){this.state[l]=this.state[l]||{};const d={};for(const _ in this.stateChanges[l])this.state[l][_]||(this.state[l][_]={}),a.e(this.state[l][_],this.stateChanges[l][_]),d[_]=this.state[l][_];r[l]=d}for(const l in this.deletedStates){this.state[l]=this.state[l]||{};const d={};if(this.deletedStates[l]===null)for(const _ in this.state[l])d[_]={},this.state[l][_]={};else for(const _ in this.deletedStates[l]){if(this.deletedStates[l][_]===null)this.state[l][_]={};else for(const w of Object.keys(this.deletedStates[l][_]))delete this.state[l][_][w];d[_]=this.state[l][_]}r[l]=r[l]||{},a.e(r[l],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(const l in s)s[l].setFeatureState(r,i)}}class Ie extends a.E{constructor(s,i,r){super(),this.id=s,this.dispatcher=r,this.on("data",l=>{l.dataType==="source"&&l.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&l.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((l,d,_,w)=>{const T=new(v(d.type))(l,d,_,w);if(T.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${T.id}`);return T})(s,i,r,this),this._tiles={},this._cache=new fe(0,l=>this._unloadTile(l)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ve,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const i=this._tiles[s];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,i,r){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(s),this._tileLoaded(s,i,r)}catch(l){s.state="errored",l.status!==404?this._source.fire(new a.j(l,{tile:s})):this.update(this.transform,this.terrain)}})}_unloadTile(s){this._source.unloadTile&&this._source.unloadTile(s)}_abortTile(s){this._source.abortTile&&this._source.abortTile(s),this._source.fire(new a.k("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const r=this._tiles[i];r.upload(s),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Ee).map(s=>s.key)}getRenderableIds(s){const i=[];for(const r in this._tiles)this._isIdRenderable(r,s)&&i.push(this._tiles[r]);return s?i.sort((r,l)=>{const d=r.tileID,_=l.tileID,w=new a.P(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),T=new a.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-_.overscaledZ||T.y-w.y||T.x-w.x}).map(r=>r.tileID.key):i.map(r=>r.tileID).sort(Ee).map(r=>r.key)}hasRenderableParent(s){const i=this.findLoadedParent(s,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(s,i){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(i||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(s,i){return a._(this,void 0,void 0,function*(){const r=this._tiles[s];r&&(r.state!=="loading"&&(r.state=i),yield this._loadTile(r,s,i))})}_tileLoaded(s,i,r){s.timeAdded=ae.now(),r==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(i,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const i=this.getRenderableIds();for(let l=0;l<i.length;l++){const d=i[l];if(s.neighboringTiles&&s.neighboringTiles[d]){const _=this.getTileByID(d);r(s,_),r(_,s)}}function r(l,d){l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0;let _=d.tileID.canonical.x-l.tileID.canonical.x;const w=d.tileID.canonical.y-l.tileID.canonical.y,T=Math.pow(2,l.tileID.canonical.z),B=d.tileID.key;_===0&&w===0||Math.abs(w)>1||(Math.abs(_)>1&&(Math.abs(_+T)===1?_+=T:Math.abs(_-T)===1&&(_-=T)),d.dem&&l.dem&&(l.dem.backfillBorder(d.dem,_,w),l.neighboringTiles&&l.neighboringTiles[B]&&(l.neighboringTiles[B].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,i,r,l){for(const d in this._tiles){let _=this._tiles[d];if(l[d]||!_.hasData()||_.tileID.overscaledZ<=i||_.tileID.overscaledZ>r)continue;let w=_.tileID;for(;_&&_.tileID.overscaledZ>i+1;){const B=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[B.key],_&&_.hasData()&&(w=B)}let T=w;for(;T.overscaledZ>i;)if(T=T.scaledTo(T.overscaledZ-1),s[T.key]){l[w.key]=w;break}}}findLoadedParent(s,i){if(s.key in this._loadedParentTiles){const r=this._loadedParentTiles[s.key];return r&&r.tileID.overscaledZ>=i?r:null}for(let r=s.overscaledZ-1;r>=i;r--){const l=s.scaledTo(r),d=this._getLoadedTile(l);if(d)return d}}_getLoadedTile(s){const i=this._tiles[s.key];return i&&i.hasData()?i:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const i=Math.ceil(s.width/this._source.tileSize)+1,r=Math.ceil(s.height/this._source.tileSize)+1,l=Math.floor(i*r*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,l):l;this._cache.setMaxSize(d)}handleWrapJump(s){const i=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,i){const r={};for(const l in this._tiles){const d=this._tiles[l];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+i),r[d.tileID.key]=d}this._tiles=r;for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(l,this._tiles[l])}}update(s,i){if(this.transform=s,this.terrain=i,!this._sourceLoaded||this._paused)return;let r;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new a.Q(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(r=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(r=r.filter(j=>this._source.hasTile(j)))):r=[];const l=s.coveringZoomLevel(this._source),d=Math.max(l-Ie.maxOverzooming,this._source.minzoom),_=Math.max(l+Ie.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const Y of r)if(Y.canonical.z>this._source.minzoom){const ce=Y.scaledTo(Y.canonical.z-1);j[ce.key]=ce;const Se=Y.scaledTo(Math.max(this._source.minzoom,Math.min(Y.canonical.z,5)));j[Se.key]=Se}r=r.concat(Object.values(j))}const w=r.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(r,l);if(ze(this._source.type)){const j={},Y={},ce=Object.keys(T),Se=ae.now();for(const Te of ce){const Re=T[Te],Be=this._tiles[Te];if(!Be||Be.fadeEndTime!==0&&Be.fadeEndTime<=Se)continue;const Je=this.findLoadedParent(Re,d);Je&&(this._addTile(Je.tileID),j[Je.tileID.key]=Je.tileID),Y[Te]=Re}this._retainLoadedChildren(Y,l,_,T);for(const Te in j)T[Te]||(this._coveredTiles[Te]=!0,T[Te]=j[Te]);if(i){const Te={},Re={};for(const Be of r)this._tiles[Be.key].hasData()?Te[Be.key]=Be:Re[Be.key]=Be;for(const Be in Re){const Je=Re[Be].children(this._source.maxzoom);this._tiles[Je[0].key]&&this._tiles[Je[1].key]&&this._tiles[Je[2].key]&&this._tiles[Je[3].key]&&(Te[Je[0].key]=T[Je[0].key]=Je[0],Te[Je[1].key]=T[Je[1].key]=Je[1],Te[Je[2].key]=T[Je[2].key]=Je[2],Te[Je[3].key]=T[Je[3].key]=Je[3],delete Re[Be])}for(const Be in Re){const Je=this.findLoadedParent(Re[Be],this._source.minzoom);if(Je){Te[Je.tileID.key]=T[Je.tileID.key]=Je.tileID;for(const xt in Te)Te[xt].isChildOf(Je.tileID)&&delete Te[xt]}}for(const Be in this._tiles)Te[Be]||(this._coveredTiles[Be]=!0)}}for(const j in T)this._tiles[j].clearFadeHold();const B=a.ab(this._tiles,T);for(const j of B){const Y=this._tiles[j];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,i){const r={},l={},d=Math.max(i-Ie.maxOverzooming,this._source.minzoom),_=Math.max(i+Ie.maxUnderzooming,this._source.minzoom),w={};for(const T of s){const B=this._addTile(T);r[T.key]=T,B.hasData()||i<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,i,_,r);for(const T of s){let B=this._tiles[T.key];if(B.hasData())continue;if(i+1>this._source.maxzoom){const Y=T.children(this._source.maxzoom)[0],ce=this.getTile(Y);if(ce&&ce.hasData()){r[Y.key]=Y;continue}}else{const Y=T.children(this._source.maxzoom);if(r[Y[0].key]&&r[Y[1].key]&&r[Y[2].key]&&r[Y[3].key])continue}let j=B.wasRequested();for(let Y=T.overscaledZ-1;Y>=d;--Y){const ce=T.scaledTo(Y);if(l[ce.key])break;if(l[ce.key]=!0,B=this.getTile(ce),!B&&j&&(B=this._addTile(ce)),B){const Se=B.hasData();if((j||Se)&&(r[ce.key]=ce),j=B.wasRequested(),Se)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const i=[];let r,l=this._tiles[s].tileID;for(;l.overscaledZ>0;){if(l.key in this._loadedParentTiles){r=this._loadedParentTiles[l.key];break}i.push(l.key);const d=l.scaledTo(l.overscaledZ-1);if(r=this._getLoadedTile(d),r)break;l=d}for(const d of i)this._loadedParentTiles[d]=r}}_addTile(s){let i=this._tiles[s.key];if(i)return i;i=this._cache.getAndRemove(s),i&&(this._setTileReloadTimer(s.key,i),i.tileID=s,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,i)));const r=i;return i||(i=new te(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(i,s.key,i.state)),i.uses++,this._tiles[s.key]=i,r||this._source.fire(new a.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(s,i){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const r=i.getExpiryTimeout();r&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},r))}_removeTile(s){const i=this._tiles[s];i&&(i.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,i,r){const l=[],d=this.transform;if(!d)return l;const _=r?d.getCameraQueryGeometry(s):s,w=s.map(Te=>d.pointCoordinate(Te,this.terrain)),T=_.map(Te=>d.pointCoordinate(Te,this.terrain)),B=this.getIds();let j=1/0,Y=1/0,ce=-1/0,Se=-1/0;for(const Te of T)j=Math.min(j,Te.x),Y=Math.min(Y,Te.y),ce=Math.max(ce,Te.x),Se=Math.max(Se,Te.y);for(let Te=0;Te<B.length;Te++){const Re=this._tiles[B[Te]];if(Re.holdingForFade())continue;const Be=Re.tileID,Je=Math.pow(2,d.zoom-Re.tileID.overscaledZ),xt=i*Re.queryPadding*a.W/Re.tileSize/Je,at=[Be.getTilePoint(new a.Y(j,Y)),Be.getTilePoint(new a.Y(ce,Se))];if(at[0].x-xt<a.W&&at[0].y-xt<a.W&&at[1].x+xt>=0&&at[1].y+xt>=0){const ct=w.map(wt=>Be.getTilePoint(wt)),Et=T.map(wt=>Be.getTilePoint(wt));l.push({tile:Re,tileID:Be,queryGeometry:ct,cameraQueryGeometry:Et,scale:Je})}}return l}getVisibleCoordinates(s){const i=this.getRenderableIds(s).map(r=>this._tiles[r].tileID);for(const r of i)r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(ze(this._source.type)){const s=ae.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=s)return!0}return!1}setFeatureState(s,i,r){this._state.updateState(s=s||"_geojsonTileLayer",i,r)}removeFeatureState(s,i,r){this._state.removeFeatureState(s=s||"_geojsonTileLayer",i,r)}getFeatureState(s,i){return this._state.getState(s=s||"_geojsonTileLayer",i)}setDependencies(s,i,r){const l=this._tiles[s];l&&l.setDependencies(i,r)}reloadTilesForDependencies(s,i){for(const r in this._tiles)this._tiles[r].hasDependency(s,i)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(s,i))}}function Ee(y,s){const i=Math.abs(2*y.wrap)-+(y.wrap<0),r=Math.abs(2*s.wrap)-+(s.wrap<0);return y.overscaledZ-s.overscaledZ||r-i||s.canonical.y-y.canonical.y||s.canonical.x-y.canonical.x}function ze(y){return y==="raster"||y==="image"||y==="video"}Ie.maxOverzooming=10,Ie.maxUnderzooming=3;class Qe{constructor(s,i){this.reset(s,i)}reset(s,i){this.points=s||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.ac(s,0,1);let i=1,r=this._distances[i];const l=s*this.paddedLength+this.padding;for(;r<l&&i<this._distances.length;)r=this._distances[++i];const d=i-1,_=this._distances[d],w=r-_,T=w>0?(l-_)/w:0;return this.points[d].mult(1-T).add(this.points[i].mult(T))}}function He(y,s){let i=!0;return y==="always"||y!=="never"&&s!=="never"||(i=!1),i}class Ze{constructor(s,i,r){const l=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(s/r),this.yCellCount=Math.ceil(i/r);for(let _=0;_<this.xCellCount*this.yCellCount;_++)l.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=i,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,i,r,l,d){this._forEachCell(i,r,l,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(d)}insertCircle(s,i,r,l){this._forEachCell(i-l,r-l,i+l,r+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(i),this.circles.push(r),this.circles.push(l)}_insertBoxCell(s,i,r,l,d,_){this.boxCells[d].push(_)}_insertCircleCell(s,i,r,l,d,_){this.circleCells[d].push(_)}_query(s,i,r,l,d,_,w){if(r<0||s>this.width||l<0||i>this.height)return[];const T=[];if(s<=0&&i<=0&&this.width<=r&&this.height<=l){if(d)return[{key:null,x1:s,y1:i,x2:r,y2:l}];for(let B=0;B<this.boxKeys.length;B++)T.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const j=this.circles[3*B],Y=this.circles[3*B+1],ce=this.circles[3*B+2];T.push({key:this.circleKeys[B],x1:j-ce,y1:Y-ce,x2:j+ce,y2:Y+ce})}}else this._forEachCell(s,i,r,l,this._queryCell,T,{hitTest:d,overlapMode:_,seenUids:{box:{},circle:{}}},w);return T}query(s,i,r,l){return this._query(s,i,r,l,!1,null)}hitTest(s,i,r,l,d,_){return this._query(s,i,r,l,!0,d,_).length>0}hitTestCircle(s,i,r,l,d){const _=s-r,w=s+r,T=i-r,B=i+r;if(w<0||_>this.width||B<0||T>this.height)return!1;const j=[];return this._forEachCell(_,T,w,B,this._queryCellCircle,j,{hitTest:!0,overlapMode:l,circle:{x:s,y:i,radius:r},seenUids:{box:{},circle:{}}},d),j.length>0}_queryCell(s,i,r,l,d,_,w,T){const{seenUids:B,hitTest:j,overlapMode:Y}=w,ce=this.boxCells[d];if(ce!==null){const Te=this.bboxes;for(const Re of ce)if(!B.box[Re]){B.box[Re]=!0;const Be=4*Re,Je=this.boxKeys[Re];if(s<=Te[Be+2]&&i<=Te[Be+3]&&r>=Te[Be+0]&&l>=Te[Be+1]&&(!T||T(Je))&&(!j||!He(Y,Je.overlapMode))&&(_.push({key:Je,x1:Te[Be],y1:Te[Be+1],x2:Te[Be+2],y2:Te[Be+3]}),j))return!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!B.circle[Re]){B.circle[Re]=!0;const Be=3*Re,Je=this.circleKeys[Re];if(this._circleAndRectCollide(Te[Be],Te[Be+1],Te[Be+2],s,i,r,l)&&(!T||T(Je))&&(!j||!He(Y,Je.overlapMode))){const xt=Te[Be],at=Te[Be+1],ct=Te[Be+2];if(_.push({key:Je,x1:xt-ct,y1:at-ct,x2:xt+ct,y2:at+ct}),j)return!0}}}return!1}_queryCellCircle(s,i,r,l,d,_,w,T){const{circle:B,seenUids:j,overlapMode:Y}=w,ce=this.boxCells[d];if(ce!==null){const Te=this.bboxes;for(const Re of ce)if(!j.box[Re]){j.box[Re]=!0;const Be=4*Re,Je=this.boxKeys[Re];if(this._circleAndRectCollide(B.x,B.y,B.radius,Te[Be+0],Te[Be+1],Te[Be+2],Te[Be+3])&&(!T||T(Je))&&!He(Y,Je.overlapMode))return _.push(!0),!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!j.circle[Re]){j.circle[Re]=!0;const Be=3*Re,Je=this.circleKeys[Re];if(this._circlesCollide(Te[Be],Te[Be+1],Te[Be+2],B.x,B.y,B.radius)&&(!T||T(Je))&&!He(Y,Je.overlapMode))return _.push(!0),!0}}}_forEachCell(s,i,r,l,d,_,w,T){const B=this._convertToXCellCoord(s),j=this._convertToYCellCoord(i),Y=this._convertToXCellCoord(r),ce=this._convertToYCellCoord(l);for(let Se=B;Se<=Y;Se++)for(let Te=j;Te<=ce;Te++)if(d.call(this,s,i,r,l,this.xCellCount*Te+Se,_,w,T))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,i,r,l,d,_){const w=l-s,T=d-i,B=r+_;return B*B>w*w+T*T}_circleAndRectCollide(s,i,r,l,d,_,w){const T=(_-l)/2,B=Math.abs(s-(l+T));if(B>T+r)return!1;const j=(w-d)/2,Y=Math.abs(i-(d+j));if(Y>j+r)return!1;if(B<=T||Y<=j)return!0;const ce=B-T,Se=Y-j;return ce*ce+Se*Se<=r*r}}function Ve(y,s,i,r,l){const d=a.F();return s?(a.J(d,d,[1/l,1/l,1]),i||a.ad(d,d,r.angle)):a.K(d,r.labelPlaneMatrix,y),d}function ft(y,s,i,r,l){if(s){const d=a.ae(y);return a.J(d,d,[l,l,1]),i||a.ad(d,d,-r.angle),d}return r.glCoordMatrix}function nt(y,s,i){let r;i?(r=[y.x,y.y,i(y.x,y.y),1],a.af(r,r,s)):(r=[y.x,y.y,0,1],De(r,r,s));const l=r[3];return{point:new a.P(r[0]/l,r[1]/l),signedDistanceFromCamera:l}}function Me(y,s){return .5+y/s*.5}function se(y,s){const i=y[0]/y[3],r=y[1]/y[3];return i>=-s[0]&&i<=s[0]&&r>=-s[1]&&r<=s[1]}function ne(y,s,i,r,l,d,_,w,T,B){const j=r?y.textSizeData:y.iconSizeData,Y=a.ag(j,i.transform.zoom),ce=[256/i.width*2+1,256/i.height*2+1],Se=r?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;Se.clear();const Te=y.lineVertexArray,Re=r?y.text.placedSymbolArray:y.icon.placedSymbolArray,Be=i.transform.width/i.transform.height;let Je=!1;for(let xt=0;xt<Re.length;xt++){const at=Re.get(xt);if(at.hidden||at.writingMode===a.ah.vertical&&!Je){Ye(at.numGlyphs,Se);continue}let ct;if(Je=!1,B?(ct=[at.anchorX,at.anchorY,B(at.anchorX,at.anchorY),1],a.af(ct,ct,s)):(ct=[at.anchorX,at.anchorY,0,1],De(ct,ct,s)),!se(ct,ce)){Ye(at.numGlyphs,Se);continue}const Et=Me(i.transform.cameraToCenterDistance,ct[3]),wt=a.ai(j,Y,at),ri=_?wt/Et:wt*Et,Yt=new a.P(at.anchorX,at.anchorY),ei=nt(Yt,l,B).point,si={projections:{},offsets:{}},ji=de(at,ri,!1,w,s,l,d,y.glyphOffsetArray,Te,Se,ei,Yt,si,Be,T,B);Je=ji.useVertical,(ji.notEnoughRoom||Je||ji.needsFlipping&&de(at,ri,!0,w,s,l,d,y.glyphOffsetArray,Te,Se,ei,Yt,si,Be,T,B).notEnoughRoom)&&Ye(at.numGlyphs,Se)}r?y.text.dynamicLayoutVertexBuffer.updateData(Se):y.icon.dynamicLayoutVertexBuffer.updateData(Se)}function X(y,s,i,r,l,d,_,w,T,B,j,Y,ce){const Se=w.glyphStartIndex+w.numGlyphs,Te=w.lineStartIndex,Re=w.lineStartIndex+w.lineLength,Be=s.getoffsetX(w.glyphStartIndex),Je=s.getoffsetX(Se-1),xt=Ne(y*Be,i,r,l,d,_,w.segment,Te,Re,T,B,j,Y,ce);if(!xt)return null;const at=Ne(y*Je,i,r,l,d,_,w.segment,Te,Re,T,B,j,Y,ce);return at?{first:xt,last:at}:null}function ie(y,s,i,r){return y===a.ah.horizontal&&Math.abs(i.y-s.y)>Math.abs(i.x-s.x)*r?{useVertical:!0}:(y===a.ah.vertical?s.y<i.y:s.x>i.x)?{needsFlipping:!0}:null}function de(y,s,i,r,l,d,_,w,T,B,j,Y,ce,Se,Te,Re){const Be=s/24,Je=y.lineOffsetX*Be,xt=y.lineOffsetY*Be;let at;if(y.numGlyphs>1){const ct=y.glyphStartIndex+y.numGlyphs,Et=y.lineStartIndex,wt=y.lineStartIndex+y.lineLength,ri=X(Be,w,Je,xt,i,j,Y,y,T,d,ce,Te,Re);if(!ri)return{notEnoughRoom:!0};const Yt=nt(ri.first.point,_,Re).point,ei=nt(ri.last.point,_,Re).point;if(r&&!i){const si=ie(y.writingMode,Yt,ei,Se);if(si)return si}at=[ri.first];for(let si=y.glyphStartIndex+1;si<ct-1;si++)at.push(Ne(Be*w.getoffsetX(si),Je,xt,i,j,Y,y.segment,Et,wt,T,d,ce,Te,Re));at.push(ri.last)}else{if(r&&!i){const Et=nt(Y,l,Re).point,wt=y.lineStartIndex+y.segment+1,ri=new a.P(T.getx(wt),T.gety(wt)),Yt=nt(ri,l,Re),ei=Yt.signedDistanceFromCamera>0?Yt.point:ye(Y,ri,Et,1,l,Re),si=ie(y.writingMode,Et,ei,Se);if(si)return si}const ct=Ne(Be*w.getoffsetX(y.glyphStartIndex),Je,xt,i,j,Y,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,T,d,ce,Te,Re);if(!ct)return{notEnoughRoom:!0};at=[ct]}for(const ct of at)a.aj(B,ct.point,ct.angle);return{}}function ye(y,s,i,r,l,d){const _=nt(y.add(y.sub(s)._unit()),l,d).point,w=i.sub(_);return i.add(w._mult(r/w.mag()))}function ge(y,s){const{projectionCache:i,lineVertexArray:r,labelPlaneMatrix:l,tileAnchorPoint:d,distanceFromAnchor:_,getElevation:w,previousVertex:T,direction:B,absOffsetX:j}=s;if(i.projections[y])return i.projections[y];const Y=new a.P(r.getx(y),r.gety(y)),ce=nt(Y,l,w);if(ce.signedDistanceFromCamera>0)return i.projections[y]=ce.point,ce.point;const Se=y-B;return ye(_===0?d:new a.P(r.getx(Se),r.gety(Se)),Y,T,j-_+1,l,w)}function Pe(y,s,i){return y._unit()._perp()._mult(s*i)}function Fe(y,s,i,r,l,d,_,w){const{projectionCache:T,direction:B}=w;if(T.offsets[y])return T.offsets[y];const j=i.add(s);if(y+B<r||y+B>=l)return T.offsets[y]=j,j;const Y=ge(y+B,w),ce=Pe(Y.sub(i),_,B),Se=i.add(ce),Te=Y.add(ce);return T.offsets[y]=a.ak(d,j,Se,Te)||j,T.offsets[y]}function Ne(y,s,i,r,l,d,_,w,T,B,j,Y,ce,Se){const Te=r?y-s:y+s;let Re=Te>0?1:-1,Be=0;r&&(Re*=-1,Be=Math.PI),Re<0&&(Be+=Math.PI);let Je,xt,at=Re>0?w+_:w+_+1,ct=l,Et=l,wt=0,ri=0;const Yt=Math.abs(Te),ei=[];let si;for(;wt+ri<=Yt;){if(at+=Re,at<w||at>=T)return null;wt+=ri,Et=ct,xt=Je;const Ei={projectionCache:Y,lineVertexArray:B,labelPlaneMatrix:j,tileAnchorPoint:d,distanceFromAnchor:wt,getElevation:Se,previousVertex:Et,direction:Re,absOffsetX:Yt};if(ct=ge(at,Ei),i===0)ei.push(Et),si=ct.sub(Et);else{let Ui;const Gi=ct.sub(Et);Ui=Gi.mag()===0?Pe(ge(at+Re,Ei).sub(ct),i,Re):Pe(Gi,i,Re),xt||(xt=Et.add(Ui)),Je=Fe(at,Ui,ct,w,T,xt,i,Ei),ei.push(xt),si=Je.sub(xt)}ri=si.mag()}const ji=si._mult((Yt-wt)/ri)._add(xt||Et),Qi=Be+Math.atan2(ct.y-Et.y,ct.x-Et.x);return ei.push(ji),{point:ji,angle:ce?Qi:0,path:ei}}const Xe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ye(y,s){for(let i=0;i<y;i++){const r=s.length;s.resize(r+4),s.float32.set(Xe,3*r)}}function De(y,s,i){const r=s[0],l=s[1];return y[0]=i[0]*r+i[4]*l+i[12],y[1]=i[1]*r+i[5]*l+i[13],y[3]=i[3]*r+i[7]*l+i[15],y}const Ue=100;class ht{constructor(s,i=new Ze(s.width+200,s.height+200,25),r=new Ze(s.width+200,s.height+200,25)){this.transform=s,this.grid=i,this.ignoredGrid=r,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Ue,this.screenBottomBoundary=s.height+Ue,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,i,r,l,d,_){const w=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY,_),T=r*w.perspectiveRatio,B=s.x1*T+w.point.x,j=s.y1*T+w.point.y,Y=s.x2*T+w.point.x,ce=s.y2*T+w.point.y;return!this.isInsideGrid(B,j,Y,ce)||i!=="always"&&this.grid.hitTest(B,j,Y,ce,i,d)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[B,j,Y,ce],offscreen:this.isOffscreen(B,j,Y,ce)}}placeCollisionCircles(s,i,r,l,d,_,w,T,B,j,Y,ce,Se,Te){const Re=[],Be=new a.P(i.anchorX,i.anchorY),Je=nt(Be,_,Te),xt=Me(this.transform.cameraToCenterDistance,Je.signedDistanceFromCamera),at=(j?d/xt:d*xt)/a.ao,ct=nt(Be,w,Te).point,Et=X(at,l,i.lineOffsetX*at,i.lineOffsetY*at,!1,ct,Be,i,r,w,{projections:{},offsets:{}},!1,Te);let wt=!1,ri=!1,Yt=!0;if(Et){const ei=.5*ce*xt+Se,si=new a.P(-100,-100),ji=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Qi=new Qe,Ei=Et.first,Ui=Et.last;let Gi=[];for(let rn=Ei.path.length-1;rn>=1;rn--)Gi.push(Ei.path[rn]);for(let rn=1;rn<Ui.path.length;rn++)Gi.push(Ui.path[rn]);const ln=2.5*ei;if(T){const rn=Gi.map(kn=>nt(kn,T,Te));Gi=rn.some(kn=>kn.signedDistanceFromCamera<=0)?[]:rn.map(kn=>kn.point)}let Bn=[];if(Gi.length>0){const rn=Gi[0].clone(),kn=Gi[0].clone();for(let yr=1;yr<Gi.length;yr++)rn.x=Math.min(rn.x,Gi[yr].x),rn.y=Math.min(rn.y,Gi[yr].y),kn.x=Math.max(kn.x,Gi[yr].x),kn.y=Math.max(kn.y,Gi[yr].y);Bn=rn.x>=si.x&&kn.x<=ji.x&&rn.y>=si.y&&kn.y<=ji.y?[Gi]:kn.x<si.x||rn.x>ji.x||kn.y<si.y||rn.y>ji.y?[]:a.al([Gi],si.x,si.y,ji.x,ji.y)}for(const rn of Bn){Qi.reset(rn,.25*ei);let kn=0;kn=Qi.length<=.5*ei?1:Math.ceil(Qi.paddedLength/ln)+1;for(let yr=0;yr<kn;yr++){const er=yr/Math.max(kn-1,1),Ia=Qi.lerp(er),Aa=Ia.x+Ue,Bs=Ia.y+Ue;Re.push(Aa,Bs,ei,0);const so=Aa-ei,ao=Bs-ei,qr=Aa+ei,ya=Bs+ei;if(Yt=Yt&&this.isOffscreen(so,ao,qr,ya),ri=ri||this.isInsideGrid(so,ao,qr,ya),s!=="always"&&this.grid.hitTestCircle(Aa,Bs,ei,s,Y)&&(wt=!0,!B))return{circles:[],offscreen:!1,collisionDetected:wt}}}}return{circles:!B&&wt||!ri||xt<this.perspectiveRatioCutoff?[]:Re,offscreen:Yt,collisionDetected:wt}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let r=1/0,l=1/0,d=-1/0,_=-1/0;for(const j of s){const Y=new a.P(j.x+Ue,j.y+Ue);r=Math.min(r,Y.x),l=Math.min(l,Y.y),d=Math.max(d,Y.x),_=Math.max(_,Y.y),i.push(Y)}const w=this.grid.query(r,l,d,_).concat(this.ignoredGrid.query(r,l,d,_)),T={},B={};for(const j of w){const Y=j.key;if(T[Y.bucketInstanceId]===void 0&&(T[Y.bucketInstanceId]={}),T[Y.bucketInstanceId][Y.featureIndex])continue;const ce=[new a.P(j.x1,j.y1),new a.P(j.x2,j.y1),new a.P(j.x2,j.y2),new a.P(j.x1,j.y2)];a.am(i,ce)&&(T[Y.bucketInstanceId][Y.featureIndex]=!0,B[Y.bucketInstanceId]===void 0&&(B[Y.bucketInstanceId]=[]),B[Y.bucketInstanceId].push(Y.featureIndex))}return B}insertCollisionBox(s,i,r,l,d,_){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,i,r,l,d,_){const w=r?this.ignoredGrid:this.grid,T={bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i};for(let B=0;B<s.length;B+=4)w.insertCircle(T,s[B],s[B+1],s[B+2])}projectAndGetPerspectiveRatio(s,i,r,l){let d;return l?(d=[i,r,l(i,r),1],a.af(d,d,s)):(d=[i,r,0,1],De(d,d,s)),{point:new a.P((d[0]/d[3]+1)/2*this.transform.width+Ue,(-d[1]/d[3]+1)/2*this.transform.height+Ue),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(s,i,r,l){return r<Ue||s>=this.screenRightBoundary||l<Ue||i>this.screenBottomBoundary}isInsideGrid(s,i,r,l){return r>=0&&s<this.gridRightBoundary&&l>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const s=a.an([]);return a.H(s,s,[-100,-100,0]),s}}function kt(y,s,i){return s*(a.W/(y.tileSize*Math.pow(2,i-y.tileID.overscaledZ)))}class o{constructor(s,i,r,l){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?i:-i))):l&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}}class ke{constructor(s,i,r,l,d){this.text=new o(s?s.text:null,i,r,d),this.icon=new o(s?s.icon:null,i,l,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oi{constructor(s,i,r){this.text=s,this.icon=i,this.skipFade=r}}class di{constructor(){this.invProjMatrix=a.F(),this.viewportMatrix=a.F(),this.circles=[]}}class Ai{constructor(s,i,r,l,d){this.bucketInstanceId=s,this.featureIndex=i,this.sourceLayerIndex=r,this.bucketIndex=l,this.tileID=d}}class Jt{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const i=++this.maxGroupID;this.collisionGroups[s]={ID:i,predicate:r=>r.collisionGroupID===i}}return this.collisionGroups[s]}}function li(y,s,i,r,l){const{horizontalAlign:d,verticalAlign:_}=a.at(y);return new a.P(-(d-.5)*s+r[0]*l,-(_-.5)*i+r[1]*l)}function zi(y,s,i,r,l,d){const{x1:_,x2:w,y1:T,y2:B,anchorPointX:j,anchorPointY:Y}=y,ce=new a.P(s,i);return r&&ce._rotate(l?d:-d),{x1:_+ce.x,y1:T+ce.y,x2:w+ce.x,y2:B+ce.y,anchorPointX:j,anchorPointY:Y}}class vi{constructor(s,i,r,l,d){this.transform=s.clone(),this.terrain=i,this.collisionIndex=new ht(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Jt(l),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,i,r,l){const d=r.getBucket(i),_=r.latestFeatureIndex;if(!d||!_||i.id!==d.layerIds[0])return;const w=r.collisionBoxArray,T=d.layers[0].layout,B=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),j=r.tileSize/a.W,Y=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),ce=T.get("text-pitch-alignment")==="map",Se=T.get("text-rotation-alignment")==="map",Te=kt(r,1,this.transform.zoom),Re=Ve(Y,ce,Se,this.transform,Te);let Be=null;if(ce){const xt=ft(Y,ce,Se,this.transform,Te);Be=a.K([],this.transform.labelPlaneMatrix,xt)}this.retainedQueryData[d.bucketInstanceId]=new Ai(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,r.tileID);const Je={bucket:d,layout:T,posMatrix:Y,textLabelPlaneMatrix:Re,labelToScreenMatrix:Be,scale:B,textPixelRatio:j,holdingForFade:r.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:a.ag(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(l)for(const xt of d.sortKeyRanges){const{sortKey:at,symbolInstanceStart:ct,symbolInstanceEnd:Et}=xt;s.push({sortKey:at,symbolInstanceStart:ct,symbolInstanceEnd:Et,parameters:Je})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:Je})}attemptAnchorPlacement(s,i,r,l,d,_,w,T,B,j,Y,ce,Se,Te,Re,Be){const Je=a.ap[s.textAnchor],xt=[s.textOffset0,s.textOffset1],at=li(Je,r,l,xt,d),ct=this.collisionIndex.placeCollisionBox(zi(i,at.x,at.y,_,w,this.transform.angle),Y,T,B,j.predicate,Be);if((!Re||this.collisionIndex.placeCollisionBox(zi(Re,at.x,at.y,_,w,this.transform.angle),Y,T,B,j.predicate,Be).box.length!==0)&&ct.box.length>0){let Et;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(Et=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:xt,width:r,height:l,anchor:Je,textBoxScale:d,prevAnchor:Et},this.markUsedJustification(Se,Je,ce,Te),Se.allowVerticalPlacement&&(this.markUsedOrientation(Se,Te,ce),this.placedOrientations[ce.crossTileID]=Te),{shift:at,placedGlyphBoxes:ct}}}placeLayerBucketPart(s,i,r){const{bucket:l,layout:d,posMatrix:_,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:B,holdingForFade:j,collisionBoxArray:Y,partiallyEvaluatedTextSize:ce,collisionGroup:Se}=s.parameters,Te=d.get("text-optional"),Re=d.get("icon-optional"),Be=a.aq(d,"text-overlap","text-allow-overlap"),Je=Be==="always",xt=a.aq(d,"icon-overlap","icon-allow-overlap"),at=xt==="always",ct=d.get("text-rotation-alignment")==="map",Et=d.get("text-pitch-alignment")==="map",wt=d.get("icon-text-fit")!=="none",ri=d.get("symbol-z-order")==="viewport-y",Yt=Je&&(at||!l.hasIconData()||Re),ei=at&&(Je||!l.hasTextData()||Te);!l.collisionArrays&&Y&&l.deserializeCollisionBoxes(Y);const si=this.retainedQueryData[l.bucketInstanceId].tileID,ji=this.terrain?(Ei,Ui)=>this.terrain.getElevation(si,Ei,Ui):null,Qi=(Ei,Ui)=>{var Gi,ln;if(i[Ei.crossTileID])return;if(j)return void(this.placements[Ei.crossTileID]=new oi(!1,!1,!1));let Bn=!1,rn=!1,kn=!0,yr=null,er={box:null,offscreen:null},Ia={box:null,offscreen:null},Aa=null,Bs=null,so=null,ao=0,qr=0,ya=0;Ui.textFeatureIndex?ao=Ui.textFeatureIndex:Ei.useRuntimeCollisionCircles&&(ao=Ei.featureIndex),Ui.verticalTextFeatureIndex&&(qr=Ui.verticalTextFeatureIndex);const _o=Ui.textBox;if(_o){const ts=Qs=>{let Mo=a.ah.horizontal;if(l.allowVerticalPlacement&&!Qs&&this.prevPlacement){const No=this.prevPlacement.placedOrientations[Ei.crossTileID];No&&(this.placedOrientations[Ei.crossTileID]=No,Mo=No,this.markUsedOrientation(l,Mo,Ei))}return Mo},is=(Qs,Mo)=>{if(l.allowVerticalPlacement&&Ei.numVerticalGlyphVertices>0&&Ui.verticalTextBox){for(const No of l.writingModes)if(No===a.ah.vertical?(er=Mo(),Ia=er):er=Qs(),er&&er.box&&er.box.length)break}else er=Qs()},zr=Ei.textAnchorOffsetStartIndex,bs=Ei.textAnchorOffsetEndIndex;if(bs===zr){const Qs=(Mo,No)=>{const Vo=this.collisionIndex.placeCollisionBox(Mo,Be,B,_,Se.predicate,ji);return Vo&&Vo.box&&Vo.box.length&&(this.markUsedOrientation(l,No,Ei),this.placedOrientations[Ei.crossTileID]=No),Vo};is(()=>Qs(_o,a.ah.horizontal),()=>{const Mo=Ui.verticalTextBox;return l.allowVerticalPlacement&&Ei.numVerticalGlyphVertices>0&&Mo?Qs(Mo,a.ah.vertical):{box:null,offscreen:null}}),ts(er&&er.box&&er.box.length)}else{let Qs=a.ap[(ln=(Gi=this.prevPlacement)===null||Gi===void 0?void 0:Gi.variableOffsets[Ei.crossTileID])===null||ln===void 0?void 0:ln.anchor];const Mo=(Vo,Sc,Ws)=>{const Zl=Vo.x2-Vo.x1,hu=Vo.y2-Vo.y1,il=Ei.textBoxScale,vl=wt&&xt==="never"?Sc:null;let Pl={box:[],offscreen:!1},Au=Be==="never"?1:2,af="never";Qs&&Au++;for(let Vh=0;Vh<Au;Vh++){for(let Pa=zr;Pa<bs;Pa++){const pA=l.textAnchorOffsets.get(Pa);if(Qs&&pA.textAnchor!==Qs)continue;const yh=this.attemptAnchorPlacement(pA,Vo,Zl,hu,il,ct,Et,B,_,Se,af,Ei,l,Ws,vl,ji);if(yh&&(Pl=yh.placedGlyphBoxes,Pl&&Pl.box&&Pl.box.length))return Bn=!0,yr=yh.shift,Pl}Qs?Qs=null:af=Be}return Pl};is(()=>Mo(_o,Ui.iconBox,a.ah.horizontal),()=>{const Vo=Ui.verticalTextBox;return l.allowVerticalPlacement&&!(er&&er.box&&er.box.length)&&Ei.numVerticalGlyphVertices>0&&Vo?Mo(Vo,Ui.verticalIconBox,a.ah.vertical):{box:null,offscreen:null}}),er&&(Bn=er.box,kn=er.offscreen);const No=ts(er&&er.box);if(!Bn&&this.prevPlacement){const Vo=this.prevPlacement.variableOffsets[Ei.crossTileID];Vo&&(this.variableOffsets[Ei.crossTileID]=Vo,this.markUsedJustification(l,Vo.anchor,Ei,No))}}}if(Aa=er,Bn=Aa&&Aa.box&&Aa.box.length>0,kn=Aa&&Aa.offscreen,Ei.useRuntimeCollisionCircles){const ts=l.text.placedSymbolArray.get(Ei.centerJustifiedTextSymbolIndex),is=a.ai(l.textSizeData,ce,ts),zr=d.get("text-padding");Bs=this.collisionIndex.placeCollisionCircles(Be,ts,l.lineVertexArray,l.glyphOffsetArray,is,_,w,T,r,Et,Se.predicate,Ei.collisionCircleDiameter,zr,ji),Bs.circles.length&&Bs.collisionDetected&&!r&&a.w("Collisions detected, but collision boxes are not shown"),Bn=Je||Bs.circles.length>0&&!Bs.collisionDetected,kn=kn&&Bs.offscreen}if(Ui.iconFeatureIndex&&(ya=Ui.iconFeatureIndex),Ui.iconBox){const ts=is=>{const zr=wt&&yr?zi(is,yr.x,yr.y,ct,Et,this.transform.angle):is;return this.collisionIndex.placeCollisionBox(zr,xt,B,_,Se.predicate,ji)};Ia&&Ia.box&&Ia.box.length&&Ui.verticalIconBox?(so=ts(Ui.verticalIconBox),rn=so.box.length>0):(so=ts(Ui.iconBox),rn=so.box.length>0),kn=kn&&so.offscreen}const yo=Te||Ei.numHorizontalGlyphVertices===0&&Ei.numVerticalGlyphVertices===0,Zs=Re||Ei.numIconVertices===0;if(yo||Zs?Zs?yo||(rn=rn&&Bn):Bn=rn&&Bn:rn=Bn=rn&&Bn,Bn&&Aa&&Aa.box&&this.collisionIndex.insertCollisionBox(Aa.box,Be,d.get("text-ignore-placement"),l.bucketInstanceId,Ia&&Ia.box&&qr?qr:ao,Se.ID),rn&&so&&this.collisionIndex.insertCollisionBox(so.box,xt,d.get("icon-ignore-placement"),l.bucketInstanceId,ya,Se.ID),Bs&&(Bn&&this.collisionIndex.insertCollisionCircles(Bs.circles,Be,d.get("text-ignore-placement"),l.bucketInstanceId,ao,Se.ID),r)){const ts=l.bucketInstanceId;let is=this.collisionCircleArrays[ts];is===void 0&&(is=this.collisionCircleArrays[ts]=new di);for(let zr=0;zr<Bs.circles.length;zr+=4)is.circles.push(Bs.circles[zr+0]),is.circles.push(Bs.circles[zr+1]),is.circles.push(Bs.circles[zr+2]),is.circles.push(Bs.collisionDetected?1:0)}if(Ei.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(l.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ei.crossTileID]=new oi(Bn||Yt,rn||ei,kn||l.justReloaded),i[Ei.crossTileID]=!0};if(ri){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ei=l.getSortedSymbolIndexes(this.transform.angle);for(let Ui=Ei.length-1;Ui>=0;--Ui){const Gi=Ei[Ui];Qi(l.symbolInstances.get(Gi),l.collisionArrays[Gi])}}else for(let Ei=s.symbolInstanceStart;Ei<s.symbolInstanceEnd;Ei++)Qi(l.symbolInstances.get(Ei),l.collisionArrays[Ei]);if(r&&l.bucketInstanceId in this.collisionCircleArrays){const Ei=this.collisionCircleArrays[l.bucketInstanceId];a.ar(Ei.invProjMatrix,_),Ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}l.justReloaded=!1}markUsedJustification(s,i,r,l){let d;d=l===a.ah.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[a.as(i)];const _=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const w of _)w>=0&&(s.text.placedSymbolArray.get(w).crossTileID=d>=0&&w!==d?0:r.crossTileID)}markUsedOrientation(s,i,r){const l=i===a.ah.horizontal||i===a.ah.horizontalOnly?i:0,d=i===a.ah.vertical?i:0,_=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const w of _)s.text.placedSymbolArray.get(w).placedOrientation=l;r.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let r=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const l=i?i.symbolFadeChange(s):1,d=i?i.opacities:{},_=i?i.variableOffsets:{},w=i?i.placedOrientations:{};for(const T in this.placements){const B=this.placements[T],j=d[T];j?(this.opacities[T]=new ke(j,l,B.text,B.icon),r=r||B.text!==j.text.placed||B.icon!==j.icon.placed):(this.opacities[T]=new ke(null,l,B.text,B.icon,B.skipFade),r=r||B.text||B.icon)}for(const T in d){const B=d[T];if(!this.opacities[T]){const j=new ke(B,l,!1,!1);j.isHidden()||(this.opacities[T]=j,r=r||B.text.placed||B.icon.placed)}}for(const T in _)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=_[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:s)}updateLayerOpacities(s,i){const r={};for(const l of i){const d=l.getBucket(s);d&&l.latestFeatureIndex&&s.id===d.layerIds[0]&&this.updateBucketOpacities(d,r,l.collisionBoxArray)}}updateBucketOpacities(s,i,r){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const l=s.layers[0],d=l.layout,_=new ke(null,0,!1,!1,!0),w=d.get("text-allow-overlap"),T=d.get("icon-allow-overlap"),B=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=d.get("text-rotation-alignment")==="map",Y=d.get("text-pitch-alignment")==="map",ce=d.get("icon-text-fit")!=="none",Se=new ke(null,0,w&&(T||!s.hasIconData()||d.get("icon-optional")),T&&(w||!s.hasTextData()||d.get("text-optional")),!0);!s.collisionArrays&&r&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(r);const Te=(Re,Be,Je)=>{for(let xt=0;xt<Be/4;xt++)Re.opacityVertexArray.emplaceBack(Je);Re.hasVisibleVertices=Re.hasVisibleVertices||Je!==On};for(let Re=0;Re<s.symbolInstances.length;Re++){const Be=s.symbolInstances.get(Re),{numHorizontalGlyphVertices:Je,numVerticalGlyphVertices:xt,crossTileID:at}=Be;let ct=this.opacities[at];i[at]?ct=_:ct||(ct=Se,this.opacities[at]=ct),i[at]=!0;const Et=Be.numIconVertices>0,wt=this.placedOrientations[Be.crossTileID],ri=wt===a.ah.vertical,Yt=wt===a.ah.horizontal||wt===a.ah.horizontalOnly;if(Je>0||xt>0){const ei=ur(ct.text);Te(s.text,Je,ri?On:ei),Te(s.text,xt,Yt?On:ei);const si=ct.text.isHidden();[Be.rightJustifiedTextSymbolIndex,Be.centerJustifiedTextSymbolIndex,Be.leftJustifiedTextSymbolIndex].forEach(Ei=>{Ei>=0&&(s.text.placedSymbolArray.get(Ei).hidden=si||ri?1:0)}),Be.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Be.verticalPlacedTextSymbolIndex).hidden=si||Yt?1:0);const ji=this.variableOffsets[Be.crossTileID];ji&&this.markUsedJustification(s,ji.anchor,Be,wt);const Qi=this.placedOrientations[Be.crossTileID];Qi&&(this.markUsedJustification(s,"left",Be,Qi),this.markUsedOrientation(s,Qi,Be))}if(Et){const ei=ur(ct.icon),si=!(ce&&Be.verticalPlacedIconSymbolIndex&&ri);Be.placedIconSymbolIndex>=0&&(Te(s.icon,Be.numIconVertices,si?ei:On),s.icon.placedSymbolArray.get(Be.placedIconSymbolIndex).hidden=ct.icon.isHidden()),Be.verticalPlacedIconSymbolIndex>=0&&(Te(s.icon,Be.numVerticalIconVertices,si?On:ei),s.icon.placedSymbolArray.get(Be.verticalPlacedIconSymbolIndex).hidden=ct.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const ei=s.collisionArrays[Re];if(ei){let si=new a.P(0,0);if(ei.textBox||ei.verticalTextBox){let Qi=!0;if(B){const Ei=this.variableOffsets[at];Ei?(si=li(Ei.anchor,Ei.width,Ei.height,Ei.textOffset,Ei.textBoxScale),j&&si._rotate(Y?this.transform.angle:-this.transform.angle)):Qi=!1}ei.textBox&&wi(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Qi||ri,si.x,si.y),ei.verticalTextBox&&wi(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Qi||Yt,si.x,si.y)}const ji=!!(!Yt&&ei.verticalIconBox);ei.iconBox&&wi(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,ji,ce?si.x:0,ce?si.y:0),ei.verticalIconBox&&wi(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,!ji,ce?si.x:0,ce?si.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Re.invProjMatrix,s.placementViewportMatrix=Re.viewportMatrix,s.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,i){const r=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*r>s}setStale(){this.stale=!0}}function wi(y,s,i,r,l){y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0)}const $t=Math.pow(2,25),vn=Math.pow(2,24),or=Math.pow(2,17),mn=Math.pow(2,16),qn=Math.pow(2,9),jr=Math.pow(2,8),Hi=Math.pow(2,1);function ur(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const s=y.placed?1:0,i=Math.floor(127*y.opacity);return i*$t+s*vn+i*or+s*mn+i*qn+s*jr+i*Hi+s}const On=0;class Qt{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,i,r,l,d){const _=this._bucketParts;for(;this._currentTileIndex<s.length;)if(i.getBucketParts(_,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<_.length;)if(i.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,d())return!0;return!1}}class Yi{constructor(s,i,r,l,d,_,w,T){this.placement=new vi(s,i,_,w,T),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(s,i,r){const l=ae.now(),d=()=>!this._forceFullPlacement&&ae.now()-l>2;for(;this._currentPlacementIndex>=0;){const _=i[s[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=w)&&(!_.maxzoom||_.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Qt(_)),this._inProgressLayer.continuePlacement(r[_.source],this.placement,this._showCollisionBoxes,_,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Ut=512/a.W/2;class Tn{constructor(s,i,r){this.tileID=s,this.bucketInstanceId=r,this._symbolsByKey={};const l=new Map;for(let d=0;d<i.length;d++){const _=i.get(d),w=_.key,T=l.get(w);T?T.push(_):l.set(w,[_])}for(const[d,_]of l){const w={positions:_.map(T=>({x:Math.floor(T.anchorX*Ut),y:Math.floor(T.anchorY*Ut)})),crossTileIDs:_.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new a.au(w.positions.length,16,Uint16Array);for(const{x:B,y:j}of w.positions)T.add(B,j);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[d]=w}}getScaledCoordinates(s,i){const{x:r,y:l,z:d}=this.tileID.canonical,{x:_,y:w,z:T}=i.canonical,B=Ut/Math.pow(2,T-d),j=(w*a.W+s.anchorY)*B,Y=l*a.W*Ut;return{x:Math.floor((_*a.W+s.anchorX)*B-r*a.W*Ut),y:Math.floor(j-Y)}}findMatches(s,i,r){const l=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let d=0;d<s.length;d++){const _=s.get(d);if(_.crossTileID)continue;const w=this._symbolsByKey[_.key];if(!w)continue;const T=this.getScaledCoordinates(_,i);if(w.index){const B=w.index.range(T.x-l,T.y-l,T.x+l,T.y+l).sort();for(const j of B){const Y=w.crossTileIDs[j];if(!r[Y]){r[Y]=!0,_.crossTileID=Y;break}}}else if(w.positions)for(let B=0;B<w.positions.length;B++){const j=w.positions[B],Y=w.crossTileIDs[B];if(Math.abs(j.x-T.x)<=l&&Math.abs(j.y-T.y)<=l&&!r[Y]){r[Y]=!0,_.crossTileID=Y;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class cr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ns{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const i=Math.round((s-this.lng)/360);if(i!==0)for(const r in this.indexes){const l=this.indexes[r],d={};for(const _ in l){const w=l[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+i),d[w.tileID.key]=w}this.indexes[r]=d}this.lng=s}addBucket(s,i,r){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let d=0;d<i.symbolInstances.length;d++)i.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const l=this.usedCrossTileIDs[s.overscaledZ];for(const d in this.indexes){const _=this.indexes[d];if(Number(d)>s.overscaledZ)for(const w in _){const T=_[w];T.tileID.isChildOf(s)&&T.findMatches(i.symbolInstances,s,l)}else{const w=_[s.scaledTo(Number(d)).key];w&&w.findMatches(i.symbolInstances,s,l)}}for(let d=0;d<i.symbolInstances.length;d++){const _=i.symbolInstances.get(d);_.crossTileID||(_.crossTileID=r.generate(),l[_.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Tn(s,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(s,i){for(const r of i.getCrossTileIDsLists())for(const l of r)delete this.usedCrossTileIDs[s][l]}removeStaleBuckets(s){let i=!1;for(const r in this.indexes){const l=this.indexes[r];for(const d in l)s[l[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,l[d]),delete l[d],i=!0)}return i}}class Ur{constructor(){this.layerIndexes={},this.crossTileIDs=new cr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,i,r){let l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new Ns);let d=!1;const _={};l.handleWrapJump(r);for(const w of i){const T=w.getBucket(s);T&&s.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(w.tileID,T,this.crossTileIDs)&&(d=!0),_[T.bucketInstanceId]=!0)}return l.removeStaleBuckets(_)&&(d=!0),d}pruneUnusedLayers(s){const i={};s.forEach(r=>{i[r]=!0});for(const r in this.layerIndexes)i[r]||delete this.layerIndexes[r]}}const Vt=(y,s)=>a.t(y,s&&s.filter(i=>i.identifier!=="source.canvas")),hr=a.av();class Lt extends a.E{constructor(s,i={}){super(),this._rtlTextPluginStateChange=()=>{for(const r in this.sourceCaches){const l=this.sourceCaches[r].getSource().type;l!=="vector"&&l!=="geojson"||this.sourceCaches[r].reload()}},this.map=s,this.dispatcher=new Ci(yn(),s._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(r,l)=>this.getGlyphs(r,l)),this.dispatcher.registerMessageHandler("getImages",(r,l)=>this.getImages(r,l)),this.imageManager=new $e,this.imageManager.setEventedParent(this),this.glyphManager=new Rt(s._requestManager,i.localIdeographFontFamily),this.lineAtlas=new Ti(256,512),this.crossTileSymbolIndex=new Ur,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.ax()),$().on("pluginStateChange",this._rtlTextPluginStateChange),this.on("data",r=>{if(r.dataType!=="source"||r.sourceDataType!=="metadata")return;const l=this.sourceCaches[r.sourceId];if(!l)return;const d=l.getSource();if(d&&d.vectorLayerIds)for(const _ in this._layers){const w=this._layers[_];w.source===d.id&&this._validateLayer(w)}})}loadURL(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const l=this.map._requestManager.transformRequest(s,Pt.Style);this._loadStyleRequest=new AbortController,a.h(l,this._loadStyleRequest).then(d=>{this._loadStyleRequest=null,this._load(d.data,i,r)}).catch(d=>{this._loadStyleRequest=null,d&&this.fire(new a.j(d))})}loadJSON(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ae.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(s,i,r)}).catch(()=>{})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(hr,{validate:!1})}_load(s,i,r){var l;const d=i.transformStyle?i.transformStyle(r,s):s;if(!i.validate||!Vt(this,a.x(d))){this._loaded=!0,this.stylesheet=d;for(const _ in d.sources)this.addSource(_,d.sources[_],{validate:!1});d.sprite?this._loadSprite(d.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(d.glyphs),this._createLayers(),this.light=new Si(this.stylesheet.light),this.map.setTerrain((l=this.stylesheet.terrain)!==null&&l!==void 0?l:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const s=a.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of s){const r=a.az(i);r.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=r}}_loadSprite(s,i=!1,r=void 0){let l;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(d,_,w,T){return a._(this,void 0,void 0,function*(){const B=gt(d),j=w>1?"@2x":"",Y={},ce={};for(const{id:Se,url:Te}of B){const Re=_.transformRequest(_.normalizeSpriteURL(Te,j,".json"),Pt.SpriteJSON);Y[Se]=a.h(Re,T);const Be=_.transformRequest(_.normalizeSpriteURL(Te,j,".png"),Pt.SpriteImage);ce[Se]=Tt.getImage(Be,T)}return yield Promise.all([...Object.values(Y),...Object.values(ce)]),function(Se,Te){return a._(this,void 0,void 0,function*(){const Re={};for(const Be in Se){Re[Be]={};const Je=ae.getImageCanvasContext((yield Te[Be]).data),xt=(yield Se[Be]).data;for(const at in xt){const{width:ct,height:Et,x:wt,y:ri,sdf:Yt,pixelRatio:ei,stretchX:si,stretchY:ji,content:Qi}=xt[at];Re[Be][at]={data:null,pixelRatio:ei,sdf:Yt,stretchX:si,stretchY:ji,content:Qi,spriteData:{width:ct,height:Et,x:wt,y:ri,context:Je}}}}return Re})}(Y,ce)})}(s,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(d=>{if(this._spriteRequest=null,d)for(const _ in d){this._spritesImagesIds[_]=[];const w=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter(T=>!(T in d)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in d[_]){const B=_==="default"?T:`${_}:${T}`;this._spritesImagesIds[_].push(B),B in this.imageManager.images?this.imageManager.updateImage(B,d[_][T],!1):this.imageManager.addImage(B,d[_][T]),i&&(this._changedImages[B]=!0)}}}).catch(d=>{this._spriteRequest=null,l=d,this.fire(new a.j(l))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),r&&r(l)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(s){const i=this.sourceCaches[s.source];if(!i)return;const r=s.sourceLayer;if(!r)return;const l=i.getSource();(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(r)===-1)&&this.fire(new a.j(new Error(`Source layer "${r}" does not exist on source "${l.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){const i=this._serializedAllLayers();if(!s||s.length===0)return Object.values(i);const r=[];for(const l of s)i[l]&&r.push(i[l]);return r}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const i=Object.keys(this._layers);for(const r of i){const l=this._layers[r];l.type!=="custom"&&(s[r]=l.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const i=this._changed;if(this._changed){const l=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(l.length||d.length)&&this._updateWorkerLayers(l,d);for(const _ in this._updatedSources){const w=this._updatedSources[_];if(w==="reload")this._reloadSource(_);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const r={};for(const l in this.sourceCaches){const d=this.sourceCaches[l];r[l]=d.used,d.used=!1}for(const l of this._order){const d=this._layers[l];d.recalculate(s,this._availableImages),!d.isHidden(s.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const l in r){const d=this.sourceCaches[l];r[l]!==d.used&&d.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:l}))}this.light.recalculate(s),this.z=s.zoom,i&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,i){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,i={}){var r;this._checkLoaded();const l=this.serialize();if(s=i.transformStyle?i.transformStyle(l,s):s,((r=i.validate)===null||r===void 0||r)&&Vt(this,a.x(s)))return!1;(s=a.aA(s)).layers=a.ay(s.layers);const d=a.aB(l,s),_=this._getOperationsToPerform(d);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const w of _.operations)w();return this.stylesheet=s,this._serializedLayers=null,!0}_getOperationsToPerform(s){const i=[],r=[];for(const l of s)switch(l.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,l.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,l.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,l.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,l.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,l.args));break;case"addSource":i.push(()=>this.addSource.apply(this,l.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,l.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,l.args));break;case"setLight":i.push(()=>this.setLight.apply(this,l.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,l.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,l.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,l.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,l.args));break;case"setTransition":i.push(()=>{});break;default:r.push(l.command)}return{operations:i,unimplemented:r}}addImage(s,i){if(this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,i),this._afterImageUpdated(s)}updateImage(s,i){this.imageManager.updateImage(s,i)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,i,r={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(a.x.source,`sources.${s}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const l=this.sourceCaches[s]=new Ie(s,i,this.dispatcher);l.style=this,l.setEventedParent(this,()=>({isSourceLoaded:l.loaded(),source:l.serialize(),sourceId:s})),l.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===s)return this.fire(new a.j(new Error(`Source "${s}" cannot be removed while layer "${r}" is using it.`)));const i=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],i.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,i){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const r=this.sourceCaches[s].getSource();if(r.type!=="geojson")throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(i),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,i,r={}){this._checkLoaded();const l=s.id;if(this.getLayer(l))return void this.fire(new a.j(new Error(`Layer "${l}" already exists on this map.`)));let d;if(s.type==="custom"){if(Vt(this,a.aC(s)))return;d=a.az(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(l,s.source),s=a.aA(s),s=a.e(s,{source:l})),this._validate(a.x.layer,`layers.${l}`,s,{arrayIndex:-1},r))return;d=a.az(s),this._validateLayer(d),d.setEventedParent(this,{layer:{id:l}})}const _=i?this._order.indexOf(i):this._order.length;if(i&&_===-1)this.fire(new a.j(new Error(`Cannot add layer "${l}" before non-existing layer "${i}".`)));else{if(this._order.splice(_,0,l),this._layerOrderChanged=!0,this._layers[l]=d,this._removedLayers[l]&&d.source&&d.type!=="custom"){const w=this._removedLayers[l];delete this._removedLayers[l],w.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(s,i){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.j(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===i)return;const r=this._order.indexOf(s);this._order.splice(r,1);const l=i?this._order.indexOf(i):this._order.length;i&&l===-1?this.fire(new a.j(new Error(`Cannot move layer "${s}" before non-existing layer "${i}".`))):(this._order.splice(l,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const i=this._layers[s];if(!i)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${s}".`)));i.setEventedParent(null);const r=this._order.indexOf(s);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=i,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],i.onRemove&&i.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,i,r){this._checkLoaded();const l=this.getLayer(s);l?l.minzoom===i&&l.maxzoom===r||(i!=null&&(l.minzoom=i),r!=null&&(l.maxzoom=r),this._updateLayer(l)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,i,r={}){this._checkLoaded();const l=this.getLayer(s);if(l){if(!a.aD(l.filter,i))return i==null?(l.filter=void 0,void this._updateLayer(l)):void(this._validate(a.x.filter,`layers.${l.id}.filter`,i,null,r)||(l.filter=a.aA(i),this._updateLayer(l)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return a.aA(this.getLayer(s).filter)}setLayoutProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getLayoutProperty(i),r)||(d.setLayoutProperty(i,r,l),this._updateLayer(d)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,i){const r=this.getLayer(s);if(r)return r.getLayoutProperty(i);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getPaintProperty(i),r)||(d.setPaintProperty(i,r,l)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,i){return this.getLayer(s).getPaintProperty(i)}setFeatureState(s,i){this._checkLoaded();const r=s.source,l=s.sourceLayer,d=this.sourceCaches[r];if(d===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const _=d.getSource().type;_==="geojson"&&l?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||l?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),d.setFeatureState(l,s.id,i)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,i){this._checkLoaded();const r=s.source,l=this.sourceCaches[r];if(l===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const d=l.getSource().type,_=d==="vector"?s.sourceLayer:void 0;d!=="vector"||_?i&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):l.removeFeatureState(_,s.id,i):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const i=s.source,r=s.sourceLayer,l=this.sourceCaches[i];if(l!==void 0)return l.getSource().type!=="vector"||r?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),l.getFeatureState(r,s.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const s=a.aE(this.sourceCaches,d=>d.serialize()),i=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,l=this.stylesheet;return a.aF({version:l.version,name:l.name,metadata:l.metadata,light:l.light,center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,sprite:l.sprite,glyphs:l.glyphs,transition:l.transition,sources:s,layers:i,terrain:r},d=>d!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const i=_=>this._layers[_].type==="fill-extrusion",r={},l=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w)){r[w]=_;for(const T of s){const B=T[w];if(B)for(const j of B)l.push(j)}}}l.sort((_,w)=>w.intersectionZ-_.intersectionZ);const d=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w))for(let T=l.length-1;T>=0;T--){const B=l[T].feature;if(r[B.layer.id]<_)break;d.push(B),l.pop()}else for(const T of s){const B=T[w];if(B)for(const j of B)d.push(j.feature)}}return d}queryRenderedFeatures(s,i,r){i&&i.filter&&this._validate(a.x.filter,"queryRenderedFeatures.filter",i.filter,null,i);const l={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const w of i.layers){const T=this._layers[w];if(!T)return this.fire(new a.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];l[T.source]=!0}}const d=[];i.availableImages=this._availableImages;const _=this._serializedAllLayers();for(const w in this.sourceCaches)i.layers&&!l[w]||d.push(ai(this.sourceCaches[w],this._layers,_,s,i,r));return this.placement&&d.push(function(w,T,B,j,Y,ce,Se){const Te={},Re=ce.queryRenderedSymbols(j),Be=[];for(const Je of Object.keys(Re).map(Number))Be.push(Se[Je]);Be.sort(Ki);for(const Je of Be){const xt=Je.featureIndex.lookupSymbolFeatures(Re[Je.bucketInstanceId],T,Je.bucketIndex,Je.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,w);for(const at in xt){const ct=Te[at]=Te[at]||[],Et=xt[at];Et.sort((wt,ri)=>{const Yt=Je.featureSortOrder;if(Yt){const ei=Yt.indexOf(wt.featureIndex);return Yt.indexOf(ri.featureIndex)-ei}return ri.featureIndex-wt.featureIndex});for(const wt of Et)ct.push(wt)}}for(const Je in Te)Te[Je].forEach(xt=>{const at=xt.feature,ct=B[w[Je].source].getFeatureState(at.layer["source-layer"],at.id);at.source=at.layer.source,at.layer["source-layer"]&&(at.sourceLayer=at.layer["source-layer"]),at.state=ct});return Te}(this._layers,_,this.sourceCaches,s,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(s,i){i&&i.filter&&this._validate(a.x.filter,"querySourceFeatures.filter",i.filter,null,i);const r=this.sourceCaches[s];return r?function(l,d){const _=l.getRenderableIds().map(B=>l.getTileByID(B)),w=[],T={};for(let B=0;B<_.length;B++){const j=_[B],Y=j.tileID.canonical.key;T[Y]||(T[Y]=!0,j.querySourceFeatures(w,d))}return w}(r,i):[]}getLight(){return this.light.getLight()}setLight(s,i={}){this._checkLoaded();const r=this.light.getLight();let l=!1;for(const _ in s)if(!a.aD(s[_],r[_])){l=!0;break}if(!l)return;const d={now:ae.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,i),this.light.updateTransitions(d)}_validate(s,i,r,l,d={}){return(!d||d.validate!==!1)&&Vt(this,s.call(a.x,a.e({key:i,style:this.serialize(),value:r,styleSpec:a.v},l)))}_remove(s=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),$().off("pluginStateChange",this._rtlTextPluginStateChange);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const r=this.sourceCaches[i];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),s&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const i in this.sourceCaches)this.sourceCaches[i].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,i,r,l,d=!1){let _=!1,w=!1;const T={};for(const B of this._order){const j=this._layers[B];if(j.type!=="symbol")continue;if(!T[j.source]){const ce=this.sourceCaches[j.source];T[j.source]=ce.getRenderableIds(!0).map(Se=>ce.getTileByID(Se)).sort((Se,Te)=>Te.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(Te.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(j,T[j.source],s.center.lng);_=_||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||r===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ae.now(),s.zoom))&&(this.pauseablePlacement=new Yi(s,this.map.terrain,this._order,d,i,r,l,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ae.now()),w=!0),_&&this.pauseablePlacement.placement.setStale()),w||_)for(const B of this._order){const j=this._layers[B];j.type==="symbol"&&this.placement.updateLayerOpacities(j,T[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ae.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,i.icons),r})}getGlyphs(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.glyphManager.getGlyphs(i.stacks),l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,[""]),r})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,i={}){this._checkLoaded(),s&&this._validate(a.x.glyphs,"glyphs",s,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,i,r={},l){this._checkLoaded();const d=[{id:s,url:i}],_=[...gt(this.stylesheet.sprite),...d];this._validate(a.x.sprite,"sprite",_,null,r)||(this.stylesheet.sprite=_,this._loadSprite(d,!0,l))}removeSprite(s){this._checkLoaded();const i=gt(this.stylesheet.sprite);if(i.find(r=>r.id===s)){if(this._spritesImagesIds[s])for(const r of this._spritesImagesIds[s])this.imageManager.removeImage(r),this._changedImages[r]=!0;i.splice(i.findIndex(r=>r.id===s),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return gt(this.stylesheet.sprite)}setSprite(s,i={},r){this._checkLoaded(),s&&this._validate(a.x.sprite,"sprite",s,null,i)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,r):(this._unloadSprite(),r&&r(null)))}}var Fr=a.X([{name:"a_pos",type:"Int16",components:2}]),Vs="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const ua={prelude:Pr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Pr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Pr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Pr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Pr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Pr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Pr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Pr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Pr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Pr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Pr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Pr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Pr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Pr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Pr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Pr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Pr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Pr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Pr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Pr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Pr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Pr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Pr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Pr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Pr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Vs),terrainDepth:Pr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Vs),terrainCoords:Pr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Vs)};function Pr(y,s){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=s.match(/attribute ([\w]+) ([\w]+)/g),l=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=d?d.concat(l):l,w={};return{fragmentSource:y=y.replace(i,(T,B,j,Y,ce)=>(w[ce]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
varying ${j} ${Y} ${ce};
#else
uniform ${j} ${Y} u_${ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ce}
    ${j} ${Y} ${ce} = u_${ce};
#endif
`)),vertexSource:s=s.replace(i,(T,B,j,Y,ce)=>{const Se=Y==="float"?"vec2":"vec4",Te=ce.match(/color/)?"color":Se;return w[ce]?B==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${j} ${Se} a_${ce};
varying ${j} ${Y} ${ce};
#else
uniform ${j} ${Y} u_${ce};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = a_${ce};
#else
    ${j} ${Y} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = unpack_mix_${Te}(a_${ce}, u_${ce}_t);
#else
    ${j} ${Y} ${ce} = u_${ce};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${j} ${Se} a_${ce};
#else
uniform ${j} ${Y} u_${ce};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${j} ${Y} ${ce} = a_${ce};
#else
    ${j} ${Y} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${j} ${Y} ${ce} = unpack_mix_${Te}(a_${ce}, u_${ce}_t);
#else
    ${j} ${Y} ${ce} = u_${ce};
#endif
`}),staticAttributes:r,staticUniforms:_}}class Fa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,i,r,l,d,_,w,T,B){this.context=s;let j=this.boundPaintVertexBuffers.length!==l.length;for(let Y=0;!j&&Y<l.length;Y++)this.boundPaintVertexBuffers[Y]!==l[Y]&&(j=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==r||j||this.boundIndexBuffer!==d||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==B?this.freshBind(i,r,l,d,_,w,T,B):(s.bindVertexArray.set(this.vao),w&&w.bind(),d&&d.dynamicDraw&&d.bind(),T&&T.bind(),B&&B.bind())}freshBind(s,i,r,l,d,_,w,T){const B=s.numAttributes,j=this.context,Y=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=l,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,i.enableAttributes(Y,s);for(const ce of r)ce.enableAttributes(Y,s);_&&_.enableAttributes(Y,s),w&&w.enableAttributes(Y,s),T&&T.enableAttributes(Y,s),i.bind(),i.setVertexAttribPointers(Y,s,d);for(const ce of r)ce.bind(),ce.setVertexAttribPointers(Y,s,d);_&&(_.bind(),_.setVertexAttribPointers(Y,s,d)),l&&l.bind(),w&&(w.bind(),w.setVertexAttribPointers(Y,s,d)),T&&(T.bind(),T.setVertexAttribPointers(Y,s,d)),j.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function zo(y){const s=[];for(let i=0;i<y.length;i++){if(y[i]===null)continue;const r=y[i].split(" ");s.push(r.pop())}return s}class Oa{constructor(s,i,r,l,d,_){const w=s.gl;this.program=w.createProgram();const T=zo(i.staticAttributes),B=r?r.getBinderAttributes():[],j=T.concat(B),Y=ua.prelude.staticUniforms?zo(ua.prelude.staticUniforms):[],ce=i.staticUniforms?zo(i.staticUniforms):[],Se=r?r.getBinderUniforms():[],Te=Y.concat(ce).concat(Se),Re=[];for(const wt of Te)Re.indexOf(wt)<0&&Re.push(wt);const Be=r?r.defines():[];d&&Be.push("#define OVERDRAW_INSPECTOR;"),_&&Be.push("#define TERRAIN3D;");const Je=Be.concat(ua.prelude.fragmentSource,i.fragmentSource).join(`
`),xt=Be.concat(ua.prelude.vertexSource,i.vertexSource).join(`
`),at=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(at,Je),w.compileShader(at),!w.getShaderParameter(at,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(at)}`);w.attachShader(this.program,at);const ct=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ct,xt),w.compileShader(ct),!w.getShaderParameter(ct,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(ct)}`);w.attachShader(this.program,ct),this.attributes={};const Et={};this.numAttributes=j.length;for(let wt=0;wt<this.numAttributes;wt++)j[wt]&&(w.bindAttribLocation(this.program,wt,j[wt]),this.attributes[j[wt]]=wt);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(ct),w.deleteShader(at);for(let wt=0;wt<Re.length;wt++){const ri=Re[wt];if(ri&&!Et[ri]){const Yt=w.getUniformLocation(this.program,ri);Yt&&(Et[ri]=Yt)}}this.fixedUniforms=l(s,Et),this.terrainUniforms=((wt,ri)=>({u_depth:new a.aG(wt,ri.u_depth),u_terrain:new a.aG(wt,ri.u_terrain),u_terrain_dim:new a.aH(wt,ri.u_terrain_dim),u_terrain_matrix:new a.aI(wt,ri.u_terrain_matrix),u_terrain_unpack:new a.aJ(wt,ri.u_terrain_unpack),u_terrain_exaggeration:new a.aH(wt,ri.u_terrain_exaggeration)}))(s,Et),this.binderUniforms=r?r.getUniforms(s,Et):[]}draw(s,i,r,l,d,_,w,T,B,j,Y,ce,Se,Te,Re,Be,Je,xt){const at=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(r),s.setStencilMode(l),s.setColorMode(d),s.setCullFace(_),T){s.activeTexture.set(at.TEXTURE2),at.bindTexture(at.TEXTURE_2D,T.depthTexture),s.activeTexture.set(at.TEXTURE3),at.bindTexture(at.TEXTURE_2D,T.texture);for(const Et in this.terrainUniforms)this.terrainUniforms[Et].set(T[Et])}for(const Et in this.fixedUniforms)this.fixedUniforms[Et].set(w[Et]);Re&&Re.setUniforms(s,this.binderUniforms,Se,{zoom:Te});let ct=0;switch(i){case at.LINES:ct=2;break;case at.TRIANGLES:ct=3;break;case at.LINE_STRIP:ct=1}for(const Et of ce.get()){const wt=Et.vaos||(Et.vaos={});(wt[B]||(wt[B]=new Fa)).bind(s,this,j,Re?Re.getPaintVertexBuffers():[],Y,Et.vertexOffset,Be,Je,xt),at.drawElements(i,Et.primitiveLength*ct,at.UNSIGNED_SHORT,Et.primitiveOffset*ct*2)}}}function Ys(y,s,i){const r=1/kt(i,1,s.transform.tileZoom),l=Math.pow(2,i.tileID.overscaledZ),d=i.tileSize*Math.pow(2,s.transform.tileZoom)/l,_=d*(i.tileID.canonical.x+i.tileID.wrap*l),w=d*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[_>>16,w>>16],u_pixel_coord_lower:[65535&_,65535&w]}}const Zn=(y,s,i,r)=>{const l=s.style.light,d=l.properties.get("position"),_=[d.x,d.y,d.z],w=function(){var B=new a.A(9);return a.A!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B}();l.properties.get("anchor")==="viewport"&&function(B,j){var Y=Math.sin(j),ce=Math.cos(j);B[0]=ce,B[1]=Y,B[2]=0,B[3]=-Y,B[4]=ce,B[5]=0,B[6]=0,B[7]=0,B[8]=1}(w,-s.transform.angle),function(B,j,Y){var ce=j[0],Se=j[1],Te=j[2];B[0]=ce*Y[0]+Se*Y[3]+Te*Y[6],B[1]=ce*Y[1]+Se*Y[4]+Te*Y[7],B[2]=ce*Y[2]+Se*Y[5]+Te*Y[8]}(_,_,w);const T=l.properties.get("color");return{u_matrix:y,u_lightpos:_,u_lightintensity:l.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+i,u_opacity:r}},aa=(y,s,i,r,l,d,_)=>a.e(Zn(y,s,i,r),Ys(d,s,_),{u_height_factor:-Math.pow(2,l.overscaledZ)/_.tileSize/8}),ls=y=>({u_matrix:y}),Na=(y,s,i,r)=>a.e(ls(y),Ys(i,s,r)),al=(y,s)=>({u_matrix:y,u_world:s}),ol=(y,s,i,r,l)=>a.e(Na(y,s,i,r),{u_world:l}),to=(y,s,i,r)=>{const l=y.transform;let d,_;if(r.paint.get("circle-pitch-alignment")==="map"){const w=kt(i,1,l.zoom);d=!0,_=[w,w]}else d=!1,_=l.pixelsToGLUnits;return{u_camera_to_center_distance:l.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(s.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:_}},Va=(y,s,i)=>{const r=kt(i,1,s.zoom),l=Math.pow(2,s.zoom-i.tileID.overscaledZ),d=i.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[s.pixelsToGLUnits[0]/(r*l),s.pixelsToGLUnits[1]/(r*l)],u_overscale_factor:d}},N=(y,s,i=1)=>({u_matrix:y,u_color:s,u_overlay:0,u_overlay_scale:i}),xe=y=>({u_matrix:y}),it=(y,s,i,r)=>({u_matrix:y,u_extrude_scale:kt(s,1,i),u_intensity:r});function It(y,s){const i=Math.pow(2,s.canonical.z),r=s.canonical.y;return[new a.Y(0,r/i).toLngLat().lat,new a.Y(0,(r+1)/i).toLngLat().lat]}const Wt=(y,s,i,r)=>{const l=y.transform;return{u_matrix:sr(y,s,i,r),u_ratio:1/kt(s,1,l.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},Ii=(y,s,i,r,l)=>a.e(Wt(y,s,i,l),{u_image:0,u_image_height:r}),Li=(y,s,i,r,l)=>{const d=y.transform,_=fn(s,d);return{u_matrix:sr(y,s,i,l),u_texsize:s.imageAtlasTexture.size,u_ratio:1/kt(s,1,d.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[_,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},cn=(y,s,i,r,l,d)=>{const _=y.lineAtlas,w=fn(s,y.transform),T=i.layout.get("line-cap")==="round",B=_.getDash(r.from,T),j=_.getDash(r.to,T),Y=B.width*l.fromScale,ce=j.width*l.toScale;return a.e(Wt(y,s,i,d),{u_patternscale_a:[w/Y,-B.height/2],u_patternscale_b:[w/ce,-j.height/2],u_sdfgamma:_.width/(256*Math.min(Y,ce)*y.pixelRatio)/2,u_image:0,u_tex_y_a:B.y,u_tex_y_b:j.y,u_mix:l.t})};function fn(y,s){return 1/kt(y,1,s.tileZoom)}function sr(y,s,i,r){return y.translatePosMatrix(r?r.posMatrix:s.tileID.posMatrix,s,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Ar=(y,s,i,r,l)=>{return{u_matrix:y,u_tl_parent:s,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(d=l.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:Or(l.paint.get("raster-hue-rotate"))};var d,_};function Or(y){y*=Math.PI/180;const s=Math.sin(y),i=Math.cos(y);return[(2*i+1)/3,(-Math.sqrt(3)*s-i+1)/3,(Math.sqrt(3)*s-i+1)/3]}const Ua=(y,s,i,r,l,d,_,w,T,B)=>{const j=l.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:j.width/j.height,u_fade_change:l.options.fadeDuration?l.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:_,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+r,u_texsize:B,u_texture:0}},Ga=(y,s,i,r,l,d,_,w,T,B,j)=>{const Y=l.transform;return a.e(Ua(y,s,i,r,l,d,_,w,T,B),{u_gamma_scale:r?Math.cos(Y._pitch)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:l.pixelRatio,u_is_halo:+j})},qa=(y,s,i,r,l,d,_,w,T,B)=>a.e(Ga(y,s,i,r,l,d,_,w,!0,T,!0),{u_texsize_icon:B,u_texture_icon:1}),pl=(y,s,i)=>({u_matrix:y,u_opacity:s,u_color:i}),Gr=(y,s,i,r,l,d)=>a.e(function(_,w,T,B){const j=T.imageManager.getPattern(_.from.toString()),Y=T.imageManager.getPattern(_.to.toString()),{width:ce,height:Se}=T.imageManager.getPixelSize(),Te=Math.pow(2,B.tileID.overscaledZ),Re=B.tileSize*Math.pow(2,T.transform.tileZoom)/Te,Be=Re*(B.tileID.canonical.x+B.tileID.wrap*Te),Je=Re*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:Y.tl,u_pattern_br_b:Y.br,u_texsize:[ce,Se],u_mix:w.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:Y.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/kt(B,1,T.transform.tileZoom),u_pixel_coord_upper:[Be>>16,Je>>16],u_pixel_coord_lower:[65535&Be,65535&Je]}}(r,d,i,l),{u_matrix:y,u_opacity:s}),nr={fillExtrusion:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_opacity:new a.aH(y,s.u_opacity)}),fillExtrusionPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_height_factor:new a.aH(y,s.u_height_factor),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade),u_opacity:new a.aH(y,s.u_opacity)}),fill:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),fillPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),fillOutline:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world)}),fillOutlinePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),circle:(y,s)=>({u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_scale_with_map:new a.aG(y,s.u_scale_with_map),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_matrix:new a.aI(y,s.u_matrix)}),collisionBox:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aH(y,s.u_pixels_to_tile_units),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_overscale_factor:new a.aH(y,s.u_overscale_factor)}),collisionCircle:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_inv_matrix:new a.aI(y,s.u_inv_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_viewport_size:new a.aL(y,s.u_viewport_size)}),debug:(y,s)=>({u_color:new a.aM(y,s.u_color),u_matrix:new a.aI(y,s.u_matrix),u_overlay:new a.aG(y,s.u_overlay),u_overlay_scale:new a.aH(y,s.u_overlay_scale)}),clippingMask:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),heatmap:(y,s)=>({u_extrude_scale:new a.aH(y,s.u_extrude_scale),u_intensity:new a.aH(y,s.u_intensity),u_matrix:new a.aI(y,s.u_matrix)}),heatmapTexture:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_color_ramp:new a.aG(y,s.u_color_ramp),u_opacity:new a.aH(y,s.u_opacity)}),hillshade:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_latrange:new a.aL(y,s.u_latrange),u_light:new a.aL(y,s.u_light),u_shadow:new a.aM(y,s.u_shadow),u_highlight:new a.aM(y,s.u_highlight),u_accent:new a.aM(y,s.u_accent)}),hillshadePrepare:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_dimension:new a.aL(y,s.u_dimension),u_zoom:new a.aH(y,s.u_zoom),u_unpack:new a.aJ(y,s.u_unpack)}),line:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels)}),lineGradient:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_image:new a.aG(y,s.u_image),u_image_height:new a.aH(y,s.u_image_height)}),linePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texsize:new a.aL(y,s.u_texsize),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_image:new a.aG(y,s.u_image),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),lineSDF:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_patternscale_a:new a.aL(y,s.u_patternscale_a),u_patternscale_b:new a.aL(y,s.u_patternscale_b),u_sdfgamma:new a.aH(y,s.u_sdfgamma),u_image:new a.aG(y,s.u_image),u_tex_y_a:new a.aH(y,s.u_tex_y_a),u_tex_y_b:new a.aH(y,s.u_tex_y_b),u_mix:new a.aH(y,s.u_mix)}),raster:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_tl_parent:new a.aL(y,s.u_tl_parent),u_scale_parent:new a.aH(y,s.u_scale_parent),u_buffer_scale:new a.aH(y,s.u_buffer_scale),u_fade_t:new a.aH(y,s.u_fade_t),u_opacity:new a.aH(y,s.u_opacity),u_image0:new a.aG(y,s.u_image0),u_image1:new a.aG(y,s.u_image1),u_brightness_low:new a.aH(y,s.u_brightness_low),u_brightness_high:new a.aH(y,s.u_brightness_high),u_saturation_factor:new a.aH(y,s.u_saturation_factor),u_contrast_factor:new a.aH(y,s.u_contrast_factor),u_spin_weights:new a.aK(y,s.u_spin_weights)}),symbolIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture)}),symbolSDF:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),symbolTextAndIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texsize_icon:new a.aL(y,s.u_texsize_icon),u_texture:new a.aG(y,s.u_texture),u_texture_icon:new a.aG(y,s.u_texture_icon),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),background:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_color:new a.aM(y,s.u_color)}),backgroundPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_image:new a.aG(y,s.u_image),u_pattern_tl_a:new a.aL(y,s.u_pattern_tl_a),u_pattern_br_a:new a.aL(y,s.u_pattern_br_a),u_pattern_tl_b:new a.aL(y,s.u_pattern_tl_b),u_pattern_br_b:new a.aL(y,s.u_pattern_br_b),u_texsize:new a.aL(y,s.u_texsize),u_mix:new a.aH(y,s.u_mix),u_pattern_size_a:new a.aL(y,s.u_pattern_size_a),u_pattern_size_b:new a.aL(y,s.u_pattern_size_b),u_scale_a:new a.aH(y,s.u_scale_a),u_scale_b:new a.aH(y,s.u_scale_b),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aH(y,s.u_tile_units_to_pixels)}),terrain:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainDepth:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainCoords:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_terrain_coords_id:new a.aH(y,s.u_terrain_coords_id),u_ele_delta:new a.aH(y,s.u_ele_delta)})};class wr{constructor(s,i,r){this.context=s;const l=s.gl;this.buffer=l.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Dr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class js{constructor(s,i,r,l){this.length=i.length,this.attributes=r,this.itemSize=i.bytesPerElement,this.dynamicDraw=l,this.context=s;const d=s.gl;this.buffer=d.createBuffer(),s.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,i){for(let r=0;r<this.attributes.length;r++){const l=i.attributes[this.attributes[r].name];l!==void 0&&s.enableVertexAttribArray(l)}}setVertexAttribPointers(s,i,r){for(let l=0;l<this.attributes.length;l++){const d=this.attributes[l],_=i.attributes[d.name];_!==void 0&&s.vertexAttribPointer(_,d.components,s[Dr[d.type]],!1,this.itemSize,d.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vr=new WeakMap;function Ks(y){var s;if(vr.has(y))return vr.get(y);{const i=(s=y.getParameter(y.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return vr.set(y,i),i}}class Lr{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class So extends Lr{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Zo extends Lr{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Ls extends Lr{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Il extends Lr{getDefault(){return[!0,!0,!0,!0]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ao extends Lr{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Qo extends Lr{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class ca extends Lr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const i=this.current;(s.func!==i.func||s.ref!==i.ref||s.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class $s extends Lr{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class El extends Lr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=s,this.dirty=!1}}class Ha extends Lr{getDefault(){return[0,1]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Ta extends Lr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=s,this.dirty=!1}}class ml extends Lr{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Cl extends Lr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.BLEND):i.disable(i.BLEND),this.current=s,this.dirty=!1}}class mu extends Lr{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class us extends Lr{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class rc extends Lr{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class io extends Lr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=s,this.dirty=!1}}class no extends Lr{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class ql extends Lr{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class Ro extends Lr{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Wo extends Lr{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Io extends Lr{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Us extends Lr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Xo extends Lr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Yo extends Lr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class $o extends Lr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class ba extends Lr{getDefault(){return null}set(s){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class ja extends Lr{getDefault(){return null}set(s){var i;if(s===this.current&&!this.dirty)return;const r=this.gl;Ks(r)?r.bindVertexArray(s):(i=r.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class Cs extends Lr{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class gu extends Lr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Sr extends Lr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Xn extends Lr{constructor(s,i){super(s),this.context=s,this.parent=i}getDefault(){return null}}class Ko extends Xn{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Br extends Xn{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Za extends Xn{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Jr{constructor(s,i,r,l,d){this.context=s,this.width=i,this.height=r;const _=s.gl,w=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new Ko(s,w),l)this.depthAttachment=d?new Za(s,w):new Br(s,w);else if(d)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,i=this.colorAttachment.get();if(i&&s.deleteTexture(i),this.depthAttachment){const r=this.depthAttachment.get();r&&s.deleteRenderbuffer(r)}s.deleteFramebuffer(this.framebuffer)}}class fr{constructor(s,i,r){this.blendFunction=s,this.blendColor=i,this.mask=r}}fr.Replace=[1,0],fr.disabled=new fr(fr.Replace,a.aO.transparent,[!1,!1,!1,!1]),fr.unblended=new fr(fr.Replace,a.aO.transparent,[!0,!0,!0,!0]),fr.alphaBlended=new fr([1,771],a.aO.transparent,[!0,!0,!0,!0]);class Eo{constructor(s){var i,r;if(this.gl=s,this.clearColor=new So(this),this.clearDepth=new Zo(this),this.clearStencil=new Ls(this),this.colorMask=new Il(this),this.depthMask=new Ao(this),this.stencilMask=new Qo(this),this.stencilFunc=new ca(this),this.stencilOp=new $s(this),this.stencilTest=new El(this),this.depthRange=new Ha(this),this.depthTest=new Ta(this),this.depthFunc=new ml(this),this.blend=new Cl(this),this.blendFunc=new mu(this),this.blendColor=new us(this),this.blendEquation=new rc(this),this.cullFace=new io(this),this.cullFaceSide=new no(this),this.frontFace=new ql(this),this.program=new Ro(this),this.activeTexture=new Wo(this),this.viewport=new Io(this),this.bindFramebuffer=new Us(this),this.bindRenderbuffer=new Xo(this),this.bindTexture=new Yo(this),this.bindVertexBuffer=new $o(this),this.bindElementBuffer=new ba(this),this.bindVertexArray=new ja(this),this.pixelStoreUnpack=new Cs(this),this.pixelStoreUnpackPremultiplyAlpha=new gu(this),this.pixelStoreUnpackFlipY=new Sr(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),Ks(s)){this.HALF_FLOAT=s.HALF_FLOAT;const l=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=s.RGBA16F)!==null&&i!==void 0?i:l==null?void 0:l.RGBA16F_EXT,this.RGB16F=(r=s.RGB16F)!==null&&r!==void 0?r:l==null?void 0:l.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const l=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=l==null?void 0:l.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,i){return new wr(this,s,i)}createVertexBuffer(s,i,r){return new js(this,s,i,r)}createRenderbuffer(s,i,r){const l=this.gl,d=l.createRenderbuffer();return this.bindRenderbuffer.set(d),l.renderbufferStorage(l.RENDERBUFFER,s,i,r),this.bindRenderbuffer.set(null),d}createFramebuffer(s,i,r,l){return new Jr(this,s,i,r,l)}clear({color:s,depth:i,stencil:r}){const l=this.gl;let d=0;s&&(d|=l.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(d|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),r!==void 0&&(d|=l.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),l.clear(d)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){a.aD(s.blendFunction,fr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return Ks(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var i;return Ks(this.gl)?this.gl.deleteVertexArray(s):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class Un{constructor(s,i,r){this.func=s,this.mask=i,this.range=r}}Un.ReadOnly=!1,Un.ReadWrite=!0,Un.disabled=new Un(519,Un.ReadOnly,[0,1]);const Ol=7680;class es{constructor(s,i,r,l,d,_){this.test=s,this.ref=i,this.mask=r,this.fail=l,this.depthFail=d,this.pass=_}}es.disabled=new es({func:519,mask:0},0,0,Ol,Ol,Ol);class Zr{constructor(s,i,r){this.enable=s,this.mode=i,this.frontFace=r}}let Ts;function kr(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=y.useProgram("collisionBox"),j=[];let Y=0,ce=0;for(let at=0;at<r.length;at++){const ct=r[at],Et=s.getTile(ct),wt=Et.getBucket(i);if(!wt)continue;let ri=ct.posMatrix;l[0]===0&&l[1]===0||(ri=y.translatePosMatrix(ct.posMatrix,Et,l,d));const Yt=_?wt.textCollisionBox:wt.iconCollisionBox,ei=wt.collisionCircleArray;if(ei.length>0){const si=a.F(),ji=ri;a.aP(si,wt.placementInvProjMatrix,y.transform.glCoordMatrix),a.aP(si,si,wt.placementViewportMatrix),j.push({circleArray:ei,circleOffset:ce,transform:ji,invTransform:si,coord:ct}),Y+=ei.length/4,ce=Y}Yt&&B.draw(w,T.LINES,Un.disabled,es.disabled,y.colorModeForRenderPass(),Zr.disabled,Va(ri,y.transform,Et),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ct),i.id,Yt.layoutVertexBuffer,Yt.indexBuffer,Yt.segments,null,y.transform.zoom,null,null,Yt.collisionVertexBuffer)}if(!_||!j.length)return;const Se=y.useProgram("collisionCircle"),Te=new a.aQ;Te.resize(4*Y),Te._trim();let Re=0;for(const at of j)for(let ct=0;ct<at.circleArray.length/4;ct++){const Et=4*ct,wt=at.circleArray[Et+0],ri=at.circleArray[Et+1],Yt=at.circleArray[Et+2],ei=at.circleArray[Et+3];Te.emplace(Re++,wt,ri,Yt,ei,0),Te.emplace(Re++,wt,ri,Yt,ei,1),Te.emplace(Re++,wt,ri,Yt,ei,2),Te.emplace(Re++,wt,ri,Yt,ei,3)}(!Ts||Ts.length<2*Y)&&(Ts=function(at){const ct=2*at,Et=new a.aS;Et.resize(ct),Et._trim();for(let wt=0;wt<ct;wt++){const ri=6*wt;Et.uint16[ri+0]=4*wt+0,Et.uint16[ri+1]=4*wt+1,Et.uint16[ri+2]=4*wt+2,Et.uint16[ri+3]=4*wt+2,Et.uint16[ri+4]=4*wt+3,Et.uint16[ri+5]=4*wt+0}return Et}(Y));const Be=w.createIndexBuffer(Ts,!0),Je=w.createVertexBuffer(Te,a.aR.members,!0);for(const at of j){const ct={u_matrix:at.transform,u_inv_matrix:at.invTransform,u_camera_to_center_distance:(xt=y.transform).cameraToCenterDistance,u_viewport_size:[xt.width,xt.height]};Se.draw(w,T.TRIANGLES,Un.disabled,es.disabled,y.colorModeForRenderPass(),Zr.disabled,ct,y.style.map.terrain&&y.style.map.terrain.getTerrainData(at.coord),i.id,Je,Be,a.$.simpleSegment(0,2*at.circleOffset,at.circleArray.length,at.circleArray.length/2),null,y.transform.zoom,null,null,null)}var xt;Je.destroy(),Be.destroy()}Zr.disabled=new Zr(!1,1029,2305),Zr.backCCW=new Zr(!0,1029,2305);const rr=a.an(new Float32Array(16));function ll(y,s,i,r,l,d){const{horizontalAlign:_,verticalAlign:w}=a.at(y);return new a.P((-(_-.5)*s/l+r[0])*d,(-(w-.5)*i/l+r[1])*d)}function Yr(y,s,i,r,l,d,_,w,T,B,j){const Y=y.text.placedSymbolArray,ce=y.text.dynamicLayoutVertexArray,Se=y.icon.dynamicLayoutVertexArray,Te={};ce.clear();for(let Re=0;Re<Y.length;Re++){const Be=Y.get(Re),Je=Be.hidden||!Be.crossTileID||y.allowVerticalPlacement&&!Be.placedOrientation?null:r[Be.crossTileID];if(Je){const xt=new a.P(Be.anchorX,Be.anchorY),at=nt(xt,i?_:d,j),ct=Me(l.cameraToCenterDistance,at.signedDistanceFromCamera);let Et=a.ai(y.textSizeData,T,Be)*ct/a.ao;i&&(Et*=y.tilePixelRatio/w);const{width:wt,height:ri,anchor:Yt,textOffset:ei,textBoxScale:si}=Je,ji=ll(Yt,wt,ri,ei,si,Et),Qi=i?nt(xt.add(ji),d,j).point:at.point.add(s?ji.rotate(-l.angle):ji),Ei=y.allowVerticalPlacement&&Be.placedOrientation===a.ah.vertical?Math.PI/2:0;for(let Ui=0;Ui<Be.numGlyphs;Ui++)a.aj(ce,Qi,Ei);B&&Be.associatedIconIndex>=0&&(Te[Be.associatedIconIndex]={shiftedAnchor:Qi,angle:Ei})}else Ye(Be.numGlyphs,ce)}if(B){Se.clear();const Re=y.icon.placedSymbolArray;for(let Be=0;Be<Re.length;Be++){const Je=Re.get(Be);if(Je.hidden)Ye(Je.numGlyphs,Se);else{const xt=Te[Be];if(xt)for(let at=0;at<Je.numGlyphs;at++)a.aj(Se,xt.shiftedAnchor,xt.angle);else Ye(Je.numGlyphs,Se)}}y.icon.dynamicLayoutVertexBuffer.updateData(Se)}y.text.dynamicLayoutVertexBuffer.updateData(ce)}function Co(y,s,i){return i.iconsInText&&s?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function ul(y,s,i,r,l,d,_,w,T,B,j,Y){const ce=y.context,Se=ce.gl,Te=y.transform,Re=w==="map",Be=T==="map",Je=w!=="viewport"&&i.layout.get("symbol-placement")!=="point",xt=Re&&!Be&&!Je,at=!i.layout.get("symbol-sort-key").isConstant();let ct=!1;const Et=y.depthModeForSublayer(0,Un.ReadOnly),wt=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ri=[];for(const Yt of r){const ei=s.getTile(Yt),si=ei.getBucket(i);if(!si)continue;const ji=l?si.text:si.icon;if(!ji||!ji.segments.get().length||!ji.hasVisibleVertices)continue;const Qi=ji.programConfigurations.get(i.id),Ei=l||si.sdfIcons,Ui=l?si.textSizeData:si.iconSizeData,Gi=Be||Te.pitch!==0,ln=y.useProgram(Co(Ei,l,si),Qi),Bn=a.ag(Ui,Te.zoom),rn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Yt);let kn,yr,er,Ia,Aa=[0,0],Bs=null;if(l)yr=ei.glyphAtlasTexture,er=Se.LINEAR,kn=ei.glyphAtlasTexture.size,si.iconsInText&&(Aa=ei.imageAtlasTexture.size,Bs=ei.imageAtlasTexture,Ia=Gi||y.options.rotating||y.options.zooming||Ui.kind==="composite"||Ui.kind==="camera"?Se.LINEAR:Se.NEAREST);else{const Qs=i.layout.get("icon-size").constantOr(0)!==1||si.iconsNeedLinear;yr=ei.imageAtlasTexture,er=Ei||y.options.rotating||y.options.zooming||Qs||Gi?Se.LINEAR:Se.NEAREST,kn=ei.imageAtlasTexture.size}const so=kt(ei,1,y.transform.zoom),ao=Ve(Yt.posMatrix,Be,Re,y.transform,so),qr=ft(Yt.posMatrix,Be,Re,y.transform,so),ya=wt&&si.hasTextData(),_o=i.layout.get("icon-text-fit")!=="none"&&ya&&si.hasIconData();if(Je){const Qs=y.style.map.terrain?(No,Vo)=>y.style.map.terrain.getElevation(Yt,No,Vo):null,Mo=i.layout.get("text-rotation-alignment")==="map";ne(si,Yt.posMatrix,y,l,ao,qr,Be,B,Mo,Qs)}const yo=y.translatePosMatrix(Yt.posMatrix,ei,d,_),Zs=Je||l&&wt||_o?rr:ao,ts=y.translatePosMatrix(qr,ei,d,_,!0),is=Ei&&i.paint.get(l?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let zr;zr=Ei?si.iconsInText?qa(Ui.kind,Bn,xt,Be,y,yo,Zs,ts,kn,Aa):Ga(Ui.kind,Bn,xt,Be,y,yo,Zs,ts,l,kn,!0):Ua(Ui.kind,Bn,xt,Be,y,yo,Zs,ts,l,kn);const bs={program:ln,buffers:ji,uniformValues:zr,atlasTexture:yr,atlasTextureIcon:Bs,atlasInterpolation:er,atlasInterpolationIcon:Ia,isSDF:Ei,hasHalo:is};if(at&&si.canOverlap){ct=!0;const Qs=ji.segments.get();for(const Mo of Qs)ri.push({segments:new a.$([Mo]),sortKey:Mo.sortKey,state:bs,terrainData:rn})}else ri.push({segments:ji.segments,sortKey:0,state:bs,terrainData:rn})}ct&&ri.sort((Yt,ei)=>Yt.sortKey-ei.sortKey);for(const Yt of ri){const ei=Yt.state;if(ce.activeTexture.set(Se.TEXTURE0),ei.atlasTexture.bind(ei.atlasInterpolation,Se.CLAMP_TO_EDGE),ei.atlasTextureIcon&&(ce.activeTexture.set(Se.TEXTURE1),ei.atlasTextureIcon&&ei.atlasTextureIcon.bind(ei.atlasInterpolationIcon,Se.CLAMP_TO_EDGE)),ei.isSDF){const si=ei.uniformValues;ei.hasHalo&&(si.u_is_halo=1,Qr(ei.buffers,Yt.segments,i,y,ei.program,Et,j,Y,si,Yt.terrainData)),si.u_is_halo=0}Qr(ei.buffers,Yt.segments,i,y,ei.program,Et,j,Y,ei.uniformValues,Yt.terrainData)}}function Qr(y,s,i,r,l,d,_,w,T,B){const j=r.context;l.draw(j,j.gl.TRIANGLES,d,_,w,Zr.disabled,T,B,i.id,y.layoutVertexBuffer,y.indexBuffer,s,i.paint,r.transform.zoom,y.programConfigurations.get(i.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function hs(y,s,i,r,l){if(!i||!r||!r.imageAtlas)return;const d=r.imageAtlas.patternPositions;let _=d[i.to.toString()],w=d[i.from.toString()];if(!_&&w&&(_=w),!w&&_&&(w=_),!_||!w){const T=l.getPaintProperty(s);_=d[T],w=d[T]}_&&w&&y.setConstantPatternPositions(_,w)}function wa(y,s,i,r,l,d,_){const w=y.context.gl,T="fill-pattern",B=i.paint.get(T),j=B&&B.constantOr(1),Y=i.getCrossfadeParameters();let ce,Se,Te,Re,Be;_?(Se=j&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ce=w.LINES):(Se=j?"fillPattern":"fill",ce=w.TRIANGLES);const Je=B.constantOr(null);for(const xt of r){const at=s.getTile(xt);if(j&&!at.patternsLoaded())continue;const ct=at.getBucket(i);if(!ct)continue;const Et=ct.programConfigurations.get(i.id),wt=y.useProgram(Se,Et),ri=y.style.map.terrain&&y.style.map.terrain.getTerrainData(xt);j&&(y.context.activeTexture.set(w.TEXTURE0),at.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),Et.updatePaintBuffers(Y)),hs(Et,T,Je,at,i);const Yt=ri?xt:null,ei=y.translatePosMatrix(Yt?Yt.posMatrix:xt.posMatrix,at,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(_){Re=ct.indexBuffer2,Be=ct.segments2;const si=[w.drawingBufferWidth,w.drawingBufferHeight];Te=Se==="fillOutlinePattern"&&j?ol(ei,y,Y,at,si):al(ei,si)}else Re=ct.indexBuffer,Be=ct.segments,Te=j?Na(ei,y,Y,at):ls(ei);wt.draw(y.context,ce,l,y.stencilModeForClipping(xt),d,Zr.disabled,Te,ri,i.id,ct.layoutVertexBuffer,Re,Be,i.paint,y.transform.zoom,Et)}}function Tl(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B="fill-extrusion-pattern",j=i.paint.get(B),Y=j.constantOr(1),ce=i.getCrossfadeParameters(),Se=i.paint.get("fill-extrusion-opacity"),Te=j.constantOr(null);for(const Re of r){const Be=s.getTile(Re),Je=Be.getBucket(i);if(!Je)continue;const xt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),at=Je.programConfigurations.get(i.id),ct=y.useProgram(Y?"fillExtrusionPattern":"fillExtrusion",at);Y&&(y.context.activeTexture.set(T.TEXTURE0),Be.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),at.updatePaintBuffers(ce)),hs(at,B,Te,Be,i);const Et=y.translatePosMatrix(Re.posMatrix,Be,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),wt=i.paint.get("fill-extrusion-vertical-gradient"),ri=Y?aa(Et,y,wt,Se,Re,ce,Be):Zn(Et,y,wt,Se);ct.draw(w,w.gl.TRIANGLES,l,d,_,Zr.backCCW,ri,xt,i.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,i.paint,y.transform.zoom,at,y.style.map.terrain&&Je.centroidVertexBuffer)}}function To(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=i.fbo;if(!B)return;const j=y.useProgram("hillshade"),Y=y.style.map.terrain&&y.style.map.terrain.getTerrainData(s);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,B.colorAttachment.get()),j.draw(w,T.TRIANGLES,l,d,_,Zr.disabled,((ce,Se,Te,Re)=>{const Be=Te.paint.get("hillshade-shadow-color"),Je=Te.paint.get("hillshade-highlight-color"),xt=Te.paint.get("hillshade-accent-color");let at=Te.paint.get("hillshade-illumination-direction")*(Math.PI/180);Te.paint.get("hillshade-illumination-anchor")==="viewport"&&(at-=ce.transform.angle);const ct=!ce.options.moving;return{u_matrix:Re?Re.posMatrix:ce.transform.calculatePosMatrix(Se.tileID.toUnwrapped(),ct),u_image:0,u_latrange:It(0,Se.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),at],u_shadow:Be,u_highlight:Je,u_accent:xt}})(y,i,r,Y?s:null),Y,r.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function kl(y,s,i,r,l,d){const _=y.context,w=_.gl,T=s.dem;if(T&&T.data){const B=T.dim,j=T.stride,Y=T.getPixels();if(_.activeTexture.set(w.TEXTURE1),_.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||y.getTileTexture(j),s.demTexture){const Se=s.demTexture;Se.update(Y,{premultiply:!1}),Se.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else s.demTexture=new bt(_,Y,w.RGBA,{premultiply:!1}),s.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);_.activeTexture.set(w.TEXTURE0);let ce=s.fbo;if(!ce){const Se=new bt(_,{width:B,height:B,data:null},w.RGBA);Se.bind(w.LINEAR,w.CLAMP_TO_EDGE),ce=s.fbo=_.createFramebuffer(B,B,!0,!1),ce.colorAttachment.set(Se.texture)}_.bindFramebuffer.set(ce.framebuffer),_.viewport.set([0,0,B,B]),y.useProgram("hillshadePrepare").draw(_,w.TRIANGLES,r,l,d,Zr.disabled,((Se,Te)=>{const Re=Te.stride,Be=a.F();return a.aN(Be,0,a.W,-a.W,0,0,1),a.H(Be,Be,[0,-a.W,0]),{u_matrix:Be,u_image:1,u_dimension:[Re,Re],u_zoom:Se.overscaledZ,u_unpack:Te.getUnpackVector()}})(s.tileID,T),null,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function fo(y,s,i,r,l,d){const _=r.paint.get("raster-fade-duration");if(!d&&_>0){const w=ae.now(),T=(w-y.timeAdded)/_,B=s?(w-s.timeAdded)/_:-1,j=i.getSource(),Y=l.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),ce=!s||Math.abs(s.tileID.overscaledZ-Y)>Math.abs(y.tileID.overscaledZ-Y),Se=ce&&y.refreshedUponExpiration?1:a.ac(ce?T:1-B,0,1);return y.refreshedUponExpiration&&T>=1&&(y.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Se}:{opacity:Se,mix:0}}return{opacity:1,mix:0}}const Js=new a.aO(1,0,0,1),Gs=new a.aO(0,1,0,1),Qa=new a.aO(0,0,1,1),Jo=new a.aO(1,0,1,1),$r=new a.aO(0,1,1,1);function mr(y,s,i,r){ha(y,0,s+i/2,y.transform.width,i,r)}function Nr(y,s,i,r){ha(y,s-i/2,0,i,y.transform.height,r)}function ha(y,s,i,r,l,d){const _=y.context,w=_.gl;w.enable(w.SCISSOR_TEST),w.scissor(s*y.pixelRatio,i*y.pixelRatio,r*y.pixelRatio,l*y.pixelRatio),_.clear({color:d}),w.disable(w.SCISSOR_TEST)}function po(y,s,i){const r=y.context,l=r.gl,d=i.posMatrix,_=y.useProgram("debug"),w=Un.disabled,T=es.disabled,B=y.colorModeForRenderPass(),j="$debug",Y=y.style.map.terrain&&y.style.map.terrain.getTerrainData(i);r.activeTexture.set(l.TEXTURE0);const ce=s.getTileByID(i.key).latestRawTileData,Se=Math.floor((ce&&ce.byteLength||0)/1024),Te=s.getTile(i).tileSize,Re=512/Math.min(Te,512)*(i.overscaledZ/y.transform.zoom)*.5;let Be=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(Be+=` => ${i.overscaledZ}`),function(Je,xt){Je.initDebugOverlayCanvas();const at=Je.debugOverlayCanvas,ct=Je.context.gl,Et=Je.debugOverlayCanvas.getContext("2d");Et.clearRect(0,0,at.width,at.height),Et.shadowColor="white",Et.shadowBlur=2,Et.lineWidth=1.5,Et.strokeStyle="white",Et.textBaseline="top",Et.font="bold 36px Open Sans, sans-serif",Et.fillText(xt,5,5),Et.strokeText(xt,5,5),Je.debugOverlayTexture.update(at),Je.debugOverlayTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE)}(y,`${Be} ${Se}kB`),_.draw(r,l.TRIANGLES,w,T,fr.alphaBlended,Zr.disabled,N(d,a.aO.transparent,Re),null,j,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),_.draw(r,l.LINE_STRIP,w,T,B,Zr.disabled,N(d,a.aO.red),Y,j,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function ea(y,s,i){const r=y.context,l=r.gl,d=y.colorModeForRenderPass(),_=new Un(l.LEQUAL,Un.ReadWrite,y.depthRangeFor3D),w=y.useProgram("terrain"),T=s.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,y.width,y.height]);for(const B of i){const j=y.renderToTexture.getTexture(B),Y=s.getTerrainData(B.tileID);r.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,j.texture);const ce={u_matrix:y.transform.calculatePosMatrix(B.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(y.transform.zoom)};w.draw(r,l.TRIANGLES,_,es.disabled,d,Zr.backCCW,ce,Y,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class Sa{constructor(s,i){this.context=new Eo(s),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.F(),renderTime:0},this.setup(),this.numSublayers=Ie.maxUnderzooming+Ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ur}resize(s,i,r){if(this.width=Math.floor(s*r),this.height=Math.floor(i*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style._order)this.style._layers[l].resize()}setup(){const s=this.context,i=new a.aV;i.emplaceBack(0,0),i.emplaceBack(a.W,0),i.emplaceBack(0,a.W),i.emplaceBack(a.W,a.W),this.tileExtentBuffer=s.createVertexBuffer(i,Fr.members),this.tileExtentSegments=a.$.simpleSegment(0,0,4,2);const r=new a.aV;r.emplaceBack(0,0),r.emplaceBack(a.W,0),r.emplaceBack(0,a.W),r.emplaceBack(a.W,a.W),this.debugBuffer=s.createVertexBuffer(r,Fr.members),this.debugSegments=a.$.simpleSegment(0,0,4,5);const l=new a.Z;l.emplaceBack(0,0,0,0),l.emplaceBack(a.W,0,a.W,0),l.emplaceBack(0,a.W,0,a.W),l.emplaceBack(a.W,a.W,a.W,a.W),this.rasterBoundsBuffer=s.createVertexBuffer(l,en.members),this.rasterBoundsSegments=a.$.simpleSegment(0,0,4,2);const d=new a.aV;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(d,Fr.members),this.viewportSegments=a.$.simpleSegment(0,0,4,2);const _=new a.aW;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(_);const w=new a.aX;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new es({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const s=this.context,i=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=a.F();a.aN(r,0,this.width,this.height,0,0,1),a.J(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,i.TRIANGLES,Un.disabled,this.stencilClearMode,fr.disabled,Zr.disabled,xe(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,i){if(this.currentStencilSource===s.source||!s.isTileClipped()||!i||!i.length)return;this.currentStencilSource=s.source;const r=this.context,l=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(fr.disabled),r.setDepthMode(Un.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const _ of i){const w=this._tileClippingMaskIDs[_.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(_);d.draw(r,l.TRIANGLES,Un.disabled,new es({func:l.ALWAYS,mask:0},w,255,l.KEEP,l.KEEP,l.REPLACE),fr.disabled,Zr.disabled,xe(_.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,i=this.context.gl;return new es({func:i.NOTEQUAL,mask:255},s,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(s){const i=this.context.gl;return new es({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(s){const i=this.context.gl,r=s.sort((_,w)=>w.overscaledZ-_.overscaledZ),l=r[r.length-1].overscaledZ,d=r[0].overscaledZ-l+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const _={};for(let w=0;w<d;w++)_[w+l]=new es({func:i.GEQUAL,mask:255},w+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=d,[_,r]}return[{[l]:es.disabled},r]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new fr([s.CONSTANT_COLOR,s.ONE],new a.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fr.unblended:fr.alphaBlended}depthModeForSublayer(s,i,r){if(!this.opaquePassEnabledForLayer())return Un.disabled;const l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Un(r||this.context.gl.LEQUAL,i,[l,l])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,i){this.style=s,this.options=i,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(ae.now()),this.imageManager.beginFrame();const r=this.style._order,l=this.style.sourceCaches,d={},_={},w={};for(const T in l){const B=l[T];B.used&&B.prepare(this.context),d[T]=B.getVisibleCoordinates(),_[T]=d[T].slice().reverse(),w[T]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<r.length;T++)if(this.style._layers[r[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.aY(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(a.aZ(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,j){const Y=B.context,ce=Y.gl,Se=fr.unblended,Te=new Un(ce.LEQUAL,Un.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.sourceCache.getRenderableTiles(),Je=B.useProgram("terrainDepth");Y.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),Y.clear({color:a.aO.transparent,depth:1});for(const xt of Be){const at=j.getTerrainData(xt.tileID),ct={u_matrix:B.transform.calculatePosMatrix(xt.tileID.toUnwrapped()),u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};Je.draw(Y,ce.TRIANGLES,Te,es.disabled,Se,Zr.backCCW,ct,at,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain),function(B,j){const Y=B.context,ce=Y.gl,Se=fr.unblended,Te=new Un(ce.LEQUAL,Un.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.getCoordsTexture(),Je=j.sourceCache.getRenderableTiles(),xt=B.useProgram("terrainCoords");Y.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),Y.clear({color:a.aO.transparent,depth:1}),j.coordsIndex=[];for(const at of Je){const ct=j.getTerrainData(at.tileID);Y.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,Be.texture);const Et={u_matrix:B.transform.calculatePosMatrix(at.tileID.toUnwrapped()),u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};xt.draw(Y,ce.TRIANGLES,Te,es.disabled,Se,Zr.backCCW,Et,ct,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments),j.coordsIndex.push(at.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of r){const B=this.style._layers[T];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const j=_[B.source];(B.type==="custom"||j.length)&&this.renderLayer(this,l[B.source],B,j)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.aO.black:a.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[r[this.currentLayer]],B=l[T.source],j=d[T.source];this._renderTileClippingMasks(T,j),this.renderLayer(this,B,T,j)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const T=this.style._layers[r[this.currentLayer]],B=l[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const j=(T.type==="symbol"?w:_)[T.source];this._renderTileClippingMasks(T,d[T.source]),this.renderLayer(this,B,T,j)}if(this.options.showTileBoundaries){const T=function(B,j){let Y=null;const ce=Object.values(B._layers).flatMap(Be=>Be.source&&!Be.isHidden(j)?[B.sourceCaches[Be.source]]:[]),Se=ce.filter(Be=>Be.getSource().type==="vector"),Te=ce.filter(Be=>Be.getSource().type!=="vector"),Re=Be=>{(!Y||Y.getSource().maxzoom<Be.getSource().maxzoom)&&(Y=Be)};return Se.forEach(Be=>Re(Be)),Y||Te.forEach(Be=>Re(Be)),Y}(this.style,this.transform.zoom);T&&function(B,j,Y){for(let ce=0;ce<Y.length;ce++)po(B,j,Y[ce])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const B=T.transform.padding;mr(T,T.transform.height-(B.top||0),3,Js),mr(T,B.bottom||0,3,Gs),Nr(T,B.left||0,3,Qa),Nr(T,T.transform.width-(B.right||0),3,Jo);const j=T.transform.centerPoint;(function(Y,ce,Se,Te){ha(Y,ce-1,Se-10,2,20,Te),ha(Y,ce-10,Se-1,20,2,Te)})(T,j.x,T.transform.height-j.y,$r)}(this),this.context.setDefault()}renderLayer(s,i,r,l){if(!r.isHidden(this.transform.zoom)&&(r.type==="background"||r.type==="custom"||(l||[]).length))switch(this.id=r.id,r.type){case"symbol":(function(d,_,w,T,B){if(d.renderPass!=="translucent")return;const j=es.disabled,Y=d.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ce,Se,Te,Re,Be,Je,xt){const at=Se.transform,ct=Be==="map",Et=Je==="map";for(const wt of ce){const ri=Re.getTile(wt),Yt=ri.getBucket(Te);if(!Yt||!Yt.text||!Yt.text.segments.get().length)continue;const ei=a.ag(Yt.textSizeData,at.zoom),si=kt(ri,1,Se.transform.zoom),ji=Ve(wt.posMatrix,Et,ct,Se.transform,si),Qi=Te.layout.get("icon-text-fit")!=="none"&&Yt.hasIconData();if(ei){const Ei=Math.pow(2,at.zoom-ri.tileID.overscaledZ);Yr(Yt,ct,Et,xt,at,ji,wt.posMatrix,Ei,ei,Qi,Se.style.map.terrain?(Ui,Gi)=>Se.style.map.terrain.getElevation(wt,Ui,Gi):null)}}}(T,d,w,_,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),B),w.paint.get("icon-opacity").constantOr(1)!==0&&ul(d,_,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),j,Y),w.paint.get("text-opacity").constantOr(1)!==0&&ul(d,_,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),j,Y),_.map.showCollisionBoxes&&(kr(d,_,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),kr(d,_,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(s,i,r,l,this.style.placement.variableOffsets);break;case"circle":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("circle-opacity"),j=w.paint.get("circle-stroke-width"),Y=w.paint.get("circle-stroke-opacity"),ce=!w.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(j.constantOr(1)===0||Y.constantOr(1)===0))return;const Se=d.context,Te=Se.gl,Re=d.depthModeForSublayer(0,Un.ReadOnly),Be=es.disabled,Je=d.colorModeForRenderPass(),xt=[];for(let at=0;at<T.length;at++){const ct=T[at],Et=_.getTile(ct),wt=Et.getBucket(w);if(!wt)continue;const ri=wt.programConfigurations.get(w.id),Yt=d.useProgram("circle",ri),ei=wt.layoutVertexBuffer,si=wt.indexBuffer,ji=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ct),Qi={programConfiguration:ri,program:Yt,layoutVertexBuffer:ei,indexBuffer:si,uniformValues:to(d,ct,Et,w),terrainData:ji};if(ce){const Ei=wt.segments.get();for(const Ui of Ei)xt.push({segments:new a.$([Ui]),sortKey:Ui.sortKey,state:Qi})}else xt.push({segments:wt.segments,sortKey:0,state:Qi})}ce&&xt.sort((at,ct)=>at.sortKey-ct.sortKey);for(const at of xt){const{programConfiguration:ct,program:Et,layoutVertexBuffer:wt,indexBuffer:ri,uniformValues:Yt,terrainData:ei}=at.state;Et.draw(Se,Te.TRIANGLES,Re,Be,Je,Zr.disabled,Yt,ei,w.id,wt,ri,at.segments,w.paint,d.transform.zoom,ct)}})(s,i,r,l);break;case"heatmap":(function(d,_,w,T){if(w.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const B=d.context,j=B.gl,Y=es.disabled,ce=new fr([j.ONE,j.ONE],a.aO.transparent,[!0,!0,!0,!0]);(function(Se,Te,Re){const Be=Se.gl;Se.activeTexture.set(Be.TEXTURE1),Se.viewport.set([0,0,Te.width/4,Te.height/4]);let Je=Re.heatmapFbo;if(Je)Be.bindTexture(Be.TEXTURE_2D,Je.colorAttachment.get()),Se.bindFramebuffer.set(Je.framebuffer);else{const xt=Be.createTexture();Be.bindTexture(Be.TEXTURE_2D,xt),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_S,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_T,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MIN_FILTER,Be.LINEAR),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MAG_FILTER,Be.LINEAR),Je=Re.heatmapFbo=Se.createFramebuffer(Te.width/4,Te.height/4,!1,!1),function(at,ct,Et,wt){var ri,Yt;const ei=at.gl,si=(ri=at.HALF_FLOAT)!==null&&ri!==void 0?ri:ei.UNSIGNED_BYTE,ji=(Yt=at.RGBA16F)!==null&&Yt!==void 0?Yt:ei.RGBA;ei.texImage2D(ei.TEXTURE_2D,0,ji,ct.width/4,ct.height/4,0,ei.RGBA,si,null),wt.colorAttachment.set(Et)}(Se,Te,xt,Je)}})(B,d,w),B.clear({color:a.aO.transparent});for(let Se=0;Se<T.length;Se++){const Te=T[Se];if(_.hasRenderableParent(Te))continue;const Re=_.getTile(Te),Be=Re.getBucket(w);if(!Be)continue;const Je=Be.programConfigurations.get(w.id),xt=d.useProgram("heatmap",Je),{zoom:at}=d.transform;xt.draw(B,j.TRIANGLES,Un.disabled,Y,ce,Zr.disabled,it(Te.posMatrix,Re,at,w.paint.get("heatmap-intensity")),null,w.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,w.paint,d.transform.zoom,Je)}B.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(B,j){const Y=B.context,ce=Y.gl,Se=j.heatmapFbo;if(!Se)return;Y.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,Se.colorAttachment.get()),Y.activeTexture.set(ce.TEXTURE1);let Te=j.colorRampTexture;Te||(Te=j.colorRampTexture=new bt(Y,j.colorRamp,ce.RGBA)),Te.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),B.useProgram("heatmapTexture").draw(Y,ce.TRIANGLES,Un.disabled,es.disabled,B.colorModeForRenderPass(),Zr.disabled,((Re,Be,Je,xt)=>{const at=a.F();a.aN(at,0,Re.width,Re.height,0,0,1);const ct=Re.context.gl;return{u_matrix:at,u_world:[ct.drawingBufferWidth,ct.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Be.paint.get("heatmap-opacity")}})(B,j),null,j.id,B.viewportBuffer,B.quadTriangleIndexBuffer,B.viewportSegments,j.paint,B.transform.zoom)}(d,w))})(s,i,r,l);break;case"line":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("line-opacity"),j=w.paint.get("line-width");if(B.constantOr(1)===0||j.constantOr(1)===0)return;const Y=d.depthModeForSublayer(0,Un.ReadOnly),ce=d.colorModeForRenderPass(),Se=w.paint.get("line-dasharray"),Te=w.paint.get("line-pattern"),Re=Te.constantOr(1),Be=w.paint.get("line-gradient"),Je=w.getCrossfadeParameters(),xt=Re?"linePattern":Se?"lineSDF":Be?"lineGradient":"line",at=d.context,ct=at.gl;let Et=!0;for(const wt of T){const ri=_.getTile(wt);if(Re&&!ri.patternsLoaded())continue;const Yt=ri.getBucket(w);if(!Yt)continue;const ei=Yt.programConfigurations.get(w.id),si=d.context.program.get(),ji=d.useProgram(xt,ei),Qi=Et||ji.program!==si,Ei=d.style.map.terrain&&d.style.map.terrain.getTerrainData(wt),Ui=Te.constantOr(null);if(Ui&&ri.imageAtlas){const Bn=ri.imageAtlas,rn=Bn.patternPositions[Ui.to.toString()],kn=Bn.patternPositions[Ui.from.toString()];rn&&kn&&ei.setConstantPatternPositions(rn,kn)}const Gi=Ei?wt:null,ln=Re?Li(d,ri,w,Je,Gi):Se?cn(d,ri,w,Se,Je,Gi):Be?Ii(d,ri,w,Yt.lineClipsArray.length,Gi):Wt(d,ri,w,Gi);if(Re)at.activeTexture.set(ct.TEXTURE0),ri.imageAtlasTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),ei.updatePaintBuffers(Je);else if(Se&&(Qi||d.lineAtlas.dirty))at.activeTexture.set(ct.TEXTURE0),d.lineAtlas.bind(at);else if(Be){const Bn=Yt.gradients[w.id];let rn=Bn.texture;if(w.gradientVersion!==Bn.version){let kn=256;if(w.stepInterpolant){const yr=_.getSource().maxzoom,er=wt.canonical.z===yr?Math.ceil(1<<d.transform.maxZoom-wt.canonical.z):1;kn=a.ac(a.aT(Yt.maxLineLength/a.W*1024*er),256,at.maxTextureSize)}Bn.gradient=a.aU({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:kn,image:Bn.gradient||void 0,clips:Yt.lineClipsArray}),Bn.texture?Bn.texture.update(Bn.gradient):Bn.texture=new bt(at,Bn.gradient,ct.RGBA),Bn.version=w.gradientVersion,rn=Bn.texture}at.activeTexture.set(ct.TEXTURE0),rn.bind(w.stepInterpolant?ct.NEAREST:ct.LINEAR,ct.CLAMP_TO_EDGE)}ji.draw(at,ct.TRIANGLES,Y,d.stencilModeForClipping(wt),ce,Zr.disabled,ln,Ei,w.id,Yt.layoutVertexBuffer,Yt.indexBuffer,Yt.segments,w.paint,d.transform.zoom,ei,Yt.layoutVertexBuffer2),Et=!1}})(s,i,r,l);break;case"fill":(function(d,_,w,T){const B=w.paint.get("fill-color"),j=w.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const Y=d.colorModeForRenderPass(),ce=w.paint.get("fill-pattern"),Se=d.opaquePassEnabledForLayer()&&!ce.constantOr(1)&&B.constantOr(a.aO.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===Se){const Te=d.depthModeForSublayer(1,d.renderPass==="opaque"?Un.ReadWrite:Un.ReadOnly);wa(d,_,w,T,Te,Y,!1)}if(d.renderPass==="translucent"&&w.paint.get("fill-antialias")){const Te=d.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Un.ReadOnly);wa(d,_,w,T,Te,Y,!0)}})(s,i,r,l);break;case"fill-extrusion":(function(d,_,w,T){const B=w.paint.get("fill-extrusion-opacity");if(B!==0&&d.renderPass==="translucent"){const j=new Un(d.context.gl.LEQUAL,Un.ReadWrite,d.depthRangeFor3D);if(B!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))Tl(d,_,w,T,j,es.disabled,fr.disabled),Tl(d,_,w,T,j,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const Y=d.colorModeForRenderPass();Tl(d,_,w,T,j,es.disabled,Y)}}})(s,i,r,l);break;case"hillshade":(function(d,_,w,T){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const B=d.context,j=d.depthModeForSublayer(0,Un.ReadOnly),Y=d.colorModeForRenderPass(),[ce,Se]=d.renderPass==="translucent"?d.stencilConfigForOverlap(T):[{},T];for(const Te of Se){const Re=_.getTile(Te);Re.needsHillshadePrepare!==void 0&&Re.needsHillshadePrepare&&d.renderPass==="offscreen"?kl(d,Re,w,j,es.disabled,Y):d.renderPass==="translucent"&&To(d,Te,Re,w,j,ce[Te.overscaledZ],Y)}B.viewport.set([0,0,d.width,d.height])})(s,i,r,l);break;case"raster":(function(d,_,w,T){if(d.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const B=d.context,j=B.gl,Y=_.getSource(),ce=d.useProgram("raster"),Se=d.colorModeForRenderPass(),[Te,Re]=Y instanceof tr?[{},T]:d.stencilConfigForOverlap(T),Be=Re[Re.length-1].overscaledZ,Je=!d.options.moving;for(const xt of Re){const at=d.depthModeForSublayer(xt.overscaledZ-Be,w.paint.get("raster-opacity")===1?Un.ReadWrite:Un.ReadOnly,j.LESS),ct=_.getTile(xt);ct.registerFadeDuration(w.paint.get("raster-fade-duration"));const Et=_.findLoadedParent(xt,0),wt=fo(ct,Et,_,w,d.transform,d.style.map.terrain);let ri,Yt;const ei=w.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;B.activeTexture.set(j.TEXTURE0),ct.texture.bind(ei,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(j.TEXTURE1),Et?(Et.texture.bind(ei,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),ri=Math.pow(2,Et.tileID.overscaledZ-ct.tileID.overscaledZ),Yt=[ct.tileID.canonical.x*ri%1,ct.tileID.canonical.y*ri%1]):ct.texture.bind(ei,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const si=d.style.map.terrain&&d.style.map.terrain.getTerrainData(xt),ji=si?xt:null,Qi=ji?ji.posMatrix:d.transform.calculatePosMatrix(xt.toUnwrapped(),Je),Ei=Ar(Qi,Yt||[0,0],ri||1,wt,w);Y instanceof tr?ce.draw(B,j.TRIANGLES,at,es.disabled,Se,Zr.disabled,Ei,si,w.id,Y.boundsBuffer,d.quadTriangleIndexBuffer,Y.boundsSegments):ce.draw(B,j.TRIANGLES,at,Te[xt.overscaledZ],Se,Zr.disabled,Ei,si,w.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}})(s,i,r,l);break;case"background":(function(d,_,w,T){const B=w.paint.get("background-color"),j=w.paint.get("background-opacity");if(j===0)return;const Y=d.context,ce=Y.gl,Se=d.transform,Te=Se.tileSize,Re=w.paint.get("background-pattern");if(d.isPatternMissing(Re))return;const Be=!Re&&B.a===1&&j===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==Be)return;const Je=es.disabled,xt=d.depthModeForSublayer(0,Be==="opaque"?Un.ReadWrite:Un.ReadOnly),at=d.colorModeForRenderPass(),ct=d.useProgram(Re?"backgroundPattern":"background"),Et=T||Se.coveringTiles({tileSize:Te,terrain:d.style.map.terrain});Re&&(Y.activeTexture.set(ce.TEXTURE0),d.imageManager.bind(d.context));const wt=w.getCrossfadeParameters();for(const ri of Et){const Yt=T?ri.posMatrix:d.transform.calculatePosMatrix(ri.toUnwrapped()),ei=Re?Gr(Yt,j,d,Re,{tileID:ri,tileSize:Te},wt):pl(Yt,j,B),si=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ri);ct.draw(Y,ce.TRIANGLES,xt,Je,at,Zr.disabled,ei,si,w.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}})(s,0,r,l);break;case"custom":(function(d,_,w){const T=d.context,B=w.implementation;if(d.renderPass==="offscreen"){const j=B.prerender;j&&(d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),j.call(B,T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),T.setStencilMode(es.disabled);const j=B.renderingMode==="3d"?new Un(d.context.gl.LEQUAL,Un.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,Un.ReadOnly);T.setDepthMode(j),B.render(T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState(),T.bindFramebuffer.set(null)}})(s,0,r)}}translatePosMatrix(s,i,r,l,d){if(!r[0]&&!r[1])return s;const _=d?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(_){const B=Math.sin(_),j=Math.cos(_);r=[r[0]*j-r[1]*B,r[0]*B+r[1]*j]}const w=[d?r[0]:kt(i,r[0],this.transform.zoom),d?r[1]:kt(i,r[1],this.transform.zoom),0],T=new Float32Array(16);return a.H(T,s,w),T}saveTileTexture(s){const i=this._tileTextures[s.size[0]];i?i.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const i=this._tileTextures[s];return i&&i.length>0?i.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const i=this.imageManager.getPattern(s.from.toString()),r=this.imageManager.getPattern(s.to.toString());return!i||!r}useProgram(s,i){this.cache=this.cache||{};const r=s+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new Oa(this.context,ua[s],i,nr[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new bt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:s,drawingBufferHeight:i}=this.context.gl;return this.width!==s||this.height!==i}}class ka{constructor(s,i){this.points=s,this.planes=i}static fromInvProjectionMatrix(s,i,r){const l=Math.pow(2,r),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=1/(w=a.af([],w,s))[3]/i*l;return a.a_(w,w,[T,T,1/w[3],T])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=function(ce,Se){var Te=Se[0],Re=Se[1],Be=Se[2],Je=Te*Te+Re*Re+Be*Be;return Je>0&&(Je=1/Math.sqrt(Je)),ce[0]=Se[0]*Je,ce[1]=Se[1]*Je,ce[2]=Se[2]*Je,ce}([],function(ce,Se,Te){var Re=Se[0],Be=Se[1],Je=Se[2],xt=Te[0],at=Te[1],ct=Te[2];return ce[0]=Be*ct-Je*at,ce[1]=Je*xt-Re*ct,ce[2]=Re*at-Be*xt,ce}([],yt([],d[w[0]],d[w[1]]),yt([],d[w[2]],d[w[1]]))),B=-((j=T)[0]*(Y=d[w[1]])[0]+j[1]*Y[1]+j[2]*Y[2]);var j,Y;return T.concat(B)});return new ka(d,_)}}class Wa{constructor(s,i){this.min=s,this.max=i,this.center=function(r,l,d){return r[0]=.5*l[0],r[1]=.5*l[1],r[2]=.5*l[2],r}([],function(r,l,d){return r[0]=l[0]+d[0],r[1]=l[1]+d[1],r[2]=l[2]+d[2],r}([],this.min,this.max))}quadrant(s){const i=[s%2==0,s<2],r=Xt(this.min),l=Xt(this.max);for(let d=0;d<i.length;d++)r[d]=i[d]?this.min[d]:this.center[d],l[d]=i[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new Wa(r,l)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let l=0;l<s.planes.length;l++){const d=s.planes[l];let _=0;for(let w=0;w<i.length;w++)a.a$(d,i[w])>=0&&_++;if(_===0)return 0;_!==i.length&&(r=!1)}if(r)return 2;for(let l=0;l<3;l++){let d=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let w=0;w<s.points.length;w++){const T=s.points[w][l]-this.min[l];d=Math.min(d,T),_=Math.max(_,T)}if(_<0||d>this.max[l]-this.min[l])return 0}return 1}}class cl{constructor(s=0,i=0,r=0,l=0){if(isNaN(s)||s<0||isNaN(i)||i<0||isNaN(r)||r<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=i,this.left=r,this.right=l}interpolate(s,i,r){return i.top!=null&&s.top!=null&&(this.top=a.z.number(s.top,i.top,r)),i.bottom!=null&&s.bottom!=null&&(this.bottom=a.z.number(s.bottom,i.bottom,r)),i.left!=null&&s.left!=null&&(this.left=a.z.number(s.left,i.left,r)),i.right!=null&&s.right!=null&&(this.right=a.z.number(s.right,i.right,r)),this}getCenter(s,i){const r=a.ac((this.left+s-this.right)/2,0,s),l=a.ac((this.top+i-this.bottom)/2,0,i);return new a.P(r,l)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new cl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class lu{constructor(s,i,r,l,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=d===void 0||!!d,this._minZoom=s||0,this._maxZoom=i||22,this._minPitch=r??0,this._maxPitch=l??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new cl,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const s=new lu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this.minElevationForCurrentTile=s.minElevationForCurrentTile,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const i=-a.b0(s,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var r=new a.A(4);return a.A!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}(),function(r,l,d){var _=l[0],w=l[1],T=l[2],B=l[3],j=Math.sin(d),Y=Math.cos(d);r[0]=_*Y+T*j,r[1]=w*Y+B*j,r[2]=_*-j+T*Y,r[3]=w*-j+B*Y}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const i=a.ac(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const i=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.tileZoom=Math.max(0,Math.floor(i)),this.scale=this.zoomScale(i),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,i,r){this._unmodified=!1,this._edgeInsets.interpolate(s,i,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const i=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,i)}getVisibleUnwrappedCoordinates(s){const i=[new a.b1(0,s)];if(this._renderWorldCopies){const r=this.pointCoordinate(new a.P(0,0)),l=this.pointCoordinate(new a.P(this.width,0)),d=this.pointCoordinate(new a.P(this.width,this.height)),_=this.pointCoordinate(new a.P(0,this.height)),w=Math.floor(Math.min(r.x,l.x,d.x,_.x)),T=Math.floor(Math.max(r.x,l.x,d.x,_.x)),B=1;for(let j=w-B;j<=T+B;j++)j!==0&&i.push(new a.b1(j,s))}return i}coveringTiles(s){var i,r;let l=this.coveringZoomLevel(s);const d=l;if(s.minzoom!==void 0&&l<s.minzoom)return[];s.maxzoom!==void 0&&l>s.maxzoom&&(l=s.maxzoom);const _=this.pointCoordinate(this.getCameraPoint()),w=a.Y.fromLngLat(this.center),T=Math.pow(2,l),B=[T*_.x,T*_.y,0],j=[T*w.x,T*w.y,0],Y=ka.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l);let ce=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ce=l);const Se=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,Te=at=>({aabb:new Wa([at*T,0,0],[(at+1)*T,T,0]),zoom:0,x:0,y:0,wrap:at,fullyVisible:!1}),Re=[],Be=[],Je=l,xt=s.reparseOverscaled?d:l;if(this._renderWorldCopies)for(let at=1;at<=3;at++)Re.push(Te(-at)),Re.push(Te(at));for(Re.push(Te(0));Re.length>0;){const at=Re.pop(),ct=at.x,Et=at.y;let wt=at.fullyVisible;if(!wt){const ji=at.aabb.intersects(Y);if(ji===0)continue;wt=ji===2}const ri=s.terrain?B:j,Yt=at.aabb.distanceX(ri),ei=at.aabb.distanceY(ri),si=Math.max(Math.abs(Yt),Math.abs(ei));if(at.zoom===Je||si>Se+(1<<Je-at.zoom)-2&&at.zoom>=ce){const ji=Je-at.zoom,Qi=B[0]-.5-(ct<<ji),Ei=B[1]-.5-(Et<<ji);Be.push({tileID:new a.Q(at.zoom===Je?xt:at.zoom,at.wrap,at.zoom,ct,Et),distanceSq:pt([j[0]-.5-ct,j[1]-.5-Et]),tileDistanceToCamera:Math.sqrt(Qi*Qi+Ei*Ei)})}else for(let ji=0;ji<4;ji++){const Qi=(ct<<1)+ji%2,Ei=(Et<<1)+(ji>>1),Ui=at.zoom+1;let Gi=at.aabb.quadrant(ji);if(s.terrain){const ln=new a.Q(Ui,at.wrap,Ui,Qi,Ei),Bn=s.terrain.getMinMaxElevation(ln),rn=(i=Bn.minElevation)!==null&&i!==void 0?i:this.elevation,kn=(r=Bn.maxElevation)!==null&&r!==void 0?r:this.elevation;Gi=new Wa([Gi.min[0],Gi.min[1],rn],[Gi.max[0],Gi.max[1],kn])}Re.push({aabb:Gi,zoom:Ui,x:Qi,y:Ei,wrap:at.wrap,fullyVisible:wt})}}return Be.sort((at,ct)=>at.distanceSq-ct.distanceSq).map(at=>at.tileID)}resize(s,i){this.width=s,this.height=i,this.pixelsToGLUnits=[2/s,-2/i],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const i=a.ac(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.N(s.lng)*this.worldSize,a.O(i)*this.worldSize)}unproject(s){return new a.Y(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const i=this.pointLocation(this.centerPoint,s),r=s.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-r))return;const l=this.getCameraPosition(),d=a.Y.fromLngLat(l.lngLat,l.altitude),_=a.Y.fromLngLat(i,r),w=d.x-_.x,T=d.y-_.y,B=d.z-_.z,j=Math.sqrt(w*w+T*T+B*B),Y=this.scaleZoom(this.cameraToCenterDistance/j/this.tileSize);this._elevation=r,this._center=i,this.zoom=Y}setLocationAtPoint(s,i){const r=this.pointCoordinate(i),l=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(s),_=new a.Y(d.x-(r.x-l.x),d.y-(r.y-l.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,i){return i?this.coordinatePoint(this.locationCoordinate(s),i.getElevationForLngLatZoom(s,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,i){return this.coordinateLocation(this.pointCoordinate(s,i))}locationCoordinate(s){return a.Y.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,i){if(i){const ce=i.pointCoordinate(s);if(ce!=null)return ce}const r=[s.x,s.y,0,1],l=[s.x,s.y,1,1];a.af(r,r,this.pixelMatrixInverse),a.af(l,l,this.pixelMatrixInverse);const d=r[3],_=l[3],w=r[1]/d,T=l[1]/_,B=r[2]/d,j=l[2]/_,Y=B===j?0:(0-B)/(j-B);return new a.Y(a.z.number(r[0]/d,l[0]/_,Y)/this.worldSize,a.z.number(w,T,Y)/this.worldSize)}coordinatePoint(s,i=0,r=this.pixelMatrix){const l=[s.x*this.worldSize,s.y*this.worldSize,i,1];return a.af(l,l,r),new a.P(l[0]/l[3],l[1]/l[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return new fi().extend(this.pointLocation(new a.P(0,s))).extend(this.pointLocation(new a.P(this.width,s))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new fi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,i=!1){const r=s.key,l=i?this._alignedPosMatrixCache:this._posMatrixCache;if(l[r])return l[r];const d=s.canonical,_=this.worldSize/this.zoomScale(d.z),w=d.x+Math.pow(2,d.z)*s.wrap,T=a.an(new Float64Array(16));return a.H(T,T,[w*_,d.y*_,0]),a.J(T,T,[_/a.W,_/a.W,1]),a.K(T,i?this.alignedProjMatrix:this.projMatrix,T),l[r]=new Float32Array(T),l[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;let s=this.lngRange;if(!this._renderWorldCopies&&s===null){const Te=179.9999999999;s=[-Te,Te]}this._constraining=!0;let i,r,l,d,_=-90,w=90,T=-180,B=180;const j=this.size,Y=this._unmodified;if(this.latRange){const Te=this.latRange;_=a.O(Te[1])*this.worldSize,w=a.O(Te[0])*this.worldSize,i=w-_<j.y?j.y/(w-_):0}s&&(T=a.b0(a.N(s[0])*this.worldSize,0,this.worldSize),B=a.b0(a.N(s[1])*this.worldSize,0,this.worldSize),B<T&&(B+=this.worldSize),r=B-T<j.x?j.x/(B-T):0);const ce=this.point,Se=Math.max(r||0,i||0);if(Se)return this.center=this.unproject(new a.P(r?(B+T)/2:ce.x,i?(w+_)/2:ce.y)),this.zoom+=this.scaleZoom(Se),this._unmodified=Y,void(this._constraining=!1);if(this.latRange){const Te=ce.y,Re=j.y/2;Te-Re<_&&(d=_+Re),Te+Re>w&&(d=w-Re)}if(s){const Te=(T+B)/2;let Re=ce.x;this._renderWorldCopies&&(Re=a.b0(ce.x,Te-this.worldSize/2,Te+this.worldSize/2));const Be=j.x/2;Re-Be<T&&(l=T+Be),Re+Be>B&&(l=B-Be)}l===void 0&&d===void 0||(this.center=this.unproject(new a.P(l!==void 0?l:ce.x,d!==void 0?d:ce.y)).wrap()),this._unmodified=Y,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,i=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b2(1,this.center.lat)*this.worldSize;let l=a.an(new Float64Array(16));a.J(l,l,[this.width/2,-this.height/2,1]),a.H(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=a.an(new Float64Array(16)),a.J(l,l,[1,-1,1]),a.H(l,l,[-1,-1,0]),a.J(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l;const d=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),_=Math.min(this.elevation,this.minElevationForCurrentTile),w=d-_*this._pixelPerMeter/Math.cos(this._pitch),T=_<0?w:d,B=Math.PI/2+this._pitch,j=this._fov*(.5+s.y/this.height),Y=Math.sin(j)*T/Math.sin(a.ac(Math.PI-B-j,.01,Math.PI-.01)),ce=this.getHorizon(),Se=2*Math.atan(ce/this.cameraToCenterDistance)*(.5+s.y/(2*ce)),Te=Math.sin(Se)*T/Math.sin(a.ac(Math.PI-B-Se,.01,Math.PI-.01)),Re=Math.min(Y,Te),Be=1.01*(Math.cos(Math.PI/2-this._pitch)*Re+T),Je=this.height/50;l=new Float64Array(16),a.b3(l,this._fov,this.width/this.height,Je,Be),l[8]=2*-s.x/this.width,l[9]=2*s.y/this.height,a.J(l,l,[1,-1,1]),a.H(l,l,[0,0,-this.cameraToCenterDistance]),a.b4(l,l,this._pitch),a.ad(l,l,this.angle),a.H(l,l,[-i,-r,0]),this.mercatorMatrix=a.J([],l,[this.worldSize,this.worldSize,this.worldSize]),a.J(l,l,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.K(new Float64Array(16),this.labelPlaneMatrix,l),a.H(l,l,[0,0,-this.elevation]),this.projMatrix=l,this.invProjMatrix=a.ar([],l),this.pixelMatrix3D=a.K(new Float64Array(16),this.labelPlaneMatrix,l);const xt=this.width%2/2,at=this.height%2/2,ct=Math.cos(this.angle),Et=Math.sin(this.angle),wt=i-Math.round(i)+ct*xt+Et*at,ri=r-Math.round(r)+ct*at+Et*xt,Yt=new Float64Array(l);if(a.H(Yt,Yt,[wt>.5?wt-1:wt,ri>.5?ri-1:ri,0]),this.alignedProjMatrix=Yt,l=a.ar(new Float64Array(16),this.pixelMatrix),!l)throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new a.P(0,0)),i=[s.x*this.worldSize,s.y*this.worldSize,0,1];return a.af(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,s))}getCameraQueryGeometry(s){const i=this.getCameraPoint();if(s.length===1)return[s[0],i];{let r=i.x,l=i.y,d=i.x,_=i.y;for(const w of s)r=Math.min(r,w.x),l=Math.min(l,w.y),d=Math.max(d,w.x),_=Math.max(_,w.y);return[new a.P(r,l),new a.P(d,l),new a.P(d,_),new a.P(r,_),new a.P(r,l)]}}lngLatToCameraDepth(s,i){const r=this.locationCoordinate(s),l=[r.x*this.worldSize,r.y*this.worldSize,i,1];return a.af(l,l,this.projMatrix),l[2]/l[3]}}function gl(y,s){let i,r=!1,l=null,d=null;const _=()=>{l=null,r&&(y.apply(d,i),l=setTimeout(_,s),r=!1)};return(...w)=>(r=!0,d=this,i=w,l||_(),l)}class ro{constructor(s){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let r;return i.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(r=l)}),(r&&r[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(i.length>=3&&!i.some(r=>isNaN(r))){const r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:r,pitch:+(i[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch{}},this._updateHash=gl(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const i=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,l=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,l),_=Math.round(i.lng*d)/d,w=Math.round(i.lat*d)/d,T=this._map.getBearing(),B=this._map.getPitch();let j="";if(j+=s?`/${_}/${w}/${r}`:`${r}/${w}/${_}`,(T||B)&&(j+="/"+Math.round(10*T)/10),B&&(j+=`/${Math.round(B)}`),this._hashName){const Y=this._hashName;let ce=!1;const Se=window.location.hash.slice(1).split("&").map(Te=>{const Re=Te.split("=")[0];return Re===Y?(ce=!0,`${Re}=${j}`):Te}).filter(Te=>Te);return ce||Se.push(`${Y}=${j}`),`#${Se.join("&")}`}return`#${j}`}}const mi={linearity:.3,easing:a.b5(0,0,.3,1)},Vi=a.e({deceleration:2500,maxSpeed:1400},mi),Di=a.e({deceleration:20,maxSpeed:1400},mi),Ft=a.e({deceleration:1e3,maxSpeed:360},mi),ti=a.e({deceleration:1e3,maxSpeed:90},mi);class xi{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ae.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,i=ae.now();for(;s.length>0&&i-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)i.zoom+=d.zoomDelta||0,i.bearing+=d.bearingDelta||0,i.pitch+=d.pitchDelta||0,d.panDelta&&i.pan._add(d.panDelta),d.around&&(i.around=d.around),d.pinchAround&&(i.pinchAround=d.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,l={};if(i.pan.mag()){const d=Ln(i.pan.mag(),r,a.e({},Vi,s||{}));l.offset=i.pan.mult(d.amount/i.pan.mag()),l.center=this._map.transform.center,Fi(l,d)}if(i.zoom){const d=Ln(i.zoom,r,Di);l.zoom=this._map.transform.zoom+d.amount,Fi(l,d)}if(i.bearing){const d=Ln(i.bearing,r,Ft);l.bearing=this._map.transform.bearing+a.ac(d.amount,-179,179),Fi(l,d)}if(i.pitch){const d=Ln(i.pitch,r,ti);l.pitch=this._map.transform.pitch+d.amount,Fi(l,d)}if(l.zoom||l.bearing){const d=i.pinchAround===void 0?i.around:i.pinchAround;l.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),a.e(l,{noMoveStart:!0})}}function Fi(y,s){(!y.duration||y.duration<s.duration)&&(y.duration=s.duration,y.easing=s.easing)}function Ln(y,s,i){const{maxSpeed:r,linearity:l,deceleration:d}=i,_=a.ac(y*l/(s/1e3),-r,r),w=Math.abs(_)/(d*l);return{easing:i.easing,duration:1e3*w,amount:_*(w/2)}}class Hn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r,l={}){const d=ue.mousePos(i.getCanvas(),r),_=i.unproject(d);super(s,a.e({point:d,lngLat:_,originalEvent:r},l)),this._defaultPrevented=!1,this.target=i}}class lr extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){const l=s==="touchend"?r.changedTouches:r.touches,d=ue.touchPos(i.getCanvasContainer(),l),_=d.map(T=>i.unproject(T)),w=d.reduce((T,B,j,Y)=>T.add(B.div(Y.length)),new a.P(0,0));super(s,{points:d,point:w,lngLats:_,lngLat:i.unproject(w),originalEvent:r}),this._defaultPrevented=!1}}class Yn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){super(s,{originalEvent:r}),this._defaultPrevented=!1}}class qs{constructor(s,i){this._map=s,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Yn(s.type,this._map,s))}mousedown(s,i){return this._mousedownPos=i,this._firePreventable(new Hn(s.type,this._map,s))}mouseup(s){this._map.fire(new Hn(s.type,this._map,s))}click(s,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new Hn(s.type,this._map,s))}dblclick(s){return this._firePreventable(new Hn(s.type,this._map,s))}mouseover(s){this._map.fire(new Hn(s.type,this._map,s))}mouseout(s){this._map.fire(new Hn(s.type,this._map,s))}touchstart(s){return this._firePreventable(new lr(s.type,this._map,s))}touchmove(s){this._map.fire(new lr(s.type,this._map,s))}touchend(s){this._map.fire(new lr(s.type,this._map,s))}touchcancel(s){this._map.fire(new lr(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ks{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new Hn(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Hn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new Hn(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class As{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(a.P.convert(s),this._map.terrain)}}class Xa{constructor(s,i){this._map=s,this._tr=new As(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,i){this.isEnabled()&&s.shiftKey&&s.button===0&&(ue.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(s,i){if(!this._active)return;const r=i;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const l=this._startPos;this._lastPos=r,this._box||(this._box=ue.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const d=Math.min(l.x,r.x),_=Math.max(l.x,r.x),w=Math.min(l.y,r.y),T=Math.max(l.y,r.y);ue.setTransform(this._box,`translate(${d}px,${w}px)`),this._box.style.width=_-d+"px",this._box.style.height=T-w+"px"}mouseupWindow(s,i){if(!this._active||s.button!==0)return;const r=this._startPos,l=i;if(this.reset(),ue.suppressClick(),r.x!==l.x||r.y!==l.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:s})),{cameraAnimation:d=>d.fitScreenCoordinates(r,l,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ue.remove(this._box),this._box=null),ue.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,i){return this._map.fire(new a.k(s,{originalEvent:i}))}}function mo(y,s){if(y.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${s.length}`);const i={};for(let r=0;r<y.length;r++)i[y[r].identifier]=s[r];return i}class rs{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),r.length===this.numTouches&&(this.centroid=function(l){const d=new a.P(0,0);for(const _ of l)d._add(_);return d.div(l.length)}(i),this.touches=mo(r,i)))}touchmove(s,i,r){if(this.aborted||!this.centroid)return;const l=mo(r,i);for(const d in this.touches){const _=l[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}touchend(s,i,r){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),r.length===0){const l=!this.aborted&&this.centroid;if(this.reset(),l)return l}}}class Qu{constructor(s){this.singleTap=new rs(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,i,r){this.singleTap.touchstart(s,i,r)}touchmove(s,i,r){this.singleTap.touchmove(s,i,r)}touchend(s,i,r){const l=this.singleTap.touchend(s,i,r);if(l){const d=s.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(l)<30;if(d&&_||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}}}class Ru{constructor(s){this._tr=new As(s),this._zoomIn=new Qu({numTouches:1,numTaps:2}),this._zoomOut=new Qu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,i,r){this._zoomIn.touchstart(s,i,r),this._zoomOut.touchstart(s,i,r)}touchmove(s,i,r){this._zoomIn.touchmove(s,i,r),this._zoomOut.touchmove(s,i,r)}touchend(s,i,r){const l=this._zoomIn.touchend(s,i,r),d=this._zoomOut.touchend(s,i,r),_=this._tr;return l?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(l)},{originalEvent:s})}):d?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(d)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class go{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const i=this._moveFunction(...s);if(i.bearingDelta||i.pitchDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(s,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=i.length?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,i){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const l=i.length?i[0]:i;return!this._moved&&l.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=l,this._move(r,l))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&ue.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ml={0:1,2:2};class Pn{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const i=ue.mouseButton(s);this._eventButton=i}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(i,r){const l=Ml[r];return i.buttons===void 0||(i.buttons&l)!==l}(s,this._eventButton)}isValidEndEvent(s){return ue.mouseButton(s)===this._eventButton}}class Ma{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}const Sn=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=function(s){s.preventDefault()}},Fo=({enable:y,clickTolerance:s,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Pn({checkCorrectEvent:l=>ue.mouseButton(l)===0&&l.ctrlKey||ue.mouseButton(l)===2});return new go({clickTolerance:s,move:(l,d)=>({bearingDelta:(d.x-l.x)*i}),moveStateManager:r,enable:y,assignEvents:Sn})},Nl=({enable:y,clickTolerance:s,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Pn({checkCorrectEvent:l=>ue.mouseButton(l)===0&&l.ctrlKey||ue.mouseButton(l)===2});return new go({clickTolerance:s,move:(l,d)=>({pitchDelta:(d.y-l.y)*i}),moveStateManager:r,enable:y,assignEvents:Sn})};class En{constructor(s,i){this._clickTolerance=s.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(s,i,r){return this._calculateTransform(s,i,r)}touchmove(s,i,r){if(this._active&&!(r.length<this.minTouchs()))return s.preventDefault(),this._calculateTransform(s,i,r)}touchend(s,i,r){this._calculateTransform(s,i,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,i,r){r.length>0&&(this._active=!0);const l=mo(r,i),d=new a.P(0,0),_=new a.P(0,0);let w=0;for(const B in l){const j=l[B],Y=this._touches[B];Y&&(d._add(j),_._add(j.sub(Y)),w++,l[B]=j)}if(this._touches=l,w<this.minTouchs()||!_.mag())return;const T=_.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,i,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([i[0],i[1]]))}touchmove(s,i,r){if(!this._firstTwoTouches)return;s.preventDefault();const[l,d]=this._firstTwoTouches,_=Cn(r,i,l),w=Cn(r,i,d);if(!_||!w)return;const T=this._aroundCenter?null:_.add(w).div(2);return this._move([_,w],T,s)}touchend(s,i,r){if(!this._firstTwoTouches)return;const[l,d]=this._firstTwoTouches,_=Cn(r,i,l),w=Cn(r,i,d);_&&w||(this._active&&ue.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Cn(y,s,i){for(let r=0;r<y.length;r++)if(y[r].identifier===i)return s[r]}function _l(y,s){return Math.log(y/s)/Math.LN2}class uu extends Hl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,i){const r=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(_l(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_l(this._distance,r),pinchAround:i}}}function Fu(y,s){return 180*y.angleWith(s)/Math.PI}class Vl extends Hl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,i,r){const l=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fu(this._vector,l),pinchAround:i}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const i=25/(Math.PI*this._minDiameter)*360,r=Fu(s,this._startVector);return Math.abs(r)<i}}function yl(y){return Math.abs(y.y)>Math.abs(y.x)}class ta extends Hl{constructor(s){super(),this._currentTouchCount=0,this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,i,r){super.touchstart(s,i,r),this._currentTouchCount=r.length}_start(s){this._lastPoints=s,yl(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,i,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const l=s[0].sub(this._lastPoints[0]),d=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(l,d,r.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(l.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(s,i,r){if(this._valid!==void 0)return this._valid;const l=s.mag()>=2,d=i.mag()>=2;if(!l&&!d)return;if(!l||!d)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<100&&void 0;const _=s.y>0==i.y>0;return yl(s)&&yl(i)&&_}}const sc={panStep:100,bearingStep:15,pitchStep:10};class Wu{constructor(s){this._tr=new As(s);const i=sc;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let i=0,r=0,l=0,d=0,_=0;switch(s.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:s.shiftKey?r=-1:(s.preventDefault(),d=-1);break;case 39:s.shiftKey?r=1:(s.preventDefault(),d=1);break;case 38:s.shiftKey?l=1:(s.preventDefault(),_=-1);break;case 40:s.shiftKey?l=-1:(s.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(r=0,l=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:jl,zoom:i?Math.round(T.zoom)+i*(s.shiftKey?2:1):T.zoom,bearing:T.bearing+r*this._bearingStep,pitch:T.pitch+l*this._pitchStep,offset:[-d*this._panStep,-_*this._panStep],center:T.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function jl(y){return y*(2-y)}const fs=4.000244140625;class _a{constructor(s,i){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=s,this._tr=new As(s),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!s[this._map.cooperativeGestures._bypassKey])return;let i=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const r=ae.now(),l=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,i!==0&&i%fs==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),s.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=s,this._delta-=i,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=ue.mousePos(this._map.getCanvas(),s),r=this._tr;this._around=i.y>r.transform.height/2-r.transform.getHorizon()?a.M.convert(this._aroundCenter?r.center:r.unproject(i)):a.M.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>fs?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const B=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(B*T))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,r=this._startZoom,l=this._easing;let d,_=!1;if(this._type==="wheel"&&r&&l){const w=Math.min((ae.now()-this._lastWheelEventTime)/200,1),T=l(w);d=a.z.number(r,i,T),w<1?this._frameId||(this._frameId=!0):_=!0}else d=i,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!_,zoomDelta:d-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let i=a.b6;if(this._prevEase){const r=this._prevEase,l=(ae.now()-r.start)/r.duration,d=r.easing(l+.01)-r.easing(l),_=.27/Math.sqrt(d*d+1e-4)*.01,w=Math.sqrt(.0729-_*_);i=a.b5(_,w,.25,1)}return this._prevEase={start:ae.now(),duration:s,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class el{constructor(s,i){this._clickZoom=s,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _u{constructor(s){this._tr=new As(s),this.reset()}reset(){this._active=!1}dblclick(s,i){return s.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ou{constructor(){this._tap=new Qu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,i,r){if(!this._swipePoint)if(this._tapTime){const l=i[0],d=s.timeStamp-this._tapTime<500,_=this._tapPoint.dist(l)<30;d&&_?r.length>0&&(this._swipePoint=l,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(s,i,r)}touchmove(s,i,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const l=i[0],d=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(s,i,r)}touchend(s,i,r){if(this._tapTime)this._swipePoint&&r.length===0&&this.reset();else{const l=this._tap.touchend(s,i,r);l&&(this._tapTime=s.timeStamp,this._tapPoint=l)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cu{constructor(s,i,r){this._el=s,this._mousePan=i,this._touchPan=r}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nu{constructor(s,i,r){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=i,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class _r{constructor(s,i,r,l){this._el=s,this._touchZoom=i,this._touchRotate=r,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ds{constructor(s,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=s,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const s=this._map.getCanvasContainer();s.classList.add("maplibregl-cooperative-gestures"),this._container=ue.create("div","maplibregl-cooperative-gesture-screen",s);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),l=document.createElement("div");l.className="maplibregl-desktop-message",l.textContent=i,this._container.appendChild(l);const d=document.createElement("div");d.className="maplibregl-mobile-message",d.textContent=r,this._container.appendChild(d),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(ue.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(s){this._onCooperativeGesture(s.touches.length===1)}wheel(s){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!s[this._bypassKey])}_onCooperativeGesture(s){this._enabled&&s&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const gn=y=>y.zoom||y.drag||y.pitch||y.rotate;class jn extends a.k{}function Jn(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class tl{constructor(s,i){this.handleWindowEvent=l=>{this.handleEvent(l,`${l.type}Window`)},this.handleEvent=(l,d)=>{if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=l.type==="renderFrame"?void 0:l,w={needsRenderFrame:!1},T={},B={},j=l.touches,Y=j?this._getMapTouches(j):void 0,ce=Y?ue.touchPos(this._map.getCanvas(),Y):ue.mousePos(this._map.getCanvas(),l);for(const{handlerName:Re,handler:Be,allowed:Je}of this._handlers){if(!Be.isEnabled())continue;let xt;this._blockedByActive(B,Je,Re)?Be.reset():Be[d||l.type]&&(xt=Be[d||l.type](l,ce,Y),this.mergeHandlerResult(w,T,xt,Re,_),xt&&xt.needsRenderFrame&&this._triggerRenderFrame()),(xt||Be.isActive())&&(B[Re]=Be)}const Se={};for(const Re in this._previousActiveHandlers)B[Re]||(Se[Re]=_);this._previousActiveHandlers=B,(Object.keys(Se).length||Jn(w))&&(this._changes.push([w,T,Se]),this._triggerRenderFrame()),(Object.keys(B).length||Jn(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Te}=w;Te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Te(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xi(s),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[l,d,_]of this._listeners)ue.addEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[s,i,r]of this._listeners)ue.removeEventListener(s,i,s===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(s){const i=this._map,r=i.getCanvasContainer();this._add("mapEvent",new qs(i,s));const l=i.boxZoom=new Xa(i,s);this._add("boxZoom",l),s.interactive&&s.boxZoom&&l.enable();const d=i.cooperativeGestures=new ds(i,s.cooperativeGestures);this._add("cooperativeGestures",d),s.cooperativeGestures&&d.enable();const _=new Ru(i),w=new _u(i);i.doubleClickZoom=new el(w,_),this._add("tapZoom",_),this._add("clickZoom",w),s.interactive&&s.doubleClickZoom&&i.doubleClickZoom.enable();const T=new Ou;this._add("tapDragZoom",T);const B=i.touchPitch=new ta(i);this._add("touchPitch",B),s.interactive&&s.touchPitch&&i.touchPitch.enable(s.touchPitch);const j=Fo(s),Y=Nl(s);i.dragRotate=new Nu(s,j,Y),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]),s.interactive&&s.dragRotate&&i.dragRotate.enable();const ce=(({enable:xt,clickTolerance:at})=>{const ct=new Pn({checkCorrectEvent:Et=>ue.mouseButton(Et)===0&&!Et.ctrlKey});return new go({clickTolerance:at,move:(Et,wt)=>({around:wt,panDelta:wt.sub(Et)}),activateOnStart:!0,moveStateManager:ct,enable:xt,assignEvents:Sn})})(s),Se=new En(s,i);i.dragPan=new cu(r,ce,Se),this._add("mousePan",ce),this._add("touchPan",Se,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&i.dragPan.enable(s.dragPan);const Te=new Vl,Re=new uu;i.touchZoomRotate=new _r(r,Re,Te,T),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",Re,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&i.touchZoomRotate.enable(s.touchZoomRotate);const Be=i.scrollZoom=new _a(i,()=>this._triggerRenderFrame());this._add("scrollZoom",Be,["mousePan"]),s.interactive&&s.scrollZoom&&i.scrollZoom.enable(s.scrollZoom);const Je=i.keyboard=new Wu(i);this._add("keyboard",Je),s.interactive&&s.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new ks(i))}_add(s,i,r){this._handlers.push({handlerName:s,handler:i,allowed:r}),this._handlersById[s]=i}stop(s){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!gn(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,i,r){for(const l in s)if(l!==r&&(!i||i.indexOf(l)<0))return!0;return!1}_getMapTouches(s){const i=[];for(const r of s)this._el.contains(r.target)&&i.push(r);return i}mergeHandlerResult(s,i,r,l,d){if(!r)return;a.e(s,r);const _={handlerName:l,originalEvent:r.originalEvent||d};r.zoomDelta!==void 0&&(i.zoom=_),r.panDelta!==void 0&&(i.drag=_),r.pitchDelta!==void 0&&(i.pitch=_),r.bearingDelta!==void 0&&(i.rotate=_)}_applyChanges(){const s={},i={},r={};for(const[l,d,_]of this._changes)l.panDelta&&(s.panDelta=(s.panDelta||new a.P(0,0))._add(l.panDelta)),l.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+l.zoomDelta),l.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+l.bearingDelta),l.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+l.pitchDelta),l.around!==void 0&&(s.around=l.around),l.pinchAround!==void 0&&(s.pinchAround=l.pinchAround),l.noInertia&&(s.noInertia=l.noInertia),a.e(i,d),a.e(r,_);this._updateMapTransform(s,i,r),this._changes=[]}_updateMapTransform(s,i,r){const l=this._map,d=l._getTransformForUpdate(),_=l.terrain;if(!(Jn(s)||_&&this._terrainMovement))return this._fireEvents(i,r,!0);let{panDelta:w,zoomDelta:T,bearingDelta:B,pitchDelta:j,around:Y,pinchAround:ce}=s;ce!==void 0&&(Y=ce),l._stop(!0),Y=Y||l.transform.centerPoint;const Se=d.pointLocation(w?Y.sub(w):Y);B&&(d.bearing+=B),j&&(d.pitch+=j),T&&(d.zoom+=T),_?this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?d.center=d.pointLocation(d.centerPoint.sub(w)):d.setLocationAtPoint(Se,Y):(this._terrainMovement=!0,this._map._elevationFreeze=!0,d.setLocationAtPoint(Se,Y),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,d.recalculateZoom(l.terrain)})):d.setLocationAtPoint(Se,Y),l._applyUpdatedTransform(d),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(i,r,!0)}_fireEvents(s,i,r){const l=gn(this._eventsInProgress),d=gn(s),_={};for(const j in s){const{originalEvent:Y}=s[j];this._eventsInProgress[j]||(_[`${j}start`]=Y),this._eventsInProgress[j]=s[j]}!l&&d&&this._fireEvent("movestart",d.originalEvent);for(const j in _)this._fireEvent(j,_[j]);d&&this._fireEvent("move",d.originalEvent);for(const j in s){const{originalEvent:Y}=s[j];this._fireEvent(j,Y)}const w={};let T;for(const j in this._eventsInProgress){const{handlerName:Y,originalEvent:ce}=this._eventsInProgress[j];this._handlersById[Y].isActive()||(delete this._eventsInProgress[j],T=i[Y]||ce,w[`${j}end`]=T)}for(const j in w)this._fireEvent(j,w[j]);const B=gn(this._eventsInProgress);if(r&&(l||d)&&!B){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;!j||!j.essential&&ae.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:T})),Y(this._map.getBearing())&&this._map.resetNorth()):(Y(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(s,i){this._map.fire(new a.k(s,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new jn("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Tu extends a.E{constructor(s,i){super(),this._renderFrameCallback=()=>{const r=Math.min((ae.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=i.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.M(this.transform.center.lng,this.transform.center.lat)}setCenter(s,i){return this.jumpTo({center:s},i)}panBy(s,i,r){return s=a.P.convert(s).mult(-1),this.panTo(this.transform.center,a.e({offset:s},i),r)}panTo(s,i,r){return this.easeTo(a.e({center:s},i),r)}getZoom(){return this.transform.zoom}setZoom(s,i){return this.jumpTo({zoom:s},i),this}zoomTo(s,i,r){return this.easeTo(a.e({zoom:s},i),r)}zoomIn(s,i){return this.zoomTo(this.getZoom()+1,s,i),this}zoomOut(s,i){return this.zoomTo(this.getZoom()-1,s,i),this}getBearing(){return this.transform.bearing}setBearing(s,i){return this.jumpTo({bearing:s},i),this}getPadding(){return this.transform.padding}setPadding(s,i){return this.jumpTo({padding:s},i),this}rotateTo(s,i,r){return this.easeTo(a.e({bearing:s},i),r)}resetNorth(s,i){return this.rotateTo(0,a.e({duration:1e3},s),i),this}resetNorthPitch(s,i){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},s),i),this}snapToNorth(s,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,i):this}getPitch(){return this.transform.pitch}setPitch(s,i){return this.jumpTo({pitch:s},i),this}cameraForBounds(s,i){s=fi.convert(s);const r=i&&i.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),r,i)}_cameraForBoxAndBearing(s,i,r,l){const d={top:0,bottom:0,right:0,left:0};if(typeof(l=a.e({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const ji=l.padding;l.padding={top:ji,bottom:ji,right:ji,left:ji}}l.padding=a.e(d,l.padding);const _=this.transform,w=_.padding,T=new fi(s,i),B=_.project(T.getNorthWest()),j=_.project(T.getNorthEast()),Y=_.project(T.getSouthEast()),ce=_.project(T.getSouthWest()),Se=a.b7(-r),Te=B.rotate(Se),Re=j.rotate(Se),Be=Y.rotate(Se),Je=ce.rotate(Se),xt=new a.P(Math.max(Te.x,Re.x,Je.x,Be.x),Math.max(Te.y,Re.y,Je.y,Be.y)),at=new a.P(Math.min(Te.x,Re.x,Je.x,Be.x),Math.min(Te.y,Re.y,Je.y,Be.y)),ct=xt.sub(at),Et=(_.width-(w.left+w.right+l.padding.left+l.padding.right))/ct.x,wt=(_.height-(w.top+w.bottom+l.padding.top+l.padding.bottom))/ct.y;if(wt<0||Et<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ri=Math.min(_.scaleZoom(_.scale*Math.min(Et,wt)),l.maxZoom),Yt=a.P.convert(l.offset),ei=new a.P((l.padding.left-l.padding.right)/2,(l.padding.top-l.padding.bottom)/2).rotate(a.b7(r)),si=Yt.add(ei).mult(_.scale/_.zoomScale(ri));return{center:_.unproject(B.add(Y).div(2).sub(si)),zoom:ri,bearing:r}}fitBounds(s,i,r){return this._fitInternal(this.cameraForBounds(s,i),i,r)}fitScreenCoordinates(s,i,r,l,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(s)),this.transform.pointLocation(a.P.convert(i)),r,l),l,d)}_fitInternal(s,i,r){return s?(delete(i=a.e(s,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this}jumpTo(s,i){this.stop();const r=this._getTransformForUpdate();let l=!1,d=!1,_=!1;return"zoom"in s&&r.zoom!==+s.zoom&&(l=!0,r.zoom=+s.zoom),s.center!==void 0&&(r.center=a.M.convert(s.center)),"bearing"in s&&r.bearing!==+s.bearing&&(d=!0,r.bearing=+s.bearing),"pitch"in s&&r.pitch!==+s.pitch&&(_=!0,r.pitch=+s.pitch),s.padding==null||r.isPaddingEqual(s.padding)||(r.padding=s.padding),this._applyUpdatedTransform(r),this.fire(new a.k("movestart",i)).fire(new a.k("move",i)),l&&this.fire(new a.k("zoomstart",i)).fire(new a.k("zoom",i)).fire(new a.k("zoomend",i)),d&&this.fire(new a.k("rotatestart",i)).fire(new a.k("rotate",i)).fire(new a.k("rotateend",i)),_&&this.fire(new a.k("pitchstart",i)).fire(new a.k("pitch",i)).fire(new a.k("pitchend",i)),this.fire(new a.k("moveend",i))}calculateCameraOptionsFromTo(s,i,r,l=0){const d=a.Y.fromLngLat(s,i),_=a.Y.fromLngLat(r,l),w=_.x-d.x,T=_.y-d.y,B=_.z-d.z,j=Math.hypot(w,T,B);if(j===0)throw new Error("Can't calculate camera options with same From and To");const Y=Math.hypot(w,T),ce=this.transform.scaleZoom(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Se=180*Math.atan2(w,-T)/Math.PI;let Te=180*Math.acos(Y/j)/Math.PI;return Te=B<0?90-Te:90+Te,{center:_.toLngLat(),zoom:ce,pitch:Te,bearing:Se}}easeTo(s,i){this._stop(!1,s.easeId),((s=a.e({offset:[0,0],duration:500,easing:a.b6},s)).animate===!1||!s.essential&&ae.prefersReducedMotion)&&(s.duration=0);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?+s.zoom:l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,Y="padding"in s?s.padding:r.padding,ce=a.P.convert(s.offset);let Se=r.centerPoint.add(ce);const Te=r.pointLocation(Se),Re=a.M.convert(s.center||Te);this._normalizeCenter(Re);const Be=r.project(Te),Je=r.project(Re).sub(Be),xt=r.zoomScale(T-l);let at,ct;s.around&&(at=a.M.convert(s.around),ct=r.locationPoint(at));const Et={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==l,this._rotating=this._rotating||d!==B,this._pitching=this._pitching||j!==_,this._padding=!r.isPaddingEqual(Y),this._easeId=s.easeId,this._prepareEase(i,s.noMoveStart,Et),this.terrain&&this._prepareElevation(Re),this._ease(wt=>{if(this._zooming&&(r.zoom=a.z.number(l,T,wt)),this._rotating&&(r.bearing=a.z.number(d,B,wt)),this._pitching&&(r.pitch=a.z.number(_,j,wt)),this._padding&&(r.interpolatePadding(w,Y,wt),Se=r.centerPoint.add(ce)),this.terrain&&!s.freezeElevation&&this._updateElevation(wt),at)r.setLocationAtPoint(at,ct);else{const ri=r.zoomScale(r.zoom-l),Yt=T>l?Math.min(2,xt):Math.max(.5,xt),ei=Math.pow(Yt,1-wt),si=r.unproject(Be.add(Je.mult(wt*ei)).mult(ri));r.setLocationAtPoint(r.renderWorldCopies?si.wrap():si,Se)}this._applyUpdatedTransform(r),this._fireMoveEvents(i)},wt=>{this.terrain&&this._finalizeElevation(),this._afterEase(i,wt)},s),this}_prepareEase(s,i,r={}){this._moving=!0,i||r.moving||this.fire(new a.k("movestart",s)),this._zooming&&!r.zooming&&this.fire(new a.k("zoomstart",s)),this._rotating&&!r.rotating&&this.fire(new a.k("rotatestart",s)),this._pitching&&!r.pitching&&this.fire(new a.k("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&i!==this._elevationTarget){const r=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(r-(i-(r*s+this._elevationStart))/(1-s)),this._elevationTarget=i}this.transform.elevation=a.z.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;const i=s.clone(),{center:r,zoom:l,pitch:d,bearing:_,elevation:w}=this.transformCameraUpdate(i);r&&(i.center=r),l!==void 0&&(i.zoom=l),d!==void 0&&(i.pitch=d),_!==void 0&&(i.bearing=_),w!==void 0&&(i.elevation=w),this.transform.apply(i)}_fireMoveEvents(s){this.fire(new a.k("move",s)),this._zooming&&this.fire(new a.k("zoom",s)),this._rotating&&this.fire(new a.k("rotate",s)),this._pitching&&this.fire(new a.k("pitch",s))}_afterEase(s,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const r=this._zooming,l=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new a.k("zoomend",s)),l&&this.fire(new a.k("rotateend",s)),d&&this.fire(new a.k("pitchend",s)),this.fire(new a.k("moveend",s))}flyTo(s,i){if(!s.essential&&ae.prefersReducedMotion){const Gi=a.L(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Gi,i)}this.stop(),s=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.b6},s);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?a.ac(+s.zoom,r.minZoom,r.maxZoom):l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,Y="padding"in s?s.padding:r.padding,ce=r.zoomScale(T-l),Se=a.P.convert(s.offset);let Te=r.centerPoint.add(Se);const Re=r.pointLocation(Te),Be=a.M.convert(s.center||Re);this._normalizeCenter(Be);const Je=r.project(Re),xt=r.project(Be).sub(Je);let at=s.curve;const ct=Math.max(r.width,r.height),Et=ct/ce,wt=xt.mag();if("minZoom"in s){const Gi=a.ac(Math.min(s.minZoom,l,T),r.minZoom,r.maxZoom),ln=ct/r.zoomScale(Gi-l);at=Math.sqrt(ln/wt*2)}const ri=at*at;function Yt(Gi){const ln=(Et*Et-ct*ct+(Gi?-1:1)*ri*ri*wt*wt)/(2*(Gi?Et:ct)*ri*wt);return Math.log(Math.sqrt(ln*ln+1)-ln)}function ei(Gi){return(Math.exp(Gi)-Math.exp(-Gi))/2}function si(Gi){return(Math.exp(Gi)+Math.exp(-Gi))/2}const ji=Yt(!1);let Qi=function(Gi){return si(ji)/si(ji+at*Gi)},Ei=function(Gi){return ct*((si(ji)*(ei(ln=ji+at*Gi)/si(ln))-ei(ji))/ri)/wt;var ln},Ui=(Yt(!0)-ji)/at;if(Math.abs(wt)<1e-6||!isFinite(Ui)){if(Math.abs(ct-Et)<1e-6)return this.easeTo(s,i);const Gi=Et<ct?-1:1;Ui=Math.abs(Math.log(Et/ct))/at,Ei=function(){return 0},Qi=function(ln){return Math.exp(Gi*at*ln)}}return s.duration="duration"in s?+s.duration:1e3*Ui/("screenSpeed"in s?+s.screenSpeed/at:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=d!==B,this._pitching=j!==_,this._padding=!r.isPaddingEqual(Y),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(Be),this._ease(Gi=>{const ln=Gi*Ui,Bn=1/Qi(ln);r.zoom=Gi===1?T:l+r.scaleZoom(Bn),this._rotating&&(r.bearing=a.z.number(d,B,Gi)),this._pitching&&(r.pitch=a.z.number(_,j,Gi)),this._padding&&(r.interpolatePadding(w,Y,Gi),Te=r.centerPoint.add(Se)),this.terrain&&!s.freezeElevation&&this._updateElevation(Gi);const rn=Gi===1?Be:r.unproject(Je.add(xt.mult(Ei(ln))).mult(Bn));r.setLocationAtPoint(r.renderWorldCopies?rn.wrap():rn,Te),this._applyUpdatedTransform(r),this._fireMoveEvents(i)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(i)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,i){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,i)}if(!s){const r=this.handlers;r&&r.stop(!1)}return this}_ease(s,i,r){r.animate===!1||r.duration===0?(s(1),i()):(this._easeStart=ae.now(),this._easeOptions=r,this._onEaseFrame=s,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,i){s=a.b0(s,-180,180);const r=Math.abs(s-i);return Math.abs(s-360-i)<r&&(s-=360),Math.abs(s+360-i)<r&&(s+=360),s}_normalizeCenter(s){const i=this.transform;if(!i.renderWorldCopies||i.lngRange)return;const r=s.lng-i.center.lng;s.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(a.M.convert(s),this.transform.tileZoom)-this.transform.elevation:null}}const oa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class yu{constructor(s=oa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options.compact,this._container=ue.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ue.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ue.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ue.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,i){const r=this._map._getUIString(`AttributionControl.${i}`);s.title=r,s.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(l=>typeof l!="string"?"":l)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const l=this._map.style.stylesheet;this.styleOwner=l.owner,this.styleId=l.id}const i=this._map.style.sourceCaches;for(const l in i){const d=i[l];if(d.used||d.usedForTerrain){const _=d.getSource();_.attribution&&s.indexOf(_.attribution)<0&&s.push(_.attribution)}}s=s.filter(l=>String(l).trim()),s.sort((l,d)=>l.length-d.length),s=s.filter((l,d)=>{for(let _=d+1;_<s.length;_++)if(s[_].indexOf(l)>=0)return!1;return!0});const r=s.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,s.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class vs{constructor(s={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const r=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&r.classList.add("maplibregl-compact"):r.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=ue.create("div","maplibregl-ctrl");const i=ue.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ue.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ko{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const i=++this._id;return this._queue.push({callback:s,id:i,cancelled:!1}),i}remove(s){const i=this._currentlyRunning,r=i?this._queue.concat(i):this._queue;for(const l of r)if(l.id===s)return void(l.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const r of i)if(!r.cancelled&&(r.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ki=a.X([{name:"a_pos3d",type:"Int16",components:3}]);class Bi extends a.E{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,i){this.sourceCache.update(s,i),this._renderableTilesKeys=[];const r={};for(const l of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))r[l.key]=!0,this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),a.aN(l.posMatrix,0,a.W,0,a.W,0,1),this._tiles[l.key]=new te(l,this.tileSize));for(const l in this._tiles)r[l]||delete this._tiles[l]}freeRtt(s){for(const i in this._tiles){const r=this._tiles[i];(!s||r.tileID.equals(s)||r.tileID.isChildOf(s)||s.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const i={};for(const r of this._renderableTilesKeys){const l=this._tiles[r].tileID;if(l.canonical.equals(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16),a.aN(d.posMatrix,0,a.W,0,a.W,0,1),i[r]=d}else if(l.canonical.isChildOf(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=l.canonical.z-s.canonical.z,w=l.canonical.x-(l.canonical.x>>_<<_),T=l.canonical.y-(l.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,B,0,B,0,1),a.H(d.posMatrix,d.posMatrix,[-w*B,-T*B,0]),i[r]=d}else if(s.canonical.isChildOf(l.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=s.canonical.z-l.canonical.z,w=s.canonical.x-(s.canonical.x>>_<<_),T=s.canonical.y-(s.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,a.W,0,a.W,0,1),a.H(d.posMatrix,d.posMatrix,[w*B,T*B,0]),a.J(d.posMatrix,d.posMatrix,[1/2**_,1/2**_,0]),i[r]=d}}return i}getSourceTile(s,i){const r=this.sourceCache._source;let l=s.overscaledZ-this.deltaZoom;if(l>r.maxzoom&&(l=r.maxzoom),l<r.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(l).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!d||!d.dem)&&i)for(;l>=r.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(s.scaledTo(l--).key);return d}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(i=>i.timeAdded>=s)}}class xs{constructor(s,i,r){this.painter=s,this.sourceCache=new Bi(i),this.options=r,this.exaggeration=typeof r.exaggeration=="number"?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,i,r,l=a.W){var d;if(!(i>=0&&i<l&&r>=0&&r<l))return 0;const _=this.getTerrainData(s),w=(d=_.tile)===null||d===void 0?void 0:d.dem;if(!w)return 0;const T=function(Te,Re,Be){var Je=Re[0],xt=Re[1];return Te[0]=Be[0]*Je+Be[4]*xt+Be[12],Te[1]=Be[1]*Je+Be[5]*xt+Be[13],Te}([],[i/l*a.W,r/l*a.W],_.u_terrain_matrix),B=[T[0]*w.dim,T[1]*w.dim],j=Math.floor(B[0]),Y=Math.floor(B[1]),ce=B[0]-j,Se=B[1]-Y;return w.get(j,Y)*(1-ce)*(1-Se)+w.get(j+1,Y)*ce*(1-Se)+w.get(j,Y+1)*(1-ce)*Se+w.get(j+1,Y+1)*ce*Se}getElevationForLngLatZoom(s,i){const{tileID:r,mercatorX:l,mercatorY:d}=this._getOverscaledTileIDFromLngLatZoom(s,i);return this.getElevation(r,l%a.W,d%a.W,a.W)}getElevation(s,i,r,l=a.W){return this.getDEMElevation(s,i,r,l)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const l=this.painter.context,d=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new bt(l,d,l.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new bt(l,new a.R({width:1,height:1}),l.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.an([])}const i=this.sourceCache.getSourceTile(s,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const l=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new bt(l,i.dem.getPixels(),l.gl.RGBA,{premultiply:!1}),i.demTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const r=i&&i+i.tileID.key+s.key;if(r&&!this._demMatrixCache[r]){const l=this.sourceCache.sourceCache._source.maxzoom;let d=s.canonical.z-i.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=l?d=s.canonical.z-l:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=s.canonical.x-(s.canonical.x>>d<<d),w=s.canonical.y-(s.canonical.y>>d<<d),T=a.b8(new Float64Array(16),[1/(a.W<<d),1/(a.W<<d),0]);a.H(T,T,[_*a.W,w*a.W,0]),this._demMatrixCache[s.key]={matrix:T,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(s){const i=this.painter,r=i.width/devicePixelRatio,l=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===l||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new bt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new bt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(r,l,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,r,l))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,_=0;d<this._coordsTextureSize;d++)for(let w=0;w<this._coordsTextureSize;w++,_+=4)i[_+0]=255&w,i[_+1]=255&d,i[_+2]=w>>8<<4|d>>8,i[_+3]=0;const r=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),l=new bt(s,r,s.gl.RGBA,{premultiply:!1});return l.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=l,l}pointCoordinate(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null);const d=i[0]+(i[2]>>4<<8),_=i[1]+((15&i[2])<<8),w=this.coordsIndex[255-i[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const B=this._coordsTextureSize,j=(1<<T.tileID.canonical.z)*B;return new a.Y((T.tileID.canonical.x*B+d)/j+T.tileID.wrap,(T.tileID.canonical.y*B+_)/j,this.getElevation(T.tileID,d,_,B))}depthAtPoint(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.painter.context,i=new a.b9,r=new a.aX,l=this.meshSize,d=a.W/l,_=l*l;for(let Y=0;Y<=l;Y++)for(let ce=0;ce<=l;ce++)i.emplaceBack(ce*d,Y*d,0);for(let Y=0;Y<_;Y+=l+1)for(let ce=0;ce<l;ce++)r.emplaceBack(ce+Y,l+ce+Y+1,l+ce+Y+2),r.emplaceBack(ce+Y,l+ce+Y+2,ce+Y+1);const w=i.length,T=w+2*(l+1);for(const Y of[0,1])for(let ce=0;ce<=l;ce++)for(const Se of[0,1])i.emplaceBack(ce*d,Y*a.W,Se);for(let Y=0;Y<2*l;Y+=2)r.emplaceBack(T+Y,T+Y+1,T+Y+3),r.emplaceBack(T+Y,T+Y+3,T+Y+2),r.emplaceBack(w+Y,w+Y+3,w+Y+1),r.emplaceBack(w+Y,w+Y+2,w+Y+3);const B=i.length,j=B+2*(l+1);for(const Y of[0,1])for(let ce=0;ce<=l;ce++)for(const Se of[0,1])i.emplaceBack(Y*a.W,ce*d,Se);for(let Y=0;Y<2*l;Y+=2)r.emplaceBack(B+Y,B+Y+1,B+Y+3),r.emplaceBack(B+Y,B+Y+3,B+Y+2),r.emplaceBack(j+Y,j+Y+3,j+Y+1),r.emplaceBack(j+Y,j+Y+2,j+Y+3);return this._mesh={indexBuffer:s.createIndexBuffer(r),vertexBuffer:s.createVertexBuffer(i,ki.members),segments:a.$.simpleSegment(0,0,i.length,r.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*a.ba/Math.pow(2,s)/5}getMinTileElevationForLngLatZoom(s,i){var r;const{tileID:l}=this._getOverscaledTileIDFromLngLatZoom(s,i);return(r=this.getMinMaxElevation(l).minElevation)!==null&&r!==void 0?r:0}getMinMaxElevation(s){const i=this.getTerrainData(s).tile,r={minElevation:null,maxElevation:null};return i&&i.dem&&(r.minElevation=i.dem.min*this.exaggeration,r.maxElevation=i.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(s,i){const r=a.Y.fromLngLat(s.wrap()),l=(1<<i)*a.W,d=r.x*l,_=r.y*l,w=Math.floor(d/a.W),T=Math.floor(_/a.W);return{tileID:new a.Q(i,0,i,w,T),mercatorX:d,mercatorY:_}}}class vu{constructor(s,i,r){this._context=s,this._size=i,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new bt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(r.texture),{id:s,fbo:i,texture:r,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>s.id!==i),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}const Oo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class cs{constructor(s,i){this.painter=s,this.terrain=i,this.pool=new vu(s.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(r=>!s._layers[r].isHidden(i)),this._coordsDescendingInv={};for(const r in s.sourceCaches){this._coordsDescendingInv[r]={};const l=s.sourceCaches[r].getVisibleCoordinates();for(const d of l){const _=this.terrain.sourceCache.getTerrainCoords(d);for(const w in _)this._coordsDescendingInv[r][w]||(this._coordsDescendingInv[r][w]=[]),this._coordsDescendingInv[r][w].push(_[w])}}this._coordsDescendingInvStr={};for(const r of s._order){const l=s._layers[r],d=l.source;if(Oo[l.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const _ in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][_]=this._coordsDescendingInv[d][_].map(w=>w.key).sort().join()}}for(const r of this._renderableTiles)for(const l in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[l][r.tileID.key];d&&d!==r.rttCoords[l]&&(r.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;const i=s.type,r=this.painter,l=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(Oo[i]&&(this._prevType&&Oo[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(s.id),!l))return!0;if(Oo[this._prevType]||Oo[i]&&l){this._prevType=i;const d=this._stacks.length-1,_=this._stacks[d]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[d]){const B=this.pool.getObjectForId(w.rtt[d].id);if(B.stamp===w.rtt[d].stamp){this.pool.useObject(B);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[d]={id:T.id,stamp:T.stamp},r.context.bindFramebuffer.set(T.fbo.framebuffer),r.context.clear({color:a.aO.transparent,stencil:0}),r.currentStencilSource=void 0;for(let B=0;B<_.length;B++){const j=r.style._layers[_[B]],Y=j.source?this._coordsDescendingInv[j.source][w.tileID.key]:[w.tileID];r.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),r._renderTileClippingMasks(j,Y),r.renderLayer(r,r.style.sourceCaches[j.source],j,Y),j.source&&(w.rttCoords[j.source]=this._coordsDescendingInvStr[j.source][w.tileID.key])}}return ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Oo[i]}return!1}}const hl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ms=G,C={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:oa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},D=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},z={showCompass:!0,showZoom:!0,visualizePitch:!1};class R{constructor(s,i,r=!1){this.mousedown=_=>{this.startMouse(a.e({},_,{ctrlKey:!0,preventDefault:()=>_.preventDefault()}),ue.mousePos(this.element,_)),ue.addEventListener(window,"mousemove",this.mousemove),ue.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.moveMouse(_,ue.mousePos(this.element,_))},this.mouseup=_=>{this.mouseRotate.dragEnd(_),this.mousePitch&&this.mousePitch.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ue.touchPos(this.element,_.targetTouches)[0],this.startTouch(_,this._startPos),ue.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=ue.touchPos(this.element,_.targetTouches)[0],this.moveTouch(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const l=s.dragRotate._mouseRotate.getClickTolerance(),d=s.dragRotate._mousePitch.getClickTolerance();this.element=i,this.mouseRotate=Fo({clickTolerance:l,enable:!0}),this.touchRotate=(({enable:_,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const B=new Ma;return new go({clickTolerance:w,move:(j,Y)=>({bearingDelta:(Y.x-j.x)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:l,enable:!0}),this.map=s,r&&(this.mousePitch=Nl({clickTolerance:d,enable:!0}),this.touchPitch=(({enable:_,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const B=new Ma;return new go({clickTolerance:w,move:(j,Y)=>({pitchDelta:(Y.y-j.y)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:d,enable:!0})),ue.addEventListener(i,"mousedown",this.mousedown),ue.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),ue.addEventListener(i,"touchcancel",this.reset)}startMouse(s,i){this.mouseRotate.dragStart(s,i),this.mousePitch&&this.mousePitch.dragStart(s,i),ue.disableDrag()}startTouch(s,i){this.touchRotate.dragStart(s,i),this.touchPitch&&this.touchPitch.dragStart(s,i),ue.disableDrag()}moveMouse(s,i){const r=this.map,{bearingDelta:l}=this.mouseRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.mousePitch){const{pitchDelta:d}=this.mousePitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}moveTouch(s,i){const r=this.map,{bearingDelta:l}=this.touchRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.touchPitch){const{pitchDelta:d}=this.touchPitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}off(){const s=this.element;ue.removeEventListener(s,"mousedown",this.mousedown),ue.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),ue.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.removeEventListener(window,"touchend",this.touchend),ue.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){ue.enableDrag(),ue.removeEventListener(window,"mousemove",this.mousemove),ue.removeEventListener(window,"mouseup",this.mouseup),ue.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.removeEventListener(window,"touchend",this.touchend)}}let ee;function le(y,s,i){const r=new a.M(y.lng,y.lat);if(y=new a.M(y.lng,y.lat),s){const l=new a.M(y.lng-360,y.lat),d=new a.M(y.lng+360,y.lat),_=i.locationPoint(y).distSqr(s);i.locationPoint(l).distSqr(s)<_?y=l:i.locationPoint(d).distSqr(s)<_&&(y=d)}for(;Math.abs(y.lng-i.center.lng)>180;){const l=i.locationPoint(y);if(l.x>=0&&l.y>=0&&l.x<=i.width&&l.y<=i.height)break;y.lng>i.center.lng?y.lng-=360:y.lng+=360}return y.lng!==r.lng&&i.locationPoint(y).y>i.height/2-i.getHorizon()?y:r}const oe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function we(y,s,i){const r=y.classList;for(const l in oe)r.remove(`maplibregl-${i}-anchor-${l}`);r.add(`maplibregl-${i}-anchor-${s}`)}class We extends a.E{constructor(s){if(super(),this._onKeyPress=i=>{const r=i.code,l=i.charCode||i.keyCode;r!=="Space"&&r!=="Enter"&&l!==32&&l!==13||this.togglePopup()},this._onMapClick=i=>{const r=i.originalEvent.target,l=this._element;this._popup&&(r===l||l.contains(r))&&this.togglePopup()},this._update=i=>{var r;if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?le(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),i&&i.type!=="moveend"||(this._pos=this._pos.round()),ue.setTransform(this._element,`${oe[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${d}`),ae.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const r=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(s==null?void 0:s.opacity,s==null?void 0:s.opacityWhenCovered),s&&s.element)this._element=s.element,this._offset=a.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=ue.create("div"),this._element.setAttribute("aria-label","Map marker");const i=ue.createNS("http://www.w3.org/2000/svg","svg"),r=41,l=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${r}px`),i.setAttributeNS(null,"width",`${l}px`),i.setAttributeNS(null,"viewBox",`0 0 ${l} ${r}`);const d=ue.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"stroke","none"),d.setAttributeNS(null,"stroke-width","1"),d.setAttributeNS(null,"fill","none"),d.setAttributeNS(null,"fill-rule","evenodd");const _=ue.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const w=ue.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Je of T){const xt=ue.createNS("http://www.w3.org/2000/svg","ellipse");xt.setAttributeNS(null,"opacity","0.04"),xt.setAttributeNS(null,"cx","10.5"),xt.setAttributeNS(null,"cy","5.80029008"),xt.setAttributeNS(null,"rx",Je.rx),xt.setAttributeNS(null,"ry",Je.ry),w.appendChild(xt)}const B=ue.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const j=ue.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(j);const Y=ue.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const ce=ue.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(ce);const Se=ue.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Se.setAttributeNS(null,"fill","#FFFFFF");const Te=ue.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Re=ue.createNS("http://www.w3.org/2000/svg","circle");Re.setAttributeNS(null,"fill","#000000"),Re.setAttributeNS(null,"opacity","0.25"),Re.setAttributeNS(null,"cx","5.5"),Re.setAttributeNS(null,"cy","5.5"),Re.setAttributeNS(null,"r","5.4999962");const Be=ue.createNS("http://www.w3.org/2000/svg","circle");Be.setAttributeNS(null,"fill","#FFFFFF"),Be.setAttributeNS(null,"cx","5.5"),Be.setAttributeNS(null,"cy","5.5"),Be.setAttributeNS(null,"r","5.4999962"),Te.appendChild(Re),Te.appendChild(Be),_.appendChild(w),_.appendChild(B),_.appendChild(Y),_.appendChild(Se),_.appendChild(Te),i.appendChild(_),i.setAttributeNS(null,"height",r*this._scale+"px"),i.setAttributeNS(null,"width",l*this._scale+"px"),this._element.appendChild(i),this._offset=a.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),we(this._element,this._anchor,"marker"),s&&s.className)for(const i of s.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ue.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.M.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const l=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(38.1-13.5+l)],"bottom-right":[-l,-1*(38.1-13.5+l)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():(s.setLngLat(this._lngLat),s.addTo(this._map)),this):this}_updateOpacity(s=!1){var i;if(!(!((i=this._map)===null||i===void 0)&&i.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(s)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const r=this._map,l=r.terrain.depthAtPoint(this._pos),d=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom);if(r.transform.lngLatToCameraDepth(this._lngLat,d)-l<.006)return void(this._element.style.opacity=this._opacity);const _=-this._offset.y/r.transform._pixelPerMeter,w=Math.sin(r.getPitch()*Math.PI/180)*_,T=r.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),B=r.transform.lngLatToCameraDepth(this._lngLat,d+w);this._element.style.opacity=B-T>.006?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(s){return this._offset=a.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(s,i){return s===void 0&&i===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),s!==void 0&&(this._opacity=s),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const vt={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ct=0,ni=!1;const Gt={maxWidth:100,unit:"metric"};function jt(y,s,i){const r=i&&i.maxWidth||100,l=y._container.clientHeight/2,d=y.unproject([0,l]),_=y.unproject([r,l]),w=d.distanceTo(_);if(i&&i.unit==="imperial"){const T=3.2808*w;T>5280?Z(s,r,T/5280,y._getUIString("ScaleControl.Miles")):Z(s,r,T,y._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?Z(s,r,w/1852,y._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Z(s,r,w/1e3,y._getUIString("ScaleControl.Kilometers")):Z(s,r,w,y._getUIString("ScaleControl.Meters"))}function Z(y,s,i,r){const l=function(d){const _=Math.pow(10,`${Math.floor(d)}`.length-1);let w=d/_;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const B=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*B)/B}(w),_*w}(i);y.style.width=s*(l/i)+"px",y.innerHTML=`${l}&nbsp;${r}`}const A={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},E=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function F(y){if(y){if(typeof y=="number"){const s=Math.round(Math.abs(y)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,y),"top-left":new a.P(s,s),"top-right":new a.P(-s,s),bottom:new a.P(0,-y),"bottom-left":new a.P(s,-s),"bottom-right":new a.P(-s,-s),left:new a.P(y,0),right:new a.P(-y,0)}}if(y instanceof a.P||Array.isArray(y)){const s=a.P.convert(y);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:a.P.convert(y.center||[0,0]),top:a.P.convert(y.top||[0,0]),"top-left":a.P.convert(y["top-left"]||[0,0]),"top-right":a.P.convert(y["top-right"]||[0,0]),bottom:a.P.convert(y.bottom||[0,0]),"bottom-left":a.P.convert(y["bottom-left"]||[0,0]),"bottom-right":a.P.convert(y["bottom-right"]||[0,0]),left:a.P.convert(y.left||[0,0]),right:a.P.convert(y.right||[0,0])}}return F(new a.P(0,0))}const O=G;I.AJAXError=a.bd,I.Evented=a.E,I.LngLat=a.M,I.MercatorCoordinate=a.Y,I.Point=a.P,I.addProtocol=a.be,I.config=a.a,I.removeProtocol=a.bf,I.AttributionControl=yu,I.BoxZoomHandler=Xa,I.CanvasSource=Qn,I.CooperativeGesturesHandler=ds,I.DoubleClickZoomHandler=el,I.DragPanHandler=cu,I.DragRotateHandler=Nu,I.EdgeInsets=cl,I.FullscreenControl=class extends a.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var s;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((s=i==null?void 0:i.shadowRoot)===null||s===void 0)&&s.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ue.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=ue.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ue.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},I.GeoJSONSource=hi,I.GeolocateControl=class extends a.E{constructor(y){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",s)),this._finish()}},this._updateCamera=s=>{const i=new a.M(s.coords.longitude,s.coords.latitude),r=s.coords.accuracy,l=this._map.getBearing(),d=a.e({bearing:l},this.options.fitBoundsOptions),_=fi.fromLngLat(i,r);this._map.fitBounds(_,d,{geolocateSource:!0})},this._updateMarker=s=>{if(s){const i=new a.M(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(this.options.trackUserLocation)if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&ni)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=s=>{if(this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=ue.create("button","maplibregl-ctrl-geolocate",this._container),ue.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",s===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ue.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new We({element:this._dotElement}),this._circleElement=ue.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new We({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},vt,y)}onAdd(y){return this._map=y,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s=!1){return a._(this,void 0,void 0,function*(){if(ee!==void 0&&!s)return ee;if(window.navigator.permissions===void 0)return ee=!!window.navigator.geolocation,ee;try{ee=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ee=!!window.navigator.geolocation}return ee})}().then(s=>this._setupUI(s)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ue.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ct=0,ni=!1}_isOutOfMapMaxBounds(y){const s=this._map.getMaxBounds(),i=y.coords;return s&&(i.longitude<s.getWest()||i.longitude>s.getEast()||i.latitude<s.getSouth()||i.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),s=y.getSouthEast(),i=y.getNorthEast(),r=s.distanceTo(i),l=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ct--,ni=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ct++,Ct>1?(y={maximumAge:6e5,timeout:0},ni=!0):(y=this.options.positionOptions,ni=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},I.Hash=ro,I.ImageSource=tr,I.KeyboardHandler=Wu,I.LngLatBounds=fi,I.LogoControl=vs,I.Map=class extends Tu{constructor(y){if(a.bb.mark(a.bc.create),(y=a.e({},C,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new lu(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new ko,this._controls=[],this._mapId=a.a3(),this._locale=a.e({},hl,y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this.transformCameraUpdate=y.transformCameraUpdate,this._imageQueueHandle=Tt.addThrottleControl(()=>this.isMoving()),this._requestManager=new zt(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const i=gl(r=>{this._trackResize&&!this._removed&&this.resize(r)._update()},50);this._resizeObserver=new ResizeObserver(r=>{s?i(r):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new tl(this,y),this._hash=y.hash&&new ro(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,a.e({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new yu(typeof y.attributionControl=="boolean"?void 0:y.attributionControl)),y.maplibreLogo&&this.addControl(new vs,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new a.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(y,s){if(s===void 0&&(s=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=y.onAdd(this);this._controls.push(y);const r=this._controlPositions[s];return s.indexOf("bottom")!==-1?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(y);return s>-1&&this._controls.splice(s,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,s,i,r){return r==null&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,s,i,r)}resize(y){var s;const i=this._containerDimensions(),r=i[0],l=i[1],d=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,d),this.painter.resize(r,l,d),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,T),this.painter.resize(r,l,T)}this.transform.resize(r,l),(s=this._requestedCameraState)===null||s===void 0||s.resize(r,l);const _=!this._moving;return _&&(this.stop(),this.fire(new a.k("movestart",y)).fire(new a.k("move",y))),this.fire(new a.k("resize",y)),_&&this.fire(new a.k("moveend",y)),this}_getClampedPixelRatio(y,s){const{0:i,1:r}=this._maxCanvasSize,l=this.getPixelRatio(),d=y*l,_=s*l;return Math.min(d>i?i/d:1,_>r?r/_:1)*l}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(fi.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(a.M.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(a.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,s,i){if(y==="mouseenter"||y==="mouseover"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:d=>{const _=this.getLayer(s)?this.queryRenderedFeatures(d.point,{layers:[s]}):[];_.length?r||(r=!0,i.call(this,new Hn(y,this,d.originalEvent,{features:_}))):r=!1},mouseout:()=>{r=!1}}}}if(y==="mouseleave"||y==="mouseout"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:_=>{(this.getLayer(s)?this.queryRenderedFeatures(_.point,{layers:[s]}):[]).length?r=!0:r&&(r=!1,i.call(this,new Hn(y,this,_.originalEvent)))},mouseout:_=>{r&&(r=!1,i.call(this,new Hn(y,this,_.originalEvent)))}}}}{const r=l=>{const d=this.getLayer(s)?this.queryRenderedFeatures(l.point,{layers:[s]}):[];d.length&&(l.features=d,i.call(this,l),delete l.features)};return{layer:s,listener:i,delegates:{[y]:r}}}}on(y,s,i){if(i===void 0)return super.on(y,s);const r=this._createDelegatedListener(y,s,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(r);for(const l in r.delegates)this.on(l,r.delegates[l]);return this}once(y,s,i){if(i===void 0)return super.once(y,s);const r=this._createDelegatedListener(y,s,i);for(const l in r.delegates)this.once(l,r.delegates[l]);return this}off(y,s,i){return i===void 0?super.off(y,s):(this._delegatedListeners&&this._delegatedListeners[y]&&(r=>{const l=this._delegatedListeners[y];for(let d=0;d<l.length;d++){const _=l[d];if(_.layer===s&&_.listener===i){for(const w in _.delegates)this.off(w,_.delegates[w]);return l.splice(d,1),this}}})(),this)}queryRenderedFeatures(y,s){if(!this.style)return[];let i;const r=y instanceof a.P||Array.isArray(y),l=r?y:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(r?{}:y)||{},l instanceof a.P||typeof l[0]=="number")i=[a.P.convert(l)];else{const d=a.P.convert(l[0]),_=a.P.convert(l[1]);i=[d,new a.P(_.x,d.y),_,new a.P(d.x,_.y),d]}return this.style.queryRenderedFeatures(i,s,this.transform)}querySourceFeatures(y,s){return this.style.querySourceFeatures(y,s)}setStyle(y,s){return(s=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(y,s))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const s=this._locale[y];if(s==null)throw new Error(`Missing UI string '${y}'`);return s}_updateStyle(y,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,s));const i=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Lt(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,s,i):this.style.loadJSON(y,s,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Lt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,s){if(typeof y=="string"){const i=this._requestManager.transformRequest(y,Pt.Style);a.h(i,new AbortController).then(r=>{this._updateDiff(r.data,s)}).catch(r=>{r&&this.fire(new a.j(r))})}else typeof y=="object"&&this._updateDiff(y,s)}_updateDiff(y,s){try{this.style.setState(y,s)&&this._update(!0)}catch(i){a.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(y,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(y,s){return this._lazyInitEmptyStyle(),this.style.addSource(y,s),this._update(!0)}isSourceLoaded(y){const s=this.style&&this.style.sourceCaches[y];if(s!==void 0)return s.loaded();this.fire(new a.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const s=this.style.sourceCaches[y.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&s.reload();for(const i in this.style._layers){const r=this.style._layers[i];r.type==="hillshade"&&r.source===y.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xs(this.painter,s,y),this.painter.renderToTexture=new cs(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:y})),this}getTerrain(){var y,s;return(s=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&s!==void 0?s:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const s in y){const i=y[s]._tiles;for(const r in i){const l=i[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,s,i={}){const{pixelRatio:r=1,sdf:l=!1,stretchX:d,stretchY:_,content:w}=i;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||a.b(s))){if(s.width===void 0||s.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:B,data:j}=s,Y=s;return this.style.addImage(y,{data:new a.R({width:T,height:B},new Uint8Array(j)),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,y),this}}{const{width:T,height:B,data:j}=ae.getImageData(s);this.style.addImage(y,{data:new a.R({width:T,height:B},j),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0})}}updateImage(y,s){const i=this.style.getImage(y);if(!i)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=s instanceof HTMLImageElement||a.b(s)?ae.getImageData(s):s,{width:l,height:d,data:_}=r;if(l===void 0||d===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(l!==i.data.width||d!==i.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(s instanceof HTMLImageElement||a.b(s));return i.data.replace(_,w),this.style.updateImage(y,i),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return Tt.getImage(this._requestManager.transformRequest(y,Pt.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,s){return this._lazyInitEmptyStyle(),this.style.addLayer(y,s),this._update(!0)}moveLayer(y,s){return this.style.moveLayer(y,s),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,s,i){return this.style.setLayerZoomRange(y,s,i),this._update(!0)}setFilter(y,s,i={}){return this.style.setFilter(y,s,i),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,s,i,r={}){return this.style.setPaintProperty(y,s,i,r),this._update(!0)}getPaintProperty(y,s){return this.style.getPaintProperty(y,s)}setLayoutProperty(y,s,i,r={}){return this.style.setLayoutProperty(y,s,i,r),this._update(!0)}getLayoutProperty(y,s){return this.style.getLayoutProperty(y,s)}setGlyphs(y,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,s,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,s,i,r=>{r||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,s,i=>{i||this._update(!0)}),this}setLight(y,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,s){return this.style.setFeatureState(y,s),this._update()}removeFeatureState(y,s){return this.style.removeFeatureState(y,s),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,s=0;return this._container&&(y=this._container.clientWidth||400,s=this._container.clientHeight||300),[y,s]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const s=this._canvasContainer=ue.create("div","maplibregl-canvas-container",y);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=ue.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),r=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],r);const l=this._controlContainer=ue.create("div","maplibregl-control-container",y),d=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{d[_]=ue.create("div",`maplibregl-ctrl-${_} `,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,s,i){this._canvas.width=Math.floor(i*y),this._canvas.height=Math.floor(i*s),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let s=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{s={requestedAttributes:y},r&&(s.statusMessage=r.statusMessage,s.type=r.type)},{once:!0});const i=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!i){const r="Failed to initialize WebGL";throw s?(s.message=r,new Error(JSON.stringify(s))):new Error(r)}this.painter=new Sa(i,this.transform),be.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const l=this.transform.zoom,d=ae.now();this.style.zoomHistory.update(l,d);const _=new a.a8(l,{now:d,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=_.crossFadingFactor();w===1&&w===this._crossFadingFactor||(i=!0,this._crossFadingFactor=w),this.style.update(_)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bb.mark(a.bc.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,a.bb.mark(a.bc.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Tt.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ue.remove(this._canvasContainer),ue.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),a.bb.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ae.frameAsync(this._frameRequest).then(y=>{a.bb.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Ms}getCameraTargetElevation(){return this.transform.elevation}},I.MapMouseEvent=Hn,I.MapTouchEvent=lr,I.MapWheelEvent=Yn,I.Marker=We,I.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const s=this._map.getZoom(),i=s===this._map.getMaxZoom(),r=s===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=s},this._setButtonTitle=(s,i)=>{const r=this._map._getUIString(`NavigationControl.${i}`);s.title=r,s.setAttribute("aria-label",r)},this.options=a.e({},z,y),this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),ue.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),ue.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=ue.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new R(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ue.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,s){const i=ue.create("button",y,this._container);return i.type="button",i.addEventListener("click",s),i}},I.Popup=class extends a.E{constructor(y){super(),this.remove=()=>(this._content&&ue.remove(this._content),this._container&&(ue.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{var i;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ue.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ue.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?le(this._lngLat,this._flatPos,this._map.transform):(i=this._lngLat)===null||i===void 0?void 0:i.wrap(),this._trackPointer&&!s)return;const r=this._flatPos=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&s?s:this._map.transform.locationPoint(this._lngLat));let l=this.options.anchor;const d=F(this.options.offset);if(!l){const w=this._container.offsetWidth,T=this._container.offsetHeight;let B;B=r.y+d.bottom.y<T?["top"]:r.y>this._map.transform.height-T?["bottom"]:[],r.x<w/2?B.push("left"):r.x>this._map.transform.width-w/2&&B.push("right"),l=B.length===0?"bottom":B.join("-")}let _=r.add(d[l]);this.options.subpixelPositioning||(_=_.round()),ue.setTransform(this._container,`${oe[l]} translate(${_.x}px,${_.y}px)`),we(this._container,l,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(A),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=a.M.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const s=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=y;r=i.firstChild,r;)s.appendChild(r);return this.setDOMContent(s)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ue.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=ue.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(E);y&&y.focus()}},I.RasterDEMTileSource=Rr,I.RasterTileSource=wn,I.ScaleControl=class{constructor(y){this._onMove=()=>{jt(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,jt(this._map,this._container,this.options)},this.options=a.e({},Gt,y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ue.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},I.ScrollZoomHandler=_a,I.Style=Lt,I.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ue.create("button","maplibregl-ctrl-terrain",this._container),ue.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ue.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},I.TwoFingersTouchPitchHandler=ta,I.TwoFingersTouchRotateHandler=Vl,I.TwoFingersTouchZoomHandler=uu,I.TwoFingersTouchZoomRotateHandler=_r,I.VectorTileSource=ii,I.VideoSource=Fn,I.addSourceType=(y,s)=>a._(void 0,void 0,void 0,function*(){if(v(y))throw new Error(`A source type called "${y}" already exists.`);((i,r)=>{In[i]=r})(y,s)}),I.clearPrewarmedResources=function(){const y=Ni;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Oi),Ni=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},I.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},I.getRTLTextPluginStatus=function(){return $().getRTLTextPluginStatus()},I.getVersion=function(){return O},I.getWorkerCount=function(){return tn.workerCount},I.getWorkerUrl=function(){return a.a.WORKER_URL},I.importScriptInWorkers=function(y){return gi().broadcast("importScript",y)},I.prewarm=function(){yn().acquire(Oi)},I.setMaxParallelImageRequests=function(y){a.a.MAX_PARALLEL_IMAGE_REQUESTS=y},I.setRTLTextPlugin=function(y,s){return $().setRTLTextPlugin(y,s)},I.setWorkerCount=function(y){tn.workerCount=y},I.setWorkerUrl=function(y){a.a.WORKER_URL=y}});var b=n;return b})})(A3);var gx=A3.exports;const Kp=aT();function aT(){const{subscribe:e,set:t,update:n}=ep(new Map);return{subscribe:e,set:t,update:n}}const Ry=ep(.78),oT=ep(1),Jg=ep({}),Y_=lT();function lT(){const{subscribe:e,set:t,update:n}=ep(null);return{subscribe:e,set:t,update:n}}function _x(e,t,n){const c=e.slice();return c[21]=t[n],c}function yx(e){let t,n=e[21]+"",c;return{c(){t=Nn("option"),c=Ja(n),this.h()},l(g){t=Vn(g,"OPTION",{});var b=bn(t);c=eo(b,n),b.forEach(bi),this.h()},h(){t.__value=e[21],nE(t,t.__value)},m(g,b){Gn(g,t,b),Zi(t,c)},p:wo,d(g){g&&bi(t)}}}function uT(e){let t,n,c,g="Palette",b,I,a,G,W,he="Show county lines?",ae,ue,be,Ke,ot,tt="Show ecoregions?",lt,ut,Tt,Pt,zt,Ge="Draw Mode?",Xt,rt,yt="Draw Polygon",pt,gt,bt="Reset",dt,$e,mt,st="Fill Opacity",Nt,Rt,Ot,_i,Si=ph(e[9]),Ti=[];for(let Oi=0;Oi<Si.length;Oi+=1)Ti[Oi]=yx(_x(e,Si,Oi));return{c(){t=Nn("div"),n=Nn("div"),c=Nn("h4"),c.textContent=g,b=Cr(),I=Nn("select");for(let Oi=0;Oi<Ti.length;Oi+=1)Ti[Oi].c();a=Cr(),G=Nn("div"),W=Nn("h4"),W.textContent=he,ae=Cr(),ue=Nn("input"),be=Cr(),Ke=Nn("div"),ot=Nn("h4"),ot.textContent=tt,lt=Cr(),ut=Nn("input"),Tt=Cr(),Pt=Nn("div"),zt=Nn("h4"),zt.textContent=Ge,Xt=Cr(),rt=Nn("button"),rt.textContent=yt,pt=Cr(),gt=Nn("button"),gt.textContent=bt,dt=Cr(),$e=Nn("div"),mt=Nn("h4"),mt.textContent=st,Nt=Cr(),Rt=Nn("input"),this.h()},l(Oi){t=Vn(Oi,"DIV",{class:!0});var tn=bn(t);n=Vn(tn,"DIV",{class:!0});var qi=bn(n);c=Vn(qi,"H4",{class:!0,"data-svelte-h":!0}),dc(c)!=="svelte-16skbun"&&(c.textContent=g),b=Tr(qi),I=Vn(qi,"SELECT",{label:!0});var Ni=bn(I);for(let Ri=0;Ri<Ti.length;Ri+=1)Ti[Ri].l(Ni);Ni.forEach(bi),qi.forEach(bi),a=Tr(tn),G=Vn(tn,"DIV",{class:!0});var nn=bn(G);W=Vn(nn,"H4",{class:!0,"data-svelte-h":!0}),dc(W)!=="svelte-tf6nwt"&&(W.textContent=he),ae=Tr(nn),ue=Vn(nn,"INPUT",{type:!0}),nn.forEach(bi),be=Tr(tn),Ke=Vn(tn,"DIV",{class:!0});var yn=bn(Ke);ot=Vn(yn,"H4",{class:!0,"data-svelte-h":!0}),dc(ot)!=="svelte-1f8vskc"&&(ot.textContent=tt),lt=Tr(yn),ut=Vn(yn,"INPUT",{type:!0}),yn.forEach(bi),Tt=Tr(tn),Pt=Vn(tn,"DIV",{class:!0});var Ci=bn(Pt);zt=Vn(Ci,"H4",{class:!0,"data-svelte-h":!0}),dc(zt)!=="svelte-hi5xw8"&&(zt.textContent=Ge),Xt=Tr(Ci),rt=Vn(Ci,"BUTTON",{"data-svelte-h":!0}),dc(rt)!=="svelte-o8r62u"&&(rt.textContent=yt),pt=Tr(Ci),gt=Vn(Ci,"BUTTON",{"data-svelte-h":!0}),dc(gt)!=="svelte-2y01av"&&(gt.textContent=bt),Ci.forEach(bi),dt=Tr(tn),$e=Vn(tn,"DIV",{class:!0});var gi=bn($e);mt=Vn(gi,"H4",{class:!0,"data-svelte-h":!0}),dc(mt)!=="svelte-1fb1xwq"&&(mt.textContent=st),Nt=Tr(gi),Rt=Vn(gi,"INPUT",{type:!0,min:!0,max:!0}),gi.forEach(bi),tn.forEach(bi),this.h()},h(){Pi(c,"class","svelte-11w56ip"),Pi(I,"label","Color Scheme"),e[5]===void 0&&tE(()=>e[11].call(I)),Pi(n,"class","control-item svelte-11w56ip"),Pi(W,"class","svelte-11w56ip"),Pi(ue,"type","checkbox"),Pi(G,"class","control-item svelte-11w56ip"),Pi(ot,"class","svelte-11w56ip"),Pi(ut,"type","checkbox"),Pi(Ke,"class","control-item svelte-11w56ip"),Pi(zt,"class","svelte-11w56ip"),Pi(Pt,"class","control-item svelte-11w56ip"),Pi(mt,"class","svelte-11w56ip"),Pi(Rt,"type","range"),Pi(Rt,"min","0"),Pi(Rt,"max","100"),Rt.value=e[8]*100,Pi($e,"class","control-item svelte-11w56ip"),Pi(t,"class","controls svelte-11w56ip")},m(Oi,tn){Gn(Oi,t,tn),Zi(t,n),Zi(n,c),Zi(n,b),Zi(n,I);for(let qi=0;qi<Ti.length;qi+=1)Ti[qi]&&Ti[qi].m(I,null);V2(I,e[5],!0),Zi(t,a),Zi(t,G),Zi(G,W),Zi(G,ae),Zi(G,ue),ue.checked=e[6],Zi(t,be),Zi(t,Ke),Zi(Ke,ot),Zi(Ke,lt),Zi(Ke,ut),ut.checked=e[7],Zi(t,Tt),Zi(t,Pt),Zi(Pt,zt),Zi(Pt,Xt),Zi(Pt,rt),Zi(Pt,pt),Zi(Pt,gt),Zi(t,dt),Zi(t,$e),Zi($e,mt),Zi($e,Nt),Zi($e,Rt),Ot||(_i=[Gl(I,"change",e[11]),Gl(I,"change",e[12]),Gl(ue,"change",e[13]),Gl(ue,"change",e[14]),Gl(ut,"change",e[15]),Gl(ut,"change",e[16]),Gl(rt,"click",e[17]),Gl(gt,"click",e[18]),Gl(Rt,"input",e[19])],Ot=!0)},p(Oi,[tn]){if(tn&512){Si=ph(Oi[9]);let qi;for(qi=0;qi<Si.length;qi+=1){const Ni=_x(Oi,Si,qi);Ti[qi]?Ti[qi].p(Ni,tn):(Ti[qi]=yx(Ni),Ti[qi].c(),Ti[qi].m(I,null))}for(;qi<Ti.length;qi+=1)Ti[qi].d(1);Ti.length=Si.length}tn&544&&V2(I,Oi[5]),tn&64&&(ue.checked=Oi[6]),tn&128&&(ut.checked=Oi[7])},i:wo,o:wo,d(Oi){Oi&&bi(t),up(Ti,Oi),Ot=!1,Nh(_i)}}}function cT(e,t,n){let c;Vc(e,Ry,rt=>n(20,c=rt));let{updateColorScheme:g}=t,{updateShowCounties:b}=t,{updateShowEcoregions:I}=t,{updateDrawing:a}=t,{updateDrawnPath:G}=t,{isDrawing:W}=t,he,ae,ue,be=c;const Ke=Object.keys(Lv);vc(()=>{g(he)});function ot(){he=rE(this),n(5,he),n(9,Ke)}const tt=()=>g(he);function lt(){ae=this.checked,n(6,ae)}const ut=()=>b(ae);function Tt(){ue=this.checked,n(7,ue)}const Pt=()=>I(ue),zt=()=>a(!0),Ge=()=>G(null),Xt=rt=>Ry.set(Number.parseInt(rt.target.value)/100);return e.$$set=rt=>{"updateColorScheme"in rt&&n(0,g=rt.updateColorScheme),"updateShowCounties"in rt&&n(1,b=rt.updateShowCounties),"updateShowEcoregions"in rt&&n(2,I=rt.updateShowEcoregions),"updateDrawing"in rt&&n(3,a=rt.updateDrawing),"updateDrawnPath"in rt&&n(4,G=rt.updateDrawnPath),"isDrawing"in rt&&n(10,W=rt.isDrawing)},[g,b,I,a,G,he,ae,ue,be,Ke,W,ot,tt,lt,ut,Tt,Pt,zt,Ge,Xt]}class hT extends Lo{constructor(t){super(),Bo(this,t,cT,uT,ho,{updateColorScheme:0,updateShowCounties:1,updateShowEcoregions:2,updateDrawing:3,updateDrawnPath:4,isDrawing:10})}}function AT(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var d3={exports:{}};const fT={},dT=Object.freeze(Object.defineProperty({__proto__:null,default:fT},Symbol.toStringTag,{value:"Module"})),vx=Bv(dT);var Ug={exports:{}},xx;function pT(){return xx||(xx=1,function(e,t){(function(n,c){c(t)})(Jf,function(n){var c=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],g=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],b="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࢘-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",I="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟊꟐꟑꟓꟕ-ꟙꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},G="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",W={5:G,"5module":G+" export import",6:G+" const class extends export import super"},he=/^in(stanceof)?$/,ae=new RegExp("["+I+"]"),ue=new RegExp("["+I+b+"]");function be(N,xe){for(var it=65536,It=0;It<xe.length;It+=2){if(it+=xe[It],it>N)return!1;if(it+=xe[It+1],it>=N)return!0}return!1}function Ke(N,xe){return N<65?N===36:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&ae.test(String.fromCharCode(N)):xe===!1?!1:be(N,g)}function ot(N,xe){return N<48?N===36:N<58?!0:N<65?!1:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&ue.test(String.fromCharCode(N)):xe===!1?!1:be(N,g)||be(N,c)}var tt=function(xe,it){it===void 0&&(it={}),this.label=xe,this.keyword=it.keyword,this.beforeExpr=!!it.beforeExpr,this.startsExpr=!!it.startsExpr,this.isLoop=!!it.isLoop,this.isAssign=!!it.isAssign,this.prefix=!!it.prefix,this.postfix=!!it.postfix,this.binop=it.binop||null,this.updateContext=null};function lt(N,xe){return new tt(N,{beforeExpr:!0,binop:xe})}var ut={beforeExpr:!0},Tt={startsExpr:!0},Pt={};function zt(N,xe){return xe===void 0&&(xe={}),xe.keyword=N,Pt[N]=new tt(N,xe)}var Ge={num:new tt("num",Tt),regexp:new tt("regexp",Tt),string:new tt("string",Tt),name:new tt("name",Tt),privateId:new tt("privateId",Tt),eof:new tt("eof"),bracketL:new tt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new tt("]"),braceL:new tt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new tt("}"),parenL:new tt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new tt(")"),comma:new tt(",",ut),semi:new tt(";",ut),colon:new tt(":",ut),dot:new tt("."),question:new tt("?",ut),questionDot:new tt("?."),arrow:new tt("=>",ut),template:new tt("template"),invalidTemplate:new tt("invalidTemplate"),ellipsis:new tt("...",ut),backQuote:new tt("`",Tt),dollarBraceL:new tt("${",{beforeExpr:!0,startsExpr:!0}),eq:new tt("=",{beforeExpr:!0,isAssign:!0}),assign:new tt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new tt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new tt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:lt("||",1),logicalAND:lt("&&",2),bitwiseOR:lt("|",3),bitwiseXOR:lt("^",4),bitwiseAND:lt("&",5),equality:lt("==/!=/===/!==",6),relational:lt("</>/<=/>=",7),bitShift:lt("<</>>/>>>",8),plusMin:new tt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:lt("%",10),star:lt("*",10),slash:lt("/",10),starstar:new tt("**",{beforeExpr:!0}),coalesce:lt("??",1),_break:zt("break"),_case:zt("case",ut),_catch:zt("catch"),_continue:zt("continue"),_debugger:zt("debugger"),_default:zt("default",ut),_do:zt("do",{isLoop:!0,beforeExpr:!0}),_else:zt("else",ut),_finally:zt("finally"),_for:zt("for",{isLoop:!0}),_function:zt("function",Tt),_if:zt("if"),_return:zt("return",ut),_switch:zt("switch"),_throw:zt("throw",ut),_try:zt("try"),_var:zt("var"),_const:zt("const"),_while:zt("while",{isLoop:!0}),_with:zt("with"),_new:zt("new",{beforeExpr:!0,startsExpr:!0}),_this:zt("this",Tt),_super:zt("super",Tt),_class:zt("class",Tt),_extends:zt("extends",ut),_export:zt("export"),_import:zt("import",Tt),_null:zt("null",Tt),_true:zt("true",Tt),_false:zt("false",Tt),_in:zt("in",{beforeExpr:!0,binop:7}),_instanceof:zt("instanceof",{beforeExpr:!0,binop:7}),_typeof:zt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:zt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:zt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Xt=/\r\n?|\n|\u2028|\u2029/,rt=new RegExp(Xt.source,"g");function yt(N){return N===10||N===13||N===8232||N===8233}function pt(N,xe,it){it===void 0&&(it=N.length);for(var It=xe;It<it;It++){var Wt=N.charCodeAt(It);if(yt(Wt))return It<it-1&&Wt===13&&N.charCodeAt(It+1)===10?It+2:It+1}return-1}var gt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,bt=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,dt=Object.prototype,$e=dt.hasOwnProperty,mt=dt.toString,st=Object.hasOwn||function(N,xe){return $e.call(N,xe)},Nt=Array.isArray||function(N){return mt.call(N)==="[object Array]"},Rt=Object.create(null);function Ot(N){return Rt[N]||(Rt[N]=new RegExp("^(?:"+N.replace(/ /g,"|")+")$"))}function _i(N){return N<=65535?String.fromCharCode(N):(N-=65536,String.fromCharCode((N>>10)+55296,(N&1023)+56320))}var Si=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Ti=function(xe,it){this.line=xe,this.column=it};Ti.prototype.offset=function(xe){return new Ti(this.line,this.column+xe)};var Oi=function(xe,it,It){this.start=it,this.end=It,xe.sourceFile!==null&&(this.source=xe.sourceFile)};function tn(N,xe){for(var it=1,It=0;;){var Wt=pt(N,It,xe);if(Wt<0)return new Ti(it,xe-It);++it,It=Wt}}var qi={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Ni=!1;function nn(N){var xe={};for(var it in qi)xe[it]=N&&st(N,it)?N[it]:qi[it];if(xe.ecmaVersion==="latest"?xe.ecmaVersion=1e8:xe.ecmaVersion==null?(!Ni&&typeof console=="object"&&console.warn&&(Ni=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),xe.ecmaVersion=11):xe.ecmaVersion>=2015&&(xe.ecmaVersion-=2009),xe.allowReserved==null&&(xe.allowReserved=xe.ecmaVersion<5),(!N||N.allowHashBang==null)&&(xe.allowHashBang=xe.ecmaVersion>=14),Nt(xe.onToken)){var It=xe.onToken;xe.onToken=function(Wt){return It.push(Wt)}}return Nt(xe.onComment)&&(xe.onComment=yn(xe,xe.onComment)),xe}function yn(N,xe){return function(it,It,Wt,Ii,Li,cn){var fn={type:it?"Block":"Line",value:It,start:Wt,end:Ii};N.locations&&(fn.loc=new Oi(this,Li,cn)),N.ranges&&(fn.range=[Wt,Ii]),xe.push(fn)}}var Ci=1,gi=2,Ri=4,ai=8,Ki=16,Ji=32,fi=64,pn=128,ii=256,wn=Ci|gi|ii;function Rr(N,xe){return gi|(N?Ri:0)|(xe?ai:0)}var hi=0,en=1,tr=2,Fn=3,Qn=4,In=5,v=function(xe,it,It){this.options=xe=nn(xe),this.sourceFile=xe.sourceFile,this.keywords=Ot(W[xe.ecmaVersion>=6?6:xe.sourceType==="module"?"5module":5]);var Wt="";xe.allowReserved!==!0&&(Wt=a[xe.ecmaVersion>=6?6:xe.ecmaVersion===5?5:3],xe.sourceType==="module"&&(Wt+=" await")),this.reservedWords=Ot(Wt);var Ii=(Wt?Wt+" ":"")+a.strict;this.reservedWordsStrict=Ot(Ii),this.reservedWordsStrictBind=Ot(Ii+" "+a.strictBind),this.input=String(it),this.containsEsc=!1,It?(this.pos=It,this.lineStart=this.input.lastIndexOf(`
`,It-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Xt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Ge.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=xe.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&xe.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Ci),this.regexpState=null,this.privateNameStack=[]},k={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};v.prototype.parse=function(){var xe=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(xe)},k.inFunction.get=function(){return(this.currentVarScope().flags&gi)>0},k.inGenerator.get=function(){return(this.currentVarScope().flags&ai)>0&&!this.currentVarScope().inClassFieldInit},k.inAsync.get=function(){return(this.currentVarScope().flags&Ri)>0&&!this.currentVarScope().inClassFieldInit},k.canAwait.get=function(){for(var N=this.scopeStack.length-1;N>=0;N--){var xe=this.scopeStack[N];if(xe.inClassFieldInit||xe.flags&ii)return!1;if(xe.flags&gi)return(xe.flags&Ri)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},k.allowSuper.get=function(){var N=this.currentThisScope(),xe=N.flags,it=N.inClassFieldInit;return(xe&fi)>0||it||this.options.allowSuperOutsideMethod},k.allowDirectSuper.get=function(){return(this.currentThisScope().flags&pn)>0},k.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},k.allowNewDotTarget.get=function(){var N=this.currentThisScope(),xe=N.flags,it=N.inClassFieldInit;return(xe&(gi|ii))>0||it},k.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&ii)>0},v.extend=function(){for(var xe=[],it=arguments.length;it--;)xe[it]=arguments[it];for(var It=this,Wt=0;Wt<xe.length;Wt++)It=xe[Wt](It);return It},v.parse=function(xe,it){return new this(it,xe).parse()},v.parseExpressionAt=function(xe,it,It){var Wt=new this(It,xe,it);return Wt.nextToken(),Wt.parseExpression()},v.tokenizer=function(xe,it){return new this(it,xe)},Object.defineProperties(v.prototype,k);var V=v.prototype,$=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;V.strictDirective=function(N){if(this.options.ecmaVersion<5)return!1;for(;;){bt.lastIndex=N,N+=bt.exec(this.input)[0].length;var xe=$.exec(this.input.slice(N));if(!xe)return!1;if((xe[1]||xe[2])==="use strict"){bt.lastIndex=N+xe[0].length;var it=bt.exec(this.input),It=it.index+it[0].length,Wt=this.input.charAt(It);return Wt===";"||Wt==="}"||Xt.test(it[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(Wt)||Wt==="!"&&this.input.charAt(It+1)==="=")}N+=xe[0].length,bt.lastIndex=N,N+=bt.exec(this.input)[0].length,this.input[N]===";"&&N++}},V.eat=function(N){return this.type===N?(this.next(),!0):!1},V.isContextual=function(N){return this.type===Ge.name&&this.value===N&&!this.containsEsc},V.eatContextual=function(N){return this.isContextual(N)?(this.next(),!0):!1},V.expectContextual=function(N){this.eatContextual(N)||this.unexpected()},V.canInsertSemicolon=function(){return this.type===Ge.eof||this.type===Ge.braceR||Xt.test(this.input.slice(this.lastTokEnd,this.start))},V.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},V.semicolon=function(){!this.eat(Ge.semi)&&!this.insertSemicolon()&&this.unexpected()},V.afterTrailingComma=function(N,xe){if(this.type===N)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),xe||this.next(),!0},V.expect=function(N){this.eat(N)||this.unexpected()},V.unexpected=function(N){this.raise(N??this.start,"Unexpected token")};var te=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};V.checkPatternErrors=function(N,xe){if(N){N.trailingComma>-1&&this.raiseRecoverable(N.trailingComma,"Comma is not permitted after the rest element");var it=xe?N.parenthesizedAssign:N.parenthesizedBind;it>-1&&this.raiseRecoverable(it,xe?"Assigning to rvalue":"Parenthesized pattern")}},V.checkExpressionErrors=function(N,xe){if(!N)return!1;var it=N.shorthandAssign,It=N.doubleProto;if(!xe)return it>=0||It>=0;it>=0&&this.raise(it,"Shorthand property assignments are valid only in destructuring patterns"),It>=0&&this.raiseRecoverable(It,"Redefinition of __proto__ property")},V.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},V.isSimpleAssignTarget=function(N){return N.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(N.expression):N.type==="Identifier"||N.type==="MemberExpression"};var fe=v.prototype;fe.parseTopLevel=function(N){var xe=Object.create(null);for(N.body||(N.body=[]);this.type!==Ge.eof;){var it=this.parseStatement(null,!0,xe);N.body.push(it)}if(this.inModule)for(var It=0,Wt=Object.keys(this.undefinedExports);It<Wt.length;It+=1){var Ii=Wt[It];this.raiseRecoverable(this.undefinedExports[Ii].start,"Export '"+Ii+"' is not defined")}return this.adaptDirectivePrologue(N.body),this.next(),N.sourceType=this.options.sourceType,this.finishNode(N,"Program")};var ve={kind:"loop"},Ie={kind:"switch"};fe.isLet=function(N){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;bt.lastIndex=this.pos;var xe=bt.exec(this.input),it=this.pos+xe[0].length,It=this.input.charCodeAt(it);if(It===91||It===92)return!0;if(N)return!1;if(It===123||It>55295&&It<56320)return!0;if(Ke(It,!0)){for(var Wt=it+1;ot(It=this.input.charCodeAt(Wt),!0);)++Wt;if(It===92||It>55295&&It<56320)return!0;var Ii=this.input.slice(it,Wt);if(!he.test(Ii))return!0}return!1},fe.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;bt.lastIndex=this.pos;var N=bt.exec(this.input),xe=this.pos+N[0].length,it;return!Xt.test(this.input.slice(this.pos,xe))&&this.input.slice(xe,xe+8)==="function"&&(xe+8===this.input.length||!(ot(it=this.input.charCodeAt(xe+8))||it>55295&&it<56320))},fe.parseStatement=function(N,xe,it){var It=this.type,Wt=this.startNode(),Ii;switch(this.isLet(N)&&(It=Ge._var,Ii="let"),It){case Ge._break:case Ge._continue:return this.parseBreakContinueStatement(Wt,It.keyword);case Ge._debugger:return this.parseDebuggerStatement(Wt);case Ge._do:return this.parseDoStatement(Wt);case Ge._for:return this.parseForStatement(Wt);case Ge._function:return N&&(this.strict||N!=="if"&&N!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(Wt,!1,!N);case Ge._class:return N&&this.unexpected(),this.parseClass(Wt,!0);case Ge._if:return this.parseIfStatement(Wt);case Ge._return:return this.parseReturnStatement(Wt);case Ge._switch:return this.parseSwitchStatement(Wt);case Ge._throw:return this.parseThrowStatement(Wt);case Ge._try:return this.parseTryStatement(Wt);case Ge._const:case Ge._var:return Ii=Ii||this.value,N&&Ii!=="var"&&this.unexpected(),this.parseVarStatement(Wt,Ii);case Ge._while:return this.parseWhileStatement(Wt);case Ge._with:return this.parseWithStatement(Wt);case Ge.braceL:return this.parseBlock(!0,Wt);case Ge.semi:return this.parseEmptyStatement(Wt);case Ge._export:case Ge._import:if(this.options.ecmaVersion>10&&It===Ge._import){bt.lastIndex=this.pos;var Li=bt.exec(this.input),cn=this.pos+Li[0].length,fn=this.input.charCodeAt(cn);if(fn===40||fn===46)return this.parseExpressionStatement(Wt,this.parseExpression())}return this.options.allowImportExportEverywhere||(xe||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),It===Ge._import?this.parseImport(Wt):this.parseExport(Wt,it);default:if(this.isAsyncFunction())return N&&this.unexpected(),this.next(),this.parseFunctionStatement(Wt,!0,!N);var sr=this.value,Ar=this.parseExpression();return It===Ge.name&&Ar.type==="Identifier"&&this.eat(Ge.colon)?this.parseLabeledStatement(Wt,sr,Ar,N):this.parseExpressionStatement(Wt,Ar)}},fe.parseBreakContinueStatement=function(N,xe){var it=xe==="break";this.next(),this.eat(Ge.semi)||this.insertSemicolon()?N.label=null:this.type!==Ge.name?this.unexpected():(N.label=this.parseIdent(),this.semicolon());for(var It=0;It<this.labels.length;++It){var Wt=this.labels[It];if((N.label==null||Wt.name===N.label.name)&&(Wt.kind!=null&&(it||Wt.kind==="loop")||N.label&&it))break}return It===this.labels.length&&this.raise(N.start,"Unsyntactic "+xe),this.finishNode(N,it?"BreakStatement":"ContinueStatement")},fe.parseDebuggerStatement=function(N){return this.next(),this.semicolon(),this.finishNode(N,"DebuggerStatement")},fe.parseDoStatement=function(N){return this.next(),this.labels.push(ve),N.body=this.parseStatement("do"),this.labels.pop(),this.expect(Ge._while),N.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Ge.semi):this.semicolon(),this.finishNode(N,"DoWhileStatement")},fe.parseForStatement=function(N){this.next();var xe=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(ve),this.enterScope(0),this.expect(Ge.parenL),this.type===Ge.semi)return xe>-1&&this.unexpected(xe),this.parseFor(N,null);var it=this.isLet();if(this.type===Ge._var||this.type===Ge._const||it){var It=this.startNode(),Wt=it?"let":this.value;return this.next(),this.parseVar(It,!0,Wt),this.finishNode(It,"VariableDeclaration"),(this.type===Ge._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&It.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===Ge._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),this.parseForIn(N,It)):(xe>-1&&this.unexpected(xe),this.parseFor(N,It))}var Ii=this.isContextual("let"),Li=!1,cn=new te,fn=this.parseExpression(xe>-1?"await":!0,cn);return this.type===Ge._in||(Li=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===Ge._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),Ii&&Li&&this.raise(fn.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(fn,!1,cn),this.checkLValPattern(fn),this.parseForIn(N,fn)):(this.checkExpressionErrors(cn,!0),xe>-1&&this.unexpected(xe),this.parseFor(N,fn))},fe.parseFunctionStatement=function(N,xe,it){return this.next(),this.parseFunction(N,ze|(it?0:Qe),!1,xe)},fe.parseIfStatement=function(N){return this.next(),N.test=this.parseParenExpression(),N.consequent=this.parseStatement("if"),N.alternate=this.eat(Ge._else)?this.parseStatement("if"):null,this.finishNode(N,"IfStatement")},fe.parseReturnStatement=function(N){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Ge.semi)||this.insertSemicolon()?N.argument=null:(N.argument=this.parseExpression(),this.semicolon()),this.finishNode(N,"ReturnStatement")},fe.parseSwitchStatement=function(N){this.next(),N.discriminant=this.parseParenExpression(),N.cases=[],this.expect(Ge.braceL),this.labels.push(Ie),this.enterScope(0);for(var xe,it=!1;this.type!==Ge.braceR;)if(this.type===Ge._case||this.type===Ge._default){var It=this.type===Ge._case;xe&&this.finishNode(xe,"SwitchCase"),N.cases.push(xe=this.startNode()),xe.consequent=[],this.next(),It?xe.test=this.parseExpression():(it&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),it=!0,xe.test=null),this.expect(Ge.colon)}else xe||this.unexpected(),xe.consequent.push(this.parseStatement(null));return this.exitScope(),xe&&this.finishNode(xe,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(N,"SwitchStatement")},fe.parseThrowStatement=function(N){return this.next(),Xt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),N.argument=this.parseExpression(),this.semicolon(),this.finishNode(N,"ThrowStatement")};var Ee=[];fe.parseCatchClauseParam=function(){var N=this.parseBindingAtom(),xe=N.type==="Identifier";return this.enterScope(xe?Ji:0),this.checkLValPattern(N,xe?Qn:tr),this.expect(Ge.parenR),N},fe.parseTryStatement=function(N){if(this.next(),N.block=this.parseBlock(),N.handler=null,this.type===Ge._catch){var xe=this.startNode();this.next(),this.eat(Ge.parenL)?xe.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),xe.param=null,this.enterScope(0)),xe.body=this.parseBlock(!1),this.exitScope(),N.handler=this.finishNode(xe,"CatchClause")}return N.finalizer=this.eat(Ge._finally)?this.parseBlock():null,!N.handler&&!N.finalizer&&this.raise(N.start,"Missing catch or finally clause"),this.finishNode(N,"TryStatement")},fe.parseVarStatement=function(N,xe,it){return this.next(),this.parseVar(N,!1,xe,it),this.semicolon(),this.finishNode(N,"VariableDeclaration")},fe.parseWhileStatement=function(N){return this.next(),N.test=this.parseParenExpression(),this.labels.push(ve),N.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(N,"WhileStatement")},fe.parseWithStatement=function(N){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),N.object=this.parseParenExpression(),N.body=this.parseStatement("with"),this.finishNode(N,"WithStatement")},fe.parseEmptyStatement=function(N){return this.next(),this.finishNode(N,"EmptyStatement")},fe.parseLabeledStatement=function(N,xe,it,It){for(var Wt=0,Ii=this.labels;Wt<Ii.length;Wt+=1){var Li=Ii[Wt];Li.name===xe&&this.raise(it.start,"Label '"+xe+"' is already declared")}for(var cn=this.type.isLoop?"loop":this.type===Ge._switch?"switch":null,fn=this.labels.length-1;fn>=0;fn--){var sr=this.labels[fn];if(sr.statementStart===N.start)sr.statementStart=this.start,sr.kind=cn;else break}return this.labels.push({name:xe,kind:cn,statementStart:this.start}),N.body=this.parseStatement(It?It.indexOf("label")===-1?It+"label":It:"label"),this.labels.pop(),N.label=it,this.finishNode(N,"LabeledStatement")},fe.parseExpressionStatement=function(N,xe){return N.expression=xe,this.semicolon(),this.finishNode(N,"ExpressionStatement")},fe.parseBlock=function(N,xe,it){for(N===void 0&&(N=!0),xe===void 0&&(xe=this.startNode()),xe.body=[],this.expect(Ge.braceL),N&&this.enterScope(0);this.type!==Ge.braceR;){var It=this.parseStatement(null);xe.body.push(It)}return it&&(this.strict=!1),this.next(),N&&this.exitScope(),this.finishNode(xe,"BlockStatement")},fe.parseFor=function(N,xe){return N.init=xe,this.expect(Ge.semi),N.test=this.type===Ge.semi?null:this.parseExpression(),this.expect(Ge.semi),N.update=this.type===Ge.parenR?null:this.parseExpression(),this.expect(Ge.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,"ForStatement")},fe.parseForIn=function(N,xe){var it=this.type===Ge._in;return this.next(),xe.type==="VariableDeclaration"&&xe.declarations[0].init!=null&&(!it||this.options.ecmaVersion<8||this.strict||xe.kind!=="var"||xe.declarations[0].id.type!=="Identifier")&&this.raise(xe.start,(it?"for-in":"for-of")+" loop variable declaration may not have an initializer"),N.left=xe,N.right=it?this.parseExpression():this.parseMaybeAssign(),this.expect(Ge.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,it?"ForInStatement":"ForOfStatement")},fe.parseVar=function(N,xe,it,It){for(N.declarations=[],N.kind=it;;){var Wt=this.startNode();if(this.parseVarId(Wt,it),this.eat(Ge.eq)?Wt.init=this.parseMaybeAssign(xe):!It&&it==="const"&&!(this.type===Ge._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!It&&Wt.id.type!=="Identifier"&&!(xe&&(this.type===Ge._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):Wt.init=null,N.declarations.push(this.finishNode(Wt,"VariableDeclarator")),!this.eat(Ge.comma))break}return N},fe.parseVarId=function(N,xe){N.id=this.parseBindingAtom(),this.checkLValPattern(N.id,xe==="var"?en:tr,!1)};var ze=1,Qe=2,He=4;fe.parseFunction=function(N,xe,it,It,Wt){this.initFunction(N),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!It)&&(this.type===Ge.star&&xe&Qe&&this.unexpected(),N.generator=this.eat(Ge.star)),this.options.ecmaVersion>=8&&(N.async=!!It),xe&ze&&(N.id=xe&He&&this.type!==Ge.name?null:this.parseIdent(),N.id&&!(xe&Qe)&&this.checkLValSimple(N.id,this.strict||N.generator||N.async?this.treatFunctionsAsVar?en:tr:Fn));var Ii=this.yieldPos,Li=this.awaitPos,cn=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Rr(N.async,N.generator)),xe&ze||(N.id=this.type===Ge.name?this.parseIdent():null),this.parseFunctionParams(N),this.parseFunctionBody(N,it,!1,Wt),this.yieldPos=Ii,this.awaitPos=Li,this.awaitIdentPos=cn,this.finishNode(N,xe&ze?"FunctionDeclaration":"FunctionExpression")},fe.parseFunctionParams=function(N){this.expect(Ge.parenL),N.params=this.parseBindingList(Ge.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},fe.parseClass=function(N,xe){this.next();var it=this.strict;this.strict=!0,this.parseClassId(N,xe),this.parseClassSuper(N);var It=this.enterClassBody(),Wt=this.startNode(),Ii=!1;for(Wt.body=[],this.expect(Ge.braceL);this.type!==Ge.braceR;){var Li=this.parseClassElement(N.superClass!==null);Li&&(Wt.body.push(Li),Li.type==="MethodDefinition"&&Li.kind==="constructor"?(Ii&&this.raiseRecoverable(Li.start,"Duplicate constructor in the same class"),Ii=!0):Li.key&&Li.key.type==="PrivateIdentifier"&&Ze(It,Li)&&this.raiseRecoverable(Li.key.start,"Identifier '#"+Li.key.name+"' has already been declared"))}return this.strict=it,this.next(),N.body=this.finishNode(Wt,"ClassBody"),this.exitClassBody(),this.finishNode(N,xe?"ClassDeclaration":"ClassExpression")},fe.parseClassElement=function(N){if(this.eat(Ge.semi))return null;var xe=this.options.ecmaVersion,it=this.startNode(),It="",Wt=!1,Ii=!1,Li="method",cn=!1;if(this.eatContextual("static")){if(xe>=13&&this.eat(Ge.braceL))return this.parseClassStaticBlock(it),it;this.isClassElementNameStart()||this.type===Ge.star?cn=!0:It="static"}if(it.static=cn,!It&&xe>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===Ge.star)&&!this.canInsertSemicolon()?Ii=!0:It="async"),!It&&(xe>=9||!Ii)&&this.eat(Ge.star)&&(Wt=!0),!It&&!Ii&&!Wt){var fn=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Li=fn:It=fn)}if(It?(it.computed=!1,it.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),it.key.name=It,this.finishNode(it.key,"Identifier")):this.parseClassElementName(it),xe<13||this.type===Ge.parenL||Li!=="method"||Wt||Ii){var sr=!it.static&&Ve(it,"constructor"),Ar=sr&&N;sr&&Li!=="method"&&this.raise(it.key.start,"Constructor can't have get/set modifier"),it.kind=sr?"constructor":Li,this.parseClassMethod(it,Wt,Ii,Ar)}else this.parseClassField(it);return it},fe.isClassElementNameStart=function(){return this.type===Ge.name||this.type===Ge.privateId||this.type===Ge.num||this.type===Ge.string||this.type===Ge.bracketL||this.type.keyword},fe.parseClassElementName=function(N){this.type===Ge.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),N.computed=!1,N.key=this.parsePrivateIdent()):this.parsePropertyName(N)},fe.parseClassMethod=function(N,xe,it,It){var Wt=N.key;N.kind==="constructor"?(xe&&this.raise(Wt.start,"Constructor can't be a generator"),it&&this.raise(Wt.start,"Constructor can't be an async method")):N.static&&Ve(N,"prototype")&&this.raise(Wt.start,"Classes may not have a static property named prototype");var Ii=N.value=this.parseMethod(xe,it,It);return N.kind==="get"&&Ii.params.length!==0&&this.raiseRecoverable(Ii.start,"getter should have no params"),N.kind==="set"&&Ii.params.length!==1&&this.raiseRecoverable(Ii.start,"setter should have exactly one param"),N.kind==="set"&&Ii.params[0].type==="RestElement"&&this.raiseRecoverable(Ii.params[0].start,"Setter cannot use rest params"),this.finishNode(N,"MethodDefinition")},fe.parseClassField=function(N){if(Ve(N,"constructor")?this.raise(N.key.start,"Classes can't have a field named 'constructor'"):N.static&&Ve(N,"prototype")&&this.raise(N.key.start,"Classes can't have a static field named 'prototype'"),this.eat(Ge.eq)){var xe=this.currentThisScope(),it=xe.inClassFieldInit;xe.inClassFieldInit=!0,N.value=this.parseMaybeAssign(),xe.inClassFieldInit=it}else N.value=null;return this.semicolon(),this.finishNode(N,"PropertyDefinition")},fe.parseClassStaticBlock=function(N){N.body=[];var xe=this.labels;for(this.labels=[],this.enterScope(ii|fi);this.type!==Ge.braceR;){var it=this.parseStatement(null);N.body.push(it)}return this.next(),this.exitScope(),this.labels=xe,this.finishNode(N,"StaticBlock")},fe.parseClassId=function(N,xe){this.type===Ge.name?(N.id=this.parseIdent(),xe&&this.checkLValSimple(N.id,tr,!1)):(xe===!0&&this.unexpected(),N.id=null)},fe.parseClassSuper=function(N){N.superClass=this.eat(Ge._extends)?this.parseExprSubscripts(null,!1):null},fe.enterClassBody=function(){var N={declared:Object.create(null),used:[]};return this.privateNameStack.push(N),N.declared},fe.exitClassBody=function(){var N=this.privateNameStack.pop(),xe=N.declared,it=N.used;if(this.options.checkPrivateFields)for(var It=this.privateNameStack.length,Wt=It===0?null:this.privateNameStack[It-1],Ii=0;Ii<it.length;++Ii){var Li=it[Ii];st(xe,Li.name)||(Wt?Wt.used.push(Li):this.raiseRecoverable(Li.start,"Private field '#"+Li.name+"' must be declared in an enclosing class"))}};function Ze(N,xe){var it=xe.key.name,It=N[it],Wt="true";return xe.type==="MethodDefinition"&&(xe.kind==="get"||xe.kind==="set")&&(Wt=(xe.static?"s":"i")+xe.kind),It==="iget"&&Wt==="iset"||It==="iset"&&Wt==="iget"||It==="sget"&&Wt==="sset"||It==="sset"&&Wt==="sget"?(N[it]="true",!1):It?!0:(N[it]=Wt,!1)}function Ve(N,xe){var it=N.computed,It=N.key;return!it&&(It.type==="Identifier"&&It.name===xe||It.type==="Literal"&&It.value===xe)}fe.parseExportAllDeclaration=function(N,xe){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(N.exported=this.parseModuleExportName(),this.checkExport(xe,N.exported,this.lastTokStart)):N.exported=null),this.expectContextual("from"),this.type!==Ge.string&&this.unexpected(),N.source=this.parseExprAtom(),this.semicolon(),this.finishNode(N,"ExportAllDeclaration")},fe.parseExport=function(N,xe){if(this.next(),this.eat(Ge.star))return this.parseExportAllDeclaration(N,xe);if(this.eat(Ge._default))return this.checkExport(xe,"default",this.lastTokStart),N.declaration=this.parseExportDefaultDeclaration(),this.finishNode(N,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())N.declaration=this.parseExportDeclaration(N),N.declaration.type==="VariableDeclaration"?this.checkVariableExport(xe,N.declaration.declarations):this.checkExport(xe,N.declaration.id,N.declaration.id.start),N.specifiers=[],N.source=null;else{if(N.declaration=null,N.specifiers=this.parseExportSpecifiers(xe),this.eatContextual("from"))this.type!==Ge.string&&this.unexpected(),N.source=this.parseExprAtom();else{for(var it=0,It=N.specifiers;it<It.length;it+=1){var Wt=It[it];this.checkUnreserved(Wt.local),this.checkLocalExport(Wt.local),Wt.local.type==="Literal"&&this.raise(Wt.local.start,"A string literal cannot be used as an exported binding without `from`.")}N.source=null}this.semicolon()}return this.finishNode(N,"ExportNamedDeclaration")},fe.parseExportDeclaration=function(N){return this.parseStatement(null)},fe.parseExportDefaultDeclaration=function(){var N;if(this.type===Ge._function||(N=this.isAsyncFunction())){var xe=this.startNode();return this.next(),N&&this.next(),this.parseFunction(xe,ze|He,!1,N)}else if(this.type===Ge._class){var it=this.startNode();return this.parseClass(it,"nullableID")}else{var It=this.parseMaybeAssign();return this.semicolon(),It}},fe.checkExport=function(N,xe,it){N&&(typeof xe!="string"&&(xe=xe.type==="Identifier"?xe.name:xe.value),st(N,xe)&&this.raiseRecoverable(it,"Duplicate export '"+xe+"'"),N[xe]=!0)},fe.checkPatternExport=function(N,xe){var it=xe.type;if(it==="Identifier")this.checkExport(N,xe,xe.start);else if(it==="ObjectPattern")for(var It=0,Wt=xe.properties;It<Wt.length;It+=1){var Ii=Wt[It];this.checkPatternExport(N,Ii)}else if(it==="ArrayPattern")for(var Li=0,cn=xe.elements;Li<cn.length;Li+=1){var fn=cn[Li];fn&&this.checkPatternExport(N,fn)}else it==="Property"?this.checkPatternExport(N,xe.value):it==="AssignmentPattern"?this.checkPatternExport(N,xe.left):it==="RestElement"&&this.checkPatternExport(N,xe.argument)},fe.checkVariableExport=function(N,xe){if(N)for(var it=0,It=xe;it<It.length;it+=1){var Wt=It[it];this.checkPatternExport(N,Wt.id)}},fe.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},fe.parseExportSpecifier=function(N){var xe=this.startNode();return xe.local=this.parseModuleExportName(),xe.exported=this.eatContextual("as")?this.parseModuleExportName():xe.local,this.checkExport(N,xe.exported,xe.exported.start),this.finishNode(xe,"ExportSpecifier")},fe.parseExportSpecifiers=function(N){var xe=[],it=!0;for(this.expect(Ge.braceL);!this.eat(Ge.braceR);){if(it)it=!1;else if(this.expect(Ge.comma),this.afterTrailingComma(Ge.braceR))break;xe.push(this.parseExportSpecifier(N))}return xe},fe.parseImport=function(N){return this.next(),this.type===Ge.string?(N.specifiers=Ee,N.source=this.parseExprAtom()):(N.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),N.source=this.type===Ge.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(N,"ImportDeclaration")},fe.parseImportSpecifier=function(){var N=this.startNode();return N.imported=this.parseModuleExportName(),this.eatContextual("as")?N.local=this.parseIdent():(this.checkUnreserved(N.imported),N.local=N.imported),this.checkLValSimple(N.local,tr),this.finishNode(N,"ImportSpecifier")},fe.parseImportDefaultSpecifier=function(){var N=this.startNode();return N.local=this.parseIdent(),this.checkLValSimple(N.local,tr),this.finishNode(N,"ImportDefaultSpecifier")},fe.parseImportNamespaceSpecifier=function(){var N=this.startNode();return this.next(),this.expectContextual("as"),N.local=this.parseIdent(),this.checkLValSimple(N.local,tr),this.finishNode(N,"ImportNamespaceSpecifier")},fe.parseImportSpecifiers=function(){var N=[],xe=!0;if(this.type===Ge.name&&(N.push(this.parseImportDefaultSpecifier()),!this.eat(Ge.comma)))return N;if(this.type===Ge.star)return N.push(this.parseImportNamespaceSpecifier()),N;for(this.expect(Ge.braceL);!this.eat(Ge.braceR);){if(xe)xe=!1;else if(this.expect(Ge.comma),this.afterTrailingComma(Ge.braceR))break;N.push(this.parseImportSpecifier())}return N},fe.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===Ge.string){var N=this.parseLiteral(this.value);return Si.test(N.value)&&this.raise(N.start,"An export name cannot include a lone surrogate."),N}return this.parseIdent(!0)},fe.adaptDirectivePrologue=function(N){for(var xe=0;xe<N.length&&this.isDirectiveCandidate(N[xe]);++xe)N[xe].directive=N[xe].expression.raw.slice(1,-1)},fe.isDirectiveCandidate=function(N){return this.options.ecmaVersion>=5&&N.type==="ExpressionStatement"&&N.expression.type==="Literal"&&typeof N.expression.value=="string"&&(this.input[N.start]==='"'||this.input[N.start]==="'")};var ft=v.prototype;ft.toAssignable=function(N,xe,it){if(this.options.ecmaVersion>=6&&N)switch(N.type){case"Identifier":this.inAsync&&N.name==="await"&&this.raise(N.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":N.type="ObjectPattern",it&&this.checkPatternErrors(it,!0);for(var It=0,Wt=N.properties;It<Wt.length;It+=1){var Ii=Wt[It];this.toAssignable(Ii,xe),Ii.type==="RestElement"&&(Ii.argument.type==="ArrayPattern"||Ii.argument.type==="ObjectPattern")&&this.raise(Ii.argument.start,"Unexpected token")}break;case"Property":N.kind!=="init"&&this.raise(N.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(N.value,xe);break;case"ArrayExpression":N.type="ArrayPattern",it&&this.checkPatternErrors(it,!0),this.toAssignableList(N.elements,xe);break;case"SpreadElement":N.type="RestElement",this.toAssignable(N.argument,xe),N.argument.type==="AssignmentPattern"&&this.raise(N.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":N.operator!=="="&&this.raise(N.left.end,"Only '=' operator can be used for specifying default value."),N.type="AssignmentPattern",delete N.operator,this.toAssignable(N.left,xe);break;case"ParenthesizedExpression":this.toAssignable(N.expression,xe,it);break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!xe)break;default:this.raise(N.start,"Assigning to rvalue")}else it&&this.checkPatternErrors(it,!0);return N},ft.toAssignableList=function(N,xe){for(var it=N.length,It=0;It<it;It++){var Wt=N[It];Wt&&this.toAssignable(Wt,xe)}if(it){var Ii=N[it-1];this.options.ecmaVersion===6&&xe&&Ii&&Ii.type==="RestElement"&&Ii.argument.type!=="Identifier"&&this.unexpected(Ii.argument.start)}return N},ft.parseSpread=function(N){var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeAssign(!1,N),this.finishNode(xe,"SpreadElement")},ft.parseRestBinding=function(){var N=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==Ge.name&&this.unexpected(),N.argument=this.parseBindingAtom(),this.finishNode(N,"RestElement")},ft.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Ge.bracketL:var N=this.startNode();return this.next(),N.elements=this.parseBindingList(Ge.bracketR,!0,!0),this.finishNode(N,"ArrayPattern");case Ge.braceL:return this.parseObj(!0)}return this.parseIdent()},ft.parseBindingList=function(N,xe,it,It){for(var Wt=[],Ii=!0;!this.eat(N);)if(Ii?Ii=!1:this.expect(Ge.comma),xe&&this.type===Ge.comma)Wt.push(null);else{if(it&&this.afterTrailingComma(N))break;if(this.type===Ge.ellipsis){var Li=this.parseRestBinding();this.parseBindingListItem(Li),Wt.push(Li),this.type===Ge.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(N);break}else Wt.push(this.parseAssignableListItem(It))}return Wt},ft.parseAssignableListItem=function(N){var xe=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(xe),xe},ft.parseBindingListItem=function(N){return N},ft.parseMaybeDefault=function(N,xe,it){if(it=it||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Ge.eq))return it;var It=this.startNodeAt(N,xe);return It.left=it,It.right=this.parseMaybeAssign(),this.finishNode(It,"AssignmentPattern")},ft.checkLValSimple=function(N,xe,it){xe===void 0&&(xe=hi);var It=xe!==hi;switch(N.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(N.name)&&this.raiseRecoverable(N.start,(It?"Binding ":"Assigning to ")+N.name+" in strict mode"),It&&(xe===tr&&N.name==="let"&&this.raiseRecoverable(N.start,"let is disallowed as a lexically bound name"),it&&(st(it,N.name)&&this.raiseRecoverable(N.start,"Argument name clash"),it[N.name]=!0),xe!==In&&this.declareName(N.name,xe,N.start));break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":It&&this.raiseRecoverable(N.start,"Binding member expression");break;case"ParenthesizedExpression":return It&&this.raiseRecoverable(N.start,"Binding parenthesized expression"),this.checkLValSimple(N.expression,xe,it);default:this.raise(N.start,(It?"Binding":"Assigning to")+" rvalue")}},ft.checkLValPattern=function(N,xe,it){switch(xe===void 0&&(xe=hi),N.type){case"ObjectPattern":for(var It=0,Wt=N.properties;It<Wt.length;It+=1){var Ii=Wt[It];this.checkLValInnerPattern(Ii,xe,it)}break;case"ArrayPattern":for(var Li=0,cn=N.elements;Li<cn.length;Li+=1){var fn=cn[Li];fn&&this.checkLValInnerPattern(fn,xe,it)}break;default:this.checkLValSimple(N,xe,it)}},ft.checkLValInnerPattern=function(N,xe,it){switch(xe===void 0&&(xe=hi),N.type){case"Property":this.checkLValInnerPattern(N.value,xe,it);break;case"AssignmentPattern":this.checkLValPattern(N.left,xe,it);break;case"RestElement":this.checkLValPattern(N.argument,xe,it);break;default:this.checkLValPattern(N,xe,it)}};var nt=function(xe,it,It,Wt,Ii){this.token=xe,this.isExpr=!!it,this.preserveSpace=!!It,this.override=Wt,this.generator=!!Ii},Me={b_stat:new nt("{",!1),b_expr:new nt("{",!0),b_tmpl:new nt("${",!1),p_stat:new nt("(",!1),p_expr:new nt("(",!0),q_tmpl:new nt("`",!0,!0,function(N){return N.tryReadTemplateToken()}),f_stat:new nt("function",!1),f_expr:new nt("function",!0),f_expr_gen:new nt("function",!0,!1,null,!0),f_gen:new nt("function",!1,!1,null,!0)},se=v.prototype;se.initialContext=function(){return[Me.b_stat]},se.curContext=function(){return this.context[this.context.length-1]},se.braceIsBlock=function(N){var xe=this.curContext();return xe===Me.f_expr||xe===Me.f_stat?!0:N===Ge.colon&&(xe===Me.b_stat||xe===Me.b_expr)?!xe.isExpr:N===Ge._return||N===Ge.name&&this.exprAllowed?Xt.test(this.input.slice(this.lastTokEnd,this.start)):N===Ge._else||N===Ge.semi||N===Ge.eof||N===Ge.parenR||N===Ge.arrow?!0:N===Ge.braceL?xe===Me.b_stat:N===Ge._var||N===Ge._const||N===Ge.name?!1:!this.exprAllowed},se.inGeneratorContext=function(){for(var N=this.context.length-1;N>=1;N--){var xe=this.context[N];if(xe.token==="function")return xe.generator}return!1},se.updateContext=function(N){var xe,it=this.type;it.keyword&&N===Ge.dot?this.exprAllowed=!1:(xe=it.updateContext)?xe.call(this,N):this.exprAllowed=it.beforeExpr},se.overrideContext=function(N){this.curContext()!==N&&(this.context[this.context.length-1]=N)},Ge.parenR.updateContext=Ge.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var N=this.context.pop();N===Me.b_stat&&this.curContext().token==="function"&&(N=this.context.pop()),this.exprAllowed=!N.isExpr},Ge.braceL.updateContext=function(N){this.context.push(this.braceIsBlock(N)?Me.b_stat:Me.b_expr),this.exprAllowed=!0},Ge.dollarBraceL.updateContext=function(){this.context.push(Me.b_tmpl),this.exprAllowed=!0},Ge.parenL.updateContext=function(N){var xe=N===Ge._if||N===Ge._for||N===Ge._with||N===Ge._while;this.context.push(xe?Me.p_stat:Me.p_expr),this.exprAllowed=!0},Ge.incDec.updateContext=function(){},Ge._function.updateContext=Ge._class.updateContext=function(N){N.beforeExpr&&N!==Ge._else&&!(N===Ge.semi&&this.curContext()!==Me.p_stat)&&!(N===Ge._return&&Xt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((N===Ge.colon||N===Ge.braceL)&&this.curContext()===Me.b_stat)?this.context.push(Me.f_expr):this.context.push(Me.f_stat),this.exprAllowed=!1},Ge.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},Ge.backQuote.updateContext=function(){this.curContext()===Me.q_tmpl?this.context.pop():this.context.push(Me.q_tmpl),this.exprAllowed=!1},Ge.star.updateContext=function(N){if(N===Ge._function){var xe=this.context.length-1;this.context[xe]===Me.f_expr?this.context[xe]=Me.f_expr_gen:this.context[xe]=Me.f_gen}this.exprAllowed=!0},Ge.name.updateContext=function(N){var xe=!1;this.options.ecmaVersion>=6&&N!==Ge.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(xe=!0),this.exprAllowed=xe};var ne=v.prototype;ne.checkPropClash=function(N,xe,it){if(!(this.options.ecmaVersion>=9&&N.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(N.computed||N.method||N.shorthand))){var It=N.key,Wt;switch(It.type){case"Identifier":Wt=It.name;break;case"Literal":Wt=String(It.value);break;default:return}var Ii=N.kind;if(this.options.ecmaVersion>=6){Wt==="__proto__"&&Ii==="init"&&(xe.proto&&(it?it.doubleProto<0&&(it.doubleProto=It.start):this.raiseRecoverable(It.start,"Redefinition of __proto__ property")),xe.proto=!0);return}Wt="$"+Wt;var Li=xe[Wt];if(Li){var cn;Ii==="init"?cn=this.strict&&Li.init||Li.get||Li.set:cn=Li.init||Li[Ii],cn&&this.raiseRecoverable(It.start,"Redefinition of property")}else Li=xe[Wt]={init:!1,get:!1,set:!1};Li[Ii]=!0}},ne.parseExpression=function(N,xe){var it=this.start,It=this.startLoc,Wt=this.parseMaybeAssign(N,xe);if(this.type===Ge.comma){var Ii=this.startNodeAt(it,It);for(Ii.expressions=[Wt];this.eat(Ge.comma);)Ii.expressions.push(this.parseMaybeAssign(N,xe));return this.finishNode(Ii,"SequenceExpression")}return Wt},ne.parseMaybeAssign=function(N,xe,it){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(N);this.exprAllowed=!1}var It=!1,Wt=-1,Ii=-1,Li=-1;xe?(Wt=xe.parenthesizedAssign,Ii=xe.trailingComma,Li=xe.doubleProto,xe.parenthesizedAssign=xe.trailingComma=-1):(xe=new te,It=!0);var cn=this.start,fn=this.startLoc;(this.type===Ge.parenL||this.type===Ge.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=N==="await");var sr=this.parseMaybeConditional(N,xe);if(it&&(sr=it.call(this,sr,cn,fn)),this.type.isAssign){var Ar=this.startNodeAt(cn,fn);return Ar.operator=this.value,this.type===Ge.eq&&(sr=this.toAssignable(sr,!1,xe)),It||(xe.parenthesizedAssign=xe.trailingComma=xe.doubleProto=-1),xe.shorthandAssign>=sr.start&&(xe.shorthandAssign=-1),this.type===Ge.eq?this.checkLValPattern(sr):this.checkLValSimple(sr),Ar.left=sr,this.next(),Ar.right=this.parseMaybeAssign(N),Li>-1&&(xe.doubleProto=Li),this.finishNode(Ar,"AssignmentExpression")}else It&&this.checkExpressionErrors(xe,!0);return Wt>-1&&(xe.parenthesizedAssign=Wt),Ii>-1&&(xe.trailingComma=Ii),sr},ne.parseMaybeConditional=function(N,xe){var it=this.start,It=this.startLoc,Wt=this.parseExprOps(N,xe);if(this.checkExpressionErrors(xe))return Wt;if(this.eat(Ge.question)){var Ii=this.startNodeAt(it,It);return Ii.test=Wt,Ii.consequent=this.parseMaybeAssign(),this.expect(Ge.colon),Ii.alternate=this.parseMaybeAssign(N),this.finishNode(Ii,"ConditionalExpression")}return Wt},ne.parseExprOps=function(N,xe){var it=this.start,It=this.startLoc,Wt=this.parseMaybeUnary(xe,!1,!1,N);return this.checkExpressionErrors(xe)||Wt.start===it&&Wt.type==="ArrowFunctionExpression"?Wt:this.parseExprOp(Wt,it,It,-1,N)},ne.parseExprOp=function(N,xe,it,It,Wt){var Ii=this.type.binop;if(Ii!=null&&(!Wt||this.type!==Ge._in)&&Ii>It){var Li=this.type===Ge.logicalOR||this.type===Ge.logicalAND,cn=this.type===Ge.coalesce;cn&&(Ii=Ge.logicalAND.binop);var fn=this.value;this.next();var sr=this.start,Ar=this.startLoc,Or=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,Wt),sr,Ar,Ii,Wt),Ua=this.buildBinary(xe,it,N,Or,fn,Li||cn);return(Li&&this.type===Ge.coalesce||cn&&(this.type===Ge.logicalOR||this.type===Ge.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Ua,xe,it,It,Wt)}return N},ne.buildBinary=function(N,xe,it,It,Wt,Ii){It.type==="PrivateIdentifier"&&this.raise(It.start,"Private identifier can only be left side of binary expression");var Li=this.startNodeAt(N,xe);return Li.left=it,Li.operator=Wt,Li.right=It,this.finishNode(Li,Ii?"LogicalExpression":"BinaryExpression")},ne.parseMaybeUnary=function(N,xe,it,It){var Wt=this.start,Ii=this.startLoc,Li;if(this.isContextual("await")&&this.canAwait)Li=this.parseAwait(It),xe=!0;else if(this.type.prefix){var cn=this.startNode(),fn=this.type===Ge.incDec;cn.operator=this.value,cn.prefix=!0,this.next(),cn.argument=this.parseMaybeUnary(null,!0,fn,It),this.checkExpressionErrors(N,!0),fn?this.checkLValSimple(cn.argument):this.strict&&cn.operator==="delete"&&cn.argument.type==="Identifier"?this.raiseRecoverable(cn.start,"Deleting local variable in strict mode"):cn.operator==="delete"&&X(cn.argument)?this.raiseRecoverable(cn.start,"Private fields can not be deleted"):xe=!0,Li=this.finishNode(cn,fn?"UpdateExpression":"UnaryExpression")}else if(!xe&&this.type===Ge.privateId)(It||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Li=this.parsePrivateIdent(),this.type!==Ge._in&&this.unexpected();else{if(Li=this.parseExprSubscripts(N,It),this.checkExpressionErrors(N))return Li;for(;this.type.postfix&&!this.canInsertSemicolon();){var sr=this.startNodeAt(Wt,Ii);sr.operator=this.value,sr.prefix=!1,sr.argument=Li,this.checkLValSimple(Li),this.next(),Li=this.finishNode(sr,"UpdateExpression")}}if(!it&&this.eat(Ge.starstar))if(xe)this.unexpected(this.lastTokStart);else return this.buildBinary(Wt,Ii,Li,this.parseMaybeUnary(null,!1,!1,It),"**",!1);else return Li};function X(N){return N.type==="MemberExpression"&&N.property.type==="PrivateIdentifier"||N.type==="ChainExpression"&&X(N.expression)}ne.parseExprSubscripts=function(N,xe){var it=this.start,It=this.startLoc,Wt=this.parseExprAtom(N,xe);if(Wt.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return Wt;var Ii=this.parseSubscripts(Wt,it,It,!1,xe);return N&&Ii.type==="MemberExpression"&&(N.parenthesizedAssign>=Ii.start&&(N.parenthesizedAssign=-1),N.parenthesizedBind>=Ii.start&&(N.parenthesizedBind=-1),N.trailingComma>=Ii.start&&(N.trailingComma=-1)),Ii},ne.parseSubscripts=function(N,xe,it,It,Wt){for(var Ii=this.options.ecmaVersion>=8&&N.type==="Identifier"&&N.name==="async"&&this.lastTokEnd===N.end&&!this.canInsertSemicolon()&&N.end-N.start===5&&this.potentialArrowAt===N.start,Li=!1;;){var cn=this.parseSubscript(N,xe,it,It,Ii,Li,Wt);if(cn.optional&&(Li=!0),cn===N||cn.type==="ArrowFunctionExpression"){if(Li){var fn=this.startNodeAt(xe,it);fn.expression=cn,cn=this.finishNode(fn,"ChainExpression")}return cn}N=cn}},ne.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(Ge.arrow)},ne.parseSubscriptAsyncArrow=function(N,xe,it,It){return this.parseArrowExpression(this.startNodeAt(N,xe),it,!0,It)},ne.parseSubscript=function(N,xe,it,It,Wt,Ii,Li){var cn=this.options.ecmaVersion>=11,fn=cn&&this.eat(Ge.questionDot);It&&fn&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var sr=this.eat(Ge.bracketL);if(sr||fn&&this.type!==Ge.parenL&&this.type!==Ge.backQuote||this.eat(Ge.dot)){var Ar=this.startNodeAt(xe,it);Ar.object=N,sr?(Ar.property=this.parseExpression(),this.expect(Ge.bracketR)):this.type===Ge.privateId&&N.type!=="Super"?Ar.property=this.parsePrivateIdent():Ar.property=this.parseIdent(this.options.allowReserved!=="never"),Ar.computed=!!sr,cn&&(Ar.optional=fn),N=this.finishNode(Ar,"MemberExpression")}else if(!It&&this.eat(Ge.parenL)){var Or=new te,Ua=this.yieldPos,Ga=this.awaitPos,qa=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var pl=this.parseExprList(Ge.parenR,this.options.ecmaVersion>=8,!1,Or);if(Wt&&!fn&&this.shouldParseAsyncArrow())return this.checkPatternErrors(Or,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Ua,this.awaitPos=Ga,this.awaitIdentPos=qa,this.parseSubscriptAsyncArrow(xe,it,pl,Li);this.checkExpressionErrors(Or,!0),this.yieldPos=Ua||this.yieldPos,this.awaitPos=Ga||this.awaitPos,this.awaitIdentPos=qa||this.awaitIdentPos;var Gr=this.startNodeAt(xe,it);Gr.callee=N,Gr.arguments=pl,cn&&(Gr.optional=fn),N=this.finishNode(Gr,"CallExpression")}else if(this.type===Ge.backQuote){(fn||Ii)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var nr=this.startNodeAt(xe,it);nr.tag=N,nr.quasi=this.parseTemplate({isTagged:!0}),N=this.finishNode(nr,"TaggedTemplateExpression")}return N},ne.parseExprAtom=function(N,xe,it){this.type===Ge.slash&&this.readRegexp();var It,Wt=this.potentialArrowAt===this.start;switch(this.type){case Ge._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),It=this.startNode(),this.next(),this.type===Ge.parenL&&!this.allowDirectSuper&&this.raise(It.start,"super() call outside constructor of a subclass"),this.type!==Ge.dot&&this.type!==Ge.bracketL&&this.type!==Ge.parenL&&this.unexpected(),this.finishNode(It,"Super");case Ge._this:return It=this.startNode(),this.next(),this.finishNode(It,"ThisExpression");case Ge.name:var Ii=this.start,Li=this.startLoc,cn=this.containsEsc,fn=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!cn&&fn.name==="async"&&!this.canInsertSemicolon()&&this.eat(Ge._function))return this.overrideContext(Me.f_expr),this.parseFunction(this.startNodeAt(Ii,Li),0,!1,!0,xe);if(Wt&&!this.canInsertSemicolon()){if(this.eat(Ge.arrow))return this.parseArrowExpression(this.startNodeAt(Ii,Li),[fn],!1,xe);if(this.options.ecmaVersion>=8&&fn.name==="async"&&this.type===Ge.name&&!cn&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return fn=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Ge.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Ii,Li),[fn],!0,xe)}return fn;case Ge.regexp:var sr=this.value;return It=this.parseLiteral(sr.value),It.regex={pattern:sr.pattern,flags:sr.flags},It;case Ge.num:case Ge.string:return this.parseLiteral(this.value);case Ge._null:case Ge._true:case Ge._false:return It=this.startNode(),It.value=this.type===Ge._null?null:this.type===Ge._true,It.raw=this.type.keyword,this.next(),this.finishNode(It,"Literal");case Ge.parenL:var Ar=this.start,Or=this.parseParenAndDistinguishExpression(Wt,xe);return N&&(N.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Or)&&(N.parenthesizedAssign=Ar),N.parenthesizedBind<0&&(N.parenthesizedBind=Ar)),Or;case Ge.bracketL:return It=this.startNode(),this.next(),It.elements=this.parseExprList(Ge.bracketR,!0,!0,N),this.finishNode(It,"ArrayExpression");case Ge.braceL:return this.overrideContext(Me.b_expr),this.parseObj(!1,N);case Ge._function:return It=this.startNode(),this.next(),this.parseFunction(It,0);case Ge._class:return this.parseClass(this.startNode(),!1);case Ge._new:return this.parseNew();case Ge.backQuote:return this.parseTemplate();case Ge._import:return this.options.ecmaVersion>=11?this.parseExprImport(it):this.unexpected();default:return this.parseExprAtomDefault()}},ne.parseExprAtomDefault=function(){this.unexpected()},ne.parseExprImport=function(N){var xe=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===Ge.parenL&&!N)return this.parseDynamicImport(xe);if(this.type===Ge.dot){var it=this.startNodeAt(xe.start,xe.loc&&xe.loc.start);return it.name="import",xe.meta=this.finishNode(it,"Identifier"),this.parseImportMeta(xe)}else this.unexpected()},ne.parseDynamicImport=function(N){if(this.next(),N.source=this.parseMaybeAssign(),!this.eat(Ge.parenR)){var xe=this.start;this.eat(Ge.comma)&&this.eat(Ge.parenR)?this.raiseRecoverable(xe,"Trailing comma is not allowed in import()"):this.unexpected(xe)}return this.finishNode(N,"ImportExpression")},ne.parseImportMeta=function(N){this.next();var xe=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="meta"&&this.raiseRecoverable(N.property.start,"The only valid meta property for import is 'import.meta'"),xe&&this.raiseRecoverable(N.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(N.start,"Cannot use 'import.meta' outside a module"),this.finishNode(N,"MetaProperty")},ne.parseLiteral=function(N){var xe=this.startNode();return xe.value=N,xe.raw=this.input.slice(this.start,this.end),xe.raw.charCodeAt(xe.raw.length-1)===110&&(xe.bigint=xe.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(xe,"Literal")},ne.parseParenExpression=function(){this.expect(Ge.parenL);var N=this.parseExpression();return this.expect(Ge.parenR),N},ne.shouldParseArrow=function(N){return!this.canInsertSemicolon()},ne.parseParenAndDistinguishExpression=function(N,xe){var it=this.start,It=this.startLoc,Wt,Ii=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Li=this.start,cn=this.startLoc,fn=[],sr=!0,Ar=!1,Or=new te,Ua=this.yieldPos,Ga=this.awaitPos,qa;for(this.yieldPos=0,this.awaitPos=0;this.type!==Ge.parenR;)if(sr?sr=!1:this.expect(Ge.comma),Ii&&this.afterTrailingComma(Ge.parenR,!0)){Ar=!0;break}else if(this.type===Ge.ellipsis){qa=this.start,fn.push(this.parseParenItem(this.parseRestBinding())),this.type===Ge.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else fn.push(this.parseMaybeAssign(!1,Or,this.parseParenItem));var pl=this.lastTokEnd,Gr=this.lastTokEndLoc;if(this.expect(Ge.parenR),N&&this.shouldParseArrow(fn)&&this.eat(Ge.arrow))return this.checkPatternErrors(Or,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Ua,this.awaitPos=Ga,this.parseParenArrowList(it,It,fn,xe);(!fn.length||Ar)&&this.unexpected(this.lastTokStart),qa&&this.unexpected(qa),this.checkExpressionErrors(Or,!0),this.yieldPos=Ua||this.yieldPos,this.awaitPos=Ga||this.awaitPos,fn.length>1?(Wt=this.startNodeAt(Li,cn),Wt.expressions=fn,this.finishNodeAt(Wt,"SequenceExpression",pl,Gr)):Wt=fn[0]}else Wt=this.parseParenExpression();if(this.options.preserveParens){var nr=this.startNodeAt(it,It);return nr.expression=Wt,this.finishNode(nr,"ParenthesizedExpression")}else return Wt},ne.parseParenItem=function(N){return N},ne.parseParenArrowList=function(N,xe,it,It){return this.parseArrowExpression(this.startNodeAt(N,xe),it,!1,It)};var ie=[];ne.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var N=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===Ge.dot){var xe=this.startNodeAt(N.start,N.loc&&N.loc.start);xe.name="new",N.meta=this.finishNode(xe,"Identifier"),this.next();var it=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="target"&&this.raiseRecoverable(N.property.start,"The only valid meta property for new is 'new.target'"),it&&this.raiseRecoverable(N.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(N.start,"'new.target' can only be used in functions and class static block"),this.finishNode(N,"MetaProperty")}var It=this.start,Wt=this.startLoc;return N.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),It,Wt,!0,!1),this.eat(Ge.parenL)?N.arguments=this.parseExprList(Ge.parenR,this.options.ecmaVersion>=8,!1):N.arguments=ie,this.finishNode(N,"NewExpression")},ne.parseTemplateElement=function(N){var xe=N.isTagged,it=this.startNode();return this.type===Ge.invalidTemplate?(xe||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),it.value={raw:this.value,cooked:null}):it.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),it.tail=this.type===Ge.backQuote,this.finishNode(it,"TemplateElement")},ne.parseTemplate=function(N){N===void 0&&(N={});var xe=N.isTagged;xe===void 0&&(xe=!1);var it=this.startNode();this.next(),it.expressions=[];var It=this.parseTemplateElement({isTagged:xe});for(it.quasis=[It];!It.tail;)this.type===Ge.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Ge.dollarBraceL),it.expressions.push(this.parseExpression()),this.expect(Ge.braceR),it.quasis.push(It=this.parseTemplateElement({isTagged:xe}));return this.next(),this.finishNode(it,"TemplateLiteral")},ne.isAsyncProp=function(N){return!N.computed&&N.key.type==="Identifier"&&N.key.name==="async"&&(this.type===Ge.name||this.type===Ge.num||this.type===Ge.string||this.type===Ge.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Ge.star)&&!Xt.test(this.input.slice(this.lastTokEnd,this.start))},ne.parseObj=function(N,xe){var it=this.startNode(),It=!0,Wt={};for(it.properties=[],this.next();!this.eat(Ge.braceR);){if(It)It=!1;else if(this.expect(Ge.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Ge.braceR))break;var Ii=this.parseProperty(N,xe);N||this.checkPropClash(Ii,Wt,xe),it.properties.push(Ii)}return this.finishNode(it,N?"ObjectPattern":"ObjectExpression")},ne.parseProperty=function(N,xe){var it=this.startNode(),It,Wt,Ii,Li;if(this.options.ecmaVersion>=9&&this.eat(Ge.ellipsis))return N?(it.argument=this.parseIdent(!1),this.type===Ge.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(it,"RestElement")):(it.argument=this.parseMaybeAssign(!1,xe),this.type===Ge.comma&&xe&&xe.trailingComma<0&&(xe.trailingComma=this.start),this.finishNode(it,"SpreadElement"));this.options.ecmaVersion>=6&&(it.method=!1,it.shorthand=!1,(N||xe)&&(Ii=this.start,Li=this.startLoc),N||(It=this.eat(Ge.star)));var cn=this.containsEsc;return this.parsePropertyName(it),!N&&!cn&&this.options.ecmaVersion>=8&&!It&&this.isAsyncProp(it)?(Wt=!0,It=this.options.ecmaVersion>=9&&this.eat(Ge.star),this.parsePropertyName(it)):Wt=!1,this.parsePropertyValue(it,N,It,Wt,Ii,Li,xe,cn),this.finishNode(it,"Property")},ne.parseGetterSetter=function(N){N.kind=N.key.name,this.parsePropertyName(N),N.value=this.parseMethod(!1);var xe=N.kind==="get"?0:1;if(N.value.params.length!==xe){var it=N.value.start;N.kind==="get"?this.raiseRecoverable(it,"getter should have no params"):this.raiseRecoverable(it,"setter should have exactly one param")}else N.kind==="set"&&N.value.params[0].type==="RestElement"&&this.raiseRecoverable(N.value.params[0].start,"Setter cannot use rest params")},ne.parsePropertyValue=function(N,xe,it,It,Wt,Ii,Li,cn){(it||It)&&this.type===Ge.colon&&this.unexpected(),this.eat(Ge.colon)?(N.value=xe?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Li),N.kind="init"):this.options.ecmaVersion>=6&&this.type===Ge.parenL?(xe&&this.unexpected(),N.kind="init",N.method=!0,N.value=this.parseMethod(it,It)):!xe&&!cn&&this.options.ecmaVersion>=5&&!N.computed&&N.key.type==="Identifier"&&(N.key.name==="get"||N.key.name==="set")&&this.type!==Ge.comma&&this.type!==Ge.braceR&&this.type!==Ge.eq?((it||It)&&this.unexpected(),this.parseGetterSetter(N)):this.options.ecmaVersion>=6&&!N.computed&&N.key.type==="Identifier"?((it||It)&&this.unexpected(),this.checkUnreserved(N.key),N.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=Wt),N.kind="init",xe?N.value=this.parseMaybeDefault(Wt,Ii,this.copyNode(N.key)):this.type===Ge.eq&&Li?(Li.shorthandAssign<0&&(Li.shorthandAssign=this.start),N.value=this.parseMaybeDefault(Wt,Ii,this.copyNode(N.key))):N.value=this.copyNode(N.key),N.shorthand=!0):this.unexpected()},ne.parsePropertyName=function(N){if(this.options.ecmaVersion>=6){if(this.eat(Ge.bracketL))return N.computed=!0,N.key=this.parseMaybeAssign(),this.expect(Ge.bracketR),N.key;N.computed=!1}return N.key=this.type===Ge.num||this.type===Ge.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},ne.initFunction=function(N){N.id=null,this.options.ecmaVersion>=6&&(N.generator=N.expression=!1),this.options.ecmaVersion>=8&&(N.async=!1)},ne.parseMethod=function(N,xe,it){var It=this.startNode(),Wt=this.yieldPos,Ii=this.awaitPos,Li=this.awaitIdentPos;return this.initFunction(It),this.options.ecmaVersion>=6&&(It.generator=N),this.options.ecmaVersion>=8&&(It.async=!!xe),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Rr(xe,It.generator)|fi|(it?pn:0)),this.expect(Ge.parenL),It.params=this.parseBindingList(Ge.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(It,!1,!0,!1),this.yieldPos=Wt,this.awaitPos=Ii,this.awaitIdentPos=Li,this.finishNode(It,"FunctionExpression")},ne.parseArrowExpression=function(N,xe,it,It){var Wt=this.yieldPos,Ii=this.awaitPos,Li=this.awaitIdentPos;return this.enterScope(Rr(it,!1)|Ki),this.initFunction(N),this.options.ecmaVersion>=8&&(N.async=!!it),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,N.params=this.toAssignableList(xe,!0),this.parseFunctionBody(N,!0,!1,It),this.yieldPos=Wt,this.awaitPos=Ii,this.awaitIdentPos=Li,this.finishNode(N,"ArrowFunctionExpression")},ne.parseFunctionBody=function(N,xe,it,It){var Wt=xe&&this.type!==Ge.braceL,Ii=this.strict,Li=!1;if(Wt)N.body=this.parseMaybeAssign(It),N.expression=!0,this.checkParams(N,!1);else{var cn=this.options.ecmaVersion>=7&&!this.isSimpleParamList(N.params);(!Ii||cn)&&(Li=this.strictDirective(this.end),Li&&cn&&this.raiseRecoverable(N.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var fn=this.labels;this.labels=[],Li&&(this.strict=!0),this.checkParams(N,!Ii&&!Li&&!xe&&!it&&this.isSimpleParamList(N.params)),this.strict&&N.id&&this.checkLValSimple(N.id,In),N.body=this.parseBlock(!1,void 0,Li&&!Ii),N.expression=!1,this.adaptDirectivePrologue(N.body.body),this.labels=fn}this.exitScope()},ne.isSimpleParamList=function(N){for(var xe=0,it=N;xe<it.length;xe+=1){var It=it[xe];if(It.type!=="Identifier")return!1}return!0},ne.checkParams=function(N,xe){for(var it=Object.create(null),It=0,Wt=N.params;It<Wt.length;It+=1){var Ii=Wt[It];this.checkLValInnerPattern(Ii,en,xe?null:it)}},ne.parseExprList=function(N,xe,it,It){for(var Wt=[],Ii=!0;!this.eat(N);){if(Ii)Ii=!1;else if(this.expect(Ge.comma),xe&&this.afterTrailingComma(N))break;var Li=void 0;it&&this.type===Ge.comma?Li=null:this.type===Ge.ellipsis?(Li=this.parseSpread(It),It&&this.type===Ge.comma&&It.trailingComma<0&&(It.trailingComma=this.start)):Li=this.parseMaybeAssign(!1,It),Wt.push(Li)}return Wt},ne.checkUnreserved=function(N){var xe=N.start,it=N.end,It=N.name;if(this.inGenerator&&It==="yield"&&this.raiseRecoverable(xe,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&It==="await"&&this.raiseRecoverable(xe,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&It==="arguments"&&this.raiseRecoverable(xe,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(It==="arguments"||It==="await")&&this.raise(xe,"Cannot use "+It+" in class static initialization block"),this.keywords.test(It)&&this.raise(xe,"Unexpected keyword '"+It+"'"),!(this.options.ecmaVersion<6&&this.input.slice(xe,it).indexOf("\\")!==-1)){var Wt=this.strict?this.reservedWordsStrict:this.reservedWords;Wt.test(It)&&(!this.inAsync&&It==="await"&&this.raiseRecoverable(xe,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(xe,"The keyword '"+It+"' is reserved"))}},ne.parseIdent=function(N){var xe=this.parseIdentNode();return this.next(!!N),this.finishNode(xe,"Identifier"),N||(this.checkUnreserved(xe),xe.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=xe.start)),xe},ne.parseIdentNode=function(){var N=this.startNode();return this.type===Ge.name?N.name=this.value:this.type.keyword?(N.name=this.type.keyword,(N.name==="class"||N.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=Ge.name):this.unexpected(),N},ne.parsePrivateIdent=function(){var N=this.startNode();return this.type===Ge.privateId?N.name=this.value:this.unexpected(),this.next(),this.finishNode(N,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(N.start,"Private field '#"+N.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(N)),N},ne.parseYield=function(N){this.yieldPos||(this.yieldPos=this.start);var xe=this.startNode();return this.next(),this.type===Ge.semi||this.canInsertSemicolon()||this.type!==Ge.star&&!this.type.startsExpr?(xe.delegate=!1,xe.argument=null):(xe.delegate=this.eat(Ge.star),xe.argument=this.parseMaybeAssign(N)),this.finishNode(xe,"YieldExpression")},ne.parseAwait=function(N){this.awaitPos||(this.awaitPos=this.start);var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeUnary(null,!0,!1,N),this.finishNode(xe,"AwaitExpression")};var de=v.prototype;de.raise=function(N,xe){var it=tn(this.input,N);xe+=" ("+it.line+":"+it.column+")";var It=new SyntaxError(xe);throw It.pos=N,It.loc=it,It.raisedAt=this.pos,It},de.raiseRecoverable=de.raise,de.curPosition=function(){if(this.options.locations)return new Ti(this.curLine,this.pos-this.lineStart)};var ye=v.prototype,ge=function(xe){this.flags=xe,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};ye.enterScope=function(N){this.scopeStack.push(new ge(N))},ye.exitScope=function(){this.scopeStack.pop()},ye.treatFunctionsAsVarInScope=function(N){return N.flags&gi||!this.inModule&&N.flags&Ci},ye.declareName=function(N,xe,it){var It=!1;if(xe===tr){var Wt=this.currentScope();It=Wt.lexical.indexOf(N)>-1||Wt.functions.indexOf(N)>-1||Wt.var.indexOf(N)>-1,Wt.lexical.push(N),this.inModule&&Wt.flags&Ci&&delete this.undefinedExports[N]}else if(xe===Qn){var Ii=this.currentScope();Ii.lexical.push(N)}else if(xe===Fn){var Li=this.currentScope();this.treatFunctionsAsVar?It=Li.lexical.indexOf(N)>-1:It=Li.lexical.indexOf(N)>-1||Li.var.indexOf(N)>-1,Li.functions.push(N)}else for(var cn=this.scopeStack.length-1;cn>=0;--cn){var fn=this.scopeStack[cn];if(fn.lexical.indexOf(N)>-1&&!(fn.flags&Ji&&fn.lexical[0]===N)||!this.treatFunctionsAsVarInScope(fn)&&fn.functions.indexOf(N)>-1){It=!0;break}if(fn.var.push(N),this.inModule&&fn.flags&Ci&&delete this.undefinedExports[N],fn.flags&wn)break}It&&this.raiseRecoverable(it,"Identifier '"+N+"' has already been declared")},ye.checkLocalExport=function(N){this.scopeStack[0].lexical.indexOf(N.name)===-1&&this.scopeStack[0].var.indexOf(N.name)===-1&&(this.undefinedExports[N.name]=N)},ye.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},ye.currentVarScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&wn)return xe}},ye.currentThisScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&wn&&!(xe.flags&Ki))return xe}};var Pe=function(xe,it,It){this.type="",this.start=it,this.end=0,xe.options.locations&&(this.loc=new Oi(xe,It)),xe.options.directSourceFile&&(this.sourceFile=xe.options.directSourceFile),xe.options.ranges&&(this.range=[it,0])},Fe=v.prototype;Fe.startNode=function(){return new Pe(this,this.start,this.startLoc)},Fe.startNodeAt=function(N,xe){return new Pe(this,N,xe)};function Ne(N,xe,it,It){return N.type=xe,N.end=it,this.options.locations&&(N.loc.end=It),this.options.ranges&&(N.range[1]=it),N}Fe.finishNode=function(N,xe){return Ne.call(this,N,xe,this.lastTokEnd,this.lastTokEndLoc)},Fe.finishNodeAt=function(N,xe,it,It){return Ne.call(this,N,xe,it,It)},Fe.copyNode=function(N){var xe=new Pe(this,N.start,this.startLoc);for(var it in N)xe[it]=N[it];return xe};var Xe="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Ye=Xe+" Extended_Pictographic",De=Ye,Ue=De+" EBase EComp EMod EPres ExtPict",ht=Ue,kt=ht,o={9:Xe,10:Ye,11:De,12:Ue,13:ht,14:kt},ke="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",oi={9:"",10:"",11:"",12:"",13:"",14:ke},di="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ai="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Jt=Ai+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",li=Jt+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",zi=li+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",vi=zi+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",wi=vi+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",$t={9:Ai,10:Jt,11:li,12:zi,13:vi,14:wi},vn={};function or(N){var xe=vn[N]={binary:Ot(o[N]+" "+di),binaryOfStrings:Ot(oi[N]),nonBinary:{General_Category:Ot(di),Script:Ot($t[N])}};xe.nonBinary.Script_Extensions=xe.nonBinary.Script,xe.nonBinary.gc=xe.nonBinary.General_Category,xe.nonBinary.sc=xe.nonBinary.Script,xe.nonBinary.scx=xe.nonBinary.Script_Extensions}for(var mn=0,qn=[9,10,11,12,13,14];mn<qn.length;mn+=1){var jr=qn[mn];or(jr)}var Hi=v.prototype,ur=function(xe){this.parser=xe,this.validFlags="gim"+(xe.options.ecmaVersion>=6?"uy":"")+(xe.options.ecmaVersion>=9?"s":"")+(xe.options.ecmaVersion>=13?"d":"")+(xe.options.ecmaVersion>=15?"v":""),this.unicodeProperties=vn[xe.options.ecmaVersion>=14?14:xe.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};ur.prototype.reset=function(xe,it,It){var Wt=It.indexOf("v")!==-1,Ii=It.indexOf("u")!==-1;this.start=xe|0,this.source=it+"",this.flags=It,Wt&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Ii&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Ii&&this.parser.options.ecmaVersion>=9)},ur.prototype.raise=function(xe){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+xe)},ur.prototype.at=function(xe,it){it===void 0&&(it=!1);var It=this.source,Wt=It.length;if(xe>=Wt)return-1;var Ii=It.charCodeAt(xe);if(!(it||this.switchU)||Ii<=55295||Ii>=57344||xe+1>=Wt)return Ii;var Li=It.charCodeAt(xe+1);return Li>=56320&&Li<=57343?(Ii<<10)+Li-56613888:Ii},ur.prototype.nextIndex=function(xe,it){it===void 0&&(it=!1);var It=this.source,Wt=It.length;if(xe>=Wt)return Wt;var Ii=It.charCodeAt(xe),Li;return!(it||this.switchU)||Ii<=55295||Ii>=57344||xe+1>=Wt||(Li=It.charCodeAt(xe+1))<56320||Li>57343?xe+1:xe+2},ur.prototype.current=function(xe){return xe===void 0&&(xe=!1),this.at(this.pos,xe)},ur.prototype.lookahead=function(xe){return xe===void 0&&(xe=!1),this.at(this.nextIndex(this.pos,xe),xe)},ur.prototype.advance=function(xe){xe===void 0&&(xe=!1),this.pos=this.nextIndex(this.pos,xe)},ur.prototype.eat=function(xe,it){return it===void 0&&(it=!1),this.current(it)===xe?(this.advance(it),!0):!1},ur.prototype.eatChars=function(xe,it){it===void 0&&(it=!1);for(var It=this.pos,Wt=0,Ii=xe;Wt<Ii.length;Wt+=1){var Li=Ii[Wt],cn=this.at(It,it);if(cn===-1||cn!==Li)return!1;It=this.nextIndex(It,it)}return this.pos=It,!0},Hi.validateRegExpFlags=function(N){for(var xe=N.validFlags,it=N.flags,It=!1,Wt=!1,Ii=0;Ii<it.length;Ii++){var Li=it.charAt(Ii);xe.indexOf(Li)===-1&&this.raise(N.start,"Invalid regular expression flag"),it.indexOf(Li,Ii+1)>-1&&this.raise(N.start,"Duplicate regular expression flag"),Li==="u"&&(It=!0),Li==="v"&&(Wt=!0)}this.options.ecmaVersion>=15&&It&&Wt&&this.raise(N.start,"Invalid regular expression flag")},Hi.validateRegExpPattern=function(N){this.regexp_pattern(N),!N.switchN&&this.options.ecmaVersion>=9&&N.groupNames.length>0&&(N.switchN=!0,this.regexp_pattern(N))},Hi.regexp_pattern=function(N){N.pos=0,N.lastIntValue=0,N.lastStringValue="",N.lastAssertionIsQuantifiable=!1,N.numCapturingParens=0,N.maxBackReference=0,N.groupNames.length=0,N.backReferenceNames.length=0,this.regexp_disjunction(N),N.pos!==N.source.length&&(N.eat(41)&&N.raise("Unmatched ')'"),(N.eat(93)||N.eat(125))&&N.raise("Lone quantifier brackets")),N.maxBackReference>N.numCapturingParens&&N.raise("Invalid escape");for(var xe=0,it=N.backReferenceNames;xe<it.length;xe+=1){var It=it[xe];N.groupNames.indexOf(It)===-1&&N.raise("Invalid named capture referenced")}},Hi.regexp_disjunction=function(N){for(this.regexp_alternative(N);N.eat(124);)this.regexp_alternative(N);this.regexp_eatQuantifier(N,!0)&&N.raise("Nothing to repeat"),N.eat(123)&&N.raise("Lone quantifier brackets")},Hi.regexp_alternative=function(N){for(;N.pos<N.source.length&&this.regexp_eatTerm(N););},Hi.regexp_eatTerm=function(N){return this.regexp_eatAssertion(N)?(N.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(N)&&N.switchU&&N.raise("Invalid quantifier"),!0):(N.switchU?this.regexp_eatAtom(N):this.regexp_eatExtendedAtom(N))?(this.regexp_eatQuantifier(N),!0):!1},Hi.regexp_eatAssertion=function(N){var xe=N.pos;if(N.lastAssertionIsQuantifiable=!1,N.eat(94)||N.eat(36))return!0;if(N.eat(92)){if(N.eat(66)||N.eat(98))return!0;N.pos=xe}if(N.eat(40)&&N.eat(63)){var it=!1;if(this.options.ecmaVersion>=9&&(it=N.eat(60)),N.eat(61)||N.eat(33))return this.regexp_disjunction(N),N.eat(41)||N.raise("Unterminated group"),N.lastAssertionIsQuantifiable=!it,!0}return N.pos=xe,!1},Hi.regexp_eatQuantifier=function(N,xe){return xe===void 0&&(xe=!1),this.regexp_eatQuantifierPrefix(N,xe)?(N.eat(63),!0):!1},Hi.regexp_eatQuantifierPrefix=function(N,xe){return N.eat(42)||N.eat(43)||N.eat(63)||this.regexp_eatBracedQuantifier(N,xe)},Hi.regexp_eatBracedQuantifier=function(N,xe){var it=N.pos;if(N.eat(123)){var It=0,Wt=-1;if(this.regexp_eatDecimalDigits(N)&&(It=N.lastIntValue,N.eat(44)&&this.regexp_eatDecimalDigits(N)&&(Wt=N.lastIntValue),N.eat(125)))return Wt!==-1&&Wt<It&&!xe&&N.raise("numbers out of order in {} quantifier"),!0;N.switchU&&!xe&&N.raise("Incomplete quantifier"),N.pos=it}return!1},Hi.regexp_eatAtom=function(N){return this.regexp_eatPatternCharacters(N)||N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)},Hi.regexp_eatReverseSolidusAtomEscape=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatAtomEscape(N))return!0;N.pos=xe}return!1},Hi.regexp_eatUncapturingGroup=function(N){var xe=N.pos;if(N.eat(40)){if(N.eat(63)&&N.eat(58)){if(this.regexp_disjunction(N),N.eat(41))return!0;N.raise("Unterminated group")}N.pos=xe}return!1},Hi.regexp_eatCapturingGroup=function(N){if(N.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(N):N.current()===63&&N.raise("Invalid group"),this.regexp_disjunction(N),N.eat(41))return N.numCapturingParens+=1,!0;N.raise("Unterminated group")}return!1},Hi.regexp_eatExtendedAtom=function(N){return N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)||this.regexp_eatInvalidBracedQuantifier(N)||this.regexp_eatExtendedPatternCharacter(N)},Hi.regexp_eatInvalidBracedQuantifier=function(N){return this.regexp_eatBracedQuantifier(N,!0)&&N.raise("Nothing to repeat"),!1},Hi.regexp_eatSyntaxCharacter=function(N){var xe=N.current();return On(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function On(N){return N===36||N>=40&&N<=43||N===46||N===63||N>=91&&N<=94||N>=123&&N<=125}Hi.regexp_eatPatternCharacters=function(N){for(var xe=N.pos,it=0;(it=N.current())!==-1&&!On(it);)N.advance();return N.pos!==xe},Hi.regexp_eatExtendedPatternCharacter=function(N){var xe=N.current();return xe!==-1&&xe!==36&&!(xe>=40&&xe<=43)&&xe!==46&&xe!==63&&xe!==91&&xe!==94&&xe!==124?(N.advance(),!0):!1},Hi.regexp_groupSpecifier=function(N){if(N.eat(63)){if(this.regexp_eatGroupName(N)){N.groupNames.indexOf(N.lastStringValue)!==-1&&N.raise("Duplicate capture group name"),N.groupNames.push(N.lastStringValue);return}N.raise("Invalid group")}},Hi.regexp_eatGroupName=function(N){if(N.lastStringValue="",N.eat(60)){if(this.regexp_eatRegExpIdentifierName(N)&&N.eat(62))return!0;N.raise("Invalid capture group name")}return!1},Hi.regexp_eatRegExpIdentifierName=function(N){if(N.lastStringValue="",this.regexp_eatRegExpIdentifierStart(N)){for(N.lastStringValue+=_i(N.lastIntValue);this.regexp_eatRegExpIdentifierPart(N);)N.lastStringValue+=_i(N.lastIntValue);return!0}return!1},Hi.regexp_eatRegExpIdentifierStart=function(N){var xe=N.pos,it=this.options.ecmaVersion>=11,It=N.current(it);return N.advance(it),It===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,it)&&(It=N.lastIntValue),Qt(It)?(N.lastIntValue=It,!0):(N.pos=xe,!1)};function Qt(N){return Ke(N,!0)||N===36||N===95}Hi.regexp_eatRegExpIdentifierPart=function(N){var xe=N.pos,it=this.options.ecmaVersion>=11,It=N.current(it);return N.advance(it),It===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,it)&&(It=N.lastIntValue),Yi(It)?(N.lastIntValue=It,!0):(N.pos=xe,!1)};function Yi(N){return ot(N,!0)||N===36||N===95||N===8204||N===8205}Hi.regexp_eatAtomEscape=function(N){return this.regexp_eatBackReference(N)||this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)||N.switchN&&this.regexp_eatKGroupName(N)?!0:(N.switchU&&(N.current()===99&&N.raise("Invalid unicode escape"),N.raise("Invalid escape")),!1)},Hi.regexp_eatBackReference=function(N){var xe=N.pos;if(this.regexp_eatDecimalEscape(N)){var it=N.lastIntValue;if(N.switchU)return it>N.maxBackReference&&(N.maxBackReference=it),!0;if(it<=N.numCapturingParens)return!0;N.pos=xe}return!1},Hi.regexp_eatKGroupName=function(N){if(N.eat(107)){if(this.regexp_eatGroupName(N))return N.backReferenceNames.push(N.lastStringValue),!0;N.raise("Invalid named reference")}return!1},Hi.regexp_eatCharacterEscape=function(N){return this.regexp_eatControlEscape(N)||this.regexp_eatCControlLetter(N)||this.regexp_eatZero(N)||this.regexp_eatHexEscapeSequence(N)||this.regexp_eatRegExpUnicodeEscapeSequence(N,!1)||!N.switchU&&this.regexp_eatLegacyOctalEscapeSequence(N)||this.regexp_eatIdentityEscape(N)},Hi.regexp_eatCControlLetter=function(N){var xe=N.pos;if(N.eat(99)){if(this.regexp_eatControlLetter(N))return!0;N.pos=xe}return!1},Hi.regexp_eatZero=function(N){return N.current()===48&&!Pr(N.lookahead())?(N.lastIntValue=0,N.advance(),!0):!1},Hi.regexp_eatControlEscape=function(N){var xe=N.current();return xe===116?(N.lastIntValue=9,N.advance(),!0):xe===110?(N.lastIntValue=10,N.advance(),!0):xe===118?(N.lastIntValue=11,N.advance(),!0):xe===102?(N.lastIntValue=12,N.advance(),!0):xe===114?(N.lastIntValue=13,N.advance(),!0):!1},Hi.regexp_eatControlLetter=function(N){var xe=N.current();return Ut(xe)?(N.lastIntValue=xe%32,N.advance(),!0):!1};function Ut(N){return N>=65&&N<=90||N>=97&&N<=122}Hi.regexp_eatRegExpUnicodeEscapeSequence=function(N,xe){xe===void 0&&(xe=!1);var it=N.pos,It=xe||N.switchU;if(N.eat(117)){if(this.regexp_eatFixedHexDigits(N,4)){var Wt=N.lastIntValue;if(It&&Wt>=55296&&Wt<=56319){var Ii=N.pos;if(N.eat(92)&&N.eat(117)&&this.regexp_eatFixedHexDigits(N,4)){var Li=N.lastIntValue;if(Li>=56320&&Li<=57343)return N.lastIntValue=(Wt-55296)*1024+(Li-56320)+65536,!0}N.pos=Ii,N.lastIntValue=Wt}return!0}if(It&&N.eat(123)&&this.regexp_eatHexDigits(N)&&N.eat(125)&&Tn(N.lastIntValue))return!0;It&&N.raise("Invalid unicode escape"),N.pos=it}return!1};function Tn(N){return N>=0&&N<=1114111}Hi.regexp_eatIdentityEscape=function(N){if(N.switchU)return this.regexp_eatSyntaxCharacter(N)?!0:N.eat(47)?(N.lastIntValue=47,!0):!1;var xe=N.current();return xe!==99&&(!N.switchN||xe!==107)?(N.lastIntValue=xe,N.advance(),!0):!1},Hi.regexp_eatDecimalEscape=function(N){N.lastIntValue=0;var xe=N.current();if(xe>=49&&xe<=57){do N.lastIntValue=10*N.lastIntValue+(xe-48),N.advance();while((xe=N.current())>=48&&xe<=57);return!0}return!1};var cr=0,Ns=1,Ur=2;Hi.regexp_eatCharacterClassEscape=function(N){var xe=N.current();if(Vt(xe))return N.lastIntValue=-1,N.advance(),Ns;var it=!1;if(N.switchU&&this.options.ecmaVersion>=9&&((it=xe===80)||xe===112)){N.lastIntValue=-1,N.advance();var It;if(N.eat(123)&&(It=this.regexp_eatUnicodePropertyValueExpression(N))&&N.eat(125))return it&&It===Ur&&N.raise("Invalid property name"),It;N.raise("Invalid property name")}return cr};function Vt(N){return N===100||N===68||N===115||N===83||N===119||N===87}Hi.regexp_eatUnicodePropertyValueExpression=function(N){var xe=N.pos;if(this.regexp_eatUnicodePropertyName(N)&&N.eat(61)){var it=N.lastStringValue;if(this.regexp_eatUnicodePropertyValue(N)){var It=N.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(N,it,It),Ns}}if(N.pos=xe,this.regexp_eatLoneUnicodePropertyNameOrValue(N)){var Wt=N.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(N,Wt)}return cr},Hi.regexp_validateUnicodePropertyNameAndValue=function(N,xe,it){st(N.unicodeProperties.nonBinary,xe)||N.raise("Invalid property name"),N.unicodeProperties.nonBinary[xe].test(it)||N.raise("Invalid property value")},Hi.regexp_validateUnicodePropertyNameOrValue=function(N,xe){if(N.unicodeProperties.binary.test(xe))return Ns;if(N.switchV&&N.unicodeProperties.binaryOfStrings.test(xe))return Ur;N.raise("Invalid property name")},Hi.regexp_eatUnicodePropertyName=function(N){var xe=0;for(N.lastStringValue="";hr(xe=N.current());)N.lastStringValue+=_i(xe),N.advance();return N.lastStringValue!==""};function hr(N){return Ut(N)||N===95}Hi.regexp_eatUnicodePropertyValue=function(N){var xe=0;for(N.lastStringValue="";Lt(xe=N.current());)N.lastStringValue+=_i(xe),N.advance();return N.lastStringValue!==""};function Lt(N){return hr(N)||Pr(N)}Hi.regexp_eatLoneUnicodePropertyNameOrValue=function(N){return this.regexp_eatUnicodePropertyValue(N)},Hi.regexp_eatCharacterClass=function(N){if(N.eat(91)){var xe=N.eat(94),it=this.regexp_classContents(N);return N.eat(93)||N.raise("Unterminated character class"),xe&&it===Ur&&N.raise("Negated character class may contain strings"),!0}return!1},Hi.regexp_classContents=function(N){return N.current()===93?Ns:N.switchV?this.regexp_classSetExpression(N):(this.regexp_nonEmptyClassRanges(N),Ns)},Hi.regexp_nonEmptyClassRanges=function(N){for(;this.regexp_eatClassAtom(N);){var xe=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassAtom(N)){var it=N.lastIntValue;N.switchU&&(xe===-1||it===-1)&&N.raise("Invalid character class"),xe!==-1&&it!==-1&&xe>it&&N.raise("Range out of order in character class")}}},Hi.regexp_eatClassAtom=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatClassEscape(N))return!0;if(N.switchU){var it=N.current();(it===99||Oa(it))&&N.raise("Invalid class escape"),N.raise("Invalid escape")}N.pos=xe}var It=N.current();return It!==93?(N.lastIntValue=It,N.advance(),!0):!1},Hi.regexp_eatClassEscape=function(N){var xe=N.pos;if(N.eat(98))return N.lastIntValue=8,!0;if(N.switchU&&N.eat(45))return N.lastIntValue=45,!0;if(!N.switchU&&N.eat(99)){if(this.regexp_eatClassControlLetter(N))return!0;N.pos=xe}return this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)},Hi.regexp_classSetExpression=function(N){var xe=Ns,it;if(!this.regexp_eatClassSetRange(N))if(it=this.regexp_eatClassSetOperand(N)){it===Ur&&(xe=Ur);for(var It=N.pos;N.eatChars([38,38]);){if(N.current()!==38&&(it=this.regexp_eatClassSetOperand(N))){it!==Ur&&(xe=Ns);continue}N.raise("Invalid character in character class")}if(It!==N.pos)return xe;for(;N.eatChars([45,45]);)this.regexp_eatClassSetOperand(N)||N.raise("Invalid character in character class");if(It!==N.pos)return xe}else N.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(N)){if(it=this.regexp_eatClassSetOperand(N),!it)return xe;it===Ur&&(xe=Ur)}},Hi.regexp_eatClassSetRange=function(N){var xe=N.pos;if(this.regexp_eatClassSetCharacter(N)){var it=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassSetCharacter(N)){var It=N.lastIntValue;return it!==-1&&It!==-1&&it>It&&N.raise("Range out of order in character class"),!0}N.pos=xe}return!1},Hi.regexp_eatClassSetOperand=function(N){return this.regexp_eatClassSetCharacter(N)?Ns:this.regexp_eatClassStringDisjunction(N)||this.regexp_eatNestedClass(N)},Hi.regexp_eatNestedClass=function(N){var xe=N.pos;if(N.eat(91)){var it=N.eat(94),It=this.regexp_classContents(N);if(N.eat(93))return it&&It===Ur&&N.raise("Negated character class may contain strings"),It;N.pos=xe}if(N.eat(92)){var Wt=this.regexp_eatCharacterClassEscape(N);if(Wt)return Wt;N.pos=xe}return null},Hi.regexp_eatClassStringDisjunction=function(N){var xe=N.pos;if(N.eatChars([92,113])){if(N.eat(123)){var it=this.regexp_classStringDisjunctionContents(N);if(N.eat(125))return it}else N.raise("Invalid escape");N.pos=xe}return null},Hi.regexp_classStringDisjunctionContents=function(N){for(var xe=this.regexp_classString(N);N.eat(124);)this.regexp_classString(N)===Ur&&(xe=Ur);return xe},Hi.regexp_classString=function(N){for(var xe=0;this.regexp_eatClassSetCharacter(N);)xe++;return xe===1?Ns:Ur},Hi.regexp_eatClassSetCharacter=function(N){var xe=N.pos;if(N.eat(92))return this.regexp_eatCharacterEscape(N)||this.regexp_eatClassSetReservedPunctuator(N)?!0:N.eat(98)?(N.lastIntValue=8,!0):(N.pos=xe,!1);var it=N.current();return it<0||it===N.lookahead()&&Fr(it)||Vs(it)?!1:(N.advance(),N.lastIntValue=it,!0)};function Fr(N){return N===33||N>=35&&N<=38||N>=42&&N<=44||N===46||N>=58&&N<=64||N===94||N===96||N===126}function Vs(N){return N===40||N===41||N===45||N===47||N>=91&&N<=93||N>=123&&N<=125}Hi.regexp_eatClassSetReservedPunctuator=function(N){var xe=N.current();return ua(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function ua(N){return N===33||N===35||N===37||N===38||N===44||N===45||N>=58&&N<=62||N===64||N===96||N===126}Hi.regexp_eatClassControlLetter=function(N){var xe=N.current();return Pr(xe)||xe===95?(N.lastIntValue=xe%32,N.advance(),!0):!1},Hi.regexp_eatHexEscapeSequence=function(N){var xe=N.pos;if(N.eat(120)){if(this.regexp_eatFixedHexDigits(N,2))return!0;N.switchU&&N.raise("Invalid escape"),N.pos=xe}return!1},Hi.regexp_eatDecimalDigits=function(N){var xe=N.pos,it=0;for(N.lastIntValue=0;Pr(it=N.current());)N.lastIntValue=10*N.lastIntValue+(it-48),N.advance();return N.pos!==xe};function Pr(N){return N>=48&&N<=57}Hi.regexp_eatHexDigits=function(N){var xe=N.pos,it=0;for(N.lastIntValue=0;Fa(it=N.current());)N.lastIntValue=16*N.lastIntValue+zo(it),N.advance();return N.pos!==xe};function Fa(N){return N>=48&&N<=57||N>=65&&N<=70||N>=97&&N<=102}function zo(N){return N>=65&&N<=70?10+(N-65):N>=97&&N<=102?10+(N-97):N-48}Hi.regexp_eatLegacyOctalEscapeSequence=function(N){if(this.regexp_eatOctalDigit(N)){var xe=N.lastIntValue;if(this.regexp_eatOctalDigit(N)){var it=N.lastIntValue;xe<=3&&this.regexp_eatOctalDigit(N)?N.lastIntValue=xe*64+it*8+N.lastIntValue:N.lastIntValue=xe*8+it}else N.lastIntValue=xe;return!0}return!1},Hi.regexp_eatOctalDigit=function(N){var xe=N.current();return Oa(xe)?(N.lastIntValue=xe-48,N.advance(),!0):(N.lastIntValue=0,!1)};function Oa(N){return N>=48&&N<=55}Hi.regexp_eatFixedHexDigits=function(N,xe){var it=N.pos;N.lastIntValue=0;for(var It=0;It<xe;++It){var Wt=N.current();if(!Fa(Wt))return N.pos=it,!1;N.lastIntValue=16*N.lastIntValue+zo(Wt),N.advance()}return!0};var Ys=function(xe){this.type=xe.type,this.value=xe.value,this.start=xe.start,this.end=xe.end,xe.options.locations&&(this.loc=new Oi(xe,xe.startLoc,xe.endLoc)),xe.options.ranges&&(this.range=[xe.start,xe.end])},Zn=v.prototype;Zn.next=function(N){!N&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Ys(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Zn.getToken=function(){return this.next(),new Ys(this)},typeof Symbol<"u"&&(Zn[Symbol.iterator]=function(){var N=this;return{next:function(){var xe=N.getToken();return{done:xe.type===Ge.eof,value:xe}}}}),Zn.nextToken=function(){var N=this.curContext();if((!N||!N.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(Ge.eof);if(N.override)return N.override(this);this.readToken(this.fullCharCodeAtPos())},Zn.readToken=function(N){return Ke(N,this.options.ecmaVersion>=6)||N===92?this.readWord():this.getTokenFromCode(N)},Zn.fullCharCodeAtPos=function(){var N=this.input.charCodeAt(this.pos);if(N<=55295||N>=56320)return N;var xe=this.input.charCodeAt(this.pos+1);return xe<=56319||xe>=57344?N:(N<<10)+xe-56613888},Zn.skipBlockComment=function(){var N=this.options.onComment&&this.curPosition(),xe=this.pos,it=this.input.indexOf("*/",this.pos+=2);if(it===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=it+2,this.options.locations)for(var It=void 0,Wt=xe;(It=pt(this.input,Wt,this.pos))>-1;)++this.curLine,Wt=this.lineStart=It;this.options.onComment&&this.options.onComment(!0,this.input.slice(xe+2,it),xe,this.pos,N,this.curPosition())},Zn.skipLineComment=function(N){for(var xe=this.pos,it=this.options.onComment&&this.curPosition(),It=this.input.charCodeAt(this.pos+=N);this.pos<this.input.length&&!yt(It);)It=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(xe+N,this.pos),xe,this.pos,it,this.curPosition())},Zn.skipSpace=function(){e:for(;this.pos<this.input.length;){var N=this.input.charCodeAt(this.pos);switch(N){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(N>8&&N<14||N>=5760&&gt.test(String.fromCharCode(N)))++this.pos;else break e}}},Zn.finishToken=function(N,xe){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var it=this.type;this.type=N,this.value=xe,this.updateContext(it)},Zn.readToken_dot=function(){var N=this.input.charCodeAt(this.pos+1);if(N>=48&&N<=57)return this.readNumber(!0);var xe=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&N===46&&xe===46?(this.pos+=3,this.finishToken(Ge.ellipsis)):(++this.pos,this.finishToken(Ge.dot))},Zn.readToken_slash=function(){var N=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):N===61?this.finishOp(Ge.assign,2):this.finishOp(Ge.slash,1)},Zn.readToken_mult_modulo_exp=function(N){var xe=this.input.charCodeAt(this.pos+1),it=1,It=N===42?Ge.star:Ge.modulo;return this.options.ecmaVersion>=7&&N===42&&xe===42&&(++it,It=Ge.starstar,xe=this.input.charCodeAt(this.pos+2)),xe===61?this.finishOp(Ge.assign,it+1):this.finishOp(It,it)},Zn.readToken_pipe_amp=function(N){var xe=this.input.charCodeAt(this.pos+1);if(xe===N){if(this.options.ecmaVersion>=12){var it=this.input.charCodeAt(this.pos+2);if(it===61)return this.finishOp(Ge.assign,3)}return this.finishOp(N===124?Ge.logicalOR:Ge.logicalAND,2)}return xe===61?this.finishOp(Ge.assign,2):this.finishOp(N===124?Ge.bitwiseOR:Ge.bitwiseAND,1)},Zn.readToken_caret=function(){var N=this.input.charCodeAt(this.pos+1);return N===61?this.finishOp(Ge.assign,2):this.finishOp(Ge.bitwiseXOR,1)},Zn.readToken_plus_min=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===N?xe===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Xt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(Ge.incDec,2):xe===61?this.finishOp(Ge.assign,2):this.finishOp(Ge.plusMin,1)},Zn.readToken_lt_gt=function(N){var xe=this.input.charCodeAt(this.pos+1),it=1;return xe===N?(it=N===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+it)===61?this.finishOp(Ge.assign,it+1):this.finishOp(Ge.bitShift,it)):xe===33&&N===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(xe===61&&(it=2),this.finishOp(Ge.relational,it))},Zn.readToken_eq_excl=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===61?this.finishOp(Ge.equality,this.input.charCodeAt(this.pos+2)===61?3:2):N===61&&xe===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Ge.arrow)):this.finishOp(N===61?Ge.eq:Ge.prefix,1)},Zn.readToken_question=function(){var N=this.options.ecmaVersion;if(N>=11){var xe=this.input.charCodeAt(this.pos+1);if(xe===46){var it=this.input.charCodeAt(this.pos+2);if(it<48||it>57)return this.finishOp(Ge.questionDot,2)}if(xe===63){if(N>=12){var It=this.input.charCodeAt(this.pos+2);if(It===61)return this.finishOp(Ge.assign,3)}return this.finishOp(Ge.coalesce,2)}}return this.finishOp(Ge.question,1)},Zn.readToken_numberSign=function(){var N=this.options.ecmaVersion,xe=35;if(N>=13&&(++this.pos,xe=this.fullCharCodeAtPos(),Ke(xe,!0)||xe===92))return this.finishToken(Ge.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+_i(xe)+"'")},Zn.getTokenFromCode=function(N){switch(N){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Ge.parenL);case 41:return++this.pos,this.finishToken(Ge.parenR);case 59:return++this.pos,this.finishToken(Ge.semi);case 44:return++this.pos,this.finishToken(Ge.comma);case 91:return++this.pos,this.finishToken(Ge.bracketL);case 93:return++this.pos,this.finishToken(Ge.bracketR);case 123:return++this.pos,this.finishToken(Ge.braceL);case 125:return++this.pos,this.finishToken(Ge.braceR);case 58:return++this.pos,this.finishToken(Ge.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Ge.backQuote);case 48:var xe=this.input.charCodeAt(this.pos+1);if(xe===120||xe===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(xe===111||xe===79)return this.readRadixNumber(8);if(xe===98||xe===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(N);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(N);case 124:case 38:return this.readToken_pipe_amp(N);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(N);case 60:case 62:return this.readToken_lt_gt(N);case 61:case 33:return this.readToken_eq_excl(N);case 63:return this.readToken_question();case 126:return this.finishOp(Ge.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+_i(N)+"'")},Zn.finishOp=function(N,xe){var it=this.input.slice(this.pos,this.pos+xe);return this.pos+=xe,this.finishToken(N,it)},Zn.readRegexp=function(){for(var N,xe,it=this.pos;;){this.pos>=this.input.length&&this.raise(it,"Unterminated regular expression");var It=this.input.charAt(this.pos);if(Xt.test(It)&&this.raise(it,"Unterminated regular expression"),N)N=!1;else{if(It==="[")xe=!0;else if(It==="]"&&xe)xe=!1;else if(It==="/"&&!xe)break;N=It==="\\"}++this.pos}var Wt=this.input.slice(it,this.pos);++this.pos;var Ii=this.pos,Li=this.readWord1();this.containsEsc&&this.unexpected(Ii);var cn=this.regexpState||(this.regexpState=new ur(this));cn.reset(it,Wt,Li),this.validateRegExpFlags(cn),this.validateRegExpPattern(cn);var fn=null;try{fn=new RegExp(Wt,Li)}catch{}return this.finishToken(Ge.regexp,{pattern:Wt,flags:Li,value:fn})},Zn.readInt=function(N,xe,it){for(var It=this.options.ecmaVersion>=12&&xe===void 0,Wt=it&&this.input.charCodeAt(this.pos)===48,Ii=this.pos,Li=0,cn=0,fn=0,sr=xe??1/0;fn<sr;++fn,++this.pos){var Ar=this.input.charCodeAt(this.pos),Or=void 0;if(It&&Ar===95){Wt&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),cn===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),fn===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),cn=Ar;continue}if(Ar>=97?Or=Ar-97+10:Ar>=65?Or=Ar-65+10:Ar>=48&&Ar<=57?Or=Ar-48:Or=1/0,Or>=N)break;cn=Ar,Li=Li*N+Or}return It&&cn===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ii||xe!=null&&this.pos-Ii!==xe?null:Li};function aa(N,xe){return xe?parseInt(N,8):parseFloat(N.replace(/_/g,""))}function ls(N){return typeof BigInt!="function"?null:BigInt(N.replace(/_/g,""))}Zn.readRadixNumber=function(N){var xe=this.pos;this.pos+=2;var it=this.readInt(N);return it==null&&this.raise(this.start+2,"Expected number in radix "+N),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(it=ls(this.input.slice(xe,this.pos)),++this.pos):Ke(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Ge.num,it)},Zn.readNumber=function(N){var xe=this.pos;!N&&this.readInt(10,void 0,!0)===null&&this.raise(xe,"Invalid number");var it=this.pos-xe>=2&&this.input.charCodeAt(xe)===48;it&&this.strict&&this.raise(xe,"Invalid number");var It=this.input.charCodeAt(this.pos);if(!it&&!N&&this.options.ecmaVersion>=11&&It===110){var Wt=ls(this.input.slice(xe,this.pos));return++this.pos,Ke(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Ge.num,Wt)}it&&/[89]/.test(this.input.slice(xe,this.pos))&&(it=!1),It===46&&!it&&(++this.pos,this.readInt(10),It=this.input.charCodeAt(this.pos)),(It===69||It===101)&&!it&&(It=this.input.charCodeAt(++this.pos),(It===43||It===45)&&++this.pos,this.readInt(10)===null&&this.raise(xe,"Invalid number")),Ke(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ii=aa(this.input.slice(xe,this.pos),it);return this.finishToken(Ge.num,Ii)},Zn.readCodePoint=function(){var N=this.input.charCodeAt(this.pos),xe;if(N===123){this.options.ecmaVersion<6&&this.unexpected();var it=++this.pos;xe=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,xe>1114111&&this.invalidStringToken(it,"Code point out of bounds")}else xe=this.readHexChar(4);return xe},Zn.readString=function(N){for(var xe="",it=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var It=this.input.charCodeAt(this.pos);if(It===N)break;It===92?(xe+=this.input.slice(it,this.pos),xe+=this.readEscapedChar(!1),it=this.pos):It===8232||It===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(yt(It)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return xe+=this.input.slice(it,this.pos++),this.finishToken(Ge.string,xe)};var Na={};Zn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(N){if(N===Na)this.readInvalidTemplateToken();else throw N}this.inTemplateElement=!1},Zn.invalidStringToken=function(N,xe){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Na;this.raise(N,xe)},Zn.readTmplToken=function(){for(var N="",xe=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var it=this.input.charCodeAt(this.pos);if(it===96||it===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===Ge.template||this.type===Ge.invalidTemplate)?it===36?(this.pos+=2,this.finishToken(Ge.dollarBraceL)):(++this.pos,this.finishToken(Ge.backQuote)):(N+=this.input.slice(xe,this.pos),this.finishToken(Ge.template,N));if(it===92)N+=this.input.slice(xe,this.pos),N+=this.readEscapedChar(!0),xe=this.pos;else if(yt(it)){switch(N+=this.input.slice(xe,this.pos),++this.pos,it){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:N+=`
`;break;default:N+=String.fromCharCode(it);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),xe=this.pos}else++this.pos}},Zn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(Ge.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Zn.readEscapedChar=function(N){var xe=this.input.charCodeAt(++this.pos);switch(++this.pos,xe){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return _i(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),N){var it=this.pos-1;this.invalidStringToken(it,"Invalid escape sequence in template string")}default:if(xe>=48&&xe<=55){var It=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],Wt=parseInt(It,8);return Wt>255&&(It=It.slice(0,-1),Wt=parseInt(It,8)),this.pos+=It.length-1,xe=this.input.charCodeAt(this.pos),(It!=="0"||xe===56||xe===57)&&(this.strict||N)&&this.invalidStringToken(this.pos-1-It.length,N?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(Wt)}return yt(xe)?"":String.fromCharCode(xe)}},Zn.readHexChar=function(N){var xe=this.pos,it=this.readInt(16,N);return it===null&&this.invalidStringToken(xe,"Bad character escape sequence"),it},Zn.readWord1=function(){this.containsEsc=!1;for(var N="",xe=!0,it=this.pos,It=this.options.ecmaVersion>=6;this.pos<this.input.length;){var Wt=this.fullCharCodeAtPos();if(ot(Wt,It))this.pos+=Wt<=65535?1:2;else if(Wt===92){this.containsEsc=!0,N+=this.input.slice(it,this.pos);var Ii=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Li=this.readCodePoint();(xe?Ke:ot)(Li,It)||this.invalidStringToken(Ii,"Invalid Unicode escape"),N+=_i(Li),it=this.pos}else break;xe=!1}return N+this.input.slice(it,this.pos)},Zn.readWord=function(){var N=this.readWord1(),xe=Ge.name;return this.keywords.test(N)&&(xe=Pt[N]),this.finishToken(xe,N)};var al="8.11.3";v.acorn={Parser:v,version:al,defaultOptions:qi,Position:Ti,SourceLocation:Oi,getLineInfo:tn,Node:Pe,TokenType:tt,tokTypes:Ge,keywordTypes:Pt,TokContext:nt,tokContexts:Me,isIdentifierChar:ot,isIdentifierStart:Ke,Token:Ys,isNewLine:yt,lineBreak:Xt,lineBreakG:rt,nonASCIIwhitespace:gt};function ol(N,xe){return v.parse(N,xe)}function to(N,xe,it){return v.parseExpressionAt(N,xe,it)}function Va(N,xe){return v.tokenizer(N,xe)}n.Node=Pe,n.Parser=v,n.Position=Ti,n.SourceLocation=Oi,n.TokContext=nt,n.Token=Ys,n.TokenType=tt,n.defaultOptions=qi,n.getLineInfo=tn,n.isIdentifierChar=ot,n.isIdentifierStart=Ke,n.isNewLine=yt,n.keywordTypes=Pt,n.lineBreak=Xt,n.lineBreakG=rt,n.nonASCIIwhitespace=gt,n.parse=ol,n.parseExpressionAt=to,n.tokContexts=Me,n.tokTypes=Ge,n.tokenizer=Va,n.version=al})}(Ug,Ug.exports)),Ug.exports}/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(e){(function(t,n){t=t||vx;var c=t.window,g=t.document,b=new function(){var v=/^(statics|enumerable|beans|preserve)$/,k=[],V=k.slice,$=Object.create,te=Object.getOwnPropertyDescriptor,fe=Object.defineProperty,ve=k.forEach||function(Ze,Ve){for(var ft=0,nt=this.length;ft<nt;ft++)Ze.call(Ve,this[ft],ft,this)},Ie=function(Ze,Ve){for(var ft in this)this.hasOwnProperty(ft)&&Ze.call(Ve,this[ft],ft,this)},Ee=Object.assign||function(Ze){for(var Ve=1,ft=arguments.length;Ve<ft;Ve++){var nt=arguments[Ve];for(var Me in nt)nt.hasOwnProperty(Me)&&(Ze[Me]=nt[Me])}return Ze},ze=function(Ze,Ve,ft){if(Ze){var nt=te(Ze,"length");(nt&&typeof nt.value=="number"?ve:Ie).call(Ze,Ve,ft=ft||Ze)}return ft};function Qe(Ze,Ve,ft,nt,Me){var se={};function ne(ge,Pe){Pe=Pe||(Pe=te(Ve,ge))&&(Pe.get?Pe:Pe.value),typeof Pe=="string"&&Pe[0]==="#"&&(Pe=Ze[Pe.substring(1)]||Pe);var Fe=typeof Pe=="function",Ne=Pe,Xe=Me||Fe&&!Pe.base?Pe&&Pe.get?ge in Ze:Ze[ge]:null,Ye;(!Me||!Xe)&&(Fe&&Xe&&(Pe.base=Xe),Fe&&nt!==!1&&(Ye=ge.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(se[Ye[3].toLowerCase()+Ye[4]]=Ye[2]),(!Ne||Fe||!Ne.get||typeof Ne.get!="function"||!He.isPlainObject(Ne))&&(Ne={value:Ne,writable:!0}),(te(Ze,ge)||{configurable:!0}).configurable&&(Ne.configurable=!0,Ne.enumerable=ft??!Ye),fe(Ze,ge,Ne))}if(Ve){for(var X in Ve)Ve.hasOwnProperty(X)&&!v.test(X)&&ne(X);for(var X in se){var ie=se[X],de=Ze["set"+ie],ye=Ze["get"+ie]||de&&Ze["is"+ie];ye&&(nt===!0||ye.length===0)&&ne(X,{get:ye,set:de})}}return Ze}function He(){for(var Ze=0,Ve=arguments.length;Ze<Ve;Ze++){var ft=arguments[Ze];ft&&Ee(this,ft)}return this}return Qe(He,{inject:function(Ze){if(Ze){var Ve=Ze.statics===!0?Ze:Ze.statics,ft=Ze.beans,nt=Ze.preserve;Ve!==Ze&&Qe(this.prototype,Ze,Ze.enumerable,ft,nt),Qe(this,Ve,null,ft,nt)}for(var Me=1,se=arguments.length;Me<se;Me++)this.inject(arguments[Me]);return this},extend:function(){for(var Ze=this,Ve,ft,nt=0,Me,se=arguments.length;nt<se&&!(Ve&&ft);nt++)Me=arguments[nt],Ve=Ve||Me.initialize,ft=ft||Me.prototype;return Ve=Ve||function(){Ze.apply(this,arguments)},ft=Ve.prototype=ft||$(this.prototype),fe(ft,"constructor",{value:Ve,writable:!0,configurable:!0}),Qe(Ve,this),arguments.length&&this.inject.apply(Ve,arguments),Ve.base=Ze,Ve}}).inject({enumerable:!1,initialize:He,set:He,inject:function(){for(var Ze=0,Ve=arguments.length;Ze<Ve;Ze++){var ft=arguments[Ze];ft&&Qe(this,ft,ft.enumerable,ft.beans,ft.preserve)}return this},extend:function(){var Ze=$(this);return Ze.inject.apply(Ze,arguments)},each:function(Ze,Ve){return ze(this,Ze,Ve)},clone:function(){return new this.constructor(this)},statics:{set:Ee,each:ze,create:$,define:fe,describe:te,clone:function(Ze){return Ee(new Ze.constructor,Ze)},isPlainObject:function(Ze){var Ve=Ze!=null&&Ze.constructor;return Ve&&(Ve===Object||Ve===He||Ve.name==="Object")},pick:function(Ze,Ve){return Ze!==n?Ze:Ve},slice:function(Ze,Ve,ft){return V.call(Ze,Ve,ft)}}})};e.exports=b,b.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+b.each(this,function(v,k){if(!/^_/.test(k)){var V=typeof v;this.push(k+": "+(V==="number"?he.instance.number(v):V==="string"?"'"+v+"'":v))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(v){return b.importJSON(v,this)},exportJSON:function(v){return b.exportJSON(this,v)},toJSON:function(){return b.serialize(this)},set:function(v,k){return v&&b.filter(this,v,k,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function v(){var k=v.base.apply(this,arguments),V=k.prototype._class;return V&&!b.exports[V]&&(b.exports[V]=k),k},equals:function(v,k){if(v===k)return!0;if(v&&v.equals)return v.equals(k);if(k&&k.equals)return k.equals(v);if(v&&k&&typeof v=="object"&&typeof k=="object"){if(Array.isArray(v)&&Array.isArray(k)){var V=v.length;if(V!==k.length)return!1;for(;V--;)if(!b.equals(v[V],k[V]))return!1}else{var $=Object.keys(v),V=$.length;if(V!==Object.keys(k).length)return!1;for(;V--;){var te=$[V];if(!(k.hasOwnProperty(te)&&b.equals(v[te],k[te])))return!1}}return!0}return!1},read:function(v,k,V,$){if(this===b){var te=this.peek(v,k);return v.__index++,te}var fe=this.prototype,ve=fe._readIndex,Ie=k||ve&&v.__index||0,Ee=v.length,ze=v[Ie];if($=$||Ee-Ie,ze instanceof this||V&&V.readNull&&ze==null&&$<=1)return ve&&(v.__index=Ie+1),ze&&V&&V.clone?ze.clone():ze;if(ze=b.create(fe),ve&&(ze.__read=!0),ze=ze.initialize.apply(ze,Ie>0||Ie+$<Ee?b.slice(v,Ie,Ie+$):v)||ze,ve){v.__index=Ie+ze.__read;var Qe=ze.__filtered;Qe&&(v.__filtered=Qe,ze.__filtered=n),ze.__read=n}return ze},peek:function(v,k){return v[v.__index=k||v.__index||0]},remain:function(v){return v.length-(v.__index||0)},readList:function(v,k,V,$){for(var te=[],fe,ve=k||0,Ie=$?ve+$:v.length,Ee=ve;Ee<Ie;Ee++)te.push(Array.isArray(fe=v[Ee])?this.read(fe,0,V):this.read(v,Ee,V,1));return te},readNamed:function(v,k,V,$,te){var fe=this.getNamed(v,k),ve=fe!==n;if(ve){var Ie=v.__filtered;if(!Ie){var Ee=this.getSource(v);Ie=v.__filtered=b.create(Ee),Ie.__unfiltered=Ee}Ie[k]=n}return this.read(ve?[fe]:v,V,$,te)},readSupported:function(v,k){var V=this.getSource(v),$=this,te=!1;return V&&Object.keys(V).forEach(function(fe){if(fe in k){var ve=$.readNamed(v,fe);ve!==n&&(k[fe]=ve),te=!0}}),te},getSource:function(v){var k=v.__source;if(k===n){var V=v.length===1&&v[0];k=v.__source=V&&b.isPlainObject(V)?V:null}return k},getNamed:function(v,k){var V=this.getSource(v);if(V)return k?V[k]:v.__filtered||V},hasNamed:function(v,k){return!!this.getNamed(v,k)},filter:function(v,k,V,$){var te;function fe(Qe){if(!(V&&Qe in V)&&!(te&&Qe in te)){var He=k[Qe];He!==n&&(v[Qe]=He)}}if($){for(var ve={},Ie=0,Ee,ze=$.length;Ie<ze;Ie++)(Ee=$[Ie])in k&&(fe(Ee),ve[Ee]=!0);te=ve}return Object.keys(k.__unfiltered||k).forEach(fe),v},isPlainValue:function(v,k){return b.isPlainObject(v)||Array.isArray(v)||k&&typeof v=="string"},serialize:function(v,k,V,$){k=k||{};var te=!$,fe;if(te&&(k.formatter=new he(k.precision),$={length:0,definitions:{},references:{},add:function(He,Ze){var Ve="#"+He._id,ft=this.references[Ve];if(!ft){this.length++;var nt=Ze.call(He),Me=He._class;Me&&nt[0]!==Me&&nt.unshift(Me),this.definitions[Ve]=nt,ft=this.references[Ve]=[Ve]}return ft}}),v&&v._serialize){fe=v._serialize(k,$);var ve=v._class;ve&&!v._compactSerialize&&(te||!V)&&fe[0]!==ve&&fe.unshift(ve)}else if(Array.isArray(v)){fe=[];for(var Ie=0,Ee=v.length;Ie<Ee;Ie++)fe[Ie]=b.serialize(v[Ie],k,V,$)}else if(b.isPlainObject(v)){fe={};for(var ze=Object.keys(v),Ie=0,Ee=ze.length;Ie<Ee;Ie++){var Qe=ze[Ie];fe[Qe]=b.serialize(v[Qe],k,V,$)}}else typeof v=="number"?fe=k.formatter.number(v,k.precision):fe=v;return te&&$.length>0?[["dictionary",$.definitions],fe]:fe},deserialize:function(v,k,V,$,te){var fe=v,ve=!V,Ie=ve&&v&&v.length&&v[0][0]==="dictionary";if(V=V||{},Array.isArray(v)){var Ee=v[0],ze=Ee==="dictionary";if(v.length==1&&/^#/.test(Ee))return V.dictionary[Ee];Ee=b.exports[Ee],fe=[];for(var Qe=Ee?1:0,He=v.length;Qe<He;Qe++)fe.push(b.deserialize(v[Qe],k,V,ze,Ie));if(Ee){var Ze=fe;k?fe=k(Ee,Ze,ve||te):fe=new Ee(Ze)}}else if(b.isPlainObject(v)){fe={},$&&(V.dictionary=fe);for(var Ve in v)fe[Ve]=b.deserialize(v[Ve],k,V)}return Ie?fe[1]:fe},exportJSON:function(v,k){var V=b.serialize(v,k);return k&&k.asString==!1?V:JSON.stringify(V)},importJSON:function(v,k){return b.deserialize(typeof v=="string"?JSON.parse(v):v,function(V,$,te){var fe=te&&k&&k.constructor===V,ve=fe?k:b.create(V.prototype);if($.length===1&&ve instanceof Ge&&(fe||!(ve instanceof rt))){var Ie=$[0];b.isPlainObject(Ie)&&(Ie.insert=!1,fe&&($=$.concat([Ge.INSERT])))}return(fe?ve.set:V).apply(ve,$),fe&&(k=null),ve})},push:function(v,k){var V=k.length;if(V<4096)v.push.apply(v,k);else{var $=v.length;v.length+=V;for(var te=0;te<V;te++)v[$+te]=k[te]}return v},splice:function(v,k,V,$){var te=k&&k.length,fe=V===n;V=fe?v.length:V,V>v.length&&(V=v.length);for(var ve=0;ve<te;ve++)k[ve]._index=V+ve;if(fe)return b.push(v,k),[];var Ie=[V,$];k&&b.push(Ie,k);for(var Ee=v.splice.apply(v,Ie),ve=0,ze=Ee.length;ve<ze;ve++)Ee[ve]._index=n;for(var ve=V+te,ze=v.length;ve<ze;ve++)v[ve]._index=ve;return Ee},capitalize:function(v){return v.replace(/\b[a-z]/g,function(k){return k.toUpperCase()})},camelize:function(v){return v.replace(/-(.)/g,function(k,V){return V.toUpperCase()})},hyphenate:function(v){return v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var I={on:function(v,k){if(typeof v!="string")b.each(v,function(fe,ve){this.on(ve,fe)},this);else{var V=this._eventTypes,$=V&&V[v],te=this._callbacks=this._callbacks||{};te=te[v]=te[v]||[],te.indexOf(k)===-1&&(te.push(k),$&&$.install&&te.length===1&&$.install.call(this,v))}return this},off:function(v,k){if(typeof v!="string"){b.each(v,function(ve,Ie){this.off(Ie,ve)},this);return}var V=this._eventTypes,$=V&&V[v],te=this._callbacks&&this._callbacks[v],fe;return te&&(!k||(fe=te.indexOf(k))!==-1&&te.length===1?($&&$.uninstall&&$.uninstall.call(this,v),delete this._callbacks[v]):fe!==-1&&te.splice(fe,1)),this},once:function(v,k){return this.on(v,function V(){k.apply(this,arguments),this.off(v,V)})},emit:function(v,k){var V=this._callbacks&&this._callbacks[v];if(!V)return!1;var $=b.slice(arguments,1),te=k&&k.target&&!k.currentTarget;V=V.slice(),te&&(k.currentTarget=this);for(var fe=0,ve=V.length;fe<ve;fe++)if(V[fe].apply(this,$)==!1){k&&k.stop&&k.stop();break}return te&&delete k.currentTarget,!0},responds:function(v){return!!(this._callbacks&&this._callbacks[v])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(v){var k=this._eventTypes,V=this._callbacks,$=v?"install":"uninstall";if(k){for(var te in V)if(V[te].length>0){var fe=k[te],ve=fe&&fe[$];ve&&ve.call(this,te)}}},statics:{inject:function v(k){var V=k._events;if(V){var $={};b.each(V,function(te,fe){var ve=typeof te=="string",Ie=ve?te:fe,Ee=b.capitalize(Ie),ze=Ie.substring(2).toLowerCase();$[ze]=ve?{}:te,Ie="_"+Ie,k["get"+Ee]=function(){return this[Ie]},k["set"+Ee]=function(Qe){var He=this[Ie];He&&this.off(ze,He),Qe&&this.on(ze,Qe),this[Ie]=Qe}}),k._eventTypes=$}return v.base.apply(this,arguments)}}},a=b.extend({_class:"PaperScope",initialize:function v(){In=this,this.settings=new b({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=v._id++,v._scopes[this._id]=this;var k=v.prototype;if(!this.support){var V=en.getContext(1,1)||{};k.support={nativeDash:"setLineDash"in V||"mozDash"in V,nativeBlendModes:tr.nativeModes},en.release(V)}if(!this.agent){var $=t.navigator.userAgent.toLowerCase(),te=(/(darwin|win|mac|linux|freebsd|sunos)/.exec($)||[])[0],fe=te==="darwin"?"mac":te,ve=k.agent=k.browser={platform:fe};fe&&(ve[fe]=!0),$.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(Ie,Ee,ze,Qe,He){if(!ve.chrome){var Ze=Ee==="opera"?Qe:/^(node|trident)$/.test(Ee)?He:ze;ve.version=Ze,ve.versionNumber=parseFloat(Ze),Ee={trident:"msie",jsdom:"node"}[Ee]||Ee,ve.name=Ee,ve[Ee]=!0}}),ve.chrome&&delete ve.webkit,ve.atom&&delete ve.chrome}},version:"0.12.17",getView:function(){var v=this.project;return v&&v._view},getPaper:function(){return this},execute:function(v,k){var V=In.PaperScript.execute(v,this,k);return Ri.updateFocus(),V},install:function(v){var k=this;b.each(["project","view","tool"],function($){b.define(v,$,{configurable:!0,get:function(){return k[$]}})});for(var V in this)!/^_/.test(V)&&this[V]&&(v[V]=this[V])},setup:function(v){return In=this,this.project=new zt(v),this},createCanvas:function(v,k){return en.getCanvas(v,k)},activate:function(){In=this},clear:function(){for(var v=this.projects,k=this.tools,V=v.length-1;V>=0;V--)v[V].remove();for(var V=k.length-1;V>=0;V--)k[V].remove()},remove:function(){this.clear(),delete a._scopes[this._id]},statics:new function(){function v(k){return k+="Attribute",function(V,$){return V[k]($)||V[k]("data-paper-"+$)}}return{_scopes:{},_id:0,get:function(k){return this._scopes[k]||null},getAttribute:v("get"),hasAttribute:v("has")}}}),G=b.extend(I,{initialize:function(v){this._scope=In,this._index=this._scope[this._list].push(this)-1,(v||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var v=this._scope[this._reference];return v&&v!==this&&v.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",v),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(b.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),W={findItemBoundsCollisions:function(v,k,V){function $(ve){for(var Ie=new Array(ve.length),Ee=0;Ee<ve.length;Ee++){var ze=ve[Ee].getBounds();Ie[Ee]=[ze.left,ze.top,ze.right,ze.bottom]}return Ie}var te=$(v),fe=!k||k===v?te:$(k);return this.findBoundsCollisions(te,fe,V||0)},findCurveBoundsCollisions:function(v,k,V,$){function te(Ze){for(var Ve=Math.min,ft=Math.max,nt=new Array(Ze.length),Me=0;Me<Ze.length;Me++){var se=Ze[Me];nt[Me]=[Ve(se[0],se[2],se[4],se[6]),Ve(se[1],se[3],se[5],se[7]),ft(se[0],se[2],se[4],se[6]),ft(se[1],se[3],se[5],se[7])]}return nt}var fe=te(v),ve=!k||k===v?fe:te(k);if($){for(var Ie=this.findBoundsCollisions(fe,ve,V||0,!1,!0),Ee=this.findBoundsCollisions(fe,ve,V||0,!0,!0),ze=[],Qe=0,He=Ie.length;Qe<He;Qe++)ze[Qe]={hor:Ie[Qe],ver:Ee[Qe]};return ze}return this.findBoundsCollisions(fe,ve,V||0)},findBoundsCollisions:function(v,k,V,$,te){var fe=!k||v===k,ve=fe?v:v.concat(k),Ie=v.length,Ee=ve.length;function ze(oi,di,Ai){for(var Jt=0,li=oi.length;Jt<li;){var zi=li+Jt>>>1;ve[oi[zi]][di]<Ai?Jt=zi+1:li=zi}return Jt-1}for(var Qe=$?1:0,He=Qe+2,Ze=$?0:1,Ve=Ze+2,ft=new Array(Ee),nt=0;nt<Ee;nt++)ft[nt]=nt;ft.sort(function(oi,di){return ve[oi][Qe]-ve[di][Qe]});for(var Me=[],se=new Array(Ie),nt=0;nt<Ee;nt++){var ne=ft[nt],X=ve[ne],ie=fe?ne:ne-Ie,de=ne<Ie,ye=fe||!de,ge=de?[]:null;if(Me.length){var Pe=ze(Me,He,X[Qe]-V)+1;if(Me.splice(0,Pe),fe&&te){ge=ge.concat(Me);for(var Fe=0;Fe<Me.length;Fe++){var Ne=Me[Fe];se[Ne].push(ie)}}else for(var Xe=X[Ve],Ye=X[Ze],Fe=0;Fe<Me.length;Fe++){var Ne=Me[Fe],De=ve[Ne],Ue=Ne<Ie,ht=fe||Ne>=Ie;(te||(de&&ht||ye&&Ue)&&Xe>=De[Ze]-V&&Ye<=De[Ve]+V)&&(de&&ht&&ge.push(fe?Ne:Ne-Ie),ye&&Ue&&se[Ne].push(ie))}}if(de&&(v===k&&ge.push(ne),se[ne]=ge),Me.length){var kt=X[He],o=ze(Me,He,kt);Me.splice(o+1,0,ne)}else Me.push(ne)}for(var nt=0;nt<se.length;nt++){var ke=se[nt];ke&&ke.sort(function(di,Ai){return di-Ai})}return se}},he=b.extend({initialize:function(v){this.precision=b.pick(v,5),this.multiplier=Math.pow(10,this.precision)},number:function(v){return this.precision<16?Math.round(v*this.multiplier)/this.multiplier:v},pair:function(v,k,V){return this.number(v)+(V||",")+this.number(k)},point:function(v,k){return this.number(v.x)+(k||",")+this.number(v.y)},size:function(v,k){return this.number(v.width)+(k||",")+this.number(v.height)},rectangle:function(v,k){return this.point(v,k)+(k||",")+this.size(v,k)}});he.instance=new he;var ae=new function(){var v=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],k=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],V=Math.abs,$=Math.sqrt,te=Math.pow,fe=Math.log2||function(He){return Math.log(He)*Math.LOG2E},ve=1e-12,Ie=112e-18;function Ee(He,Ze,Ve){return He<Ze?Ze:He>Ve?Ve:He}function ze(He,Ze,Ve){function ft(Pe){var Fe=Pe*134217729,Ne=Pe-Fe,Xe=Ne+Fe,Ye=Pe-Xe;return[Xe,Ye]}var nt=Ze*Ze-He*Ve,Me=Ze*Ze+He*Ve;if(V(nt)*3<Me){var se=ft(He),ne=ft(Ze),X=ft(Ve),ie=Ze*Ze,de=ne[0]*ne[0]-ie+2*ne[0]*ne[1]+ne[1]*ne[1],ye=He*Ve,ge=se[0]*X[0]-ye+se[0]*X[1]+se[1]*X[0]+se[1]*X[1];nt=ie-ye+(de-ge)}return nt}function Qe(){var He=Math.max.apply(Math,arguments);return He&&(He<1e-8||He>1e8)?te(2,-Math.round(fe(He))):0}return{EPSILON:ve,MACHINE_EPSILON:Ie,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*($(2)-1)/3,isZero:function(He){return He>=-ve&&He<=ve},isMachineZero:function(He){return He>=-Ie&&He<=Ie},clamp:Ee,integrate:function(He,Ze,Ve,ft){for(var nt=v[ft-2],Me=k[ft-2],se=(Ve-Ze)*.5,ne=se+Ze,X=0,ie=ft+1>>1,de=ft&1?Me[X++]*He(ne):0;X<ie;){var ye=se*nt[X];de+=Me[X++]*(He(ne+ye)+He(ne-ye))}return se*de},findRoot:function(He,Ze,Ve,ft,nt,Me,se){for(var ne=0;ne<Me;ne++){var X=He(Ve),ie=X/Ze(Ve),de=Ve-ie;if(V(ie)<se){Ve=de;break}X>0?(nt=Ve,Ve=de<=ft?(ft+nt)*.5:de):(ft=Ve,Ve=de>=nt?(ft+nt)*.5:de)}return Ee(Ve,ft,nt)},solveQuadratic:function(He,Ze,Ve,ft,nt,Me){var se,ne=1/0;if(V(He)<ve){if(V(Ze)<ve)return V(Ve)<ve?-1:0;se=-Ve/Ze}else{Ze*=-.5;var X=ze(He,Ze,Ve);if(X&&V(X)<Ie){var ie=Qe(V(He),V(Ze),V(Ve));ie&&(He*=ie,Ze*=ie,Ve*=ie,X=ze(He,Ze,Ve))}if(X>=-Ie){var de=X<0?0:$(X),ye=Ze+(Ze<0?-de:de);ye===0?(se=Ve/He,ne=-se):(se=ye/He,ne=Ve/ye)}}var ge=0,Pe=nt==null,Fe=nt-ve,Ne=Me+ve;return isFinite(se)&&(Pe||se>Fe&&se<Ne)&&(ft[ge++]=Pe?se:Ee(se,nt,Me)),ne!==se&&isFinite(ne)&&(Pe||ne>Fe&&ne<Ne)&&(ft[ge++]=Pe?ne:Ee(ne,nt,Me)),ge},solveCubic:function(He,Ze,Ve,ft,nt,Me,se){var ne=Qe(V(He),V(Ze),V(Ve),V(ft)),X,ie,de,ye,ge;ne&&(He*=ne,Ze*=ne,Ve*=ne,ft*=ne);function Pe(o){X=o;var ke=He*X;ie=ke+Ze,de=ie*X+Ve,ye=(ke+ie)*X+de,ge=de*X+ft}if(V(He)<ve)He=Ze,ie=Ve,de=ft,X=1/0;else if(V(ft)<ve)ie=Ze,de=Ve,X=0;else{Pe(-(Ze/He)/3);var Fe=ge/He,Ne=te(V(Fe),1/3),Xe=Fe<0?-1:1,Ye=-ye/He,De=Ye>0?1.324717957244746*Math.max(Ne,$(Ye)):Ne,Ue=X-Xe*De;if(Ue!==X){do Pe(Ue),Ue=ye===0?X:X-ge/ye/(1+Ie);while(Xe*Ue>Xe*X);V(He)*X*X>V(ft/X)&&(de=-ft/X,ie=(de-Ve)/X)}}var ht=ae.solveQuadratic(He,ie,de,nt,Me,se),kt=Me==null;return isFinite(X)&&(ht===0||ht>0&&X!==nt[0]&&X!==nt[1])&&(kt||X>Me-ve&&X<se+ve)&&(nt[ht++]=kt?X:Ee(X,Me,se)),ht}}},ue={_id:1,_pools:{},get:function(v){if(v){var k=this._pools[v];return k||(k=this._pools[v]={_id:1}),k._id++}else return this._id++}},be=b.extend({_class:"Point",_readIndex:!0,initialize:function(k,V){var $=typeof k,te=this.__read,fe=0;if($==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(fe=ve?2:1)}else if($==="undefined"||k===null)this._set(0,0),te&&(fe=k===null?1:0);else{var Ie=$==="string"?k.split(/[\s,]+/)||[]:k;fe=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"x"in Ie?this._set(Ie.x||0,Ie.y||0):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"angle"in Ie?(this._set(Ie.length||0,0),this.setAngle(Ie.angle||0)):(this._set(0,0),fe=0)}return te&&(this.__read=fe),this},set:"#initialize",_set:function(v,k){return this.x=v,this.y=k,this},equals:function(v){return this===v||v&&(this.x===v.x&&this.y===v.y||Array.isArray(v)&&this.x===v[0]&&this.y===v[1])||!1},clone:function(){return new be(this.x,this.y)},toString:function(){var v=he.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(v){if(this.isZero()){var k=this._angle||0;this._set(Math.cos(k)*v,Math.sin(k)*v)}else{var V=v/this.getLength();ae.isZero(V)&&this.getAngle(),this._set(this.x*V,this.y*V)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(v){this.setAngleInRadians.call(this,v*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var v=be.read(arguments),k=this.getLength()*v.getLength();if(ae.isZero(k))return NaN;var V=this.dot(v)/k;return Math.acos(V<-1?-1:V>1?1:V)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(v){if(this._angle=v,!this.isZero()){var k=this.getLength();this._set(Math.cos(v)*k,Math.sin(v)*k)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var v=be.read(arguments);return Math.atan2(this.cross(v),this.dot(v))*180/Math.PI},getDistance:function(){var v=arguments,k=be.read(v),V=k.x-this.x,$=k.y-this.y,te=V*V+$*$,fe=b.read(v);return fe?te:Math.sqrt(te)},normalize:function(v){v===n&&(v=1);var k=this.getLength(),V=k!==0?v/k:0,$=new be(this.x*V,this.y*V);return V>=0&&($._angle=this._angle),$},rotate:function(v,k){if(v===0)return this.clone();v=v*Math.PI/180;var V=k?this.subtract(k):this,$=Math.sin(v),te=Math.cos(v);return V=new be(V.x*te-V.y*$,V.x*$+V.y*te),k?V.add(k):V},transform:function(v){return v?v._transformPoint(this):this},add:function(){var v=be.read(arguments);return new be(this.x+v.x,this.y+v.y)},subtract:function(){var v=be.read(arguments);return new be(this.x-v.x,this.y-v.y)},multiply:function(){var v=be.read(arguments);return new be(this.x*v.x,this.y*v.y)},divide:function(){var v=be.read(arguments);return new be(this.x/v.x,this.y/v.y)},modulo:function(){var v=be.read(arguments);return new be(this.x%v.x,this.y%v.y)},negate:function(){return new be(-this.x,-this.y)},isInside:function(){return lt.read(arguments).contains(this)},isClose:function(){var v=arguments,k=be.read(v),V=b.read(v);return this.getDistance(k)<=V},isCollinear:function(){var v=be.read(arguments);return be.isCollinear(this.x,this.y,v.x,v.y)},isColinear:"#isCollinear",isOrthogonal:function(){var v=be.read(arguments);return be.isOrthogonal(this.x,this.y,v.x,v.y)},isZero:function(){var v=ae.isZero;return v(this.x)&&v(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(v){return this.x*(v>1&&v<4?-1:1)>=0&&this.y*(v>2?-1:1)>=0},dot:function(){var v=be.read(arguments);return this.x*v.x+this.y*v.y},cross:function(){var v=be.read(arguments);return this.x*v.y-this.y*v.x},project:function(){var v=be.read(arguments),k=v.isZero()?0:this.dot(v)/v.dot(v);return new be(v.x*k,v.y*k)},statics:{min:function(){var v=arguments,k=be.read(v),V=be.read(v);return new be(Math.min(k.x,V.x),Math.min(k.y,V.y))},max:function(){var v=arguments,k=be.read(v),V=be.read(v);return new be(Math.max(k.x,V.x),Math.max(k.y,V.y))},random:function(){return new be(Math.random(),Math.random())},isCollinear:function(v,k,V,$){return Math.abs(v*$-k*V)<=Math.sqrt((v*v+k*k)*(V*V+$*$))*1e-8},isOrthogonal:function(v,k,V,$){return Math.abs(v*V+k*$)<=Math.sqrt((v*v+k*k)*(V*V+$*$))*1e-8}}},b.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new be(k(this.x),k(this.y))}},{})),Ke=be.extend({initialize:function(k,V,$,te){this._x=k,this._y=V,this._owner=$,this._setter=te},_set:function(v,k,V){return this._x=v,this._y=k,V||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),ot=b.extend({_class:"Size",_readIndex:!0,initialize:function(k,V){var $=typeof k,te=this.__read,fe=0;if($==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(fe=ve?2:1)}else if($==="undefined"||k===null)this._set(0,0),te&&(fe=k===null?1:0);else{var Ie=$==="string"?k.split(/[\s,]+/)||[]:k;fe=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"x"in Ie?this._set(Ie.x||0,Ie.y||0):(this._set(0,0),fe=0)}return te&&(this.__read=fe),this},set:"#initialize",_set:function(v,k){return this.width=v,this.height=k,this},equals:function(v){return v===this||v&&(this.width===v.width&&this.height===v.height||Array.isArray(v)&&this.width===v[0]&&this.height===v[1])||!1},clone:function(){return new ot(this.width,this.height)},toString:function(){var v=he.instance;return"{ width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.width),k.number(this.height)]},add:function(){var v=ot.read(arguments);return new ot(this.width+v.width,this.height+v.height)},subtract:function(){var v=ot.read(arguments);return new ot(this.width-v.width,this.height-v.height)},multiply:function(){var v=ot.read(arguments);return new ot(this.width*v.width,this.height*v.height)},divide:function(){var v=ot.read(arguments);return new ot(this.width/v.width,this.height/v.height)},modulo:function(){var v=ot.read(arguments);return new ot(this.width%v.width,this.height%v.height)},negate:function(){return new ot(-this.width,-this.height)},isZero:function(){var v=ae.isZero;return v(this.width)&&v(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(v,k){return new ot(Math.min(v.width,k.width),Math.min(v.height,k.height))},max:function(v,k){return new ot(Math.max(v.width,k.width),Math.max(v.height,k.height))},random:function(){return new ot(Math.random(),Math.random())}}},b.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new ot(k(this.width),k(this.height))}},{})),tt=ot.extend({initialize:function(k,V,$,te){this._width=k,this._height=V,this._owner=$,this._setter=te},_set:function(v,k,V){return this._width=v,this._height=k,V||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(v){this._width=v,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(v){this._height=v,this._owner[this._setter](this)}}),lt=b.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(k,V,$,te){var fe=arguments,ve=typeof k,Ie;if(ve==="number"?(this._set(k,V,$,te),Ie=4):ve==="undefined"||k===null?(this._set(0,0,0,0),Ie=k===null?1:0):fe.length===1&&(Array.isArray(k)?(this._set.apply(this,k),Ie=1):k.x!==n||k.width!==n?(this._set(k.x||0,k.y||0,k.width||0,k.height||0),Ie=1):k.from===n&&k.to===n&&(this._set(0,0,0,0),b.readSupported(fe,this)&&(Ie=1))),Ie===n){var Ee=be.readNamed(fe,"from"),ze=b.peek(fe),Qe=Ee.x,He=Ee.y,Ze,Ve;if(ze&&ze.x!==n||b.hasNamed(fe,"to")){var ft=be.readNamed(fe,"to");Ze=ft.x-Qe,Ve=ft.y-He,Ze<0&&(Qe=ft.x,Ze=-Ze),Ve<0&&(He=ft.y,Ve=-Ve)}else{var nt=ot.read(fe);Ze=nt.width,Ve=nt.height}this._set(Qe,He,Ze,Ve),Ie=fe.__index}var Me=fe.__filtered;return Me&&(this.__filtered=Me),this.__read&&(this.__read=Ie),this},set:"#initialize",_set:function(v,k,V,$){return this.x=v,this.y=k,this.width=V,this.height=$,this},clone:function(){return new lt(this.x,this.y,this.width,this.height)},equals:function(v){var k=b.isPlainValue(v)?lt.read(arguments):v;return k===this||k&&this.x===k.x&&this.y===k.y&&this.width===k.width&&this.height===k.height||!1},toString:function(){var v=he.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+", width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y),k.number(this.width),k.number(this.height)]},getPoint:function(v){var k=v?be:Ke;return new k(this.x,this.y,this,"setPoint")},setPoint:function(){var v=be.read(arguments);this.x=v.x,this.y=v.y},getSize:function(v){var k=v?ot:tt;return new k(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var v=ot.read(arguments),k=this._sx,V=this._sy,$=v.width,te=v.height;k&&(this.x+=(this.width-$)*k),V&&(this.y+=(this.height-te)*V),this.width=$,this.height=te,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(v){if(!this._fw){var k=v-this.x;this.width-=this._sx===.5?k*2:k}this.x=v,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(v){if(!this._fh){var k=v-this.y;this.height-=this._sy===.5?k*2:k}this.y=v,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(v){if(!this._fw){var k=v-this.x;this.width=this._sx===.5?k*2:k}this.x=v-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(v){if(!this._fh){var k=v-this.y;this.height=this._sy===.5?k*2:k}this.y=v-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(v){this._fw||this._sx===.5?this.x=v-this.width/2:(this._sx&&(this.x+=(v-this.x)*2*this._sx),this.width=(v-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(v){this._fh||this._sy===.5?this.y=v-this.height/2:(this._sy&&(this.y+=(v-this.y)*2*this._sy),this.height=(v-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(v){var k=v?be:Ke;return new k(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var v=be.read(arguments);return this.setCenterX(v.x),this.setCenterY(v.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(v){return v&&v.width!==n||(Array.isArray(v)?v:arguments).length===4?this._containsRectangle(lt.read(arguments)):this._containsPoint(be.read(arguments))},_containsPoint:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k<=this.x+this.width&&V<=this.y+this.height},_containsRectangle:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k+v.width<=this.x+this.width&&V+v.height<=this.y+this.height},intersects:function(){var v=lt.read(arguments),k=b.read(arguments)||0;return v.x+v.width>this.x-k&&v.y+v.height>this.y-k&&v.x<this.x+this.width+k&&v.y<this.y+this.height+k},intersect:function(){var v=lt.read(arguments),k=Math.max(this.x,v.x),V=Math.max(this.y,v.y),$=Math.min(this.x+this.width,v.x+v.width),te=Math.min(this.y+this.height,v.y+v.height);return new lt(k,V,$-k,te-V)},unite:function(){var v=lt.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),$=Math.max(this.x+this.width,v.x+v.width),te=Math.max(this.y+this.height,v.y+v.height);return new lt(k,V,$-k,te-V)},include:function(){var v=be.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),$=Math.max(this.x+this.width,v.x),te=Math.max(this.y+this.height,v.y);return new lt(k,V,$-k,te-V)},expand:function(){var v=ot.read(arguments),k=v.width,V=v.height;return new lt(this.x-k/2,this.y-V/2,this.width+k,this.height+V)},scale:function(v,k){return this.expand(this.width*v-this.width,this.height*(k===n?v:k)-this.height)}},b.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(v,k){var V=v.join(""),$=/^[RL]/.test(V);k>=4&&(v[1]+=$?"Y":"X");var te=v[$?0:1],fe=v[$?1:0],ve="get"+te,Ie="get"+fe,Ee="set"+te,ze="set"+fe,Qe="get"+V,He="set"+V;this[Qe]=function(Ze){var Ve=Ze?be:Ke;return new Ve(this[ve](),this[Ie](),this,He)},this[He]=function(){var Ze=be.read(arguments);this[Ee](Ze.x),this[ze](Ze.y)}},{beans:!0})),ut=lt.extend({initialize:function(k,V,$,te,fe,ve){this._set(k,V,$,te,!0),this._owner=fe,this._setter=ve},_set:function(v,k,V,$,te){return this._x=v,this._y=k,this._width=V,this._height=$,te||this._owner[this._setter](this),this}},new function(){var v=lt.prototype;return b.each(["x","y","width","height"],function(k){var V=b.capitalize(k),$="_"+k;this["get"+V]=function(){return this[$]},this["set"+V]=function(te){this[$]=te,this._dontNotify||this._owner[this._setter](this)}},b.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(k){var V="set"+k;this[V]=function(){this._dontNotify=!0,v[V].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(k){var V=this._owner;V._changeSelection&&V._changeSelection(2,k)}}))}),Tt=b.extend({_class:"Matrix",initialize:function v(k,V){var $=arguments,te=$.length,fe=!0;if(te>=6?this._set.apply(this,$):te===1||te===2?k instanceof v?this._set(k._a,k._b,k._c,k._d,k._tx,k._ty,V):Array.isArray(k)?this._set.apply(this,V?k.concat([V]):k):fe=!1:te?fe=!1:this.reset(),!fe)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(v,k,V,$,te,fe,ve){return this._a=v,this._b=k,this._c=V,this._d=$,this._tx=te,this._ty=fe,ve||this._changed(),this},_serialize:function(v,k){return b.serialize(this.getValues(),v,!0,k)},_changed:function(){var v=this._owner;v&&(v._applyMatrix?v.transform(null,!0):v._changed(25))},clone:function(){return new Tt(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(v){return v===this||v&&this._a===v._a&&this._b===v._b&&this._c===v._c&&this._d===v._d&&this._tx===v._tx&&this._ty===v._ty},toString:function(){var v=he.instance;return"[["+[v.number(this._a),v.number(this._c),v.number(this._tx)].join(", ")+"], ["+[v.number(this._b),v.number(this._d),v.number(this._ty)].join(", ")+"]]"},reset:function(v){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,v||this._changed(),this},apply:function(v,k){var V=this._owner;return V?(V.transform(null,b.pick(v,!0),k),this.isIdentity()):!1},translate:function(){var v=be.read(arguments),k=v.x,V=v.y;return this._tx+=k*this._a+V*this._c,this._ty+=k*this._b+V*this._d,this._changed(),this},scale:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0});return V&&this.translate(V),this._a*=k.x,this._b*=k.x,this._c*=k.y,this._d*=k.y,V&&this.translate(V.negate()),this._changed(),this},rotate:function(v){v*=Math.PI/180;var k=be.read(arguments,1),V=k.x,$=k.y,te=Math.cos(v),fe=Math.sin(v),ve=V-V*te+$*fe,Ie=$-V*fe-$*te,Ee=this._a,ze=this._b,Qe=this._c,He=this._d;return this._a=te*Ee+fe*Qe,this._b=te*ze+fe*He,this._c=-fe*Ee+te*Qe,this._d=-fe*ze+te*He,this._tx+=ve*Ee+Ie*Qe,this._ty+=ve*ze+Ie*He,this._changed(),this},shear:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0});V&&this.translate(V);var $=this._a,te=this._b;return this._a+=k.y*this._c,this._b+=k.y*this._d,this._c+=k.x*$,this._d+=k.x*te,V&&this.translate(V.negate()),this._changed(),this},skew:function(){var v=arguments,k=be.read(v),V=be.read(v,0,{readNull:!0}),$=Math.PI/180,te=new be(Math.tan(k.x*$),Math.tan(k.y*$));return this.shear(te,V)},append:function(v,k){if(v){var V=this._a,$=this._b,te=this._c,fe=this._d,ve=v._a,Ie=v._c,Ee=v._b,ze=v._d,Qe=v._tx,He=v._ty;this._a=ve*V+Ee*te,this._c=Ie*V+ze*te,this._b=ve*$+Ee*fe,this._d=Ie*$+ze*fe,this._tx+=Qe*V+He*te,this._ty+=Qe*$+He*fe,k||this._changed()}return this},prepend:function(v,k){if(v){var V=this._a,$=this._b,te=this._c,fe=this._d,ve=this._tx,Ie=this._ty,Ee=v._a,ze=v._c,Qe=v._b,He=v._d,Ze=v._tx,Ve=v._ty;this._a=Ee*V+ze*$,this._c=Ee*te+ze*fe,this._b=Qe*V+He*$,this._d=Qe*te+He*fe,this._tx=Ee*ve+ze*Ie+Ze,this._ty=Qe*ve+He*Ie+Ve,k||this._changed()}return this},appended:function(v){return this.clone().append(v)},prepended:function(v){return this.clone().prepend(v)},invert:function(){var v=this._a,k=this._b,V=this._c,$=this._d,te=this._tx,fe=this._ty,ve=v*$-k*V,Ie=null;return ve&&!isNaN(ve)&&isFinite(te)&&isFinite(fe)&&(this._a=$/ve,this._b=-k/ve,this._c=-V/ve,this._d=v/ve,this._tx=(V*fe-$*te)/ve,this._ty=(k*te-v*fe)/ve,Ie=this),Ie},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new Tt(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var v=this._a*this._d-this._c*this._b;return v&&!isNaN(v)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(v,k,V){return arguments.length<3?this._transformPoint(be.read(arguments)):this._transformCoordinates(v,k,V)},_transformPoint:function(v,k,V){var $=v.x,te=v.y;return k||(k=new be),k._set($*this._a+te*this._c+this._tx,$*this._b+te*this._d+this._ty,V)},_transformCoordinates:function(v,k,V){for(var $=0,te=2*V;$<te;$+=2){var fe=v[$],ve=v[$+1];k[$]=fe*this._a+ve*this._c+this._tx,k[$+1]=fe*this._b+ve*this._d+this._ty}return k},_transformCorners:function(v){var k=v.x,V=v.y,$=k+v.width,te=V+v.height,fe=[k,V,$,V,$,te,k,te];return this._transformCoordinates(fe,fe,4)},_transformBounds:function(v,k,V){for(var $=this._transformCorners(v),te=$.slice(0,2),fe=te.slice(),ve=2;ve<8;ve++){var Ie=$[ve],Ee=ve&1;Ie<te[Ee]?te[Ee]=Ie:Ie>fe[Ee]&&(fe[Ee]=Ie)}return k||(k=new lt),k._set(te[0],te[1],fe[0]-te[0],fe[1]-te[1],V)},inverseTransform:function(){return this._inverseTransform(be.read(arguments))},_inverseTransform:function(v,k,V){var $=this._a,te=this._b,fe=this._c,ve=this._d,Ie=this._tx,Ee=this._ty,ze=$*ve-te*fe,Qe=null;if(ze&&!isNaN(ze)&&isFinite(Ie)&&isFinite(Ee)){var He=v.x-this._tx,Ze=v.y-this._ty;k||(k=new be),Qe=k._set((He*ve-Ze*fe)/ze,(Ze*$-He*te)/ze,V)}return Qe},decompose:function(){var v=this._a,k=this._b,V=this._c,$=this._d,te=v*$-k*V,fe=Math.sqrt,ve=Math.atan2,Ie=180/Math.PI,Ee,ze,Qe;if(v!==0||k!==0){var He=fe(v*v+k*k);Ee=Math.acos(v/He)*(k>0?1:-1),ze=[He,te/He],Qe=[ve(v*V+k*$,He*He),0]}else if(V!==0||$!==0){var Ze=fe(V*V+$*$);Ee=Math.asin(V/Ze)*($>0?1:-1),ze=[te/Ze,Ze],Qe=[0,ve(v*V+k*$,Ze*Ze)]}else Ee=0,Qe=ze=[0,0];return{translation:this.getTranslation(),rotation:Ee*Ie,scaling:new be(ze),skewing:new be(Qe[0]*Ie,Qe[1]*Ie)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new be(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(v){this.isIdentity()||v.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},b.each(["a","b","c","d","tx","ty"],function(v){var k=b.capitalize(v),V="_"+v;this["get"+k]=function(){return this[V]},this["set"+k]=function($){this[V]=$,this._changed()}},{})),Pt=b.extend({_class:"Line",initialize:function(k,V,$,te,fe){var ve=!1;arguments.length>=4?(this._px=k,this._py=V,this._vx=$,this._vy=te,ve=fe):(this._px=k.x,this._py=k.y,this._vx=V.x,this._vy=V.y,ve=$),ve||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new be(this._px,this._py)},getVector:function(){return new be(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(v,k){return Pt.intersect(this._px,this._py,this._vx,this._vy,v._px,v._py,v._vx,v._vy,!0,k)},getSide:function(v,k){return Pt.getSide(this._px,this._py,this._vx,this._vy,v.x,v.y,!0,k)},getDistance:function(v){return Math.abs(this.getSignedDistance(v))},getSignedDistance:function(v){return Pt.getSignedDistance(this._px,this._py,this._vx,this._vy,v.x,v.y,!0)},isCollinear:function(v){return be.isCollinear(this._vx,this._vy,v._vx,v._vy)},isOrthogonal:function(v){return be.isOrthogonal(this._vx,this._vy,v._vx,v._vy)},statics:{intersect:function(v,k,V,$,te,fe,ve,Ie,Ee,ze){Ee||(V-=v,$-=k,ve-=te,Ie-=fe);var Qe=V*Ie-$*ve;if(!ae.isMachineZero(Qe)){var He=v-te,Ze=k-fe,Ve=(ve*Ze-Ie*He)/Qe,ft=(V*Ze-$*He)/Qe,nt=1e-12,Me=-nt,se=1+nt;if(ze||Me<Ve&&Ve<se&&Me<ft&&ft<se)return ze||(Ve=Ve<=0?0:Ve>=1?1:Ve),new be(v+Ve*V,k+Ve*$)}},getSide:function(v,k,V,$,te,fe,ve,Ie){ve||(V-=v,$-=k);var Ee=te-v,ze=fe-k,Qe=Ee*$-ze*V;return!Ie&&ae.isMachineZero(Qe)&&(Qe=(Ee*V+Ee*V)/(V*V+$*$),Qe>=0&&Qe<=1&&(Qe=0)),Qe<0?-1:Qe>0?1:0},getSignedDistance:function(v,k,V,$,te,fe,ve){return ve||(V-=v,$-=k),V===0?$>0?te-v:v-te:$===0?V<0?fe-k:k-fe:((te-v)*$-(fe-k)*V)/($>V?$*Math.sqrt(1+V*V/($*$)):V*Math.sqrt(1+$*$/(V*V)))},getDistance:function(v,k,V,$,te,fe,ve){return Math.abs(Pt.getSignedDistance(v,k,V,$,te,fe,ve))}}}),zt=G.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(k){G.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new yn(null,null,this),this._view=Ri.create(this,k||en.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(v,k){return b.serialize(this._children,v,!0,k)},_changed:function(v,k){if(v&1){var V=this._view;V&&(V._needsUpdate=!0,!V._requested&&V._autoUpdate&&V.requestUpdate())}var $=this._changes;if($&&k){var te=this._changesById,fe=k._id,ve=te[fe];ve?ve.flags|=v:$.push(te[fe]={item:k,flags:v})}},clear:function(){for(var v=this._children,k=v.length-1;k>=0;k--)v[k].remove()},isEmpty:function(){return!this._children.length},remove:function v(){return v.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(v){this._currentStyle.set(v)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new rt({project:this,insert:!0})},getSymbolDefinitions:function(){var v=[],k={};return this.getItems({class:gt,match:function(V){var $=V._definition,te=$._id;return k[te]||(k[te]=!0,v.push($)),!1}}),v},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var v=this._selectionItems,k=[];for(var V in v){var $=v[V],te=$._selection;te&1&&$.isInserted()?k.push($):te||this._updateSelection($)}return k},_updateSelection:function(v){var k=v._id,V=this._selectionItems;v._selection?V[k]!==v&&(this._selectionCount++,V[k]=v):V[k]===v&&(this._selectionCount--,delete V[k])},selectAll:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)v[k].setFullySelected(!0)},deselectAll:function(){var v=this._selectionItems;for(var k in v)v[k].setFullySelected(!1)},addLayer:function(v){return this.insertLayer(n,v)},insertLayer:function(v,k){if(k instanceof rt){k._remove(!1,!0),b.splice(this._children,[k],v,0),k._setProject(this,!0);var V=k._name;V&&k.setName(V),this._changes&&k._changed(5),this._activeLayer||(this._activeLayer=k)}else k=null;return k},_insertItem:function(v,k,V){return k=this.insertLayer(v,k)||(this._activeLayer||this._insertItem(n,new rt(Ge.NO_INSERT),!0)).insertChild(v,k),V&&k.activate&&k.activate(),k},getItems:function(v){return Ge._getItems(this,v)},getItem:function(v){return Ge._getItems(this,v,null,null,!0)[0]||null},importJSON:function(v){this.activate();var k=this._activeLayer;return b.importJSON(v,k&&k.isEmpty()&&k)},removeOn:function(v){var k=this._removeSets;if(k){v==="mouseup"&&(k.mousedrag=null);var V=k[v];if(V){for(var $ in V){var te=V[$];for(var fe in k){var ve=k[fe];ve&&ve!=V&&delete ve[te._id]}te.remove()}k[v]=null}}},draw:function(v,k,V){this._updateVersion++,v.save(),k.applyToContext(v);for(var $=this._children,te=new b({offset:new be(0,0),pixelRatio:V,viewMatrix:k.isIdentity()?null:k,matrices:[new Tt],updateMatrix:!0}),fe=0,ve=$.length;fe<ve;fe++)$[fe].draw(v,te);if(v.restore(),this._selectionCount>0){v.save(),v.strokeWidth=1;var Ie=this._selectionItems,Ee=this._scope.settings.handleSize,ze=this._updateVersion;for(var Qe in Ie)Ie[Qe]._drawSelection(v,k,Ee,Ie,ze);v.restore()}}}),Ge=b.extend(I,{statics:{extend:function v(k){return k._serializeFields&&(k._serializeFields=b.set({},this.prototype._serializeFields,k._serializeFields)),v.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new Tt,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var v=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return b.each(v,function(k){this._events[k]={install:function(V){this.getView()._countItemEvent(V,1)},uninstall:function(V){this.getView()._countItemEvent(V,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:v}})},{initialize:function(){},_initialize:function(v,k){var V=v&&b.isPlainObject(v),$=V&&v.internal===!0,te=this._matrix=new Tt,fe=V&&v.project||In.project,ve=In.settings;return this._id=$?null:ue.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&ve.applyMatrix,k&&te.translate(k),te._owner=this,this._style=new yn(fe._currentStyle,this,fe),$||V&&v.insert==!1||!ve.insertItems&&!(V&&v.insert==!0)?this._setProject(fe):(V&&v.parent||fe)._insertItem(n,this,!0),V&&v!==Ge.NO_INSERT&&v!==Ge.INSERT&&this.set(v,{internal:!0,insert:!0,project:!0,parent:!0}),V},_serialize:function(v,k){var V={},$=this;function te(fe){for(var ve in fe){var Ie=$[ve];b.equals(Ie,ve==="leading"?fe.fontSize*1.2:fe[ve])||(V[ve]=b.serialize(Ie,v,ve!=="data",k))}}return te(this._serializeFields),this instanceof Xt||te(this._style._defaults),[this._class,V]},_changed:function(v){var k=this._symbol,V=this._parent||k,$=this._project;v&8&&(this._bounds=this._position=this._decomposed=n),v&16&&(this._globalMatrix=n),V&&v&72&&Ge._clearBoundsCache(V),v&2&&Ge._clearBoundsCache(this),$&&$._changed(v,this),k&&k._changed(v)},getId:function(){return this._id},getName:function(){return this._name},setName:function(v){if(this._name&&this._removeNamed(),v===+v+"")throw new Error("Names consisting only of numbers are not supported.");var k=this._getOwner();if(v&&k){var V=k._children,$=k._namedChildren;($[v]=$[v]||[]).push(this),v in V||(V[v]=this)}this._name=v||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(v){this.getStyle().set(v)}},b.each(["locked","visible","blendMode","opacity","guide"],function(v){var k=b.capitalize(v),V="_"+v,$={locked:256,visible:265};this["get"+k]=function(){return this[V]},this["set"+k]=function(te){te!=this[V]&&(this[V]=te,this._changed($[v]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(v){if(v!==this._selection){this._selection=v;var k=this._project;k&&(k._updateSelection(this),this._changed(257))}},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){if(this._selectChildren){for(var v=this._children,k=0,V=v.length;k<V;k++)if(v[k].isSelected())return!0}return!!(this._selection&1)},setSelected:function(v){if(this._selectChildren)for(var k=this._children,V=0,$=k.length;V<$;V++)k[V].setSelected(v);this._changeSelection(1,v)},isFullySelected:function(){var v=this._children,k=!!(this._selection&1);if(v&&k){for(var V=0,$=v.length;V<$;V++)if(!v[V].isFullySelected())return!1;return!0}return k},setFullySelected:function(v){var k=this._children;if(k)for(var V=0,$=k.length;V<$;V++)k[V].setFullySelected(v);this._changeSelection(1,v)},isClipMask:function(){return this._clipMask},setClipMask:function(v){this._clipMask!=(v=!!v)&&(this._clipMask=v,v&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(v){this._data=v},getPosition:function(v){var k=v?be:Ke,V=this._position||(this._position=this._getPositionFromBounds());return new k(V.x,V.y,this,"setPosition")},setPosition:function(){this.translate(be.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(v){return this._pivot?this._matrix._transformPoint(this._pivot):(v||this.getBounds()).getCenter(!0)},getPivot:function(){var v=this._pivot;return v?new Ke(v.x,v.y,this,"setPivot"):null},setPivot:function(){this._pivot=be.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},b.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(v,k){this[k]=function(V){return this.getBounds(V,v)}},{beans:!0,getBounds:function(v,k){var V=k||v instanceof Tt,$=b.set({},V?k:v,this._boundsOptions);(!$.stroke||this.getStrokeScaling())&&($.cacheItem=this);var te=this._getCachedBounds(V&&v,$).rect;return arguments.length?te:new ut(te.x,te.y,te.width,te.height,this,"setBounds")},setBounds:function(){var v=lt.read(arguments),k=this.getBounds(),V=this._matrix,$=new Tt,te=v.getCenter();$.translate(te),(v.width!=k.width||v.height!=k.height)&&(V.isInvertible()||(V.set(V._backup||new Tt().translate(V.getTranslation())),k=this.getBounds()),$.scale(k.width!==0?v.width/k.width:0,k.height!==0?v.height/k.height:0)),te=k.getCenter(),$.translate(-te.x,-te.y),this.transform($)},_getBounds:function(v,k){var V=this._children;return!V||!V.length?new lt:(Ge._updateBoundsCache(this,k.cacheItem),Ge._getBounds(V,v,k))},_getBoundsCacheKey:function(v,k){return[v.stroke?1:0,v.handle?1:0,k?1:0].join("")},_getCachedBounds:function(v,k,V){v=v&&v._orNullIfIdentity();var $=k.internal&&!V,te=k.cacheItem,fe=$?null:this._matrix._orNullIfIdentity(),ve=te&&(!v||v.equals(fe))&&this._getBoundsCacheKey(k,$),Ie=this._bounds;if(Ge._updateBoundsCache(this._parent||this._symbol,te),ve&&Ie&&ve in Ie){var Ee=Ie[ve];return{rect:Ee.rect.clone(),nonscaling:Ee.nonscaling}}var ze=this._getBounds(v||fe,k),Qe=ze.rect||ze,He=this._style,Ze=ze.nonscaling||He.hasStroke()&&!He.getStrokeScaling();if(ve){Ie||(this._bounds=Ie={});var Ee=Ie[ve]={rect:Qe.clone(),nonscaling:Ze,internal:$}}return{rect:Qe,nonscaling:Ze}},_getStrokeMatrix:function(v,k){var V=this.getStrokeScaling()?null:k&&k.internal?this:this._parent||this._symbol&&this._symbol._item,$=V?V.getViewMatrix().invert():v;return $&&$._shiftless()},statics:{_updateBoundsCache:function(v,k){if(v&&k){var V=k._id,$=v._boundsCache=v._boundsCache||{ids:{},list:[]};$.ids[V]||($.list.push(k),$.ids[V]=k)}},_clearBoundsCache:function(v){var k=v._boundsCache;if(k){v._bounds=v._position=v._boundsCache=n;for(var V=0,$=k.list,te=$.length;V<te;V++){var fe=$[V];fe!==v&&(fe._bounds=fe._position=n,fe._boundsCache&&Ge._clearBoundsCache(fe))}}},_getBounds:function(v,k,V){var $=1/0,te=-$,fe=$,ve=te,Ie=!1;V=V||{};for(var Ee=0,ze=v.length;Ee<ze;Ee++){var Qe=v[Ee];if(Qe._visible&&!Qe.isEmpty(!0)){var He=Qe._getCachedBounds(k&&k.appended(Qe._matrix),V,!0),Ze=He.rect;$=Math.min(Ze.x,$),fe=Math.min(Ze.y,fe),te=Math.max(Ze.x+Ze.width,te),ve=Math.max(Ze.y+Ze.height,ve),He.nonscaling&&(Ie=!0)}}return{rect:isFinite($)?new lt($,fe,te-$,ve-fe):new lt,nonscaling:Ie}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var v=this._decompose();return v?v.rotation:0},setRotation:function(v){var k=this.getRotation();if(k!=null&&v!=null){var V=this._decomposed;this.rotate(v-k),V&&(V.rotation=v,this._decomposed=V)}},getScaling:function(){var v=this._decompose(),k=v&&v.scaling;return new Ke(k?k.x:1,k?k.y:1,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=be.read(arguments,0,{clone:!0,readNull:!0});if(v&&k&&!v.equals(k)){var V=this.getRotation(),$=this._decomposed,te=new Tt,fe=ae.isZero;if(fe(v.x)||fe(v.y))te.translate($.translation),V&&te.rotate(V),te.scale(k.x,k.y),this._matrix.set(te);else{var ve=this.getPosition(!0);te.translate(ve),V&&te.rotate(V),te.scale(k.x/v.x,k.y/v.y),V&&te.rotate(-V),te.translate(ve.negate()),this.transform(te)}$&&($.scaling=k,this._decomposed=$)}},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},getGlobalMatrix:function(v){var k=this._globalMatrix;if(k)for(var V=this._parent,$=[];V;){if(!V._globalMatrix){k=null;for(var te=0,fe=$.length;te<fe;te++)$[te]._globalMatrix=null;break}$.push(V),V=V._parent}if(!k){k=this._globalMatrix=this._matrix.clone();var V=this._parent;V&&k.prepend(V.getGlobalMatrix(!0))}return v?k:k.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(v){(this._applyMatrix=this._canApplyMatrix&&!!v)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(v,k){if(this._project!==v){this._project&&this._installEvents(!1),this._project=v;for(var V=this._children,$=0,te=V&&V.length;$<te;$++)V[$]._setProject(v);k=!0}k&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function v(k){v.base.call(this,k);for(var V=this._children,$=0,te=V&&V.length;$<te;$++)V[$]._installEvents(k)},getLayer:function(){for(var v=this;v=v._parent;)if(v instanceof rt)return v;return null},getParent:function(){return this._parent},setParent:function(v){return v.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(v){this.removeChildren(),this.addChildren(v)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var v=this._getOwner();return v&&v._children[this._index+1]||null},getPreviousSibling:function(){var v=this._getOwner();return v&&v._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(v){return v===this||v&&this._class===v._class&&this._style.equals(v._style)&&this._matrix.equals(v._matrix)&&this._locked===v._locked&&this._visible===v._visible&&this._blendMode===v._blendMode&&this._opacity===v._opacity&&this._clipMask===v._clipMask&&this._guide===v._guide&&this._equals(v)||!1},_equals:function(v){return b.equals(this._children,v._children)},clone:function(v){var k=new this.constructor(Ge.NO_INSERT),V=this._children,$=b.pick(v?v.insert:n,v===n||v===!0),te=b.pick(v?v.deep:n,!0);V&&k.copyAttributes(this),(!V||te)&&k.copyContent(this),V||k.copyAttributes(this),$&&k.insertAbove(this);var fe=this._name,ve=this._parent;if(fe&&ve){for(var V=ve._children,Ie=fe,Ee=1;V[fe];)fe=Ie+" "+Ee++;fe!==Ie&&k.setName(fe)}return k},copyContent:function(v){for(var k=v._children,V=0,$=k&&k.length;V<$;V++)this.addChild(k[V].clone(!1),!0)},copyAttributes:function(v,k){this.setStyle(v._style);for(var V=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],$=0,te=V.length;$<te;$++){var fe=V[$];v.hasOwnProperty(fe)&&(this[fe]=v[fe])}k||this._matrix.set(v._matrix,!0),this.setApplyMatrix(v._applyMatrix),this.setPivot(v._pivot),this.setSelection(v._selection);var ve=v._data,Ie=v._name;this._data=ve?b.clone(ve):null,Ie&&this.setName(Ie)},rasterize:function(v,k){var V,$,te;b.isPlainObject(v)?(V=v.resolution,$=v.insert,te=v.raster):(V=v,$=k),te||(te=new pt(Ge.NO_INSERT));var fe=this.getStrokeBounds(),ve=(V||this.getView().getResolution())/72,Ie=fe.getTopLeft().floor(),Ee=fe.getBottomRight().ceil(),ze=new ot(Ee.subtract(Ie)),Qe=ze.multiply(ve);if(te.setSize(Qe,!0),!Qe.isZero()){var He=te.getContext(!0),Ze=new Tt().scale(ve).translate(Ie.negate());He.save(),Ze.applyToContext(He),this.draw(He,new b({matrices:[Ze]})),He.restore()}return te._matrix.set(new Tt().translate(Ie.add(ze.divide(2))).scale(1/ve)),($===n||$)&&te.insertAbove(this),te},contains:function(){var v=this._matrix;return v.isInvertible()&&!!this._contains(v._inverseTransform(be.read(arguments)))},_contains:function(v){var k=this._children;if(k){for(var V=k.length-1;V>=0;V--)if(k[V].contains(v))return!0;return!1}return v.isInside(this.getInternalBounds())},isInside:function(){return lt.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Ot.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(v,k){return v instanceof Ge?this._asPathItem().getIntersections(v._asPathItem(),null,k,!0).length>0:!1}},new function(){function v(){var $=arguments;return this._hitTest(be.read($),dt.getOptions($))}function k(){var $=arguments,te=be.read($),fe=dt.getOptions($),ve=[];return this._hitTest(te,new b({all:ve},fe)),ve}function V($,te,fe,ve){var Ie=this._children;if(Ie)for(var Ee=Ie.length-1;Ee>=0;Ee--){var ze=Ie[Ee],Qe=ze!==ve&&ze._hitTest($,te,fe);if(Qe&&!te.all)return Qe}return null}return zt.inject({hitTest:v,hitTestAll:k,_hitTest:V}),{hitTest:v,hitTestAll:k,_hitTestChildren:V}},{_hitTest:function(v,k,V){if(this._locked||!this._visible||this._guide&&!k.guides||this.isEmpty())return null;var $=this._matrix,te=V?V.appended($):this.getGlobalMatrix().prepend(this.getView()._matrix),fe=Math.max(k.tolerance,1e-12),ve=k._tolerancePadding=new ot(Ot._getStrokePadding(fe,$._shiftless().invert()));if(v=$._inverseTransform(v),!v||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(ve.multiply(2))._containsPoint(v))return null;var Ie=!(k.guides&&!this._guide||k.selected&&!this.isSelected()||k.type&&k.type!==b.hyphenate(this._class)||k.class&&!(this instanceof k.class)),Ee=k.match,ze=this,Qe,He;function Ze(X){return X&&Ee&&!Ee(X)&&(X=null),X&&k.all&&k.all.push(X),X}function Ve(X,ie){var de=ie?Qe["get"+ie]():ze.getPosition();if(v.subtract(de).divide(ve).length<=1)return new dt(X,ze,{name:ie?b.hyphenate(ie):X,point:de})}var ft=k.position,nt=k.center,Me=k.bounds;if(Ie&&this._parent&&(ft||nt||Me)){if((nt||Me)&&(Qe=this.getInternalBounds()),He=ft&&Ve("position")||nt&&Ve("center","Center"),!He&&Me)for(var se=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],ne=0;ne<8&&!He;ne++)He=Ve("bounds",se[ne]);He=Ze(He)}return He||(He=this._hitTestChildren(v,k,te)||Ie&&Ze(this._hitTestSelf(v,k,te,this.getStrokeScaling()?null:te._shiftless().invert()))||null),He&&He.point&&(He.point=$.transform(He.point)),He},_hitTestSelf:function(v,k){if(k.fill&&this.hasFill()&&this._contains(v))return new dt("fill",this)},matches:function(v,k){function V(ve,Ie){for(var Ee in ve)if(ve.hasOwnProperty(Ee)){var ze=ve[Ee],Qe=Ie[Ee];if(b.isPlainObject(ze)&&b.isPlainObject(Qe)){if(!V(ze,Qe))return!1}else if(!b.equals(ze,Qe))return!1}return!0}var $=typeof v;if($==="object"){for(var te in v)if(v.hasOwnProperty(te)&&!this.matches(te,v[te]))return!1;return!0}else{if($==="function")return v(this);if(v==="match")return k(this);var fe=/^(empty|editable)$/.test(v)?this["is"+b.capitalize(v)]():v==="type"?b.hyphenate(this._class):this[v];if(v==="class"){if(typeof k=="function")return this instanceof k;fe=this._class}if(typeof k=="function")return!!k(fe);if(k){if(k.test)return k.test(fe);if(b.isPlainObject(k))return V(k,fe)}return b.equals(fe,k)}},getItems:function(v){return Ge._getItems(this,v,this._matrix)},getItem:function(v){return Ge._getItems(this,v,this._matrix,null,!0)[0]||null},statics:{_getItems:function v(k,V,$,te,fe){if(!te){var ve=typeof V=="object"&&V,Ie=ve&&ve.overlapping,Ee=ve&&ve.inside,ze=Ie||Ee,Ze=ze&&lt.read([ze]);te={items:[],recursive:ve&&ve.recursive!==!1,inside:!!Ee,overlapping:!!Ie,rect:Ze,path:Ie&&new Ot.Rectangle({rectangle:Ze,insert:!1})},ve&&(V=b.filter({},V,{recursive:!0,inside:!0,overlapping:!0}))}var Qe=k._children,He=te.items,Ze=te.rect;$=Ze&&($||new Tt);for(var Ve=0,ft=Qe&&Qe.length;Ve<ft;Ve++){var nt=Qe[Ve],Me=$&&$.appended(nt._matrix),se=!0;if(Ze){var ze=nt.getBounds(Me);if(!Ze.intersects(ze))continue;Ze.contains(ze)||te.overlapping&&(ze.contains(Ze)||te.path.intersects(nt,Me))||(se=!1)}if(se&&nt.matches(V)&&(He.push(nt),fe)||(te.recursive!==!1&&v(nt,V,Me,te,fe),fe&&He.length>0))break}return He}}},{importJSON:function(v){var k=b.importJSON(v,this);return k!==this?this.addChild(k):k},addChild:function(v){return this.insertChild(n,v)},insertChild:function(v,k){var V=k?this.insertChildren(v,[k]):null;return V&&V[0]},addChildren:function(v){return this.insertChildren(this._children.length,v)},insertChildren:function(v,k){var V=this._children;if(V&&k&&k.length>0){k=b.slice(k);for(var $={},te=k.length-1;te>=0;te--){var fe=k[te],ve=fe&&fe._id;!fe||$[ve]?k.splice(te,1):(fe._remove(!1,!0),$[ve]=!0)}b.splice(V,k,v,0);for(var Ie=this._project,Ee=Ie._changes,te=0,ze=k.length;te<ze;te++){var fe=k[te],Qe=fe._name;fe._parent=this,fe._setProject(Ie,!0),Qe&&fe.setName(Qe),Ee&&fe._changed(5)}this._changed(11)}else k=null;return k},_insertItem:"#insertChild",_insertAt:function(v,k){var V=v&&v._getOwner(),$=v!==this&&V?this:null;return $&&($._remove(!1,!0),V._insertItem(v._index+k,$)),$},insertAbove:function(v){return this._insertAt(v,1)},insertBelow:function(v){return this._insertAt(v,0)},sendToBack:function(){var v=this._getOwner();return v?v._insertItem(0,this):null},bringToFront:function(){var v=this._getOwner();return v?v._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(v){return this.insertChild(0,v)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(v){return v._insertItem(n,this)},copyTo:function(v){return this.clone(!1).addTo(v)},reduce:function(v){var k=this._children;if(k&&k.length===1){var V=k[0].reduce(v);return this._parent?(V.insertAbove(this),this.remove()):V.remove(),V}return this},_removeNamed:function(){var v=this._getOwner();if(v){var k=v._children,V=v._namedChildren,$=this._name,te=V[$],fe=te?te.indexOf(this):-1;fe!==-1&&(k[$]==this&&delete k[$],te.splice(fe,1),te.length?k[$]=te[0]:delete V[$])}},_remove:function(v,k){var V=this._getOwner(),$=this._project,te=this._index;return this._style&&this._style._dispose(),V?(this._name&&this._removeNamed(),te!=null&&($._activeLayer===this&&($._activeLayer=this.getNextSibling()||this.getPreviousSibling()),b.splice(V._children,null,te,1)),this._installEvents(!1),v&&$._changes&&this._changed(5),k&&V._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(v){var k=v&&v.insertBelow(this);return k&&this.remove(),k},removeChildren:function(v,k){if(!this._children)return null;v=v||0,k=b.pick(k,this._children.length);for(var V=b.splice(this._children,null,v,k-v),$=V.length-1;$>=0;$--)V[$]._remove(!0,!1);return V.length>0&&this._changed(11),V},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var v=0,k=this._children.length;v<k;v++)this._children[v]._index=v;this._changed(11)}},isEmpty:function(v){var k=this._children,V=k?k.length:0;if(v){for(var $=0;$<V;$++)if(!k[$].isEmpty(v))return!1;return!0}return!V},isEditable:function(){for(var v=this;v;){if(!v._visible||v._locked)return!1;v=v._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(v){function k(ve){var Ie=[];do Ie.unshift(ve);while(ve=ve._parent);return Ie}for(var V=k(this),$=k(v),te=0,fe=Math.min(V.length,$.length);te<fe;te++)if(V[te]!=$[te])return V[te]._index<$[te]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(v){return this._getOrder(v)===-1},isBelow:function(v){return this._getOrder(v)===1},isParent:function(v){return this._parent===v},isChild:function(v){return v&&v._parent===this},isDescendant:function(v){for(var k=this;k=k._parent;)if(k===v)return!0;return!1},isAncestor:function(v){return v?v.isDescendant(this):!1},isSibling:function(v){return this._parent===v._parent},isGroupedWith:function(v){for(var k=this._parent;k;){if(k._parent&&/^(Group|Layer|CompoundPath)$/.test(k._class)&&v.isDescendant(k))return!0;k=k._parent}return!1}},b.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,$=(k?b:be).read(V),te=be.read(V,0,{readNull:!0});return this.transform(new Tt()[v]($,te||this.getPosition(!0)))}},{translate:function(){var v=new Tt;return this.transform(v.translate.apply(v,arguments))},transform:function(v,k,V){var $=this._matrix,te=v&&!v.isIdentity(),fe=V&&this._canApplyMatrix||this._applyMatrix&&(te||!$.isIdentity()||k&&this._children);if(!te&&!fe)return this;if(te){!v.isInvertible()&&$.isInvertible()&&($._backup=$.getValues()),$.prepend(v,!0);var ve=this._style,Ie=ve.getFillColor(!0),Ee=ve.getStrokeColor(!0);Ie&&Ie.transform(v),Ee&&Ee.transform(v)}if(fe&&(fe=this._transformContent($,k,V))){var ze=this._pivot;ze&&$._transformPoint(ze,ze,!0),$.reset(!0),V&&this._canApplyMatrix&&(this._applyMatrix=!0)}var Qe=this._bounds,He=this._position;(te||fe)&&this._changed(25);var Ze=te&&Qe&&v.decompose();if(Ze&&Ze.skewing.isZero()&&Ze.rotation%90===0){for(var Ve in Qe){var ft=Qe[Ve];if(ft.nonscaling)delete Qe[Ve];else if(fe||!ft.internal){var nt=ft.rect;v._transformBounds(nt,nt)}}this._bounds=Qe;var Me=Qe[this._getBoundsCacheKey(this._boundsOptions||{})];Me&&(this._position=this._getPositionFromBounds(Me.rect))}else te&&He&&this._pivot&&(this._position=v._transformPoint(He,He));return this},_transformContent:function(v,k,V){var $=this._children;if($){for(var te=0,fe=$.length;te<fe;te++)$[te].transform(v,k,V);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(be.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(be.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(be.read(arguments))},localToParent:function(){return this._matrix._transformPoint(be.read(arguments))},fitBounds:function(v,k){v=lt.read(arguments);var V=this.getBounds(),$=V.height/V.width,te=v.height/v.width,fe=(k?$>te:$<te)?v.width/V.width:v.height/V.height,ve=new lt(new be,new ot(V.width*fe,V.height*fe));ve.setCenter(v.getCenter()),this.setBounds(ve)}}),{_setStyles:function(v,k,V){var $=this._style,te=this._matrix;if($.hasFill()&&(v.fillStyle=$.getFillColor().toCanvasStyle(v,te)),$.hasStroke()){v.strokeStyle=$.getStrokeColor().toCanvasStyle(v,te),v.lineWidth=$.getStrokeWidth();var fe=$.getStrokeJoin(),ve=$.getStrokeCap(),Ie=$.getMiterLimit();if(fe&&(v.lineJoin=fe),ve&&(v.lineCap=ve),Ie&&(v.miterLimit=Ie),In.support.nativeDash){var Ee=$.getDashArray(),ze=$.getDashOffset();Ee&&Ee.length&&("setLineDash"in v?(v.setLineDash(Ee),v.lineDashOffset=ze):(v.mozDash=Ee,v.mozDashOffset=ze))}}if($.hasShadow()){var Qe=k.pixelRatio||1,He=V._shiftless().prepend(new Tt().scale(Qe,Qe)),Ze=He.transform(new be($.getShadowBlur(),0)),Ve=He.transform(this.getShadowOffset());v.shadowColor=$.getShadowColor().toCanvasStyle(v),v.shadowBlur=Ze.getLength(),v.shadowOffsetX=Ve.x,v.shadowOffsetY=Ve.y}},draw:function(v,k,V){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var $=k.matrices,te=k.viewMatrix,fe=this._matrix,ve=$[$.length-1].appended(fe);if(ve.isInvertible()){te=te?te.appended(ve):ve,$.push(ve),k.updateMatrix&&(this._globalMatrix=ve);var Ie=this._blendMode,Ee=ae.clamp(this._opacity,0,1),ze=Ie==="normal",Qe=tr.nativeModes[Ie],He=ze&&Ee===1||k.dontStart||k.clip||(Qe||ze&&Ee<1)&&this._canComposite(),Ze=k.pixelRatio||1,Ve,ft,nt;if(!He){var Me=this.getStrokeBounds(te);if(!Me.width||!Me.height){$.pop();return}nt=k.offset,ft=k.offset=Me.getTopLeft().floor(),Ve=v,v=en.getContext(Me.getSize().ceil().add(1).multiply(Ze)),Ze!==1&&v.scale(Ze,Ze)}v.save();var se=V?V.appended(fe):this._canScaleStroke&&!this.getStrokeScaling(!0)&&te,ne=!He&&k.clipItem,X=!se||ne;if(He?(v.globalAlpha=Ee,Qe&&(v.globalCompositeOperation=Ie)):X&&v.translate(-ft.x,-ft.y),X&&(He?fe:te).applyToContext(v),ne&&k.clipItem.draw(v,k.extend({clip:!0})),se){v.setTransform(Ze,0,0,Ze,0,0);var ie=k.offset;ie&&v.translate(-ie.x,-ie.y)}this._draw(v,k,te,se),v.restore(),$.pop(),k.clip&&!k.dontFinish&&v.clip(this.getFillRule()),He||(tr.process(Ie,v,Ve,Ee,ft.subtract(nt).multiply(Ze)),en.release(v),k.offset=nt)}}},_isUpdated:function(v){var k=this._parent;if(k instanceof _i)return k._isUpdated(v);var V=this._updateVersion===v;return!V&&k&&k._visible&&k._isUpdated(v)&&(this._updateVersion=v,V=!0),V},_drawSelection:function(v,k,V,$,te){var fe=this._selection,ve=fe&1,Ie=fe&2||ve&&this._selectBounds,Ee=fe&4;if(this._drawSelected||(ve=!1),(ve||Ie||Ee)&&this._isUpdated(te)){var ze,Qe=this.getSelectedColor(!0)||(ze=this.getLayer())&&ze.getSelectedColor(!0),He=k.appended(this.getGlobalMatrix(!0)),Ze=V/2;if(v.strokeStyle=v.fillStyle=Qe?Qe.toCanvasStyle(v):"#009dec",ve&&this._drawSelected(v,He,$),Ee){var Ve=this.getPosition(!0),ft=this._parent,nt=ft?ft.localToGlobal(Ve):Ve,Me=nt.x,se=nt.y;v.beginPath(),v.arc(Me,se,Ze,0,Math.PI*2,!0),v.stroke();for(var ne=[[0,-1],[1,0],[0,1],[-1,0]],X=Ze,ie=V+1,de=0;de<4;de++){var ye=ne[de],ge=ye[0],Pe=ye[1];v.moveTo(Me+ge*X,se+Pe*X),v.lineTo(Me+ge*ie,se+Pe*ie),v.stroke()}}if(Ie){var Fe=He._transformCorners(this.getInternalBounds());v.beginPath();for(var de=0;de<8;de++)v[de?"lineTo":"moveTo"](Fe[de],Fe[++de]);v.closePath(),v.stroke();for(var de=0;de<8;de++)v.fillRect(Fe[de]-Ze,Fe[++de]-Ze,V,V)}}},_canComposite:function(){return!1}},b.each(["down","drag","up","move"],function(v){this["removeOn"+b.capitalize(v)]=function(){var k={};return k[v]=!0,this.removeOn(k)}},{removeOn:function(v){for(var k in v)if(v[k]){var V="mouse"+k,$=this._project,te=$._removeSets=$._removeSets||{};te[V]=te[V]||{},te[V][this._id]=this}return this}}),{tween:function(v,k,V){V||(V=k,k=v,v=null,V||(V=k,k=null));var $=V&&V.easing,te=V&&V.start,fe=V!=null&&(typeof V=="number"?V:V.duration),ve=new Rr(this,v,k,fe,$,te);function Ie(Ee){ve._handleFrame(Ee.time*1e3),ve.running||this.off("frame",Ie)}return fe&&this.on("frame",Ie),ve},tweenTo:function(v,k){return this.tween(null,v,k)},tweenFrom:function(v,k){return this.tween(v,null,k)}}),Xt=Ge.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||this.addChildren(Array.isArray(k)?k:arguments)},_changed:function v(k){v.base.call(this,k),k&2050&&(this._clipItem=n)},_getClipItem:function(){var v=this._clipItem;if(v===n){v=null;for(var k=this._children,V=0,$=k.length;V<$;V++)if(k[V]._clipMask){v=k[V];break}this._clipItem=v}return v},isClipped:function(){return!!this._getClipItem()},setClipped:function(v){var k=this.getFirstChild();k&&k.setClipMask(v)},_getBounds:function v(k,V){var $=this._getClipItem();return $?$._getCachedBounds($._matrix.prepended(k),b.set({},V,{stroke:!1})):v.base.call(this,k,V)},_hitTestChildren:function v(k,V,$){var te=this._getClipItem();return(!te||te.contains(k))&&v.base.call(this,k,V,$,te)},_draw:function(v,k){var V=k.clip,$=!V&&this._getClipItem();k=k.extend({clipItem:$,clip:!1}),V?(v.beginPath(),k.dontStart=k.dontFinish=!0):$&&$.draw(v,k.extend({clip:!0}));for(var te=this._children,fe=0,ve=te.length;fe<ve;fe++){var Ie=te[fe];Ie!==$&&Ie.draw(v,k)}}}),rt=Xt.extend({_class:"Layer",initialize:function(){Xt.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function v(){return this._parent?v.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),yt=Ge.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(k,V){this._initialize(k,V)},_equals:function(v){return this._type===v._type&&this._size.equals(v._size)&&b.equals(this._radius,v._radius)},copyContent:function(v){this.setType(v._type),this.setSize(v._size),this.setRadius(v._radius)},getType:function(){return this._type},setType:function(v){this._type=v},getShape:"#getType",setShape:"#setType",getSize:function(){var v=this._size;return new tt(v.width,v.height,this,"setSize")},setSize:function(){var v=ot.read(arguments);if(!this._size)this._size=v.clone();else if(!this._size.equals(v)){var k=this._type,V=v.width,$=v.height;k==="rectangle"?this._radius.set(ot.min(this._radius,v.divide(2).abs())):k==="circle"?(V=$=(V+$)/2,this._radius=V/2):k==="ellipse"&&this._radius._set(V/2,$/2),this._size._set(V,$),this._changed(9)}},getRadius:function(){var v=this._radius;return this._type==="circle"?v:new tt(v.width,v.height,this,"setRadius")},setRadius:function(v){var k=this._type;if(k==="circle"){if(v===this._radius)return;var V=v*2;this._radius=v,this._size._set(V,V)}else if(v=ot.read(arguments),!this._radius)this._radius=v.clone();else{if(this._radius.equals(v))return;if(this._radius.set(v),k==="rectangle"){var V=ot.max(this._size,v.multiply(2));this._size.set(V)}else k==="ellipse"&&this._size._set(v.width*2,v.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(v){var k=new Ot[b.capitalize(this._type)]({center:new be,size:this._size,radius:this._radius,insert:!1});return k.copyAttributes(this),In.settings.applyMatrix&&k.setApplyMatrix(!0),(v===n||v)&&k.insertAbove(this),k},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(v,k,V,$){var te=this._style,fe=te.hasFill(),ve=te.hasStroke(),Ie=k.dontFinish||k.clip,Ee=!$;if(fe||ve||Ie){var ze=this._type,Qe=this._radius,He=ze==="circle";if(k.dontStart||v.beginPath(),Ee&&He)v.arc(0,0,Qe,0,Math.PI*2,!0);else{var Ze=He?Qe:Qe.width,Ve=He?Qe:Qe.height,ft=this._size,nt=ft.width,Me=ft.height;if(Ee&&ze==="rectangle"&&Ze===0&&Ve===0)v.rect(-nt/2,-Me/2,nt,Me);else{var se=nt/2,ne=Me/2,X=1-.5522847498307936,ie=Ze*X,de=Ve*X,ye=[-se,-ne+Ve,-se,-ne+de,-se+ie,-ne,-se+Ze,-ne,se-Ze,-ne,se-ie,-ne,se,-ne+de,se,-ne+Ve,se,ne-Ve,se,ne-de,se-ie,ne,se-Ze,ne,-se+Ze,ne,-se+ie,ne,-se,ne-de,-se,ne-Ve];$&&$.transform(ye,ye,32),v.moveTo(ye[0],ye[1]),v.bezierCurveTo(ye[2],ye[3],ye[4],ye[5],ye[6],ye[7]),se!==Ze&&v.lineTo(ye[8],ye[9]),v.bezierCurveTo(ye[10],ye[11],ye[12],ye[13],ye[14],ye[15]),ne!==Ve&&v.lineTo(ye[16],ye[17]),v.bezierCurveTo(ye[18],ye[19],ye[20],ye[21],ye[22],ye[23]),se!==Ze&&v.lineTo(ye[24],ye[25]),v.bezierCurveTo(ye[26],ye[27],ye[28],ye[29],ye[30],ye[31])}}v.closePath()}!Ie&&(fe||ve)&&(this._setStyles(v,k,V),fe&&(v.fill(te.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),ve&&v.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(v,k){var V=new lt(this._size).setCenter(0,0),$=this._style,te=k.stroke&&$.hasStroke()&&$.getStrokeWidth();return v&&(V=v._transformBounds(V)),te?V.expand(Ot._getStrokePadding(te,this._getStrokeMatrix(v,k))):V}},new function(){function v(V,$,te){var fe=V._radius;if(!fe.isZero())for(var ve=V._size.divide(2),Ie=1;Ie<=4;Ie++){var Ee=new be(Ie>1&&Ie<4?-1:1,Ie>2?-1:1),ze=Ee.multiply(ve),Qe=ze.subtract(Ee.multiply(fe)),He=new lt(te?ze.add(Ee.multiply(te)):ze,Qe);if(He.contains($))return{point:Qe,quadrant:Ie}}}function k(V,$,te,fe){var ve=V.divide($);return(!fe||ve.isInQuadrant(fe))&&ve.subtract(ve.normalize()).multiply($).divide(te).length<=1}return{_contains:function V($){if(this._type==="rectangle"){var te=v(this,$);return te?$.subtract(te.point).divide(this._radius).getLength()<=1:V.base.call(this,$)}else return $.divide(this.size).getLength()<=.5},_hitTestSelf:function V($,te,fe,ve){var Ie=!1,Ee=this._style,ze=te.stroke&&Ee.hasStroke(),Qe=te.fill&&Ee.hasFill();if(ze||Qe){var He=this._type,Ze=this._radius,Ve=ze?Ee.getStrokeWidth()/2:0,ft=te._tolerancePadding.add(Ot._getStrokePadding(Ve,!Ee.getStrokeScaling()&&ve));if(He==="rectangle"){var nt=ft.multiply(2),Me=v(this,$,nt);if(Me)Ie=k($.subtract(Me.point),Ze,ft,Me.quadrant);else{var se=new lt(this._size).setCenter(0,0),ne=se.expand(nt),X=se.expand(nt.negate());Ie=ne._containsPoint($)&&!X._containsPoint($)}}else Ie=k($,Ze,ft)}return Ie?new dt(ze?"stroke":"fill",this):V.base.apply(this,arguments)}}},{statics:new function(){function v(k,V,$,te,fe){var ve=b.create(yt.prototype);return ve._type=k,ve._size=$,ve._radius=te,ve._initialize(b.getNamed(fe),V),ve}return{Circle:function(){var k=arguments,V=be.readNamed(k,"center"),$=b.readNamed(k,"radius");return v("circle",V,new ot($*2),$,k)},Rectangle:function(){var k=arguments,V=lt.readNamed(k,"rectangle"),$=ot.min(ot.readNamed(k,"radius"),V.getSize(!0).divide(2));return v("rectangle",V.getCenter(!0),V.getSize(!0),$,k)},Ellipse:function(){var k=arguments,V=yt._readEllipse(k),$=V.radius;return v("ellipse",V.center,$.multiply(2),$,k)},_readEllipse:function(k){var V,$;if(b.hasNamed(k,"radius"))V=be.readNamed(k,"center"),$=ot.readNamed(k,"radius");else{var te=lt.readNamed(k,"rectangle");V=te.getCenter(!0),$=te.getSize(!0).divide(2)}return{center:V,radius:$}}}}}),pt=Ge.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(k,V){if(!this._initialize(k,V!==n&&be.read(arguments))){var $,te=typeof k,fe=te==="string"?g.getElementById(k):te==="object"?k:null;if(fe&&fe!==Ge.NO_INSERT){if(fe.getContext||fe.naturalHeight!=null)$=fe;else if(fe){var ve=ot.read(arguments);ve.isZero()||($=en.getCanvas(ve))}}$?this.setImage($):this.setSource(k)}this._size||(this._size=new ot,this._loaded=!1)},_equals:function(v){return this.getSource()===v.getSource()},copyContent:function(v){var k=v._image,V=v._canvas;if(k)this._setImage(k);else if(V){var $=en.getCanvas(v._size);$.getContext("2d").drawImage(V,0,0),this._setImage($)}this._crossOrigin=v._crossOrigin},getSize:function(){var v=this._size;return new tt(v?v.width:0,v?v.height:0,this,"setSize")},setSize:function(v,k){var V=ot.read(arguments);if(V.equals(this._size))k&&this.clear();else if(V.width>0&&V.height>0){var $=!k&&this.getElement();this._setImage(en.getCanvas(V)),$&&this.getContext(!0).drawImage($,0,0,V.width,V.height)}else this._canvas&&en.release(this._canvas),this._size=V.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(v){this.setSize(v,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(v){this.setSize(this.getWidth(),v)},getLoaded:function(){return this._loaded},isEmpty:function(){var v=this._size;return!v||v.width===0&&v.height===0},getResolution:function(){var v=this._matrix,k=new be(0,0).transform(v),V=new be(1,0).transform(v).subtract(k),$=new be(0,1).transform(v).subtract(k);return new ot(72/V.getLength(),72/$.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(v){var k=this;function V($){var te=k.getView(),fe=$&&$.type||"load";te&&k.responds(fe)&&(In=te._scope,k.emit(fe,new Ki($)))}this._setImage(v),this._loaded?setTimeout(V,0):v&&gi.add(v,{load:function($){k._setImage(v),V($)},error:V})},_setImage:function(v){this._canvas&&en.release(this._canvas),v&&v.getContext?(this._image=null,this._canvas=v,this._loaded=!0):(this._image=v,this._canvas=null,this._loaded=!!(v&&v.src&&v.complete)),this._size=new ot(v?v.naturalWidth||v.width:0,v?v.naturalHeight||v.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var v=en.getContext(this._size);try{this._image&&v.drawImage(this._image,0,0),this._canvas=v.canvas}catch{en.release(v)}}return this._canvas},setCanvas:"#setImage",getContext:function(v){return this._context||(this._context=this.getCanvas().getContext("2d")),v&&(this._image=null,this._changed(1025)),this._context},setContext:function(v){this._context=v},getSource:function(){var v=this._image;return v&&v.src||this.toDataURL()},setSource:function(v){var k=new t.Image,V=this._crossOrigin;V&&(k.crossOrigin=V),v&&(k.src=v),this.setImage(k)},getCrossOrigin:function(){var v=this._image;return v&&v.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(v){this._crossOrigin=v;var k=this._image;k&&(k.crossOrigin=v)},getSmoothing:function(){return this._smoothing},setSmoothing:function(v){this._smoothing=typeof v=="string"?v:v?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var v=lt.read(arguments),k=en.getContext(v.getSize());return k.drawImage(this.getCanvas(),v.x,v.y,v.width,v.height,0,0,v.width,v.height),k.canvas},getSubRaster:function(){var v=lt.read(arguments),k=new pt(Ge.NO_INSERT);return k._setImage(this.getSubCanvas(v)),k.translate(v.getCenter().subtract(this.getSize().divide(2))),k._matrix.prepend(this._matrix),k.insertAbove(this),k},toDataURL:function(){var v=this._image,k=v&&v.src;if(/^data:/.test(k))return k;var V=this.getCanvas();return V?V.toDataURL.apply(V,arguments):null},drawImage:function(v){var k=be.read(arguments,1);this.getContext(!0).drawImage(v,k.x,k.y)},getAverageColor:function(v){var k,V;if(v?v instanceof Rt?(V=v,k=v.getBounds()):typeof v=="object"&&("width"in v?k=new lt(v):"x"in v&&(k=new lt(v.x-.5,v.y-.5,1,1))):k=this.getBounds(),!k)return null;var $=32,te=Math.min(k.width,$),fe=Math.min(k.height,$),ve=pt._sampleContext;ve?ve.clearRect(0,0,$+1,$+1):ve=pt._sampleContext=en.getContext(new ot($)),ve.save();var Ie=new Tt().scale(te/k.width,fe/k.height).translate(-k.x,-k.y);Ie.applyToContext(ve),V&&V.draw(ve,new b({clip:!0,matrices:[Ie]})),this._matrix.applyToContext(ve);var Ee=this.getElement(),ze=this._size;Ee&&ve.drawImage(Ee,-ze.width/2,-ze.height/2),ve.restore();for(var Qe=ve.getImageData(.5,.5,Math.ceil(te),Math.ceil(fe)).data,He=[0,0,0],Ze=0,Ve=0,ft=Qe.length;Ve<ft;Ve+=4){var nt=Qe[Ve+3];Ze+=nt,nt/=255,He[0]+=Qe[Ve]*nt,He[1]+=Qe[Ve+1]*nt,He[2]+=Qe[Ve+2]*nt}for(var Ve=0;Ve<3;Ve++)He[Ve]/=Ze;return Ze?qi.read(He):null},getPixel:function(){var v=be.read(arguments),k=this.getContext().getImageData(v.x,v.y,1,1).data;return new qi("rgb",[k[0]/255,k[1]/255,k[2]/255],k[3]/255)},setPixel:function(){var v=arguments,k=be.read(v),V=qi.read(v),$=V._convert("rgb"),te=V._alpha,fe=this.getContext(!0),ve=fe.createImageData(1,1),Ie=ve.data;Ie[0]=$[0]*255,Ie[1]=$[1]*255,Ie[2]=$[2]*255,Ie[3]=te!=null?te*255:255,fe.putImageData(ve,k.x,k.y)},clear:function(){var v=this._size;this.getContext(!0).clearRect(0,0,v.width+1,v.height+1)},createImageData:function(){var v=ot.read(arguments);return this.getContext().createImageData(v.width,v.height)},getImageData:function(){var v=lt.read(arguments);return v.isEmpty()&&(v=new lt(this._size)),this.getContext().getImageData(v.x,v.y,v.width,v.height)},putImageData:function(v){var k=be.read(arguments,1);this.getContext(!0).putImageData(v,k.x,k.y)},setImageData:function(v){this.setSize(v),this.getContext(!0).putImageData(v,0,0)},_getBounds:function(v,k){var V=new lt(this._size).setCenter(0,0);return v?v._transformBounds(V):V},_hitTestSelf:function(v){if(this._contains(v)){var k=this;return new dt("pixel",k,{offset:v.add(k._size.divide(2)).round(),color:{get:function(){return k.getPixel(this.offset)}}})}},_draw:function(v,k,V){var $=this.getElement();if($&&$.width>0&&$.height>0){v.globalAlpha=ae.clamp(this._opacity,0,1),this._setStyles(v,k,V);var te=this._smoothing,fe=te==="off";Ci.setPrefixed(v,fe?"imageSmoothingEnabled":"imageSmoothingQuality",fe?!1:te),v.drawImage($,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),gt=Ge.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(k,V){this._initialize(k,V!==n&&be.read(arguments,1))||this.setDefinition(k instanceof bt?k:new bt(k))},_equals:function(v){return this._definition===v._definition},copyContent:function(v){this.setDefinition(v._definition)},getDefinition:function(){return this._definition},setDefinition:function(v){this._definition=v,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(v,k){var V=this._definition._item;return V._getCachedBounds(V._matrix.prepended(v),k)},_hitTestSelf:function(v,k,V){var $=k.extend({all:!1}),te=this._definition._item._hitTest(v,$,V);return te&&(te.item=this),te},_draw:function(v,k){this._definition._item.draw(v,k)}}),bt=b.extend({_class:"SymbolDefinition",initialize:function(k,V){this._id=ue.get(),this.project=In.project,k&&this.setItem(k,V)},_serialize:function(v,k){return k.add(this,function(){return b.serialize([this._class,this._item],v,!1,k)})},_changed:function(v){v&8&&Ge._clearBoundsCache(this),v&1&&this.project._changed(v)},getItem:function(){return this._item},setItem:function(v,k){v._symbol&&(v=v.clone()),this._item&&(this._item._symbol=null),this._item=v,v.remove(),v.setSelected(!1),k||v.setPosition(new be),v._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(v){return new gt(this,v)},clone:function(){return new bt(this._item.clone(!1))},equals:function(v){return v===this||v&&this._item.equals(v._item)||!1}}),dt=b.extend({_class:"HitResult",initialize:function(k,V,$){this.type=k,this.item=V,$&&this.inject($)},statics:{getOptions:function(v){var k=v&&b.read(v);return new b({type:null,tolerance:In.settings.hitTolerance,fill:!k,stroke:!k,segments:!k,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},k)}}}),$e=b.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(k,V,$,te,fe,ve){var Ie=arguments.length,Ee,ze,Qe,He;Ie>0&&(k==null||typeof k=="object"?Ie===1&&k&&"point"in k?(Ee=k.point,ze=k.handleIn,Qe=k.handleOut,He=k.selection):(Ee=k,ze=V,Qe=$,He=te):(Ee=[k,V],ze=$!==n?[$,te]:null,Qe=fe!==n?[fe,ve]:null)),new mt(Ee,this,"_point"),new mt(ze,this,"_handleIn"),new mt(Qe,this,"_handleOut"),He&&this.setSelection(He)},_serialize:function(v,k){var V=this._point,$=this._selection,te=$||this.hasHandles()?[V,this._handleIn,this._handleOut]:V;return $&&te.push($),b.serialize(te,v,!0,k)},_changed:function(v){var k=this._path;if(k){var V=k._curves,$=this._index,te;V&&((!v||v===this._point||v===this._handleIn)&&(te=$>0?V[$-1]:k._closed?V[V.length-1]:null)&&te._changed(),(!v||v===this._point||v===this._handleOut)&&(te=V[$])&&te._changed()),k._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(be.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(be.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(be.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var v=this._handleIn,k=this._handleOut;return!v.isZero()&&!k.isZero()&&v.isCollinear(k)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(v){var k=this._selection,V=this._path;this._selection=v=v||0,V&&v!==k&&(V._updateSelection(this,k,v),V._changed(257))},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){return!!(this._selection&7)},setSelected:function(v){this._changeSelection(7,v)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var v=this._path,k=this._index;return v?(k>0&&!v._closed&&k===v._segments.length-1&&k--,v.getCurves()[k]||null):null},getLocation:function(){var v=this.getCurve();return v?new Nt(v,this===v._segment1?0:1):null},getNext:function(){var v=this._path&&this._path._segments;return v&&(v[this._index+1]||this._path._closed&&v[0])||null},smooth:function(v,k,V){var $=v||{},te=$.type,fe=$.factor,ve=this.getPrevious(),Ie=this.getNext(),Ee=(ve||this)._point,ze=this._point,Qe=(Ie||this)._point,He=Ee.getDistance(ze),Ze=ze.getDistance(Qe);if(!te||te==="catmull-rom"){var Ve=fe===n?.5:fe,ft=Math.pow(He,Ve),nt=ft*ft,Me=Math.pow(Ze,Ve),se=Me*Me;if(!k&&ve){var ne=2*se+3*Me*ft+nt,X=3*Me*(Me+ft);this.setHandleIn(X!==0?new be((se*Ee._x+ne*ze._x-nt*Qe._x)/X-ze._x,(se*Ee._y+ne*ze._y-nt*Qe._y)/X-ze._y):new be)}if(!V&&Ie){var ne=2*nt+3*ft*Me+se,X=3*ft*(ft+Me);this.setHandleOut(X!==0?new be((nt*Qe._x+ne*ze._x-se*Ee._x)/X-ze._x,(nt*Qe._y+ne*ze._y-se*Ee._y)/X-ze._y):new be)}}else if(te==="geometric"){if(ve&&Ie){var ie=Ee.subtract(Qe),de=fe===n?.4:fe,ye=de*He/(He+Ze);k||this.setHandleIn(ie.multiply(ye)),V||this.setHandleOut(ie.multiply(ye-de))}}else throw new Error("Smoothing method '"+te+"' not supported.")},getPrevious:function(){var v=this._path&&this._path._segments;return v&&(v[this._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var v=this._path;return v&&this._index===v._segments.length-1||!1},reverse:function(){var v=this._handleIn,k=this._handleOut,V=v.clone();v.set(k),k.set(V)},reversed:function(){return new $e(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new $e(this._point,this._handleIn,this._handleOut)},equals:function(v){return v===this||v&&this._class===v._class&&this._point.equals(v._point)&&this._handleIn.equals(v._handleIn)&&this._handleOut.equals(v._handleOut)||!1},toString:function(){var v=["point: "+this._point];return this._handleIn.isZero()||v.push("handleIn: "+this._handleIn),this._handleOut.isZero()||v.push("handleOut: "+this._handleOut),"{ "+v.join(", ")+" }"},transform:function(v){this._transformCoordinates(v,new Array(6),!0),this._changed()},interpolate:function(v,k,V){var $=1-V,te=V,fe=v._point,ve=k._point,Ie=v._handleIn,Ee=k._handleIn,ze=k._handleOut,Qe=v._handleOut;this._point._set($*fe._x+te*ve._x,$*fe._y+te*ve._y,!0),this._handleIn._set($*Ie._x+te*Ee._x,$*Ie._y+te*Ee._y,!0),this._handleOut._set($*Qe._x+te*ze._x,$*Qe._y+te*ze._y,!0),this._changed()},_transformCoordinates:function(v,k,V){var $=this._point,te=!V||!this._handleIn.isZero()?this._handleIn:null,fe=!V||!this._handleOut.isZero()?this._handleOut:null,ve=$._x,Ie=$._y,Ee=2;return k[0]=ve,k[1]=Ie,te&&(k[Ee++]=te._x+ve,k[Ee++]=te._y+Ie),fe&&(k[Ee++]=fe._x+ve,k[Ee++]=fe._y+Ie),v&&(v._transformCoordinates(k,k,Ee/2),ve=k[0],Ie=k[1],V?($._x=ve,$._y=Ie,Ee=2,te&&(te._x=k[Ee++]-ve,te._y=k[Ee++]-Ie),fe&&(fe._x=k[Ee++]-ve,fe._y=k[Ee++]-Ie)):(te||(k[Ee++]=ve,k[Ee++]=Ie),fe||(k[Ee++]=ve,k[Ee++]=Ie))),k}}),mt=be.extend({initialize:function(k,V,$){var te,fe,ve;if(!k)te=fe=0;else if((te=k[0])!==n)fe=k[1];else{var Ie=k;(te=Ie.x)===n&&(Ie=be.read(arguments),te=Ie.x),fe=Ie.y,ve=Ie.selected}this._x=te,this._y=fe,this._owner=V,V[$]=this,ve&&this.setSelected(!0)},_set:function(v,k){return this._x=v,this._y=k,this._owner._changed(this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner._changed(this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner._changed(this)},isZero:function(){var v=ae.isZero;return v(this._x)&&v(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){var v=this._owner;return this===v._point?1:this===v._handleIn?2:this===v._handleOut?4:0}}),st=b.extend({_class:"Curve",beans:!0,initialize:function(k,V,$,te,fe,ve,Ie,Ee){var ze=arguments.length,Qe,He,Ze,Ve,ft,nt;ze===3?(this._path=k,Qe=V,He=$):ze?ze===1?"segment1"in k?(Qe=new $e(k.segment1),He=new $e(k.segment2)):"point1"in k?(Ze=k.point1,ft=k.handle1,nt=k.handle2,Ve=k.point2):Array.isArray(k)&&(Ze=[k[0],k[1]],Ve=[k[6],k[7]],ft=[k[2]-k[0],k[3]-k[1]],nt=[k[4]-k[6],k[5]-k[7]]):ze===2?(Qe=new $e(k),He=new $e(V)):ze===4?(Ze=k,ft=V,nt=$,Ve=te):ze===8&&(Ze=[k,V],Ve=[Ie,Ee],ft=[$-k,te-V],nt=[fe-Ie,ve-Ee]):(Qe=new $e,He=new $e),this._segment1=Qe||new $e(Ze,null,ft),this._segment2=He||new $e(Ve,nt,null)},_serialize:function(v,k){return b.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],v,!0,k)},_changed:function(){this._length=this._bounds=n},clone:function(){return new st(this._segment1,this._segment2)},toString:function(){var v=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||v.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||v.push("handle2: "+this._segment2._handleIn),v.push("point2: "+this._segment2._point),"{ "+v.join(", ")+" }"},classify:function(){return st.classify(this.getValues())},remove:function(){var v=!1;if(this._path){var k=this._segment2,V=k._handleOut;v=k.remove(),v&&this._segment1._handleOut.set(V)}return v},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(be.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(be.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(be.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(be.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index+1]||this._path._closed&&v[0])||null},getPrevious:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var v=this._path;return v&&this._segment1._index===v._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(v){this.getPoint1().setSelected(v),this.getHandle1().setSelected(v),this.getHandle2().setSelected(v),this.getPoint2().setSelected(v)},getValues:function(v){return st.getValues(this._segment1,this._segment2,v)},getPoints:function(){for(var v=this.getValues(),k=[],V=0;V<8;V+=2)k.push(new be(v[V],v[V+1]));return k}},{getLength:function(){return this._length==null&&(this._length=st.getLength(this.getValues(),0,1)),this._length},getArea:function(){return st.getArea(this.getValues())},getLine:function(){return new Pt(this._segment1._point,this._segment2._point)},getPart:function(v,k){return new st(st.getPart(this.getValues(),v,k))},getPartLength:function(v,k){return st.getLength(this.getValues(),v,k)},divideAt:function(v){return this.divideAtTime(v&&v.curve===this?v.time:this.getTimeAt(v))},divideAtTime:function(v,k){var V=1e-8,$=1-V,te=null;if(v>=V&&v<=$){var fe=st.subdivide(this.getValues(),v),ve=fe[0],Ie=fe[1],Ee=k||this.hasHandles(),ze=this._segment1,Qe=this._segment2,He=this._path;Ee&&(ze._handleOut._set(ve[2]-ve[0],ve[3]-ve[1]),Qe._handleIn._set(Ie[4]-Ie[6],Ie[5]-Ie[7]));var Ze=ve[6],Ve=ve[7],ft=new $e(new be(Ze,Ve),Ee&&new be(ve[4]-Ze,ve[5]-Ve),Ee&&new be(Ie[2]-Ze,Ie[3]-Ve));He?(He.insert(ze._index+1,ft),te=this.getNext()):(this._segment2=ft,this._changed(),te=new st(ft,Qe))}return te},splitAt:function(v){var k=this._path;return k?k.splitAt(v):null},splitAtTime:function(v){return this.splitAt(this.getLocationAtTime(v))},divide:function(v,k){return this.divideAtTime(v===n?.5:k?v:this.getTimeAt(v))},split:function(v,k){return this.splitAtTime(v===n?.5:k?v:this.getTimeAt(v))},reversed:function(){return new st(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(v,k,V,$){var te=v._point,fe=v._handleOut,ve=k._handleIn,Ie=k._point,Ee=te.x,ze=te.y,Qe=Ie.x,He=Ie.y,Ze=$?[Ee,ze,Ee,ze,Qe,He,Qe,He]:[Ee,ze,Ee+fe._x,ze+fe._y,Qe+ve._x,He+ve._y,Qe,He];return V&&V._transformCoordinates(Ze,Ze,4),Ze},subdivide:function(v,k){var V=v[0],$=v[1],te=v[2],fe=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7];k===n&&(k=.5);var Qe=1-k,He=Qe*V+k*te,Ze=Qe*$+k*fe,Ve=Qe*te+k*ve,ft=Qe*fe+k*Ie,nt=Qe*ve+k*Ee,Me=Qe*Ie+k*ze,se=Qe*He+k*Ve,ne=Qe*Ze+k*ft,X=Qe*Ve+k*nt,ie=Qe*ft+k*Me,de=Qe*se+k*X,ye=Qe*ne+k*ie;return[[V,$,He,Ze,se,ne,de,ye],[de,ye,X,ie,nt,Me,Ee,ze]]},getMonoCurves:function(v,k){var V=[],$=k?0:1,te=v[$+0],fe=v[$+2],ve=v[$+4],Ie=v[$+6];if(te>=fe==fe>=ve&&fe>=ve==ve>=Ie||st.isStraight(v))V.push(v);else{var Ee=3*(fe-ve)-te+Ie,ze=2*(te+ve)-4*fe,Qe=fe-te,He=1e-8,Ze=1-He,Ve=[],ft=ae.solveQuadratic(Ee,ze,Qe,Ve,He,Ze);if(!ft)V.push(v);else{Ve.sort();var nt=Ve[0],Me=st.subdivide(v,nt);V.push(Me[0]),ft>1&&(nt=(Ve[1]-nt)/(1-nt),Me=st.subdivide(Me[1],nt),V.push(Me[0])),V.push(Me[1])}}return V},solveCubic:function(v,k,V,$,te,fe){var ve=v[k],Ie=v[k+2],Ee=v[k+4],ze=v[k+6],Qe=0;if(!(ve<V&&ze<V&&Ie<V&&Ee<V||ve>V&&ze>V&&Ie>V&&Ee>V)){var He=3*(Ie-ve),Ze=3*(Ee-Ie)-He,Ve=ze-ve-He-Ze;Qe=ae.solveCubic(Ve,Ze,He,ve-V,$,te,fe)}return Qe},getTimeOf:function(v,k){var V=new be(v[0],v[1]),$=new be(v[6],v[7]),te=1e-12,fe=1e-7,ve=k.isClose(V,te)?0:k.isClose($,te)?1:null;if(ve===null)for(var Ie=[k.x,k.y],Ee=[],ze=0;ze<2;ze++)for(var Qe=st.solveCubic(v,ze,Ie[ze],Ee,0,1),He=0;He<Qe;He++){var Ze=Ee[He];if(k.isClose(st.getPoint(v,Ze),fe))return Ze}return k.isClose(V,fe)?0:k.isClose($,fe)?1:null},getNearestTime:function(v,k){if(st.isStraight(v)){var V=v[0],$=v[1],te=v[6],fe=v[7],ve=te-V,Ie=fe-$,Ee=ve*ve+Ie*Ie;if(Ee===0)return 0;var ze=((k.x-V)*ve+(k.y-$)*Ie)/Ee;return ze<1e-12?0:ze>.999999999999?1:st.getTimeOf(v,new be(V+ze*ve,$+ze*Ie))}var Qe=100,He=1/0,Ze=0;function Ve(Me){if(Me>=0&&Me<=1){var se=k.getDistance(st.getPoint(v,Me),!0);if(se<He)return He=se,Ze=Me,!0}}for(var ft=0;ft<=Qe;ft++)Ve(ft/Qe);for(var nt=1/(Qe*2);nt>1e-8;)!Ve(Ze-nt)&&!Ve(Ze+nt)&&(nt/=2);return Ze},getPart:function(v,k,V){var $=k>V;if($){var te=k;k=V,V=te}return k>0&&(v=st.subdivide(v,k)[1]),V<1&&(v=st.subdivide(v,(V-k)/(1-k))[0]),$?[v[6],v[7],v[4],v[5],v[2],v[3],v[0],v[1]]:v},isFlatEnough:function(v,k){var V=v[0],$=v[1],te=v[2],fe=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7],Qe=3*te-2*V-Ee,He=3*fe-2*$-ze,Ze=3*ve-2*Ee-V,Ve=3*Ie-2*ze-$;return Math.max(Qe*Qe,Ze*Ze)+Math.max(He*He,Ve*Ve)<=16*k*k},getArea:function(v){var k=v[0],V=v[1],$=v[2],te=v[3],fe=v[4],ve=v[5],Ie=v[6],Ee=v[7];return 3*((Ee-V)*($+fe)-(Ie-k)*(te+ve)+te*(k-fe)-$*(V-ve)+Ee*(fe+k/3)-Ie*(ve+V/3))/20},getBounds:function(v){for(var k=v.slice(0,2),V=k.slice(),$=[0,0],te=0;te<2;te++)st._addBounds(v[te],v[te+2],v[te+4],v[te+6],te,0,k,V,$);return new lt(k[0],k[1],V[0]-k[0],V[1]-k[1])},_addBounds:function(v,k,V,$,te,fe,ve,Ie,Ee){function ze(de,ye){var ge=de-ye,Pe=de+ye;ge<ve[te]&&(ve[te]=ge),Pe>Ie[te]&&(Ie[te]=Pe)}fe/=2;var Qe=ve[te]+fe,He=Ie[te]-fe;if(v<Qe||k<Qe||V<Qe||$<Qe||v>He||k>He||V>He||$>He)if(k<v!=k<$&&V<v!=V<$)ze(v,0),ze($,0);else{var Ze=3*(k-V)-v+$,Ve=2*(v+V)-4*k,ft=k-v,nt=ae.solveQuadratic(Ze,Ve,ft,Ee),Me=1e-8,se=1-Me;ze($,0);for(var ne=0;ne<nt;ne++){var X=Ee[ne],ie=1-X;Me<=X&&X<=se&&ze(ie*ie*ie*v+3*ie*ie*X*k+3*ie*X*X*V+X*X*X*$,fe)}}}}},b.each(["getBounds","getStrokeBounds","getHandleBounds"],function(v){this[v]=function(){this._bounds||(this._bounds={});var k=this._bounds[v];return k||(k=this._bounds[v]=Ot[v]([this._segment1,this._segment2],!1,this._path)),k.clone()}},{}),b.each({isStraight:function(v,k,V,$){if(k.isZero()&&V.isZero())return!0;var te=$.subtract(v);if(te.isZero())return!1;if(te.isCollinear(k)&&te.isCollinear(V)){var fe=new Pt(v,$),ve=1e-7;if(fe.getDistance(v.add(k))<ve&&fe.getDistance($.add(V))<ve){var Ie=te.dot(te),Ee=te.dot(k)/Ie,ze=te.dot(V)/Ie;return Ee>=0&&Ee<=1&&ze<=0&&ze>=-1}}return!1},isLinear:function(v,k,V,$){var te=$.subtract(v).divide(3);return k.equals(te)&&V.negate().equals(te)}},function(v,k){this[k]=function(V){var $=this._segment1,te=this._segment2;return v($._point,$._handleOut,te._handleIn,te._point,V)},this.statics[k]=function(V,$){var te=V[0],fe=V[1],ve=V[6],Ie=V[7];return v(new be(te,fe),new be(V[2]-te,V[3]-fe),new be(V[4]-ve,V[5]-Ie),new be(ve,Ie),$)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(v){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(v||0)},isCollinear:function(v){return v&&this.isStraight()&&v.isStraight()&&this.getLine().isCollinear(v.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(v,k){return this.getLocationAtTime(k?v:this.getTimeAt(v))},getLocationAtTime:function(v){return v!=null&&v>=0&&v<=1?new Nt(this,v):null},getTimeAt:function(v,k){return st.getTimeAt(this.getValues(),v,k)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var v=be.read(arguments);return v.isZero()?[]:st.getTimesWithTangent(this.getValues(),v)},getOffsetAtTime:function(v){return this.getPartLength(0,v)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(be.read(arguments)))},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getTimeOf:function(){return st.getTimeOf(this.getValues(),be.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var v=be.read(arguments),k=this.getValues(),V=st.getNearestTime(k,v),$=st.getPoint(k,V);return new Nt(this,V,$,null,v.getDistance($))},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()}},new function(){var v=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return b.each(v,function(k){this[k+"At"]=function(V,$){var te=this.getValues();return st[k](te,$?V:st.getTimeAt(te,V))},this[k+"AtTime"]=function(V){return st[k](this.getValues(),V)}},{statics:{_evaluateMethods:v}})},new function(){function v($){var te=$[0],fe=$[1],ve=$[2],Ie=$[3],Ee=$[4],ze=$[5],Qe=$[6],He=$[7],Ze=9*(ve-Ee)+3*(Qe-te),Ve=6*(te+Ee)-12*ve,ft=3*(ve-te),nt=9*(Ie-ze)+3*(He-fe),Me=6*(fe+ze)-12*Ie,se=3*(Ie-fe);return function(ne){var X=(Ze*ne+Ve)*ne+ft,ie=(nt*ne+Me)*ne+se;return Math.sqrt(X*X+ie*ie)}}function k($,te){return Math.max(2,Math.min(16,Math.ceil(Math.abs(te-$)*32)))}function V($,te,fe,ve){if(te==null||te<0||te>1)return null;var Ie=$[0],Ee=$[1],ze=$[2],Qe=$[3],He=$[4],Ze=$[5],Ve=$[6],ft=$[7],nt=ae.isZero;nt(ze-Ie)&&nt(Qe-Ee)&&(ze=Ie,Qe=Ee),nt(He-Ve)&&nt(Ze-ft)&&(He=Ve,Ze=ft);var Me=3*(ze-Ie),se=3*(He-ze)-Me,ne=Ve-Ie-Me-se,X=3*(Qe-Ee),ie=3*(Ze-Qe)-X,de=ft-Ee-X-ie,ye,ge;if(fe===0)ye=te===0?Ie:te===1?Ve:((ne*te+se)*te+Me)*te+Ie,ge=te===0?Ee:te===1?ft:((de*te+ie)*te+X)*te+Ee;else{var Pe=1e-8,Fe=1-Pe;if(te<Pe?(ye=Me,ge=X):te>Fe?(ye=3*(Ve-He),ge=3*(ft-Ze)):(ye=(3*ne*te+2*se)*te+Me,ge=(3*de*te+2*ie)*te+X),ve){ye===0&&ge===0&&(te<Pe||te>Fe)&&(ye=He-ze,ge=Ze-Qe);var Ne=Math.sqrt(ye*ye+ge*ge);Ne&&(ye/=Ne,ge/=Ne)}if(fe===3){var He=6*ne*te+2*se,Ze=6*de*te+2*ie,Xe=Math.pow(ye*ye+ge*ge,3/2);ye=Xe!==0?(ye*Ze-ge*He)/Xe:0,ge=0}}return fe===2?new be(ge,-ye):new be(ye,ge)}return{statics:{classify:function($){var te=$[0],fe=$[1],ve=$[2],Ie=$[3],Ee=$[4],ze=$[5],Qe=$[6],He=$[7],Ze=te*(He-ze)+fe*(Ee-Qe)+Qe*ze-He*Ee,Ve=ve*(fe-He)+Ie*(Qe-te)+te*He-fe*Qe,ft=Ee*(Ie-fe)+ze*(te-ve)+ve*fe-Ie*te,nt=3*ft,Me=nt-Ve,se=Me-Ve+Ze,ne=Math.sqrt(se*se+Me*Me+nt*nt),X=ne!==0?1/ne:0,ie=ae.isZero,de="serpentine";se*=X,Me*=X,nt*=X;function ye(Ne,Xe,Ye){var De=Xe!==n,Ue=De&&Xe>0&&Xe<1,ht=De&&Ye>0&&Ye<1;return De&&(!(Ue||ht)||Ne==="loop"&&!(Ue&&ht))&&(Ne="arch",Ue=ht=!1),{type:Ne,roots:Ue||ht?Ue&&ht?Xe<Ye?[Xe,Ye]:[Ye,Xe]:[Ue?Xe:Ye]:null}}if(ie(se))return ie(Me)?ye(ie(nt)?"line":"quadratic"):ye(de,nt/(3*Me));var ge=3*Me*Me-4*se*nt;if(ie(ge))return ye("cusp",Me/(2*se));var Pe=ge>0?Math.sqrt(ge/3):Math.sqrt(-ge),Fe=2*se;return ye(ge>0?de:"loop",(Me+Pe)/Fe,(Me-Pe)/Fe)},getLength:function($,te,fe,ve){if(te===n&&(te=0),fe===n&&(fe=1),st.isStraight($)){var Ie=$;fe<1&&(Ie=st.subdivide(Ie,fe)[0],te/=fe),te>0&&(Ie=st.subdivide(Ie,te)[1]);var Ee=Ie[6]-Ie[0],ze=Ie[7]-Ie[1];return Math.sqrt(Ee*Ee+ze*ze)}return ae.integrate(ve||v($),te,fe,k(te,fe))},getTimeAt:function($,te,fe){if(fe===n&&(fe=te<0?1:0),te===0)return fe;var ve=Math.abs,Ie=1e-12,Ee=te>0,ze=Ee?fe:0,Qe=Ee?1:fe,He=v($),Ze=st.getLength($,ze,Qe,He),Ve=ve(te)-Ze;if(ve(Ve)<Ie)return Ee?Qe:ze;if(Ve>Ie)return null;var ft=te/Ze,nt=0;function Me(se){return nt+=ae.integrate(He,fe,se,k(fe,se)),fe=se,nt-te}return ae.findRoot(Me,He,fe+ft,ze,Qe,32,1e-12)},getPoint:function($,te){return V($,te,0,!1)},getTangent:function($,te){return V($,te,1,!0)},getWeightedTangent:function($,te){return V($,te,1,!1)},getNormal:function($,te){return V($,te,2,!0)},getWeightedNormal:function($,te){return V($,te,2,!1)},getCurvature:function($,te){return V($,te,3,!1).x},getPeaks:function($){var te=$[0],fe=$[1],ve=$[2],Ie=$[3],Ee=$[4],ze=$[5],Qe=$[6],He=$[7],Ze=-te+3*ve-3*Ee+Qe,Ve=3*te-6*ve+3*Ee,ft=-3*te+3*ve,nt=-fe+3*Ie-3*ze+He,Me=3*fe-6*Ie+3*ze,se=-3*fe+3*Ie,ne=1e-8,X=1-ne,ie=[];return ae.solveCubic(9*(Ze*Ze+nt*nt),9*(Ze*Ve+Me*nt),2*(Ve*Ve+Me*Me)+3*(ft*Ze+se*nt),ft*Ve+Me*se,ie,ne,X),ie.sort()}}}},new function(){function v(Ve,ft,nt,Me,se,ne,X){var ie=!X&&nt.getPrevious()===se,de=!X&&nt!==se&&nt.getNext()===se,ye=1e-8,ge=1-ye;if(Me!==null&&Me>=(ie?ye:0)&&Me<=(de?ge:1)&&ne!==null&&ne>=(de?ye:0)&&ne<=(ie?ge:1)){var Pe=new Nt(nt,Me,null,X),Fe=new Nt(se,ne,null,X);Pe._intersection=Fe,Fe._intersection=Pe,(!ft||ft(Pe))&&Nt.insert(Ve,Pe,!0)}}function k(Ve,ft,nt,Me,se,ne,X,ie,de,ye,ge,Pe,Fe){if(++de>=4096||++ie>=40)return de;var Ne=1e-9,Xe=ft[0],Ye=ft[1],De=ft[6],Ue=ft[7],ht=Pt.getSignedDistance,kt=ht(Xe,Ye,De,Ue,ft[2],ft[3]),o=ht(Xe,Ye,De,Ue,ft[4],ft[5]),ke=kt*o>0?3/4:4/9,oi=ke*Math.min(0,kt,o),di=ke*Math.max(0,kt,o),Ai=ht(Xe,Ye,De,Ue,Ve[0],Ve[1]),Jt=ht(Xe,Ye,De,Ue,Ve[2],Ve[3]),li=ht(Xe,Ye,De,Ue,Ve[4],Ve[5]),zi=ht(Xe,Ye,De,Ue,Ve[6],Ve[7]),vi=V(Ai,Jt,li,zi),wi=vi[0],$t=vi[1],vn,or;if(kt===0&&o===0&&Ai===0&&Jt===0&&li===0&&zi===0||(vn=$(wi,$t,oi,di))==null||(or=$(wi.reverse(),$t.reverse(),oi,di))==null)return de;var mn=ye+(ge-ye)*vn,qn=ye+(ge-ye)*or;if(Math.max(Fe-Pe,qn-mn)<Ne){var jr=(mn+qn)/2,Hi=(Pe+Fe)/2;v(se,ne,X?Me:nt,X?Hi:jr,X?nt:Me,X?jr:Hi)}else{Ve=st.getPart(Ve,vn,or);var ur=Fe-Pe;if(or-vn>.8)if(qn-mn>ur){var On=st.subdivide(Ve,.5),jr=(mn+qn)/2;de=k(ft,On[0],Me,nt,se,ne,!X,ie,de,Pe,Fe,mn,jr),de=k(ft,On[1],Me,nt,se,ne,!X,ie,de,Pe,Fe,jr,qn)}else{var On=st.subdivide(ft,.5),Hi=(Pe+Fe)/2;de=k(On[0],Ve,Me,nt,se,ne,!X,ie,de,Pe,Hi,mn,qn),de=k(On[1],Ve,Me,nt,se,ne,!X,ie,de,Hi,Fe,mn,qn)}else ur===0||ur>=Ne?de=k(ft,Ve,Me,nt,se,ne,!X,ie,de,Pe,Fe,mn,qn):de=k(Ve,ft,nt,Me,se,ne,X,ie,de,mn,qn,Pe,Fe)}return de}function V(Ve,ft,nt,Me){var se=[0,Ve],ne=[1/3,ft],X=[2/3,nt],ie=[1,Me],de=ft-(2*Ve+Me)/3,ye=nt-(Ve+2*Me)/3,ge;if(de*ye<0)ge=[[se,ne,ie],[se,X,ie]];else{var Pe=de/ye;ge=[Pe>=2?[se,ne,ie]:Pe<=.5?[se,X,ie]:[se,ne,X,ie],[se,ie]]}return(de||ye)<0?ge.reverse():ge}function $(Ve,ft,nt,Me){return Ve[0][1]<nt?te(Ve,!0,nt):ft[0][1]>Me?te(ft,!1,Me):Ve[0][0]}function te(Ve,ft,nt){for(var Me=Ve[0][0],se=Ve[0][1],ne=1,X=Ve.length;ne<X;ne++){var ie=Ve[ne][0],de=Ve[ne][1];if(ft?de>=nt:de<=nt)return de===nt?ie:Me+(nt-se)*(ie-Me)/(de-se);Me=ie,se=de}return null}function fe(Ve,ft,nt,Me,se){var ne=ae.isZero;if(ne(Me)&&ne(se)){var X=st.getTimeOf(Ve,new be(ft,nt));return X===null?[]:[X]}for(var ie=Math.atan2(-se,Me),de=Math.sin(ie),ye=Math.cos(ie),ge=[],Pe=[],Fe=0;Fe<8;Fe+=2){var Ne=Ve[Fe]-ft,Xe=Ve[Fe+1]-nt;ge.push(Ne*ye-Xe*de,Ne*de+Xe*ye)}return st.solveCubic(ge,1,0,Pe,0,1),Pe}function ve(Ve,ft,nt,Me,se,ne,X){for(var ie=ft[0],de=ft[1],ye=ft[6],ge=ft[7],Pe=fe(Ve,ie,de,ye-ie,ge-de),Fe=0,Ne=Pe.length;Fe<Ne;Fe++){var Xe=Pe[Fe],Ye=st.getPoint(Ve,Xe),De=st.getTimeOf(ft,Ye);De!==null&&v(se,ne,X?Me:nt,X?De:Xe,X?nt:Me,X?Xe:De)}}function Ie(Ve,ft,nt,Me,se,ne){var X=Pt.intersect(Ve[0],Ve[1],Ve[6],Ve[7],ft[0],ft[1],ft[6],ft[7]);X&&v(se,ne,nt,st.getTimeOf(Ve,X),Me,st.getTimeOf(ft,X))}function Ee(Ve,ft,nt,Me,se,ne){var X=1e-12,ie=Math.min,de=Math.max;if(de(Ve[0],Ve[2],Ve[4],Ve[6])+X>ie(ft[0],ft[2],ft[4],ft[6])&&ie(Ve[0],Ve[2],Ve[4],Ve[6])-X<de(ft[0],ft[2],ft[4],ft[6])&&de(Ve[1],Ve[3],Ve[5],Ve[7])+X>ie(ft[1],ft[3],ft[5],ft[7])&&ie(Ve[1],Ve[3],Ve[5],Ve[7])-X<de(ft[1],ft[3],ft[5],ft[7])){var ye=He(Ve,ft);if(ye)for(var ge=0;ge<2;ge++){var Pe=ye[ge];v(se,ne,nt,Pe[0],Me,Pe[1],!0)}else{var Fe=st.isStraight(Ve),Ne=st.isStraight(ft),Xe=Fe&&Ne,Ye=Fe&&!Ne,De=se.length;if((Xe?Ie:Fe||Ne?ve:k)(Ye?ft:Ve,Ye?Ve:ft,Ye?Me:nt,Ye?nt:Me,se,ne,Ye,0,0,0,1,0,1),!Xe||se.length===De)for(var ge=0;ge<4;ge++){var Ue=ge>>1,ht=ge&1,kt=Ue*6,o=ht*6,ke=new be(Ve[kt],Ve[kt+1]),oi=new be(ft[o],ft[o+1]);ke.isClose(oi,X)&&v(se,ne,nt,Ue,Me,ht)}}}return se}function ze(Ve,ft,nt,Me){var se=st.classify(Ve);if(se.type==="loop"){var ne=se.roots;v(nt,Me,ft,ne[0],ft,ne[1])}return nt}function Qe(Ve,ft,nt,Me,se,ne){var X=1e-7,ie=!ft;ie&&(ft=Ve);for(var de=Ve.length,ye=ft.length,ge=new Array(de),Pe=ie?ge:new Array(ye),Fe=[],Ne=0;Ne<de;Ne++)ge[Ne]=Ve[Ne].getValues(Me);if(!ie)for(var Ne=0;Ne<ye;Ne++)Pe[Ne]=ft[Ne].getValues(se);for(var Xe=W.findCurveBoundsCollisions(ge,Pe,X),Ye=0;Ye<de;Ye++){var De=Ve[Ye],Ue=ge[Ye];ie&&ze(Ue,De,Fe,nt);var ht=Xe[Ye];if(ht)for(var kt=0;kt<ht.length;kt++){if(ne&&Fe.length)return Fe;var o=ht[kt];if(!ie||o>Ye){var ke=ft[o],oi=Pe[o];Ee(Ue,oi,De,ke,Fe,nt)}}}return Fe}function He(Ve,ft){function nt(zi){var vi=zi[6]-zi[0],wi=zi[7]-zi[1];return vi*vi+wi*wi}var Me=Math.abs,se=Pt.getDistance,ne=1e-8,X=1e-7,ie=st.isStraight(Ve),de=st.isStraight(ft),ye=ie&&de,ge=nt(Ve)<nt(ft),Pe=ge?ft:Ve,Fe=ge?Ve:ft,Ne=Pe[0],Xe=Pe[1],Ye=Pe[6]-Ne,De=Pe[7]-Xe;if(se(Ne,Xe,Ye,De,Fe[0],Fe[1],!0)<X&&se(Ne,Xe,Ye,De,Fe[6],Fe[7],!0)<X)!ye&&se(Ne,Xe,Ye,De,Pe[2],Pe[3],!0)<X&&se(Ne,Xe,Ye,De,Pe[4],Pe[5],!0)<X&&se(Ne,Xe,Ye,De,Fe[2],Fe[3],!0)<X&&se(Ne,Xe,Ye,De,Fe[4],Fe[5],!0)<X&&(ie=de=ye=!0);else if(ye)return null;if(ie^de)return null;for(var Ue=[Ve,ft],ht=[],kt=0;kt<4&&ht.length<2;kt++){var o=kt&1,ke=o^1,oi=kt>>1,di=st.getTimeOf(Ue[o],new be(Ue[ke][oi?6:0],Ue[ke][oi?7:1]));if(di!=null){var Ai=o?[oi,di]:[di,oi];(!ht.length||Me(Ai[0]-ht[0][0])>ne&&Me(Ai[1]-ht[0][1])>ne)&&ht.push(Ai)}if(kt>2&&!ht.length)break}if(ht.length!==2)ht=null;else if(!ye){var Jt=st.getPart(Ve,ht[0][0],ht[1][0]),li=st.getPart(ft,ht[0][1],ht[1][1]);(Me(li[2]-Jt[2])>X||Me(li[3]-Jt[3])>X||Me(li[4]-Jt[4])>X||Me(li[5]-Jt[5])>X)&&(ht=null)}return ht}function Ze(Ve,ft){var nt=Ve[0],Me=Ve[1],se=Ve[2],ne=Ve[3],X=Ve[4],ie=Ve[5],de=Ve[6],ye=Ve[7],ge=ft.normalize(),Pe=ge.x,Fe=ge.y,Ne=3*de-9*X+9*se-3*nt,Xe=3*ye-9*ie+9*ne-3*Me,Ye=6*X-12*se+6*nt,De=6*ie-12*ne+6*Me,Ue=3*se-3*nt,ht=3*ne-3*Me,kt=2*Ne*Fe-2*Xe*Pe,o=[];if(Math.abs(kt)<ae.CURVETIME_EPSILON){var ke=Ne*ht-Xe*Ue,kt=Ne*De-Xe*Ye;if(kt!=0){var oi=-ke/kt;oi>=0&&oi<=1&&o.push(oi)}}else{var di=(Ye*Ye-4*Ne*Ue)*Fe*Fe+(-2*Ye*De+4*Xe*Ue+4*Ne*ht)*Pe*Fe+(De*De-4*Xe*ht)*Pe*Pe,Ai=Ye*Fe-De*Pe;if(di>=0&&kt!=0){var Jt=Math.sqrt(di),li=-(Ai+Jt)/kt,zi=(-Ai+Jt)/kt;li>=0&&li<=1&&o.push(li),zi>=0&&zi<=1&&o.push(zi)}}return o}return{getIntersections:function(Ve){var ft=this.getValues(),nt=Ve&&Ve!==this&&Ve.getValues();return nt?Ee(ft,nt,this,Ve,[]):ze(ft,this,[])},statics:{getOverlaps:He,getIntersections:Qe,getCurveLineIntersections:fe,getTimesWithTangent:Ze}}}),Nt=b.extend({_class:"CurveLocation",initialize:function(k,V,$,te,fe){if(V>=.99999999){var ve=k.getNext();ve&&(V=0,k=ve)}this._setCurve(k),this._time=V,this._point=$||k.getPointAtTime(V),this._overlap=te,this._distance=fe,this._intersection=this._next=this._previous=null},_setPath:function(v){this._path=v,this._version=v?v._version:0},_setCurve:function(v){this._setPath(v._path),this._curve=v,this._segment=null,this._segment1=v._segment1,this._segment2=v._segment2},_setSegment:function(v){var k=v.getCurve();k?this._setCurve(k):(this._setPath(v._path),this._segment1=v,this._segment2=null),this._segment=v,this._time=v===this._segment1?0:1,this._point=v._point.clone()},getSegment:function(){var v=this._segment;if(!v){var k=this.getCurve(),V=this.getTime();V===0?v=k._segment1:V===1?v=k._segment2:V!=null&&(v=k.getPartLength(0,V)<k.getPartLength(V,1)?k._segment1:k._segment2),this._segment=v}return v},getCurve:function(){var v=this._path,k=this;v&&v._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function V($){var te=$&&$.getCurve();if(te&&(k._time=te.getTimeOf(k._point))!=null)return k._setCurve(te),te}return this._curve||V(this._segment)||V(this._segment1)||V(this._segment2.getPrevious())},getPath:function(){var v=this.getCurve();return v&&v._path},getIndex:function(){var v=this.getCurve();return v&&v.getIndex()},getTime:function(){var v=this.getCurve(),k=this._time;return v&&k==null?this._time=v.getTimeOf(this._point):k},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var v=this._offset;if(v==null){v=0;var k=this.getPath(),V=this.getIndex();if(k&&V!=null)for(var $=k.getCurves(),te=0;te<V;te++)v+=$[te].getLength();this._offset=v+=this.getCurveOffset()}return v},getCurveOffset:function(){var v=this._curveOffset;if(v==null){var k=this.getCurve(),V=this.getTime();this._curveOffset=v=V!=null&&k&&k.getPartLength(0,V)}return v},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var v=this.getCurve(),k=v&&v.divideAtTime(this.getTime());return k&&this._setSegment(k._segment1),k},split:function(){var v=this.getCurve(),k=v._path,V=v&&v.splitAtTime(this.getTime());return V&&this._setSegment(k.getLastSegment()),V},equals:function(v,k){var V=this===v;if(!V&&v instanceof Nt){var $=this.getCurve(),te=v.getCurve(),fe=$._path,ve=te._path;if(fe===ve){var Ie=Math.abs,Ee=1e-7,ze=Ie(this.getOffset()-v.getOffset()),Qe=!k&&this._intersection,He=!k&&v._intersection;V=(ze<Ee||fe&&Ie(fe.getLength()-ze)<Ee)&&(!Qe&&!He||Qe&&He&&Qe.equals(He,!0))}}return V},toString:function(){var v=[],k=this.getPoint(),V=he.instance;k&&v.push("point: "+k);var $=this.getIndex();$!=null&&v.push("index: "+$);var te=this.getTime();return te!=null&&v.push("time: "+V.number(te)),this._distance!=null&&v.push("distance: "+V.number(this._distance)),"{ "+v.join(", ")+" }"},isTouching:function(){var v=this._intersection;if(v&&this.getTangent().isCollinear(v.getTangent())){var k=this.getCurve(),V=v.getCurve();return!(k.isStraight()&&V.isStraight()&&k.getLine().intersect(V.getLine()))}return!1},isCrossing:function(){var v=this._intersection;if(!v)return!1;var k=this.getTime(),V=v.getTime(),$=1e-8,te=1-$,fe=k>=$&&k<=te,ve=V>=$&&V<=te;if(fe&&ve)return!this.isTouching();var Ie=this.getCurve(),Ee=Ie&&k<$?Ie.getPrevious():Ie,ze=v.getCurve(),Qe=ze&&V<$?ze.getPrevious():ze;if(k>te&&(Ie=Ie.getNext()),V>te&&(ze=ze.getNext()),!Ee||!Ie||!Qe||!ze)return!1;var He=[];function Ze(Pe,Fe){var Ne=Pe.getValues(),Xe=st.classify(Ne).roots||st.getPeaks(Ne),Ye=Xe.length,De=st.getLength(Ne,Fe&&Ye?Xe[Ye-1]:0,!Fe&&Ye?Xe[0]:1);He.push(Ye?De:De/32)}function Ve(Pe,Fe,Ne){return Fe<Ne?Pe>Fe&&Pe<Ne:Pe>Fe||Pe<Ne}fe||(Ze(Ee,!0),Ze(Ie,!1)),ve||(Ze(Qe,!0),Ze(ze,!1));var ft=this.getPoint(),nt=Math.min.apply(Math,He),Me=fe?Ie.getTangentAtTime(k):Ie.getPointAt(nt).subtract(ft),se=fe?Me.negate():Ee.getPointAt(-nt).subtract(ft),ne=ve?ze.getTangentAtTime(V):ze.getPointAt(nt).subtract(ft),X=ve?ne.negate():Qe.getPointAt(-nt).subtract(ft),ie=se.getAngle(),de=Me.getAngle(),ye=X.getAngle(),ge=ne.getAngle();return!!(fe?Ve(ie,ye,ge)^Ve(de,ye,ge)&&Ve(ie,ge,ye)^Ve(de,ge,ye):Ve(ye,ie,de)^Ve(ge,ie,de)&&Ve(ye,de,ie)^Ve(ge,de,ie))},hasOverlap:function(){return!!this._overlap}},b.each(st._evaluateMethods,function(v){var k=v+"At";this[v]=function(){var V=this.getCurve(),$=this.getTime();return $!=null&&V&&V[k]($,!0)}},{preserve:!0}),new function(){function v(k,V,$){var te=k.length,fe=0,ve=te-1;function Ie(ft,nt){for(var Me=ft+nt;Me>=-1&&Me<=te;Me+=nt){var se=k[(Me%te+te)%te];if(!V.getPoint().isClose(se.getPoint(),1e-7))break;if(V.equals(se))return se}return null}for(;fe<=ve;){var Ee=fe+ve>>>1,ze=k[Ee],Qe;if($&&(Qe=V.equals(ze)?ze:Ie(Ee,-1)||Ie(Ee,1)))return V._overlap&&(Qe._overlap=Qe._intersection._overlap=!0),Qe;var He=V.getPath(),Ze=ze.getPath(),Ve=He!==Ze?He._id-Ze._id:V.getIndex()+V.getTime()-(ze.getIndex()+ze.getTime());Ve<0?ve=Ee-1:fe=Ee+1}return k.splice(fe,0,V),V}return{statics:{insert:v,expand:function(k){for(var V=k.slice(),$=k.length-1;$>=0;$--)v(V,k[$]._intersection,!1);return V}}}}),Rt=Ge.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(v){var k,V,$;if(b.isPlainObject(v)?(V=v.segments,k=v.pathData):Array.isArray(v)?V=v:typeof v=="string"&&(k=v),V){var te=V[0];$=te&&Array.isArray(te[0])}else k&&($=(k.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(k));var fe=$?_i:Ot;return new fe(v)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(v){this.isClockwise()!=(v=!!v)&&this.reverse()},setPathData:function(v){var k=v&&v.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),V,$=!1,te,fe,ve=new be,Ie=new be;function Ee(X,ie){var de=+V[X];return $&&(de+=ve[ie]),de}function ze(X){return new be(Ee(X,"x"),Ee(X+1,"y"))}this.clear();for(var Qe=0,He=k&&k.length;Qe<He;Qe++){var Ze=k[Qe],Ve=Ze[0],ft=Ve.toLowerCase();V=Ze.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var nt=V&&V.length;switch($=Ve===ft,te==="z"&&!/[mz]/.test(ft)&&this.moveTo(ve),ft){case"m":case"l":for(var Me=ft==="m",se=0;se<nt;se+=2)this[Me?"moveTo":"lineTo"](ve=ze(se)),Me&&(Ie=ve,Me=!1);fe=ve;break;case"h":case"v":var ne=ft==="h"?"x":"y";ve=ve.clone();for(var se=0;se<nt;se++)ve[ne]=Ee(se,ne),this.lineTo(ve);fe=ve;break;case"c":for(var se=0;se<nt;se+=6)this.cubicCurveTo(ze(se),fe=ze(se+2),ve=ze(se+4));break;case"s":for(var se=0;se<nt;se+=4)this.cubicCurveTo(/[cs]/.test(te)?ve.multiply(2).subtract(fe):ve,fe=ze(se),ve=ze(se+2)),te=ft;break;case"q":for(var se=0;se<nt;se+=4)this.quadraticCurveTo(fe=ze(se),ve=ze(se+2));break;case"t":for(var se=0;se<nt;se+=2)this.quadraticCurveTo(fe=/[qt]/.test(te)?ve.multiply(2).subtract(fe):ve,ve=ze(se)),te=ft;break;case"a":for(var se=0;se<nt;se+=7)this.arcTo(ve=ze(se+5),new ot(+V[se],+V[se+1]),+V[se+2],+V[se+4],+V[se+3]);break;case"z":this.closePath(1e-12),ve=Ie;break}te=ft}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(v){var k=v.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(v):{};return k.onPath||!!(this.getFillRule()==="evenodd"?k.windingL&1||k.windingR&1:k.winding)},getIntersections:function(v,k,V,$){var te=this===v||!v,fe=this._matrix._orNullIfIdentity(),ve=te?fe:(V||v._matrix)._orNullIfIdentity();return te||this.getBounds(fe).intersects(v.getBounds(ve),1e-12)?st.getIntersections(this.getCurves(),!te&&v.getCurves(),k,fe,ve,$):[]},getCrossings:function(v){return this.getIntersections(v,function(k){return k.isCrossing()})},getNearestLocation:function(){for(var v=be.read(arguments),k=this.getCurves(),V=1/0,$=null,te=0,fe=k.length;te<fe;te++){var ve=k[te].getNearestLocation(v);ve._distance<V&&(V=ve._distance,$=ve)}return $},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()},interpolate:function(v,k,V){var $=!this._children,te=$?"_segments":"_children",fe=v[te],ve=k[te],Ie=this[te];if(!fe||!ve||fe.length!==ve.length)throw new Error("Invalid operands in interpolate() call: "+v+", "+k);var Ee=Ie.length,ze=ve.length;if(Ee<ze)for(var Qe=$?$e:Ot,He=Ee;He<ze;He++)this.add(new Qe);else Ee>ze&&this[$?"removeSegments":"removeChildren"](ze,Ee);for(var He=0;He<ze;He++)Ie[He].interpolate(fe[He],ve[He],V);$&&(this.setClosed(v._closed),this._changed(9))},compare:function(v){var k=!1;if(v){var V=this._children||[this],$=v._children?v._children.slice():[v],te=V.length,fe=$.length,ve=[],Ie=0;k=!0;for(var Ee=W.findItemBoundsCollisions(V,$,ae.GEOMETRIC_EPSILON),ze=te-1;ze>=0&&k;ze--){var Qe=V[ze];k=!1;var He=Ee[ze];if(He)for(var Ze=He.length-1;Ze>=0&&!k;Ze--)Qe.compare($[He[Ze]])&&(ve[He[Ze]]||(ve[He[Ze]]=!0,Ie++),k=!0)}k=k&&Ie===fe}return k}}),Ot=Rt.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(k){this._closed=!1,this._segments=[],this._version=0;var V=arguments,$=Array.isArray(k)?typeof k[0]=="object"?k:V:k&&k.size===n&&(k.x!==n||k.point!==n)?V:null;$&&$.length>0?this.setSegments($):(this._curves=n,this._segmentSelection=0,!$&&typeof k=="string"&&(this.setPathData(k),k=null)),this._initialize(!$&&k)},_equals:function(v){return this._closed===v._closed&&b.equals(this._segments,v._segments)},copyContent:function(v){this.setSegments(v._segments),this._closed=v._closed},_changed:function v(k){if(v.base.call(this,k),k&8){if(this._length=this._area=n,k&32)this._version++;else if(this._curves)for(var V=0,$=this._curves.length;V<$;V++)this._curves[V]._changed()}else k&64&&(this._bounds=n)},getStyle:function(){var v=this._parent;return(v instanceof _i?v:this)._style},getSegments:function(){return this._segments},setSegments:function(v){var k=this.isFullySelected(),V=v&&v.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,V){var $=v[V-1];typeof $=="boolean"&&(this.setClosed($),V--),this._add($e.readList(v,0,{},V))}k&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var v=this._curves,k=this._segments;if(!v){var V=this._countCurves();v=this._curves=new Array(V);for(var $=0;$<V;$++)v[$]=new st(this,k[$],k[$+1]||k[0])}return v},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var v=this.getCurves();return v[v.length-1]},isClosed:function(){return this._closed},setClosed:function(v){if(this._closed!=(v=!!v)){if(this._closed=v,this._curves){var k=this._curves.length=this._countCurves();v&&(this._curves[k-1]=new st(this,this._segments[k-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(v,k){var V=this._segments,$=V.length,te=new he(k),fe=new Array(6),ve=!0,Ie,Ee,ze,Qe,He,Ze,Ve,ft,nt=[];function Me(ne,X){if(ne._transformCoordinates(v,fe),Ie=fe[0],Ee=fe[1],ve)nt.push("M"+te.pair(Ie,Ee)),ve=!1;else if(He=fe[2],Ze=fe[3],He===Ie&&Ze===Ee&&Ve===ze&&ft===Qe){if(!X){var ie=Ie-ze,de=Ee-Qe;nt.push(ie===0?"v"+te.number(de):de===0?"h"+te.number(ie):"l"+te.pair(ie,de))}}else nt.push("c"+te.pair(Ve-ze,ft-Qe)+" "+te.pair(He-ze,Ze-Qe)+" "+te.pair(Ie-ze,Ee-Qe));ze=Ie,Qe=Ee,Ve=fe[4],ft=fe[5]}if(!$)return"";for(var se=0;se<$;se++)Me(V[se]);return this._closed&&$>0&&(Me(V[0],!0),nt.push("z")),nt.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(v){for(var k=this._segments,V=new Array(6),$=0,te=k.length;$<te;$++)k[$]._transformCoordinates(v,V,!0);return!0},_add:function(v,ve){for(var V=this._segments,$=this._curves,te=v.length,fe=ve==null,ve=fe?V.length:ve,Ie=0;Ie<te;Ie++){var Ee=v[Ie];Ee._path&&(Ee=v[Ie]=Ee.clone()),Ee._path=this,Ee._index=ve+Ie,Ee._selection&&this._updateSelection(Ee,0,Ee._selection)}if(fe)b.push(V,v);else{V.splice.apply(V,[ve,0].concat(v));for(var Ie=ve+te,ze=V.length;Ie<ze;Ie++)V[Ie]._index=Ie}if($){var Qe=this._countCurves(),He=ve>0&&ve+te-1===Qe?ve-1:ve,Ze=He,Ve=Math.min(He+te,Qe);v._curves&&($.splice.apply($,[He,0].concat(v._curves)),Ze+=v._curves.length);for(var Ie=Ze;Ie<Ve;Ie++)$.splice(Ie,0,new st(this,null,null));this._adjustCurves(He,Ve)}return this._changed(41),v},_adjustCurves:function(v,k){for(var V=this._segments,$=this._curves,te,fe=v;fe<k;fe++)te=$[fe],te._path=this,te._segment1=V[fe],te._segment2=V[fe+1]||V[0],te._changed();(te=$[this._closed&&!v?V.length-1:v-1])&&(te._segment2=V[v]||V[0],te._changed()),(te=$[k])&&(te._segment1=V[k],te._changed())},_countCurves:function(){var v=this._segments.length;return!this._closed&&v>0?v-1:v},add:function(v){var k=arguments;return k.length>1&&typeof v!="number"?this._add($e.readList(k)):this._add([$e.read(k)])[0]},insert:function(v,k){var V=arguments;return V.length>2&&typeof k!="number"?this._add($e.readList(V,1),v):this._add([$e.read(V,1)],v)[0]},addSegment:function(){return this._add([$e.read(arguments)])[0]},insertSegment:function(v){return this._add([$e.read(arguments,1)],v)[0]},addSegments:function(v){return this._add($e.readList(v))},insertSegments:function(v,k){return this._add($e.readList(k),v)},removeSegment:function(v){return this.removeSegments(v,v+1)[0]||null},removeSegments:function(v,k,V){v=v||0,k=b.pick(k,this._segments.length);var $=this._segments,te=this._curves,fe=$.length,ve=$.splice(v,k-v),Ie=ve.length;if(!Ie)return ve;for(var Ee=0;Ee<Ie;Ee++){var ze=ve[Ee];ze._selection&&this._updateSelection(ze,ze._selection,0),ze._index=ze._path=null}for(var Ee=v,Qe=$.length;Ee<Qe;Ee++)$[Ee]._index=Ee;if(te){for(var He=v>0&&k===fe+(this._closed?1:0)?v-1:v,te=te.splice(He,Ie),Ee=te.length-1;Ee>=0;Ee--)te[Ee]._path=null;V&&(ve._curves=te.slice(1)),this._adjustCurves(He,He)}return this._changed(41),ve},clear:"#removeSegments",hasHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)if(v[k].hasHandles())return!0;return!1},clearHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)v[k].clearHandles()},getLength:function(){if(this._length==null){for(var v=this.getCurves(),k=0,V=0,$=v.length;V<$;V++)k+=v[V].getLength();this._length=k}return this._length},getArea:function(){var v=this._area;if(v==null){var k=this._segments,V=this._closed;v=0;for(var $=0,te=k.length;$<te;$++){var fe=$+1===te;v+=st.getArea(st.getValues(k[$],k[fe?0:$+1],null,fe&&!V))}this._area=v}return v},isFullySelected:function(){var v=this._segments.length;return this.isSelected()&&v>0&&this._segmentSelection===v*7},setFullySelected:function(v){v&&this._selectSegments(!0),this.setSelected(v)},setSelection:function v(k){k&1||this._selectSegments(!1),v.base.call(this,k)},_selectSegments:function(v){var k=this._segments,V=k.length,$=v?7:0;this._segmentSelection=$*V;for(var te=0;te<V;te++)k[te]._selection=$},_updateSelection:function(v,k,V){v._selection=V;var $=this._segmentSelection+=V-k;$>0&&this.setSelected(!0)},divideAt:function(v){var k=this.getLocationAt(v),V;return k&&(V=k.getCurve().divideAt(k.getCurveOffset()))?V._segment1:null},splitAt:function(v){var k=this.getLocationAt(v),V=k&&k.index,$=k&&k.time,te=1e-8,fe=1-te;$>fe&&(V++,$=0);var ve=this.getCurves();if(V>=0&&V<ve.length){$>=te&&ve[V++].divideAtTime($);var Ie=this.removeSegments(V,this._segments.length,!0),Ee;return this._closed?(this.setClosed(!1),Ee=this):(Ee=new Ot(Ge.NO_INSERT),Ee.insertAbove(this),Ee.copyAttributes(this)),Ee._add(Ie,0),this.addSegment(Ie[0]),Ee}return null},split:function(v,k){var V,$=k===n?v:(V=this.getCurves()[v])&&V.getLocationAtTime(k);return $!=null?this.splitAt($):null},join:function(v,k){var V=k||0;if(v&&v!==this){var $=v._segments,te=this.getLastSegment(),fe=v.getLastSegment();if(!fe)return this;te&&te._point.isClose(fe._point,V)&&v.reverse();var ve=v.getFirstSegment();if(te&&te._point.isClose(ve._point,V))te.setHandleOut(ve._handleOut),this._add($.slice(1));else{var Ie=this.getFirstSegment();Ie&&Ie._point.isClose(ve._point,V)&&v.reverse(),fe=v.getLastSegment(),Ie&&Ie._point.isClose(fe._point,V)?(Ie.setHandleIn(fe._handleIn),this._add($.slice(0,$.length-1),0)):this._add($.slice())}v._closed&&this._add([$[0]]),v.remove()}var Ee=this.getFirstSegment(),ze=this.getLastSegment();return Ee!==ze&&Ee._point.isClose(ze._point,V)&&(Ee.setHandleIn(ze._handleIn),ze.remove(),this.setClosed(!0)),this},reduce:function(v){for(var k=this.getCurves(),V=v&&v.simplify,$=V?1e-7:0,te=k.length-1;te>=0;te--){var fe=k[te];!fe.hasHandles()&&(!fe.hasLength($)||V&&fe.isCollinear(fe.getNext()))&&fe.remove()}return this},reverse:function(){this._segments.reverse();for(var v=0,k=this._segments.length;v<k;v++){var V=this._segments[v],$=V._handleIn;V._handleIn=V._handleOut,V._handleOut=$,V._index=v}this._curves=null,this._changed(9)},flatten:function(v){for(var k=new Si(this,v||.25,256,!0),V=k.parts,$=V.length,te=[],fe=0;fe<$;fe++)te.push(new $e(V[fe].curve.slice(0,2)));!this._closed&&$>0&&te.push(new $e(V[$-1].curve.slice(6))),this.setSegments(te)},simplify:function(v){var k=new Ti(this).fit(v||2.5);return k&&this.setSegments(k),!!k},smooth:function(v){var k=this,V=v||{},$=V.type||"asymmetric",te=this._segments,fe=te.length,ve=this._closed;function Ie(wi,$t){var vn=wi&&wi.index;if(vn!=null){var or=wi.path;if(or&&or!==k)throw new Error(wi._class+" "+vn+" of "+or+" is not part of "+k);$t&&wi instanceof st&&vn++}else vn=typeof wi=="number"?wi:$t;return Math.min(vn<0&&ve?vn%fe:vn<0?vn+fe:vn,fe-1)}var Ee=ve&&V.from===n&&V.to===n,ze=Ie(V.from,0),Qe=Ie(V.to,fe-1);if(ze>Qe)if(ve)ze-=fe;else{var He=ze;ze=Qe,Qe=He}if(/^(?:asymmetric|continuous)$/.test($)){var Ze=$==="asymmetric",Ve=Math.min,ft=Qe-ze+1,nt=ft-1,Me=Ee?Ve(ft,4):1,se=Me,ne=Me,X=[];if(ve||(se=Ve(1,ze),ne=Ve(1,fe-Qe-1)),nt+=se+ne,nt<=1)return;for(var ie=0,de=ze-se;ie<=nt;ie++,de++)X[ie]=te[(de<0?de+fe:de)%fe]._point;for(var ye=X[0]._x+2*X[1]._x,ge=X[0]._y+2*X[1]._y,Pe=2,Fe=nt-1,Ne=[ye],Xe=[ge],Ye=[Pe],De=[],Ue=[],ie=1;ie<nt;ie++){var ht=ie<Fe,kt=ht||Ze?1:2,o=ht?4:Ze?2:7,ke=ht?4:Ze?3:8,oi=ht?2:Ze?0:1,di=kt/Pe;Pe=Ye[ie]=o-di,ye=Ne[ie]=ke*X[ie]._x+oi*X[ie+1]._x-di*ye,ge=Xe[ie]=ke*X[ie]._y+oi*X[ie+1]._y-di*ge}De[Fe]=Ne[Fe]/Ye[Fe],Ue[Fe]=Xe[Fe]/Ye[Fe];for(var ie=nt-2;ie>=0;ie--)De[ie]=(Ne[ie]-De[ie+1])/Ye[ie],Ue[ie]=(Xe[ie]-Ue[ie+1])/Ye[ie];De[nt]=(3*X[nt]._x-De[Fe])/2,Ue[nt]=(3*X[nt]._y-Ue[Fe])/2;for(var ie=se,Ai=nt-ne,de=ze;ie<=Ai;ie++,de++){var Jt=te[de<0?de+fe:de],li=Jt._point,zi=De[ie]-li._x,vi=Ue[ie]-li._y;(Ee||ie<Ai)&&Jt.setHandleOut(zi,vi),(Ee||ie>se)&&Jt.setHandleIn(-zi,-vi)}}else for(var ie=ze;ie<=Qe;ie++)te[ie<0?ie+fe:ie].smooth(V,!Ee&&ie===ze,!Ee&&ie===Qe)},toShape:function(v){if(!this._closed)return null;var k=this._segments,V,$,te,fe;function ve(Ze,Ve){var ft=k[Ze],nt=ft.getNext(),Me=k[Ve],se=Me.getNext();return ft._handleOut.isZero()&&nt._handleIn.isZero()&&Me._handleOut.isZero()&&se._handleIn.isZero()&&nt._point.subtract(ft._point).isCollinear(se._point.subtract(Me._point))}function Ie(Ze){var Ve=k[Ze],ft=Ve.getPrevious(),nt=Ve.getNext();return ft._handleOut.isZero()&&Ve._handleIn.isZero()&&Ve._handleOut.isZero()&&nt._handleIn.isZero()&&Ve._point.subtract(ft._point).isOrthogonal(nt._point.subtract(Ve._point))}function Ee(Ze){var Ve=k[Ze],ft=Ve.getNext(),nt=Ve._handleOut,Me=ft._handleIn,se=.5522847498307936;if(nt.isOrthogonal(Me)){var ne=Ve._point,X=ft._point,ie=new Pt(ne,nt,!0).intersect(new Pt(X,Me,!0),!0);return ie&&ae.isZero(nt.getLength()/ie.subtract(ne).getLength()-se)&&ae.isZero(Me.getLength()/ie.subtract(X).getLength()-se)}return!1}function ze(Ze,Ve){return k[Ze]._point.getDistance(k[Ve]._point)}if(!this.hasHandles()&&k.length===4&&ve(0,2)&&ve(1,3)&&Ie(1)?(V=yt.Rectangle,$=new ot(ze(0,3),ze(0,1)),fe=k[1]._point.add(k[2]._point).divide(2)):k.length===8&&Ee(0)&&Ee(2)&&Ee(4)&&Ee(6)&&ve(1,5)&&ve(3,7)?(V=yt.Rectangle,$=new ot(ze(1,6),ze(0,3)),te=$.subtract(new ot(ze(0,7),ze(1,2))).divide(2),fe=k[3]._point.add(k[4]._point).divide(2)):k.length===4&&Ee(0)&&Ee(1)&&Ee(2)&&Ee(3)&&(ae.isZero(ze(0,2)-ze(1,3))?(V=yt.Circle,te=ze(0,2)/2):(V=yt.Ellipse,te=new ot(ze(2,0)/2,ze(3,1)/2)),fe=k[1]._point),V){var Qe=this.getPosition(!0),He=new V({center:Qe,size:$,radius:te,insert:!1});return He.copyAttributes(this,!0),He._matrix.prepend(this._matrix),He.rotate(fe.subtract(Qe).getAngle()+90),(v===n||v)&&He.insertAbove(this),He}return null},toPath:"#clone",compare:function v(k){if(!k||k instanceof _i)return v.base.call(this,k);var V=this.getCurves(),$=k.getCurves(),te=V.length,fe=$.length;if(!te||!fe)return te==fe;for(var ve=V[0].getValues(),Ie=[],Ee=0,ze,Qe=0,He,Ze=0;Ze<fe;Ze++){var Me=$[Ze].getValues();Ie.push(Me);var Ve=st.getOverlaps(ve,Me);if(Ve){ze=!Ze&&Ve[0][0]>0?fe-1:Ze,He=Ve[0][1];break}}for(var ft=Math.abs,nt=1e-8,Me=Ie[ze],se;ve&&Me;){var Ve=st.getOverlaps(ve,Me);if(Ve){var ne=Ve[0][0];if(ft(ne-Qe)<nt){Qe=Ve[1][0],Qe===1&&(ve=++Ee<te?V[Ee].getValues():null,Qe=0);var X=Ve[0][1];if(ft(X-He)<nt){if(se||(se=[ze,X]),He=Ve[1][1],He===1&&(++ze>=fe&&(ze=0),Me=Ie[ze]||$[ze].getValues(),He=0),!ve)return se[0]===ze&&se[1]===He;continue}}}break}return!1},_hitTestSelf:function(v,k,V,$){var te=this,fe=this.getStyle(),ve=this._segments,Ie=ve.length,Ee=this._closed,ze=k._tolerancePadding,Qe=ze,He,Ze,Ve,ft,nt,Me,se=k.stroke&&fe.hasStroke(),ne=k.fill&&fe.hasFill(),X=k.curves,ie=se?fe.getStrokeWidth()/2:ne&&k.tolerance>0||X?0:null;ie!==null&&(ie>0?(He=fe.getStrokeJoin(),Ze=fe.getStrokeCap(),Ve=fe.getMiterLimit(),Qe=Qe.add(Ot._getStrokePadding(ie,$))):He=Ze="round");function de(De,Ue){return v.subtract(De).divide(Ue).length<=1}function ye(De,Ue,ht){if(!k.selected||Ue.isSelected()){var kt=De._point;if(Ue!==kt&&(Ue=Ue.add(kt)),de(Ue,Qe))return new dt(ht,te,{segment:De,point:Ue})}}function ge(De,Ue){return(Ue||k.segments)&&ye(De,De._point,"segment")||!Ue&&k.handles&&(ye(De,De._handleIn,"handle-in")||ye(De,De._handleOut,"handle-out"))}function Pe(De){ft.add(De)}function Fe(De){var Ue=Ee||De._index>0&&De._index<Ie-1;if((Ue?He:Ze)==="round")return de(De._point,Qe);if(ft=new Ot({internal:!0,closed:!0}),Ue?De.isSmooth()||Ot._addBevelJoin(De,He,ie,Ve,null,$,Pe,!0):Ze==="square"&&Ot._addSquareCap(De,Ze,ie,null,$,Pe,!0),!ft.isEmpty()){var ht;return ft.contains(v)||(ht=ft.getNearestLocation(v))&&de(ht.getPoint(),ze)}}if(k.ends&&!k.segments&&!Ee){if(Me=ge(ve[0],!0)||ge(ve[Ie-1],!0))return Me}else if(k.segments||k.handles){for(var Ne=0;Ne<Ie;Ne++)if(Me=ge(ve[Ne]))return Me}if(ie!==null){if(nt=this.getNearestLocation(v),nt){var Xe=nt.getTime();Xe===0||Xe===1&&Ie>1?Fe(nt.getSegment())||(nt=null):de(nt.getPoint(),Qe)||(nt=null)}if(!nt&&He==="miter"&&Ie>1)for(var Ne=0;Ne<Ie;Ne++){var Ye=ve[Ne];if(v.getDistance(Ye._point)<=Ve*ie&&Fe(Ye)){nt=Ye.getLocation();break}}}return!nt&&ne&&this._contains(v)||nt&&!se&&!X?new dt("fill",this):nt?new dt(se?"stroke":"curve",this,{location:nt,point:nt.getPoint()}):null}},b.each(st._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this.getLocationAt(k);return V&&V[v]()}},{beans:!1,getLocationOf:function(){for(var v=be.read(arguments),k=this.getCurves(),V=0,$=k.length;V<$;V++){var te=k[V].getLocationOf(v);if(te)return te}return null},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getLocationAt:function(v){if(typeof v=="number"){for(var k=this.getCurves(),V=0,$=0,te=k.length;$<te;$++){var fe=V,ve=k[$];if(V+=ve.getLength(),V>v)return ve.getLocationAt(v-fe)}if(k.length>0&&v<=this.getLength())return new Nt(k[k.length-1],1)}else if(v&&v.getPath&&v.getPath()===this)return v;return null},getOffsetsWithTangent:function(){var v=be.read(arguments);if(v.isZero())return[];for(var k=[],V=0,$=this.getCurves(),te=0,fe=$.length;te<fe;te++){for(var ve=$[te],Ie=ve.getTimesWithTangent(v),Ee=0,ze=Ie.length;Ee<ze;Ee++){var Qe=V+ve.getOffsetAtTime(Ie[Ee]);k.indexOf(Qe)<0&&k.push(Qe)}V+=ve.length}return k}}),new function(){function v(V,$,te,fe){if(fe<=0)return;var ve=fe/2,Ie=fe-2,Ee=ve-1,ze=new Array(6),Qe,He;function Ze(ne){var X=ze[ne],ie=ze[ne+1];(Qe!=X||He!=ie)&&(V.beginPath(),V.moveTo(Qe,He),V.lineTo(X,ie),V.stroke(),V.beginPath(),V.arc(X,ie,ve,0,Math.PI*2,!0),V.fill())}for(var Ve=0,ft=$.length;Ve<ft;Ve++){var nt=$[Ve],Me=nt._selection;if(nt._transformCoordinates(te,ze),Qe=ze[0],He=ze[1],Me&2&&Ze(2),Me&4&&Ze(4),V.fillRect(Qe-ve,He-ve,fe,fe),Ie>0&&!(Me&1)){var se=V.fillStyle;V.fillStyle="#ffffff",V.fillRect(Qe-Ee,He-Ee,Ie,Ie),V.fillStyle=se}}}function k(V,$,te){var fe=$._segments,ve=fe.length,Ie=new Array(6),Ee=!0,ze,Qe,He,Ze,Ve,ft,nt,Me;function se(X){if(te)X._transformCoordinates(te,Ie),ze=Ie[0],Qe=Ie[1];else{var ie=X._point;ze=ie._x,Qe=ie._y}if(Ee)V.moveTo(ze,Qe),Ee=!1;else{if(te)Ve=Ie[2],ft=Ie[3];else{var de=X._handleIn;Ve=ze+de._x,ft=Qe+de._y}Ve===ze&&ft===Qe&&nt===He&&Me===Ze?V.lineTo(ze,Qe):V.bezierCurveTo(nt,Me,Ve,ft,ze,Qe)}if(He=ze,Ze=Qe,te)nt=Ie[4],Me=Ie[5];else{var de=X._handleOut;nt=He+de._x,Me=Ze+de._y}}for(var ne=0;ne<ve;ne++)se(fe[ne]);$._closed&&ve>0&&se(fe[0])}return{_draw:function(V,$,te,fe){var ve=$.dontStart,Ie=$.dontFinish||$.clip,Ee=this.getStyle(),ze=Ee.hasFill(),Qe=Ee.hasStroke(),He=Ee.getDashArray(),Ze=!In.support.nativeDash&&Qe&&He&&He.length;ve||V.beginPath(),(ze||Qe&&!Ze||Ie)&&(k(V,this,fe),this._closed&&V.closePath());function Ve(X){return He[(X%Ze+Ze)%Ze]}if(!Ie&&(ze||Qe)&&(this._setStyles(V,$,te),ze&&(V.fill(Ee.getFillRule()),V.shadowColor="rgba(0,0,0,0)"),Qe)){if(Ze){ve||V.beginPath();for(var ft=new Si(this,.25,32,!1,fe),nt=ft.length,Me=-Ee.getDashOffset(),se,ne=0;Me>0;)Me-=Ve(ne--)+Ve(ne--);for(;Me<nt;)se=Me+Ve(ne++),(Me>0||se>0)&&ft.drawPart(V,Math.max(Me,0),Math.max(se,0)),Me=se+Ve(ne++)}V.stroke()}},_drawSelected:function(V,$){V.beginPath(),k(V,this,$),V.stroke(),v(V,this._segments,$,In.settings.handleSize)}}},new function(){function v(k){var V=k._segments;if(!V.length)throw new Error("Use a moveTo() command first");return V[V.length-1]}return{moveTo:function(){var k=this._segments;k.length===1&&this.removeSegment(0),k.length||this._add([new $e(be.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new $e(be.read(arguments))])},cubicCurveTo:function(){var k=arguments,V=be.read(k),$=be.read(k),te=be.read(k),fe=v(this);fe.setHandleOut(V.subtract(fe._point)),this._add([new $e(te,$.subtract(te))])},quadraticCurveTo:function(){var k=arguments,V=be.read(k),$=be.read(k),te=v(this)._point;this.cubicCurveTo(V.add(te.subtract(V).multiply(1/3)),V.add($.subtract(V).multiply(1/3)),$)},curveTo:function(){var k=arguments,V=be.read(k),$=be.read(k),te=b.pick(b.read(k),.5),fe=1-te,ve=v(this)._point,Ie=V.subtract(ve.multiply(fe*fe)).subtract($.multiply(te*te)).divide(2*te*fe);if(Ie.isNaN())throw new Error("Cannot put a curve through points with parameter = "+te);this.quadraticCurveTo(Ie,$)},arcTo:function(){var k=arguments,V=Math.abs,$=Math.sqrt,te=v(this),fe=te._point,ve=be.read(k),Ie,Ee=b.peek(k),ze=b.pick(Ee,!0),Qe,He,Ze,Ve;if(typeof ze=="boolean")var ft=fe.add(ve).divide(2),Ie=ft.add(ft.subtract(fe).rotate(ze?-90:90));else if(b.remain(k)<=2)Ie=ve,ve=be.read(k);else if(!fe.equals(ve)){var nt=ot.read(k),Me=ae.isZero;if(Me(nt.width)||Me(nt.height))return this.lineTo(ve);var se=b.read(k),ze=!!b.read(k),ne=!!b.read(k),ft=fe.add(ve).divide(2),X=fe.subtract(ft).rotate(-se),ie=X.x,de=X.y,ye=V(nt.width),ge=V(nt.height),Pe=ye*ye,Fe=ge*ge,Ne=ie*ie,Xe=de*de,Ye=$(Ne/Pe+Xe/Fe);if(Ye>1&&(ye*=Ye,ge*=Ye,Pe=ye*ye,Fe=ge*ge),Ye=(Pe*Fe-Pe*Xe-Fe*Ne)/(Pe*Xe+Fe*Ne),V(Ye)<1e-12&&(Ye=0),Ye<0)throw new Error("Cannot create an arc with the given arguments");Qe=new be(ye*de/ge,-ge*ie/ye).multiply((ne===ze?-1:1)*$(Ye)).rotate(se).add(ft),Ve=new Tt().translate(Qe).rotate(se).scale(ye,ge),Ze=Ve._inverseTransform(fe),He=Ze.getDirectedAngle(Ve._inverseTransform(ve)),!ze&&He>0?He-=360:ze&&He<0&&(He+=360)}if(Ie){var De=new Pt(fe.add(Ie).divide(2),Ie.subtract(fe).rotate(90),!0),Ue=new Pt(Ie.add(ve).divide(2),ve.subtract(Ie).rotate(90),!0),ht=new Pt(fe,ve),kt=ht.getSide(Ie);if(Qe=De.intersect(Ue,!0),!Qe){if(!kt)return this.lineTo(ve);throw new Error("Cannot create an arc with the given arguments")}Ze=fe.subtract(Qe),He=Ze.getDirectedAngle(ve.subtract(Qe));var o=ht.getSide(Qe,!0);o===0?He=kt*V(He):kt===o&&(He+=He<0?360:-360)}if(He){for(var ke=1e-5,oi=V(He),di=oi>=360?4:Math.ceil((oi-ke)/90),Ai=He/di,Jt=Ai*Math.PI/360,li=4/3*Math.sin(Jt)/(1+Math.cos(Jt)),zi=[],vi=0;vi<=di;vi++){var X=ve,wi=null;if(vi<di&&(wi=Ze.rotate(90).multiply(li),Ve?(X=Ve._transformPoint(Ze),wi=Ve._transformPoint(Ze.add(wi)).subtract(X)):X=Qe.add(Ze)),!vi)te.setHandleOut(wi);else{var $t=Ze.rotate(-90).multiply(li);Ve&&($t=Ve._transformPoint(Ze.add($t)).subtract(X)),zi.push(new $e(X,$t,wi))}Ze=Ze.rotate(Ai)}this._add(zi)}},lineBy:function(){var k=be.read(arguments),V=v(this)._point;this.lineTo(V.add(k))},curveBy:function(){var k=arguments,V=be.read(k),$=be.read(k),te=b.read(k),fe=v(this)._point;this.curveTo(fe.add(V),fe.add($),te)},cubicCurveBy:function(){var k=arguments,V=be.read(k),$=be.read(k),te=be.read(k),fe=v(this)._point;this.cubicCurveTo(fe.add(V),fe.add($),fe.add(te))},quadraticCurveBy:function(){var k=arguments,V=be.read(k),$=be.read(k),te=v(this)._point;this.quadraticCurveTo(te.add(V),te.add($))},arcBy:function(){var k=arguments,V=v(this)._point,$=V.add(be.read(k)),te=b.pick(b.peek(k),!0);typeof te=="boolean"?this.arcTo($,te):this.arcTo($,V.add(be.read(k)))},closePath:function(k){this.setClosed(!0),this.join(this,k)}}},{_getBounds:function(v,k){var V=k.handle?"getHandleBounds":k.stroke?"getStrokeBounds":"getBounds";return Ot[V](this._segments,this._closed,this,v,k)},statics:{getBounds:function(v,k,V,$,te,fe){var ve=v[0];if(!ve)return new lt;var Ie=new Array(6),Ee=ve._transformCoordinates($,new Array(6)),ze=Ee.slice(0,2),Qe=ze.slice(),He=new Array(2);function Ze(nt){nt._transformCoordinates($,Ie);for(var Me=0;Me<2;Me++)st._addBounds(Ee[Me],Ee[Me+4],Ie[Me+2],Ie[Me],Me,fe?fe[Me]:0,ze,Qe,He);var se=Ee;Ee=Ie,Ie=se}for(var Ve=1,ft=v.length;Ve<ft;Ve++)Ze(v[Ve]);return k&&Ze(ve),new lt(ze[0],ze[1],Qe[0]-ze[0],Qe[1]-ze[1])},getStrokeBounds:function(v,k,V,$,te){var fe=V.getStyle(),ve=fe.hasStroke(),Ie=fe.getStrokeWidth(),Ee=ve&&V._getStrokeMatrix($,te),ze=ve&&Ot._getStrokePadding(Ie,Ee),Qe=Ot.getBounds(v,k,V,$,te,ze);if(!ve)return Qe;var He=Ie/2,Ze=fe.getStrokeJoin(),Ve=fe.getStrokeCap(),ft=fe.getMiterLimit(),nt=new lt(new ot(ze));function Me(ye){Qe=Qe.include(ye)}function se(ye){Qe=Qe.unite(nt.setCenter(ye._point.transform($)))}function ne(ye,ge){ge==="round"||ye.isSmooth()?se(ye):Ot._addBevelJoin(ye,ge,He,ft,$,Ee,Me)}function X(ye,ge){ge==="round"?se(ye):Ot._addSquareCap(ye,ge,He,$,Ee,Me)}var ie=v.length-(k?0:1);if(ie>0){for(var de=1;de<ie;de++)ne(v[de],Ze);k?ne(v[0],Ze):(X(v[0],Ve),X(v[v.length-1],Ve))}return Qe},_getStrokePadding:function(v,k){if(!k)return[v,v];var V=new be(v,0).transform(k),$=new be(0,v).transform(k),te=V.getAngleInRadians(),fe=V.getLength(),ve=$.getLength(),Ie=Math.sin(te),Ee=Math.cos(te),ze=Math.tan(te),Qe=Math.atan2(ve*ze,fe),He=Math.atan2(ve,ze*fe);return[Math.abs(fe*Math.cos(Qe)*Ee+ve*Math.sin(Qe)*Ie),Math.abs(ve*Math.sin(He)*Ee+fe*Math.cos(He)*Ie)]},_addBevelJoin:function(v,k,V,$,te,fe,ve,Ie){var Ee=v.getCurve(),ze=Ee.getPrevious(),Qe=Ee.getPoint1().transform(te),He=ze.getNormalAtTime(1).multiply(V).transform(fe),Ze=Ee.getNormalAtTime(0).multiply(V).transform(fe),Ve=He.getDirectedAngle(Ze);if((Ve<0||Ve>=180)&&(He=He.negate(),Ze=Ze.negate()),Ie&&ve(Qe),ve(Qe.add(He)),k==="miter"){var ft=new Pt(Qe.add(He),new be(-He.y,He.x),!0).intersect(new Pt(Qe.add(Ze),new be(-Ze.y,Ze.x),!0),!0);ft&&Qe.getDistance(ft)<=$*V&&ve(ft)}ve(Qe.add(Ze))},_addSquareCap:function(v,k,V,$,te,fe,ve){var Ie=v._point.transform($),Ee=v.getLocation(),ze=Ee.getNormal().multiply(Ee.getTime()===0?V:-V).transform(te);k==="square"&&(ve&&(fe(Ie.subtract(ze)),fe(Ie.add(ze))),Ie=Ie.add(ze.rotate(-90))),fe(Ie.add(ze)),fe(Ie.subtract(ze))},getHandleBounds:function(v,k,V,$,te){var fe=V.getStyle(),ve=te.stroke&&fe.hasStroke(),Ie,Ee;if(ve){var ze=V._getStrokeMatrix($,te),Qe=fe.getStrokeWidth()/2,He=Qe;fe.getStrokeJoin()==="miter"&&(He=Qe*fe.getMiterLimit()),fe.getStrokeCap()==="square"&&(He=Math.max(He,Qe*Math.SQRT2)),Ie=Ot._getStrokePadding(Qe,ze),Ee=Ot._getStrokePadding(He,ze)}for(var Ze=new Array(6),Ve=1/0,ft=-Ve,nt=Ve,Me=ft,se=0,ne=v.length;se<ne;se++){var X=v[se];X._transformCoordinates($,Ze);for(var ie=0;ie<6;ie+=2){var de=ie?Ie:Ee,ye=de?de[0]:0,ge=de?de[1]:0,Pe=Ze[ie],Fe=Ze[ie+1],Ne=Pe-ye,Xe=Pe+ye,Ye=Fe-ge,De=Fe+ge;Ne<Ve&&(Ve=Ne),Xe>ft&&(ft=Xe),Ye<nt&&(nt=Ye),De>Me&&(Me=De)}}return new lt(Ve,nt,ft-Ve,Me-nt)}}});Ot.inject({statics:new function(){var v=.5522847498307936,k=[new $e([-1,0],[0,v],[0,-v]),new $e([0,-1],[-v,0],[v,0]),new $e([1,0],[0,-v],[0,v]),new $e([0,1],[v,0],[-v,0])];function V(te,fe,ve){var Ie=b.getNamed(ve),Ee=new Ot(Ie&&(Ie.insert==!0?Ge.INSERT:Ie.insert==!1?Ge.NO_INSERT:null));return Ee._add(te),Ee._closed=fe,Ee.set(Ie,Ge.INSERT)}function $(te,fe,ve){for(var Ie=new Array(4),Ee=0;Ee<4;Ee++){var ze=k[Ee];Ie[Ee]=new $e(ze._point.multiply(fe).add(te),ze._handleIn.multiply(fe),ze._handleOut.multiply(fe))}return V(Ie,!0,ve)}return{Line:function(){var te=arguments;return V([new $e(be.readNamed(te,"from")),new $e(be.readNamed(te,"to"))],!1,te)},Circle:function(){var te=arguments,fe=be.readNamed(te,"center"),ve=b.readNamed(te,"radius");return $(fe,new ot(ve),te)},Rectangle:function(){var te=arguments,fe=lt.readNamed(te,"rectangle"),ve=ot.readNamed(te,"radius",0,{readNull:!0}),Ie=fe.getBottomLeft(!0),Ee=fe.getTopLeft(!0),ze=fe.getTopRight(!0),Qe=fe.getBottomRight(!0),He;if(!ve||ve.isZero())He=[new $e(Ie),new $e(Ee),new $e(ze),new $e(Qe)];else{ve=ot.min(ve,fe.getSize(!0).divide(2));var Ze=ve.width,Ve=ve.height,ft=Ze*v,nt=Ve*v;He=[new $e(Ie.add(Ze,0),null,[-ft,0]),new $e(Ie.subtract(0,Ve),[0,nt]),new $e(Ee.add(0,Ve),null,[0,-nt]),new $e(Ee.add(Ze,0),[-ft,0],null),new $e(ze.subtract(Ze,0),null,[ft,0]),new $e(ze.add(0,Ve),[0,-nt],null),new $e(Qe.subtract(0,Ve),null,[0,nt]),new $e(Qe.subtract(Ze,0),[ft,0])]}return V(He,!0,te)},RoundRectangle:"#Rectangle",Ellipse:function(){var te=arguments,fe=yt._readEllipse(te);return $(fe.center,fe.radius,te)},Oval:"#Ellipse",Arc:function(){var te=arguments,fe=be.readNamed(te,"from"),ve=be.readNamed(te,"through"),Ie=be.readNamed(te,"to"),Ee=b.getNamed(te),ze=new Ot(Ee&&Ee.insert==!1&&Ge.NO_INSERT);return ze.moveTo(fe),ze.arcTo(ve,Ie),ze.set(Ee)},RegularPolygon:function(){for(var te=arguments,fe=be.readNamed(te,"center"),ve=b.readNamed(te,"sides"),Ie=b.readNamed(te,"radius"),Ee=360/ve,ze=ve%3===0,Qe=new be(0,ze?-Ie:Ie),He=ze?-1:.5,Ze=new Array(ve),Ve=0;Ve<ve;Ve++)Ze[Ve]=new $e(fe.add(Qe.rotate((Ve+He)*Ee)));return V(Ze,!0,te)},Star:function(){for(var te=arguments,fe=be.readNamed(te,"center"),ve=b.readNamed(te,"points")*2,Ie=b.readNamed(te,"radius1"),Ee=b.readNamed(te,"radius2"),ze=360/ve,Qe=new be(0,-1),He=new Array(ve),Ze=0;Ze<ve;Ze++)He[Ze]=new $e(fe.add(Qe.rotate(ze*Ze).multiply(Ze%2?Ee:Ie)));return V(He,!0,te)}}}});var _i=Rt.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||(typeof k=="string"?this.setPathData(k):this.addChildren(Array.isArray(k)?k:arguments))},insertChildren:function v(k,V){var $=V,te=$[0];te&&typeof te[0]=="number"&&($=[$]);for(var fe=V.length-1;fe>=0;fe--){var ve=$[fe];$===V&&!(ve instanceof Ot)&&($=b.slice($)),Array.isArray(ve)?$[fe]=new Ot({segments:ve,insert:!1}):ve instanceof _i&&($.splice.apply($,[fe,1].concat(ve.removeChildren())),ve.remove())}return v.base.call(this,k,$)},reduce:function v(k){for(var V=this._children,$=V.length-1;$>=0;$--){var te=V[$].reduce(k);te.isEmpty()&&te.remove()}if(!V.length){var te=new Ot(Ge.NO_INSERT);return te.copyAttributes(this),te.insertAbove(this),this.remove(),te}return v.base.call(this)},isClosed:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)if(!v[k]._closed)return!1;return!0},setClosed:function(v){for(var k=this._children,V=0,$=k.length;V<$;V++)k[V].setClosed(v)},getFirstSegment:function(){var v=this.getFirstChild();return v&&v.getFirstSegment()},getLastSegment:function(){var v=this.getLastChild();return v&&v.getLastSegment()},getCurves:function(){for(var v=this._children,k=[],V=0,$=v.length;V<$;V++)b.push(k,v[V].getCurves());return k},getFirstCurve:function(){var v=this.getFirstChild();return v&&v.getFirstCurve()},getLastCurve:function(){var v=this.getLastChild();return v&&v.getLastCurve()},getArea:function(){for(var v=this._children,k=0,V=0,$=v.length;V<$;V++)k+=v[V].getArea();return k},getLength:function(){for(var v=this._children,k=0,V=0,$=v.length;V<$;V++)k+=v[V].getLength();return k},getPathData:function(v,k){for(var V=this._children,$=[],te=0,fe=V.length;te<fe;te++){var ve=V[te],Ie=ve._matrix;$.push(ve.getPathData(v&&!Ie.isIdentity()?v.appended(Ie):v,k))}return $.join("")},_hitTestChildren:function v(k,V,$){return v.base.call(this,k,V.class===Ot||V.type==="path"?V:b.set({},V,{fill:!1}),$)},_draw:function(v,k,V,$){var te=this._children;if(te.length){k=k.extend({dontStart:!0,dontFinish:!0}),v.beginPath();for(var fe=0,ve=te.length;fe<ve;fe++)te[fe].draw(v,k,$);if(!k.clip){this._setStyles(v,k,V);var Ie=this._style;Ie.hasFill()&&(v.fill(Ie.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),Ie.hasStroke()&&v.stroke()}}},_drawSelected:function(v,k,V){for(var $=this._children,te=0,fe=$.length;te<fe;te++){var ve=$[te],Ie=ve._matrix;V[ve._id]||ve._drawSelected(v,Ie.isIdentity()?k:k.appended(Ie))}}},new function(){function v(k,V){var $=k._children;if(V&&!$.length)throw new Error("Use a moveTo() command first");return $[$.length-1]}return b.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(k){this[k]=function(){var V=v(this,!0);V[k].apply(V,arguments)}},{moveTo:function(){var k=v(this),V=k&&k.isEmpty()?k:new Ot(Ge.NO_INSERT);V!==k&&this.addChild(V),V.moveTo.apply(V,arguments)},moveBy:function(){var k=v(this,!0),V=k&&k.getLastSegment(),$=be.read(arguments);this.moveTo(V?$.add(V._point):$)},closePath:function(k){v(this,!0).closePath(k)}})},b.each(["reverse","flatten","simplify","smooth"],function(v){this[v]=function(k){for(var V=this._children,$,te=0,fe=V.length;te<fe;te++)$=V[te][v](k)||$;return $}},{}));Rt.inject(new function(){var v=Math.min,k=Math.max,V=Math.abs,$={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function te(se){return se._children||[se]}function fe(se,ne){var X=se.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(ne){for(var ie=te(X),de=0,ye=ie.length;de<ye;de++){var se=ie[de];!se._closed&&!se.isEmpty()&&(se.closePath(1e-12),se.getFirstSegment().setHandleIn(0,0),se.getLastSegment().setHandleOut(0,0))}X=X.resolveCrossings().reorient(X.getFillRule()==="nonzero",!0)}return X}function ve(se,ne,X,ie,de){var ye=new _i(Ge.NO_INSERT);return ye.addChildren(se,!0),ye=ye.reduce({simplify:ne}),de&&de.insert==!1||ye.insertAbove(ie&&X.isSibling(ie)&&X.getIndex()<ie.getIndex()?ie:X),ye.copyAttributes(X,!0),ye}function Ie(se){return se.hasOverlap()||se.isCrossing()}function Ee(se,ne,X,ie){if(ie&&(ie.trace==!1||ie.stroke)&&/^(subtract|intersect)$/.test(X))return ze(se,ne,X);var de=fe(se,!0),ye=ne&&se!==ne&&fe(ne,!0),ge=$[X];ge[X]=!0,ye&&(ge.subtract||ge.exclude)^(ye.isClockwise()^de.isClockwise())&&ye.reverse();var Pe=Ve(Nt.expand(de.getIntersections(ye,Ie))),Fe=te(de),Ne=ye&&te(ye),Xe=[],Ye=[],De;function Ue(wi){for(var $t=0,vn=wi.length;$t<vn;$t++){var or=wi[$t];b.push(Xe,or._segments),b.push(Ye,or.getCurves()),or._overlapsOnly=!0}}function ht(wi){for(var $t=[],vn=0,or=wi&&wi.length;vn<or;vn++)$t.push(Ye[wi[vn]]);return $t}if(Pe.length){Ue(Fe),Ne&&Ue(Ne);for(var kt=new Array(Ye.length),o=0,ke=Ye.length;o<ke;o++)kt[o]=Ye[o].getValues();for(var oi=W.findCurveBoundsCollisions(kt,kt,0,!0),di={},o=0;o<Ye.length;o++){var Ai=Ye[o],Jt=Ai._path._id,li=di[Jt]=di[Jt]||{};li[Ai.getIndex()]={hor:ht(oi[o].hor),ver:ht(oi[o].ver)}}for(var o=0,ke=Pe.length;o<ke;o++)nt(Pe[o]._segment,de,ye,di,ge);for(var o=0,ke=Xe.length;o<ke;o++){var zi=Xe[o],vi=zi._intersection;zi._winding||nt(zi,de,ye,di,ge),vi&&vi._overlap||(zi._path._overlapsOnly=!1)}De=Me(Xe,ge)}else De=Ze(Ne?Fe.concat(Ne):Fe.slice(),function(wi){return!!ge[wi]});return ve(De,!0,se,ne,ie)}function ze(se,ne,X){var ie=fe(se),de=fe(ne),ye=ie.getIntersections(de,Ie),ge=X==="subtract",Pe=X==="divide",Fe={},Ne=[];function Xe(Ue){if(!Fe[Ue._id]&&(Pe||de.contains(Ue.getPointAt(Ue.getLength()/2))^ge))return Ne.unshift(Ue),Fe[Ue._id]=!0}for(var Ye=ye.length-1;Ye>=0;Ye--){var De=ye[Ye].split();De&&(Xe(De)&&De.getFirstSegment().setHandleIn(0,0),ie.getLastSegment().setHandleOut(0,0))}return Xe(ie),ve(Ne,!1,se,ne)}function Qe(se,ne){for(var X=se;X;){if(X===ne)return;X=X._previous}for(;se._next&&se._next!==ne;)se=se._next;if(!se._next){for(;ne._previous;)ne=ne._previous;se._next=ne,ne._previous=se}}function He(se){for(var ne=se.length-1;ne>=0;ne--)se[ne].clearHandles()}function Ze(se,ne,X){var ie=se&&se.length;if(ie){var de=b.each(se,function(oi,di){this[oi._id]={container:null,winding:oi.isClockwise()?1:-1,index:di}},{}),ye=se.slice().sort(function(oi,di){return V(di.getArea())-V(oi.getArea())}),ge=ye[0],Pe=W.findItemBoundsCollisions(ye,null,ae.GEOMETRIC_EPSILON);X==null&&(X=ge.isClockwise());for(var Fe=0;Fe<ie;Fe++){var Ne=ye[Fe],Xe=de[Ne._id],Ye=0,De=Pe[Fe];if(De){for(var Ue=null,ht=De.length-1;ht>=0;ht--)if(De[ht]<Fe){Ue=Ue||Ne.getInteriorPoint();var kt=ye[De[ht]];if(kt.contains(Ue)){var o=de[kt._id];Ye=o.winding,Xe.winding+=Ye,Xe.container=o.exclude?o.container:kt;break}}}if(ne(Xe.winding)===ne(Ye))Xe.exclude=!0,se[Xe.index]=null;else{var ke=Xe.container;Ne.setClockwise(ke?!ke.isClockwise():X)}}}return se}function Ve(se,ne,X){var ie=ne&&[],de=1e-8,ye=1-de,ge=!1,Pe=X||[],Fe=X&&{},Ne,Xe,Ye;function De($t){return $t._path._id+"."+$t._segment1._index}for(var Ue=(X&&X.length)-1;Ue>=0;Ue--){var ht=X[Ue];ht._path&&(Fe[De(ht)]=!0)}for(var Ue=se.length-1;Ue>=0;Ue--){var kt=se[Ue],o=kt._time,ke=o,oi=ne&&!ne(kt),ht=kt._curve,di;if(ht&&(ht!==Xe?(ge=!ht.hasHandles()||Fe&&Fe[De(ht)],Ne=[],Ye=null,Xe=ht):Ye>=de&&(o/=Ye)),oi){Ne&&Ne.push(kt);continue}else ne&&ie.unshift(kt);if(Ye=ke,o<de)di=ht._segment1;else if(o>ye)di=ht._segment2;else{var Ai=ht.divideAtTime(o,!0);ge&&Pe.push(ht,Ai),di=Ai._segment1;for(var Jt=Ne.length-1;Jt>=0;Jt--){var li=Ne[Jt];li._time=(li._time-o)/(1-o)}}kt._setSegment(di);var zi=di._intersection,vi=kt._intersection;if(zi){Qe(zi,vi);for(var wi=zi;wi;)Qe(wi._intersection,zi),wi=wi._next}else di._intersection=vi}return X||He(Pe),ie||se}function ft(se,ne,X,ie,de){var ye=Array.isArray(ne)?ne:ne[X?"hor":"ver"],ge=X?1:0,Pe=ge^1,Fe=[se.x,se.y],Ne=Fe[ge],Xe=Fe[Pe],Ye=1e-9,De=1e-6,Ue=Ne-Ye,ht=Ne+Ye,kt=0,o=0,ke=0,oi=0,di=!1,Ai=!1,Jt=1,li=[],zi,vi;function wi(Qt){var Yi=Qt[Pe+0],Ut=Qt[Pe+6];if(!(Xe<v(Yi,Ut)||Xe>k(Yi,Ut))){var Tn=Qt[ge+0],cr=Qt[ge+2],Ns=Qt[ge+4],Ur=Qt[ge+6];if(Yi===Ut){(Tn<ht&&Ur>Ue||Ur<ht&&Tn>Ue)&&(di=!0);return}var Vt=Xe===Yi?0:Xe===Ut||Ue>k(Tn,cr,Ns,Ur)||ht<v(Tn,cr,Ns,Ur)?1:st.solveCubic(Qt,Pe,Xe,li,0,1)>0?li[0]:1,hr=Vt===0?Tn:Vt===1?Ur:st.getPoint(Qt,Vt)[X?"y":"x"],Lt=Yi>Ut?1:-1,Fr=zi[Pe]>zi[Pe+6]?1:-1,Vs=zi[ge+6];return Xe!==Yi?(hr<Ue?ke+=Lt:hr>ht?oi+=Lt:di=!0,hr>Ne-De&&hr<Ne+De&&(Jt/=2)):(Lt!==Fr?Tn<Ue?ke+=Lt:Tn>ht&&(oi+=Lt):Tn!=Vs&&(Vs<ht&&hr>ht?(oi+=Lt,di=!0):Vs>Ue&&hr<Ue&&(ke+=Lt,di=!0)),Jt/=4),zi=Qt,!de&&hr>Ue&&hr<ht&&st.getTangent(Qt,Vt)[X?"x":"y"]===0&&ft(se,ne,!X,ie,!0)}}function $t(Qt){var Yi=Qt[Pe+0],Ut=Qt[Pe+2],Tn=Qt[Pe+4],cr=Qt[Pe+6];if(Xe<=k(Yi,Ut,Tn,cr)&&Xe>=v(Yi,Ut,Tn,cr)){for(var Ns=Qt[ge+0],Ur=Qt[ge+2],Vt=Qt[ge+4],hr=Qt[ge+6],Lt=Ue>k(Ns,Ur,Vt,hr)||ht<v(Ns,Ur,Vt,hr)?[Qt]:st.getMonoCurves(Qt,X),Fr,Vs=0,ua=Lt.length;Vs<ua;Vs++)if(Fr=wi(Lt[Vs]))return Fr}}for(var vn=0,or=ye.length;vn<or;vn++){var mn=ye[vn],qn=mn._path,jr=mn.getValues(),Hi;if((!vn||ye[vn-1]._path!==qn)&&(zi=null,qn._closed||(vi=st.getValues(qn.getLastCurve().getSegment2(),mn.getSegment1(),null,!ie),vi[Pe]!==vi[Pe+6]&&(zi=vi)),!zi)){zi=jr;for(var ur=qn.getLastCurve();ur&&ur!==mn;){var On=ur.getValues();if(On[Pe]!==On[Pe+6]){zi=On;break}ur=ur.getPrevious()}}if(Hi=$t(jr))return Hi;if(vn+1===or||ye[vn+1]._path!==qn){if(vi&&(Hi=$t(vi)))return Hi;di&&!ke&&!oi&&(ke=oi=qn.isClockwise(ie)^X?1:-1),kt+=ke,o+=oi,ke=oi=0,di&&(Ai=!0,di=!1),vi=null}}return kt=V(kt),o=V(o),{winding:k(kt,o),windingL:kt,windingR:o,quality:Jt,onPath:Ai}}function nt(se,ne,X,ie,de){var ye=[],ge=se,Pe=0,Ye;do{var Fe=se.getCurve();if(Fe){var Ne=Fe.getLength();ye.push({segment:se,curve:Fe,length:Ne}),Pe+=Ne}se=se.getNext()}while(se&&!se._intersection&&se!==ge);for(var Xe=[.5,.25,.75],Ye={winding:0,quality:-1},De=.001,Ue=1-De,ht=0;ht<Xe.length&&Ye.quality<.5;ht++)for(var Ne=Pe*Xe[ht],kt=0,o=ye.length;kt<o;kt++){var ke=ye[kt],oi=ke.length;if(Ne<=oi){var Fe=ke.curve,di=Fe._path,Ai=di._parent,Jt=Ai instanceof _i?Ai:di,li=ae.clamp(Fe.getTimeAt(Ne),De,Ue),zi=Fe.getPointAtTime(li),vi=V(Fe.getTangentAtTime(li).y)<Math.SQRT1_2,wi=null;if(de.subtract&&X){var $t=Jt===ne?X:ne,vn=$t._getWinding(zi,vi,!0);if(Jt===ne&&vn.winding||Jt===X&&!vn.winding){if(vn.quality<1)continue;wi={winding:0,quality:1}}}wi=wi||ft(zi,ie[di._id][Fe.getIndex()],vi,!0),wi.quality>Ye.quality&&(Ye=wi);break}Ne-=oi}for(var kt=ye.length-1;kt>=0;kt--)ye[kt].segment._winding=Ye}function Me(se,ne){var X=[],ie;function de(or){var mn;return!!(or&&!or._visited&&(!ne||ne[(mn=or._winding||{}).winding]&&!(ne.unite&&mn.winding===2&&mn.windingL&&mn.windingR)))}function ye(or){if(or){for(var mn=0,qn=ie.length;mn<qn;mn++)if(or===ie[mn])return!0}return!1}function ge(or){for(var mn=or._segments,qn=0,jr=mn.length;qn<jr;qn++)mn[qn]._visited=!0}function Pe(or,mn){var qn=or._intersection,jr=qn,Hi=[];mn&&(ie=[or]);function ur(On,Qt){for(;On&&On!==Qt;){var Yi=On._segment,Ut=Yi&&Yi._path;if(Ut){var Tn=Yi.getNext()||Ut.getFirstSegment(),cr=Tn._intersection;Yi!==or&&(ye(Yi)||ye(Tn)||Tn&&de(Yi)&&(de(Tn)||cr&&de(cr._segment)))&&Hi.push(Yi),mn&&ie.push(Yi)}On=On._next}}if(qn){for(ur(qn);qn&&qn._previous;)qn=qn._previous;ur(qn,jr)}return Hi}se.sort(function(or,mn){var qn=or._intersection,jr=mn._intersection,Hi=!!(qn&&qn._overlap),ur=!!(jr&&jr._overlap),On=or._path,Qt=mn._path;return Hi^ur?Hi?1:-1:!qn^!jr?qn?1:-1:On!==Qt?On._id-Qt._id:or._index-mn._index});for(var Fe=0,Ne=se.length;Fe<Ne;Fe++){var Xe=se[Fe],Ye=de(Xe),De=null,Ue=!1,ht=!0,kt=[],o,ke,oi;if(Ye&&Xe._path._overlapsOnly){var di=Xe._path,Ai=Xe._intersection._segment._path;di.compare(Ai)&&(di.getArea()&&X.push(di.clone(!1)),ge(di),ge(Ai),Ye=!1)}for(;Ye;){var Jt=!De,li=Pe(Xe,Jt),zi=li.shift(),Ue=!Jt&&(ye(Xe)||ye(zi)),vi=!Ue&&zi;if(Jt&&(De=new Ot(Ge.NO_INSERT),o=null),Ue){(Xe.isFirst()||Xe.isLast())&&(ht=Xe._path._closed),Xe._visited=!0;break}if(vi&&o&&(kt.push(o),o=null),o||(vi&&li.push(Xe),o={start:De._segments.length,crossings:li,visited:ke=[],handleIn:oi}),vi&&(Xe=zi),!de(Xe)){De.removeSegments(o.start);for(var wi=0,$t=ke.length;wi<$t;wi++)ke[wi]._visited=!1;ke.length=0;do Xe=o&&o.crossings.shift(),(!Xe||!Xe._path)&&(Xe=null,o=kt.pop(),o&&(ke=o.visited,oi=o.handleIn));while(o&&!de(Xe));if(!Xe)break}var vn=Xe.getNext();De.add(new $e(Xe._point,oi,vn&&Xe._handleOut)),Xe._visited=!0,ke.push(Xe),Xe=vn||Xe._path.getFirstSegment(),oi=vn&&vn._handleIn}Ue&&(ht&&(De.getFirstSegment().setHandleIn(oi),De.setClosed(ht)),De.getArea()!==0&&X.push(De))}return X}return{_getWinding:function(se,ne,X){return ft(se,this.getCurves(),ne,X)},unite:function(se,ne){return Ee(this,se,"unite",ne)},intersect:function(se,ne){return Ee(this,se,"intersect",ne)},subtract:function(se,ne){return Ee(this,se,"subtract",ne)},exclude:function(se,ne){return Ee(this,se,"exclude",ne)},divide:function(se,ne){return ne&&(ne.trace==!1||ne.stroke)?ze(this,se,"divide"):ve([this.subtract(se,ne),this.intersect(se,ne)],!0,this,se,ne)},resolveCrossings:function(){var se=this._children,ne=se||[this];function X(o,ke){var oi=o&&o._intersection;return oi&&oi._overlap&&oi._path===ke}var ie=!1,de=!1,ye=this.getIntersections(null,function(o){return o.hasOverlap()&&(ie=!0)||o.isCrossing()&&(de=!0)}),ge=ie&&de&&[];if(ye=Nt.expand(ye),ie)for(var Pe=Ve(ye,function(o){return o.hasOverlap()},ge),Fe=Pe.length-1;Fe>=0;Fe--){var Ne=Pe[Fe],Xe=Ne._path,Ye=Ne._segment,De=Ye.getPrevious(),Ue=Ye.getNext();X(De,Xe)&&X(Ue,Xe)&&(Ye.remove(),De._handleOut._set(0,0),Ue._handleIn._set(0,0),De!==Ye&&!De.getCurve().hasLength()&&(Ue._handleIn.set(De._handleIn),De.remove()))}de&&(Ve(ye,ie&&function(o){var ke=o.getCurve(),oi=o.getSegment(),di=o._intersection,Ai=di._curve,Jt=di._segment;if(ke&&Ai&&ke._path&&Ai._path)return!0;oi&&(oi._intersection=null),Jt&&(Jt._intersection=null)},ge),ge&&He(ge),ne=Me(b.each(ne,function(o){b.push(this,o._segments)},[])));var ht=ne.length,kt;return ht>1&&se?(ne!==se&&this.setChildren(ne),kt=this):ht===1&&!se&&(ne[0]!==this&&this.setSegments(ne[0].removeSegments()),kt=this),kt||(kt=new _i(Ge.NO_INSERT),kt.addChildren(ne),kt=kt.reduce(),kt.copyAttributes(this),this.replaceWith(kt)),kt},reorient:function(se,ne){var X=this._children;return X&&X.length?this.setChildren(Ze(this.removeChildren(),function(ie){return!!(se?ie:ie&1)},ne)):ne!==n&&this.setClockwise(ne),this},getInteriorPoint:function(){var se=this.getBounds(),ne=se.getCenter(!0);if(!this.contains(ne)){for(var X=this.getCurves(),ie=ne.y,de=[],ye=[],ge=0,Pe=X.length;ge<Pe;ge++){var Fe=X[ge].getValues(),Ne=Fe[1],Xe=Fe[3],Ye=Fe[5],De=Fe[7];if(ie>=v(Ne,Xe,Ye,De)&&ie<=k(Ne,Xe,Ye,De))for(var Ue=st.getMonoCurves(Fe),ht=0,kt=Ue.length;ht<kt;ht++){var o=Ue[ht],ke=o[1],oi=o[7];if(ke!==oi&&(ie>=ke&&ie<=oi||ie>=oi&&ie<=ke)){var di=ie===ke?o[0]:ie===oi?o[6]:st.solveCubic(o,1,ie,ye,0,1)===1?st.getPoint(o,ye[0]).x:(o[0]+o[6])/2;de.push(di)}}}de.length>1&&(de.sort(function(Ai,Jt){return Ai-Jt}),ne.x=(de[0]+de[1])/2)}return ne}}});var Si=b.extend({_class:"PathFlattener",initialize:function(v,k,V,$,te){var fe=[],ve=[],Ie=0,Ee=1/(V||32),ze=v._segments,Qe=ze[0],He;function Ze(Me,se){var ne=st.getValues(Me,se,te);fe.push(ne),Ve(ne,Me._index,0,1)}function Ve(Me,se,ne,X){if(X-ne>Ee&&!($&&st.isStraight(Me))&&!st.isFlatEnough(Me,k||.25)){var ie=st.subdivide(Me,.5),de=(ne+X)/2;Ve(ie[0],se,ne,de),Ve(ie[1],se,de,X)}else{var ye=Me[6]-Me[0],ge=Me[7]-Me[1],Pe=Math.sqrt(ye*ye+ge*ge);Pe>0&&(Ie+=Pe,ve.push({offset:Ie,curve:Me,index:se,time:X}))}}for(var ft=1,nt=ze.length;ft<nt;ft++)He=ze[ft],Ze(Qe,He),Qe=He;v._closed&&Ze(He||Qe,ze[0]),this.curves=fe,this.parts=ve,this.length=Ie,this.index=0},_get:function(v){for(var k=this.parts,V=k.length,$,te=this.index;$=te,!(!te||k[--te].offset<v););for(;$<V;$++){var fe=k[$];if(fe.offset>=v){this.index=$;var ve=k[$-1],Ie=ve&&ve.index===fe.index?ve.time:0,Ee=ve?ve.offset:0;return{index:fe.index,time:Ie+(fe.time-Ie)*(v-Ee)/(fe.offset-Ee)}}}return{index:k[V-1].index,time:1}},drawPart:function(v,k,V){for(var $=this._get(k),te=this._get(V),fe=$.index,ve=te.index;fe<=ve;fe++){var Ie=st.getPart(this.curves[fe],fe===$.index?$.time:0,fe===te.index?te.time:1);fe===$.index&&v.moveTo(Ie[0],Ie[1]),v.bezierCurveTo.apply(v,Ie.slice(2))}}},b.each(st._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this._get(k);return st[v](this.curves[V.index],V.time)}},{})),Ti=b.extend({initialize:function(v){for(var k=this.points=[],V=v._segments,$=v._closed,te=0,fe,ve=V.length;te<ve;te++){var Ie=V[te].point;(!fe||!fe.equals(Ie))&&k.push(fe=Ie.clone())}$&&(k.unshift(k[k.length-1]),k.push(k[1])),this.closed=$},fit:function(v){var k=this.points,V=k.length,$=null;return V>0&&($=[new $e(k[0])],V>1&&(this.fitCubic($,v,0,V-1,k[1].subtract(k[0]),k[V-2].subtract(k[V-1])),this.closed&&($.shift(),$.pop()))),$},fitCubic:function(v,k,V,$,te,fe){var ve=this.points;if($-V===1){var Ie=ve[V],Ee=ve[$],ze=Ie.getDistance(Ee)/3;this.addCurve(v,[Ie,Ie.add(te.normalize(ze)),Ee.add(fe.normalize(ze)),Ee]);return}for(var Qe=this.chordLengthParameterize(V,$),He=Math.max(k,k*k),Ze,Ve=!0,ft=0;ft<=4;ft++){var nt=this.generateBezier(V,$,Qe,te,fe),Me=this.findMaxError(V,$,nt,Qe);if(Me.error<k&&Ve){this.addCurve(v,nt);return}if(Ze=Me.index,Me.error>=He)break;Ve=this.reparameterize(V,$,Qe,nt),He=Me.error}var se=ve[Ze-1].subtract(ve[Ze+1]);this.fitCubic(v,k,V,Ze,te,se),this.fitCubic(v,k,Ze,$,se.negate(),fe)},addCurve:function(v,k){var V=v[v.length-1];V.setHandleOut(k[1].subtract(k[0])),v.push(new $e(k[3],k[2].subtract(k[3])))},generateBezier:function(v,k,V,$,te){for(var fe=1e-12,ve=Math.abs,Ie=this.points,Ee=Ie[v],ze=Ie[k],Qe=[[0,0],[0,0]],He=[0,0],Ze=0,Ve=k-v+1;Ze<Ve;Ze++){var ft=V[Ze],nt=1-ft,Me=3*ft*nt,se=nt*nt*nt,ne=Me*nt,X=Me*ft,ie=ft*ft*ft,de=$.normalize(ne),ye=te.normalize(X),ge=Ie[v+Ze].subtract(Ee.multiply(se+ne)).subtract(ze.multiply(X+ie));Qe[0][0]+=de.dot(de),Qe[0][1]+=de.dot(ye),Qe[1][0]=Qe[0][1],Qe[1][1]+=ye.dot(ye),He[0]+=de.dot(ge),He[1]+=ye.dot(ge)}var Pe=Qe[0][0]*Qe[1][1]-Qe[1][0]*Qe[0][1],Fe,Ne;if(ve(Pe)>fe){var Xe=Qe[0][0]*He[1]-Qe[1][0]*He[0],Ye=He[0]*Qe[1][1]-He[1]*Qe[0][1];Fe=Ye/Pe,Ne=Xe/Pe}else{var De=Qe[0][0]+Qe[0][1],Ue=Qe[1][0]+Qe[1][1];Fe=Ne=ve(De)>fe?He[0]/De:ve(Ue)>fe?He[1]/Ue:0}var ht=ze.getDistance(Ee),kt=fe*ht,o,ke;if(Fe<kt||Ne<kt)Fe=Ne=ht/3;else{var oi=ze.subtract(Ee);o=$.normalize(Fe),ke=te.normalize(Ne),o.dot(oi)-ke.dot(oi)>ht*ht&&(Fe=Ne=ht/3,o=ke=null)}return[Ee,Ee.add(o||$.normalize(Fe)),ze.add(ke||te.normalize(Ne)),ze]},reparameterize:function(v,k,V,$){for(var te=v;te<=k;te++)V[te-v]=this.findRoot($,this.points[te],V[te-v]);for(var te=1,fe=V.length;te<fe;te++)if(V[te]<=V[te-1])return!1;return!0},findRoot:function(v,k,V){for(var $=[],te=[],fe=0;fe<=2;fe++)$[fe]=v[fe+1].subtract(v[fe]).multiply(3);for(var fe=0;fe<=1;fe++)te[fe]=$[fe+1].subtract($[fe]).multiply(2);var ve=this.evaluate(3,v,V),Ie=this.evaluate(2,$,V),Ee=this.evaluate(1,te,V),ze=ve.subtract(k),Qe=Ie.dot(Ie)+ze.dot(Ee);return ae.isMachineZero(Qe)?V:V-ze.dot(Ie)/Qe},evaluate:function(v,k,V){for(var $=k.slice(),te=1;te<=v;te++)for(var fe=0;fe<=v-te;fe++)$[fe]=$[fe].multiply(1-V).add($[fe+1].multiply(V));return $[0]},chordLengthParameterize:function(v,k){for(var V=[0],$=v+1;$<=k;$++)V[$-v]=V[$-v-1]+this.points[$].getDistance(this.points[$-1]);for(var $=1,te=k-v;$<=te;$++)V[$]/=V[te];return V},findMaxError:function(v,k,V,$){for(var te=Math.floor((k-v+1)/2),fe=0,ve=v+1;ve<k;ve++){var Ie=this.evaluate(3,V,$[ve-v]),Ee=Ie.subtract(this.points[ve]),ze=Ee.x*Ee.x+Ee.y*Ee.y;ze>=fe&&(fe=ze,te=ve)}return{error:fe,index:te}}}),Oi=Ge.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(k){this._content="",this._lines=[];var V=k&&b.isPlainObject(k)&&k.x===n&&k.y===n;this._initialize(V&&k,!V&&be.read(arguments))},_equals:function(v){return this._content===v._content},copyContent:function(v){this.setContent(v._content)},getContent:function(){return this._content},setContent:function(v){this._content=""+v,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),tn=Oi.extend({_class:"PointText",initialize:function(){Oi.apply(this,arguments)},getPoint:function(){var v=this._matrix.getTranslation();return new Ke(v.x,v.y,this,"setPoint")},setPoint:function(){var v=be.read(arguments);this.translate(v.subtract(this._matrix.getTranslation()))},_draw:function(v,k,V){if(this._content){this._setStyles(v,k,V);var $=this._lines,te=this._style,fe=te.hasFill(),ve=te.hasStroke(),Ie=te.getLeading(),Ee=v.shadowColor;v.font=te.getFontStyle(),v.textAlign=te.getJustification();for(var ze=0,Qe=$.length;ze<Qe;ze++){v.shadowColor=Ee;var He=$[ze];fe&&(v.fillText(He,0,0),v.shadowColor="rgba(0,0,0,0)"),ve&&v.strokeText(He,0,0),v.translate(0,Ie)}}},_getBounds:function(v,k){var V=this._style,$=this._lines,te=$.length,fe=V.getJustification(),ve=V.getLeading(),Ie=this.getView().getTextWidth(V.getFontStyle(),$),Ee=0;fe!=="left"&&(Ee-=Ie/(fe==="center"?2:1));var ze=new lt(Ee,te?-.75*ve:0,Ie,te*ve);return v?v._transformBounds(ze,ze):ze}}),qi=b.extend(new function(){var v={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},k={},V={transparent:[0,0,0,0]},$;function te(Ie){var Ee=Ie.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||Ie.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),ze="rgb",Qe;if(Ee){var He=Ee[4]?4:3;Qe=new Array(He);for(var Ze=0;Ze<He;Ze++){var Ve=Ee[Ze+1];Qe[Ze]=parseInt(Ve.length==1?Ve+Ve:Ve,16)/255}}else if(Ee=Ie.match(/^(rgb|hsl)a?\((.*)\)$/)){ze=Ee[1],Qe=Ee[2].trim().split(/[,\s]+/g);for(var ft=ze==="hsl",Ze=0,nt=Math.min(Qe.length,4);Ze<nt;Ze++){var Me=Qe[Ze],Ve=parseFloat(Me);if(ft)if(Ze===0){var se=Me.match(/([a-z]*)$/)[1];Ve*={turn:360,rad:180/Math.PI,grad:.9}[se]||1}else Ze<3&&(Ve/=100);else Ze<3&&(Ve/=/%$/.test(Me)?100:255);Qe[Ze]=Ve}}else{var ne=V[Ie];if(!ne)if(c){$||($=en.getContext(1,1,{willReadFrequently:!0}),$.globalCompositeOperation="copy"),$.fillStyle="rgba(0,0,0,0)",$.fillStyle=Ie,$.fillRect(0,0,1,1);var X=$.getImageData(0,0,1,1).data;ne=V[Ie]=[X[0]/255,X[1]/255,X[2]/255]}else ne=[0,0,0];Qe=ne.slice()}return[ze,Qe]}var fe=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],ve={"rgb-hsb":function(Ie,Ee,ze){var Qe=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Ze=Qe-He,Ve=Ze===0?0:(Qe==Ie?(Ee-ze)/Ze+(Ee<ze?6:0):Qe==Ee?(ze-Ie)/Ze+2:(Ie-Ee)/Ze+4)*60;return[Ve,Qe===0?0:Ze/Qe,Qe]},"hsb-rgb":function(Ie,Ee,ze){Ie=(Ie/60%6+6)%6;var He=Math.floor(Ie),Qe=Ie-He,He=fe[He],Ze=[ze,ze*(1-Ee),ze*(1-Ee*Qe),ze*(1-Ee*(1-Qe))];return[Ze[He[0]],Ze[He[1]],Ze[He[2]]]},"rgb-hsl":function(Ie,Ee,ze){var Qe=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Ze=Qe-He,Ve=Ze===0,ft=Ve?0:(Qe==Ie?(Ee-ze)/Ze+(Ee<ze?6:0):Qe==Ee?(ze-Ie)/Ze+2:(Ie-Ee)/Ze+4)*60,nt=(Qe+He)/2,Me=Ve?0:nt<.5?Ze/(Qe+He):Ze/(2-Qe-He);return[ft,Me,nt]},"hsl-rgb":function(Ie,Ee,ze){if(Ie=(Ie/360%1+1)%1,Ee===0)return[ze,ze,ze];for(var Qe=[Ie+1/3,Ie,Ie-1/3],He=ze<.5?ze*(1+Ee):ze+Ee-ze*Ee,Ze=2*ze-He,Ve=[],ft=0;ft<3;ft++){var nt=Qe[ft];nt<0&&(nt+=1),nt>1&&(nt-=1),Ve[ft]=6*nt<1?Ze+(He-Ze)*6*nt:2*nt<1?He:3*nt<2?Ze+(He-Ze)*(2/3-nt)*6:Ze}return Ve},"rgb-gray":function(Ie,Ee,ze){return[Ie*.2989+Ee*.587+ze*.114]},"gray-rgb":function(Ie){return[Ie,Ie,Ie]},"gray-hsb":function(Ie){return[0,0,Ie]},"gray-hsl":function(Ie){return[0,0,Ie]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return b.each(v,function(Ie,Ee){k[Ee]=[],b.each(Ie,function(ze,Qe){var He=b.capitalize(ze),Ze=/^(hue|saturation)$/.test(ze),Ve=k[Ee][Qe]=Ee==="gradient"?ze==="gradient"?function(ft){var nt=this._components[0];return ft=Ni.read(Array.isArray(ft)?ft:arguments,0,{readNull:!0}),nt!==ft&&(nt&&nt._removeOwner(this),ft&&ft._addOwner(this)),ft}:function(){return be.read(arguments,0,{readNull:ze==="highlight",clone:!0})}:function(ft){return ft==null||isNaN(ft)?0:+ft};this["get"+He]=function(){return this._type===Ee||Ze&&/^hs[bl]$/.test(this._type)?this._components[Qe]:this._convert(Ee)[Qe]},this["set"+He]=function(ft){this._type!==Ee&&!(Ze&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(Ee),this._properties=v[Ee],this._type=Ee),this._components[Qe]=Ve.call(this,ft),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function Ie(Ee){var ze=arguments,Qe=this.__read,He=0,Ze,Ve,ft,nt;Array.isArray(Ee)&&(ze=Ee,Ee=ze[0]);var Me=Ee!=null&&typeof Ee;if(Me==="string"&&Ee in v&&(Ze=Ee,Ee=ze[1],Array.isArray(Ee)?(Ve=Ee,ft=ze[2]):(Qe&&(He=1),ze=b.slice(ze,1),Me=typeof Ee)),!Ve){if(nt=Me==="number"?ze:Me==="object"&&Ee.length!=null?Ee:null,nt){Ze||(Ze=nt.length>=3?"rgb":"gray");var se=v[Ze].length;ft=nt[se],Qe&&(He+=nt===arguments?se+(ft!=null?1:0):1),nt.length>se&&(nt=b.slice(nt,0,se))}else if(Me==="string"){var ne=te(Ee);Ze=ne[0],Ve=ne[1],Ve.length===4&&(ft=Ve[3],Ve.length--)}else if(Me==="object")if(Ee.constructor===Ie){if(Ze=Ee._type,Ve=Ee._components.slice(),ft=Ee._alpha,Ze==="gradient")for(var X=1,ie=Ve.length;X<ie;X++){var de=Ve[X];de&&(Ve[X]=de.clone())}}else if(Ee.constructor===Ni)Ze="gradient",nt=ze;else{Ze="hue"in Ee?"lightness"in Ee?"hsl":"hsb":"gradient"in Ee||"stops"in Ee||"radial"in Ee?"gradient":"gray"in Ee?"gray":"rgb";var ye=v[Ze],ge=k[Ze];this._components=Ve=[];for(var X=0,ie=ye.length;X<ie;X++){var Pe=Ee[ye[X]];Pe==null&&!X&&Ze==="gradient"&&"stops"in Ee&&(Pe={stops:Ee.stops,radial:Ee.radial}),Pe=ge[X].call(this,Pe),Pe!=null&&(Ve[X]=Pe)}ft=Ee.alpha}Qe&&Ze&&(He=1)}if(this._type=Ze||"rgb",!Ve){this._components=Ve=[];for(var ge=k[this._type],X=0,ie=ge.length;X<ie;X++){var Pe=ge[X].call(this,nt&&nt[X]);Pe!=null&&(Ve[X]=Pe)}}return this._components=Ve,this._properties=v[this._type],this._alpha=ft,Qe&&(this.__read=He),this},set:"#initialize",_serialize:function(Ie,Ee){var ze=this.getComponents();return b.serialize(/^(gray|rgb)$/.test(this._type)?ze:[this._type].concat(ze),Ie,!0,Ee)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(Ie){var Ee;return this._type===Ie?this._components.slice():(Ee=ve[this._type+"-"+Ie])?Ee.apply(this,this._components):ve["rgb-"+Ie].apply(this,ve[this._type+"-rgb"].apply(this,this._components))},convert:function(Ie){return new qi(Ie,this._convert(Ie),this._alpha)},getType:function(){return this._type},setType:function(Ie){this._components=this._convert(Ie),this._properties=v[Ie],this._type=Ie},getComponents:function(){var Ie=this._components.slice();return this._alpha!=null&&Ie.push(this._alpha),Ie},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(Ie){this._alpha=Ie==null?null:Math.min(Math.max(Ie,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(Ie){var Ee=b.isPlainValue(Ie,!0)?qi.read(arguments):Ie;return Ee===this||Ee&&this._class===Ee._class&&this._type===Ee._type&&this.getAlpha()===Ee.getAlpha()&&b.equals(this._components,Ee._components)||!1},toString:function(){for(var Ie=this._properties,Ee=[],ze=this._type==="gradient",Qe=he.instance,He=0,Ze=Ie.length;He<Ze;He++){var Ve=this._components[He];Ve!=null&&Ee.push(Ie[He]+": "+(ze?Ve:Qe.number(Ve)))}return this._alpha!=null&&Ee.push("alpha: "+Qe.number(this._alpha)),"{ "+Ee.join(", ")+" }"},toCSS:function(Ie){var Ee=this._convert("rgb"),ze=Ie||this._alpha==null?1:this._alpha;function Qe(He){return Math.round((He<0?0:He>1?1:He)*255)}return Ee=[Qe(Ee[0]),Qe(Ee[1]),Qe(Ee[2])],ze<1&&Ee.push(ze<0?0:ze),Ie?"#"+((1<<24)+(Ee[0]<<16)+(Ee[1]<<8)+Ee[2]).toString(16).slice(1):(Ee.length==4?"rgba(":"rgb(")+Ee.join(",")+")"},toCanvasStyle:function(Ie,Ee){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var ze=this._components,Qe=ze[0],He=Qe._stops,Ze=ze[1],Ve=ze[2],ft=ze[3],nt=Ee&&Ee.inverted(),Me;if(nt&&(Ze=nt._transformPoint(Ze),Ve=nt._transformPoint(Ve),ft&&(ft=nt._transformPoint(ft))),Qe._radial){var se=Ve.getDistance(Ze);if(ft){var ne=ft.subtract(Ze);ne.getLength()>se&&(ft=Ze.add(ne.normalize(se-.1)))}var X=ft||Ze;Me=Ie.createRadialGradient(X.x,X.y,0,Ze.x,Ze.y,se)}else Me=Ie.createLinearGradient(Ze.x,Ze.y,Ve.x,Ve.y);for(var ie=0,de=He.length;ie<de;ie++){var ye=He[ie],ge=ye._offset;Me.addColorStop(ge??ie/(de-1),ye._color.toCanvasStyle())}return this._canvasStyle=Me},transform:function(Ie){if(this._type==="gradient"){for(var Ee=this._components,ze=1,Qe=Ee.length;ze<Qe;ze++){var He=Ee[ze];Ie._transformPoint(He,He,!0)}this._changed()}},statics:{_types:v,random:function(){var Ie=Math.random;return new qi(Ie(),Ie(),Ie())},_setOwner:function(Ie,Ee,ze){return Ie&&(Ie._owner&&Ee&&Ie._owner!==Ee&&(Ie=Ie.clone()),!Ie._owner^!Ee&&(Ie._owner=Ee||null,Ie._setter=ze||null)),Ie}}})},new function(){var v={add:function(k,V){return k+V},subtract:function(k,V){return k-V},multiply:function(k,V){return k*V},divide:function(k,V){return k/V}};return b.each(v,function(k,V){this[V]=function($){$=qi.read(arguments);for(var te=this._type,fe=this._components,ve=$._convert(te),Ie=0,Ee=fe.length;Ie<Ee;Ie++)ve[Ie]=k(fe[Ie],ve[Ie]);return new qi(te,ve,this._alpha!=null?k(this._alpha,$.getAlpha()):null)}},{})}),Ni=b.extend({_class:"Gradient",initialize:function(k,V){this._id=ue.get(),k&&b.isPlainObject(k)&&(this.set(k),k=V=null),this._stops==null&&this.setStops(k||["white","black"]),this._radial==null&&this.setRadial(typeof V=="string"&&V==="radial"||V||!1)},_serialize:function(v,k){return k.add(this,function(){return b.serialize([this._stops,this._radial],v,!0,k)})},_changed:function(){for(var v=0,k=this._owners&&this._owners.length;v<k;v++)this._owners[v]._changed()},_addOwner:function(v){this._owners||(this._owners=[]),this._owners.push(v)},_removeOwner:function(v){var k=this._owners?this._owners.indexOf(v):-1;k!=-1&&(this._owners.splice(k,1),this._owners.length||(this._owners=n))},clone:function(){for(var v=[],k=0,V=this._stops.length;k<V;k++)v[k]=this._stops[k].clone();return new Ni(v,this._radial)},getStops:function(){return this._stops},setStops:function(v){if(v.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var k=this._stops;if(k)for(var V=0,$=k.length;V<$;V++)k[V]._owner=n;k=this._stops=nn.readList(v,0,{clone:!0});for(var V=0,$=k.length;V<$;V++)k[V]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(v){this._radial=v,this._changed()},equals:function(v){if(v===this)return!0;if(v&&this._class===v._class){var k=this._stops,V=v._stops,$=k.length;if($===V.length){for(var te=0;te<$;te++)if(!k[te].equals(V[te]))return!1;return!0}}return!1}}),nn=b.extend({_class:"GradientStop",initialize:function(k,V){var $=k,te=V;typeof k=="object"&&V===n&&(Array.isArray(k)&&typeof k[0]!="number"?($=k[0],te=k[1]):("color"in k||"offset"in k||"rampPoint"in k)&&($=k.color,te=k.offset||k.rampPoint||0)),this.setColor($),this.setOffset(te)},clone:function(){return new nn(this._color.clone(),this._offset)},_serialize:function(v,k){var V=this._color,$=this._offset;return b.serialize($==null?[V]:[V,$],v,!0,k)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(v){this._offset=v,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){qi._setOwner(this._color,null),this._color=qi._setOwner(qi.read(arguments,0),this,"setColor"),this._changed()},equals:function(v){return v===this||v&&this._class===v._class&&this._color.equals(v._color)&&this._offset==v._offset||!1}}),yn=b.extend(new function(){var v={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new be,selectedColor:null},k=b.set({},v,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),V=b.set({},k,{fillColor:new qi}),$={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},te={beans:!0},fe={_class:"Style",beans:!0,initialize:function(Ie,Ee,ze){this._values={},this._owner=Ee,this._project=Ee&&Ee._project||ze||In.project,this._defaults=!Ee||Ee instanceof Xt?k:Ee instanceof Oi?V:v,Ie&&this.set(Ie)}};return b.each(k,function(ve,Ie){var Ee=/Color$/.test(Ie),ze=Ie==="shadowOffset",Qe=b.capitalize(Ie),He=$[Ie],Ze="set"+Qe,Ve="get"+Qe;fe[Ze]=function(ft){var nt=this._owner,Me=nt&&nt._children,se=Me&&Me.length>0&&!(nt instanceof _i);if(se)for(var ne=0,X=Me.length;ne<X;ne++)Me[ne]._style[Ze](ft);if((Ie==="selectedColor"||!se)&&Ie in this._defaults){var ie=this._values[Ie];ie!==ft&&(Ee&&(ie&&(qi._setOwner(ie,null),ie._canvasStyle=null),ft&&ft.constructor===qi&&(ft=qi._setOwner(ft,nt,se&&Ze))),this._values[Ie]=ft,nt&&nt._changed(He||129))}},fe[Ve]=function(ft){var nt=this._owner,Me=nt&&nt._children,se=Me&&Me.length>0&&!(nt instanceof _i),ne;if(se&&!ft)for(var X=0,ie=Me.length;X<ie;X++){var de=Me[X]._style[Ve]();if(!X)ne=de;else if(!b.equals(ne,de))return n}else if(Ie in this._defaults){var ne=this._values[Ie];if(ne===n)ne=this._defaults[Ie],ne&&ne.clone&&(ne=ne.clone());else{var ye=Ee?qi:ze?be:null;ye&&!(ne&&ne.constructor===ye)&&(this._values[Ie]=ne=ye.read([ne],0,{readNull:!0,clone:!0}))}}return ne&&Ee&&(ne=qi._setOwner(ne,nt,se&&Ze)),ne},te[Ve]=function(ft){return this._style[Ve](ft)},te[Ze]=function(ft){this._style[Ze](ft)}}),b.each({Font:"FontFamily",WindingRule:"FillRule"},function(ve,Ie){var Ee="get"+Ie,ze="set"+Ie;fe[Ee]=te[Ee]="#get"+ve,fe[ze]=te[ze]="#set"+ve}),Ge.inject(te),fe},{set:function(v){var k=v instanceof yn,V=k?v._values:v;if(V){for(var $ in V)if($ in this._defaults){var te=V[$];this[$]=te&&k&&te.clone?te.clone():te}}},equals:function(v){function k(V,$,te){var fe=V._values,ve=$._values,Ie=$._defaults;for(var Ee in fe){var ze=fe[Ee],Qe=ve[Ee];if(!(te&&Ee in ve)&&!b.equals(ze,Qe===n?Ie[Ee]:Qe))return!1}return!0}return v===this||v&&this._class===v._class&&k(this,v)&&k(v,this,!0)||!1},_dispose:function(){var v;v=this.getFillColor(),v&&(v._canvasStyle=null),v=this.getStrokeColor(),v&&(v._canvasStyle=null),v=this.getShadowColor(),v&&(v._canvasStyle=null)},hasFill:function(){var v=this.getFillColor();return!!v&&v.alpha>0},hasStroke:function(){var v=this.getStrokeColor();return!!v&&v.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var v=this.getShadowColor();return!!v&&v.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var v=this.getFontSize();return this.getFontWeight()+" "+v+(/[a-z]/i.test(v+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function v(){var k=v.base.call(this),V=this.getFontSize();return/pt|em|%|px/.test(V)&&(V=this.getView().getPixelSize(V)),k??V*1.2}}),Ci=new function(){function v(k,V,$,te){for(var fe=["","webkit","moz","Moz","ms","o"],ve=V[0].toUpperCase()+V.substring(1),Ie=0;Ie<6;Ie++){var Ee=fe[Ie],ze=Ee?Ee+ve:V;if(ze in k){if($)k[ze]=te;else return k[ze];break}}}return{getStyles:function(k){var V=k&&k.nodeType!==9?k.ownerDocument:k,$=V&&V.defaultView;return $&&$.getComputedStyle(k,"")},getBounds:function(k,V){var $=k.ownerDocument,te=$.body,fe=$.documentElement,ve;try{ve=k.getBoundingClientRect()}catch{ve={left:0,top:0,width:0,height:0}}var Ie=ve.left-(fe.clientLeft||te.clientLeft||0),Ee=ve.top-(fe.clientTop||te.clientTop||0);if(!V){var ze=$.defaultView;Ie+=ze.pageXOffset||fe.scrollLeft||te.scrollLeft,Ee+=ze.pageYOffset||fe.scrollTop||te.scrollTop}return new lt(Ie,Ee,ve.width,ve.height)},getViewportBounds:function(k){var V=k.ownerDocument,$=V.defaultView,te=V.documentElement;return new lt(0,0,$.innerWidth||te.clientWidth,$.innerHeight||te.clientHeight)},getOffset:function(k,V){return Ci.getBounds(k,V).getPoint()},getSize:function(k){return Ci.getBounds(k,!0).getSize()},isInvisible:function(k){return Ci.getSize(k).equals(new ot(0,0))},isInView:function(k){return!Ci.isInvisible(k)&&Ci.getViewportBounds(k).intersects(Ci.getBounds(k,!0))},isInserted:function(k){return g.body.contains(k)},getPrefixed:function(k,V){return k&&v(k,V)},setPrefixed:function(k,V,$){if(typeof V=="object")for(var te in V)v(k,te,!0,V[te]);else v(k,V,!0,$)}}},gi={add:function(v,k){if(v)for(var V in k)for(var $=k[V],te=V.split(/[\s,]+/g),fe=0,ve=te.length;fe<ve;fe++){var Ie=te[fe],Ee=v===g&&(Ie==="touchstart"||Ie==="touchmove")?{passive:!1}:!1;v.addEventListener(Ie,$,Ee)}},remove:function(v,k){if(v)for(var V in k)for(var $=k[V],te=V.split(/[\s,]+/g),fe=0,ve=te.length;fe<ve;fe++)v.removeEventListener(te[fe],$,!1)},getPoint:function(v){var k=v.targetTouches?v.targetTouches.length?v.targetTouches[0]:v.changedTouches[0]:v;return new be(k.pageX||k.clientX+g.documentElement.scrollLeft,k.pageY||k.clientY+g.documentElement.scrollTop)},getTarget:function(v){return v.target||v.srcElement},getRelatedTarget:function(v){return v.relatedTarget||v.toElement},getOffset:function(v,k){return gi.getPoint(v).subtract(Ci.getOffset(k||gi.getTarget(v)))}};gi.requestAnimationFrame=new function(){var v=Ci.getPrefixed(c,"requestAnimationFrame"),k=!1,V=[],$;function te(){var fe=V;V=[];for(var ve=0,Ie=fe.length;ve<Ie;ve++)fe[ve]();k=v&&V.length,k&&v(te)}return function(fe){V.push(fe),v?k||(v(te),k=!0):$||($=setInterval(te,1e3/60))}};var Ri=b.extend(I,{_class:"View",initialize:function v(k,V){function $(He){return V[He]||parseInt(V.getAttribute(He),10)}function te(){var He=Ci.getSize(V);return He.isNaN()||He.isZero()?new ot($("width"),$("height")):He}var fe;if(c&&V){this._id=V.getAttribute("id"),this._id==null&&V.setAttribute("id",this._id="paper-view-"+v._id++),gi.add(V,this._viewEvents);var ve="none";if(Ci.setPrefixed(V.style,{userDrag:ve,userSelect:ve,touchCallout:ve,contentZooming:ve,tapHighlightColor:"rgba(0,0,0,0)"}),a.hasAttribute(V,"resize")){var Ie=this;gi.add(c,this._windowEvents={resize:function(){Ie.setViewSize(te())}})}if(fe=te(),a.hasAttribute(V,"stats")&&typeof Stats<"u"){this._stats=new Stats;var Ee=this._stats.domElement,ze=Ee.style,Qe=Ci.getOffset(V);ze.position="absolute",ze.left=Qe.x+"px",ze.top=Qe.y+"px",g.body.appendChild(Ee)}}else fe=new ot(V),V=null;this._project=k,this._scope=k._scope,this._element=V,this._pixelRatio||(this._pixelRatio=c&&c.devicePixelRatio||1),this._setElementSize(fe.width,fe.height),this._viewSize=fe,v._views.push(this),v._viewsById[this._id]=this,(this._matrix=new Tt)._owner=this,v._focused||(v._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!In.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Ri._focused===this&&(Ri._focused=null),Ri._views.splice(Ri._views.indexOf(this),1),delete Ri._viewsById[this._id];var v=this._project;return v._view===this&&(v._view=null),gi.remove(this._element,this._viewEvents),gi.remove(c,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:b.each(Ge._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(v){this[v]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(v){this._autoUpdate=v,v&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var v=this;gi.requestAnimationFrame(function(){if(v._requested=!1,v._animate){v.requestUpdate();var k=v._element;(!Ci.getPrefixed(g,"hidden")||a.getAttribute(k,"keepalive")==="true")&&Ci.isInView(k)&&v._handleFrame()}v._autoUpdate&&v.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){In=this._scope;var v=Date.now()/1e3,k=this._last?v-this._last:0;this._last=v,this.emit("frame",new b({delta:k,time:this._time+=k,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(v,k){var V=this._frameItems;k?(V[v._id]={item:v,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete V[v._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(v){for(var k in this._frameItems){var V=this._frameItems[k];V.item.emit("frame",new b(v,{time:V.time+=v.delta,count:V.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var v=this._viewSize;return new tt(v.width,v.height,this,"setViewSize")},setViewSize:function(){var v=ot.read(arguments),k=v.subtract(this._viewSize);k.isZero()||(this._setElementSize(v.width,v.height),this._viewSize.set(v),this._changed(),this.emit("resize",{size:v,delta:k}),this._autoUpdate&&this.update())},_setElementSize:function(v,k){var V=this._element;V&&(V.width!==v&&(V.width=v),V.height!==k&&(V.height=k))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new lt(new be,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Ci.isInView(this._element)},isInserted:function(){return Ci.isInserted(this._element)},getPixelSize:function(v){var k=this._element,V;if(k){var $=k.parentNode,te=g.createElement("div");te.style.fontSize=v,$.appendChild(te),V=parseFloat(Ci.getStyles(te).fontSize),$.removeChild(te)}else V=parseFloat(V);return V},getTextWidth:function(v,k){return 0}},b.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,$=(k?b:be).read(V),te=be.read(V,0,{readNull:!0});return this.transform(new Tt()[v]($,te||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var v=new Tt;return this.transform(v.translate.apply(v,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var v=be.read(arguments);this.translate(this.getCenter().subtract(v))},getZoom:function(){var v=this._decompose().scaling;return(v.x+v.y)/2},setZoom:function(v){this.transform(new Tt().scale(v/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(v){var k=this.getRotation();k!=null&&v!=null&&this.rotate(v-k)},getScaling:function(){var v=this._decompose().scaling;return new Ke(v.x,v.y,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=be.read(arguments,0,{clone:!0,readNull:!0});v&&k&&this.scale(k.x/v.x,k.y/v.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},transform:function(v){this._matrix.append(v)},scrollBy:function(){this.translate(be.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(be.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(be.read(arguments))},getEventPoint:function(v){return this.viewToProject(gi.getOffset(v,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(v,k){g&&typeof k=="string"&&(k=g.getElementById(k));var V=c?ai:Ri;return new V(v,k)}}},new function(){if(!c)return;var v,k,V=!1,$=!1;function te(Ye){var De=gi.getTarget(Ye);return De.getAttribute&&Ri._viewsById[De.getAttribute("id")]}function fe(){var Ye=Ri._focused;if(!Ye||!Ye.isVisible()){for(var De=0,Ue=Ri._views.length;De<Ue;De++)if((Ye=Ri._views[De]).isVisible()){Ri._focused=k=Ye;break}}}function ve(Ye,De,Ue){Ye._handleMouseEvent("mousemove",De,Ue)}var Ie=c.navigator,Ee,ze,Qe;Ie.pointerEnabled||Ie.msPointerEnabled?(Ee="pointerdown MSPointerDown",ze="pointermove MSPointerMove",Qe="pointerup pointercancel MSPointerUp MSPointerCancel"):(Ee="touchstart",ze="touchmove",Qe="touchend touchcancel","ontouchstart"in c&&Ie.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(Ee+=" mousedown",ze+=" mousemove",Qe+=" mouseup"));var He={},Ze={mouseout:function(Ye){var De=Ri._focused,Ue=gi.getRelatedTarget(Ye);if(De&&(!Ue||Ue.nodeName==="HTML")){var ht=gi.getOffset(Ye,De._element),kt=ht.x,o=Math.abs,ke=o(kt),oi=1<<25,di=ke-oi;ht.x=o(di)<ke?di*(kt<0?-1:1):kt,ve(De,Ye,De.viewToProject(ht))}},scroll:fe};He[Ee]=function(Ye){var De=Ri._focused=te(Ye);V||(V=!0,De._handleMouseEvent("mousedown",Ye))},Ze[ze]=function(Ye){var De=Ri._focused;if(!$){var Ue=te(Ye);Ue?De!==Ue&&(De&&ve(De,Ye),v||(v=De),De=Ri._focused=k=Ue):k&&k===De&&(v&&!v.isInserted()&&(v=null),De=Ri._focused=v,v=null,fe())}De&&ve(De,Ye)},Ze[Ee]=function(){$=!0},Ze[Qe]=function(Ye){var De=Ri._focused;De&&V&&De._handleMouseEvent("mouseup",Ye),$=V=!1},gi.add(g,Ze),gi.add(c,{load:fe});var Ve=!1,ft=!1,nt={doubleclick:"click",mousedrag:"mousemove"},Me=!1,se,ne,X,ie,de,ye,ge,Pe;function Fe(Ye,De,Ue,ht,kt,o,ke){var oi=!1,di;function Ai(Jt,li){if(Jt.responds(li)){if(di||(di=new pn(li,ht,kt,De||Jt,o?kt.subtract(o):null)),Jt.emit(li,di)&&(Ve=!0,di.prevented&&(ft=!0),di.stopped))return oi=!0}else{var zi=nt[li];if(zi)return Ai(Jt,zi)}}for(;Ye&&Ye!==ke&&!Ai(Ye,Ue);)Ye=Ye._parent;return oi}function Ne(Ye,De,Ue,ht,kt,o){return Ye._project.removeOn(Ue),ft=Ve=!1,de&&Fe(de,null,Ue,ht,kt,o)||De&&De!==de&&!De.isDescendant(de)&&Fe(De,null,Ue==="mousedrag"?"mousemove":Ue,ht,kt,o,de)||Fe(Ye,de||De||Ye,Ue,ht,kt,o)}var Xe={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:He,_handleMouseEvent:function(Ye,De,Ue){var ht=this._itemEvents,kt=ht.native[Ye],o=Ye==="mousemove",ke=this._scope.tool,oi=this;function di($t){return ht.virtual[$t]||oi.responds($t)||ke&&ke.responds($t)}o&&V&&di("mousedrag")&&(Ye="mousedrag"),Ue||(Ue=this.getEventPoint(De));var Ai=this.getBounds().contains(Ue),Jt=kt&&Ai&&oi._project.hitTest(Ue,{tolerance:0,fill:!0,stroke:!0}),li=Jt&&Jt.item||null,zi=!1,vi={};if(vi[Ye.substr(5)]=!0,kt&&li!==ie&&(ie&&Fe(ie,null,"mouseleave",De,Ue),li&&Fe(li,null,"mouseenter",De,Ue),ie=li),Me^Ai&&(Fe(this,null,Ai?"mouseenter":"mouseleave",De,Ue),zi=!0),(Ai||vi.drag)&&!Ue.equals(ne)&&(Ne(this,li,o?Ye:"mousemove",De,Ue,ne),zi=!0),Me=Ai,vi.down&&Ai||vi.up&&se){if(Ne(this,li,Ye,De,Ue,se),vi.down){if(Pe=li===ye&&Date.now()-ge<300,X=ye=li,!ft&&li){for(var wi=li;wi&&!wi.responds("mousedrag");)wi=wi._parent;wi&&(de=li)}se=Ue}else vi.up&&(!ft&&li===X&&(ge=Date.now(),Ne(this,li,Pe?"doubleclick":"click",De,Ue,se),Pe=!1),X=de=null);Me=!1,zi=!0}ne=Ue,zi&&ke&&(Ve=ke._handleMouseEvent(Ye,De,Ue,vi)||Ve),De.cancelable!==!1&&(Ve&&!vi.move||vi.down&&di("mouseup"))&&De.preventDefault()},_handleKeyEvent:function(Ye,De,Ue,ht){var kt=this._scope,o=kt.tool,ke;function oi(di){di.responds(Ye)&&(In=kt,di.emit(Ye,ke=ke||new Ji(Ye,De,Ue,ht)))}this.isVisible()&&(oi(this),o&&o.responds(Ye)&&oi(o))},_countItemEvent:function(Ye,De){var Ue=this._itemEvents,ht=Ue.native,kt=Ue.virtual;for(var o in Xe)ht[o]=(ht[o]||0)+(Xe[o][Ye]||0)*De;kt[Ye]=(kt[Ye]||0)+De},statics:{updateFocus:fe,_resetState:function(){V=$=Ve=Me=!1,v=k=se=ne=X=ie=de=ye=ge=Pe=null}}}}),ai=Ri.extend({_class:"CanvasView",initialize:function(k,V){if(!(V instanceof c.HTMLCanvasElement)){var $=ot.read(arguments,1);if($.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+b.slice(arguments,1));V=en.getCanvas($)}var te=this._context=V.getContext("2d");if(te.save(),this._pixelRatio=1,!/^off|false$/.test(a.getAttribute(V,"hidpi"))){var fe=c.devicePixelRatio||1,ve=Ci.getPrefixed(te,"backingStorePixelRatio")||1;this._pixelRatio=fe/ve}Ri.call(this,k,V),this._needsUpdate=!0},remove:function v(){return this._context.restore(),v.base.call(this)},_setElementSize:function v(k,V){var $=this._pixelRatio;if(v.base.call(this,k*$,V*$),$!==1){var te=this._element,fe=this._context;if(!a.hasAttribute(te,"resize")){var ve=te.style;ve.width=k+"px",ve.height=V+"px"}fe.restore(),fe.save(),fe.scale($,$)}},getContext:function(){return this._context},getPixelSize:function v(k){var V=In.agent,$;if(V&&V.firefox)$=v.base.call(this,k);else{var te=this._context,fe=te.font;te.font=k+" serif",$=parseFloat(te.font),te.font=fe}return $},getTextWidth:function(v,k){var V=this._context,$=V.font,te=0;V.font=v;for(var fe=0,ve=k.length;fe<ve;fe++)te=Math.max(te,V.measureText(k[fe]).width);return V.font=$,te},update:function(){if(!this._needsUpdate)return!1;var v=this._project,k=this._context,V=this._viewSize;return k.clearRect(0,0,V.width+1,V.height+1),v&&v.draw(k,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Ki=b.extend({_class:"Event",initialize:function(k){this.event=k,this.type=k&&k.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return fi.modifiers}}),Ji=Ki.extend({_class:"KeyEvent",initialize:function(k,V,$,te){this.type=k,this.event=V,this.key=$,this.character=te},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),fi=new function(){var v={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},k={tab:"	",space:" ",enter:"\r"},V={},$={},te,fe,ve=new b({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var ze=In&&In.agent;return ze&&ze.mac?this.meta:this.control}}});function Ie(ze){var Qe=ze.key||ze.keyIdentifier;return Qe=/^U\+/.test(Qe)?String.fromCharCode(parseInt(Qe.substr(2),16)):/^Arrow[A-Z]/.test(Qe)?Qe.substr(5):Qe==="Unidentified"||Qe===n?String.fromCharCode(ze.keyCode):Qe,v[Qe]||(Qe.length>1?b.hyphenate(Qe):Qe.toLowerCase())}function Ee(ze,Qe,He,Ze){var Ve=Ri._focused,ft;if(V[Qe]=ze,ze?$[Qe]=He:delete $[Qe],Qe.length>1&&(ft=b.camelize(Qe))in ve){ve[ft]=ze;var nt=In&&In.agent;if(ft==="meta"&&nt&&nt.mac)if(ze)te={};else{for(var Me in te)Me in $&&Ee(!1,Me,te[Me],Ze);te=null}}else ze&&te&&(te[Qe]=He);Ve&&Ve._handleKeyEvent(ze?"keydown":"keyup",Ze,Qe,He)}return gi.add(g,{keydown:function(ze){var Qe=Ie(ze),He=In&&In.agent;Qe.length>1||He&&He.chrome&&(ze.altKey||He.mac&&ze.metaKey||!He.mac&&ze.ctrlKey)?Ee(!0,Qe,k[Qe]||(Qe.length>1?"":Qe),ze):fe=Qe},keypress:function(ze){if(fe){var Qe=Ie(ze),He=ze.charCode,Ze=He>=32?String.fromCharCode(He):Qe.length>1?"":Qe;Qe!==fe&&(Qe=Ze.toLowerCase()),Ee(!0,Qe,Ze,ze),fe=null}},keyup:function(ze){var Qe=Ie(ze);Qe in $&&Ee(!1,Qe,$[Qe],ze)}}),gi.add(c,{blur:function(ze){for(var Qe in $)Ee(!1,Qe,$[Qe],ze)}}),{modifiers:ve,isDown:function(ze){return!!V[ze]}}},pn=Ki.extend({_class:"MouseEvent",initialize:function(k,V,$,te,fe){this.type=k,this.event=V,this.point=$,this.target=te,this.delta=fe},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),ii=Ki.extend({_class:"ToolEvent",_item:null,initialize:function(k,V,$){this.tool=k,this.type=V,this.event=$},_choosePoint:function(v,k){return v||(k?k.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(v){this._point=v},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(v){this._lastPoint=v},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(v){this._downPoint=v},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(v){this._middlePoint=v},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(v){this._delta=v},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(v){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=v},getItem:function(){if(!this._item){var v=this.tool._scope.project.hitTest(this.getPoint());if(v){for(var k=v.item,V=k._parent;/^(Group|CompoundPath)$/.test(V._class);)k=V,V=V._parent;this._item=k}}return this._item},setItem:function(v){this._item=v},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),wn=G.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(k){G.call(this),this._moveCount=-1,this._downCount=-1,this.set(k)},getMinDistance:function(){return this._minDistance},setMinDistance:function(v){this._minDistance=v,v!=null&&this._maxDistance!=null&&v>this._maxDistance&&(this._maxDistance=v)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(v){this._maxDistance=v,this._minDistance!=null&&v!=null&&v<this._minDistance&&(this._minDistance=v)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(v){this._minDistance=this._maxDistance=v},_handleMouseEvent:function(v,k,V,$){In=this._scope,$.drag&&!this.responds(v)&&(v="mousemove");var te=$.move||$.drag,fe=this.responds(v),ve=this.minDistance,Ie=this.maxDistance,Ee=!1,ze=this;function Qe(Ze,Ve){var ft=V,nt=te?ze._point:ze._downPoint||ft;if(te){if(ze._moveCount>=0&&ft.equals(nt))return!1;if(nt&&(Ze!=null||Ve!=null)){var Me=ft.subtract(nt),se=Me.getLength();if(se<(Ze||0))return!1;Ve&&(ft=nt.add(Me.normalize(Math.min(se,Ve))))}ze._moveCount++}return ze._point=ft,ze._lastPoint=nt||ft,$.down&&(ze._moveCount=-1,ze._downPoint=ft,ze._downCount++),!0}function He(){fe&&(Ee=ze.emit(v,new ii(ze,v,k))||Ee)}if($.down)Qe(),He();else if($.up)Qe(null,Ie),He();else if(fe)for(;Qe(ve,Ie);)He();return Ee}}),Rr=b.extend(I,{_class:"Tween",statics:{easings:new b({linear:function(v){return v},easeInQuad:function(v){return v*v},easeOutQuad:function(v){return v*(2-v)},easeInOutQuad:function(v){return v<.5?2*v*v:-1+2*(2-v)*v},easeInCubic:function(v){return v*v*v},easeOutCubic:function(v){return--v*v*v+1},easeInOutCubic:function(v){return v<.5?4*v*v*v:(v-1)*(2*v-2)*(2*v-2)+1},easeInQuart:function(v){return v*v*v*v},easeOutQuart:function(v){return 1- --v*v*v*v},easeInOutQuart:function(v){return v<.5?8*v*v*v*v:1-8*--v*v*v*v},easeInQuint:function(v){return v*v*v*v*v},easeOutQuint:function(v){return 1+--v*v*v*v*v},easeInOutQuint:function(v){return v<.5?16*v*v*v*v*v:1+16*--v*v*v*v*v}})},initialize:function v(k,V,$,te,fe,ve){this.object=k;var Ie=typeof fe,Ee=Ie==="function";this.type=Ee?Ie:Ie==="string"?fe:"linear",this.easing=Ee?fe:v.easings[this.type],this.duration=te,this.running=!1,this._then=null,this._startTime=null;var ze=V||$;this._keys=ze?Object.keys(ze):[],this._parsedKeys=this._parseKeys(this._keys),this._from=ze&&this._getState(V),this._to=ze&&this._getState($),ve!==!1&&this.start()},then:function(v){return this._then=v,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(v){if(this.running){v>=1&&(v=1,this.running=!1);for(var k=this.easing(v),V=this._keys,$=function(Qe){return typeof Qe=="function"?Qe(k,v):Qe},te=0,fe=V&&V.length;te<fe;te++){var ve=V[te],Ie=$(this._from[ve]),Ee=$(this._to[ve]),ze=Ie&&Ee&&Ie.__add&&Ee.__add?Ee.__subtract(Ie).__multiply(k).__add(Ie):(Ee-Ie)*k+Ie;this._setProperty(this._parsedKeys[ve],ze)}this.responds("update")&&this.emit("update",new b({progress:v,factor:k})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(v){var k=this._startTime,V=k?(v-k)/this.duration:0;k||(this._startTime=v),this.update(V)},_getState:function(v){for(var k=this._keys,V={},$=0,te=k.length;$<te;$++){var fe=k[$],ve=this._parsedKeys[fe],Ie=this._getProperty(ve),Ee;if(v){var ze=this._resolveValue(Ie,v[fe]);this._setProperty(ve,ze),Ee=this._getProperty(ve),Ee=Ee&&Ee.clone?Ee.clone():Ee,this._setProperty(ve,Ie)}else Ee=Ie&&Ie.clone?Ie.clone():Ie;V[fe]=Ee}return V},_resolveValue:function(v,k){if(k){if(Array.isArray(k)&&k.length===2){var V=k[0];return V&&V.match&&V.match(/^[+\-\*\/]=/)?this._calculate(v,V[0],k[1]):k}else if(typeof k=="string"){var $=k.match(/^[+\-*/]=(.*)/);if($){var te=JSON.parse($[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(v,k[0],te)}}}return k},_calculate:function(v,k,V){return In.PaperScript.calculateBinary(v,k,V)},_parseKeys:function(v){for(var k={},V=0,$=v.length;V<$;V++){var te=v[V],fe=te.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");k[te]=fe.split("/")}return k},_getProperty:function(v,k){for(var V=this.object,$=0,te=v.length-(k||0);$<te&&V;$++)V=V[v[$]];return V},_setProperty:function(v,k){var V=this._getProperty(v,1);V&&(V[v[v.length-1]]=k)}}),hi={request:function(v){var k=new t.XMLHttpRequest;return k.open((v.method||"get").toUpperCase(),v.url,b.pick(v.async,!0)),v.mimeType&&k.overrideMimeType(v.mimeType),k.onload=function(){var V=k.status;V===0||V===200?v.onLoad&&v.onLoad.call(k,k.responseText):k.onerror()},k.onerror=function(){var V=k.status,$='Could not load "'+v.url+'" (Status: '+V+")";if(v.onError)v.onError($,V);else throw new Error($)},k.send(null)}},en=b.exports.CanvasProvider={canvases:[],getCanvas:function(v,k,V){if(!c)return null;var $,te=!0;typeof v=="object"&&(k=v.height,v=v.width),this.canvases.length?$=this.canvases.pop():($=g.createElement("canvas"),te=!1);var fe=$.getContext("2d",V||{});if(!fe)throw new Error("Canvas "+$+" is unable to provide a 2D context.");return $.width===v&&$.height===k?te&&fe.clearRect(0,0,v+1,k+1):($.width=v,$.height=k),fe.save(),$},getContext:function(v,k,V){var $=this.getCanvas(v,k,V);return $?$.getContext("2d",V||{}):null},release:function(v){var k=v&&v.canvas?v.canvas:v;k&&k.getContext&&(k.getContext("2d").restore(),this.canvases.push(k))}},tr=new function(){var v=Math.min,k=Math.max,V=Math.abs,$,te,fe,ve,Ie,Ee,ze,Qe,He,Ze,Ve;function ft(de,ye,ge){return .2989*de+.587*ye+.114*ge}function nt(de,ye,ge,Ne){var Fe=Ne-ft(de,ye,ge);He=de+Fe,Ze=ye+Fe,Ve=ge+Fe;var Ne=ft(He,Ze,Ve),Xe=v(He,Ze,Ve),Ye=k(He,Ze,Ve);if(Xe<0){var De=Ne-Xe;He=Ne+(He-Ne)*Ne/De,Ze=Ne+(Ze-Ne)*Ne/De,Ve=Ne+(Ve-Ne)*Ne/De}if(Ye>255){var Ue=255-Ne,ht=Ye-Ne;He=Ne+(He-Ne)*Ue/ht,Ze=Ne+(Ze-Ne)*Ue/ht,Ve=Ne+(Ve-Ne)*Ue/ht}}function Me(de,ye,ge){return k(de,ye,ge)-v(de,ye,ge)}function se(de,ye,ge,Pe){var Fe=[de,ye,ge],Ne=k(de,ye,ge),Xe=v(de,ye,ge),Ye;Xe=Xe===de?0:Xe===ye?1:2,Ne=Ne===de?0:Ne===ye?1:2,Ye=v(Xe,Ne)===0?k(Xe,Ne)===1?2:1:0,Fe[Ne]>Fe[Xe]?(Fe[Ye]=(Fe[Ye]-Fe[Xe])*Pe/(Fe[Ne]-Fe[Xe]),Fe[Ne]=Pe):Fe[Ye]=Fe[Ne]=0,Fe[Xe]=0,He=Fe[0],Ze=Fe[1],Ve=Fe[2]}var ne={multiply:function(){He=Ie*$/255,Ze=Ee*te/255,Ve=ze*fe/255},screen:function(){He=Ie+$-Ie*$/255,Ze=Ee+te-Ee*te/255,Ve=ze+fe-ze*fe/255},overlay:function(){He=Ie<128?2*Ie*$/255:255-2*(255-Ie)*(255-$)/255,Ze=Ee<128?2*Ee*te/255:255-2*(255-Ee)*(255-te)/255,Ve=ze<128?2*ze*fe/255:255-2*(255-ze)*(255-fe)/255},"soft-light":function(){var de=$*Ie/255;He=de+Ie*(255-(255-Ie)*(255-$)/255-de)/255,de=te*Ee/255,Ze=de+Ee*(255-(255-Ee)*(255-te)/255-de)/255,de=fe*ze/255,Ve=de+ze*(255-(255-ze)*(255-fe)/255-de)/255},"hard-light":function(){He=$<128?2*$*Ie/255:255-2*(255-$)*(255-Ie)/255,Ze=te<128?2*te*Ee/255:255-2*(255-te)*(255-Ee)/255,Ve=fe<128?2*fe*ze/255:255-2*(255-fe)*(255-ze)/255},"color-dodge":function(){He=Ie===0?0:$===255?255:v(255,255*Ie/(255-$)),Ze=Ee===0?0:te===255?255:v(255,255*Ee/(255-te)),Ve=ze===0?0:fe===255?255:v(255,255*ze/(255-fe))},"color-burn":function(){He=Ie===255?255:$===0?0:k(0,255-(255-Ie)*255/$),Ze=Ee===255?255:te===0?0:k(0,255-(255-Ee)*255/te),Ve=ze===255?255:fe===0?0:k(0,255-(255-ze)*255/fe)},darken:function(){He=Ie<$?Ie:$,Ze=Ee<te?Ee:te,Ve=ze<fe?ze:fe},lighten:function(){He=Ie>$?Ie:$,Ze=Ee>te?Ee:te,Ve=ze>fe?ze:fe},difference:function(){He=Ie-$,He<0&&(He=-He),Ze=Ee-te,Ze<0&&(Ze=-Ze),Ve=ze-fe,Ve<0&&(Ve=-Ve)},exclusion:function(){He=Ie+$*(255-Ie-Ie)/255,Ze=Ee+te*(255-Ee-Ee)/255,Ve=ze+fe*(255-ze-ze)/255},hue:function(){se($,te,fe,Me(Ie,Ee,ze)),nt(He,Ze,Ve,ft(Ie,Ee,ze))},saturation:function(){se(Ie,Ee,ze,Me($,te,fe)),nt(He,Ze,Ve,ft(Ie,Ee,ze))},luminosity:function(){nt(Ie,Ee,ze,ft($,te,fe))},color:function(){nt($,te,fe,ft(Ie,Ee,ze))},add:function(){He=v(Ie+$,255),Ze=v(Ee+te,255),Ve=v(ze+fe,255)},subtract:function(){He=k(Ie-$,0),Ze=k(Ee-te,0),Ve=k(ze-fe,0)},average:function(){He=(Ie+$)/2,Ze=(Ee+te)/2,Ve=(ze+fe)/2},negation:function(){He=255-V(255-$-Ie),Ze=255-V(255-te-Ee),Ve=255-V(255-fe-ze)}},X=this.nativeModes=b.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(de){this[de]=!0},{}),ie=en.getContext(1,1,{willReadFrequently:!0});ie&&(b.each(ne,function(de,ye){var ge=ye==="darken",Pe=!1;ie.save();try{ie.fillStyle=ge?"#300":"#a00",ie.fillRect(0,0,1,1),ie.globalCompositeOperation=ye,ie.globalCompositeOperation===ye&&(ie.fillStyle=ge?"#a00":"#300",ie.fillRect(0,0,1,1),Pe=ie.getImageData(0,0,1,1).data[0]!==ge?170:51)}catch{}ie.restore(),X[ye]=Pe}),en.release(ie)),this.process=function(de,ye,ge,Pe,Fe){var Ne=ye.canvas,Xe=de==="normal";if(Xe||X[de])ge.save(),ge.setTransform(1,0,0,1,0,0),ge.globalAlpha=Pe,Xe||(ge.globalCompositeOperation=de),ge.drawImage(Ne,Fe.x,Fe.y),ge.restore();else{var Ye=ne[de];if(!Ye)return;for(var De=ge.getImageData(Fe.x,Fe.y,Ne.width,Ne.height),Ue=De.data,ht=ye.getImageData(0,0,Ne.width,Ne.height).data,kt=0,o=Ue.length;kt<o;kt+=4){$=ht[kt],Ie=Ue[kt],te=ht[kt+1],Ee=Ue[kt+1],fe=ht[kt+2],ze=Ue[kt+2],ve=ht[kt+3],Qe=Ue[kt+3],Ye();var ke=ve*Pe/255,oi=1-ke;Ue[kt]=ke*He+oi*Ie,Ue[kt+1]=ke*Ze+oi*Ee,Ue[kt+2]=ke*Ve+oi*ze,Ue[kt+3]=ve*Pe+oi*Qe}ge.putImageData(De,Fe.x,Fe.y)}}},Fn=new function(){var v="http://www.w3.org/2000/svg",k="http://www.w3.org/2000/xmlns",V="http://www.w3.org/1999/xlink",$={href:V,xlink:k,xmlns:k+"/","xmlns:xlink":k+"/"};function te(Ie,Ee,ze){return ve(g.createElementNS(v,Ie),Ee,ze)}function fe(Ie,Ee){var ze=$[Ee],Qe=ze?Ie.getAttributeNS(ze,Ee):Ie.getAttribute(Ee);return Qe==="null"?null:Qe}function ve(Ie,Ee,ze){for(var Qe in Ee){var He=Ee[Qe],Ze=$[Qe];typeof He=="number"&&ze&&(He=ze.number(He)),Ze?Ie.setAttributeNS(Ze,Qe,He):Ie.setAttribute(Qe,He)}return Ie}return{svg:v,xmlns:k,xlink:V,create:te,get:fe,set:ve}},Qn=b.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(v,k){return!k&&(v instanceof Rt||v instanceof yt||v instanceof Oi)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(v,k){var V=b.capitalize(k),$=v[2];this[k]={type:v[1],property:k,attribute:v[0],toSVG:$,fromSVG:$&&b.each($,function(te,fe){this[te]=fe},{}),exportFilter:v[3],get:"get"+V,set:"set"+V}},{});new function(){var v;function k(ne,X,ie){var de=new b,ye=ne.getTranslation();if(X){var ge;ne.isInvertible()?(ne=ne._shiftless(),ge=ne._inverseTransform(ye),ye=null):ge=new be,de[ie?"cx":"x"]=ge.x,de[ie?"cy":"y"]=ge.y}if(!ne.isIdentity()){var Pe=ne.decompose();if(Pe){var Fe=[],Ne=Pe.rotation,Xe=Pe.scaling,Ye=Pe.skewing;ye&&!ye.isZero()&&Fe.push("translate("+v.point(ye)+")"),Ne&&Fe.push("rotate("+v.number(Ne)+")"),(!ae.isZero(Xe.x-1)||!ae.isZero(Xe.y-1))&&Fe.push("scale("+v.point(Xe)+")"),Ye.x&&Fe.push("skewX("+v.number(Ye.x)+")"),Ye.y&&Fe.push("skewY("+v.number(Ye.y)+")"),de.transform=Fe.join(" ")}else de.transform="matrix("+ne.getValues().join(",")+")"}return de}function V(ne,X){for(var ie=k(ne._matrix),de=ne._children,ye=Fn.create("g",ie,v),ge=0,Pe=de.length;ge<Pe;ge++){var Fe=de[ge],Ne=Me(Fe,X);if(Ne)if(Fe.isClipMask()){var Xe=Fn.create("clipPath");Xe.appendChild(Ne),ft(Fe,Xe,"clip"),Fn.set(ye,{"clip-path":"url(#"+Xe.id+")"})}else ye.appendChild(Ne)}return ye}function $(ne,X){var ie=k(ne._matrix,!0),de=ne.getSize(),ye=ne.getImage();return ie.x-=de.width/2,ie.y-=de.height/2,ie.width=de.width,ie.height=de.height,ie.href=X.embedImages==!1&&ye&&ye.src||ne.toDataURL(),Fn.create("image",ie,v)}function te(ne,X){var ie=X.matchShapes;if(ie){var de=ne.toShape(!1);if(de)return fe(de)}var ye=ne._segments,ge=ye.length,Pe,Fe=k(ne._matrix);if(ie&&ge>=2&&!ne.hasHandles())if(ge>2){Pe=ne._closed?"polygon":"polyline";for(var Ne=[],Xe=0;Xe<ge;Xe++)Ne.push(v.point(ye[Xe]._point));Fe.points=Ne.join(" ")}else{Pe="line";var Ye=ye[0]._point,De=ye[1]._point;Fe.set({x1:Ye.x,y1:Ye.y,x2:De.x,y2:De.y})}else Pe="path",Fe.d=ne.getPathData(null,X.precision);return Fn.create(Pe,Fe,v)}function fe(ne){var X=ne._type,ie=ne._radius,de=k(ne._matrix,!0,X!=="rectangle");if(X==="rectangle"){X="rect";var ye=ne._size,ge=ye.width,Pe=ye.height;de.x-=ge/2,de.y-=Pe/2,de.width=ge,de.height=Pe,ie.isZero()&&(ie=null)}return ie&&(X==="circle"?de.r=ie:(de.rx=ie.width,de.ry=ie.height)),Fn.create(X,de,v)}function ve(ne,X){var ie=k(ne._matrix),de=ne.getPathData(null,X.precision);return de&&(ie.d=de),Fn.create("path",ie,v)}function Ie(ne,X){var ie=k(ne._matrix,!0),de=ne._definition,ye=Ve(de,"symbol"),ge=de._item,Pe=ge.getStrokeBounds();return ye||(ye=Fn.create("symbol",{viewBox:v.rectangle(Pe)}),ye.appendChild(Me(ge,X)),ft(de,ye,"symbol")),ie.href="#"+ye.id,ie.x+=Pe.x,ie.y+=Pe.y,ie.width=Pe.width,ie.height=Pe.height,ie.overflow="visible",Fn.create("use",ie,v)}function Ee(ne){var X=Ve(ne,"color");if(!X){var ie=ne.getGradient(),de=ie._radial,ye=ne.getOrigin(),ge=ne.getDestination(),Pe;if(de){Pe={cx:ye.x,cy:ye.y,r:ye.getDistance(ge)};var Fe=ne.getHighlight();Fe&&(Pe.fx=Fe.x,Pe.fy=Fe.y)}else Pe={x1:ye.x,y1:ye.y,x2:ge.x,y2:ge.y};Pe.gradientUnits="userSpaceOnUse",X=Fn.create((de?"radial":"linear")+"Gradient",Pe,v);for(var Ne=ie._stops,Xe=0,Ye=Ne.length;Xe<Ye;Xe++){var De=Ne[Xe],Ue=De._color,ht=Ue.getAlpha(),kt=De._offset;Pe={offset:kt??Xe/(Ye-1)},Ue&&(Pe["stop-color"]=Ue.toCSS(!0)),ht<1&&(Pe["stop-opacity"]=ht),X.appendChild(Fn.create("stop",Pe,v))}ft(ne,X,"color")}return"url(#"+X.id+")"}function ze(ne){var X=Fn.create("text",k(ne._matrix,!0),v);return X.textContent=ne._content,X}var Qe={Group:V,Layer:V,Raster:$,Path:te,Shape:fe,CompoundPath:ve,SymbolItem:Ie,PointText:ze};function He(ne,X,ie){var de={},ye=!ie&&ne.getParent(),ge=[];return ne._name!=null&&(de.id=ne._name),b.each(Qn,function(Pe){var Fe=Pe.get,Ne=Pe.type,Xe=ne[Fe]();if(Pe.exportFilter?Pe.exportFilter(ne,Xe):!ye||!b.equals(ye[Fe](),Xe)){if(Ne==="color"&&Xe!=null){var Ye=Xe.getAlpha();Ye<1&&(de[Pe.attribute+"-opacity"]=Ye)}Ne==="style"?ge.push(Pe.attribute+": "+Xe):de[Pe.attribute]=Xe==null?"none":Ne==="color"?Xe.gradient?Ee(Xe):Xe.toCSS(!0):Ne==="array"?Xe.join(","):Ne==="lookup"?Pe.toSVG[Xe]:Xe}}),ge.length&&(de.style=ge.join(";")),de.opacity===1&&delete de.opacity,ne._visible||(de.visibility="hidden"),Fn.set(X,de,v)}var Ze;function Ve(ne,X){return Ze||(Ze={ids:{},svgs:{}}),ne&&Ze.svgs[X+"-"+(ne._id||ne.__id||(ne.__id=ue.get("svg")))]}function ft(ne,X,ie){Ze||Ve();var de=Ze.ids[ie]=(Ze.ids[ie]||0)+1;X.id=ie+"-"+de,Ze.svgs[ie+"-"+(ne._id||ne.__id)]=X}function nt(ne,X){var ie=ne,de=null;if(Ze){ie=ne.nodeName.toLowerCase()==="svg"&&ne;for(var ye in Ze.svgs)de||(ie||(ie=Fn.create("svg"),ie.appendChild(ne)),de=ie.insertBefore(Fn.create("defs"),ie.firstChild)),de.appendChild(Ze.svgs[ye]);Ze=null}return X.asString?new t.XMLSerializer().serializeToString(ie):ie}function Me(ne,X,ie){var de=Qe[ne._class],ye=de&&de(ne,X);if(ye){var ge=X.onExport;ge&&(ye=ge(ne,ye,X)||ye);var Pe=JSON.stringify(ne._data);Pe&&Pe!=="{}"&&Pe!=="null"&&ye.setAttribute("data-paper-data",Pe)}return ye&&He(ne,ye,ie)}function se(ne){return ne||(ne={}),v=new he(ne.precision),ne}Ge.inject({exportSVG:function(ne){return ne=se(ne),nt(Me(this,ne,!0),ne)}}),zt.inject({exportSVG:function(ne){ne=se(ne);var X=this._children,ie=this.getView(),de=b.pick(ne.bounds,"view"),ye=ne.matrix||de==="view"&&ie._matrix,ge=ye&&Tt.read([ye]),Pe=de==="view"?new lt([0,0],ie.getViewSize()):de==="content"?Ge._getBounds(X,ge,{stroke:!0}).rect:lt.read([de],0,{readNull:!0}),Fe={version:"1.1",xmlns:Fn.svg,"xmlns:xlink":Fn.xlink};Pe&&(Fe.width=Pe.width,Fe.height=Pe.height,(Pe.x||Pe.x===0||Pe.y||Pe.y===0)&&(Fe.viewBox=v.rectangle(Pe)));var Ne=Fn.create("svg",Fe,v),Xe=Ne;ge&&!ge.isIdentity()&&(Xe=Ne.appendChild(Fn.create("g",k(ge),v)));for(var Ye=0,De=X.length;Ye<De;Ye++)Xe.appendChild(Me(X[Ye],ne,!0));return nt(Ne,ne)}})},new function(){var v={},k;function V(X,ie,de,ye,ge,Pe){var Fe=Fn.get(X,ie)||Pe,Ne=Fe==null?ye?null:de?"":0:de?Fe:parseFloat(Fe);return/%\s*$/.test(Fe)?Ne/100*(ge?1:k[/x|^width/.test(ie)?"width":"height"]):Ne}function $(X,ie,de,ye,ge,Pe,Fe){return ie=V(X,ie||"x",!1,ye,ge,Pe),de=V(X,de||"y",!1,ye,ge,Fe),ye&&(ie==null||de==null)?null:new be(ie,de)}function te(X,ie,de,ye,ge){return ie=V(X,ie||"width",!1,ye,ge),de=V(X,de||"height",!1,ye,ge),ye&&(ie==null||de==null)?null:new ot(ie,de)}function fe(X,ie,de){return X==="none"?null:ie==="number"?parseFloat(X):ie==="array"?X?X.split(/[\s,]+/g).map(parseFloat):[]:ie==="color"?Me(X)||X:ie==="lookup"?de[X]:X}function ve(X,ie,de,ye){var ge=X.childNodes,Pe=ie==="clippath",Fe=ie==="defs",Ne=new Xt,Xe=Ne._project,Ye=Xe._currentStyle,De=[];if(!Pe&&!Fe&&(Ne=nt(Ne,X,ye),Xe._currentStyle=Ne._style.clone()),ye)for(var Ue=X.querySelectorAll("defs"),ht=0,kt=Ue.length;ht<kt;ht++)se(Ue[ht],de,!1);for(var ht=0,kt=ge.length;ht<kt;ht++){var o=ge[ht],ke;o.nodeType===1&&!/^defs$/i.test(o.nodeName)&&(ke=se(o,de,!1))&&!(ke instanceof bt)&&De.push(ke)}return Ne.addChildren(De),Pe&&(Ne=nt(Ne.reduce(),X,ye)),Xe._currentStyle=Ye,(Pe||Fe)&&(Ne.remove(),Ne=null),Ne}function Ie(X,ie){for(var de=X.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),ye=[],ge=0,Pe=de.length;ge<Pe;ge+=2)ye.push(new be(parseFloat(de[ge]),parseFloat(de[ge+1])));var Fe=new Ot(ye);return ie==="polygon"&&Fe.closePath(),Fe}function Ee(X){return Rt.create(X.getAttribute("d"))}function ze(X,ie){var de=(V(X,"href",!0)||"").substring(1),ye=ie==="radialgradient",ge;if(de)ge=v[de].getGradient(),ge._radial^ye&&(ge=ge.clone(),ge._radial=ye);else{for(var Pe=X.childNodes,Fe=[],Ne=0,Xe=Pe.length;Ne<Xe;Ne++){var Ye=Pe[Ne];Ye.nodeType===1&&Fe.push(nt(new nn,Ye))}ge=new Ni(Fe,ye)}var De,Ue,ht,kt=V(X,"gradientUnits",!0)!=="userSpaceOnUse";ye?(De=$(X,"cx","cy",!1,kt,"50%","50%"),Ue=De.add(V(X,"r",!1,!1,kt,"50%"),0),ht=$(X,"fx","fy",!0,kt)):(De=$(X,"x1","y1",!1,kt,"0%","0%"),Ue=$(X,"x2","y2",!1,kt,"100%","0%"));var o=nt(new qi(ge,De,Ue,ht),X);return o._scaleToBounds=kt,null}var Qe={"#document":function(X,ie,de,ye){for(var ge=X.childNodes,Pe=0,Fe=ge.length;Pe<Fe;Pe++){var Ne=ge[Pe];if(Ne.nodeType===1)return se(Ne,de,ye)}},g:ve,svg:ve,clippath:ve,polygon:Ie,polyline:Ie,path:Ee,lineargradient:ze,radialgradient:ze,image:function(X){var ie=new pt(V(X,"href",!0));return ie.on("load",function(){var de=te(X);this.setSize(de);var ye=$(X).add(de.divide(2));this._matrix.append(new Tt().translate(ye))}),ie},symbol:function(X,ie,de,ye){return new bt(ve(X,ie,de,ye),!0)},defs:ve,use:function(X){var ie=(V(X,"href",!0)||"").substring(1),de=v[ie],ye=$(X);return de?de instanceof bt?de.place(ye):de.clone().translate(ye):null},circle:function(X){return new yt.Circle($(X,"cx","cy"),V(X,"r"))},ellipse:function(X){return new yt.Ellipse({center:$(X,"cx","cy"),radius:te(X,"rx","ry")})},rect:function(X){return new yt.Rectangle(new lt($(X),te(X)),te(X,"rx","ry"))},line:function(X){return new Ot.Line($(X,"x1","y1"),$(X,"x2","y2"))},text:function(X){var ie=new tn($(X).add($(X,"dx","dy")));return ie.setContent(X.textContent.trim()||""),ie},switch:ve};function He(X,ie,de,ye){if(X.transform){for(var ge=(ye.getAttribute(de)||"").split(/\)\s*/g),Pe=new Tt,Fe=0,Ne=ge.length;Fe<Ne;Fe++){var Xe=ge[Fe];if(!Xe)break;for(var Ye=Xe.split(/\(\s*/),De=Ye[0],Ue=Ye[1].split(/[\s,]+/g),ht=0,kt=Ue.length;ht<kt;ht++)Ue[ht]=parseFloat(Ue[ht]);switch(De){case"matrix":Pe.append(new Tt(Ue[0],Ue[1],Ue[2],Ue[3],Ue[4],Ue[5]));break;case"rotate":Pe.rotate(Ue[0],Ue[1]||0,Ue[2]||0);break;case"translate":Pe.translate(Ue[0],Ue[1]||0);break;case"scale":Pe.scale(Ue);break;case"skewX":Pe.skew(Ue[0],0);break;case"skewY":Pe.skew(0,Ue[0]);break}}X.transform(Pe)}}function Ze(X,ie,de){var ye=de==="fill-opacity"?"getFillColor":"getStrokeColor",ge=X[ye]&&X[ye]();ge&&ge.setAlpha(parseFloat(ie))}var Ve=b.set(b.each(Qn,function(X){this[X.attribute]=function(ie,de){if(ie[X.set]&&(ie[X.set](fe(de,X.type,X.fromSVG)),X.type==="color")){var ye=ie[X.get]();if(ye&&ye._scaleToBounds){var ge=ie.getBounds();ye.transform(new Tt().translate(ge.getPoint()).scale(ge.getSize()))}}}},{}),{id:function(X,ie){v[ie]=X,X.setName&&X.setName(ie)},"clip-path":function(X,ie){var de=Me(ie);if(de)if(de=de.clone(),de.setClipMask(!0),X instanceof Xt)X.insertChild(0,de);else return new Xt(de,X)},gradientTransform:He,transform:He,"fill-opacity":Ze,"stroke-opacity":Ze,visibility:function(X,ie){X.setVisible&&X.setVisible(ie==="visible")},display:function(X,ie){X.setVisible&&X.setVisible(ie!==null)},"stop-color":function(X,ie){X.setColor&&X.setColor(ie)},"stop-opacity":function(X,ie){X._color&&X._color.setAlpha(parseFloat(ie))},offset:function(X,ie){if(X.setOffset){var de=ie.match(/(.*)%$/);X.setOffset(de?de[1]/100:parseFloat(ie))}},viewBox:function(X,ie,de,ye,ge){var Pe=new lt(fe(ie,"array")),Fe=te(ye,null,null,!0),Ne,Xe;if(X instanceof Xt){var Ye=Fe?Fe.divide(Pe.getSize()):1,Xe=new Tt().scale(Ye).translate(Pe.getPoint().negate());Ne=X}else X instanceof bt&&(Fe&&Pe.setSize(Fe),Ne=X._item);if(Ne){if(ft(ye,"overflow",ge)!=="visible"){var De=new yt.Rectangle(Pe);De.setClipMask(!0),Ne.addChild(De)}Xe&&Ne.transform(Xe)}}});function ft(X,ie,de){var ye=X.attributes[ie],ge=ye&&ye.value;if(!ge&&X.style){var Pe=b.camelize(ie);ge=X.style[Pe],!ge&&de.node[Pe]!==de.parent[Pe]&&(ge=de.node[Pe])}return ge?ge==="none"?null:ge:n}function nt(X,ie,de){var ye=ie.parentNode,ge={node:Ci.getStyles(ie)||{},parent:!de&&!/^defs$/i.test(ye.tagName)&&Ci.getStyles(ye)||{}};return b.each(Ve,function(Pe,Fe){var Ne=ft(ie,Fe,ge);X=Ne!==n&&Pe(X,Ne,Fe,ie,ge)||X}),X}function Me(X){var ie=X&&X.match(/\((?:["'#]*)([^"')]+)/),de=ie&&ie[1],ye=de&&v[c?de.replace(c.location.href.split("#")[0]+"#",""):de];return ye&&ye._scaleToBounds&&(ye=ye.clone(),ye._scaleToBounds=!0),ye}function se(X,ie,de){var ye=X.nodeName.toLowerCase(),ge=ye!=="#document",Pe=g.body,Fe,Ne,Xe;de&&ge&&(k=In.getView().getSize(),k=te(X,null,null,!0)||k,Fe=Fn.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),Ne=X.parentNode,Xe=X.nextSibling,Fe.appendChild(X),Pe.appendChild(Fe));var Ye=In.settings,De=Ye.applyMatrix,Ue=Ye.insertItems;Ye.applyMatrix=!1,Ye.insertItems=!1;var ht=Qe[ye],kt=ht&&ht(X,ye,ie,de)||null;if(Ye.insertItems=Ue,Ye.applyMatrix=De,kt){ge&&!(kt instanceof Xt)&&(kt=nt(kt,X,de));var o=ie.onImport,ke=ge&&X.getAttribute("data-paper-data");o&&(kt=o(X,kt,ie)||kt),ie.expandShapes&&kt instanceof yt&&(kt.remove(),kt=kt.toPath()),ke&&(kt._data=JSON.parse(ke))}return Fe&&(Pe.removeChild(Fe),Ne&&(Xe?Ne.insertBefore(X,Xe):Ne.appendChild(X))),de&&(v={},kt&&b.pick(ie.applyMatrix,De)&&kt.matrix.apply(!0,!0)),kt}function ne(X,ie,de){if(!X)return null;ie=typeof ie=="function"?{onLoad:ie}:ie||{};var ye=In,ge=null;function Pe(Ye){try{var De=typeof Ye=="object"?Ye:new t.DOMParser().parseFromString(Ye.trim(),"image/svg+xml");if(!De.nodeName)throw De=null,new Error("Unsupported SVG source: "+X);In=ye,ge=se(De,ie,!0),(!ie||ie.insert!==!1)&&de._insertItem(n,ge);var Ue=ie.onLoad;Ue&&Ue(ge,Ye)}catch(ht){Fe(ht)}}function Fe(Ye,De){var Ue=ie.onError;if(Ue)Ue(Ye,De);else throw new Error(Ye)}if(typeof X=="string"&&!/^[\s\S]*</.test(X)){var Ne=g.getElementById(X);Ne?Pe(Ne):hi.request({url:X,async:!0,onLoad:Pe,onError:Fe})}else if(typeof File<"u"&&X instanceof File){var Xe=new FileReader;return Xe.onload=function(){Pe(Xe.result)},Xe.onerror=function(){Fe(Xe.error)},Xe.readAsText(X)}else Pe(X);return ge}Ge.inject({importSVG:function(X,ie){return ne(X,ie,this)}}),zt.inject({importSVG:function(X,ie){return this.activate(),ne(X,ie,this)}})},b.exports.PaperScript=(function(){var v=this,k=v.acorn;if(!k&&typeof AT<"u")try{k=pT()}catch{}if(!k){var V,$;k=V=$={},function(nt,Me){if(typeof V=="object"&&typeof $=="object")return Me(V);if(typeof n=="function"&&n.amd)return n(["exports"],Me);Me(nt.acorn||(nt.acorn={}))}(this,function(nt){nt.version="0.5.0";var Me,se,ne,X;nt.parse=function(Ft,ti){return se=String(Ft),ne=se.length,de(ti),mu(),Tl(Me.program)};var ie=nt.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function de(Ft){Me=Ft||{};for(var ti in ie)Object.prototype.hasOwnProperty.call(Me,ti)||(Me[ti]=ie[ti]);X=Me.sourceFile||null}var ye=nt.getLineInfo=function(Ft,ti){for(var xi=1,Fi=0;;){Ha.lastIndex=Fi;var Ln=Ha.exec(Ft);if(Ln&&Ln.index<ti)++xi,Fi=Ln.index+Ln[0].length;else break}return{line:xi,column:ti-Fi}};nt.tokenize=function(Ft,ti){se=String(Ft),ne=se.length,de(ti),mu();var xi={};function Fi(Ln){return ke=Fe,ja(Ln),xi.start=Pe,xi.end=Fe,xi.startLoc=Ne,xi.endLoc=Xe,xi.type=Ye,xi.value=De,xi}return Fi.jumpTo=function(Ln,Hn){if(ge=Ln,Me.locations){ht=1,kt=Ha.lastIndex=0;for(var lr;(lr=Ha.exec(se))&&lr.index<Ln;)++ht,kt=lr.index+lr[0].length}Ue=Hn,no()},Fi};var ge,Pe,Fe,Ne,Xe,Ye,De,Ue,ht,kt,o,ke,oi,di,Ai,Jt;function li(Ft,ti){var xi=ye(se,Ft);ti+=" ("+xi.line+":"+xi.column+")";var Fi=new SyntaxError(ti);throw Fi.pos=Ft,Fi.loc=xi,Fi.raisedAt=ge,Fi}var zi=[],vi={type:"num"},wi={type:"regexp"},$t={type:"string"},vn={type:"name"},or={type:"eof"},mn={keyword:"break"},qn={keyword:"case",beforeExpr:!0},jr={keyword:"catch"},Hi={keyword:"continue"},ur={keyword:"debugger"},On={keyword:"default"},Qt={keyword:"do",isLoop:!0},Yi={keyword:"else",beforeExpr:!0},Ut={keyword:"finally"},Tn={keyword:"for",isLoop:!0},cr={keyword:"function"},Ns={keyword:"if"},Ur={keyword:"return",beforeExpr:!0},Vt={keyword:"switch"},hr={keyword:"throw",beforeExpr:!0},Lt={keyword:"try"},Fr={keyword:"var"},Vs={keyword:"while",isLoop:!0},ua={keyword:"with"},Pr={keyword:"new",beforeExpr:!0},Fa={keyword:"this"},zo={keyword:"null",atomValue:null},Oa={keyword:"true",atomValue:!0},Ys={keyword:"false",atomValue:!1},Zn={keyword:"in",binop:7,beforeExpr:!0},aa={break:mn,case:qn,catch:jr,continue:Hi,debugger:ur,default:On,do:Qt,else:Yi,finally:Ut,for:Tn,function:cr,if:Ns,return:Ur,switch:Vt,throw:hr,try:Lt,var:Fr,while:Vs,with:ua,null:zo,true:Oa,false:Ys,new:Pr,in:Zn,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Fa,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ls={type:"[",beforeExpr:!0},Na={type:"]"},al={type:"{",beforeExpr:!0},ol={type:"}"},to={type:"(",beforeExpr:!0},Va={type:")"},N={type:",",beforeExpr:!0},xe={type:";",beforeExpr:!0},it={type:":",beforeExpr:!0},It={type:"."},Wt={type:"?",beforeExpr:!0},Ii={binop:10,beforeExpr:!0},Li={isAssign:!0,beforeExpr:!0},cn={isAssign:!0,beforeExpr:!0},fn={postfix:!0,prefix:!0,isUpdate:!0},sr={prefix:!0,beforeExpr:!0},Ar={binop:1,beforeExpr:!0},Or={binop:2,beforeExpr:!0},Ua={binop:3,beforeExpr:!0},Ga={binop:4,beforeExpr:!0},qa={binop:5,beforeExpr:!0},pl={binop:6,beforeExpr:!0},Gr={binop:7,beforeExpr:!0},nr={binop:8,beforeExpr:!0},wr={binop:9,prefix:!0,beforeExpr:!0},Dr={binop:10,beforeExpr:!0};nt.tokTypes={bracketL:ls,bracketR:Na,braceL:al,braceR:ol,parenL:to,parenR:Va,comma:N,semi:xe,colon:it,dot:It,question:Wt,slash:Ii,eq:Li,name:vn,eof:or,num:vi,regexp:wi,string:$t};for(var js in aa)nt.tokTypes["_"+js]=aa[js];function vr(Ft){Ft=Ft.split(" ");var ti="",xi=[];e:for(var Fi=0;Fi<Ft.length;++Fi){for(var Ln=0;Ln<xi.length;++Ln)if(xi[Ln][0].length==Ft[Fi].length){xi[Ln].push(Ft[Fi]);continue e}xi.push([Ft[Fi]])}function Hn(Yn){if(Yn.length==1)return ti+="return str === "+JSON.stringify(Yn[0])+";";ti+="switch(str){";for(var qs=0;qs<Yn.length;++qs)ti+="case "+JSON.stringify(Yn[qs])+":";ti+="return true}return false;"}if(xi.length>3){xi.sort(function(Yn,qs){return qs.length-Yn.length}),ti+="switch(str.length){";for(var Fi=0;Fi<xi.length;++Fi){var lr=xi[Fi];ti+="case "+lr[0].length+":",Hn(lr)}ti+="}"}else Hn(Ft);return new Function("str",ti)}var Ks=vr("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Lr=vr("class enum extends super const export import"),So=vr("implements interface let package private protected public static yield"),Zo=vr("eval arguments"),Ls=vr("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Il=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ao="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Qo="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",ca=new RegExp("["+Ao+"]"),$s=new RegExp("["+Ao+Qo+"]"),El=/[\n\r\u2028\u2029]/,Ha=/\r\n|[\n\r\u2028\u2029]/g,Ta=nt.isIdentifierStart=function(Ft){return Ft<65?Ft===36:Ft<91?!0:Ft<97?Ft===95:Ft<123?!0:Ft>=170&&ca.test(String.fromCharCode(Ft))},ml=nt.isIdentifierChar=function(Ft){return Ft<48?Ft===36:Ft<58?!0:Ft<65?!1:Ft<91?!0:Ft<97?Ft===95:Ft<123?!0:Ft>=170&&$s.test(String.fromCharCode(Ft))};function Cl(){this.line=ht,this.column=ge-kt}function mu(){ht=1,ge=kt=0,Ue=!0,no()}function us(Ft,ti){Fe=ge,Me.locations&&(Xe=new Cl),Ye=Ft,no(),De=ti,Ue=Ft.beforeExpr}function rc(){var Ft=Me.onComment&&Me.locations&&new Cl,ti=ge,xi=se.indexOf("*/",ge+=2);if(xi===-1&&li(ge-2,"Unterminated comment"),ge=xi+2,Me.locations){Ha.lastIndex=ti;for(var Fi;(Fi=Ha.exec(se))&&Fi.index<ge;)++ht,kt=Fi.index+Fi[0].length}Me.onComment&&Me.onComment(!0,se.slice(ti+2,xi),ti,ge,Ft,Me.locations&&new Cl)}function io(){for(var Ft=ge,ti=Me.onComment&&Me.locations&&new Cl,xi=se.charCodeAt(ge+=2);ge<ne&&xi!==10&&xi!==13&&xi!==8232&&xi!==8233;)++ge,xi=se.charCodeAt(ge);Me.onComment&&Me.onComment(!1,se.slice(Ft+2,ge),Ft,ge,ti,Me.locations&&new Cl)}function no(){for(;ge<ne;){var Ft=se.charCodeAt(ge);if(Ft===32)++ge;else if(Ft===13){++ge;var ti=se.charCodeAt(ge);ti===10&&++ge,Me.locations&&(++ht,kt=ge)}else if(Ft===10||Ft===8232||Ft===8233)++ge,Me.locations&&(++ht,kt=ge);else if(Ft>8&&Ft<14)++ge;else if(Ft===47){var ti=se.charCodeAt(ge+1);if(ti===42)rc();else if(ti===47)io();else break}else if(Ft===160)++ge;else if(Ft>=5760&&Il.test(String.fromCharCode(Ft)))++ge;else break}}function ql(){var Ft=se.charCodeAt(ge+1);return Ft>=48&&Ft<=57?Ko(!0):(++ge,us(It))}function Ro(){var Ft=se.charCodeAt(ge+1);return Ue?(++ge,gu()):Ft===61?Cs(cn,2):Cs(Ii,1)}function Wo(){var Ft=se.charCodeAt(ge+1);return Ft===61?Cs(cn,2):Cs(Dr,1)}function Io(Ft){var ti=se.charCodeAt(ge+1);return ti===Ft?Cs(Ft===124?Ar:Or,2):ti===61?Cs(cn,2):Cs(Ft===124?Ua:qa,1)}function Us(){var Ft=se.charCodeAt(ge+1);return Ft===61?Cs(cn,2):Cs(Ga,1)}function Xo(Ft){var ti=se.charCodeAt(ge+1);return ti===Ft?ti==45&&se.charCodeAt(ge+2)==62&&El.test(se.slice(ke,ge))?(ge+=3,io(),no(),ja()):Cs(fn,2):ti===61?Cs(cn,2):Cs(wr,1)}function Yo(Ft){var ti=se.charCodeAt(ge+1),xi=1;return ti===Ft?(xi=Ft===62&&se.charCodeAt(ge+2)===62?3:2,se.charCodeAt(ge+xi)===61?Cs(cn,xi+1):Cs(nr,xi)):ti==33&&Ft==60&&se.charCodeAt(ge+2)==45&&se.charCodeAt(ge+3)==45?(ge+=4,io(),no(),ja()):(ti===61&&(xi=se.charCodeAt(ge+2)===61?3:2),Cs(Gr,xi))}function $o(Ft){var ti=se.charCodeAt(ge+1);return ti===61?Cs(pl,se.charCodeAt(ge+2)===61?3:2):Cs(Ft===61?Li:sr,1)}function ba(Ft){switch(Ft){case 46:return ql();case 40:return++ge,us(to);case 41:return++ge,us(Va);case 59:return++ge,us(xe);case 44:return++ge,us(N);case 91:return++ge,us(ls);case 93:return++ge,us(Na);case 123:return++ge,us(al);case 125:return++ge,us(ol);case 58:return++ge,us(it);case 63:return++ge,us(Wt);case 48:var ti=se.charCodeAt(ge+1);if(ti===120||ti===88)return Xn();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Ko(!1);case 34:case 39:return Br(Ft);case 47:return Ro();case 37:case 42:return Wo();case 124:case 38:return Io(Ft);case 94:return Us();case 43:case 45:return Xo(Ft);case 60:case 62:return Yo(Ft);case 61:case 33:return $o(Ft);case 126:return Cs(sr,1)}return!1}function ja(Ft){if(Ft?ge=Pe+1:Pe=ge,Me.locations&&(Ne=new Cl),Ft)return gu();if(ge>=ne)return us(or);var ti=se.charCodeAt(ge);if(Ta(ti)||ti===92)return Eo();var xi=ba(ti);if(xi===!1){var Fi=String.fromCharCode(ti);if(Fi==="\\"||ca.test(Fi))return Eo();li(ge,"Unexpected character '"+Fi+"'")}return xi}function Cs(Ft,ti){var xi=se.slice(ge,ge+ti);ge+=ti,us(Ft,xi)}function gu(){for(var Ln="",Ft,ti,xi=ge;;){ge>=ne&&li(xi,"Unterminated regular expression");var Fi=se.charAt(ge);if(El.test(Fi)&&li(xi,"Unterminated regular expression"),Ft)Ft=!1;else{if(Fi==="[")ti=!0;else if(Fi==="]"&&ti)ti=!1;else if(Fi==="/"&&!ti)break;Ft=Fi==="\\"}++ge}var Ln=se.slice(xi,ge);++ge;var Hn=fr();Hn&&!/^[gmsiy]*$/.test(Hn)&&li(xi,"Invalid regexp flag");try{var lr=new RegExp(Ln,Hn)}catch(Yn){Yn instanceof SyntaxError&&li(xi,Yn.message),li(Yn)}return us(wi,lr)}function Sr(Ft,ti){for(var xi=ge,Fi=0,Ln=0,Hn=ti??1/0;Ln<Hn;++Ln){var lr=se.charCodeAt(ge),Yn;if(lr>=97?Yn=lr-97+10:lr>=65?Yn=lr-65+10:lr>=48&&lr<=57?Yn=lr-48:Yn=1/0,Yn>=Ft)break;++ge,Fi=Fi*Ft+Yn}return ge===xi||ti!=null&&ge-xi!==ti?null:Fi}function Xn(){ge+=2;var Ft=Sr(16);return Ft==null&&li(Pe+2,"Expected hexadecimal number"),Ta(se.charCodeAt(ge))&&li(ge,"Identifier directly after number"),us(vi,Ft)}function Ko(Ft){var ti=ge,xi=!1,Fi=se.charCodeAt(ge)===48;!Ft&&Sr(10)===null&&li(ti,"Invalid number"),se.charCodeAt(ge)===46&&(++ge,Sr(10),xi=!0);var Ln=se.charCodeAt(ge);(Ln===69||Ln===101)&&(Ln=se.charCodeAt(++ge),(Ln===43||Ln===45)&&++ge,Sr(10)===null&&li(ti,"Invalid number"),xi=!0),Ta(se.charCodeAt(ge))&&li(ge,"Identifier directly after number");var Hn=se.slice(ti,ge),lr;return xi?lr=parseFloat(Hn):!Fi||Hn.length===1?lr=parseInt(Hn,10):/[89]/.test(Hn)||Jt?li(ti,"Invalid number"):lr=parseInt(Hn,8),us(vi,lr)}function Br(Ft){ge++;for(var ti="";;){ge>=ne&&li(Pe,"Unterminated string constant");var xi=se.charCodeAt(ge);if(xi===Ft)return++ge,us($t,ti);if(xi===92){xi=se.charCodeAt(++ge);var Fi=/^[0-7]+/.exec(se.slice(ge,ge+3));for(Fi&&(Fi=Fi[0]);Fi&&parseInt(Fi,8)>255;)Fi=Fi.slice(0,-1);if(Fi==="0"&&(Fi=null),++ge,Fi)Jt&&li(ge-2,"Octal literal in strict mode"),ti+=String.fromCharCode(parseInt(Fi,8)),ge+=Fi.length-1;else switch(xi){case 110:ti+=`
`;break;case 114:ti+="\r";break;case 120:ti+=String.fromCharCode(Za(2));break;case 117:ti+=String.fromCharCode(Za(4));break;case 85:ti+=String.fromCharCode(Za(8));break;case 116:ti+="	";break;case 98:ti+="\b";break;case 118:ti+="\v";break;case 102:ti+="\f";break;case 48:ti+="\0";break;case 13:se.charCodeAt(ge)===10&&++ge;case 10:Me.locations&&(kt=ge,++ht);break;default:ti+=String.fromCharCode(xi);break}}else(xi===13||xi===10||xi===8232||xi===8233)&&li(Pe,"Unterminated string constant"),ti+=String.fromCharCode(xi),++ge}}function Za(Ft){var ti=Sr(16,Ft);return ti===null&&li(Pe,"Bad character escape sequence"),ti}var Jr;function fr(){Jr=!1;for(var Ft,ti=!0,xi=ge;;){var Fi=se.charCodeAt(ge);if(ml(Fi))Jr&&(Ft+=se.charAt(ge)),++ge;else if(Fi===92){Jr||(Ft=se.slice(xi,ge)),Jr=!0,se.charCodeAt(++ge)!=117&&li(ge,"Expecting Unicode escape sequence \\uXXXX"),++ge;var Ln=Za(4),Hn=String.fromCharCode(Ln);Hn||li(ge-1,"Invalid Unicode escape"),(ti?Ta(Ln):ml(Ln))||li(ge-4,"Invalid Unicode escape"),Ft+=Hn}else break;ti=!1}return Jr?Ft:se.slice(xi,ge)}function Eo(){var Ft=fr(),ti=vn;return!Jr&&Ls(Ft)&&(ti=aa[Ft]),us(ti,Ft)}function Un(){o=Pe,ke=Fe,oi=Xe,ja()}function Ol(Ft){if(Jt=Ft,ge=Pe,Me.locations)for(;ge<kt;)kt=se.lastIndexOf(`
`,kt-2)+1,--ht;no(),ja()}function es(){this.type=null,this.start=Pe,this.end=null}function Zr(){this.start=Ne,this.end=null,X!==null&&(this.source=X)}function Ts(){var Ft=new es;return Me.locations&&(Ft.loc=new Zr),Me.directSourceFile&&(Ft.sourceFile=Me.directSourceFile),Me.ranges&&(Ft.range=[Pe,0]),Ft}function kr(Ft){var ti=new es;return ti.start=Ft.start,Me.locations&&(ti.loc=new Zr,ti.loc.start=Ft.loc.start),Me.ranges&&(ti.range=[Ft.range[0],0]),ti}function rr(Ft,ti){return Ft.type=ti,Ft.end=ke,Me.locations&&(Ft.loc.end=oi),Me.ranges&&(Ft.range[1]=ke),Ft}function ll(Ft){return Me.ecmaVersion>=5&&Ft.type==="ExpressionStatement"&&Ft.expression.type==="Literal"&&Ft.expression.value==="use strict"}function Yr(Ft){if(Ye===Ft)return Un(),!0}function Co(){return!Me.strictSemicolons&&(Ye===or||Ye===ol||El.test(se.slice(ke,Pe)))}function ul(){!Yr(xe)&&!Co()&&hs()}function Qr(Ft){Ye===Ft?Un():hs()}function hs(){li(Pe,"Unexpected token")}function wa(Ft){Ft.type!=="Identifier"&&Ft.type!=="MemberExpression"&&li(Ft.start,"Assigning to rvalue"),Jt&&Ft.type==="Identifier"&&Zo(Ft.name)&&li(Ft.start,"Assigning to "+Ft.name+" in strict mode")}function Tl(Ft){o=ke=ge,Me.locations&&(oi=new Cl),di=Jt=null,Ai=[],ja();var ti=Ft||Ts(),xi=!0;for(Ft||(ti.body=[]);Ye!==or;){var Fi=fo();ti.body.push(Fi),xi&&ll(Fi)&&Ol(!0),xi=!1}return rr(ti,"Program")}var To={kind:"loop"},kl={kind:"switch"};function fo(){(Ye===Ii||Ye===cn&&De=="/=")&&ja(!0);var Ft=Ye,ti=Ts();switch(Ft){case mn:case Hi:Un();var xi=Ft===mn;Yr(xe)||Co()?ti.label=null:Ye!==vn?hs():(ti.label=Di(),ul());for(var Fi=0;Fi<Ai.length;++Fi){var Ln=Ai[Fi];if((ti.label==null||Ln.name===ti.label.name)&&(Ln.kind!=null&&(xi||Ln.kind==="loop")||ti.label&&xi))break}return Fi===Ai.length&&li(ti.start,"Unsyntactic "+Ft.keyword),rr(ti,xi?"BreakStatement":"ContinueStatement");case ur:return Un(),ul(),rr(ti,"DebuggerStatement");case Qt:return Un(),Ai.push(To),ti.body=fo(),Ai.pop(),Qr(Vs),ti.test=Js(),ul(),rr(ti,"DoWhileStatement");case Tn:if(Un(),Ai.push(To),Qr(to),Ye===xe)return Qa(ti,null);if(Ye===Fr){var Hn=Ts();return Un(),$r(Hn,!0),rr(Hn,"VariableDeclaration"),Hn.declarations.length===1&&Yr(Zn)?Jo(ti,Hn):Qa(ti,Hn)}var Hn=mr(!1,!0);return Yr(Zn)?(wa(Hn),Jo(ti,Hn)):Qa(ti,Hn);case cr:return Un(),mi(ti,!0);case Ns:return Un(),ti.test=Js(),ti.consequent=fo(),ti.alternate=Yr(Yi)?fo():null,rr(ti,"IfStatement");case Ur:return!di&&!Me.allowReturnOutsideFunction&&li(Pe,"'return' outside of function"),Un(),Yr(xe)||Co()?ti.argument=null:(ti.argument=mr(),ul()),rr(ti,"ReturnStatement");case Vt:Un(),ti.discriminant=Js(),ti.cases=[],Qr(al),Ai.push(kl);for(var lr,Yn;Ye!=ol;)if(Ye===qn||Ye===On){var qs=Ye===qn;lr&&rr(lr,"SwitchCase"),ti.cases.push(lr=Ts()),lr.consequent=[],Un(),qs?lr.test=mr():(Yn&&li(o,"Multiple default clauses"),Yn=!0,lr.test=null),Qr(it)}else lr||hs(),lr.consequent.push(fo());return lr&&rr(lr,"SwitchCase"),Un(),Ai.pop(),rr(ti,"SwitchStatement");case hr:return Un(),El.test(se.slice(ke,Pe))&&li(ke,"Illegal newline after throw"),ti.argument=mr(),ul(),rr(ti,"ThrowStatement");case Lt:if(Un(),ti.block=Gs(),ti.handler=null,Ye===jr){var ks=Ts();Un(),Qr(to),ks.param=Di(),Jt&&Zo(ks.param.name)&&li(ks.param.start,"Binding "+ks.param.name+" in strict mode"),Qr(Va),ks.guard=null,ks.body=Gs(),ti.handler=rr(ks,"CatchClause")}return ti.guardedHandlers=zi,ti.finalizer=Yr(Ut)?Gs():null,!ti.handler&&!ti.finalizer&&li(ti.start,"Missing catch or finally clause"),rr(ti,"TryStatement");case Fr:return Un(),$r(ti),ul(),rr(ti,"VariableDeclaration");case Vs:return Un(),ti.test=Js(),Ai.push(To),ti.body=fo(),Ai.pop(),rr(ti,"WhileStatement");case ua:return Jt&&li(Pe,"'with' in strict mode"),Un(),ti.object=Js(),ti.body=fo(),rr(ti,"WithStatement");case al:return Gs();case xe:return Un(),rr(ti,"EmptyStatement");default:var As=De,Xa=mr();if(Ft===vn&&Xa.type==="Identifier"&&Yr(it)){for(var Fi=0;Fi<Ai.length;++Fi)Ai[Fi].name===As&&li(Xa.start,"Label '"+As+"' is already declared");var mo=Ye.isLoop?"loop":Ye===Vt?"switch":null;return Ai.push({name:As,kind:mo}),ti.body=fo(),Ai.pop(),ti.label=Xa,rr(ti,"LabeledStatement")}else return ti.expression=Xa,ul(),rr(ti,"ExpressionStatement")}}function Js(){Qr(to);var Ft=mr();return Qr(Va),Ft}function Gs(Ft){var ti=Ts(),xi=!0,Fi=!1,Ln;for(ti.body=[],Qr(al);!Yr(ol);){var Hn=fo();ti.body.push(Hn),xi&&Ft&&ll(Hn)&&(Ln=Fi,Ol(Fi=!0)),xi=!1}return Fi&&!Ln&&Ol(!1),rr(ti,"BlockStatement")}function Qa(Ft,ti){return Ft.init=ti,Qr(xe),Ft.test=Ye===xe?null:mr(),Qr(xe),Ft.update=Ye===Va?null:mr(),Qr(Va),Ft.body=fo(),Ai.pop(),rr(Ft,"ForStatement")}function Jo(Ft,ti){return Ft.left=ti,Ft.right=mr(),Qr(Va),Ft.body=fo(),Ai.pop(),rr(Ft,"ForInStatement")}function $r(Ft,ti){for(Ft.declarations=[],Ft.kind="var";;){var xi=Ts();if(xi.id=Di(),Jt&&Zo(xi.id.name)&&li(xi.id.start,"Binding "+xi.id.name+" in strict mode"),xi.init=Yr(Li)?mr(!0,ti):null,Ft.declarations.push(rr(xi,"VariableDeclarator")),!Yr(N))break}return Ft}function mr(Ft,ti){var xi=Nr(ti);if(!Ft&&Ye===N){var Fi=kr(xi);for(Fi.expressions=[xi];Yr(N);)Fi.expressions.push(Nr(ti));return rr(Fi,"SequenceExpression")}return xi}function Nr(Ft){var ti=ha(Ft);if(Ye.isAssign){var xi=kr(ti);return xi.operator=De,xi.left=ti,Un(),xi.right=Nr(Ft),wa(ti),rr(xi,"AssignmentExpression")}return ti}function ha(Ft){var ti=po(Ft);if(Yr(Wt)){var xi=kr(ti);return xi.test=ti,xi.consequent=mr(!0),Qr(it),xi.alternate=mr(!0,Ft),rr(xi,"ConditionalExpression")}return ti}function po(Ft){return ea(Sa(),-1,Ft)}function ea(Ft,ti,xi){var Fi=Ye.binop;if(Fi!=null&&(!xi||Ye!==Zn)&&Fi>ti){var Ln=kr(Ft);Ln.left=Ft,Ln.operator=De;var Hn=Ye;Un(),Ln.right=ea(Sa(),Fi,xi);var lr=rr(Ln,Hn===Ar||Hn===Or?"LogicalExpression":"BinaryExpression");return ea(lr,ti,xi)}return Ft}function Sa(){if(Ye.prefix){var Ft=Ts(),ti=Ye.isUpdate;return Ft.operator=De,Ft.prefix=!0,Ue=!0,Un(),Ft.argument=Sa(),ti?wa(Ft.argument):Jt&&Ft.operator==="delete"&&Ft.argument.type==="Identifier"&&li(Ft.start,"Deleting local variable in strict mode"),rr(Ft,ti?"UpdateExpression":"UnaryExpression")}for(var xi=ka();Ye.postfix&&!Co();){var Ft=kr(xi);Ft.operator=De,Ft.prefix=!1,Ft.argument=xi,wa(xi),Un(),xi=rr(Ft,"UpdateExpression")}return xi}function ka(){return Wa(cl())}function Wa(Ft,ti){if(Yr(It)){var xi=kr(Ft);return xi.object=Ft,xi.property=Di(!0),xi.computed=!1,Wa(rr(xi,"MemberExpression"),ti)}else if(Yr(ls)){var xi=kr(Ft);return xi.object=Ft,xi.property=mr(),xi.computed=!0,Qr(Na),Wa(rr(xi,"MemberExpression"),ti)}else if(!ti&&Yr(to)){var xi=kr(Ft);return xi.callee=Ft,xi.arguments=Vi(Va,!1),Wa(rr(xi,"CallExpression"),ti)}else return Ft}function cl(){switch(Ye){case Fa:var Fi=Ts();return Un(),rr(Fi,"ThisExpression");case vn:return Di();case vi:case $t:case wi:var Fi=Ts();return Fi.value=De,Fi.raw=se.slice(Pe,Fe),Un(),rr(Fi,"Literal");case zo:case Oa:case Ys:var Fi=Ts();return Fi.value=Ye.atomValue,Fi.raw=Ye.keyword,Un(),rr(Fi,"Literal");case to:var Ft=Ne,ti=Pe;Un();var xi=mr();return xi.start=ti,xi.end=Fe,Me.locations&&(xi.loc.start=Ft,xi.loc.end=Xe),Me.ranges&&(xi.range=[ti,Fe]),Qr(Va),xi;case ls:var Fi=Ts();return Un(),Fi.elements=Vi(Na,!0,!0),rr(Fi,"ArrayExpression");case al:return gl();case cr:var Fi=Ts();return Un(),mi(Fi,!1);case Pr:return lu();default:hs()}}function lu(){var Ft=Ts();return Un(),Ft.callee=Wa(cl(),!0),Yr(to)?Ft.arguments=Vi(Va,!1):Ft.arguments=zi,rr(Ft,"NewExpression")}function gl(){var Ft=Ts(),ti=!0,xi=!1;for(Ft.properties=[],Un();!Yr(ol);){if(ti)ti=!1;else if(Qr(N),Me.allowTrailingCommas&&Yr(ol))break;var Fi={key:ro()},Ln=!1,Hn;if(Yr(it)?(Fi.value=mr(!0),Hn=Fi.kind="init"):Me.ecmaVersion>=5&&Fi.key.type==="Identifier"&&(Fi.key.name==="get"||Fi.key.name==="set")?(Ln=xi=!0,Hn=Fi.kind=Fi.key.name,Fi.key=ro(),Ye!==to&&hs(),Fi.value=mi(Ts(),!1)):hs(),Fi.key.type==="Identifier"&&(Jt||xi))for(var lr=0;lr<Ft.properties.length;++lr){var Yn=Ft.properties[lr];if(Yn.key.name===Fi.key.name){var qs=Hn==Yn.kind||Ln&&Yn.kind==="init"||Hn==="init"&&(Yn.kind==="get"||Yn.kind==="set");qs&&!Jt&&Hn==="init"&&Yn.kind==="init"&&(qs=!1),qs&&li(Fi.key.start,"Redefinition of property")}}Ft.properties.push(Fi)}return rr(Ft,"ObjectExpression")}function ro(){return Ye===vi||Ye===$t?cl():Di(!0)}function mi(Ft,ti){Ye===vn?Ft.id=Di():ti?hs():Ft.id=null,Ft.params=[];var xi=!0;for(Qr(to);!Yr(Va);)xi?xi=!1:Qr(N),Ft.params.push(Di());var Fi=di,Ln=Ai;if(di=!0,Ai=[],Ft.body=Gs(!0),di=Fi,Ai=Ln,Jt||Ft.body.body.length&&ll(Ft.body.body[0]))for(var Hn=Ft.id?-1:0;Hn<Ft.params.length;++Hn){var lr=Hn<0?Ft.id:Ft.params[Hn];if((So(lr.name)||Zo(lr.name))&&li(lr.start,"Defining '"+lr.name+"' in strict mode"),Hn>=0)for(var Yn=0;Yn<Hn;++Yn)lr.name===Ft.params[Yn].name&&li(lr.start,"Argument name clash in strict mode")}return rr(Ft,ti?"FunctionDeclaration":"FunctionExpression")}function Vi(Ft,ti,xi){for(var Fi=[],Ln=!0;!Yr(Ft);){if(Ln)Ln=!1;else if(Qr(N),ti&&Me.allowTrailingCommas&&Yr(Ft))break;xi&&Ye===N?Fi.push(null):Fi.push(mr(!0))}return Fi}function Di(Ft){var ti=Ts();return Ft&&Me.forbidReserved=="everywhere"&&(Ft=!1),Ye===vn?(!Ft&&(Me.forbidReserved&&(Me.ecmaVersion===3?Ks:Lr)(De)||Jt&&So(De))&&se.slice(Pe,Fe).indexOf("\\")==-1&&li(Pe,"The keyword '"+De+"' is reserved"),ti.name=De):Ft&&Ye.keyword?ti.name=Ye.keyword:hs(),Ue=!1,Un(),rr(ti,"Identifier")}}),k.version||(k=null)}function te(nt,Me){return(v.acorn||k).parse(nt,Me)}var fe={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},ve={"-":"__negate","+":"__self"},Ie=b.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(nt){this["__"+nt]="#"+nt},{__self:function(){return this}});be.inject(Ie),ot.inject(Ie),qi.inject(Ie);function Ee(nt,Me,se){var ne=fe[Me];if(nt&&nt[ne]){var X=nt[ne](se);return Me==="!="?!X:X}switch(Me){case"+":return nt+se;case"-":return nt-se;case"*":return nt*se;case"/":return nt/se;case"%":return nt%se;case"==":return nt==se;case"!=":return nt!=se}}function ze(nt,Me){var se=ve[nt];if(Me&&Me[se])return Me[se]();switch(nt){case"+":return+Me;case"-":return-Me}}function Qe(nt,Me){if(!nt)return"";Me=Me||{};var se=[];function ne(Jt){for(var li=0,zi=se.length;li<zi;li++){var vi=se[li];if(vi[0]>=Jt)break;Jt+=vi[1]}return Jt}function X(Jt){return nt.substring(ne(Jt.range[0]),ne(Jt.range[1]))}function ie(Jt,li){return nt.substring(ne(Jt.range[1]),ne(li.range[0]))}function de(Jt,li){for(var zi=ne(Jt.range[0]),vi=ne(Jt.range[1]),wi=0,$t=se.length-1;$t>=0;$t--)if(zi>se[$t][0]){wi=$t+1;break}se.splice(wi,0,[zi,li.length-vi+zi]),nt=nt.substring(0,zi)+li+nt.substring(vi)}function ye(Jt,li){switch(Jt.type){case"UnaryExpression":if(Jt.operator in ve&&Jt.argument.type!=="Literal"){var zi=X(Jt.argument);de(Jt,'$__("'+Jt.operator+'", '+zi+")")}break;case"BinaryExpression":if(Jt.operator in fe&&Jt.left.type!=="Literal"){var vi=X(Jt.left),wi=X(Jt.right),$t=ie(Jt.left,Jt.right),vn=Jt.operator;de(Jt,"__$__("+vi+","+$t.replace(new RegExp("\\"+vn),'"'+vn+'"')+", "+wi+")")}break;case"UpdateExpression":case"AssignmentExpression":var or=li&&li.type;if(!(or==="ForStatement"||or==="BinaryExpression"&&/^[=!<>]/.test(li.operator)||or==="MemberExpression"&&li.computed)){if(Jt.type==="UpdateExpression"){var zi=X(Jt.argument),mn="__$__("+zi+', "'+Jt.operator[0]+'", 1)',qn=zi+" = "+mn;Jt.prefix?qn="("+qn+")":(or==="AssignmentExpression"||or==="VariableDeclarator"||or==="BinaryExpression")&&(X(li.left||li.id)===zi&&(qn=mn),qn=zi+"; "+qn),de(Jt,qn)}else if(/^.=$/.test(Jt.operator)&&Jt.left.type!=="Literal"){var vi=X(Jt.left),wi=X(Jt.right),mn=vi+" = __$__("+vi+', "'+Jt.operator[0]+'", '+wi+")";de(Jt,/^\(.*\)$/.test(X(Jt))?"("+mn+")":mn)}}break}}function ge(Jt){switch(Jt.type){case"ExportDefaultDeclaration":de({range:[Jt.start,Jt.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var li=Jt.declaration,zi=Jt.specifiers;if(li){var vi=li.declarations;vi&&(vi.forEach(function($t){de($t,"module.exports."+X($t))}),de({range:[Jt.start,li.start+li.kind.length]},""))}else if(zi){var wi=zi.map(function($t){var vn=X($t);return"module.exports."+vn+" = "+vn+"; "}).join("");wi&&de(Jt,wi)}break}}function Pe(Jt,li,zi){if(Jt){for(var vi in Jt)if(vi!=="range"&&vi!=="loc"){var wi=Jt[vi];if(Array.isArray(wi))for(var $t=0,vn=wi.length;$t<vn;$t++)Pe(wi[$t],Jt,zi);else wi&&typeof wi=="object"&&Pe(wi,Jt,zi)}zi.operatorOverloading!==!1&&ye(Jt,li),zi.moduleExports!==!1&&ge(Jt)}}function Fe(Jt){var li="",zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Jt=(Math.abs(Jt)<<1)+(Jt<0?1:0);Jt||!li;){var vi=Jt&31;Jt>>=5,Jt&&(vi|=32),li+=zi[vi]}return li}var Ne=Me.url||"",Xe=Me.sourceMaps,Ye=Me.paperFeatures||{},De=Me.source||nt,Ue=Me.offset||0,ht=In.agent,kt=ht.versionNumber,o=!1,ke=/\r\n|\n|\r/mg,oi;if(Xe&&(ht.chrome&&kt>=30||ht.webkit&&kt>=537.76||ht.firefox&&kt>=23||ht.node)){if(ht.node)Ue-=2;else if(c&&Ne&&!c.location.href.indexOf(Ne)){var di=g.getElementsByTagName("html")[0].innerHTML;Ue=di.substr(0,di.indexOf(nt)+1).match(ke).length+1}o=Ue>0&&!(ht.chrome&&kt>=36||ht.safari&&kt>=600||ht.firefox&&kt>=40||ht.node);var Ai=["AA"+Fe(o?0:Ue)+"A"];Ai.length=(nt.match(ke)||[]).length+1+(o?Ue:0),oi={version:3,file:Ne,names:[],mappings:Ai.join(";AACA"),sourceRoot:"",sources:[Ne],sourcesContent:[De]}}return(Ye.operatorOverloading!==!1||Ye.moduleExports!==!1)&&Pe(te(nt,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,Ye),oi&&(o&&(nt=new Array(Ue+1).join(`
`)+nt),/^(inline|both)$/.test(Xe)&&(nt+=`
//# sourceMappingURL=data:application/json;base64,`+t.btoa(unescape(encodeURIComponent(JSON.stringify(oi))))),nt+=`
//# sourceURL=`+(Ne||"paperscript")),{url:Ne,source:De,code:nt,map:oi}}function He(nt,Me,se){In=Me;var ne=Me.getView(),X=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(nt)&&!/\bnew\s+Tool\b/.test(nt)?new wn:null,ie=X?X._events:[],de=["onFrame","onResize"].concat(ie),ye=[],ge=[],Pe,Fe=typeof nt=="object"?nt:Qe(nt,se);nt=Fe.code;function Ne(kt,o){for(var ke in kt)(o||!/^_/.test(ke))&&new RegExp("([\\b\\s\\W]|^)"+ke.replace(/\$/g,"\\$")+"\\b").test(nt)&&(ye.push(ke),ge.push(kt[ke]))}Ne({__$__:Ee,$__:ze,paper:Me,tool:X},!0),Ne(Me),nt="var module = { exports: {} }; "+nt;var Ue=b.each(de,function(kt){new RegExp("\\s+"+kt+"\\b").test(nt)&&(ye.push(kt),this.push("module.exports."+kt+" = "+kt+";"))},[]).join(`
`);Ue&&(nt+=`
`+Ue),nt+=`
return module.exports;`;var Xe=In.agent;if(g&&(Xe.chrome||Xe.firefox&&Xe.versionNumber<40)){var Ye=g.createElement("script"),De=g.head||g.getElementsByTagName("head")[0];Xe.firefox&&(nt=`
`+nt),Ye.appendChild(g.createTextNode("document.__paperscript__ = function("+ye+") {"+nt+`
}`)),De.appendChild(Ye),Pe=g.__paperscript__,delete g.__paperscript__,De.removeChild(Ye)}else Pe=Function(ye,nt);var Ue=Pe&&Pe.apply(Me,ge),ht=Ue||{};return b.each(ie,function(kt){var o=ht[kt];o&&(X[kt]=o)}),ne&&(ht.onResize&&ne.setOnResize(ht.onResize),ne.emit("resize",{size:ne.size,delta:new be}),ht.onFrame&&ne.setOnFrame(ht.onFrame),ne.requestUpdate()),Ue}function Ze(nt){if(/^text\/(?:x-|)paperscript$/.test(nt.type)&&a.getAttribute(nt,"ignore")!=="true"){var Me=a.getAttribute(nt,"canvas"),se=g.getElementById(Me),ne=nt.src||nt.getAttribute("data-src"),X=a.hasAttribute(nt,"async"),ie="data-paper-scope";if(!se)throw new Error('Unable to find canvas with id "'+Me+'"');var de=a.get(se.getAttribute(ie))||new a().setup(se);return se.setAttribute(ie,de._id),ne?hi.request({url:ne,async:X,mimeType:"text/plain",onLoad:function(ye){He(ye,de,ne)}}):He(nt.innerHTML,de,nt.baseURI),nt.setAttribute("data-paper-ignore","true"),de}}function Ve(){b.each(g&&g.getElementsByTagName("script"),Ze)}function ft(nt){return nt?Ze(nt):Ve()}return c&&(g.readyState==="complete"?setTimeout(Ve):gi.add(c,{load:Ve})),{compile:Qe,execute:He,load:ft,parse:te,calculateBinary:Ee,calculateUnary:ze}}).call(this);var In=new(a.inject(b.exports,{Base:b,Numerical:ae,Key:fi,DomEvent:gi,DomElement:Ci,document:g,window:c,Symbol:bt,PlacedSymbol:gt}));return In.agent.node&&vx(In),typeof n=="function"&&n.amd?n("paper",In):e&&(e.exports=In),In}).call(Jf,typeof self=="object"?self:null)})(d3);var B1=d3.exports;function mT(e){let t,n,c="Click and drag to draw a polygon. Press Escape to exit.",g,b;return{c(){t=Nn("div"),n=Nn("span"),n.textContent=c,g=Cr(),b=Nn("canvas"),this.h()},l(I){t=Vn(I,"DIV",{class:!0});var a=bn(t);n=Vn(a,"SPAN",{class:!0,"data-svelte-h":!0}),dc(n)!=="svelte-1m9xrla"&&(n.textContent=c),g=Tr(a),b=Vn(a,"CANVAS",{class:!0}),bn(b).forEach(bi),a.forEach(bi),this.h()},h(){Pi(n,"class","svelte-jrtjeu"),Pi(b,"class","canvas svelte-jrtjeu"),Pi(t,"class","draw-wrapper svelte-jrtjeu")},m(I,a){Gn(I,t,a),Zi(t,n),Zi(t,g),Zi(t,b),e[5](b)},p:wo,i:wo,o:wo,d(I){I&&bi(t),e[5](null)}}}function gT(e,t,n){let{path:c}=t,{updatePath:g}=t,{updateIsDrawing:b}=t,{isDrawing:I}=t,a,G;vc(()=>{B1.setup(G);let he=new B1.Tool;he.onMouseDown=function(ae){n(1,c=new B1.Path),n(1,c.strokeColor="white",c),c.add(ae.point)},he.onMouseDrag=function(ae){a&&c.add(ae.point)},he.onMouseUp=function(ae){if(!a)return;c.simplify(.5),c.clearHandles(),n(1,c.closed=!0,c);let ue=[];for(let be of c.segments){console.log();let Ke=be.point;ue.push({x:Ke.x,y:Ke.y})}g(ue),b(!1)},he.onKeyDown=function(ae){console.log(ae),ae.key==="escape"&&b(!1)}});function W(he){pa[he?"unshift":"push"](()=>{G=he,n(0,G)})}return e.$$set=he=>{"path"in he&&n(1,c=he.path),"updatePath"in he&&n(2,g=he.updatePath),"updateIsDrawing"in he&&n(3,b=he.updateIsDrawing),"isDrawing"in he&&n(4,I=he.isDrawing)},e.$$.update=()=>{e.$$.dirty&16&&(a=I)},[G,c,g,b,I,W]}class _T extends Lo{constructor(t){super(),Bo(this,t,gT,mT,ho,{path:1,updatePath:2,updateIsDrawing:3,isDrawing:4})}}const g_=["pd","mpd","mntd","tree_sizes","rel_pd","quartile"],bx={pd:"phylodiversity",mpd:"mean pairwise phylogenetic distance",mntd:"mean nearest-taxon phylogenetic distance"};function yT(e){if(!e||!g_.includes(e))return;const n=650;let c=new Array(n),g=[0,1];const b=wx[1]/n;let I;switch(e){case"mntd":case"rel_mntd":I=um.mntd;break;case"mpd":case"rel_mpd":I=um.mpd;break;default:case"pd":I=um.pd}let a=I.d,G=I.b,W=I.e,he=I.c,ae=I.modelHigh,ue=I.modelLow,be=I.minY,Ke=I.maxY,ot=2;for(let tt=0;tt<n;tt++){let lt=(tt+ot)*b;c[tt]={x:lt,high:ae({x:lt,b:G.high,c:he.high,d:a.high,e:W.high}),low:ue({x:lt,b:G.low,c:he.low,d:a.low,e:W.low})}}return g=[be,Ke],{confidence:c,yAxis:g,xAxis:wx,xAxisLabel:"Tree Size",yAxisLabel:I.yAxisLabel}}const wx=[0,300],um={pd:{b:{low:-.7505,high:-.6608},c:{low:9.567,high:123.1524},d:{low:11690.7906,high:10762.3392},e:{low:1298.4931,high:1308.4918},minY:100,maxY:5e3,yAxisLabel:"Phylodiversity (pd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mpd:{b:{low:-.6495,high:.4117},c:{low:-39.3099,high:93.617},d:{low:102.1695,high:152.3637},e:{low:1.2904,high:2.763},minY:0,maxY:200,yAxisLabel:"Mean pairwise phylogenetic distance (mpd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mntd:{b:{low:1.2883,high:.9501},c:{low:8.8277,high:5.9462},d:{low:33.4172,high:156.3706},e:{low:44.5908,high:10.2206},minY:0,maxY:150,yAxisLabel:"Mean nearest-taxon phylogenetic distance (mntd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))}};function vT(e,t,n){if(t===-1||t==NaN)return-1;let c;switch(e){case"mntd":case"rel_mntd":c=um.mntd;break;case"mpd":case"rel_mpd":c=um.mpd;break;default:case"pd":c=um.pd}let g=c.d,b=c.b,I=c.e,a=c.c,G=c.modelHigh,W=c.modelLow;G({x:n,b:b.high,c:a.high,d:g.high,e:I.high});let he=W({x:n,b:b.low,c:a.low,d:g.low,e:I.low});return t-he}function Sx(e){let t,n=(e[1][0]??"min")+"",c,g,b,I=(e[1][1]??"med")+"",a,G,W,he=(e[1][2]??"max")+"",ae;return{c(){t=Nn("span"),c=Ja(n),g=Cr(),b=Nn("span"),a=Ja(I),G=Cr(),W=Nn("span"),ae=Ja(he),this.h()},l(ue){t=Vn(ue,"SPAN",{class:!0});var be=bn(t);c=eo(be,n),be.forEach(bi),g=Tr(ue),b=Vn(ue,"SPAN",{class:!0});var Ke=bn(b);a=eo(Ke,I),Ke.forEach(bi),G=Tr(ue),W=Vn(ue,"SPAN",{class:!0});var ot=bn(W);ae=eo(ot,he),ot.forEach(bi),this.h()},h(){Pi(t,"class","svelte-1mfvjh6"),Pi(b,"class","svelte-1mfvjh6"),Pi(W,"class","svelte-1mfvjh6")},m(ue,be){Gn(ue,t,be),Zi(t,c),Gn(ue,g,be),Gn(ue,b,be),Zi(b,a),Gn(ue,G,be),Gn(ue,W,be),Zi(W,ae)},p(ue,be){be&2&&n!==(n=(ue[1][0]??"min")+"")&&tu(c,n),be&2&&I!==(I=(ue[1][1]??"med")+"")&&tu(a,I),be&2&&he!==(he=(ue[1][2]??"max")+"")&&tu(ae,he)},d(ue){ue&&(bi(t),bi(g),bi(b),bi(G),bi(W))}}}function xT(e){let t,n,c,g,b,I=e[1]&&Sx(e);return{c(){t=Nn("div"),n=Nn("div"),g=Cr(),b=Nn("div"),I&&I.c(),this.h()},l(a){t=Vn(a,"DIV",{class:!0});var G=bn(t);n=Vn(G,"DIV",{class:!0,style:!0}),bn(n).forEach(bi),g=Tr(G),b=Vn(G,"DIV",{class:!0});var W=bn(b);I&&I.l(W),W.forEach(bi),G.forEach(bi),this.h()},h(){Pi(n,"class","gradient svelte-1mfvjh6"),Pi(n,"style",c=`background-image: none, ${e[0]}`),Pi(b,"class","label-container svelte-1mfvjh6"),Pi(t,"class","legend-container svelte-1mfvjh6")},m(a,G){Gn(a,t,G),Zi(t,n),Zi(t,g),Zi(t,b),I&&I.m(b,null)},p(a,[G]){G&1&&c!==(c=`background-image: none, ${a[0]}`)&&Pi(n,"style",c),a[1]?I?I.p(a,G):(I=Sx(a),I.c(),I.m(b,null)):I&&(I.d(1),I=null)},i:wo,o:wo,d(a){a&&bi(t),I&&I.d()}}}function bT(e,t,n){let c;Vc(e,Jg,ae=>n(6,c=ae));let g=m_(),b,{colorScheme:I}=t,{metric:a}=t,G=[0,.5,1];function W(ae){console.log(ae);let ue=`linear-gradient(${ae.map(be=>be[1]).flat().reverse()})`;return console.log(ue),ue}function he(ae){if(!(ae!=null&&ae.length))return;let ue=ae.length-2;n(1,G[2]=Math.round(ae[ue]??1),G),n(1,G[1]=Math.round(ae[ue-2]??.5),G),n(1,G[0]=Math.round(ae[ue-4]??0),G)}return e.$$set=ae=>{"colorScheme"in ae&&n(2,I=ae.colorScheme),"metric"in ae&&n(3,a=ae.metric)},e.$$.update=()=>{e.$$.dirty&4&&n(5,g=m_(0,1,I).slice(1)),e.$$.dirty&32&&n(0,b=W(g)),e.$$.dirty&64&&he(c)},[b,G,I,a,W,g,c]}class wT extends Lo{constructor(t){super(),Bo(this,t,bT,xT,ho,{colorScheme:2,metric:3,createPaletteGradient:4})}get createPaletteGradient(){return this.$$.ctx[4]}}function ST(e){let t,n,c,g,b,I,a,G,W,he,ae,ue,be;return{c(){t=Ba("svg"),n=Ba("defs"),c=Ba("style"),g=Ja(`.cls-1 {
        fill: #29abe2;
      }
    `),b=Ba("g"),I=Ba("g"),a=Ba("g"),G=Ba("path"),W=Ba("path"),he=Ba("path"),ae=Ba("path"),ue=Ba("path"),be=Ba("polygon"),this.h()},l(Ke){t=za(Ke,"svg",{id:!0,"data-name":!0,xmlns:!0,viewBox:!0});var ot=bn(t);n=za(ot,"defs",{});var tt=bn(n);c=za(tt,"style",{});var lt=bn(c);g=eo(lt,`.cls-1 {
        fill: #29abe2;
      }
    `),lt.forEach(bi),tt.forEach(bi),b=za(ot,"g",{id:!0,"data-name":!0});var ut=bn(b);I=za(ut,"g",{});var Tt=bn(I);a=za(Tt,"g",{});var Pt=bn(a);G=za(Pt,"path",{class:!0,d:!0}),bn(G).forEach(bi),W=za(Pt,"path",{class:!0,d:!0}),bn(W).forEach(bi),he=za(Pt,"path",{class:!0,d:!0}),bn(he).forEach(bi),ae=za(Pt,"path",{class:!0,d:!0}),bn(ae).forEach(bi),ue=za(Pt,"path",{class:!0,d:!0}),bn(ue).forEach(bi),Pt.forEach(bi),be=za(Tt,"polygon",{class:!0,points:!0}),bn(be).forEach(bi),Tt.forEach(bi),ut.forEach(bi),ot.forEach(bi),this.h()},h(){Pi(G,"class","cls-1"),Pi(G,"d","m9.41.16c1.38,0,2.18.92,1.92,2.28-.33,1.76-1.73,2.88-3.52,2.98l-1.2.06-1.13,3.08-1.68.12L6.91.16h2.5Zm-1.4,1.58l-.8,2.12.87-.03c.93-.03,1.38-.63,1.48-1.19.1-.56-.12-.92-.86-.91h-.68Z"),Pi(W,"class","cls-1"),Pi(W,"d","m14.62,7.9l1.24-3.16-2.79.12-1.25,3.24-1.68.12L13.24.15h1.69s-1.21,3.04-1.21,3.04l2.8-.08,1.21-2.96h1.7s-3.11,7.63-3.11,7.63l-1.7.12Z"),Pi(he,"class","cls-1"),Pi(he,"d","m22.82,5.85l-2.81.16-1.15,1.58-1.89.14L22.88.14h1.96s-.36,7.04-.36,7.04l-1.75.13.1-1.46Zm-1.65-1.38l1.75-.08.19-2.47-1.94,2.54Z"),Pi(ae,"class","cls-1"),Pi(ae,"d","m29.21,4.99c.06-.27,0-.48-.4-.63l-.81-.29c-.94-.34-1.26-1.02-1.08-1.84.3-1.36,1.78-2.23,3.24-2.23,2.08,0,2.33,1.22,2.18,1.89l-1.62.26c.04-.19.1-.88-.92-.86-.62,0-1.07.4-1.15.77-.08.34.12.52.39.63l.73.28c1.08.4,1.41,1,1.22,1.82-.23,1.05-1.46,2.18-3.22,2.31-2.15.16-2.61-1.14-2.41-2.06.03-.13.05-.21.08-.27l1.6-.32s-.05.14-.07.23c-.12.58.14,1.13,1.06,1.09.65-.04,1.09-.34,1.18-.77Z"),Pi(ue,"class","cls-1"),Pi(ue,"d","m36.78,1.44l-2.45,5.03-1.69.12,2.44-5.13-2.22.04.67-1.38h6.04s-.67,1.28-.67,1.28l-2.12.03Z"),Pi(be,"class","cls-1"),Pi(be,"points","3.79 .23 1.5 .23 0 2.22 .8 4.21 3.09 4.21 4.59 2.22 3.79 .23"),Pi(b,"id","Layer_1-2"),Pi(b,"data-name","Layer 1"),Pi(t,"id","Layer_2"),Pi(t,"data-name","Layer 2"),Pi(t,"xmlns","http://www.w3.org/2000/svg"),Pi(t,"viewBox","0 0 39.57 8.68")},m(Ke,ot){Gn(Ke,t,ot),Zi(t,n),Zi(n,c),Zi(c,g),Zi(t,b),Zi(b,I),Zi(I,a),Zi(a,G),Zi(a,W),Zi(a,he),Zi(a,ae),Zi(a,ue),Zi(I,be)},p:wo,i:wo,o:wo,d(Ke){Ke&&bi(t)}}}class IT extends Lo{constructor(t){super(),Bo(this,t,null,ST,ho,{})}}function e_(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ET(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function p3(e){let t,n,c;e.length!==2?(t=e_,n=(a,G)=>e_(e(a),G),c=(a,G)=>e(a)-G):(t=e===e_||e===ET?e:CT,n=e,c=e);function g(a,G,W=0,he=a.length){if(W<he){if(t(G,G)!==0)return he;do{const ae=W+he>>>1;n(a[ae],G)<0?W=ae+1:he=ae}while(W<he)}return W}function b(a,G,W=0,he=a.length){if(W<he){if(t(G,G)!==0)return he;do{const ae=W+he>>>1;n(a[ae],G)<=0?W=ae+1:he=ae}while(W<he)}return W}function I(a,G,W=0,he=a.length){const ae=g(a,G,W,he-1);return ae>W&&c(a[ae-1],G)>-c(a[ae],G)?ae-1:ae}return{left:g,center:I,right:b}}function CT(){return 0}function TT(e){return e===null?NaN:+e}const kT=p3(e_),MT=kT.right;p3(TT).center;function Ix(e,t){let n,c;if(t===void 0)for(const g of e)g!=null&&(n===void 0?g>=g&&(n=c=g):(n>g&&(n=g),c<g&&(c=g)));else{let g=-1;for(let b of e)(b=t(b,++g,e))!=null&&(n===void 0?b>=b&&(n=c=b):(n>b&&(n=b),c<b&&(c=b)))}return[n,c]}const PT=Math.sqrt(50),DT=Math.sqrt(10),LT=Math.sqrt(2);function __(e,t,n){const c=(t-e)/Math.max(0,n),g=Math.floor(Math.log10(c)),b=c/Math.pow(10,g),I=b>=PT?10:b>=DT?5:b>=LT?2:1;let a,G,W;return g<0?(W=Math.pow(10,-g)/I,a=Math.round(e*W),G=Math.round(t*W),a/W<e&&++a,G/W>t&&--G,W=-W):(W=Math.pow(10,g)*I,a=Math.round(e/W),G=Math.round(t/W),a*W<e&&++a,G*W>t&&--G),G<a&&.5<=n&&n<2?__(e,t,n*2):[a,G,W]}function BT(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const c=t<e,[g,b,I]=c?__(t,e,n):__(e,t,n);if(!(b>=g))return[];const a=b-g+1,G=new Array(a);if(c)if(I<0)for(let W=0;W<a;++W)G[W]=(b-W)/-I;else for(let W=0;W<a;++W)G[W]=(b-W)*I;else if(I<0)for(let W=0;W<a;++W)G[W]=(g+W)/-I;else for(let W=0;W<a;++W)G[W]=(g+W)*I;return G}function Fy(e,t,n){return t=+t,e=+e,n=+n,__(e,t,n)[2]}function zT(e,t,n){t=+t,e=+e,n=+n;const c=t<e,g=c?Fy(t,e,n):Fy(e,t,n);return(c?-1:1)*(g<0?1/-g:g)}function RT(e){return e}var z1=1,R1=2,Oy=3,ng=4,Ex=1e-6;function FT(e){return"translate("+e+",0)"}function OT(e){return"translate(0,"+e+")"}function NT(e){return t=>+e(t)}function VT(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function UT(){return!this.__axis}function m3(e,t){var n=[],c=null,g=null,b=6,I=6,a=3,G=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===z1||e===ng?-1:1,he=e===ng||e===R1?"x":"y",ae=e===z1||e===Oy?FT:OT;function ue(be){var Ke=c??(t.ticks?t.ticks.apply(t,n):t.domain()),ot=g??(t.tickFormat?t.tickFormat.apply(t,n):RT),tt=Math.max(b,0)+a,lt=t.range(),ut=+lt[0]+G,Tt=+lt[lt.length-1]+G,Pt=(t.bandwidth?VT:NT)(t.copy(),G),zt=be.selection?be.selection():be,Ge=zt.selectAll(".domain").data([null]),Xt=zt.selectAll(".tick").data(Ke,t).order(),rt=Xt.exit(),yt=Xt.enter().append("g").attr("class","tick"),pt=Xt.select("line"),gt=Xt.select("text");Ge=Ge.merge(Ge.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Xt=Xt.merge(yt),pt=pt.merge(yt.append("line").attr("stroke","currentColor").attr(he+"2",W*b)),gt=gt.merge(yt.append("text").attr("fill","currentColor").attr(he,W*tt).attr("dy",e===z1?"0em":e===Oy?"0.71em":"0.32em")),be!==zt&&(Ge=Ge.transition(be),Xt=Xt.transition(be),pt=pt.transition(be),gt=gt.transition(be),rt=rt.transition(be).attr("opacity",Ex).attr("transform",function(bt){return isFinite(bt=Pt(bt))?ae(bt+G):this.getAttribute("transform")}),yt.attr("opacity",Ex).attr("transform",function(bt){var dt=this.parentNode.__axis;return ae((dt&&isFinite(dt=dt(bt))?dt:Pt(bt))+G)})),rt.remove(),Ge.attr("d",e===ng||e===R1?I?"M"+W*I+","+ut+"H"+G+"V"+Tt+"H"+W*I:"M"+G+","+ut+"V"+Tt:I?"M"+ut+","+W*I+"V"+G+"H"+Tt+"V"+W*I:"M"+ut+","+G+"H"+Tt),Xt.attr("opacity",1).attr("transform",function(bt){return ae(Pt(bt)+G)}),pt.attr(he+"2",W*b),gt.attr(he,W*tt).text(ot),zt.filter(UT).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===R1?"start":e===ng?"end":"middle"),zt.each(function(){this.__axis=Pt})}return ue.scale=function(be){return arguments.length?(t=be,ue):t},ue.ticks=function(){return n=Array.from(arguments),ue},ue.tickArguments=function(be){return arguments.length?(n=be==null?[]:Array.from(be),ue):n.slice()},ue.tickValues=function(be){return arguments.length?(c=be==null?null:Array.from(be),ue):c&&c.slice()},ue.tickFormat=function(be){return arguments.length?(g=be,ue):g},ue.tickSize=function(be){return arguments.length?(b=I=+be,ue):b},ue.tickSizeInner=function(be){return arguments.length?(b=+be,ue):b},ue.tickSizeOuter=function(be){return arguments.length?(I=+be,ue):I},ue.tickPadding=function(be){return arguments.length?(a=+be,ue):a},ue.offset=function(be){return arguments.length?(G=+be,ue):G},ue}function GT(e){return m3(Oy,e)}function qT(e){return m3(ng,e)}var HT={value:()=>{}};function g3(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new t_(n)}function t_(e){this._=e}function jT(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}t_.prototype=g3.prototype={constructor:t_,on:function(e,t){var n=this._,c=jT(e+"",n),g,b=-1,I=c.length;if(arguments.length<2){for(;++b<I;)if((g=(e=c[b]).type)&&(g=ZT(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++b<I;)if(g=(e=c[b]).type)n[g]=Cx(n[g],e.name,t);else if(t==null)for(g in n)n[g]=Cx(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new t_(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,b;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(b=this._[e],c=0,g=b.length;c<g;++c)b[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,b=c.length;g<b;++g)c[g].value.apply(t,n)}};function ZT(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function Cx(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=HT,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ny="http://www.w3.org/1999/xhtml";const Tx={svg:"http://www.w3.org/2000/svg",xhtml:Ny,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $_(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Tx.hasOwnProperty(t)?{space:Tx[t],local:e}:e}function QT(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ny&&t.documentElement.namespaceURI===Ny?t.createElement(e):t.createElementNS(n,e)}}function WT(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _3(e){var t=$_(e);return(t.local?WT:QT)(t)}function XT(){}function zv(e){return e==null?XT:function(){return this.querySelector(e)}}function YT(e){typeof e!="function"&&(e=zv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],I=b.length,a=c[g]=new Array(I),G,W,he=0;he<I;++he)(G=b[he])&&(W=e.call(G,G.__data__,he,b))&&("__data__"in G&&(W.__data__=G.__data__),a[he]=W);return new mh(c,this._parents)}function $T(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function KT(){return[]}function y3(e){return e==null?KT:function(){return this.querySelectorAll(e)}}function JT(e){return function(){return $T(e.apply(this,arguments))}}function e6(e){typeof e=="function"?e=JT(e):e=y3(e);for(var t=this._groups,n=t.length,c=[],g=[],b=0;b<n;++b)for(var I=t[b],a=I.length,G,W=0;W<a;++W)(G=I[W])&&(c.push(e.call(G,G.__data__,W,I)),g.push(G));return new mh(c,g)}function v3(e){return function(){return this.matches(e)}}function x3(e){return function(t){return t.matches(e)}}var t6=Array.prototype.find;function i6(e){return function(){return t6.call(this.children,e)}}function n6(){return this.firstElementChild}function r6(e){return this.select(e==null?n6:i6(typeof e=="function"?e:x3(e)))}var s6=Array.prototype.filter;function a6(){return Array.from(this.children)}function o6(e){return function(){return s6.call(this.children,e)}}function l6(e){return this.selectAll(e==null?a6:o6(typeof e=="function"?e:x3(e)))}function u6(e){typeof e!="function"&&(e=v3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],I=b.length,a=c[g]=[],G,W=0;W<I;++W)(G=b[W])&&e.call(G,G.__data__,W,b)&&a.push(G);return new mh(c,this._parents)}function b3(e){return new Array(e.length)}function c6(){return new mh(this._enter||this._groups.map(b3),this._parents)}function y_(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}y_.prototype={constructor:y_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function h6(e){return function(){return e}}function A6(e,t,n,c,g,b){for(var I=0,a,G=t.length,W=b.length;I<W;++I)(a=t[I])?(a.__data__=b[I],c[I]=a):n[I]=new y_(e,b[I]);for(;I<G;++I)(a=t[I])&&(g[I]=a)}function f6(e,t,n,c,g,b,I){var a,G,W=new Map,he=t.length,ae=b.length,ue=new Array(he),be;for(a=0;a<he;++a)(G=t[a])&&(ue[a]=be=I.call(G,G.__data__,a,t)+"",W.has(be)?g[a]=G:W.set(be,G));for(a=0;a<ae;++a)be=I.call(e,b[a],a,b)+"",(G=W.get(be))?(c[a]=G,G.__data__=b[a],W.delete(be)):n[a]=new y_(e,b[a]);for(a=0;a<he;++a)(G=t[a])&&W.get(ue[a])===G&&(g[a]=G)}function d6(e){return e.__data__}function p6(e,t){if(!arguments.length)return Array.from(this,d6);var n=t?f6:A6,c=this._parents,g=this._groups;typeof e!="function"&&(e=h6(e));for(var b=g.length,I=new Array(b),a=new Array(b),G=new Array(b),W=0;W<b;++W){var he=c[W],ae=g[W],ue=ae.length,be=m6(e.call(he,he&&he.__data__,W,c)),Ke=be.length,ot=a[W]=new Array(Ke),tt=I[W]=new Array(Ke),lt=G[W]=new Array(ue);n(he,ae,ot,tt,lt,be,t);for(var ut=0,Tt=0,Pt,zt;ut<Ke;++ut)if(Pt=ot[ut]){for(ut>=Tt&&(Tt=ut+1);!(zt=tt[Tt])&&++Tt<Ke;);Pt._next=zt||null}}return I=new mh(I,c),I._enter=a,I._exit=G,I}function m6(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function g6(){return new mh(this._exit||this._groups.map(b3),this._parents)}function _6(e,t,n){var c=this.enter(),g=this,b=this.exit();return typeof e=="function"?(c=e(c),c&&(c=c.selection())):c=c.append(e+""),t!=null&&(g=t(g),g&&(g=g.selection())),n==null?b.remove():n(b),c&&g?c.merge(g).order():g}function y6(e){for(var t=e.selection?e.selection():e,n=this._groups,c=t._groups,g=n.length,b=c.length,I=Math.min(g,b),a=new Array(g),G=0;G<I;++G)for(var W=n[G],he=c[G],ae=W.length,ue=a[G]=new Array(ae),be,Ke=0;Ke<ae;++Ke)(be=W[Ke]||he[Ke])&&(ue[Ke]=be);for(;G<g;++G)a[G]=n[G];return new mh(a,this._parents)}function v6(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,b=c[g],I;--g>=0;)(I=c[g])&&(b&&I.compareDocumentPosition(b)^4&&b.parentNode.insertBefore(I,b),b=I);return this}function x6(e){e||(e=b6);function t(ae,ue){return ae&&ue?e(ae.__data__,ue.__data__):!ae-!ue}for(var n=this._groups,c=n.length,g=new Array(c),b=0;b<c;++b){for(var I=n[b],a=I.length,G=g[b]=new Array(a),W,he=0;he<a;++he)(W=I[he])&&(G[he]=W);G.sort(t)}return new mh(g,this._parents).order()}function b6(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function w6(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function S6(){return Array.from(this)}function I6(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length;g<b;++g){var I=c[g];if(I)return I}return null}function E6(){let e=0;for(const t of this)++e;return e}function C6(){return!this.node()}function T6(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],b=0,I=g.length,a;b<I;++b)(a=g[b])&&e.call(a,a.__data__,b,g);return this}function k6(e){return function(){this.removeAttribute(e)}}function M6(e){return function(){this.removeAttributeNS(e.space,e.local)}}function P6(e,t){return function(){this.setAttribute(e,t)}}function D6(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function L6(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function B6(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function z6(e,t){var n=$_(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?M6:k6:typeof t=="function"?n.local?B6:L6:n.local?D6:P6)(n,t))}function w3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function R6(e){return function(){this.style.removeProperty(e)}}function F6(e,t,n){return function(){this.style.setProperty(e,t,n)}}function O6(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function N6(e,t,n){return arguments.length>1?this.each((t==null?R6:typeof t=="function"?O6:F6)(e,t,n??"")):dm(this.node(),e)}function dm(e,t){return e.style.getPropertyValue(t)||w3(e).getComputedStyle(e,null).getPropertyValue(t)}function V6(e){return function(){delete this[e]}}function U6(e,t){return function(){this[e]=t}}function G6(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function q6(e,t){return arguments.length>1?this.each((t==null?V6:typeof t=="function"?G6:U6)(e,t)):this.node()[e]}function S3(e){return e.trim().split(/^|\s+/)}function Rv(e){return e.classList||new I3(e)}function I3(e){this._node=e,this._names=S3(e.getAttribute("class")||"")}I3.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function E3(e,t){for(var n=Rv(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function C3(e,t){for(var n=Rv(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function H6(e){return function(){E3(this,e)}}function j6(e){return function(){C3(this,e)}}function Z6(e,t){return function(){(t.apply(this,arguments)?E3:C3)(this,e)}}function Q6(e,t){var n=S3(e+"");if(arguments.length<2){for(var c=Rv(this.node()),g=-1,b=n.length;++g<b;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?Z6:t?H6:j6)(n,t))}function W6(){this.textContent=""}function X6(e){return function(){this.textContent=e}}function Y6(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function $6(e){return arguments.length?this.each(e==null?W6:(typeof e=="function"?Y6:X6)(e)):this.node().textContent}function K6(){this.innerHTML=""}function J6(e){return function(){this.innerHTML=e}}function e8(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function t8(e){return arguments.length?this.each(e==null?K6:(typeof e=="function"?e8:J6)(e)):this.node().innerHTML}function i8(){this.nextSibling&&this.parentNode.appendChild(this)}function n8(){return this.each(i8)}function r8(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function s8(){return this.each(r8)}function a8(e){var t=typeof e=="function"?e:_3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function o8(){return null}function l8(e,t){var n=typeof e=="function"?e:_3(e),c=t==null?o8:typeof t=="function"?t:zv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function u8(){var e=this.parentNode;e&&e.removeChild(this)}function c8(){return this.each(u8)}function h8(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function A8(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function f8(e){return this.select(e?A8:h8)}function d8(e){return arguments.length?this.property("__data__",e):this.node().__data__}function p8(e){return function(t){e.call(this,t,this.__data__)}}function m8(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function g8(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,b;n<g;++n)b=t[n],(!e.type||b.type===e.type)&&b.name===e.name?this.removeEventListener(b.type,b.listener,b.options):t[++c]=b;++c?t.length=c:delete this.__on}}}function _8(e,t,n){return function(){var c=this.__on,g,b=p8(t);if(c){for(var I=0,a=c.length;I<a;++I)if((g=c[I]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=b,g.options=n),g.value=t;return}}this.addEventListener(e.type,b,n),g={type:e.type,name:e.name,value:t,listener:b,options:n},c?c.push(g):this.__on=[g]}}function y8(e,t,n){var c=m8(e+""),g,b=c.length,I;if(arguments.length<2){var a=this.node().__on;if(a){for(var G=0,W=a.length,he;G<W;++G)for(g=0,he=a[G];g<b;++g)if((I=c[g]).type===he.type&&I.name===he.name)return he.value}return}for(a=t?_8:g8,g=0;g<b;++g)this.each(a(c[g],t,n));return this}function T3(e,t,n){var c=w3(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function v8(e,t){return function(){return T3(this,e,t)}}function x8(e,t){return function(){return T3(this,e,t.apply(this,arguments))}}function b8(e,t){return this.each((typeof t=="function"?x8:v8)(e,t))}function*w8(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length,I;g<b;++g)(I=c[g])&&(yield I)}var k3=[null];function mh(e,t){this._groups=e,this._parents=t}function Tg(){return new mh([[document.documentElement]],k3)}function S8(){return this}mh.prototype=Tg.prototype={constructor:mh,select:YT,selectAll:e6,selectChild:r6,selectChildren:l6,filter:u6,data:p6,enter:c6,exit:g6,join:_6,merge:y6,selection:S8,order:v6,sort:x6,call:w6,nodes:S6,node:I6,size:E6,empty:C6,each:T6,attr:z6,style:N6,property:q6,classed:Q6,text:$6,html:t8,raise:n8,lower:s8,append:a8,insert:l8,remove:c8,clone:f8,datum:d8,on:y8,dispatch:b8,[Symbol.iterator]:w8};function i_(e){return typeof e=="string"?new mh([[document.querySelector(e)]],[document.documentElement]):new mh([[e]],k3)}function Fv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function M3(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function kg(){}var fg=.7,v_=1/fg,cm="\\s*([+-]?\\d+)\\s*",dg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$A="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",I8=/^#([0-9a-f]{3,8})$/,E8=new RegExp(`^rgb\\(${cm},${cm},${cm}\\)$`),C8=new RegExp(`^rgb\\(${$A},${$A},${$A}\\)$`),T8=new RegExp(`^rgba\\(${cm},${cm},${cm},${dg}\\)$`),k8=new RegExp(`^rgba\\(${$A},${$A},${$A},${dg}\\)$`),M8=new RegExp(`^hsl\\(${dg},${$A},${$A}\\)$`),P8=new RegExp(`^hsla\\(${dg},${$A},${$A},${dg}\\)$`),kx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Fv(kg,tp,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Mx,formatHex:Mx,formatHex8:D8,formatHsl:L8,formatRgb:Px,toString:Px});function Mx(){return this.rgb().formatHex()}function D8(){return this.rgb().formatHex8()}function L8(){return P3(this).formatHsl()}function Px(){return this.rgb().formatRgb()}function tp(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=I8.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Dx(t):n===3?new Uc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Gg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Gg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=E8.exec(e))?new Uc(t[1],t[2],t[3],1):(t=C8.exec(e))?new Uc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=T8.exec(e))?Gg(t[1],t[2],t[3],t[4]):(t=k8.exec(e))?Gg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=M8.exec(e))?zx(t[1],t[2]/100,t[3]/100,1):(t=P8.exec(e))?zx(t[1],t[2]/100,t[3]/100,t[4]):kx.hasOwnProperty(e)?Dx(kx[e]):e==="transparent"?new Uc(NaN,NaN,NaN,0):null}function Dx(e){return new Uc(e>>16&255,e>>8&255,e&255,1)}function Gg(e,t,n,c){return c<=0&&(e=t=n=NaN),new Uc(e,t,n,c)}function B8(e){return e instanceof kg||(e=tp(e)),e?(e=e.rgb(),new Uc(e.r,e.g,e.b,e.opacity)):new Uc}function Vy(e,t,n,c){return arguments.length===1?B8(e):new Uc(e,t,n,c??1)}function Uc(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}Fv(Uc,Vy,M3(kg,{brighter(e){return e=e==null?v_:Math.pow(v_,e),new Uc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?fg:Math.pow(fg,e),new Uc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Uc(Xd(this.r),Xd(this.g),Xd(this.b),x_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Lx,formatHex:Lx,formatHex8:z8,formatRgb:Bx,toString:Bx}));function Lx(){return`#${Zd(this.r)}${Zd(this.g)}${Zd(this.b)}`}function z8(){return`#${Zd(this.r)}${Zd(this.g)}${Zd(this.b)}${Zd((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bx(){const e=x_(this.opacity);return`${e===1?"rgb(":"rgba("}${Xd(this.r)}, ${Xd(this.g)}, ${Xd(this.b)}${e===1?")":`, ${e})`}`}function x_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Xd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Zd(e){return e=Xd(e),(e<16?"0":"")+e.toString(16)}function zx(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new cA(e,t,n,c)}function P3(e){if(e instanceof cA)return new cA(e.h,e.s,e.l,e.opacity);if(e instanceof kg||(e=tp(e)),!e)return new cA;if(e instanceof cA)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),b=Math.max(t,n,c),I=NaN,a=b-g,G=(b+g)/2;return a?(t===b?I=(n-c)/a+(n<c)*6:n===b?I=(c-t)/a+2:I=(t-n)/a+4,a/=G<.5?b+g:2-b-g,I*=60):a=G>0&&G<1?0:I,new cA(I,a,G,e.opacity)}function R8(e,t,n,c){return arguments.length===1?P3(e):new cA(e,t,n,c??1)}function cA(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}Fv(cA,R8,M3(kg,{brighter(e){return e=e==null?v_:Math.pow(v_,e),new cA(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?fg:Math.pow(fg,e),new cA(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new Uc(F1(e>=240?e-240:e+120,g,c),F1(e,g,c),F1(e<120?e+240:e-120,g,c),this.opacity)},clamp(){return new cA(Rx(this.h),qg(this.s),qg(this.l),x_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=x_(this.opacity);return`${e===1?"hsl(":"hsla("}${Rx(this.h)}, ${qg(this.s)*100}%, ${qg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Rx(e){return e=(e||0)%360,e<0?e+360:e}function qg(e){return Math.max(0,Math.min(1,e||0))}function F1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Ov=e=>()=>e;function F8(e,t){return function(n){return e+n*t}}function O8(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function N8(e){return(e=+e)==1?D3:function(t,n){return n-t?O8(t,n,e):Ov(isNaN(t)?n:t)}}function D3(e,t){var n=t-e;return n?F8(e,n):Ov(isNaN(e)?t:e)}const b_=function e(t){var n=N8(t);function c(g,b){var I=n((g=Vy(g)).r,(b=Vy(b)).r),a=n(g.g,b.g),G=n(g.b,b.b),W=D3(g.opacity,b.opacity);return function(he){return g.r=I(he),g.g=a(he),g.b=G(he),g.opacity=W(he),g+""}}return c.gamma=e,c}(1);function V8(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(b){for(g=0;g<n;++g)c[g]=e[g]*(1-b)+t[g]*b;return c}}function U8(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function G8(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),b=new Array(n),I;for(I=0;I<c;++I)g[I]=Nv(e[I],t[I]);for(;I<n;++I)b[I]=t[I];return function(a){for(I=0;I<c;++I)b[I]=g[I](a);return b}}function q8(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function lA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function H8(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=Nv(e[g],t[g]):c[g]=t[g];return function(b){for(g in n)c[g]=n[g](b);return c}}var Uy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,O1=new RegExp(Uy.source,"g");function j8(e){return function(){return e}}function Z8(e){return function(t){return e(t)+""}}function L3(e,t){var n=Uy.lastIndex=O1.lastIndex=0,c,g,b,I=-1,a=[],G=[];for(e=e+"",t=t+"";(c=Uy.exec(e))&&(g=O1.exec(t));)(b=g.index)>n&&(b=t.slice(n,b),a[I]?a[I]+=b:a[++I]=b),(c=c[0])===(g=g[0])?a[I]?a[I]+=g:a[++I]=g:(a[++I]=null,G.push({i:I,x:lA(c,g)})),n=O1.lastIndex;return n<t.length&&(b=t.slice(n),a[I]?a[I]+=b:a[++I]=b),a.length<2?G[0]?Z8(G[0].x):j8(t):(t=G.length,function(W){for(var he=0,ae;he<t;++he)a[(ae=G[he]).i]=ae.x(W);return a.join("")})}function Nv(e,t){var n=typeof t,c;return t==null||n==="boolean"?Ov(t):(n==="number"?lA:n==="string"?(c=tp(t))?(t=c,b_):L3:t instanceof tp?b_:t instanceof Date?q8:U8(t)?V8:Array.isArray(t)?G8:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?H8:lA)(e,t)}function Q8(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Fx=180/Math.PI,Gy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function B3(e,t,n,c,g,b){var I,a,G;return(I=Math.sqrt(e*e+t*t))&&(e/=I,t/=I),(G=e*n+t*c)&&(n-=e*G,c-=t*G),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,G/=a),e*c<t*n&&(e=-e,t=-t,G=-G,I=-I),{translateX:g,translateY:b,rotate:Math.atan2(t,e)*Fx,skewX:Math.atan(G)*Fx,scaleX:I,scaleY:a}}var Hg;function W8(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Gy:B3(t.a,t.b,t.c,t.d,t.e,t.f)}function X8(e){return e==null||(Hg||(Hg=document.createElementNS("http://www.w3.org/2000/svg","g")),Hg.setAttribute("transform",e),!(e=Hg.transform.baseVal.consolidate()))?Gy:(e=e.matrix,B3(e.a,e.b,e.c,e.d,e.e,e.f))}function z3(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function b(W,he,ae,ue,be,Ke){if(W!==ae||he!==ue){var ot=be.push("translate(",null,t,null,n);Ke.push({i:ot-4,x:lA(W,ae)},{i:ot-2,x:lA(he,ue)})}else(ae||ue)&&be.push("translate("+ae+t+ue+n)}function I(W,he,ae,ue){W!==he?(W-he>180?he+=360:he-W>180&&(W+=360),ue.push({i:ae.push(g(ae)+"rotate(",null,c)-2,x:lA(W,he)})):he&&ae.push(g(ae)+"rotate("+he+c)}function a(W,he,ae,ue){W!==he?ue.push({i:ae.push(g(ae)+"skewX(",null,c)-2,x:lA(W,he)}):he&&ae.push(g(ae)+"skewX("+he+c)}function G(W,he,ae,ue,be,Ke){if(W!==ae||he!==ue){var ot=be.push(g(be)+"scale(",null,",",null,")");Ke.push({i:ot-4,x:lA(W,ae)},{i:ot-2,x:lA(he,ue)})}else(ae!==1||ue!==1)&&be.push(g(be)+"scale("+ae+","+ue+")")}return function(W,he){var ae=[],ue=[];return W=e(W),he=e(he),b(W.translateX,W.translateY,he.translateX,he.translateY,ae,ue),I(W.rotate,he.rotate,ae,ue),a(W.skewX,he.skewX,ae,ue),G(W.scaleX,W.scaleY,he.scaleX,he.scaleY,ae,ue),W=he=null,function(be){for(var Ke=-1,ot=ue.length,tt;++Ke<ot;)ae[(tt=ue[Ke]).i]=tt.x(be);return ae.join("")}}}var Y8=z3(W8,"px, ","px)","deg)"),$8=z3(X8,", ",")",")"),pm=0,rg=0,Zm=0,R3=1e3,w_,sg,S_=0,ip=0,K_=0,pg=typeof performance=="object"&&performance.now?performance:Date,F3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Vv(){return ip||(F3(K8),ip=pg.now()+K_)}function K8(){ip=0}function I_(){this._call=this._time=this._next=null}I_.prototype=O3.prototype={constructor:I_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Vv():+n)+(t==null?0:+t),!this._next&&sg!==this&&(sg?sg._next=this:w_=this,sg=this),this._call=e,this._time=n,qy()},stop:function(){this._call&&(this._call=null,this._time=1/0,qy())}};function O3(e,t,n){var c=new I_;return c.restart(e,t,n),c}function J8(){Vv(),++pm;for(var e=w_,t;e;)(t=ip-e._time)>=0&&e._call.call(void 0,t),e=e._next;--pm}function Ox(){ip=(S_=pg.now())+K_,pm=rg=0;try{J8()}finally{pm=0,tk(),ip=0}}function ek(){var e=pg.now(),t=e-S_;t>R3&&(K_-=t,S_=e)}function tk(){for(var e,t=w_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:w_=n);sg=e,qy(c)}function qy(e){if(!pm){rg&&(rg=clearTimeout(rg));var t=e-ip;t>24?(e<1/0&&(rg=setTimeout(Ox,e-pg.now()-K_)),Zm&&(Zm=clearInterval(Zm))):(Zm||(S_=pg.now(),Zm=setInterval(ek,R3)),pm=1,F3(Ox))}}function Nx(e,t,n){var c=new I_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var ik=g3("start","end","cancel","interrupt"),nk=[],N3=0,Vx=1,Hy=2,n_=3,Ux=4,jy=5,r_=6;function J_(e,t,n,c,g,b){var I=e.__transition;if(!I)e.__transition={};else if(n in I)return;rk(e,n,{name:t,index:c,group:g,on:ik,tween:nk,time:b.time,delay:b.delay,duration:b.duration,ease:b.ease,timer:null,state:N3})}function Uv(e,t){var n=hA(e,t);if(n.state>N3)throw new Error("too late; already scheduled");return n}function rf(e,t){var n=hA(e,t);if(n.state>n_)throw new Error("too late; already running");return n}function hA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function rk(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=O3(b,0,n.time);function b(W){n.state=Vx,n.timer.restart(I,n.delay,n.time),n.delay<=W&&I(W-n.delay)}function I(W){var he,ae,ue,be;if(n.state!==Vx)return G();for(he in c)if(be=c[he],be.name===n.name){if(be.state===n_)return Nx(I);be.state===Ux?(be.state=r_,be.timer.stop(),be.on.call("interrupt",e,e.__data__,be.index,be.group),delete c[he]):+he<t&&(be.state=r_,be.timer.stop(),be.on.call("cancel",e,e.__data__,be.index,be.group),delete c[he])}if(Nx(function(){n.state===n_&&(n.state=Ux,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=Hy,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Hy){for(n.state=n_,g=new Array(ue=n.tween.length),he=0,ae=-1;he<ue;++he)(be=n.tween[he].value.call(e,e.__data__,n.index,n.group))&&(g[++ae]=be);g.length=ae+1}}function a(W){for(var he=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(G),n.state=jy,1),ae=-1,ue=g.length;++ae<ue;)g[ae].call(e,he);n.state===jy&&(n.on.call("end",e,e.__data__,n.index,n.group),G())}function G(){n.state=r_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function sk(e,t){var n=e.__transition,c,g,b=!0,I;if(n){t=t==null?null:t+"";for(I in n){if((c=n[I]).name!==t){b=!1;continue}g=c.state>Hy&&c.state<jy,c.state=r_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[I]}b&&delete e.__transition}}function ak(e){return this.each(function(){sk(this,e)})}function ok(e,t){var n,c;return function(){var g=rf(this,e),b=g.tween;if(b!==n){c=n=b;for(var I=0,a=c.length;I<a;++I)if(c[I].name===t){c=c.slice(),c.splice(I,1);break}}g.tween=c}}function lk(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var b=rf(this,e),I=b.tween;if(I!==c){g=(c=I).slice();for(var a={name:t,value:n},G=0,W=g.length;G<W;++G)if(g[G].name===t){g[G]=a;break}G===W&&g.push(a)}b.tween=g}}function uk(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=hA(this.node(),n).tween,g=0,b=c.length,I;g<b;++g)if((I=c[g]).name===e)return I.value;return null}return this.each((t==null?ok:lk)(n,e,t))}function Gv(e,t,n){var c=e._id;return e.each(function(){var g=rf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return hA(g,c).value[t]}}function V3(e,t){var n;return(typeof t=="number"?lA:t instanceof tp?b_:(n=tp(t))?(t=n,b_):L3)(e,t)}function ck(e){return function(){this.removeAttribute(e)}}function hk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ak(e,t,n){var c,g=n+"",b;return function(){var I=this.getAttribute(e);return I===g?null:I===c?b:b=t(c=I,n)}}function fk(e,t,n){var c,g=n+"",b;return function(){var I=this.getAttributeNS(e.space,e.local);return I===g?null:I===c?b:b=t(c=I,n)}}function dk(e,t,n){var c,g,b;return function(){var I,a=n(this),G;return a==null?void this.removeAttribute(e):(I=this.getAttribute(e),G=a+"",I===G?null:I===c&&G===g?b:(g=G,b=t(c=I,a)))}}function pk(e,t,n){var c,g,b;return function(){var I,a=n(this),G;return a==null?void this.removeAttributeNS(e.space,e.local):(I=this.getAttributeNS(e.space,e.local),G=a+"",I===G?null:I===c&&G===g?b:(g=G,b=t(c=I,a)))}}function mk(e,t){var n=$_(e),c=n==="transform"?$8:V3;return this.attrTween(e,typeof t=="function"?(n.local?pk:dk)(n,c,Gv(this,"attr."+e,t)):t==null?(n.local?hk:ck)(n):(n.local?fk:Ak)(n,c,t))}function gk(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function _k(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function yk(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&_k(e,b)),n}return g._value=t,g}function vk(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&gk(e,b)),n}return g._value=t,g}function xk(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=$_(e);return this.tween(n,(c.local?yk:vk)(c,t))}function bk(e,t){return function(){Uv(this,e).delay=+t.apply(this,arguments)}}function wk(e,t){return t=+t,function(){Uv(this,e).delay=t}}function Sk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?bk:wk)(t,e)):hA(this.node(),t).delay}function Ik(e,t){return function(){rf(this,e).duration=+t.apply(this,arguments)}}function Ek(e,t){return t=+t,function(){rf(this,e).duration=t}}function Ck(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ik:Ek)(t,e)):hA(this.node(),t).duration}function Tk(e,t){if(typeof t!="function")throw new Error;return function(){rf(this,e).ease=t}}function kk(e){var t=this._id;return arguments.length?this.each(Tk(t,e)):hA(this.node(),t).ease}function Mk(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;rf(this,e).ease=n}}function Pk(e){if(typeof e!="function")throw new Error;return this.each(Mk(this._id,e))}function Dk(e){typeof e!="function"&&(e=v3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],I=b.length,a=c[g]=[],G,W=0;W<I;++W)(G=b[W])&&e.call(G,G.__data__,W,b)&&a.push(G);return new i0(c,this._parents,this._name,this._id)}function Lk(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,b=Math.min(c,g),I=new Array(c),a=0;a<b;++a)for(var G=t[a],W=n[a],he=G.length,ae=I[a]=new Array(he),ue,be=0;be<he;++be)(ue=G[be]||W[be])&&(ae[be]=ue);for(;a<c;++a)I[a]=t[a];return new i0(I,this._parents,this._name,this._id)}function Bk(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function zk(e,t,n){var c,g,b=Bk(t)?Uv:rf;return function(){var I=b(this,e),a=I.on;a!==c&&(g=(c=a).copy()).on(t,n),I.on=g}}function Rk(e,t){var n=this._id;return arguments.length<2?hA(this.node(),n).on.on(e):this.each(zk(n,e,t))}function Fk(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Ok(){return this.on("end.remove",Fk(this._id))}function Nk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=zv(e));for(var c=this._groups,g=c.length,b=new Array(g),I=0;I<g;++I)for(var a=c[I],G=a.length,W=b[I]=new Array(G),he,ae,ue=0;ue<G;++ue)(he=a[ue])&&(ae=e.call(he,he.__data__,ue,a))&&("__data__"in he&&(ae.__data__=he.__data__),W[ue]=ae,J_(W[ue],t,n,ue,W,hA(he,n)));return new i0(b,this._parents,t,n)}function Vk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=y3(e));for(var c=this._groups,g=c.length,b=[],I=[],a=0;a<g;++a)for(var G=c[a],W=G.length,he,ae=0;ae<W;++ae)if(he=G[ae]){for(var ue=e.call(he,he.__data__,ae,G),be,Ke=hA(he,n),ot=0,tt=ue.length;ot<tt;++ot)(be=ue[ot])&&J_(be,t,n,ot,ue,Ke);b.push(ue),I.push(he)}return new i0(b,I,t,n)}var Uk=Tg.prototype.constructor;function Gk(){return new Uk(this._groups,this._parents)}function qk(e,t){var n,c,g;return function(){var b=dm(this,e),I=(this.style.removeProperty(e),dm(this,e));return b===I?null:b===n&&I===c?g:g=t(n=b,c=I)}}function U3(e){return function(){this.style.removeProperty(e)}}function Hk(e,t,n){var c,g=n+"",b;return function(){var I=dm(this,e);return I===g?null:I===c?b:b=t(c=I,n)}}function jk(e,t,n){var c,g,b;return function(){var I=dm(this,e),a=n(this),G=a+"";return a==null&&(G=a=(this.style.removeProperty(e),dm(this,e))),I===G?null:I===c&&G===g?b:(g=G,b=t(c=I,a))}}function Zk(e,t){var n,c,g,b="style."+t,I="end."+b,a;return function(){var G=rf(this,e),W=G.on,he=G.value[b]==null?a||(a=U3(t)):void 0;(W!==n||g!==he)&&(c=(n=W).copy()).on(I,g=he),G.on=c}}function Qk(e,t,n){var c=(e+="")=="transform"?Y8:V3;return t==null?this.styleTween(e,qk(e,c)).on("end.style."+e,U3(e)):typeof t=="function"?this.styleTween(e,jk(e,c,Gv(this,"style."+e,t))).each(Zk(this._id,e)):this.styleTween(e,Hk(e,c,t),n).on("end.style."+e,null)}function Wk(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function Xk(e,t,n){var c,g;function b(){var I=t.apply(this,arguments);return I!==g&&(c=(g=I)&&Wk(e,I,n)),c}return b._value=t,b}function Yk(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,Xk(e,t,n??""))}function $k(e){return function(){this.textContent=e}}function Kk(e){return function(){var t=e(this);this.textContent=t??""}}function Jk(e){return this.tween("text",typeof e=="function"?Kk(Gv(this,"text",e)):$k(e==null?"":e+""))}function eM(e){return function(t){this.textContent=e.call(this,t)}}function tM(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&eM(g)),t}return c._value=e,c}function iM(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,tM(e))}function nM(){for(var e=this._name,t=this._id,n=G3(),c=this._groups,g=c.length,b=0;b<g;++b)for(var I=c[b],a=I.length,G,W=0;W<a;++W)if(G=I[W]){var he=hA(G,t);J_(G,e,n,W,I,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new i0(c,this._parents,e,n)}function rM(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(b,I){var a={value:I},G={value:function(){--g===0&&b()}};n.each(function(){var W=rf(this,c),he=W.on;he!==e&&(t=(e=he).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(G)),W.on=t}),g===0&&b()})}var sM=0;function i0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function G3(){return++sM}var Qf=Tg.prototype;i0.prototype={constructor:i0,select:Nk,selectAll:Vk,selectChild:Qf.selectChild,selectChildren:Qf.selectChildren,filter:Dk,merge:Lk,selection:Gk,transition:nM,call:Qf.call,nodes:Qf.nodes,node:Qf.node,size:Qf.size,empty:Qf.empty,each:Qf.each,on:Rk,attr:mk,attrTween:xk,style:Qk,styleTween:Yk,text:Jk,textTween:iM,remove:Ok,tween:uk,delay:Sk,duration:Ck,ease:kk,easeVarying:Pk,end:rM,[Symbol.iterator]:Qf[Symbol.iterator]};function aM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var oM={time:null,delay:0,duration:250,ease:aM};function lM(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function uM(e){var t,n;e instanceof i0?(t=e._id,e=e._name):(t=G3(),(n=oM).time=Vv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,b=0;b<g;++b)for(var I=c[b],a=I.length,G,W=0;W<a;++W)(G=I[W])&&J_(G,e,t,W,I,n||lM(G,t));return new i0(c,this._parents,e,t)}Tg.prototype.interrupt=ak;Tg.prototype.transition=uM;const Zy=Math.PI,Qy=2*Zy,Hd=1e-6,cM=Qy-Hd;function q3(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function hM(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return q3;const n=10**t;return function(c){this._+=c[0];for(let g=1,b=c.length;g<b;++g)this._+=Math.round(arguments[g]*n)/n+c[g]}}let AM=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?q3:hM(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,c,g){this._append`Q${+t},${+n},${this._x1=+c},${this._y1=+g}`}bezierCurveTo(t,n,c,g,b,I){this._append`C${+t},${+n},${+c},${+g},${this._x1=+b},${this._y1=+I}`}arcTo(t,n,c,g,b){if(t=+t,n=+n,c=+c,g=+g,b=+b,b<0)throw new Error(`negative radius: ${b}`);let I=this._x1,a=this._y1,G=c-t,W=g-n,he=I-t,ae=a-n,ue=he*he+ae*ae;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(ue>Hd)if(!(Math.abs(ae*G-W*he)>Hd)||!b)this._append`L${this._x1=t},${this._y1=n}`;else{let be=c-I,Ke=g-a,ot=G*G+W*W,tt=be*be+Ke*Ke,lt=Math.sqrt(ot),ut=Math.sqrt(ue),Tt=b*Math.tan((Zy-Math.acos((ot+ue-tt)/(2*lt*ut)))/2),Pt=Tt/ut,zt=Tt/lt;Math.abs(Pt-1)>Hd&&this._append`L${t+Pt*he},${n+Pt*ae}`,this._append`A${b},${b},0,0,${+(ae*be>he*Ke)},${this._x1=t+zt*G},${this._y1=n+zt*W}`}}arc(t,n,c,g,b,I){if(t=+t,n=+n,c=+c,I=!!I,c<0)throw new Error(`negative radius: ${c}`);let a=c*Math.cos(g),G=c*Math.sin(g),W=t+a,he=n+G,ae=1^I,ue=I?g-b:b-g;this._x1===null?this._append`M${W},${he}`:(Math.abs(this._x1-W)>Hd||Math.abs(this._y1-he)>Hd)&&this._append`L${W},${he}`,c&&(ue<0&&(ue=ue%Qy+Qy),ue>cM?this._append`A${c},${c},0,1,${ae},${t-a},${n-G}A${c},${c},0,1,${ae},${this._x1=W},${this._y1=he}`:ue>Hd&&this._append`A${c},${c},0,${+(ue>=Zy)},${ae},${this._x1=t+c*Math.cos(b)},${this._y1=n+c*Math.sin(b)}`)}rect(t,n,c,g){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${c=+c}v${+g}h${-c}Z`}toString(){return this._}};function fM(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function E_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function mm(e){return e=E_(Math.abs(e)),e?e[1]:NaN}function dM(e,t){return function(n,c){for(var g=n.length,b=[],I=0,a=e[0],G=0;g>0&&a>0&&(G+a+1>c&&(a=Math.max(1,c-G)),b.push(n.substring(g-=a,g+a)),!((G+=a+1)>c));)a=e[I=(I+1)%e.length];return b.reverse().join(t)}}function pM(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var mM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function C_(e){if(!(t=mM.exec(e)))throw new Error("invalid format: "+e);var t;return new qv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}C_.prototype=qv.prototype;function qv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}qv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gM(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var H3;function _M(e,t){var n=E_(e,t);if(!n)return e+"";var c=n[0],g=n[1],b=g-(H3=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,I=c.length;return b===I?c:b>I?c+new Array(b-I+1).join("0"):b>0?c.slice(0,b)+"."+c.slice(b):"0."+new Array(1-b).join("0")+E_(e,Math.max(0,t+b-1))[0]}function Gx(e,t){var n=E_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const qx={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:fM,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Gx(e*100,t),r:Gx,s:_M,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Hx(e){return e}var jx=Array.prototype.map,Zx=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function yM(e){var t=e.grouping===void 0||e.thousands===void 0?Hx:dM(jx.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",b=e.numerals===void 0?Hx:pM(jx.call(e.numerals,String)),I=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",G=e.nan===void 0?"NaN":e.nan+"";function W(ae){ae=C_(ae);var ue=ae.fill,be=ae.align,Ke=ae.sign,ot=ae.symbol,tt=ae.zero,lt=ae.width,ut=ae.comma,Tt=ae.precision,Pt=ae.trim,zt=ae.type;zt==="n"?(ut=!0,zt="g"):qx[zt]||(Tt===void 0&&(Tt=12),Pt=!0,zt="g"),(tt||ue==="0"&&be==="=")&&(tt=!0,ue="0",be="=");var Ge=ot==="$"?n:ot==="#"&&/[boxX]/.test(zt)?"0"+zt.toLowerCase():"",Xt=ot==="$"?c:/[%p]/.test(zt)?I:"",rt=qx[zt],yt=/[defgprs%]/.test(zt);Tt=Tt===void 0?6:/[gprs]/.test(zt)?Math.max(1,Math.min(21,Tt)):Math.max(0,Math.min(20,Tt));function pt(gt){var bt=Ge,dt=Xt,$e,mt,st;if(zt==="c")dt=rt(gt)+dt,gt="";else{gt=+gt;var Nt=gt<0||1/gt<0;if(gt=isNaN(gt)?G:rt(Math.abs(gt),Tt),Pt&&(gt=gM(gt)),Nt&&+gt==0&&Ke!=="+"&&(Nt=!1),bt=(Nt?Ke==="("?Ke:a:Ke==="-"||Ke==="("?"":Ke)+bt,dt=(zt==="s"?Zx[8+H3/3]:"")+dt+(Nt&&Ke==="("?")":""),yt){for($e=-1,mt=gt.length;++$e<mt;)if(st=gt.charCodeAt($e),48>st||st>57){dt=(st===46?g+gt.slice($e+1):gt.slice($e))+dt,gt=gt.slice(0,$e);break}}}ut&&!tt&&(gt=t(gt,1/0));var Rt=bt.length+gt.length+dt.length,Ot=Rt<lt?new Array(lt-Rt+1).join(ue):"";switch(ut&&tt&&(gt=t(Ot+gt,Ot.length?lt-dt.length:1/0),Ot=""),be){case"<":gt=bt+gt+dt+Ot;break;case"=":gt=bt+Ot+gt+dt;break;case"^":gt=Ot.slice(0,Rt=Ot.length>>1)+bt+gt+dt+Ot.slice(Rt);break;default:gt=Ot+bt+gt+dt;break}return b(gt)}return pt.toString=function(){return ae+""},pt}function he(ae,ue){var be=W((ae=C_(ae),ae.type="f",ae)),Ke=Math.max(-8,Math.min(8,Math.floor(mm(ue)/3)))*3,ot=Math.pow(10,-Ke),tt=Zx[8+Ke/3];return function(lt){return be(ot*lt)+tt}}return{format:W,formatPrefix:he}}var jg,j3,Z3;vM({thousands:",",grouping:[3],currency:["$",""]});function vM(e){return jg=yM(e),j3=jg.format,Z3=jg.formatPrefix,jg}function xM(e){return Math.max(0,-mm(Math.abs(e)))}function bM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mm(t)/3)))*3-mm(Math.abs(e)))}function wM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mm(t)-mm(e))+1}function SM(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function IM(e){return function(){return e}}function EM(e){return+e}var Qx=[0,1];function im(e){return e}function Wy(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:IM(isNaN(t)?NaN:.5)}function CM(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function TM(e,t,n){var c=e[0],g=e[1],b=t[0],I=t[1];return g<c?(c=Wy(g,c),b=n(I,b)):(c=Wy(c,g),b=n(b,I)),function(a){return b(c(a))}}function kM(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),b=new Array(c),I=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++I<c;)g[I]=Wy(e[I],e[I+1]),b[I]=n(t[I],t[I+1]);return function(a){var G=MT(e,a,1,c)-1;return b[G](g[G](a))}}function MM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function PM(){var e=Qx,t=Qx,n=Nv,c,g,b,I=im,a,G,W;function he(){var ue=Math.min(e.length,t.length);return I!==im&&(I=CM(e[0],e[ue-1])),a=ue>2?kM:TM,G=W=null,ae}function ae(ue){return ue==null||isNaN(ue=+ue)?b:(G||(G=a(e.map(c),t,n)))(c(I(ue)))}return ae.invert=function(ue){return I(g((W||(W=a(t,e.map(c),lA)))(ue)))},ae.domain=function(ue){return arguments.length?(e=Array.from(ue,EM),he()):e.slice()},ae.range=function(ue){return arguments.length?(t=Array.from(ue),he()):t.slice()},ae.rangeRound=function(ue){return t=Array.from(ue),n=Q8,he()},ae.clamp=function(ue){return arguments.length?(I=ue?!0:im,he()):I!==im},ae.interpolate=function(ue){return arguments.length?(n=ue,he()):n},ae.unknown=function(ue){return arguments.length?(b=ue,ae):b},function(ue,be){return c=ue,g=be,he()}}function DM(){return PM()(im,im)}function LM(e,t,n,c){var g=zT(e,t,n),b;switch(c=C_(c??",f"),c.type){case"s":{var I=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(b=bM(g,I))&&(c.precision=b),Z3(c,I)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(b=wM(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=b-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(b=xM(g))&&(c.precision=b-(c.type==="%")*2);break}}return j3(c)}function BM(e){var t=e.domain;return e.ticks=function(n){var c=t();return BT(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return LM(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,b=c.length-1,I=c[g],a=c[b],G,W,he=10;for(a<I&&(W=I,I=a,a=W,W=g,g=b,b=W);he-- >0;){if(W=Fy(I,a,n),W===G)return c[g]=I,c[b]=a,t(c);if(W>0)I=Math.floor(I/W)*W,a=Math.ceil(a/W)*W;else if(W<0)I=Math.ceil(I*W)/W,a=Math.floor(a*W)/W;else break;G=W}return e},e}function Xy(){var e=DM();return e.copy=function(){return MM(e,Xy())},SM.apply(e,arguments),BM(e)}function Lu(e){return function(){return e}}function Q3(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const c=Math.floor(n);if(!(c>=0))throw new RangeError(`invalid digits: ${n}`);t=c}return e},()=>new AM(t)}function W3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function X3(e){this._context=e}X3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Y3(e){return new X3(e)}function $3(e){return e[0]}function K3(e){return e[1]}function Jp(e,t){var n=Lu(!0),c=null,g=Y3,b=null,I=Q3(a);e=typeof e=="function"?e:e===void 0?$3:Lu(e),t=typeof t=="function"?t:t===void 0?K3:Lu(t);function a(G){var W,he=(G=W3(G)).length,ae,ue=!1,be;for(c==null&&(b=g(be=I())),W=0;W<=he;++W)!(W<he&&n(ae=G[W],W,G))===ue&&((ue=!ue)?b.lineStart():b.lineEnd()),ue&&b.point(+e(ae,W,G),+t(ae,W,G));if(be)return b=null,be+""||null}return a.x=function(G){return arguments.length?(e=typeof G=="function"?G:Lu(+G),a):e},a.y=function(G){return arguments.length?(t=typeof G=="function"?G:Lu(+G),a):t},a.defined=function(G){return arguments.length?(n=typeof G=="function"?G:Lu(!!G),a):n},a.curve=function(G){return arguments.length?(g=G,c!=null&&(b=g(c)),a):g},a.context=function(G){return arguments.length?(G==null?c=b=null:b=g(c=G),a):c},a}function N1(e,t,n){var c=null,g=Lu(!0),b=null,I=Y3,a=null,G=Q3(W);e=typeof e=="function"?e:e===void 0?$3:Lu(+e),t=typeof t=="function"?t:Lu(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?K3:Lu(+n);function W(ae){var ue,be,Ke,ot=(ae=W3(ae)).length,tt,lt=!1,ut,Tt=new Array(ot),Pt=new Array(ot);for(b==null&&(a=I(ut=G())),ue=0;ue<=ot;++ue){if(!(ue<ot&&g(tt=ae[ue],ue,ae))===lt)if(lt=!lt)be=ue,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),Ke=ue-1;Ke>=be;--Ke)a.point(Tt[Ke],Pt[Ke]);a.lineEnd(),a.areaEnd()}lt&&(Tt[ue]=+e(tt,ue,ae),Pt[ue]=+t(tt,ue,ae),a.point(c?+c(tt,ue,ae):Tt[ue],n?+n(tt,ue,ae):Pt[ue]))}if(ut)return a=null,ut+""||null}function he(){return Jp().defined(g).curve(I).context(b)}return W.x=function(ae){return arguments.length?(e=typeof ae=="function"?ae:Lu(+ae),c=null,W):e},W.x0=function(ae){return arguments.length?(e=typeof ae=="function"?ae:Lu(+ae),W):e},W.x1=function(ae){return arguments.length?(c=ae==null?null:typeof ae=="function"?ae:Lu(+ae),W):c},W.y=function(ae){return arguments.length?(t=typeof ae=="function"?ae:Lu(+ae),n=null,W):t},W.y0=function(ae){return arguments.length?(t=typeof ae=="function"?ae:Lu(+ae),W):t},W.y1=function(ae){return arguments.length?(n=ae==null?null:typeof ae=="function"?ae:Lu(+ae),W):n},W.lineX0=W.lineY0=function(){return he().x(e).y(t)},W.lineY1=function(){return he().x(e).y(n)},W.lineX1=function(){return he().x(c).y(t)},W.defined=function(ae){return arguments.length?(g=typeof ae=="function"?ae:Lu(!!ae),W):g},W.curve=function(ae){return arguments.length?(I=ae,b!=null&&(a=I(b)),W):I},W.context=function(ae){return arguments.length?(ae==null?b=a=null:a=I(b=ae),W):b},W}function Wx(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function J3(e){this._context=e}J3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Wx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Wx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zM(e){return new J3(e)}function ag(e,t,n){this.k=e,this.x=t,this.y=n}ag.prototype={constructor:ag,scale:function(e){return e===1?this:new ag(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ag(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ag.prototype;function Xx(e,t,n){const c=e.slice();return c[34]=t[n],c[36]=n,c}function Yx(e){let t,n,c=bx[e[5]]+"",g,b,I,a,G,W,he,ae,ue,be,Ke,ot,tt,lt,ut,Tt,Pt,zt,Ge,Xt,rt,yt,pt,gt=ph(e[0]),bt=[];for(let dt=0;dt<gt.length;dt+=1)bt[dt]=$x(Xx(e,gt,dt));return{c(){t=Nn("div"),n=Nn("h2"),g=Ja(c),b=Ja(" by tree size"),I=Cr(),a=Ba("svg"),G=Ba("defs"),W=Ba("linearGradient"),he=Ba("stop"),ae=Ba("stop"),ue=Ba("stop"),be=Ba("g"),ot=Ba("g"),lt=Ba("path"),Tt=Ba("g");for(let dt=0;dt<bt.length;dt+=1)bt[dt].c();Pt=Ba("text"),zt=Ja(e[11]),rt=Ba("text"),yt=Ja(e[12]),this.h()},l(dt){t=Vn(dt,"DIV",{class:!0});var $e=bn(t);n=Vn($e,"H2",{class:!0});var mt=bn(n);g=eo(mt,c),b=eo(mt," by tree size"),mt.forEach(bi),I=Tr($e),a=za($e,"svg",{id:!0,viewBox:!0,class:!0});var st=bn(a);G=za(st,"defs",{});var Nt=bn(G);W=za(Nt,"linearGradient",{id:!0,x1:!0,x2:!0,y1:!0,y2:!0});var Rt=bn(W);he=za(Rt,"stop",{class:!0,offset:!0}),bn(he).forEach(bi),ae=za(Rt,"stop",{class:!0,offset:!0}),bn(ae).forEach(bi),ue=za(Rt,"stop",{class:!0,offset:!0}),bn(ue).forEach(bi),Rt.forEach(bi),Nt.forEach(bi),be=za(st,"g",{class:!0,transform:!0}),bn(be).forEach(bi),ot=za(st,"g",{class:!0,transform:!0}),bn(ot).forEach(bi),lt=za(st,"path",{class:!0,fill:!0,stroke:!0,"stroke-width":!0,d:!0}),bn(lt).forEach(bi),Tt=za(st,"g",{class:!0,fill:!0,stroke:!0,"stroke-width":!0});var Ot=bn(Tt);for(let Ti=0;Ti<bt.length;Ti+=1)bt[Ti].l(Ot);Ot.forEach(bi),Pt=za(st,"text",{class:!0,"text-anchor":!0,x:!0,y:!0});var _i=bn(Pt);zt=eo(_i,e[11]),_i.forEach(bi),rt=za(st,"text",{class:!0,"text-anchor":!0,transform:!0,x:!0,y:!0});var Si=bn(rt);yt=eo(Si,e[12]),Si.forEach(bi),st.forEach(bi),$e.forEach(bi),this.h()},h(){Pi(n,"class","svelte-156wt8f"),Pi(he,"class","stop1 svelte-156wt8f"),Pi(he,"offset","0%"),Pi(ae,"class","stop2 svelte-156wt8f"),Pi(ae,"offset","50%"),Pi(ue,"class","stop3 svelte-156wt8f"),Pi(ue,"offset","100%"),Pi(W,"id","Gradient1"),Pi(W,"x1","0"),Pi(W,"x2","0"),Pi(W,"y1","0"),Pi(W,"y2","0.2"),Pi(be,"class","scale x svelte-156wt8f"),Pi(be,"transform",Ke="translate(0,"+(e[2]-e[3])+")"),Pi(ot,"class","scale y svelte-156wt8f"),Pi(ot,"transform",tt="translate("+e[4]+",0)"),Pi(lt,"class","area ci svelte-156wt8f"),Pi(lt,"fill",fm()[300]),Pi(lt,"stroke","currentColor"),Pi(lt,"stroke-width","0"),Pi(lt,"d",ut=e[14](e[10])),Pi(Tt,"class","point"),Pi(Tt,"fill",fm[700]),Pi(Tt,"stroke","currentColor"),Pi(Tt,"stroke-width","1.5"),Pi(Pt,"class","axis-label svelte-156wt8f"),Pi(Pt,"text-anchor","center"),Pi(Pt,"x",Ge=e[1]/2),Pi(Pt,"y",Xt=e[2]+12),Pi(rt,"class","axis-label svelte-156wt8f"),Pi(rt,"text-anchor","center"),Pi(rt,"transform","rotate(-90)"),Pi(rt,"x",e[13]),Pi(rt,"y",-10),Pi(a,"id","viz"),Pi(a,"viewBox",pt=`0 0 ${e[1]} ${e[2]}`),Pi(a,"class","svelte-156wt8f"),Pi(t,"class","graph-container svelte-156wt8f")},m(dt,$e){Gn(dt,t,$e),Zi(t,n),Zi(n,g),Zi(n,b),Zi(t,I),Zi(t,a),Zi(a,G),Zi(G,W),Zi(W,he),Zi(W,ae),Zi(W,ue),Zi(a,be),e[21](be),Zi(a,ot),e[22](ot),Zi(a,lt),Zi(a,Tt);for(let mt=0;mt<bt.length;mt+=1)bt[mt]&&bt[mt].m(Tt,null);Zi(a,Pt),Zi(Pt,zt),Zi(a,rt),Zi(rt,yt)},p(dt,$e){if($e[0]&32&&c!==(c=bx[dt[5]]+"")&&tu(g,c),$e[0]&12&&Ke!==(Ke="translate(0,"+(dt[2]-dt[3])+")")&&Pi(be,"transform",Ke),$e[0]&16&&tt!==(tt="translate("+dt[4]+",0)")&&Pi(ot,"transform",tt),$e[0]&1024&&ut!==(ut=dt[14](dt[10]))&&Pi(lt,"d",ut),$e[0]&769){gt=ph(dt[0]);let mt;for(mt=0;mt<gt.length;mt+=1){const st=Xx(dt,gt,mt);bt[mt]?bt[mt].p(st,$e):(bt[mt]=$x(st),bt[mt].c(),bt[mt].m(Tt,null))}for(;mt<bt.length;mt+=1)bt[mt].d(1);bt.length=gt.length}$e[0]&2048&&tu(zt,dt[11]),$e[0]&2&&Ge!==(Ge=dt[1]/2)&&Pi(Pt,"x",Ge),$e[0]&4&&Xt!==(Xt=dt[2]+12)&&Pi(Pt,"y",Xt),$e[0]&4096&&tu(yt,dt[12]),$e[0]&8192&&Pi(rt,"x",dt[13]),$e[0]&6&&pt!==(pt=`0 0 ${dt[1]} ${dt[2]}`)&&Pi(a,"viewBox",pt)},d(dt){dt&&bi(t),e[21](null),e[22](null),up(bt,dt)}}}function $x(e){let t,n,c;return{c(){t=Ba("circle"),this.h()},l(g){t=za(g,"circle",{key:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),bn(t).forEach(bi),this.h()},h(){Pi(t,"key",e[36]),Pi(t,"cx",n=e[8](e[34][0])),Pi(t,"cy",c=e[9](e[34][1])),Pi(t,"r","5"),Pi(t,"fill",fm[700]),Pi(t,"class","anim-point svelte-156wt8f")},m(g,b){Gn(g,t,b)},p(g,b){b[0]&257&&n!==(n=g[8](g[34][0]))&&Pi(t,"cx",n),b[0]&513&&c!==(c=g[9](g[34][1]))&&Pi(t,"cy",c)},d(g){g&&bi(t)}}}function RM(e){let t,n=e[10]&&e[5]&&Yx(e);return{c(){n&&n.c(),t=Ds()},l(c){n&&n.l(c),t=Ds()},m(c,g){n&&n.m(c,g),Gn(c,t,g)},p(c,g){c[10]&&c[5]?n?n.p(c,g):(n=Yx(c),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:wo,o:wo,d(c){c&&bi(t),n&&n.d(c)}}}function FM(e,t,n){let{data:c}=t,{point:g}=t,{width:b=640}=t,{height:I=400}=t,{marginTop:a=20}=t,{marginRight:G=20}=t,{marginBottom:W=30}=t,{marginLeft:he=40}=t,{metric:ae}=t,ue,be,Ke=null,ot=[0,10],tt=[0,10],lt="",ut="",Tt=0,Pt,zt,{colorScheme:Ge}=t,Xt;function rt(dt){Xt=yT(dt),console.log(Xt),n(10,Ke=Xt.confidence),n(19,ot=Xt.yAxis),n(20,tt=Xt.xAxis),n(11,lt=Xt.xAxisLabel),n(12,ut=Xt.yAxisLabel),n(13,Tt=yt(ut))}function yt(dt){return console.log("label length:",dt.length),-1*(I/2)-dt.length*2.5}const pt=N1().x(dt=>Pt(dt.x)).y0(dt=>zt(Math.max(dt.low,ot[0]))).y1(dt=>zt(Math.min(dt.high,ot[1])));Jp(dt=>Pt(dt.x),dt=>zt(dt.y)),Jp(dt=>Pt(dt.x),dt=>zt(dt.low)),Jp(dt=>Pt(dt.x),dt=>zt(dt.high)),N1().x(dt=>Pt(dt.x)).y0(dt=>zt(dt.high)).y1(dt=>-1*zt(ot[1])),N1().x(dt=>Pt(dt.x)).y0(dt=>zt(ot[0])).y1(dt=>zt(dt.low)),Jp(dt=>Pt(dt.x),dt=>zt(dt.y)).curve(zM);function gt(dt){pa[dt?"unshift":"push"](()=>{ue=dt,n(6,ue)})}function bt(dt){pa[dt?"unshift":"push"](()=>{be=dt,n(7,be)})}return e.$$set=dt=>{"data"in dt&&n(15,c=dt.data),"point"in dt&&n(0,g=dt.point),"width"in dt&&n(1,b=dt.width),"height"in dt&&n(2,I=dt.height),"marginTop"in dt&&n(16,a=dt.marginTop),"marginRight"in dt&&n(17,G=dt.marginRight),"marginBottom"in dt&&n(3,W=dt.marginBottom),"marginLeft"in dt&&n(4,he=dt.marginLeft),"metric"in dt&&n(5,ae=dt.metric),"colorScheme"in dt&&n(18,Ge=dt.colorScheme)},e.$$.update=()=>{e.$$.dirty[0]&262144&&sT(Ge),e.$$.dirty[0]&32&&(Xt=rt(ae)),e.$$.dirty[0]&1179666&&n(8,Pt=Xy(Ix(tt),[he,b-G])),e.$$.dirty[0]&589836&&n(9,zt=Xy(Ix(ot),[I-W,a])),e.$$.dirty[0]&768&&Jp((dt,$e)=>Pt($e),zt),e.$$.dirty[0]&640&&i_(be).call(qT(zt)),e.$$.dirty[0]&320&&i_(ue).call(GT(Pt)),e.$$.dirty[0]&6&&i_("svg").append("div").classed("svg-container",!0).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${b} ${I}`).classed("svg-content-responsive",!0),e.$$.dirty[0]&33&&console.log("relative:",vT(ae,g[0][1],g[0][0]))},[g,b,I,W,he,ae,ue,be,Pt,zt,Ke,lt,ut,Tt,pt,c,a,G,Ge,ot,tt,gt,bt]}class OM extends Lo{constructor(t){super(),Bo(this,t,FM,RM,ho,{data:15,point:0,width:1,height:2,marginTop:16,marginRight:17,marginBottom:3,marginLeft:4,metric:5,colorScheme:18},null,[-1,-1])}}function e4(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function t4(e){let t=e,n=e;e.length===1&&(t=(I,a)=>e(I)-a,n=NM(e));function c(I,a,G,W){for(G==null&&(G=0),W==null&&(W=I.length);G<W;){const he=G+W>>>1;n(I[he],a)<0?G=he+1:W=he}return G}function g(I,a,G,W){for(G==null&&(G=0),W==null&&(W=I.length);G<W;){const he=G+W>>>1;n(I[he],a)>0?W=he:G=he+1}return G}function b(I,a,G,W){G==null&&(G=0),W==null&&(W=I.length);const he=c(I,a,G,W-1);return he>G&&t(I[he-1],a)>-t(I[he],a)?he-1:he}return{left:c,center:b,right:g}}function NM(e){return(t,n)=>e4(e(t),n)}function VM(e){return e===null?NaN:+e}const UM=t4(e4),GM=UM.right;t4(VM).center;var Yy=Math.sqrt(50),$y=Math.sqrt(10),Ky=Math.sqrt(2);function qM(e,t,n){var c,g=-1,b,I,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((c=t<e)&&(b=e,e=t,t=b),(a=i4(e,t,n))===0||!isFinite(a))return[];if(a>0){let G=Math.round(e/a),W=Math.round(t/a);for(G*a<e&&++G,W*a>t&&--W,I=new Array(b=W-G+1);++g<b;)I[g]=(G+g)*a}else{a=-a;let G=Math.round(e*a),W=Math.round(t*a);for(G/a<e&&++G,W/a>t&&--W,I=new Array(b=W-G+1);++g<b;)I[g]=(G+g)/a}return c&&I.reverse(),I}function i4(e,t,n){var c=(t-e)/Math.max(0,n),g=Math.floor(Math.log(c)/Math.LN10),b=c/Math.pow(10,g);return g>=0?(b>=Yy?10:b>=$y?5:b>=Ky?2:1)*Math.pow(10,g):-Math.pow(10,-g)/(b>=Yy?10:b>=$y?5:b>=Ky?2:1)}function HM(e,t,n){var c=Math.abs(t-e)/Math.max(0,n),g=Math.pow(10,Math.floor(Math.log(c)/Math.LN10)),b=c/g;return b>=Yy?g*=10:b>=$y?g*=5:b>=Ky&&(g*=2),t<e?-g:g}function jM(e,t){let n;if(t===void 0)for(const c of e)c!=null&&(n<c||n===void 0&&c>=c)&&(n=c);else{let c=-1;for(let g of e)(g=t(g,++c,e))!=null&&(n<g||n===void 0&&g>=g)&&(n=g)}return n}var V1=Array.prototype.slice;function ZM(e){return e}var s_=1,U1=2,Kx=3,Zg=4,Jx=1e-6;function QM(e){return"translate("+e+",0)"}function WM(e){return"translate(0,"+e+")"}function XM(e){return t=>+e(t)}function YM(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function $M(){return!this.__axis}function KM(e,t){var n=[],c=null,g=null,b=6,I=6,a=3,G=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===s_||e===Zg?-1:1,he=e===Zg||e===U1?"x":"y",ae=e===s_||e===Kx?QM:WM;function ue(be){var Ke=c??(t.ticks?t.ticks.apply(t,n):t.domain()),ot=g??(t.tickFormat?t.tickFormat.apply(t,n):ZM),tt=Math.max(b,0)+a,lt=t.range(),ut=+lt[0]+G,Tt=+lt[lt.length-1]+G,Pt=(t.bandwidth?YM:XM)(t.copy(),G),zt=be.selection?be.selection():be,Ge=zt.selectAll(".domain").data([null]),Xt=zt.selectAll(".tick").data(Ke,t).order(),rt=Xt.exit(),yt=Xt.enter().append("g").attr("class","tick"),pt=Xt.select("line"),gt=Xt.select("text");Ge=Ge.merge(Ge.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Xt=Xt.merge(yt),pt=pt.merge(yt.append("line").attr("stroke","currentColor").attr(he+"2",W*b)),gt=gt.merge(yt.append("text").attr("fill","currentColor").attr(he,W*tt).attr("dy",e===s_?"0em":e===Kx?"0.71em":"0.32em")),be!==zt&&(Ge=Ge.transition(be),Xt=Xt.transition(be),pt=pt.transition(be),gt=gt.transition(be),rt=rt.transition(be).attr("opacity",Jx).attr("transform",function(bt){return isFinite(bt=Pt(bt))?ae(bt+G):this.getAttribute("transform")}),yt.attr("opacity",Jx).attr("transform",function(bt){var dt=this.parentNode.__axis;return ae((dt&&isFinite(dt=dt(bt))?dt:Pt(bt))+G)})),rt.remove(),Ge.attr("d",e===Zg||e===U1?I?"M"+W*I+","+ut+"H"+G+"V"+Tt+"H"+W*I:"M"+G+","+ut+"V"+Tt:I?"M"+ut+","+W*I+"V"+G+"H"+Tt+"V"+W*I:"M"+ut+","+G+"H"+Tt),Xt.attr("opacity",1).attr("transform",function(bt){return ae(Pt(bt)+G)}),pt.attr(he+"2",W*b),gt.attr(he,W*tt).text(ot),zt.filter($M).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===U1?"start":e===Zg?"end":"middle"),zt.each(function(){this.__axis=Pt})}return ue.scale=function(be){return arguments.length?(t=be,ue):t},ue.ticks=function(){return n=V1.call(arguments),ue},ue.tickArguments=function(be){return arguments.length?(n=be==null?[]:V1.call(be),ue):n.slice()},ue.tickValues=function(be){return arguments.length?(c=be==null?null:V1.call(be),ue):c&&c.slice()},ue.tickFormat=function(be){return arguments.length?(g=be,ue):g},ue.tickSize=function(be){return arguments.length?(b=I=+be,ue):b},ue.tickSizeInner=function(be){return arguments.length?(b=+be,ue):b},ue.tickSizeOuter=function(be){return arguments.length?(I=+be,ue):I},ue.tickPadding=function(be){return arguments.length?(a=+be,ue):a},ue.offset=function(be){return arguments.length?(G=+be,ue):G},ue}function JM(e){return KM(s_,e)}var eP={value:()=>{}};function e1(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new a_(n)}function a_(e){this._=e}function tP(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}a_.prototype=e1.prototype={constructor:a_,on:function(e,t){var n=this._,c=tP(e+"",n),g,b=-1,I=c.length;if(arguments.length<2){for(;++b<I;)if((g=(e=c[b]).type)&&(g=iP(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++b<I;)if(g=(e=c[b]).type)n[g]=eb(n[g],e.name,t);else if(t==null)for(g in n)n[g]=eb(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new a_(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,b;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(b=this._[e],c=0,g=b.length;c<g;++c)b[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,b=c.length;g<b;++g)c[g].value.apply(t,n)}};function iP(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function eb(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=eP,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var Jy="http://www.w3.org/1999/xhtml";const tb={svg:"http://www.w3.org/2000/svg",xhtml:Jy,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function t1(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),tb.hasOwnProperty(t)?{space:tb[t],local:e}:e}function nP(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Jy&&t.documentElement.namespaceURI===Jy?t.createElement(e):t.createElementNS(n,e)}}function rP(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Hv(e){var t=t1(e);return(t.local?rP:nP)(t)}function sP(){}function jv(e){return e==null?sP:function(){return this.querySelector(e)}}function aP(e){typeof e!="function"&&(e=jv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],I=b.length,a=c[g]=new Array(I),G,W,he=0;he<I;++he)(G=b[he])&&(W=e.call(G,G.__data__,he,b))&&("__data__"in G&&(W.__data__=G.__data__),a[he]=W);return new qc(c,this._parents)}function n4(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function oP(){return[]}function r4(e){return e==null?oP:function(){return this.querySelectorAll(e)}}function lP(e){return function(){var t=e.apply(this,arguments);return t==null?[]:n4(t)}}function uP(e){typeof e=="function"?e=lP(e):e=r4(e);for(var t=this._groups,n=t.length,c=[],g=[],b=0;b<n;++b)for(var I=t[b],a=I.length,G,W=0;W<a;++W)(G=I[W])&&(c.push(e.call(G,G.__data__,W,I)),g.push(G));return new qc(c,g)}function s4(e){return function(){return this.matches(e)}}function a4(e){return function(t){return t.matches(e)}}var cP=Array.prototype.find;function hP(e){return function(){return cP.call(this.children,e)}}function AP(){return this.firstElementChild}function fP(e){return this.select(e==null?AP:hP(typeof e=="function"?e:a4(e)))}var dP=Array.prototype.filter;function pP(){return this.children}function mP(e){return function(){return dP.call(this.children,e)}}function gP(e){return this.selectAll(e==null?pP:mP(typeof e=="function"?e:a4(e)))}function _P(e){typeof e!="function"&&(e=s4(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],I=b.length,a=c[g]=[],G,W=0;W<I;++W)(G=b[W])&&e.call(G,G.__data__,W,b)&&a.push(G);return new qc(c,this._parents)}function o4(e){return new Array(e.length)}function yP(){return new qc(this._enter||this._groups.map(o4),this._parents)}function T_(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}T_.prototype={constructor:T_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function vP(e){return function(){return e}}function xP(e,t,n,c,g,b){for(var I=0,a,G=t.length,W=b.length;I<W;++I)(a=t[I])?(a.__data__=b[I],c[I]=a):n[I]=new T_(e,b[I]);for(;I<G;++I)(a=t[I])&&(g[I]=a)}function bP(e,t,n,c,g,b,I){var a,G,W=new Map,he=t.length,ae=b.length,ue=new Array(he),be;for(a=0;a<he;++a)(G=t[a])&&(ue[a]=be=I.call(G,G.__data__,a,t)+"",W.has(be)?g[a]=G:W.set(be,G));for(a=0;a<ae;++a)be=I.call(e,b[a],a,b)+"",(G=W.get(be))?(c[a]=G,G.__data__=b[a],W.delete(be)):n[a]=new T_(e,b[a]);for(a=0;a<he;++a)(G=t[a])&&W.get(ue[a])===G&&(g[a]=G)}function wP(e){return e.__data__}function SP(e,t){if(!arguments.length)return Array.from(this,wP);var n=t?bP:xP,c=this._parents,g=this._groups;typeof e!="function"&&(e=vP(e));for(var b=g.length,I=new Array(b),a=new Array(b),G=new Array(b),W=0;W<b;++W){var he=c[W],ae=g[W],ue=ae.length,be=n4(e.call(he,he&&he.__data__,W,c)),Ke=be.length,ot=a[W]=new Array(Ke),tt=I[W]=new Array(Ke),lt=G[W]=new Array(ue);n(he,ae,ot,tt,lt,be,t);for(var ut=0,Tt=0,Pt,zt;ut<Ke;++ut)if(Pt=ot[ut]){for(ut>=Tt&&(Tt=ut+1);!(zt=tt[Tt])&&++Tt<Ke;);Pt._next=zt||null}}return I=new qc(I,c),I._enter=a,I._exit=G,I}function IP(){return new qc(this._exit||this._groups.map(o4),this._parents)}function EP(e,t,n){var c=this.enter(),g=this,b=this.exit();return c=typeof e=="function"?e(c):c.append(e+""),t!=null&&(g=t(g)),n==null?b.remove():n(b),c&&g?c.merge(g).order():g}function CP(e){if(!(e instanceof qc))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,c=t.length,g=n.length,b=Math.min(c,g),I=new Array(c),a=0;a<b;++a)for(var G=t[a],W=n[a],he=G.length,ae=I[a]=new Array(he),ue,be=0;be<he;++be)(ue=G[be]||W[be])&&(ae[be]=ue);for(;a<c;++a)I[a]=t[a];return new qc(I,this._parents)}function TP(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,b=c[g],I;--g>=0;)(I=c[g])&&(b&&I.compareDocumentPosition(b)^4&&b.parentNode.insertBefore(I,b),b=I);return this}function kP(e){e||(e=MP);function t(ae,ue){return ae&&ue?e(ae.__data__,ue.__data__):!ae-!ue}for(var n=this._groups,c=n.length,g=new Array(c),b=0;b<c;++b){for(var I=n[b],a=I.length,G=g[b]=new Array(a),W,he=0;he<a;++he)(W=I[he])&&(G[he]=W);G.sort(t)}return new qc(g,this._parents).order()}function MP(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function PP(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function DP(){return Array.from(this)}function LP(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length;g<b;++g){var I=c[g];if(I)return I}return null}function BP(){let e=0;for(const t of this)++e;return e}function zP(){return!this.node()}function RP(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],b=0,I=g.length,a;b<I;++b)(a=g[b])&&e.call(a,a.__data__,b,g);return this}function FP(e){return function(){this.removeAttribute(e)}}function OP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function NP(e,t){return function(){this.setAttribute(e,t)}}function VP(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function UP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function GP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function qP(e,t){var n=t1(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?OP:FP:typeof t=="function"?n.local?GP:UP:n.local?VP:NP)(n,t))}function l4(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function HP(e){return function(){this.style.removeProperty(e)}}function jP(e,t,n){return function(){this.style.setProperty(e,t,n)}}function ZP(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function QP(e,t,n){return arguments.length>1?this.each((t==null?HP:typeof t=="function"?ZP:jP)(e,t,n??"")):gm(this.node(),e)}function gm(e,t){return e.style.getPropertyValue(t)||l4(e).getComputedStyle(e,null).getPropertyValue(t)}function WP(e){return function(){delete this[e]}}function XP(e,t){return function(){this[e]=t}}function YP(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function $P(e,t){return arguments.length>1?this.each((t==null?WP:typeof t=="function"?YP:XP)(e,t)):this.node()[e]}function u4(e){return e.trim().split(/^|\s+/)}function Zv(e){return e.classList||new c4(e)}function c4(e){this._node=e,this._names=u4(e.getAttribute("class")||"")}c4.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function h4(e,t){for(var n=Zv(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function A4(e,t){for(var n=Zv(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function KP(e){return function(){h4(this,e)}}function JP(e){return function(){A4(this,e)}}function eD(e,t){return function(){(t.apply(this,arguments)?h4:A4)(this,e)}}function tD(e,t){var n=u4(e+"");if(arguments.length<2){for(var c=Zv(this.node()),g=-1,b=n.length;++g<b;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?eD:t?KP:JP)(n,t))}function iD(){this.textContent=""}function nD(e){return function(){this.textContent=e}}function rD(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function sD(e){return arguments.length?this.each(e==null?iD:(typeof e=="function"?rD:nD)(e)):this.node().textContent}function aD(){this.innerHTML=""}function oD(e){return function(){this.innerHTML=e}}function lD(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function uD(e){return arguments.length?this.each(e==null?aD:(typeof e=="function"?lD:oD)(e)):this.node().innerHTML}function cD(){this.nextSibling&&this.parentNode.appendChild(this)}function hD(){return this.each(cD)}function AD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fD(){return this.each(AD)}function dD(e){var t=typeof e=="function"?e:Hv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function pD(){return null}function mD(e,t){var n=typeof e=="function"?e:Hv(e),c=t==null?pD:typeof t=="function"?t:jv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function gD(){var e=this.parentNode;e&&e.removeChild(this)}function _D(){return this.each(gD)}function yD(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function vD(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xD(e){return this.select(e?vD:yD)}function bD(e){return arguments.length?this.property("__data__",e):this.node().__data__}function wD(e){return function(t){e.call(this,t,this.__data__)}}function SD(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function ID(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,b;n<g;++n)b=t[n],(!e.type||b.type===e.type)&&b.name===e.name?this.removeEventListener(b.type,b.listener,b.options):t[++c]=b;++c?t.length=c:delete this.__on}}}function ED(e,t,n){return function(){var c=this.__on,g,b=wD(t);if(c){for(var I=0,a=c.length;I<a;++I)if((g=c[I]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=b,g.options=n),g.value=t;return}}this.addEventListener(e.type,b,n),g={type:e.type,name:e.name,value:t,listener:b,options:n},c?c.push(g):this.__on=[g]}}function CD(e,t,n){var c=SD(e+""),g,b=c.length,I;if(arguments.length<2){var a=this.node().__on;if(a){for(var G=0,W=a.length,he;G<W;++G)for(g=0,he=a[G];g<b;++g)if((I=c[g]).type===he.type&&I.name===he.name)return he.value}return}for(a=t?ED:ID,g=0;g<b;++g)this.each(a(c[g],t,n));return this}function f4(e,t,n){var c=l4(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function TD(e,t){return function(){return f4(this,e,t)}}function kD(e,t){return function(){return f4(this,e,t.apply(this,arguments))}}function MD(e,t){return this.each((typeof t=="function"?kD:TD)(e,t))}function*PD(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length,I;g<b;++g)(I=c[g])&&(yield I)}var d4=[null];function qc(e,t){this._groups=e,this._parents=t}function Mg(){return new qc([[document.documentElement]],d4)}function DD(){return this}qc.prototype=Mg.prototype={constructor:qc,select:aP,selectAll:uP,selectChild:fP,selectChildren:gP,filter:_P,data:SP,enter:yP,exit:IP,join:EP,merge:CP,selection:DD,order:TP,sort:kP,call:PP,nodes:DP,node:LP,size:BP,empty:zP,each:RP,attr:qP,style:QP,property:$P,classed:tD,text:sD,html:uD,raise:hD,lower:fD,append:dD,insert:mD,remove:_D,clone:xD,datum:bD,on:CD,dispatch:MD,[Symbol.iterator]:PD};function dl(e){return typeof e=="string"?new qc([[document.querySelector(e)]],[document.documentElement]):new qc([[e]],d4)}function LD(e){return dl(Hv(e).call(document.documentElement))}function BD(e){let t;for(;t=e.sourceEvent;)e=t;return e}function $f(e,t){if(e=BD(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var c=n.createSVGPoint();return c.x=e.clientX,c.y=e.clientY,c=c.matrixTransform(t.getScreenCTM().inverse()),[c.x,c.y]}if(t.getBoundingClientRect){var g=t.getBoundingClientRect();return[e.clientX-g.left-t.clientLeft,e.clientY-g.top-t.clientTop]}}return[e.pageX,e.pageY]}function ev(e){e.preventDefault(),e.stopImmediatePropagation()}function p4(e){var t=e.document.documentElement,n=dl(e).on("dragstart.drag",ev,!0);"onselectstart"in t?n.on("selectstart.drag",ev,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function m4(e,t){var n=e.document.documentElement,c=dl(e).on("dragstart.drag",null);t&&(c.on("click.drag",ev,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in n?c.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Qv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function g4(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function Pg(){}var mg=.7,k_=1/mg,hm="\\s*([+-]?\\d+)\\s*",gg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",KA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zD=/^#([0-9a-f]{3,8})$/,RD=new RegExp("^rgb\\("+[hm,hm,hm]+"\\)$"),FD=new RegExp("^rgb\\("+[KA,KA,KA]+"\\)$"),OD=new RegExp("^rgba\\("+[hm,hm,hm,gg]+"\\)$"),ND=new RegExp("^rgba\\("+[KA,KA,KA,gg]+"\\)$"),VD=new RegExp("^hsl\\("+[gg,KA,KA]+"\\)$"),UD=new RegExp("^hsla\\("+[gg,KA,KA,gg]+"\\)$"),ib={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Qv(Pg,np,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:nb,formatHex:nb,formatHsl:GD,formatRgb:rb,toString:rb});function nb(){return this.rgb().formatHex()}function GD(){return _4(this).formatHsl()}function rb(){return this.rgb().formatRgb()}function np(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=zD.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?sb(t):n===3?new fh(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=RD.exec(e))?new fh(t[1],t[2],t[3],1):(t=FD.exec(e))?new fh(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=OD.exec(e))?Qg(t[1],t[2],t[3],t[4]):(t=ND.exec(e))?Qg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=VD.exec(e))?lb(t[1],t[2]/100,t[3]/100,1):(t=UD.exec(e))?lb(t[1],t[2]/100,t[3]/100,t[4]):ib.hasOwnProperty(e)?sb(ib[e]):e==="transparent"?new fh(NaN,NaN,NaN,0):null}function sb(e){return new fh(e>>16&255,e>>8&255,e&255,1)}function Qg(e,t,n,c){return c<=0&&(e=t=n=NaN),new fh(e,t,n,c)}function qD(e){return e instanceof Pg||(e=np(e)),e?(e=e.rgb(),new fh(e.r,e.g,e.b,e.opacity)):new fh}function tv(e,t,n,c){return arguments.length===1?qD(e):new fh(e,t,n,c??1)}function fh(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}Qv(fh,tv,g4(Pg,{brighter:function(e){return e=e==null?k_:Math.pow(k_,e),new fh(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?mg:Math.pow(mg,e),new fh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ab,formatHex:ab,formatRgb:ob,toString:ob}));function ab(){return"#"+G1(this.r)+G1(this.g)+G1(this.b)}function ob(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function G1(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function lb(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new XA(e,t,n,c)}function _4(e){if(e instanceof XA)return new XA(e.h,e.s,e.l,e.opacity);if(e instanceof Pg||(e=np(e)),!e)return new XA;if(e instanceof XA)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),b=Math.max(t,n,c),I=NaN,a=b-g,G=(b+g)/2;return a?(t===b?I=(n-c)/a+(n<c)*6:n===b?I=(c-t)/a+2:I=(t-n)/a+4,a/=G<.5?b+g:2-b-g,I*=60):a=G>0&&G<1?0:I,new XA(I,a,G,e.opacity)}function HD(e,t,n,c){return arguments.length===1?_4(e):new XA(e,t,n,c??1)}function XA(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}Qv(XA,HD,g4(Pg,{brighter:function(e){return e=e==null?k_:Math.pow(k_,e),new XA(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?mg:Math.pow(mg,e),new XA(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new fh(q1(e>=240?e-240:e+120,g,c),q1(e,g,c),q1(e<120?e+240:e-120,g,c),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function q1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Wv=e=>()=>e;function jD(e,t){return function(n){return e+n*t}}function ZD(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function QD(e){return(e=+e)==1?y4:function(t,n){return n-t?ZD(t,n,e):Wv(isNaN(t)?n:t)}}function y4(e,t){var n=t-e;return n?jD(e,n):Wv(isNaN(e)?t:e)}const M_=function e(t){var n=QD(t);function c(g,b){var I=n((g=tv(g)).r,(b=tv(b)).r),a=n(g.g,b.g),G=n(g.b,b.b),W=y4(g.opacity,b.opacity);return function(he){return g.r=I(he),g.g=a(he),g.b=G(he),g.opacity=W(he),g+""}}return c.gamma=e,c}(1);function WD(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(b){for(g=0;g<n;++g)c[g]=e[g]*(1-b)+t[g]*b;return c}}function XD(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function YD(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),b=new Array(n),I;for(I=0;I<c;++I)g[I]=i1(e[I],t[I]);for(;I<n;++I)b[I]=t[I];return function(a){for(I=0;I<c;++I)b[I]=g[I](a);return b}}function $D(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function uA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function KD(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=i1(e[g],t[g]):c[g]=t[g];return function(b){for(g in n)c[g]=n[g](b);return c}}var iv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,H1=new RegExp(iv.source,"g");function JD(e){return function(){return e}}function eL(e){return function(t){return e(t)+""}}function v4(e,t){var n=iv.lastIndex=H1.lastIndex=0,c,g,b,I=-1,a=[],G=[];for(e=e+"",t=t+"";(c=iv.exec(e))&&(g=H1.exec(t));)(b=g.index)>n&&(b=t.slice(n,b),a[I]?a[I]+=b:a[++I]=b),(c=c[0])===(g=g[0])?a[I]?a[I]+=g:a[++I]=g:(a[++I]=null,G.push({i:I,x:uA(c,g)})),n=H1.lastIndex;return n<t.length&&(b=t.slice(n),a[I]?a[I]+=b:a[++I]=b),a.length<2?G[0]?eL(G[0].x):JD(t):(t=G.length,function(W){for(var he=0,ae;he<t;++he)a[(ae=G[he]).i]=ae.x(W);return a.join("")})}function i1(e,t){var n=typeof t,c;return t==null||n==="boolean"?Wv(t):(n==="number"?uA:n==="string"?(c=np(t))?(t=c,M_):v4:t instanceof np?M_:t instanceof Date?$D:XD(t)?WD:Array.isArray(t)?YD:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?KD:uA)(e,t)}function tL(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var ub=180/Math.PI,nv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function x4(e,t,n,c,g,b){var I,a,G;return(I=Math.sqrt(e*e+t*t))&&(e/=I,t/=I),(G=e*n+t*c)&&(n-=e*G,c-=t*G),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,G/=a),e*c<t*n&&(e=-e,t=-t,G=-G,I=-I),{translateX:g,translateY:b,rotate:Math.atan2(t,e)*ub,skewX:Math.atan(G)*ub,scaleX:I,scaleY:a}}var Wg;function iL(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?nv:x4(t.a,t.b,t.c,t.d,t.e,t.f)}function nL(e){return e==null||(Wg||(Wg=document.createElementNS("http://www.w3.org/2000/svg","g")),Wg.setAttribute("transform",e),!(e=Wg.transform.baseVal.consolidate()))?nv:(e=e.matrix,x4(e.a,e.b,e.c,e.d,e.e,e.f))}function b4(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function b(W,he,ae,ue,be,Ke){if(W!==ae||he!==ue){var ot=be.push("translate(",null,t,null,n);Ke.push({i:ot-4,x:uA(W,ae)},{i:ot-2,x:uA(he,ue)})}else(ae||ue)&&be.push("translate("+ae+t+ue+n)}function I(W,he,ae,ue){W!==he?(W-he>180?he+=360:he-W>180&&(W+=360),ue.push({i:ae.push(g(ae)+"rotate(",null,c)-2,x:uA(W,he)})):he&&ae.push(g(ae)+"rotate("+he+c)}function a(W,he,ae,ue){W!==he?ue.push({i:ae.push(g(ae)+"skewX(",null,c)-2,x:uA(W,he)}):he&&ae.push(g(ae)+"skewX("+he+c)}function G(W,he,ae,ue,be,Ke){if(W!==ae||he!==ue){var ot=be.push(g(be)+"scale(",null,",",null,")");Ke.push({i:ot-4,x:uA(W,ae)},{i:ot-2,x:uA(he,ue)})}else(ae!==1||ue!==1)&&be.push(g(be)+"scale("+ae+","+ue+")")}return function(W,he){var ae=[],ue=[];return W=e(W),he=e(he),b(W.translateX,W.translateY,he.translateX,he.translateY,ae,ue),I(W.rotate,he.rotate,ae,ue),a(W.skewX,he.skewX,ae,ue),G(W.scaleX,W.scaleY,he.scaleX,he.scaleY,ae,ue),W=he=null,function(be){for(var Ke=-1,ot=ue.length,tt;++Ke<ot;)ae[(tt=ue[Ke]).i]=tt.x(be);return ae.join("")}}}var rL=b4(iL,"px, ","px)","deg)"),sL=b4(nL,", ",")",")"),aL=1e-12;function cb(e){return((e=Math.exp(e))+1/e)/2}function oL(e){return((e=Math.exp(e))-1/e)/2}function lL(e){return((e=Math.exp(2*e))-1)/(e+1)}const uL=function e(t,n,c){function g(b,I){var a=b[0],G=b[1],W=b[2],he=I[0],ae=I[1],ue=I[2],be=he-a,Ke=ae-G,ot=be*be+Ke*Ke,tt,lt;if(ot<aL)lt=Math.log(ue/W)/t,tt=function(Xt){return[a+Xt*be,G+Xt*Ke,W*Math.exp(t*Xt*lt)]};else{var ut=Math.sqrt(ot),Tt=(ue*ue-W*W+c*ot)/(2*W*n*ut),Pt=(ue*ue-W*W-c*ot)/(2*ue*n*ut),zt=Math.log(Math.sqrt(Tt*Tt+1)-Tt),Ge=Math.log(Math.sqrt(Pt*Pt+1)-Pt);lt=(Ge-zt)/t,tt=function(Xt){var rt=Xt*lt,yt=cb(zt),pt=W/(n*ut)*(yt*lL(t*rt+zt)-oL(zt));return[a+pt*be,G+pt*Ke,W*yt/cb(t*rt+zt)]}}return tt.duration=lt*1e3*t/Math.SQRT2,tt}return g.rho=function(b){var I=Math.max(.001,+b),a=I*I,G=a*a;return e(I,a,G)},g}(Math.SQRT2,2,4);var _m=0,og=0,Qm=0,w4=1e3,P_,lg,D_=0,rp=0,n1=0,_g=typeof performance=="object"&&performance.now?performance:Date,S4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Xv(){return rp||(S4(cL),rp=_g.now()+n1)}function cL(){rp=0}function L_(){this._call=this._time=this._next=null}L_.prototype=I4.prototype={constructor:L_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Xv():+n)+(t==null?0:+t),!this._next&&lg!==this&&(lg?lg._next=this:P_=this,lg=this),this._call=e,this._time=n,rv()},stop:function(){this._call&&(this._call=null,this._time=1/0,rv())}};function I4(e,t,n){var c=new L_;return c.restart(e,t,n),c}function hL(){Xv(),++_m;for(var e=P_,t;e;)(t=rp-e._time)>=0&&e._call.call(null,t),e=e._next;--_m}function hb(){rp=(D_=_g.now())+n1,_m=og=0;try{hL()}finally{_m=0,fL(),rp=0}}function AL(){var e=_g.now(),t=e-D_;t>w4&&(n1-=t,D_=e)}function fL(){for(var e,t=P_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:P_=n);lg=e,rv(c)}function rv(e){if(!_m){og&&(og=clearTimeout(og));var t=e-rp;t>24?(e<1/0&&(og=setTimeout(hb,e-_g.now()-n1)),Qm&&(Qm=clearInterval(Qm))):(Qm||(D_=_g.now(),Qm=setInterval(AL,w4)),_m=1,S4(hb))}}function Ab(e,t,n){var c=new L_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var dL=e1("start","end","cancel","interrupt"),pL=[],E4=0,fb=1,sv=2,o_=3,db=4,av=5,l_=6;function r1(e,t,n,c,g,b){var I=e.__transition;if(!I)e.__transition={};else if(n in I)return;mL(e,n,{name:t,index:c,group:g,on:dL,tween:pL,time:b.time,delay:b.delay,duration:b.duration,ease:b.ease,timer:null,state:E4})}function Yv(e,t){var n=AA(e,t);if(n.state>E4)throw new Error("too late; already scheduled");return n}function sf(e,t){var n=AA(e,t);if(n.state>o_)throw new Error("too late; already running");return n}function AA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function mL(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=I4(b,0,n.time);function b(W){n.state=fb,n.timer.restart(I,n.delay,n.time),n.delay<=W&&I(W-n.delay)}function I(W){var he,ae,ue,be;if(n.state!==fb)return G();for(he in c)if(be=c[he],be.name===n.name){if(be.state===o_)return Ab(I);be.state===db?(be.state=l_,be.timer.stop(),be.on.call("interrupt",e,e.__data__,be.index,be.group),delete c[he]):+he<t&&(be.state=l_,be.timer.stop(),be.on.call("cancel",e,e.__data__,be.index,be.group),delete c[he])}if(Ab(function(){n.state===o_&&(n.state=db,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=sv,n.on.call("start",e,e.__data__,n.index,n.group),n.state===sv){for(n.state=o_,g=new Array(ue=n.tween.length),he=0,ae=-1;he<ue;++he)(be=n.tween[he].value.call(e,e.__data__,n.index,n.group))&&(g[++ae]=be);g.length=ae+1}}function a(W){for(var he=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(G),n.state=av,1),ae=-1,ue=g.length;++ae<ue;)g[ae].call(e,he);n.state===av&&(n.on.call("end",e,e.__data__,n.index,n.group),G())}function G(){n.state=l_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function Am(e,t){var n=e.__transition,c,g,b=!0,I;if(n){t=t==null?null:t+"";for(I in n){if((c=n[I]).name!==t){b=!1;continue}g=c.state>sv&&c.state<av,c.state=l_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[I]}b&&delete e.__transition}}function gL(e){return this.each(function(){Am(this,e)})}function _L(e,t){var n,c;return function(){var g=sf(this,e),b=g.tween;if(b!==n){c=n=b;for(var I=0,a=c.length;I<a;++I)if(c[I].name===t){c=c.slice(),c.splice(I,1);break}}g.tween=c}}function yL(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var b=sf(this,e),I=b.tween;if(I!==c){g=(c=I).slice();for(var a={name:t,value:n},G=0,W=g.length;G<W;++G)if(g[G].name===t){g[G]=a;break}G===W&&g.push(a)}b.tween=g}}function vL(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=AA(this.node(),n).tween,g=0,b=c.length,I;g<b;++g)if((I=c[g]).name===e)return I.value;return null}return this.each((t==null?_L:yL)(n,e,t))}function $v(e,t,n){var c=e._id;return e.each(function(){var g=sf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return AA(g,c).value[t]}}function C4(e,t){var n;return(typeof t=="number"?uA:t instanceof np?M_:(n=np(t))?(t=n,M_):v4)(e,t)}function xL(e){return function(){this.removeAttribute(e)}}function bL(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wL(e,t,n){var c,g=n+"",b;return function(){var I=this.getAttribute(e);return I===g?null:I===c?b:b=t(c=I,n)}}function SL(e,t,n){var c,g=n+"",b;return function(){var I=this.getAttributeNS(e.space,e.local);return I===g?null:I===c?b:b=t(c=I,n)}}function IL(e,t,n){var c,g,b;return function(){var I,a=n(this),G;return a==null?void this.removeAttribute(e):(I=this.getAttribute(e),G=a+"",I===G?null:I===c&&G===g?b:(g=G,b=t(c=I,a)))}}function EL(e,t,n){var c,g,b;return function(){var I,a=n(this),G;return a==null?void this.removeAttributeNS(e.space,e.local):(I=this.getAttributeNS(e.space,e.local),G=a+"",I===G?null:I===c&&G===g?b:(g=G,b=t(c=I,a)))}}function CL(e,t){var n=t1(e),c=n==="transform"?sL:C4;return this.attrTween(e,typeof t=="function"?(n.local?EL:IL)(n,c,$v(this,"attr."+e,t)):t==null?(n.local?bL:xL)(n):(n.local?SL:wL)(n,c,t))}function TL(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function kL(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ML(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&kL(e,b)),n}return g._value=t,g}function PL(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&TL(e,b)),n}return g._value=t,g}function DL(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=t1(e);return this.tween(n,(c.local?ML:PL)(c,t))}function LL(e,t){return function(){Yv(this,e).delay=+t.apply(this,arguments)}}function BL(e,t){return t=+t,function(){Yv(this,e).delay=t}}function zL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?LL:BL)(t,e)):AA(this.node(),t).delay}function RL(e,t){return function(){sf(this,e).duration=+t.apply(this,arguments)}}function FL(e,t){return t=+t,function(){sf(this,e).duration=t}}function OL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?RL:FL)(t,e)):AA(this.node(),t).duration}function NL(e,t){if(typeof t!="function")throw new Error;return function(){sf(this,e).ease=t}}function VL(e){var t=this._id;return arguments.length?this.each(NL(t,e)):AA(this.node(),t).ease}function UL(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;sf(this,e).ease=n}}function GL(e){if(typeof e!="function")throw new Error;return this.each(UL(this._id,e))}function qL(e){typeof e!="function"&&(e=s4(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],I=b.length,a=c[g]=[],G,W=0;W<I;++W)(G=b[W])&&e.call(G,G.__data__,W,b)&&a.push(G);return new n0(c,this._parents,this._name,this._id)}function HL(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,b=Math.min(c,g),I=new Array(c),a=0;a<b;++a)for(var G=t[a],W=n[a],he=G.length,ae=I[a]=new Array(he),ue,be=0;be<he;++be)(ue=G[be]||W[be])&&(ae[be]=ue);for(;a<c;++a)I[a]=t[a];return new n0(I,this._parents,this._name,this._id)}function jL(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function ZL(e,t,n){var c,g,b=jL(t)?Yv:sf;return function(){var I=b(this,e),a=I.on;a!==c&&(g=(c=a).copy()).on(t,n),I.on=g}}function QL(e,t){var n=this._id;return arguments.length<2?AA(this.node(),n).on.on(e):this.each(ZL(n,e,t))}function WL(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function XL(){return this.on("end.remove",WL(this._id))}function YL(e){var t=this._name,n=this._id;typeof e!="function"&&(e=jv(e));for(var c=this._groups,g=c.length,b=new Array(g),I=0;I<g;++I)for(var a=c[I],G=a.length,W=b[I]=new Array(G),he,ae,ue=0;ue<G;++ue)(he=a[ue])&&(ae=e.call(he,he.__data__,ue,a))&&("__data__"in he&&(ae.__data__=he.__data__),W[ue]=ae,r1(W[ue],t,n,ue,W,AA(he,n)));return new n0(b,this._parents,t,n)}function $L(e){var t=this._name,n=this._id;typeof e!="function"&&(e=r4(e));for(var c=this._groups,g=c.length,b=[],I=[],a=0;a<g;++a)for(var G=c[a],W=G.length,he,ae=0;ae<W;++ae)if(he=G[ae]){for(var ue=e.call(he,he.__data__,ae,G),be,Ke=AA(he,n),ot=0,tt=ue.length;ot<tt;++ot)(be=ue[ot])&&r1(be,t,n,ot,ue,Ke);b.push(ue),I.push(he)}return new n0(b,I,t,n)}var KL=Mg.prototype.constructor;function JL(){return new KL(this._groups,this._parents)}function eB(e,t){var n,c,g;return function(){var b=gm(this,e),I=(this.style.removeProperty(e),gm(this,e));return b===I?null:b===n&&I===c?g:g=t(n=b,c=I)}}function T4(e){return function(){this.style.removeProperty(e)}}function tB(e,t,n){var c,g=n+"",b;return function(){var I=gm(this,e);return I===g?null:I===c?b:b=t(c=I,n)}}function iB(e,t,n){var c,g,b;return function(){var I=gm(this,e),a=n(this),G=a+"";return a==null&&(G=a=(this.style.removeProperty(e),gm(this,e))),I===G?null:I===c&&G===g?b:(g=G,b=t(c=I,a))}}function nB(e,t){var n,c,g,b="style."+t,I="end."+b,a;return function(){var G=sf(this,e),W=G.on,he=G.value[b]==null?a||(a=T4(t)):void 0;(W!==n||g!==he)&&(c=(n=W).copy()).on(I,g=he),G.on=c}}function rB(e,t,n){var c=(e+="")=="transform"?rL:C4;return t==null?this.styleTween(e,eB(e,c)).on("end.style."+e,T4(e)):typeof t=="function"?this.styleTween(e,iB(e,c,$v(this,"style."+e,t))).each(nB(this._id,e)):this.styleTween(e,tB(e,c,t),n).on("end.style."+e,null)}function sB(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function aB(e,t,n){var c,g;function b(){var I=t.apply(this,arguments);return I!==g&&(c=(g=I)&&sB(e,I,n)),c}return b._value=t,b}function oB(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,aB(e,t,n??""))}function lB(e){return function(){this.textContent=e}}function uB(e){return function(){var t=e(this);this.textContent=t??""}}function cB(e){return this.tween("text",typeof e=="function"?uB($v(this,"text",e)):lB(e==null?"":e+""))}function hB(e){return function(t){this.textContent=e.call(this,t)}}function AB(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&hB(g)),t}return c._value=e,c}function fB(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,AB(e))}function dB(){for(var e=this._name,t=this._id,n=k4(),c=this._groups,g=c.length,b=0;b<g;++b)for(var I=c[b],a=I.length,G,W=0;W<a;++W)if(G=I[W]){var he=AA(G,t);r1(G,e,n,W,I,{time:he.time+he.delay+he.duration,delay:0,duration:he.duration,ease:he.ease})}return new n0(c,this._parents,e,n)}function pB(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(b,I){var a={value:I},G={value:function(){--g===0&&b()}};n.each(function(){var W=sf(this,c),he=W.on;he!==e&&(t=(e=he).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(G)),W.on=t}),g===0&&b()})}var mB=0;function n0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function k4(){return++mB}var Gd=Mg.prototype;n0.prototype={constructor:n0,select:YL,selectAll:$L,filter:qL,merge:HL,selection:JL,transition:dB,call:Gd.call,nodes:Gd.nodes,node:Gd.node,size:Gd.size,empty:Gd.empty,each:Gd.each,on:QL,attr:CL,attrTween:DL,style:rB,styleTween:oB,text:cB,textTween:fB,remove:XL,tween:vL,delay:zL,duration:OL,ease:VL,easeVarying:GL,end:pB,[Symbol.iterator]:Gd[Symbol.iterator]};function gB(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var _B={time:null,delay:0,duration:250,ease:gB};function yB(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function vB(e){var t,n;e instanceof n0?(t=e._id,e=e._name):(t=k4(),(n=_B).time=Xv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,b=0;b<g;++b)for(var I=c[b],a=I.length,G,W=0;W<a;++W)(G=I[W])&&r1(G,e,t,W,I,n||yB(G,t));return new n0(c,this._parents,e,t)}Mg.prototype.interrupt=gL;Mg.prototype.transition=vB;const j1=e=>()=>e;function xB(e,{sourceEvent:t,target:n,selection:c,mode:g,dispatch:b}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:c,enumerable:!0,configurable:!0},mode:{value:g,enumerable:!0,configurable:!0},_:{value:b}})}function bB(e){e.stopImmediatePropagation()}function Z1(e){e.preventDefault(),e.stopImmediatePropagation()}var pb={name:"drag"},Q1={name:"space"},Wp={name:"handle"},Xp={name:"center"};const{abs:mb,max:$u,min:Ku}=Math;function gb(e){return[+e[0],+e[1]]}function ov(e){return[gb(e[0]),gb(e[1])]}var W1={name:"x",handles:["w","e"].map(yg),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},X1={name:"y",handles:["n","s"].map(yg),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},wB={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(yg),input:function(e){return e==null?null:ov(e)},output:function(e){return e}},Wf={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},_b={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},yb={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},SB={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},IB={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function yg(e){return{type:e}}function EB(e){return!e.ctrlKey&&!e.button}function CB(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function TB(){return navigator.maxTouchPoints||"ontouchstart"in this}function Y1(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function kB(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function MB(){return PB(wB)}function PB(e){var t=CB,n=EB,c=TB,g=!0,b=e1("start","brush","end"),I=6,a;function G(tt){var lt=tt.property("__brush",ot).selectAll(".overlay").data([yg("overlay")]);lt.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Wf.overlay).merge(lt).each(function(){var Tt=Y1(this).extent;dl(this).attr("x",Tt[0][0]).attr("y",Tt[0][1]).attr("width",Tt[1][0]-Tt[0][0]).attr("height",Tt[1][1]-Tt[0][1])}),tt.selectAll(".selection").data([yg("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Wf.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var ut=tt.selectAll(".handle").data(e.handles,function(Tt){return Tt.type});ut.exit().remove(),ut.enter().append("rect").attr("class",function(Tt){return"handle handle--"+Tt.type}).attr("cursor",function(Tt){return Wf[Tt.type]}),tt.each(W).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",ue).filter(c).on("touchstart.brush",ue).on("touchmove.brush",be).on("touchend.brush touchcancel.brush",Ke).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}G.move=function(tt,lt){tt.tween?tt.on("start.brush",function(ut){he(this,arguments).beforestart().start(ut)}).on("interrupt.brush end.brush",function(ut){he(this,arguments).end(ut)}).tween("brush",function(){var ut=this,Tt=ut.__brush,Pt=he(ut,arguments),zt=Tt.selection,Ge=e.input(typeof lt=="function"?lt.apply(this,arguments):lt,Tt.extent),Xt=i1(zt,Ge);function rt(yt){Tt.selection=yt===1&&Ge===null?null:Xt(yt),W.call(ut),Pt.brush()}return zt!==null&&Ge!==null?rt:rt(1)}):tt.each(function(){var ut=this,Tt=arguments,Pt=ut.__brush,zt=e.input(typeof lt=="function"?lt.apply(ut,Tt):lt,Pt.extent),Ge=he(ut,Tt).beforestart();Am(ut),Pt.selection=zt===null?null:zt,W.call(ut),Ge.start().brush().end()})},G.clear=function(tt){G.move(tt,null)};function W(){var tt=dl(this),lt=Y1(this).selection;lt?(tt.selectAll(".selection").style("display",null).attr("x",lt[0][0]).attr("y",lt[0][1]).attr("width",lt[1][0]-lt[0][0]).attr("height",lt[1][1]-lt[0][1]),tt.selectAll(".handle").style("display",null).attr("x",function(ut){return ut.type[ut.type.length-1]==="e"?lt[1][0]-I/2:lt[0][0]-I/2}).attr("y",function(ut){return ut.type[0]==="s"?lt[1][1]-I/2:lt[0][1]-I/2}).attr("width",function(ut){return ut.type==="n"||ut.type==="s"?lt[1][0]-lt[0][0]+I:I}).attr("height",function(ut){return ut.type==="e"||ut.type==="w"?lt[1][1]-lt[0][1]+I:I})):tt.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function he(tt,lt,ut){var Tt=tt.__brush.emitter;return Tt&&(!ut||!Tt.clean)?Tt:new ae(tt,lt,ut)}function ae(tt,lt,ut){this.that=tt,this.args=lt,this.state=tt.__brush,this.active=0,this.clean=ut}ae.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(tt,lt){return this.starting?(this.starting=!1,this.emit("start",tt,lt)):this.emit("brush",tt),this},brush:function(tt,lt){return this.emit("brush",tt,lt),this},end:function(tt,lt){return--this.active===0&&(delete this.state.emitter,this.emit("end",tt,lt)),this},emit:function(tt,lt,ut){var Tt=dl(this.that).datum();b.call(tt,this.that,new xB(tt,{sourceEvent:lt,target:G,selection:e.output(this.state.selection),mode:ut,dispatch:b}),Tt)}};function ue(tt){if(a&&!tt.touches||!n.apply(this,arguments))return;var lt=this,ut=tt.target.__data__.type,Tt=(g&&tt.metaKey?ut="overlay":ut)==="selection"?pb:g&&tt.altKey?Xp:Wp,Pt=e===X1?null:SB[ut],zt=e===W1?null:IB[ut],Ge=Y1(lt),Xt=Ge.extent,rt=Ge.selection,yt=Xt[0][0],pt,gt,bt=Xt[0][1],dt,$e,mt=Xt[1][0],st,Nt,Rt=Xt[1][1],Ot,_i,Si=0,Ti=0,Oi,tn=Pt&&zt&&g&&tt.shiftKey,qi,Ni,nn=Array.from(tt.touches||[tt],ii=>{const wn=ii.identifier;return ii=$f(ii,lt),ii.point0=ii.slice(),ii.identifier=wn,ii});if(ut==="overlay"){rt&&(Oi=!0);const ii=[nn[0],nn[1]||nn[0]];Ge.selection=rt=[[pt=e===X1?yt:Ku(ii[0][0],ii[1][0]),dt=e===W1?bt:Ku(ii[0][1],ii[1][1])],[st=e===X1?mt:$u(ii[0][0],ii[1][0]),Ot=e===W1?Rt:$u(ii[0][1],ii[1][1])]],nn.length>1&&Ki()}else pt=rt[0][0],dt=rt[0][1],st=rt[1][0],Ot=rt[1][1];gt=pt,$e=dt,Nt=st,_i=Ot;var yn=dl(lt).attr("pointer-events","none"),Ci=yn.selectAll(".overlay").attr("cursor",Wf[ut]);Am(lt);var gi=he(lt,arguments,!0).beforestart();if(tt.touches)gi.moved=ai,gi.ended=Ji;else{var Ri=dl(tt.view).on("mousemove.brush",ai,!0).on("mouseup.brush",Ji,!0);g&&Ri.on("keydown.brush",fi,!0).on("keyup.brush",pn,!0),p4(tt.view)}W.call(lt),gi.start(tt,Tt.name);function ai(ii){for(const wn of ii.changedTouches||[ii])for(const Rr of nn)Rr.identifier===wn.identifier&&(Rr.cur=$f(wn,lt));if(tn&&!qi&&!Ni&&nn.length===1){const wn=nn[0];mb(wn.cur[0]-wn[0])>mb(wn.cur[1]-wn[1])?Ni=!0:qi=!0}for(const wn of nn)wn.cur&&(wn[0]=wn.cur[0],wn[1]=wn.cur[1]);Oi=!0,Z1(ii),Ki(ii)}function Ki(ii){const wn=nn[0],Rr=wn.point0;var hi;switch(Si=wn[0]-Rr[0],Ti=wn[1]-Rr[1],Tt){case Q1:case pb:{Pt&&(Si=$u(yt-pt,Ku(mt-st,Si)),gt=pt+Si,Nt=st+Si),zt&&(Ti=$u(bt-dt,Ku(Rt-Ot,Ti)),$e=dt+Ti,_i=Ot+Ti);break}case Wp:{nn[1]?(Pt&&(gt=$u(yt,Ku(mt,nn[0][0])),Nt=$u(yt,Ku(mt,nn[1][0])),Pt=1),zt&&($e=$u(bt,Ku(Rt,nn[0][1])),_i=$u(bt,Ku(Rt,nn[1][1])),zt=1)):(Pt<0?(Si=$u(yt-pt,Ku(mt-pt,Si)),gt=pt+Si,Nt=st):Pt>0&&(Si=$u(yt-st,Ku(mt-st,Si)),gt=pt,Nt=st+Si),zt<0?(Ti=$u(bt-dt,Ku(Rt-dt,Ti)),$e=dt+Ti,_i=Ot):zt>0&&(Ti=$u(bt-Ot,Ku(Rt-Ot,Ti)),$e=dt,_i=Ot+Ti));break}case Xp:{Pt&&(gt=$u(yt,Ku(mt,pt-Si*Pt)),Nt=$u(yt,Ku(mt,st+Si*Pt))),zt&&($e=$u(bt,Ku(Rt,dt-Ti*zt)),_i=$u(bt,Ku(Rt,Ot+Ti*zt)));break}}Nt<gt&&(Pt*=-1,hi=pt,pt=st,st=hi,hi=gt,gt=Nt,Nt=hi,ut in _b&&Ci.attr("cursor",Wf[ut=_b[ut]])),_i<$e&&(zt*=-1,hi=dt,dt=Ot,Ot=hi,hi=$e,$e=_i,_i=hi,ut in yb&&Ci.attr("cursor",Wf[ut=yb[ut]])),Ge.selection&&(rt=Ge.selection),qi&&(gt=rt[0][0],Nt=rt[1][0]),Ni&&($e=rt[0][1],_i=rt[1][1]),(rt[0][0]!==gt||rt[0][1]!==$e||rt[1][0]!==Nt||rt[1][1]!==_i)&&(Ge.selection=[[gt,$e],[Nt,_i]],W.call(lt),gi.brush(ii,Tt.name))}function Ji(ii){if(bB(ii),ii.touches){if(ii.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else m4(ii.view,Oi),Ri.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);yn.attr("pointer-events","all"),Ci.attr("cursor",Wf.overlay),Ge.selection&&(rt=Ge.selection),kB(rt)&&(Ge.selection=null,W.call(lt)),gi.end(ii,Tt.name)}function fi(ii){switch(ii.keyCode){case 16:{tn=Pt&&zt;break}case 18:{Tt===Wp&&(Pt&&(st=Nt-Si*Pt,pt=gt+Si*Pt),zt&&(Ot=_i-Ti*zt,dt=$e+Ti*zt),Tt=Xp,Ki());break}case 32:{(Tt===Wp||Tt===Xp)&&(Pt<0?st=Nt-Si:Pt>0&&(pt=gt-Si),zt<0?Ot=_i-Ti:zt>0&&(dt=$e-Ti),Tt=Q1,Ci.attr("cursor",Wf.selection),Ki());break}default:return}Z1(ii)}function pn(ii){switch(ii.keyCode){case 16:{tn&&(qi=Ni=tn=!1,Ki());break}case 18:{Tt===Xp&&(Pt<0?st=Nt:Pt>0&&(pt=gt),zt<0?Ot=_i:zt>0&&(dt=$e),Tt=Wp,Ki());break}case 32:{Tt===Q1&&(ii.altKey?(Pt&&(st=Nt-Si*Pt,pt=gt+Si*Pt),zt&&(Ot=_i-Ti*zt,dt=$e+Ti*zt),Tt=Xp):(Pt<0?st=Nt:Pt>0&&(pt=gt),zt<0?Ot=_i:zt>0&&(dt=$e),Tt=Wp),Ci.attr("cursor",Wf[ut]),Ki());break}default:return}Z1(ii)}}function be(tt){he(this,arguments).moved(tt)}function Ke(tt){he(this,arguments).ended(tt)}function ot(){var tt=this.__brush||{selection:null};return tt.extent=ov(t.apply(this,arguments)),tt.dim=e,tt}return G.extent=function(tt){return arguments.length?(t=typeof tt=="function"?tt:j1(ov(tt)),G):t},G.filter=function(tt){return arguments.length?(n=typeof tt=="function"?tt:j1(!!tt),G):n},G.touchable=function(tt){return arguments.length?(c=typeof tt=="function"?tt:j1(!!tt),G):c},G.handleSize=function(tt){return arguments.length?(I=+tt,G):I},G.keyModifiers=function(tt){return arguments.length?(g=!!tt,G):g},G.on=function(){var tt=b.on.apply(b,arguments);return tt===b?G:tt},G}const lv=Math.PI,uv=2*lv,jd=1e-6,DB=uv-jd;function cv(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function M4(){return new cv}cv.prototype=M4.prototype={constructor:cv,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,c){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+c)},bezierCurveTo:function(e,t,n,c,g,b){this._+="C"+ +e+","+ +t+","+ +n+","+ +c+","+(this._x1=+g)+","+(this._y1=+b)},arcTo:function(e,t,n,c,g){e=+e,t=+t,n=+n,c=+c,g=+g;var b=this._x1,I=this._y1,a=n-e,G=c-t,W=b-e,he=I-t,ae=W*W+he*he;if(g<0)throw new Error("negative radius: "+g);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(ae>jd)if(!(Math.abs(he*a-G*W)>jd)||!g)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var ue=n-b,be=c-I,Ke=a*a+G*G,ot=ue*ue+be*be,tt=Math.sqrt(Ke),lt=Math.sqrt(ae),ut=g*Math.tan((lv-Math.acos((Ke+ae-ot)/(2*tt*lt)))/2),Tt=ut/lt,Pt=ut/tt;Math.abs(Tt-1)>jd&&(this._+="L"+(e+Tt*W)+","+(t+Tt*he)),this._+="A"+g+","+g+",0,0,"+ +(he*ue>W*be)+","+(this._x1=e+Pt*a)+","+(this._y1=t+Pt*G)}},arc:function(e,t,n,c,g,b){e=+e,t=+t,n=+n,b=!!b;var I=n*Math.cos(c),a=n*Math.sin(c),G=e+I,W=t+a,he=1^b,ae=b?c-g:g-c;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+G+","+W:(Math.abs(this._x1-G)>jd||Math.abs(this._y1-W)>jd)&&(this._+="L"+G+","+W),n&&(ae<0&&(ae=ae%uv+uv),ae>DB?this._+="A"+n+","+n+",0,1,"+he+","+(e-I)+","+(t-a)+"A"+n+","+n+",0,1,"+he+","+(this._x1=G)+","+(this._y1=W):ae>jd&&(this._+="A"+n+","+n+",0,"+ +(ae>=lv)+","+he+","+(this._x1=e+n*Math.cos(g))+","+(this._y1=t+n*Math.sin(g))))},rect:function(e,t,n,c){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +c+"h"+-n+"Z"},toString:function(){return this._}};function LB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function B_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function ym(e){return e=B_(Math.abs(e)),e?e[1]:NaN}function BB(e,t){return function(n,c){for(var g=n.length,b=[],I=0,a=e[0],G=0;g>0&&a>0&&(G+a+1>c&&(a=Math.max(1,c-G)),b.push(n.substring(g-=a,g+a)),!((G+=a+1)>c));)a=e[I=(I+1)%e.length];return b.reverse().join(t)}}function zB(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var RB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function z_(e){if(!(t=RB.exec(e)))throw new Error("invalid format: "+e);var t;return new Kv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}z_.prototype=Kv.prototype;function Kv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Kv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function FB(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var P4;function OB(e,t){var n=B_(e,t);if(!n)return e+"";var c=n[0],g=n[1],b=g-(P4=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,I=c.length;return b===I?c:b>I?c+new Array(b-I+1).join("0"):b>0?c.slice(0,b)+"."+c.slice(b):"0."+new Array(1-b).join("0")+B_(e,Math.max(0,t+b-1))[0]}function vb(e,t){var n=B_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const xb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:LB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>vb(e*100,t),r:vb,s:OB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function bb(e){return e}var wb=Array.prototype.map,Sb=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function NB(e){var t=e.grouping===void 0||e.thousands===void 0?bb:BB(wb.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",b=e.numerals===void 0?bb:zB(wb.call(e.numerals,String)),I=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",G=e.nan===void 0?"NaN":e.nan+"";function W(ae){ae=z_(ae);var ue=ae.fill,be=ae.align,Ke=ae.sign,ot=ae.symbol,tt=ae.zero,lt=ae.width,ut=ae.comma,Tt=ae.precision,Pt=ae.trim,zt=ae.type;zt==="n"?(ut=!0,zt="g"):xb[zt]||(Tt===void 0&&(Tt=12),Pt=!0,zt="g"),(tt||ue==="0"&&be==="=")&&(tt=!0,ue="0",be="=");var Ge=ot==="$"?n:ot==="#"&&/[boxX]/.test(zt)?"0"+zt.toLowerCase():"",Xt=ot==="$"?c:/[%p]/.test(zt)?I:"",rt=xb[zt],yt=/[defgprs%]/.test(zt);Tt=Tt===void 0?6:/[gprs]/.test(zt)?Math.max(1,Math.min(21,Tt)):Math.max(0,Math.min(20,Tt));function pt(gt){var bt=Ge,dt=Xt,$e,mt,st;if(zt==="c")dt=rt(gt)+dt,gt="";else{gt=+gt;var Nt=gt<0||1/gt<0;if(gt=isNaN(gt)?G:rt(Math.abs(gt),Tt),Pt&&(gt=FB(gt)),Nt&&+gt==0&&Ke!=="+"&&(Nt=!1),bt=(Nt?Ke==="("?Ke:a:Ke==="-"||Ke==="("?"":Ke)+bt,dt=(zt==="s"?Sb[8+P4/3]:"")+dt+(Nt&&Ke==="("?")":""),yt){for($e=-1,mt=gt.length;++$e<mt;)if(st=gt.charCodeAt($e),48>st||st>57){dt=(st===46?g+gt.slice($e+1):gt.slice($e))+dt,gt=gt.slice(0,$e);break}}}ut&&!tt&&(gt=t(gt,1/0));var Rt=bt.length+gt.length+dt.length,Ot=Rt<lt?new Array(lt-Rt+1).join(ue):"";switch(ut&&tt&&(gt=t(Ot+gt,Ot.length?lt-dt.length:1/0),Ot=""),be){case"<":gt=bt+gt+dt+Ot;break;case"=":gt=bt+Ot+gt+dt;break;case"^":gt=Ot.slice(0,Rt=Ot.length>>1)+bt+gt+dt+Ot.slice(Rt);break;default:gt=Ot+bt+gt+dt;break}return b(gt)}return pt.toString=function(){return ae+""},pt}function he(ae,ue){var be=W((ae=z_(ae),ae.type="f",ae)),Ke=Math.max(-8,Math.min(8,Math.floor(ym(ue)/3)))*3,ot=Math.pow(10,-Ke),tt=Sb[8+Ke/3];return function(lt){return be(ot*lt)+tt}}return{format:W,formatPrefix:he}}var Xg,Jv,D4;VB({thousands:",",grouping:[3],currency:["$",""]});function VB(e){return Xg=NB(e),Jv=Xg.format,D4=Xg.formatPrefix,Xg}function UB(e){return Math.max(0,-ym(Math.abs(e)))}function GB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ym(t)/3)))*3-ym(Math.abs(e)))}function qB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ym(t)-ym(e))+1}function HB(e){var t=0,n=e.children,c=n&&n.length;if(!c)t=1;else for(;--c>=0;)t+=n[c].value;e.value=t}function jB(){return this.eachAfter(HB)}function ZB(e,t){let n=-1;for(const c of this)e.call(t,c,++n,this);return this}function QB(e,t){for(var n=this,c=[n],g,b,I=-1;n=c.pop();)if(e.call(t,n,++I,this),g=n.children)for(b=g.length-1;b>=0;--b)c.push(g[b]);return this}function WB(e,t){for(var n=this,c=[n],g=[],b,I,a,G=-1;n=c.pop();)if(g.push(n),b=n.children)for(I=0,a=b.length;I<a;++I)c.push(b[I]);for(;n=g.pop();)e.call(t,n,++G,this);return this}function XB(e,t){let n=-1;for(const c of this)if(e.call(t,c,++n,this))return c}function YB(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,c=t.children,g=c&&c.length;--g>=0;)n+=c[g].value;t.value=n})}function $B(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function KB(e){for(var t=this,n=JB(t,e),c=[t];t!==n;)t=t.parent,c.push(t);for(var g=c.length;e!==n;)c.splice(g,0,e),e=e.parent;return c}function JB(e,t){if(e===t)return e;var n=e.ancestors(),c=t.ancestors(),g=null;for(e=n.pop(),t=c.pop();e===t;)g=e,e=n.pop(),t=c.pop();return g}function e7(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function t7(){return Array.from(this)}function i7(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function n7(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*r7(){var e=this,t,n=[e],c,g,b;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,c=e.children)for(g=0,b=c.length;g<b;++g)n.push(c[g]);while(n.length)}function Yd(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=o7)):t===void 0&&(t=a7);for(var n=new R_(e),c,g=[n],b,I,a,G;c=g.pop();)if((I=t(c.data))&&(G=(I=Array.from(I)).length))for(c.children=I,a=G-1;a>=0;--a)g.push(b=I[a]=new R_(I[a])),b.parent=c,b.depth=c.depth+1;return n.eachBefore(u7)}function s7(){return Yd(this).eachBefore(l7)}function a7(e){return e.children}function o7(e){return Array.isArray(e)?e[1]:null}function l7(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function u7(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function R_(e){this.data=e,this.depth=this.height=0,this.parent=null}R_.prototype=Yd.prototype={constructor:R_,count:jB,each:ZB,eachAfter:WB,eachBefore:QB,find:XB,sum:YB,sort:$B,path:KB,ancestors:e7,descendants:t7,leaves:i7,links:n7,copy:s7,[Symbol.iterator]:r7};function c7(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function h7(e){return function(){return e}}function A7(e){return+e}var Ib=[0,1];function nm(e){return e}function hv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:h7(isNaN(t)?NaN:.5)}function f7(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function d7(e,t,n){var c=e[0],g=e[1],b=t[0],I=t[1];return g<c?(c=hv(g,c),b=n(I,b)):(c=hv(c,g),b=n(b,I)),function(a){return b(c(a))}}function p7(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),b=new Array(c),I=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++I<c;)g[I]=hv(e[I],e[I+1]),b[I]=n(t[I],t[I+1]);return function(a){var G=GM(e,a,1,c)-1;return b[G](g[G](a))}}function m7(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function g7(){var e=Ib,t=Ib,n=i1,c,g,b,I=nm,a,G,W;function he(){var ue=Math.min(e.length,t.length);return I!==nm&&(I=f7(e[0],e[ue-1])),a=ue>2?p7:d7,G=W=null,ae}function ae(ue){return ue==null||isNaN(ue=+ue)?b:(G||(G=a(e.map(c),t,n)))(c(I(ue)))}return ae.invert=function(ue){return I(g((W||(W=a(t,e.map(c),uA)))(ue)))},ae.domain=function(ue){return arguments.length?(e=Array.from(ue,A7),he()):e.slice()},ae.range=function(ue){return arguments.length?(t=Array.from(ue),he()):t.slice()},ae.rangeRound=function(ue){return t=Array.from(ue),n=tL,he()},ae.clamp=function(ue){return arguments.length?(I=ue?!0:nm,he()):I!==nm},ae.interpolate=function(ue){return arguments.length?(n=ue,he()):n},ae.unknown=function(ue){return arguments.length?(b=ue,ae):b},function(ue,be){return c=ue,g=be,he()}}function _7(){return g7()(nm,nm)}function y7(e,t,n,c){var g=HM(e,t,n),b;switch(c=z_(c??",f"),c.type){case"s":{var I=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(b=GB(g,I))&&(c.precision=b),D4(c,I)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(b=qB(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=b-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(b=UB(g))&&(c.precision=b-(c.type==="%")*2);break}}return Jv(c)}function v7(e){var t=e.domain;return e.ticks=function(n){var c=t();return qM(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return y7(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,b=c.length-1,I=c[g],a=c[b],G,W,he=10;for(a<I&&(W=I,I=a,a=W,W=g,g=b,b=W);he-- >0;){if(W=i4(I,a,n),W===G)return c[g]=I,c[b]=a,t(c);if(W>0)I=Math.floor(I/W)*W,a=Math.ceil(a/W)*W;else if(W<0)I=Math.ceil(I*W)/W,a=Math.floor(a*W)/W;else break;G=W}return e},e}function L4(){var e=_7();return e.copy=function(){return m7(e,L4())},c7.apply(e,arguments),v7(e)}var $1=new Date,K1=new Date;function o0(e,t,n,c){function g(b){return e(b=arguments.length===0?new Date:new Date(+b)),b}return g.floor=function(b){return e(b=new Date(+b)),b},g.ceil=function(b){return e(b=new Date(b-1)),t(b,1),e(b),b},g.round=function(b){var I=g(b),a=g.ceil(b);return b-I<a-b?I:a},g.offset=function(b,I){return t(b=new Date(+b),I==null?1:Math.floor(I)),b},g.range=function(b,I,a){var G=[],W;if(b=g.ceil(b),a=a==null?1:Math.floor(a),!(b<I)||!(a>0))return G;do G.push(W=new Date(+b)),t(b,a),e(b);while(W<b&&b<I);return G},g.filter=function(b){return o0(function(I){if(I>=I)for(;e(I),!b(I);)I.setTime(I-1)},function(I,a){if(I>=I)if(a<0)for(;++a<=0;)for(;t(I,-1),!b(I););else for(;--a>=0;)for(;t(I,1),!b(I););})},n&&(g.count=function(b,I){return $1.setTime(+b),K1.setTime(+I),e($1),e(K1),Math.floor(n($1,K1))},g.every=function(b){return b=Math.floor(b),!isFinite(b)||!(b>0)?null:b>1?g.filter(c?function(I){return c(I)%b===0}:function(I){return g.count(0,I)%b===0}):g}),g}const x7=1e3,e2=x7*60,b7=e2*60,t2=b7*24,B4=t2*7;var i2=o0(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*e2)/t2,e=>e.getDate()-1);i2.range;function hp(e){return o0(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*e2)/B4})}var z4=hp(0),F_=hp(1),w7=hp(2),S7=hp(3),vm=hp(4),I7=hp(5),E7=hp(6);z4.range;F_.range;w7.range;S7.range;vm.range;I7.range;E7.range;var sp=o0(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});sp.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:o0(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};sp.range;var n2=o0(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/t2},function(e){return e.getUTCDate()-1});n2.range;function Ap(e){return o0(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/B4})}var R4=Ap(0),O_=Ap(1),C7=Ap(2),T7=Ap(3),xm=Ap(4),k7=Ap(5),M7=Ap(6);R4.range;O_.range;C7.range;T7.range;xm.range;k7.range;M7.range;var ap=o0(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ap.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:o0(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};ap.range;function J1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ey(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Wm(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function P7(e){var t=e.dateTime,n=e.date,c=e.time,g=e.periods,b=e.days,I=e.shortDays,a=e.months,G=e.shortMonths,W=Xm(g),he=Ym(g),ae=Xm(b),ue=Ym(b),be=Xm(I),Ke=Ym(I),ot=Xm(a),tt=Ym(a),lt=Xm(G),ut=Ym(G),Tt={a:Nt,A:Rt,b:Ot,B:_i,c:null,d:Pb,e:Pb,f:ez,g:cz,G:Az,H:$7,I:K7,j:J7,L:F4,m:tz,M:iz,p:Si,q:Ti,Q:Bb,s:zb,S:nz,u:rz,U:sz,V:az,w:oz,W:lz,x:null,X:null,y:uz,Y:hz,Z:fz,"%":Lb},Pt={a:Oi,A:tn,b:qi,B:Ni,c:null,d:Db,e:Db,f:gz,g:Cz,G:kz,H:dz,I:pz,j:mz,L:N4,m:_z,M:yz,p:nn,q:yn,Q:Bb,s:zb,S:vz,u:xz,U:bz,V:wz,w:Sz,W:Iz,x:null,X:null,y:Ez,Y:Tz,Z:Mz,"%":Lb},zt={a:pt,A:gt,b:bt,B:dt,c:$e,d:kb,e:kb,f:Q7,g:Tb,G:Cb,H:Mb,I:Mb,j:q7,L:Z7,m:G7,M:H7,p:yt,q:U7,Q:X7,s:Y7,S:j7,u:R7,U:F7,V:O7,w:z7,W:N7,x:mt,X:st,y:Tb,Y:Cb,Z:V7,"%":W7};Tt.x=Ge(n,Tt),Tt.X=Ge(c,Tt),Tt.c=Ge(t,Tt),Pt.x=Ge(n,Pt),Pt.X=Ge(c,Pt),Pt.c=Ge(t,Pt);function Ge(Ci,gi){return function(Ri){var ai=[],Ki=-1,Ji=0,fi=Ci.length,pn,ii,wn;for(Ri instanceof Date||(Ri=new Date(+Ri));++Ki<fi;)Ci.charCodeAt(Ki)===37&&(ai.push(Ci.slice(Ji,Ki)),(ii=Eb[pn=Ci.charAt(++Ki)])!=null?pn=Ci.charAt(++Ki):ii=pn==="e"?" ":"0",(wn=gi[pn])&&(pn=wn(Ri,ii)),ai.push(pn),Ji=Ki+1);return ai.push(Ci.slice(Ji,Ki)),ai.join("")}}function Xt(Ci,gi){return function(Ri){var ai=Wm(1900,void 0,1),Ki=rt(ai,Ci,Ri+="",0),Ji,fi;if(Ki!=Ri.length)return null;if("Q"in ai)return new Date(ai.Q);if("s"in ai)return new Date(ai.s*1e3+("L"in ai?ai.L:0));if(gi&&!("Z"in ai)&&(ai.Z=0),"p"in ai&&(ai.H=ai.H%12+ai.p*12),ai.m===void 0&&(ai.m="q"in ai?ai.q:0),"V"in ai){if(ai.V<1||ai.V>53)return null;"w"in ai||(ai.w=1),"Z"in ai?(Ji=ey(Wm(ai.y,0,1)),fi=Ji.getUTCDay(),Ji=fi>4||fi===0?O_.ceil(Ji):O_(Ji),Ji=n2.offset(Ji,(ai.V-1)*7),ai.y=Ji.getUTCFullYear(),ai.m=Ji.getUTCMonth(),ai.d=Ji.getUTCDate()+(ai.w+6)%7):(Ji=J1(Wm(ai.y,0,1)),fi=Ji.getDay(),Ji=fi>4||fi===0?F_.ceil(Ji):F_(Ji),Ji=i2.offset(Ji,(ai.V-1)*7),ai.y=Ji.getFullYear(),ai.m=Ji.getMonth(),ai.d=Ji.getDate()+(ai.w+6)%7)}else("W"in ai||"U"in ai)&&("w"in ai||(ai.w="u"in ai?ai.u%7:"W"in ai?1:0),fi="Z"in ai?ey(Wm(ai.y,0,1)).getUTCDay():J1(Wm(ai.y,0,1)).getDay(),ai.m=0,ai.d="W"in ai?(ai.w+6)%7+ai.W*7-(fi+5)%7:ai.w+ai.U*7-(fi+6)%7);return"Z"in ai?(ai.H+=ai.Z/100|0,ai.M+=ai.Z%100,ey(ai)):J1(ai)}}function rt(Ci,gi,Ri,ai){for(var Ki=0,Ji=gi.length,fi=Ri.length,pn,ii;Ki<Ji;){if(ai>=fi)return-1;if(pn=gi.charCodeAt(Ki++),pn===37){if(pn=gi.charAt(Ki++),ii=zt[pn in Eb?gi.charAt(Ki++):pn],!ii||(ai=ii(Ci,Ri,ai))<0)return-1}else if(pn!=Ri.charCodeAt(ai++))return-1}return ai}function yt(Ci,gi,Ri){var ai=W.exec(gi.slice(Ri));return ai?(Ci.p=he.get(ai[0].toLowerCase()),Ri+ai[0].length):-1}function pt(Ci,gi,Ri){var ai=be.exec(gi.slice(Ri));return ai?(Ci.w=Ke.get(ai[0].toLowerCase()),Ri+ai[0].length):-1}function gt(Ci,gi,Ri){var ai=ae.exec(gi.slice(Ri));return ai?(Ci.w=ue.get(ai[0].toLowerCase()),Ri+ai[0].length):-1}function bt(Ci,gi,Ri){var ai=lt.exec(gi.slice(Ri));return ai?(Ci.m=ut.get(ai[0].toLowerCase()),Ri+ai[0].length):-1}function dt(Ci,gi,Ri){var ai=ot.exec(gi.slice(Ri));return ai?(Ci.m=tt.get(ai[0].toLowerCase()),Ri+ai[0].length):-1}function $e(Ci,gi,Ri){return rt(Ci,t,gi,Ri)}function mt(Ci,gi,Ri){return rt(Ci,n,gi,Ri)}function st(Ci,gi,Ri){return rt(Ci,c,gi,Ri)}function Nt(Ci){return I[Ci.getDay()]}function Rt(Ci){return b[Ci.getDay()]}function Ot(Ci){return G[Ci.getMonth()]}function _i(Ci){return a[Ci.getMonth()]}function Si(Ci){return g[+(Ci.getHours()>=12)]}function Ti(Ci){return 1+~~(Ci.getMonth()/3)}function Oi(Ci){return I[Ci.getUTCDay()]}function tn(Ci){return b[Ci.getUTCDay()]}function qi(Ci){return G[Ci.getUTCMonth()]}function Ni(Ci){return a[Ci.getUTCMonth()]}function nn(Ci){return g[+(Ci.getUTCHours()>=12)]}function yn(Ci){return 1+~~(Ci.getUTCMonth()/3)}return{format:function(Ci){var gi=Ge(Ci+="",Tt);return gi.toString=function(){return Ci},gi},parse:function(Ci){var gi=Xt(Ci+="",!1);return gi.toString=function(){return Ci},gi},utcFormat:function(Ci){var gi=Ge(Ci+="",Pt);return gi.toString=function(){return Ci},gi},utcParse:function(Ci){var gi=Xt(Ci+="",!0);return gi.toString=function(){return Ci},gi}}}var Eb={"-":"",_:" ",0:"0"},Bu=/^\s*\d+/,D7=/^%/,L7=/[\\^$*+?|[\]().{}]/g;function Ra(e,t,n){var c=e<0?"-":"",g=(c?-e:e)+"",b=g.length;return c+(b<n?new Array(n-b+1).join(t)+g:g)}function B7(e){return e.replace(L7,"\\$&")}function Xm(e){return new RegExp("^(?:"+e.map(B7).join("|")+")","i")}function Ym(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function z7(e,t,n){var c=Bu.exec(t.slice(n,n+1));return c?(e.w=+c[0],n+c[0].length):-1}function R7(e,t,n){var c=Bu.exec(t.slice(n,n+1));return c?(e.u=+c[0],n+c[0].length):-1}function F7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.U=+c[0],n+c[0].length):-1}function O7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.V=+c[0],n+c[0].length):-1}function N7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.W=+c[0],n+c[0].length):-1}function Cb(e,t,n){var c=Bu.exec(t.slice(n,n+4));return c?(e.y=+c[0],n+c[0].length):-1}function Tb(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.y=+c[0]+(+c[0]>68?1900:2e3),n+c[0].length):-1}function V7(e,t,n){var c=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return c?(e.Z=c[1]?0:-(c[2]+(c[3]||"00")),n+c[0].length):-1}function U7(e,t,n){var c=Bu.exec(t.slice(n,n+1));return c?(e.q=c[0]*3-3,n+c[0].length):-1}function G7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.m=c[0]-1,n+c[0].length):-1}function kb(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.d=+c[0],n+c[0].length):-1}function q7(e,t,n){var c=Bu.exec(t.slice(n,n+3));return c?(e.m=0,e.d=+c[0],n+c[0].length):-1}function Mb(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.H=+c[0],n+c[0].length):-1}function H7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.M=+c[0],n+c[0].length):-1}function j7(e,t,n){var c=Bu.exec(t.slice(n,n+2));return c?(e.S=+c[0],n+c[0].length):-1}function Z7(e,t,n){var c=Bu.exec(t.slice(n,n+3));return c?(e.L=+c[0],n+c[0].length):-1}function Q7(e,t,n){var c=Bu.exec(t.slice(n,n+6));return c?(e.L=Math.floor(c[0]/1e3),n+c[0].length):-1}function W7(e,t,n){var c=D7.exec(t.slice(n,n+1));return c?n+c[0].length:-1}function X7(e,t,n){var c=Bu.exec(t.slice(n));return c?(e.Q=+c[0],n+c[0].length):-1}function Y7(e,t,n){var c=Bu.exec(t.slice(n));return c?(e.s=+c[0],n+c[0].length):-1}function Pb(e,t){return Ra(e.getDate(),t,2)}function $7(e,t){return Ra(e.getHours(),t,2)}function K7(e,t){return Ra(e.getHours()%12||12,t,2)}function J7(e,t){return Ra(1+i2.count(sp(e),e),t,3)}function F4(e,t){return Ra(e.getMilliseconds(),t,3)}function ez(e,t){return F4(e,t)+"000"}function tz(e,t){return Ra(e.getMonth()+1,t,2)}function iz(e,t){return Ra(e.getMinutes(),t,2)}function nz(e,t){return Ra(e.getSeconds(),t,2)}function rz(e){var t=e.getDay();return t===0?7:t}function sz(e,t){return Ra(z4.count(sp(e)-1,e),t,2)}function O4(e){var t=e.getDay();return t>=4||t===0?vm(e):vm.ceil(e)}function az(e,t){return e=O4(e),Ra(vm.count(sp(e),e)+(sp(e).getDay()===4),t,2)}function oz(e){return e.getDay()}function lz(e,t){return Ra(F_.count(sp(e)-1,e),t,2)}function uz(e,t){return Ra(e.getFullYear()%100,t,2)}function cz(e,t){return e=O4(e),Ra(e.getFullYear()%100,t,2)}function hz(e,t){return Ra(e.getFullYear()%1e4,t,4)}function Az(e,t){var n=e.getDay();return e=n>=4||n===0?vm(e):vm.ceil(e),Ra(e.getFullYear()%1e4,t,4)}function fz(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ra(t/60|0,"0",2)+Ra(t%60,"0",2)}function Db(e,t){return Ra(e.getUTCDate(),t,2)}function dz(e,t){return Ra(e.getUTCHours(),t,2)}function pz(e,t){return Ra(e.getUTCHours()%12||12,t,2)}function mz(e,t){return Ra(1+n2.count(ap(e),e),t,3)}function N4(e,t){return Ra(e.getUTCMilliseconds(),t,3)}function gz(e,t){return N4(e,t)+"000"}function _z(e,t){return Ra(e.getUTCMonth()+1,t,2)}function yz(e,t){return Ra(e.getUTCMinutes(),t,2)}function vz(e,t){return Ra(e.getUTCSeconds(),t,2)}function xz(e){var t=e.getUTCDay();return t===0?7:t}function bz(e,t){return Ra(R4.count(ap(e)-1,e),t,2)}function V4(e){var t=e.getUTCDay();return t>=4||t===0?xm(e):xm.ceil(e)}function wz(e,t){return e=V4(e),Ra(xm.count(ap(e),e)+(ap(e).getUTCDay()===4),t,2)}function Sz(e){return e.getUTCDay()}function Iz(e,t){return Ra(O_.count(ap(e)-1,e),t,2)}function Ez(e,t){return Ra(e.getUTCFullYear()%100,t,2)}function Cz(e,t){return e=V4(e),Ra(e.getUTCFullYear()%100,t,2)}function Tz(e,t){return Ra(e.getUTCFullYear()%1e4,t,4)}function kz(e,t){var n=e.getUTCDay();return e=n>=4||n===0?xm(e):xm.ceil(e),Ra(e.getUTCFullYear()%1e4,t,4)}function Mz(){return"+0000"}function Lb(){return"%"}function Bb(e){return+e}function zb(e){return Math.floor(+e/1e3)}var Yp,U4;Pz({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Pz(e){return Yp=P7(e),Yp.format,U4=Yp.parse,Yp.utcFormat,Yp.utcParse,Yp}function $p(e){return function(){return e}}function Dz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function G4(e){this._context=e}G4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Lz(e){return new G4(e)}function Bz(e){return e[0]}function zz(e){return e[1]}function Av(e,t){var n=$p(!0),c=null,g=Lz,b=null;e=typeof e=="function"?e:e===void 0?Bz:$p(e),t=typeof t=="function"?t:t===void 0?zz:$p(t);function I(a){var G,W=(a=Dz(a)).length,he,ae=!1,ue;for(c==null&&(b=g(ue=M4())),G=0;G<=W;++G)!(G<W&&n(he=a[G],G,a))===ae&&((ae=!ae)?b.lineStart():b.lineEnd()),ae&&b.point(+e(he,G,a),+t(he,G,a));if(ue)return b=null,ue+""||null}return I.x=function(a){return arguments.length?(e=typeof a=="function"?a:$p(+a),I):e},I.y=function(a){return arguments.length?(t=typeof a=="function"?a:$p(+a),I):t},I.defined=function(a){return arguments.length?(n=typeof a=="function"?a:$p(!!a),I):n},I.curve=function(a){return arguments.length?(g=a,c!=null&&(b=g(c)),I):g},I.context=function(a){return arguments.length?(a==null?c=b=null:b=g(c=a),I):c},I}function Rb(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function q4(e){this._context=e}q4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Rb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Rb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Fb(e){return new q4(e)}function H4(e,t){this._context=e,this._t=t}H4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Rz(e){return new H4(e,0)}const Yg=e=>()=>e;function Fz(e,{sourceEvent:t,target:n,transform:c,dispatch:g}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:c,enumerable:!0,configurable:!0},_:{value:g}})}function e0(e,t,n){this.k=e,this.x=t,this.y=n}e0.prototype={constructor:e0,scale:function(e){return e===1?this:new e0(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new e0(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var j4=new e0(1,0,0);e0.prototype;function ty(e){e.stopImmediatePropagation()}function $m(e){e.preventDefault(),e.stopImmediatePropagation()}function Oz(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Nz(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ob(){return this.__zoom||j4}function Vz(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Uz(){return navigator.maxTouchPoints||"ontouchstart"in this}function Gz(e,t,n){var c=e.invertX(t[0][0])-n[0][0],g=e.invertX(t[1][0])-n[1][0],b=e.invertY(t[0][1])-n[0][1],I=e.invertY(t[1][1])-n[1][1];return e.translate(g>c?(c+g)/2:Math.min(0,c)||Math.max(0,g),I>b?(b+I)/2:Math.min(0,b)||Math.max(0,I))}function qz(){var e=Oz,t=Nz,n=Gz,c=Vz,g=Uz,b=[0,1/0],I=[[-1/0,-1/0],[1/0,1/0]],a=250,G=uL,W=e1("start","zoom","end"),he,ae,ue,be=500,Ke=150,ot=0,tt=10;function lt($e){$e.property("__zoom",Ob).on("wheel.zoom",rt).on("mousedown.zoom",yt).on("dblclick.zoom",pt).filter(g).on("touchstart.zoom",gt).on("touchmove.zoom",bt).on("touchend.zoom touchcancel.zoom",dt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}lt.transform=function($e,mt,st,Nt){var Rt=$e.selection?$e.selection():$e;Rt.property("__zoom",Ob),$e!==Rt?zt($e,mt,st,Nt):Rt.interrupt().each(function(){Ge(this,arguments).event(Nt).start().zoom(null,typeof mt=="function"?mt.apply(this,arguments):mt).end()})},lt.scaleBy=function($e,mt,st,Nt){lt.scaleTo($e,function(){var Rt=this.__zoom.k,Ot=typeof mt=="function"?mt.apply(this,arguments):mt;return Rt*Ot},st,Nt)},lt.scaleTo=function($e,mt,st,Nt){lt.transform($e,function(){var Rt=t.apply(this,arguments),Ot=this.__zoom,_i=st==null?Pt(Rt):typeof st=="function"?st.apply(this,arguments):st,Si=Ot.invert(_i),Ti=typeof mt=="function"?mt.apply(this,arguments):mt;return n(Tt(ut(Ot,Ti),_i,Si),Rt,I)},st,Nt)},lt.translateBy=function($e,mt,st,Nt){lt.transform($e,function(){return n(this.__zoom.translate(typeof mt=="function"?mt.apply(this,arguments):mt,typeof st=="function"?st.apply(this,arguments):st),t.apply(this,arguments),I)},null,Nt)},lt.translateTo=function($e,mt,st,Nt,Rt){lt.transform($e,function(){var Ot=t.apply(this,arguments),_i=this.__zoom,Si=Nt==null?Pt(Ot):typeof Nt=="function"?Nt.apply(this,arguments):Nt;return n(j4.translate(Si[0],Si[1]).scale(_i.k).translate(typeof mt=="function"?-mt.apply(this,arguments):-mt,typeof st=="function"?-st.apply(this,arguments):-st),Ot,I)},Nt,Rt)};function ut($e,mt){return mt=Math.max(b[0],Math.min(b[1],mt)),mt===$e.k?$e:new e0(mt,$e.x,$e.y)}function Tt($e,mt,st){var Nt=mt[0]-st[0]*$e.k,Rt=mt[1]-st[1]*$e.k;return Nt===$e.x&&Rt===$e.y?$e:new e0($e.k,Nt,Rt)}function Pt($e){return[(+$e[0][0]+ +$e[1][0])/2,(+$e[0][1]+ +$e[1][1])/2]}function zt($e,mt,st,Nt){$e.on("start.zoom",function(){Ge(this,arguments).event(Nt).start()}).on("interrupt.zoom end.zoom",function(){Ge(this,arguments).event(Nt).end()}).tween("zoom",function(){var Rt=this,Ot=arguments,_i=Ge(Rt,Ot).event(Nt),Si=t.apply(Rt,Ot),Ti=st==null?Pt(Si):typeof st=="function"?st.apply(Rt,Ot):st,Oi=Math.max(Si[1][0]-Si[0][0],Si[1][1]-Si[0][1]),tn=Rt.__zoom,qi=typeof mt=="function"?mt.apply(Rt,Ot):mt,Ni=G(tn.invert(Ti).concat(Oi/tn.k),qi.invert(Ti).concat(Oi/qi.k));return function(nn){if(nn===1)nn=qi;else{var yn=Ni(nn),Ci=Oi/yn[2];nn=new e0(Ci,Ti[0]-yn[0]*Ci,Ti[1]-yn[1]*Ci)}_i.zoom(null,nn)}})}function Ge($e,mt,st){return!st&&$e.__zooming||new Xt($e,mt)}function Xt($e,mt){this.that=$e,this.args=mt,this.active=0,this.sourceEvent=null,this.extent=t.apply($e,mt),this.taps=0}Xt.prototype={event:function($e){return $e&&(this.sourceEvent=$e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function($e,mt){return this.mouse&&$e!=="mouse"&&(this.mouse[1]=mt.invert(this.mouse[0])),this.touch0&&$e!=="touch"&&(this.touch0[1]=mt.invert(this.touch0[0])),this.touch1&&$e!=="touch"&&(this.touch1[1]=mt.invert(this.touch1[0])),this.that.__zoom=mt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function($e){var mt=dl(this.that).datum();W.call($e,this.that,new Fz($e,{sourceEvent:this.sourceEvent,target:lt,type:$e,transform:this.that.__zoom,dispatch:W}),mt)}};function rt($e,...mt){if(!e.apply(this,arguments))return;var st=Ge(this,mt).event($e),Nt=this.__zoom,Rt=Math.max(b[0],Math.min(b[1],Nt.k*Math.pow(2,c.apply(this,arguments)))),Ot=$f($e);if(st.wheel)(st.mouse[0][0]!==Ot[0]||st.mouse[0][1]!==Ot[1])&&(st.mouse[1]=Nt.invert(st.mouse[0]=Ot)),clearTimeout(st.wheel);else{if(Nt.k===Rt)return;st.mouse=[Ot,Nt.invert(Ot)],Am(this),st.start()}$m($e),st.wheel=setTimeout(_i,Ke),st.zoom("mouse",n(Tt(ut(Nt,Rt),st.mouse[0],st.mouse[1]),st.extent,I));function _i(){st.wheel=null,st.end()}}function yt($e,...mt){if(ue||!e.apply(this,arguments))return;var st=Ge(this,mt,!0).event($e),Nt=dl($e.view).on("mousemove.zoom",Ti,!0).on("mouseup.zoom",Oi,!0),Rt=$f($e,Ot),Ot=$e.currentTarget,_i=$e.clientX,Si=$e.clientY;p4($e.view),ty($e),st.mouse=[Rt,this.__zoom.invert(Rt)],Am(this),st.start();function Ti(tn){if($m(tn),!st.moved){var qi=tn.clientX-_i,Ni=tn.clientY-Si;st.moved=qi*qi+Ni*Ni>ot}st.event(tn).zoom("mouse",n(Tt(st.that.__zoom,st.mouse[0]=$f(tn,Ot),st.mouse[1]),st.extent,I))}function Oi(tn){Nt.on("mousemove.zoom mouseup.zoom",null),m4(tn.view,st.moved),$m(tn),st.event(tn).end()}}function pt($e,...mt){if(e.apply(this,arguments)){var st=this.__zoom,Nt=$f($e.changedTouches?$e.changedTouches[0]:$e,this),Rt=st.invert(Nt),Ot=st.k*($e.shiftKey?.5:2),_i=n(Tt(ut(st,Ot),Nt,Rt),t.apply(this,mt),I);$m($e),a>0?dl(this).transition().duration(a).call(zt,_i,Nt,$e):dl(this).call(lt.transform,_i,Nt,$e)}}function gt($e,...mt){if(e.apply(this,arguments)){var st=$e.touches,Nt=st.length,Rt=Ge(this,mt,$e.changedTouches.length===Nt).event($e),Ot,_i,Si,Ti;for(ty($e),_i=0;_i<Nt;++_i)Si=st[_i],Ti=$f(Si,this),Ti=[Ti,this.__zoom.invert(Ti),Si.identifier],Rt.touch0?!Rt.touch1&&Rt.touch0[2]!==Ti[2]&&(Rt.touch1=Ti,Rt.taps=0):(Rt.touch0=Ti,Ot=!0,Rt.taps=1+!!he);he&&(he=clearTimeout(he)),Ot&&(Rt.taps<2&&(ae=Ti[0],he=setTimeout(function(){he=null},be)),Am(this),Rt.start())}}function bt($e,...mt){if(this.__zooming){var st=Ge(this,mt).event($e),Nt=$e.changedTouches,Rt=Nt.length,Ot,_i,Si,Ti;for($m($e),Ot=0;Ot<Rt;++Ot)_i=Nt[Ot],Si=$f(_i,this),st.touch0&&st.touch0[2]===_i.identifier?st.touch0[0]=Si:st.touch1&&st.touch1[2]===_i.identifier&&(st.touch1[0]=Si);if(_i=st.that.__zoom,st.touch1){var Oi=st.touch0[0],tn=st.touch0[1],qi=st.touch1[0],Ni=st.touch1[1],nn=(nn=qi[0]-Oi[0])*nn+(nn=qi[1]-Oi[1])*nn,yn=(yn=Ni[0]-tn[0])*yn+(yn=Ni[1]-tn[1])*yn;_i=ut(_i,Math.sqrt(nn/yn)),Si=[(Oi[0]+qi[0])/2,(Oi[1]+qi[1])/2],Ti=[(tn[0]+Ni[0])/2,(tn[1]+Ni[1])/2]}else if(st.touch0)Si=st.touch0[0],Ti=st.touch0[1];else return;st.zoom("touch",n(Tt(_i,Si,Ti),st.extent,I))}}function dt($e,...mt){if(this.__zooming){var st=Ge(this,mt).event($e),Nt=$e.changedTouches,Rt=Nt.length,Ot,_i;for(ty($e),ue&&clearTimeout(ue),ue=setTimeout(function(){ue=null},be),Ot=0;Ot<Rt;++Ot)_i=Nt[Ot],st.touch0&&st.touch0[2]===_i.identifier?delete st.touch0:st.touch1&&st.touch1[2]===_i.identifier&&delete st.touch1;if(st.touch1&&!st.touch0&&(st.touch0=st.touch1,delete st.touch1),st.touch0)st.touch0[1]=this.__zoom.invert(st.touch0[0]);else if(st.end(),st.taps===2&&(_i=$f(_i,this),Math.hypot(ae[0]-_i[0],ae[1]-_i[1])<tt)){var Si=dl(this).on("dblclick.zoom");Si&&Si.apply(this,arguments)}}}return lt.wheelDelta=function($e){return arguments.length?(c=typeof $e=="function"?$e:Yg(+$e),lt):c},lt.filter=function($e){return arguments.length?(e=typeof $e=="function"?$e:Yg(!!$e),lt):e},lt.touchable=function($e){return arguments.length?(g=typeof $e=="function"?$e:Yg(!!$e),lt):g},lt.extent=function($e){return arguments.length?(t=typeof $e=="function"?$e:Yg([[+$e[0][0],+$e[0][1]],[+$e[1][0],+$e[1][1]]]),lt):t},lt.scaleExtent=function($e){return arguments.length?(b[0]=+$e[0],b[1]=+$e[1],lt):[b[0],b[1]]},lt.translateExtent=function($e){return arguments.length?(I[0][0]=+$e[0][0],I[1][0]=+$e[1][0],I[0][1]=+$e[0][1],I[1][1]=+$e[1][1],lt):[[I[0][0],I[0][1]],[I[1][0],I[1][1]]]},lt.constrain=function($e){return arguments.length?(n=$e,lt):n},lt.duration=function($e){return arguments.length?(a=+$e,lt):a},lt.interpolate=function($e){return arguments.length?(G=$e,lt):G},lt.on=function(){var $e=W.on.apply(W,arguments);return $e===W?lt:$e},lt.clickDistance=function($e){return arguments.length?(ot=($e=+$e)*$e,lt):Math.sqrt(ot)},lt.tapDistance=function($e){return arguments.length?(tt=+$e,lt):tt},lt}var Z4="1.13.6",Nb=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},s1=Array.prototype,r2=Object.prototype,Vb=typeof Symbol<"u"?Symbol.prototype:null,Hz=s1.push,Dg=s1.slice,vg=r2.toString,jz=r2.hasOwnProperty,Q4=typeof ArrayBuffer<"u",Zz=typeof DataView<"u",Qz=Array.isArray,Ub=Object.keys,Gb=Object.create,qb=Q4&&ArrayBuffer.isView,Wz=isNaN,Xz=isFinite,W4=!{toString:null}.propertyIsEnumerable("toString"),Hb=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Yz=Math.pow(2,53)-1;function Hc(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),c=Array(n),g=0;g<n;g++)c[g]=arguments[g+t];switch(t){case 0:return e.call(this,c);case 1:return e.call(this,arguments[0],c);case 2:return e.call(this,arguments[0],arguments[1],c)}var b=Array(t+1);for(g=0;g<t;g++)b[g]=arguments[g];return b[t]=c,e.apply(this,b)}}function fp(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function $z(e){return e===null}function op(e){return e===void 0}function X4(e){return e===!0||e===!1||vg.call(e)==="[object Boolean]"}function Kz(e){return!!(e&&e.nodeType===1)}function nc(e){var t="[object "+e+"]";return function(n){return vg.call(n)===t}}const a1=nc("String"),Y4=nc("Number"),Jz=nc("Date"),e9=nc("RegExp"),t9=nc("Error"),$4=nc("Symbol"),K4=nc("ArrayBuffer");var J4=nc("Function"),i9=Nb.document&&Nb.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof i9!="function"&&(J4=function(e){return typeof e=="function"||!1});const tc=J4,eS=nc("Object");var tS=Zz&&eS(new DataView(new ArrayBuffer(8))),s2=typeof Map<"u"&&eS(new Map),n9=nc("DataView");function r9(e){return e!=null&&tc(e.getInt8)&&K4(e.buffer)}const N_=tS?r9:n9,dp=Qz||nc("Array");function G0(e,t){return e!=null&&jz.call(e,t)}var fv=nc("Arguments");(function(){fv(arguments)||(fv=function(e){return G0(e,"callee")})})();const a2=fv;function s9(e){return!$4(e)&&Xz(e)&&!isNaN(parseFloat(e))}function iS(e){return Y4(e)&&Wz(e)}function nS(e){return function(){return e}}function rS(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=Yz}}function sS(e){return function(t){return t==null?void 0:t[e]}}const V_=sS("byteLength"),a9=rS(V_);var o9=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function l9(e){return qb?qb(e)&&!N_(e):a9(e)&&o9.test(vg.call(e))}const aS=Q4?l9:nS(!1),jc=sS("length");function u9(e){for(var t={},n=e.length,c=0;c<n;++c)t[e[c]]=!0;return{contains:function(g){return t[g]===!0},push:function(g){return t[g]=!0,e.push(g)}}}function oS(e,t){t=u9(t);var n=Hb.length,c=e.constructor,g=tc(c)&&c.prototype||r2,b="constructor";for(G0(e,b)&&!t.contains(b)&&t.push(b);n--;)b=Hb[n],b in e&&e[b]!==g[b]&&!t.contains(b)&&t.push(b)}function pu(e){if(!fp(e))return[];if(Ub)return Ub(e);var t=[];for(var n in e)G0(e,n)&&t.push(n);return W4&&oS(e,t),t}function c9(e){if(e==null)return!0;var t=jc(e);return typeof t=="number"&&(dp(e)||a1(e)||a2(e))?t===0:jc(pu(e))===0}function lS(e,t){var n=pu(t),c=n.length;if(e==null)return!c;for(var g=Object(e),b=0;b<c;b++){var I=n[b];if(t[I]!==g[I]||!(I in g))return!1}return!0}function uo(e){if(e instanceof uo)return e;if(!(this instanceof uo))return new uo(e);this._wrapped=e}uo.VERSION=Z4;uo.prototype.value=function(){return this._wrapped};uo.prototype.valueOf=uo.prototype.toJSON=uo.prototype.value;uo.prototype.toString=function(){return String(this._wrapped)};function jb(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,V_(e))}var Zb="[object DataView]";function dv(e,t,n,c){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var g=typeof e;return g!=="function"&&g!=="object"&&typeof t!="object"?!1:uS(e,t,n,c)}function uS(e,t,n,c){e instanceof uo&&(e=e._wrapped),t instanceof uo&&(t=t._wrapped);var g=vg.call(e);if(g!==vg.call(t))return!1;if(tS&&g=="[object Object]"&&N_(e)){if(!N_(t))return!1;g=Zb}switch(g){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return Vb.valueOf.call(e)===Vb.valueOf.call(t);case"[object ArrayBuffer]":case Zb:return uS(jb(e),jb(t),n,c)}var b=g==="[object Array]";if(!b&&aS(e)){var I=V_(e);if(I!==V_(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;b=!0}if(!b){if(typeof e!="object"||typeof t!="object")return!1;var a=e.constructor,G=t.constructor;if(a!==G&&!(tc(a)&&a instanceof a&&tc(G)&&G instanceof G)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],c=c||[];for(var W=n.length;W--;)if(n[W]===e)return c[W]===t;if(n.push(e),c.push(t),b){if(W=e.length,W!==t.length)return!1;for(;W--;)if(!dv(e[W],t[W],n,c))return!1}else{var he=pu(e),ae;if(W=he.length,pu(t).length!==W)return!1;for(;W--;)if(ae=he[W],!(G0(t,ae)&&dv(e[ae],t[ae],n,c)))return!1}return n.pop(),c.pop(),!0}function h9(e,t){return dv(e,t)}function Lg(e){if(!fp(e))return[];var t=[];for(var n in e)t.push(n);return W4&&oS(e,t),t}function o2(e){var t=jc(e);return function(n){if(n==null)return!1;var c=Lg(n);if(jc(c))return!1;for(var g=0;g<t;g++)if(!tc(n[e[g]]))return!1;return e!==AS||!tc(n[l2])}}var l2="forEach",cS="has",u2=["clear","delete"],hS=["get",cS,"set"],A9=u2.concat(l2,hS),AS=u2.concat(hS),f9=["add"].concat(u2,l2,cS);const d9=s2?o2(A9):nc("Map"),p9=s2?o2(AS):nc("WeakMap"),m9=s2?o2(f9):nc("Set"),g9=nc("WeakSet");function pp(e){for(var t=pu(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=e[t[g]];return c}function _9(e){for(var t=pu(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=[t[g],e[t[g]]];return c}function fS(e){for(var t={},n=pu(e),c=0,g=n.length;c<g;c++)t[e[n[c]]]=n[c];return t}function pv(e){var t=[];for(var n in e)tc(e[n])&&t.push(n);return t.sort()}function c2(e,t){return function(n){var c=arguments.length;if(t&&(n=Object(n)),c<2||n==null)return n;for(var g=1;g<c;g++)for(var b=arguments[g],I=e(b),a=I.length,G=0;G<a;G++){var W=I[G];(!t||n[W]===void 0)&&(n[W]=b[W])}return n}}const fA=c2(Lg),xg=c2(pu),h2=c2(Lg,!0);function y9(){return function(){}}function dS(e){if(!fp(e))return{};if(Gb)return Gb(e);var t=y9();t.prototype=e;var n=new t;return t.prototype=null,n}function v9(e,t){var n=dS(e);return t&&xg(n,t),n}function pS(e){return fp(e)?dp(e)?e.slice():fA({},e):e}function x9(e,t){return t(e),e}function mS(e){return dp(e)?e:[e]}uo.toPath=mS;function Bg(e){return uo.toPath(e)}function A2(e,t){for(var n=t.length,c=0;c<n;c++){if(e==null)return;e=e[t[c]]}return n?e:void 0}function gS(e,t,n){var c=A2(e,Bg(t));return op(c)?n:c}function o1(e,t){t=Bg(t);for(var n=t.length,c=0;c<n;c++){var g=t[c];if(!G0(e,g))return!1;e=e[g]}return!!n}function f2(e){return e}function bg(e){return e=xg({},e),function(t){return lS(t,e)}}function d2(e){return e=Bg(e),function(t){return A2(t,e)}}function zg(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(c){return e.call(t,c)};case 3:return function(c,g,b){return e.call(t,c,g,b)};case 4:return function(c,g,b,I){return e.call(t,c,g,b,I)}}return function(){return e.apply(t,arguments)}}function _S(e,t,n){return e==null?f2:tc(e)?zg(e,t,n):fp(e)&&!dp(e)?bg(e):d2(e)}function p2(e,t){return _S(e,t,1/0)}uo.iteratee=p2;function Wc(e,t,n){return uo.iteratee!==p2?uo.iteratee(e,t):_S(e,t,n)}function yS(e,t,n){t=Wc(t,n);for(var c=pu(e),g=c.length,b={},I=0;I<g;I++){var a=c[I];b[a]=t(e[a],a,e)}return b}function vS(){}function b9(e){return e==null?vS:function(t){return gS(e,t)}}function w9(e,t,n){var c=Array(Math.max(0,e));t=zg(t,n,1);for(var g=0;g<e;g++)c[g]=t(g);return c}function mv(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const wg=Date.now||function(){return new Date().getTime()};function xS(e){var t=function(b){return e[b]},n="(?:"+pu(e).join("|")+")",c=RegExp(n),g=RegExp(n,"g");return function(b){return b=b==null?"":""+b,c.test(b)?b.replace(g,t):b}}const bS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},S9=xS(bS),I9=fS(bS),E9=xS(I9),C9=uo.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var iy=/(.)^/,T9={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},k9=/\\|'|\r|\n|\u2028|\u2029/g;function M9(e){return"\\"+T9[e]}var P9=/^\s*(\w|\$)+\s*$/;function D9(e,t,n){!t&&n&&(t=n),t=h2({},t,uo.templateSettings);var c=RegExp([(t.escape||iy).source,(t.interpolate||iy).source,(t.evaluate||iy).source].join("|")+"|$","g"),g=0,b="__p+='";e.replace(c,function(W,he,ae,ue,be){return b+=e.slice(g,be).replace(k9,M9),g=be+W.length,he?b+=`'+
((__t=(`+he+`))==null?'':_.escape(__t))+
'`:ae?b+=`'+
((__t=(`+ae+`))==null?'':__t)+
'`:ue&&(b+=`';
`+ue+`
__p+='`),W}),b+=`';
`;var I=t.variable;if(I){if(!P9.test(I))throw new Error("variable is not a bare identifier: "+I)}else b=`with(obj||{}){
`+b+`}
`,I="obj";b=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+b+`return __p;
`;var a;try{a=new Function(I,"_",b)}catch(W){throw W.source=b,W}var G=function(W){return a.call(this,W,uo)};return G.source="function("+I+`){
`+b+"}",G}function L9(e,t,n){t=Bg(t);var c=t.length;if(!c)return tc(n)?n.call(e):n;for(var g=0;g<c;g++){var b=e==null?void 0:e[t[g]];b===void 0&&(b=n,g=c),e=tc(b)?b.call(e):b}return e}var B9=0;function z9(e){var t=++B9+"";return e?e+t:t}function R9(e){var t=uo(e);return t._chain=!0,t}function wS(e,t,n,c,g){if(!(c instanceof t))return e.apply(n,g);var b=dS(e.prototype),I=e.apply(b,g);return fp(I)?I:b}var nf=Hc(function(e,t){var n=nf.placeholder,c=function(){for(var g=0,b=t.length,I=Array(b),a=0;a<b;a++)I[a]=t[a]===n?arguments[g++]:t[a];for(;g<arguments.length;)I.push(arguments[g++]);return wS(e,c,this,this,I)};return c});nf.placeholder=uo;const SS=Hc(function(e,t,n){if(!tc(e))throw new TypeError("Bind must be called on a function");var c=Hc(function(g){return wS(e,c,t,this,n.concat(g))});return c}),_h=rS(jc);function mp(e,t,n,c){if(c=c||[],!t&&t!==0)t=1/0;else if(t<=0)return c.concat(e);for(var g=c.length,b=0,I=jc(e);b<I;b++){var a=e[b];if(_h(a)&&(dp(a)||a2(a)))if(t>1)mp(a,t-1,n,c),g=c.length;else for(var G=0,W=a.length;G<W;)c[g++]=a[G++];else n||(c[g++]=a)}return c}const F9=Hc(function(e,t){t=mp(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var c=t[n];e[c]=SS(e[c],e)}return e});function O9(e,t){var n=function(c){var g=n.cache,b=""+(t?t.apply(this,arguments):c);return G0(g,b)||(g[b]=e.apply(this,arguments)),g[b]};return n.cache={},n}const IS=Hc(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),N9=nf(IS,uo,1);function V9(e,t,n){var c,g,b,I,a=0;n||(n={});var G=function(){a=n.leading===!1?0:wg(),c=null,I=e.apply(g,b),c||(g=b=null)},W=function(){var he=wg();!a&&n.leading===!1&&(a=he);var ae=t-(he-a);return g=this,b=arguments,ae<=0||ae>t?(c&&(clearTimeout(c),c=null),a=he,I=e.apply(g,b),c||(g=b=null)):!c&&n.trailing!==!1&&(c=setTimeout(G,ae)),I};return W.cancel=function(){clearTimeout(c),a=0,c=g=b=null},W}function U9(e,t,n){var c,g,b,I,a,G=function(){var he=wg()-g;t>he?c=setTimeout(G,t-he):(c=null,n||(I=e.apply(a,b)),c||(b=a=null))},W=Hc(function(he){return a=this,b=he,g=wg(),c||(c=setTimeout(G,t),n&&(I=e.apply(a,b))),I});return W.cancel=function(){clearTimeout(c),c=b=a=null},W}function G9(e,t){return nf(t,e)}function m2(e){return function(){return!e.apply(this,arguments)}}function q9(){var e=arguments,t=e.length-1;return function(){for(var n=t,c=e[t].apply(this,arguments);n--;)c=e[n].call(this,c);return c}}function H9(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function ES(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const j9=nf(ES,2);function CS(e,t,n){t=Wc(t,n);for(var c=pu(e),g,b=0,I=c.length;b<I;b++)if(g=c[b],t(e[g],g,e))return g}function TS(e){return function(t,n,c){n=Wc(n,c);for(var g=jc(t),b=e>0?0:g-1;b>=0&&b<g;b+=e)if(n(t[b],b,t))return b;return-1}}const g2=TS(1),kS=TS(-1);function MS(e,t,n,c){n=Wc(n,c,1);for(var g=n(t),b=0,I=jc(e);b<I;){var a=Math.floor((b+I)/2);n(e[a])<g?b=a+1:I=a}return b}function PS(e,t,n){return function(c,g,b){var I=0,a=jc(c);if(typeof b=="number")e>0?I=b>=0?b:Math.max(b+a,I):a=b>=0?Math.min(b+1,a):b+a+1;else if(n&&b&&a)return b=n(c,g),c[b]===g?b:-1;if(g!==g)return b=t(Dg.call(c,I,a),iS),b>=0?b+I:-1;for(b=e>0?I:a-1;b>=0&&b<a;b+=e)if(c[b]===g)return b;return-1}}const DS=PS(1,g2,MS),Z9=PS(-1,kS);function gv(e,t,n){var c=_h(e)?g2:CS,g=c(e,t,n);if(g!==void 0&&g!==-1)return e[g]}function Q9(e,t){return gv(e,bg(t))}function Zc(e,t,n){t=zg(t,n);var c,g;if(_h(e))for(c=0,g=e.length;c<g;c++)t(e[c],c,e);else{var b=pu(e);for(c=0,g=b.length;c<g;c++)t(e[b[c]],b[c],e)}return e}function mc(e,t,n){t=Wc(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,b=Array(g),I=0;I<g;I++){var a=c?c[I]:I;b[I]=t(e[a],a,e)}return b}function LS(e){var t=function(n,c,g,b){var I=!_h(n)&&pu(n),a=(I||n).length,G=e>0?0:a-1;for(b||(g=n[I?I[G]:G],G+=e);G>=0&&G<a;G+=e){var W=I?I[G]:G;g=c(g,n[W],W,n)}return g};return function(n,c,g,b){var I=arguments.length>=3;return t(n,zg(c,b,4),g,I)}}const ny=LS(1),Qb=LS(-1);function dh(e,t,n){var c=[];return t=Wc(t,n),Zc(e,function(g,b,I){t(g,b,I)&&c.push(g)}),c}function BS(e,t,n){return dh(e,m2(Wc(t)),n)}function _v(e,t,n){t=Wc(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,b=0;b<g;b++){var I=c?c[b]:b;if(!t(e[I],I,e))return!1}return!0}function U_(e,t,n){t=Wc(t,n);for(var c=!_h(e)&&pu(e),g=(c||e).length,b=0;b<g;b++){var I=c?c[b]:b;if(t(e[I],I,e))return!0}return!1}function JA(e,t,n,c){return _h(e)||(e=pp(e)),(typeof n!="number"||c)&&(n=0),DS(e,t,n)>=0}const W9=Hc(function(e,t,n){var c,g;return tc(t)?g=t:(t=Bg(t),c=t.slice(0,-1),t=t[t.length-1]),mc(e,function(b){var I=g;if(!I){if(c&&c.length&&(b=A2(b,c)),b==null)return;I=b[t]}return I==null?I:I.apply(b,n)})});function l1(e,t){return mc(e,d2(t))}function X9(e,t){return dh(e,bg(t))}function _2(e,t,n){var c=-1/0,g=-1/0,b,I;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=_h(e)?e:pp(e);for(var a=0,G=e.length;a<G;a++)b=e[a],b!=null&&b>c&&(c=b)}else t=Wc(t,n),Zc(e,function(W,he,ae){I=t(W,he,ae),(I>g||I===-1/0&&c===-1/0)&&(c=W,g=I)});return c}function zS(e,t,n){var c=1/0,g=1/0,b,I;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=_h(e)?e:pp(e);for(var a=0,G=e.length;a<G;a++)b=e[a],b!=null&&b<c&&(c=b)}else t=Wc(t,n),Zc(e,function(W,he,ae){I=t(W,he,ae),(I<g||I===1/0&&c===1/0)&&(c=W,g=I)});return c}var Y9=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function RS(e){return e?dp(e)?Dg.call(e):a1(e)?e.match(Y9):_h(e)?mc(e,f2):pp(e):[]}function FS(e,t,n){if(t==null||n)return _h(e)||(e=pp(e)),e[mv(e.length-1)];var c=RS(e),g=jc(c);t=Math.max(Math.min(t,g),0);for(var b=g-1,I=0;I<t;I++){var a=mv(I,b),G=c[I];c[I]=c[a],c[a]=G}return c.slice(0,t)}function $9(e){return FS(e,1/0)}function OS(e,t,n){var c=0;return t=Wc(t,n),l1(mc(e,function(g,b,I){return{value:g,index:c++,criteria:t(g,b,I)}}).sort(function(g,b){var I=g.criteria,a=b.criteria;if(I!==a){if(I>a||I===void 0)return 1;if(I<a||a===void 0)return-1}return g.index-b.index}),"value")}function u1(e,t){return function(n,c,g){var b=t?[[],[]]:{};return c=Wc(c,g),Zc(n,function(I,a){var G=c(I,a,n);e(b,I,G)}),b}}const K9=u1(function(e,t,n){G0(e,n)?e[n].push(t):e[n]=[t]}),J9=u1(function(e,t,n){e[n]=t}),eR=u1(function(e,t,n){G0(e,n)?e[n]++:e[n]=1}),tR=u1(function(e,t,n){e[n?0:1].push(t)},!0);function iR(e){return e==null?0:_h(e)?e.length:pu(e).length}function nR(e,t,n){return t in n}const y2=Hc(function(e,t){var n={},c=t[0];if(e==null)return n;tc(c)?(t.length>1&&(c=zg(c,t[1])),t=Lg(e)):(c=nR,t=mp(t,!1,!1),e=Object(e));for(var g=0,b=t.length;g<b;g++){var I=t[g],a=e[I];c(a,I,e)&&(n[I]=a)}return n}),rR=Hc(function(e,t){var n=t[0],c;return tc(n)?(n=m2(n),t.length>1&&(c=t[1])):(t=mc(mp(t,!1,!1),String),n=function(g,b){return!JA(t,b)}),y2(e,n,c)});function NS(e,t,n){return Dg.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function ry(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:NS(e,e.length-t)}function $d(e,t,n){return Dg.call(e,t==null||n?1:t)}function sR(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:$d(e,Math.max(0,e.length-t))}function VS(e){return dh(e,Boolean)}function aR(e,t){return mp(e,t,!1)}const US=Hc(function(e,t){return t=mp(t,!0,!0),dh(e,function(n){return!JA(t,n)})}),oR=Hc(function(e,t){return US(e,t)});function yv(e,t,n,c){X4(t)||(c=n,n=t,t=!1),n!=null&&(n=Wc(n,c));for(var g=[],b=[],I=0,a=jc(e);I<a;I++){var G=e[I],W=n?n(G,I,e):G;t&&!n?((!I||b!==W)&&g.push(G),b=W):n?JA(b,W)||(b.push(W),g.push(G)):JA(g,G)||g.push(G)}return g}const GS=Hc(function(e){return yv(mp(e,!0,!0))});function qS(e){for(var t=[],n=arguments.length,c=0,g=jc(e);c<g;c++){var b=e[c];if(!JA(t,b)){var I;for(I=1;I<n&&JA(arguments[I],b);I++);I===n&&t.push(b)}}return t}function vv(e){for(var t=e&&_2(e,jc).length||0,n=Array(t),c=0;c<t;c++)n[c]=l1(e,c);return n}const lR=Hc(vv);function u_(e,t){for(var n={},c=0,g=jc(e);c<g;c++)t?n[e[c]]=t[c]:n[e[c][0]]=e[c][1];return n}function uR(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var c=Math.max(Math.ceil((t-e)/n),0),g=Array(c),b=0;b<c;b++,e+=n)g[b]=e;return g}function cR(e,t){if(t==null||t<1)return[];for(var n=[],c=0,g=e.length;c<g;)n.push(Dg.call(e,c,c+=t));return n}function v2(e,t){return e._chain?uo(t).chain():t}function HS(e){return Zc(pv(e),function(t){var n=uo[t]=e[t];uo.prototype[t]=function(){var c=[this._wrapped];return Hz.apply(c,arguments),v2(this,n.apply(uo,c))}}),uo}Zc(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s1[e];uo.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),v2(this,n)}});Zc(["concat","join","slice"],function(e){var t=s1[e];uo.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),v2(this,n)}});const hR=Object.freeze(Object.defineProperty({__proto__:null,VERSION:Z4,after:H9,all:_v,allKeys:Lg,any:U_,assign:xg,before:ES,bind:SS,bindAll:F9,chain:R9,chunk:cR,clone:pS,collect:mc,compact:VS,compose:q9,constant:nS,contains:JA,countBy:eR,create:v9,debounce:U9,default:uo,defaults:h2,defer:N9,delay:IS,detect:gv,difference:US,drop:$d,each:Zc,escape:S9,every:_v,extend:fA,extendOwn:xg,filter:dh,find:gv,findIndex:g2,findKey:CS,findLastIndex:kS,findWhere:Q9,first:ry,flatten:aR,foldl:ny,foldr:Qb,forEach:Zc,functions:pv,get:gS,groupBy:K9,has:o1,head:ry,identity:f2,include:JA,includes:JA,indexBy:J9,indexOf:DS,initial:NS,inject:ny,intersection:qS,invert:fS,invoke:W9,isArguments:a2,isArray:dp,isArrayBuffer:K4,isBoolean:X4,isDataView:N_,isDate:Jz,isElement:Kz,isEmpty:c9,isEqual:h9,isError:t9,isFinite:s9,isFunction:tc,isMap:d9,isMatch:lS,isNaN:iS,isNull:$z,isNumber:Y4,isObject:fp,isRegExp:e9,isSet:m9,isString:a1,isSymbol:$4,isTypedArray:aS,isUndefined:op,isWeakMap:p9,isWeakSet:g9,iteratee:p2,keys:pu,last:sR,lastIndexOf:Z9,map:mc,mapObject:yS,matcher:bg,matches:bg,max:_2,memoize:O9,methods:pv,min:zS,mixin:HS,negate:m2,noop:vS,now:wg,object:u_,omit:rR,once:j9,pairs:_9,partial:nf,partition:tR,pick:y2,pluck:l1,property:d2,propertyOf:b9,random:mv,range:uR,reduce:ny,reduceRight:Qb,reject:BS,rest:$d,restArguments:Hc,result:L9,sample:FS,select:dh,shuffle:$9,size:iR,some:U_,sortBy:OS,sortedIndex:MS,tail:$d,take:ry,tap:x9,template:D9,templateSettings:C9,throttle:V9,times:w9,toArray:RS,toPath:mS,transpose:vv,unescape:E9,union:GS,uniq:yv,unique:yv,uniqueId:z9,unzip:vv,values:pp,where:X9,without:oR,wrap:G9,zip:lR},Symbol.toStringTag,{value:"Module"}));var Wb=HS(hR);Wb._=Wb;var AR=function(e,t){var n;return parseString(e,function(c,g){n=g["nex:nexml"].trees[0].tree.map(function(b){var I=b.node.map(ae=>ae.$),a=I.reduce(function(ae,ue){return ue.edges=[],ue.name=ue.id,ae[ue.id]=ue,ae},{}),G=I.filter(ae=>ae.root),W=G>0?G[0].id:I[0].id;a[W].name="root",b.edge.map(ae=>ae.$).forEach(function(ae){a[ae.source].edges.push(ae)});function he(ae,ue){if(ae.edges){var be=l1(ae.edges,"target");ae.children=pp(y2(a,be)),ae.children.forEach(function(Ke,ot){Ke.attribute=ae.edges[ot].length||""}),ae.children.forEach(he),ae.annotation=""}}return he(a[W]),a[W]})}),n};function fR(e,t,n,c){let g=this.nodes.descendants();if(e.parent&&g.indexOf(e)>=0){let I=e.parent.children.indexOf(e),a={name:n,parent:e.parent,attribute:c?c[2]:null,original_child_order:e.original_child_order},G={name:t,parent:a,attribute:c?c[1]:null,original_child_order:2};a.children=[e,G],e.parent.children[I]=a,e.parent=a,e.attribute=c?c[0]:null,e.original_child_order=1}return this}function dR(e,t){return e.children?e.children.push(t):e.children=[t],e}function pR(e,t){return{data:{name:e,attribute:t?t[1]:null},parent:""}}function mR(e){let t=this.nodes.descendants();if(typeof e!="number")return this.deleteANode(t.indexOf(e));if(e>0&&e<t.length){let n=t[e];if(n.parent){let c=n.parent.children.indexOf(n);c>=0&&(t.splice(e,1),n.children&&n.children.forEach(function(g){g.original_child_order=n.parent.children.length,n.parent.children.push(g),g.parent=n.parent}),n.parent.children.length>2?n.parent.children.splice(c,1):n.parent.parent?(n.parent.parent.children[n.parent.parent.children.indexOf(n.parent)]=n.parent.children[1-c],n.parent.children[1-c].parent=n.parent.parent,t.splice(t.indexOf(n.parent),1)):(t.splice(0,1),t.parent=null,delete t.data.attribute,delete t.data.annotation,delete t.data.original_child_order,t.name="root",t.data.name="root"))}}return this}function gR(){return dh(this.nodes.descendants(),e=>!o1(e,"children"))}function _R(){return dh(this.nodes.descendants(),e=>o1(e,"children"))}function yR(){return this.nodes}function vR(){return this.nodes}function xR(e){return dh(this.nodes.descendants(),t=>t.data.name==e)[0]}function bR(e){Zc(this.nodes.descendants(),function(t){t.data&&t.data.name in e&&(t.annotations=e[t.data.name])})}function Sl(e){return!o1(e,"children")}function wR(e,t){return this.nodes.each(function(n){e in n&&(t&&(n[t]=n[e]),delete n[e])}),this}function SR(e){e||this.nodes.each(t=>{Sl(t)||(t[this.selection_attribute_name]=!1,t.data.traits||(t.data.traits={}),t.data.traits[this.selection_attribute_name]=t[this.selection_attribute_name])})}function jS(e,t,n){let c=[];function g(b){Sl(b)?t&&b!=e&&c.push(b):(n&&b!=e&&c.push(b),b.children.forEach(g))}return g(e),c}const IR=Object.freeze(Object.defineProperty({__proto__:null,addChild:dR,assignAttributes:bR,clearInternalNodes:SR,createNode:pR,deleteANode:mR,getInternals:_R,getNodeByName:xR,getNodes:vR,getRootNode:yR,getTips:gR,graftANode:fR,isLeafNode:Sl,selectAllDescendants:jS,updateKeyName:wR},Symbol.toStringTag,{value:"Module"}));function Sg(e,t={}){const n=/^-?\d+(\.\d+)?$/;let c=t.left_delimiter||"{",g=t.right_delimiter||"}",b=[];function I(){let Tt={name:null},Pt=b[b.length-1];"children"in Pt||(Pt.children=[]),b.push(Tt),Pt.children.push(b[b.length-1]),b[b.length-1].original_child_order=Pt.children.length}function a(){let Tt=b.pop();Tt.name=he,"children"in Tt?Tt.bootstrap_values=he:Tt.name=he,Tt.attribute=ae,c=="["&&ue.includes("&&NHX")?ue.split(":").slice(1).forEach(Pt=>{const[zt,Ge]=Pt.split("=");Tt[zt]=n.test(Ge)?+Ge:Ge}):Tt.annotation=ue,he="",ae="",ue=""}function G(Tt){return{json:null,error:"Unexpected '"+e[Tt]+"' in '"+e.substring(Tt-20,Tt+1)+"[ERROR HERE]"+e.substring(Tt+1,Tt+20)+"'"}}let W=0,he="",ae="",ue="",be=null,Ke={"'":1,'"':1},ot={name:"root"};b.push(ot);for(var tt=/\s/,lt=0;lt<e.length;lt++)try{var ut=e[lt];switch(W){case 0:{ut=="("&&(I(),W=1);break}case 1:case 3:{if(ut==":")W=3;else if(ut==","||ut==")")try{a(),W=1,ut==","&&I()}catch{return G(lt)}else if(ut=="("){if(he.length>0)return G(lt);I()}else if(ut in Ke){if(W==1&&he.length===0&&ae.length===0&&ue.length===0){W=2,be=ut;continue}return G(lt)}else if(ut==c){if(ue.length)return G(lt);W=4}else if(W==3)ae+=ut;else{if(tt.test(ut))continue;if(ut==";"){lt=e.length;break}he+=ut}break}case 2:{if(ut==be){if(lt<e.length-1&&e[lt+1]==be){lt++,he+=be;continue}be=0,W=1;continue}else he+=ut;break}case 4:{if(ut==g)W=3;else{if(ut==c)return G(lt);ue+=ut}break}}}catch{return G(lt)}return b.length!=1?G(e.length-1):{json:ot,error:null}}function ER(e,t){let n=this;e||(e=b=>"");function c(b){if(b.notshown)return;if(Sl(b)||(g.push("("),b.children.forEach(function(a,G){G&&g.push(","),c(a)}),g.push(")")),b.data.name!=="root"){const a=b.data.name.replaceAll("'","''");/\W/.test(a)?g.push("'"+a+"'"):g.push(a)}g.push(e(b));let I=n.branch_length_accessor(b);I!==void 0&&g.push(":"+I)}let g=[];return e=e||"",c(t||this.nodes),g.join("")+";"}function CR(e){let t=e,n=t.toUpperCase().indexOf("BEGIN DATA;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let g=c.slice(0,n);c=mc(g.split(";"),G=>G.trim());let b=dh(c,G=>G.toUpperCase().startsWith("DIMENSION"));b=b[0].split(" "),b=u_(mc($d(b),G=>G.split("=")));let I=dh(c,G=>G.toUpperCase().startsWith("FORMAT"));I=I[0].split(" "),I=u_(mc($d(I),G=>G.split("="))),I.symbols=BS(I.symbols.split(""),G=>G=='"');let a=dh(c,G=>G.toUpperCase().startsWith("MATRIX"));return a=a[0].split(`
`),a=u_(mc($d(a),G=>VS(G.split(" ")))),a=yS(a,(G,W)=>G=="?"?I.symbols:Array(G)),{dimensions:b,format:I,matrix:a}}function TR(e,t,n){Zc(e.getTips(),c=>{c.data.test=n.matrix[c.data.name]})}function ZS(e){let t=e,n=t.toUpperCase().indexOf("BEGIN TREES;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let b=c.slice(0,n).split(`
`);return b=dh(b,I=>I.trim().toUpperCase().startsWith("TREE")),Sg(b[0])}const kR=Object.freeze(Object.defineProperty({__proto__:null,default:ZS,loadAnnotations:TR,parseAnnotations:CR},Symbol.toStringTag,{value:"Module"}));function xv(e){var t={};if(e.nodeType==1){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var c=e.attributes.item(n);t["@attributes"][c.nodeName]=c.nodeValue}}}else e.nodeType==3&&(t=e.nodeValue);if(e.hasChildNodes()&&e.childNodes.length===1&&e.childNodes[0].nodeType===3)t=e.childNodes[0].nodeValue;else if(e.hasChildNodes())for(var g=0;g<e.childNodes.length;g++){var b=e.childNodes.item(g),I=b.nodeName;if(typeof t[I]>"u")t[I]=xv(b);else{if(typeof t[I].push>"u"){var a=t[I];t[I]=[],t[I].push(a)}t[I].push(xv(b))}}return t}var QS=function(e,t){function n(g,b){g.clade&&(g.clade.forEach(n),g.children=g.clade,delete g.clade),g.annotation=1,g.attribute="0.01",g.branch_length&&(g.attribute=g.branch_length),g.taxonomy&&(g.name=g.taxonomy.scientific_name),g.annotation=""}var c;return e=xv(e),c=e.phyloxml.phylogeny.clade,c.name="root",n(c),{json:c,error:null}};function MR(e,t){t.left_delimiter="[",t.right_delimiter="]";const n=Sg(e,t);function c(g){if(g.annotation){g.beast={};const I=g.annotation.split(/=|,|{|}/).filter(a=>a);for(var b=0;b<I.length;b+=2){let a=I[b].replace(/&|%/g,"");/[a-df-zA-DF-Z]+/.test(I[b+2])?g.beast[a]=+I[b+1]:(g.beast[a]=[+I[b+1],+I[b+2]],b++)}}g.annotation=void 0,g.children&&g.children.forEach(c)}return c(n.json),n}var sy={nexml:AR,phyloxml:QS,nexus:ZS,nwk:Sg,nhx:Sg,beast:MR};function PR(){let t=this.getTips(),n=mc(t,c=>({name:c.data.name,length:parseFloat(c.data.attribute)}));return n=OS(n,c=>-c.length),n}function DR(e,t){function n(g,b){if(b.mp=[[0,0],[!1,!1]],Sl(b))b.mp[1][0]=b.mp[1][1]=b[g]||!1,b.mp[0][0]=b.mp[1][0]?1:0,b.mp[0][1]=1-b.mp[0][0];else{b.children.forEach(c);var I=b.children.reduce(function(G,W){return W.mp[0][0]+G},0),a=b.children.reduce(function(G,W){return W.mp[0][1]+G},0);b[g]?(b.mp[0][0]=a+1,b.mp[1][0]=!0,b.mp[0][1]=a,b.mp[1][1]=!0):(I<a+1?(b.mp[0][0]=I,b.mp[1][0]=!1):(b.mp[0][0]=a+1,b.mp[1][0]=!0),a<I+1?(b.mp[0][1]=a,b.mp[1][1]=!0):(b.mp[0][1]=I+1,b.mp[1][1]=!1))}}const c=nf(n,t);c(this.nodes),this.nodes.each(g=>{g.parent?g.mp=g.mp[1][g.parent.mp?1:0]:g.mp=g.mp[1][g.mp[0][0]<g.mp[0][1]?0:1]}),this.display.modifySelection((g,b)=>Sl(g.target)?g.target[t]:g.target.mp)}var G_={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */G_.exports;(function(e,t){(function(){var n,c="4.17.21",g=200,b="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",I="Expected a function",a="Invalid `variable` option passed into `_.template`",G="__lodash_hash_undefined__",W=500,he="__lodash_placeholder__",ae=1,ue=2,be=4,Ke=1,ot=2,tt=1,lt=2,ut=4,Tt=8,Pt=16,zt=32,Ge=64,Xt=128,rt=256,yt=512,pt=30,gt="...",bt=800,dt=16,$e=1,mt=2,st=3,Nt=1/0,Rt=9007199254740991,Ot=17976931348623157e292,_i=NaN,Si=4294967295,Ti=Si-1,Oi=Si>>>1,tn=[["ary",Xt],["bind",tt],["bindKey",lt],["curry",Tt],["curryRight",Pt],["flip",yt],["partial",zt],["partialRight",Ge],["rearg",rt]],qi="[object Arguments]",Ni="[object Array]",nn="[object AsyncFunction]",yn="[object Boolean]",Ci="[object Date]",gi="[object DOMException]",Ri="[object Error]",ai="[object Function]",Ki="[object GeneratorFunction]",Ji="[object Map]",fi="[object Number]",pn="[object Null]",ii="[object Object]",wn="[object Promise]",Rr="[object Proxy]",hi="[object RegExp]",en="[object Set]",tr="[object String]",Fn="[object Symbol]",Qn="[object Undefined]",In="[object WeakMap]",v="[object WeakSet]",k="[object ArrayBuffer]",V="[object DataView]",$="[object Float32Array]",te="[object Float64Array]",fe="[object Int8Array]",ve="[object Int16Array]",Ie="[object Int32Array]",Ee="[object Uint8Array]",ze="[object Uint8ClampedArray]",Qe="[object Uint16Array]",He="[object Uint32Array]",Ze=/\b__p \+= '';/g,Ve=/\b(__p \+=) '' \+/g,ft=/(__e\(.*?\)|\b__t\)) \+\n'';/g,nt=/&(?:amp|lt|gt|quot|#39);/g,Me=/[&<>"']/g,se=RegExp(nt.source),ne=RegExp(Me.source),X=/<%-([\s\S]+?)%>/g,ie=/<%([\s\S]+?)%>/g,de=/<%=([\s\S]+?)%>/g,ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fe=/[\\^$.*+?()[\]{}|]/g,Ne=RegExp(Fe.source),Xe=/^\s+/,Ye=/\s/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ue=/\{\n\/\* \[wrapped with (.+)\] \*/,ht=/,? & /,kt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,o=/[()=,{}\[\]\/\s]/,ke=/\\(\\)?/g,oi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,di=/\w*$/,Ai=/^[-+]0x[0-9a-f]+$/i,Jt=/^0b[01]+$/i,li=/^\[object .+?Constructor\]$/,zi=/^0o[0-7]+$/i,vi=/^(?:0|[1-9]\d*)$/,wi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$t=/($^)/,vn=/['\n\r\u2028\u2029\\]/g,or="\\ud800-\\udfff",mn="\\u0300-\\u036f",qn="\\ufe20-\\ufe2f",jr="\\u20d0-\\u20ff",Hi=mn+qn+jr,ur="\\u2700-\\u27bf",On="a-z\\xdf-\\xf6\\xf8-\\xff",Qt="\\xac\\xb1\\xd7\\xf7",Yi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ut="\\u2000-\\u206f",Tn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",cr="A-Z\\xc0-\\xd6\\xd8-\\xde",Ns="\\ufe0e\\ufe0f",Ur=Qt+Yi+Ut+Tn,Vt="['’]",hr="["+or+"]",Lt="["+Ur+"]",Fr="["+Hi+"]",Vs="\\d+",ua="["+ur+"]",Pr="["+On+"]",Fa="[^"+or+Ur+Vs+ur+On+cr+"]",zo="\\ud83c[\\udffb-\\udfff]",Oa="(?:"+Fr+"|"+zo+")",Ys="[^"+or+"]",Zn="(?:\\ud83c[\\udde6-\\uddff]){2}",aa="[\\ud800-\\udbff][\\udc00-\\udfff]",ls="["+cr+"]",Na="\\u200d",al="(?:"+Pr+"|"+Fa+")",ol="(?:"+ls+"|"+Fa+")",to="(?:"+Vt+"(?:d|ll|m|re|s|t|ve))?",Va="(?:"+Vt+"(?:D|LL|M|RE|S|T|VE))?",N=Oa+"?",xe="["+Ns+"]?",it="(?:"+Na+"(?:"+[Ys,Zn,aa].join("|")+")"+xe+N+")*",It="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Wt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ii=xe+N+it,Li="(?:"+[ua,Zn,aa].join("|")+")"+Ii,cn="(?:"+[Ys+Fr+"?",Fr,Zn,aa,hr].join("|")+")",fn=RegExp(Vt,"g"),sr=RegExp(Fr,"g"),Ar=RegExp(zo+"(?="+zo+")|"+cn+Ii,"g"),Or=RegExp([ls+"?"+Pr+"+"+to+"(?="+[Lt,ls,"$"].join("|")+")",ol+"+"+Va+"(?="+[Lt,ls+al,"$"].join("|")+")",ls+"?"+al+"+"+to,ls+"+"+Va,Wt,It,Vs,Li].join("|"),"g"),Ua=RegExp("["+Na+or+Hi+Ns+"]"),Ga=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qa=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pl=-1,Gr={};Gr[$]=Gr[te]=Gr[fe]=Gr[ve]=Gr[Ie]=Gr[Ee]=Gr[ze]=Gr[Qe]=Gr[He]=!0,Gr[qi]=Gr[Ni]=Gr[k]=Gr[yn]=Gr[V]=Gr[Ci]=Gr[Ri]=Gr[ai]=Gr[Ji]=Gr[fi]=Gr[ii]=Gr[hi]=Gr[en]=Gr[tr]=Gr[In]=!1;var nr={};nr[qi]=nr[Ni]=nr[k]=nr[V]=nr[yn]=nr[Ci]=nr[$]=nr[te]=nr[fe]=nr[ve]=nr[Ie]=nr[Ji]=nr[fi]=nr[ii]=nr[hi]=nr[en]=nr[tr]=nr[Fn]=nr[Ee]=nr[ze]=nr[Qe]=nr[He]=!0,nr[Ri]=nr[ai]=nr[In]=!1;var wr={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Dr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},js={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ks=parseFloat,Lr=parseInt,So=typeof Jf=="object"&&Jf&&Jf.Object===Object&&Jf,Zo=typeof self=="object"&&self&&self.Object===Object&&self,Ls=So||Zo||Function("return this")(),Il=t&&!t.nodeType&&t,Ao=Il&&!0&&e&&!e.nodeType&&e,Qo=Ao&&Ao.exports===Il,ca=Qo&&So.process,$s=function(){try{var mi=Ao&&Ao.require&&Ao.require("util").types;return mi||ca&&ca.binding&&ca.binding("util")}catch{}}(),El=$s&&$s.isArrayBuffer,Ha=$s&&$s.isDate,Ta=$s&&$s.isMap,ml=$s&&$s.isRegExp,Cl=$s&&$s.isSet,mu=$s&&$s.isTypedArray;function us(mi,Vi,Di){switch(Di.length){case 0:return mi.call(Vi);case 1:return mi.call(Vi,Di[0]);case 2:return mi.call(Vi,Di[0],Di[1]);case 3:return mi.call(Vi,Di[0],Di[1],Di[2])}return mi.apply(Vi,Di)}function rc(mi,Vi,Di,Ft){for(var ti=-1,xi=mi==null?0:mi.length;++ti<xi;){var Fi=mi[ti];Vi(Ft,Fi,Di(Fi),mi)}return Ft}function io(mi,Vi){for(var Di=-1,Ft=mi==null?0:mi.length;++Di<Ft&&Vi(mi[Di],Di,mi)!==!1;);return mi}function no(mi,Vi){for(var Di=mi==null?0:mi.length;Di--&&Vi(mi[Di],Di,mi)!==!1;);return mi}function ql(mi,Vi){for(var Di=-1,Ft=mi==null?0:mi.length;++Di<Ft;)if(!Vi(mi[Di],Di,mi))return!1;return!0}function Ro(mi,Vi){for(var Di=-1,Ft=mi==null?0:mi.length,ti=0,xi=[];++Di<Ft;){var Fi=mi[Di];Vi(Fi,Di,mi)&&(xi[ti++]=Fi)}return xi}function Wo(mi,Vi){var Di=mi==null?0:mi.length;return!!Di&&Ko(mi,Vi,0)>-1}function Io(mi,Vi,Di){for(var Ft=-1,ti=mi==null?0:mi.length;++Ft<ti;)if(Di(Vi,mi[Ft]))return!0;return!1}function Us(mi,Vi){for(var Di=-1,Ft=mi==null?0:mi.length,ti=Array(Ft);++Di<Ft;)ti[Di]=Vi(mi[Di],Di,mi);return ti}function Xo(mi,Vi){for(var Di=-1,Ft=Vi.length,ti=mi.length;++Di<Ft;)mi[ti+Di]=Vi[Di];return mi}function Yo(mi,Vi,Di,Ft){var ti=-1,xi=mi==null?0:mi.length;for(Ft&&xi&&(Di=mi[++ti]);++ti<xi;)Di=Vi(Di,mi[ti],ti,mi);return Di}function $o(mi,Vi,Di,Ft){var ti=mi==null?0:mi.length;for(Ft&&ti&&(Di=mi[--ti]);ti--;)Di=Vi(Di,mi[ti],ti,mi);return Di}function ba(mi,Vi){for(var Di=-1,Ft=mi==null?0:mi.length;++Di<Ft;)if(Vi(mi[Di],Di,mi))return!0;return!1}var ja=fr("length");function Cs(mi){return mi.split("")}function gu(mi){return mi.match(kt)||[]}function Sr(mi,Vi,Di){var Ft;return Di(mi,function(ti,xi,Fi){if(Vi(ti,xi,Fi))return Ft=xi,!1}),Ft}function Xn(mi,Vi,Di,Ft){for(var ti=mi.length,xi=Di+(Ft?1:-1);Ft?xi--:++xi<ti;)if(Vi(mi[xi],xi,mi))return xi;return-1}function Ko(mi,Vi,Di){return Vi===Vi?Nr(mi,Vi,Di):Xn(mi,Za,Di)}function Br(mi,Vi,Di,Ft){for(var ti=Di-1,xi=mi.length;++ti<xi;)if(Ft(mi[ti],Vi))return ti;return-1}function Za(mi){return mi!==mi}function Jr(mi,Vi){var Di=mi==null?0:mi.length;return Di?es(mi,Vi)/Di:_i}function fr(mi){return function(Vi){return Vi==null?n:Vi[mi]}}function Eo(mi){return function(Vi){return mi==null?n:mi[Vi]}}function Un(mi,Vi,Di,Ft,ti){return ti(mi,function(xi,Fi,Ln){Di=Ft?(Ft=!1,xi):Vi(Di,xi,Fi,Ln)}),Di}function Ol(mi,Vi){var Di=mi.length;for(mi.sort(Vi);Di--;)mi[Di]=mi[Di].value;return mi}function es(mi,Vi){for(var Di,Ft=-1,ti=mi.length;++Ft<ti;){var xi=Vi(mi[Ft]);xi!==n&&(Di=Di===n?xi:Di+xi)}return Di}function Zr(mi,Vi){for(var Di=-1,Ft=Array(mi);++Di<mi;)Ft[Di]=Vi(Di);return Ft}function Ts(mi,Vi){return Us(Vi,function(Di){return[Di,mi[Di]]})}function kr(mi){return mi&&mi.slice(0,Sa(mi)+1).replace(Xe,"")}function rr(mi){return function(Vi){return mi(Vi)}}function ll(mi,Vi){return Us(Vi,function(Di){return mi[Di]})}function Yr(mi,Vi){return mi.has(Vi)}function Co(mi,Vi){for(var Di=-1,Ft=mi.length;++Di<Ft&&Ko(Vi,mi[Di],0)>-1;);return Di}function ul(mi,Vi){for(var Di=mi.length;Di--&&Ko(Vi,mi[Di],0)>-1;);return Di}function Qr(mi,Vi){for(var Di=mi.length,Ft=0;Di--;)mi[Di]===Vi&&++Ft;return Ft}var hs=Eo(wr),wa=Eo(Dr);function Tl(mi){return"\\"+vr[mi]}function To(mi,Vi){return mi==null?n:mi[Vi]}function kl(mi){return Ua.test(mi)}function fo(mi){return Ga.test(mi)}function Js(mi){for(var Vi,Di=[];!(Vi=mi.next()).done;)Di.push(Vi.value);return Di}function Gs(mi){var Vi=-1,Di=Array(mi.size);return mi.forEach(function(Ft,ti){Di[++Vi]=[ti,Ft]}),Di}function Qa(mi,Vi){return function(Di){return mi(Vi(Di))}}function Jo(mi,Vi){for(var Di=-1,Ft=mi.length,ti=0,xi=[];++Di<Ft;){var Fi=mi[Di];(Fi===Vi||Fi===he)&&(mi[Di]=he,xi[ti++]=Di)}return xi}function $r(mi){var Vi=-1,Di=Array(mi.size);return mi.forEach(function(Ft){Di[++Vi]=Ft}),Di}function mr(mi){var Vi=-1,Di=Array(mi.size);return mi.forEach(function(Ft){Di[++Vi]=[Ft,Ft]}),Di}function Nr(mi,Vi,Di){for(var Ft=Di-1,ti=mi.length;++Ft<ti;)if(mi[Ft]===Vi)return Ft;return-1}function ha(mi,Vi,Di){for(var Ft=Di+1;Ft--;)if(mi[Ft]===Vi)return Ft;return Ft}function po(mi){return kl(mi)?Wa(mi):ja(mi)}function ea(mi){return kl(mi)?cl(mi):Cs(mi)}function Sa(mi){for(var Vi=mi.length;Vi--&&Ye.test(mi.charAt(Vi)););return Vi}var ka=Eo(js);function Wa(mi){for(var Vi=Ar.lastIndex=0;Ar.test(mi);)++Vi;return Vi}function cl(mi){return mi.match(Ar)||[]}function lu(mi){return mi.match(Or)||[]}var gl=function mi(Vi){Vi=Vi==null?Ls:ro.defaults(Ls.Object(),Vi,ro.pick(Ls,qa));var Di=Vi.Array,Ft=Vi.Date,ti=Vi.Error,xi=Vi.Function,Fi=Vi.Math,Ln=Vi.Object,Hn=Vi.RegExp,lr=Vi.String,Yn=Vi.TypeError,qs=Di.prototype,ks=xi.prototype,As=Ln.prototype,Xa=Vi["__core-js_shared__"],mo=ks.toString,rs=As.hasOwnProperty,Qu=0,Ru=function(){var P=/[^.]+$/.exec(Xa&&Xa.keys&&Xa.keys.IE_PROTO||"");return P?"Symbol(src)_1."+P:""}(),go=As.toString,Ml=mo.call(Ln),Pn=Ls._,Ma=Hn("^"+mo.call(rs).replace(Fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sn=Qo?Vi.Buffer:n,Fo=Vi.Symbol,Nl=Vi.Uint8Array,En=Sn?Sn.allocUnsafe:n,Hl=Qa(Ln.getPrototypeOf,Ln),Cn=Ln.create,_l=As.propertyIsEnumerable,uu=qs.splice,Fu=Fo?Fo.isConcatSpreadable:n,Vl=Fo?Fo.iterator:n,yl=Fo?Fo.toStringTag:n,ta=function(){try{var P=Jh(Ln,"defineProperty");return P({},"",{}),P}catch{}}(),sc=Vi.clearTimeout!==Ls.clearTimeout&&Vi.clearTimeout,Wu=Ft&&Ft.now!==Ls.Date.now&&Ft.now,jl=Vi.setTimeout!==Ls.setTimeout&&Vi.setTimeout,fs=Fi.ceil,_a=Fi.floor,el=Ln.getOwnPropertySymbols,_u=Sn?Sn.isBuffer:n,Ou=Vi.isFinite,cu=qs.join,Nu=Qa(Ln.keys,Ln),_r=Fi.max,ds=Fi.min,gn=Ft.now,jn=Vi.parseInt,Jn=Fi.random,tl=qs.reverse,Tu=Jh(Vi,"DataView"),oa=Jh(Vi,"Map"),yu=Jh(Vi,"Promise"),vs=Jh(Vi,"Set"),ko=Jh(Vi,"WeakMap"),ki=Jh(Ln,"create"),Bi=ko&&new ko,xs={},vu=th(Tu),Oo=th(oa),cs=th(yu),hl=th(vs),Ms=th(ko),C=Fo?Fo.prototype:n,D=C?C.valueOf:n,z=C?C.toString:n;function R(P){if(Bt(P)&&!f(P)&&!(P instanceof we)){if(P instanceof oe)return P;if(rs.call(P,"__wrapped__"))return cd(P)}return new oe(P)}var ee=function(){function P(){}return function(H){if(!Dt(H))return{};if(Cn)return Cn(H);P.prototype=H;var pe=new P;return P.prototype=n,pe}}();function le(){}function oe(P,H){this.__wrapped__=P,this.__actions__=[],this.__chain__=!!H,this.__index__=0,this.__values__=n}R.templateSettings={escape:X,evaluate:ie,interpolate:de,variable:"",imports:{_:R}},R.prototype=le.prototype,R.prototype.constructor=R,oe.prototype=ee(le.prototype),oe.prototype.constructor=oe;function we(P){this.__wrapped__=P,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Si,this.__views__=[]}function We(){var P=new we(this.__wrapped__);return P.__actions__=xl(this.__actions__),P.__dir__=this.__dir__,P.__filtered__=this.__filtered__,P.__iteratees__=xl(this.__iteratees__),P.__takeCount__=this.__takeCount__,P.__views__=xl(this.__views__),P}function vt(){if(this.__filtered__){var P=new we(this);P.__dir__=-1,P.__filtered__=!0}else P=this.clone(),P.__dir__*=-1;return P}function Ct(){var P=this.__wrapped__.value(),H=this.__dir__,pe=f(P),je=H<0,St=pe?P.length:0,qt=Mm(0,St,this.__views__),ui=qt.start,pi=qt.end,Mi=pi-ui,un=je?pi:ui-1,hn=this.__iteratees__,_n=hn.length,$n=0,xr=ds(Mi,this.__takeCount__);if(!pe||!je&&St==Mi&&xr==Mi)return A0(P,this.__actions__);var Wr=[];e:for(;Mi--&&$n<xr;){un+=H;for(var Hs=-1,Xr=P[un];++Hs<_n;){var sa=hn[Hs],da=sa.iteratee,hh=sa.type,fc=da(Xr);if(hh==mt)Xr=fc;else if(!fc){if(hh==$e)continue e;break e}}Wr[$n++]=Xr}return Wr}we.prototype=ee(le.prototype),we.prototype.constructor=we;function ni(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function Gt(){this.__data__=ki?ki(null):{},this.size=0}function jt(P){var H=this.has(P)&&delete this.__data__[P];return this.size-=H?1:0,H}function Z(P){var H=this.__data__;if(ki){var pe=H[P];return pe===G?n:pe}return rs.call(H,P)?H[P]:n}function A(P){var H=this.__data__;return ki?H[P]!==n:rs.call(H,P)}function E(P,H){var pe=this.__data__;return this.size+=this.has(P)?0:1,pe[P]=ki&&H===n?G:H,this}ni.prototype.clear=Gt,ni.prototype.delete=jt,ni.prototype.get=Z,ni.prototype.has=A,ni.prototype.set=E;function F(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function O(){this.__data__=[],this.size=0}function y(P){var H=this.__data__,pe=ei(H,P);if(pe<0)return!1;var je=H.length-1;return pe==je?H.pop():uu.call(H,pe,1),--this.size,!0}function s(P){var H=this.__data__,pe=ei(H,P);return pe<0?n:H[pe][1]}function i(P){return ei(this.__data__,P)>-1}function r(P,H){var pe=this.__data__,je=ei(pe,P);return je<0?(++this.size,pe.push([P,H])):pe[je][1]=H,this}F.prototype.clear=O,F.prototype.delete=y,F.prototype.get=s,F.prototype.has=i,F.prototype.set=r;function l(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function d(){this.size=0,this.__data__={hash:new ni,map:new(oa||F),string:new ni}}function _(P){var H=wf(this,P).delete(P);return this.size-=H?1:0,H}function w(P){return wf(this,P).get(P)}function T(P){return wf(this,P).has(P)}function B(P,H){var pe=wf(this,P),je=pe.size;return pe.set(P,H),this.size+=pe.size==je?0:1,this}l.prototype.clear=d,l.prototype.delete=_,l.prototype.get=w,l.prototype.has=T,l.prototype.set=B;function j(P){var H=-1,pe=P==null?0:P.length;for(this.__data__=new l;++H<pe;)this.add(P[H])}function Y(P){return this.__data__.set(P,G),this}function ce(P){return this.__data__.has(P)}j.prototype.add=j.prototype.push=Y,j.prototype.has=ce;function Se(P){var H=this.__data__=new F(P);this.size=H.size}function Te(){this.__data__=new F,this.size=0}function Re(P){var H=this.__data__,pe=H.delete(P);return this.size=H.size,pe}function Be(P){return this.__data__.get(P)}function Je(P){return this.__data__.has(P)}function xt(P,H){var pe=this.__data__;if(pe instanceof F){var je=pe.__data__;if(!oa||je.length<g-1)return je.push([P,H]),this.size=++pe.size,this;pe=this.__data__=new l(je)}return pe.set(P,H),this.size=pe.size,this}Se.prototype.clear=Te,Se.prototype.delete=Re,Se.prototype.get=Be,Se.prototype.has=Je,Se.prototype.set=xt;function at(P,H){var pe=f(P),je=!pe&&Oe(P),St=!pe&&!je&&U(P),qt=!pe&&!je&&!St&&Rn(P),ui=pe||je||St||qt,pi=ui?Zr(P.length,lr):[],Mi=pi.length;for(var un in P)(H||rs.call(P,un))&&!(ui&&(un=="length"||St&&(un=="offset"||un=="parent")||qt&&(un=="buffer"||un=="byteLength"||un=="byteOffset")||kc(un,Mi)))&&pi.push(un);return pi}function ct(P){var H=P.length;return H?P[mA(0,H-1)]:n}function Et(P,H){return If(xl(P),Gi(H,0,P.length))}function wt(P){return If(xl(P))}function ri(P,H,pe){(pe!==n&&!J(P[H],pe)||pe===n&&!(H in P))&&Ei(P,H,pe)}function Yt(P,H,pe){var je=P[H];(!(rs.call(P,H)&&J(je,pe))||pe===n&&!(H in P))&&Ei(P,H,pe)}function ei(P,H){for(var pe=P.length;pe--;)if(J(P[pe][0],H))return pe;return-1}function si(P,H,pe,je){return er(P,function(St,qt,ui){H(je,St,pe(St),ui)}),je}function ji(P,H){return P&&oc(H,lo(H),P)}function Qi(P,H){return P&&oc(H,xo(H),P)}function Ei(P,H,pe){H=="__proto__"&&ta?ta(P,H,{configurable:!0,enumerable:!0,value:pe,writable:!0}):P[H]=pe}function Ui(P,H){for(var pe=-1,je=H.length,St=Di(je),qt=P==null;++pe<je;)St[pe]=qt?n:Xl(P,H[pe]);return St}function Gi(P,H,pe){return P===P&&(pe!==n&&(P=P<=pe?P:pe),H!==n&&(P=P>=H?P:H)),P}function ln(P,H,pe,je,St,qt){var ui,pi=H&ae,Mi=H&ue,un=H&be;if(pe&&(ui=St?pe(P,je,St,qt):pe(P)),ui!==n)return ui;if(!Dt(P))return P;var hn=f(P);if(hn){if(ui=Dm(P),!pi)return xl(P,ui)}else{var _n=Ul(P),$n=_n==ai||_n==Ki;if(U(P))return W0(P,pi);if(_n==ii||_n==qi||$n&&!St){if(ui=Mi||$n?{}:td(P),!pi)return Mi?gf(P,Qi(ui,P)):Qh(P,ji(ui,P))}else{if(!nr[_n])return St?P:{};ui=eA(P,_n,pi)}}qt||(qt=new Se);var xr=qt.get(P);if(xr)return xr;qt.set(P,ui),sn(P)?P.forEach(function(Xr){ui.add(ln(Xr,H,pe,Xr,P,qt))}):Kt(P)&&P.forEach(function(Xr,sa){ui.set(sa,ln(Xr,H,pe,sa,P,qt))});var Wr=un?Mi?bf:Eh:Mi?xo:lo,Hs=hn?n:Wr(P);return io(Hs||P,function(Xr,sa){Hs&&(sa=Xr,Xr=P[sa]),Yt(ui,sa,ln(Xr,H,pe,sa,P,qt))}),ui}function Bn(P){var H=lo(P);return function(pe){return rn(pe,P,H)}}function rn(P,H,pe){var je=pe.length;if(P==null)return!je;for(P=Ln(P);je--;){var St=pe[je],qt=H[St],ui=P[St];if(ui===n&&!(St in P)||!qt(ui))return!1}return!0}function kn(P,H,pe){if(typeof P!="function")throw new Yn(I);return MA(function(){P.apply(n,pe)},H)}function yr(P,H,pe,je){var St=-1,qt=Wo,ui=!0,pi=P.length,Mi=[],un=H.length;if(!pi)return Mi;pe&&(H=Us(H,rr(pe))),je?(qt=Io,ui=!1):H.length>=g&&(qt=Yr,ui=!1,H=new j(H));e:for(;++St<pi;){var hn=P[St],_n=pe==null?hn:pe(hn);if(hn=je||hn!==0?hn:0,ui&&_n===_n){for(var $n=un;$n--;)if(H[$n]===_n)continue e;Mi.push(hn)}else qt(H,_n,je)||Mi.push(hn)}return Mi}var er=f0(yo),Ia=f0(Zs,!0);function Aa(P,H){var pe=!0;return er(P,function(je,St,qt){return pe=!!H(je,St,qt),pe}),pe}function Bs(P,H,pe){for(var je=-1,St=P.length;++je<St;){var qt=P[je],ui=H(qt);if(ui!=null&&(pi===n?ui===ui&&!Dn(ui):pe(ui,pi)))var pi=ui,Mi=qt}return Mi}function so(P,H,pe,je){var St=P.length;for(pe=Wn(pe),pe<0&&(pe=-pe>St?0:St+pe),je=je===n||je>St?St:Wn(je),je<0&&(je+=St),je=pe>je?0:ws(je);pe<je;)P[pe++]=H;return P}function ao(P,H){var pe=[];return er(P,function(je,St,qt){H(je,St,qt)&&pe.push(je)}),pe}function qr(P,H,pe,je,St){var qt=-1,ui=P.length;for(pe||(pe=Ep),St||(St=[]);++qt<ui;){var pi=P[qt];H>0&&pe(pi)?H>1?qr(pi,H-1,pe,je,St):Xo(St,pi):je||(St[St.length]=pi)}return St}var ya=_f(),_o=_f(!0);function yo(P,H){return P&&ya(P,H,lo)}function Zs(P,H){return P&&_o(P,H,lo)}function ts(P,H){return Ro(H,function(pe){return At(P[pe])})}function is(P,H){H=bh(H,P);for(var pe=0,je=H.length;P!=null&&pe<je;)P=P[ms(H[pe++])];return pe&&pe==je?P:n}function zr(P,H,pe){var je=H(P);return f(P)?je:Xo(je,pe(P))}function bs(P){return P==null?P===n?Qn:pn:yl&&yl in Ln(P)?Sf(P):sd(P)}function Qs(P,H){return P>H}function Mo(P,H){return P!=null&&rs.call(P,H)}function No(P,H){return P!=null&&H in Ln(P)}function Vo(P,H,pe){return P>=ds(H,pe)&&P<_r(H,pe)}function Sc(P,H,pe){for(var je=pe?Io:Wo,St=P[0].length,qt=P.length,ui=qt,pi=Di(qt),Mi=1/0,un=[];ui--;){var hn=P[ui];ui&&H&&(hn=Us(hn,rr(H))),Mi=ds(hn.length,Mi),pi[ui]=!pe&&(H||St>=120&&hn.length>=120)?new j(ui&&hn):n}hn=P[0];var _n=-1,$n=pi[0];e:for(;++_n<St&&un.length<Mi;){var xr=hn[_n],Wr=H?H(xr):xr;if(xr=pe||xr!==0?xr:0,!($n?Yr($n,Wr):je(un,Wr,pe))){for(ui=qt;--ui;){var Hs=pi[ui];if(!(Hs?Yr(Hs,Wr):je(P[ui],Wr,pe)))continue e}$n&&$n.push(Wr),un.push(xr)}}return un}function Ws(P,H,pe,je){return yo(P,function(St,qt,ui){H(je,pe(St),qt,ui)}),je}function Zl(P,H,pe){H=bh(H,P),P=od(P,H);var je=P==null?P:P[ms(ku(H))];return je==null?n:us(je,P,pe)}function hu(P){return Bt(P)&&bs(P)==qi}function il(P){return Bt(P)&&bs(P)==k}function vl(P){return Bt(P)&&bs(P)==Ci}function Pl(P,H,pe,je,St){return P===H?!0:P==null||H==null||!Bt(P)&&!Bt(H)?P!==P&&H!==H:Au(P,H,pe,je,Pl,St)}function Au(P,H,pe,je,St,qt){var ui=f(P),pi=f(H),Mi=ui?Ni:Ul(P),un=pi?Ni:Ul(H);Mi=Mi==qi?ii:Mi,un=un==qi?ii:un;var hn=Mi==ii,_n=un==ii,$n=Mi==un;if($n&&U(P)){if(!U(H))return!1;ui=!0,hn=!1}if($n&&!hn)return qt||(qt=new Se),ui||Rn(P)?K0(P,H,pe,je,St,qt):Ih(P,H,Mi,pe,je,St,qt);if(!(pe&Ke)){var xr=hn&&rs.call(P,"__wrapped__"),Wr=_n&&rs.call(H,"__wrapped__");if(xr||Wr){var Hs=xr?P.value():P,Xr=Wr?H.value():H;return qt||(qt=new Se),St(Hs,Xr,pe,je,qt)}}return $n?(qt||(qt=new Se),km(P,H,pe,je,St,qt)):!1}function af(P){return Bt(P)&&Ul(P)==Ji}function Vh(P,H,pe,je){var St=pe.length,qt=St,ui=!je;if(P==null)return!qt;for(P=Ln(P);St--;){var pi=pe[St];if(ui&&pi[2]?pi[1]!==P[pi[0]]:!(pi[0]in P))return!1}for(;++St<qt;){pi=pe[St];var Mi=pi[0],un=P[Mi],hn=pi[1];if(ui&&pi[2]){if(un===n&&!(Mi in P))return!1}else{var _n=new Se;if(je)var $n=je(un,hn,Mi,P,H,_n);if(!($n===n?Pl(hn,un,Ke|ot,je,_n):$n))return!1}}return!0}function Pa(P){if(!Dt(P)||Cp(P))return!1;var H=At(P)?Ma:li;return H.test(th(P))}function pA(P){return Bt(P)&&bs(P)==hi}function yh(P){return Bt(P)&&Ul(P)==en}function Uh(P){return Bt(P)&&Mt(P.length)&&!!Gr[bs(P)]}function Ic(P){return typeof P=="function"?P:P==null?Fc:typeof P=="object"?f(P)?of(P[0],P[1]):qh(P):F2(P)}function Gh(P){if(!TA(P))return Nu(P);var H=[];for(var pe in Ln(P))rs.call(P,pe)&&pe!="constructor"&&H.push(pe);return H}function l0(P){if(!Dt(P))return Al(P);var H=TA(P),pe=[];for(var je in P)je=="constructor"&&(H||!rs.call(P,je))||pe.push(je);return pe}function Xc(P,H){return P<H}function _p(P,H){var pe=-1,je=p(P)?Di(P.length):[];return er(P,function(St,qt,ui){je[++pe]=H(St,qt,ui)}),je}function qh(P){var H=J0(P);return H.length==1&&H[0][2]?rd(H[0][0],H[0][1]):function(pe){return pe===P||Vh(pe,P,H)}}function of(P,H){return CA(P)&&m0(H)?rd(ms(P),H):function(pe){var je=Xl(pe,P);return je===n&&je===H?sA(pe,P):Pl(H,je,Ke|ot)}}function Yc(P,H,pe,je,St){P!==H&&ya(H,function(qt,ui){if(St||(St=new Se),Dt(qt))yp(P,H,ui,pe,Yc,je,St);else{var pi=je?je(kA(P,ui),qt,ui+"",P,H,St):n;pi===n&&(pi=qt),ri(P,ui,pi)}},xo)}function yp(P,H,pe,je,St,qt,ui){var pi=kA(P,pe),Mi=kA(H,pe),un=ui.get(Mi);if(un){ri(P,pe,un);return}var hn=qt?qt(pi,Mi,pe+"",P,H,ui):n,_n=hn===n;if(_n){var $n=f(Mi),xr=!$n&&U(Mi),Wr=!$n&&!xr&&Rn(Mi);hn=Mi,$n||xr||Wr?f(pi)?hn=pi:S(pi)?hn=xl(pi):xr?(_n=!1,hn=W0(Mi,!0)):Wr?(_n=!1,hn=Po(Mi,!0)):hn=[]:an(Mi)||Oe(Mi)?(hn=pi,Oe(pi)?hn=na(pi):(!Dt(pi)||At(pi))&&(hn=td(Mi))):_n=!1}_n&&(ui.set(Mi,hn),St(hn,Mi,je,qt,ui),ui.delete(Mi)),ri(P,pe,hn)}function lf(P,H){var pe=P.length;if(pe)return H+=H<0?pe:0,kc(H,pe)?P[H]:n}function q0(P,H,pe){H.length?H=Us(H,function(qt){return f(qt)?function(ui){return is(ui,qt.length===1?qt[0]:qt)}:qt}):H=[Fc];var je=-1;H=Us(H,rr(Ir()));var St=_p(P,function(qt,ui,pi){var Mi=Us(H,function(un){return un(qt)});return{criteria:Mi,index:++je,value:qt}});return Ol(St,function(qt,ui){return xp(qt,ui,pe)})}function Ql(P,H){return Xu(P,H,function(pe,je){return sA(P,je)})}function Xu(P,H,pe){for(var je=-1,St=H.length,qt={};++je<St;){var ui=H[je],pi=is(P,ui);pe(pi,ui)&&jh(qt,bh(ui,P),pi)}return qt}function H0(P){return function(H){return is(H,P)}}function vh(P,H,pe,je){var St=je?Br:Ko,qt=-1,ui=H.length,pi=P;for(P===H&&(H=xl(H)),pe&&(pi=Us(P,rr(pe)));++qt<ui;)for(var Mi=0,un=H[qt],hn=pe?pe(un):un;(Mi=St(pi,hn,Mi,je))>-1;)pi!==P&&uu.call(pi,Mi,1),uu.call(P,Mi,1);return P}function $c(P,H){for(var pe=P?H.length:0,je=pe-1;pe--;){var St=H[pe];if(pe==je||St!==qt){var qt=St;kc(St)?uu.call(P,St,1):hf(P,St)}}return P}function mA(P,H){return P+_a(Jn()*(H-P+1))}function uf(P,H,pe,je){for(var St=-1,qt=_r(fs((H-P)/(pe||1)),0),ui=Di(qt);qt--;)ui[je?qt:++St]=P,P+=pe;return ui}function u0(P,H){var pe="";if(!P||H<1||H>Rt)return pe;do H%2&&(pe+=P),H=_a(H/2),H&&(P+=P);while(H);return pe}function ps(P,H){return wu(ad(P,H,Fc),P+"")}function Wl(P){return ct(Rc(P))}function Hh(P,H){var pe=Rc(P);return If(pe,Gi(H,0,pe.length))}function jh(P,H,pe,je){if(!Dt(P))return P;H=bh(H,P);for(var St=-1,qt=H.length,ui=qt-1,pi=P;pi!=null&&++St<qt;){var Mi=ms(H[St]),un=pe;if(Mi==="__proto__"||Mi==="constructor"||Mi==="prototype")return P;if(St!=ui){var hn=pi[Mi];un=je?je(hn,Mi,pi):n,un===n&&(un=Dt(hn)?hn:kc(H[St+1])?[]:{})}Yt(pi,Mi,un),pi=pi[Mi]}return P}var cf=Bi?function(P,H){return Bi.set(P,H),P}:Fc,gA=ta?function(P,H){return ta(P,"toString",{configurable:!0,enumerable:!1,value:S1(H),writable:!0})}:Fc;function j0(P){return If(Rc(P))}function Dl(P,H,pe){var je=-1,St=P.length;H<0&&(H=-H>St?0:St+H),pe=pe>St?St:pe,pe<0&&(pe+=St),St=H>pe?0:pe-H>>>0,H>>>=0;for(var qt=Di(St);++je<St;)qt[je]=P[je+H];return qt}function Vu(P,H){var pe;return er(P,function(je,St,qt){return pe=H(je,St,qt),!pe}),!!pe}function _A(P,H,pe){var je=0,St=P==null?je:P.length;if(typeof H=="number"&&H===H&&St<=Oi){for(;je<St;){var qt=je+St>>>1,ui=P[qt];ui!==null&&!Dn(ui)&&(pe?ui<=H:ui<H)?je=qt+1:St=qt}return St}return c0(P,H,Fc,pe)}function c0(P,H,pe,je){var St=0,qt=P==null?0:P.length;if(qt===0)return 0;H=pe(H);for(var ui=H!==H,pi=H===null,Mi=Dn(H),un=H===n;St<qt;){var hn=_a((St+qt)/2),_n=pe(P[hn]),$n=_n!==n,xr=_n===null,Wr=_n===_n,Hs=Dn(_n);if(ui)var Xr=je||Wr;else un?Xr=Wr&&(je||$n):pi?Xr=Wr&&$n&&(je||!xr):Mi?Xr=Wr&&$n&&!xr&&(je||!Hs):xr||Hs?Xr=!1:Xr=je?_n<=H:_n<H;Xr?St=hn+1:qt=hn}return ds(qt,Ti)}function h0(P,H){for(var pe=-1,je=P.length,St=0,qt=[];++pe<je;){var ui=P[pe],pi=H?H(ui):ui;if(!pe||!J(pi,Mi)){var Mi=pi;qt[St++]=ui===0?0:ui}}return qt}function vp(P){return typeof P=="number"?P:Dn(P)?_i:+P}function xu(P){if(typeof P=="string")return P;if(f(P))return Us(P,xu)+"";if(Dn(P))return z?z.call(P):"";var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function Kc(P,H,pe){var je=-1,St=Wo,qt=P.length,ui=!0,pi=[],Mi=pi;if(pe)ui=!1,St=Io;else if(qt>=g){var un=H?null:$0(P);if(un)return $r(un);ui=!1,St=Yr,Mi=new j}else Mi=H?[]:pi;e:for(;++je<qt;){var hn=P[je],_n=H?H(hn):hn;if(hn=pe||hn!==0?hn:0,ui&&_n===_n){for(var $n=Mi.length;$n--;)if(Mi[$n]===_n)continue e;H&&Mi.push(_n),pi.push(hn)}else St(Mi,_n,pe)||(Mi!==pi&&Mi.push(_n),pi.push(hn))}return pi}function hf(P,H){return H=bh(H,P),P=od(P,H),P==null||delete P[ms(ku(H))]}function xh(P,H,pe,je){return jh(P,H,pe(is(P,H)),je)}function Ll(P,H,pe,je){for(var St=P.length,qt=je?St:-1;(je?qt--:++qt<St)&&H(P[qt],qt,P););return pe?Dl(P,je?0:qt,je?qt+1:St):Dl(P,je?qt+1:0,je?St:qt)}function A0(P,H){var pe=P;return pe instanceof we&&(pe=pe.value()),Yo(H,function(je,St){return St.func.apply(St.thisArg,Xo([je],St.args))},pe)}function Jc(P,H,pe){var je=P.length;if(je<2)return je?Kc(P[0]):[];for(var St=-1,qt=Di(je);++St<je;)for(var ui=P[St],pi=-1;++pi<je;)pi!=St&&(qt[St]=yr(qt[St]||ui,P[pi],H,pe));return Kc(qr(qt,1),H,pe)}function Zh(P,H,pe){for(var je=-1,St=P.length,qt=H.length,ui={};++je<St;){var pi=je<qt?H[je]:n;pe(ui,P[je],pi)}return ui}function Z0(P){return S(P)?P:[]}function Q0(P){return typeof P=="function"?P:Fc}function bh(P,H){return f(P)?P:CA(P,H)?[P]:ud(Kn(P))}var Cm=ps;function Ec(P,H,pe){var je=P.length;return pe=pe===n?je:pe,!H&&pe>=je?P:Dl(P,H,pe)}var Af=sc||function(P){return Ls.clearTimeout(P)};function W0(P,H){if(H)return P.slice();var pe=P.length,je=En?En(pe):new P.constructor(pe);return P.copy(je),je}function ac(P){var H=new P.constructor(P.byteLength);return new Nl(H).set(new Nl(P)),H}function ff(P,H){var pe=H?ac(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.byteLength)}function yA(P){var H=new P.constructor(P.source,di.exec(P));return H.lastIndex=P.lastIndex,H}function Tm(P){return D?Ln(D.call(P)):{}}function Po(P,H){var pe=H?ac(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.length)}function df(P,H){if(P!==H){var pe=P!==n,je=P===null,St=P===P,qt=Dn(P),ui=H!==n,pi=H===null,Mi=H===H,un=Dn(H);if(!pi&&!un&&!qt&&P>H||qt&&ui&&Mi&&!pi&&!un||je&&ui&&Mi||!pe&&Mi||!St)return 1;if(!je&&!qt&&!un&&P<H||un&&pe&&St&&!je&&!qt||pi&&pe&&St||!ui&&St||!Mi)return-1}return 0}function xp(P,H,pe){for(var je=-1,St=P.criteria,qt=H.criteria,ui=St.length,pi=pe.length;++je<ui;){var Mi=df(St[je],qt[je]);if(Mi){if(je>=pi)return Mi;var un=pe[je];return Mi*(un=="desc"?-1:1)}}return P.index-H.index}function pf(P,H,pe,je){for(var St=-1,qt=P.length,ui=pe.length,pi=-1,Mi=H.length,un=_r(qt-ui,0),hn=Di(Mi+un),_n=!je;++pi<Mi;)hn[pi]=H[pi];for(;++St<ui;)(_n||St<qt)&&(hn[pe[St]]=P[St]);for(;un--;)hn[pi++]=P[St++];return hn}function mf(P,H,pe,je){for(var St=-1,qt=P.length,ui=-1,pi=pe.length,Mi=-1,un=H.length,hn=_r(qt-pi,0),_n=Di(hn+un),$n=!je;++St<hn;)_n[St]=P[St];for(var xr=St;++Mi<un;)_n[xr+Mi]=H[Mi];for(;++ui<pi;)($n||St<qt)&&(_n[xr+pe[ui]]=P[St++]);return _n}function xl(P,H){var pe=-1,je=P.length;for(H||(H=Di(je));++pe<je;)H[pe]=P[pe];return H}function oc(P,H,pe,je){var St=!pe;pe||(pe={});for(var qt=-1,ui=H.length;++qt<ui;){var pi=H[qt],Mi=je?je(pe[pi],P[pi],pi,pe,P):n;Mi===n&&(Mi=P[pi]),St?Ei(pe,pi,Mi):Yt(pe,pi,Mi)}return pe}function Qh(P,H){return oc(P,IA(P),H)}function gf(P,H){return oc(P,EA(P),H)}function Da(P,H){return function(pe,je){var St=f(pe)?rc:si,qt=H?H():{};return St(pe,P,Ir(je,2),qt)}}function lc(P){return ps(function(H,pe){var je=-1,St=pe.length,qt=St>1?pe[St-1]:n,ui=St>2?pe[2]:n;for(qt=P.length>3&&typeof qt=="function"?(St--,qt):n,ui&&bu(pe[0],pe[1],ui)&&(qt=St<3?n:qt,St=1),H=Ln(H);++je<St;){var pi=pe[je];pi&&P(H,pi,je,qt)}return H})}function f0(P,H){return function(pe,je){if(pe==null)return pe;if(!p(pe))return P(pe,je);for(var St=pe.length,qt=H?St:-1,ui=Ln(pe);(H?qt--:++qt<St)&&je(ui[qt],qt,ui)!==!1;);return pe}}function _f(P){return function(H,pe,je){for(var St=-1,qt=Ln(H),ui=je(H),pi=ui.length;pi--;){var Mi=ui[P?pi:++St];if(pe(qt[Mi],Mi,qt)===!1)break}return H}}function yf(P,H,pe){var je=H&tt,St=wh(P);function qt(){var ui=this&&this!==Ls&&this instanceof qt?St:P;return ui.apply(je?pe:this,arguments)}return qt}function Cc(P){return function(H){H=Kn(H);var pe=kl(H)?ea(H):n,je=pe?pe[0]:H.charAt(0),St=pe?Ec(pe,1).join(""):H.slice(1);return je[P]()+St}}function Wh(P){return function(H){return Yo(z2(B2(H).replace(fn,"")),P,"")}}function wh(P){return function(){var H=arguments;switch(H.length){case 0:return new P;case 1:return new P(H[0]);case 2:return new P(H[0],H[1]);case 3:return new P(H[0],H[1],H[2]);case 4:return new P(H[0],H[1],H[2],H[3]);case 5:return new P(H[0],H[1],H[2],H[3],H[4]);case 6:return new P(H[0],H[1],H[2],H[3],H[4],H[5]);case 7:return new P(H[0],H[1],H[2],H[3],H[4],H[5],H[6])}var pe=ee(P.prototype),je=P.apply(pe,H);return Dt(je)?je:pe}}function vf(P,H,pe){var je=wh(P);function St(){for(var qt=arguments.length,ui=Di(qt),pi=qt,Mi=Kh(St);pi--;)ui[pi]=arguments[pi];var un=qt<3&&ui[0]!==Mi&&ui[qt-1]!==Mi?[]:Jo(ui,Mi);if(qt-=un.length,qt<pe)return uc(P,H,Xh,St.placeholder,n,ui,un,n,n,pe-qt);var hn=this&&this!==Ls&&this instanceof St?je:P;return us(hn,this,ui)}return St}function vA(P){return function(H,pe,je){var St=Ln(H);if(!p(H)){var qt=Ir(pe,3);H=lo(H),pe=function(pi){return qt(St[pi],pi,St)}}var ui=P(H,pe,je);return ui>-1?St[qt?H[ui]:ui]:n}}function xA(P){return Tc(function(H){var pe=H.length,je=pe,St=oe.prototype.thru;for(P&&H.reverse();je--;){var qt=H[je];if(typeof qt!="function")throw new Yn(I);if(St&&!ui&&SA(qt)=="wrapper")var ui=new oe([],!0)}for(je=ui?je:pe;++je<pe;){qt=H[je];var pi=SA(qt),Mi=pi=="wrapper"?$h(qt):n;Mi&&p0(Mi[0])&&Mi[1]==(Xt|Tt|zt|rt)&&!Mi[4].length&&Mi[9]==1?ui=ui[SA(Mi[0])].apply(ui,Mi[3]):ui=qt.length==1&&p0(qt)?ui[pi]():ui.thru(qt)}return function(){var un=arguments,hn=un[0];if(ui&&un.length==1&&f(hn))return ui.plant(hn).value();for(var _n=0,$n=pe?H[_n].apply(this,un):hn;++_n<pe;)$n=H[_n].call(this,$n);return $n}})}function Xh(P,H,pe,je,St,qt,ui,pi,Mi,un){var hn=H&Xt,_n=H&tt,$n=H&lt,xr=H&(Tt|Pt),Wr=H&yt,Hs=$n?n:wh(P);function Xr(){for(var sa=arguments.length,da=Di(sa),hh=sa;hh--;)da[hh]=arguments[hh];if(xr)var fc=Kh(Xr),Ah=Qr(da,fc);if(je&&(da=pf(da,je,St,xr)),qt&&(da=mf(da,qt,ui,xr)),sa-=Ah,xr&&sa<un){var Kl=Jo(da,fc);return uc(P,H,Xh,Xr.placeholder,pe,da,Kl,pi,Mi,un-sa)}var aA=_n?pe:this,Hf=$n?aA[P]:P;return sa=da.length,pi?da=fa(da,pi):Wr&&sa>1&&da.reverse(),hn&&Mi<sa&&(da.length=Mi),this&&this!==Ls&&this instanceof Xr&&(Hf=Hs||wh(Hf)),Hf.apply(aA,da)}return Xr}function X0(P,H){return function(pe,je){return Ws(pe,P,H(je),{})}}function bA(P,H){return function(pe,je){var St;if(pe===n&&je===n)return H;if(pe!==n&&(St=pe),je!==n){if(St===n)return je;typeof pe=="string"||typeof je=="string"?(pe=xu(pe),je=xu(je)):(pe=vp(pe),je=vp(je)),St=P(pe,je)}return St}}function Yh(P){return Tc(function(H){return H=Us(H,rr(Ir())),ps(function(pe){var je=this;return P(H,function(St){return us(St,je,pe)})})})}function d0(P,H){H=H===n?" ":xu(H);var pe=H.length;if(pe<2)return pe?u0(H,P):H;var je=u0(H,fs(P/po(H)));return kl(H)?Ec(ea(je),0,P).join(""):je.slice(0,P)}function Y0(P,H,pe,je){var St=H&tt,qt=wh(P);function ui(){for(var pi=-1,Mi=arguments.length,un=-1,hn=je.length,_n=Di(hn+Mi),$n=this&&this!==Ls&&this instanceof ui?qt:P;++un<hn;)_n[un]=je[un];for(;Mi--;)_n[un++]=arguments[++pi];return us($n,St?pe:this,_n)}return ui}function bp(P){return function(H,pe,je){return je&&typeof je!="number"&&bu(H,pe,je)&&(pe=je=n),H=ns(H),pe===n?(pe=H,H=0):pe=ns(pe),je=je===n?H<pe?1:-1:ns(je),uf(H,pe,je,P)}}function wA(P){return function(H,pe){return typeof H=="string"&&typeof pe=="string"||(H=ir(H),pe=ir(pe)),P(H,pe)}}function uc(P,H,pe,je,St,qt,ui,pi,Mi,un){var hn=H&Tt,_n=hn?ui:n,$n=hn?n:ui,xr=hn?qt:n,Wr=hn?n:qt;H|=hn?zt:Ge,H&=~(hn?Ge:zt),H&ut||(H&=~(tt|lt));var Hs=[P,H,St,xr,_n,Wr,$n,pi,Mi,un],Xr=pe.apply(n,Hs);return p0(P)&&ld(Xr,Hs),Xr.placeholder=je,Ya(Xr,P,H)}function xf(P){var H=Fi[P];return function(pe,je){if(pe=ir(pe),je=je==null?0:ds(Wn(je),292),je&&Ou(pe)){var St=(Kn(pe)+"e").split("e"),qt=H(St[0]+"e"+(+St[1]+je));return St=(Kn(qt)+"e").split("e"),+(St[0]+"e"+(+St[1]-je))}return H(pe)}}var $0=vs&&1/$r(new vs([,-0]))[1]==Nt?function(P){return new vs(P)}:C1;function Sh(P){return function(H){var pe=Ul(H);return pe==Ji?Gs(H):pe==en?mr(H):Ts(H,P(H))}}function eh(P,H,pe,je,St,qt,ui,pi){var Mi=H&lt;if(!Mi&&typeof P!="function")throw new Yn(I);var un=je?je.length:0;if(un||(H&=~(zt|Ge),je=St=n),ui=ui===n?ui:_r(Wn(ui),0),pi=pi===n?pi:Wn(pi),un-=St?St.length:0,H&Ge){var hn=je,_n=St;je=St=n}var $n=Mi?n:$h(P),xr=[P,H,pe,je,St,hn,_n,qt,ui,pi];if($n&&Ch(xr,$n),P=xr[0],H=xr[1],pe=xr[2],je=xr[3],St=xr[4],pi=xr[9]=xr[9]===n?Mi?0:P.length:_r(xr[9]-un,0),!pi&&H&(Tt|Pt)&&(H&=~(Tt|Pt)),!H||H==tt)var Wr=yf(P,H,pe);else H==Tt||H==Pt?Wr=vf(P,H,pi):(H==zt||H==(tt|zt))&&!St.length?Wr=Y0(P,H,pe,je):Wr=Xh.apply(n,xr);var Hs=$n?cf:ld;return Ya(Hs(Wr,xr),P,H)}function wp(P,H,pe,je){return P===n||J(P,As[pe])&&!rs.call(je,pe)?H:P}function Sp(P,H,pe,je,St,qt){return Dt(P)&&Dt(H)&&(qt.set(H,P),Yc(P,H,n,Sp,qt),qt.delete(H)),P}function Ip(P){return an(P)?n:P}function K0(P,H,pe,je,St,qt){var ui=pe&Ke,pi=P.length,Mi=H.length;if(pi!=Mi&&!(ui&&Mi>pi))return!1;var un=qt.get(P),hn=qt.get(H);if(un&&hn)return un==H&&hn==P;var _n=-1,$n=!0,xr=pe&ot?new j:n;for(qt.set(P,H),qt.set(H,P);++_n<pi;){var Wr=P[_n],Hs=H[_n];if(je)var Xr=ui?je(Hs,Wr,_n,H,P,qt):je(Wr,Hs,_n,P,H,qt);if(Xr!==n){if(Xr)continue;$n=!1;break}if(xr){if(!ba(H,function(sa,da){if(!Yr(xr,da)&&(Wr===sa||St(Wr,sa,pe,je,qt)))return xr.push(da)})){$n=!1;break}}else if(!(Wr===Hs||St(Wr,Hs,pe,je,qt))){$n=!1;break}}return qt.delete(P),qt.delete(H),$n}function Ih(P,H,pe,je,St,qt,ui){switch(pe){case V:if(P.byteLength!=H.byteLength||P.byteOffset!=H.byteOffset)return!1;P=P.buffer,H=H.buffer;case k:return!(P.byteLength!=H.byteLength||!qt(new Nl(P),new Nl(H)));case yn:case Ci:case fi:return J(+P,+H);case Ri:return P.name==H.name&&P.message==H.message;case hi:case tr:return P==H+"";case Ji:var pi=Gs;case en:var Mi=je&Ke;if(pi||(pi=$r),P.size!=H.size&&!Mi)return!1;var un=ui.get(P);if(un)return un==H;je|=ot,ui.set(P,H);var hn=K0(pi(P),pi(H),je,St,qt,ui);return ui.delete(P),hn;case Fn:if(D)return D.call(P)==D.call(H)}return!1}function km(P,H,pe,je,St,qt){var ui=pe&Ke,pi=Eh(P),Mi=pi.length,un=Eh(H),hn=un.length;if(Mi!=hn&&!ui)return!1;for(var _n=Mi;_n--;){var $n=pi[_n];if(!(ui?$n in H:rs.call(H,$n)))return!1}var xr=qt.get(P),Wr=qt.get(H);if(xr&&Wr)return xr==H&&Wr==P;var Hs=!0;qt.set(P,H),qt.set(H,P);for(var Xr=ui;++_n<Mi;){$n=pi[_n];var sa=P[$n],da=H[$n];if(je)var hh=ui?je(da,sa,$n,H,P,qt):je(sa,da,$n,P,H,qt);if(!(hh===n?sa===da||St(sa,da,pe,je,qt):hh)){Hs=!1;break}Xr||(Xr=$n=="constructor")}if(Hs&&!Xr){var fc=P.constructor,Ah=H.constructor;fc!=Ah&&"constructor"in P&&"constructor"in H&&!(typeof fc=="function"&&fc instanceof fc&&typeof Ah=="function"&&Ah instanceof Ah)&&(Hs=!1)}return qt.delete(P),qt.delete(H),Hs}function Tc(P){return wu(ad(P,n,fl),P+"")}function Eh(P){return zr(P,lo,IA)}function bf(P){return zr(P,xo,EA)}var $h=Bi?function(P){return Bi.get(P)}:C1;function SA(P){for(var H=P.name+"",pe=xs[H],je=rs.call(xs,H)?pe.length:0;je--;){var St=pe[je],qt=St.func;if(qt==null||qt==P)return St.name}return H}function Kh(P){var H=rs.call(R,"placeholder")?R:P;return H.placeholder}function Ir(){var P=R.iteratee||I1;return P=P===I1?Ic:P,arguments.length?P(arguments[0],arguments[1]):P}function wf(P,H){var pe=P.__data__;return Lm(H)?pe[typeof H=="string"?"string":"hash"]:pe.map}function J0(P){for(var H=lo(P),pe=H.length;pe--;){var je=H[pe],St=P[je];H[pe]=[je,St,m0(St)]}return H}function Jh(P,H){var pe=To(P,H);return Pa(pe)?pe:n}function Sf(P){var H=rs.call(P,yl),pe=P[yl];try{P[yl]=n;var je=!0}catch{}var St=go.call(P);return je&&(H?P[yl]=pe:delete P[yl]),St}var IA=el?function(P){return P==null?[]:(P=Ln(P),Ro(el(P),function(H){return _l.call(P,H)}))}:T1,EA=el?function(P){for(var H=[];P;)Xo(H,IA(P)),P=Hl(P);return H}:T1,Ul=bs;(Tu&&Ul(new Tu(new ArrayBuffer(1)))!=V||oa&&Ul(new oa)!=Ji||yu&&Ul(yu.resolve())!=wn||vs&&Ul(new vs)!=en||ko&&Ul(new ko)!=In)&&(Ul=function(P){var H=bs(P),pe=H==ii?P.constructor:n,je=pe?th(pe):"";if(je)switch(je){case vu:return V;case Oo:return Ji;case cs:return wn;case hl:return en;case Ms:return In}return H});function Mm(P,H,pe){for(var je=-1,St=pe.length;++je<St;){var qt=pe[je],ui=qt.size;switch(qt.type){case"drop":P+=ui;break;case"dropRight":H-=ui;break;case"take":H=ds(H,P+ui);break;case"takeRight":P=_r(P,H-ui);break}}return{start:P,end:H}}function Pm(P){var H=P.match(Ue);return H?H[1].split(ht):[]}function ed(P,H,pe){H=bh(H,P);for(var je=-1,St=H.length,qt=!1;++je<St;){var ui=ms(H[je]);if(!(qt=P!=null&&pe(P,ui)))break;P=P[ui]}return qt||++je!=St?qt:(St=P==null?0:P.length,!!St&&Mt(St)&&kc(ui,St)&&(f(P)||Oe(P)))}function Dm(P){var H=P.length,pe=new P.constructor(H);return H&&typeof P[0]=="string"&&rs.call(P,"index")&&(pe.index=P.index,pe.input=P.input),pe}function td(P){return typeof P.constructor=="function"&&!TA(P)?ee(Hl(P)):{}}function eA(P,H,pe){var je=P.constructor;switch(H){case k:return ac(P);case yn:case Ci:return new je(+P);case V:return ff(P,pe);case $:case te:case fe:case ve:case Ie:case Ee:case ze:case Qe:case He:return Po(P,pe);case Ji:return new je;case fi:case tr:return new je(P);case hi:return yA(P);case en:return new je;case Fn:return Tm(P)}}function id(P,H){var pe=H.length;if(!pe)return P;var je=pe-1;return H[je]=(pe>1?"& ":"")+H[je],H=H.join(pe>2?", ":" "),P.replace(De,`{
/* [wrapped with `+H+`] */
`)}function Ep(P){return f(P)||Oe(P)||!!(Fu&&P&&P[Fu])}function kc(P,H){var pe=typeof P;return H=H??Rt,!!H&&(pe=="number"||pe!="symbol"&&vi.test(P))&&P>-1&&P%1==0&&P<H}function bu(P,H,pe){if(!Dt(pe))return!1;var je=typeof H;return(je=="number"?p(pe)&&kc(H,pe.length):je=="string"&&H in pe)?J(pe[H],P):!1}function CA(P,H){if(f(P))return!1;var pe=typeof P;return pe=="number"||pe=="symbol"||pe=="boolean"||P==null||Dn(P)?!0:ge.test(P)||!ye.test(P)||H!=null&&P in Ln(H)}function Lm(P){var H=typeof P;return H=="string"||H=="number"||H=="symbol"||H=="boolean"?P!=="__proto__":P===null}function p0(P){var H=SA(P),pe=R[H];if(typeof pe!="function"||!(H in we.prototype))return!1;if(P===pe)return!0;var je=$h(pe);return!!je&&P===je[0]}function Cp(P){return!!Ru&&Ru in P}var nd=Xa?At:k1;function TA(P){var H=P&&P.constructor,pe=typeof H=="function"&&H.prototype||As;return P===pe}function m0(P){return P===P&&!Dt(P)}function rd(P,H){return function(pe){return pe==null?!1:pe[P]===H&&(H!==n||P in Ln(pe))}}function Bm(P){var H=Mh(P,function(je){return pe.size===W&&pe.clear(),je}),pe=H.cache;return H}function Ch(P,H){var pe=P[1],je=H[1],St=pe|je,qt=St<(tt|lt|Xt),ui=je==Xt&&pe==Tt||je==Xt&&pe==rt&&P[7].length<=H[8]||je==(Xt|rt)&&H[7].length<=H[8]&&pe==Tt;if(!(qt||ui))return P;je&tt&&(P[2]=H[2],St|=pe&tt?0:ut);var pi=H[3];if(pi){var Mi=P[3];P[3]=Mi?pf(Mi,pi,H[4]):pi,P[4]=Mi?Jo(P[3],he):H[4]}return pi=H[5],pi&&(Mi=P[5],P[5]=Mi?mf(Mi,pi,H[6]):pi,P[6]=Mi?Jo(P[5],he):H[6]),pi=H[7],pi&&(P[7]=pi),je&Xt&&(P[8]=P[8]==null?H[8]:ds(P[8],H[8])),P[9]==null&&(P[9]=H[9]),P[0]=H[0],P[1]=St,P}function Al(P){var H=[];if(P!=null)for(var pe in Ln(P))H.push(pe);return H}function sd(P){return go.call(P)}function ad(P,H,pe){return H=_r(H===n?P.length-1:H,0),function(){for(var je=arguments,St=-1,qt=_r(je.length-H,0),ui=Di(qt);++St<qt;)ui[St]=je[H+St];St=-1;for(var pi=Di(H+1);++St<H;)pi[St]=je[St];return pi[H]=pe(ui),us(P,this,pi)}}function od(P,H){return H.length<2?P:is(P,Dl(H,0,-1))}function fa(P,H){for(var pe=P.length,je=ds(H.length,pe),St=xl(P);je--;){var qt=H[je];P[je]=kc(qt,pe)?St[qt]:n}return P}function kA(P,H){if(!(H==="constructor"&&typeof P[H]=="function")&&H!="__proto__")return P[H]}var ld=g0(cf),MA=jl||function(P,H){return Ls.setTimeout(P,H)},wu=g0(gA);function Ya(P,H,pe){var je=H+"";return wu(P,id(je,Tp(Pm(je),pe)))}function g0(P){var H=0,pe=0;return function(){var je=gn(),St=dt-(je-pe);if(pe=je,St>0){if(++H>=bt)return arguments[0]}else H=0;return P.apply(n,arguments)}}function If(P,H){var pe=-1,je=P.length,St=je-1;for(H=H===n?je:H;++pe<H;){var qt=mA(pe,St),ui=P[qt];P[qt]=P[pe],P[pe]=ui}return P.length=H,P}var ud=Bm(function(P){var H=[];return P.charCodeAt(0)===46&&H.push(""),P.replace(Pe,function(pe,je,St,qt){H.push(St?qt.replace(ke,"$1"):je||pe)}),H});function ms(P){if(typeof P=="string"||Dn(P))return P;var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function th(P){if(P!=null){try{return mo.call(P)}catch{}try{return P+""}catch{}}return""}function Tp(P,H){return io(tn,function(pe){var je="_."+pe[0];H&pe[1]&&!Wo(P,je)&&P.push(je)}),P.sort()}function cd(P){if(P instanceof we)return P.clone();var H=new oe(P.__wrapped__,P.__chain__);return H.__actions__=xl(P.__actions__),H.__index__=P.__index__,H.__values__=P.__values__,H}function ih(P,H,pe){(pe?bu(P,H,pe):H===n)?H=1:H=_r(Wn(H),0);var je=P==null?0:P.length;if(!je||H<1)return[];for(var St=0,qt=0,ui=Di(fs(je/H));St<je;)ui[qt++]=Dl(P,St,St+=H);return ui}function PA(P){for(var H=-1,pe=P==null?0:P.length,je=0,St=[];++H<pe;){var qt=P[H];qt&&(St[je++]=qt)}return St}function kp(){var P=arguments.length;if(!P)return[];for(var H=Di(P-1),pe=arguments[0],je=P;je--;)H[je-1]=arguments[je];return Xo(f(pe)?xl(pe):[pe],qr(H,1))}var _0=ps(function(P,H){return S(P)?yr(P,qr(H,1,S,!0)):[]}),DA=ps(function(P,H){var pe=ku(H);return S(pe)&&(pe=n),S(P)?yr(P,qr(H,1,S,!0),Ir(pe,2)):[]}),Mp=ps(function(P,H){var pe=ku(H);return S(pe)&&(pe=n),S(P)?yr(P,qr(H,1,S,!0),n,pe):[]});function hd(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),Dl(P,H<0?0:H,je)):[]}function Ad(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),H=je-H,Dl(P,0,H<0?0:H)):[]}function zm(P,H){return P&&P.length?Ll(P,Ir(H,3),!0,!0):[]}function Rm(P,H){return P&&P.length?Ll(P,Ir(H,3),!0):[]}function Fm(P,H,pe,je){var St=P==null?0:P.length;return St?(pe&&typeof pe!="number"&&bu(P,H,pe)&&(pe=0,je=St),so(P,H,pe,je)):[]}function fd(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=pe==null?0:Wn(pe);return St<0&&(St=_r(je+St,0)),Xn(P,Ir(H,3),St)}function LA(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=je-1;return pe!==n&&(St=Wn(pe),St=pe<0?_r(je+St,0):ds(St,je-1)),Xn(P,Ir(H,3),St,!0)}function fl(P){var H=P==null?0:P.length;return H?qr(P,1):[]}function y0(P){var H=P==null?0:P.length;return H?qr(P,Nt):[]}function v0(P,H){var pe=P==null?0:P.length;return pe?(H=H===n?1:Wn(H),qr(P,H)):[]}function Mc(P){for(var H=-1,pe=P==null?0:P.length,je={};++H<pe;){var St=P[H];je[St[0]]=St[1]}return je}function BA(P){return P&&P.length?P[0]:n}function Ef(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=pe==null?0:Wn(pe);return St<0&&(St=_r(je+St,0)),Ko(P,H,St)}function zA(P){var H=P==null?0:P.length;return H?Dl(P,0,-1):[]}var Cf=ps(function(P){var H=Us(P,Z0);return H.length&&H[0]===P[0]?Sc(H):[]}),Tf=ps(function(P){var H=ku(P),pe=Us(P,Z0);return H===ku(pe)?H=n:pe.pop(),pe.length&&pe[0]===P[0]?Sc(pe,Ir(H,2)):[]}),Su=ps(function(P){var H=ku(P),pe=Us(P,Z0);return H=typeof H=="function"?H:n,H&&pe.pop(),pe.length&&pe[0]===P[0]?Sc(pe,n,H):[]});function x0(P,H){return P==null?"":cu.call(P,H)}function ku(P){var H=P==null?0:P.length;return H?P[H-1]:n}function Th(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=je;return pe!==n&&(St=Wn(pe),St=St<0?_r(je+St,0):ds(St,je-1)),H===H?ha(P,H,St):Xn(P,Za,St,!0)}function RA(P,H){return P&&P.length?lf(P,Wn(H)):n}var FA=ps(nh);function nh(P,H){return P&&P.length&&H&&H.length?vh(P,H):P}function OA(P,H,pe){return P&&P.length&&H&&H.length?vh(P,H,Ir(pe,2)):P}function b0(P,H,pe){return P&&P.length&&H&&H.length?vh(P,H,n,pe):P}var Om=Tc(function(P,H){var pe=P==null?0:P.length,je=Ui(P,H);return $c(P,Us(H,function(St){return kc(St,pe)?+St:St}).sort(df)),je});function dd(P,H){var pe=[];if(!(P&&P.length))return pe;var je=-1,St=[],qt=P.length;for(H=Ir(H,3);++je<qt;){var ui=P[je];H(ui,je,P)&&(pe.push(ui),St.push(je))}return $c(P,St),pe}function kh(P){return P==null?P:tl.call(P)}function Pc(P,H,pe){var je=P==null?0:P.length;return je?(pe&&typeof pe!="number"&&bu(P,H,pe)?(H=0,pe=je):(H=H==null?0:Wn(H),pe=pe===n?je:Wn(pe)),Dl(P,H,pe)):[]}function rh(P,H){return _A(P,H)}function pd(P,H,pe){return c0(P,H,Ir(pe,2))}function kf(P,H){var pe=P==null?0:P.length;if(pe){var je=_A(P,H);if(je<pe&&J(P[je],H))return je}return-1}function md(P,H){return _A(P,H,!0)}function Nm(P,H,pe){return c0(P,H,Ir(pe,2),!0)}function w0(P,H){var pe=P==null?0:P.length;if(pe){var je=_A(P,H,!0)-1;if(J(P[je],H))return je}return-1}function S0(P){return P&&P.length?h0(P):[]}function Mf(P,H){return P&&P.length?h0(P,Ir(H,2)):[]}function Yu(P){var H=P==null?0:P.length;return H?Dl(P,1,H):[]}function Dc(P,H,pe){return P&&P.length?(H=pe||H===n?1:Wn(H),Dl(P,0,H<0?0:H)):[]}function tA(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),H=je-H,Dl(P,H<0?0:H,je)):[]}function I0(P,H){return P&&P.length?Ll(P,Ir(H,3),!1,!0):[]}function Pp(P,H){return P&&P.length?Ll(P,Ir(H,3)):[]}var gd=ps(function(P){return Kc(qr(P,1,S,!0))}),Pf=ps(function(P){var H=ku(P);return S(H)&&(H=n),Kc(qr(P,1,S,!0),Ir(H,2))}),NA=ps(function(P){var H=ku(P);return H=typeof H=="function"?H:n,Kc(qr(P,1,S,!0),n,H)});function Dp(P){return P&&P.length?Kc(P):[]}function _d(P,H){return P&&P.length?Kc(P,Ir(H,2)):[]}function yd(P,H){return H=typeof H=="function"?H:n,P&&P.length?Kc(P,n,H):[]}function sh(P){if(!(P&&P.length))return[];var H=0;return P=Ro(P,function(pe){if(S(pe))return H=_r(pe.length,H),!0}),Zr(H,function(pe){return Us(P,fr(pe))})}function vd(P,H){if(!(P&&P.length))return[];var pe=sh(P);return H==null?pe:Us(pe,function(je){return us(H,n,je)})}var Lp=ps(function(P,H){return S(P)?yr(P,H):[]}),xd=ps(function(P){return Jc(Ro(P,S))}),Bp=ps(function(P){var H=ku(P);return S(H)&&(H=n),Jc(Ro(P,S),Ir(H,2))}),VA=ps(function(P){var H=ku(P);return H=typeof H=="function"?H:n,Jc(Ro(P,S),n,H)}),ah=ps(sh);function zp(P,H){return Zh(P||[],H||[],Yt)}function Rp(P,H){return Zh(P||[],H||[],jh)}var bd=ps(function(P){var H=P.length,pe=H>1?P[H-1]:n;return pe=typeof pe=="function"?(P.pop(),pe):n,vd(P,pe)});function wd(P){var H=R(P);return H.__chain__=!0,H}function Fp(P,H){return H(P),P}function UA(P,H){return H(P)}var E0=Tc(function(P){var H=P.length,pe=H?P[0]:0,je=this.__wrapped__,St=function(qt){return Ui(qt,P)};return H>1||this.__actions__.length||!(je instanceof we)||!kc(pe)?this.thru(St):(je=je.slice(pe,+pe+(H?1:0)),je.__actions__.push({func:UA,args:[St],thisArg:n}),new oe(je,this.__chain__).thru(function(qt){return H&&!qt.length&&qt.push(n),qt}))});function C0(){return wd(this)}function Lc(){return new oe(this.value(),this.__chain__)}function Sd(){this.__values__===n&&(this.__values__=ia(this.value()));var P=this.__index__>=this.__values__.length,H=P?n:this.__values__[this.__index__++];return{done:P,value:H}}function Mu(){return this}function GA(P){for(var H,pe=this;pe instanceof le;){var je=cd(pe);je.__index__=0,je.__values__=n,H?St.__wrapped__=je:H=je;var St=je;pe=pe.__wrapped__}return St.__wrapped__=P,H}function Id(){var P=this.__wrapped__;if(P instanceof we){var H=P;return this.__actions__.length&&(H=new we(this)),H=H.reverse(),H.__actions__.push({func:UA,args:[kh],thisArg:n}),new oe(H,this.__chain__)}return this.thru(kh)}function Ed(){return A0(this.__wrapped__,this.__actions__)}var Cd=Da(function(P,H,pe){rs.call(P,pe)?++P[pe]:Ei(P,pe,1)});function T0(P,H,pe){var je=f(P)?ql:Aa;return pe&&bu(P,H,pe)&&(H=n),je(P,Ir(H,3))}function Df(P,H){var pe=f(P)?Ro:ao;return pe(P,Ir(H,3))}var Td=vA(fd),kd=vA(LA);function Md(P,H){return qr(oh(P,H),1)}function bl(P,H){return qr(oh(P,H),Nt)}function qA(P,H,pe){return pe=pe===n?1:Wn(pe),qr(oh(P,H),pe)}function k0(P,H){var pe=f(P)?io:er;return pe(P,Ir(H,3))}function M0(P,H){var pe=f(P)?no:Ia;return pe(P,Ir(H,3))}var Pd=Da(function(P,H,pe){rs.call(P,pe)?P[pe].push(H):Ei(P,pe,[H])});function Op(P,H,pe,je){P=p(P)?P:Rc(P),pe=pe&&!je?Wn(pe):0;var St=P.length;return pe<0&&(pe=_r(St+pe,0)),Wi(P)?pe<=St&&P.indexOf(H,pe)>-1:!!St&&Ko(P,H,pe)>-1}var Np=ps(function(P,H,pe){var je=-1,St=typeof H=="function",qt=p(P)?Di(P.length):[];return er(P,function(ui){qt[++je]=St?us(H,ui,pe):Zl(ui,H,pe)}),qt}),Dd=Da(function(P,H,pe){Ei(P,pe,H)});function oh(P,H){var pe=f(P)?Us:_p;return pe(P,Ir(H,3))}function Ld(P,H,pe,je){return P==null?[]:(f(H)||(H=H==null?[]:[H]),pe=je?n:pe,f(pe)||(pe=pe==null?[]:[pe]),q0(P,H,pe))}var cc=Da(function(P,H,pe){P[pe?0:1].push(H)},function(){return[[],[]]});function Bd(P,H,pe){var je=f(P)?Yo:Un,St=arguments.length<3;return je(P,Ir(H,4),pe,St,er)}function Lf(P,H,pe){var je=f(P)?$o:Un,St=arguments.length<3;return je(P,Ir(H,4),pe,St,Ia)}function Bf(P,H){var pe=f(P)?Ro:ao;return pe(P,QA(Ir(H,3)))}function zf(P){var H=f(P)?ct:Wl;return H(P)}function Vm(P,H,pe){(pe?bu(P,H,pe):H===n)?H=1:H=Wn(H);var je=f(P)?Et:Hh;return je(P,H)}function Um(P){var H=f(P)?wt:j0;return H(P)}function Vp(P){if(P==null)return 0;if(p(P))return Wi(P)?po(P):P.length;var H=Ul(P);return H==Ji||H==en?P.size:Gh(P).length}function HA(P,H,pe){var je=f(P)?ba:Vu;return pe&&bu(P,H,pe)&&(H=n),je(P,Ir(H,3))}var iA=ps(function(P,H){if(P==null)return[];var pe=H.length;return pe>1&&bu(P,H[0],H[1])?H=[]:pe>2&&bu(H[0],H[1],H[2])&&(H=[H[0]]),q0(P,qr(H,1),[])}),Do=Wu||function(){return Ls.Date.now()};function lh(P,H){if(typeof H!="function")throw new Yn(I);return P=Wn(P),function(){if(--P<1)return H.apply(this,arguments)}}function nA(P,H,pe){return H=pe?n:H,H=P&&H==null?P.length:H,eh(P,Xt,n,n,n,n,H)}function jA(P,H){var pe;if(typeof H!="function")throw new Yn(I);return P=Wn(P),function(){return--P>0&&(pe=H.apply(this,arguments)),P<=1&&(H=n),pe}}var rA=ps(function(P,H,pe){var je=tt;if(pe.length){var St=Jo(pe,Kh(rA));je|=zt}return eh(P,je,H,pe,St)}),P0=ps(function(P,H,pe){var je=tt|lt;if(pe.length){var St=Jo(pe,Kh(P0));je|=zt}return eh(H,je,P,pe,St)});function Up(P,H,pe){H=pe?n:H;var je=eh(P,Tt,n,n,n,n,n,H);return je.placeholder=Up.placeholder,je}function zd(P,H,pe){H=pe?n:H;var je=eh(P,Pt,n,n,n,n,n,H);return je.placeholder=zd.placeholder,je}function Rd(P,H,pe){var je,St,qt,ui,pi,Mi,un=0,hn=!1,_n=!1,$n=!0;if(typeof P!="function")throw new Yn(I);H=ir(H)||0,Dt(pe)&&(hn=!!pe.leading,_n="maxWait"in pe,qt=_n?_r(ir(pe.maxWait)||0,H):qt,$n="trailing"in pe?!!pe.trailing:$n);function xr(Kl){var aA=je,Hf=St;return je=St=n,un=Kl,ui=P.apply(Hf,aA),ui}function Wr(Kl){return un=Kl,pi=MA(sa,H),hn?xr(Kl):ui}function Hs(Kl){var aA=Kl-Mi,Hf=Kl-un,O2=H-aA;return _n?ds(O2,qt-Hf):O2}function Xr(Kl){var aA=Kl-Mi,Hf=Kl-un;return Mi===n||aA>=H||aA<0||_n&&Hf>=qt}function sa(){var Kl=Do();if(Xr(Kl))return da(Kl);pi=MA(sa,Hs(Kl))}function da(Kl){return pi=n,$n&&je?xr(Kl):(je=St=n,ui)}function hh(){pi!==n&&Af(pi),un=0,je=Mi=St=pi=n}function fc(){return pi===n?ui:da(Do())}function Ah(){var Kl=Do(),aA=Xr(Kl);if(je=arguments,St=this,Mi=Kl,aA){if(pi===n)return Wr(Mi);if(_n)return Af(pi),pi=MA(sa,H),xr(Mi)}return pi===n&&(pi=MA(sa,H)),ui}return Ah.cancel=hh,Ah.flush=fc,Ah}var ZA=ps(function(P,H){return kn(P,1,H)}),Bl=ps(function(P,H,pe){return kn(P,ir(H)||0,pe)});function Bc(P){return eh(P,yt)}function Mh(P,H){if(typeof P!="function"||H!=null&&typeof H!="function")throw new Yn(I);var pe=function(){var je=arguments,St=H?H.apply(this,je):je[0],qt=pe.cache;if(qt.has(St))return qt.get(St);var ui=P.apply(this,je);return pe.cache=qt.set(St,ui)||qt,ui};return pe.cache=new(Mh.Cache||l),pe}Mh.Cache=l;function QA(P){if(typeof P!="function")throw new Yn(I);return function(){var H=arguments;switch(H.length){case 0:return!P.call(this);case 1:return!P.call(this,H[0]);case 2:return!P.call(this,H[0],H[1]);case 3:return!P.call(this,H[0],H[1],H[2])}return!P.apply(this,H)}}function WA(P){return jA(2,P)}var Rf=Cm(function(P,H){H=H.length==1&&f(H[0])?Us(H[0],rr(Ir())):Us(qr(H,1),rr(Ir()));var pe=H.length;return ps(function(je){for(var St=-1,qt=ds(je.length,pe);++St<qt;)je[St]=H[St].call(this,je[St]);return us(P,this,je)})}),D0=ps(function(P,H){var pe=Jo(H,Kh(D0));return eh(P,zt,n,H,pe)}),Ff=ps(function(P,H){var pe=Jo(H,Kh(Ff));return eh(P,Ge,n,H,pe)}),Of=Tc(function(P,H){return eh(P,rt,n,n,n,H)});function Nf(P,H){if(typeof P!="function")throw new Yn(I);return H=H===n?H:Wn(H),ps(P,H)}function L0(P,H){if(typeof P!="function")throw new Yn(I);return H=H==null?0:_r(Wn(H),0),ps(function(pe){var je=pe[H],St=Ec(pe,0,H);return je&&Xo(St,je),us(P,this,St)})}function Vf(P,H,pe){var je=!0,St=!0;if(typeof P!="function")throw new Yn(I);return Dt(pe)&&(je="leading"in pe?!!pe.leading:je,St="trailing"in pe?!!pe.trailing:St),Rd(P,H,{leading:je,maxWait:H,trailing:St})}function Uf(P){return nA(P,1)}function Gp(P,H){return D0(Q0(H),P)}function m(){if(!arguments.length)return[];var P=arguments[0];return f(P)?P:[P]}function h(P){return ln(P,be)}function x(P,H){return H=typeof H=="function"?H:n,ln(P,be,H)}function M(P){return ln(P,ae|be)}function q(P,H){return H=typeof H=="function"?H:n,ln(P,ae|be,H)}function K(P,H){return H==null||rn(P,H,lo(H))}function J(P,H){return P===H||P!==P&&H!==H}var me=wA(Qs),Ce=wA(function(P,H){return P>=H}),Oe=hu(function(){return arguments}())?hu:function(P){return Bt(P)&&rs.call(P,"callee")&&!_l.call(P,"callee")},f=Di.isArray,u=El?rr(El):il;function p(P){return P!=null&&Mt(P.length)&&!At(P)}function S(P){return Bt(P)&&p(P)}function L(P){return P===!0||P===!1||Bt(P)&&bs(P)==yn}var U=_u||k1,Q=Ha?rr(Ha):vl;function re(P){return Bt(P)&&P.nodeType===1&&!an(P)}function Ae(P){if(P==null)return!0;if(p(P)&&(f(P)||typeof P=="string"||typeof P.splice=="function"||U(P)||Rn(P)||Oe(P)))return!P.length;var H=Ul(P);if(H==Ji||H==en)return!P.size;if(TA(P))return!Gh(P).length;for(var pe in P)if(rs.call(P,pe))return!1;return!0}function _e(P,H){return Pl(P,H)}function Le(P,H,pe){pe=typeof pe=="function"?pe:n;var je=pe?pe(P,H):n;return je===n?Pl(P,H,n,pe):!!je}function qe(P){if(!Bt(P))return!1;var H=bs(P);return H==Ri||H==gi||typeof P.message=="string"&&typeof P.name=="string"&&!an(P)}function et(P){return typeof P=="number"&&Ou(P)}function At(P){if(!Dt(P))return!1;var H=bs(P);return H==ai||H==Ki||H==nn||H==Rr}function _t(P){return typeof P=="number"&&P==Wn(P)}function Mt(P){return typeof P=="number"&&P>-1&&P%1==0&&P<=Rt}function Dt(P){var H=typeof P;return P!=null&&(H=="object"||H=="function")}function Bt(P){return P!=null&&typeof P=="object"}var Kt=Ta?rr(Ta):af;function Ht(P,H){return P===H||Vh(P,H,J0(H))}function Zt(P,H,pe){return pe=typeof pe=="function"?pe:n,Vh(P,H,J0(H),pe)}function ci(P){return on(P)&&P!=+P}function yi(P){if(nd(P))throw new ti(b);return Pa(P)}function Xi(P){return P===null}function xn(P){return P==null}function on(P){return typeof P=="number"||Bt(P)&&bs(P)==fi}function an(P){if(!Bt(P)||bs(P)!=ii)return!1;var H=Hl(P);if(H===null)return!0;var pe=rs.call(H,"constructor")&&H.constructor;return typeof pe=="function"&&pe instanceof pe&&mo.call(pe)==Ml}var An=ml?rr(ml):pA;function zn(P){return _t(P)&&P>=-Rt&&P<=Rt}var sn=Cl?rr(Cl):yh;function Wi(P){return typeof P=="string"||!f(P)&&Bt(P)&&bs(P)==tr}function Dn(P){return typeof P=="symbol"||Bt(P)&&bs(P)==Fn}var Rn=mu?rr(mu):Uh;function pr(P){return P===n}function Vr(P){return Bt(P)&&Ul(P)==In}function Hr(P){return Bt(P)&&bs(P)==v}var zs=wA(Xc),Ea=wA(function(P,H){return P<=H});function ia(P){if(!P)return[];if(p(P))return Wi(P)?ea(P):xl(P);if(Vl&&P[Vl])return Js(P[Vl]());var H=Ul(P),pe=H==Ji?Gs:H==en?$r:Rc;return pe(P)}function ns(P){if(!P)return P===0?P:0;if(P=ir(P),P===Nt||P===-Nt){var H=P<0?-1:1;return H*Ot}return P===P?P:0}function Wn(P){var H=ns(P),pe=H%1;return H===H?pe?H-pe:H:0}function ws(P){return P?Gi(Wn(P),0,Si):0}function ir(P){if(typeof P=="number")return P;if(Dn(P))return _i;if(Dt(P)){var H=typeof P.valueOf=="function"?P.valueOf():P;P=Dt(H)?H+"":H}if(typeof P!="string")return P===0?P:+P;P=kr(P);var pe=Jt.test(P);return pe||zi.test(P)?Lr(P.slice(2),pe?2:8):Ai.test(P)?_i:+P}function na(P){return oc(P,xo(P))}function Ps(P){return P?Gi(Wn(P),-Rt,Rt):P===0?P:0}function Kn(P){return P==null?"":xu(P)}var La=lc(function(P,H){if(TA(H)||p(H)){oc(H,lo(H),P);return}for(var pe in H)rs.call(H,pe)&&Yt(P,pe,H[pe])}),$a=lc(function(P,H){oc(H,xo(H),P)}),va=lc(function(P,H,pe,je){oc(H,xo(H),P,je)}),Uo=lc(function(P,H,pe,je){oc(H,lo(H),P,je)}),oo=Tc(Ui);function ra(P,H){var pe=ee(P);return H==null?pe:ji(pe,H)}var br=ps(function(P,H){P=Ln(P);var pe=-1,je=H.length,St=je>2?H[2]:n;for(St&&bu(H[0],H[1],St)&&(je=1);++pe<je;)for(var qt=H[pe],ui=xo(qt),pi=-1,Mi=ui.length;++pi<Mi;){var un=ui[pi],hn=P[un];(hn===n||J(hn,As[un])&&!rs.call(P,un))&&(P[un]=qt[un])}return P}),vo=ps(function(P){return P.push(n,Sp),us(jp,n,P)});function nl(P,H){return Sr(P,Ir(H,3),yo)}function rl(P,H){return Sr(P,Ir(H,3),Zs)}function Pu(P,H){return P==null?P:ya(P,Ir(H,3),xo)}function Uu(P,H){return P==null?P:_o(P,Ir(H,3),xo)}function zl(P,H){return P&&yo(P,Ir(H,3))}function zc(P,H){return P&&Zs(P,Ir(H,3))}function Gu(P){return P==null?[]:ts(P,lo(P))}function qu(P){return P==null?[]:ts(P,xo(P))}function Xl(P,H,pe){var je=P==null?n:is(P,H);return je===n?pe:je}function uh(P,H){return P!=null&&ed(P,H,Mo)}function sA(P,H){return P!=null&&ed(P,H,No)}var qp=X0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=go.call(H)),P[H]=pe},S1(Fc)),Fd=X0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=go.call(H)),rs.call(P,H)?P[H].push(pe):P[H]=[pe]},Ir),Od=ps(Zl);function lo(P){return p(P)?at(P):Gh(P)}function xo(P){return p(P)?at(P,!0):l0(P)}function Gf(P,H){var pe={};return H=Ir(H,3),yo(P,function(je,St,qt){Ei(pe,H(je,St,qt),je)}),pe}function Hp(P,H){var pe={};return H=Ir(H,3),yo(P,function(je,St,qt){Ei(pe,St,H(je,St,qt))}),pe}var Gm=lc(function(P,H,pe){Yc(P,H,pe)}),jp=lc(function(P,H,pe,je){Yc(P,H,pe,je)}),qm=Tc(function(P,H){var pe={};if(P==null)return pe;var je=!1;H=Us(H,function(qt){return qt=bh(qt,P),je||(je=qt.length>1),qt}),oc(P,bf(P),pe),je&&(pe=ln(pe,ae|ue|be,Ip));for(var St=H.length;St--;)hf(pe,H[St]);return pe});function Yl(P,H){return Ph(P,QA(Ir(H)))}var Hu=Tc(function(P,H){return P==null?{}:Ql(P,H)});function Ph(P,H){if(P==null)return{};var pe=Us(bf(P),function(je){return[je]});return H=Ir(H),Xu(P,pe,function(je,St){return H(je,St[0])})}function hc(P,H,pe){H=bh(H,P);var je=-1,St=H.length;for(St||(St=1,P=n);++je<St;){var qt=P==null?n:P[ms(H[je])];qt===n&&(je=St,qt=pe),P=At(qt)?qt.call(P):qt}return P}function $l(P,H,pe){return P==null?P:jh(P,H,pe)}function ju(P,H,pe,je){return je=typeof je=="function"?je:n,P==null?P:jh(P,H,pe,je)}var Hm=Sh(lo),Fg=Sh(xo);function x1(P,H,pe){var je=f(P),St=je||U(P)||Rn(P);if(H=Ir(H,4),pe==null){var qt=P&&P.constructor;St?pe=je?new qt:[]:Dt(P)?pe=At(qt)?ee(Hl(P)):{}:pe={}}return(St?io:yo)(P,function(ui,pi,Mi){return H(pe,ui,pi,Mi)}),pe}function b1(P,H){return P==null?!0:hf(P,H)}function Iu(P,H,pe){return P==null?P:xh(P,H,Q0(pe))}function Ac(P,H,pe,je){return je=typeof je=="function"?je:n,P==null?P:xh(P,H,Q0(pe),je)}function Rc(P){return P==null?[]:ll(P,lo(P))}function ch(P){return P==null?[]:ll(P,xo(P))}function qf(P,H,pe){return pe===n&&(pe=H,H=n),pe!==n&&(pe=ir(pe),pe=pe===pe?pe:0),H!==n&&(H=ir(H),H=H===H?H:0),Gi(ir(P),H,pe)}function Dh(P,H,pe){return H=ns(H),pe===n?(pe=H,H=0):pe=ns(pe),P=ir(P),Vo(P,H,pe)}function V5(P,H,pe){if(pe&&typeof pe!="boolean"&&bu(P,H,pe)&&(H=pe=n),pe===n&&(typeof H=="boolean"?(pe=H,H=n):typeof P=="boolean"&&(pe=P,P=n)),P===n&&H===n?(P=0,H=1):(P=ns(P),H===n?(H=P,P=0):H=ns(H)),P>H){var je=P;P=H,H=je}if(pe||P%1||H%1){var St=Jn();return ds(P+St*(H-P+Ks("1e-"+((St+"").length-1))),H)}return mA(P,H)}var U5=Wh(function(P,H,pe){return H=H.toLowerCase(),P+(pe?L2(H):H)});function L2(P){return w1(Kn(P).toLowerCase())}function B2(P){return P=Kn(P),P&&P.replace(wi,hs).replace(sr,"")}function G5(P,H,pe){P=Kn(P),H=xu(H);var je=P.length;pe=pe===n?je:Gi(Wn(pe),0,je);var St=pe;return pe-=H.length,pe>=0&&P.slice(pe,St)==H}function q5(P){return P=Kn(P),P&&ne.test(P)?P.replace(Me,wa):P}function H5(P){return P=Kn(P),P&&Ne.test(P)?P.replace(Fe,"\\$&"):P}var j5=Wh(function(P,H,pe){return P+(pe?"-":"")+H.toLowerCase()}),Z5=Wh(function(P,H,pe){return P+(pe?" ":"")+H.toLowerCase()}),Q5=Cc("toLowerCase");function W5(P,H,pe){P=Kn(P),H=Wn(H);var je=H?po(P):0;if(!H||je>=H)return P;var St=(H-je)/2;return d0(_a(St),pe)+P+d0(fs(St),pe)}function X5(P,H,pe){P=Kn(P),H=Wn(H);var je=H?po(P):0;return H&&je<H?P+d0(H-je,pe):P}function Y5(P,H,pe){P=Kn(P),H=Wn(H);var je=H?po(P):0;return H&&je<H?d0(H-je,pe)+P:P}function $5(P,H,pe){return pe||H==null?H=0:H&&(H=+H),jn(Kn(P).replace(Xe,""),H||0)}function K5(P,H,pe){return(pe?bu(P,H,pe):H===n)?H=1:H=Wn(H),u0(Kn(P),H)}function J5(){var P=arguments,H=Kn(P[0]);return P.length<3?H:H.replace(P[1],P[2])}var eI=Wh(function(P,H,pe){return P+(pe?"_":"")+H.toLowerCase()});function tI(P,H,pe){return pe&&typeof pe!="number"&&bu(P,H,pe)&&(H=pe=n),pe=pe===n?Si:pe>>>0,pe?(P=Kn(P),P&&(typeof H=="string"||H!=null&&!An(H))&&(H=xu(H),!H&&kl(P))?Ec(ea(P),0,pe):P.split(H,pe)):[]}var iI=Wh(function(P,H,pe){return P+(pe?" ":"")+w1(H)});function nI(P,H,pe){return P=Kn(P),pe=pe==null?0:Gi(Wn(pe),0,P.length),H=xu(H),P.slice(pe,pe+H.length)==H}function rI(P,H,pe){var je=R.templateSettings;pe&&bu(P,H,pe)&&(H=n),P=Kn(P),H=va({},H,je,wp);var St=va({},H.imports,je.imports,wp),qt=lo(St),ui=ll(St,qt),pi,Mi,un=0,hn=H.interpolate||$t,_n="__p += '",$n=Hn((H.escape||$t).source+"|"+hn.source+"|"+(hn===de?oi:$t).source+"|"+(H.evaluate||$t).source+"|$","g"),xr="//# sourceURL="+(rs.call(H,"sourceURL")?(H.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pl+"]")+`
`;P.replace($n,function(Xr,sa,da,hh,fc,Ah){return da||(da=hh),_n+=P.slice(un,Ah).replace(vn,Tl),sa&&(pi=!0,_n+=`' +
__e(`+sa+`) +
'`),fc&&(Mi=!0,_n+=`';
`+fc+`;
__p += '`),da&&(_n+=`' +
((__t = (`+da+`)) == null ? '' : __t) +
'`),un=Ah+Xr.length,Xr}),_n+=`';
`;var Wr=rs.call(H,"variable")&&H.variable;if(!Wr)_n=`with (obj) {
`+_n+`
}
`;else if(o.test(Wr))throw new ti(a);_n=(Mi?_n.replace(Ze,""):_n).replace(Ve,"$1").replace(ft,"$1;"),_n="function("+(Wr||"obj")+`) {
`+(Wr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(pi?", __e = _.escape":"")+(Mi?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+_n+`return __p
}`;var Hs=R2(function(){return xi(qt,xr+"return "+_n).apply(n,ui)});if(Hs.source=_n,qe(Hs))throw Hs;return Hs}function sI(P){return Kn(P).toLowerCase()}function aI(P){return Kn(P).toUpperCase()}function oI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return kr(P);if(!P||!(H=xu(H)))return P;var je=ea(P),St=ea(H),qt=Co(je,St),ui=ul(je,St)+1;return Ec(je,qt,ui).join("")}function lI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.slice(0,Sa(P)+1);if(!P||!(H=xu(H)))return P;var je=ea(P),St=ul(je,ea(H))+1;return Ec(je,0,St).join("")}function uI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.replace(Xe,"");if(!P||!(H=xu(H)))return P;var je=ea(P),St=Co(je,ea(H));return Ec(je,St).join("")}function cI(P,H){var pe=pt,je=gt;if(Dt(H)){var St="separator"in H?H.separator:St;pe="length"in H?Wn(H.length):pe,je="omission"in H?xu(H.omission):je}P=Kn(P);var qt=P.length;if(kl(P)){var ui=ea(P);qt=ui.length}if(pe>=qt)return P;var pi=pe-po(je);if(pi<1)return je;var Mi=ui?Ec(ui,0,pi).join(""):P.slice(0,pi);if(St===n)return Mi+je;if(ui&&(pi+=Mi.length-pi),An(St)){if(P.slice(pi).search(St)){var un,hn=Mi;for(St.global||(St=Hn(St.source,Kn(di.exec(St))+"g")),St.lastIndex=0;un=St.exec(hn);)var _n=un.index;Mi=Mi.slice(0,_n===n?pi:_n)}}else if(P.indexOf(xu(St),pi)!=pi){var $n=Mi.lastIndexOf(St);$n>-1&&(Mi=Mi.slice(0,$n))}return Mi+je}function hI(P){return P=Kn(P),P&&se.test(P)?P.replace(nt,ka):P}var AI=Wh(function(P,H,pe){return P+(pe?" ":"")+H.toUpperCase()}),w1=Cc("toUpperCase");function z2(P,H,pe){return P=Kn(P),H=pe?n:H,H===n?fo(P)?lu(P):gu(P):P.match(H)||[]}var R2=ps(function(P,H){try{return us(P,n,H)}catch(pe){return qe(pe)?pe:new ti(pe)}}),fI=Tc(function(P,H){return io(H,function(pe){pe=ms(pe),Ei(P,pe,rA(P[pe],P))}),P});function dI(P){var H=P==null?0:P.length,pe=Ir();return P=H?Us(P,function(je){if(typeof je[1]!="function")throw new Yn(I);return[pe(je[0]),je[1]]}):[],ps(function(je){for(var St=-1;++St<H;){var qt=P[St];if(us(qt[0],this,je))return us(qt[1],this,je)}})}function pI(P){return Bn(ln(P,ae))}function S1(P){return function(){return P}}function mI(P,H){return P==null||P!==P?H:P}var gI=xA(),_I=xA(!0);function Fc(P){return P}function I1(P){return Ic(typeof P=="function"?P:ln(P,ae))}function yI(P){return qh(ln(P,ae))}function vI(P,H){return of(P,ln(H,ae))}var xI=ps(function(P,H){return function(pe){return Zl(pe,P,H)}}),bI=ps(function(P,H){return function(pe){return Zl(P,pe,H)}});function E1(P,H,pe){var je=lo(H),St=ts(H,je);pe==null&&!(Dt(H)&&(St.length||!je.length))&&(pe=H,H=P,P=this,St=ts(H,lo(H)));var qt=!(Dt(pe)&&"chain"in pe)||!!pe.chain,ui=At(P);return io(St,function(pi){var Mi=H[pi];P[pi]=Mi,ui&&(P.prototype[pi]=function(){var un=this.__chain__;if(qt||un){var hn=P(this.__wrapped__),_n=hn.__actions__=xl(this.__actions__);return _n.push({func:Mi,args:arguments,thisArg:P}),hn.__chain__=un,hn}return Mi.apply(P,Xo([this.value()],arguments))})}),P}function wI(){return Ls._===this&&(Ls._=Pn),this}function C1(){}function SI(P){return P=Wn(P),ps(function(H){return lf(H,P)})}var II=Yh(Us),EI=Yh(ql),CI=Yh(ba);function F2(P){return CA(P)?fr(ms(P)):H0(P)}function TI(P){return function(H){return P==null?n:is(P,H)}}var kI=bp(),MI=bp(!0);function T1(){return[]}function k1(){return!1}function PI(){return{}}function DI(){return""}function LI(){return!0}function BI(P,H){if(P=Wn(P),P<1||P>Rt)return[];var pe=Si,je=ds(P,Si);H=Ir(H),P-=Si;for(var St=Zr(je,H);++pe<P;)H(pe);return St}function zI(P){return f(P)?Us(P,ms):Dn(P)?[P]:xl(ud(Kn(P)))}function RI(P){var H=++Qu;return Kn(P)+H}var FI=bA(function(P,H){return P+H},0),OI=xf("ceil"),NI=bA(function(P,H){return P/H},1),VI=xf("floor");function UI(P){return P&&P.length?Bs(P,Fc,Qs):n}function GI(P,H){return P&&P.length?Bs(P,Ir(H,2),Qs):n}function qI(P){return Jr(P,Fc)}function HI(P,H){return Jr(P,Ir(H,2))}function jI(P){return P&&P.length?Bs(P,Fc,Xc):n}function ZI(P,H){return P&&P.length?Bs(P,Ir(H,2),Xc):n}var QI=bA(function(P,H){return P*H},1),WI=xf("round"),XI=bA(function(P,H){return P-H},0);function YI(P){return P&&P.length?es(P,Fc):0}function $I(P,H){return P&&P.length?es(P,Ir(H,2)):0}return R.after=lh,R.ary=nA,R.assign=La,R.assignIn=$a,R.assignInWith=va,R.assignWith=Uo,R.at=oo,R.before=jA,R.bind=rA,R.bindAll=fI,R.bindKey=P0,R.castArray=m,R.chain=wd,R.chunk=ih,R.compact=PA,R.concat=kp,R.cond=dI,R.conforms=pI,R.constant=S1,R.countBy=Cd,R.create=ra,R.curry=Up,R.curryRight=zd,R.debounce=Rd,R.defaults=br,R.defaultsDeep=vo,R.defer=ZA,R.delay=Bl,R.difference=_0,R.differenceBy=DA,R.differenceWith=Mp,R.drop=hd,R.dropRight=Ad,R.dropRightWhile=zm,R.dropWhile=Rm,R.fill=Fm,R.filter=Df,R.flatMap=Md,R.flatMapDeep=bl,R.flatMapDepth=qA,R.flatten=fl,R.flattenDeep=y0,R.flattenDepth=v0,R.flip=Bc,R.flow=gI,R.flowRight=_I,R.fromPairs=Mc,R.functions=Gu,R.functionsIn=qu,R.groupBy=Pd,R.initial=zA,R.intersection=Cf,R.intersectionBy=Tf,R.intersectionWith=Su,R.invert=qp,R.invertBy=Fd,R.invokeMap=Np,R.iteratee=I1,R.keyBy=Dd,R.keys=lo,R.keysIn=xo,R.map=oh,R.mapKeys=Gf,R.mapValues=Hp,R.matches=yI,R.matchesProperty=vI,R.memoize=Mh,R.merge=Gm,R.mergeWith=jp,R.method=xI,R.methodOf=bI,R.mixin=E1,R.negate=QA,R.nthArg=SI,R.omit=qm,R.omitBy=Yl,R.once=WA,R.orderBy=Ld,R.over=II,R.overArgs=Rf,R.overEvery=EI,R.overSome=CI,R.partial=D0,R.partialRight=Ff,R.partition=cc,R.pick=Hu,R.pickBy=Ph,R.property=F2,R.propertyOf=TI,R.pull=FA,R.pullAll=nh,R.pullAllBy=OA,R.pullAllWith=b0,R.pullAt=Om,R.range=kI,R.rangeRight=MI,R.rearg=Of,R.reject=Bf,R.remove=dd,R.rest=Nf,R.reverse=kh,R.sampleSize=Vm,R.set=$l,R.setWith=ju,R.shuffle=Um,R.slice=Pc,R.sortBy=iA,R.sortedUniq=S0,R.sortedUniqBy=Mf,R.split=tI,R.spread=L0,R.tail=Yu,R.take=Dc,R.takeRight=tA,R.takeRightWhile=I0,R.takeWhile=Pp,R.tap=Fp,R.throttle=Vf,R.thru=UA,R.toArray=ia,R.toPairs=Hm,R.toPairsIn=Fg,R.toPath=zI,R.toPlainObject=na,R.transform=x1,R.unary=Uf,R.union=gd,R.unionBy=Pf,R.unionWith=NA,R.uniq=Dp,R.uniqBy=_d,R.uniqWith=yd,R.unset=b1,R.unzip=sh,R.unzipWith=vd,R.update=Iu,R.updateWith=Ac,R.values=Rc,R.valuesIn=ch,R.without=Lp,R.words=z2,R.wrap=Gp,R.xor=xd,R.xorBy=Bp,R.xorWith=VA,R.zip=ah,R.zipObject=zp,R.zipObjectDeep=Rp,R.zipWith=bd,R.entries=Hm,R.entriesIn=Fg,R.extend=$a,R.extendWith=va,E1(R,R),R.add=FI,R.attempt=R2,R.camelCase=U5,R.capitalize=L2,R.ceil=OI,R.clamp=qf,R.clone=h,R.cloneDeep=M,R.cloneDeepWith=q,R.cloneWith=x,R.conformsTo=K,R.deburr=B2,R.defaultTo=mI,R.divide=NI,R.endsWith=G5,R.eq=J,R.escape=q5,R.escapeRegExp=H5,R.every=T0,R.find=Td,R.findIndex=fd,R.findKey=nl,R.findLast=kd,R.findLastIndex=LA,R.findLastKey=rl,R.floor=VI,R.forEach=k0,R.forEachRight=M0,R.forIn=Pu,R.forInRight=Uu,R.forOwn=zl,R.forOwnRight=zc,R.get=Xl,R.gt=me,R.gte=Ce,R.has=uh,R.hasIn=sA,R.head=BA,R.identity=Fc,R.includes=Op,R.indexOf=Ef,R.inRange=Dh,R.invoke=Od,R.isArguments=Oe,R.isArray=f,R.isArrayBuffer=u,R.isArrayLike=p,R.isArrayLikeObject=S,R.isBoolean=L,R.isBuffer=U,R.isDate=Q,R.isElement=re,R.isEmpty=Ae,R.isEqual=_e,R.isEqualWith=Le,R.isError=qe,R.isFinite=et,R.isFunction=At,R.isInteger=_t,R.isLength=Mt,R.isMap=Kt,R.isMatch=Ht,R.isMatchWith=Zt,R.isNaN=ci,R.isNative=yi,R.isNil=xn,R.isNull=Xi,R.isNumber=on,R.isObject=Dt,R.isObjectLike=Bt,R.isPlainObject=an,R.isRegExp=An,R.isSafeInteger=zn,R.isSet=sn,R.isString=Wi,R.isSymbol=Dn,R.isTypedArray=Rn,R.isUndefined=pr,R.isWeakMap=Vr,R.isWeakSet=Hr,R.join=x0,R.kebabCase=j5,R.last=ku,R.lastIndexOf=Th,R.lowerCase=Z5,R.lowerFirst=Q5,R.lt=zs,R.lte=Ea,R.max=UI,R.maxBy=GI,R.mean=qI,R.meanBy=HI,R.min=jI,R.minBy=ZI,R.stubArray=T1,R.stubFalse=k1,R.stubObject=PI,R.stubString=DI,R.stubTrue=LI,R.multiply=QI,R.nth=RA,R.noConflict=wI,R.noop=C1,R.now=Do,R.pad=W5,R.padEnd=X5,R.padStart=Y5,R.parseInt=$5,R.random=V5,R.reduce=Bd,R.reduceRight=Lf,R.repeat=K5,R.replace=J5,R.result=hc,R.round=WI,R.runInContext=mi,R.sample=zf,R.size=Vp,R.snakeCase=eI,R.some=HA,R.sortedIndex=rh,R.sortedIndexBy=pd,R.sortedIndexOf=kf,R.sortedLastIndex=md,R.sortedLastIndexBy=Nm,R.sortedLastIndexOf=w0,R.startCase=iI,R.startsWith=nI,R.subtract=XI,R.sum=YI,R.sumBy=$I,R.template=rI,R.times=BI,R.toFinite=ns,R.toInteger=Wn,R.toLength=ws,R.toLower=sI,R.toNumber=ir,R.toSafeInteger=Ps,R.toString=Kn,R.toUpper=aI,R.trim=oI,R.trimEnd=lI,R.trimStart=uI,R.truncate=cI,R.unescape=hI,R.uniqueId=RI,R.upperCase=AI,R.upperFirst=w1,R.each=k0,R.eachRight=M0,R.first=BA,E1(R,function(){var P={};return yo(R,function(H,pe){rs.call(R.prototype,pe)||(P[pe]=H)}),P}(),{chain:!1}),R.VERSION=c,io(["bind","bindKey","curry","curryRight","partial","partialRight"],function(P){R[P].placeholder=R}),io(["drop","take"],function(P,H){we.prototype[P]=function(pe){pe=pe===n?1:_r(Wn(pe),0);var je=this.__filtered__&&!H?new we(this):this.clone();return je.__filtered__?je.__takeCount__=ds(pe,je.__takeCount__):je.__views__.push({size:ds(pe,Si),type:P+(je.__dir__<0?"Right":"")}),je},we.prototype[P+"Right"]=function(pe){return this.reverse()[P](pe).reverse()}}),io(["filter","map","takeWhile"],function(P,H){var pe=H+1,je=pe==$e||pe==st;we.prototype[P]=function(St){var qt=this.clone();return qt.__iteratees__.push({iteratee:Ir(St,3),type:pe}),qt.__filtered__=qt.__filtered__||je,qt}}),io(["head","last"],function(P,H){var pe="take"+(H?"Right":"");we.prototype[P]=function(){return this[pe](1).value()[0]}}),io(["initial","tail"],function(P,H){var pe="drop"+(H?"":"Right");we.prototype[P]=function(){return this.__filtered__?new we(this):this[pe](1)}}),we.prototype.compact=function(){return this.filter(Fc)},we.prototype.find=function(P){return this.filter(P).head()},we.prototype.findLast=function(P){return this.reverse().find(P)},we.prototype.invokeMap=ps(function(P,H){return typeof P=="function"?new we(this):this.map(function(pe){return Zl(pe,P,H)})}),we.prototype.reject=function(P){return this.filter(QA(Ir(P)))},we.prototype.slice=function(P,H){P=Wn(P);var pe=this;return pe.__filtered__&&(P>0||H<0)?new we(pe):(P<0?pe=pe.takeRight(-P):P&&(pe=pe.drop(P)),H!==n&&(H=Wn(H),pe=H<0?pe.dropRight(-H):pe.take(H-P)),pe)},we.prototype.takeRightWhile=function(P){return this.reverse().takeWhile(P).reverse()},we.prototype.toArray=function(){return this.take(Si)},yo(we.prototype,function(P,H){var pe=/^(?:filter|find|map|reject)|While$/.test(H),je=/^(?:head|last)$/.test(H),St=R[je?"take"+(H=="last"?"Right":""):H],qt=je||/^find/.test(H);St&&(R.prototype[H]=function(){var ui=this.__wrapped__,pi=je?[1]:arguments,Mi=ui instanceof we,un=pi[0],hn=Mi||f(ui),_n=function(sa){var da=St.apply(R,Xo([sa],pi));return je&&$n?da[0]:da};hn&&pe&&typeof un=="function"&&un.length!=1&&(Mi=hn=!1);var $n=this.__chain__,xr=!!this.__actions__.length,Wr=qt&&!$n,Hs=Mi&&!xr;if(!qt&&hn){ui=Hs?ui:new we(this);var Xr=P.apply(ui,pi);return Xr.__actions__.push({func:UA,args:[_n],thisArg:n}),new oe(Xr,$n)}return Wr&&Hs?P.apply(this,pi):(Xr=this.thru(_n),Wr?je?Xr.value()[0]:Xr.value():Xr)})}),io(["pop","push","shift","sort","splice","unshift"],function(P){var H=qs[P],pe=/^(?:push|sort|unshift)$/.test(P)?"tap":"thru",je=/^(?:pop|shift)$/.test(P);R.prototype[P]=function(){var St=arguments;if(je&&!this.__chain__){var qt=this.value();return H.apply(f(qt)?qt:[],St)}return this[pe](function(ui){return H.apply(f(ui)?ui:[],St)})}}),yo(we.prototype,function(P,H){var pe=R[H];if(pe){var je=pe.name+"";rs.call(xs,je)||(xs[je]=[]),xs[je].push({name:H,func:pe})}}),xs[Xh(n,lt).name]=[{name:"wrapper",func:n}],we.prototype.clone=We,we.prototype.reverse=vt,we.prototype.value=Ct,R.prototype.at=E0,R.prototype.chain=C0,R.prototype.commit=Lc,R.prototype.next=Sd,R.prototype.plant=GA,R.prototype.reverse=Id,R.prototype.toJSON=R.prototype.valueOf=R.prototype.value=Ed,R.prototype.first=R.prototype.head,Vl&&(R.prototype[Vl]=Mu),R},ro=gl();Ao?((Ao.exports=ro)._=ro,Il._=ro):Ls._=ro}).call(Jf)})(G_,G_.exports);var LR=G_.exports;function WS(e,t,n){let c=[e],g=[],b,I,a;for(;e=c.pop();)if(!(n&&n(e))&&(g.push(e),b=e.children,b))for(I=0,a=b.length;I<a;++I)c.push(b[I]);for(;e=g.pop();)t(e);return e}function BR(e,t,n){let c=[e],g,b;for(;e=c.pop();)if(!(n&&n(e))&&(t(e),g=e.children,g))for(b=g.length-1;b>=0;--b)c.push(g[b]);return e}function zR(e,t,n){let c,g=[e],b,I,a;do for(c=g.reverse(),g=[];e=c.pop();)if(!(n&&n(e))&&(t(e),b=e.children,b))for(I=0,a=b.length;I<a;++I)g.push(b[I]);while(g.length);return e}function RR(e){return WS(e,function(c){c.children&&(c.children[0].data.multiway_parent=c,c.children[1].data.multiway_parent=c.parent)}),LR.map(e.descendants(),c=>{let g=c.data.multiway_parent,b="unknown";return g&&(b=g.data.name),{source:c.data.multiway_parent,target:c,name:b}})}function FR(){let e=this.branch_length;return e?_v(this.nodes.descendants(),function(t){return!t.parent||!op(e(t))}):!1}function OR(){let e=this.branch_length;return mc(this.nodes.descendants(),t=>e(t))}function bv(e,t){let n=e.data;if("attribute"in n&&n.attribute&&n.attribute.length){t>0&&(n.attribute=String(t));let c=parseFloat(n.attribute);if(!isNaN(c))return Math.max(0,c)}if(n.name=="root")return 0;console.warn("Undefined branch length at "+n.name+"!")}function NR(e){return arguments.length?(this.branch_length_accessor=e||bv,this):this.branch_length_accessor}function VR(e){let t=this.branch_length,n=mc(this.nodes.descendants(),function(I){return t(I)?t(I):null});const c=_2(n),g=zS(n);let b=function(I){return(I-g)/(c-g)};return Zc(this.nodes.descendants(),I=>{let a=t(I);a&&t(I,b(a))}),this}function UR(e){let t=this.branch_length;return Zc(this.nodes.descendants(),n=>{let c=t(n);c&&t(n,e(c))}),this}function GR(e){return arguments.length?(this.nodeLabel=e,this):this.nodeLabel}function qR(e,t){if(!(e instanceof Yd))throw new Error("node needs to be an instance of a d3.hierarchy node!");let n=this.nodes.copy();if(t=t!==void 0?t:.5,e.parent){var c=Yd({name:"new_root"});c.children=[e.copy()],c.data.__mapped_bl=void 0,n.each(W=>{W.data.__mapped_bl=this.branch_length_accessor(W)}),this.setBranchLength(W=>W.data.__mapped_bl);let b=e,I=e.parent,a=void 0,G=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl*t;a=I.data.__mapped_bl,I.data.__mapped_bl=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl-G,e.data.__mapped_bl=G;var g;if(I.parent){for(c.children.push(I);I.parent;){g=I.children.indexOf(b),I.parent.parent?I.children.splice(g,1,I.parent):I.children.splice(g,1);let W=I.parent.data.__mapped_bl;W!==void 0&&(I.parent.data.__mapped_bl=a,a=W),b=I,I=I.parent}g=I.children.indexOf(b),I.children.splice(g,1)}else g=I.children.indexOf(b),I.children.splice(g,1),a=I.data.__mapped_bl,b=c;if(I.children.length==1)a&&(I.children[0].data.__mapped_bl+=a),b.children=b.children.concat(I.children);else{let W=new Yd({name:"__reroot_top_clade",__mapped_bl:a});xg(c.children[0],e),W.data.__mapped_bl=a,W.children=I.children.map(function(he){return he.parent=W,he}),W.parent=b,b.children.push(W)}}if(this.update(c),this.traverse_and_compute(b=>{Zc(b.children,I=>{I.parent=b})},"pre-order"),!op(this.display)){let b=this.display.options;dl(this.display.container).select("svg").remove();let I=this.display.selection_attribute_name;delete this.display;let a=this.render(b);a.selectionLabel(I),a.update(),dl(a.container).node().appendChild(a.show()),dl(this.display.container).dispatch("reroot")}return this}function HR(e,t){if(e=e||"attribute",t=t||"y_scaled","parent"in this){let n=parseFloat(this[e]);this[t]=this.parent[t]+(isNaN(n)?.1:n)}else this[t]=0;return this[t]}function jR(e){let t=[];for(;e;)t.push(e),e=e.parent;return t}const ZR=Object.freeze(Object.defineProperty({__proto__:null,pathToRoot:jR,reroot:qR,rootpath:HR},Symbol.toStringTag,{value:"Module"}));function t0(e){return e.y}function Kd(e){return e.x}function q_(e,t,n){return{x:n+e*Math.sin(t),y:n+e*Math.cos(t)}}function Xb(e,t,n,c,g,b){e.radius=t*(e.radius+n),e.angle=2*Math.PI*e.x*g[0]/b[0];let I=q_(e.radius,e.angle,c);return e.x=I.x,e.y=I.y,e}function Yb(e,t){var n=q_(t[0].radius,t[0].angle,e),c=q_(t[0].radius,t[1].angle,e);return"M "+t0(n)+","+Kd(n)+" A "+t[0].radius+","+t[0].radius+" 0,0, "+(t[1].angle>t[0].angle?1:0)+" "+t0(c)+","+Kd(c)+" L "+t0(t[1])+","+Kd(t[1])}function QR(e,t,n){var c=q_(e.target.radius+(e.source.radius-e.target.radius)*t,e.target.angle,n);return{x:t0(c),y:Kd(c)}}var $b=Av().x(function(e){return t0(e)}).y(function(e){return Kd(e)}).curve(Rz);function Kb(e,t){return{x:t0(e.target)+(t0(e.source)-t0(e.target))*t,y:Kd(e.target)}}function x2(e){return e.tag||!1}function b2(e,t){return e[t]||!1}const qo={"tree-container":"phylotree-container","tree-scale-bar":"tree-scale-bar",node:"node","internal-node":"internal-node","tagged-node":"node-tagged","selected-node":"node-selected","collapsed-node":"node-collapsed","root-node":"root-node",branch:"branch","selected-branch":"branch-selected","tagged-branch":"branch-tagged","tree-selection-brush":"tree-selection-brush","branch-tracer":"branch-tracer",clade:"clade",node_text:"phylotree-node-text"};function WR(e){return arguments.length?(this.options["internal-names"]=e,this):this.options["internal-names"]}function XR(e){return arguments.length?(this.options["is-radial"]=e,this):this.options["is-radial"]}function YR(e){return arguments.length?(this.options["align-tips"]=e,this):this.options["align-tips"]}function $R(e){return this.options["draw-size-bubbles"]&&this.options["bubble-styler"]?this.options["bubble-styler"](e):this.options["draw-size-bubbles"]?this.relative_nodeSpan(e)*this.scales[0]*.25:0}function KR(e){return this.options["is-radial"]?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function JR(e){return arguments.length?(this.layout_listener_handler=e,this):this.layout_listener_handler}function eF(e){return arguments.length?(this.selection_attribute_name=e,this.syncEdgeLabels(),this):this.selection_attribute_name}function c_(e){return arguments.length?(typeof e=="string"&&e=="equal"?c_=function(t){return 1}:c_=e,this):c_}var wv={all:e=>!0,none:e=>!1,"all-leaf-nodes":e=>Sl(e.target),"all-internal-nodes":e=>!Sl(e.target)};function tF(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const iF=Object.freeze(Object.defineProperty({__proto__:null,alignTips:YR,css_classes:qo,internalNames:WR,layoutHandler:JR,nodeBubbleSize:$R,get nodeSpan(){return c_},predefined_selecters:wv,radial:XR,selectionCallback:tF,selectionLabel:eF,shiftTip:KR},Symbol.toStringTag,{value:"Module"}));function nF(e){return this.radial()?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function rF(e,t,n){e=dl(e);var c=Sl(t);c&&(e=e.attr("data-node-name",t.data.name));var g=e.selectAll("text").data([t]),b=e.selectAll("line");if(c||this.showInternalName(t)&&!lp(t))if(g=g.enter().append("text").classed(this.css_classes.node_text,!0).merge(g).on("click",a=>{this.handle_node_click(t,a)}).attr("dy",a=>this.shown_font_size*.33).text(a=>this.options["show-labels"]?this._nodeLabel(a):"").style("font-size",a=>this.ensure_size_is_in_px(this.shown_font_size)),this.radial()?g=g.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)+this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)).attr("text-anchor",a=>a.text_align):g=g.attr("text-anchor","start").attr("transform",a=>this.options.layout=="right-to-left"?this.d3PhylotreeSvgTranslate([-20,0]):this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)),this.alignTips()?(b=b.data([t]),n?b=b.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(b).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("x2",0).attr("y1",0).attr("y2",0).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)):(b=b.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(b).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("y2",0).attr("y1",0).attr("x2",a=>this.shiftTip(a)[0]),b.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)))):b.remove(),this.options["draw-size-bubbles"]){var I=this.nodeBubbleSize(t);e.selectAll("circle").data([I]).enter().append("circle").attr("r",function(G){return G}),this.shown_font_size>=5&&(g=g.attr("dx",G=>(G.text_align=="end"?-1:1)*((this.alignTips()?0:I)+this.shown_font_size*.33)))}else this.shown_font_size>=5&&(g=g.attr("dx",a=>(a.text_align=="end"?-1:1)*this.shown_font_size*.33));if(!c){let a=e.selectAll("circle").data([t]).enter().append("circle"),G=this.node_circle_size()(t);G>0?a.merge(a).attr("r",W=>Math.min(this.shown_font_size*.75,G)).on("click",W=>{this.handle_node_click(t,W)}):a.remove()}return this.node_styler&&this.node_styler(e,t),t}function sF(){let e=this.phylotree.nodes.descendants();for(let t=e.length-1;t>=0;t-=1)Sl(e[t])?e[t].hasHiddenNodes=e[t].notshown:e[t].hasHiddenNodes=e[t].children.reduce(function(n,c){return c.notshown||n},!1);return this}function aF(e){const t=this.internalNames();return t?typeof t=="function"?t(e):t:!1}function oF(e){return arguments.length?(typeof e=="string"&&e=="equal"?this.nodeSpan=function(t){return 1}:this.nodeSpan=e,this):this.nodeSpan}function lF(e){let t=qo[Sl(e)?"node":"internal-node"];return x2(e)&&(t+=" "+qo["tagged-node"]),b2(e,this.selection_attribute_name)&&(t+=" "+qo["selected-node"]),e.parent||(t+=" "+qo["root-node"]),(lp(e)||w2(e))&&(t+=" "+qo["collapsed-node"]),t}function Sv(e){return!(e.hidden||e.notshown)}function XS(e){return e.notshown}function w2(e){return e.hasHiddenNodes||!1}function lp(e){return e.collapsed||!1}function YS(e){return[e.node,e["internal-node"],e["collapsed-node"],e["tagged-node"],e["root-node"]].reduce(function(t,n,c,g){return t+="g."+n+(c<g.length-1?",":"")},"")}function uF(e,t){this.phylotree.clearInternalNodes(t);for(var n=this.phylotree.nodes.descendants().length-1;n>=0;n--){var c=this.phylotree.nodes.descendants()[n];Sl(c)||b2(c,this.selection_attribute_name)||(c[this.selection_attribute_name]=e(c.children))}this.modifySelection((g,b)=>Sl(g.target)?g.target[this.selection_attribute_name]:g.target[this.selection_attribute_name])}function $S(e){return e=e.data,Sl(e)?e.name||"":this.showInternalName(e)?e.name:""}function cF(e){return arguments.length?(this._nodeLabel=e||$S,this.update(),this):this._nodeLabel}const hF=Object.freeze(Object.defineProperty({__proto__:null,defNodeLabel:$S,drawNode:rF,hasHiddenNodes:w2,internalLabel:uF,isNodeCollapsed:lp,nodeCssSelectors:YS,nodeLabel:cF,nodeNotshown:XS,nodeSpan:oF,nodeVisible:Sv,reclassNode:lF,shiftTip:nF,showInternalName:aF,updateHasHiddenNodes:sF},Symbol.toStringTag,{value:"Module"}));function KS(e){return[e.clade].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function AF(e){let t=this.svg.selectAll("."+this.css_classes["tree-container"]);var n=0;let c=t.selectAll(KS(this.css_classes)).data(this.phylotree.nodes.descendants().filter(lp),function(I){return I.id||(I.id=++n)}),g=function(){},b=void 0;this.radial()?(g=Av().curve(Fb).y(function(I){return I[0]}).x(function(I){return I[1]}),b=function(I,a,G,W,he){return a?[G.screen_y+(I[0]-W)/50,G.screen_x+(I[1]-he)/50]:[G.screen_y,G.screen_x]}):(g=Av().y(function(I){return I[0]}).x(function(I){return I[1]}).curve(Fb),b=function(I,a,G,W,he){return a?[G.screen_y+(I[0]-W)/50,G.screen_x+(I[1]-he)/50]:[G.screen_y,G.screen_x]}),c.exit().each(function(I){I.collapsed_clade=null}).remove(),e?c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(I){if(I.collapsed_clade)return I.collapsed_clade;let a=I.collapsed[0][0],G=I.collapsed[0][1];return g(I.collapsed.map(function(W,he){return b(W,he,I,a,G)}))}).attr("d",function(I){return I.collapsed_clade=g(I.collapsed)}):c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(I){return I.collapsed_clade?I.collapsed_clade:I.collapsed_clade=g(I.collapsed)})}const fF=Object.freeze(Object.defineProperty({__proto__:null,cladeCssSelectors:KS,updateCollapsedClades:AF},Symbol.toStringTag,{value:"Module"}));function dF(e,t,n){e=dl(e),e=e.attr("class",I=>this.reclassEdge(I)).on("click",I=>{this.modifySelection([t.target],this.selection_attribute_name),this.update()});let c=this.draw_branch([t.source,t.target]);n&&e.datum().existing_path&&(e=e.attr("d",function(I){return I.existing_path})),e=e.attr("d",c),t.existing_path=c;var g=this.phylotree.branch_length_accessor(t.target);if(g!==void 0){var b=e.selectAll("title");b.empty()&&(b=e.append("title")),b.text("Length = "+g)}else e.selectAll("title").remove();return this.edge_styler&&this.edge_styler(e,t,n),this.phylotree}function pF(e){let t=qo.branch;return x2(e)&&(t+=" "+qo["tagged-branch"]),b2(e,this.selection_attribute_name)&&(t+=" "+qo["selected-branch"]),t}function mF(){this.links.forEach(e=>{e.target.data.annotation&&(e.target[e.target.data.annotation]=e.target.data.annotation)})}function gF(){if(this.links.forEach(e=>{e[this.selection_attribute_name]=e.target[this.selection_attribute_name]||!1,e.tag=e.target.tag||!1}),this.countHandler()){let e={};e[this.selection_attribute_name]=this.links.reduce((t,n)=>t+(n[this.selection_attribute_name]?1:0),0),e.tagged=this.links.reduce(function(t,n){return t+(x2(n)?1:0)},0),this.countUpdate(this,e,this.countHandler())}}function Iv(e){return!(e.target.hidden||e.target.notshown)}function Ev(e){return[e.branch,e["selected-branch"],e["tagged-branch"]].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function _F(e,t){return this.edge_placer(e,t)}const yF=Object.freeze(Object.defineProperty({__proto__:null,drawEdge:dF,edgeCssSelectors:Ev,edgeVisible:Iv,initializeEdgeLabels:mF,placeAlongAnEdge:_F,reclassEdge:pF,syncEdgeLabels:gF},Symbol.toStringTag,{value:"Module"}));let c1="phylotree.event";function vF(e){if(e.collapsed){e.collapsed=!1;let t=function(n){Sl(n)||n.collapsed||n.children.forEach(t),n.hidden=!1};t(e)}else e.collapsed=!0;return this.placenodes(),this}function xF(e,t,n){let c=this.size;if(this.radial()){let g=this.pad_width(),b=this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0;c=[c[1]+2*g,c[0]+2*g+b],t&&t.selectAll("."+qo["tree-container"]).attr("transform","translate ("+g+","+(g+b)+")")}else c=[c[0]+(this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0),c[1]+(this.options["left-right-spacing"]!="fit-to-size"?this.pad_width():0)];return t&&(n&&(t=t.transition(100)),t.attr("height",c[0]).attr("width",c[1])),this.size=c,c}function bF(e,t){t=t||"y_scaled",t in this&&(this[t]*=e)}function Cv(e){var t=new CustomEvent(c1,{detail:["refresh",e]});document.dispatchEvent(t)}function JS(e,t){var n=new CustomEvent(c1,{detail:["countUpdate",t,e.countHandler()]});document.dispatchEvent(n)}function wF(e){var t=new CustomEvent(c1,{detail:["layout",e,e.layoutHandler()]});document.dispatchEvent(t)}function e5(e){switch(e.detail[0]){case"refresh":e.detail[1].refresh();break;case"countUpdate":e.detail[2](e.detail[1]);break;case"layout":e.detail[2](e.detail[1])}return!0}function t5(){document.addEventListener(c1,e5,!1)}function SF(e){return e&&(e[0]!==null||e[1]!==null)?"translate ("+(e[0]!==null?e[0]:0)+","+(e[1]!==null?e[1]:0)+") ":""}function IF(e){return e!==null?"rotate ("+e+") ":""}const EF=Object.freeze(Object.defineProperty({__proto__:null,countUpdate:JS,d3PhylotreeAddEventListener:t5,d3PhylotreeEventListener:e5,d3PhylotreeSvgRotate:IF,d3PhylotreeSvgTranslate:SF,d3PhylotreeTriggerLayout:wF,rescale:bF,resizeSvg:xF,toggleCollapse:vF,triggerRefresh:Cv},Symbol.toStringTag,{value:"Module"}));let Jb="d3_layout_phylotree_context_menu";function CF(e,t,n,c,g){let b=dl(t).select("#"+Jb);if(b.empty()&&(b=dl(t).append("div").attr("id",Jb).attr("class","dropdown-menu").attr("role","menu")),b.selectAll("a").remove(),b.selectAll("h6").remove(),b.selectAll("div").remove(),e){if(!U_([!!e.menu_items,c.hide,c.selectable,c.collapsible])||!c["show-menu"])return;Sl(e)||(c.collapsible&&(b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(lp(e)?"Expand Subtree":"Collapse Subtree").on("click",W=>{b.style("display","none"),this.toggleCollapse(e).update()}),c.selectable&&(b.append("div").attr("class","dropdown-divider"),b.append("h6").attr("class","dropdown-header").text("Toggle selection"))),c.selectable&&(b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All descendant branches").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0))}),b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All terminal branches").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!1))}),b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All internal branches").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!1,!0))}))),e.parent&&(c.selectable&&(b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Incident branch").on("click",function(W){b.style("display","none"),n.modifySelection([e])}),b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Path to root").on("click",W=>{b.style("display","none"),this.modifySelection(this.phylotree.pathToRoot(e))}),(c.reroot||c.hide)&&b.append("div").attr("class","dropdown-divider")),c.reroot&&b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Reroot on this node").on("click",W=>{b.style("display","none"),this.phylotree.reroot(e),this.update()}),c.hide&&b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Hide this "+(Sl(e)?"node":"subtree")).on("click",W=>{b.style("display","none"),this.modifySelection([e],"notshown",!0,!0).updateHasHiddenNodes().update()})),w2(e)&&b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Show all descendant nodes").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0),"notshown",!0,!0,"false").updateHasHiddenNodes().update()});var I=[];if("menu_items"in e&&typeof e.menu_items=="object"&&e.menu_items.forEach(function(W){W.length==3&&(!W[2]||W[2](e))&&I.push([W[0],W[1]])}),I.length){const W=[c.hide,c.selectable,c.collapsible];U_(W)&&b.append("div").attr("class","dropdown-divider"),I.forEach(function(he){b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(he[0](e)).on("click",nf(he[1],e))})}let G=document.querySelector(t).getBoundingClientRect();b.style("position","absolute").style("left",""+(g.clientX-G.x+12)+"px").style("top",""+(g.clientY-G.y)+"px").style("display","block")}else b.style("display","none")}function TF(e,t,n,c){"menu_items"in e||(e.menu_items=[]),e.menu_items.some(function(g){return g[0]==t&&g[1]==n&&g[2]==c})||e.menu_items.push([t,n,c])}function kF(e,t,n,c,g){if(t=t||this.selection_attribute_name,g=g||"toggle",this.options["restricted-selectable"].length)if(JA(pu(wv),e))e=wv[e];else return;if((this.options["restricted-selectable"]||this.options.selectable)&&!this.options["binary-selectable"]){var b=!1;typeof e=="function"?this.links.forEach(function(a){let G=e(a);a[t]=a[t]||!1,a[t]!=G&&(a[t]=G,b=!0,a.target[t]=G)}):(e.forEach(function(a){var G;switch(g){case"true":G=!0;break;case"false":G=!1;break;default:G=!a[t];break}a[t]!=G&&(a[t]=G,b=!0)}),this.links.forEach(function(a){a[t]=a.target[t]}));var I;b&&(c||Cv(this),this.countHandler&&(I={},I[t]=this.links.reduce(function(a,G){return a+(G[t]?1:0)},0),JS(this,I,this.countHandler)),n&&this.placenodes())}else this.options["binary-selectable"]&&(typeof e=="function"?this.links.forEach(function(a){var G=e(a);a[t]=a[t]||!1,a[t]!=G&&(a[t]=G,b=!0,a.target[t]=G),this.options["attribute-list"].forEach(function(W){W!=t&&a[t]===!0&&(a[W]=!1,a.target[W]=!1)})}):(e.forEach(function(a){var G;G=!a[t],a[t]!=G&&(a[t]=G,b=!0)}),this.links.forEach(function(a){a[t]=a.target[t],this.options["attribute-list"].forEach(function(G){G!=t&&a[t]!==!0&&(a[G]=!1,a.target[G]=!1)})})),b&&(c||Cv(this),this.countHandler()&&(I={},I[t]=this.links.reduce(function(a,G){return a+(G[t]?1:0)},0),this.countUpdate(this,I,this.countHandler())),n&&this.placenodes()));return this.selectionCallback&&t!="tag"&&this.selectionCallback(this.getSelection()),this.refresh(),this.update(),this}function MF(){return this.nodes.filter(e=>e[this.selection_attribute_name])}function PF(e,t,n){let c=[];function g(b){Sl(b)?t&&b!=e&&c.push(b):(n&&b!=e&&c.push(b),b.children.forEach(g))}return g(e),c}function DF(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const LF=Object.freeze(Object.defineProperty({__proto__:null,addCustomMenu:TF,getSelection:MF,modifySelection:kF,nodeDropdownMenu:CF,selectAllDescendants:PF,selectionCallback:DF},Symbol.toStringTag,{value:"Module"}));function ew(e){return function(){return e}}class gp{constructor(t,n={}){this.css_classes=qo,this.phylotree=t,this.container=n.container,this.separation=function(g,b){return 0},this._nodeLabel=this.defNodeLabel,this.svg=null,this.selectionCallback=null,this.scales=[1,1],this.size=[1,1],this.fixed_width=[14,30],this.scale_bar_font_size=12,this.draw_branch=$b,this.draw_scale_bar=null,this.edge_placer=Kb,this.count_listener_handler=function(){},this.layout_listener_handler=function(){},this.node_styler=void 0,this.edge_styler=void 0,this.selection_attribute_name="selected",this.right_most_leaf=0,this.label_width=0,this.radial_center=0,this.radius=1,this.radius_pad_for_bubbles=0,this.rescale_nodeSpan=1,this.relative_nodeSpan=function(g){return this.nodeSpan(g)/this.rescale_nodeSpan};let c={layout:"left-to-right",logger:console,branches:"step",scaling:!0,bootstrap:!1,"color-fill":!0,"font-size":14,"internal-names":!1,selectable:!0,"restricted-selectable":!1,collapsible:!0,"left-right-spacing":"fixed-step","top-bottom-spacing":"fixed-step","left-offset":0,"show-scale":"top","draw-size-bubbles":!1,"bubble-styler":this.radius_pad_for_bubbles,"binary-selectable":!1,"is-radial":!1,"attribute-list":[],"max-radius":768,"annular-limit":.38196601125010515,compression:.2,"align-tips":!1,"maximum-per-node-spacing":100,"minimum-per-node-spacing":2,"maximum-per-level-spacing":100,"minimum-per-level-spacing":10,node_circle_size:ew(3),transitions:null,brush:!0,reroot:!0,hide:!0,"label-nodes-with-name":!1,zoom:!1,"show-menu":!0,"show-labels":!0,"node-styler":null,"edge-styler":null,"node-span":null};this.ensure_size_is_in_px=function(g){return typeof g=="number"?g+"px":g},this.options=h2(n,c),this.font_size=this.options["font-size"],this.offsets=[0,this.font_size/2],this.shown_font_size=this.font_size,this.width=this.options.width||800,this.height=this.options.height||600,this.node_styler=this.options["node-styler"],this.edge_styler=this.options["edge-styler"],this.nodeSpan=this.options["node-span"],this.nodeSpan||(this.nodeSpan=function(g){return 1}),this.rescale_nodeSpan=this.phylotree.nodes.children.map(g=>{if(Sl(g)||this.showInternalName(g))return this.nodeSpan(g)}).reduce(function(g,b){return Math.min(b,g||1e200)},null)||1,this.initialize_svg(this.container),this.links=this.phylotree.nodes.links(),this.initializeEdgeLabels(),this.update(),t5()}pad_height(){return this.draw_scale_bar?this.scale_bar_font_size+25:0}pad_width(){this.label_width=this._label_width(this.shown_font_size);const t=this.options["show-labels"]?this.label_width:0;return this.offsets[1]+this.options["left-offset"]+t}collapse_node(t){lp(t)||(t.collapsed=!0)}set_size(t){if(!arguments.length)return this.size;let n=t;return this.options["top-bottom-spacing"]!="fixed-step"&&(this.size[0]=n[0]),this.options["left-right-spacing"]!="fixed-step"&&(this.size[1]=n[1]),this}initialize_svg(t){return this.svg!==t&&(dl(t).select("svg").remove(),this.svg=LD("svg").attr("width",this.width).attr("height",this.height),this.set_size([this.height,this.width]),this.css_classes["tree-container"]=="phylotree-container"&&(this.svg.selectAll("*").remove(),this.svg.append("defs")),dl(this.container).on("click",n=>{this.handle_node_click(null)},!0)),this}update_layout(t,n){n&&(this.nodes=Yd(t),this.nodes.each(function(c){c.id=null})),this.update(),this.syncEdgeLabels()}update(t){var n=this;this.placenodes(),t=this.transitions(t);let c=0,g=this.svg.selectAll("."+qo["tree-container"]).data([0]);if(g=g.enter().append("g").attr("class",qo["tree-container"]).merge(g).attr("transform",W=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()])),this.draw_scale_bar){let W=this.svg.selectAll("."+qo["tree-scale-bar"]).data([0]);W.enter().append("g").attr("class",qo["tree-scale-bar"]).style("font-size",this.ensure_size_is_in_px(this.scale_bar_font_size)).merge(W).attr("transform",he=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()-10])).call(this.draw_scale_bar),W.selectAll("text").style("text-anchor","end")}else this.svg.selectAll("."+qo["tree-scale-bar"]).remove();g=this.svg.selectAll("."+qo["tree-container"]).data([0]),this.updateCollapsedClades(t);let b=g.selectAll(Ev(qo)).data(this.links.filter(Iv),W=>W.target.id||(W.target.id=++c));b.exit().remove(),b=b.enter().insert("path",":first-child").merge(b).each(function(W){n.drawEdge(this,W,t)});let I=g.selectAll(YS(qo)).data(this.phylotree.nodes.descendants().filter(Sv),W=>W.id||(W.id=++c));if(I.exit().remove(),I=I.enter().append("g").attr("class",this.reclassNode).merge(I).attr("transform",W=>{const he=this.options.layout=="right-to-left"&&Sl(W);return W.screen_x=t0(W),W.screen_y=Kd(W),this.d3PhylotreeSvgTranslate([he?0:W.screen_x,W.screen_y])}).each(function(W){n.drawNode(this,W,t)}).attr("transform",W=>{if(!op(W.screen_x)&&!op(W.screen_y))return"translate("+W.screen_x+","+W.screen_y+")"}),this.options["label-nodes-with-name"]&&(I=I.attr("id",W=>"node-"+W.name)),this.resizeSvg(this.phylotree,this.svg,t),this.options.brush){var a=g.selectAll("."+qo["tree-selection-brush"]).data([0]).enter().insert("g",":first-child").attr("class",qo["tree-selection-brush"]),G=MB().on("brush",(W,he)=>{var ae=W.selection,ue=this.links.filter(Iv),be=ue.filter((Ke,ot)=>Ke.source.screen_x>=ae[0][0]&&Ke.source.screen_x<=ae[1][0]&&Ke.source.screen_y>=ae[0][1]&&Ke.source.screen_y<=ae[1][1]&&Ke.target.screen_x>=ae[0][0]&&Ke.target.screen_x<=ae[1][0]&&Ke.target.screen_y>=ae[0][1]&&Ke.target.screen_y<=ae[1][1]).map(Ke=>Ke.target);this.modifySelection(this.phylotree.links.map(Ke=>Ke.target),"tag",!1,be.length>0,"false"),this.modifySelection(be,"tag",!1,!1,"true")}).on("end",()=>{});a.call(G)}if(this.syncEdgeLabels(),this.options.zoom){let W=qz().scaleExtent([.1,10]).on("zoom",he=>{dl("."+qo["tree-container"]).attr("transform",ae=>he.transform),dl("."+qo["tree-scale-bar"]).attr("transform",ae=>{let ue=he.transform;return ue.y-=10,ue})});this.svg.call(W)}return this}_handle_single_node_layout(t){let n=this.nodeSpan(t)/this.rescale_nodeSpan;this.x=t.x=this.x+this.separation(this.last_node,t)+(this.last_span+n)*.5,this._extents[1][1]=Math.max(this._extents[1][1],t.y),this._extents[1][0]=Math.min(this._extents[1][0],t.y-n*.5),this.is_under_collapsed_parent?this._extents[0][1]=Math.max(this._extents[0][1],this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span+(n*.5+this.separation(this.last_node,t))*this.options.compression):this._extents[0][1]=Math.max(this._extents[0][1],this.x+n*.5+this.separation(this.last_node,t)),this.last_node=t,this.last_span=n}tree_layout(t){if(XS(t))return;let n=Sl(t);t.text_angle=null,t.text_align=null,t.radius=null,t.angle=null;let c=!1;if(t.parent)if(this.do_scaling){if(c)return 0;if(t.y=this.phylotree.branch_length_accessor(t),typeof t.y>"u")return c=!0,0;t.y+=t.parent.y}else t.y=n?this.max_depth:t.depth;else this.x=0,t.y=0,this.last_node=null,this.last_span=0,this._extents=[[0,0],[0,0]];if(n&&this._handle_single_node_layout(t),!n)if(lp(t)&&!this.is_under_collapsed_parent){if(this.save_x=this.x,this.save_span=this.last_span*.5,this.is_under_collapsed_parent=!0,this.process_internal_node(t),this.is_under_collapsed_parent=!1,typeof t.x=="number"){t.x=this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span,t.collapsed=[[t.x,t.y]];var g=b=>{b.hidden=!0,Sl(b)?(this.x=b.x=this.save_x+(b.x-this.save_x)*this.options.compression+this.save_span,t.collapsed.push([b.x,b.y])):b.children.map(g)};this.x=this.save_x,g(t),t.collapsed.splice(1,0,[this.save_x,t.y]),t.collapsed.push([this.x,t.y]),t.collapsed.push([t.x,t.y]),t.hidden=!1}}else this.process_internal_node(t);return t.x}process_internal_node(t){let n=0;if(this.showInternalName(t)){let c=t.children.length/2>>0,g=0,b=!1;for(let I=0;I<t.children.length;I++)typeof this.tree_layout(t.children[I])=="number"&&g++,g>=c&&!b&&(this._handle_single_node_layout(t),b=!0);g==0?(t.notshown=!0,t.x=void 0):b||this._handle_single_node_layout(t)}else t.x=t.children.map(this.tree_layout.bind(this)).reduce((c,g)=>typeof g=="number"?c+g:(n+=1,c),0),n==t.children.length?(t.notshown=!0,t.x=void 0):t.x/=t.children.length-n}do_lr(t){if(this.radial()&&t&&(this.offsets[1]=0),this.options["left-right-spacing"]=="fixed-step")this.size[1]=this.max_depth*this.fixed_width[1],this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"])/this._extents[1][1],this.label_width=this._label_width(this.shown_font_size),this.radial()&&(this.label_width*=2);else{this.label_width=this._label_width(this.shown_font_size),t=!0;let n=this.size[1]-this.offsets[1]-this.options["left-offset"];n*.5<this.label_width&&(this.shown_font_size*=n*.5/this.label_width,this.label_width=n*.5),this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"]-this.label_width)/this._extents[1][1]}}placenodes(){this._extents=[[0,0],[0,0]],this.x=0,this.last_span=0,this.last_node=null,this.last_span=0,this.save_x=this.x,this.save_span=this.last_span*.5,this.do_scaling=this.options.scaling;let t=!1;this.is_under_collapsed_parent=!1,this.max_depth=1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes,this.do_scaling),this.max_depth=jM(this.phylotree.nodes.descendants(),c=>c.depth),this.do_scaling&&t&&(this.do_scaling=!1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes));let n=!1;if(this.draw_scale_bar=this.options["show-scale"]&&this.do_scaling,this.offsets[1]=Math.max(this.font_size,-this._extents[1][0]*this.fixed_width[0]),this.options["top-bottom-spacing"]=="fixed-step"?(this.size[0]=this._extents[0][1]*this.fixed_width[0],this.scales[0]=this.fixed_width[0]):(this.scales[0]=(this.size[0]-this.pad_height())/this._extents[0][1],n=!0),this.shown_font_size=Math.min(this.font_size,this.scales[0]),this.radial()){this.draw_branch=nf(Yb,this.radial_center),this.edge_placer=QR;let c=null,g=null,b=null,I=0,a=this._extents[0][1]*this.scales[0],G=function(ue,be,Ke,ot,tt){return tt=tt||0,Math.sqrt((be-ue)*(be-ue)+2*(ue+tt)*(be+tt)*(1-Math.cos(Ke-ot)))},W=0;this.phylotree.nodes.each(ue=>{let be=ue.x*this.scales[0];ue.angle=2*Math.PI*be/a,ue.text_angle=ue.angle-Math.PI/2,ue.text_angle=ue.text_angle>0&&ue.text_angle<Math.PI,ue.text_align=ue.text_angle?"end":"start",ue.text_angle=(ue.text_angle?180:0)+ue.angle*180/Math.PI}),this.do_lr(n),this.phylotree.nodes.each(ue=>{ue.radius=ue.y*this.scales[1]/this.size[1],W=Math.max(ue.radius,W)});let he=0;this.phylotree.nodes.each(ue=>{if(!ue.children){let be=ue.x*this.scales[0];if(c!==null){let Ke=be-g,ot=G(ue.radius,b,ue.angle,c,he),tt=ot>0?Ke/ot:10*this.options["max-radius"];if(tt>this.options["max-radius"]){let lt=Ke/this.options["max-radius"],ut=ue.radius+b,Tt=ue.radius*b-(lt*lt-(b-ue.radius)*(b-ue.radius))/2/(1-Math.cos(c-ue.angle)),Pt=Math.sqrt(ut*ut-4*Tt);he=Math.min(this.options["annular-limit"]*W,(-ut+Pt)/2),I=this.options["max-radius"]}else I=Math.max(I,tt)}c=ue.angle,g=be,b=ue.radius}}),this.radius=Math.min(this.options["max-radius"],Math.max(a/2/Math.PI,I)),n&&(this.radius=Math.min(this.radius,(Math.min(a,this._extents[1][1]*this.scales[1])-this.label_width)*.5-this.radius*he)),this.radial_center=this.radius_pad_for_bubbles=this.radius,this.draw_branch=nf(Yb,this.radial_center);let ae=1;he&&(ae=W/(W+he),this.radius*=ae),this.phylotree.nodes.each(ue=>{if(Xb(ue,this.radius,he,this.radial_center,this.scales,this.size),W=Math.max(W,ue.radius),this.options["draw-size-bubbles"]?this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ue.radius+this.nodeBubbleSize(ue)):this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,ue.radius),ue.collapsed){ue.collapsed=ue.collapsed.map(Ke=>{let ot={};return ot.x=Ke[0],ot.y=Ke[1],ot=Xb(ot,this.radius,he,this.radial_center,this.scales,this.size),[ot.x,ot.y]});let be=ue.collapsed[1];ue.collapsed=ue.collapsed.filter(function(Ke,ot){return ot<3||ot>ue.collapsed.length-4?!0:Math.sqrt(Math.pow(Ke[0]-be[0],2)+Math.pow(Ke[1]-be[1],2))>3?(be=Ke,!0):!1})}}),this.size[0]=this.radial_center+this.radius/ae,this.size[1]=this.radial_center+this.radius/ae}else this.do_lr(),this.draw_branch=$b,this.edge_placer=Kb,this.right_most_leaf=0,this.phylotree.nodes.each(c=>{if(c.x*=this.scales[0],c.y*=this.scales[1]*.8,this.options.layout=="right-to-left"&&(c.y=this._extents[1][1]*this.scales[1]-c.y),Sl(c)&&(this.right_most_leaf=Math.max(this.right_most_leaf,c.y+this.nodeBubbleSize(c))),c.collapsed){c.collapsed.forEach(b=>{b[0]*=this.scales[0],b[1]*=this.scales[1]*.8});let g=c.collapsed[1][0];c.collapsed=c.collapsed.filter(function(b,I){return I<3||I>c.collapsed.length-4?!0:b[0]-g>3?(g=b[0],!0):!1})}});if(this.draw_scale_bar){let c,g;if(this.radial()){if(g=Math.min(this.radius/5,50),c=Math.pow(10,Math.ceil(Math.log(this._extents[1][1]*g/this.radius)/Math.log(10))),g=c*(this.radius/this._extents[1][1]),g<30){let a=Math.ceil(30/g);g*=a,c*=a}}else c=this._extents[1][1],g=this.size[1]-this.offsets[1]-this.options["left-offset"]-this.shown_font_size;let b=L4().domain([0,c]).range([0,g]),I=Jv(".2f");if(this.draw_scale_bar=JM().scale(b).tickFormat(function(a){return a===0?"":I(a)}),this.radial())this.draw_scale_bar.tickValues([c]);else{let a=function(W,he){return he?Math.round(W*(he=Math.pow(10,he)))/he:Math.round(W)},G=b.ticks();G=G.length>1?G[1]:G[0],this.draw_scale_bar.ticks(Math.min(10,a(g/(this.shown_font_size*I(G).length*2),0)))}}else this.draw_scale_bar=null;return this}spacing_x(t,n){return arguments.length?(this.fixed_width[0]!=t&&t>=this.options["minimum-per-node-spacing"]&&t<=this.options["maximum-per-node-spacing"]&&(this.fixed_width[0]=t,n||this.placenodes()),this):this.fixed_width[0]}spacing_y(t,n){return arguments.length?(this.fixed_width[1]!=t&&t>=this.options["minimum-per-level-spacing"]&&t<=this.options["maximum-per-level-spacing"]&&(this.fixed_width[1]=t,n||this.placenodes()),this):this.fixed_width[1]}_label_width(t){t=t||this.shown_font_size;let n=0;return this.phylotree.nodes.descendants().filter(Sv).forEach(c=>{let g=12+this._nodeLabel(c).length*t*.8;c.angle!==null&&(g*=Math.max(Math.abs(Math.cos(c.angle)),Math.abs(Math.sin(c.angle)))),n=Math.max(g,n)}),n}font_size(t){return arguments.length?(this.font_size=t===void 0?12:t,this):this.font_size}scale_bar_font_size(t){return arguments.length?(this.scale_bar_font_size=t===void 0?12:t,this):this.scale_bar_font_size}node_circle_size(t,n){return arguments.length?(this.options.node_circle_size=ew(t===void 0?3:t),this):this.options.node_circle_size}css(t){if(arguments.length===0)return this.css_classes;if(arguments.length>2){var n={};return n[t[0]]=t[1],this.css(n)}for(var c in qo)c in t&&t[c]!=qo[c]&&(qo[c]=t[c]);return this}transitions(t){return t!==void 0?t:this.options.transitions!==null?this.options.transitions:this.phylotree.nodes.descendants().length<=300}css_classes(t,n){if(!arguments.length)return this.css_classes;let c=!1;for(var g in qo)g in t&&t[g]!=this.css_classes[g]&&(c=!0,this.css_classes[g]=t[g]);return n&&c&&this.layout(),this}layout(t){return this.svg?(this.svg.selectAll("."+this.css_classes["tree-container"]+",."+this.css_classes["tree-scale-bar"]+",."+this.css_classes["tree-selection-brush"]),this.d3PhylotreeTriggerLayout(this),this.update()):(this.d3PhylotreeTriggerLayout(this),this)}handle_node_click(t,n){this.nodeDropdownMenu(t,this.container,this,this.options,n)}refresh(){if(this.svg){let n=this.svg.selectAll("."+this.css_classes["tree-container"]).selectAll(Ev(this.css_classes)).attr("class",this.reclassEdge.bind(this));this.edge_styler&&n.each(c=>{this.edge_styler(dl(this),c)})}return this}countHandler(t){return arguments.length?(this.count_listener_handler=t,this):this.count_listener_handler}style_nodes(t){return arguments.length?(this.node_styler=t,this):this.node_styler}style_edges(t){return arguments.length?(this.edge_styler=t.bind(this),this):this.edge_styler}itemSelected(t,n){return t[n]||!1}show(){return this.svg.node()}}fA(gp.prototype,fF);fA(gp.prototype,hF);fA(gp.prototype,yF);fA(gp.prototype,EF);fA(gp.prototype,LF);fA(gp.prototype,iF);function BF(e,t,n){return this.nodes.sum(function(c){return c.value}).sort(e),this.display&&(this.display.update_layout(this.nodes),this.display.update()),this}function zF(e){var t;return e=e.map(function(n){return typeof n=="string"?n:n.data.name}),this.traverse_and_compute(function(n){n.children?n.parent?(n.data.mrca=GS(...n.descendants().map(c=>c.data.mrca)),!t&&n.data.mrca.length==e.length&&(t=n)):t||(t=n):n.data.mrca=qS([n.data.name],e)}),t}let zu=class{constructor(e,t={}){this.newick_string="",this.nodes=[],this.links=[],this.parsed_tags=[],this.partitions=[],this.branch_length_accessor=bv,this.branch_length=bv,this.logger=t.logger||console,this.selection_attribute_name="selected";var n=t.type||void 0,c=[],g=this;if(a1(n))n in sy?c=sy[n](e,t):g.logger.error("type "+n+" not in registry! Available types are "+pu(sy));else if(tc(n))try{c=n(e,t)}catch{g.logger.error("Could not parse custom format!")}else e.name=="root"?c={json:e,error:null}:typeof e!="string"?c=e:e.contentType=="application/xml"?c=QS(e):(this.newick_string=e,c=Sg(e,t));if(!c.json)g.nodes=[];else{g.nodes=Yd(c.json);let b={};g.nodes.each(I=>{I.data.annotation&&(b[I.data.annotation]=!0)}),g.parsed_tags=Object.keys(b)}return g.links=g.nodes.links(),this.hasBranchLengths()||(console.warn("Phylotree User Warning : NO BRANCH LENGTHS DETECTED, SETTING ALL LENGTHS TO 1"),this.setBranchLength(b=>1)),g}json(e){var t=0;this.traverse_and_compute(function(c){c.json_export_index=t++},e);var n=new Array(t);return t=0,this.traverse_and_compute(function(c){let g=pS(c);delete g.json_export_index,c.parent&&(g.parent=c.parent.json_export_index),c.children&&(g.children=mc(c.children,function(b){return b.json_export_index})),n[t++]=g},e),this.traverse_and_compute(function(c){delete c.json_export_index},e),JSON.stringify(n)}traverse_and_compute(e,t,n,c){t=t||"post-order";function g(a){op(a)||WS(a,e,c)}function b(a){BR(a,e,c)}function I(a){zR(a,e,c)}return t=="pre-order"?t=b:t=="in-order"?t=I:t=g,t(n||this.nodes),this}get_parsed_tags(){return this.parsed_tags}update(e){this.nodes=e}render(e){return this.display=new gp(this,e),this.display}};zu.prototype.isLeafNode=Sl;zu.prototype.selectAllDescendants=jS;zu.prototype.mrca=zF;zu.prototype.hasBranchLengths=FR;zu.prototype.getBranchLengths=OR;zu.prototype.branchName=GR;zu.prototype.normalizeBranchLengths=VR;zu.prototype.scaleBranchLengths=UR;zu.prototype.getNewick=ER;zu.prototype.resortChildren=BF;zu.prototype.setBranchLength=NR;zu.prototype.maxParsimony=DR;zu.prototype.getTipLengths=PR;zu.prototype.leftChildRightSibling=RR;fA(zu.prototype,IR);fA(zu.prototype,ZR);fA(zu.prototype,kR);U4("%Y%m%d");function RF(e){let t,n,c="Taxa found in this area",g,b,I,a,G,W,he;return{c(){t=Nn("div"),n=Nn("h2"),n.textContent=c,g=Cr(),b=Nn("div"),I=Nn("div"),a=Nn("span"),G=Ja(e[4]),this.h()},l(ae){t=Vn(ae,"DIV",{class:!0});var ue=bn(t);n=Vn(ue,"H2",{class:!0,"data-svelte-h":!0}),dc(n)!=="svelte-bg4wlc"&&(n.textContent=c),g=Tr(ue),b=Vn(ue,"DIV",{id:!0,class:!0});var be=bn(b);I=Vn(be,"DIV",{class:!0,style:!0});var Ke=bn(I);a=Vn(Ke,"SPAN",{class:!0});var ot=bn(a);G=eo(ot,e[4]),ot.forEach(bi),Ke.forEach(bi),be.forEach(bi),ue.forEach(bi),this.h()},h(){Pi(n,"class","svelte-vxmxuk"),Pi(a,"class","svelte-vxmxuk"),Pi(I,"class",W=Jd(`tree_tooltip ${e[3]?"shown":"hidden"} ${e[5]?"flip":""}`)+" svelte-vxmxuk"),Pi(I,"style",he=`margin-top: calc(${e[2]}px - 2rem); left: ${e[1]}px;`),Pi(b,"id","tree_container"),Pi(b,"class","svelte-vxmxuk"),Pi(t,"class","phylo-container svelte-vxmxuk")},m(ae,ue){Gn(ae,t,ue),Zi(t,n),Zi(t,g),Zi(t,b),Zi(b,I),Zi(I,a),Zi(a,G),e[10](b)},p(ae,[ue]){ue&16&&tu(G,ae[4]),ue&40&&W!==(W=Jd(`tree_tooltip ${ae[3]?"shown":"hidden"} ${ae[5]?"flip":""}`)+" svelte-vxmxuk")&&Pi(I,"class",W),ue&6&&he!==(he=`margin-top: calc(${ae[2]}px - 2rem); left: ${ae[1]}px;`)&&Pi(I,"style",he)},i:wo,o:wo,d(ae){ae&&bi(t),e[10](null)}}}let ay=2e3,oy=2e3;function FF(e,t,n){let{newick:c}=t,{hex_id:g}=t,{clade:b}=t,I,a,G,W,he=!1,ae="",ue=!1;function be(tt){if(!I)return;let lt="((((((((((((((((Tyrannus_melancholicus:0.619902,Tyrannus_couchii:0.619902):0.85678,Tyrannus_crassirostris:1.476682):0.29907,Tyrannus_savana:1.775751):0.825334,(Tyrannus_forficatus:0.749239,Tyrannus_verticalis:0.749239):1.851846):1.400348,(Tyrannus_tyrannus:3.53811,Tyrannus_vociferans:3.53811):0.463323):0.78852,Myiodynastes_luteiventris:4.789953):2.170634,(((Myiarchus_crinitus:1.804538,Myiarchus_cinerascens:1.804538):0.209707,Myiarchus_tyrannulus:2.014245):1.743441,Myiarchus_tuberculifer:3.757685):3.202901):1.597191,(((((((Empidonax_occidentalis:0.327604,Empidonax_difficilis:0.327604):2.426494,Empidonax_flaviventris:2.754098):1.696517,(((((Empidonax_oberholseri:2.161306,Empidonax_hammondii:2.161306):0.842122,Empidonax_minimus:3.003428):0.213631,Empidonax_wrightii:3.217059):0.333535,Empidonax_fulvifrons:3.550594):0.595988,(Empidonax_alnorum:1.979938,Empidonax_traillii:1.979938):2.166644):0.304032):0.148682,((Contopus_sordidulus:2.62665,Contopus_virens:2.626649):0.899922,Contopus_cooperi:3.526571):1.072725):0.325545,(Sayornis_saya:3.781439,(Sayornis_phoebe:1.096253,Sayornis_nigricans:1.096253):2.685186):1.143402):1.218483,Contopus_pertinax:6.143324):1.851513,Pyrocephalus_rubinus:7.994837):0.56294):19.243085,(((((((Zosterops_palpebrosus:11.24656,Chamaea_fasciata:11.246559):0.809274,Pycnonotus_jocosus:12.055832):0.37388,((((Riparia_riparia:6.967223,(Tachycineta_thalassina:4.679356,Tachycineta_bicolor:4.679355):2.287867):0.197341,(Stelgidopteryx_serripennis:6.278306,Progne_subis:6.278307):0.886257):0.999496,((Petrochelidon_pyrrhonota:2.705651,Petrochelidon_fulva:2.705651):4.890525,Hirundo_rustica:7.596175):0.567883):3.908347,(((Phylloscopus_fuscatus:7.144214,Phylloscopus_inornatus:7.144215):1.039892,Phylloscopus_borealis:8.184107):3.386782,Psaltriparus_minimus:11.57089):0.501517):0.357305):3.198033,(Alauda_arvensis:7.291984,Eremophila_alpestris:7.291985):8.33576):0.954938,(((Poecile_rufescens:3.381344,(Poecile_gambeli:2.366328,Poecile_atricapillus:2.366328):1.015016):2.5912,(Baeolophus_inornatus:1.885773,Baeolophus_ridgwayi:1.885773):4.086771):6.604761,Auriparus_flaviceps:12.577305):4.005378):1.204803,(((((((Oenanthe_oenanthe:8.401653,(Tarsiger_cyanurus:7.742944,Ficedula_albicilla:7.742944):0.658707):4.637699,Cinclus_mexicanus:13.03935):1.218385,((((Turdus_migratorius:3.909873,Turdus_obscurus:3.909873):0.383141,Turdus_rufopalliatus:4.293014):5.352109,((((Catharus_guttatus:3.89296,(Catharus_minimus:0.719248,Catharus_fuscescens:0.719248):3.173712):1.217916,Catharus_ustulatus:5.110876):2.898328,Hylocichla_mustelina:8.009204):0.832821,Ixoreus_naevius:8.842026):0.803098):2.400322,(Myadestes_townsendi:11.383646,(Sialia_currucoides:3.141333,Sialia_mexicana:3.141332):8.242315):0.661799):2.21229):0.472993,(Sturnus_vulgaris:11.154101,(((Mimus_polyglottos:5.122579,Oreoscoptes_montanus:5.12258):1.517727,((Toxostoma_curvirostre:4.120545,Toxostoma_rufum:4.120544):1.352213,(Toxostoma_bendirei:4.640856,((Toxostoma_lecontei:2.747447,Toxostoma_crissale:2.747447):0.857103,Toxostoma_redivivum:3.60455):1.036307):0.831901):1.167548):1.301648,Dumetella_carolinensis:7.941955):3.212146):3.576628):2.188836,((((((Campylorhynchus_brunneicapillus:6.585247,Thryomanes_bewickii:6.585247):0.601549,(Troglodytes_aedon:5.644158,(Cistothorus_platensis:4.091648,Cistothorus_palustris:4.091648):1.552511):1.542638):0.934231,(Catherpes_mexicanus:6.20663,Salpinctes_obsoletus:6.20663):1.914396):3.05437,((Polioptila_californica:1.690149,Polioptila_melanura:1.690149):1.702386,Polioptila_caerulea:3.392536):7.782861):2.80982,Certhia_americana:13.985217):1.128942,((Sitta_canadensis:6.561379,Sitta_pygmaea:6.56138):1.810662,Sitta_carolinensis:8.37204):6.742118):1.805406):0.407621,(((Bombycilla_garrulus:3.757978,Bombycilla_cedrorum:3.757978):8.174507,(Ptilogonys_cinereus:8.485107,Phainopepla_nitens:8.485108):3.447377):4.887578,(Regulus_calendula:7.083885,Regulus_satrapa:7.083885):9.736178):0.507124):0.145318,(((((((Sporophila_torqueola:8.419777,(((Spiza_americana:5.82027,(((Passerina_versicolor:1.374144,Passerina_ciris:1.374144):2.404035,(Passerina_caerulea:2.570987,Passerina_amoena:2.570987):1.207191):0.473037,Passerina_cyanea:4.251215):1.569056):1.286765,((((Piranga_ludoviciana:3.489746,Piranga_flava:3.489746):0.442277,Piranga_olivacea:3.932023):0.411935,Piranga_rubra:4.343958):2.254702,(Cardinalis_sinuatus:4.01511,Cardinalis_cardinalis:4.01511):2.583551):0.508374):0.258533,(Pheucticus_ludovicianus:2.914679,Pheucticus_melanocephalus:2.914679):4.450888):1.05421):0.750985,(((((((((Quiscalus_quiscula:1.355442,Quiscalus_mexicanus:1.355442):1.537226,(Euphagus_carolinus:2.263857,Euphagus_cyanocephalus:2.263857):0.628811):1.191256,(Molothrus_aeneus:1.212313,Molothrus_ater:1.212313):2.871611):0.187559,(Agelaius_phoeniceus:3.000792,Agelaius_tricolor:3.000792):1.270691):2.148377,((Icterus_spurius:2.256428,Icterus_cucullatus:2.256428):2.245507,(Icterus_parisorum:3.486088,((Icterus_bullockii:1.296631,Icterus_pustulatus:1.296631):0.372399,Icterus_galbula:1.66903):1.817059):1.015845):1.917926):0.524545,((Sturnella_neglecta:1.887192,Sturnella_magna:1.887192):4.476338,(Xanthocephalus_xanthocephalus:5.394765,Dolichonyx_oryzivorus:5.394765):0.968765):0.580875):0.481912,Icteria_virens:7.426317):0.371308,(Seiurus_aurocapilla:5.3139,((((((((((((((((Setophaga_virens:0.55378,(Setophaga_townsendi:0.205227,Setophaga_occidentalis:0.205227):0.348552):0.601999,(Setophaga_graciae:0.393728,Setophaga_nigrescens:0.393728):0.76205):0.347084,Setophaga_discolor:1.502861):0.578854,((Setophaga_pinus:1.670331,(Setophaga_coronata:1.537147,Setophaga_dominica:1.537147):0.133184):0.165304,Setophaga_palmarum:1.835635):0.246081):0.080749,Setophaga_caerulescens:2.162464):0.069445,((((Setophaga_petechia:1.220713,Setophaga_pensylvanica:1.220713):0.146616,Setophaga_striata:1.367329):0.597451,(Setophaga_castanea:1.781327,Setophaga_fusca:1.781327):0.183453):0.175384,Setophaga_magnolia:2.140164):0.091745):0.054758,Setophaga_cerulea:2.286667):0.160767,(Setophaga_americana:0.422318,Setophaga_pitiayumi:0.422318):2.025116):0.061881,Setophaga_tigrina:2.509315):0.142911,Setophaga_ruticilla:2.652226):0.113792,Setophaga_citrina:2.766018):1.230111,(((Cardellina_rubrifrons:2.573805,Cardellina_pusilla:2.573805):0.271427,Cardellina_canadensis:2.845232):0.450177,Myioborus_pictus:3.295408):0.700721):0.307199,(Geothlypis_trichas:3.17745,(Geothlypis_formosa:2.8138,(Oporornis_agilis:2.076081,(Geothlypis_tolmiei:0.877845,Geothlypis_philadelphia:0.877845):1.198236):0.73772):0.363649):1.125879):0.086537,Helmitheros_vermivorum:4.389866):0.161013,(Protonotaria_citrea:4.303031,((Parkesia_motacilla:2.097399,Parkesia_noveboracensis:2.097399):1.823707,Mniotilta_varia:3.921106):0.381926):0.247847):0.241013,(Vermivora_cyanoptera:1.250469,Vermivora_chrysoptera:1.250469):3.541423):0.522008):2.483725):0.860785,((((Ammodramus_savannarum:5.32378,Peucaea_cassinii:5.323781):1.90225,((((Spizella_pusilla:3.070337,Spizella_atrogularis:3.070337):0.256848,(Spizella_breweri:2.319898,Spizella_passerina:2.319898):1.007287):0.299515,Spizella_pallida:3.6267):3.119963,((Calamospiza_melanocorys:5.462612,Amphispiza_bilineata:5.462613):0.473245,Chondestes_grammacus:5.935857):0.810805):0.479369):0.284235,((((Ammodramus_leconteii:4.163338,Pooecetes_gramineus:4.163338):0.318831,(((Melospiza_lincolnii:1.264886,Melospiza_georgiana:1.264886):0.837596,Melospiza_melodia:2.102483):1.773568,Passerculus_sandwichensis:3.876051):0.606118):1.04583,((Pipilo_maculatus:2.033152,Pipilo_chlorurus:2.033153):2.918452,((Melozone_aberti:0.89701,Melozone_crissalis:0.89701):3.214586,Aimophila_ruficeps:4.111597):0.840007):0.576396):0.208553,((Junco_hyemalis:4.32944,((Zonotrichia_albicollis:1.15955,Zonotrichia_querula:1.15955):0.322813,(Zonotrichia_atricapilla:0.331305,Zonotrichia_leucophrys:0.331305):1.151058):2.847076):0.487674,Passerella_iliaca:4.817114):0.919439):1.773713):0.743769,(Emberiza_pusilla:3.209884,Emberiza_rustica:3.209884):5.04415):0.404376):0.512351):0.561069,(((Calcarius_ornatus:1.735516,Calcarius_pictus:1.735516):4.618411,(Plectrophenax_nivalis:5.426424,Calcarius_lapponicus:5.426425):0.927502):0.908811,Rhynchophanes_mccownii:7.262738):2.469093):1.359019,(((Chloris_sinica:5.358973,(((Spinus_pinus:3.142395,(Spinus_tristis:2.540467,(Spinus_psaltria:1.162173,Spinus_lawrencei:1.162173):1.378294):0.601928):1.090077,Carduelis_carduelis:4.232471):0.540023,((Loxia_leucoptera:1.210478,Loxia_curvirostra:1.210477):2.332016,Acanthis_flammea:3.542493):1.230001):0.586479):2.183821,((Leucosticte_tephrocotis:0.267407,Leucosticte_atrata:0.267407):6.156445,Pinicola_enucleator:6.423852):1.11894):2.79669,Fringilla_montifringilla:10.339483):0.751366):0.547327,((Motacilla_cinerea:3.178243,(Motacilla_alba:2.460116,(Motacilla_tschutschensis:1.809206,Motacilla_citreola:1.809207):0.650909):0.718127):4.53481,(((Anthus_rubescens:3.227962,Anthus_cervinus:3.227962):1.32247,Anthus_hodgsoni:4.550432):1.385479,Anthus_spragueii:5.935912):1.777141):3.925124):0.415079,Passer_domesticus:12.053257):1.148099,((Vidua_macroura:10.518889,(Estrilda_melpoda:6.721624,(Lonchura_punctulata:4.62458,Euodice_malabarica:4.62458):2.097043):3.797268):0.93593,Euplectes_franciscanus:11.454819):1.746534):4.27115):0.314981):2.469957,((((Vireo_flavoviridis:1.321439,Vireo_olivaceus:1.321439):1.199697,(Vireo_philadelphicus:1.956385,Vireo_gilvus:1.956385):0.564752):0.781661,((((Vireo_solitarius:0.707618,(Vireo_cassinii:0.402464,Vireo_plumbeus:0.402464):0.305154):0.801472,Vireo_flavifrons:1.50909):0.835561,(Vireo_vicinior:2.056349,Vireo_huttoni:2.056349):0.288302):0.466454,(Vireo_griseus:1.632751,Vireo_bellii:1.632751):1.178355):0.491692):12.019837,((Lanius_cristatus:5.837545,Lanius_ludovicianus:5.837545):5.571762,(((((Corvus_corax:4.701119,Corvus_brachyrhynchos:4.701119):1.990164,Nucifraga_columbiana:6.691283):1.298672,(Pica_nuttalli:0.392281,Pica_hudsonia:0.392281):7.597672):0.514906,(((Gymnorhinus_cyanocephalus:6.126222,((Aphelocoma_woodhouseii:0.76393,Aphelocoma_californica:0.76393):1.557404,Aphelocoma_insularis:2.321334):3.804888):0.683341,(Cyanocitta_stelleri:4.846486,Cyanocitta_cristata:4.846486):1.963078):0.455185,Calocitta_colliei:7.264749):1.240112):0.40107,Perisoreus_canadensis:8.905929):2.503378):3.913326):4.934811):7.543419):10.368133,(Psittacula_krameri:14.70458,((((Brotogeris_chiriri:1.035507,Brotogeris_versicolurus:1.035507):6.349329,Myiopsitta_monachus:7.384836):2.724171,(Amazona_albifrons:3.384577,((Amazona_autumnalis:2.541056,(Amazona_finschi:1.862114,Amazona_viridigenalis:1.862114):0.678941):0.625662,(Amazona_ochrocephala:1.165411,Amazona_aestiva:1.16541):2.001307):0.217859):6.72443):0.370969,(((Aratinga_acuticaudata:4.733532,Nandayus_nenday:4.733532):0.572154,Cyanoliseus_patagonus:5.305686):0.227193,Aratinga_mitrata:5.532878):4.947097):4.224603):23.464415):0.875789,((Falco_tinnunculus:6.236443,((Falco_mexicanus:3.250519,Falco_peregrinus:3.250519):1.551005,(Falco_columbarius:4.340078,Falco_sparverius:4.340078):0.461445):1.434919):11.560534,Caracara_plancus:17.796978):21.247806):18.167212,(((((Colaptes_auratus:7.439905,Dryocopus_pileatus:7.439906):2.995574,((((Sphyrapicus_ruber:0.691321,(Sphyrapicus_nuchalis:0.686021,Sphyrapicus_varius:0.686021):0.0053):4.673796,Sphyrapicus_thyroideus:5.365118):3.383365,(Melanerpes_uropygialis:7.684308,(Melanerpes_formicivorus:7.035306,(Melanerpes_lewis:6.403656,Melanerpes_erythrocephalus:6.403656):0.63165):0.649002):1.064176):0.729339,Picoides_arcticus:9.477822):0.957657):25.154227,Megaceryle_alcyon:35.589708):21.232651,(((((Megascops_kennicottii:9.535534,(Bubo_scandiacus:4.38794,Bubo_virginianus:4.38794):5.147594):0.399666,Strix_varia:9.935201):0.688896,(Asio_otus:6.154249,Asio_flammeus:6.154249):4.469847):2.862398,(((Glaucidium_gnoma:10.483593,Athene_cunicularia:10.483593):0.73703,Aegolius_acadicus:11.220624):0.978771,Micrathene_whitneyi:12.199394):1.2871):8.747286,Tyto_alba:22.233781):34.588578):0.214221,(((((Aquila_chrysaetos:7.964539,((((Buteogallus_anthracinus:4.536991,((((((Buteo_swainsoni:1.391803,(Buteo_albonotatus:1.258194,(Buteo_regalis:0.408815,Buteo_lagopus:0.408815):0.84938):0.13361):0.246285,Buteo_jamaicensis:1.638089):0.474275,Buteo_platypterus:2.112364):0.127968,Buteo_lineatus:2.240332):0.063671,Buteo_nitidus:2.304003):1.83132,Parabuteo_unicinctus:4.135322):0.401669):0.814523,Ictinia_mississippiensis:5.351515):1.030262,Haliaeetus_leucocephalus:6.381778):0.568816,(Accipiter_striatus:5.309671,(Circus_cyaneus:5.06055,(Accipiter_cooperii:3.903353,Accipiter_gentilis:3.903353):1.157197):0.24912):1.640922):1.013948):1.914107,Elanoides_forficatus:9.878649):1.074487,Elanus_leucurus:10.953135):1.124614,Pandion_haliaetus:12.07775):4.511346,((Coragyps_atratus:3.554197,Gymnogyps_californianus:3.554197):2.188988,Cathartes_aura:5.743185):10.84591):40.447484):0.175416):0.552342,((((((((((((((((Tryngites_subruficollis:3.158973,Calidris_bairdii:3.158973):1.069381,Calidris_melanotos:4.228355):0.721063,(Calidris_pusilla:2.559828,Calidris_mauri:2.559828):2.389589):0.443639,Calidris_himantopus:5.393057):0.153549,(((Calidris_alba:3.699876,Calidris_fuscicollis:3.699876):0.589353,Calidris_minuta:4.289229):0.510028,Calidris_minutilla:4.799257):0.747348):0.500986,Calidris_ferruginea:6.047591):0.427549,((Calidris_maritima:1.198421,Calidris_ptilocnemis:1.198421):3.144061,Calidris_alpina:4.342482):2.132658):0.368787,Calidris_subminuta:6.843928):0.480821,Philomachus_pugnax:7.324748):0.299471,(Calidris_acuminata:6.399253,(Calidris_canutus:5.09979,Aphriza_virgata:5.09979):1.299464):1.224966):3.509313,(Arenaria_interpres:3.533248,Arenaria_melanocephala:3.533248):7.600284):1.234303,((((Scolopax_minor:10.211308,(Gallinago_gallinago:3.83163,Gallinago_delicata:3.831629):6.379678):0.499977,(Limnodromus_griseus:5.529963,Limnodromus_scolopaceus:5.529963):5.181322):0.726366,Lymnocryptes_minimus:11.437651):0.649326,(((Tringa_solitaria:7.846535,((((Tringa_stagnatilis:3.841335,Tringa_glareola:3.841335):1.894987,((Tringa_nebularia:3.640261,Tringa_melanoleuca:3.640261):1.182161,Tringa_erythropus:4.822422):0.913899):0.484985,(Tringa_flavipes:5.250045,Tringa_semipalmata:5.250045):0.971262):0.372349,(Tringa_brevipes:3.111692,Tringa_incana:3.111692):3.481964):1.252879):2.273961,(((Phalaropus_fulicarius:3.166781,Phalaropus_lobatus:3.166781):4.461625,Phalaropus_tricolor:7.628406):1.797383,Xenus_cinereus:9.425789):0.694707):0.508933,Actitis_macularius:10.629429):1.457548):0.280858):0.808214,((Limosa_fedoa:4.758084,Limosa_haemastica:4.758084):2.792013,Limosa_lapponica:7.550097):5.625952):0.875709,(((Numenius_americanus:3.902998,Numenius_minutus:3.902999):3.114172,(Numenius_phaeopus:3.809099,Numenius_tahitiensis:3.809099):3.208071):3.460888,Bartramia_longicauda:10.478058):3.5737):7.503049,((((((((Chlidonias_niger:1.1619,Chlidonias_leucopterus:1.1619):3.555137,(((Sterna_paradisaea:2.604915,Sterna_hirundo:2.604915):1.016325,Sterna_forsteri:3.62124):0.268369,((Thalasseus_sandvicensis:0.607261,Thalasseus_elegans:0.607261):0.62365,Thalasseus_maximus:1.230912):2.658698):0.827428):0.955816,(Gelochelidon_nilotica:4.350884,Hydroprogne_caspia:4.350884):1.321968):1.505717,Sternula_antillarum:7.178569):0.558345,(Onychoprion_anaethetus:3.582945,Onychoprion_fuscatus:3.582945):4.153969):3.975227,Rynchops_niger:11.712141):0.654253,((((Chroicocephalus_ridibundus:1.999968,Chroicocephalus_philadelphia:1.999969):1.479186,((((((((((((Larus_hyperboreus:0.185546,(Larus_schistisagus:0.105983,Larus_glaucoides:0.105983):0.079563):0.003055,Larus_glaucescens:0.188601):0.155986,Larus_argentatus:0.344587):0.107021,Larus_californicus:0.451609):0.012053,Larus_dominicanus:0.463661):0.005221,Larus_fuscus:0.468882):0.150475,Larus_marinus:0.619357):0.206717,Larus_occidentalis:0.826074):0.18028,Larus_delawarensis:1.006355):0.196994,Larus_heermanni:1.203348):0.44514,(Larus_crassirostris:1.024276,Larus_belcheri:1.024276):0.624212):1.18797,(Leucophaeus_atricilla:0.919175,Leucophaeus_pipixcan:0.919175):1.917283):0.642696):0.981991,((Xema_sabini:2.721958,Pagophila_eburnea:2.721958):0.757049,(Rissa_tridactyla:2.551241,Rissa_brevirostris:2.551241):0.927766):0.982139):1.134354,((Hydrocoloeus_minutus:3.254208,Rhodostethia_rosea:3.254208):0.77621,Creagrus_furcatus:4.030417):1.565082):6.770894):0.839622,((((Cerorhinca_monocerata:4.962971,(Fratercula_corniculata:2.833483,Fratercula_cirrhata:2.833483):2.129488):4.069719,((Aethia_pusilla:3.348323,(Aethia_cristatella:2.915151,Aethia_psittacula:2.91515):0.433173):0.992254,Ptychoramphus_aleuticus:4.340578):4.692112):0.727745,((((Uria_lomvia:3.0028,Uria_aalge:3.0028):4.920853,(Synthliboramphus_antiquus:3.720373,(Synthliboramphus_hypoleucus:0.671056,Synthliboramphus_craveri:0.671056):3.049317):4.20328):0.407386,Cepphus_columba:8.331039):0.426139,(Brachyramphus_brevirostris:5.628663,(Brachyramphus_marmoratus:3.830719,Brachyramphus_perdix:3.830719):1.797944):3.128515):1.003257):1.771281,((Stercorarius_parasiticus:2.970954,Stercorarius_pomarinus:2.970954):1.751772,Stercorarius_longicaudus:4.722725):6.80899):1.6743):8.348792):1.743606,((((Charadrius_montanus:5.551928,((Charadrius_leschenaultii:0.169672,Charadrius_mongolus:0.169672):4.612515,Charadrius_wilsonia:4.782187):0.769741):4.443245,(((Charadrius_semipalmatus:5.377763,(Charadrius_melodus:3.821625,Charadrius_hiaticula:3.821625):1.556139):1.15835,Charadrius_vociferus:6.536113):2.319533,Charadrius_morinellus:8.855646):1.139527):1.702327,((Recurvirostra_americana:5.643946,Himantopus_mexicanus:5.643946):2.680725,(Haematopus_palliatus:0.491965,Haematopus_bachmani:0.491965):7.832705):3.37283):0.798071,((Pluvialis_fulva:2.455897,Pluvialis_dominica:2.455897):1.178289,Pluvialis_squatarola:3.634185):8.861386):10.802842):34.465924):0.473736,((((Columbina_inca:3.404918,(Columbina_talpacoti:2.266537,Columbina_passerina:2.266537):1.138381):8.482142,((Zenaida_asiatica:6.129893,Zenaida_macroura:6.129893):3.814154,((Columba_livia:6.40713,(Streptopelia_orientalis:4.04789,(Streptopelia_decaocto:0.772012,Streptopelia_roseogrisea:0.772012):3.275878):2.359239):1.408266,Patagioenas_fasciata:7.815396):2.128651):1.943014):22.893088,((Podilymbus_podiceps:7.533322,((((Podiceps_auritus:3.080437,Podiceps_grisegena:3.080437):1.451611,Podiceps_nigricollis:4.532048):0.835204,(Aechmophorus_clarkii:0.649792,Aechmophorus_occidentalis:0.649792):4.71746):0.982984,Tachybaptus_dominicus:6.350235):1.183087):15.975136,(Phaethon_lepturus:3.683466,Phaethon_aethereus:3.683465):19.824993):11.27169):0.63047,((((Cypseloides_niger:5.980303,Streptoprocne_zonaris:5.980303):4.57189,((Aeronautes_saxatalis:6.888602,Apus_apus:6.888602):0.820048,(Chaetura_vauxi:1.732059,Chaetura_pelagica:1.732059):5.97659):2.843543):21.460899,(((Eugenes_fulgens:10.670111,Lampornis_clemenciae:10.67011):0.56568,((Archilochus_colubris:1.306099,Archilochus_alexandri:1.306099):3.186673,(((Selasphorus_sasin:1.25153,(Selasphorus_calliope:0.828849,Selasphorus_rufus:0.828849):0.422681):0.256848,Selasphorus_platycercus:1.508378):0.915832,(Calypte_anna:1.752307,Calypte_costae:1.752307):0.671904):2.068562):6.743019):2.456092,Colibri_thalassinus:13.691884):18.321209):2.173856,(Phalaenoptilus_nuttallii:9.381208,(Chordeiles_acutipennis:4.827009,Chordeiles_minor:4.827009):4.554198):24.805739):1.223671):22.827456):3.416457,(((((((((Botaurus_lentiginosus:7.844435,Ixobrychus_exilis:7.844434):4.109641,(((((Bubulcus_ibis:5.166884,Ardea_alba:5.166884):0.893851,Ardea_herodias:6.060735):2.16869,Butorides_virescens:8.229425):0.603762,(Nyctanassa_violacea:8.188923,Nycticorax_nycticorax:8.188923):0.644264):0.574409,(((Egretta_rufescens:2.458797,Egretta_tricolor:2.458797):0.831606,Egretta_caerulea:3.290403):0.72769,Egretta_thula:4.018093):5.389502):2.546481):12.342126,(Pelecanus_erythrorhynchos:4.196515,Pelecanus_occidentalis:4.196516):20.099686):1.029739,((Platalea_ajaja:10.269775,(Plegadis_chihi:1.91568,Plegadis_falcinellus:1.915681):8.354095):2.358493,Eudocimus_albus:12.628269):12.697674):23.512005,(((((Phalacrocorax_auritus:1.697021,Phalacrocorax_brasilianus:1.697021):4.515643,Phalacrocorax_pelagicus:6.212664):4.997287,Anhinga_anhinga:11.209951):0.906335,(Morus_bassanus:9.617198,((Sula_leucogaster:2.47621,((Sula_dactylatra:0.004781,Sula_granti:0.004781):1.517391,Sula_nebouxii:1.522171):0.954038):2.140455,Sula_sula:4.616665):5.000533):2.499087):3.324854,((Fregata_magnificens:1.44266,Fregata_minor:1.44266):0.346144,Fregata_ariel:1.788804):13.652335):33.396807):1.031774,Mycteria_americana:49.869719):10.866735,((((((Pterodroma_macroptera:4.865339,((Pterodroma_sandwichensis:2.79345,Pterodroma_inexpectata:2.79345):1.365143,Pterodroma_cookii:4.158592):0.706747):4.068484,(((((Puffinus_newelli:1.381885,Puffinus_opisthomelas:1.381886):0.190289,Puffinus_puffinus:1.572175):3.181206,(Calonectris_leucomelas:1.592278,Calonectris_diomedea:1.592278):3.161103):1.064218,(((((Puffinus_carneipes:0.252926,Puffinus_creatopus:0.252926):0.973591,Puffinus_gravis:1.226516):0.48506,Puffinus_griseus:1.711576):0.09139,Puffinus_tenuirostris:1.802967):0.861427,(Puffinus_pacificus:1.416031,Puffinus_bulleri:1.416031):1.248363):3.153204):2.328164,(Procellaria_aequinoctialis:6.579741,Bulweria_bulwerii:6.579741):1.566021):0.788063):0.331096,Fulmarus_glacialis:9.26492):2.922377,((Oceanodroma_leucorhoa:7.765483,Oceanodroma_furcata:7.765483):0.356616,(Oceanodroma_microsoma:4.768379,Oceanodroma_tethys:4.768379):3.353719):4.065199):0.620175,Oceanites_oceanicus:12.807472):0.306744,(((Phoebastria_immutabilis:1.85668,Phoebastria_nigripes:1.85668):0.562903,Phoebastria_albatrus:2.419582):3.929057,((Thalassarche_cauta:0.262255,Diomedea_exulans:0.262255):0.760039,Thalassarche_eremita:1.022293):5.326347):6.765577):47.622239):0.137649,((((Gavia_adamsii:0.408341,Gavia_immer:0.408341):1.063572,Gavia_pacifica:1.471913):0.976038,Gavia_arctica:2.447951):3.809025,Gavia_stellata:6.256976):54.617128):0.372954,(((Cuculus_canorus:15.46785,(Coccyzus_erythropthalmus:9.696905,Coccyzus_americanus:9.696905):5.770947):5.16665,(Crotophaga_sulcirostris:16.315965,Geococcyx_californianus:16.315966):4.318537):10.43379,((Grus_canadensis:4.416436,(Grus_grus:3.717184,Anthropoides_virgo:3.717186):0.69925):19.831011,(((Fulica_americana:5.83685,Gallinula_chloropus:5.836849):3.314091,Porzana_carolina:9.15094):2.511697,((Coturnicops_noveboracensis:9.425769,Porphyrio_martinica:9.42577):1.910547,Rallus_limicola:11.336317):0.32632):12.584809):6.820845):30.178765):0.407474):2.979476,(((((((((Anas_clypeata:0.896522,(Anas_cyanoptera:0.02564,Anas_discors:0.02564):0.870882):1.980189,Anas_querquedula:2.876711):1.426198,Anas_formosa:4.302908):0.61938,(((Anas_rubripes:0.509299,Anas_platyrhynchos:0.509298):2.714019,(Anas_crecca:2.915976,Anas_acuta:2.915976):0.307342):0.754771,((Anas_falcata:0.775449,Anas_strepera:0.775449):1.386797,(Anas_americana:1.223151,Anas_penelope:1.223151):0.939095):1.815842):0.9442):0.899565,(((Aythya_marila:0.342269,Aythya_affinis:0.342269):0.646013,Aythya_fuligula:0.988282):0.508005,((Aythya_americana:0.805757,Aythya_collaris:0.805757):0.461603,(Aythya_valisineria:0.396165,Aythya_ferina:0.396165):0.871195):0.228926):4.325566):1.213051,((((Aix_sponsa:2.982111,Aix_galericulata:2.982111):1.486653,Cairina_moschata:4.468764):1.560604,Alopochen_aegyptiaca:6.029367):0.673042,((((Bucephala_albeola:3.701376,(Bucephala_clangula:1.11771,Bucephala_islandica:1.11771):2.583666):1.514894,(((Mergus_merganser:1.873201,Mergus_serrator:1.873201):1.916388,Lophodytes_cucullatus:3.789589):0.829361,Mergellus_albellus:4.618949):0.59732):0.502879,(Melanitta_nigra:4.674791,(Melanitta_fusca:2.340277,Melanitta_perspicillata:2.340277):2.334514):1.044358):0.771899,((((Somateria_mollissima:0.295178,Somateria_spectabilis:0.295178):3.689931,Polysticta_stelleri:3.985109):1.109118,Histrionicus_histrionicus:5.094227):0.811149,Clangula_hyemalis:5.905376):0.585672):0.211362):0.332494):2.655406,(((((Branta_hutchinsii:0.999185,Branta_canadensis:0.999184):2.080501,Branta_bernicla:3.079685):1.059406,((Chen_rossii:0.014032,Chen_caerulescens:0.014032):1.252823,((Anser_albifrons:0.492808,Anser_fabalis:0.492808):0.615209,Chen_canagica:1.108017):0.158837):2.872236):2.225437,(Cygnus_olor:4.159087,((Cygnus_cygnus:0.684532,Cygnus_columbianus:0.684532):0.189911,Cygnus_buccinator:0.874443):3.284644):2.205441):2.888657,Oxyura_jamaicensis:9.253185):0.437126):3.174907,(Dendrocygna_bicolor:9.39956,Dendrocygna_autumnalis:9.39956):3.465657):41.141001,((((((Lagopus_leucura:4.060241,Centrocercus_urophasianus:4.06024):1.450073,Bonasa_umbellus:5.510314):1.796859,Meleagris_gallopavo:7.307173):0.657843,Phasianus_colchicus:7.965017):3.942481,Alectoris_chukar:11.907496):3.85599,((Callipepla_californica:0.906981,Callipepla_gambelii:0.906981):6.06878,Oreortyx_pictus:6.975761):8.787725):38.242733):10.627788);",ut=new zu(lt),Tt=ut.render({height:oy,width:ay,"left-right-spacing":"fit-to-size","top-bottom-spacing":"fit-to-size","is-radial":!0,brush:!1,collapsible:!1,selectable:!1,reroot:!1,hide:!1,container:"#tree_container"});console.log(Tt),console.log(ut.display),a&&Tt.style_edges(function(zt,Ge){a[g].includes(Ge.target.data.name)&&(zt.style("stroke",fm()[500]),zt.style("stroke-width","2px"))}),Tt.update();let Pt=ut.display.show();if(Pt.querySelectorAll(".node-circle").forEach(zt=>zt.attr("r",0)),a)for(let zt of a[g]){let Ge=Pt.querySelector(`[data-node-name="${zt}"]`);Ge.firstChild,i_(Ge).append("circle").classed("node-circle",!0).attr("r",3).attr("title",zt).style("fill",fm()[500])}Pt.setAttribute("width",ay),Pt.setAttribute("height",oy),Pt.setAttribute("viewBox",`0 0 ${ay/4} ${oy/4}`),console.log(Pt),I.appendChild(Pt),console.log(I.querySelectorAll(".node-circle")),I.querySelectorAll(".node-circle").forEach(zt=>{zt.addEventListener("mouseover",Ge=>{console.log(Ge),console.log(document.querySelector("#tree_container"));let Xt=document.querySelector("#tree_container").clientWidth;n(5,ue=!1),G>Xt/2&&n(5,ue=!0),n(3,he=!0),n(4,ae=Ge.target.attributes.title.value)}),zt.addEventListener("mouseout",Ge=>{n(3,he=!1)})}),Pt.addEventListener("mousemove",zt=>{console.log(zt),zt.target.localName==="svg"&&(n(1,G=zt.layerX),n(2,W=zt.layerY))})}async function Ke(tt){return fetch(`/phast/data/${tt}_hex_species.json`).then(lt=>lt.json()).then(lt=>(n(9,a=JSON.parse(lt[0])),a))}vc(async()=>{Ke(b).then(tt=>be()).then(()=>console.log("built node map"))});function ot(tt){pa[tt?"unshift":"push"](()=>{I=tt,n(0,I)})}return e.$$set=tt=>{"newick"in tt&&n(6,c=tt.newick),"hex_id"in tt&&n(7,g=tt.hex_id),"clade"in tt&&n(8,b=tt.clade)},e.$$.update=()=>{e.$$.dirty&321&&c&&I&&be(),e.$$.dirty&768&&b&&!a&&Ke(b)},[I,G,W,he,ae,ue,c,g,b,a,ot]}class OF extends Lo{constructor(t){super(),Bo(this,t,FF,RF,ho,{newick:6,hex_id:7,clade:8})}}function tw(e){let t;return{c(){t=Nn("div"),this.h()},l(n){t=Vn(n,"DIV",{class:!0}),bn(t).forEach(bi),this.h()},h(){Pi(t,"class","mdc-button__touch")},m(n,c){Gn(n,t,c)},d(n){n&&bi(t)}}}function NF(e){let t,n,c,g;const b=e[28].default,I=ru(b,e,e[30],null);let a=e[6]&&tw();return{c(){t=Nn("div"),n=Cr(),I&&I.c(),a&&a.c(),c=Ds(),this.h()},l(G){t=Vn(G,"DIV",{class:!0}),bn(t).forEach(bi),n=Tr(G),I&&I.l(G),a&&a.l(G),c=Ds(),this.h()},h(){Pi(t,"class","mdc-button__ripple")},m(G,W){Gn(G,t,W),Gn(G,n,W),I&&I.m(G,W),a&&a.m(G,W),Gn(G,c,W),g=!0},p(G,W){I&&I.p&&(!g||W[0]&1073741824)&&su(I,b,G,G[30],g?ou(b,G[30],W,null):au(G[30]),null),G[6]?a||(a=tw(),a.c(),a.m(c.parentNode,c)):a&&(a.d(1),a=null)},i(G){g||($i(I,G),g=!0)},o(G){dn(I,G),g=!1},d(G){G&&(bi(t),bi(n),bi(c)),I&&I.d(G),a&&a.d(G)}}}function VF(e){let t,n,c;const g=[{tag:e[10]},{use:[[Wd,{ripple:e[3],unbounded:!1,color:e[4],disabled:!!e[23].disabled,addClass:e[19],removeClass:e[20],addStyle:e[21]}],e[17],...e[0]]},{class:Es({[e[1]]:!0,"mdc-button":!0,"mdc-button--raised":e[5]==="raised","mdc-button--unelevated":e[5]==="unelevated","mdc-button--outlined":e[5]==="outlined","smui-button--color-secondary":e[4]==="secondary","mdc-button--touch":e[6],"mdc-card__action":e[18]==="card:action","mdc-card__action--button":e[18]==="card:action","mdc-dialog__button":e[18]==="dialog:action","mdc-top-app-bar__navigation-icon":e[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":e[18]==="top-app-bar:action","mdc-snackbar__action":e[18]==="snackbar:actions","mdc-banner__secondary-action":e[18]==="banner"&&e[8],"mdc-banner__primary-action":e[18]==="banner"&&!e[8],"mdc-tooltip__action":e[18]==="tooltip:rich-actions",...e[12]})},{style:Object.entries(e[13]).map(ly).concat([e[2]]).join(" ")},e[16],e[15],e[14],{href:e[7]},e[23]];var b=e[9];function I(a,G){let W={$$slots:{default:[NF]},$$scope:{ctx:a}};if(G!==void 0&&G[0]&12580351)W=ma(g,[G[0]&1024&&{tag:a[10]},G[0]&12189721&&{use:[[Wd,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},G[0]&266610&&{class:Es({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},G[0]&8196&&{style:Object.entries(a[13]).map(ly).concat([a[2]]).join(" ")},G[0]&65536&&Fs(a[16]),G[0]&32768&&Fs(a[15]),G[0]&16384&&Fs(a[14]),G[0]&128&&{href:a[7]},G[0]&8388608&&Fs(a[23])]);else for(let he=0;he<g.length;he+=1)W=gr(W,g[he]);return{props:W}}return b&&(t=ef(b,I(e)),e[29](t),t.$on("click",e[22])),{c(){t&&gs(t.$$.fragment),n=Ds()},l(a){t&&Xs(t.$$.fragment,a),n=Ds()},m(a,G){t&&_s(t,a,G),Gn(a,n,G),c=!0},p(a,G){if(G[0]&512&&b!==(b=a[9])){if(t){Ho();const W=t;dn(W.$$.fragment,1,0,()=>{ys(W,1)}),jo()}b?(t=ef(b,I(a,G)),a[29](t),t.$on("click",a[22]),gs(t.$$.fragment),$i(t.$$.fragment,1),_s(t,n.parentNode,n)):t=null}else if(b){const W=G[0]&12580351?ma(g,[G[0]&1024&&{tag:a[10]},G[0]&12189721&&{use:[[Wd,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},G[0]&266610&&{class:Es({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},G[0]&8196&&{style:Object.entries(a[13]).map(ly).concat([a[2]]).join(" ")},G[0]&65536&&Fs(a[16]),G[0]&32768&&Fs(a[15]),G[0]&16384&&Fs(a[14]),G[0]&128&&{href:a[7]},G[0]&8388608&&Fs(a[23])]):{};G[0]&1073741888&&(W.$$scope={dirty:G,ctx:a}),t.$set(W)}},i(a){c||(t&&$i(t.$$.fragment,a),c=!0)},o(a){t&&dn(t.$$.fragment,a),c=!1},d(a){a&&bi(n),e[29](null),t&&ys(t,a)}}}const ly=([e,t])=>`${e}: ${t};`;function UF(e,t,n){let c,g,b;const I=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let a=co(t,I),{$$slots:G={},$$scope:W}=t;const he=wc(yc());let{use:ae=[]}=t,{class:ue=""}=t,{style:be=""}=t,{ripple:Ke=!0}=t,{color:ot="primary"}=t,{variant:tt="text"}=t,{touch:lt=!1}=t,{href:ut=void 0}=t,{action:Tt="close"}=t,{defaultAction:Pt=!1}=t,{secondary:zt=!1}=t,Ge,Xt={},rt={},yt=Cu("SMUI:button:context"),{component:pt=tf}=t,{tag:gt=pt===tf?ut==null?"button":"a":void 0}=t,bt=a.disabled;du("SMUI:label:context","button"),du("SMUI:icon:context","button");function dt(Ot){Xt[Ot]||n(12,Xt[Ot]=!0,Xt)}function $e(Ot){(!(Ot in Xt)||Xt[Ot])&&n(12,Xt[Ot]=!1,Xt)}function mt(Ot,_i){rt[Ot]!=_i&&(_i===""||_i==null?(delete rt[Ot],n(13,rt)):n(13,rt[Ot]=_i,rt))}function st(){yt==="banner"&&iu(Nt(),zt?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function Nt(){return Ge.getElement()}function Rt(Ot){pa[Ot?"unshift":"push"](()=>{Ge=Ot,n(11,Ge)})}return e.$$set=Ot=>{n(31,t=gr(gr({},t),ec(Ot))),n(23,a=co(t,I)),"use"in Ot&&n(0,ae=Ot.use),"class"in Ot&&n(1,ue=Ot.class),"style"in Ot&&n(2,be=Ot.style),"ripple"in Ot&&n(3,Ke=Ot.ripple),"color"in Ot&&n(4,ot=Ot.color),"variant"in Ot&&n(5,tt=Ot.variant),"touch"in Ot&&n(6,lt=Ot.touch),"href"in Ot&&n(7,ut=Ot.href),"action"in Ot&&n(24,Tt=Ot.action),"defaultAction"in Ot&&n(25,Pt=Ot.defaultAction),"secondary"in Ot&&n(8,zt=Ot.secondary),"component"in Ot&&n(9,pt=Ot.component),"tag"in Ot&&n(10,gt=Ot.tag),"$$scope"in Ot&&n(30,W=Ot.$$scope)},e.$$.update=()=>{if(n(16,c=yt==="dialog:action"&&Tt!=null?{"data-mdc-dialog-action":Tt}:{action:t.action}),n(15,g=yt==="dialog:action"&&Pt?{"data-mdc-dialog-button-default":""}:{default:t.default}),n(14,b=yt==="banner"?{}:{secondary:t.secondary}),bt!==a.disabled){const Ot=Nt();"blur"in Ot&&Ot.blur(),n(27,bt=a.disabled)}},t=ec(t),[ae,ue,be,Ke,ot,tt,lt,ut,zt,pt,gt,Ge,Xt,rt,b,g,c,he,yt,dt,$e,mt,st,a,Tt,Pt,Nt,bt,G,Rt,W]}class GF extends Lo{constructor(t){super(),Bo(this,t,UF,VF,ho,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}function qF(e){return e.split(" ").map(t=>/^(lighten|darken|accent)-/.test(t)?`text-${t}`:`${t}-text`)}function iw(e,t){if(/^(#|rgb|hsl|currentColor)/.test(t))return e.style.color=t,!1;if(t.startsWith("--"))return e.style.color=`var(${t})`,!1;const n=qF(t);return e.classList.add(...n),n}const HF=(e,t)=>{let n;return typeof t=="string"&&(n=iw(e,t)),{update(c){n?e.classList.remove(...n):e.style.color=null,typeof c=="string"&&(n=iw(e,c))}}};let nw=36,jF="";for(;nw--;)jF+=nw.toString(36);function rw(e){let t,n=[{class:"underlay"},e[9],{"stroke-dashoffset":"0"}],c={};for(let g=0;g<n.length;g+=1)c=gr(c,n[g]);return{c(){t=Ba("circle"),this.h()},l(g){t=za(g,"circle",{class:!0,"stroke-dashoffset":!0}),bn(t).forEach(bi),this.h()},h(){d_(t,c),em(t,"svelte-kiaiot",!0)},m(g,b){Gn(g,t,b)},p(g,b){em(t,"svelte-kiaiot",!0)},d(g){g&&bi(t)}}}function ZF(e){let t,n,c,g,b,I,a,G,W,he,ae,ue=!e[1]&&rw(e),be=[{class:"overlay"},e[9],{"stroke-dashoffset":e[8]}],Ke={};for(let lt=0;lt<be.length;lt+=1)Ke=gr(Ke,be[lt]);const ot=e[12].default,tt=ru(ot,e,e[11],null);return{c(){t=Nn("div"),n=Ba("svg"),ue&&ue.c(),c=Ba("circle"),g=Cr(),b=Nn("div"),tt&&tt.c(),this.h()},l(lt){t=Vn(lt,"DIV",{role:!0,"aria-valuemin":!0,"aria-valuemax":!0,"aria-valuenow":!0,class:!0,style:!0});var ut=bn(t);n=za(ut,"svg",{xmlns:!0,viewBox:!0,style:!0,class:!0});var Tt=bn(n);ue&&ue.l(Tt),c=za(Tt,"circle",{class:!0,"stroke-dashoffset":!0}),bn(c).forEach(bi),Tt.forEach(bi),g=Tr(ut),b=Vn(ut,"DIV",{class:!0});var Pt=bn(b);tt&&tt.l(Pt),Pt.forEach(bi),ut.forEach(bi),this.h()},h(){d_(c,Ke),em(c,"svelte-kiaiot",!0),Pi(n,"xmlns","http://www.w3.org/2000/svg"),Pi(n,"viewBox",e[7]+`
    `+e[7]+`
    `+2*e[7]+`
    `+2*e[7]),Ly(n,"transform","rotate("+e[3]+"deg)"),Pi(n,"class","svelte-kiaiot"),Pi(b,"class","s-progress-circular__content svelte-kiaiot"),Pi(t,"role","progressbar"),Pi(t,"aria-valuemin","0"),Pi(t,"aria-valuemax","100"),Pi(t,"aria-valuenow",e[5]),Pi(t,"class",I="s-progress-circular "+e[0]+" svelte-kiaiot"),Pi(t,"style",a="width:"+e[4]+"px;height:"+e[4]+"px;"+e[6]),em(t,"indeterminate",e[1])},m(lt,ut){Gn(lt,t,ut),Zi(t,n),ue&&ue.m(n,null),Zi(n,c),Zi(t,g),Zi(t,b),tt&&tt.m(b,null),W=!0,he||(ae=bo(G=HF.call(null,t,e[2])),he=!0)},p(lt,[ut]){lt[1]?ue&&(ue.d(1),ue=null):ue?ue.p(lt,ut):(ue=rw(lt),ue.c(),ue.m(n,c)),em(c,"svelte-kiaiot",!0),(!W||ut&8)&&Ly(n,"transform","rotate("+lt[3]+"deg)"),tt&&tt.p&&(!W||ut&2048)&&su(tt,ot,lt,lt[11],W?ou(ot,lt[11],ut,null):au(lt[11]),null),(!W||ut&32)&&Pi(t,"aria-valuenow",lt[5]),(!W||ut&1&&I!==(I="s-progress-circular "+lt[0]+" svelte-kiaiot"))&&Pi(t,"class",I),(!W||ut&80&&a!==(a="width:"+lt[4]+"px;height:"+lt[4]+"px;"+lt[6]))&&Pi(t,"style",a),G&&Eu(G.update)&&ut&4&&G.update.call(null,lt[2]),(!W||ut&3)&&em(t,"indeterminate",lt[1])},i(lt){W||($i(tt,lt),W=!0)},o(lt){dn(tt,lt),W=!1},d(lt){lt&&bi(t),ue&&ue.d(),tt&&tt.d(lt),he=!1,ae()}}}const uy=20;function QF(e,t,n){let{$$slots:c={},$$scope:g}=t,{class:b=""}=t,{indeterminate:I=!1}=t,{color:a="secondary"}=t,{rotate:G=0}=t,{size:W=32}=t,{value:he=0}=t,{width:ae=4}=t,{style:ue=""}=t;const be=2*3.1416*uy,Ke=uy/(1-Number(ae)/+W),ot=Number(ae)/+W*Ke*2,tt=(100-he)/100*be,lt={fill:"transparent",cx:2*Ke,cy:2*Ke,r:uy,"stroke-width":ot,"stroke-dasharray":be};return e.$$set=ut=>{"class"in ut&&n(0,b=ut.class),"indeterminate"in ut&&n(1,I=ut.indeterminate),"color"in ut&&n(2,a=ut.color),"rotate"in ut&&n(3,G=ut.rotate),"size"in ut&&n(4,W=ut.size),"value"in ut&&n(5,he=ut.value),"width"in ut&&n(10,ae=ut.width),"style"in ut&&n(6,ue=ut.style),"$$scope"in ut&&n(11,g=ut.$$scope)},[b,I,a,G,W,he,ue,Ke,tt,lt,ae,g,c]}class WF extends Lo{constructor(t){super(),Bo(this,t,QF,ZF,ho,{class:0,indeterminate:1,color:2,rotate:3,size:4,value:5,width:10,style:6})}}function sw(e){let t,n;return{c(){t=Nn("h3"),n=Ja(e[0]),this.h()},l(c){t=Vn(c,"H3",{class:!0});var g=bn(t);n=eo(g,e[0]),g.forEach(bi),this.h()},h(){Pi(t,"class","svelte-10jlhi")},m(c,g){Gn(c,t,g),Zi(t,n)},p(c,g){g&1&&tu(n,c[0])},d(c){c&&bi(t)}}}function XF(e){let t,n,c,g;n=new WF({props:{size:50,indeterminate:!0,color:fm()[500]}});let b=e[0]&&sw(e);return{c(){t=Nn("div"),gs(n.$$.fragment),c=Cr(),b&&b.c(),this.h()},l(I){t=Vn(I,"DIV",{class:!0});var a=bn(t);Xs(n.$$.fragment,a),c=Tr(a),b&&b.l(a),a.forEach(bi),this.h()},h(){Pi(t,"class","loading-container svelte-10jlhi")},m(I,a){Gn(I,t,a),_s(n,t,null),Zi(t,c),b&&b.m(t,null),g=!0},p(I,[a]){I[0]?b?b.p(I,a):(b=sw(I),b.c(),b.m(t,null)):b&&(b.d(1),b=null)},i(I){g||($i(n.$$.fragment,I),g=!0)},o(I){dn(n.$$.fragment,I),g=!1},d(I){I&&bi(t),ys(n),b&&b.d()}}}function YF(e,t,n){let{message:c}=t;return e.$$set=g=>{"message"in g&&n(0,c=g.message)},[c]}class i5 extends Lo{constructor(t){super(),Bo(this,t,YF,XF,ho,{message:0})}}function aw(e,t,n){const c=e.slice();return c[16]=t[n],c}function ow(e,t,n){const c=e.slice();return c[16]=t[n],c}function lw(e,t,n){const c=e.slice();return c[16]=t[n],c}function $F(e){let t=e[16].name+"",n;return{c(){n=Ja(t)},l(c){n=eo(c,t)},m(c,g){Gn(c,n,g)},p(c,g){g&16&&t!==(t=c[16].name+"")&&tu(n,t)},d(c){c&&bi(n)}}}function uw(e){let t,n;return t=new Cg({props:{value:e[16],$$slots:{default:[$F]},$$scope:{ctx:e}}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&16&&(b.value=c[16]),g&8388624&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function KF(e){let t,n,c=ph(e[4]),g=[];for(let I=0;I<c.length;I+=1)g[I]=uw(lw(e,c,I));const b=I=>dn(g[I],1,1,()=>{g[I]=null});return{c(){for(let I=0;I<g.length;I+=1)g[I].c();t=Ds()},l(I){for(let a=0;a<g.length;a+=1)g[a].l(I);t=Ds()},m(I,a){for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(I,a);Gn(I,t,a),n=!0},p(I,a){if(a&16){c=ph(I[4]);let G;for(G=0;G<c.length;G+=1){const W=lw(I,c,G);g[G]?(g[G].p(W,a),$i(g[G],1)):(g[G]=uw(W),g[G].c(),$i(g[G],1),g[G].m(t.parentNode,t))}for(Ho(),G=c.length;G<g.length;G+=1)b(G);jo()}},i(I){if(!n){for(let a=0;a<c.length;a+=1)$i(g[a]);n=!0}},o(I){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)dn(g[a]);n=!1},d(I){I&&bi(t),up(g,I)}}}function cw(e){var be,Ke,ot,tt,lt,ut;let t,n,c,g=((Ke=(be=e[0])==null?void 0:be.next)==null?void 0:Ke.name)+"",b,I,a,G,W,he,ae=((tt=(ot=e[0])==null?void 0:ot.next)==null?void 0:tt.options.length)>0&&hw(e),ue=((ut=(lt=e[0])==null?void 0:lt.next)==null?void 0:ut.options.length)==0&&fw();return{c(){t=Nn("div"),n=Nn("h2"),c=Ja("Select which "),b=Ja(g),I=Ja(" to use"),a=Cr(),ae&&ae.c(),G=Cr(),ue&&ue.c(),this.h()},l(Tt){t=Vn(Tt,"DIV",{class:!0});var Pt=bn(t);n=Vn(Pt,"H2",{class:!0});var zt=bn(n);c=eo(zt,"Select which "),b=eo(zt,g),I=eo(zt," to use"),zt.forEach(bi),a=Tr(Pt),ae&&ae.l(Pt),G=Tr(Pt),ue&&ue.l(Pt),Pt.forEach(bi),this.h()},h(){var Tt;Pi(n,"class","svelte-wgfovm"),Pi(t,"class",W=Jd(`step ${!((Tt=e[0])!=null&&Tt.next)||!e[3]&&"grayed"}`)+" svelte-wgfovm")},m(Tt,Pt){Gn(Tt,t,Pt),Zi(t,n),Zi(n,c),Zi(n,b),Zi(n,I),Zi(t,a),ae&&ae.m(t,null),Zi(t,G),ue&&ue.m(t,null),he=!0},p(Tt,Pt){var zt,Ge,Xt,rt,yt,pt,gt;(!he||Pt&1)&&g!==(g=((Ge=(zt=Tt[0])==null?void 0:zt.next)==null?void 0:Ge.name)+"")&&tu(b,g),((rt=(Xt=Tt[0])==null?void 0:Xt.next)==null?void 0:rt.options.length)>0?ae?(ae.p(Tt,Pt),Pt&1&&$i(ae,1)):(ae=hw(Tt),ae.c(),$i(ae,1),ae.m(t,G)):ae&&(Ho(),dn(ae,1,1,()=>{ae=null}),jo()),((pt=(yt=Tt[0])==null?void 0:yt.next)==null?void 0:pt.options.length)==0?ue?Pt&1&&$i(ue,1):(ue=fw(),ue.c(),$i(ue,1),ue.m(t,null)):ue&&(Ho(),dn(ue,1,1,()=>{ue=null}),jo()),(!he||Pt&9&&W!==(W=Jd(`step ${!((gt=Tt[0])!=null&&gt.next)||!Tt[3]&&"grayed"}`)+" svelte-wgfovm"))&&Pi(t,"class",W)},i(Tt){he||($i(ae),$i(ue),he=!0)},o(Tt){dn(ae),dn(ue),he=!1},d(Tt){Tt&&bi(t),ae&&ae.d(),ue&&ue.d()}}}function hw(e){let t,n,c;function g(I){e[10](I)}let b={class:"shaped",variant:"filled",$$slots:{default:[eO]},$$scope:{ctx:e}};return e[1]!==void 0&&(b.value=e[1]),t=new Ag({props:b}),pa.push(()=>N0(t,"value",g)),{c(){gs(t.$$.fragment)},l(I){Xs(t.$$.fragment,I)},m(I,a){_s(t,I,a),c=!0},p(I,a){const G={};a&8388609&&(G.$$scope={dirty:a,ctx:I}),!n&&a&2&&(n=!0,G.value=I[1],O0(()=>n=!1)),t.$set(G)},i(I){c||($i(t.$$.fragment,I),c=!0)},o(I){dn(t.$$.fragment,I),c=!1},d(I){ys(t,I)}}}function JF(e){let t=e[16].name+"",n;return{c(){n=Ja(t)},l(c){n=eo(c,t)},m(c,g){Gn(c,n,g)},p(c,g){g&1&&t!==(t=c[16].name+"")&&tu(n,t)},d(c){c&&bi(n)}}}function Aw(e){let t,n;return t=new Cg({props:{value:e[16],$$slots:{default:[JF]},$$scope:{ctx:e}}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&1&&(b.value=c[16]),g&8388609&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function eO(e){var I,a;let t,n,c=ph((a=(I=e[0])==null?void 0:I.next)==null?void 0:a.options),g=[];for(let G=0;G<c.length;G+=1)g[G]=Aw(ow(e,c,G));const b=G=>dn(g[G],1,1,()=>{g[G]=null});return{c(){for(let G=0;G<g.length;G+=1)g[G].c();t=Ds()},l(G){for(let W=0;W<g.length;W+=1)g[W].l(G);t=Ds()},m(G,W){for(let he=0;he<g.length;he+=1)g[he]&&g[he].m(G,W);Gn(G,t,W),n=!0},p(G,W){var he,ae;if(W&1){c=ph((ae=(he=G[0])==null?void 0:he.next)==null?void 0:ae.options);let ue;for(ue=0;ue<c.length;ue+=1){const be=ow(G,c,ue);g[ue]?(g[ue].p(be,W),$i(g[ue],1)):(g[ue]=Aw(be),g[ue].c(),$i(g[ue],1),g[ue].m(t.parentNode,t))}for(Ho(),ue=c.length;ue<g.length;ue+=1)b(ue);jo()}},i(G){if(!n){for(let W=0;W<c.length;W+=1)$i(g[W]);n=!0}},o(G){g=g.filter(Boolean);for(let W=0;W<g.length;W+=1)dn(g[W]);n=!1},d(G){G&&bi(t),up(g,G)}}}function fw(e){let t,n;return t=new i5({}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function tO(e){let t=e[16]+"",n;return{c(){n=Ja(t)},l(c){n=eo(c,t)},m(c,g){Gn(c,n,g)},p:wo,d(c){c&&bi(n)}}}function dw(e){let t,n;return t=new Cg({props:{value:e[16],$$slots:{default:[tO]},$$scope:{ctx:e}}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&8388608&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function iO(e){let t,n,c=ph(e[5]),g=[];for(let I=0;I<c.length;I+=1)g[I]=dw(aw(e,c,I));const b=I=>dn(g[I],1,1,()=>{g[I]=null});return{c(){for(let I=0;I<g.length;I+=1)g[I].c();t=Ds()},l(I){for(let a=0;a<g.length;a+=1)g[a].l(I);t=Ds()},m(I,a){for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(I,a);Gn(I,t,a),n=!0},p(I,a){if(a&32){c=ph(I[5]);let G;for(G=0;G<c.length;G+=1){const W=aw(I,c,G);g[G]?(g[G].p(W,a),$i(g[G],1)):(g[G]=dw(W),g[G].c(),$i(g[G],1),g[G].m(t.parentNode,t))}for(Ho(),G=c.length;G<g.length;G+=1)b(G);jo()}},i(I){if(!n){for(let a=0;a<c.length;a+=1)$i(g[a]);n=!0}},o(I){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)dn(g[a]);n=!1},d(I){I&&bi(t),up(g,I)}}}function nO(e){let t=e[0]?"Build":"Select a null model",n;return{c(){n=Ja(t)},l(c){n=eo(c,t)},m(c,g){Gn(c,n,g)},p(c,g){g&1&&t!==(t=c[0]?"Build":"Select a null model")&&tu(n,t)},d(c){c&&bi(n)}}}function rO(e){let t,n;return t=new iC({props:{$$slots:{default:[nO]},$$scope:{ctx:e}}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&8388609&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function sO(e){var dt;let t,n,c,g,b,I,a,G="Select a null model",W,he,ae,ue,be,Ke,ot,tt="Select a different region to compare",lt,ut,Tt,Pt,zt,Ge,Xt;c=new IT({});function rt($e){e[9]($e)}let yt={class:"shaped",variant:"filled",$$slots:{default:[KF]},$$scope:{ctx:e}};e[0]!==void 0&&(yt.value=e[0]),he=new Ag({props:yt}),pa.push(()=>N0(he,"value",rt));let pt=((dt=e[0])==null?void 0:dt.next)&&cw(e);function gt($e){e[11]($e)}let bt={class:"shaped",variant:"filled",$$slots:{default:[iO]},$$scope:{ctx:e}};return e[2]!==void 0&&(bt.value=e[2]),ut=new Ag({props:bt}),pa.push(()=>N0(ut,"value",gt)),Ge=new GF({props:{class:"theme-button",variant:"raised",disabled:!e[0],$$slots:{default:[rO]},$$scope:{ctx:e}}}),Ge.$on("click",e[12]),{c(){t=Nn("div"),n=Nn("div"),gs(c.$$.fragment),g=Cr(),b=Nn("div"),I=Nn("div"),a=Nn("h2"),a.textContent=G,W=Cr(),gs(he.$$.fragment),ue=Cr(),pt&&pt.c(),be=Cr(),Ke=Nn("div"),ot=Nn("h2"),ot.textContent=tt,lt=Cr(),gs(ut.$$.fragment),zt=Cr(),gs(Ge.$$.fragment),this.h()},l($e){t=Vn($e,"DIV",{class:!0});var mt=bn(t);n=Vn(mt,"DIV",{class:!0});var st=bn(n);Xs(c.$$.fragment,st),st.forEach(bi),g=Tr(mt),b=Vn(mt,"DIV",{class:!0});var Nt=bn(b);I=Vn(Nt,"DIV",{class:!0});var Rt=bn(I);a=Vn(Rt,"H2",{class:!0,"data-svelte-h":!0}),dc(a)!=="svelte-1vw7qz9"&&(a.textContent=G),W=Tr(Rt),Xs(he.$$.fragment,Rt),Rt.forEach(bi),ue=Tr(Nt),pt&&pt.l(Nt),be=Tr(Nt),Ke=Vn(Nt,"DIV",{class:!0});var Ot=bn(Ke);ot=Vn(Ot,"H2",{class:!0,"data-svelte-h":!0}),dc(ot)!=="svelte-1y5wjwe"&&(ot.textContent=tt),lt=Tr(Ot),Xs(ut.$$.fragment,Ot),Ot.forEach(bi),zt=Tr(Nt),Xs(Ge.$$.fragment,Nt),Nt.forEach(bi),mt.forEach(bi),this.h()},h(){Pi(n,"class","logo svelte-wgfovm"),Pi(a,"class","svelte-wgfovm"),Pi(I,"class","step svelte-wgfovm"),Pi(ot,"class","svelte-wgfovm"),Pi(Ke,"class",Pt=Jd(`step ${!e[0]&&"grayed"}`)+" svelte-wgfovm"),Pi(b,"class","steps svelte-wgfovm"),Pi(t,"class","builder svelte-wgfovm")},m($e,mt){Gn($e,t,mt),Zi(t,n),_s(c,n,null),Zi(t,g),Zi(t,b),Zi(b,I),Zi(I,a),Zi(I,W),_s(he,I,null),Zi(b,ue),pt&&pt.m(b,null),Zi(b,be),Zi(b,Ke),Zi(Ke,ot),Zi(Ke,lt),_s(ut,Ke,null),Zi(b,zt),_s(Ge,b,null),Xt=!0},p($e,[mt]){var Ot;const st={};mt&8388624&&(st.$$scope={dirty:mt,ctx:$e}),!ae&&mt&1&&(ae=!0,st.value=$e[0],O0(()=>ae=!1)),he.$set(st),(Ot=$e[0])!=null&&Ot.next?pt?(pt.p($e,mt),mt&1&&$i(pt,1)):(pt=cw($e),pt.c(),$i(pt,1),pt.m(b,be)):pt&&(Ho(),dn(pt,1,1,()=>{pt=null}),jo());const Nt={};mt&8388608&&(Nt.$$scope={dirty:mt,ctx:$e}),!Tt&&mt&4&&(Tt=!0,Nt.value=$e[2],O0(()=>Tt=!1)),ut.$set(Nt),(!Xt||mt&1&&Pt!==(Pt=Jd(`step ${!$e[0]&&"grayed"}`)+" svelte-wgfovm"))&&Pi(Ke,"class",Pt);const Rt={};mt&1&&(Rt.disabled=!$e[0]),mt&8388609&&(Rt.$$scope={dirty:mt,ctx:$e}),Ge.$set(Rt)},i($e){Xt||($i(c.$$.fragment,$e),$i(he.$$.fragment,$e),$i(pt),$i(ut.$$.fragment,$e),$i(Ge.$$.fragment,$e),Xt=!0)},o($e){dn(c.$$.fragment,$e),dn(he.$$.fragment,$e),dn(pt),dn(ut.$$.fragment,$e),dn(Ge.$$.fragment,$e),Xt=!1},d($e){$e&&bi(t),ys(c),ys(he),pt&&pt.d(),ys(ut),ys(Ge)}}}function aO(e,t,n){let c;Vc(e,Kp,ut=>n(8,c=ut));let{showEcoregions:g}=t,b=!1,{nullRegion:I}=t;const a=[{name:"All of California",type:"CALIFORNIA",next:null},{name:"By Ecoregion",type:"ECOREGION",next:{name:"ecoregion",options:[{name:"Ecoregion 1"},{name:"Ecoregion 2"},{name:"Ecoregion 3"}]}},{name:"Surface",next:"object"}];let{subNullRegion:G}=t,{altRegion:W}=t;const he=a;function ae(){if(!c.querySourceFeatures)return;let ut=c.querySourceFeatures("ecoregions"),Tt=[];for(let Pt of ut)if(Tt.filter(zt=>zt.ids.includes(Pt.id)).length==0){let zt=`${Pt.properties.US_L3NAME}`,Ge=Tt.filter(Xt=>Xt.name===zt)[0];!Ge||(Ge==null?void 0:Ge.length)==0?Tt.push({ids:[Pt.id],name:`${Pt.properties.US_L3NAME}`,type:"ECOREGION",value:`${Pt.properties.US_L3CODE}`}):Ge.ids=[...Ge.ids,Pt.id]}Tt=Tt.sort((Pt,zt)=>Pt.name.localeCompare(zt.name)),n(4,a[1].next.options=Tt,a),n(3,b=!0)}function ue(ut){if(!ut)return;let Tt=c.querySourceFeatures("ecoregions");for(let Pt of Tt)c.setFeatureState({source:"ecoregions",id:Pt.id},{hover:!1});for(let Pt of ut.ids)c.setFeatureState({source:"ecoregions",id:Pt},{hover:!0})}async function be(){Y_.set({type:I.type,sub:G})}vc(()=>{ae()});function Ke(ut){I=ut,n(0,I)}function ot(ut){G=ut,n(1,G)}function tt(ut){W=ut,n(2,W)}const lt=()=>be();return e.$$set=ut=>{"showEcoregions"in ut&&n(7,g=ut.showEcoregions),"nullRegion"in ut&&n(0,I=ut.nullRegion),"subNullRegion"in ut&&n(1,G=ut.subNullRegion),"altRegion"in ut&&n(2,W=ut.altRegion)},e.$$.update=()=>{var ut;e.$$.dirty&256&&c&&ae(),e.$$.dirty&129&&(I&&((ut=I.next)==null?void 0:ut.name)==="ecoregion"?g(!0):g(!1)),e.$$.dirty&2&&ue(G)},[I,G,W,b,a,he,be,g,c,Ke,ot,tt,lt]}class oO extends Lo{constructor(t){super(),Bo(this,t,aO,sO,ho,{showEcoregions:7,nullRegion:0,subNullRegion:1,altRegion:2})}}function lO(e){let t,n,c,g='<td class="svelte-123tfyw">Hex</td> <td class="svelte-123tfyw">Tree Size</td> <td class="svelte-123tfyw">PD</td> <td class="svelte-123tfyw">MPD</td> <td class="svelte-123tfyw">MNTD</td>',b,I,a,G=e[0].hex+"",W,he,ae,ue=(e[1](e[0].properties.tree_sizes)??"Unknown")+"",be,Ke,ot,tt=(e[1](e[0].properties.pd)??"Unknown")+"",lt,ut,Tt,Pt=(e[1](e[0].properties.mpd)??"Unknown")+"",zt,Ge,Xt,rt=(e[1](e[0].properties.mntd)??"Unknown")+"",yt;return{c(){t=Nn("div"),n=Nn("table"),c=Nn("thead"),c.innerHTML=g,b=Cr(),I=Nn("tr"),a=Nn("td"),W=Ja(G),he=Cr(),ae=Nn("td"),be=Ja(ue),Ke=Cr(),ot=Nn("td"),lt=Ja(tt),ut=Cr(),Tt=Nn("td"),zt=Ja(Pt),Ge=Cr(),Xt=Nn("td"),yt=Ja(rt),this.h()},l(pt){t=Vn(pt,"DIV",{class:!0});var gt=bn(t);n=Vn(gt,"TABLE",{});var bt=bn(n);c=Vn(bt,"THEAD",{class:!0,"data-svelte-h":!0}),dc(c)!=="svelte-i8fsz9"&&(c.innerHTML=g),b=Tr(bt),I=Vn(bt,"TR",{class:!0});var dt=bn(I);a=Vn(dt,"TD",{class:!0});var $e=bn(a);W=eo($e,G),$e.forEach(bi),he=Tr(dt),ae=Vn(dt,"TD",{class:!0});var mt=bn(ae);be=eo(mt,ue),mt.forEach(bi),Ke=Tr(dt),ot=Vn(dt,"TD",{class:!0});var st=bn(ot);lt=eo(st,tt),st.forEach(bi),ut=Tr(dt),Tt=Vn(dt,"TD",{class:!0});var Nt=bn(Tt);zt=eo(Nt,Pt),Nt.forEach(bi),Ge=Tr(dt),Xt=Vn(dt,"TD",{class:!0});var Rt=bn(Xt);yt=eo(Rt,rt),Rt.forEach(bi),dt.forEach(bi),bt.forEach(bi),gt.forEach(bi),this.h()},h(){Pi(c,"class","svelte-123tfyw"),Pi(a,"class","svelte-123tfyw"),Pi(ae,"class","svelte-123tfyw"),Pi(ot,"class","svelte-123tfyw"),Pi(Tt,"class","svelte-123tfyw"),Pi(Xt,"class","svelte-123tfyw"),Pi(I,"class","mono svelte-123tfyw"),Pi(t,"class","summary-container svelte-123tfyw")},m(pt,gt){Gn(pt,t,gt),Zi(t,n),Zi(n,c),Zi(n,b),Zi(n,I),Zi(I,a),Zi(a,W),Zi(I,he),Zi(I,ae),Zi(ae,be),Zi(I,Ke),Zi(I,ot),Zi(ot,lt),Zi(I,ut),Zi(I,Tt),Zi(Tt,zt),Zi(I,Ge),Zi(I,Xt),Zi(Xt,yt)},p(pt,[gt]){gt&1&&G!==(G=pt[0].hex+"")&&tu(W,G),gt&1&&ue!==(ue=(pt[1](pt[0].properties.tree_sizes)??"Unknown")+"")&&tu(be,ue),gt&1&&tt!==(tt=(pt[1](pt[0].properties.pd)??"Unknown")+"")&&tu(lt,tt),gt&1&&Pt!==(Pt=(pt[1](pt[0].properties.mpd)??"Unknown")+"")&&tu(zt,Pt),gt&1&&rt!==(rt=(pt[1](pt[0].properties.mntd)??"Unknown")+"")&&tu(yt,rt)},i:wo,o:wo,d(pt){pt&&bi(t)}}}const pw=3;function uO(e,t,n){let{data:c}=t;const g=b=>Math.round(b*10**pw)/10**pw;return e.$$set=b=>{"data"in b&&n(0,c=b.data)},[c,g]}class cO extends Lo{constructor(t){super(),Bo(this,t,uO,lO,ho,{data:0})}}function mw(e,t,n){const c=e.slice();return c[17]=t[n],c}function hO(e,t,n){const c=e.slice();return c[17]=t[n],c}function gw(e){let t,n,c,g,b,I,a,G,W,he,ae,ue="x",be,Ke,ot,tt,lt,ut,Tt;function Pt(gt){e[13](gt)}let zt={class:"shaped",variant:"outlined",$$slots:{default:[dO]},$$scope:{ctx:e}};e[0]!==void 0&&(zt.value=e[0]),g=new Ag({props:zt}),pa.push(()=>N0(g,"value",Pt)),g.$on("change",e[14]);function Ge(gt){e[15](gt)}let Xt={class:"shaped",variant:"outlined",$$slots:{default:[mO]},$$scope:{ctx:e}};e[1]!==void 0&&(Xt.value=e[1]),a=new Ag({props:Xt}),pa.push(()=>N0(a,"value",Ge));let rt=!e[8]&&yw(),yt=!e[9]&&vw(),pt=e[9]&&xw(e);return{c(){t=Nn("div"),n=Nn("div"),c=Ja(`Testing
                `),gs(g.$$.fragment),I=Ja(`
                of
                `),gs(a.$$.fragment),W=Cr(),he=Nn("div"),ae=Nn("button"),ae.textContent=ue,be=Cr(),rt&&rt.c(),Ke=Cr(),yt&&yt.c(),ot=Cr(),pt&&pt.c(),tt=Ds(),this.h()},l(gt){t=Vn(gt,"DIV",{class:!0});var bt=bn(t);n=Vn(bt,"DIV",{class:!0});var dt=bn(n);c=eo(dt,`Testing
                `),Xs(g.$$.fragment,dt),I=eo(dt,`
                of
                `),Xs(a.$$.fragment,dt),dt.forEach(bi),W=Tr(bt),he=Vn(bt,"DIV",{class:!0});var $e=bn(he);ae=Vn($e,"BUTTON",{class:!0,"data-svelte-h":!0}),dc(ae)!=="svelte-18oet5b"&&(ae.textContent=ue),$e.forEach(bi),bt.forEach(bi),be=Tr(gt),rt&&rt.l(gt),Ke=Tr(gt),yt&&yt.l(gt),ot=Tr(gt),pt&&pt.l(gt),tt=Ds(),this.h()},h(){Pi(n,"class","test svelte-bwquxf"),Pi(ae,"class","svelte-bwquxf"),Pi(he,"class","close svelte-bwquxf"),Pi(t,"class","header svelte-bwquxf")},m(gt,bt){Gn(gt,t,bt),Zi(t,n),Zi(n,c),_s(g,n,null),Zi(n,I),_s(a,n,null),Zi(t,W),Zi(t,he),Zi(he,ae),Gn(gt,be,bt),rt&&rt.m(gt,bt),Gn(gt,Ke,bt),yt&&yt.m(gt,bt),Gn(gt,ot,bt),pt&&pt.m(gt,bt),Gn(gt,tt,bt),lt=!0,ut||(Tt=Gl(ae,"click",e[16]),ut=!0)},p(gt,bt){const dt={};bt&4194304&&(dt.$$scope={dirty:bt,ctx:gt}),!b&&bt&1&&(b=!0,dt.value=gt[0],O0(()=>b=!1)),g.$set(dt);const $e={};bt&4194368&&($e.$$scope={dirty:bt,ctx:gt}),!G&&bt&2&&(G=!0,$e.value=gt[1],O0(()=>G=!1)),a.$set($e),gt[8]?rt&&(Ho(),dn(rt,1,1,()=>{rt=null}),jo()):rt?bt&256&&$i(rt,1):(rt=yw(),rt.c(),$i(rt,1),rt.m(Ke.parentNode,Ke)),gt[9]?yt&&(yt.d(1),yt=null):yt||(yt=vw(),yt.c(),yt.m(ot.parentNode,ot)),gt[9]?pt?(pt.p(gt,bt),bt&512&&$i(pt,1)):(pt=xw(gt),pt.c(),$i(pt,1),pt.m(tt.parentNode,tt)):pt&&(Ho(),dn(pt,1,1,()=>{pt=null}),jo())},i(gt){lt||($i(g.$$.fragment,gt),$i(a.$$.fragment,gt),$i(rt),$i(pt),lt=!0)},o(gt){dn(g.$$.fragment,gt),dn(a.$$.fragment,gt),dn(rt),dn(pt),lt=!1},d(gt){gt&&(bi(t),bi(be),bi(Ke),bi(ot),bi(tt)),ys(g),ys(a),rt&&rt.d(gt),yt&&yt.d(gt),pt&&pt.d(gt),ut=!1,Tt()}}}function AO(e){let t;return{c(){t=Ja(e[17])},l(n){t=eo(n,e[17])},m(n,c){Gn(n,t,c)},p:wo,d(n){n&&bi(t)}}}function fO(e){let t,n;return t=new Cg({props:{value:e[17],$$slots:{default:[AO]},$$scope:{ctx:e}}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&4194304&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function dO(e){let t,n,c=ph(g_),g=[];for(let b=0;b<c.length;b+=1)g[b]=fO(hO(e,c,b));return{c(){for(let b=0;b<g.length;b+=1)g[b].c();t=Ds()},l(b){for(let I=0;I<g.length;I+=1)g[I].l(b);t=Ds()},m(b,I){for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(b,I);Gn(b,t,I),n=!0},p:wo,i(b){if(!n){for(let I=0;I<c.length;I+=1)$i(g[I]);n=!0}},o(b){g=g.filter(Boolean);for(let I=0;I<g.length;I+=1)dn(g[I]);n=!1},d(b){b&&bi(t),up(g,b)}}}function pO(e){let t=e[17]+"",n;return{c(){n=Ja(t)},l(c){n=eo(c,t)},m(c,g){Gn(c,n,g)},p(c,g){g&64&&t!==(t=c[17]+"")&&tu(n,t)},d(c){c&&bi(n)}}}function _w(e){let t,n;return t=new Cg({props:{value:e[17],$$slots:{default:[pO]},$$scope:{ctx:e}}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&64&&(b.value=c[17]),g&4194368&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function mO(e){let t,n,c=ph(e[6]),g=[];for(let I=0;I<c.length;I+=1)g[I]=_w(mw(e,c,I));const b=I=>dn(g[I],1,1,()=>{g[I]=null});return{c(){for(let I=0;I<g.length;I+=1)g[I].c();t=Ds()},l(I){for(let a=0;a<g.length;a+=1)g[a].l(I);t=Ds()},m(I,a){for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(I,a);Gn(I,t,a),n=!0},p(I,a){if(a&64){c=ph(I[6]);let G;for(G=0;G<c.length;G+=1){const W=mw(I,c,G);g[G]?(g[G].p(W,a),$i(g[G],1)):(g[G]=_w(W),g[G].c(),$i(g[G],1),g[G].m(t.parentNode,t))}for(Ho(),G=c.length;G<g.length;G+=1)b(G);jo()}},i(I){if(!n){for(let a=0;a<c.length;a+=1)$i(g[a]);n=!0}},o(I){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)dn(g[a]);n=!1},d(I){I&&bi(t),up(g,I)}}}function yw(e){let t,n,c;return n=new i5({props:{message:"Building model..."}}),{c(){t=Nn("div"),gs(n.$$.fragment),this.h()},l(g){t=Vn(g,"DIV",{class:!0});var b=bn(t);Xs(n.$$.fragment,b),b.forEach(bi),this.h()},h(){Pi(t,"class","load svelte-bwquxf")},m(g,b){Gn(g,t,b),_s(n,t,null),c=!0},i(g){c||($i(n.$$.fragment,g),c=!0)},o(g){dn(n.$$.fragment,g),c=!1},d(g){g&&bi(t),ys(n)}}}function vw(e){let t,n="<p>Click on a hexagon to see phylogenetic statistics.</p>";return{c(){t=Nn("div"),t.innerHTML=n},l(c){t=Vn(c,"DIV",{"data-svelte-h":!0}),dc(t)!=="svelte-7krgt3"&&(t.innerHTML=n)},m(c,g){Gn(c,t,g)},d(c){c&&bi(t)}}}function xw(e){let t,n,c,g,b,I;return t=new cO({props:{data:e[2]}}),c=new OM({props:{colorScheme:e[4],metric:e[0],point:[[e[2].properties.tree_sizes,e[2].properties[e[0]]]]}}),b=new OF({props:{clade:e[1],newick:e[2].properties.tree,hex_id:e[2].properties.id}}),{c(){gs(t.$$.fragment),n=Cr(),gs(c.$$.fragment),g=Cr(),gs(b.$$.fragment)},l(a){Xs(t.$$.fragment,a),n=Tr(a),Xs(c.$$.fragment,a),g=Tr(a),Xs(b.$$.fragment,a)},m(a,G){_s(t,a,G),Gn(a,n,G),_s(c,a,G),Gn(a,g,G),_s(b,a,G),I=!0},p(a,G){const W={};G&4&&(W.data=a[2]),t.$set(W);const he={};G&16&&(he.colorScheme=a[4]),G&1&&(he.metric=a[0]),G&5&&(he.point=[[a[2].properties.tree_sizes,a[2].properties[a[0]]]]),c.$set(he);const ae={};G&2&&(ae.clade=a[1]),G&4&&(ae.newick=a[2].properties.tree),G&4&&(ae.hex_id=a[2].properties.id),b.$set(ae)},i(a){I||($i(t.$$.fragment,a),$i(c.$$.fragment,a),$i(b.$$.fragment,a),I=!0)},o(a){dn(t.$$.fragment,a),dn(c.$$.fragment,a),dn(b.$$.fragment,a),I=!1},d(a){a&&(bi(n),bi(g)),ys(t,a),ys(c,a),ys(b,a)}}}function bw(e){let t,n;return t=new oO({props:{showEcoregions:e[7]}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&128&&(b.showEcoregions=c[7]),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function gO(e){let t,n,c,g=e[10]&&gw(e),b=!e[10]&&bw(e);return{c(){t=Nn("div"),g&&g.c(),n=Cr(),b&&b.c(),this.h()},l(I){t=Vn(I,"DIV",{class:!0});var a=bn(t);g&&g.l(a),n=Tr(a),b&&b.l(a),a.forEach(bi),this.h()},h(){Pi(t,"class",Jd("modal")+" svelte-bwquxf")},m(I,a){Gn(I,t,a),g&&g.m(t,null),Zi(t,n),b&&b.m(t,null),c=!0},p(I,[a]){I[10]?g?(g.p(I,a),a&1024&&$i(g,1)):(g=gw(I),g.c(),$i(g,1),g.m(t,n)):g&&(Ho(),dn(g,1,1,()=>{g=null}),jo()),I[10]?b&&(Ho(),dn(b,1,1,()=>{b=null}),jo()):b?(b.p(I,a),a&1024&&$i(b,1)):(b=bw(I),b.c(),$i(b,1),b.m(t,null))},i(I){c||($i(g),$i(b),c=!0)},o(I){dn(g),dn(b),c=!1},d(I){I&&bi(t),g&&g.d(),b&&b.d()}}}function _O(e,t,n){let c;Vc(e,Y_,Pt=>n(10,c=Pt));let{selectionData:g}=t,{metric:b}=t,{updateData:I}=t,{colorScheme:a}=t,{updateMetricLayer:G}=t,{clade:W}=t,{updateClade:he}=t,{clades:ae}=t,{isBuilt:ue}=t,{showEcoregions:be}=t,{isFinishedBuilding:Ke}=t,ot;function tt(Pt){b=Pt,n(0,b)}const lt=()=>G(b);function ut(Pt){W=Pt,n(1,W)}const Tt=()=>I(null);return e.$$set=Pt=>{"selectionData"in Pt&&n(2,g=Pt.selectionData),"metric"in Pt&&n(0,b=Pt.metric),"updateData"in Pt&&n(3,I=Pt.updateData),"colorScheme"in Pt&&n(4,a=Pt.colorScheme),"updateMetricLayer"in Pt&&n(5,G=Pt.updateMetricLayer),"clade"in Pt&&n(1,W=Pt.clade),"updateClade"in Pt&&n(11,he=Pt.updateClade),"clades"in Pt&&n(6,ae=Pt.clades),"isBuilt"in Pt&&n(12,ue=Pt.isBuilt),"showEcoregions"in Pt&&n(7,be=Pt.showEcoregions),"isFinishedBuilding"in Pt&&n(8,Ke=Pt.isFinishedBuilding)},e.$$.update=()=>{e.$$.dirty&5&&g&&n(9,ot=g.properties&&g.properties[b]!==-1),e.$$.dirty&2050&&he(W),e.$$.dirty&33&&G(b)},[b,W,g,I,a,G,ae,be,Ke,ot,c,he,ue,tt,lt,ut,Tt]}class yO extends Lo{constructor(t){super(),Bo(this,t,_O,gO,ho,{selectionData:2,metric:0,updateData:3,colorScheme:4,updateMetricLayer:5,clade:1,updateClade:11,clades:6,isBuilt:12,showEcoregions:7,isFinishedBuilding:8})}}var vO={exports:{}};(function(e,t){(function(n,c){e.exports=c()})(Jf,function(){var n,c,g;function b(a,G){if(!n)n=G;else if(!c)c=G;else{var W="var sharedChunk = {}; ("+n+")(sharedChunk); ("+c+")(sharedChunk);",he={};n(he),g=G(he),typeof window<"u"&&(g.workerUrl=window.URL.createObjectURL(new Blob([W],{type:"text/javascript"})))}}b(["exports"],function(a){function G(f,u,p,S){return new(p||(p=Promise))(function(L,U){function Q(_e){try{Ae(S.next(_e))}catch(Le){U(Le)}}function re(_e){try{Ae(S.throw(_e))}catch(Le){U(Le)}}function Ae(_e){var Le;_e.done?L(_e.value):(Le=_e.value,Le instanceof p?Le:new p(function(qe){qe(Le)})).then(Q,re)}Ae((S=S.apply(f,u||[])).next())})}function W(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}typeof SuppressedError=="function"&&SuppressedError;var he=ae;function ae(f,u){this.x=f,this.y=u}ae.prototype={clone:function(){return new ae(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,p=f.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),p=Math.sin(f),S=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=S,this},_rotateAround:function(f,u){var p=Math.cos(f),S=Math.sin(f),L=u.y+S*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-S*(this.y-u.y),this.y=L,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ae.convert=function(f){return f instanceof ae?f:Array.isArray(f)?new ae(f[0],f[1]):f};var ue=W(he),be=Ke;function Ke(f,u,p,S){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(S-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=p,this.p2y=S}Ke.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,S=0;S<8;S++){var L=this.sampleCurveX(p)-f;if(Math.abs(L)<u)return p;var U=this.sampleCurveDerivativeX(p);if(Math.abs(U)<1e-6)break;p-=L/U}var Q=0,re=1;for(p=f,S=0;S<20&&(L=this.sampleCurveX(p),!(Math.abs(L-f)<u));S++)f>L?Q=p:re=p,p=.5*(re-Q)+Q;return p},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};var ot=W(be);let tt,lt;function ut(){return tt==null&&(tt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),tt}function Tt(){if(lt==null&&(lt=!1,ut())){const u=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(u){for(let S=0;S<5*5;S++){const L=4*S;u.fillStyle=`rgb(${L},${L+1},${L+2})`,u.fillRect(S%5,Math.floor(S/5),1,1)}const p=u.getImageData(0,0,5,5).data;for(let S=0;S<5*5*4;S++)if(S%4!=3&&p[S]!==S){lt=!0;break}}}return lt||!1}function Pt(f,u,p,S){const L=new ot(f,u,p,S);return function(U){return L.solve(U)}}const zt=Pt(.25,.1,.25,1);function Ge(f,u,p){return Math.min(p,Math.max(u,f))}function Xt(f,u,p){const S=p-u,L=((f-u)%S+S)%S+u;return L===u?p:L}function rt(f,...u){for(const p of u)for(const S in p)f[S]=p[S];return f}let yt=1;function pt(f,u,p){const S={};for(const L in f)S[L]=u.call(p||this,f[L],L,f);return S}function gt(f,u,p){const S={};for(const L in f)u.call(p||this,f[L],L,f)&&(S[L]=f[L]);return S}function bt(f){return Array.isArray(f)?f.map(bt):typeof f=="object"&&f?pt(f,bt):f}const dt={};function $e(f){dt[f]||(typeof console<"u"&&console.warn(f),dt[f]=!0)}function mt(f,u,p){return(p.y-f.y)*(u.x-f.x)>(u.y-f.y)*(p.x-f.x)}function st(f){let u=0;for(let p,S,L=0,U=f.length,Q=U-1;L<U;Q=L++)p=f[L],S=f[Q],u+=(S.x-p.x)*(p.y+S.y);return u}function Nt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Rt=null;function Ot(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const _i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Si(f,u,p,S,L){return G(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const U=new VideoFrame(f,{timestamp:0});try{const Q=U==null?void 0:U.format;if(!Q||!Q.startsWith("BGR")&&!Q.startsWith("RGB"))throw new Error(`Unrecognized format ${Q}`);const re=Q.startsWith("BGR"),Ae=new Uint8ClampedArray(S*L*4);if(yield U.copyTo(Ae,function(_e,Le,qe,et,At){const _t=4*Math.max(-Le,0),Mt=(Math.max(0,qe)-qe)*et*4+_t,Dt=4*et,Bt=Math.max(0,Le),Kt=Math.max(0,qe);return{rect:{x:Bt,y:Kt,width:Math.min(_e.width,Le+et)-Bt,height:Math.min(_e.height,qe+At)-Kt},layout:[{offset:Mt,stride:Dt}]}}(f,u,p,S,L)),re)for(let _e=0;_e<Ae.length;_e+=4){const Le=Ae[_e];Ae[_e]=Ae[_e+2],Ae[_e+2]=Le}return Ae}finally{U.close()}})}let Ti,Oi,tn,qi;const Ni={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){return this.getImageCanvasContext(f).getImageData(-u,-u,f.width+2*u,f.height+2*u)},getImageCanvasContext(f){const u=window.document.createElement("canvas"),p=u.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return u.width=f.width,u.height=f.height,p.drawImage(f,0,0,f.width,f.height),p},resolveURL:f=>(tn||(tn=document.createElement("a")),tn.href=f,tn.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(qi==null&&(qi=matchMedia("(prefers-reduced-motion: reduce)")),qi.matches)}},nn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class yn extends Error{constructor(u,p,S,L){super(`AJAXError: ${p} (${u}): ${S}`),this.status=u,this.statusText=p,this.url=S,this.body=L}}const Ci=Nt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,gi=f=>nn.REGISTERED_PROTOCOLS[f.substring(0,f.indexOf("://"))];function Ri(f,u){const p=new AbortController,S=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Ci(),signal:p.signal});let L=!1,U=!1;return f.type==="json"&&S.headers.set("Accept","application/json"),U||fetch(S).then(Q=>Q.ok?(re=>{(f.type==="arrayBuffer"||f.type==="image"?re.arrayBuffer():f.type==="json"?re.json():re.text()).then(Ae=>{U||(L=!0,u(null,Ae,re.headers.get("Cache-Control"),re.headers.get("Expires")))}).catch(Ae=>{U||u(new Error(Ae.message))})})(Q):Q.blob().then(re=>u(new yn(Q.status,Q.statusText,f.url,re)))).catch(Q=>{Q.code!==20&&u(new Error(Q.message))}),{cancel:()=>{U=!0,L||p.abort()}}}const ai=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Nt())return(gi(f.url)||Ri)(f,u)}if(!(/^file:/.test(p=f.url)||/^file:/.test(Ci())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Ri(f,u);if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var p;return function(S,L){const U=new XMLHttpRequest;U.open(S.method||"GET",S.url,!0),S.type!=="arrayBuffer"&&S.type!=="image"||(U.responseType="arraybuffer");for(const Q in S.headers)U.setRequestHeader(Q,S.headers[Q]);return S.type==="json"&&(U.responseType="text",U.setRequestHeader("Accept","application/json")),U.withCredentials=S.credentials==="include",U.onerror=()=>{L(new Error(U.statusText))},U.onload=()=>{if((U.status>=200&&U.status<300||U.status===0)&&U.response!==null){let Q=U.response;if(S.type==="json")try{Q=JSON.parse(U.response)}catch(re){return L(re)}L(null,Q,U.getResponseHeader("Cache-Control"),U.getResponseHeader("Expires"))}else{const Q=new Blob([U.response],{type:U.getResponseHeader("Content-Type")});L(new yn(U.status,U.statusText,S.url,Q))}},U.send(S.body),{cancel:()=>U.abort()}}(f,u)},Ki=function(f,u){return ai(rt(f,{type:"arrayBuffer"}),u)};function Ji(f){if(!f||f.indexOf("://")<=0||f.indexOf("data:image/")===0||f.indexOf("blob:")===0)return!0;const u=new URL(f),p=window.location;return u.protocol===p.protocol&&u.host===p.host}function fi(f,u,p){p[f]&&p[f].indexOf(u)!==-1||(p[f]=p[f]||[],p[f].push(u))}function pn(f,u,p){if(p&&p[f]){const S=p[f].indexOf(u);S!==-1&&p[f].splice(S,1)}}class ii{constructor(u,p={}){rt(this,p),this.type=u}}class wn extends ii{constructor(u,p={}){super("error",rt({error:u},p))}}class Rr{on(u,p){return this._listeners=this._listeners||{},fi(u,p,this._listeners),this}off(u,p){return pn(u,p,this._listeners),pn(u,p,this._oneTimeListeners),this}once(u,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},fi(u,p,this._oneTimeListeners),this):new Promise(S=>this.once(u,S))}fire(u,p){typeof u=="string"&&(u=new ii(u,p||{}));const S=u.type;if(this.listens(S)){u.target=this;const L=this._listeners&&this._listeners[S]?this._listeners[S].slice():[];for(const re of L)re.call(this,u);const U=this._oneTimeListeners&&this._oneTimeListeners[S]?this._oneTimeListeners[S].slice():[];for(const re of U)pn(S,re,this._oneTimeListeners),re.call(this,u);const Q=this._eventedParent;Q&&(rt(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Q.fire(u))}else u instanceof wn&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var hi={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const en=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function tr(f,u){const p={};for(const S in f)S!=="ref"&&(p[S]=f[S]);return en.forEach(S=>{S in u&&(p[S]=u[S])}),p}function Fn(f,u){if(Array.isArray(f)){if(!Array.isArray(u)||f.length!==u.length)return!1;for(let p=0;p<f.length;p++)if(!Fn(f[p],u[p]))return!1;return!0}if(typeof f=="object"&&f!==null&&u!==null){if(typeof u!="object"||Object.keys(f).length!==Object.keys(u).length)return!1;for(const p in f)if(!Fn(f[p],u[p]))return!1;return!0}return f===u}const Qn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function In(f,u,p){p.push({command:Qn.addSource,args:[f,u[f]]})}function v(f,u,p){u.push({command:Qn.removeSource,args:[f]}),p[f]=!0}function k(f,u,p,S){v(f,p,S),In(f,u,p)}function V(f,u,p){let S;for(S in f[p])if(Object.prototype.hasOwnProperty.call(f[p],S)&&S!=="data"&&!Fn(f[p][S],u[p][S]))return!1;for(S in u[p])if(Object.prototype.hasOwnProperty.call(u[p],S)&&S!=="data"&&!Fn(f[p][S],u[p][S]))return!1;return!0}function $(f,u,p,S,L,U){let Q;for(Q in u=u||{},f=f||{})Object.prototype.hasOwnProperty.call(f,Q)&&(Fn(f[Q],u[Q])||p.push({command:U,args:[S,Q,u[Q],L]}));for(Q in u)Object.prototype.hasOwnProperty.call(u,Q)&&!Object.prototype.hasOwnProperty.call(f,Q)&&(Fn(f[Q],u[Q])||p.push({command:U,args:[S,Q,u[Q],L]}))}function te(f){return f.id}function fe(f,u){return f[u.id]=u,f}class ve{constructor(u,p,S,L){this.message=(u?`${u}: `:"")+S,L&&(this.identifier=L),p!=null&&p.__line__&&(this.line=p.__line__)}}function Ie(f,...u){for(const p of u)for(const S in p)f[S]=p[S];return f}class Ee extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class ze{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[S,L]of p)this.bindings[S]=L}concat(u){return new ze(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const Qe={kind:"null"},He={kind:"number"},Ze={kind:"string"},Ve={kind:"boolean"},ft={kind:"color"},nt={kind:"object"},Me={kind:"value"},se={kind:"collator"},ne={kind:"formatted"},X={kind:"padding"},ie={kind:"resolvedImage"},de={kind:"variableAnchorOffsetCollection"};function ye(f,u){return{kind:"array",itemType:f,N:u}}function ge(f){if(f.kind==="array"){const u=ge(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Pe=[Qe,He,Ze,Ve,ft,ne,nt,ye(Me),X,ie,de];function Fe(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Fe(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const p of Pe)if(!Fe(p,u))return null}}return`Expected ${ge(f)} but found ${ge(u)} instead.`}function Ne(f,u){return u.some(p=>p.kind===f.kind)}function Xe(f,u){return u.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}function Ye(f,u){return f.kind==="array"&&u.kind==="array"?f.itemType.kind===u.itemType.kind&&typeof f.N=="number":f.kind===u.kind}const De=.96422,Ue=.82521,ht=4/29,kt=6/29,o=3*kt*kt,ke=kt*kt*kt,oi=Math.PI/180,di=180/Math.PI;function Ai(f){return(f%=360)<0&&(f+=360),f}function Jt([f,u,p,S]){let L,U;const Q=zi((.2225045*(f=li(f))+.7168786*(u=li(u))+.0606169*(p=li(p)))/1);f===u&&u===p?L=U=Q:(L=zi((.4360747*f+.3850649*u+.1430804*p)/De),U=zi((.0139322*f+.0971045*u+.7141733*p)/Ue));const re=116*Q-16;return[re<0?0:re,500*(L-Q),200*(Q-U),S]}function li(f){return f<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function zi(f){return f>ke?Math.pow(f,1/3):f/o+ht}function vi([f,u,p,S]){let L=(f+16)/116,U=isNaN(u)?L:L+u/500,Q=isNaN(p)?L:L-p/200;return L=1*$t(L),U=De*$t(U),Q=Ue*$t(Q),[wi(3.1338561*U-1.6168667*L-.4906146*Q),wi(-.9787684*U+1.9161415*L+.033454*Q),wi(.0719453*U-.2289914*L+1.4052427*Q),S]}function wi(f){return(f=f<=.00304?12.92*f:1.055*Math.pow(f,1/2.4)-.055)<0?0:f>1?1:f}function $t(f){return f>kt?f*f*f:o*(f-ht)}function vn(f){return parseInt(f.padEnd(2,f),16)/255}function or(f,u){return mn(u?f/100:f,0,1)}function mn(f,u,p){return Math.min(Math.max(u,f),p)}function qn(f){return!f.some(Number.isNaN)}const jr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Hi{constructor(u,p,S,L=1,U=!0){this.r=u,this.g=p,this.b=S,this.a=L,U||(this.r*=L,this.g*=L,this.b*=L,L||this.overwriteGetter("rgb",[u,p,S,L]))}static parse(u){if(u instanceof Hi)return u;if(typeof u!="string")return;const p=function(S){if((S=S.toLowerCase().trim())==="transparent")return[0,0,0,0];const L=jr[S];if(L){const[Q,re,Ae]=L;return[Q/255,re/255,Ae/255,1]}if(S.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(S)){const Q=S.length<6?1:2;let re=1;return[vn(S.slice(re,re+=Q)),vn(S.slice(re,re+=Q)),vn(S.slice(re,re+=Q)),vn(S.slice(re,re+Q)||"ff")]}if(S.startsWith("rgb")){const Q=S.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(Q){const[re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt]=Q,Ht=[Le||" ",At||" ",Dt].join("");if(Ht==="  "||Ht==="  /"||Ht===",,"||Ht===",,,"){const Zt=[_e,et,Mt].join(""),ci=Zt==="%%%"?100:Zt===""?255:0;if(ci){const yi=[mn(+Ae/ci,0,1),mn(+qe/ci,0,1),mn(+_t/ci,0,1),Bt?or(+Bt,Kt):1];if(qn(yi))return yi}}return}}const U=S.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(U){const[Q,re,Ae,_e,Le,qe,et,At,_t]=U,Mt=[Ae||" ",Le||" ",et].join("");if(Mt==="  "||Mt==="  /"||Mt===",,"||Mt===",,,"){const Dt=[+re,mn(+_e,0,100),mn(+qe,0,100),At?or(+At,_t):1];if(qn(Dt))return function([Bt,Kt,Ht,Zt]){function ci(yi){const Xi=(yi+Bt/30)%12,xn=Kt*Math.min(Ht,1-Ht);return Ht-xn*Math.max(-1,Math.min(Xi-3,9-Xi,1))}return Bt=Ai(Bt),Kt/=100,Ht/=100,[ci(0),ci(8),ci(4),Zt]}(Dt)}}}(u);return p?new Hi(...p,!1):void 0}get rgb(){const{r:u,g:p,b:S,a:L}=this,U=L||1/0;return this.overwriteGetter("rgb",[u/U,p/U,S/U,L])}get hcl(){return this.overwriteGetter("hcl",function(u){const[p,S,L,U]=Jt(u),Q=Math.sqrt(S*S+L*L);return[Math.round(1e4*Q)?Ai(Math.atan2(L,S)*di):NaN,Q,p,U]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Jt(this.rgb))}overwriteGetter(u,p){return Object.defineProperty(this,u,{value:p}),p}toString(){const[u,p,S,L]=this.rgb;return`rgba(${[u,p,S].map(U=>Math.round(255*U)).join(",")},${L})`}}Hi.black=new Hi(0,0,0,1),Hi.white=new Hi(1,1,1,1),Hi.transparent=new Hi(0,0,0,0),Hi.red=new Hi(1,0,0,1);class ur{constructor(u,p,S){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=S,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class On{constructor(u,p,S,L,U){this.text=u,this.image=p,this.scale=S,this.fontStack=L,this.textColor=U}}class Qt{constructor(u){this.sections=u}static fromString(u){return new Qt([new On(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Qt?u:Qt.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Yi{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Yi)return u;if(typeof u=="number")return new Yi([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const p of u)if(typeof p!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Yi(u)}}toString(){return JSON.stringify(this.values)}}const Ut=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Tn{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Tn)return u;if(Array.isArray(u)&&!(u.length<1)&&u.length%2==0){for(let p=0;p<u.length;p+=2){const S=u[p],L=u[p+1];if(typeof S!="string"||!Ut.has(S)||!Array.isArray(L)||L.length!==2||typeof L[0]!="number"||typeof L[1]!="number")return}return new Tn(u)}}toString(){return JSON.stringify(this.values)}}class cr{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new cr({name:u,available:!1}):null}}function Ns(f,u,p,S){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?S===void 0||typeof S=="number"&&S>=0&&S<=1?null:`Invalid rgba value [${[f,u,p,S].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof S=="number"?[f,u,p,S]:[f,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ur(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof Hi||f instanceof ur||f instanceof Qt||f instanceof Yi||f instanceof Tn||f instanceof cr)return!0;if(Array.isArray(f)){for(const u of f)if(!Ur(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!Ur(f[u]))return!1;return!0}return!1}function Vt(f){if(f===null)return Qe;if(typeof f=="string")return Ze;if(typeof f=="boolean")return Ve;if(typeof f=="number")return He;if(f instanceof Hi)return ft;if(f instanceof ur)return se;if(f instanceof Qt)return ne;if(f instanceof Yi)return X;if(f instanceof Tn)return de;if(f instanceof cr)return ie;if(Array.isArray(f)){const u=f.length;let p;for(const S of f){const L=Vt(S);if(p){if(p===L)continue;p=Me;break}p=L}return ye(p||Me,u)}return nt}function hr(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof Hi||f instanceof Qt||f instanceof Yi||f instanceof Tn||f instanceof cr?f.toString():JSON.stringify(f)}class Lt{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!Ur(u[1]))return p.error("invalid value");const S=u[1];let L=Vt(S);const U=p.expectedType;return L.kind!=="array"||L.N!==0||!U||U.kind!=="array"||typeof U.N=="number"&&U.N!==0||(L=U),new Lt(L,S)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Fr{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const Vs={string:Ze,number:He,boolean:Ve,object:nt};class ua{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let S,L=1;const U=u[0];if(U==="array"){let re,Ae;if(u.length>2){const _e=u[1];if(typeof _e!="string"||!(_e in Vs)||_e==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);re=Vs[_e],L++}else re=Me;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);Ae=u[2],L++}S=ye(re,Ae)}else{if(!Vs[U])throw new Error(`Types doesn't contain name = ${U}`);S=Vs[U]}const Q=[];for(;L<u.length;L++){const re=p.parse(u[L],L,Me);if(!re)return null;Q.push(re)}return new ua(S,Q)}evaluate(u){for(let p=0;p<this.args.length;p++){const S=this.args[p].evaluate(u);if(!Fe(this.type,Vt(S)))return S;if(p===this.args.length-1)throw new Fr(`Expected value to be of type ${ge(this.type)}, but found ${ge(Vt(S))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const Pr={"to-boolean":Ve,"to-color":ft,"to-number":He,"to-string":Ze};class Fa{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const S=u[0];if(!Pr[S])throw new Error(`Can't parse ${S} as it is not part of the known types`);if((S==="to-boolean"||S==="to-string")&&u.length!==2)return p.error("Expected one argument.");const L=Pr[S],U=[];for(let Q=1;Q<u.length;Q++){const re=p.parse(u[Q],Q,Me);if(!re)return null;U.push(re)}return new Fa(L,U)}evaluate(u){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(u);case"color":{let p,S;for(const L of this.args){if(p=L.evaluate(u),S=null,p instanceof Hi)return p;if(typeof p=="string"){const U=u.parseColor(p);if(U)return U}else if(Array.isArray(p)&&(S=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:Ns(p[0],p[1],p[2],p[3]),!S))return new Hi(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Fr(S||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const S of this.args){p=S.evaluate(u);const L=Yi.parse(p);if(L)return L}throw new Fr(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const S of this.args){p=S.evaluate(u);const L=Tn.parse(p);if(L)return L}throw new Fr(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const S of this.args){if(p=S.evaluate(u),p===null)return 0;const L=Number(p);if(!isNaN(L))return L}throw new Fr(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return Qt.fromString(hr(this.args[0].evaluate(u)));case"resolvedImage":return cr.fromString(hr(this.args[0].evaluate(u)));default:return hr(this.args[0].evaluate(u))}}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const zo=["Unknown","Point","LineString","Polygon"];class Oa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?zo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=Hi.parse(u)),p}}class Ys{constructor(u,p,S=[],L,U=new ze,Q=[]){this.registry=u,this.path=S,this.key=S.map(re=>`[${re}]`).join(""),this.scope=U,this.errors=Q,this.expectedType=L,this._isConstant=p}parse(u,p,S,L,U={}){return p?this.concat(p,S,L)._parse(u,U):this._parse(u,U)}_parse(u,p){function S(L,U,Q){return Q==="assert"?new ua(U,[L]):Q==="coerce"?new Fa(U,[L]):L}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const L=u[0];if(typeof L!="string")return this.error(`Expression name must be a string, but found ${typeof L} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const U=this.registry[L];if(U){let Q=U.parse(u,this);if(!Q)return null;if(this.expectedType){const re=this.expectedType,Ae=Q.type;if(re.kind!=="string"&&re.kind!=="number"&&re.kind!=="boolean"&&re.kind!=="object"&&re.kind!=="array"||Ae.kind!=="value")if(re.kind!=="color"&&re.kind!=="formatted"&&re.kind!=="resolvedImage"||Ae.kind!=="value"&&Ae.kind!=="string")if(re.kind!=="padding"||Ae.kind!=="value"&&Ae.kind!=="number"&&Ae.kind!=="array")if(re.kind!=="variableAnchorOffsetCollection"||Ae.kind!=="value"&&Ae.kind!=="array"){if(this.checkSubtype(re,Ae))return null}else Q=S(Q,re,p.typeAnnotation||"coerce");else Q=S(Q,re,p.typeAnnotation||"coerce");else Q=S(Q,re,p.typeAnnotation||"coerce");else Q=S(Q,re,p.typeAnnotation||"assert")}if(!(Q instanceof Lt)&&Q.type.kind!=="resolvedImage"&&this._isConstant(Q)){const re=new Oa;try{Q=new Lt(Q.type,Q.evaluate(re))}catch(Ae){return this.error(Ae.message),null}}return Q}return this.error(`Unknown expression "${L}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,S){const L=typeof u=="number"?this.path.concat(u):this.path,U=S?this.scope.concat(S):this.scope;return new Ys(this.registry,this._isConstant,L,p||null,U,this.errors)}error(u,...p){const S=`${this.key}${p.map(L=>`[${L}]`).join("")}`;this.errors.push(new Ee(S,u))}checkSubtype(u,p){const S=Fe(u,p);return S&&this.error(S),S}}class Zn{constructor(u,p,S){this.type=se,this.locale=S,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const S=u[1];if(typeof S!="object"||Array.isArray(S))return p.error("Collator options argument must be an object.");const L=p.parse(S["case-sensitive"]!==void 0&&S["case-sensitive"],1,Ve);if(!L)return null;const U=p.parse(S["diacritic-sensitive"]!==void 0&&S["diacritic-sensitive"],1,Ve);if(!U)return null;let Q=null;return S.locale&&(Q=p.parse(S.locale,1,Ze),!Q)?null:new Zn(L,U,Q)}evaluate(u){return new ur(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const aa=8192;function ls(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function Na(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function al(f,u){const p=(180+f[0])/360,S=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,L=Math.pow(2,u.z);return[Math.round(p*L*aa),Math.round(S*L*aa)]}function ol(f,u,p){const S=f[0]-u[0],L=f[1]-u[1],U=f[0]-p[0],Q=f[1]-p[1];return S*Q-U*L==0&&S*U<=0&&L*Q<=0}function to(f,u){let p=!1;for(let Q=0,re=u.length;Q<re;Q++){const Ae=u[Q];for(let _e=0,Le=Ae.length;_e<Le-1;_e++){if(ol(f,Ae[_e],Ae[_e+1]))return!1;(L=Ae[_e])[1]>(S=f)[1]!=(U=Ae[_e+1])[1]>S[1]&&S[0]<(U[0]-L[0])*(S[1]-L[1])/(U[1]-L[1])+L[0]&&(p=!p)}}var S,L,U;return p}function Va(f,u){for(let p=0;p<u.length;p++)if(to(f,u[p]))return!0;return!1}function N(f,u,p,S){const L=S[0]-p[0],U=S[1]-p[1],Q=(f[0]-p[0])*U-L*(f[1]-p[1]),re=(u[0]-p[0])*U-L*(u[1]-p[1]);return Q>0&&re<0||Q<0&&re>0}function xe(f,u,p){for(const _e of p)for(let Le=0;Le<_e.length-1;++Le)if((re=[(Q=_e[Le+1])[0]-(U=_e[Le])[0],Q[1]-U[1]])[0]*(Ae=[(L=u)[0]-(S=f)[0],L[1]-S[1]])[1]-re[1]*Ae[0]!=0&&N(S,L,U,Q)&&N(U,Q,S,L))return!0;var S,L,U,Q,re,Ae;return!1}function it(f,u){for(let p=0;p<f.length;++p)if(!to(f[p],u))return!1;for(let p=0;p<f.length-1;++p)if(xe(f[p],f[p+1],u))return!1;return!0}function It(f,u){for(let p=0;p<u.length;p++)if(it(f,u[p]))return!0;return!1}function Wt(f,u,p){const S=[];for(let L=0;L<f.length;L++){const U=[];for(let Q=0;Q<f[L].length;Q++){const re=al(f[L][Q],p);ls(u,re),U.push(re)}S.push(U)}return S}function Ii(f,u,p){const S=[];for(let L=0;L<f.length;L++){const U=Wt(f[L],u,p);S.push(U)}return S}function Li(f,u,p,S){if(f[0]<p[0]||f[0]>p[2]){const L=.5*S;let U=f[0]-p[0]>L?-S:p[0]-f[0]>L?S:0;U===0&&(U=f[0]-p[2]>L?-S:p[2]-f[0]>L?S:0),f[0]+=U}ls(u,f)}function cn(f,u,p,S){const L=Math.pow(2,S.z)*aa,U=[S.x*aa,S.y*aa],Q=[];for(const re of f)for(const Ae of re){const _e=[Ae.x+U[0],Ae.y+U[1]];Li(_e,u,p,L),Q.push(_e)}return Q}function fn(f,u,p,S){const L=Math.pow(2,S.z)*aa,U=[S.x*aa,S.y*aa],Q=[];for(const Ae of f){const _e=[];for(const Le of Ae){const qe=[Le.x+U[0],Le.y+U[1]];ls(u,qe),_e.push(qe)}Q.push(_e)}if(u[2]-u[0]<=L/2){(re=u)[0]=re[1]=1/0,re[2]=re[3]=-1/0;for(const Ae of Q)for(const _e of Ae)Li(_e,u,p,L)}var re;return Q}class sr{constructor(u,p){this.type=Ve,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Ur(u[1])){const S=u[1];if(S.type==="FeatureCollection")for(let L=0;L<S.features.length;++L){const U=S.features[L].geometry.type;if(U==="Polygon"||U==="MultiPolygon")return new sr(S,S.features[L].geometry)}else if(S.type==="Feature"){const L=S.geometry.type;if(L==="Polygon"||L==="MultiPolygon")return new sr(S,S.geometry)}else if(S.type==="Polygon"||S.type==="MultiPolygon")return new sr(S,S)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,S){const L=[1/0,1/0,-1/0,-1/0],U=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(S.type==="Polygon"){const re=Wt(S.coordinates,U,Q),Ae=cn(p.geometry(),L,U,Q);if(!Na(L,U))return!1;for(const _e of Ae)if(!to(_e,re))return!1}if(S.type==="MultiPolygon"){const re=Ii(S.coordinates,U,Q),Ae=cn(p.geometry(),L,U,Q);if(!Na(L,U))return!1;for(const _e of Ae)if(!Va(_e,re))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,S){const L=[1/0,1/0,-1/0,-1/0],U=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(S.type==="Polygon"){const re=Wt(S.coordinates,U,Q),Ae=fn(p.geometry(),L,U,Q);if(!Na(L,U))return!1;for(const _e of Ae)if(!it(_e,re))return!1}if(S.type==="MultiPolygon"){const re=Ii(S.coordinates,U,Q),Ae=fn(p.geometry(),L,U,Q);if(!Na(L,U))return!1;for(const _e of Ae)if(!It(_e,re))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Ar{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const S=u[1];return p.scope.has(S)?new Ar(S,p.scope.get(S)):p.error(`Unknown variable "${S}". Make sure "${S}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class Or{constructor(u,p,S,L){this.name=u,this.type=p,this._evaluate=S,this.args=L}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,p){const S=u[0],L=Or.definitions[S];if(!L)return p.error(`Unknown expression "${S}". If you wanted a literal array, use ["literal", [...]].`,0);const U=Array.isArray(L)?L[0]:L.type,Q=Array.isArray(L)?[[L[1],L[2]]]:L.overloads,re=Q.filter(([_e])=>!Array.isArray(_e)||_e.length===u.length-1);let Ae=null;for(const[_e,Le]of re){Ae=new Ys(p.registry,Ua,p.path,null,p.scope);const qe=[];let et=!1;for(let At=1;At<u.length;At++){const _t=u[At],Mt=Array.isArray(_e)?_e[At-1]:_e.type,Dt=Ae.parse(_t,1+qe.length,Mt);if(!Dt){et=!0;break}qe.push(Dt)}if(!et)if(Array.isArray(_e)&&_e.length!==qe.length)Ae.error(`Expected ${_e.length} arguments, but found ${qe.length} instead.`);else{for(let At=0;At<qe.length;At++){const _t=Array.isArray(_e)?_e[At]:_e.type,Mt=qe[At];Ae.concat(At+1).checkSubtype(_t,Mt.type)}if(Ae.errors.length===0)return new Or(S,U,Le,qe)}}if(re.length===1)p.errors.push(...Ae.errors);else{const _e=(re.length?re:Q).map(([qe])=>{return et=qe,Array.isArray(et)?`(${et.map(ge).join(", ")})`:`(${ge(et.type)}...)`;var et}).join(" | "),Le=[];for(let qe=1;qe<u.length;qe++){const et=p.parse(u[qe],1+Le.length);if(!et)return null;Le.push(ge(et.type))}p.error(`Expected arguments of type ${_e}, but found (${Le.join(", ")}) instead.`)}return null}static register(u,p){Or.definitions=p;for(const S in p)u[S]=Or}}function Ua(f){if(f instanceof Ar)return Ua(f.boundExpression);if(f instanceof Or&&f.name==="error"||f instanceof Zn||f instanceof sr)return!1;const u=f instanceof Fa||f instanceof ua;let p=!0;return f.eachChild(S=>{p=u?p&&Ua(S):p&&S instanceof Lt}),!!p&&Ga(f)&&pl(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ga(f){if(f instanceof Or&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof sr)return!1;let u=!0;return f.eachChild(p=>{u&&!Ga(p)&&(u=!1)}),u}function qa(f){if(f instanceof Or&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(p=>{u&&!qa(p)&&(u=!1)}),u}function pl(f,u){if(f instanceof Or&&u.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(S=>{p&&!pl(S,u)&&(p=!1)}),p}function Gr(f,u){const p=f.length-1;let S,L,U=0,Q=p,re=0;for(;U<=Q;)if(re=Math.floor((U+Q)/2),S=f[re],L=f[re+1],S<=u){if(re===p||u<L)return re;U=re+1}else{if(!(S>u))throw new Fr("Input is not a number.");Q=re-1}return 0}class nr{constructor(u,p,S){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[L,U]of S)this.labels.push(L),this.outputs.push(U)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const S=p.parse(u[1],1,He);if(!S)return null;const L=[];let U=null;p.expectedType&&p.expectedType.kind!=="value"&&(U=p.expectedType);for(let Q=1;Q<u.length;Q+=2){const re=Q===1?-1/0:u[Q],Ae=u[Q+1],_e=Q,Le=Q+1;if(typeof re!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_e);if(L.length&&L[L.length-1][0]>=re)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_e);const qe=p.parse(Ae,Le,U);if(!qe)return null;U=U||qe.type,L.push([re,qe])}return new nr(U,S,L)}evaluate(u){const p=this.labels,S=this.outputs;if(p.length===1)return S[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return S[0].evaluate(u);const U=p.length;return L>=p[U-1]?S[U-1].evaluate(u):S[Gr(p,L)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function wr(f,u,p){return f+p*(u-f)}function Dr(f,u,p){return f.map((S,L)=>wr(S,u[L],p))}const js={number:wr,color:function(f,u,p,S="rgb"){switch(S){case"rgb":{const[L,U,Q,re]=Dr(f.rgb,u.rgb,p);return new Hi(L,U,Q,re,!1)}case"hcl":{const[L,U,Q,re]=f.hcl,[Ae,_e,Le,qe]=u.hcl;let et,At;if(isNaN(L)||isNaN(Ae))isNaN(L)?isNaN(Ae)?et=NaN:(et=Ae,Q!==1&&Q!==0||(At=_e)):(et=L,Le!==1&&Le!==0||(At=U));else{let Kt=Ae-L;Ae>L&&Kt>180?Kt-=360:Ae<L&&L-Ae>180&&(Kt+=360),et=L+p*Kt}const[_t,Mt,Dt,Bt]=function([Kt,Ht,Zt,ci]){return Kt=isNaN(Kt)?0:Kt*oi,vi([Zt,Math.cos(Kt)*Ht,Math.sin(Kt)*Ht,ci])}([et,At??wr(U,_e,p),wr(Q,Le,p),wr(re,qe,p)]);return new Hi(_t,Mt,Dt,Bt,!1)}case"lab":{const[L,U,Q,re]=vi(Dr(f.lab,u.lab,p));return new Hi(L,U,Q,re,!1)}}},array:Dr,padding:function(f,u,p){return new Yi(Dr(f.values,u.values,p))},variableAnchorOffsetCollection:function(f,u,p){const S=f.values,L=u.values;if(S.length!==L.length)throw new Fr(`Cannot interpolate values of different length. from: ${f.toString()}, to: ${u.toString()}`);const U=[];for(let Q=0;Q<S.length;Q+=2){if(S[Q]!==L[Q])throw new Fr(`Cannot interpolate values containing mismatched anchors. from[${Q}]: ${S[Q]}, to[${Q}]: ${L[Q]}`);U.push(S[Q]);const[re,Ae]=S[Q+1],[_e,Le]=L[Q+1];U.push([wr(re,_e,p),wr(Ae,Le,p)])}return new Tn(U)}};class vr{constructor(u,p,S,L,U){this.type=u,this.operator=p,this.interpolation=S,this.input=L,this.labels=[],this.outputs=[];for(const[Q,re]of U)this.labels.push(Q),this.outputs.push(re)}static interpolationFactor(u,p,S,L){let U=0;if(u.name==="exponential")U=Ks(p,u.base,S,L);else if(u.name==="linear")U=Ks(p,1,S,L);else if(u.name==="cubic-bezier"){const Q=u.controlPoints;U=new ot(Q[0],Q[1],Q[2],Q[3]).solve(Ks(p,1,S,L))}return U}static parse(u,p){let[S,L,U,...Q]=u;if(!Array.isArray(L)||L.length===0)return p.error("Expected an interpolation type expression.",1);if(L[0]==="linear")L={name:"linear"};else if(L[0]==="exponential"){const _e=L[1];if(typeof _e!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);L={name:"exponential",base:_e}}else{if(L[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(L[0])}`,1,0);{const _e=L.slice(1);if(_e.length!==4||_e.some(Le=>typeof Le!="number"||Le<0||Le>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);L={name:"cubic-bezier",controlPoints:_e}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(U=p.parse(U,2,He),!U)return null;const re=[];let Ae=null;S==="interpolate-hcl"||S==="interpolate-lab"?Ae=ft:p.expectedType&&p.expectedType.kind!=="value"&&(Ae=p.expectedType);for(let _e=0;_e<Q.length;_e+=2){const Le=Q[_e],qe=Q[_e+1],et=_e+3,At=_e+4;if(typeof Le!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',et);if(re.length&&re[re.length-1][0]>=Le)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',et);const _t=p.parse(qe,At,Ae);if(!_t)return null;Ae=Ae||_t.type,re.push([Le,_t])}return Ye(Ae,He)||Ye(Ae,ft)||Ye(Ae,X)||Ye(Ae,de)||Ye(Ae,ye(He))?new vr(Ae,S,L,U,re):p.error(`Type ${ge(Ae)} is not interpolatable.`)}evaluate(u){const p=this.labels,S=this.outputs;if(p.length===1)return S[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return S[0].evaluate(u);const U=p.length;if(L>=p[U-1])return S[U-1].evaluate(u);const Q=Gr(p,L),re=vr.interpolationFactor(this.interpolation,L,p[Q],p[Q+1]),Ae=S[Q].evaluate(u),_e=S[Q+1].evaluate(u);switch(this.operator){case"interpolate":return js[this.type.kind](Ae,_e,re);case"interpolate-hcl":return js.color(Ae,_e,re,"hcl");case"interpolate-lab":return js.color(Ae,_e,re,"lab")}}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ks(f,u,p,S){const L=S-p,U=f-p;return L===0?0:u===1?U/L:(Math.pow(u,U)-1)/(Math.pow(u,L)-1)}class Lr{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let S=null;const L=p.expectedType;L&&L.kind!=="value"&&(S=L);const U=[];for(const re of u.slice(1)){const Ae=p.parse(re,1+U.length,S,void 0,{typeAnnotation:"omit"});if(!Ae)return null;S=S||Ae.type,U.push(Ae)}if(!S)throw new Error("No output type");const Q=L&&U.some(re=>Fe(L,re.type));return new Lr(Q?Me:S,U)}evaluate(u){let p,S=null,L=0;for(const U of this.args)if(L++,S=U.evaluate(u),S&&S instanceof cr&&!S.available&&(p||(p=S.name),S=null,L===this.args.length&&(S=p)),S!==null)break;return S}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class So{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const S=[];for(let U=1;U<u.length-1;U+=2){const Q=u[U];if(typeof Q!="string")return p.error(`Expected string, but found ${typeof Q} instead.`,U);if(/[^a-zA-Z0-9_]/.test(Q))return p.error("Variable names must contain only alphanumeric characters or '_'.",U);const re=p.parse(u[U+1],U+1);if(!re)return null;S.push([Q,re])}const L=p.parse(u[u.length-1],u.length-1,p.expectedType,S);return L?new So(S,L):null}outputDefined(){return this.result.outputDefined()}}class Zo{constructor(u,p,S){this.type=u,this.index=p,this.input=S}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,He),L=p.parse(u[2],2,ye(p.expectedType||Me));return S&&L?new Zo(L.type.itemType,S,L):null}evaluate(u){const p=this.index.evaluate(u),S=this.input.evaluate(u);if(p<0)throw new Fr(`Array index out of bounds: ${p} < 0.`);if(p>=S.length)throw new Fr(`Array index out of bounds: ${p} > ${S.length-1}.`);if(p!==Math.floor(p))throw new Fr(`Array index must be an integer, but found ${p} instead.`);return S[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Ls{constructor(u,p){this.type=Ve,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);return S&&L?Ne(S.type,[Ve,Ze,He,Qe,Me])?new Ls(S,L):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(S.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),S=this.haystack.evaluate(u);if(!S)return!1;if(!Xe(p,["boolean","string","number","null"]))throw new Fr(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(S,["string","array"]))throw new Fr(`Expected second argument to be of type array or string, but found ${ge(Vt(S))} instead.`);return S.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class Il{constructor(u,p,S){this.type=He,this.needle=u,this.haystack=p,this.fromIndex=S}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);if(!S||!L)return null;if(!Ne(S.type,[Ve,Ze,He,Qe,Me]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(S.type)} instead`);if(u.length===4){const U=p.parse(u[3],3,He);return U?new Il(S,L,U):null}return new Il(S,L)}evaluate(u){const p=this.needle.evaluate(u),S=this.haystack.evaluate(u);if(!Xe(p,["boolean","string","number","null"]))throw new Fr(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(S,["string","array"]))throw new Fr(`Expected second argument to be of type array or string, but found ${ge(Vt(S))} instead.`);if(this.fromIndex){const L=this.fromIndex.evaluate(u);return S.indexOf(p,L)}return S.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class Ao{constructor(u,p,S,L,U,Q){this.inputType=u,this.type=p,this.input=S,this.cases=L,this.outputs=U,this.otherwise=Q}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let S,L;p.expectedType&&p.expectedType.kind!=="value"&&(L=p.expectedType);const U={},Q=[];for(let _e=2;_e<u.length-1;_e+=2){let Le=u[_e];const qe=u[_e+1];Array.isArray(Le)||(Le=[Le]);const et=p.concat(_e);if(Le.length===0)return et.error("Expected at least one branch label.");for(const _t of Le){if(typeof _t!="number"&&typeof _t!="string")return et.error("Branch labels must be numbers or strings.");if(typeof _t=="number"&&Math.abs(_t)>Number.MAX_SAFE_INTEGER)return et.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof _t=="number"&&Math.floor(_t)!==_t)return et.error("Numeric branch labels must be integer values.");if(S){if(et.checkSubtype(S,Vt(_t)))return null}else S=Vt(_t);if(U[String(_t)]!==void 0)return et.error("Branch labels must be unique.");U[String(_t)]=Q.length}const At=p.parse(qe,_e,L);if(!At)return null;L=L||At.type,Q.push(At)}const re=p.parse(u[1],1,Me);if(!re)return null;const Ae=p.parse(u[u.length-1],u.length-1,L);return Ae?re.type.kind!=="value"&&p.concat(1).checkSubtype(S,re.type)?null:new Ao(S,L,re,U,Q,Ae):null}evaluate(u){const p=this.input.evaluate(u);return(Vt(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class Qo{constructor(u,p,S){this.type=u,this.branches=p,this.otherwise=S}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let S;p.expectedType&&p.expectedType.kind!=="value"&&(S=p.expectedType);const L=[];for(let Q=1;Q<u.length-1;Q+=2){const re=p.parse(u[Q],Q,Ve);if(!re)return null;const Ae=p.parse(u[Q+1],Q+1,S);if(!Ae)return null;L.push([re,Ae]),S=S||Ae.type}const U=p.parse(u[u.length-1],u.length-1,S);if(!U)return null;if(!S)throw new Error("Can't infer output type");return new Qo(S,L,U)}evaluate(u){for(const[p,S]of this.branches)if(p.evaluate(u))return S.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,S]of this.branches)u(p),u(S);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class ca{constructor(u,p,S,L){this.type=u,this.input=p,this.beginIndex=S,this.endIndex=L}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,Me),L=p.parse(u[2],2,He);if(!S||!L)return null;if(!Ne(S.type,[ye(Me),Ze,Me]))return p.error(`Expected first argument to be of type array or string, but found ${ge(S.type)} instead`);if(u.length===4){const U=p.parse(u[3],3,He);return U?new ca(S.type,S,L,U):null}return new ca(S.type,S,L)}evaluate(u){const p=this.input.evaluate(u),S=this.beginIndex.evaluate(u);if(!Xe(p,["string","array"]))throw new Fr(`Expected first argument to be of type array or string, but found ${ge(Vt(p))} instead.`);if(this.endIndex){const L=this.endIndex.evaluate(u);return p.slice(S,L)}return p.slice(S)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function $s(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function El(f,u,p,S){return S.compare(u,p)===0}function Ha(f,u,p){const S=f!=="=="&&f!=="!=";return class n5{constructor(U,Q,re){this.type=Ve,this.lhs=U,this.rhs=Q,this.collator=re,this.hasUntypedArgument=U.type.kind==="value"||Q.type.kind==="value"}static parse(U,Q){if(U.length!==3&&U.length!==4)return Q.error("Expected two or three arguments.");const re=U[0];let Ae=Q.parse(U[1],1,Me);if(!Ae)return null;if(!$s(re,Ae.type))return Q.concat(1).error(`"${re}" comparisons are not supported for type '${ge(Ae.type)}'.`);let _e=Q.parse(U[2],2,Me);if(!_e)return null;if(!$s(re,_e.type))return Q.concat(2).error(`"${re}" comparisons are not supported for type '${ge(_e.type)}'.`);if(Ae.type.kind!==_e.type.kind&&Ae.type.kind!=="value"&&_e.type.kind!=="value")return Q.error(`Cannot compare types '${ge(Ae.type)}' and '${ge(_e.type)}'.`);S&&(Ae.type.kind==="value"&&_e.type.kind!=="value"?Ae=new ua(_e.type,[Ae]):Ae.type.kind!=="value"&&_e.type.kind==="value"&&(_e=new ua(Ae.type,[_e])));let Le=null;if(U.length===4){if(Ae.type.kind!=="string"&&_e.type.kind!=="string"&&Ae.type.kind!=="value"&&_e.type.kind!=="value")return Q.error("Cannot use collator to compare non-string types.");if(Le=Q.parse(U[3],3,se),!Le)return null}return new n5(Ae,_e,Le)}evaluate(U){const Q=this.lhs.evaluate(U),re=this.rhs.evaluate(U);if(S&&this.hasUntypedArgument){const Ae=Vt(Q),_e=Vt(re);if(Ae.kind!==_e.kind||Ae.kind!=="string"&&Ae.kind!=="number")throw new Fr(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Ae.kind}, ${_e.kind}) instead.`)}if(this.collator&&!S&&this.hasUntypedArgument){const Ae=Vt(Q),_e=Vt(re);if(Ae.kind!=="string"||_e.kind!=="string")return u(U,Q,re)}return this.collator?p(U,Q,re,this.collator.evaluate(U)):u(U,Q,re)}eachChild(U){U(this.lhs),U(this.rhs),this.collator&&U(this.collator)}outputDefined(){return!0}}}const Ta=Ha("==",function(f,u,p){return u===p},El),ml=Ha("!=",function(f,u,p){return u!==p},function(f,u,p,S){return!El(0,u,p,S)}),Cl=Ha("<",function(f,u,p){return u<p},function(f,u,p,S){return S.compare(u,p)<0}),mu=Ha(">",function(f,u,p){return u>p},function(f,u,p,S){return S.compare(u,p)>0}),us=Ha("<=",function(f,u,p){return u<=p},function(f,u,p,S){return S.compare(u,p)<=0}),rc=Ha(">=",function(f,u,p){return u>=p},function(f,u,p,S){return S.compare(u,p)>=0});class io{constructor(u,p,S,L,U){this.type=Ze,this.number=u,this.locale=p,this.currency=S,this.minFractionDigits=L,this.maxFractionDigits=U}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const S=p.parse(u[1],1,He);if(!S)return null;const L=u[2];if(typeof L!="object"||Array.isArray(L))return p.error("NumberFormat options argument must be an object.");let U=null;if(L.locale&&(U=p.parse(L.locale,1,Ze),!U))return null;let Q=null;if(L.currency&&(Q=p.parse(L.currency,1,Ze),!Q))return null;let re=null;if(L["min-fraction-digits"]&&(re=p.parse(L["min-fraction-digits"],1,He),!re))return null;let Ae=null;return L["max-fraction-digits"]&&(Ae=p.parse(L["max-fraction-digits"],1,He),!Ae)?null:new io(S,U,Q,re,Ae)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class no{constructor(u){this.type=ne,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const S=u[1];if(!Array.isArray(S)&&typeof S=="object")return p.error("First argument must be an image or text section.");const L=[];let U=!1;for(let Q=1;Q<=u.length-1;++Q){const re=u[Q];if(U&&typeof re=="object"&&!Array.isArray(re)){U=!1;let Ae=null;if(re["font-scale"]&&(Ae=p.parse(re["font-scale"],1,He),!Ae))return null;let _e=null;if(re["text-font"]&&(_e=p.parse(re["text-font"],1,ye(Ze)),!_e))return null;let Le=null;if(re["text-color"]&&(Le=p.parse(re["text-color"],1,ft),!Le))return null;const qe=L[L.length-1];qe.scale=Ae,qe.font=_e,qe.textColor=Le}else{const Ae=p.parse(u[Q],1,Me);if(!Ae)return null;const _e=Ae.type.kind;if(_e!=="string"&&_e!=="value"&&_e!=="null"&&_e!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");U=!0,L.push({content:Ae,scale:null,font:null,textColor:null})}}return new no(L)}evaluate(u){return new Qt(this.sections.map(p=>{const S=p.content.evaluate(u);return Vt(S)===ie?new On("",S,null,null,null):new On(hr(S),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}}class ql{constructor(u){this.type=ie,this.input=u}static parse(u,p){if(u.length!==2)return p.error("Expected two arguments.");const S=p.parse(u[1],1,Ze);return S?new ql(S):p.error("No image name provided.")}evaluate(u){const p=this.input.evaluate(u),S=cr.fromString(p);return S&&u.availableImages&&(S.available=u.availableImages.indexOf(p)>-1),S}eachChild(u){u(this.input)}outputDefined(){return!1}}class Ro{constructor(u){this.type=He,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const S=p.parse(u[1],1);return S?S.type.kind!=="array"&&S.type.kind!=="string"&&S.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${ge(S.type)} instead.`):new Ro(S):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Fr(`Expected value to be of type string or array, but found ${ge(Vt(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Wo={"==":Ta,"!=":ml,">":mu,"<":Cl,">=":rc,"<=":us,array:ua,at:Zo,boolean:ua,case:Qo,coalesce:Lr,collator:Zn,format:no,image:ql,in:Ls,"index-of":Il,interpolate:vr,"interpolate-hcl":vr,"interpolate-lab":vr,length:Ro,let:So,literal:Lt,match:Ao,number:ua,"number-format":io,object:ua,slice:ca,step:nr,string:ua,"to-boolean":Fa,"to-color":Fa,"to-number":Fa,"to-string":Fa,var:Ar,within:sr};function Io(f,[u,p,S,L]){u=u.evaluate(f),p=p.evaluate(f),S=S.evaluate(f);const U=L?L.evaluate(f):1,Q=Ns(u,p,S,U);if(Q)throw new Fr(Q);return new Hi(u/255,p/255,S/255,U,!1)}function Us(f,u){return f in u}function Xo(f,u){const p=u[f];return p===void 0?null:p}function Yo(f){return{type:f}}function $o(f){return{result:"success",value:f}}function ba(f){return{result:"error",value:f}}function ja(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Cs(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function gu(f){return!!f.expression&&f.expression.interpolated}function Sr(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Xn(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function Ko(f){return f}function Br(f,u){const p=u.type==="color",S=f.stops&&typeof f.stops[0][0]=="object",L=S||!(S||f.property!==void 0),U=f.type||(gu(u)?"exponential":"interval");if(p||u.type==="padding"){const Le=p?Hi.parse:Yi.parse;(f=Ie({},f)).stops&&(f.stops=f.stops.map(qe=>[qe[0],Le(qe[1])])),f.default=Le(f.default?f.default:u.default)}if(f.colorSpace&&(Q=f.colorSpace)!=="rgb"&&Q!=="hcl"&&Q!=="lab")throw new Error(`Unknown color space: "${f.colorSpace}"`);var Q;let re,Ae,_e;if(U==="exponential")re=Eo;else if(U==="interval")re=fr;else if(U==="categorical"){re=Jr,Ae=Object.create(null);for(const Le of f.stops)Ae[Le[0]]=Le[1];_e=typeof f.stops[0][0]}else{if(U!=="identity")throw new Error(`Unknown function type "${U}"`);re=Un}if(S){const Le={},qe=[];for(let _t=0;_t<f.stops.length;_t++){const Mt=f.stops[_t],Dt=Mt[0].zoom;Le[Dt]===void 0&&(Le[Dt]={zoom:Dt,type:f.type,property:f.property,default:f.default,stops:[]},qe.push(Dt)),Le[Dt].stops.push([Mt[0].value,Mt[1]])}const et=[];for(const _t of qe)et.push([Le[_t].zoom,Br(Le[_t],u)]);const At={name:"linear"};return{kind:"composite",interpolationType:At,interpolationFactor:vr.interpolationFactor.bind(void 0,At),zoomStops:et.map(_t=>_t[0]),evaluate:({zoom:_t},Mt)=>Eo({stops:et,base:f.base},u,_t).evaluate(_t,Mt)}}if(L){const Le=U==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Le,interpolationFactor:vr.interpolationFactor.bind(void 0,Le),zoomStops:f.stops.map(qe=>qe[0]),evaluate:({zoom:qe})=>re(f,u,qe,Ae,_e)}}return{kind:"source",evaluate(Le,qe){const et=qe&&qe.properties?qe.properties[f.property]:void 0;return et===void 0?Za(f.default,u.default):re(f,u,et,Ae,_e)}}}function Za(f,u,p){return f!==void 0?f:u!==void 0?u:p!==void 0?p:void 0}function Jr(f,u,p,S,L){return Za(typeof p===L?S[p]:void 0,f.default,u.default)}function fr(f,u,p){if(Sr(p)!=="number")return Za(f.default,u.default);const S=f.stops.length;if(S===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[S-1][0])return f.stops[S-1][1];const L=Gr(f.stops.map(U=>U[0]),p);return f.stops[L][1]}function Eo(f,u,p){const S=f.base!==void 0?f.base:1;if(Sr(p)!=="number")return Za(f.default,u.default);const L=f.stops.length;if(L===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[L-1][0])return f.stops[L-1][1];const U=Gr(f.stops.map(Le=>Le[0]),p),Q=function(Le,qe,et,At){const _t=At-et,Mt=Le-et;return _t===0?0:qe===1?Mt/_t:(Math.pow(qe,Mt)-1)/(Math.pow(qe,_t)-1)}(p,S,f.stops[U][0],f.stops[U+1][0]),re=f.stops[U][1],Ae=f.stops[U+1][1],_e=js[u.type]||Ko;return typeof re.evaluate=="function"?{evaluate(...Le){const qe=re.evaluate.apply(void 0,Le),et=Ae.evaluate.apply(void 0,Le);if(qe!==void 0&&et!==void 0)return _e(qe,et,Q,f.colorSpace)}}:_e(re,Ae,Q,f.colorSpace)}function Un(f,u,p){switch(u.type){case"color":p=Hi.parse(p);break;case"formatted":p=Qt.fromString(p.toString());break;case"resolvedImage":p=cr.fromString(p.toString());break;case"padding":p=Yi.parse(p);break;default:Sr(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0)}return Za(p,f.default,u.default)}Or.register(Wo,{error:[{kind:"error"},[Ze],(f,[u])=>{throw new Fr(u.evaluate(f))}],typeof:[Ze,[Me],(f,[u])=>ge(Vt(u.evaluate(f)))],"to-rgba":[ye(He,4),[ft],(f,[u])=>{const[p,S,L,U]=u.evaluate(f).rgb;return[255*p,255*S,255*L,U]}],rgb:[ft,[He,He,He],Io],rgba:[ft,[He,He,He,He],Io],has:{type:Ve,overloads:[[[Ze],(f,[u])=>Us(u.evaluate(f),f.properties())],[[Ze,nt],(f,[u,p])=>Us(u.evaluate(f),p.evaluate(f))]]},get:{type:Me,overloads:[[[Ze],(f,[u])=>Xo(u.evaluate(f),f.properties())],[[Ze,nt],(f,[u,p])=>Xo(u.evaluate(f),p.evaluate(f))]]},"feature-state":[Me,[Ze],(f,[u])=>Xo(u.evaluate(f),f.featureState||{})],properties:[nt,[],f=>f.properties()],"geometry-type":[Ze,[],f=>f.geometryType()],id:[Me,[],f=>f.id()],zoom:[He,[],f=>f.globals.zoom],"heatmap-density":[He,[],f=>f.globals.heatmapDensity||0],"line-progress":[He,[],f=>f.globals.lineProgress||0],accumulated:[Me,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[He,Yo(He),(f,u)=>{let p=0;for(const S of u)p+=S.evaluate(f);return p}],"*":[He,Yo(He),(f,u)=>{let p=1;for(const S of u)p*=S.evaluate(f);return p}],"-":{type:He,overloads:[[[He,He],(f,[u,p])=>u.evaluate(f)-p.evaluate(f)],[[He],(f,[u])=>-u.evaluate(f)]]},"/":[He,[He,He],(f,[u,p])=>u.evaluate(f)/p.evaluate(f)],"%":[He,[He,He],(f,[u,p])=>u.evaluate(f)%p.evaluate(f)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(f,[u,p])=>Math.pow(u.evaluate(f),p.evaluate(f))],sqrt:[He,[He],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[He,[He],(f,[u])=>Math.log(u.evaluate(f))],log2:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[He,[He],(f,[u])=>Math.sin(u.evaluate(f))],cos:[He,[He],(f,[u])=>Math.cos(u.evaluate(f))],tan:[He,[He],(f,[u])=>Math.tan(u.evaluate(f))],asin:[He,[He],(f,[u])=>Math.asin(u.evaluate(f))],acos:[He,[He],(f,[u])=>Math.acos(u.evaluate(f))],atan:[He,[He],(f,[u])=>Math.atan(u.evaluate(f))],min:[He,Yo(He),(f,u)=>Math.min(...u.map(p=>p.evaluate(f)))],max:[He,Yo(He),(f,u)=>Math.max(...u.map(p=>p.evaluate(f)))],abs:[He,[He],(f,[u])=>Math.abs(u.evaluate(f))],round:[He,[He],(f,[u])=>{const p=u.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[He,[He],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[He,[He],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[Ve,[Ze,Me],(f,[u,p])=>f.properties()[u.value]===p.value],"filter-id-==":[Ve,[Me],(f,[u])=>f.id()===u.value],"filter-type-==":[Ve,[Ze],(f,[u])=>f.geometryType()===u.value],"filter-<":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S<L}],"filter-id-<":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p<S}],"filter->":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S>L}],"filter-id->":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p>S}],"filter-<=":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S<=L}],"filter-id-<=":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p<=S}],"filter->=":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S>=L}],"filter-id->=":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p>=S}],"filter-has":[Ve,[Me],(f,[u])=>u.value in f.properties()],"filter-has-id":[Ve,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[Ve,[ye(Ze)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[Ve,[ye(Me)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[Ve,[Ze,ye(Me)],(f,[u,p])=>p.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[Ve,[Ze,ye(Me)],(f,[u,p])=>function(S,L,U,Q){for(;U<=Q;){const re=U+Q>>1;if(L[re]===S)return!0;L[re]>S?Q=re-1:U=re+1}return!1}(f.properties()[u.value],p.value,0,p.value.length-1)],all:{type:Ve,overloads:[[[Ve,Ve],(f,[u,p])=>u.evaluate(f)&&p.evaluate(f)],[Yo(Ve),(f,u)=>{for(const p of u)if(!p.evaluate(f))return!1;return!0}]]},any:{type:Ve,overloads:[[[Ve,Ve],(f,[u,p])=>u.evaluate(f)||p.evaluate(f)],[Yo(Ve),(f,u)=>{for(const p of u)if(p.evaluate(f))return!0;return!1}]]},"!":[Ve,[Ve],(f,[u])=>!u.evaluate(f)],"is-supported-script":[Ve,[Ze],(f,[u])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(u.evaluate(f))}],upcase:[Ze,[Ze],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Ze,[Ze],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Ze,Yo(Me),(f,u)=>u.map(p=>hr(p.evaluate(f))).join("")],"resolved-locale":[Ze,[se],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Ol{constructor(u,p){var S;this.expression=u,this._warningHistory={},this._evaluator=new Oa,this._defaultValue=p?(S=p).type==="color"&&Xn(S.default)?new Hi(0,0,0,0):S.type==="color"?Hi.parse(S.default)||null:S.type==="padding"?Yi.parse(S.default)||null:S.type==="variableAnchorOffsetCollection"?Tn.parse(S.default)||null:S.default===void 0?null:S.default:null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,S,L,U,Q){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=S,this._evaluator.canonical=L,this._evaluator.availableImages=U||null,this._evaluator.formattedSection=Q,this.expression.evaluate(this._evaluator)}evaluate(u,p,S,L,U,Q){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=S||null,this._evaluator.canonical=L,this._evaluator.availableImages=U||null,this._evaluator.formattedSection=Q||null;try{const re=this.expression.evaluate(this._evaluator);if(re==null||typeof re=="number"&&re!=re)return this._defaultValue;if(this._enumValues&&!(re in this._enumValues))throw new Fr(`Expected value to be one of ${Object.keys(this._enumValues).map(Ae=>JSON.stringify(Ae)).join(", ")}, but found ${JSON.stringify(re)} instead.`);return re}catch(re){return this._warningHistory[re.message]||(this._warningHistory[re.message]=!0,typeof console<"u"&&console.warn(re.message)),this._defaultValue}}}function es(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Wo}function Zr(f,u){const p=new Ys(Wo,Ua,[],u?function(L){const U={color:ft,string:Ze,number:He,enum:Ze,boolean:Ve,formatted:ne,padding:X,resolvedImage:ie,variableAnchorOffsetCollection:de};return L.type==="array"?ye(U[L.value]||Me,L.length):U[L.type]}(u):void 0),S=p.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return S?$o(new Ol(S,u)):ba(p.errors)}class Ts{constructor(u,p){this.kind=u,this._styleExpression=p,this.isStateDependent=u!=="constant"&&!qa(p.expression)}evaluateWithoutErrorHandling(u,p,S,L,U,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,S,L,U,Q)}evaluate(u,p,S,L,U,Q){return this._styleExpression.evaluate(u,p,S,L,U,Q)}}class kr{constructor(u,p,S,L){this.kind=u,this.zoomStops=S,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!qa(p.expression),this.interpolationType=L}evaluateWithoutErrorHandling(u,p,S,L,U,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,S,L,U,Q)}evaluate(u,p,S,L,U,Q){return this._styleExpression.evaluate(u,p,S,L,U,Q)}interpolationFactor(u,p,S){return this.interpolationType?vr.interpolationFactor(this.interpolationType,u,p,S):0}}function rr(f,u){const p=Zr(f,u);if(p.result==="error")return p;const S=p.value.expression,L=Ga(S);if(!L&&!ja(u))return ba([new Ee("","data expressions not supported")]);const U=pl(S,["zoom"]);if(!U&&!Cs(u))return ba([new Ee("","zoom expressions not supported")]);const Q=Yr(S);return Q||U?Q instanceof Ee?ba([Q]):Q instanceof vr&&!gu(u)?ba([new Ee("",'"interpolate" expressions cannot be used with this property')]):$o(Q?new kr(L?"camera":"composite",p.value,Q.labels,Q instanceof vr?Q.interpolation:void 0):new Ts(L?"constant":"source",p.value)):ba([new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ll{constructor(u,p){this._parameters=u,this._specification=p,Ie(this,Br(this._parameters,this._specification))}static deserialize(u){return new ll(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function Yr(f){let u=null;if(f instanceof So)u=Yr(f.result);else if(f instanceof Lr){for(const p of f.args)if(u=Yr(p),u)break}else(f instanceof nr||f instanceof vr)&&f.input instanceof Or&&f.input.name==="zoom"&&(u=f);return u instanceof Ee||f.eachChild(p=>{const S=Yr(p);S instanceof Ee?u=S:!u&&S?u=new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&S&&u!==S&&(u=new Ee("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function Co(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!Co(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const ul={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qr(f){if(f==null)return{filter:()=>!0,needGeometry:!1};Co(f)||(f=Tl(f));const u=Zr(f,ul);if(u.result==="error")throw new Error(u.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,S,L)=>u.value.evaluate(p,S,{},L),needGeometry:wa(f)}}function hs(f,u){return f<u?-1:f>u?1:0}function wa(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(wa(f[u]))return!0;return!1}function Tl(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?To(f[1],f[2],"=="):u==="!="?Js(To(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?To(f[1],f[2],u):u==="any"?(p=f.slice(1),["any"].concat(p.map(Tl))):u==="all"?["all"].concat(f.slice(1).map(Tl)):u==="none"?["all"].concat(f.slice(1).map(Tl).map(Js)):u==="in"?kl(f[1],f.slice(2)):u==="!in"?Js(kl(f[1],f.slice(2))):u==="has"?fo(f[1]):u==="!has"?Js(fo(f[1])):u!=="within"||f;var p}function To(f,u,p){switch(f){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,f,u]}}function kl(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",f,["literal",u.sort(hs)]]:["filter-in-small",f,["literal",u]]}}function fo(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Js(f){return["!",f]}function Gs(f){const u=typeof f;if(u==="number"||u==="boolean"||u==="string"||f==null)return JSON.stringify(f);if(Array.isArray(f)){let L="[";for(const U of f)L+=`${Gs(U)},`;return`${L}]`}const p=Object.keys(f).sort();let S="{";for(let L=0;L<p.length;L++)S+=`${JSON.stringify(p[L])}:${Gs(f[p[L]])},`;return`${S}}`}function Qa(f){let u="";for(const p of en)u+=`/${Gs(f[p])}`;return u}function Jo(f){const u=f.value;return u?[new ve(f.key,u,"constants have been deprecated as of v8")]:[]}function $r(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function mr(f){if(Array.isArray(f))return f.map(mr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const p in f)u[p]=mr(f[p]);return u}return $r(f)}function Nr(f){const u=f.key,p=f.value,S=f.valueSpec||{},L=f.objectElementValidators||{},U=f.style,Q=f.styleSpec,re=f.validateSpec;let Ae=[];const _e=Sr(p);if(_e!=="object")return[new ve(u,p,`object expected, ${_e} found`)];for(const Le in p){const qe=Le.split(".")[0],et=S[qe]||S["*"];let At;if(L[qe])At=L[qe];else if(S[qe])At=re;else if(L["*"])At=L["*"];else{if(!S["*"]){Ae.push(new ve(u,p[Le],`unknown property "${Le}"`));continue}At=re}Ae=Ae.concat(At({key:(u&&`${u}.`)+Le,value:p[Le],valueSpec:et,style:U,styleSpec:Q,object:p,objectKey:Le,validateSpec:re},p))}for(const Le in S)L[Le]||S[Le].required&&S[Le].default===void 0&&p[Le]===void 0&&Ae.push(new ve(u,p,`missing required property "${Le}"`));return Ae}function ha(f){const u=f.value,p=f.valueSpec,S=f.style,L=f.styleSpec,U=f.key,Q=f.arrayElementValidator||f.validateSpec;if(Sr(u)!=="array")return[new ve(U,u,`array expected, ${Sr(u)} found`)];if(p.length&&u.length!==p.length)return[new ve(U,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new ve(U,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let re={type:p.value,values:p.values};L.$version<7&&(re.function=p.function),Sr(p.value)==="object"&&(re=p.value);let Ae=[];for(let _e=0;_e<u.length;_e++)Ae=Ae.concat(Q({array:u,arrayIndex:_e,value:u[_e],valueSpec:re,validateSpec:f.validateSpec,style:S,styleSpec:L,key:`${U}[${_e}]`}));return Ae}function po(f){const u=f.key,p=f.value,S=f.valueSpec;let L=Sr(p);return L==="number"&&p!=p&&(L="NaN"),L!=="number"?[new ve(u,p,`number expected, ${L} found`)]:"minimum"in S&&p<S.minimum?[new ve(u,p,`${p} is less than the minimum value ${S.minimum}`)]:"maximum"in S&&p>S.maximum?[new ve(u,p,`${p} is greater than the maximum value ${S.maximum}`)]:[]}function ea(f){const u=f.valueSpec,p=$r(f.value.type);let S,L,U,Q={};const re=p!=="categorical"&&f.value.property===void 0,Ae=!re,_e=Sr(f.value.stops)==="array"&&Sr(f.value.stops[0])==="array"&&Sr(f.value.stops[0][0])==="object",Le=Nr({key:f.key,value:f.value,valueSpec:f.styleSpec.function,validateSpec:f.validateSpec,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(At){if(p==="identity")return[new ve(At.key,At.value,'identity function may not have a "stops" property')];let _t=[];const Mt=At.value;return _t=_t.concat(ha({key:At.key,value:Mt,valueSpec:At.valueSpec,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec,arrayElementValidator:qe})),Sr(Mt)==="array"&&Mt.length===0&&_t.push(new ve(At.key,Mt,"array must have at least one stop")),_t},default:function(At){return At.validateSpec({key:At.key,value:At.value,valueSpec:u,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec})}}});return p==="identity"&&re&&Le.push(new ve(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Le.push(new ve(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!gu(f.valueSpec)&&Le.push(new ve(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Ae&&!ja(f.valueSpec)?Le.push(new ve(f.key,f.value,"property functions not supported")):re&&!Cs(f.valueSpec)&&Le.push(new ve(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!_e||f.value.property!==void 0||Le.push(new ve(f.key,f.value,'"property" property is required')),Le;function qe(At){let _t=[];const Mt=At.value,Dt=At.key;if(Sr(Mt)!=="array")return[new ve(Dt,Mt,`array expected, ${Sr(Mt)} found`)];if(Mt.length!==2)return[new ve(Dt,Mt,`array length 2 expected, length ${Mt.length} found`)];if(_e){if(Sr(Mt[0])!=="object")return[new ve(Dt,Mt,`object expected, ${Sr(Mt[0])} found`)];if(Mt[0].zoom===void 0)return[new ve(Dt,Mt,"object stop key must have zoom")];if(Mt[0].value===void 0)return[new ve(Dt,Mt,"object stop key must have value")];if(U&&U>$r(Mt[0].zoom))return[new ve(Dt,Mt[0].zoom,"stop zoom values must appear in ascending order")];$r(Mt[0].zoom)!==U&&(U=$r(Mt[0].zoom),L=void 0,Q={}),_t=_t.concat(Nr({key:`${Dt}[0]`,value:Mt[0],valueSpec:{zoom:{}},validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec,objectElementValidators:{zoom:po,value:et}}))}else _t=_t.concat(et({key:`${Dt}[0]`,value:Mt[0],valueSpec:{},validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec},Mt));return es(mr(Mt[1]))?_t.concat([new ve(`${Dt}[1]`,Mt[1],"expressions are not allowed in function stops.")]):_t.concat(At.validateSpec({key:`${Dt}[1]`,value:Mt[1],valueSpec:u,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec}))}function et(At,_t){const Mt=Sr(At.value),Dt=$r(At.value),Bt=At.value!==null?At.value:_t;if(S){if(Mt!==S)return[new ve(At.key,Bt,`${Mt} stop domain type must match previous stop domain type ${S}`)]}else S=Mt;if(Mt!=="number"&&Mt!=="string"&&Mt!=="boolean")return[new ve(At.key,Bt,"stop domain value must be a number, string, or boolean")];if(Mt!=="number"&&p!=="categorical"){let Kt=`number expected, ${Mt} found`;return ja(u)&&p===void 0&&(Kt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ve(At.key,Bt,Kt)]}return p!=="categorical"||Mt!=="number"||isFinite(Dt)&&Math.floor(Dt)===Dt?p!=="categorical"&&Mt==="number"&&L!==void 0&&Dt<L?[new ve(At.key,Bt,"stop domain values must appear in ascending order")]:(L=Dt,p==="categorical"&&Dt in Q?[new ve(At.key,Bt,"stop domain values must be unique")]:(Q[Dt]=!0,[])):[new ve(At.key,Bt,`integer expected, found ${Dt}`)]}}function Sa(f){const u=(f.expressionContext==="property"?rr:Zr)(mr(f.value),f.valueSpec);if(u.result==="error")return u.value.map(S=>new ve(`${f.key}${S.key}`,f.value,S.message));const p=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new ve(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!qa(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!qa(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!pl(p,["zoom","feature-state"]))return[new ve(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!Ga(p))return[new ve(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ka(f){const u=f.key,p=f.value,S=f.valueSpec,L=[];return Array.isArray(S.values)?S.values.indexOf($r(p))===-1&&L.push(new ve(u,p,`expected one of [${S.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(S.values).indexOf($r(p))===-1&&L.push(new ve(u,p,`expected one of [${Object.keys(S.values).join(", ")}], ${JSON.stringify(p)} found`)),L}function Wa(f){return Co(mr(f.value))?Sa(Ie({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):cl(f)}function cl(f){const u=f.value,p=f.key;if(Sr(u)!=="array")return[new ve(p,u,`array expected, ${Sr(u)} found`)];const S=f.styleSpec;let L,U=[];if(u.length<1)return[new ve(p,u,"filter array must have at least 1 element")];switch(U=U.concat(ka({key:`${p}[0]`,value:u[0],valueSpec:S.filter_operator,style:f.style,styleSpec:f.styleSpec})),$r(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&$r(u[1])==="$type"&&U.push(new ve(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&U.push(new ve(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(L=Sr(u[1]),L!=="string"&&U.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`)));for(let Q=2;Q<u.length;Q++)L=Sr(u[Q]),$r(u[1])==="$type"?U=U.concat(ka({key:`${p}[${Q}]`,value:u[Q],valueSpec:S.geometry_type,style:f.style,styleSpec:f.styleSpec})):L!=="string"&&L!=="number"&&L!=="boolean"&&U.push(new ve(`${p}[${Q}]`,u[Q],`string, number, or boolean expected, ${L} found`));break;case"any":case"all":case"none":for(let Q=1;Q<u.length;Q++)U=U.concat(cl({key:`${p}[${Q}]`,value:u[Q],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":L=Sr(u[1]),u.length!==2?U.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="string"&&U.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`));break;case"within":L=Sr(u[1]),u.length!==2?U.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="object"&&U.push(new ve(`${p}[1]`,u[1],`object expected, ${L} found`))}return U}function lu(f,u){const p=f.key,S=f.validateSpec,L=f.style,U=f.styleSpec,Q=f.value,re=f.objectKey,Ae=U[`${u}_${f.layerType}`];if(!Ae)return[];const _e=re.match(/^(.*)-transition$/);if(u==="paint"&&_e&&Ae[_e[1]]&&Ae[_e[1]].transition)return S({key:p,value:Q,valueSpec:U.transition,style:L,styleSpec:U});const Le=f.valueSpec||Ae[re];if(!Le)return[new ve(p,Q,`unknown property "${re}"`)];let qe;if(Sr(Q)==="string"&&ja(Le)&&!Le.tokens&&(qe=/^{([^}]+)}$/.exec(Q)))return[new ve(p,Q,`"${re}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(qe[1])} }\`.`)];const et=[];return f.layerType==="symbol"&&(re==="text-field"&&L&&!L.glyphs&&et.push(new ve(p,Q,'use of "text-field" requires a style "glyphs" property')),re==="text-font"&&Xn(mr(Q))&&$r(Q.type)==="identity"&&et.push(new ve(p,Q,'"text-font" does not support identity functions'))),et.concat(S({key:f.key,value:Q,valueSpec:Le,style:L,styleSpec:U,expressionContext:"property",propertyType:u,propertyKey:re}))}function gl(f){return lu(f,"paint")}function ro(f){return lu(f,"layout")}function mi(f){let u=[];const p=f.value,S=f.key,L=f.style,U=f.styleSpec;p.type||p.ref||u.push(new ve(S,p,'either "type" or "ref" is required'));let Q=$r(p.type);const re=$r(p.ref);if(p.id){const Ae=$r(p.id);for(let _e=0;_e<f.arrayIndex;_e++){const Le=L.layers[_e];$r(Le.id)===Ae&&u.push(new ve(S,p.id,`duplicate layer id "${p.id}", previously used at line ${Le.id.__line__}`))}}if("ref"in p){let Ae;["type","source","source-layer","filter","layout"].forEach(_e=>{_e in p&&u.push(new ve(S,p[_e],`"${_e}" is prohibited for ref layers`))}),L.layers.forEach(_e=>{$r(_e.id)===re&&(Ae=_e)}),Ae?Ae.ref?u.push(new ve(S,p.ref,"ref cannot reference another ref layer")):Q=$r(Ae.type):u.push(new ve(S,p.ref,`ref layer "${re}" not found`))}else if(Q!=="background")if(p.source){const Ae=L.sources&&L.sources[p.source],_e=Ae&&$r(Ae.type);Ae?_e==="vector"&&Q==="raster"?u.push(new ve(S,p.source,`layer "${p.id}" requires a raster source`)):_e!=="raster-dem"&&Q==="hillshade"?u.push(new ve(S,p.source,`layer "${p.id}" requires a raster-dem source`)):_e==="raster"&&Q!=="raster"?u.push(new ve(S,p.source,`layer "${p.id}" requires a vector source`)):_e!=="vector"||p["source-layer"]?_e==="raster-dem"&&Q!=="hillshade"?u.push(new ve(S,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="line"||!p.paint||!p.paint["line-gradient"]||_e==="geojson"&&Ae.lineMetrics||u.push(new ve(S,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new ve(S,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new ve(S,p.source,`source "${p.source}" not found`))}else u.push(new ve(S,p,'missing required property "source"'));return u=u.concat(Nr({key:S,value:p,valueSpec:U.layer,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,objectElementValidators:{"*":()=>[],type:()=>f.validateSpec({key:`${S}.type`,value:p.type,valueSpec:U.layer.type,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,object:p,objectKey:"type"}),filter:Wa,layout:Ae=>Nr({layer:p,key:Ae.key,value:Ae.value,style:Ae.style,styleSpec:Ae.styleSpec,validateSpec:Ae.validateSpec,objectElementValidators:{"*":_e=>ro(Ie({layerType:Q},_e))}}),paint:Ae=>Nr({layer:p,key:Ae.key,value:Ae.value,style:Ae.style,styleSpec:Ae.styleSpec,validateSpec:Ae.validateSpec,objectElementValidators:{"*":_e=>gl(Ie({layerType:Q},_e))}})}})),u}function Vi(f){const u=f.value,p=f.key,S=Sr(u);return S!=="string"?[new ve(p,u,`string expected, ${S} found`)]:[]}const Di={promoteId:function({key:f,value:u}){if(Sr(u)==="string")return Vi({key:f,value:u});{const p=[];for(const S in u)p.push(...Vi({key:`${f}.${S}`,value:u[S]}));return p}}};function Ft(f){const u=f.value,p=f.key,S=f.styleSpec,L=f.style,U=f.validateSpec;if(!u.type)return[new ve(p,u,'"type" is required')];const Q=$r(u.type);let re;switch(Q){case"vector":case"raster":return re=Nr({key:p,value:u,valueSpec:S[`source_${Q.replace("-","_")}`],style:f.style,styleSpec:S,objectElementValidators:Di,validateSpec:U}),re;case"raster-dem":return re=function(Ae){var _e;const Le=(_e=Ae.sourceName)!==null&&_e!==void 0?_e:"",qe=Ae.value,et=Ae.styleSpec,At=et.source_raster_dem,_t=Ae.style;let Mt=[];const Dt=Sr(qe);if(qe===void 0)return Mt;if(Dt!=="object")return Mt.push(new ve("source_raster_dem",qe,`object expected, ${Dt} found`)),Mt;const Bt=$r(qe.encoding)==="custom",Kt=["redFactor","greenFactor","blueFactor","baseShift"],Ht=Ae.value.encoding?`"${Ae.value.encoding}"`:"Default";for(const Zt in qe)!Bt&&Kt.includes(Zt)?Mt.push(new ve(Zt,qe[Zt],`In "${Le}": "${Zt}" is only valid when "encoding" is set to "custom". ${Ht} encoding found`)):At[Zt]?Mt=Mt.concat(Ae.validateSpec({key:Zt,value:qe[Zt],valueSpec:At[Zt],validateSpec:Ae.validateSpec,style:_t,styleSpec:et})):Mt.push(new ve(Zt,qe[Zt],`unknown property "${Zt}"`));return Mt}({sourceName:p,value:u,style:f.style,styleSpec:S,validateSpec:U}),re;case"geojson":if(re=Nr({key:p,value:u,valueSpec:S.source_geojson,style:L,styleSpec:S,validateSpec:U,objectElementValidators:Di}),u.cluster)for(const Ae in u.clusterProperties){const[_e,Le]=u.clusterProperties[Ae],qe=typeof _e=="string"?[_e,["accumulated"],["get",Ae]]:_e;re.push(...Sa({key:`${p}.${Ae}.map`,value:Le,validateSpec:U,expressionContext:"cluster-map"})),re.push(...Sa({key:`${p}.${Ae}.reduce`,value:qe,validateSpec:U,expressionContext:"cluster-reduce"}))}return re;case"video":return Nr({key:p,value:u,valueSpec:S.source_video,style:L,validateSpec:U,styleSpec:S});case"image":return Nr({key:p,value:u,valueSpec:S.source_image,style:L,validateSpec:U,styleSpec:S});case"canvas":return[new ve(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ka({key:`${p}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:L,validateSpec:U,styleSpec:S})}}function ti(f){const u=f.value,p=f.styleSpec,S=p.light,L=f.style;let U=[];const Q=Sr(u);if(u===void 0)return U;if(Q!=="object")return U=U.concat([new ve("light",u,`object expected, ${Q} found`)]),U;for(const re in u){const Ae=re.match(/^(.*)-transition$/);U=U.concat(Ae&&S[Ae[1]]&&S[Ae[1]].transition?f.validateSpec({key:re,value:u[re],valueSpec:p.transition,validateSpec:f.validateSpec,style:L,styleSpec:p}):S[re]?f.validateSpec({key:re,value:u[re],valueSpec:S[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)])}return U}function xi(f){const u=f.value,p=f.styleSpec,S=p.terrain,L=f.style;let U=[];const Q=Sr(u);if(u===void 0)return U;if(Q!=="object")return U=U.concat([new ve("terrain",u,`object expected, ${Q} found`)]),U;for(const re in u)U=U.concat(S[re]?f.validateSpec({key:re,value:u[re],valueSpec:S[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)]);return U}function Fi(f){let u=[];const p=f.value,S=f.key;if(Array.isArray(p)){const L=[],U=[];for(const Q in p)p[Q].id&&L.includes(p[Q].id)&&u.push(new ve(S,p,`all the sprites' ids must be unique, but ${p[Q].id} is duplicated`)),L.push(p[Q].id),p[Q].url&&U.includes(p[Q].url)&&u.push(new ve(S,p,`all the sprites' URLs must be unique, but ${p[Q].url} is duplicated`)),U.push(p[Q].url),u=u.concat(Nr({key:`${S}[${Q}]`,value:p[Q],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:f.validateSpec}));return u}return Vi({key:S,value:p})}const Ln={"*":()=>[],array:ha,boolean:function(f){const u=f.value,p=f.key,S=Sr(u);return S!=="boolean"?[new ve(p,u,`boolean expected, ${S} found`)]:[]},number:po,color:function(f){const u=f.key,p=f.value,S=Sr(p);return S!=="string"?[new ve(u,p,`color expected, ${S} found`)]:Hi.parse(String(p))?[]:[new ve(u,p,`color expected, "${p}" found`)]},constants:Jo,enum:ka,filter:Wa,function:ea,layer:mi,object:Nr,source:Ft,light:ti,terrain:xi,string:Vi,formatted:function(f){return Vi(f).length===0?[]:Sa(f)},resolvedImage:function(f){return Vi(f).length===0?[]:Sa(f)},padding:function(f){const u=f.key,p=f.value;if(Sr(p)==="array"){if(p.length<1||p.length>4)return[new ve(u,p,`padding requires 1 to 4 values; ${p.length} values found`)];const S={type:"number"};let L=[];for(let U=0;U<p.length;U++)L=L.concat(f.validateSpec({key:`${u}[${U}]`,value:p[U],validateSpec:f.validateSpec,valueSpec:S}));return L}return po({key:u,value:p,valueSpec:{}})},variableAnchorOffsetCollection:function(f){const u=f.key,p=f.value,S=Sr(p),L=f.styleSpec;if(S!=="array"||p.length<1||p.length%2!=0)return[new ve(u,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let U=[];for(let Q=0;Q<p.length;Q+=2)U=U.concat(ka({key:`${u}[${Q}]`,value:p[Q],valueSpec:L.layout_symbol["text-anchor"]})),U=U.concat(ha({key:`${u}[${Q+1}]`,value:p[Q+1],valueSpec:{length:2,value:"number"},validateSpec:f.validateSpec,style:f.style,styleSpec:L}));return U},sprite:Fi};function Hn(f){const u=f.value,p=f.valueSpec,S=f.styleSpec;return f.validateSpec=Hn,p.expression&&Xn($r(u))?ea(f):p.expression&&es(mr(u))?Sa(f):p.type&&Ln[p.type]?Ln[p.type](f):Nr(Ie({},f,{valueSpec:p.type?S[p.type]:p}))}function lr(f){const u=f.value,p=f.key,S=Vi(f);return S.length||(u.indexOf("{fontstack}")===-1&&S.push(new ve(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&S.push(new ve(p,u,'"glyphs" url must include a "{range}" token'))),S}function Yn(f,u=hi){let p=[];return p=p.concat(Hn({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,validateSpec:Hn,objectElementValidators:{glyphs:lr,"*":()=>[]}})),f.constants&&(p=p.concat(Jo({key:"constants",value:f.constants,style:f,styleSpec:u,validateSpec:Hn}))),ks(p)}function qs(f){return function(u){return f({...u,validateSpec:Hn})}}function ks(f){return[].concat(f).sort((u,p)=>u.line-p.line)}function As(f){return function(...u){return ks(f.apply(this,u))}}Yn.source=As(qs(Ft)),Yn.sprite=As(qs(Fi)),Yn.glyphs=As(qs(lr)),Yn.light=As(qs(ti)),Yn.terrain=As(qs(xi)),Yn.layer=As(qs(mi)),Yn.filter=As(qs(Wa)),Yn.paintProperty=As(qs(gl)),Yn.layoutProperty=As(qs(ro));const Xa=Yn,mo=Xa.light,rs=Xa.paintProperty,Qu=Xa.layoutProperty;function Ru(f,u){let p=!1;if(u&&u.length)for(const S of u)f.fire(new wn(new Error(S.message))),p=!0;return p}class go{constructor(u,p,S){const L=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const Q=new Int32Array(this.arrayBuffer);u=Q[0],this.d=(p=Q[1])+2*(S=Q[2]);for(let Ae=0;Ae<this.d*this.d;Ae++){const _e=Q[3+Ae],Le=Q[3+Ae+1];L.push(_e===Le?null:Q.subarray(_e,Le))}const re=Q[3+L.length+1];this.keys=Q.subarray(Q[3+L.length],re),this.bboxes=Q.subarray(re),this.insert=this._insertReadonly}else{this.d=p+2*S;for(let Q=0;Q<this.d*this.d;Q++)L.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=S,this.scale=p/u,this.uid=0;const U=S/p*u;this.min=-U,this.max=u+U}insert(u,p,S,L,U){this._forEachCell(p,S,L,U,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(S),this.bboxes.push(L),this.bboxes.push(U)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,p,S,L,U,Q){this.cells[U].push(Q)}query(u,p,S,L,U){const Q=this.min,re=this.max;if(u<=Q&&p<=Q&&re<=S&&re<=L&&!U)return Array.prototype.slice.call(this.keys);{const Ae=[];return this._forEachCell(u,p,S,L,this._queryCell,Ae,{},U),Ae}}_queryCell(u,p,S,L,U,Q,re,Ae){const _e=this.cells[U];if(_e!==null){const Le=this.keys,qe=this.bboxes;for(let et=0;et<_e.length;et++){const At=_e[et];if(re[At]===void 0){const _t=4*At;(Ae?Ae(qe[_t+0],qe[_t+1],qe[_t+2],qe[_t+3]):u<=qe[_t+2]&&p<=qe[_t+3]&&S>=qe[_t+0]&&L>=qe[_t+1])?(re[At]=!0,Q.push(Le[At])):re[At]=!1}}}}_forEachCell(u,p,S,L,U,Q,re,Ae){const _e=this._convertToCellCoord(u),Le=this._convertToCellCoord(p),qe=this._convertToCellCoord(S),et=this._convertToCellCoord(L);for(let At=_e;At<=qe;At++)for(let _t=Le;_t<=et;_t++){const Mt=this.d*_t+At;if((!Ae||Ae(this._convertFromCellCoord(At),this._convertFromCellCoord(_t),this._convertFromCellCoord(At+1),this._convertFromCellCoord(_t+1)))&&U.call(this,u,p,S,L,Mt,Q,re,Ae))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,p=3+this.cells.length+1+1;let S=0;for(let Q=0;Q<this.cells.length;Q++)S+=this.cells[Q].length;const L=new Int32Array(p+S+this.keys.length+this.bboxes.length);L[0]=this.extent,L[1]=this.n,L[2]=this.padding;let U=p;for(let Q=0;Q<u.length;Q++){const re=u[Q];L[3+Q]=U,L.set(re,U),U+=re.length}return L[3+u.length]=U,L.set(this.keys,U),U+=this.keys.length,L[3+u.length+1]=U,L.set(this.bboxes,U),U+=this.bboxes.length,L.buffer}static serialize(u,p){const S=u.toArrayBuffer();return p&&p.push(S),{buffer:S}}static deserialize(u){return new go(u.buffer)}}const Ml={};function Pn(f,u,p={}){if(Ml[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),Ml[f]={klass:u,omit:p.omit||[],shallow:p.shallow||[]}}Pn("Object",Object),Pn("TransferableGridIndex",go),Pn("Color",Hi),Pn("Error",Error),Pn("AJAXError",yn),Pn("ResolvedImage",cr),Pn("StylePropertyFunction",ll),Pn("StyleExpression",Ol,{omit:["_evaluator"]}),Pn("ZoomDependentExpression",kr),Pn("ZoomConstantExpression",Ts),Pn("CompoundExpression",Or,{omit:["_evaluate"]});for(const f in Wo)Wo[f]._classRegistryKey||Pn(`Expression_${f}`,Wo[f]);function Ma(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function Sn(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(Ma(f)||Ot(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return u&&u.push(p.buffer),p}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const S of f)p.push(Sn(S,u));return p}if(typeof f=="object"){const p=f.constructor,S=p._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");if(!Ml[S])throw new Error(`${S} is not registered.`);const L=p.serialize?p.serialize(f,u):{};if(p.serialize){if(u&&L===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const U in f){if(!f.hasOwnProperty(U)||Ml[S].omit.indexOf(U)>=0)continue;const Q=f[U];L[U]=Ml[S].shallow.indexOf(U)>=0?Q:Sn(Q,u)}f instanceof Error&&(L.message=f.message)}if(L.$name)throw new Error("$name property is reserved for worker serialization logic.");return S!=="Object"&&(L.$name=S),L}throw new Error("can't serialize object of type "+typeof f)}function Fo(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||Ma(f)||Ot(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(Fo);if(typeof f=="object"){const u=f.$name||"Object";if(!Ml[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:p}=Ml[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(f);const S=Object.create(p.prototype);for(const L of Object.keys(f)){if(L==="$name")continue;const U=f[L];S[L]=Ml[u].shallow.indexOf(L)>=0?U:Fo(U)}return S}throw new Error("can't deserialize object of type "+typeof f)}class Nl{constructor(){this.first=!0}update(u,p){const S=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=S,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=S,!0):(this.lastFloorZoom>S?(this.lastIntegerZoom=S+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<S&&(this.lastIntegerZoom=S,this.lastIntegerZoomTime=p),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=S,!0))}}const En={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function Hl(f){for(const u of f)if(uu(u.charCodeAt(0)))return!0;return!1}function Cn(f){for(const u of f)if(!_l(u.charCodeAt(0)))return!1;return!0}function _l(f){return!(En.Arabic(f)||En["Arabic Supplement"](f)||En["Arabic Extended-A"](f)||En["Arabic Presentation Forms-A"](f)||En["Arabic Presentation Forms-B"](f))}function uu(f){return!(f!==746&&f!==747&&(f<4352||!(En["Bopomofo Extended"](f)||En.Bopomofo(f)||En["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||En["CJK Compatibility Ideographs"](f)||En["CJK Compatibility"](f)||En["CJK Radicals Supplement"](f)||En["CJK Strokes"](f)||!(!En["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||En["CJK Unified Ideographs Extension A"](f)||En["CJK Unified Ideographs"](f)||En["Enclosed CJK Letters and Months"](f)||En["Hangul Compatibility Jamo"](f)||En["Hangul Jamo Extended-A"](f)||En["Hangul Jamo Extended-B"](f)||En["Hangul Jamo"](f)||En["Hangul Syllables"](f)||En.Hiragana(f)||En["Ideographic Description Characters"](f)||En.Kanbun(f)||En["Kangxi Radicals"](f)||En["Katakana Phonetic Extensions"](f)||En.Katakana(f)&&f!==12540||!(!En["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!En["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||En["Unified Canadian Aboriginal Syllabics"](f)||En["Unified Canadian Aboriginal Syllabics Extended"](f)||En["Vertical Forms"](f)||En["Yijing Hexagram Symbols"](f)||En["Yi Syllables"](f)||En["Yi Radicals"](f))))}function Fu(f){return!(uu(f)||function(u){return!!(En["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||En["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||En["Letterlike Symbols"](u)||En["Number Forms"](u)||En["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||En["Control Pictures"](u)&&u!==9251||En["Optical Character Recognition"](u)||En["Enclosed Alphanumerics"](u)||En["Geometric Shapes"](u)||En["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||En["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||En["CJK Symbols and Punctuation"](u)||En.Katakana(u)||En["Private Use Area"](u)||En["CJK Compatibility Forms"](u)||En["Small Form Variants"](u)||En["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function Vl(f){return f>=1424&&f<=2303||En["Arabic Presentation Forms-A"](f)||En["Arabic Presentation Forms-B"](f)}function yl(f,u){return!(!u&&Vl(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||En.Khmer(f))}function ta(f){for(const u of f)if(Vl(u.charCodeAt(0)))return!0;return!1}const sc="deferred",Wu="loading",jl="loaded";let fs=null,_a="unavailable",el=null;const _u=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(_a="error"),fs&&fs(f)};function Ou(){cu.fire(new ii("pluginStateChange",{pluginStatus:_a,pluginURL:el}))}const cu=new Rr,Nu=function(){return _a},_r=function(){if(_a!==sc||!el)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_a=Wu,Ou(),el&&Ki({url:el},f=>{f?_u(f):(_a=jl,Ou())})},ds={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_a===jl||ds.applyArabicShaping!=null,isLoading:()=>_a===Wu,setState(f){if(!Nt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");_a=f.pluginStatus,el=f.pluginURL},isParsed(){if(!Nt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ds.applyArabicShaping!=null&&ds.processBidirectionalText!=null&&ds.processStyledBidirectionalText!=null},getPluginURL(){if(!Nt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return el}};class gn{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Nl,this.transition={})}isSupportedScript(u){return function(p,S){for(const L of p)if(!yl(L.charCodeAt(0),S))return!1;return!0}(u,ds.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,p=u-Math.floor(u),S=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*S}:{fromScale:.5,toScale:1,t:1-(1-S)*p}}}class jn{constructor(u,p){this.property=u,this.value=p,this.expression=function(S,L){if(Xn(S))return new ll(S,L);if(es(S)){const U=rr(S,L);if(U.result==="error")throw new Error(U.value.map(Q=>`${Q.key}: ${Q.message}`).join(", "));return U.value}{let U=S;return L.type==="color"&&typeof S=="string"?U=Hi.parse(S):L.type!=="padding"||typeof S!="number"&&!Array.isArray(S)?L.type==="variableAnchorOffsetCollection"&&Array.isArray(S)&&(U=Tn.parse(S)):U=Yi.parse(S),{kind:"constant",evaluate:()=>U}}}(p===void 0?u.specification.default:p,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,S){return this.property.possiblyEvaluate(this,u,p,S)}}class Jn{constructor(u){this.property=u,this.value=new jn(u,void 0)}transitioned(u,p){return new Tu(this.property,this.value,p,rt({},u.transition,this.transition),u.now)}untransitioned(){return new Tu(this.property,this.value,null,{},0)}}class tl{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return bt(this._values[u].value.value)}setValue(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].value=new jn(this._values[u].property,p===null?void 0:bt(p))}getTransition(u){return bt(this._values[u].transition)}setTransition(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].transition=bt(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const S=this.getValue(p);S!==void 0&&(u[p]=S);const L=this.getTransition(p);L!==void 0&&(u[`${p}-transition`]=L)}return u}transitioned(u,p){const S=new oa(this._properties);for(const L of Object.keys(this._values))S._values[L]=this._values[L].transitioned(u,p._values[L]);return S}untransitioned(){const u=new oa(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class Tu{constructor(u,p,S,L,U){this.property=u,this.value=p,this.begin=U+L.delay||0,this.end=this.begin+L.duration||0,u.specification.transition&&(L.delay||L.duration)&&(this.prior=S)}possiblyEvaluate(u,p,S){const L=u.now||0,U=this.value.possiblyEvaluate(u,p,S),Q=this.prior;if(Q){if(L>this.end)return this.prior=null,U;if(this.value.isDataDriven())return this.prior=null,U;if(L<this.begin)return Q.possiblyEvaluate(u,p,S);{const re=(L-this.begin)/(this.end-this.begin);return this.property.interpolate(Q.possiblyEvaluate(u,p,S),U,function(Ae){if(Ae<=0)return 0;if(Ae>=1)return 1;const _e=Ae*Ae,Le=_e*Ae;return 4*(Ae<.5?Le:3*(Ae-_e)+Le-.75)}(re))}}return U}}class oa{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,S){const L=new ko(this._properties);for(const U of Object.keys(this._values))L._values[U]=this._values[U].possiblyEvaluate(u,p,S);return L}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class yu{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}hasValue(u){return this._values[u].value!==void 0}getValue(u){return bt(this._values[u].value)}setValue(u,p){this._values[u]=new jn(this._values[u].property,p===null?void 0:bt(p))}serialize(){const u={};for(const p of Object.keys(this._values)){const S=this.getValue(p);S!==void 0&&(u[p]=S)}return u}possiblyEvaluate(u,p,S){const L=new ko(this._properties);for(const U of Object.keys(this._values))L._values[U]=this._values[U].possiblyEvaluate(u,p,S);return L}}class vs{constructor(u,p,S){this.property=u,this.value=p,this.parameters=S}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,S,L){return this.property.evaluate(this.value,this.parameters,u,p,S,L)}}class ko{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class ki{constructor(u){this.specification=u}possiblyEvaluate(u,p){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(p)}interpolate(u,p,S){const L=js[this.specification.type];return L?L(u,p,S):u}}class Bi{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,S,L){return new vs(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},S,L)}:u.expression,p)}interpolate(u,p,S){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new vs(this,{kind:"constant",value:void 0},u.parameters);const L=js[this.specification.type];if(L){const U=L(u.value.value,p.value.value,S);return new vs(this,{kind:"constant",value:U},u.parameters)}return u}evaluate(u,p,S,L,U,Q){return u.kind==="constant"?u.value:u.evaluate(p,S,L,U,Q)}}class xs extends Bi{possiblyEvaluate(u,p,S,L){if(u.value===void 0)return new vs(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){const U=u.expression.evaluate(p,null,{},S,L),Q=u.property.specification.type==="resolvedImage"&&typeof U!="string"?U.name:U,re=this._calculate(Q,Q,Q,p);return new vs(this,{kind:"constant",value:re},p)}if(u.expression.kind==="camera"){const U=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new vs(this,{kind:"constant",value:U},p)}return new vs(this,u.expression,p)}evaluate(u,p,S,L,U,Q){if(u.kind==="source"){const re=u.evaluate(p,S,L,U,Q);return this._calculate(re,re,re,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},S,L),u.evaluate({zoom:Math.floor(p.zoom)},S,L),u.evaluate({zoom:Math.floor(p.zoom)+1},S,L),p):u.value}_calculate(u,p,S,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:S,to:p}}interpolate(u){return u}}class vu{constructor(u){this.specification=u}possiblyEvaluate(u,p,S,L){if(u.value!==void 0){if(u.expression.kind==="constant"){const U=u.expression.evaluate(p,null,{},S,L);return this._calculate(U,U,U,p)}return this._calculate(u.expression.evaluate(new gn(Math.floor(p.zoom-1),p)),u.expression.evaluate(new gn(Math.floor(p.zoom),p)),u.expression.evaluate(new gn(Math.floor(p.zoom+1),p)),p)}}_calculate(u,p,S,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:S,to:p}}interpolate(u){return u}}class Oo{constructor(u){this.specification=u}possiblyEvaluate(u,p,S,L){return!!u.expression.evaluate(p,null,{},S,L)}interpolate(){return!1}}class cs{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in u){const S=u[p];S.specification.overridable&&this.overridableProperties.push(p);const L=this.defaultPropertyValues[p]=new jn(S,void 0),U=this.defaultTransitionablePropertyValues[p]=new Jn(S);this.defaultTransitioningPropertyValues[p]=U.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=L.possiblyEvaluate({})}}}Pn("DataDrivenProperty",Bi),Pn("DataConstantProperty",ki),Pn("CrossFadedDataDrivenProperty",xs),Pn("CrossFadedProperty",vu),Pn("ColorRampProperty",Oo);const hl="-transition";class Ms extends Rr{constructor(u,p){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new yu(p.layout)),p.paint)){this._transitionablePaint=new tl(p.paint);for(const S in u.paint)this.setPaintProperty(S,u.paint[S],{validate:!1});for(const S in u.layout)this.setLayoutProperty(S,u.layout[S],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ko(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p,S={}){p!=null&&this._validate(Qu,`layers.${this.id}.layout.${u}`,u,p,S)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)}getPaintProperty(u){return u.endsWith(hl)?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p,S={}){if(p!=null&&this._validate(rs,`layers.${this.id}.paint.${u}`,u,p,S))return!1;if(u.endsWith(hl))return this._transitionablePaint.setTransition(u.slice(0,-11),p||void 0),!1;{const L=this._transitionablePaint._values[u],U=L.property.specification["property-type"]==="cross-faded-data-driven",Q=L.value.isDataDriven(),re=L.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);const Ae=this._transitionablePaint._values[u].value;return Ae.isDataDriven()||Q||U||this._handleOverridablePaintPropertyUpdate(u,re,Ae)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,p,S){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),gt(u,(p,S)=>!(p===void 0||S==="layout"&&!Object.keys(p).length||S==="paint"&&!Object.keys(p).length))}_validate(u,p,S,L,U={}){return(!U||U.validate!==!1)&&Ru(this,u.call(Xa,{key:p,layerType:this.type,objectKey:S,value:L,styleSpec:hi,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof vs&&ja(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const C={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class D{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class z{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function R(f,u=1){let p=0,S=0;return{members:f.map(L=>{const U=C[L.type].BYTES_PER_ELEMENT,Q=p=ee(p,Math.max(u,U)),re=L.components||1;return S=Math.max(S,U),p+=U*re,{name:L.name,type:L.type,components:re,offset:Q}}),size:ee(p,Math.max(S,u)),alignment:u}}function ee(f,u){return Math.ceil(f/u)*u}class le extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const S=this.length;return this.resize(S+1),this.emplace(S,u,p)}emplace(u,p,S){const L=2*u;return this.int16[L+0]=p,this.int16[L+1]=S,u}}le.prototype.bytesPerElement=4,Pn("StructArrayLayout2i4",le);class oe extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const U=3*u;return this.int16[U+0]=p,this.int16[U+1]=S,this.int16[U+2]=L,u}}oe.prototype.bytesPerElement=6,Pn("StructArrayLayout3i6",oe);class we extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L){const U=this.length;return this.resize(U+1),this.emplace(U,u,p,S,L)}emplace(u,p,S,L,U){const Q=4*u;return this.int16[Q+0]=p,this.int16[Q+1]=S,this.int16[Q+2]=L,this.int16[Q+3]=U,u}}we.prototype.bytesPerElement=8,Pn("StructArrayLayout4i8",we);class We extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,S,L,U,Q)}emplace(u,p,S,L,U,Q,re){const Ae=6*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=S,this.int16[Ae+2]=L,this.int16[Ae+3]=U,this.int16[Ae+4]=Q,this.int16[Ae+5]=re,u}}We.prototype.bytesPerElement=12,Pn("StructArrayLayout2i4i12",We);class vt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,S,L,U,Q)}emplace(u,p,S,L,U,Q,re){const Ae=4*u,_e=8*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=S,this.uint8[_e+4]=L,this.uint8[_e+5]=U,this.uint8[_e+6]=Q,this.uint8[_e+7]=re,u}}vt.prototype.bytesPerElement=8,Pn("StructArrayLayout2i4ub8",vt);class Ct extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const S=this.length;return this.resize(S+1),this.emplace(S,u,p)}emplace(u,p,S){const L=2*u;return this.float32[L+0]=p,this.float32[L+1]=S,u}}Ct.prototype.bytesPerElement=8,Pn("StructArrayLayout2f8",Ct);class ni extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q,re,Ae,_e,Le){const qe=this.length;return this.resize(qe+1),this.emplace(qe,u,p,S,L,U,Q,re,Ae,_e,Le)}emplace(u,p,S,L,U,Q,re,Ae,_e,Le,qe){const et=10*u;return this.uint16[et+0]=p,this.uint16[et+1]=S,this.uint16[et+2]=L,this.uint16[et+3]=U,this.uint16[et+4]=Q,this.uint16[et+5]=re,this.uint16[et+6]=Ae,this.uint16[et+7]=_e,this.uint16[et+8]=Le,this.uint16[et+9]=qe,u}}ni.prototype.bytesPerElement=20,Pn("StructArrayLayout10ui20",ni);class Gt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q,re,Ae,_e,Le,qe,et){const At=this.length;return this.resize(At+1),this.emplace(At,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et)}emplace(u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At){const _t=12*u;return this.int16[_t+0]=p,this.int16[_t+1]=S,this.int16[_t+2]=L,this.int16[_t+3]=U,this.uint16[_t+4]=Q,this.uint16[_t+5]=re,this.uint16[_t+6]=Ae,this.uint16[_t+7]=_e,this.int16[_t+8]=Le,this.int16[_t+9]=qe,this.int16[_t+10]=et,this.int16[_t+11]=At,u}}Gt.prototype.bytesPerElement=24,Pn("StructArrayLayout4i4ui4i24",Gt);class jt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const U=3*u;return this.float32[U+0]=p,this.float32[U+1]=S,this.float32[U+2]=L,u}}jt.prototype.bytesPerElement=12,Pn("StructArrayLayout3f12",jt);class Z extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}Z.prototype.bytesPerElement=4,Pn("StructArrayLayout1ul4",Z);class A extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q,re,Ae,_e){const Le=this.length;return this.resize(Le+1),this.emplace(Le,u,p,S,L,U,Q,re,Ae,_e)}emplace(u,p,S,L,U,Q,re,Ae,_e,Le){const qe=10*u,et=5*u;return this.int16[qe+0]=p,this.int16[qe+1]=S,this.int16[qe+2]=L,this.int16[qe+3]=U,this.int16[qe+4]=Q,this.int16[qe+5]=re,this.uint32[et+3]=Ae,this.uint16[qe+8]=_e,this.uint16[qe+9]=Le,u}}A.prototype.bytesPerElement=20,Pn("StructArrayLayout6i1ul2ui20",A);class E extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,S,L,U,Q)}emplace(u,p,S,L,U,Q,re){const Ae=6*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=S,this.int16[Ae+2]=L,this.int16[Ae+3]=U,this.int16[Ae+4]=Q,this.int16[Ae+5]=re,u}}E.prototype.bytesPerElement=12,Pn("StructArrayLayout2i2i2i12",E);class F extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U){const Q=this.length;return this.resize(Q+1),this.emplace(Q,u,p,S,L,U)}emplace(u,p,S,L,U,Q){const re=4*u,Ae=8*u;return this.float32[re+0]=p,this.float32[re+1]=S,this.float32[re+2]=L,this.int16[Ae+6]=U,this.int16[Ae+7]=Q,u}}F.prototype.bytesPerElement=16,Pn("StructArrayLayout2f1f2i16",F);class O extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L){const U=this.length;return this.resize(U+1),this.emplace(U,u,p,S,L)}emplace(u,p,S,L,U){const Q=12*u,re=3*u;return this.uint8[Q+0]=p,this.uint8[Q+1]=S,this.float32[re+1]=L,this.float32[re+2]=U,u}}O.prototype.bytesPerElement=12,Pn("StructArrayLayout2ub2f12",O);class y extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const U=3*u;return this.uint16[U+0]=p,this.uint16[U+1]=S,this.uint16[U+2]=L,u}}y.prototype.bytesPerElement=6,Pn("StructArrayLayout3ui6",y);class s extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt){const Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt)}emplace(u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt){const Ht=24*u,Zt=12*u,ci=48*u;return this.int16[Ht+0]=p,this.int16[Ht+1]=S,this.uint16[Ht+2]=L,this.uint16[Ht+3]=U,this.uint32[Zt+2]=Q,this.uint32[Zt+3]=re,this.uint32[Zt+4]=Ae,this.uint16[Ht+10]=_e,this.uint16[Ht+11]=Le,this.uint16[Ht+12]=qe,this.float32[Zt+7]=et,this.float32[Zt+8]=At,this.uint8[ci+36]=_t,this.uint8[ci+37]=Mt,this.uint8[ci+38]=Dt,this.uint32[Zt+10]=Bt,this.int16[Ht+22]=Kt,u}}s.prototype.bytesPerElement=48,Pn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",s);class i extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt,Ht,Zt,ci,yi,Xi,xn,on,an,An,zn){const sn=this.length;return this.resize(sn+1),this.emplace(sn,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt,Ht,Zt,ci,yi,Xi,xn,on,an,An,zn)}emplace(u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt,Dt,Bt,Kt,Ht,Zt,ci,yi,Xi,xn,on,an,An,zn,sn){const Wi=32*u,Dn=16*u;return this.int16[Wi+0]=p,this.int16[Wi+1]=S,this.int16[Wi+2]=L,this.int16[Wi+3]=U,this.int16[Wi+4]=Q,this.int16[Wi+5]=re,this.int16[Wi+6]=Ae,this.int16[Wi+7]=_e,this.uint16[Wi+8]=Le,this.uint16[Wi+9]=qe,this.uint16[Wi+10]=et,this.uint16[Wi+11]=At,this.uint16[Wi+12]=_t,this.uint16[Wi+13]=Mt,this.uint16[Wi+14]=Dt,this.uint16[Wi+15]=Bt,this.uint16[Wi+16]=Kt,this.uint16[Wi+17]=Ht,this.uint16[Wi+18]=Zt,this.uint16[Wi+19]=ci,this.uint16[Wi+20]=yi,this.uint16[Wi+21]=Xi,this.uint16[Wi+22]=xn,this.uint32[Dn+12]=on,this.float32[Dn+13]=an,this.float32[Dn+14]=An,this.uint16[Wi+30]=zn,this.uint16[Wi+31]=sn,u}}i.prototype.bytesPerElement=64,Pn("StructArrayLayout8i15ui1ul2f2ui64",i);class r extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}r.prototype.bytesPerElement=4,Pn("StructArrayLayout1f4",r);class l extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const U=3*u;return this.uint16[6*u+0]=p,this.float32[U+1]=S,this.float32[U+2]=L,u}}l.prototype.bytesPerElement=12,Pn("StructArrayLayout1ui2f12",l);class d extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const U=4*u;return this.uint32[2*u+0]=p,this.uint16[U+2]=S,this.uint16[U+3]=L,u}}d.prototype.bytesPerElement=8,Pn("StructArrayLayout1ul2ui8",d);class _ extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const S=this.length;return this.resize(S+1),this.emplace(S,u,p)}emplace(u,p,S){const L=2*u;return this.uint16[L+0]=p,this.uint16[L+1]=S,u}}_.prototype.bytesPerElement=4,Pn("StructArrayLayout2ui4",_);class w extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}w.prototype.bytesPerElement=2,Pn("StructArrayLayout1ui2",w);class T extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L){const U=this.length;return this.resize(U+1),this.emplace(U,u,p,S,L)}emplace(u,p,S,L,U){const Q=4*u;return this.float32[Q+0]=p,this.float32[Q+1]=S,this.float32[Q+2]=L,this.float32[Q+3]=U,u}}T.prototype.bytesPerElement=16,Pn("StructArrayLayout4f16",T);class B extends D{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ue(this.anchorPointX,this.anchorPointY)}}B.prototype.size=20;class j extends A{get(u){return new B(this,u)}}Pn("CollisionBoxArray",j);class Y extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Y.prototype.size=48;class ce extends s{get(u){return new Y(this,u)}}Pn("PlacedSymbolArray",ce);class Se extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Se.prototype.size=64;class Te extends i{get(u){return new Se(this,u)}}Pn("SymbolInstanceArray",Te);class Re extends r{getoffsetX(u){return this.float32[1*u+0]}}Pn("GlyphOffsetArray",Re);class Be extends oe{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Pn("SymbolLineVertexArray",Be);class Je extends D{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Je.prototype.size=12;class xt extends l{get(u){return new Je(this,u)}}Pn("TextAnchorOffsetArray",xt);class at extends D{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}at.prototype.size=8;class ct extends d{get(u){return new at(this,u)}}Pn("FeatureIndexArray",ct);class Et extends le{}class wt extends le{}class ri extends le{}class Yt extends We{}class ei extends vt{}class si extends Ct{}class ji extends ni{}class Qi extends Gt{}class Ei extends jt{}class Ui extends Z{}class Gi extends E{}class ln extends O{}class Bn extends y{}class rn extends _{}const kn=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:yr}=kn;class er{constructor(u=[]){this.segments=u}prepareSegment(u,p,S,L){let U=this.segments[this.segments.length-1];return u>er.MAX_VERTEX_ARRAY_LENGTH&&$e(`Max vertices per segment is ${er.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!U||U.vertexLength+u>er.MAX_VERTEX_ARRAY_LENGTH||U.sortKey!==L)&&(U={vertexOffset:p.length,primitiveOffset:S.length,vertexLength:0,primitiveLength:0},L!==void 0&&(U.sortKey=L),this.segments.push(U)),U}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,S,L){return new er([{vertexOffset:u,primitiveOffset:p,vertexLength:S,primitiveLength:L,vaos:{},sortKey:0}])}}function Ia(f,u){return 256*(f=Ge(Math.floor(f),0,255))+Ge(Math.floor(u),0,255)}er.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pn("SegmentVector",er);const Aa=R([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Bs={exports:{}},so={exports:{}};so.exports=function(f,u){var p,S,L,U,Q,re,Ae,_e;for(S=f.length-(p=3&f.length),L=u,Q=3432918353,re=461845907,_e=0;_e<S;)Ae=255&f.charCodeAt(_e)|(255&f.charCodeAt(++_e))<<8|(255&f.charCodeAt(++_e))<<16|(255&f.charCodeAt(++_e))<<24,++_e,L=27492+(65535&(U=5*(65535&(L=(L^=Ae=(65535&(Ae=(Ae=(65535&Ae)*Q+(((Ae>>>16)*Q&65535)<<16)&4294967295)<<15|Ae>>>17))*re+(((Ae>>>16)*re&65535)<<16)&4294967295)<<13|L>>>19))+((5*(L>>>16)&65535)<<16)&4294967295))+((58964+(U>>>16)&65535)<<16);switch(Ae=0,p){case 3:Ae^=(255&f.charCodeAt(_e+2))<<16;case 2:Ae^=(255&f.charCodeAt(_e+1))<<8;case 1:L^=Ae=(65535&(Ae=(Ae=(65535&(Ae^=255&f.charCodeAt(_e)))*Q+(((Ae>>>16)*Q&65535)<<16)&4294967295)<<15|Ae>>>17))*re+(((Ae>>>16)*re&65535)<<16)&4294967295}return L^=f.length,L=2246822507*(65535&(L^=L>>>16))+((2246822507*(L>>>16)&65535)<<16)&4294967295,L=3266489909*(65535&(L^=L>>>13))+((3266489909*(L>>>16)&65535)<<16)&4294967295,(L^=L>>>16)>>>0};var ao=so.exports,qr={exports:{}};qr.exports=function(f,u){for(var p,S=f.length,L=u^S,U=0;S>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(U)|(255&f.charCodeAt(++U))<<8|(255&f.charCodeAt(++U))<<16|(255&f.charCodeAt(++U))<<24))+((1540483477*(p>>>16)&65535)<<16),L=1540483477*(65535&L)+((1540483477*(L>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),S-=4,++U;switch(S){case 3:L^=(255&f.charCodeAt(U+2))<<16;case 2:L^=(255&f.charCodeAt(U+1))<<8;case 1:L=1540483477*(65535&(L^=255&f.charCodeAt(U)))+((1540483477*(L>>>16)&65535)<<16)}return L=1540483477*(65535&(L^=L>>>13))+((1540483477*(L>>>16)&65535)<<16),(L^=L>>>15)>>>0};var ya=ao,_o=qr.exports;Bs.exports=ya,Bs.exports.murmur3=ya,Bs.exports.murmur2=_o;var yo=W(Bs.exports);class Zs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,p,S,L){this.ids.push(ts(u)),this.positions.push(p,S,L)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=ts(u);let S=0,L=this.ids.length-1;for(;S<L;){const Q=S+L>>1;this.ids[Q]>=p?L=Q:S=Q+1}const U=[];for(;this.ids[S]===p;)U.push({index:this.positions[3*S],start:this.positions[3*S+1],end:this.positions[3*S+2]}),S++;return U}static serialize(u,p){const S=new Float64Array(u.ids),L=new Uint32Array(u.positions);return is(S,L,0,S.length-1),p&&p.push(S.buffer,L.buffer),{ids:S,positions:L}}static deserialize(u){const p=new Zs;return p.ids=u.ids,p.positions=u.positions,p.indexed=!0,p}}function ts(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:yo(String(f))}function is(f,u,p,S){for(;p<S;){const L=f[p+S>>1];let U=p-1,Q=S+1;for(;;){do U++;while(f[U]<L);do Q--;while(f[Q]>L);if(U>=Q)break;zr(f,U,Q),zr(u,3*U,3*Q),zr(u,3*U+1,3*Q+1),zr(u,3*U+2,3*Q+2)}Q-p<S-Q?(is(f,u,p,Q),p=Q+1):(is(f,u,Q+1,S),S=Q)}}function zr(f,u,p){const S=f[u];f[u]=f[p],f[p]=S}Pn("FeaturePositionMap",Zs);class bs{constructor(u,p){this.gl=u.gl,this.location=p}}class Qs extends bs{constructor(u,p){super(u,p),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Mo extends bs{constructor(u,p){super(u,p),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class No extends bs{constructor(u,p){super(u,p),this.current=Hi.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const Vo=new Float32Array(16);function Sc(f){return[Ia(255*f.r,255*f.g),Ia(255*f.b,255*f.a)]}class Ws{constructor(u,p,S){this.value=u,this.uniformNames=p.map(L=>`u_${L}`),this.type=S}setUniform(u,p,S){u.set(S.constantOr(this.value))}getBinding(u,p,S){return this.type==="color"?new No(u,p):new Qs(u,p)}}class Zl{constructor(u,p){this.uniformNames=p.map(S=>`u_${S}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=u.tlbr}setUniform(u,p,S,L){const U=L==="u_pattern_to"?this.patternTo:L==="u_pattern_from"?this.patternFrom:L==="u_pixel_ratio_to"?this.pixelRatioTo:L==="u_pixel_ratio_from"?this.pixelRatioFrom:null;U&&u.set(U)}getBinding(u,p,S){return S.substr(0,9)==="u_pattern"?new Mo(u,p):new Qs(u,p)}}class hu{constructor(u,p,S,L){this.expression=u,this.type=S,this.maxValue=0,this.paintVertexAttributes=p.map(U=>({name:`a_${U}`,type:"Float32",components:S==="color"?2:1,offset:0})),this.paintVertexArray=new L}populatePaintArray(u,p,S,L,U){const Q=this.paintVertexArray.length,re=this.expression.evaluate(new gn(0),p,{},L,[],U);this.paintVertexArray.resize(u),this._setPaintValue(Q,u,re)}updatePaintArray(u,p,S,L){const U=this.expression.evaluate({zoom:0},S,L);this._setPaintValue(u,p,U)}_setPaintValue(u,p,S){if(this.type==="color"){const L=Sc(S);for(let U=u;U<p;U++)this.paintVertexArray.emplace(U,L[0],L[1])}else{for(let L=u;L<p;L++)this.paintVertexArray.emplace(L,S);this.maxValue=Math.max(this.maxValue,Math.abs(S))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class il{constructor(u,p,S,L,U,Q){this.expression=u,this.uniformNames=p.map(re=>`u_${re}_t`),this.type=S,this.useIntegerZoom=L,this.zoom=U,this.maxValue=0,this.paintVertexAttributes=p.map(re=>({name:`a_${re}`,type:"Float32",components:S==="color"?4:2,offset:0})),this.paintVertexArray=new Q}populatePaintArray(u,p,S,L,U){const Q=this.expression.evaluate(new gn(this.zoom),p,{},L,[],U),re=this.expression.evaluate(new gn(this.zoom+1),p,{},L,[],U),Ae=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Ae,u,Q,re)}updatePaintArray(u,p,S,L){const U=this.expression.evaluate({zoom:this.zoom},S,L),Q=this.expression.evaluate({zoom:this.zoom+1},S,L);this._setPaintValue(u,p,U,Q)}_setPaintValue(u,p,S,L){if(this.type==="color"){const U=Sc(S),Q=Sc(L);for(let re=u;re<p;re++)this.paintVertexArray.emplace(re,U[0],U[1],Q[0],Q[1])}else{for(let U=u;U<p;U++)this.paintVertexArray.emplace(U,S,L);this.maxValue=Math.max(this.maxValue,Math.abs(S),Math.abs(L))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p){const S=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,L=Ge(this.expression.interpolationFactor(S,this.zoom,this.zoom+1),0,1);u.set(L)}getBinding(u,p,S){return new Qs(u,p)}}class vl{constructor(u,p,S,L,U,Q){this.expression=u,this.type=p,this.useIntegerZoom=S,this.zoom=L,this.layerId=Q,this.zoomInPaintVertexArray=new U,this.zoomOutPaintVertexArray=new U}populatePaintArray(u,p,S){const L=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(L,u,p.patterns&&p.patterns[this.layerId],S)}updatePaintArray(u,p,S,L,U){this._setPaintValues(u,p,S.patterns&&S.patterns[this.layerId],U)}_setPaintValues(u,p,S,L){if(!L||!S)return;const{min:U,mid:Q,max:re}=S,Ae=L[U],_e=L[Q],Le=L[re];if(Ae&&_e&&Le)for(let qe=u;qe<p;qe++)this.zoomInPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],_e.pixelRatio,Ae.pixelRatio),this.zoomOutPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Le.tl[0],Le.tl[1],Le.br[0],Le.br[1],_e.pixelRatio,Le.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Aa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Aa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pl{constructor(u,p,S){this.binders={},this._buffers=[];const L=[];for(const U in u.paint._values){if(!S(U))continue;const Q=u.paint.get(U);if(!(Q instanceof vs&&ja(Q.property.specification)))continue;const re=af(U,u.type),Ae=Q.value,_e=Q.property.specification.type,Le=Q.property.useIntegerZoom,qe=Q.property.specification["property-type"],et=qe==="cross-faded"||qe==="cross-faded-data-driven";if(Ae.kind==="constant")this.binders[U]=et?new Zl(Ae.value,re):new Ws(Ae.value,re,_e),L.push(`/u_${U}`);else if(Ae.kind==="source"||et){const At=Vh(U,_e,"source");this.binders[U]=et?new vl(Ae,_e,Le,p,At,u.id):new hu(Ae,re,_e,At),L.push(`/a_${U}`)}else{const At=Vh(U,_e,"composite");this.binders[U]=new il(Ae,re,_e,Le,p,At),L.push(`/z_${U}`)}}this.cacheKey=L.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof hu||p instanceof il?p.maxValue:0}populatePaintArrays(u,p,S,L,U){for(const Q in this.binders){const re=this.binders[Q];(re instanceof hu||re instanceof il||re instanceof vl)&&re.populatePaintArray(u,p,S,L,U)}}setConstantPatternPositions(u,p){for(const S in this.binders){const L=this.binders[S];L instanceof Zl&&L.setConstantPatternPositions(u,p)}}updatePaintArrays(u,p,S,L,U){let Q=!1;for(const re in u){const Ae=p.getPositions(re);for(const _e of Ae){const Le=S.feature(_e.index);for(const qe in this.binders){const et=this.binders[qe];if((et instanceof hu||et instanceof il||et instanceof vl)&&et.expression.isStateDependent===!0){const At=L.paint.get(qe);et.expression=At.value,et.updatePaintArray(_e.start,_e.end,Le,u[re],U),Q=!0}}}}return Q}defines(){const u=[];for(const p in this.binders){const S=this.binders[p];(S instanceof Ws||S instanceof Zl)&&u.push(...S.uniformNames.map(L=>`#define HAS_UNIFORM_${L}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const S=this.binders[p];if(S instanceof hu||S instanceof il)for(let L=0;L<S.paintVertexAttributes.length;L++)u.push(S.paintVertexAttributes[L].name);else if(S instanceof vl)for(let L=0;L<Aa.members.length;L++)u.push(Aa.members[L].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const S=this.binders[p];if(S instanceof Ws||S instanceof Zl||S instanceof il)for(const L of S.uniformNames)u.push(L)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,p){const S=[];for(const L in this.binders){const U=this.binders[L];if(U instanceof Ws||U instanceof Zl||U instanceof il){for(const Q of U.uniformNames)if(p[Q]){const re=U.getBinding(u,p[Q],Q);S.push({name:Q,property:L,binding:re})}}}return S}setUniforms(u,p,S,L){for(const{name:U,property:Q,binding:re}of p)this.binders[Q].setUniform(re,L,S.get(Q),U)}updatePaintBuffers(u){this._buffers=[];for(const p in this.binders){const S=this.binders[p];if(u&&S instanceof vl){const L=u.fromScale===2?S.zoomInPaintVertexBuffer:S.zoomOutPaintVertexBuffer;L&&this._buffers.push(L)}else(S instanceof hu||S instanceof il)&&S.paintVertexBuffer&&this._buffers.push(S.paintVertexBuffer)}}upload(u){for(const p in this.binders){const S=this.binders[p];(S instanceof hu||S instanceof il||S instanceof vl)&&S.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof hu||p instanceof il||p instanceof vl)&&p.destroy()}}}class Au{constructor(u,p,S=()=>!0){this.programConfigurations={};for(const L of u)this.programConfigurations[L.id]=new Pl(L,p,S);this.needsUpload=!1,this._featureMap=new Zs,this._bufferOffset=0}populatePaintArrays(u,p,S,L,U,Q){for(const re in this.programConfigurations)this.programConfigurations[re].populatePaintArrays(u,p,L,U,Q);p.id!==void 0&&this._featureMap.add(p.id,S,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,S,L){for(const U of S)this.needsUpload=this.programConfigurations[U.id].updatePaintArrays(u,this._featureMap,p,U,L)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function af(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function Vh(f,u,p){const S={color:{source:Ct,composite:T},number:{source:r,composite:Ct}},L=function(U){return{"line-pattern":{source:ji,composite:ji},"fill-pattern":{source:ji,composite:ji},"fill-extrusion-pattern":{source:ji,composite:ji}}[U]}(f);return L&&L[p]||S[u][p]}Pn("ConstantBinder",Ws),Pn("CrossFadedConstantBinder",Zl),Pn("SourceExpressionBinder",hu),Pn("CrossFadedCompositeBinder",vl),Pn("CompositeExpressionBinder",il),Pn("ProgramConfiguration",Pl,{omit:["_buffers"]}),Pn("ProgramConfigurationSet",Au);const Pa=8192,pA=Math.pow(2,14)-1,yh=-pA-1;function Uh(f){const u=Pa/f.extent,p=f.loadGeometry();for(let S=0;S<p.length;S++){const L=p[S];for(let U=0;U<L.length;U++){const Q=L[U],re=Math.round(Q.x*u),Ae=Math.round(Q.y*u);Q.x=Ge(re,yh,pA),Q.y=Ge(Ae,yh,pA),(re<Q.x||re>Q.x+1||Ae<Q.y||Ae>Q.y+1)&&$e("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function Ic(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Uh(f):[]}}function Gh(f,u,p,S,L){f.emplaceBack(2*u+(S+1)/2,2*p+(L+1)/2)}class l0{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new wt,this.indexArray=new Bn,this.segments=new er,this.programConfigurations=new Au(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){const L=this.layers[0],U=[];let Q=null,re=!1;L.type==="circle"&&(Q=L.layout.get("circle-sort-key"),re=!Q.isConstant());for(const{feature:Ae,id:_e,index:Le,sourceLayerIndex:qe}of u){const et=this.layers[0]._featureFilter.needGeometry,At=Ic(Ae,et);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),At,S))continue;const _t=re?Q.evaluate(At,{},S):void 0,Mt={id:_e,properties:Ae.properties,type:Ae.type,sourceLayerIndex:qe,index:Le,geometry:et?At.geometry:Uh(Ae),patterns:{},sortKey:_t};U.push(Mt)}re&&U.sort((Ae,_e)=>Ae.sortKey-_e.sortKey);for(const Ae of U){const{geometry:_e,index:Le,sourceLayerIndex:qe}=Ae,et=u[Le].feature;this.addFeature(Ae,_e,Le,S),p.featureIndex.insert(et,_e,Le,qe,this.index)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,yr),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,S,L){for(const U of p)for(const Q of U){const re=Q.x,Ae=Q.y;if(re<0||re>=Pa||Ae<0||Ae>=Pa)continue;const _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Le=_e.vertexLength;Gh(this.layoutVertexArray,re,Ae,-1,-1),Gh(this.layoutVertexArray,re,Ae,1,-1),Gh(this.layoutVertexArray,re,Ae,1,1),Gh(this.layoutVertexArray,re,Ae,-1,1),this.indexArray.emplaceBack(Le,Le+1,Le+2),this.indexArray.emplaceBack(Le,Le+3,Le+2),_e.vertexLength+=4,_e.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,{},L)}}function Xc(f,u){for(let p=0;p<f.length;p++)if(Xu(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Xu(f,u[p]))return!0;return!!Yc(f,u)}function _p(f,u,p){return!!Xu(f,u)||!!lf(u,f,p)}function qh(f,u){if(f.length===1)return Ql(u,f[0]);for(let p=0;p<u.length;p++){const S=u[p];for(let L=0;L<S.length;L++)if(Xu(f,S[L]))return!0}for(let p=0;p<f.length;p++)if(Ql(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Yc(f,u[p]))return!0;return!1}function of(f,u,p){if(f.length>1){if(Yc(f,u))return!0;for(let S=0;S<u.length;S++)if(lf(u[S],f,p))return!0}for(let S=0;S<f.length;S++)if(lf(f[S],u,p))return!0;return!1}function Yc(f,u){if(f.length===0||u.length===0)return!1;for(let p=0;p<f.length-1;p++){const S=f[p],L=f[p+1];for(let U=0;U<u.length-1;U++)if(yp(S,L,u[U],u[U+1]))return!0}return!1}function yp(f,u,p,S){return mt(f,p,S)!==mt(u,p,S)&&mt(f,u,p)!==mt(f,u,S)}function lf(f,u,p){const S=p*p;if(u.length===1)return f.distSqr(u[0])<S;for(let L=1;L<u.length;L++)if(q0(f,u[L-1],u[L])<S)return!0;return!1}function q0(f,u,p){const S=u.distSqr(p);if(S===0)return f.distSqr(u);const L=((f.x-u.x)*(p.x-u.x)+(f.y-u.y)*(p.y-u.y))/S;return f.distSqr(L<0?u:L>1?p:p.sub(u)._mult(L)._add(u))}function Ql(f,u){let p,S,L,U=!1;for(let Q=0;Q<f.length;Q++){p=f[Q];for(let re=0,Ae=p.length-1;re<p.length;Ae=re++)S=p[re],L=p[Ae],S.y>u.y!=L.y>u.y&&u.x<(L.x-S.x)*(u.y-S.y)/(L.y-S.y)+S.x&&(U=!U)}return U}function Xu(f,u){let p=!1;for(let S=0,L=f.length-1;S<f.length;L=S++){const U=f[S],Q=f[L];U.y>u.y!=Q.y>u.y&&u.x<(Q.x-U.x)*(u.y-U.y)/(Q.y-U.y)+U.x&&(p=!p)}return p}function H0(f,u,p){const S=p[0],L=p[2];if(f.x<S.x&&u.x<S.x||f.x>L.x&&u.x>L.x||f.y<S.y&&u.y<S.y||f.y>L.y&&u.y>L.y)return!1;const U=mt(f,u,p[0]);return U!==mt(f,u,p[1])||U!==mt(f,u,p[2])||U!==mt(f,u,p[3])}function vh(f,u,p){const S=u.paint.get(f).value;return S.kind==="constant"?S.value:p.programConfigurations.get(u.id).getMaxValue(f)}function $c(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function mA(f,u,p,S,L){if(!u[0]&&!u[1])return f;const U=ue.convert(u)._mult(L);p==="viewport"&&U._rotate(-S);const Q=[];for(let re=0;re<f.length;re++)Q.push(f[re].sub(U));return Q}let uf,u0;Pn("CircleBucket",l0,{omit:["layers"]});var ps={get paint(){return u0=u0||new cs({"circle-radius":new Bi(hi.paint_circle["circle-radius"]),"circle-color":new Bi(hi.paint_circle["circle-color"]),"circle-blur":new Bi(hi.paint_circle["circle-blur"]),"circle-opacity":new Bi(hi.paint_circle["circle-opacity"]),"circle-translate":new ki(hi.paint_circle["circle-translate"]),"circle-translate-anchor":new ki(hi.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ki(hi.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ki(hi.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bi(hi.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bi(hi.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bi(hi.paint_circle["circle-stroke-opacity"])})},get layout(){return uf=uf||new cs({"circle-sort-key":new Bi(hi.layout_circle["circle-sort-key"])})}},Wl=1e-6,Hh=typeof Float32Array<"u"?Float32Array:Array;function jh(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function cf(f,u,p){var S=u[0],L=u[1],U=u[2],Q=u[3],re=u[4],Ae=u[5],_e=u[6],Le=u[7],qe=u[8],et=u[9],At=u[10],_t=u[11],Mt=u[12],Dt=u[13],Bt=u[14],Kt=u[15],Ht=p[0],Zt=p[1],ci=p[2],yi=p[3];return f[0]=Ht*S+Zt*re+ci*qe+yi*Mt,f[1]=Ht*L+Zt*Ae+ci*et+yi*Dt,f[2]=Ht*U+Zt*_e+ci*At+yi*Bt,f[3]=Ht*Q+Zt*Le+ci*_t+yi*Kt,f[4]=(Ht=p[4])*S+(Zt=p[5])*re+(ci=p[6])*qe+(yi=p[7])*Mt,f[5]=Ht*L+Zt*Ae+ci*et+yi*Dt,f[6]=Ht*U+Zt*_e+ci*At+yi*Bt,f[7]=Ht*Q+Zt*Le+ci*_t+yi*Kt,f[8]=(Ht=p[8])*S+(Zt=p[9])*re+(ci=p[10])*qe+(yi=p[11])*Mt,f[9]=Ht*L+Zt*Ae+ci*et+yi*Dt,f[10]=Ht*U+Zt*_e+ci*At+yi*Bt,f[11]=Ht*Q+Zt*Le+ci*_t+yi*Kt,f[12]=(Ht=p[12])*S+(Zt=p[13])*re+(ci=p[14])*qe+(yi=p[15])*Mt,f[13]=Ht*L+Zt*Ae+ci*et+yi*Dt,f[14]=Ht*U+Zt*_e+ci*At+yi*Bt,f[15]=Ht*Q+Zt*Le+ci*_t+yi*Kt,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var gA,j0=cf;function Dl(f,u,p){var S=u[0],L=u[1],U=u[2],Q=u[3];return f[0]=p[0]*S+p[4]*L+p[8]*U+p[12]*Q,f[1]=p[1]*S+p[5]*L+p[9]*U+p[13]*Q,f[2]=p[2]*S+p[6]*L+p[10]*U+p[14]*Q,f[3]=p[3]*S+p[7]*L+p[11]*U+p[15]*Q,f}gA=new Hh(4),Hh!=Float32Array&&(gA[0]=0,gA[1]=0,gA[2]=0,gA[3]=0);class Vu extends Ms{constructor(u){super(u,ps)}createBucket(u){return new l0(u)}queryRadius(u){const p=u;return vh("circle-radius",this,p)+vh("circle-stroke-width",this,p)+$c(this.paint.get("circle-translate"))}queryIntersectsFeature(u,p,S,L,U,Q,re,Ae){const _e=mA(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,re),Le=this.paint.get("circle-radius").evaluate(p,S)+this.paint.get("circle-stroke-width").evaluate(p,S),qe=this.paint.get("circle-pitch-alignment")==="map",et=qe?_e:function(_t,Mt){return _t.map(Dt=>_A(Dt,Mt))}(_e,Ae),At=qe?Le*re:Le;for(const _t of L)for(const Mt of _t){const Dt=qe?Mt:_A(Mt,Ae);let Bt=At;const Kt=Dl([],[Mt.x,Mt.y,0,1],Ae);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Bt*=Kt[3]/Q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Bt*=Q.cameraToCenterDistance/Kt[3]),_p(et,Dt,Bt))return!0}return!1}}function _A(f,u){const p=Dl([],[f.x,f.y,0,1],u);return new ue(p[0]/p[3],p[1]/p[3])}class c0 extends l0{}let h0;Pn("HeatmapBucket",c0,{omit:["layers"]});var vp={get paint(){return h0=h0||new cs({"heatmap-radius":new Bi(hi.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bi(hi.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ki(hi.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Oo(hi.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ki(hi.paint_heatmap["heatmap-opacity"])})}};function xu(f,{width:u,height:p},S,L){if(L){if(L instanceof Uint8ClampedArray)L=new Uint8Array(L.buffer);else if(L.length!==u*p*S)throw new RangeError(`mismatched image size. expected: ${L.length} but got: ${u*p*S}`)}else L=new Uint8Array(u*p*S);return f.width=u,f.height=p,f.data=L,f}function Kc(f,{width:u,height:p},S){if(u===f.width&&p===f.height)return;const L=xu({},{width:u,height:p},S);hf(f,L,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,p)},S),f.width=u,f.height=p,f.data=L.data}function hf(f,u,p,S,L,U){if(L.width===0||L.height===0)return u;if(L.width>f.width||L.height>f.height||p.x>f.width-L.width||p.y>f.height-L.height)throw new RangeError("out of range source coordinates for image copy");if(L.width>u.width||L.height>u.height||S.x>u.width-L.width||S.y>u.height-L.height)throw new RangeError("out of range destination coordinates for image copy");const Q=f.data,re=u.data;if(Q===re)throw new Error("srcData equals dstData, so image is already copied");for(let Ae=0;Ae<L.height;Ae++){const _e=((p.y+Ae)*f.width+p.x)*U,Le=((S.y+Ae)*u.width+S.x)*U;for(let qe=0;qe<L.width*U;qe++)re[Le+qe]=Q[_e+qe]}return u}class xh{constructor(u,p){xu(this,u,1,p)}resize(u){Kc(this,u,1)}clone(){return new xh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,S,L,U){hf(u,p,S,L,U,1)}}class Ll{constructor(u,p){xu(this,u,4,p)}resize(u){Kc(this,u,4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Ll({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,S,L,U){hf(u,p,S,L,U,4)}}function A0(f){const u={},p=f.resolution||256,S=f.clips?f.clips.length:1,L=f.image||new Ll({width:p,height:S});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const U=(Q,re,Ae)=>{u[f.evaluationKey]=Ae;const _e=f.expression.evaluate(u);L.data[Q+re+0]=Math.floor(255*_e.r/_e.a),L.data[Q+re+1]=Math.floor(255*_e.g/_e.a),L.data[Q+re+2]=Math.floor(255*_e.b/_e.a),L.data[Q+re+3]=Math.floor(255*_e.a)};if(f.clips)for(let Q=0,re=0;Q<S;++Q,re+=4*p)for(let Ae=0,_e=0;Ae<p;Ae++,_e+=4){const Le=Ae/(p-1),{start:qe,end:et}=f.clips[Q];U(re,_e,qe*(1-Le)+et*Le)}else for(let Q=0,re=0;Q<p;Q++,re+=4)U(0,re,Q/(p-1));return L}Pn("AlphaImage",xh),Pn("RGBAImage",Ll);class Jc extends Ms{createBucket(u){return new c0(u)}constructor(u){super(u,vp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=A0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Zh;var Z0={get paint(){return Zh=Zh||new cs({"hillshade-illumination-direction":new ki(hi.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ki(hi.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ki(hi.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ki(hi.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ki(hi.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ki(hi.paint_hillshade["hillshade-accent-color"])})}};class Q0 extends Ms{constructor(u){super(u,Z0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const bh=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:Cm}=bh;var Ec={exports:{}};function Af(f,u,p){p=p||2;var S,L,U,Q,re,Ae,_e,Le=u&&u.length,qe=Le?u[0]*p:f.length,et=W0(f,0,qe,p,!0),At=[];if(!et||et.next===et.prev)return At;if(Le&&(et=function(Mt,Dt,Bt,Kt){var Ht,Zt,ci,yi=[];for(Ht=0,Zt=Dt.length;Ht<Zt;Ht++)(ci=W0(Mt,Dt[Ht]*Kt,Ht<Zt-1?Dt[Ht+1]*Kt:Mt.length,Kt,!1))===ci.next&&(ci.steiner=!0),yi.push(oc(ci));for(yi.sort(xp),Ht=0;Ht<yi.length;Ht++)Bt=pf(yi[Ht],Bt);return Bt}(f,u,et,p)),f.length>80*p){S=U=f[0],L=Q=f[1];for(var _t=p;_t<qe;_t+=p)(re=f[_t])<S&&(S=re),(Ae=f[_t+1])<L&&(L=Ae),re>U&&(U=re),Ae>Q&&(Q=Ae);_e=(_e=Math.max(U-S,Q-L))!==0?32767/_e:0}return ff(et,At,p,S,L,_e,0),At}function W0(f,u,p,S,L){var U,Q;if(L===xA(f,u,p,S)>0)for(U=u;U<p;U+=S)Q=wh(U,f[U],f[U+1],Q);else for(U=p-S;U>=u;U-=S)Q=wh(U,f[U],f[U+1],Q);return Q&&lc(Q,Q.next)&&(vf(Q),Q=Q.next),Q}function ac(f,u){if(!f)return f;u||(u=f);var p,S=f;do if(p=!1,S.steiner||!lc(S,S.next)&&Da(S.prev,S,S.next)!==0)S=S.next;else{if(vf(S),(S=u=S.prev)===S.next)break;p=!0}while(p||S!==u);return u}function ff(f,u,p,S,L,U,Q){if(f){!Q&&U&&function(Le,qe,et,At){var _t=Le;do _t.z===0&&(_t.z=xl(_t.x,_t.y,qe,et,At)),_t.prevZ=_t.prev,_t.nextZ=_t.next,_t=_t.next;while(_t!==Le);_t.prevZ.nextZ=null,_t.prevZ=null,function(Mt){var Dt,Bt,Kt,Ht,Zt,ci,yi,Xi,xn=1;do{for(Bt=Mt,Mt=null,Zt=null,ci=0;Bt;){for(ci++,Kt=Bt,yi=0,Dt=0;Dt<xn&&(yi++,Kt=Kt.nextZ);Dt++);for(Xi=xn;yi>0||Xi>0&&Kt;)yi!==0&&(Xi===0||!Kt||Bt.z<=Kt.z)?(Ht=Bt,Bt=Bt.nextZ,yi--):(Ht=Kt,Kt=Kt.nextZ,Xi--),Zt?Zt.nextZ=Ht:Mt=Ht,Ht.prevZ=Zt,Zt=Ht;Bt=Kt}Zt.nextZ=null,xn*=2}while(ci>1)}(_t)}(f,S,L,U);for(var re,Ae,_e=f;f.prev!==f.next;)if(re=f.prev,Ae=f.next,U?Tm(f,S,L,U):yA(f))u.push(re.i/p|0),u.push(f.i/p|0),u.push(Ae.i/p|0),vf(f),f=Ae.next,_e=Ae.next;else if((f=Ae)===_e){Q?Q===1?ff(f=Po(ac(f),u,p),u,p,S,L,U,2):Q===2&&df(f,u,p,S,L,U):ff(ac(f),u,p,S,L,U,1);break}}}function yA(f){var u=f.prev,p=f,S=f.next;if(Da(u,p,S)>=0)return!1;for(var L=u.x,U=p.x,Q=S.x,re=u.y,Ae=p.y,_e=S.y,Le=L<U?L<Q?L:Q:U<Q?U:Q,qe=re<Ae?re<_e?re:_e:Ae<_e?Ae:_e,et=L>U?L>Q?L:Q:U>Q?U:Q,At=re>Ae?re>_e?re:_e:Ae>_e?Ae:_e,_t=S.next;_t!==u;){if(_t.x>=Le&&_t.x<=et&&_t.y>=qe&&_t.y<=At&&Qh(L,re,U,Ae,Q,_e,_t.x,_t.y)&&Da(_t.prev,_t,_t.next)>=0)return!1;_t=_t.next}return!0}function Tm(f,u,p,S){var L=f.prev,U=f,Q=f.next;if(Da(L,U,Q)>=0)return!1;for(var re=L.x,Ae=U.x,_e=Q.x,Le=L.y,qe=U.y,et=Q.y,At=re<Ae?re<_e?re:_e:Ae<_e?Ae:_e,_t=Le<qe?Le<et?Le:et:qe<et?qe:et,Mt=re>Ae?re>_e?re:_e:Ae>_e?Ae:_e,Dt=Le>qe?Le>et?Le:et:qe>et?qe:et,Bt=xl(At,_t,u,p,S),Kt=xl(Mt,Dt,u,p,S),Ht=f.prevZ,Zt=f.nextZ;Ht&&Ht.z>=Bt&&Zt&&Zt.z<=Kt;){if(Ht.x>=At&&Ht.x<=Mt&&Ht.y>=_t&&Ht.y<=Dt&&Ht!==L&&Ht!==Q&&Qh(re,Le,Ae,qe,_e,et,Ht.x,Ht.y)&&Da(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,Zt.x>=At&&Zt.x<=Mt&&Zt.y>=_t&&Zt.y<=Dt&&Zt!==L&&Zt!==Q&&Qh(re,Le,Ae,qe,_e,et,Zt.x,Zt.y)&&Da(Zt.prev,Zt,Zt.next)>=0))return!1;Zt=Zt.nextZ}for(;Ht&&Ht.z>=Bt;){if(Ht.x>=At&&Ht.x<=Mt&&Ht.y>=_t&&Ht.y<=Dt&&Ht!==L&&Ht!==Q&&Qh(re,Le,Ae,qe,_e,et,Ht.x,Ht.y)&&Da(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;Zt&&Zt.z<=Kt;){if(Zt.x>=At&&Zt.x<=Mt&&Zt.y>=_t&&Zt.y<=Dt&&Zt!==L&&Zt!==Q&&Qh(re,Le,Ae,qe,_e,et,Zt.x,Zt.y)&&Da(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.nextZ}return!0}function Po(f,u,p){var S=f;do{var L=S.prev,U=S.next.next;!lc(L,U)&&f0(L,S,S.next,U)&&Cc(L,U)&&Cc(U,L)&&(u.push(L.i/p|0),u.push(S.i/p|0),u.push(U.i/p|0),vf(S),vf(S.next),S=f=U),S=S.next}while(S!==f);return ac(S)}function df(f,u,p,S,L,U){var Q=f;do{for(var re=Q.next.next;re!==Q.prev;){if(Q.i!==re.i&&gf(Q,re)){var Ae=Wh(Q,re);return Q=ac(Q,Q.next),Ae=ac(Ae,Ae.next),ff(Q,u,p,S,L,U,0),void ff(Ae,u,p,S,L,U,0)}re=re.next}Q=Q.next}while(Q!==f)}function xp(f,u){return f.x-u.x}function pf(f,u){var p=function(L,U){var Q,re=U,Ae=L.x,_e=L.y,Le=-1/0;do{if(_e<=re.y&&_e>=re.next.y&&re.next.y!==re.y){var qe=re.x+(_e-re.y)*(re.next.x-re.x)/(re.next.y-re.y);if(qe<=Ae&&qe>Le&&(Le=qe,Q=re.x<re.next.x?re:re.next,qe===Ae))return Q}re=re.next}while(re!==U);if(!Q)return null;var et,At=Q,_t=Q.x,Mt=Q.y,Dt=1/0;re=Q;do Ae>=re.x&&re.x>=_t&&Ae!==re.x&&Qh(_e<Mt?Ae:Le,_e,_t,Mt,_e<Mt?Le:Ae,_e,re.x,re.y)&&(et=Math.abs(_e-re.y)/(Ae-re.x),Cc(re,L)&&(et<Dt||et===Dt&&(re.x>Q.x||re.x===Q.x&&mf(Q,re)))&&(Q=re,Dt=et)),re=re.next;while(re!==At);return Q}(f,u);if(!p)return u;var S=Wh(p,f);return ac(S,S.next),ac(p,p.next)}function mf(f,u){return Da(f.prev,f,u.prev)<0&&Da(u.next,f,f.next)<0}function xl(f,u,p,S,L){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*L|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-S)*L|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function oc(f){var u=f,p=f;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==f);return p}function Qh(f,u,p,S,L,U,Q,re){return(L-Q)*(u-re)>=(f-Q)*(U-re)&&(f-Q)*(S-re)>=(p-Q)*(u-re)&&(p-Q)*(U-re)>=(L-Q)*(S-re)}function gf(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(p,S){var L=p;do{if(L.i!==p.i&&L.next.i!==p.i&&L.i!==S.i&&L.next.i!==S.i&&f0(L,L.next,p,S))return!0;L=L.next}while(L!==p);return!1}(f,u)&&(Cc(f,u)&&Cc(u,f)&&function(p,S){var L=p,U=!1,Q=(p.x+S.x)/2,re=(p.y+S.y)/2;do L.y>re!=L.next.y>re&&L.next.y!==L.y&&Q<(L.next.x-L.x)*(re-L.y)/(L.next.y-L.y)+L.x&&(U=!U),L=L.next;while(L!==p);return U}(f,u)&&(Da(f.prev,f,u.prev)||Da(f,u.prev,u))||lc(f,u)&&Da(f.prev,f,f.next)>0&&Da(u.prev,u,u.next)>0)}function Da(f,u,p){return(u.y-f.y)*(p.x-u.x)-(u.x-f.x)*(p.y-u.y)}function lc(f,u){return f.x===u.x&&f.y===u.y}function f0(f,u,p,S){var L=yf(Da(f,u,p)),U=yf(Da(f,u,S)),Q=yf(Da(p,S,f)),re=yf(Da(p,S,u));return L!==U&&Q!==re||!(L!==0||!_f(f,p,u))||!(U!==0||!_f(f,S,u))||!(Q!==0||!_f(p,f,S))||!(re!==0||!_f(p,u,S))}function _f(f,u,p){return u.x<=Math.max(f.x,p.x)&&u.x>=Math.min(f.x,p.x)&&u.y<=Math.max(f.y,p.y)&&u.y>=Math.min(f.y,p.y)}function yf(f){return f>0?1:f<0?-1:0}function Cc(f,u){return Da(f.prev,f,f.next)<0?Da(f,u,f.next)>=0&&Da(f,f.prev,u)>=0:Da(f,u,f.prev)<0||Da(f,f.next,u)<0}function Wh(f,u){var p=new vA(f.i,f.x,f.y),S=new vA(u.i,u.x,u.y),L=f.next,U=u.prev;return f.next=u,u.prev=f,p.next=L,L.prev=p,S.next=p,p.prev=S,U.next=S,S.prev=U,S}function wh(f,u,p,S){var L=new vA(f,u,p);return S?(L.next=S.next,L.prev=S,S.next.prev=L,S.next=L):(L.prev=L,L.next=L),L}function vf(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function vA(f,u,p){this.i=f,this.x=u,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xA(f,u,p,S){for(var L=0,U=u,Q=p-S;U<p;U+=S)L+=(f[Q]-f[U])*(f[U+1]+f[Q+1]),Q=U;return L}Ec.exports=Af,Ec.exports.default=Af,Af.deviation=function(f,u,p,S){var L=u&&u.length,U=Math.abs(xA(f,0,L?u[0]*p:f.length,p));if(L)for(var Q=0,re=u.length;Q<re;Q++)U-=Math.abs(xA(f,u[Q]*p,Q<re-1?u[Q+1]*p:f.length,p));var Ae=0;for(Q=0;Q<S.length;Q+=3){var _e=S[Q]*p,Le=S[Q+1]*p,qe=S[Q+2]*p;Ae+=Math.abs((f[_e]-f[qe])*(f[Le+1]-f[_e+1])-(f[_e]-f[Le])*(f[qe+1]-f[_e+1]))}return U===0&&Ae===0?0:Math.abs((Ae-U)/U)},Af.flatten=function(f){for(var u=f[0][0].length,p={vertices:[],holes:[],dimensions:u},S=0,L=0;L<f.length;L++){for(var U=0;U<f[L].length;U++)for(var Q=0;Q<u;Q++)p.vertices.push(f[L][U][Q]);L>0&&p.holes.push(S+=f[L-1].length)}return p};var Xh=W(Ec.exports);function X0(f,u,p,S,L){bA(f,u,p||0,S||f.length-1,L||d0)}function bA(f,u,p,S,L){for(;S>p;){if(S-p>600){var U=S-p+1,Q=u-p+1,re=Math.log(U),Ae=.5*Math.exp(2*re/3),_e=.5*Math.sqrt(re*Ae*(U-Ae)/U)*(Q-U/2<0?-1:1);bA(f,u,Math.max(p,Math.floor(u-Q*Ae/U+_e)),Math.min(S,Math.floor(u+(U-Q)*Ae/U+_e)),L)}var Le=f[u],qe=p,et=S;for(Yh(f,p,u),L(f[S],Le)>0&&Yh(f,p,S);qe<et;){for(Yh(f,qe,et),qe++,et--;L(f[qe],Le)<0;)qe++;for(;L(f[et],Le)>0;)et--}L(f[p],Le)===0?Yh(f,p,et):Yh(f,++et,S),et<=u&&(p=et+1),u<=et&&(S=et-1)}}function Yh(f,u,p){var S=f[u];f[u]=f[p],f[p]=S}function d0(f,u){return f<u?-1:f>u?1:0}function Y0(f,u){const p=f.length;if(p<=1)return[f];const S=[];let L,U;for(let Q=0;Q<p;Q++){const re=st(f[Q]);re!==0&&(f[Q].area=Math.abs(re),U===void 0&&(U=re<0),U===re<0?(L&&S.push(L),L=[f[Q]]):L.push(f[Q]))}if(L&&S.push(L),u>1)for(let Q=0;Q<S.length;Q++)S[Q].length<=u||(X0(S[Q],u,1,S[Q].length-1,bp),S[Q]=S[Q].slice(0,u));return S}function bp(f,u){return u.area-f.area}function wA(f,u,p){const S=p.patternDependencies;let L=!1;for(const U of u){const Q=U.paint.get(`${f}-pattern`);Q.isConstant()||(L=!0);const re=Q.constantOr(null);re&&(L=!0,S[re.to]=!0,S[re.from]=!0)}return L}function uc(f,u,p,S,L){const U=L.patternDependencies;for(const Q of u){const re=Q.paint.get(`${f}-pattern`).value;if(re.kind!=="constant"){let Ae=re.evaluate({zoom:S-1},p,{},L.availableImages),_e=re.evaluate({zoom:S},p,{},L.availableImages),Le=re.evaluate({zoom:S+1},p,{},L.availableImages);Ae=Ae&&Ae.name?Ae.name:Ae,_e=_e&&_e.name?_e.name:_e,Le=Le&&Le.name?Le.name:Le,U[Ae]=!0,U[_e]=!0,U[Le]=!0,p.patterns[Q.id]={min:Ae,mid:_e,max:Le}}}return p}class xf{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ri,this.indexArray=new Bn,this.indexArray2=new rn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.segments2=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){this.hasPattern=wA("fill",this.layers,p);const L=this.layers[0].layout.get("fill-sort-key"),U=!L.isConstant(),Q=[];for(const{feature:re,id:Ae,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,et=Ic(re,qe);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),et,S))continue;const At=U?L.evaluate(et,{},S,p.availableImages):void 0,_t={id:Ae,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?et.geometry:Uh(re),patterns:{},sortKey:At};Q.push(_t)}U&&Q.sort((re,Ae)=>re.sortKey-Ae.sortKey);for(const re of Q){const{geometry:Ae,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=uc("fill",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,Ae,_e,S,{});p.featureIndex.insert(u[_e].feature,Ae,_e,Le,this.index)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}addFeatures(u,p,S){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Cm),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,S,L,U){for(const Q of Y0(p,500)){let re=0;for(const At of Q)re+=At.length;const Ae=this.segments.prepareSegment(re,this.layoutVertexArray,this.indexArray),_e=Ae.vertexLength,Le=[],qe=[];for(const At of Q){if(At.length===0)continue;At!==Q[0]&&qe.push(Le.length/2);const _t=this.segments2.prepareSegment(At.length,this.layoutVertexArray,this.indexArray2),Mt=_t.vertexLength;this.layoutVertexArray.emplaceBack(At[0].x,At[0].y),this.indexArray2.emplaceBack(Mt+At.length-1,Mt),Le.push(At[0].x),Le.push(At[0].y);for(let Dt=1;Dt<At.length;Dt++)this.layoutVertexArray.emplaceBack(At[Dt].x,At[Dt].y),this.indexArray2.emplaceBack(Mt+Dt-1,Mt+Dt),Le.push(At[Dt].x),Le.push(At[Dt].y);_t.vertexLength+=At.length,_t.primitiveLength+=At.length}const et=Xh(Le,qe);for(let At=0;At<et.length;At+=3)this.indexArray.emplaceBack(_e+et[At],_e+et[At+1],_e+et[At+2]);Ae.vertexLength+=re,Ae.primitiveLength+=et.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,U,L)}}let $0,Sh;Pn("FillBucket",xf,{omit:["layers","patternFeatures"]});var eh={get paint(){return Sh=Sh||new cs({"fill-antialias":new ki(hi.paint_fill["fill-antialias"]),"fill-opacity":new Bi(hi.paint_fill["fill-opacity"]),"fill-color":new Bi(hi.paint_fill["fill-color"]),"fill-outline-color":new Bi(hi.paint_fill["fill-outline-color"]),"fill-translate":new ki(hi.paint_fill["fill-translate"]),"fill-translate-anchor":new ki(hi.paint_fill["fill-translate-anchor"]),"fill-pattern":new xs(hi.paint_fill["fill-pattern"])})},get layout(){return $0=$0||new cs({"fill-sort-key":new Bi(hi.layout_fill["fill-sort-key"])})}};class wp extends Ms{constructor(u){super(u,eh)}recalculate(u,p){super.recalculate(u,p);const S=this.paint._values["fill-outline-color"];S.value.kind==="constant"&&S.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new xf(u)}queryRadius(){return $c(this.paint.get("fill-translate"))}queryIntersectsFeature(u,p,S,L,U,Q,re){return qh(mA(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,re),L)}isTileClipped(){return!0}}const Sp=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ip=R([{name:"a_centroid",components:2,type:"Int16"}],4),{members:K0}=Sp;var Ih={},km=he,Tc=Eh;function Eh(f,u,p,S,L){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=S,this._values=L,f.readFields(bf,this,u)}function bf(f,u,p){f==1?u.id=p.readVarint():f==2?function(S,L){for(var U=S.readVarint()+S.pos;S.pos<U;){var Q=L._keys[S.readVarint()],re=L._values[S.readVarint()];L.properties[Q]=re}}(p,u):f==3?u.type=p.readVarint():f==4&&(u._geometry=p.pos)}function $h(f){for(var u,p,S=0,L=0,U=f.length,Q=U-1;L<U;Q=L++)S+=((p=f[Q]).x-(u=f[L]).x)*(u.y+p.y);return S}Eh.types=["Unknown","Point","LineString","Polygon"],Eh.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,p=f.readVarint()+f.pos,S=1,L=0,U=0,Q=0,re=[];f.pos<p;){if(L<=0){var Ae=f.readVarint();S=7&Ae,L=Ae>>3}if(L--,S===1||S===2)U+=f.readSVarint(),Q+=f.readSVarint(),S===1&&(u&&re.push(u),u=[]),u.push(new km(U,Q));else{if(S!==7)throw new Error("unknown command "+S);u&&u.push(u[0].clone())}}return u&&re.push(u),re},Eh.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,p=1,S=0,L=0,U=0,Q=1/0,re=-1/0,Ae=1/0,_e=-1/0;f.pos<u;){if(S<=0){var Le=f.readVarint();p=7&Le,S=Le>>3}if(S--,p===1||p===2)(L+=f.readSVarint())<Q&&(Q=L),L>re&&(re=L),(U+=f.readSVarint())<Ae&&(Ae=U),U>_e&&(_e=U);else if(p!==7)throw new Error("unknown command "+p)}return[Q,Ae,re,_e]},Eh.prototype.toGeoJSON=function(f,u,p){var S,L,U=this.extent*Math.pow(2,p),Q=this.extent*f,re=this.extent*u,Ae=this.loadGeometry(),_e=Eh.types[this.type];function Le(At){for(var _t=0;_t<At.length;_t++){var Mt=At[_t];At[_t]=[360*(Mt.x+Q)/U-180,360/Math.PI*Math.atan(Math.exp((180-360*(Mt.y+re)/U)*Math.PI/180))-90]}}switch(this.type){case 1:var qe=[];for(S=0;S<Ae.length;S++)qe[S]=Ae[S][0];Le(Ae=qe);break;case 2:for(S=0;S<Ae.length;S++)Le(Ae[S]);break;case 3:for(Ae=function(At){var _t=At.length;if(_t<=1)return[At];for(var Mt,Dt,Bt=[],Kt=0;Kt<_t;Kt++){var Ht=$h(At[Kt]);Ht!==0&&(Dt===void 0&&(Dt=Ht<0),Dt===Ht<0?(Mt&&Bt.push(Mt),Mt=[At[Kt]]):Mt.push(At[Kt]))}return Mt&&Bt.push(Mt),Bt}(Ae),S=0;S<Ae.length;S++)for(L=0;L<Ae[S].length;L++)Le(Ae[S][L])}Ae.length===1?Ae=Ae[0]:_e="Multi"+_e;var et={type:"Feature",geometry:{type:_e,coordinates:Ae},properties:this.properties};return"id"in this&&(et.id=this.id),et};var SA=Tc,Kh=Ir;function Ir(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(wf,this,u),this.length=this._features.length}function wf(f,u,p){f===15?u.version=p.readVarint():f===1?u.name=p.readString():f===5?u.extent=p.readVarint():f===2?u._features.push(p.pos):f===3?u._keys.push(p.readString()):f===4&&u._values.push(function(S){for(var L=null,U=S.readVarint()+S.pos;S.pos<U;){var Q=S.readVarint()>>3;L=Q===1?S.readString():Q===2?S.readFloat():Q===3?S.readDouble():Q===4?S.readVarint64():Q===5?S.readVarint():Q===6?S.readSVarint():Q===7?S.readBoolean():null}return L}(p))}Ir.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new SA(this._pbf,u,this.extent,this._keys,this._values)};var J0=Kh;function Jh(f,u,p){if(f===3){var S=new J0(p,p.readVarint()+p.pos);S.length&&(u[S.name]=S)}}Ih.VectorTile=function(f,u){this.layers=f.readFields(Jh,{},u)},Ih.VectorTileFeature=Tc,Ih.VectorTileLayer=Kh;const Sf=Ih.VectorTileFeature.types,IA=Math.pow(2,13);function EA(f,u,p,S,L,U,Q,re){f.emplaceBack(u,p,2*Math.floor(S*IA)+Q,L*IA*2,U*IA*2,Math.round(re))}class Ul{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new Yt,this.centroidVertexArray=new Et,this.indexArray=new Bn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){this.features=[],this.hasPattern=wA("fill-extrusion",this.layers,p);for(const{feature:L,id:U,index:Q,sourceLayerIndex:re}of u){const Ae=this.layers[0]._featureFilter.needGeometry,_e=Ic(L,Ae);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),_e,S))continue;const Le={id:U,sourceLayerIndex:re,index:Q,geometry:Ae?_e.geometry:Uh(L),properties:L.properties,type:L.type,patterns:{}};this.hasPattern?this.features.push(uc("fill-extrusion",this.layers,Le,this.zoom,p)):this.addFeature(Le,Le.geometry,Q,S,{}),p.featureIndex.insert(L,Le.geometry,Q,re,this.index,!0)}}addFeatures(u,p,S){for(const L of this.features){const{geometry:U}=L;this.addFeature(L,U,L.index,p,S)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,K0),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,Ip.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,p,S,L,U){const Q={x:0,y:0,vertexCount:0};for(const re of Y0(p,500)){let Ae=0;for(const _t of re)Ae+=_t.length;let _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const _t of re){if(_t.length===0||Pm(_t))continue;let Mt=0;for(let Dt=0;Dt<_t.length;Dt++){const Bt=_t[Dt];if(Dt>=1){const Kt=_t[Dt-1];if(!Mm(Bt,Kt)){_e.vertexLength+4>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ht=Bt.sub(Kt)._perp()._unit(),Zt=Kt.dist(Bt);Mt+Zt>32768&&(Mt=0),EA(this.layoutVertexArray,Bt.x,Bt.y,Ht.x,Ht.y,0,0,Mt),EA(this.layoutVertexArray,Bt.x,Bt.y,Ht.x,Ht.y,0,1,Mt),Q.x+=2*Bt.x,Q.y+=2*Bt.y,Q.vertexCount+=2,Mt+=Zt,EA(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,0,Mt),EA(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,1,Mt),Q.x+=2*Kt.x,Q.y+=2*Kt.y,Q.vertexCount+=2;const ci=_e.vertexLength;this.indexArray.emplaceBack(ci,ci+2,ci+1),this.indexArray.emplaceBack(ci+1,ci+2,ci+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+Ae>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(Ae,this.layoutVertexArray,this.indexArray)),Sf[u.type]!=="Polygon")continue;const Le=[],qe=[],et=_e.vertexLength;for(const _t of re)if(_t.length!==0){_t!==re[0]&&qe.push(Le.length/2);for(let Mt=0;Mt<_t.length;Mt++){const Dt=_t[Mt];EA(this.layoutVertexArray,Dt.x,Dt.y,0,0,1,1,0),Q.x+=Dt.x,Q.y+=Dt.y,Q.vertexCount+=1,Le.push(Dt.x),Le.push(Dt.y)}}const At=Xh(Le,qe);for(let _t=0;_t<At.length;_t+=3)this.indexArray.emplaceBack(et+At[_t],et+At[_t+2],et+At[_t+1]);_e.primitiveLength+=At.length/3,_e.vertexLength+=Ae}for(let re=0;re<Q.vertexCount;re++)this.centroidVertexArray.emplaceBack(Math.floor(Q.x/Q.vertexCount),Math.floor(Q.y/Q.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,U,L)}}function Mm(f,u){return f.x===u.x&&(f.x<0||f.x>Pa)||f.y===u.y&&(f.y<0||f.y>Pa)}function Pm(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Pa)||f.every(u=>u.y<0)||f.every(u=>u.y>Pa)}let ed;Pn("FillExtrusionBucket",Ul,{omit:["layers","features"]});var Dm={get paint(){return ed=ed||new cs({"fill-extrusion-opacity":new ki(hi["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bi(hi["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ki(hi["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ki(hi["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new xs(hi["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bi(hi["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bi(hi["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ki(hi["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class td extends Ms{constructor(u){super(u,Dm)}createBucket(u){return new Ul(u)}queryRadius(){return $c(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(u,p,S,L,U,Q,re,Ae){const _e=mA(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,re),Le=this.paint.get("fill-extrusion-height").evaluate(p,S),qe=this.paint.get("fill-extrusion-base").evaluate(p,S),et=function(_t,Mt,Dt,Bt){const Kt=[];for(const Ht of _t){const Zt=[Ht.x,Ht.y,0,1];Dl(Zt,Zt,Mt),Kt.push(new ue(Zt[0]/Zt[3],Zt[1]/Zt[3]))}return Kt}(_e,Ae),At=function(_t,Mt,Dt,Bt){const Kt=[],Ht=[],Zt=Bt[8]*Mt,ci=Bt[9]*Mt,yi=Bt[10]*Mt,Xi=Bt[11]*Mt,xn=Bt[8]*Dt,on=Bt[9]*Dt,an=Bt[10]*Dt,An=Bt[11]*Dt;for(const zn of _t){const sn=[],Wi=[];for(const Dn of zn){const Rn=Dn.x,pr=Dn.y,Vr=Bt[0]*Rn+Bt[4]*pr+Bt[12],Hr=Bt[1]*Rn+Bt[5]*pr+Bt[13],zs=Bt[2]*Rn+Bt[6]*pr+Bt[14],Ea=Bt[3]*Rn+Bt[7]*pr+Bt[15],ia=zs+yi,ns=Ea+Xi,Wn=Vr+xn,ws=Hr+on,ir=zs+an,na=Ea+An,Ps=new ue((Vr+Zt)/ns,(Hr+ci)/ns);Ps.z=ia/ns,sn.push(Ps);const Kn=new ue(Wn/na,ws/na);Kn.z=ir/na,Wi.push(Kn)}Kt.push(sn),Ht.push(Wi)}return[Kt,Ht]}(L,qe,Le,Ae);return function(_t,Mt,Dt){let Bt=1/0;qh(Dt,Mt)&&(Bt=id(Dt,Mt[0]));for(let Kt=0;Kt<Mt.length;Kt++){const Ht=Mt[Kt],Zt=_t[Kt];for(let ci=0;ci<Ht.length-1;ci++){const yi=Ht[ci],Xi=[yi,Ht[ci+1],Zt[ci+1],Zt[ci],yi];Xc(Dt,Xi)&&(Bt=Math.min(Bt,id(Dt,Xi)))}}return Bt!==1/0&&Bt}(At[0],At[1],et)}}function eA(f,u){return f.x*u.x+f.y*u.y}function id(f,u){if(f.length===1){let p=0;const S=u[p++];let L;for(;!L||S.equals(L);)if(L=u[p++],!L)return 1/0;for(;p<u.length;p++){const U=u[p],Q=f[0],re=L.sub(S),Ae=U.sub(S),_e=Q.sub(S),Le=eA(re,re),qe=eA(re,Ae),et=eA(Ae,Ae),At=eA(_e,re),_t=eA(_e,Ae),Mt=Le*et-qe*qe,Dt=(et*At-qe*_t)/Mt,Bt=(Le*_t-qe*At)/Mt,Kt=S.z*(1-Dt-Bt)+L.z*Dt+U.z*Bt;if(isFinite(Kt))return Kt}return 1/0}{let p=1/0;for(const S of u)p=Math.min(p,S.z);return p}}const Ep=R([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:kc}=Ep,bu=R([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:CA}=bu,Lm=Ih.VectorTileFeature.types,p0=Math.cos(Math.PI/180*37.5),Cp=Math.pow(2,14)/.5;class nd{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new ei,this.layoutVertexArray2=new si,this.indexArray=new Bn,this.programConfigurations=new Au(u.layers,u.zoom),this.segments=new er,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){this.hasPattern=wA("line",this.layers,p);const L=this.layers[0].layout.get("line-sort-key"),U=!L.isConstant(),Q=[];for(const{feature:re,id:Ae,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,et=Ic(re,qe);if(!this.layers[0]._featureFilter.filter(new gn(this.zoom),et,S))continue;const At=U?L.evaluate(et,{},S):void 0,_t={id:Ae,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?et.geometry:Uh(re),patterns:{},sortKey:At};Q.push(_t)}U&&Q.sort((re,Ae)=>re.sortKey-Ae.sortKey);for(const re of Q){const{geometry:Ae,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=uc("line",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,Ae,_e,S,{});p.featureIndex.insert(u[_e].feature,Ae,_e,Le,this.index)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}addFeatures(u,p,S){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,CA)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,kc),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,S,L,U){const Q=this.layers[0].layout,re=Q.get("line-join").evaluate(u,{}),Ae=Q.get("line-cap"),_e=Q.get("line-miter-limit"),Le=Q.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const qe of p)this.addLine(qe,u,re,Ae,_e,Le);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,U,L)}addLine(u,p,S,L,U,Q){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Bt=0;Bt<u.length-1;Bt++)this.totalDistance+=u[Bt].dist(u[Bt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const re=Lm[p.type]==="Polygon";let Ae=u.length;for(;Ae>=2&&u[Ae-1].equals(u[Ae-2]);)Ae--;let _e=0;for(;_e<Ae-1&&u[_e].equals(u[_e+1]);)_e++;if(Ae<(re?3:2))return;S==="bevel"&&(U=1.05);const Le=this.overscaling<=16?15*Pa/(512*this.overscaling):0,qe=this.segments.prepareSegment(10*Ae,this.layoutVertexArray,this.indexArray);let et,At,_t,Mt,Dt;this.e1=this.e2=-1,re&&(et=u[Ae-2],Dt=u[_e].sub(et)._unit()._perp());for(let Bt=_e;Bt<Ae;Bt++){if(_t=Bt===Ae-1?re?u[_e+1]:void 0:u[Bt+1],_t&&u[Bt].equals(_t))continue;Dt&&(Mt=Dt),et&&(At=et),et=u[Bt],Dt=_t?_t.sub(et)._unit()._perp():Mt,Mt=Mt||Dt;let Kt=Mt.add(Dt);Kt.x===0&&Kt.y===0||Kt._unit();const Ht=Mt.x*Dt.x+Mt.y*Dt.y,Zt=Kt.x*Dt.x+Kt.y*Dt.y,ci=Zt!==0?1/Zt:1/0,yi=2*Math.sqrt(2-2*Zt),Xi=Zt<p0&&At&&_t,xn=Mt.x*Dt.y-Mt.y*Dt.x>0;if(Xi&&Bt>_e){const An=et.dist(At);if(An>2*Le){const zn=et.sub(et.sub(At)._mult(Le/An)._round());this.updateDistance(At,zn),this.addCurrentVertex(zn,Mt,0,0,qe),At=zn}}const on=At&&_t;let an=on?S:re?"butt":L;if(on&&an==="round"&&(ci<Q?an="miter":ci<=2&&(an="fakeround")),an==="miter"&&ci>U&&(an="bevel"),an==="bevel"&&(ci>2&&(an="flipbevel"),ci<U&&(an="miter")),At&&this.updateDistance(At,et),an==="miter")Kt._mult(ci),this.addCurrentVertex(et,Kt,0,0,qe);else if(an==="flipbevel"){if(ci>100)Kt=Dt.mult(-1);else{const An=ci*Mt.add(Dt).mag()/Mt.sub(Dt).mag();Kt._perp()._mult(An*(xn?-1:1))}this.addCurrentVertex(et,Kt,0,0,qe),this.addCurrentVertex(et,Kt.mult(-1),0,0,qe)}else if(an==="bevel"||an==="fakeround"){const An=-Math.sqrt(ci*ci-1),zn=xn?An:0,sn=xn?0:An;if(At&&this.addCurrentVertex(et,Mt,zn,sn,qe),an==="fakeround"){const Wi=Math.round(180*yi/Math.PI/20);for(let Dn=1;Dn<Wi;Dn++){let Rn=Dn/Wi;if(Rn!==.5){const Vr=Rn-.5;Rn+=Rn*Vr*(Rn-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*Vr*Vr+(.848013+Ht*(.215638*Ht-1.06021)))}const pr=Dt.sub(Mt)._mult(Rn)._add(Mt)._unit()._mult(xn?-1:1);this.addHalfVertex(et,pr.x,pr.y,!1,xn,0,qe)}}_t&&this.addCurrentVertex(et,Dt,-zn,-sn,qe)}else if(an==="butt")this.addCurrentVertex(et,Kt,0,0,qe);else if(an==="square"){const An=At?1:-1;this.addCurrentVertex(et,Kt,An,An,qe)}else an==="round"&&(At&&(this.addCurrentVertex(et,Mt,0,0,qe),this.addCurrentVertex(et,Mt,1,1,qe,!0)),_t&&(this.addCurrentVertex(et,Dt,-1,-1,qe,!0),this.addCurrentVertex(et,Dt,0,0,qe)));if(Xi&&Bt<Ae-1){const An=et.dist(_t);if(An>2*Le){const zn=et.add(_t.sub(et)._mult(Le/An)._round());this.updateDistance(et,zn),this.addCurrentVertex(zn,Dt,0,0,qe),et=zn}}}}addCurrentVertex(u,p,S,L,U,Q=!1){const re=p.y*L-p.x,Ae=-p.y-p.x*L;this.addHalfVertex(u,p.x+p.y*S,p.y-p.x*S,Q,!1,S,U),this.addHalfVertex(u,re,Ae,Q,!0,-L,U),this.distance>Cp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(u,p,S,L,U,Q))}addHalfVertex({x:u,y:p},S,L,U,Q,re,Ae){const _e=.5*(this.lineClips?this.scaledDistance*(Cp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(U?1:0),(p<<1)+(Q?1:0),Math.round(63*S)+128,Math.round(63*L)+128,1+(re===0?0:re<0?-1:1)|(63&_e)<<2,_e>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Le=Ae.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Le),Ae.primitiveLength++),Q?this.e2=Le:this.e1=Le}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}let TA,m0;Pn("LineBucket",nd,{omit:["layers","patternFeatures"]});var rd={get paint(){return m0=m0||new cs({"line-opacity":new Bi(hi.paint_line["line-opacity"]),"line-color":new Bi(hi.paint_line["line-color"]),"line-translate":new ki(hi.paint_line["line-translate"]),"line-translate-anchor":new ki(hi.paint_line["line-translate-anchor"]),"line-width":new Bi(hi.paint_line["line-width"]),"line-gap-width":new Bi(hi.paint_line["line-gap-width"]),"line-offset":new Bi(hi.paint_line["line-offset"]),"line-blur":new Bi(hi.paint_line["line-blur"]),"line-dasharray":new vu(hi.paint_line["line-dasharray"]),"line-pattern":new xs(hi.paint_line["line-pattern"]),"line-gradient":new Oo(hi.paint_line["line-gradient"])})},get layout(){return TA=TA||new cs({"line-cap":new ki(hi.layout_line["line-cap"]),"line-join":new Bi(hi.layout_line["line-join"]),"line-miter-limit":new ki(hi.layout_line["line-miter-limit"]),"line-round-limit":new ki(hi.layout_line["line-round-limit"]),"line-sort-key":new Bi(hi.layout_line["line-sort-key"])})}};class Bm extends Bi{possiblyEvaluate(u,p){return p=new gn(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),super.possiblyEvaluate(u,p)}evaluate(u,p,S,L){return p=rt({},p,{zoom:Math.floor(p.zoom)}),super.evaluate(u,p,S,L)}}let Ch;class Al extends Ms{constructor(u){super(u,rd),this.gradientVersion=0,Ch||(Ch=new Bm(rd.paint.properties["line-width"].specification),Ch.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const p=this.gradientExpression();this.stepInterpolant=!!function(S){return S._styleExpression!==void 0}(p)&&p._styleExpression.expression instanceof nr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,p){super.recalculate(u,p),this.paint._values["line-floorwidth"]=Ch.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new nd(u)}queryRadius(u){const p=u,S=sd(vh("line-width",this,p),vh("line-gap-width",this,p)),L=vh("line-offset",this,p);return S/2+Math.abs(L)+$c(this.paint.get("line-translate"))}queryIntersectsFeature(u,p,S,L,U,Q,re){const Ae=mA(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,re),_e=re/2*sd(this.paint.get("line-width").evaluate(p,S),this.paint.get("line-gap-width").evaluate(p,S)),Le=this.paint.get("line-offset").evaluate(p,S);return Le&&(L=function(qe,et){const At=[];for(let _t=0;_t<qe.length;_t++){const Mt=qe[_t],Dt=[];for(let Bt=0;Bt<Mt.length;Bt++){const Kt=Mt[Bt-1],Ht=Mt[Bt],Zt=Mt[Bt+1],ci=Bt===0?new ue(0,0):Ht.sub(Kt)._unit()._perp(),yi=Bt===Mt.length-1?new ue(0,0):Zt.sub(Ht)._unit()._perp(),Xi=ci._add(yi)._unit(),xn=Xi.x*yi.x+Xi.y*yi.y;xn!==0&&Xi._mult(1/xn),Dt.push(Xi._mult(et)._add(Ht))}At.push(Dt)}return At}(L,Le*re)),function(qe,et,At){for(let _t=0;_t<et.length;_t++){const Mt=et[_t];if(qe.length>=3){for(let Dt=0;Dt<Mt.length;Dt++)if(Xu(qe,Mt[Dt]))return!0}if(of(qe,Mt,At))return!0}return!1}(Ae,L,_e)}isTileClipped(){return!0}}function sd(f,u){return u>0?u+2*f:f}const ad=R([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),od=R([{name:"a_projected_pos",components:3,type:"Float32"}],4);R([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const fa=R([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);R([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const kA=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ld=R([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function MA(f,u,p){return f.sections.forEach(S=>{S.text=function(L,U,Q){const re=U.layout.get("text-transform").evaluate(Q,{});return re==="uppercase"?L=L.toLocaleUpperCase():re==="lowercase"&&(L=L.toLocaleLowerCase()),ds.applyArabicShaping&&(L=ds.applyArabicShaping(L)),L}(S.text,u,p)}),f}R([{name:"triangle",components:3,type:"Uint16"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),R([{type:"Float32",name:"offsetX"}]),R([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),R([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const wu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Ya=24,g0=ms,If=function(f,u,p,S,L){var U,Q,re=8*L-S-1,Ae=(1<<re)-1,_e=Ae>>1,Le=-7,qe=p?L-1:0,et=p?-1:1,At=f[u+qe];for(qe+=et,U=At&(1<<-Le)-1,At>>=-Le,Le+=re;Le>0;U=256*U+f[u+qe],qe+=et,Le-=8);for(Q=U&(1<<-Le)-1,U>>=-Le,Le+=S;Le>0;Q=256*Q+f[u+qe],qe+=et,Le-=8);if(U===0)U=1-_e;else{if(U===Ae)return Q?NaN:1/0*(At?-1:1);Q+=Math.pow(2,S),U-=_e}return(At?-1:1)*Q*Math.pow(2,U-S)},ud=function(f,u,p,S,L,U){var Q,re,Ae,_e=8*U-L-1,Le=(1<<_e)-1,qe=Le>>1,et=L===23?Math.pow(2,-24)-Math.pow(2,-77):0,At=S?0:U-1,_t=S?1:-1,Mt=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(re=isNaN(u)?1:0,Q=Le):(Q=Math.floor(Math.log(u)/Math.LN2),u*(Ae=Math.pow(2,-Q))<1&&(Q--,Ae*=2),(u+=Q+qe>=1?et/Ae:et*Math.pow(2,1-qe))*Ae>=2&&(Q++,Ae/=2),Q+qe>=Le?(re=0,Q=Le):Q+qe>=1?(re=(u*Ae-1)*Math.pow(2,L),Q+=qe):(re=u*Math.pow(2,qe-1)*Math.pow(2,L),Q=0));L>=8;f[p+At]=255&re,At+=_t,re/=256,L-=8);for(Q=Q<<L|re,_e+=L;_e>0;f[p+At]=255&Q,At+=_t,Q/=256,_e-=8);f[p+At-_t]|=128*Mt};function ms(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}ms.Varint=0,ms.Fixed64=1,ms.Bytes=2,ms.Fixed32=5;var th=4294967296,Tp=1/th,cd=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ih(f){return f.type===ms.Bytes?f.readVarint()+f.pos:f.pos+1}function PA(f,u,p){return p?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function kp(f,u,p){var S=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));p.realloc(S);for(var L=p.pos-1;L>=f;L--)p.buf[L+S]=p.buf[L]}function _0(f,u){for(var p=0;p<f.length;p++)u.writeVarint(f[p])}function DA(f,u){for(var p=0;p<f.length;p++)u.writeSVarint(f[p])}function Mp(f,u){for(var p=0;p<f.length;p++)u.writeFloat(f[p])}function hd(f,u){for(var p=0;p<f.length;p++)u.writeDouble(f[p])}function Ad(f,u){for(var p=0;p<f.length;p++)u.writeBoolean(f[p])}function zm(f,u){for(var p=0;p<f.length;p++)u.writeFixed32(f[p])}function Rm(f,u){for(var p=0;p<f.length;p++)u.writeSFixed32(f[p])}function Fm(f,u){for(var p=0;p<f.length;p++)u.writeFixed64(f[p])}function fd(f,u){for(var p=0;p<f.length;p++)u.writeSFixed64(f[p])}function LA(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function fl(f,u,p){f[p]=u,f[p+1]=u>>>8,f[p+2]=u>>>16,f[p+3]=u>>>24}function y0(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}ms.prototype={destroy:function(){this.buf=null},readFields:function(f,u,p){for(p=p||this.length;this.pos<p;){var S=this.readVarint(),L=S>>3,U=this.pos;this.type=7&S,f(L,u,this),this.pos===U&&this.skip(S)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=LA(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=y0(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=LA(this.buf,this.pos)+LA(this.buf,this.pos+4)*th;return this.pos+=8,f},readSFixed64:function(){var f=LA(this.buf,this.pos)+y0(this.buf,this.pos+4)*th;return this.pos+=8,f},readFloat:function(){var f=If(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=If(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,p,S=this.buf;return u=127&(p=S[this.pos++]),p<128?u:(u|=(127&(p=S[this.pos++]))<<7,p<128?u:(u|=(127&(p=S[this.pos++]))<<14,p<128?u:(u|=(127&(p=S[this.pos++]))<<21,p<128?u:function(L,U,Q){var re,Ae,_e=Q.buf;if(re=(112&(Ae=_e[Q.pos++]))>>4,Ae<128||(re|=(127&(Ae=_e[Q.pos++]))<<3,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<10,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<17,Ae<128)||(re|=(127&(Ae=_e[Q.pos++]))<<24,Ae<128)||(re|=(1&(Ae=_e[Q.pos++]))<<31,Ae<128))return PA(L,re,U);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(p=S[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&cd?function(p,S,L){return cd.decode(p.subarray(S,L))}(this.buf,u,f):function(p,S,L){for(var U="",Q=S;Q<L;){var re,Ae,_e,Le=p[Q],qe=null,et=Le>239?4:Le>223?3:Le>191?2:1;if(Q+et>L)break;et===1?Le<128&&(qe=Le):et===2?(192&(re=p[Q+1]))==128&&(qe=(31&Le)<<6|63&re)<=127&&(qe=null):et===3?(Ae=p[Q+2],(192&(re=p[Q+1]))==128&&(192&Ae)==128&&((qe=(15&Le)<<12|(63&re)<<6|63&Ae)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):et===4&&(Ae=p[Q+2],_e=p[Q+3],(192&(re=p[Q+1]))==128&&(192&Ae)==128&&(192&_e)==128&&((qe=(15&Le)<<18|(63&re)<<12|(63&Ae)<<6|63&_e)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,et=1):qe>65535&&(qe-=65536,U+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),U+=String.fromCharCode(qe),Q+=et}return U}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==ms.Bytes)return f.push(this.readVarint(u));var p=ih(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==ms.Bytes)return f.push(this.readSVarint());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==ms.Bytes)return f.push(this.readBoolean());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==ms.Bytes)return f.push(this.readFloat());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==ms.Bytes)return f.push(this.readDouble());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==ms.Bytes)return f.push(this.readFixed32());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==ms.Bytes)return f.push(this.readSFixed32());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==ms.Bytes)return f.push(this.readFixed64());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==ms.Bytes)return f.push(this.readSFixed64());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===ms.Varint)for(;this.buf[this.pos++]>127;);else if(u===ms.Bytes)this.pos=this.readVarint()+this.pos;else if(u===ms.Fixed32)this.pos+=4;else{if(u!==ms.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),fl(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),fl(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),fl(this.buf,-1&f,this.pos),fl(this.buf,Math.floor(f*Tp),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),fl(this.buf,-1&f,this.pos),fl(this.buf,Math.floor(f*Tp),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,p){var S,L;if(u>=0?(S=u%4294967296|0,L=u/4294967296|0):(L=~(-u/4294967296),4294967295^(S=~(-u%4294967296))?S=S+1|0:(S=0,L=L+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(U,Q,re){re.buf[re.pos++]=127&U|128,U>>>=7,re.buf[re.pos++]=127&U|128,U>>>=7,re.buf[re.pos++]=127&U|128,U>>>=7,re.buf[re.pos++]=127&U|128,re.buf[re.pos]=127&(U>>>=7)}(S,0,p),function(U,Q){var re=(7&U)<<4;Q.buf[Q.pos++]|=re|((U>>>=3)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U|((U>>>=7)?128:0),U&&(Q.buf[Q.pos++]=127&U)))))}(L,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(S,L,U){for(var Q,re,Ae=0;Ae<L.length;Ae++){if((Q=L.charCodeAt(Ae))>55295&&Q<57344){if(!re){Q>56319||Ae+1===L.length?(S[U++]=239,S[U++]=191,S[U++]=189):re=Q;continue}if(Q<56320){S[U++]=239,S[U++]=191,S[U++]=189,re=Q;continue}Q=re-55296<<10|Q-56320|65536,re=null}else re&&(S[U++]=239,S[U++]=191,S[U++]=189,re=null);Q<128?S[U++]=Q:(Q<2048?S[U++]=Q>>6|192:(Q<65536?S[U++]=Q>>12|224:(S[U++]=Q>>18|240,S[U++]=Q>>12&63|128),S[U++]=Q>>6&63|128),S[U++]=63&Q|128)}return U}(this.buf,f,this.pos);var p=this.pos-u;p>=128&&kp(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),ud(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),ud(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var p=0;p<u;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,u){this.pos++;var p=this.pos;f(u,this);var S=this.pos-p;S>=128&&kp(p,S,this),this.pos=p-1,this.writeVarint(S),this.pos+=S},writeMessage:function(f,u,p){this.writeTag(f,ms.Bytes),this.writeRawMessage(u,p)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,_0,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,DA,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,Ad,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,Mp,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,hd,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,zm,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,Rm,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,Fm,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,fd,u)},writeBytesField:function(f,u){this.writeTag(f,ms.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,ms.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,ms.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,ms.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,ms.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,ms.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,ms.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,ms.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,ms.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,ms.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};var v0=W(g0);const Mc=3;function BA(f,u,p){f===1&&p.readMessage(Ef,u)}function Ef(f,u,p){if(f===3){const{id:S,bitmap:L,width:U,height:Q,left:re,top:Ae,advance:_e}=p.readMessage(zA,{});u.push({id:S,bitmap:new xh({width:U+2*Mc,height:Q+2*Mc},L),metrics:{width:U,height:Q,left:re,top:Ae,advance:_e}})}}function zA(f,u,p){f===1?u.id=p.readVarint():f===2?u.bitmap=p.readBytes():f===3?u.width=p.readVarint():f===4?u.height=p.readVarint():f===5?u.left=p.readSVarint():f===6?u.top=p.readSVarint():f===7&&(u.advance=p.readVarint())}const Cf=Mc;function Tf(f){let u=0,p=0;for(const Q of f)u+=Q.w*Q.h,p=Math.max(p,Q.w);f.sort((Q,re)=>re.h-Q.h);const S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let L=0,U=0;for(const Q of f)for(let re=S.length-1;re>=0;re--){const Ae=S[re];if(!(Q.w>Ae.w||Q.h>Ae.h)){if(Q.x=Ae.x,Q.y=Ae.y,U=Math.max(U,Q.y+Q.h),L=Math.max(L,Q.x+Q.w),Q.w===Ae.w&&Q.h===Ae.h){const _e=S.pop();re<S.length&&(S[re]=_e)}else Q.h===Ae.h?(Ae.x+=Q.w,Ae.w-=Q.w):Q.w===Ae.w?(Ae.y+=Q.h,Ae.h-=Q.h):(S.push({x:Ae.x+Q.w,y:Ae.y,w:Ae.w-Q.w,h:Q.h}),Ae.y+=Q.h,Ae.h-=Q.h);break}}return{w:L,h:U,fill:u/(L*U)||0}}const Su=1;class x0{constructor(u,{pixelRatio:p,version:S,stretchX:L,stretchY:U,content:Q}){this.paddedRect=u,this.pixelRatio=p,this.stretchX=L,this.stretchY=U,this.content=Q,this.version=S}get tl(){return[this.paddedRect.x+Su,this.paddedRect.y+Su]}get br(){return[this.paddedRect.x+this.paddedRect.w-Su,this.paddedRect.y+this.paddedRect.h-Su]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Su)/this.pixelRatio,(this.paddedRect.h-2*Su)/this.pixelRatio]}}class ku{constructor(u,p){const S={},L={};this.haveRenderCallbacks=[];const U=[];this.addImages(u,S,U),this.addImages(p,L,U);const{w:Q,h:re}=Tf(U),Ae=new Ll({width:Q||1,height:re||1});for(const _e in u){const Le=u[_e],qe=S[_e].paddedRect;Ll.copy(Le.data,Ae,{x:0,y:0},{x:qe.x+Su,y:qe.y+Su},Le.data)}for(const _e in p){const Le=p[_e],qe=L[_e].paddedRect,et=qe.x+Su,At=qe.y+Su,_t=Le.data.width,Mt=Le.data.height;Ll.copy(Le.data,Ae,{x:0,y:0},{x:et,y:At},Le.data),Ll.copy(Le.data,Ae,{x:0,y:Mt-1},{x:et,y:At-1},{width:_t,height:1}),Ll.copy(Le.data,Ae,{x:0,y:0},{x:et,y:At+Mt},{width:_t,height:1}),Ll.copy(Le.data,Ae,{x:_t-1,y:0},{x:et-1,y:At},{width:1,height:Mt}),Ll.copy(Le.data,Ae,{x:0,y:0},{x:et+_t,y:At},{width:1,height:Mt})}this.image=Ae,this.iconPositions=S,this.patternPositions=L}addImages(u,p,S){for(const L in u){const U=u[L],Q={x:0,y:0,w:U.data.width+2*Su,h:U.data.height+2*Su};S.push(Q),p[L]=new x0(Q,U),U.hasRenderCallback&&this.haveRenderCallbacks.push(L)}}patchUpdatedImages(u,p){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const S in u.updatedImages)this.patchUpdatedImage(this.iconPositions[S],u.getImage(S),p),this.patchUpdatedImage(this.patternPositions[S],u.getImage(S),p)}patchUpdatedImage(u,p,S){if(!u||!p||u.version===p.version)return;u.version=p.version;const[L,U]=u.tl;S.update(p.data,void 0,{x:L,y:U})}}var Th;Pn("ImagePosition",x0),Pn("ImageAtlas",ku),a.ai=void 0,(Th=a.ai||(a.ai={}))[Th.none=0]="none",Th[Th.horizontal=1]="horizontal",Th[Th.vertical=2]="vertical",Th[Th.horizontalOnly=3]="horizontalOnly";const RA=-17;class FA{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const S=new FA;return S.scale=u||1,S.fontStack=p,S}static forImage(u){const p=new FA;return p.imageName=u,p}}class nh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const S=new nh;for(let L=0;L<u.sections.length;L++){const U=u.sections[L];U.image?S.addImageSection(U):S.addTextSection(U,p)}return S}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let p="";for(let S=0;S<u.length;S++){const L=u.charCodeAt(S+1)||null,U=u.charCodeAt(S-1)||null;p+=L&&Fu(L)&&!wu[u[S+1]]||U&&Fu(U)&&!wu[u[S-1]]||!wu[u[S]]?u[S]:wu[u[S]]}return p}(this.text)}trim(){let u=0;for(let S=0;S<this.text.length&&b0[this.text.charCodeAt(S)];S++)u++;let p=this.text.length;for(let S=this.text.length-1;S>=0&&S>=u&&b0[this.text.charCodeAt(S)];S--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const S=new nh;return S.text=this.text.substring(u,p),S.sectionIndex=this.sectionIndex.slice(u,p),S.sections=this.sections,S}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(FA.forText(u.scale,u.fontStack||p));const S=this.sections.length-1;for(let L=0;L<u.text.length;++L)this.sectionIndex.push(S)}addImageSection(u){const p=u.image?u.image.name:"";if(p.length===0)return void $e("Can't add FormattedSection with an empty image.");const S=this.getNextImageSectionCharCode();S?(this.text+=String.fromCharCode(S),this.sections.push(FA.forImage(p)),this.sectionIndex.push(this.sections.length-1)):$e("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function OA(f,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt){const Dt=nh.fromFeature(f,L);let Bt;qe===a.ai.vertical&&Dt.verticalizePunctuation();const{processBidirectionalText:Kt,processStyledBidirectionalText:Ht}=ds;if(Kt&&Dt.sections.length===1){Bt=[];const yi=Kt(Dt.toString(),kf(Dt,_e,U,u,S,At,_t));for(const Xi of yi){const xn=new nh;xn.text=Xi,xn.sections=Dt.sections;for(let on=0;on<Xi.length;on++)xn.sectionIndex.push(0);Bt.push(xn)}}else if(Ht){Bt=[];const yi=Ht(Dt.text,Dt.sectionIndex,kf(Dt,_e,U,u,S,At,_t));for(const Xi of yi){const xn=new nh;xn.text=Xi[0],xn.sectionIndex=Xi[1],xn.sections=Dt.sections,Bt.push(xn)}}else Bt=function(yi,Xi){const xn=[],on=yi.text;let an=0;for(const An of Xi)xn.push(yi.substring(an,An)),an=An;return an<on.length&&xn.push(yi.substring(an,on.length)),xn}(Dt,kf(Dt,_e,U,u,S,At,_t));const Zt=[],ci={positionedLines:Zt,text:Dt.toString(),top:Le[1],bottom:Le[1],left:Le[0],right:Le[0],writingMode:qe,iconsInText:!1,verticalizable:!1};return function(yi,Xi,xn,on,an,An,zn,sn,Wi,Dn,Rn,pr){let Vr=0,Hr=RA,zs=0,Ea=0;const ia=sn==="right"?1:sn==="left"?0:.5;let ns=0;for(const Ps of an){Ps.trim();const Kn=Ps.getMaxScale(),La=(Kn-1)*Ya,$a={positionedGlyphs:[],lineOffset:0};yi.positionedLines[ns]=$a;const va=$a.positionedGlyphs;let Uo=0;if(!Ps.length()){Hr+=An,++ns;continue}for(let ra=0;ra<Ps.length();ra++){const br=Ps.getSection(ra),vo=Ps.getSectionIndex(ra),nl=Ps.getCharCode(ra);let rl=0,Pu=null,Uu=null,zl=null,zc=Ya;const Gu=!(Wi===a.ai.horizontal||!Rn&&!uu(nl)||Rn&&(b0[nl]||(Wn=nl,En.Arabic(Wn)||En["Arabic Supplement"](Wn)||En["Arabic Extended-A"](Wn)||En["Arabic Presentation Forms-A"](Wn)||En["Arabic Presentation Forms-B"](Wn))));if(br.imageName){const qu=on[br.imageName];if(!qu)continue;zl=br.imageName,yi.iconsInText=yi.iconsInText||!0,Uu=qu.paddedRect;const Xl=qu.displaySize;br.scale=br.scale*Ya/pr,Pu={width:Xl[0],height:Xl[1],left:Su,top:-Cf,advance:Gu?Xl[1]:Xl[0]},rl=La+(Ya-Xl[1]*br.scale),zc=Pu.advance;const uh=Gu?Xl[0]*br.scale-Ya*Kn:Xl[1]*br.scale-Ya*Kn;uh>0&&uh>Uo&&(Uo=uh)}else{const qu=xn[br.fontStack],Xl=qu&&qu[nl];if(Xl&&Xl.rect)Uu=Xl.rect,Pu=Xl.metrics;else{const uh=Xi[br.fontStack],sA=uh&&uh[nl];if(!sA)continue;Pu=sA.metrics}rl=(Kn-br.scale)*Ya}Gu?(yi.verticalizable=!0,va.push({glyph:nl,imageName:zl,x:Vr,y:Hr+rl,vertical:Gu,scale:br.scale,fontStack:br.fontStack,sectionIndex:vo,metrics:Pu,rect:Uu}),Vr+=zc*br.scale+Dn):(va.push({glyph:nl,imageName:zl,x:Vr,y:Hr+rl,vertical:Gu,scale:br.scale,fontStack:br.fontStack,sectionIndex:vo,metrics:Pu,rect:Uu}),Vr+=Pu.advance*br.scale+Dn)}va.length!==0&&(zs=Math.max(Vr-Dn,zs),Nm(va,0,va.length-1,ia,Uo)),Vr=0;const oo=An*Kn+Uo;$a.lineOffset=Math.max(Uo,La),Hr+=oo,Ea=Math.max(oo,Ea),++ns}var Wn;const ws=Hr-RA,{horizontalAlign:ir,verticalAlign:na}=md(zn);(function(Ps,Kn,La,$a,va,Uo,oo,ra,br){const vo=(Kn-La)*va;let nl=0;nl=Uo!==oo?-ra*$a-RA:(-$a*br+.5)*oo;for(const rl of Ps)for(const Pu of rl.positionedGlyphs)Pu.x+=vo,Pu.y+=nl})(yi.positionedLines,ia,ir,na,zs,Ea,An,ws,an.length),yi.top+=-na*ws,yi.bottom=yi.top+ws,yi.left+=-ir*zs,yi.right=yi.left+zs}(ci,u,p,S,Bt,Q,re,Ae,qe,_e,et,Mt),!function(yi){for(const Xi of yi)if(Xi.positionedGlyphs.length!==0)return!1;return!0}(Zt)&&ci}const b0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Om={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function dd(f,u,p,S,L,U){if(u.imageName){const Q=S[u.imageName];return Q?Q.displaySize[0]*u.scale*Ya/U+L:0}{const Q=p[u.fontStack],re=Q&&Q[f];return re?re.metrics.advance*u.scale+L:0}}function kh(f,u,p,S){const L=Math.pow(f-u,2);return S?f<u?L/2:2*L:L+Math.abs(p)*p}function Pc(f,u,p){let S=0;return f===10&&(S-=1e4),p&&(S+=150),f!==40&&f!==65288||(S+=50),u!==41&&u!==65289||(S+=50),S}function rh(f,u,p,S,L,U){let Q=null,re=kh(u,p,L,U);for(const Ae of S){const _e=kh(u-Ae.x,p,L,U)+Ae.badness;_e<=re&&(Q=Ae,re=_e)}return{index:f,x:u,priorBreak:Q,badness:re}}function pd(f){return f?pd(f.priorBreak).concat(f.index):[]}function kf(f,u,p,S,L,U,Q){if(U!=="point")return[];if(!f)return[];const re=[],Ae=function(et,At,_t,Mt,Dt,Bt){let Kt=0;for(let Ht=0;Ht<et.length();Ht++){const Zt=et.getSection(Ht);Kt+=dd(et.getCharCode(Ht),Zt,Mt,Dt,At,Bt)}return Kt/Math.max(1,Math.ceil(Kt/_t))}(f,u,p,S,L,Q),_e=f.text.indexOf("​")>=0;let Le=0;for(let et=0;et<f.length();et++){const At=f.getSection(et),_t=f.getCharCode(et);if(b0[_t]||(Le+=dd(_t,At,S,L,u,Q)),et<f.length()-1){const Mt=!((qe=_t)<11904||!(En["Bopomofo Extended"](qe)||En.Bopomofo(qe)||En["CJK Compatibility Forms"](qe)||En["CJK Compatibility Ideographs"](qe)||En["CJK Compatibility"](qe)||En["CJK Radicals Supplement"](qe)||En["CJK Strokes"](qe)||En["CJK Symbols and Punctuation"](qe)||En["CJK Unified Ideographs Extension A"](qe)||En["CJK Unified Ideographs"](qe)||En["Enclosed CJK Letters and Months"](qe)||En["Halfwidth and Fullwidth Forms"](qe)||En.Hiragana(qe)||En["Ideographic Description Characters"](qe)||En["Kangxi Radicals"](qe)||En["Katakana Phonetic Extensions"](qe)||En.Katakana(qe)||En["Vertical Forms"](qe)||En["Yi Radicals"](qe)||En["Yi Syllables"](qe)));(Om[_t]||Mt||At.imageName)&&re.push(rh(et+1,Le,Ae,re,Pc(_t,f.getCharCode(et+1),Mt&&_e),!1))}}var qe;return pd(rh(f.length(),Le,Ae,re,0,!0))}function md(f){let u=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function Nm(f,u,p,S,L){if(!S&&!L)return;const U=f[p],Q=(f[p].x+U.metrics.advance*U.scale)*S;for(let re=u;re<=p;re++)f[re].x-=Q,f[re].y+=L}function w0(f,u,p){const{horizontalAlign:S,verticalAlign:L}=md(p),U=u[0]-f.displaySize[0]*S,Q=u[1]-f.displaySize[1]*L;return{image:f,top:Q,bottom:Q+f.displaySize[1],left:U,right:U+f.displaySize[0]}}function S0(f,u,p,S,L,U){const Q=f.image;let re;if(Q.content){const Dt=Q.content,Bt=Q.pixelRatio||1;re=[Dt[0]/Bt,Dt[1]/Bt,Q.displaySize[0]-Dt[2]/Bt,Q.displaySize[1]-Dt[3]/Bt]}const Ae=u.left*U,_e=u.right*U;let Le,qe,et,At;p==="width"||p==="both"?(At=L[0]+Ae-S[3],qe=L[0]+_e+S[1]):(At=L[0]+(Ae+_e-Q.displaySize[0])/2,qe=At+Q.displaySize[0]);const _t=u.top*U,Mt=u.bottom*U;return p==="height"||p==="both"?(Le=L[1]+_t-S[0],et=L[1]+Mt+S[2]):(Le=L[1]+(_t+Mt-Q.displaySize[1])/2,et=Le+Q.displaySize[1]),{image:Q,top:Le,right:qe,bottom:et,left:At,collisionPadding:re}}const Mf=255,Yu=128,Dc=Mf*Yu;function tA(f,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new gn(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:S,interpolationType:L}=p;let U=0;for(;U<S.length&&S[U]<=f;)U++;U=Math.max(0,U-1);let Q=U;for(;Q<S.length&&S[Q]<f+1;)Q++;Q=Math.min(S.length-1,Q);const re=S[U],Ae=S[Q];return p.kind==="composite"?{kind:"composite",minZoom:re,maxZoom:Ae,interpolationType:L}:{kind:"camera",minZoom:re,maxZoom:Ae,minSize:p.evaluate(new gn(re)),maxSize:p.evaluate(new gn(Ae)),interpolationType:L}}}function I0(f,u,p){let S="never";const L=f.get(u);return L?S=L:f.get(p)&&(S="always"),S}const Pp=Ih.VectorTileFeature.types,gd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Pf(f,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et){const At=re?Math.min(Dc,Math.round(re[0])):0,_t=re?Math.min(Dc,Math.round(re[1])):0;f.emplaceBack(u,p,Math.round(32*S),Math.round(32*L),U,Q,(At<<1)+(Ae?1:0),_t,16*_e,16*Le,256*qe,256*et)}function NA(f,u,p){f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p)}function Dp(f){for(const u of f.sections)if(ta(u.text))return!0;return!1}class _d{constructor(u){this.layoutVertexArray=new Qi,this.indexArray=new Bn,this.programConfigurations=u,this.segments=new er,this.dynamicLayoutVertexArray=new Ei,this.opacityVertexArray=new Ui,this.hasVisibleVertices=!1,this.placedSymbolArray=new ce}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,p,S,L){this.isEmpty()||(S&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,ad.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,od.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,gd,!0),this.opacityVertexBuffer.itemSize=1),(S||L)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pn("SymbolBuffers",_d);class yd{constructor(u,p,S){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new S,this.segments=new er,this.collisionVertexArray=new ln}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,fa.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pn("CollisionBuffers",yd);class sh{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(Q=>Q.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jh([]),this.placementViewportMatrix=jh([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tA(this.zoom,p["text-size"]),this.iconSizeData=tA(this.zoom,p["icon-size"]);const S=this.layers[0].layout,L=S.get("symbol-sort-key"),U=S.get("symbol-z-order");this.canOverlap=I0(S,"text-overlap","text-allow-overlap")!=="never"||I0(S,"icon-overlap","icon-allow-overlap")!=="never"||S.get("text-ignore-placement")||S.get("icon-ignore-placement"),this.sortFeaturesByKey=U!=="viewport-y"&&!L.isConstant(),this.sortFeaturesByY=(U==="viewport-y"||U==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,S.get("symbol-placement")==="point"&&(this.writingModes=S.get("text-writing-mode").map(Q=>a.ai[Q])),this.stateDependentLayerIds=this.layers.filter(Q=>Q.isStateDependent()).map(Q=>Q.id),this.sourceID=u.sourceID}createArrays(){this.text=new _d(new Au(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new _d(new Au(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new Re,this.lineVertexArray=new Be,this.symbolInstances=new Te,this.textAnchorOffsets=new xt}calculateGlyphDependencies(u,p,S,L,U){for(let Q=0;Q<u.length;Q++)if(p[u.charCodeAt(Q)]=!0,(S||L)&&U){const re=wu[u.charAt(Q)];re&&(p[re.charCodeAt(0)]=!0)}}populate(u,p,S){const L=this.layers[0],U=L.layout,Q=U.get("text-font"),re=U.get("text-field"),Ae=U.get("icon-image"),_e=(re.value.kind!=="constant"||re.value.value instanceof Qt&&!re.value.value.isEmpty()||re.value.value.toString().length>0)&&(Q.value.kind!=="constant"||Q.value.value.length>0),Le=Ae.value.kind!=="constant"||!!Ae.value.value||Object.keys(Ae.parameters).length>0,qe=U.get("symbol-sort-key");if(this.features=[],!_e&&!Le)return;const et=p.iconDependencies,At=p.glyphDependencies,_t=p.availableImages,Mt=new gn(this.zoom);for(const{feature:Dt,id:Bt,index:Kt,sourceLayerIndex:Ht}of u){const Zt=L._featureFilter.needGeometry,ci=Ic(Dt,Zt);if(!L._featureFilter.filter(Mt,ci,S))continue;let yi,Xi;if(Zt||(ci.geometry=Uh(Dt)),_e){const on=L.getValueAndResolveTokens("text-field",ci,S,_t),an=Qt.factory(on);Dp(an)&&(this.hasRTLText=!0),(!this.hasRTLText||Nu()==="unavailable"||this.hasRTLText&&ds.isParsed())&&(yi=MA(an,L,ci))}if(Le){const on=L.getValueAndResolveTokens("icon-image",ci,S,_t);Xi=on instanceof cr?on:cr.fromString(on)}if(!yi&&!Xi)continue;const xn=this.sortFeaturesByKey?qe.evaluate(ci,{},S):void 0;if(this.features.push({id:Bt,text:yi,icon:Xi,index:Kt,sourceLayerIndex:Ht,geometry:ci.geometry,properties:Dt.properties,type:Pp[Dt.type],sortKey:xn}),Xi&&(et[Xi.name]=!0),yi){const on=Q.evaluate(ci,{},S).join(","),an=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ai.vertical)>=0;for(const An of yi.sections)if(An.image)et[An.image.name]=!0;else{const zn=Hl(yi.toString()),sn=An.fontStack||on,Wi=At[sn]=At[sn]||{};this.calculateGlyphDependencies(An.text,Wi,an,this.allowVerticalPlacement,zn)}}}U.get("symbol-placement")==="line"&&(this.features=function(Dt){const Bt={},Kt={},Ht=[];let Zt=0;function ci(on){Ht.push(Dt[on]),Zt++}function yi(on,an,An){const zn=Kt[on];return delete Kt[on],Kt[an]=zn,Ht[zn].geometry[0].pop(),Ht[zn].geometry[0]=Ht[zn].geometry[0].concat(An[0]),zn}function Xi(on,an,An){const zn=Bt[an];return delete Bt[an],Bt[on]=zn,Ht[zn].geometry[0].shift(),Ht[zn].geometry[0]=An[0].concat(Ht[zn].geometry[0]),zn}function xn(on,an,An){const zn=An?an[0][an[0].length-1]:an[0][0];return`${on}:${zn.x}:${zn.y}`}for(let on=0;on<Dt.length;on++){const an=Dt[on],An=an.geometry,zn=an.text?an.text.toString():null;if(!zn){ci(on);continue}const sn=xn(zn,An),Wi=xn(zn,An,!0);if(sn in Kt&&Wi in Bt&&Kt[sn]!==Bt[Wi]){const Dn=Xi(sn,Wi,An),Rn=yi(sn,Wi,Ht[Dn].geometry);delete Bt[sn],delete Kt[Wi],Kt[xn(zn,Ht[Rn].geometry,!0)]=Rn,Ht[Dn].geometry=null}else sn in Kt?yi(sn,Wi,An):Wi in Bt?Xi(sn,Wi,An):(ci(on),Bt[sn]=Zt-1,Kt[Wi]=Zt-1)}return Ht.filter(on=>on.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Dt,Bt)=>Dt.sortKey-Bt.sortKey)}update(u,p,S){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,p,this.layers,S),this.icon.programConfigurations.updatePaintArrays(u,p,this.layers,S))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const S=this.lineVertexArray.length;if(u.segment!==void 0){let L=u.dist(p[u.segment+1]),U=u.dist(p[u.segment]);const Q={};for(let re=u.segment+1;re<p.length;re++)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:L},re<p.length-1&&(L+=p[re+1].dist(p[re]));for(let re=u.segment||0;re>=0;re--)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:U},re>0&&(U+=p[re-1].dist(p[re]));for(let re=0;re<p.length;re++){const Ae=Q[re];this.lineVertexArray.emplaceBack(Ae.x,Ae.y,Ae.tileUnitDistanceFromAnchor)}}return{lineStartIndex:S,lineLength:this.lineVertexArray.length-S}}addSymbols(u,p,S,L,U,Q,re,Ae,_e,Le,qe,et){const At=u.indexArray,_t=u.layoutVertexArray,Mt=u.segments.prepareSegment(4*p.length,_t,At,this.canOverlap?Q.sortKey:void 0),Dt=this.glyphOffsetArray.length,Bt=Mt.vertexLength,Kt=this.allowVerticalPlacement&&re===a.ai.vertical?Math.PI/2:0,Ht=Q.text&&Q.text.sections;for(let Zt=0;Zt<p.length;Zt++){const{tl:ci,tr:yi,bl:Xi,br:xn,tex:on,pixelOffsetTL:an,pixelOffsetBR:An,minFontScaleX:zn,minFontScaleY:sn,glyphOffset:Wi,isSDF:Dn,sectionIndex:Rn}=p[Zt],pr=Mt.vertexLength,Vr=Wi[1];Pf(_t,Ae.x,Ae.y,ci.x,Vr+ci.y,on.x,on.y,S,Dn,an.x,an.y,zn,sn),Pf(_t,Ae.x,Ae.y,yi.x,Vr+yi.y,on.x+on.w,on.y,S,Dn,An.x,an.y,zn,sn),Pf(_t,Ae.x,Ae.y,Xi.x,Vr+Xi.y,on.x,on.y+on.h,S,Dn,an.x,An.y,zn,sn),Pf(_t,Ae.x,Ae.y,xn.x,Vr+xn.y,on.x+on.w,on.y+on.h,S,Dn,An.x,An.y,zn,sn),NA(u.dynamicLayoutVertexArray,Ae,Kt),At.emplaceBack(pr,pr+1,pr+2),At.emplaceBack(pr+1,pr+2,pr+3),Mt.vertexLength+=4,Mt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Wi[0]),Zt!==p.length-1&&Rn===p[Zt+1].sectionIndex||u.programConfigurations.populatePaintArrays(_t.length,Q,Q.index,{},et,Ht&&Ht[Rn])}u.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Dt,this.glyphOffsetArray.length-Dt,Bt,_e,Le,Ae.segment,S?S[0]:0,S?S[1]:0,L[0],L[1],re,0,!1,0,qe)}_addCollisionDebugVertex(u,p,S,L,U,Q){return p.emplaceBack(0,0),u.emplaceBack(S.x,S.y,L,U,Math.round(Q.x),Math.round(Q.y))}addCollisionDebugVertices(u,p,S,L,U,Q,re){const Ae=U.segments.prepareSegment(4,U.layoutVertexArray,U.indexArray),_e=Ae.vertexLength,Le=U.layoutVertexArray,qe=U.collisionVertexArray,et=re.anchorX,At=re.anchorY;this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(u,p)),this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(S,p)),this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(S,L)),this._addCollisionDebugVertex(Le,qe,Q,et,At,new ue(u,L)),Ae.vertexLength+=4;const _t=U.indexArray;_t.emplaceBack(_e,_e+1),_t.emplaceBack(_e+1,_e+2),_t.emplaceBack(_e+2,_e+3),_t.emplaceBack(_e+3,_e),Ae.primitiveLength+=4}addDebugCollisionBoxes(u,p,S,L){for(let U=u;U<p;U++){const Q=this.collisionBoxArray.get(U);this.addCollisionDebugVertices(Q.x1,Q.y1,Q.x2,Q.y2,L?this.textCollisionBox:this.iconCollisionBox,Q.anchorPoint,S)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yd(Gi,kA.members,rn),this.iconCollisionBox=new yd(Gi,kA.members,rn);for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(u,p,S,L,U,Q,re,Ae,_e){const Le={};for(let qe=p;qe<S;qe++){const et=u.get(qe);Le.textBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.textFeatureIndex=et.featureIndex;break}for(let qe=L;qe<U;qe++){const et=u.get(qe);Le.verticalTextBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.verticalTextFeatureIndex=et.featureIndex;break}for(let qe=Q;qe<re;qe++){const et=u.get(qe);Le.iconBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.iconFeatureIndex=et.featureIndex;break}for(let qe=Ae;qe<_e;qe++){const et=u.get(qe);Le.verticalIconBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},Le.verticalIconFeatureIndex=et.featureIndex;break}return Le}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const S=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,S.textBoxStartIndex,S.textBoxEndIndex,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S.iconBoxStartIndex,S.iconBoxEndIndex,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,p){const S=u.placedSymbolArray.get(p),L=S.vertexStartIndex+4*S.numGlyphs;for(let U=S.vertexStartIndex;U<L;U+=4)u.indexArray.emplaceBack(U,U+1,U+2),u.indexArray.emplaceBack(U+1,U+2,U+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),S=Math.cos(u),L=[],U=[],Q=[];for(let re=0;re<this.symbolInstances.length;++re){Q.push(re);const Ae=this.symbolInstances.get(re);L.push(0|Math.round(p*Ae.anchorX+S*Ae.anchorY)),U.push(Ae.featureIndex)}return Q.sort((re,Ae)=>L[re]-L[Ae]||U[Ae]-U[re]),Q}addToSortKeyRanges(u,p){const S=this.sortKeyRanges[this.sortKeyRanges.length-1];S&&S.sortKey===p?S.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const S=this.symbolInstances.get(p);this.featureSortOrder.push(S.featureIndex),[S.rightJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.leftJustifiedTextSymbolIndex].forEach((L,U,Q)=>{L>=0&&Q.indexOf(L)===U&&this.addIndicesForPlacedSymbol(this.text,L)}),S.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,S.verticalPlacedTextSymbolIndex),S.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,S.placedIconSymbolIndex),S.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,S.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let vd,Lp;Pn("SymbolBucket",sh,{omit:["layers","collisionBoxArray","features","compareText"]}),sh.MAX_GLYPHS=65535,sh.addDynamicAttributes=NA;var xd={get paint(){return Lp=Lp||new cs({"icon-opacity":new Bi(hi.paint_symbol["icon-opacity"]),"icon-color":new Bi(hi.paint_symbol["icon-color"]),"icon-halo-color":new Bi(hi.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bi(hi.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bi(hi.paint_symbol["icon-halo-blur"]),"icon-translate":new ki(hi.paint_symbol["icon-translate"]),"icon-translate-anchor":new ki(hi.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bi(hi.paint_symbol["text-opacity"]),"text-color":new Bi(hi.paint_symbol["text-color"],{runtimeType:ft,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Bi(hi.paint_symbol["text-halo-color"]),"text-halo-width":new Bi(hi.paint_symbol["text-halo-width"]),"text-halo-blur":new Bi(hi.paint_symbol["text-halo-blur"]),"text-translate":new ki(hi.paint_symbol["text-translate"]),"text-translate-anchor":new ki(hi.paint_symbol["text-translate-anchor"])})},get layout(){return vd=vd||new cs({"symbol-placement":new ki(hi.layout_symbol["symbol-placement"]),"symbol-spacing":new ki(hi.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ki(hi.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bi(hi.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ki(hi.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ki(hi.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ki(hi.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ki(hi.layout_symbol["icon-ignore-placement"]),"icon-optional":new ki(hi.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ki(hi.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bi(hi.layout_symbol["icon-size"]),"icon-text-fit":new ki(hi.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ki(hi.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bi(hi.layout_symbol["icon-image"]),"icon-rotate":new Bi(hi.layout_symbol["icon-rotate"]),"icon-padding":new Bi(hi.layout_symbol["icon-padding"]),"icon-keep-upright":new ki(hi.layout_symbol["icon-keep-upright"]),"icon-offset":new Bi(hi.layout_symbol["icon-offset"]),"icon-anchor":new Bi(hi.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ki(hi.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ki(hi.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ki(hi.layout_symbol["text-rotation-alignment"]),"text-field":new Bi(hi.layout_symbol["text-field"]),"text-font":new Bi(hi.layout_symbol["text-font"]),"text-size":new Bi(hi.layout_symbol["text-size"]),"text-max-width":new Bi(hi.layout_symbol["text-max-width"]),"text-line-height":new ki(hi.layout_symbol["text-line-height"]),"text-letter-spacing":new Bi(hi.layout_symbol["text-letter-spacing"]),"text-justify":new Bi(hi.layout_symbol["text-justify"]),"text-radial-offset":new Bi(hi.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ki(hi.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Bi(hi.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Bi(hi.layout_symbol["text-anchor"]),"text-max-angle":new ki(hi.layout_symbol["text-max-angle"]),"text-writing-mode":new ki(hi.layout_symbol["text-writing-mode"]),"text-rotate":new Bi(hi.layout_symbol["text-rotate"]),"text-padding":new ki(hi.layout_symbol["text-padding"]),"text-keep-upright":new ki(hi.layout_symbol["text-keep-upright"]),"text-transform":new Bi(hi.layout_symbol["text-transform"]),"text-offset":new Bi(hi.layout_symbol["text-offset"]),"text-allow-overlap":new ki(hi.layout_symbol["text-allow-overlap"]),"text-overlap":new ki(hi.layout_symbol["text-overlap"]),"text-ignore-placement":new ki(hi.layout_symbol["text-ignore-placement"]),"text-optional":new ki(hi.layout_symbol["text-optional"])})}};class Bp{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:Qe,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pn("FormatSectionOverride",Bp,{omit:["defaultValue"]});class VA extends Ms{constructor(u){super(u,xd)}recalculate(u,p){if(super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const S=this.layout.get("text-writing-mode");if(S){const L=[];for(const U of S)L.indexOf(U)<0&&L.push(U);this.layout._values["text-writing-mode"]=L}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,p,S,L){const U=this.layout.get(u).evaluate(p,{},S,L),Q=this._unevaluatedLayout._values[u];return Q.isDataDriven()||es(Q.value)||!U?U:function(re,Ae){return Ae.replace(/{([^{}]+)}/g,(_e,Le)=>re&&Le in re?String(re[Le]):"")}(p.properties,U)}createBucket(u){return new sh(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of xd.paint.overridableProperties){if(!VA.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),S=new Bp(p),L=new Ol(S,p.property.specification);let U=null;U=p.value.kind==="constant"||p.value.kind==="source"?new Ts("source",L):new kr("composite",L,p.value.zoomStops),this.paint._values[u]=new vs(p.property,U,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,S){return!(!this.layout||p.isDataDriven()||S.isDataDriven())&&VA.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const S=u.get("text-field"),L=xd.paint.properties[p];let U=!1;const Q=re=>{for(const Ae of re)if(L.overrides&&L.overrides.hasOverride(Ae))return void(U=!0)};if(S.value.kind==="constant"&&S.value.value instanceof Qt)Q(S.value.value.sections);else if(S.value.kind==="source"){const re=_e=>{U||(_e instanceof Lt&&Vt(_e.value)===ne?Q(_e.value.sections):_e instanceof no?Q(_e.sections):_e.eachChild(re))},Ae=S.value;Ae._styleExpression&&re(Ae._styleExpression.expression)}return U}}let ah;var zp={get paint(){return ah=ah||new cs({"background-color":new ki(hi.paint_background["background-color"]),"background-pattern":new vu(hi.paint_background["background-pattern"]),"background-opacity":new ki(hi.paint_background["background-opacity"])})}};class Rp extends Ms{constructor(u){super(u,zp)}}let bd;var wd={get paint(){return bd=bd||new cs({"raster-opacity":new ki(hi.paint_raster["raster-opacity"]),"raster-hue-rotate":new ki(hi.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ki(hi.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ki(hi.paint_raster["raster-brightness-max"]),"raster-saturation":new ki(hi.paint_raster["raster-saturation"]),"raster-contrast":new ki(hi.paint_raster["raster-contrast"]),"raster-resampling":new ki(hi.paint_raster["raster-resampling"]),"raster-fade-duration":new ki(hi.paint_raster["raster-fade-duration"])})}};class Fp extends Ms{constructor(u){super(u,wd)}}class UA extends Ms{constructor(u){super(u,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class E0{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const C0=63710088e-1;class Lc{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Lc(Xt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,S=this.lat*p,L=u.lat*p,U=Math.sin(S)*Math.sin(L)+Math.cos(S)*Math.cos(L)*Math.cos((u.lng-this.lng)*p);return C0*Math.acos(Math.min(U,1))}static convert(u){if(u instanceof Lc)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new Lc(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new Lc(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Sd=2*Math.PI*C0;function Mu(f){return Sd*Math.cos(f*Math.PI/180)}function GA(f){return(180+f)/360}function Id(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Ed(f,u){return f/Mu(u)}function Cd(f){return 360*f-180}function T0(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class Df{constructor(u,p,S=0){this.x=+u,this.y=+p,this.z=+S}static fromLngLat(u,p=0){const S=Lc.convert(u);return new Df(GA(S.lng),Id(S.lat),Ed(p,S.lat))}toLngLat(){return new Lc(Cd(this.x),T0(this.y))}toAltitude(){return this.z*Mu(T0(this.y))}meterInMercatorCoordinateUnits(){return 1/Sd*(u=T0(this.y),1/Math.cos(u*Math.PI/180));var u}}function Td(f,u,p){var S=2*Math.PI*6378137/256/Math.pow(2,p);return[f*S-2*Math.PI*6378137/2,u*S-2*Math.PI*6378137/2]}class kd{constructor(u,p,S){if(u<0||u>25||S<0||S>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))throw new Error(`x=${p}, y=${S}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=p,this.y=S,this.key=qA(0,u,u,p,S)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p,S){const L=(Q=this.y,re=this.z,Ae=Td(256*(U=this.x),256*(Q=Math.pow(2,re)-Q-1),re),_e=Td(256*(U+1),256*(Q+1),re),Ae[0]+","+Ae[1]+","+_e[0]+","+_e[1]);var U,Q,re,Ae,_e;const Le=function(qe,et,At){let _t,Mt="";for(let Dt=qe;Dt>0;Dt--)_t=1<<Dt-1,Mt+=(et&_t?1:0)+(At&_t?2:0);return Mt}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(S==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Le).replace(/{bbox-epsg-3857}/g,L)}isChildOf(u){const p=this.z-u.z;return p>0&&u.x===this.x>>p&&u.y===this.y>>p}getTilePoint(u){const p=Math.pow(2,this.z);return new ue((u.x*p-this.x)*Pa,(u.y*p-this.y)*Pa)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Md{constructor(u,p){this.wrap=u,this.canonical=p,this.key=qA(u,p.z,p.z,p.x,p.y)}}class bl{constructor(u,p,S,L,U){if(u<S)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${S}`);this.overscaledZ=u,this.wrap=p,this.canonical=new kd(S,+L,+U),this.key=qA(p,u,S,L,U)}clone(){return new bl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-u;return u>this.canonical.z?new bl(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bl(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const S=this.canonical.z-u;return u>this.canonical.z?qA(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y):qA(this.wrap*+p,u,u,this.canonical.x>>S,this.canonical.y>>S)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new bl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,S=2*this.canonical.x,L=2*this.canonical.y;return[new bl(p,this.wrap,p,S,L),new bl(p,this.wrap,p,S+1,L),new bl(p,this.wrap,p,S,L+1),new bl(p,this.wrap,p,S+1,L+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new bl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new bl(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Md(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new Df(u.x-this.wrap,u.y))}}function qA(f,u,p,S,L){(f*=2)<0&&(f=-1*f-1);const U=1<<p;return(U*U*f+U*L+S).toString(36)+p.toString(36)+u.toString(36)}Pn("CanonicalTileID",kd),Pn("OverscaledTileID",bl,{omit:["posMatrix"]});class k0{constructor(u,p,S,L=1,U=1,Q=1,re=0){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(S&&!["mapbox","terrarium","custom"].includes(S))return void $e(`"${S}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=p.height;const Ae=this.dim=p.height-2;switch(this.data=new Uint32Array(p.data.buffer),S){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=L,this.greenFactor=U,this.blueFactor=Q,this.baseShift=re;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let _e=0;_e<Ae;_e++)this.data[this._idx(-1,_e)]=this.data[this._idx(0,_e)],this.data[this._idx(Ae,_e)]=this.data[this._idx(Ae-1,_e)],this.data[this._idx(_e,-1)]=this.data[this._idx(_e,0)],this.data[this._idx(_e,Ae)]=this.data[this._idx(_e,Ae-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Ae,-1)]=this.data[this._idx(Ae-1,0)],this.data[this._idx(-1,Ae)]=this.data[this._idx(0,Ae-1)],this.data[this._idx(Ae,Ae)]=this.data[this._idx(Ae-1,Ae-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let _e=0;_e<Ae;_e++)for(let Le=0;Le<Ae;Le++){const qe=this.get(_e,Le);qe>this.max&&(this.max=qe),qe<this.min&&(this.min=qe)}}get(u,p){const S=new Uint8Array(this.data.buffer),L=4*this._idx(u,p);return this.unpack(S[L],S[L+1],S[L+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}unpack(u,p,S){return u*this.redFactor+p*this.greenFactor+S*this.blueFactor-this.baseShift}getPixels(){return new Ll({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,p,S){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let L=p*this.dim,U=p*this.dim+this.dim,Q=S*this.dim,re=S*this.dim+this.dim;switch(p){case-1:L=U-1;break;case 1:U=L+1}switch(S){case-1:Q=re-1;break;case 1:re=Q+1}const Ae=-p*this.dim,_e=-S*this.dim;for(let Le=Q;Le<re;Le++)for(let qe=L;qe<U;qe++)this.data[this._idx(qe,Le)]=u.data[this._idx(qe+Ae,Le+_e)]}}Pn("DEMData",k0);class M0{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const S=u[p];this._stringToNumber[S]=p,this._numberToString[p]=S}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class Pd{constructor(u,p,S,L,U){this.type="Feature",this._vectorTileFeature=u,u._z=p,u._x=S,u._y=L,this.properties=u.properties,this.id=U}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(u[p]=this[p]);return u}}class Op{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new go(Pa,16,0),this.grid3D=new go(Pa,16,0),this.featureIndexArray=new ct,this.promoteId=p}insert(u,p,S,L,U,Q){const re=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(S,L,U);const Ae=Q?this.grid3D:this.grid;for(let _e=0;_e<p.length;_e++){const Le=p[_e],qe=[1/0,1/0,-1/0,-1/0];for(let et=0;et<Le.length;et++){const At=Le[et];qe[0]=Math.min(qe[0],At.x),qe[1]=Math.min(qe[1],At.y),qe[2]=Math.max(qe[2],At.x),qe[3]=Math.max(qe[3],At.y)}qe[0]<Pa&&qe[1]<Pa&&qe[2]>=0&&qe[3]>=0&&Ae.insert(re,qe[0],qe[1],qe[2],qe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ih.VectorTile(new v0(this.rawTileData)).layers,this.sourceLayerCoder=new M0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,p,S,L){this.loadVTLayers();const U=u.params||{},Q=Pa/u.tileSize/u.scale,re=Qr(U.filter),Ae=u.queryGeometry,_e=u.queryPadding*Q,Le=Dd(Ae),qe=this.grid.query(Le.minX-_e,Le.minY-_e,Le.maxX+_e,Le.maxY+_e),et=Dd(u.cameraQueryGeometry),At=this.grid3D.query(et.minX-_e,et.minY-_e,et.maxX+_e,et.maxY+_e,(Dt,Bt,Kt,Ht)=>function(Zt,ci,yi,Xi,xn){for(const an of Zt)if(ci<=an.x&&yi<=an.y&&Xi>=an.x&&xn>=an.y)return!0;const on=[new ue(ci,yi),new ue(ci,xn),new ue(Xi,xn),new ue(Xi,yi)];if(Zt.length>2){for(const an of on)if(Xu(Zt,an))return!0}for(let an=0;an<Zt.length-1;an++)if(H0(Zt[an],Zt[an+1],on))return!0;return!1}(u.cameraQueryGeometry,Dt-_e,Bt-_e,Kt+_e,Ht+_e));for(const Dt of At)qe.push(Dt);qe.sort(oh);const _t={};let Mt;for(let Dt=0;Dt<qe.length;Dt++){const Bt=qe[Dt];if(Bt===Mt)continue;Mt=Bt;const Kt=this.featureIndexArray.get(Bt);let Ht=null;this.loadMatchingFeature(_t,Kt.bucketIndex,Kt.sourceLayerIndex,Kt.featureIndex,re,U.layers,U.availableImages,p,S,L,(Zt,ci,yi)=>(Ht||(Ht=Uh(Zt)),ci.queryIntersectsFeature(Ae,Zt,yi,Ht,this.z,u.transform,Q,u.pixelPosMatrix)))}return _t}loadMatchingFeature(u,p,S,L,U,Q,re,Ae,_e,Le,qe){const et=this.bucketLayerIDs[p];if(Q&&!function(Dt,Bt){for(let Kt=0;Kt<Dt.length;Kt++)if(Bt.indexOf(Dt[Kt])>=0)return!0;return!1}(Q,et))return;const At=this.sourceLayerCoder.decode(S),_t=this.vtLayers[At].feature(L);if(U.needGeometry){const Dt=Ic(_t,!0);if(!U.filter(new gn(this.tileID.overscaledZ),Dt,this.tileID.canonical))return}else if(!U.filter(new gn(this.tileID.overscaledZ),_t))return;const Mt=this.getId(_t,At);for(let Dt=0;Dt<et.length;Dt++){const Bt=et[Dt];if(Q&&Q.indexOf(Bt)<0)continue;const Kt=Ae[Bt];if(!Kt)continue;let Ht={};Mt&&Le&&(Ht=Le.getState(Kt.sourceLayer||"_geojsonTileLayer",Mt));const Zt=rt({},_e[Bt]);Zt.paint=Np(Zt.paint,Kt.paint,_t,Ht,re),Zt.layout=Np(Zt.layout,Kt.layout,_t,Ht,re);const ci=!qe||qe(_t,Kt,Ht);if(!ci)continue;const yi=new Pd(_t,this.z,this.x,this.y,Mt);yi.layer=Zt;let Xi=u[Bt];Xi===void 0&&(Xi=u[Bt]=[]),Xi.push({featureIndex:L,feature:yi,intersectionZ:ci})}}lookupSymbolFeatures(u,p,S,L,U,Q,re,Ae){const _e={};this.loadVTLayers();const Le=Qr(U);for(const qe of u)this.loadMatchingFeature(_e,S,L,qe,Le,Q,re,Ae,p);return _e}hasLayer(u){for(const p of this.bucketLayerIDs)for(const S of p)if(u===S)return!0;return!1}getId(u,p){let S=u.id;return this.promoteId&&(S=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof S=="boolean"&&(S=Number(S))),S}}function Np(f,u,p,S,L){return pt(f,(U,Q)=>{const re=u instanceof ko?u.get(Q):null;return re&&re.evaluate?re.evaluate(p,S,L):re})}function Dd(f){let u=1/0,p=1/0,S=-1/0,L=-1/0;for(const U of f)u=Math.min(u,U.x),p=Math.min(p,U.y),S=Math.max(S,U.x),L=Math.max(L,U.y);return{minX:u,minY:p,maxX:S,maxY:L}}function oh(f,u){return u-f}function Ld(f,u,p,S,L){const U=[];for(let Q=0;Q<f.length;Q++){const re=f[Q];let Ae;for(let _e=0;_e<re.length-1;_e++){let Le=re[_e],qe=re[_e+1];Le.x<u&&qe.x<u||(Le.x<u?Le=new ue(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x<u&&(qe=new ue(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y<p&&qe.y<p||(Le.y<p?Le=new ue(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round():qe.y<p&&(qe=new ue(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round()),Le.x>=S&&qe.x>=S||(Le.x>=S?Le=new ue(S,Le.y+(S-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x>=S&&(qe=new ue(S,Le.y+(S-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y>=L&&qe.y>=L||(Le.y>=L?Le=new ue(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round():qe.y>=L&&(qe=new ue(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round()),Ae&&Le.equals(Ae[Ae.length-1])||(Ae=[Le],U.push(Ae)),Ae.push(qe)))))}}return U}Pn("FeatureIndex",Op,{omit:["rawTileData","sourceLayerCoder"]});class cc extends ue{constructor(u,p,S,L){super(u,p),this.angle=S,L!==void 0&&(this.segment=L)}clone(){return new cc(this.x,this.y,this.angle,this.segment)}}function Bd(f,u,p,S,L){if(u.segment===void 0||p===0)return!0;let U=u,Q=u.segment+1,re=0;for(;re>-p/2;){if(Q--,Q<0)return!1;re-=f[Q].dist(U),U=f[Q]}re+=f[Q].dist(f[Q+1]),Q++;const Ae=[];let _e=0;for(;re<p/2;){const Le=f[Q],qe=f[Q+1];if(!qe)return!1;let et=f[Q-1].angleTo(Le)-Le.angleTo(qe);for(et=Math.abs((et+3*Math.PI)%(2*Math.PI)-Math.PI),Ae.push({distance:re,angleDelta:et}),_e+=et;re-Ae[0].distance>S;)_e-=Ae.shift().angleDelta;if(_e>L)return!1;Q++,re+=Le.dist(qe)}return!0}function Lf(f){let u=0;for(let p=0;p<f.length-1;p++)u+=f[p].dist(f[p+1]);return u}function Bf(f,u,p){return f?.6*u*p:0}function zf(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function Vm(f,u,p,S,L,U){const Q=Bf(p,L,U),re=zf(p,S)*U;let Ae=0;const _e=Lf(f)/2;for(let Le=0;Le<f.length-1;Le++){const qe=f[Le],et=f[Le+1],At=qe.dist(et);if(Ae+At>_e){const _t=(_e-Ae)/At,Mt=js.number(qe.x,et.x,_t),Dt=js.number(qe.y,et.y,_t),Bt=new cc(Mt,Dt,et.angleTo(qe),Le);return Bt._round(),!Q||Bd(f,Bt,re,Q,u)?Bt:void 0}Ae+=At}}function Um(f,u,p,S,L,U,Q,re,Ae){const _e=Bf(S,U,Q),Le=zf(S,L),qe=Le*Q,et=f[0].x===0||f[0].x===Ae||f[0].y===0||f[0].y===Ae;return u-qe<u/4&&(u=qe+u/4),Vp(f,et?u/2*re%u:(Le/2+2*U)*Q*re%u,u,_e,p,qe,et,!1,Ae)}function Vp(f,u,p,S,L,U,Q,re,Ae){const _e=U/2,Le=Lf(f);let qe=0,et=u-p,At=[];for(let _t=0;_t<f.length-1;_t++){const Mt=f[_t],Dt=f[_t+1],Bt=Mt.dist(Dt),Kt=Dt.angleTo(Mt);for(;et+p<qe+Bt;){et+=p;const Ht=(et-qe)/Bt,Zt=js.number(Mt.x,Dt.x,Ht),ci=js.number(Mt.y,Dt.y,Ht);if(Zt>=0&&Zt<Ae&&ci>=0&&ci<Ae&&et-_e>=0&&et+_e<=Le){const yi=new cc(Zt,ci,Kt,_t);yi._round(),S&&!Bd(f,yi,U,S,L)||At.push(yi)}}qe+=Bt}return re||At.length||Q||(At=Vp(f,qe/2,p,S,L,U,Q,!0,Ae)),At}Pn("Anchor",cc);const HA=Su;function iA(f,u,p,S){const L=[],U=f.image,Q=U.pixelRatio,re=U.paddedRect.w-2*HA,Ae=U.paddedRect.h-2*HA,_e=f.right-f.left,Le=f.bottom-f.top,qe=U.stretchX||[[0,re]],et=U.stretchY||[[0,Ae]],At=(An,zn)=>An+zn[1]-zn[0],_t=qe.reduce(At,0),Mt=et.reduce(At,0),Dt=re-_t,Bt=Ae-Mt;let Kt=0,Ht=_t,Zt=0,ci=Mt,yi=0,Xi=Dt,xn=0,on=Bt;if(U.content&&S){const An=U.content;Kt=Do(qe,0,An[0]),Zt=Do(et,0,An[1]),Ht=Do(qe,An[0],An[2]),ci=Do(et,An[1],An[3]),yi=An[0]-Kt,xn=An[1]-Zt,Xi=An[2]-An[0]-Ht,on=An[3]-An[1]-ci}const an=(An,zn,sn,Wi)=>{const Dn=nA(An.stretch-Kt,Ht,_e,f.left),Rn=jA(An.fixed-yi,Xi,An.stretch,_t),pr=nA(zn.stretch-Zt,ci,Le,f.top),Vr=jA(zn.fixed-xn,on,zn.stretch,Mt),Hr=nA(sn.stretch-Kt,Ht,_e,f.left),zs=jA(sn.fixed-yi,Xi,sn.stretch,_t),Ea=nA(Wi.stretch-Zt,ci,Le,f.top),ia=jA(Wi.fixed-xn,on,Wi.stretch,Mt),ns=new ue(Dn,pr),Wn=new ue(Hr,pr),ws=new ue(Hr,Ea),ir=new ue(Dn,Ea),na=new ue(Rn/Q,Vr/Q),Ps=new ue(zs/Q,ia/Q),Kn=u*Math.PI/180;if(Kn){const va=Math.sin(Kn),Uo=Math.cos(Kn),oo=[Uo,-va,va,Uo];ns._matMult(oo),Wn._matMult(oo),ir._matMult(oo),ws._matMult(oo)}const La=An.stretch+An.fixed,$a=zn.stretch+zn.fixed;return{tl:ns,tr:Wn,bl:ir,br:ws,tex:{x:U.paddedRect.x+HA+La,y:U.paddedRect.y+HA+$a,w:sn.stretch+sn.fixed-La,h:Wi.stretch+Wi.fixed-$a},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:na,pixelOffsetBR:Ps,minFontScaleX:Xi/Q/_e,minFontScaleY:on/Q/Le,isSDF:p}};if(S&&(U.stretchX||U.stretchY)){const An=lh(qe,Dt,_t),zn=lh(et,Bt,Mt);for(let sn=0;sn<An.length-1;sn++){const Wi=An[sn],Dn=An[sn+1];for(let Rn=0;Rn<zn.length-1;Rn++)L.push(an(Wi,zn[Rn],Dn,zn[Rn+1]))}}else L.push(an({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:re+1},{fixed:0,stretch:Ae+1}));return L}function Do(f,u,p){let S=0;for(const L of f)S+=Math.max(u,Math.min(p,L[1]))-Math.max(u,Math.min(p,L[0]));return S}function lh(f,u,p){const S=[{fixed:-HA,stretch:0}];for(const[L,U]of f){const Q=S[S.length-1];S.push({fixed:L-Q.stretch,stretch:Q.stretch}),S.push({fixed:L-Q.stretch,stretch:Q.stretch+(U-L)})}return S.push({fixed:u+HA,stretch:p}),S}function nA(f,u,p,S){return f/u*p+S}function jA(f,u,p,S){return f-u*p/S}class rA{constructor(u,p,S,L,U,Q,re,Ae,_e,Le){if(this.boxStartIndex=u.length,_e){let qe=Q.top,et=Q.bottom;const At=Q.collisionPadding;At&&(qe-=At[1],et+=At[3]);let _t=et-qe;_t>0&&(_t=Math.max(10,_t),this.circleDiameter=_t)}else{let qe=Q.top*re-Ae[0],et=Q.bottom*re+Ae[2],At=Q.left*re-Ae[3],_t=Q.right*re+Ae[1];const Mt=Q.collisionPadding;if(Mt&&(At-=Mt[0]*re,qe-=Mt[1]*re,_t+=Mt[2]*re,et+=Mt[3]*re),Le){const Dt=new ue(At,qe),Bt=new ue(_t,qe),Kt=new ue(At,et),Ht=new ue(_t,et),Zt=Le*Math.PI/180;Dt._rotate(Zt),Bt._rotate(Zt),Kt._rotate(Zt),Ht._rotate(Zt),At=Math.min(Dt.x,Bt.x,Kt.x,Ht.x),_t=Math.max(Dt.x,Bt.x,Kt.x,Ht.x),qe=Math.min(Dt.y,Bt.y,Kt.y,Ht.y),et=Math.max(Dt.y,Bt.y,Kt.y,Ht.y)}u.emplaceBack(p.x,p.y,At,qe,_t,et,S,L,U)}this.boxEndIndex=u.length}}class P0{constructor(u=[],p=Up){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let S=(this.length>>1)-1;S>=0;S--)this._down(S)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:S}=this,L=p[u];for(;u>0;){const U=u-1>>1,Q=p[U];if(S(L,Q)>=0)break;p[u]=Q,u=U}p[u]=L}_down(u){const{data:p,compare:S}=this,L=this.length>>1,U=p[u];for(;u<L;){let Q=1+(u<<1),re=p[Q];const Ae=Q+1;if(Ae<this.length&&S(p[Ae],re)<0&&(Q=Ae,re=p[Ae]),S(re,U)>=0)break;p[u]=re,u=Q}p[u]=U}}function Up(f,u){return f<u?-1:f>u?1:0}function zd(f,u=1,p=!1){let S=1/0,L=1/0,U=-1/0,Q=-1/0;const re=f[0];for(let At=0;At<re.length;At++){const _t=re[At];(!At||_t.x<S)&&(S=_t.x),(!At||_t.y<L)&&(L=_t.y),(!At||_t.x>U)&&(U=_t.x),(!At||_t.y>Q)&&(Q=_t.y)}const Ae=Math.min(U-S,Q-L);let _e=Ae/2;const Le=new P0([],Rd);if(Ae===0)return new ue(S,L);for(let At=S;At<U;At+=Ae)for(let _t=L;_t<Q;_t+=Ae)Le.push(new ZA(At+_e,_t+_e,_e,f));let qe=function(At){let _t=0,Mt=0,Dt=0;const Bt=At[0];for(let Kt=0,Ht=Bt.length,Zt=Ht-1;Kt<Ht;Zt=Kt++){const ci=Bt[Kt],yi=Bt[Zt],Xi=ci.x*yi.y-yi.x*ci.y;Mt+=(ci.x+yi.x)*Xi,Dt+=(ci.y+yi.y)*Xi,_t+=3*Xi}return new ZA(Mt/_t,Dt/_t,0,At)}(f),et=Le.length;for(;Le.length;){const At=Le.pop();(At.d>qe.d||!qe.d)&&(qe=At,p&&console.log("found best %d after %d probes",Math.round(1e4*At.d)/1e4,et)),At.max-qe.d<=u||(_e=At.h/2,Le.push(new ZA(At.p.x-_e,At.p.y-_e,_e,f)),Le.push(new ZA(At.p.x+_e,At.p.y-_e,_e,f)),Le.push(new ZA(At.p.x-_e,At.p.y+_e,_e,f)),Le.push(new ZA(At.p.x+_e,At.p.y+_e,_e,f)),et+=4)}return p&&(console.log(`num probes: ${et}`),console.log(`best distance: ${qe.d}`)),qe.p}function Rd(f,u){return u.max-f.max}function ZA(f,u,p,S){this.p=new ue(f,u),this.h=p,this.d=function(L,U){let Q=!1,re=1/0;for(let Ae=0;Ae<U.length;Ae++){const _e=U[Ae];for(let Le=0,qe=_e.length,et=qe-1;Le<qe;et=Le++){const At=_e[Le],_t=_e[et];At.y>L.y!=_t.y>L.y&&L.x<(_t.x-At.x)*(L.y-At.y)/(_t.y-At.y)+At.x&&(Q=!Q),re=Math.min(re,q0(L,At,_t))}}return(Q?1:-1)*Math.sqrt(re)}(this.p,S),this.max=this.d+this.h*Math.SQRT2}var Bl;a.aq=void 0,(Bl=a.aq||(a.aq={}))[Bl.center=1]="center",Bl[Bl.left=2]="left",Bl[Bl.right=3]="right",Bl[Bl.top=4]="top",Bl[Bl.bottom=5]="bottom",Bl[Bl["top-left"]=6]="top-left",Bl[Bl["top-right"]=7]="top-right",Bl[Bl["bottom-left"]=8]="bottom-left",Bl[Bl["bottom-right"]=9]="bottom-right";const Bc=7,Mh=Number.POSITIVE_INFINITY;function QA(f,u){return u[1]!==Mh?function(p,S,L){let U=0,Q=0;switch(S=Math.abs(S),L=Math.abs(L),p){case"top-right":case"top-left":case"top":Q=L-Bc;break;case"bottom-right":case"bottom-left":case"bottom":Q=-L+Bc}switch(p){case"top-right":case"bottom-right":case"right":U=-S;break;case"top-left":case"bottom-left":case"left":U=S}return[U,Q]}(f,u[0],u[1]):function(p,S){let L=0,U=0;S<0&&(S=0);const Q=S/Math.SQRT2;switch(p){case"top-right":case"top-left":U=Q-Bc;break;case"bottom-right":case"bottom-left":U=-Q+Bc;break;case"bottom":U=-S+Bc;break;case"top":U=S-Bc}switch(p){case"top-right":case"bottom-right":L=-Q;break;case"top-left":case"bottom-left":L=Q;break;case"left":L=S;break;case"right":L=-S}return[L,U]}(f,u[0])}function WA(f,u,p){var S;const L=f.layout,U=(S=L.get("text-variable-anchor-offset"))===null||S===void 0?void 0:S.evaluate(u,{},p);if(U){const re=U.values,Ae=[];for(let _e=0;_e<re.length;_e+=2){const Le=Ae[_e]=re[_e],qe=re[_e+1].map(et=>et*Ya);Le.startsWith("top")?qe[1]-=Bc:Le.startsWith("bottom")&&(qe[1]+=Bc),Ae[_e+1]=qe}return new Tn(Ae)}const Q=L.get("text-variable-anchor");if(Q){let re;re=f._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[L.get("text-radial-offset").evaluate(u,{},p)*Ya,Mh]:L.get("text-offset").evaluate(u,{},p).map(_e=>_e*Ya);const Ae=[];for(const _e of Q)Ae.push(_e,QA(_e,re));return new Tn(Ae)}return null}function Rf(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function D0(f,u,p,S,L,U,Q,re,Ae,_e,Le){let qe=U.textMaxSize.evaluate(u,{});qe===void 0&&(qe=Q);const et=f.layers[0].layout,At=et.get("icon-offset").evaluate(u,{},Le),_t=Of(p.horizontal),Mt=Q/24,Dt=f.tilePixelRatio*Mt,Bt=f.tilePixelRatio*qe/24,Kt=f.tilePixelRatio*re,Ht=f.tilePixelRatio*et.get("symbol-spacing"),Zt=et.get("text-padding")*f.tilePixelRatio,ci=function(Wi,Dn,Rn,pr=1){const Vr=Wi.get("icon-padding").evaluate(Dn,{},Rn),Hr=Vr&&Vr.values;return[Hr[0]*pr,Hr[1]*pr,Hr[2]*pr,Hr[3]*pr]}(et,u,Le,f.tilePixelRatio),yi=et.get("text-max-angle")/180*Math.PI,Xi=et.get("text-rotation-alignment")!=="viewport"&&et.get("symbol-placement")!=="point",xn=et.get("icon-rotation-alignment")==="map"&&et.get("symbol-placement")!=="point",on=et.get("symbol-placement"),an=Ht/2,An=et.get("icon-text-fit");let zn;S&&An!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(zn=S0(S,p.vertical,An,et.get("icon-text-fit-padding"),At,Mt)),_t&&(S=S0(S,_t,An,et.get("icon-text-fit-padding"),At,Mt)));const sn=(Wi,Dn)=>{Dn.x<0||Dn.x>=Pa||Dn.y<0||Dn.y>=Pa||function(Rn,pr,Vr,Hr,zs,Ea,ia,ns,Wn,ws,ir,na,Ps,Kn,La,$a,va,Uo,oo,ra,br,vo,nl,rl,Pu){const Uu=Rn.addToLineVertexArray(pr,Vr);let zl,zc,Gu,qu,Xl=0,uh=0,sA=0,qp=0,Fd=-1,Od=-1;const lo={};let xo=yo("");if(Rn.allowVerticalPlacement&&Hr.vertical){const Iu=ns.layout.get("text-rotate").evaluate(br,{},rl)+90;Gu=new rA(Wn,pr,ws,ir,na,Hr.vertical,Ps,Kn,La,Iu),ia&&(qu=new rA(Wn,pr,ws,ir,na,ia,va,Uo,La,Iu))}if(zs){const Iu=ns.layout.get("icon-rotate").evaluate(br,{}),Ac=ns.layout.get("icon-text-fit")!=="none",Rc=iA(zs,Iu,nl,Ac),ch=ia?iA(ia,Iu,nl,Ac):void 0;zc=new rA(Wn,pr,ws,ir,na,zs,va,Uo,!1,Iu),Xl=4*Rc.length;const qf=Rn.iconSizeData;let Dh=null;qf.kind==="source"?(Dh=[Yu*ns.layout.get("icon-size").evaluate(br,{})],Dh[0]>Dc&&$e(`${Rn.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)):qf.kind==="composite"&&(Dh=[Yu*vo.compositeIconSizes[0].evaluate(br,{},rl),Yu*vo.compositeIconSizes[1].evaluate(br,{},rl)],(Dh[0]>Dc||Dh[1]>Dc)&&$e(`${Rn.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)),Rn.addSymbols(Rn.icon,Rc,Dh,ra,oo,br,a.ai.none,pr,Uu.lineStartIndex,Uu.lineLength,-1,rl),Fd=Rn.icon.placedSymbolArray.length-1,ch&&(uh=4*ch.length,Rn.addSymbols(Rn.icon,ch,Dh,ra,oo,br,a.ai.vertical,pr,Uu.lineStartIndex,Uu.lineLength,-1,rl),Od=Rn.icon.placedSymbolArray.length-1)}const Gf=Object.keys(Hr.horizontal);for(const Iu of Gf){const Ac=Hr.horizontal[Iu];if(!zl){xo=yo(Ac.text);const ch=ns.layout.get("text-rotate").evaluate(br,{},rl);zl=new rA(Wn,pr,ws,ir,na,Ac,Ps,Kn,La,ch)}const Rc=Ac.positionedLines.length===1;if(sA+=Ff(Rn,pr,Ac,Ea,ns,La,br,$a,Uu,Hr.vertical?a.ai.horizontal:a.ai.horizontalOnly,Rc?Gf:[Iu],lo,Fd,vo,rl),Rc)break}Hr.vertical&&(qp+=Ff(Rn,pr,Hr.vertical,Ea,ns,La,br,$a,Uu,a.ai.vertical,["vertical"],lo,Od,vo,rl));const Hp=zl?zl.boxStartIndex:Rn.collisionBoxArray.length,Gm=zl?zl.boxEndIndex:Rn.collisionBoxArray.length,jp=Gu?Gu.boxStartIndex:Rn.collisionBoxArray.length,qm=Gu?Gu.boxEndIndex:Rn.collisionBoxArray.length,Yl=zc?zc.boxStartIndex:Rn.collisionBoxArray.length,Hu=zc?zc.boxEndIndex:Rn.collisionBoxArray.length,Ph=qu?qu.boxStartIndex:Rn.collisionBoxArray.length,hc=qu?qu.boxEndIndex:Rn.collisionBoxArray.length;let $l=-1;const ju=(Iu,Ac)=>Iu&&Iu.circleDiameter?Math.max(Iu.circleDiameter,Ac):Ac;$l=ju(zl,$l),$l=ju(Gu,$l),$l=ju(zc,$l),$l=ju(qu,$l);const Hm=$l>-1?1:0;Hm&&($l*=Pu/Ya),Rn.glyphOffsetArray.length>=sh.MAX_GLYPHS&&$e("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),br.sortKey!==void 0&&Rn.addToSortKeyRanges(Rn.symbolInstances.length,br.sortKey);const Fg=WA(ns,br,rl),[x1,b1]=function(Iu,Ac){const Rc=Iu.length,ch=Ac==null?void 0:Ac.values;if((ch==null?void 0:ch.length)>0)for(let qf=0;qf<ch.length;qf+=2){const Dh=ch[qf+1];Iu.emplaceBack(a.aq[ch[qf]],Dh[0],Dh[1])}return[Rc,Iu.length]}(Rn.textAnchorOffsets,Fg);Rn.symbolInstances.emplaceBack(pr.x,pr.y,lo.right>=0?lo.right:-1,lo.center>=0?lo.center:-1,lo.left>=0?lo.left:-1,lo.vertical||-1,Fd,Od,xo,Hp,Gm,jp,qm,Yl,Hu,Ph,hc,ws,sA,qp,Xl,uh,Hm,0,Ps,$l,x1,b1)}(f,Dn,Wi,p,S,L,zn,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,Dt,[Zt,Zt,Zt,Zt],Xi,Ae,Kt,ci,xn,At,u,U,_e,Le,Q)};if(on==="line")for(const Wi of Ld(u.geometry,0,0,Pa,Pa)){const Dn=Um(Wi,Ht,yi,p.vertical||_t,S,24,Bt,f.overscaling,Pa);for(const Rn of Dn)_t&&Nf(f,_t.text,an,Rn)||sn(Wi,Rn)}else if(on==="line-center"){for(const Wi of u.geometry)if(Wi.length>1){const Dn=Vm(Wi,yi,p.vertical||_t,S,24,Bt);Dn&&sn(Wi,Dn)}}else if(u.type==="Polygon")for(const Wi of Y0(u.geometry,0)){const Dn=zd(Wi,16);sn(Wi[0],new cc(Dn.x,Dn.y,0))}else if(u.type==="LineString")for(const Wi of u.geometry)sn(Wi,new cc(Wi[0].x,Wi[0].y,0));else if(u.type==="Point")for(const Wi of u.geometry)for(const Dn of Wi)sn([Dn],new cc(Dn.x,Dn.y,0))}function Ff(f,u,p,S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t){const Mt=function(Kt,Ht,Zt,ci,yi,Xi,xn,on){const an=ci.layout.get("text-rotate").evaluate(Xi,{})*Math.PI/180,An=[];for(const zn of Ht.positionedLines)for(const sn of zn.positionedGlyphs){if(!sn.rect)continue;const Wi=sn.rect||{};let Dn=Cf+1,Rn=!0,pr=1,Vr=0;const Hr=(yi||on)&&sn.vertical,zs=sn.metrics.advance*sn.scale/2;if(on&&Ht.verticalizable&&(Vr=zn.lineOffset/2-(sn.imageName?-(Ya-sn.metrics.width*sn.scale)/2:(sn.scale-1)*Ya)),sn.imageName){const ra=xn[sn.imageName];Rn=ra.sdf,pr=ra.pixelRatio,Dn=Su/pr}const Ea=yi?[sn.x+zs,sn.y]:[0,0];let ia=yi?[0,0]:[sn.x+zs+Zt[0],sn.y+Zt[1]-Vr],ns=[0,0];Hr&&(ns=ia,ia=[0,0]);const Wn=sn.metrics.isDoubleResolution?2:1,ws=(sn.metrics.left-Dn)*sn.scale-zs+ia[0],ir=(-sn.metrics.top-Dn)*sn.scale+ia[1],na=ws+Wi.w/Wn*sn.scale/pr,Ps=ir+Wi.h/Wn*sn.scale/pr,Kn=new ue(ws,ir),La=new ue(na,ir),$a=new ue(ws,Ps),va=new ue(na,Ps);if(Hr){const ra=new ue(-zs,zs-RA),br=-Math.PI/2,vo=Ya/2-zs,nl=new ue(5-RA-vo,-(sn.imageName?vo:0)),rl=new ue(...ns);Kn._rotateAround(br,ra)._add(nl)._add(rl),La._rotateAround(br,ra)._add(nl)._add(rl),$a._rotateAround(br,ra)._add(nl)._add(rl),va._rotateAround(br,ra)._add(nl)._add(rl)}if(an){const ra=Math.sin(an),br=Math.cos(an),vo=[br,-ra,ra,br];Kn._matMult(vo),La._matMult(vo),$a._matMult(vo),va._matMult(vo)}const Uo=new ue(0,0),oo=new ue(0,0);An.push({tl:Kn,tr:La,bl:$a,br:va,tex:Wi,writingMode:Ht.writingMode,glyphOffset:Ea,sectionIndex:sn.sectionIndex,isSDF:Rn,pixelOffsetTL:Uo,pixelOffsetBR:oo,minFontScaleX:0,minFontScaleY:0})}return An}(0,p,re,L,U,Q,S,f.allowVerticalPlacement),Dt=f.textSizeData;let Bt=null;Dt.kind==="source"?(Bt=[Yu*L.layout.get("text-size").evaluate(Q,{})],Bt[0]>Dc&&$e(`${f.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)):Dt.kind==="composite"&&(Bt=[Yu*At.compositeTextSizes[0].evaluate(Q,{},_t),Yu*At.compositeTextSizes[1].evaluate(Q,{},_t)],(Bt[0]>Dc||Bt[1]>Dc)&&$e(`${f.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)),f.addSymbols(f.text,Mt,Bt,re,U,Q,_e,u,Ae.lineStartIndex,Ae.lineLength,et,_t);for(const Kt of Le)qe[Kt]=f.text.placedSymbolArray.length-1;return 4*Mt.length}function Of(f){for(const u in f)return f[u];return null}function Nf(f,u,p,S){const L=f.compareText;if(u in L){const U=L[u];for(let Q=U.length-1;Q>=0;Q--)if(S.dist(U[Q])<p)return!0}else L[u]=[];return L[u].push(S),!1}const L0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Vf{static from(u){if(!(u instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[p,S]=new Uint8Array(u,0,2);if(p!==219)throw new Error("Data does not appear to be in a KDBush format.");const L=S>>4;if(L!==1)throw new Error(`Got v${L} data when expected v1.`);const U=L0[15&S];if(!U)throw new Error("Unrecognized array type.");const[Q]=new Uint16Array(u,2,1),[re]=new Uint32Array(u,4,1);return new Vf(re,Q,U,u)}constructor(u,p=64,S=Float64Array,L){if(isNaN(u)||u<0)throw new Error(`Unpexpected numItems value: ${u}.`);this.numItems=+u,this.nodeSize=Math.min(Math.max(+p,2),65535),this.ArrayType=S,this.IndexArrayType=u<65536?Uint16Array:Uint32Array;const U=L0.indexOf(this.ArrayType),Q=2*u*this.ArrayType.BYTES_PER_ELEMENT,re=u*this.IndexArrayType.BYTES_PER_ELEMENT,Ae=(8-re%8)%8;if(U<0)throw new Error(`Unexpected typed array class: ${S}.`);L&&L instanceof ArrayBuffer?(this.data=L,this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+Ae,2*u),this._pos=2*u,this._finished=!0):(this.data=new ArrayBuffer(8+Q+re+Ae),this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+Ae,2*u),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+U]),new Uint16Array(this.data,2,1)[0]=p,new Uint32Array(this.data,4,1)[0]=u)}add(u,p){const S=this._pos>>1;return this.ids[S]=S,this.coords[this._pos++]=u,this.coords[this._pos++]=p,S}finish(){const u=this._pos>>1;if(u!==this.numItems)throw new Error(`Added ${u} items when expected ${this.numItems}.`);return Uf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(u,p,S,L){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:U,coords:Q,nodeSize:re}=this,Ae=[0,U.length-1,0],_e=[];for(;Ae.length;){const Le=Ae.pop()||0,qe=Ae.pop()||0,et=Ae.pop()||0;if(qe-et<=re){for(let Dt=et;Dt<=qe;Dt++){const Bt=Q[2*Dt],Kt=Q[2*Dt+1];Bt>=u&&Bt<=S&&Kt>=p&&Kt<=L&&_e.push(U[Dt])}continue}const At=et+qe>>1,_t=Q[2*At],Mt=Q[2*At+1];_t>=u&&_t<=S&&Mt>=p&&Mt<=L&&_e.push(U[At]),(Le===0?u<=_t:p<=Mt)&&(Ae.push(et),Ae.push(At-1),Ae.push(1-Le)),(Le===0?S>=_t:L>=Mt)&&(Ae.push(At+1),Ae.push(qe),Ae.push(1-Le))}return _e}within(u,p,S){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:L,coords:U,nodeSize:Q}=this,re=[0,L.length-1,0],Ae=[],_e=S*S;for(;re.length;){const Le=re.pop()||0,qe=re.pop()||0,et=re.pop()||0;if(qe-et<=Q){for(let Dt=et;Dt<=qe;Dt++)x(U[2*Dt],U[2*Dt+1],u,p)<=_e&&Ae.push(L[Dt]);continue}const At=et+qe>>1,_t=U[2*At],Mt=U[2*At+1];x(_t,Mt,u,p)<=_e&&Ae.push(L[At]),(Le===0?u-S<=_t:p-S<=Mt)&&(re.push(et),re.push(At-1),re.push(1-Le)),(Le===0?u+S>=_t:p+S>=Mt)&&(re.push(At+1),re.push(qe),re.push(1-Le))}return Ae}}function Uf(f,u,p,S,L,U){if(L-S<=p)return;const Q=S+L>>1;Gp(f,u,Q,S,L,U),Uf(f,u,p,S,Q-1,1-U),Uf(f,u,p,Q+1,L,1-U)}function Gp(f,u,p,S,L,U){for(;L>S;){if(L-S>600){const _e=L-S+1,Le=p-S+1,qe=Math.log(_e),et=.5*Math.exp(2*qe/3),At=.5*Math.sqrt(qe*et*(_e-et)/_e)*(Le-_e/2<0?-1:1);Gp(f,u,p,Math.max(S,Math.floor(p-Le*et/_e+At)),Math.min(L,Math.floor(p+(_e-Le)*et/_e+At)),U)}const Q=u[2*p+U];let re=S,Ae=L;for(m(f,u,S,p),u[2*L+U]>Q&&m(f,u,S,L);re<Ae;){for(m(f,u,re,Ae),re++,Ae--;u[2*re+U]<Q;)re++;for(;u[2*Ae+U]>Q;)Ae--}u[2*S+U]===Q?m(f,u,S,Ae):(Ae++,m(f,u,Ae,L)),Ae<=p&&(S=Ae+1),p<=Ae&&(L=Ae-1)}}function m(f,u,p,S){h(f,p,S),h(u,2*p,2*S),h(u,2*p+1,2*S+1)}function h(f,u,p){const S=f[u];f[u]=f[p],f[p]=S}function x(f,u,p,S){const L=f-p,U=u-S;return L*L+U*U}var M;a.bh=void 0,(M=a.bh||(a.bh={})).create="create",M.load="load",M.fullLoad="fullLoad";let q=null,K=[];const J=1e3/60,me="loadTime",Ce="fullLoadTime",Oe={mark(f){performance.mark(f)},frame(f){const u=f;q!=null&&K.push(u-q),q=u},clearMetrics(){q=null,K=[],performance.clearMeasures(me),performance.clearMeasures(Ce);for(const f in a.bh)performance.clearMarks(a.bh[f])},getPerformanceMetrics(){performance.measure(me,a.bh.create,a.bh.load),performance.measure(Ce,a.bh.create,a.bh.fullLoad);const f=performance.getEntriesByName(me)[0].duration,u=performance.getEntriesByName(Ce)[0].duration,p=K.length,S=1/(K.reduce((U,Q)=>U+Q,0)/p/1e3),L=K.filter(U=>U>J).reduce((U,Q)=>U+(Q-J)/J,0);return{loadTime:f,fullLoadTime:u,fps:S,percentDroppedFrames:L/(p+L)*100,totalFrames:p}}};a.$=function(f,u,p){var S,L,U,Q,re,Ae,_e,Le,qe,et,At,_t,Mt=p[0],Dt=p[1],Bt=p[2];return u===f?(f[12]=u[0]*Mt+u[4]*Dt+u[8]*Bt+u[12],f[13]=u[1]*Mt+u[5]*Dt+u[9]*Bt+u[13],f[14]=u[2]*Mt+u[6]*Dt+u[10]*Bt+u[14],f[15]=u[3]*Mt+u[7]*Dt+u[11]*Bt+u[15]):(L=u[1],U=u[2],Q=u[3],re=u[4],Ae=u[5],_e=u[6],Le=u[7],qe=u[8],et=u[9],At=u[10],_t=u[11],f[0]=S=u[0],f[1]=L,f[2]=U,f[3]=Q,f[4]=re,f[5]=Ae,f[6]=_e,f[7]=Le,f[8]=qe,f[9]=et,f[10]=At,f[11]=_t,f[12]=S*Mt+re*Dt+qe*Bt+u[12],f[13]=L*Mt+Ae*Dt+et*Bt+u[13],f[14]=U*Mt+_e*Dt+At*Bt+u[14],f[15]=Q*Mt+Le*Dt+_t*Bt+u[15]),f},a.A=Hh,a.B=js,a.C=class{constructor(f,u,p){this.receive=S=>{const L=S.data,U=L.id;if(U&&(!L.targetMapId||this.mapId===L.targetMapId))if(L.type==="<cancel>"){delete this.tasks[U];const Q=this.cancelCallbacks[U];delete this.cancelCallbacks[U],Q&&Q()}else Nt()||L.mustQueue?(this.tasks[U]=L,this.taskQueue.push(U),this.invoker.trigger()):this.processTask(U,L)},this.process=()=>{if(!this.taskQueue.length)return;const S=this.taskQueue.shift(),L=this.tasks[S];delete this.tasks[S],this.taskQueue.length&&this.invoker.trigger(),L&&this.processTask(S,L)},this.target=f,this.parent=u,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new E0(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Nt()?f:window}send(f,u,p,S,L=!1){const U=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[U]=p);const Q=[],re={id:U,type:f,hasCallback:!!p,targetMapId:S,mustQueue:L,sourceMapId:this.mapId,data:Sn(u,Q)};return this.target.postMessage(re,{transfer:Q}),{cancel:()=>{p&&delete this.callbacks[U],this.target.postMessage({id:U,type:"<cancel>",targetMapId:S,sourceMapId:this.mapId})}}}processTask(f,u){if(u.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(u.error?p(Fo(u.error)):p(null,Fo(u.data)))}else{let p=!1;const S=[],L=u.hasCallback?(re,Ae)=>{p=!0,delete this.cancelCallbacks[f];const _e={id:f,type:"<response>",sourceMapId:this.mapId,error:re?Sn(re):null,data:Sn(Ae,S)};this.target.postMessage(_e,{transfer:S})}:re=>{p=!0};let U=null;const Q=Fo(u.data);if(this.parent[u.type])U=this.parent[u.type](u.sourceMapId,Q,L);else if("getWorkerSource"in this.parent){const re=u.type.split(".");U=this.parent.getWorkerSource(u.sourceMapId,re[0],Q.source)[re[1]](Q,L)}else L(new Error(`Could not find function ${u.type}`));!p&&U&&U.cancel&&(this.cancelCallbacks[f]=U.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.D=ki,a.E=Rr,a.F=function(f,u){const p={};for(let S=0;S<u.length;S++){const L=u[S];L in f&&(p[L]=f[L])}return p},a.G=GA,a.H=Id,a.I=x0,a.J=ut,a.K=Tt,a.L=Lc,a.M=Si,a.N=Pa,a.O=bl,a.P=ue,a.Q=R,a.R=Ll,a.S=er,a.T=tl,a.U=Df,a.V=class extends we{},a.W=kd,a.X=function(f,u){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let S=0;S<f.length;S++){const L=window.document.createElement("source");Ji(f[S])||(p.crossOrigin="Anonymous"),L.src=f[S],p.appendChild(L)}return{cancel:()=>{}}},a.Y=ve,a.Z=function(){var f=new Hh(16);return Hh!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},a._=G,a.a=Ot,a.a$=class extends w{},a.a0=function(f,u,p){var S=p[0],L=p[1],U=p[2];return f[0]=u[0]*S,f[1]=u[1]*S,f[2]=u[2]*S,f[3]=u[3]*S,f[4]=u[4]*L,f[5]=u[5]*L,f[6]=u[6]*L,f[7]=u[7]*L,f[8]=u[8]*U,f[9]=u[9]*U,f[10]=u[10]*U,f[11]=u[11]*U,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.a1=cf,a.a2=function(){return yt++},a.a3=j,a.a4=sh,a.a5=function(){ds.isLoading()||ds.isLoaded()||Nu()!=="deferred"||_r()},a.a6=Qr,a.a7=Ic,a.a8=gn,a.a9=Pd,a.aA=_u,a.aB=function(f){f=f.slice();const u=Object.create(null);for(let p=0;p<f.length;p++)u[f[p].id]=f[p];for(let p=0;p<f.length;p++)"ref"in f[p]&&(f[p]=tr(f[p],u[f[p].ref]));return f},a.aC=function(f){if(f.type==="custom")return new UA(f);switch(f.type){case"background":return new Rp(f);case"circle":return new Vu(f);case"fill":return new wp(f);case"fill-extrusion":return new td(f);case"heatmap":return new Jc(f);case"hillshade":return new Q0(f);case"line":return new Al(f);case"raster":return new Fp(f);case"symbol":return new VA(f)}},a.aD=bt,a.aE=function(f,u){if(!f)return[{command:Qn.setStyle,args:[u]}];let p=[];try{if(!Fn(f.version,u.version))return[{command:Qn.setStyle,args:[u]}];Fn(f.center,u.center)||p.push({command:Qn.setCenter,args:[u.center]}),Fn(f.zoom,u.zoom)||p.push({command:Qn.setZoom,args:[u.zoom]}),Fn(f.bearing,u.bearing)||p.push({command:Qn.setBearing,args:[u.bearing]}),Fn(f.pitch,u.pitch)||p.push({command:Qn.setPitch,args:[u.pitch]}),Fn(f.sprite,u.sprite)||p.push({command:Qn.setSprite,args:[u.sprite]}),Fn(f.glyphs,u.glyphs)||p.push({command:Qn.setGlyphs,args:[u.glyphs]}),Fn(f.transition,u.transition)||p.push({command:Qn.setTransition,args:[u.transition]}),Fn(f.light,u.light)||p.push({command:Qn.setLight,args:[u.light]});const S={},L=[];(function(Q,re,Ae,_e){let Le;for(Le in re=re||{},Q=Q||{})Object.prototype.hasOwnProperty.call(Q,Le)&&(Object.prototype.hasOwnProperty.call(re,Le)||v(Le,Ae,_e));for(Le in re)Object.prototype.hasOwnProperty.call(re,Le)&&(Object.prototype.hasOwnProperty.call(Q,Le)?Fn(Q[Le],re[Le])||(Q[Le].type==="geojson"&&re[Le].type==="geojson"&&V(Q,re,Le)?Ae.push({command:Qn.setGeoJSONSourceData,args:[Le,re[Le].data]}):k(Le,re,Ae,_e)):In(Le,re,Ae))})(f.sources,u.sources,L,S);const U=[];f.layers&&f.layers.forEach(Q=>{S[Q.source]?p.push({command:Qn.removeLayer,args:[Q.id]}):U.push(Q)}),p=p.concat(L),function(Q,re,Ae){re=re||[];const _e=(Q=Q||[]).map(te),Le=re.map(te),qe=Q.reduce(fe,{}),et=re.reduce(fe,{}),At=_e.slice(),_t=Object.create(null);let Mt,Dt,Bt,Kt,Ht,Zt,ci;for(Mt=0,Dt=0;Mt<_e.length;Mt++)Bt=_e[Mt],Object.prototype.hasOwnProperty.call(et,Bt)?Dt++:(Ae.push({command:Qn.removeLayer,args:[Bt]}),At.splice(At.indexOf(Bt,Dt),1));for(Mt=0,Dt=0;Mt<Le.length;Mt++)Bt=Le[Le.length-1-Mt],At[At.length-1-Mt]!==Bt&&(Object.prototype.hasOwnProperty.call(qe,Bt)?(Ae.push({command:Qn.removeLayer,args:[Bt]}),At.splice(At.lastIndexOf(Bt,At.length-Dt),1)):Dt++,Zt=At[At.length-Mt],Ae.push({command:Qn.addLayer,args:[et[Bt],Zt]}),At.splice(At.length-Mt,0,Bt),_t[Bt]=!0);for(Mt=0;Mt<Le.length;Mt++)if(Bt=Le[Mt],Kt=qe[Bt],Ht=et[Bt],!_t[Bt]&&!Fn(Kt,Ht))if(Fn(Kt.source,Ht.source)&&Fn(Kt["source-layer"],Ht["source-layer"])&&Fn(Kt.type,Ht.type)){for(ci in $(Kt.layout,Ht.layout,Ae,Bt,null,Qn.setLayoutProperty),$(Kt.paint,Ht.paint,Ae,Bt,null,Qn.setPaintProperty),Fn(Kt.filter,Ht.filter)||Ae.push({command:Qn.setFilter,args:[Bt,Ht.filter]}),Fn(Kt.minzoom,Ht.minzoom)&&Fn(Kt.maxzoom,Ht.maxzoom)||Ae.push({command:Qn.setLayerZoomRange,args:[Bt,Ht.minzoom,Ht.maxzoom]}),Kt)Object.prototype.hasOwnProperty.call(Kt,ci)&&ci!=="layout"&&ci!=="paint"&&ci!=="filter"&&ci!=="metadata"&&ci!=="minzoom"&&ci!=="maxzoom"&&(ci.indexOf("paint.")===0?$(Kt[ci],Ht[ci],Ae,Bt,ci.slice(6),Qn.setPaintProperty):Fn(Kt[ci],Ht[ci])||Ae.push({command:Qn.setLayerProperty,args:[Bt,ci,Ht[ci]]}));for(ci in Ht)Object.prototype.hasOwnProperty.call(Ht,ci)&&!Object.prototype.hasOwnProperty.call(Kt,ci)&&ci!=="layout"&&ci!=="paint"&&ci!=="filter"&&ci!=="metadata"&&ci!=="minzoom"&&ci!=="maxzoom"&&(ci.indexOf("paint.")===0?$(Kt[ci],Ht[ci],Ae,Bt,ci.slice(6),Qn.setPaintProperty):Fn(Kt[ci],Ht[ci])||Ae.push({command:Qn.setLayerProperty,args:[Bt,ci,Ht[ci]]}))}else Ae.push({command:Qn.removeLayer,args:[Bt]}),Zt=At[At.lastIndexOf(Bt)+1],Ae.push({command:Qn.addLayer,args:[Ht,Zt]})}(U,u.layers,p)}catch(S){console.warn("Unable to compute style diff:",S),p=[{command:Qn.setStyle,args:[u]}]}return p},a.aF=function(f){const u=[],p=f.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},a.aG=function f(u,p){if(Array.isArray(u)){if(!Array.isArray(p)||u.length!==p.length)return!1;for(let S=0;S<u.length;S++)if(!f(u[S],p[S]))return!1;return!0}if(typeof u=="object"&&u!==null&&p!==null){if(typeof p!="object"||Object.keys(u).length!==Object.keys(p).length)return!1;for(const S in u)if(!f(u[S],p[S]))return!1;return!0}return u===p},a.aH=pt,a.aI=gt,a.aJ=cu,a.aK=function(f){return f({pluginStatus:_a,pluginURL:el}),cu.on("pluginStateChange",f),f},a.aL=class extends bs{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},a.aM=Qs,a.aN=class extends bs{constructor(f,u){super(f,u),this.current=Vo}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},a.aO=Mo,a.aP=class extends bs{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},a.aQ=class extends bs{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},a.aR=No,a.aS=function(f,u,p,S,L,U,Q){var re=1/(u-p),Ae=1/(S-L),_e=1/(U-Q);return f[0]=-2*re,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Ae,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*_e,f[11]=0,f[12]=(u+p)*re,f[13]=(L+S)*Ae,f[14]=(Q+U)*_e,f[15]=1,f},a.aT=Hi,a.aU=j0,a.aV=class extends F{},a.aW=ld,a.aX=class extends y{},a.aY=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},a.aZ=A0,a.a_=Et,a.aa=function(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,S,L,U)=>{const Q=L||U;return u[S]=!Q||Q.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u},a.ab=function(f,u){const p=[];for(const S in f)S in u||p.push(S);return p},a.ac=function(f){if(Rt==null){const u=f.navigator?f.navigator.userAgent:null;Rt=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Rt},a.ad=Ge,a.ae=function(f,u,p){var S=Math.sin(p),L=Math.cos(p),U=u[0],Q=u[1],re=u[2],Ae=u[3],_e=u[4],Le=u[5],qe=u[6],et=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=U*L+_e*S,f[1]=Q*L+Le*S,f[2]=re*L+qe*S,f[3]=Ae*L+et*S,f[4]=_e*L-U*S,f[5]=Le*L-Q*S,f[6]=qe*L-re*S,f[7]=et*L-Ae*S,f},a.af=function(f){var u=new Hh(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},a.ag=Dl,a.ah=function(f,u){let p=0,S=0;if(f.kind==="constant")S=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:L,minZoom:U,maxZoom:Q}=f,re=L?Ge(vr.interpolationFactor(L,u,U,Q),0,1):0;f.kind==="camera"?S=js.number(f.minSize,f.maxSize,re):p=re}return{uSizeT:p,uSize:S}},a.aj=function(f,{uSize:u,uSizeT:p},{lowerSize:S,upperSize:L}){return f.kind==="source"?S/Yu:f.kind==="composite"?js.number(S/Yu,L/Yu,p):u},a.ak=NA,a.al=function(f,u,p,S){const L=u.y-f.y,U=u.x-f.x,Q=S.y-p.y,re=S.x-p.x,Ae=Q*U-re*L;if(Ae===0)return null;const _e=(re*(f.y-p.y)-Q*(f.x-p.x))/Ae;return new ue(f.x+_e*U,f.y+_e*L)},a.am=Ld,a.an=Xc,a.ao=jh,a.ap=Ya,a.ar=I0,a.as=function(f,u){var p=u[0],S=u[1],L=u[2],U=u[3],Q=u[4],re=u[5],Ae=u[6],_e=u[7],Le=u[8],qe=u[9],et=u[10],At=u[11],_t=u[12],Mt=u[13],Dt=u[14],Bt=u[15],Kt=p*re-S*Q,Ht=p*Ae-L*Q,Zt=p*_e-U*Q,ci=S*Ae-L*re,yi=S*_e-U*re,Xi=L*_e-U*Ae,xn=Le*Mt-qe*_t,on=Le*Dt-et*_t,an=Le*Bt-At*_t,An=qe*Dt-et*Mt,zn=qe*Bt-At*Mt,sn=et*Bt-At*Dt,Wi=Kt*sn-Ht*zn+Zt*An+ci*an-yi*on+Xi*xn;return Wi?(f[0]=(re*sn-Ae*zn+_e*An)*(Wi=1/Wi),f[1]=(L*zn-S*sn-U*An)*Wi,f[2]=(Mt*Xi-Dt*yi+Bt*ci)*Wi,f[3]=(et*yi-qe*Xi-At*ci)*Wi,f[4]=(Ae*an-Q*sn-_e*on)*Wi,f[5]=(p*sn-L*an+U*on)*Wi,f[6]=(Dt*Zt-_t*Xi-Bt*Ht)*Wi,f[7]=(Le*Xi-et*Zt+At*Ht)*Wi,f[8]=(Q*zn-re*an+_e*xn)*Wi,f[9]=(S*an-p*zn-U*xn)*Wi,f[10]=(_t*yi-Mt*Zt+Bt*Kt)*Wi,f[11]=(qe*Zt-Le*yi-At*Kt)*Wi,f[12]=(re*on-Q*An-Ae*xn)*Wi,f[13]=(p*An-S*on+L*xn)*Wi,f[14]=(Mt*Ht-_t*ci-Dt*Kt)*Wi,f[15]=(Le*ci-qe*Ht+et*Kt)*Wi,f):null},a.at=Rf,a.au=md,a.av=Vf,a.aw=function(){const f={},u=hi.$version;for(const p in hi.$root){const S=hi.$root[p];if(S.required){let L=null;L=p==="version"?u:S.type==="array"?[]:{},L!=null&&(f[p]=L)}}return f},a.ax=Qn,a.ay=Nl,a.az=Ci,a.b=function(f,u){const p=new Blob([new Uint8Array(f)],{type:"image/png"});createImageBitmap(p).then(S=>{u(null,S)}).catch(S=>{u(new Error(`Could not load image because of ${S.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},a.b0=Bn,a.b1=function(f,u){var p=f[0],S=f[1],L=f[2],U=f[3],Q=f[4],re=f[5],Ae=f[6],_e=f[7],Le=f[8],qe=f[9],et=f[10],At=f[11],_t=f[12],Mt=f[13],Dt=f[14],Bt=f[15],Kt=u[0],Ht=u[1],Zt=u[2],ci=u[3],yi=u[4],Xi=u[5],xn=u[6],on=u[7],an=u[8],An=u[9],zn=u[10],sn=u[11],Wi=u[12],Dn=u[13],Rn=u[14],pr=u[15];return Math.abs(p-Kt)<=Wl*Math.max(1,Math.abs(p),Math.abs(Kt))&&Math.abs(S-Ht)<=Wl*Math.max(1,Math.abs(S),Math.abs(Ht))&&Math.abs(L-Zt)<=Wl*Math.max(1,Math.abs(L),Math.abs(Zt))&&Math.abs(U-ci)<=Wl*Math.max(1,Math.abs(U),Math.abs(ci))&&Math.abs(Q-yi)<=Wl*Math.max(1,Math.abs(Q),Math.abs(yi))&&Math.abs(re-Xi)<=Wl*Math.max(1,Math.abs(re),Math.abs(Xi))&&Math.abs(Ae-xn)<=Wl*Math.max(1,Math.abs(Ae),Math.abs(xn))&&Math.abs(_e-on)<=Wl*Math.max(1,Math.abs(_e),Math.abs(on))&&Math.abs(Le-an)<=Wl*Math.max(1,Math.abs(Le),Math.abs(an))&&Math.abs(qe-An)<=Wl*Math.max(1,Math.abs(qe),Math.abs(An))&&Math.abs(et-zn)<=Wl*Math.max(1,Math.abs(et),Math.abs(zn))&&Math.abs(At-sn)<=Wl*Math.max(1,Math.abs(At),Math.abs(sn))&&Math.abs(_t-Wi)<=Wl*Math.max(1,Math.abs(_t),Math.abs(Wi))&&Math.abs(Mt-Dn)<=Wl*Math.max(1,Math.abs(Mt),Math.abs(Dn))&&Math.abs(Dt-Rn)<=Wl*Math.max(1,Math.abs(Dt),Math.abs(Rn))&&Math.abs(Bt-pr)<=Wl*Math.max(1,Math.abs(Bt),Math.abs(pr))},a.b2=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.b3=function(f,u,p){return f[0]=u[0]*p[0],f[1]=u[1]*p[1],f[2]=u[2]*p[2],f[3]=u[3]*p[3],f},a.b4=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},a.b5=Xt,a.b6=Md,a.b7=Ed,a.b8=function(f,u,p,S,L){var U,Q=1/Math.tan(u/2);return f[0]=Q/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=Q,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,L!=null&&L!==1/0?(f[10]=(L+S)*(U=1/(S-L)),f[14]=2*L*S*U):(f[10]=-1,f[14]=-2*S),f},a.b9=function(f,u,p){var S=Math.sin(p),L=Math.cos(p),U=u[4],Q=u[5],re=u[6],Ae=u[7],_e=u[8],Le=u[9],qe=u[10],et=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=U*L+_e*S,f[5]=Q*L+Le*S,f[6]=re*L+qe*S,f[7]=Ae*L+et*S,f[8]=_e*L-U*S,f[9]=Le*L-Q*S,f[10]=qe*L-re*S,f[11]=et*L-Ae*S,f},a.bA=he,a.bB=g0,a.bC=Zr,a.bD=ds,a.ba=Pt,a.bb=zt,a.bc=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},a.bd=class extends oe{},a.be=C0,a.bf=Cd,a.bg=Oe,a.bi=yn,a.bj=function(f,u,p=!1){if(_a===sc||_a===Wu||_a===jl)throw new Error("setRTLTextPlugin cannot be called multiple times.");el=Ni.resolveURL(f),_a=sc,fs=u,Ou(),p||_r()},a.bk=Nu,a.bl=function(f,u){const p={};for(let L=0;L<f.length;L++){const U=u&&u[f[L].id]||Qa(f[L]);u&&(u[f[L].id]=U);let Q=p[U];Q||(Q=p[U]=[]),Q.push(f[L])}const S=[];for(const L in p)S.push(p[L]);return S},a.bm=Pn,a.bn=M0,a.bo=Op,a.bp=ku,a.bq=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Pa/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0],p=u.layout,S=u._unevaluatedLayout._values,L={layoutIconSize:S["icon-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),layoutTextSize:S["text-size"].possiblyEvaluate(new gn(f.bucket.zoom+1),f.canonical),textMaxSize:S["text-size"].possiblyEvaluate(new gn(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.textSizeData;L.compositeTextSizes=[S["text-size"].possiblyEvaluate(new gn(_e),f.canonical),S["text-size"].possiblyEvaluate(new gn(Le),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.iconSizeData;L.compositeIconSizes=[S["icon-size"].possiblyEvaluate(new gn(_e),f.canonical),S["icon-size"].possiblyEvaluate(new gn(Le),f.canonical)]}const U=p.get("text-line-height")*Ya,Q=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",re=p.get("text-keep-upright"),Ae=p.get("text-size");for(const _e of f.bucket.features){const Le=p.get("text-font").evaluate(_e,{},f.canonical).join(","),qe=Ae.evaluate(_e,{},f.canonical),et=L.layoutTextSize.evaluate(_e,{},f.canonical),At=L.layoutIconSize.evaluate(_e,{},f.canonical),_t={horizontal:{},vertical:void 0},Mt=_e.text;let Dt,Bt=[0,0];if(Mt){const Zt=Mt.toString(),ci=p.get("text-letter-spacing").evaluate(_e,{},f.canonical)*Ya,yi=Cn(Zt)?ci:0,Xi=p.get("text-anchor").evaluate(_e,{},f.canonical),xn=WA(u,_e,f.canonical);if(!xn){const sn=p.get("text-radial-offset").evaluate(_e,{},f.canonical);Bt=sn?QA(Xi,[sn*Ya,Mh]):p.get("text-offset").evaluate(_e,{},f.canonical).map(Wi=>Wi*Ya)}let on=Q?"center":p.get("text-justify").evaluate(_e,{},f.canonical);const an=p.get("symbol-placement"),An=an==="point"?p.get("text-max-width").evaluate(_e,{},f.canonical)*Ya:0,zn=()=>{f.bucket.allowVerticalPlacement&&Hl(Zt)&&(_t.vertical=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,An,U,Xi,"left",yi,Bt,a.ai.vertical,!0,an,et,qe))};if(!Q&&xn){const sn=new Set;if(on==="auto")for(let Dn=0;Dn<xn.values.length;Dn+=2)sn.add(Rf(xn.values[Dn]));else sn.add(on);let Wi=!1;for(const Dn of sn)if(!_t.horizontal[Dn])if(Wi)_t.horizontal[Dn]=_t.horizontal[0];else{const Rn=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,An,U,"center",Dn,yi,Bt,a.ai.horizontal,!1,an,et,qe);Rn&&(_t.horizontal[Dn]=Rn,Wi=Rn.positionedLines.length===1)}zn()}else{on==="auto"&&(on=Rf(Xi));const sn=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,An,U,Xi,on,yi,Bt,a.ai.horizontal,!1,an,et,qe);sn&&(_t.horizontal[on]=sn),zn(),Hl(Zt)&&Q&&re&&(_t.vertical=OA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,An,U,Xi,on,yi,Bt,a.ai.vertical,!1,an,et,qe))}}let Kt=!1;if(_e.icon&&_e.icon.name){const Zt=f.imageMap[_e.icon.name];Zt&&(Dt=w0(f.imagePositions[_e.icon.name],p.get("icon-offset").evaluate(_e,{},f.canonical),p.get("icon-anchor").evaluate(_e,{},f.canonical)),Kt=!!Zt.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=Kt:f.bucket.sdfIcons!==Kt&&$e("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Zt.pixelRatio!==f.bucket.pixelRatio||p.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const Ht=Of(_t.horizontal)||_t.vertical;f.bucket.iconsInText=!!Ht&&Ht.iconsInText,(Ht||Dt)&&D0(f.bucket,_e,_t,Dt,f.imageMap,L,et,At,Bt,Kt,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},a.br=nd,a.bs=xf,a.bt=Ul,a.bu=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},a.bv=v0,a.bw=Ih,a.bx=function(f,u,p,S,L){return G(this,void 0,void 0,function*(){if(Tt())try{return yield Si(f,u,p,S,L)}catch{}return function(U,Q,re,Ae,_e){const Le=U.width,qe=U.height;Ti&&Oi||(Ti=new OffscreenCanvas(Le,qe),Oi=Ti.getContext("2d",{willReadFrequently:!0})),Ti.width=Le,Ti.height=qe,Oi.drawImage(U,0,0,Le,qe);const et=Oi.getImageData(Q,re,Ae,_e);return Oi.clearRect(0,0,Le,qe),et.data}(f,u,p,S,L)})},a.by=k0,a.bz=W,a.c=nn,a.d=function(f,u){const p=new Image;p.onload=()=>{u(null,p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=_i})},p.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const S=new Blob([new Uint8Array(f)],{type:"image/png"});p.src=f.byteLength?URL.createObjectURL(S):_i},a.e=rt,a.f=function(f,u){return ai(rt(f,{type:"json"}),u)},a.g=gi,a.h=Ni,a.i=Nt,a.j=wn,a.k=ii,a.l=Ki,a.m=ai,a.n=function(f){return new v0(f).readFields(BA,[])},a.o=function(f,u,p){if(!f.length)return p(null,[]);let S=f.length;const L=new Array(f.length);let U=null;f.forEach((Q,re)=>{u(Q,(Ae,_e)=>{Ae&&(U=Ae),L[re]=_e,--S==0&&p(U,L)})})},a.p=Tf,a.q=xh,a.r=cs,a.s=Ji,a.t=mo,a.u=En,a.v=hi,a.w=$e,a.x=Ru,a.y=Xa,a.z=function([f,u,p]){return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(p),y:f*Math.sin(u)*Math.sin(p),z:f*Math.cos(p)}}}),b(["./shared"],function(a){class G{constructor(X){this.keyCache={},X&&this.replace(X)}replace(X){this._layerConfigs={},this._layers={},this.update(X,[])}update(X,ie){for(const ye of X){this._layerConfigs[ye.id]=ye;const ge=this._layers[ye.id]=a.aC(ye);ge._featureFilter=a.a6(ge.filter),this.keyCache[ye.id]&&delete this.keyCache[ye.id]}for(const ye of ie)delete this.keyCache[ye],delete this._layerConfigs[ye],delete this._layers[ye];this.familiesBySource={};const de=a.bl(Object.values(this._layerConfigs),this.keyCache);for(const ye of de){const ge=ye.map(De=>this._layers[De.id]),Pe=ge[0];if(Pe.visibility==="none")continue;const Fe=Pe.source||"";let Ne=this.familiesBySource[Fe];Ne||(Ne=this.familiesBySource[Fe]={});const Xe=Pe.sourceLayer||"_geojsonTileLayer";let Ye=Ne[Xe];Ye||(Ye=Ne[Xe]=[]),Ye.push(ge)}}}class W{constructor(X){const ie={},de=[];for(const Fe in X){const Ne=X[Fe],Xe=ie[Fe]={};for(const Ye in Ne){const De=Ne[+Ye];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const Ue={x:0,y:0,w:De.bitmap.width+2,h:De.bitmap.height+2};de.push(Ue),Xe[Ye]={rect:Ue,metrics:De.metrics}}}const{w:ye,h:ge}=a.p(de),Pe=new a.q({width:ye||1,height:ge||1});for(const Fe in X){const Ne=X[Fe];for(const Xe in Ne){const Ye=Ne[+Xe];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const De=ie[Fe][Xe].rect;a.q.copy(Ye.bitmap,Pe,{x:0,y:0},{x:De.x+1,y:De.y+1},Ye.bitmap)}}this.image=Pe,this.positions=ie}}a.bm("GlyphAtlas",W);class he{constructor(X){this.tileID=new a.O(X.tileID.overscaledZ,X.tileID.wrap,X.tileID.canonical.z,X.tileID.canonical.x,X.tileID.canonical.y),this.uid=X.uid,this.zoom=X.zoom,this.pixelRatio=X.pixelRatio,this.tileSize=X.tileSize,this.source=X.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=X.showCollisionBoxes,this.collectResourceTiming=!!X.collectResourceTiming,this.returnDependencies=!!X.returnDependencies,this.promoteId=X.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(X,ie,de,ye,ge){this.status="parsing",this.data=X,this.collisionBoxArray=new a.a3;const Pe=new a.bn(Object.keys(X.layers).sort()),Fe=new a.bo(this.tileID,this.promoteId);Fe.bucketLayerIDs=[];const Ne={},Xe={featureIndex:Fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:de},Ye=ie.familiesBySource[this.source];for(const Jt in Ye){const li=X.layers[Jt];if(!li)continue;li.version===1&&a.w(`Vector tile source "${this.source}" layer "${Jt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const zi=Pe.encode(Jt),vi=[];for(let wi=0;wi<li.length;wi++){const $t=li.feature(wi),vn=Fe.getId($t,Jt);vi.push({feature:$t,id:vn,index:wi,sourceLayerIndex:zi})}for(const wi of Ye[Jt]){const $t=wi[0];$t.source!==this.source&&a.w(`layer.source = ${$t.source} does not equal this.source = ${this.source}`),$t.minzoom&&this.zoom<Math.floor($t.minzoom)||$t.maxzoom&&this.zoom>=$t.maxzoom||$t.visibility!=="none"&&(ae(wi,this.zoom,de),(Ne[$t.id]=$t.createBucket({index:Fe.bucketLayerIDs.length,layers:wi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:zi,sourceID:this.source})).populate(vi,Xe,this.tileID.canonical),Fe.bucketLayerIDs.push(wi.map(vn=>vn.id)))}}let De,Ue,ht,kt;const o=a.aH(Xe.glyphDependencies,Jt=>Object.keys(Jt).map(Number));this.inFlightDependencies.forEach(Jt=>Jt==null?void 0:Jt.cancel()),this.inFlightDependencies=[];const ke=++this.dependencySentinel;Object.keys(o).length?this.inFlightDependencies.push(ye.send("getGlyphs",{uid:this.uid,stacks:o,source:this.source,tileID:this.tileID,type:"glyphs"},(Jt,li)=>{ke===this.dependencySentinel&&(De||(De=Jt,Ue=li,Ai.call(this)))})):Ue={};const oi=Object.keys(Xe.iconDependencies);oi.length?this.inFlightDependencies.push(ye.send("getImages",{icons:oi,source:this.source,tileID:this.tileID,type:"icons"},(Jt,li)=>{ke===this.dependencySentinel&&(De||(De=Jt,ht=li,Ai.call(this)))})):ht={};const di=Object.keys(Xe.patternDependencies);function Ai(){if(De)return ge(De);if(Ue&&ht&&kt){const Jt=new W(Ue),li=new a.bp(ht,kt);for(const zi in Ne){const vi=Ne[zi];vi instanceof a.a4?(ae(vi.layers,this.zoom,de),a.bq({bucket:vi,glyphMap:Ue,glyphPositions:Jt.positions,imageMap:ht,imagePositions:li.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):vi.hasPattern&&(vi instanceof a.br||vi instanceof a.bs||vi instanceof a.bt)&&(ae(vi.layers,this.zoom,de),vi.addFeatures(Xe,this.tileID.canonical,li.patternPositions))}this.status="done",ge(null,{buckets:Object.values(Ne).filter(zi=>!zi.isEmpty()),featureIndex:Fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Jt.image,imageAtlas:li,glyphMap:this.returnDependencies?Ue:null,iconMap:this.returnDependencies?ht:null,glyphPositions:this.returnDependencies?Jt.positions:null})}}di.length?this.inFlightDependencies.push(ye.send("getImages",{icons:di,source:this.source,tileID:this.tileID,type:"patterns"},(Jt,li)=>{ke===this.dependencySentinel&&(De||(De=Jt,kt=li,Ai.call(this)))})):kt={},Ai.call(this)}}function ae(ne,X,ie){const de=new a.a8(X);for(const ye of ne)ye.recalculate(de,ie)}function ue(ne,X){const ie=a.l(ne.request,(de,ye,ge,Pe)=>{if(de)X(de);else if(ye)try{const Fe=new a.bw.VectorTile(new a.bv(ye));X(null,{vectorTile:Fe,rawData:ye,cacheControl:ge,expires:Pe})}catch(Fe){const Ne=new Uint8Array(ye);let Xe=`Unable to parse the tile at ${ne.request.url}, `;Xe+=Ne[0]===31&&Ne[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Fe.messge}`,X(new Error(Xe))}});return()=>{ie.cancel(),X()}}class be{constructor(X,ie,de,ye){this.actor=X,this.layerIndex=ie,this.availableImages=de,this.loadVectorData=ye||ue,this.fetching={},this.loading={},this.loaded={}}loadTile(X,ie){const de=X.uid;this.loading||(this.loading={});const ye=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bu(X.request),ge=this.loading[de]=new he(X);ge.abort=this.loadVectorData(X,(Pe,Fe)=>{if(delete this.loading[de],Pe||!Fe)return ge.status="done",this.loaded[de]=ge,ie(Pe);const Ne=Fe.rawData,Xe={};Fe.expires&&(Xe.expires=Fe.expires),Fe.cacheControl&&(Xe.cacheControl=Fe.cacheControl);const Ye={};if(ye){const De=ye.finish();De&&(Ye.resourceTiming=JSON.parse(JSON.stringify(De)))}ge.vectorTile=Fe.vectorTile,ge.parse(Fe.vectorTile,this.layerIndex,this.availableImages,this.actor,(De,Ue)=>{if(delete this.fetching[de],De||!Ue)return ie(De);ie(null,a.e({rawTileData:Ne.slice(0)},Ue,Xe,Ye))}),this.loaded=this.loaded||{},this.loaded[de]=ge,this.fetching[de]={rawTileData:Ne,cacheControl:Xe,resourceTiming:Ye}})}reloadTile(X,ie){const de=this.loaded,ye=X.uid;if(de&&de[ye]){const ge=de[ye];ge.showCollisionBoxes=X.showCollisionBoxes,ge.status==="parsing"?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,(Pe,Fe)=>{if(Pe||!Fe)return ie(Pe,Fe);let Ne;if(this.fetching[ye]){const{rawTileData:Xe,cacheControl:Ye,resourceTiming:De}=this.fetching[ye];delete this.fetching[ye],Ne=a.e({rawTileData:Xe.slice(0)},Fe,Ye,De)}else Ne=Fe;ie(null,Ne)}):ge.status==="done"&&(ge.vectorTile?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,ie):ie())}}abortTile(X,ie){const de=this.loading,ye=X.uid;de&&de[ye]&&de[ye].abort&&(de[ye].abort(),delete de[ye]),ie()}removeTile(X,ie){const de=this.loaded,ye=X.uid;de&&de[ye]&&delete de[ye],ie()}}class Ke{constructor(){this.loaded={}}loadTile(X,ie){return a._(this,void 0,void 0,function*(){const{uid:de,encoding:ye,rawImageData:ge,redFactor:Pe,greenFactor:Fe,blueFactor:Ne,baseShift:Xe}=X,Ye=ge.width+2,De=ge.height+2,Ue=a.a(ge)?new a.R({width:Ye,height:De},yield a.bx(ge,-1,-1,Ye,De)):ge,ht=new a.by(de,Ue,ye,Pe,Fe,Ne,Xe);this.loaded=this.loaded||{},this.loaded[de]=ht,ie(null,ht)})}removeTile(X){const ie=this.loaded,de=X.uid;ie&&ie[de]&&delete ie[de]}}function ot(ne,X){if(ne.length!==0){tt(ne[0],X);for(var ie=1;ie<ne.length;ie++)tt(ne[ie],!X)}}function tt(ne,X){for(var ie=0,de=0,ye=0,ge=ne.length,Pe=ge-1;ye<ge;Pe=ye++){var Fe=(ne[ye][0]-ne[Pe][0])*(ne[Pe][1]+ne[ye][1]),Ne=ie+Fe;de+=Math.abs(ie)>=Math.abs(Fe)?ie-Ne+Fe:Fe-Ne+ie,ie=Ne}ie+de>=0!=!!X&&ne.reverse()}var lt=a.bz(function ne(X,ie){var de,ye=X&&X.type;if(ye==="FeatureCollection")for(de=0;de<X.features.length;de++)ne(X.features[de],ie);else if(ye==="GeometryCollection")for(de=0;de<X.geometries.length;de++)ne(X.geometries[de],ie);else if(ye==="Feature")ne(X.geometry,ie);else if(ye==="Polygon")ot(X.coordinates,ie);else if(ye==="MultiPolygon")for(de=0;de<X.coordinates.length;de++)ot(X.coordinates[de],ie);return X});const ut=a.bw.VectorTileFeature.prototype.toGeoJSON;var Tt={exports:{}},Pt=a.bA,zt=a.bw.VectorTileFeature,Ge=Xt;function Xt(ne,X){this.options=X||{},this.features=ne,this.length=ne.length}function rt(ne,X){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=X||4096}Xt.prototype.feature=function(ne){return new rt(this.features[ne],this.options.extent)},rt.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var X=0;X<ne.length;X++){for(var ie=ne[X],de=[],ye=0;ye<ie.length;ye++)de.push(new Pt(ie[ye][0],ie[ye][1]));this.geometry.push(de)}return this.geometry},rt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,X=1/0,ie=-1/0,de=1/0,ye=-1/0,ge=0;ge<ne.length;ge++)for(var Pe=ne[ge],Fe=0;Fe<Pe.length;Fe++){var Ne=Pe[Fe];X=Math.min(X,Ne.x),ie=Math.max(ie,Ne.x),de=Math.min(de,Ne.y),ye=Math.max(ye,Ne.y)}return[X,de,ie,ye]},rt.prototype.toGeoJSON=zt.prototype.toGeoJSON;var yt=a.bB,pt=Ge;function gt(ne){var X=new yt;return function(ie,de){for(var ye in ie.layers)de.writeMessage(3,bt,ie.layers[ye])}(ne,X),X.finish()}function bt(ne,X){var ie;X.writeVarintField(15,ne.version||1),X.writeStringField(1,ne.name||""),X.writeVarintField(5,ne.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(ie=0;ie<ne.length;ie++)de.feature=ne.feature(ie),X.writeMessage(2,dt,de);var ye=de.keys;for(ie=0;ie<ye.length;ie++)X.writeStringField(3,ye[ie]);var ge=de.values;for(ie=0;ie<ge.length;ie++)X.writeMessage(4,Rt,ge[ie])}function dt(ne,X){var ie=ne.feature;ie.id!==void 0&&X.writeVarintField(1,ie.id),X.writeMessage(2,$e,ne),X.writeVarintField(3,ie.type),X.writeMessage(4,Nt,ie)}function $e(ne,X){var ie=ne.feature,de=ne.keys,ye=ne.values,ge=ne.keycache,Pe=ne.valuecache;for(var Fe in ie.properties){var Ne=ie.properties[Fe],Xe=ge[Fe];if(Ne!==null){Xe===void 0&&(de.push(Fe),ge[Fe]=Xe=de.length-1),X.writeVarint(Xe);var Ye=typeof Ne;Ye!=="string"&&Ye!=="boolean"&&Ye!=="number"&&(Ne=JSON.stringify(Ne));var De=Ye+":"+Ne,Ue=Pe[De];Ue===void 0&&(ye.push(Ne),Pe[De]=Ue=ye.length-1),X.writeVarint(Ue)}}}function mt(ne,X){return(X<<3)+(7&ne)}function st(ne){return ne<<1^ne>>31}function Nt(ne,X){for(var ie=ne.loadGeometry(),de=ne.type,ye=0,ge=0,Pe=ie.length,Fe=0;Fe<Pe;Fe++){var Ne=ie[Fe],Xe=1;de===1&&(Xe=Ne.length),X.writeVarint(mt(1,Xe));for(var Ye=de===3?Ne.length-1:Ne.length,De=0;De<Ye;De++){De===1&&de!==1&&X.writeVarint(mt(2,Ye-1));var Ue=Ne[De].x-ye,ht=Ne[De].y-ge;X.writeVarint(st(Ue)),X.writeVarint(st(ht)),ye+=Ue,ge+=ht}de===3&&X.writeVarint(mt(7,1))}}function Rt(ne,X){var ie=typeof ne;ie==="string"?X.writeStringField(1,ne):ie==="boolean"?X.writeBooleanField(7,ne):ie==="number"&&(ne%1!=0?X.writeDoubleField(3,ne):ne<0?X.writeSVarintField(6,ne):X.writeVarintField(5,ne))}Tt.exports=gt,Tt.exports.fromVectorTileJs=gt,Tt.exports.fromGeojsonVt=function(ne,X){X=X||{};var ie={};for(var de in ne)ie[de]=new pt(ne[de].features,X),ie[de].name=de,ie[de].version=X.version,ie[de].extent=X.extent;return gt({layers:ie})},Tt.exports.GeoJSONWrapper=pt;var Ot=a.bz(Tt.exports);const _i={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},Si=Math.fround||(Ti=new Float32Array(1),ne=>(Ti[0]=+ne,Ti[0]));var Ti;const Oi=3,tn=5,qi=6;class Ni{constructor(X){this.options=Object.assign(Object.create(_i),X),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(X){const{log:ie,minZoom:de,maxZoom:ye}=this.options;ie&&console.time("total time");const ge=`prepare ${X.length} points`;ie&&console.time(ge),this.points=X;const Pe=[];for(let Ne=0;Ne<X.length;Ne++){const Xe=X[Ne];if(!Xe.geometry)continue;const[Ye,De]=Xe.geometry.coordinates,Ue=Si(Ci(Ye)),ht=Si(gi(De));Pe.push(Ue,ht,1/0,Ne,-1,1),this.options.reduce&&Pe.push(0)}let Fe=this.trees[ye+1]=this._createTree(Pe);ie&&console.timeEnd(ge);for(let Ne=ye;Ne>=de;Ne--){const Xe=+Date.now();Fe=this.trees[Ne]=this._createTree(this._cluster(Fe,Ne)),ie&&console.log("z%d: %d clusters in %dms",Ne,Fe.numItems,+Date.now()-Xe)}return ie&&console.timeEnd("total time"),this}getClusters(X,ie){let de=((X[0]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,X[1]));let ge=X[2]===180?180:((X[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)de=-180,ge=180;else if(de>ge){const De=this.getClusters([de,ye,180,Pe],ie),Ue=this.getClusters([-180,ye,ge,Pe],ie);return De.concat(Ue)}const Fe=this.trees[this._limitZoom(ie)],Ne=Fe.range(Ci(de),gi(Pe),Ci(ge),gi(ye)),Xe=Fe.data,Ye=[];for(const De of Ne){const Ue=this.stride*De;Ye.push(Xe[Ue+tn]>1?nn(Xe,Ue,this.clusterProps):this.points[Xe[Ue+Oi]])}return Ye}getChildren(X){const ie=this._getOriginId(X),de=this._getOriginZoom(X),ye="No cluster with the specified id.",ge=this.trees[de];if(!ge)throw new Error(ye);const Pe=ge.data;if(ie*this.stride>=Pe.length)throw new Error(ye);const Fe=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Ne=ge.within(Pe[ie*this.stride],Pe[ie*this.stride+1],Fe),Xe=[];for(const Ye of Ne){const De=Ye*this.stride;Pe[De+4]===X&&Xe.push(Pe[De+tn]>1?nn(Pe,De,this.clusterProps):this.points[Pe[De+Oi]])}if(Xe.length===0)throw new Error(ye);return Xe}getLeaves(X,ie,de){const ye=[];return this._appendLeaves(ye,X,ie=ie||10,de=de||0,0),ye}getTile(X,ie,de){const ye=this.trees[this._limitZoom(X)],ge=Math.pow(2,X),{extent:Pe,radius:Fe}=this.options,Ne=Fe/Pe,Xe=(de-Ne)/ge,Ye=(de+1+Ne)/ge,De={features:[]};return this._addTileFeatures(ye.range((ie-Ne)/ge,Xe,(ie+1+Ne)/ge,Ye),ye.data,ie,de,ge,De),ie===0&&this._addTileFeatures(ye.range(1-Ne/ge,Xe,1,Ye),ye.data,ge,de,ge,De),ie===ge-1&&this._addTileFeatures(ye.range(0,Xe,Ne/ge,Ye),ye.data,-1,de,ge,De),De.features.length?De:null}getClusterExpansionZoom(X){let ie=this._getOriginZoom(X)-1;for(;ie<=this.options.maxZoom;){const de=this.getChildren(X);if(ie++,de.length!==1)break;X=de[0].properties.cluster_id}return ie}_appendLeaves(X,ie,de,ye,ge){const Pe=this.getChildren(ie);for(const Fe of Pe){const Ne=Fe.properties;if(Ne&&Ne.cluster?ge+Ne.point_count<=ye?ge+=Ne.point_count:ge=this._appendLeaves(X,Ne.cluster_id,de,ye,ge):ge<ye?ge++:X.push(Fe),X.length===de)break}return ge}_createTree(X){const ie=new a.av(X.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<X.length;de+=this.stride)ie.add(X[de],X[de+1]);return ie.finish(),ie.data=X,ie}_addTileFeatures(X,ie,de,ye,ge,Pe){for(const Fe of X){const Ne=Fe*this.stride,Xe=ie[Ne+tn]>1;let Ye,De,Ue;if(Xe)Ye=yn(ie,Ne,this.clusterProps),De=ie[Ne],Ue=ie[Ne+1];else{const o=this.points[ie[Ne+Oi]];Ye=o.properties;const[ke,oi]=o.geometry.coordinates;De=Ci(ke),Ue=gi(oi)}const ht={type:1,geometry:[[Math.round(this.options.extent*(De*ge-de)),Math.round(this.options.extent*(Ue*ge-ye))]],tags:Ye};let kt;kt=Xe||this.options.generateId?ie[Ne+Oi]:this.points[ie[Ne+Oi]].id,kt!==void 0&&(ht.id=kt),Pe.features.push(ht)}}_limitZoom(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))}_cluster(X,ie){const{radius:de,extent:ye,reduce:ge,minPoints:Pe}=this.options,Fe=de/(ye*Math.pow(2,ie)),Ne=X.data,Xe=[],Ye=this.stride;for(let De=0;De<Ne.length;De+=Ye){if(Ne[De+2]<=ie)continue;Ne[De+2]=ie;const Ue=Ne[De],ht=Ne[De+1],kt=X.within(Ne[De],Ne[De+1],Fe),o=Ne[De+tn];let ke=o;for(const oi of kt){const di=oi*Ye;Ne[di+2]>ie&&(ke+=Ne[di+tn])}if(ke>o&&ke>=Pe){let oi,di=Ue*o,Ai=ht*o,Jt=-1;const li=((De/Ye|0)<<5)+(ie+1)+this.points.length;for(const zi of kt){const vi=zi*Ye;if(Ne[vi+2]<=ie)continue;Ne[vi+2]=ie;const wi=Ne[vi+tn];di+=Ne[vi]*wi,Ai+=Ne[vi+1]*wi,Ne[vi+4]=li,ge&&(oi||(oi=this._map(Ne,De,!0),Jt=this.clusterProps.length,this.clusterProps.push(oi)),ge(oi,this._map(Ne,vi)))}Ne[De+4]=li,Xe.push(di/ke,Ai/ke,1/0,li,-1,ke),ge&&Xe.push(Jt)}else{for(let oi=0;oi<Ye;oi++)Xe.push(Ne[De+oi]);if(ke>1)for(const oi of kt){const di=oi*Ye;if(!(Ne[di+2]<=ie)){Ne[di+2]=ie;for(let Ai=0;Ai<Ye;Ai++)Xe.push(Ne[di+Ai])}}}}return Xe}_getOriginId(X){return X-this.points.length>>5}_getOriginZoom(X){return(X-this.points.length)%32}_map(X,ie,de){if(X[ie+tn]>1){const Pe=this.clusterProps[X[ie+qi]];return de?Object.assign({},Pe):Pe}const ye=this.points[X[ie+Oi]].properties,ge=this.options.map(ye);return de&&ge===ye?Object.assign({},ge):ge}}function nn(ne,X,ie){return{type:"Feature",id:ne[X+Oi],properties:yn(ne,X,ie),geometry:{type:"Point",coordinates:[(de=ne[X],360*(de-.5)),Ri(ne[X+1])]}};var de}function yn(ne,X,ie){const de=ne[X+tn],ye=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,ge=ne[X+qi],Pe=ge===-1?{}:Object.assign({},ie[ge]);return Object.assign(Pe,{cluster:!0,cluster_id:ne[X+Oi],point_count:de,point_count_abbreviated:ye})}function Ci(ne){return ne/360+.5}function gi(ne){const X=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return ie<0?0:ie>1?1:ie}function Ri(ne){const X=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function ai(ne,X,ie,de){for(var ye,ge=de,Pe=ie-X>>1,Fe=ie-X,Ne=ne[X],Xe=ne[X+1],Ye=ne[ie],De=ne[ie+1],Ue=X+3;Ue<ie;Ue+=3){var ht=Ki(ne[Ue],ne[Ue+1],Ne,Xe,Ye,De);if(ht>ge)ye=Ue,ge=ht;else if(ht===ge){var kt=Math.abs(Ue-Pe);kt<Fe&&(ye=Ue,Fe=kt)}}ge>de&&(ye-X>3&&ai(ne,X,ye,de),ne[ye+2]=ge,ie-ye>3&&ai(ne,ye,ie,de))}function Ki(ne,X,ie,de,ye,ge){var Pe=ye-ie,Fe=ge-de;if(Pe!==0||Fe!==0){var Ne=((ne-ie)*Pe+(X-de)*Fe)/(Pe*Pe+Fe*Fe);Ne>1?(ie=ye,de=ge):Ne>0&&(ie+=Pe*Ne,de+=Fe*Ne)}return(Pe=ne-ie)*Pe+(Fe=X-de)*Fe}function Ji(ne,X,ie,de){var ye={id:ne===void 0?null:ne,type:X,geometry:ie,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Pe=ge.geometry,Fe=ge.type;if(Fe==="Point"||Fe==="MultiPoint"||Fe==="LineString")fi(ge,Pe);else if(Fe==="Polygon"||Fe==="MultiLineString")for(var Ne=0;Ne<Pe.length;Ne++)fi(ge,Pe[Ne]);else if(Fe==="MultiPolygon")for(Ne=0;Ne<Pe.length;Ne++)for(var Xe=0;Xe<Pe[Ne].length;Xe++)fi(ge,Pe[Ne][Xe])}(ye),ye}function fi(ne,X){for(var ie=0;ie<X.length;ie+=3)ne.minX=Math.min(ne.minX,X[ie]),ne.minY=Math.min(ne.minY,X[ie+1]),ne.maxX=Math.max(ne.maxX,X[ie]),ne.maxY=Math.max(ne.maxY,X[ie+1])}function pn(ne,X,ie,de){if(X.geometry){var ye=X.geometry.coordinates,ge=X.geometry.type,Pe=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2),Fe=[],Ne=X.id;if(ie.promoteId?Ne=X.properties[ie.promoteId]:ie.generateId&&(Ne=de||0),ge==="Point")ii(ye,Fe);else if(ge==="MultiPoint")for(var Xe=0;Xe<ye.length;Xe++)ii(ye[Xe],Fe);else if(ge==="LineString")wn(ye,Fe,Pe,!1);else if(ge==="MultiLineString"){if(ie.lineMetrics){for(Xe=0;Xe<ye.length;Xe++)wn(ye[Xe],Fe=[],Pe,!1),ne.push(Ji(Ne,"LineString",Fe,X.properties));return}Rr(ye,Fe,Pe,!1)}else if(ge==="Polygon")Rr(ye,Fe,Pe,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Xe=0;Xe<X.geometry.geometries.length;Xe++)pn(ne,{id:Ne,geometry:X.geometry.geometries[Xe],properties:X.properties},ie,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Xe=0;Xe<ye.length;Xe++){var Ye=[];Rr(ye[Xe],Ye,Pe,!0),Fe.push(Ye)}}ne.push(Ji(Ne,ge,Fe,X.properties))}}function ii(ne,X){X.push(hi(ne[0])),X.push(en(ne[1])),X.push(0)}function wn(ne,X,ie,de){for(var ye,ge,Pe=0,Fe=0;Fe<ne.length;Fe++){var Ne=hi(ne[Fe][0]),Xe=en(ne[Fe][1]);X.push(Ne),X.push(Xe),X.push(0),Fe>0&&(Pe+=de?(ye*Xe-Ne*ge)/2:Math.sqrt(Math.pow(Ne-ye,2)+Math.pow(Xe-ge,2))),ye=Ne,ge=Xe}var Ye=X.length-3;X[2]=1,ai(X,0,Ye,ie),X[Ye+2]=1,X.size=Math.abs(Pe),X.start=0,X.end=X.size}function Rr(ne,X,ie,de){for(var ye=0;ye<ne.length;ye++){var ge=[];wn(ne[ye],ge,ie,de),X.push(ge)}}function hi(ne){return ne/360+.5}function en(ne){var X=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return ie<0?0:ie>1?1:ie}function tr(ne,X,ie,de,ye,ge,Pe,Fe){if(de/=X,ge>=(ie/=X)&&Pe<de)return ne;if(Pe<ie||ge>=de)return null;for(var Ne=[],Xe=0;Xe<ne.length;Xe++){var Ye=ne[Xe],De=Ye.geometry,Ue=Ye.type,ht=ye===0?Ye.minX:Ye.minY,kt=ye===0?Ye.maxX:Ye.maxY;if(ht>=ie&&kt<de)Ne.push(Ye);else if(!(kt<ie||ht>=de)){var o=[];if(Ue==="Point"||Ue==="MultiPoint")Fn(De,o,ie,de,ye);else if(Ue==="LineString")Qn(De,o,ie,de,ye,!1,Fe.lineMetrics);else if(Ue==="MultiLineString")v(De,o,ie,de,ye,!1);else if(Ue==="Polygon")v(De,o,ie,de,ye,!0);else if(Ue==="MultiPolygon")for(var ke=0;ke<De.length;ke++){var oi=[];v(De[ke],oi,ie,de,ye,!0),oi.length&&o.push(oi)}if(o.length){if(Fe.lineMetrics&&Ue==="LineString"){for(ke=0;ke<o.length;ke++)Ne.push(Ji(Ye.id,Ue,o[ke],Ye.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(o.length===1?(Ue="LineString",o=o[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=o.length===3?"Point":"MultiPoint"),Ne.push(Ji(Ye.id,Ue,o,Ye.tags))}}}return Ne.length?Ne:null}function Fn(ne,X,ie,de,ye){for(var ge=0;ge<ne.length;ge+=3){var Pe=ne[ge+ye];Pe>=ie&&Pe<=de&&(X.push(ne[ge]),X.push(ne[ge+1]),X.push(ne[ge+2]))}}function Qn(ne,X,ie,de,ye,ge,Pe){for(var Fe,Ne,Xe=In(ne),Ye=ye===0?V:$,De=ne.start,Ue=0;Ue<ne.length-3;Ue+=3){var ht=ne[Ue],kt=ne[Ue+1],o=ne[Ue+2],ke=ne[Ue+3],oi=ne[Ue+4],di=ye===0?ht:kt,Ai=ye===0?ke:oi,Jt=!1;Pe&&(Fe=Math.sqrt(Math.pow(ht-ke,2)+Math.pow(kt-oi,2))),di<ie?Ai>ie&&(Ne=Ye(Xe,ht,kt,ke,oi,ie),Pe&&(Xe.start=De+Fe*Ne)):di>de?Ai<de&&(Ne=Ye(Xe,ht,kt,ke,oi,de),Pe&&(Xe.start=De+Fe*Ne)):k(Xe,ht,kt,o),Ai<ie&&di>=ie&&(Ne=Ye(Xe,ht,kt,ke,oi,ie),Jt=!0),Ai>de&&di<=de&&(Ne=Ye(Xe,ht,kt,ke,oi,de),Jt=!0),!ge&&Jt&&(Pe&&(Xe.end=De+Fe*Ne),X.push(Xe),Xe=In(ne)),Pe&&(De+=Fe)}var li=ne.length-3;ht=ne[li],kt=ne[li+1],o=ne[li+2],(di=ye===0?ht:kt)>=ie&&di<=de&&k(Xe,ht,kt,o),li=Xe.length-3,ge&&li>=3&&(Xe[li]!==Xe[0]||Xe[li+1]!==Xe[1])&&k(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&X.push(Xe)}function In(ne){var X=[];return X.size=ne.size,X.start=ne.start,X.end=ne.end,X}function v(ne,X,ie,de,ye,ge){for(var Pe=0;Pe<ne.length;Pe++)Qn(ne[Pe],X,ie,de,ye,ge,!1)}function k(ne,X,ie,de){ne.push(X),ne.push(ie),ne.push(de)}function V(ne,X,ie,de,ye,ge){var Pe=(ge-X)/(de-X);return ne.push(ge),ne.push(ie+(ye-ie)*Pe),ne.push(1),Pe}function $(ne,X,ie,de,ye,ge){var Pe=(ge-ie)/(ye-ie);return ne.push(X+(de-X)*Pe),ne.push(ge),ne.push(1),Pe}function te(ne,X){for(var ie=[],de=0;de<ne.length;de++){var ye,ge=ne[de],Pe=ge.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")ye=fe(ge.geometry,X);else if(Pe==="MultiLineString"||Pe==="Polygon"){ye=[];for(var Fe=0;Fe<ge.geometry.length;Fe++)ye.push(fe(ge.geometry[Fe],X))}else if(Pe==="MultiPolygon")for(ye=[],Fe=0;Fe<ge.geometry.length;Fe++){for(var Ne=[],Xe=0;Xe<ge.geometry[Fe].length;Xe++)Ne.push(fe(ge.geometry[Fe][Xe],X));ye.push(Ne)}ie.push(Ji(ge.id,Pe,ye,ge.tags))}return ie}function fe(ne,X){var ie=[];ie.size=ne.size,ne.start!==void 0&&(ie.start=ne.start,ie.end=ne.end);for(var de=0;de<ne.length;de+=3)ie.push(ne[de]+X,ne[de+1],ne[de+2]);return ie}function ve(ne,X){if(ne.transformed)return ne;var ie,de,ye,ge=1<<ne.z,Pe=ne.x,Fe=ne.y;for(ie=0;ie<ne.features.length;ie++){var Ne=ne.features[ie],Xe=Ne.geometry,Ye=Ne.type;if(Ne.geometry=[],Ye===1)for(de=0;de<Xe.length;de+=2)Ne.geometry.push(Ie(Xe[de],Xe[de+1],X,ge,Pe,Fe));else for(de=0;de<Xe.length;de++){var De=[];for(ye=0;ye<Xe[de].length;ye+=2)De.push(Ie(Xe[de][ye],Xe[de][ye+1],X,ge,Pe,Fe));Ne.geometry.push(De)}}return ne.transformed=!0,ne}function Ie(ne,X,ie,de,ye,ge){return[Math.round(ie*(ne*de-ye)),Math.round(ie*(X*de-ge))]}function Ee(ne,X,ie,de,ye){for(var ge=X===ye.maxZoom?0:ye.tolerance/((1<<X)*ye.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ie,y:de,z:X,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Fe=0;Fe<ne.length;Fe++){Pe.numFeatures++,ze(Pe,ne[Fe],ge,ye);var Ne=ne[Fe].minX,Xe=ne[Fe].minY,Ye=ne[Fe].maxX,De=ne[Fe].maxY;Ne<Pe.minX&&(Pe.minX=Ne),Xe<Pe.minY&&(Pe.minY=Xe),Ye>Pe.maxX&&(Pe.maxX=Ye),De>Pe.maxY&&(Pe.maxY=De)}return Pe}function ze(ne,X,ie,de){var ye=X.geometry,ge=X.type,Pe=[];if(ge==="Point"||ge==="MultiPoint")for(var Fe=0;Fe<ye.length;Fe+=3)Pe.push(ye[Fe]),Pe.push(ye[Fe+1]),ne.numPoints++,ne.numSimplified++;else if(ge==="LineString")Qe(Pe,ye,ne,ie,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(Fe=0;Fe<ye.length;Fe++)Qe(Pe,ye[Fe],ne,ie,ge==="Polygon",Fe===0);else if(ge==="MultiPolygon")for(var Ne=0;Ne<ye.length;Ne++){var Xe=ye[Ne];for(Fe=0;Fe<Xe.length;Fe++)Qe(Pe,Xe[Fe],ne,ie,!0,Fe===0)}if(Pe.length){var Ye=X.tags||null;if(ge==="LineString"&&de.lineMetrics){for(var De in Ye={},X.tags)Ye[De]=X.tags[De];Ye.mapbox_clip_start=ye.start/ye.size,Ye.mapbox_clip_end=ye.end/ye.size}var Ue={geometry:Pe,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:Ye};X.id!==null&&(Ue.id=X.id),ne.features.push(Ue)}}function Qe(ne,X,ie,de,ye,ge){var Pe=de*de;if(de>0&&X.size<(ye?Pe:de))ie.numPoints+=X.length/3;else{for(var Fe=[],Ne=0;Ne<X.length;Ne+=3)(de===0||X[Ne+2]>Pe)&&(ie.numSimplified++,Fe.push(X[Ne]),Fe.push(X[Ne+1])),ie.numPoints++;ye&&function(Xe,Ye){for(var De=0,Ue=0,ht=Xe.length,kt=ht-2;Ue<ht;kt=Ue,Ue+=2)De+=(Xe[Ue]-Xe[kt])*(Xe[Ue+1]+Xe[kt+1]);if(De>0===Ye)for(Ue=0,ht=Xe.length;Ue<ht/2;Ue+=2){var o=Xe[Ue],ke=Xe[Ue+1];Xe[Ue]=Xe[ht-2-Ue],Xe[Ue+1]=Xe[ht-1-Ue],Xe[ht-2-Ue]=o,Xe[ht-1-Ue]=ke}}(Fe,ge),ne.push(Fe)}}function He(ne,X){var ie=(X=this.options=function(ye,ge){for(var Pe in ge)ye[Pe]=ge[Pe];return ye}(Object.create(this.options),X)).debug;if(ie&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");var de=function(ye,ge){var Pe=[];if(ye.type==="FeatureCollection")for(var Fe=0;Fe<ye.features.length;Fe++)pn(Pe,ye.features[Fe],ge,Fe);else pn(Pe,ye.type==="Feature"?ye:{geometry:ye},ge);return Pe}(ne,X);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(ye,ge){var Pe=ge.buffer/ge.extent,Fe=ye,Ne=tr(ye,1,-1-Pe,Pe,0,-1,2,ge),Xe=tr(ye,1,1-Pe,2+Pe,0,-1,2,ge);return(Ne||Xe)&&(Fe=tr(ye,1,-Pe,1+Pe,0,-1,2,ge)||[],Ne&&(Fe=te(Ne,1).concat(Fe)),Xe&&(Fe=Fe.concat(te(Xe,-1)))),Fe}(de,X),de.length&&this.splitTile(de,0,0,0),ie&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ze(ne,X,ie){return 32*((1<<ne)*ie+X)+ne}function Ve(ne,X){return X?ne.properties[X]:ne.id}function ft(ne,X){if(ne==null)return!0;if(ne.type==="Feature")return Ve(ne,X)!=null;if(ne.type==="FeatureCollection"){const ie=new Set;for(const de of ne.features){const ye=Ve(de,X);if(ye==null||ie.has(ye))return!1;ie.add(ye)}return!0}return!1}function nt(ne,X){const ie=new Map;if(ne!=null)if(ne.type==="Feature")ie.set(Ve(ne,X),ne);else for(const de of ne.features)ie.set(Ve(de,X),de);return ie}He.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},He.prototype.splitTile=function(ne,X,ie,de,ye,ge,Pe){for(var Fe=[ne,X,ie,de],Ne=this.options,Xe=Ne.debug;Fe.length;){de=Fe.pop(),ie=Fe.pop(),X=Fe.pop(),ne=Fe.pop();var Ye=1<<X,De=Ze(X,ie,de),Ue=this.tiles[De];if(!Ue&&(Xe>1&&console.time("creation"),Ue=this.tiles[De]=Ee(ne,X,ie,de,Ne),this.tileCoords.push({z:X,x:ie,y:de}),Xe)){Xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,ie,de,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var ht="z"+X;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if(Ue.source=ne,ye){if(X===Ne.maxZoom||X===ye)continue;var kt=1<<ye-X;if(ie!==Math.floor(ge/kt)||de!==Math.floor(Pe/kt))continue}else if(X===Ne.indexMaxZoom||Ue.numPoints<=Ne.indexMaxPoints)continue;if(Ue.source=null,ne.length!==0){Xe>1&&console.time("clipping");var o,ke,oi,di,Ai,Jt,li=.5*Ne.buffer/Ne.extent,zi=.5-li,vi=.5+li,wi=1+li;o=ke=oi=di=null,Ai=tr(ne,Ye,ie-li,ie+vi,0,Ue.minX,Ue.maxX,Ne),Jt=tr(ne,Ye,ie+zi,ie+wi,0,Ue.minX,Ue.maxX,Ne),ne=null,Ai&&(o=tr(Ai,Ye,de-li,de+vi,1,Ue.minY,Ue.maxY,Ne),ke=tr(Ai,Ye,de+zi,de+wi,1,Ue.minY,Ue.maxY,Ne),Ai=null),Jt&&(oi=tr(Jt,Ye,de-li,de+vi,1,Ue.minY,Ue.maxY,Ne),di=tr(Jt,Ye,de+zi,de+wi,1,Ue.minY,Ue.maxY,Ne),Jt=null),Xe>1&&console.timeEnd("clipping"),Fe.push(o||[],X+1,2*ie,2*de),Fe.push(ke||[],X+1,2*ie,2*de+1),Fe.push(oi||[],X+1,2*ie+1,2*de),Fe.push(di||[],X+1,2*ie+1,2*de+1)}}},He.prototype.getTile=function(ne,X,ie){var de=this.options,ye=de.extent,ge=de.debug;if(ne<0||ne>24)return null;var Pe=1<<ne,Fe=Ze(ne,X=(X%Pe+Pe)%Pe,ie);if(this.tiles[Fe])return ve(this.tiles[Fe],ye);ge>1&&console.log("drilling down to z%d-%d-%d",ne,X,ie);for(var Ne,Xe=ne,Ye=X,De=ie;!Ne&&Xe>0;)Xe--,Ye=Math.floor(Ye/2),De=Math.floor(De/2),Ne=this.tiles[Ze(Xe,Ye,De)];return Ne&&Ne.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Xe,Ye,De),ge>1&&console.time("drilling down"),this.splitTile(Ne.source,Xe,Ye,De,ne,X,ie),ge>1&&console.timeEnd("drilling down"),this.tiles[Fe]?ve(this.tiles[Fe],ye):null):null};class Me extends be{constructor(X,ie,de,ye){super(X,ie,de),this._dataUpdateable=new Map,this.loadGeoJSON=(ge,Pe)=>{const{promoteId:Fe}=ge;if(ge.request)return a.f(ge.request,(Ne,Xe,Ye,De)=>{this._dataUpdateable=ft(Xe,Fe)?nt(Xe,Fe):void 0,Pe(Ne,Xe,Ye,De)});if(typeof ge.data=="string")try{const Ne=JSON.parse(ge.data);this._dataUpdateable=ft(Ne,Fe)?nt(Ne,Fe):void 0,Pe(null,Ne)}catch{Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}else ge.dataDiff?this._dataUpdateable?(function(Ne,Xe,Ye){var De,Ue,ht,kt;if(Xe.removeAll&&Ne.clear(),Xe.remove)for(const o of Xe.remove)Ne.delete(o);if(Xe.add)for(const o of Xe.add){const ke=Ve(o,Ye);ke!=null&&Ne.set(ke,o)}if(Xe.update)for(const o of Xe.update){let ke=Ne.get(o.id);if(ke==null)continue;const oi=!o.removeAllProperties&&(((De=o.removeProperties)===null||De===void 0?void 0:De.length)>0||((Ue=o.addOrUpdateProperties)===null||Ue===void 0?void 0:Ue.length)>0);if((o.newGeometry||o.removeAllProperties||oi)&&(ke=Object.assign({},ke),Ne.set(o.id,ke),oi&&(ke.properties=Object.assign({},ke.properties))),o.newGeometry&&(ke.geometry=o.newGeometry),o.removeAllProperties)ke.properties={};else if(((ht=o.removeProperties)===null||ht===void 0?void 0:ht.length)>0)for(const di of o.removeProperties)Object.prototype.hasOwnProperty.call(ke.properties,di)&&delete ke.properties[di];if(((kt=o.addOrUpdateProperties)===null||kt===void 0?void 0:kt.length)>0)for(const{key:di,value:Ai}of o.addOrUpdateProperties)ke.properties[di]=Ai}}(this._dataUpdateable,ge.dataDiff,Fe),Pe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Pe(new Error(`Cannot update existing geojson data in ${ge.source}`)):Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,ye&&(this.loadGeoJSON=ye)}loadGeoJSONTile(X,ie){const de=X.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);const ye=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!ye)return ie(null,null);const ge=new class{constructor(Fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.N,this.length=Fe.length,this._features=Fe}feature(Fe){return new class{constructor(Ne){this._feature=Ne,this.extent=a.N,this.type=Ne.type,this.properties=Ne.tags,"id"in Ne&&!isNaN(Ne.id)&&(this.id=parseInt(Ne.id,10))}loadGeometry(){if(this._feature.type===1){const Ne=[];for(const Xe of this._feature.geometry)Ne.push([new a.P(Xe[0],Xe[1])]);return Ne}{const Ne=[];for(const Xe of this._feature.geometry){const Ye=[];for(const De of Xe)Ye.push(new a.P(De[0],De[1]));Ne.push(Ye)}return Ne}}toGeoJSON(Ne,Xe,Ye){return ut.call(this,Ne,Xe,Ye)}}(this._features[Fe])}}(ye.features);let Pe=Ot(ge);Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),ie(null,{vectorTile:ge,rawData:Pe.buffer})}loadData(X,ie){var de;(de=this._pendingRequest)===null||de===void 0||de.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ye=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bu(X.request);this._pendingCallback=ie,this._pendingRequest=this.loadGeoJSON(X,(ge,Pe)=>{if(delete this._pendingCallback,delete this._pendingRequest,ge||!Pe)return ie(ge);if(typeof Pe!="object")return ie(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));{lt(Pe,!0);try{if(X.filter){const Ne=a.bC(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ne.result==="error")throw new Error(Ne.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));Pe={type:"FeatureCollection",features:Pe.features.filter(Ye=>Ne.value.evaluate({zoom:0},Ye))}}this._geoJSONIndex=X.cluster?new Ni(function({superclusterOptions:Ne,clusterProperties:Xe}){if(!Xe||!Ne)return Ne;const Ye={},De={},Ue={accumulated:null,zoom:0},ht={properties:null},kt=Object.keys(Xe);for(const o of kt){const[ke,oi]=Xe[o],di=a.bC(oi),Ai=a.bC(typeof ke=="string"?[ke,["accumulated"],["get",o]]:ke);Ye[o]=di.value,De[o]=Ai.value}return Ne.map=o=>{ht.properties=o;const ke={};for(const oi of kt)ke[oi]=Ye[oi].evaluate(Ue,ht);return ke},Ne.reduce=(o,ke)=>{ht.properties=ke;for(const oi of kt)Ue.accumulated=o[oi],o[oi]=De[oi].evaluate(Ue,ht)},Ne}(X)).load(Pe.features):function(Ne,Xe){return new He(Ne,Xe)}(Pe,X.geojsonVtOptions)}catch(Ne){return ie(Ne)}this.loaded={};const Fe={};if(ye){const Ne=ye.finish();Ne&&(Fe.resourceTiming={},Fe.resourceTiming[X.source]=JSON.parse(JSON.stringify(Ne)))}ie(null,Fe)}})}reloadTile(X,ie){const de=this.loaded;return de&&de[X.uid]?super.reloadTile(X,ie):this.loadTile(X,ie)}removeSource(X,ie){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ie()}getClusterExpansionZoom(X,ie){try{ie(null,this._geoJSONIndex.getClusterExpansionZoom(X.clusterId))}catch(de){ie(de)}}getClusterChildren(X,ie){try{ie(null,this._geoJSONIndex.getChildren(X.clusterId))}catch(de){ie(de)}}getClusterLeaves(X,ie){try{ie(null,this._geoJSONIndex.getLeaves(X.clusterId,X.limit,X.offset))}catch(de){ie(de)}}}class se{constructor(X){this.self=X,this.actor=new a.C(X,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:be,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ie,de)=>{if(this.workerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.workerSourceTypes[ie]=de},this.self.registerRTLTextPlugin=ie=>{if(a.bD.isParsed())throw new Error("RTL text plugin already registered.");a.bD.applyArabicShaping=ie.applyArabicShaping,a.bD.processBidirectionalText=ie.processBidirectionalText,a.bD.processStyledBidirectionalText=ie.processStyledBidirectionalText}}setReferrer(X,ie){this.referrer=ie}setImages(X,ie,de){this.availableImages[X]=ie;for(const ye in this.workerSources[X]){const ge=this.workerSources[X][ye];for(const Pe in ge)ge[Pe].availableImages=ie}de()}setLayers(X,ie,de){this.getLayerIndex(X).replace(ie),de()}updateLayers(X,ie,de){this.getLayerIndex(X).update(ie.layers,ie.removedIds),de()}loadTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).loadTile(ie,de)}loadDEMTile(X,ie,de){this.getDEMWorkerSource(X,ie.source).loadTile(ie,de)}reloadTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).reloadTile(ie,de)}abortTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).abortTile(ie,de)}removeTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).removeTile(ie,de)}removeDEMTile(X,ie){this.getDEMWorkerSource(X,ie.source).removeTile(ie)}removeSource(X,ie,de){if(!this.workerSources[X]||!this.workerSources[X][ie.type]||!this.workerSources[X][ie.type][ie.source])return;const ye=this.workerSources[X][ie.type][ie.source];delete this.workerSources[X][ie.type][ie.source],ye.removeSource!==void 0?ye.removeSource(ie,de):de()}loadWorkerSource(X,ie,de){try{this.self.importScripts(ie.url),de()}catch(ye){de(ye.toString())}}syncRTLPluginState(X,ie,de){try{a.bD.setState(ie);const ye=a.bD.getPluginURL();if(a.bD.isLoaded()&&!a.bD.isParsed()&&ye!=null){this.self.importScripts(ye);const ge=a.bD.isParsed();de(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ye}`),ge)}}catch(ye){de(ye.toString())}}getAvailableImages(X){let ie=this.availableImages[X];return ie||(ie=[]),ie}getLayerIndex(X){let ie=this.layerIndexes[X];return ie||(ie=this.layerIndexes[X]=new G),ie}getWorkerSource(X,ie,de){return this.workerSources[X]||(this.workerSources[X]={}),this.workerSources[X][ie]||(this.workerSources[X][ie]={}),this.workerSources[X][ie][de]||(this.workerSources[X][ie][de]=new this.workerSourceTypes[ie]({send:(ye,ge,Pe)=>{this.actor.send(ye,ge,Pe,X)}},this.getLayerIndex(X),this.getAvailableImages(X))),this.workerSources[X][ie][de]}getDEMWorkerSource(X,ie){return this.demWorkerSources[X]||(this.demWorkerSources[X]={}),this.demWorkerSources[X][ie]||(this.demWorkerSources[X][ie]=new Ke),this.demWorkerSources[X][ie]}}return a.i()&&(self.worker=new se(self)),se}),b(["./shared"],function(a){var G="3.6.2";class W{static testProp(A){if(!W.docStyle)return A[0];for(let E=0;E<A.length;E++)if(A[E]in W.docStyle)return A[E];return A[0]}static create(A,E,F){const O=window.document.createElement(A);return E!==void 0&&(O.className=E),F&&F.appendChild(O),O}static createNS(A,E){return window.document.createElementNS(A,E)}static disableDrag(){W.docStyle&&W.selectProp&&(W.userSelect=W.docStyle[W.selectProp],W.docStyle[W.selectProp]="none")}static enableDrag(){W.docStyle&&W.selectProp&&(W.docStyle[W.selectProp]=W.userSelect)}static setTransform(A,E){A.style[W.transformProp]=E}static addEventListener(A,E,F,O={}){A.addEventListener(E,F,"passive"in O?O:O.capture)}static removeEventListener(A,E,F,O={}){A.removeEventListener(E,F,"passive"in O?O:O.capture)}static suppressClickInternal(A){A.preventDefault(),A.stopPropagation(),window.removeEventListener("click",W.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",W.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",W.suppressClickInternal,!0)},0)}static mousePos(A,E){const F=A.getBoundingClientRect();return new a.P(E.clientX-F.left-A.clientLeft,E.clientY-F.top-A.clientTop)}static touchPos(A,E){const F=A.getBoundingClientRect(),O=[];for(let y=0;y<E.length;y++)O.push(new a.P(E[y].clientX-F.left-A.clientLeft,E[y].clientY-F.top-A.clientTop));return O}static mouseButton(A){return A.button}static remove(A){A.parentNode&&A.parentNode.removeChild(A)}}W.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,W.selectProp=W.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),W.transformProp=W.testProp(["transform","WebkitTransform"]);const he={supported:!1,testSupport:function(Z){!be&&ue&&(Ke?ot(Z):ae=Z)}};let ae,ue,be=!1,Ke=!1;function ot(Z){const A=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,A);try{if(Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,Z.RGBA,Z.UNSIGNED_BYTE,ue),Z.isContextLost())return;he.supported=!0}catch{}Z.deleteTexture(A),be=!0}var tt,lt;typeof document<"u"&&(ue=document.createElement("img"),ue.onload=function(){ae&&ot(ae),ae=null,Ke=!0},ue.onerror=function(){be=!0,ae=null},ue.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(Z){let A,E,F,O;Z.resetRequestQueue=()=>{A=[],E=0,F=0,O={}},Z.addThrottleControl=l=>{const d=F++;return O[d]=l,d},Z.removeThrottleControl=l=>{delete O[l],i()},Z.getImage=(l,d,_=!0)=>{he.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*");const w={requestParameters:l,supportImageRefresh:_,callback:d,cancelled:!1,completed:!1,cancel:()=>{w.completed||w.cancelled||(w.cancelled=!0,w.innerRequest&&(w.innerRequest.cancel(),E--),i())}};return A.push(w),i(),w};const y=l=>{const{requestParameters:d,supportImageRefresh:_,callback:w}=l;return a.e(d,{type:"image"}),(_!==!1||a.i()||a.g(d.url)||d.headers&&!Object.keys(d.headers).reduce((T,B)=>T&&B==="accept",!0)?a.m:r)(d,(T,B,j,Y)=>{s(l,w,T,B,j,Y)})},s=(l,d,_,w,T,B)=>{_?d(_):w instanceof HTMLImageElement||a.a(w)?d(null,w):w&&((j,Y)=>{typeof createImageBitmap=="function"?a.b(j,Y):a.d(j,Y)})(w,(j,Y)=>{j!=null?d(j):Y!=null&&d(null,Y,{cacheControl:T,expires:B})}),l.cancelled||(l.completed=!0,E--,i())},i=()=>{const l=(()=>{const d=Object.keys(O);let _=!1;if(d.length>0){for(const w of d)if(_=O[w](),_)break}return _})()?a.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let d=E;d<l&&A.length>0;d++){const _=A.shift();if(_.cancelled){d--;continue}const w=y(_);E++,_.innerRequest=w}},r=(l,d)=>{const _=new Image,w=l.url;let T=!1;const B=l.credentials;return B&&B==="include"?_.crossOrigin="use-credentials":(B&&B==="same-origin"||!a.s(w))&&(_.crossOrigin="anonymous"),_.fetchPriority="high",_.onload=()=>{d(null,_),_.onerror=_.onload=null},_.onerror=()=>{T||d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),_.onerror=_.onload=null},_.src=w,{cancel:()=>{T=!0,_.src=""}}}}(tt||(tt={})),tt.resetRequestQueue(),function(Z){Z.Glyphs="Glyphs",Z.Image="Image",Z.Source="Source",Z.SpriteImage="SpriteImage",Z.SpriteJSON="SpriteJSON",Z.Style="Style",Z.Tile="Tile",Z.Unknown="Unknown"}(lt||(lt={}));class ut{constructor(A){this._transformRequestFn=A}transformRequest(A,E){return this._transformRequestFn&&this._transformRequestFn(A,E)||{url:A}}normalizeSpriteURL(A,E,F){const O=function(y){const s=y.match(Tt);if(!s)throw new Error(`Unable to parse URL "${y}"`);return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}(A);return O.path+=`${E}${F}`,function(y){const s=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${s}`}(O)}setTransformRequest(A){this._transformRequestFn=A}}const Tt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pt(Z){var A=new a.A(3);return A[0]=Z[0],A[1]=Z[1],A[2]=Z[2],A}var zt,Ge=function(Z,A,E){return Z[0]=A[0]-E[0],Z[1]=A[1]-E[1],Z[2]=A[2]-E[2],Z};zt=new a.A(3),a.A!=Float32Array&&(zt[0]=0,zt[1]=0,zt[2]=0);var Xt=function(Z){var A=Z[0],E=Z[1];return A*A+E*E};function rt(Z){const A=[];if(typeof Z=="string")A.push({id:"default",url:Z});else if(Z&&Z.length>0){const E=[];for(const{id:F,url:O}of Z){const y=`${F}${O}`;E.indexOf(y)===-1&&(E.push(y),A.push({id:F,url:O}))}}return A}function yt(Z,A,E,F,O){if(F)return void Z(F);if(O!==Object.values(A).length||O!==Object.values(E).length)return;const y={};for(const s in A){y[s]={};const i=a.h.getImageCanvasContext(E[s]),r=A[s];for(const l in r){const{width:d,height:_,x:w,y:T,sdf:B,pixelRatio:j,stretchX:Y,stretchY:ce,content:Se}=r[l];y[s][l]={data:null,pixelRatio:j,sdf:B,stretchX:Y,stretchY:ce,content:Se,spriteData:{width:d,height:_,x:w,y:T,context:i}}}}Z(null,y)}(function(){var Z=new a.A(2);a.A!=Float32Array&&(Z[0]=0,Z[1]=0)})();class pt{constructor(A,E,F,O){this.context=A,this.format=F,this.texture=A.gl.createTexture(),this.update(E,O)}update(A,E,F){const{width:O,height:y}=A,s=!(this.size&&this.size[0]===O&&this.size[1]===y||F),{context:i}=this,{gl:r}=i;if(this.useMipmap=!!(E&&E.useMipmap),r.bindTexture(r.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===r.RGBA&&(!E||E.premultiply!==!1)),s)this.size=[O,y],A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texImage2D(r.TEXTURE_2D,0,this.format,this.format,r.UNSIGNED_BYTE,A):r.texImage2D(r.TEXTURE_2D,0,this.format,O,y,0,this.format,r.UNSIGNED_BYTE,A.data);else{const{x:l,y:d}=F||{x:0,y:0};A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texSubImage2D(r.TEXTURE_2D,0,l,d,r.RGBA,r.UNSIGNED_BYTE,A):r.texSubImage2D(r.TEXTURE_2D,0,l,d,O,y,r.RGBA,r.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&r.generateMipmap(r.TEXTURE_2D)}bind(A,E,F){const{context:O}=this,{gl:y}=O;y.bindTexture(y.TEXTURE_2D,this.texture),F!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(F=y.LINEAR),A!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,A),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,F||A),this.filter=A),E!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,E),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,E),this.wrap=E)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:A}=this.context;A.deleteTexture(this.texture),this.texture=null}}function gt(Z){const{userImage:A}=Z;return!!(A&&A.render&&A.render())&&(Z.data.replace(new Uint8Array(A.data.buffer)),!0)}class bt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(A){if(this.loaded!==A&&(this.loaded=A,A)){for(const{ids:E,callback:F}of this.requestors)this._notify(E,F);this.requestors=[]}}getImage(A){const E=this.images[A];if(E&&!E.data&&E.spriteData){const F=E.spriteData;E.data=new a.R({width:F.width,height:F.height},F.context.getImageData(F.x,F.y,F.width,F.height).data),E.spriteData=null}return E}addImage(A,E){if(this.images[A])throw new Error(`Image id ${A} already exist, use updateImage instead`);this._validate(A,E)&&(this.images[A]=E)}_validate(A,E){let F=!0;const O=E.data||E.spriteData;return this._validateStretch(E.stretchX,O&&O.width)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchX" value`))),F=!1),this._validateStretch(E.stretchY,O&&O.height)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchY" value`))),F=!1),this._validateContent(E.content,E)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "content" value`))),F=!1),F}_validateStretch(A,E){if(!A)return!0;let F=0;for(const O of A){if(O[0]<F||O[1]<O[0]||E<O[1])return!1;F=O[1]}return!0}_validateContent(A,E){if(!A)return!0;if(A.length!==4)return!1;const F=E.spriteData,O=F&&F.width||E.data.width,y=F&&F.height||E.data.height;return!(A[0]<0||O<A[0]||A[1]<0||y<A[1]||A[2]<0||O<A[2]||A[3]<0||y<A[3]||A[2]<A[0]||A[3]<A[1])}updateImage(A,E,F=!0){const O=this.getImage(A);if(F&&(O.data.width!==E.data.width||O.data.height!==E.data.height))throw new Error(`size mismatch between old image (${O.data.width}x${O.data.height}) and new image (${E.data.width}x${E.data.height}).`);E.version=O.version+1,this.images[A]=E,this.updatedImages[A]=!0}removeImage(A){const E=this.images[A];delete this.images[A],delete this.patterns[A],E.userImage&&E.userImage.onRemove&&E.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(A,E){let F=!0;if(!this.isLoaded())for(const O of A)this.images[O]||(F=!1);this.isLoaded()||F?this._notify(A,E):this.requestors.push({ids:A,callback:E})}_notify(A,E){const F={};for(const O of A){let y=this.getImage(O);y||(this.fire(new a.k("styleimagemissing",{id:O})),y=this.getImage(O)),y?F[O]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:a.w(`Image "${O}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}E(null,F)}getPixelSize(){const{width:A,height:E}=this.atlasImage;return{width:A,height:E}}getPattern(A){const E=this.patterns[A],F=this.getImage(A);if(!F)return null;if(E&&E.position.version===F.version)return E.position;if(E)E.position.version=F.version;else{const O={w:F.data.width+2,h:F.data.height+2,x:0,y:0},y=new a.I(O,F);this.patterns[A]={bin:O,position:y}}return this._updatePatternAtlas(),this.patterns[A].position}bind(A){const E=A.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new pt(A,this.atlasImage,E.RGBA),this.atlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE)}_updatePatternAtlas(){const A=[];for(const y in this.patterns)A.push(this.patterns[y].bin);const{w:E,h:F}=a.p(A),O=this.atlasImage;O.resize({width:E||1,height:F||1});for(const y in this.patterns){const{bin:s}=this.patterns[y],i=s.x+1,r=s.y+1,l=this.getImage(y).data,d=l.width,_=l.height;a.R.copy(l,O,{x:0,y:0},{x:i,y:r},{width:d,height:_}),a.R.copy(l,O,{x:0,y:_-1},{x:i,y:r-1},{width:d,height:1}),a.R.copy(l,O,{x:0,y:0},{x:i,y:r+_},{width:d,height:1}),a.R.copy(l,O,{x:d-1,y:0},{x:i-1,y:r},{width:1,height:_}),a.R.copy(l,O,{x:0,y:0},{x:i+d,y:r},{width:1,height:_})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(A){for(const E of A){if(this.callbackDispatchedThisFrame[E])continue;this.callbackDispatchedThisFrame[E]=!0;const F=this.getImage(E);F||a.w(`Image with ID: "${E}" was not found`),gt(F)&&this.updateImage(E,F)}}}const dt=1e20;function $e(Z,A,E,F,O,y,s,i,r){for(let l=A;l<A+F;l++)mt(Z,E*y+l,y,O,s,i,r);for(let l=E;l<E+O;l++)mt(Z,l*y+A,1,F,s,i,r)}function mt(Z,A,E,F,O,y,s){y[0]=0,s[0]=-dt,s[1]=dt,O[0]=Z[A];for(let i=1,r=0,l=0;i<F;i++){O[i]=Z[A+i*E];const d=i*i;do{const _=y[r];l=(O[i]-O[_]+d-_*_)/(i-_)/2}while(l<=s[r]&&--r>-1);r++,y[r]=i,s[r]=l,s[r+1]=dt}for(let i=0,r=0;i<F;i++){for(;s[r+1]<i;)r++;const l=y[r],d=i-l;Z[A+i*E]=O[l]+d*d}}class st{constructor(A,E){this.requestManager=A,this.localIdeographFontFamily=E,this.entries={}}setURL(A){this.url=A}getGlyphs(A,E){const F=[];for(const O in A)for(const y of A[O])F.push({stack:O,id:y});a.o(F,({stack:O,id:y},s)=>{let i=this.entries[O];i||(i=this.entries[O]={glyphs:{},requests:{},ranges:{}});let r=i.glyphs[y];if(r!==void 0)return void s(null,{stack:O,id:y,glyph:r});if(r=this._tinySDF(i,O,y),r)return i.glyphs[y]=r,void s(null,{stack:O,id:y,glyph:r});const l=Math.floor(y/256);if(256*l>65535)return void s(new Error("glyphs > 65535 not supported"));if(i.ranges[l])return void s(null,{stack:O,id:y,glyph:r});if(!this.url)return void s(new Error("glyphsUrl is not set"));let d=i.requests[l];d||(d=i.requests[l]=[],st.loadGlyphRange(O,l,this.url,this.requestManager,(_,w)=>{if(w){for(const T in w)this._doesCharSupportLocalGlyph(+T)||(i.glyphs[+T]=w[+T]);i.ranges[l]=!0}for(const T of d)T(_,w);delete i.requests[l]})),d.push((_,w)=>{_?s(_):w&&s(null,{stack:O,id:y,glyph:w[y]||null})})},(O,y)=>{if(O)E(O);else if(y){const s={};for(const{stack:i,id:r,glyph:l}of y)(s[i]||(s[i]={}))[r]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics};E(null,s)}})}_doesCharSupportLocalGlyph(A){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](A)||a.u["Hangul Syllables"](A)||a.u.Hiragana(A)||a.u.Katakana(A))}_tinySDF(A,E,F){const O=this.localIdeographFontFamily;if(!O||!this._doesCharSupportLocalGlyph(F))return;let y=A.tinySDF;if(!y){let i="400";/bold/i.test(E)?i="900":/medium/i.test(E)?i="500":/light/i.test(E)&&(i="200"),y=A.tinySDF=new st.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:O,fontWeight:i})}const s=y.draw(String.fromCharCode(F));return{id:F,bitmap:new a.q({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}st.loadGlyphRange=function(Z,A,E,F,O){const y=256*A,s=y+255,i=F.transformRequest(E.replace("{fontstack}",Z).replace("{range}",`${y}-${s}`),lt.Glyphs);a.l(i,(r,l)=>{if(r)O(r);else if(l){const d={};for(const _ of a.n(l))d[_.id]=_;O(null,d)}})},st.TinySDF=class{constructor({fontSize:Z=24,buffer:A=3,radius:E=8,cutoff:F=.25,fontFamily:O="sans-serif",fontWeight:y="normal",fontStyle:s="normal"}={}){this.buffer=A,this.cutoff=F,this.radius=E;const i=this.size=Z+4*A,r=this._createCanvas(i),l=this.ctx=r.getContext("2d",{willReadFrequently:!0});l.font=`${s} ${y} ${Z}px ${O}`,l.textBaseline="alphabetic",l.textAlign="left",l.fillStyle="black",this.gridOuter=new Float64Array(i*i),this.gridInner=new Float64Array(i*i),this.f=new Float64Array(i),this.z=new Float64Array(i+1),this.v=new Uint16Array(i)}_createCanvas(Z){const A=document.createElement("canvas");return A.width=A.height=Z,A}draw(Z){const{width:A,actualBoundingBoxAscent:E,actualBoundingBoxDescent:F,actualBoundingBoxLeft:O,actualBoundingBoxRight:y}=this.ctx.measureText(Z),s=Math.ceil(E),i=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-O))),r=Math.min(this.size-this.buffer,s+Math.ceil(F)),l=i+2*this.buffer,d=r+2*this.buffer,_=Math.max(l*d,0),w=new Uint8ClampedArray(_),T={data:w,width:l,height:d,glyphWidth:i,glyphHeight:r,glyphTop:s,glyphLeft:0,glyphAdvance:A};if(i===0||r===0)return T;const{ctx:B,buffer:j,gridInner:Y,gridOuter:ce}=this;B.clearRect(j,j,i,r),B.fillText(Z,j,j+s);const Se=B.getImageData(j,j,i,r);ce.fill(dt,0,_),Y.fill(0,0,_);for(let Te=0;Te<r;Te++)for(let Re=0;Re<i;Re++){const Be=Se.data[4*(Te*i+Re)+3]/255;if(Be===0)continue;const Je=(Te+j)*l+Re+j;if(Be===1)ce[Je]=0,Y[Je]=dt;else{const xt=.5-Be;ce[Je]=xt>0?xt*xt:0,Y[Je]=xt<0?xt*xt:0}}$e(ce,0,0,l,d,l,this.f,this.v,this.z),$e(Y,j,j,i,r,l,this.f,this.v,this.z);for(let Te=0;Te<_;Te++){const Re=Math.sqrt(ce[Te])-Math.sqrt(Y[Te]);w[Te]=Math.round(255-255*(Re/this.radius+this.cutoff))}return T}};class Nt{constructor(){this.specification=a.v.light.position}possiblyEvaluate(A,E){return a.z(A.expression.evaluate(E))}interpolate(A,E,F){return{x:a.B.number(A.x,E.x,F),y:a.B.number(A.y,E.y,F),z:a.B.number(A.z,E.z,F)}}}let Rt;class Ot extends a.E{constructor(A){super(),Rt=Rt||new a.r({anchor:new a.D(a.v.light.anchor),position:new Nt,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(Rt),this.setLight(A),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(A,E={}){if(!this._validate(a.t,A,E))for(const F in A){const O=A[F];F.endsWith("-transition")?this._transitionable.setTransition(F.slice(0,-11),O):this._transitionable.setValue(F,O)}}updateTransitions(A){this._transitioning=this._transitionable.transitioned(A,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(A){this.properties=this._transitioning.possiblyEvaluate(A)}_validate(A,E,F){return(!F||F.validate!==!1)&&a.x(this,A.call(a.y,a.e({value:E,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}}class _i{constructor(A,E){this.width=A,this.height=E,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(A,E){const F=A.join(",")+String(E);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(A,E)),this.dashEntry[F]}getDashRanges(A,E,F){const O=[];let y=A.length%2==1?-A[A.length-1]*F:0,s=A[0]*F,i=!0;O.push({left:y,right:s,isDash:i,zeroLength:A[0]===0});let r=A[0];for(let l=1;l<A.length;l++){i=!i;const d=A[l];y=r*F,r+=d,s=r*F,O.push({left:y,right:s,isDash:i,zeroLength:d===0})}return O}addRoundDash(A,E,F){const O=E/2;for(let y=-F;y<=F;y++){const s=this.width*(this.nextRow+F+y);let i=0,r=A[i];for(let l=0;l<this.width;l++){l/r.right>1&&(r=A[++i]);const d=Math.abs(l-r.left),_=Math.abs(l-r.right),w=Math.min(d,_);let T;const B=y/F*(O+1);if(r.isDash){const j=O-Math.abs(B);T=Math.sqrt(w*w+j*j)}else T=O-Math.sqrt(w*w+B*B);this.data[s+l]=Math.max(0,Math.min(255,T+128))}}}addRegularDash(A){for(let i=A.length-1;i>=0;--i){const r=A[i],l=A[i+1];r.zeroLength?A.splice(i,1):l&&l.isDash===r.isDash&&(l.left=r.left,A.splice(i,1))}const E=A[0],F=A[A.length-1];E.isDash===F.isDash&&(E.left=F.left-this.width,F.right=E.right+this.width);const O=this.width*this.nextRow;let y=0,s=A[y];for(let i=0;i<this.width;i++){i/s.right>1&&(s=A[++y]);const r=Math.abs(i-s.left),l=Math.abs(i-s.right),d=Math.min(r,l);this.data[O+i]=Math.max(0,Math.min(255,(s.isDash?d:-d)+128))}}addDash(A,E){const F=E?7:0,O=2*F+1;if(this.nextRow+O>this.height)return a.w("LineAtlas out of space"),null;let y=0;for(let i=0;i<A.length;i++)y+=A[i];if(y!==0){const i=this.width/y,r=this.getDashRanges(A,this.width,i);E?this.addRoundDash(r,i,F):this.addRegularDash(r)}const s={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:y};return this.nextRow+=O,this.dirty=!0,s}bind(A){const E=A.gl;this.texture?(E.bindTexture(E.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,E.texSubImage2D(E.TEXTURE_2D,0,0,0,this.width,this.height,E.ALPHA,E.UNSIGNED_BYTE,this.data))):(this.texture=E.createTexture(),E.bindTexture(E.TEXTURE_2D,this.texture),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_2D,0,E.ALPHA,this.width,this.height,0,E.ALPHA,E.UNSIGNED_BYTE,this.data))}}class Si{constructor(A,E,F){this.workerPool=A,this.actors=[],this.currentActor=0,this.id=F;const O=this.workerPool.acquire(F);for(let y=0;y<O.length;y++){const s=new a.C(O[y],E,F);s.name=`Worker ${y}`,this.actors.push(s)}if(!this.actors.length)throw new Error("No actors found")}broadcast(A,E,F){a.o(this.actors,(O,y)=>{O.send(A,E,y)},F=F||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(A=!0){this.actors.forEach(E=>{E.remove()}),this.actors=[],A&&this.workerPool.release(this.id)}}function Ti(Z,A,E){const F=function(O,y){if(O)return E(O);if(y){const s=a.F(a.e(y,Z),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(s.vectorLayers=y.vector_layers,s.vectorLayerIds=s.vectorLayers.map(i=>i.id)),E(null,s)}};return Z.url?a.f(A.transformRequest(Z.url,lt.Source),F):a.h.frame(()=>F(null,Z))}class Oi{constructor(A,E){A&&(E?this.setSouthWest(A).setNorthEast(E):Array.isArray(A)&&(A.length===4?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1])))}setNorthEast(A){return this._ne=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}setSouthWest(A){return this._sw=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}extend(A){const E=this._sw,F=this._ne;let O,y;if(A instanceof a.L)O=A,y=A;else{if(!(A instanceof Oi))return Array.isArray(A)?A.length===4||A.every(Array.isArray)?this.extend(Oi.convert(A)):this.extend(a.L.convert(A)):A&&("lng"in A||"lon"in A)&&"lat"in A?this.extend(a.L.convert(A)):this;if(O=A._sw,y=A._ne,!O||!y)return this}return E||F?(E.lng=Math.min(O.lng,E.lng),E.lat=Math.min(O.lat,E.lat),F.lng=Math.max(y.lng,F.lng),F.lat=Math.max(y.lat,F.lat)):(this._sw=new a.L(O.lng,O.lat),this._ne=new a.L(y.lng,y.lat)),this}getCenter(){return new a.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.L(this.getWest(),this.getNorth())}getSouthEast(){return new a.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(A){const{lng:E,lat:F}=a.L.convert(A);let O=this._sw.lng<=E&&E<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=E&&E>=this._ne.lng),this._sw.lat<=F&&F<=this._ne.lat&&O}static convert(A){return A instanceof Oi?A:A&&new Oi(A)}static fromLngLat(A,E=0){const F=360*E/40075017,O=F/Math.cos(Math.PI/180*A.lat);return new Oi(new a.L(A.lng-O,A.lat-F),new a.L(A.lng+O,A.lat+F))}}class tn{constructor(A,E,F){this.bounds=Oi.convert(this.validateBounds(A)),this.minzoom=E||0,this.maxzoom=F||24}validateBounds(A){return Array.isArray(A)&&A.length===4?[Math.max(-180,A[0]),Math.max(-90,A[1]),Math.min(180,A[2]),Math.min(90,A[3])]:[-180,-90,180,90]}contains(A){const E=Math.pow(2,A.z),F=Math.floor(a.G(this.bounds.getWest())*E),O=Math.floor(a.H(this.bounds.getNorth())*E),y=Math.ceil(a.G(this.bounds.getEast())*E),s=Math.ceil(a.H(this.bounds.getSouth())*E);return A.x>=F&&A.x<y&&A.y>=O&&A.y<s}}class qi extends a.E{constructor(A,E,F,O){if(super(),this.load=()=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ti(this._options,this.map._requestManager,(y,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),y?this.fire(new a.j(y)):s&&(a.e(this,s),s.bounds&&(this.tileBounds=new tn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>a.e({},this._options),this.id=A,this.dispatcher=F,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.F(E,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},E),this._collectResourceTiming=E.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}loaded(){return this._loaded}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}onAdd(A){this.map=A,this.load()}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}setUrl(A){return this.setSourceProperty(()=>{this.url=A,this._options.url=A}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O={request:this.map._requestManager.transformRequest(F,lt.Tile),uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,tileSize:this.tileSize*A.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(s,i){return delete A.request,A.aborted?E(null):s&&s.status!==404?E(s):(i&&i.resourceTiming&&(A.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&A.setExpiryData(i),A.loadVectorData(i,this.map.painter),E(null),void(A.reloadCallback&&(this.loadTile(A,A.reloadCallback),A.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,A.actor&&A.state!=="expired"?A.state==="loading"?A.reloadCallback=E:A.request=A.actor.send("reloadTile",O,y.bind(this)):(A.actor=this.dispatcher.getActor(),A.request=A.actor.send("loadTile",O,y.bind(this)))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.actor&&A.actor.send("abortTile",{uid:A.uid,type:this.type,source:this.id},void 0)}unloadTile(A){A.unloadVectorData(),A.actor&&A.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Ni extends a.E{constructor(A,E,F,O){super(),this.id=A,this.dispatcher=F,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},E),a.e(this,a.F(E,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ti(this._options,this.map._requestManager,(A,E)=>{this._tileJSONRequest=null,this._loaded=!0,A?this.fire(new a.j(A)):E&&(a.e(this,E),E.bounds&&(this.tileBounds=new tn(E.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(A){this.map=A,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}serialize(){return a.e({},this._options)}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);A.request=tt.getImage(this.map._requestManager.transformRequest(F,lt.Tile),(O,y,s)=>{if(delete A.request,A.aborted)A.state="unloaded",E(null);else if(O)A.state="errored",E(O);else if(y){this.map._refreshExpiredTiles&&s&&A.setExpiryData(s);const i=this.map.painter.context,r=i.gl;A.texture=this.map.painter.getTileTexture(y.width),A.texture?A.texture.update(y,{useMipmap:!0}):(A.texture=new pt(i,y,r.RGBA,{useMipmap:!0}),A.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),A.state="loaded",E(null)}},this.map._refreshExpiredTiles)}abortTile(A,E){A.request&&(A.request.cancel(),delete A.request),E()}unloadTile(A,E){A.texture&&this.map.painter.saveTileTexture(A.texture),E()}hasTransition(){return!1}}class nn extends Ni{constructor(A,E,F,O){super(A,E,F,O),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},E),this.encoding=E.encoding||"mapbox",this.redFactor=E.redFactor,this.greenFactor=E.greenFactor,this.blueFactor=E.blueFactor,this.baseShift=E.baseShift}loadTile(A,E){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O=this.map._requestManager.transformRequest(F,lt.Tile);function y(s,i){s&&(A.state="errored",E(s)),i&&(A.dem=i,A.needsHillshadePrepare=!0,A.needsTerrainPrepare=!0,A.state="loaded",E(null))}A.neighboringTiles=this._getNeighboringTiles(A.tileID),A.request=tt.getImage(O,(s,i,r)=>a._(this,void 0,void 0,function*(){if(delete A.request,A.aborted)A.state="unloaded",E(null);else if(s)A.state="errored",E(s);else if(i){this.map._refreshExpiredTiles&&A.setExpiryData(r);const l=a.a(i)&&a.J()?i:yield function(_){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.K()){const w=_.width+2,T=_.height+2;try{return new a.R({width:w,height:T},yield a.M(_,-1,-1,w,T))}catch{}}return a.h.getImageData(_,1)})}(i),d={uid:A.uid,coord:A.tileID,source:this.id,rawImageData:l,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};A.actor&&A.state!=="expired"||(A.actor=this.dispatcher.getActor(),A.actor.send("loadDEMTile",d,y))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(A){const E=A.canonical,F=Math.pow(2,E.z),O=(E.x-1+F)%F,y=E.x===0?A.wrap-1:A.wrap,s=(E.x+1+F)%F,i=E.x+1===F?A.wrap+1:A.wrap,r={};return r[new a.O(A.overscaledZ,y,E.z,O,E.y).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y).key]={backfilled:!1},E.y>0&&(r[new a.O(A.overscaledZ,y,E.z,O,E.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,E.z,E.x,E.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y-1).key]={backfilled:!1}),E.y+1<F&&(r[new a.O(A.overscaledZ,y,E.z,O,E.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,E.z,E.x,E.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,E.z,s,E.y+1).key]={backfilled:!1}),r}unloadTile(A){A.demTexture&&this.map.painter.saveTileTexture(A.demTexture),A.fbo&&(A.fbo.destroy(),delete A.fbo),A.dem&&delete A.dem,delete A.neighboringTiles,A.state="unloaded",A.actor&&A.actor.send("removeDEMTile",{uid:A.uid,source:this.id})}}class yn extends a.E{constructor(A,E,F,O){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>a.e({},this._options,{type:this.type,data:this._data}),this.id=A,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=F.getActor(),this.setEventedParent(O),this._data=E.data,this._options=a.e({},E),this._collectResourceTiming=E.collectResourceTiming,E.maxzoom!==void 0&&(this.maxzoom=E.maxzoom),E.type&&(this.type=E.type),E.attribution&&(this.attribution=E.attribution),this.promoteId=E.promoteId;const y=a.N/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:E.cluster||!1,geojsonVtOptions:{buffer:(E.buffer!==void 0?E.buffer:128)*y,tolerance:(E.tolerance!==void 0?E.tolerance:.375)*y,extent:a.N,maxZoom:this.maxzoom,lineMetrics:E.lineMetrics||!1,generateId:E.generateId||!1},superclusterOptions:{maxZoom:E.clusterMaxZoom!==void 0?E.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,E.clusterMinPoints||2),extent:a.N,radius:(E.clusterRadius||50)*y,log:!1,generateId:E.generateId||!1},clusterProperties:E.clusterProperties,filter:E.filter},E.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(A){this.map=A,this.load()}setData(A){return this._data=A,this._updateWorkerData(),this}updateData(A){return this._updateWorkerData(A),this}setClusterOptions(A){return this.workerOptions.cluster=A.cluster,A&&(A.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=A.clusterRadius),A.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=A.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(A,E){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:A,source:this.id},E),this}getClusterChildren(A,E){return this.actor.send("geojson.getClusterChildren",{clusterId:A,source:this.id},E),this}getClusterLeaves(A,E,F,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:A,limit:E,offset:F},O),this}_updateWorkerData(A){const E=a.e({},this.workerOptions);A?E.dataDiff=A:typeof this._data=="string"?(E.request=this.map._requestManager.transformRequest(a.h.resolveURL(this._data),lt.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,E,(F,O)=>{if(this._pendingLoads--,this._removed||O&&O.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let y=null;if(O&&O.resourceTiming&&O.resourceTiming[this.id]&&(y=O.resourceTiming[this.id].slice(0)),F)return void this.fire(new a.j(F));const s={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&a.e(s,{resourceTiming:y}),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(A,E){const F=A.actor?"reloadTile":"loadTile";A.actor=this.actor;const O={type:this.type,uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};A.request=this.actor.send(F,O,(y,s)=>(delete A.request,A.unloadVectorData(),A.aborted?E(null):y?E(y):(A.loadVectorData(s,this.map.painter,F==="reloadTile"),E(null))))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.aborted=!0}unloadTile(A){A.unloadVectorData(),this.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Ci=a.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class gi extends a.E{constructor(A,E,F,O){super(),this.load=(y,s)=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=tt.getImage(this.map._requestManager.transformRequest(this.url,lt.Image),(i,r)=>{this._request=null,this._loaded=!0,i?this.fire(new a.j(i)):r&&(this.image=r,y&&(this.coordinates=y),s&&s(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,Ci.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new pt(y,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=A,this.dispatcher=F,this.coordinates=E.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=E}loaded(){return this._loaded}updateImage(A){return A.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=A.url,this.load(A.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(A){this.map=A,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(A){this.coordinates=A;const E=A.map(a.U.fromLngLat);this.tileID=function(O){let y=1/0,s=1/0,i=-1/0,r=-1/0;for(const w of O)y=Math.min(y,w.x),s=Math.min(s,w.y),i=Math.max(i,w.x),r=Math.max(r,w.y);const l=Math.max(i-y,r-s),d=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),_=Math.pow(2,d);return new a.W(d,Math.floor((y+i)/2*_),Math.floor((s+r)/2*_))}(E),this.minzoom=this.maxzoom=this.tileID.z;const F=E.map(O=>this.tileID.getTilePoint(O)._round());return this._boundsArray=new a.V,this._boundsArray.emplaceBack(F[0].x,F[0].y,0,0),this._boundsArray.emplaceBack(F[1].x,F[1].y,a.N,0),this._boundsArray.emplaceBack(F[3].x,F[3].y,0,a.N),this._boundsArray.emplaceBack(F[2].x,F[2].y,a.N,a.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(A,E){this.tileID&&this.tileID.equals(A.tileID.canonical)?(this.tiles[String(A.tileID.wrap)]=A,A.buckets={},E(null)):(A.state="errored",E(null))}hasTransition(){return!1}}class Ri extends gi{constructor(A,E,F,O){super(A,E,F,O),this.load=()=>{this._loaded=!1;const y=this.options;this.urls=[];for(const s of y.urls)this.urls.push(this.map._requestManager.transformRequest(s,lt.Source).url);a.X(this.urls,(s,i)=>{this._loaded=!0,s?this.fire(new a.j(s)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,Ci.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new pt(y,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=E}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(A){if(this.video){const E=this.video.seekable;A<E.start(0)||A>E.end(0)?this.fire(new a.j(new a.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${E.start(0)} and ${E.end(0)}-second mark.`))):this.video.currentTime=A}}getVideo(){return this.video}onAdd(A){this.map||(this.map=A,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class ai extends gi{constructor(A,E,F,O){super(A,E,F,O),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Ci.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new pt(s,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),E.coordinates?Array.isArray(E.coordinates)&&E.coordinates.length===4&&!E.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(s=>typeof s!="number"))||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "coordinates"'))),E.animate&&typeof E.animate!="boolean"&&this.fire(new a.j(new a.Y(`sources.${A}`,null,'optional "animate" property must be a boolean value'))),E.canvas?typeof E.canvas=="string"||E.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "canvas"'))),this.options=E,this.animate=E.animate===void 0||E.animate}getCanvas(){return this.canvas}onAdd(A){this.map=A,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const A of[this.canvas.width,this.canvas.height])if(isNaN(A)||A<=0)return!0;return!1}}const Ki={},Ji=Z=>{switch(Z){case"geojson":return yn;case"image":return gi;case"raster":return Ni;case"raster-dem":return nn;case"vector":return qi;case"video":return Ri;case"canvas":return ai}return Ki[Z]};function fi(Z,A){const E=a.Z();return a.$(E,E,[1,1,0]),a.a0(E,E,[.5*Z.width,.5*Z.height,1]),a.a1(E,E,Z.calculatePosMatrix(A.toUnwrapped()))}function pn(Z,A,E,F,O,y){const s=function(_,w,T){if(_)for(const B of _){const j=w[B];if(j&&j.source===T&&j.type==="fill-extrusion")return!0}else for(const B in w){const j=w[B];if(j.source===T&&j.type==="fill-extrusion")return!0}return!1}(O&&O.layers,A,Z.id),i=y.maxPitchScaleFactor(),r=Z.tilesIn(F,i,s);r.sort(ii);const l=[];for(const _ of r)l.push({wrappedTileID:_.tileID.wrapped().key,queryResults:_.tile.queryRenderedFeatures(A,E,Z._state,_.queryGeometry,_.cameraQueryGeometry,_.scale,O,y,i,fi(Z.transform,_.tileID))});const d=function(_){const w={},T={};for(const B of _){const j=B.queryResults,Y=B.wrappedTileID,ce=T[Y]=T[Y]||{};for(const Se in j){const Te=j[Se],Re=ce[Se]=ce[Se]||{},Be=w[Se]=w[Se]||[];for(const Je of Te)Re[Je.featureIndex]||(Re[Je.featureIndex]=!0,Be.push(Je))}}return w}(l);for(const _ in d)d[_].forEach(w=>{const T=w.feature,B=Z.getFeatureState(T.layer["source-layer"],T.id);T.source=T.layer.source,T.layer["source-layer"]&&(T.sourceLayer=T.layer["source-layer"]),T.state=B});return d}function ii(Z,A){const E=Z.tileID,F=A.tileID;return E.overscaledZ-F.overscaledZ||E.canonical.y-F.canonical.y||E.wrap-F.wrap||E.canonical.x-F.canonical.x}class wn{constructor(A,E){this.timeAdded=0,this.fadeEndTime=0,this.tileID=A,this.uid=a.a2(),this.uses=0,this.tileSize=E,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(A){const E=A+this.timeAdded;E<this.fadeEndTime||(this.fadeEndTime=E)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(A){this.demTexture&&A.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(A,E,F){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(O,y){const s={};if(!y)return s;for(const i of O){const r=i.layerIds.map(l=>y.getLayer(l)).filter(Boolean);if(r.length!==0){i.layers=r,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(l=>r.filter(d=>d.id===l)[0]));for(const l of r)s[l.id]=i}}return s}(A.buckets,E.style),this.hasSymbolBuckets=!1;for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4){if(this.hasSymbolBuckets=!0,!F)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4&&y.hasRTLText){this.hasRTLText=!0,a.a5();break}}this.queryPadding=0;for(const O in this.buckets){const y=this.buckets[O];this.queryPadding=Math.max(this.queryPadding,E.style.getLayer(O).queryRadius(y))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new a.a3}unloadVectorData(){for(const A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(A){return this.buckets[A.id]}upload(A){for(const F in this.buckets){const O=this.buckets[F];O.uploadPending()&&O.upload(A)}const E=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new pt(A,this.imageAtlas.image,E.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new pt(A,this.glyphAtlasImage,E.ALPHA),this.glyphAtlasImage=null)}prepare(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)}queryRenderedFeatures(A,E,F,O,y,s,i,r,l,d){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:O,cameraQueryGeometry:y,scale:s,tileSize:this.tileSize,pixelPosMatrix:d,transform:r,params:i,queryPadding:this.queryPadding*l},A,E,F):{}}querySourceFeatures(A,E){const F=this.latestFeatureIndex;if(!F||!F.rawTileData)return;const O=F.loadVTLayers(),y=E&&E.sourceLayer?E.sourceLayer:"",s=O._geojsonTileLayer||O[y];if(!s)return;const i=a.a6(E&&E.filter),{z:r,x:l,y:d}=this.tileID.canonical,_={z:r,x:l,y:d};for(let w=0;w<s.length;w++){const T=s.feature(w);if(i.needGeometry){const Y=a.a7(T,!0);if(!i.filter(new a.a8(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!i.filter(new a.a8(this.tileID.overscaledZ),T))continue;const B=F.getId(T,y),j=new a.a9(T,r,l,d,B);j.tile=_,A.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(A){const E=this.expirationTime;if(A.cacheControl){const F=a.aa(A.cacheControl);F["max-age"]&&(this.expirationTime=Date.now()+1e3*F["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){const F=Date.now();let O=!1;if(this.expirationTime>F)O=!1;else if(E)if(this.expirationTime<E)O=!0;else{const y=this.expirationTime-E;y?this.expirationTime=F+Math.max(y,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(A,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(A).length===0)return;const F=this.latestFeatureIndex.loadVTLayers();for(const O in this.buckets){if(!E.style.hasLayer(O))continue;const y=this.buckets[O],s=y.layers[0].sourceLayer||"_geojsonTileLayer",i=F[s],r=A[s];if(!i||!r||Object.keys(r).length===0)continue;y.update(r,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=E&&E.style&&E.style.getLayer(O);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(A){this.symbolFadeHoldUntil=a.h.now()+A}setDependencies(A,E){const F={};for(const O of E)F[O]=!0;this.dependencies[A]=F}hasDependency(A,E){for(const F of A){const O=this.dependencies[F];if(O){for(const y of E)if(O[y])return!0}}return!1}}class Rr{constructor(A,E){this.max=A,this.onRemove=E,this.reset()}reset(){for(const A in this.data)for(const E of this.data[A])E.timeout&&clearTimeout(E.timeout),this.onRemove(E.value);return this.data={},this.order=[],this}add(A,E,F){const O=A.wrapped().key;this.data[O]===void 0&&(this.data[O]=[]);const y={value:E,timeout:void 0};if(F!==void 0&&(y.timeout=setTimeout(()=>{this.remove(A,y)},F)),this.data[O].push(y),this.order.push(O),this.order.length>this.max){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}has(A){return A.wrapped().key in this.data}getAndRemove(A){return this.has(A)?this._getAndRemoveByKey(A.wrapped().key):null}_getAndRemoveByKey(A){const E=this.data[A].shift();return E.timeout&&clearTimeout(E.timeout),this.data[A].length===0&&delete this.data[A],this.order.splice(this.order.indexOf(A),1),E.value}getByKey(A){const E=this.data[A];return E?E[0].value:null}get(A){return this.has(A)?this.data[A.wrapped().key][0].value:null}remove(A,E){if(!this.has(A))return this;const F=A.wrapped().key,O=E===void 0?0:this.data[F].indexOf(E),y=this.data[F][O];return this.data[F].splice(O,1),y.timeout&&clearTimeout(y.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(y.value),this.order.splice(this.order.indexOf(F),1),this}setMaxSize(A){for(this.max=A;this.order.length>this.max;){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}filter(A){const E=[];for(const F in this.data)for(const O of this.data[F])A(O.value)||E.push(O);for(const F of E)this.remove(F.value.tileID,F)}}class hi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(A,E,F){const O=String(E);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][O]=this.stateChanges[A][O]||{},a.e(this.stateChanges[A][O],F),this.deletedStates[A]===null){this.deletedStates[A]={};for(const y in this.state[A])y!==O&&(this.deletedStates[A][y]=null)}else if(this.deletedStates[A]&&this.deletedStates[A][O]===null){this.deletedStates[A][O]={};for(const y in this.state[A][O])F[y]||(this.deletedStates[A][O][y]=null)}else for(const y in F)this.deletedStates[A]&&this.deletedStates[A][O]&&this.deletedStates[A][O][y]===null&&delete this.deletedStates[A][O][y]}removeFeatureState(A,E,F){if(this.deletedStates[A]===null)return;const O=String(E);if(this.deletedStates[A]=this.deletedStates[A]||{},F&&E!==void 0)this.deletedStates[A][O]!==null&&(this.deletedStates[A][O]=this.deletedStates[A][O]||{},this.deletedStates[A][O][F]=null);else if(E!==void 0)if(this.stateChanges[A]&&this.stateChanges[A][O])for(F in this.deletedStates[A][O]={},this.stateChanges[A][O])this.deletedStates[A][O][F]=null;else this.deletedStates[A][O]=null;else this.deletedStates[A]=null}getState(A,E){const F=String(E),O=a.e({},(this.state[A]||{})[F],(this.stateChanges[A]||{})[F]);if(this.deletedStates[A]===null)return{};if(this.deletedStates[A]){const y=this.deletedStates[A][E];if(y===null)return{};for(const s in y)delete O[s]}return O}initializeTileState(A,E){A.setFeatureState(this.state,E)}coalesceChanges(A,E){const F={};for(const O in this.stateChanges){this.state[O]=this.state[O]||{};const y={};for(const s in this.stateChanges[O])this.state[O][s]||(this.state[O][s]={}),a.e(this.state[O][s],this.stateChanges[O][s]),y[s]=this.state[O][s];F[O]=y}for(const O in this.deletedStates){this.state[O]=this.state[O]||{};const y={};if(this.deletedStates[O]===null)for(const s in this.state[O])y[s]={},this.state[O][s]={};else for(const s in this.deletedStates[O]){if(this.deletedStates[O][s]===null)this.state[O][s]={};else for(const i of Object.keys(this.deletedStates[O][s]))delete this.state[O][s][i];y[s]=this.state[O][s]}F[O]=F[O]||{},a.e(F[O],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(F).length!==0)for(const O in A)A[O].setFeatureState(F,E)}}class en extends a.E{constructor(A,E,F){super(),this.id=A,this.dispatcher=F,this.on("data",O=>{O.dataType==="source"&&O.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&O.dataType==="source"&&O.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((O,y,s,i)=>{const r=new(Ji(y.type))(O,y,s,i);if(r.id!==O)throw new Error(`Expected Source id to be ${O} instead of ${r.id}`);return r})(A,E,F,this),this._tiles={},this._cache=new Rr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new hi,this._didEmitContent=!1,this._updated=!1}onAdd(A){this.map=A,this._maxTileCacheSize=A?A._maxTileCacheSize:null,this._maxTileCacheZoomLevels=A?A._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(A)}onRemove(A){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(A)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const A in this._tiles){const E=this._tiles[A];if(E.state!=="loaded"&&E.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const A=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,A&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(A,E){return this._source.loadTile(A,E)}_unloadTile(A){if(this._source.unloadTile)return this._source.unloadTile(A,()=>{})}_abortTile(A){this._source.abortTile&&this._source.abortTile(A,()=>{}),this._source.fire(new a.k("dataabort",{tile:A,coord:A.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(A){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const E in this._tiles){const F=this._tiles[E];F.upload(A),F.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(A=>A.tileID).sort(tr).map(A=>A.key)}getRenderableIds(A){const E=[];for(const F in this._tiles)this._isIdRenderable(F,A)&&E.push(this._tiles[F]);return A?E.sort((F,O)=>{const y=F.tileID,s=O.tileID,i=new a.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),r=new a.P(s.canonical.x,s.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-s.overscaledZ||r.y-i.y||r.x-i.x}).map(F=>F.tileID.key):E.map(F=>F.tileID).sort(tr).map(F=>F.key)}hasRenderableParent(A){const E=this.findLoadedParent(A,0);return!!E&&this._isIdRenderable(E.tileID.key)}_isIdRenderable(A,E){return this._tiles[A]&&this._tiles[A].hasData()&&!this._coveredTiles[A]&&(E||!this._tiles[A].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const A in this._tiles)this._tiles[A].state!=="errored"&&this._reloadTile(A,"reloading")}}_reloadTile(A,E){const F=this._tiles[A];F&&(F.state!=="loading"&&(F.state=E),this._loadTile(F,this._tileLoaded.bind(this,F,A,E)))}_tileLoaded(A,E,F,O){if(O)return A.state="errored",void(O.status!==404?this._source.fire(new a.j(O,{tile:A})):this.update(this.transform,this.terrain));A.timeAdded=a.h.now(),F==="expired"&&(A.refreshedUponExpiration=!0),this._setTileReloadTimer(E,A),this.getSource().type==="raster-dem"&&A.dem&&this._backfillDEM(A),this._state.initializeTileState(A,this.map?this.map.painter:null),A.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:A,coord:A.tileID}))}_backfillDEM(A){const E=this.getRenderableIds();for(let O=0;O<E.length;O++){const y=E[O];if(A.neighboringTiles&&A.neighboringTiles[y]){const s=this.getTileByID(y);F(A,s),F(s,A)}}function F(O,y){O.needsHillshadePrepare=!0,O.needsTerrainPrepare=!0;let s=y.tileID.canonical.x-O.tileID.canonical.x;const i=y.tileID.canonical.y-O.tileID.canonical.y,r=Math.pow(2,O.tileID.canonical.z),l=y.tileID.key;s===0&&i===0||Math.abs(i)>1||(Math.abs(s)>1&&(Math.abs(s+r)===1?s+=r:Math.abs(s-r)===1&&(s-=r)),y.dem&&O.dem&&(O.dem.backfillBorder(y.dem,s,i),O.neighboringTiles&&O.neighboringTiles[l]&&(O.neighboringTiles[l].backfilled=!0)))}}getTile(A){return this.getTileByID(A.key)}getTileByID(A){return this._tiles[A]}_retainLoadedChildren(A,E,F,O){for(const y in this._tiles){let s=this._tiles[y];if(O[y]||!s.hasData()||s.tileID.overscaledZ<=E||s.tileID.overscaledZ>F)continue;let i=s.tileID;for(;s&&s.tileID.overscaledZ>E+1;){const l=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[l.key],s&&s.hasData()&&(i=l)}let r=i;for(;r.overscaledZ>E;)if(r=r.scaledTo(r.overscaledZ-1),A[r.key]){O[i.key]=i;break}}}findLoadedParent(A,E){if(A.key in this._loadedParentTiles){const F=this._loadedParentTiles[A.key];return F&&F.tileID.overscaledZ>=E?F:null}for(let F=A.overscaledZ-1;F>=E;F--){const O=A.scaledTo(F),y=this._getLoadedTile(O);if(y)return y}}_getLoadedTile(A){const E=this._tiles[A.key];return E&&E.hasData()?E:this._cache.getByKey(A.wrapped().key)}updateCacheSize(A){const E=Math.ceil(A.width/this._source.tileSize)+1,F=Math.ceil(A.height/this._source.tileSize)+1,O=Math.floor(E*F*(this._maxTileCacheZoomLevels===null?a.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(y)}handleWrapJump(A){const E=Math.round((A-(this._prevLng===void 0?A:this._prevLng))/360);if(this._prevLng=A,E){const F={};for(const O in this._tiles){const y=this._tiles[O];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+E),F[y.tileID.key]=y}this._tiles=F;for(const O in this._timers)clearTimeout(this._timers[O]),delete this._timers[O];for(const O in this._tiles)this._setTileReloadTimer(O,this._tiles[O])}}update(A,E){if(this.transform=A,this.terrain=E,!this._sourceLoaded||this._paused)return;let F;this.updateCacheSize(A),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?F=A.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new a.O(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(F=A.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:E}),this._source.hasTile&&(F=F.filter(d=>this._source.hasTile(d)))):F=[];const O=A.coveringZoomLevel(this._source),y=Math.max(O-en.maxOverzooming,this._source.minzoom),s=Math.max(O+en.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const d={};for(const _ of F)if(_.canonical.z>this._source.minzoom){const w=_.scaledTo(_.canonical.z-1);d[w.key]=w;const T=_.scaledTo(Math.max(this._source.minzoom,Math.min(_.canonical.z,5)));d[T.key]=T}F=F.concat(Object.values(d))}const i=F.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,i&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const r=this._updateRetainedTiles(F,O);if(Fn(this._source.type)){const d={},_={},w=Object.keys(r),T=a.h.now();for(const B of w){const j=r[B],Y=this._tiles[B];if(!Y||Y.fadeEndTime!==0&&Y.fadeEndTime<=T)continue;const ce=this.findLoadedParent(j,y);ce&&(this._addTile(ce.tileID),d[ce.tileID.key]=ce.tileID),_[B]=j}this._retainLoadedChildren(_,O,s,r);for(const B in d)r[B]||(this._coveredTiles[B]=!0,r[B]=d[B]);if(E){const B={},j={};for(const Y of F)this._tiles[Y.key].hasData()?B[Y.key]=Y:j[Y.key]=Y;for(const Y in j){const ce=j[Y].children(this._source.maxzoom);this._tiles[ce[0].key]&&this._tiles[ce[1].key]&&this._tiles[ce[2].key]&&this._tiles[ce[3].key]&&(B[ce[0].key]=r[ce[0].key]=ce[0],B[ce[1].key]=r[ce[1].key]=ce[1],B[ce[2].key]=r[ce[2].key]=ce[2],B[ce[3].key]=r[ce[3].key]=ce[3],delete j[Y])}for(const Y in j){const ce=this.findLoadedParent(j[Y],this._source.minzoom);if(ce){B[ce.tileID.key]=r[ce.tileID.key]=ce.tileID;for(const Se in B)B[Se].isChildOf(ce.tileID)&&delete B[Se]}}for(const Y in this._tiles)B[Y]||(this._coveredTiles[Y]=!0)}}for(const d in r)this._tiles[d].clearFadeHold();const l=a.ab(this._tiles,r);for(const d of l){const _=this._tiles[d];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(d)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const A in this._tiles)this._tiles[A].holdingForFade()&&this._removeTile(A)}_updateRetainedTiles(A,E){const F={},O={},y=Math.max(E-en.maxOverzooming,this._source.minzoom),s=Math.max(E+en.maxUnderzooming,this._source.minzoom),i={};for(const r of A){const l=this._addTile(r);F[r.key]=r,l.hasData()||E<this._source.maxzoom&&(i[r.key]=r)}this._retainLoadedChildren(i,E,s,F);for(const r of A){let l=this._tiles[r.key];if(l.hasData())continue;if(E+1>this._source.maxzoom){const _=r.children(this._source.maxzoom)[0],w=this.getTile(_);if(w&&w.hasData()){F[_.key]=_;continue}}else{const _=r.children(this._source.maxzoom);if(F[_[0].key]&&F[_[1].key]&&F[_[2].key]&&F[_[3].key])continue}let d=l.wasRequested();for(let _=r.overscaledZ-1;_>=y;--_){const w=r.scaledTo(_);if(O[w.key])break;if(O[w.key]=!0,l=this.getTile(w),!l&&d&&(l=this._addTile(w)),l){const T=l.hasData();if((d||T)&&(F[w.key]=w),d=l.wasRequested(),T)break}}}return F}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const A in this._tiles){const E=[];let F,O=this._tiles[A].tileID;for(;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){F=this._loadedParentTiles[O.key];break}E.push(O.key);const y=O.scaledTo(O.overscaledZ-1);if(F=this._getLoadedTile(y),F)break;O=y}for(const y of E)this._loadedParentTiles[y]=F}}_addTile(A){let E=this._tiles[A.key];if(E)return E;E=this._cache.getAndRemove(A),E&&(this._setTileReloadTimer(A.key,E),E.tileID=A,this._state.initializeTileState(E,this.map?this.map.painter:null),this._cacheTimers[A.key]&&(clearTimeout(this._cacheTimers[A.key]),delete this._cacheTimers[A.key],this._setTileReloadTimer(A.key,E)));const F=E;return E||(E=new wn(A,this._source.tileSize*A.overscaleFactor()),this._loadTile(E,this._tileLoaded.bind(this,E,A.key,E.state))),E.uses++,this._tiles[A.key]=E,F||this._source.fire(new a.k("dataloading",{tile:E,coord:E.tileID,dataType:"source"})),E}_setTileReloadTimer(A,E){A in this._timers&&(clearTimeout(this._timers[A]),delete this._timers[A]);const F=E.getExpiryTimeout();F&&(this._timers[A]=setTimeout(()=>{this._reloadTile(A,"expired"),delete this._timers[A]},F))}_removeTile(A){const E=this._tiles[A];E&&(E.uses--,delete this._tiles[A],this._timers[A]&&(clearTimeout(this._timers[A]),delete this._timers[A]),E.uses>0||(E.hasData()&&E.state!=="reloading"?this._cache.add(E.tileID,E,E.getExpiryTimeout()):(E.aborted=!0,this._abortTile(E),this._unloadTile(E))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const A in this._tiles)this._removeTile(A);this._cache.reset()}tilesIn(A,E,F){const O=[],y=this.transform;if(!y)return O;const s=F?y.getCameraQueryGeometry(A):A,i=A.map(B=>y.pointCoordinate(B,this.terrain)),r=s.map(B=>y.pointCoordinate(B,this.terrain)),l=this.getIds();let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const B of r)d=Math.min(d,B.x),_=Math.min(_,B.y),w=Math.max(w,B.x),T=Math.max(T,B.y);for(let B=0;B<l.length;B++){const j=this._tiles[l[B]];if(j.holdingForFade())continue;const Y=j.tileID,ce=Math.pow(2,y.zoom-j.tileID.overscaledZ),Se=E*j.queryPadding*a.N/j.tileSize/ce,Te=[Y.getTilePoint(new a.U(d,_)),Y.getTilePoint(new a.U(w,T))];if(Te[0].x-Se<a.N&&Te[0].y-Se<a.N&&Te[1].x+Se>=0&&Te[1].y+Se>=0){const Re=i.map(Je=>Y.getTilePoint(Je)),Be=r.map(Je=>Y.getTilePoint(Je));O.push({tile:j,tileID:Y,queryGeometry:Re,cameraQueryGeometry:Be,scale:ce})}}return O}getVisibleCoordinates(A){const E=this.getRenderableIds(A).map(F=>this._tiles[F].tileID);for(const F of E)F.posMatrix=this.transform.calculatePosMatrix(F.toUnwrapped());return E}hasTransition(){if(this._source.hasTransition())return!0;if(Fn(this._source.type)){const A=a.h.now();for(const E in this._tiles)if(this._tiles[E].fadeEndTime>=A)return!0}return!1}setFeatureState(A,E,F){this._state.updateState(A=A||"_geojsonTileLayer",E,F)}removeFeatureState(A,E,F){this._state.removeFeatureState(A=A||"_geojsonTileLayer",E,F)}getFeatureState(A,E){return this._state.getState(A=A||"_geojsonTileLayer",E)}setDependencies(A,E,F){const O=this._tiles[A];O&&O.setDependencies(E,F)}reloadTilesForDependencies(A,E){for(const F in this._tiles)this._tiles[F].hasDependency(A,E)&&this._reloadTile(F,"reloading");this._cache.filter(F=>!F.hasDependency(A,E))}}function tr(Z,A){const E=Math.abs(2*Z.wrap)-+(Z.wrap<0),F=Math.abs(2*A.wrap)-+(A.wrap<0);return Z.overscaledZ-A.overscaledZ||F-E||A.canonical.y-Z.canonical.y||A.canonical.x-Z.canonical.x}function Fn(Z){return Z==="raster"||Z==="image"||Z==="video"}en.maxOverzooming=10,en.maxUnderzooming=3;const Qn="mapboxgl_preloaded_worker_pool";class In{constructor(){this.active={}}acquire(A){if(!this.workers)for(this.workers=[];this.workers.length<In.workerCount;)this.workers.push(new Worker(a.c.WORKER_URL));return this.active[A]=!0,this.workers.slice()}release(A){delete this.active[A],this.numActive()===0&&(this.workers.forEach(E=>{E.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qn]}numActive(){return Object.keys(this.active).length}}const v=Math.floor(a.h.hardwareConcurrency/2);let k;function V(){return k||(k=new In),k}In.workerCount=a.ac(globalThis)?Math.max(Math.min(v,3),1):1;class ${constructor(A,E){this.reset(A,E)}reset(A,E){this.points=A||[],this._distances=[0];for(let F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(E||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(A){if(this.points.length===1)return this.points[0];A=a.ad(A,0,1);let E=1,F=this._distances[E];const O=A*this.paddedLength+this.padding;for(;F<O&&E<this._distances.length;)F=this._distances[++E];const y=E-1,s=this._distances[y],i=F-s,r=i>0?(O-s)/i:0;return this.points[y].mult(1-r).add(this.points[E].mult(r))}}function te(Z,A){let E=!0;return Z==="always"||Z!=="never"&&A!=="never"||(E=!1),E}class fe{constructor(A,E,F){const O=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(A/F),this.yCellCount=Math.ceil(E/F);for(let s=0;s<this.xCellCount*this.yCellCount;s++)O.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=A,this.height=E,this.xScale=this.xCellCount/A,this.yScale=this.yCellCount/E,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(A,E,F,O,y){this._forEachCell(E,F,O,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(A),this.bboxes.push(E),this.bboxes.push(F),this.bboxes.push(O),this.bboxes.push(y)}insertCircle(A,E,F,O){this._forEachCell(E-O,F-O,E+O,F+O,this._insertCircleCell,this.circleUid++),this.circleKeys.push(A),this.circles.push(E),this.circles.push(F),this.circles.push(O)}_insertBoxCell(A,E,F,O,y,s){this.boxCells[y].push(s)}_insertCircleCell(A,E,F,O,y,s){this.circleCells[y].push(s)}_query(A,E,F,O,y,s,i){if(F<0||A>this.width||O<0||E>this.height)return[];const r=[];if(A<=0&&E<=0&&this.width<=F&&this.height<=O){if(y)return[{key:null,x1:A,y1:E,x2:F,y2:O}];for(let l=0;l<this.boxKeys.length;l++)r.push({key:this.boxKeys[l],x1:this.bboxes[4*l],y1:this.bboxes[4*l+1],x2:this.bboxes[4*l+2],y2:this.bboxes[4*l+3]});for(let l=0;l<this.circleKeys.length;l++){const d=this.circles[3*l],_=this.circles[3*l+1],w=this.circles[3*l+2];r.push({key:this.circleKeys[l],x1:d-w,y1:_-w,x2:d+w,y2:_+w})}}else this._forEachCell(A,E,F,O,this._queryCell,r,{hitTest:y,overlapMode:s,seenUids:{box:{},circle:{}}},i);return r}query(A,E,F,O){return this._query(A,E,F,O,!1,null)}hitTest(A,E,F,O,y,s){return this._query(A,E,F,O,!0,y,s).length>0}hitTestCircle(A,E,F,O,y){const s=A-F,i=A+F,r=E-F,l=E+F;if(i<0||s>this.width||l<0||r>this.height)return!1;const d=[];return this._forEachCell(s,r,i,l,this._queryCellCircle,d,{hitTest:!0,overlapMode:O,circle:{x:A,y:E,radius:F},seenUids:{box:{},circle:{}}},y),d.length>0}_queryCell(A,E,F,O,y,s,i,r){const{seenUids:l,hitTest:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!l.box[j]){l.box[j]=!0;const Y=4*j,ce=this.boxKeys[j];if(A<=B[Y+2]&&E<=B[Y+3]&&F>=B[Y+0]&&O>=B[Y+1]&&(!r||r(ce))&&(!d||!te(_,ce.overlapMode))&&(s.push({key:ce,x1:B[Y],y1:B[Y+1],x2:B[Y+2],y2:B[Y+3]}),d))return!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!l.circle[j]){l.circle[j]=!0;const Y=3*j,ce=this.circleKeys[j];if(this._circleAndRectCollide(B[Y],B[Y+1],B[Y+2],A,E,F,O)&&(!r||r(ce))&&(!d||!te(_,ce.overlapMode))){const Se=B[Y],Te=B[Y+1],Re=B[Y+2];if(s.push({key:ce,x1:Se-Re,y1:Te-Re,x2:Se+Re,y2:Te+Re}),d)return!0}}}return!1}_queryCellCircle(A,E,F,O,y,s,i,r){const{circle:l,seenUids:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!d.box[j]){d.box[j]=!0;const Y=4*j,ce=this.boxKeys[j];if(this._circleAndRectCollide(l.x,l.y,l.radius,B[Y+0],B[Y+1],B[Y+2],B[Y+3])&&(!r||r(ce))&&!te(_,ce.overlapMode))return s.push(!0),!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!d.circle[j]){d.circle[j]=!0;const Y=3*j,ce=this.circleKeys[j];if(this._circlesCollide(B[Y],B[Y+1],B[Y+2],l.x,l.y,l.radius)&&(!r||r(ce))&&!te(_,ce.overlapMode))return s.push(!0),!0}}}_forEachCell(A,E,F,O,y,s,i,r){const l=this._convertToXCellCoord(A),d=this._convertToYCellCoord(E),_=this._convertToXCellCoord(F),w=this._convertToYCellCoord(O);for(let T=l;T<=_;T++)for(let B=d;B<=w;B++)if(y.call(this,A,E,F,O,this.xCellCount*B+T,s,i,r))return}_convertToXCellCoord(A){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(A*this.xScale)))}_convertToYCellCoord(A){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(A*this.yScale)))}_circlesCollide(A,E,F,O,y,s){const i=O-A,r=y-E,l=F+s;return l*l>i*i+r*r}_circleAndRectCollide(A,E,F,O,y,s,i){const r=(s-O)/2,l=Math.abs(A-(O+r));if(l>r+F)return!1;const d=(i-y)/2,_=Math.abs(E-(y+d));if(_>d+F)return!1;if(l<=r||_<=d)return!0;const w=l-r,T=_-d;return w*w+T*T<=F*F}}function ve(Z,A,E,F,O){const y=a.Z();return A?(a.a0(y,y,[1/O,1/O,1]),E||a.ae(y,y,F.angle)):a.a1(y,F.labelPlaneMatrix,Z),y}function Ie(Z,A,E,F,O){if(A){const y=a.af(Z);return a.a0(y,y,[O,O,1]),E||a.ae(y,y,-F.angle),y}return F.glCoordMatrix}function Ee(Z,A,E){let F;E?(F=[Z.x,Z.y,E(Z.x,Z.y),1],a.ag(F,F,A)):(F=[Z.x,Z.y,0,1],ye(F,F,A));const O=F[3];return{point:new a.P(F[0]/O,F[1]/O),signedDistanceFromCamera:O}}function ze(Z,A){return .5+Z/A*.5}function Qe(Z,A){const E=Z[0]/Z[3],F=Z[1]/Z[3];return E>=-A[0]&&E<=A[0]&&F>=-A[1]&&F<=A[1]}function He(Z,A,E,F,O,y,s,i,r,l){const d=F?Z.textSizeData:Z.iconSizeData,_=a.ah(d,E.transform.zoom),w=[256/E.width*2+1,256/E.height*2+1],T=F?Z.text.dynamicLayoutVertexArray:Z.icon.dynamicLayoutVertexArray;T.clear();const B=Z.lineVertexArray,j=F?Z.text.placedSymbolArray:Z.icon.placedSymbolArray,Y=E.transform.width/E.transform.height;let ce=!1;for(let Se=0;Se<j.length;Se++){const Te=j.get(Se);if(Te.hidden||Te.writingMode===a.ai.vertical&&!ce){de(Te.numGlyphs,T);continue}let Re;if(ce=!1,l?(Re=[Te.anchorX,Te.anchorY,l(Te.anchorX,Te.anchorY),1],a.ag(Re,Re,A)):(Re=[Te.anchorX,Te.anchorY,0,1],ye(Re,Re,A)),!Qe(Re,w)){de(Te.numGlyphs,T);continue}const Be=ze(E.transform.cameraToCenterDistance,Re[3]),Je=a.aj(d,_,Te),xt=s?Je/Be:Je*Be,at=new a.P(Te.anchorX,Te.anchorY),ct=Ee(at,O,l).point,Et={projections:{},offsets:{}},wt=ft(Te,xt,!1,i,A,O,y,Z.glyphOffsetArray,B,T,ct,at,Et,Y,r,l);ce=wt.useVertical,(wt.notEnoughRoom||ce||wt.needsFlipping&&ft(Te,xt,!0,i,A,O,y,Z.glyphOffsetArray,B,T,ct,at,Et,Y,r,l).notEnoughRoom)&&de(Te.numGlyphs,T)}F?Z.text.dynamicLayoutVertexBuffer.updateData(T):Z.icon.dynamicLayoutVertexBuffer.updateData(T)}function Ze(Z,A,E,F,O,y,s,i,r,l,d,_,w){const T=i.glyphStartIndex+i.numGlyphs,B=i.lineStartIndex,j=i.lineStartIndex+i.lineLength,Y=A.getoffsetX(i.glyphStartIndex),ce=A.getoffsetX(T-1),Se=X(Z*Y,E,F,O,y,s,i.segment,B,j,r,l,d,_,w);if(!Se)return null;const Te=X(Z*ce,E,F,O,y,s,i.segment,B,j,r,l,d,_,w);return Te?{first:Se,last:Te}:null}function Ve(Z,A,E,F){return Z===a.ai.horizontal&&Math.abs(E.y-A.y)>Math.abs(E.x-A.x)*F?{useVertical:!0}:(Z===a.ai.vertical?A.y<E.y:A.x>E.x)?{needsFlipping:!0}:null}function ft(Z,A,E,F,O,y,s,i,r,l,d,_,w,T,B,j){const Y=A/24,ce=Z.lineOffsetX*Y,Se=Z.lineOffsetY*Y;let Te;if(Z.numGlyphs>1){const Re=Z.glyphStartIndex+Z.numGlyphs,Be=Z.lineStartIndex,Je=Z.lineStartIndex+Z.lineLength,xt=Ze(Y,i,ce,Se,E,d,_,Z,r,y,w,B,j);if(!xt)return{notEnoughRoom:!0};const at=Ee(xt.first.point,s,j).point,ct=Ee(xt.last.point,s,j).point;if(F&&!E){const Et=Ve(Z.writingMode,at,ct,T);if(Et)return Et}Te=[xt.first];for(let Et=Z.glyphStartIndex+1;Et<Re-1;Et++)Te.push(X(Y*i.getoffsetX(Et),ce,Se,E,d,_,Z.segment,Be,Je,r,y,w,B,j));Te.push(xt.last)}else{if(F&&!E){const Be=Ee(_,O,j).point,Je=Z.lineStartIndex+Z.segment+1,xt=new a.P(r.getx(Je),r.gety(Je)),at=Ee(xt,O,j),ct=at.signedDistanceFromCamera>0?at.point:nt(_,xt,Be,1,O,j),Et=Ve(Z.writingMode,Be,ct,T);if(Et)return Et}const Re=X(Y*i.getoffsetX(Z.glyphStartIndex),ce,Se,E,d,_,Z.segment,Z.lineStartIndex,Z.lineStartIndex+Z.lineLength,r,y,w,B,j);if(!Re)return{notEnoughRoom:!0};Te=[Re]}for(const Re of Te)a.ak(l,Re.point,Re.angle);return{}}function nt(Z,A,E,F,O,y){const s=Ee(Z.add(Z.sub(A)._unit()),O,y).point,i=E.sub(s);return E.add(i._mult(F/i.mag()))}function Me(Z,A){const{projectionCache:E,lineVertexArray:F,labelPlaneMatrix:O,tileAnchorPoint:y,distanceFromAnchor:s,getElevation:i,previousVertex:r,direction:l,absOffsetX:d}=A;if(E.projections[Z])return E.projections[Z];const _=new a.P(F.getx(Z),F.gety(Z)),w=Ee(_,O,i);if(w.signedDistanceFromCamera>0)return E.projections[Z]=w.point,w.point;const T=Z-l;return nt(s===0?y:new a.P(F.getx(T),F.gety(T)),_,r,d-s+1,O,i)}function se(Z,A,E){return Z._unit()._perp()._mult(A*E)}function ne(Z,A,E,F,O,y,s,i){const{projectionCache:r,direction:l}=i;if(r.offsets[Z])return r.offsets[Z];const d=E.add(A);if(Z+l<F||Z+l>=O)return r.offsets[Z]=d,d;const _=Me(Z+l,i),w=se(_.sub(E),s,l),T=E.add(w),B=_.add(w);return r.offsets[Z]=a.al(y,d,T,B)||d,r.offsets[Z]}function X(Z,A,E,F,O,y,s,i,r,l,d,_,w,T){const B=F?Z-A:Z+A;let j=B>0?1:-1,Y=0;F&&(j*=-1,Y=Math.PI),j<0&&(Y+=Math.PI);let ce,Se,Te=j>0?i+s:i+s+1,Re=O,Be=O,Je=0,xt=0;const at=Math.abs(B),ct=[];let Et;for(;Je+xt<=at;){if(Te+=j,Te<i||Te>=r)return null;Je+=xt,Be=Re,Se=ce;const Yt={projectionCache:_,lineVertexArray:l,labelPlaneMatrix:d,tileAnchorPoint:y,distanceFromAnchor:Je,getElevation:T,previousVertex:Be,direction:j,absOffsetX:at};if(Re=Me(Te,Yt),E===0)ct.push(Be),Et=Re.sub(Be);else{let ei;const si=Re.sub(Be);ei=si.mag()===0?se(Me(Te+j,Yt).sub(Re),E,j):se(si,E,j),Se||(Se=Be.add(ei)),ce=ne(Te,ei,Re,i,r,Se,E,Yt),ct.push(Se),Et=ce.sub(Se)}xt=Et.mag()}const wt=Et._mult((at-Je)/xt)._add(Se||Be),ri=Y+Math.atan2(Re.y-Be.y,Re.x-Be.x);return ct.push(wt),{point:wt,angle:w?ri:0,path:ct}}const ie=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function de(Z,A){for(let E=0;E<Z;E++){const F=A.length;A.resize(F+4),A.float32.set(ie,3*F)}}function ye(Z,A,E){const F=A[0],O=A[1];return Z[0]=E[0]*F+E[4]*O+E[12],Z[1]=E[1]*F+E[5]*O+E[13],Z[3]=E[3]*F+E[7]*O+E[15],Z}const ge=100;class Pe{constructor(A,E=new fe(A.width+200,A.height+200,25),F=new fe(A.width+200,A.height+200,25)){this.transform=A,this.grid=E,this.ignoredGrid=F,this.pitchfactor=Math.cos(A._pitch)*A.cameraToCenterDistance,this.screenRightBoundary=A.width+ge,this.screenBottomBoundary=A.height+ge,this.gridRightBoundary=A.width+200,this.gridBottomBoundary=A.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(A,E,F,O,y,s){const i=this.projectAndGetPerspectiveRatio(O,A.anchorPointX,A.anchorPointY,s),r=F*i.perspectiveRatio,l=A.x1*r+i.point.x,d=A.y1*r+i.point.y,_=A.x2*r+i.point.x,w=A.y2*r+i.point.y;return!this.isInsideGrid(l,d,_,w)||E!=="always"&&this.grid.hitTest(l,d,_,w,E,y)||i.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,d,_,w],offscreen:this.isOffscreen(l,d,_,w)}}placeCollisionCircles(A,E,F,O,y,s,i,r,l,d,_,w,T,B){const j=[],Y=new a.P(E.anchorX,E.anchorY),ce=Ee(Y,s,B),Se=ze(this.transform.cameraToCenterDistance,ce.signedDistanceFromCamera),Te=(d?y/Se:y*Se)/a.ap,Re=Ee(Y,i,B).point,Be=Ze(Te,O,E.lineOffsetX*Te,E.lineOffsetY*Te,!1,Re,Y,E,F,i,{projections:{},offsets:{}},!1,B);let Je=!1,xt=!1,at=!0;if(Be){const ct=.5*w*Se+T,Et=new a.P(-100,-100),wt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),ri=new $,Yt=Be.first,ei=Be.last;let si=[];for(let Ei=Yt.path.length-1;Ei>=1;Ei--)si.push(Yt.path[Ei]);for(let Ei=1;Ei<ei.path.length;Ei++)si.push(ei.path[Ei]);const ji=2.5*ct;if(r){const Ei=si.map(Ui=>Ee(Ui,r,B));si=Ei.some(Ui=>Ui.signedDistanceFromCamera<=0)?[]:Ei.map(Ui=>Ui.point)}let Qi=[];if(si.length>0){const Ei=si[0].clone(),Ui=si[0].clone();for(let Gi=1;Gi<si.length;Gi++)Ei.x=Math.min(Ei.x,si[Gi].x),Ei.y=Math.min(Ei.y,si[Gi].y),Ui.x=Math.max(Ui.x,si[Gi].x),Ui.y=Math.max(Ui.y,si[Gi].y);Qi=Ei.x>=Et.x&&Ui.x<=wt.x&&Ei.y>=Et.y&&Ui.y<=wt.y?[si]:Ui.x<Et.x||Ei.x>wt.x||Ui.y<Et.y||Ei.y>wt.y?[]:a.am([si],Et.x,Et.y,wt.x,wt.y)}for(const Ei of Qi){ri.reset(Ei,.25*ct);let Ui=0;Ui=ri.length<=.5*ct?1:Math.ceil(ri.paddedLength/ji)+1;for(let Gi=0;Gi<Ui;Gi++){const ln=Gi/Math.max(Ui-1,1),Bn=ri.lerp(ln),rn=Bn.x+ge,kn=Bn.y+ge;j.push(rn,kn,ct,0);const yr=rn-ct,er=kn-ct,Ia=rn+ct,Aa=kn+ct;if(at=at&&this.isOffscreen(yr,er,Ia,Aa),xt=xt||this.isInsideGrid(yr,er,Ia,Aa),A!=="always"&&this.grid.hitTestCircle(rn,kn,ct,A,_)&&(Je=!0,!l))return{circles:[],offscreen:!1,collisionDetected:Je}}}}return{circles:!l&&Je||!xt||Se<this.perspectiveRatioCutoff?[]:j,offscreen:at,collisionDetected:Je}}queryRenderedSymbols(A){if(A.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const E=[];let F=1/0,O=1/0,y=-1/0,s=-1/0;for(const d of A){const _=new a.P(d.x+ge,d.y+ge);F=Math.min(F,_.x),O=Math.min(O,_.y),y=Math.max(y,_.x),s=Math.max(s,_.y),E.push(_)}const i=this.grid.query(F,O,y,s).concat(this.ignoredGrid.query(F,O,y,s)),r={},l={};for(const d of i){const _=d.key;if(r[_.bucketInstanceId]===void 0&&(r[_.bucketInstanceId]={}),r[_.bucketInstanceId][_.featureIndex])continue;const w=[new a.P(d.x1,d.y1),new a.P(d.x2,d.y1),new a.P(d.x2,d.y2),new a.P(d.x1,d.y2)];a.an(E,w)&&(r[_.bucketInstanceId][_.featureIndex]=!0,l[_.bucketInstanceId]===void 0&&(l[_.bucketInstanceId]=[]),l[_.bucketInstanceId].push(_.featureIndex))}return l}insertCollisionBox(A,E,F,O,y,s){(F?this.ignoredGrid:this.grid).insert({bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:E},A[0],A[1],A[2],A[3])}insertCollisionCircles(A,E,F,O,y,s){const i=F?this.ignoredGrid:this.grid,r={bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:E};for(let l=0;l<A.length;l+=4)i.insertCircle(r,A[l],A[l+1],A[l+2])}projectAndGetPerspectiveRatio(A,E,F,O){let y;return O?(y=[E,F,O(E,F),1],a.ag(y,y,A)):(y=[E,F,0,1],ye(y,y,A)),{point:new a.P((y[0]/y[3]+1)/2*this.transform.width+ge,(-y[1]/y[3]+1)/2*this.transform.height+ge),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}}isOffscreen(A,E,F,O){return F<ge||A>=this.screenRightBoundary||O<ge||E>this.screenBottomBoundary}isInsideGrid(A,E,F,O){return F>=0&&A<this.gridRightBoundary&&O>=0&&E<this.gridBottomBoundary}getViewportMatrix(){const A=a.ao([]);return a.$(A,A,[-100,-100,0]),A}}function Fe(Z,A,E){return A*(a.N/(Z.tileSize*Math.pow(2,E-Z.tileID.overscaledZ)))}class Ne{constructor(A,E,F,O){this.opacity=A?Math.max(0,Math.min(1,A.opacity+(A.placed?E:-E))):O&&F?1:0,this.placed=F}isHidden(){return this.opacity===0&&!this.placed}}class Xe{constructor(A,E,F,O,y){this.text=new Ne(A?A.text:null,E,F,y),this.icon=new Ne(A?A.icon:null,E,O,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ye{constructor(A,E,F){this.text=A,this.icon=E,this.skipFade=F}}class De{constructor(){this.invProjMatrix=a.Z(),this.viewportMatrix=a.Z(),this.circles=[]}}class Ue{constructor(A,E,F,O,y){this.bucketInstanceId=A,this.featureIndex=E,this.sourceLayerIndex=F,this.bucketIndex=O,this.tileID=y}}class ht{constructor(A){this.crossSourceCollisions=A,this.maxGroupID=0,this.collisionGroups={}}get(A){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[A]){const E=++this.maxGroupID;this.collisionGroups[A]={ID:E,predicate:F=>F.collisionGroupID===E}}return this.collisionGroups[A]}}function kt(Z,A,E,F,O){const{horizontalAlign:y,verticalAlign:s}=a.au(Z);return new a.P(-(y-.5)*A+F[0]*O,-(s-.5)*E+F[1]*O)}function o(Z,A,E,F,O,y){const{x1:s,x2:i,y1:r,y2:l,anchorPointX:d,anchorPointY:_}=Z,w=new a.P(A,E);return F&&w._rotate(O?y:-y),{x1:s+w.x,y1:r+w.y,x2:i+w.x,y2:l+w.y,anchorPointX:d,anchorPointY:_}}class ke{constructor(A,E,F,O,y){this.transform=A.clone(),this.terrain=E,this.collisionIndex=new Pe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=F,this.retainedQueryData={},this.collisionGroups=new ht(O),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(A,E,F,O){const y=F.getBucket(E),s=F.latestFeatureIndex;if(!y||!s||E.id!==y.layerIds[0])return;const i=F.collisionBoxArray,r=y.layers[0].layout,l=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),d=F.tileSize/a.N,_=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),w=r.get("text-pitch-alignment")==="map",T=r.get("text-rotation-alignment")==="map",B=Fe(F,1,this.transform.zoom),j=ve(_,w,T,this.transform,B);let Y=null;if(w){const Se=Ie(_,w,T,this.transform,B);Y=a.a1([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[y.bucketInstanceId]=new Ue(y.bucketInstanceId,s,y.sourceLayerIndex,y.index,F.tileID);const ce={bucket:y,layout:r,posMatrix:_,textLabelPlaneMatrix:j,labelToScreenMatrix:Y,scale:l,textPixelRatio:d,holdingForFade:F.holdingForFade(),collisionBoxArray:i,partiallyEvaluatedTextSize:a.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(O)for(const Se of y.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be}=Se;A.push({sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be,parameters:ce})}else A.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(A,E,F,O,y,s,i,r,l,d,_,w,T,B,j,Y){const ce=a.aq[A.textAnchor],Se=[A.textOffset0,A.textOffset1],Te=kt(ce,F,O,Se,y),Re=this.collisionIndex.placeCollisionBox(o(E,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,Y);if((!j||this.collisionIndex.placeCollisionBox(o(j,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,Y).box.length!==0)&&Re.box.length>0){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[w.crossTileID].anchor),w.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[w.crossTileID]={textOffset:Se,width:F,height:O,anchor:ce,textBoxScale:y,prevAnchor:Be},this.markUsedJustification(T,ce,w,B),T.allowVerticalPlacement&&(this.markUsedOrientation(T,B,w),this.placedOrientations[w.crossTileID]=B),{shift:Te,placedGlyphBoxes:Re}}}placeLayerBucketPart(A,E,F){const{bucket:O,layout:y,posMatrix:s,textLabelPlaneMatrix:i,labelToScreenMatrix:r,textPixelRatio:l,holdingForFade:d,collisionBoxArray:_,partiallyEvaluatedTextSize:w,collisionGroup:T}=A.parameters,B=y.get("text-optional"),j=y.get("icon-optional"),Y=a.ar(y,"text-overlap","text-allow-overlap"),ce=Y==="always",Se=a.ar(y,"icon-overlap","icon-allow-overlap"),Te=Se==="always",Re=y.get("text-rotation-alignment")==="map",Be=y.get("text-pitch-alignment")==="map",Je=y.get("icon-text-fit")!=="none",xt=y.get("symbol-z-order")==="viewport-y",at=ce&&(Te||!O.hasIconData()||j),ct=Te&&(ce||!O.hasTextData()||B);!O.collisionArrays&&_&&O.deserializeCollisionBoxes(_);const Et=this.retainedQueryData[O.bucketInstanceId].tileID,wt=this.terrain?(Yt,ei)=>this.terrain.getElevation(Et,Yt,ei):null,ri=(Yt,ei)=>{var si,ji;if(E[Yt.crossTileID])return;if(d)return void(this.placements[Yt.crossTileID]=new Ye(!1,!1,!1));let Qi=!1,Ei=!1,Ui=!0,Gi=null,ln={box:null,offscreen:null},Bn={box:null,offscreen:null},rn=null,kn=null,yr=null,er=0,Ia=0,Aa=0;ei.textFeatureIndex?er=ei.textFeatureIndex:Yt.useRuntimeCollisionCircles&&(er=Yt.featureIndex),ei.verticalTextFeatureIndex&&(Ia=ei.verticalTextFeatureIndex);const Bs=ei.textBox;if(Bs){const qr=Zs=>{let ts=a.ai.horizontal;if(O.allowVerticalPlacement&&!Zs&&this.prevPlacement){const is=this.prevPlacement.placedOrientations[Yt.crossTileID];is&&(this.placedOrientations[Yt.crossTileID]=is,ts=is,this.markUsedOrientation(O,ts,Yt))}return ts},ya=(Zs,ts)=>{if(O.allowVerticalPlacement&&Yt.numVerticalGlyphVertices>0&&ei.verticalTextBox){for(const is of O.writingModes)if(is===a.ai.vertical?(ln=ts(),Bn=ln):ln=Zs(),ln&&ln.box&&ln.box.length)break}else ln=Zs()},_o=Yt.textAnchorOffsetStartIndex,yo=Yt.textAnchorOffsetEndIndex;if(yo===_o){const Zs=(ts,is)=>{const zr=this.collisionIndex.placeCollisionBox(ts,Y,l,s,T.predicate,wt);return zr&&zr.box&&zr.box.length&&(this.markUsedOrientation(O,is,Yt),this.placedOrientations[Yt.crossTileID]=is),zr};ya(()=>Zs(Bs,a.ai.horizontal),()=>{const ts=ei.verticalTextBox;return O.allowVerticalPlacement&&Yt.numVerticalGlyphVertices>0&&ts?Zs(ts,a.ai.vertical):{box:null,offscreen:null}}),qr(ln&&ln.box&&ln.box.length)}else{let Zs=a.aq[(ji=(si=this.prevPlacement)===null||si===void 0?void 0:si.variableOffsets[Yt.crossTileID])===null||ji===void 0?void 0:ji.anchor];const ts=(zr,bs,Qs)=>{const Mo=zr.x2-zr.x1,No=zr.y2-zr.y1,Vo=Yt.textBoxScale,Sc=Je&&Se==="never"?bs:null;let Ws={box:[],offscreen:!1},Zl=Y==="never"?1:2,hu="never";Zs&&Zl++;for(let il=0;il<Zl;il++){for(let vl=_o;vl<yo;vl++){const Pl=O.textAnchorOffsets.get(vl);if(Zs&&Pl.textAnchor!==Zs)continue;const Au=this.attemptAnchorPlacement(Pl,zr,Mo,No,Vo,Re,Be,l,s,T,hu,Yt,O,Qs,Sc,wt);if(Au&&(Ws=Au.placedGlyphBoxes,Ws&&Ws.box&&Ws.box.length))return Qi=!0,Gi=Au.shift,Ws}Zs?Zs=null:hu=Y}return Ws};ya(()=>ts(Bs,ei.iconBox,a.ai.horizontal),()=>{const zr=ei.verticalTextBox;return O.allowVerticalPlacement&&!(ln&&ln.box&&ln.box.length)&&Yt.numVerticalGlyphVertices>0&&zr?ts(zr,ei.verticalIconBox,a.ai.vertical):{box:null,offscreen:null}}),ln&&(Qi=ln.box,Ui=ln.offscreen);const is=qr(ln&&ln.box);if(!Qi&&this.prevPlacement){const zr=this.prevPlacement.variableOffsets[Yt.crossTileID];zr&&(this.variableOffsets[Yt.crossTileID]=zr,this.markUsedJustification(O,zr.anchor,Yt,is))}}}if(rn=ln,Qi=rn&&rn.box&&rn.box.length>0,Ui=rn&&rn.offscreen,Yt.useRuntimeCollisionCircles){const qr=O.text.placedSymbolArray.get(Yt.centerJustifiedTextSymbolIndex),ya=a.aj(O.textSizeData,w,qr),_o=y.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(Y,qr,O.lineVertexArray,O.glyphOffsetArray,ya,s,i,r,F,Be,T.predicate,Yt.collisionCircleDiameter,_o,wt),kn.circles.length&&kn.collisionDetected&&!F&&a.w("Collisions detected, but collision boxes are not shown"),Qi=ce||kn.circles.length>0&&!kn.collisionDetected,Ui=Ui&&kn.offscreen}if(ei.iconFeatureIndex&&(Aa=ei.iconFeatureIndex),ei.iconBox){const qr=ya=>{const _o=Je&&Gi?o(ya,Gi.x,Gi.y,Re,Be,this.transform.angle):ya;return this.collisionIndex.placeCollisionBox(_o,Se,l,s,T.predicate,wt)};Bn&&Bn.box&&Bn.box.length&&ei.verticalIconBox?(yr=qr(ei.verticalIconBox),Ei=yr.box.length>0):(yr=qr(ei.iconBox),Ei=yr.box.length>0),Ui=Ui&&yr.offscreen}const so=B||Yt.numHorizontalGlyphVertices===0&&Yt.numVerticalGlyphVertices===0,ao=j||Yt.numIconVertices===0;if(so||ao?ao?so||(Ei=Ei&&Qi):Qi=Ei&&Qi:Ei=Qi=Ei&&Qi,Qi&&rn&&rn.box&&this.collisionIndex.insertCollisionBox(rn.box,Y,y.get("text-ignore-placement"),O.bucketInstanceId,Bn&&Bn.box&&Ia?Ia:er,T.ID),Ei&&yr&&this.collisionIndex.insertCollisionBox(yr.box,Se,y.get("icon-ignore-placement"),O.bucketInstanceId,Aa,T.ID),kn&&(Qi&&this.collisionIndex.insertCollisionCircles(kn.circles,Y,y.get("text-ignore-placement"),O.bucketInstanceId,er,T.ID),F)){const qr=O.bucketInstanceId;let ya=this.collisionCircleArrays[qr];ya===void 0&&(ya=this.collisionCircleArrays[qr]=new De);for(let _o=0;_o<kn.circles.length;_o+=4)ya.circles.push(kn.circles[_o+0]),ya.circles.push(kn.circles[_o+1]),ya.circles.push(kn.circles[_o+2]),ya.circles.push(kn.collisionDetected?1:0)}if(Yt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(O.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Yt.crossTileID]=new Ye(Qi||at,Ei||ct,Ui||O.justReloaded),E[Yt.crossTileID]=!0};if(xt){if(A.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Yt=O.getSortedSymbolIndexes(this.transform.angle);for(let ei=Yt.length-1;ei>=0;--ei){const si=Yt[ei];ri(O.symbolInstances.get(si),O.collisionArrays[si])}}else for(let Yt=A.symbolInstanceStart;Yt<A.symbolInstanceEnd;Yt++)ri(O.symbolInstances.get(Yt),O.collisionArrays[Yt]);if(F&&O.bucketInstanceId in this.collisionCircleArrays){const Yt=this.collisionCircleArrays[O.bucketInstanceId];a.as(Yt.invProjMatrix,s),Yt.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1}markUsedJustification(A,E,F,O){let y;y=O===a.ai.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[a.at(E)];const s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];for(const i of s)i>=0&&(A.text.placedSymbolArray.get(i).crossTileID=y>=0&&i!==y?0:F.crossTileID)}markUsedOrientation(A,E,F){const O=E===a.ai.horizontal||E===a.ai.horizontalOnly?E:0,y=E===a.ai.vertical?E:0,s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];for(const i of s)A.text.placedSymbolArray.get(i).placedOrientation=O;F.verticalPlacedTextSymbolIndex&&(A.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(A){this.commitTime=A,this.zoomAtLastRecencyCheck=this.transform.zoom;const E=this.prevPlacement;let F=!1;this.prevZoomAdjustment=E?E.zoomAdjustment(this.transform.zoom):0;const O=E?E.symbolFadeChange(A):1,y=E?E.opacities:{},s=E?E.variableOffsets:{},i=E?E.placedOrientations:{};for(const r in this.placements){const l=this.placements[r],d=y[r];d?(this.opacities[r]=new Xe(d,O,l.text,l.icon),F=F||l.text!==d.text.placed||l.icon!==d.icon.placed):(this.opacities[r]=new Xe(null,O,l.text,l.icon,l.skipFade),F=F||l.text||l.icon)}for(const r in y){const l=y[r];if(!this.opacities[r]){const d=new Xe(l,O,!1,!1);d.isHidden()||(this.opacities[r]=d,F=F||l.text.placed||l.icon.placed)}}for(const r in s)this.variableOffsets[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.variableOffsets[r]=s[r]);for(const r in i)this.placedOrientations[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.placedOrientations[r]=i[r]);if(E&&E.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");F?this.lastPlacementChangeTime=A:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=E?E.lastPlacementChangeTime:A)}updateLayerOpacities(A,E){const F={};for(const O of E){const y=O.getBucket(A);y&&O.latestFeatureIndex&&A.id===y.layerIds[0]&&this.updateBucketOpacities(y,F,O.collisionBoxArray)}}updateBucketOpacities(A,E,F){A.hasTextData()&&(A.text.opacityVertexArray.clear(),A.text.hasVisibleVertices=!1),A.hasIconData()&&(A.icon.opacityVertexArray.clear(),A.icon.hasVisibleVertices=!1),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexArray.clear(),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexArray.clear();const O=A.layers[0],y=O.layout,s=new Xe(null,0,!1,!1,!0),i=y.get("text-allow-overlap"),r=y.get("icon-allow-overlap"),l=O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"),d=y.get("text-rotation-alignment")==="map",_=y.get("text-pitch-alignment")==="map",w=y.get("icon-text-fit")!=="none",T=new Xe(null,0,i&&(r||!A.hasIconData()||y.get("icon-optional")),r&&(i||!A.hasTextData()||y.get("text-optional")),!0);!A.collisionArrays&&F&&(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData())&&A.deserializeCollisionBoxes(F);const B=(j,Y,ce)=>{for(let Se=0;Se<Y/4;Se++)j.opacityVertexArray.emplaceBack(ce);j.hasVisibleVertices=j.hasVisibleVertices||ce!==vn};for(let j=0;j<A.symbolInstances.length;j++){const Y=A.symbolInstances.get(j),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:Se,crossTileID:Te}=Y;let Re=this.opacities[Te];E[Te]?Re=s:Re||(Re=T,this.opacities[Te]=Re),E[Te]=!0;const Be=Y.numIconVertices>0,Je=this.placedOrientations[Y.crossTileID],xt=Je===a.ai.vertical,at=Je===a.ai.horizontal||Je===a.ai.horizontalOnly;if(ce>0||Se>0){const ct=$t(Re.text);B(A.text,ce,xt?vn:ct),B(A.text,Se,at?vn:ct);const Et=Re.text.isHidden();[Y.rightJustifiedTextSymbolIndex,Y.centerJustifiedTextSymbolIndex,Y.leftJustifiedTextSymbolIndex].forEach(Yt=>{Yt>=0&&(A.text.placedSymbolArray.get(Yt).hidden=Et||xt?1:0)}),Y.verticalPlacedTextSymbolIndex>=0&&(A.text.placedSymbolArray.get(Y.verticalPlacedTextSymbolIndex).hidden=Et||at?1:0);const wt=this.variableOffsets[Y.crossTileID];wt&&this.markUsedJustification(A,wt.anchor,Y,Je);const ri=this.placedOrientations[Y.crossTileID];ri&&(this.markUsedJustification(A,"left",Y,ri),this.markUsedOrientation(A,ri,Y))}if(Be){const ct=$t(Re.icon),Et=!(w&&Y.verticalPlacedIconSymbolIndex&&xt);Y.placedIconSymbolIndex>=0&&(B(A.icon,Y.numIconVertices,Et?ct:vn),A.icon.placedSymbolArray.get(Y.placedIconSymbolIndex).hidden=Re.icon.isHidden()),Y.verticalPlacedIconSymbolIndex>=0&&(B(A.icon,Y.numVerticalIconVertices,Et?vn:ct),A.icon.placedSymbolArray.get(Y.verticalPlacedIconSymbolIndex).hidden=Re.icon.isHidden())}if(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData()){const ct=A.collisionArrays[j];if(ct){let Et=new a.P(0,0);if(ct.textBox||ct.verticalTextBox){let ri=!0;if(l){const Yt=this.variableOffsets[Te];Yt?(Et=kt(Yt.anchor,Yt.width,Yt.height,Yt.textOffset,Yt.textBoxScale),d&&Et._rotate(_?this.transform.angle:-this.transform.angle)):ri=!1}ct.textBox&&oi(A.textCollisionBox.collisionVertexArray,Re.text.placed,!ri||xt,Et.x,Et.y),ct.verticalTextBox&&oi(A.textCollisionBox.collisionVertexArray,Re.text.placed,!ri||at,Et.x,Et.y)}const wt=!!(!at&&ct.verticalIconBox);ct.iconBox&&oi(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,wt,w?Et.x:0,w?Et.y:0),ct.verticalIconBox&&oi(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,!wt,w?Et.x:0,w?Et.y:0)}}}if(A.sortFeatures(this.transform.angle),this.retainedQueryData[A.bucketInstanceId]&&(this.retainedQueryData[A.bucketInstanceId].featureSortOrder=A.featureSortOrder),A.hasTextData()&&A.text.opacityVertexBuffer&&A.text.opacityVertexBuffer.updateData(A.text.opacityVertexArray),A.hasIconData()&&A.icon.opacityVertexBuffer&&A.icon.opacityVertexBuffer.updateData(A.icon.opacityVertexArray),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexBuffer&&A.iconCollisionBox.collisionVertexBuffer.updateData(A.iconCollisionBox.collisionVertexArray),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexBuffer&&A.textCollisionBox.collisionVertexBuffer.updateData(A.textCollisionBox.collisionVertexArray),A.text.opacityVertexArray.length!==A.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${A.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${A.text.layoutVertexArray.length}) / 4`);if(A.icon.opacityVertexArray.length!==A.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${A.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${A.icon.layoutVertexArray.length}) / 4`);if(A.bucketInstanceId in this.collisionCircleArrays){const j=this.collisionCircleArrays[A.bucketInstanceId];A.placementInvProjMatrix=j.invProjMatrix,A.placementViewportMatrix=j.viewportMatrix,A.collisionCircleArray=j.circles,delete this.collisionCircleArrays[A.bucketInstanceId]}}symbolFadeChange(A){return this.fadeDuration===0?1:(A-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(A){return Math.max(0,(this.transform.zoom-A)/1.5)}hasTransitions(A){return this.stale||A-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(A,E){const F=this.zoomAtLastRecencyCheck===E?1-this.zoomAdjustment(E):1;return this.zoomAtLastRecencyCheck=E,this.commitTime+this.fadeDuration*F>A}setStale(){this.stale=!0}}function oi(Z,A,E,F,O){Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0),Z.emplaceBack(A?1:0,E?1:0,F||0,O||0)}const di=Math.pow(2,25),Ai=Math.pow(2,24),Jt=Math.pow(2,17),li=Math.pow(2,16),zi=Math.pow(2,9),vi=Math.pow(2,8),wi=Math.pow(2,1);function $t(Z){if(Z.opacity===0&&!Z.placed)return 0;if(Z.opacity===1&&Z.placed)return 4294967295;const A=Z.placed?1:0,E=Math.floor(127*Z.opacity);return E*di+A*Ai+E*Jt+A*li+E*zi+A*vi+E*wi+A}const vn=0;class or{constructor(A){this._sortAcrossTiles=A.layout.get("symbol-z-order")!=="viewport-y"&&!A.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(A,E,F,O,y){const s=this._bucketParts;for(;this._currentTileIndex<A.length;)if(E.getBucketParts(s,O,A[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((i,r)=>i.sortKey-r.sortKey));this._currentPartIndex<s.length;)if(E.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,F),this._currentPartIndex++,y())return!0;return!1}}class mn{constructor(A,E,F,O,y,s,i,r){this.placement=new ke(A,E,s,i,r),this._currentPlacementIndex=F.length-1,this._forceFullPlacement=O,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(A,E,F){const O=a.h.now(),y=()=>!this._forceFullPlacement&&a.h.now()-O>2;for(;this._currentPlacementIndex>=0;){const s=E[A[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=i)&&(!s.maxzoom||s.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new or(s)),this._inProgressLayer.continuePlacement(F[s.source],this.placement,this._showCollisionBoxes,s,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(A){return this.placement.commit(A),this.placement}}const qn=512/a.N/2;class jr{constructor(A,E,F){this.tileID=A,this.bucketInstanceId=F,this._symbolsByKey={};const O=new Map;for(let y=0;y<E.length;y++){const s=E.get(y),i=s.key,r=O.get(i);r?r.push(s):O.set(i,[s])}for(const[y,s]of O){const i={positions:s.map(r=>({x:Math.floor(r.anchorX*qn),y:Math.floor(r.anchorY*qn)})),crossTileIDs:s.map(r=>r.crossTileID)};if(i.positions.length>128){const r=new a.av(i.positions.length,16,Uint16Array);for(const{x:l,y:d}of i.positions)r.add(l,d);r.finish(),delete i.positions,i.index=r}this._symbolsByKey[y]=i}}getScaledCoordinates(A,E){const{x:F,y:O,z:y}=this.tileID.canonical,{x:s,y:i,z:r}=E.canonical,l=qn/Math.pow(2,r-y),d=(i*a.N+A.anchorY)*l,_=O*a.N*qn;return{x:Math.floor((s*a.N+A.anchorX)*l-F*a.N*qn),y:Math.floor(d-_)}}findMatches(A,E,F){const O=this.tileID.canonical.z<E.canonical.z?1:Math.pow(2,this.tileID.canonical.z-E.canonical.z);for(let y=0;y<A.length;y++){const s=A.get(y);if(s.crossTileID)continue;const i=this._symbolsByKey[s.key];if(!i)continue;const r=this.getScaledCoordinates(s,E);if(i.index){const l=i.index.range(r.x-O,r.y-O,r.x+O,r.y+O).sort();for(const d of l){const _=i.crossTileIDs[d];if(!F[_]){F[_]=!0,s.crossTileID=_;break}}}else if(i.positions)for(let l=0;l<i.positions.length;l++){const d=i.positions[l],_=i.crossTileIDs[l];if(Math.abs(d.x-r.x)<=O&&Math.abs(d.y-r.y)<=O&&!F[_]){F[_]=!0,s.crossTileID=_;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:A})=>A)}}class Hi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ur{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(A){const E=Math.round((A-this.lng)/360);if(E!==0)for(const F in this.indexes){const O=this.indexes[F],y={};for(const s in O){const i=O[s];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+E),y[i.tileID.key]=i}this.indexes[F]=y}this.lng=A}addBucket(A,E,F){if(this.indexes[A.overscaledZ]&&this.indexes[A.overscaledZ][A.key]){if(this.indexes[A.overscaledZ][A.key].bucketInstanceId===E.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(A.overscaledZ,this.indexes[A.overscaledZ][A.key])}for(let y=0;y<E.symbolInstances.length;y++)E.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[A.overscaledZ]||(this.usedCrossTileIDs[A.overscaledZ]={});const O=this.usedCrossTileIDs[A.overscaledZ];for(const y in this.indexes){const s=this.indexes[y];if(Number(y)>A.overscaledZ)for(const i in s){const r=s[i];r.tileID.isChildOf(A)&&r.findMatches(E.symbolInstances,A,O)}else{const i=s[A.scaledTo(Number(y)).key];i&&i.findMatches(E.symbolInstances,A,O)}}for(let y=0;y<E.symbolInstances.length;y++){const s=E.symbolInstances.get(y);s.crossTileID||(s.crossTileID=F.generate(),O[s.crossTileID]=!0)}return this.indexes[A.overscaledZ]===void 0&&(this.indexes[A.overscaledZ]={}),this.indexes[A.overscaledZ][A.key]=new jr(A,E.symbolInstances,E.bucketInstanceId),!0}removeBucketCrossTileIDs(A,E){for(const F of E.getCrossTileIDsLists())for(const O of F)delete this.usedCrossTileIDs[A][O]}removeStaleBuckets(A){let E=!1;for(const F in this.indexes){const O=this.indexes[F];for(const y in O)A[O[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,O[y]),delete O[y],E=!0)}return E}}class On{constructor(){this.layerIndexes={},this.crossTileIDs=new Hi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(A,E,F){let O=this.layerIndexes[A.id];O===void 0&&(O=this.layerIndexes[A.id]=new ur);let y=!1;const s={};O.handleWrapJump(F);for(const i of E){const r=i.getBucket(A);r&&A.id===r.layerIds[0]&&(r.bucketInstanceId||(r.bucketInstanceId=++this.maxBucketInstanceId),O.addBucket(i.tileID,r,this.crossTileIDs)&&(y=!0),s[r.bucketInstanceId]=!0)}return O.removeStaleBuckets(s)&&(y=!0),y}pruneUnusedLayers(A){const E={};A.forEach(F=>{E[F]=!0});for(const F in this.layerIndexes)E[F]||delete this.layerIndexes[F]}}const Qt=(Z,A)=>a.x(Z,A&&A.filter(E=>E.identifier!=="source.canvas")),Yi=a.F(a.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Ut=a.F(a.ax,["setCenter","setZoom","setBearing","setPitch"]),Tn=a.aw();class cr extends a.E{constructor(A,E={}){super(),this.map=A,this.dispatcher=new Si(V(),this,A._getMapId()),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new st(A._requestManager,E.localIdeographFontFamily),this.lineAtlas=new _i(256,512),this.crossTileSymbolIndex=new On,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.az());const F=this;this._rtlTextPluginCallback=cr.registerForPluginStateChange(O=>{F.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:O.pluginStatus,pluginURL:O.pluginURL},(y,s)=>{if(a.aA(y),s&&s.every(i=>i))for(const i in F.sourceCaches){const r=F.sourceCaches[i].getSource().type;r!=="vector"&&r!=="geojson"||F.sourceCaches[i].reload()}})}),this.on("data",O=>{if(O.dataType!=="source"||O.sourceDataType!=="metadata")return;const y=this.sourceCaches[O.sourceId];if(!y)return;const s=y.getSource();if(s&&s.vectorLayerIds)for(const i in this._layers){const r=this._layers[i];r.source===s.id&&this._validateLayer(r)}})}loadURL(A,E={},F){this.fire(new a.k("dataloading",{dataType:"style"})),E.validate=typeof E.validate!="boolean"||E.validate;const O=this.map._requestManager.transformRequest(A,lt.Style);this._request=a.f(O,(y,s)=>{this._request=null,y?this.fire(new a.j(y)):s&&this._load(s,E,F)})}loadJSON(A,E={},F){this.fire(new a.k("dataloading",{dataType:"style"})),this._request=a.h.frame(()=>{this._request=null,E.validate=E.validate!==!1,this._load(A,E,F)})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(Tn,{validate:!1})}_load(A,E,F){var O;const y=E.transformStyle?E.transformStyle(F,A):A;if(!E.validate||!Qt(this,a.y(y))){this._loaded=!0,this.stylesheet=y;for(const s in y.sources)this.addSource(s,y.sources[s],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new Ot(this.stylesheet.light),this.map.setTerrain((O=this.stylesheet.terrain)!==null&&O!==void 0?O:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const A=a.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",A),this._order=A.map(E=>E.id),this._layers={},this._serializedLayers=null;for(const E of A){const F=a.aC(E);F.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=F}}_loadSprite(A,E=!1,F=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(O,y,s,i){const r=rt(O),l=r.length,d=s>1?"@2x":"",_={},w={},T={};for(const{id:B,url:j}of r){const Y=y.transformRequest(y.normalizeSpriteURL(j,d,".json"),lt.SpriteJSON),ce=`${B}_${Y.url}`;_[ce]=a.f(Y,(Re,Be)=>{delete _[ce],w[B]=Be,yt(i,w,T,Re,l)});const Se=y.transformRequest(y.normalizeSpriteURL(j,d,".png"),lt.SpriteImage),Te=`${B}_${Se.url}`;_[Te]=tt.getImage(Se,(Re,Be)=>{delete _[Te],T[B]=Be,yt(i,w,T,Re,l)})}return{cancel(){for(const B of Object.values(_))B.cancel()}}}(A,this.map._requestManager,this.map.getPixelRatio(),(O,y)=>{if(this._spriteRequest=null,O)this.fire(new a.j(O));else if(y)for(const s in y){this._spritesImagesIds[s]=[];const i=this._spritesImagesIds[s]?this._spritesImagesIds[s].filter(r=>!(r in y)):[];for(const r of i)this.imageManager.removeImage(r),this._changedImages[r]=!0;for(const r in y[s]){const l=s==="default"?r:`${s}:${r}`;this._spritesImagesIds[s].push(l),l in this.imageManager.images?this.imageManager.updateImage(l,y[s][r],!1):this.imageManager.addImage(l,y[s][r]),E&&(this._changedImages[l]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),E&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),F&&F(O)})}_unloadSprite(){for(const A of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(A),this._changedImages[A]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(A){const E=this.sourceCaches[A.source];if(!E)return;const F=A.sourceLayer;if(!F)return;const O=E.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(F)===-1)&&this.fire(new a.j(new Error(`Source layer "${F}" does not exist on source "${O.id}" as specified by style layer "${A.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const A in this.sourceCaches)if(!this.sourceCaches[A].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(A){const E=this._serializedAllLayers();if(!A||A.length===0)return Object.values(E);const F=[];for(const O of A)E[O]&&F.push(E[O]);return F}_serializedAllLayers(){let A=this._serializedLayers;if(A)return A;A=this._serializedLayers={};const E=Object.keys(this._layers);for(const F of E){const O=this._layers[F];O.type!=="custom"&&(A[F]=O.serialize())}return A}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const A in this.sourceCaches)if(this.sourceCaches[A].hasTransition())return!0;for(const A in this._layers)if(this._layers[A].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(A){if(!this._loaded)return;const E=this._changed;if(this._changed){const O=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(O.length||y.length)&&this._updateWorkerLayers(O,y);for(const s in this._updatedSources){const i=this._updatedSources[s];if(i==="reload")this._reloadSource(s);else{if(i!=="clear")throw new Error(`Invalid action ${i}`);this._clearSource(s)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const s in this._updatedPaintProps)this._layers[s].updateTransitions(A);this.light.updateTransitions(A),this._resetUpdates()}const F={};for(const O in this.sourceCaches){const y=this.sourceCaches[O];F[O]=y.used,y.used=!1}for(const O of this._order){const y=this._layers[O];y.recalculate(A,this._availableImages),!y.isHidden(A.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const O in F){const y=this.sourceCaches[O];F[O]!==y.used&&y.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:O}))}this.light.recalculate(A),this.z=A.zoom,E&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const A=Object.keys(this._changedImages);if(A.length){for(const E in this.sourceCaches)this.sourceCaches[E].reloadTilesForDependencies(["icons","patterns"],A);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(A,E){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(A),removedIds:E})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(A,E={}){this._checkLoaded();const F=this.serialize();if(A=E.transformStyle?E.transformStyle(F,A):A,Qt(this,a.y(A)))return!1;(A=a.aD(A)).layers=a.aB(A.layers);const O=a.aE(F,A).filter(s=>!(s.command in Ut));if(O.length===0)return!1;const y=O.filter(s=>!(s.command in Yi));if(y.length>0)throw new Error(`Unimplemented: ${y.map(s=>s.command).join(", ")}.`);for(const s of O)s.command!=="setTransition"&&this[s.command].apply(this,s.args);return this.stylesheet=A,this._serializedLayers=null,!0}addImage(A,E){if(this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" already exists.`)));this.imageManager.addImage(A,E),this._afterImageUpdated(A)}updateImage(A,E){this.imageManager.updateImage(A,E)}getImage(A){return this.imageManager.getImage(A)}removeImage(A){if(!this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" does not exist.`)));this.imageManager.removeImage(A),this._afterImageUpdated(A)}_afterImageUpdated(A){this._availableImages=this.imageManager.listImages(),this._changedImages[A]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(A,E,F={}){if(this._checkLoaded(),this.sourceCaches[A]!==void 0)throw new Error(`Source "${A}" already exists.`);if(!E.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(E).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(E.type)>=0&&this._validate(a.y.source,`sources.${A}`,E,null,F))return;this.map&&this.map._collectResourceTiming&&(E.collectResourceTiming=!0);const O=this.sourceCaches[A]=new en(A,E,this.dispatcher);O.style=this,O.setEventedParent(this,()=>({isSourceLoaded:O.loaded(),source:O.serialize(),sourceId:A})),O.onAdd(this.map),this._changed=!0}removeSource(A){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error("There is no source with this ID");for(const F in this._layers)if(this._layers[F].source===A)return this.fire(new a.j(new Error(`Source "${A}" cannot be removed while layer "${F}" is using it.`)));const E=this.sourceCaches[A];delete this.sourceCaches[A],delete this._updatedSources[A],E.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:A})),E.setEventedParent(null),E.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(A,E){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error(`There is no source with this ID=${A}`);const F=this.sourceCaches[A].getSource();if(F.type!=="geojson")throw new Error(`geojsonSource.type is ${F.type}, which is !== 'geojson`);F.setData(E),this._changed=!0}getSource(A){return this.sourceCaches[A]&&this.sourceCaches[A].getSource()}addLayer(A,E,F={}){this._checkLoaded();const O=A.id;if(this.getLayer(O))return void this.fire(new a.j(new Error(`Layer "${O}" already exists on this map.`)));let y;if(A.type==="custom"){if(Qt(this,a.aF(A)))return;y=a.aC(A)}else{if("source"in A&&typeof A.source=="object"&&(this.addSource(O,A.source),A=a.aD(A),A=a.e(A,{source:O})),this._validate(a.y.layer,`layers.${O}`,A,{arrayIndex:-1},F))return;y=a.aC(A),this._validateLayer(y),y.setEventedParent(this,{layer:{id:O}})}const s=E?this._order.indexOf(E):this._order.length;if(E&&s===-1)this.fire(new a.j(new Error(`Cannot add layer "${O}" before non-existing layer "${E}".`)));else{if(this._order.splice(s,0,O),this._layerOrderChanged=!0,this._layers[O]=y,this._removedLayers[O]&&y.source&&y.type!=="custom"){const i=this._removedLayers[O];delete this._removedLayers[O],i.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(A,E){if(this._checkLoaded(),this._changed=!0,!this._layers[A])return void this.fire(new a.j(new Error(`The layer '${A}' does not exist in the map's style and cannot be moved.`)));if(A===E)return;const F=this._order.indexOf(A);this._order.splice(F,1);const O=E?this._order.indexOf(E):this._order.length;E&&O===-1?this.fire(new a.j(new Error(`Cannot move layer "${A}" before non-existing layer "${E}".`))):(this._order.splice(O,0,A),this._layerOrderChanged=!0)}removeLayer(A){this._checkLoaded();const E=this._layers[A];if(!E)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${A}".`)));E.setEventedParent(null);const F=this._order.indexOf(A);this._order.splice(F,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[A]=E,delete this._layers[A],this._serializedLayers&&delete this._serializedLayers[A],delete this._updatedLayers[A],delete this._updatedPaintProps[A],E.onRemove&&E.onRemove(this.map)}getLayer(A){return this._layers[A]}getLayersOrder(){return[...this._order]}hasLayer(A){return A in this._layers}setLayerZoomRange(A,E,F){this._checkLoaded();const O=this.getLayer(A);O?O.minzoom===E&&O.maxzoom===F||(E!=null&&(O.minzoom=E),F!=null&&(O.maxzoom=F),this._updateLayer(O)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${A}".`)))}setFilter(A,E,F={}){this._checkLoaded();const O=this.getLayer(A);if(O){if(!a.aG(O.filter,E))return E==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(a.y.filter,`layers.${O.id}.filter`,E,null,F)||(O.filter=a.aD(E),this._updateLayer(O)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${A}".`)))}getFilter(A){return a.aD(this.getLayer(A).filter)}setLayoutProperty(A,E,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getLayoutProperty(E),F)||(y.setLayoutProperty(E,F,O),this._updateLayer(y)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getLayoutProperty(A,E){const F=this.getLayer(A);if(F)return F.getLayoutProperty(E);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${A}".`)))}setPaintProperty(A,E,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getPaintProperty(E),F)||(y.setPaintProperty(E,F,O)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[A]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getPaintProperty(A,E){return this.getLayer(A).getPaintProperty(E)}setFeatureState(A,E){this._checkLoaded();const F=A.source,O=A.sourceLayer,y=this.sourceCaches[F];if(y===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const s=y.getSource().type;s==="geojson"&&O?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):s!=="vector"||O?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(O,A.id,E)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(A,E){this._checkLoaded();const F=A.source,O=this.sourceCaches[F];if(O===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const y=O.getSource().type,s=y==="vector"?A.sourceLayer:void 0;y!=="vector"||s?E&&typeof A.id!="string"&&typeof A.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(s,A.id,E):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(A){this._checkLoaded();const E=A.source,F=A.sourceLayer,O=this.sourceCaches[E];if(O!==void 0)return O.getSource().type!=="vector"||F?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),O.getFeatureState(F,A.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${E}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const A=a.aH(this.sourceCaches,y=>y.serialize()),E=this._serializeByIds(this._order),F=this.map.getTerrain()||void 0,O=this.stylesheet;return a.aI({version:O.version,name:O.name,metadata:O.metadata,light:O.light,center:O.center,zoom:O.zoom,bearing:O.bearing,pitch:O.pitch,sprite:O.sprite,glyphs:O.glyphs,transition:O.transition,sources:A,layers:E,terrain:F},y=>y!==void 0)}_updateLayer(A){this._updatedLayers[A.id]=!0,A.source&&!this._updatedSources[A.source]&&this.sourceCaches[A.source].getSource().type!=="raster"&&(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(A){const E=s=>this._layers[s].type==="fill-extrusion",F={},O=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(E(i)){F[i]=s;for(const r of A){const l=r[i];if(l)for(const d of l)O.push(d)}}}O.sort((s,i)=>i.intersectionZ-s.intersectionZ);const y=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(E(i))for(let r=O.length-1;r>=0;r--){const l=O[r].feature;if(F[l.layer.id]<s)break;y.push(l),O.pop()}else for(const r of A){const l=r[i];if(l)for(const d of l)y.push(d.feature)}}return y}queryRenderedFeatures(A,E,F){E&&E.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",E.filter,null,E);const O={};if(E&&E.layers){if(!Array.isArray(E.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const i of E.layers){const r=this._layers[i];if(!r)return this.fire(new a.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be queried for features.`))),[];O[r.source]=!0}}const y=[];E.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const i in this.sourceCaches)E.layers&&!O[i]||y.push(pn(this.sourceCaches[i],this._layers,s,A,E,F));return this.placement&&y.push(function(i,r,l,d,_,w,T){const B={},j=w.queryRenderedSymbols(d),Y=[];for(const ce of Object.keys(j).map(Number))Y.push(T[ce]);Y.sort(ii);for(const ce of Y){const Se=ce.featureIndex.lookupSymbolFeatures(j[ce.bucketInstanceId],r,ce.bucketIndex,ce.sourceLayerIndex,_.filter,_.layers,_.availableImages,i);for(const Te in Se){const Re=B[Te]=B[Te]||[],Be=Se[Te];Be.sort((Je,xt)=>{const at=ce.featureSortOrder;if(at){const ct=at.indexOf(Je.featureIndex);return at.indexOf(xt.featureIndex)-ct}return xt.featureIndex-Je.featureIndex});for(const Je of Be)Re.push(Je)}}for(const ce in B)B[ce].forEach(Se=>{const Te=Se.feature,Re=l[i[ce].source].getFeatureState(Te.layer["source-layer"],Te.id);Te.source=Te.layer.source,Te.layer["source-layer"]&&(Te.sourceLayer=Te.layer["source-layer"]),Te.state=Re});return B}(this._layers,s,this.sourceCaches,A,E,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(A,E){E&&E.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",E.filter,null,E);const F=this.sourceCaches[A];return F?function(O,y){const s=O.getRenderableIds().map(l=>O.getTileByID(l)),i=[],r={};for(let l=0;l<s.length;l++){const d=s[l],_=d.tileID.canonical.key;r[_]||(r[_]=!0,d.querySourceFeatures(i,y))}return i}(F,E):[]}addSourceType(A,E,F){return Ji(A)?F(new Error(`A source type called "${A}" already exists.`)):(((O,y)=>{Ki[O]=y})(A,E),E.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:A,url:E.workerSourceURL},F):F(null,null))}getLight(){return this.light.getLight()}setLight(A,E={}){this._checkLoaded();const F=this.light.getLight();let O=!1;for(const s in A)if(!a.aG(A[s],F[s])){O=!0;break}if(!O)return;const y={now:a.h.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(A,E),this.light.updateTransitions(y)}_validate(A,E,F,O,y={}){return(!y||y.validate!==!1)&&Qt(this,A.call(a.y,a.e({key:E,style:this.serialize(),value:F,styleSpec:a.v},O)))}_remove(A=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const E in this._layers)this._layers[E].setEventedParent(null);for(const E in this.sourceCaches){const F=this.sourceCaches[E];F.setEventedParent(null),F.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(A)}_clearSource(A){this.sourceCaches[A].clearTiles()}_reloadSource(A){this.sourceCaches[A].resume(),this.sourceCaches[A].reload()}_updateSources(A){for(const E in this.sourceCaches)this.sourceCaches[E].update(A,this.map.terrain)}_generateCollisionBoxes(){for(const A in this.sourceCaches)this._reloadSource(A)}_updatePlacement(A,E,F,O,y=!1){let s=!1,i=!1;const r={};for(const l of this._order){const d=this._layers[l];if(d.type!=="symbol")continue;if(!r[d.source]){const w=this.sourceCaches[d.source];r[d.source]=w.getRenderableIds(!0).map(T=>w.getTileByID(T)).sort((T,B)=>B.tileID.overscaledZ-T.tileID.overscaledZ||(T.tileID.isLessThan(B.tileID)?-1:1))}const _=this.crossTileSymbolIndex.addLayer(d,r[d.source],A.center.lng);s=s||_}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||F===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.h.now(),A.zoom))&&(this.pauseablePlacement=new mn(A,this.map.terrain,this._order,y,E,F,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,r),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.h.now()),i=!0),s&&this.pauseablePlacement.placement.setStale()),i||s)for(const l of this._order){const d=this._layers[l];d.type==="symbol"&&this.placement.updateLayerOpacities(d,r[d.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.h.now())}_releaseSymbolFadeTiles(){for(const A in this.sourceCaches)this.sourceCaches[A].releaseSymbolFadeTiles()}getImages(A,E,F){this.imageManager.getImages(E.icons,F),this._updateTilesForChangedImages();const O=this.sourceCaches[E.source];O&&O.setDependencies(E.tileID.key,E.type,E.icons)}getGlyphs(A,E,F){this.glyphManager.getGlyphs(E.stacks,F);const O=this.sourceCaches[E.source];O&&O.setDependencies(E.tileID.key,E.type,[""])}getResource(A,E,F){return a.m(E,F)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(A,E={}){this._checkLoaded(),A&&this._validate(a.y.glyphs,"glyphs",A,null,E)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=A,this.glyphManager.entries={},this.glyphManager.setURL(A))}addSprite(A,E,F={},O){this._checkLoaded();const y=[{id:A,url:E}],s=[...rt(this.stylesheet.sprite),...y];this._validate(a.y.sprite,"sprite",s,null,F)||(this.stylesheet.sprite=s,this._loadSprite(y,!0,O))}removeSprite(A){this._checkLoaded();const E=rt(this.stylesheet.sprite);if(E.find(F=>F.id===A)){if(this._spritesImagesIds[A])for(const F of this._spritesImagesIds[A])this.imageManager.removeImage(F),this._changedImages[F]=!0;E.splice(E.findIndex(F=>F.id===A),1),this.stylesheet.sprite=E.length>0?E:void 0,delete this._spritesImagesIds[A],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${A}" doesn't exists on this map.`)))}getSprite(){return rt(this.stylesheet.sprite)}setSprite(A,E={},F){this._checkLoaded(),A&&this._validate(a.y.sprite,"sprite",A,null,E)||(this.stylesheet.sprite=A,A?this._loadSprite(A,!0,F):(this._unloadSprite(),F&&F(null)))}}cr.registerForPluginStateChange=a.aK;var Ns=a.Q([{name:"a_pos",type:"Int16",components:2}]),Ur="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Vt={prelude:hr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:hr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:hr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:hr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:hr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:hr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:hr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:hr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:hr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:hr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:hr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:hr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:hr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:hr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:hr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:hr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:hr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:hr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:hr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:hr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:hr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ur),terrainDepth:hr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ur),terrainCoords:hr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ur)};function hr(Z,A){const E=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,F=A.match(/attribute ([\w]+) ([\w]+)/g),O=Z.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=A.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=y?y.concat(O):O,i={};return{fragmentSource:Z=Z.replace(E,(r,l,d,_,w)=>(i[w]=!0,l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:`
#ifdef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = u_${w};
#endif
`)),vertexSource:A=A.replace(E,(r,l,d,_,w)=>{const T=_==="float"?"vec2":"vec4",B=w.match(/color/)?"color":T;return i[w]?l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`}),staticAttributes:F,staticUniforms:s}}class Lt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(A,E,F,O,y,s,i,r,l){this.context=A;let d=this.boundPaintVertexBuffers.length!==O.length;for(let _=0;!d&&_<O.length;_++)this.boundPaintVertexBuffers[_]!==O[_]&&(d=!0);!this.vao||this.boundProgram!==E||this.boundLayoutVertexBuffer!==F||d||this.boundIndexBuffer!==y||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==i||this.boundDynamicVertexBuffer2!==r||this.boundDynamicVertexBuffer3!==l?this.freshBind(E,F,O,y,s,i,r,l):(A.bindVertexArray.set(this.vao),i&&i.bind(),y&&y.dynamicDraw&&y.bind(),r&&r.bind(),l&&l.bind())}freshBind(A,E,F,O,y,s,i,r){const l=A.numAttributes,d=this.context,_=d.gl;this.vao&&this.destroy(),this.vao=d.createVertexArray(),d.bindVertexArray.set(this.vao),this.boundProgram=A,this.boundLayoutVertexBuffer=E,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=O,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=i,this.boundDynamicVertexBuffer3=r,E.enableAttributes(_,A);for(const w of F)w.enableAttributes(_,A);s&&s.enableAttributes(_,A),i&&i.enableAttributes(_,A),r&&r.enableAttributes(_,A),E.bind(),E.setVertexAttribPointers(_,A,y);for(const w of F)w.bind(),w.setVertexAttribPointers(_,A,y);s&&(s.bind(),s.setVertexAttribPointers(_,A,y)),O&&O.bind(),i&&(i.bind(),i.setVertexAttribPointers(_,A,y)),r&&(r.bind(),r.setVertexAttribPointers(_,A,y)),d.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Fr(Z){const A=[];for(let E=0;E<Z.length;E++){if(Z[E]===null)continue;const F=Z[E].split(" ");A.push(F.pop())}return A}class Vs{constructor(A,E,F,O,y,s){const i=A.gl;this.program=i.createProgram();const r=Fr(E.staticAttributes),l=F?F.getBinderAttributes():[],d=r.concat(l),_=Vt.prelude.staticUniforms?Fr(Vt.prelude.staticUniforms):[],w=E.staticUniforms?Fr(E.staticUniforms):[],T=F?F.getBinderUniforms():[],B=_.concat(w).concat(T),j=[];for(const Je of B)j.indexOf(Je)<0&&j.push(Je);const Y=F?F.defines():[];y&&Y.push("#define OVERDRAW_INSPECTOR;"),s&&Y.push("#define TERRAIN3D;");const ce=Y.concat(Vt.prelude.fragmentSource,E.fragmentSource).join(`
`),Se=Y.concat(Vt.prelude.vertexSource,E.vertexSource).join(`
`),Te=i.createShader(i.FRAGMENT_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Te,ce),i.compileShader(Te),!i.getShaderParameter(Te,i.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${i.getShaderInfoLog(Te)}`);i.attachShader(this.program,Te);const Re=i.createShader(i.VERTEX_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Re,Se),i.compileShader(Re),!i.getShaderParameter(Re,i.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${i.getShaderInfoLog(Re)}`);i.attachShader(this.program,Re),this.attributes={};const Be={};this.numAttributes=d.length;for(let Je=0;Je<this.numAttributes;Je++)d[Je]&&(i.bindAttribLocation(this.program,Je,d[Je]),this.attributes[d[Je]]=Je);if(i.linkProgram(this.program),!i.getProgramParameter(this.program,i.LINK_STATUS))throw new Error(`Program failed to link: ${i.getProgramInfoLog(this.program)}`);i.deleteShader(Re),i.deleteShader(Te);for(let Je=0;Je<j.length;Je++){const xt=j[Je];if(xt&&!Be[xt]){const at=i.getUniformLocation(this.program,xt);at&&(Be[xt]=at)}}this.fixedUniforms=O(A,Be),this.terrainUniforms=((Je,xt)=>({u_depth:new a.aL(Je,xt.u_depth),u_terrain:new a.aL(Je,xt.u_terrain),u_terrain_dim:new a.aM(Je,xt.u_terrain_dim),u_terrain_matrix:new a.aN(Je,xt.u_terrain_matrix),u_terrain_unpack:new a.aO(Je,xt.u_terrain_unpack),u_terrain_exaggeration:new a.aM(Je,xt.u_terrain_exaggeration)}))(A,Be),this.binderUniforms=F?F.getUniforms(A,Be):[]}draw(A,E,F,O,y,s,i,r,l,d,_,w,T,B,j,Y,ce,Se){const Te=A.gl;if(this.failedToCreate)return;if(A.program.set(this.program),A.setDepthMode(F),A.setStencilMode(O),A.setColorMode(y),A.setCullFace(s),r){A.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,r.depthTexture),A.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,r.texture);for(const Be in this.terrainUniforms)this.terrainUniforms[Be].set(r[Be])}for(const Be in this.fixedUniforms)this.fixedUniforms[Be].set(i[Be]);j&&j.setUniforms(A,this.binderUniforms,T,{zoom:B});let Re=0;switch(E){case Te.LINES:Re=2;break;case Te.TRIANGLES:Re=3;break;case Te.LINE_STRIP:Re=1}for(const Be of w.get()){const Je=Be.vaos||(Be.vaos={});(Je[l]||(Je[l]=new Lt)).bind(A,this,d,j?j.getPaintVertexBuffers():[],_,Be.vertexOffset,Y,ce,Se),Te.drawElements(E,Be.primitiveLength*Re,Te.UNSIGNED_SHORT,Be.primitiveOffset*Re*2)}}}function ua(Z,A,E){const F=1/Fe(E,1,A.transform.tileZoom),O=Math.pow(2,E.tileID.overscaledZ),y=E.tileSize*Math.pow(2,A.transform.tileZoom)/O,s=y*(E.tileID.canonical.x+E.tileID.wrap*O),i=y*E.tileID.canonical.y;return{u_image:0,u_texsize:E.imageAtlasTexture.size,u_scale:[F,Z.fromScale,Z.toScale],u_fade:Z.t,u_pixel_coord_upper:[s>>16,i>>16],u_pixel_coord_lower:[65535&s,65535&i]}}const Pr=(Z,A,E,F)=>{const O=A.style.light,y=O.properties.get("position"),s=[y.x,y.y,y.z],i=function(){var l=new a.A(9);return a.A!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}();O.properties.get("anchor")==="viewport"&&function(l,d){var _=Math.sin(d),w=Math.cos(d);l[0]=w,l[1]=_,l[2]=0,l[3]=-_,l[4]=w,l[5]=0,l[6]=0,l[7]=0,l[8]=1}(i,-A.transform.angle),function(l,d,_){var w=d[0],T=d[1],B=d[2];l[0]=w*_[0]+T*_[3]+B*_[6],l[1]=w*_[1]+T*_[4]+B*_[7],l[2]=w*_[2]+T*_[5]+B*_[8]}(s,s,i);const r=O.properties.get("color");return{u_matrix:Z,u_lightpos:s,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[r.r,r.g,r.b],u_vertical_gradient:+E,u_opacity:F}},Fa=(Z,A,E,F,O,y,s)=>a.e(Pr(Z,A,E,F),ua(y,A,s),{u_height_factor:-Math.pow(2,O.overscaledZ)/s.tileSize/8}),zo=Z=>({u_matrix:Z}),Oa=(Z,A,E,F)=>a.e(zo(Z),ua(E,A,F)),Ys=(Z,A)=>({u_matrix:Z,u_world:A}),Zn=(Z,A,E,F,O)=>a.e(Oa(Z,A,E,F),{u_world:O}),aa=(Z,A,E,F)=>{const O=Z.transform;let y,s;if(F.paint.get("circle-pitch-alignment")==="map"){const i=Fe(E,1,O.zoom);y=!0,s=[i,i]}else y=!1,s=O.pixelsToGLUnits;return{u_camera_to_center_distance:O.cameraToCenterDistance,u_scale_with_map:+(F.paint.get("circle-pitch-scale")==="map"),u_matrix:Z.translatePosMatrix(A.posMatrix,E,F.paint.get("circle-translate"),F.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:Z.pixelRatio,u_extrude_scale:s}},ls=(Z,A,E)=>{const F=Fe(E,1,A.zoom),O=Math.pow(2,A.zoom-E.tileID.overscaledZ),y=E.tileID.overscaleFactor();return{u_matrix:Z,u_camera_to_center_distance:A.cameraToCenterDistance,u_pixels_to_tile_units:F,u_extrude_scale:[A.pixelsToGLUnits[0]/(F*O),A.pixelsToGLUnits[1]/(F*O)],u_overscale_factor:y}},Na=(Z,A,E=1)=>({u_matrix:Z,u_color:A,u_overlay:0,u_overlay_scale:E}),al=Z=>({u_matrix:Z}),ol=(Z,A,E,F)=>({u_matrix:Z,u_extrude_scale:Fe(A,1,E),u_intensity:F});function to(Z,A){const E=Math.pow(2,A.canonical.z),F=A.canonical.y;return[new a.U(0,F/E).toLngLat().lat,new a.U(0,(F+1)/E).toLngLat().lat]}const Va=(Z,A,E,F)=>{const O=Z.transform;return{u_matrix:Wt(Z,A,E,F),u_ratio:1/Fe(A,1,O.zoom),u_device_pixel_ratio:Z.pixelRatio,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},N=(Z,A,E,F,O)=>a.e(Va(Z,A,E,O),{u_image:0,u_image_height:F}),xe=(Z,A,E,F,O)=>{const y=Z.transform,s=It(A,y);return{u_matrix:Wt(Z,A,E,O),u_texsize:A.imageAtlasTexture.size,u_ratio:1/Fe(A,1,y.zoom),u_device_pixel_ratio:Z.pixelRatio,u_image:0,u_scale:[s,F.fromScale,F.toScale],u_fade:F.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},it=(Z,A,E,F,O,y)=>{const s=Z.lineAtlas,i=It(A,Z.transform),r=E.layout.get("line-cap")==="round",l=s.getDash(F.from,r),d=s.getDash(F.to,r),_=l.width*O.fromScale,w=d.width*O.toScale;return a.e(Va(Z,A,E,y),{u_patternscale_a:[i/_,-l.height/2],u_patternscale_b:[i/w,-d.height/2],u_sdfgamma:s.width/(256*Math.min(_,w)*Z.pixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:d.y,u_mix:O.t})};function It(Z,A){return 1/Fe(Z,1,A.tileZoom)}function Wt(Z,A,E,F){return Z.translatePosMatrix(F?F.posMatrix:A.tileID.posMatrix,A,E.paint.get("line-translate"),E.paint.get("line-translate-anchor"))}const Ii=(Z,A,E,F,O)=>{return{u_matrix:Z,u_tl_parent:A,u_scale_parent:E,u_buffer_scale:1,u_fade_t:F.mix,u_opacity:F.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(s=O.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(y=O.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Li(O.paint.get("raster-hue-rotate"))};var y,s};function Li(Z){Z*=Math.PI/180;const A=Math.sin(Z),E=Math.cos(Z);return[(2*E+1)/3,(-Math.sqrt(3)*A-E+1)/3,(Math.sqrt(3)*A-E+1)/3]}const cn=(Z,A,E,F,O,y,s,i,r,l)=>{const d=O.transform;return{u_is_size_zoom_constant:+(Z==="constant"||Z==="source"),u_is_size_feature_constant:+(Z==="constant"||Z==="camera"),u_size_t:A?A.uSizeT:0,u_size:A?A.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+E,u_aspect_ratio:d.width/d.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:s,u_coord_matrix:i,u_is_text:+r,u_pitch_with_map:+F,u_texsize:l,u_texture:0}},fn=(Z,A,E,F,O,y,s,i,r,l,d)=>{const _=O.transform;return a.e(cn(Z,A,E,F,O,y,s,i,r,l),{u_gamma_scale:F?Math.cos(_._pitch)*_.cameraToCenterDistance:1,u_device_pixel_ratio:O.pixelRatio,u_is_halo:+d})},sr=(Z,A,E,F,O,y,s,i,r,l)=>a.e(fn(Z,A,E,F,O,y,s,i,!0,r,!0),{u_texsize_icon:l,u_texture_icon:1}),Ar=(Z,A,E)=>({u_matrix:Z,u_opacity:A,u_color:E}),Or=(Z,A,E,F,O,y)=>a.e(function(s,i,r,l){const d=r.imageManager.getPattern(s.from.toString()),_=r.imageManager.getPattern(s.to.toString()),{width:w,height:T}=r.imageManager.getPixelSize(),B=Math.pow(2,l.tileID.overscaledZ),j=l.tileSize*Math.pow(2,r.transform.tileZoom)/B,Y=j*(l.tileID.canonical.x+l.tileID.wrap*B),ce=j*l.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:d.tl,u_pattern_br_a:d.br,u_pattern_tl_b:_.tl,u_pattern_br_b:_.br,u_texsize:[w,T],u_mix:i.t,u_pattern_size_a:d.displaySize,u_pattern_size_b:_.displaySize,u_scale_a:i.fromScale,u_scale_b:i.toScale,u_tile_units_to_pixels:1/Fe(l,1,r.transform.tileZoom),u_pixel_coord_upper:[Y>>16,ce>>16],u_pixel_coord_lower:[65535&Y,65535&ce]}}(F,y,E,O),{u_matrix:Z,u_opacity:A}),Ua={fillExtrusion:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_opacity:new a.aM(Z,A.u_opacity)}),fillExtrusionPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_height_factor:new a.aM(Z,A.u_height_factor),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade),u_opacity:new a.aM(Z,A.u_opacity)}),fill:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),fillPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),fillOutline:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world)}),fillOutlinePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),circle:(Z,A)=>({u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_scale_with_map:new a.aL(Z,A.u_scale_with_map),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_matrix:new a.aN(Z,A.u_matrix)}),collisionBox:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aM(Z,A.u_pixels_to_tile_units),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_overscale_factor:new a.aM(Z,A.u_overscale_factor)}),collisionCircle:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_inv_matrix:new a.aN(Z,A.u_inv_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_viewport_size:new a.aQ(Z,A.u_viewport_size)}),debug:(Z,A)=>({u_color:new a.aR(Z,A.u_color),u_matrix:new a.aN(Z,A.u_matrix),u_overlay:new a.aL(Z,A.u_overlay),u_overlay_scale:new a.aM(Z,A.u_overlay_scale)}),clippingMask:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),heatmap:(Z,A)=>({u_extrude_scale:new a.aM(Z,A.u_extrude_scale),u_intensity:new a.aM(Z,A.u_intensity),u_matrix:new a.aN(Z,A.u_matrix)}),heatmapTexture:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_color_ramp:new a.aL(Z,A.u_color_ramp),u_opacity:new a.aM(Z,A.u_opacity)}),hillshade:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_latrange:new a.aQ(Z,A.u_latrange),u_light:new a.aQ(Z,A.u_light),u_shadow:new a.aR(Z,A.u_shadow),u_highlight:new a.aR(Z,A.u_highlight),u_accent:new a.aR(Z,A.u_accent)}),hillshadePrepare:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_dimension:new a.aQ(Z,A.u_dimension),u_zoom:new a.aM(Z,A.u_zoom),u_unpack:new a.aO(Z,A.u_unpack)}),line:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels)}),lineGradient:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_image:new a.aL(Z,A.u_image),u_image_height:new a.aM(Z,A.u_image_height)}),linePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texsize:new a.aQ(Z,A.u_texsize),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_image:new a.aL(Z,A.u_image),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),lineSDF:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_patternscale_a:new a.aQ(Z,A.u_patternscale_a),u_patternscale_b:new a.aQ(Z,A.u_patternscale_b),u_sdfgamma:new a.aM(Z,A.u_sdfgamma),u_image:new a.aL(Z,A.u_image),u_tex_y_a:new a.aM(Z,A.u_tex_y_a),u_tex_y_b:new a.aM(Z,A.u_tex_y_b),u_mix:new a.aM(Z,A.u_mix)}),raster:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_tl_parent:new a.aQ(Z,A.u_tl_parent),u_scale_parent:new a.aM(Z,A.u_scale_parent),u_buffer_scale:new a.aM(Z,A.u_buffer_scale),u_fade_t:new a.aM(Z,A.u_fade_t),u_opacity:new a.aM(Z,A.u_opacity),u_image0:new a.aL(Z,A.u_image0),u_image1:new a.aL(Z,A.u_image1),u_brightness_low:new a.aM(Z,A.u_brightness_low),u_brightness_high:new a.aM(Z,A.u_brightness_high),u_saturation_factor:new a.aM(Z,A.u_saturation_factor),u_contrast_factor:new a.aM(Z,A.u_contrast_factor),u_spin_weights:new a.aP(Z,A.u_spin_weights)}),symbolIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture)}),symbolSDF:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),symbolTextAndIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texsize_icon:new a.aQ(Z,A.u_texsize_icon),u_texture:new a.aL(Z,A.u_texture),u_texture_icon:new a.aL(Z,A.u_texture_icon),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),background:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_color:new a.aR(Z,A.u_color)}),backgroundPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_image:new a.aL(Z,A.u_image),u_pattern_tl_a:new a.aQ(Z,A.u_pattern_tl_a),u_pattern_br_a:new a.aQ(Z,A.u_pattern_br_a),u_pattern_tl_b:new a.aQ(Z,A.u_pattern_tl_b),u_pattern_br_b:new a.aQ(Z,A.u_pattern_br_b),u_texsize:new a.aQ(Z,A.u_texsize),u_mix:new a.aM(Z,A.u_mix),u_pattern_size_a:new a.aQ(Z,A.u_pattern_size_a),u_pattern_size_b:new a.aQ(Z,A.u_pattern_size_b),u_scale_a:new a.aM(Z,A.u_scale_a),u_scale_b:new a.aM(Z,A.u_scale_b),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aM(Z,A.u_tile_units_to_pixels)}),terrain:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainDepth:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainCoords:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_terrain_coords_id:new a.aM(Z,A.u_terrain_coords_id),u_ele_delta:new a.aM(Z,A.u_ele_delta)})};class Ga{constructor(A,E,F){this.context=A;const O=A.gl;this.buffer=O.createBuffer(),this.dynamicDraw=!!F,this.context.unbindVAO(),A.bindElementBuffer.set(this.buffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(A){const E=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),E.bufferSubData(E.ELEMENT_ARRAY_BUFFER,0,A.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pl{constructor(A,E,F,O){this.length=E.length,this.attributes=F,this.itemSize=E.bytesPerElement,this.dynamicDraw=O,this.context=A;const y=A.gl;this.buffer=y.createBuffer(),A.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(A){if(A.length!==this.length)throw new Error(`Length of new data is ${A.length}, which doesn't match current length of ${this.length}`);const E=this.context.gl;this.bind(),E.bufferSubData(E.ARRAY_BUFFER,0,A.arrayBuffer)}enableAttributes(A,E){for(let F=0;F<this.attributes.length;F++){const O=E.attributes[this.attributes[F].name];O!==void 0&&A.enableVertexAttribArray(O)}}setVertexAttribPointers(A,E,F){for(let O=0;O<this.attributes.length;O++){const y=this.attributes[O],s=E.attributes[y.name];s!==void 0&&A.vertexAttribPointer(s,y.components,A[qa[y.type]],!1,this.itemSize,y.offset+this.itemSize*(F||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gr=new WeakMap;function nr(Z){var A;if(Gr.has(Z))return Gr.get(Z);{const E=(A=Z.getParameter(Z.VERSION))===null||A===void 0?void 0:A.startsWith("WebGL 2.0");return Gr.set(Z,E),E}}class wr{constructor(A){this.gl=A.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(A){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Dr extends wr{getDefault(){return a.aT.transparent}set(A){const E=this.current;(A.r!==E.r||A.g!==E.g||A.b!==E.b||A.a!==E.a||this.dirty)&&(this.gl.clearColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class js extends wr{getDefault(){return 1}set(A){(A!==this.current||this.dirty)&&(this.gl.clearDepth(A),this.current=A,this.dirty=!1)}}class vr extends wr{getDefault(){return 0}set(A){(A!==this.current||this.dirty)&&(this.gl.clearStencil(A),this.current=A,this.dirty=!1)}}class Ks extends wr{getDefault(){return[!0,!0,!0,!0]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||A[3]!==E[3]||this.dirty)&&(this.gl.colorMask(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class Lr extends wr{getDefault(){return!0}set(A){(A!==this.current||this.dirty)&&(this.gl.depthMask(A),this.current=A,this.dirty=!1)}}class So extends wr{getDefault(){return 255}set(A){(A!==this.current||this.dirty)&&(this.gl.stencilMask(A),this.current=A,this.dirty=!1)}}class Zo extends wr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(A){const E=this.current;(A.func!==E.func||A.ref!==E.ref||A.mask!==E.mask||this.dirty)&&(this.gl.stencilFunc(A.func,A.ref,A.mask),this.current=A,this.dirty=!1)}}class Ls extends wr{getDefault(){const A=this.gl;return[A.KEEP,A.KEEP,A.KEEP]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||this.dirty)&&(this.gl.stencilOp(A[0],A[1],A[2]),this.current=A,this.dirty=!1)}}class Il extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.STENCIL_TEST):E.disable(E.STENCIL_TEST),this.current=A,this.dirty=!1}}class Ao extends wr{getDefault(){return[0,1]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||this.dirty)&&(this.gl.depthRange(A[0],A[1]),this.current=A,this.dirty=!1)}}class Qo extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.DEPTH_TEST):E.disable(E.DEPTH_TEST),this.current=A,this.dirty=!1}}class ca extends wr{getDefault(){return this.gl.LESS}set(A){(A!==this.current||this.dirty)&&(this.gl.depthFunc(A),this.current=A,this.dirty=!1)}}class $s extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.BLEND):E.disable(E.BLEND),this.current=A,this.dirty=!1}}class El extends wr{getDefault(){const A=this.gl;return[A.ONE,A.ZERO]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||this.dirty)&&(this.gl.blendFunc(A[0],A[1]),this.current=A,this.dirty=!1)}}class Ha extends wr{getDefault(){return a.aT.transparent}set(A){const E=this.current;(A.r!==E.r||A.g!==E.g||A.b!==E.b||A.a!==E.a||this.dirty)&&(this.gl.blendColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Ta extends wr{getDefault(){return this.gl.FUNC_ADD}set(A){(A!==this.current||this.dirty)&&(this.gl.blendEquation(A),this.current=A,this.dirty=!1)}}class ml extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;A?E.enable(E.CULL_FACE):E.disable(E.CULL_FACE),this.current=A,this.dirty=!1}}class Cl extends wr{getDefault(){return this.gl.BACK}set(A){(A!==this.current||this.dirty)&&(this.gl.cullFace(A),this.current=A,this.dirty=!1)}}class mu extends wr{getDefault(){return this.gl.CCW}set(A){(A!==this.current||this.dirty)&&(this.gl.frontFace(A),this.current=A,this.dirty=!1)}}class us extends wr{getDefault(){return null}set(A){(A!==this.current||this.dirty)&&(this.gl.useProgram(A),this.current=A,this.dirty=!1)}}class rc extends wr{getDefault(){return this.gl.TEXTURE0}set(A){(A!==this.current||this.dirty)&&(this.gl.activeTexture(A),this.current=A,this.dirty=!1)}}class io extends wr{getDefault(){const A=this.gl;return[0,0,A.drawingBufferWidth,A.drawingBufferHeight]}set(A){const E=this.current;(A[0]!==E[0]||A[1]!==E[1]||A[2]!==E[2]||A[3]!==E[3]||this.dirty)&&(this.gl.viewport(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class no extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindFramebuffer(E.FRAMEBUFFER,A),this.current=A,this.dirty=!1}}class ql extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindRenderbuffer(E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Ro extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindTexture(E.TEXTURE_2D,A),this.current=A,this.dirty=!1}}class Wo extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.bindBuffer(E.ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Io extends wr{getDefault(){return null}set(A){const E=this.gl;E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Us extends wr{getDefault(){return null}set(A){var E;if(A===this.current&&!this.dirty)return;const F=this.gl;nr(F)?F.bindVertexArray(A):(E=F.getExtension("OES_vertex_array_object"))===null||E===void 0||E.bindVertexArrayOES(A),this.current=A,this.dirty=!1}}class Xo extends wr{getDefault(){return 4}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_ALIGNMENT,A),this.current=A,this.dirty=!1}}class Yo extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),this.current=A,this.dirty=!1}}class $o extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const E=this.gl;E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,A),this.current=A,this.dirty=!1}}class ba extends wr{constructor(A,E){super(A),this.context=A,this.parent=E}getDefault(){return null}}class ja extends ba{setDirty(){this.dirty=!0}set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,A,0),this.current=A,this.dirty=!1}}class Cs extends ba{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class gu extends ba{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const E=this.gl;E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_STENCIL_ATTACHMENT,E.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Sr{constructor(A,E,F,O,y){this.context=A,this.width=E,this.height=F;const s=A.gl,i=this.framebuffer=s.createFramebuffer();if(this.colorAttachment=new ja(A,i),O)this.depthAttachment=y?new gu(A,i):new Cs(A,i);else if(y)throw new Error("Stencil cannot be setted without depth");if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const A=this.context.gl,E=this.colorAttachment.get();if(E&&A.deleteTexture(E),this.depthAttachment){const F=this.depthAttachment.get();F&&A.deleteRenderbuffer(F)}A.deleteFramebuffer(this.framebuffer)}}class Xn{constructor(A,E,F){this.blendFunction=A,this.blendColor=E,this.mask=F}}Xn.Replace=[1,0],Xn.disabled=new Xn(Xn.Replace,a.aT.transparent,[!1,!1,!1,!1]),Xn.unblended=new Xn(Xn.Replace,a.aT.transparent,[!0,!0,!0,!0]),Xn.alphaBlended=new Xn([1,771],a.aT.transparent,[!0,!0,!0,!0]);class Ko{constructor(A){var E,F;if(this.gl=A,this.clearColor=new Dr(this),this.clearDepth=new js(this),this.clearStencil=new vr(this),this.colorMask=new Ks(this),this.depthMask=new Lr(this),this.stencilMask=new So(this),this.stencilFunc=new Zo(this),this.stencilOp=new Ls(this),this.stencilTest=new Il(this),this.depthRange=new Ao(this),this.depthTest=new Qo(this),this.depthFunc=new ca(this),this.blend=new $s(this),this.blendFunc=new El(this),this.blendColor=new Ha(this),this.blendEquation=new Ta(this),this.cullFace=new ml(this),this.cullFaceSide=new Cl(this),this.frontFace=new mu(this),this.program=new us(this),this.activeTexture=new rc(this),this.viewport=new io(this),this.bindFramebuffer=new no(this),this.bindRenderbuffer=new ql(this),this.bindTexture=new Ro(this),this.bindVertexBuffer=new Wo(this),this.bindElementBuffer=new Io(this),this.bindVertexArray=new Us(this),this.pixelStoreUnpack=new Xo(this),this.pixelStoreUnpackPremultiplyAlpha=new Yo(this),this.pixelStoreUnpackFlipY=new $o(this),this.extTextureFilterAnisotropic=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=A.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=A.getParameter(A.MAX_TEXTURE_SIZE),nr(A)){this.HALF_FLOAT=A.HALF_FLOAT;const O=A.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(E=A.RGBA16F)!==null&&E!==void 0?E:O==null?void 0:O.RGBA16F_EXT,this.RGB16F=(F=A.RGB16F)!==null&&F!==void 0?F:O==null?void 0:O.RGB16F_EXT,A.getExtension("EXT_color_buffer_float")}else{A.getExtension("EXT_color_buffer_half_float"),A.getExtension("OES_texture_half_float_linear");const O=A.getExtension("OES_texture_half_float");this.HALF_FLOAT=O==null?void 0:O.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(A,E){return new Ga(this,A,E)}createVertexBuffer(A,E,F){return new pl(this,A,E,F)}createRenderbuffer(A,E,F){const O=this.gl,y=O.createRenderbuffer();return this.bindRenderbuffer.set(y),O.renderbufferStorage(O.RENDERBUFFER,A,E,F),this.bindRenderbuffer.set(null),y}createFramebuffer(A,E,F,O){return new Sr(this,A,E,F,O)}clear({color:A,depth:E,stencil:F}){const O=this.gl;let y=0;A&&(y|=O.COLOR_BUFFER_BIT,this.clearColor.set(A),this.colorMask.set([!0,!0,!0,!0])),E!==void 0&&(y|=O.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(E),this.depthMask.set(!0)),F!==void 0&&(y|=O.STENCIL_BUFFER_BIT,this.clearStencil.set(F),this.stencilMask.set(255)),O.clear(y)}setCullFace(A){A.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(A.mode),this.frontFace.set(A.frontFace))}setDepthMode(A){A.func!==this.gl.ALWAYS||A.mask?(this.depthTest.set(!0),this.depthFunc.set(A.func),this.depthMask.set(A.mask),this.depthRange.set(A.range)):this.depthTest.set(!1)}setStencilMode(A){A.test.func!==this.gl.ALWAYS||A.mask?(this.stencilTest.set(!0),this.stencilMask.set(A.mask),this.stencilOp.set([A.fail,A.depthFail,A.pass]),this.stencilFunc.set({func:A.test.func,ref:A.ref,mask:A.test.mask})):this.stencilTest.set(!1)}setColorMode(A){a.aG(A.blendFunction,Xn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(A.blendFunction),this.blendColor.set(A.blendColor)),this.colorMask.set(A.mask)}createVertexArray(){var A;return nr(this.gl)?this.gl.createVertexArray():(A=this.gl.getExtension("OES_vertex_array_object"))===null||A===void 0?void 0:A.createVertexArrayOES()}deleteVertexArray(A){var E;return nr(this.gl)?this.gl.deleteVertexArray(A):(E=this.gl.getExtension("OES_vertex_array_object"))===null||E===void 0?void 0:E.deleteVertexArrayOES(A)}unbindVAO(){this.bindVertexArray.set(null)}}class Br{constructor(A,E,F){this.func=A,this.mask=E,this.range=F}}Br.ReadOnly=!1,Br.ReadWrite=!0,Br.disabled=new Br(519,Br.ReadOnly,[0,1]);const Za=7680;class Jr{constructor(A,E,F,O,y,s){this.test=A,this.ref=E,this.mask=F,this.fail=O,this.depthFail=y,this.pass=s}}Jr.disabled=new Jr({func:519,mask:0},0,0,Za,Za,Za);class fr{constructor(A,E,F){this.enable=A,this.mode=E,this.frontFace=F}}let Eo;function Un(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l=Z.useProgram("collisionBox"),d=[];let _=0,w=0;for(let Te=0;Te<F.length;Te++){const Re=F[Te],Be=A.getTile(Re),Je=Be.getBucket(E);if(!Je)continue;let xt=Re.posMatrix;O[0]===0&&O[1]===0||(xt=Z.translatePosMatrix(Re.posMatrix,Be,O,y));const at=s?Je.textCollisionBox:Je.iconCollisionBox,ct=Je.collisionCircleArray;if(ct.length>0){const Et=a.Z(),wt=xt;a.aU(Et,Je.placementInvProjMatrix,Z.transform.glCoordMatrix),a.aU(Et,Et,Je.placementViewportMatrix),d.push({circleArray:ct,circleOffset:w,transform:wt,invTransform:Et,coord:Re}),_+=ct.length/4,w=_}at&&l.draw(i,r.LINES,Br.disabled,Jr.disabled,Z.colorModeForRenderPass(),fr.disabled,ls(xt,Z.transform,Be),Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Re),E.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,null,Z.transform.zoom,null,null,at.collisionVertexBuffer)}if(!s||!d.length)return;const T=Z.useProgram("collisionCircle"),B=new a.aV;B.resize(4*_),B._trim();let j=0;for(const Te of d)for(let Re=0;Re<Te.circleArray.length/4;Re++){const Be=4*Re,Je=Te.circleArray[Be+0],xt=Te.circleArray[Be+1],at=Te.circleArray[Be+2],ct=Te.circleArray[Be+3];B.emplace(j++,Je,xt,at,ct,0),B.emplace(j++,Je,xt,at,ct,1),B.emplace(j++,Je,xt,at,ct,2),B.emplace(j++,Je,xt,at,ct,3)}(!Eo||Eo.length<2*_)&&(Eo=function(Te){const Re=2*Te,Be=new a.aX;Be.resize(Re),Be._trim();for(let Je=0;Je<Re;Je++){const xt=6*Je;Be.uint16[xt+0]=4*Je+0,Be.uint16[xt+1]=4*Je+1,Be.uint16[xt+2]=4*Je+2,Be.uint16[xt+3]=4*Je+2,Be.uint16[xt+4]=4*Je+3,Be.uint16[xt+5]=4*Je+0}return Be}(_));const Y=i.createIndexBuffer(Eo,!0),ce=i.createVertexBuffer(B,a.aW.members,!0);for(const Te of d){const Re={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Se=Z.transform).cameraToCenterDistance,u_viewport_size:[Se.width,Se.height]};T.draw(i,r.TRIANGLES,Br.disabled,Jr.disabled,Z.colorModeForRenderPass(),fr.disabled,Re,Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Te.coord),E.id,ce,Y,a.S.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,Z.transform.zoom,null,null,null)}var Se;ce.destroy(),Y.destroy()}fr.disabled=new fr(!1,1029,2305),fr.backCCW=new fr(!0,1029,2305);const Ol=a.ao(new Float32Array(16));function es(Z,A,E,F,O,y){const{horizontalAlign:s,verticalAlign:i}=a.au(Z);return new a.P((-(s-.5)*A/O+F[0])*y,(-(i-.5)*E/O+F[1])*y)}function Zr(Z,A,E,F,O,y,s,i,r,l,d){const _=Z.text.placedSymbolArray,w=Z.text.dynamicLayoutVertexArray,T=Z.icon.dynamicLayoutVertexArray,B={};w.clear();for(let j=0;j<_.length;j++){const Y=_.get(j),ce=Y.hidden||!Y.crossTileID||Z.allowVerticalPlacement&&!Y.placedOrientation?null:F[Y.crossTileID];if(ce){const Se=new a.P(Y.anchorX,Y.anchorY),Te=Ee(Se,E?s:y,d),Re=ze(O.cameraToCenterDistance,Te.signedDistanceFromCamera);let Be=a.aj(Z.textSizeData,r,Y)*Re/a.ap;E&&(Be*=Z.tilePixelRatio/i);const{width:Je,height:xt,anchor:at,textOffset:ct,textBoxScale:Et}=ce,wt=es(at,Je,xt,ct,Et,Be),ri=E?Ee(Se.add(wt),y,d).point:Te.point.add(A?wt.rotate(-O.angle):wt),Yt=Z.allowVerticalPlacement&&Y.placedOrientation===a.ai.vertical?Math.PI/2:0;for(let ei=0;ei<Y.numGlyphs;ei++)a.ak(w,ri,Yt);l&&Y.associatedIconIndex>=0&&(B[Y.associatedIconIndex]={shiftedAnchor:ri,angle:Yt})}else de(Y.numGlyphs,w)}if(l){T.clear();const j=Z.icon.placedSymbolArray;for(let Y=0;Y<j.length;Y++){const ce=j.get(Y);if(ce.hidden)de(ce.numGlyphs,T);else{const Se=B[Y];if(Se)for(let Te=0;Te<ce.numGlyphs;Te++)a.ak(T,Se.shiftedAnchor,Se.angle);else de(ce.numGlyphs,T)}}Z.icon.dynamicLayoutVertexBuffer.updateData(T)}Z.text.dynamicLayoutVertexBuffer.updateData(w)}function Ts(Z,A,E){return E.iconsInText&&A?"symbolTextAndIcon":Z?"symbolSDF":"symbolIcon"}function kr(Z,A,E,F,O,y,s,i,r,l,d,_){const w=Z.context,T=w.gl,B=Z.transform,j=i==="map",Y=r==="map",ce=i!=="viewport"&&E.layout.get("symbol-placement")!=="point",Se=j&&!Y&&!ce,Te=!E.layout.get("symbol-sort-key").isConstant();let Re=!1;const Be=Z.depthModeForSublayer(0,Br.ReadOnly),Je=E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xt=[];for(const at of F){const ct=A.getTile(at),Et=ct.getBucket(E);if(!Et)continue;const wt=O?Et.text:Et.icon;if(!wt||!wt.segments.get().length||!wt.hasVisibleVertices)continue;const ri=wt.programConfigurations.get(E.id),Yt=O||Et.sdfIcons,ei=O?Et.textSizeData:Et.iconSizeData,si=Y||B.pitch!==0,ji=Z.useProgram(Ts(Yt,O,Et),ri),Qi=a.ah(ei,B.zoom),Ei=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(at);let Ui,Gi,ln,Bn,rn=[0,0],kn=null;if(O)Gi=ct.glyphAtlasTexture,ln=T.LINEAR,Ui=ct.glyphAtlasTexture.size,Et.iconsInText&&(rn=ct.imageAtlasTexture.size,kn=ct.imageAtlasTexture,Bn=si||Z.options.rotating||Z.options.zooming||ei.kind==="composite"||ei.kind==="camera"?T.LINEAR:T.NEAREST);else{const Zs=E.layout.get("icon-size").constantOr(0)!==1||Et.iconsNeedLinear;Gi=ct.imageAtlasTexture,ln=Yt||Z.options.rotating||Z.options.zooming||Zs||si?T.LINEAR:T.NEAREST,Ui=ct.imageAtlasTexture.size}const yr=Fe(ct,1,Z.transform.zoom),er=ve(at.posMatrix,Y,j,Z.transform,yr),Ia=Ie(at.posMatrix,Y,j,Z.transform,yr),Aa=Je&&Et.hasTextData(),Bs=E.layout.get("icon-text-fit")!=="none"&&Aa&&Et.hasIconData();if(ce){const Zs=Z.style.map.terrain?(is,zr)=>Z.style.map.terrain.getElevation(at,is,zr):null,ts=E.layout.get("text-rotation-alignment")==="map";He(Et,at.posMatrix,Z,O,er,Ia,Y,l,ts,Zs)}const so=Z.translatePosMatrix(at.posMatrix,ct,y,s),ao=ce||O&&Je||Bs?Ol:er,qr=Z.translatePosMatrix(Ia,ct,y,s,!0),ya=Yt&&E.paint.get(O?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let _o;_o=Yt?Et.iconsInText?sr(ei.kind,Qi,Se,Y,Z,so,ao,qr,Ui,rn):fn(ei.kind,Qi,Se,Y,Z,so,ao,qr,O,Ui,!0):cn(ei.kind,Qi,Se,Y,Z,so,ao,qr,O,Ui);const yo={program:ji,buffers:wt,uniformValues:_o,atlasTexture:Gi,atlasTextureIcon:kn,atlasInterpolation:ln,atlasInterpolationIcon:Bn,isSDF:Yt,hasHalo:ya};if(Te&&Et.canOverlap){Re=!0;const Zs=wt.segments.get();for(const ts of Zs)xt.push({segments:new a.S([ts]),sortKey:ts.sortKey,state:yo,terrainData:Ei})}else xt.push({segments:wt.segments,sortKey:0,state:yo,terrainData:Ei})}Re&&xt.sort((at,ct)=>at.sortKey-ct.sortKey);for(const at of xt){const ct=at.state;if(w.activeTexture.set(T.TEXTURE0),ct.atlasTexture.bind(ct.atlasInterpolation,T.CLAMP_TO_EDGE),ct.atlasTextureIcon&&(w.activeTexture.set(T.TEXTURE1),ct.atlasTextureIcon&&ct.atlasTextureIcon.bind(ct.atlasInterpolationIcon,T.CLAMP_TO_EDGE)),ct.isSDF){const Et=ct.uniformValues;ct.hasHalo&&(Et.u_is_halo=1,rr(ct.buffers,at.segments,E,Z,ct.program,Be,d,_,Et,at.terrainData)),Et.u_is_halo=0}rr(ct.buffers,at.segments,E,Z,ct.program,Be,d,_,ct.uniformValues,at.terrainData)}}function rr(Z,A,E,F,O,y,s,i,r,l){const d=F.context;O.draw(d,d.gl.TRIANGLES,y,s,i,fr.disabled,r,l,E.id,Z.layoutVertexBuffer,Z.indexBuffer,A,E.paint,F.transform.zoom,Z.programConfigurations.get(E.id),Z.dynamicLayoutVertexBuffer,Z.opacityVertexBuffer)}function ll(Z,A,E,F,O){if(!E||!F||!F.imageAtlas)return;const y=F.imageAtlas.patternPositions;let s=y[E.to.toString()],i=y[E.from.toString()];if(!s&&i&&(s=i),!i&&s&&(i=s),!s||!i){const r=O.getPaintProperty(A);s=y[r],i=y[r]}s&&i&&Z.setConstantPatternPositions(s,i)}function Yr(Z,A,E,F,O,y,s){const i=Z.context.gl,r="fill-pattern",l=E.paint.get(r),d=l&&l.constantOr(1),_=E.getCrossfadeParameters();let w,T,B,j,Y;s?(T=d&&!E.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=i.LINES):(T=d?"fillPattern":"fill",w=i.TRIANGLES);const ce=l.constantOr(null);for(const Se of F){const Te=A.getTile(Se);if(d&&!Te.patternsLoaded())continue;const Re=Te.getBucket(E);if(!Re)continue;const Be=Re.programConfigurations.get(E.id),Je=Z.useProgram(T,Be),xt=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Se);d&&(Z.context.activeTexture.set(i.TEXTURE0),Te.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),Be.updatePaintBuffers(_)),ll(Be,r,ce,Te,E);const at=xt?Se:null,ct=Z.translatePosMatrix(at?at.posMatrix:Se.posMatrix,Te,E.paint.get("fill-translate"),E.paint.get("fill-translate-anchor"));if(s){j=Re.indexBuffer2,Y=Re.segments2;const Et=[i.drawingBufferWidth,i.drawingBufferHeight];B=T==="fillOutlinePattern"&&d?Zn(ct,Z,_,Te,Et):Ys(ct,Et)}else j=Re.indexBuffer,Y=Re.segments,B=d?Oa(ct,Z,_,Te):zo(ct);Je.draw(Z.context,w,O,Z.stencilModeForClipping(Se),y,fr.disabled,B,xt,E.id,Re.layoutVertexBuffer,j,Y,E.paint,Z.transform.zoom,Be)}}function Co(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l="fill-extrusion-pattern",d=E.paint.get(l),_=d.constantOr(1),w=E.getCrossfadeParameters(),T=E.paint.get("fill-extrusion-opacity"),B=d.constantOr(null);for(const j of F){const Y=A.getTile(j),ce=Y.getBucket(E);if(!ce)continue;const Se=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(j),Te=ce.programConfigurations.get(E.id),Re=Z.useProgram(_?"fillExtrusionPattern":"fillExtrusion",Te);_&&(Z.context.activeTexture.set(r.TEXTURE0),Y.imageAtlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE),Te.updatePaintBuffers(w)),ll(Te,l,B,Y,E);const Be=Z.translatePosMatrix(j.posMatrix,Y,E.paint.get("fill-extrusion-translate"),E.paint.get("fill-extrusion-translate-anchor")),Je=E.paint.get("fill-extrusion-vertical-gradient"),xt=_?Fa(Be,Z,Je,T,j,w,Y):Pr(Be,Z,Je,T);Re.draw(i,i.gl.TRIANGLES,O,y,s,fr.backCCW,xt,Se,E.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,E.paint,Z.transform.zoom,Te,Z.style.map.terrain&&ce.centroidVertexBuffer)}}function ul(Z,A,E,F,O,y,s){const i=Z.context,r=i.gl,l=E.fbo;if(!l)return;const d=Z.useProgram("hillshade"),_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(A);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.colorAttachment.get()),d.draw(i,r.TRIANGLES,O,y,s,fr.disabled,((w,T,B,j)=>{const Y=B.paint.get("hillshade-shadow-color"),ce=B.paint.get("hillshade-highlight-color"),Se=B.paint.get("hillshade-accent-color");let Te=B.paint.get("hillshade-illumination-direction")*(Math.PI/180);B.paint.get("hillshade-illumination-anchor")==="viewport"&&(Te-=w.transform.angle);const Re=!w.options.moving;return{u_matrix:j?j.posMatrix:w.transform.calculatePosMatrix(T.tileID.toUnwrapped(),Re),u_image:0,u_latrange:to(0,T.tileID),u_light:[B.paint.get("hillshade-exaggeration"),Te],u_shadow:Y,u_highlight:ce,u_accent:Se}})(Z,E,F,_?A:null),_,F.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments)}function Qr(Z,A,E,F,O,y){const s=Z.context,i=s.gl,r=A.dem;if(r&&r.data){const l=r.dim,d=r.stride,_=r.getPixels();if(s.activeTexture.set(i.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),A.demTexture=A.demTexture||Z.getTileTexture(d),A.demTexture){const T=A.demTexture;T.update(_,{premultiply:!1}),T.bind(i.NEAREST,i.CLAMP_TO_EDGE)}else A.demTexture=new pt(s,_,i.RGBA,{premultiply:!1}),A.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE);s.activeTexture.set(i.TEXTURE0);let w=A.fbo;if(!w){const T=new pt(s,{width:l,height:l,data:null},i.RGBA);T.bind(i.LINEAR,i.CLAMP_TO_EDGE),w=A.fbo=s.createFramebuffer(l,l,!0,!1),w.colorAttachment.set(T.texture)}s.bindFramebuffer.set(w.framebuffer),s.viewport.set([0,0,l,l]),Z.useProgram("hillshadePrepare").draw(s,i.TRIANGLES,F,O,y,fr.disabled,((T,B)=>{const j=B.stride,Y=a.Z();return a.aS(Y,0,a.N,-a.N,0,0,1),a.$(Y,Y,[0,-a.N,0]),{u_matrix:Y,u_image:1,u_dimension:[j,j],u_zoom:T.overscaledZ,u_unpack:B.getUnpackVector()}})(A.tileID,r),null,E.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments),A.needsHillshadePrepare=!1}}function hs(Z,A,E,F,O,y){const s=F.paint.get("raster-fade-duration");if(!y&&s>0){const i=a.h.now(),r=(i-Z.timeAdded)/s,l=A?(i-A.timeAdded)/s:-1,d=E.getSource(),_=O.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),w=!A||Math.abs(A.tileID.overscaledZ-_)>Math.abs(Z.tileID.overscaledZ-_),T=w&&Z.refreshedUponExpiration?1:a.ad(w?r:1-l,0,1);return Z.refreshedUponExpiration&&r>=1&&(Z.refreshedUponExpiration=!1),A?{opacity:1,mix:1-T}:{opacity:T,mix:0}}return{opacity:1,mix:0}}const wa=new a.aT(1,0,0,1),Tl=new a.aT(0,1,0,1),To=new a.aT(0,0,1,1),kl=new a.aT(1,0,1,1),fo=new a.aT(0,1,1,1);function Js(Z,A,E,F){Qa(Z,0,A+E/2,Z.transform.width,E,F)}function Gs(Z,A,E,F){Qa(Z,A-E/2,0,E,Z.transform.height,F)}function Qa(Z,A,E,F,O,y){const s=Z.context,i=s.gl;i.enable(i.SCISSOR_TEST),i.scissor(A*Z.pixelRatio,E*Z.pixelRatio,F*Z.pixelRatio,O*Z.pixelRatio),s.clear({color:y}),i.disable(i.SCISSOR_TEST)}function Jo(Z,A,E){const F=Z.context,O=F.gl,y=E.posMatrix,s=Z.useProgram("debug"),i=Br.disabled,r=Jr.disabled,l=Z.colorModeForRenderPass(),d="$debug",_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(E);F.activeTexture.set(O.TEXTURE0);const w=A.getTileByID(E.key).latestRawTileData,T=Math.floor((w&&w.byteLength||0)/1024),B=A.getTile(E).tileSize,j=512/Math.min(B,512)*(E.overscaledZ/Z.transform.zoom)*.5;let Y=E.canonical.toString();E.overscaledZ!==E.canonical.z&&(Y+=` => ${E.overscaledZ}`),function(ce,Se){ce.initDebugOverlayCanvas();const Te=ce.debugOverlayCanvas,Re=ce.context.gl,Be=ce.debugOverlayCanvas.getContext("2d");Be.clearRect(0,0,Te.width,Te.height),Be.shadowColor="white",Be.shadowBlur=2,Be.lineWidth=1.5,Be.strokeStyle="white",Be.textBaseline="top",Be.font="bold 36px Open Sans, sans-serif",Be.fillText(Se,5,5),Be.strokeText(Se,5,5),ce.debugOverlayTexture.update(Te),ce.debugOverlayTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE)}(Z,`${Y} ${T}kB`),s.draw(F,O.TRIANGLES,i,r,Xn.alphaBlended,fr.disabled,Na(y,a.aT.transparent,j),null,d,Z.debugBuffer,Z.quadTriangleIndexBuffer,Z.debugSegments),s.draw(F,O.LINE_STRIP,i,r,l,fr.disabled,Na(y,a.aT.red),_,d,Z.debugBuffer,Z.tileBorderIndexBuffer,Z.debugSegments)}function $r(Z,A,E){const F=Z.context,O=F.gl,y=Z.colorModeForRenderPass(),s=new Br(O.LEQUAL,Br.ReadWrite,Z.depthRangeFor3D),i=Z.useProgram("terrain"),r=A.getTerrainMesh();F.bindFramebuffer.set(null),F.viewport.set([0,0,Z.width,Z.height]);for(const l of E){const d=Z.renderToTexture.getTexture(l),_=A.getTerrainData(l.tileID);F.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,d.texture);const w={u_matrix:Z.transform.calculatePosMatrix(l.tileID.toUnwrapped()),u_texture:0,u_ele_delta:A.getMeshFrameDelta(Z.transform.zoom)};i.draw(F,O.TRIANGLES,s,Jr.disabled,y,fr.backCCW,w,_,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}class mr{constructor(A,E){this.context=new Ko(A),this.transform=E,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.Z(),renderTime:0},this.setup(),this.numSublayers=en.maxUnderzooming+en.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new On}resize(A,E,F){if(this.width=Math.floor(A*F),this.height=Math.floor(E*F),this.pixelRatio=F,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const O of this.style._order)this.style._layers[O].resize()}setup(){const A=this.context,E=new a.a_;E.emplaceBack(0,0),E.emplaceBack(a.N,0),E.emplaceBack(0,a.N),E.emplaceBack(a.N,a.N),this.tileExtentBuffer=A.createVertexBuffer(E,Ns.members),this.tileExtentSegments=a.S.simpleSegment(0,0,4,2);const F=new a.a_;F.emplaceBack(0,0),F.emplaceBack(a.N,0),F.emplaceBack(0,a.N),F.emplaceBack(a.N,a.N),this.debugBuffer=A.createVertexBuffer(F,Ns.members),this.debugSegments=a.S.simpleSegment(0,0,4,5);const O=new a.V;O.emplaceBack(0,0,0,0),O.emplaceBack(a.N,0,a.N,0),O.emplaceBack(0,a.N,0,a.N),O.emplaceBack(a.N,a.N,a.N,a.N),this.rasterBoundsBuffer=A.createVertexBuffer(O,Ci.members),this.rasterBoundsSegments=a.S.simpleSegment(0,0,4,2);const y=new a.a_;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=A.createVertexBuffer(y,Ns.members),this.viewportSegments=a.S.simpleSegment(0,0,4,2);const s=new a.a$;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=A.createIndexBuffer(s);const i=new a.b0;i.emplaceBack(0,1,2),i.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=A.createIndexBuffer(i);const r=this.context.gl;this.stencilClearMode=new Jr({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO)}clearStencil(){const A=this.context,E=A.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const F=a.Z();a.aS(F,0,this.width,this.height,0,0,1),a.a0(F,F,[E.drawingBufferWidth,E.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(A,E.TRIANGLES,Br.disabled,this.stencilClearMode,Xn.disabled,fr.disabled,al(F),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(A,E){if(this.currentStencilSource===A.source||!A.isTileClipped()||!E||!E.length)return;this.currentStencilSource=A.source;const F=this.context,O=F.gl;this.nextStencilID+E.length>256&&this.clearStencil(),F.setColorMode(Xn.disabled),F.setDepthMode(Br.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const s of E){const i=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,r=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s);y.draw(F,O.TRIANGLES,Br.disabled,new Jr({func:O.ALWAYS,mask:0},i,255,O.KEEP,O.KEEP,O.REPLACE),Xn.disabled,fr.disabled,al(s.posMatrix),r,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const A=this.nextStencilID++,E=this.context.gl;return new Jr({func:E.NOTEQUAL,mask:255},A,255,E.KEEP,E.KEEP,E.REPLACE)}stencilModeForClipping(A){const E=this.context.gl;return new Jr({func:E.EQUAL,mask:255},this._tileClippingMaskIDs[A.key],0,E.KEEP,E.KEEP,E.REPLACE)}stencilConfigForOverlap(A){const E=this.context.gl,F=A.sort((s,i)=>i.overscaledZ-s.overscaledZ),O=F[F.length-1].overscaledZ,y=F[0].overscaledZ-O+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const s={};for(let i=0;i<y;i++)s[i+O]=new Jr({func:E.GEQUAL,mask:255},i+this.nextStencilID,255,E.KEEP,E.KEEP,E.REPLACE);return this.nextStencilID+=y,[s,F]}return[{[O]:Jr.disabled},F]}colorModeForRenderPass(){const A=this.context.gl;return this._showOverdrawInspector?new Xn([A.CONSTANT_COLOR,A.ONE],new a.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xn.unblended:Xn.alphaBlended}depthModeForSublayer(A,E,F){if(!this.opaquePassEnabledForLayer())return Br.disabled;const O=1-((1+this.currentLayer)*this.numSublayers+A)*this.depthEpsilon;return new Br(F||this.context.gl.LEQUAL,E,[O,O])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(A,E){this.style=A,this.options=E,this.lineAtlas=A.lineAtlas,this.imageManager=A.imageManager,this.glyphManager=A.glyphManager,this.symbolFadeChange=A.placement.symbolFadeChange(a.h.now()),this.imageManager.beginFrame();const F=this.style._order,O=this.style.sourceCaches,y={},s={},i={};for(const r in O){const l=O[r];l.used&&l.prepare(this.context),y[r]=l.getVisibleCoordinates(),s[r]=y[r].slice().reverse(),i[r]=l.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let r=0;r<F.length;r++)if(this.style._layers[F[r]].is3D()){this.opaquePassCutoff=r;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||r.length)&&(a.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(l,d){const _=l.context,w=_.gl,T=Xn.unblended,B=new Br(w.LEQUAL,Br.ReadWrite,[0,1]),j=d.getTerrainMesh(),Y=d.sourceCache.getRenderableTiles(),ce=l.useProgram("terrainDepth");_.bindFramebuffer.set(d.getFramebuffer("depth").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1});for(const Se of Y){const Te=d.getTerrainData(Se.tileID),Re={u_matrix:l.transform.calculatePosMatrix(Se.tileID.toUnwrapped()),u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};ce.draw(_,w.TRIANGLES,B,Jr.disabled,T,fr.backCCW,Re,Te,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain),function(l,d){const _=l.context,w=_.gl,T=Xn.unblended,B=new Br(w.LEQUAL,Br.ReadWrite,[0,1]),j=d.getTerrainMesh(),Y=d.getCoordsTexture(),ce=d.sourceCache.getRenderableTiles(),Se=l.useProgram("terrainCoords");_.bindFramebuffer.set(d.getFramebuffer("coords").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1}),d.coordsIndex=[];for(const Te of ce){const Re=d.getTerrainData(Te.tileID);_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,Y.texture);const Be={u_matrix:l.transform.calculatePosMatrix(Te.tileID.toUnwrapped()),u_terrain_coords_id:(255-d.coordsIndex.length)/255,u_texture:0,u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};Se.draw(_,w.TRIANGLES,B,Jr.disabled,T,fr.backCCW,Be,Re,"terrain",j.vertexBuffer,j.indexBuffer,j.segments),d.coordsIndex.push(Te.tileID.key)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const r of F){const l=this.style._layers[r];if(!l.hasOffscreenPass()||l.isHidden(this.transform.zoom))continue;const d=s[l.source];(l.type==="custom"||d.length)&&this.renderLayer(this,O[l.source],l,d)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:E.showOverdrawInspector?a.aT.black:a.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=E.showOverdrawInspector,this.depthRangeFor3D=[0,1-(A._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=F.length-1;this.currentLayer>=0;this.currentLayer--){const r=this.style._layers[F[this.currentLayer]],l=O[r.source],d=y[r.source];this._renderTileClippingMasks(r,d),this.renderLayer(this,l,r,d)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const r=this.style._layers[F[this.currentLayer]],l=O[r.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(r))continue;const d=(r.type==="symbol"?i:s)[r.source];this._renderTileClippingMasks(r,y[r.source]),this.renderLayer(this,l,r,d)}if(this.options.showTileBoundaries){const r=function(l,d){let _=null;const w=Object.values(l._layers).flatMap(Y=>Y.source&&!Y.isHidden(d)?[l.sourceCaches[Y.source]]:[]),T=w.filter(Y=>Y.getSource().type==="vector"),B=w.filter(Y=>Y.getSource().type!=="vector"),j=Y=>{(!_||_.getSource().maxzoom<Y.getSource().maxzoom)&&(_=Y)};return T.forEach(Y=>j(Y)),_||B.forEach(Y=>j(Y)),_}(this.style,this.transform.zoom);r&&function(l,d,_){for(let w=0;w<_.length;w++)Jo(l,d,_[w])}(this,r,r.getVisibleCoordinates())}this.options.showPadding&&function(r){const l=r.transform.padding;Js(r,r.transform.height-(l.top||0),3,wa),Js(r,l.bottom||0,3,Tl),Gs(r,l.left||0,3,To),Gs(r,r.transform.width-(l.right||0),3,kl);const d=r.transform.centerPoint;(function(_,w,T,B){Qa(_,w-1,T-10,2,20,B),Qa(_,w-10,T-1,20,2,B)})(r,d.x,r.transform.height-d.y,fo)}(this),this.context.setDefault()}renderLayer(A,E,F,O){if(!F.isHidden(this.transform.zoom)&&(F.type==="background"||F.type==="custom"||(O||[]).length))switch(this.id=F.id,F.type){case"symbol":(function(y,s,i,r,l){if(y.renderPass!=="translucent")return;const d=Jr.disabled,_=y.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(w,T,B,j,Y,ce,Se){const Te=T.transform,Re=Y==="map",Be=ce==="map";for(const Je of w){const xt=j.getTile(Je),at=xt.getBucket(B);if(!at||!at.text||!at.text.segments.get().length)continue;const ct=a.ah(at.textSizeData,Te.zoom),Et=Fe(xt,1,T.transform.zoom),wt=ve(Je.posMatrix,Be,Re,T.transform,Et),ri=B.layout.get("icon-text-fit")!=="none"&&at.hasIconData();if(ct){const Yt=Math.pow(2,Te.zoom-xt.tileID.overscaledZ);Zr(at,Re,Be,Se,Te,wt,Je.posMatrix,Yt,ct,ri,T.style.map.terrain?(ei,si)=>T.style.map.terrain.getElevation(Je,ei,si):null)}}}(r,y,i,s,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),l),i.paint.get("icon-opacity").constantOr(1)!==0&&kr(y,s,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),d,_),i.paint.get("text-opacity").constantOr(1)!==0&&kr(y,s,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),d,_),s.map.showCollisionBoxes&&(Un(y,s,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Un(y,s,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))})(A,E,F,O,this.style.placement.variableOffsets);break;case"circle":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("circle-opacity"),d=i.paint.get("circle-stroke-width"),_=i.paint.get("circle-stroke-opacity"),w=!i.layout.get("circle-sort-key").isConstant();if(l.constantOr(1)===0&&(d.constantOr(1)===0||_.constantOr(1)===0))return;const T=y.context,B=T.gl,j=y.depthModeForSublayer(0,Br.ReadOnly),Y=Jr.disabled,ce=y.colorModeForRenderPass(),Se=[];for(let Te=0;Te<r.length;Te++){const Re=r[Te],Be=s.getTile(Re),Je=Be.getBucket(i);if(!Je)continue;const xt=Je.programConfigurations.get(i.id),at=y.useProgram("circle",xt),ct=Je.layoutVertexBuffer,Et=Je.indexBuffer,wt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),ri={programConfiguration:xt,program:at,layoutVertexBuffer:ct,indexBuffer:Et,uniformValues:aa(y,Re,Be,i),terrainData:wt};if(w){const Yt=Je.segments.get();for(const ei of Yt)Se.push({segments:new a.S([ei]),sortKey:ei.sortKey,state:ri})}else Se.push({segments:Je.segments,sortKey:0,state:ri})}w&&Se.sort((Te,Re)=>Te.sortKey-Re.sortKey);for(const Te of Se){const{programConfiguration:Re,program:Be,layoutVertexBuffer:Je,indexBuffer:xt,uniformValues:at,terrainData:ct}=Te.state;Be.draw(T,B.TRIANGLES,j,Y,ce,fr.disabled,at,ct,i.id,Je,xt,Te.segments,i.paint,y.transform.zoom,Re)}})(A,E,F,O);break;case"heatmap":(function(y,s,i,r){if(i.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const l=y.context,d=l.gl,_=Jr.disabled,w=new Xn([d.ONE,d.ONE],a.aT.transparent,[!0,!0,!0,!0]);(function(T,B,j){const Y=T.gl;T.activeTexture.set(Y.TEXTURE1),T.viewport.set([0,0,B.width/4,B.height/4]);let ce=j.heatmapFbo;if(ce)Y.bindTexture(Y.TEXTURE_2D,ce.colorAttachment.get()),T.bindFramebuffer.set(ce.framebuffer);else{const Se=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,Se),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),ce=j.heatmapFbo=T.createFramebuffer(B.width/4,B.height/4,!1,!1),function(Te,Re,Be,Je){var xt,at;const ct=Te.gl,Et=(xt=Te.HALF_FLOAT)!==null&&xt!==void 0?xt:ct.UNSIGNED_BYTE,wt=(at=Te.RGBA16F)!==null&&at!==void 0?at:ct.RGBA;ct.texImage2D(ct.TEXTURE_2D,0,wt,Re.width/4,Re.height/4,0,ct.RGBA,Et,null),Je.colorAttachment.set(Be)}(T,B,Se,ce)}})(l,y,i),l.clear({color:a.aT.transparent});for(let T=0;T<r.length;T++){const B=r[T];if(s.hasRenderableParent(B))continue;const j=s.getTile(B),Y=j.getBucket(i);if(!Y)continue;const ce=Y.programConfigurations.get(i.id),Se=y.useProgram("heatmap",ce),{zoom:Te}=y.transform;Se.draw(l,d.TRIANGLES,Br.disabled,_,w,fr.disabled,ol(B.posMatrix,j,Te,i.paint.get("heatmap-intensity")),null,i.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,i.paint,y.transform.zoom,ce)}l.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(l,d){const _=l.context,w=_.gl,T=d.heatmapFbo;if(!T)return;_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,T.colorAttachment.get()),_.activeTexture.set(w.TEXTURE1);let B=d.colorRampTexture;B||(B=d.colorRampTexture=new pt(_,d.colorRamp,w.RGBA)),B.bind(w.LINEAR,w.CLAMP_TO_EDGE),l.useProgram("heatmapTexture").draw(_,w.TRIANGLES,Br.disabled,Jr.disabled,l.colorModeForRenderPass(),fr.disabled,((j,Y,ce,Se)=>{const Te=a.Z();a.aS(Te,0,j.width,j.height,0,0,1);const Re=j.context.gl;return{u_matrix:Te,u_world:[Re.drawingBufferWidth,Re.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}})(l,d),null,d.id,l.viewportBuffer,l.quadTriangleIndexBuffer,l.viewportSegments,d.paint,l.transform.zoom)}(y,i))})(A,E,F,O);break;case"line":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("line-opacity"),d=i.paint.get("line-width");if(l.constantOr(1)===0||d.constantOr(1)===0)return;const _=y.depthModeForSublayer(0,Br.ReadOnly),w=y.colorModeForRenderPass(),T=i.paint.get("line-dasharray"),B=i.paint.get("line-pattern"),j=B.constantOr(1),Y=i.paint.get("line-gradient"),ce=i.getCrossfadeParameters(),Se=j?"linePattern":T?"lineSDF":Y?"lineGradient":"line",Te=y.context,Re=Te.gl;let Be=!0;for(const Je of r){const xt=s.getTile(Je);if(j&&!xt.patternsLoaded())continue;const at=xt.getBucket(i);if(!at)continue;const ct=at.programConfigurations.get(i.id),Et=y.context.program.get(),wt=y.useProgram(Se,ct),ri=Be||wt.program!==Et,Yt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Je),ei=B.constantOr(null);if(ei&&xt.imageAtlas){const Qi=xt.imageAtlas,Ei=Qi.patternPositions[ei.to.toString()],Ui=Qi.patternPositions[ei.from.toString()];Ei&&Ui&&ct.setConstantPatternPositions(Ei,Ui)}const si=Yt?Je:null,ji=j?xe(y,xt,i,ce,si):T?it(y,xt,i,T,ce,si):Y?N(y,xt,i,at.lineClipsArray.length,si):Va(y,xt,i,si);if(j)Te.activeTexture.set(Re.TEXTURE0),xt.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),ct.updatePaintBuffers(ce);else if(T&&(ri||y.lineAtlas.dirty))Te.activeTexture.set(Re.TEXTURE0),y.lineAtlas.bind(Te);else if(Y){const Qi=at.gradients[i.id];let Ei=Qi.texture;if(i.gradientVersion!==Qi.version){let Ui=256;if(i.stepInterpolant){const Gi=s.getSource().maxzoom,ln=Je.canonical.z===Gi?Math.ceil(1<<y.transform.maxZoom-Je.canonical.z):1;Ui=a.ad(a.aY(at.maxLineLength/a.N*1024*ln),256,Te.maxTextureSize)}Qi.gradient=a.aZ({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Ui,image:Qi.gradient||void 0,clips:at.lineClipsArray}),Qi.texture?Qi.texture.update(Qi.gradient):Qi.texture=new pt(Te,Qi.gradient,Re.RGBA),Qi.version=i.gradientVersion,Ei=Qi.texture}Te.activeTexture.set(Re.TEXTURE0),Ei.bind(i.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}wt.draw(Te,Re.TRIANGLES,_,y.stencilModeForClipping(Je),w,fr.disabled,ji,Yt,i.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,i.paint,y.transform.zoom,ct,at.layoutVertexBuffer2),Be=!1}})(A,E,F,O);break;case"fill":(function(y,s,i,r){const l=i.paint.get("fill-color"),d=i.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const _=y.colorModeForRenderPass(),w=i.paint.get("fill-pattern"),T=y.opaquePassEnabledForLayer()&&!w.constantOr(1)&&l.constantOr(a.aT.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===T){const B=y.depthModeForSublayer(1,y.renderPass==="opaque"?Br.ReadWrite:Br.ReadOnly);Yr(y,s,i,r,B,_,!1)}if(y.renderPass==="translucent"&&i.paint.get("fill-antialias")){const B=y.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Br.ReadOnly);Yr(y,s,i,r,B,_,!0)}})(A,E,F,O);break;case"fill-extrusion":(function(y,s,i,r){const l=i.paint.get("fill-extrusion-opacity");if(l!==0&&y.renderPass==="translucent"){const d=new Br(y.context.gl.LEQUAL,Br.ReadWrite,y.depthRangeFor3D);if(l!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))Co(y,s,i,r,d,Jr.disabled,Xn.disabled),Co(y,s,i,r,d,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const _=y.colorModeForRenderPass();Co(y,s,i,r,d,Jr.disabled,_)}}})(A,E,F,O);break;case"hillshade":(function(y,s,i,r){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const l=y.context,d=y.depthModeForSublayer(0,Br.ReadOnly),_=y.colorModeForRenderPass(),[w,T]=y.renderPass==="translucent"?y.stencilConfigForOverlap(r):[{},r];for(const B of T){const j=s.getTile(B);j.needsHillshadePrepare!==void 0&&j.needsHillshadePrepare&&y.renderPass==="offscreen"?Qr(y,j,i,d,Jr.disabled,_):y.renderPass==="translucent"&&ul(y,B,j,i,d,w[B.overscaledZ],_)}l.viewport.set([0,0,y.width,y.height])})(A,E,F,O);break;case"raster":(function(y,s,i,r){if(y.renderPass!=="translucent"||i.paint.get("raster-opacity")===0||!r.length)return;const l=y.context,d=l.gl,_=s.getSource(),w=y.useProgram("raster"),T=y.colorModeForRenderPass(),[B,j]=_ instanceof gi?[{},r]:y.stencilConfigForOverlap(r),Y=j[j.length-1].overscaledZ,ce=!y.options.moving;for(const Se of j){const Te=y.depthModeForSublayer(Se.overscaledZ-Y,i.paint.get("raster-opacity")===1?Br.ReadWrite:Br.ReadOnly,d.LESS),Re=s.getTile(Se);Re.registerFadeDuration(i.paint.get("raster-fade-duration"));const Be=s.findLoadedParent(Se,0),Je=hs(Re,Be,s,i,y.transform,y.style.map.terrain);let xt,at;const ct=i.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;l.activeTexture.set(d.TEXTURE0),Re.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.activeTexture.set(d.TEXTURE1),Be?(Be.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),xt=Math.pow(2,Be.tileID.overscaledZ-Re.tileID.overscaledZ),at=[Re.tileID.canonical.x*xt%1,Re.tileID.canonical.y*xt%1]):Re.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Et=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Se),wt=Et?Se:null,ri=wt?wt.posMatrix:y.transform.calculatePosMatrix(Se.toUnwrapped(),ce),Yt=Ii(ri,at||[0,0],xt||1,Je,i);_ instanceof gi?w.draw(l,d.TRIANGLES,Te,Jr.disabled,T,fr.disabled,Yt,Et,i.id,_.boundsBuffer,y.quadTriangleIndexBuffer,_.boundsSegments):w.draw(l,d.TRIANGLES,Te,B[Se.overscaledZ],T,fr.disabled,Yt,Et,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(A,E,F,O);break;case"background":(function(y,s,i,r){const l=i.paint.get("background-color"),d=i.paint.get("background-opacity");if(d===0)return;const _=y.context,w=_.gl,T=y.transform,B=T.tileSize,j=i.paint.get("background-pattern");if(y.isPatternMissing(j))return;const Y=!j&&l.a===1&&d===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==Y)return;const ce=Jr.disabled,Se=y.depthModeForSublayer(0,Y==="opaque"?Br.ReadWrite:Br.ReadOnly),Te=y.colorModeForRenderPass(),Re=y.useProgram(j?"backgroundPattern":"background"),Be=r||T.coveringTiles({tileSize:B,terrain:y.style.map.terrain});j&&(_.activeTexture.set(w.TEXTURE0),y.imageManager.bind(y.context));const Je=i.getCrossfadeParameters();for(const xt of Be){const at=r?xt.posMatrix:y.transform.calculatePosMatrix(xt.toUnwrapped()),ct=j?Or(at,d,y,j,{tileID:xt,tileSize:B},Je):Ar(at,d,l),Et=y.style.map.terrain&&y.style.map.terrain.getTerrainData(xt);Re.draw(_,w.TRIANGLES,Se,ce,Te,fr.disabled,ct,Et,i.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(A,0,F,O);break;case"custom":(function(y,s,i){const r=y.context,l=i.implementation;if(y.renderPass==="offscreen"){const d=l.prerender;d&&(y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),d.call(l,r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),r.setStencilMode(Jr.disabled);const d=l.renderingMode==="3d"?new Br(y.context.gl.LEQUAL,Br.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Br.ReadOnly);r.setDepthMode(d),l.render(r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState(),r.bindFramebuffer.set(null)}})(A,0,F)}}translatePosMatrix(A,E,F,O,y){if(!F[0]&&!F[1])return A;const s=y?O==="map"?this.transform.angle:0:O==="viewport"?-this.transform.angle:0;if(s){const l=Math.sin(s),d=Math.cos(s);F=[F[0]*d-F[1]*l,F[0]*l+F[1]*d]}const i=[y?F[0]:Fe(E,F[0],this.transform.zoom),y?F[1]:Fe(E,F[1],this.transform.zoom),0],r=new Float32Array(16);return a.$(r,A,i),r}saveTileTexture(A){const E=this._tileTextures[A.size[0]];E?E.push(A):this._tileTextures[A.size[0]]=[A]}getTileTexture(A){const E=this._tileTextures[A];return E&&E.length>0?E.pop():null}isPatternMissing(A){if(!A)return!1;if(!A.from||!A.to)return!0;const E=this.imageManager.getPattern(A.from.toString()),F=this.imageManager.getPattern(A.to.toString());return!E||!F}useProgram(A,E){this.cache=this.cache||{};const F=A+(E?E.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[F]||(this.cache[F]=new Vs(this.context,Vt[A],E,Ua[A],this._showOverdrawInspector,this.style.map.terrain)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const A=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(A.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new pt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:A,drawingBufferHeight:E}=this.context.gl;return this.width!==A||this.height!==E}}class Nr{constructor(A,E){this.points=A,this.planes=E}static fromInvProjectionMatrix(A,E,F){const O=Math.pow(2,F),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const r=1/(i=a.ag([],i,A))[3]/E*O;return a.b3(i,i,[r,r,1/i[3],r])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(i=>{const r=function(w,T){var B=T[0],j=T[1],Y=T[2],ce=B*B+j*j+Y*Y;return ce>0&&(ce=1/Math.sqrt(ce)),w[0]=T[0]*ce,w[1]=T[1]*ce,w[2]=T[2]*ce,w}([],function(w,T,B){var j=T[0],Y=T[1],ce=T[2],Se=B[0],Te=B[1],Re=B[2];return w[0]=Y*Re-ce*Te,w[1]=ce*Se-j*Re,w[2]=j*Te-Y*Se,w}([],Ge([],y[i[0]],y[i[1]]),Ge([],y[i[2]],y[i[1]]))),l=-((d=r)[0]*(_=y[i[1]])[0]+d[1]*_[1]+d[2]*_[2]);var d,_;return r.concat(l)});return new Nr(y,s)}}class ha{constructor(A,E){this.min=A,this.max=E,this.center=function(F,O,y){return F[0]=.5*O[0],F[1]=.5*O[1],F[2]=.5*O[2],F}([],function(F,O,y){return F[0]=O[0]+y[0],F[1]=O[1]+y[1],F[2]=O[2]+y[2],F}([],this.min,this.max))}quadrant(A){const E=[A%2==0,A<2],F=Pt(this.min),O=Pt(this.max);for(let y=0;y<E.length;y++)F[y]=E[y]?this.min[y]:this.center[y],O[y]=E[y]?this.center[y]:this.max[y];return O[2]=this.max[2],new ha(F,O)}distanceX(A){return Math.max(Math.min(this.max[0],A[0]),this.min[0])-A[0]}distanceY(A){return Math.max(Math.min(this.max[1],A[1]),this.min[1])-A[1]}intersects(A){const E=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let F=!0;for(let O=0;O<A.planes.length;O++){const y=A.planes[O];let s=0;for(let i=0;i<E.length;i++)a.b4(y,E[i])>=0&&s++;if(s===0)return 0;s!==E.length&&(F=!1)}if(F)return 2;for(let O=0;O<3;O++){let y=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let i=0;i<A.points.length;i++){const r=A.points[i][O]-this.min[O];y=Math.min(y,r),s=Math.max(s,r)}if(s<0||y>this.max[O]-this.min[O])return 0}return 1}}class po{constructor(A=0,E=0,F=0,O=0){if(isNaN(A)||A<0||isNaN(E)||E<0||isNaN(F)||F<0||isNaN(O)||O<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=A,this.bottom=E,this.left=F,this.right=O}interpolate(A,E,F){return E.top!=null&&A.top!=null&&(this.top=a.B.number(A.top,E.top,F)),E.bottom!=null&&A.bottom!=null&&(this.bottom=a.B.number(A.bottom,E.bottom,F)),E.left!=null&&A.left!=null&&(this.left=a.B.number(A.left,E.left,F)),E.right!=null&&A.right!=null&&(this.right=a.B.number(A.right,E.right,F)),this}getCenter(A,E){const F=a.ad((this.left+A-this.right)/2,0,A),O=a.ad((this.top+E-this.bottom)/2,0,E);return new a.P(F,O)}equals(A){return this.top===A.top&&this.bottom===A.bottom&&this.left===A.left&&this.right===A.right}clone(){return new po(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ea{constructor(A,E,F,O,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||!!y,this._minZoom=A||0,this._maxZoom=E||22,this._minPitch=F??0,this._maxPitch=O??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new po,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const A=new ea(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return A.apply(this),A}apply(A){this.tileSize=A.tileSize,this.latRange=A.latRange,this.width=A.width,this.height=A.height,this._center=A._center,this._elevation=A._elevation,this._minEleveationForCurrentTile=A._minEleveationForCurrentTile,this.zoom=A.zoom,this.angle=A.angle,this._fov=A._fov,this._pitch=A._pitch,this._unmodified=A._unmodified,this._edgeInsets=A._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(A){this._minZoom!==A&&(this._minZoom=A,this.zoom=Math.max(this.zoom,A))}get maxZoom(){return this._maxZoom}set maxZoom(A){this._maxZoom!==A&&(this._maxZoom=A,this.zoom=Math.min(this.zoom,A))}get minPitch(){return this._minPitch}set minPitch(A){this._minPitch!==A&&(this._minPitch=A,this.pitch=Math.max(this.pitch,A))}get maxPitch(){return this._maxPitch}set maxPitch(A){this._maxPitch!==A&&(this._maxPitch=A,this.pitch=Math.min(this.pitch,A))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(A){A===void 0?A=!0:A===null&&(A=!1),this._renderWorldCopies=A}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(A){const E=-a.b5(A,-180,180)*Math.PI/180;this.angle!==E&&(this._unmodified=!1,this.angle=E,this._calcMatrices(),this.rotationMatrix=function(){var F=new a.A(4);return a.A!=Float32Array&&(F[1]=0,F[2]=0),F[0]=1,F[3]=1,F}(),function(F,O,y){var s=O[0],i=O[1],r=O[2],l=O[3],d=Math.sin(y),_=Math.cos(y);F[0]=s*_+r*d,F[1]=i*_+l*d,F[2]=s*-d+r*_,F[3]=i*-d+l*_}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(A){const E=a.ad(A,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==E&&(this._unmodified=!1,this._pitch=E,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(A){A=Math.max(.01,Math.min(60,A)),this._fov!==A&&(this._unmodified=!1,this._fov=A/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(A){const E=Math.min(Math.max(A,this.minZoom),this.maxZoom);this._zoom!==E&&(this._unmodified=!1,this._zoom=E,this.tileZoom=Math.max(0,Math.floor(E)),this.scale=this.zoomScale(E),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(A){A.lat===this._center.lat&&A.lng===this._center.lng||(this._unmodified=!1,this._center=A,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(A){A!==this._elevation&&(this._elevation=A,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(A){this._edgeInsets.equals(A)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,A,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(A){return this._edgeInsets.equals(A)}interpolatePadding(A,E,F){this._unmodified=!1,this._edgeInsets.interpolate(A,E,F),this._constrain(),this._calcMatrices()}coveringZoomLevel(A){const E=(A.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/A.tileSize));return Math.max(0,E)}getVisibleUnwrappedCoordinates(A){const E=[new a.b6(0,A)];if(this._renderWorldCopies){const F=this.pointCoordinate(new a.P(0,0)),O=this.pointCoordinate(new a.P(this.width,0)),y=this.pointCoordinate(new a.P(this.width,this.height)),s=this.pointCoordinate(new a.P(0,this.height)),i=Math.floor(Math.min(F.x,O.x,y.x,s.x)),r=Math.floor(Math.max(F.x,O.x,y.x,s.x)),l=1;for(let d=i-l;d<=r+l;d++)d!==0&&E.push(new a.b6(d,A))}return E}coveringTiles(A){var E,F;let O=this.coveringZoomLevel(A);const y=O;if(A.minzoom!==void 0&&O<A.minzoom)return[];A.maxzoom!==void 0&&O>A.maxzoom&&(O=A.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),i=a.U.fromLngLat(this.center),r=Math.pow(2,O),l=[r*s.x,r*s.y,0],d=[r*i.x,r*i.y,0],_=Nr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,O);let w=A.minzoom||0;!A.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(w=O);const T=A.terrain?2/Math.min(this.tileSize,A.tileSize)*this.tileSize:3,B=Te=>({aabb:new ha([Te*r,0,0],[(Te+1)*r,r,0]),zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),j=[],Y=[],ce=O,Se=A.reparseOverscaled?y:O;if(this._renderWorldCopies)for(let Te=1;Te<=3;Te++)j.push(B(-Te)),j.push(B(Te));for(j.push(B(0));j.length>0;){const Te=j.pop(),Re=Te.x,Be=Te.y;let Je=Te.fullyVisible;if(!Je){const wt=Te.aabb.intersects(_);if(wt===0)continue;Je=wt===2}const xt=A.terrain?l:d,at=Te.aabb.distanceX(xt),ct=Te.aabb.distanceY(xt),Et=Math.max(Math.abs(at),Math.abs(ct));if(Te.zoom===ce||Et>T+(1<<ce-Te.zoom)-2&&Te.zoom>=w){const wt=ce-Te.zoom,ri=l[0]-.5-(Re<<wt),Yt=l[1]-.5-(Be<<wt);Y.push({tileID:new a.O(Te.zoom===ce?Se:Te.zoom,Te.wrap,Te.zoom,Re,Be),distanceSq:Xt([d[0]-.5-Re,d[1]-.5-Be]),tileDistanceToCamera:Math.sqrt(ri*ri+Yt*Yt)})}else for(let wt=0;wt<4;wt++){const ri=(Re<<1)+wt%2,Yt=(Be<<1)+(wt>>1),ei=Te.zoom+1;let si=Te.aabb.quadrant(wt);if(A.terrain){const ji=new a.O(ei,Te.wrap,ei,ri,Yt),Qi=A.terrain.getMinMaxElevation(ji),Ei=(E=Qi.minElevation)!==null&&E!==void 0?E:this.elevation,Ui=(F=Qi.maxElevation)!==null&&F!==void 0?F:this.elevation;si=new ha([si.min[0],si.min[1],Ei],[si.max[0],si.max[1],Ui])}j.push({aabb:si,zoom:ei,x:ri,y:Yt,wrap:Te.wrap,fullyVisible:Je})}}return Y.sort((Te,Re)=>Te.distanceSq-Re.distanceSq).map(Te=>Te.tileID)}resize(A,E){this.width=A,this.height=E,this.pixelsToGLUnits=[2/A,-2/E],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(A){return Math.pow(2,A)}scaleZoom(A){return Math.log(A)/Math.LN2}project(A){const E=a.ad(A.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.G(A.lng)*this.worldSize,a.H(E)*this.worldSize)}unproject(A){return new a.U(A.x/this.worldSize,A.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(A){const E=this.pointLocation(this.centerPoint,A),F=A.getElevationForLngLatZoom(E,this.tileZoom);if(!(this.elevation-F))return;const O=this.getCameraPosition(),y=a.U.fromLngLat(O.lngLat,O.altitude),s=a.U.fromLngLat(E,F),i=y.x-s.x,r=y.y-s.y,l=y.z-s.z,d=Math.sqrt(i*i+r*r+l*l),_=this.scaleZoom(this.cameraToCenterDistance/d/this.tileSize);this._elevation=F,this._center=E,this.zoom=_}setLocationAtPoint(A,E){const F=this.pointCoordinate(E),O=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(A),s=new a.U(y.x-(F.x-O.x),y.y-(F.y-O.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(A,E){return E?this.coordinatePoint(this.locationCoordinate(A),E.getElevationForLngLatZoom(A,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(A))}pointLocation(A,E){return this.coordinateLocation(this.pointCoordinate(A,E))}locationCoordinate(A){return a.U.fromLngLat(A)}coordinateLocation(A){return A&&A.toLngLat()}pointCoordinate(A,E){if(E){const w=E.pointCoordinate(A);if(w!=null)return w}const F=[A.x,A.y,0,1],O=[A.x,A.y,1,1];a.ag(F,F,this.pixelMatrixInverse),a.ag(O,O,this.pixelMatrixInverse);const y=F[3],s=O[3],i=F[1]/y,r=O[1]/s,l=F[2]/y,d=O[2]/s,_=l===d?0:(0-l)/(d-l);return new a.U(a.B.number(F[0]/y,O[0]/s,_)/this.worldSize,a.B.number(i,r,_)/this.worldSize)}coordinatePoint(A,E=0,F=this.pixelMatrix){const O=[A.x*this.worldSize,A.y*this.worldSize,E,1];return a.ag(O,O,F),new a.P(O[0]/O[3],O[1]/O[3])}getBounds(){const A=Math.max(0,this.height/2-this.getHorizon());return new Oi().extend(this.pointLocation(new a.P(0,A))).extend(this.pointLocation(new a.P(this.width,A))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Oi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(A){A?(this.lngRange=[A.getWest(),A.getEast()],this.latRange=[A.getSouth(),A.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(A,E=!1){const F=A.key,O=E?this._alignedPosMatrixCache:this._posMatrixCache;if(O[F])return O[F];const y=A.canonical,s=this.worldSize/this.zoomScale(y.z),i=y.x+Math.pow(2,y.z)*A.wrap,r=a.ao(new Float64Array(16));return a.$(r,r,[i*s,y.y*s,0]),a.a0(r,r,[s/a.N,s/a.N,1]),a.a1(r,E?this.alignedProjMatrix:this.projMatrix,r),O[F]=new Float32Array(r),O[F]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let A,E,F,O,y=-90,s=90,i=-180,r=180;const l=this.size,d=this._unmodified;if(this.latRange){const T=this.latRange;y=a.H(T[1])*this.worldSize,s=a.H(T[0])*this.worldSize,A=s-y<l.y?l.y/(s-y):0}if(this.lngRange){const T=this.lngRange;i=a.b5(a.G(T[0])*this.worldSize,0,this.worldSize),r=a.b5(a.G(T[1])*this.worldSize,0,this.worldSize),r<i&&(r+=this.worldSize),E=r-i<l.x?l.x/(r-i):0}const _=this.point,w=Math.max(E||0,A||0);if(w)return this.center=this.unproject(new a.P(E?(r+i)/2:_.x,A?(s+y)/2:_.y)),this.zoom+=this.scaleZoom(w),this._unmodified=d,void(this._constraining=!1);if(this.latRange){const T=_.y,B=l.y/2;T-B<y&&(O=y+B),T+B>s&&(O=s-B)}if(this.lngRange){const T=(i+r)/2,B=a.b5(_.x,T-this.worldSize/2,T+this.worldSize/2),j=l.x/2;B-j<i&&(F=i+j),B+j>r&&(F=r-j)}F===void 0&&O===void 0||(this.center=this.unproject(new a.P(F!==void 0?F:_.x,O!==void 0?O:_.y)).wrap()),this._unmodified=d,this._constraining=!1}_calcMatrices(){if(!this.height)return;const A=this.centerOffset,E=this.point.x,F=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b7(1,this.center.lat)*this.worldSize;let O=a.ao(new Float64Array(16));a.a0(O,O,[this.width/2,-this.height/2,1]),a.$(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.ao(new Float64Array(16)),a.a0(O,O,[1,-1,1]),a.$(O,O,[-1,-1,0]),a.a0(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this._minEleveationForCurrentTile),i=y-s*this._pixelPerMeter/Math.cos(this._pitch),r=s<0?i:y,l=Math.PI/2+this._pitch,d=this._fov*(.5+A.y/this.height),_=Math.sin(d)*r/Math.sin(a.ad(Math.PI-l-d,.01,Math.PI-.01)),w=this.getHorizon(),T=2*Math.atan(w/this.cameraToCenterDistance)*(.5+A.y/(2*w)),B=Math.sin(T)*r/Math.sin(a.ad(Math.PI-l-T,.01,Math.PI-.01)),j=Math.min(_,B),Y=1.01*(Math.cos(Math.PI/2-this._pitch)*j+r),ce=this.height/50;O=new Float64Array(16),a.b8(O,this._fov,this.width/this.height,ce,Y),O[8]=2*-A.x/this.width,O[9]=2*A.y/this.height,a.a0(O,O,[1,-1,1]),a.$(O,O,[0,0,-this.cameraToCenterDistance]),a.b9(O,O,this._pitch),a.ae(O,O,this.angle),a.$(O,O,[-E,-F,0]),this.mercatorMatrix=a.a0([],O,[this.worldSize,this.worldSize,this.worldSize]),a.a0(O,O,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.a1(new Float64Array(16),this.labelPlaneMatrix,O),a.$(O,O,[0,0,-this.elevation]),this.projMatrix=O,this.invProjMatrix=a.as([],O),this.pixelMatrix3D=a.a1(new Float64Array(16),this.labelPlaneMatrix,O);const Se=this.width%2/2,Te=this.height%2/2,Re=Math.cos(this.angle),Be=Math.sin(this.angle),Je=E-Math.round(E)+Re*Se+Be*Te,xt=F-Math.round(F)+Re*Te+Be*Se,at=new Float64Array(O);if(a.$(at,at,[Je>.5?Je-1:Je,xt>.5?xt-1:xt,0]),this.alignedProjMatrix=at,O=a.as(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const A=this.pointCoordinate(new a.P(0,0)),E=[A.x*this.worldSize,A.y*this.worldSize,0,1];return a.ag(E,E,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const A=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,A))}getCameraQueryGeometry(A){const E=this.getCameraPoint();if(A.length===1)return[A[0],E];{let F=E.x,O=E.y,y=E.x,s=E.y;for(const i of A)F=Math.min(F,i.x),O=Math.min(O,i.y),y=Math.max(y,i.x),s=Math.max(s,i.y);return[new a.P(F,O),new a.P(y,O),new a.P(y,s),new a.P(F,s),new a.P(F,O)]}}}function Sa(Z,A){let E,F=!1,O=null,y=null;const s=()=>{O=null,F&&(Z.apply(y,E),O=setTimeout(s,A),F=!1)};return(...i)=>(F=!0,y=this,E=i,O||s(),O)}class ka{constructor(A){this._getCurrentHash=()=>{const E=window.location.hash.replace("#","");if(this._hashName){let F;return E.split("&").map(O=>O.split("=")).forEach(O=>{O[0]===this._hashName&&(F=O)}),(F&&F[1]||"").split("/")}return E.split("/")},this._onHashChange=()=>{const E=this._getCurrentHash();if(E.length>=3&&!E.some(F=>isNaN(F))){const F=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(E[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+E[2],+E[1]],zoom:+E[0],bearing:F,pitch:+(E[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const E=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,E)}catch{}},this._updateHash=Sa(this._updateHashUnthrottled,300),this._hashName=A&&encodeURIComponent(A)}addTo(A){return this._map=A,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(A){const E=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,O=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,O),s=Math.round(E.lng*y)/y,i=Math.round(E.lat*y)/y,r=this._map.getBearing(),l=this._map.getPitch();let d="";if(d+=A?`/${s}/${i}/${F}`:`${F}/${i}/${s}`,(r||l)&&(d+="/"+Math.round(10*r)/10),l&&(d+=`/${Math.round(l)}`),this._hashName){const _=this._hashName;let w=!1;const T=window.location.hash.slice(1).split("&").map(B=>{const j=B.split("=")[0];return j===_?(w=!0,`${j}=${d}`):B}).filter(B=>B);return w||T.push(`${_}=${d}`),`#${T.join("&")}`}return`#${d}`}}const Wa={linearity:.3,easing:a.ba(0,0,.3,1)},cl=a.e({deceleration:2500,maxSpeed:1400},Wa),lu=a.e({deceleration:20,maxSpeed:1400},Wa),gl=a.e({deceleration:1e3,maxSpeed:360},Wa),ro=a.e({deceleration:1e3,maxSpeed:90},Wa);class mi{constructor(A){this._map=A,this.clear()}clear(){this._inertiaBuffer=[]}record(A){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.h.now(),settings:A})}_drainInertiaBuffer(){const A=this._inertiaBuffer,E=a.h.now();for(;A.length>0&&E-A[0].time>160;)A.shift()}_onMoveEnd(A){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const E={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)E.zoom+=y.zoomDelta||0,E.bearing+=y.bearingDelta||0,E.pitch+=y.pitchDelta||0,y.panDelta&&E.pan._add(y.panDelta),y.around&&(E.around=y.around),y.pinchAround&&(E.pinchAround=y.pinchAround);const F=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,O={};if(E.pan.mag()){const y=Di(E.pan.mag(),F,a.e({},cl,A||{}));O.offset=E.pan.mult(y.amount/E.pan.mag()),O.center=this._map.transform.center,Vi(O,y)}if(E.zoom){const y=Di(E.zoom,F,lu);O.zoom=this._map.transform.zoom+y.amount,Vi(O,y)}if(E.bearing){const y=Di(E.bearing,F,gl);O.bearing=this._map.transform.bearing+a.ad(y.amount,-179,179),Vi(O,y)}if(E.pitch){const y=Di(E.pitch,F,ro);O.pitch=this._map.transform.pitch+y.amount,Vi(O,y)}if(O.zoom||O.bearing){const y=E.pinchAround===void 0?E.around:E.pinchAround;O.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),a.e(O,{noMoveStart:!0})}}function Vi(Z,A){(!Z.duration||Z.duration<A.duration)&&(Z.duration=A.duration,Z.easing=A.easing)}function Di(Z,A,E){const{maxSpeed:F,linearity:O,deceleration:y}=E,s=a.ad(Z*O/(A/1e3),-F,F),i=Math.abs(s)/(y*O);return{easing:E.easing,duration:1e3*i,amount:s*(i/2)}}class Ft extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F,O={}){const y=W.mousePos(E.getCanvasContainer(),F),s=E.unproject(y);super(A,a.e({point:y,lngLat:s,originalEvent:F},O)),this._defaultPrevented=!1,this.target=E}}class ti extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F){const O=A==="touchend"?F.changedTouches:F.touches,y=W.touchPos(E.getCanvasContainer(),O),s=y.map(r=>E.unproject(r)),i=y.reduce((r,l,d,_)=>r.add(l.div(_.length)),new a.P(0,0));super(A,{points:y,point:i,lngLats:s,lngLat:E.unproject(i),originalEvent:F}),this._defaultPrevented=!1}}class xi extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,E,F){super(A,{originalEvent:F}),this._defaultPrevented=!1}}class Fi{constructor(A,E){this._map=A,this._clickTolerance=E.clickTolerance}reset(){delete this._mousedownPos}wheel(A){return this._firePreventable(new xi(A.type,this._map,A))}mousedown(A,E){return this._mousedownPos=E,this._firePreventable(new Ft(A.type,this._map,A))}mouseup(A){this._map.fire(new Ft(A.type,this._map,A))}click(A,E){this._mousedownPos&&this._mousedownPos.dist(E)>=this._clickTolerance||this._map.fire(new Ft(A.type,this._map,A))}dblclick(A){return this._firePreventable(new Ft(A.type,this._map,A))}mouseover(A){this._map.fire(new Ft(A.type,this._map,A))}mouseout(A){this._map.fire(new Ft(A.type,this._map,A))}touchstart(A){return this._firePreventable(new ti(A.type,this._map,A))}touchmove(A){this._map.fire(new ti(A.type,this._map,A))}touchend(A){this._map.fire(new ti(A.type,this._map,A))}touchcancel(A){this._map.fire(new ti(A.type,this._map,A))}_firePreventable(A){if(this._map.fire(A),A.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ln{constructor(A){this._map=A}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(A){this._map.fire(new Ft(A.type,this._map,A))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ft("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(A){this._delayContextMenu?this._contextMenuEvent=A:this._ignoreContextMenu||this._map.fire(new Ft(A.type,this._map,A)),this._map.listens("contextmenu")&&A.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hn{constructor(A){this._map=A}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(A){return this.transform.pointLocation(a.P.convert(A),this._map.terrain)}}class lr{constructor(A,E){this._map=A,this._tr=new Hn(A),this._el=A.getCanvasContainer(),this._container=A.getContainer(),this._clickTolerance=E.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(A,E){this.isEnabled()&&A.shiftKey&&A.button===0&&(W.disableDrag(),this._startPos=this._lastPos=E,this._active=!0)}mousemoveWindow(A,E){if(!this._active)return;const F=E;if(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)return;const O=this._startPos;this._lastPos=F,this._box||(this._box=W.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",A));const y=Math.min(O.x,F.x),s=Math.max(O.x,F.x),i=Math.min(O.y,F.y),r=Math.max(O.y,F.y);W.setTransform(this._box,`translate(${y}px,${i}px)`),this._box.style.width=s-y+"px",this._box.style.height=r-i+"px"}mouseupWindow(A,E){if(!this._active||A.button!==0)return;const F=this._startPos,O=E;if(this.reset(),W.suppressClick(),F.x!==O.x||F.y!==O.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:A})),{cameraAnimation:y=>y.fitScreenCoordinates(F,O,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",A)}keydown(A){this._active&&A.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",A))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(W.remove(this._box),this._box=null),W.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(A,E){return this._map.fire(new a.k(A,{originalEvent:E}))}}function Yn(Z,A){if(Z.length!==A.length)throw new Error(`The number of touches and points are not equal - touches ${Z.length}, points ${A.length}`);const E={};for(let F=0;F<Z.length;F++)E[Z[F].identifier]=A[F];return E}class qs{constructor(A){this.reset(),this.numTouches=A.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(A,E,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=A.timeStamp),F.length===this.numTouches&&(this.centroid=function(O){const y=new a.P(0,0);for(const s of O)y._add(s);return y.div(O.length)}(E),this.touches=Yn(F,E)))}touchmove(A,E,F){if(this.aborted||!this.centroid)return;const O=Yn(F,E);for(const y in this.touches){const s=O[y];(!s||s.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(A,E,F){if((!this.centroid||A.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){const O=!this.aborted&&this.centroid;if(this.reset(),O)return O}}}class ks{constructor(A){this.singleTap=new qs(A),this.numTaps=A.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(A,E,F){this.singleTap.touchstart(A,E,F)}touchmove(A,E,F){this.singleTap.touchmove(A,E,F)}touchend(A,E,F){const O=this.singleTap.touchend(A,E,F);if(O){const y=A.timeStamp-this.lastTime<500,s=!this.lastTap||this.lastTap.dist(O)<30;if(y&&s||this.reset(),this.count++,this.lastTime=A.timeStamp,this.lastTap=O,this.count===this.numTaps)return this.reset(),O}}}class As{constructor(A){this._tr=new Hn(A),this._zoomIn=new ks({numTouches:1,numTaps:2}),this._zoomOut=new ks({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(A,E,F){this._zoomIn.touchstart(A,E,F),this._zoomOut.touchstart(A,E,F)}touchmove(A,E,F){this._zoomIn.touchmove(A,E,F),this._zoomOut.touchmove(A,E,F)}touchend(A,E,F){const O=this._zoomIn.touchend(A,E,F),y=this._zoomOut.touchend(A,E,F),s=this._tr;return O?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom+1,around:s.unproject(O)},{originalEvent:A})}):y?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom-1,around:s.unproject(y)},{originalEvent:A})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xa{constructor(A){this._enabled=!!A.enable,this._moveStateManager=A.moveStateManager,this._clickTolerance=A.clickTolerance||1,this._moveFunction=A.move,this._activateOnStart=!!A.activateOnStart,A.assignEvents(this),this.reset()}reset(A){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(A)}_move(...A){const E=this._moveFunction(...A);if(E.bearingDelta||E.pitchDelta||E.around||E.panDelta)return this._active=!0,E}dragStart(A,E){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(A)&&(this._moveStateManager.startMove(A),this._lastPoint=E.length?E[0]:E,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(A,E){if(!this.isEnabled())return;const F=this._lastPoint;if(!F)return;if(A.preventDefault(),!this._moveStateManager.isValidMoveEvent(A))return void this.reset(A);const O=E.length?E[0]:E;return!this._moved&&O.dist(F)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=O,this._move(F,O))}dragEnd(A){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(A)&&(this._moved&&W.suppressClick(),this.reset(A))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const mo={0:1,2:2};class rs{constructor(A){this._correctEvent=A.checkCorrectEvent}startMove(A){const E=W.mouseButton(A);this._eventButton=E}endMove(A){delete this._eventButton}isValidStartEvent(A){return this._correctEvent(A)}isValidMoveEvent(A){return!function(E,F){const O=mo[F];return E.buttons===void 0||(E.buttons&O)!==O}(A,this._eventButton)}isValidEndEvent(A){return W.mouseButton(A)===this._eventButton}}class Qu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(A){return A.targetTouches.length===1}_isSameTouchEvent(A){return A.targetTouches[0].identifier===this._firstTouch}startMove(A){this._firstTouch=A.targetTouches[0].identifier}endMove(A){delete this._firstTouch}isValidStartEvent(A){return this._isOneFingerTouch(A)}isValidMoveEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}isValidEndEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}}const Ru=Z=>{Z.mousedown=Z.dragStart,Z.mousemoveWindow=Z.dragMove,Z.mouseup=Z.dragEnd,Z.contextmenu=function(A){A.preventDefault()}},go=({enable:Z,clickTolerance:A,bearingDegreesPerPixelMoved:E=.8})=>{const F=new rs({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Xa({clickTolerance:A,move:(O,y)=>({bearingDelta:(y.x-O.x)*E}),moveStateManager:F,enable:Z,assignEvents:Ru})},Ml=({enable:Z,clickTolerance:A,pitchDegreesPerPixelMoved:E=-.5})=>{const F=new rs({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Xa({clickTolerance:A,move:(O,y)=>({pitchDelta:(y.y-O.y)*E}),moveStateManager:F,enable:Z,assignEvents:Ru})};class Pn{constructor(A,E){this._minTouches=A.cooperativeGestures?2:1,this._clickTolerance=A.clickTolerance||1,this._map=E,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(A,E,F){return this._calculateTransform(A,E,F)}touchmove(A,E,F){if(this._map._cooperativeGestures&&(this._minTouches===2&&F.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(A,!1,F.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(F.length<this._minTouches))return A.preventDefault(),this._calculateTransform(A,E,F)}touchend(A,E,F){this._calculateTransform(A,E,F),this._active&&F.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(A,E,F){F.length>0&&(this._active=!0);const O=Yn(F,E),y=new a.P(0,0),s=new a.P(0,0);let i=0;for(const l in O){const d=O[l],_=this._touches[l];_&&(y._add(d),s._add(d.sub(_)),i++,O[l]=d)}if(this._touches=O,i<this._minTouches||!s.mag())return;const r=s.div(i);return this._sum._add(r),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(i),panDelta:r}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ma{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(A,E,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([E[0],E[1]]))}touchmove(A,E,F){if(!this._firstTwoTouches)return;A.preventDefault();const[O,y]=this._firstTwoTouches,s=Sn(F,E,O),i=Sn(F,E,y);if(!s||!i)return;const r=this._aroundCenter?null:s.add(i).div(2);return this._move([s,i],r,A)}touchend(A,E,F){if(!this._firstTwoTouches)return;const[O,y]=this._firstTwoTouches,s=Sn(F,E,O),i=Sn(F,E,y);s&&i||(this._active&&W.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(A){this._enabled=!0,this._aroundCenter=!!A&&A.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sn(Z,A,E){for(let F=0;F<Z.length;F++)if(Z[F].identifier===E)return A[F]}function Fo(Z,A){return Math.log(Z/A)/Math.LN2}class Nl extends Ma{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(A){this._startDistance=this._distance=A[0].dist(A[1])}_move(A,E){const F=this._distance;if(this._distance=A[0].dist(A[1]),this._active||!(Math.abs(Fo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fo(this._distance,F),pinchAround:E}}}function En(Z,A){return 180*Z.angleWith(A)/Math.PI}class Hl extends Ma{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(A){this._startVector=this._vector=A[0].sub(A[1]),this._minDiameter=A[0].dist(A[1])}_move(A,E){const F=this._vector;if(this._vector=A[0].sub(A[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:En(this._vector,F),pinchAround:E}}_isBelowThreshold(A){this._minDiameter=Math.min(this._minDiameter,A.mag());const E=25/(Math.PI*this._minDiameter)*360,F=En(A,this._startVector);return Math.abs(F)<E}}function Cn(Z){return Math.abs(Z.y)>Math.abs(Z.x)}class _l extends Ma{constructor(A){super(),this._map=A}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(A,E,F){super.touchstart(A,E,F),this._currentTouchCount=F.length}_start(A){this._lastPoints=A,Cn(A[0].sub(A[1]))&&(this._valid=!1)}_move(A,E,F){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const O=A[0].sub(this._lastPoints[0]),y=A[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(O,y,F.timeStamp),this._valid?(this._lastPoints=A,this._active=!0,{pitchDelta:(O.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(A,E,F){if(this._valid!==void 0)return this._valid;const O=A.mag()>=2,y=E.mag()>=2;if(!O&&!y)return;if(!O||!y)return this._firstMove===void 0&&(this._firstMove=F),F-this._firstMove<100&&void 0;const s=A.y>0==E.y>0;return Cn(A)&&Cn(E)&&s}}const uu={panStep:100,bearingStep:15,pitchStep:10};class Fu{constructor(A){this._tr=new Hn(A);const E=uu;this._panStep=E.panStep,this._bearingStep=E.bearingStep,this._pitchStep=E.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(A){if(A.altKey||A.ctrlKey||A.metaKey)return;let E=0,F=0,O=0,y=0,s=0;switch(A.keyCode){case 61:case 107:case 171:case 187:E=1;break;case 189:case 109:case 173:E=-1;break;case 37:A.shiftKey?F=-1:(A.preventDefault(),y=-1);break;case 39:A.shiftKey?F=1:(A.preventDefault(),y=1);break;case 38:A.shiftKey?O=1:(A.preventDefault(),s=-1);break;case 40:A.shiftKey?O=-1:(A.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(F=0,O=0),{cameraAnimation:i=>{const r=this._tr;i.easeTo({duration:300,easeId:"keyboardHandler",easing:Vl,zoom:E?Math.round(r.zoom)+E*(A.shiftKey?2:1):r.zoom,bearing:r.bearing+F*this._bearingStep,pitch:r.pitch+O*this._pitchStep,offset:[-y*this._panStep,-s*this._panStep],center:r.center},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Vl(Z){return Z*(2-Z)}const yl=4.000244140625;class ta{constructor(A,E){this._onTimeout=F=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(F)},this._map=A,this._tr=new Hn(A),this._el=A.getCanvasContainer(),this._triggerRenderFrame=E,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(A){this._defaultZoomRate=A}setWheelZoomRate(A){this._wheelZoomRate=A}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(A){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!A&&A.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(A){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!A[this._map._metaKey])return;A.preventDefault()}let E=A.deltaMode===WheelEvent.DOM_DELTA_LINE?40*A.deltaY:A.deltaY;const F=a.h.now(),O=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,E!==0&&E%yl==0?this._type="wheel":E!==0&&Math.abs(E)<4?this._type="trackpad":O>400?(this._type=null,this._lastValue=E,this._timeout=setTimeout(this._onTimeout,40,A)):this._type||(this._type=Math.abs(O*E)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,E+=this._lastValue)),A.shiftKey&&E&&(E/=4),this._type&&(this._lastWheelEvent=A,this._delta-=E,this._active||this._start(A)),A.preventDefault()}_start(A){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const E=W.mousePos(this._el,A),F=this._tr;this._around=a.L.convert(this._aroundCenter?F.center:F.unproject(E)),this._aroundPoint=F.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const A=this._tr.transform;if(this._delta!==0){const i=this._type==="wheel"&&Math.abs(this._delta)>yl?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&r!==0&&(r=1/r);const l=typeof this._targetZoom=="number"?A.zoomScale(this._targetZoom):A.scale;this._targetZoom=Math.min(A.maxZoom,Math.max(A.minZoom,A.scaleZoom(l*r))),this._type==="wheel"&&(this._startZoom=A.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const E=typeof this._targetZoom=="number"?this._targetZoom:A.zoom,F=this._startZoom,O=this._easing;let y,s=!1;if(this._type==="wheel"&&F&&O){const i=Math.min((a.h.now()-this._lastWheelEventTime)/200,1),r=O(i);y=a.B.number(F,E,r),i<1?this._frameId||(this._frameId=!0):s=!0}else y=E,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:y-A.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(A){let E=a.bb;if(this._prevEase){const F=this._prevEase,O=(a.h.now()-F.start)/F.duration,y=F.easing(O+.01)-F.easing(O),s=.27/Math.sqrt(y*y+1e-4)*.01,i=Math.sqrt(.0729-s*s);E=a.ba(s,i,.25,1)}return this._prevEase={start:a.h.now(),duration:A,easing:E},E}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class sc{constructor(A,E){this._clickZoom=A,this._tapZoom=E}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wu{constructor(A){this._tr=new Hn(A),this.reset()}reset(){this._active=!1}dblclick(A,E){return A.preventDefault(),{cameraAnimation:F=>{F.easeTo({duration:300,zoom:this._tr.zoom+(A.shiftKey?-1:1),around:this._tr.unproject(E)},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jl{constructor(){this._tap=new ks({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(A,E,F){if(!this._swipePoint)if(this._tapTime){const O=E[0],y=A.timeStamp-this._tapTime<500,s=this._tapPoint.dist(O)<30;y&&s?F.length>0&&(this._swipePoint=O,this._swipeTouch=F[0].identifier):this.reset()}else this._tap.touchstart(A,E,F)}touchmove(A,E,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;const O=E[0],y=O.y-this._swipePoint.y;return this._swipePoint=O,A.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(A,E,F)}touchend(A,E,F){if(this._tapTime)this._swipePoint&&F.length===0&&this.reset();else{const O=this._tap.touchend(A,E,F);O&&(this._tapTime=A.timeStamp,this._tapPoint=O)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fs{constructor(A,E,F){this._el=A,this._mousePan=E,this._touchPan=F}enable(A){this._inertiaOptions=A||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _a{constructor(A,E,F){this._pitchWithRotate=A.pitchWithRotate,this._mouseRotate=E,this._mousePitch=F}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class el{constructor(A,E,F,O){this._el=A,this._touchZoom=E,this._touchRotate=F,this._tapDragZoom=O,this._rotationDisabled=!1,this._enabled=!0}enable(A){this._touchZoom.enable(A),this._rotationDisabled||this._touchRotate.enable(A),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _u=Z=>Z.zoom||Z.drag||Z.pitch||Z.rotate;class Ou extends a.k{}function cu(Z){return Z.panDelta&&Z.panDelta.mag()||Z.zoomDelta||Z.bearingDelta||Z.pitchDelta}class Nu{constructor(A,E){this.handleWindowEvent=O=>{this.handleEvent(O,`${O.type}Window`)},this.handleEvent=(O,y)=>{if(O.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const s=O.type==="renderFrame"?void 0:O,i={needsRenderFrame:!1},r={},l={},d=O.touches,_=d?this._getMapTouches(d):void 0,w=_?W.touchPos(this._el,_):W.mousePos(this._el,O);for(const{handlerName:j,handler:Y,allowed:ce}of this._handlers){if(!Y.isEnabled())continue;let Se;this._blockedByActive(l,ce,j)?Y.reset():Y[y||O.type]&&(Se=Y[y||O.type](O,w,_),this.mergeHandlerResult(i,r,Se,j,s),Se&&Se.needsRenderFrame&&this._triggerRenderFrame()),(Se||Y.isActive())&&(l[j]=Y)}const T={};for(const j in this._previousActiveHandlers)l[j]||(T[j]=s);this._previousActiveHandlers=l,(Object.keys(T).length||cu(i))&&(this._changes.push([i,r,T]),this._triggerRenderFrame()),(Object.keys(l).length||cu(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=i;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))},this._map=A,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mi(A),this._bearingSnap=E.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(E);const F=this._el;this._listeners=[[F,"touchstart",{passive:!0}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[window,"blur",void 0]];for(const[O,y,s]of this._listeners)W.addEventListener(O,y,O===document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[A,E,F]of this._listeners)W.removeEventListener(A,E,A===document?this.handleWindowEvent:this.handleEvent,F)}_addDefaultHandlers(A){const E=this._map,F=E.getCanvasContainer();this._add("mapEvent",new Fi(E,A));const O=E.boxZoom=new lr(E,A);this._add("boxZoom",O),A.interactive&&A.boxZoom&&O.enable();const y=new As(E),s=new Wu(E);E.doubleClickZoom=new sc(s,y),this._add("tapZoom",y),this._add("clickZoom",s),A.interactive&&A.doubleClickZoom&&E.doubleClickZoom.enable();const i=new jl;this._add("tapDragZoom",i);const r=E.touchPitch=new _l(E);this._add("touchPitch",r),A.interactive&&A.touchPitch&&E.touchPitch.enable(A.touchPitch);const l=go(A),d=Ml(A);E.dragRotate=new _a(A,l,d),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",d,["mouseRotate"]),A.interactive&&A.dragRotate&&E.dragRotate.enable();const _=(({enable:ce,clickTolerance:Se})=>{const Te=new rs({checkCorrectEvent:Re=>W.mouseButton(Re)===0&&!Re.ctrlKey});return new Xa({clickTolerance:Se,move:(Re,Be)=>({around:Be,panDelta:Be.sub(Re)}),activateOnStart:!0,moveStateManager:Te,enable:ce,assignEvents:Ru})})(A),w=new Pn(A,E);E.dragPan=new fs(F,_,w),this._add("mousePan",_),this._add("touchPan",w,["touchZoom","touchRotate"]),A.interactive&&A.dragPan&&E.dragPan.enable(A.dragPan);const T=new Hl,B=new Nl;E.touchZoomRotate=new el(F,B,T,i),this._add("touchRotate",T,["touchPan","touchZoom"]),this._add("touchZoom",B,["touchPan","touchRotate"]),A.interactive&&A.touchZoomRotate&&E.touchZoomRotate.enable(A.touchZoomRotate);const j=E.scrollZoom=new ta(E,()=>this._triggerRenderFrame());this._add("scrollZoom",j,["mousePan"]),A.interactive&&A.scrollZoom&&E.scrollZoom.enable(A.scrollZoom);const Y=E.keyboard=new Fu(E);this._add("keyboard",Y),A.interactive&&A.keyboard&&E.keyboard.enable(),this._add("blockableMapEvent",new Ln(E))}_add(A,E,F){this._handlers.push({handlerName:A,handler:E,allowed:F}),this._handlersById[A]=E}stop(A){if(!this._updatingCamera){for(const{handler:E}of this._handlers)E.reset();this._inertia.clear(),this._fireEvents({},{},A),this._changes=[]}}isActive(){for(const{handler:A}of this._handlers)if(A.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_u(this._eventsInProgress)||this.isZooming()}_blockedByActive(A,E,F){for(const O in A)if(O!==F&&(!E||E.indexOf(O)<0))return!0;return!1}_getMapTouches(A){const E=[];for(const F of A)this._el.contains(F.target)&&E.push(F);return E}mergeHandlerResult(A,E,F,O,y){if(!F)return;a.e(A,F);const s={handlerName:O,originalEvent:F.originalEvent||y};F.zoomDelta!==void 0&&(E.zoom=s),F.panDelta!==void 0&&(E.drag=s),F.pitchDelta!==void 0&&(E.pitch=s),F.bearingDelta!==void 0&&(E.rotate=s)}_applyChanges(){const A={},E={},F={};for(const[O,y,s]of this._changes)O.panDelta&&(A.panDelta=(A.panDelta||new a.P(0,0))._add(O.panDelta)),O.zoomDelta&&(A.zoomDelta=(A.zoomDelta||0)+O.zoomDelta),O.bearingDelta&&(A.bearingDelta=(A.bearingDelta||0)+O.bearingDelta),O.pitchDelta&&(A.pitchDelta=(A.pitchDelta||0)+O.pitchDelta),O.around!==void 0&&(A.around=O.around),O.pinchAround!==void 0&&(A.pinchAround=O.pinchAround),O.noInertia&&(A.noInertia=O.noInertia),a.e(E,y),a.e(F,s);this._updateMapTransform(A,E,F),this._changes=[]}_updateMapTransform(A,E,F){const O=this._map,y=O._getTransformForUpdate(),s=O.terrain;if(!(cu(A)||s&&this._terrainMovement))return this._fireEvents(E,F,!0);let{panDelta:i,zoomDelta:r,bearingDelta:l,pitchDelta:d,around:_,pinchAround:w}=A;w!==void 0&&(_=w),O._stop(!0),_=_||O.transform.centerPoint;const T=y.pointLocation(i?_.sub(i):_);l&&(y.bearing+=l),d&&(y.pitch+=d),r&&(y.zoom+=r),s?this._terrainMovement||!E.drag&&!E.zoom?E.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(i)):y.setLocationAtPoint(T,_):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(T,_),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,y.recalculateZoom(O.terrain)})):y.setLocationAtPoint(T,_),O._applyUpdatedTransform(y),this._map._update(),A.noInertia||this._inertia.record(A),this._fireEvents(E,F,!0)}_fireEvents(A,E,F){const O=_u(this._eventsInProgress),y=_u(A),s={};for(const d in A){const{originalEvent:_}=A[d];this._eventsInProgress[d]||(s[`${d}start`]=_),this._eventsInProgress[d]=A[d]}!O&&y&&this._fireEvent("movestart",y.originalEvent);for(const d in s)this._fireEvent(d,s[d]);y&&this._fireEvent("move",y.originalEvent);for(const d in A){const{originalEvent:_}=A[d];this._fireEvent(d,_)}const i={};let r;for(const d in this._eventsInProgress){const{handlerName:_,originalEvent:w}=this._eventsInProgress[d];this._handlersById[_].isActive()||(delete this._eventsInProgress[d],r=E[_]||w,i[`${d}end`]=r)}for(const d in i)this._fireEvent(d,i[d]);const l=_u(this._eventsInProgress);if(F&&(O||y)&&!l){this._updatingCamera=!0;const d=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=w=>w!==0&&-this._bearingSnap<w&&w<this._bearingSnap;!d||!d.essential&&a.h.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:r})),_(this._map.getBearing())&&this._map.resetNorth()):(_(d.bearing||this._map.getBearing())&&(d.bearing=0),d.freezeElevation=!0,this._map.easeTo(d,{originalEvent:r})),this._updatingCamera=!1}}_fireEvent(A,E){this._map.fire(new a.k(A,E?{originalEvent:E}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(A=>{delete this._frameId,this.handleEvent(new Ou("renderFrame",{timeStamp:A})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class _r extends a.E{constructor(A,E){super(),this._renderFrameCallback=()=>{const F=Math.min((a.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=A,this._bearingSnap=E.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.L(this.transform.center.lng,this.transform.center.lat)}setCenter(A,E){return this.jumpTo({center:A},E)}panBy(A,E,F){return A=a.P.convert(A).mult(-1),this.panTo(this.transform.center,a.e({offset:A},E),F)}panTo(A,E,F){return this.easeTo(a.e({center:A},E),F)}getZoom(){return this.transform.zoom}setZoom(A,E){return this.jumpTo({zoom:A},E),this}zoomTo(A,E,F){return this.easeTo(a.e({zoom:A},E),F)}zoomIn(A,E){return this.zoomTo(this.getZoom()+1,A,E),this}zoomOut(A,E){return this.zoomTo(this.getZoom()-1,A,E),this}getBearing(){return this.transform.bearing}setBearing(A,E){return this.jumpTo({bearing:A},E),this}getPadding(){return this.transform.padding}setPadding(A,E){return this.jumpTo({padding:A},E),this}rotateTo(A,E,F){return this.easeTo(a.e({bearing:A},E),F)}resetNorth(A,E){return this.rotateTo(0,a.e({duration:1e3},A),E),this}resetNorthPitch(A,E){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},A),E),this}snapToNorth(A,E){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(A,E):this}getPitch(){return this.transform.pitch}setPitch(A,E){return this.jumpTo({pitch:A},E),this}cameraForBounds(A,E){A=Oi.convert(A);const F=E&&E.bearing||0;return this._cameraForBoxAndBearing(A.getNorthWest(),A.getSouthEast(),F,E)}_cameraForBoxAndBearing(A,E,F,O){const y={top:0,bottom:0,right:0,left:0};if(typeof(O=a.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){const Be=O.padding;O.padding={top:Be,bottom:Be,right:Be,left:Be}}O.padding=a.e(y,O.padding);const s=this.transform,i=s.padding,r=s.project(a.L.convert(A)),l=s.project(a.L.convert(E)),d=r.rotate(-F*Math.PI/180),_=l.rotate(-F*Math.PI/180),w=new a.P(Math.max(d.x,_.x),Math.max(d.y,_.y)),T=new a.P(Math.min(d.x,_.x),Math.min(d.y,_.y)),B=w.sub(T),j=(s.width-(i.left+i.right+O.padding.left+O.padding.right))/B.x,Y=(s.height-(i.top+i.bottom+O.padding.top+O.padding.bottom))/B.y;if(Y<0||j<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ce=Math.min(s.scaleZoom(s.scale*Math.min(j,Y)),O.maxZoom),Se=a.P.convert(O.offset),Te=new a.P((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(F*Math.PI/180),Re=Se.add(Te).mult(s.scale/s.zoomScale(ce));return{center:s.unproject(r.add(l).div(2).sub(Re)),zoom:ce,bearing:F}}fitBounds(A,E,F){return this._fitInternal(this.cameraForBounds(A,E),E,F)}fitScreenCoordinates(A,E,F,O,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(A)),this.transform.pointLocation(a.P.convert(E)),F,O),O,y)}_fitInternal(A,E,F){return A?(delete(E=a.e(A,E)).padding,E.linear?this.easeTo(E,F):this.flyTo(E,F)):this}jumpTo(A,E){this.stop();const F=this._getTransformForUpdate();let O=!1,y=!1,s=!1;return"zoom"in A&&F.zoom!==+A.zoom&&(O=!0,F.zoom=+A.zoom),A.center!==void 0&&(F.center=a.L.convert(A.center)),"bearing"in A&&F.bearing!==+A.bearing&&(y=!0,F.bearing=+A.bearing),"pitch"in A&&F.pitch!==+A.pitch&&(s=!0,F.pitch=+A.pitch),A.padding==null||F.isPaddingEqual(A.padding)||(F.padding=A.padding),this._applyUpdatedTransform(F),this.fire(new a.k("movestart",E)).fire(new a.k("move",E)),O&&this.fire(new a.k("zoomstart",E)).fire(new a.k("zoom",E)).fire(new a.k("zoomend",E)),y&&this.fire(new a.k("rotatestart",E)).fire(new a.k("rotate",E)).fire(new a.k("rotateend",E)),s&&this.fire(new a.k("pitchstart",E)).fire(new a.k("pitch",E)).fire(new a.k("pitchend",E)),this.fire(new a.k("moveend",E))}calculateCameraOptionsFromTo(A,E,F,O=0){const y=a.U.fromLngLat(A,E),s=a.U.fromLngLat(F,O),i=s.x-y.x,r=s.y-y.y,l=s.z-y.z,d=Math.hypot(i,r,l);if(d===0)throw new Error("Can't calculate camera options with same From and To");const _=Math.hypot(i,r),w=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),T=180*Math.atan2(i,-r)/Math.PI;let B=180*Math.acos(_/d)/Math.PI;return B=l<0?90-B:90+B,{center:s.toLngLat(),zoom:w,pitch:B,bearing:T}}easeTo(A,E){this._stop(!1,A.easeId),((A=a.e({offset:[0,0],duration:500,easing:a.bb},A)).animate===!1||!A.essential&&a.h.prefersReducedMotion)&&(A.duration=0);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?+A.zoom:O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=a.P.convert(A.offset);let T=F.centerPoint.add(w);const B=F.pointLocation(T),j=a.L.convert(A.center||B);this._normalizeCenter(j);const Y=F.project(B),ce=F.project(j).sub(Y),Se=F.zoomScale(r-O);let Te,Re;A.around&&(Te=a.L.convert(A.around),Re=F.locationPoint(Te));const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||r!==O,this._rotating=this._rotating||y!==l,this._pitching=this._pitching||d!==s,this._padding=!F.isPaddingEqual(_),this._easeId=A.easeId,this._prepareEase(E,A.noMoveStart,Be),this.terrain&&this._prepareElevation(j),this._ease(Je=>{if(this._zooming&&(F.zoom=a.B.number(O,r,Je)),this._rotating&&(F.bearing=a.B.number(y,l,Je)),this._pitching&&(F.pitch=a.B.number(s,d,Je)),this._padding&&(F.interpolatePadding(i,_,Je),T=F.centerPoint.add(w)),this.terrain&&!A.freezeElevation&&this._updateElevation(Je),Te)F.setLocationAtPoint(Te,Re);else{const xt=F.zoomScale(F.zoom-O),at=r>O?Math.min(2,Se):Math.max(.5,Se),ct=Math.pow(at,1-Je),Et=F.unproject(Y.add(ce.mult(Je*ct)).mult(xt));F.setLocationAtPoint(F.renderWorldCopies?Et.wrap():Et,T)}this._applyUpdatedTransform(F),this._fireMoveEvents(E)},Je=>{this.terrain&&this._finalizeElevation(),this._afterEase(E,Je)},A),this}_prepareEase(A,E,F={}){this._moving=!0,E||F.moving||this.fire(new a.k("movestart",A)),this._zooming&&!F.zooming&&this.fire(new a.k("zoomstart",A)),this._rotating&&!F.rotating&&this.fire(new a.k("rotatestart",A)),this._pitching&&!F.pitching&&this.fire(new a.k("pitchstart",A))}_prepareElevation(A){this._elevationCenter=A,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(A,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(A){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const E=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(A<1&&E!==this._elevationTarget){const F=this._elevationTarget-this._elevationStart;this._elevationStart+=A*(F-(E-(F*A+this._elevationStart))/(1-A)),this._elevationTarget=E}this.transform.elevation=a.B.number(this._elevationStart,this._elevationTarget,A)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(A){if(!this.transformCameraUpdate)return;const E=A.clone(),{center:F,zoom:O,pitch:y,bearing:s,elevation:i}=this.transformCameraUpdate(E);F&&(E.center=F),O!==void 0&&(E.zoom=O),y!==void 0&&(E.pitch=y),s!==void 0&&(E.bearing=s),i!==void 0&&(E.elevation=i),this.transform.apply(E)}_fireMoveEvents(A){this.fire(new a.k("move",A)),this._zooming&&this.fire(new a.k("zoom",A)),this._rotating&&this.fire(new a.k("rotate",A)),this._pitching&&this.fire(new a.k("pitch",A))}_afterEase(A,E){if(this._easeId&&E&&this._easeId===E)return;delete this._easeId;const F=this._zooming,O=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,F&&this.fire(new a.k("zoomend",A)),O&&this.fire(new a.k("rotateend",A)),y&&this.fire(new a.k("pitchend",A)),this.fire(new a.k("moveend",A))}flyTo(A,E){if(!A.essential&&a.h.prefersReducedMotion){const si=a.F(A,["center","zoom","bearing","pitch","around"]);return this.jumpTo(si,E)}this.stop(),A=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.bb},A);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?a.ad(+A.zoom,F.minZoom,F.maxZoom):O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=F.zoomScale(r-O),T=a.P.convert(A.offset);let B=F.centerPoint.add(T);const j=F.pointLocation(B),Y=a.L.convert(A.center||j);this._normalizeCenter(Y);const ce=F.project(j),Se=F.project(Y).sub(ce);let Te=A.curve;const Re=Math.max(F.width,F.height),Be=Re/w,Je=Se.mag();if("minZoom"in A){const si=a.ad(Math.min(A.minZoom,O,r),F.minZoom,F.maxZoom),ji=Re/F.zoomScale(si-O);Te=Math.sqrt(ji/Je*2)}const xt=Te*Te;function at(si){const ji=(Be*Be-Re*Re+(si?-1:1)*xt*xt*Je*Je)/(2*(si?Be:Re)*xt*Je);return Math.log(Math.sqrt(ji*ji+1)-ji)}function ct(si){return(Math.exp(si)-Math.exp(-si))/2}function Et(si){return(Math.exp(si)+Math.exp(-si))/2}const wt=at(!1);let ri=function(si){return Et(wt)/Et(wt+Te*si)},Yt=function(si){return Re*((Et(wt)*(ct(ji=wt+Te*si)/Et(ji))-ct(wt))/xt)/Je;var ji},ei=(at(!0)-wt)/Te;if(Math.abs(Je)<1e-6||!isFinite(ei)){if(Math.abs(Re-Be)<1e-6)return this.easeTo(A,E);const si=Be<Re?-1:1;ei=Math.abs(Math.log(Be/Re))/Te,Yt=function(){return 0},ri=function(ji){return Math.exp(si*Te*ji)}}return A.duration="duration"in A?+A.duration:1e3*ei/("screenSpeed"in A?+A.screenSpeed/Te:+A.speed),A.maxDuration&&A.duration>A.maxDuration&&(A.duration=0),this._zooming=!0,this._rotating=y!==l,this._pitching=d!==s,this._padding=!F.isPaddingEqual(_),this._prepareEase(E,!1),this.terrain&&this._prepareElevation(Y),this._ease(si=>{const ji=si*ei,Qi=1/ri(ji);F.zoom=si===1?r:O+F.scaleZoom(Qi),this._rotating&&(F.bearing=a.B.number(y,l,si)),this._pitching&&(F.pitch=a.B.number(s,d,si)),this._padding&&(F.interpolatePadding(i,_,si),B=F.centerPoint.add(T)),this.terrain&&!A.freezeElevation&&this._updateElevation(si);const Ei=si===1?Y:F.unproject(ce.add(Se.mult(Yt(ji))).mult(Qi));F.setLocationAtPoint(F.renderWorldCopies?Ei.wrap():Ei,B),this._applyUpdatedTransform(F),this._fireMoveEvents(E)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(E)},A),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(A,E){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const F=this._onEaseEnd;delete this._onEaseEnd,F.call(this,E)}if(!A){const F=this.handlers;F&&F.stop(!1)}return this}_ease(A,E,F){F.animate===!1||F.duration===0?(A(1),E()):(this._easeStart=a.h.now(),this._easeOptions=F,this._onEaseFrame=A,this._onEaseEnd=E,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(A,E){A=a.b5(A,-180,180);const F=Math.abs(A-E);return Math.abs(A-360-E)<F&&(A-=360),Math.abs(A+360-E)<F&&(A+=360),A}_normalizeCenter(A){const E=this.transform;if(!E.renderWorldCopies||E.lngRange)return;const F=A.lng-E.center.lng;A.lng+=F>180?-360:F<-180?360:0}queryTerrainElevation(A){return this.terrain?this.terrain.getElevationForLngLatZoom(a.L.convert(A),this.transform.tileZoom)-this.transform.elevation:null}}class ds{constructor(A={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=E=>{!E||E.sourceDataType!=="metadata"&&E.sourceDataType!=="visibility"&&E.dataType!=="style"&&E.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=A}getDefaultPosition(){return"bottom-right"}onAdd(A){return this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=W.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=W.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(A,E){const F=this._map._getUIString(`AttributionControl.${E}`);A.title=F,A.setAttribute("aria-label",F)}_updateAttributions(){if(!this._map.style)return;let A=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?A=A.concat(this.options.customAttribution.map(O=>typeof O!="string"?"":O)):typeof this.options.customAttribution=="string"&&A.push(this.options.customAttribution)),this._map.style.stylesheet){const O=this._map.style.stylesheet;this.styleOwner=O.owner,this.styleId=O.id}const E=this._map.style.sourceCaches;for(const O in E){const y=E[O];if(y.used||y.usedForTerrain){const s=y.getSource();s.attribution&&A.indexOf(s.attribution)<0&&A.push(s.attribution)}}A=A.filter(O=>String(O).trim()),A.sort((O,y)=>O.length-y.length),A=A.filter((O,y)=>{for(let s=y+1;s<A.length;s++)if(A[s].indexOf(O)>=0)return!1;return!0});const F=A.join(" | ");F!==this._attribHTML&&(this._attribHTML=F,A.length?(this._innerContainer.innerHTML=F,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class gn{constructor(A={}){this._updateCompact=()=>{const E=this._container.children;if(E.length){const F=E[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&F.classList.add("maplibregl-compact"):F.classList.remove("maplibregl-compact")}},this.options=A}getDefaultPosition(){return"bottom-left"}onAdd(A){this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("div","maplibregl-ctrl");const E=W.create("a","maplibregl-ctrl-logo");return E.target="_blank",E.rel="noopener nofollow",E.href="https://maplibre.org/",E.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),E.setAttribute("rel","noopener nofollow"),this._container.appendChild(E),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){W.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class jn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(A){const E=++this._id;return this._queue.push({callback:A,id:E,cancelled:!1}),E}remove(A){const E=this._currentlyRunning,F=E?this._queue.concat(E):this._queue;for(const O of F)if(O.id===A)return void(O.cancelled=!0)}run(A=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const E=this._currentlyRunning=this._queue;this._queue=[];for(const F of E)if(!F.cancelled&&(F.callback(A),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Jn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var tl=a.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Tu extends a.E{constructor(A){super(),this.sourceCache=A,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,A.usedForTerrain=!0,A.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(A,E){this.sourceCache.update(A,E),this._renderableTilesKeys=[];const F={};for(const O of A.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:E}))F[O.key]=!0,this._renderableTilesKeys.push(O.key),this._tiles[O.key]||(O.posMatrix=new Float64Array(16),a.aS(O.posMatrix,0,a.N,0,a.N,0,1),this._tiles[O.key]=new wn(O,this.tileSize));for(const O in this._tiles)F[O]||delete this._tiles[O]}freeRtt(A){for(const E in this._tiles){const F=this._tiles[E];(!A||F.tileID.equals(A)||F.tileID.isChildOf(A)||A.isChildOf(F.tileID))&&(F.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(A=>this.getTileByID(A))}getTileByID(A){return this._tiles[A]}getTerrainCoords(A){const E={};for(const F of this._renderableTilesKeys){const O=this._tiles[F].tileID;if(O.canonical.equals(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16),a.aS(y.posMatrix,0,a.N,0,a.N,0,1),E[F]=y}else if(O.canonical.isChildOf(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=O.canonical.z-A.canonical.z,i=O.canonical.x-(O.canonical.x>>s<<s),r=O.canonical.y-(O.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,l,0,l,0,1),a.$(y.posMatrix,y.posMatrix,[-i*l,-r*l,0]),E[F]=y}else if(A.canonical.isChildOf(O.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=A.canonical.z-O.canonical.z,i=A.canonical.x-(A.canonical.x>>s<<s),r=A.canonical.y-(A.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,a.N,0,a.N,0,1),a.$(y.posMatrix,y.posMatrix,[i*l,r*l,0]),a.a0(y.posMatrix,y.posMatrix,[1/2**s,1/2**s,0]),E[F]=y}}return E}getSourceTile(A,E){const F=this.sourceCache._source;let O=A.overscaledZ-this.deltaZoom;if(O>F.maxzoom&&(O=F.maxzoom),O<F.minzoom)return null;this._sourceTileCache[A.key]||(this._sourceTileCache[A.key]=A.scaledTo(O).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[A.key]);if((!y||!y.dem)&&E)for(;O>=F.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(A.scaledTo(O--).key);return y}tilesAfterTime(A=Date.now()){return Object.values(this._tiles).filter(E=>E.timeAdded>=A)}}class oa{constructor(A,E,F){this.painter=A,this.sourceCache=new Tu(E),this.options=F,this.exaggeration=typeof F.exaggeration=="number"?F.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(A,E,F,O=a.N){var y;if(!(E>=0&&E<O&&F>=0&&F<O))return 0;const s=this.getTerrainData(A),i=(y=s.tile)===null||y===void 0?void 0:y.dem;if(!i)return 0;const r=function(B,j,Y){var ce=j[0],Se=j[1];return B[0]=Y[0]*ce+Y[4]*Se+Y[12],B[1]=Y[1]*ce+Y[5]*Se+Y[13],B}([],[E/O*a.N,F/O*a.N],s.u_terrain_matrix),l=[r[0]*i.dim,r[1]*i.dim],d=Math.floor(l[0]),_=Math.floor(l[1]),w=l[0]-d,T=l[1]-_;return i.get(d,_)*(1-w)*(1-T)+i.get(d+1,_)*w*(1-T)+i.get(d,_+1)*(1-w)*T+i.get(d+1,_+1)*w*T}getElevationForLngLatZoom(A,E){const{tileID:F,mercatorX:O,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(A,E);return this.getElevation(F,O%a.N,y%a.N,a.N)}getElevation(A,E,F,O=a.N){return this.getDEMElevation(A,E,F,O)*this.exaggeration}getTerrainData(A){if(!this._emptyDemTexture){const O=this.painter.context,y=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new pt(O,y,O.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new pt(O,new a.R({width:1,height:1}),O.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ao([])}const E=this.sourceCache.getSourceTile(A,!0);if(E&&E.dem&&(!E.demTexture||E.needsTerrainPrepare)){const O=this.painter.context;E.demTexture=this.painter.getTileTexture(E.dem.stride),E.demTexture?E.demTexture.update(E.dem.getPixels(),{premultiply:!1}):E.demTexture=new pt(O,E.dem.getPixels(),O.gl.RGBA,{premultiply:!1}),E.demTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),E.needsTerrainPrepare=!1}const F=E&&E+E.tileID.key+A.key;if(F&&!this._demMatrixCache[F]){const O=this.sourceCache.sourceCache._source.maxzoom;let y=A.canonical.z-E.tileID.canonical.z;A.overscaledZ>A.canonical.z&&(A.canonical.z>=O?y=A.canonical.z-O:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const s=A.canonical.x-(A.canonical.x>>y<<y),i=A.canonical.y-(A.canonical.y>>y<<y),r=a.bc(new Float64Array(16),[1/(a.N<<y),1/(a.N<<y),0]);a.$(r,r,[s*a.N,i*a.N,0]),this._demMatrixCache[A.key]={matrix:r,coord:A}}return{u_depth:2,u_terrain:3,u_terrain_dim:E&&E.dem&&E.dem.dim||1,u_terrain_matrix:F?this._demMatrixCache[A.key].matrix:this._emptyDemMatrix,u_terrain_unpack:E&&E.dem&&E.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(E&&E.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:E}}getFramebuffer(A){const E=this.painter,F=E.width/devicePixelRatio,O=E.height/devicePixelRatio;return!this._fbo||this._fbo.width===F&&this._fbo.height===O||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new pt(E.context,{width:F,height:O,data:null},E.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(E.context.gl.NEAREST,E.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new pt(E.context,{width:F,height:O,data:null},E.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(E.context.gl.NEAREST,E.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=E.context.createFramebuffer(F,O,!0,!1),this._fbo.depthAttachment.set(E.context.createRenderbuffer(E.context.gl.DEPTH_COMPONENT16,F,O))),this._fbo.colorAttachment.set(A==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const A=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const E=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,s=0;y<this._coordsTextureSize;y++)for(let i=0;i<this._coordsTextureSize;i++,s+=4)E[s+0]=255&i,E[s+1]=255&y,E[s+2]=i>>8<<4|y>>8,E[s+3]=0;const F=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(E.buffer)),O=new pt(A,F,A.gl.RGBA,{premultiply:!1});return O.bind(A.gl.NEAREST,A.gl.CLAMP_TO_EDGE),this._coordsTexture=O,O}pointCoordinate(A){const E=new Uint8Array(4),F=this.painter.context,O=F.gl;F.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),O.readPixels(A.x,this.painter.height/devicePixelRatio-A.y-1,1,1,O.RGBA,O.UNSIGNED_BYTE,E),F.bindFramebuffer.set(null);const y=E[0]+(E[2]>>4<<8),s=E[1]+((15&E[2])<<8),i=this.coordsIndex[255-E[3]],r=i&&this.sourceCache.getTileByID(i);if(!r)return null;const l=this._coordsTextureSize,d=(1<<r.tileID.canonical.z)*l;return new a.U(this._allowMercatorOverflow(A,(r.tileID.canonical.x*l+y)/d),(r.tileID.canonical.y*l+s)/d,this.getElevation(r.tileID,y,s,l))}getTerrainMesh(){if(this._mesh)return this._mesh;const A=this.painter.context,E=new a.bd,F=new a.b0,O=this.meshSize,y=a.N/O,s=O*O;for(let _=0;_<=O;_++)for(let w=0;w<=O;w++)E.emplaceBack(w*y,_*y,0);for(let _=0;_<s;_+=O+1)for(let w=0;w<O;w++)F.emplaceBack(w+_,O+w+_+1,O+w+_+2),F.emplaceBack(w+_,O+w+_+2,w+_+1);const i=E.length,r=i+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])E.emplaceBack(w*y,_*a.N,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(r+_,r+_+1,r+_+3),F.emplaceBack(r+_,r+_+3,r+_+2),F.emplaceBack(i+_,i+_+3,i+_+1),F.emplaceBack(i+_,i+_+2,i+_+3);const l=E.length,d=l+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])E.emplaceBack(_*a.N,w*y,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(l+_,l+_+1,l+_+3),F.emplaceBack(l+_,l+_+3,l+_+2),F.emplaceBack(d+_,d+_+3,d+_+1),F.emplaceBack(d+_,d+_+2,d+_+3);return this._mesh={indexBuffer:A.createIndexBuffer(F),vertexBuffer:A.createVertexBuffer(E,tl.members),segments:a.S.simpleSegment(0,0,E.length,F.length)},this._mesh}getMeshFrameDelta(A){return 2*Math.PI*a.be/Math.pow(2,A)/5}getMinTileElevationForLngLatZoom(A,E){var F;const{tileID:O}=this._getOverscaledTileIDFromLngLatZoom(A,E);return(F=this.getMinMaxElevation(O).minElevation)!==null&&F!==void 0?F:0}getMinMaxElevation(A){const E=this.getTerrainData(A).tile,F={minElevation:null,maxElevation:null};return E&&E.dem&&(F.minElevation=E.dem.min*this.exaggeration,F.maxElevation=E.dem.max*this.exaggeration),F}_getOverscaledTileIDFromLngLatZoom(A,E){const F=a.U.fromLngLat(A.wrap()),O=(1<<E)*a.N,y=F.x*O,s=F.y*O,i=Math.floor(y/a.N),r=Math.floor(s/a.N);return{tileID:new a.O(E,0,E,i,r),mercatorX:y,mercatorY:s}}_allowMercatorOverflow(A,E){const F=A.x<this.painter.width/2;let O=a.bf(E);const y=this.painter.transform.center.lng;return F&&Math.sign(O)>0&&Math.sign(y)<0||!F&&Math.sign(O)<0&&Math.sign(y)>0?(O=360*Math.sign(y)+O,a.G(O)):E}}class yu{constructor(A,E,F){this._context=A,this._size=E,this._tileSize=F,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const A of this._objects)A.texture.destroy(),A.fbo.destroy()}_createObject(A){const E=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),F=new pt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return F.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),E.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),E.colorAttachment.set(F.texture),{id:A,fbo:E,texture:F,stamp:-1,inUse:!1}}getObjectForId(A){return this._objects[A]}useObject(A){A.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(E=>A.id!==E),this._recentlyUsed.push(A.id)}stampObject(A){A.stamp=++this._stamp}getOrCreateFreeObject(){for(const E of this._recentlyUsed)if(!this._objects[E].inUse)return this._objects[E];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const A=this._createObject(this._objects.length);return this._objects.push(A),A}freeObject(A){A.inUse=!1}freeAllObjects(){for(const A of this._objects)this.freeObject(A)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(A=>!A.inUse)===!1}}const vs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ko{constructor(A,E){this.painter=A,this.terrain=E,this.pool=new yu(A.context,30,E.sourceCache.tileSize*E.qualityFactor)}destruct(){this.pool.destruct()}getTexture(A){return this.pool.getObjectForId(A.rtt[this._stacks.length-1].id).texture}prepareForRender(A,E){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=A._order.filter(F=>!A._layers[F].isHidden(E)),this._coordsDescendingInv={};for(const F in A.sourceCaches){this._coordsDescendingInv[F]={};const O=A.sourceCaches[F].getVisibleCoordinates();for(const y of O){const s=this.terrain.sourceCache.getTerrainCoords(y);for(const i in s)this._coordsDescendingInv[F][i]||(this._coordsDescendingInv[F][i]=[]),this._coordsDescendingInv[F][i].push(s[i])}}this._coordsDescendingInvStr={};for(const F of A._order){const O=A._layers[F],y=O.source;if(vs[O.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const s in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][s]=this._coordsDescendingInv[y][s].map(i=>i.key).sort().join()}}for(const F of this._renderableTiles)for(const O in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[O][F.tileID.key];y&&y!==F.rttCoords[O]&&(F.rtt=[])}}renderLayer(A){if(A.isHidden(this.painter.transform.zoom))return!1;const E=A.type,F=this.painter,O=this._renderableLayerIds[this._renderableLayerIds.length-1]===A.id;if(vs[E]&&(this._prevType&&vs[this._prevType]||this._stacks.push([]),this._prevType=E,this._stacks[this._stacks.length-1].push(A.id),!O))return!0;if(vs[this._prevType]||vs[E]&&O){this._prevType=E;const y=this._stacks.length-1,s=this._stacks[y]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&($r(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[y]){const l=this.pool.getObjectForId(i.rtt[y].id);if(l.stamp===i.rtt[y].stamp){this.pool.useObject(l);continue}}const r=this.pool.getOrCreateFreeObject();this.pool.useObject(r),this.pool.stampObject(r),i.rtt[y]={id:r.id,stamp:r.stamp},F.context.bindFramebuffer.set(r.fbo.framebuffer),F.context.clear({color:a.aT.transparent,stencil:0}),F.currentStencilSource=void 0;for(let l=0;l<s.length;l++){const d=F.style._layers[s[l]],_=d.source?this._coordsDescendingInv[d.source][i.tileID.key]:[i.tileID];F.context.viewport.set([0,0,r.fbo.width,r.fbo.height]),F._renderTileClippingMasks(d,_),F.renderLayer(F,F.style.sourceCaches[d.source],d,_),d.source&&(i.rttCoords[d.source]=this._coordsDescendingInvStr[d.source][i.tileID.key])}}return $r(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),vs[E]}return!1}}const ki=G,Bi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},xs=Z=>{Z.touchstart=Z.dragStart,Z.touchmoveWindow=Z.dragMove,Z.touchend=Z.dragEnd},vu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Oo{constructor(A,E,F=!1){this.mousedown=s=>{this.startMouse(a.e({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),W.mousePos(this.element,s)),W.addEventListener(window,"mousemove",this.mousemove),W.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=s=>{this.moveMouse(s,W.mousePos(this.element,s))},this.mouseup=s=>{this.mouseRotate.dragEnd(s),this.mousePitch&&this.mousePitch.dragEnd(s),this.offTemp()},this.touchstart=s=>{s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.startTouch(s,this._startPos),W.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.addEventListener(window,"touchend",this.touchend))},this.touchmove=s=>{s.targetTouches.length!==1?this.reset():(this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.moveTouch(s,this._lastPos))},this.touchend=s=>{s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const O=A.dragRotate._mouseRotate.getClickTolerance(),y=A.dragRotate._mousePitch.getClickTolerance();this.element=E,this.mouseRotate=go({clickTolerance:O,enable:!0}),this.touchRotate=(({enable:s,clickTolerance:i,bearingDegreesPerPixelMoved:r=.8})=>{const l=new Qu;return new Xa({clickTolerance:i,move:(d,_)=>({bearingDelta:(_.x-d.x)*r}),moveStateManager:l,enable:s,assignEvents:xs})})({clickTolerance:O,enable:!0}),this.map=A,F&&(this.mousePitch=Ml({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:s,clickTolerance:i,pitchDegreesPerPixelMoved:r=-.5})=>{const l=new Qu;return new Xa({clickTolerance:i,move:(d,_)=>({pitchDelta:(_.y-d.y)*r}),moveStateManager:l,enable:s,assignEvents:xs})})({clickTolerance:y,enable:!0})),W.addEventListener(E,"mousedown",this.mousedown),W.addEventListener(E,"touchstart",this.touchstart,{passive:!1}),W.addEventListener(E,"touchcancel",this.reset)}startMouse(A,E){this.mouseRotate.dragStart(A,E),this.mousePitch&&this.mousePitch.dragStart(A,E),W.disableDrag()}startTouch(A,E){this.touchRotate.dragStart(A,E),this.touchPitch&&this.touchPitch.dragStart(A,E),W.disableDrag()}moveMouse(A,E){const F=this.map,{bearingDelta:O}=this.mouseRotate.dragMove(A,E)||{};if(O&&F.setBearing(F.getBearing()+O),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(A,E)||{};y&&F.setPitch(F.getPitch()+y)}}moveTouch(A,E){const F=this.map,{bearingDelta:O}=this.touchRotate.dragMove(A,E)||{};if(O&&F.setBearing(F.getBearing()+O),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(A,E)||{};y&&F.setPitch(F.getPitch()+y)}}off(){const A=this.element;W.removeEventListener(A,"mousedown",this.mousedown),W.removeEventListener(A,"touchstart",this.touchstart,{passive:!1}),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend),W.removeEventListener(A,"touchcancel",this.reset),this.offTemp()}offTemp(){W.enableDrag(),W.removeEventListener(window,"mousemove",this.mousemove),W.removeEventListener(window,"mouseup",this.mouseup),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend)}}let cs;function hl(Z,A,E){if(Z=new a.L(Z.lng,Z.lat),A){const F=new a.L(Z.lng-360,Z.lat),O=new a.L(Z.lng+360,Z.lat),y=E.locationPoint(Z).distSqr(A);E.locationPoint(F).distSqr(A)<y?Z=F:E.locationPoint(O).distSqr(A)<y&&(Z=O)}for(;Math.abs(Z.lng-E.center.lng)>180;){const F=E.locationPoint(Z);if(F.x>=0&&F.y>=0&&F.x<=E.width&&F.y<=E.height)break;Z.lng>E.center.lng?Z.lng-=360:Z.lng+=360}return Z}const Ms={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function C(Z,A,E){const F=Z.classList;for(const O in Ms)F.remove(`maplibregl-${E}-anchor-${O}`);F.add(`maplibregl-${E}-anchor-${A}`)}class D extends a.E{constructor(A){if(super(),this._onKeyPress=E=>{const F=E.code,O=E.charCode||E.keyCode;F!=="Space"&&F!=="Enter"&&O!==32&&O!==13||this.togglePopup()},this._onMapClick=E=>{const F=E.originalEvent.target,O=this._element;this._popup&&(F===O||O.contains(F))&&this.togglePopup()},this._update=E=>{if(!this._map)return;const F=this._map.loaded()&&!this._map.isMoving();((E==null?void 0:E.type)==="terrain"||(E==null?void 0:E.type)==="render"&&!F)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=hl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let O="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?O=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(O=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),E&&E.type!=="moveend"||(this._pos=this._pos.round()),W.setTransform(this._element,`${Ms[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${O}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const s=this._map.unproject(this._pos),i=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=s.distanceTo(this._lngLat)>20*i?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=E=>{if(!this._isDragging){const F=this._clickTolerance||this._map._clickTolerance;this._isDragging=E.point.dist(this._pointerdownPos)>=F}this._isDragging&&(this._pos=E.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=E=>{this._element.contains(E.originalEvent.target)&&(E.preventDefault(),this._positionDelta=E.point.sub(this._pos).add(this._offset),this._pointerdownPos=E.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=A&&A.anchor||"center",this._color=A&&A.color||"#3FB1CE",this._scale=A&&A.scale||1,this._draggable=A&&A.draggable||!1,this._clickTolerance=A&&A.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=A&&A.rotation||0,this._rotationAlignment=A&&A.rotationAlignment||"auto",this._pitchAlignment=A&&A.pitchAlignment&&A.pitchAlignment!=="auto"?A.pitchAlignment:this._rotationAlignment,A&&A.element)this._element=A.element,this._offset=a.P.convert(A&&A.offset||[0,0]);else{this._defaultMarker=!0,this._element=W.create("div"),this._element.setAttribute("aria-label","Map marker");const E=W.createNS("http://www.w3.org/2000/svg","svg"),F=41,O=27;E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height",`${F}px`),E.setAttributeNS(null,"width",`${O}px`),E.setAttributeNS(null,"viewBox",`0 0 ${O} ${F}`);const y=W.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const s=W.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const i=W.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"transform","translate(3.0, 29.0)"),i.setAttributeNS(null,"fill","#000000");const r=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of r){const Se=W.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",ce.rx),Se.setAttributeNS(null,"ry",ce.ry),i.appendChild(Se)}const l=W.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill",this._color);const d=W.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),l.appendChild(d);const _=W.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"fill","#000000");const w=W.createNS("http://www.w3.org/2000/svg","path");w.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),_.appendChild(w);const T=W.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(6.0, 7.0)"),T.setAttributeNS(null,"fill","#FFFFFF");const B=W.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(8.0, 8.0)");const j=W.createNS("http://www.w3.org/2000/svg","circle");j.setAttributeNS(null,"fill","#000000"),j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"cx","5.5"),j.setAttributeNS(null,"cy","5.5"),j.setAttributeNS(null,"r","5.4999962");const Y=W.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),B.appendChild(j),B.appendChild(Y),s.appendChild(i),s.appendChild(l),s.appendChild(_),s.appendChild(T),s.appendChild(B),E.appendChild(s),E.setAttributeNS(null,"height",F*this._scale+"px"),E.setAttributeNS(null,"width",O*this._scale+"px"),this._element.appendChild(E),this._offset=a.P.convert(A&&A.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()}),C(this._element,this._anchor,"marker"),A&&A.className)for(const E of A.className.split(" "))this._element.classList.add(E);this._popup=null}addTo(A){return this.remove(),this._map=A,A.getCanvasContainer().appendChild(this._element),A.on("move",this._update),A.on("moveend",this._update),A.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),W.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(A){return this._lngLat=a.L.convert(A),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(A){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),A){if(!("offset"in A.options)){const O=Math.abs(13.5)/Math.SQRT2;A.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[O,-1*(38.1-13.5+O)],"bottom-right":[-O,-1*(38.1-13.5+O)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=A,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const A=this._popup;return A?(A.isOpen()?A.remove():A.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(A){return this._offset=a.P.convert(A),this._update(),this}addClassName(A){this._element.classList.add(A)}removeClassName(A){this._element.classList.remove(A)}toggleClassName(A){return this._element.classList.toggle(A)}setDraggable(A){return this._draggable=!!A,this._map&&(A?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(A){return this._rotation=A||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(A){return this._rotationAlignment=A||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(A){return this._pitchAlignment=A&&A!=="auto"?A:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const z={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let R=0,ee=!1;const le={maxWidth:100,unit:"metric"};function oe(Z,A,E){const F=E&&E.maxWidth||100,O=Z._container.clientHeight/2,y=Z.unproject([0,O]),s=Z.unproject([F,O]),i=y.distanceTo(s);if(E&&E.unit==="imperial"){const r=3.2808*i;r>5280?we(A,F,r/5280,Z._getUIString("ScaleControl.Miles")):we(A,F,r,Z._getUIString("ScaleControl.Feet"))}else E&&E.unit==="nautical"?we(A,F,i/1852,Z._getUIString("ScaleControl.NauticalMiles")):i>=1e3?we(A,F,i/1e3,Z._getUIString("ScaleControl.Kilometers")):we(A,F,i,Z._getUIString("ScaleControl.Meters"))}function we(Z,A,E,F){const O=function(y){const s=Math.pow(10,`${Math.floor(y)}`.length-1);let i=y/s;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(r){const l=Math.pow(10,Math.ceil(-Math.log(r)/Math.LN10));return Math.round(r*l)/l}(i),s*i}(E);Z.style.width=A*(O/E)+"px",Z.innerHTML=`${O}&nbsp;${F}`}const We={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},vt=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ct(Z){if(Z){if(typeof Z=="number"){const A=Math.round(Math.abs(Z)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,Z),"top-left":new a.P(A,A),"top-right":new a.P(-A,A),bottom:new a.P(0,-Z),"bottom-left":new a.P(A,-A),"bottom-right":new a.P(-A,-A),left:new a.P(Z,0),right:new a.P(-Z,0)}}if(Z instanceof a.P||Array.isArray(Z)){const A=a.P.convert(Z);return{center:A,top:A,"top-left":A,"top-right":A,bottom:A,"bottom-left":A,"bottom-right":A,left:A,right:A}}return{center:a.P.convert(Z.center||[0,0]),top:a.P.convert(Z.top||[0,0]),"top-left":a.P.convert(Z["top-left"]||[0,0]),"top-right":a.P.convert(Z["top-right"]||[0,0]),bottom:a.P.convert(Z.bottom||[0,0]),"bottom-left":a.P.convert(Z["bottom-left"]||[0,0]),"bottom-right":a.P.convert(Z["bottom-right"]||[0,0]),left:a.P.convert(Z.left||[0,0]),right:a.P.convert(Z.right||[0,0])}}return Ct(new a.P(0,0))}const ni={extend:(Z,...A)=>a.e(Z,...A),run(Z){Z()},logToElement(Z,A=!1,E="log"){const F=window.document.getElementById(E);F&&(A&&(F.innerHTML=""),F.innerHTML+=`<br>${Z}`)}},Gt=G;class jt{static get version(){return Gt}static get workerCount(){return In.workerCount}static set workerCount(A){In.workerCount=A}static get maxParallelImageRequests(){return a.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(A){a.c.MAX_PARALLEL_IMAGE_REQUESTS=A}static get workerUrl(){return a.c.WORKER_URL}static set workerUrl(A){a.c.WORKER_URL=A}static addProtocol(A,E){a.c.REGISTERED_PROTOCOLS[A]=E}static removeProtocol(A){delete a.c.REGISTERED_PROTOCOLS[A]}}return jt.Map=class extends _r{constructor(Z){if(a.bg.mark(a.bh.create),(Z=a.e({},Bi,Z)).minZoom!=null&&Z.maxZoom!=null&&Z.minZoom>Z.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Z.minPitch!=null&&Z.maxPitch!=null&&Z.minPitch>Z.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Z.minPitch!=null&&Z.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(Z.maxPitch!=null&&Z.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ea(Z.minZoom,Z.maxZoom,Z.minPitch,Z.maxPitch,Z.renderWorldCopies),{bearingSnap:Z.bearingSnap}),this._cooperativeGesturesOnWheel=A=>{this._onCooperativeGesture(A,A[this._metaKey],1)},this._contextLost=A=>{A.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.k("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=Z.interactive,this._cooperativeGestures=Z.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=Z.maxTileCacheSize,this._maxTileCacheZoomLevels=Z.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=Z.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Z.preserveDrawingBuffer,this._antialias=Z.antialias,this._trackResize=Z.trackResize,this._bearingSnap=Z.bearingSnap,this._refreshExpiredTiles=Z.refreshExpiredTiles,this._fadeDuration=Z.fadeDuration,this._crossSourceCollisions=Z.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Z.collectResourceTiming,this._renderTaskQueue=new jn,this._controls=[],this._mapId=a.a2(),this._locale=a.e({},Jn,Z.locale),this._clickTolerance=Z.clickTolerance,this._overridePixelRatio=Z.pixelRatio,this._maxCanvasSize=Z.maxCanvasSize,this.transformCameraUpdate=Z.transformCameraUpdate,this._imageQueueHandle=tt.addThrottleControl(()=>this.isMoving()),this._requestManager=new ut(Z.transformRequest),typeof Z.container=="string"){if(this._container=document.getElementById(Z.container),!this._container)throw new Error(`Container '${Z.container}' not found.`)}else{if(!(Z.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Z.container}if(Z.maxBounds&&this.setMaxBounds(Z.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const E=Sa(F=>{this._trackResize&&!this._removed&&this.resize(F)._update()},50);this._resizeObserver=new ResizeObserver(F=>{A?E(F):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Nu(this,Z),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=Z.hash&&new ka(typeof Z.hash=="string"&&Z.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}),Z.bounds&&(this.resize(),this.fitBounds(Z.bounds,a.e({},Z.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Z.localIdeographFontFamily,this._validateStyle=Z.validateStyle,Z.style&&this.setStyle(Z.style,{localIdeographFontFamily:Z.localIdeographFontFamily}),Z.attributionControl&&this.addControl(new ds({customAttribution:Z.customAttribution})),Z.maplibreLogo&&this.addControl(new gn,Z.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new a.k(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new a.k(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new a.k("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(Z,A){if(A===void 0&&(A=Z.getDefaultPosition?Z.getDefaultPosition():"top-right"),!Z||!Z.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const E=Z.onAdd(this);this._controls.push(Z);const F=this._controlPositions[A];return A.indexOf("bottom")!==-1?F.insertBefore(E,F.firstChild):F.appendChild(E),this}removeControl(Z){if(!Z||!Z.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const A=this._controls.indexOf(Z);return A>-1&&this._controls.splice(A,1),Z.onRemove(this),this}hasControl(Z){return this._controls.indexOf(Z)>-1}calculateCameraOptionsFromTo(Z,A,E,F){return F==null&&this.terrain&&(F=this.terrain.getElevationForLngLatZoom(E,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(Z,A,E,F)}resize(Z){var A;const E=this._containerDimensions(),F=E[0],O=E[1],y=this._getClampedPixelRatio(F,O);if(this._resizeCanvas(F,O,y),this.painter.resize(F,O,y),this.painter.overLimit()){const i=this.painter.context.gl;this._maxCanvasSize=[i.drawingBufferWidth,i.drawingBufferHeight];const r=this._getClampedPixelRatio(F,O);this._resizeCanvas(F,O,r),this.painter.resize(F,O,r)}this.transform.resize(F,O),(A=this._requestedCameraState)===null||A===void 0||A.resize(F,O);const s=!this._moving;return s&&(this.stop(),this.fire(new a.k("movestart",Z)).fire(new a.k("move",Z))),this.fire(new a.k("resize",Z)),s&&this.fire(new a.k("moveend",Z)),this}_getClampedPixelRatio(Z,A){const{0:E,1:F}=this._maxCanvasSize,O=this.getPixelRatio(),y=Z*O,s=A*O;return Math.min(y>E?E/y:1,s>F?F/s:1)*O}getPixelRatio(){var Z;return(Z=this._overridePixelRatio)!==null&&Z!==void 0?Z:devicePixelRatio}setPixelRatio(Z){this._overridePixelRatio=Z,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(Z){return this.transform.setMaxBounds(Oi.convert(Z)),this._update()}setMinZoom(Z){if((Z=Z??-2)>=-2&&Z<=this.transform.maxZoom)return this.transform.minZoom=Z,this._update(),this.getZoom()<Z&&this.setZoom(Z),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(Z){if((Z=Z??22)>=this.transform.minZoom)return this.transform.maxZoom=Z,this._update(),this.getZoom()>Z&&this.setZoom(Z),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(Z){if((Z=Z??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(Z>=0&&Z<=this.transform.maxPitch)return this.transform.minPitch=Z,this._update(),this.getPitch()<Z&&this.setPitch(Z),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(Z){if((Z=Z??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(Z>=this.transform.minPitch)return this.transform.maxPitch=Z,this._update(),this.getPitch()>Z&&this.setPitch(Z),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(Z){return this.transform.renderWorldCopies=Z,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(Z){return this._cooperativeGestures=Z,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(Z){return this.transform.locationPoint(a.L.convert(Z),this.style&&this.terrain)}unproject(Z){return this.transform.pointLocation(a.P.convert(Z),this.terrain)}isMoving(){var Z;return this._moving||((Z=this.handlers)===null||Z===void 0?void 0:Z.isMoving())}isZooming(){var Z;return this._zooming||((Z=this.handlers)===null||Z===void 0?void 0:Z.isZooming())}isRotating(){var Z;return this._rotating||((Z=this.handlers)===null||Z===void 0?void 0:Z.isRotating())}_createDelegatedListener(Z,A,E){if(Z==="mouseenter"||Z==="mouseover"){let F=!1;return{layer:A,listener:E,delegates:{mousemove:y=>{const s=this.getLayer(A)?this.queryRenderedFeatures(y.point,{layers:[A]}):[];s.length?F||(F=!0,E.call(this,new Ft(Z,this,y.originalEvent,{features:s}))):F=!1},mouseout:()=>{F=!1}}}}if(Z==="mouseleave"||Z==="mouseout"){let F=!1;return{layer:A,listener:E,delegates:{mousemove:s=>{(this.getLayer(A)?this.queryRenderedFeatures(s.point,{layers:[A]}):[]).length?F=!0:F&&(F=!1,E.call(this,new Ft(Z,this,s.originalEvent)))},mouseout:s=>{F&&(F=!1,E.call(this,new Ft(Z,this,s.originalEvent)))}}}}{const F=O=>{const y=this.getLayer(A)?this.queryRenderedFeatures(O.point,{layers:[A]}):[];y.length&&(O.features=y,E.call(this,O),delete O.features)};return{layer:A,listener:E,delegates:{[Z]:F}}}}on(Z,A,E){if(E===void 0)return super.on(Z,A);const F=this._createDelegatedListener(Z,A,E);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Z]=this._delegatedListeners[Z]||[],this._delegatedListeners[Z].push(F);for(const O in F.delegates)this.on(O,F.delegates[O]);return this}once(Z,A,E){if(E===void 0)return super.once(Z,A);const F=this._createDelegatedListener(Z,A,E);for(const O in F.delegates)this.once(O,F.delegates[O]);return this}off(Z,A,E){return E===void 0?super.off(Z,A):(this._delegatedListeners&&this._delegatedListeners[Z]&&(F=>{const O=this._delegatedListeners[Z];for(let y=0;y<O.length;y++){const s=O[y];if(s.layer===A&&s.listener===E){for(const i in s.delegates)this.off(i,s.delegates[i]);return O.splice(y,1),this}}})(),this)}queryRenderedFeatures(Z,A){if(!this.style)return[];let E;const F=Z instanceof a.P||Array.isArray(Z),O=F?Z:[[0,0],[this.transform.width,this.transform.height]];if(A=A||(F?{}:Z)||{},O instanceof a.P||typeof O[0]=="number")E=[a.P.convert(O)];else{const y=a.P.convert(O[0]),s=a.P.convert(O[1]);E=[y,new a.P(s.x,y.y),s,new a.P(y.x,s.y),y]}return this.style.queryRenderedFeatures(E,A,this.transform)}querySourceFeatures(Z,A){return this.style.querySourceFeatures(Z,A)}setStyle(Z,A){return(A=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},A)).diff!==!1&&A.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&Z?(this._diffStyle(Z,A),this):(this._localIdeographFontFamily=A.localIdeographFontFamily,this._updateStyle(Z,A))}setTransformRequest(Z){return this._requestManager.setTransformRequest(Z),this}_getUIString(Z){const A=this._locale[Z];if(A==null)throw new Error(`Missing UI string '${Z}'`);return A}_updateStyle(Z,A){if(A.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(Z,A));const E=this.style&&A.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!Z)),Z?(this.style=new cr(this,A||{}),this.style.setEventedParent(this,{style:this.style}),typeof Z=="string"?this.style.loadURL(Z,A,E):this.style.loadJSON(Z,A,E),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new cr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(Z,A){if(typeof Z=="string"){const E=this._requestManager.transformRequest(Z,lt.Style);a.f(E,(F,O)=>{F?this.fire(new a.j(F)):O&&this._updateDiff(O,A)})}else typeof Z=="object"&&this._updateDiff(Z,A)}_updateDiff(Z,A){try{this.style.setState(Z,A)&&this._update(!0)}catch(E){a.w(`Unable to perform style diff: ${E.message||E.error||E}.  Rebuilding the style from scratch.`),this._updateStyle(Z,A)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(Z,A){return this._lazyInitEmptyStyle(),this.style.addSource(Z,A),this._update(!0)}isSourceLoaded(Z){const A=this.style&&this.style.sourceCaches[Z];if(A!==void 0)return A.loaded();this.fire(new a.j(new Error(`There is no source with ID '${Z}'`)))}setTerrain(Z){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),Z){const A=this.style.sourceCaches[Z.source];if(!A)throw new Error(`cannot load terrain, because there exists no source with ID: ${Z.source}`);for(const E in this.style._layers){const F=this.style._layers[E];F.type==="hillshade"&&F.source===Z.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new oa(this.painter,A,Z),this.painter.renderToTexture=new ko(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=E=>{E.dataType==="style"?this.terrain.sourceCache.freeRtt():E.dataType==="source"&&E.tile&&(E.sourceId!==Z.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(E.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:Z})),this}getTerrain(){var Z,A;return(A=(Z=this.terrain)===null||Z===void 0?void 0:Z.options)!==null&&A!==void 0?A:null}areTilesLoaded(){const Z=this.style&&this.style.sourceCaches;for(const A in Z){const E=Z[A]._tiles;for(const F in E){const O=E[F];if(O.state!=="loaded"&&O.state!=="errored")return!1}}return!0}addSourceType(Z,A,E){return this._lazyInitEmptyStyle(),this.style.addSourceType(Z,A,E)}removeSource(Z){return this.style.removeSource(Z),this._update(!0)}getSource(Z){return this.style.getSource(Z)}addImage(Z,A,E={}){const{pixelRatio:F=1,sdf:O=!1,stretchX:y,stretchY:s,content:i}=E;if(this._lazyInitEmptyStyle(),!(A instanceof HTMLImageElement||a.a(A))){if(A.width===void 0||A.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:l,data:d}=A,_=A;return this.style.addImage(Z,{data:new a.R({width:r,height:l},new Uint8Array(d)),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0,userImage:_}),_.onAdd&&_.onAdd(this,Z),this}}{const{width:r,height:l,data:d}=a.h.getImageData(A);this.style.addImage(Z,{data:new a.R({width:r,height:l},d),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0})}}updateImage(Z,A){const E=this.style.getImage(Z);if(!E)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const F=A instanceof HTMLImageElement||a.a(A)?a.h.getImageData(A):A,{width:O,height:y,data:s}=F;if(O===void 0||y===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(O!==E.data.width||y!==E.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const i=!(A instanceof HTMLImageElement||a.a(A));return E.data.replace(s,i),this.style.updateImage(Z,E),this}getImage(Z){return this.style.getImage(Z)}hasImage(Z){return Z?!!this.style.getImage(Z):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(Z){this.style.removeImage(Z)}loadImage(Z,A){tt.getImage(this._requestManager.transformRequest(Z,lt.Image),A)}listImages(){return this.style.listImages()}addLayer(Z,A){return this._lazyInitEmptyStyle(),this.style.addLayer(Z,A),this._update(!0)}moveLayer(Z,A){return this.style.moveLayer(Z,A),this._update(!0)}removeLayer(Z){return this.style.removeLayer(Z),this._update(!0)}getLayer(Z){return this.style.getLayer(Z)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(Z,A,E){return this.style.setLayerZoomRange(Z,A,E),this._update(!0)}setFilter(Z,A,E={}){return this.style.setFilter(Z,A,E),this._update(!0)}getFilter(Z){return this.style.getFilter(Z)}setPaintProperty(Z,A,E,F={}){return this.style.setPaintProperty(Z,A,E,F),this._update(!0)}getPaintProperty(Z,A){return this.style.getPaintProperty(Z,A)}setLayoutProperty(Z,A,E,F={}){return this.style.setLayoutProperty(Z,A,E,F),this._update(!0)}getLayoutProperty(Z,A){return this.style.getLayoutProperty(Z,A)}setGlyphs(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(Z,A),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(Z,A,E={}){return this._lazyInitEmptyStyle(),this.style.addSprite(Z,A,E,F=>{F||this._update(!0)}),this}removeSprite(Z){return this._lazyInitEmptyStyle(),this.style.removeSprite(Z),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setSprite(Z,A,E=>{E||this._update(!0)}),this}setLight(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setLight(Z,A),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(Z,A){return this.style.setFeatureState(Z,A),this._update()}removeFeatureState(Z,A){return this.style.removeFeatureState(Z,A),this._update()}getFeatureState(Z){return this.style.getFeatureState(Z)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let Z=0,A=0;return this._container&&(Z=this._container.clientWidth||400,A=this._container.clientHeight||300),[Z,A]}_setupContainer(){const Z=this._container;Z.classList.add("maplibregl-map");const A=this._canvasContainer=W.create("div","maplibregl-canvas-container",Z);this._interactive&&A.classList.add("maplibregl-interactive"),this._canvas=W.create("canvas","maplibregl-canvas",A),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const E=this._containerDimensions(),F=this._getClampedPixelRatio(E[0],E[1]);this._resizeCanvas(E[0],E[1],F);const O=this._controlContainer=W.create("div","maplibregl-control-container",Z),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{y[s]=W.create("div",`maplibregl-ctrl-${s} `,O)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=W.create("div","maplibregl-cooperative-gesture-screen",this._container);let Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${Z}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){W.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(Z,A,E){this._canvas.width=Math.floor(E*Z),this._canvas.height=Math.floor(E*A),this._canvas.style.width=`${Z}px`,this._canvas.style.height=`${A}px`}_setupPainter(){const Z={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let A=null;this._canvas.addEventListener("webglcontextcreationerror",F=>{A={requestedAttributes:Z},F&&(A.statusMessage=F.statusMessage,A.type=F.type)},{once:!0});const E=this._canvas.getContext("webgl2",Z)||this._canvas.getContext("webgl",Z);if(!E){const F="Failed to initialize WebGL";throw A?(A.message=F,new Error(JSON.stringify(A))):new Error(F)}this.painter=new mr(E,this.transform),he.testSupport(E)}_onCooperativeGesture(Z,A,E){return!A&&E<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(Z){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||Z,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(Z){return this._update(),this._renderTaskQueue.add(Z)}_cancelRenderFrame(Z){this._renderTaskQueue.remove(Z)}_render(Z){const A=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(Z),this._removed)return;let E=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,y=a.h.now();this.style.zoomHistory.update(O,y);const s=new a.a8(O,{now:y,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=s.crossFadingFactor();i===1&&i===this._crossFadingFactor||(E=!0,this._crossFadingFactor=i),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bg.mark(a.bh.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||E)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,a.bg.mark(a.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var Z;this._hash&&this._hash.remove();for(const E of this._controls)E.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),tt.removeThrottleControl(this._imageQueueHandle),(Z=this._resizeObserver)===null||Z===void 0||Z.disconnect();const A=this.painter.context.gl.getExtension("WEBGL_lose_context");A&&A.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),W.remove(this._canvasContainer),W.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),a.bg.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.h.frame(Z=>{a.bg.frame(Z),this._frame=null,this._render(Z)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(Z){this._showTileBoundaries!==Z&&(this._showTileBoundaries=Z,this._update())}get showPadding(){return!!this._showPadding}set showPadding(Z){this._showPadding!==Z&&(this._showPadding=Z,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(Z){this._showCollisionBoxes!==Z&&(this._showCollisionBoxes=Z,Z?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(Z){this._showOverdrawInspector!==Z&&(this._showOverdrawInspector=Z,this._update())}get repaint(){return!!this._repaint}set repaint(Z){this._repaint!==Z&&(this._repaint=Z,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(Z){this._vertices=Z,this._update()}get version(){return ki}getCameraTargetElevation(){return this.transform.elevation}},jt.NavigationControl=class{constructor(Z){this._updateZoomButtons=()=>{const A=this._map.getZoom(),E=A===this._map.getMaxZoom(),F=A===this._map.getMinZoom();this._zoomInButton.disabled=E,this._zoomOutButton.disabled=F,this._zoomInButton.setAttribute("aria-disabled",E.toString()),this._zoomOutButton.setAttribute("aria-disabled",F.toString())},this._rotateCompassArrow=()=>{const A=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=A},this._setButtonTitle=(A,E)=>{const F=this._map._getUIString(`NavigationControl.${E}`);A.title=F,A.setAttribute("aria-label",F)},this.options=a.e({},vu,Z),this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",A=>A.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",A=>this._map.zoomIn({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",A=>this._map.zoomOut({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",A=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:A}):this._map.resetNorth({},{originalEvent:A})}),this._compassIcon=W.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(Z){return this._map=Z,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Oo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){W.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(Z,A){const E=W.create("button",Z,this._container);return E.type="button",E.addEventListener("click",A),E}},jt.GeolocateControl=class extends a.E{constructor(Z){super(),this._onSuccess=A=>{if(this._map){if(this._isOutOfMapMaxBounds(A))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",A)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=A,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(A),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(A),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",A)),this._finish()}},this._updateCamera=A=>{const E=new a.L(A.coords.longitude,A.coords.latitude),F=A.coords.accuracy,O=this._map.getBearing(),y=a.e({bearing:O},this.options.fitBoundsOptions),s=Oi.fromLngLat(E,F);this._map.fitBounds(s,y,{geolocateSource:!0})},this._updateMarker=A=>{if(A){const E=new a.L(A.coords.longitude,A.coords.latitude);this._accuracyCircleMarker.setLngLat(E).addTo(this._map),this._userLocationDotMarker.setLngLat(E).addTo(this._map),this._accuracy=A.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=A=>{if(this._map){if(this.options.trackUserLocation)if(A.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(A.code===3&&ee)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",A)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=A=>{if(this._map){if(this._container.addEventListener("contextmenu",E=>E.preventDefault()),this._geolocateButton=W.create("button","maplibregl-ctrl-geolocate",this._container),W.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",A===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{const E=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new D({element:this._dotElement}),this._circleElement=W.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new D({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",E=>{E.geolocateSource||this._watchState!=="ACTIVE_LOCK"||E.originalEvent&&E.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},z,Z)}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(A,E=!1){cs===void 0||E?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(F=>{cs=F.state!=="denied",A(cs)}).catch(()=>{cs=!!window.navigator.geolocation,A(cs)}):(cs=!!window.navigator.geolocation,A(cs)):A(cs)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),W.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,R=0,ee=!1}_isOutOfMapMaxBounds(Z){const A=this._map.getMaxBounds(),E=Z.coords;return A&&(E.longitude<A.getWest()||E.longitude>A.getEast()||E.latitude<A.getSouth()||E.latitude>A.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const Z=this._map.getBounds(),A=Z.getSouthEast(),E=Z.getNorthEast(),F=A.distanceTo(E),O=Math.ceil(this._accuracy/(F/this._map._container.clientHeight)*2);this._circleElement.style.width=`${O}px`,this._circleElement.style.height=`${O}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":R--,ee=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let Z;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),R++,R>1?(Z={maximumAge:6e5,timeout:0},ee=!0):(Z=this.options.positionOptions,ee=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Z)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},jt.AttributionControl=ds,jt.LogoControl=gn,jt.ScaleControl=class{constructor(Z){this._onMove=()=>{oe(this._map,this._container,this.options)},this.setUnit=A=>{this.options.unit=A,oe(this._map,this._container,this.options)},this.options=a.e({},le,Z)}getDefaultPosition(){return"bottom-left"}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-scale",Z.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){W.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},jt.FullscreenControl=class extends a.E{constructor(Z={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,Z&&Z.container&&(Z.container instanceof HTMLElement?this._container=Z.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(Z){return this._map=Z,this._container||(this._container=this._map.getContainer()),this._controlContainer=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){W.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const Z=this._fullscreenButton=W.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);W.create("span","maplibregl-ctrl-icon",Z).setAttribute("aria-hidden","true"),Z.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const Z=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Z),this._fullscreenButton.title=Z}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},jt.TerrainControl=class{constructor(Z){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=Z}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=W.create("button","maplibregl-ctrl-terrain",this._container),W.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){W.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},jt.Popup=class extends a.E{constructor(Z){super(),this.remove=()=>(this._content&&W.remove(this._content),this._container&&(W.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=A=>{this._update(A.point)},this._onMouseMove=A=>{this._update(A.point)},this._onDrag=A=>{this._update(A.point)},this._update=A=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=W.create("div","maplibregl-popup",this._map.getContainer()),this._tip=W.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const s of this.options.className.split(" "))this._container.classList.add(s);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=hl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!A)return;const E=this._pos=this._trackPointer&&A?A:this._map.project(this._lngLat);let F=this.options.anchor;const O=Ct(this.options.offset);if(!F){const s=this._container.offsetWidth,i=this._container.offsetHeight;let r;r=E.y+O.bottom.y<i?["top"]:E.y>this._map.transform.height-i?["bottom"]:[],E.x<s/2?r.push("left"):E.x>this._map.transform.width-s/2&&r.push("right"),F=r.length===0?"bottom":r.join("-")}const y=E.add(O[F]).round();W.setTransform(this._container,`${Ms[F]} translate(${y.x}px,${y.y}px)`),C(this._container,F,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(We),Z)}addTo(Z){return this._map&&this.remove(),this._map=Z,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(Z){return this._lngLat=a.L.convert(Z),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(Z){return this.setDOMContent(document.createTextNode(Z))}setHTML(Z){const A=document.createDocumentFragment(),E=document.createElement("body");let F;for(E.innerHTML=Z;F=E.firstChild,F;)A.appendChild(F);return this.setDOMContent(A)}getMaxWidth(){var Z;return(Z=this._container)===null||Z===void 0?void 0:Z.style.maxWidth}setMaxWidth(Z){return this.options.maxWidth=Z,this._update(),this}setDOMContent(Z){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=W.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(Z),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(Z){this._container&&this._container.classList.add(Z)}removeClassName(Z){this._container&&this._container.classList.remove(Z)}setOffset(Z){return this.options.offset=Z,this._update(),this}toggleClassName(Z){if(this._container)return this._container.classList.toggle(Z)}_createCloseButton(){this.options.closeButton&&(this._closeButton=W.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const Z=this._container.querySelector(vt);Z&&Z.focus()}},jt.Marker=D,jt.Style=cr,jt.LngLat=a.L,jt.LngLatBounds=Oi,jt.Point=a.P,jt.MercatorCoordinate=a.U,jt.Evented=a.E,jt.AJAXError=a.bi,jt.config=a.c,jt.CanvasSource=ai,jt.GeoJSONSource=yn,jt.ImageSource=gi,jt.RasterDEMTileSource=nn,jt.RasterTileSource=Ni,jt.VectorTileSource=qi,jt.VideoSource=Ri,jt.setRTLTextPlugin=a.bj,jt.getRTLTextPluginStatus=a.bk,jt.prewarm=function(){V().acquire(Qn)},jt.clearPrewarmedResources=function(){const Z=k;Z&&(Z.isPreloaded()&&Z.numActive()===1?(Z.release(Qn),k=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},ni.extend(jt,{isSafari:a.ac,getPerformanceMetrics:a.bg.getPerformanceMetrics}),jt});var I=g;return I})})(vO);var Rg=Uint8Array,r5=Uint16Array,xO=Int32Array,bO=new Rg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),wO=new Rg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s5=function(e,t){for(var n=new r5(31),c=0;c<31;++c)n[c]=t+=1<<e[c-1];for(var g=new xO(n[30]),c=1;c<30;++c)for(var b=n[c];b<n[c+1];++b)g[b]=b-n[c]<<5|c;return{b:n,r:g}},a5=s5(bO,2),SO=a5.b,IO=a5.r;SO[28]=258,IO[258]=28;s5(wO,0);var EO=new r5(32768);for(Ka=0;Ka<32768;++Ka)Xf=(Ka&43690)>>1|(Ka&21845)<<1,Xf=(Xf&52428)>>2|(Xf&13107)<<2,Xf=(Xf&61680)>>4|(Xf&3855)<<4,EO[Ka]=((Xf&65280)>>8|(Xf&255)<<8)>>1;var Xf,Ka,h1=new Rg(288);for(Ka=0;Ka<144;++Ka)h1[Ka]=8;var Ka;for(Ka=144;Ka<256;++Ka)h1[Ka]=9;var Ka;for(Ka=256;Ka<280;++Ka)h1[Ka]=7;var Ka;for(Ka=280;Ka<288;++Ka)h1[Ka]=8;var Ka,CO=new Rg(32);for(Ka=0;Ka<32;++Ka)CO[Ka]=5;var Ka,TO=new Rg(0),kO=typeof TextDecoder<"u"&&new TextDecoder,MO=0;try{kO.decode(TO,{stream:!0}),MO=1}catch{}var S2={exports:{}},PO=LO,DO={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function LO(e){if(!e||!e.type)return null;var t=DO[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}function h_(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,n){return t.concat(h_(n))},[]),e;case"Feature":return e.geometry?h_(e.geometry).map(function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return e.id!==void 0&&(n.id=e.id),n}):[e];case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries.map(h_).reduce(function(t,n){return t.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[e]}}const BO=Object.freeze(Object.defineProperty({__proto__:null,default:h_},Symbol.toStringTag,{value:"Module"})),zO=Bv(BO);var RO=function(t){return n(t);function n(c){return Array.isArray(c)&&c.length&&typeof c[0]=="number"?[c]:c.reduce(function(g,b){return Array.isArray(b)&&Array.isArray(b[0])?g.concat(n(b)):(g.push(b),g)},[])}},FO=PO,A_=zO,OO=RO;A_ instanceof Function||(A_=A_.default);var NO=function(e){if(!e)return[];var t=A_(FO(e)),n=[];return t.features.forEach(function(c){c.geometry&&(n=n.concat(OO(c.geometry.coordinates)))}),n};function Sm(e){return Object.prototype.toString.call(e)}function VO(e){return Sm(e)==="[object Date]"}function UO(e){return Sm(e)==="[object RegExp]"}function GO(e){return Sm(e)==="[object Error]"}function qO(e){return Sm(e)==="[object Boolean]"}function HO(e){return Sm(e)==="[object Number]"}function jO(e){return Sm(e)==="[object String]"}var o5=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function A1(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)}var ZO=Object.keys||function(t){var n=[];for(var c in t)n.push(c);return n},QO=Object.prototype.propertyIsEnumerable,ww=Object.getOwnPropertySymbols;function f1(e){var t=ZO(e);if(ww)for(var n=ww(e),c=0;c<n.length;c++)QO.call(e,n[c])&&t.push(n[c]);return t}var d1=Object.prototype.hasOwnProperty||function(e,t){return t in e};function l5(e){if(typeof e=="object"&&e!==null){var t;if(o5(e))t=[];else if(VO(e))t=new Date(e.getTime?e.getTime():e);else if(UO(e))t=new RegExp(e);else if(GO(e))t={message:e.message};else if(qO(e)||HO(e)||jO(e))t=Object(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},c=function(){};c.prototype=n,t=new c}return A1(f1(e),function(g){t[g]=e[g]}),t}return e}function u5(e,t,n){var c=[],g=[],b=!0;return function I(a){var G=n?l5(a):a,W={},he=!0,ae={node:G,node_:a,path:[].concat(c),parent:g[g.length-1],parents:g,key:c[c.length-1],isRoot:c.length===0,level:c.length,circular:null,update:function(Ke,ot){ae.isRoot||(ae.parent.node[ae.key]=Ke),ae.node=Ke,ot&&(he=!1)},delete:function(Ke){delete ae.parent.node[ae.key],Ke&&(he=!1)},remove:function(Ke){o5(ae.parent.node)?ae.parent.node.splice(ae.key,1):delete ae.parent.node[ae.key],Ke&&(he=!1)},keys:null,before:function(Ke){W.before=Ke},after:function(Ke){W.after=Ke},pre:function(Ke){W.pre=Ke},post:function(Ke){W.post=Ke},stop:function(){b=!1},block:function(){he=!1}};if(!b)return ae;function ue(){if(typeof ae.node=="object"&&ae.node!==null){(!ae.keys||ae.node_!==ae.node)&&(ae.keys=f1(ae.node)),ae.isLeaf=ae.keys.length===0;for(var Ke=0;Ke<g.length;Ke++)if(g[Ke].node_===a){ae.circular=g[Ke];break}}else ae.isLeaf=!0,ae.keys=null;ae.notLeaf=!ae.isLeaf,ae.notRoot=!ae.isRoot}ue();var be=t.call(ae,ae.node);return be!==void 0&&ae.update&&ae.update(be),W.before&&W.before.call(ae,ae.node),he&&(typeof ae.node=="object"&&ae.node!==null&&!ae.circular&&(g.push(ae),ue(),A1(ae.keys,function(Ke,ot){c.push(Ke),W.pre&&W.pre.call(ae,ae.node[Ke],Ke);var tt=I(ae.node[Ke]);n&&d1.call(ae.node,Ke)&&(ae.node[Ke]=tt.node),tt.isLast=ot===ae.keys.length-1,tt.isFirst=ot===0,W.post&&W.post.call(ae,tt),c.pop()}),g.pop()),W.after&&W.after.call(ae,ae.node)),ae}(e).node}function Oh(e){this.value=e}Oh.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!d1.call(t,c))return;t=t[c]}return t};Oh.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!d1.call(t,c))return!1;t=t[c]}return!0};Oh.prototype.set=function(e,t){for(var n=this.value,c=0;c<e.length-1;c++){var g=e[c];d1.call(n,g)||(n[g]={}),n=n[g]}return n[e[c]]=t,t};Oh.prototype.map=function(e){return u5(this.value,e,!0)};Oh.prototype.forEach=function(e){return this.value=u5(this.value,e,!1),this.value};Oh.prototype.reduce=function(e,t){var n=arguments.length===1,c=n?this.value:t;return this.forEach(function(g){(!this.isRoot||!n)&&(c=e.call(this,c,g))}),c};Oh.prototype.paths=function(){var e=[];return this.forEach(function(){e.push(this.path)}),e};Oh.prototype.nodes=function(){var e=[];return this.forEach(function(){e.push(this.node)}),e};Oh.prototype.clone=function(){var e=[],t=[];return function n(c){for(var g=0;g<e.length;g++)if(e[g]===c)return t[g];if(typeof c=="object"&&c!==null){var b=l5(c);return e.push(c),t.push(b),A1(f1(c),function(I){b[I]=n(c[I])}),e.pop(),t.pop(),b}return c}(this.value)};function c5(e){return new Oh(e)}A1(f1(Oh.prototype),function(e){c5[e]=function(t){var n=[].slice.call(arguments,1),c=new Oh(t);return c[e].apply(c,n)}});var WO=c5,XO=_c;function _c(e){if(!(this instanceof _c))return new _c(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}_c.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};_c.prototype.equals=function(e){var t;return e instanceof _c?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};_c.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};_c.prototype.union=function(e){this._valid=!0;var t;return e instanceof _c?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};_c.prototype.bbox=function(){return this._valid?this._bbox:null};_c.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],n=e[1];return this._bbox[0]<=t&&this._bbox[1]<=n&&this._bbox[2]>=t&&this._bbox[3]>=n};_c.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof _c?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};_c.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};_c.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var YO=NO,$O=WO,KO=XO,h5={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},JO=Object.keys(h5);S2.exports=function(e){return I2(e).bbox()};S2.exports.polygon=function(e){return I2(e).polygon()};S2.exports.bboxify=function(e){return $O(e).map(function(t){if(t){var n=JO.some(function(c){return t[c]?h5[c].indexOf(t.type)!==-1:!1});n&&(t.bbox=I2(t).bbox(),this.update(t))}})};function I2(e){for(var t=KO(),n=YO(e),c=0;c<n.length;c++)t.include(n[c]);return t}var Mn=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function b(De){return t.locateFile?t.locateFile(De,g):g+De}var I;document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",I=function(Ue,ht,kt){var o=new XMLHttpRequest;o.open("GET",Ue,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ht(o.response);return}var oi=ft(Ue);if(oi){ht(oi.buffer);return}kt()},o.onerror=kt,o.send(null)};var a=t.print||console.log.bind(console),G=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,he=function(De){W=De},ae=function(){return W},ue=8;function be(De,Ue,ht,kt){switch(ht=ht||"i8",ht.charAt(ht.length-1)==="*"&&(ht="i32"),ht){case"i1":bt[De>>0]=Ue;break;case"i8":bt[De>>0]=Ue;break;case"i16":$e[De>>1]=Ue;break;case"i32":mt[De>>2]=Ue;break;case"i64":In=[Ue>>>0,(Qn=Ue,+Ki(Qn)>=1?Qn>0?(pn(+fi(Qn/4294967296),4294967295)|0)>>>0:~~+Ji((Qn-+(~~Qn>>>0))/4294967296)>>>0:0)],mt[De>>2]=In[0],mt[De+4>>2]=In[1];break;case"float":st[De>>2]=Ue;break;case"double":Nt[De>>3]=Ue;break;default:Ye("invalid type for setValue: "+ht)}}function Ke(De,Ue,ht){switch(Ue=Ue||"i8",Ue.charAt(Ue.length-1)==="*"&&(Ue="i32"),Ue){case"i1":return bt[De>>0];case"i8":return bt[De>>0];case"i16":return $e[De>>1];case"i32":return mt[De>>2];case"i64":return mt[De>>2];case"float":return st[De>>2];case"double":return Nt[De>>3];default:Ye("invalid type for getValue: "+Ue)}return null}var ot=!1;function tt(De,Ue){De||Ye("Assertion failed: "+Ue)}function lt(De){var Ue=t["_"+De];return tt(Ue,"Cannot call unknown function "+De+", make sure it is exported"),Ue}function ut(De,Ue,ht,kt,o){var ke={string:function(wi){var $t=0;if(wi!=null&&wi!==0){var vn=(wi.length<<2)+1;$t=X(vn),rt(wi,$t,vn)}return $t},array:function(wi){var $t=X(wi.length);return yt(wi,$t),$t}};function oi(wi){return Ue==="string"?Ge(wi):Ue==="boolean"?!!wi:wi}var di=lt(De),Ai=[],Jt=0;if(kt)for(var li=0;li<kt.length;li++){var zi=ke[ht[li]];zi?(Jt===0&&(Jt=de()),Ai[li]=zi(kt[li])):Ai[li]=kt[li]}var vi=di.apply(null,Ai);return vi=oi(vi),Jt!==0&&ie(Jt),vi}function Tt(De,Ue,ht,kt){ht=ht||[];var o=ht.every(function(oi){return oi==="number"}),ke=Ue!=="string";return ke&&o&&!kt?lt(De):function(){return ut(De,Ue,ht,arguments)}}var Pt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function zt(De,Ue,ht){for(var kt=Ue+ht,o=Ue;De[o]&&!(o>=kt);)++o;if(o-Ue>16&&De.subarray&&Pt)return Pt.decode(De.subarray(Ue,o));for(var ke="";Ue<o;){var oi=De[Ue++];if(!(oi&128)){ke+=String.fromCharCode(oi);continue}var di=De[Ue++]&63;if((oi&224)==192){ke+=String.fromCharCode((oi&31)<<6|di);continue}var Ai=De[Ue++]&63;if((oi&240)==224?oi=(oi&15)<<12|di<<6|Ai:oi=(oi&7)<<18|di<<12|Ai<<6|De[Ue++]&63,oi<65536)ke+=String.fromCharCode(oi);else{var Jt=oi-65536;ke+=String.fromCharCode(55296|Jt>>10,56320|Jt&1023)}}return ke}function Ge(De,Ue){return De?zt(dt,De,Ue):""}function Xt(De,Ue,ht,kt){if(!(kt>0))return 0;for(var o=ht,ke=ht+kt-1,oi=0;oi<De.length;++oi){var di=De.charCodeAt(oi);if(di>=55296&&di<=57343){var Ai=De.charCodeAt(++oi);di=65536+((di&1023)<<10)|Ai&1023}if(di<=127){if(ht>=ke)break;Ue[ht++]=di}else if(di<=2047){if(ht+1>=ke)break;Ue[ht++]=192|di>>6,Ue[ht++]=128|di&63}else if(di<=65535){if(ht+2>=ke)break;Ue[ht++]=224|di>>12,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}else{if(ht+3>=ke)break;Ue[ht++]=240|di>>18,Ue[ht++]=128|di>>12&63,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}}return Ue[ht]=0,ht-o}function rt(De,Ue,ht){return Xt(De,dt,Ue,ht)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function yt(De,Ue){bt.set(De,Ue)}function pt(De,Ue){return De%Ue>0&&(De+=Ue-De%Ue),De}var gt,bt,dt,$e,mt,st,Nt;function Rt(De){gt=De,t.HEAP8=bt=new Int8Array(De),t.HEAP16=$e=new Int16Array(De),t.HEAP32=mt=new Int32Array(De),t.HEAPU8=dt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=st=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Ot=5266928,_i=24016,Si=t.TOTAL_MEMORY||33554432;t.buffer?gt=t.buffer:gt=new ArrayBuffer(Si),Si=gt.byteLength,Rt(gt),mt[_i>>2]=Ot;function Ti(De){for(;De.length>0;){var Ue=De.shift();if(typeof Ue=="function"){Ue();continue}var ht=Ue.func;typeof ht=="number"?Ue.arg===void 0?t.dynCall_v(ht):t.dynCall_vi(ht,Ue.arg):ht(Ue.arg===void 0?null:Ue.arg)}}var Oi=[],tn=[],qi=[],Ni=[];function nn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ri(t.preRun.shift());Ti(Oi)}function yn(){Ti(tn)}function Ci(){Ti(qi)}function gi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)ai(t.postRun.shift());Ti(Ni)}function Ri(De){Oi.unshift(De)}function ai(De){Ni.unshift(De)}var Ki=Math.abs,Ji=Math.ceil,fi=Math.floor,pn=Math.min,ii=0,wn=null;function Rr(De){ii++,t.monitorRunDependencies&&t.monitorRunDependencies(ii)}function hi(De){if(ii--,t.monitorRunDependencies&&t.monitorRunDependencies(ii),ii==0&&wn){var Ue=wn;wn=null,Ue()}}t.preloadedImages={},t.preloadedAudios={};var en=null,tr="data:application/octet-stream;base64,";function Fn(De){return String.prototype.startsWith?De.startsWith(tr):De.indexOf(tr)===0}var Qn,In;en="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var v=24032;function k(De){return De}function V(De){var Ue=/\b__Z[\w\d_]+/g;return De.replace(Ue,function(ht){var kt=ht;return ht===kt?ht:kt+" ["+ht+"]"})}function $(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ue){De=Ue}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=$();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function fe(De,Ue,ht,kt){Ye("Assertion failed: "+Ge(De)+", at: "+[Ue?Ge(Ue):"unknown filename",ht,kt?Ge(kt):"unknown function"])}function ve(){return bt.length}function Ie(De,Ue,ht){dt.set(dt.subarray(Ue,Ue+ht),De)}function Ee(De){return t.___errno_location&&(mt[t.___errno_location()>>2]=De),De}function ze(De){Ye("OOM")}function Qe(De){try{var Ue=new ArrayBuffer(De);return Ue.byteLength!=De?void 0:(new Int8Array(Ue).set(bt),ne(Ue),Rt(Ue),1)}catch{}}function He(De){var Ue=ve(),ht=16777216,kt=2147483648-ht;if(De>kt)return!1;for(var o=16777216,ke=Math.max(Ue,o);ke<De;)ke<=536870912?ke=pt(2*ke,ht):ke=Math.min(pt((3*ke+2147483648)/4,ht),kt);var oi=Qe(ke);return!!oi}var Ze=typeof atob=="function"?atob:function(De){var Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ht="",kt,o,ke,oi,di,Ai,Jt,li=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do oi=Ue.indexOf(De.charAt(li++)),di=Ue.indexOf(De.charAt(li++)),Ai=Ue.indexOf(De.charAt(li++)),Jt=Ue.indexOf(De.charAt(li++)),kt=oi<<2|di>>4,o=(di&15)<<4|Ai>>2,ke=(Ai&3)<<6|Jt,ht=ht+String.fromCharCode(kt),Ai!==64&&(ht=ht+String.fromCharCode(o)),Jt!==64&&(ht=ht+String.fromCharCode(ke));while(li<De.length);return ht};function Ve(De){try{for(var Ue=Ze(De),ht=new Uint8Array(Ue.length),kt=0;kt<Ue.length;++kt)ht[kt]=Ue.charCodeAt(kt);return ht}catch{throw new Error("Converting base64 string to bytes failed.")}}function ft(De){if(Fn(De))return Ve(De.slice(tr.length))}var nt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ye,b:he,c:ae,d:fe,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:Qe,m:$,n:te,o:v,p:_i},se=function(De,Ue,ht){"almost asm";var kt=new De.Int8Array(ht),o=new De.Int32Array(ht);new De.Uint8Array(ht),new De.Float32Array(ht);var ke=new De.Float64Array(ht),oi=Ue.p|0,di=De.Math.floor,Ai=De.Math.abs,Jt=De.Math.sqrt,li=De.Math.pow,zi=De.Math.cos,vi=De.Math.sin,wi=De.Math.tan,$t=De.Math.acos,vn=De.Math.asin,or=De.Math.atan,mn=De.Math.atan2,qn=De.Math.ceil,jr=De.Math.imul,Hi=De.Math.min,ur=De.Math.clz32,On=Ue.b,Qt=Ue.c,Yi=Ue.d,Ut=Ue.e,Tn=Ue.f,cr=Ue.g,Ns=Ue.h,Ur=Ue.i,Vt=24048;function hr(C){return kt=new Int8Array(C),o=new Int32Array(C),ke=new Float64Array(C),ht=C,!0}function Lt(C){C=C|0;var D=0;return D=Vt,Vt=Vt+C|0,Vt=Vt+15&-16,D|0}function Fr(){return Vt|0}function Vs(C){C=C|0,Vt=C}function ua(C,D){C=C|0,Vt=C}function Pr(C){return C=C|0,(jr(C*3|0,C+1|0)|0)+1|0}function Fa(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;Oa(C,D,z,R,0)|0&&(le=(jr(z*3|0,z+1|0)|0)+1|0,cs(R|0,0,le<<3|0)|0,ee=tl(le,4)|0,ee&&(Ys(C,D,z,R,ee,le,0),Jn(ee)))}function zo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0;if(Oa(C,D,z,R,ee)|0){if(le=(jr(z*3|0,z+1|0)|0)+1|0,cs(R|0,0,le<<3|0)|0,ee|0){cs(ee|0,0,le<<2|0)|0,Ys(C,D,z,R,ee,le,0);return}ee=tl(le,4)|0,ee&&(Ys(C,D,z,R,ee,le,0),Jn(ee))}}function Oa(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0;if(jt=Vt,Vt=Vt+16|0,Gt=jt,le=R,o[le>>2]=C,o[le+4>>2]=D,le=(ee|0)!=0,le&&(o[ee>>2]=0),hs(C,D)|0)return Gt=1,Vt=jt,Gt|0;o[Gt>>2]=0;e:do if((z|0)>=1)if(le)for(vt=0,Ct=1,ni=1,oe=0,le=C;;){if(!(oe|vt)){if(le=Zn(le,D,4,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(hs(le,D)|0){le=1;break e}}if(le=Zn(le,D,o[16+(vt<<2)>>2]|0,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ni<<3)|0,o[C>>2]=le,o[C+4>>2]=D,o[ee+(ni<<2)>>2]=Ct,oe=oe+1|0,C=(oe|0)==(Ct|0),we=vt+1|0,We=(we|0)==6,hs(le,D)|0){le=1;break e}if(Ct=Ct+(We&C&1)|0,(Ct|0)>(z|0)){le=0;break}else vt=C?We?0:we:vt,ni=ni+1|0,oe=C?0:oe}else for(vt=0,Ct=1,ni=1,oe=0,le=C;;){if(!(oe|vt)){if(le=Zn(le,D,4,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(hs(le,D)|0){le=1;break e}}if(le=Zn(le,D,o[16+(vt<<2)>>2]|0,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ni<<3)|0,o[C>>2]=le,o[C+4>>2]=D,oe=oe+1|0,C=(oe|0)==(Ct|0),we=vt+1|0,We=(we|0)==6,hs(le,D)|0){le=1;break e}if(Ct=Ct+(We&C&1)|0,(Ct|0)>(z|0)){le=0;break}else vt=C?We?0:we:vt,ni=ni+1|0,oe=C?0:oe}else le=0;while(!1);return Gt=le,Vt=jt,Gt|0}function Ys(C,D,z,R,ee,le,oe){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0,oe=oe|0;var we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0;if(ni=Vt,Vt=Vt+16|0,Ct=ni,(C|0)==0&(D|0)==0){Vt=ni;return}if(we=ko(C|0,D|0,le|0,((le|0)<0)<<31>>31|0)|0,Qt()|0,We=R+(we<<3)|0,Gt=We,jt=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,vt=(jt|0)==(C|0)&(Gt|0)==(D|0),!((jt|0)==0&(Gt|0)==0|vt))do we=(we+1|0)%(le|0)|0,We=R+(we<<3)|0,jt=We,Gt=o[jt>>2]|0,jt=o[jt+4>>2]|0,vt=(Gt|0)==(C|0)&(jt|0)==(D|0);while(!((Gt|0)==0&(jt|0)==0|vt));if(we=ee+(we<<2)|0,vt&&(o[we>>2]|0)<=(oe|0)){Vt=ni;return}if(jt=We,o[jt>>2]=C,o[jt+4>>2]=D,o[we>>2]=oe,(oe|0)>=(z|0)){Vt=ni;return}jt=oe+1|0,o[Ct>>2]=0,Gt=Zn(C,D,2,Ct)|0,Ys(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=Zn(C,D,3,Ct)|0,Ys(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=Zn(C,D,1,Ct)|0,Ys(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=Zn(C,D,5,Ct)|0,Ys(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=Zn(C,D,4,Ct)|0,Ys(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=Zn(C,D,6,Ct)|0,Ys(Gt,Qt()|0,z,R,ee,le,jt),Vt=ni}function Zn(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0;if((o[R>>2]|0)>0){ee=0;do z=ca(z)|0,ee=ee+1|0;while((ee|0)<(o[R>>2]|0))}we=ki(C|0,D|0,45)|0,Qt()|0,We=we&127,le=Js(C,D)|0,ee=ki(C|0,D|0,52)|0,Qt()|0,ee=ee&15;e:do if(!ee)oe=6;else for(;;){if(ni=(15-ee|0)*3|0,Gt=ki(C|0,D|0,ni|0)|0,Qt()|0,Gt=Gt&7,jt=(Nr(ee)|0)==0,ee=ee+-1|0,Ct=Bi(7,0,ni|0)|0,D=D&~(Qt()|0),ni=Bi(o[(jt?464:48)+(Gt*28|0)+(z<<2)>>2]|0,0,ni|0)|0,vt=Qt()|0,z=o[(jt?672:256)+(Gt*28|0)+(z<<2)>>2]|0,C=ni|C&~Ct,D=vt|D,!z){z=0;break e}if(!ee){oe=6;break}}while(!1);(oe|0)==6&&(jt=o[880+(We*28|0)+(z<<2)>>2]|0,Gt=Bi(jt|0,0,45)|0,C=Gt|C,D=Qt()|0|D&-1040385,z=o[4304+(We*28|0)+(z<<2)>>2]|0,(jt&127|0)==127&&(jt=Bi(o[880+(We*28|0)+20>>2]|0,0,45)|0,D=Qt()|0|D&-1040385,z=o[4304+(We*28|0)+20>>2]|0,C=Qa(jt|C,D)|0,D=Qt()|0,o[R>>2]=(o[R>>2]|0)+1)),oe=ki(C|0,D|0,45)|0,Qt()|0,oe=oe&127;e:do if(N(oe)|0){t:do if((Js(C,D)|0)==1){if((We|0)!=(oe|0))if(Li(oe,o[7728+(We*28|0)>>2]|0)|0){C=$r(C,D)|0,le=1,D=Qt()|0;break}else{C=Qa(C,D)|0,le=1,D=Qt()|0;break}switch(le|0){case 5:{C=$r(C,D)|0,D=Qt()|0,o[R>>2]=(o[R>>2]|0)+5,le=0;break t}case 3:{C=Qa(C,D)|0,D=Qt()|0,o[R>>2]=(o[R>>2]|0)+1,le=0;break t}default:return Gt=0,jt=0,On(Gt|0),jt|0}}else le=0;while(!1);if((z|0)>0){ee=0;do C=Gs(C,D)|0,D=Qt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}if((We|0)!=(oe|0)){if(!(xe(oe)|0)){if((le|0)!=0|(Js(C,D)|0)!=5)break;o[R>>2]=(o[R>>2]|0)+1;break}switch(we&127){case 8:case 118:break e}(Js(C,D)|0)!=3&&(o[R>>2]=(o[R>>2]|0)+1)}}else if((z|0)>0){ee=0;do C=Qa(C,D)|0,D=Qt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}while(!1);return o[R>>2]=((o[R>>2]|0)+z|0)%6|0,Gt=D,jt=C,On(Gt|0),jt|0}function aa(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0;if(ni=Vt,Vt=Vt+16|0,Ct=ni,!z)return Ct=R,o[Ct>>2]=C,o[Ct+4>>2]=D,Ct=0,Vt=ni,Ct|0;o[Ct>>2]=0;e:do if(hs(C,D)|0)C=1;else{if(le=(z|0)>0,le){ee=0,vt=C;do{if(vt=Zn(vt,D,4,Ct)|0,D=Qt()|0,(vt|0)==0&(D|0)==0){C=2;break e}if(ee=ee+1|0,hs(vt,D)|0){C=1;break e}}while((ee|0)<(z|0));if(We=R,o[We>>2]=vt,o[We+4>>2]=D,We=z+-1|0,le){le=0,oe=1,ee=vt,C=D;do{if(ee=Zn(ee,C,2,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(oe<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,oe=oe+1|0,hs(ee,C)|0){C=1;break e}le=le+1|0}while((le|0)<(z|0));we=0,le=oe;do{if(ee=Zn(ee,C,3,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(oe=R+(le<<3)|0,o[oe>>2]=ee,o[oe+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}we=we+1|0}while((we|0)<(z|0));oe=0;do{if(ee=Zn(ee,C,1,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));oe=0;do{if(ee=Zn(ee,C,5,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));oe=0;do{if(ee=Zn(ee,C,4,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}oe=oe+1|0}while((oe|0)<(z|0));for(oe=0;;){if(ee=Zn(ee,C,6,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if((oe|0)!=(We|0))if(we=R+(le<<3)|0,o[we>>2]=ee,o[we+4>>2]=C,!(hs(ee,C)|0))le=le+1|0;else{C=1;break e}if(oe=oe+1|0,(oe|0)>=(z|0)){oe=vt,le=D;break}}}else oe=vt,ee=vt,le=D,C=D}else oe=R,o[oe>>2]=C,o[oe+4>>2]=D,oe=C,ee=C,le=D,C=D;C=((oe|0)!=(ee|0)|(le|0)!=(C|0))&1}while(!1);return Ct=C,Vt=ni,Ct|0}function ls(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;if(le=Vt,Vt=Vt+48|0,ee=le+8|0,R=le,we=C,oe=o[we+4>>2]|0,z=R,o[z>>2]=o[we>>2],o[z+4>>2]=oe,Pn(R,ee),ee=Ga(ee,D)|0,D=o[R>>2]|0,R=o[C+8>>2]|0,(R|0)<=0)return we=D,oe=(ee|0)<(we|0),we=oe?we:ee,we=we+12|0,Vt=le,we|0;z=o[C+12>>2]|0,C=0;do D=(o[z+(C<<3)>>2]|0)+D|0,C=C+1|0;while((C|0)<(R|0));return we=(ee|0)<(D|0),we=we?D:ee,we=we+12|0,Vt=le,we|0}function Na(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0;if(we=Vt,Vt=Vt+48|0,R=we+8|0,ee=we,!(al(C,D,z)|0)){Vt=we;return}if(We=C,le=o[We+4>>2]|0,oe=ee,o[oe>>2]=o[We>>2],o[oe+4>>2]=le,Pn(ee,R),oe=Ga(R,D)|0,D=o[ee>>2]|0,le=o[C+8>>2]|0,(le|0)>0){ee=o[C+12>>2]|0,R=0;do D=(o[ee+(R<<3)>>2]|0)+D|0,R=R+1|0;while((R|0)!=(le|0))}if(D=(oe|0)<(D|0)?D:oe,(D|0)<=-12){Vt=we;return}We=D+11|0,cs(z|0,0,(((We|0)>0?We:0)<<3)+8|0)|0,Vt=we}function al(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0;if(Se=Vt,Vt=Vt+112|0,B=Se+80|0,We=Se+72|0,j=Se,Y=Se+56|0,vt=C+8|0,ce=jn((o[vt>>2]<<5)+32|0)|0,ce||Yi(22848,22448,800,22456),Ma(C,ce),le=C,R=o[le+4>>2]|0,we=We,o[we>>2]=o[le>>2],o[we+4>>2]=R,Pn(We,B),we=Ga(B,D)|0,R=o[We>>2]|0,le=o[vt>>2]|0,(le|0)>0){oe=o[C+12>>2]|0,ee=0;do R=(o[oe+(ee<<3)>>2]|0)+R|0,ee=ee+1|0;while((ee|0)!=(le|0))}if(we=(we|0)<(R|0)?R:we,T=we+12|0,ee=tl(T,8)|0,Ct=tl(T,8)|0,o[B>>2]=0,_=C,w=o[_+4>>2]|0,R=We,o[R>>2]=o[_>>2],o[R+4>>2]=w,R=ol(We,T,D,B,ee,Ct)|0,R|0)return Jn(ee),Jn(Ct),Jn(ce),ce=R,Vt=Se,ce|0;e:do if((o[vt>>2]|0)>0){for(le=C+12|0,R=0;oe=ol((o[le>>2]|0)+(R<<3)|0,T,D,B,ee,Ct)|0,R=R+1|0,!(oe|0);)if((R|0)>=(o[vt>>2]|0))break e;return Jn(ee),Jn(Ct),Jn(ce),ce=oe,Vt=Se,ce|0}while(!1);(we|0)>-12&&cs(Ct|0,0,((T|0)>1?T:1)<<3|0)|0;e:do if((o[B>>2]|0)>0){w=((T|0)<0)<<31>>31,s=ee,i=Ct,r=ee,l=ee,d=Ct,_=ee,R=ee,E=ee,F=Ct,O=Ct,y=Ct,ee=Ct;t:for(;;){for(A=o[B>>2]|0,jt=0,Z=0,le=0;;){oe=j,we=oe+56|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(we|0));if(D=s+(jt<<3)|0,We=o[D>>2]|0,D=o[D+4>>2]|0,Oa(We,D,1,j,0)|0){oe=j,we=oe+56|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(we|0));oe=tl(7,4)|0,oe|0&&(Ys(We,D,1,j,oe,7,0),Jn(oe))}Gt=0;do{ni=j+(Gt<<3)|0,Ct=o[ni>>2]|0,ni=o[ni+4>>2]|0;i:do if(!((Ct|0)==0&(ni|0)==0)){if(We=ko(Ct|0,ni|0,T|0,w|0)|0,Qt()|0,oe=z+(We<<3)|0,we=oe,D=o[we>>2]|0,we=o[we+4>>2]|0,!((D|0)==0&(we|0)==0))for(vt=0;;){if((vt|0)>(T|0))break t;if((D|0)==(Ct|0)&(we|0)==(ni|0))break i;if(We=(We+1|0)%(T|0)|0,oe=z+(We<<3)|0,we=oe,D=o[we>>2]|0,we=o[we+4>>2]|0,(D|0)==0&(we|0)==0)break;vt=vt+1|0}(Ct|0)==0&(ni|0)==0||(Sa(Ct,ni,Y),Sn(C,ce,Y)|0&&(vt=oe,o[vt>>2]=Ct,o[vt+4>>2]=ni,vt=i+(le<<3)|0,o[vt>>2]=Ct,o[vt+4>>2]=ni,le=le+1|0))}while(!1);Gt=Gt+1|0}while(Gt>>>0<7);if(Z=Z+1|0,(Z|0)>=(A|0))break;jt=jt+1|0}if((A|0)>0&&cs(r|0,0,A<<3|0)|0,o[B>>2]=le,(le|0)>0)Ct=ee,ni=y,Gt=_,jt=O,Z=F,A=i,ee=E,y=R,O=l,F=r,E=Ct,R=ni,_=d,d=Gt,l=jt,r=Z,i=s,s=A;else break e}return Jn(l),Jn(d),Jn(ce),ce=-1,Vt=Se,ce|0}else R=Ct;while(!1);return Jn(ce),Jn(ee),Jn(R),ce=0,Vt=Se,ce|0}function ol(C,D,z,R,ee,le){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0;var oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0;if(w=Vt,Vt=Vt+48|0,r=w+32|0,l=w+16|0,d=w,oe=o[C>>2]|0,(oe|0)<=0)return _=0,Vt=w,_|0;F=C+4|0,O=r+8|0,y=l+8|0,s=d+8|0,i=((D|0)<0)<<31>>31,E=0;e:for(;;){we=o[F>>2]|0,Z=we+(E<<4)|0,o[r>>2]=o[Z>>2],o[r+4>>2]=o[Z+4>>2],o[r+8>>2]=o[Z+8>>2],o[r+12>>2]=o[Z+12>>2],(E|0)==(oe+-1|0)?(o[l>>2]=o[we>>2],o[l+4>>2]=o[we+4>>2],o[l+8>>2]=o[we+8>>2],o[l+12>>2]=o[we+12>>2]):(Z=we+(E+1<<4)|0,o[l>>2]=o[Z>>2],o[l+4>>2]=o[Z+4>>2],o[l+8>>2]=o[Z+8>>2],o[l+12>>2]=o[Z+12>>2]),Z=qa(r,l,z)|0;t:do if((Z|0)>0){A=+(Z|0),jt=0;i:for(;;){B=+(Z-jt|0),T=+(jt|0),ke[d>>3]=+ke[r>>3]*B/A+ +ke[l>>3]*T/A,ke[s>>3]=+ke[O>>3]*B/A+ +ke[y>>3]*T/A,ni=ha(d,z)|0,Gt=Qt()|0,we=ko(ni|0,Gt|0,D|0,i|0)|0,Qt()|0,oe=le+(we<<3)|0,We=oe,vt=o[We>>2]|0,We=o[We+4>>2]|0;n:do if((vt|0)==0&(We|0)==0)_=14;else for(Ct=0;;){if((Ct|0)>(D|0)){oe=1;break n}if((vt|0)==(ni|0)&(We|0)==(Gt|0)){oe=7;break n}if(we=(we+1|0)%(D|0)|0,oe=le+(we<<3)|0,We=oe,vt=o[We>>2]|0,We=o[We+4>>2]|0,(vt|0)==0&(We|0)==0){_=14;break}else Ct=Ct+1|0}while(!1);switch((_|0)==14&&(_=0,(ni|0)==0&(Gt|0)==0?oe=7:(o[oe>>2]=ni,o[oe+4>>2]=Gt,oe=o[R>>2]|0,Ct=ee+(oe<<3)|0,o[Ct>>2]=ni,o[Ct+4>>2]=Gt,o[R>>2]=oe+1,oe=0)),oe&7){case 7:case 0:break;default:break i}if(jt=jt+1|0,(Z|0)<=(jt|0)){_=8;break t}}if(oe|0){oe=-1,_=20;break e}}else _=8;while(!1);if((_|0)==8&&(_=0),E=E+1|0,oe=o[C>>2]|0,(E|0)>=(oe|0)){oe=0,_=20;break}}return(_|0)==20?(Vt=w,oe|0):0}function to(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0;if(vt=Vt,Vt=Vt+176|0,We=vt,(D|0)<1){fs(z,0,0),Vt=vt;return}oe=C,oe=ki(o[oe>>2]|0,o[oe+4>>2]|0,52)|0,Qt()|0,fs(z,(D|0)>6?D:6,oe&15),oe=0;do{if(R=C+(oe<<3)|0,ka(o[R>>2]|0,o[R+4>>2]|0,We),R=o[We>>2]|0,(R|0)>0){we=0;do le=We+8+(we<<4)|0,we=we+1|0,R=We+8+(((we|0)%(R|0)|0)<<4)|0,ee=cu(z,R,le)|0,ee?_u(z,ee)|0:Ou(z,le,R)|0,R=o[We>>2]|0;while((we|0)<(R|0))}oe=oe+1|0}while((oe|0)!=(D|0));Vt=vt}function Va(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+32|0,R=le,ee=le+16|0,to(C,D,ee),o[z>>2]=0,o[z+4>>2]=0,o[z+8>>2]=0,C=el(ee)|0,!C){Yn(z)|0,_a(ee),Vt=le;return}do{D=Ln(z)|0;do Hn(D,C)|0,oe=C+16|0,o[R>>2]=o[oe>>2],o[R+4>>2]=o[oe+4>>2],o[R+8>>2]=o[oe+8>>2],o[R+12>>2]=o[oe+12>>2],_u(ee,C)|0,C=Nu(ee,R)|0;while(C|0);C=el(ee)|0}while(C|0);Yn(z)|0,_a(ee),Vt=le}function N(C){return C=C|0,o[7728+(C*28|0)+16>>2]|0}function xe(C){return C=C|0,(C|0)==4|(C|0)==117|0}function it(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)>>2]|0}function It(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)+4>>2]|0}function Wt(C,D){C=C|0,D=D|0,C=7728+(C*28|0)|0,o[D>>2]=o[C>>2],o[D+4>>2]=o[C+4>>2],o[D+8>>2]=o[C+8>>2],o[D+12>>2]=o[C+12>>2]}function Ii(C,D){C=C|0,D=D|0;var z=0,R=0;if(D>>>0>20)return D=-1,D|0;do if((o[11152+(D*216|0)>>2]|0)!=(C|0))if((o[11152+(D*216|0)+8>>2]|0)!=(C|0))if((o[11152+(D*216|0)+16>>2]|0)!=(C|0))if((o[11152+(D*216|0)+24>>2]|0)!=(C|0))if((o[11152+(D*216|0)+32>>2]|0)!=(C|0))if((o[11152+(D*216|0)+40>>2]|0)!=(C|0))if((o[11152+(D*216|0)+48>>2]|0)!=(C|0))if((o[11152+(D*216|0)+56>>2]|0)!=(C|0))if((o[11152+(D*216|0)+64>>2]|0)!=(C|0))if((o[11152+(D*216|0)+72>>2]|0)!=(C|0))if((o[11152+(D*216|0)+80>>2]|0)!=(C|0))if((o[11152+(D*216|0)+88>>2]|0)!=(C|0))if((o[11152+(D*216|0)+96>>2]|0)!=(C|0))if((o[11152+(D*216|0)+104>>2]|0)!=(C|0))if((o[11152+(D*216|0)+112>>2]|0)!=(C|0))if((o[11152+(D*216|0)+120>>2]|0)!=(C|0))if((o[11152+(D*216|0)+128>>2]|0)!=(C|0))if((o[11152+(D*216|0)+136>>2]|0)==(C|0))C=2,z=1,R=2;else{if((o[11152+(D*216|0)+144>>2]|0)==(C|0)){C=0,z=2,R=0;break}if((o[11152+(D*216|0)+152>>2]|0)==(C|0)){C=0,z=2,R=1;break}if((o[11152+(D*216|0)+160>>2]|0)==(C|0)){C=0,z=2,R=2;break}if((o[11152+(D*216|0)+168>>2]|0)==(C|0)){C=1,z=2,R=0;break}if((o[11152+(D*216|0)+176>>2]|0)==(C|0)){C=1,z=2,R=1;break}if((o[11152+(D*216|0)+184>>2]|0)==(C|0)){C=1,z=2,R=2;break}if((o[11152+(D*216|0)+192>>2]|0)==(C|0)){C=2,z=2,R=0;break}if((o[11152+(D*216|0)+200>>2]|0)==(C|0)){C=2,z=2,R=1;break}if((o[11152+(D*216|0)+208>>2]|0)==(C|0)){C=2,z=2,R=2;break}else C=-1;return C|0}else C=2,z=1,R=1;else C=2,z=1,R=0;else C=1,z=1,R=2;else C=1,z=1,R=1;else C=1,z=1,R=0;else C=0,z=1,R=2;else C=0,z=1,R=1;else C=0,z=1,R=0;else C=2,z=0,R=2;else C=2,z=0,R=1;else C=2,z=0,R=0;else C=1,z=0,R=2;else C=1,z=0,R=1;else C=1,z=0,R=0;else C=0,z=0,R=2;else C=0,z=0,R=1;else C=0,z=0,R=0;while(!1);return D=o[11152+(D*216|0)+(z*72|0)+(C*24|0)+(R<<3)+4>>2]|0,D|0}function Li(C,D){return C=C|0,D=D|0,(o[7728+(C*28|0)+20>>2]|0)==(D|0)?(D=1,D|0):(D=(o[7728+(C*28|0)+24>>2]|0)==(D|0),D|0)}function cn(C,D){return C=C|0,D=D|0,o[880+(C*28|0)+(D<<2)>>2]|0}function fn(C,D){return C=C|0,D=D|0,(o[880+(C*28|0)>>2]|0)==(D|0)?(D=0,D|0):(o[880+(C*28|0)+4>>2]|0)==(D|0)?(D=1,D|0):(o[880+(C*28|0)+8>>2]|0)==(D|0)?(D=2,D|0):(o[880+(C*28|0)+12>>2]|0)==(D|0)?(D=3,D|0):(o[880+(C*28|0)+16>>2]|0)==(D|0)?(D=4,D|0):(o[880+(C*28|0)+20>>2]|0)==(D|0)?(D=5,D|0):((o[880+(C*28|0)+24>>2]|0)==(D|0)?6:7)|0}function sr(){return 122}function Ar(C){C=C|0;var D=0,z=0,R=0;D=0;do Bi(D|0,0,45)|0,R=Qt()|0|134225919,z=C+(D<<3)|0,o[z>>2]=-1,o[z+4>>2]=R,D=D+1|0;while((D|0)!=122)}function Or(C){return C=C|0,+ke[C+16>>3]<+ke[C+24>>3]|0}function Ua(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return z=+ke[D>>3],!(z>=+ke[C+8>>3])||!(z<=+ke[C>>3])?(D=0,D|0):(R=+ke[C+16>>3],z=+ke[C+24>>3],ee=+ke[D+8>>3],D=ee>=z,C=ee<=R&1,R<z?D&&(C=1):D||(C=0),D=(C|0)!=0,D|0)}function Ga(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0;oe=Vt,Vt=Vt+288|0,z=oe+264|0,R=oe+96|0,ee=oe,le=ee,we=le+96|0;do o[le>>2]=0,le=le+4|0;while((le|0)<(we|0));return gl(D,ee),le=ee,we=o[le>>2]|0,le=o[le+4>>2]|0,Sa(we,le,z),ka(we,le,R),We=+Cs(z,R+8|0),ke[z>>3]=+ke[C>>3],le=z+8|0,ke[le>>3]=+ke[C+16>>3],ke[R>>3]=+ke[C+8>>3],we=R+8|0,ke[we>>3]=+ke[C+24>>3],vt=+Cs(z,R),we=~~+qn(+(vt*vt/+xs(+ +Ai(+((+ke[le>>3]-+ke[we>>3])/(+ke[z>>3]-+ke[R>>3]))),3)/(We*(We*2.59807621135)*.8))),Vt=oe,(we|0?we:1)|0}function qa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0;we=Vt,Vt=Vt+288|0,R=we+264|0,ee=we+96|0,le=we,oe=le,We=oe+96|0;do o[oe>>2]=0,oe=oe+4|0;while((oe|0)<(We|0));return gl(z,le),We=le,oe=o[We>>2]|0,We=o[We+4>>2]|0,Sa(oe,We,R),ka(oe,We,ee),vt=+Cs(R,ee+8|0),We=~~+qn(+(+Cs(C,D)/(vt*2))),Vt=we,(We|0?We:1)|0}function pl(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0,o[C>>2]=D,o[C+4>>2]=z,o[C+8>>2]=R}function Gr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0;ni=D+8|0,o[ni>>2]=0,We=+ke[C>>3],oe=+Ai(+We),vt=+ke[C+8>>3],we=+Ai(+vt)/.8660254037844386,oe=oe+we*.5,z=~~oe,C=~~we,oe=oe-+(z|0),we=we-+(C|0);do if(oe<.5)if(oe<.3333333333333333)if(o[D>>2]=z,we<(oe+1)*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}else if(Gt=1-oe,C=(!(we<Gt)&1)+C|0,o[D+4>>2]=C,Gt<=we&we<oe*2){z=z+1|0,o[D>>2]=z;break}else{o[D>>2]=z;break}else{if(!(oe<.6666666666666666))if(z=z+1|0,o[D>>2]=z,we<oe*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}if(we<1-oe){if(o[D+4>>2]=C,oe*2+-1<we){o[D>>2]=z;break}}else C=C+1|0,o[D+4>>2]=C;z=z+1|0,o[D>>2]=z}while(!1);do if(We<0)if(C&1){Ct=(C+1|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-((+(Ct>>>0)+4294967296*+(Qt()|0))*2+1)),o[D>>2]=z;break}else{Ct=(C|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-(+(Ct>>>0)+4294967296*+(Qt()|0))*2),o[D>>2]=z;break}while(!1);Ct=D+4|0,vt<0&&(z=z-((C<<1|1|0)/2|0)|0,o[D>>2]=z,C=0-C|0,o[Ct>>2]=C),R=C-z|0,(z|0)<0?(ee=0-z|0,o[Ct>>2]=R,o[ni>>2]=ee,o[D>>2]=0,C=R,z=0):ee=0,(C|0)<0&&(z=z-C|0,o[D>>2]=z,ee=ee-C|0,o[ni>>2]=ee,o[Ct>>2]=0,C=0),le=z-ee|0,R=C-ee|0,(ee|0)<0&&(o[D>>2]=le,o[Ct>>2]=R,o[ni>>2]=0,C=R,z=le,ee=0),R=(C|0)<(z|0)?C:z,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[D>>2]=z-R,o[Ct>>2]=C-R,o[ni>>2]=ee-R)}function nr(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,(D|0)<0&&(z=z-D|0,o[oe>>2]=z,le=C+8|0,o[le>>2]=(o[le>>2]|0)-D,o[C>>2]=0,D=0),(z|0)<0?(D=D-z|0,o[C>>2]=D,le=C+8|0,ee=(o[le>>2]|0)-z|0,o[le>>2]=ee,o[oe>>2]=0,z=0):(ee=C+8|0,le=ee,ee=o[ee>>2]|0),(ee|0)<0&&(D=D-ee|0,o[C>>2]=D,z=z-ee|0,o[oe>>2]=z,o[le>>2]=0,ee=0),R=(z|0)<(D|0)?z:D,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[C>>2]=D-R,o[oe>>2]=z-R,o[le>>2]=ee-R)}function wr(C,D){C=C|0,D=D|0;var z=0,R=0;R=o[C+8>>2]|0,z=+((o[C+4>>2]|0)-R|0),ke[D>>3]=+((o[C>>2]|0)-R|0)-z*.5,ke[D+8>>3]=z*.8660254037844386}function Dr(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[D>>2]|0)+(o[C>>2]|0),o[z+4>>2]=(o[D+4>>2]|0)+(o[C+4>>2]|0),o[z+8>>2]=(o[D+8>>2]|0)+(o[C+8>>2]|0)}function js(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[C>>2]|0)-(o[D>>2]|0),o[z+4>>2]=(o[C+4>>2]|0)-(o[D+4>>2]|0),o[z+8>>2]=(o[C+8>>2]|0)-(o[D+8>>2]|0)}function vr(C,D){C=C|0,D=D|0;var z=0,R=0;z=jr(o[C>>2]|0,D)|0,o[C>>2]=z,z=C+4|0,R=jr(o[z>>2]|0,D)|0,o[z>>2]=R,C=C+8|0,D=jr(o[C>>2]|0,D)|0,o[C>>2]=D}function Ks(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=o[C>>2]|0,we=(oe|0)<0,R=(o[C+4>>2]|0)-(we?oe:0)|0,le=(R|0)<0,ee=(le?0-R|0:0)+((o[C+8>>2]|0)-(we?oe:0))|0,z=(ee|0)<0,C=z?0:ee,D=(le?0:R)-(z?ee:0)|0,ee=(we?0:oe)-(le?R:0)-(z?ee:0)|0,z=(D|0)<(ee|0)?D:ee,z=(C|0)<(z|0)?C:z,R=(z|0)>0,C=C-(R?z:0)|0,D=D-(R?z:0)|0;e:do switch(ee-(R?z:0)|0){case 0:switch(D|0){case 0:return we=C|0?(C|0)==1?1:7:0,we|0;case 1:return we=C|0?(C|0)==1?3:7:2,we|0;default:break e}case 1:switch(D|0){case 0:return we=C|0?(C|0)==1?5:7:4,we|0;case 1:{if(!C)C=6;else break e;return C|0}default:break e}}while(!1);return we=7,we|0}function Lr(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=C+8|0,z=o[oe>>2]|0,D=(o[C>>2]|0)-z|0,we=C+4|0,z=(o[we>>2]|0)-z|0,R=gn(+((D*3|0)-z|0)/7)|0,o[C>>2]=R,D=gn(+((z<<1)+D|0)/7)|0,o[we>>2]=D,o[oe>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[we>>2]=z,o[oe>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[oe>>2]=z,o[we>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[we>>2]=D-R,o[oe>>2]=z-R)}function So(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;oe=C+8|0,z=o[oe>>2]|0,D=(o[C>>2]|0)-z|0,we=C+4|0,z=(o[we>>2]|0)-z|0,R=gn(+((D<<1)+z|0)/7)|0,o[C>>2]=R,D=gn(+((z*3|0)-D|0)/7)|0,o[we>>2]=D,o[oe>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[we>>2]=z,o[oe>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[oe>>2]=z,o[we>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[we>>2]=D-R,o[oe>>2]=z-R)}function Zo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,we=C+8|0,R=o[we>>2]|0,ee=z+(D*3|0)|0,o[C>>2]=ee,z=R+(z*3|0)|0,o[oe>>2]=z,D=(R*3|0)+D|0,o[we>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=R,o[we>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Ls(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=(D*3|0)+ee|0,ee=z+(ee*3|0)|0,o[C>>2]=ee,o[oe>>2]=R,D=(z*3|0)+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=R,o[we>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[oe>>2]=R-z,o[we>>2]=D-z)}function Il(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;(D+-1|0)>>>0>=6||(ee=(o[15472+(D*12|0)>>2]|0)+(o[C>>2]|0)|0,o[C>>2]=ee,we=C+4|0,R=(o[15472+(D*12|0)+4>>2]|0)+(o[we>>2]|0)|0,o[we>>2]=R,oe=C+8|0,D=(o[15472+(D*12|0)+8>>2]|0)+(o[oe>>2]|0)|0,o[oe>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[we>>2]=z,o[oe>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[oe>>2]=D,o[we>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[we>>2]=ee,o[oe>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[we>>2]=ee-z,o[oe>>2]=D-z))}function Ao(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=D+ee|0,ee=z+ee|0,o[C>>2]=ee,o[oe>>2]=R,D=z+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Qo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,R=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,ee=R+D|0,o[C>>2]=ee,R=z+R|0,o[oe>>2]=R,D=z+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function ca(C){switch(C=C|0,C|0){case 1:{C=5;break}case 5:{C=4;break}case 4:{C=6;break}case 6:{C=2;break}case 2:{C=3;break}case 3:{C=1;break}}return C|0}function $s(C){switch(C=C|0,C|0){case 1:{C=3;break}case 3:{C=2;break}case 2:{C=6;break}case 6:{C=4;break}case 4:{C=5;break}case 5:{C=1;break}}return C|0}function El(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;D=o[C>>2]|0,oe=C+4|0,z=o[oe>>2]|0,we=C+8|0,R=o[we>>2]|0,ee=z+(D<<1)|0,o[C>>2]=ee,z=R+(z<<1)|0,o[oe>>2]=z,D=(R<<1)+D|0,o[we>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=R,o[we>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=ee,o[we>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[oe>>2]=ee-z,o[we>>2]=D-z)}function Ha(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=o[C>>2]|0,oe=C+4|0,D=o[oe>>2]|0,we=C+8|0,z=o[we>>2]|0,R=(D<<1)+ee|0,ee=z+(ee<<1)|0,o[C>>2]=ee,o[oe>>2]=R,D=(z<<1)+D|0,o[we>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[oe>>2]=z,o[we>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[we>>2]=D,o[oe>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[oe>>2]=R,o[we>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[oe>>2]=R-z,o[we>>2]=D-z)}function Ta(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;return oe=(o[C>>2]|0)-(o[D>>2]|0)|0,we=(oe|0)<0,R=(o[C+4>>2]|0)-(o[D+4>>2]|0)-(we?oe:0)|0,le=(R|0)<0,ee=(we?0-oe|0:0)+(o[C+8>>2]|0)-(o[D+8>>2]|0)+(le?0-R|0:0)|0,C=(ee|0)<0,D=C?0:ee,z=(le?0:R)-(C?ee:0)|0,ee=(we?0:oe)-(le?R:0)-(C?ee:0)|0,C=(z|0)<(ee|0)?z:ee,C=(D|0)<(C|0)?D:C,R=(C|0)>0,D=D-(R?C:0)|0,z=z-(R?C:0)|0,C=ee-(R?C:0)|0,C=(C|0)>-1?C:0-C|0,z=(z|0)>-1?z:0-z|0,D=(D|0)>-1?D:0-D|0,D=(z|0)>(D|0)?z:D,((C|0)>(D|0)?C:D)|0}function ml(C,D){C=C|0,D=D|0;var z=0;z=o[C+8>>2]|0,o[D>>2]=(o[C>>2]|0)-z,o[D+4>>2]=(o[C+4>>2]|0)-z}function Cl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;R=o[C>>2]|0,o[D>>2]=R,C=o[C+4>>2]|0,oe=D+4|0,o[oe>>2]=C,we=D+8|0,o[we>>2]=0,z=C-R|0,(R|0)<0?(C=0-R|0,o[oe>>2]=z,o[we>>2]=C,o[D>>2]=0,R=0):(z=C,C=0),(z|0)<0&&(R=R-z|0,o[D>>2]=R,C=C-z|0,o[we>>2]=C,o[oe>>2]=0,z=0),le=R-C|0,ee=z-C|0,(C|0)<0?(o[D>>2]=le,o[oe>>2]=ee,o[we>>2]=0,z=ee,ee=le,C=0):ee=R,R=(z|0)<(ee|0)?z:ee,R=(C|0)<(R|0)?C:R,!((R|0)<=0)&&(o[D>>2]=ee-R,o[oe>>2]=z-R,o[we>>2]=C-R)}function mu(C){C=C|0;var D=0,z=0,R=0,ee=0;D=C+8|0,ee=o[D>>2]|0,z=ee-(o[C>>2]|0)|0,o[C>>2]=z,R=C+4|0,C=(o[R>>2]|0)-ee|0,o[R>>2]=C,o[D>>2]=0-(C+z)}function us(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;z=o[C>>2]|0,D=0-z|0,o[C>>2]=D,oe=C+8|0,o[oe>>2]=0,we=C+4|0,R=o[we>>2]|0,ee=R+z|0,(z|0)>0?(o[we>>2]=ee,o[oe>>2]=z,o[C>>2]=0,D=0,R=ee):z=0,(R|0)<0?(le=D-R|0,o[C>>2]=le,z=z-R|0,o[oe>>2]=z,o[we>>2]=0,ee=le-z|0,D=0-z|0,(z|0)<0?(o[C>>2]=ee,o[we>>2]=D,o[oe>>2]=0,R=D,z=0):(R=0,ee=le)):ee=D,D=(R|0)<(ee|0)?R:ee,D=(z|0)<(D|0)?z:D,!((D|0)<=0)&&(o[C>>2]=ee-D,o[we>>2]=R-D,o[oe>>2]=z-D)}function rc(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,io(C,D,z,ee),Gr(ee,z+4|0),Vt=R}function io(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0;if(We=Vt,Vt=Vt+32|0,le=We,sc(C,le),o[z>>2]=0,ee=+ta(15888,le),oe=+ta(15912,le),oe<ee&&(o[z>>2]=1,ee=oe),oe=+ta(15936,le),oe<ee&&(o[z>>2]=2,ee=oe),oe=+ta(15960,le),oe<ee&&(o[z>>2]=3,ee=oe),oe=+ta(15984,le),oe<ee&&(o[z>>2]=4,ee=oe),oe=+ta(16008,le),oe<ee&&(o[z>>2]=5,ee=oe),oe=+ta(16032,le),oe<ee&&(o[z>>2]=6,ee=oe),oe=+ta(16056,le),oe<ee&&(o[z>>2]=7,ee=oe),oe=+ta(16080,le),oe<ee&&(o[z>>2]=8,ee=oe),oe=+ta(16104,le),oe<ee&&(o[z>>2]=9,ee=oe),oe=+ta(16128,le),oe<ee&&(o[z>>2]=10,ee=oe),oe=+ta(16152,le),oe<ee&&(o[z>>2]=11,ee=oe),oe=+ta(16176,le),oe<ee&&(o[z>>2]=12,ee=oe),oe=+ta(16200,le),oe<ee&&(o[z>>2]=13,ee=oe),oe=+ta(16224,le),oe<ee&&(o[z>>2]=14,ee=oe),oe=+ta(16248,le),oe<ee&&(o[z>>2]=15,ee=oe),oe=+ta(16272,le),oe<ee&&(o[z>>2]=16,ee=oe),oe=+ta(16296,le),oe<ee&&(o[z>>2]=17,ee=oe),oe=+ta(16320,le),oe<ee&&(o[z>>2]=18,ee=oe),oe=+ta(16344,le),oe<ee&&(o[z>>2]=19,ee=oe),oe=+$t(+(1-ee*.5)),oe<1e-16){o[R>>2]=0,o[R+4>>2]=0,o[R+8>>2]=0,o[R+12>>2]=0,Vt=We;return}if(z=o[z>>2]|0,ee=+ke[16368+(z*24|0)>>3],ee=+$o(ee-+$o(+Sr(15568+(z<<4)|0,C))),Nr(D)|0?we=+$o(ee+-.3334731722518321):we=ee,ee=+wi(+oe)/.381966011250105,(D|0)>0){le=0;do ee=ee*2.6457513110645907,le=le+1|0;while((le|0)!=(D|0))}oe=+zi(+we)*ee,ke[R>>3]=oe,we=+vi(+we)*ee,ke[R+8>>3]=we,Vt=We}function no(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0;if(le=+Fu(C),le<1e-16){D=15568+(D<<4)|0,o[ee>>2]=o[D>>2],o[ee+4>>2]=o[D+4>>2],o[ee+8>>2]=o[D+8>>2],o[ee+12>>2]=o[D+12>>2];return}if(oe=+mn(+ +ke[C+8>>3],+ +ke[C>>3]),(z|0)>0){C=0;do le=le/2.6457513110645907,C=C+1|0;while((C|0)!=(z|0))}R?(le=le/3,z=(Nr(z)|0)==0,le=+or(+((z?le:le/2.6457513110645907)*.381966011250105))):(le=+or(+(le*.381966011250105)),Nr(z)|0&&(oe=+$o(oe+.3334731722518321))),Xn(15568+(D<<4)|0,+$o(+ke[16368+(D*24|0)>>3]-oe),le,ee)}function ql(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,wr(C+4|0,ee),no(ee,o[C>>2]|0,D,0,z),Vt=R}function Ro(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0;if(Y=Vt,Vt=Vt+272|0,le=Y+256|0,O=Y+240|0,T=Y,B=Y+224|0,j=Y+208|0,y=Y+176|0,s=Y+160|0,i=Y+192|0,r=Y+144|0,l=Y+128|0,d=Y+112|0,_=Y+96|0,w=Y+80|0,o[le>>2]=D,o[O>>2]=o[C>>2],o[O+4>>2]=o[C+4>>2],o[O+8>>2]=o[C+8>>2],o[O+12>>2]=o[C+12>>2],Wo(O,le,T),o[ee>>2]=0,O=R+z+((R|0)==5&1)|0,(O|0)<=(z|0)){Vt=Y;return}We=o[le>>2]|0,vt=B+4|0,Ct=y+4|0,ni=z+5|0,Gt=16848+(We<<2)|0,jt=16928+(We<<2)|0,Z=l+8|0,A=d+8|0,E=_+8|0,F=j+4|0,we=z;e:for(;;){oe=T+(((we|0)%5|0)<<4)|0,o[j>>2]=o[oe>>2],o[j+4>>2]=o[oe+4>>2],o[j+8>>2]=o[oe+8>>2],o[j+12>>2]=o[oe+12>>2];do;while((Io(j,We,0,1)|0)==2);if((we|0)>(z|0)&(Nr(D)|0)!=0){if(o[y>>2]=o[j>>2],o[y+4>>2]=o[j+4>>2],o[y+8>>2]=o[j+8>>2],o[y+12>>2]=o[j+12>>2],wr(vt,s),R=o[y>>2]|0,le=o[17008+(R*80|0)+(o[B>>2]<<2)>>2]|0,o[y>>2]=o[18608+(R*80|0)+(le*20|0)>>2],oe=o[18608+(R*80|0)+(le*20|0)+16>>2]|0,(oe|0)>0){C=0;do Ao(Ct),C=C+1|0;while((C|0)<(oe|0))}switch(oe=18608+(R*80|0)+(le*20|0)+4|0,o[i>>2]=o[oe>>2],o[i+4>>2]=o[oe+4>>2],o[i+8>>2]=o[oe+8>>2],vr(i,(o[Gt>>2]|0)*3|0),Dr(Ct,i,Ct),nr(Ct),wr(Ct,r),ce=+(o[jt>>2]|0),ke[l>>3]=ce*3,ke[Z>>3]=0,Se=ce*-1.5,ke[d>>3]=Se,ke[A>>3]=ce*2.598076211353316,ke[_>>3]=Se,ke[E>>3]=ce*-2.598076211353316,o[17008+((o[y>>2]|0)*80|0)+(o[j>>2]<<2)>>2]|0){case 1:{C=d,R=l;break}case 3:{C=_,R=d;break}case 2:{C=l,R=_;break}default:{C=12;break e}}Vl(s,r,R,C,w),no(w,o[y>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1}if((we|0)<(ni|0)&&(wr(F,y),no(y,o[j>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),o[B>>2]=o[j>>2],o[B+4>>2]=o[j+4>>2],o[B+8>>2]=o[j+8>>2],o[B+12>>2]=o[j+12>>2],we=we+1|0,(we|0)>=(O|0)){C=3;break}}if((C|0)==3){Vt=Y;return}else(C|0)==12&&Yi(22474,22521,581,22531)}function Wo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0;We=Vt,Vt=Vt+128|0,R=We+64|0,ee=We,le=R,oe=20208,we=le+60|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));le=ee,oe=20272,we=le+60|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));we=(Nr(o[D>>2]|0)|0)==0,R=we?R:ee,ee=C+4|0,El(ee),Ha(ee),Nr(o[D>>2]|0)|0&&(Ls(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Dr(ee,R,D),nr(D),o[z+16>>2]=o[C>>2],D=z+20|0,Dr(ee,R+12|0,D),nr(D),o[z+32>>2]=o[C>>2],D=z+36|0,Dr(ee,R+24|0,D),nr(D),o[z+48>>2]=o[C>>2],D=z+52|0,Dr(ee,R+36|0,D),nr(D),o[z+64>>2]=o[C>>2],z=z+68|0,Dr(ee,R+48|0,z),nr(z),Vt=We}function Io(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0;if(Z=Vt,Vt=Vt+32|0,Gt=Z+12|0,we=Z,jt=C+4|0,ni=o[16928+(D<<2)>>2]|0,Ct=(R|0)!=0,ni=Ct?ni*3|0:ni,ee=o[jt>>2]|0,vt=C+8|0,oe=o[vt>>2]|0,Ct){if(le=C+12|0,R=o[le>>2]|0,ee=oe+ee+R|0,(ee|0)==(ni|0))return jt=1,Vt=Z,jt|0;We=le}else We=C+12|0,R=o[We>>2]|0,ee=oe+ee+R|0;if((ee|0)<=(ni|0))return jt=0,Vt=Z,jt|0;do if((R|0)>0){if(R=o[C>>2]|0,(oe|0)>0){le=18608+(R*80|0)+60|0,R=C;break}R=18608+(R*80|0)+40|0,z?(pl(Gt,ni,0,0),js(jt,Gt,we),Qo(we),Dr(we,Gt,jt),le=R,R=C):(le=R,R=C)}else le=18608+((o[C>>2]|0)*80|0)+20|0,R=C;while(!1);if(o[R>>2]=o[le>>2],ee=le+16|0,(o[ee>>2]|0)>0){R=0;do Ao(jt),R=R+1|0;while((R|0)<(o[ee>>2]|0))}return C=le+4|0,o[Gt>>2]=o[C>>2],o[Gt+4>>2]=o[C+4>>2],o[Gt+8>>2]=o[C+8>>2],D=o[16848+(D<<2)>>2]|0,vr(Gt,Ct?D*3|0:D),Dr(jt,Gt,jt),nr(jt),Ct?R=((o[vt>>2]|0)+(o[jt>>2]|0)+(o[We>>2]|0)|0)==(ni|0)?1:2:R=2,jt=R,Vt=Z,jt|0}function Us(C,D){C=C|0,D=D|0;var z=0;do z=Io(C,D,0,1)|0;while((z|0)==2);return z|0}function Xo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0;if(_=Vt,Vt=Vt+240|0,le=_+224|0,i=_+208|0,r=_,l=_+192|0,d=_+176|0,E=_+160|0,F=_+144|0,O=_+128|0,y=_+112|0,s=_+96|0,o[le>>2]=D,o[i>>2]=o[C>>2],o[i+4>>2]=o[C+4>>2],o[i+8>>2]=o[C+8>>2],o[i+12>>2]=o[C+12>>2],Yo(i,le,r),o[ee>>2]=0,A=R+z+((R|0)==6&1)|0,(A|0)<=(z|0)){Vt=_;return}We=o[le>>2]|0,vt=z+6|0,Ct=16928+(We<<2)|0,ni=F+8|0,Gt=O+8|0,jt=y+8|0,Z=l+4|0,oe=0,we=z,R=-1;e:for(;;){if(le=(we|0)%6|0,C=r+(le<<4)|0,o[l>>2]=o[C>>2],o[l+4>>2]=o[C+4>>2],o[l+8>>2]=o[C+8>>2],o[l+12>>2]=o[C+12>>2],C=oe,oe=Io(l,We,0,1)|0,(we|0)>(z|0)&(Nr(D)|0)!=0&&(C|0)!=1&&(o[l>>2]|0)!=(R|0)){switch(wr(r+(((le+5|0)%6|0)<<4)+4|0,d),wr(r+(le<<4)+4|0,E),w=+(o[Ct>>2]|0),ke[F>>3]=w*3,ke[ni>>3]=0,T=w*-1.5,ke[O>>3]=T,ke[Gt>>3]=w*2.598076211353316,ke[y>>3]=T,ke[jt>>3]=w*-2.598076211353316,le=o[i>>2]|0,o[17008+(le*80|0)+(((R|0)==(le|0)?o[l>>2]|0:R)<<2)>>2]|0){case 1:{C=O,R=F;break}case 3:{C=y,R=O;break}case 2:{C=F,R=y;break}default:{C=8;break e}}Vl(d,E,R,C,s),!(yl(d,s)|0)&&!(yl(E,s)|0)&&(no(s,o[i>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1)}if((we|0)<(vt|0)&&(wr(Z,d),no(d,o[l>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),we=we+1|0,(we|0)>=(A|0)){C=3;break}else R=o[l>>2]|0}if((C|0)==3){Vt=_;return}else(C|0)==8&&Yi(22557,22521,746,22602)}function Yo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0;We=Vt,Vt=Vt+160|0,R=We+80|0,ee=We,le=R,oe=20336,we=le+72|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));le=ee,oe=20416,we=le+72|0;do o[le>>2]=o[oe>>2],le=le+4|0,oe=oe+4|0;while((le|0)<(we|0));we=(Nr(o[D>>2]|0)|0)==0,R=we?R:ee,ee=C+4|0,El(ee),Ha(ee),Nr(o[D>>2]|0)|0&&(Ls(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Dr(ee,R,D),nr(D),o[z+16>>2]=o[C>>2],D=z+20|0,Dr(ee,R+12|0,D),nr(D),o[z+32>>2]=o[C>>2],D=z+36|0,Dr(ee,R+24|0,D),nr(D),o[z+48>>2]=o[C>>2],D=z+52|0,Dr(ee,R+36|0,D),nr(D),o[z+64>>2]=o[C>>2],D=z+68|0,Dr(ee,R+48|0,D),nr(D),o[z+80>>2]=o[C>>2],z=z+84|0,Dr(ee,R+60|0,z),nr(z),Vt=We}function $o(C){C=+C;var D=0;return D=C<0?C+6.283185307179586:C,+(C>=6.283185307179586?D+-6.283185307179586:D)}function ba(C,D){return C=C|0,D=D|0,+Ai(+(+ke[C>>3]-+ke[D>>3]))<17453292519943298e-27?(D=+Ai(+(+ke[C+8>>3]-+ke[D+8>>3]))<17453292519943298e-27,D|0):(D=0,D|0)}function ja(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+zi(+ee)*+zi(+R)*z),+(+mn(+ +Jt(+z),+ +Jt(+(1-z)))*2)}function Cs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+zi(+ee)*+zi(+R)*z),+(+mn(+ +Jt(+z),+ +Jt(+(1-z)))*2*6371.007180918475)}function gu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+zi(+ee)*+zi(+R)*z),+(+mn(+ +Jt(+z),+ +Jt(+(1-z)))*2*6371.007180918475*1e3)}function Sr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;return le=+ke[D>>3],R=+zi(+le),ee=+ke[D+8>>3]-+ke[C+8>>3],oe=R*+vi(+ee),z=+ke[C>>3],+ +mn(+oe,+(+vi(+le)*+zi(+z)-+zi(+ee)*(R*+vi(+z))))}function Xn(C,D,z,R){C=C|0,D=+D,z=+z,R=R|0;var ee=0,le=0,oe=0,we=0;if(z<1e-16){o[R>>2]=o[C>>2],o[R+4>>2]=o[C+4>>2],o[R+8>>2]=o[C+8>>2],o[R+12>>2]=o[C+12>>2];return}le=D<0?D+6.283185307179586:D,le=D>=6.283185307179586?le+-6.283185307179586:le;do if(le<1e-16)D=+ke[C>>3]+z,ke[R>>3]=D,ee=R;else{if(ee=+Ai(+(le+-3.141592653589793))<1e-16,D=+ke[C>>3],ee){D=D-z,ke[R>>3]=D,ee=R;break}if(oe=+zi(+z),z=+vi(+z),D=oe*+vi(+D)+ +zi(+le)*(z*+zi(+D)),D=D>1?1:D,D=+vn(+(D<-1?-1:D)),ke[R>>3]=D,+Ai(+(D+-1.5707963267948966))<1e-16){ke[R>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+Ai(+(D+1.5707963267948966))<1e-16){ke[R>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(we=+zi(+D),le=z*+vi(+le)/we,z=+ke[C>>3],D=(oe-+vi(+D)*+vi(+z))/+zi(+z)/we,oe=le>1?1:le,D=D>1?1:D,D=+ke[C+8>>3]+ +mn(+(oe<-1?-1:oe),+(D<-1?-1:D)),D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D;return}while(!1);if(+Ai(+(D+-1.5707963267948966))<1e-16){ke[ee>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+Ai(+(D+1.5707963267948966))<1e-16){ke[ee>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(D=+ke[C+8>>3],D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D}function Ko(C){return C=C|0,+ +ke[20496+(C<<3)>>3]}function Br(C){return C=C|0,+ +ke[20624+(C<<3)>>3]}function Za(C){return C=C|0,+ +ke[20752+(C<<3)>>3]}function Jr(C){return C=C|0,+ +ke[20880+(C<<3)>>3]}function fr(C){C=C|0;var D=0;return D=21008+(C<<3)|0,C=o[D>>2]|0,On(o[D+4>>2]|0),C|0}function Eo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0;return Gt=+ke[D>>3],Ct=+ke[C>>3],We=+vi(+((Gt-Ct)*.5)),le=+ke[D+8>>3],vt=+ke[C+8>>3],oe=+vi(+((le-vt)*.5)),we=+zi(+Ct),ni=+zi(+Gt),oe=We*We+oe*(ni*we*oe),oe=+mn(+ +Jt(+oe),+ +Jt(+(1-oe)))*2,We=+ke[z>>3],Gt=+vi(+((We-Gt)*.5)),R=+ke[z+8>>3],le=+vi(+((R-le)*.5)),ee=+zi(+We),le=Gt*Gt+le*(ni*ee*le),le=+mn(+ +Jt(+le),+ +Jt(+(1-le)))*2,We=+vi(+((Ct-We)*.5)),R=+vi(+((vt-R)*.5)),R=We*We+R*(we*ee*R),R=+mn(+ +Jt(+R),+ +Jt(+(1-R)))*2,ee=(oe+le+R)*.5,+(+or(+ +Jt(+(+wi(+(ee*.5))*+wi(+((ee-oe)*.5))*+wi(+((ee-le)*.5))*+wi(+((ee-R)*.5)))))*4)}function Un(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)<=0)return z=0,Vt=le,+z;if(z=+Eo(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)==1)return Vt=le,+z;C=1;do oe=C,C=C+1|0,z=z+ +Eo(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0));return Vt=le,+z}function Ol(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+Eo(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do oe=C,C=C+1|0,z=z+ +Eo(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475)}function es(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+Eo(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do oe=C,C=C+1|0,z=z+ +Eo(ee+8+(oe<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475*1e3*1e3)}function Zr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],vt=+vi(+((R-We)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+vi(+((ee-we)*.5)),we=vt*vt+we*(+zi(+R)*+zi(+We)*we),z=z+ +mn(+ +Jt(+we),+ +Jt(+(1-we)))*2;while((C|0)<(D|0));return Vt=oe,+z}function Ts(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],vt=+vi(+((R-We)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+vi(+((ee-we)*.5)),we=vt*vt+we*(+zi(+We)*+zi(+R)*we),z=z+ +mn(+ +Jt(+we),+ +Jt(+(1-we)))*2;while((C|0)!=(D|0));return vt=z*6371.007180918475,Vt=oe,+vt}function kr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0;if(oe=Vt,Vt=Vt+176|0,le=oe,Fi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=oe,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],vt=+vi(+((R-We)*.5)),we=ee,ee=+ke[le+8+(C<<4)+8>>3],we=+vi(+((ee-we)*.5)),we=vt*vt+we*(+zi(+We)*+zi(+R)*we),z=z+ +mn(+ +Jt(+we),+ +Jt(+(1-we)))*2;while((C|0)!=(D|0));return vt=z*6371.007180918475*1e3,Vt=oe,+vt}function rr(C,D){return C=C|0,D=D|0,D=ki(C|0,D|0,52)|0,Qt()|0,D&15|0}function ll(C,D){return C=C|0,D=D|0,D=ki(C|0,D|0,45)|0,Qt()|0,D&127|0}function Yr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0;if(!(!0&(D&-16777216|0)==134217728)||(oe=ki(C|0,D|0,45)|0,Qt()|0,oe=oe&127,oe>>>0>121))return D=0,D|0;z=ki(C|0,D|0,52)|0,Qt()|0,z=z&15;do if(z|0){for(ee=1,R=0;;){if(le=ki(C|0,D|0,(15-ee|0)*3|0)|0,Qt()|0,le=le&7,(le|0)!=0&(R^1))if((le|0)==1&(N(oe)|0)!=0){we=0,R=13;break}else R=1;if((le|0)==7){we=0,R=13;break}if(ee>>>0<z>>>0)ee=ee+1|0;else{R=9;break}}if((R|0)==9){if((z|0)==15)we=1;else break;return we|0}else if((R|0)==13)return we|0}while(!1);for(;;){if(we=ki(C|0,D|0,(14-z|0)*3|0)|0,Qt()|0,!((we&7|0)==7&!0)){we=0,R=13;break}if(z>>>0<14)z=z+1|0;else{we=1,R=13;break}}return(R|0)==13?we|0:0}function Co(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=ki(C|0,D|0,52)|0,Qt()|0,R=R&15,(R|0)>=(z|0)){if((R|0)!=(z|0))if(z>>>0<=15){if(ee=Bi(z|0,0,52)|0,C=ee|C,D=Qt()|0|D&-15728641,(R|0)>(z|0))do ee=Bi(7,0,(14-z|0)*3|0)|0,z=z+1|0,C=ee|C,D=Qt()|0|D;while((z|0)<(R|0))}else D=0,C=0}else D=0,C=0;return On(D|0),C|0}function ul(C,D,z){return C=C|0,D=D|0,z=z|0,C=ki(C|0,D|0,52)|0,Qt()|0,C=C&15,(z|0)<16&(C|0)<=(z|0)?(z=go(7,z-C|0)|0,z|0):(z=0,z|0)}function Qr(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0;if(oe=ki(C|0,D|0,52)|0,Qt()|0,oe=oe&15,!!((z|0)<16&(oe|0)<=(z|0))){if((oe|0)==(z|0)){z=R,o[z>>2]=C,o[z+4>>2]=D;return}if(We=go(7,z-oe|0)|0,vt=(We|0)/7|0,we=ki(C|0,D|0,45)|0,Qt()|0,!(N(we&127)|0))le=0;else{e:do if(!oe)ee=0;else for(le=1;;){if(ee=ki(C|0,D|0,(15-le|0)*3|0)|0,Qt()|0,ee=ee&7,ee|0)break e;if(le>>>0<oe>>>0)le=le+1|0;else{ee=0;break}}while(!1);le=(ee|0)==0}if(Ct=Bi(oe+1|0,0,52)|0,ee=Qt()|0|D&-15728641,we=(14-oe|0)*3|0,D=Bi(7,0,we|0)|0,D=(Ct|C)&~D,oe=ee&~(Qt()|0),Qr(D,oe,z,R),ee=R+(vt<<3)|0,!le){Ct=Bi(1,0,we|0)|0,Qr(Ct|D,Qt()|0|oe,z,ee),Ct=ee+(vt<<3)|0,We=Bi(2,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct),Ct=Ct+(vt<<3)|0,We=Bi(3,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct),Ct=Ct+(vt<<3)|0,We=Bi(4,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct),Ct=Ct+(vt<<3)|0,We=Bi(5,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct),We=Bi(6,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct+(vt<<3)|0);return}le=ee+(vt<<3)|0,(We|0)>6&&(We=ee+8|0,Ct=(le>>>0>We>>>0?le:We)+-1+(0-ee)|0,cs(ee|0,0,Ct+8&-8|0)|0,ee=We+(Ct>>>3<<3)|0),Ct=Bi(2,0,we|0)|0,Qr(Ct|D,Qt()|0|oe,z,ee),Ct=ee+(vt<<3)|0,We=Bi(3,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct),Ct=Ct+(vt<<3)|0,We=Bi(4,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct),Ct=Ct+(vt<<3)|0,We=Bi(5,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct),We=Bi(6,0,we|0)|0,Qr(We|D,Qt()|0|oe,z,Ct+(vt<<3)|0)}}function hs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=ki(C|0,D|0,45)|0,Qt()|0,!(N(ee&127)|0))return ee=0,ee|0;ee=ki(C|0,D|0,52)|0,Qt()|0,ee=ee&15;e:do if(!ee)z=0;else for(R=1;;){if(z=ki(C|0,D|0,(15-R|0)*3|0)|0,Qt()|0,z=z&7,z|0)break e;if(R>>>0<ee>>>0)R=R+1|0;else{z=0;break}}while(!1);return ee=(z|0)==0&1,ee|0}function wa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=ki(C|0,D|0,52)|0,Qt()|0,R=R&15,(z|0)<16&(R|0)<=(z|0)){if((R|0)!=(z|0)&&(ee=Bi(z|0,0,52)|0,C=ee|C,D=Qt()|0|D&-15728641,(R|0)<(z|0)))do ee=Bi(7,0,(14-R|0)*3|0)|0,R=R+1|0,C=C&~ee,D=D&~(Qt()|0);while((R|0)<(z|0))}else D=0,C=0;return On(D|0),C|0}function Tl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0;if(!z)return l=0,l|0;if(ee=C,R=o[ee>>2]|0,ee=o[ee+4>>2]|0,!0&(ee&15728640|0)==0){if((z|0)<=0||(l=D,o[l>>2]=R,o[l+4>>2]=ee,(z|0)==1))return l=0,l|0;R=1;do i=C+(R<<3)|0,r=o[i+4>>2]|0,l=D+(R<<3)|0,o[l>>2]=o[i>>2],o[l+4>>2]=r,R=R+1|0;while((R|0)!=(z|0));return R=0,R|0}if(i=z<<3,r=jn(i)|0,!r)return l=-3,l|0;if(Oo(r|0,C|0,i|0)|0,s=tl(z,8)|0,!s)return Jn(r),l=-3,l|0;R=z;e:for(;;){oe=r,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0,O=ki(Ct|0,oe|0,52)|0,Qt()|0,O=O&15,y=O+-1|0,F=(R|0)>0;t:do if(F){if(E=((R|0)<0)<<31>>31,Z=Bi(y|0,0,52)|0,A=Qt()|0,y>>>0>15)for(ee=0,C=Ct,z=oe;;){if(!((C|0)==0&(z|0)==0)){if(le=ki(C|0,z|0,52)|0,Qt()|0,le=le&15,we=(le|0)<(y|0),le=(le|0)==(y|0),vt=we?0:le?C:0,C=we?0:le?z:0,z=ko(vt|0,C|0,R|0,E|0)|0,Qt()|0,le=s+(z<<3)|0,we=le,We=o[we>>2]|0,we=o[we+4>>2]|0,(We|0)==0&(we|0)==0)z=vt;else for(Z=0,jt=z,Gt=we,z=vt;;){if((Z|0)>(R|0)){l=41;break e}if((We|0)==(z|0)&(Gt&-117440513|0)==(C|0)){vt=ki(We|0,Gt|0,56)|0,Qt()|0,vt=vt&7,ni=vt+1|0,A=ki(We|0,Gt|0,45)|0,Qt()|0;i:do if(!(N(A&127)|0))we=7;else{if(We=ki(We|0,Gt|0,52)|0,Qt()|0,We=We&15,!We){we=6;break}for(we=1;;){if(A=Bi(7,0,(15-we|0)*3|0)|0,!((A&z|0)==0&((Qt()|0)&C|0)==0)){we=7;break i}if(we>>>0<We>>>0)we=we+1|0;else{we=6;break}}}while(!1);if((vt+2|0)>>>0>we>>>0){l=51;break e}A=Bi(ni|0,0,56)|0,C=Qt()|0|C&-117440513,we=le,o[we>>2]=0,o[we+4>>2]=0,we=jt,z=A|z}else we=(jt+1|0)%(R|0)|0;if(le=s+(we<<3)|0,Gt=le,We=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,(We|0)==0&(Gt|0)==0)break;Z=Z+1|0,jt=we}A=le,o[A>>2]=z,o[A+4>>2]=C}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}for(ee=0,C=Ct,z=oe;;){if(!((C|0)==0&(z|0)==0)){if(we=ki(C|0,z|0,52)|0,Qt()|0,we=we&15,(we|0)>=(y|0)){if((we|0)!=(y|0)&&(C=C|Z,z=z&-15728641|A,we>>>0>=O>>>0)){le=y;do jt=Bi(7,0,(14-le|0)*3|0)|0,le=le+1|0,C=jt|C,z=Qt()|0|z;while(le>>>0<we>>>0)}}else C=0,z=0;if(we=ko(C|0,z|0,R|0,E|0)|0,Qt()|0,le=s+(we<<3)|0,We=le,vt=o[We>>2]|0,We=o[We+4>>2]|0,!((vt|0)==0&(We|0)==0))for(jt=0;;){if((jt|0)>(R|0)){l=41;break e}if((vt|0)==(C|0)&(We&-117440513|0)==(z|0)){ni=ki(vt|0,We|0,56)|0,Qt()|0,ni=ni&7,Gt=ni+1|0,d=ki(vt|0,We|0,45)|0,Qt()|0;i:do if(!(N(d&127)|0))We=7;else{if(vt=ki(vt|0,We|0,52)|0,Qt()|0,vt=vt&15,!vt){We=6;break}for(We=1;;){if(d=Bi(7,0,(15-We|0)*3|0)|0,!((d&C|0)==0&((Qt()|0)&z|0)==0)){We=7;break i}if(We>>>0<vt>>>0)We=We+1|0;else{We=6;break}}}while(!1);if((ni+2|0)>>>0>We>>>0){l=51;break e}d=Bi(Gt|0,0,56)|0,z=Qt()|0|z&-117440513,Gt=le,o[Gt>>2]=0,o[Gt+4>>2]=0,C=d|C}else we=(we+1|0)%(R|0)|0;if(le=s+(we<<3)|0,We=le,vt=o[We>>2]|0,We=o[We+4>>2]|0,(vt|0)==0&(We|0)==0)break;jt=jt+1|0}d=le,o[d>>2]=C,o[d+4>>2]=z}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}}while(!1);if((R+5|0)>>>0<11){l=99;break}if(A=tl((R|0)/6|0,8)|0,!A){l=58;break}t:do if(F){jt=0,Gt=0;do{if(we=s+(jt<<3)|0,C=we,ee=o[C>>2]|0,C=o[C+4>>2]|0,!((ee|0)==0&(C|0)==0)){We=ki(ee|0,C|0,56)|0,Qt()|0,We=We&7,z=We+1|0,vt=C&-117440513,d=ki(ee|0,C|0,45)|0,Qt()|0;i:do if(N(d&127)|0){if(ni=ki(ee|0,C|0,52)|0,Qt()|0,ni=ni&15,ni|0)for(le=1;;){if(d=Bi(7,0,(15-le|0)*3|0)|0,!((ee&d|0)==0&(vt&(Qt()|0)|0)==0))break i;if(le>>>0<ni>>>0)le=le+1|0;else break}C=Bi(z|0,0,56)|0,ee=C|ee,C=Qt()|0|vt,z=we,o[z>>2]=ee,o[z+4>>2]=C,z=We+2|0}while(!1);(z|0)==7&&(d=A+(Gt<<3)|0,o[d>>2]=ee,o[d+4>>2]=C&-117440513,Gt=Gt+1|0)}jt=jt+1|0}while((jt|0)!=(R|0));if(F){if(Z=((R|0)<0)<<31>>31,ni=Bi(y|0,0,52)|0,jt=Qt()|0,y>>>0>15)for(C=0,ee=0;;){do if(!((Ct|0)==0&(oe|0)==0)){for(We=ki(Ct|0,oe|0,52)|0,Qt()|0,We=We&15,le=(We|0)<(y|0),We=(We|0)==(y|0),we=le?0:We?Ct:0,We=le?0:We?oe:0,le=ko(we|0,We|0,R|0,Z|0)|0,Qt()|0,z=0;;){if((z|0)>(R|0)){l=98;break e}if(d=s+(le<<3)|0,vt=o[d+4>>2]|0,(vt&-117440513|0)==(We|0)&&(o[d>>2]|0)==(we|0)){l=70;break}if(le=(le+1|0)%(R|0)|0,d=s+(le<<3)|0,(o[d>>2]|0)==(we|0)&&(o[d+4>>2]|0)==(We|0))break;z=z+1|0}if((l|0)==70&&(l=0,!0&(vt&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=oe,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}oe=r+(C<<3)|0,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0}for(C=0,ee=0;;){do if(!((Ct|0)==0&(oe|0)==0)){if(We=ki(Ct|0,oe|0,52)|0,Qt()|0,We=We&15,(We|0)>=(y|0))if((We|0)!=(y|0))if(z=Ct|ni,le=oe&-15728641|jt,We>>>0<O>>>0)We=le;else{we=y;do d=Bi(7,0,(14-we|0)*3|0)|0,we=we+1|0,z=d|z,le=Qt()|0|le;while(we>>>0<We>>>0);We=le}else z=Ct,We=oe;else z=0,We=0;for(we=ko(z|0,We|0,R|0,Z|0)|0,Qt()|0,le=0;;){if((le|0)>(R|0)){l=98;break e}if(d=s+(we<<3)|0,vt=o[d+4>>2]|0,(vt&-117440513|0)==(We|0)&&(o[d>>2]|0)==(z|0)){l=93;break}if(we=(we+1|0)%(R|0)|0,d=s+(we<<3)|0,(o[d>>2]|0)==(z|0)&&(o[d+4>>2]|0)==(We|0))break;le=le+1|0}if((l|0)==93&&(l=0,!0&(vt&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=oe,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}oe=r+(C<<3)|0,Ct=o[oe>>2]|0,oe=o[oe+4>>2]|0}}else ee=0,R=Gt}else ee=0,R=0;while(!1);if(cs(s|0,0,i|0)|0,Oo(r|0,A|0,R<<3|0)|0,Jn(A),R)D=D+(ee<<3)|0;else break}return(l|0)==41?(Jn(r),Jn(s),d=-1,d|0):(l|0)==51?(Jn(r),Jn(s),d=-2,d|0):(l|0)==58?(Jn(r),Jn(s),d=-3,d|0):(l|0)==98?(Jn(A),Jn(r),Jn(s),d=-1,d|0):((l|0)==99&&Oo(D|0,r|0,R<<3|0)|0,Jn(r),Jn(s),d=0,d|0)}function To(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0;if((D|0)<=0)return ee=0,ee|0;if((ee|0)>=16){for(le=0;;){if(Ct=C+(le<<3)|0,!((o[Ct>>2]|0)==0&(o[Ct+4>>2]|0)==0)){le=14;break}if(le=le+1|0,(le|0)>=(D|0)){oe=0,le=16;break}}if((le|0)==14)return((R|0)>0?-2:-1)|0;if((le|0)==16)return oe|0}le=0,Ct=0;e:for(;;){vt=C+(Ct<<3)|0,we=vt,oe=o[we>>2]|0,we=o[we+4>>2]|0;do if(!((oe|0)==0&(we|0)==0)){if((le|0)>=(R|0)){oe=-1,le=16;break e}if(We=ki(oe|0,we|0,52)|0,Qt()|0,We=We&15,(We|0)>(ee|0)){oe=-2,le=16;break e}if((We|0)==(ee|0)){vt=z+(le<<3)|0,o[vt>>2]=oe,o[vt+4>>2]=we,le=le+1|0;break}if(oe=(go(7,ee-We|0)|0)+le|0,(oe|0)>(R|0)){oe=-1,le=16;break e}Qr(o[vt>>2]|0,o[vt+4>>2]|0,ee,z+(le<<3)|0),le=oe}while(!1);if(Ct=Ct+1|0,(Ct|0)>=(D|0)){oe=0,le=16;break}}return(le|0)==16?oe|0:0}function kl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if((D|0)<=0)return z=0,z|0;if((z|0)>=16){for(R=0;;){if(oe=C+(R<<3)|0,!((o[oe>>2]|0)==0&(o[oe+4>>2]|0)==0)){R=-1,ee=13;break}if(R=R+1|0,(R|0)>=(D|0)){R=0,ee=13;break}}if((ee|0)==13)return R|0}R=0,oe=0;e:for(;;){ee=C+(oe<<3)|0,le=o[ee>>2]|0,ee=o[ee+4>>2]|0;do if(!((le|0)==0&(ee|0)==0)){if(ee=ki(le|0,ee|0,52)|0,Qt()|0,ee=ee&15,(ee|0)>(z|0)){R=-1,ee=13;break e}if((ee|0)==(z|0)){R=R+1|0;break}else{R=(go(7,z-ee|0)|0)+R|0;break}}while(!1);if(oe=oe+1|0,(oe|0)>=(D|0)){ee=13;break}}return(ee|0)==13?R|0:0}function fo(C,D){return C=C|0,D=D|0,D=ki(C|0,D|0,52)|0,Qt()|0,D&1|0}function Js(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=ki(C|0,D|0,52)|0,Qt()|0,ee=ee&15,!ee)return ee=0,ee|0;for(R=1;;){if(z=ki(C|0,D|0,(15-R|0)*3|0)|0,Qt()|0,z=z&7,z|0){R=5;break}if(R>>>0<ee>>>0)R=R+1|0;else{z=0,R=5;break}}return(R|0)==5?z|0:0}function Gs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(We=ki(C|0,D|0,52)|0,Qt()|0,We=We&15,!We)return we=D,We=C,On(we|0),We|0;for(we=1,z=0;;){le=(15-we|0)*3|0,R=Bi(7,0,le|0)|0,ee=Qt()|0,oe=ki(C|0,D|0,le|0)|0,Qt()|0,le=Bi(ca(oe&7)|0,0,le|0)|0,oe=Qt()|0,C=le|C&~R,D=oe|D&~ee;e:do if(!z)if((le&R|0)==0&(oe&ee|0)==0)z=0;else if(R=ki(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(oe=ki(C|0,D|0,(15-z|0)*3|0)|0,Qt()|0,oe&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(oe=(15-z|0)*3|0,ee=ki(C|0,D|0,oe|0)|0,Qt()|0,le=Bi(7,0,oe|0)|0,D=D&~(Qt()|0),oe=Bi(ca(ee&7)|0,0,oe|0)|0,C=C&~le|oe,D=D|(Qt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(we>>>0<We>>>0)we=we+1|0;else break}return On(D|0),C|0}function Qa(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(R=ki(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)return z=D,R=C,On(z|0),R|0;for(z=1;le=(15-z|0)*3|0,oe=ki(C|0,D|0,le|0)|0,Qt()|0,ee=Bi(7,0,le|0)|0,D=D&~(Qt()|0),le=Bi(ca(oe&7)|0,0,le|0)|0,C=le|C&~ee,D=Qt()|0|D,z>>>0<R>>>0;)z=z+1|0;return On(D|0),C|0}function Jo(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(We=ki(C|0,D|0,52)|0,Qt()|0,We=We&15,!We)return we=D,We=C,On(we|0),We|0;for(we=1,z=0;;){le=(15-we|0)*3|0,R=Bi(7,0,le|0)|0,ee=Qt()|0,oe=ki(C|0,D|0,le|0)|0,Qt()|0,le=Bi($s(oe&7)|0,0,le|0)|0,oe=Qt()|0,C=le|C&~R,D=oe|D&~ee;e:do if(!z)if((le&R|0)==0&(oe&ee|0)==0)z=0;else if(R=ki(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(oe=ki(C|0,D|0,(15-z|0)*3|0)|0,Qt()|0,oe&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(ee=(15-z|0)*3|0,le=Bi(7,0,ee|0)|0,oe=D&~(Qt()|0),D=ki(C|0,D|0,ee|0)|0,Qt()|0,D=Bi($s(D&7)|0,0,ee|0)|0,C=C&~le|D,D=oe|(Qt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(we>>>0<We>>>0)we=we+1|0;else break}return On(D|0),C|0}function $r(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0;if(R=ki(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)return z=D,R=C,On(z|0),R|0;for(z=1;oe=(15-z|0)*3|0,le=Bi(7,0,oe|0)|0,ee=D&~(Qt()|0),D=ki(C|0,D|0,oe|0)|0,Qt()|0,D=Bi($s(D&7)|0,0,oe|0)|0,C=D|C&~le,D=Qt()|0|ee,z>>>0<R>>>0;)z=z+1|0;return On(D|0),C|0}function mr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0;if(We=Vt,Vt=Vt+64|0,we=We+40|0,R=We+24|0,ee=We+12|0,le=We,Bi(D|0,0,52)|0,z=Qt()|0|134225919,!D)return(o[C+4>>2]|0)>2||(o[C+8>>2]|0)>2||(o[C+12>>2]|0)>2?(oe=0,we=0,On(oe|0),Vt=We,we|0):(Bi(it(C)|0,0,45)|0,oe=Qt()|0|z,we=-1,On(oe|0),Vt=We,we|0);if(o[we>>2]=o[C>>2],o[we+4>>2]=o[C+4>>2],o[we+8>>2]=o[C+8>>2],o[we+12>>2]=o[C+12>>2],oe=we+4|0,(D|0)>0)for(C=-1;o[R>>2]=o[oe>>2],o[R+4>>2]=o[oe+4>>2],o[R+8>>2]=o[oe+8>>2],D&1?(Lr(oe),o[ee>>2]=o[oe>>2],o[ee+4>>2]=o[oe+4>>2],o[ee+8>>2]=o[oe+8>>2],Zo(ee)):(So(oe),o[ee>>2]=o[oe>>2],o[ee+4>>2]=o[oe+4>>2],o[ee+8>>2]=o[oe+8>>2],Ls(ee)),js(R,ee,le),nr(le),Ct=(15-D|0)*3|0,vt=Bi(7,0,Ct|0)|0,z=z&~(Qt()|0),Ct=Bi(Ks(le)|0,0,Ct|0)|0,C=Ct|C&~vt,z=Qt()|0|z,(D|0)>1;)D=D+-1|0;else C=-1;e:do if((o[oe>>2]|0)<=2&&(o[we+8>>2]|0)<=2&&(o[we+12>>2]|0)<=2){if(R=it(we)|0,D=Bi(R|0,0,45)|0,D=D|C,C=Qt()|0|z&-1040385,le=It(we)|0,!(N(R)|0)){if((le|0)<=0)break;for(ee=0;;){if(R=ki(D|0,C|0,52)|0,Qt()|0,R=R&15,R)for(z=1;Ct=(15-z|0)*3|0,we=ki(D|0,C|0,Ct|0)|0,Qt()|0,vt=Bi(7,0,Ct|0)|0,C=C&~(Qt()|0),Ct=Bi(ca(we&7)|0,0,Ct|0)|0,D=D&~vt|Ct,C=C|(Qt()|0),z>>>0<R>>>0;)z=z+1|0;if(ee=ee+1|0,(ee|0)==(le|0))break e}}ee=ki(D|0,C|0,52)|0,Qt()|0,ee=ee&15;t:do if(ee){z=1;i:for(;;){switch(Ct=ki(D|0,C|0,(15-z|0)*3|0)|0,Qt()|0,Ct&7){case 1:break i;case 0:break;default:break t}if(z>>>0<ee>>>0)z=z+1|0;else break t}if(Li(R,o[we>>2]|0)|0)for(z=1;we=(15-z|0)*3|0,vt=Bi(7,0,we|0)|0,Ct=C&~(Qt()|0),C=ki(D|0,C|0,we|0)|0,Qt()|0,C=Bi($s(C&7)|0,0,we|0)|0,D=D&~vt|C,C=Ct|(Qt()|0),z>>>0<ee>>>0;)z=z+1|0;else for(z=1;Ct=(15-z|0)*3|0,we=ki(D|0,C|0,Ct|0)|0,Qt()|0,vt=Bi(7,0,Ct|0)|0,C=C&~(Qt()|0),Ct=Bi(ca(we&7)|0,0,Ct|0)|0,D=D&~vt|Ct,C=C|(Qt()|0),z>>>0<ee>>>0;)z=z+1|0}while(!1);if((le|0)>0){z=0;do D=Gs(D,C)|0,C=Qt()|0,z=z+1|0;while((z|0)!=(le|0))}}else D=0,C=0;while(!1);return vt=C,Ct=D,On(vt|0),Vt=We,Ct|0}function Nr(C){return C=C|0,(C|0)%2|0|0}function ha(C,D){C=C|0,D=D|0;var z=0,R=0;return R=Vt,Vt=Vt+16|0,z=R,D>>>0<=15&&(o[C+4>>2]&2146435072|0)!=2146435072&&(o[C+8+4>>2]&2146435072|0)!=2146435072?(rc(C,D,z),D=mr(z,D)|0,C=Qt()|0):(C=0,D=0),On(C|0),Vt=R,D|0}function po(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(ee=z+4|0,le=ki(C|0,D|0,52)|0,Qt()|0,le=le&15,oe=ki(C|0,D|0,45)|0,Qt()|0,R=(le|0)==0,N(oe&127)|0){if(R)return oe=1,oe|0;R=1}else{if(R)return oe=0,oe|0;!(o[ee>>2]|0)&&!(o[z+8>>2]|0)?R=(o[z+12>>2]|0)!=0&1:R=1}for(z=1;z&1?Zo(ee):Ls(ee),oe=ki(C|0,D|0,(15-z|0)*3|0)|0,Qt()|0,Il(ee,oe&7),z>>>0<le>>>0;)z=z+1|0;return R|0}function ea(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0;Ct=Vt,Vt=Vt+16|0,We=Ct,vt=ki(C|0,D|0,45)|0,Qt()|0,vt=vt&127;e:do if(N(vt)|0&&(le=ki(C|0,D|0,52)|0,Qt()|0,le=le&15,(le|0)!=0)){R=1;t:for(;;){switch(we=ki(C|0,D|0,(15-R|0)*3|0)|0,Qt()|0,we&7){case 5:break t;case 0:break;default:{R=D;break e}}if(R>>>0<le>>>0)R=R+1|0;else{R=D;break e}}for(ee=1,R=D;D=(15-ee|0)*3|0,oe=Bi(7,0,D|0)|0,we=R&~(Qt()|0),R=ki(C|0,R|0,D|0)|0,Qt()|0,R=Bi($s(R&7)|0,0,D|0)|0,C=C&~oe|R,R=we|(Qt()|0),ee>>>0<le>>>0;)ee=ee+1|0}else R=D;while(!1);if(we=7728+(vt*28|0)|0,o[z>>2]=o[we>>2],o[z+4>>2]=o[we+4>>2],o[z+8>>2]=o[we+8>>2],o[z+12>>2]=o[we+12>>2],!(po(C,R,z)|0)){Vt=Ct;return}if(oe=z+4|0,o[We>>2]=o[oe>>2],o[We+4>>2]=o[oe+4>>2],o[We+8>>2]=o[oe+8>>2],le=ki(C|0,R|0,52)|0,Qt()|0,we=le&15,le&1?(Ls(oe),le=we+1|0):le=we,!(N(vt)|0))R=0;else{e:do if(!we)R=0;else for(D=1;;){if(ee=ki(C|0,R|0,(15-D|0)*3|0)|0,Qt()|0,ee=ee&7,ee|0){R=ee;break e}if(D>>>0<we>>>0)D=D+1|0;else{R=0;break}}while(!1);R=(R|0)==4&1}if(!(Io(z,le,R,0)|0))(le|0)!=(we|0)&&(o[oe>>2]=o[We>>2],o[oe+4>>2]=o[We+4>>2],o[oe+8>>2]=o[We+8>>2]);else{if(N(vt)|0)do;while(Io(z,le,0,0)|0);(le|0)!=(we|0)&&So(oe)}Vt=Ct}function Sa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,ea(C,D,ee),D=ki(C|0,D|0,52)|0,Qt()|0,ql(ee,D&15,z),Vt=R}function ka(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;oe=Vt,Vt=Vt+16|0,le=oe,ea(C,D,le),R=ki(C|0,D|0,45)|0,Qt()|0,R=(N(R&127)|0)==0,ee=ki(C|0,D|0,52)|0,Qt()|0,ee=ee&15;e:do if(!R){if(ee|0)for(R=1;;){if(we=Bi(7,0,(15-R|0)*3|0)|0,!((we&C|0)==0&((Qt()|0)&D|0)==0))break e;if(R>>>0<ee>>>0)R=R+1|0;else break}Ro(le,ee,0,5,z),Vt=oe;return}while(!1);Xo(le,ee,0,6,z),Vt=oe}function Wa(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(R=ki(C|0,D|0,45)|0,Qt()|0,!(N(R&127)|0))return R=2,R|0;if(R=ki(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)return R=5,R|0;for(z=1;;){if(ee=Bi(7,0,(15-z|0)*3|0)|0,!((ee&C|0)==0&((Qt()|0)&D|0)==0)){z=2,C=6;break}if(z>>>0<R>>>0)z=z+1|0;else{z=5,C=6;break}}return(C|0)==6?z|0:0}function cl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0;ni=Vt,Vt=Vt+128|0,vt=ni+112|0,le=ni+96|0,Ct=ni,ee=ki(C|0,D|0,52)|0,Qt()|0,we=ee&15,o[vt>>2]=we,oe=ki(C|0,D|0,45)|0,Qt()|0,oe=oe&127;e:do if(N(oe)|0){if(we|0)for(R=1;;){if(We=Bi(7,0,(15-R|0)*3|0)|0,!((We&C|0)==0&((Qt()|0)&D|0)==0)){ee=0;break e}if(R>>>0<we>>>0)R=R+1|0;else break}if(ee&1)ee=1;else{We=Bi(we+1|0,0,52)|0,Ct=Qt()|0|D&-15728641,vt=Bi(7,0,(14-we|0)*3|0)|0,cl((We|C)&~vt,Ct&~(Qt()|0),z),Vt=ni;return}}else ee=0;while(!1);ea(C,D,le),ee?(Wo(le,vt,Ct),We=5):(Yo(le,vt,Ct),We=6);e:do if(N(oe)|0)if(!we)R=20;else for(R=1;;){if(oe=Bi(7,0,(15-R|0)*3|0)|0,!((oe&C|0)==0&((Qt()|0)&D|0)==0)){R=8;break e}if(R>>>0<we>>>0)R=R+1|0;else{R=20;break}}else R=8;while(!1);if(cs(z|0,-1,R|0)|0,ee){ee=0;do{for(le=Ct+(ee<<4)|0,Us(le,o[vt>>2]|0)|0,le=o[le>>2]|0,R=0;oe=z+(R<<2)|0,we=o[oe>>2]|0,!((we|0)==-1|(we|0)==(le|0));)R=R+1|0;o[oe>>2]=le,ee=ee+1|0}while((ee|0)!=(We|0))}else{ee=0;do{for(le=Ct+(ee<<4)|0,Io(le,o[vt>>2]|0,0,1)|0,le=o[le>>2]|0,R=0;oe=z+(R<<2)|0,we=o[oe>>2]|0,!((we|0)==-1|(we|0)==(le|0));)R=R+1|0;o[oe>>2]=le,ee=ee+1|0}while((ee|0)!=(We|0))}Vt=ni}function lu(){return 12}function gl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(Bi(C|0,0,52)|0,we=Qt()|0|134225919,(C|0)<1){R=0,z=0;do N(R)|0&&(Bi(R|0,0,45)|0,oe=we|(Qt()|0),C=D+(z<<3)|0,o[C>>2]=-1,o[C+4>>2]=oe,z=z+1|0),R=R+1|0;while((R|0)!=122);return}oe=0,z=0;do{if(N(oe)|0){for(Bi(oe|0,0,45)|0,R=1,ee=-1,le=we|(Qt()|0);We=Bi(7,0,(15-R|0)*3|0)|0,ee=ee&~We,le=le&~(Qt()|0),(R|0)!=(C|0);)R=R+1|0;We=D+(z<<3)|0,o[We>>2]=ee,o[We+4>>2]=le,z=z+1|0}oe=oe+1|0}while((oe|0)!=122)}function ro(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,vt=0;if(we=Vt,Vt=Vt+64|0,oe=we,(C|0)==(z|0)&(D|0)==(R|0)|(!1|(D&2013265920|0)!=134217728|(!1|(R&2013265920|0)!=134217728))||(ee=ki(C|0,D|0,52)|0,Qt()|0,ee=ee&15,le=ki(z|0,R|0,52)|0,Qt()|0,(ee|0)!=(le&15|0)))return oe=0,Vt=we,oe|0;if(le=ee+-1|0,ee>>>0>1&&(vt=Co(C,D,le)|0,We=Qt()|0,le=Co(z,R,le)|0,(vt|0)==(le|0)&(We|0)==(Qt()|0))&&(le=(ee^15)*3|0,ee=ki(C|0,D|0,le|0)|0,Qt()|0,ee=ee&7,le=ki(z|0,R|0,le|0)|0,Qt()|0,le=le&7,(ee|0)==0|(le|0)==0||(o[21136+(ee<<2)>>2]|0)==(le|0)||(o[21168+(ee<<2)>>2]|0)==(le|0)))return vt=1,Vt=we,vt|0;ee=oe,le=ee+56|0;do o[ee>>2]=0,ee=ee+4|0;while((ee|0)<(le|0));return Fa(C,D,1,oe),vt=oe,!((o[vt>>2]|0)==(z|0)&&(o[vt+4>>2]|0)==(R|0))&&(vt=oe+8|0,!((o[vt>>2]|0)==(z|0)&&(o[vt+4>>2]|0)==(R|0)))&&(vt=oe+16|0,!((o[vt>>2]|0)==(z|0)&&(o[vt+4>>2]|0)==(R|0)))&&(vt=oe+24|0,!((o[vt>>2]|0)==(z|0)&&(o[vt+4>>2]|0)==(R|0)))&&(vt=oe+32|0,!((o[vt>>2]|0)==(z|0)&&(o[vt+4>>2]|0)==(R|0)))&&(vt=oe+40|0,!((o[vt>>2]|0)==(z|0)&&(o[vt+4>>2]|0)==(R|0)))?(ee=oe+48|0,ee=((o[ee>>2]|0)==(z|0)?(o[ee+4>>2]|0)==(R|0):0)&1):ee=1,vt=ee,Vt=we,vt|0}function mi(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0;if(vt=Vt,Vt=Vt+16|0,oe=vt,!(ro(C,D,z,R)|0))return we=0,We=0,On(we|0),Vt=vt,We|0;for(we=D&-2130706433,ee=(hs(C,D)|0)==0,ee=ee?1:2;o[oe>>2]=0,Ct=Zn(C,D,ee,oe)|0,le=ee+1|0,!((Ct|0)==(z|0)&(Qt()|0)==(R|0));)if(le>>>0<7)ee=le;else{ee=0,C=0,We=6;break}return(We|0)==6?(On(ee|0),Vt=vt,C|0):(Ct=Bi(ee|0,0,56)|0,We=we|(Qt()|0)|268435456,Ct=C|Ct,On(We|0),Vt=vt,Ct|0)}function Vi(C,D){C=C|0,D=D|0;var z=0;return z=!0&(D&2013265920|0)==268435456,On((z?D&-2130706433|134217728:0)|0),(z?C:0)|0}function Di(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return R=Vt,Vt=Vt+16|0,z=R,!0&(D&2013265920|0)==268435456?(ee=ki(C|0,D|0,56)|0,Qt()|0,o[z>>2]=0,z=Zn(C,D&-2130706433|134217728,ee&7,z)|0,D=Qt()|0,On(D|0),Vt=R,z|0):(D=0,z=0,On(D|0),Vt=R,z|0)}function Ft(C,D){C=C|0,D=D|0;var z=0;if(!(!0&(D&2013265920|0)==268435456))return z=0,z|0;switch(z=ki(C|0,D|0,56)|0,Qt()|0,z&7){case 0:case 7:return z=0,z|0}return z=D&-2130706433|134217728,!0&(D&117440512|0)==16777216&(hs(C,z)|0)!=0?(z=0,z|0):(z=Yr(C,z)|0,z|0)}function ti(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;le=Vt,Vt=Vt+16|0,R=le,oe=!0&(D&2013265920|0)==268435456,ee=D&-2130706433|134217728,we=z,o[we>>2]=oe?C:0,o[we+4>>2]=oe?ee:0,oe?(D=ki(C|0,D|0,56)|0,Qt()|0,o[R>>2]=0,C=Zn(C,ee,D&7,R)|0,D=Qt()|0):(C=0,D=0),we=z+8|0,o[we>>2]=C,o[we+4>>2]=D,Vt=le}function xi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;ee=(hs(C,D)|0)==0,D=D&-2130706433,R=z,o[R>>2]=ee?C:0,o[R+4>>2]=ee?D|285212672:0,R=z+8|0,o[R>>2]=C,o[R+4>>2]=D|301989888,R=z+16|0,o[R>>2]=C,o[R+4>>2]=D|318767104,R=z+24|0,o[R>>2]=C,o[R+4>>2]=D|335544320,R=z+32|0,o[R>>2]=C,o[R+4>>2]=D|352321536,z=z+40|0,o[z>>2]=C,o[z+4>>2]=D|369098752}function Fi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0;if(oe=Vt,Vt=Vt+16|0,le=oe,R=ki(C|0,D|0,56)|0,Qt()|0,we=!0&(D&2013265920|0)==268435456,ee=we?C:0,C=we?D&-2130706433|134217728:0,D=jl(ee,C,R&7)|0,(D|0)==-1){o[z>>2]=0,Vt=oe;return}ea(ee,C,le),R=ki(ee|0,C|0,52)|0,Qt()|0,R=R&15,hs(ee,C)|0?Ro(le,R,D,2,z):Xo(le,R,D,2,z),Vt=oe}function Ln(C){C=C|0;var D=0,z=0,R=0;return D=tl(1,12)|0,D||Yi(22691,22646,49,22704),z=C+4|0,R=o[z>>2]|0,R|0?(R=R+8|0,o[R>>2]=D,o[z>>2]=D,D|0):(o[C>>2]|0&&Yi(22721,22646,61,22744),R=C,o[R>>2]=D,o[z>>2]=D,D|0)}function Hn(C,D){C=C|0,D=D|0;var z=0,R=0;return R=jn(24)|0,R||Yi(22758,22646,78,22772),o[R>>2]=o[D>>2],o[R+4>>2]=o[D+4>>2],o[R+8>>2]=o[D+8>>2],o[R+12>>2]=o[D+12>>2],o[R+16>>2]=0,D=C+4|0,z=o[D>>2]|0,z|0?(o[z+16>>2]=R,o[D>>2]=R,R|0):(o[C>>2]|0&&Yi(22787,22646,82,22772),o[C>>2]=R,o[D>>2]=R,R|0)}function lr(C){C=C|0;var D=0,z=0,R=0,ee=0;if(C)for(R=1;;){if(D=o[C>>2]|0,D|0)do{if(z=o[D>>2]|0,z|0)do ee=z,z=o[z+16>>2]|0,Jn(ee);while(z|0);ee=D,D=o[D+8>>2]|0,Jn(ee)}while(D|0);if(D=C,C=o[C+8>>2]|0,R||Jn(D),C)R=0;else break}}function Yn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0;if(ee=C+8|0,o[ee>>2]|0)return Se=1,Se|0;if(R=o[C>>2]|0,!R)return Se=0,Se|0;D=R,z=0;do z=z+1|0,D=o[D+8>>2]|0;while(D|0);if(z>>>0<2)return Se=0,Se|0;Y=jn(z<<2)|0,Y||Yi(22807,22646,317,22826),j=jn(z<<5)|0,j||Yi(22848,22646,321,22826),o[C>>2]=0,r=C+4|0,o[r>>2]=0,o[ee>>2]=0,z=0,B=0,i=0,ni=0;e:for(;;){if(Ct=o[R>>2]|0,Ct){le=0,oe=Ct;do{if(We=+ke[oe+8>>3],D=oe,oe=o[oe+16>>2]|0,vt=(oe|0)==0,ee=vt?Ct:oe,we=+ke[ee+8>>3],+Ai(+(We-we))>3.141592653589793){Se=14;break}le=le+(we-We)*(+ke[D>>3]+ +ke[ee>>3])}while(!vt);if((Se|0)==14){Se=0,le=0,D=Ct;do s=+ke[D+8>>3],T=D+16|0,w=o[T>>2]|0,w=w|0?w:Ct,y=+ke[w+8>>3],le=le+(+ke[D>>3]+ +ke[w>>3])*((y<0?y+6.283185307179586:y)-(s<0?s+6.283185307179586:s)),D=o[(D|0?T:R)>>2]|0;while(D|0)}le>0?(o[Y+(B<<2)>>2]=R,B=B+1|0,ee=i,D=ni):Se=19}else Se=19;if((Se|0)==19){Se=0;do if(z){if(D=z+8|0,o[D>>2]|0){Se=21;break e}if(z=tl(1,12)|0,!z){Se=23;break e}o[D>>2]=z,ee=z+4|0,oe=z,D=ni}else if(ni){ee=r,oe=ni+8|0,D=R,z=C;break}else if(o[C>>2]|0){Se=27;break e}else{ee=r,oe=C,D=R,z=C;break}while(!1);if(o[oe>>2]=R,o[ee>>2]=R,oe=j+(i<<5)|0,vt=o[R>>2]|0,vt){for(Ct=j+(i<<5)+8|0,ke[Ct>>3]=17976931348623157e292,ni=j+(i<<5)+24|0,ke[ni>>3]=17976931348623157e292,ke[oe>>3]=-17976931348623157e292,Gt=j+(i<<5)+16|0,ke[Gt>>3]=-17976931348623157e292,F=17976931348623157e292,O=-17976931348623157e292,ee=0,jt=vt,We=17976931348623157e292,A=17976931348623157e292,E=-17976931348623157e292,we=-17976931348623157e292;le=+ke[jt>>3],s=+ke[jt+8>>3],jt=o[jt+16>>2]|0,Z=(jt|0)==0,y=+ke[(Z?vt:jt)+8>>3],le<We&&(ke[Ct>>3]=le,We=le),s<A&&(ke[ni>>3]=s,A=s),le>E?ke[oe>>3]=le:le=E,s>we&&(ke[Gt>>3]=s,we=s),F=s>0&s<F?s:F,O=s<0&s>O?s:O,ee=ee|+Ai(+(s-y))>3.141592653589793,!Z;)E=le;ee&&(ke[Gt>>3]=O,ke[ni>>3]=F)}else o[oe>>2]=0,o[oe+4>>2]=0,o[oe+8>>2]=0,o[oe+12>>2]=0,o[oe+16>>2]=0,o[oe+20>>2]=0,o[oe+24>>2]=0,o[oe+28>>2]=0;ee=i+1|0}if(T=R+8|0,R=o[T>>2]|0,o[T>>2]=0,R)i=ee,ni=D;else{Se=45;break}}if((Se|0)==21)Yi(22624,22646,35,22658);else if((Se|0)==23)Yi(22678,22646,37,22658);else if((Se|0)==27)Yi(22721,22646,61,22744);else if((Se|0)==45){e:do if((B|0)>0){for(T=(ee|0)==0,_=ee<<2,w=(C|0)==0,d=0,D=0;;){if(l=o[Y+(d<<2)>>2]|0,T)Se=73;else{if(i=jn(_)|0,!i){Se=50;break}if(r=jn(_)|0,!r){Se=52;break}t:do if(w)z=0;else{for(ee=0,z=0,oe=C;R=j+(ee<<5)|0,qs(o[oe>>2]|0,R,o[l>>2]|0)|0?(o[i+(z<<2)>>2]=oe,o[r+(z<<2)>>2]=R,Z=z+1|0):Z=z,oe=o[oe+8>>2]|0,oe;)ee=ee+1|0,z=Z;if((Z|0)>0)if(R=o[i>>2]|0,(Z|0)==1)z=R;else for(Gt=0,jt=-1,z=R,ni=R;;){for(vt=o[ni>>2]|0,R=0,oe=0;ee=o[o[i+(oe<<2)>>2]>>2]|0,(ee|0)==(vt|0)?Ct=R:Ct=R+((qs(ee,o[r+(oe<<2)>>2]|0,o[vt>>2]|0)|0)&1)|0,oe=oe+1|0,(oe|0)!=(Z|0);)R=Ct;if(ee=(Ct|0)>(jt|0),z=ee?ni:z,R=Gt+1|0,(R|0)==(Z|0))break t;Gt=R,jt=ee?Ct:jt,ni=o[i+(R<<2)>>2]|0}else z=0}while(!1);if(Jn(i),Jn(r),z){if(ee=z+4|0,R=o[ee>>2]|0,R)z=R+8|0;else if(o[z>>2]|0){Se=70;break}o[z>>2]=l,o[ee>>2]=l}else Se=73}if((Se|0)==73){if(Se=0,D=o[l>>2]|0,D|0)do r=D,D=o[D+16>>2]|0,Jn(r);while(D|0);Jn(l),D=2}if(d=d+1|0,(d|0)>=(B|0)){ce=D;break e}}(Se|0)==50?Yi(22863,22646,249,22882):(Se|0)==52?Yi(22901,22646,252,22882):(Se|0)==70&&Yi(22721,22646,61,22744)}else ce=0;while(!1);return Jn(Y),Jn(j),Se=ce,Se|0}return 0}function qs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0;if(!(Ua(D,z)|0)||(D=Or(D)|0,vt=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,C=o[C>>2]|0,!C))return C=0,C|0;if(D){D=0,z=C;e:for(;;){for(;oe=+ke[z>>3],We=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(vt<le|vt>we);)if(z=o[z>>2]|0,!z){z=22;break e}if(We=ee<0?ee+6.283185307179586:ee,oe=oe<0?oe+6.283185307179586:oe,R=oe==R|We==R?R+-2220446049250313e-31:R,We=We+(vt-le)/(we-le)*(oe-We),(We<0?We+6.283185307179586:We)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}else{D=0,z=C;e:for(;;){for(;oe=+ke[z>>3],We=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(vt<le|vt>we);)if(z=o[z>>2]|0,!z){z=22;break e}if(R=oe==R|ee==R?R+-2220446049250313e-31:R,ee+(vt-le)/(we-le)*(oe-ee)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}return 0}function ks(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0;if(O=Vt,Vt=Vt+32|0,F=O+16|0,E=O,le=ki(C|0,D|0,52)|0,Qt()|0,le=le&15,jt=ki(z|0,R|0,52)|0,Qt()|0,(le|0)!=(jt&15|0))return F=1,Vt=O,F|0;if(vt=ki(C|0,D|0,45)|0,Qt()|0,vt=vt&127,Ct=ki(z|0,R|0,45)|0,Qt()|0,Ct=Ct&127,jt=(vt|0)!=(Ct|0),jt){if(we=fn(vt,Ct)|0,(we|0)==7)return F=2,Vt=O,F|0;We=fn(Ct,vt)|0,(We|0)==7?Yi(22925,22949,151,22959):(Z=we,oe=We)}else Z=0,oe=0;ni=N(vt)|0,Gt=N(Ct)|0,o[F>>2]=0,o[F+4>>2]=0,o[F+8>>2]=0,o[F+12>>2]=0;do if(Z){if(Ct=o[4304+(vt*28|0)+(Z<<2)>>2]|0,we=(Ct|0)>0,Gt)if(we){vt=0,We=z,we=R;do We=Jo(We,we)|0,we=Qt()|0,oe=$s(oe)|0,(oe|0)==1&&(oe=$s(1)|0),vt=vt+1|0;while((vt|0)!=(Ct|0));Ct=oe,vt=We,We=we}else Ct=oe,vt=z,We=R;else if(we){vt=0,We=z,we=R;do We=$r(We,we)|0,we=Qt()|0,oe=$s(oe)|0,vt=vt+1|0;while((vt|0)!=(Ct|0));Ct=oe,vt=We,We=we}else Ct=oe,vt=z,We=R;if(po(vt,We,F)|0,jt||Yi(22972,22949,181,22959),we=(ni|0)!=0,oe=(Gt|0)!=0,we&oe&&Yi(22999,22949,182,22959),we){if(oe=Js(C,D)|0,kt[22032+(oe*7|0)+Z>>0]|0){le=3;break}We=o[21200+(oe*28|0)+(Z<<2)>>2]|0,vt=We,A=26}else if(oe){if(oe=Js(vt,We)|0,kt[22032+(oe*7|0)+Ct>>0]|0){le=4;break}vt=0,We=o[21200+(Ct*28|0)+(oe<<2)>>2]|0,A=26}else oe=0;if((A|0)==26)if((We|0)<=-1&&Yi(23030,22949,212,22959),(vt|0)<=-1&&Yi(23053,22949,213,22959),(We|0)>0){we=F+4|0,oe=0;do Qo(we),oe=oe+1|0;while((oe|0)!=(We|0));oe=vt}else oe=vt;if(o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,Il(E,Z),le|0)for(;Nr(le)|0?Zo(E):Ls(E),(le|0)>1;)le=le+-1|0;if((oe|0)>0){le=0;do Qo(E),le=le+1|0;while((le|0)!=(oe|0))}A=F+4|0,Dr(A,E,A),nr(A),A=50}else if(po(z,R,F)|0,(ni|0)!=0&(Gt|0)!=0)if((Ct|0)!=(vt|0)&&Yi(23077,22949,243,22959),oe=Js(C,D)|0,le=Js(z,R)|0,kt[22032+(oe*7|0)+le>>0]|0)le=5;else if(oe=o[21200+(oe*28|0)+(le<<2)>>2]|0,(oe|0)>0){we=F+4|0,le=0;do Qo(we),le=le+1|0;while((le|0)!=(oe|0));A=50}else A=50;else A=50;while(!1);return(A|0)==50&&(le=F+4|0,o[ee>>2]=o[le>>2],o[ee+4>>2]=o[le+4>>2],o[ee+8>>2]=o[le+8>>2],le=0),F=le,Vt=O,F|0}function As(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0;if(Z=Vt,Vt=Vt+48|0,oe=Z+36|0,we=Z+24|0,We=Z+12|0,vt=Z,le=ki(C|0,D|0,52)|0,Qt()|0,le=le&15,Gt=ki(C|0,D|0,45)|0,Qt()|0,Gt=Gt&127,Ct=N(Gt)|0,Bi(le|0,0,52)|0,E=Qt()|0|134225919,A=R,o[A>>2]=-1,o[A+4>>2]=E,!le)return(o[z>>2]|0)>1||(o[z+4>>2]|0)>1||(o[z+8>>2]|0)>1||(ee=cn(Gt,Ks(z)|0)|0,(ee|0)==127)?(E=1,Vt=Z,E|0):(jt=Bi(ee|0,0,45)|0,A=Qt()|0,Gt=R,A=o[Gt+4>>2]&-1040385|A,E=R,o[E>>2]=o[Gt>>2]|jt,o[E+4>>2]=A,E=0,Vt=Z,E|0);for(o[oe>>2]=o[z>>2],o[oe+4>>2]=o[z+4>>2],o[oe+8>>2]=o[z+8>>2];o[we>>2]=o[oe>>2],o[we+4>>2]=o[oe+4>>2],o[we+8>>2]=o[oe+8>>2],Nr(le)|0?(Lr(oe),o[We>>2]=o[oe>>2],o[We+4>>2]=o[oe+4>>2],o[We+8>>2]=o[oe+8>>2],Zo(We)):(So(oe),o[We>>2]=o[oe>>2],o[We+4>>2]=o[oe+4>>2],o[We+8>>2]=o[oe+8>>2],Ls(We)),js(we,We,vt),nr(vt),A=R,F=o[A>>2]|0,A=o[A+4>>2]|0,O=(15-le|0)*3|0,z=Bi(7,0,O|0)|0,A=A&~(Qt()|0),O=Bi(Ks(vt)|0,0,O|0)|0,A=Qt()|0|A,E=R,o[E>>2]=O|F&~z,o[E+4>>2]=A,(le|0)>1;)le=le+-1|0;e:do if((o[oe>>2]|0)<=1&&(o[oe+4>>2]|0)<=1&&(o[oe+8>>2]|0)<=1){le=Ks(oe)|0,we=cn(Gt,le)|0,(we|0)==127?vt=0:vt=N(we)|0;t:do if(le){if(Ct){if(oe=21408+((Js(C,D)|0)*28|0)+(le<<2)|0,oe=o[oe>>2]|0,(oe|0)>0){z=0;do le=ca(le)|0,z=z+1|0;while((z|0)!=(oe|0))}if((le|0)==1){ee=3;break e}z=cn(Gt,le)|0,(z|0)==127&&Yi(23104,22949,376,23134),N(z)|0?Yi(23147,22949,377,23134):(jt=oe,ni=le,ee=z)}else jt=0,ni=le,ee=we;if(We=o[4304+(Gt*28|0)+(ni<<2)>>2]|0,(We|0)<=-1&&Yi(23178,22949,384,23134),!vt){if((jt|0)<=-1&&Yi(23030,22949,417,23134),jt|0){oe=R,le=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;do z=Qa(z,oe)|0,oe=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,le=le+1|0;while((le|0)<(jt|0))}if((We|0)<=0){le=54;break}for(oe=R,le=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;;)if(z=Qa(z,oe)|0,oe=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,le=le+1|0,(le|0)==(We|0)){le=54;break t}}if(we=fn(ee,Gt)|0,(we|0)==7&&Yi(22925,22949,393,23134),le=R,z=o[le>>2]|0,le=o[le+4>>2]|0,(We|0)>0){oe=0;do z=Qa(z,le)|0,le=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=le,oe=oe+1|0;while((oe|0)!=(We|0))}if(z=Js(z,le)|0,O=xe(ee)|0,z=o[(O?21824:21616)+(we*28|0)+(z<<2)>>2]|0,(z|0)<=-1&&Yi(23030,22949,412,23134),!z)le=54;else{we=R,le=0,oe=o[we>>2]|0,we=o[we+4>>2]|0;do oe=Gs(oe,we)|0,we=Qt()|0,O=R,o[O>>2]=oe,o[O+4>>2]=we,le=le+1|0;while((le|0)<(z|0));le=54}}else if((Ct|0)!=0&(vt|0)!=0)if(O=Js(C,D)|0,le=R,le=21408+(O*28|0)+((Js(o[le>>2]|0,o[le+4>>2]|0)|0)<<2)|0,le=o[le>>2]|0,(le|0)<=-1&&Yi(23201,22949,433,23134),!le)ee=we,le=55;else{oe=R,ee=0,z=o[oe>>2]|0,oe=o[oe+4>>2]|0;do z=Qa(z,oe)|0,oe=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=oe,ee=ee+1|0;while((ee|0)<(le|0));ee=we,le=54}else ee=we,le=54;while(!1);if((le|0)==54&&vt&&(le=55),(le|0)==55&&(O=R,(Js(o[O>>2]|0,o[O+4>>2]|0)|0)==1)){ee=4;break}O=R,E=o[O>>2]|0,O=o[O+4>>2]&-1040385,F=Bi(ee|0,0,45)|0,O=O|(Qt()|0),ee=R,o[ee>>2]=E|F,o[ee+4>>2]=O,ee=0}else ee=2;while(!1);return O=ee,Vt=Z,O|0}function Xa(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0;return oe=Vt,Vt=Vt+16|0,le=oe,C=ks(C,D,z,R,le)|0,C||(ml(le,ee),C=0),Vt=oe,C|0}function mo(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return ee=Vt,Vt=Vt+16|0,le=ee,Cl(z,le),R=As(C,D,le,R)|0,Vt=ee,R|0}function rs(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0;return oe=Vt,Vt=Vt+32|0,ee=oe+12|0,le=oe,!(ks(C,D,C,D,ee)|0)&&!(ks(C,D,z,R,le)|0)?C=Ta(ee,le)|0:C=-1,Vt=oe,C|0}function Qu(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,oe=0;return oe=Vt,Vt=Vt+32|0,ee=oe+12|0,le=oe,!(ks(C,D,C,D,ee)|0)&&!(ks(C,D,z,R,le)|0)?C=Ta(ee,le)|0:C=-1,Vt=oe,(C>>>31^1)+C|0}function Ru(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0;if(i=Vt,Vt=Vt+48|0,le=i+24|0,oe=i+12|0,s=i,!(ks(C,D,C,D,le)|0)&&!(ks(C,D,z,R,oe)|0)){if(y=Ta(le,oe)|0,(y|0)<0)return s=y,Vt=i,s|0;for(o[le>>2]=0,o[le+4>>2]=0,o[le+8>>2]=0,o[oe>>2]=0,o[oe+4>>2]=0,o[oe+8>>2]=0,ks(C,D,C,D,le)|0,ks(C,D,z,R,oe)|0,mu(le),mu(oe),y?(Ct=o[le>>2]|0,jt=+(y|0),E=le+4|0,ni=o[E>>2]|0,F=le+8|0,Gt=o[F>>2]|0,O=le,z=Ct,R=ni,le=Gt,Z=+((o[oe>>2]|0)-Ct|0)/jt,A=+((o[oe+4>>2]|0)-ni|0)/jt,jt=+((o[oe+8>>2]|0)-Gt|0)/jt):(R=le+4|0,Gt=le+8|0,E=R,F=Gt,O=le,z=o[le>>2]|0,R=o[R>>2]|0,le=o[Gt>>2]|0,Z=0,A=0,jt=0),o[s>>2]=z,Gt=s+4|0,o[Gt>>2]=R,ni=s+8|0,o[ni>>2]=le,Ct=0;;){We=+(Ct|0),r=Z*We+ +(z|0),we=A*We+ +(o[E>>2]|0),We=jt*We+ +(o[F>>2]|0),R=~~+vu(+r),oe=~~+vu(+we),z=~~+vu(+We),r=+Ai(+(+(R|0)-r)),we=+Ai(+(+(oe|0)-we)),We=+Ai(+(+(z|0)-We));do if(r>we&r>We)R=0-(oe+z)|0,le=oe;else if(vt=0-R|0,we>We){le=vt-z|0;break}else{le=oe,z=vt-oe|0;break}while(!1);if(o[s>>2]=R,o[Gt>>2]=le,o[ni>>2]=z,us(s),As(C,D,s,ee+(Ct<<3)|0)|0,(Ct|0)==(y|0))break;Ct=Ct+1|0,z=o[O>>2]|0}return s=0,Vt=i,s|0}return s=-1,Vt=i,s|0}function go(C,D){C=C|0,D=D|0;var z=0;if(!D)return z=1,z|0;z=C,C=1;do C=jr(D&1|0?z:1,C)|0,D=D>>1,z=jr(z,z)|0;while(D|0);return C|0}function Ml(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0;if(!(Ua(D,z)|0)||(D=Or(D)|0,Gt=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,ni=o[C>>2]|0,(ni|0)<=0))return ni=0,ni|0;if(Ct=o[C+4>>2]|0,D){D=0,z=-1,C=0;e:for(;;){for(vt=C;oe=+ke[Ct+(vt<<4)>>3],We=+ke[Ct+(vt<<4)+8>>3],C=(z+2|0)%(ni|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(Gt<le|Gt>we);)if(z=vt+1|0,(z|0)<(ni|0))C=vt,vt=z,z=C;else{z=22;break e}if(We=ee<0?ee+6.283185307179586:ee,oe=oe<0?oe+6.283185307179586:oe,R=oe==R|We==R?R+-2220446049250313e-31:R,We=We+(Gt-le)/(we-le)*(oe-We),(We<0?We+6.283185307179586:We)>R&&(D=D^1),C=vt+1|0,(C|0)>=(ni|0)){z=22;break}else z=vt}if((z|0)==22)return D|0}else{D=0,z=-1,C=0;e:for(;;){for(vt=C;oe=+ke[Ct+(vt<<4)>>3],We=+ke[Ct+(vt<<4)+8>>3],C=(z+2|0)%(ni|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],oe>le?(we=oe,oe=We):(we=le,le=oe,oe=ee,ee=We),!!(Gt<le|Gt>we);)if(z=vt+1|0,(z|0)<(ni|0))C=vt,vt=z,z=C;else{z=22;break e}if(R=oe==R|ee==R?R+-2220446049250313e-31:R,ee+(Gt-le)/(we-le)*(oe-ee)>R&&(D=D^1),C=vt+1|0,(C|0)>=(ni|0)){z=22;break}else z=vt}if((z|0)==22)return D|0}return 0}function Pn(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0;if(Z=o[C>>2]|0,!Z){o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;return}if(A=D+8|0,ke[A>>3]=17976931348623157e292,E=D+24|0,ke[E>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,!((Z|0)<=0)){for(Gt=o[C+4>>2]|0,vt=17976931348623157e292,Ct=-17976931348623157e292,ni=0,C=-1,le=17976931348623157e292,oe=17976931348623157e292,We=-17976931348623157e292,R=-17976931348623157e292,jt=0;z=+ke[Gt+(jt<<4)>>3],we=+ke[Gt+(jt<<4)+8>>3],C=C+2|0,ee=+ke[Gt+(((C|0)==(Z|0)?0:C)<<4)+8>>3],z<le&&(ke[A>>3]=z,le=z),we<oe&&(ke[E>>3]=we,oe=we),z>We?ke[D>>3]=z:z=We,we>R&&(ke[F>>3]=we,R=we),vt=we>0&we<vt?we:vt,Ct=we<0&we>Ct?we:Ct,ni=ni|+Ai(+(we-ee))>3.141592653589793,C=jt+1|0,(C|0)!=(Z|0);)O=jt,We=z,jt=C,C=O;ni&&(ke[F>>3]=Ct,ke[E>>3]=vt)}}function Ma(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0;if(Z=o[C>>2]|0,Z){if(A=D+8|0,ke[A>>3]=17976931348623157e292,E=D+24|0,ke[E>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,(Z|0)>0){for(ee=o[C+4>>2]|0,Gt=17976931348623157e292,jt=-17976931348623157e292,R=0,z=-1,We=17976931348623157e292,vt=17976931348623157e292,ni=-17976931348623157e292,oe=-17976931348623157e292,O=0;le=+ke[ee+(O<<4)>>3],Ct=+ke[ee+(O<<4)+8>>3],r=z+2|0,we=+ke[ee+(((r|0)==(Z|0)?0:r)<<4)+8>>3],le<We&&(ke[A>>3]=le,We=le),Ct<vt&&(ke[E>>3]=Ct,vt=Ct),le>ni?ke[D>>3]=le:le=ni,Ct>oe&&(ke[F>>3]=Ct,oe=Ct),Gt=Ct>0&Ct<Gt?Ct:Gt,jt=Ct<0&Ct>jt?Ct:jt,R=R|+Ai(+(Ct-we))>3.141592653589793,z=O+1|0,(z|0)!=(Z|0);)r=O,ni=le,O=z,z=r;R&&(ke[F>>3]=jt,ke[E>>3]=Gt)}}else o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;if(r=C+8|0,z=o[r>>2]|0,!((z|0)<=0)){i=C+12|0,s=0;do if(ee=o[i>>2]|0,R=s,s=s+1|0,E=D+(s<<5)|0,F=o[ee+(R<<3)>>2]|0,F){if(O=D+(s<<5)+8|0,ke[O>>3]=17976931348623157e292,C=D+(s<<5)+24|0,ke[C>>3]=17976931348623157e292,ke[E>>3]=-17976931348623157e292,y=D+(s<<5)+16|0,ke[y>>3]=-17976931348623157e292,(F|0)>0){for(Z=o[ee+(R<<3)+4>>2]|0,Gt=17976931348623157e292,jt=-17976931348623157e292,ee=0,R=-1,A=0,We=17976931348623157e292,vt=17976931348623157e292,Ct=-17976931348623157e292,oe=-17976931348623157e292;le=+ke[Z+(A<<4)>>3],ni=+ke[Z+(A<<4)+8>>3],R=R+2|0,we=+ke[Z+(((R|0)==(F|0)?0:R)<<4)+8>>3],le<We&&(ke[O>>3]=le,We=le),ni<vt&&(ke[C>>3]=ni,vt=ni),le>Ct?ke[E>>3]=le:le=Ct,ni>oe&&(ke[y>>3]=ni,oe=ni),Gt=ni>0&ni<Gt?ni:Gt,jt=ni<0&ni>jt?ni:jt,ee=ee|+Ai(+(ni-we))>3.141592653589793,R=A+1|0,(R|0)!=(F|0);)l=A,A=R,Ct=le,R=l;ee&&(ke[y>>3]=jt,ke[C>>3]=Gt)}}else o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,o[E+12>>2]=0,o[E+16>>2]=0,o[E+20>>2]=0,o[E+24>>2]=0,o[E+28>>2]=0,z=o[r>>2]|0;while((s|0)<(z|0))}}function Sn(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if(!(Ml(C,D,z)|0))return ee=0,ee|0;if(ee=C+8|0,(o[ee>>2]|0)<=0)return ee=1,ee|0;for(R=C+12|0,C=0;;){if(le=C,C=C+1|0,Ml((o[R>>2]|0)+(le<<3)|0,D+(C<<5)|0,z)|0){C=0,R=6;break}if((C|0)>=(o[ee>>2]|0)){C=1,R=6;break}}return(R|0)==6?C|0:0}function Fo(){return 8}function Nl(){return 16}function En(){return 168}function Hl(){return 8}function Cn(){return 16}function _l(){return 12}function uu(){return 8}function Fu(C){C=C|0;var D=0,z=0;return z=+ke[C>>3],D=+ke[C+8>>3],+ +Jt(+(z*z+D*D))}function Vl(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0;vt=+ke[C>>3],We=+ke[D>>3]-vt,we=+ke[C+8>>3],oe=+ke[D+8>>3]-we,ni=+ke[z>>3],le=+ke[R>>3]-ni,Gt=+ke[z+8>>3],Ct=+ke[R+8>>3]-Gt,le=(le*(we-Gt)-(vt-ni)*Ct)/(We*Ct-oe*le),ke[ee>>3]=vt+We*le,ke[ee+8>>3]=we+oe*le}function yl(C,D){return C=C|0,D=D|0,+ke[C>>3]!=+ke[D>>3]?(D=0,D|0):(D=+ke[C+8>>3]==+ke[D+8>>3],D|0)}function ta(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return ee=+ke[C>>3]-+ke[D>>3],R=+ke[C+8>>3]-+ke[D+8>>3],z=+ke[C+16>>3]-+ke[D+16>>3],+(ee*ee+R*R+z*z)}function sc(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;z=+ke[C>>3],R=+zi(+z),z=+vi(+z),ke[D+16>>3]=z,z=+ke[C+8>>3],ee=R*+zi(+z),ke[D>>3]=ee,z=R*+vi(+z),ke[D+8>>3]=z}function Wu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0;if(vt=Vt,Vt=Vt+32|0,ee=vt+16|0,le=vt,ea(C,D,ee),oe=ll(C,D)|0,We=Js(C,D)|0,Wt(oe,le),D=Ii(oe,o[ee>>2]|0)|0,!(N(oe)|0))return We=D,Vt=vt,We|0;do switch(oe|0){case 4:{C=0,z=14;break}case 14:{C=1,z=14;break}case 24:{C=2,z=14;break}case 38:{C=3,z=14;break}case 49:{C=4,z=14;break}case 58:{C=5,z=14;break}case 63:{C=6,z=14;break}case 72:{C=7,z=14;break}case 83:{C=8,z=14;break}case 97:{C=9,z=14;break}case 107:{C=10,z=14;break}case 117:{C=11,z=14;break}default:we=0,R=0}while(!1);return(z|0)==14&&(we=o[22096+(C*24|0)+8>>2]|0,R=o[22096+(C*24|0)+16>>2]|0),C=o[ee>>2]|0,(C|0)!=(o[le>>2]|0)&&(oe=xe(oe)|0,C=o[ee>>2]|0,oe|(C|0)==(R|0)&&(D=(D+1|0)%6|0)),(We|0)==3&(C|0)==(R|0)?(We=(D+5|0)%6|0,Vt=vt,We|0):(We|0)==5&(C|0)==(we|0)?(We=(D+1|0)%6|0,Vt=vt,We|0):(We=D,Vt=vt,We|0)}function jl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;return R=hs(C,D)|0,(z+-1|0)>>>0>5||(ee=(R|0)!=0,(z|0)==1&ee)?(z=-1,z|0):(R=Wu(C,D)|0,ee?(z=(5-R+(o[22384+(z<<2)>>2]|0)|0)%5|0,z|0):(z=(6-R+(o[22416+(z<<2)>>2]|0)|0)%6|0,z|0))}function fs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0;(D|0)>0?(R=tl(D,4)|0,o[C>>2]=R,R||Yi(23230,23253,40,23267)):o[C>>2]=0,o[C+4>>2]=D,o[C+8>>2]=0,o[C+12>>2]=z}function _a(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0;ee=C+4|0,le=C+12|0,oe=C+8|0;e:for(;;){for(z=o[ee>>2]|0,D=0;;){if((D|0)>=(z|0))break e;if(R=o[C>>2]|0,we=o[R+(D<<2)>>2]|0,!we)D=D+1|0;else break}D=R+(~~(+Ai(+(+li(10,+ +(15-(o[le>>2]|0)|0))*(+ke[we>>3]+ +ke[we+8>>3])))%+(z|0))>>>0<<2)|0,z=o[D>>2]|0;t:do if(z|0){if(R=we+32|0,(z|0)==(we|0))o[D>>2]=o[R>>2];else{if(z=z+32|0,D=o[z>>2]|0,!D)break;for(;(D|0)!=(we|0);)if(z=D+32|0,D=o[z>>2]|0,!D)break t;o[z>>2]=o[R>>2]}Jn(we),o[oe>>2]=(o[oe>>2]|0)+-1}while(!1)}Jn(o[C>>2]|0)}function el(C){C=C|0;var D=0,z=0,R=0;for(R=o[C+4>>2]|0,z=0;;){if((z|0)>=(R|0)){D=0,z=4;break}if(D=o[(o[C>>2]|0)+(z<<2)>>2]|0,!D)z=z+1|0;else{z=4;break}}return(z|0)==4?D|0:0}function _u(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;if(z=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,z=(o[C>>2]|0)+(z<<2)|0,R=o[z>>2]|0,!R)return le=1,le|0;le=D+32|0;do if((R|0)!=(D|0)){if(z=o[R+32>>2]|0,!z)return le=1,le|0;for(ee=z;;){if((ee|0)==(D|0)){ee=8;break}if(z=o[ee+32>>2]|0,z)R=ee,ee=z;else{z=1,ee=10;break}}if((ee|0)==8){o[R+32>>2]=o[le>>2];break}else if((ee|0)==10)return z|0}else o[z>>2]=o[le>>2];while(!1);return Jn(D),le=C+8|0,o[le>>2]=(o[le>>2]|0)+-1,le=0,le|0}function Ou(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;le=jn(40)|0,le||Yi(23283,23253,98,23296),o[le>>2]=o[D>>2],o[le+4>>2]=o[D+4>>2],o[le+8>>2]=o[D+8>>2],o[le+12>>2]=o[D+12>>2],ee=le+16|0,o[ee>>2]=o[z>>2],o[ee+4>>2]=o[z+4>>2],o[ee+8>>2]=o[z+8>>2],o[ee+12>>2]=o[z+12>>2],o[le+32>>2]=0,ee=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=(o[C>>2]|0)+(ee<<2)|0,R=o[ee>>2]|0;do if(!R)o[ee>>2]=le;else{for(;!(ba(R,D)|0&&ba(R+16|0,z)|0);)if(ee=o[R+32>>2]|0,R=ee|0?ee:R,!(o[R+32>>2]|0)){oe=10;break}if((oe|0)==10){o[R+32>>2]=le;break}return Jn(le),oe=R,oe|0}while(!1);return oe=C+8|0,o[oe>>2]=(o[oe>>2]|0)+1,oe=le,oe|0}function cu(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(ee=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=o[(o[C>>2]|0)+(ee<<2)>>2]|0,!ee)return z=0,z|0;if(!z){for(C=ee;;){if(ba(C,D)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}if((R|0)==10)return C|0}for(C=ee;;){if(ba(C,D)|0&&ba(C+16|0,z)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}return(R|0)==10?C|0:0}function Nu(C,D){C=C|0,D=D|0;var z=0;if(z=~~(+Ai(+(+li(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,C=o[(o[C>>2]|0)+(z<<2)>>2]|0,!C)return z=0,z|0;for(;;){if(ba(C,D)|0){D=5;break}if(C=o[C+32>>2]|0,!C){C=0,D=5;break}}return(D|0)==5?C|0:0}function _r(){return 23312}function ds(C){return C=+C,+ +hl(+C)}function gn(C){return C=+C,~~+ds(C)|0}function jn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0,A=0,E=0,F=0,O=0,y=0,s=0,i=0;i=Vt,Vt=Vt+16|0,Gt=i;do if(C>>>0<245){if(vt=C>>>0<11?16:C+11&-8,C=vt>>>3,ni=o[5829]|0,z=ni>>>C,z&3|0)return D=(z&1^1)+C|0,C=23356+(D<<1<<2)|0,z=C+8|0,R=o[z>>2]|0,ee=R+8|0,le=o[ee>>2]|0,(le|0)==(C|0)?o[5829]=ni&~(1<<D):(o[le+12>>2]=C,o[z>>2]=le),s=D<<3,o[R+4>>2]=s|3,s=R+s+4|0,o[s>>2]=o[s>>2]|1,s=ee,Vt=i,s|0;if(Ct=o[5831]|0,vt>>>0>Ct>>>0){if(z|0)return D=2<<C,D=z<<C&(D|0-D),D=(D&0-D)+-1|0,we=D>>>12&16,D=D>>>we,z=D>>>5&8,D=D>>>z,le=D>>>2&4,D=D>>>le,C=D>>>1&2,D=D>>>C,R=D>>>1&1,R=(z|we|le|C|R)+(D>>>R)|0,D=23356+(R<<1<<2)|0,C=D+8|0,le=o[C>>2]|0,we=le+8|0,z=o[we>>2]|0,(z|0)==(D|0)?(C=ni&~(1<<R),o[5829]=C):(o[z+12>>2]=D,o[C>>2]=z,C=ni),s=R<<3,oe=s-vt|0,o[le+4>>2]=vt|3,ee=le+vt|0,o[ee+4>>2]=oe|1,o[le+s>>2]=oe,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=oe,o[5834]=ee,s=we,Vt=i,s|0;if(le=o[5830]|0,le){for(z=(le&0-le)+-1|0,ee=z>>>12&16,z=z>>>ee,R=z>>>5&8,z=z>>>R,oe=z>>>2&4,z=z>>>oe,we=z>>>1&2,z=z>>>we,We=z>>>1&1,We=o[23620+((R|ee|oe|we|We)+(z>>>We)<<2)>>2]|0,z=We,we=We,We=(o[We+4>>2]&-8)-vt|0;C=o[z+16>>2]|0,!(!C&&(C=o[z+20>>2]|0,!C));)oe=(o[C+4>>2]&-8)-vt|0,ee=oe>>>0<We>>>0,z=C,we=ee?C:we,We=ee?oe:We;if(oe=we+vt|0,oe>>>0>we>>>0){ee=o[we+24>>2]|0,D=o[we+12>>2]|0;do if((D|0)==(we|0)){if(C=we+20|0,D=o[C>>2]|0,!D&&(C=we+16|0,D=o[C>>2]|0,!D)){z=0;break}for(;;)if(R=D+20|0,z=o[R>>2]|0,z)D=z,C=R;else if(R=D+16|0,z=o[R>>2]|0,z)D=z,C=R;else break;o[C>>2]=0,z=D}else z=o[we+8>>2]|0,o[z+12>>2]=D,o[D+8>>2]=z,z=D;while(!1);do if(ee|0){if(D=o[we+28>>2]|0,C=23620+(D<<2)|0,(we|0)==(o[C>>2]|0)){if(o[C>>2]=z,!z){o[5830]=le&~(1<<D);break}}else if(s=ee+16|0,o[((o[s>>2]|0)==(we|0)?s:ee+20|0)>>2]=z,!z)break;o[z+24>>2]=ee,D=o[we+16>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),D=o[we+20>>2]|0,D|0&&(o[z+20>>2]=D,o[D+24>>2]=z)}while(!1);return We>>>0<16?(s=We+vt|0,o[we+4>>2]=s|3,s=we+s+4|0,o[s>>2]=o[s>>2]|1):(o[we+4>>2]=vt|3,o[oe+4>>2]=We|1,o[oe+We>>2]=We,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,D&ni?(C=z+8|0,D=o[C>>2]|0):(o[5829]=D|ni,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=We,o[5834]=oe),s=we+8|0,Vt=i,s|0}else ni=vt}else ni=vt}else ni=vt}else if(C>>>0<=4294967231)if(C=C+11|0,vt=C&-8,R=o[5830]|0,R){ee=0-vt|0,C=C>>>8,C?vt>>>0>16777215?We=31:(ni=(C+1048320|0)>>>16&8,A=C<<ni,we=(A+520192|0)>>>16&4,A=A<<we,We=(A+245760|0)>>>16&2,We=14-(we|ni|We)+(A<<We>>>15)|0,We=vt>>>(We+7|0)&1|We<<1):We=0,z=o[23620+(We<<2)>>2]|0;e:do if(!z)z=0,C=0,A=61;else for(C=0,we=vt<<((We|0)==31?0:25-(We>>>1)|0),le=0;;){if(oe=(o[z+4>>2]&-8)-vt|0,oe>>>0<ee>>>0)if(oe)C=z,ee=oe;else{C=z,ee=0,A=65;break e}if(A=o[z+20>>2]|0,z=o[z+16+(we>>>31<<2)>>2]|0,le=(A|0)==0|(A|0)==(z|0)?le:A,z)we=we<<1;else{z=le,A=61;break}}while(!1);if((A|0)==61){if((z|0)==0&(C|0)==0){if(C=2<<We,C=(C|0-C)&R,!C){ni=vt;break}ni=(C&0-C)+-1|0,oe=ni>>>12&16,ni=ni>>>oe,le=ni>>>5&8,ni=ni>>>le,we=ni>>>2&4,ni=ni>>>we,We=ni>>>1&2,ni=ni>>>We,z=ni>>>1&1,C=0,z=o[23620+((le|oe|we|We|z)+(ni>>>z)<<2)>>2]|0}z?A=65:(we=C,oe=ee)}if((A|0)==65)for(le=z;;)if(ni=(o[le+4>>2]&-8)-vt|0,z=ni>>>0<ee>>>0,ee=z?ni:ee,C=z?le:C,z=o[le+16>>2]|0,z||(z=o[le+20>>2]|0),z)le=z;else{we=C,oe=ee;break}if(we|0&&oe>>>0<((o[5831]|0)-vt|0)>>>0&&(Ct=we+vt|0,Ct>>>0>we>>>0)){le=o[we+24>>2]|0,D=o[we+12>>2]|0;do if((D|0)==(we|0)){if(C=we+20|0,D=o[C>>2]|0,!D&&(C=we+16|0,D=o[C>>2]|0,!D)){D=0;break}for(;;)if(ee=D+20|0,z=o[ee>>2]|0,z)D=z,C=ee;else if(ee=D+16|0,z=o[ee>>2]|0,z)D=z,C=ee;else break;o[C>>2]=0}else s=o[we+8>>2]|0,o[s+12>>2]=D,o[D+8>>2]=s;while(!1);do if(le){if(C=o[we+28>>2]|0,z=23620+(C<<2)|0,(we|0)==(o[z>>2]|0)){if(o[z>>2]=D,!D){R=R&~(1<<C),o[5830]=R;break}}else if(s=le+16|0,o[((o[s>>2]|0)==(we|0)?s:le+20|0)>>2]=D,!D)break;o[D+24>>2]=le,C=o[we+16>>2]|0,C|0&&(o[D+16>>2]=C,o[C+24>>2]=D),C=o[we+20>>2]|0,C&&(o[D+20>>2]=C,o[C+24>>2]=D)}while(!1);e:do if(oe>>>0<16)s=oe+vt|0,o[we+4>>2]=s|3,s=we+s+4|0,o[s>>2]=o[s>>2]|1;else{if(o[we+4>>2]=vt|3,o[Ct+4>>2]=oe|1,o[Ct+oe>>2]=oe,D=oe>>>3,oe>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=Ct,o[D+12>>2]=Ct,o[Ct+8>>2]=D,o[Ct+12>>2]=z;break}if(D=oe>>>8,D?oe>>>0>16777215?z=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,z=(s+245760|0)>>>16&2,z=14-(O|y|z)+(s<<z>>>15)|0,z=oe>>>(z+7|0)&1|z<<1):z=0,D=23620+(z<<2)|0,o[Ct+28>>2]=z,C=Ct+16|0,o[C+4>>2]=0,o[C>>2]=0,C=1<<z,!(R&C)){o[5830]=R|C,o[D>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break}D=o[D>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(oe|0)){for(R=oe<<((z|0)==31?0:25-(z>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(oe|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=Ct,o[y>>2]=Ct,o[Ct+8>>2]=s,o[Ct+12>>2]=D,o[Ct+24>>2]=0}while(!1);return s=we+8|0,Vt=i,s|0}else ni=vt}else ni=vt;else ni=-1;while(!1);if(z=o[5831]|0,z>>>0>=ni>>>0)return D=z-ni|0,C=o[5834]|0,D>>>0>15?(s=C+ni|0,o[5834]=s,o[5831]=D,o[s+4>>2]=D|1,o[C+z>>2]=D,o[C+4>>2]=ni|3):(o[5831]=0,o[5834]=0,o[C+4>>2]=z|3,s=C+z+4|0,o[s>>2]=o[s>>2]|1),s=C+8|0,Vt=i,s|0;if(oe=o[5832]|0,oe>>>0>ni>>>0)return O=oe-ni|0,o[5832]=O,s=o[5835]|0,y=s+ni|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ni|3,s=s+8|0,Vt=i,s|0;if(o[5947]|0?C=o[5949]|0:(o[5949]=4096,o[5948]=4096,o[5950]=-1,o[5951]=-1,o[5952]=0,o[5940]=0,o[5947]=Gt&-16^1431655768,C=4096),we=ni+48|0,We=ni+47|0,le=C+We|0,ee=0-C|0,vt=le&ee,vt>>>0<=ni>>>0||(C=o[5939]|0,C|0&&(Ct=o[5937]|0,Gt=Ct+vt|0,Gt>>>0<=Ct>>>0|Gt>>>0>C>>>0)))return s=0,Vt=i,s|0;e:do if(o[5940]&4)D=0,A=143;else{z=o[5835]|0;t:do if(z){for(R=23764;Gt=o[R>>2]|0,!(Gt>>>0<=z>>>0&&(Gt+(o[R+4>>2]|0)|0)>>>0>z>>>0);)if(C=o[R+8>>2]|0,C)R=C;else{A=128;break t}if(D=le-oe&ee,D>>>0<2147483647)if(C=Ms(D|0)|0,(C|0)==((o[R>>2]|0)+(o[R+4>>2]|0)|0)){if((C|0)!=-1){oe=D,le=C,A=145;break e}}else R=C,A=136;else D=0}else A=128;while(!1);do if((A|0)==128)if(z=Ms(0)|0,(z|0)!=-1&&(D=z,jt=o[5948]|0,Z=jt+-1|0,D=(Z&D|0?(Z+D&0-jt)-D|0:0)+vt|0,jt=o[5937]|0,Z=D+jt|0,D>>>0>ni>>>0&D>>>0<2147483647)){if(Gt=o[5939]|0,Gt|0&&Z>>>0<=jt>>>0|Z>>>0>Gt>>>0){D=0;break}if(C=Ms(D|0)|0,(C|0)==(z|0)){oe=D,le=z,A=145;break e}else R=C,A=136}else D=0;while(!1);do if((A|0)==136){if(z=0-D|0,!(we>>>0>D>>>0&(D>>>0<2147483647&(R|0)!=-1)))if((R|0)==-1){D=0;break}else{oe=D,le=R,A=145;break e}if(C=o[5949]|0,C=We-D+C&0-C,C>>>0>=2147483647){oe=D,le=R,A=145;break e}if((Ms(C|0)|0)==-1){Ms(z|0)|0,D=0;break}else{oe=C+D|0,le=R,A=145;break e}}while(!1);o[5940]=o[5940]|4,A=143}while(!1);if((A|0)==143&&vt>>>0<2147483647&&(O=Ms(vt|0)|0,Z=Ms(0)|0,E=Z-O|0,F=E>>>0>(ni+40|0)>>>0,!((O|0)==-1|F^1|O>>>0<Z>>>0&((O|0)!=-1&(Z|0)!=-1)^1))&&(oe=F?E:D,le=O,A=145),(A|0)==145){D=(o[5937]|0)+oe|0,o[5937]=D,D>>>0>(o[5938]|0)>>>0&&(o[5938]=D),We=o[5835]|0;e:do if(We){for(D=23764;;){if(C=o[D>>2]|0,z=o[D+4>>2]|0,(le|0)==(C+z|0)){A=154;break}if(R=o[D+8>>2]|0,R)D=R;else break}if((A|0)==154&&(y=D+4|0,(o[D+12>>2]&8|0)==0)&&le>>>0>We>>>0&C>>>0<=We>>>0){o[y>>2]=z+oe,s=(o[5832]|0)+oe|0,O=We+8|0,O=O&7|0?0-O&7:0,y=We+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[We+s+4>>2]=40,o[5836]=o[5951];break}for(le>>>0<(o[5833]|0)>>>0&&(o[5833]=le),z=le+oe|0,D=23764;;){if((o[D>>2]|0)==(z|0)){A=162;break}if(C=o[D+8>>2]|0,C)D=C;else break}if((A|0)==162&&!(o[D+12>>2]&8|0)){o[D>>2]=le,Ct=D+4|0,o[Ct>>2]=(o[Ct>>2]|0)+oe,Ct=le+8|0,Ct=le+(Ct&7|0?0-Ct&7:0)|0,D=z+8|0,D=z+(D&7|0?0-D&7:0)|0,vt=Ct+ni|0,we=D-Ct-ni|0,o[Ct+4>>2]=ni|3;t:do if((We|0)==(D|0))s=(o[5832]|0)+we|0,o[5832]=s,o[5835]=vt,o[vt+4>>2]=s|1;else{if((o[5834]|0)==(D|0)){s=(o[5831]|0)+we|0,o[5831]=s,o[5834]=vt,o[vt+4>>2]=s|1,o[vt+s>>2]=s;break}if(C=o[D+4>>2]|0,(C&3|0)==1){oe=C&-8,R=C>>>3;i:do if(C>>>0<256)if(C=o[D+8>>2]|0,z=o[D+12>>2]|0,(z|0)==(C|0)){o[5829]=o[5829]&~(1<<R);break}else{o[C+12>>2]=z,o[z+8>>2]=C;break}else{le=o[D+24>>2]|0,C=o[D+12>>2]|0;do if((C|0)==(D|0)){if(z=D+16|0,R=z+4|0,C=o[R>>2]|0,C)z=R;else if(C=o[z>>2]|0,!C){C=0;break}for(;;)if(ee=C+20|0,R=o[ee>>2]|0,R)C=R,z=ee;else if(ee=C+16|0,R=o[ee>>2]|0,R)C=R,z=ee;else break;o[z>>2]=0}else s=o[D+8>>2]|0,o[s+12>>2]=C,o[C+8>>2]=s;while(!1);if(!le)break;z=o[D+28>>2]|0,R=23620+(z<<2)|0;do if((o[R>>2]|0)!=(D|0)){if(s=le+16|0,o[((o[s>>2]|0)==(D|0)?s:le+20|0)>>2]=C,!C)break i}else{if(o[R>>2]=C,C|0)break;o[5830]=o[5830]&~(1<<z);break i}while(!1);if(o[C+24>>2]=le,z=D+16|0,R=o[z>>2]|0,R|0&&(o[C+16>>2]=R,o[R+24>>2]=C),z=o[z+4>>2]|0,!z)break;o[C+20>>2]=z,o[z+24>>2]=C}while(!1);D=D+oe|0,ee=oe+we|0}else ee=we;if(D=D+4|0,o[D>>2]=o[D>>2]&-2,o[vt+4>>2]=ee|1,o[vt+ee>>2]=ee,D=ee>>>3,ee>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=vt,o[D+12>>2]=vt,o[vt+8>>2]=D,o[vt+12>>2]=z;break}D=ee>>>8;do if(!D)R=0;else{if(ee>>>0>16777215){R=31;break}y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1}while(!1);if(D=23620+(R<<2)|0,o[vt+28>>2]=R,C=vt+16|0,o[C+4>>2]=0,o[C>>2]=0,C=o[5830]|0,z=1<<R,!(C&z)){o[5830]=C|z,o[D>>2]=vt,o[vt+24>>2]=D,o[vt+12>>2]=vt,o[vt+8>>2]=vt;break}D=o[D>>2]|0;i:do if((o[D+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(ee|0)){D=C;break i}else R=R<<1,D=C;o[z>>2]=vt,o[vt+24>>2]=D,o[vt+12>>2]=vt,o[vt+8>>2]=vt;break t}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=vt,o[y>>2]=vt,o[vt+8>>2]=s,o[vt+12>>2]=D,o[vt+24>>2]=0}while(!1);return s=Ct+8|0,Vt=i,s|0}for(D=23764;C=o[D>>2]|0,!(C>>>0<=We>>>0&&(s=C+(o[D+4>>2]|0)|0,s>>>0>We>>>0));)D=o[D+8>>2]|0;ee=s+-47|0,C=ee+8|0,C=ee+(C&7|0?0-C&7:0)|0,ee=We+16|0,C=C>>>0<ee>>>0?We:C,D=C+8|0,z=oe+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=z-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+z+4>>2]=40,o[5836]=o[5951],z=C+4|0,o[z>>2]=27,o[D>>2]=o[5941],o[D+4>>2]=o[5942],o[D+8>>2]=o[5943],o[D+12>>2]=o[5944],o[5941]=le,o[5942]=oe,o[5944]=0,o[5943]=D,D=C+24|0;do y=D,D=D+4|0,o[D>>2]=7;while((y+8|0)>>>0<s>>>0);if((C|0)!=(We|0)){if(le=C-We|0,o[z>>2]=o[z>>2]&-2,o[We+4>>2]=le|1,o[C>>2]=le,D=le>>>3,le>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=We,o[D+12>>2]=We,o[We+8>>2]=D,o[We+12>>2]=z;break}if(D=le>>>8,D?le>>>0>16777215?R=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=le>>>(R+7|0)&1|R<<1):R=0,z=23620+(R<<2)|0,o[We+28>>2]=R,o[We+20>>2]=0,o[ee>>2]=0,D=o[5830]|0,C=1<<R,!(D&C)){o[5830]=D|C,o[z>>2]=We,o[We+24>>2]=z,o[We+12>>2]=We,o[We+8>>2]=We;break}D=o[z>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(le|0)){for(R=le<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(le|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=We,o[We+24>>2]=D,o[We+12>>2]=We,o[We+8>>2]=We;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=We,o[y>>2]=We,o[We+8>>2]=s,o[We+12>>2]=D,o[We+24>>2]=0}}else s=o[5833]|0,(s|0)==0|le>>>0<s>>>0&&(o[5833]=le),o[5941]=le,o[5942]=oe,o[5944]=0,o[5838]=o[5947],o[5837]=-1,o[5842]=23356,o[5841]=23356,o[5844]=23364,o[5843]=23364,o[5846]=23372,o[5845]=23372,o[5848]=23380,o[5847]=23380,o[5850]=23388,o[5849]=23388,o[5852]=23396,o[5851]=23396,o[5854]=23404,o[5853]=23404,o[5856]=23412,o[5855]=23412,o[5858]=23420,o[5857]=23420,o[5860]=23428,o[5859]=23428,o[5862]=23436,o[5861]=23436,o[5864]=23444,o[5863]=23444,o[5866]=23452,o[5865]=23452,o[5868]=23460,o[5867]=23460,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,s=oe+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+s+4>>2]=40,o[5836]=o[5951];while(!1);if(D=o[5832]|0,D>>>0>ni>>>0)return O=D-ni|0,o[5832]=O,s=o[5835]|0,y=s+ni|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ni|3,s=s+8|0,Vt=i,s|0}return s=_r()|0,o[s>>2]=12,s=0,Vt=i,s|0}function Jn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,oe=0,we=0,We=0;if(C){z=C+-8|0,ee=o[5833]|0,C=o[C+-4>>2]|0,D=C&-8,We=z+D|0;do if(C&1)we=z,oe=z;else{if(R=o[z>>2]|0,!(C&3)||(oe=z+(0-R)|0,le=R+D|0,oe>>>0<ee>>>0))return;if((o[5834]|0)==(oe|0)){if(C=We+4|0,D=o[C>>2]|0,(D&3|0)!=3){we=oe,D=le;break}o[5831]=le,o[C>>2]=D&-2,o[oe+4>>2]=le|1,o[oe+le>>2]=le;return}if(z=R>>>3,R>>>0<256)if(C=o[oe+8>>2]|0,D=o[oe+12>>2]|0,(D|0)==(C|0)){o[5829]=o[5829]&~(1<<z),we=oe,D=le;break}else{o[C+12>>2]=D,o[D+8>>2]=C,we=oe,D=le;break}ee=o[oe+24>>2]|0,C=o[oe+12>>2]|0;do if((C|0)==(oe|0)){if(D=oe+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){C=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0}else we=o[oe+8>>2]|0,o[we+12>>2]=C,o[C+8>>2]=we;while(!1);if(ee){if(D=o[oe+28>>2]|0,z=23620+(D<<2)|0,(o[z>>2]|0)==(oe|0)){if(o[z>>2]=C,!C){o[5830]=o[5830]&~(1<<D),we=oe,D=le;break}}else if(we=ee+16|0,o[((o[we>>2]|0)==(oe|0)?we:ee+20|0)>>2]=C,!C){we=oe,D=le;break}o[C+24>>2]=ee,D=oe+16|0,z=o[D>>2]|0,z|0&&(o[C+16>>2]=z,o[z+24>>2]=C),D=o[D+4>>2]|0,D?(o[C+20>>2]=D,o[D+24>>2]=C,we=oe,D=le):(we=oe,D=le)}else we=oe,D=le}while(!1);if(!(oe>>>0>=We>>>0)&&(C=We+4|0,R=o[C>>2]|0,!!(R&1))){if(R&2)o[C>>2]=R&-2,o[we+4>>2]=D|1,o[oe+D>>2]=D,ee=D;else{if((o[5835]|0)==(We|0)){if(We=(o[5832]|0)+D|0,o[5832]=We,o[5835]=we,o[we+4>>2]=We|1,(we|0)!=(o[5834]|0))return;o[5834]=0,o[5831]=0;return}if((o[5834]|0)==(We|0)){We=(o[5831]|0)+D|0,o[5831]=We,o[5834]=oe,o[we+4>>2]=We|1,o[oe+We>>2]=We;return}ee=(R&-8)+D|0,z=R>>>3;do if(R>>>0<256)if(D=o[We+8>>2]|0,C=o[We+12>>2]|0,(C|0)==(D|0)){o[5829]=o[5829]&~(1<<z);break}else{o[D+12>>2]=C,o[C+8>>2]=D;break}else{le=o[We+24>>2]|0,C=o[We+12>>2]|0;do if((C|0)==(We|0)){if(D=We+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){z=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0,z=C}else z=o[We+8>>2]|0,o[z+12>>2]=C,o[C+8>>2]=z,z=C;while(!1);if(le|0){if(C=o[We+28>>2]|0,D=23620+(C<<2)|0,(o[D>>2]|0)==(We|0)){if(o[D>>2]=z,!z){o[5830]=o[5830]&~(1<<C);break}}else if(R=le+16|0,o[((o[R>>2]|0)==(We|0)?R:le+20|0)>>2]=z,!z)break;o[z+24>>2]=le,C=We+16|0,D=o[C>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),C=o[C+4>>2]|0,C|0&&(o[z+20>>2]=C,o[C+24>>2]=z)}}while(!1);if(o[we+4>>2]=ee|1,o[oe+ee>>2]=ee,(we|0)==(o[5834]|0)){o[5831]=ee;return}}if(C=ee>>>3,ee>>>0<256){z=23356+(C<<1<<2)|0,D=o[5829]|0,C=1<<C,D&C?(D=z+8|0,C=o[D>>2]|0):(o[5829]=D|C,C=z,D=z+8|0),o[D>>2]=we,o[C+12>>2]=we,o[we+8>>2]=C,o[we+12>>2]=z;return}C=ee>>>8,C?ee>>>0>16777215?R=31:(oe=(C+1048320|0)>>>16&8,We=C<<oe,le=(We+520192|0)>>>16&4,We=We<<le,R=(We+245760|0)>>>16&2,R=14-(le|oe|R)+(We<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1):R=0,C=23620+(R<<2)|0,o[we+28>>2]=R,o[we+20>>2]=0,o[we+16>>2]=0,D=o[5830]|0,z=1<<R;e:do if(!(D&z))o[5830]=D|z,o[C>>2]=we,o[we+24>>2]=C,o[we+12>>2]=we,o[we+8>>2]=we;else{C=o[C>>2]|0;t:do if((o[C+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=C+16+(R>>>31<<2)|0,D=o[z>>2]|0,!!D;)if((o[D+4>>2]&-8|0)==(ee|0)){C=D;break t}else R=R<<1,C=D;o[z>>2]=we,o[we+24>>2]=C,o[we+12>>2]=we,o[we+8>>2]=we;break e}while(!1);oe=C+8|0,We=o[oe>>2]|0,o[We+12>>2]=we,o[oe>>2]=we,o[we+8>>2]=We,o[we+12>>2]=C,o[we+24>>2]=0}while(!1);if(We=(o[5837]|0)+-1|0,o[5837]=We,!(We|0)){for(C=23772;C=o[C>>2]|0,C;)C=C+8|0;o[5837]=-1}}}}function tl(C,D){C=C|0,D=D|0;var z=0;return C?(z=jr(D,C)|0,(D|C)>>>0>65535&&(z=((z>>>0)/(C>>>0)|0|0)==(D|0)?z:-1)):z=0,C=jn(z)|0,!C||!(o[C+-4>>2]&3)||cs(C|0,0,z|0)|0,C|0}function Tu(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,z=C+z>>>0,On(D+R+(z>>>0<C>>>0|0)>>>0|0),z|0|0}function oa(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,R=D-R-(z>>>0>C>>>0|0)>>>0,On(R|0),C-z>>>0|0|0}function yu(C){return C=C|0,(C?31-(ur(C^C-1)|0)|0:32)|0}function vs(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,oe=0,we=0,We=0,vt=0,Ct=0,ni=0,Gt=0,jt=0,Z=0;if(Ct=C,We=D,vt=We,oe=z,Gt=R,we=Gt,!vt)return le=(ee|0)!=0,we?le?(o[ee>>2]=C|0,o[ee+4>>2]=D&0,Gt=0,ee=0,On(Gt|0),ee|0):(Gt=0,ee=0,On(Gt|0),ee|0):(le&&(o[ee>>2]=(Ct>>>0)%(oe>>>0),o[ee+4>>2]=0),Gt=0,ee=(Ct>>>0)/(oe>>>0)>>>0,On(Gt|0),ee|0);le=(we|0)==0;do if(oe){if(!le){if(le=(ur(we|0)|0)-(ur(vt|0)|0)|0,le>>>0<=31){ni=le+1|0,we=31-le|0,D=le-31>>31,oe=ni,C=Ct>>>(ni>>>0)&D|vt<<we,D=vt>>>(ni>>>0)&D,le=0,we=Ct<<we;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=We|D&0,Gt=0,ee=0,On(Gt|0),ee|0):(Gt=0,ee=0,On(Gt|0),ee|0)}if(le=oe-1|0,le&oe|0){we=(ur(oe|0)|0)+33-(ur(vt|0)|0)|0,Z=64-we|0,ni=32-we|0,We=ni>>31,jt=we-32|0,D=jt>>31,oe=we,C=ni-1>>31&vt>>>(jt>>>0)|(vt<<ni|Ct>>>(we>>>0))&D,D=D&vt>>>(we>>>0),le=Ct<<Z&We,we=(vt<<Z|Ct>>>(jt>>>0))&We|Ct<<ni&we-33>>31;break}return ee|0&&(o[ee>>2]=le&Ct,o[ee+4>>2]=0),(oe|0)==1?(jt=We|D&0,Z=C|0|0,On(jt|0),Z|0):(Z=yu(oe|0)|0,jt=vt>>>(Z>>>0)|0,Z=vt<<32-Z|Ct>>>(Z>>>0)|0,On(jt|0),Z|0)}else{if(le)return ee|0&&(o[ee>>2]=(vt>>>0)%(oe>>>0),o[ee+4>>2]=0),jt=0,Z=(vt>>>0)/(oe>>>0)>>>0,On(jt|0),Z|0;if(!Ct)return ee|0&&(o[ee>>2]=0,o[ee+4>>2]=(vt>>>0)%(we>>>0)),jt=0,Z=(vt>>>0)/(we>>>0)>>>0,On(jt|0),Z|0;if(le=we-1|0,!(le&we))return ee|0&&(o[ee>>2]=C|0,o[ee+4>>2]=le&vt|D&0),jt=0,Z=vt>>>((yu(we|0)|0)>>>0),On(jt|0),Z|0;if(le=(ur(we|0)|0)-(ur(vt|0)|0)|0,le>>>0<=30){D=le+1|0,we=31-le|0,oe=D,C=vt<<we|Ct>>>(D>>>0),D=vt>>>(D>>>0),le=0,we=Ct<<we;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=We|D&0,jt=0,Z=0,On(jt|0),Z|0):(jt=0,Z=0,On(jt|0),Z|0)}while(!1);if(!oe)vt=we,We=0,we=0;else{ni=z|0|0,Ct=Gt|R&0,vt=Tu(ni|0,Ct|0,-1,-1)|0,z=Qt()|0,We=we,we=0;do R=We,We=le>>>31|We<<1,le=we|le<<1,R=C<<1|R>>>31|0,Gt=C>>>31|D<<1|0,oa(vt|0,z|0,R|0,Gt|0)|0,Z=Qt()|0,jt=Z>>31|((Z|0)<0?-1:0)<<1,we=jt&1,C=oa(R|0,Gt|0,jt&ni|0,(((Z|0)<0?-1:0)>>31|((Z|0)<0?-1:0)<<1)&Ct|0)|0,D=Qt()|0,oe=oe-1|0;while(oe|0);vt=We,We=0}return oe=0,ee|0&&(o[ee>>2]=C,o[ee+4>>2]=D),jt=(le|0)>>>31|(vt|oe)<<1|(oe<<1|le>>>31)&0|We,Z=(le<<1|0)&-2|we,On(jt|0),Z|0}function ko(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return le=Vt,Vt=Vt+16|0,ee=le|0,vs(C,D,z,R,ee)|0,Vt=le,On(o[ee+4>>2]|0),o[ee>>2]|0|0}function ki(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(On(D>>>z|0),C>>>z|(D&(1<<z)-1)<<32-z):(On(0),D>>>z-32|0)}function Bi(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(On(D<<z|(C&(1<<z)-1<<32-z)>>>32-z|0),C<<z):(On(C<<z-32|0),0)}function xs(C,D){return C=+C,D=+D,C!=C?+D:D!=D?+C:+Hi(+C,+D)}function vu(C){return C=+C,C>=0?+di(C+.5):+qn(C-.5)}function Oo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if((z|0)>=8192)return cr(C|0,D|0,z|0)|0,C|0;if(le=C|0,ee=C+z|0,(C&3)==(D&3)){for(;C&3;){if(!z)return le|0;kt[C>>0]=kt[D>>0]|0,C=C+1|0,D=D+1|0,z=z-1|0}for(z=ee&-4|0,R=z-64|0;(C|0)<=(R|0);)o[C>>2]=o[D>>2],o[C+4>>2]=o[D+4>>2],o[C+8>>2]=o[D+8>>2],o[C+12>>2]=o[D+12>>2],o[C+16>>2]=o[D+16>>2],o[C+20>>2]=o[D+20>>2],o[C+24>>2]=o[D+24>>2],o[C+28>>2]=o[D+28>>2],o[C+32>>2]=o[D+32>>2],o[C+36>>2]=o[D+36>>2],o[C+40>>2]=o[D+40>>2],o[C+44>>2]=o[D+44>>2],o[C+48>>2]=o[D+48>>2],o[C+52>>2]=o[D+52>>2],o[C+56>>2]=o[D+56>>2],o[C+60>>2]=o[D+60>>2],C=C+64|0,D=D+64|0;for(;(C|0)<(z|0);)o[C>>2]=o[D>>2],C=C+4|0,D=D+4|0}else for(z=ee-4|0;(C|0)<(z|0);)kt[C>>0]=kt[D>>0]|0,kt[C+1>>0]=kt[D+1>>0]|0,kt[C+2>>0]=kt[D+2>>0]|0,kt[C+3>>0]=kt[D+3>>0]|0,C=C+4|0,D=D+4|0;for(;(C|0)<(ee|0);)kt[C>>0]=kt[D>>0]|0,C=C+1|0,D=D+1|0;return le|0}function cs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,oe=0;if(le=C+z|0,D=D&255,(z|0)>=67){for(;C&3;)kt[C>>0]=D,C=C+1|0;for(R=le&-4|0,oe=D|D<<8|D<<16|D<<24,ee=R-64|0;(C|0)<=(ee|0);)o[C>>2]=oe,o[C+4>>2]=oe,o[C+8>>2]=oe,o[C+12>>2]=oe,o[C+16>>2]=oe,o[C+20>>2]=oe,o[C+24>>2]=oe,o[C+28>>2]=oe,o[C+32>>2]=oe,o[C+36>>2]=oe,o[C+40>>2]=oe,o[C+44>>2]=oe,o[C+48>>2]=oe,o[C+52>>2]=oe,o[C+56>>2]=oe,o[C+60>>2]=oe,C=C+64|0;for(;(C|0)<(R|0);)o[C>>2]=oe,C=C+4|0}for(;(C|0)<(le|0);)kt[C>>0]=D,C=C+1|0;return le-z|0}function hl(C){return C=+C,C>=0?+di(C+.5):+qn(C-.5)}function Ms(C){C=C|0;var D=0,z=0,R=0;return R=Tn()|0,z=o[oi>>2]|0,D=z+C|0,(C|0)>0&(D|0)<(z|0)|(D|0)<0?(Ur(D|0)|0,Ut(12),-1):(D|0)>(R|0)&&!(Ns(D|0)|0)?(Ut(12),-1):(o[oi>>2]=D,z|0)}return{___uremdi3:ko,_bitshift64Lshr:ki,_bitshift64Shl:Bi,_calloc:tl,_cellAreaKm2:Ol,_cellAreaM2:es,_cellAreaRads2:Un,_compact:Tl,_destroyLinkedPolygon:lr,_edgeLengthKm:Za,_edgeLengthM:Jr,_emscripten_replace_memory:hr,_exactEdgeLengthKm:Ts,_exactEdgeLengthM:kr,_exactEdgeLengthRads:Zr,_experimentalH3ToLocalIj:Xa,_experimentalLocalIjToH3:mo,_free:Jn,_geoToH3:ha,_getDestinationH3IndexFromUnidirectionalEdge:Di,_getH3IndexesFromUnidirectionalEdge:ti,_getH3UnidirectionalEdge:mi,_getH3UnidirectionalEdgeBoundary:Fi,_getH3UnidirectionalEdgesFromHexagon:xi,_getOriginH3IndexFromUnidirectionalEdge:Vi,_getPentagonIndexes:gl,_getRes0Indexes:Ar,_h3Distance:rs,_h3GetBaseCell:ll,_h3GetFaces:cl,_h3GetResolution:rr,_h3IndexesAreNeighbors:ro,_h3IsPentagon:hs,_h3IsResClassIII:fo,_h3IsValid:Yr,_h3Line:Ru,_h3LineSize:Qu,_h3SetToLinkedGeo:Va,_h3ToCenterChild:wa,_h3ToChildren:Qr,_h3ToGeo:Sa,_h3ToGeoBoundary:ka,_h3ToParent:Co,_h3UnidirectionalEdgeIsValid:Ft,_hexAreaKm2:Ko,_hexAreaM2:Br,_hexRing:aa,_i64Subtract:oa,_kRing:Fa,_kRingDistances:zo,_llvm_minnum_f64:xs,_llvm_round_f64:vu,_malloc:jn,_maxFaceCount:Wa,_maxH3ToChildrenSize:ul,_maxKringSize:Pr,_maxPolyfillSize:ls,_maxUncompactSize:kl,_memcpy:Oo,_memset:cs,_numHexagons:fr,_pentagonIndexCount:lu,_pointDistKm:Cs,_pointDistM:gu,_pointDistRads:ja,_polyfill:Na,_res0IndexCount:sr,_round:hl,_sbrk:Ms,_sizeOfCoordIJ:uu,_sizeOfGeoBoundary:En,_sizeOfGeoCoord:Nl,_sizeOfGeoPolygon:Cn,_sizeOfGeofence:Hl,_sizeOfH3Index:Fo,_sizeOfLinkedGeoPolygon:_l,_uncompact:To,establishStackSpace:ua,stackAlloc:Lt,stackRestore:Vs,stackSave:Fr}}(nt,Me,gt);t.___uremdi3=se.___uremdi3,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._compact=se._compact,t._destroyLinkedPolygon=se._destroyLinkedPolygon,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._exactEdgeLengthKm=se._exactEdgeLengthKm,t._exactEdgeLengthM=se._exactEdgeLengthM,t._exactEdgeLengthRads=se._exactEdgeLengthRads,t._experimentalH3ToLocalIj=se._experimentalH3ToLocalIj,t._experimentalLocalIjToH3=se._experimentalLocalIjToH3,t._free=se._free,t._geoToH3=se._geoToH3,t._getDestinationH3IndexFromUnidirectionalEdge=se._getDestinationH3IndexFromUnidirectionalEdge,t._getH3IndexesFromUnidirectionalEdge=se._getH3IndexesFromUnidirectionalEdge,t._getH3UnidirectionalEdge=se._getH3UnidirectionalEdge,t._getH3UnidirectionalEdgeBoundary=se._getH3UnidirectionalEdgeBoundary,t._getH3UnidirectionalEdgesFromHexagon=se._getH3UnidirectionalEdgesFromHexagon,t._getOriginH3IndexFromUnidirectionalEdge=se._getOriginH3IndexFromUnidirectionalEdge,t._getPentagonIndexes=se._getPentagonIndexes,t._getRes0Indexes=se._getRes0Indexes,t._h3Distance=se._h3Distance,t._h3GetBaseCell=se._h3GetBaseCell,t._h3GetFaces=se._h3GetFaces,t._h3GetResolution=se._h3GetResolution,t._h3IndexesAreNeighbors=se._h3IndexesAreNeighbors,t._h3IsPentagon=se._h3IsPentagon,t._h3IsResClassIII=se._h3IsResClassIII,t._h3IsValid=se._h3IsValid,t._h3Line=se._h3Line,t._h3LineSize=se._h3LineSize,t._h3SetToLinkedGeo=se._h3SetToLinkedGeo,t._h3ToCenterChild=se._h3ToCenterChild,t._h3ToChildren=se._h3ToChildren,t._h3ToGeo=se._h3ToGeo,t._h3ToGeoBoundary=se._h3ToGeoBoundary,t._h3ToParent=se._h3ToParent,t._h3UnidirectionalEdgeIsValid=se._h3UnidirectionalEdgeIsValid,t._hexAreaKm2=se._hexAreaKm2,t._hexAreaM2=se._hexAreaM2,t._hexRing=se._hexRing,t._i64Subtract=se._i64Subtract,t._kRing=se._kRing,t._kRingDistances=se._kRingDistances,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxH3ToChildrenSize=se._maxH3ToChildrenSize,t._maxKringSize=se._maxKringSize,t._maxPolyfillSize=se._maxPolyfillSize,t._maxUncompactSize=se._maxUncompactSize,t._memcpy=se._memcpy,t._memset=se._memset,t._numHexagons=se._numHexagons,t._pentagonIndexCount=se._pentagonIndexCount,t._pointDistKm=se._pointDistKm,t._pointDistM=se._pointDistM,t._pointDistRads=se._pointDistRads,t._polyfill=se._polyfill,t._res0IndexCount=se._res0IndexCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoBoundary=se._sizeOfGeoBoundary,t._sizeOfGeoCoord=se._sizeOfGeoCoord,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfGeofence=se._sizeOfGeofence,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompact=se._uncompact,t.establishStackSpace=se.establishStackSpace;var X=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=Tt,t.setValue=be,t.getValue=Ke,t.getTempRet0=ae,en){Fn(en)||(en=b(en));{Rr();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),dt.set(De,ue),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,hi()},ge=function(){I(en,ye,function(){throw"could not load memory initializer "+en})},Pe=ft(en);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ue=De.response;if(De.status!==200&&De.status!==0){var ht=ft(t.memoryInitializerRequestURL);if(ht)Ue=ht.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+en),ge();return}}ye(Ue)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ne;wn=function De(){Ne||Xe(),Ne||(wn=De)};function Xe(De){if(ii>0||(nn(),ii>0))return;function Ue(){Ne||(Ne=!0,!ot&&(yn(),Ci(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),gi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ue()},1)):Ue()}t.run=Xe;function Ye(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),G(De),ot=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ye,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof Mn=="object"?Mn:{}),Mr="number",Km=Mr,ss=Mr,Rs=Mr,Oc=Mr,xa=Mr,eN=[["sizeOfH3Index",Mr],["sizeOfGeoCoord",Mr],["sizeOfGeoBoundary",Mr],["sizeOfGeoPolygon",Mr],["sizeOfGeofence",Mr],["sizeOfLinkedGeoPolygon",Mr],["sizeOfCoordIJ",Mr],["h3IsValid",Km,[ss,Rs]],["geoToH3",ss,[Mr,Mr,Oc]],["h3ToGeo",null,[ss,Rs,xa]],["h3ToGeoBoundary",null,[ss,Rs,xa]],["maxKringSize",Mr,[Mr]],["kRing",null,[ss,Rs,Mr,xa]],["kRingDistances",null,[ss,Rs,Mr,xa,xa]],["hexRing",null,[ss,Rs,Mr,xa]],["maxPolyfillSize",Mr,[xa,Oc]],["polyfill",null,[xa,Oc,xa]],["h3SetToLinkedGeo",null,[xa,Mr,xa]],["destroyLinkedPolygon",null,[xa]],["compact",Mr,[xa,xa,Mr]],["uncompact",Mr,[xa,Mr,xa,Mr,Oc]],["maxUncompactSize",Mr,[xa,Mr,Oc]],["h3IsPentagon",Km,[ss,Rs]],["h3IsResClassIII",Km,[ss,Rs]],["h3GetBaseCell",Mr,[ss,Rs]],["h3GetResolution",Mr,[ss,Rs]],["maxFaceCount",Mr,[ss,Rs]],["h3GetFaces",null,[ss,Rs,xa]],["h3ToParent",ss,[ss,Rs,Oc]],["h3ToChildren",null,[ss,Rs,Oc,xa]],["h3ToCenterChild",ss,[ss,Rs,Oc]],["maxH3ToChildrenSize",Mr,[ss,Rs,Oc]],["h3IndexesAreNeighbors",Km,[ss,Rs,ss,Rs]],["getH3UnidirectionalEdge",ss,[ss,Rs,ss,Rs]],["getOriginH3IndexFromUnidirectionalEdge",ss,[ss,Rs]],["getDestinationH3IndexFromUnidirectionalEdge",ss,[ss,Rs]],["h3UnidirectionalEdgeIsValid",Km,[ss,Rs]],["getH3IndexesFromUnidirectionalEdge",null,[ss,Rs,xa]],["getH3UnidirectionalEdgesFromHexagon",null,[ss,Rs,xa]],["getH3UnidirectionalEdgeBoundary",null,[ss,Rs,xa]],["h3Distance",Mr,[ss,Rs,ss,Rs]],["h3Line",Mr,[ss,Rs,ss,Rs,xa]],["h3LineSize",Mr,[ss,Rs,ss,Rs]],["experimentalH3ToLocalIj",Mr,[ss,Rs,ss,Rs,xa]],["experimentalLocalIjToH3",Mr,[ss,Rs,xa,xa]],["hexAreaM2",Mr,[Oc]],["hexAreaKm2",Mr,[Oc]],["edgeLengthM",Mr,[Oc]],["edgeLengthKm",Mr,[Oc]],["pointDistM",Mr,[xa,xa]],["pointDistKm",Mr,[xa,xa]],["pointDistRads",Mr,[xa,xa]],["cellAreaM2",Mr,[ss,Rs]],["cellAreaKm2",Mr,[ss,Rs]],["cellAreaRads2",Mr,[ss,Rs]],["exactEdgeLengthM",Mr,[ss,Rs]],["exactEdgeLengthKm",Mr,[ss,Rs]],["exactEdgeLengthRads",Mr,[ss,Rs]],["numHexagons",Mr,[Oc]],["getRes0Indexes",null,[xa]],["res0IndexCount",Mr],["getPentagonIndexes",null,[Mr,xa]],["pentagonIndexCount",Mr]],ar={};eN.forEach(function(t){ar[t[0]]=Mn.cwrap.apply(Mn,t)});var rm=16,gc=4,Sw=4,V0=8,ic=ar.sizeOfH3Index(),p1=ar.sizeOfGeoCoord(),A5=ar.sizeOfGeoBoundary(),tN=ar.sizeOfGeoPolygon(),cg=ar.sizeOfGeofence(),iN=ar.sizeOfLinkedGeoPolygon(),f5=ar.sizeOfCoordIJ(),Gc={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Im(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw new Error("Invalid resolution: "+e)}var nN=/[^0-9a-fA-F]/;function ga(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||nN.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),rm),n=parseInt(e.substring(e.length-8),rm);return[n,t]}function Iw(e){if(e>=0)return e.toString(rm);e=e&2147483647;var t=d5(8,e.toString(rm)),n=(parseInt(t[0],rm)+8).toString(rm);return t=n+t.substring(1),t}function m1(e,t){return Iw(t)+d5(8,Iw(e))}function d5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function Ew(e,t,n){for(var c=e.length,g=Mn._calloc(c,p1),b=n?1:0,I=n?0:1,a=0;a<c*2;a+=2)Mn.HEAPF64.set([e[a/2][b],e[a/2][I]].map(g1),g/V0+a);return Mn.HEAPU32.set([c,g],t/gc),t}function rN(e,t){var n=e.length-1,c=Mn._calloc(tN),g=0,b=g+cg,I=b+gc;Ew(e[0],c+g,t);var a;if(n>0){a=Mn._calloc(n,cg);for(var G=0;G<n;G++)Ew(e[G+1],a+cg*G,t)}return Mn.setValue(c+b,n,"i32"),Mn.setValue(c+I,a,"i32"),c}function sN(e){var t=0,n=t+cg,c=n+gc,g=gc;Mn._free(Mn.getValue(e+t+g,"i8*"));var b=Mn.getValue(e+n,"i32");if(b>0){for(var I=Mn.getValue(e+c,"i32"),a=0;a<b;a++)Mn._free(Mn.getValue(I+cg*a+g,"i8*"));Mn._free(I)}Mn._free(e)}function p5(e){var t=Mn.getTempRet0();return[e,t]}function Em(e){var t=p5(e),n=t[0],c=t[1];return c?m1(n,c):null}function m5(e,t){t===void 0&&(t=0);var n=Mn.getValue(e+gc*t*2,"i32"),c=Mn.getValue(e+gc*(t*2+1),"i32");return c?m1(n,c):null}function aN(e,t,n){Mn.HEAPU32.set(ga(e),t/gc+2*n)}function dA(e,t){for(var n=[],c=0;c<t;c++){var g=m5(e,c);g!==null&&n.push(g)}return n}function E2(e,t){for(var n=t.length,c=0;c<n;c++)aN(t[c],e,c)}function Cw(e,t){var n=Mn._calloc(1,p1);return Mn.HEAPF64.set([e,t].map(g1),n/V0),n}function H_(e){return v5(Mn.getValue(e,"double"))}function C2(e){return[H_(e),H_(e+V0)]}function g5(e){return[H_(e+V0),H_(e)]}function _5(e,t,n){for(var c=Mn.getValue(e,"i32"),g=e+V0,b=[],I=t?g5:C2,a=0;a<c*2;a+=2)b.push(I(g+V0*a));return n&&b.push(b[0]),b}function oN(e,t){for(var n=[],c=t?g5:C2,g,b,I,a;e;){for(n.push(g=[]),b=Mn.getValue(e,"i8*");b;){for(g.push(I=[]),a=Mn.getValue(b,"i8*");a;)I.push(c(a)),a=Mn.getValue(a+V0*2,"i8*");t&&I.push(I[0]),b=Mn.getValue(b+Sw*2,"i8*")}e=Mn.getValue(e+Sw*2,"i8*")}return n}function lN(e){return{i:Mn.getValue(e,"i32"),j:Mn.getValue(e+gc,"i32")}}function uN(e,t){var n=t.i,c=t.j;Mn.setValue(e,n,"i32"),Mn.setValue(e+gc,c,"i32")}function cN(e,t){for(var n=[],c=0;c<t;c++){var g=Mn.getValue(e+gc*c,"i32");g>=0&&n.push(g)}return n}function y5(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3IsValid(n,c)}function hN(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3IsPentagon(n,c)}function AN(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3IsResClassIII(n,c)}function fN(e){var t=ga(e),n=t[0],c=t[1];return ar.h3GetBaseCell(n,c)}function dN(e){var t=ga(e),n=t[0],c=t[1],g=ar.maxFaceCount(n,c),b=Mn._malloc(gc*g);ar.h3GetFaces(n,c,b);var I=cN(b,g);return Mn._free(b),I}function pN(e){var t=ga(e),n=t[0],c=t[1];return ar.h3IsValid(n,c)?ar.h3GetResolution(n,c):-1}function mN(e,t,n){var c=Mn._malloc(p1);Mn.HEAPF64.set([e,t].map(g1),c/V0);var g=Em(ar.geoToH3(c,n));return Mn._free(c),g}function gN(e){var t=Mn._malloc(p1),n=ga(e),c=n[0],g=n[1];ar.h3ToGeo(c,g,t);var b=C2(t);return Mn._free(t),b}function _N(e,t){var n=Mn._malloc(A5),c=ga(e),g=c[0],b=c[1];ar.h3ToGeoBoundary(g,b,n);var I=_5(n,t,t);return Mn._free(n),I}function yN(e,t){var n=ga(e),c=n[0],g=n[1];return Em(ar.h3ToParent(c,g,t))}function vN(e,t){if(!y5(e))return[];var n=ga(e),c=n[0],g=n[1],b=ar.maxH3ToChildrenSize(c,g,t),I=Mn._calloc(b,ic);ar.h3ToChildren(c,g,t,I);var a=dA(I,b);return Mn._free(I),a}function xN(e,t){var n=ga(e),c=n[0],g=n[1];return Em(ar.h3ToCenterChild(c,g,t))}function bN(e,t){var n=ga(e),c=n[0],g=n[1],b=ar.maxKringSize(t),I=Mn._calloc(b,ic);ar.kRing(c,g,t,I);var a=dA(I,b);return Mn._free(I),a}function wN(e,t){var n=ga(e),c=n[0],g=n[1],b=ar.maxKringSize(t),I=Mn._calloc(b,ic),a=Mn._calloc(b,gc);ar.kRingDistances(c,g,t,I,a);for(var G=[],W=0;W<t+1;W++)G.push([]);for(var he=0;he<b*2;he+=2){var ae=Mn.getValue(I+gc*he,"i32"),ue=Mn.getValue(I+gc*(he+1),"i32"),be=Mn.getValue(a+gc*(he/2),"i32");(ae!==0||ue!==0)&&G[be].push(m1(ae,ue))}return Mn._free(I),Mn._free(a),G}function SN(e,t){var n=t===0?1:6*t,c=Mn._calloc(n,ic),g=ar.hexRing.apply(ar,ga(e).concat([t],[c]));if(g!==0)throw Mn._free(c),new Error("Failed to get hexRing (encountered a pentagon?)");var b=dA(c,n);return Mn._free(c),b}function IN(e,t,n){if(Im(t),n=!!n,e.length===0||e[0].length===0)return[];typeof e[0][0]=="number"&&(e=[e]);var c=rN(e,n),g=ar.maxPolyfillSize(c,t),b=Mn._calloc(g,ic);ar.polyfill(c,t,b);var I=dA(b,g);return Mn._free(b),sN(c),I}function EN(e,t){if(!e||!e.length)return[];var n=e.length,c=Mn._calloc(n,ic);E2(c,e);var g=Mn._calloc(iN),b=g;ar.h3SetToLinkedGeo(c,n,g);var I=oN(g,t);return ar.destroyLinkedPolygon(b),Mn._free(b),Mn._free(c),I}function CN(e){if(!e||!e.length)return[];var t=e.length,n=Mn._calloc(t,ic);E2(n,e);var c=Mn._calloc(t,ic),g=ar.compact(n,c,t);if(g!==0)throw Mn._free(n),Mn._free(c),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var b=dA(c,t);return Mn._free(n),Mn._free(c),b}function TN(e,t){if(Im(t),!e||!e.length)return[];var n=e.length,c=Mn._calloc(n,ic);E2(c,e);var g=ar.maxUncompactSize(c,n,t),b=Mn._calloc(g,ic),I=ar.uncompact(c,n,b,g,t);if(I!==0)throw Mn._free(c),Mn._free(b),new Error("Failed to uncompact (bad resolution?)");var a=dA(b,g);return Mn._free(c),Mn._free(b),a}function kN(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),I=b[0],a=b[1];return!!ar.h3IndexesAreNeighbors(c,g,I,a)}function MN(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),I=b[0],a=b[1];return Em(ar.getH3UnidirectionalEdge(c,g,I,a))}function PN(e){var t=ga(e),n=t[0],c=t[1];return Em(ar.getOriginH3IndexFromUnidirectionalEdge(n,c))}function DN(e){var t=ga(e),n=t[0],c=t[1];return Em(ar.getDestinationH3IndexFromUnidirectionalEdge(n,c))}function LN(e){var t=ga(e),n=t[0],c=t[1];return!!ar.h3UnidirectionalEdgeIsValid(n,c)}function BN(e){var t=ga(e),n=t[0],c=t[1],g=2,b=Mn._calloc(g,ic);ar.getH3IndexesFromUnidirectionalEdge(n,c,b);var I=dA(b,g);return Mn._free(b),I}function zN(e){var t=ga(e),n=t[0],c=t[1],g=6,b=Mn._calloc(g,ic);ar.getH3UnidirectionalEdgesFromHexagon(n,c,b);var I=dA(b,g);return Mn._free(b),I}function RN(e,t){var n=Mn._malloc(A5),c=ga(e),g=c[0],b=c[1];ar.getH3UnidirectionalEdgeBoundary(g,b,n);var I=_5(n,t);return Mn._free(n),I}function FN(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),I=b[0],a=b[1];return ar.h3Distance(c,g,I,a)}function ON(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),I=b[0],a=b[1],G=ar.h3LineSize(c,g,I,a);if(G<0)throw new Error("Line cannot be calculated");var W=Mn._calloc(G,ic);ar.h3Line(c,g,I,a,W);var he=dA(W,G);return Mn._free(W),he}function NN(e,t){var n=Mn._malloc(f5),c=ar.experimentalH3ToLocalIj.apply(ar,ga(e).concat(ga(t),[n])),g=lN(n);switch(Mn._free(n),c){case 0:return g;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function VN(e,t){if(!t||typeof t.i!="number"||typeof t.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=Mn._malloc(f5),c=Mn._malloc(ic);uN(n,t);var g=ar.experimentalLocalIjToH3.apply(ar,ga(e).concat([n],[c])),b=m5(c);if(Mn._free(n),Mn._free(c),g!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return b}function UN(e,t,n){var c=Cw(e[0],e[1]),g=Cw(t[0],t[1]),b;switch(n){case Gc.m:b=ar.pointDistM(c,g);break;case Gc.km:b=ar.pointDistKm(c,g);break;case Gc.rads:b=ar.pointDistRads(c,g);break;default:b=null}if(Mn._free(c),Mn._free(g),b===null)throw new Error("Unknown unit: "+n);return b}function GN(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case Gc.m2:return ar.cellAreaM2(c,g);case Gc.km2:return ar.cellAreaKm2(c,g);case Gc.rads2:return ar.cellAreaRads2(c,g);default:throw new Error("Unknown unit: "+t)}}function qN(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case Gc.m:return ar.exactEdgeLengthM(c,g);case Gc.km:return ar.exactEdgeLengthKm(c,g);case Gc.rads:return ar.exactEdgeLengthRads(c,g);default:throw new Error("Unknown unit: "+t)}}function HN(e,t){switch(Im(e),t){case Gc.m2:return ar.hexAreaM2(e);case Gc.km2:return ar.hexAreaKm2(e);default:throw new Error("Unknown unit: "+t)}}function jN(e,t){switch(Im(e),t){case Gc.m:return ar.edgeLengthM(e);case Gc.km:return ar.edgeLengthKm(e);default:throw new Error("Unknown unit: "+t)}}function ZN(e){Im(e);var t=p5(ar.numHexagons(e)),n=t[0],c=t[1];return c?c*Math.pow(2,32)+n:n}function QN(){var e=ar.res0IndexCount(),t=Mn._malloc(ic*e);ar.getRes0Indexes(t);var n=dA(t,e);return Mn._free(t),n}function WN(e){Im(e);var t=ar.pentagonIndexCount(),n=Mn._malloc(ic*t);ar.getPentagonIndexes(e,n);var c=dA(n,t);return Mn._free(n),c}function g1(e){return e*Math.PI/180}function v5(e){return e*180/Math.PI}const XN=Object.freeze(Object.defineProperty({__proto__:null,UNITS:Gc,cellArea:GN,compact:CN,degsToRads:g1,edgeLength:jN,exactEdgeLength:qN,experimentalH3ToLocalIj:NN,experimentalLocalIjToH3:VN,geoToH3:mN,getDestinationH3IndexFromUnidirectionalEdge:DN,getH3IndexesFromUnidirectionalEdge:BN,getH3UnidirectionalEdge:MN,getH3UnidirectionalEdgeBoundary:RN,getH3UnidirectionalEdgesFromHexagon:zN,getOriginH3IndexFromUnidirectionalEdge:PN,getPentagonIndexes:WN,getRes0Indexes:QN,h3Distance:FN,h3GetBaseCell:fN,h3GetFaces:dN,h3GetResolution:pN,h3IndexToSplitLong:ga,h3IndexesAreNeighbors:kN,h3IsPentagon:hN,h3IsResClassIII:AN,h3IsValid:y5,h3Line:ON,h3SetToMultiPolygon:EN,h3ToCenterChild:xN,h3ToChildren:vN,h3ToGeo:gN,h3ToGeoBoundary:_N,h3ToParent:yN,h3UnidirectionalEdgeIsValid:LN,hexArea:HN,hexRing:SN,kRing:bN,kRingDistances:wN,numHexagons:ZN,pointDist:UN,polyfill:IN,radsToDegs:v5,splitLongToh3Index:m1,uncompact:TN},Symbol.toStringTag,{value:"Module"})),YN=Bv(XN);var Ig=YN,_1="Feature",x5="FeatureCollection",j_="Polygon",T2="MultiPolygon";function b5(e){for(var t=null,n=0;n<e.length;n++)if(t!==null)for(var c=0;c<e[n].length;c++)t.push(e[n][c]);else t=e[n];return Array.from(new Set(t))}function $N(e){for(var t=0,n=0,c=0,g=e[0],b=0;b<g.length;b++)t+=g[b][0],n+=g[b][1],c++;return[t/c,n/c]}function KN(e,t){var n=e.features;if(!n)throw new Error("No features found");return b5(n.map(function(c){return w5(c,t)}))}function w5(e,t,n){n===void 0&&(n={});var c=e.type,g=e.geometry,b=g&&g.type;if(c===x5)return KN(e,t);if(c!==_1)throw new Error("Unhandled type: "+c);if(b!==j_&&b!==T2)throw new Error("Unhandled geometry type: "+b);var I=b===j_?[g.coordinates]:g.coordinates;return b5(I.map(function(a){var G=Ig.polyfill(a,t,!0);if(G.length||!n.ensureOutput)return G;var W=$N(a),he=W[0],ae=W[1];return[Ig.geoToH3(ae,he,t)]}))}function S5(e,t){t===void 0&&(t={});var n=[Ig.h3ToGeoBoundary(e,!0)];return{type:_1,id:e,properties:t,geometry:{type:j_,coordinates:n}}}function JN(e,t){t===void 0&&(t={});var n=Ig.h3SetToMultiPolygon(e,!0),c=n.length>1,g=c?T2:j_,b=c?n:n[0]||[];return{type:_1,properties:t,geometry:{type:g,coordinates:b}}}function eV(e,t){t===void 0&&(t={});var n=e.map(function(c){return[Ig.h3ToGeoBoundary(c,{geoJson:!0})]});return{type:_1,properties:t,geometry:{type:T2,coordinates:n}}}function tV(e,t){for(var n=[],c=0;c<e.length;c++){var g=e[c],b=t?t(g):{};n.push(S5(g,b))}return{type:x5,features:n}}var iV={featureToH3Set:w5,h3ToFeature:S5,h3SetToFeature:JN,h3SetToMultiPolygonFeature:eV,h3SetToFeatureCollection:tV},I5=iV,Ca=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function b(De){return t.locateFile?t.locateFile(De,g):g+De}var I;typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",I=function(Ue,ht,kt){var o=new XMLHttpRequest;o.open("GET",Ue,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ht(o.response);return}var oi=ft(Ue);if(oi){ht(oi.buffer);return}kt()},o.onerror=kt,o.send(null)};var a=t.print||console.log.bind(console),G=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,he=function(De){W=De},ae=function(){return W},ue=8;function be(De,Ue,ht,kt){switch(ht=ht||"i8",ht.charAt(ht.length-1)==="*"&&(ht="i32"),ht){case"i1":bt[De>>0]=Ue;break;case"i8":bt[De>>0]=Ue;break;case"i16":$e[De>>1]=Ue;break;case"i32":mt[De>>2]=Ue;break;case"i64":In=[Ue>>>0,(Qn=Ue,+Ki(Qn)>=1?Qn>0?(pn(+fi(Qn/4294967296),4294967295)|0)>>>0:~~+Ji((Qn-+(~~Qn>>>0))/4294967296)>>>0:0)],mt[De>>2]=In[0],mt[De+4>>2]=In[1];break;case"float":st[De>>2]=Ue;break;case"double":Nt[De>>3]=Ue;break;default:Ye("invalid type for setValue: "+ht)}}function Ke(De,Ue,ht){switch(Ue=Ue||"i8",Ue.charAt(Ue.length-1)==="*"&&(Ue="i32"),Ue){case"i1":return bt[De>>0];case"i8":return bt[De>>0];case"i16":return $e[De>>1];case"i32":return mt[De>>2];case"i64":return mt[De>>2];case"float":return st[De>>2];case"double":return Nt[De>>3];default:Ye("invalid type for getValue: "+Ue)}return null}var ot=!1;function tt(De,Ue){De||Ye("Assertion failed: "+Ue)}function lt(De){var Ue=t["_"+De];return tt(Ue,"Cannot call unknown function "+De+", make sure it is exported"),Ue}function ut(De,Ue,ht,kt,o){var ke={string:function(wi){var $t=0;if(wi!=null&&wi!==0){var vn=(wi.length<<2)+1;$t=X(vn),rt(wi,$t,vn)}return $t},array:function(wi){var $t=X(wi.length);return yt(wi,$t),$t}};function oi(wi){return Ue==="string"?Ge(wi):Ue==="boolean"?!!wi:wi}var di=lt(De),Ai=[],Jt=0;if(kt)for(var li=0;li<kt.length;li++){var zi=ke[ht[li]];zi?(Jt===0&&(Jt=de()),Ai[li]=zi(kt[li])):Ai[li]=kt[li]}var vi=di.apply(null,Ai);return vi=oi(vi),Jt!==0&&ie(Jt),vi}function Tt(De,Ue,ht,kt){ht=ht||[];var o=ht.every(function(oi){return oi==="number"}),ke=Ue!=="string";return ke&&o&&!kt?lt(De):function(){return ut(De,Ue,ht,arguments)}}var Pt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function zt(De,Ue,ht){for(var kt=Ue+ht,o=Ue;De[o]&&!(o>=kt);)++o;if(o-Ue>16&&De.subarray&&Pt)return Pt.decode(De.subarray(Ue,o));for(var ke="";Ue<o;){var oi=De[Ue++];if(!(oi&128)){ke+=String.fromCharCode(oi);continue}var di=De[Ue++]&63;if((oi&224)==192){ke+=String.fromCharCode((oi&31)<<6|di);continue}var Ai=De[Ue++]&63;if((oi&240)==224?oi=(oi&15)<<12|di<<6|Ai:oi=(oi&7)<<18|di<<12|Ai<<6|De[Ue++]&63,oi<65536)ke+=String.fromCharCode(oi);else{var Jt=oi-65536;ke+=String.fromCharCode(55296|Jt>>10,56320|Jt&1023)}}return ke}function Ge(De,Ue){return De?zt(dt,De,Ue):""}function Xt(De,Ue,ht,kt){if(!(kt>0))return 0;for(var o=ht,ke=ht+kt-1,oi=0;oi<De.length;++oi){var di=De.charCodeAt(oi);if(di>=55296&&di<=57343){var Ai=De.charCodeAt(++oi);di=65536+((di&1023)<<10)|Ai&1023}if(di<=127){if(ht>=ke)break;Ue[ht++]=di}else if(di<=2047){if(ht+1>=ke)break;Ue[ht++]=192|di>>6,Ue[ht++]=128|di&63}else if(di<=65535){if(ht+2>=ke)break;Ue[ht++]=224|di>>12,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}else{if(ht+3>=ke)break;Ue[ht++]=240|di>>18,Ue[ht++]=128|di>>12&63,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}}return Ue[ht]=0,ht-o}function rt(De,Ue,ht){return Xt(De,dt,Ue,ht)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function yt(De,Ue){bt.set(De,Ue)}function pt(De,Ue){return De%Ue>0&&(De+=Ue-De%Ue),De}var gt,bt,dt,$e,mt,st,Nt;function Rt(De){gt=De,t.HEAP8=bt=new Int8Array(De),t.HEAP16=$e=new Int16Array(De),t.HEAP32=mt=new Int32Array(De),t.HEAPU8=dt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=st=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Ot=5267040,_i=24128,Si=t.TOTAL_MEMORY||33554432;t.buffer?gt=t.buffer:gt=new ArrayBuffer(Si),Si=gt.byteLength,Rt(gt),mt[_i>>2]=Ot;function Ti(De){for(;De.length>0;){var Ue=De.shift();if(typeof Ue=="function"){Ue();continue}var ht=Ue.func;typeof ht=="number"?Ue.arg===void 0?t.dynCall_v(ht):t.dynCall_vi(ht,Ue.arg):ht(Ue.arg===void 0?null:Ue.arg)}}var Oi=[],tn=[],qi=[],Ni=[];function nn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ri(t.preRun.shift());Ti(Oi)}function yn(){Ti(tn)}function Ci(){Ti(qi)}function gi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)ai(t.postRun.shift());Ti(Ni)}function Ri(De){Oi.unshift(De)}function ai(De){Ni.unshift(De)}var Ki=Math.abs,Ji=Math.ceil,fi=Math.floor,pn=Math.min,ii=0,wn=null;function Rr(De){ii++,t.monitorRunDependencies&&t.monitorRunDependencies(ii)}function hi(De){if(ii--,t.monitorRunDependencies&&t.monitorRunDependencies(ii),ii==0&&wn){var Ue=wn;wn=null,Ue()}}t.preloadedImages={},t.preloadedAudios={};var en=null,tr="data:application/octet-stream;base64,";function Fn(De){return String.prototype.startsWith?De.startsWith(tr):De.indexOf(tr)===0}var Qn,In;en="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var v=24144;function k(De){return De}function V(De){var Ue=/\b__Z[\w\d_]+/g;return De.replace(Ue,function(ht){var kt=ht;return ht===kt?ht:kt+" ["+ht+"]"})}function $(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ue){De=Ue}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=$();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function fe(De,Ue,ht,kt){Ye("Assertion failed: "+Ge(De)+", at: "+[Ue?Ge(Ue):"unknown filename",ht,kt?Ge(kt):"unknown function"])}function ve(){return bt.length}function Ie(De,Ue,ht){dt.set(dt.subarray(Ue,Ue+ht),De)}function Ee(De){return t.___errno_location&&(mt[t.___errno_location()>>2]=De),De}function ze(De){Ye("OOM")}function Qe(De){try{var Ue=new ArrayBuffer(De);return Ue.byteLength!=De?void 0:(new Int8Array(Ue).set(bt),ne(Ue),Rt(Ue),1)}catch{}}function He(De){var Ue=ve(),ht=16777216,kt=2147483648-ht;if(De>kt)return!1;for(var o=16777216,ke=Math.max(Ue,o);ke<De;)ke<=536870912?ke=pt(2*ke,ht):ke=Math.min(pt((3*ke+2147483648)/4,ht),kt);var oi=Qe(ke);return!!oi}var Ze=typeof atob=="function"?atob:function(De){var Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ht="",kt,o,ke,oi,di,Ai,Jt,li=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do oi=Ue.indexOf(De.charAt(li++)),di=Ue.indexOf(De.charAt(li++)),Ai=Ue.indexOf(De.charAt(li++)),Jt=Ue.indexOf(De.charAt(li++)),kt=oi<<2|di>>4,o=(di&15)<<4|Ai>>2,ke=(Ai&3)<<6|Jt,ht=ht+String.fromCharCode(kt),Ai!==64&&(ht=ht+String.fromCharCode(o)),Jt!==64&&(ht=ht+String.fromCharCode(ke));while(li<De.length);return ht};function Ve(De){try{for(var Ue=Ze(De),ht=new Uint8Array(Ue.length),kt=0;kt<Ue.length;++kt)ht[kt]=Ue.charCodeAt(kt);return ht}catch{throw new Error("Converting base64 string to bytes failed.")}}function ft(De){if(Fn(De))return Ve(De.slice(tr.length))}var nt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ye,b:he,c:ae,d:fe,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:Qe,m:$,n:te,o:v,p:_i},se=function(De,Ue,ht){"almost asm";var kt=new De.Int8Array(ht),o=new De.Int32Array(ht);new De.Uint8Array(ht),new De.Float32Array(ht);var ke=new De.Float64Array(ht),oi=Ue.o|0,di=Ue.p|0,Ai=De.Math.floor,Jt=De.Math.abs,li=De.Math.sqrt,zi=De.Math.pow,vi=De.Math.cos,wi=De.Math.sin,$t=De.Math.tan,vn=De.Math.acos,or=De.Math.asin,mn=De.Math.atan,qn=De.Math.atan2,jr=De.Math.ceil,Hi=De.Math.imul,ur=De.Math.min,On=De.Math.max,Qt=De.Math.clz32,Yi=Ue.b,Ut=Ue.c,Tn=Ue.d,cr=Ue.e,Ns=Ue.f,Ur=Ue.g,Vt=Ue.h,hr=Ue.i,Lt=24160;function Fr(i){return kt=new Int8Array(i),o=new Int32Array(i),ke=new Float64Array(i),ht=i,!0}function Vs(i){i=i|0;var r=0;return r=Lt,Lt=Lt+i|0,Lt=Lt+15&-16,r|0}function ua(){return Lt|0}function Pr(i){i=i|0,Lt=i}function Fa(i,r){i=i|0,Lt=i}function zo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return(i|0)<0?(r=2,r|0):(i|0)>13780509?(r=lr(15,r)|0,r|0):(l=((i|0)<0)<<31>>31,_=We(i|0,l|0,3,0)|0,d=Ut()|0,l=z(i|0,l|0,1,0)|0,l=We(_|0,d|0,l|0,Ut()|0)|0,l=z(l|0,Ut()|0,1,0)|0,i=Ut()|0,o[r>>2]=l,o[r+4>>2]=i,r=0,r|0)}function Oa(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,Ys(i,r,l,d,0)|0}function Ys(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0;if(j=Lt,Lt=Lt+16|0,T=j,!(Zn(i,r,l,d,_)|0))return d=0,Lt=j,d|0;do if((l|0)>=0){if((l|0)>13780509){if(w=lr(15,T)|0,w|0)break;B=T,T=o[B>>2]|0,B=o[B+4>>2]|0}else w=((l|0)<0)<<31>>31,Y=We(l|0,w|0,3,0)|0,B=Ut()|0,w=z(l|0,w|0,1,0)|0,w=We(Y|0,B|0,w|0,Ut()|0)|0,w=z(w|0,Ut()|0,1,0)|0,B=Ut()|0,o[T>>2]=w,o[T+4>>2]=B,T=w;if(O(d|0,0,T<<3|0)|0,_|0){O(_|0,0,T<<2|0)|0,w=aa(i,r,l,d,_,T,B,0)|0;break}w=D(T,4)|0,w?(Y=aa(i,r,l,d,w,T,B,0)|0,C(w),w=Y):w=13}else w=2;while(!1);return Y=w,Lt=j,Y|0}function Zn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0;if(Je=Lt,Lt=Lt+16|0,Re=Je,Be=Je+8|0,Te=Re,o[Te>>2]=i,o[Te+4>>2]=r,(l|0)<0)return Be=2,Lt=Je,Be|0;if(w=d,o[w>>2]=i,o[w+4>>2]=r,w=(_|0)!=0,w&&(o[_>>2]=0),kr(i,r)|0)return Be=9,Lt=Je,Be|0;o[Be>>2]=0;e:do if((l|0)>=1)if(w)for(ce=1,Y=0,Se=0,Te=1,w=i;;){if(!(Y|Se)){if(w=ls(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,kr(w,r)|0){w=9;break e}}if(w=ls(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ce<<3)|0,o[i>>2]=w,o[i+4>>2]=r,o[_+(ce<<2)>>2]=Te,i=Y+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,kr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ce=ce+1|0,Y=T?0:i,Se=T?j?0:B:Se}else for(ce=1,Y=0,Se=0,Te=1,w=i;;){if(!(Y|Se)){if(w=ls(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,kr(w,r)|0){w=9;break e}}if(w=ls(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ce<<3)|0,o[i>>2]=w,o[i+4>>2]=r,i=Y+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,kr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ce=ce+1|0,Y=T?0:i,Se=T?j?0:B:Se}else w=0;while(!1);return Be=w,Lt=Je,Be|0}function aa(i,r,l,d,_,w,T,B){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0,B=B|0;var j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0;if(Je=Lt,Lt=Lt+16|0,Re=Je+8|0,Be=Je,j=Ct(i|0,r|0,w|0,T|0)|0,ce=Ut()|0,Se=d+(j<<3)|0,xt=Se,at=o[xt>>2]|0,xt=o[xt+4>>2]|0,Y=(at|0)==(i|0)&(xt|0)==(r|0),!((at|0)==0&(xt|0)==0|Y))do j=z(j|0,ce|0,1,0)|0,j=vt(j|0,Ut()|0,w|0,T|0)|0,ce=Ut()|0,Se=d+(j<<3)|0,at=Se,xt=o[at>>2]|0,at=o[at+4>>2]|0,Y=(xt|0)==(i|0)&(at|0)==(r|0);while(!((xt|0)==0&(at|0)==0|Y));if(j=_+(j<<2)|0,Y&&(o[j>>2]|0)<=(B|0)||(at=Se,o[at>>2]=i,o[at+4>>2]=r,o[j>>2]=B,(B|0)>=(l|0)))return at=0,Lt=Je,at|0;switch(Y=B+1|0,o[Re>>2]=0,j=ls(i,r,2,Re,Be)|0,j|0){case 9:{Te=9;break}case 0:{j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j||(Te=9);break}}e:do if((Te|0)==9){switch(o[Re>>2]=0,j=ls(i,r,3,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,1,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,5,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,4,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,6,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}return at=0,Lt=Je,at|0}while(!1);return at=j,Lt=Je,at|0}function ls(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(l>>>0>6)return _=1,_|0;if(Se=(o[d>>2]|0)%6|0,o[d>>2]=Se,(Se|0)>0){w=0;do l=Ta(l)|0,w=w+1|0;while((w|0)<(o[d>>2]|0))}if(Se=Gt(i|0,r|0,45)|0,Ut()|0,ce=Se&127,ce>>>0>121)return _=5,_|0;j=wa(i,r)|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15;e:do if(!w)Y=8;else{for(;;){if(T=(15-w|0)*3|0,B=Gt(i|0,r|0,T|0)|0,Ut()|0,B=B&7,(B|0)==7){r=5;break}if(Be=(Gs(w)|0)==0,w=w+-1|0,Te=jt(7,0,T|0)|0,r=r&~(Ut()|0),Re=jt(o[(Be?432:16)+(B*28|0)+(l<<2)>>2]|0,0,T|0)|0,T=Ut()|0,l=o[(Be?640:224)+(B*28|0)+(l<<2)>>2]|0,i=Re|i&~Te,r=T|r,!l){l=0;break e}if(!w){Y=8;break e}}return r|0}while(!1);(Y|0)==8&&(Be=o[848+(ce*28|0)+(l<<2)>>2]|0,Re=jt(Be|0,0,45)|0,i=Re|i,r=Ut()|0|r&-1040385,l=o[4272+(ce*28|0)+(l<<2)>>2]|0,(Be&127|0)==127&&(Be=jt(o[848+(ce*28|0)+20>>2]|0,0,45)|0,r=Ut()|0|r&-1040385,l=o[4272+(ce*28|0)+20>>2]|0,i=To(Be|i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1)),B=Gt(i|0,r|0,45)|0,Ut()|0,B=B&127;e:do if(it(B)|0){t:do if((wa(i,r)|0)==1){if((ce|0)!=(B|0))if(fn(B,o[7696+(ce*28|0)>>2]|0)|0){i=fo(i,r)|0,T=1,r=Ut()|0;break}else Tn(23313,22416,436,22424);switch(j|0){case 3:{i=To(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1,T=0;break t}case 5:{i=fo(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+5,T=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else T=0;while(!1);if((l|0)>0){w=0;do i=Tl(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}if((ce|0)!=(B|0)){if(!(It(B)|0)){if((T|0)!=0|(wa(i,r)|0)!=5)break;o[d>>2]=(o[d>>2]|0)+1;break}switch(Se&127){case 8:case 118:break e}(wa(i,r)|0)!=3&&(o[d>>2]=(o[d>>2]|0)+1)}}else if((l|0)>0){w=0;do i=To(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}while(!1);return o[d>>2]=((o[d>>2]|0)+l|0)%6|0,Be=_,o[Be>>2]=i,o[Be+4>>2]=r,Be=0,Be|0}function Na(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;for(B=Lt,Lt=Lt+16|0,w=B,T=B+8|0,_=(kr(i,r)|0)==0,_=_?1:2;;){if(o[T>>2]=0,Y=(ls(i,r,_,T,w)|0)==0,j=w,Y&((o[j>>2]|0)==(l|0)?(o[j+4>>2]|0)==(d|0):0)){i=4;break}if(_=_+1|0,_>>>0>=7){_=7,i=4;break}}return(i|0)==4?(Lt=B,_|0):0}function al(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(Be=Lt,Lt=Lt+16|0,Te=Be,Re=Be+8|0,Se=Te,o[Se>>2]=i,o[Se+4>>2]=r,!l)return Re=d,o[Re>>2]=i,o[Re+4>>2]=r,Re=0,Lt=Be,Re|0;o[Re>>2]=0;e:do if(kr(i,r)|0)i=9;else{if(w=(l|0)>0,w){_=0,Se=i;do{if(i=ls(Se,r,4,Re,Te)|0,i|0)break e;if(r=Te,Se=o[r>>2]|0,r=o[r+4>>2]|0,_=_+1|0,kr(Se,r)|0){i=9;break e}}while((_|0)<(l|0));if(ce=d,o[ce>>2]=Se,o[ce+4>>2]=r,ce=l+-1|0,w){Y=0,i=1;do{if(_=22384+(Y<<2)|0,(Y|0)==5)for(T=o[_>>2]|0,w=0,_=i;;){if(i=Te,i=ls(o[i>>2]|0,o[i+4>>2]|0,T,Re,Te)|0,i|0)break e;if((w|0)!=(ce|0))if(j=Te,B=o[j>>2]|0,j=o[j+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=B,o[i+4>>2]=j,!(kr(B,j)|0))i=_+1|0;else{i=9;break e}else i=_;if(w=w+1|0,(w|0)>=(l|0))break;_=i}else for(T=Te,j=o[_>>2]|0,B=0,_=i,w=o[T>>2]|0,T=o[T+4>>2]|0;;){if(i=ls(w,T,j,Re,Te)|0,i|0)break e;if(T=Te,w=o[T>>2]|0,T=o[T+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=w,o[i+4>>2]=T,i=_+1|0,kr(w,T)|0){i=9;break e}if(B=B+1|0,(B|0)>=(l|0))break;_=i}Y=Y+1|0}while(Y>>>0<6);i=Te,T=Se,_=o[i>>2]|0,w=r,i=o[i+4>>2]|0}else T=Se,_=Se,w=r,i=r}else T=d,o[T>>2]=i,o[T+4>>2]=r,T=i,_=i,w=r,i=r;i=(T|0)==(_|0)&(w|0)==(i|0)?0:9}while(!1);return Re=i,Lt=Be,Re|0}function ol(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;if(B=Lt,Lt=Lt+48|0,_=B+16|0,w=B+8|0,T=B,l|0)return T=15,Lt=B,T|0;if(Y=i,j=o[Y+4>>2]|0,l=w,o[l>>2]=o[Y>>2],o[l+4>>2]=j,Fu(w,_),r=pl(_,r,T)|0,!r){if(l=o[w>>2]|0,w=o[i+8>>2]|0,(w|0)>0){_=o[i+12>>2]|0,r=0;do l=(o[_+(r<<3)>>2]|0)+l|0,r=r+1|0;while((r|0)<(w|0))}r=T,_=o[r>>2]|0,r=o[r+4>>2]|0,w=((l|0)<0)<<31>>31,(r|0)<(w|0)|(r|0)==(w|0)&_>>>0<l>>>0?(r=T,o[r>>2]=l,o[r+4>>2]=w,r=w):l=_,j=z(l|0,r|0,12,0)|0,Y=Ut()|0,r=T,o[r>>2]=j,o[r+4>>2]=Y,r=d,o[r>>2]=j,o[r+4>>2]=Y,r=0}return Y=r,Lt=B,Y|0}function to(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0,si=0,ji=0,Qi=0,Ei=0,Ui=0,Gi=0,ln=0,Bn=0,rn=0,kn=0,yr=0,er=0;if(Bn=Lt,Lt=Lt+64|0,Ei=Bn+48|0,Ui=Bn+32|0,Gi=Bn+24|0,ri=Bn+8|0,Yt=Bn,j=o[i>>2]|0,(j|0)<=0)return ln=0,Lt=Bn,ln|0;for(ei=i+4|0,si=Ei+8|0,ji=Ui+8|0,Qi=ri+8|0,B=0,Et=0;;){Y=o[ei>>2]|0,ct=Y+(Et<<4)|0,o[Ei>>2]=o[ct>>2],o[Ei+4>>2]=o[ct+4>>2],o[Ei+8>>2]=o[ct+8>>2],o[Ei+12>>2]=o[ct+12>>2],(Et|0)==(j+-1|0)?(o[Ui>>2]=o[Y>>2],o[Ui+4>>2]=o[Y+4>>2],o[Ui+8>>2]=o[Y+8>>2],o[Ui+12>>2]=o[Y+12>>2]):(ct=Y+(Et+1<<4)|0,o[Ui>>2]=o[ct>>2],o[Ui+4>>2]=o[ct+4>>2],o[Ui+8>>2]=o[ct+8>>2],o[Ui+12>>2]=o[ct+12>>2]),j=Gr(Ei,Ui,d,Gi)|0;e:do if(j)Y=0,B=j;else if(Y=Gi,j=o[Y>>2]|0,Y=o[Y+4>>2]|0,(Y|0)>0|(Y|0)==0&j>>>0>0){at=0,ct=0;t:for(;;){if(er=+ke[Ei>>3],xt=R(j|0,Y|0,at|0,ct|0)|0,yr=+(xt>>>0)+4294967296*+(Ut()|0),rn=+(j>>>0)+4294967296*+(Y|0),kn=+(at>>>0)+4294967296*+(ct|0),ke[ri>>3]=er*yr/rn+ +ke[Ui>>3]*kn/rn,ke[Qi>>3]=+ke[si>>3]*yr/rn+ +ke[ji>>3]*kn/rn,j=Qa(ri,d,Yt)|0,j|0){B=j;break}xt=Yt,Je=o[xt>>2]|0,xt=o[xt+4>>2]|0,Te=Ct(Je|0,xt|0,r|0,l|0)|0,ce=Ut()|0,j=T+(Te<<3)|0,Se=j,Y=o[Se>>2]|0,Se=o[Se+4>>2]|0;i:do if((Y|0)==0&(Se|0)==0)wt=j,ln=16;else for(Re=0,Be=0;;){if((Re|0)>(l|0)|(Re|0)==(l|0)&Be>>>0>r>>>0){B=1;break t}if((Y|0)==(Je|0)&(Se|0)==(xt|0))break i;if(j=z(Te|0,ce|0,1,0)|0,Te=vt(j|0,Ut()|0,r|0,l|0)|0,ce=Ut()|0,Be=z(Be|0,Re|0,1,0)|0,Re=Ut()|0,j=T+(Te<<3)|0,Se=j,Y=o[Se>>2]|0,Se=o[Se+4>>2]|0,(Y|0)==0&(Se|0)==0){wt=j,ln=16;break}}while(!1);if((ln|0)==16&&(ln=0,!((Je|0)==0&(xt|0)==0))&&(Be=wt,o[Be>>2]=Je,o[Be+4>>2]=xt,Be=w+(o[_>>2]<<3)|0,o[Be>>2]=Je,o[Be+4>>2]=xt,Be=_,Be=z(o[Be>>2]|0,o[Be+4>>2]|0,1,0)|0,Je=Ut()|0,xt=_,o[xt>>2]=Be,o[xt+4>>2]=Je),at=z(at|0,ct|0,1,0)|0,ct=Ut()|0,Y=Gi,j=o[Y>>2]|0,Y=o[Y+4>>2]|0,!((Y|0)>(ct|0)|(Y|0)==(ct|0)&j>>>0>at>>>0)){Y=1;break e}}Y=0}else Y=1;while(!1);if(Et=Et+1|0,!Y){ln=21;break}if(j=o[i>>2]|0,(Et|0)>=(j|0)){B=0,ln=21;break}}return(ln|0)==21?(Lt=Bn,B|0):0}function Va(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0,si=0,ji=0,Qi=0,Ei=0,Ui=0,Gi=0,ln=0,Bn=0,rn=0,kn=0,yr=0;if(yr=Lt,Lt=Lt+112|0,ln=yr+80|0,j=yr+72|0,Bn=yr,rn=yr+56|0,l|0)return kn=15,Lt=yr,kn|0;if(Y=i+8|0,kn=Ms((o[Y>>2]<<5)+32|0)|0,!kn)return kn=13,Lt=yr,kn|0;if(Vl(i,kn),Ui=i,Gi=o[Ui+4>>2]|0,l=j,o[l>>2]=o[Ui>>2],o[l+4>>2]=Gi,Fu(j,ln),l=pl(ln,r,Bn)|0,l)Ui=0,Gi=0;else{if(l=o[j>>2]|0,w=o[Y>>2]|0,(w|0)>0){T=o[i+12>>2]|0,_=0;do l=(o[T+(_<<3)>>2]|0)+l|0,_=_+1|0;while((_|0)!=(w|0));_=l}else _=l;l=Bn,w=o[l>>2]|0,l=o[l+4>>2]|0,T=((_|0)<0)<<31>>31,(l|0)<(T|0)|(l|0)==(T|0)&w>>>0<_>>>0?(l=Bn,o[l>>2]=_,o[l+4>>2]=T,l=T):_=w,Ui=z(_|0,l|0,12,0)|0,Gi=Ut()|0,l=Bn,o[l>>2]=Ui,o[l+4>>2]=Gi,l=0}if(l|0)return C(kn),kn=l,Lt=yr,kn|0;if(_=D(Ui,8)|0,!_)return C(kn),kn=13,Lt=yr,kn|0;if(B=D(Ui,8)|0,!B)return C(kn),C(_),kn=13,Lt=yr,kn|0;Qi=ln,o[Qi>>2]=0,o[Qi+4>>2]=0,Qi=i,Ei=o[Qi+4>>2]|0,l=j,o[l>>2]=o[Qi>>2],o[l+4>>2]=Ei,l=to(j,Ui,Gi,r,ln,_,B)|0;e:do if(l)C(_),C(B),C(kn);else{t:do if((o[Y>>2]|0)>0){for(T=i+12|0,w=0;l=to((o[T>>2]|0)+(w<<3)|0,Ui,Gi,r,ln,_,B)|0,w=w+1|0,!(l|0);)if((w|0)>=(o[Y>>2]|0))break t;C(_),C(B),C(kn);break e}while(!1);(Gi|0)>0|(Gi|0)==0&Ui>>>0>0&&O(B|0,0,Ui<<3|0)|0,Ei=ln,Qi=o[Ei+4>>2]|0;t:do if((Qi|0)>0|(Qi|0)==0&(o[Ei>>2]|0)>>>0>0){ei=_,si=B,ji=_,Qi=B,Ei=_,l=_,wt=_,ri=B,Yt=B,_=B;i:for(;;){for(xt=0,at=0,ct=0,Et=0,w=0,T=0;;){B=Bn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));if(r=ei+(xt<<3)|0,Y=o[r>>2]|0,r=o[r+4>>2]|0,Zn(Y,r,1,Bn,0)|0){B=Bn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));B=D(7,4)|0,B|0&&(aa(Y,r,1,Bn,B,7,0,0)|0,C(B))}for(Je=0;;){Be=Bn+(Je<<3)|0,Re=o[Be>>2]|0,Be=o[Be+4>>2]|0;n:do if((Re|0)==0&(Be|0)==0)B=w,j=T;else{if(ce=Ct(Re|0,Be|0,Ui|0,Gi|0)|0,Y=Ut()|0,B=d+(ce<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0,!((j|0)==0&(r|0)==0)){Se=0,Te=0;do{if((Se|0)>(Gi|0)|(Se|0)==(Gi|0)&Te>>>0>Ui>>>0)break i;if((j|0)==(Re|0)&(r|0)==(Be|0)){B=w,j=T;break n}B=z(ce|0,Y|0,1,0)|0,ce=vt(B|0,Ut()|0,Ui|0,Gi|0)|0,Y=Ut()|0,Te=z(Te|0,Se|0,1,0)|0,Se=Ut()|0,B=d+(ce<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0}while(!((j|0)==0&(r|0)==0))}(Re|0)==0&(Be|0)==0?(B=w,j=T):(mr(Re,Be,rn)|0,yl(i,kn,rn)|0&&(Te=z(w|0,T|0,1,0)|0,T=Ut()|0,Se=B,o[Se>>2]=Re,o[Se+4>>2]=Be,w=si+(w<<3)|0,o[w>>2]=Re,o[w+4>>2]=Be,w=Te),B=w,j=T)}while(!1);if(Je=Je+1|0,Je>>>0>=7)break;w=B,T=j}if(xt=z(xt|0,at|0,1,0)|0,at=Ut()|0,ct=z(ct|0,Et|0,1,0)|0,Et=Ut()|0,T=ln,w=o[T>>2]|0,T=o[T+4>>2]|0,(Et|0)<(T|0)|(Et|0)==(T|0)&ct>>>0<w>>>0)w=B,T=j;else break}if((T|0)>0|(T|0)==0&w>>>0>0){w=0,T=0;do Et=ei+(w<<3)|0,o[Et>>2]=0,o[Et+4>>2]=0,w=z(w|0,T|0,1,0)|0,T=Ut()|0,Et=ln,ct=o[Et+4>>2]|0;while((T|0)<(ct|0)|((T|0)==(ct|0)?w>>>0<(o[Et>>2]|0)>>>0:0))}if(Et=ln,o[Et>>2]=B,o[Et+4>>2]=j,(j|0)>0|(j|0)==0&B>>>0>0)Je=_,xt=Yt,at=Ei,ct=ri,Et=si,_=wt,Yt=l,ri=ji,wt=Je,l=xt,Ei=Qi,Qi=at,ji=ct,si=ei,ei=Et;else break t}C(ji),C(Qi),C(kn),l=1;break e}else l=B;while(!1);C(kn),C(_),C(l),l=0}while(!1);return kn=l,Lt=yr,kn|0}function N(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0;if(ce=Lt,Lt=Lt+176|0,j=ce,(r|0)<1)return yu(l,0,0),Y=0,Lt=ce,Y|0;for(B=i,B=Gt(o[B>>2]|0,o[B+4>>2]|0,52)|0,Ut()|0,yu(l,(r|0)>6?r:6,B&15),B=0;d=i+(B<<3)|0,d=Nr(o[d>>2]|0,o[d+4>>2]|0,j)|0,!(d|0);){if(d=o[j>>2]|0,(d|0)>0){T=0;do w=j+8+(T<<4)|0,T=T+1|0,d=j+8+(((T|0)%(d|0)|0)<<4)|0,_=xs(l,d,w)|0,_?ki(l,_)|0:Bi(l,w,d)|0,d=o[j>>2]|0;while((T|0)<(d|0))}if(B=B+1|0,(B|0)>=(r|0)){d=0,Y=13;break}}return(Y|0)==13?(Lt=ce,d|0):(vs(l),Y=d,Lt=ce,Y|0)}function xe(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=Lt,Lt=Lt+32|0,d=w,_=w+16|0,i=N(i,r,_)|0,i|0)return l=i,Lt=w,l|0;if(o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,i=ko(_)|0,i|0)do{r=Qu(l)|0;do Ru(r,i)|0,T=i+16|0,o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],o[d+12>>2]=o[T+12>>2],ki(_,i)|0,i=vu(_,d)|0;while(i|0);i=ko(_)|0}while(i|0);return vs(_),i=Ml(l)|0,i?(go(l),T=i,Lt=w,T|0):(T=0,Lt=w,T|0)}function it(i){return i=i|0,i>>>0>121?(i=0,i|0):(i=o[7696+(i*28|0)+16>>2]|0,i|0)}function It(i){return i=i|0,(i|0)==4|(i|0)==117|0}function Wt(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)>>2]|0}function Ii(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)+4>>2]|0}function Li(i,r){i=i|0,r=r|0,i=7696+(i*28|0)|0,o[r>>2]=o[i>>2],o[r+4>>2]=o[i+4>>2],o[r+8>>2]=o[i+8>>2],o[r+12>>2]=o[i+12>>2]}function cn(i,r){i=i|0,r=r|0;var l=0,d=0;if(r>>>0>20)return r=-1,r|0;do if((o[11120+(r*216|0)>>2]|0)!=(i|0))if((o[11120+(r*216|0)+8>>2]|0)!=(i|0))if((o[11120+(r*216|0)+16>>2]|0)!=(i|0))if((o[11120+(r*216|0)+24>>2]|0)!=(i|0))if((o[11120+(r*216|0)+32>>2]|0)!=(i|0))if((o[11120+(r*216|0)+40>>2]|0)!=(i|0))if((o[11120+(r*216|0)+48>>2]|0)!=(i|0))if((o[11120+(r*216|0)+56>>2]|0)!=(i|0))if((o[11120+(r*216|0)+64>>2]|0)!=(i|0))if((o[11120+(r*216|0)+72>>2]|0)!=(i|0))if((o[11120+(r*216|0)+80>>2]|0)!=(i|0))if((o[11120+(r*216|0)+88>>2]|0)!=(i|0))if((o[11120+(r*216|0)+96>>2]|0)!=(i|0))if((o[11120+(r*216|0)+104>>2]|0)!=(i|0))if((o[11120+(r*216|0)+112>>2]|0)!=(i|0))if((o[11120+(r*216|0)+120>>2]|0)!=(i|0))if((o[11120+(r*216|0)+128>>2]|0)!=(i|0))if((o[11120+(r*216|0)+136>>2]|0)==(i|0))i=2,l=1,d=2;else{if((o[11120+(r*216|0)+144>>2]|0)==(i|0)){i=0,l=2,d=0;break}if((o[11120+(r*216|0)+152>>2]|0)==(i|0)){i=0,l=2,d=1;break}if((o[11120+(r*216|0)+160>>2]|0)==(i|0)){i=0,l=2,d=2;break}if((o[11120+(r*216|0)+168>>2]|0)==(i|0)){i=1,l=2,d=0;break}if((o[11120+(r*216|0)+176>>2]|0)==(i|0)){i=1,l=2,d=1;break}if((o[11120+(r*216|0)+184>>2]|0)==(i|0)){i=1,l=2,d=2;break}if((o[11120+(r*216|0)+192>>2]|0)==(i|0)){i=2,l=2,d=0;break}if((o[11120+(r*216|0)+200>>2]|0)==(i|0)){i=2,l=2,d=1;break}if((o[11120+(r*216|0)+208>>2]|0)==(i|0)){i=2,l=2,d=2;break}else i=-1;return i|0}else i=2,l=1,d=1;else i=2,l=1,d=0;else i=1,l=1,d=2;else i=1,l=1,d=1;else i=1,l=1,d=0;else i=0,l=1,d=2;else i=0,l=1,d=1;else i=0,l=1,d=0;else i=2,l=0,d=2;else i=2,l=0,d=1;else i=2,l=0,d=0;else i=1,l=0,d=2;else i=1,l=0,d=1;else i=1,l=0,d=0;else i=0,l=0,d=2;else i=0,l=0,d=1;else i=0,l=0,d=0;while(!1);return r=o[11120+(r*216|0)+(l*72|0)+(i*24|0)+(d<<3)+4>>2]|0,r|0}function fn(i,r){return i=i|0,r=r|0,(o[7696+(i*28|0)+20>>2]|0)==(r|0)?(r=1,r|0):(r=(o[7696+(i*28|0)+24>>2]|0)==(r|0),r|0)}function sr(i,r){return i=i|0,r=r|0,o[848+(i*28|0)+(r<<2)>>2]|0}function Ar(i,r){return i=i|0,r=r|0,(o[848+(i*28|0)>>2]|0)==(r|0)?(r=0,r|0):(o[848+(i*28|0)+4>>2]|0)==(r|0)?(r=1,r|0):(o[848+(i*28|0)+8>>2]|0)==(r|0)?(r=2,r|0):(o[848+(i*28|0)+12>>2]|0)==(r|0)?(r=3,r|0):(o[848+(i*28|0)+16>>2]|0)==(r|0)?(r=4,r|0):(o[848+(i*28|0)+20>>2]|0)==(r|0)?(r=5,r|0):((o[848+(i*28|0)+24>>2]|0)==(r|0)?6:7)|0}function Or(){return 122}function Ua(i){i=i|0;var r=0,l=0,d=0;r=0;do jt(r|0,0,45)|0,d=Ut()|0|134225919,l=i+(r<<3)|0,o[l>>2]=-1,o[l+4>>2]=d,r=r+1|0;while((r|0)!=122);return 0}function Ga(i){return i=i|0,+ke[i+16>>3]<+ke[i+24>>3]|0}function qa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return l=+ke[r>>3],!(l>=+ke[i+8>>3])||!(l<=+ke[i>>3])?(r=0,r|0):(d=+ke[i+16>>3],l=+ke[i+24>>3],_=+ke[r+8>>3],r=_>=l,i=_<=d&1,d<l?r&&(i=1):r||(i=0),r=(i|0)!=0,r|0)}function pl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0;Be=Lt,Lt=Lt+288|0,ce=Be+264|0,Se=Be+96|0,Y=Be,B=Y,j=B+96|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));return r=Sa(r,Y)|0,r|0?(Re=r,Lt=Be,Re|0):(j=Y,Y=o[j>>2]|0,j=o[j+4>>2]|0,mr(Y,j,ce)|0,Nr(Y,j,Se)|0,T=+Vi(ce,Se+8|0),ke[ce>>3]=+ke[i>>3],j=ce+8|0,ke[j>>3]=+ke[i+16>>3],ke[Se>>3]=+ke[i+8>>3],Y=Se+8|0,ke[Y>>3]=+ke[i+24>>3],_=+Vi(ce,Se),xt=+ke[j>>3]-+ke[Y>>3],w=+Jt(+xt),Je=+ke[ce>>3]-+ke[Se>>3],d=+Jt(+Je),!(xt==0|Je==0)&&(xt=+Z(+w,+d),xt=+jr(+(_*_/+A(+(xt/+A(+w,+d)),3)/(T*(T*2.59807621135)*.8))),ke[oi>>3]=xt,Te=~~xt>>>0,Re=+Jt(xt)>=1?xt>0?~~+ur(+Ai(xt/4294967296),4294967295)>>>0:~~+jr((xt-+(~~xt>>>0))/4294967296)>>>0:0,(o[oi+4>>2]&2146435072|0)!=2146435072)?(Se=(Te|0)==0&(Re|0)==0,r=l,o[r>>2]=Se?1:Te,o[r+4>>2]=Se?0:Re,r=0):r=1,Re=r,Lt=Be,Re|0)}function Gr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0;Y=Lt,Lt=Lt+288|0,T=Y+264|0,B=Y+96|0,j=Y,_=j,w=_+96|0;do o[_>>2]=0,_=_+4|0;while((_|0)<(w|0));return l=Sa(l,j)|0,l|0?(d=l,Lt=Y,d|0):(l=j,_=o[l>>2]|0,l=o[l+4>>2]|0,mr(_,l,T)|0,Nr(_,l,B)|0,ce=+Vi(T,B+8|0),ce=+jr(+(+Vi(i,r)/(ce*2))),ke[oi>>3]=ce,l=~~ce>>>0,_=+Jt(ce)>=1?ce>0?~~+ur(+Ai(ce/4294967296),4294967295)>>>0:~~+jr((ce-+(~~ce>>>0))/4294967296)>>>0:0,(o[oi+4>>2]&2146435072|0)==2146435072?(d=1,Lt=Y,d|0):(j=(l|0)==0&(_|0)==0,o[d>>2]=j?1:l,o[d+4>>2]=j?0:_,d=0,Lt=Y,d|0))}function nr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0,o[i>>2]=r,o[i+4>>2]=l,o[i+8>>2]=d}function wr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0;Se=r+8|0,o[Se>>2]=0,j=+ke[i>>3],T=+Jt(+j),Y=+ke[i+8>>3],B=+Jt(+Y)/.8660254037844386,T=T+B*.5,l=~~T,i=~~B,T=T-+(l|0),B=B-+(i|0);do if(T<.5)if(T<.3333333333333333)if(o[r>>2]=l,B<(T+1)*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}else if(Te=1-T,i=(!(B<Te)&1)+i|0,o[r+4>>2]=i,Te<=B&B<T*2){l=l+1|0,o[r>>2]=l;break}else{o[r>>2]=l;break}else{if(!(T<.6666666666666666))if(l=l+1|0,o[r>>2]=l,B<T*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}if(B<1-T){if(o[r+4>>2]=i,T*2+-1<B){o[r>>2]=l;break}}else i=i+1|0,o[r+4>>2]=i;l=l+1|0,o[r>>2]=l}while(!1);do if(j<0)if(i&1){ce=(i+1|0)/2|0,ce=R(l|0,((l|0)<0)<<31>>31|0,ce|0,((ce|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-((+(ce>>>0)+4294967296*+(Ut()|0))*2+1)),o[r>>2]=l;break}else{ce=(i|0)/2|0,ce=R(l|0,((l|0)<0)<<31>>31|0,ce|0,((ce|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-(+(ce>>>0)+4294967296*+(Ut()|0))*2),o[r>>2]=l;break}while(!1);ce=r+4|0,Y<0&&(l=l-((i<<1|1|0)/2|0)|0,o[r>>2]=l,i=0-i|0,o[ce>>2]=i),d=i-l|0,(l|0)<0?(_=0-l|0,o[ce>>2]=d,o[Se>>2]=_,o[r>>2]=0,i=d,l=0):_=0,(i|0)<0&&(l=l-i|0,o[r>>2]=l,_=_-i|0,o[Se>>2]=_,o[ce>>2]=0,i=0),w=l-_|0,d=i-_|0,(_|0)<0&&(o[r>>2]=w,o[ce>>2]=d,o[Se>>2]=0,i=d,l=w,_=0),d=(i|0)<(l|0)?i:l,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[r>>2]=l-d,o[ce>>2]=i-d,o[Se>>2]=_-d)}function Dr(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,(r|0)<0&&(l=l-r|0,o[T>>2]=l,w=i+8|0,o[w>>2]=(o[w>>2]|0)-r,o[i>>2]=0,r=0),(l|0)<0?(r=r-l|0,o[i>>2]=r,w=i+8|0,_=(o[w>>2]|0)-l|0,o[w>>2]=_,o[T>>2]=0,l=0):(_=i+8|0,w=_,_=o[_>>2]|0),(_|0)<0&&(r=r-_|0,o[i>>2]=r,l=l-_|0,o[T>>2]=l,o[w>>2]=0,_=0),d=(l|0)<(r|0)?l:r,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[i>>2]=r-d,o[T>>2]=l-d,o[w>>2]=_-d)}function js(i,r){i=i|0,r=r|0;var l=0,d=0;d=o[i+8>>2]|0,l=+((o[i+4>>2]|0)-d|0),ke[r>>3]=+((o[i>>2]|0)-d|0)-l*.5,ke[r+8>>3]=l*.8660254037844386}function vr(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[r>>2]|0)+(o[i>>2]|0),o[l+4>>2]=(o[r+4>>2]|0)+(o[i+4>>2]|0),o[l+8>>2]=(o[r+8>>2]|0)+(o[i+8>>2]|0)}function Ks(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[i>>2]|0)-(o[r>>2]|0),o[l+4>>2]=(o[i+4>>2]|0)-(o[r+4>>2]|0),o[l+8>>2]=(o[i+8>>2]|0)-(o[r+8>>2]|0)}function Lr(i,r){i=i|0,r=r|0;var l=0,d=0;l=Hi(o[i>>2]|0,r)|0,o[i>>2]=l,l=i+4|0,d=Hi(o[l>>2]|0,r)|0,o[l>>2]=d,i=i+8|0,r=Hi(o[i>>2]|0,r)|0,o[i>>2]=r}function So(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=o[i>>2]|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(w?0-d|0:0)+((o[i+8>>2]|0)-(B?T:0))|0,l=(_|0)<0,i=l?0:_,r=(w?0:d)-(l?_:0)|0,_=(B?0:T)-(w?d:0)-(l?_:0)|0,l=(r|0)<(_|0)?r:_,l=(i|0)<(l|0)?i:l,d=(l|0)>0,i=i-(d?l:0)|0,r=r-(d?l:0)|0;e:do switch(_-(d?l:0)|0){case 0:switch(r|0){case 0:return B=i|0?(i|0)==1?1:7:0,B|0;case 1:return B=i|0?(i|0)==1?3:7:2,B|0;default:break e}case 1:switch(r|0){case 0:return B=i|0?(i|0)==1?5:7:4,B|0;case 1:{if(!i)i=6;else break e;return i|0}default:break e}}while(!1);return B=7,B|0}function Zo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0)||(2147483647-(w<<1)|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0)||(-2147483648-(w<<1)|0)>(w|0))return B=1,B|0;if(r=w*3|0,(_|0)>0){if((2147483647-_|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0))return B=1,B|0;if(d=_<<1,(w|0)>-1){if((r|-2147483648|0)>=(_|0))return B=1,B|0}else if((r^-2147483648|0)<(_|0))return B=1,B|0;if(l){if((2147483647-w|0)<(d|0))r=1;else{l=d;break}return r|0}else{if((-2147483648-w|0)>(d|0))r=1;else{l=d;break}return r|0}}else l=_<<1,r=w*3|0;while(!1);d=hl(+(r-_|0)/7)|0,o[i>>2]=d,_=hl(+(l+w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;Tn(23313,22444,355,22455)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&Tn(23313,22444,355,22455),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;Tn(23313,22444,355,22455)}else{if((r^-2147483648|0)>=(l|0))break;Tn(23313,22444,355,22455)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Ls(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0))return B=1,B|0;if(r=w<<1,(_|0)>0){if((2147483647-_|0)<(_|0)||(2147483647-(_<<1)|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0)||(-2147483648-(_<<1)|0)>(_|0))return B=1,B|0;if(d=_*3|0,l){if((2147483647-r|0)<(_|0))return B=1,B|0}else if((-2147483648-r|0)>(_|0))return B=1,B|0;if((_|0)>-1){if((d|-2147483648|0)<(w|0)){l=d;break}else r=1;return r|0}else{if((d^-2147483648|0)<(w|0))r=1;else{l=d;break}return r|0}}else l=_*3|0,r=w<<1;while(!1);d=hl(+(r+_|0)/7)|0,o[i>>2]=d,_=hl(+(l-w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;Tn(23313,22444,404,22469)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&Tn(23313,22444,404,22469),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;Tn(23313,22444,404,22469)}else{if((r^-2147483648|0)>=(l|0))break;Tn(23313,22444,404,22469)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Il(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=hl(+((r*3|0)-l|0)/7)|0,o[i>>2]=d,r=hl(+((l<<1)+r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function Ao(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=hl(+((r<<1)+l|0)/7)|0,o[i>>2]=d,r=hl(+((l*3|0)-r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function Qo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r*3|0)|0,o[i>>2]=_,l=d+(l*3|0)|0,o[T>>2]=l,r=(d*3|0)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function ca(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r*3|0)+_|0,_=l+(_*3|0)|0,o[i>>2]=_,o[T>>2]=d,r=(l*3|0)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function $s(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;(r+-1|0)>>>0>=6||(_=(o[15440+(r*12|0)>>2]|0)+(o[i>>2]|0)|0,o[i>>2]=_,B=i+4|0,d=(o[15440+(r*12|0)+4>>2]|0)+(o[B>>2]|0)|0,o[B>>2]=d,T=i+8|0,r=(o[15440+(r*12|0)+8>>2]|0)+(o[T>>2]|0)|0,o[T>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[B>>2]=l,o[T>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[T>>2]=r,o[B>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[B>>2]=_-l,o[T>>2]=r-l))}function El(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=r+_|0,_=l+_|0,o[i>>2]=_,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Ha(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,d=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,_=d+r|0,o[i>>2]=_,d=l+d|0,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Ta(i){switch(i=i|0,i|0){case 1:{i=5;break}case 5:{i=4;break}case 4:{i=6;break}case 6:{i=2;break}case 2:{i=3;break}case 3:{i=1;break}}return i|0}function ml(i){switch(i=i|0,i|0){case 1:{i=3;break}case 3:{i=2;break}case 2:{i=6;break}case 6:{i=4;break}case 4:{i=5;break}case 5:{i=1;break}}return i|0}function Cl(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r<<1)|0,o[i>>2]=_,l=d+(l<<1)|0,o[T>>2]=l,r=(d<<1)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function mu(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r<<1)+_|0,_=l+(_<<1)|0,o[i>>2]=_,o[T>>2]=d,r=(l<<1)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function us(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;return T=(o[i>>2]|0)-(o[r>>2]|0)|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(o[r+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(B?0-T|0:0)+(o[i+8>>2]|0)-(o[r+8>>2]|0)+(w?0-d|0:0)|0,i=(_|0)<0,r=i?0:_,l=(w?0:d)-(i?_:0)|0,_=(B?0:T)-(w?d:0)-(i?_:0)|0,i=(l|0)<(_|0)?l:_,i=(r|0)<(i|0)?r:i,d=(i|0)>0,r=r-(d?i:0)|0,l=l-(d?i:0)|0,i=_-(d?i:0)|0,i=(i|0)>-1?i:0-i|0,l=(l|0)>-1?l:0-l|0,r=(r|0)>-1?r:0-r|0,r=(l|0)>(r|0)?l:r,((i|0)>(r|0)?i:r)|0}function rc(i,r){i=i|0,r=r|0;var l=0;l=o[i+8>>2]|0,o[r>>2]=(o[i>>2]|0)-l,o[r+4>>2]=(o[i+4>>2]|0)-l}function io(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;d=o[i>>2]|0,o[r>>2]=d,_=o[i+4>>2]|0,T=r+4|0,o[T>>2]=_,B=r+8|0,o[B>>2]=0,l=(_|0)<(d|0),i=l?d:_,l=l?_:d;do if((l|0)<0){if((i|0)>0){if((i|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-i|0)>=(l|0)))break;return i=1,i|0}if((l|0)==-2147483648|(-2147483648-i|0)>(l|0))return r=1,r|0;if((i|0)>-1){if((i|-2147483648|0)<(l|0))break;return i=1,i|0}else{if((i^-2147483648|0)<(l|0))i=1;else break;return i|0}}while(!1);return i=_-d|0,(d|0)<0?(l=0-d|0,o[T>>2]=i,o[B>>2]=l,o[r>>2]=0,d=0):(i=_,l=0),(i|0)<0&&(d=d-i|0,o[r>>2]=d,l=l-i|0,o[B>>2]=l,o[T>>2]=0,i=0),w=d-l|0,_=i-l|0,(l|0)<0?(o[r>>2]=w,o[T>>2]=_,o[B>>2]=0,i=_,_=w,l=0):_=d,d=(i|0)<(_|0)?i:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(r=0,r|0):(o[r>>2]=_-d,o[T>>2]=i-d,o[B>>2]=l-d,r=0,r|0)}function no(i){i=i|0;var r=0,l=0,d=0,_=0;r=i+8|0,_=o[r>>2]|0,l=_-(o[i>>2]|0)|0,o[i>>2]=l,d=i+4|0,i=(o[d>>2]|0)-_|0,o[d>>2]=i,o[r>>2]=0-(i+l)}function ql(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;l=o[i>>2]|0,r=0-l|0,o[i>>2]=r,T=i+8|0,o[T>>2]=0,B=i+4|0,d=o[B>>2]|0,_=d+l|0,(l|0)>0?(o[B>>2]=_,o[T>>2]=l,o[i>>2]=0,r=0,d=_):l=0,(d|0)<0?(w=r-d|0,o[i>>2]=w,l=l-d|0,o[T>>2]=l,o[B>>2]=0,_=w-l|0,r=0-l|0,(l|0)<0?(o[i>>2]=_,o[B>>2]=r,o[T>>2]=0,d=r,l=0):(d=0,_=w)):_=r,r=(d|0)<(_|0)?d:_,r=(l|0)<(r|0)?l:r,!((r|0)<=0)&&(o[i>>2]=_-r,o[B>>2]=d-r,o[T>>2]=l-r)}function Ro(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0;if(Se=Lt,Lt=Lt+64|0,ce=Se,B=Se+56|0,!(!0&(r&2013265920|0)==134217728&(!0&(d&2013265920|0)==134217728)))return _=5,Lt=Se,_|0;if((i|0)==(l|0)&(r|0)==(d|0))return o[_>>2]=0,_=0,Lt=Se,_|0;if(T=Gt(i|0,r|0,52)|0,Ut()|0,T=T&15,Y=Gt(l|0,d|0,52)|0,Ut()|0,(T|0)!=(Y&15|0))return _=12,Lt=Se,_|0;if(w=T+-1|0,T>>>0>1){Zr(i,r,w,ce)|0,Zr(l,d,w,B)|0,Y=ce,j=o[Y>>2]|0,Y=o[Y+4>>2]|0;e:do if((j|0)==(o[B>>2]|0)&&(Y|0)==(o[B+4>>2]|0)){T=(T^15)*3|0,w=Gt(i|0,r|0,T|0)|0,Ut()|0,w=w&7,T=Gt(l|0,d|0,T|0)|0,Ut()|0,T=T&7;do if((w|0)==0|(T|0)==0)o[_>>2]=1,w=0;else if((w|0)==7)w=5;else{if((w|0)==1|(T|0)==1&&kr(j,Y)|0){w=5;break}if((o[15536+(w<<2)>>2]|0)!=(T|0)&&(o[15568+(w<<2)>>2]|0)!=(T|0))break e;o[_>>2]=1,w=0}while(!1);return _=w,Lt=Se,_|0}while(!1)}w=ce,T=w+56|0;do o[w>>2]=0,w=w+4|0;while((w|0)<(T|0));return Oa(i,r,1,ce)|0,r=ce,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0))&&(r=ce+8|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+16|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+24|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+32|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ce+40|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))?(w=ce+48|0,w=((o[w>>2]|0)==(l|0)?(o[w+4>>2]|0)==(d|0):0)&1):w=1,o[_>>2]=w,_=0,Lt=Se,_|0}function Wo(i,r,l,d,_){return i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,l=Na(i,r,l,d)|0,(l|0)==7?(_=11,_|0):(d=jt(l|0,0,56)|0,r=r&-2130706433|(Ut()|0)|268435456,o[_>>2]=i|d,o[_+4>>2]=r,_=0,_|0)}function Io(i,r,l){return i=i|0,r=r|0,l=l|0,!0&(r&2013265920|0)==268435456?(o[l>>2]=i,o[l+4>>2]=r&-2130706433|134217728,l=0,l|0):(l=6,l|0)}function Us(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return _=Lt,Lt=Lt+16|0,d=_,o[d>>2]=0,!0&(r&2013265920|0)==268435456?(w=Gt(i|0,r|0,56)|0,Ut()|0,d=ls(i,r&-2130706433|134217728,w&7,d,l)|0,Lt=_,d|0):(d=6,Lt=_,d|0)}function Xo(i,r){i=i|0,r=r|0;var l=0;switch(l=Gt(i|0,r|0,56)|0,Ut()|0,l&7){case 0:case 7:return l=0,l|0}return l=r&-2130706433|134217728,!(!0&(r&2013265920|0)==268435456)||!0&(r&117440512|0)==16777216&(kr(i,l)|0)!=0?(l=0,l|0):(l=es(i,l)|0,l|0)}function Yo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return _=Lt,Lt=Lt+16|0,d=_,!0&(r&2013265920|0)==268435456?(w=r&-2130706433|134217728,T=l,o[T>>2]=i,o[T+4>>2]=w,o[d>>2]=0,r=Gt(i|0,r|0,56)|0,Ut()|0,d=ls(i,w,r&7,d,l+8|0)|0,Lt=_,d|0):(d=6,Lt=_,d|0)}function $o(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=(kr(i,r)|0)==0,r=r&-2130706433,d=l,o[d>>2]=_?i:0,o[d+4>>2]=_?r|285212672:0,d=l+8|0,o[d>>2]=i,o[d+4>>2]=r|301989888,d=l+16|0,o[d>>2]=i,o[d+4>>2]=r|318767104,d=l+24|0,o[d>>2]=i,o[d+4>>2]=r|335544320,d=l+32|0,o[d>>2]=i,o[d+4>>2]=r|352321536,l=l+40|0,o[l>>2]=i,o[l+4>>2]=r|369098752,0}function ba(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return T=Lt,Lt=Lt+16|0,_=T,w=r&-2130706433|134217728,!0&(r&2013265920|0)==268435456?(d=Gt(i|0,r|0,56)|0,Ut()|0,d=gn(i,w,d&7)|0,(d|0)==-1?(o[l>>2]=0,w=6,Lt=T,w|0):($r(i,w,_)|0&&Tn(23313,22484,282,22499),r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,kr(i,w)|0?Ko(_,r,d,2,l):fr(_,r,d,2,l),w=0,Lt=T,w|0)):(w=6,Lt=T,w|0)}function ja(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Lt,Lt=Lt+16|0,_=d,Cs(i,r,l,_),wr(_,l+4|0),Lt=d}function Cs(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0;if(B=Lt,Lt=Lt+16|0,j=B,gu(i,l,j),w=+vn(+(1-+ke[j>>3]*.5)),w<1e-16){o[d>>2]=0,o[d+4>>2]=0,o[d+8>>2]=0,o[d+12>>2]=0,Lt=B;return}if(j=o[l>>2]|0,_=+ke[15920+(j*24|0)>>3],_=+gl(_-+gl(+Ft(15600+(j<<4)|0,i))),Gs(r)|0?T=+gl(_+-.3334731722518321):T=_,_=+$t(+w)/.381966011250105,(r|0)>0){i=0;do _=_*2.6457513110645907,i=i+1|0;while((i|0)!=(r|0))}w=+vi(+T)*_,ke[d>>3]=w,T=+wi(+T)*_,ke[d+8>>3]=T,Lt=B}function gu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Lt,Lt=Lt+32|0,_=w,ds(i,_),o[r>>2]=0,ke[l>>3]=5,d=+_r(16400,_),d<+ke[l>>3]&&(o[r>>2]=0,ke[l>>3]=d),d=+_r(16424,_),d<+ke[l>>3]&&(o[r>>2]=1,ke[l>>3]=d),d=+_r(16448,_),d<+ke[l>>3]&&(o[r>>2]=2,ke[l>>3]=d),d=+_r(16472,_),d<+ke[l>>3]&&(o[r>>2]=3,ke[l>>3]=d),d=+_r(16496,_),d<+ke[l>>3]&&(o[r>>2]=4,ke[l>>3]=d),d=+_r(16520,_),d<+ke[l>>3]&&(o[r>>2]=5,ke[l>>3]=d),d=+_r(16544,_),d<+ke[l>>3]&&(o[r>>2]=6,ke[l>>3]=d),d=+_r(16568,_),d<+ke[l>>3]&&(o[r>>2]=7,ke[l>>3]=d),d=+_r(16592,_),d<+ke[l>>3]&&(o[r>>2]=8,ke[l>>3]=d),d=+_r(16616,_),d<+ke[l>>3]&&(o[r>>2]=9,ke[l>>3]=d),d=+_r(16640,_),d<+ke[l>>3]&&(o[r>>2]=10,ke[l>>3]=d),d=+_r(16664,_),d<+ke[l>>3]&&(o[r>>2]=11,ke[l>>3]=d),d=+_r(16688,_),d<+ke[l>>3]&&(o[r>>2]=12,ke[l>>3]=d),d=+_r(16712,_),d<+ke[l>>3]&&(o[r>>2]=13,ke[l>>3]=d),d=+_r(16736,_),d<+ke[l>>3]&&(o[r>>2]=14,ke[l>>3]=d),d=+_r(16760,_),d<+ke[l>>3]&&(o[r>>2]=15,ke[l>>3]=d),d=+_r(16784,_),d<+ke[l>>3]&&(o[r>>2]=16,ke[l>>3]=d),d=+_r(16808,_),d<+ke[l>>3]&&(o[r>>2]=17,ke[l>>3]=d),d=+_r(16832,_),d<+ke[l>>3]&&(o[r>>2]=18,ke[l>>3]=d),d=+_r(16856,_),!(d<+ke[l>>3])){Lt=w;return}o[r>>2]=19,ke[l>>3]=d,Lt=w}function Sr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;if(w=+Ou(i),w<1e-16){r=15600+(r<<4)|0,o[_>>2]=o[r>>2],o[_+4>>2]=o[r+4>>2],o[_+8>>2]=o[r+8>>2],o[_+12>>2]=o[r+12>>2];return}if(T=+qn(+ +ke[i+8>>3],+ +ke[i>>3]),(l|0)>0){i=0;do w=w/2.6457513110645907,i=i+1|0;while((i|0)!=(l|0))}d?(w=w/3,l=(Gs(l)|0)==0,w=+mn(+((l?w:w/2.6457513110645907)*.381966011250105))):(w=+mn(+(w*.381966011250105)),Gs(l)|0&&(T=+gl(T+.3334731722518321))),ti(15600+(r<<4)|0,+gl(+ke[15920+(r*24|0)>>3]-T),w,_)}function Xn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Lt,Lt=Lt+16|0,_=d,js(i+4|0,_),Sr(_,o[i>>2]|0,r,0,l),Lt=d}function Ko(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0,si=0,ji=0,Qi=0,Ei=0,Ui=0,Gi=0,ln=0,Bn=0,rn=0;if(ln=Lt,Lt=Lt+272|0,w=ln+256|0,ct=ln+240|0,Ei=ln,Ui=ln+224|0,Gi=ln+208|0,Et=ln+176|0,wt=ln+160|0,ri=ln+192|0,Yt=ln+144|0,ei=ln+128|0,si=ln+112|0,ji=ln+96|0,Qi=ln+80|0,o[w>>2]=r,o[ct>>2]=o[i>>2],o[ct+4>>2]=o[i+4>>2],o[ct+8>>2]=o[i+8>>2],o[ct+12>>2]=o[i+12>>2],Br(ct,w,Ei),o[_>>2]=0,ct=d+l+((d|0)==5&1)|0,(ct|0)<=(l|0)){Lt=ln;return}j=o[w>>2]|0,Y=Ui+4|0,ce=Et+4|0,Se=l+5|0,Te=16880+(j<<2)|0,Re=16960+(j<<2)|0,Be=ei+8|0,Je=si+8|0,xt=ji+8|0,at=Gi+4|0,B=l;e:for(;;){T=Ei+(((B|0)%5|0)<<4)|0,o[Gi>>2]=o[T>>2],o[Gi+4>>2]=o[T+4>>2],o[Gi+8>>2]=o[T+8>>2],o[Gi+12>>2]=o[T+12>>2];do;while((Za(Gi,j,0,1)|0)==2);if((B|0)>(l|0)&(Gs(r)|0)!=0){if(o[Et>>2]=o[Gi>>2],o[Et+4>>2]=o[Gi+4>>2],o[Et+8>>2]=o[Gi+8>>2],o[Et+12>>2]=o[Gi+12>>2],js(Y,wt),d=o[Et>>2]|0,w=o[17040+(d*80|0)+(o[Ui>>2]<<2)>>2]|0,o[Et>>2]=o[18640+(d*80|0)+(w*20|0)>>2],T=o[18640+(d*80|0)+(w*20|0)+16>>2]|0,(T|0)>0){i=0;do El(ce),i=i+1|0;while((i|0)<(T|0))}switch(T=18640+(d*80|0)+(w*20|0)+4|0,o[ri>>2]=o[T>>2],o[ri+4>>2]=o[T+4>>2],o[ri+8>>2]=o[T+8>>2],Lr(ri,(o[Te>>2]|0)*3|0),vr(ce,ri,ce),Dr(ce),js(ce,Yt),Bn=+(o[Re>>2]|0),ke[ei>>3]=Bn*3,ke[Be>>3]=0,rn=Bn*-1.5,ke[si>>3]=rn,ke[Je>>3]=Bn*2.598076211353316,ke[ji>>3]=rn,ke[xt>>3]=Bn*-2.598076211353316,o[17040+((o[Et>>2]|0)*80|0)+(o[Gi>>2]<<2)>>2]|0){case 1:{i=si,d=ei;break}case 3:{i=ji,d=si;break}case 2:{i=ei,d=ji;break}default:{i=12;break e}}cu(wt,Yt,d,i,Qi),Sr(Qi,o[Et>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1}if((B|0)<(Se|0)&&(js(at,Et),Sr(Et,o[Gi>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),o[Ui>>2]=o[Gi>>2],o[Ui+4>>2]=o[Gi+4>>2],o[Ui+8>>2]=o[Gi+8>>2],o[Ui+12>>2]=o[Gi+12>>2],B=B+1|0,(B|0)>=(ct|0)){i=3;break}}if((i|0)==3){Lt=ln;return}else(i|0)==12&&Tn(22522,22569,571,22579)}function Br(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Lt,Lt=Lt+128|0,d=j+64|0,_=j,w=d,T=20240,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20304,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(Gs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),mu(_),Gs(o[r>>2]|0)|0&&(ca(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,vr(_,d,r),Dr(r),o[l+16>>2]=o[i>>2],r=l+20|0,vr(_,d+12|0,r),Dr(r),o[l+32>>2]=o[i>>2],r=l+36|0,vr(_,d+24|0,r),Dr(r),o[l+48>>2]=o[i>>2],r=l+52|0,vr(_,d+36|0,r),Dr(r),o[l+64>>2]=o[i>>2],l=l+68|0,vr(_,d+48|0,l),Dr(l),Lt=j}function Za(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(Be=Lt,Lt=Lt+32|0,Te=Be+12|0,B=Be,Re=i+4|0,Se=o[16960+(r<<2)>>2]|0,ce=(d|0)!=0,Se=ce?Se*3|0:Se,_=o[Re>>2]|0,Y=i+8|0,T=o[Y>>2]|0,ce){if(w=i+12|0,d=o[w>>2]|0,_=T+_+d|0,(_|0)==(Se|0))return Re=1,Lt=Be,Re|0;j=w}else j=i+12|0,d=o[j>>2]|0,_=T+_+d|0;if((_|0)<=(Se|0))return Re=0,Lt=Be,Re|0;do if((d|0)>0){if(d=o[i>>2]|0,(T|0)>0){w=18640+(d*80|0)+60|0,d=i;break}d=18640+(d*80|0)+40|0,l?(nr(Te,Se,0,0),Ks(Re,Te,B),Ha(B),vr(B,Te,Re),w=d,d=i):(w=d,d=i)}else w=18640+((o[i>>2]|0)*80|0)+20|0,d=i;while(!1);if(o[d>>2]=o[w>>2],_=w+16|0,(o[_>>2]|0)>0){d=0;do El(Re),d=d+1|0;while((d|0)<(o[_>>2]|0))}return i=w+4|0,o[Te>>2]=o[i>>2],o[Te+4>>2]=o[i+4>>2],o[Te+8>>2]=o[i+8>>2],r=o[16880+(r<<2)>>2]|0,Lr(Te,ce?r*3|0:r),vr(Re,Te,Re),Dr(Re),ce?d=((o[Y>>2]|0)+(o[Re>>2]|0)+(o[j>>2]|0)|0)==(Se|0)?1:2:d=2,Re=d,Lt=Be,Re|0}function Jr(i,r){i=i|0,r=r|0;var l=0;do l=Za(i,r,0,1)|0;while((l|0)==2);return l|0}function fr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0,si=0,ji=0,Qi=0,Ei=0;if(ji=Lt,Lt=Lt+240|0,w=ji+224|0,ri=ji+208|0,Yt=ji,ei=ji+192|0,si=ji+176|0,xt=ji+160|0,at=ji+144|0,ct=ji+128|0,Et=ji+112|0,wt=ji+96|0,o[w>>2]=r,o[ri>>2]=o[i>>2],o[ri+4>>2]=o[i+4>>2],o[ri+8>>2]=o[i+8>>2],o[ri+12>>2]=o[i+12>>2],Eo(ri,w,Yt),o[_>>2]=0,Je=d+l+((d|0)==6&1)|0,(Je|0)<=(l|0)){Lt=ji;return}j=o[w>>2]|0,Y=l+6|0,ce=16960+(j<<2)|0,Se=at+8|0,Te=ct+8|0,Re=Et+8|0,Be=ei+4|0,T=0,B=l,d=-1;e:for(;;){if(w=(B|0)%6|0,i=Yt+(w<<4)|0,o[ei>>2]=o[i>>2],o[ei+4>>2]=o[i+4>>2],o[ei+8>>2]=o[i+8>>2],o[ei+12>>2]=o[i+12>>2],i=T,T=Za(ei,j,0,1)|0,(B|0)>(l|0)&(Gs(r)|0)!=0&&(i|0)!=1&&(o[ei>>2]|0)!=(d|0)){switch(js(Yt+(((w+5|0)%6|0)<<4)+4|0,si),js(Yt+(w<<4)+4|0,xt),Qi=+(o[ce>>2]|0),ke[at>>3]=Qi*3,ke[Se>>3]=0,Ei=Qi*-1.5,ke[ct>>3]=Ei,ke[Te>>3]=Qi*2.598076211353316,ke[Et>>3]=Ei,ke[Re>>3]=Qi*-2.598076211353316,w=o[ri>>2]|0,o[17040+(w*80|0)+(((d|0)==(w|0)?o[ei>>2]|0:d)<<2)>>2]|0){case 1:{i=ct,d=at;break}case 3:{i=Et,d=ct;break}case 2:{i=at,d=Et;break}default:{i=8;break e}}cu(si,xt,d,i,wt),!(Nu(si,wt)|0)&&!(Nu(xt,wt)|0)&&(Sr(wt,o[ri>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1)}if((B|0)<(Y|0)&&(js(Be,si),Sr(si,o[ei>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),B=B+1|0,(B|0)>=(Je|0)){i=3;break}else d=o[ei>>2]|0}if((i|0)==3){Lt=ji;return}else(i|0)==8&&Tn(22606,22569,736,22651)}function Eo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Lt,Lt=Lt+160|0,d=j+80|0,_=j,w=d,T=20368,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20448,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(Gs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),mu(_),Gs(o[r>>2]|0)|0&&(ca(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,vr(_,d,r),Dr(r),o[l+16>>2]=o[i>>2],r=l+20|0,vr(_,d+12|0,r),Dr(r),o[l+32>>2]=o[i>>2],r=l+36|0,vr(_,d+24|0,r),Dr(r),o[l+48>>2]=o[i>>2],r=l+52|0,vr(_,d+36|0,r),Dr(r),o[l+64>>2]=o[i>>2],r=l+68|0,vr(_,d+48|0,r),Dr(r),o[l+80>>2]=o[i>>2],l=l+84|0,vr(_,d+60|0,l),Dr(l),Lt=j}function Un(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&15|0}function Ol(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,45)|0,Ut()|0,r&127|0}function es(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;if(!(!0&(r&-16777216|0)==134217728)||(T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127,T>>>0>121))return r=0,r|0;l=Gt(i|0,r|0,52)|0,Ut()|0,l=l&15;do if(l|0){for(_=1,d=0;;){if(w=Gt(i|0,r|0,(15-_|0)*3|0)|0,Ut()|0,w=w&7,(w|0)!=0&(d^1))if((w|0)==1&(it(T)|0)!=0){B=0,d=13;break}else d=1;if((w|0)==7){B=0,d=13;break}if(_>>>0<l>>>0)_=_+1|0;else{d=9;break}}if((d|0)==9){if((l|0)==15)B=1;else break;return B|0}else if((d|0)==13)return B|0}while(!1);for(;;){if(B=Gt(i|0,r|0,(14-l|0)*3|0)|0,Ut()|0,!((B&7|0)==7&!0)){B=0,d=13;break}if(l>>>0<14)l=l+1|0;else{B=1,d=13;break}}return(d|0)==13?B|0:0}function Zr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,l>>>0>15)return d=4,d|0;if((w|0)<(l|0))return d=12,d|0;if((w|0)==(l|0))return o[d>>2]=i,o[d+4>>2]=r,d=0,d|0;if(_=jt(l|0,0,52)|0,_=_|i,i=Ut()|0|r&-15728641,(w|0)>(l|0))do r=jt(7,0,(14-l|0)*3|0)|0,l=l+1|0,_=r|_,i=Ut()|0|i;while((l|0)<(w|0));return o[d>>2]=_,o[d+4>>2]=i,d=0,d|0}function Ts(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,!((l|0)<16&(w|0)<=(l|0)))return d=4,d|0;_=l-w|0,l=Gt(i|0,r|0,45)|0,Ut()|0;e:do if(!(it(l&127)|0))l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;else{t:do if(w|0){for(l=1;T=jt(7,0,(15-l|0)*3|0)|0,!!((T&i|0)==0&((Ut()|0)&r|0)==0);)if(l>>>0<w>>>0)l=l+1|0;else break t;l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;break e}while(!1);l=_l(7,0,_,((_|0)<0)<<31>>31)|0,l=We(l|0,Ut()|0,5,0)|0,l=z(l|0,Ut()|0,-5,-1)|0,l=oe(l|0,Ut()|0,6,0)|0,l=z(l|0,Ut()|0,1,0)|0,_=Ut()|0}while(!1);return T=d,o[T>>2]=l,o[T+4>>2]=_,T=0,T|0}function kr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(it(_&127)|0))return _=0,_|0;_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!_)l=0;else for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0)break e;if(d>>>0<_>>>0)d=d+1|0;else{l=0;break}}while(!1);return _=(l|0)==0&1,_|0}function rr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0;if(T=Lt,Lt=Lt+16|0,w=T,cl(w,i,r,l),r=w,i=o[r>>2]|0,r=o[r+4>>2]|0,(i|0)==0&(r|0)==0)return Lt=T,0;_=0,l=0;do B=d+(_<<3)|0,o[B>>2]=i,o[B+4>>2]=r,_=z(_|0,l|0,1,0)|0,l=Ut()|0,lu(w),B=w,i=o[B>>2]|0,r=o[B+4>>2]|0;while(!((i|0)==0&(r|0)==0));return Lt=T,0}function ll(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,(d|0)<(l|0)?(l=r,d=i,Yi(l|0),d|0):(l=jt(-1,-1,((d-l|0)*3|0)+3|0)|0,d=jt(~l|0,~(Ut()|0)|0,(15-d|0)*3|0)|0,l=~(Ut()|0)&r,d=~d&i,Yi(l|0),d|0)}function Yr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0;return _=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,(l|0)<16&(_|0)<=(l|0)?((_|0)<(l|0)&&(_=jt(-1,-1,((l+-1-_|0)*3|0)+3|0)|0,_=jt(~_|0,~(Ut()|0)|0,(15-l|0)*3|0)|0,r=~(Ut()|0)&r,i=~_&i),_=jt(l|0,0,52)|0,l=r&-15728641|(Ut()|0),o[d>>2]=i|_,o[d+4>>2]=l,d=0,d|0):(d=4,d|0)}function Co(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0,si=0;if((l|0)==0&(d|0)==0)return ei=0,ei|0;if(_=i,w=o[_>>2]|0,_=o[_+4>>2]|0,!0&(_&15728640|0)==0){if(!((d|0)>0|(d|0)==0&l>>>0>0)||(ei=r,o[ei>>2]=w,o[ei+4>>2]=_,(l|0)==1&(d|0)==0))return ei=0,ei|0;_=1;do ri=i+(_<<3)|0,Yt=o[ri+4>>2]|0,ei=r+(_<<3)|0,o[ei>>2]=o[ri>>2],o[ei+4>>2]=Yt,_=_+1|0;while(0<(d|0)|(d|0)==0&_>>>0<l>>>0);return _=0,_|0}if(wt=l<<3,Yt=Ms(wt)|0,!Yt)return ei=13,ei|0;if(F(Yt|0,i|0,wt|0)|0,ri=D(l,8)|0,!ri)return C(Yt),ei=13,ei|0;e:do if(l|0){t:for(;;){_=Yt,at=o[_>>2]|0,_=o[_+4>>2]|0,ct=Gt(at|0,_|0,52)|0,Ut()|0,ct=ct&15,Et=ct+-1|0,xt=(l|0)>0;i:do if((ct|0)!=0&xt){if(Re=((l|0)<0)<<31>>31,Be=jt(Et|0,0,52)|0,Je=Ut()|0,Et>>>0>15){if(!((at|0)==0&(_|0)==0)){ei=17;break t}for(w=0;;){if(w=w+1|0,(w|0)>=(l|0))break i;if(d=Yt+(w<<3)|0,Je=o[d>>2]|0,d=o[d+4>>2]|0,!((Je|0)==0&(d|0)==0)){_=d,ei=17;break t}}}for(w=0,i=at,d=_;;){if(!((i|0)==0&(d|0)==0)){if(!(!0&(d&117440512|0)==0)){ei=22;break t}if(B=Gt(i|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)<(Et|0)){_=12,ei=28;break t}if((B|0)!=(Et|0)&&(i=i|Be,d=d&-15728641|Je,B>>>0>=ct>>>0)){T=Et;do Te=jt(7,0,(14-T|0)*3|0)|0,T=T+1|0,i=Te|i,d=Ut()|0|d;while(T>>>0<B>>>0)}if(T=Ct(i|0,d|0,l|0,Re|0)|0,Ut()|0,Y=ri+(T<<3)|0,B=Y,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0)T=Y;else for(Te=0;;){if((Te|0)>(l|0)){ei=32;break t}if((j|0)==(i|0)&(B&-117440513|0)==(d|0)){ce=Gt(j|0,B|0,56)|0,Ut()|0,ce=ce&7,Se=ce+1|0,si=Gt(j|0,B|0,45)|0,Ut()|0;n:do if(!(it(si&127)|0))B=7;else{if(j=Gt(j|0,B|0,52)|0,Ut()|0,j=j&15,!j){B=6;break}for(B=1;;){if(si=jt(7,0,(15-B|0)*3|0)|0,!((si&i|0)==0&((Ut()|0)&d|0)==0)){B=7;break n}if(B>>>0<j>>>0)B=B+1|0;else{B=6;break}}}while(!1);if((ce+2|0)>>>0>B>>>0){ei=42;break t}si=jt(Se|0,0,56)|0,d=Ut()|0|d&-117440513,Se=Y,o[Se>>2]=0,o[Se+4>>2]=0,i=si|i}else T=(T+1|0)%(l|0)|0;if(Y=ri+(T<<3)|0,B=Y,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0){T=Y;break}else Te=Te+1|0}si=T,o[si>>2]=i,o[si+4>>2]=d}if(w=w+1|0,(w|0)>=(l|0))break i;d=Yt+(w<<3)|0,i=o[d>>2]|0,d=o[d+4>>2]|0}}while(!1);if((l+5|0)>>>0<11){ei=85;break}if(Je=D((l|0)/6|0,8)|0,!Je){ei=49;break}i:do if(xt){Te=0,Se=0;do{if(B=ri+(Te<<3)|0,d=B,w=o[d>>2]|0,d=o[d+4>>2]|0,!((w|0)==0&(d|0)==0)){j=Gt(w|0,d|0,56)|0,Ut()|0,j=j&7,i=j+1|0,Y=d&-117440513,si=Gt(w|0,d|0,45)|0,Ut()|0;n:do if(it(si&127)|0){if(ce=Gt(w|0,d|0,52)|0,Ut()|0,ce=ce&15,ce|0)for(T=1;;){if(si=jt(7,0,(15-T|0)*3|0)|0,!((w&si|0)==0&(Y&(Ut()|0)|0)==0))break n;if(T>>>0<ce>>>0)T=T+1|0;else break}d=jt(i|0,0,56)|0,w=d|w,d=Ut()|0|Y,i=B,o[i>>2]=w,o[i+4>>2]=d,i=j+2|0}while(!1);(i|0)==7&&(si=Je+(Se<<3)|0,o[si>>2]=w,o[si+4>>2]=d&-117440513,Se=Se+1|0)}Te=Te+1|0}while((Te|0)!=(l|0));if(xt){if(Te=((l|0)<0)<<31>>31,Re=jt(Et|0,0,52)|0,Be=Ut()|0,Et>>>0>15){if(!((at|0)==0&(_|0)==0)){_=4,ei=84;break t}for(_=0;;){if(_=_+1|0,(_|0)>=(l|0)){w=0,_=Se;break i}if(si=Yt+(_<<3)|0,!((o[si>>2]|0)==0&(o[si+4>>2]|0)==0)){_=4,ei=84;break t}}}for(ce=0,w=0,Y=at;;){do if(!((Y|0)==0&(_|0)==0)){if(B=Gt(Y|0,_|0,52)|0,Ut()|0,B=B&15,(B|0)<(Et|0)){_=12,ei=84;break t}do if((B|0)==(Et|0))d=Y,B=_;else{if(d=Y|Re,i=_&-15728641|Be,B>>>0<ct>>>0){B=i;break}T=Et;do si=jt(7,0,(14-T|0)*3|0)|0,T=T+1|0,d=si|d,i=Ut()|0|i;while(T>>>0<B>>>0);B=i}while(!1);for(T=Ct(d|0,B|0,l|0,Te|0)|0,Ut()|0,i=0;;){if((i|0)>(l|0)){ei=77;break t}if(si=ri+(T<<3)|0,j=o[si+4>>2]|0,(j&-117440513|0)==(B|0)&&(o[si>>2]|0)==(d|0)){ei=79;break}if(T=(T+1|0)%(l|0)|0,si=ri+(T<<3)|0,(o[si>>2]|0)==(d|0)&&(o[si+4>>2]|0)==(B|0))break;i=i+1|0}if((ei|0)==79&&(ei=0,!0&(j&117440512|0)==100663296))break;si=r+(w<<3)|0,o[si>>2]=Y,o[si+4>>2]=_,w=w+1|0}while(!1);if(_=ce+1|0,(_|0)>=(l|0)){_=Se;break i}si=Yt+(_<<3)|0,ce=_,Y=o[si>>2]|0,_=o[si+4>>2]|0}}else w=0,_=Se}else w=0,_=0;while(!1);if(O(ri|0,0,wt|0)|0,F(Yt|0,Je|0,_<<3|0)|0,C(Je),_)r=r+(w<<3)|0,l=_;else break e}if((ei|0)==17)!0&(_&117440512|0)==0?(_=4,ei=28):ei=22;else if((ei|0)==32)Tn(23313,22674,362,22684);else{if((ei|0)==42)return C(Yt),C(ri),si=10,si|0;if((ei|0)==49)return C(Yt),C(ri),si=13,si|0;if((ei|0)==77)Tn(23313,22674,462,22684);else{if((ei|0)==84)return C(Je),C(Yt),C(ri),si=_,si|0;if((ei|0)==85){F(r|0,Yt|0,l<<3|0)|0;break}}}if((ei|0)==22)return C(Yt),C(ri),si=5,si|0;if((ei|0)==28)return C(Yt),C(ri),si=_,si|0}while(!1);return C(Yt),C(ri),si=0,si|0}function ul(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0;if(Je=Lt,Lt=Lt+16|0,Be=Je,!((l|0)>0|(l|0)==0&r>>>0>0))return Be=0,Lt=Je,Be|0;if((T|0)>=16)return Be=12,Lt=Je,Be|0;Te=0,Re=0,Se=0,B=0;e:for(;;){if(Y=i+(Te<<3)|0,j=o[Y>>2]|0,Y=o[Y+4>>2]|0,ce=Gt(j|0,Y|0,52)|0,Ut()|0,(ce&15|0)>(T|0)){B=12,j=11;break}if(cl(Be,j,Y,T),ce=Be,Y=o[ce>>2]|0,ce=o[ce+4>>2]|0,(Y|0)==0&(ce|0)==0)j=Se;else{j=Se;do{if(!((B|0)<(w|0)|(B|0)==(w|0)&j>>>0<_>>>0)){j=10;break e}Se=d+(j<<3)|0,o[Se>>2]=Y,o[Se+4>>2]=ce,j=z(j|0,B|0,1,0)|0,B=Ut()|0,lu(Be),Se=Be,Y=o[Se>>2]|0,ce=o[Se+4>>2]|0}while(!((Y|0)==0&(ce|0)==0))}if(Te=z(Te|0,Re|0,1,0)|0,Re=Ut()|0,(Re|0)<(l|0)|(Re|0)==(l|0)&Te>>>0<r>>>0)Se=j;else{B=0,j=11;break}}return(j|0)==10?(Be=14,Lt=Je,Be|0):(j|0)==11?(Lt=Je,B|0):0}function Qr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0;Te=Lt,Lt=Lt+16|0,Se=Te;e:do if((l|0)>0|(l|0)==0&r>>>0>0){for(Y=0,T=0,w=0,ce=0;;){if(j=i+(Y<<3)|0,B=o[j>>2]|0,j=o[j+4>>2]|0,!((B|0)==0&(j|0)==0)&&(j=(Ts(B,j,d,Se)|0)==0,B=Se,T=z(o[B>>2]|0,o[B+4>>2]|0,T|0,w|0)|0,w=Ut()|0,!j)){w=12;break}if(Y=z(Y|0,ce|0,1,0)|0,ce=Ut()|0,!((ce|0)<(l|0)|(ce|0)==(l|0)&Y>>>0<r>>>0))break e}return Lt=Te,w|0}else T=0,w=0;while(!1);return o[_>>2]=T,o[_+4>>2]=w,_=0,Lt=Te,_|0}function hs(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&1|0}function wa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=0,_|0;for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0){d=5;break}if(d>>>0<_>>>0)d=d+1|0;else{l=0,d=5;break}}return(d|0)==5?l|0:0}function Tl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Yi(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=jt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=jt(Ta(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(T=(15-l|0)*3|0,_=Gt(i|0,r|0,T|0)|0,Ut()|0,w=jt(7,0,T|0)|0,r=r&~(Ut()|0),T=jt(Ta(_&7)|0,0,T|0)|0,i=i&~w|T,r=r|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Yi(r|0),i|0}function To(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Yi(l|0),d|0;for(l=1;w=(15-l|0)*3|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,_=jt(7,0,w|0)|0,r=r&~(Ut()|0),w=jt(Ta(T&7)|0,0,w|0)|0,i=w|i&~_,r=Ut()|0|r,l>>>0<d>>>0;)l=l+1|0;return Yi(r|0),i|0}function kl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Yi(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=jt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=jt(ml(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(_=(15-l|0)*3|0,w=jt(7,0,_|0)|0,T=r&~(Ut()|0),r=Gt(i|0,r|0,_|0)|0,Ut()|0,r=jt(ml(r&7)|0,0,_|0)|0,i=i&~w|r,r=T|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Yi(r|0),i|0}function fo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Yi(l|0),d|0;for(l=1;T=(15-l|0)*3|0,w=jt(7,0,T|0)|0,_=r&~(Ut()|0),r=Gt(i|0,r|0,T|0)|0,Ut()|0,r=jt(ml(r&7)|0,0,T|0)|0,i=r|i&~w,r=Ut()|0|_,l>>>0<d>>>0;)l=l+1|0;return Yi(r|0),i|0}function Js(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0;if(j=Lt,Lt=Lt+64|0,B=j+40|0,d=j+24|0,_=j+12|0,w=j,jt(r|0,0,52)|0,l=Ut()|0|134225919,!r)return(o[i+4>>2]|0)>2||(o[i+8>>2]|0)>2||(o[i+12>>2]|0)>2?(T=0,B=0,Yi(T|0),Lt=j,B|0):(jt(Wt(i)|0,0,45)|0,T=Ut()|0|l,B=-1,Yi(T|0),Lt=j,B|0);if(o[B>>2]=o[i>>2],o[B+4>>2]=o[i+4>>2],o[B+8>>2]=o[i+8>>2],o[B+12>>2]=o[i+12>>2],T=B+4|0,(r|0)>0)for(i=-1;o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],r&1?(Il(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],Qo(_)):(Ao(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],ca(_)),Ks(d,_,w),Dr(w),ce=(15-r|0)*3|0,Y=jt(7,0,ce|0)|0,l=l&~(Ut()|0),ce=jt(So(w)|0,0,ce|0)|0,i=ce|i&~Y,l=Ut()|0|l,(r|0)>1;)r=r+-1|0;else i=-1;e:do if((o[T>>2]|0)<=2&&(o[B+8>>2]|0)<=2&&(o[B+12>>2]|0)<=2){if(d=Wt(B)|0,r=jt(d|0,0,45)|0,r=r|i,i=Ut()|0|l&-1040385,w=Ii(B)|0,!(it(d)|0)){if((w|0)<=0)break;for(_=0;;){if(d=Gt(r|0,i|0,52)|0,Ut()|0,d=d&15,d)for(l=1;ce=(15-l|0)*3|0,B=Gt(r|0,i|0,ce|0)|0,Ut()|0,Y=jt(7,0,ce|0)|0,i=i&~(Ut()|0),ce=jt(Ta(B&7)|0,0,ce|0)|0,r=r&~Y|ce,i=i|(Ut()|0),l>>>0<d>>>0;)l=l+1|0;if(_=_+1|0,(_|0)==(w|0))break e}}_=Gt(r|0,i|0,52)|0,Ut()|0,_=_&15;t:do if(_){l=1;i:for(;;){switch(ce=Gt(r|0,i|0,(15-l|0)*3|0)|0,Ut()|0,ce&7){case 1:break i;case 0:break;default:break t}if(l>>>0<_>>>0)l=l+1|0;else break t}if(fn(d,o[B>>2]|0)|0)for(l=1;B=(15-l|0)*3|0,Y=jt(7,0,B|0)|0,ce=i&~(Ut()|0),i=Gt(r|0,i|0,B|0)|0,Ut()|0,i=jt(ml(i&7)|0,0,B|0)|0,r=r&~Y|i,i=ce|(Ut()|0),l>>>0<_>>>0;)l=l+1|0;else for(l=1;ce=(15-l|0)*3|0,B=Gt(r|0,i|0,ce|0)|0,Ut()|0,Y=jt(7,0,ce|0)|0,i=i&~(Ut()|0),ce=jt(Ta(B&7)|0,0,ce|0)|0,r=r&~Y|ce,i=i|(Ut()|0),l>>>0<_>>>0;)l=l+1|0}while(!1);if((w|0)>0){l=0;do r=Tl(r,i)|0,i=Ut()|0,l=l+1|0;while((l|0)!=(w|0))}}else r=0,i=0;while(!1);return Y=i,ce=r,Yi(Y|0),Lt=j,ce|0}function Gs(i){return i=i|0,(i|0)%2|0|0}function Qa(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=Lt,Lt=Lt+16|0,d=_,r>>>0>15?(d=4,Lt=_,d|0):(o[i+4>>2]&2146435072|0)==2146435072||(o[i+8+4>>2]&2146435072|0)==2146435072?(d=3,Lt=_,d|0):(ja(i,r,d),r=Js(d,r)|0,d=Ut()|0,o[l>>2]=r,o[l+4>>2]=d,(r|0)==0&(d|0)==0&&Tn(23313,22674,786,22697),d=0,Lt=_,d|0)}function Jo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(_=l+4|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,T=Gt(i|0,r|0,45)|0,Ut()|0,d=(w|0)==0,it(T&127)|0){if(d)return T=1,T|0;d=1}else{if(d)return T=0,T|0;!(o[_>>2]|0)&&!(o[l+8>>2]|0)?d=(o[l+12>>2]|0)!=0&1:d=1}for(l=1;l&1?Qo(_):ca(_),T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,$s(_,T&7),l>>>0<w>>>0;)l=l+1|0;return d|0}function $r(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0;if(ce=Lt,Lt=Lt+16|0,j=ce,Y=Gt(i|0,r|0,45)|0,Ut()|0,Y=Y&127,Y>>>0>121)return o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,o[l+12>>2]=0,Y=5,Lt=ce,Y|0;e:do if(it(Y)|0&&(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,(w|0)!=0)){d=1;t:for(;;){switch(B=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,B&7){case 5:break t;case 0:break;default:{d=r;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=r;break e}}for(_=1,d=r;r=(15-_|0)*3|0,T=jt(7,0,r|0)|0,B=d&~(Ut()|0),d=Gt(i|0,d|0,r|0)|0,Ut()|0,d=jt(ml(d&7)|0,0,r|0)|0,i=i&~T|d,d=B|(Ut()|0),_>>>0<w>>>0;)_=_+1|0}else d=r;while(!1);if(B=7696+(Y*28|0)|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],!(Jo(i,d,l)|0))return Y=0,Lt=ce,Y|0;if(T=l+4|0,o[j>>2]=o[T>>2],o[j+4>>2]=o[T+4>>2],o[j+8>>2]=o[T+8>>2],w=Gt(i|0,d|0,52)|0,Ut()|0,B=w&15,w&1?(ca(T),w=B+1|0):w=B,!(it(Y)|0))d=0;else{e:do if(!B)d=0;else for(r=1;;){if(_=Gt(i|0,d|0,(15-r|0)*3|0)|0,Ut()|0,_=_&7,_|0){d=_;break e}if(r>>>0<B>>>0)r=r+1|0;else{d=0;break}}while(!1);d=(d|0)==4&1}if(!(Za(l,w,d,0)|0))(w|0)!=(B|0)&&(o[T>>2]=o[j>>2],o[T+4>>2]=o[j+4>>2],o[T+8>>2]=o[j+8>>2]);else{if(it(Y)|0)do;while(Za(l,w,0,0)|0);(w|0)!=(B|0)&&Ao(T)}return Y=0,Lt=ce,Y|0}function mr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=Lt,Lt=Lt+16|0,d=w,_=$r(i,r,d)|0,_|0?(Lt=w,_|0):(_=Gt(i|0,r|0,52)|0,Ut()|0,Xn(d,_&15,l),_=0,Lt=w,_|0)}function Nr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(T=Lt,Lt=Lt+16|0,w=T,d=$r(i,r,w)|0,d|0)return w=d,Lt=T,w|0;d=Gt(i|0,r|0,45)|0,Ut()|0,d=(it(d&127)|0)==0,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!d){if(_|0)for(d=1;;){if(B=jt(7,0,(15-d|0)*3|0)|0,!((B&i|0)==0&((Ut()|0)&r|0)==0))break e;if(d>>>0<_>>>0)d=d+1|0;else break}return Ko(w,_,0,5,l),B=0,Lt=T,B|0}while(!1);return fr(w,_,0,6,l),B=0,Lt=T,B|0}function ha(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(it(_&127)|0))return _=2,o[l>>2]=_,0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=5,o[l>>2]=_,0;for(d=1;;){if(w=jt(7,0,(15-d|0)*3|0)|0,!((w&i|0)==0&((Ut()|0)&r|0)==0)){d=2,i=6;break}if(d>>>0<_>>>0)d=d+1|0;else{d=5,i=6;break}}return(i|0)==6&&(o[l>>2]=d),0}function po(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0;Se=Lt,Lt=Lt+128|0,Y=Se+112|0,w=Se+96|0,ce=Se,_=Gt(i|0,r|0,52)|0,Ut()|0,B=_&15,o[Y>>2]=B,T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127;e:do if(it(T)|0){if(B|0)for(d=1;;){if(j=jt(7,0,(15-d|0)*3|0)|0,!((j&i|0)==0&((Ut()|0)&r|0)==0)){_=0;break e}if(d>>>0<B>>>0)d=d+1|0;else break}if(_&1)_=1;else return j=jt(B+1|0,0,52)|0,ce=Ut()|0|r&-15728641,Y=jt(7,0,(14-B|0)*3|0)|0,ce=po((j|i)&~Y,ce&~(Ut()|0),l)|0,Lt=Se,ce|0}else _=0;while(!1);if(d=$r(i,r,w)|0,!d){_?(Br(w,Y,ce),j=5):(Eo(w,Y,ce),j=6);e:do if(it(T)|0)if(!B)i=5;else for(d=1;;){if(T=jt(7,0,(15-d|0)*3|0)|0,!((T&i|0)==0&((Ut()|0)&r|0)==0)){i=2;break e}if(d>>>0<B>>>0)d=d+1|0;else{i=5;break}}else i=2;while(!1);O(l|0,-1,i<<2|0)|0;e:do if(_)for(w=0;;){if(T=ce+(w<<4)|0,Jr(T,o[Y>>2]|0)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}else for(w=0;;){if(T=ce+(w<<4)|0,Za(T,o[Y>>2]|0,0,1)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}while(!1)}return ce=d,Lt=Se,ce|0}function ea(){return 12}function Sa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i>>>0>15)return B=4,B|0;if(jt(i|0,0,52)|0,B=Ut()|0|134225919,!i){l=0,d=0;do it(d)|0&&(jt(d|0,0,45)|0,T=B|(Ut()|0),i=r+(l<<3)|0,o[i>>2]=-1,o[i+4>>2]=T,l=l+1|0),d=d+1|0;while((d|0)!=122);return l=0,l|0}l=0,T=0;do{if(it(T)|0){for(jt(T|0,0,45)|0,d=1,_=-1,w=B|(Ut()|0);j=jt(7,0,(15-d|0)*3|0)|0,_=_&~j,w=w&~(Ut()|0),(d|0)!=(i|0);)d=d+1|0;j=r+(l<<3)|0,o[j>>2]=_,o[j+4>>2]=w,l=l+1|0}T=T+1|0}while((T|0)!=122);return l=0,l|0}function ka(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0;if(ct=Lt,Lt=Lt+16|0,xt=ct,at=Gt(i|0,r|0,52)|0,Ut()|0,at=at&15,l>>>0>15)return at=4,Lt=ct,at|0;if((at|0)<(l|0))return at=12,Lt=ct,at|0;if((at|0)!=(l|0))if(w=jt(l|0,0,52)|0,w=w|i,B=Ut()|0|r&-15728641,(at|0)>(l|0)){j=l;do Je=jt(7,0,(14-j|0)*3|0)|0,j=j+1|0,w=Je|w,B=Ut()|0|B;while((j|0)<(at|0));Je=w}else Je=w;else Je=i,B=r;Be=Gt(Je|0,B|0,45)|0,Ut()|0;e:do if(it(Be&127)|0){if(j=Gt(Je|0,B|0,52)|0,Ut()|0,j=j&15,j|0)for(w=1;;){if(Be=jt(7,0,(15-w|0)*3|0)|0,!((Be&Je|0)==0&((Ut()|0)&B|0)==0)){Y=33;break e}if(w>>>0<j>>>0)w=w+1|0;else break}if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(at|0)>(l|0)){for(Be=r&-15728641,Re=at;;){if(Te=Re,Re=Re+-1|0,Re>>>0>15|(at|0)<(Re|0)){Y=19;break}if((at|0)!=(Re|0))if(w=jt(Re|0,0,52)|0,w=w|i,j=Ut()|0|Be,(at|0)<(Te|0))Se=w;else{Y=Re;do Se=jt(7,0,(14-Y|0)*3|0)|0,Y=Y+1|0,w=Se|w,j=Ut()|0|j;while((Y|0)<(at|0));Se=w}else Se=i,j=r;if(ce=Gt(Se|0,j|0,45)|0,Ut()|0,!(it(ce&127)|0))w=0;else{ce=Gt(Se|0,j|0,52)|0,Ut()|0,ce=ce&15;t:do if(!ce)w=0;else for(Y=1;;){if(w=Gt(Se|0,j|0,(15-Y|0)*3|0)|0,Ut()|0,w=w&7,w|0)break t;if(Y>>>0<ce>>>0)Y=Y+1|0;else{w=0;break}}while(!1);w=(w|0)==0&1}if(j=Gt(i|0,r|0,(15-Te|0)*3|0)|0,Ut()|0,j=j&7,(j|0)==7){_=5,Y=42;break}if(w=(w|0)!=0,(j|0)==1&w){_=5,Y=42;break}if(Se=j+(((j|0)!=0&w)<<31>>31)|0,Se|0&&(Y=at-Te|0,Y=_l(7,0,Y,((Y|0)<0)<<31>>31)|0,ce=Ut()|0,w?(w=We(Y|0,ce|0,5,0)|0,w=z(w|0,Ut()|0,-5,-1)|0,w=oe(w|0,Ut()|0,6,0)|0,w=z(w|0,Ut()|0,1,0)|0,j=Ut()|0):(w=Y,j=ce),Te=Se+-1|0,Te=We(Y|0,ce|0,Te|0,((Te|0)<0)<<31>>31|0)|0,Te=z(w|0,j|0,Te|0,Ut()|0)|0,Se=Ut()|0,ce=d,ce=z(Te|0,Se|0,o[ce>>2]|0,o[ce+4>>2]|0)|0,Se=Ut()|0,Te=d,o[Te>>2]=ce,o[Te+4>>2]=Se),(Re|0)<=(l|0)){Y=37;break}}if((Y|0)==19)Tn(23313,22674,1099,22710);else if((Y|0)==37){T=d,_=o[T+4>>2]|0,T=o[T>>2]|0;break}else if((Y|0)==42)return Lt=ct,_|0}else _=0,T=0}else Y=33;while(!1);e:do if((Y|0)==33)if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(at|0)>(l|0)){for(w=at;;){if(_=Gt(i|0,r|0,(15-w|0)*3|0)|0,Ut()|0,_=_&7,(_|0)==7){_=5;break}if(T=at-w|0,T=_l(7,0,T,((T|0)<0)<<31>>31)|0,_=We(T|0,Ut()|0,_|0,0)|0,T=Ut()|0,Be=d,T=z(o[Be>>2]|0,o[Be+4>>2]|0,_|0,T|0)|0,_=Ut()|0,Be=d,o[Be>>2]=T,o[Be+4>>2]=_,w=w+-1|0,(w|0)<=(l|0))break e}return Lt=ct,_|0}else _=0,T=0;while(!1);return Ts(Je,B,at,xt)|0&&Tn(23313,22674,1063,22725),at=xt,xt=o[at+4>>2]|0,((_|0)>-1|(_|0)==-1&T>>>0>4294967295)&((xt|0)>(_|0)|((xt|0)==(_|0)?(o[at>>2]|0)>>>0>T>>>0:0))?(at=0,Lt=ct,at|0):(Tn(23313,22674,1139,22710),0)}function Wa(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0;if(Se=Lt,Lt=Lt+16|0,T=Se,_>>>0>15)return w=4,Lt=Se,w|0;if(B=Gt(l|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)>(_|0))return w=12,Lt=Se,w|0;if(Ts(l,d,_,T)|0&&Tn(23313,22674,1063,22725),ce=T,Y=o[ce+4>>2]|0,!(((r|0)>-1|(r|0)==-1&i>>>0>4294967295)&((Y|0)>(r|0)|((Y|0)==(r|0)?(o[ce>>2]|0)>>>0>i>>>0:0))))return w=2,Lt=Se,w|0;ce=_-B|0,_=jt(_|0,0,52)|0,j=Ut()|0|d&-15728641,Y=w,o[Y>>2]=_|l,o[Y+4>>2]=j,Y=Gt(l|0,d|0,45)|0,Ut()|0;e:do if(it(Y&127)|0){if(B|0)for(T=1;;){if(Y=jt(7,0,(15-T|0)*3|0)|0,!((Y&l|0)==0&((Ut()|0)&d|0)==0))break e;if(T>>>0<B>>>0)T=T+1|0;else break}if((ce|0)<1)return w=0,Lt=Se,w|0;for(Y=B^15,d=-1,j=1,T=1;;){B=ce-j|0,B=_l(7,0,B,((B|0)<0)<<31>>31)|0,l=Ut()|0;do if(T)if(T=We(B|0,l|0,5,0)|0,T=z(T|0,Ut()|0,-5,-1)|0,T=oe(T|0,Ut()|0,6,0)|0,_=Ut()|0,(r|0)>(_|0)|(r|0)==(_|0)&i>>>0>T>>>0){r=z(i|0,r|0,-1,-1)|0,r=R(r|0,Ut()|0,T|0,_|0)|0,T=Ut()|0,Te=w,Be=o[Te>>2]|0,Te=o[Te+4>>2]|0,Je=(Y+d|0)*3|0,Re=jt(7,0,Je|0)|0,Te=Te&~(Ut()|0),d=oe(r|0,T|0,B|0,l|0)|0,i=Ut()|0,_=z(d|0,i|0,2,0)|0,Je=jt(_|0,Ut()|0,Je|0)|0,Te=Ut()|0|Te,_=w,o[_>>2]=Je|Be&~Re,o[_+4>>2]=Te,i=We(d|0,i|0,B|0,l|0)|0,i=R(r|0,T|0,i|0,Ut()|0)|0,T=0,r=Ut()|0;break}else{Je=w,Re=o[Je>>2]|0,Je=o[Je+4>>2]|0,Be=jt(7,0,(Y+d|0)*3|0)|0,Je=Je&~(Ut()|0),T=w,o[T>>2]=Re&~Be,o[T+4>>2]=Je,T=1;break}else Re=w,_=o[Re>>2]|0,Re=o[Re+4>>2]|0,d=(Y+d|0)*3|0,Te=jt(7,0,d|0)|0,Re=Re&~(Ut()|0),Je=oe(i|0,r|0,B|0,l|0)|0,T=Ut()|0,d=jt(Je|0,T|0,d|0)|0,Re=Ut()|0|Re,Be=w,o[Be>>2]=d|_&~Te,o[Be+4>>2]=Re,T=We(Je|0,T|0,B|0,l|0)|0,i=R(i|0,r|0,T|0,Ut()|0)|0,T=0,r=Ut()|0;while(!1);if((ce|0)>(j|0))d=~j,j=j+1|0;else{r=0;break}}return Lt=Se,r|0}while(!1);if((ce|0)<1)return Je=0,Lt=Se,Je|0;for(_=B^15,T=1;;)if(Be=ce-T|0,Be=_l(7,0,Be,((Be|0)<0)<<31>>31)|0,Je=Ut()|0,j=w,l=o[j>>2]|0,j=o[j+4>>2]|0,B=(_-T|0)*3|0,d=jt(7,0,B|0)|0,j=j&~(Ut()|0),Te=oe(i|0,r|0,Be|0,Je|0)|0,Re=Ut()|0,B=jt(Te|0,Re|0,B|0)|0,j=Ut()|0|j,Y=w,o[Y>>2]=B|l&~d,o[Y+4>>2]=j,Je=We(Te|0,Re|0,Be|0,Je|0)|0,i=R(i|0,r|0,Je|0,Ut()|0)|0,r=Ut()|0,(ce|0)<=(T|0)){r=0;break}else T=T+1|0;return Lt=Se,r|0}function cl(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;_=Gt(r|0,l|0,52)|0,Ut()|0,_=_&15,(r|0)==0&(l|0)==0|((d|0)>15|(_|0)>(d|0))?(d=-1,_=-1,r=0,l=0):(w=ll(r,l,_+1|0,d)|0,l=(Ut()|0)&-15728641,r=jt(d|0,0,52)|0,r=w|r,l=l|(Ut()|0),w=(kr(r,l)|0)==0,d=w?-1:d),w=i,o[w>>2]=r,o[w+4>>2]=l,o[i+8>>2]=_,o[i+12>>2]=d}function lu(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0;if(l=i,r=o[l>>2]|0,l=o[l+4>>2]|0,!((r|0)==0&(l|0)==0)&&(d=Gt(r|0,l|0,52)|0,Ut()|0,d=d&15,B=jt(1,0,(d^15)*3|0)|0,r=z(B|0,Ut()|0,r|0,l|0)|0,l=Ut()|0,B=i,o[B>>2]=r,o[B+4>>2]=l,B=i+8|0,T=o[B>>2]|0,!((d|0)<(T|0)))){for(j=i+12|0,w=d;;){if((w|0)==(T|0)){d=5;break}if(Y=(w|0)==(o[j>>2]|0),_=(15-w|0)*3|0,d=Gt(r|0,l|0,_|0)|0,Ut()|0,d=d&7,Y&((d|0)==1&!0)){d=7;break}if(!((d|0)==7&!0)){d=10;break}if(Y=jt(1,0,_|0)|0,r=z(r|0,l|0,Y|0,Ut()|0)|0,l=Ut()|0,Y=i,o[Y>>2]=r,o[Y+4>>2]=l,(w|0)>(T|0))w=w+-1|0;else{d=10;break}}if((d|0)==5){Y=i,o[Y>>2]=0,o[Y+4>>2]=0,o[B>>2]=-1,o[j>>2]=-1;return}else if((d|0)==7){T=jt(1,0,_|0)|0,T=z(r|0,l|0,T|0,Ut()|0)|0,B=Ut()|0,Y=i,o[Y>>2]=T,o[Y+4>>2]=B,o[j>>2]=w+-1;return}else if((d|0)==10)return}}function gl(i){i=+i;var r=0;return r=i<0?i+6.283185307179586:i,+(i>=6.283185307179586?r+-6.283185307179586:r)}function ro(i,r){return i=i|0,r=r|0,+Jt(+(+ke[i>>3]-+ke[r>>3]))<17453292519943298e-27?(r=+Jt(+(+ke[i+8>>3]-+ke[r+8>>3]))<17453292519943298e-27,r|0):(r=0,r|0)}function mi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+wi(+((_-d)*.5)),l=+wi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+qn(+ +li(+l),+ +li(+(1-l)))*2)}function Vi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+wi(+((_-d)*.5)),l=+wi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+qn(+ +li(+l),+ +li(+(1-l)))*2*6371.007180918475)}function Di(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+wi(+((_-d)*.5)),l=+wi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+qn(+ +li(+l),+ +li(+(1-l)))*2*6371.007180918475*1e3)}function Ft(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;return w=+ke[r>>3],d=+vi(+w),_=+ke[r+8>>3]-+ke[i+8>>3],T=d*+wi(+_),l=+ke[i>>3],+ +qn(+T,+(+wi(+w)*+vi(+l)-+vi(+_)*(d*+wi(+l))))}function ti(i,r,l,d){i=i|0,r=+r,l=+l,d=d|0;var _=0,w=0,T=0,B=0;if(l<1e-16){o[d>>2]=o[i>>2],o[d+4>>2]=o[i+4>>2],o[d+8>>2]=o[i+8>>2],o[d+12>>2]=o[i+12>>2];return}w=r<0?r+6.283185307179586:r,w=r>=6.283185307179586?w+-6.283185307179586:w;do if(w<1e-16)r=+ke[i>>3]+l,ke[d>>3]=r,_=d;else{if(_=+Jt(+(w+-3.141592653589793))<1e-16,r=+ke[i>>3],_){r=r-l,ke[d>>3]=r,_=d;break}if(T=+vi(+l),l=+wi(+l),r=T*+wi(+r)+ +vi(+w)*(l*+vi(+r)),r=r>1?1:r,r=+or(+(r<-1?-1:r)),ke[d>>3]=r,+Jt(+(r+-1.5707963267948966))<1e-16){ke[d>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+Jt(+(r+1.5707963267948966))<1e-16){ke[d>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(B=+vi(+r),w=l*+wi(+w)/B,l=+ke[i>>3],r=(T-+wi(+r)*+wi(+l))/+vi(+l)/B,T=w>1?1:w,r=r>1?1:r,r=+ke[i+8>>3]+ +qn(+(T<-1?-1:T),+(r<-1?-1:r)),r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r;return}while(!1);if(+Jt(+(r+-1.5707963267948966))<1e-16){ke[_>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+Jt(+(r+1.5707963267948966))<1e-16){ke[_>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(r=+ke[i+8>>3],r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r}function xi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20528+(i<<3)>>3],r=0,r|0)}function Fi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20656+(i<<3)>>3],r=0,r|0)}function Ln(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20784+(i<<3)>>3],r=0,r|0)}function Hn(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20912+(i<<3)>>3],r=0,r|0)}function lr(i,r){i=i|0,r=r|0;var l=0;return i>>>0>15?(r=4,r|0):(l=_l(7,0,i,((i|0)<0)<<31>>31)|0,l=We(l|0,Ut()|0,120,0)|0,i=Ut()|0,o[r>>2]=l|2,o[r+4>>2]=i,r=0,r|0)}function Yn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0;return Te=+ke[r>>3],ce=+ke[i>>3],j=+wi(+((Te-ce)*.5)),w=+ke[r+8>>3],Y=+ke[i+8>>3],T=+wi(+((w-Y)*.5)),B=+vi(+ce),Se=+vi(+Te),T=j*j+T*(Se*B*T),T=+qn(+ +li(+T),+ +li(+(1-T)))*2,j=+ke[l>>3],Te=+wi(+((j-Te)*.5)),d=+ke[l+8>>3],w=+wi(+((d-w)*.5)),_=+vi(+j),w=Te*Te+w*(Se*_*w),w=+qn(+ +li(+w),+ +li(+(1-w)))*2,j=+wi(+((ce-j)*.5)),d=+wi(+((Y-d)*.5)),d=j*j+d*(B*_*d),d=+qn(+ +li(+d),+ +li(+(1-d)))*2,_=(T+w+d)*.5,+(+mn(+ +li(+(+$t(+(_*.5))*+$t(+((_-T)*.5))*+$t(+((_-w)*.5))*+$t(+((_-d)*.5)))))*4)}function qs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(B=Lt,Lt=Lt+192|0,w=B+168|0,T=B,_=mr(i,r,w)|0,_|0)return l=_,Lt=B,l|0;if(Nr(i,r,T)|0&&Tn(23313,22742,386,22751),r=o[T>>2]|0,(r|0)>0){if(d=+Yn(T+8|0,T+8+(((r|0)!=1&1)<<4)|0,w)+0,(r|0)!=1){i=1;do _=i,i=i+1|0,d=d+ +Yn(T+8+(_<<4)|0,T+8+(((i|0)%(r|0)|0)<<4)|0,w);while((i|0)<(r|0))}}else d=0;return ke[l>>3]=d,l=0,Lt=B,l|0}function ks(i,r,l){return i=i|0,r=r|0,l=l|0,i=qs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475),i|0}function As(i,r,l){return i=i|0,r=r|0,l=l|0,i=qs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475*1e3*1e3),i|0}function Xa(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0;if(B=Lt,Lt=Lt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,Lt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,Lt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,Y=d,d=+ke[T+8+(i<<4)>>3],ce=+wi(+((d-Y)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+wi(+((_-j)*.5)),j=ce*ce+j*(+vi(+d)*+vi(+Y)*j),w=w+ +qn(+ +li(+j),+ +li(+(1-j)))*2;while((i|0)<(r|0));return ke[l>>3]=w,T=0,Lt=B,T|0}function mo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0;if(B=Lt,Lt=Lt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,ke[l>>3]=w,Lt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,ke[l>>3]=w,Lt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,Y=d,d=+ke[T+8+(i<<4)>>3],ce=+wi(+((d-Y)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+wi(+((_-j)*.5)),j=ce*ce+j*(+vi(+Y)*+vi(+d)*j),w=w+ +qn(+ +li(+j),+ +li(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ce=w,ce=ce*6371.007180918475,ke[l>>3]=ce,Lt=B,T|0}function rs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0;if(B=Lt,Lt=Lt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Lt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Lt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,Y=d,d=+ke[T+8+(i<<4)>>3],ce=+wi(+((d-Y)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+wi(+((_-j)*.5)),j=ce*ce+j*(+vi(+Y)*+vi(+d)*j),w=w+ +qn(+ +li(+j),+ +li(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ce=w,ce=ce*6371.007180918475,ce=ce*1e3,ke[l>>3]=ce,Lt=B,T|0}function Qu(i){i=i|0;var r=0,l=0,d=0;return r=D(1,12)|0,r||Tn(22832,22787,49,22845),l=i+4|0,d=o[l>>2]|0,d|0?(d=d+8|0,o[d>>2]=r,o[l>>2]=r,r|0):(o[i>>2]|0&&Tn(22862,22787,61,22885),d=i,o[d>>2]=r,o[l>>2]=r,r|0)}function Ru(i,r){i=i|0,r=r|0;var l=0,d=0;return d=Ms(24)|0,d||Tn(22899,22787,78,22913),o[d>>2]=o[r>>2],o[d+4>>2]=o[r+4>>2],o[d+8>>2]=o[r+8>>2],o[d+12>>2]=o[r+12>>2],o[d+16>>2]=0,r=i+4|0,l=o[r>>2]|0,l|0?(o[l+16>>2]=d,o[r>>2]=d,d|0):(o[i>>2]|0&&Tn(22928,22787,82,22913),o[i>>2]=d,o[r>>2]=d,d|0)}function go(i){i=i|0;var r=0,l=0,d=0,_=0;if(i)for(d=1;;){if(r=o[i>>2]|0,r|0)do{if(l=o[r>>2]|0,l|0)do _=l,l=o[l+16>>2]|0,C(_);while(l|0);_=r,r=o[r+8>>2]|0,C(_)}while(r|0);if(r=i,i=o[i+8>>2]|0,d||C(r),i)d=0;else break}}function Ml(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0,si=0,ji=0,Qi=0,Ei=0,Ui=0,Gi=0,ln=0,Bn=0,rn=0;if(_=i+8|0,o[_>>2]|0)return rn=1,rn|0;if(d=o[i>>2]|0,!d)return rn=0,rn|0;r=d,l=0;do l=l+1|0,r=o[r+8>>2]|0;while(r|0);if(l>>>0<2)return rn=0,rn|0;ln=Ms(l<<2)|0,ln||Tn(22948,22787,317,22967),Gi=Ms(l<<5)|0,Gi||Tn(22989,22787,321,22967),o[i>>2]=0,Yt=i+4|0,o[Yt>>2]=0,o[_>>2]=0,l=0,Ui=0,ri=0,Se=0;e:for(;;){if(ce=o[d>>2]|0,ce){w=0,T=ce;do{if(j=+ke[T+8>>3],r=T,T=o[T+16>>2]|0,Y=(T|0)==0,_=Y?ce:T,B=+ke[_+8>>3],+Jt(+(j-B))>3.141592653589793){rn=14;break}w=w+(B-j)*(+ke[r>>3]+ +ke[_>>3])}while(!Y);if((rn|0)==14){rn=0,w=0,r=ce;do wt=+ke[r+8>>3],Ei=r+16|0,Qi=o[Ei>>2]|0,Qi=Qi|0?Qi:ce,Et=+ke[Qi+8>>3],w=w+(+ke[r>>3]+ +ke[Qi>>3])*((Et<0?Et+6.283185307179586:Et)-(wt<0?wt+6.283185307179586:wt)),r=o[(r|0?Ei:d)>>2]|0;while(r|0)}w>0?(o[ln+(Ui<<2)>>2]=d,Ui=Ui+1|0,_=ri,r=Se):rn=19}else rn=19;if((rn|0)==19){rn=0;do if(l){if(r=l+8|0,o[r>>2]|0){rn=21;break e}if(l=D(1,12)|0,!l){rn=23;break e}o[r>>2]=l,_=l+4|0,T=l,r=Se}else if(Se){_=Yt,T=Se+8|0,r=d,l=i;break}else if(o[i>>2]|0){rn=27;break e}else{_=Yt,T=i,r=d,l=i;break}while(!1);if(o[T>>2]=d,o[_>>2]=d,T=Gi+(ri<<5)|0,Y=o[d>>2]|0,Y){for(ce=Gi+(ri<<5)+8|0,ke[ce>>3]=17976931348623157e292,Se=Gi+(ri<<5)+24|0,ke[Se>>3]=17976931348623157e292,ke[T>>3]=-17976931348623157e292,Te=Gi+(ri<<5)+16|0,ke[Te>>3]=-17976931348623157e292,at=17976931348623157e292,ct=-17976931348623157e292,_=0,Re=Y,j=17976931348623157e292,Je=17976931348623157e292,xt=-17976931348623157e292,B=-17976931348623157e292;w=+ke[Re>>3],wt=+ke[Re+8>>3],Re=o[Re+16>>2]|0,Be=(Re|0)==0,Et=+ke[(Be?Y:Re)+8>>3],w<j&&(ke[ce>>3]=w,j=w),wt<Je&&(ke[Se>>3]=wt,Je=wt),w>xt?ke[T>>3]=w:w=xt,wt>B&&(ke[Te>>3]=wt,B=wt),at=wt>0&wt<at?wt:at,ct=wt<0&wt>ct?wt:ct,_=_|+Jt(+(wt-Et))>3.141592653589793,!Be;)xt=w;_&&(ke[Te>>3]=ct,ke[Se>>3]=at)}else o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[T+12>>2]=0,o[T+16>>2]=0,o[T+20>>2]=0,o[T+24>>2]=0,o[T+28>>2]=0;_=ri+1|0}if(Ei=d+8|0,d=o[Ei>>2]|0,o[Ei>>2]=0,d)ri=_,Se=r;else{rn=45;break}}if((rn|0)==21)Tn(22765,22787,35,22799);else if((rn|0)==23)Tn(22819,22787,37,22799);else if((rn|0)==27)Tn(22862,22787,61,22885);else if((rn|0)==45){e:do if((Ui|0)>0){for(Ei=(_|0)==0,ji=_<<2,Qi=(i|0)==0,si=0,r=0;;){if(ei=o[ln+(si<<2)>>2]|0,Ei)rn=73;else{if(ri=Ms(ji)|0,!ri){rn=50;break}if(Yt=Ms(ji)|0,!Yt){rn=52;break}t:do if(Qi)l=0;else{for(_=0,l=0,T=i;d=Gi+(_<<5)|0,Pn(o[T>>2]|0,d,o[ei>>2]|0)|0?(o[ri+(l<<2)>>2]=T,o[Yt+(l<<2)>>2]=d,Be=l+1|0):Be=l,T=o[T+8>>2]|0,T;)_=_+1|0,l=Be;if((Be|0)>0)if(d=o[ri>>2]|0,(Be|0)==1)l=d;else for(Te=0,Re=-1,l=d,Se=d;;){for(Y=o[Se>>2]|0,d=0,T=0;_=o[o[ri+(T<<2)>>2]>>2]|0,(_|0)==(Y|0)?ce=d:ce=d+((Pn(_,o[Yt+(T<<2)>>2]|0,o[Y>>2]|0)|0)&1)|0,T=T+1|0,(T|0)!=(Be|0);)d=ce;if(_=(ce|0)>(Re|0),l=_?Se:l,d=Te+1|0,(d|0)==(Be|0))break t;Te=d,Re=_?ce:Re,Se=o[ri+(d<<2)>>2]|0}else l=0}while(!1);if(C(ri),C(Yt),l){if(_=l+4|0,d=o[_>>2]|0,d)l=d+8|0;else if(o[l>>2]|0){rn=70;break}o[l>>2]=ei,o[_>>2]=ei}else rn=73}if((rn|0)==73){if(rn=0,r=o[ei>>2]|0,r|0)do Yt=r,r=o[r+16>>2]|0,C(Yt);while(r|0);C(ei),r=1}if(si=si+1|0,(si|0)>=(Ui|0)){Bn=r;break e}}(rn|0)==50?Tn(23004,22787,249,23023):(rn|0)==52?Tn(23042,22787,252,23023):(rn|0)==70&&Tn(22862,22787,61,22885)}else Bn=0;while(!1);return C(ln),C(Gi),rn=Bn,rn|0}return 0}function Pn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0;if(!(qa(r,l)|0)||(r=Ga(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,i=o[i>>2]|0,!i))return i=0,i|0;if(r){r=0,Y=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ce=o[l>>2]|0,ce=ce|0?ce:i,w=+ke[ce>>3],B=+ke[ce+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,Y=B==Y|T==Y?Y+-2220446049250313e-31:Y,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>Y&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}else{r=0,Y=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ce=o[l>>2]|0,ce=ce|0?ce:i,w=+ke[ce>>3],B=+ke[ce+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(Y=T==Y|_==Y?Y+-2220446049250313e-31:Y,T+(_-T)*((d-w)/(j-w))>Y&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}return 0}function Ma(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0;if(ct=Lt,Lt=Lt+32|0,at=ct+16|0,xt=ct,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,Re=Gt(l|0,d|0,52)|0,Ut()|0,(w|0)!=(Re&15|0))return at=12,Lt=ct,at|0;if(Y=Gt(i|0,r|0,45)|0,Ut()|0,Y=Y&127,ce=Gt(l|0,d|0,45)|0,Ut()|0,ce=ce&127,Y>>>0>121|ce>>>0>121)return at=5,Lt=ct,at|0;if(Re=(Y|0)!=(ce|0),Re){if(B=Ar(Y,ce)|0,(B|0)==7)return at=1,Lt=ct,at|0;j=Ar(ce,Y)|0,(j|0)==7?Tn(23066,23090,161,23100):(Be=B,T=j)}else Be=0,T=0;Se=it(Y)|0,Te=it(ce)|0,o[at>>2]=0,o[at+4>>2]=0,o[at+8>>2]=0,o[at+12>>2]=0;do if(Be){if(ce=o[4272+(Y*28|0)+(Be<<2)>>2]|0,B=(ce|0)>0,Te)if(B){Y=0,j=l,B=d;do j=kl(j,B)|0,B=Ut()|0,T=ml(T)|0,(T|0)==1&&(T=ml(1)|0),Y=Y+1|0;while((Y|0)!=(ce|0));ce=T,Y=j,j=B}else ce=T,Y=l,j=d;else if(B){Y=0,j=l,B=d;do j=fo(j,B)|0,B=Ut()|0,T=ml(T)|0,Y=Y+1|0;while((Y|0)!=(ce|0));ce=T,Y=j,j=B}else ce=T,Y=l,j=d;if(Jo(Y,j,at)|0,Re||Tn(23115,23090,191,23100),B=(Se|0)!=0,T=(Te|0)!=0,B&T&&Tn(23142,23090,192,23100),B){if(T=wa(i,r)|0,(T|0)==7){w=5;break}if(kt[21872+(T*7|0)+Be>>0]|0){w=1;break}j=o[21040+(T*28|0)+(Be<<2)>>2]|0,Y=j}else if(T){if(T=wa(Y,j)|0,(T|0)==7){w=5;break}if(kt[21872+(T*7|0)+ce>>0]|0){w=1;break}Y=0,j=o[21040+(ce*28|0)+(T<<2)>>2]|0}else Y=0,j=0;if((Y|j|0)<0)w=5;else{if((j|0)>0){B=at+4|0,T=0;do Ha(B),T=T+1|0;while((T|0)!=(j|0))}if(o[xt>>2]=0,o[xt+4>>2]=0,o[xt+8>>2]=0,$s(xt,Be),w|0)for(;Gs(w)|0?Qo(xt):ca(xt),(w|0)>1;)w=w+-1|0;if((Y|0)>0){w=0;do Ha(xt),w=w+1|0;while((w|0)!=(Y|0))}Je=at+4|0,vr(Je,xt,Je),Dr(Je),Je=51}}else if(Jo(l,d,at)|0,(Se|0)!=0&(Te|0)!=0)if((ce|0)!=(Y|0)&&Tn(23173,23090,261,23100),T=wa(i,r)|0,w=wa(l,d)|0,(T|0)==7|(w|0)==7)w=5;else if(kt[21872+(T*7|0)+w>>0]|0)w=1;else if(T=o[21040+(T*28|0)+(w<<2)>>2]|0,(T|0)>0){B=at+4|0,w=0;do Ha(B),w=w+1|0;while((w|0)!=(T|0));Je=51}else Je=51;else Je=51;while(!1);return(Je|0)==51&&(w=at+4|0,o[_>>2]=o[w>>2],o[_+4>>2]=o[w+4>>2],o[_+8>>2]=o[w+8>>2],w=0),at=w,Lt=ct,at|0}function Sn(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0;if(Je=Lt,Lt=Lt+48|0,Y=Je+36|0,T=Je+24|0,B=Je+12|0,j=Je,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,Te=Gt(i|0,r|0,45)|0,Ut()|0,Te=Te&127,Te>>>0>121)return d=5,Lt=Je,d|0;if(ce=it(Te)|0,jt(_|0,0,52)|0,xt=Ut()|0|134225919,w=d,o[w>>2]=-1,o[w+4>>2]=xt,!_)return _=So(l)|0,(_|0)==7||(_=sr(Te,_)|0,(_|0)==127)?(xt=1,Lt=Je,xt|0):(Re=jt(_|0,0,45)|0,Be=Ut()|0,Te=d,Be=o[Te+4>>2]&-1040385|Be,xt=d,o[xt>>2]=o[Te>>2]|Re,o[xt+4>>2]=Be,xt=0,Lt=Je,xt|0);for(o[Y>>2]=o[l>>2],o[Y+4>>2]=o[l+4>>2],o[Y+8>>2]=o[l+8>>2],l=_;;){if(w=l,l=l+-1|0,o[T>>2]=o[Y>>2],o[T+4>>2]=o[Y+4>>2],o[T+8>>2]=o[Y+8>>2],Gs(w)|0){if(_=Zo(Y)|0,_|0){l=13;break}o[B>>2]=o[Y>>2],o[B+4>>2]=o[Y+4>>2],o[B+8>>2]=o[Y+8>>2],Qo(B)}else{if(_=Ls(Y)|0,_|0){l=13;break}o[B>>2]=o[Y>>2],o[B+4>>2]=o[Y+4>>2],o[B+8>>2]=o[Y+8>>2],ca(B)}if(Ks(T,B,j),Dr(j),_=d,ct=o[_>>2]|0,_=o[_+4>>2]|0,Et=(15-w|0)*3|0,at=jt(7,0,Et|0)|0,_=_&~(Ut()|0),Et=jt(So(j)|0,0,Et|0)|0,_=Ut()|0|_,xt=d,o[xt>>2]=Et|ct&~at,o[xt+4>>2]=_,(w|0)<=1){l=14;break}}e:do if((l|0)!=13&&(l|0)==14)if((o[Y>>2]|0)<=1&&(o[Y+4>>2]|0)<=1&&(o[Y+8>>2]|0)<=1){l=So(Y)|0,_=sr(Te,l)|0,(_|0)==127?j=0:j=it(_)|0;t:do if(l){if(ce){if(_=wa(i,r)|0,(_|0)==7){_=5;break e}if(w=o[21248+(_*28|0)+(l<<2)>>2]|0,(w|0)>0){_=l,l=0;do _=Ta(_)|0,l=l+1|0;while((l|0)!=(w|0))}else _=l;if((_|0)==1){_=9;break e}l=sr(Te,_)|0,(l|0)==127&&Tn(23200,23090,411,23230),it(l)|0?Tn(23245,23090,412,23230):(Be=l,Re=w,Se=_)}else Be=_,Re=0,Se=l;if(B=o[4272+(Te*28|0)+(Se<<2)>>2]|0,(B|0)<=-1&&Tn(23276,23090,419,23230),!j){if((Re|0)<0){_=5;break e}if(Re|0){w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;do l=To(l,w)|0,w=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=w,_=_+1|0;while((_|0)<(Re|0))}if((B|0)<=0){_=Be,l=58;break}for(w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;;)if(l=To(l,w)|0,w=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=w,_=_+1|0,(_|0)==(B|0)){_=Be,l=58;break t}}if(T=Ar(Be,Te)|0,(T|0)==7&&Tn(23066,23090,428,23230),_=d,l=o[_>>2]|0,_=o[_+4>>2]|0,(B|0)>0){w=0;do l=To(l,_)|0,_=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=_,w=w+1|0;while((w|0)!=(B|0))}if(_=wa(l,_)|0,(_|0)==7&&Tn(23313,23090,440,23230),l=It(Be)|0,l=o[(l?21664:21456)+(T*28|0)+(_<<2)>>2]|0,(l|0)<0&&Tn(23313,23090,454,23230),!l)_=Be,l=58;else{T=d,_=0,w=o[T>>2]|0,T=o[T+4>>2]|0;do w=Tl(w,T)|0,T=Ut()|0,Et=d,o[Et>>2]=w,o[Et+4>>2]=T,_=_+1|0;while((_|0)<(l|0));_=Be,l=58}}else if((ce|0)!=0&(j|0)!=0){if(l=wa(i,r)|0,w=d,w=wa(o[w>>2]|0,o[w+4>>2]|0)|0,(l|0)==7|(w|0)==7){_=5;break e}if(w=o[21248+(l*28|0)+(w<<2)>>2]|0,(w|0)<0){_=5;break e}if(!w)l=59;else{B=d,l=0,T=o[B>>2]|0,B=o[B+4>>2]|0;do T=To(T,B)|0,B=Ut()|0,Et=d,o[Et>>2]=T,o[Et+4>>2]=B,l=l+1|0;while((l|0)<(w|0));l=58}}else l=58;while(!1);if((l|0)==58&&j&&(l=59),(l|0)==59&&(Et=d,(wa(o[Et>>2]|0,o[Et+4>>2]|0)|0)==1)){_=9;break}Et=d,at=o[Et>>2]|0,Et=o[Et+4>>2]&-1040385,ct=jt(_|0,0,45)|0,Et=Et|(Ut()|0),_=d,o[_>>2]=at|ct,o[_+4>>2]=Et,_=0}else _=1;while(!1);return Et=_,Lt=Je,Et|0}function Fo(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0;return B=Lt,Lt=Lt+16|0,T=B,_?i=15:(i=Ma(i,r,l,d,T)|0,i||(rc(T,w),i=0)),Lt=B,i|0}function Nl(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;return T=Lt,Lt=Lt+16|0,w=T,d?l=15:(l=io(l,w)|0,l||(l=Sn(i,r,w,_)|0)),Lt=T,l|0}function En(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Lt,Lt=Lt+32|0,T=j+12|0,B=j,w=Ma(i,r,i,r,T)|0,w|0?(B=w,Lt=j,B|0):(i=Ma(i,r,l,d,B)|0,i|0?(B=i,Lt=j,B|0):(T=us(T,B)|0,B=_,o[B>>2]=T,o[B+4>>2]=((T|0)<0)<<31>>31,B=0,Lt=j,B|0))}function Hl(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Lt,Lt=Lt+32|0,T=j+12|0,B=j,w=Ma(i,r,i,r,T)|0,!w&&(w=Ma(i,r,l,d,B)|0,!w)?(d=us(T,B)|0,d=z(d|0,((d|0)<0)<<31>>31|0,1,0)|0,T=Ut()|0,B=_,o[B>>2]=d,o[B+4>>2]=T,B=0,Lt=j,B|0):(B=w,Lt=j,B|0)}function Cn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0,si=0;if(ei=Lt,Lt=Lt+48|0,T=ei+24|0,B=ei+12|0,Yt=ei,w=Ma(i,r,i,r,T)|0,!w&&(w=Ma(i,r,l,d,B)|0,!w)){wt=us(T,B)|0,ri=((wt|0)<0)<<31>>31,o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[B>>2]=0,o[B+4>>2]=0,o[B+8>>2]=0,Ma(i,r,i,r,T)|0&&Tn(23313,23090,691,23299),Ma(i,r,l,d,B)|0&&Tn(23313,23090,696,23299),no(T),no(B),wt?(Se=o[T>>2]|0,Be=+(wt|0),at=T+4|0,Te=o[at>>2]|0,ct=T+8|0,Re=o[ct>>2]|0,Et=T,d=Se,w=Te,l=Re,Je=+((o[B>>2]|0)-Se|0)/Be,xt=+((o[B+4>>2]|0)-Te|0)/Be,Be=+((o[B+8>>2]|0)-Re|0)/Be):(w=T+4|0,l=T+8|0,at=w,ct=l,Et=T,d=o[T>>2]|0,w=o[w>>2]|0,l=o[l>>2]|0,Je=0,xt=0,Be=0),o[Yt>>2]=d,Re=Yt+4|0,o[Re>>2]=w,Te=Yt+8|0,o[Te>>2]=l;e:do if((wt|0)<0)w=0;else for(ce=0,Se=0,w=d;;){Y=+(Se>>>0)+4294967296*+(ce|0),si=Je*Y+ +(w|0),j=xt*Y+ +(o[at>>2]|0),Y=Be*Y+ +(o[ct>>2]|0),l=~~+E(+si),T=~~+E(+j),w=~~+E(+Y),si=+Jt(+(+(l|0)-si)),j=+Jt(+(+(T|0)-j)),Y=+Jt(+(+(w|0)-Y));do if(si>j&si>Y)l=0-(T+w)|0,d=T;else if(B=0-l|0,j>Y){d=B-w|0;break}else{d=T,w=B-T|0;break}while(!1);if(o[Yt>>2]=l,o[Re>>2]=d,o[Te>>2]=w,ql(Yt),w=Sn(i,r,Yt,_+(Se<<3)|0)|0,w|0)break e;if(!((ce|0)<(ri|0)|(ce|0)==(ri|0)&Se>>>0<wt>>>0)){w=0;break e}w=z(Se|0,ce|0,1,0)|0,B=Ut()|0,ce=B,Se=w,w=o[Et>>2]|0}while(!1);return Yt=w,Lt=ei,Yt|0}return Yt=w,Lt=ei,Yt|0}function _l(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if((l|0)==0&(d|0)==0)return _=0,w=1,Yi(_|0),w|0;w=i,_=r,i=1,r=0;do T=(l&1|0)==0&!0,i=We((T?1:w)|0,(T?0:_)|0,i|0,r|0)|0,r=Ut()|0,l=ni(l|0,d|0,1)|0,d=Ut()|0,w=We(w|0,_|0,w|0,_|0)|0,_=Ut()|0;while(!((l|0)==0&(d|0)==0));return Yi(r|0),i|0}function uu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0;if(!(qa(r,l)|0)||(r=Ga(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,Te=o[i>>2]|0,(Te|0)<=0))return Te=0,Te|0;if(Se=o[i+4>>2]|0,r){r=0,ce=_,l=-1,i=0;e:for(;;){for(Y=i;T=+ke[Se+(Y<<4)>>3],_=+ke[Se+(Y<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=Y+1|0,(l|0)>=(Te|0)){l=22;break e}else i=Y,Y=l,l=i;if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,ce=B==ce|T==ce?ce+-2220446049250313e-31:ce,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>ce&&(r=r^1),i=Y+1|0,(i|0)>=(Te|0)){l=22;break}else l=Y}if((l|0)==22)return r|0}else{r=0,ce=_,l=-1,i=0;e:for(;;){for(Y=i;T=+ke[Se+(Y<<4)>>3],_=+ke[Se+(Y<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=Y+1|0,(l|0)>=(Te|0)){l=22;break e}else i=Y,Y=l,l=i;if(ce=T==ce|_==ce?ce+-2220446049250313e-31:ce,T+(_-T)*((d-w)/(j-w))>ce&&(r=r^1),i=Y+1|0,(i|0)>=(Te|0)){l=22;break}else l=Y}if((l|0)==22)return r|0}return 0}function Fu(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0;if(Be=o[i>>2]|0,!Be){o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;return}if(Je=r+8|0,ke[Je>>3]=17976931348623157e292,xt=r+24|0,ke[xt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,at=r+16|0,ke[at>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Te=o[i+4>>2]|0,Y=17976931348623157e292,ce=-17976931348623157e292,Se=0,i=-1,w=17976931348623157e292,T=17976931348623157e292,j=-17976931348623157e292,d=-17976931348623157e292,Re=0;l=+ke[Te+(Re<<4)>>3],B=+ke[Te+(Re<<4)+8>>3],i=i+2|0,_=+ke[Te+(((i|0)==(Be|0)?0:i)<<4)+8>>3],l<w&&(ke[Je>>3]=l,w=l),B<T&&(ke[xt>>3]=B,T=B),l>j?ke[r>>3]=l:l=j,B>d&&(ke[at>>3]=B,d=B),Y=B>0&B<Y?B:Y,ce=B<0&B>ce?B:ce,Se=Se|+Jt(+(B-_))>3.141592653589793,i=Re+1|0,(i|0)!=(Be|0);)ct=Re,j=l,Re=i,i=ct;Se&&(ke[at>>3]=ce,ke[xt>>3]=Y)}}function Vl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0,Yt=0,ei=0;if(Be=o[i>>2]|0,Be){if(Je=r+8|0,ke[Je>>3]=17976931348623157e292,xt=r+24|0,ke[xt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,at=r+16|0,ke[at>>3]=-17976931348623157e292,(Be|0)>0){for(_=o[i+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,d=0,l=-1,j=17976931348623157e292,Y=17976931348623157e292,Se=-17976931348623157e292,T=-17976931348623157e292,ct=0;w=+ke[_+(ct<<4)>>3],ce=+ke[_+(ct<<4)+8>>3],Yt=l+2|0,B=+ke[_+(((Yt|0)==(Be|0)?0:Yt)<<4)+8>>3],w<j&&(ke[Je>>3]=w,j=w),ce<Y&&(ke[xt>>3]=ce,Y=ce),w>Se?ke[r>>3]=w:w=Se,ce>T&&(ke[at>>3]=ce,T=ce),Te=ce>0&ce<Te?ce:Te,Re=ce<0&ce>Re?ce:Re,d=d|+Jt(+(ce-B))>3.141592653589793,l=ct+1|0,(l|0)!=(Be|0);)Yt=ct,Se=w,ct=l,l=Yt;d&&(ke[at>>3]=Re,ke[xt>>3]=Te)}}else o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;if(Yt=i+8|0,l=o[Yt>>2]|0,!((l|0)<=0)){ri=i+12|0,wt=0;do if(_=o[ri>>2]|0,d=wt,wt=wt+1|0,xt=r+(wt<<5)|0,at=o[_+(d<<3)>>2]|0,at){if(ct=r+(wt<<5)+8|0,ke[ct>>3]=17976931348623157e292,i=r+(wt<<5)+24|0,ke[i>>3]=17976931348623157e292,ke[xt>>3]=-17976931348623157e292,Et=r+(wt<<5)+16|0,ke[Et>>3]=-17976931348623157e292,(at|0)>0){for(Be=o[_+(d<<3)+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,_=0,d=-1,Je=0,j=17976931348623157e292,Y=17976931348623157e292,ce=-17976931348623157e292,T=-17976931348623157e292;w=+ke[Be+(Je<<4)>>3],Se=+ke[Be+(Je<<4)+8>>3],d=d+2|0,B=+ke[Be+(((d|0)==(at|0)?0:d)<<4)+8>>3],w<j&&(ke[ct>>3]=w,j=w),Se<Y&&(ke[i>>3]=Se,Y=Se),w>ce?ke[xt>>3]=w:w=ce,Se>T&&(ke[Et>>3]=Se,T=Se),Te=Se>0&Se<Te?Se:Te,Re=Se<0&Se>Re?Se:Re,_=_|+Jt(+(Se-B))>3.141592653589793,d=Je+1|0,(d|0)!=(at|0);)ei=Je,Je=d,ce=w,d=ei;_&&(ke[Et>>3]=Re,ke[i>>3]=Te)}}else o[xt>>2]=0,o[xt+4>>2]=0,o[xt+8>>2]=0,o[xt+12>>2]=0,o[xt+16>>2]=0,o[xt+20>>2]=0,o[xt+24>>2]=0,o[xt+28>>2]=0,l=o[Yt>>2]|0;while((wt|0)<(l|0))}}function yl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(!(uu(i,r,l)|0))return _=0,_|0;if(_=i+8|0,(o[_>>2]|0)<=0)return _=1,_|0;for(d=i+12|0,i=0;;){if(w=i,i=i+1|0,uu((o[d>>2]|0)+(w<<3)|0,r+(i<<5)|0,l)|0){i=0,d=6;break}if((i|0)>=(o[_>>2]|0)){i=1,d=6;break}}return(d|0)==6?i|0:0}function ta(){return 8}function sc(){return 16}function Wu(){return 168}function jl(){return 8}function fs(){return 16}function _a(){return 12}function el(){return 8}function _u(i){return i=i|0,+(+((o[i>>2]|0)>>>0)+4294967296*+(o[i+4>>2]|0))}function Ou(i){i=i|0;var r=0,l=0;return l=+ke[i>>3],r=+ke[i+8>>3],+ +li(+(l*l+r*r))}function cu(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0;Y=+ke[i>>3],j=+ke[r>>3]-Y,B=+ke[i+8>>3],T=+ke[r+8>>3]-B,Se=+ke[l>>3],w=+ke[d>>3]-Se,Te=+ke[l+8>>3],ce=+ke[d+8>>3]-Te,w=(w*(B-Te)-(Y-Se)*ce)/(j*ce-T*w),ke[_>>3]=Y+j*w,ke[_+8>>3]=B+T*w}function Nu(i,r){return i=i|0,r=r|0,+Jt(+(+ke[i>>3]-+ke[r>>3]))<11920928955078125e-23?(r=+Jt(+(+ke[i+8>>3]-+ke[r+8>>3]))<11920928955078125e-23,r|0):(r=0,r|0)}function _r(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return _=+ke[i>>3]-+ke[r>>3],d=+ke[i+8>>3]-+ke[r+8>>3],l=+ke[i+16>>3]-+ke[r+16>>3],+(_*_+d*d+l*l)}function ds(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;l=+ke[i>>3],d=+vi(+l),l=+wi(+l),ke[r+16>>3]=l,l=+ke[i+8>>3],_=d*+vi(+l),ke[r>>3]=_,l=d*+wi(+l),ke[r+8>>3]=l}function gn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Lt,Lt=Lt+16|0,_=w,d=kr(i,r)|0,(l+-1|0)>>>0>5||(d=(d|0)!=0,(l|0)==1&d))return _=-1,Lt=w,_|0;do if(jn(i,r,_)|0)d=-1;else if(d){d=((o[21936+(l<<2)>>2]|0)+5-(o[_>>2]|0)|0)%5|0;break}else{d=((o[21968+(l<<2)>>2]|0)+6-(o[_>>2]|0)|0)%6|0;break}while(!1);return _=d,Lt=w,_|0}function jn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0;if(Y=Lt,Lt=Lt+32|0,T=Y+16|0,B=Y,d=$r(i,r,T)|0,d|0)return l=d,Lt=Y,l|0;w=Ol(i,r)|0,j=wa(i,r)|0,Li(w,B),d=cn(w,o[T>>2]|0)|0;e:do if(it(w)|0){do switch(w|0){case 4:{i=0;break}case 14:{i=1;break}case 24:{i=2;break}case 38:{i=3;break}case 49:{i=4;break}case 58:{i=5;break}case 63:{i=6;break}case 72:{i=7;break}case 83:{i=8;break}case 97:{i=9;break}case 107:{i=10;break}case 117:{i=11;break}default:{d=1;break e}}while(!1);if(_=o[22e3+(i*24|0)+8>>2]|0,r=o[22e3+(i*24|0)+16>>2]|0,i=o[T>>2]|0,(i|0)!=(o[B>>2]|0)&&(B=It(w)|0,i=o[T>>2]|0,B|(i|0)==(r|0)&&(d=(d+1|0)%6|0)),(j|0)==3&(i|0)==(r|0)){d=(d+5|0)%6|0,_=22;break}(j|0)==5&(i|0)==(_|0)&&(d=(d+1|0)%6|0),_=22}else _=22;while(!1);return(_|0)==22&&(o[l>>2]=d,d=0),l=d,Lt=Y,l|0}function Jn(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0;if(Et=Lt,Lt=Lt+32|0,ct=Et+24|0,xt=Et+20|0,Be=Et+8|0,Re=Et+16|0,Te=Et,j=(kr(i,r)|0)==0,j=j?6:5,ce=Gt(i|0,r|0,52)|0,Ut()|0,ce=ce&15,j>>>0<=l>>>0)return d=2,Lt=Et,d|0;Se=(ce|0)==0,!Se&&(Je=jt(7,0,(ce^15)*3|0)|0,(Je&i|0)==0&((Ut()|0)&r|0)==0)?_=l:w=4;e:do if((w|0)==4){if(_=(kr(i,r)|0)!=0,((_?4:5)|0)<(l|0)||jn(i,r,ct)|0||(w=(o[ct>>2]|0)+l|0,_?_=22288+(((w|0)%5|0)<<2)|0:_=22320+(((w|0)%6|0)<<2)|0,Je=o[_>>2]|0,(Je|0)==7))return d=1,Lt=Et,d|0;o[xt>>2]=0,_=ls(i,r,Je,xt,Be)|0;do if(!_){if(B=Be,Y=o[B>>2]|0,B=o[B+4>>2]|0,T=B>>>0<r>>>0|(B|0)==(r|0)&Y>>>0<i>>>0,w=T?Y:i,T=T?B:r,!Se&&(Se=jt(7,0,(ce^15)*3|0)|0,(Y&Se|0)==0&(B&(Ut()|0)|0)==0))_=l;else{if(B=(l+-1+j|0)%(j|0)|0,_=kr(i,r)|0,(B|0)<0&&Tn(23313,23315,245,23324),j=(_|0)!=0,((j?4:5)|0)<(B|0)&&Tn(23313,23315,245,23324),jn(i,r,ct)|0&&Tn(23313,23315,245,23324),_=(o[ct>>2]|0)+B|0,j?_=22288+(((_|0)%5|0)<<2)|0:_=22320+(((_|0)%6|0)<<2)|0,B=o[_>>2]|0,(B|0)==7&&Tn(23313,23315,245,23324),o[Re>>2]=0,_=ls(i,r,B,Re,Te)|0,_|0)break;Y=Te,j=o[Y>>2]|0,Y=o[Y+4>>2]|0;do if(Y>>>0<T>>>0|(Y|0)==(T|0)&j>>>0<w>>>0){if(kr(j,Y)|0?w=Na(j,Y,i,r)|0:w=o[22384+((((o[Re>>2]|0)+(o[22352+(B<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=kr(j,Y)|0,(w+-1|0)>>>0>5){_=-1,w=j,T=Y;break}if(_=(_|0)!=0,(w|0)==1&_){_=-1,w=j,T=Y;break}do if(jn(j,Y,ct)|0)_=-1;else if(_){_=((o[21936+(w<<2)>>2]|0)+5-(o[ct>>2]|0)|0)%5|0;break}else{_=((o[21968+(w<<2)>>2]|0)+6-(o[ct>>2]|0)|0)%6|0;break}while(!1);w=j,T=Y}else _=l;while(!1);B=Be,Y=o[B>>2]|0,B=o[B+4>>2]|0}if((w|0)==(Y|0)&(T|0)==(B|0)){if(j=(kr(Y,B)|0)!=0,j?i=Na(Y,B,i,r)|0:i=o[22384+((((o[xt>>2]|0)+(o[22352+(Je<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=kr(Y,B)|0,(i+-1|0)>>>0<=5&&(at=(_|0)!=0,!((i|0)==1&at)))do if(jn(Y,B,ct)|0)_=-1;else if(at){_=((o[21936+(i<<2)>>2]|0)+5-(o[ct>>2]|0)|0)%5|0;break}else{_=((o[21968+(i<<2)>>2]|0)+6-(o[ct>>2]|0)|0)%6|0;break}while(!1);else _=-1;_=_+1|0,_=(_|0)==6|j&(_|0)==5?0:_}r=T,i=w;break e}while(!1);return d=_,Lt=Et,d|0}while(!1);return at=jt(_|0,0,56)|0,ct=Ut()|0|r&-2130706433|536870912,o[d>>2]=at|i,o[d+4>>2]=ct,d=0,Lt=Et,d|0}function tl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=(kr(i,r)|0)==0,d=Jn(i,r,0,l)|0,_=(d|0)==0,w?!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d)?(w=d,w|0):Jn(i,r,5,l+40|0)|0:!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d|0)?(w=d,w|0):(w=l+40|0,o[w>>2]=0,o[w+4>>2]=0,w=0,w|0)}function Tu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;return j=Lt,Lt=Lt+192|0,_=j,w=j+168|0,T=Gt(i|0,r|0,56)|0,Ut()|0,T=T&7,B=r&-2130706433|134217728,d=$r(i,B,w)|0,d|0?(B=d,Lt=j,B|0):(r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,kr(i,B)|0?Ko(w,r,T,1,_):fr(w,r,T,1,_),B=_+8|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],B=0,Lt=j,B|0)}function oa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=Lt,Lt=Lt+16|0,l=_,!(!0&(r&2013265920|0)==536870912)||(d=r&-2130706433|134217728,!(es(i,d)|0))?(d=0,Lt=_,d|0):(w=Gt(i|0,r|0,56)|0,Ut()|0,w=(Jn(i,d,w&7,l)|0)==0,d=l,d=w&((o[d>>2]|0)==(i|0)?(o[d+4>>2]|0)==(r|0):0)&1,Lt=_,d|0)}function yu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0;(r|0)>0?(d=D(r,4)|0,o[i>>2]=d,d||Tn(23337,23360,40,23374)):o[i>>2]=0,o[i+4>>2]=r,o[i+8>>2]=0,o[i+12>>2]=l}function vs(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=i+4|0,w=i+12|0,T=i+8|0;e:for(;;){for(l=o[_>>2]|0,r=0;;){if((r|0)>=(l|0))break e;if(d=o[i>>2]|0,B=o[d+(r<<2)>>2]|0,!B)r=r+1|0;else break}r=d+(~~(+Jt(+(+zi(10,+ +(15-(o[w>>2]|0)|0))*(+ke[B>>3]+ +ke[B+8>>3])))%+(l|0))>>>0<<2)|0,l=o[r>>2]|0;t:do if(l|0){if(d=B+32|0,(l|0)==(B|0))o[r>>2]=o[d>>2];else{if(l=l+32|0,r=o[l>>2]|0,!r)break;for(;(r|0)!=(B|0);)if(l=r+32|0,r=o[l>>2]|0,!r)break t;o[l>>2]=o[d>>2]}C(B),o[T>>2]=(o[T>>2]|0)+-1}while(!1)}C(o[i>>2]|0)}function ko(i){i=i|0;var r=0,l=0,d=0;for(d=o[i+4>>2]|0,l=0;;){if((l|0)>=(d|0)){r=0,l=4;break}if(r=o[(o[i>>2]|0)+(l<<2)>>2]|0,!r)l=l+1|0;else{l=4;break}}return(l|0)==4?r|0:0}function ki(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;if(l=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,l=(o[i>>2]|0)+(l<<2)|0,d=o[l>>2]|0,!d)return w=1,w|0;w=r+32|0;do if((d|0)!=(r|0)){if(l=o[d+32>>2]|0,!l)return w=1,w|0;for(_=l;;){if((_|0)==(r|0)){_=8;break}if(l=o[_+32>>2]|0,l)d=_,_=l;else{l=1,_=10;break}}if((_|0)==8){o[d+32>>2]=o[w>>2];break}else if((_|0)==10)return l|0}else o[l>>2]=o[w>>2];while(!1);return C(r),w=i+8|0,o[w>>2]=(o[w>>2]|0)+-1,w=0,w|0}function Bi(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;w=Ms(40)|0,w||Tn(23390,23360,98,23403),o[w>>2]=o[r>>2],o[w+4>>2]=o[r+4>>2],o[w+8>>2]=o[r+8>>2],o[w+12>>2]=o[r+12>>2],_=w+16|0,o[_>>2]=o[l>>2],o[_+4>>2]=o[l+4>>2],o[_+8>>2]=o[l+8>>2],o[_+12>>2]=o[l+12>>2],o[w+32>>2]=0,_=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=(o[i>>2]|0)+(_<<2)|0,d=o[_>>2]|0;do if(!d)o[_>>2]=w;else{for(;!(ro(d,r)|0&&ro(d+16|0,l)|0);)if(_=o[d+32>>2]|0,d=_|0?_:d,!(o[d+32>>2]|0)){T=10;break}if((T|0)==10){o[d+32>>2]=w;break}return C(w),T=d,T|0}while(!1);return T=i+8|0,o[T>>2]=(o[T>>2]|0)+1,T=w,T|0}function xs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;if(_=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=o[(o[i>>2]|0)+(_<<2)>>2]|0,!_)return l=0,l|0;if(!l){for(i=_;;){if(ro(i,r)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}if((d|0)==10)return i|0}for(i=_;;){if(ro(i,r)|0&&ro(i+16|0,l)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}return(d|0)==10?i|0:0}function vu(i,r){i=i|0,r=r|0;var l=0;if(l=~~(+Jt(+(+zi(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,i=o[(o[i>>2]|0)+(l<<2)>>2]|0,!i)return l=0,l|0;for(;;){if(ro(i,r)|0){r=5;break}if(i=o[i+32>>2]|0,!i){i=0,r=5;break}}return(r|0)==5?i|0:0}function Oo(){return 23424}function cs(i){return i=+i,+ +y(+i)}function hl(i){return i=+i,~~+cs(i)|0}function Ms(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0,Je=0,xt=0,at=0,ct=0,Et=0,wt=0,ri=0;ri=Lt,Lt=Lt+16|0,Te=ri;do if(i>>>0<245){if(Y=i>>>0<11?16:i+11&-8,i=Y>>>3,Se=o[5857]|0,l=Se>>>i,l&3|0)return r=(l&1^1)+i|0,i=23468+(r<<1<<2)|0,l=i+8|0,d=o[l>>2]|0,_=d+8|0,w=o[_>>2]|0,(w|0)==(i|0)?o[5857]=Se&~(1<<r):(o[w+12>>2]=i,o[l>>2]=w),wt=r<<3,o[d+4>>2]=wt|3,wt=d+wt+4|0,o[wt>>2]=o[wt>>2]|1,wt=_,Lt=ri,wt|0;if(ce=o[5859]|0,Y>>>0>ce>>>0){if(l|0)return r=2<<i,r=l<<i&(r|0-r),r=(r&0-r)+-1|0,B=r>>>12&16,r=r>>>B,l=r>>>5&8,r=r>>>l,w=r>>>2&4,r=r>>>w,i=r>>>1&2,r=r>>>i,d=r>>>1&1,d=(l|B|w|i|d)+(r>>>d)|0,r=23468+(d<<1<<2)|0,i=r+8|0,w=o[i>>2]|0,B=w+8|0,l=o[B>>2]|0,(l|0)==(r|0)?(i=Se&~(1<<d),o[5857]=i):(o[l+12>>2]=r,o[i>>2]=l,i=Se),wt=d<<3,T=wt-Y|0,o[w+4>>2]=Y|3,_=w+Y|0,o[_+4>>2]=T|1,o[w+wt>>2]=T,ce|0&&(d=o[5862]|0,r=ce>>>3,l=23468+(r<<1<<2)|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=T,o[5862]=_,wt=B,Lt=ri,wt|0;if(w=o[5858]|0,w){for(l=(w&0-w)+-1|0,_=l>>>12&16,l=l>>>_,d=l>>>5&8,l=l>>>d,T=l>>>2&4,l=l>>>T,B=l>>>1&2,l=l>>>B,j=l>>>1&1,j=o[23732+((d|_|T|B|j)+(l>>>j)<<2)>>2]|0,l=j,B=j,j=(o[j+4>>2]&-8)-Y|0;i=o[l+16>>2]|0,!(!i&&(i=o[l+20>>2]|0,!i));)T=(o[i+4>>2]&-8)-Y|0,_=T>>>0<j>>>0,l=i,B=_?i:B,j=_?T:j;if(T=B+Y|0,T>>>0>B>>>0){_=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){l=0;break}for(;;)if(d=r+20|0,l=o[d>>2]|0,l)r=l,i=d;else if(d=r+16|0,l=o[d>>2]|0,l)r=l,i=d;else break;o[i>>2]=0,l=r}else l=o[B+8>>2]|0,o[l+12>>2]=r,o[r+8>>2]=l,l=r;while(!1);do if(_|0){if(r=o[B+28>>2]|0,i=23732+(r<<2)|0,(B|0)==(o[i>>2]|0)){if(o[i>>2]=l,!l){o[5858]=w&~(1<<r);break}}else if(wt=_+16|0,o[((o[wt>>2]|0)==(B|0)?wt:_+20|0)>>2]=l,!l)break;o[l+24>>2]=_,r=o[B+16>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),r=o[B+20>>2]|0,r|0&&(o[l+20>>2]=r,o[r+24>>2]=l)}while(!1);return j>>>0<16?(wt=j+Y|0,o[B+4>>2]=wt|3,wt=B+wt+4|0,o[wt>>2]=o[wt>>2]|1):(o[B+4>>2]=Y|3,o[T+4>>2]=j|1,o[T+j>>2]=j,ce|0&&(d=o[5862]|0,r=ce>>>3,l=23468+(r<<1<<2)|0,r=1<<r,r&Se?(i=l+8|0,r=o[i>>2]|0):(o[5857]=r|Se,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=j,o[5862]=T),wt=B+8|0,Lt=ri,wt|0}else Se=Y}else Se=Y}else Se=Y}else if(i>>>0<=4294967231)if(i=i+11|0,Y=i&-8,d=o[5858]|0,d){_=0-Y|0,i=i>>>8,i?Y>>>0>16777215?j=31:(Se=(i+1048320|0)>>>16&8,Je=i<<Se,B=(Je+520192|0)>>>16&4,Je=Je<<B,j=(Je+245760|0)>>>16&2,j=14-(B|Se|j)+(Je<<j>>>15)|0,j=Y>>>(j+7|0)&1|j<<1):j=0,l=o[23732+(j<<2)>>2]|0;e:do if(!l)l=0,i=0,Je=61;else for(i=0,B=Y<<((j|0)==31?0:25-(j>>>1)|0),w=0;;){if(T=(o[l+4>>2]&-8)-Y|0,T>>>0<_>>>0)if(T)i=l,_=T;else{i=l,_=0,Je=65;break e}if(Je=o[l+20>>2]|0,l=o[l+16+(B>>>31<<2)>>2]|0,w=(Je|0)==0|(Je|0)==(l|0)?w:Je,l)B=B<<1;else{l=w,Je=61;break}}while(!1);if((Je|0)==61){if((l|0)==0&(i|0)==0){if(i=2<<j,i=(i|0-i)&d,!i){Se=Y;break}Se=(i&0-i)+-1|0,T=Se>>>12&16,Se=Se>>>T,w=Se>>>5&8,Se=Se>>>w,B=Se>>>2&4,Se=Se>>>B,j=Se>>>1&2,Se=Se>>>j,l=Se>>>1&1,i=0,l=o[23732+((w|T|B|j|l)+(Se>>>l)<<2)>>2]|0}l?Je=65:(B=i,T=_)}if((Je|0)==65)for(w=l;;)if(Se=(o[w+4>>2]&-8)-Y|0,l=Se>>>0<_>>>0,_=l?Se:_,i=l?w:i,l=o[w+16>>2]|0,l||(l=o[w+20>>2]|0),l)w=l;else{B=i,T=_;break}if(B|0&&T>>>0<((o[5859]|0)-Y|0)>>>0&&(ce=B+Y|0,ce>>>0>B>>>0)){w=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){r=0;break}for(;;)if(_=r+20|0,l=o[_>>2]|0,l)r=l,i=_;else if(_=r+16|0,l=o[_>>2]|0,l)r=l,i=_;else break;o[i>>2]=0}else wt=o[B+8>>2]|0,o[wt+12>>2]=r,o[r+8>>2]=wt;while(!1);do if(w){if(i=o[B+28>>2]|0,l=23732+(i<<2)|0,(B|0)==(o[l>>2]|0)){if(o[l>>2]=r,!r){d=d&~(1<<i),o[5858]=d;break}}else if(wt=w+16|0,o[((o[wt>>2]|0)==(B|0)?wt:w+20|0)>>2]=r,!r)break;o[r+24>>2]=w,i=o[B+16>>2]|0,i|0&&(o[r+16>>2]=i,o[i+24>>2]=r),i=o[B+20>>2]|0,i&&(o[r+20>>2]=i,o[i+24>>2]=r)}while(!1);e:do if(T>>>0<16)wt=T+Y|0,o[B+4>>2]=wt|3,wt=B+wt+4|0,o[wt>>2]=o[wt>>2]|1;else{if(o[B+4>>2]=Y|3,o[ce+4>>2]=T|1,o[ce+T>>2]=T,r=T>>>3,T>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=ce,o[r+12>>2]=ce,o[ce+8>>2]=r,o[ce+12>>2]=l;break}if(r=T>>>8,r?T>>>0>16777215?l=31:(Et=(r+1048320|0)>>>16&8,wt=r<<Et,ct=(wt+520192|0)>>>16&4,wt=wt<<ct,l=(wt+245760|0)>>>16&2,l=14-(ct|Et|l)+(wt<<l>>>15)|0,l=T>>>(l+7|0)&1|l<<1):l=0,r=23732+(l<<2)|0,o[ce+28>>2]=l,i=ce+16|0,o[i+4>>2]=0,o[i>>2]=0,i=1<<l,!(d&i)){o[5858]=d|i,o[r>>2]=ce,o[ce+24>>2]=r,o[ce+12>>2]=ce,o[ce+8>>2]=ce;break}r=o[r>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(T|0)){for(d=T<<((l|0)==31?0:25-(l>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(T|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=ce,o[ce+24>>2]=r,o[ce+12>>2]=ce,o[ce+8>>2]=ce;break e}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=ce,o[Et>>2]=ce,o[ce+8>>2]=wt,o[ce+12>>2]=r,o[ce+24>>2]=0}while(!1);return wt=B+8|0,Lt=ri,wt|0}else Se=Y}else Se=Y;else Se=-1;while(!1);if(l=o[5859]|0,l>>>0>=Se>>>0)return r=l-Se|0,i=o[5862]|0,r>>>0>15?(wt=i+Se|0,o[5862]=wt,o[5859]=r,o[wt+4>>2]=r|1,o[i+l>>2]=r,o[i+4>>2]=Se|3):(o[5859]=0,o[5862]=0,o[i+4>>2]=l|3,wt=i+l+4|0,o[wt>>2]=o[wt>>2]|1),wt=i+8|0,Lt=ri,wt|0;if(T=o[5860]|0,T>>>0>Se>>>0)return ct=T-Se|0,o[5860]=ct,wt=o[5863]|0,Et=wt+Se|0,o[5863]=Et,o[Et+4>>2]=ct|1,o[wt+4>>2]=Se|3,wt=wt+8|0,Lt=ri,wt|0;if(o[5975]|0?i=o[5977]|0:(o[5977]=4096,o[5976]=4096,o[5978]=-1,o[5979]=-1,o[5980]=0,o[5968]=0,o[5975]=Te&-16^1431655768,i=4096),B=Se+48|0,j=Se+47|0,w=i+j|0,_=0-i|0,Y=w&_,Y>>>0<=Se>>>0||(i=o[5967]|0,i|0&&(ce=o[5965]|0,Te=ce+Y|0,Te>>>0<=ce>>>0|Te>>>0>i>>>0)))return wt=0,Lt=ri,wt|0;e:do if(o[5968]&4)r=0,Je=143;else{l=o[5863]|0;t:do if(l){for(d=23876;Te=o[d>>2]|0,!(Te>>>0<=l>>>0&&(Te+(o[d+4>>2]|0)|0)>>>0>l>>>0);)if(i=o[d+8>>2]|0,i)d=i;else{Je=128;break t}if(r=w-T&_,r>>>0<2147483647)if(i=s(r|0)|0,(i|0)==((o[d>>2]|0)+(o[d+4>>2]|0)|0)){if((i|0)!=-1){T=r,w=i,Je=145;break e}}else d=i,Je=136;else r=0}else Je=128;while(!1);do if((Je|0)==128)if(l=s(0)|0,(l|0)!=-1&&(r=l,Re=o[5976]|0,Be=Re+-1|0,r=(Be&r|0?(Be+r&0-Re)-r|0:0)+Y|0,Re=o[5965]|0,Be=r+Re|0,r>>>0>Se>>>0&r>>>0<2147483647)){if(Te=o[5967]|0,Te|0&&Be>>>0<=Re>>>0|Be>>>0>Te>>>0){r=0;break}if(i=s(r|0)|0,(i|0)==(l|0)){T=r,w=l,Je=145;break e}else d=i,Je=136}else r=0;while(!1);do if((Je|0)==136){if(l=0-r|0,!(B>>>0>r>>>0&(r>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){r=0;break}else{T=r,w=d,Je=145;break e}if(i=o[5977]|0,i=j-r+i&0-i,i>>>0>=2147483647){T=r,w=d,Je=145;break e}if((s(i|0)|0)==-1){s(l|0)|0,r=0;break}else{T=i+r|0,w=d,Je=145;break e}}while(!1);o[5968]=o[5968]|4,Je=143}while(!1);if((Je|0)==143&&Y>>>0<2147483647&&(ct=s(Y|0)|0,Be=s(0)|0,xt=Be-ct|0,at=xt>>>0>(Se+40|0)>>>0,!((ct|0)==-1|at^1|ct>>>0<Be>>>0&((ct|0)!=-1&(Be|0)!=-1)^1))&&(T=at?xt:r,w=ct,Je=145),(Je|0)==145){r=(o[5965]|0)+T|0,o[5965]=r,r>>>0>(o[5966]|0)>>>0&&(o[5966]=r),j=o[5863]|0;e:do if(j){for(r=23876;;){if(i=o[r>>2]|0,l=o[r+4>>2]|0,(w|0)==(i+l|0)){Je=154;break}if(d=o[r+8>>2]|0,d)r=d;else break}if((Je|0)==154&&(Et=r+4|0,(o[r+12>>2]&8|0)==0)&&w>>>0>j>>>0&i>>>0<=j>>>0){o[Et>>2]=l+T,wt=(o[5860]|0)+T|0,ct=j+8|0,ct=ct&7|0?0-ct&7:0,Et=j+ct|0,ct=wt-ct|0,o[5863]=Et,o[5860]=ct,o[Et+4>>2]=ct|1,o[j+wt+4>>2]=40,o[5864]=o[5979];break}for(w>>>0<(o[5861]|0)>>>0&&(o[5861]=w),l=w+T|0,r=23876;;){if((o[r>>2]|0)==(l|0)){Je=162;break}if(i=o[r+8>>2]|0,i)r=i;else break}if((Je|0)==162&&!(o[r+12>>2]&8|0)){o[r>>2]=w,ce=r+4|0,o[ce>>2]=(o[ce>>2]|0)+T,ce=w+8|0,ce=w+(ce&7|0?0-ce&7:0)|0,r=l+8|0,r=l+(r&7|0?0-r&7:0)|0,Y=ce+Se|0,B=r-ce-Se|0,o[ce+4>>2]=Se|3;t:do if((j|0)==(r|0))wt=(o[5860]|0)+B|0,o[5860]=wt,o[5863]=Y,o[Y+4>>2]=wt|1;else{if((o[5862]|0)==(r|0)){wt=(o[5859]|0)+B|0,o[5859]=wt,o[5862]=Y,o[Y+4>>2]=wt|1,o[Y+wt>>2]=wt;break}if(i=o[r+4>>2]|0,(i&3|0)==1){T=i&-8,d=i>>>3;i:do if(i>>>0<256)if(i=o[r+8>>2]|0,l=o[r+12>>2]|0,(l|0)==(i|0)){o[5857]=o[5857]&~(1<<d);break}else{o[i+12>>2]=l,o[l+8>>2]=i;break}else{w=o[r+24>>2]|0,i=o[r+12>>2]|0;do if((i|0)==(r|0)){if(l=r+16|0,d=l+4|0,i=o[d>>2]|0,i)l=d;else if(i=o[l>>2]|0,!i){i=0;break}for(;;)if(_=i+20|0,d=o[_>>2]|0,d)i=d,l=_;else if(_=i+16|0,d=o[_>>2]|0,d)i=d,l=_;else break;o[l>>2]=0}else wt=o[r+8>>2]|0,o[wt+12>>2]=i,o[i+8>>2]=wt;while(!1);if(!w)break;l=o[r+28>>2]|0,d=23732+(l<<2)|0;do if((o[d>>2]|0)!=(r|0)){if(wt=w+16|0,o[((o[wt>>2]|0)==(r|0)?wt:w+20|0)>>2]=i,!i)break i}else{if(o[d>>2]=i,i|0)break;o[5858]=o[5858]&~(1<<l);break i}while(!1);if(o[i+24>>2]=w,l=r+16|0,d=o[l>>2]|0,d|0&&(o[i+16>>2]=d,o[d+24>>2]=i),l=o[l+4>>2]|0,!l)break;o[i+20>>2]=l,o[l+24>>2]=i}while(!1);r=r+T|0,_=T+B|0}else _=B;if(r=r+4|0,o[r>>2]=o[r>>2]&-2,o[Y+4>>2]=_|1,o[Y+_>>2]=_,r=_>>>3,_>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=Y,o[r+12>>2]=Y,o[Y+8>>2]=r,o[Y+12>>2]=l;break}r=_>>>8;do if(!r)d=0;else{if(_>>>0>16777215){d=31;break}Et=(r+1048320|0)>>>16&8,wt=r<<Et,ct=(wt+520192|0)>>>16&4,wt=wt<<ct,d=(wt+245760|0)>>>16&2,d=14-(ct|Et|d)+(wt<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1}while(!1);if(r=23732+(d<<2)|0,o[Y+28>>2]=d,i=Y+16|0,o[i+4>>2]=0,o[i>>2]=0,i=o[5858]|0,l=1<<d,!(i&l)){o[5858]=i|l,o[r>>2]=Y,o[Y+24>>2]=r,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break}r=o[r>>2]|0;i:do if((o[r+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(_|0)){r=i;break i}else d=d<<1,r=i;o[l>>2]=Y,o[Y+24>>2]=r,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break t}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=Y,o[Et>>2]=Y,o[Y+8>>2]=wt,o[Y+12>>2]=r,o[Y+24>>2]=0}while(!1);return wt=ce+8|0,Lt=ri,wt|0}for(r=23876;i=o[r>>2]|0,!(i>>>0<=j>>>0&&(wt=i+(o[r+4>>2]|0)|0,wt>>>0>j>>>0));)r=o[r+8>>2]|0;_=wt+-47|0,i=_+8|0,i=_+(i&7|0?0-i&7:0)|0,_=j+16|0,i=i>>>0<_>>>0?j:i,r=i+8|0,l=T+-40|0,ct=w+8|0,ct=ct&7|0?0-ct&7:0,Et=w+ct|0,ct=l-ct|0,o[5863]=Et,o[5860]=ct,o[Et+4>>2]=ct|1,o[w+l+4>>2]=40,o[5864]=o[5979],l=i+4|0,o[l>>2]=27,o[r>>2]=o[5969],o[r+4>>2]=o[5970],o[r+8>>2]=o[5971],o[r+12>>2]=o[5972],o[5969]=w,o[5970]=T,o[5972]=0,o[5971]=r,r=i+24|0;do Et=r,r=r+4|0,o[r>>2]=7;while((Et+8|0)>>>0<wt>>>0);if((i|0)!=(j|0)){if(w=i-j|0,o[l>>2]=o[l>>2]&-2,o[j+4>>2]=w|1,o[i>>2]=w,r=w>>>3,w>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=j,o[r+12>>2]=j,o[j+8>>2]=r,o[j+12>>2]=l;break}if(r=w>>>8,r?w>>>0>16777215?d=31:(Et=(r+1048320|0)>>>16&8,wt=r<<Et,ct=(wt+520192|0)>>>16&4,wt=wt<<ct,d=(wt+245760|0)>>>16&2,d=14-(ct|Et|d)+(wt<<d>>>15)|0,d=w>>>(d+7|0)&1|d<<1):d=0,l=23732+(d<<2)|0,o[j+28>>2]=d,o[j+20>>2]=0,o[_>>2]=0,r=o[5858]|0,i=1<<d,!(r&i)){o[5858]=r|i,o[l>>2]=j,o[j+24>>2]=l,o[j+12>>2]=j,o[j+8>>2]=j;break}r=o[l>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(w|0)){for(d=w<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(w|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=j,o[j+24>>2]=r,o[j+12>>2]=j,o[j+8>>2]=j;break e}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=j,o[Et>>2]=j,o[j+8>>2]=wt,o[j+12>>2]=r,o[j+24>>2]=0}}else wt=o[5861]|0,(wt|0)==0|w>>>0<wt>>>0&&(o[5861]=w),o[5969]=w,o[5970]=T,o[5972]=0,o[5866]=o[5975],o[5865]=-1,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,o[5906]=23612,o[5905]=23612,o[5908]=23620,o[5907]=23620,o[5910]=23628,o[5909]=23628,o[5912]=23636,o[5911]=23636,o[5914]=23644,o[5913]=23644,o[5916]=23652,o[5915]=23652,o[5918]=23660,o[5917]=23660,o[5920]=23668,o[5919]=23668,o[5922]=23676,o[5921]=23676,o[5924]=23684,o[5923]=23684,o[5926]=23692,o[5925]=23692,o[5928]=23700,o[5927]=23700,o[5930]=23708,o[5929]=23708,o[5932]=23716,o[5931]=23716,wt=T+-40|0,ct=w+8|0,ct=ct&7|0?0-ct&7:0,Et=w+ct|0,ct=wt-ct|0,o[5863]=Et,o[5860]=ct,o[Et+4>>2]=ct|1,o[w+wt+4>>2]=40,o[5864]=o[5979];while(!1);if(r=o[5860]|0,r>>>0>Se>>>0)return ct=r-Se|0,o[5860]=ct,wt=o[5863]|0,Et=wt+Se|0,o[5863]=Et,o[Et+4>>2]=ct|1,o[wt+4>>2]=Se|3,wt=wt+8|0,Lt=ri,wt|0}return wt=Oo()|0,o[wt>>2]=12,wt=0,Lt=ri,wt|0}function C(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i){l=i+-8|0,_=o[5861]|0,i=o[i+-4>>2]|0,r=i&-8,j=l+r|0;do if(i&1)B=l,T=l;else{if(d=o[l>>2]|0,!(i&3)||(T=l+(0-d)|0,w=d+r|0,T>>>0<_>>>0))return;if((o[5862]|0)==(T|0)){if(i=j+4|0,r=o[i>>2]|0,(r&3|0)!=3){B=T,r=w;break}o[5859]=w,o[i>>2]=r&-2,o[T+4>>2]=w|1,o[T+w>>2]=w;return}if(l=d>>>3,d>>>0<256)if(i=o[T+8>>2]|0,r=o[T+12>>2]|0,(r|0)==(i|0)){o[5857]=o[5857]&~(1<<l),B=T,r=w;break}else{o[i+12>>2]=r,o[r+8>>2]=i,B=T,r=w;break}_=o[T+24>>2]|0,i=o[T+12>>2]|0;do if((i|0)==(T|0)){if(r=T+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){i=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0}else B=o[T+8>>2]|0,o[B+12>>2]=i,o[i+8>>2]=B;while(!1);if(_){if(r=o[T+28>>2]|0,l=23732+(r<<2)|0,(o[l>>2]|0)==(T|0)){if(o[l>>2]=i,!i){o[5858]=o[5858]&~(1<<r),B=T,r=w;break}}else if(B=_+16|0,o[((o[B>>2]|0)==(T|0)?B:_+20|0)>>2]=i,!i){B=T,r=w;break}o[i+24>>2]=_,r=T+16|0,l=o[r>>2]|0,l|0&&(o[i+16>>2]=l,o[l+24>>2]=i),r=o[r+4>>2]|0,r?(o[i+20>>2]=r,o[r+24>>2]=i,B=T,r=w):(B=T,r=w)}else B=T,r=w}while(!1);if(!(T>>>0>=j>>>0)&&(i=j+4|0,d=o[i>>2]|0,!!(d&1))){if(d&2)o[i>>2]=d&-2,o[B+4>>2]=r|1,o[T+r>>2]=r,_=r;else{if((o[5863]|0)==(j|0)){if(j=(o[5860]|0)+r|0,o[5860]=j,o[5863]=B,o[B+4>>2]=j|1,(B|0)!=(o[5862]|0))return;o[5862]=0,o[5859]=0;return}if((o[5862]|0)==(j|0)){j=(o[5859]|0)+r|0,o[5859]=j,o[5862]=T,o[B+4>>2]=j|1,o[T+j>>2]=j;return}_=(d&-8)+r|0,l=d>>>3;do if(d>>>0<256)if(r=o[j+8>>2]|0,i=o[j+12>>2]|0,(i|0)==(r|0)){o[5857]=o[5857]&~(1<<l);break}else{o[r+12>>2]=i,o[i+8>>2]=r;break}else{w=o[j+24>>2]|0,i=o[j+12>>2]|0;do if((i|0)==(j|0)){if(r=j+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){l=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0,l=i}else l=o[j+8>>2]|0,o[l+12>>2]=i,o[i+8>>2]=l,l=i;while(!1);if(w|0){if(i=o[j+28>>2]|0,r=23732+(i<<2)|0,(o[r>>2]|0)==(j|0)){if(o[r>>2]=l,!l){o[5858]=o[5858]&~(1<<i);break}}else if(d=w+16|0,o[((o[d>>2]|0)==(j|0)?d:w+20|0)>>2]=l,!l)break;o[l+24>>2]=w,i=j+16|0,r=o[i>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),i=o[i+4>>2]|0,i|0&&(o[l+20>>2]=i,o[i+24>>2]=l)}}while(!1);if(o[B+4>>2]=_|1,o[T+_>>2]=_,(B|0)==(o[5862]|0)){o[5859]=_;return}}if(i=_>>>3,_>>>0<256){l=23468+(i<<1<<2)|0,r=o[5857]|0,i=1<<i,r&i?(r=l+8|0,i=o[r>>2]|0):(o[5857]=r|i,i=l,r=l+8|0),o[r>>2]=B,o[i+12>>2]=B,o[B+8>>2]=i,o[B+12>>2]=l;return}i=_>>>8,i?_>>>0>16777215?d=31:(T=(i+1048320|0)>>>16&8,j=i<<T,w=(j+520192|0)>>>16&4,j=j<<w,d=(j+245760|0)>>>16&2,d=14-(w|T|d)+(j<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1):d=0,i=23732+(d<<2)|0,o[B+28>>2]=d,o[B+20>>2]=0,o[B+16>>2]=0,r=o[5858]|0,l=1<<d;e:do if(!(r&l))o[5858]=r|l,o[i>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;else{i=o[i>>2]|0;t:do if((o[i+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=i+16+(d>>>31<<2)|0,r=o[l>>2]|0,!!r;)if((o[r+4>>2]&-8|0)==(_|0)){i=r;break t}else d=d<<1,i=r;o[l>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;break e}while(!1);T=i+8|0,j=o[T>>2]|0,o[j+12>>2]=B,o[T>>2]=B,o[B+8>>2]=j,o[B+12>>2]=i,o[B+24>>2]=0}while(!1);if(j=(o[5865]|0)+-1|0,o[5865]=j,!(j|0)){for(i=23884;i=o[i>>2]|0,i;)i=i+8|0;o[5865]=-1}}}}function D(i,r){i=i|0,r=r|0;var l=0;return i?(l=Hi(r,i)|0,(r|i)>>>0>65535&&(l=((l>>>0)/(i>>>0)|0|0)==(r|0)?l:-1)):l=0,i=Ms(l)|0,!i||!(o[i+-4>>2]&3)||O(i|0,0,l|0)|0,i|0}function z(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,l=i+l>>>0,Yi(r+d+(l>>>0<i>>>0|0)>>>0|0),l|0|0}function R(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,d=r-d-(l>>>0>i>>>0|0)>>>0,Yi(d|0),i-l>>>0|0|0}function ee(i){return i=i|0,(i?31-(Qt(i^i-1)|0)|0:32)|0}function le(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ce=0,Se=0,Te=0,Re=0,Be=0;if(ce=i,j=r,Y=j,T=l,Te=d,B=Te,!Y)return w=(_|0)!=0,B?w?(o[_>>2]=i|0,o[_+4>>2]=r&0,Te=0,_=0,Yi(Te|0),_|0):(Te=0,_=0,Yi(Te|0),_|0):(w&&(o[_>>2]=(ce>>>0)%(T>>>0),o[_+4>>2]=0),Te=0,_=(ce>>>0)/(T>>>0)>>>0,Yi(Te|0),_|0);w=(B|0)==0;do if(T){if(!w){if(w=(Qt(B|0)|0)-(Qt(Y|0)|0)|0,w>>>0<=31){Se=w+1|0,B=31-w|0,r=w-31>>31,T=Se,i=ce>>>(Se>>>0)&r|Y<<B,r=Y>>>(Se>>>0)&r,w=0,B=ce<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Te=0,_=0,Yi(Te|0),_|0):(Te=0,_=0,Yi(Te|0),_|0)}if(w=T-1|0,w&T|0){B=(Qt(T|0)|0)+33-(Qt(Y|0)|0)|0,Be=64-B|0,Se=32-B|0,j=Se>>31,Re=B-32|0,r=Re>>31,T=B,i=Se-1>>31&Y>>>(Re>>>0)|(Y<<Se|ce>>>(B>>>0))&r,r=r&Y>>>(B>>>0),w=ce<<Be&j,B=(Y<<Be|ce>>>(Re>>>0))&j|ce<<Se&B-33>>31;break}return _|0&&(o[_>>2]=w&ce,o[_+4>>2]=0),(T|0)==1?(Re=j|r&0,Be=i|0|0,Yi(Re|0),Be|0):(Be=ee(T|0)|0,Re=Y>>>(Be>>>0)|0,Be=Y<<32-Be|ce>>>(Be>>>0)|0,Yi(Re|0),Be|0)}else{if(w)return _|0&&(o[_>>2]=(Y>>>0)%(T>>>0),o[_+4>>2]=0),Re=0,Be=(Y>>>0)/(T>>>0)>>>0,Yi(Re|0),Be|0;if(!ce)return _|0&&(o[_>>2]=0,o[_+4>>2]=(Y>>>0)%(B>>>0)),Re=0,Be=(Y>>>0)/(B>>>0)>>>0,Yi(Re|0),Be|0;if(w=B-1|0,!(w&B))return _|0&&(o[_>>2]=i|0,o[_+4>>2]=w&Y|r&0),Re=0,Be=Y>>>((ee(B|0)|0)>>>0),Yi(Re|0),Be|0;if(w=(Qt(B|0)|0)-(Qt(Y|0)|0)|0,w>>>0<=30){r=w+1|0,B=31-w|0,T=r,i=Y<<B|ce>>>(r>>>0),r=Y>>>(r>>>0),w=0,B=ce<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Re=0,Be=0,Yi(Re|0),Be|0):(Re=0,Be=0,Yi(Re|0),Be|0)}while(!1);if(!T)Y=B,j=0,B=0;else{Se=l|0|0,ce=Te|d&0,Y=z(Se|0,ce|0,-1,-1)|0,l=Ut()|0,j=B,B=0;do d=j,j=w>>>31|j<<1,w=B|w<<1,d=i<<1|d>>>31|0,Te=i>>>31|r<<1|0,R(Y|0,l|0,d|0,Te|0)|0,Be=Ut()|0,Re=Be>>31|((Be|0)<0?-1:0)<<1,B=Re&1,i=R(d|0,Te|0,Re&Se|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&ce|0)|0,r=Ut()|0,T=T-1|0;while(T|0);Y=j,j=0}return T=0,_|0&&(o[_>>2]=i,o[_+4>>2]=r),Re=(w|0)>>>31|(Y|T)<<1|(T<<1|w>>>31)&0|j,Be=(w<<1|0)&-2|B,Yi(Re|0),Be|0}function oe(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;return Y=r>>31|((r|0)<0?-1:0)<<1,j=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,w=d>>31|((d|0)<0?-1:0)<<1,_=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,B=R(Y^i|0,j^r|0,Y|0,j|0)|0,T=Ut()|0,i=w^Y,r=_^j,R((le(B,T,R(w^l|0,_^d|0,w|0,_|0)|0,Ut()|0,0)|0)^i|0,(Ut()|0)^r|0,i|0,r|0)|0}function we(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return w=i&65535,_=r&65535,l=Hi(_,w)|0,d=i>>>16,i=(l>>>16)+(Hi(_,d)|0)|0,_=r>>>16,r=Hi(_,w)|0,Yi((i>>>16)+(Hi(_,d)|0)+(((i&65535)+r|0)>>>16)|0),i+r<<16|l&65535|0|0}function We(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return _=i,w=l,l=we(_,w)|0,i=Ut()|0,Yi((Hi(r,w)|0)+(Hi(d,_)|0)+i|i&0|0),l|0|0|0}function vt(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;return _=Lt,Lt=Lt+16|0,B=_|0,T=r>>31|((r|0)<0?-1:0)<<1,w=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,Y=d>>31|((d|0)<0?-1:0)<<1,j=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,i=R(T^i|0,w^r|0,T|0,w|0)|0,r=Ut()|0,le(i,r,R(Y^l|0,j^d|0,Y|0,j|0)|0,Ut()|0,B)|0,d=R(o[B>>2]^T|0,o[B+4>>2]^w|0,T|0,w|0)|0,l=Ut()|0,Lt=_,Yi(l|0),d|0}function Ct(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return w=Lt,Lt=Lt+16|0,_=w|0,le(i,r,l,d,_)|0,Lt=w,Yi(o[_+4>>2]|0),o[_>>2]|0|0}function ni(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Yi(((r|0)<0?-1:0)|0),r>>l-32|0)}function Gt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r>>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Yi(0),r>>>l-32|0)}function jt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r<<l|(i&(1<<l)-1<<32-l)>>>32-l|0),i<<l):(Yi(i<<l-32|0),0)}function Z(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+On(+i,+r)}function A(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+ur(+i,+r)}function E(i){return i=+i,i>=0?+Ai(i+.5):+jr(i-.5)}function F(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if((l|0)>=8192)return Ur(i|0,r|0,l|0)|0,i|0;if(w=i|0,_=i+l|0,(i&3)==(r&3)){for(;i&3;){if(!l)return w|0;kt[i>>0]=kt[r>>0]|0,i=i+1|0,r=r+1|0,l=l-1|0}for(l=_&-4|0,d=l-64|0;(i|0)<=(d|0);)o[i>>2]=o[r>>2],o[i+4>>2]=o[r+4>>2],o[i+8>>2]=o[r+8>>2],o[i+12>>2]=o[r+12>>2],o[i+16>>2]=o[r+16>>2],o[i+20>>2]=o[r+20>>2],o[i+24>>2]=o[r+24>>2],o[i+28>>2]=o[r+28>>2],o[i+32>>2]=o[r+32>>2],o[i+36>>2]=o[r+36>>2],o[i+40>>2]=o[r+40>>2],o[i+44>>2]=o[r+44>>2],o[i+48>>2]=o[r+48>>2],o[i+52>>2]=o[r+52>>2],o[i+56>>2]=o[r+56>>2],o[i+60>>2]=o[r+60>>2],i=i+64|0,r=r+64|0;for(;(i|0)<(l|0);)o[i>>2]=o[r>>2],i=i+4|0,r=r+4|0}else for(l=_-4|0;(i|0)<(l|0);)kt[i>>0]=kt[r>>0]|0,kt[i+1>>0]=kt[r+1>>0]|0,kt[i+2>>0]=kt[r+2>>0]|0,kt[i+3>>0]=kt[r+3>>0]|0,i=i+4|0,r=r+4|0;for(;(i|0)<(_|0);)kt[i>>0]=kt[r>>0]|0,i=i+1|0,r=r+1|0;return w|0}function O(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=i+l|0,r=r&255,(l|0)>=67){for(;i&3;)kt[i>>0]=r,i=i+1|0;for(d=w&-4|0,T=r|r<<8|r<<16|r<<24,_=d-64|0;(i|0)<=(_|0);)o[i>>2]=T,o[i+4>>2]=T,o[i+8>>2]=T,o[i+12>>2]=T,o[i+16>>2]=T,o[i+20>>2]=T,o[i+24>>2]=T,o[i+28>>2]=T,o[i+32>>2]=T,o[i+36>>2]=T,o[i+40>>2]=T,o[i+44>>2]=T,o[i+48>>2]=T,o[i+52>>2]=T,o[i+56>>2]=T,o[i+60>>2]=T,i=i+64|0;for(;(i|0)<(d|0);)o[i>>2]=T,i=i+4|0}for(;(i|0)<(w|0);)kt[i>>0]=r,i=i+1|0;return w-l|0}function y(i){return i=+i,i>=0?+Ai(i+.5):+jr(i-.5)}function s(i){i=i|0;var r=0,l=0,d=0;return d=Ns()|0,l=o[di>>2]|0,r=l+i|0,(i|0)>0&(r|0)<(l|0)|(r|0)<0?(hr(r|0)|0,cr(12),-1):(r|0)>(d|0)&&!(Vt(r|0)|0)?(cr(12),-1):(o[di>>2]=r,l|0)}return{___divdi3:oe,___muldi3:We,___remdi3:vt,___uremdi3:Ct,_areNeighborCells:Ro,_bitshift64Ashr:ni,_bitshift64Lshr:Gt,_bitshift64Shl:jt,_calloc:D,_cellAreaKm2:ks,_cellAreaM2:As,_cellAreaRads2:qs,_cellToBoundary:Nr,_cellToCenterChild:Yr,_cellToChildPos:ka,_cellToChildren:rr,_cellToChildrenSize:Ts,_cellToLatLng:mr,_cellToLocalIj:Fo,_cellToParent:Zr,_cellToVertex:Jn,_cellToVertexes:tl,_cellsToDirectedEdge:Wo,_cellsToLinkedMultiPolygon:xe,_childPosToCell:Wa,_compactCells:Co,_destroyLinkedMultiPolygon:go,_directedEdgeToBoundary:ba,_directedEdgeToCells:Yo,_edgeLengthKm:mo,_edgeLengthM:rs,_edgeLengthRads:Xa,_emscripten_replace_memory:Fr,_free:C,_getBaseCellNumber:Ol,_getDirectedEdgeDestination:Us,_getDirectedEdgeOrigin:Io,_getHexagonAreaAvgKm2:xi,_getHexagonAreaAvgM2:Fi,_getHexagonEdgeLengthAvgKm:Ln,_getHexagonEdgeLengthAvgM:Hn,_getIcosahedronFaces:po,_getNumCells:lr,_getPentagons:Sa,_getRes0Cells:Ua,_getResolution:Un,_greatCircleDistanceKm:Vi,_greatCircleDistanceM:Di,_greatCircleDistanceRads:mi,_gridDisk:Oa,_gridDiskDistances:Ys,_gridDistance:En,_gridPathCells:Cn,_gridPathCellsSize:Hl,_gridRingUnsafe:al,_i64Add:z,_i64Subtract:R,_isPentagon:kr,_isResClassIII:hs,_isValidCell:es,_isValidDirectedEdge:Xo,_isValidVertex:oa,_latLngToCell:Qa,_llvm_maxnum_f64:Z,_llvm_minnum_f64:A,_llvm_round_f64:E,_localIjToCell:Nl,_malloc:Ms,_maxFaceCount:ha,_maxGridDiskSize:zo,_maxPolygonToCellsSize:ol,_memcpy:F,_memset:O,_originToDirectedEdges:$o,_pentagonCount:ea,_polygonToCells:Va,_readInt64AsDoubleFromPointer:_u,_res0CellCount:Or,_round:y,_sbrk:s,_sizeOfCellBoundary:Wu,_sizeOfCoordIJ:el,_sizeOfGeoLoop:jl,_sizeOfGeoPolygon:fs,_sizeOfH3Index:ta,_sizeOfLatLng:sc,_sizeOfLinkedGeoPolygon:_a,_uncompactCells:ul,_uncompactCellsSize:Qr,_vertexToLatLng:Tu,establishStackSpace:Fa,stackAlloc:Vs,stackRestore:Pr,stackSave:ua}}(nt,Me,gt);t.___divdi3=se.___divdi3,t.___muldi3=se.___muldi3,t.___remdi3=se.___remdi3,t.___uremdi3=se.___uremdi3,t._areNeighborCells=se._areNeighborCells,t._bitshift64Ashr=se._bitshift64Ashr,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._cellToBoundary=se._cellToBoundary,t._cellToCenterChild=se._cellToCenterChild,t._cellToChildPos=se._cellToChildPos,t._cellToChildren=se._cellToChildren,t._cellToChildrenSize=se._cellToChildrenSize,t._cellToLatLng=se._cellToLatLng,t._cellToLocalIj=se._cellToLocalIj,t._cellToParent=se._cellToParent,t._cellToVertex=se._cellToVertex,t._cellToVertexes=se._cellToVertexes,t._cellsToDirectedEdge=se._cellsToDirectedEdge,t._cellsToLinkedMultiPolygon=se._cellsToLinkedMultiPolygon,t._childPosToCell=se._childPosToCell,t._compactCells=se._compactCells,t._destroyLinkedMultiPolygon=se._destroyLinkedMultiPolygon,t._directedEdgeToBoundary=se._directedEdgeToBoundary,t._directedEdgeToCells=se._directedEdgeToCells,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM,t._edgeLengthRads=se._edgeLengthRads;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._free=se._free,t._getBaseCellNumber=se._getBaseCellNumber,t._getDirectedEdgeDestination=se._getDirectedEdgeDestination,t._getDirectedEdgeOrigin=se._getDirectedEdgeOrigin,t._getHexagonAreaAvgKm2=se._getHexagonAreaAvgKm2,t._getHexagonAreaAvgM2=se._getHexagonAreaAvgM2,t._getHexagonEdgeLengthAvgKm=se._getHexagonEdgeLengthAvgKm,t._getHexagonEdgeLengthAvgM=se._getHexagonEdgeLengthAvgM,t._getIcosahedronFaces=se._getIcosahedronFaces,t._getNumCells=se._getNumCells,t._getPentagons=se._getPentagons,t._getRes0Cells=se._getRes0Cells,t._getResolution=se._getResolution,t._greatCircleDistanceKm=se._greatCircleDistanceKm,t._greatCircleDistanceM=se._greatCircleDistanceM,t._greatCircleDistanceRads=se._greatCircleDistanceRads,t._gridDisk=se._gridDisk,t._gridDiskDistances=se._gridDiskDistances,t._gridDistance=se._gridDistance,t._gridPathCells=se._gridPathCells,t._gridPathCellsSize=se._gridPathCellsSize,t._gridRingUnsafe=se._gridRingUnsafe,t._i64Add=se._i64Add,t._i64Subtract=se._i64Subtract,t._isPentagon=se._isPentagon,t._isResClassIII=se._isResClassIII,t._isValidCell=se._isValidCell,t._isValidDirectedEdge=se._isValidDirectedEdge,t._isValidVertex=se._isValidVertex,t._latLngToCell=se._latLngToCell,t._llvm_maxnum_f64=se._llvm_maxnum_f64,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._localIjToCell=se._localIjToCell,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxGridDiskSize=se._maxGridDiskSize,t._maxPolygonToCellsSize=se._maxPolygonToCellsSize,t._memcpy=se._memcpy,t._memset=se._memset,t._originToDirectedEdges=se._originToDirectedEdges,t._pentagonCount=se._pentagonCount,t._polygonToCells=se._polygonToCells,t._readInt64AsDoubleFromPointer=se._readInt64AsDoubleFromPointer,t._res0CellCount=se._res0CellCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCellBoundary=se._sizeOfCellBoundary,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoLoop=se._sizeOfGeoLoop,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLatLng=se._sizeOfLatLng,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompactCells=se._uncompactCells,t._uncompactCellsSize=se._uncompactCellsSize,t._vertexToLatLng=se._vertexToLatLng,t.establishStackSpace=se.establishStackSpace;var X=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=Tt,t.setValue=be,t.getValue=Ke,en){Fn(en)||(en=b(en));{Rr();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),dt.set(De,ue),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,hi()},ge=function(){I(en,ye,function(){throw"could not load memory initializer "+en})},Pe=ft(en);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ue=De.response;if(De.status!==200&&De.status!==0){var ht=ft(t.memoryInitializerRequestURL);if(ht)Ue=ht.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+en),ge();return}}ye(Ue)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ne;wn=function De(){Ne||Xe(),Ne||(wn=De)};function Xe(De){if(ii>0||(nn(),ii>0))return;function Ue(){Ne||(Ne=!0,!ot&&(yn(),Ci(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),gi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ue()},1)):Ue()}t.run=Xe;function Ye(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),G(De),ot=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ye,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof Ca=="object"?Ca:{}),Is="number",Kr=Is,Jm=Is,as=Is,os=Is,Ju=Is,dr=Is,nV=[["sizeOfH3Index",Is],["sizeOfLatLng",Is],["sizeOfCellBoundary",Is],["sizeOfGeoLoop",Is],["sizeOfGeoPolygon",Is],["sizeOfLinkedGeoPolygon",Is],["sizeOfCoordIJ",Is],["readInt64AsDoubleFromPointer",Is],["isValidCell",Jm,[as,os]],["latLngToCell",Kr,[Is,Is,Ju,dr]],["cellToLatLng",Kr,[as,os,dr]],["cellToBoundary",Kr,[as,os,dr]],["maxGridDiskSize",Kr,[Is,dr]],["gridDisk",Kr,[as,os,Is,dr]],["gridDiskDistances",Kr,[as,os,Is,dr,dr]],["gridRingUnsafe",Kr,[as,os,Is,dr]],["maxPolygonToCellsSize",Kr,[dr,Ju,Is,dr]],["polygonToCells",Kr,[dr,Ju,Is,dr]],["cellsToLinkedMultiPolygon",Kr,[dr,Is,dr]],["destroyLinkedMultiPolygon",null,[dr]],["compactCells",Kr,[dr,dr,Is,Is]],["uncompactCells",Kr,[dr,Is,Is,dr,Is,Ju]],["uncompactCellsSize",Kr,[dr,Is,Is,Ju,dr]],["isPentagon",Jm,[as,os]],["isResClassIII",Jm,[as,os]],["getBaseCellNumber",Is,[as,os]],["getResolution",Is,[as,os]],["maxFaceCount",Kr,[as,os,dr]],["getIcosahedronFaces",Kr,[as,os,dr]],["cellToParent",Kr,[as,os,Ju,dr]],["cellToChildren",Kr,[as,os,Ju,dr]],["cellToCenterChild",Kr,[as,os,Ju,dr]],["cellToChildrenSize",Kr,[as,os,Ju,dr]],["cellToChildPos",Kr,[as,os,Ju,dr]],["childPosToCell",Kr,[Is,Is,as,os,Ju,dr]],["areNeighborCells",Kr,[as,os,as,os,dr]],["cellsToDirectedEdge",Kr,[as,os,as,os,dr]],["getDirectedEdgeOrigin",Kr,[as,os,dr]],["getDirectedEdgeDestination",Kr,[as,os,dr]],["isValidDirectedEdge",Jm,[as,os]],["directedEdgeToCells",Kr,[as,os,dr]],["originToDirectedEdges",Kr,[as,os,dr]],["directedEdgeToBoundary",Kr,[as,os,dr]],["gridDistance",Kr,[as,os,as,os,dr]],["gridPathCells",Kr,[as,os,as,os,dr]],["gridPathCellsSize",Kr,[as,os,as,os,dr]],["cellToLocalIj",Kr,[as,os,as,os,Is,dr]],["localIjToCell",Kr,[as,os,dr,Is,dr]],["getHexagonAreaAvgM2",Kr,[Ju,dr]],["getHexagonAreaAvgKm2",Kr,[Ju,dr]],["getHexagonEdgeLengthAvgM",Kr,[Ju,dr]],["getHexagonEdgeLengthAvgKm",Kr,[Ju,dr]],["greatCircleDistanceM",Is,[dr,dr]],["greatCircleDistanceKm",Is,[dr,dr]],["greatCircleDistanceRads",Is,[dr,dr]],["cellAreaM2",Kr,[as,os,dr]],["cellAreaKm2",Kr,[as,os,dr]],["cellAreaRads2",Kr,[as,os,dr]],["edgeLengthM",Kr,[as,os,dr]],["edgeLengthKm",Kr,[as,os,dr]],["edgeLengthRads",Kr,[as,os,dr]],["getNumCells",Kr,[Ju,dr]],["getRes0Cells",Kr,[dr]],["res0CellCount",Is],["getPentagons",Kr,[Is,dr]],["pentagonCount",Is],["cellToVertex",Kr,[as,os,Is,dr]],["cellToVertexes",Kr,[as,os,dr]],["vertexToLatLng",Kr,[as,os,dr]],["isValidVertex",Jm,[as,os]]],rV=0,sV=1,aV=2,oV=3,E5=4,lV=5,uV=6,cV=7,hV=8,AV=9,fV=10,dV=11,pV=12,mV=13,gV=14,_V=15,Zu={};Zu[rV]="Success";Zu[sV]="The operation failed but a more specific error is not available";Zu[aV]="Argument was outside of acceptable range";Zu[oV]="Latitude or longitude arguments were outside of acceptable range";Zu[E5]="Resolution argument was outside of acceptable range";Zu[lV]="Cell argument was not valid";Zu[uV]="Directed edge argument was not valid";Zu[cV]="Undirected edge argument was not valid";Zu[hV]="Vertex argument was not valid";Zu[AV]="Pentagon distortion was encountered";Zu[fV]="Duplicate input";Zu[dV]="Cell arguments were not neighbors";Zu[pV]="Cell arguments had incompatible resolutions";Zu[mV]="Memory allocation failed";Zu[gV]="Bounds of provided memory were insufficient";Zu[_V]="Mode or flags argument was not valid";var yV=1e3,C5=1001,T5=1002,y1={};y1[yV]="Unknown unit";y1[C5]="Array length out of bounds";y1[T5]="Got unexpected null value for H3 index";var vV="Unknown error";function k5(e,t,n){var c=n&&"value"in n,g=new Error((e[t]||vV)+" (code: "+t+(c?", value: "+n.value:"")+")");return g.code=t,g}function M5(e,t){var n=arguments.length===2?{value:t}:{};return k5(Zu,e,n)}function P5(e,t){var n=arguments.length===2?{value:t}:{};return k5(y1,e,n)}function Z_(e){if(e!==0)throw M5(e)}var gh={};nV.forEach(function(t){gh[t[0]]=Ca.cwrap.apply(Ca,t)});var sm=16,Eg=4,k2=8,xV=8,Q_=gh.sizeOfH3Index(),M2=gh.sizeOfLatLng();gh.sizeOfCellBoundary();var bV=gh.sizeOfGeoPolygon(),hg=gh.sizeOfGeoLoop();gh.sizeOfLinkedGeoPolygon();gh.sizeOfCoordIJ();function wV(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw M5(E5,e);return e}function SV(e){if(!e)throw P5(T5);return e}var IV=Math.pow(2,32)-1;function EV(e){if(e>IV)throw P5(C5,e);return e}var CV=/[^0-9a-fA-F]/;function TV(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||CV.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),sm),n=parseInt(e.substring(e.length-8),sm);return[n,t]}function Tw(e){if(e>=0)return e.toString(sm);e=e&2147483647;var t=D5(8,e.toString(sm)),n=(parseInt(t[0],sm)+8).toString(sm);return t=n+t.substring(1),t}function kV(e,t){return Tw(t)+D5(8,Tw(e))}function D5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function kw(e,t,n){for(var c=e.length,g=Ca._calloc(c,M2),b=n?1:0,I=n?0:1,a=0;a<c*2;a+=2)Ca.HEAPF64.set([e[a/2][b],e[a/2][I]].map(B5),g/k2+a);return Ca.HEAPU32.set([c,g],t/Eg),t}function MV(e,t){var n=e.length-1,c=Ca._calloc(bV),g=0,b=g+hg,I=b+Eg;kw(e[0],c+g,t);var a;if(n>0){a=Ca._calloc(n,hg);for(var G=0;G<n;G++)kw(e[G+1],a+hg*G,t)}return Ca.setValue(c+b,n,"i32"),Ca.setValue(c+I,a,"i32"),c}function PV(e){var t=0,n=t+hg,c=n+Eg,g=Eg;Ca._free(Ca.getValue(e+t+g,"i8*"));var b=Ca.getValue(e+n,"i32");if(b>0){for(var I=Ca.getValue(e+c,"i32"),a=0;a<b;a++)Ca._free(Ca.getValue(I+hg*a+g,"i8*"));Ca._free(I)}Ca._free(e)}function L5(e,t){t===void 0&&(t=0);var n=Ca.getValue(e+Q_*t,"i32"),c=Ca.getValue(e+Q_*t+Eg,"i32");return c?kV(n,c):null}function DV(e){return gh.readInt64AsDoubleFromPointer(e)}function LV(e,t){for(var n=[],c=0;c<t;c++){var g=L5(e,c);g!==null&&n.push(g)}return n}function Mw(e){return FV(Ca.getValue(e,"double"))}function BV(e){return[Mw(e),Mw(e+k2)]}function zV(e,t,n){var c=Ca._malloc(M2);Ca.HEAPF64.set([e,t].map(B5),c/k2);var g=Ca._malloc(Q_);try{return Z_(gh.latLngToCell(c,n,g)),SV(L5(g))}finally{Ca._free(g),Ca._free(c)}}function Pw(e){var t=Ca._malloc(M2),n=TV(e),c=n[0],g=n[1];try{return Z_(gh.cellToLatLng(c,g,t)),BV(t)}finally{Ca._free(t)}}function RV(e,t,n){if(wV(t),n=!!n,e.length===0||e[0].length===0)return[];var c=typeof e[0][0]=="number"?[e]:e,g=MV(c,n),b=Ca._malloc(xV);try{Z_(gh.maxPolygonToCellsSize(g,t,0,b));var I=EV(DV(b)),a=Ca._calloc(I,Q_);try{return Z_(gh.polygonToCells(g,t,0,a)),LV(a,I)}finally{Ca._free(a)}}finally{Ca._free(b),PV(g)}}function B5(e){return e*Math.PI/180}function FV(e){return e*180/Math.PI}function OV(e,t,n){n===void 0&&(n={});var c={type:"Feature"};return(n.id===0||n.id)&&(c.id=n.id),n.bbox&&(c.bbox=n.bbox),c.properties=t||{},c.geometry=e,c}function NV(e,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function VV(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length&&t(e.features[n],n)!==!1;n++);}function UV(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return VV(e,function(n){var c,g,b,I;switch((I=n.geometry)===null||I===void 0?void 0:I.type){case"Point":t.MultiPoint.coordinates.push(n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"MultiPoint":(c=t.MultiPoint.coordinates).push.apply(c,n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"LineString":t.MultiLineString.coordinates.push(n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"MultiLineString":(g=t.MultiLineString.coordinates).push.apply(g,n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break;case"MultiPolygon":(b=t.MultiPolygon.coordinates).push.apply(b,n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break}}),NV(Object.keys(t).filter(function(n){return t[n].coordinates.length}).sort().map(function(n){var c={type:n,coordinates:t[n].coordinates},g={collectedProperties:t[n].properties};return OV(c,g)}))}const z5=e=>()=>e,Tv=e=>{const t=e?(n,c)=>c.minus(n).abs().isLessThanOrEqualTo(e):z5(!1);return(n,c)=>t(n,c)?0:n.comparedTo(c)};function GV(e){const t=e?(n,c,g,b,I)=>n.exponentiatedBy(2).isLessThanOrEqualTo(b.minus(c).exponentiatedBy(2).plus(I.minus(g).exponentiatedBy(2)).times(e)):z5(!1);return(n,c,g)=>{const b=n.x,I=n.y,a=g.x,G=g.y,W=I.minus(G).times(c.x.minus(a)).minus(b.minus(a).times(c.y.minus(G)));return t(W,b,I,a,G)?0:W.comparedTo(0)}}var qV=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,cy=Math.ceil,Bh=Math.floor,Nc="[BigNumber Error] ",Dw=Nc+"Number primitive has more than 15 significant digits: ",oA=1e14,Ss=14,hy=9007199254740991,Ay=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],R0=1e7,Du=1e9;function R5(e){var t,n,c,g=ut.prototype={constructor:ut,toString:null,valueOf:null},b=new ut(1),I=20,a=4,G=-7,W=21,he=-1e7,ae=1e7,ue=!1,be=1,Ke=0,ot={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},tt="0123456789abcdefghijklmnopqrstuvwxyz",lt=!0;function ut(rt,yt){var pt,gt,bt,dt,$e,mt,st,Nt,Rt=this;if(!(Rt instanceof ut))return new ut(rt,yt);if(yt==null){if(rt&&rt._isBigNumber===!0){Rt.s=rt.s,!rt.c||rt.e>ae?Rt.c=Rt.e=null:rt.e<he?Rt.c=[Rt.e=0]:(Rt.e=rt.e,Rt.c=rt.c.slice());return}if((mt=typeof rt=="number")&&rt*0==0){if(Rt.s=1/rt<0?(rt=-rt,-1):1,rt===~~rt){for(dt=0,$e=rt;$e>=10;$e/=10,dt++);dt>ae?Rt.c=Rt.e=null:(Rt.e=dt,Rt.c=[rt]);return}Nt=String(rt)}else{if(!qV.test(Nt=String(rt)))return c(Rt,Nt,mt);Rt.s=Nt.charCodeAt(0)==45?(Nt=Nt.slice(1),-1):1}(dt=Nt.indexOf("."))>-1&&(Nt=Nt.replace(".","")),($e=Nt.search(/e/i))>0?(dt<0&&(dt=$e),dt+=+Nt.slice($e+1),Nt=Nt.substring(0,$e)):dt<0&&(dt=Nt.length)}else{if(Fl(yt,2,tt.length,"Base"),yt==10&&lt)return Rt=new ut(rt),Ge(Rt,I+Rt.e+1,a);if(Nt=String(rt),mt=typeof rt=="number"){if(rt*0!=0)return c(Rt,Nt,mt,yt);if(Rt.s=1/rt<0?(Nt=Nt.slice(1),-1):1,ut.DEBUG&&Nt.replace(/^0\.0*|\./,"").length>15)throw Error(Dw+rt)}else Rt.s=Nt.charCodeAt(0)===45?(Nt=Nt.slice(1),-1):1;for(pt=tt.slice(0,yt),dt=$e=0,st=Nt.length;$e<st;$e++)if(pt.indexOf(gt=Nt.charAt($e))<0){if(gt=="."){if($e>dt){dt=st;continue}}else if(!bt&&(Nt==Nt.toUpperCase()&&(Nt=Nt.toLowerCase())||Nt==Nt.toLowerCase()&&(Nt=Nt.toUpperCase()))){bt=!0,$e=-1,dt=0;continue}return c(Rt,String(rt),mt,yt)}mt=!1,Nt=n(Nt,yt,10,Rt.s),(dt=Nt.indexOf("."))>-1?Nt=Nt.replace(".",""):dt=Nt.length}for($e=0;Nt.charCodeAt($e)===48;$e++);for(st=Nt.length;Nt.charCodeAt(--st)===48;);if(Nt=Nt.slice($e,++st)){if(st-=$e,mt&&ut.DEBUG&&st>15&&(rt>hy||rt!==Bh(rt)))throw Error(Dw+Rt.s*rt);if((dt=dt-$e-1)>ae)Rt.c=Rt.e=null;else if(dt<he)Rt.c=[Rt.e=0];else{if(Rt.e=dt,Rt.c=[],$e=(dt+1)%Ss,dt<0&&($e+=Ss),$e<st){for($e&&Rt.c.push(+Nt.slice(0,$e)),st-=Ss;$e<st;)Rt.c.push(+Nt.slice($e,$e+=Ss));$e=Ss-(Nt=Nt.slice($e)).length}else $e-=st;for(;$e--;Nt+="0");Rt.c.push(+Nt)}}else Rt.c=[Rt.e=0]}ut.clone=R5,ut.ROUND_UP=0,ut.ROUND_DOWN=1,ut.ROUND_CEIL=2,ut.ROUND_FLOOR=3,ut.ROUND_HALF_UP=4,ut.ROUND_HALF_DOWN=5,ut.ROUND_HALF_EVEN=6,ut.ROUND_HALF_CEIL=7,ut.ROUND_HALF_FLOOR=8,ut.EUCLID=9,ut.config=ut.set=function(rt){var yt,pt;if(rt!=null)if(typeof rt=="object"){if(rt.hasOwnProperty(yt="DECIMAL_PLACES")&&(pt=rt[yt],Fl(pt,0,Du,yt),I=pt),rt.hasOwnProperty(yt="ROUNDING_MODE")&&(pt=rt[yt],Fl(pt,0,8,yt),a=pt),rt.hasOwnProperty(yt="EXPONENTIAL_AT")&&(pt=rt[yt],pt&&pt.pop?(Fl(pt[0],-Du,0,yt),Fl(pt[1],0,Du,yt),G=pt[0],W=pt[1]):(Fl(pt,-Du,Du,yt),G=-(W=pt<0?-pt:pt))),rt.hasOwnProperty(yt="RANGE"))if(pt=rt[yt],pt&&pt.pop)Fl(pt[0],-Du,-1,yt),Fl(pt[1],1,Du,yt),he=pt[0],ae=pt[1];else if(Fl(pt,-Du,Du,yt),pt)he=-(ae=pt<0?-pt:pt);else throw Error(Nc+yt+" cannot be zero: "+pt);if(rt.hasOwnProperty(yt="CRYPTO"))if(pt=rt[yt],pt===!!pt)if(pt)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ue=pt;else throw ue=!pt,Error(Nc+"crypto unavailable");else ue=pt;else throw Error(Nc+yt+" not true or false: "+pt);if(rt.hasOwnProperty(yt="MODULO_MODE")&&(pt=rt[yt],Fl(pt,0,9,yt),be=pt),rt.hasOwnProperty(yt="POW_PRECISION")&&(pt=rt[yt],Fl(pt,0,Du,yt),Ke=pt),rt.hasOwnProperty(yt="FORMAT"))if(pt=rt[yt],typeof pt=="object")ot=pt;else throw Error(Nc+yt+" not an object: "+pt);if(rt.hasOwnProperty(yt="ALPHABET"))if(pt=rt[yt],typeof pt=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(pt))lt=pt.slice(0,10)=="0123456789",tt=pt;else throw Error(Nc+yt+" invalid: "+pt)}else throw Error(Nc+"Object expected: "+rt);return{DECIMAL_PLACES:I,ROUNDING_MODE:a,EXPONENTIAL_AT:[G,W],RANGE:[he,ae],CRYPTO:ue,MODULO_MODE:be,POW_PRECISION:Ke,FORMAT:ot,ALPHABET:tt}},ut.isBigNumber=function(rt){if(!rt||rt._isBigNumber!==!0)return!1;if(!ut.DEBUG)return!0;var yt,pt,gt=rt.c,bt=rt.e,dt=rt.s;e:if({}.toString.call(gt)=="[object Array]"){if((dt===1||dt===-1)&&bt>=-Du&&bt<=Du&&bt===Bh(bt)){if(gt[0]===0){if(bt===0&&gt.length===1)return!0;break e}if(yt=(bt+1)%Ss,yt<1&&(yt+=Ss),String(gt[0]).length==yt){for(yt=0;yt<gt.length;yt++)if(pt=gt[yt],pt<0||pt>=oA||pt!==Bh(pt))break e;if(pt!==0)return!0}}}else if(gt===null&&bt===null&&(dt===null||dt===1||dt===-1))return!0;throw Error(Nc+"Invalid BigNumber: "+rt)},ut.maximum=ut.max=function(){return Pt(arguments,-1)},ut.minimum=ut.min=function(){return Pt(arguments,1)},ut.random=function(){var rt=9007199254740992,yt=Math.random()*rt&2097151?function(){return Bh(Math.random()*rt)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(pt){var gt,bt,dt,$e,mt,st=0,Nt=[],Rt=new ut(b);if(pt==null?pt=I:Fl(pt,0,Du),$e=cy(pt/Ss),ue)if(crypto.getRandomValues){for(gt=crypto.getRandomValues(new Uint32Array($e*=2));st<$e;)mt=gt[st]*131072+(gt[st+1]>>>11),mt>=9e15?(bt=crypto.getRandomValues(new Uint32Array(2)),gt[st]=bt[0],gt[st+1]=bt[1]):(Nt.push(mt%1e14),st+=2);st=$e/2}else if(crypto.randomBytes){for(gt=crypto.randomBytes($e*=7);st<$e;)mt=(gt[st]&31)*281474976710656+gt[st+1]*1099511627776+gt[st+2]*4294967296+gt[st+3]*16777216+(gt[st+4]<<16)+(gt[st+5]<<8)+gt[st+6],mt>=9e15?crypto.randomBytes(7).copy(gt,st):(Nt.push(mt%1e14),st+=7);st=$e/7}else throw ue=!1,Error(Nc+"crypto unavailable");if(!ue)for(;st<$e;)mt=yt(),mt<9e15&&(Nt[st++]=mt%1e14);for($e=Nt[--st],pt%=Ss,$e&&pt&&(mt=Ay[Ss-pt],Nt[st]=Bh($e/mt)*mt);Nt[st]===0;Nt.pop(),st--);if(st<0)Nt=[dt=0];else{for(dt=-1;Nt[0]===0;Nt.splice(0,1),dt-=Ss);for(st=1,mt=Nt[0];mt>=10;mt/=10,st++);st<Ss&&(dt-=Ss-st)}return Rt.e=dt,Rt.c=Nt,Rt}}(),ut.sum=function(){for(var rt=1,yt=arguments,pt=new ut(yt[0]);rt<yt.length;)pt=pt.plus(yt[rt++]);return pt},n=function(){var rt="0123456789";function yt(pt,gt,bt,dt){for(var $e,mt=[0],st,Nt=0,Rt=pt.length;Nt<Rt;){for(st=mt.length;st--;mt[st]*=gt);for(mt[0]+=dt.indexOf(pt.charAt(Nt++)),$e=0;$e<mt.length;$e++)mt[$e]>bt-1&&(mt[$e+1]==null&&(mt[$e+1]=0),mt[$e+1]+=mt[$e]/bt|0,mt[$e]%=bt)}return mt.reverse()}return function(pt,gt,bt,dt,$e){var mt,st,Nt,Rt,Ot,_i,Si,Ti,Oi=pt.indexOf("."),tn=I,qi=a;for(Oi>=0&&(Rt=Ke,Ke=0,pt=pt.replace(".",""),Ti=new ut(gt),_i=Ti.pow(pt.length-Oi),Ke=Rt,Ti.c=yt(Yf(Lh(_i.c),_i.e,"0"),10,bt,rt),Ti.e=Ti.c.length),Si=yt(pt,gt,bt,$e?(mt=tt,rt):(mt=rt,tt)),Nt=Rt=Si.length;Si[--Rt]==0;Si.pop());if(!Si[0])return mt.charAt(0);if(Oi<0?--Nt:(_i.c=Si,_i.e=Nt,_i.s=dt,_i=t(_i,Ti,tn,qi,bt),Si=_i.c,Ot=_i.r,Nt=_i.e),st=Nt+tn+1,Oi=Si[st],Rt=bt/2,Ot=Ot||st<0||Si[st+1]!=null,Ot=qi<4?(Oi!=null||Ot)&&(qi==0||qi==(_i.s<0?3:2)):Oi>Rt||Oi==Rt&&(qi==4||Ot||qi==6&&Si[st-1]&1||qi==(_i.s<0?8:7)),st<1||!Si[0])pt=Ot?Yf(mt.charAt(1),-tn,mt.charAt(0)):mt.charAt(0);else{if(Si.length=st,Ot)for(--bt;++Si[--st]>bt;)Si[st]=0,st||(++Nt,Si=[1].concat(Si));for(Rt=Si.length;!Si[--Rt];);for(Oi=0,pt="";Oi<=Rt;pt+=mt.charAt(Si[Oi++]));pt=Yf(pt,Nt,mt.charAt(0))}return pt}}(),t=function(){function rt(gt,bt,dt){var $e,mt,st,Nt,Rt=0,Ot=gt.length,_i=bt%R0,Si=bt/R0|0;for(gt=gt.slice();Ot--;)st=gt[Ot]%R0,Nt=gt[Ot]/R0|0,$e=Si*st+Nt*_i,mt=_i*st+$e%R0*R0+Rt,Rt=(mt/dt|0)+($e/R0|0)+Si*Nt,gt[Ot]=mt%dt;return Rt&&(gt=[Rt].concat(gt)),gt}function yt(gt,bt,dt,$e){var mt,st;if(dt!=$e)st=dt>$e?1:-1;else for(mt=st=0;mt<dt;mt++)if(gt[mt]!=bt[mt]){st=gt[mt]>bt[mt]?1:-1;break}return st}function pt(gt,bt,dt,$e){for(var mt=0;dt--;)gt[dt]-=mt,mt=gt[dt]<bt[dt]?1:0,gt[dt]=mt*$e+gt[dt]-bt[dt];for(;!gt[0]&&gt.length>1;gt.splice(0,1));}return function(gt,bt,dt,$e,mt){var st,Nt,Rt,Ot,_i,Si,Ti,Oi,tn,qi,Ni,nn,yn,Ci,gi,Ri,ai,Ki=gt.s==bt.s?1:-1,Ji=gt.c,fi=bt.c;if(!Ji||!Ji[0]||!fi||!fi[0])return new ut(!gt.s||!bt.s||(Ji?fi&&Ji[0]==fi[0]:!fi)?NaN:Ji&&Ji[0]==0||!fi?Ki*0:Ki/0);for(Oi=new ut(Ki),tn=Oi.c=[],Nt=gt.e-bt.e,Ki=dt+Nt+1,mt||(mt=oA,Nt=zh(gt.e/Ss)-zh(bt.e/Ss),Ki=Ki/Ss|0),Rt=0;fi[Rt]==(Ji[Rt]||0);Rt++);if(fi[Rt]>(Ji[Rt]||0)&&Nt--,Ki<0)tn.push(1),Ot=!0;else{for(Ci=Ji.length,Ri=fi.length,Rt=0,Ki+=2,_i=Bh(mt/(fi[0]+1)),_i>1&&(fi=rt(fi,_i,mt),Ji=rt(Ji,_i,mt),Ri=fi.length,Ci=Ji.length),yn=Ri,qi=Ji.slice(0,Ri),Ni=qi.length;Ni<Ri;qi[Ni++]=0);ai=fi.slice(),ai=[0].concat(ai),gi=fi[0],fi[1]>=mt/2&&gi++;do{if(_i=0,st=yt(fi,qi,Ri,Ni),st<0){if(nn=qi[0],Ri!=Ni&&(nn=nn*mt+(qi[1]||0)),_i=Bh(nn/gi),_i>1)for(_i>=mt&&(_i=mt-1),Si=rt(fi,_i,mt),Ti=Si.length,Ni=qi.length;yt(Si,qi,Ti,Ni)==1;)_i--,pt(Si,Ri<Ti?ai:fi,Ti,mt),Ti=Si.length,st=1;else _i==0&&(st=_i=1),Si=fi.slice(),Ti=Si.length;if(Ti<Ni&&(Si=[0].concat(Si)),pt(qi,Si,Ni,mt),Ni=qi.length,st==-1)for(;yt(fi,qi,Ri,Ni)<1;)_i++,pt(qi,Ri<Ni?ai:fi,Ni,mt),Ni=qi.length}else st===0&&(_i++,qi=[0]);tn[Rt++]=_i,qi[0]?qi[Ni++]=Ji[yn]||0:(qi=[Ji[yn]],Ni=1)}while((yn++<Ci||qi[0]!=null)&&Ki--);Ot=qi[0]!=null,tn[0]||tn.splice(0,1)}if(mt==oA){for(Rt=1,Ki=tn[0];Ki>=10;Ki/=10,Rt++);Ge(Oi,dt+(Oi.e=Rt+Nt*Ss-1)+1,$e,Ot)}else Oi.e=Nt,Oi.r=+Ot;return Oi}}();function Tt(rt,yt,pt,gt){var bt,dt,$e,mt,st;if(pt==null?pt=a:Fl(pt,0,8),!rt.c)return rt.toString();if(bt=rt.c[0],$e=rt.e,yt==null)st=Lh(rt.c),st=gt==1||gt==2&&($e<=G||$e>=W)?Kg(st,$e):Yf(st,$e,"0");else if(rt=Ge(new ut(rt),yt,pt),dt=rt.e,st=Lh(rt.c),mt=st.length,gt==1||gt==2&&(yt<=dt||dt<=G)){for(;mt<yt;st+="0",mt++);st=Kg(st,dt)}else if(yt-=$e,st=Yf(st,dt,"0"),dt+1>mt){if(--yt>0)for(st+=".";yt--;st+="0");}else if(yt+=dt-mt,yt>0)for(dt+1==mt&&(st+=".");yt--;st+="0");return rt.s<0&&bt?"-"+st:st}function Pt(rt,yt){for(var pt,gt,bt=1,dt=new ut(rt[0]);bt<rt.length;bt++)gt=new ut(rt[bt]),(!gt.s||(pt=qd(dt,gt))===yt||pt===0&&dt.s===yt)&&(dt=gt);return dt}function zt(rt,yt,pt){for(var gt=1,bt=yt.length;!yt[--bt];yt.pop());for(bt=yt[0];bt>=10;bt/=10,gt++);return(pt=gt+pt*Ss-1)>ae?rt.c=rt.e=null:pt<he?rt.c=[rt.e=0]:(rt.e=pt,rt.c=yt),rt}c=function(){var rt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,yt=/^([^.]+)\.$/,pt=/^\.([^.]+)$/,gt=/^-?(Infinity|NaN)$/,bt=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(dt,$e,mt,st){var Nt,Rt=mt?$e:$e.replace(bt,"");if(gt.test(Rt))dt.s=isNaN(Rt)?null:Rt<0?-1:1;else{if(!mt&&(Rt=Rt.replace(rt,function(Ot,_i,Si){return Nt=(Si=Si.toLowerCase())=="x"?16:Si=="b"?2:8,!st||st==Nt?_i:Ot}),st&&(Nt=st,Rt=Rt.replace(yt,"$1").replace(pt,"0.$1")),$e!=Rt))return new ut(Rt,Nt);if(ut.DEBUG)throw Error(Nc+"Not a"+(st?" base "+st:"")+" number: "+$e);dt.s=null}dt.c=dt.e=null}}();function Ge(rt,yt,pt,gt){var bt,dt,$e,mt,st,Nt,Rt,Ot=rt.c,_i=Ay;if(Ot){e:{for(bt=1,mt=Ot[0];mt>=10;mt/=10,bt++);if(dt=yt-bt,dt<0)dt+=Ss,$e=yt,st=Ot[Nt=0],Rt=Bh(st/_i[bt-$e-1]%10);else if(Nt=cy((dt+1)/Ss),Nt>=Ot.length)if(gt){for(;Ot.length<=Nt;Ot.push(0));st=Rt=0,bt=1,dt%=Ss,$e=dt-Ss+1}else break e;else{for(st=mt=Ot[Nt],bt=1;mt>=10;mt/=10,bt++);dt%=Ss,$e=dt-Ss+bt,Rt=$e<0?0:Bh(st/_i[bt-$e-1]%10)}if(gt=gt||yt<0||Ot[Nt+1]!=null||($e<0?st:st%_i[bt-$e-1]),gt=pt<4?(Rt||gt)&&(pt==0||pt==(rt.s<0?3:2)):Rt>5||Rt==5&&(pt==4||gt||pt==6&&(dt>0?$e>0?st/_i[bt-$e]:0:Ot[Nt-1])%10&1||pt==(rt.s<0?8:7)),yt<1||!Ot[0])return Ot.length=0,gt?(yt-=rt.e+1,Ot[0]=_i[(Ss-yt%Ss)%Ss],rt.e=-yt||0):Ot[0]=rt.e=0,rt;if(dt==0?(Ot.length=Nt,mt=1,Nt--):(Ot.length=Nt+1,mt=_i[Ss-dt],Ot[Nt]=$e>0?Bh(st/_i[bt-$e]%_i[$e])*mt:0),gt)for(;;)if(Nt==0){for(dt=1,$e=Ot[0];$e>=10;$e/=10,dt++);for($e=Ot[0]+=mt,mt=1;$e>=10;$e/=10,mt++);dt!=mt&&(rt.e++,Ot[0]==oA&&(Ot[0]=1));break}else{if(Ot[Nt]+=mt,Ot[Nt]!=oA)break;Ot[Nt--]=0,mt=1}for(dt=Ot.length;Ot[--dt]===0;Ot.pop());}rt.e>ae?rt.c=rt.e=null:rt.e<he&&(rt.c=[rt.e=0])}return rt}function Xt(rt){var yt,pt=rt.e;return pt===null?rt.toString():(yt=Lh(rt.c),yt=pt<=G||pt>=W?Kg(yt,pt):Yf(yt,pt,"0"),rt.s<0?"-"+yt:yt)}return g.absoluteValue=g.abs=function(){var rt=new ut(this);return rt.s<0&&(rt.s=1),rt},g.comparedTo=function(rt,yt){return qd(this,new ut(rt,yt))},g.decimalPlaces=g.dp=function(rt,yt){var pt,gt,bt,dt=this;if(rt!=null)return Fl(rt,0,Du),yt==null?yt=a:Fl(yt,0,8),Ge(new ut(dt),rt+dt.e+1,yt);if(!(pt=dt.c))return null;if(gt=((bt=pt.length-1)-zh(this.e/Ss))*Ss,bt=pt[bt])for(;bt%10==0;bt/=10,gt--);return gt<0&&(gt=0),gt},g.dividedBy=g.div=function(rt,yt){return t(this,new ut(rt,yt),I,a)},g.dividedToIntegerBy=g.idiv=function(rt,yt){return t(this,new ut(rt,yt),0,1)},g.exponentiatedBy=g.pow=function(rt,yt){var pt,gt,bt,dt,$e,mt,st,Nt,Rt,Ot=this;if(rt=new ut(rt),rt.c&&!rt.isInteger())throw Error(Nc+"Exponent not an integer: "+Xt(rt));if(yt!=null&&(yt=new ut(yt)),mt=rt.e>14,!Ot.c||!Ot.c[0]||Ot.c[0]==1&&!Ot.e&&Ot.c.length==1||!rt.c||!rt.c[0])return Rt=new ut(Math.pow(+Xt(Ot),mt?rt.s*(2-$g(rt)):+Xt(rt))),yt?Rt.mod(yt):Rt;if(st=rt.s<0,yt){if(yt.c?!yt.c[0]:!yt.s)return new ut(NaN);gt=!st&&Ot.isInteger()&&yt.isInteger(),gt&&(Ot=Ot.mod(yt))}else{if(rt.e>9&&(Ot.e>0||Ot.e<-1||(Ot.e==0?Ot.c[0]>1||mt&&Ot.c[1]>=24e7:Ot.c[0]<8e13||mt&&Ot.c[0]<=9999975e7)))return dt=Ot.s<0&&$g(rt)?-0:0,Ot.e>-1&&(dt=1/dt),new ut(st?1/dt:dt);Ke&&(dt=cy(Ke/Ss+2))}for(mt?(pt=new ut(.5),st&&(rt.s=1),Nt=$g(rt)):(bt=Math.abs(+Xt(rt)),Nt=bt%2),Rt=new ut(b);;){if(Nt){if(Rt=Rt.times(Ot),!Rt.c)break;dt?Rt.c.length>dt&&(Rt.c.length=dt):gt&&(Rt=Rt.mod(yt))}if(bt){if(bt=Bh(bt/2),bt===0)break;Nt=bt%2}else if(rt=rt.times(pt),Ge(rt,rt.e+1,1),rt.e>14)Nt=$g(rt);else{if(bt=+Xt(rt),bt===0)break;Nt=bt%2}Ot=Ot.times(Ot),dt?Ot.c&&Ot.c.length>dt&&(Ot.c.length=dt):gt&&(Ot=Ot.mod(yt))}return gt?Rt:(st&&(Rt=b.div(Rt)),yt?Rt.mod(yt):dt?Ge(Rt,Ke,a,$e):Rt)},g.integerValue=function(rt){var yt=new ut(this);return rt==null?rt=a:Fl(rt,0,8),Ge(yt,yt.e+1,rt)},g.isEqualTo=g.eq=function(rt,yt){return qd(this,new ut(rt,yt))===0},g.isFinite=function(){return!!this.c},g.isGreaterThan=g.gt=function(rt,yt){return qd(this,new ut(rt,yt))>0},g.isGreaterThanOrEqualTo=g.gte=function(rt,yt){return(yt=qd(this,new ut(rt,yt)))===1||yt===0},g.isInteger=function(){return!!this.c&&zh(this.e/Ss)>this.c.length-2},g.isLessThan=g.lt=function(rt,yt){return qd(this,new ut(rt,yt))<0},g.isLessThanOrEqualTo=g.lte=function(rt,yt){return(yt=qd(this,new ut(rt,yt)))===-1||yt===0},g.isNaN=function(){return!this.s},g.isNegative=function(){return this.s<0},g.isPositive=function(){return this.s>0},g.isZero=function(){return!!this.c&&this.c[0]==0},g.minus=function(rt,yt){var pt,gt,bt,dt,$e=this,mt=$e.s;if(rt=new ut(rt,yt),yt=rt.s,!mt||!yt)return new ut(NaN);if(mt!=yt)return rt.s=-yt,$e.plus(rt);var st=$e.e/Ss,Nt=rt.e/Ss,Rt=$e.c,Ot=rt.c;if(!st||!Nt){if(!Rt||!Ot)return Rt?(rt.s=-yt,rt):new ut(Ot?$e:NaN);if(!Rt[0]||!Ot[0])return Ot[0]?(rt.s=-yt,rt):new ut(Rt[0]?$e:a==3?-0:0)}if(st=zh(st),Nt=zh(Nt),Rt=Rt.slice(),mt=st-Nt){for((dt=mt<0)?(mt=-mt,bt=Rt):(Nt=st,bt=Ot),bt.reverse(),yt=mt;yt--;bt.push(0));bt.reverse()}else for(gt=(dt=(mt=Rt.length)<(yt=Ot.length))?mt:yt,mt=yt=0;yt<gt;yt++)if(Rt[yt]!=Ot[yt]){dt=Rt[yt]<Ot[yt];break}if(dt&&(bt=Rt,Rt=Ot,Ot=bt,rt.s=-rt.s),yt=(gt=Ot.length)-(pt=Rt.length),yt>0)for(;yt--;Rt[pt++]=0);for(yt=oA-1;gt>mt;){if(Rt[--gt]<Ot[gt]){for(pt=gt;pt&&!Rt[--pt];Rt[pt]=yt);--Rt[pt],Rt[gt]+=oA}Rt[gt]-=Ot[gt]}for(;Rt[0]==0;Rt.splice(0,1),--Nt);return Rt[0]?zt(rt,Rt,Nt):(rt.s=a==3?-1:1,rt.c=[rt.e=0],rt)},g.modulo=g.mod=function(rt,yt){var pt,gt,bt=this;return rt=new ut(rt,yt),!bt.c||!rt.s||rt.c&&!rt.c[0]?new ut(NaN):!rt.c||bt.c&&!bt.c[0]?new ut(bt):(be==9?(gt=rt.s,rt.s=1,pt=t(bt,rt,0,3),rt.s=gt,pt.s*=gt):pt=t(bt,rt,0,be),rt=bt.minus(pt.times(rt)),!rt.c[0]&&be==1&&(rt.s=bt.s),rt)},g.multipliedBy=g.times=function(rt,yt){var pt,gt,bt,dt,$e,mt,st,Nt,Rt,Ot,_i,Si,Ti,Oi,tn,qi=this,Ni=qi.c,nn=(rt=new ut(rt,yt)).c;if(!Ni||!nn||!Ni[0]||!nn[0])return!qi.s||!rt.s||Ni&&!Ni[0]&&!nn||nn&&!nn[0]&&!Ni?rt.c=rt.e=rt.s=null:(rt.s*=qi.s,!Ni||!nn?rt.c=rt.e=null:(rt.c=[0],rt.e=0)),rt;for(gt=zh(qi.e/Ss)+zh(rt.e/Ss),rt.s*=qi.s,st=Ni.length,Ot=nn.length,st<Ot&&(Ti=Ni,Ni=nn,nn=Ti,bt=st,st=Ot,Ot=bt),bt=st+Ot,Ti=[];bt--;Ti.push(0));for(Oi=oA,tn=R0,bt=Ot;--bt>=0;){for(pt=0,_i=nn[bt]%tn,Si=nn[bt]/tn|0,$e=st,dt=bt+$e;dt>bt;)Nt=Ni[--$e]%tn,Rt=Ni[$e]/tn|0,mt=Si*Nt+Rt*_i,Nt=_i*Nt+mt%tn*tn+Ti[dt]+pt,pt=(Nt/Oi|0)+(mt/tn|0)+Si*Rt,Ti[dt--]=Nt%Oi;Ti[dt]=pt}return pt?++gt:Ti.splice(0,1),zt(rt,Ti,gt)},g.negated=function(){var rt=new ut(this);return rt.s=-rt.s||null,rt},g.plus=function(rt,yt){var pt,gt=this,bt=gt.s;if(rt=new ut(rt,yt),yt=rt.s,!bt||!yt)return new ut(NaN);if(bt!=yt)return rt.s=-yt,gt.minus(rt);var dt=gt.e/Ss,$e=rt.e/Ss,mt=gt.c,st=rt.c;if(!dt||!$e){if(!mt||!st)return new ut(bt/0);if(!mt[0]||!st[0])return st[0]?rt:new ut(mt[0]?gt:bt*0)}if(dt=zh(dt),$e=zh($e),mt=mt.slice(),bt=dt-$e){for(bt>0?($e=dt,pt=st):(bt=-bt,pt=mt),pt.reverse();bt--;pt.push(0));pt.reverse()}for(bt=mt.length,yt=st.length,bt-yt<0&&(pt=st,st=mt,mt=pt,yt=bt),bt=0;yt;)bt=(mt[--yt]=mt[yt]+st[yt]+bt)/oA|0,mt[yt]=oA===mt[yt]?0:mt[yt]%oA;return bt&&(mt=[bt].concat(mt),++$e),zt(rt,mt,$e)},g.precision=g.sd=function(rt,yt){var pt,gt,bt,dt=this;if(rt!=null&&rt!==!!rt)return Fl(rt,1,Du),yt==null?yt=a:Fl(yt,0,8),Ge(new ut(dt),rt,yt);if(!(pt=dt.c))return null;if(bt=pt.length-1,gt=bt*Ss+1,bt=pt[bt]){for(;bt%10==0;bt/=10,gt--);for(bt=pt[0];bt>=10;bt/=10,gt++);}return rt&&dt.e+1>gt&&(gt=dt.e+1),gt},g.shiftedBy=function(rt){return Fl(rt,-hy,hy),this.times("1e"+rt)},g.squareRoot=g.sqrt=function(){var rt,yt,pt,gt,bt,dt=this,$e=dt.c,mt=dt.s,st=dt.e,Nt=I+4,Rt=new ut("0.5");if(mt!==1||!$e||!$e[0])return new ut(!mt||mt<0&&(!$e||$e[0])?NaN:$e?dt:1/0);if(mt=Math.sqrt(+Xt(dt)),mt==0||mt==1/0?(yt=Lh($e),(yt.length+st)%2==0&&(yt+="0"),mt=Math.sqrt(+yt),st=zh((st+1)/2)-(st<0||st%2),mt==1/0?yt="5e"+st:(yt=mt.toExponential(),yt=yt.slice(0,yt.indexOf("e")+1)+st),pt=new ut(yt)):pt=new ut(mt+""),pt.c[0]){for(st=pt.e,mt=st+Nt,mt<3&&(mt=0);;)if(bt=pt,pt=Rt.times(bt.plus(t(dt,bt,Nt,1))),Lh(bt.c).slice(0,mt)===(yt=Lh(pt.c)).slice(0,mt))if(pt.e<st&&--mt,yt=yt.slice(mt-3,mt+1),yt=="9999"||!gt&&yt=="4999"){if(!gt&&(Ge(bt,bt.e+I+2,0),bt.times(bt).eq(dt))){pt=bt;break}Nt+=4,mt+=4,gt=1}else{(!+yt||!+yt.slice(1)&&yt.charAt(0)=="5")&&(Ge(pt,pt.e+I+2,1),rt=!pt.times(pt).eq(dt));break}}return Ge(pt,pt.e+I+1,a,rt)},g.toExponential=function(rt,yt){return rt!=null&&(Fl(rt,0,Du),rt++),Tt(this,rt,yt,1)},g.toFixed=function(rt,yt){return rt!=null&&(Fl(rt,0,Du),rt=rt+this.e+1),Tt(this,rt,yt)},g.toFormat=function(rt,yt,pt){var gt,bt=this;if(pt==null)rt!=null&&yt&&typeof yt=="object"?(pt=yt,yt=null):rt&&typeof rt=="object"?(pt=rt,rt=yt=null):pt=ot;else if(typeof pt!="object")throw Error(Nc+"Argument not an object: "+pt);if(gt=bt.toFixed(rt,yt),bt.c){var dt,$e=gt.split("."),mt=+pt.groupSize,st=+pt.secondaryGroupSize,Nt=pt.groupSeparator||"",Rt=$e[0],Ot=$e[1],_i=bt.s<0,Si=_i?Rt.slice(1):Rt,Ti=Si.length;if(st&&(dt=mt,mt=st,st=dt,Ti-=dt),mt>0&&Ti>0){for(dt=Ti%mt||mt,Rt=Si.substr(0,dt);dt<Ti;dt+=mt)Rt+=Nt+Si.substr(dt,mt);st>0&&(Rt+=Nt+Si.slice(dt)),_i&&(Rt="-"+Rt)}gt=Ot?Rt+(pt.decimalSeparator||"")+((st=+pt.fractionGroupSize)?Ot.replace(new RegExp("\\d{"+st+"}\\B","g"),"$&"+(pt.fractionGroupSeparator||"")):Ot):Rt}return(pt.prefix||"")+gt+(pt.suffix||"")},g.toFraction=function(rt){var yt,pt,gt,bt,dt,$e,mt,st,Nt,Rt,Ot,_i,Si=this,Ti=Si.c;if(rt!=null&&(mt=new ut(rt),!mt.isInteger()&&(mt.c||mt.s!==1)||mt.lt(b)))throw Error(Nc+"Argument "+(mt.isInteger()?"out of range: ":"not an integer: ")+Xt(mt));if(!Ti)return new ut(Si);for(yt=new ut(b),Nt=pt=new ut(b),gt=st=new ut(b),_i=Lh(Ti),dt=yt.e=_i.length-Si.e-1,yt.c[0]=Ay[($e=dt%Ss)<0?Ss+$e:$e],rt=!rt||mt.comparedTo(yt)>0?dt>0?yt:Nt:mt,$e=ae,ae=1/0,mt=new ut(_i),st.c[0]=0;Rt=t(mt,yt,0,1),bt=pt.plus(Rt.times(gt)),bt.comparedTo(rt)!=1;)pt=gt,gt=bt,Nt=st.plus(Rt.times(bt=Nt)),st=bt,yt=mt.minus(Rt.times(bt=yt)),mt=bt;return bt=t(rt.minus(pt),gt,0,1),st=st.plus(bt.times(Nt)),pt=pt.plus(bt.times(gt)),st.s=Nt.s=Si.s,dt=dt*2,Ot=t(Nt,gt,dt,a).minus(Si).abs().comparedTo(t(st,pt,dt,a).minus(Si).abs())<1?[Nt,gt]:[st,pt],ae=$e,Ot},g.toNumber=function(){return+Xt(this)},g.toPrecision=function(rt,yt){return rt!=null&&Fl(rt,1,Du),Tt(this,rt,yt,2)},g.toString=function(rt){var yt,pt=this,gt=pt.s,bt=pt.e;return bt===null?gt?(yt="Infinity",gt<0&&(yt="-"+yt)):yt="NaN":(rt==null?yt=bt<=G||bt>=W?Kg(Lh(pt.c),bt):Yf(Lh(pt.c),bt,"0"):rt===10&&lt?(pt=Ge(new ut(pt),I+bt+1,a),yt=Yf(Lh(pt.c),pt.e,"0")):(Fl(rt,2,tt.length,"Base"),yt=n(Yf(Lh(pt.c),bt,"0"),10,rt,gt,!0)),gt<0&&pt.c[0]&&(yt="-"+yt)),yt},g.valueOf=g.toJSON=function(){return Xt(this)},g._isBigNumber=!0,g[Symbol.toStringTag]="BigNumber",g[Symbol.for("nodejs.util.inspect.custom")]=g.valueOf,e!=null&&ut.set(e),ut}function zh(e){var t=e|0;return e>0||e===t?t:t-1}function Lh(e){for(var t,n,c=1,g=e.length,b=e[0]+"";c<g;){for(t=e[c++]+"",n=Ss-t.length;n--;t="0"+t);b+=t}for(g=b.length;b.charCodeAt(--g)===48;);return b.slice(0,g+1||1)}function qd(e,t){var n,c,g=e.c,b=t.c,I=e.s,a=t.s,G=e.e,W=t.e;if(!I||!a)return null;if(n=g&&!g[0],c=b&&!b[0],n||c)return n?c?0:-a:I;if(I!=a)return I;if(n=I<0,c=G==W,!g||!b)return c?0:!g^n?1:-1;if(!c)return G>W^n?1:-1;for(a=(G=g.length)<(W=b.length)?G:W,I=0;I<a;I++)if(g[I]!=b[I])return g[I]>b[I]^n?1:-1;return G==W?0:G>W^n?1:-1}function Fl(e,t,n,c){if(e<t||e>n||e!==Bh(e))throw Error(Nc+(c||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function $g(e){var t=e.c.length-1;return zh(e.e/Ss)==t&&e.c[t]%2!=0}function Kg(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Yf(e,t,n){var c,g;if(t<0){for(g=n+".";++t;g+=n);e=g+e}else if(c=e.length,++t>c){for(g=n,t-=c;--t;g+=n);e+=g}else t<c&&(e=e.slice(0,t)+"."+e.slice(t));return e}var YA=R5();class HV{constructor(t){Er(this,"key");Er(this,"left",null);Er(this,"right",null);this.key=t}}class eg extends HV{constructor(t){super(t)}}class jV{constructor(){Er(this,"size",0);Er(this,"modificationCount",0);Er(this,"splayCount",0)}splay(t){const n=this.root;if(n==null)return this.compare(t,t),-1;let c=null,g=null,b=null,I=null,a=n;const G=this.compare;let W;for(;;)if(W=G(a.key,t),W>0){let he=a.left;if(he==null||(W=G(he.key,t),W>0&&(a.left=he.right,he.right=a,a=he,he=a.left,he==null)))break;c==null?g=a:c.left=a,c=a,a=he}else if(W<0){let he=a.right;if(he==null||(W=G(he.key,t),W<0&&(a.right=he.left,he.left=a,a=he,he=a.right,he==null)))break;b==null?I=a:b.right=a,b=a,a=he}else break;return b!=null&&(b.right=a.left,a.left=I),c!=null&&(c.left=a.right,a.right=g),this.root!==a&&(this.root=a,this.splayCount++),W}splayMin(t){let n=t,c=n.left;for(;c!=null;){const g=c;n.left=g.right,g.right=n,n=g,c=n.left}return n}splayMax(t){let n=t,c=n.right;for(;c!=null;){const g=c;n.right=g.left,g.left=n,n=g,c=n.right}return n}_delete(t){if(this.root==null||this.splay(t)!=0)return null;let c=this.root;const g=c,b=c.left;if(this.size--,b==null)this.root=c.right;else{const I=c.right;c=this.splayMax(b),c.right=I,this.root=c}return this.modificationCount++,g}addNewRoot(t,n){this.size++,this.modificationCount++;const c=this.root;if(c==null){this.root=t;return}n<0?(t.left=c,t.right=c.right,c.right=null):(t.right=c,t.left=c.left,c.left=null),this.root=t}_first(){const t=this.root;return t==null?null:(this.root=this.splayMin(t),this.root)}_last(){const t=this.root;return t==null?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&this.splay(t)==0}defaultCompare(){return(t,n)=>t<n?-1:t>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}}var DU;const am=class am extends jV{constructor(n,c){super();Er(this,"root",null);Er(this,"compare");Er(this,"validKey");Er(this,DU,"[object Set]");this.compare=n??this.defaultCompare(),this.validKey=c??(g=>g!=null&&g!=null)}delete(n){return this.validKey(n)?this._delete(n)!=null:!1}deleteAll(n){for(const c of n)this.delete(c)}forEach(n){const c=this[Symbol.iterator]();let g;for(;g=c.next(),!g.done;)n(g.value,g.value,this)}add(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new eg(n),c),this}addAndReturn(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new eg(n),c),this.root.key}addAll(n){for(const c of n)this.add(c)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)<0)return this.root.key;let g=this.root.left;if(g==null)return null;let b=g.right;for(;b!=null;)g=b,b=g.right;return g.key}firstAfter(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)>0)return this.root.key;let g=this.root.right;if(g==null)return null;let b=g.left;for(;b!=null;)g=b,b=g.left;return g.key}retainAll(n){const c=new am(this.compare,this.validKey),g=this.modificationCount;for(const b of n){if(g!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(b)&&this.splay(b)==0&&c.add(this.root.key)}c.size!=this.size&&(this.root=c.root,this.size=c.size,this.modificationCount++)}lookup(n){return!this.validKey(n)||this.splay(n)!=0?null:this.root.key}intersection(n){const c=new am(this.compare,this.validKey);for(const g of this)n.has(g)&&c.add(g);return c}difference(n){const c=new am(this.compare,this.validKey);for(const g of this)n.has(g)||c.add(g);return c}union(n){const c=this.clone();return c.addAll(n),c}clone(){const n=new am(this.compare,this.validKey);return n.size=this.size,n.root=this.copyNode(this.root),n}copyNode(n){if(n==null)return null;function c(b,I){let a,G;do{if(a=b.left,G=b.right,a!=null){const W=new eg(a.key);I.left=W,c(a,W)}if(G!=null){const W=new eg(G.key);I.right=W,b=G,I=W}}while(G!=null)}const g=new eg(n.key);return c(n,g),g}toSet(){return this.clone()}entries(){return new QV(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new ZV(this.wrap())}};DU=Symbol.toStringTag;let bm=am;class F5{constructor(t){Er(this,"tree");Er(this,"path",new Array);Er(this,"modificationCount",null);Er(this,"splayCount");this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;t!=null;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let c=this.tree.getRoot();for(;c!=null;)this.path.push(c),c=c.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],n=t.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}}class ZV extends F5{getValue(t){return t.key}}class QV extends F5{getValue(t){return[t.key,t.key]}}const WV=e=>e,XV=e=>{if(e){const t=new bm(Tv(e)),n=new bm(Tv(e)),c=(b,I)=>I.addAndReturn(b),g=b=>({x:c(b.x,t),y:c(b.y,n)});return g({x:new YA(0),y:new YA(0)}),g}return WV},kv=e=>({set:t=>{r0=kv(t)},reset:()=>kv(e),compare:Tv(e),snap:XV(e),orient:GV(e)});let r0=kv();const tg=(e,t)=>e.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(e.ur.y),Mv=(e,t)=>{if(t.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(t.ll.y))return null;const n=e.ll.x.isLessThan(t.ll.x)?t.ll.x:e.ll.x,c=e.ur.x.isLessThan(t.ur.x)?e.ur.x:t.ur.x,g=e.ll.y.isLessThan(t.ll.y)?t.ll.y:e.ll.y,b=e.ur.y.isLessThan(t.ur.y)?e.ur.y:t.ur.y;return{ll:{x:n,y:g},ur:{x:c,y:b}}},f_=(e,t)=>e.x.times(t.y).minus(e.y.times(t.x)),O5=(e,t)=>e.x.times(t.x).plus(e.y.times(t.y)),W_=e=>O5(e,e).sqrt(),YV=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return f_(g,c).div(W_(g)).div(W_(c))},$V=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return O5(g,c).div(W_(g)).div(W_(c))},Lw=(e,t,n)=>t.y.isZero()?null:{x:e.x.plus(t.x.div(t.y).times(n.minus(e.y))),y:n},Bw=(e,t,n)=>t.x.isZero()?null:{x:n,y:e.y.plus(t.y.div(t.x).times(n.minus(e.x)))},KV=(e,t,n,c)=>{if(t.x.isZero())return Bw(n,c,e.x);if(c.x.isZero())return Bw(e,t,n.x);if(t.y.isZero())return Lw(n,c,e.y);if(c.y.isZero())return Lw(e,t,n.y);const g=f_(t,c);if(g.isZero())return null;const b={x:n.x.minus(e.x),y:n.y.minus(e.y)},I=f_(b,t).div(g),a=f_(b,c).div(g),G=e.x.plus(a.times(t.x)),W=n.x.plus(I.times(c.x)),he=e.y.plus(a.times(t.y)),ae=n.y.plus(I.times(c.y)),ue=G.plus(W).div(2),be=he.plus(ae).div(2);return{x:ue,y:be}};class Fh{constructor(t,n){Er(this,"point");Er(this,"isLeft");Er(this,"segment");Er(this,"otherSE");Er(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=n}static compare(t,n){const c=Fh.comparePoints(t.point,n.point);return c!==0?c:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:F0.compare(t.segment,n.segment))}static comparePoints(t,n){return t.x.isLessThan(n.x)?-1:t.x.isGreaterThan(n.x)?1:t.y.isLessThan(n.y)?-1:t.y.isGreaterThan(n.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const n=t.point.events;for(let c=0,g=n.length;c<g;c++){const b=n[c];this.point.events.push(b),b.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let n=0;n<t;n++){const c=this.point.events[n];if(c.segment.consumedBy===void 0)for(let g=n+1;g<t;g++){const b=this.point.events[g];b.consumedBy===void 0&&c.otherSE.point.events===b.otherSE.point.events&&c.segment.consume(b.segment)}}}getAvailableLinkedEvents(){const t=[];for(let n=0,c=this.point.events.length;n<c;n++){const g=this.point.events[n];g!==this&&!g.segment.ringOut&&g.segment.isInResult()&&t.push(g)}return t}getLeftmostComparator(t){const n=new Map,c=g=>{const b=g.otherSE;n.set(g,{sine:YV(this.point,t.point,b.point),cosine:$V(this.point,t.point,b.point)})};return(g,b)=>{n.has(g)||c(g),n.has(b)||c(b);const{sine:I,cosine:a}=n.get(g),{sine:G,cosine:W}=n.get(b);return I.isGreaterThanOrEqualTo(0)&&G.isGreaterThanOrEqualTo(0)?a.isLessThan(W)?1:a.isGreaterThan(W)?-1:0:I.isLessThan(0)&&G.isLessThan(0)?a.isLessThan(W)?-1:a.isGreaterThan(W)?1:0:G.isLessThan(I)?-1:G.isGreaterThan(I)?1:0}}}let JV=0;class F0{constructor(t,n,c,g){Er(this,"id");Er(this,"leftSE");Er(this,"rightSE");Er(this,"rings");Er(this,"windings");Er(this,"ringOut");Er(this,"consumedBy");Er(this,"prev");Er(this,"_prevInResult");Er(this,"_beforeState");Er(this,"_afterState");Er(this,"_isInResult");this.id=++JV,this.leftSE=t,t.segment=this,t.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=t,this.rings=c,this.windings=g}static compare(t,n){const c=t.leftSE.point.x,g=n.leftSE.point.x,b=t.rightSE.point.x,I=n.rightSE.point.x;if(I.isLessThan(c))return 1;if(b.isLessThan(g))return-1;const a=t.leftSE.point.y,G=n.leftSE.point.y,W=t.rightSE.point.y,he=n.rightSE.point.y;if(c.isLessThan(g)){if(G.isLessThan(a)&&G.isLessThan(W))return 1;if(G.isGreaterThan(a)&&G.isGreaterThan(W))return-1;const ae=t.comparePoint(n.leftSE.point);if(ae<0)return 1;if(ae>0)return-1;const ue=n.comparePoint(t.rightSE.point);return ue!==0?ue:-1}if(c.isGreaterThan(g)){if(a.isLessThan(G)&&a.isLessThan(he))return-1;if(a.isGreaterThan(G)&&a.isGreaterThan(he))return 1;const ae=n.comparePoint(t.leftSE.point);if(ae!==0)return ae;const ue=t.comparePoint(n.rightSE.point);return ue<0?1:ue>0?-1:1}if(a.isLessThan(G))return-1;if(a.isGreaterThan(G))return 1;if(b.isLessThan(I)){const ae=n.comparePoint(t.rightSE.point);if(ae!==0)return ae}if(b.isGreaterThan(I)){const ae=t.comparePoint(n.rightSE.point);if(ae<0)return 1;if(ae>0)return-1}if(!b.eq(I)){const ae=W.minus(a),ue=b.minus(c),be=he.minus(G),Ke=I.minus(g);if(ae.isGreaterThan(ue)&&be.isLessThan(Ke))return 1;if(ae.isLessThan(ue)&&be.isGreaterThan(Ke))return-1}return b.isGreaterThan(I)?1:b.isLessThan(I)||W.isLessThan(he)?-1:W.isGreaterThan(he)?1:t.id<n.id?-1:t.id>n.id?1:0}static fromRing(t,n,c){let g,b,I;const a=Fh.comparePoints(t,n);if(a<0)g=t,b=n,I=1;else if(a>0)g=n,b=t,I=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const G=new Fh(g,!0),W=new Fh(b,!1);return new F0(G,W,[c],[I])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(n)?t:n},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(n)?t:n}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return r0.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const n=this.bbox(),c=t.bbox(),g=Mv(n,c);if(g===null)return null;const b=this.leftSE.point,I=this.rightSE.point,a=t.leftSE.point,G=t.rightSE.point,W=tg(n,a)&&this.comparePoint(a)===0,he=tg(c,b)&&t.comparePoint(b)===0,ae=tg(n,G)&&this.comparePoint(G)===0,ue=tg(c,I)&&t.comparePoint(I)===0;if(he&&W)return ue&&!ae?I:!ue&&ae?G:null;if(he)return ae&&b.x.eq(G.x)&&b.y.eq(G.y)?null:b;if(W)return ue&&I.x.eq(a.x)&&I.y.eq(a.y)?null:a;if(ue&&ae)return null;if(ue)return I;if(ae)return G;const be=KV(b,this.vector(),a,t.vector());return be===null||!tg(g,be)?null:r0.snap(be)}split(t){const n=[],c=t.events!==void 0,g=new Fh(t,!0),b=new Fh(t,!1),I=this.rightSE;this.replaceRightSE(b),n.push(b),n.push(g);const a=new F0(g,I,this.rings.slice(),this.windings.slice());return Fh.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Fh.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(g.checkForConsuming(),b.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,c=this.windings.length;n<c;n++)this.windings[n]*=-1}consume(t){let n=this,c=t;for(;n.consumedBy;)n=n.consumedBy;for(;c.consumedBy;)c=c.consumedBy;const g=F0.compare(n,c);if(g!==0){if(g>0){const b=n;n=c,c=b}if(n.prev===c){const b=n;n=c,c=b}for(let b=0,I=c.rings.length;b<I;b++){const a=c.rings[b],G=c.windings[b],W=n.rings.indexOf(a);W===-1?(n.rings.push(a),n.windings.push(G)):n.windings[W]+=G}c.rings=null,c.windings=null,c.consumedBy=n,c.leftSE.consumedBy=n.leftSE,c.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,c=this._afterState.windings,g=this._afterState.multiPolys;for(let a=0,G=this.rings.length;a<G;a++){const W=this.rings[a],he=this.windings[a],ae=n.indexOf(W);ae===-1?(n.push(W),c.push(he)):c[ae]+=he}const b=[],I=[];for(let a=0,G=n.length;a<G;a++){if(c[a]===0)continue;const W=n[a],he=W.poly;if(I.indexOf(he)===-1)if(W.isExterior)b.push(he);else{I.indexOf(he)===-1&&I.push(he);const ae=b.indexOf(W.poly);ae!==-1&&b.splice(ae,1)}}for(let a=0,G=b.length;a<G;a++){const W=b[a].multiPoly;g.indexOf(W)===-1&&g.push(W)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Pv.type){case"union":{const c=t.length===0,g=n.length===0;this._isInResult=c!==g;break}case"intersection":{let c,g;t.length<n.length?(c=t.length,g=n.length):(c=n.length,g=t.length),this._isInResult=g===Pv.numMultiPolys&&c<g;break}case"xor":{const c=Math.abs(t.length-n.length);this._isInResult=c%2===1;break}case"difference":{const c=g=>g.length===1&&g[0].isSubject;this._isInResult=c(t)!==c(n);break}}return this._isInResult}}class zw{constructor(t,n,c){Er(this,"poly");Er(this,"isExterior");Er(this,"segments");Er(this,"bbox");if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=c,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const g=r0.snap({x:new YA(t[0][0]),y:new YA(t[0][1])});this.bbox={ll:{x:g.x,y:g.y},ur:{x:g.x,y:g.y}};let b=g;for(let I=1,a=t.length;I<a;I++){if(typeof t[I][0]!="number"||typeof t[I][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const G=r0.snap({x:new YA(t[I][0]),y:new YA(t[I][1])});G.x.eq(b.x)&&G.y.eq(b.y)||(this.segments.push(F0.fromRing(b,G,this)),G.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=G.x),G.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=G.y),G.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=G.x),G.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=G.y),b=G)}(!g.x.eq(b.x)||!g.y.eq(b.y))&&this.segments.push(F0.fromRing(b,g,this))}getSweepEvents(){const t=[];for(let n=0,c=this.segments.length;n<c;n++){const g=this.segments[n];t.push(g.leftSE),t.push(g.rightSE)}return t}}class eU{constructor(t,n){Er(this,"multiPoly");Er(this,"exteriorRing");Er(this,"interiorRings");Er(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new zw(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let c=1,g=t.length;c<g;c++){const b=new zw(t[c],this,!1);b.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=b.bbox.ll.x),b.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=b.bbox.ll.y),b.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=b.bbox.ur.x),b.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=b.bbox.ur.y),this.interiorRings.push(b)}this.multiPoly=n}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getSweepEvents();for(let b=0,I=g.length;b<I;b++)t.push(g[b])}return t}}class Rw{constructor(t,n){Er(this,"isSubject");Er(this,"polys");Er(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:new YA(Number.POSITIVE_INFINITY),y:new YA(Number.POSITIVE_INFINITY)},ur:{x:new YA(Number.NEGATIVE_INFINITY),y:new YA(Number.NEGATIVE_INFINITY)}};for(let c=0,g=t.length;c<g;c++){const b=new eU(t[c],this);b.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=b.bbox.ll.x),b.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=b.bbox.ll.y),b.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=b.bbox.ur.x),b.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=b.bbox.ur.y),this.polys.push(b)}this.isSubject=n}getSweepEvents(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getSweepEvents();for(let b=0,I=g.length;b<I;b++)t.push(g[b])}return t}}class X_{constructor(t){Er(this,"events");Er(this,"poly");Er(this,"_isExteriorRing");Er(this,"_enclosingRing");this.events=t;for(let n=0,c=t.length;n<c;n++)t[n].segment.ringOut=this;this.poly=null}static factory(t){const n=[];for(let c=0,g=t.length;c<g;c++){const b=t[c];if(!b.isInResult()||b.ringOut)continue;let I=null,a=b.leftSE,G=b.rightSE;const W=[a],he=a.point,ae=[];for(;I=a,a=G,W.push(a),a.point!==he;)for(;;){const ue=a.getAvailableLinkedEvents();if(ue.length===0){const ot=W[0].point,tt=W[W.length-1].point;throw new Error(`Unable to complete output ring starting at [${ot.x}, ${ot.y}]. Last matching segment found ends at [${tt.x}, ${tt.y}].`)}if(ue.length===1){G=ue[0].otherSE;break}let be=null;for(let ot=0,tt=ae.length;ot<tt;ot++)if(ae[ot].point===a.point){be=ot;break}if(be!==null){const ot=ae.splice(be)[0],tt=W.splice(ot.index);tt.unshift(tt[0].otherSE),n.push(new X_(tt.reverse()));continue}ae.push({index:W.length,point:a.point});const Ke=a.getLeftmostComparator(I);G=ue.sort(Ke)[0].otherSE;break}n.push(new X_(W))}return n}getGeom(){let t=this.events[0].point;const n=[t];for(let W=1,he=this.events.length-1;W<he;W++){const ae=this.events[W].point,ue=this.events[W+1].point;r0.orient(ae,t,ue)!==0&&(n.push(ae),t=ae)}if(n.length===1)return null;const c=n[0],g=n[1];r0.orient(c,t,g)===0&&n.shift(),n.push(n[0]);const b=this.isExteriorRing()?1:-1,I=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,G=[];for(let W=I;W!=a;W+=b)G.push([n[W].x.toNumber(),n[W].y.toNumber()]);return G}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var g,b;let t=this.events[0];for(let I=1,a=this.events.length;I<a;I++){const G=this.events[I];Fh.compare(t,G)>0&&(t=G)}let n=t.segment.prevInResult(),c=n?n.prevInResult():null;for(;;){if(!n)return null;if(!c)return n.ringOut;if(c.ringOut!==n.ringOut)return((g=c.ringOut)==null?void 0:g.enclosingRing())!==n.ringOut?n.ringOut:(b=n.ringOut)==null?void 0:b.enclosingRing();n=c.prevInResult(),c=n?n.prevInResult():null}}}class Fw{constructor(t){Er(this,"exteriorRing");Er(this,"interiorRings");this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getGeom();g!==null&&t.push(g)}return t}}class tU{constructor(t){Er(this,"rings");Er(this,"polys");this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getGeom();g!==null&&t.push(g)}return t}_composePolys(t){var c;const n=[];for(let g=0,b=t.length;g<b;g++){const I=t[g];if(!I.poly)if(I.isExteriorRing())n.push(new Fw(I));else{const a=I.enclosingRing();a!=null&&a.poly||n.push(new Fw(a)),(c=a==null?void 0:a.poly)==null||c.addInterior(I)}}return n}}class iU{constructor(t,n=F0.compare){Er(this,"queue");Er(this,"tree");Er(this,"segments");this.queue=t,this.tree=new bm(n),this.segments=[]}process(t){const n=t.segment,c=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(n),c;t.isLeft&&this.tree.add(n);let g=n,b=n;do g=this.tree.lastBefore(g);while(g!=null&&g.consumedBy!=null);do b=this.tree.firstAfter(b);while(b!=null&&b.consumedBy!=null);if(t.isLeft){let I=null;if(g){const G=g.getIntersection(n);if(G!==null&&(n.isAnEndpoint(G)||(I=G),!g.isAnEndpoint(G))){const W=this._splitSafely(g,G);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}}let a=null;if(b){const G=b.getIntersection(n);if(G!==null&&(n.isAnEndpoint(G)||(a=G),!b.isAnEndpoint(G))){const W=this._splitSafely(b,G);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}}if(I!==null||a!==null){let G=null;I===null?G=a:a===null?G=I:G=Fh.comparePoints(I,a)<=0?I:a,this.queue.delete(n.rightSE),c.push(n.rightSE);const W=n.split(G);for(let he=0,ae=W.length;he<ae;he++)c.push(W[he])}c.length>0?(this.tree.delete(n),c.push(t)):(this.segments.push(n),n.prev=g)}else{if(g&&b){const I=g.getIntersection(b);if(I!==null){if(!g.isAnEndpoint(I)){const a=this._splitSafely(g,I);for(let G=0,W=a.length;G<W;G++)c.push(a[G])}if(!b.isAnEndpoint(I)){const a=this._splitSafely(b,I);for(let G=0,W=a.length;G<W;G++)c.push(a[G])}}}this.tree.delete(n)}return c}_splitSafely(t,n){this.tree.delete(t);const c=t.rightSE;this.queue.delete(c);const g=t.split(n);return g.push(c),t.consumedBy===void 0&&this.tree.add(t),g}}class nU{constructor(){Er(this,"type");Er(this,"numMultiPolys")}run(t,n,c){ug.type=t;const g=[new Rw(n,!0)];for(let he=0,ae=c.length;he<ae;he++)g.push(new Rw(c[he],!1));if(ug.numMultiPolys=g.length,ug.type==="difference"){const he=g[0];let ae=1;for(;ae<g.length;)Mv(g[ae].bbox,he.bbox)!==null?ae++:g.splice(ae,1)}if(ug.type==="intersection")for(let he=0,ae=g.length;he<ae;he++){const ue=g[he];for(let be=he+1,Ke=g.length;be<Ke;be++)if(Mv(ue.bbox,g[be].bbox)===null)return[]}const b=new bm(Fh.compare);for(let he=0,ae=g.length;he<ae;he++){const ue=g[he].getSweepEvents();for(let be=0,Ke=ue.length;be<Ke;be++)b.add(ue[be])}const I=new iU(b);let a=null;for(b.size!=0&&(a=b.first(),b.delete(a));a;){const he=I.process(a);for(let ae=0,ue=he.length;ae<ue;ae++){const be=he[ae];be.consumedBy===void 0&&b.add(be)}b.size!=0?(a=b.first(),b.delete(a)):a=null}r0.reset();const G=X_.factory(I.segments);return new tU(G).getGeom()}}const ug=new nU,Pv=ug,rU=(e,...t)=>Pv.run("intersection",e,t);r0.set;var sU={exports:{}},fy,Ow;function aU(){return Ow||(Ow=1,fy=function(t){return function n(c){return arguments.length===0||c!=null&&c["@@functional/placeholder"]===!0?n:t.apply(this,arguments)}}),fy}var dy,Nw;function oU(){if(Nw)return dy;Nw=1;var e=aU();return dy=e(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),dy}var py,Vw;function P2(){if(Vw)return py;Vw=1;function e(t){var n=typeof t;return!!t&&(n=="object"||n=="function")}return py=e,py}var my,Uw;function lU(){if(Uw)return my;Uw=1;var e=P2();function t(n){return e(n)?n:Object(n)}return my=t,my}var gy,Gw;function uU(){if(Gw)return gy;Gw=1;var e=lU();function t(n){return function(c,g,b){for(var I=e(c),a=b(c),G=a.length,W=n?G:-1;n?W--:++W<G;){var he=a[W];if(g(I[he],he,I)===!1)break}return c}}return gy=t,gy}var _y,qw;function cU(){if(qw)return _y;qw=1;var e=uU(),t=e();return _y=t,_y}var yy,Hw;function hU(){if(Hw)return yy;Hw=1;function e(t){return function(n){return n==null?void 0:n[t]}}return yy=e,yy}var vy,jw;function AU(){if(jw)return vy;jw=1;var e=hU(),t=e("length");return vy=t,vy}var xy,Zw;function D2(){if(Zw)return xy;Zw=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return xy=t,xy}var by,Qw;function fU(){if(Qw)return by;Qw=1;var e=AU(),t=D2();function n(c){return c!=null&&t(e(c))}return by=n,by}var wy,Ww;function v1(){if(Ww)return wy;Ww=1;function e(t){return!!t&&typeof t=="object"}return wy=e,wy}var Sy,Xw;function N5(){if(Xw)return Sy;Xw=1;var e=fU(),t=v1(),n=Object.prototype,c=n.hasOwnProperty,g=n.propertyIsEnumerable;function b(I){return t(I)&&e(I)&&c.call(I,"callee")&&!g.call(I,"callee")}return Sy=b,Sy}var Iy,Yw;function dU(){if(Yw)return Iy;Yw=1;var e=P2(),t="[object Function]",n=Object.prototype,c=n.toString;function g(b){return e(b)&&c.call(b)==t}return Iy=g,Iy}var Ey,$w;function pU(){if($w)return Ey;$w=1;var e=dU(),t=v1(),n=/^\[object .+?Constructor\]$/,c=Object.prototype,g=Function.prototype.toString,b=c.hasOwnProperty,I=RegExp("^"+g.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function a(G){return G==null?!1:e(G)?I.test(g.call(G)):t(G)&&n.test(G)}return Ey=a,Ey}var Cy,Kw;function mU(){if(Kw)return Cy;Kw=1;var e=pU();function t(n,c){var g=n==null?void 0:n[c];return e(g)?g:void 0}return Cy=t,Cy}var Ty,Jw;function gU(){if(Jw)return Ty;Jw=1;var e=mU(),t=D2(),n=v1(),c="[object Array]",g=Object.prototype,b=g.toString,I=e(Array,"isArray"),a=I||function(G){return n(G)&&t(G.length)&&b.call(G)==c};return Ty=a,Ty}var ky,e3;function _U(){if(e3)return ky;e3=1;var e=/^\d+$/,t=9007199254740991;function n(c,g){return c=typeof c=="number"||e.test(c)?+c:-1,g=g??t,c>-1&&c%1==0&&c<g}return ky=n,ky}var My,t3;function yU(){if(t3)return My;t3=1;var e=N5(),t=gU(),n=_U(),c=D2(),g=P2(),b=Object.prototype,I=b.hasOwnProperty;function a(G){if(G==null)return[];g(G)||(G=Object(G));var W=G.length;W=W&&c(W)&&(t(G)||e(G))&&W||0;for(var he=G.constructor,ae=-1,ue=typeof he=="function"&&he.prototype===G,be=Array(W),Ke=W>0;++ae<W;)be[ae]=ae+"";for(var ot in G)!(Ke&&n(ot,W))&&!(ot=="constructor"&&(ue||!I.call(G,ot)))&&be.push(ot);return be}return My=a,My}var Py,i3;function vU(){if(i3)return Py;i3=1;var e=cU(),t=yU();function n(c,g){return e(c,g,t)}return Py=n,Py}var Dy,n3;function xU(){if(n3)return Dy;n3=1;var e=vU(),t=N5(),n=v1(),c="[object Object]",g=Object.prototype,b=g.hasOwnProperty,I=g.toString;function a(G){var W;if(!(n(G)&&I.call(G)==c&&!t(G))||!b.call(G,"constructor")&&(W=G.constructor,typeof W=="function"&&!(W instanceof W)))return!1;var he;return e(G,function(ae,ue){he=ue}),he===void 0||b.call(G,he)}return Dy=a,Dy}(function(e){e.exports=function(t){var n={};function c(g){if(n[g])return n[g].exports;var b=n[g]={exports:{},id:g,loaded:!1};return t[g].call(b.exports,b,b.exports,c),b.loaded=!0,b.exports}return c.m=t,c.c=n,c.p="/lib/",c(0)}([function(t,n,c){t.exports=c(1)},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.union=c(2).default,n.any=c(12).default,n.nil=c(14).default,n.mapOf=c(16).default,n.arrayOf=c(18).default,n.record=c(20).default,n.optional=c(23).default,n.validate=c(25).default,n.deferred=c(26).default,n.createValidator=c(4).default,n.isValid=c(28).default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(3),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(){for(var G=arguments.length,W=Array(G),he=0;he<G;he++)W[he]=arguments[he];return new b.default(W)}},function(t,n,c){var g=function(){function he(ae,ue){for(var be=0;be<ue.length;be++){var Ke=ue[be];Ke.enumerable=Ke.enumerable||!1,Ke.configurable=!0,"value"in Ke&&(Ke.writable=!0),Object.defineProperty(ae,Ke.key,Ke)}}return function(ae,ue,be){return ue&&he(ae.prototype,ue),be&&he(ae,be),ae}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(4),I=a(b);c(5),c(6);function a(he){return he&&he.__esModule?he:{default:he}}function G(he,ae){if(!(he instanceof ae))throw new TypeError("Cannot call a class as a function")}var W=function(){function he(ae){G(this,he),this.validators=[];var ue=!0,be=!1,Ke=void 0;try{for(var ot=ae[Symbol.iterator](),tt;!(ue=(tt=ot.next()).done);ue=!0){var lt=tt.value;this.validators.push((0,I.default)(lt))}}catch(ut){be=!0,Ke=ut}finally{try{!ue&&ot.return&&ot.return()}finally{if(be)throw Ke}}}return g(he,[{key:"isValid",value:function(ue){var be=!0,Ke=!1,ot=void 0;try{for(var tt=this.validators[Symbol.iterator](),lt;!(be=(lt=tt.next()).done);be=!0){var ut=lt.value;if(ut.isValid(ue))return!0}}catch(Tt){Ke=!0,ot=Tt}finally{try{!be&&tt.return&&tt.return()}finally{if(Ke)throw ot}}return!1}},{key:"getValidationResult",value:function(ue){if(this.isValid(ue))return{isValid:"true"};var be=this._getValidationDetails(ue);return{isValid:"false",message:`Value doesn't match any of the expected variants.
Value: `+JSON.stringify(ue)+`
Details: 
`+be.message,score:be.score}}},{key:"_getValidationDetails",value:function(ue){var be=[],Ke=!0,ot=!1,tt=void 0;try{for(var lt=this.validators[Symbol.iterator](),ut;!(Ke=(ut=lt.next()).done);Ke=!0){var Tt=ut.value;be.push(Tt.getValidationResult(ue))}}catch(zt){ot=!0,tt=zt}finally{try{!Ke&&lt.return&&lt.return()}finally{if(ot)throw tt}}be.sort(function(zt,Ge){return zt.score<Ge.score?1:zt.score>Ge.score?-1:0}),be.length>3&&(be.length=3);var Pt=be.map(function(zt){return zt.message}).join(`
`);return{message:Pt,score:be[0].score}}}]),he}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=ot,c(5);var g=c(7),b=be(g),I=c(9),a=be(I),G=c(10),W=be(G),he=c(3);be(he);var ae=c(11),ue=be(ae);function be(tt){return tt&&tt.__esModule?tt:{default:tt}}function Ke(tt){return tt&&typeof Symbol<"u"&&tt.constructor===Symbol?"symbol":typeof tt}function ot(tt){if(tt==null)throw Error("Null cannot be a valid validation descriptor");if(tt===String)return b.default;if(tt===Number)return a.default;if(tt===Boolean)return W.default;if((typeof tt>"u"?"undefined":Ke(tt))==="object"&&tt&&typeof tt.isValid=="function"&&typeof tt.getValidationResult=="function")return tt;if(typeof tt=="string"||typeof tt=="number"||typeof tt=="boolean")return new ue.default(tt);throw new Error("Can't recognize this descriptor: "+tt)}},function(t,n,c){c(6)},function(t,n){},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=I(g);c(6),c(5);function I(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return typeof W=="string"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"String expected, "+(0,b.default)(W)+" given.",score:0}}};n.default=a},function(t,n){t.exports=oU()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=I(g);c(6),c(5);function I(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return typeof W=="number"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Number expected. '"+(0,b.default)(W)+"' given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=I(g);c(6),c(5);function I(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return typeof W=="boolean"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Boolean expected. "+(0,b.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){var g=function(){function W(he,ae){for(var ue=0;ue<ae.length;ue++){var be=ae[ue];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(he,be.key,be)}}return function(he,ae,ue){return ae&&W(he.prototype,ae),ue&&W(he,ue),he}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(4);I(b),c(5),c(6);function I(W){return W&&W.__esModule?W:{default:W}}function a(W,he){if(!(W instanceof he))throw new TypeError("Cannot call a class as a function")}var G=function(){function W(he){a(this,W),this.expectedValue=he}return g(W,[{key:"isValid",value:function(ae){return ae===this.expectedValue}},{key:"getValidationResult",value:function(ae){return this.isValid(ae)?{isValid:"true"}:{isValid:"false",message:"Expected: "+JSON.stringify(this.expectedValue)+". Given: "+ae,score:0}}}]),W}();n.default=G},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(13),b=I(g);function I(a){return a&&a.__esModule?a:{default:a}}n.default=b.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8);b(g),c(6),c(5);function b(a){return a&&a.__esModule?a:{default:a}}var I={isValid:function(G){return!0},getValidationResult:function(G){return{isValid:"true"}}};n.default=I},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(15),b=I(g);function I(a){return a&&a.__esModule?a:{default:a}}n.default=b.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=I(g);c(6),c(5);function I(G){return G&&G.__esModule?G:{default:G}}var a={isValid:function(W){return W==null},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Null expected. "+(0,b.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(17),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(G){return new b.default(G)}},function(t,n,c){var g=function(){function be(Ke,ot){for(var tt=0;tt<ot.length;tt++){var lt=ot[tt];lt.enumerable=lt.enumerable||!1,lt.configurable=!0,"value"in lt&&(lt.writable=!0),Object.defineProperty(Ke,lt.key,lt)}}return function(Ke,ot,tt){return ot&&be(Ke.prototype,ot),tt&&be(Ke,tt),Ke}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),I=W(b),a=c(4),G=W(a);c(6),c(5);function W(be){return be&&be.__esModule?be:{default:be}}function he(be,Ke){if(!(be instanceof Ke))throw new TypeError("Cannot call a class as a function")}function ae(be){return be&&typeof Symbol<"u"&&be.constructor===Symbol?"symbol":typeof be}var ue=function(){function be(Ke){he(this,be),this.validator=(0,G.default)(Ke)}return g(be,[{key:"isValid",value:function(ot){if(!((typeof ot>"u"?"undefined":ae(ot))==="object"&&ot))return!1;var tt=Object.keys(ot),lt=!0,ut=!1,Tt=void 0;try{for(var Pt=tt[Symbol.iterator](),zt;!(lt=(zt=Pt.next()).done);lt=!0){var Ge=zt.value,Xt=ot[Ge];if(this.validator.isValid(Xt)===!1)return!1}}catch(rt){ut=!0,Tt=rt}finally{try{!lt&&Pt.return&&Pt.return()}finally{if(ut)throw Tt}}return!0}},{key:"getValidationResult",value:function(ot){if(!((typeof ot>"u"?"undefined":ae(ot))==="object"&&ot))return{isValid:"false",message:"Object expected. "+(0,I.default)(ot)+" given.",score:0};var tt=Object.keys(ot),lt=!0,ut=!1,Tt=void 0;try{for(var Pt=tt[Symbol.iterator](),zt;!(lt=(zt=Pt.next()).done);lt=!0){var Ge=zt.value,Xt=ot[Ge],rt=this.validator.getValidationResult(Xt);if(rt.isValid==="false")return{isValid:"false",message:"Validation failed for key '"+Ge+"': "+rt.message,score:1}}}catch(yt){ut=!0,Tt=yt}finally{try{!lt&&Pt.return&&Pt.return()}finally{if(ut)throw Tt}}return{isValid:"true"}}}]),be}();n.default=ue},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(19),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(G){return new b.default(G)}},function(t,n,c){var g=function(){function ue(be,Ke){for(var ot=0;ot<Ke.length;ot++){var tt=Ke[ot];tt.enumerable=tt.enumerable||!1,tt.configurable=!0,"value"in tt&&(tt.writable=!0),Object.defineProperty(be,tt.key,tt)}}return function(be,Ke,ot){return Ke&&ue(be.prototype,Ke),ot&&ue(be,ot),be}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),I=W(b),a=c(4),G=W(a);c(6),c(5);function W(ue){return ue&&ue.__esModule?ue:{default:ue}}function he(ue,be){if(!(ue instanceof be))throw new TypeError("Cannot call a class as a function")}var ae=function(){function ue(be){he(this,ue),this.validator=(0,G.default)(be)}return g(ue,[{key:"isValid",value:function(Ke){if(!Array.isArray(Ke))return!1;var ot=!0,tt=!1,lt=void 0;try{for(var ut=Ke[Symbol.iterator](),Tt;!(ot=(Tt=ut.next()).done);ot=!0){var Pt=Tt.value;if(this.validator.isValid(Pt)===!1)return!1}}catch(zt){tt=!0,lt=zt}finally{try{!ot&&ut.return&&ut.return()}finally{if(tt)throw lt}}return!0}},{key:"getValidationResult",value:function(Ke){if(!Array.isArray(Ke))return{isValid:"false",message:"Array expected. "+(0,I.default)(Ke)+" given.",score:0};for(var ot=0;ot<Ke.length;ot++){var tt=Ke[ot],lt=this.validator.getValidationResult(tt);if(lt.isValid==="false")return{isValid:"false",message:"Validation failed on item #"+ot+": "+lt.message,score:1}}return{isValid:"true"}}}]),ue}();n.default=ae},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(21),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(G){return new b.default(G)}},function(t,n,c){var g=function(){function ot(tt,lt){for(var ut=0;ut<lt.length;ut++){var Tt=lt[ut];Tt.enumerable=Tt.enumerable||!1,Tt.configurable=!0,"value"in Tt&&(Tt.writable=!0),Object.defineProperty(tt,Tt.key,Tt)}}return function(tt,lt,ut){return lt&&ot(tt.prototype,lt),ut&&ot(tt,ut),tt}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),I=ae(b),a=c(22),G=ae(a),W=c(4),he=ae(W);c(5),c(6);function ae(ot){return ot&&ot.__esModule?ot:{default:ot}}function ue(ot,tt){if(!(ot instanceof tt))throw new TypeError("Cannot call a class as a function")}function be(ot){return ot&&typeof Symbol<"u"&&ot.constructor===Symbol?"symbol":typeof ot}var Ke=function(){function ot(tt){if(ue(this,ot),!((typeof tt>"u"?"undefined":be(tt))==="object"&&tt&&(0,G.default)(tt)))throw Error("A record must be defined by an object.");this.shape={};var lt=!0,ut=!1,Tt=void 0;try{for(var Pt=Object.getOwnPropertyNames(tt)[Symbol.iterator](),zt;!(lt=(zt=Pt.next()).done);lt=!0){var Ge=zt.value;try{this.shape[Ge]=(0,he.default)(tt[Ge])}catch(yt){var Xt=Ge,rt=yt.stack;throw yt.originalStack?(rt=yt.originalStack,Xt+="."+yt.propertyName,yt.propertyName=Xt):yt.originalStack=yt.stack,yt.stack="Error defining prop '"+Xt+"': "+yt.originalStack,yt}}}catch(yt){ut=!0,Tt=yt}finally{try{!lt&&Pt.return&&Pt.return()}finally{if(ut)throw Tt}}}return g(ot,[{key:"isValid",value:function(lt){if(!((typeof lt>"u"?"undefined":be(lt))==="object"&&lt))return!1;var ut=!0,Tt=!1,Pt=void 0;try{for(var zt=Object.keys(this.shape)[Symbol.iterator](),Ge;!(ut=(Ge=zt.next()).done);ut=!0){var Xt=Ge.value,rt=this.shape[Xt];if(rt.isValid(lt[Xt])===!1)return!1}}catch(yt){Tt=!0,Pt=yt}finally{try{!ut&&zt.return&&zt.return()}finally{if(Tt)throw Pt}}return!0}},{key:"getValidationResult",value:function(lt){if(!((typeof lt>"u"?"undefined":be(lt))==="object"&&lt))return{isValid:"false",message:"Object expected, "+(0,I.default)(lt)+" given.",score:0};var ut=0,Tt=!0,Pt=!1,zt=void 0;try{for(var Ge=Object.keys(this.shape)[Symbol.iterator](),Xt;!(Tt=(Xt=Ge.next()).done);Tt=!0){var rt=Xt.value,yt=this.shape[rt],pt=yt.getValidationResult(lt[rt]);if(pt.isValid==="false")return{isValid:"false",message:"Error validating prop "+rt+`:
 `+pt.message,score:1+ut};ut++}}catch(gt){Pt=!0,zt=gt}finally{try{!Tt&&Ge.return&&Ge.return()}finally{if(Pt)throw zt}}return{isValid:"true"}}}]),ot}();n.default=Ke},function(t,n){t.exports=xU()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(24),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(G){return new b.default(G)}},function(t,n,c){var g=function(){function he(ae,ue){for(var be=0;be<ue.length;be++){var Ke=ue[be];Ke.enumerable=Ke.enumerable||!1,Ke.configurable=!0,"value"in Ke&&(Ke.writable=!0),Object.defineProperty(ae,Ke.key,Ke)}}return function(ae,ue,be){return ue&&he(ae.prototype,ue),be&&he(ae,be),ae}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(4),I=a(b);c(6),c(5);function a(he){return he&&he.__esModule?he:{default:he}}function G(he,ae){if(!(he instanceof ae))throw new TypeError("Cannot call a class as a function")}var W=function(){function he(ae){G(this,he),this.validator=(0,I.default)(ae)}return g(he,[{key:"isValid",value:function(ue){return ue?this.validator.isValid(ue):!0}},{key:"getValidationResult",value:function(ue){return ue?this.validator.getValidationResult(ue):{isValid:"true"}}}]),he}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(G,W){var he=(0,b.default)(G),ae=he.getValidationResult(W);if(ae.isValid==="false")throw Error(ae.message);return W}},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(27),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(G){return new b.default(G)}},function(t,n,c){var g=function(){function ae(ue,be){for(var Ke=0;Ke<be.length;Ke++){var ot=be[Ke];ot.enumerable=ot.enumerable||!1,ot.configurable=!0,"value"in ot&&(ot.writable=!0),Object.defineProperty(ue,ot.key,ot)}}return function(ue,be,Ke){return be&&ae(ue.prototype,be),Ke&&ae(ue,Ke),ue}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),I=G(b),a=c(4);G(a),c(6),c(5);function G(ae){return ae&&ae.__esModule?ae:{default:ae}}function W(ae,ue){if(!(ae instanceof ue))throw new TypeError("Cannot call a class as a function")}var he=function(){function ae(ue){if(W(this,ae),typeof ue!="function")throw Error("Deferred validator only accepts a function. "+(0,I.default)(ue)+" given");this.deferredValidator=ue}return g(ae,[{key:"isValid",value:function(be){return this._getValidator().isValid(be)}},{key:"getValidationResult",value:function(be){return this._getValidator().getValidationResult(be)}},{key:"_getValidator",value:function(){return this.validator||(this.validator=this.deferredValidator()),this.validator}}]),ae}();n.default=he},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),b=I(g);function I(G){return G&&G.__esModule?G:{default:G}}function a(G,W){var he=(0,b.default)(G);return he.isValid(W)}}])})(sU);async function bU(e,t){var W;let n={pd:Number.MIN_VALUE,mpd:Number.MIN_VALUE,mntd:Number.MIN_VALUE,tree_sizes:Number.MIN_VALUE,rel_pd:1,rel_mpd:Number.MIN_VALUE,rel_mntd:Number.MIN_VALUE},c={pd:Number.MAX_VALUE,mpd:Number.MAX_VALUE,mntd:Number.MAX_VALUE,tree_sizes:Number.MAX_VALUE,rel_pd:0,rel_mpd:Number.MAX_VALUE,rel_mntd:Number.MAX_VALUE},g=await fetch("/phast/data/range_hex_data_statistics.json").then(he=>he.json()),b=await fetch("/phast/data/Plants_trees.json").then(he=>he.json());b=wU(b),console.log(g);let I=e.geometry.coordinates,a=[];for(let he of I){let ae={type:"Feature",properties:{pd:-1,mpd:-1,mntd:-1,tree_sizes:0,rel_pd:-1,rel_mpd:-1,rel_mntd:-1,tree:null},geometry:{type:"Polygon",coordinates:he}},ue=I5.featureToH3Set(ae,t)[0];if(!ue||!g[ue])break;ae.properties.id=ue;for(let be of Object.keys(g[ue])){let Ke=g[ue][be][0];ae.properties[be]=Ke,Ke>n[be]?n[be]=Ke:Ke<c[be]&&(c[be]=Ke)}ae.properties.tree=b[ue][0]??"",ae.properties.pd||(ae.properties.pd=-1),ae.properties.mpd||(ae.properties.mpd=-1),ae.properties.mntd||(ae.properties.mntd=-1),ae.properties.tree_sizes=((W=g[ue].present_species_rds)==null?void 0:W.length)??0,ae.properties.quartile=Number.parseFloat(g[ue].quartile??-1),a.push(ae)}return{type:"FeatureCollection",features:a,properties:{maxes:n,mins:c,rel_pd_exp:0}}}function wU(e){return console.log(e),JSON.parse(e[0])}function SU(e){let t,n,c,g=`<svg class="marker-svg" id="Layer_2" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70.46 62.88"><defs><style>.fill {
                fill: #000;
                stroke: solid 1px red;
            }
            .stroke {
                stroke: #fff;
            }
        </style></defs><g id="Layer_1-2" data-name="Layer 1"><g><path class="fill" d="m35.23,60.88c-1.81,0-3.43-.93-4.33-2.5L2.68,9.5c-.9-1.57-.9-3.44,0-5,.9-1.57,2.52-2.5,4.33-2.5h56.44c1.81,0,3.43.93,4.33,2.5.9,1.56.9,3.43,0,5l-28.22,48.88c-.9,1.57-2.52,2.5-4.33,2.5Z"></path><path d="m63.45,4c1.56,0,2.34,1.05,2.6,1.5.26.45.78,1.65,0,3l-28.22,48.88c-.78,1.35-2.08,1.5-2.6,1.5s-1.82-.15-2.6-1.5L4.41,8.5c-.78-1.35-.26-2.55,0-3,.26-.45,1.03-1.5,2.6-1.5h56.44m0-4H7.01C1.62,0-1.75,5.83.95,10.5l28.22,48.88c1.35,2.33,3.7,3.5,6.06,3.5s4.72-1.17,6.06-3.5l28.22-48.88c2.69-4.67-.67-10.5-6.06-10.5h0Z"></path></g></g></svg>`;return{c(){t=Nn("div"),n=Cr(),c=Nn("div"),c.innerHTML=g,this.h()},l(b){t=Vn(b,"DIV",{id:!0,class:!0}),bn(t).forEach(bi),n=Tr(b),c=Vn(b,"DIV",{id:!0,class:!0,style:!0,"data-svelte-h":!0}),dc(c)!=="svelte-1sgleu8"&&(c.innerHTML=g),this.h()},h(){Pi(t,"id","map"),Pi(t,"class","map"),Pi(c,"id","marker-template"),Pi(c,"class","hex-marker"),Ly(c,"display","none")},m(b,I){Gn(b,t,I),Gn(b,n,I),Gn(b,c,I)},p:wo,i:wo,o:wo,d(b){b&&(bi(t),bi(n),bi(c))}}}let r3=6;const IU=500;let EU=!1;function CU(e,t,n){let c,g,b,I,a;Vc(e,Kp,ai=>n(13,c=ai)),Vc(e,oT,ai=>n(24,g=ai)),Vc(e,Ry,ai=>n(14,b=ai)),Vc(e,Jg,ai=>n(25,I=ai)),Vc(e,Y_,ai=>n(15,a=ai));const G=[-119.449444,37.166111];let{metric:W}=t,{colorScheme:he}=t,{selectionData:ae}=t,{showCounties:ue}=t,{showEcoregions:be}=t,{drawnPath:Ke}=t,{clade:ot}=t,{clades:tt}=t,{finishBuilding:lt}=t;const ut=[-124.40971816218747,32.534154544948464,-114.13120909272375,42.009518182466415];let Tt,Pt,zt,Ge=[-119.449444,37.166111];function Xt(ai){if(!c.getStyle)return;console.log(c.getStyle().layers);let Ki=c.getStyle().layers.filter(Ji=>{var pn;let fi=(pn=Ji.source)==null?void 0:pn.split("-");return fi&&fi[0]==="hexlayer"&&fi[1]!==ai});for(let Ji of Ki)c.setPaintProperty(Ji.id,"fill-opacity",0)}async function rt(ai){if(!st||!c.getLayer)return;if(ai===null){c.getLayer("drawLayer")&&c.removeLayer("drawnPolygon"),c.getSource("drawnPolygon")&&c.removeSource("drawnPolygon");return}console.log(c.transform),console.log(ai[0]),console.log(c.transform.pointLocation({x:10,y:10})),console.log(c.transform.pointLocation(ai[0]));let Ki=[];for(let Rr of ai){let hi=c.transform.pointLocation(Rr);Ki.push([hi.lat,hi.lng])}let Ji=RV(Ki,r3),fi=I5.h3SetToMultiPolygonFeature(Ji);console.log(fi),console.log(st);let pn=UV(st);console.log(pn),console.log(fi.geometry),console.log(pn.features[0].geometry);let ii=rU(fi.geometry.coordinates,pn.features[0].geometry.coordinates);console.log(ii);let wn={type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:ii}};c.addSource("drawnPolygon",{type:"geojson",data:wn}),c.addLayer({id:"drawLayer",type:"fill",source:"drawnPolygon",layout:{},paint:{"fill-color":"#00ffff","fill-opacity":b,"fill-color-transition":{duration:500,delay:0}}},Pt)}function yt(ai,Ki){if(console.log(ai),!c.moveLayer)return;let Ji=`hex-${ai}-${Ki}`;console.log(ai),c.moveLayer(Ji,"place_hamlet"),setTimeout(()=>{pt([Ji])},IU/4),c.setPaintProperty(Ji,"fill-opacity",b)}function pt(ai=[]){if(!c.getStyle)return;let Ki=c.getStyle().layers.filter(Ji=>{var fi;return((fi=Ji.source)==null?void 0:fi.includes("hexlayer"))&&!ai.includes(Ji.id)});for(let Ji of Ki)c.setPaintProperty(Ji.id,"fill-opacity",0)}function gt(ai){if(!c.getStyle)return;let Ki=c.getStyle().layers.filter(Ji=>Ji.source===`hexlayer-${ot}`);for(let Ji of Ki){let fi=Ji.id.split("-")[1],pn=_i(fi,ai,!0);console.log("palette:",pn),c.setPaintProperty(Ji.id,"fill-color",pn)}}function bt(ai){c.setPaintProperty&&(ai?c.setPaintProperty("counties","line-opacity",g):c.setPaintProperty("counties","line-opacity",0))}function dt(ai){c.setPaintProperty&&(console.log("ecoregions",ai),ai?(c.setPaintProperty("ecoregions-line","line-opacity",g),c.setPaintProperty("ecoregions-fill","fill-opacity",b)):(c.setPaintProperty("ecoregions-line","line-opacity",0),c.setPaintProperty("ecoregions-fill","fill-opacity",0)))}function $e(ai){ai?(c.setPaintProperty("california-line","line-opacity",g),c.setPaintProperty("california-fill","fill-opacity",b)):(c.setPaintProperty("california-line","line-opacity",0),c.setPaintProperty("california-fill","fill-opacity",0))}let mt,st,Nt,Rt,Ot=m_(0,5e3,he);function _i(ai,Ki,Ji=!0){if(!(!Nt||!Rt))if(console.log("generating for ",ai),Ji){Ot=m_(Rt[ai],Nt[ai],Ki),ai==="quartile"&&(Ot=rT(Ki)),console.log(Ot),Ot.length;let fi=Ot.map((ii,wn)=>[ii[0],ii[1]]);fi=fi.flat(),console.log(fi);let pn=["interpolate",["linear"],["get",ai],...fi];return I||Jg.set(pn),pn}else return["step",["get",ai],"#ccc",0,"#fc4e2a",600,"#00E676",1300,"#2a4e9b"]}let{update:Si}=t;async function Ti(ai,Ki){var Ji;if(console.log(ai),!(c&&((Ji=c==null?void 0:c.getStyle())!=null&&Ji.sources[`hexlayer-${ai}`])))return fetch(`/phast/${ai}_hex_new.json`).then(fi=>fi.json()).then(fi=>st=fi).then(()=>{var wn,Rr,hi;Nt=(wn=st.properties)==null?void 0:wn.maxes,Rt=(Rr=st.properties)==null?void 0:Rr.mins,(hi=st.properties)!=null&&hi.rel_pd_exp&&st.properties.rel_pd_exp;let pn=c.getStyle().layers[71].id;c.getSource(`hexlayer-${ai}`)||c.addSource(`hexlayer-${ai}`,{type:"geojson",data:st});for(let en of g_){let tr=`hex-${en}-${ai}`;c.addLayer({id:tr,type:"fill",source:`hexlayer-${ai}`,layout:{},paint:{"fill-color":_i(en,he,!0),"fill-opacity":b,"fill-color-transition":{duration:500,delay:0}}},pn),console.log("added layer ",tr)}let ii=`hex-${g_[0]}-${ai}`;return c.on("click",ii,en=>{console.log(en);let tr=zV(en.lngLat.lat,en.lngLat.lng,Ki);if(yn(tr),tr===(ae==null?void 0:ae.hex)){Si(null);return}console.log(c.getStyle().layers);let Fn=Pw(tr);Ge={lng:Fn[1],lat:Fn[0]},console.log(tr),Si({latlng:en.lngLat,hex:tr,properties:en.features[0].properties})}),c.on("mouseenter",ii,()=>{c.getCanvas().style.cursor="pointer"}),c.on("mouseleave",ii,()=>{c.getCanvas().style.cursor=""}),c.on("dragstart",ii,()=>{c.getCanvas().style.cursor="grabbing"}),c.on("dragend",ii,()=>{c.getCanvas().style.cursor="pointer"}),!0})}async function Oi(){fetch("/phast/data/ecoregions.geojson").then(ai=>ai.json()).then(ai=>{console.log(ai),c.addSource("ecoregions",{type:"geojson",data:ai,generateId:!0}),c.addLayer({id:"ecoregions-fill",type:"fill",source:"ecoregions",layout:{},paint:{"fill-opacity":0,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"ecoregions-line",type:"line",source:"ecoregions",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":0}}),console.log("added ecoregions")})}async function tn(){Kp&&fetch("/phast/data/california.geojson").then(ai=>ai.json()).then(ai=>{console.log(ai),c.addSource("california",{type:"geojson",data:ai,generateId:!0}),c.addLayer({id:"california-fill",type:"fill",source:"california",layout:{},paint:{"fill-opacity":b,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"california-line",type:"line",source:"california",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":g}})})}async function qi(){return fetch("/phast/CA_hexbinned@6.json").then(ai=>ai.json()).then(ai=>{console.log(ai),bU(ai,6).then(Ki=>console.log(Ki))})}function Ni(ai){if(!ai)return;console.log("started building");let Ki=Date.now();Ti("Birds",r3).then(()=>{lt(),yt(W,ot),console.log(`finished building in ${Date.now()-Ki}ms`)}),dt(!1),$e(!1)}vc(()=>{om(Kp,c=new gx.Map({container:"map",style:`https://basemaps.cartocdn.com/gl/${Ri}-gl-style/style.json`,center:G,zoom:4}),c),c.on("load",()=>{Oi(),tn(),console.log("loaded"),nn()}),qi(),setTimeout(()=>{console.log("no load on timeout"),om(Kp,c._canvas.style.filter="none",c),nn()},3e3)});async function nn(){let ai=ut;mt=window.innerWidth/3,c.fitBounds(ai,{padding:{top:50,left:10,bottom:50,right:mt}}),om(Kp,c._canvas.style.filter="none",c)}function yn(ai){zt||Ci();let Ki=Pw(ai);console.log(Ki),mt=2*window.innerWidth/5,gi([Ki[1],Ki[0]]),c.flyTo({center:[Ki[1],Ki[0]],essential:!0,padding:{right:mt},duration:750})}function Ci(){let ai=document.getElementById("marker-template");ai.style.display="block",zt=new gx.Marker({element:ai}).setLngLat(Ge).addTo(c)}function gi(ai){zt.setLngLat(ai)}let Ri="positron";return e.$$set=ai=>{"metric"in ai&&n(0,W=ai.metric),"colorScheme"in ai&&n(1,he=ai.colorScheme),"selectionData"in ai&&n(2,ae=ai.selectionData),"showCounties"in ai&&n(3,ue=ai.showCounties),"showEcoregions"in ai&&n(4,be=ai.showEcoregions),"drawnPath"in ai&&n(5,Ke=ai.drawnPath),"clade"in ai&&n(6,ot=ai.clade),"clades"in ai&&n(7,tt=ai.clades),"finishBuilding"in ai&&n(8,lt=ai.finishBuilding),"update"in ai&&n(11,Si=ai.update)},e.$$.update=()=>{e.$$.dirty[0]&12288&&c&&EU&&(n(12,Tt=c.getStyle().layers.filter(ai=>ai["source-layer"]==="place")),console.log(Tt)),e.$$.dirty[0]&65&&yt(W,ot),e.$$.dirty[0]&16449&&b&&yt(W,ot),e.$$.dirty[0]&2&&gt(he),e.$$.dirty[0]&3&&Jg.set(_i(W,he,!0)),e.$$.dirty[0]&8&&bt(ue),e.$$.dirty[0]&16&&dt(be),e.$$.dirty[0]&32&&rt(Ke),e.$$.dirty[0]&64&&Xt(ot),e.$$.dirty[0]&32768&&Ni(a)},[W,he,ae,ue,be,Ke,ot,tt,lt,dt,$e,Si,Tt,c,b,a]}let TU=class extends Lo{constructor(t){super(),Bo(this,t,CU,SU,ho,{metric:0,colorScheme:1,selectionData:2,showCounties:3,showEcoregions:4,drawnPath:5,clade:6,clades:7,finishBuilding:8,updateShowEcoregions:9,updateShowCalifornia:10,update:11},null,[-1,-1])}get updateShowEcoregions(){return this.$$.ctx[9]}get updateShowCalifornia(){return this.$$.ctx[10]}};function s3(e){let t,n,c,g,b;return n=new hT({props:{updateColorScheme:e[12],updateShowCounties:e[13],updateShowEcoregions:e[14],updateDrawing:e[15],drawing:e[6],updateDrawnPath:e[16]}}),g=new wT({props:{colorScheme:e[3],metric:e[2]}}),{c(){t=Nn("div"),gs(n.$$.fragment),c=Cr(),gs(g.$$.fragment),this.h()},l(I){t=Vn(I,"DIV",{class:!0});var a=bn(t);Xs(n.$$.fragment,a),c=Tr(a),Xs(g.$$.fragment,a),a.forEach(bi),this.h()},h(){Pi(t,"class","control-container svelte-1q0na86")},m(I,a){Gn(I,t,a),_s(n,t,null),Zi(t,c),_s(g,t,null),b=!0},p(I,a){const G={};a&64&&(G.drawing=I[6]),n.$set(G);const W={};a&8&&(W.colorScheme=I[3]),a&4&&(W.metric=I[2]),g.$set(W)},i(I){b||($i(n.$$.fragment,I),$i(g.$$.fragment,I),b=!0)},o(I){dn(n.$$.fragment,I),dn(g.$$.fragment,I),b=!1},d(I){I&&bi(t),ys(n),ys(g)}}}function a3(e){let t,n;return t=new _T({props:{updatePath:e[16],updateIsDrawing:e[15],isDrawing:e[6]}}),{c(){gs(t.$$.fragment)},l(c){Xs(t.$$.fragment,c)},m(c,g){_s(t,c,g),n=!0},p(c,g){const b={};g&64&&(b.isDrawing=c[6]),t.$set(b)},i(c){n||($i(t.$$.fragment,c),n=!0)},o(c){dn(t.$$.fragment,c),n=!1},d(c){ys(t,c)}}}function kU(e){let t,n,c,g,b,I,a,G;n=new TU({props:{finishBuilding:e[19],update:e[10],metric:e[2],colorScheme:e[3],selectionData:e[1],showCounties:e[4],showEcoregions:e[5],drawnPath:e[7],clade:e[8],clades:e[18]}}),g=new yO({props:{isBuilt:MU,isFinishedBuilding:e[9],updateMetricLayer:e[11],showEcoregions:e[14],colorScheme:e[3],selectionData:e[1],metric:e[2],updateData:e[10],clade:e[8],clades:e[18],updateClade:e[17]}});let W=e[0]&&s3(e),he=e[6]&&a3(e);return{c(){t=Nn("main"),gs(n.$$.fragment),c=Cr(),gs(g.$$.fragment),b=Cr(),W&&W.c(),I=Cr(),he&&he.c(),a=Ds(),this.h()},l(ae){t=Vn(ae,"MAIN",{class:!0});var ue=bn(t);Xs(n.$$.fragment,ue),c=Tr(ue),Xs(g.$$.fragment,ue),ue.forEach(bi),b=Tr(ae),W&&W.l(ae),I=Tr(ae),he&&he.l(ae),a=Ds(),this.h()},h(){Pi(t,"class","svelte-1q0na86")},m(ae,ue){Gn(ae,t,ue),_s(n,t,null),Zi(t,c),_s(g,t,null),Gn(ae,b,ue),W&&W.m(ae,ue),Gn(ae,I,ue),he&&he.m(ae,ue),Gn(ae,a,ue),G=!0},p(ae,[ue]){const be={};ue&4&&(be.metric=ae[2]),ue&8&&(be.colorScheme=ae[3]),ue&2&&(be.selectionData=ae[1]),ue&16&&(be.showCounties=ae[4]),ue&32&&(be.showEcoregions=ae[5]),ue&128&&(be.drawnPath=ae[7]),ue&256&&(be.clade=ae[8]),n.$set(be);const Ke={};ue&512&&(Ke.isFinishedBuilding=ae[9]),ue&8&&(Ke.colorScheme=ae[3]),ue&2&&(Ke.selectionData=ae[1]),ue&4&&(Ke.metric=ae[2]),ue&256&&(Ke.clade=ae[8]),g.$set(Ke),ae[0]?W?(W.p(ae,ue),ue&1&&$i(W,1)):(W=s3(ae),W.c(),$i(W,1),W.m(I.parentNode,I)):W&&(Ho(),dn(W,1,1,()=>{W=null}),jo()),ae[6]?he?(he.p(ae,ue),ue&64&&$i(he,1)):(he=a3(ae),he.c(),$i(he,1),he.m(a.parentNode,a)):he&&(Ho(),dn(he,1,1,()=>{he=null}),jo())},i(ae){G||($i(n.$$.fragment,ae),$i(g.$$.fragment,ae),$i(W),$i(he),G=!0)},o(ae){dn(n.$$.fragment,ae),dn(g.$$.fragment,ae),dn(W),dn(he),G=!1},d(ae){ae&&(bi(t),bi(b),bi(I),bi(a)),ys(n),ys(g),W&&W.d(ae),he&&he.d(ae)}}}let MU=!1;function PU(e,t,n){let c;Vc(e,Y_,Xt=>n(0,c=Xt));let g=null;function b(Xt){Xt&&(console.log("updating!!"),n(1,g=Xt))}let I="pd";function a(Xt){n(2,I=Xt)}let G="*ibm";function W(Xt){n(3,G=Xt)}let he=!1;function ae(Xt){n(4,he=Xt)}let ue=!1;function be(Xt){n(5,ue=Xt)}let Ke=!1;function ot(Xt){n(6,Ke=Xt)}let tt=null;function lt(Xt){n(7,tt=Xt)}let ut="Birds";function Tt(Xt){n(8,ut=Xt)}const Pt=["Birds","Plants"];let zt=!1;function Ge(){n(9,zt=!0)}return e.$$.update=()=>{e.$$.dirty&1&&console.log(c)},[c,g,I,G,he,ue,Ke,tt,ut,zt,b,a,W,ae,be,ot,lt,Tt,Pt,Ge]}class NU extends Lo{constructor(t){super(),Bo(this,t,PU,kU,ho,{})}}export{NU as component};
