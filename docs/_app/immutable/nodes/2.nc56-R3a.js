var jI=Object.defineProperty;var ZI=(e,t,n)=>t in e?jI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Er=(e,t,n)=>(ZI(e,typeof t!="symbol"?t+"":t,n),n);import{y as Eu,s as co,c as nu,z as gr,A as xo,j as Iu,u as ru,g as su,a as au,r as Oh,B as uo,C as vc,D as fu,o as Zc,E as bm,F as tc,e as pa,G as O0,n as lo,H as QI,b as hm,I as sm,J as R2,l as WI,K as ep}from"../chunks/scheduler.I9_GjKIr.js";import{S as Lo,i as Bo,s as Or,e as qn,h as Nr,c as Hn,d as Tn,g as Ci,y as nl,j as Zn,z as Gl,t as Ki,a as gn,A as N0,u as Is,v as $s,w as Es,x as Cs,r as JA,m as gs,q as fl,n as dl,B as Ba,C as za,D as A_,E as f_,o as Fi,k as Qi,b as Po,f as Do,l as ju,F as XI,G as ec,H as F2,I as U0,J as YI,K as $I,L as Kp,p as O2}from"../chunks/index.uFRP6icT.js";import{w as Py}from"../chunks/index.OKv3WG0v.js";const KI=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function _c(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ma(e,t){const n={},c={},g={$$scope:1};let b=e.length;for(;b--;){const E=e[b],a=t[b];if(a){for(const U in E)U in a||(c[U]=1);for(const U in a)g[U]||(n[U]=a[U],g[U]=1);e[b]=a}else for(const U in E)g[U]=1}for(const E in c)E in n||(n[E]=void 0);return n}function Fs(e){return typeof e=="object"&&e!==null?e:{}}var Dy=function(e,t){return Dy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,c){n.__proto__=c}||function(n,c){for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(n[g]=c[g])},Dy(e,t)};function r0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Dy(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var iu=function(){return iu=Object.assign||function(t){for(var n,c=1,g=arguments.length;c<g;c++){n=arguments[c];for(var b in n)Object.prototype.hasOwnProperty.call(n,b)&&(t[b]=n[b])}return t},iu.apply(this,arguments)};function tg(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],c=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&c>=e.length&&(e=void 0),{value:e&&e[c++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function N2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var c=n.call(e),g,b=[],E;try{for(;(t===void 0||t-- >0)&&!(g=c.next()).done;)b.push(g.value)}catch(a){E={error:a}}finally{try{g&&!g.done&&(n=c.return)&&n.call(c)}finally{if(E)throw E.error}}return b}function JI(e,t,n){if(n||arguments.length===2)for(var c=0,g=t.length,b;c<g;c++)(b||!(c in t))&&(b||(b=Array.prototype.slice.call(t,0,c)),b[c]=t[c]);return e.concat(b||Array.prototype.slice.call(t))}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var s0=function(){function e(t){t===void 0&&(t={}),this.adapter=t}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function eE(e,t){if(e.closest)return e.closest(t);for(var n=e;n;){if(i3(n,t))return n;n=n.parentElement}return null}function i3(e,t){var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return n.call(e,t)}function tE(e){var t=e;if(t.offsetParent!==null)return t.scrollWidth;var n=t.cloneNode(!0);n.style.setProperty("position","absolute"),n.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(n);var c=n.scrollWidth;return document.documentElement.removeChild(n),c}const kv=Object.freeze(Object.defineProperty({__proto__:null,closest:eE,estimateScrollWidth:tE,matches:i3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var iE={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var nE=function(e){r0(t,e);function t(n){var c=e.call(this,iu(iu({},t.defaultAdapter),n))||this;return c.shakeAnimationEndHandler=function(){c.handleShakeAnimationEnd()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return iE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},t.prototype.getWidth=function(){return this.adapter.getWidth()},t.prototype.shake=function(n){var c=t.cssClasses.LABEL_SHAKE;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.float=function(n){var c=t.cssClasses,g=c.LABEL_FLOAT_ABOVE,b=c.LABEL_SHAKE;n?this.adapter.addClass(g):(this.adapter.removeClass(g),this.adapter.removeClass(b))},t.prototype.setRequired=function(n){var c=t.cssClasses.LABEL_REQUIRED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleShakeAnimationEnd=function(){var n=t.cssClasses.LABEL_SHAKE;this.adapter.removeClass(n)},t}(s0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Vd={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var rE=function(e){r0(t,e);function t(n){var c=e.call(this,iu(iu({},t.defaultAdapter),n))||this;return c.transitionEndHandler=function(g){c.handleTransitionEnd(g)},c}return Object.defineProperty(t,"cssClasses",{get:function(){return Vd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},t.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},t.prototype.activate=function(){this.adapter.removeClass(Vd.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(Vd.LINE_RIPPLE_ACTIVE)},t.prototype.setRippleCenter=function(n){this.adapter.setStyle("transform-origin",n+"px center")},t.prototype.deactivate=function(){this.adapter.addClass(Vd.LINE_RIPPLE_DEACTIVATING)},t.prototype.handleTransitionEnd=function(n){var c=this.adapter.hasClass(Vd.LINE_RIPPLE_DEACTIVATING);n.propertyName==="opacity"&&c&&(this.adapter.removeClass(Vd.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(Vd.LINE_RIPPLE_DEACTIVATING))},t}(s0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var sE={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},aE={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},Hm={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30},eu;(function(e){e[e.BOTTOM=1]="BOTTOM",e[e.CENTER=2]="CENTER",e[e.RIGHT=4]="RIGHT",e[e.FLIP_RTL=8]="FLIP_RTL"})(eu||(eu={}));var Wd;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=4]="TOP_RIGHT",e[e.BOTTOM_LEFT=1]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",e[e.TOP_START=8]="TOP_START",e[e.TOP_END=12]="TOP_END",e[e.BOTTOM_START=9]="BOTTOM_START",e[e.BOTTOM_END=13]="BOTTOM_END"})(Wd||(Wd={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var L0,Hf,la={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};L0={},L0[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",L0[""+la.LIST_ITEM_CLASS]="mdc-list-item",L0[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",L0[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",L0[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",L0[""+la.ROOT]="mdc-list";var jp=(Hf={},Hf[""+la.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",Hf[""+la.LIST_ITEM_CLASS]="mdc-deprecated-list-item",Hf[""+la.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",Hf[""+la.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",Hf[""+la.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",Hf[""+la.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",Hf[""+la.ROOT]="mdc-deprecated-list",Hf),B0={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+jp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+jp[la.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+la.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` a,
    .`+la.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+la.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+jp[la.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+jp[la.LIST_ITEM_CLASS]+` a,
    .`+jp[la.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+jp[la.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},Jl={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Os={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},xc=new Set;xc.add(Os.BACKSPACE);xc.add(Os.ENTER);xc.add(Os.SPACEBAR);xc.add(Os.PAGE_UP);xc.add(Os.PAGE_DOWN);xc.add(Os.END);xc.add(Os.HOME);xc.add(Os.ARROW_LEFT);xc.add(Os.ARROW_UP);xc.add(Os.ARROW_RIGHT);xc.add(Os.ARROW_DOWN);xc.add(Os.DELETE);xc.add(Os.ESCAPE);xc.add(Os.TAB);var Qc={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},bc=new Map;bc.set(Qc.BACKSPACE,Os.BACKSPACE);bc.set(Qc.ENTER,Os.ENTER);bc.set(Qc.SPACEBAR,Os.SPACEBAR);bc.set(Qc.PAGE_UP,Os.PAGE_UP);bc.set(Qc.PAGE_DOWN,Os.PAGE_DOWN);bc.set(Qc.END,Os.END);bc.set(Qc.HOME,Os.HOME);bc.set(Qc.ARROW_LEFT,Os.ARROW_LEFT);bc.set(Qc.ARROW_UP,Os.ARROW_UP);bc.set(Qc.ARROW_RIGHT,Os.ARROW_RIGHT);bc.set(Qc.ARROW_DOWN,Os.ARROW_DOWN);bc.set(Qc.DELETE,Os.DELETE);bc.set(Qc.ESCAPE,Os.ESCAPE);bc.set(Qc.TAB,Os.TAB);var G0=new Set;G0.add(Os.PAGE_UP);G0.add(Os.PAGE_DOWN);G0.add(Os.END);G0.add(Os.HOME);G0.add(Os.ARROW_LEFT);G0.add(Os.ARROW_UP);G0.add(Os.ARROW_RIGHT);G0.add(Os.ARROW_DOWN);function Au(e){var t=e.key;if(xc.has(t))return t;var n=bc.get(e.keyCode);return n||Os.UNKNOWN}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var oE=["input","button","textarea","select"],zh=function(e){var t=e.target;if(t){var n=(""+t.tagName).toLowerCase();oE.indexOf(n)===-1&&e.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function lE(){var e={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return e}function uE(e,t){for(var n=new Map,c=0;c<e;c++){var g=t(c).trim();if(g){var b=g[0].toLowerCase();n.has(b)||n.set(b,[]),n.get(b).push({text:g.toLowerCase(),index:c})}}return n.forEach(function(E){E.sort(function(a,U){return a.index-U.index})}),n}function Ly(e,t){var n=e.nextChar,c=e.focusItemAtIndex,g=e.sortedIndexByFirstChar,b=e.focusedItemIndex,E=e.skipFocus,a=e.isItemAtIndexDisabled;clearTimeout(t.bufferClearTimeout),t.bufferClearTimeout=setTimeout(function(){r3(t)},Jl.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),t.typeaheadBuffer=t.typeaheadBuffer+n;var U;return t.typeaheadBuffer.length===1?U=cE(g,b,a,t):U=hE(g,a,t),U!==-1&&!E&&c(U),U}function cE(e,t,n,c){var g=c.typeaheadBuffer[0],b=e.get(g);if(!b)return-1;if(g===c.currentFirstChar&&b[c.sortedIndexCursor].index===t){c.sortedIndexCursor=(c.sortedIndexCursor+1)%b.length;var E=b[c.sortedIndexCursor].index;if(!n(E))return E}c.currentFirstChar=g;var a=-1,U;for(U=0;U<b.length;U++)if(!n(b[U].index)){a=U;break}for(;U<b.length;U++)if(b[U].index>t&&!n(b[U].index)){a=U;break}return a!==-1?(c.sortedIndexCursor=a,b[c.sortedIndexCursor].index):-1}function hE(e,t,n){var c=n.typeaheadBuffer[0],g=e.get(c);if(!g)return-1;var b=g[n.sortedIndexCursor];if(b.text.lastIndexOf(n.typeaheadBuffer,0)===0&&!t(b.index))return b.index;for(var E=(n.sortedIndexCursor+1)%g.length,a=-1;E!==n.sortedIndexCursor;){var U=g[E],W=U.text.lastIndexOf(n.typeaheadBuffer,0)===0,ce=!t(U.index);if(W&&ce){a=E;break}E=(E+1)%g.length}return a!==-1?(n.sortedIndexCursor=a,g[n.sortedIndexCursor].index):-1}function n3(e){return e.typeaheadBuffer.length>0}function r3(e){e.typeaheadBuffer=""}function V2(e,t){var n=e.event,c=e.isTargetListItem,g=e.focusedItemIndex,b=e.focusItemAtIndex,E=e.sortedIndexByFirstChar,a=e.isItemAtIndexDisabled,U=Au(n)==="ArrowLeft",W=Au(n)==="ArrowUp",ce=Au(n)==="ArrowRight",oe=Au(n)==="ArrowDown",fe=Au(n)==="Home",we=Au(n)==="End",et=Au(n)==="Enter",lt=Au(n)==="Spacebar";if(n.altKey||n.ctrlKey||n.metaKey||U||W||ce||oe||fe||we||et)return-1;var Ke=!lt&&n.key.length===1;if(Ke){zh(n);var st={focusItemAtIndex:b,focusedItemIndex:g,nextChar:n.key.toLowerCase(),sortedIndexByFirstChar:E,skipFocus:!1,isItemAtIndexDisabled:a};return Ly(st,t)}if(!lt)return-1;c&&zh(n);var ut=c&&n3(t);if(ut){var st={focusItemAtIndex:b,focusedItemIndex:g,nextChar:" ",sortedIndexByFirstChar:E,skipFocus:!1,isItemAtIndexDisabled:a};return Ly(st,t)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function AE(e){return e instanceof Array}var fE=["Alt","Control","Meta","Shift"];function U2(e){var t=new Set(e?fE.filter(function(n){return e.getModifierState(n)}):[]);return function(n){return n.every(function(c){return t.has(c)})&&n.length===t.size}}var dE=function(e){r0(t,e);function t(n){var c=e.call(this,iu(iu({},t.defaultAdapter),n))||this;return c.wrapFocus=!1,c.isVertical=!0,c.isSingleSelectionList=!1,c.areDisabledItemsFocusable=!0,c.selectedIndex=Jl.UNSET_INDEX,c.focusedItemIndex=Jl.UNSET_INDEX,c.useActivatedClass=!1,c.useSelectedAttr=!1,c.ariaCurrentAttrValue=null,c.isCheckboxList=!1,c.isRadioList=!1,c.lastSelectedIndex=null,c.hasTypeahead=!1,c.typeaheadState=lE(),c.sortedIndexByFirstChar=new Map,c}return Object.defineProperty(t,"strings",{get:function(){return B0},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return la},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Jl},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),t.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},t.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},t.prototype.setWrapFocus=function(n){this.wrapFocus=n},t.prototype.setVerticalOrientation=function(n){this.isVertical=n},t.prototype.setSingleSelection=function(n){this.isSingleSelectionList=n,n&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},t.prototype.setDisabledItemsFocusable=function(n){this.areDisabledItemsFocusable=n},t.prototype.maybeInitializeSingleSelection=function(){var n=this.getSelectedIndexFromDOM();if(n!==Jl.UNSET_INDEX){var c=this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_ACTIVATED_CLASS);c&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=n}},t.prototype.getSelectedIndexFromDOM=function(){for(var n=Jl.UNSET_INDEX,c=this.adapter.getListItemCount(),g=0;g<c;g++){var b=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_SELECTED_CLASS),E=this.adapter.listItemAtIndexHasClass(g,la.LIST_ITEM_ACTIVATED_CLASS);if(b||E){n=g;break}}return n},t.prototype.setHasTypeahead=function(n){this.hasTypeahead=n,n&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},t.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&n3(this.typeaheadState)},t.prototype.setUseActivatedClass=function(n){this.useActivatedClass=n},t.prototype.setUseSelectedAttribute=function(n){this.useSelectedAttr=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n,c){c===void 0&&(c={}),this.isIndexValid(n)&&(this.isCheckboxList?this.setCheckboxAtIndex(n,c):this.isRadioList?this.setRadioAtIndex(n,c):this.setSingleSelectionAtIndex(n,c))},t.prototype.handleFocusIn=function(n){n>=0&&(this.focusedItemIndex=n,this.adapter.setAttributeForElementIndex(n,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(n,"0"))},t.prototype.handleFocusOut=function(n){var c=this;n>=0&&(this.adapter.setAttributeForElementIndex(n,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(n,"-1")),setTimeout(function(){c.adapter.isFocusInsideList()||c.setTabindexToFirstSelectedOrFocusedItem()},0)},t.prototype.isIndexDisabled=function(n){return this.adapter.listItemAtIndexHasClass(n,la.LIST_ITEM_DISABLED_CLASS)},t.prototype.handleKeydown=function(n,c,g){var b=this,E,a=Au(n)==="ArrowLeft",U=Au(n)==="ArrowUp",W=Au(n)==="ArrowRight",ce=Au(n)==="ArrowDown",oe=Au(n)==="Home",fe=Au(n)==="End",we=Au(n)==="Enter",et=Au(n)==="Spacebar",lt=this.isVertical&&ce||!this.isVertical&&W,Ke=this.isVertical&&U||!this.isVertical&&a,st=n.key==="A"||n.key==="a",ut=U2(n);if(this.adapter.isRootFocused()){if((Ke||fe)&&ut([]))n.preventDefault(),this.focusLastElement();else if((lt||oe)&&ut([]))n.preventDefault(),this.focusFirstElement();else if(Ke&&ut(["Shift"])&&this.isCheckboxList){n.preventDefault();var kt=this.focusLastElement();kt!==-1&&this.setSelectedIndexOnAction(kt,!1)}else if(lt&&ut(["Shift"])&&this.isCheckboxList){n.preventDefault();var kt=this.focusFirstElement();kt!==-1&&this.setSelectedIndexOnAction(kt,!1)}if(this.hasTypeahead){var Bt={event:n,focusItemAtIndex:function(ni){b.focusItemAtIndex(ni)},focusedItemIndex:-1,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(ni){return b.isIndexDisabled(ni)}};V2(Bt,this.typeaheadState)}return}var Rt=this.adapter.getFocusedElementIndex();if(!(Rt===-1&&(Rt=g,Rt<0))){if(lt&&ut([]))zh(n),this.focusNextElement(Rt);else if(Ke&&ut([]))zh(n),this.focusPrevElement(Rt);else if(lt&&ut(["Shift"])&&this.isCheckboxList){zh(n);var kt=this.focusNextElement(Rt);kt!==-1&&this.setSelectedIndexOnAction(kt,!1)}else if(Ke&&ut(["Shift"])&&this.isCheckboxList){zh(n);var kt=this.focusPrevElement(Rt);kt!==-1&&this.setSelectedIndexOnAction(kt,!1)}else if(oe&&ut([]))zh(n),this.focusFirstElement();else if(fe&&ut([]))zh(n),this.focusLastElement();else if(oe&&ut(["Control","Shift"])&&this.isCheckboxList){if(zh(n),this.isIndexDisabled(Rt))return;this.focusFirstElement(),this.toggleCheckboxRange(0,Rt,Rt)}else if(fe&&ut(["Control","Shift"])&&this.isCheckboxList){if(zh(n),this.isIndexDisabled(Rt))return;this.focusLastElement(),this.toggleCheckboxRange(Rt,this.adapter.getListItemCount()-1,Rt)}else if(st&&ut(["Control"])&&this.isCheckboxList)n.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===Jl.UNSET_INDEX?[]:this.selectedIndex,!0);else if((we||et)&&ut([])){if(c){var Ge=n.target;if(Ge&&Ge.tagName==="A"&&we||(zh(n),this.isIndexDisabled(Rt)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(Rt,!1),this.adapter.notifyAction(Rt))}}else if((we||et)&&ut(["Shift"])&&this.isCheckboxList){var Ge=n.target;if(Ge&&Ge.tagName==="A"&&we||(zh(n),this.isIndexDisabled(Rt)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((E=this.lastSelectedIndex)!==null&&E!==void 0?E:Rt,Rt,Rt),this.adapter.notifyAction(Rt))}if(this.hasTypeahead){var Bt={event:n,focusItemAtIndex:function(it){b.focusItemAtIndex(it)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:c,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(it){return b.isIndexDisabled(it)}};V2(Bt,this.typeaheadState)}}},t.prototype.handleClick=function(n,c,g){var b,E=U2(g);n!==Jl.UNSET_INDEX&&(this.isIndexDisabled(n)||(E([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(n,c),this.adapter.notifyAction(n)):this.isCheckboxList&&E(["Shift"])&&(this.toggleCheckboxRange((b=this.lastSelectedIndex)!==null&&b!==void 0?b:n,n,n),this.adapter.notifyAction(n))))},t.prototype.focusNextElement=function(n){var c=this.adapter.getListItemCount(),g=n,b=null;do{if(g++,g>=c)if(this.wrapFocus)g=0;else return n;if(g===b)return-1;b=b??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusPrevElement=function(n){var c=this.adapter.getListItemCount(),g=n,b=null;do{if(g--,g<0)if(this.wrapFocus)g=c-1;else return n;if(g===b)return-1;b=b??g}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(g));return this.focusItemAtIndex(g),g},t.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},t.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},t.prototype.focusInitialElement=function(){var n=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(n),n},t.prototype.setEnabled=function(n,c){this.isIndexValid(n,!1)&&(c?(this.adapter.removeClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,B0.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(n,B0.ARIA_DISABLED,"true")))},t.prototype.setSingleSelectionAtIndex=function(n,c){if(c===void 0&&(c={}),!(this.selectedIndex===n&&!c.forceUpdate)){var g=la.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(g=la.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==Jl.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,g),this.setAriaForSingleSelectionAtIndex(n),this.setTabindexAtIndex(n),n!==Jl.UNSET_INDEX&&this.adapter.addClassForElementIndex(n,g),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n])}},t.prototype.setAriaForSingleSelectionAtIndex=function(n){this.selectedIndex===Jl.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(n,B0.ARIA_CURRENT));var c=this.ariaCurrentAttrValue!==null,g=c?B0.ARIA_CURRENT:B0.ARIA_SELECTED;if(this.selectedIndex!==Jl.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),n!==Jl.UNSET_INDEX){var b=c?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(n,g,b)}},t.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?B0.ARIA_SELECTED:B0.ARIA_CHECKED},t.prototype.setRadioAtIndex=function(n,c){c===void 0&&(c={});var g=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(n,!0),!(this.selectedIndex===n&&!c.forceUpdate)&&(this.selectedIndex!==Jl.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),this.adapter.setAttributeForElementIndex(n,g,"true"),this.selectedIndex=n,c.isUserInteraction&&!c.forceUpdate&&this.adapter.notifySelectionChange([n]))},t.prototype.setCheckboxAtIndex=function(n,c){c===void 0&&(c={});for(var g=this.selectedIndex,b=c.isUserInteraction?new Set(g===Jl.UNSET_INDEX?[]:g):null,E=this.getSelectionAttribute(),a=[],U=0;U<this.adapter.getListItemCount();U++){var W=b==null?void 0:b.has(U),ce=n.indexOf(U)>=0;ce!==W&&a.push(U),this.adapter.setCheckedCheckboxOrRadioAtIndex(U,ce),this.adapter.setAttributeForElementIndex(U,E,ce?"true":"false")}this.selectedIndex=n,c.isUserInteraction&&a.length&&this.adapter.notifySelectionChange(a)},t.prototype.toggleCheckboxRange=function(n,c,g){this.lastSelectedIndex=g;for(var b=new Set(this.selectedIndex===Jl.UNSET_INDEX?[]:this.selectedIndex),E=!(b!=null&&b.has(g)),a=N2([n,c].sort(),2),U=a[0],W=a[1],ce=this.getSelectionAttribute(),oe=[],fe=U;fe<=W;fe++)if(!this.isIndexDisabled(fe)){var we=b.has(fe);E!==we&&(oe.push(fe),this.adapter.setCheckedCheckboxOrRadioAtIndex(fe,E),this.adapter.setAttributeForElementIndex(fe,ce,""+E),E?b.add(fe):b.delete(fe))}oe.length&&(this.selectedIndex=JI([],N2(b)),this.adapter.notifySelectionChange(oe))},t.prototype.setTabindexAtIndex=function(n){this.focusedItemIndex===Jl.UNSET_INDEX&&n!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==n&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==n&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),n!==Jl.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(n,"tabindex","0")},t.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},t.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var n=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(n)},t.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==Jl.UNSET_INDEX?this.selectedIndex:AE(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(n,c){return Math.min(n,c)}):0:Math.max(this.focusedItemIndex,0)},t.prototype.isIndexValid=function(n,c){var g=this;if(c===void 0&&(c=!0),n instanceof Array){if(!this.isCheckboxList&&c)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return n.length===0?!0:n.some(function(b){return g.isIndexInRange(b)})}else if(typeof n=="number"){if(this.isCheckboxList&&c)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+n);return this.isIndexInRange(n)||this.isSingleSelectionList&&n===Jl.UNSET_INDEX}else return!1},t.prototype.isIndexInRange=function(n){var c=this.adapter.getListItemCount();return n>=0&&n<c},t.prototype.setSelectedIndexOnAction=function(n,c){this.lastSelectedIndex=n,this.isCheckboxList?(this.toggleCheckboxAtIndex(n,c),this.adapter.notifySelectionChange([n])):this.setSelectedIndex(n,{isUserInteraction:!0})},t.prototype.toggleCheckboxAtIndex=function(n,c){var g=this.getSelectionAttribute(),b=this.adapter.isCheckboxCheckedAtIndex(n),E;c?E=b:(E=!b,this.adapter.setCheckedCheckboxOrRadioAtIndex(n,E)),this.adapter.setAttributeForElementIndex(n,g,E?"true":"false");var a=this.selectedIndex===Jl.UNSET_INDEX?[]:this.selectedIndex.slice();E?a.push(n):a=a.filter(function(U){return U!==n}),this.selectedIndex=a},t.prototype.focusItemAtIndex=function(n){this.adapter.focusItemAtIndex(n),this.focusedItemIndex=n},t.prototype.checkboxListToggleAll=function(n,c){var g=this.adapter.getListItemCount();if(n.length===g)this.setCheckboxAtIndex([],{isUserInteraction:c});else{for(var b=[],E=0;E<g;E++)(!this.isIndexDisabled(E)||n.indexOf(E)>-1)&&b.push(E);this.setCheckboxAtIndex(b,{isUserInteraction:c})}},t.prototype.typeaheadMatchItem=function(n,c,g){var b=this;g===void 0&&(g=!1);var E={focusItemAtIndex:function(a){b.focusItemAtIndex(a)},focusedItemIndex:c||this.focusedItemIndex,nextChar:n,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:g,isItemAtIndexDisabled:function(a){return b.isIndexDisabled(a)}};return Ly(E,this.typeaheadState)},t.prototype.typeaheadInitSortedIndex=function(){return uE(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},t.prototype.clearTypeaheadBuffer=function(){r3(this.typeaheadState)},t}(s0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var s3=function(e){r0(t,e);function t(n){var c=e.call(this,iu(iu({},t.defaultAdapter),n))||this;return c.isSurfaceOpen=!1,c.isQuickOpen=!1,c.isHoistedElement=!1,c.isFixedPosition=!1,c.isHorizontallyCenteredOnViewport=!1,c.maxHeight=0,c.openBottomBias=0,c.openAnimationEndTimerId=0,c.closeAnimationEndTimerId=0,c.animationRequestId=0,c.anchorCorner=Wd.TOP_START,c.originCorner=Wd.TOP_START,c.anchorMargin={top:0,right:0,bottom:0,left:0},c.position={x:0,y:0},c}return Object.defineProperty(t,"cssClasses",{get:function(){return sE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return aE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Hm},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Corner",{get:function(){return Wd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=t.cssClasses,c=n.ROOT,g=n.OPEN;if(!this.adapter.hasClass(c))throw new Error(c+" class required in root element.");this.adapter.hasClass(g)&&(this.isSurfaceOpen=!0)},t.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},t.prototype.setAnchorCorner=function(n){this.anchorCorner=n},t.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^eu.RIGHT},t.prototype.setAnchorMargin=function(n){this.anchorMargin.top=n.top||0,this.anchorMargin.right=n.right||0,this.anchorMargin.bottom=n.bottom||0,this.anchorMargin.left=n.left||0},t.prototype.setIsHoisted=function(n){this.isHoistedElement=n},t.prototype.setFixedPosition=function(n){this.isFixedPosition=n},t.prototype.isFixed=function(){return this.isFixedPosition},t.prototype.setAbsolutePosition=function(n,c){this.position.x=this.isFinite(n)?n:0,this.position.y=this.isFinite(c)?c:0},t.prototype.setIsHorizontallyCenteredOnViewport=function(n){this.isHorizontallyCenteredOnViewport=n},t.prototype.setQuickOpen=function(n){this.isQuickOpen=n},t.prototype.setMaxHeight=function(n){this.maxHeight=n},t.prototype.setOpenBottomBias=function(n){this.openBottomBias=n},t.prototype.isOpen=function(){return this.isSurfaceOpen},t.prototype.open=function(){var n=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(t.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(t.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(function(){n.dimensions=n.adapter.getInnerDimensions(),n.autoposition(),n.adapter.addClass(t.cssClasses.OPEN),n.openAnimationEndTimerId=setTimeout(function(){n.openAnimationEndTimerId=0,n.adapter.removeClass(t.cssClasses.ANIMATING_OPEN),n.adapter.notifyOpen()},Hm.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0))},t.prototype.close=function(n){var c=this;if(n===void 0&&(n=!1),!!this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen){this.isSurfaceOpen=!1,n||this.maybeRestoreFocus(),this.adapter.removeClass(t.cssClasses.OPEN),this.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(t.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(function(){c.adapter.removeClass(t.cssClasses.OPEN),c.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),c.closeAnimationEndTimerId=setTimeout(function(){c.closeAnimationEndTimerId=0,c.adapter.removeClass(t.cssClasses.ANIMATING_CLOSED),c.adapter.notifyClose()},Hm.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,n||this.maybeRestoreFocus()}},t.prototype.handleBodyClick=function(n){var c=n.target;this.adapter.isElementInContainer(c)||this.close()},t.prototype.handleKeydown=function(n){var c=n.keyCode,g=n.key,b=g==="Escape"||c===27;b&&this.close()},t.prototype.autoposition=function(){var n;this.measurements=this.getAutoLayoutmeasurements();var c=this.getoriginCorner(),g=this.getMenuSurfaceMaxHeight(c),b=this.hasBit(c,eu.BOTTOM)?"bottom":"top",E=this.hasBit(c,eu.RIGHT)?"right":"left",a=this.getHorizontalOriginOffset(c),U=this.getVerticalOriginOffset(c),W=this.measurements,ce=W.anchorSize,oe=W.surfaceSize,fe=(n={},n[E]=a,n[b]=U,n);ce.width/oe.width>Hm.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(E="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(fe),this.adapter.setTransformOrigin(E+" "+b),this.adapter.setPosition(fe),this.adapter.setMaxHeight(g?g+"px":""),this.hasBit(c,eu.BOTTOM)||this.adapter.addClass(t.cssClasses.IS_OPEN_BELOW)},t.prototype.getAutoLayoutmeasurements=function(){var n=this.adapter.getAnchorDimensions(),c=this.adapter.getBodyDimensions(),g=this.adapter.getWindowDimensions(),b=this.adapter.getWindowScroll();return n||(n={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:n,bodySize:c,surfaceSize:this.dimensions,viewportDistance:{top:n.top,right:g.width-n.right,bottom:g.height-n.bottom,left:n.left},viewportSize:g,windowScroll:b}},t.prototype.getoriginCorner=function(){var n=this.originCorner,c=this.measurements,g=c.viewportDistance,b=c.anchorSize,E=c.surfaceSize,a=t.numbers.MARGIN_TO_EDGE,U=this.hasBit(this.anchorCorner,eu.BOTTOM),W,ce;U?(W=g.top-a+this.anchorMargin.bottom,ce=g.bottom-a-this.anchorMargin.bottom):(W=g.top-a+this.anchorMargin.top,ce=g.bottom-a+b.height-this.anchorMargin.top);var oe=ce-E.height>0;!oe&&W>ce+this.openBottomBias&&(n=this.setBit(n,eu.BOTTOM));var fe=this.adapter.isRtl(),we=this.hasBit(this.anchorCorner,eu.FLIP_RTL),et=this.hasBit(this.anchorCorner,eu.RIGHT)||this.hasBit(n,eu.RIGHT),lt=!1;fe&&we?lt=!et:lt=et;var Ke,st;lt?(Ke=g.left+b.width+this.anchorMargin.right,st=g.right-this.anchorMargin.right):(Ke=g.left+this.anchorMargin.left,st=g.right+b.width-this.anchorMargin.left);var ut=Ke-E.width>0,kt=st-E.width>0,Bt=this.hasBit(n,eu.FLIP_RTL)&&this.hasBit(n,eu.RIGHT);return kt&&Bt&&fe||!ut&&Bt?n=this.unsetBit(n,eu.RIGHT):(ut&&lt&&fe||ut&&!lt&&et||!kt&&Ke>=st)&&(n=this.setBit(n,eu.RIGHT)),n},t.prototype.getMenuSurfaceMaxHeight=function(n){if(this.maxHeight>0)return this.maxHeight;var c=this.measurements.viewportDistance,g=0,b=this.hasBit(n,eu.BOTTOM),E=this.hasBit(this.anchorCorner,eu.BOTTOM),a=t.numbers.MARGIN_TO_EDGE;return b?(g=c.top+this.anchorMargin.top-a,E||(g+=this.measurements.anchorSize.height)):(g=c.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-a,E&&(g-=this.measurements.anchorSize.height)),g},t.prototype.getHorizontalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,eu.RIGHT),b=this.hasBit(this.anchorCorner,eu.RIGHT);if(g){var E=b?c.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?E-(this.measurements.viewportSize.width-this.measurements.bodySize.width):E}return b?c.width-this.anchorMargin.right:this.anchorMargin.left},t.prototype.getVerticalOriginOffset=function(n){var c=this.measurements.anchorSize,g=this.hasBit(n,eu.BOTTOM),b=this.hasBit(this.anchorCorner,eu.BOTTOM),E=0;return g?E=b?c.height-this.anchorMargin.top:-this.anchorMargin.bottom:E=b?c.height+this.anchorMargin.bottom:this.anchorMargin.top,E},t.prototype.adjustPositionForHoistedElement=function(n){var c,g,b=this.measurements,E=b.windowScroll,a=b.viewportDistance,U=b.surfaceSize,W=b.viewportSize,ce=Object.keys(n);try{for(var oe=tg(ce),fe=oe.next();!fe.done;fe=oe.next()){var we=fe.value,et=n[we]||0;if(this.isHorizontallyCenteredOnViewport&&(we==="left"||we==="right")){n[we]=(W.width-U.width)/2;continue}et+=a[we],this.isFixedPosition||(we==="top"?et+=E.y:we==="bottom"?et-=E.y:we==="left"?et+=E.x:et-=E.x),n[we]=et}}catch(lt){c={error:lt}}finally{try{fe&&!fe.done&&(g=oe.return)&&g.call(oe)}finally{if(c)throw c.error}}},t.prototype.maybeRestoreFocus=function(){var n=this,c=this.adapter.isFocused(),g=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,b=g.activeElement&&this.adapter.isElementInContainer(g.activeElement);(c||b)&&setTimeout(function(){n.adapter.restoreFocus()},Hm.TOUCH_EVENT_WAIT_MS)},t.prototype.hasBit=function(n,c){return!!(n&c)},t.prototype.setBit=function(n,c){return n|c},t.prototype.unsetBit=function(n,c){return n^c},t.prototype.isFinite=function(n){return typeof n=="number"&&isFinite(n)},t}(s0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var am={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},Zp={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},pE={FOCUS_ROOT_INDEX:-1},Jp;(function(e){e[e.NONE=0]="NONE",e[e.LIST_ROOT=1]="LIST_ROOT",e[e.FIRST_ITEM=2]="FIRST_ITEM",e[e.LAST_ITEM=3]="LAST_ITEM"})(Jp||(Jp={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var mE=function(e){r0(t,e);function t(n){var c=e.call(this,iu(iu({},t.defaultAdapter),n))||this;return c.closeAnimationEndTimerId=0,c.defaultFocusState=Jp.LIST_ROOT,c.selectedIndex=-1,c}return Object.defineProperty(t,"cssClasses",{get:function(){return am},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return Zp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return pE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},t.prototype.handleKeydown=function(n){var c=n.key,g=n.keyCode,b=c==="Tab"||g===9;b&&this.adapter.closeSurface(!0)},t.prototype.handleItemAction=function(n){var c=this,g=this.adapter.getElementIndex(n);if(!(g<0)){this.adapter.notifySelected({index:g});var b=this.adapter.getAttributeFromElementAtIndex(g,Zp.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(b),this.closeAnimationEndTimerId=setTimeout(function(){var E=c.adapter.getElementIndex(n);E>=0&&c.adapter.isSelectableItemAtIndex(E)&&c.setSelectedIndex(E)},s3.numbers.TRANSITION_CLOSE_DURATION)}},t.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case Jp.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case Jp.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case Jp.NONE:break;default:this.adapter.focusListRoot();break}},t.prototype.setDefaultFocusState=function(n){this.defaultFocusState=n},t.prototype.getSelectedIndex=function(){return this.selectedIndex},t.prototype.setSelectedIndex=function(n){if(this.validatedIndex(n),!this.adapter.isSelectableItemAtIndex(n))throw new Error("MDCMenuFoundation: No selection group at specified index.");var c=this.adapter.getSelectedSiblingOfItemAtIndex(n);c>=0&&(this.adapter.removeAttributeFromElementAtIndex(c,Zp.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(c,am.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(n,am.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(n,Zp.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=n},t.prototype.setEnabled=function(n,c){this.validatedIndex(n),c?(this.adapter.removeClassFromElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Zp.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(n,la.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(n,Zp.ARIA_DISABLED_ATTR,"true"))},t.prototype.validatedIndex=function(n){var c=this.adapter.getMenuItemCount(),g=n>=0&&n<c;if(!g)throw new Error("MDCMenuFoundation: No list item at specified index.")},t}(s0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var gE={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},G2={NOTCH_ELEMENT_PADDING:8},_E={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var yE=function(e){r0(t,e);function t(n){return e.call(this,iu(iu({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"strings",{get:function(){return gE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cssClasses",{get:function(){return _E},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return G2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),t.prototype.notch=function(n){var c=t.cssClasses.OUTLINE_NOTCHED;n>0&&(n+=G2.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(n),this.adapter.addClass(c)},t.prototype.closeNotch=function(){var n=t.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(n),this.adapter.removeNotchWidthProperty()},t}(s0);/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function vE(e){return e===void 0&&(e=window),xE(e)?{passive:!0}:!1}function xE(e){e===void 0&&(e=window);var t=!1;try{var n={get passive(){return t=!0,!1}},c=function(){};e.document.addEventListener("test",c,n),e.document.removeEventListener("test",c,n)}catch{t=!1}return t}const bE=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:vE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var wE={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},SE={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},q2={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},Fg;function IE(e,t){t===void 0&&(t=!1);var n=e.CSS,c=Fg;if(typeof Fg=="boolean"&&!t)return Fg;var g=n&&typeof n.supports=="function";if(!g)return!1;var b=n.supports("--css-vars","yes"),E=n.supports("(--css-vars: yes)")&&n.supports("color","#00000000");return c=b||E,t||(Fg=c),c}function EE(e,t,n){if(!e)return{x:0,y:0};var c=t.x,g=t.y,b=c+n.left,E=g+n.top,a,U;if(e.type==="touchstart"){var W=e;a=W.changedTouches[0].pageX-b,U=W.changedTouches[0].pageY-E}else{var ce=e;a=ce.pageX-b,U=ce.pageY-E}return{x:a,y:U}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var H2=["touchstart","pointerdown","mousedown","keydown"],j2=["touchend","pointerup","mouseup","contextmenu"],Og=[],CE=function(e){r0(t,e);function t(n){var c=e.call(this,iu(iu({},t.defaultAdapter),n))||this;return c.activationAnimationHasEnded=!1,c.activationTimer=0,c.fgDeactivationRemovalTimer=0,c.fgScale="0",c.frame={width:0,height:0},c.initialSize=0,c.layoutFrame=0,c.maxRadius=0,c.unboundedCoords={left:0,top:0},c.activationState=c.defaultActivationState(),c.activationTimerCallback=function(){c.activationAnimationHasEnded=!0,c.runDeactivationUXLogicIfReady()},c.activateHandler=function(g){c.activateImpl(g)},c.deactivateHandler=function(){c.deactivateImpl()},c.focusHandler=function(){c.handleFocus()},c.blurHandler=function(){c.handleBlur()},c.resizeHandler=function(){c.layout()},c}return Object.defineProperty(t,"cssClasses",{get:function(){return wE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return SE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return q2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){var n=this,c=this.supportsPressRipple();if(this.registerRootHandlers(c),c){var g=t.cssClasses,b=g.ROOT,E=g.UNBOUNDED;requestAnimationFrame(function(){n.adapter.addClass(b),n.adapter.isUnbounded()&&(n.adapter.addClass(E),n.layoutInternal())})}},t.prototype.destroy=function(){var n=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(t.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(t.cssClasses.FG_DEACTIVATION));var c=t.cssClasses,g=c.ROOT,b=c.UNBOUNDED;requestAnimationFrame(function(){n.adapter.removeClass(g),n.adapter.removeClass(b),n.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},t.prototype.activate=function(n){this.activateImpl(n)},t.prototype.deactivate=function(){this.deactivateImpl()},t.prototype.layout=function(){var n=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){n.layoutInternal(),n.layoutFrame=0})},t.prototype.setUnbounded=function(n){var c=t.cssClasses.UNBOUNDED;n?this.adapter.addClass(c):this.adapter.removeClass(c)},t.prototype.handleFocus=function(){var n=this;requestAnimationFrame(function(){return n.adapter.addClass(t.cssClasses.BG_FOCUSED)})},t.prototype.handleBlur=function(){var n=this;requestAnimationFrame(function(){return n.adapter.removeClass(t.cssClasses.BG_FOCUSED)})},t.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},t.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},t.prototype.registerRootHandlers=function(n){var c,g;if(n){try{for(var b=tg(H2),E=b.next();!E.done;E=b.next()){var a=E.value;this.adapter.registerInteractionHandler(a,this.activateHandler)}}catch(U){c={error:U}}finally{try{E&&!E.done&&(g=b.return)&&g.call(b)}finally{if(c)throw c.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},t.prototype.registerDeactivationHandlers=function(n){var c,g;if(n.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var b=tg(j2),E=b.next();!E.done;E=b.next()){var a=E.value;this.adapter.registerDocumentInteractionHandler(a,this.deactivateHandler)}}catch(U){c={error:U}}finally{try{E&&!E.done&&(g=b.return)&&g.call(b)}finally{if(c)throw c.error}}},t.prototype.deregisterRootHandlers=function(){var n,c;try{for(var g=tg(H2),b=g.next();!b.done;b=g.next()){var E=b.value;this.adapter.deregisterInteractionHandler(E,this.activateHandler)}}catch(a){n={error:a}}finally{try{b&&!b.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},t.prototype.deregisterDeactivationHandlers=function(){var n,c;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var g=tg(j2),b=g.next();!b.done;b=g.next()){var E=b.value;this.adapter.deregisterDocumentInteractionHandler(E,this.deactivateHandler)}}catch(a){n={error:a}}finally{try{b&&!b.done&&(c=g.return)&&c.call(g)}finally{if(n)throw n.error}}},t.prototype.removeCssVars=function(){var n=this,c=t.strings,g=Object.keys(c);g.forEach(function(b){b.indexOf("VAR_")===0&&n.adapter.updateCssVariable(c[b],null)})},t.prototype.activateImpl=function(n){var c=this;if(!this.adapter.isSurfaceDisabled()){var g=this.activationState;if(!g.isActivated){var b=this.previousActivationEvent,E=b&&n!==void 0&&b.type!==n.type;if(!E){g.isActivated=!0,g.isProgrammatic=n===void 0,g.activationEvent=n,g.wasActivatedByPointer=g.isProgrammatic?!1:n!==void 0&&(n.type==="mousedown"||n.type==="touchstart"||n.type==="pointerdown");var a=n!==void 0&&Og.length>0&&Og.some(function(U){return c.adapter.containsEventTarget(U)});if(a){this.resetActivationState();return}n!==void 0&&(Og.push(n.target),this.registerDeactivationHandlers(n)),g.wasElementMadeActive=this.checkElementMadeActive(n),g.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Og=[],!g.wasElementMadeActive&&n!==void 0&&(n.key===" "||n.keyCode===32)&&(g.wasElementMadeActive=c.checkElementMadeActive(n),g.wasElementMadeActive&&c.animateActivation()),g.wasElementMadeActive||(c.activationState=c.defaultActivationState())})}}}},t.prototype.checkElementMadeActive=function(n){return n!==void 0&&n.type==="keydown"?this.adapter.isSurfaceActive():!0},t.prototype.animateActivation=function(){var n=this,c=t.strings,g=c.VAR_FG_TRANSLATE_START,b=c.VAR_FG_TRANSLATE_END,E=t.cssClasses,a=E.FG_DEACTIVATION,U=E.FG_ACTIVATION,W=t.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var ce="",oe="";if(!this.adapter.isUnbounded()){var fe=this.getFgTranslationCoordinates(),we=fe.startPoint,et=fe.endPoint;ce=we.x+"px, "+we.y+"px",oe=et.x+"px, "+et.y+"px"}this.adapter.updateCssVariable(g,ce),this.adapter.updateCssVariable(b,oe),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(a),this.adapter.computeBoundingRect(),this.adapter.addClass(U),this.activationTimer=setTimeout(function(){n.activationTimerCallback()},W)},t.prototype.getFgTranslationCoordinates=function(){var n=this.activationState,c=n.activationEvent,g=n.wasActivatedByPointer,b;g?b=EE(c,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):b={x:this.frame.width/2,y:this.frame.height/2},b={x:b.x-this.initialSize/2,y:b.y-this.initialSize/2};var E={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:b,endPoint:E}},t.prototype.runDeactivationUXLogicIfReady=function(){var n=this,c=t.cssClasses.FG_DEACTIVATION,g=this.activationState,b=g.hasDeactivationUXRun,E=g.isActivated,a=b||!E;a&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(c),this.fgDeactivationRemovalTimer=setTimeout(function(){n.adapter.removeClass(c)},q2.FG_DEACTIVATION_MS))},t.prototype.rmBoundedActivationClasses=function(){var n=t.cssClasses.FG_ACTIVATION;this.adapter.removeClass(n),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},t.prototype.resetActivationState=function(){var n=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return n.previousActivationEvent=void 0},t.numbers.TAP_DELAY_MS)},t.prototype.deactivateImpl=function(){var n=this,c=this.activationState;if(c.isActivated){var g=iu({},c);c.isProgrammatic?(requestAnimationFrame(function(){n.animateDeactivation(g)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){n.activationState.hasDeactivationUXRun=!0,n.animateDeactivation(g),n.resetActivationState()}))}},t.prototype.animateDeactivation=function(n){var c=n.wasActivatedByPointer,g=n.wasElementMadeActive;(c||g)&&this.runDeactivationUXLogicIfReady()},t.prototype.layoutInternal=function(){var n=this;this.frame=this.adapter.computeBoundingRect();var c=Math.max(this.frame.height,this.frame.width),g=function(){var E=Math.sqrt(Math.pow(n.frame.width,2)+Math.pow(n.frame.height,2));return E+t.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?c:g();var b=Math.floor(c*t.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&b%2!==0?this.initialSize=b-1:this.initialSize=b,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},t.prototype.updateLayoutCssVars=function(){var n=t.strings,c=n.VAR_FG_SIZE,g=n.VAR_LEFT,b=n.VAR_TOP,E=n.VAR_FG_SCALE;this.adapter.updateCssVariable(c,this.initialSize+"px"),this.adapter.updateCssVariable(E,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(g,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(b,this.unboundedCoords.top+"px"))},t}(s0);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Rl={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},T1={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},Ud={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var TE=function(e){r0(t,e);function t(n,c){c===void 0&&(c={});var g=e.call(this,iu(iu({},t.defaultAdapter),n))||this;return g.disabled=!1,g.isMenuOpen=!1,g.useDefaultValidation=!0,g.customValidity=!0,g.lastSelectedIndex=Ud.UNSET_INDEX,g.clickDebounceTimeout=0,g.recentlyClicked=!1,g.leadingIcon=c.leadingIcon,g.helperText=c.helperText,g}return Object.defineProperty(t,"cssClasses",{get:function(){return Rl},enumerable:!1,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return Ud},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return T1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),t.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},t.prototype.setSelectedIndex=function(n,c,g){c===void 0&&(c=!1),g===void 0&&(g=!1),!(n>=this.adapter.getMenuItemCount())&&(n===Ud.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(n).trim()),this.adapter.setSelectedIndex(n),c&&this.adapter.closeMenu(),!g&&this.lastSelectedIndex!==n&&this.handleChange(),this.lastSelectedIndex=n)},t.prototype.setValue=function(n,c){c===void 0&&(c=!1);var g=this.adapter.getMenuItemValues().indexOf(n);this.setSelectedIndex(g,!1,c)},t.prototype.getValue=function(){var n=this.adapter.getSelectedIndex(),c=this.adapter.getMenuItemValues();return n!==Ud.UNSET_INDEX?c[n]:""},t.prototype.getDisabled=function(){return this.disabled},t.prototype.setDisabled=function(n){this.disabled=n,this.disabled?(this.adapter.addClass(Rl.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(Rl.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},t.prototype.openMenu=function(){this.adapter.addClass(Rl.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},t.prototype.setHelperTextContent=function(n){this.helperText&&this.helperText.setContent(n)},t.prototype.layout=function(){if(this.adapter.hasLabel()){var n=this.getValue().length>0,c=this.adapter.hasClass(Rl.FOCUSED),g=n||c,b=this.adapter.hasClass(Rl.REQUIRED);this.notchOutline(g),this.adapter.floatLabel(g),this.adapter.setLabelRequired(b)}},t.prototype.layoutOptions=function(){var n=this.adapter.getMenuItemValues(),c=n.indexOf(this.getValue());this.setSelectedIndex(c,!1,!0)},t.prototype.handleMenuOpened=function(){if(this.adapter.getMenuItemValues().length!==0){var n=this.getSelectedIndex(),c=n>=0?n:0;this.adapter.focusMenuItemAtIndex(c)}},t.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},t.prototype.handleMenuClosed=function(){this.adapter.removeClass(Rl.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},t.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue());var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.handleMenuItemAction=function(n){this.setSelectedIndex(n,!0)},t.prototype.handleFocus=function(){this.adapter.addClass(Rl.FOCUSED),this.layout(),this.adapter.activateBottomLine()},t.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},t.prototype.handleClick=function(n){if(!(this.disabled||this.recentlyClicked)){if(this.setClickDebounceTimeout(),this.isMenuOpen){this.adapter.closeMenu();return}this.adapter.setRippleCenter(n),this.openMenu()}},t.prototype.handleKeydown=function(n){if(!(this.isMenuOpen||!this.adapter.hasClass(Rl.FOCUSED))){var c=Au(n)===Os.ENTER,g=Au(n)===Os.SPACEBAR,b=Au(n)===Os.ARROW_UP,E=Au(n)===Os.ARROW_DOWN,a=n.ctrlKey||n.metaKey;if(!a&&(!g&&n.key&&n.key.length===1||g&&this.adapter.isTypeaheadInProgress())){var U=g?" ":n.key,W=this.adapter.typeaheadMatchItem(U,this.getSelectedIndex());W>=0&&this.setSelectedIndex(W),n.preventDefault();return}!c&&!g&&!b&&!E||(this.openMenu(),n.preventDefault())}},t.prototype.notchOutline=function(n){if(this.adapter.hasOutline()){var c=this.adapter.hasClass(Rl.FOCUSED);if(n){var g=Ud.LABEL_SCALE,b=this.adapter.getLabelWidth()*g;this.adapter.notchOutline(b)}else c||this.adapter.closeOutline()}},t.prototype.setLeadingIconAriaLabel=function(n){this.leadingIcon&&this.leadingIcon.setAriaLabel(n)},t.prototype.setLeadingIconContent=function(n){this.leadingIcon&&this.leadingIcon.setContent(n)},t.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},t.prototype.setUseDefaultValidation=function(n){this.useDefaultValidation=n},t.prototype.setValid=function(n){this.useDefaultValidation||(this.customValidity=n),this.adapter.setSelectAnchorAttr("aria-invalid",(!n).toString()),n?(this.adapter.removeClass(Rl.INVALID),this.adapter.removeMenuClass(Rl.MENU_INVALID)):(this.adapter.addClass(Rl.INVALID),this.adapter.addMenuClass(Rl.MENU_INVALID)),this.syncHelperTextValidity(n)},t.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(Rl.REQUIRED)&&!this.adapter.hasClass(Rl.DISABLED)?this.getSelectedIndex()!==Ud.UNSET_INDEX&&(this.getSelectedIndex()!==0||!!this.getValue()):this.customValidity},t.prototype.setRequired=function(n){n?this.adapter.addClass(Rl.REQUIRED):this.adapter.removeClass(Rl.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",n.toString()),this.adapter.setLabelRequired(n)},t.prototype.getRequired=function(){return this.adapter.getSelectAnchorAttr("aria-required")==="true"},t.prototype.init=function(){var n=this.adapter.getAnchorElement();n&&(this.adapter.setMenuAnchorElement(n),this.adapter.setMenuAnchorCorner(Wd.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(Rl.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(Rl.INVALID)),this.layout(),this.layoutOptions()},t.prototype.blur=function(){this.adapter.removeClass(Rl.FOCUSED),this.layout(),this.adapter.deactivateBottomLine();var n=this.adapter.hasClass(Rl.REQUIRED);n&&this.useDefaultValidation&&this.setValid(this.isValid())},t.prototype.syncHelperTextValidity=function(n){if(this.helperText){this.helperText.setValidity(n);var c=this.helperText.isVisible(),g=this.helperText.getId();c&&g?this.adapter.setSelectAnchorAttr(T1.ARIA_DESCRIBEDBY,g):this.adapter.removeSelectAnchorAttr(T1.ARIA_DESCRIBEDBY)}},t.prototype.setClickDebounceTimeout=function(){var n=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout(function(){n.recentlyClicked=!1},Ud.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},t}(s0);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Gd={ARIA_HIDDEN:"aria-hidden",ROLE:"role"},jf={HELPER_TEXT_VALIDATION_MSG:"mdc-select-helper-text--validation-msg",HELPER_TEXT_VALIDATION_MSG_PERSISTENT:"mdc-select-helper-text--validation-msg-persistent"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kE=function(e){r0(t,e);function t(n){return e.call(this,iu(iu({},t.defaultAdapter),n))||this}return Object.defineProperty(t,"cssClasses",{get:function(){return jf},enumerable:!1,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return Gd},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},getAttr:function(){return null},removeAttr:function(){},setContent:function(){}}},enumerable:!1,configurable:!0}),t.prototype.getId=function(){return this.adapter.getAttr("id")},t.prototype.isVisible=function(){return this.adapter.getAttr(Gd.ARIA_HIDDEN)!=="true"},t.prototype.setContent=function(n){this.adapter.setContent(n)},t.prototype.setValidation=function(n){n?this.adapter.addClass(jf.HELPER_TEXT_VALIDATION_MSG):this.adapter.removeClass(jf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.setValidationMsgPersistent=function(n){n?this.adapter.addClass(jf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT):this.adapter.removeClass(jf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.getIsValidation=function(){return this.adapter.hasClass(jf.HELPER_TEXT_VALIDATION_MSG)},t.prototype.getIsValidationMsgPersistent=function(){return this.adapter.hasClass(jf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},t.prototype.setValidity=function(n){var c=this.adapter.hasClass(jf.HELPER_TEXT_VALIDATION_MSG);if(c){var g=this.adapter.hasClass(jf.HELPER_TEXT_VALIDATION_MSG_PERSISTENT),b=!n||g;if(b){this.showToScreenReader(),n?this.adapter.removeAttr(Gd.ROLE):this.adapter.setAttr(Gd.ROLE,"alert");return}this.adapter.removeAttr(Gd.ROLE),this.hide()}},t.prototype.showToScreenReader=function(){this.adapter.removeAttr(Gd.ARIA_HIDDEN)},t.prototype.hide=function(){this.adapter.setAttr(Gd.ARIA_HIDDEN,"true")},t}(s0);function Ss(e){return Object.entries(e).filter(([t,n])=>t!==""&&n).map(([t])=>t).join(" ")}function tu(e,t,n,c={bubbles:!0},g=!1){if(typeof Event>"u")throw new Error("Event not defined.");if(!e)throw new Error("Tried to dipatch event without element.");const b=new CustomEvent(t,Object.assign(Object.assign({},c),{detail:n}));if(e==null||e.dispatchEvent(b),g&&t.startsWith("SMUI")){const E=new CustomEvent(t.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},c),{detail:n}));e==null||e.dispatchEvent(E),E.defaultPrevented&&b.preventDefault()}return b}function Z2(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const b=n[g],E=b.indexOf("$");E!==-1&&t.indexOf(b.substring(0,E+1))!==-1||t.indexOf(b)===-1&&(c[b]=e[b])}return c}const Q2=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,ME=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function wc(e){let t,n=[];e.$on=(g,b)=>{let E=g,a=()=>{};return t?a=t(E,b):n.push([E,b]),E.match(Q2)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',E),()=>{a()}};function c(g){const b=e.$$.callbacks[g.type];b&&b.slice().forEach(E=>E.call(this,g))}return g=>{const b=[],E={};t=(a,U)=>{let W=a,ce=U,oe=!1;const fe=W.match(Q2),we=W.match(ME),et=fe||we;if(W.match(/^SMUI:\w+:/)){const st=W.split(":");let ut="";for(let kt=0;kt<st.length;kt++)ut+=kt===st.length-1?":"+st[kt]:st[kt].split("-").map(Bt=>Bt.slice(0,1).toUpperCase()+Bt.slice(1)).join("");console.warn(`The event ${W.split("$")[0]} has been renamed to ${ut.split("$")[0]}.`),W=ut}if(et){const st=W.split(fe?":":"$");W=st[0];const ut=st.slice(1).reduce((kt,Bt)=>(kt[Bt]=!0,kt),{});ut.passive&&(oe=oe||{},oe.passive=!0),ut.nonpassive&&(oe=oe||{},oe.passive=!1),ut.capture&&(oe=oe||{},oe.capture=!0),ut.once&&(oe=oe||{},oe.once=!0),ut.preventDefault&&(ce=PE(ce)),ut.stopPropagation&&(ce=DE(ce)),ut.stopImmediatePropagation&&(ce=LE(ce)),ut.self&&(ce=BE(g,ce)),ut.trusted&&(ce=zE(ce))}const lt=W2(g,W,ce,oe),Ke=()=>{lt();const st=b.indexOf(Ke);st>-1&&b.splice(st,1)};return b.push(Ke),W in E||(E[W]=W2(g,W,c)),Ke};for(let a=0;a<n.length;a++)t(n[a][0],n[a][1]);return{destroy:()=>{for(let a=0;a<b.length;a++)b[a]();for(let a of Object.entries(E))a[1]()}}}}function W2(e,t,n,c){return e.addEventListener(t,n,c),()=>e.removeEventListener(t,n,c)}function PE(e){return function(t){return t.preventDefault(),e.call(this,t)}}function DE(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function LE(e){return function(t){return t.stopImmediatePropagation(),e.call(this,t)}}function BE(e,t){return function(n){if(n.target===e)return t.call(this,n)}}function zE(e){return function(t){if(t.isTrusted)return e.call(this,t)}}function wl(e,t){let n=Object.getOwnPropertyNames(e);const c={};for(let g=0;g<n.length;g++){const b=n[g];b.substring(0,t.length)===t&&(c[b.substring(t.length)]=e[b])}return c}function pc(e,t){let n=[];if(t)for(let c=0;c<t.length;c++){const g=t[c],b=Array.isArray(g)?g[0]:g;Array.isArray(g)&&g.length>1?n.push(b(e,g[1])):n.push(b(e))}return{update(c){if((c&&c.length||0)!=n.length)throw new Error("You must not change the length of an actions array.");if(c)for(let g=0;g<c.length;g++){const b=n[g];if(b&&b.update){const E=c[g];Array.isArray(E)&&E.length>1?b.update(E[1]):b.update()}}},destroy(){for(let c=0;c<n.length;c++){const g=n[c];g&&g.destroy&&g.destroy()}}}}const{applyPassive:Ng}=bE,{matches:RE}=kv;function Xd(e,{ripple:t=!0,surface:n=!1,unbounded:c=!1,disabled:g=!1,color:b,active:E,rippleElement:a,eventTarget:U,activeTarget:W,addClass:ce=et=>e.classList.add(et),removeClass:oe=et=>e.classList.remove(et),addStyle:fe=(et,lt)=>e.style.setProperty(et,lt),initPromise:we=Promise.resolve()}={}){let et,lt=Eu("SMUI:addLayoutListener"),Ke,st=E,ut=U,kt=W;function Bt(){n?(ce("mdc-ripple-surface"),b==="primary"?(ce("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary")):b==="secondary"?(oe("smui-ripple-surface--primary"),ce("smui-ripple-surface--secondary")):(oe("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary"))):(oe("mdc-ripple-surface"),oe("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary")),et&&st!==E&&(st=E,E?et.activate():E===!1&&et.deactivate()),t&&!et?(et=new CE({addClass:ce,browserSupportsCssVars:()=>IE(window),computeBoundingRect:()=>(a||e).getBoundingClientRect(),containsEventTarget:Ge=>e.contains(Ge),deregisterDocumentInteractionHandler:(Ge,ni)=>document.documentElement.removeEventListener(Ge,ni,Ng()),deregisterInteractionHandler:(Ge,ni)=>(U||e).removeEventListener(Ge,ni,Ng()),deregisterResizeHandler:Ge=>window.removeEventListener("resize",Ge),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>E??RE(W||e,":active"),isSurfaceDisabled:()=>!!g,isUnbounded:()=>!!c,registerDocumentInteractionHandler:(Ge,ni)=>document.documentElement.addEventListener(Ge,ni,Ng()),registerInteractionHandler:(Ge,ni)=>(U||e).addEventListener(Ge,ni,Ng()),registerResizeHandler:Ge=>window.addEventListener("resize",Ge),removeClass:oe,updateCssVariable:fe}),we.then(()=>{et&&(et.init(),et.setUnbounded(c))})):et&&!t&&we.then(()=>{et&&(et.destroy(),et=void 0)}),et&&(ut!==U||kt!==W)&&(ut=U,kt=W,et.destroy(),requestAnimationFrame(()=>{et&&(et.init(),et.setUnbounded(c))})),!t&&c&&ce("mdc-ripple-upgraded--unbounded")}Bt(),lt&&(Ke=lt(Rt));function Rt(){et&&et.layout()}return{update(Ge){({ripple:t,surface:n,unbounded:c,disabled:g,color:b,active:E,rippleElement:a,eventTarget:U,activeTarget:W,addClass:ce,removeClass:oe,addStyle:fe,initPromise:we}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:ni=>e.classList.add(ni),removeClass:ni=>e.classList.remove(ni),addStyle:(ni,it)=>e.style.setProperty(ni,it),initPromise:Promise.resolve()},Ge)),Bt()},destroy(){et&&(et.destroy(),et=void 0,oe("mdc-ripple-surface"),oe("smui-ripple-surface--primary"),oe("smui-ripple-surface--secondary")),Ke&&Ke()}}}const{document:FE}=KI;function OE(e){let t,n,c,g,b,E,a,U;const W=e[34].default,ce=nu(W,e,e[33],null);let oe=[{class:c=Ss({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})},{style:g=Object.entries(e[9]).map(X2).concat([e[2]]).join(" ")},{role:"dialog"},e[12]],fe={};for(let we=0;we<oe.length;we+=1)fe=gr(fe,oe[we]);return{c(){t=Or(),n=qn("div"),ce&&ce.c(),this.h()},l(we){t=Nr(we),n=Hn(we,"DIV",{class:!0,style:!0,role:!0});var et=Tn(n);ce&&ce.l(et),et.forEach(Ci),this.h()},h(){nl(n,fe)},m(we,et){Zn(we,t,et),Zn(we,n,et),ce&&ce.m(n,null),e[35](n),E=!0,a||(U=[Gl(FE.body,"click",e[11],!0),xo(b=pc.call(null,n,e[0])),xo(e[10].call(null,n)),Gl(n,"keydown",function(){Iu(e[7]&&e[7].handleKeydown.bind(e[7]))&&(e[7]&&e[7].handleKeydown.bind(e[7])).apply(this,arguments)})],a=!0)},p(we,et){e=we,ce&&ce.p&&(!E||et[1]&4)&&ru(ce,W,e,e[33],E?au(W,e[33],et,null):su(e[33]),null),nl(n,fe=ma(oe,[(!E||et[0]&314&&c!==(c=Ss({[e[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":e[4],"mdc-menu-surface--open":e[3],"smui-menu-surface--static":e[3],"mdc-menu-surface--fullwidth":e[5],...e[8]})))&&{class:c},(!E||et[0]&516&&g!==(g=Object.entries(e[9]).map(X2).concat([e[2]]).join(" ")))&&{style:g},{role:"dialog"},et[0]&4096&&e[12]])),b&&Iu(b.update)&&et[0]&1&&b.update.call(null,e[0])},i(we){E||(Ki(ce,we),E=!0)},o(we){gn(ce,we),E=!1},d(we){we&&(Ci(t),Ci(n)),ce&&ce.d(we),e[35](null),a=!1,Oh(U)}}}const X2=([e,t])=>`${e}: ${t};`;function NE(e,t,n){const c=["use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","isOpen","setOpen","setAbsolutePosition","setIsHoisted","isFixed","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t;var a,U,W;const ce=wc(vc());let{use:oe=[]}=t,{class:fe=""}=t,{style:we=""}=t,{static:et=!1}=t,{anchor:lt=!0}=t,{fixed:Ke=!1}=t,{open:st=et}=t,{managed:ut=!1}=t,{fullWidth:kt=!1}=t,{quickOpen:Bt=!1}=t,{anchorElement:Rt=void 0}=t,{anchorCorner:Ge=void 0}=t,{anchorMargin:ni={top:0,right:0,bottom:0,left:0}}=t,{maxHeight:it=0}=t,{horizontallyCenteredOnViewport:xt=!1}=t,{openBottomBias:_t=0}=t,{neverRestoreFocus:mt=!1}=t,bt,dt,nt={},pt={},at;fu("SMUI:list:role","menu"),fu("SMUI:list:item:role","menuitem");const Nt=Wd;Zc(()=>(n(7,dt=new s3({addClass:Dt,removeClass:ci,hasClass:Ft,hasAnchor:()=>!!Rt,notifyClose:()=>{ut||n(13,st=et),st||tu(bt,"SMUIMenuSurface:closed",void 0,void 0,!0)},notifyClosing:()=>{ut||n(13,st=et),st||tu(bt,"SMUIMenuSurface:closing",void 0,void 0,!0)},notifyOpen:()=>{ut||n(13,st=!0),st&&tu(bt,"SMUIMenuSurface:opened",void 0,void 0,!0)},notifyOpening:()=>{st||tu(bt,"SMUIMenuSurface:opening",void 0,void 0,!0)},isElementInContainer:Ei=>bt.contains(Ei),isRtl:()=>getComputedStyle(bt).getPropertyValue("direction")==="rtl",setTransformOrigin:Ei=>{n(9,pt["transform-origin"]=Ei,pt)},isFocused:()=>document.activeElement===bt,saveFocus:()=>{var Ei;at=(Ei=document.activeElement)!==null&&Ei!==void 0?Ei:void 0},restoreFocus:()=>{!mt&&(!bt||bt.contains(document.activeElement))&&at&&document.contains(at)&&"focus"in at&&at.focus()},getInnerDimensions:()=>({width:bt.offsetWidth,height:bt.offsetHeight}),getAnchorDimensions:()=>Rt?Rt.getBoundingClientRect():null,getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:Ei=>{n(9,pt.left="left"in Ei?`${Ei.left}px`:"",pt),n(9,pt.right="right"in Ei?`${Ei.right}px`:"",pt),n(9,pt.top="top"in Ei?`${Ei.top}px`:"",pt),n(9,pt.bottom="bottom"in Ei?`${Ei.bottom}px`:"",pt)},setMaxHeight:Ei=>{n(9,pt["max-height"]=Ei,pt)}})),tu(bt,"SMUIMenuSurface:mount",{get open(){return st},set open(Ei){n(13,st=Ei)},closeProgrammatic:bi}),dt.init(),()=>{var Ei;const Li=dt.isHoistedElement;dt.destroy(),Li&&((Ei=bt.parentNode)===null||Ei===void 0||Ei.removeChild(bt))})),bm(()=>{var hi;lt&&bt&&((hi=bt.parentElement)===null||hi===void 0||hi.classList.remove("mdc-menu-surface--anchor"))});function Ft(hi){return hi in nt?nt[hi]:Ti().classList.contains(hi)}function Dt(hi){nt[hi]||n(8,nt[hi]=!0,nt)}function ci(hi){(!(hi in nt)||nt[hi])&&n(8,nt[hi]=!1,nt)}function bi(hi){dt.close(hi),n(13,st=!1)}function ki(hi){dt&&st&&!ut&&dt.handleBodyClick(hi)}function Gi(){return st}function rn(hi){n(13,st=hi)}function $i(hi,Ei){return dt.setAbsolutePosition(hi,Ei)}function qi(hi){return dt.setIsHoisted(hi)}function sn(){return dt.isFixed()}function Ti(){return bt}function yi(hi){pa[hi?"unshift":"push"](()=>{bt=hi,n(6,bt)})}return e.$$set=hi=>{t=gr(gr({},t),tc(hi)),n(12,g=uo(t,c)),"use"in hi&&n(0,oe=hi.use),"class"in hi&&n(1,fe=hi.class),"style"in hi&&n(2,we=hi.style),"static"in hi&&n(3,et=hi.static),"anchor"in hi&&n(15,lt=hi.anchor),"fixed"in hi&&n(4,Ke=hi.fixed),"open"in hi&&n(13,st=hi.open),"managed"in hi&&n(16,ut=hi.managed),"fullWidth"in hi&&n(5,kt=hi.fullWidth),"quickOpen"in hi&&n(17,Bt=hi.quickOpen),"anchorElement"in hi&&n(14,Rt=hi.anchorElement),"anchorCorner"in hi&&n(18,Ge=hi.anchorCorner),"anchorMargin"in hi&&n(19,ni=hi.anchorMargin),"maxHeight"in hi&&n(20,it=hi.maxHeight),"horizontallyCenteredOnViewport"in hi&&n(21,xt=hi.horizontallyCenteredOnViewport),"openBottomBias"in hi&&n(22,_t=hi.openBottomBias),"neverRestoreFocus"in hi&&n(23,mt=hi.neverRestoreFocus),"$$scope"in hi&&n(33,E=hi.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073774656|e.$$.dirty[1]&3&&bt&&lt&&!(!(n(30,a=bt.parentElement)===null||a===void 0)&&a.classList.contains("mdc-menu-surface--anchor"))&&(n(31,U=bt.parentElement)===null||U===void 0||U.classList.add("mdc-menu-surface--anchor"),n(14,Rt=n(32,W=bt.parentElement)!==null&&W!==void 0?W:void 0)),e.$$.dirty[0]&8320&&dt&&dt.isOpen()!==st&&(st?dt.open():dt.close()),e.$$.dirty[0]&131200&&dt&&dt.setQuickOpen(Bt),e.$$.dirty[0]&144&&dt&&dt.setFixedPosition(Ke),e.$$.dirty[0]&1048704&&dt&&dt.setMaxHeight(it),e.$$.dirty[0]&2097280&&dt&&dt.setIsHorizontallyCenteredOnViewport(xt),e.$$.dirty[0]&262272&&dt&&Ge!=null&&(typeof Ge=="string"?dt.setAnchorCorner(Nt[Ge]):dt.setAnchorCorner(Ge)),e.$$.dirty[0]&524416&&dt&&dt.setAnchorMargin(ni),e.$$.dirty[0]&4194432&&dt&&dt.setOpenBottomBias(_t)},[oe,fe,we,et,Ke,kt,bt,dt,nt,pt,ce,ki,g,st,Rt,lt,ut,Bt,Ge,ni,it,xt,_t,mt,Gi,rn,$i,qi,sn,Ti,a,U,W,E,b,yi]}class VE extends Lo{constructor(t){super(),Bo(this,t,NE,OE,co,{use:0,class:1,style:2,static:3,anchor:15,fixed:4,open:13,managed:16,fullWidth:5,quickOpen:17,anchorElement:14,anchorCorner:18,anchorMargin:19,maxHeight:20,horizontallyCenteredOnViewport:21,openBottomBias:22,neverRestoreFocus:23,isOpen:24,setOpen:25,setAbsolutePosition:26,setIsHoisted:27,isFixed:28,getElement:29},null,[-1,-1])}get isOpen(){return this.$$.ctx[24]}get setOpen(){return this.$$.ctx[25]}get setAbsolutePosition(){return this.$$.ctx[26]}get setIsHoisted(){return this.$$.ctx[27]}get isFixed(){return this.$$.ctx[28]}get getElement(){return this.$$.ctx[29]}}function UE(e,{addClass:t=c=>e.classList.add(c),removeClass:n=c=>e.classList.remove(c)}={}){return t("mdc-menu-surface--anchor"),{destroy(){n("mdc-menu-surface--anchor")}}}function GE(e){let t;const n=e[17].default,c=nu(n,e,e[22],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&4194304)&&ru(c,n,g,g[22],t?au(n,g[22],b,null):su(g[22]),null)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function qE(e){let t,n,c;const g=[{use:e[5]},{class:Ss({[e[1]]:!0,"mdc-menu":!0})},e[9]];function b(a){e[19](a)}let E={$$slots:{default:[GE]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)E=gr(E,g[a]);return e[0]!==void 0&&(E.open=e[0]),t=new VE({props:E}),e[18](t),pa.push(()=>N0(t,"open",b)),t.$on("SMUIMenuSurface:mount",e[7]),t.$on("SMUIList:mount",e[8]),t.$on("SMUIMenuSurface:opened",e[20]),t.$on("keydown",e[6]),t.$on("SMUIList:action",e[21]),{c(){Is(t.$$.fragment)},l(a){$s(t.$$.fragment,a)},m(a,U){Es(t,a,U),c=!0},p(a,[U]){const W=U&546?ma(g,[U&32&&{use:a[5]},U&2&&{class:Ss({[a[1]]:!0,"mdc-menu":!0})},U&512&&Fs(a[9])]):{};U&4194304&&(W.$$scope={dirty:U,ctx:a}),!n&&U&1&&(n=!0,W.open=a[0],O0(()=>n=!1)),t.$set(W)},i(a){c||(Ki(t.$$.fragment,a),c=!0)},o(a){gn(t.$$.fragment,a),c=!1},d(a){e[18](null),Cs(t,a)}}}function HE(e,t,n){let c;const g=["use","class","open","isOpen","setOpen","setDefaultFocusState","getSelectedIndex","getMenuSurface","getElement"];let b=uo(t,g),{$$slots:E={},$$scope:a}=t;const{closest:U}=kv,W=wc(vc());let{use:ce=[]}=t,{class:oe=""}=t,{open:fe=!1}=t,we,et,lt,Ke;Zc(()=>(n(3,et=new mE({addClassToElementAtIndex:(nt,pt)=>{Ke.addClassForElementIndex(nt,pt)},removeClassFromElementAtIndex:(nt,pt)=>{Ke.removeClassForElementIndex(nt,pt)},addAttributeToElementAtIndex:(nt,pt,at)=>{Ke.setAttributeForElementIndex(nt,pt,at)},removeAttributeFromElementAtIndex:(nt,pt)=>{Ke.removeAttributeForElementIndex(nt,pt)},getAttributeFromElementAtIndex:(nt,pt)=>Ke.getAttributeFromElementIndex(nt,pt),elementContainsClass:(nt,pt)=>nt.classList.contains(pt),closeSurface:nt=>{lt.closeProgrammatic(nt),tu(xt(),"SMUIMenu:closedProgrammatically")},getElementIndex:nt=>Ke.getOrderedList().map(pt=>pt.element).indexOf(nt),notifySelected:nt=>tu(xt(),"SMUIMenu:selected",{index:nt.index,item:Ke.getOrderedList()[nt.index].element},void 0,!0),getMenuItemCount:()=>Ke.items.length,focusItemAtIndex:nt=>Ke.focusItemAtIndex(nt),focusListRoot:()=>"focus"in Ke.element&&Ke.element.focus(),isSelectableItemAtIndex:nt=>!!U(Ke.getOrderedList()[nt].element,`.${am.MENU_SELECTION_GROUP}`),getSelectedSiblingOfItemAtIndex:nt=>{const pt=Ke.getOrderedList(),at=U(pt[nt].element,`.${am.MENU_SELECTION_GROUP}`),Nt=at==null?void 0:at.querySelector(`.${am.MENU_SELECTED_LIST_ITEM}`);return Nt?pt.map(Ft=>Ft.element).indexOf(Nt):-1}})),tu(xt(),"SMUIMenu:mount",et),et.init(),()=>{et.destroy()}));function st(nt){et&&et.handleKeydown(nt)}function ut(nt){lt||(lt=nt.detail)}function kt(nt){Ke||n(4,Ke=nt.detail)}function Bt(){return fe}function Rt(nt){n(0,fe=nt)}function Ge(nt){et.setDefaultFocusState(nt)}function ni(){return et.getSelectedIndex()}function it(){return we}function xt(){return we.getElement()}function _t(nt){pa[nt?"unshift":"push"](()=>{we=nt,n(2,we)})}function mt(nt){fe=nt,n(0,fe)}const bt=()=>et&&et.handleMenuSurfaceOpened(),dt=nt=>et&&et.handleItemAction(Ke.getOrderedList()[nt.detail.index].element);return e.$$set=nt=>{t=gr(gr({},t),tc(nt)),n(9,b=uo(t,g)),"use"in nt&&n(10,ce=nt.use),"class"in nt&&n(1,oe=nt.class),"open"in nt&&n(0,fe=nt.open),"$$scope"in nt&&n(22,a=nt.$$scope)},e.$$.update=()=>{e.$$.dirty&1024&&n(5,c=[W,...ce])},[fe,oe,we,et,Ke,c,st,ut,kt,b,ce,Bt,Rt,Ge,ni,it,xt,E,_t,mt,bt,dt,a]}class jE extends Lo{constructor(t){super(),Bo(this,t,HE,qE,co,{use:10,class:1,open:0,isOpen:11,setOpen:12,setDefaultFocusState:13,getSelectedIndex:14,getMenuSurface:15,getElement:16})}get isOpen(){return this.$$.ctx[11]}get setOpen(){return this.$$.ctx[12]}get setDefaultFocusState(){return this.$$.ctx[13]}get getSelectedIndex(){return this.$$.ctx[14]}get getMenuSurface(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}}function ZE(e){let t;const n=e[10].default,c=nu(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&4096)&&ru(c,n,g,g[12],t?au(n,g[12],b,null):su(g[12]),null)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function QE(e){let t,n,c;const g=[{tag:e[3]},{use:[e[5],...e[0]]},{class:Ss({[e[1]]:!0,"mdc-button__label":e[6]==="button","mdc-fab__label":e[6]==="fab","mdc-tab__text-label":e[6]==="tab","mdc-image-list__label":e[6]==="image-list","mdc-snackbar__label":e[6]==="snackbar","mdc-banner__text":e[6]==="banner","mdc-segmented-button__label":e[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":e[6]==="data-table:pagination","mdc-data-table__header-cell-label":e[6]==="data-table:sortable-header-cell"})},e[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:e[7]},e[8]];var b=e[2];function E(a,U){let W={$$slots:{default:[ZE]},$$scope:{ctx:a}};if(U!==void 0&&U&491)W=ma(g,[U&8&&{tag:a[3]},U&33&&{use:[a[5],...a[0]]},U&66&&{class:Ss({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},U&64&&Fs(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),U&128&&{tabindex:a[7]},U&256&&Fs(a[8])]);else for(let ce=0;ce<g.length;ce+=1)W=gr(W,g[ce]);return{props:W}}return b&&(t=JA(b,E(e)),e[11](t)),{c(){t&&Is(t.$$.fragment),n=gs()},l(a){t&&$s(t.$$.fragment,a),n=gs()},m(a,U){t&&Es(t,a,U),Zn(a,n,U),c=!0},p(a,[U]){if(U&4&&b!==(b=a[2])){if(t){fl();const W=t;gn(W.$$.fragment,1,0,()=>{Cs(W,1)}),dl()}b?(t=JA(b,E(a,U)),a[11](t),Is(t.$$.fragment),Ki(t.$$.fragment,1),Es(t,n.parentNode,n)):t=null}else if(b){const W=U&491?ma(g,[U&8&&{tag:a[3]},U&33&&{use:[a[5],...a[0]]},U&66&&{class:Ss({[a[1]]:!0,"mdc-button__label":a[6]==="button","mdc-fab__label":a[6]==="fab","mdc-tab__text-label":a[6]==="tab","mdc-image-list__label":a[6]==="image-list","mdc-snackbar__label":a[6]==="snackbar","mdc-banner__text":a[6]==="banner","mdc-segmented-button__label":a[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":a[6]==="data-table:pagination","mdc-data-table__header-cell-label":a[6]==="data-table:sortable-header-cell"})},U&64&&Fs(a[6]==="snackbar"?{"aria-atomic":"false"}:{}),U&128&&{tabindex:a[7]},U&256&&Fs(a[8])]):{};U&4096&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Ki(t.$$.fragment,a),c=!0)},o(a){t&&gn(t.$$.fragment,a),c=!1},d(a){a&&Ci(n),e[11](null),t&&Cs(t,a)}}}function WE(e,t,n){const c=["use","class","component","tag","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t;const a=wc(vc());let{use:U=[]}=t,{class:W=""}=t,ce,{component:oe=ef}=t,{tag:fe=oe===ef?"span":void 0}=t;const we=Eu("SMUI:label:context"),et=Eu("SMUI:label:tabindex");function lt(){return ce.getElement()}function Ke(st){pa[st?"unshift":"push"](()=>{ce=st,n(4,ce)})}return e.$$set=st=>{t=gr(gr({},t),tc(st)),n(8,g=uo(t,c)),"use"in st&&n(0,U=st.use),"class"in st&&n(1,W=st.class),"component"in st&&n(2,oe=st.component),"tag"in st&&n(3,fe=st.tag),"$$scope"in st&&n(12,E=st.$$scope)},[U,W,oe,fe,ce,a,we,et,g,lt,b,Ke,E]}class XE extends Lo{constructor(t){super(),Bo(this,t,WE,QE,co,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function YE(e){let t=e[1],n,c,g=e[1]&&k1(e);return{c(){g&&g.c(),n=gs()},l(b){g&&g.l(b),n=gs()},m(b,E){g&&g.m(b,E),Zn(b,n,E),c=!0},p(b,E){b[1]?t?co(t,b[1])?(g.d(1),g=k1(b),t=b[1],g.c(),g.m(n.parentNode,n)):g.p(b,E):(g=k1(b),t=b[1],g.c(),g.m(n.parentNode,n)):t&&(g.d(1),g=null,t=b[1])},i(b){c||(Ki(g,b),c=!0)},o(b){gn(g,b),c=!1},d(b){b&&Ci(n),g&&g.d(b)}}}function $E(e){let t=e[1],n,c=e[1]&&M1(e);return{c(){c&&c.c(),n=gs()},l(g){c&&c.l(g),n=gs()},m(g,b){c&&c.m(g,b),Zn(g,n,b)},p(g,b){g[1]?t?co(t,g[1])?(c.d(1),c=M1(g),t=g[1],c.c(),c.m(n.parentNode,n)):c.p(g,b):(c=M1(g),t=g[1],c.c(),c.m(n.parentNode,n)):t&&(c.d(1),c=null,t=g[1])},i:lo,o:lo,d(g){g&&Ci(n),c&&c.d(g)}}}function KE(e){let t,n,c,g,b;const E=e[8].default,a=nu(E,e,e[7],null);let U=[e[5]],W={};for(let ce=0;ce<U.length;ce+=1)W=gr(W,U[ce]);return{c(){t=Ba("svg"),a&&a.c(),this.h()},l(ce){t=za(ce,"svg",{});var oe=Tn(t);a&&a.l(oe),oe.forEach(Ci),this.h()},h(){A_(t,W)},m(ce,oe){Zn(ce,t,oe),a&&a.m(t,null),e[9](t),c=!0,g||(b=[xo(n=pc.call(null,t,e[0])),xo(e[4].call(null,t))],g=!0)},p(ce,oe){a&&a.p&&(!c||oe&128)&&ru(a,E,ce,ce[7],c?au(E,ce[7],oe,null):su(ce[7]),null),A_(t,W=ma(U,[oe&32&&ce[5]])),n&&Iu(n.update)&&oe&1&&n.update.call(null,ce[0])},i(ce){c||(Ki(a,ce),c=!0)},o(ce){gn(a,ce),c=!1},d(ce){ce&&Ci(t),a&&a.d(ce),e[9](null),g=!1,Oh(b)}}}function k1(e){let t,n,c,g,b;const E=e[8].default,a=nu(E,e,e[7],null);let U=[e[5]],W={};for(let ce=0;ce<U.length;ce+=1)W=gr(W,U[ce]);return{c(){t=qn(e[1]),a&&a.c(),this.h()},l(ce){t=Hn(ce,(e[1]||"null").toUpperCase(),{});var oe=Tn(t);a&&a.l(oe),oe.forEach(Ci),this.h()},h(){f_(e[1])(t,W)},m(ce,oe){Zn(ce,t,oe),a&&a.m(t,null),e[11](t),c=!0,g||(b=[xo(n=pc.call(null,t,e[0])),xo(e[4].call(null,t))],g=!0)},p(ce,oe){a&&a.p&&(!c||oe&128)&&ru(a,E,ce,ce[7],c?au(E,ce[7],oe,null):su(ce[7]),null),f_(ce[1])(t,W=ma(U,[oe&32&&ce[5]])),n&&Iu(n.update)&&oe&1&&n.update.call(null,ce[0])},i(ce){c||(Ki(a,ce),c=!0)},o(ce){gn(a,ce),c=!1},d(ce){ce&&Ci(t),a&&a.d(ce),e[11](null),g=!1,Oh(b)}}}function M1(e){let t,n,c,g,b=[e[5]],E={};for(let a=0;a<b.length;a+=1)E=gr(E,b[a]);return{c(){t=qn(e[1]),this.h()},l(a){t=Hn(a,(e[1]||"null").toUpperCase(),{}),Tn(t).forEach(Ci),this.h()},h(){f_(e[1])(t,E)},m(a,U){Zn(a,t,U),e[10](t),c||(g=[xo(n=pc.call(null,t,e[0])),xo(e[4].call(null,t))],c=!0)},p(a,U){f_(a[1])(t,E=ma(b,[U&32&&a[5]])),n&&Iu(n.update)&&U&1&&n.update.call(null,a[0])},d(a){a&&Ci(t),e[10](null),c=!1,Oh(g)}}}function JE(e){let t,n,c,g;const b=[KE,$E,YE],E=[];function a(U,W){return U[1]==="svg"?0:U[3]?1:2}return t=a(e),n=E[t]=b[t](e),{c(){n.c(),c=gs()},l(U){n.l(U),c=gs()},m(U,W){E[t].m(U,W),Zn(U,c,W),g=!0},p(U,[W]){let ce=t;t=a(U),t===ce?E[t].p(U,W):(fl(),gn(E[ce],1,1,()=>{E[ce]=null}),dl(),n=E[t],n?n.p(U,W):(n=E[t]=b[t](U),n.c()),Ki(n,1),n.m(c.parentNode,c))},i(U){g||(Ki(n),g=!0)},o(U){gn(n),g=!1},d(U){U&&Ci(c),E[t].d(U)}}}function eC(e,t,n){let c;const g=["use","tag","getElement"];let b=uo(t,g),{$$slots:E={},$$scope:a}=t,{use:U=[]}=t,{tag:W}=t;const ce=wc(vc());let oe;function fe(){return oe}function we(Ke){pa[Ke?"unshift":"push"](()=>{oe=Ke,n(2,oe)})}function et(Ke){pa[Ke?"unshift":"push"](()=>{oe=Ke,n(2,oe)})}function lt(Ke){pa[Ke?"unshift":"push"](()=>{oe=Ke,n(2,oe)})}return e.$$set=Ke=>{t=gr(gr({},t),tc(Ke)),n(5,b=uo(t,g)),"use"in Ke&&n(0,U=Ke.use),"tag"in Ke&&n(1,W=Ke.tag),"$$scope"in Ke&&n(7,a=Ke.$$scope)},e.$$.update=()=>{e.$$.dirty&2&&n(3,c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(W)>-1)},[U,W,oe,c,ce,b,fe,a,E,we,et,lt]}class ef extends Lo{constructor(t){super(),Bo(this,t,eC,JE,co,{use:0,tag:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}function tC(e){let t;const n=e[11].default,c=nu(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&8192)&&ru(c,n,g,g[13],t?au(n,g[13],b,null):su(g[13]),null)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function iC(e){let t,n,c;const g=[{tag:e[3]},{use:[e[8],...e[0]]},{class:Ss({[e[1]]:!0,[e[6]]:!0,...e[5]})},e[7],e[9]];var b=e[2];function E(a,U){let W={$$slots:{default:[tC]},$$scope:{ctx:a}};if(U!==void 0&&U&1003)W=ma(g,[U&8&&{tag:a[3]},U&257&&{use:[a[8],...a[0]]},U&98&&{class:Ss({[a[1]]:!0,[a[6]]:!0,...a[5]})},U&128&&Fs(a[7]),U&512&&Fs(a[9])]);else for(let ce=0;ce<g.length;ce+=1)W=gr(W,g[ce]);return{props:W}}return b&&(t=JA(b,E(e)),e[12](t)),{c(){t&&Is(t.$$.fragment),n=gs()},l(a){t&&$s(t.$$.fragment,a),n=gs()},m(a,U){t&&Es(t,a,U),Zn(a,n,U),c=!0},p(a,[U]){if(U&4&&b!==(b=a[2])){if(t){fl();const W=t;gn(W.$$.fragment,1,0,()=>{Cs(W,1)}),dl()}b?(t=JA(b,E(a,U)),a[12](t),Is(t.$$.fragment),Ki(t.$$.fragment,1),Es(t,n.parentNode,n)):t=null}else if(b){const W=U&1003?ma(g,[U&8&&{tag:a[3]},U&257&&{use:[a[8],...a[0]]},U&98&&{class:Ss({[a[1]]:!0,[a[6]]:!0,...a[5]})},U&128&&Fs(a[7]),U&512&&Fs(a[9])]):{};U&8192&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Ki(t.$$.fragment,a),c=!0)},o(a){t&&gn(t.$$.fragment,a),c=!1},d(a){a&&Ci(n),e[12](null),t&&Cs(t,a)}}}const $f={component:ef,tag:"div",class:"",classMap:{},contexts:{},props:{}};function nC(e,t,n){const c=["use","class","component","tag","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t,{use:a=[]}=t,{class:U=""}=t,W;const ce=$f.class,oe={},fe=[],we=$f.contexts,et=$f.props;let{component:lt=$f.component}=t,{tag:Ke=lt===ef?$f.tag:void 0}=t;Object.entries($f.classMap).forEach(([Bt,Rt])=>{const Ge=Eu(Rt);Ge&&"subscribe"in Ge&&fe.push(Ge.subscribe(ni=>{n(5,oe[Bt]=ni,oe)}))});const st=wc(vc());for(let Bt in we)we.hasOwnProperty(Bt)&&fu(Bt,we[Bt]);bm(()=>{for(const Bt of fe)Bt()});function ut(){return W.getElement()}function kt(Bt){pa[Bt?"unshift":"push"](()=>{W=Bt,n(4,W)})}return e.$$set=Bt=>{t=gr(gr({},t),tc(Bt)),n(9,g=uo(t,c)),"use"in Bt&&n(0,a=Bt.use),"class"in Bt&&n(1,U=Bt.class),"component"in Bt&&n(2,lt=Bt.component),"tag"in Bt&&n(3,Ke=Bt.tag),"$$scope"in Bt&&n(13,E=Bt.$$scope)},[a,U,lt,Ke,W,oe,ce,et,st,g,ut,b,kt,E]}class rC extends Lo{constructor(t){super(),Bo(this,t,nC,iC,co,{use:0,class:1,component:2,tag:3,getElement:10})}get getElement(){return this.$$.ctx[10]}}const Y2=Object.assign({},$f);function up(e){return new Proxy(rC,{construct:function(t,n){return Object.assign($f,Y2,e),new t(...n)},get:function(t,n){return Object.assign($f,Y2,e),t[n]}})}function sC(e){let t;const n=e[42].default,c=nu(n,e,e[44],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b[1]&8192)&&ru(c,n,g,g[44],t?au(n,g[44],b,null):su(g[44]),null)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function aC(e){let t,n,c;const g=[{tag:e[13]},{use:[e[16],...e[0]]},{class:Ss({[e[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":e[2],"mdc-deprecated-list--dense":e[3],"mdc-deprecated-list--textual-list":e[4],"mdc-deprecated-list--avatar-list":e[5]||e[17],"mdc-deprecated-list--icon-list":e[6],"mdc-deprecated-list--image-list":e[7],"mdc-deprecated-list--thumbnail-list":e[8],"mdc-deprecated-list--video-list":e[9],"mdc-deprecated-list--two-line":e[10],"smui-list--three-line":e[11]&&!e[10]})},{role:e[15]},e[25]];var b=e[12];function E(a,U){let W={$$slots:{default:[sC]},$$scope:{ctx:a}};if(U!==void 0&&U[0]&33796095)W=ma(g,[U[0]&8192&&{tag:a[13]},U[0]&65537&&{use:[a[16],...a[0]]},U[0]&135166&&{class:Ss({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},U[0]&32768&&{role:a[15]},U[0]&33554432&&Fs(a[25])]);else for(let ce=0;ce<g.length;ce+=1)W=gr(W,g[ce]);return{props:W}}return b&&(t=JA(b,E(e)),e[43](t),t.$on("keydown",e[20]),t.$on("focusin",e[21]),t.$on("focusout",e[22]),t.$on("click",e[23]),t.$on("SMUIListItem:mount",e[18]),t.$on("SMUIListItem:unmount",e[19]),t.$on("SMUI:action",e[24])),{c(){t&&Is(t.$$.fragment),n=gs()},l(a){t&&$s(t.$$.fragment,a),n=gs()},m(a,U){t&&Es(t,a,U),Zn(a,n,U),c=!0},p(a,U){if(U[0]&4096&&b!==(b=a[12])){if(t){fl();const W=t;gn(W.$$.fragment,1,0,()=>{Cs(W,1)}),dl()}b?(t=JA(b,E(a,U)),a[43](t),t.$on("keydown",a[20]),t.$on("focusin",a[21]),t.$on("focusout",a[22]),t.$on("click",a[23]),t.$on("SMUIListItem:mount",a[18]),t.$on("SMUIListItem:unmount",a[19]),t.$on("SMUI:action",a[24]),Is(t.$$.fragment),Ki(t.$$.fragment,1),Es(t,n.parentNode,n)):t=null}else if(b){const W=U[0]&33796095?ma(g,[U[0]&8192&&{tag:a[13]},U[0]&65537&&{use:[a[16],...a[0]]},U[0]&135166&&{class:Ss({[a[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":a[2],"mdc-deprecated-list--dense":a[3],"mdc-deprecated-list--textual-list":a[4],"mdc-deprecated-list--avatar-list":a[5]||a[17],"mdc-deprecated-list--icon-list":a[6],"mdc-deprecated-list--image-list":a[7],"mdc-deprecated-list--thumbnail-list":a[8],"mdc-deprecated-list--video-list":a[9],"mdc-deprecated-list--two-line":a[10],"smui-list--three-line":a[11]&&!a[10]})},U[0]&32768&&{role:a[15]},U[0]&33554432&&Fs(a[25])]):{};U[1]&8192&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Ki(t.$$.fragment,a),c=!0)},o(a){t&&gn(t.$$.fragment,a),c=!1},d(a){a&&Ci(n),e[43](null),t&&Cs(t,a)}}}function oC(e,t,n){const c=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","focusItemAtIndex","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t;var a;const{closest:U,matches:W}=kv,ce=wc(vc());let{use:oe=[]}=t,{class:fe=""}=t,{nonInteractive:we=!1}=t,{dense:et=!1}=t,{textualList:lt=!1}=t,{avatarList:Ke=!1}=t,{iconList:st=!1}=t,{imageList:ut=!1}=t,{thumbnailList:kt=!1}=t,{videoList:Bt=!1}=t,{twoLine:Rt=!1}=t,{threeLine:Ge=!1}=t,{vertical:ni=!0}=t,{wrapFocus:it=(a=Eu("SMUI:list:wrapFocus"))!==null&&a!==void 0?a:!1}=t,{singleSelection:xt=!1}=t,{disabledItemsFocusable:_t=!1}=t,{selectedIndex:mt=-1}=t,{radioList:bt=!1}=t,{checkList:dt=!1}=t,{hasTypeahead:nt=!1}=t,pt,at,Nt=[],Ft=Eu("SMUI:list:role"),Dt=Eu("SMUI:list:nav");const ci=new WeakMap;let bi=Eu("SMUI:dialog:selection"),ki=Eu("SMUI:addLayoutListener"),Gi,{component:rn=ef}=t,{tag:$i=rn===ef?Dt?"nav":"ul":void 0}=t;fu("SMUI:list:nonInteractive",we),fu("SMUI:separator:context","list"),Ft||(xt?(Ft="listbox",fu("SMUI:list:item:role","option")):bt?(Ft="radiogroup",fu("SMUI:list:item:role","radio")):dt?(Ft="group",fu("SMUI:list:item:role","checkbox")):(Ft="list",fu("SMUI:list:item:role",void 0))),ki&&(Gi=ki(pr)),Zc(()=>{n(41,at=new dE({addClassForElementIndex:gi,focusItemAtIndex:k,getAttributeForElementIndex:(Ae,ve)=>{var Ie,Ee;return(Ee=(Ie=fn()[Ae])===null||Ie===void 0?void 0:Ie.getAttr(ve))!==null&&Ee!==void 0?Ee:null},getFocusedElementIndex:()=>document.activeElement?fn().map(Ae=>Ae.element).indexOf(document.activeElement):-1,getListItemCount:()=>Nt.length,getPrimaryTextAtIndex:fi,hasCheckboxAtIndex:Ae=>{var ve,Ie;return(Ie=(ve=fn()[Ae])===null||ve===void 0?void 0:ve.hasCheckbox)!==null&&Ie!==void 0?Ie:!1},hasRadioAtIndex:Ae=>{var ve,Ie;return(Ie=(ve=fn()[Ae])===null||ve===void 0?void 0:ve.hasRadio)!==null&&Ie!==void 0?Ie:!1},isCheckboxCheckedAtIndex:Ae=>{var ve;const Ie=fn()[Ae];return(ve=(Ie==null?void 0:Ie.hasCheckbox)&&Ie.checked)!==null&&ve!==void 0?ve:!1},isFocusInsideList:()=>pt!=null&&V()!==document.activeElement&&V().contains(document.activeElement),isRootFocused:()=>pt!=null&&document.activeElement===V(),listItemAtIndexHasClass:_n,notifyAction:Ae=>{n(26,mt=Ae),pt!=null&&tu(V(),"SMUIList:action",{index:Ae},void 0,!0)},notifySelectionChange:Ae=>{pt!=null&&tu(V(),"SMUIList:selectionChange",{changedIndices:Ae})},removeClassForElementIndex:mn,setAttributeForElementIndex:ti,setCheckedCheckboxOrRadioAtIndex:(Ae,ve)=>{fn()[Ae].checked=ve},setTabIndexForListItemChildren:(Ae,ve)=>{const Ie=fn()[Ae];Array.prototype.forEach.call(Ie.element.querySelectorAll("button:not(:disabled), a"),ze=>{ze.setAttribute("tabindex",ve)})}}));const te={get element(){return V()},get items(){return Nt},get typeaheadInProgress(){return at.isTypeaheadInProgress()},typeaheadMatchItem(Ae,ve){return at.typeaheadMatchItem(Ae,ve,!0)},getOrderedList:fn,focusItemAtIndex:k,addClassForElementIndex:gi,removeClassForElementIndex:mn,setAttributeForElementIndex:ti,removeAttributeForElementIndex:Mn,getAttributeFromElementIndex:ns,getPrimaryTextAtIndex:fi};return tu(V(),"SMUIList:mount",te),at.init(),at.layout(),()=>{at.destroy()}}),bm(()=>{Gi&&Gi()});function qi(te){Nt.push(te.detail),ci.set(te.detail.element,te.detail),xt&&te.detail.selected&&n(26,mt=ln(te.detail.element)),te.stopPropagation()}function sn(te){var Ae;const ve=(Ae=te.detail&&Nt.indexOf(te.detail))!==null&&Ae!==void 0?Ae:-1;ve!==-1&&(Nt.splice(ve,1),Nt=Nt,ci.delete(te.detail.element)),te.stopPropagation()}function Ti(te){at&&te.target&&at.handleKeydown(te,te.target.classList.contains("mdc-deprecated-list-item"),ln(te.target))}function yi(te){at&&te.target&&at.handleFocusIn(ln(te.target))}function hi(te){at&&te.target&&at.handleFocusOut(ln(te.target))}function Ei(te){at&&te.target&&at.handleClick(ln(te.target),!W(te.target,'input[type="checkbox"], input[type="radio"]'),te)}function Li(te){if(bt||dt){const Ae=ln(te.target);if(Ae!==-1){const ve=fn()[Ae];ve&&(bt&&!ve.checked||dt)&&(W(te.detail.target,'input[type="checkbox"], input[type="radio"]')||(ve.checked=!ve.checked),ve.activateRipple(),window.requestAnimationFrame(()=>{ve.deactivateRipple()}))}}}function fn(){return pt==null?[]:[...V().children].map(te=>ci.get(te)).filter(te=>te&&te._smui_list_item_accessor)}function _n(te,Ae){var ve;const Ie=fn()[te];return(ve=Ie&&Ie.hasClass(Ae))!==null&&ve!==void 0?ve:!1}function gi(te,Ae){const ve=fn()[te];ve&&ve.addClass(Ae)}function mn(te,Ae){const ve=fn()[te];ve&&ve.removeClass(Ae)}function ti(te,Ae,ve){const Ie=fn()[te];Ie&&Ie.addAttr(Ae,ve)}function Mn(te,Ae){const ve=fn()[te];ve&&ve.removeAttr(Ae)}function ns(te,Ae){const ve=fn()[te];return ve?ve.getAttr(Ae):null}function fi(te){var Ae;const ve=fn()[te];return(Ae=ve&&ve.getPrimaryText())!==null&&Ae!==void 0?Ae:""}function ln(te){const Ae=U(te,".mdc-deprecated-list-item, .mdc-deprecated-list");return Ae&&W(Ae,".mdc-deprecated-list-item")?fn().map(ve=>ve==null?void 0:ve.element).indexOf(Ae):-1}function pr(){return at.layout()}function On(te,Ae){return at.setEnabled(te,Ae)}function Qn(){return at.isTypeaheadInProgress()}function wn(){return at.getSelectedIndex()}function v(){return at.getFocusedItemIndex()}function k(te){const Ae=fn()[te];Ae&&"focus"in Ae.element&&Ae.element.focus()}function V(){return pt.getElement()}function $(te){pa[te?"unshift":"push"](()=>{pt=te,n(14,pt)})}return e.$$set=te=>{t=gr(gr({},t),tc(te)),n(25,g=uo(t,c)),"use"in te&&n(0,oe=te.use),"class"in te&&n(1,fe=te.class),"nonInteractive"in te&&n(2,we=te.nonInteractive),"dense"in te&&n(3,et=te.dense),"textualList"in te&&n(4,lt=te.textualList),"avatarList"in te&&n(5,Ke=te.avatarList),"iconList"in te&&n(6,st=te.iconList),"imageList"in te&&n(7,ut=te.imageList),"thumbnailList"in te&&n(8,kt=te.thumbnailList),"videoList"in te&&n(9,Bt=te.videoList),"twoLine"in te&&n(10,Rt=te.twoLine),"threeLine"in te&&n(11,Ge=te.threeLine),"vertical"in te&&n(27,ni=te.vertical),"wrapFocus"in te&&n(28,it=te.wrapFocus),"singleSelection"in te&&n(29,xt=te.singleSelection),"disabledItemsFocusable"in te&&n(30,_t=te.disabledItemsFocusable),"selectedIndex"in te&&n(26,mt=te.selectedIndex),"radioList"in te&&n(31,bt=te.radioList),"checkList"in te&&n(32,dt=te.checkList),"hasTypeahead"in te&&n(33,nt=te.hasTypeahead),"component"in te&&n(12,rn=te.component),"tag"in te&&n(13,$i=te.tag),"$$scope"in te&&n(44,E=te.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&134217728|e.$$.dirty[1]&1024&&at&&at.setVerticalOrientation(ni),e.$$.dirty[0]&268435456|e.$$.dirty[1]&1024&&at&&at.setWrapFocus(it),e.$$.dirty[1]&1028&&at&&at.setHasTypeahead(nt),e.$$.dirty[0]&536870912|e.$$.dirty[1]&1024&&at&&at.setSingleSelection(xt),e.$$.dirty[0]&1073741824|e.$$.dirty[1]&1024&&at&&at.setDisabledItemsFocusable(_t),e.$$.dirty[0]&603979776|e.$$.dirty[1]&1024&&at&&xt&&wn()!==mt&&at.setSelectedIndex(mt)},[oe,fe,we,et,lt,Ke,st,ut,kt,Bt,Rt,Ge,rn,$i,pt,Ft,ce,bi,qi,sn,Ti,yi,hi,Ei,Li,g,mt,ni,it,xt,_t,bt,dt,nt,pr,On,Qn,wn,v,k,V,at,b,$,E]}class lC extends Lo{constructor(t){super(),Bo(this,t,oC,aC,co,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:27,wrapFocus:28,singleSelection:29,disabledItemsFocusable:30,selectedIndex:26,radioList:31,checkList:32,hasTypeahead:33,component:12,tag:13,layout:34,setEnabled:35,getTypeaheadInProgress:36,getSelectedIndex:37,getFocusedItemIndex:38,focusItemAtIndex:39,getElement:40},null,[-1,-1])}get layout(){return this.$$.ctx[34]}get setEnabled(){return this.$$.ctx[35]}get getTypeaheadInProgress(){return this.$$.ctx[36]}get getSelectedIndex(){return this.$$.ctx[37]}get getFocusedItemIndex(){return this.$$.ctx[38]}get focusItemAtIndex(){return this.$$.ctx[39]}get getElement(){return this.$$.ctx[40]}}function $2(e){let t;return{c(){t=qn("span"),this.h()},l(n){t=Hn(n,"SPAN",{class:!0}),Tn(t).forEach(Ci),this.h()},h(){Fi(t,"class","mdc-deprecated-list-item__ripple")},m(n,c){Zn(n,t,c)},d(n){n&&Ci(t)}}}function uC(e){let t,n,c=e[7]&&$2();const g=e[34].default,b=nu(g,e,e[37],null);return{c(){c&&c.c(),t=gs(),b&&b.c()},l(E){c&&c.l(E),t=gs(),b&&b.l(E)},m(E,a){c&&c.m(E,a),Zn(E,t,a),b&&b.m(E,a),n=!0},p(E,a){E[7]?c||(c=$2(),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),b&&b.p&&(!n||a[1]&64)&&ru(b,g,E,E[37],n?au(g,E[37],a,null):su(E[37]),null)},i(E){n||(Ki(b,E),n=!0)},o(E){gn(b,E),n=!1},d(E){E&&Ci(t),c&&c.d(E),b&&b.d(E)}}}function cC(e){let t,n,c;const g=[{tag:e[14]},{use:[...e[6]?[]:[[Xd,{ripple:!e[16],unbounded:!1,color:(e[1]||e[0])&&e[5]==null?"primary":e[5],disabled:e[10],addClass:e[24],removeClass:e[25],addStyle:e[26]}]],e[22],...e[2]]},{class:Ss({[e[3]]:!0,"mdc-deprecated-list-item":!e[8],"mdc-deprecated-list-item__wrapper":e[8],"mdc-deprecated-list-item--activated":e[1],"mdc-deprecated-list-item--selected":e[0],"mdc-deprecated-list-item--disabled":e[10],"mdc-menu-item--selected":!e[23]&&e[9]==="menuitem"&&e[0],"smui-menu-item--non-interactive":e[6],...e[18]})},{style:Object.entries(e[19]).map(P1).concat([e[4]]).join(" ")},e[23]&&e[1]?{"aria-current":"page"}:{},!e[23]||e[8]?{role:e[9]}:{},!e[23]&&e[9]==="option"?{"aria-selected":e[0]?"true":"false"}:{},!e[23]&&(e[9]==="radio"||e[9]==="checkbox")?{"aria-checked":e[16]&&e[16].checked?"true":"false"}:{},e[23]?{}:{"aria-disabled":e[10]?"true":"false"},{"data-menu-item-skip-restore-focus":e[11]||void 0},{tabindex:e[21]},{href:e[12]},e[20],e[29]];var b=e[13];function E(a,U){let W={$$slots:{default:[uC]},$$scope:{ctx:a}};if(U!==void 0&&U[0]&670916479)W=ma(g,[U[0]&16384&&{tag:a[14]},U[0]&121701479&&{use:[...a[6]?[]:[[Xd,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},U[0]&8652619&&{class:Ss({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},U[0]&524304&&{style:Object.entries(a[19]).map(P1).concat([a[4]]).join(" ")},U[0]&8388610&&Fs(a[23]&&a[1]?{"aria-current":"page"}:{}),U[0]&8389376&&Fs(!a[23]||a[8]?{role:a[9]}:{}),U[0]&8389121&&Fs(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),U[0]&8454656&&Fs(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),U[0]&8389632&&Fs(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),U[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},U[0]&2097152&&{tabindex:a[21]},U[0]&4096&&{href:a[12]},U[0]&1048576&&Fs(a[20]),U[0]&536870912&&Fs(a[29])]);else for(let ce=0;ce<g.length;ce+=1)W=gr(W,g[ce]);return{props:W}}return b&&(t=JA(b,E(e)),e[35](t),t.$on("click",e[15]),t.$on("keydown",e[27]),t.$on("SMUIGenericInput:mount",e[28]),t.$on("SMUIGenericInput:unmount",e[36])),{c(){t&&Is(t.$$.fragment),n=gs()},l(a){t&&$s(t.$$.fragment,a),n=gs()},m(a,U){t&&Es(t,a,U),Zn(a,n,U),c=!0},p(a,U){if(U[0]&8192&&b!==(b=a[13])){if(t){fl();const W=t;gn(W.$$.fragment,1,0,()=>{Cs(W,1)}),dl()}b?(t=JA(b,E(a,U)),a[35](t),t.$on("click",a[15]),t.$on("keydown",a[27]),t.$on("SMUIGenericInput:mount",a[28]),t.$on("SMUIGenericInput:unmount",a[36]),Is(t.$$.fragment),Ki(t.$$.fragment,1),Es(t,n.parentNode,n)):t=null}else if(b){const W=U[0]&670916479?ma(g,[U[0]&16384&&{tag:a[14]},U[0]&121701479&&{use:[...a[6]?[]:[[Xd,{ripple:!a[16],unbounded:!1,color:(a[1]||a[0])&&a[5]==null?"primary":a[5],disabled:a[10],addClass:a[24],removeClass:a[25],addStyle:a[26]}]],a[22],...a[2]]},U[0]&8652619&&{class:Ss({[a[3]]:!0,"mdc-deprecated-list-item":!a[8],"mdc-deprecated-list-item__wrapper":a[8],"mdc-deprecated-list-item--activated":a[1],"mdc-deprecated-list-item--selected":a[0],"mdc-deprecated-list-item--disabled":a[10],"mdc-menu-item--selected":!a[23]&&a[9]==="menuitem"&&a[0],"smui-menu-item--non-interactive":a[6],...a[18]})},U[0]&524304&&{style:Object.entries(a[19]).map(P1).concat([a[4]]).join(" ")},U[0]&8388610&&Fs(a[23]&&a[1]?{"aria-current":"page"}:{}),U[0]&8389376&&Fs(!a[23]||a[8]?{role:a[9]}:{}),U[0]&8389121&&Fs(!a[23]&&a[9]==="option"?{"aria-selected":a[0]?"true":"false"}:{}),U[0]&8454656&&Fs(!a[23]&&(a[9]==="radio"||a[9]==="checkbox")?{"aria-checked":a[16]&&a[16].checked?"true":"false"}:{}),U[0]&8389632&&Fs(a[23]?{}:{"aria-disabled":a[10]?"true":"false"}),U[0]&2048&&{"data-menu-item-skip-restore-focus":a[11]||void 0},U[0]&2097152&&{tabindex:a[21]},U[0]&4096&&{href:a[12]},U[0]&1048576&&Fs(a[20]),U[0]&536870912&&Fs(a[29])]):{};U[0]&128|U[1]&64&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Ki(t.$$.fragment,a),c=!0)},o(a){t&&gn(t.$$.fragment,a),c=!1},d(a){a&&Ci(n),e[35](null),t&&Cs(t,a)}}}let hC=0;const P1=([e,t])=>`${e}: ${t};`;function AC(e,t,n){let c;const g=["use","class","style","color","nonInteractive","ripple","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","action","getPrimaryText","getElement"];let b=uo(t,g),{$$slots:E={},$$scope:a}=t;var U;const W=wc(vc());let ce=()=>{};function oe(gi){return gi===ce}let{use:fe=[]}=t,{class:we=""}=t,{style:et=""}=t,{color:lt=void 0}=t,{nonInteractive:Ke=(U=Eu("SMUI:list:nonInteractive"))!==null&&U!==void 0?U:!1}=t;fu("SMUI:list:nonInteractive",void 0);let{ripple:st=!Ke}=t,{wrapper:ut=!1}=t,{activated:kt=!1}=t,{role:Bt=ut?"presentation":Eu("SMUI:list:item:role")}=t;fu("SMUI:list:item:role",void 0);let{selected:Rt=!1}=t,{disabled:Ge=!1}=t,{skipRestoreFocus:ni=!1}=t,{tabindex:it=ce}=t,{inputId:xt="SMUI-form-field-list-"+hC++}=t,{href:_t=void 0}=t,mt,bt={},dt={},nt={},pt,at,Nt=Eu("SMUI:list:item:nav"),{component:Ft=ef}=t,{tag:Dt=Ft===ef?Nt?_t?"a":"span":"li":void 0}=t;fu("SMUI:generic:input:props",{id:xt}),fu("SMUI:separator:context",void 0),Zc(()=>{if(!Rt&&!Ke){let mn=!0,ti=mt.getElement();for(;ti.previousSibling;)if(ti=ti.previousSibling,ti.nodeType===1&&ti.classList.contains("mdc-deprecated-list-item")&&!ti.classList.contains("mdc-deprecated-list-item--disabled")){mn=!1;break}mn&&(at=window.requestAnimationFrame(()=>sn(ti)))}const gi={_smui_list_item_accessor:!0,get element(){return Li()},get selected(){return Rt},set selected(mn){n(0,Rt=mn)},hasClass:ci,addClass:bi,removeClass:ki,getAttr:rn,addAttr:$i,removeAttr:qi,getPrimaryText:Ei,get checked(){var mn;return(mn=pt&&pt.checked)!==null&&mn!==void 0?mn:!1},set checked(mn){pt&&n(16,pt.checked=!!mn,pt)},get hasCheckbox(){return!!(pt&&"_smui_checkbox_accessor"in pt)},get hasRadio(){return!!(pt&&"_smui_radio_accessor"in pt)},activateRipple(){pt&&pt.activateRipple()},deactivateRipple(){pt&&pt.deactivateRipple()},getValue(){return b.value},action:hi,get tabindex(){return c},set tabindex(mn){n(30,it=mn)},get disabled(){return Ge},get activated(){return kt},set activated(mn){n(1,kt=mn)}};return tu(Li(),"SMUIListItem:mount",gi),()=>{tu(Li(),"SMUIListItem:unmount",gi)}}),bm(()=>{at&&window.cancelAnimationFrame(at)});function ci(gi){return gi in bt?bt[gi]:Li().classList.contains(gi)}function bi(gi){bt[gi]||n(18,bt[gi]=!0,bt)}function ki(gi){(!(gi in bt)||bt[gi])&&n(18,bt[gi]=!1,bt)}function Gi(gi,mn){dt[gi]!=mn&&(mn===""||mn==null?(delete dt[gi],n(19,dt)):n(19,dt[gi]=mn,dt))}function rn(gi){var mn;return gi in nt?(mn=nt[gi])!==null&&mn!==void 0?mn:null:Li().getAttribute(gi)}function $i(gi,mn){nt[gi]!==mn&&n(20,nt[gi]=mn,nt)}function qi(gi){(!(gi in nt)||nt[gi]!=null)&&n(20,nt[gi]=void 0,nt)}function sn(gi){let mn=!0;for(;gi.nextElementSibling;)if(gi=gi.nextElementSibling,gi.nodeType===1&&gi.classList.contains("mdc-deprecated-list-item")){const ti=gi.attributes.getNamedItem("tabindex");if(ti&&ti.value==="0"){mn=!1;break}}mn&&n(21,c=0)}function Ti(gi){const mn=gi.key==="Enter",ti=gi.key==="Space";(mn||ti)&&hi(gi)}function yi(gi){("_smui_checkbox_accessor"in gi.detail||"_smui_radio_accessor"in gi.detail)&&n(16,pt=gi.detail)}function hi(gi){Ge||tu(Li(),"SMUI:action",gi)}function Ei(){var gi,mn,ti;const Mn=Li(),ns=Mn.querySelector(".mdc-deprecated-list-item__primary-text");if(ns)return(gi=ns.textContent)!==null&&gi!==void 0?gi:"";const fi=Mn.querySelector(".mdc-deprecated-list-item__text");return fi?(mn=fi.textContent)!==null&&mn!==void 0?mn:"":(ti=Mn.textContent)!==null&&ti!==void 0?ti:""}function Li(){return mt.getElement()}function fn(gi){pa[gi?"unshift":"push"](()=>{mt=gi,n(17,mt)})}const _n=()=>n(16,pt=void 0);return e.$$set=gi=>{t=gr(gr({},t),tc(gi)),n(29,b=uo(t,g)),"use"in gi&&n(2,fe=gi.use),"class"in gi&&n(3,we=gi.class),"style"in gi&&n(4,et=gi.style),"color"in gi&&n(5,lt=gi.color),"nonInteractive"in gi&&n(6,Ke=gi.nonInteractive),"ripple"in gi&&n(7,st=gi.ripple),"wrapper"in gi&&n(8,ut=gi.wrapper),"activated"in gi&&n(1,kt=gi.activated),"role"in gi&&n(9,Bt=gi.role),"selected"in gi&&n(0,Rt=gi.selected),"disabled"in gi&&n(10,Ge=gi.disabled),"skipRestoreFocus"in gi&&n(11,ni=gi.skipRestoreFocus),"tabindex"in gi&&n(30,it=gi.tabindex),"inputId"in gi&&n(31,xt=gi.inputId),"href"in gi&&n(12,_t=gi.href),"component"in gi&&n(13,Ft=gi.component),"tag"in gi&&n(14,Dt=gi.tag),"$$scope"in gi&&n(37,a=gi.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1073808449&&n(21,c=oe(it)?!Ke&&!Ge&&(Rt||pt&&pt.checked)?0:-1:it)},[Rt,kt,fe,we,et,lt,Ke,st,ut,Bt,Ge,ni,_t,Ft,Dt,hi,pt,mt,bt,dt,nt,c,W,Nt,bi,ki,Gi,Ti,yi,b,it,xt,Ei,Li,E,fn,_n,a]}class fC extends Lo{constructor(t){super(),Bo(this,t,AC,cC,co,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,wrapper:8,activated:1,role:9,selected:0,disabled:10,skipRestoreFocus:11,tabindex:30,inputId:31,href:12,component:13,tag:14,action:15,getPrimaryText:32,getElement:33},null,[-1,-1])}get action(){return this.$$.ctx[15]}get getPrimaryText(){return this.$$.ctx[32]}get getElement(){return this.$$.ctx[33]}}up({class:"mdc-deprecated-list-item__text",tag:"span"});up({class:"mdc-deprecated-list-item__primary-text",tag:"span"});up({class:"mdc-deprecated-list-item__secondary-text",tag:"span"});function dC(e){let t,n,c,g,b,E;const a=e[8].default,U=nu(a,e,e[7],null);let W=[{class:n=Ss({[e[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":e[4]})},e[5]],ce={};for(let oe=0;oe<W.length;oe+=1)ce=gr(ce,W[oe]);return{c(){t=qn("span"),U&&U.c(),this.h()},l(oe){t=Hn(oe,"SPAN",{class:!0});var fe=Tn(t);U&&U.l(fe),fe.forEach(Ci),this.h()},h(){nl(t,ce)},m(oe,fe){Zn(oe,t,fe),U&&U.m(t,null),e[9](t),g=!0,b||(E=[xo(c=pc.call(null,t,e[0])),xo(e[3].call(null,t))],b=!0)},p(oe,[fe]){U&&U.p&&(!g||fe&128)&&ru(U,a,oe,oe[7],g?au(a,oe[7],fe,null):su(oe[7]),null),nl(t,ce=ma(W,[(!g||fe&2&&n!==(n=Ss({[oe[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":oe[4]})))&&{class:n},fe&32&&oe[5]])),c&&Iu(c.update)&&fe&1&&c.update.call(null,oe[0])},i(oe){g||(Ki(U,oe),g=!0)},o(oe){gn(U,oe),g=!1},d(oe){oe&&Ci(t),U&&U.d(oe),e[9](null),b=!1,Oh(E)}}}function pC(e,t,n){const c=["use","class","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t;const a=wc(vc());let{use:U=[]}=t,{class:W=""}=t,ce,oe=Eu("SMUI:list:graphic:menu-selection-group");function fe(){return ce}function we(et){pa[et?"unshift":"push"](()=>{ce=et,n(2,ce)})}return e.$$set=et=>{t=gr(gr({},t),tc(et)),n(5,g=uo(t,c)),"use"in et&&n(0,U=et.use),"class"in et&&n(1,W=et.class),"$$scope"in et&&n(7,E=et.$$scope)},[U,W,ce,a,oe,g,fe,E,b,we]}class mC extends Lo{constructor(t){super(),Bo(this,t,pC,dC,co,{use:0,class:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}up({class:"mdc-deprecated-list-item__meta",tag:"span"});up({class:"mdc-deprecated-list-group",tag:"div"});up({class:"mdc-deprecated-list-group__subheader",tag:"h3"});up({class:"mdc-menu__selection-group-icon",component:mC});function gC(e){let t,n,c,g,b,E,a,U;const W=e[22].default,ce=nu(W,e,e[21],null);let oe=[{class:n=Ss({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(J2).concat([e[4]]).join(" ")},{for:g=e[5]||(e[11]?e[11].id:void 0)},e[12]],fe={};for(let we=0;we<oe.length;we+=1)fe=gr(fe,oe[we]);return{c(){t=qn("label"),ce&&ce.c(),this.h()},l(we){t=Hn(we,"LABEL",{class:!0,style:!0,for:!0});var et=Tn(t);ce&&ce.l(et),et.forEach(Ci),this.h()},h(){nl(t,fe)},m(we,et){Zn(we,t,et),ce&&ce.m(t,null),e[24](t),E=!0,a||(U=[xo(b=pc.call(null,t,e[2])),xo(e[10].call(null,t))],a=!0)},p(we,et){ce&&ce.p&&(!E||et&2097152)&&ru(ce,W,we,we[21],E?au(W,we[21],et,null):su(we[21]),null),nl(t,fe=ma(oe,[(!E||et&267&&n!==(n=Ss({[we[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":we[0],"mdc-floating-label--required":we[1],...we[8]})))&&{class:n},(!E||et&528&&c!==(c=Object.entries(we[9]).map(J2).concat([we[4]]).join(" ")))&&{style:c},(!E||et&32&&g!==(g=we[5]||(we[11]?we[11].id:void 0)))&&{for:g},et&4096&&we[12]])),b&&Iu(b.update)&&et&4&&b.update.call(null,we[2])},i(we){E||(Ki(ce,we),E=!0)},o(we){gn(ce,we),E=!1},d(we){we&&Ci(t),ce&&ce.d(we),e[24](null),a=!1,Oh(U)}}}function _C(e){let t,n,c,g,b,E,a;const U=e[22].default,W=nu(U,e,e[21],null);let ce=[{class:n=Ss({[e[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":e[0],"mdc-floating-label--required":e[1],...e[8]})},{style:c=Object.entries(e[9]).map(K2).concat([e[4]]).join(" ")},e[12]],oe={};for(let fe=0;fe<ce.length;fe+=1)oe=gr(oe,ce[fe]);return{c(){t=qn("span"),W&&W.c(),this.h()},l(fe){t=Hn(fe,"SPAN",{class:!0,style:!0});var we=Tn(t);W&&W.l(we),we.forEach(Ci),this.h()},h(){nl(t,oe)},m(fe,we){Zn(fe,t,we),W&&W.m(t,null),e[23](t),b=!0,E||(a=[xo(g=pc.call(null,t,e[2])),xo(e[10].call(null,t))],E=!0)},p(fe,we){W&&W.p&&(!b||we&2097152)&&ru(W,U,fe,fe[21],b?au(U,fe[21],we,null):su(fe[21]),null),nl(t,oe=ma(ce,[(!b||we&267&&n!==(n=Ss({[fe[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":fe[0],"mdc-floating-label--required":fe[1],...fe[8]})))&&{class:n},(!b||we&528&&c!==(c=Object.entries(fe[9]).map(K2).concat([fe[4]]).join(" ")))&&{style:c},we&4096&&fe[12]])),g&&Iu(g.update)&&we&4&&g.update.call(null,fe[2])},i(fe){b||(Ki(W,fe),b=!0)},o(fe){gn(W,fe),b=!1},d(fe){fe&&Ci(t),W&&W.d(fe),e[23](null),E=!1,Oh(a)}}}function yC(e){let t,n,c,g;const b=[_C,gC],E=[];function a(U,W){return U[6]?0:1}return t=a(e),n=E[t]=b[t](e),{c(){n.c(),c=gs()},l(U){n.l(U),c=gs()},m(U,W){E[t].m(U,W),Zn(U,c,W),g=!0},p(U,[W]){let ce=t;t=a(U),t===ce?E[t].p(U,W):(fl(),gn(E[ce],1,1,()=>{E[ce]=null}),dl(),n=E[t],n?n.p(U,W):(n=E[t]=b[t](U),n.c()),Ki(n,1),n.m(c.parentNode,c))},i(U){g||(Ki(n),g=!0)},o(U){gn(n),g=!1},d(U){U&&Ci(c),E[t].d(U)}}}const K2=([e,t])=>`${e}: ${t};`,J2=([e,t])=>`${e}: ${t};`;function vC(e,t,n){const c=["use","class","style","for","floatAbove","required","wrapped","shake","float","setRequired","getWidth","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t;var a;const U=wc(vc());let{use:W=[]}=t,{class:ce=""}=t,{style:oe=""}=t,{for:fe=void 0}=t,{floatAbove:we=!1}=t,{required:et=!1}=t,{wrapped:lt=!1}=t,Ke,st,ut={},kt={},Bt=(a=Eu("SMUI:generic:input:props"))!==null&&a!==void 0?a:{},Rt=we,Ge=et;Zc(()=>{n(18,st=new nE({addClass:ni,removeClass:it,getWidth:()=>{var Dt,ci;const bi=pt(),ki=bi.cloneNode(!0);(Dt=bi.parentNode)===null||Dt===void 0||Dt.appendChild(ki),ki.classList.add("smui-floating-label--remove-transition"),ki.classList.add("smui-floating-label--force-size"),ki.classList.remove("mdc-floating-label--float-above");const Gi=ki.scrollWidth;return(ci=bi.parentNode)===null||ci===void 0||ci.removeChild(ki),Gi},registerInteractionHandler:(Dt,ci)=>pt().addEventListener(Dt,ci),deregisterInteractionHandler:(Dt,ci)=>pt().removeEventListener(Dt,ci)}));const Ft={get element(){return pt()},addStyle:xt,removeStyle:_t};return tu(Ke,"SMUIFloatingLabel:mount",Ft),st.init(),()=>{tu(Ke,"SMUIFloatingLabel:unmount",Ft),st.destroy()}});function ni(Ft){ut[Ft]||n(8,ut[Ft]=!0,ut)}function it(Ft){(!(Ft in ut)||ut[Ft])&&n(8,ut[Ft]=!1,ut)}function xt(Ft,Dt){kt[Ft]!=Dt&&(Dt===""||Dt==null?(delete kt[Ft],n(9,kt)):n(9,kt[Ft]=Dt,kt))}function _t(Ft){Ft in kt&&(delete kt[Ft],n(9,kt))}function mt(Ft){st.shake(Ft)}function bt(Ft){n(0,we=Ft)}function dt(Ft){n(1,et=Ft)}function nt(){return st.getWidth()}function pt(){return Ke}function at(Ft){pa[Ft?"unshift":"push"](()=>{Ke=Ft,n(7,Ke)})}function Nt(Ft){pa[Ft?"unshift":"push"](()=>{Ke=Ft,n(7,Ke)})}return e.$$set=Ft=>{t=gr(gr({},t),tc(Ft)),n(12,g=uo(t,c)),"use"in Ft&&n(2,W=Ft.use),"class"in Ft&&n(3,ce=Ft.class),"style"in Ft&&n(4,oe=Ft.style),"for"in Ft&&n(5,fe=Ft.for),"floatAbove"in Ft&&n(0,we=Ft.floatAbove),"required"in Ft&&n(1,et=Ft.required),"wrapped"in Ft&&n(6,lt=Ft.wrapped),"$$scope"in Ft&&n(21,E=Ft.$$scope)},e.$$.update=()=>{e.$$.dirty&786433&&st&&Rt!==we&&(n(19,Rt=we),st.float(we)),e.$$.dirty&1310722&&st&&Ge!==et&&(n(20,Ge=et),st.setRequired(et))},[we,et,W,ce,oe,fe,lt,Ke,ut,kt,U,Bt,g,mt,bt,dt,nt,pt,st,Rt,Ge,E,b,at,Nt]}class a3 extends Lo{constructor(t){super(),Bo(this,t,vC,yC,co,{use:2,class:3,style:4,for:5,floatAbove:0,required:1,wrapped:6,shake:13,float:14,setRequired:15,getWidth:16,getElement:17})}get shake(){return this.$$.ctx[13]}get float(){return this.$$.ctx[14]}get setRequired(){return this.$$.ctx[15]}get getWidth(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function xC(e){let t,n,c,g,b,E,a=[{class:n=Ss({[e[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":e[3],...e[5]})},{style:c=Object.entries(e[6]).map(ex).concat([e[2]]).join(" ")},e[8]],U={};for(let W=0;W<a.length;W+=1)U=gr(U,a[W]);return{c(){t=qn("div"),this.h()},l(W){t=Hn(W,"DIV",{class:!0,style:!0}),Tn(t).forEach(Ci),this.h()},h(){nl(t,U)},m(W,ce){Zn(W,t,ce),e[13](t),b||(E=[xo(g=pc.call(null,t,e[0])),xo(e[7].call(null,t))],b=!0)},p(W,[ce]){nl(t,U=ma(a,[ce&42&&n!==(n=Ss({[W[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":W[3],...W[5]}))&&{class:n},ce&68&&c!==(c=Object.entries(W[6]).map(ex).concat([W[2]]).join(" "))&&{style:c},ce&256&&W[8]])),g&&Iu(g.update)&&ce&1&&g.update.call(null,W[0])},i:lo,o:lo,d(W){W&&Ci(t),e[13](null),b=!1,Oh(E)}}}const ex=([e,t])=>`${e}: ${t};`;function bC(e,t,n){const c=["use","class","style","active","activate","deactivate","setRippleCenter","getElement"];let g=uo(t,c);const b=wc(vc());let{use:E=[]}=t,{class:a=""}=t,{style:U=""}=t,{active:W=!1}=t,ce,oe,fe={},we={};Zc(()=>(oe=new rE({addClass:lt,removeClass:Ke,hasClass:et,setStyle:st,registerEventHandler:(ni,it)=>Rt().addEventListener(ni,it),deregisterEventHandler:(ni,it)=>Rt().removeEventListener(ni,it)}),oe.init(),()=>{oe.destroy()}));function et(ni){return ni in fe?fe[ni]:Rt().classList.contains(ni)}function lt(ni){fe[ni]||n(5,fe[ni]=!0,fe)}function Ke(ni){(!(ni in fe)||fe[ni])&&n(5,fe[ni]=!1,fe)}function st(ni,it){we[ni]!=it&&(it===""||it==null?(delete we[ni],n(6,we)):n(6,we[ni]=it,we))}function ut(){oe.activate()}function kt(){oe.deactivate()}function Bt(ni){oe.setRippleCenter(ni)}function Rt(){return ce}function Ge(ni){pa[ni?"unshift":"push"](()=>{ce=ni,n(4,ce)})}return e.$$set=ni=>{t=gr(gr({},t),tc(ni)),n(8,g=uo(t,c)),"use"in ni&&n(0,E=ni.use),"class"in ni&&n(1,a=ni.class),"style"in ni&&n(2,U=ni.style),"active"in ni&&n(3,W=ni.active)},[E,a,U,W,ce,fe,we,b,g,ut,kt,Bt,Rt,Ge]}class wC extends Lo{constructor(t){super(),Bo(this,t,bC,xC,co,{use:0,class:1,style:2,active:3,activate:9,deactivate:10,setRippleCenter:11,getElement:12})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get setRippleCenter(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}function tx(e){let t,n,c;const g=e[15].default,b=nu(g,e,e[14],null);return{c(){t=qn("div"),b&&b.c(),this.h()},l(E){t=Hn(E,"DIV",{class:!0,style:!0});var a=Tn(t);b&&b.l(a),a.forEach(Ci),this.h()},h(){Fi(t,"class","mdc-notched-outline__notch"),Fi(t,"style",n=Object.entries(e[7]).map(ix).join(" "))},m(E,a){Zn(E,t,a),b&&b.m(t,null),c=!0},p(E,a){b&&b.p&&(!c||a&16384)&&ru(b,g,E,E[14],c?au(g,E[14],a,null):su(E[14]),null),(!c||a&128&&n!==(n=Object.entries(E[7]).map(ix).join(" ")))&&Fi(t,"style",n)},i(E){c||(Ki(b,E),c=!0)},o(E){gn(b,E),c=!1},d(E){E&&Ci(t),b&&b.d(E)}}}function SC(e){let t,n,c,g,b,E,a,U,W,ce,oe=!e[3]&&tx(e),fe=[{class:E=Ss({[e[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":e[2],"mdc-notched-outline--no-label":e[3],...e[6]})},e[10]],we={};for(let et=0;et<fe.length;et+=1)we=gr(we,fe[et]);return{c(){t=qn("div"),n=qn("div"),c=Or(),oe&&oe.c(),g=Or(),b=qn("div"),this.h()},l(et){t=Hn(et,"DIV",{class:!0});var lt=Tn(t);n=Hn(lt,"DIV",{class:!0}),Tn(n).forEach(Ci),c=Nr(lt),oe&&oe.l(lt),g=Nr(lt),b=Hn(lt,"DIV",{class:!0}),Tn(b).forEach(Ci),lt.forEach(Ci),this.h()},h(){Fi(n,"class","mdc-notched-outline__leading"),Fi(b,"class","mdc-notched-outline__trailing"),nl(t,we)},m(et,lt){Zn(et,t,lt),Qi(t,n),Qi(t,c),oe&&oe.m(t,null),Qi(t,g),Qi(t,b),e[16](t),U=!0,W||(ce=[xo(a=pc.call(null,t,e[0])),xo(e[8].call(null,t)),Gl(t,"SMUIFloatingLabel:mount",e[9]),Gl(t,"SMUIFloatingLabel:unmount",e[17])],W=!0)},p(et,[lt]){et[3]?oe&&(fl(),gn(oe,1,1,()=>{oe=null}),dl()):oe?(oe.p(et,lt),lt&8&&Ki(oe,1)):(oe=tx(et),oe.c(),Ki(oe,1),oe.m(t,g)),nl(t,we=ma(fe,[(!U||lt&78&&E!==(E=Ss({[et[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":et[2],"mdc-notched-outline--no-label":et[3],...et[6]})))&&{class:E},lt&1024&&et[10]])),a&&Iu(a.update)&&lt&1&&a.update.call(null,et[0])},i(et){U||(Ki(oe),U=!0)},o(et){gn(oe),U=!1},d(et){et&&Ci(t),oe&&oe.d(),e[16](null),W=!1,Oh(ce)}}}const ix=([e,t])=>`${e}: ${t};`;function IC(e,t,n){const c=["use","class","notched","noLabel","notch","closeNotch","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t;const a=wc(vc());let{use:U=[]}=t,{class:W=""}=t,{notched:ce=!1}=t,{noLabel:oe=!1}=t,fe,we,et,lt={},Ke={};Zc(()=>(we=new yE({addClass:ut,removeClass:kt,setNotchWidthProperty:mt=>Bt("width",mt+"px"),removeNotchWidthProperty:()=>Rt("width")}),we.init(),()=>{we.destroy()}));function st(mt){n(4,et=mt.detail)}function ut(mt){lt[mt]||n(6,lt[mt]=!0,lt)}function kt(mt){(!(mt in lt)||lt[mt])&&n(6,lt[mt]=!1,lt)}function Bt(mt,bt){Ke[mt]!=bt&&(bt===""||bt==null?(delete Ke[mt],n(7,Ke)):n(7,Ke[mt]=bt,Ke))}function Rt(mt){mt in Ke&&(delete Ke[mt],n(7,Ke))}function Ge(mt){we.notch(mt)}function ni(){we.closeNotch()}function it(){return fe}function xt(mt){pa[mt?"unshift":"push"](()=>{fe=mt,n(5,fe)})}const _t=()=>n(4,et=void 0);return e.$$set=mt=>{t=gr(gr({},t),tc(mt)),n(10,g=uo(t,c)),"use"in mt&&n(0,U=mt.use),"class"in mt&&n(1,W=mt.class),"notched"in mt&&n(2,ce=mt.notched),"noLabel"in mt&&n(3,oe=mt.noLabel),"$$scope"in mt&&n(14,E=mt.$$scope)},e.$$.update=()=>{e.$$.dirty&16&&(et?(et.addStyle("transition-duration","0s"),ut("mdc-notched-outline--upgraded"),requestAnimationFrame(()=>{et&&et.removeStyle("transition-duration")})):kt("mdc-notched-outline--upgraded"))},[U,W,ce,oe,et,fe,lt,Ke,a,st,g,Ge,ni,it,E,b,xt,_t]}class EC extends Lo{constructor(t){super(),Bo(this,t,IC,SC,co,{use:0,class:1,notched:2,noLabel:3,notch:11,closeNotch:12,getElement:13})}get notch(){return this.$$.ctx[11]}get closeNotch(){return this.$$.ctx[12]}get getElement(){return this.$$.ctx[13]}}function CC(e){let t;return{c(){t=Po(e[8])},l(n){t=Do(n,e[8])},m(n,c){Zn(n,t,c)},p(n,c){c&256&&ju(t,n[8])},i:lo,o:lo,d(n){n&&Ci(t)}}}function TC(e){let t;const n=e[13].default,c=nu(n,e,e[12],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&4096)&&ru(c,n,g,g[12],t?au(n,g[12],b,null):su(g[12]),null)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function kC(e){let t,n,c,g,b,E,a,U,W;const ce=[TC,CC],oe=[];function fe(lt,Ke){return lt[8]==null?0:1}n=fe(e),c=oe[n]=ce[n](e);let we=[{class:g=Ss({[e[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":e[4],"mdc-select-helper-text--validation-msg-persistent":e[3],...e[6]})},{"aria-hidden":b=e[3]?void 0:"true"},{id:e[2]},e[7],e[10]],et={};for(let lt=0;lt<we.length;lt+=1)et=gr(et,we[lt]);return{c(){t=qn("div"),c.c(),this.h()},l(lt){t=Hn(lt,"DIV",{class:!0,"aria-hidden":!0,id:!0});var Ke=Tn(t);c.l(Ke),Ke.forEach(Ci),this.h()},h(){nl(t,et)},m(lt,Ke){Zn(lt,t,Ke),oe[n].m(t,null),e[14](t),a=!0,U||(W=[xo(E=pc.call(null,t,e[0])),xo(e[9].call(null,t))],U=!0)},p(lt,[Ke]){let st=n;n=fe(lt),n===st?oe[n].p(lt,Ke):(fl(),gn(oe[st],1,1,()=>{oe[st]=null}),dl(),c=oe[n],c?c.p(lt,Ke):(c=oe[n]=ce[n](lt),c.c()),Ki(c,1),c.m(t,null)),nl(t,et=ma(we,[(!a||Ke&90&&g!==(g=Ss({[lt[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":lt[4],"mdc-select-helper-text--validation-msg-persistent":lt[3],...lt[6]})))&&{class:g},(!a||Ke&8&&b!==(b=lt[3]?void 0:"true"))&&{"aria-hidden":b},(!a||Ke&4)&&{id:lt[2]},Ke&128&&lt[7],Ke&1024&&lt[10]])),E&&Iu(E.update)&&Ke&1&&E.update.call(null,lt[0])},i(lt){a||(Ki(c),a=!0)},o(lt){gn(c),a=!1},d(lt){lt&&Ci(t),oe[n].d(),e[14](null),U=!1,Oh(W)}}}let MC=0;function PC(e,t,n){const c=["use","class","id","persistent","validationMsg","getElement"];let g=uo(t,c),{$$slots:b={},$$scope:E}=t;const a=wc(vc());let{use:U=[]}=t,{class:W=""}=t,{id:ce="SMUI-select-helper-text-"+MC++}=t,{persistent:oe=!1}=t,{validationMsg:fe=!1}=t,we,et,lt={},Ke={},st;Zc(()=>(et=new kE({addClass:kt,removeClass:Bt,hasClass:ut,getAttr:Rt,setAttr:Ge,removeAttr:ni,setContent:_t=>{n(8,st=_t)}}),ce.startsWith("SMUI-select-helper-text-")&&tu(it(),"SMUISelectHelperText:id",ce),tu(it(),"SMUISelectHelperText:mount",et),et.init(),()=>{tu(it(),"SMUISelectHelperText:unmount",et),et.destroy()}));function ut(_t){return _t in lt?lt[_t]:it().classList.contains(_t)}function kt(_t){lt[_t]||n(6,lt[_t]=!0,lt)}function Bt(_t){(!(_t in lt)||lt[_t])&&n(6,lt[_t]=!1,lt)}function Rt(_t){var mt;return _t in Ke?(mt=Ke[_t])!==null&&mt!==void 0?mt:null:it().getAttribute(_t)}function Ge(_t,mt){Ke[_t]!==mt&&n(7,Ke[_t]=mt,Ke)}function ni(_t){(!(_t in Ke)||Ke[_t]!=null)&&n(7,Ke[_t]=void 0,Ke)}function it(){return we}function xt(_t){pa[_t?"unshift":"push"](()=>{we=_t,n(5,we)})}return e.$$set=_t=>{t=gr(gr({},t),tc(_t)),n(10,g=uo(t,c)),"use"in _t&&n(0,U=_t.use),"class"in _t&&n(1,W=_t.class),"id"in _t&&n(2,ce=_t.id),"persistent"in _t&&n(3,oe=_t.persistent),"validationMsg"in _t&&n(4,fe=_t.validationMsg),"$$scope"in _t&&n(12,E=_t.$$scope)},[U,W,ce,oe,fe,we,lt,Ke,st,a,g,it,E,b,xt]}class DC extends Lo{constructor(t){super(),Bo(this,t,PC,kC,co,{use:0,class:1,id:2,persistent:3,validationMsg:4,getElement:11})}get getElement(){return this.$$.ctx[11]}}const LC=e=>({}),nx=e=>({}),BC=e=>({}),rx=e=>({}),zC=e=>({}),sx=e=>({}),RC=e=>({}),ax=e=>({});function ox(e){let t,n=[{type:"hidden"},{required:e[10]},{disabled:e[6]},{value:e[0]},wl(e[53],"input$")],c={};for(let g=0;g<n.length;g+=1)c=gr(c,n[g]);return{c(){t=qn("input"),this.h()},l(g){t=Hn(g,"INPUT",{type:!0}),this.h()},h(){nl(t,c)},m(g,b){Zn(g,t,b),t.autofocus&&t.focus()},p(g,b){nl(t,c=ma(n,[{type:"hidden"},b[0]&1024&&{required:g[10]},b[0]&64&&{disabled:g[6]},b[0]&1&&{value:g[0]},b[1]&4194304&&wl(g[53],"input$")]))},d(g){g&&Ci(t)}}}function lx(e){let t;return{c(){t=qn("span"),this.h()},l(n){t=Hn(n,"SPAN",{class:!0}),Tn(t).forEach(Ci),this.h()},h(){Fi(t,"class","mdc-select__ripple")},m(n,c){Zn(n,t,c)},d(n){n&&Ci(t)}}}function ux(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[FC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new a3({props:g}),e[67](t),{c(){Is(t.$$.fragment)},l(b){$s(t.$$.fragment,b)},m(b,E){Es(t,b,E),n=!0},p(b,E){const a=E[0]&3072|E[1]&4196352?ma(c,[E[0]&2048&&{id:b[11]+"-smui-label"},E[1]&2048&&{floatAbove:b[42]!==""},E[0]&1024&&{required:b[10]},E[1]&4194304&&Fs(wl(b[53],"label$"))]):{};E[0]&512|E[2]&33554432&&(a.$$scope={dirty:E,ctx:b}),t.$set(a)},i(b){n||(Ki(t.$$.fragment,b),n=!0)},o(b){gn(t.$$.fragment,b),n=!1},d(b){e[67](null),Cs(t,b)}}}function FC(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,b=nu(g,e,e[87],ax);return{c(){n=Po(t),b&&b.c()},l(E){n=Do(E,t),b&&b.l(E)},m(E,a){Zn(E,n,a),b&&b.m(E,a),c=!0},p(E,a){(!c||a[0]&512)&&t!==(t=(E[9]==null?"":E[9])+"")&&ju(n,t),b&&b.p&&(!c||a[2]&33554432)&&ru(b,g,E,E[87],c?au(g,E[87],a,RC):su(E[87]),ax)},i(E){c||(Ki(b,E),c=!0)},o(E){gn(b,E),c=!1},d(E){E&&Ci(n),b&&b.d(E)}}}function cx(e){let t,n;const c=[{noLabel:e[8]||e[9]==null&&!e[54].label},wl(e[53],"outline$")];let g={$$slots:{default:[NC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new EC({props:g}),e[69](t),{c(){Is(t.$$.fragment)},l(b){$s(t.$$.fragment,b)},m(b,E){Es(t,b,E),n=!0},p(b,E){const a=E[0]&768|E[1]&12582912?ma(c,[E[0]&768|E[1]&8388608&&{noLabel:b[8]||b[9]==null&&!b[54].label},E[1]&4194304&&Fs(wl(b[53],"outline$"))]):{};E[0]&3840|E[1]&12585216|E[2]&33554432&&(a.$$scope={dirty:E,ctx:b}),t.$set(a)},i(b){n||(Ki(t.$$.fragment,b),n=!0)},o(b){gn(t.$$.fragment,b),n=!1},d(b){e[69](null),Cs(t,b)}}}function hx(e){let t,n;const c=[{id:e[11]+"-smui-label"},{floatAbove:e[42]!==""},{required:e[10]},wl(e[53],"label$")];let g={$$slots:{default:[OC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new a3({props:g}),e[68](t),{c(){Is(t.$$.fragment)},l(b){$s(t.$$.fragment,b)},m(b,E){Es(t,b,E),n=!0},p(b,E){const a=E[0]&3072|E[1]&4196352?ma(c,[E[0]&2048&&{id:b[11]+"-smui-label"},E[1]&2048&&{floatAbove:b[42]!==""},E[0]&1024&&{required:b[10]},E[1]&4194304&&Fs(wl(b[53],"label$"))]):{};E[0]&512|E[2]&33554432&&(a.$$scope={dirty:E,ctx:b}),t.$set(a)},i(b){n||(Ki(t.$$.fragment,b),n=!0)},o(b){gn(t.$$.fragment,b),n=!1},d(b){e[68](null),Cs(t,b)}}}function OC(e){let t=(e[9]==null?"":e[9])+"",n,c;const g=e[64].label,b=nu(g,e,e[87],sx);return{c(){n=Po(t),b&&b.c()},l(E){n=Do(E,t),b&&b.l(E)},m(E,a){Zn(E,n,a),b&&b.m(E,a),c=!0},p(E,a){(!c||a[0]&512)&&t!==(t=(E[9]==null?"":E[9])+"")&&ju(n,t),b&&b.p&&(!c||a[2]&33554432)&&ru(b,g,E,E[87],c?au(g,E[87],a,zC):su(E[87]),sx)},i(E){c||(Ki(b,E),c=!0)},o(E){gn(b,E),c=!1},d(E){E&&Ci(n),b&&b.d(E)}}}function NC(e){let t,n,c=!e[8]&&(e[9]!=null||e[54].label)&&hx(e);return{c(){c&&c.c(),t=gs()},l(g){c&&c.l(g),t=gs()},m(g,b){c&&c.m(g,b),Zn(g,t,b),n=!0},p(g,b){!g[8]&&(g[9]!=null||g[54].label)?c?(c.p(g,b),b[0]&768|b[1]&8388608&&Ki(c,1)):(c=hx(g),c.c(),Ki(c,1),c.m(t.parentNode,t)):c&&(fl(),gn(c,1,1,()=>{c=null}),dl())},i(g){n||(Ki(c),n=!0)},o(g){gn(c),n=!1},d(g){g&&Ci(t),c&&c.d(g)}}}function Ax(e){let t,n;const c=[wl(e[53],"ripple$")];let g={};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new wC({props:g}),e[70](t),{c(){Is(t.$$.fragment)},l(b){$s(t.$$.fragment,b)},m(b,E){Es(t,b,E),n=!0},p(b,E){const a=E[1]&4194304?ma(c,[Fs(wl(b[53],"ripple$"))]):{};t.$set(a)},i(b){n||(Ki(t.$$.fragment,b),n=!0)},o(b){gn(t.$$.fragment,b),n=!1},d(b){e[70](null),Cs(t,b)}}}function VC(e){let t;const n=e[64].default,c=nu(n,e,e[87],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b[2]&33554432)&&ru(c,n,g,g[87],t?au(n,g[87],b,null):su(g[87]),null)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function UC(e){let t,n,c;const g=[{role:"listbox"},{wrapFocus:e[35]},wl(e[53],"list$")];function b(a){e[75](a)}let E={$$slots:{default:[VC]},$$scope:{ctx:e}};for(let a=0;a<g.length;a+=1)E=gr(E,g[a]);return e[24]!==void 0&&(E.selectedIndex=e[24]),t=new lC({props:E}),pa.push(()=>N0(t,"selectedIndex",b)),t.$on("SMUIList:mount",e[76]),{c(){Is(t.$$.fragment)},l(a){$s(t.$$.fragment,a)},m(a,U){Es(t,a,U),c=!0},p(a,U){const W=U[1]&4194320?ma(g,[g[0],U[1]&16&&{wrapFocus:a[35]},U[1]&4194304&&Fs(wl(a[53],"list$"))]):{};U[2]&33554432&&(W.$$scope={dirty:U,ctx:a}),!n&&U[0]&16777216&&(n=!0,W.selectedIndex=a[24],O0(()=>n=!1)),t.$set(W)},i(a){c||(Ki(t.$$.fragment,a),c=!0)},o(a){gn(t.$$.fragment,a),c=!1},d(a){Cs(t,a)}}}function fx(e){let t,n;const c=[wl(e[53],"helperText$")];let g={$$slots:{default:[GC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new DC({props:g}),t.$on("SMUISelectHelperText:id",e[84]),t.$on("SMUISelectHelperText:mount",e[85]),t.$on("SMUISelectHelperText:unmount",e[86]),{c(){Is(t.$$.fragment)},l(b){$s(t.$$.fragment,b)},m(b,E){Es(t,b,E),n=!0},p(b,E){const a=E[1]&4194304?ma(c,[Fs(wl(b[53],"helperText$"))]):{};E[2]&33554432&&(a.$$scope={dirty:E,ctx:b}),t.$set(a)},i(b){n||(Ki(t.$$.fragment,b),n=!0)},o(b){gn(t.$$.fragment,b),n=!1},d(b){Cs(t,b)}}}function GC(e){let t;const n=e[64].helperText,c=nu(n,e,e[87],nx);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b[2]&33554432)&&ru(c,n,g,g[87],t?au(n,g[87],b,LC):su(g[87]),nx)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function qC(e){let t,n,c,g,b,E,a,U,W,ce,oe,fe,we,et,lt,Ke,st,ut,kt,Bt,Rt,Ge,ni,it,xt,_t,mt,bt,dt,nt,pt,at,Nt,Ft,Dt,ci,bi,ki,Gi,rn,$i,qi=e[12]&&ox(e),sn=e[7]==="filled"&&lx(),Ti=e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)&&ux(e),yi=e[7]==="outlined"&&cx(e);const hi=e[64].leadingIcon,Ei=nu(hi,e,e[87],rx);let Li=[{id:oe=e[11]+"-smui-selected-text"},{class:fe=Ss({[e[19]]:!0,"mdc-select__selected-text":!0})},{role:"button"},{"aria-haspopup":"listbox"},{"aria-labelledby":we=e[11]+"-smui-label"},wl(e[53],"selectedText$")],fn={};for(let k=0;k<Li.length;k+=1)fn=gr(fn,Li[k]);let _n=[{class:lt=Ss({[e[17]]:!0,"mdc-select__selected-text-container":!0})},wl(e[53],"selectedTextContainer$")],gi={};for(let k=0;k<_n.length;k+=1)gi=gr(gi,_n[k]);let mn=[{class:Ge=Ss({[e[21]]:!0,"mdc-select__dropdown-icon":!0})},wl(e[53],"dropdownIcon$")],ti={};for(let k=0;k<mn.length;k+=1)ti=gr(ti,mn[k]);let Mn=e[7]!=="outlined"&&e[5]&&Ax(e),ns=[{class:xt=Ss({[e[15]]:!0,"mdc-select__anchor":!0})},{"aria-required":_t=e[10]?"true":void 0},{"aria-disabled":mt=e[6]?"true":void 0},{"aria-controls":e[45]},{"aria-expanded":bt=e[31]?"true":"false"},{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},e[29],wl(e[53],"anchor$")],fi={};for(let k=0;k<ns.length;k+=1)fi=gr(fi,ns[k]);const ln=[{class:Ss({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},{id:e[45]},{fullWidth:!0},{anchor:!1},{anchorElement:e[33]},{anchorCorner:e[34]},wl(e[53],"menu$")];function pr(k){e[77](k)}let On={$$slots:{default:[UC]},$$scope:{ctx:e}};for(let k=0;k<ln.length;k+=1)On=gr(On,ln[k]);e[31]!==void 0&&(On.open=e[31]),pt=new jE({props:On}),pa.push(()=>N0(pt,"open",pr)),pt.$on("SMUIMenu:selected",e[78]),pt.$on("SMUIMenuSurface:closing",e[79]),pt.$on("SMUIMenuSurface:closed",e[80]),pt.$on("SMUIMenuSurface:opened",e[81]);let Qn=[{class:Nt=Ss({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})},{style:Ft=Object.entries(e[27]).map(dx).concat([e[4]]).join(" ")},Z2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])],wn={};for(let k=0;k<Qn.length;k+=1)wn=gr(wn,Qn[k]);let v=e[54].helperText&&fx(e);return{c(){t=qn("div"),qi&&qi.c(),n=Or(),c=qn("div"),sn&&sn.c(),g=Or(),Ti&&Ti.c(),b=Or(),yi&&yi.c(),E=Or(),Ei&&Ei.c(),a=Or(),U=qn("span"),W=qn("span"),ce=Po(e[42]),st=Or(),ut=qn("span"),kt=Ba("svg"),Bt=Ba("polygon"),Rt=Ba("polygon"),it=Or(),Mn&&Mn.c(),nt=Or(),Is(pt.$$.fragment),bi=Or(),v&&v.c(),ki=gs(),this.h()},l(k){t=Hn(k,"DIV",{class:!0,style:!0});var V=Tn(t);qi&&qi.l(V),n=Nr(V),c=Hn(V,"DIV",{class:!0,"aria-required":!0,"aria-disabled":!0,"aria-controls":!0,"aria-expanded":!0,"aria-describedby":!0,role:!0,tabindex:!0});var $=Tn(c);sn&&sn.l($),g=Nr($),Ti&&Ti.l($),b=Nr($),yi&&yi.l($),E=Nr($),Ei&&Ei.l($),a=Nr($),U=Hn($,"SPAN",{class:!0});var te=Tn(U);W=Hn(te,"SPAN",{id:!0,class:!0,role:!0,"aria-haspopup":!0,"aria-labelledby":!0});var Ae=Tn(W);ce=Do(Ae,e[42]),Ae.forEach(Ci),te.forEach(Ci),st=Nr($),ut=Hn($,"SPAN",{class:!0});var ve=Tn(ut);kt=za(ve,"svg",{class:!0,viewBox:!0,focusable:!0});var Ie=Tn(kt);Bt=za(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),Tn(Bt).forEach(Ci),Rt=za(Ie,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),Tn(Rt).forEach(Ci),Ie.forEach(Ci),ve.forEach(Ci),it=Nr($),Mn&&Mn.l($),$.forEach(Ci),nt=Nr(V),$s(pt.$$.fragment,V),V.forEach(Ci),bi=Nr(k),v&&v.l(k),ki=gs(),this.h()},h(){nl(W,fn),nl(U,gi),Fi(Bt,"class","mdc-select__dropdown-icon-inactive"),Fi(Bt,"stroke","none"),Fi(Bt,"fill-rule","evenodd"),Fi(Bt,"points","7 10 12 15 17 10"),Fi(Rt,"class","mdc-select__dropdown-icon-active"),Fi(Rt,"stroke","none"),Fi(Rt,"fill-rule","evenodd"),Fi(Rt,"points","7 15 12 10 17 15"),Fi(kt,"class","mdc-select__dropdown-icon-graphic"),Fi(kt,"viewBox","7 10 10 5"),Fi(kt,"focusable","false"),nl(ut,ti),nl(c,fi),nl(t,wn)},m(k,V){Zn(k,t,V),qi&&qi.m(t,null),Qi(t,n),Qi(t,c),sn&&sn.m(c,null),Qi(c,g),Ti&&Ti.m(c,null),Qi(c,b),yi&&yi.m(c,null),Qi(c,E),Ei&&Ei.m(c,null),Qi(c,a),Qi(c,U),Qi(U,W),Qi(W,ce),Qi(c,st),Qi(c,ut),Qi(ut,kt),Qi(kt,Bt),Qi(kt,Rt),Qi(c,it),Mn&&Mn.m(c,null),e[71](c),Qi(t,nt),Es(pt,t,null),e[82](t),Zn(k,bi,V),v&&v.m(k,V),Zn(k,ki,V),Gi=!0,rn||($i=[xo(et=pc.call(null,W,e[18])),xo(Ke=pc.call(null,U,e[16])),xo(ni=pc.call(null,ut,e[20])),xo(dt=pc.call(null,c,e[14])),Gl(c,"focus",e[72]),Gl(c,"blur",e[73]),Gl(c,"click",e[74]),Gl(c,"keydown",function(){Iu(e[23]&&e[23].handleKeydown.bind(e[23]))&&(e[23]&&e[23].handleKeydown.bind(e[23])).apply(this,arguments)}),Gl(c,"focus",e[65]),Gl(c,"blur",e[66]),xo(Dt=Xd.call(null,t,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]})),xo(UE.call(null,t,{addClass:e[50],removeClass:e[51]})),xo(ci=pc.call(null,t,e[2])),xo(e[43].call(null,t)),Gl(t,"SMUISelectLeadingIcon:mount",e[49]),Gl(t,"SMUISelectLeadingIcon:unmount",e[83])],rn=!0)},p(k,V){e=k,e[12]?qi?qi.p(e,V):(qi=ox(e),qi.c(),qi.m(t,n)):qi&&(qi.d(1),qi=null),e[7]==="filled"?sn||(sn=lx(),sn.c(),sn.m(c,g)):sn&&(sn.d(1),sn=null),e[7]!=="outlined"&&!e[8]&&(e[9]!=null||e[54].label)?Ti?(Ti.p(e,V),V[0]&896|V[1]&8388608&&Ki(Ti,1)):(Ti=ux(e),Ti.c(),Ki(Ti,1),Ti.m(c,b)):Ti&&(fl(),gn(Ti,1,1,()=>{Ti=null}),dl()),e[7]==="outlined"?yi?(yi.p(e,V),V[0]&128&&Ki(yi,1)):(yi=cx(e),yi.c(),Ki(yi,1),yi.m(c,E)):yi&&(fl(),gn(yi,1,1,()=>{yi=null}),dl()),Ei&&Ei.p&&(!Gi||V[2]&33554432)&&ru(Ei,hi,e,e[87],Gi?au(hi,e[87],V,BC):su(e[87]),rx),(!Gi||V[1]&2048)&&XI(ce,e[42],fn.contenteditable),nl(W,fn=ma(Li,[(!Gi||V[0]&2048&&oe!==(oe=e[11]+"-smui-selected-text"))&&{id:oe},(!Gi||V[0]&524288&&fe!==(fe=Ss({[e[19]]:!0,"mdc-select__selected-text":!0})))&&{class:fe},{role:"button"},{"aria-haspopup":"listbox"},(!Gi||V[0]&2048&&we!==(we=e[11]+"-smui-label"))&&{"aria-labelledby":we},V[1]&4194304&&wl(e[53],"selectedText$")])),et&&Iu(et.update)&&V[0]&262144&&et.update.call(null,e[18]),nl(U,gi=ma(_n,[(!Gi||V[0]&131072&&lt!==(lt=Ss({[e[17]]:!0,"mdc-select__selected-text-container":!0})))&&{class:lt},V[1]&4194304&&wl(e[53],"selectedTextContainer$")])),Ke&&Iu(Ke.update)&&V[0]&65536&&Ke.update.call(null,e[16]),nl(ut,ti=ma(mn,[(!Gi||V[0]&2097152&&Ge!==(Ge=Ss({[e[21]]:!0,"mdc-select__dropdown-icon":!0})))&&{class:Ge},V[1]&4194304&&wl(e[53],"dropdownIcon$")])),ni&&Iu(ni.update)&&V[0]&1048576&&ni.update.call(null,e[20]),e[7]!=="outlined"&&e[5]?Mn?(Mn.p(e,V),V[0]&160&&Ki(Mn,1)):(Mn=Ax(e),Mn.c(),Ki(Mn,1),Mn.m(c,null)):Mn&&(fl(),gn(Mn,1,1,()=>{Mn=null}),dl()),nl(c,fi=ma(ns,[(!Gi||V[0]&32768&&xt!==(xt=Ss({[e[15]]:!0,"mdc-select__anchor":!0})))&&{class:xt},(!Gi||V[0]&1024&&_t!==(_t=e[10]?"true":void 0))&&{"aria-required":_t},(!Gi||V[0]&64&&mt!==(mt=e[6]?"true":void 0))&&{"aria-disabled":mt},{"aria-controls":e[45]},(!Gi||V[1]&1&&bt!==(bt=e[31]?"true":"false"))&&{"aria-expanded":bt},(!Gi||V[0]&1073741824)&&{"aria-describedby":e[30]},{role:"combobox"},{tabindex:"0"},V[0]&536870912&&e[29],V[1]&4194304&&wl(e[53],"anchor$")])),dt&&Iu(dt.update)&&V[0]&16384&&dt.update.call(null,e[14]);const $=V[0]&4194304|V[1]&4210702?ma(ln,[V[0]&4194304|V[1]&2&&{class:Ss({[e[22]]:!0,"mdc-select__menu":!0,...e[32]})},V[1]&16384&&{id:e[45]},ln[2],ln[3],V[1]&4&&{anchorElement:e[33]},V[1]&8&&{anchorCorner:e[34]},V[1]&4194304&&Fs(wl(e[53],"menu$"))]):{};V[0]&16777216|V[1]&4194352|V[2]&33554432&&($.$$scope={dirty:V,ctx:e}),!at&&V[1]&1&&(at=!0,$.open=e[31],O0(()=>at=!1)),pt.$set($),nl(t,wn=ma(Qn,[(!Gi||V[0]&67119050|V[1]&8388609&&Nt!==(Nt=Ss({[e[3]]:!0,"mdc-select":!0,"mdc-select--required":e[10],"mdc-select--disabled":e[6],"mdc-select--filled":e[7]==="filled","mdc-select--outlined":e[7]==="outlined","smui-select--standard":e[7]==="standard","mdc-select--with-leading-icon":e[44](e[13])?e[54].leadingIcon:e[13],"mdc-select--no-label":e[8]||e[9]==null&&!e[54].label,"mdc-select--invalid":e[1],"mdc-select--activated":e[31],"mdc-data-table__pagination-rows-per-page-select":e[46]==="data-table:pagination",...e[26]})))&&{class:Nt},(!Gi||V[0]&134217744&&Ft!==(Ft=Object.entries(e[27]).map(dx).concat([e[4]]).join(" ")))&&{style:Ft},V[1]&4194304&&Z2(e[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])])),Dt&&Iu(Dt.update)&&V[0]&128&&Dt.update.call(null,{ripple:e[7]==="filled",unbounded:!1,addClass:e[50],removeClass:e[51],addStyle:e[52]}),ci&&Iu(ci.update)&&V[0]&4&&ci.update.call(null,e[2]),e[54].helperText?v?(v.p(e,V),V[1]&8388608&&Ki(v,1)):(v=fx(e),v.c(),Ki(v,1),v.m(ki.parentNode,ki)):v&&(fl(),gn(v,1,1,()=>{v=null}),dl())},i(k){Gi||(Ki(Ti),Ki(yi),Ki(Ei,k),Ki(Mn),Ki(pt.$$.fragment,k),Ki(v),Gi=!0)},o(k){gn(Ti),gn(yi),gn(Ei,k),gn(Mn),gn(pt.$$.fragment,k),gn(v),Gi=!1},d(k){k&&(Ci(t),Ci(bi),Ci(ki)),qi&&qi.d(),sn&&sn.d(),Ti&&Ti.d(),yi&&yi.d(),Ei&&Ei.d(k),Mn&&Mn.d(),e[71](null),Cs(pt),e[82](null),v&&v.d(k),rn=!1,Oh($i)}}}let HC=0;function jC(e){const t=e.currentTarget.getBoundingClientRect();return(ZC(e)?e.touches[0].clientX:e.clientX)-t.left}function ZC(e){return"touches"in e}const dx=([e,t])=>`${e}: ${t};`;function QC(e,t,n){const c=["use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","getUseDefaultValidation","setUseDefaultValidation","focus","layout","getElement"];let g=uo(t,c),b,E,{$$slots:a={},$$scope:U}=t;const W=QI(a);var ce;const oe=wc(vc());let fe=()=>{};function we(Yt){return Yt===fe}let{use:et=[]}=t,{class:lt=""}=t,{style:Ke=""}=t,{ripple:st=!0}=t,{disabled:ut=!1}=t,{variant:kt="standard"}=t,{noLabel:Bt=!1}=t,{label:Rt=void 0}=t,{value:Ge=""}=t,{key:ni=Yt=>Yt}=t,{dirty:it=!1}=t,{invalid:xt=fe}=t,{updateInvalid:_t=we(xt)}=t;const mt=we(xt);we(xt)&&(xt=!1);let{required:bt=!1}=t,{inputId:dt="SMUI-select-"+HC++}=t,{hiddenInput:nt=!1}=t,{withLeadingIcon:pt=fe}=t,{anchor$use:at=[]}=t,{anchor$class:Nt=""}=t,{selectedTextContainer$use:Ft=[]}=t,{selectedTextContainer$class:Dt=""}=t,{selectedText$use:ci=[]}=t,{selectedText$class:bi=""}=t,{dropdownIcon$use:ki=[]}=t,{dropdownIcon$class:Gi=""}=t,{menu$class:rn=""}=t,$i,qi,sn={},Ti={},yi,hi={},Ei=-1,Li=(ce=g.menu$id)!==null&&ce!==void 0?ce:dt+"-menu",fn,_n=Eu("SMUI:addLayoutListener"),gi,mn=!1,ti={},Mn,ns,fi=!1,ln,pr=Eu("SMUI:select:context"),On,Qn,wn,v,k;fu("SMUI:list:role",""),fu("SMUI:list:nav",!1);const V=Py("");hm(e,V,Yt=>n(42,b=Yt)),fu("SMUI:select:selectedText",V);const $=Py(Ge);hm(e,$,Yt=>n(90,E=Yt)),fu("SMUI:select:value",$);let te=Ei;_n&&(gi=_n(X)),Zc(()=>(n(23,qi=new TE({setSelectedText:Yt=>{sm(V,b=Yt,b)},isSelectAnchorFocused:()=>document.activeElement===yi,getSelectAnchorAttr:Ze,setSelectAnchorAttr:Ve,removeSelectAnchorAttr:ft,addMenuClass:Qe,removeMenuClass:He,openMenu:()=>{n(31,mn=!0)},closeMenu:()=>{n(31,mn=!1)},getAnchorElement:()=>yi,setMenuAnchorElement:Yt=>{n(33,Mn=Yt)},setMenuAnchorCorner:Yt=>{n(34,ns=Yt)},setMenuWrapFocus:Yt=>{n(35,fi=Yt)},getSelectedIndex:()=>Ei,setSelectedIndex:Yt=>{n(63,te=Yt),n(24,Ei=Yt),n(0,Ge=rt()[Ei])},focusMenuItemAtIndex:Yt=>{ln.focusItemAtIndex(Yt)},getMenuItemCount:()=>ln.items.length,getMenuItemValues:()=>rt().map(ni),getMenuItemTextAtIndex:Yt=>ln.getPrimaryTextAtIndex(Yt),isTypeaheadInProgress:()=>ln.typeaheadInProgress,typeaheadMatchItem:(Yt,vn)=>ln.typeaheadMatchItem(Yt,vn),addClass:Ie,removeClass:Ee,hasClass:ve,setRippleCenter:Yt=>v&&v.setRippleCenter(Yt),activateBottomLine:()=>v&&v.activate(),deactivateBottomLine:()=>v&&v.deactivate(),notifyChange:Yt=>{n(55,it=!0),_t&&n(1,xt=!qi.isValid()),tu(ie(),"SMUISelect:change",{value:Ge,index:Ei},void 0,!0)},hasOutline:()=>!!k,notchOutline:Yt=>k&&k.notch(Yt),closeOutline:()=>k&&k.closeNotch(),hasLabel:()=>!!wn,floatLabel:Yt=>wn&&wn.float(Yt),getLabelWidth:()=>wn?wn.getWidth():0,setLabelRequired:Yt=>wn&&wn.setRequired(Yt)},{get helperText(){return Qn},get leadingIcon(){return On}})),n(24,Ei=rt().indexOf(Ge)),qi.init(),se(mt),()=>{qi.destroy()})),bm(()=>{gi&&gi()});function Ae(Yt){n(37,On=Yt.detail)}function ve(Yt){return Yt in sn?sn[Yt]:ie().classList.contains(Yt)}function Ie(Yt){sn[Yt]||n(26,sn[Yt]=!0,sn)}function Ee(Yt){(!(Yt in sn)||sn[Yt])&&n(26,sn[Yt]=!1,sn)}function ze(Yt,vn){Ti[Yt]!=vn&&(vn===""||vn==null?(delete Ti[Yt],n(27,Ti)):n(27,Ti[Yt]=vn,Ti))}function Qe(Yt){ti[Yt]||n(32,ti[Yt]=!0,ti)}function He(Yt){(!(Yt in ti)||ti[Yt])&&n(32,ti[Yt]=!1,ti)}function Ze(Yt){var vn;return Yt in hi?(vn=hi[Yt])!==null&&vn!==void 0?vn:null:ie().getAttribute(Yt)}function Ve(Yt,vn){hi[Yt]!==vn&&n(29,hi[Yt]=vn,hi)}function ft(Yt){(!(Yt in hi)||hi[Yt]!=null)&&n(29,hi[Yt]=void 0,hi)}function rt(){return ln.getOrderedList().map(Yt=>Yt.getValue())}function Me(){return qi.getUseDefaultValidation()}function se(Yt){qi.setUseDefaultValidation(Yt)}function ne(){yi.focus()}function X(){qi.layout()}function ie(){return $i}function de(Yt){R2.call(this,e,Yt)}function ye(Yt){R2.call(this,e,Yt)}function ge(Yt){pa[Yt?"unshift":"push"](()=>{wn=Yt,n(39,wn)})}function Pe(Yt){pa[Yt?"unshift":"push"](()=>{wn=Yt,n(39,wn)})}function Fe(Yt){pa[Yt?"unshift":"push"](()=>{k=Yt,n(41,k)})}function Ne(Yt){pa[Yt?"unshift":"push"](()=>{v=Yt,n(40,v)})}function Xe(Yt){pa[Yt?"unshift":"push"](()=>{yi=Yt,n(28,yi)})}const Ye=()=>qi&&qi.handleFocus(),De=()=>qi&&qi.handleBlur(),Ue=Yt=>{yi.focus(),qi&&qi.handleClick(jC(Yt))};function ht(Yt){Ei=Yt,n(24,Ei)}const Tt=Yt=>n(36,ln=Yt.detail);function o(Yt){mn=Yt,n(31,mn)}const ke=Yt=>qi&&qi.handleMenuItemAction(Yt.detail.index),ai=()=>qi&&qi.handleMenuClosing(),di=()=>qi&&qi.handleMenuClosed(),Ai=()=>qi&&qi.handleMenuOpened();function Kt(Yt){pa[Yt?"unshift":"push"](()=>{$i=Yt,n(25,$i)})}const oi=()=>n(37,On=void 0),Ri=Yt=>n(30,fn=Yt.detail),vi=Yt=>n(38,Qn=Yt.detail),wi=()=>{n(30,fn=void 0),n(38,Qn=void 0)};return e.$$set=Yt=>{t=gr(gr({},t),tc(Yt)),n(53,g=uo(t,c)),"use"in Yt&&n(2,et=Yt.use),"class"in Yt&&n(3,lt=Yt.class),"style"in Yt&&n(4,Ke=Yt.style),"ripple"in Yt&&n(5,st=Yt.ripple),"disabled"in Yt&&n(6,ut=Yt.disabled),"variant"in Yt&&n(7,kt=Yt.variant),"noLabel"in Yt&&n(8,Bt=Yt.noLabel),"label"in Yt&&n(9,Rt=Yt.label),"value"in Yt&&n(0,Ge=Yt.value),"key"in Yt&&n(56,ni=Yt.key),"dirty"in Yt&&n(55,it=Yt.dirty),"invalid"in Yt&&n(1,xt=Yt.invalid),"updateInvalid"in Yt&&n(57,_t=Yt.updateInvalid),"required"in Yt&&n(10,bt=Yt.required),"inputId"in Yt&&n(11,dt=Yt.inputId),"hiddenInput"in Yt&&n(12,nt=Yt.hiddenInput),"withLeadingIcon"in Yt&&n(13,pt=Yt.withLeadingIcon),"anchor$use"in Yt&&n(14,at=Yt.anchor$use),"anchor$class"in Yt&&n(15,Nt=Yt.anchor$class),"selectedTextContainer$use"in Yt&&n(16,Ft=Yt.selectedTextContainer$use),"selectedTextContainer$class"in Yt&&n(17,Dt=Yt.selectedTextContainer$class),"selectedText$use"in Yt&&n(18,ci=Yt.selectedText$use),"selectedText$class"in Yt&&n(19,bi=Yt.selectedText$class),"dropdownIcon$use"in Yt&&n(20,ki=Yt.dropdownIcon$use),"dropdownIcon$class"in Yt&&n(21,Gi=Yt.dropdownIcon$class),"menu$class"in Yt&&n(22,rn=Yt.menu$class),"$$scope"in Yt&&n(87,U=Yt.$$scope)},e.$$.update=()=>{if(e.$$.dirty[0]&25165825|e.$$.dirty[2]&2&&te!==Ei)if(n(63,te=Ei),qi)qi.setSelectedIndex(Ei,!1,!0);else{const Yt=rt();Ge!==Yt[Ei]&&n(0,Ge=Yt[Ei])}e.$$.dirty[0]&1&&sm($,E=Ge,E),e.$$.dirty[0]&8388609|e.$$.dirty[1]&33554432&&qi&&qi.getValue()!==ni(Ge)&&qi.setValue(ni(Ge)),e.$$.dirty[0]&8388672&&qi&&qi.getDisabled()!==ut&&qi.setDisabled(ut),e.$$.dirty[0]&8388610|e.$$.dirty[1]&83886080&&qi&&it&&qi.isValid()!==!xt&&(_t?n(1,xt=!qi.isValid()):qi.setValid(!xt)),e.$$.dirty[0]&8389632&&qi&&qi.getRequired()!==bt&&qi.setRequired(bt)},[Ge,xt,et,lt,Ke,st,ut,kt,Bt,Rt,bt,dt,nt,pt,at,Nt,Ft,Dt,ci,bi,ki,Gi,rn,qi,Ei,$i,sn,Ti,yi,hi,fn,mn,ti,Mn,ns,fi,ln,On,Qn,wn,v,k,b,oe,we,Li,pr,V,$,Ae,Ie,Ee,ze,g,W,it,ni,_t,Me,se,ne,X,ie,te,a,de,ye,ge,Pe,Fe,Ne,Xe,Ye,De,Ue,ht,Tt,o,ke,ai,di,Ai,Kt,oi,Ri,vi,wi,U]}class hg extends Lo{constructor(t){super(),Bo(this,t,QC,qC,co,{use:2,class:3,style:4,ripple:5,disabled:6,variant:7,noLabel:8,label:9,value:0,key:56,dirty:55,invalid:1,updateInvalid:57,required:10,inputId:11,hiddenInput:12,withLeadingIcon:13,anchor$use:14,anchor$class:15,selectedTextContainer$use:16,selectedTextContainer$class:17,selectedText$use:18,selectedText$class:19,dropdownIcon$use:20,dropdownIcon$class:21,menu$class:22,getUseDefaultValidation:58,setUseDefaultValidation:59,focus:60,layout:61,getElement:62},null,[-1,-1,-1,-1])}get getUseDefaultValidation(){return this.$$.ctx[58]}get setUseDefaultValidation(){return this.$$.ctx[59]}get focus(){return this.$$.ctx[60]}get layout(){return this.$$.ctx[61]}get getElement(){return this.$$.ctx[62]}}function WC(e){let t;const n=e[11].default,c=nu(n,e,e[13],null);return{c(){c&&c.c()},l(g){c&&c.l(g)},m(g,b){c&&c.m(g,b),t=!0},p(g,b){c&&c.p&&(!t||b&8192)&&ru(c,n,g,g[13],t?au(n,g[13],b,null):su(g[13]),null)},i(g){t||(Ki(c,g),t=!0)},o(g){gn(c,g),t=!1},d(g){c&&c.d(g)}}}function XC(e){let t,n;const c=[{use:e[3]},{"data-value":e[0]},{value:e[0]},{selected:e[2]},e[6]];let g={$$slots:{default:[WC]},$$scope:{ctx:e}};for(let b=0;b<c.length;b+=1)g=gr(g,c[b]);return t=new fC({props:g}),e[12](t),{c(){Is(t.$$.fragment)},l(b){$s(t.$$.fragment,b)},m(b,E){Es(t,b,E),n=!0},p(b,[E]){const a=E&77?ma(c,[E&8&&{use:b[3]},E&1&&{"data-value":b[0]},E&1&&{value:b[0]},E&4&&{selected:b[2]},E&64&&Fs(b[6])]):{};E&8192&&(a.$$scope={dirty:E,ctx:b}),t.$set(a)},i(b){n||(Ki(t.$$.fragment,b),n=!0)},o(b){gn(t.$$.fragment,b),n=!1},d(b){e[12](null),Cs(t,b)}}}function YC(e,t,n){let c,g;const b=["use","class","value","getElement"];let E=uo(t,b),a,U,{$$slots:W={},$$scope:ce}=t;const oe=wc(vc());let{use:fe=[]}=t;const we="";let{value:et=""}=t,lt;const Ke=Eu("SMUI:select:selectedText");hm(e,Ke,Rt=>n(14,a=Rt));const st=Eu("SMUI:select:value");hm(e,st,Rt=>n(10,U=Rt)),fu("SMUI:list:item:role","option"),Zc(ut),bm(ut);function ut(){g&&lt&&sm(Ke,a=lt.getPrimaryText(),a)}function kt(){return lt.getElement()}function Bt(Rt){pa[Rt?"unshift":"push"](()=>{lt=Rt,n(1,lt)})}return e.$$set=Rt=>{t=gr(gr({},t),tc(Rt)),n(6,E=uo(t,b)),"use"in Rt&&n(7,fe=Rt.use),"value"in Rt&&n(0,et=Rt.value),"$$scope"in Rt&&n(13,ce=Rt.$$scope)},e.$$.update=()=>{e.$$.dirty&128&&n(3,c=[oe,...fe]),e.$$.dirty&1025&&n(2,g=et!=null&&et!==""&&U===et)},[et,lt,g,c,Ke,st,E,fe,we,kt,U,W,Bt,ce]}class Eg extends Lo{constructor(t){super(),Bo(this,t,YC,XC,co,{use:7,class:8,value:0,getElement:9})}get class(){return this.$$.ctx[8]}get getElement(){return this.$$.ctx[9]}}function d_(e,t,n="*ibm_flip"){return Mv[n](e,t)}function $C(e="*ibm_flip"){let t=Mv[e](0,1),n=[];for(let c of t)n.push(c[1]);return n}function Go(e,t,n){return n*(t-e)+e}const Mv={"*ibm_flip":function(t,n){return[[-1,"#ddddddcc"],[t,"#FFB000cc","Very low"],[Go(t,n,.25),"#FE6100cc"],[Go(t,n,.5),"#DC267Fcc","Expected"],[Go(t,n,.75),"#785EF0cc"],[n,"#648FFFcc","Very high"]]},orGrBlu:function(t,n){return[[-1,"#ddddddcc"],[t,"#F9A825cc","Very low"],[Go(t,n,.35),"#e8f4c4cc"],[Go(t,n,.5),"#00E676cc","Expected"],[Go(t,n,.75),"#3d9ab8cc"],[Go(t,n,.85),"#318ab5cc"],[n,"#2a4e9bcc","Very high"]]},blGr:function(t,n){return[[-1,"#ddddddcc"],[t,"#000000","Very low"],[n,"#00ff00","Very high"]]},blBluCyWt:function(t,n){return[[-1,"#ddddddcc","Missing"],[t,"#000000cc","Very low"],[Go(t,n,.5),"#0000ffcc","Expected"],[Go(t,n,.75),"#00ffffcc"],[n,"#ffffffcc","Very high"]]},rdYlGr:function(t,n){return[[-1,"#ddddddcc","Missing"],[t,"#fd5533cc","Very low"],[Go(t,n,.5),"#f8f611cc","Normal"],[n,"#4eb87bcc","Very high"]]},"*mgYlGr":function(t,n){return[[-1,"#ddddddcc","Missing"],[t,"#F15C8Ecc","Very low"],[Go(t,n,.5),"#f8f611cc","Normal"],[n,"#4eb87bcc","Very high"]]},grYlRd:function(t,n){return[[-1,"#ddddddcc","Missing"],[t,"#00ff33cc","Very low biodiversity"],[Go(t,n,.5),"#ffff33cc","Normal biodiversity"],[n,"#ff3300cc","Very high biodiversity"]]},"*census":function(t,n){return[[-1,"#ddddddcc","Missing"],[t,"#efd100cc","Very low biodiversity"],[Go(t,n,.5),"#4eb87bcc","Normal biodiversity"],[n,"#007fc4cc","Very high biodiversity"]]},seqseq:function(t,n){return[[-1,"#ddddddcc","Missing"],[t,"#de4fa6cc","Very low biodiversity"],[Go(t,n,.5),"#4fadd0cc","Normal biodiversity"],[n,"#2a1a8acc","Very high biodiversity"]]},"*parula":function(t,n){return[[-1,"#ddddddcc"],[t,"#352a87cc","Very low"],[Go(t,n,.167),"#0469dfcc"],[Go(t,n,.33),"#06a0cbcc"],[Go(t,n,.5),"#1fb2accc","Expected"],[Go(t,n,.667),"#a3bd6acc"],[Go(t,n,.833),"#fcc336cc"],[n,"#f8f611cc","Very high"]]},"*parula_flip":function(t,n){return[[-1,"#ddddddcc"],[t,"#f8f611cc","Very low"],[Go(t,n,.167),"#fcc336cc"],[Go(t,n,.33),"#a3bd6acc"],[Go(t,n,.5),"#1fb2accc","Expected"],[Go(t,n,.667),"#06a0cbcc"],[Go(t,n,.833),"#0469dfcc"],[n,"#352a87cc","Very high"]]},"*ibm":function(t,n){return[[-1,"#ddddddcc"],[t,"#648FFFcc","Very low"],[Go(t,n,.25),"#785EF0cc"],[Go(t,n,.5),"#DC267Fcc","Expected"],[Go(t,n,.75),"#FE6100cc"],[n,"#FFB000cc","Very high"]]}};function Am(){return{100:"#e9f6fc",200:"#b9e4f7",300:"#89d1f0",400:"#59bee9",500:"#29abe2",600:"#2186af",700:"#175f7c",800:"#0d3849",900:"#031116"}}function px(e,t,n){const c=e.slice();return c[18]=t[n],c}function mx(e){let t,n=e[18]+"",c;return{c(){t=qn("option"),c=Po(n),this.h()},l(g){t=Hn(g,"OPTION",{});var b=Tn(t);c=Do(b,n),b.forEach(Ci),this.h()},h(){t.__value=e[18],YI(t,t.__value)},m(g,b){Zn(g,t,b),Qi(t,c)},p:lo,d(g){g&&Ci(t)}}}function KC(e){let t,n,c,g="Palette",b,E,a,U,W,ce="Show county lines?",oe,fe,we,et,lt,Ke="Show ecoregions?",st,ut,kt,Bt,Rt,Ge="Draw Mode?",ni,it,xt="Draw Polygon",_t,mt,bt="Reset",dt,nt,pt=_c(e[8]),at=[];for(let Nt=0;Nt<pt.length;Nt+=1)at[Nt]=mx(px(e,pt,Nt));return{c(){t=qn("div"),n=qn("div"),c=qn("h4"),c.textContent=g,b=Or(),E=qn("select");for(let Nt=0;Nt<at.length;Nt+=1)at[Nt].c();a=Or(),U=qn("div"),W=qn("h4"),W.textContent=ce,oe=Or(),fe=qn("input"),we=Or(),et=qn("div"),lt=qn("h4"),lt.textContent=Ke,st=Or(),ut=qn("input"),kt=Or(),Bt=qn("div"),Rt=qn("h4"),Rt.textContent=Ge,ni=Or(),it=qn("button"),it.textContent=xt,_t=Or(),mt=qn("button"),mt.textContent=bt,this.h()},l(Nt){t=Hn(Nt,"DIV",{class:!0});var Ft=Tn(t);n=Hn(Ft,"DIV",{class:!0});var Dt=Tn(n);c=Hn(Dt,"H4",{class:!0,"data-svelte-h":!0}),ec(c)!=="svelte-16skbun"&&(c.textContent=g),b=Nr(Dt),E=Hn(Dt,"SELECT",{label:!0});var ci=Tn(E);for(let rn=0;rn<at.length;rn+=1)at[rn].l(ci);ci.forEach(Ci),Dt.forEach(Ci),a=Nr(Ft),U=Hn(Ft,"DIV",{class:!0});var bi=Tn(U);W=Hn(bi,"H4",{class:!0,"data-svelte-h":!0}),ec(W)!=="svelte-tf6nwt"&&(W.textContent=ce),oe=Nr(bi),fe=Hn(bi,"INPUT",{type:!0}),bi.forEach(Ci),we=Nr(Ft),et=Hn(Ft,"DIV",{class:!0});var ki=Tn(et);lt=Hn(ki,"H4",{class:!0,"data-svelte-h":!0}),ec(lt)!=="svelte-1f8vskc"&&(lt.textContent=Ke),st=Nr(ki),ut=Hn(ki,"INPUT",{type:!0}),ki.forEach(Ci),kt=Nr(Ft),Bt=Hn(Ft,"DIV",{class:!0});var Gi=Tn(Bt);Rt=Hn(Gi,"H4",{class:!0,"data-svelte-h":!0}),ec(Rt)!=="svelte-hi5xw8"&&(Rt.textContent=Ge),ni=Nr(Gi),it=Hn(Gi,"BUTTON",{"data-svelte-h":!0}),ec(it)!=="svelte-o8r62u"&&(it.textContent=xt),_t=Nr(Gi),mt=Hn(Gi,"BUTTON",{"data-svelte-h":!0}),ec(mt)!=="svelte-2y01av"&&(mt.textContent=bt),Gi.forEach(Ci),Ft.forEach(Ci),this.h()},h(){Fi(c,"class","svelte-11w56ip"),Fi(E,"label","Color Scheme"),e[5]===void 0&&WI(()=>e[10].call(E)),Fi(n,"class","control-item svelte-11w56ip"),Fi(W,"class","svelte-11w56ip"),Fi(fe,"type","checkbox"),Fi(U,"class","control-item svelte-11w56ip"),Fi(lt,"class","svelte-11w56ip"),Fi(ut,"type","checkbox"),Fi(et,"class","control-item svelte-11w56ip"),Fi(Rt,"class","svelte-11w56ip"),Fi(Bt,"class","control-item svelte-11w56ip"),Fi(t,"class","controls svelte-11w56ip")},m(Nt,Ft){Zn(Nt,t,Ft),Qi(t,n),Qi(n,c),Qi(n,b),Qi(n,E);for(let Dt=0;Dt<at.length;Dt+=1)at[Dt]&&at[Dt].m(E,null);F2(E,e[5],!0),Qi(t,a),Qi(t,U),Qi(U,W),Qi(U,oe),Qi(U,fe),fe.checked=e[6],Qi(t,we),Qi(t,et),Qi(et,lt),Qi(et,st),Qi(et,ut),ut.checked=e[7],Qi(t,kt),Qi(t,Bt),Qi(Bt,Rt),Qi(Bt,ni),Qi(Bt,it),Qi(Bt,_t),Qi(Bt,mt),dt||(nt=[Gl(E,"change",e[10]),Gl(E,"change",e[11]),Gl(fe,"change",e[12]),Gl(fe,"change",e[13]),Gl(ut,"change",e[14]),Gl(ut,"change",e[15]),Gl(it,"click",e[16]),Gl(mt,"click",e[17])],dt=!0)},p(Nt,[Ft]){if(Ft&256){pt=_c(Nt[8]);let Dt;for(Dt=0;Dt<pt.length;Dt+=1){const ci=px(Nt,pt,Dt);at[Dt]?at[Dt].p(ci,Ft):(at[Dt]=mx(ci),at[Dt].c(),at[Dt].m(E,null))}for(;Dt<at.length;Dt+=1)at[Dt].d(1);at.length=pt.length}Ft&288&&F2(E,Nt[5]),Ft&64&&(fe.checked=Nt[6]),Ft&128&&(ut.checked=Nt[7])},i:lo,o:lo,d(Nt){Nt&&Ci(t),U0(at,Nt),dt=!1,Oh(nt)}}}function JC(e,t,n){let{updateColorScheme:c}=t,{updateShowCounties:g}=t,{updateShowEcoregions:b}=t,{updateDrawing:E}=t,{updateDrawnPath:a}=t,{isDrawing:U}=t,W,ce,oe;const fe=Object.keys(Mv);Zc(()=>{c(W)});function we(){W=$I(this),n(5,W),n(8,fe)}const et=()=>c(W);function lt(){ce=this.checked,n(6,ce)}const Ke=()=>g(ce);function st(){oe=this.checked,n(7,oe)}const ut=()=>b(oe),kt=()=>E(!0),Bt=()=>a(null);return e.$$set=Rt=>{"updateColorScheme"in Rt&&n(0,c=Rt.updateColorScheme),"updateShowCounties"in Rt&&n(1,g=Rt.updateShowCounties),"updateShowEcoregions"in Rt&&n(2,b=Rt.updateShowEcoregions),"updateDrawing"in Rt&&n(3,E=Rt.updateDrawing),"updateDrawnPath"in Rt&&n(4,a=Rt.updateDrawnPath),"isDrawing"in Rt&&n(9,U=Rt.isDrawing)},[c,g,b,E,a,W,ce,oe,fe,U,we,et,lt,Ke,st,ut,kt,Bt]}class eT extends Lo{constructor(t){super(),Bo(this,t,JC,KC,co,{updateColorScheme:0,updateShowCounties:1,updateShowEcoregions:2,updateDrawing:3,updateDrawnPath:4,isDrawing:9})}}var Kf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function c(){return this instanceof c?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(c){var g=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(n,c,g.get?g:{enumerable:!0,get:function(){return e[c]}})}),n}function tT(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var o3={exports:{}};const iT={},nT=Object.freeze(Object.defineProperty({__proto__:null,default:iT},Symbol.toStringTag,{value:"Module"})),gx=Pv(nT);var Vg={exports:{}},_x;function rT(){return _x||(_x=1,function(e,t){(function(n,c){c(t)})(Kf,function(n){var c=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],g=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],b="-----------------------------------------------------------------------------------------------------------------------------------------------------",E="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},U="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",W={5:U,"5module":U+" export import",6:U+" const class extends export import super"},ce=/^in(stanceof)?$/,oe=new RegExp("["+E+"]"),fe=new RegExp("["+E+b+"]");function we(N,xe){for(var tt=65536,It=0;It<xe.length;It+=2){if(tt+=xe[It],tt>N)return!1;if(tt+=xe[It+1],tt>=N)return!0}return!1}function et(N,xe){return N<65?N===36:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&oe.test(String.fromCharCode(N)):xe===!1?!1:we(N,g)}function lt(N,xe){return N<48?N===36:N<58?!0:N<65?!1:N<91?!0:N<97?N===95:N<123?!0:N<=65535?N>=170&&fe.test(String.fromCharCode(N)):xe===!1?!1:we(N,g)||we(N,c)}var Ke=function(xe,tt){tt===void 0&&(tt={}),this.label=xe,this.keyword=tt.keyword,this.beforeExpr=!!tt.beforeExpr,this.startsExpr=!!tt.startsExpr,this.isLoop=!!tt.isLoop,this.isAssign=!!tt.isAssign,this.prefix=!!tt.prefix,this.postfix=!!tt.postfix,this.binop=tt.binop||null,this.updateContext=null};function st(N,xe){return new Ke(N,{beforeExpr:!0,binop:xe})}var ut={beforeExpr:!0},kt={startsExpr:!0},Bt={};function Rt(N,xe){return xe===void 0&&(xe={}),xe.keyword=N,Bt[N]=new Ke(N,xe)}var Ge={num:new Ke("num",kt),regexp:new Ke("regexp",kt),string:new Ke("string",kt),name:new Ke("name",kt),privateId:new Ke("privateId",kt),eof:new Ke("eof"),bracketL:new Ke("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Ke("]"),braceL:new Ke("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Ke("}"),parenL:new Ke("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Ke(")"),comma:new Ke(",",ut),semi:new Ke(";",ut),colon:new Ke(":",ut),dot:new Ke("."),question:new Ke("?",ut),questionDot:new Ke("?."),arrow:new Ke("=>",ut),template:new Ke("template"),invalidTemplate:new Ke("invalidTemplate"),ellipsis:new Ke("...",ut),backQuote:new Ke("`",kt),dollarBraceL:new Ke("${",{beforeExpr:!0,startsExpr:!0}),eq:new Ke("=",{beforeExpr:!0,isAssign:!0}),assign:new Ke("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Ke("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Ke("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:st("||",1),logicalAND:st("&&",2),bitwiseOR:st("|",3),bitwiseXOR:st("^",4),bitwiseAND:st("&",5),equality:st("==/!=/===/!==",6),relational:st("</>/<=/>=",7),bitShift:st("<</>>/>>>",8),plusMin:new Ke("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:st("%",10),star:st("*",10),slash:st("/",10),starstar:new Ke("**",{beforeExpr:!0}),coalesce:st("??",1),_break:Rt("break"),_case:Rt("case",ut),_catch:Rt("catch"),_continue:Rt("continue"),_debugger:Rt("debugger"),_default:Rt("default",ut),_do:Rt("do",{isLoop:!0,beforeExpr:!0}),_else:Rt("else",ut),_finally:Rt("finally"),_for:Rt("for",{isLoop:!0}),_function:Rt("function",kt),_if:Rt("if"),_return:Rt("return",ut),_switch:Rt("switch"),_throw:Rt("throw",ut),_try:Rt("try"),_var:Rt("var"),_const:Rt("const"),_while:Rt("while",{isLoop:!0}),_with:Rt("with"),_new:Rt("new",{beforeExpr:!0,startsExpr:!0}),_this:Rt("this",kt),_super:Rt("super",kt),_class:Rt("class",kt),_extends:Rt("extends",ut),_export:Rt("export"),_import:Rt("import",kt),_null:Rt("null",kt),_true:Rt("true",kt),_false:Rt("false",kt),_in:Rt("in",{beforeExpr:!0,binop:7}),_instanceof:Rt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Rt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Rt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Rt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},ni=/\r\n?|\n|\u2028|\u2029/,it=new RegExp(ni.source,"g");function xt(N){return N===10||N===13||N===8232||N===8233}function _t(N,xe,tt){tt===void 0&&(tt=N.length);for(var It=xe;It<tt;It++){var Wt=N.charCodeAt(It);if(xt(Wt))return It<tt-1&&Wt===13&&N.charCodeAt(It+1)===10?It+2:It+1}return-1}var mt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,bt=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,dt=Object.prototype,nt=dt.hasOwnProperty,pt=dt.toString,at=Object.hasOwn||function(N,xe){return nt.call(N,xe)},Nt=Array.isArray||function(N){return pt.call(N)==="[object Array]"},Ft=Object.create(null);function Dt(N){return Ft[N]||(Ft[N]=new RegExp("^(?:"+N.replace(/ /g,"|")+")$"))}function ci(N){return N<=65535?String.fromCharCode(N):(N-=65536,String.fromCharCode((N>>10)+55296,(N&1023)+56320))}var bi=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,ki=function(xe,tt){this.line=xe,this.column=tt};ki.prototype.offset=function(xe){return new ki(this.line,this.column+xe)};var Gi=function(xe,tt,It){this.start=tt,this.end=It,xe.sourceFile!==null&&(this.source=xe.sourceFile)};function rn(N,xe){for(var tt=1,It=0;;){var Wt=_t(N,It,xe);if(Wt<0)return new ki(tt,xe-It);++tt,It=Wt}}var $i={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},qi=!1;function sn(N){var xe={};for(var tt in $i)xe[tt]=N&&at(N,tt)?N[tt]:$i[tt];if(xe.ecmaVersion==="latest"?xe.ecmaVersion=1e8:xe.ecmaVersion==null?(!qi&&typeof console=="object"&&console.warn&&(qi=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),xe.ecmaVersion=11):xe.ecmaVersion>=2015&&(xe.ecmaVersion-=2009),xe.allowReserved==null&&(xe.allowReserved=xe.ecmaVersion<5),(!N||N.allowHashBang==null)&&(xe.allowHashBang=xe.ecmaVersion>=14),Nt(xe.onToken)){var It=xe.onToken;xe.onToken=function(Wt){return It.push(Wt)}}return Nt(xe.onComment)&&(xe.onComment=Ti(xe,xe.onComment)),xe}function Ti(N,xe){return function(tt,It,Wt,Si,Bi,un){var An={type:tt?"Block":"Line",value:It,start:Wt,end:Si};N.locations&&(An.loc=new Gi(this,Bi,un)),N.ranges&&(An.range=[Wt,Si]),xe.push(An)}}var yi=1,hi=2,Ei=4,Li=8,fn=16,_n=32,gi=64,mn=128,ti=256,Mn=yi|hi|ti;function ns(N,xe){return hi|(N?Ei:0)|(xe?Li:0)}var fi=0,ln=1,pr=2,On=3,Qn=4,wn=5,v=function(xe,tt,It){this.options=xe=sn(xe),this.sourceFile=xe.sourceFile,this.keywords=Dt(W[xe.ecmaVersion>=6?6:xe.sourceType==="module"?"5module":5]);var Wt="";xe.allowReserved!==!0&&(Wt=a[xe.ecmaVersion>=6?6:xe.ecmaVersion===5?5:3],xe.sourceType==="module"&&(Wt+=" await")),this.reservedWords=Dt(Wt);var Si=(Wt?Wt+" ":"")+a.strict;this.reservedWordsStrict=Dt(Si),this.reservedWordsStrictBind=Dt(Si+" "+a.strictBind),this.input=String(tt),this.containsEsc=!1,It?(this.pos=It,this.lineStart=this.input.lastIndexOf(`
`,It-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(ni).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Ge.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=xe.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&xe.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(yi),this.regexpState=null,this.privateNameStack=[]},k={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};v.prototype.parse=function(){var xe=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(xe)},k.inFunction.get=function(){return(this.currentVarScope().flags&hi)>0},k.inGenerator.get=function(){return(this.currentVarScope().flags&Li)>0&&!this.currentVarScope().inClassFieldInit},k.inAsync.get=function(){return(this.currentVarScope().flags&Ei)>0&&!this.currentVarScope().inClassFieldInit},k.canAwait.get=function(){for(var N=this.scopeStack.length-1;N>=0;N--){var xe=this.scopeStack[N];if(xe.inClassFieldInit||xe.flags&ti)return!1;if(xe.flags&hi)return(xe.flags&Ei)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},k.allowSuper.get=function(){var N=this.currentThisScope(),xe=N.flags,tt=N.inClassFieldInit;return(xe&gi)>0||tt||this.options.allowSuperOutsideMethod},k.allowDirectSuper.get=function(){return(this.currentThisScope().flags&mn)>0},k.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},k.allowNewDotTarget.get=function(){var N=this.currentThisScope(),xe=N.flags,tt=N.inClassFieldInit;return(xe&(hi|ti))>0||tt},k.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&ti)>0},v.extend=function(){for(var xe=[],tt=arguments.length;tt--;)xe[tt]=arguments[tt];for(var It=this,Wt=0;Wt<xe.length;Wt++)It=xe[Wt](It);return It},v.parse=function(xe,tt){return new this(tt,xe).parse()},v.parseExpressionAt=function(xe,tt,It){var Wt=new this(It,xe,tt);return Wt.nextToken(),Wt.parseExpression()},v.tokenizer=function(xe,tt){return new this(tt,xe)},Object.defineProperties(v.prototype,k);var V=v.prototype,$=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;V.strictDirective=function(N){if(this.options.ecmaVersion<5)return!1;for(;;){bt.lastIndex=N,N+=bt.exec(this.input)[0].length;var xe=$.exec(this.input.slice(N));if(!xe)return!1;if((xe[1]||xe[2])==="use strict"){bt.lastIndex=N+xe[0].length;var tt=bt.exec(this.input),It=tt.index+tt[0].length,Wt=this.input.charAt(It);return Wt===";"||Wt==="}"||ni.test(tt[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(Wt)||Wt==="!"&&this.input.charAt(It+1)==="=")}N+=xe[0].length,bt.lastIndex=N,N+=bt.exec(this.input)[0].length,this.input[N]===";"&&N++}},V.eat=function(N){return this.type===N?(this.next(),!0):!1},V.isContextual=function(N){return this.type===Ge.name&&this.value===N&&!this.containsEsc},V.eatContextual=function(N){return this.isContextual(N)?(this.next(),!0):!1},V.expectContextual=function(N){this.eatContextual(N)||this.unexpected()},V.canInsertSemicolon=function(){return this.type===Ge.eof||this.type===Ge.braceR||ni.test(this.input.slice(this.lastTokEnd,this.start))},V.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},V.semicolon=function(){!this.eat(Ge.semi)&&!this.insertSemicolon()&&this.unexpected()},V.afterTrailingComma=function(N,xe){if(this.type===N)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),xe||this.next(),!0},V.expect=function(N){this.eat(N)||this.unexpected()},V.unexpected=function(N){this.raise(N??this.start,"Unexpected token")};var te=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};V.checkPatternErrors=function(N,xe){if(N){N.trailingComma>-1&&this.raiseRecoverable(N.trailingComma,"Comma is not permitted after the rest element");var tt=xe?N.parenthesizedAssign:N.parenthesizedBind;tt>-1&&this.raiseRecoverable(tt,xe?"Assigning to rvalue":"Parenthesized pattern")}},V.checkExpressionErrors=function(N,xe){if(!N)return!1;var tt=N.shorthandAssign,It=N.doubleProto;if(!xe)return tt>=0||It>=0;tt>=0&&this.raise(tt,"Shorthand property assignments are valid only in destructuring patterns"),It>=0&&this.raiseRecoverable(It,"Redefinition of __proto__ property")},V.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},V.isSimpleAssignTarget=function(N){return N.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(N.expression):N.type==="Identifier"||N.type==="MemberExpression"};var Ae=v.prototype;Ae.parseTopLevel=function(N){var xe=Object.create(null);for(N.body||(N.body=[]);this.type!==Ge.eof;){var tt=this.parseStatement(null,!0,xe);N.body.push(tt)}if(this.inModule)for(var It=0,Wt=Object.keys(this.undefinedExports);It<Wt.length;It+=1){var Si=Wt[It];this.raiseRecoverable(this.undefinedExports[Si].start,"Export '"+Si+"' is not defined")}return this.adaptDirectivePrologue(N.body),this.next(),N.sourceType=this.options.sourceType,this.finishNode(N,"Program")};var ve={kind:"loop"},Ie={kind:"switch"};Ae.isLet=function(N){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;bt.lastIndex=this.pos;var xe=bt.exec(this.input),tt=this.pos+xe[0].length,It=this.input.charCodeAt(tt);if(It===91||It===92)return!0;if(N)return!1;if(It===123||It>55295&&It<56320)return!0;if(et(It,!0)){for(var Wt=tt+1;lt(It=this.input.charCodeAt(Wt),!0);)++Wt;if(It===92||It>55295&&It<56320)return!0;var Si=this.input.slice(tt,Wt);if(!ce.test(Si))return!0}return!1},Ae.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;bt.lastIndex=this.pos;var N=bt.exec(this.input),xe=this.pos+N[0].length,tt;return!ni.test(this.input.slice(this.pos,xe))&&this.input.slice(xe,xe+8)==="function"&&(xe+8===this.input.length||!(lt(tt=this.input.charCodeAt(xe+8))||tt>55295&&tt<56320))},Ae.parseStatement=function(N,xe,tt){var It=this.type,Wt=this.startNode(),Si;switch(this.isLet(N)&&(It=Ge._var,Si="let"),It){case Ge._break:case Ge._continue:return this.parseBreakContinueStatement(Wt,It.keyword);case Ge._debugger:return this.parseDebuggerStatement(Wt);case Ge._do:return this.parseDoStatement(Wt);case Ge._for:return this.parseForStatement(Wt);case Ge._function:return N&&(this.strict||N!=="if"&&N!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(Wt,!1,!N);case Ge._class:return N&&this.unexpected(),this.parseClass(Wt,!0);case Ge._if:return this.parseIfStatement(Wt);case Ge._return:return this.parseReturnStatement(Wt);case Ge._switch:return this.parseSwitchStatement(Wt);case Ge._throw:return this.parseThrowStatement(Wt);case Ge._try:return this.parseTryStatement(Wt);case Ge._const:case Ge._var:return Si=Si||this.value,N&&Si!=="var"&&this.unexpected(),this.parseVarStatement(Wt,Si);case Ge._while:return this.parseWhileStatement(Wt);case Ge._with:return this.parseWithStatement(Wt);case Ge.braceL:return this.parseBlock(!0,Wt);case Ge.semi:return this.parseEmptyStatement(Wt);case Ge._export:case Ge._import:if(this.options.ecmaVersion>10&&It===Ge._import){bt.lastIndex=this.pos;var Bi=bt.exec(this.input),un=this.pos+Bi[0].length,An=this.input.charCodeAt(un);if(An===40||An===46)return this.parseExpressionStatement(Wt,this.parseExpression())}return this.options.allowImportExportEverywhere||(xe||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),It===Ge._import?this.parseImport(Wt):this.parseExport(Wt,tt);default:if(this.isAsyncFunction())return N&&this.unexpected(),this.next(),this.parseFunctionStatement(Wt,!0,!N);var rr=this.value,hr=this.parseExpression();return It===Ge.name&&hr.type==="Identifier"&&this.eat(Ge.colon)?this.parseLabeledStatement(Wt,rr,hr,N):this.parseExpressionStatement(Wt,hr)}},Ae.parseBreakContinueStatement=function(N,xe){var tt=xe==="break";this.next(),this.eat(Ge.semi)||this.insertSemicolon()?N.label=null:this.type!==Ge.name?this.unexpected():(N.label=this.parseIdent(),this.semicolon());for(var It=0;It<this.labels.length;++It){var Wt=this.labels[It];if((N.label==null||Wt.name===N.label.name)&&(Wt.kind!=null&&(tt||Wt.kind==="loop")||N.label&&tt))break}return It===this.labels.length&&this.raise(N.start,"Unsyntactic "+xe),this.finishNode(N,tt?"BreakStatement":"ContinueStatement")},Ae.parseDebuggerStatement=function(N){return this.next(),this.semicolon(),this.finishNode(N,"DebuggerStatement")},Ae.parseDoStatement=function(N){return this.next(),this.labels.push(ve),N.body=this.parseStatement("do"),this.labels.pop(),this.expect(Ge._while),N.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Ge.semi):this.semicolon(),this.finishNode(N,"DoWhileStatement")},Ae.parseForStatement=function(N){this.next();var xe=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(ve),this.enterScope(0),this.expect(Ge.parenL),this.type===Ge.semi)return xe>-1&&this.unexpected(xe),this.parseFor(N,null);var tt=this.isLet();if(this.type===Ge._var||this.type===Ge._const||tt){var It=this.startNode(),Wt=tt?"let":this.value;return this.next(),this.parseVar(It,!0,Wt),this.finishNode(It,"VariableDeclaration"),(this.type===Ge._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&It.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===Ge._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),this.parseForIn(N,It)):(xe>-1&&this.unexpected(xe),this.parseFor(N,It))}var Si=this.isContextual("let"),Bi=!1,un=new te,An=this.parseExpression(xe>-1?"await":!0,un);return this.type===Ge._in||(Bi=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===Ge._in?xe>-1&&this.unexpected(xe):N.await=xe>-1),Si&&Bi&&this.raise(An.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(An,!1,un),this.checkLValPattern(An),this.parseForIn(N,An)):(this.checkExpressionErrors(un,!0),xe>-1&&this.unexpected(xe),this.parseFor(N,An))},Ae.parseFunctionStatement=function(N,xe,tt){return this.next(),this.parseFunction(N,ze|(tt?0:Qe),!1,xe)},Ae.parseIfStatement=function(N){return this.next(),N.test=this.parseParenExpression(),N.consequent=this.parseStatement("if"),N.alternate=this.eat(Ge._else)?this.parseStatement("if"):null,this.finishNode(N,"IfStatement")},Ae.parseReturnStatement=function(N){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Ge.semi)||this.insertSemicolon()?N.argument=null:(N.argument=this.parseExpression(),this.semicolon()),this.finishNode(N,"ReturnStatement")},Ae.parseSwitchStatement=function(N){this.next(),N.discriminant=this.parseParenExpression(),N.cases=[],this.expect(Ge.braceL),this.labels.push(Ie),this.enterScope(0);for(var xe,tt=!1;this.type!==Ge.braceR;)if(this.type===Ge._case||this.type===Ge._default){var It=this.type===Ge._case;xe&&this.finishNode(xe,"SwitchCase"),N.cases.push(xe=this.startNode()),xe.consequent=[],this.next(),It?xe.test=this.parseExpression():(tt&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),tt=!0,xe.test=null),this.expect(Ge.colon)}else xe||this.unexpected(),xe.consequent.push(this.parseStatement(null));return this.exitScope(),xe&&this.finishNode(xe,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(N,"SwitchStatement")},Ae.parseThrowStatement=function(N){return this.next(),ni.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),N.argument=this.parseExpression(),this.semicolon(),this.finishNode(N,"ThrowStatement")};var Ee=[];Ae.parseCatchClauseParam=function(){var N=this.parseBindingAtom(),xe=N.type==="Identifier";return this.enterScope(xe?_n:0),this.checkLValPattern(N,xe?Qn:pr),this.expect(Ge.parenR),N},Ae.parseTryStatement=function(N){if(this.next(),N.block=this.parseBlock(),N.handler=null,this.type===Ge._catch){var xe=this.startNode();this.next(),this.eat(Ge.parenL)?xe.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),xe.param=null,this.enterScope(0)),xe.body=this.parseBlock(!1),this.exitScope(),N.handler=this.finishNode(xe,"CatchClause")}return N.finalizer=this.eat(Ge._finally)?this.parseBlock():null,!N.handler&&!N.finalizer&&this.raise(N.start,"Missing catch or finally clause"),this.finishNode(N,"TryStatement")},Ae.parseVarStatement=function(N,xe,tt){return this.next(),this.parseVar(N,!1,xe,tt),this.semicolon(),this.finishNode(N,"VariableDeclaration")},Ae.parseWhileStatement=function(N){return this.next(),N.test=this.parseParenExpression(),this.labels.push(ve),N.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(N,"WhileStatement")},Ae.parseWithStatement=function(N){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),N.object=this.parseParenExpression(),N.body=this.parseStatement("with"),this.finishNode(N,"WithStatement")},Ae.parseEmptyStatement=function(N){return this.next(),this.finishNode(N,"EmptyStatement")},Ae.parseLabeledStatement=function(N,xe,tt,It){for(var Wt=0,Si=this.labels;Wt<Si.length;Wt+=1){var Bi=Si[Wt];Bi.name===xe&&this.raise(tt.start,"Label '"+xe+"' is already declared")}for(var un=this.type.isLoop?"loop":this.type===Ge._switch?"switch":null,An=this.labels.length-1;An>=0;An--){var rr=this.labels[An];if(rr.statementStart===N.start)rr.statementStart=this.start,rr.kind=un;else break}return this.labels.push({name:xe,kind:un,statementStart:this.start}),N.body=this.parseStatement(It?It.indexOf("label")===-1?It+"label":It:"label"),this.labels.pop(),N.label=tt,this.finishNode(N,"LabeledStatement")},Ae.parseExpressionStatement=function(N,xe){return N.expression=xe,this.semicolon(),this.finishNode(N,"ExpressionStatement")},Ae.parseBlock=function(N,xe,tt){for(N===void 0&&(N=!0),xe===void 0&&(xe=this.startNode()),xe.body=[],this.expect(Ge.braceL),N&&this.enterScope(0);this.type!==Ge.braceR;){var It=this.parseStatement(null);xe.body.push(It)}return tt&&(this.strict=!1),this.next(),N&&this.exitScope(),this.finishNode(xe,"BlockStatement")},Ae.parseFor=function(N,xe){return N.init=xe,this.expect(Ge.semi),N.test=this.type===Ge.semi?null:this.parseExpression(),this.expect(Ge.semi),N.update=this.type===Ge.parenR?null:this.parseExpression(),this.expect(Ge.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,"ForStatement")},Ae.parseForIn=function(N,xe){var tt=this.type===Ge._in;return this.next(),xe.type==="VariableDeclaration"&&xe.declarations[0].init!=null&&(!tt||this.options.ecmaVersion<8||this.strict||xe.kind!=="var"||xe.declarations[0].id.type!=="Identifier")&&this.raise(xe.start,(tt?"for-in":"for-of")+" loop variable declaration may not have an initializer"),N.left=xe,N.right=tt?this.parseExpression():this.parseMaybeAssign(),this.expect(Ge.parenR),N.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(N,tt?"ForInStatement":"ForOfStatement")},Ae.parseVar=function(N,xe,tt,It){for(N.declarations=[],N.kind=tt;;){var Wt=this.startNode();if(this.parseVarId(Wt,tt),this.eat(Ge.eq)?Wt.init=this.parseMaybeAssign(xe):!It&&tt==="const"&&!(this.type===Ge._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!It&&Wt.id.type!=="Identifier"&&!(xe&&(this.type===Ge._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):Wt.init=null,N.declarations.push(this.finishNode(Wt,"VariableDeclarator")),!this.eat(Ge.comma))break}return N},Ae.parseVarId=function(N,xe){N.id=this.parseBindingAtom(),this.checkLValPattern(N.id,xe==="var"?ln:pr,!1)};var ze=1,Qe=2,He=4;Ae.parseFunction=function(N,xe,tt,It,Wt){this.initFunction(N),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!It)&&(this.type===Ge.star&&xe&Qe&&this.unexpected(),N.generator=this.eat(Ge.star)),this.options.ecmaVersion>=8&&(N.async=!!It),xe&ze&&(N.id=xe&He&&this.type!==Ge.name?null:this.parseIdent(),N.id&&!(xe&Qe)&&this.checkLValSimple(N.id,this.strict||N.generator||N.async?this.treatFunctionsAsVar?ln:pr:On));var Si=this.yieldPos,Bi=this.awaitPos,un=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ns(N.async,N.generator)),xe&ze||(N.id=this.type===Ge.name?this.parseIdent():null),this.parseFunctionParams(N),this.parseFunctionBody(N,tt,!1,Wt),this.yieldPos=Si,this.awaitPos=Bi,this.awaitIdentPos=un,this.finishNode(N,xe&ze?"FunctionDeclaration":"FunctionExpression")},Ae.parseFunctionParams=function(N){this.expect(Ge.parenL),N.params=this.parseBindingList(Ge.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Ae.parseClass=function(N,xe){this.next();var tt=this.strict;this.strict=!0,this.parseClassId(N,xe),this.parseClassSuper(N);var It=this.enterClassBody(),Wt=this.startNode(),Si=!1;for(Wt.body=[],this.expect(Ge.braceL);this.type!==Ge.braceR;){var Bi=this.parseClassElement(N.superClass!==null);Bi&&(Wt.body.push(Bi),Bi.type==="MethodDefinition"&&Bi.kind==="constructor"?(Si&&this.raiseRecoverable(Bi.start,"Duplicate constructor in the same class"),Si=!0):Bi.key&&Bi.key.type==="PrivateIdentifier"&&Ze(It,Bi)&&this.raiseRecoverable(Bi.key.start,"Identifier '#"+Bi.key.name+"' has already been declared"))}return this.strict=tt,this.next(),N.body=this.finishNode(Wt,"ClassBody"),this.exitClassBody(),this.finishNode(N,xe?"ClassDeclaration":"ClassExpression")},Ae.parseClassElement=function(N){if(this.eat(Ge.semi))return null;var xe=this.options.ecmaVersion,tt=this.startNode(),It="",Wt=!1,Si=!1,Bi="method",un=!1;if(this.eatContextual("static")){if(xe>=13&&this.eat(Ge.braceL))return this.parseClassStaticBlock(tt),tt;this.isClassElementNameStart()||this.type===Ge.star?un=!0:It="static"}if(tt.static=un,!It&&xe>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===Ge.star)&&!this.canInsertSemicolon()?Si=!0:It="async"),!It&&(xe>=9||!Si)&&this.eat(Ge.star)&&(Wt=!0),!It&&!Si&&!Wt){var An=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Bi=An:It=An)}if(It?(tt.computed=!1,tt.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),tt.key.name=It,this.finishNode(tt.key,"Identifier")):this.parseClassElementName(tt),xe<13||this.type===Ge.parenL||Bi!=="method"||Wt||Si){var rr=!tt.static&&Ve(tt,"constructor"),hr=rr&&N;rr&&Bi!=="method"&&this.raise(tt.key.start,"Constructor can't have get/set modifier"),tt.kind=rr?"constructor":Bi,this.parseClassMethod(tt,Wt,Si,hr)}else this.parseClassField(tt);return tt},Ae.isClassElementNameStart=function(){return this.type===Ge.name||this.type===Ge.privateId||this.type===Ge.num||this.type===Ge.string||this.type===Ge.bracketL||this.type.keyword},Ae.parseClassElementName=function(N){this.type===Ge.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),N.computed=!1,N.key=this.parsePrivateIdent()):this.parsePropertyName(N)},Ae.parseClassMethod=function(N,xe,tt,It){var Wt=N.key;N.kind==="constructor"?(xe&&this.raise(Wt.start,"Constructor can't be a generator"),tt&&this.raise(Wt.start,"Constructor can't be an async method")):N.static&&Ve(N,"prototype")&&this.raise(Wt.start,"Classes may not have a static property named prototype");var Si=N.value=this.parseMethod(xe,tt,It);return N.kind==="get"&&Si.params.length!==0&&this.raiseRecoverable(Si.start,"getter should have no params"),N.kind==="set"&&Si.params.length!==1&&this.raiseRecoverable(Si.start,"setter should have exactly one param"),N.kind==="set"&&Si.params[0].type==="RestElement"&&this.raiseRecoverable(Si.params[0].start,"Setter cannot use rest params"),this.finishNode(N,"MethodDefinition")},Ae.parseClassField=function(N){if(Ve(N,"constructor")?this.raise(N.key.start,"Classes can't have a field named 'constructor'"):N.static&&Ve(N,"prototype")&&this.raise(N.key.start,"Classes can't have a static field named 'prototype'"),this.eat(Ge.eq)){var xe=this.currentThisScope(),tt=xe.inClassFieldInit;xe.inClassFieldInit=!0,N.value=this.parseMaybeAssign(),xe.inClassFieldInit=tt}else N.value=null;return this.semicolon(),this.finishNode(N,"PropertyDefinition")},Ae.parseClassStaticBlock=function(N){N.body=[];var xe=this.labels;for(this.labels=[],this.enterScope(ti|gi);this.type!==Ge.braceR;){var tt=this.parseStatement(null);N.body.push(tt)}return this.next(),this.exitScope(),this.labels=xe,this.finishNode(N,"StaticBlock")},Ae.parseClassId=function(N,xe){this.type===Ge.name?(N.id=this.parseIdent(),xe&&this.checkLValSimple(N.id,pr,!1)):(xe===!0&&this.unexpected(),N.id=null)},Ae.parseClassSuper=function(N){N.superClass=this.eat(Ge._extends)?this.parseExprSubscripts(null,!1):null},Ae.enterClassBody=function(){var N={declared:Object.create(null),used:[]};return this.privateNameStack.push(N),N.declared},Ae.exitClassBody=function(){var N=this.privateNameStack.pop(),xe=N.declared,tt=N.used;if(this.options.checkPrivateFields)for(var It=this.privateNameStack.length,Wt=It===0?null:this.privateNameStack[It-1],Si=0;Si<tt.length;++Si){var Bi=tt[Si];at(xe,Bi.name)||(Wt?Wt.used.push(Bi):this.raiseRecoverable(Bi.start,"Private field '#"+Bi.name+"' must be declared in an enclosing class"))}};function Ze(N,xe){var tt=xe.key.name,It=N[tt],Wt="true";return xe.type==="MethodDefinition"&&(xe.kind==="get"||xe.kind==="set")&&(Wt=(xe.static?"s":"i")+xe.kind),It==="iget"&&Wt==="iset"||It==="iset"&&Wt==="iget"||It==="sget"&&Wt==="sset"||It==="sset"&&Wt==="sget"?(N[tt]="true",!1):It?!0:(N[tt]=Wt,!1)}function Ve(N,xe){var tt=N.computed,It=N.key;return!tt&&(It.type==="Identifier"&&It.name===xe||It.type==="Literal"&&It.value===xe)}Ae.parseExportAllDeclaration=function(N,xe){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(N.exported=this.parseModuleExportName(),this.checkExport(xe,N.exported,this.lastTokStart)):N.exported=null),this.expectContextual("from"),this.type!==Ge.string&&this.unexpected(),N.source=this.parseExprAtom(),this.semicolon(),this.finishNode(N,"ExportAllDeclaration")},Ae.parseExport=function(N,xe){if(this.next(),this.eat(Ge.star))return this.parseExportAllDeclaration(N,xe);if(this.eat(Ge._default))return this.checkExport(xe,"default",this.lastTokStart),N.declaration=this.parseExportDefaultDeclaration(),this.finishNode(N,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())N.declaration=this.parseExportDeclaration(N),N.declaration.type==="VariableDeclaration"?this.checkVariableExport(xe,N.declaration.declarations):this.checkExport(xe,N.declaration.id,N.declaration.id.start),N.specifiers=[],N.source=null;else{if(N.declaration=null,N.specifiers=this.parseExportSpecifiers(xe),this.eatContextual("from"))this.type!==Ge.string&&this.unexpected(),N.source=this.parseExprAtom();else{for(var tt=0,It=N.specifiers;tt<It.length;tt+=1){var Wt=It[tt];this.checkUnreserved(Wt.local),this.checkLocalExport(Wt.local),Wt.local.type==="Literal"&&this.raise(Wt.local.start,"A string literal cannot be used as an exported binding without `from`.")}N.source=null}this.semicolon()}return this.finishNode(N,"ExportNamedDeclaration")},Ae.parseExportDeclaration=function(N){return this.parseStatement(null)},Ae.parseExportDefaultDeclaration=function(){var N;if(this.type===Ge._function||(N=this.isAsyncFunction())){var xe=this.startNode();return this.next(),N&&this.next(),this.parseFunction(xe,ze|He,!1,N)}else if(this.type===Ge._class){var tt=this.startNode();return this.parseClass(tt,"nullableID")}else{var It=this.parseMaybeAssign();return this.semicolon(),It}},Ae.checkExport=function(N,xe,tt){N&&(typeof xe!="string"&&(xe=xe.type==="Identifier"?xe.name:xe.value),at(N,xe)&&this.raiseRecoverable(tt,"Duplicate export '"+xe+"'"),N[xe]=!0)},Ae.checkPatternExport=function(N,xe){var tt=xe.type;if(tt==="Identifier")this.checkExport(N,xe,xe.start);else if(tt==="ObjectPattern")for(var It=0,Wt=xe.properties;It<Wt.length;It+=1){var Si=Wt[It];this.checkPatternExport(N,Si)}else if(tt==="ArrayPattern")for(var Bi=0,un=xe.elements;Bi<un.length;Bi+=1){var An=un[Bi];An&&this.checkPatternExport(N,An)}else tt==="Property"?this.checkPatternExport(N,xe.value):tt==="AssignmentPattern"?this.checkPatternExport(N,xe.left):tt==="RestElement"&&this.checkPatternExport(N,xe.argument)},Ae.checkVariableExport=function(N,xe){if(N)for(var tt=0,It=xe;tt<It.length;tt+=1){var Wt=It[tt];this.checkPatternExport(N,Wt.id)}},Ae.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},Ae.parseExportSpecifier=function(N){var xe=this.startNode();return xe.local=this.parseModuleExportName(),xe.exported=this.eatContextual("as")?this.parseModuleExportName():xe.local,this.checkExport(N,xe.exported,xe.exported.start),this.finishNode(xe,"ExportSpecifier")},Ae.parseExportSpecifiers=function(N){var xe=[],tt=!0;for(this.expect(Ge.braceL);!this.eat(Ge.braceR);){if(tt)tt=!1;else if(this.expect(Ge.comma),this.afterTrailingComma(Ge.braceR))break;xe.push(this.parseExportSpecifier(N))}return xe},Ae.parseImport=function(N){return this.next(),this.type===Ge.string?(N.specifiers=Ee,N.source=this.parseExprAtom()):(N.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),N.source=this.type===Ge.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(N,"ImportDeclaration")},Ae.parseImportSpecifier=function(){var N=this.startNode();return N.imported=this.parseModuleExportName(),this.eatContextual("as")?N.local=this.parseIdent():(this.checkUnreserved(N.imported),N.local=N.imported),this.checkLValSimple(N.local,pr),this.finishNode(N,"ImportSpecifier")},Ae.parseImportDefaultSpecifier=function(){var N=this.startNode();return N.local=this.parseIdent(),this.checkLValSimple(N.local,pr),this.finishNode(N,"ImportDefaultSpecifier")},Ae.parseImportNamespaceSpecifier=function(){var N=this.startNode();return this.next(),this.expectContextual("as"),N.local=this.parseIdent(),this.checkLValSimple(N.local,pr),this.finishNode(N,"ImportNamespaceSpecifier")},Ae.parseImportSpecifiers=function(){var N=[],xe=!0;if(this.type===Ge.name&&(N.push(this.parseImportDefaultSpecifier()),!this.eat(Ge.comma)))return N;if(this.type===Ge.star)return N.push(this.parseImportNamespaceSpecifier()),N;for(this.expect(Ge.braceL);!this.eat(Ge.braceR);){if(xe)xe=!1;else if(this.expect(Ge.comma),this.afterTrailingComma(Ge.braceR))break;N.push(this.parseImportSpecifier())}return N},Ae.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===Ge.string){var N=this.parseLiteral(this.value);return bi.test(N.value)&&this.raise(N.start,"An export name cannot include a lone surrogate."),N}return this.parseIdent(!0)},Ae.adaptDirectivePrologue=function(N){for(var xe=0;xe<N.length&&this.isDirectiveCandidate(N[xe]);++xe)N[xe].directive=N[xe].expression.raw.slice(1,-1)},Ae.isDirectiveCandidate=function(N){return this.options.ecmaVersion>=5&&N.type==="ExpressionStatement"&&N.expression.type==="Literal"&&typeof N.expression.value=="string"&&(this.input[N.start]==='"'||this.input[N.start]==="'")};var ft=v.prototype;ft.toAssignable=function(N,xe,tt){if(this.options.ecmaVersion>=6&&N)switch(N.type){case"Identifier":this.inAsync&&N.name==="await"&&this.raise(N.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":N.type="ObjectPattern",tt&&this.checkPatternErrors(tt,!0);for(var It=0,Wt=N.properties;It<Wt.length;It+=1){var Si=Wt[It];this.toAssignable(Si,xe),Si.type==="RestElement"&&(Si.argument.type==="ArrayPattern"||Si.argument.type==="ObjectPattern")&&this.raise(Si.argument.start,"Unexpected token")}break;case"Property":N.kind!=="init"&&this.raise(N.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(N.value,xe);break;case"ArrayExpression":N.type="ArrayPattern",tt&&this.checkPatternErrors(tt,!0),this.toAssignableList(N.elements,xe);break;case"SpreadElement":N.type="RestElement",this.toAssignable(N.argument,xe),N.argument.type==="AssignmentPattern"&&this.raise(N.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":N.operator!=="="&&this.raise(N.left.end,"Only '=' operator can be used for specifying default value."),N.type="AssignmentPattern",delete N.operator,this.toAssignable(N.left,xe);break;case"ParenthesizedExpression":this.toAssignable(N.expression,xe,tt);break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!xe)break;default:this.raise(N.start,"Assigning to rvalue")}else tt&&this.checkPatternErrors(tt,!0);return N},ft.toAssignableList=function(N,xe){for(var tt=N.length,It=0;It<tt;It++){var Wt=N[It];Wt&&this.toAssignable(Wt,xe)}if(tt){var Si=N[tt-1];this.options.ecmaVersion===6&&xe&&Si&&Si.type==="RestElement"&&Si.argument.type!=="Identifier"&&this.unexpected(Si.argument.start)}return N},ft.parseSpread=function(N){var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeAssign(!1,N),this.finishNode(xe,"SpreadElement")},ft.parseRestBinding=function(){var N=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==Ge.name&&this.unexpected(),N.argument=this.parseBindingAtom(),this.finishNode(N,"RestElement")},ft.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Ge.bracketL:var N=this.startNode();return this.next(),N.elements=this.parseBindingList(Ge.bracketR,!0,!0),this.finishNode(N,"ArrayPattern");case Ge.braceL:return this.parseObj(!0)}return this.parseIdent()},ft.parseBindingList=function(N,xe,tt,It){for(var Wt=[],Si=!0;!this.eat(N);)if(Si?Si=!1:this.expect(Ge.comma),xe&&this.type===Ge.comma)Wt.push(null);else{if(tt&&this.afterTrailingComma(N))break;if(this.type===Ge.ellipsis){var Bi=this.parseRestBinding();this.parseBindingListItem(Bi),Wt.push(Bi),this.type===Ge.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(N);break}else Wt.push(this.parseAssignableListItem(It))}return Wt},ft.parseAssignableListItem=function(N){var xe=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(xe),xe},ft.parseBindingListItem=function(N){return N},ft.parseMaybeDefault=function(N,xe,tt){if(tt=tt||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Ge.eq))return tt;var It=this.startNodeAt(N,xe);return It.left=tt,It.right=this.parseMaybeAssign(),this.finishNode(It,"AssignmentPattern")},ft.checkLValSimple=function(N,xe,tt){xe===void 0&&(xe=fi);var It=xe!==fi;switch(N.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(N.name)&&this.raiseRecoverable(N.start,(It?"Binding ":"Assigning to ")+N.name+" in strict mode"),It&&(xe===pr&&N.name==="let"&&this.raiseRecoverable(N.start,"let is disallowed as a lexically bound name"),tt&&(at(tt,N.name)&&this.raiseRecoverable(N.start,"Argument name clash"),tt[N.name]=!0),xe!==wn&&this.declareName(N.name,xe,N.start));break;case"ChainExpression":this.raiseRecoverable(N.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":It&&this.raiseRecoverable(N.start,"Binding member expression");break;case"ParenthesizedExpression":return It&&this.raiseRecoverable(N.start,"Binding parenthesized expression"),this.checkLValSimple(N.expression,xe,tt);default:this.raise(N.start,(It?"Binding":"Assigning to")+" rvalue")}},ft.checkLValPattern=function(N,xe,tt){switch(xe===void 0&&(xe=fi),N.type){case"ObjectPattern":for(var It=0,Wt=N.properties;It<Wt.length;It+=1){var Si=Wt[It];this.checkLValInnerPattern(Si,xe,tt)}break;case"ArrayPattern":for(var Bi=0,un=N.elements;Bi<un.length;Bi+=1){var An=un[Bi];An&&this.checkLValInnerPattern(An,xe,tt)}break;default:this.checkLValSimple(N,xe,tt)}},ft.checkLValInnerPattern=function(N,xe,tt){switch(xe===void 0&&(xe=fi),N.type){case"Property":this.checkLValInnerPattern(N.value,xe,tt);break;case"AssignmentPattern":this.checkLValPattern(N.left,xe,tt);break;case"RestElement":this.checkLValPattern(N.argument,xe,tt);break;default:this.checkLValPattern(N,xe,tt)}};var rt=function(xe,tt,It,Wt,Si){this.token=xe,this.isExpr=!!tt,this.preserveSpace=!!It,this.override=Wt,this.generator=!!Si},Me={b_stat:new rt("{",!1),b_expr:new rt("{",!0),b_tmpl:new rt("${",!1),p_stat:new rt("(",!1),p_expr:new rt("(",!0),q_tmpl:new rt("`",!0,!0,function(N){return N.tryReadTemplateToken()}),f_stat:new rt("function",!1),f_expr:new rt("function",!0),f_expr_gen:new rt("function",!0,!1,null,!0),f_gen:new rt("function",!1,!1,null,!0)},se=v.prototype;se.initialContext=function(){return[Me.b_stat]},se.curContext=function(){return this.context[this.context.length-1]},se.braceIsBlock=function(N){var xe=this.curContext();return xe===Me.f_expr||xe===Me.f_stat?!0:N===Ge.colon&&(xe===Me.b_stat||xe===Me.b_expr)?!xe.isExpr:N===Ge._return||N===Ge.name&&this.exprAllowed?ni.test(this.input.slice(this.lastTokEnd,this.start)):N===Ge._else||N===Ge.semi||N===Ge.eof||N===Ge.parenR||N===Ge.arrow?!0:N===Ge.braceL?xe===Me.b_stat:N===Ge._var||N===Ge._const||N===Ge.name?!1:!this.exprAllowed},se.inGeneratorContext=function(){for(var N=this.context.length-1;N>=1;N--){var xe=this.context[N];if(xe.token==="function")return xe.generator}return!1},se.updateContext=function(N){var xe,tt=this.type;tt.keyword&&N===Ge.dot?this.exprAllowed=!1:(xe=tt.updateContext)?xe.call(this,N):this.exprAllowed=tt.beforeExpr},se.overrideContext=function(N){this.curContext()!==N&&(this.context[this.context.length-1]=N)},Ge.parenR.updateContext=Ge.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var N=this.context.pop();N===Me.b_stat&&this.curContext().token==="function"&&(N=this.context.pop()),this.exprAllowed=!N.isExpr},Ge.braceL.updateContext=function(N){this.context.push(this.braceIsBlock(N)?Me.b_stat:Me.b_expr),this.exprAllowed=!0},Ge.dollarBraceL.updateContext=function(){this.context.push(Me.b_tmpl),this.exprAllowed=!0},Ge.parenL.updateContext=function(N){var xe=N===Ge._if||N===Ge._for||N===Ge._with||N===Ge._while;this.context.push(xe?Me.p_stat:Me.p_expr),this.exprAllowed=!0},Ge.incDec.updateContext=function(){},Ge._function.updateContext=Ge._class.updateContext=function(N){N.beforeExpr&&N!==Ge._else&&!(N===Ge.semi&&this.curContext()!==Me.p_stat)&&!(N===Ge._return&&ni.test(this.input.slice(this.lastTokEnd,this.start)))&&!((N===Ge.colon||N===Ge.braceL)&&this.curContext()===Me.b_stat)?this.context.push(Me.f_expr):this.context.push(Me.f_stat),this.exprAllowed=!1},Ge.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},Ge.backQuote.updateContext=function(){this.curContext()===Me.q_tmpl?this.context.pop():this.context.push(Me.q_tmpl),this.exprAllowed=!1},Ge.star.updateContext=function(N){if(N===Ge._function){var xe=this.context.length-1;this.context[xe]===Me.f_expr?this.context[xe]=Me.f_expr_gen:this.context[xe]=Me.f_gen}this.exprAllowed=!0},Ge.name.updateContext=function(N){var xe=!1;this.options.ecmaVersion>=6&&N!==Ge.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(xe=!0),this.exprAllowed=xe};var ne=v.prototype;ne.checkPropClash=function(N,xe,tt){if(!(this.options.ecmaVersion>=9&&N.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(N.computed||N.method||N.shorthand))){var It=N.key,Wt;switch(It.type){case"Identifier":Wt=It.name;break;case"Literal":Wt=String(It.value);break;default:return}var Si=N.kind;if(this.options.ecmaVersion>=6){Wt==="__proto__"&&Si==="init"&&(xe.proto&&(tt?tt.doubleProto<0&&(tt.doubleProto=It.start):this.raiseRecoverable(It.start,"Redefinition of __proto__ property")),xe.proto=!0);return}Wt="$"+Wt;var Bi=xe[Wt];if(Bi){var un;Si==="init"?un=this.strict&&Bi.init||Bi.get||Bi.set:un=Bi.init||Bi[Si],un&&this.raiseRecoverable(It.start,"Redefinition of property")}else Bi=xe[Wt]={init:!1,get:!1,set:!1};Bi[Si]=!0}},ne.parseExpression=function(N,xe){var tt=this.start,It=this.startLoc,Wt=this.parseMaybeAssign(N,xe);if(this.type===Ge.comma){var Si=this.startNodeAt(tt,It);for(Si.expressions=[Wt];this.eat(Ge.comma);)Si.expressions.push(this.parseMaybeAssign(N,xe));return this.finishNode(Si,"SequenceExpression")}return Wt},ne.parseMaybeAssign=function(N,xe,tt){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(N);this.exprAllowed=!1}var It=!1,Wt=-1,Si=-1,Bi=-1;xe?(Wt=xe.parenthesizedAssign,Si=xe.trailingComma,Bi=xe.doubleProto,xe.parenthesizedAssign=xe.trailingComma=-1):(xe=new te,It=!0);var un=this.start,An=this.startLoc;(this.type===Ge.parenL||this.type===Ge.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=N==="await");var rr=this.parseMaybeConditional(N,xe);if(tt&&(rr=tt.call(this,rr,un,An)),this.type.isAssign){var hr=this.startNodeAt(un,An);return hr.operator=this.value,this.type===Ge.eq&&(rr=this.toAssignable(rr,!1,xe)),It||(xe.parenthesizedAssign=xe.trailingComma=xe.doubleProto=-1),xe.shorthandAssign>=rr.start&&(xe.shorthandAssign=-1),this.type===Ge.eq?this.checkLValPattern(rr):this.checkLValSimple(rr),hr.left=rr,this.next(),hr.right=this.parseMaybeAssign(N),Bi>-1&&(xe.doubleProto=Bi),this.finishNode(hr,"AssignmentExpression")}else It&&this.checkExpressionErrors(xe,!0);return Wt>-1&&(xe.parenthesizedAssign=Wt),Si>-1&&(xe.trailingComma=Si),rr},ne.parseMaybeConditional=function(N,xe){var tt=this.start,It=this.startLoc,Wt=this.parseExprOps(N,xe);if(this.checkExpressionErrors(xe))return Wt;if(this.eat(Ge.question)){var Si=this.startNodeAt(tt,It);return Si.test=Wt,Si.consequent=this.parseMaybeAssign(),this.expect(Ge.colon),Si.alternate=this.parseMaybeAssign(N),this.finishNode(Si,"ConditionalExpression")}return Wt},ne.parseExprOps=function(N,xe){var tt=this.start,It=this.startLoc,Wt=this.parseMaybeUnary(xe,!1,!1,N);return this.checkExpressionErrors(xe)||Wt.start===tt&&Wt.type==="ArrowFunctionExpression"?Wt:this.parseExprOp(Wt,tt,It,-1,N)},ne.parseExprOp=function(N,xe,tt,It,Wt){var Si=this.type.binop;if(Si!=null&&(!Wt||this.type!==Ge._in)&&Si>It){var Bi=this.type===Ge.logicalOR||this.type===Ge.logicalAND,un=this.type===Ge.coalesce;un&&(Si=Ge.logicalAND.binop);var An=this.value;this.next();var rr=this.start,hr=this.startLoc,zr=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,Wt),rr,hr,Si,Wt),Ua=this.buildBinary(xe,tt,N,zr,An,Bi||un);return(Bi&&this.type===Ge.coalesce||un&&(this.type===Ge.logicalOR||this.type===Ge.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Ua,xe,tt,It,Wt)}return N},ne.buildBinary=function(N,xe,tt,It,Wt,Si){It.type==="PrivateIdentifier"&&this.raise(It.start,"Private identifier can only be left side of binary expression");var Bi=this.startNodeAt(N,xe);return Bi.left=tt,Bi.operator=Wt,Bi.right=It,this.finishNode(Bi,Si?"LogicalExpression":"BinaryExpression")},ne.parseMaybeUnary=function(N,xe,tt,It){var Wt=this.start,Si=this.startLoc,Bi;if(this.isContextual("await")&&this.canAwait)Bi=this.parseAwait(It),xe=!0;else if(this.type.prefix){var un=this.startNode(),An=this.type===Ge.incDec;un.operator=this.value,un.prefix=!0,this.next(),un.argument=this.parseMaybeUnary(null,!0,An,It),this.checkExpressionErrors(N,!0),An?this.checkLValSimple(un.argument):this.strict&&un.operator==="delete"&&un.argument.type==="Identifier"?this.raiseRecoverable(un.start,"Deleting local variable in strict mode"):un.operator==="delete"&&X(un.argument)?this.raiseRecoverable(un.start,"Private fields can not be deleted"):xe=!0,Bi=this.finishNode(un,An?"UpdateExpression":"UnaryExpression")}else if(!xe&&this.type===Ge.privateId)(It||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Bi=this.parsePrivateIdent(),this.type!==Ge._in&&this.unexpected();else{if(Bi=this.parseExprSubscripts(N,It),this.checkExpressionErrors(N))return Bi;for(;this.type.postfix&&!this.canInsertSemicolon();){var rr=this.startNodeAt(Wt,Si);rr.operator=this.value,rr.prefix=!1,rr.argument=Bi,this.checkLValSimple(Bi),this.next(),Bi=this.finishNode(rr,"UpdateExpression")}}if(!tt&&this.eat(Ge.starstar))if(xe)this.unexpected(this.lastTokStart);else return this.buildBinary(Wt,Si,Bi,this.parseMaybeUnary(null,!1,!1,It),"**",!1);else return Bi};function X(N){return N.type==="MemberExpression"&&N.property.type==="PrivateIdentifier"||N.type==="ChainExpression"&&X(N.expression)}ne.parseExprSubscripts=function(N,xe){var tt=this.start,It=this.startLoc,Wt=this.parseExprAtom(N,xe);if(Wt.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return Wt;var Si=this.parseSubscripts(Wt,tt,It,!1,xe);return N&&Si.type==="MemberExpression"&&(N.parenthesizedAssign>=Si.start&&(N.parenthesizedAssign=-1),N.parenthesizedBind>=Si.start&&(N.parenthesizedBind=-1),N.trailingComma>=Si.start&&(N.trailingComma=-1)),Si},ne.parseSubscripts=function(N,xe,tt,It,Wt){for(var Si=this.options.ecmaVersion>=8&&N.type==="Identifier"&&N.name==="async"&&this.lastTokEnd===N.end&&!this.canInsertSemicolon()&&N.end-N.start===5&&this.potentialArrowAt===N.start,Bi=!1;;){var un=this.parseSubscript(N,xe,tt,It,Si,Bi,Wt);if(un.optional&&(Bi=!0),un===N||un.type==="ArrowFunctionExpression"){if(Bi){var An=this.startNodeAt(xe,tt);An.expression=un,un=this.finishNode(An,"ChainExpression")}return un}N=un}},ne.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(Ge.arrow)},ne.parseSubscriptAsyncArrow=function(N,xe,tt,It){return this.parseArrowExpression(this.startNodeAt(N,xe),tt,!0,It)},ne.parseSubscript=function(N,xe,tt,It,Wt,Si,Bi){var un=this.options.ecmaVersion>=11,An=un&&this.eat(Ge.questionDot);It&&An&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var rr=this.eat(Ge.bracketL);if(rr||An&&this.type!==Ge.parenL&&this.type!==Ge.backQuote||this.eat(Ge.dot)){var hr=this.startNodeAt(xe,tt);hr.object=N,rr?(hr.property=this.parseExpression(),this.expect(Ge.bracketR)):this.type===Ge.privateId&&N.type!=="Super"?hr.property=this.parsePrivateIdent():hr.property=this.parseIdent(this.options.allowReserved!=="never"),hr.computed=!!rr,un&&(hr.optional=An),N=this.finishNode(hr,"MemberExpression")}else if(!It&&this.eat(Ge.parenL)){var zr=new te,Ua=this.yieldPos,Ga=this.awaitPos,qa=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var pl=this.parseExprList(Ge.parenR,this.options.ecmaVersion>=8,!1,zr);if(Wt&&!An&&this.shouldParseAsyncArrow())return this.checkPatternErrors(zr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Ua,this.awaitPos=Ga,this.awaitIdentPos=qa,this.parseSubscriptAsyncArrow(xe,tt,pl,Bi);this.checkExpressionErrors(zr,!0),this.yieldPos=Ua||this.yieldPos,this.awaitPos=Ga||this.awaitPos,this.awaitIdentPos=qa||this.awaitIdentPos;var Ur=this.startNodeAt(xe,tt);Ur.callee=N,Ur.arguments=pl,un&&(Ur.optional=An),N=this.finishNode(Ur,"CallExpression")}else if(this.type===Ge.backQuote){(An||Si)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var ir=this.startNodeAt(xe,tt);ir.tag=N,ir.quasi=this.parseTemplate({isTagged:!0}),N=this.finishNode(ir,"TaggedTemplateExpression")}return N},ne.parseExprAtom=function(N,xe,tt){this.type===Ge.slash&&this.readRegexp();var It,Wt=this.potentialArrowAt===this.start;switch(this.type){case Ge._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),It=this.startNode(),this.next(),this.type===Ge.parenL&&!this.allowDirectSuper&&this.raise(It.start,"super() call outside constructor of a subclass"),this.type!==Ge.dot&&this.type!==Ge.bracketL&&this.type!==Ge.parenL&&this.unexpected(),this.finishNode(It,"Super");case Ge._this:return It=this.startNode(),this.next(),this.finishNode(It,"ThisExpression");case Ge.name:var Si=this.start,Bi=this.startLoc,un=this.containsEsc,An=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!un&&An.name==="async"&&!this.canInsertSemicolon()&&this.eat(Ge._function))return this.overrideContext(Me.f_expr),this.parseFunction(this.startNodeAt(Si,Bi),0,!1,!0,xe);if(Wt&&!this.canInsertSemicolon()){if(this.eat(Ge.arrow))return this.parseArrowExpression(this.startNodeAt(Si,Bi),[An],!1,xe);if(this.options.ecmaVersion>=8&&An.name==="async"&&this.type===Ge.name&&!un&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return An=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Ge.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Si,Bi),[An],!0,xe)}return An;case Ge.regexp:var rr=this.value;return It=this.parseLiteral(rr.value),It.regex={pattern:rr.pattern,flags:rr.flags},It;case Ge.num:case Ge.string:return this.parseLiteral(this.value);case Ge._null:case Ge._true:case Ge._false:return It=this.startNode(),It.value=this.type===Ge._null?null:this.type===Ge._true,It.raw=this.type.keyword,this.next(),this.finishNode(It,"Literal");case Ge.parenL:var hr=this.start,zr=this.parseParenAndDistinguishExpression(Wt,xe);return N&&(N.parenthesizedAssign<0&&!this.isSimpleAssignTarget(zr)&&(N.parenthesizedAssign=hr),N.parenthesizedBind<0&&(N.parenthesizedBind=hr)),zr;case Ge.bracketL:return It=this.startNode(),this.next(),It.elements=this.parseExprList(Ge.bracketR,!0,!0,N),this.finishNode(It,"ArrayExpression");case Ge.braceL:return this.overrideContext(Me.b_expr),this.parseObj(!1,N);case Ge._function:return It=this.startNode(),this.next(),this.parseFunction(It,0);case Ge._class:return this.parseClass(this.startNode(),!1);case Ge._new:return this.parseNew();case Ge.backQuote:return this.parseTemplate();case Ge._import:return this.options.ecmaVersion>=11?this.parseExprImport(tt):this.unexpected();default:return this.parseExprAtomDefault()}},ne.parseExprAtomDefault=function(){this.unexpected()},ne.parseExprImport=function(N){var xe=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===Ge.parenL&&!N)return this.parseDynamicImport(xe);if(this.type===Ge.dot){var tt=this.startNodeAt(xe.start,xe.loc&&xe.loc.start);return tt.name="import",xe.meta=this.finishNode(tt,"Identifier"),this.parseImportMeta(xe)}else this.unexpected()},ne.parseDynamicImport=function(N){if(this.next(),N.source=this.parseMaybeAssign(),!this.eat(Ge.parenR)){var xe=this.start;this.eat(Ge.comma)&&this.eat(Ge.parenR)?this.raiseRecoverable(xe,"Trailing comma is not allowed in import()"):this.unexpected(xe)}return this.finishNode(N,"ImportExpression")},ne.parseImportMeta=function(N){this.next();var xe=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="meta"&&this.raiseRecoverable(N.property.start,"The only valid meta property for import is 'import.meta'"),xe&&this.raiseRecoverable(N.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(N.start,"Cannot use 'import.meta' outside a module"),this.finishNode(N,"MetaProperty")},ne.parseLiteral=function(N){var xe=this.startNode();return xe.value=N,xe.raw=this.input.slice(this.start,this.end),xe.raw.charCodeAt(xe.raw.length-1)===110&&(xe.bigint=xe.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(xe,"Literal")},ne.parseParenExpression=function(){this.expect(Ge.parenL);var N=this.parseExpression();return this.expect(Ge.parenR),N},ne.shouldParseArrow=function(N){return!this.canInsertSemicolon()},ne.parseParenAndDistinguishExpression=function(N,xe){var tt=this.start,It=this.startLoc,Wt,Si=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Bi=this.start,un=this.startLoc,An=[],rr=!0,hr=!1,zr=new te,Ua=this.yieldPos,Ga=this.awaitPos,qa;for(this.yieldPos=0,this.awaitPos=0;this.type!==Ge.parenR;)if(rr?rr=!1:this.expect(Ge.comma),Si&&this.afterTrailingComma(Ge.parenR,!0)){hr=!0;break}else if(this.type===Ge.ellipsis){qa=this.start,An.push(this.parseParenItem(this.parseRestBinding())),this.type===Ge.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else An.push(this.parseMaybeAssign(!1,zr,this.parseParenItem));var pl=this.lastTokEnd,Ur=this.lastTokEndLoc;if(this.expect(Ge.parenR),N&&this.shouldParseArrow(An)&&this.eat(Ge.arrow))return this.checkPatternErrors(zr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Ua,this.awaitPos=Ga,this.parseParenArrowList(tt,It,An,xe);(!An.length||hr)&&this.unexpected(this.lastTokStart),qa&&this.unexpected(qa),this.checkExpressionErrors(zr,!0),this.yieldPos=Ua||this.yieldPos,this.awaitPos=Ga||this.awaitPos,An.length>1?(Wt=this.startNodeAt(Bi,un),Wt.expressions=An,this.finishNodeAt(Wt,"SequenceExpression",pl,Ur)):Wt=An[0]}else Wt=this.parseParenExpression();if(this.options.preserveParens){var ir=this.startNodeAt(tt,It);return ir.expression=Wt,this.finishNode(ir,"ParenthesizedExpression")}else return Wt},ne.parseParenItem=function(N){return N},ne.parseParenArrowList=function(N,xe,tt,It){return this.parseArrowExpression(this.startNodeAt(N,xe),tt,!1,It)};var ie=[];ne.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var N=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===Ge.dot){var xe=this.startNodeAt(N.start,N.loc&&N.loc.start);xe.name="new",N.meta=this.finishNode(xe,"Identifier"),this.next();var tt=this.containsEsc;return N.property=this.parseIdent(!0),N.property.name!=="target"&&this.raiseRecoverable(N.property.start,"The only valid meta property for new is 'new.target'"),tt&&this.raiseRecoverable(N.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(N.start,"'new.target' can only be used in functions and class static block"),this.finishNode(N,"MetaProperty")}var It=this.start,Wt=this.startLoc;return N.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),It,Wt,!0,!1),this.eat(Ge.parenL)?N.arguments=this.parseExprList(Ge.parenR,this.options.ecmaVersion>=8,!1):N.arguments=ie,this.finishNode(N,"NewExpression")},ne.parseTemplateElement=function(N){var xe=N.isTagged,tt=this.startNode();return this.type===Ge.invalidTemplate?(xe||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),tt.value={raw:this.value,cooked:null}):tt.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),tt.tail=this.type===Ge.backQuote,this.finishNode(tt,"TemplateElement")},ne.parseTemplate=function(N){N===void 0&&(N={});var xe=N.isTagged;xe===void 0&&(xe=!1);var tt=this.startNode();this.next(),tt.expressions=[];var It=this.parseTemplateElement({isTagged:xe});for(tt.quasis=[It];!It.tail;)this.type===Ge.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Ge.dollarBraceL),tt.expressions.push(this.parseExpression()),this.expect(Ge.braceR),tt.quasis.push(It=this.parseTemplateElement({isTagged:xe}));return this.next(),this.finishNode(tt,"TemplateLiteral")},ne.isAsyncProp=function(N){return!N.computed&&N.key.type==="Identifier"&&N.key.name==="async"&&(this.type===Ge.name||this.type===Ge.num||this.type===Ge.string||this.type===Ge.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Ge.star)&&!ni.test(this.input.slice(this.lastTokEnd,this.start))},ne.parseObj=function(N,xe){var tt=this.startNode(),It=!0,Wt={};for(tt.properties=[],this.next();!this.eat(Ge.braceR);){if(It)It=!1;else if(this.expect(Ge.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Ge.braceR))break;var Si=this.parseProperty(N,xe);N||this.checkPropClash(Si,Wt,xe),tt.properties.push(Si)}return this.finishNode(tt,N?"ObjectPattern":"ObjectExpression")},ne.parseProperty=function(N,xe){var tt=this.startNode(),It,Wt,Si,Bi;if(this.options.ecmaVersion>=9&&this.eat(Ge.ellipsis))return N?(tt.argument=this.parseIdent(!1),this.type===Ge.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(tt,"RestElement")):(tt.argument=this.parseMaybeAssign(!1,xe),this.type===Ge.comma&&xe&&xe.trailingComma<0&&(xe.trailingComma=this.start),this.finishNode(tt,"SpreadElement"));this.options.ecmaVersion>=6&&(tt.method=!1,tt.shorthand=!1,(N||xe)&&(Si=this.start,Bi=this.startLoc),N||(It=this.eat(Ge.star)));var un=this.containsEsc;return this.parsePropertyName(tt),!N&&!un&&this.options.ecmaVersion>=8&&!It&&this.isAsyncProp(tt)?(Wt=!0,It=this.options.ecmaVersion>=9&&this.eat(Ge.star),this.parsePropertyName(tt)):Wt=!1,this.parsePropertyValue(tt,N,It,Wt,Si,Bi,xe,un),this.finishNode(tt,"Property")},ne.parseGetterSetter=function(N){N.kind=N.key.name,this.parsePropertyName(N),N.value=this.parseMethod(!1);var xe=N.kind==="get"?0:1;if(N.value.params.length!==xe){var tt=N.value.start;N.kind==="get"?this.raiseRecoverable(tt,"getter should have no params"):this.raiseRecoverable(tt,"setter should have exactly one param")}else N.kind==="set"&&N.value.params[0].type==="RestElement"&&this.raiseRecoverable(N.value.params[0].start,"Setter cannot use rest params")},ne.parsePropertyValue=function(N,xe,tt,It,Wt,Si,Bi,un){(tt||It)&&this.type===Ge.colon&&this.unexpected(),this.eat(Ge.colon)?(N.value=xe?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Bi),N.kind="init"):this.options.ecmaVersion>=6&&this.type===Ge.parenL?(xe&&this.unexpected(),N.kind="init",N.method=!0,N.value=this.parseMethod(tt,It)):!xe&&!un&&this.options.ecmaVersion>=5&&!N.computed&&N.key.type==="Identifier"&&(N.key.name==="get"||N.key.name==="set")&&this.type!==Ge.comma&&this.type!==Ge.braceR&&this.type!==Ge.eq?((tt||It)&&this.unexpected(),this.parseGetterSetter(N)):this.options.ecmaVersion>=6&&!N.computed&&N.key.type==="Identifier"?((tt||It)&&this.unexpected(),this.checkUnreserved(N.key),N.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=Wt),N.kind="init",xe?N.value=this.parseMaybeDefault(Wt,Si,this.copyNode(N.key)):this.type===Ge.eq&&Bi?(Bi.shorthandAssign<0&&(Bi.shorthandAssign=this.start),N.value=this.parseMaybeDefault(Wt,Si,this.copyNode(N.key))):N.value=this.copyNode(N.key),N.shorthand=!0):this.unexpected()},ne.parsePropertyName=function(N){if(this.options.ecmaVersion>=6){if(this.eat(Ge.bracketL))return N.computed=!0,N.key=this.parseMaybeAssign(),this.expect(Ge.bracketR),N.key;N.computed=!1}return N.key=this.type===Ge.num||this.type===Ge.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},ne.initFunction=function(N){N.id=null,this.options.ecmaVersion>=6&&(N.generator=N.expression=!1),this.options.ecmaVersion>=8&&(N.async=!1)},ne.parseMethod=function(N,xe,tt){var It=this.startNode(),Wt=this.yieldPos,Si=this.awaitPos,Bi=this.awaitIdentPos;return this.initFunction(It),this.options.ecmaVersion>=6&&(It.generator=N),this.options.ecmaVersion>=8&&(It.async=!!xe),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(ns(xe,It.generator)|gi|(tt?mn:0)),this.expect(Ge.parenL),It.params=this.parseBindingList(Ge.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(It,!1,!0,!1),this.yieldPos=Wt,this.awaitPos=Si,this.awaitIdentPos=Bi,this.finishNode(It,"FunctionExpression")},ne.parseArrowExpression=function(N,xe,tt,It){var Wt=this.yieldPos,Si=this.awaitPos,Bi=this.awaitIdentPos;return this.enterScope(ns(tt,!1)|fn),this.initFunction(N),this.options.ecmaVersion>=8&&(N.async=!!tt),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,N.params=this.toAssignableList(xe,!0),this.parseFunctionBody(N,!0,!1,It),this.yieldPos=Wt,this.awaitPos=Si,this.awaitIdentPos=Bi,this.finishNode(N,"ArrowFunctionExpression")},ne.parseFunctionBody=function(N,xe,tt,It){var Wt=xe&&this.type!==Ge.braceL,Si=this.strict,Bi=!1;if(Wt)N.body=this.parseMaybeAssign(It),N.expression=!0,this.checkParams(N,!1);else{var un=this.options.ecmaVersion>=7&&!this.isSimpleParamList(N.params);(!Si||un)&&(Bi=this.strictDirective(this.end),Bi&&un&&this.raiseRecoverable(N.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var An=this.labels;this.labels=[],Bi&&(this.strict=!0),this.checkParams(N,!Si&&!Bi&&!xe&&!tt&&this.isSimpleParamList(N.params)),this.strict&&N.id&&this.checkLValSimple(N.id,wn),N.body=this.parseBlock(!1,void 0,Bi&&!Si),N.expression=!1,this.adaptDirectivePrologue(N.body.body),this.labels=An}this.exitScope()},ne.isSimpleParamList=function(N){for(var xe=0,tt=N;xe<tt.length;xe+=1){var It=tt[xe];if(It.type!=="Identifier")return!1}return!0},ne.checkParams=function(N,xe){for(var tt=Object.create(null),It=0,Wt=N.params;It<Wt.length;It+=1){var Si=Wt[It];this.checkLValInnerPattern(Si,ln,xe?null:tt)}},ne.parseExprList=function(N,xe,tt,It){for(var Wt=[],Si=!0;!this.eat(N);){if(Si)Si=!1;else if(this.expect(Ge.comma),xe&&this.afterTrailingComma(N))break;var Bi=void 0;tt&&this.type===Ge.comma?Bi=null:this.type===Ge.ellipsis?(Bi=this.parseSpread(It),It&&this.type===Ge.comma&&It.trailingComma<0&&(It.trailingComma=this.start)):Bi=this.parseMaybeAssign(!1,It),Wt.push(Bi)}return Wt},ne.checkUnreserved=function(N){var xe=N.start,tt=N.end,It=N.name;if(this.inGenerator&&It==="yield"&&this.raiseRecoverable(xe,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&It==="await"&&this.raiseRecoverable(xe,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&It==="arguments"&&this.raiseRecoverable(xe,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(It==="arguments"||It==="await")&&this.raise(xe,"Cannot use "+It+" in class static initialization block"),this.keywords.test(It)&&this.raise(xe,"Unexpected keyword '"+It+"'"),!(this.options.ecmaVersion<6&&this.input.slice(xe,tt).indexOf("\\")!==-1)){var Wt=this.strict?this.reservedWordsStrict:this.reservedWords;Wt.test(It)&&(!this.inAsync&&It==="await"&&this.raiseRecoverable(xe,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(xe,"The keyword '"+It+"' is reserved"))}},ne.parseIdent=function(N){var xe=this.parseIdentNode();return this.next(!!N),this.finishNode(xe,"Identifier"),N||(this.checkUnreserved(xe),xe.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=xe.start)),xe},ne.parseIdentNode=function(){var N=this.startNode();return this.type===Ge.name?N.name=this.value:this.type.keyword?(N.name=this.type.keyword,(N.name==="class"||N.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=Ge.name):this.unexpected(),N},ne.parsePrivateIdent=function(){var N=this.startNode();return this.type===Ge.privateId?N.name=this.value:this.unexpected(),this.next(),this.finishNode(N,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(N.start,"Private field '#"+N.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(N)),N},ne.parseYield=function(N){this.yieldPos||(this.yieldPos=this.start);var xe=this.startNode();return this.next(),this.type===Ge.semi||this.canInsertSemicolon()||this.type!==Ge.star&&!this.type.startsExpr?(xe.delegate=!1,xe.argument=null):(xe.delegate=this.eat(Ge.star),xe.argument=this.parseMaybeAssign(N)),this.finishNode(xe,"YieldExpression")},ne.parseAwait=function(N){this.awaitPos||(this.awaitPos=this.start);var xe=this.startNode();return this.next(),xe.argument=this.parseMaybeUnary(null,!0,!1,N),this.finishNode(xe,"AwaitExpression")};var de=v.prototype;de.raise=function(N,xe){var tt=rn(this.input,N);xe+=" ("+tt.line+":"+tt.column+")";var It=new SyntaxError(xe);throw It.pos=N,It.loc=tt,It.raisedAt=this.pos,It},de.raiseRecoverable=de.raise,de.curPosition=function(){if(this.options.locations)return new ki(this.curLine,this.pos-this.lineStart)};var ye=v.prototype,ge=function(xe){this.flags=xe,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};ye.enterScope=function(N){this.scopeStack.push(new ge(N))},ye.exitScope=function(){this.scopeStack.pop()},ye.treatFunctionsAsVarInScope=function(N){return N.flags&hi||!this.inModule&&N.flags&yi},ye.declareName=function(N,xe,tt){var It=!1;if(xe===pr){var Wt=this.currentScope();It=Wt.lexical.indexOf(N)>-1||Wt.functions.indexOf(N)>-1||Wt.var.indexOf(N)>-1,Wt.lexical.push(N),this.inModule&&Wt.flags&yi&&delete this.undefinedExports[N]}else if(xe===Qn){var Si=this.currentScope();Si.lexical.push(N)}else if(xe===On){var Bi=this.currentScope();this.treatFunctionsAsVar?It=Bi.lexical.indexOf(N)>-1:It=Bi.lexical.indexOf(N)>-1||Bi.var.indexOf(N)>-1,Bi.functions.push(N)}else for(var un=this.scopeStack.length-1;un>=0;--un){var An=this.scopeStack[un];if(An.lexical.indexOf(N)>-1&&!(An.flags&_n&&An.lexical[0]===N)||!this.treatFunctionsAsVarInScope(An)&&An.functions.indexOf(N)>-1){It=!0;break}if(An.var.push(N),this.inModule&&An.flags&yi&&delete this.undefinedExports[N],An.flags&Mn)break}It&&this.raiseRecoverable(tt,"Identifier '"+N+"' has already been declared")},ye.checkLocalExport=function(N){this.scopeStack[0].lexical.indexOf(N.name)===-1&&this.scopeStack[0].var.indexOf(N.name)===-1&&(this.undefinedExports[N.name]=N)},ye.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},ye.currentVarScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&Mn)return xe}},ye.currentThisScope=function(){for(var N=this.scopeStack.length-1;;N--){var xe=this.scopeStack[N];if(xe.flags&Mn&&!(xe.flags&fn))return xe}};var Pe=function(xe,tt,It){this.type="",this.start=tt,this.end=0,xe.options.locations&&(this.loc=new Gi(xe,It)),xe.options.directSourceFile&&(this.sourceFile=xe.options.directSourceFile),xe.options.ranges&&(this.range=[tt,0])},Fe=v.prototype;Fe.startNode=function(){return new Pe(this,this.start,this.startLoc)},Fe.startNodeAt=function(N,xe){return new Pe(this,N,xe)};function Ne(N,xe,tt,It){return N.type=xe,N.end=tt,this.options.locations&&(N.loc.end=It),this.options.ranges&&(N.range[1]=tt),N}Fe.finishNode=function(N,xe){return Ne.call(this,N,xe,this.lastTokEnd,this.lastTokEndLoc)},Fe.finishNodeAt=function(N,xe,tt,It){return Ne.call(this,N,xe,tt,It)},Fe.copyNode=function(N){var xe=new Pe(this,N.start,this.startLoc);for(var tt in N)xe[tt]=N[tt];return xe};var Xe="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Ye=Xe+" Extended_Pictographic",De=Ye,Ue=De+" EBase EComp EMod EPres ExtPict",ht=Ue,Tt=ht,o={9:Xe,10:Ye,11:De,12:Ue,13:ht,14:Tt},ke="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",ai={9:"",10:"",11:"",12:"",13:"",14:ke},di="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ai="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Kt=Ai+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",oi=Kt+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Ri=oi+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",vi=Ri+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",wi=vi+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",Yt={9:Ai,10:Kt,11:oi,12:Ri,13:vi,14:wi},vn={};function ar(N){var xe=vn[N]={binary:Dt(o[N]+" "+di),binaryOfStrings:Dt(ai[N]),nonBinary:{General_Category:Dt(di),Script:Dt(Yt[N])}};xe.nonBinary.Script_Extensions=xe.nonBinary.Script,xe.nonBinary.gc=xe.nonBinary.General_Category,xe.nonBinary.sc=xe.nonBinary.Script,xe.nonBinary.scx=xe.nonBinary.Script_Extensions}for(var dn=0,Vn=[9,10,11,12,13,14];dn<Vn.length;dn+=1){var Hr=Vn[dn];ar(Hr)}var Hi=v.prototype,lr=function(xe){this.parser=xe,this.validFlags="gim"+(xe.options.ecmaVersion>=6?"uy":"")+(xe.options.ecmaVersion>=9?"s":"")+(xe.options.ecmaVersion>=13?"d":"")+(xe.options.ecmaVersion>=15?"v":""),this.unicodeProperties=vn[xe.options.ecmaVersion>=14?14:xe.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};lr.prototype.reset=function(xe,tt,It){var Wt=It.indexOf("v")!==-1,Si=It.indexOf("u")!==-1;this.start=xe|0,this.source=tt+"",this.flags=It,Wt&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Si&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Si&&this.parser.options.ecmaVersion>=9)},lr.prototype.raise=function(xe){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+xe)},lr.prototype.at=function(xe,tt){tt===void 0&&(tt=!1);var It=this.source,Wt=It.length;if(xe>=Wt)return-1;var Si=It.charCodeAt(xe);if(!(tt||this.switchU)||Si<=55295||Si>=57344||xe+1>=Wt)return Si;var Bi=It.charCodeAt(xe+1);return Bi>=56320&&Bi<=57343?(Si<<10)+Bi-56613888:Si},lr.prototype.nextIndex=function(xe,tt){tt===void 0&&(tt=!1);var It=this.source,Wt=It.length;if(xe>=Wt)return Wt;var Si=It.charCodeAt(xe),Bi;return!(tt||this.switchU)||Si<=55295||Si>=57344||xe+1>=Wt||(Bi=It.charCodeAt(xe+1))<56320||Bi>57343?xe+1:xe+2},lr.prototype.current=function(xe){return xe===void 0&&(xe=!1),this.at(this.pos,xe)},lr.prototype.lookahead=function(xe){return xe===void 0&&(xe=!1),this.at(this.nextIndex(this.pos,xe),xe)},lr.prototype.advance=function(xe){xe===void 0&&(xe=!1),this.pos=this.nextIndex(this.pos,xe)},lr.prototype.eat=function(xe,tt){return tt===void 0&&(tt=!1),this.current(tt)===xe?(this.advance(tt),!0):!1},lr.prototype.eatChars=function(xe,tt){tt===void 0&&(tt=!1);for(var It=this.pos,Wt=0,Si=xe;Wt<Si.length;Wt+=1){var Bi=Si[Wt],un=this.at(It,tt);if(un===-1||un!==Bi)return!1;It=this.nextIndex(It,tt)}return this.pos=It,!0},Hi.validateRegExpFlags=function(N){for(var xe=N.validFlags,tt=N.flags,It=!1,Wt=!1,Si=0;Si<tt.length;Si++){var Bi=tt.charAt(Si);xe.indexOf(Bi)===-1&&this.raise(N.start,"Invalid regular expression flag"),tt.indexOf(Bi,Si+1)>-1&&this.raise(N.start,"Duplicate regular expression flag"),Bi==="u"&&(It=!0),Bi==="v"&&(Wt=!0)}this.options.ecmaVersion>=15&&It&&Wt&&this.raise(N.start,"Invalid regular expression flag")},Hi.validateRegExpPattern=function(N){this.regexp_pattern(N),!N.switchN&&this.options.ecmaVersion>=9&&N.groupNames.length>0&&(N.switchN=!0,this.regexp_pattern(N))},Hi.regexp_pattern=function(N){N.pos=0,N.lastIntValue=0,N.lastStringValue="",N.lastAssertionIsQuantifiable=!1,N.numCapturingParens=0,N.maxBackReference=0,N.groupNames.length=0,N.backReferenceNames.length=0,this.regexp_disjunction(N),N.pos!==N.source.length&&(N.eat(41)&&N.raise("Unmatched ')'"),(N.eat(93)||N.eat(125))&&N.raise("Lone quantifier brackets")),N.maxBackReference>N.numCapturingParens&&N.raise("Invalid escape");for(var xe=0,tt=N.backReferenceNames;xe<tt.length;xe+=1){var It=tt[xe];N.groupNames.indexOf(It)===-1&&N.raise("Invalid named capture referenced")}},Hi.regexp_disjunction=function(N){for(this.regexp_alternative(N);N.eat(124);)this.regexp_alternative(N);this.regexp_eatQuantifier(N,!0)&&N.raise("Nothing to repeat"),N.eat(123)&&N.raise("Lone quantifier brackets")},Hi.regexp_alternative=function(N){for(;N.pos<N.source.length&&this.regexp_eatTerm(N););},Hi.regexp_eatTerm=function(N){return this.regexp_eatAssertion(N)?(N.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(N)&&N.switchU&&N.raise("Invalid quantifier"),!0):(N.switchU?this.regexp_eatAtom(N):this.regexp_eatExtendedAtom(N))?(this.regexp_eatQuantifier(N),!0):!1},Hi.regexp_eatAssertion=function(N){var xe=N.pos;if(N.lastAssertionIsQuantifiable=!1,N.eat(94)||N.eat(36))return!0;if(N.eat(92)){if(N.eat(66)||N.eat(98))return!0;N.pos=xe}if(N.eat(40)&&N.eat(63)){var tt=!1;if(this.options.ecmaVersion>=9&&(tt=N.eat(60)),N.eat(61)||N.eat(33))return this.regexp_disjunction(N),N.eat(41)||N.raise("Unterminated group"),N.lastAssertionIsQuantifiable=!tt,!0}return N.pos=xe,!1},Hi.regexp_eatQuantifier=function(N,xe){return xe===void 0&&(xe=!1),this.regexp_eatQuantifierPrefix(N,xe)?(N.eat(63),!0):!1},Hi.regexp_eatQuantifierPrefix=function(N,xe){return N.eat(42)||N.eat(43)||N.eat(63)||this.regexp_eatBracedQuantifier(N,xe)},Hi.regexp_eatBracedQuantifier=function(N,xe){var tt=N.pos;if(N.eat(123)){var It=0,Wt=-1;if(this.regexp_eatDecimalDigits(N)&&(It=N.lastIntValue,N.eat(44)&&this.regexp_eatDecimalDigits(N)&&(Wt=N.lastIntValue),N.eat(125)))return Wt!==-1&&Wt<It&&!xe&&N.raise("numbers out of order in {} quantifier"),!0;N.switchU&&!xe&&N.raise("Incomplete quantifier"),N.pos=tt}return!1},Hi.regexp_eatAtom=function(N){return this.regexp_eatPatternCharacters(N)||N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)},Hi.regexp_eatReverseSolidusAtomEscape=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatAtomEscape(N))return!0;N.pos=xe}return!1},Hi.regexp_eatUncapturingGroup=function(N){var xe=N.pos;if(N.eat(40)){if(N.eat(63)&&N.eat(58)){if(this.regexp_disjunction(N),N.eat(41))return!0;N.raise("Unterminated group")}N.pos=xe}return!1},Hi.regexp_eatCapturingGroup=function(N){if(N.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(N):N.current()===63&&N.raise("Invalid group"),this.regexp_disjunction(N),N.eat(41))return N.numCapturingParens+=1,!0;N.raise("Unterminated group")}return!1},Hi.regexp_eatExtendedAtom=function(N){return N.eat(46)||this.regexp_eatReverseSolidusAtomEscape(N)||this.regexp_eatCharacterClass(N)||this.regexp_eatUncapturingGroup(N)||this.regexp_eatCapturingGroup(N)||this.regexp_eatInvalidBracedQuantifier(N)||this.regexp_eatExtendedPatternCharacter(N)},Hi.regexp_eatInvalidBracedQuantifier=function(N){return this.regexp_eatBracedQuantifier(N,!0)&&N.raise("Nothing to repeat"),!1},Hi.regexp_eatSyntaxCharacter=function(N){var xe=N.current();return Fn(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function Fn(N){return N===36||N>=40&&N<=43||N===46||N===63||N>=91&&N<=94||N>=123&&N<=125}Hi.regexp_eatPatternCharacters=function(N){for(var xe=N.pos,tt=0;(tt=N.current())!==-1&&!Fn(tt);)N.advance();return N.pos!==xe},Hi.regexp_eatExtendedPatternCharacter=function(N){var xe=N.current();return xe!==-1&&xe!==36&&!(xe>=40&&xe<=43)&&xe!==46&&xe!==63&&xe!==91&&xe!==94&&xe!==124?(N.advance(),!0):!1},Hi.regexp_groupSpecifier=function(N){if(N.eat(63)){if(this.regexp_eatGroupName(N)){N.groupNames.indexOf(N.lastStringValue)!==-1&&N.raise("Duplicate capture group name"),N.groupNames.push(N.lastStringValue);return}N.raise("Invalid group")}},Hi.regexp_eatGroupName=function(N){if(N.lastStringValue="",N.eat(60)){if(this.regexp_eatRegExpIdentifierName(N)&&N.eat(62))return!0;N.raise("Invalid capture group name")}return!1},Hi.regexp_eatRegExpIdentifierName=function(N){if(N.lastStringValue="",this.regexp_eatRegExpIdentifierStart(N)){for(N.lastStringValue+=ci(N.lastIntValue);this.regexp_eatRegExpIdentifierPart(N);)N.lastStringValue+=ci(N.lastIntValue);return!0}return!1},Hi.regexp_eatRegExpIdentifierStart=function(N){var xe=N.pos,tt=this.options.ecmaVersion>=11,It=N.current(tt);return N.advance(tt),It===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,tt)&&(It=N.lastIntValue),Qt(It)?(N.lastIntValue=It,!0):(N.pos=xe,!1)};function Qt(N){return et(N,!0)||N===36||N===95}Hi.regexp_eatRegExpIdentifierPart=function(N){var xe=N.pos,tt=this.options.ecmaVersion>=11,It=N.current(tt);return N.advance(tt),It===92&&this.regexp_eatRegExpUnicodeEscapeSequence(N,tt)&&(It=N.lastIntValue),Yi(It)?(N.lastIntValue=It,!0):(N.pos=xe,!1)};function Yi(N){return lt(N,!0)||N===36||N===95||N===8204||N===8205}Hi.regexp_eatAtomEscape=function(N){return this.regexp_eatBackReference(N)||this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)||N.switchN&&this.regexp_eatKGroupName(N)?!0:(N.switchU&&(N.current()===99&&N.raise("Invalid unicode escape"),N.raise("Invalid escape")),!1)},Hi.regexp_eatBackReference=function(N){var xe=N.pos;if(this.regexp_eatDecimalEscape(N)){var tt=N.lastIntValue;if(N.switchU)return tt>N.maxBackReference&&(N.maxBackReference=tt),!0;if(tt<=N.numCapturingParens)return!0;N.pos=xe}return!1},Hi.regexp_eatKGroupName=function(N){if(N.eat(107)){if(this.regexp_eatGroupName(N))return N.backReferenceNames.push(N.lastStringValue),!0;N.raise("Invalid named reference")}return!1},Hi.regexp_eatCharacterEscape=function(N){return this.regexp_eatControlEscape(N)||this.regexp_eatCControlLetter(N)||this.regexp_eatZero(N)||this.regexp_eatHexEscapeSequence(N)||this.regexp_eatRegExpUnicodeEscapeSequence(N,!1)||!N.switchU&&this.regexp_eatLegacyOctalEscapeSequence(N)||this.regexp_eatIdentityEscape(N)},Hi.regexp_eatCControlLetter=function(N){var xe=N.pos;if(N.eat(99)){if(this.regexp_eatControlLetter(N))return!0;N.pos=xe}return!1},Hi.regexp_eatZero=function(N){return N.current()===48&&!kr(N.lookahead())?(N.lastIntValue=0,N.advance(),!0):!1},Hi.regexp_eatControlEscape=function(N){var xe=N.current();return xe===116?(N.lastIntValue=9,N.advance(),!0):xe===110?(N.lastIntValue=10,N.advance(),!0):xe===118?(N.lastIntValue=11,N.advance(),!0):xe===102?(N.lastIntValue=12,N.advance(),!0):xe===114?(N.lastIntValue=13,N.advance(),!0):!1},Hi.regexp_eatControlLetter=function(N){var xe=N.current();return Ut(xe)?(N.lastIntValue=xe%32,N.advance(),!0):!1};function Ut(N){return N>=65&&N<=90||N>=97&&N<=122}Hi.regexp_eatRegExpUnicodeEscapeSequence=function(N,xe){xe===void 0&&(xe=!1);var tt=N.pos,It=xe||N.switchU;if(N.eat(117)){if(this.regexp_eatFixedHexDigits(N,4)){var Wt=N.lastIntValue;if(It&&Wt>=55296&&Wt<=56319){var Si=N.pos;if(N.eat(92)&&N.eat(117)&&this.regexp_eatFixedHexDigits(N,4)){var Bi=N.lastIntValue;if(Bi>=56320&&Bi<=57343)return N.lastIntValue=(Wt-55296)*1024+(Bi-56320)+65536,!0}N.pos=Si,N.lastIntValue=Wt}return!0}if(It&&N.eat(123)&&this.regexp_eatHexDigits(N)&&N.eat(125)&&En(N.lastIntValue))return!0;It&&N.raise("Invalid unicode escape"),N.pos=tt}return!1};function En(N){return N>=0&&N<=1114111}Hi.regexp_eatIdentityEscape=function(N){if(N.switchU)return this.regexp_eatSyntaxCharacter(N)?!0:N.eat(47)?(N.lastIntValue=47,!0):!1;var xe=N.current();return xe!==99&&(!N.switchN||xe!==107)?(N.lastIntValue=xe,N.advance(),!0):!1},Hi.regexp_eatDecimalEscape=function(N){N.lastIntValue=0;var xe=N.current();if(xe>=49&&xe<=57){do N.lastIntValue=10*N.lastIntValue+(xe-48),N.advance();while((xe=N.current())>=48&&xe<=57);return!0}return!1};var ur=0,Ns=1,Vr=2;Hi.regexp_eatCharacterClassEscape=function(N){var xe=N.current();if(Vt(xe))return N.lastIntValue=-1,N.advance(),Ns;var tt=!1;if(N.switchU&&this.options.ecmaVersion>=9&&((tt=xe===80)||xe===112)){N.lastIntValue=-1,N.advance();var It;if(N.eat(123)&&(It=this.regexp_eatUnicodePropertyValueExpression(N))&&N.eat(125))return tt&&It===Vr&&N.raise("Invalid property name"),It;N.raise("Invalid property name")}return ur};function Vt(N){return N===100||N===68||N===115||N===83||N===119||N===87}Hi.regexp_eatUnicodePropertyValueExpression=function(N){var xe=N.pos;if(this.regexp_eatUnicodePropertyName(N)&&N.eat(61)){var tt=N.lastStringValue;if(this.regexp_eatUnicodePropertyValue(N)){var It=N.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(N,tt,It),Ns}}if(N.pos=xe,this.regexp_eatLoneUnicodePropertyNameOrValue(N)){var Wt=N.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(N,Wt)}return ur},Hi.regexp_validateUnicodePropertyNameAndValue=function(N,xe,tt){at(N.unicodeProperties.nonBinary,xe)||N.raise("Invalid property name"),N.unicodeProperties.nonBinary[xe].test(tt)||N.raise("Invalid property value")},Hi.regexp_validateUnicodePropertyNameOrValue=function(N,xe){if(N.unicodeProperties.binary.test(xe))return Ns;if(N.switchV&&N.unicodeProperties.binaryOfStrings.test(xe))return Vr;N.raise("Invalid property name")},Hi.regexp_eatUnicodePropertyName=function(N){var xe=0;for(N.lastStringValue="";cr(xe=N.current());)N.lastStringValue+=ci(xe),N.advance();return N.lastStringValue!==""};function cr(N){return Ut(N)||N===95}Hi.regexp_eatUnicodePropertyValue=function(N){var xe=0;for(N.lastStringValue="";Lt(xe=N.current());)N.lastStringValue+=ci(xe),N.advance();return N.lastStringValue!==""};function Lt(N){return cr(N)||kr(N)}Hi.regexp_eatLoneUnicodePropertyNameOrValue=function(N){return this.regexp_eatUnicodePropertyValue(N)},Hi.regexp_eatCharacterClass=function(N){if(N.eat(91)){var xe=N.eat(94),tt=this.regexp_classContents(N);return N.eat(93)||N.raise("Unterminated character class"),xe&&tt===Vr&&N.raise("Negated character class may contain strings"),!0}return!1},Hi.regexp_classContents=function(N){return N.current()===93?Ns:N.switchV?this.regexp_classSetExpression(N):(this.regexp_nonEmptyClassRanges(N),Ns)},Hi.regexp_nonEmptyClassRanges=function(N){for(;this.regexp_eatClassAtom(N);){var xe=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassAtom(N)){var tt=N.lastIntValue;N.switchU&&(xe===-1||tt===-1)&&N.raise("Invalid character class"),xe!==-1&&tt!==-1&&xe>tt&&N.raise("Range out of order in character class")}}},Hi.regexp_eatClassAtom=function(N){var xe=N.pos;if(N.eat(92)){if(this.regexp_eatClassEscape(N))return!0;if(N.switchU){var tt=N.current();(tt===99||Oa(tt))&&N.raise("Invalid class escape"),N.raise("Invalid escape")}N.pos=xe}var It=N.current();return It!==93?(N.lastIntValue=It,N.advance(),!0):!1},Hi.regexp_eatClassEscape=function(N){var xe=N.pos;if(N.eat(98))return N.lastIntValue=8,!0;if(N.switchU&&N.eat(45))return N.lastIntValue=45,!0;if(!N.switchU&&N.eat(99)){if(this.regexp_eatClassControlLetter(N))return!0;N.pos=xe}return this.regexp_eatCharacterClassEscape(N)||this.regexp_eatCharacterEscape(N)},Hi.regexp_classSetExpression=function(N){var xe=Ns,tt;if(!this.regexp_eatClassSetRange(N))if(tt=this.regexp_eatClassSetOperand(N)){tt===Vr&&(xe=Vr);for(var It=N.pos;N.eatChars([38,38]);){if(N.current()!==38&&(tt=this.regexp_eatClassSetOperand(N))){tt!==Vr&&(xe=Ns);continue}N.raise("Invalid character in character class")}if(It!==N.pos)return xe;for(;N.eatChars([45,45]);)this.regexp_eatClassSetOperand(N)||N.raise("Invalid character in character class");if(It!==N.pos)return xe}else N.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(N)){if(tt=this.regexp_eatClassSetOperand(N),!tt)return xe;tt===Vr&&(xe=Vr)}},Hi.regexp_eatClassSetRange=function(N){var xe=N.pos;if(this.regexp_eatClassSetCharacter(N)){var tt=N.lastIntValue;if(N.eat(45)&&this.regexp_eatClassSetCharacter(N)){var It=N.lastIntValue;return tt!==-1&&It!==-1&&tt>It&&N.raise("Range out of order in character class"),!0}N.pos=xe}return!1},Hi.regexp_eatClassSetOperand=function(N){return this.regexp_eatClassSetCharacter(N)?Ns:this.regexp_eatClassStringDisjunction(N)||this.regexp_eatNestedClass(N)},Hi.regexp_eatNestedClass=function(N){var xe=N.pos;if(N.eat(91)){var tt=N.eat(94),It=this.regexp_classContents(N);if(N.eat(93))return tt&&It===Vr&&N.raise("Negated character class may contain strings"),It;N.pos=xe}if(N.eat(92)){var Wt=this.regexp_eatCharacterClassEscape(N);if(Wt)return Wt;N.pos=xe}return null},Hi.regexp_eatClassStringDisjunction=function(N){var xe=N.pos;if(N.eatChars([92,113])){if(N.eat(123)){var tt=this.regexp_classStringDisjunctionContents(N);if(N.eat(125))return tt}else N.raise("Invalid escape");N.pos=xe}return null},Hi.regexp_classStringDisjunctionContents=function(N){for(var xe=this.regexp_classString(N);N.eat(124);)this.regexp_classString(N)===Vr&&(xe=Vr);return xe},Hi.regexp_classString=function(N){for(var xe=0;this.regexp_eatClassSetCharacter(N);)xe++;return xe===1?Ns:Vr},Hi.regexp_eatClassSetCharacter=function(N){var xe=N.pos;if(N.eat(92))return this.regexp_eatCharacterEscape(N)||this.regexp_eatClassSetReservedPunctuator(N)?!0:N.eat(98)?(N.lastIntValue=8,!0):(N.pos=xe,!1);var tt=N.current();return tt<0||tt===N.lookahead()&&Br(tt)||Vs(tt)?!1:(N.advance(),N.lastIntValue=tt,!0)};function Br(N){return N===33||N>=35&&N<=38||N>=42&&N<=44||N===46||N>=58&&N<=64||N===94||N===96||N===126}function Vs(N){return N===40||N===41||N===45||N===47||N>=91&&N<=93||N>=123&&N<=125}Hi.regexp_eatClassSetReservedPunctuator=function(N){var xe=N.current();return ua(xe)?(N.lastIntValue=xe,N.advance(),!0):!1};function ua(N){return N===33||N===35||N===37||N===38||N===44||N===45||N>=58&&N<=62||N===64||N===96||N===126}Hi.regexp_eatClassControlLetter=function(N){var xe=N.current();return kr(xe)||xe===95?(N.lastIntValue=xe%32,N.advance(),!0):!1},Hi.regexp_eatHexEscapeSequence=function(N){var xe=N.pos;if(N.eat(120)){if(this.regexp_eatFixedHexDigits(N,2))return!0;N.switchU&&N.raise("Invalid escape"),N.pos=xe}return!1},Hi.regexp_eatDecimalDigits=function(N){var xe=N.pos,tt=0;for(N.lastIntValue=0;kr(tt=N.current());)N.lastIntValue=10*N.lastIntValue+(tt-48),N.advance();return N.pos!==xe};function kr(N){return N>=48&&N<=57}Hi.regexp_eatHexDigits=function(N){var xe=N.pos,tt=0;for(N.lastIntValue=0;Fa(tt=N.current());)N.lastIntValue=16*N.lastIntValue+zo(tt),N.advance();return N.pos!==xe};function Fa(N){return N>=48&&N<=57||N>=65&&N<=70||N>=97&&N<=102}function zo(N){return N>=65&&N<=70?10+(N-65):N>=97&&N<=102?10+(N-97):N-48}Hi.regexp_eatLegacyOctalEscapeSequence=function(N){if(this.regexp_eatOctalDigit(N)){var xe=N.lastIntValue;if(this.regexp_eatOctalDigit(N)){var tt=N.lastIntValue;xe<=3&&this.regexp_eatOctalDigit(N)?N.lastIntValue=xe*64+tt*8+N.lastIntValue:N.lastIntValue=xe*8+tt}else N.lastIntValue=xe;return!0}return!1},Hi.regexp_eatOctalDigit=function(N){var xe=N.current();return Oa(xe)?(N.lastIntValue=xe-48,N.advance(),!0):(N.lastIntValue=0,!1)};function Oa(N){return N>=48&&N<=55}Hi.regexp_eatFixedHexDigits=function(N,xe){var tt=N.pos;N.lastIntValue=0;for(var It=0;It<xe;++It){var Wt=N.current();if(!Fa(Wt))return N.pos=tt,!1;N.lastIntValue=16*N.lastIntValue+zo(Wt),N.advance()}return!0};var Xs=function(xe){this.type=xe.type,this.value=xe.value,this.start=xe.start,this.end=xe.end,xe.options.locations&&(this.loc=new Gi(xe,xe.startLoc,xe.endLoc)),xe.options.ranges&&(this.range=[xe.start,xe.end])},jn=v.prototype;jn.next=function(N){!N&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Xs(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},jn.getToken=function(){return this.next(),new Xs(this)},typeof Symbol<"u"&&(jn[Symbol.iterator]=function(){var N=this;return{next:function(){var xe=N.getToken();return{done:xe.type===Ge.eof,value:xe}}}}),jn.nextToken=function(){var N=this.curContext();if((!N||!N.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(Ge.eof);if(N.override)return N.override(this);this.readToken(this.fullCharCodeAtPos())},jn.readToken=function(N){return et(N,this.options.ecmaVersion>=6)||N===92?this.readWord():this.getTokenFromCode(N)},jn.fullCharCodeAtPos=function(){var N=this.input.charCodeAt(this.pos);if(N<=55295||N>=56320)return N;var xe=this.input.charCodeAt(this.pos+1);return xe<=56319||xe>=57344?N:(N<<10)+xe-56613888},jn.skipBlockComment=function(){var N=this.options.onComment&&this.curPosition(),xe=this.pos,tt=this.input.indexOf("*/",this.pos+=2);if(tt===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=tt+2,this.options.locations)for(var It=void 0,Wt=xe;(It=_t(this.input,Wt,this.pos))>-1;)++this.curLine,Wt=this.lineStart=It;this.options.onComment&&this.options.onComment(!0,this.input.slice(xe+2,tt),xe,this.pos,N,this.curPosition())},jn.skipLineComment=function(N){for(var xe=this.pos,tt=this.options.onComment&&this.curPosition(),It=this.input.charCodeAt(this.pos+=N);this.pos<this.input.length&&!xt(It);)It=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(xe+N,this.pos),xe,this.pos,tt,this.curPosition())},jn.skipSpace=function(){e:for(;this.pos<this.input.length;){var N=this.input.charCodeAt(this.pos);switch(N){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(N>8&&N<14||N>=5760&&mt.test(String.fromCharCode(N)))++this.pos;else break e}}},jn.finishToken=function(N,xe){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var tt=this.type;this.type=N,this.value=xe,this.updateContext(tt)},jn.readToken_dot=function(){var N=this.input.charCodeAt(this.pos+1);if(N>=48&&N<=57)return this.readNumber(!0);var xe=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&N===46&&xe===46?(this.pos+=3,this.finishToken(Ge.ellipsis)):(++this.pos,this.finishToken(Ge.dot))},jn.readToken_slash=function(){var N=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):N===61?this.finishOp(Ge.assign,2):this.finishOp(Ge.slash,1)},jn.readToken_mult_modulo_exp=function(N){var xe=this.input.charCodeAt(this.pos+1),tt=1,It=N===42?Ge.star:Ge.modulo;return this.options.ecmaVersion>=7&&N===42&&xe===42&&(++tt,It=Ge.starstar,xe=this.input.charCodeAt(this.pos+2)),xe===61?this.finishOp(Ge.assign,tt+1):this.finishOp(It,tt)},jn.readToken_pipe_amp=function(N){var xe=this.input.charCodeAt(this.pos+1);if(xe===N){if(this.options.ecmaVersion>=12){var tt=this.input.charCodeAt(this.pos+2);if(tt===61)return this.finishOp(Ge.assign,3)}return this.finishOp(N===124?Ge.logicalOR:Ge.logicalAND,2)}return xe===61?this.finishOp(Ge.assign,2):this.finishOp(N===124?Ge.bitwiseOR:Ge.bitwiseAND,1)},jn.readToken_caret=function(){var N=this.input.charCodeAt(this.pos+1);return N===61?this.finishOp(Ge.assign,2):this.finishOp(Ge.bitwiseXOR,1)},jn.readToken_plus_min=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===N?xe===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||ni.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(Ge.incDec,2):xe===61?this.finishOp(Ge.assign,2):this.finishOp(Ge.plusMin,1)},jn.readToken_lt_gt=function(N){var xe=this.input.charCodeAt(this.pos+1),tt=1;return xe===N?(tt=N===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+tt)===61?this.finishOp(Ge.assign,tt+1):this.finishOp(Ge.bitShift,tt)):xe===33&&N===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(xe===61&&(tt=2),this.finishOp(Ge.relational,tt))},jn.readToken_eq_excl=function(N){var xe=this.input.charCodeAt(this.pos+1);return xe===61?this.finishOp(Ge.equality,this.input.charCodeAt(this.pos+2)===61?3:2):N===61&&xe===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Ge.arrow)):this.finishOp(N===61?Ge.eq:Ge.prefix,1)},jn.readToken_question=function(){var N=this.options.ecmaVersion;if(N>=11){var xe=this.input.charCodeAt(this.pos+1);if(xe===46){var tt=this.input.charCodeAt(this.pos+2);if(tt<48||tt>57)return this.finishOp(Ge.questionDot,2)}if(xe===63){if(N>=12){var It=this.input.charCodeAt(this.pos+2);if(It===61)return this.finishOp(Ge.assign,3)}return this.finishOp(Ge.coalesce,2)}}return this.finishOp(Ge.question,1)},jn.readToken_numberSign=function(){var N=this.options.ecmaVersion,xe=35;if(N>=13&&(++this.pos,xe=this.fullCharCodeAtPos(),et(xe,!0)||xe===92))return this.finishToken(Ge.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+ci(xe)+"'")},jn.getTokenFromCode=function(N){switch(N){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Ge.parenL);case 41:return++this.pos,this.finishToken(Ge.parenR);case 59:return++this.pos,this.finishToken(Ge.semi);case 44:return++this.pos,this.finishToken(Ge.comma);case 91:return++this.pos,this.finishToken(Ge.bracketL);case 93:return++this.pos,this.finishToken(Ge.bracketR);case 123:return++this.pos,this.finishToken(Ge.braceL);case 125:return++this.pos,this.finishToken(Ge.braceR);case 58:return++this.pos,this.finishToken(Ge.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Ge.backQuote);case 48:var xe=this.input.charCodeAt(this.pos+1);if(xe===120||xe===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(xe===111||xe===79)return this.readRadixNumber(8);if(xe===98||xe===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(N);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(N);case 124:case 38:return this.readToken_pipe_amp(N);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(N);case 60:case 62:return this.readToken_lt_gt(N);case 61:case 33:return this.readToken_eq_excl(N);case 63:return this.readToken_question();case 126:return this.finishOp(Ge.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+ci(N)+"'")},jn.finishOp=function(N,xe){var tt=this.input.slice(this.pos,this.pos+xe);return this.pos+=xe,this.finishToken(N,tt)},jn.readRegexp=function(){for(var N,xe,tt=this.pos;;){this.pos>=this.input.length&&this.raise(tt,"Unterminated regular expression");var It=this.input.charAt(this.pos);if(ni.test(It)&&this.raise(tt,"Unterminated regular expression"),N)N=!1;else{if(It==="[")xe=!0;else if(It==="]"&&xe)xe=!1;else if(It==="/"&&!xe)break;N=It==="\\"}++this.pos}var Wt=this.input.slice(tt,this.pos);++this.pos;var Si=this.pos,Bi=this.readWord1();this.containsEsc&&this.unexpected(Si);var un=this.regexpState||(this.regexpState=new lr(this));un.reset(tt,Wt,Bi),this.validateRegExpFlags(un),this.validateRegExpPattern(un);var An=null;try{An=new RegExp(Wt,Bi)}catch{}return this.finishToken(Ge.regexp,{pattern:Wt,flags:Bi,value:An})},jn.readInt=function(N,xe,tt){for(var It=this.options.ecmaVersion>=12&&xe===void 0,Wt=tt&&this.input.charCodeAt(this.pos)===48,Si=this.pos,Bi=0,un=0,An=0,rr=xe??1/0;An<rr;++An,++this.pos){var hr=this.input.charCodeAt(this.pos),zr=void 0;if(It&&hr===95){Wt&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),un===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),An===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),un=hr;continue}if(hr>=97?zr=hr-97+10:hr>=65?zr=hr-65+10:hr>=48&&hr<=57?zr=hr-48:zr=1/0,zr>=N)break;un=hr,Bi=Bi*N+zr}return It&&un===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Si||xe!=null&&this.pos-Si!==xe?null:Bi};function aa(N,xe){return xe?parseInt(N,8):parseFloat(N.replace(/_/g,""))}function ls(N){return typeof BigInt!="function"?null:BigInt(N.replace(/_/g,""))}jn.readRadixNumber=function(N){var xe=this.pos;this.pos+=2;var tt=this.readInt(N);return tt==null&&this.raise(this.start+2,"Expected number in radix "+N),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(tt=ls(this.input.slice(xe,this.pos)),++this.pos):et(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Ge.num,tt)},jn.readNumber=function(N){var xe=this.pos;!N&&this.readInt(10,void 0,!0)===null&&this.raise(xe,"Invalid number");var tt=this.pos-xe>=2&&this.input.charCodeAt(xe)===48;tt&&this.strict&&this.raise(xe,"Invalid number");var It=this.input.charCodeAt(this.pos);if(!tt&&!N&&this.options.ecmaVersion>=11&&It===110){var Wt=ls(this.input.slice(xe,this.pos));return++this.pos,et(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Ge.num,Wt)}tt&&/[89]/.test(this.input.slice(xe,this.pos))&&(tt=!1),It===46&&!tt&&(++this.pos,this.readInt(10),It=this.input.charCodeAt(this.pos)),(It===69||It===101)&&!tt&&(It=this.input.charCodeAt(++this.pos),(It===43||It===45)&&++this.pos,this.readInt(10)===null&&this.raise(xe,"Invalid number")),et(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Si=aa(this.input.slice(xe,this.pos),tt);return this.finishToken(Ge.num,Si)},jn.readCodePoint=function(){var N=this.input.charCodeAt(this.pos),xe;if(N===123){this.options.ecmaVersion<6&&this.unexpected();var tt=++this.pos;xe=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,xe>1114111&&this.invalidStringToken(tt,"Code point out of bounds")}else xe=this.readHexChar(4);return xe},jn.readString=function(N){for(var xe="",tt=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var It=this.input.charCodeAt(this.pos);if(It===N)break;It===92?(xe+=this.input.slice(tt,this.pos),xe+=this.readEscapedChar(!1),tt=this.pos):It===8232||It===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(xt(It)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return xe+=this.input.slice(tt,this.pos++),this.finishToken(Ge.string,xe)};var Na={};jn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(N){if(N===Na)this.readInvalidTemplateToken();else throw N}this.inTemplateElement=!1},jn.invalidStringToken=function(N,xe){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Na;this.raise(N,xe)},jn.readTmplToken=function(){for(var N="",xe=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var tt=this.input.charCodeAt(this.pos);if(tt===96||tt===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===Ge.template||this.type===Ge.invalidTemplate)?tt===36?(this.pos+=2,this.finishToken(Ge.dollarBraceL)):(++this.pos,this.finishToken(Ge.backQuote)):(N+=this.input.slice(xe,this.pos),this.finishToken(Ge.template,N));if(tt===92)N+=this.input.slice(xe,this.pos),N+=this.readEscapedChar(!0),xe=this.pos;else if(xt(tt)){switch(N+=this.input.slice(xe,this.pos),++this.pos,tt){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:N+=`
`;break;default:N+=String.fromCharCode(tt);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),xe=this.pos}else++this.pos}},jn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(Ge.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},jn.readEscapedChar=function(N){var xe=this.input.charCodeAt(++this.pos);switch(++this.pos,xe){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return ci(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),N){var tt=this.pos-1;this.invalidStringToken(tt,"Invalid escape sequence in template string")}default:if(xe>=48&&xe<=55){var It=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],Wt=parseInt(It,8);return Wt>255&&(It=It.slice(0,-1),Wt=parseInt(It,8)),this.pos+=It.length-1,xe=this.input.charCodeAt(this.pos),(It!=="0"||xe===56||xe===57)&&(this.strict||N)&&this.invalidStringToken(this.pos-1-It.length,N?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(Wt)}return xt(xe)?"":String.fromCharCode(xe)}},jn.readHexChar=function(N){var xe=this.pos,tt=this.readInt(16,N);return tt===null&&this.invalidStringToken(xe,"Bad character escape sequence"),tt},jn.readWord1=function(){this.containsEsc=!1;for(var N="",xe=!0,tt=this.pos,It=this.options.ecmaVersion>=6;this.pos<this.input.length;){var Wt=this.fullCharCodeAtPos();if(lt(Wt,It))this.pos+=Wt<=65535?1:2;else if(Wt===92){this.containsEsc=!0,N+=this.input.slice(tt,this.pos);var Si=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Bi=this.readCodePoint();(xe?et:lt)(Bi,It)||this.invalidStringToken(Si,"Invalid Unicode escape"),N+=ci(Bi),tt=this.pos}else break;xe=!1}return N+this.input.slice(tt,this.pos)},jn.readWord=function(){var N=this.readWord1(),xe=Ge.name;return this.keywords.test(N)&&(xe=Bt[N]),this.finishToken(xe,N)};var rl="8.11.3";v.acorn={Parser:v,version:rl,defaultOptions:$i,Position:ki,SourceLocation:Gi,getLineInfo:rn,Node:Pe,TokenType:Ke,tokTypes:Ge,keywordTypes:Bt,TokContext:rt,tokContexts:Me,isIdentifierChar:lt,isIdentifierStart:et,Token:Xs,isNewLine:xt,lineBreak:ni,lineBreakG:it,nonASCIIwhitespace:mt};function sl(N,xe){return v.parse(N,xe)}function Ja(N,xe,tt){return v.parseExpressionAt(N,xe,tt)}function Va(N,xe){return v.tokenizer(N,xe)}n.Node=Pe,n.Parser=v,n.Position=ki,n.SourceLocation=Gi,n.TokContext=rt,n.Token=Xs,n.TokenType=Ke,n.defaultOptions=$i,n.getLineInfo=rn,n.isIdentifierChar=lt,n.isIdentifierStart=et,n.isNewLine=xt,n.keywordTypes=Bt,n.lineBreak=ni,n.lineBreakG=it,n.nonASCIIwhitespace=mt,n.parse=sl,n.parseExpressionAt=Ja,n.tokContexts=Me,n.tokTypes=Ge,n.tokenizer=Va,n.version=rl})}(Vg,Vg.exports)),Vg.exports}/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(e){(function(t,n){t=t||gx;var c=t.window,g=t.document,b=new function(){var v=/^(statics|enumerable|beans|preserve)$/,k=[],V=k.slice,$=Object.create,te=Object.getOwnPropertyDescriptor,Ae=Object.defineProperty,ve=k.forEach||function(Ze,Ve){for(var ft=0,rt=this.length;ft<rt;ft++)Ze.call(Ve,this[ft],ft,this)},Ie=function(Ze,Ve){for(var ft in this)this.hasOwnProperty(ft)&&Ze.call(Ve,this[ft],ft,this)},Ee=Object.assign||function(Ze){for(var Ve=1,ft=arguments.length;Ve<ft;Ve++){var rt=arguments[Ve];for(var Me in rt)rt.hasOwnProperty(Me)&&(Ze[Me]=rt[Me])}return Ze},ze=function(Ze,Ve,ft){if(Ze){var rt=te(Ze,"length");(rt&&typeof rt.value=="number"?ve:Ie).call(Ze,Ve,ft=ft||Ze)}return ft};function Qe(Ze,Ve,ft,rt,Me){var se={};function ne(ge,Pe){Pe=Pe||(Pe=te(Ve,ge))&&(Pe.get?Pe:Pe.value),typeof Pe=="string"&&Pe[0]==="#"&&(Pe=Ze[Pe.substring(1)]||Pe);var Fe=typeof Pe=="function",Ne=Pe,Xe=Me||Fe&&!Pe.base?Pe&&Pe.get?ge in Ze:Ze[ge]:null,Ye;(!Me||!Xe)&&(Fe&&Xe&&(Pe.base=Xe),Fe&&rt!==!1&&(Ye=ge.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(se[Ye[3].toLowerCase()+Ye[4]]=Ye[2]),(!Ne||Fe||!Ne.get||typeof Ne.get!="function"||!He.isPlainObject(Ne))&&(Ne={value:Ne,writable:!0}),(te(Ze,ge)||{configurable:!0}).configurable&&(Ne.configurable=!0,Ne.enumerable=ft??!Ye),Ae(Ze,ge,Ne))}if(Ve){for(var X in Ve)Ve.hasOwnProperty(X)&&!v.test(X)&&ne(X);for(var X in se){var ie=se[X],de=Ze["set"+ie],ye=Ze["get"+ie]||de&&Ze["is"+ie];ye&&(rt===!0||ye.length===0)&&ne(X,{get:ye,set:de})}}return Ze}function He(){for(var Ze=0,Ve=arguments.length;Ze<Ve;Ze++){var ft=arguments[Ze];ft&&Ee(this,ft)}return this}return Qe(He,{inject:function(Ze){if(Ze){var Ve=Ze.statics===!0?Ze:Ze.statics,ft=Ze.beans,rt=Ze.preserve;Ve!==Ze&&Qe(this.prototype,Ze,Ze.enumerable,ft,rt),Qe(this,Ve,null,ft,rt)}for(var Me=1,se=arguments.length;Me<se;Me++)this.inject(arguments[Me]);return this},extend:function(){for(var Ze=this,Ve,ft,rt=0,Me,se=arguments.length;rt<se&&!(Ve&&ft);rt++)Me=arguments[rt],Ve=Ve||Me.initialize,ft=ft||Me.prototype;return Ve=Ve||function(){Ze.apply(this,arguments)},ft=Ve.prototype=ft||$(this.prototype),Ae(ft,"constructor",{value:Ve,writable:!0,configurable:!0}),Qe(Ve,this),arguments.length&&this.inject.apply(Ve,arguments),Ve.base=Ze,Ve}}).inject({enumerable:!1,initialize:He,set:He,inject:function(){for(var Ze=0,Ve=arguments.length;Ze<Ve;Ze++){var ft=arguments[Ze];ft&&Qe(this,ft,ft.enumerable,ft.beans,ft.preserve)}return this},extend:function(){var Ze=$(this);return Ze.inject.apply(Ze,arguments)},each:function(Ze,Ve){return ze(this,Ze,Ve)},clone:function(){return new this.constructor(this)},statics:{set:Ee,each:ze,create:$,define:Ae,describe:te,clone:function(Ze){return Ee(new Ze.constructor,Ze)},isPlainObject:function(Ze){var Ve=Ze!=null&&Ze.constructor;return Ve&&(Ve===Object||Ve===He||Ve.name==="Object")},pick:function(Ze,Ve){return Ze!==n?Ze:Ve},slice:function(Ze,Ve,ft){return V.call(Ze,Ve,ft)}}})};e.exports=b,b.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+b.each(this,function(v,k){if(!/^_/.test(k)){var V=typeof v;this.push(k+": "+(V==="number"?ce.instance.number(v):V==="string"?"'"+v+"'":v))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(v){return b.importJSON(v,this)},exportJSON:function(v){return b.exportJSON(this,v)},toJSON:function(){return b.serialize(this)},set:function(v,k){return v&&b.filter(this,v,k,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function v(){var k=v.base.apply(this,arguments),V=k.prototype._class;return V&&!b.exports[V]&&(b.exports[V]=k),k},equals:function(v,k){if(v===k)return!0;if(v&&v.equals)return v.equals(k);if(k&&k.equals)return k.equals(v);if(v&&k&&typeof v=="object"&&typeof k=="object"){if(Array.isArray(v)&&Array.isArray(k)){var V=v.length;if(V!==k.length)return!1;for(;V--;)if(!b.equals(v[V],k[V]))return!1}else{var $=Object.keys(v),V=$.length;if(V!==Object.keys(k).length)return!1;for(;V--;){var te=$[V];if(!(k.hasOwnProperty(te)&&b.equals(v[te],k[te])))return!1}}return!0}return!1},read:function(v,k,V,$){if(this===b){var te=this.peek(v,k);return v.__index++,te}var Ae=this.prototype,ve=Ae._readIndex,Ie=k||ve&&v.__index||0,Ee=v.length,ze=v[Ie];if($=$||Ee-Ie,ze instanceof this||V&&V.readNull&&ze==null&&$<=1)return ve&&(v.__index=Ie+1),ze&&V&&V.clone?ze.clone():ze;if(ze=b.create(Ae),ve&&(ze.__read=!0),ze=ze.initialize.apply(ze,Ie>0||Ie+$<Ee?b.slice(v,Ie,Ie+$):v)||ze,ve){v.__index=Ie+ze.__read;var Qe=ze.__filtered;Qe&&(v.__filtered=Qe,ze.__filtered=n),ze.__read=n}return ze},peek:function(v,k){return v[v.__index=k||v.__index||0]},remain:function(v){return v.length-(v.__index||0)},readList:function(v,k,V,$){for(var te=[],Ae,ve=k||0,Ie=$?ve+$:v.length,Ee=ve;Ee<Ie;Ee++)te.push(Array.isArray(Ae=v[Ee])?this.read(Ae,0,V):this.read(v,Ee,V,1));return te},readNamed:function(v,k,V,$,te){var Ae=this.getNamed(v,k),ve=Ae!==n;if(ve){var Ie=v.__filtered;if(!Ie){var Ee=this.getSource(v);Ie=v.__filtered=b.create(Ee),Ie.__unfiltered=Ee}Ie[k]=n}return this.read(ve?[Ae]:v,V,$,te)},readSupported:function(v,k){var V=this.getSource(v),$=this,te=!1;return V&&Object.keys(V).forEach(function(Ae){if(Ae in k){var ve=$.readNamed(v,Ae);ve!==n&&(k[Ae]=ve),te=!0}}),te},getSource:function(v){var k=v.__source;if(k===n){var V=v.length===1&&v[0];k=v.__source=V&&b.isPlainObject(V)?V:null}return k},getNamed:function(v,k){var V=this.getSource(v);if(V)return k?V[k]:v.__filtered||V},hasNamed:function(v,k){return!!this.getNamed(v,k)},filter:function(v,k,V,$){var te;function Ae(Qe){if(!(V&&Qe in V)&&!(te&&Qe in te)){var He=k[Qe];He!==n&&(v[Qe]=He)}}if($){for(var ve={},Ie=0,Ee,ze=$.length;Ie<ze;Ie++)(Ee=$[Ie])in k&&(Ae(Ee),ve[Ee]=!0);te=ve}return Object.keys(k.__unfiltered||k).forEach(Ae),v},isPlainValue:function(v,k){return b.isPlainObject(v)||Array.isArray(v)||k&&typeof v=="string"},serialize:function(v,k,V,$){k=k||{};var te=!$,Ae;if(te&&(k.formatter=new ce(k.precision),$={length:0,definitions:{},references:{},add:function(He,Ze){var Ve="#"+He._id,ft=this.references[Ve];if(!ft){this.length++;var rt=Ze.call(He),Me=He._class;Me&&rt[0]!==Me&&rt.unshift(Me),this.definitions[Ve]=rt,ft=this.references[Ve]=[Ve]}return ft}}),v&&v._serialize){Ae=v._serialize(k,$);var ve=v._class;ve&&!v._compactSerialize&&(te||!V)&&Ae[0]!==ve&&Ae.unshift(ve)}else if(Array.isArray(v)){Ae=[];for(var Ie=0,Ee=v.length;Ie<Ee;Ie++)Ae[Ie]=b.serialize(v[Ie],k,V,$)}else if(b.isPlainObject(v)){Ae={};for(var ze=Object.keys(v),Ie=0,Ee=ze.length;Ie<Ee;Ie++){var Qe=ze[Ie];Ae[Qe]=b.serialize(v[Qe],k,V,$)}}else typeof v=="number"?Ae=k.formatter.number(v,k.precision):Ae=v;return te&&$.length>0?[["dictionary",$.definitions],Ae]:Ae},deserialize:function(v,k,V,$,te){var Ae=v,ve=!V,Ie=ve&&v&&v.length&&v[0][0]==="dictionary";if(V=V||{},Array.isArray(v)){var Ee=v[0],ze=Ee==="dictionary";if(v.length==1&&/^#/.test(Ee))return V.dictionary[Ee];Ee=b.exports[Ee],Ae=[];for(var Qe=Ee?1:0,He=v.length;Qe<He;Qe++)Ae.push(b.deserialize(v[Qe],k,V,ze,Ie));if(Ee){var Ze=Ae;k?Ae=k(Ee,Ze,ve||te):Ae=new Ee(Ze)}}else if(b.isPlainObject(v)){Ae={},$&&(V.dictionary=Ae);for(var Ve in v)Ae[Ve]=b.deserialize(v[Ve],k,V)}return Ie?Ae[1]:Ae},exportJSON:function(v,k){var V=b.serialize(v,k);return k&&k.asString==!1?V:JSON.stringify(V)},importJSON:function(v,k){return b.deserialize(typeof v=="string"?JSON.parse(v):v,function(V,$,te){var Ae=te&&k&&k.constructor===V,ve=Ae?k:b.create(V.prototype);if($.length===1&&ve instanceof Ge&&(Ae||!(ve instanceof it))){var Ie=$[0];b.isPlainObject(Ie)&&(Ie.insert=!1,Ae&&($=$.concat([Ge.INSERT])))}return(Ae?ve.set:V).apply(ve,$),Ae&&(k=null),ve})},push:function(v,k){var V=k.length;if(V<4096)v.push.apply(v,k);else{var $=v.length;v.length+=V;for(var te=0;te<V;te++)v[$+te]=k[te]}return v},splice:function(v,k,V,$){var te=k&&k.length,Ae=V===n;V=Ae?v.length:V,V>v.length&&(V=v.length);for(var ve=0;ve<te;ve++)k[ve]._index=V+ve;if(Ae)return b.push(v,k),[];var Ie=[V,$];k&&b.push(Ie,k);for(var Ee=v.splice.apply(v,Ie),ve=0,ze=Ee.length;ve<ze;ve++)Ee[ve]._index=n;for(var ve=V+te,ze=v.length;ve<ze;ve++)v[ve]._index=ve;return Ee},capitalize:function(v){return v.replace(/\b[a-z]/g,function(k){return k.toUpperCase()})},camelize:function(v){return v.replace(/-(.)/g,function(k,V){return V.toUpperCase()})},hyphenate:function(v){return v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var E={on:function(v,k){if(typeof v!="string")b.each(v,function(Ae,ve){this.on(ve,Ae)},this);else{var V=this._eventTypes,$=V&&V[v],te=this._callbacks=this._callbacks||{};te=te[v]=te[v]||[],te.indexOf(k)===-1&&(te.push(k),$&&$.install&&te.length===1&&$.install.call(this,v))}return this},off:function(v,k){if(typeof v!="string"){b.each(v,function(ve,Ie){this.off(Ie,ve)},this);return}var V=this._eventTypes,$=V&&V[v],te=this._callbacks&&this._callbacks[v],Ae;return te&&(!k||(Ae=te.indexOf(k))!==-1&&te.length===1?($&&$.uninstall&&$.uninstall.call(this,v),delete this._callbacks[v]):Ae!==-1&&te.splice(Ae,1)),this},once:function(v,k){return this.on(v,function V(){k.apply(this,arguments),this.off(v,V)})},emit:function(v,k){var V=this._callbacks&&this._callbacks[v];if(!V)return!1;var $=b.slice(arguments,1),te=k&&k.target&&!k.currentTarget;V=V.slice(),te&&(k.currentTarget=this);for(var Ae=0,ve=V.length;Ae<ve;Ae++)if(V[Ae].apply(this,$)==!1){k&&k.stop&&k.stop();break}return te&&delete k.currentTarget,!0},responds:function(v){return!!(this._callbacks&&this._callbacks[v])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(v){var k=this._eventTypes,V=this._callbacks,$=v?"install":"uninstall";if(k){for(var te in V)if(V[te].length>0){var Ae=k[te],ve=Ae&&Ae[$];ve&&ve.call(this,te)}}},statics:{inject:function v(k){var V=k._events;if(V){var $={};b.each(V,function(te,Ae){var ve=typeof te=="string",Ie=ve?te:Ae,Ee=b.capitalize(Ie),ze=Ie.substring(2).toLowerCase();$[ze]=ve?{}:te,Ie="_"+Ie,k["get"+Ee]=function(){return this[Ie]},k["set"+Ee]=function(Qe){var He=this[Ie];He&&this.off(ze,He),Qe&&this.on(ze,Qe),this[Ie]=Qe}}),k._eventTypes=$}return v.base.apply(this,arguments)}}},a=b.extend({_class:"PaperScope",initialize:function v(){wn=this,this.settings=new b({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=v._id++,v._scopes[this._id]=this;var k=v.prototype;if(!this.support){var V=ln.getContext(1,1)||{};k.support={nativeDash:"setLineDash"in V||"mozDash"in V,nativeBlendModes:pr.nativeModes},ln.release(V)}if(!this.agent){var $=t.navigator.userAgent.toLowerCase(),te=(/(darwin|win|mac|linux|freebsd|sunos)/.exec($)||[])[0],Ae=te==="darwin"?"mac":te,ve=k.agent=k.browser={platform:Ae};Ae&&(ve[Ae]=!0),$.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(Ie,Ee,ze,Qe,He){if(!ve.chrome){var Ze=Ee==="opera"?Qe:/^(node|trident)$/.test(Ee)?He:ze;ve.version=Ze,ve.versionNumber=parseFloat(Ze),Ee={trident:"msie",jsdom:"node"}[Ee]||Ee,ve.name=Ee,ve[Ee]=!0}}),ve.chrome&&delete ve.webkit,ve.atom&&delete ve.chrome}},version:"0.12.17",getView:function(){var v=this.project;return v&&v._view},getPaper:function(){return this},execute:function(v,k){var V=wn.PaperScript.execute(v,this,k);return Ei.updateFocus(),V},install:function(v){var k=this;b.each(["project","view","tool"],function($){b.define(v,$,{configurable:!0,get:function(){return k[$]}})});for(var V in this)!/^_/.test(V)&&this[V]&&(v[V]=this[V])},setup:function(v){return wn=this,this.project=new Rt(v),this},createCanvas:function(v,k){return ln.getCanvas(v,k)},activate:function(){wn=this},clear:function(){for(var v=this.projects,k=this.tools,V=v.length-1;V>=0;V--)v[V].remove();for(var V=k.length-1;V>=0;V--)k[V].remove()},remove:function(){this.clear(),delete a._scopes[this._id]},statics:new function(){function v(k){return k+="Attribute",function(V,$){return V[k]($)||V[k]("data-paper-"+$)}}return{_scopes:{},_id:0,get:function(k){return this._scopes[k]||null},getAttribute:v("get"),hasAttribute:v("has")}}}),U=b.extend(E,{initialize:function(v){this._scope=wn,this._index=this._scope[this._list].push(this)-1,(v||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var v=this._scope[this._reference];return v&&v!==this&&v.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",v),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(b.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),W={findItemBoundsCollisions:function(v,k,V){function $(ve){for(var Ie=new Array(ve.length),Ee=0;Ee<ve.length;Ee++){var ze=ve[Ee].getBounds();Ie[Ee]=[ze.left,ze.top,ze.right,ze.bottom]}return Ie}var te=$(v),Ae=!k||k===v?te:$(k);return this.findBoundsCollisions(te,Ae,V||0)},findCurveBoundsCollisions:function(v,k,V,$){function te(Ze){for(var Ve=Math.min,ft=Math.max,rt=new Array(Ze.length),Me=0;Me<Ze.length;Me++){var se=Ze[Me];rt[Me]=[Ve(se[0],se[2],se[4],se[6]),Ve(se[1],se[3],se[5],se[7]),ft(se[0],se[2],se[4],se[6]),ft(se[1],se[3],se[5],se[7])]}return rt}var Ae=te(v),ve=!k||k===v?Ae:te(k);if($){for(var Ie=this.findBoundsCollisions(Ae,ve,V||0,!1,!0),Ee=this.findBoundsCollisions(Ae,ve,V||0,!0,!0),ze=[],Qe=0,He=Ie.length;Qe<He;Qe++)ze[Qe]={hor:Ie[Qe],ver:Ee[Qe]};return ze}return this.findBoundsCollisions(Ae,ve,V||0)},findBoundsCollisions:function(v,k,V,$,te){var Ae=!k||v===k,ve=Ae?v:v.concat(k),Ie=v.length,Ee=ve.length;function ze(ai,di,Ai){for(var Kt=0,oi=ai.length;Kt<oi;){var Ri=oi+Kt>>>1;ve[ai[Ri]][di]<Ai?Kt=Ri+1:oi=Ri}return Kt-1}for(var Qe=$?1:0,He=Qe+2,Ze=$?0:1,Ve=Ze+2,ft=new Array(Ee),rt=0;rt<Ee;rt++)ft[rt]=rt;ft.sort(function(ai,di){return ve[ai][Qe]-ve[di][Qe]});for(var Me=[],se=new Array(Ie),rt=0;rt<Ee;rt++){var ne=ft[rt],X=ve[ne],ie=Ae?ne:ne-Ie,de=ne<Ie,ye=Ae||!de,ge=de?[]:null;if(Me.length){var Pe=ze(Me,He,X[Qe]-V)+1;if(Me.splice(0,Pe),Ae&&te){ge=ge.concat(Me);for(var Fe=0;Fe<Me.length;Fe++){var Ne=Me[Fe];se[Ne].push(ie)}}else for(var Xe=X[Ve],Ye=X[Ze],Fe=0;Fe<Me.length;Fe++){var Ne=Me[Fe],De=ve[Ne],Ue=Ne<Ie,ht=Ae||Ne>=Ie;(te||(de&&ht||ye&&Ue)&&Xe>=De[Ze]-V&&Ye<=De[Ve]+V)&&(de&&ht&&ge.push(Ae?Ne:Ne-Ie),ye&&Ue&&se[Ne].push(ie))}}if(de&&(v===k&&ge.push(ne),se[ne]=ge),Me.length){var Tt=X[He],o=ze(Me,He,Tt);Me.splice(o+1,0,ne)}else Me.push(ne)}for(var rt=0;rt<se.length;rt++){var ke=se[rt];ke&&ke.sort(function(di,Ai){return di-Ai})}return se}},ce=b.extend({initialize:function(v){this.precision=b.pick(v,5),this.multiplier=Math.pow(10,this.precision)},number:function(v){return this.precision<16?Math.round(v*this.multiplier)/this.multiplier:v},pair:function(v,k,V){return this.number(v)+(V||",")+this.number(k)},point:function(v,k){return this.number(v.x)+(k||",")+this.number(v.y)},size:function(v,k){return this.number(v.width)+(k||",")+this.number(v.height)},rectangle:function(v,k){return this.point(v,k)+(k||",")+this.size(v,k)}});ce.instance=new ce;var oe=new function(){var v=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],k=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],V=Math.abs,$=Math.sqrt,te=Math.pow,Ae=Math.log2||function(He){return Math.log(He)*Math.LOG2E},ve=1e-12,Ie=112e-18;function Ee(He,Ze,Ve){return He<Ze?Ze:He>Ve?Ve:He}function ze(He,Ze,Ve){function ft(Pe){var Fe=Pe*134217729,Ne=Pe-Fe,Xe=Ne+Fe,Ye=Pe-Xe;return[Xe,Ye]}var rt=Ze*Ze-He*Ve,Me=Ze*Ze+He*Ve;if(V(rt)*3<Me){var se=ft(He),ne=ft(Ze),X=ft(Ve),ie=Ze*Ze,de=ne[0]*ne[0]-ie+2*ne[0]*ne[1]+ne[1]*ne[1],ye=He*Ve,ge=se[0]*X[0]-ye+se[0]*X[1]+se[1]*X[0]+se[1]*X[1];rt=ie-ye+(de-ge)}return rt}function Qe(){var He=Math.max.apply(Math,arguments);return He&&(He<1e-8||He>1e8)?te(2,-Math.round(Ae(He))):0}return{EPSILON:ve,MACHINE_EPSILON:Ie,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*($(2)-1)/3,isZero:function(He){return He>=-ve&&He<=ve},isMachineZero:function(He){return He>=-Ie&&He<=Ie},clamp:Ee,integrate:function(He,Ze,Ve,ft){for(var rt=v[ft-2],Me=k[ft-2],se=(Ve-Ze)*.5,ne=se+Ze,X=0,ie=ft+1>>1,de=ft&1?Me[X++]*He(ne):0;X<ie;){var ye=se*rt[X];de+=Me[X++]*(He(ne+ye)+He(ne-ye))}return se*de},findRoot:function(He,Ze,Ve,ft,rt,Me,se){for(var ne=0;ne<Me;ne++){var X=He(Ve),ie=X/Ze(Ve),de=Ve-ie;if(V(ie)<se){Ve=de;break}X>0?(rt=Ve,Ve=de<=ft?(ft+rt)*.5:de):(ft=Ve,Ve=de>=rt?(ft+rt)*.5:de)}return Ee(Ve,ft,rt)},solveQuadratic:function(He,Ze,Ve,ft,rt,Me){var se,ne=1/0;if(V(He)<ve){if(V(Ze)<ve)return V(Ve)<ve?-1:0;se=-Ve/Ze}else{Ze*=-.5;var X=ze(He,Ze,Ve);if(X&&V(X)<Ie){var ie=Qe(V(He),V(Ze),V(Ve));ie&&(He*=ie,Ze*=ie,Ve*=ie,X=ze(He,Ze,Ve))}if(X>=-Ie){var de=X<0?0:$(X),ye=Ze+(Ze<0?-de:de);ye===0?(se=Ve/He,ne=-se):(se=ye/He,ne=Ve/ye)}}var ge=0,Pe=rt==null,Fe=rt-ve,Ne=Me+ve;return isFinite(se)&&(Pe||se>Fe&&se<Ne)&&(ft[ge++]=Pe?se:Ee(se,rt,Me)),ne!==se&&isFinite(ne)&&(Pe||ne>Fe&&ne<Ne)&&(ft[ge++]=Pe?ne:Ee(ne,rt,Me)),ge},solveCubic:function(He,Ze,Ve,ft,rt,Me,se){var ne=Qe(V(He),V(Ze),V(Ve),V(ft)),X,ie,de,ye,ge;ne&&(He*=ne,Ze*=ne,Ve*=ne,ft*=ne);function Pe(o){X=o;var ke=He*X;ie=ke+Ze,de=ie*X+Ve,ye=(ke+ie)*X+de,ge=de*X+ft}if(V(He)<ve)He=Ze,ie=Ve,de=ft,X=1/0;else if(V(ft)<ve)ie=Ze,de=Ve,X=0;else{Pe(-(Ze/He)/3);var Fe=ge/He,Ne=te(V(Fe),1/3),Xe=Fe<0?-1:1,Ye=-ye/He,De=Ye>0?1.324717957244746*Math.max(Ne,$(Ye)):Ne,Ue=X-Xe*De;if(Ue!==X){do Pe(Ue),Ue=ye===0?X:X-ge/ye/(1+Ie);while(Xe*Ue>Xe*X);V(He)*X*X>V(ft/X)&&(de=-ft/X,ie=(de-Ve)/X)}}var ht=oe.solveQuadratic(He,ie,de,rt,Me,se),Tt=Me==null;return isFinite(X)&&(ht===0||ht>0&&X!==rt[0]&&X!==rt[1])&&(Tt||X>Me-ve&&X<se+ve)&&(rt[ht++]=Tt?X:Ee(X,Me,se)),ht}}},fe={_id:1,_pools:{},get:function(v){if(v){var k=this._pools[v];return k||(k=this._pools[v]={_id:1}),k._id++}else return this._id++}},we=b.extend({_class:"Point",_readIndex:!0,initialize:function(k,V){var $=typeof k,te=this.__read,Ae=0;if($==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(Ae=ve?2:1)}else if($==="undefined"||k===null)this._set(0,0),te&&(Ae=k===null?1:0);else{var Ie=$==="string"?k.split(/[\s,]+/)||[]:k;Ae=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"x"in Ie?this._set(Ie.x||0,Ie.y||0):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"angle"in Ie?(this._set(Ie.length||0,0),this.setAngle(Ie.angle||0)):(this._set(0,0),Ae=0)}return te&&(this.__read=Ae),this},set:"#initialize",_set:function(v,k){return this.x=v,this.y=k,this},equals:function(v){return this===v||v&&(this.x===v.x&&this.y===v.y||Array.isArray(v)&&this.x===v[0]&&this.y===v[1])||!1},clone:function(){return new we(this.x,this.y)},toString:function(){var v=ce.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(v){if(this.isZero()){var k=this._angle||0;this._set(Math.cos(k)*v,Math.sin(k)*v)}else{var V=v/this.getLength();oe.isZero(V)&&this.getAngle(),this._set(this.x*V,this.y*V)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(v){this.setAngleInRadians.call(this,v*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var v=we.read(arguments),k=this.getLength()*v.getLength();if(oe.isZero(k))return NaN;var V=this.dot(v)/k;return Math.acos(V<-1?-1:V>1?1:V)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(v){if(this._angle=v,!this.isZero()){var k=this.getLength();this._set(Math.cos(v)*k,Math.sin(v)*k)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var v=we.read(arguments);return Math.atan2(this.cross(v),this.dot(v))*180/Math.PI},getDistance:function(){var v=arguments,k=we.read(v),V=k.x-this.x,$=k.y-this.y,te=V*V+$*$,Ae=b.read(v);return Ae?te:Math.sqrt(te)},normalize:function(v){v===n&&(v=1);var k=this.getLength(),V=k!==0?v/k:0,$=new we(this.x*V,this.y*V);return V>=0&&($._angle=this._angle),$},rotate:function(v,k){if(v===0)return this.clone();v=v*Math.PI/180;var V=k?this.subtract(k):this,$=Math.sin(v),te=Math.cos(v);return V=new we(V.x*te-V.y*$,V.x*$+V.y*te),k?V.add(k):V},transform:function(v){return v?v._transformPoint(this):this},add:function(){var v=we.read(arguments);return new we(this.x+v.x,this.y+v.y)},subtract:function(){var v=we.read(arguments);return new we(this.x-v.x,this.y-v.y)},multiply:function(){var v=we.read(arguments);return new we(this.x*v.x,this.y*v.y)},divide:function(){var v=we.read(arguments);return new we(this.x/v.x,this.y/v.y)},modulo:function(){var v=we.read(arguments);return new we(this.x%v.x,this.y%v.y)},negate:function(){return new we(-this.x,-this.y)},isInside:function(){return st.read(arguments).contains(this)},isClose:function(){var v=arguments,k=we.read(v),V=b.read(v);return this.getDistance(k)<=V},isCollinear:function(){var v=we.read(arguments);return we.isCollinear(this.x,this.y,v.x,v.y)},isColinear:"#isCollinear",isOrthogonal:function(){var v=we.read(arguments);return we.isOrthogonal(this.x,this.y,v.x,v.y)},isZero:function(){var v=oe.isZero;return v(this.x)&&v(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(v){return this.x*(v>1&&v<4?-1:1)>=0&&this.y*(v>2?-1:1)>=0},dot:function(){var v=we.read(arguments);return this.x*v.x+this.y*v.y},cross:function(){var v=we.read(arguments);return this.x*v.y-this.y*v.x},project:function(){var v=we.read(arguments),k=v.isZero()?0:this.dot(v)/v.dot(v);return new we(v.x*k,v.y*k)},statics:{min:function(){var v=arguments,k=we.read(v),V=we.read(v);return new we(Math.min(k.x,V.x),Math.min(k.y,V.y))},max:function(){var v=arguments,k=we.read(v),V=we.read(v);return new we(Math.max(k.x,V.x),Math.max(k.y,V.y))},random:function(){return new we(Math.random(),Math.random())},isCollinear:function(v,k,V,$){return Math.abs(v*$-k*V)<=Math.sqrt((v*v+k*k)*(V*V+$*$))*1e-8},isOrthogonal:function(v,k,V,$){return Math.abs(v*V+k*$)<=Math.sqrt((v*v+k*k)*(V*V+$*$))*1e-8}}},b.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new we(k(this.x),k(this.y))}},{})),et=we.extend({initialize:function(k,V,$,te){this._x=k,this._y=V,this._owner=$,this._setter=te},_set:function(v,k,V){return this._x=v,this._y=k,V||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),lt=b.extend({_class:"Size",_readIndex:!0,initialize:function(k,V){var $=typeof k,te=this.__read,Ae=0;if($==="number"){var ve=typeof V=="number";this._set(k,ve?V:k),te&&(Ae=ve?2:1)}else if($==="undefined"||k===null)this._set(0,0),te&&(Ae=k===null?1:0);else{var Ie=$==="string"?k.split(/[\s,]+/)||[]:k;Ae=1,Array.isArray(Ie)?this._set(+Ie[0],+(Ie.length>1?Ie[1]:Ie[0])):"width"in Ie?this._set(Ie.width||0,Ie.height||0):"x"in Ie?this._set(Ie.x||0,Ie.y||0):(this._set(0,0),Ae=0)}return te&&(this.__read=Ae),this},set:"#initialize",_set:function(v,k){return this.width=v,this.height=k,this},equals:function(v){return v===this||v&&(this.width===v.width&&this.height===v.height||Array.isArray(v)&&this.width===v[0]&&this.height===v[1])||!1},clone:function(){return new lt(this.width,this.height)},toString:function(){var v=ce.instance;return"{ width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.width),k.number(this.height)]},add:function(){var v=lt.read(arguments);return new lt(this.width+v.width,this.height+v.height)},subtract:function(){var v=lt.read(arguments);return new lt(this.width-v.width,this.height-v.height)},multiply:function(){var v=lt.read(arguments);return new lt(this.width*v.width,this.height*v.height)},divide:function(){var v=lt.read(arguments);return new lt(this.width/v.width,this.height/v.height)},modulo:function(){var v=lt.read(arguments);return new lt(this.width%v.width,this.height%v.height)},negate:function(){return new lt(-this.width,-this.height)},isZero:function(){var v=oe.isZero;return v(this.width)&&v(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(v,k){return new lt(Math.min(v.width,k.width),Math.min(v.height,k.height))},max:function(v,k){return new lt(Math.max(v.width,k.width),Math.max(v.height,k.height))},random:function(){return new lt(Math.random(),Math.random())}}},b.each(["round","ceil","floor","abs"],function(v){var k=Math[v];this[v]=function(){return new lt(k(this.width),k(this.height))}},{})),Ke=lt.extend({initialize:function(k,V,$,te){this._width=k,this._height=V,this._owner=$,this._setter=te},_set:function(v,k,V){return this._width=v,this._height=k,V||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(v){this._width=v,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(v){this._height=v,this._owner[this._setter](this)}}),st=b.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(k,V,$,te){var Ae=arguments,ve=typeof k,Ie;if(ve==="number"?(this._set(k,V,$,te),Ie=4):ve==="undefined"||k===null?(this._set(0,0,0,0),Ie=k===null?1:0):Ae.length===1&&(Array.isArray(k)?(this._set.apply(this,k),Ie=1):k.x!==n||k.width!==n?(this._set(k.x||0,k.y||0,k.width||0,k.height||0),Ie=1):k.from===n&&k.to===n&&(this._set(0,0,0,0),b.readSupported(Ae,this)&&(Ie=1))),Ie===n){var Ee=we.readNamed(Ae,"from"),ze=b.peek(Ae),Qe=Ee.x,He=Ee.y,Ze,Ve;if(ze&&ze.x!==n||b.hasNamed(Ae,"to")){var ft=we.readNamed(Ae,"to");Ze=ft.x-Qe,Ve=ft.y-He,Ze<0&&(Qe=ft.x,Ze=-Ze),Ve<0&&(He=ft.y,Ve=-Ve)}else{var rt=lt.read(Ae);Ze=rt.width,Ve=rt.height}this._set(Qe,He,Ze,Ve),Ie=Ae.__index}var Me=Ae.__filtered;return Me&&(this.__filtered=Me),this.__read&&(this.__read=Ie),this},set:"#initialize",_set:function(v,k,V,$){return this.x=v,this.y=k,this.width=V,this.height=$,this},clone:function(){return new st(this.x,this.y,this.width,this.height)},equals:function(v){var k=b.isPlainValue(v)?st.read(arguments):v;return k===this||k&&this.x===k.x&&this.y===k.y&&this.width===k.width&&this.height===k.height||!1},toString:function(){var v=ce.instance;return"{ x: "+v.number(this.x)+", y: "+v.number(this.y)+", width: "+v.number(this.width)+", height: "+v.number(this.height)+" }"},_serialize:function(v){var k=v.formatter;return[k.number(this.x),k.number(this.y),k.number(this.width),k.number(this.height)]},getPoint:function(v){var k=v?we:et;return new k(this.x,this.y,this,"setPoint")},setPoint:function(){var v=we.read(arguments);this.x=v.x,this.y=v.y},getSize:function(v){var k=v?lt:Ke;return new k(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var v=lt.read(arguments),k=this._sx,V=this._sy,$=v.width,te=v.height;k&&(this.x+=(this.width-$)*k),V&&(this.y+=(this.height-te)*V),this.width=$,this.height=te,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(v){if(!this._fw){var k=v-this.x;this.width-=this._sx===.5?k*2:k}this.x=v,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(v){if(!this._fh){var k=v-this.y;this.height-=this._sy===.5?k*2:k}this.y=v,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(v){if(!this._fw){var k=v-this.x;this.width=this._sx===.5?k*2:k}this.x=v-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(v){if(!this._fh){var k=v-this.y;this.height=this._sy===.5?k*2:k}this.y=v-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(v){this._fw||this._sx===.5?this.x=v-this.width/2:(this._sx&&(this.x+=(v-this.x)*2*this._sx),this.width=(v-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(v){this._fh||this._sy===.5?this.y=v-this.height/2:(this._sy&&(this.y+=(v-this.y)*2*this._sy),this.height=(v-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(v){var k=v?we:et;return new k(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var v=we.read(arguments);return this.setCenterX(v.x),this.setCenterY(v.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(v){return v&&v.width!==n||(Array.isArray(v)?v:arguments).length===4?this._containsRectangle(st.read(arguments)):this._containsPoint(we.read(arguments))},_containsPoint:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k<=this.x+this.width&&V<=this.y+this.height},_containsRectangle:function(v){var k=v.x,V=v.y;return k>=this.x&&V>=this.y&&k+v.width<=this.x+this.width&&V+v.height<=this.y+this.height},intersects:function(){var v=st.read(arguments),k=b.read(arguments)||0;return v.x+v.width>this.x-k&&v.y+v.height>this.y-k&&v.x<this.x+this.width+k&&v.y<this.y+this.height+k},intersect:function(){var v=st.read(arguments),k=Math.max(this.x,v.x),V=Math.max(this.y,v.y),$=Math.min(this.x+this.width,v.x+v.width),te=Math.min(this.y+this.height,v.y+v.height);return new st(k,V,$-k,te-V)},unite:function(){var v=st.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),$=Math.max(this.x+this.width,v.x+v.width),te=Math.max(this.y+this.height,v.y+v.height);return new st(k,V,$-k,te-V)},include:function(){var v=we.read(arguments),k=Math.min(this.x,v.x),V=Math.min(this.y,v.y),$=Math.max(this.x+this.width,v.x),te=Math.max(this.y+this.height,v.y);return new st(k,V,$-k,te-V)},expand:function(){var v=lt.read(arguments),k=v.width,V=v.height;return new st(this.x-k/2,this.y-V/2,this.width+k,this.height+V)},scale:function(v,k){return this.expand(this.width*v-this.width,this.height*(k===n?v:k)-this.height)}},b.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(v,k){var V=v.join(""),$=/^[RL]/.test(V);k>=4&&(v[1]+=$?"Y":"X");var te=v[$?0:1],Ae=v[$?1:0],ve="get"+te,Ie="get"+Ae,Ee="set"+te,ze="set"+Ae,Qe="get"+V,He="set"+V;this[Qe]=function(Ze){var Ve=Ze?we:et;return new Ve(this[ve](),this[Ie](),this,He)},this[He]=function(){var Ze=we.read(arguments);this[Ee](Ze.x),this[ze](Ze.y)}},{beans:!0})),ut=st.extend({initialize:function(k,V,$,te,Ae,ve){this._set(k,V,$,te,!0),this._owner=Ae,this._setter=ve},_set:function(v,k,V,$,te){return this._x=v,this._y=k,this._width=V,this._height=$,te||this._owner[this._setter](this),this}},new function(){var v=st.prototype;return b.each(["x","y","width","height"],function(k){var V=b.capitalize(k),$="_"+k;this["get"+V]=function(){return this[$]},this["set"+V]=function(te){this[$]=te,this._dontNotify||this._owner[this._setter](this)}},b.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(k){var V="set"+k;this[V]=function(){this._dontNotify=!0,v[V].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(k){var V=this._owner;V._changeSelection&&V._changeSelection(2,k)}}))}),kt=b.extend({_class:"Matrix",initialize:function v(k,V){var $=arguments,te=$.length,Ae=!0;if(te>=6?this._set.apply(this,$):te===1||te===2?k instanceof v?this._set(k._a,k._b,k._c,k._d,k._tx,k._ty,V):Array.isArray(k)?this._set.apply(this,V?k.concat([V]):k):Ae=!1:te?Ae=!1:this.reset(),!Ae)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(v,k,V,$,te,Ae,ve){return this._a=v,this._b=k,this._c=V,this._d=$,this._tx=te,this._ty=Ae,ve||this._changed(),this},_serialize:function(v,k){return b.serialize(this.getValues(),v,!0,k)},_changed:function(){var v=this._owner;v&&(v._applyMatrix?v.transform(null,!0):v._changed(25))},clone:function(){return new kt(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(v){return v===this||v&&this._a===v._a&&this._b===v._b&&this._c===v._c&&this._d===v._d&&this._tx===v._tx&&this._ty===v._ty},toString:function(){var v=ce.instance;return"[["+[v.number(this._a),v.number(this._c),v.number(this._tx)].join(", ")+"], ["+[v.number(this._b),v.number(this._d),v.number(this._ty)].join(", ")+"]]"},reset:function(v){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,v||this._changed(),this},apply:function(v,k){var V=this._owner;return V?(V.transform(null,b.pick(v,!0),k),this.isIdentity()):!1},translate:function(){var v=we.read(arguments),k=v.x,V=v.y;return this._tx+=k*this._a+V*this._c,this._ty+=k*this._b+V*this._d,this._changed(),this},scale:function(){var v=arguments,k=we.read(v),V=we.read(v,0,{readNull:!0});return V&&this.translate(V),this._a*=k.x,this._b*=k.x,this._c*=k.y,this._d*=k.y,V&&this.translate(V.negate()),this._changed(),this},rotate:function(v){v*=Math.PI/180;var k=we.read(arguments,1),V=k.x,$=k.y,te=Math.cos(v),Ae=Math.sin(v),ve=V-V*te+$*Ae,Ie=$-V*Ae-$*te,Ee=this._a,ze=this._b,Qe=this._c,He=this._d;return this._a=te*Ee+Ae*Qe,this._b=te*ze+Ae*He,this._c=-Ae*Ee+te*Qe,this._d=-Ae*ze+te*He,this._tx+=ve*Ee+Ie*Qe,this._ty+=ve*ze+Ie*He,this._changed(),this},shear:function(){var v=arguments,k=we.read(v),V=we.read(v,0,{readNull:!0});V&&this.translate(V);var $=this._a,te=this._b;return this._a+=k.y*this._c,this._b+=k.y*this._d,this._c+=k.x*$,this._d+=k.x*te,V&&this.translate(V.negate()),this._changed(),this},skew:function(){var v=arguments,k=we.read(v),V=we.read(v,0,{readNull:!0}),$=Math.PI/180,te=new we(Math.tan(k.x*$),Math.tan(k.y*$));return this.shear(te,V)},append:function(v,k){if(v){var V=this._a,$=this._b,te=this._c,Ae=this._d,ve=v._a,Ie=v._c,Ee=v._b,ze=v._d,Qe=v._tx,He=v._ty;this._a=ve*V+Ee*te,this._c=Ie*V+ze*te,this._b=ve*$+Ee*Ae,this._d=Ie*$+ze*Ae,this._tx+=Qe*V+He*te,this._ty+=Qe*$+He*Ae,k||this._changed()}return this},prepend:function(v,k){if(v){var V=this._a,$=this._b,te=this._c,Ae=this._d,ve=this._tx,Ie=this._ty,Ee=v._a,ze=v._c,Qe=v._b,He=v._d,Ze=v._tx,Ve=v._ty;this._a=Ee*V+ze*$,this._c=Ee*te+ze*Ae,this._b=Qe*V+He*$,this._d=Qe*te+He*Ae,this._tx=Ee*ve+ze*Ie+Ze,this._ty=Qe*ve+He*Ie+Ve,k||this._changed()}return this},appended:function(v){return this.clone().append(v)},prepended:function(v){return this.clone().prepend(v)},invert:function(){var v=this._a,k=this._b,V=this._c,$=this._d,te=this._tx,Ae=this._ty,ve=v*$-k*V,Ie=null;return ve&&!isNaN(ve)&&isFinite(te)&&isFinite(Ae)&&(this._a=$/ve,this._b=-k/ve,this._c=-V/ve,this._d=v/ve,this._tx=(V*Ae-$*te)/ve,this._ty=(k*te-v*Ae)/ve,Ie=this),Ie},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new kt(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var v=this._a*this._d-this._c*this._b;return v&&!isNaN(v)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(v,k,V){return arguments.length<3?this._transformPoint(we.read(arguments)):this._transformCoordinates(v,k,V)},_transformPoint:function(v,k,V){var $=v.x,te=v.y;return k||(k=new we),k._set($*this._a+te*this._c+this._tx,$*this._b+te*this._d+this._ty,V)},_transformCoordinates:function(v,k,V){for(var $=0,te=2*V;$<te;$+=2){var Ae=v[$],ve=v[$+1];k[$]=Ae*this._a+ve*this._c+this._tx,k[$+1]=Ae*this._b+ve*this._d+this._ty}return k},_transformCorners:function(v){var k=v.x,V=v.y,$=k+v.width,te=V+v.height,Ae=[k,V,$,V,$,te,k,te];return this._transformCoordinates(Ae,Ae,4)},_transformBounds:function(v,k,V){for(var $=this._transformCorners(v),te=$.slice(0,2),Ae=te.slice(),ve=2;ve<8;ve++){var Ie=$[ve],Ee=ve&1;Ie<te[Ee]?te[Ee]=Ie:Ie>Ae[Ee]&&(Ae[Ee]=Ie)}return k||(k=new st),k._set(te[0],te[1],Ae[0]-te[0],Ae[1]-te[1],V)},inverseTransform:function(){return this._inverseTransform(we.read(arguments))},_inverseTransform:function(v,k,V){var $=this._a,te=this._b,Ae=this._c,ve=this._d,Ie=this._tx,Ee=this._ty,ze=$*ve-te*Ae,Qe=null;if(ze&&!isNaN(ze)&&isFinite(Ie)&&isFinite(Ee)){var He=v.x-this._tx,Ze=v.y-this._ty;k||(k=new we),Qe=k._set((He*ve-Ze*Ae)/ze,(Ze*$-He*te)/ze,V)}return Qe},decompose:function(){var v=this._a,k=this._b,V=this._c,$=this._d,te=v*$-k*V,Ae=Math.sqrt,ve=Math.atan2,Ie=180/Math.PI,Ee,ze,Qe;if(v!==0||k!==0){var He=Ae(v*v+k*k);Ee=Math.acos(v/He)*(k>0?1:-1),ze=[He,te/He],Qe=[ve(v*V+k*$,He*He),0]}else if(V!==0||$!==0){var Ze=Ae(V*V+$*$);Ee=Math.asin(V/Ze)*($>0?1:-1),ze=[te/Ze,Ze],Qe=[0,ve(v*V+k*$,Ze*Ze)]}else Ee=0,Qe=ze=[0,0];return{translation:this.getTranslation(),rotation:Ee*Ie,scaling:new we(ze),skewing:new we(Qe[0]*Ie,Qe[1]*Ie)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new we(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(v){this.isIdentity()||v.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},b.each(["a","b","c","d","tx","ty"],function(v){var k=b.capitalize(v),V="_"+v;this["get"+k]=function(){return this[V]},this["set"+k]=function($){this[V]=$,this._changed()}},{})),Bt=b.extend({_class:"Line",initialize:function(k,V,$,te,Ae){var ve=!1;arguments.length>=4?(this._px=k,this._py=V,this._vx=$,this._vy=te,ve=Ae):(this._px=k.x,this._py=k.y,this._vx=V.x,this._vy=V.y,ve=$),ve||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new we(this._px,this._py)},getVector:function(){return new we(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(v,k){return Bt.intersect(this._px,this._py,this._vx,this._vy,v._px,v._py,v._vx,v._vy,!0,k)},getSide:function(v,k){return Bt.getSide(this._px,this._py,this._vx,this._vy,v.x,v.y,!0,k)},getDistance:function(v){return Math.abs(this.getSignedDistance(v))},getSignedDistance:function(v){return Bt.getSignedDistance(this._px,this._py,this._vx,this._vy,v.x,v.y,!0)},isCollinear:function(v){return we.isCollinear(this._vx,this._vy,v._vx,v._vy)},isOrthogonal:function(v){return we.isOrthogonal(this._vx,this._vy,v._vx,v._vy)},statics:{intersect:function(v,k,V,$,te,Ae,ve,Ie,Ee,ze){Ee||(V-=v,$-=k,ve-=te,Ie-=Ae);var Qe=V*Ie-$*ve;if(!oe.isMachineZero(Qe)){var He=v-te,Ze=k-Ae,Ve=(ve*Ze-Ie*He)/Qe,ft=(V*Ze-$*He)/Qe,rt=1e-12,Me=-rt,se=1+rt;if(ze||Me<Ve&&Ve<se&&Me<ft&&ft<se)return ze||(Ve=Ve<=0?0:Ve>=1?1:Ve),new we(v+Ve*V,k+Ve*$)}},getSide:function(v,k,V,$,te,Ae,ve,Ie){ve||(V-=v,$-=k);var Ee=te-v,ze=Ae-k,Qe=Ee*$-ze*V;return!Ie&&oe.isMachineZero(Qe)&&(Qe=(Ee*V+Ee*V)/(V*V+$*$),Qe>=0&&Qe<=1&&(Qe=0)),Qe<0?-1:Qe>0?1:0},getSignedDistance:function(v,k,V,$,te,Ae,ve){return ve||(V-=v,$-=k),V===0?$>0?te-v:v-te:$===0?V<0?Ae-k:k-Ae:((te-v)*$-(Ae-k)*V)/($>V?$*Math.sqrt(1+V*V/($*$)):V*Math.sqrt(1+$*$/(V*V)))},getDistance:function(v,k,V,$,te,Ae,ve){return Math.abs(Bt.getSignedDistance(v,k,V,$,te,Ae,ve))}}}),Rt=U.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(k){U.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Ti(null,null,this),this._view=Ei.create(this,k||ln.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(v,k){return b.serialize(this._children,v,!0,k)},_changed:function(v,k){if(v&1){var V=this._view;V&&(V._needsUpdate=!0,!V._requested&&V._autoUpdate&&V.requestUpdate())}var $=this._changes;if($&&k){var te=this._changesById,Ae=k._id,ve=te[Ae];ve?ve.flags|=v:$.push(te[Ae]={item:k,flags:v})}},clear:function(){for(var v=this._children,k=v.length-1;k>=0;k--)v[k].remove()},isEmpty:function(){return!this._children.length},remove:function v(){return v.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(v){this._currentStyle.set(v)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new it({project:this,insert:!0})},getSymbolDefinitions:function(){var v=[],k={};return this.getItems({class:mt,match:function(V){var $=V._definition,te=$._id;return k[te]||(k[te]=!0,v.push($)),!1}}),v},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var v=this._selectionItems,k=[];for(var V in v){var $=v[V],te=$._selection;te&1&&$.isInserted()?k.push($):te||this._updateSelection($)}return k},_updateSelection:function(v){var k=v._id,V=this._selectionItems;v._selection?V[k]!==v&&(this._selectionCount++,V[k]=v):V[k]===v&&(this._selectionCount--,delete V[k])},selectAll:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)v[k].setFullySelected(!0)},deselectAll:function(){var v=this._selectionItems;for(var k in v)v[k].setFullySelected(!1)},addLayer:function(v){return this.insertLayer(n,v)},insertLayer:function(v,k){if(k instanceof it){k._remove(!1,!0),b.splice(this._children,[k],v,0),k._setProject(this,!0);var V=k._name;V&&k.setName(V),this._changes&&k._changed(5),this._activeLayer||(this._activeLayer=k)}else k=null;return k},_insertItem:function(v,k,V){return k=this.insertLayer(v,k)||(this._activeLayer||this._insertItem(n,new it(Ge.NO_INSERT),!0)).insertChild(v,k),V&&k.activate&&k.activate(),k},getItems:function(v){return Ge._getItems(this,v)},getItem:function(v){return Ge._getItems(this,v,null,null,!0)[0]||null},importJSON:function(v){this.activate();var k=this._activeLayer;return b.importJSON(v,k&&k.isEmpty()&&k)},removeOn:function(v){var k=this._removeSets;if(k){v==="mouseup"&&(k.mousedrag=null);var V=k[v];if(V){for(var $ in V){var te=V[$];for(var Ae in k){var ve=k[Ae];ve&&ve!=V&&delete ve[te._id]}te.remove()}k[v]=null}}},draw:function(v,k,V){this._updateVersion++,v.save(),k.applyToContext(v);for(var $=this._children,te=new b({offset:new we(0,0),pixelRatio:V,viewMatrix:k.isIdentity()?null:k,matrices:[new kt],updateMatrix:!0}),Ae=0,ve=$.length;Ae<ve;Ae++)$[Ae].draw(v,te);if(v.restore(),this._selectionCount>0){v.save(),v.strokeWidth=1;var Ie=this._selectionItems,Ee=this._scope.settings.handleSize,ze=this._updateVersion;for(var Qe in Ie)Ie[Qe]._drawSelection(v,k,Ee,Ie,ze);v.restore()}}}),Ge=b.extend(E,{statics:{extend:function v(k){return k._serializeFields&&(k._serializeFields=b.set({},this.prototype._serializeFields,k._serializeFields)),v.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new kt,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var v=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return b.each(v,function(k){this._events[k]={install:function(V){this.getView()._countItemEvent(V,1)},uninstall:function(V){this.getView()._countItemEvent(V,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:v}})},{initialize:function(){},_initialize:function(v,k){var V=v&&b.isPlainObject(v),$=V&&v.internal===!0,te=this._matrix=new kt,Ae=V&&v.project||wn.project,ve=wn.settings;return this._id=$?null:fe.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&ve.applyMatrix,k&&te.translate(k),te._owner=this,this._style=new Ti(Ae._currentStyle,this,Ae),$||V&&v.insert==!1||!ve.insertItems&&!(V&&v.insert==!0)?this._setProject(Ae):(V&&v.parent||Ae)._insertItem(n,this,!0),V&&v!==Ge.NO_INSERT&&v!==Ge.INSERT&&this.set(v,{internal:!0,insert:!0,project:!0,parent:!0}),V},_serialize:function(v,k){var V={},$=this;function te(Ae){for(var ve in Ae){var Ie=$[ve];b.equals(Ie,ve==="leading"?Ae.fontSize*1.2:Ae[ve])||(V[ve]=b.serialize(Ie,v,ve!=="data",k))}}return te(this._serializeFields),this instanceof ni||te(this._style._defaults),[this._class,V]},_changed:function(v){var k=this._symbol,V=this._parent||k,$=this._project;v&8&&(this._bounds=this._position=this._decomposed=n),v&16&&(this._globalMatrix=n),V&&v&72&&Ge._clearBoundsCache(V),v&2&&Ge._clearBoundsCache(this),$&&$._changed(v,this),k&&k._changed(v)},getId:function(){return this._id},getName:function(){return this._name},setName:function(v){if(this._name&&this._removeNamed(),v===+v+"")throw new Error("Names consisting only of numbers are not supported.");var k=this._getOwner();if(v&&k){var V=k._children,$=k._namedChildren;($[v]=$[v]||[]).push(this),v in V||(V[v]=this)}this._name=v||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(v){this.getStyle().set(v)}},b.each(["locked","visible","blendMode","opacity","guide"],function(v){var k=b.capitalize(v),V="_"+v,$={locked:256,visible:265};this["get"+k]=function(){return this[V]},this["set"+k]=function(te){te!=this[V]&&(this[V]=te,this._changed($[v]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(v){if(v!==this._selection){this._selection=v;var k=this._project;k&&(k._updateSelection(this),this._changed(257))}},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){if(this._selectChildren){for(var v=this._children,k=0,V=v.length;k<V;k++)if(v[k].isSelected())return!0}return!!(this._selection&1)},setSelected:function(v){if(this._selectChildren)for(var k=this._children,V=0,$=k.length;V<$;V++)k[V].setSelected(v);this._changeSelection(1,v)},isFullySelected:function(){var v=this._children,k=!!(this._selection&1);if(v&&k){for(var V=0,$=v.length;V<$;V++)if(!v[V].isFullySelected())return!1;return!0}return k},setFullySelected:function(v){var k=this._children;if(k)for(var V=0,$=k.length;V<$;V++)k[V].setFullySelected(v);this._changeSelection(1,v)},isClipMask:function(){return this._clipMask},setClipMask:function(v){this._clipMask!=(v=!!v)&&(this._clipMask=v,v&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(v){this._data=v},getPosition:function(v){var k=v?we:et,V=this._position||(this._position=this._getPositionFromBounds());return new k(V.x,V.y,this,"setPosition")},setPosition:function(){this.translate(we.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(v){return this._pivot?this._matrix._transformPoint(this._pivot):(v||this.getBounds()).getCenter(!0)},getPivot:function(){var v=this._pivot;return v?new et(v.x,v.y,this,"setPivot"):null},setPivot:function(){this._pivot=we.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},b.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(v,k){this[k]=function(V){return this.getBounds(V,v)}},{beans:!0,getBounds:function(v,k){var V=k||v instanceof kt,$=b.set({},V?k:v,this._boundsOptions);(!$.stroke||this.getStrokeScaling())&&($.cacheItem=this);var te=this._getCachedBounds(V&&v,$).rect;return arguments.length?te:new ut(te.x,te.y,te.width,te.height,this,"setBounds")},setBounds:function(){var v=st.read(arguments),k=this.getBounds(),V=this._matrix,$=new kt,te=v.getCenter();$.translate(te),(v.width!=k.width||v.height!=k.height)&&(V.isInvertible()||(V.set(V._backup||new kt().translate(V.getTranslation())),k=this.getBounds()),$.scale(k.width!==0?v.width/k.width:0,k.height!==0?v.height/k.height:0)),te=k.getCenter(),$.translate(-te.x,-te.y),this.transform($)},_getBounds:function(v,k){var V=this._children;return!V||!V.length?new st:(Ge._updateBoundsCache(this,k.cacheItem),Ge._getBounds(V,v,k))},_getBoundsCacheKey:function(v,k){return[v.stroke?1:0,v.handle?1:0,k?1:0].join("")},_getCachedBounds:function(v,k,V){v=v&&v._orNullIfIdentity();var $=k.internal&&!V,te=k.cacheItem,Ae=$?null:this._matrix._orNullIfIdentity(),ve=te&&(!v||v.equals(Ae))&&this._getBoundsCacheKey(k,$),Ie=this._bounds;if(Ge._updateBoundsCache(this._parent||this._symbol,te),ve&&Ie&&ve in Ie){var Ee=Ie[ve];return{rect:Ee.rect.clone(),nonscaling:Ee.nonscaling}}var ze=this._getBounds(v||Ae,k),Qe=ze.rect||ze,He=this._style,Ze=ze.nonscaling||He.hasStroke()&&!He.getStrokeScaling();if(ve){Ie||(this._bounds=Ie={});var Ee=Ie[ve]={rect:Qe.clone(),nonscaling:Ze,internal:$}}return{rect:Qe,nonscaling:Ze}},_getStrokeMatrix:function(v,k){var V=this.getStrokeScaling()?null:k&&k.internal?this:this._parent||this._symbol&&this._symbol._item,$=V?V.getViewMatrix().invert():v;return $&&$._shiftless()},statics:{_updateBoundsCache:function(v,k){if(v&&k){var V=k._id,$=v._boundsCache=v._boundsCache||{ids:{},list:[]};$.ids[V]||($.list.push(k),$.ids[V]=k)}},_clearBoundsCache:function(v){var k=v._boundsCache;if(k){v._bounds=v._position=v._boundsCache=n;for(var V=0,$=k.list,te=$.length;V<te;V++){var Ae=$[V];Ae!==v&&(Ae._bounds=Ae._position=n,Ae._boundsCache&&Ge._clearBoundsCache(Ae))}}},_getBounds:function(v,k,V){var $=1/0,te=-$,Ae=$,ve=te,Ie=!1;V=V||{};for(var Ee=0,ze=v.length;Ee<ze;Ee++){var Qe=v[Ee];if(Qe._visible&&!Qe.isEmpty(!0)){var He=Qe._getCachedBounds(k&&k.appended(Qe._matrix),V,!0),Ze=He.rect;$=Math.min(Ze.x,$),Ae=Math.min(Ze.y,Ae),te=Math.max(Ze.x+Ze.width,te),ve=Math.max(Ze.y+Ze.height,ve),He.nonscaling&&(Ie=!0)}}return{rect:isFinite($)?new st($,Ae,te-$,ve-Ae):new st,nonscaling:Ie}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var v=this._decompose();return v?v.rotation:0},setRotation:function(v){var k=this.getRotation();if(k!=null&&v!=null){var V=this._decomposed;this.rotate(v-k),V&&(V.rotation=v,this._decomposed=V)}},getScaling:function(){var v=this._decompose(),k=v&&v.scaling;return new et(k?k.x:1,k?k.y:1,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=we.read(arguments,0,{clone:!0,readNull:!0});if(v&&k&&!v.equals(k)){var V=this.getRotation(),$=this._decomposed,te=new kt,Ae=oe.isZero;if(Ae(v.x)||Ae(v.y))te.translate($.translation),V&&te.rotate(V),te.scale(k.x,k.y),this._matrix.set(te);else{var ve=this.getPosition(!0);te.translate(ve),V&&te.rotate(V),te.scale(k.x/v.x,k.y/v.y),V&&te.rotate(-V),te.translate(ve.negate()),this.transform(te)}$&&($.scaling=k,this._decomposed=$)}},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},getGlobalMatrix:function(v){var k=this._globalMatrix;if(k)for(var V=this._parent,$=[];V;){if(!V._globalMatrix){k=null;for(var te=0,Ae=$.length;te<Ae;te++)$[te]._globalMatrix=null;break}$.push(V),V=V._parent}if(!k){k=this._globalMatrix=this._matrix.clone();var V=this._parent;V&&k.prepend(V.getGlobalMatrix(!0))}return v?k:k.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(v){(this._applyMatrix=this._canApplyMatrix&&!!v)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(v,k){if(this._project!==v){this._project&&this._installEvents(!1),this._project=v;for(var V=this._children,$=0,te=V&&V.length;$<te;$++)V[$]._setProject(v);k=!0}k&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function v(k){v.base.call(this,k);for(var V=this._children,$=0,te=V&&V.length;$<te;$++)V[$]._installEvents(k)},getLayer:function(){for(var v=this;v=v._parent;)if(v instanceof it)return v;return null},getParent:function(){return this._parent},setParent:function(v){return v.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(v){this.removeChildren(),this.addChildren(v)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var v=this._getOwner();return v&&v._children[this._index+1]||null},getPreviousSibling:function(){var v=this._getOwner();return v&&v._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(v){return v===this||v&&this._class===v._class&&this._style.equals(v._style)&&this._matrix.equals(v._matrix)&&this._locked===v._locked&&this._visible===v._visible&&this._blendMode===v._blendMode&&this._opacity===v._opacity&&this._clipMask===v._clipMask&&this._guide===v._guide&&this._equals(v)||!1},_equals:function(v){return b.equals(this._children,v._children)},clone:function(v){var k=new this.constructor(Ge.NO_INSERT),V=this._children,$=b.pick(v?v.insert:n,v===n||v===!0),te=b.pick(v?v.deep:n,!0);V&&k.copyAttributes(this),(!V||te)&&k.copyContent(this),V||k.copyAttributes(this),$&&k.insertAbove(this);var Ae=this._name,ve=this._parent;if(Ae&&ve){for(var V=ve._children,Ie=Ae,Ee=1;V[Ae];)Ae=Ie+" "+Ee++;Ae!==Ie&&k.setName(Ae)}return k},copyContent:function(v){for(var k=v._children,V=0,$=k&&k.length;V<$;V++)this.addChild(k[V].clone(!1),!0)},copyAttributes:function(v,k){this.setStyle(v._style);for(var V=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],$=0,te=V.length;$<te;$++){var Ae=V[$];v.hasOwnProperty(Ae)&&(this[Ae]=v[Ae])}k||this._matrix.set(v._matrix,!0),this.setApplyMatrix(v._applyMatrix),this.setPivot(v._pivot),this.setSelection(v._selection);var ve=v._data,Ie=v._name;this._data=ve?b.clone(ve):null,Ie&&this.setName(Ie)},rasterize:function(v,k){var V,$,te;b.isPlainObject(v)?(V=v.resolution,$=v.insert,te=v.raster):(V=v,$=k),te||(te=new _t(Ge.NO_INSERT));var Ae=this.getStrokeBounds(),ve=(V||this.getView().getResolution())/72,Ie=Ae.getTopLeft().floor(),Ee=Ae.getBottomRight().ceil(),ze=new lt(Ee.subtract(Ie)),Qe=ze.multiply(ve);if(te.setSize(Qe,!0),!Qe.isZero()){var He=te.getContext(!0),Ze=new kt().scale(ve).translate(Ie.negate());He.save(),Ze.applyToContext(He),this.draw(He,new b({matrices:[Ze]})),He.restore()}return te._matrix.set(new kt().translate(Ie.add(ze.divide(2))).scale(1/ve)),($===n||$)&&te.insertAbove(this),te},contains:function(){var v=this._matrix;return v.isInvertible()&&!!this._contains(v._inverseTransform(we.read(arguments)))},_contains:function(v){var k=this._children;if(k){for(var V=k.length-1;V>=0;V--)if(k[V].contains(v))return!0;return!1}return v.isInside(this.getInternalBounds())},isInside:function(){return st.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Dt.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(v,k){return v instanceof Ge?this._asPathItem().getIntersections(v._asPathItem(),null,k,!0).length>0:!1}},new function(){function v(){var $=arguments;return this._hitTest(we.read($),dt.getOptions($))}function k(){var $=arguments,te=we.read($),Ae=dt.getOptions($),ve=[];return this._hitTest(te,new b({all:ve},Ae)),ve}function V($,te,Ae,ve){var Ie=this._children;if(Ie)for(var Ee=Ie.length-1;Ee>=0;Ee--){var ze=Ie[Ee],Qe=ze!==ve&&ze._hitTest($,te,Ae);if(Qe&&!te.all)return Qe}return null}return Rt.inject({hitTest:v,hitTestAll:k,_hitTest:V}),{hitTest:v,hitTestAll:k,_hitTestChildren:V}},{_hitTest:function(v,k,V){if(this._locked||!this._visible||this._guide&&!k.guides||this.isEmpty())return null;var $=this._matrix,te=V?V.appended($):this.getGlobalMatrix().prepend(this.getView()._matrix),Ae=Math.max(k.tolerance,1e-12),ve=k._tolerancePadding=new lt(Dt._getStrokePadding(Ae,$._shiftless().invert()));if(v=$._inverseTransform(v),!v||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(ve.multiply(2))._containsPoint(v))return null;var Ie=!(k.guides&&!this._guide||k.selected&&!this.isSelected()||k.type&&k.type!==b.hyphenate(this._class)||k.class&&!(this instanceof k.class)),Ee=k.match,ze=this,Qe,He;function Ze(X){return X&&Ee&&!Ee(X)&&(X=null),X&&k.all&&k.all.push(X),X}function Ve(X,ie){var de=ie?Qe["get"+ie]():ze.getPosition();if(v.subtract(de).divide(ve).length<=1)return new dt(X,ze,{name:ie?b.hyphenate(ie):X,point:de})}var ft=k.position,rt=k.center,Me=k.bounds;if(Ie&&this._parent&&(ft||rt||Me)){if((rt||Me)&&(Qe=this.getInternalBounds()),He=ft&&Ve("position")||rt&&Ve("center","Center"),!He&&Me)for(var se=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],ne=0;ne<8&&!He;ne++)He=Ve("bounds",se[ne]);He=Ze(He)}return He||(He=this._hitTestChildren(v,k,te)||Ie&&Ze(this._hitTestSelf(v,k,te,this.getStrokeScaling()?null:te._shiftless().invert()))||null),He&&He.point&&(He.point=$.transform(He.point)),He},_hitTestSelf:function(v,k){if(k.fill&&this.hasFill()&&this._contains(v))return new dt("fill",this)},matches:function(v,k){function V(ve,Ie){for(var Ee in ve)if(ve.hasOwnProperty(Ee)){var ze=ve[Ee],Qe=Ie[Ee];if(b.isPlainObject(ze)&&b.isPlainObject(Qe)){if(!V(ze,Qe))return!1}else if(!b.equals(ze,Qe))return!1}return!0}var $=typeof v;if($==="object"){for(var te in v)if(v.hasOwnProperty(te)&&!this.matches(te,v[te]))return!1;return!0}else{if($==="function")return v(this);if(v==="match")return k(this);var Ae=/^(empty|editable)$/.test(v)?this["is"+b.capitalize(v)]():v==="type"?b.hyphenate(this._class):this[v];if(v==="class"){if(typeof k=="function")return this instanceof k;Ae=this._class}if(typeof k=="function")return!!k(Ae);if(k){if(k.test)return k.test(Ae);if(b.isPlainObject(k))return V(k,Ae)}return b.equals(Ae,k)}},getItems:function(v){return Ge._getItems(this,v,this._matrix)},getItem:function(v){return Ge._getItems(this,v,this._matrix,null,!0)[0]||null},statics:{_getItems:function v(k,V,$,te,Ae){if(!te){var ve=typeof V=="object"&&V,Ie=ve&&ve.overlapping,Ee=ve&&ve.inside,ze=Ie||Ee,Ze=ze&&st.read([ze]);te={items:[],recursive:ve&&ve.recursive!==!1,inside:!!Ee,overlapping:!!Ie,rect:Ze,path:Ie&&new Dt.Rectangle({rectangle:Ze,insert:!1})},ve&&(V=b.filter({},V,{recursive:!0,inside:!0,overlapping:!0}))}var Qe=k._children,He=te.items,Ze=te.rect;$=Ze&&($||new kt);for(var Ve=0,ft=Qe&&Qe.length;Ve<ft;Ve++){var rt=Qe[Ve],Me=$&&$.appended(rt._matrix),se=!0;if(Ze){var ze=rt.getBounds(Me);if(!Ze.intersects(ze))continue;Ze.contains(ze)||te.overlapping&&(ze.contains(Ze)||te.path.intersects(rt,Me))||(se=!1)}if(se&&rt.matches(V)&&(He.push(rt),Ae)||(te.recursive!==!1&&v(rt,V,Me,te,Ae),Ae&&He.length>0))break}return He}}},{importJSON:function(v){var k=b.importJSON(v,this);return k!==this?this.addChild(k):k},addChild:function(v){return this.insertChild(n,v)},insertChild:function(v,k){var V=k?this.insertChildren(v,[k]):null;return V&&V[0]},addChildren:function(v){return this.insertChildren(this._children.length,v)},insertChildren:function(v,k){var V=this._children;if(V&&k&&k.length>0){k=b.slice(k);for(var $={},te=k.length-1;te>=0;te--){var Ae=k[te],ve=Ae&&Ae._id;!Ae||$[ve]?k.splice(te,1):(Ae._remove(!1,!0),$[ve]=!0)}b.splice(V,k,v,0);for(var Ie=this._project,Ee=Ie._changes,te=0,ze=k.length;te<ze;te++){var Ae=k[te],Qe=Ae._name;Ae._parent=this,Ae._setProject(Ie,!0),Qe&&Ae.setName(Qe),Ee&&Ae._changed(5)}this._changed(11)}else k=null;return k},_insertItem:"#insertChild",_insertAt:function(v,k){var V=v&&v._getOwner(),$=v!==this&&V?this:null;return $&&($._remove(!1,!0),V._insertItem(v._index+k,$)),$},insertAbove:function(v){return this._insertAt(v,1)},insertBelow:function(v){return this._insertAt(v,0)},sendToBack:function(){var v=this._getOwner();return v?v._insertItem(0,this):null},bringToFront:function(){var v=this._getOwner();return v?v._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(v){return this.insertChild(0,v)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(v){return v._insertItem(n,this)},copyTo:function(v){return this.clone(!1).addTo(v)},reduce:function(v){var k=this._children;if(k&&k.length===1){var V=k[0].reduce(v);return this._parent?(V.insertAbove(this),this.remove()):V.remove(),V}return this},_removeNamed:function(){var v=this._getOwner();if(v){var k=v._children,V=v._namedChildren,$=this._name,te=V[$],Ae=te?te.indexOf(this):-1;Ae!==-1&&(k[$]==this&&delete k[$],te.splice(Ae,1),te.length?k[$]=te[0]:delete V[$])}},_remove:function(v,k){var V=this._getOwner(),$=this._project,te=this._index;return this._style&&this._style._dispose(),V?(this._name&&this._removeNamed(),te!=null&&($._activeLayer===this&&($._activeLayer=this.getNextSibling()||this.getPreviousSibling()),b.splice(V._children,null,te,1)),this._installEvents(!1),v&&$._changes&&this._changed(5),k&&V._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(v){var k=v&&v.insertBelow(this);return k&&this.remove(),k},removeChildren:function(v,k){if(!this._children)return null;v=v||0,k=b.pick(k,this._children.length);for(var V=b.splice(this._children,null,v,k-v),$=V.length-1;$>=0;$--)V[$]._remove(!0,!1);return V.length>0&&this._changed(11),V},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var v=0,k=this._children.length;v<k;v++)this._children[v]._index=v;this._changed(11)}},isEmpty:function(v){var k=this._children,V=k?k.length:0;if(v){for(var $=0;$<V;$++)if(!k[$].isEmpty(v))return!1;return!0}return!V},isEditable:function(){for(var v=this;v;){if(!v._visible||v._locked)return!1;v=v._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(v){function k(ve){var Ie=[];do Ie.unshift(ve);while(ve=ve._parent);return Ie}for(var V=k(this),$=k(v),te=0,Ae=Math.min(V.length,$.length);te<Ae;te++)if(V[te]!=$[te])return V[te]._index<$[te]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(v){return this._getOrder(v)===-1},isBelow:function(v){return this._getOrder(v)===1},isParent:function(v){return this._parent===v},isChild:function(v){return v&&v._parent===this},isDescendant:function(v){for(var k=this;k=k._parent;)if(k===v)return!0;return!1},isAncestor:function(v){return v?v.isDescendant(this):!1},isSibling:function(v){return this._parent===v._parent},isGroupedWith:function(v){for(var k=this._parent;k;){if(k._parent&&/^(Group|Layer|CompoundPath)$/.test(k._class)&&v.isDescendant(k))return!0;k=k._parent}return!1}},b.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,$=(k?b:we).read(V),te=we.read(V,0,{readNull:!0});return this.transform(new kt()[v]($,te||this.getPosition(!0)))}},{translate:function(){var v=new kt;return this.transform(v.translate.apply(v,arguments))},transform:function(v,k,V){var $=this._matrix,te=v&&!v.isIdentity(),Ae=V&&this._canApplyMatrix||this._applyMatrix&&(te||!$.isIdentity()||k&&this._children);if(!te&&!Ae)return this;if(te){!v.isInvertible()&&$.isInvertible()&&($._backup=$.getValues()),$.prepend(v,!0);var ve=this._style,Ie=ve.getFillColor(!0),Ee=ve.getStrokeColor(!0);Ie&&Ie.transform(v),Ee&&Ee.transform(v)}if(Ae&&(Ae=this._transformContent($,k,V))){var ze=this._pivot;ze&&$._transformPoint(ze,ze,!0),$.reset(!0),V&&this._canApplyMatrix&&(this._applyMatrix=!0)}var Qe=this._bounds,He=this._position;(te||Ae)&&this._changed(25);var Ze=te&&Qe&&v.decompose();if(Ze&&Ze.skewing.isZero()&&Ze.rotation%90===0){for(var Ve in Qe){var ft=Qe[Ve];if(ft.nonscaling)delete Qe[Ve];else if(Ae||!ft.internal){var rt=ft.rect;v._transformBounds(rt,rt)}}this._bounds=Qe;var Me=Qe[this._getBoundsCacheKey(this._boundsOptions||{})];Me&&(this._position=this._getPositionFromBounds(Me.rect))}else te&&He&&this._pivot&&(this._position=v._transformPoint(He,He));return this},_transformContent:function(v,k,V){var $=this._children;if($){for(var te=0,Ae=$.length;te<Ae;te++)$[te].transform(v,k,V);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(we.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(we.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(we.read(arguments))},localToParent:function(){return this._matrix._transformPoint(we.read(arguments))},fitBounds:function(v,k){v=st.read(arguments);var V=this.getBounds(),$=V.height/V.width,te=v.height/v.width,Ae=(k?$>te:$<te)?v.width/V.width:v.height/V.height,ve=new st(new we,new lt(V.width*Ae,V.height*Ae));ve.setCenter(v.getCenter()),this.setBounds(ve)}}),{_setStyles:function(v,k,V){var $=this._style,te=this._matrix;if($.hasFill()&&(v.fillStyle=$.getFillColor().toCanvasStyle(v,te)),$.hasStroke()){v.strokeStyle=$.getStrokeColor().toCanvasStyle(v,te),v.lineWidth=$.getStrokeWidth();var Ae=$.getStrokeJoin(),ve=$.getStrokeCap(),Ie=$.getMiterLimit();if(Ae&&(v.lineJoin=Ae),ve&&(v.lineCap=ve),Ie&&(v.miterLimit=Ie),wn.support.nativeDash){var Ee=$.getDashArray(),ze=$.getDashOffset();Ee&&Ee.length&&("setLineDash"in v?(v.setLineDash(Ee),v.lineDashOffset=ze):(v.mozDash=Ee,v.mozDashOffset=ze))}}if($.hasShadow()){var Qe=k.pixelRatio||1,He=V._shiftless().prepend(new kt().scale(Qe,Qe)),Ze=He.transform(new we($.getShadowBlur(),0)),Ve=He.transform(this.getShadowOffset());v.shadowColor=$.getShadowColor().toCanvasStyle(v),v.shadowBlur=Ze.getLength(),v.shadowOffsetX=Ve.x,v.shadowOffsetY=Ve.y}},draw:function(v,k,V){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var $=k.matrices,te=k.viewMatrix,Ae=this._matrix,ve=$[$.length-1].appended(Ae);if(ve.isInvertible()){te=te?te.appended(ve):ve,$.push(ve),k.updateMatrix&&(this._globalMatrix=ve);var Ie=this._blendMode,Ee=oe.clamp(this._opacity,0,1),ze=Ie==="normal",Qe=pr.nativeModes[Ie],He=ze&&Ee===1||k.dontStart||k.clip||(Qe||ze&&Ee<1)&&this._canComposite(),Ze=k.pixelRatio||1,Ve,ft,rt;if(!He){var Me=this.getStrokeBounds(te);if(!Me.width||!Me.height){$.pop();return}rt=k.offset,ft=k.offset=Me.getTopLeft().floor(),Ve=v,v=ln.getContext(Me.getSize().ceil().add(1).multiply(Ze)),Ze!==1&&v.scale(Ze,Ze)}v.save();var se=V?V.appended(Ae):this._canScaleStroke&&!this.getStrokeScaling(!0)&&te,ne=!He&&k.clipItem,X=!se||ne;if(He?(v.globalAlpha=Ee,Qe&&(v.globalCompositeOperation=Ie)):X&&v.translate(-ft.x,-ft.y),X&&(He?Ae:te).applyToContext(v),ne&&k.clipItem.draw(v,k.extend({clip:!0})),se){v.setTransform(Ze,0,0,Ze,0,0);var ie=k.offset;ie&&v.translate(-ie.x,-ie.y)}this._draw(v,k,te,se),v.restore(),$.pop(),k.clip&&!k.dontFinish&&v.clip(this.getFillRule()),He||(pr.process(Ie,v,Ve,Ee,ft.subtract(rt).multiply(Ze)),ln.release(v),k.offset=rt)}}},_isUpdated:function(v){var k=this._parent;if(k instanceof ci)return k._isUpdated(v);var V=this._updateVersion===v;return!V&&k&&k._visible&&k._isUpdated(v)&&(this._updateVersion=v,V=!0),V},_drawSelection:function(v,k,V,$,te){var Ae=this._selection,ve=Ae&1,Ie=Ae&2||ve&&this._selectBounds,Ee=Ae&4;if(this._drawSelected||(ve=!1),(ve||Ie||Ee)&&this._isUpdated(te)){var ze,Qe=this.getSelectedColor(!0)||(ze=this.getLayer())&&ze.getSelectedColor(!0),He=k.appended(this.getGlobalMatrix(!0)),Ze=V/2;if(v.strokeStyle=v.fillStyle=Qe?Qe.toCanvasStyle(v):"#009dec",ve&&this._drawSelected(v,He,$),Ee){var Ve=this.getPosition(!0),ft=this._parent,rt=ft?ft.localToGlobal(Ve):Ve,Me=rt.x,se=rt.y;v.beginPath(),v.arc(Me,se,Ze,0,Math.PI*2,!0),v.stroke();for(var ne=[[0,-1],[1,0],[0,1],[-1,0]],X=Ze,ie=V+1,de=0;de<4;de++){var ye=ne[de],ge=ye[0],Pe=ye[1];v.moveTo(Me+ge*X,se+Pe*X),v.lineTo(Me+ge*ie,se+Pe*ie),v.stroke()}}if(Ie){var Fe=He._transformCorners(this.getInternalBounds());v.beginPath();for(var de=0;de<8;de++)v[de?"lineTo":"moveTo"](Fe[de],Fe[++de]);v.closePath(),v.stroke();for(var de=0;de<8;de++)v.fillRect(Fe[de]-Ze,Fe[++de]-Ze,V,V)}}},_canComposite:function(){return!1}},b.each(["down","drag","up","move"],function(v){this["removeOn"+b.capitalize(v)]=function(){var k={};return k[v]=!0,this.removeOn(k)}},{removeOn:function(v){for(var k in v)if(v[k]){var V="mouse"+k,$=this._project,te=$._removeSets=$._removeSets||{};te[V]=te[V]||{},te[V][this._id]=this}return this}}),{tween:function(v,k,V){V||(V=k,k=v,v=null,V||(V=k,k=null));var $=V&&V.easing,te=V&&V.start,Ae=V!=null&&(typeof V=="number"?V:V.duration),ve=new ns(this,v,k,Ae,$,te);function Ie(Ee){ve._handleFrame(Ee.time*1e3),ve.running||this.off("frame",Ie)}return Ae&&this.on("frame",Ie),ve},tweenTo:function(v,k){return this.tween(null,v,k)},tweenFrom:function(v,k){return this.tween(v,null,k)}}),ni=Ge.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||this.addChildren(Array.isArray(k)?k:arguments)},_changed:function v(k){v.base.call(this,k),k&2050&&(this._clipItem=n)},_getClipItem:function(){var v=this._clipItem;if(v===n){v=null;for(var k=this._children,V=0,$=k.length;V<$;V++)if(k[V]._clipMask){v=k[V];break}this._clipItem=v}return v},isClipped:function(){return!!this._getClipItem()},setClipped:function(v){var k=this.getFirstChild();k&&k.setClipMask(v)},_getBounds:function v(k,V){var $=this._getClipItem();return $?$._getCachedBounds($._matrix.prepended(k),b.set({},V,{stroke:!1})):v.base.call(this,k,V)},_hitTestChildren:function v(k,V,$){var te=this._getClipItem();return(!te||te.contains(k))&&v.base.call(this,k,V,$,te)},_draw:function(v,k){var V=k.clip,$=!V&&this._getClipItem();k=k.extend({clipItem:$,clip:!1}),V?(v.beginPath(),k.dontStart=k.dontFinish=!0):$&&$.draw(v,k.extend({clip:!0}));for(var te=this._children,Ae=0,ve=te.length;Ae<ve;Ae++){var Ie=te[Ae];Ie!==$&&Ie.draw(v,k)}}}),it=ni.extend({_class:"Layer",initialize:function(){ni.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function v(){return this._parent?v.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),xt=Ge.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(k,V){this._initialize(k,V)},_equals:function(v){return this._type===v._type&&this._size.equals(v._size)&&b.equals(this._radius,v._radius)},copyContent:function(v){this.setType(v._type),this.setSize(v._size),this.setRadius(v._radius)},getType:function(){return this._type},setType:function(v){this._type=v},getShape:"#getType",setShape:"#setType",getSize:function(){var v=this._size;return new Ke(v.width,v.height,this,"setSize")},setSize:function(){var v=lt.read(arguments);if(!this._size)this._size=v.clone();else if(!this._size.equals(v)){var k=this._type,V=v.width,$=v.height;k==="rectangle"?this._radius.set(lt.min(this._radius,v.divide(2).abs())):k==="circle"?(V=$=(V+$)/2,this._radius=V/2):k==="ellipse"&&this._radius._set(V/2,$/2),this._size._set(V,$),this._changed(9)}},getRadius:function(){var v=this._radius;return this._type==="circle"?v:new Ke(v.width,v.height,this,"setRadius")},setRadius:function(v){var k=this._type;if(k==="circle"){if(v===this._radius)return;var V=v*2;this._radius=v,this._size._set(V,V)}else if(v=lt.read(arguments),!this._radius)this._radius=v.clone();else{if(this._radius.equals(v))return;if(this._radius.set(v),k==="rectangle"){var V=lt.max(this._size,v.multiply(2));this._size.set(V)}else k==="ellipse"&&this._size._set(v.width*2,v.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(v){var k=new Dt[b.capitalize(this._type)]({center:new we,size:this._size,radius:this._radius,insert:!1});return k.copyAttributes(this),wn.settings.applyMatrix&&k.setApplyMatrix(!0),(v===n||v)&&k.insertAbove(this),k},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(v,k,V,$){var te=this._style,Ae=te.hasFill(),ve=te.hasStroke(),Ie=k.dontFinish||k.clip,Ee=!$;if(Ae||ve||Ie){var ze=this._type,Qe=this._radius,He=ze==="circle";if(k.dontStart||v.beginPath(),Ee&&He)v.arc(0,0,Qe,0,Math.PI*2,!0);else{var Ze=He?Qe:Qe.width,Ve=He?Qe:Qe.height,ft=this._size,rt=ft.width,Me=ft.height;if(Ee&&ze==="rectangle"&&Ze===0&&Ve===0)v.rect(-rt/2,-Me/2,rt,Me);else{var se=rt/2,ne=Me/2,X=1-.5522847498307936,ie=Ze*X,de=Ve*X,ye=[-se,-ne+Ve,-se,-ne+de,-se+ie,-ne,-se+Ze,-ne,se-Ze,-ne,se-ie,-ne,se,-ne+de,se,-ne+Ve,se,ne-Ve,se,ne-de,se-ie,ne,se-Ze,ne,-se+Ze,ne,-se+ie,ne,-se,ne-de,-se,ne-Ve];$&&$.transform(ye,ye,32),v.moveTo(ye[0],ye[1]),v.bezierCurveTo(ye[2],ye[3],ye[4],ye[5],ye[6],ye[7]),se!==Ze&&v.lineTo(ye[8],ye[9]),v.bezierCurveTo(ye[10],ye[11],ye[12],ye[13],ye[14],ye[15]),ne!==Ve&&v.lineTo(ye[16],ye[17]),v.bezierCurveTo(ye[18],ye[19],ye[20],ye[21],ye[22],ye[23]),se!==Ze&&v.lineTo(ye[24],ye[25]),v.bezierCurveTo(ye[26],ye[27],ye[28],ye[29],ye[30],ye[31])}}v.closePath()}!Ie&&(Ae||ve)&&(this._setStyles(v,k,V),Ae&&(v.fill(te.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),ve&&v.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(v,k){var V=new st(this._size).setCenter(0,0),$=this._style,te=k.stroke&&$.hasStroke()&&$.getStrokeWidth();return v&&(V=v._transformBounds(V)),te?V.expand(Dt._getStrokePadding(te,this._getStrokeMatrix(v,k))):V}},new function(){function v(V,$,te){var Ae=V._radius;if(!Ae.isZero())for(var ve=V._size.divide(2),Ie=1;Ie<=4;Ie++){var Ee=new we(Ie>1&&Ie<4?-1:1,Ie>2?-1:1),ze=Ee.multiply(ve),Qe=ze.subtract(Ee.multiply(Ae)),He=new st(te?ze.add(Ee.multiply(te)):ze,Qe);if(He.contains($))return{point:Qe,quadrant:Ie}}}function k(V,$,te,Ae){var ve=V.divide($);return(!Ae||ve.isInQuadrant(Ae))&&ve.subtract(ve.normalize()).multiply($).divide(te).length<=1}return{_contains:function V($){if(this._type==="rectangle"){var te=v(this,$);return te?$.subtract(te.point).divide(this._radius).getLength()<=1:V.base.call(this,$)}else return $.divide(this.size).getLength()<=.5},_hitTestSelf:function V($,te,Ae,ve){var Ie=!1,Ee=this._style,ze=te.stroke&&Ee.hasStroke(),Qe=te.fill&&Ee.hasFill();if(ze||Qe){var He=this._type,Ze=this._radius,Ve=ze?Ee.getStrokeWidth()/2:0,ft=te._tolerancePadding.add(Dt._getStrokePadding(Ve,!Ee.getStrokeScaling()&&ve));if(He==="rectangle"){var rt=ft.multiply(2),Me=v(this,$,rt);if(Me)Ie=k($.subtract(Me.point),Ze,ft,Me.quadrant);else{var se=new st(this._size).setCenter(0,0),ne=se.expand(rt),X=se.expand(rt.negate());Ie=ne._containsPoint($)&&!X._containsPoint($)}}else Ie=k($,Ze,ft)}return Ie?new dt(ze?"stroke":"fill",this):V.base.apply(this,arguments)}}},{statics:new function(){function v(k,V,$,te,Ae){var ve=b.create(xt.prototype);return ve._type=k,ve._size=$,ve._radius=te,ve._initialize(b.getNamed(Ae),V),ve}return{Circle:function(){var k=arguments,V=we.readNamed(k,"center"),$=b.readNamed(k,"radius");return v("circle",V,new lt($*2),$,k)},Rectangle:function(){var k=arguments,V=st.readNamed(k,"rectangle"),$=lt.min(lt.readNamed(k,"radius"),V.getSize(!0).divide(2));return v("rectangle",V.getCenter(!0),V.getSize(!0),$,k)},Ellipse:function(){var k=arguments,V=xt._readEllipse(k),$=V.radius;return v("ellipse",V.center,$.multiply(2),$,k)},_readEllipse:function(k){var V,$;if(b.hasNamed(k,"radius"))V=we.readNamed(k,"center"),$=lt.readNamed(k,"radius");else{var te=st.readNamed(k,"rectangle");V=te.getCenter(!0),$=te.getSize(!0).divide(2)}return{center:V,radius:$}}}}}),_t=Ge.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(k,V){if(!this._initialize(k,V!==n&&we.read(arguments))){var $,te=typeof k,Ae=te==="string"?g.getElementById(k):te==="object"?k:null;if(Ae&&Ae!==Ge.NO_INSERT){if(Ae.getContext||Ae.naturalHeight!=null)$=Ae;else if(Ae){var ve=lt.read(arguments);ve.isZero()||($=ln.getCanvas(ve))}}$?this.setImage($):this.setSource(k)}this._size||(this._size=new lt,this._loaded=!1)},_equals:function(v){return this.getSource()===v.getSource()},copyContent:function(v){var k=v._image,V=v._canvas;if(k)this._setImage(k);else if(V){var $=ln.getCanvas(v._size);$.getContext("2d").drawImage(V,0,0),this._setImage($)}this._crossOrigin=v._crossOrigin},getSize:function(){var v=this._size;return new Ke(v?v.width:0,v?v.height:0,this,"setSize")},setSize:function(v,k){var V=lt.read(arguments);if(V.equals(this._size))k&&this.clear();else if(V.width>0&&V.height>0){var $=!k&&this.getElement();this._setImage(ln.getCanvas(V)),$&&this.getContext(!0).drawImage($,0,0,V.width,V.height)}else this._canvas&&ln.release(this._canvas),this._size=V.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(v){this.setSize(v,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(v){this.setSize(this.getWidth(),v)},getLoaded:function(){return this._loaded},isEmpty:function(){var v=this._size;return!v||v.width===0&&v.height===0},getResolution:function(){var v=this._matrix,k=new we(0,0).transform(v),V=new we(1,0).transform(v).subtract(k),$=new we(0,1).transform(v).subtract(k);return new lt(72/V.getLength(),72/$.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(v){var k=this;function V($){var te=k.getView(),Ae=$&&$.type||"load";te&&k.responds(Ae)&&(wn=te._scope,k.emit(Ae,new fn($)))}this._setImage(v),this._loaded?setTimeout(V,0):v&&hi.add(v,{load:function($){k._setImage(v),V($)},error:V})},_setImage:function(v){this._canvas&&ln.release(this._canvas),v&&v.getContext?(this._image=null,this._canvas=v,this._loaded=!0):(this._image=v,this._canvas=null,this._loaded=!!(v&&v.src&&v.complete)),this._size=new lt(v?v.naturalWidth||v.width:0,v?v.naturalHeight||v.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var v=ln.getContext(this._size);try{this._image&&v.drawImage(this._image,0,0),this._canvas=v.canvas}catch{ln.release(v)}}return this._canvas},setCanvas:"#setImage",getContext:function(v){return this._context||(this._context=this.getCanvas().getContext("2d")),v&&(this._image=null,this._changed(1025)),this._context},setContext:function(v){this._context=v},getSource:function(){var v=this._image;return v&&v.src||this.toDataURL()},setSource:function(v){var k=new t.Image,V=this._crossOrigin;V&&(k.crossOrigin=V),v&&(k.src=v),this.setImage(k)},getCrossOrigin:function(){var v=this._image;return v&&v.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(v){this._crossOrigin=v;var k=this._image;k&&(k.crossOrigin=v)},getSmoothing:function(){return this._smoothing},setSmoothing:function(v){this._smoothing=typeof v=="string"?v:v?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var v=st.read(arguments),k=ln.getContext(v.getSize());return k.drawImage(this.getCanvas(),v.x,v.y,v.width,v.height,0,0,v.width,v.height),k.canvas},getSubRaster:function(){var v=st.read(arguments),k=new _t(Ge.NO_INSERT);return k._setImage(this.getSubCanvas(v)),k.translate(v.getCenter().subtract(this.getSize().divide(2))),k._matrix.prepend(this._matrix),k.insertAbove(this),k},toDataURL:function(){var v=this._image,k=v&&v.src;if(/^data:/.test(k))return k;var V=this.getCanvas();return V?V.toDataURL.apply(V,arguments):null},drawImage:function(v){var k=we.read(arguments,1);this.getContext(!0).drawImage(v,k.x,k.y)},getAverageColor:function(v){var k,V;if(v?v instanceof Ft?(V=v,k=v.getBounds()):typeof v=="object"&&("width"in v?k=new st(v):"x"in v&&(k=new st(v.x-.5,v.y-.5,1,1))):k=this.getBounds(),!k)return null;var $=32,te=Math.min(k.width,$),Ae=Math.min(k.height,$),ve=_t._sampleContext;ve?ve.clearRect(0,0,$+1,$+1):ve=_t._sampleContext=ln.getContext(new lt($)),ve.save();var Ie=new kt().scale(te/k.width,Ae/k.height).translate(-k.x,-k.y);Ie.applyToContext(ve),V&&V.draw(ve,new b({clip:!0,matrices:[Ie]})),this._matrix.applyToContext(ve);var Ee=this.getElement(),ze=this._size;Ee&&ve.drawImage(Ee,-ze.width/2,-ze.height/2),ve.restore();for(var Qe=ve.getImageData(.5,.5,Math.ceil(te),Math.ceil(Ae)).data,He=[0,0,0],Ze=0,Ve=0,ft=Qe.length;Ve<ft;Ve+=4){var rt=Qe[Ve+3];Ze+=rt,rt/=255,He[0]+=Qe[Ve]*rt,He[1]+=Qe[Ve+1]*rt,He[2]+=Qe[Ve+2]*rt}for(var Ve=0;Ve<3;Ve++)He[Ve]/=Ze;return Ze?$i.read(He):null},getPixel:function(){var v=we.read(arguments),k=this.getContext().getImageData(v.x,v.y,1,1).data;return new $i("rgb",[k[0]/255,k[1]/255,k[2]/255],k[3]/255)},setPixel:function(){var v=arguments,k=we.read(v),V=$i.read(v),$=V._convert("rgb"),te=V._alpha,Ae=this.getContext(!0),ve=Ae.createImageData(1,1),Ie=ve.data;Ie[0]=$[0]*255,Ie[1]=$[1]*255,Ie[2]=$[2]*255,Ie[3]=te!=null?te*255:255,Ae.putImageData(ve,k.x,k.y)},clear:function(){var v=this._size;this.getContext(!0).clearRect(0,0,v.width+1,v.height+1)},createImageData:function(){var v=lt.read(arguments);return this.getContext().createImageData(v.width,v.height)},getImageData:function(){var v=st.read(arguments);return v.isEmpty()&&(v=new st(this._size)),this.getContext().getImageData(v.x,v.y,v.width,v.height)},putImageData:function(v){var k=we.read(arguments,1);this.getContext(!0).putImageData(v,k.x,k.y)},setImageData:function(v){this.setSize(v),this.getContext(!0).putImageData(v,0,0)},_getBounds:function(v,k){var V=new st(this._size).setCenter(0,0);return v?v._transformBounds(V):V},_hitTestSelf:function(v){if(this._contains(v)){var k=this;return new dt("pixel",k,{offset:v.add(k._size.divide(2)).round(),color:{get:function(){return k.getPixel(this.offset)}}})}},_draw:function(v,k,V){var $=this.getElement();if($&&$.width>0&&$.height>0){v.globalAlpha=oe.clamp(this._opacity,0,1),this._setStyles(v,k,V);var te=this._smoothing,Ae=te==="off";yi.setPrefixed(v,Ae?"imageSmoothingEnabled":"imageSmoothingQuality",Ae?!1:te),v.drawImage($,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),mt=Ge.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(k,V){this._initialize(k,V!==n&&we.read(arguments,1))||this.setDefinition(k instanceof bt?k:new bt(k))},_equals:function(v){return this._definition===v._definition},copyContent:function(v){this.setDefinition(v._definition)},getDefinition:function(){return this._definition},setDefinition:function(v){this._definition=v,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(v,k){var V=this._definition._item;return V._getCachedBounds(V._matrix.prepended(v),k)},_hitTestSelf:function(v,k,V){var $=k.extend({all:!1}),te=this._definition._item._hitTest(v,$,V);return te&&(te.item=this),te},_draw:function(v,k){this._definition._item.draw(v,k)}}),bt=b.extend({_class:"SymbolDefinition",initialize:function(k,V){this._id=fe.get(),this.project=wn.project,k&&this.setItem(k,V)},_serialize:function(v,k){return k.add(this,function(){return b.serialize([this._class,this._item],v,!1,k)})},_changed:function(v){v&8&&Ge._clearBoundsCache(this),v&1&&this.project._changed(v)},getItem:function(){return this._item},setItem:function(v,k){v._symbol&&(v=v.clone()),this._item&&(this._item._symbol=null),this._item=v,v.remove(),v.setSelected(!1),k||v.setPosition(new we),v._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(v){return new mt(this,v)},clone:function(){return new bt(this._item.clone(!1))},equals:function(v){return v===this||v&&this._item.equals(v._item)||!1}}),dt=b.extend({_class:"HitResult",initialize:function(k,V,$){this.type=k,this.item=V,$&&this.inject($)},statics:{getOptions:function(v){var k=v&&b.read(v);return new b({type:null,tolerance:wn.settings.hitTolerance,fill:!k,stroke:!k,segments:!k,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},k)}}}),nt=b.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(k,V,$,te,Ae,ve){var Ie=arguments.length,Ee,ze,Qe,He;Ie>0&&(k==null||typeof k=="object"?Ie===1&&k&&"point"in k?(Ee=k.point,ze=k.handleIn,Qe=k.handleOut,He=k.selection):(Ee=k,ze=V,Qe=$,He=te):(Ee=[k,V],ze=$!==n?[$,te]:null,Qe=Ae!==n?[Ae,ve]:null)),new pt(Ee,this,"_point"),new pt(ze,this,"_handleIn"),new pt(Qe,this,"_handleOut"),He&&this.setSelection(He)},_serialize:function(v,k){var V=this._point,$=this._selection,te=$||this.hasHandles()?[V,this._handleIn,this._handleOut]:V;return $&&te.push($),b.serialize(te,v,!0,k)},_changed:function(v){var k=this._path;if(k){var V=k._curves,$=this._index,te;V&&((!v||v===this._point||v===this._handleIn)&&(te=$>0?V[$-1]:k._closed?V[V.length-1]:null)&&te._changed(),(!v||v===this._point||v===this._handleOut)&&(te=V[$])&&te._changed()),k._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(we.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(we.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(we.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var v=this._handleIn,k=this._handleOut;return!v.isZero()&&!k.isZero()&&v.isCollinear(k)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(v){var k=this._selection,V=this._path;this._selection=v=v||0,V&&v!==k&&(V._updateSelection(this,k,v),V._changed(257))},_changeSelection:function(v,k){var V=this._selection;this.setSelection(k?V|v:V&~v)},isSelected:function(){return!!(this._selection&7)},setSelected:function(v){this._changeSelection(7,v)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var v=this._path,k=this._index;return v?(k>0&&!v._closed&&k===v._segments.length-1&&k--,v.getCurves()[k]||null):null},getLocation:function(){var v=this.getCurve();return v?new Nt(v,this===v._segment1?0:1):null},getNext:function(){var v=this._path&&this._path._segments;return v&&(v[this._index+1]||this._path._closed&&v[0])||null},smooth:function(v,k,V){var $=v||{},te=$.type,Ae=$.factor,ve=this.getPrevious(),Ie=this.getNext(),Ee=(ve||this)._point,ze=this._point,Qe=(Ie||this)._point,He=Ee.getDistance(ze),Ze=ze.getDistance(Qe);if(!te||te==="catmull-rom"){var Ve=Ae===n?.5:Ae,ft=Math.pow(He,Ve),rt=ft*ft,Me=Math.pow(Ze,Ve),se=Me*Me;if(!k&&ve){var ne=2*se+3*Me*ft+rt,X=3*Me*(Me+ft);this.setHandleIn(X!==0?new we((se*Ee._x+ne*ze._x-rt*Qe._x)/X-ze._x,(se*Ee._y+ne*ze._y-rt*Qe._y)/X-ze._y):new we)}if(!V&&Ie){var ne=2*rt+3*ft*Me+se,X=3*ft*(ft+Me);this.setHandleOut(X!==0?new we((rt*Qe._x+ne*ze._x-se*Ee._x)/X-ze._x,(rt*Qe._y+ne*ze._y-se*Ee._y)/X-ze._y):new we)}}else if(te==="geometric"){if(ve&&Ie){var ie=Ee.subtract(Qe),de=Ae===n?.4:Ae,ye=de*He/(He+Ze);k||this.setHandleIn(ie.multiply(ye)),V||this.setHandleOut(ie.multiply(ye-de))}}else throw new Error("Smoothing method '"+te+"' not supported.")},getPrevious:function(){var v=this._path&&this._path._segments;return v&&(v[this._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var v=this._path;return v&&this._index===v._segments.length-1||!1},reverse:function(){var v=this._handleIn,k=this._handleOut,V=v.clone();v.set(k),k.set(V)},reversed:function(){return new nt(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new nt(this._point,this._handleIn,this._handleOut)},equals:function(v){return v===this||v&&this._class===v._class&&this._point.equals(v._point)&&this._handleIn.equals(v._handleIn)&&this._handleOut.equals(v._handleOut)||!1},toString:function(){var v=["point: "+this._point];return this._handleIn.isZero()||v.push("handleIn: "+this._handleIn),this._handleOut.isZero()||v.push("handleOut: "+this._handleOut),"{ "+v.join(", ")+" }"},transform:function(v){this._transformCoordinates(v,new Array(6),!0),this._changed()},interpolate:function(v,k,V){var $=1-V,te=V,Ae=v._point,ve=k._point,Ie=v._handleIn,Ee=k._handleIn,ze=k._handleOut,Qe=v._handleOut;this._point._set($*Ae._x+te*ve._x,$*Ae._y+te*ve._y,!0),this._handleIn._set($*Ie._x+te*Ee._x,$*Ie._y+te*Ee._y,!0),this._handleOut._set($*Qe._x+te*ze._x,$*Qe._y+te*ze._y,!0),this._changed()},_transformCoordinates:function(v,k,V){var $=this._point,te=!V||!this._handleIn.isZero()?this._handleIn:null,Ae=!V||!this._handleOut.isZero()?this._handleOut:null,ve=$._x,Ie=$._y,Ee=2;return k[0]=ve,k[1]=Ie,te&&(k[Ee++]=te._x+ve,k[Ee++]=te._y+Ie),Ae&&(k[Ee++]=Ae._x+ve,k[Ee++]=Ae._y+Ie),v&&(v._transformCoordinates(k,k,Ee/2),ve=k[0],Ie=k[1],V?($._x=ve,$._y=Ie,Ee=2,te&&(te._x=k[Ee++]-ve,te._y=k[Ee++]-Ie),Ae&&(Ae._x=k[Ee++]-ve,Ae._y=k[Ee++]-Ie)):(te||(k[Ee++]=ve,k[Ee++]=Ie),Ae||(k[Ee++]=ve,k[Ee++]=Ie))),k}}),pt=we.extend({initialize:function(k,V,$){var te,Ae,ve;if(!k)te=Ae=0;else if((te=k[0])!==n)Ae=k[1];else{var Ie=k;(te=Ie.x)===n&&(Ie=we.read(arguments),te=Ie.x),Ae=Ie.y,ve=Ie.selected}this._x=te,this._y=Ae,this._owner=V,V[$]=this,ve&&this.setSelected(!0)},_set:function(v,k){return this._x=v,this._y=k,this._owner._changed(this),this},getX:function(){return this._x},setX:function(v){this._x=v,this._owner._changed(this)},getY:function(){return this._y},setY:function(v){this._y=v,this._owner._changed(this)},isZero:function(){var v=oe.isZero;return v(this._x)&&v(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(v){this._owner._changeSelection(this._getSelection(),v)},_getSelection:function(){var v=this._owner;return this===v._point?1:this===v._handleIn?2:this===v._handleOut?4:0}}),at=b.extend({_class:"Curve",beans:!0,initialize:function(k,V,$,te,Ae,ve,Ie,Ee){var ze=arguments.length,Qe,He,Ze,Ve,ft,rt;ze===3?(this._path=k,Qe=V,He=$):ze?ze===1?"segment1"in k?(Qe=new nt(k.segment1),He=new nt(k.segment2)):"point1"in k?(Ze=k.point1,ft=k.handle1,rt=k.handle2,Ve=k.point2):Array.isArray(k)&&(Ze=[k[0],k[1]],Ve=[k[6],k[7]],ft=[k[2]-k[0],k[3]-k[1]],rt=[k[4]-k[6],k[5]-k[7]]):ze===2?(Qe=new nt(k),He=new nt(V)):ze===4?(Ze=k,ft=V,rt=$,Ve=te):ze===8&&(Ze=[k,V],Ve=[Ie,Ee],ft=[$-k,te-V],rt=[Ae-Ie,ve-Ee]):(Qe=new nt,He=new nt),this._segment1=Qe||new nt(Ze,null,ft),this._segment2=He||new nt(Ve,rt,null)},_serialize:function(v,k){return b.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],v,!0,k)},_changed:function(){this._length=this._bounds=n},clone:function(){return new at(this._segment1,this._segment2)},toString:function(){var v=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||v.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||v.push("handle2: "+this._segment2._handleIn),v.push("point2: "+this._segment2._point),"{ "+v.join(", ")+" }"},classify:function(){return at.classify(this.getValues())},remove:function(){var v=!1;if(this._path){var k=this._segment2,V=k._handleOut;v=k.remove(),v&&this._segment1._handleOut.set(V)}return v},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(we.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(we.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(we.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(we.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index+1]||this._path._closed&&v[0])||null},getPrevious:function(){var v=this._path&&this._path._curves;return v&&(v[this._segment1._index-1]||this._path._closed&&v[v.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var v=this._path;return v&&this._segment1._index===v._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(v){this.getPoint1().setSelected(v),this.getHandle1().setSelected(v),this.getHandle2().setSelected(v),this.getPoint2().setSelected(v)},getValues:function(v){return at.getValues(this._segment1,this._segment2,v)},getPoints:function(){for(var v=this.getValues(),k=[],V=0;V<8;V+=2)k.push(new we(v[V],v[V+1]));return k}},{getLength:function(){return this._length==null&&(this._length=at.getLength(this.getValues(),0,1)),this._length},getArea:function(){return at.getArea(this.getValues())},getLine:function(){return new Bt(this._segment1._point,this._segment2._point)},getPart:function(v,k){return new at(at.getPart(this.getValues(),v,k))},getPartLength:function(v,k){return at.getLength(this.getValues(),v,k)},divideAt:function(v){return this.divideAtTime(v&&v.curve===this?v.time:this.getTimeAt(v))},divideAtTime:function(v,k){var V=1e-8,$=1-V,te=null;if(v>=V&&v<=$){var Ae=at.subdivide(this.getValues(),v),ve=Ae[0],Ie=Ae[1],Ee=k||this.hasHandles(),ze=this._segment1,Qe=this._segment2,He=this._path;Ee&&(ze._handleOut._set(ve[2]-ve[0],ve[3]-ve[1]),Qe._handleIn._set(Ie[4]-Ie[6],Ie[5]-Ie[7]));var Ze=ve[6],Ve=ve[7],ft=new nt(new we(Ze,Ve),Ee&&new we(ve[4]-Ze,ve[5]-Ve),Ee&&new we(Ie[2]-Ze,Ie[3]-Ve));He?(He.insert(ze._index+1,ft),te=this.getNext()):(this._segment2=ft,this._changed(),te=new at(ft,Qe))}return te},splitAt:function(v){var k=this._path;return k?k.splitAt(v):null},splitAtTime:function(v){return this.splitAt(this.getLocationAtTime(v))},divide:function(v,k){return this.divideAtTime(v===n?.5:k?v:this.getTimeAt(v))},split:function(v,k){return this.splitAtTime(v===n?.5:k?v:this.getTimeAt(v))},reversed:function(){return new at(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(v,k,V,$){var te=v._point,Ae=v._handleOut,ve=k._handleIn,Ie=k._point,Ee=te.x,ze=te.y,Qe=Ie.x,He=Ie.y,Ze=$?[Ee,ze,Ee,ze,Qe,He,Qe,He]:[Ee,ze,Ee+Ae._x,ze+Ae._y,Qe+ve._x,He+ve._y,Qe,He];return V&&V._transformCoordinates(Ze,Ze,4),Ze},subdivide:function(v,k){var V=v[0],$=v[1],te=v[2],Ae=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7];k===n&&(k=.5);var Qe=1-k,He=Qe*V+k*te,Ze=Qe*$+k*Ae,Ve=Qe*te+k*ve,ft=Qe*Ae+k*Ie,rt=Qe*ve+k*Ee,Me=Qe*Ie+k*ze,se=Qe*He+k*Ve,ne=Qe*Ze+k*ft,X=Qe*Ve+k*rt,ie=Qe*ft+k*Me,de=Qe*se+k*X,ye=Qe*ne+k*ie;return[[V,$,He,Ze,se,ne,de,ye],[de,ye,X,ie,rt,Me,Ee,ze]]},getMonoCurves:function(v,k){var V=[],$=k?0:1,te=v[$+0],Ae=v[$+2],ve=v[$+4],Ie=v[$+6];if(te>=Ae==Ae>=ve&&Ae>=ve==ve>=Ie||at.isStraight(v))V.push(v);else{var Ee=3*(Ae-ve)-te+Ie,ze=2*(te+ve)-4*Ae,Qe=Ae-te,He=1e-8,Ze=1-He,Ve=[],ft=oe.solveQuadratic(Ee,ze,Qe,Ve,He,Ze);if(!ft)V.push(v);else{Ve.sort();var rt=Ve[0],Me=at.subdivide(v,rt);V.push(Me[0]),ft>1&&(rt=(Ve[1]-rt)/(1-rt),Me=at.subdivide(Me[1],rt),V.push(Me[0])),V.push(Me[1])}}return V},solveCubic:function(v,k,V,$,te,Ae){var ve=v[k],Ie=v[k+2],Ee=v[k+4],ze=v[k+6],Qe=0;if(!(ve<V&&ze<V&&Ie<V&&Ee<V||ve>V&&ze>V&&Ie>V&&Ee>V)){var He=3*(Ie-ve),Ze=3*(Ee-Ie)-He,Ve=ze-ve-He-Ze;Qe=oe.solveCubic(Ve,Ze,He,ve-V,$,te,Ae)}return Qe},getTimeOf:function(v,k){var V=new we(v[0],v[1]),$=new we(v[6],v[7]),te=1e-12,Ae=1e-7,ve=k.isClose(V,te)?0:k.isClose($,te)?1:null;if(ve===null)for(var Ie=[k.x,k.y],Ee=[],ze=0;ze<2;ze++)for(var Qe=at.solveCubic(v,ze,Ie[ze],Ee,0,1),He=0;He<Qe;He++){var Ze=Ee[He];if(k.isClose(at.getPoint(v,Ze),Ae))return Ze}return k.isClose(V,Ae)?0:k.isClose($,Ae)?1:null},getNearestTime:function(v,k){if(at.isStraight(v)){var V=v[0],$=v[1],te=v[6],Ae=v[7],ve=te-V,Ie=Ae-$,Ee=ve*ve+Ie*Ie;if(Ee===0)return 0;var ze=((k.x-V)*ve+(k.y-$)*Ie)/Ee;return ze<1e-12?0:ze>.999999999999?1:at.getTimeOf(v,new we(V+ze*ve,$+ze*Ie))}var Qe=100,He=1/0,Ze=0;function Ve(Me){if(Me>=0&&Me<=1){var se=k.getDistance(at.getPoint(v,Me),!0);if(se<He)return He=se,Ze=Me,!0}}for(var ft=0;ft<=Qe;ft++)Ve(ft/Qe);for(var rt=1/(Qe*2);rt>1e-8;)!Ve(Ze-rt)&&!Ve(Ze+rt)&&(rt/=2);return Ze},getPart:function(v,k,V){var $=k>V;if($){var te=k;k=V,V=te}return k>0&&(v=at.subdivide(v,k)[1]),V<1&&(v=at.subdivide(v,(V-k)/(1-k))[0]),$?[v[6],v[7],v[4],v[5],v[2],v[3],v[0],v[1]]:v},isFlatEnough:function(v,k){var V=v[0],$=v[1],te=v[2],Ae=v[3],ve=v[4],Ie=v[5],Ee=v[6],ze=v[7],Qe=3*te-2*V-Ee,He=3*Ae-2*$-ze,Ze=3*ve-2*Ee-V,Ve=3*Ie-2*ze-$;return Math.max(Qe*Qe,Ze*Ze)+Math.max(He*He,Ve*Ve)<=16*k*k},getArea:function(v){var k=v[0],V=v[1],$=v[2],te=v[3],Ae=v[4],ve=v[5],Ie=v[6],Ee=v[7];return 3*((Ee-V)*($+Ae)-(Ie-k)*(te+ve)+te*(k-Ae)-$*(V-ve)+Ee*(Ae+k/3)-Ie*(ve+V/3))/20},getBounds:function(v){for(var k=v.slice(0,2),V=k.slice(),$=[0,0],te=0;te<2;te++)at._addBounds(v[te],v[te+2],v[te+4],v[te+6],te,0,k,V,$);return new st(k[0],k[1],V[0]-k[0],V[1]-k[1])},_addBounds:function(v,k,V,$,te,Ae,ve,Ie,Ee){function ze(de,ye){var ge=de-ye,Pe=de+ye;ge<ve[te]&&(ve[te]=ge),Pe>Ie[te]&&(Ie[te]=Pe)}Ae/=2;var Qe=ve[te]+Ae,He=Ie[te]-Ae;if(v<Qe||k<Qe||V<Qe||$<Qe||v>He||k>He||V>He||$>He)if(k<v!=k<$&&V<v!=V<$)ze(v,0),ze($,0);else{var Ze=3*(k-V)-v+$,Ve=2*(v+V)-4*k,ft=k-v,rt=oe.solveQuadratic(Ze,Ve,ft,Ee),Me=1e-8,se=1-Me;ze($,0);for(var ne=0;ne<rt;ne++){var X=Ee[ne],ie=1-X;Me<=X&&X<=se&&ze(ie*ie*ie*v+3*ie*ie*X*k+3*ie*X*X*V+X*X*X*$,Ae)}}}}},b.each(["getBounds","getStrokeBounds","getHandleBounds"],function(v){this[v]=function(){this._bounds||(this._bounds={});var k=this._bounds[v];return k||(k=this._bounds[v]=Dt[v]([this._segment1,this._segment2],!1,this._path)),k.clone()}},{}),b.each({isStraight:function(v,k,V,$){if(k.isZero()&&V.isZero())return!0;var te=$.subtract(v);if(te.isZero())return!1;if(te.isCollinear(k)&&te.isCollinear(V)){var Ae=new Bt(v,$),ve=1e-7;if(Ae.getDistance(v.add(k))<ve&&Ae.getDistance($.add(V))<ve){var Ie=te.dot(te),Ee=te.dot(k)/Ie,ze=te.dot(V)/Ie;return Ee>=0&&Ee<=1&&ze<=0&&ze>=-1}}return!1},isLinear:function(v,k,V,$){var te=$.subtract(v).divide(3);return k.equals(te)&&V.negate().equals(te)}},function(v,k){this[k]=function(V){var $=this._segment1,te=this._segment2;return v($._point,$._handleOut,te._handleIn,te._point,V)},this.statics[k]=function(V,$){var te=V[0],Ae=V[1],ve=V[6],Ie=V[7];return v(new we(te,Ae),new we(V[2]-te,V[3]-Ae),new we(V[4]-ve,V[5]-Ie),new we(ve,Ie),$)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(v){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(v||0)},isCollinear:function(v){return v&&this.isStraight()&&v.isStraight()&&this.getLine().isCollinear(v.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(v,k){return this.getLocationAtTime(k?v:this.getTimeAt(v))},getLocationAtTime:function(v){return v!=null&&v>=0&&v<=1?new Nt(this,v):null},getTimeAt:function(v,k){return at.getTimeAt(this.getValues(),v,k)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var v=we.read(arguments);return v.isZero()?[]:at.getTimesWithTangent(this.getValues(),v)},getOffsetAtTime:function(v){return this.getPartLength(0,v)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(we.read(arguments)))},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getTimeOf:function(){return at.getTimeOf(this.getValues(),we.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var v=we.read(arguments),k=this.getValues(),V=at.getNearestTime(k,v),$=at.getPoint(k,V);return new Nt(this,V,$,null,v.getDistance($))},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()}},new function(){var v=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return b.each(v,function(k){this[k+"At"]=function(V,$){var te=this.getValues();return at[k](te,$?V:at.getTimeAt(te,V))},this[k+"AtTime"]=function(V){return at[k](this.getValues(),V)}},{statics:{_evaluateMethods:v}})},new function(){function v($){var te=$[0],Ae=$[1],ve=$[2],Ie=$[3],Ee=$[4],ze=$[5],Qe=$[6],He=$[7],Ze=9*(ve-Ee)+3*(Qe-te),Ve=6*(te+Ee)-12*ve,ft=3*(ve-te),rt=9*(Ie-ze)+3*(He-Ae),Me=6*(Ae+ze)-12*Ie,se=3*(Ie-Ae);return function(ne){var X=(Ze*ne+Ve)*ne+ft,ie=(rt*ne+Me)*ne+se;return Math.sqrt(X*X+ie*ie)}}function k($,te){return Math.max(2,Math.min(16,Math.ceil(Math.abs(te-$)*32)))}function V($,te,Ae,ve){if(te==null||te<0||te>1)return null;var Ie=$[0],Ee=$[1],ze=$[2],Qe=$[3],He=$[4],Ze=$[5],Ve=$[6],ft=$[7],rt=oe.isZero;rt(ze-Ie)&&rt(Qe-Ee)&&(ze=Ie,Qe=Ee),rt(He-Ve)&&rt(Ze-ft)&&(He=Ve,Ze=ft);var Me=3*(ze-Ie),se=3*(He-ze)-Me,ne=Ve-Ie-Me-se,X=3*(Qe-Ee),ie=3*(Ze-Qe)-X,de=ft-Ee-X-ie,ye,ge;if(Ae===0)ye=te===0?Ie:te===1?Ve:((ne*te+se)*te+Me)*te+Ie,ge=te===0?Ee:te===1?ft:((de*te+ie)*te+X)*te+Ee;else{var Pe=1e-8,Fe=1-Pe;if(te<Pe?(ye=Me,ge=X):te>Fe?(ye=3*(Ve-He),ge=3*(ft-Ze)):(ye=(3*ne*te+2*se)*te+Me,ge=(3*de*te+2*ie)*te+X),ve){ye===0&&ge===0&&(te<Pe||te>Fe)&&(ye=He-ze,ge=Ze-Qe);var Ne=Math.sqrt(ye*ye+ge*ge);Ne&&(ye/=Ne,ge/=Ne)}if(Ae===3){var He=6*ne*te+2*se,Ze=6*de*te+2*ie,Xe=Math.pow(ye*ye+ge*ge,3/2);ye=Xe!==0?(ye*Ze-ge*He)/Xe:0,ge=0}}return Ae===2?new we(ge,-ye):new we(ye,ge)}return{statics:{classify:function($){var te=$[0],Ae=$[1],ve=$[2],Ie=$[3],Ee=$[4],ze=$[5],Qe=$[6],He=$[7],Ze=te*(He-ze)+Ae*(Ee-Qe)+Qe*ze-He*Ee,Ve=ve*(Ae-He)+Ie*(Qe-te)+te*He-Ae*Qe,ft=Ee*(Ie-Ae)+ze*(te-ve)+ve*Ae-Ie*te,rt=3*ft,Me=rt-Ve,se=Me-Ve+Ze,ne=Math.sqrt(se*se+Me*Me+rt*rt),X=ne!==0?1/ne:0,ie=oe.isZero,de="serpentine";se*=X,Me*=X,rt*=X;function ye(Ne,Xe,Ye){var De=Xe!==n,Ue=De&&Xe>0&&Xe<1,ht=De&&Ye>0&&Ye<1;return De&&(!(Ue||ht)||Ne==="loop"&&!(Ue&&ht))&&(Ne="arch",Ue=ht=!1),{type:Ne,roots:Ue||ht?Ue&&ht?Xe<Ye?[Xe,Ye]:[Ye,Xe]:[Ue?Xe:Ye]:null}}if(ie(se))return ie(Me)?ye(ie(rt)?"line":"quadratic"):ye(de,rt/(3*Me));var ge=3*Me*Me-4*se*rt;if(ie(ge))return ye("cusp",Me/(2*se));var Pe=ge>0?Math.sqrt(ge/3):Math.sqrt(-ge),Fe=2*se;return ye(ge>0?de:"loop",(Me+Pe)/Fe,(Me-Pe)/Fe)},getLength:function($,te,Ae,ve){if(te===n&&(te=0),Ae===n&&(Ae=1),at.isStraight($)){var Ie=$;Ae<1&&(Ie=at.subdivide(Ie,Ae)[0],te/=Ae),te>0&&(Ie=at.subdivide(Ie,te)[1]);var Ee=Ie[6]-Ie[0],ze=Ie[7]-Ie[1];return Math.sqrt(Ee*Ee+ze*ze)}return oe.integrate(ve||v($),te,Ae,k(te,Ae))},getTimeAt:function($,te,Ae){if(Ae===n&&(Ae=te<0?1:0),te===0)return Ae;var ve=Math.abs,Ie=1e-12,Ee=te>0,ze=Ee?Ae:0,Qe=Ee?1:Ae,He=v($),Ze=at.getLength($,ze,Qe,He),Ve=ve(te)-Ze;if(ve(Ve)<Ie)return Ee?Qe:ze;if(Ve>Ie)return null;var ft=te/Ze,rt=0;function Me(se){return rt+=oe.integrate(He,Ae,se,k(Ae,se)),Ae=se,rt-te}return oe.findRoot(Me,He,Ae+ft,ze,Qe,32,1e-12)},getPoint:function($,te){return V($,te,0,!1)},getTangent:function($,te){return V($,te,1,!0)},getWeightedTangent:function($,te){return V($,te,1,!1)},getNormal:function($,te){return V($,te,2,!0)},getWeightedNormal:function($,te){return V($,te,2,!1)},getCurvature:function($,te){return V($,te,3,!1).x},getPeaks:function($){var te=$[0],Ae=$[1],ve=$[2],Ie=$[3],Ee=$[4],ze=$[5],Qe=$[6],He=$[7],Ze=-te+3*ve-3*Ee+Qe,Ve=3*te-6*ve+3*Ee,ft=-3*te+3*ve,rt=-Ae+3*Ie-3*ze+He,Me=3*Ae-6*Ie+3*ze,se=-3*Ae+3*Ie,ne=1e-8,X=1-ne,ie=[];return oe.solveCubic(9*(Ze*Ze+rt*rt),9*(Ze*Ve+Me*rt),2*(Ve*Ve+Me*Me)+3*(ft*Ze+se*rt),ft*Ve+Me*se,ie,ne,X),ie.sort()}}}},new function(){function v(Ve,ft,rt,Me,se,ne,X){var ie=!X&&rt.getPrevious()===se,de=!X&&rt!==se&&rt.getNext()===se,ye=1e-8,ge=1-ye;if(Me!==null&&Me>=(ie?ye:0)&&Me<=(de?ge:1)&&ne!==null&&ne>=(de?ye:0)&&ne<=(ie?ge:1)){var Pe=new Nt(rt,Me,null,X),Fe=new Nt(se,ne,null,X);Pe._intersection=Fe,Fe._intersection=Pe,(!ft||ft(Pe))&&Nt.insert(Ve,Pe,!0)}}function k(Ve,ft,rt,Me,se,ne,X,ie,de,ye,ge,Pe,Fe){if(++de>=4096||++ie>=40)return de;var Ne=1e-9,Xe=ft[0],Ye=ft[1],De=ft[6],Ue=ft[7],ht=Bt.getSignedDistance,Tt=ht(Xe,Ye,De,Ue,ft[2],ft[3]),o=ht(Xe,Ye,De,Ue,ft[4],ft[5]),ke=Tt*o>0?3/4:4/9,ai=ke*Math.min(0,Tt,o),di=ke*Math.max(0,Tt,o),Ai=ht(Xe,Ye,De,Ue,Ve[0],Ve[1]),Kt=ht(Xe,Ye,De,Ue,Ve[2],Ve[3]),oi=ht(Xe,Ye,De,Ue,Ve[4],Ve[5]),Ri=ht(Xe,Ye,De,Ue,Ve[6],Ve[7]),vi=V(Ai,Kt,oi,Ri),wi=vi[0],Yt=vi[1],vn,ar;if(Tt===0&&o===0&&Ai===0&&Kt===0&&oi===0&&Ri===0||(vn=$(wi,Yt,ai,di))==null||(ar=$(wi.reverse(),Yt.reverse(),ai,di))==null)return de;var dn=ye+(ge-ye)*vn,Vn=ye+(ge-ye)*ar;if(Math.max(Fe-Pe,Vn-dn)<Ne){var Hr=(dn+Vn)/2,Hi=(Pe+Fe)/2;v(se,ne,X?Me:rt,X?Hi:Hr,X?rt:Me,X?Hr:Hi)}else{Ve=at.getPart(Ve,vn,ar);var lr=Fe-Pe;if(ar-vn>.8)if(Vn-dn>lr){var Fn=at.subdivide(Ve,.5),Hr=(dn+Vn)/2;de=k(ft,Fn[0],Me,rt,se,ne,!X,ie,de,Pe,Fe,dn,Hr),de=k(ft,Fn[1],Me,rt,se,ne,!X,ie,de,Pe,Fe,Hr,Vn)}else{var Fn=at.subdivide(ft,.5),Hi=(Pe+Fe)/2;de=k(Fn[0],Ve,Me,rt,se,ne,!X,ie,de,Pe,Hi,dn,Vn),de=k(Fn[1],Ve,Me,rt,se,ne,!X,ie,de,Hi,Fe,dn,Vn)}else lr===0||lr>=Ne?de=k(ft,Ve,Me,rt,se,ne,!X,ie,de,Pe,Fe,dn,Vn):de=k(Ve,ft,rt,Me,se,ne,X,ie,de,dn,Vn,Pe,Fe)}return de}function V(Ve,ft,rt,Me){var se=[0,Ve],ne=[1/3,ft],X=[2/3,rt],ie=[1,Me],de=ft-(2*Ve+Me)/3,ye=rt-(Ve+2*Me)/3,ge;if(de*ye<0)ge=[[se,ne,ie],[se,X,ie]];else{var Pe=de/ye;ge=[Pe>=2?[se,ne,ie]:Pe<=.5?[se,X,ie]:[se,ne,X,ie],[se,ie]]}return(de||ye)<0?ge.reverse():ge}function $(Ve,ft,rt,Me){return Ve[0][1]<rt?te(Ve,!0,rt):ft[0][1]>Me?te(ft,!1,Me):Ve[0][0]}function te(Ve,ft,rt){for(var Me=Ve[0][0],se=Ve[0][1],ne=1,X=Ve.length;ne<X;ne++){var ie=Ve[ne][0],de=Ve[ne][1];if(ft?de>=rt:de<=rt)return de===rt?ie:Me+(rt-se)*(ie-Me)/(de-se);Me=ie,se=de}return null}function Ae(Ve,ft,rt,Me,se){var ne=oe.isZero;if(ne(Me)&&ne(se)){var X=at.getTimeOf(Ve,new we(ft,rt));return X===null?[]:[X]}for(var ie=Math.atan2(-se,Me),de=Math.sin(ie),ye=Math.cos(ie),ge=[],Pe=[],Fe=0;Fe<8;Fe+=2){var Ne=Ve[Fe]-ft,Xe=Ve[Fe+1]-rt;ge.push(Ne*ye-Xe*de,Ne*de+Xe*ye)}return at.solveCubic(ge,1,0,Pe,0,1),Pe}function ve(Ve,ft,rt,Me,se,ne,X){for(var ie=ft[0],de=ft[1],ye=ft[6],ge=ft[7],Pe=Ae(Ve,ie,de,ye-ie,ge-de),Fe=0,Ne=Pe.length;Fe<Ne;Fe++){var Xe=Pe[Fe],Ye=at.getPoint(Ve,Xe),De=at.getTimeOf(ft,Ye);De!==null&&v(se,ne,X?Me:rt,X?De:Xe,X?rt:Me,X?Xe:De)}}function Ie(Ve,ft,rt,Me,se,ne){var X=Bt.intersect(Ve[0],Ve[1],Ve[6],Ve[7],ft[0],ft[1],ft[6],ft[7]);X&&v(se,ne,rt,at.getTimeOf(Ve,X),Me,at.getTimeOf(ft,X))}function Ee(Ve,ft,rt,Me,se,ne){var X=1e-12,ie=Math.min,de=Math.max;if(de(Ve[0],Ve[2],Ve[4],Ve[6])+X>ie(ft[0],ft[2],ft[4],ft[6])&&ie(Ve[0],Ve[2],Ve[4],Ve[6])-X<de(ft[0],ft[2],ft[4],ft[6])&&de(Ve[1],Ve[3],Ve[5],Ve[7])+X>ie(ft[1],ft[3],ft[5],ft[7])&&ie(Ve[1],Ve[3],Ve[5],Ve[7])-X<de(ft[1],ft[3],ft[5],ft[7])){var ye=He(Ve,ft);if(ye)for(var ge=0;ge<2;ge++){var Pe=ye[ge];v(se,ne,rt,Pe[0],Me,Pe[1],!0)}else{var Fe=at.isStraight(Ve),Ne=at.isStraight(ft),Xe=Fe&&Ne,Ye=Fe&&!Ne,De=se.length;if((Xe?Ie:Fe||Ne?ve:k)(Ye?ft:Ve,Ye?Ve:ft,Ye?Me:rt,Ye?rt:Me,se,ne,Ye,0,0,0,1,0,1),!Xe||se.length===De)for(var ge=0;ge<4;ge++){var Ue=ge>>1,ht=ge&1,Tt=Ue*6,o=ht*6,ke=new we(Ve[Tt],Ve[Tt+1]),ai=new we(ft[o],ft[o+1]);ke.isClose(ai,X)&&v(se,ne,rt,Ue,Me,ht)}}}return se}function ze(Ve,ft,rt,Me){var se=at.classify(Ve);if(se.type==="loop"){var ne=se.roots;v(rt,Me,ft,ne[0],ft,ne[1])}return rt}function Qe(Ve,ft,rt,Me,se,ne){var X=1e-7,ie=!ft;ie&&(ft=Ve);for(var de=Ve.length,ye=ft.length,ge=new Array(de),Pe=ie?ge:new Array(ye),Fe=[],Ne=0;Ne<de;Ne++)ge[Ne]=Ve[Ne].getValues(Me);if(!ie)for(var Ne=0;Ne<ye;Ne++)Pe[Ne]=ft[Ne].getValues(se);for(var Xe=W.findCurveBoundsCollisions(ge,Pe,X),Ye=0;Ye<de;Ye++){var De=Ve[Ye],Ue=ge[Ye];ie&&ze(Ue,De,Fe,rt);var ht=Xe[Ye];if(ht)for(var Tt=0;Tt<ht.length;Tt++){if(ne&&Fe.length)return Fe;var o=ht[Tt];if(!ie||o>Ye){var ke=ft[o],ai=Pe[o];Ee(Ue,ai,De,ke,Fe,rt)}}}return Fe}function He(Ve,ft){function rt(Ri){var vi=Ri[6]-Ri[0],wi=Ri[7]-Ri[1];return vi*vi+wi*wi}var Me=Math.abs,se=Bt.getDistance,ne=1e-8,X=1e-7,ie=at.isStraight(Ve),de=at.isStraight(ft),ye=ie&&de,ge=rt(Ve)<rt(ft),Pe=ge?ft:Ve,Fe=ge?Ve:ft,Ne=Pe[0],Xe=Pe[1],Ye=Pe[6]-Ne,De=Pe[7]-Xe;if(se(Ne,Xe,Ye,De,Fe[0],Fe[1],!0)<X&&se(Ne,Xe,Ye,De,Fe[6],Fe[7],!0)<X)!ye&&se(Ne,Xe,Ye,De,Pe[2],Pe[3],!0)<X&&se(Ne,Xe,Ye,De,Pe[4],Pe[5],!0)<X&&se(Ne,Xe,Ye,De,Fe[2],Fe[3],!0)<X&&se(Ne,Xe,Ye,De,Fe[4],Fe[5],!0)<X&&(ie=de=ye=!0);else if(ye)return null;if(ie^de)return null;for(var Ue=[Ve,ft],ht=[],Tt=0;Tt<4&&ht.length<2;Tt++){var o=Tt&1,ke=o^1,ai=Tt>>1,di=at.getTimeOf(Ue[o],new we(Ue[ke][ai?6:0],Ue[ke][ai?7:1]));if(di!=null){var Ai=o?[ai,di]:[di,ai];(!ht.length||Me(Ai[0]-ht[0][0])>ne&&Me(Ai[1]-ht[0][1])>ne)&&ht.push(Ai)}if(Tt>2&&!ht.length)break}if(ht.length!==2)ht=null;else if(!ye){var Kt=at.getPart(Ve,ht[0][0],ht[1][0]),oi=at.getPart(ft,ht[0][1],ht[1][1]);(Me(oi[2]-Kt[2])>X||Me(oi[3]-Kt[3])>X||Me(oi[4]-Kt[4])>X||Me(oi[5]-Kt[5])>X)&&(ht=null)}return ht}function Ze(Ve,ft){var rt=Ve[0],Me=Ve[1],se=Ve[2],ne=Ve[3],X=Ve[4],ie=Ve[5],de=Ve[6],ye=Ve[7],ge=ft.normalize(),Pe=ge.x,Fe=ge.y,Ne=3*de-9*X+9*se-3*rt,Xe=3*ye-9*ie+9*ne-3*Me,Ye=6*X-12*se+6*rt,De=6*ie-12*ne+6*Me,Ue=3*se-3*rt,ht=3*ne-3*Me,Tt=2*Ne*Fe-2*Xe*Pe,o=[];if(Math.abs(Tt)<oe.CURVETIME_EPSILON){var ke=Ne*ht-Xe*Ue,Tt=Ne*De-Xe*Ye;if(Tt!=0){var ai=-ke/Tt;ai>=0&&ai<=1&&o.push(ai)}}else{var di=(Ye*Ye-4*Ne*Ue)*Fe*Fe+(-2*Ye*De+4*Xe*Ue+4*Ne*ht)*Pe*Fe+(De*De-4*Xe*ht)*Pe*Pe,Ai=Ye*Fe-De*Pe;if(di>=0&&Tt!=0){var Kt=Math.sqrt(di),oi=-(Ai+Kt)/Tt,Ri=(-Ai+Kt)/Tt;oi>=0&&oi<=1&&o.push(oi),Ri>=0&&Ri<=1&&o.push(Ri)}}return o}return{getIntersections:function(Ve){var ft=this.getValues(),rt=Ve&&Ve!==this&&Ve.getValues();return rt?Ee(ft,rt,this,Ve,[]):ze(ft,this,[])},statics:{getOverlaps:He,getIntersections:Qe,getCurveLineIntersections:Ae,getTimesWithTangent:Ze}}}),Nt=b.extend({_class:"CurveLocation",initialize:function(k,V,$,te,Ae){if(V>=.99999999){var ve=k.getNext();ve&&(V=0,k=ve)}this._setCurve(k),this._time=V,this._point=$||k.getPointAtTime(V),this._overlap=te,this._distance=Ae,this._intersection=this._next=this._previous=null},_setPath:function(v){this._path=v,this._version=v?v._version:0},_setCurve:function(v){this._setPath(v._path),this._curve=v,this._segment=null,this._segment1=v._segment1,this._segment2=v._segment2},_setSegment:function(v){var k=v.getCurve();k?this._setCurve(k):(this._setPath(v._path),this._segment1=v,this._segment2=null),this._segment=v,this._time=v===this._segment1?0:1,this._point=v._point.clone()},getSegment:function(){var v=this._segment;if(!v){var k=this.getCurve(),V=this.getTime();V===0?v=k._segment1:V===1?v=k._segment2:V!=null&&(v=k.getPartLength(0,V)<k.getPartLength(V,1)?k._segment1:k._segment2),this._segment=v}return v},getCurve:function(){var v=this._path,k=this;v&&v._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function V($){var te=$&&$.getCurve();if(te&&(k._time=te.getTimeOf(k._point))!=null)return k._setCurve(te),te}return this._curve||V(this._segment)||V(this._segment1)||V(this._segment2.getPrevious())},getPath:function(){var v=this.getCurve();return v&&v._path},getIndex:function(){var v=this.getCurve();return v&&v.getIndex()},getTime:function(){var v=this.getCurve(),k=this._time;return v&&k==null?this._time=v.getTimeOf(this._point):k},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var v=this._offset;if(v==null){v=0;var k=this.getPath(),V=this.getIndex();if(k&&V!=null)for(var $=k.getCurves(),te=0;te<V;te++)v+=$[te].getLength();this._offset=v+=this.getCurveOffset()}return v},getCurveOffset:function(){var v=this._curveOffset;if(v==null){var k=this.getCurve(),V=this.getTime();this._curveOffset=v=V!=null&&k&&k.getPartLength(0,V)}return v},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var v=this.getCurve(),k=v&&v.divideAtTime(this.getTime());return k&&this._setSegment(k._segment1),k},split:function(){var v=this.getCurve(),k=v._path,V=v&&v.splitAtTime(this.getTime());return V&&this._setSegment(k.getLastSegment()),V},equals:function(v,k){var V=this===v;if(!V&&v instanceof Nt){var $=this.getCurve(),te=v.getCurve(),Ae=$._path,ve=te._path;if(Ae===ve){var Ie=Math.abs,Ee=1e-7,ze=Ie(this.getOffset()-v.getOffset()),Qe=!k&&this._intersection,He=!k&&v._intersection;V=(ze<Ee||Ae&&Ie(Ae.getLength()-ze)<Ee)&&(!Qe&&!He||Qe&&He&&Qe.equals(He,!0))}}return V},toString:function(){var v=[],k=this.getPoint(),V=ce.instance;k&&v.push("point: "+k);var $=this.getIndex();$!=null&&v.push("index: "+$);var te=this.getTime();return te!=null&&v.push("time: "+V.number(te)),this._distance!=null&&v.push("distance: "+V.number(this._distance)),"{ "+v.join(", ")+" }"},isTouching:function(){var v=this._intersection;if(v&&this.getTangent().isCollinear(v.getTangent())){var k=this.getCurve(),V=v.getCurve();return!(k.isStraight()&&V.isStraight()&&k.getLine().intersect(V.getLine()))}return!1},isCrossing:function(){var v=this._intersection;if(!v)return!1;var k=this.getTime(),V=v.getTime(),$=1e-8,te=1-$,Ae=k>=$&&k<=te,ve=V>=$&&V<=te;if(Ae&&ve)return!this.isTouching();var Ie=this.getCurve(),Ee=Ie&&k<$?Ie.getPrevious():Ie,ze=v.getCurve(),Qe=ze&&V<$?ze.getPrevious():ze;if(k>te&&(Ie=Ie.getNext()),V>te&&(ze=ze.getNext()),!Ee||!Ie||!Qe||!ze)return!1;var He=[];function Ze(Pe,Fe){var Ne=Pe.getValues(),Xe=at.classify(Ne).roots||at.getPeaks(Ne),Ye=Xe.length,De=at.getLength(Ne,Fe&&Ye?Xe[Ye-1]:0,!Fe&&Ye?Xe[0]:1);He.push(Ye?De:De/32)}function Ve(Pe,Fe,Ne){return Fe<Ne?Pe>Fe&&Pe<Ne:Pe>Fe||Pe<Ne}Ae||(Ze(Ee,!0),Ze(Ie,!1)),ve||(Ze(Qe,!0),Ze(ze,!1));var ft=this.getPoint(),rt=Math.min.apply(Math,He),Me=Ae?Ie.getTangentAtTime(k):Ie.getPointAt(rt).subtract(ft),se=Ae?Me.negate():Ee.getPointAt(-rt).subtract(ft),ne=ve?ze.getTangentAtTime(V):ze.getPointAt(rt).subtract(ft),X=ve?ne.negate():Qe.getPointAt(-rt).subtract(ft),ie=se.getAngle(),de=Me.getAngle(),ye=X.getAngle(),ge=ne.getAngle();return!!(Ae?Ve(ie,ye,ge)^Ve(de,ye,ge)&&Ve(ie,ge,ye)^Ve(de,ge,ye):Ve(ye,ie,de)^Ve(ge,ie,de)&&Ve(ye,de,ie)^Ve(ge,de,ie))},hasOverlap:function(){return!!this._overlap}},b.each(at._evaluateMethods,function(v){var k=v+"At";this[v]=function(){var V=this.getCurve(),$=this.getTime();return $!=null&&V&&V[k]($,!0)}},{preserve:!0}),new function(){function v(k,V,$){var te=k.length,Ae=0,ve=te-1;function Ie(ft,rt){for(var Me=ft+rt;Me>=-1&&Me<=te;Me+=rt){var se=k[(Me%te+te)%te];if(!V.getPoint().isClose(se.getPoint(),1e-7))break;if(V.equals(se))return se}return null}for(;Ae<=ve;){var Ee=Ae+ve>>>1,ze=k[Ee],Qe;if($&&(Qe=V.equals(ze)?ze:Ie(Ee,-1)||Ie(Ee,1)))return V._overlap&&(Qe._overlap=Qe._intersection._overlap=!0),Qe;var He=V.getPath(),Ze=ze.getPath(),Ve=He!==Ze?He._id-Ze._id:V.getIndex()+V.getTime()-(ze.getIndex()+ze.getTime());Ve<0?ve=Ee-1:Ae=Ee+1}return k.splice(Ae,0,V),V}return{statics:{insert:v,expand:function(k){for(var V=k.slice(),$=k.length-1;$>=0;$--)v(V,k[$]._intersection,!1);return V}}}}),Ft=Ge.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(v){var k,V,$;if(b.isPlainObject(v)?(V=v.segments,k=v.pathData):Array.isArray(v)?V=v:typeof v=="string"&&(k=v),V){var te=V[0];$=te&&Array.isArray(te[0])}else k&&($=(k.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(k));var Ae=$?ci:Dt;return new Ae(v)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(v){this.isClockwise()!=(v=!!v)&&this.reverse()},setPathData:function(v){var k=v&&v.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),V,$=!1,te,Ae,ve=new we,Ie=new we;function Ee(X,ie){var de=+V[X];return $&&(de+=ve[ie]),de}function ze(X){return new we(Ee(X,"x"),Ee(X+1,"y"))}this.clear();for(var Qe=0,He=k&&k.length;Qe<He;Qe++){var Ze=k[Qe],Ve=Ze[0],ft=Ve.toLowerCase();V=Ze.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var rt=V&&V.length;switch($=Ve===ft,te==="z"&&!/[mz]/.test(ft)&&this.moveTo(ve),ft){case"m":case"l":for(var Me=ft==="m",se=0;se<rt;se+=2)this[Me?"moveTo":"lineTo"](ve=ze(se)),Me&&(Ie=ve,Me=!1);Ae=ve;break;case"h":case"v":var ne=ft==="h"?"x":"y";ve=ve.clone();for(var se=0;se<rt;se++)ve[ne]=Ee(se,ne),this.lineTo(ve);Ae=ve;break;case"c":for(var se=0;se<rt;se+=6)this.cubicCurveTo(ze(se),Ae=ze(se+2),ve=ze(se+4));break;case"s":for(var se=0;se<rt;se+=4)this.cubicCurveTo(/[cs]/.test(te)?ve.multiply(2).subtract(Ae):ve,Ae=ze(se),ve=ze(se+2)),te=ft;break;case"q":for(var se=0;se<rt;se+=4)this.quadraticCurveTo(Ae=ze(se),ve=ze(se+2));break;case"t":for(var se=0;se<rt;se+=2)this.quadraticCurveTo(Ae=/[qt]/.test(te)?ve.multiply(2).subtract(Ae):ve,ve=ze(se)),te=ft;break;case"a":for(var se=0;se<rt;se+=7)this.arcTo(ve=ze(se+5),new lt(+V[se],+V[se+1]),+V[se+2],+V[se+4],+V[se+3]);break;case"z":this.closePath(1e-12),ve=Ie;break}te=ft}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(v){var k=v.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(v):{};return k.onPath||!!(this.getFillRule()==="evenodd"?k.windingL&1||k.windingR&1:k.winding)},getIntersections:function(v,k,V,$){var te=this===v||!v,Ae=this._matrix._orNullIfIdentity(),ve=te?Ae:(V||v._matrix)._orNullIfIdentity();return te||this.getBounds(Ae).intersects(v.getBounds(ve),1e-12)?at.getIntersections(this.getCurves(),!te&&v.getCurves(),k,Ae,ve,$):[]},getCrossings:function(v){return this.getIntersections(v,function(k){return k.isCrossing()})},getNearestLocation:function(){for(var v=we.read(arguments),k=this.getCurves(),V=1/0,$=null,te=0,Ae=k.length;te<Ae;te++){var ve=k[te].getNearestLocation(v);ve._distance<V&&(V=ve._distance,$=ve)}return $},getNearestPoint:function(){var v=this.getNearestLocation.apply(this,arguments);return v&&v.getPoint()},interpolate:function(v,k,V){var $=!this._children,te=$?"_segments":"_children",Ae=v[te],ve=k[te],Ie=this[te];if(!Ae||!ve||Ae.length!==ve.length)throw new Error("Invalid operands in interpolate() call: "+v+", "+k);var Ee=Ie.length,ze=ve.length;if(Ee<ze)for(var Qe=$?nt:Dt,He=Ee;He<ze;He++)this.add(new Qe);else Ee>ze&&this[$?"removeSegments":"removeChildren"](ze,Ee);for(var He=0;He<ze;He++)Ie[He].interpolate(Ae[He],ve[He],V);$&&(this.setClosed(v._closed),this._changed(9))},compare:function(v){var k=!1;if(v){var V=this._children||[this],$=v._children?v._children.slice():[v],te=V.length,Ae=$.length,ve=[],Ie=0;k=!0;for(var Ee=W.findItemBoundsCollisions(V,$,oe.GEOMETRIC_EPSILON),ze=te-1;ze>=0&&k;ze--){var Qe=V[ze];k=!1;var He=Ee[ze];if(He)for(var Ze=He.length-1;Ze>=0&&!k;Ze--)Qe.compare($[He[Ze]])&&(ve[He[Ze]]||(ve[He[Ze]]=!0,Ie++),k=!0)}k=k&&Ie===Ae}return k}}),Dt=Ft.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(k){this._closed=!1,this._segments=[],this._version=0;var V=arguments,$=Array.isArray(k)?typeof k[0]=="object"?k:V:k&&k.size===n&&(k.x!==n||k.point!==n)?V:null;$&&$.length>0?this.setSegments($):(this._curves=n,this._segmentSelection=0,!$&&typeof k=="string"&&(this.setPathData(k),k=null)),this._initialize(!$&&k)},_equals:function(v){return this._closed===v._closed&&b.equals(this._segments,v._segments)},copyContent:function(v){this.setSegments(v._segments),this._closed=v._closed},_changed:function v(k){if(v.base.call(this,k),k&8){if(this._length=this._area=n,k&32)this._version++;else if(this._curves)for(var V=0,$=this._curves.length;V<$;V++)this._curves[V]._changed()}else k&64&&(this._bounds=n)},getStyle:function(){var v=this._parent;return(v instanceof ci?v:this)._style},getSegments:function(){return this._segments},setSegments:function(v){var k=this.isFullySelected(),V=v&&v.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,V){var $=v[V-1];typeof $=="boolean"&&(this.setClosed($),V--),this._add(nt.readList(v,0,{},V))}k&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var v=this._curves,k=this._segments;if(!v){var V=this._countCurves();v=this._curves=new Array(V);for(var $=0;$<V;$++)v[$]=new at(this,k[$],k[$+1]||k[0])}return v},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var v=this.getCurves();return v[v.length-1]},isClosed:function(){return this._closed},setClosed:function(v){if(this._closed!=(v=!!v)){if(this._closed=v,this._curves){var k=this._curves.length=this._countCurves();v&&(this._curves[k-1]=new at(this,this._segments[k-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(v,k){var V=this._segments,$=V.length,te=new ce(k),Ae=new Array(6),ve=!0,Ie,Ee,ze,Qe,He,Ze,Ve,ft,rt=[];function Me(ne,X){if(ne._transformCoordinates(v,Ae),Ie=Ae[0],Ee=Ae[1],ve)rt.push("M"+te.pair(Ie,Ee)),ve=!1;else if(He=Ae[2],Ze=Ae[3],He===Ie&&Ze===Ee&&Ve===ze&&ft===Qe){if(!X){var ie=Ie-ze,de=Ee-Qe;rt.push(ie===0?"v"+te.number(de):de===0?"h"+te.number(ie):"l"+te.pair(ie,de))}}else rt.push("c"+te.pair(Ve-ze,ft-Qe)+" "+te.pair(He-ze,Ze-Qe)+" "+te.pair(Ie-ze,Ee-Qe));ze=Ie,Qe=Ee,Ve=Ae[4],ft=Ae[5]}if(!$)return"";for(var se=0;se<$;se++)Me(V[se]);return this._closed&&$>0&&(Me(V[0],!0),rt.push("z")),rt.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(v){for(var k=this._segments,V=new Array(6),$=0,te=k.length;$<te;$++)k[$]._transformCoordinates(v,V,!0);return!0},_add:function(v,ve){for(var V=this._segments,$=this._curves,te=v.length,Ae=ve==null,ve=Ae?V.length:ve,Ie=0;Ie<te;Ie++){var Ee=v[Ie];Ee._path&&(Ee=v[Ie]=Ee.clone()),Ee._path=this,Ee._index=ve+Ie,Ee._selection&&this._updateSelection(Ee,0,Ee._selection)}if(Ae)b.push(V,v);else{V.splice.apply(V,[ve,0].concat(v));for(var Ie=ve+te,ze=V.length;Ie<ze;Ie++)V[Ie]._index=Ie}if($){var Qe=this._countCurves(),He=ve>0&&ve+te-1===Qe?ve-1:ve,Ze=He,Ve=Math.min(He+te,Qe);v._curves&&($.splice.apply($,[He,0].concat(v._curves)),Ze+=v._curves.length);for(var Ie=Ze;Ie<Ve;Ie++)$.splice(Ie,0,new at(this,null,null));this._adjustCurves(He,Ve)}return this._changed(41),v},_adjustCurves:function(v,k){for(var V=this._segments,$=this._curves,te,Ae=v;Ae<k;Ae++)te=$[Ae],te._path=this,te._segment1=V[Ae],te._segment2=V[Ae+1]||V[0],te._changed();(te=$[this._closed&&!v?V.length-1:v-1])&&(te._segment2=V[v]||V[0],te._changed()),(te=$[k])&&(te._segment1=V[k],te._changed())},_countCurves:function(){var v=this._segments.length;return!this._closed&&v>0?v-1:v},add:function(v){var k=arguments;return k.length>1&&typeof v!="number"?this._add(nt.readList(k)):this._add([nt.read(k)])[0]},insert:function(v,k){var V=arguments;return V.length>2&&typeof k!="number"?this._add(nt.readList(V,1),v):this._add([nt.read(V,1)],v)[0]},addSegment:function(){return this._add([nt.read(arguments)])[0]},insertSegment:function(v){return this._add([nt.read(arguments,1)],v)[0]},addSegments:function(v){return this._add(nt.readList(v))},insertSegments:function(v,k){return this._add(nt.readList(k),v)},removeSegment:function(v){return this.removeSegments(v,v+1)[0]||null},removeSegments:function(v,k,V){v=v||0,k=b.pick(k,this._segments.length);var $=this._segments,te=this._curves,Ae=$.length,ve=$.splice(v,k-v),Ie=ve.length;if(!Ie)return ve;for(var Ee=0;Ee<Ie;Ee++){var ze=ve[Ee];ze._selection&&this._updateSelection(ze,ze._selection,0),ze._index=ze._path=null}for(var Ee=v,Qe=$.length;Ee<Qe;Ee++)$[Ee]._index=Ee;if(te){for(var He=v>0&&k===Ae+(this._closed?1:0)?v-1:v,te=te.splice(He,Ie),Ee=te.length-1;Ee>=0;Ee--)te[Ee]._path=null;V&&(ve._curves=te.slice(1)),this._adjustCurves(He,He)}return this._changed(41),ve},clear:"#removeSegments",hasHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)if(v[k].hasHandles())return!0;return!1},clearHandles:function(){for(var v=this._segments,k=0,V=v.length;k<V;k++)v[k].clearHandles()},getLength:function(){if(this._length==null){for(var v=this.getCurves(),k=0,V=0,$=v.length;V<$;V++)k+=v[V].getLength();this._length=k}return this._length},getArea:function(){var v=this._area;if(v==null){var k=this._segments,V=this._closed;v=0;for(var $=0,te=k.length;$<te;$++){var Ae=$+1===te;v+=at.getArea(at.getValues(k[$],k[Ae?0:$+1],null,Ae&&!V))}this._area=v}return v},isFullySelected:function(){var v=this._segments.length;return this.isSelected()&&v>0&&this._segmentSelection===v*7},setFullySelected:function(v){v&&this._selectSegments(!0),this.setSelected(v)},setSelection:function v(k){k&1||this._selectSegments(!1),v.base.call(this,k)},_selectSegments:function(v){var k=this._segments,V=k.length,$=v?7:0;this._segmentSelection=$*V;for(var te=0;te<V;te++)k[te]._selection=$},_updateSelection:function(v,k,V){v._selection=V;var $=this._segmentSelection+=V-k;$>0&&this.setSelected(!0)},divideAt:function(v){var k=this.getLocationAt(v),V;return k&&(V=k.getCurve().divideAt(k.getCurveOffset()))?V._segment1:null},splitAt:function(v){var k=this.getLocationAt(v),V=k&&k.index,$=k&&k.time,te=1e-8,Ae=1-te;$>Ae&&(V++,$=0);var ve=this.getCurves();if(V>=0&&V<ve.length){$>=te&&ve[V++].divideAtTime($);var Ie=this.removeSegments(V,this._segments.length,!0),Ee;return this._closed?(this.setClosed(!1),Ee=this):(Ee=new Dt(Ge.NO_INSERT),Ee.insertAbove(this),Ee.copyAttributes(this)),Ee._add(Ie,0),this.addSegment(Ie[0]),Ee}return null},split:function(v,k){var V,$=k===n?v:(V=this.getCurves()[v])&&V.getLocationAtTime(k);return $!=null?this.splitAt($):null},join:function(v,k){var V=k||0;if(v&&v!==this){var $=v._segments,te=this.getLastSegment(),Ae=v.getLastSegment();if(!Ae)return this;te&&te._point.isClose(Ae._point,V)&&v.reverse();var ve=v.getFirstSegment();if(te&&te._point.isClose(ve._point,V))te.setHandleOut(ve._handleOut),this._add($.slice(1));else{var Ie=this.getFirstSegment();Ie&&Ie._point.isClose(ve._point,V)&&v.reverse(),Ae=v.getLastSegment(),Ie&&Ie._point.isClose(Ae._point,V)?(Ie.setHandleIn(Ae._handleIn),this._add($.slice(0,$.length-1),0)):this._add($.slice())}v._closed&&this._add([$[0]]),v.remove()}var Ee=this.getFirstSegment(),ze=this.getLastSegment();return Ee!==ze&&Ee._point.isClose(ze._point,V)&&(Ee.setHandleIn(ze._handleIn),ze.remove(),this.setClosed(!0)),this},reduce:function(v){for(var k=this.getCurves(),V=v&&v.simplify,$=V?1e-7:0,te=k.length-1;te>=0;te--){var Ae=k[te];!Ae.hasHandles()&&(!Ae.hasLength($)||V&&Ae.isCollinear(Ae.getNext()))&&Ae.remove()}return this},reverse:function(){this._segments.reverse();for(var v=0,k=this._segments.length;v<k;v++){var V=this._segments[v],$=V._handleIn;V._handleIn=V._handleOut,V._handleOut=$,V._index=v}this._curves=null,this._changed(9)},flatten:function(v){for(var k=new bi(this,v||.25,256,!0),V=k.parts,$=V.length,te=[],Ae=0;Ae<$;Ae++)te.push(new nt(V[Ae].curve.slice(0,2)));!this._closed&&$>0&&te.push(new nt(V[$-1].curve.slice(6))),this.setSegments(te)},simplify:function(v){var k=new ki(this).fit(v||2.5);return k&&this.setSegments(k),!!k},smooth:function(v){var k=this,V=v||{},$=V.type||"asymmetric",te=this._segments,Ae=te.length,ve=this._closed;function Ie(wi,Yt){var vn=wi&&wi.index;if(vn!=null){var ar=wi.path;if(ar&&ar!==k)throw new Error(wi._class+" "+vn+" of "+ar+" is not part of "+k);Yt&&wi instanceof at&&vn++}else vn=typeof wi=="number"?wi:Yt;return Math.min(vn<0&&ve?vn%Ae:vn<0?vn+Ae:vn,Ae-1)}var Ee=ve&&V.from===n&&V.to===n,ze=Ie(V.from,0),Qe=Ie(V.to,Ae-1);if(ze>Qe)if(ve)ze-=Ae;else{var He=ze;ze=Qe,Qe=He}if(/^(?:asymmetric|continuous)$/.test($)){var Ze=$==="asymmetric",Ve=Math.min,ft=Qe-ze+1,rt=ft-1,Me=Ee?Ve(ft,4):1,se=Me,ne=Me,X=[];if(ve||(se=Ve(1,ze),ne=Ve(1,Ae-Qe-1)),rt+=se+ne,rt<=1)return;for(var ie=0,de=ze-se;ie<=rt;ie++,de++)X[ie]=te[(de<0?de+Ae:de)%Ae]._point;for(var ye=X[0]._x+2*X[1]._x,ge=X[0]._y+2*X[1]._y,Pe=2,Fe=rt-1,Ne=[ye],Xe=[ge],Ye=[Pe],De=[],Ue=[],ie=1;ie<rt;ie++){var ht=ie<Fe,Tt=ht||Ze?1:2,o=ht?4:Ze?2:7,ke=ht?4:Ze?3:8,ai=ht?2:Ze?0:1,di=Tt/Pe;Pe=Ye[ie]=o-di,ye=Ne[ie]=ke*X[ie]._x+ai*X[ie+1]._x-di*ye,ge=Xe[ie]=ke*X[ie]._y+ai*X[ie+1]._y-di*ge}De[Fe]=Ne[Fe]/Ye[Fe],Ue[Fe]=Xe[Fe]/Ye[Fe];for(var ie=rt-2;ie>=0;ie--)De[ie]=(Ne[ie]-De[ie+1])/Ye[ie],Ue[ie]=(Xe[ie]-Ue[ie+1])/Ye[ie];De[rt]=(3*X[rt]._x-De[Fe])/2,Ue[rt]=(3*X[rt]._y-Ue[Fe])/2;for(var ie=se,Ai=rt-ne,de=ze;ie<=Ai;ie++,de++){var Kt=te[de<0?de+Ae:de],oi=Kt._point,Ri=De[ie]-oi._x,vi=Ue[ie]-oi._y;(Ee||ie<Ai)&&Kt.setHandleOut(Ri,vi),(Ee||ie>se)&&Kt.setHandleIn(-Ri,-vi)}}else for(var ie=ze;ie<=Qe;ie++)te[ie<0?ie+Ae:ie].smooth(V,!Ee&&ie===ze,!Ee&&ie===Qe)},toShape:function(v){if(!this._closed)return null;var k=this._segments,V,$,te,Ae;function ve(Ze,Ve){var ft=k[Ze],rt=ft.getNext(),Me=k[Ve],se=Me.getNext();return ft._handleOut.isZero()&&rt._handleIn.isZero()&&Me._handleOut.isZero()&&se._handleIn.isZero()&&rt._point.subtract(ft._point).isCollinear(se._point.subtract(Me._point))}function Ie(Ze){var Ve=k[Ze],ft=Ve.getPrevious(),rt=Ve.getNext();return ft._handleOut.isZero()&&Ve._handleIn.isZero()&&Ve._handleOut.isZero()&&rt._handleIn.isZero()&&Ve._point.subtract(ft._point).isOrthogonal(rt._point.subtract(Ve._point))}function Ee(Ze){var Ve=k[Ze],ft=Ve.getNext(),rt=Ve._handleOut,Me=ft._handleIn,se=.5522847498307936;if(rt.isOrthogonal(Me)){var ne=Ve._point,X=ft._point,ie=new Bt(ne,rt,!0).intersect(new Bt(X,Me,!0),!0);return ie&&oe.isZero(rt.getLength()/ie.subtract(ne).getLength()-se)&&oe.isZero(Me.getLength()/ie.subtract(X).getLength()-se)}return!1}function ze(Ze,Ve){return k[Ze]._point.getDistance(k[Ve]._point)}if(!this.hasHandles()&&k.length===4&&ve(0,2)&&ve(1,3)&&Ie(1)?(V=xt.Rectangle,$=new lt(ze(0,3),ze(0,1)),Ae=k[1]._point.add(k[2]._point).divide(2)):k.length===8&&Ee(0)&&Ee(2)&&Ee(4)&&Ee(6)&&ve(1,5)&&ve(3,7)?(V=xt.Rectangle,$=new lt(ze(1,6),ze(0,3)),te=$.subtract(new lt(ze(0,7),ze(1,2))).divide(2),Ae=k[3]._point.add(k[4]._point).divide(2)):k.length===4&&Ee(0)&&Ee(1)&&Ee(2)&&Ee(3)&&(oe.isZero(ze(0,2)-ze(1,3))?(V=xt.Circle,te=ze(0,2)/2):(V=xt.Ellipse,te=new lt(ze(2,0)/2,ze(3,1)/2)),Ae=k[1]._point),V){var Qe=this.getPosition(!0),He=new V({center:Qe,size:$,radius:te,insert:!1});return He.copyAttributes(this,!0),He._matrix.prepend(this._matrix),He.rotate(Ae.subtract(Qe).getAngle()+90),(v===n||v)&&He.insertAbove(this),He}return null},toPath:"#clone",compare:function v(k){if(!k||k instanceof ci)return v.base.call(this,k);var V=this.getCurves(),$=k.getCurves(),te=V.length,Ae=$.length;if(!te||!Ae)return te==Ae;for(var ve=V[0].getValues(),Ie=[],Ee=0,ze,Qe=0,He,Ze=0;Ze<Ae;Ze++){var Me=$[Ze].getValues();Ie.push(Me);var Ve=at.getOverlaps(ve,Me);if(Ve){ze=!Ze&&Ve[0][0]>0?Ae-1:Ze,He=Ve[0][1];break}}for(var ft=Math.abs,rt=1e-8,Me=Ie[ze],se;ve&&Me;){var Ve=at.getOverlaps(ve,Me);if(Ve){var ne=Ve[0][0];if(ft(ne-Qe)<rt){Qe=Ve[1][0],Qe===1&&(ve=++Ee<te?V[Ee].getValues():null,Qe=0);var X=Ve[0][1];if(ft(X-He)<rt){if(se||(se=[ze,X]),He=Ve[1][1],He===1&&(++ze>=Ae&&(ze=0),Me=Ie[ze]||$[ze].getValues(),He=0),!ve)return se[0]===ze&&se[1]===He;continue}}}break}return!1},_hitTestSelf:function(v,k,V,$){var te=this,Ae=this.getStyle(),ve=this._segments,Ie=ve.length,Ee=this._closed,ze=k._tolerancePadding,Qe=ze,He,Ze,Ve,ft,rt,Me,se=k.stroke&&Ae.hasStroke(),ne=k.fill&&Ae.hasFill(),X=k.curves,ie=se?Ae.getStrokeWidth()/2:ne&&k.tolerance>0||X?0:null;ie!==null&&(ie>0?(He=Ae.getStrokeJoin(),Ze=Ae.getStrokeCap(),Ve=Ae.getMiterLimit(),Qe=Qe.add(Dt._getStrokePadding(ie,$))):He=Ze="round");function de(De,Ue){return v.subtract(De).divide(Ue).length<=1}function ye(De,Ue,ht){if(!k.selected||Ue.isSelected()){var Tt=De._point;if(Ue!==Tt&&(Ue=Ue.add(Tt)),de(Ue,Qe))return new dt(ht,te,{segment:De,point:Ue})}}function ge(De,Ue){return(Ue||k.segments)&&ye(De,De._point,"segment")||!Ue&&k.handles&&(ye(De,De._handleIn,"handle-in")||ye(De,De._handleOut,"handle-out"))}function Pe(De){ft.add(De)}function Fe(De){var Ue=Ee||De._index>0&&De._index<Ie-1;if((Ue?He:Ze)==="round")return de(De._point,Qe);if(ft=new Dt({internal:!0,closed:!0}),Ue?De.isSmooth()||Dt._addBevelJoin(De,He,ie,Ve,null,$,Pe,!0):Ze==="square"&&Dt._addSquareCap(De,Ze,ie,null,$,Pe,!0),!ft.isEmpty()){var ht;return ft.contains(v)||(ht=ft.getNearestLocation(v))&&de(ht.getPoint(),ze)}}if(k.ends&&!k.segments&&!Ee){if(Me=ge(ve[0],!0)||ge(ve[Ie-1],!0))return Me}else if(k.segments||k.handles){for(var Ne=0;Ne<Ie;Ne++)if(Me=ge(ve[Ne]))return Me}if(ie!==null){if(rt=this.getNearestLocation(v),rt){var Xe=rt.getTime();Xe===0||Xe===1&&Ie>1?Fe(rt.getSegment())||(rt=null):de(rt.getPoint(),Qe)||(rt=null)}if(!rt&&He==="miter"&&Ie>1)for(var Ne=0;Ne<Ie;Ne++){var Ye=ve[Ne];if(v.getDistance(Ye._point)<=Ve*ie&&Fe(Ye)){rt=Ye.getLocation();break}}}return!rt&&ne&&this._contains(v)||rt&&!se&&!X?new dt("fill",this):rt?new dt(se?"stroke":"curve",this,{location:rt,point:rt.getPoint()}):null}},b.each(at._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this.getLocationAt(k);return V&&V[v]()}},{beans:!1,getLocationOf:function(){for(var v=we.read(arguments),k=this.getCurves(),V=0,$=k.length;V<$;V++){var te=k[V].getLocationOf(v);if(te)return te}return null},getOffsetOf:function(){var v=this.getLocationOf.apply(this,arguments);return v?v.getOffset():null},getLocationAt:function(v){if(typeof v=="number"){for(var k=this.getCurves(),V=0,$=0,te=k.length;$<te;$++){var Ae=V,ve=k[$];if(V+=ve.getLength(),V>v)return ve.getLocationAt(v-Ae)}if(k.length>0&&v<=this.getLength())return new Nt(k[k.length-1],1)}else if(v&&v.getPath&&v.getPath()===this)return v;return null},getOffsetsWithTangent:function(){var v=we.read(arguments);if(v.isZero())return[];for(var k=[],V=0,$=this.getCurves(),te=0,Ae=$.length;te<Ae;te++){for(var ve=$[te],Ie=ve.getTimesWithTangent(v),Ee=0,ze=Ie.length;Ee<ze;Ee++){var Qe=V+ve.getOffsetAtTime(Ie[Ee]);k.indexOf(Qe)<0&&k.push(Qe)}V+=ve.length}return k}}),new function(){function v(V,$,te,Ae){if(Ae<=0)return;var ve=Ae/2,Ie=Ae-2,Ee=ve-1,ze=new Array(6),Qe,He;function Ze(ne){var X=ze[ne],ie=ze[ne+1];(Qe!=X||He!=ie)&&(V.beginPath(),V.moveTo(Qe,He),V.lineTo(X,ie),V.stroke(),V.beginPath(),V.arc(X,ie,ve,0,Math.PI*2,!0),V.fill())}for(var Ve=0,ft=$.length;Ve<ft;Ve++){var rt=$[Ve],Me=rt._selection;if(rt._transformCoordinates(te,ze),Qe=ze[0],He=ze[1],Me&2&&Ze(2),Me&4&&Ze(4),V.fillRect(Qe-ve,He-ve,Ae,Ae),Ie>0&&!(Me&1)){var se=V.fillStyle;V.fillStyle="#ffffff",V.fillRect(Qe-Ee,He-Ee,Ie,Ie),V.fillStyle=se}}}function k(V,$,te){var Ae=$._segments,ve=Ae.length,Ie=new Array(6),Ee=!0,ze,Qe,He,Ze,Ve,ft,rt,Me;function se(X){if(te)X._transformCoordinates(te,Ie),ze=Ie[0],Qe=Ie[1];else{var ie=X._point;ze=ie._x,Qe=ie._y}if(Ee)V.moveTo(ze,Qe),Ee=!1;else{if(te)Ve=Ie[2],ft=Ie[3];else{var de=X._handleIn;Ve=ze+de._x,ft=Qe+de._y}Ve===ze&&ft===Qe&&rt===He&&Me===Ze?V.lineTo(ze,Qe):V.bezierCurveTo(rt,Me,Ve,ft,ze,Qe)}if(He=ze,Ze=Qe,te)rt=Ie[4],Me=Ie[5];else{var de=X._handleOut;rt=He+de._x,Me=Ze+de._y}}for(var ne=0;ne<ve;ne++)se(Ae[ne]);$._closed&&ve>0&&se(Ae[0])}return{_draw:function(V,$,te,Ae){var ve=$.dontStart,Ie=$.dontFinish||$.clip,Ee=this.getStyle(),ze=Ee.hasFill(),Qe=Ee.hasStroke(),He=Ee.getDashArray(),Ze=!wn.support.nativeDash&&Qe&&He&&He.length;ve||V.beginPath(),(ze||Qe&&!Ze||Ie)&&(k(V,this,Ae),this._closed&&V.closePath());function Ve(X){return He[(X%Ze+Ze)%Ze]}if(!Ie&&(ze||Qe)&&(this._setStyles(V,$,te),ze&&(V.fill(Ee.getFillRule()),V.shadowColor="rgba(0,0,0,0)"),Qe)){if(Ze){ve||V.beginPath();for(var ft=new bi(this,.25,32,!1,Ae),rt=ft.length,Me=-Ee.getDashOffset(),se,ne=0;Me>0;)Me-=Ve(ne--)+Ve(ne--);for(;Me<rt;)se=Me+Ve(ne++),(Me>0||se>0)&&ft.drawPart(V,Math.max(Me,0),Math.max(se,0)),Me=se+Ve(ne++)}V.stroke()}},_drawSelected:function(V,$){V.beginPath(),k(V,this,$),V.stroke(),v(V,this._segments,$,wn.settings.handleSize)}}},new function(){function v(k){var V=k._segments;if(!V.length)throw new Error("Use a moveTo() command first");return V[V.length-1]}return{moveTo:function(){var k=this._segments;k.length===1&&this.removeSegment(0),k.length||this._add([new nt(we.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new nt(we.read(arguments))])},cubicCurveTo:function(){var k=arguments,V=we.read(k),$=we.read(k),te=we.read(k),Ae=v(this);Ae.setHandleOut(V.subtract(Ae._point)),this._add([new nt(te,$.subtract(te))])},quadraticCurveTo:function(){var k=arguments,V=we.read(k),$=we.read(k),te=v(this)._point;this.cubicCurveTo(V.add(te.subtract(V).multiply(1/3)),V.add($.subtract(V).multiply(1/3)),$)},curveTo:function(){var k=arguments,V=we.read(k),$=we.read(k),te=b.pick(b.read(k),.5),Ae=1-te,ve=v(this)._point,Ie=V.subtract(ve.multiply(Ae*Ae)).subtract($.multiply(te*te)).divide(2*te*Ae);if(Ie.isNaN())throw new Error("Cannot put a curve through points with parameter = "+te);this.quadraticCurveTo(Ie,$)},arcTo:function(){var k=arguments,V=Math.abs,$=Math.sqrt,te=v(this),Ae=te._point,ve=we.read(k),Ie,Ee=b.peek(k),ze=b.pick(Ee,!0),Qe,He,Ze,Ve;if(typeof ze=="boolean")var ft=Ae.add(ve).divide(2),Ie=ft.add(ft.subtract(Ae).rotate(ze?-90:90));else if(b.remain(k)<=2)Ie=ve,ve=we.read(k);else if(!Ae.equals(ve)){var rt=lt.read(k),Me=oe.isZero;if(Me(rt.width)||Me(rt.height))return this.lineTo(ve);var se=b.read(k),ze=!!b.read(k),ne=!!b.read(k),ft=Ae.add(ve).divide(2),X=Ae.subtract(ft).rotate(-se),ie=X.x,de=X.y,ye=V(rt.width),ge=V(rt.height),Pe=ye*ye,Fe=ge*ge,Ne=ie*ie,Xe=de*de,Ye=$(Ne/Pe+Xe/Fe);if(Ye>1&&(ye*=Ye,ge*=Ye,Pe=ye*ye,Fe=ge*ge),Ye=(Pe*Fe-Pe*Xe-Fe*Ne)/(Pe*Xe+Fe*Ne),V(Ye)<1e-12&&(Ye=0),Ye<0)throw new Error("Cannot create an arc with the given arguments");Qe=new we(ye*de/ge,-ge*ie/ye).multiply((ne===ze?-1:1)*$(Ye)).rotate(se).add(ft),Ve=new kt().translate(Qe).rotate(se).scale(ye,ge),Ze=Ve._inverseTransform(Ae),He=Ze.getDirectedAngle(Ve._inverseTransform(ve)),!ze&&He>0?He-=360:ze&&He<0&&(He+=360)}if(Ie){var De=new Bt(Ae.add(Ie).divide(2),Ie.subtract(Ae).rotate(90),!0),Ue=new Bt(Ie.add(ve).divide(2),ve.subtract(Ie).rotate(90),!0),ht=new Bt(Ae,ve),Tt=ht.getSide(Ie);if(Qe=De.intersect(Ue,!0),!Qe){if(!Tt)return this.lineTo(ve);throw new Error("Cannot create an arc with the given arguments")}Ze=Ae.subtract(Qe),He=Ze.getDirectedAngle(ve.subtract(Qe));var o=ht.getSide(Qe,!0);o===0?He=Tt*V(He):Tt===o&&(He+=He<0?360:-360)}if(He){for(var ke=1e-5,ai=V(He),di=ai>=360?4:Math.ceil((ai-ke)/90),Ai=He/di,Kt=Ai*Math.PI/360,oi=4/3*Math.sin(Kt)/(1+Math.cos(Kt)),Ri=[],vi=0;vi<=di;vi++){var X=ve,wi=null;if(vi<di&&(wi=Ze.rotate(90).multiply(oi),Ve?(X=Ve._transformPoint(Ze),wi=Ve._transformPoint(Ze.add(wi)).subtract(X)):X=Qe.add(Ze)),!vi)te.setHandleOut(wi);else{var Yt=Ze.rotate(-90).multiply(oi);Ve&&(Yt=Ve._transformPoint(Ze.add(Yt)).subtract(X)),Ri.push(new nt(X,Yt,wi))}Ze=Ze.rotate(Ai)}this._add(Ri)}},lineBy:function(){var k=we.read(arguments),V=v(this)._point;this.lineTo(V.add(k))},curveBy:function(){var k=arguments,V=we.read(k),$=we.read(k),te=b.read(k),Ae=v(this)._point;this.curveTo(Ae.add(V),Ae.add($),te)},cubicCurveBy:function(){var k=arguments,V=we.read(k),$=we.read(k),te=we.read(k),Ae=v(this)._point;this.cubicCurveTo(Ae.add(V),Ae.add($),Ae.add(te))},quadraticCurveBy:function(){var k=arguments,V=we.read(k),$=we.read(k),te=v(this)._point;this.quadraticCurveTo(te.add(V),te.add($))},arcBy:function(){var k=arguments,V=v(this)._point,$=V.add(we.read(k)),te=b.pick(b.peek(k),!0);typeof te=="boolean"?this.arcTo($,te):this.arcTo($,V.add(we.read(k)))},closePath:function(k){this.setClosed(!0),this.join(this,k)}}},{_getBounds:function(v,k){var V=k.handle?"getHandleBounds":k.stroke?"getStrokeBounds":"getBounds";return Dt[V](this._segments,this._closed,this,v,k)},statics:{getBounds:function(v,k,V,$,te,Ae){var ve=v[0];if(!ve)return new st;var Ie=new Array(6),Ee=ve._transformCoordinates($,new Array(6)),ze=Ee.slice(0,2),Qe=ze.slice(),He=new Array(2);function Ze(rt){rt._transformCoordinates($,Ie);for(var Me=0;Me<2;Me++)at._addBounds(Ee[Me],Ee[Me+4],Ie[Me+2],Ie[Me],Me,Ae?Ae[Me]:0,ze,Qe,He);var se=Ee;Ee=Ie,Ie=se}for(var Ve=1,ft=v.length;Ve<ft;Ve++)Ze(v[Ve]);return k&&Ze(ve),new st(ze[0],ze[1],Qe[0]-ze[0],Qe[1]-ze[1])},getStrokeBounds:function(v,k,V,$,te){var Ae=V.getStyle(),ve=Ae.hasStroke(),Ie=Ae.getStrokeWidth(),Ee=ve&&V._getStrokeMatrix($,te),ze=ve&&Dt._getStrokePadding(Ie,Ee),Qe=Dt.getBounds(v,k,V,$,te,ze);if(!ve)return Qe;var He=Ie/2,Ze=Ae.getStrokeJoin(),Ve=Ae.getStrokeCap(),ft=Ae.getMiterLimit(),rt=new st(new lt(ze));function Me(ye){Qe=Qe.include(ye)}function se(ye){Qe=Qe.unite(rt.setCenter(ye._point.transform($)))}function ne(ye,ge){ge==="round"||ye.isSmooth()?se(ye):Dt._addBevelJoin(ye,ge,He,ft,$,Ee,Me)}function X(ye,ge){ge==="round"?se(ye):Dt._addSquareCap(ye,ge,He,$,Ee,Me)}var ie=v.length-(k?0:1);if(ie>0){for(var de=1;de<ie;de++)ne(v[de],Ze);k?ne(v[0],Ze):(X(v[0],Ve),X(v[v.length-1],Ve))}return Qe},_getStrokePadding:function(v,k){if(!k)return[v,v];var V=new we(v,0).transform(k),$=new we(0,v).transform(k),te=V.getAngleInRadians(),Ae=V.getLength(),ve=$.getLength(),Ie=Math.sin(te),Ee=Math.cos(te),ze=Math.tan(te),Qe=Math.atan2(ve*ze,Ae),He=Math.atan2(ve,ze*Ae);return[Math.abs(Ae*Math.cos(Qe)*Ee+ve*Math.sin(Qe)*Ie),Math.abs(ve*Math.sin(He)*Ee+Ae*Math.cos(He)*Ie)]},_addBevelJoin:function(v,k,V,$,te,Ae,ve,Ie){var Ee=v.getCurve(),ze=Ee.getPrevious(),Qe=Ee.getPoint1().transform(te),He=ze.getNormalAtTime(1).multiply(V).transform(Ae),Ze=Ee.getNormalAtTime(0).multiply(V).transform(Ae),Ve=He.getDirectedAngle(Ze);if((Ve<0||Ve>=180)&&(He=He.negate(),Ze=Ze.negate()),Ie&&ve(Qe),ve(Qe.add(He)),k==="miter"){var ft=new Bt(Qe.add(He),new we(-He.y,He.x),!0).intersect(new Bt(Qe.add(Ze),new we(-Ze.y,Ze.x),!0),!0);ft&&Qe.getDistance(ft)<=$*V&&ve(ft)}ve(Qe.add(Ze))},_addSquareCap:function(v,k,V,$,te,Ae,ve){var Ie=v._point.transform($),Ee=v.getLocation(),ze=Ee.getNormal().multiply(Ee.getTime()===0?V:-V).transform(te);k==="square"&&(ve&&(Ae(Ie.subtract(ze)),Ae(Ie.add(ze))),Ie=Ie.add(ze.rotate(-90))),Ae(Ie.add(ze)),Ae(Ie.subtract(ze))},getHandleBounds:function(v,k,V,$,te){var Ae=V.getStyle(),ve=te.stroke&&Ae.hasStroke(),Ie,Ee;if(ve){var ze=V._getStrokeMatrix($,te),Qe=Ae.getStrokeWidth()/2,He=Qe;Ae.getStrokeJoin()==="miter"&&(He=Qe*Ae.getMiterLimit()),Ae.getStrokeCap()==="square"&&(He=Math.max(He,Qe*Math.SQRT2)),Ie=Dt._getStrokePadding(Qe,ze),Ee=Dt._getStrokePadding(He,ze)}for(var Ze=new Array(6),Ve=1/0,ft=-Ve,rt=Ve,Me=ft,se=0,ne=v.length;se<ne;se++){var X=v[se];X._transformCoordinates($,Ze);for(var ie=0;ie<6;ie+=2){var de=ie?Ie:Ee,ye=de?de[0]:0,ge=de?de[1]:0,Pe=Ze[ie],Fe=Ze[ie+1],Ne=Pe-ye,Xe=Pe+ye,Ye=Fe-ge,De=Fe+ge;Ne<Ve&&(Ve=Ne),Xe>ft&&(ft=Xe),Ye<rt&&(rt=Ye),De>Me&&(Me=De)}}return new st(Ve,rt,ft-Ve,Me-rt)}}});Dt.inject({statics:new function(){var v=.5522847498307936,k=[new nt([-1,0],[0,v],[0,-v]),new nt([0,-1],[-v,0],[v,0]),new nt([1,0],[0,-v],[0,v]),new nt([0,1],[v,0],[-v,0])];function V(te,Ae,ve){var Ie=b.getNamed(ve),Ee=new Dt(Ie&&(Ie.insert==!0?Ge.INSERT:Ie.insert==!1?Ge.NO_INSERT:null));return Ee._add(te),Ee._closed=Ae,Ee.set(Ie,Ge.INSERT)}function $(te,Ae,ve){for(var Ie=new Array(4),Ee=0;Ee<4;Ee++){var ze=k[Ee];Ie[Ee]=new nt(ze._point.multiply(Ae).add(te),ze._handleIn.multiply(Ae),ze._handleOut.multiply(Ae))}return V(Ie,!0,ve)}return{Line:function(){var te=arguments;return V([new nt(we.readNamed(te,"from")),new nt(we.readNamed(te,"to"))],!1,te)},Circle:function(){var te=arguments,Ae=we.readNamed(te,"center"),ve=b.readNamed(te,"radius");return $(Ae,new lt(ve),te)},Rectangle:function(){var te=arguments,Ae=st.readNamed(te,"rectangle"),ve=lt.readNamed(te,"radius",0,{readNull:!0}),Ie=Ae.getBottomLeft(!0),Ee=Ae.getTopLeft(!0),ze=Ae.getTopRight(!0),Qe=Ae.getBottomRight(!0),He;if(!ve||ve.isZero())He=[new nt(Ie),new nt(Ee),new nt(ze),new nt(Qe)];else{ve=lt.min(ve,Ae.getSize(!0).divide(2));var Ze=ve.width,Ve=ve.height,ft=Ze*v,rt=Ve*v;He=[new nt(Ie.add(Ze,0),null,[-ft,0]),new nt(Ie.subtract(0,Ve),[0,rt]),new nt(Ee.add(0,Ve),null,[0,-rt]),new nt(Ee.add(Ze,0),[-ft,0],null),new nt(ze.subtract(Ze,0),null,[ft,0]),new nt(ze.add(0,Ve),[0,-rt],null),new nt(Qe.subtract(0,Ve),null,[0,rt]),new nt(Qe.subtract(Ze,0),[ft,0])]}return V(He,!0,te)},RoundRectangle:"#Rectangle",Ellipse:function(){var te=arguments,Ae=xt._readEllipse(te);return $(Ae.center,Ae.radius,te)},Oval:"#Ellipse",Arc:function(){var te=arguments,Ae=we.readNamed(te,"from"),ve=we.readNamed(te,"through"),Ie=we.readNamed(te,"to"),Ee=b.getNamed(te),ze=new Dt(Ee&&Ee.insert==!1&&Ge.NO_INSERT);return ze.moveTo(Ae),ze.arcTo(ve,Ie),ze.set(Ee)},RegularPolygon:function(){for(var te=arguments,Ae=we.readNamed(te,"center"),ve=b.readNamed(te,"sides"),Ie=b.readNamed(te,"radius"),Ee=360/ve,ze=ve%3===0,Qe=new we(0,ze?-Ie:Ie),He=ze?-1:.5,Ze=new Array(ve),Ve=0;Ve<ve;Ve++)Ze[Ve]=new nt(Ae.add(Qe.rotate((Ve+He)*Ee)));return V(Ze,!0,te)},Star:function(){for(var te=arguments,Ae=we.readNamed(te,"center"),ve=b.readNamed(te,"points")*2,Ie=b.readNamed(te,"radius1"),Ee=b.readNamed(te,"radius2"),ze=360/ve,Qe=new we(0,-1),He=new Array(ve),Ze=0;Ze<ve;Ze++)He[Ze]=new nt(Ae.add(Qe.rotate(ze*Ze).multiply(Ze%2?Ee:Ie)));return V(He,!0,te)}}}});var ci=Ft.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(k){this._children=[],this._namedChildren={},this._initialize(k)||(typeof k=="string"?this.setPathData(k):this.addChildren(Array.isArray(k)?k:arguments))},insertChildren:function v(k,V){var $=V,te=$[0];te&&typeof te[0]=="number"&&($=[$]);for(var Ae=V.length-1;Ae>=0;Ae--){var ve=$[Ae];$===V&&!(ve instanceof Dt)&&($=b.slice($)),Array.isArray(ve)?$[Ae]=new Dt({segments:ve,insert:!1}):ve instanceof ci&&($.splice.apply($,[Ae,1].concat(ve.removeChildren())),ve.remove())}return v.base.call(this,k,$)},reduce:function v(k){for(var V=this._children,$=V.length-1;$>=0;$--){var te=V[$].reduce(k);te.isEmpty()&&te.remove()}if(!V.length){var te=new Dt(Ge.NO_INSERT);return te.copyAttributes(this),te.insertAbove(this),this.remove(),te}return v.base.call(this)},isClosed:function(){for(var v=this._children,k=0,V=v.length;k<V;k++)if(!v[k]._closed)return!1;return!0},setClosed:function(v){for(var k=this._children,V=0,$=k.length;V<$;V++)k[V].setClosed(v)},getFirstSegment:function(){var v=this.getFirstChild();return v&&v.getFirstSegment()},getLastSegment:function(){var v=this.getLastChild();return v&&v.getLastSegment()},getCurves:function(){for(var v=this._children,k=[],V=0,$=v.length;V<$;V++)b.push(k,v[V].getCurves());return k},getFirstCurve:function(){var v=this.getFirstChild();return v&&v.getFirstCurve()},getLastCurve:function(){var v=this.getLastChild();return v&&v.getLastCurve()},getArea:function(){for(var v=this._children,k=0,V=0,$=v.length;V<$;V++)k+=v[V].getArea();return k},getLength:function(){for(var v=this._children,k=0,V=0,$=v.length;V<$;V++)k+=v[V].getLength();return k},getPathData:function(v,k){for(var V=this._children,$=[],te=0,Ae=V.length;te<Ae;te++){var ve=V[te],Ie=ve._matrix;$.push(ve.getPathData(v&&!Ie.isIdentity()?v.appended(Ie):v,k))}return $.join("")},_hitTestChildren:function v(k,V,$){return v.base.call(this,k,V.class===Dt||V.type==="path"?V:b.set({},V,{fill:!1}),$)},_draw:function(v,k,V,$){var te=this._children;if(te.length){k=k.extend({dontStart:!0,dontFinish:!0}),v.beginPath();for(var Ae=0,ve=te.length;Ae<ve;Ae++)te[Ae].draw(v,k,$);if(!k.clip){this._setStyles(v,k,V);var Ie=this._style;Ie.hasFill()&&(v.fill(Ie.getFillRule()),v.shadowColor="rgba(0,0,0,0)"),Ie.hasStroke()&&v.stroke()}}},_drawSelected:function(v,k,V){for(var $=this._children,te=0,Ae=$.length;te<Ae;te++){var ve=$[te],Ie=ve._matrix;V[ve._id]||ve._drawSelected(v,Ie.isIdentity()?k:k.appended(Ie))}}},new function(){function v(k,V){var $=k._children;if(V&&!$.length)throw new Error("Use a moveTo() command first");return $[$.length-1]}return b.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(k){this[k]=function(){var V=v(this,!0);V[k].apply(V,arguments)}},{moveTo:function(){var k=v(this),V=k&&k.isEmpty()?k:new Dt(Ge.NO_INSERT);V!==k&&this.addChild(V),V.moveTo.apply(V,arguments)},moveBy:function(){var k=v(this,!0),V=k&&k.getLastSegment(),$=we.read(arguments);this.moveTo(V?$.add(V._point):$)},closePath:function(k){v(this,!0).closePath(k)}})},b.each(["reverse","flatten","simplify","smooth"],function(v){this[v]=function(k){for(var V=this._children,$,te=0,Ae=V.length;te<Ae;te++)$=V[te][v](k)||$;return $}},{}));Ft.inject(new function(){var v=Math.min,k=Math.max,V=Math.abs,$={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function te(se){return se._children||[se]}function Ae(se,ne){var X=se.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(ne){for(var ie=te(X),de=0,ye=ie.length;de<ye;de++){var se=ie[de];!se._closed&&!se.isEmpty()&&(se.closePath(1e-12),se.getFirstSegment().setHandleIn(0,0),se.getLastSegment().setHandleOut(0,0))}X=X.resolveCrossings().reorient(X.getFillRule()==="nonzero",!0)}return X}function ve(se,ne,X,ie,de){var ye=new ci(Ge.NO_INSERT);return ye.addChildren(se,!0),ye=ye.reduce({simplify:ne}),de&&de.insert==!1||ye.insertAbove(ie&&X.isSibling(ie)&&X.getIndex()<ie.getIndex()?ie:X),ye.copyAttributes(X,!0),ye}function Ie(se){return se.hasOverlap()||se.isCrossing()}function Ee(se,ne,X,ie){if(ie&&(ie.trace==!1||ie.stroke)&&/^(subtract|intersect)$/.test(X))return ze(se,ne,X);var de=Ae(se,!0),ye=ne&&se!==ne&&Ae(ne,!0),ge=$[X];ge[X]=!0,ye&&(ge.subtract||ge.exclude)^(ye.isClockwise()^de.isClockwise())&&ye.reverse();var Pe=Ve(Nt.expand(de.getIntersections(ye,Ie))),Fe=te(de),Ne=ye&&te(ye),Xe=[],Ye=[],De;function Ue(wi){for(var Yt=0,vn=wi.length;Yt<vn;Yt++){var ar=wi[Yt];b.push(Xe,ar._segments),b.push(Ye,ar.getCurves()),ar._overlapsOnly=!0}}function ht(wi){for(var Yt=[],vn=0,ar=wi&&wi.length;vn<ar;vn++)Yt.push(Ye[wi[vn]]);return Yt}if(Pe.length){Ue(Fe),Ne&&Ue(Ne);for(var Tt=new Array(Ye.length),o=0,ke=Ye.length;o<ke;o++)Tt[o]=Ye[o].getValues();for(var ai=W.findCurveBoundsCollisions(Tt,Tt,0,!0),di={},o=0;o<Ye.length;o++){var Ai=Ye[o],Kt=Ai._path._id,oi=di[Kt]=di[Kt]||{};oi[Ai.getIndex()]={hor:ht(ai[o].hor),ver:ht(ai[o].ver)}}for(var o=0,ke=Pe.length;o<ke;o++)rt(Pe[o]._segment,de,ye,di,ge);for(var o=0,ke=Xe.length;o<ke;o++){var Ri=Xe[o],vi=Ri._intersection;Ri._winding||rt(Ri,de,ye,di,ge),vi&&vi._overlap||(Ri._path._overlapsOnly=!1)}De=Me(Xe,ge)}else De=Ze(Ne?Fe.concat(Ne):Fe.slice(),function(wi){return!!ge[wi]});return ve(De,!0,se,ne,ie)}function ze(se,ne,X){var ie=Ae(se),de=Ae(ne),ye=ie.getIntersections(de,Ie),ge=X==="subtract",Pe=X==="divide",Fe={},Ne=[];function Xe(Ue){if(!Fe[Ue._id]&&(Pe||de.contains(Ue.getPointAt(Ue.getLength()/2))^ge))return Ne.unshift(Ue),Fe[Ue._id]=!0}for(var Ye=ye.length-1;Ye>=0;Ye--){var De=ye[Ye].split();De&&(Xe(De)&&De.getFirstSegment().setHandleIn(0,0),ie.getLastSegment().setHandleOut(0,0))}return Xe(ie),ve(Ne,!1,se,ne)}function Qe(se,ne){for(var X=se;X;){if(X===ne)return;X=X._previous}for(;se._next&&se._next!==ne;)se=se._next;if(!se._next){for(;ne._previous;)ne=ne._previous;se._next=ne,ne._previous=se}}function He(se){for(var ne=se.length-1;ne>=0;ne--)se[ne].clearHandles()}function Ze(se,ne,X){var ie=se&&se.length;if(ie){var de=b.each(se,function(ai,di){this[ai._id]={container:null,winding:ai.isClockwise()?1:-1,index:di}},{}),ye=se.slice().sort(function(ai,di){return V(di.getArea())-V(ai.getArea())}),ge=ye[0],Pe=W.findItemBoundsCollisions(ye,null,oe.GEOMETRIC_EPSILON);X==null&&(X=ge.isClockwise());for(var Fe=0;Fe<ie;Fe++){var Ne=ye[Fe],Xe=de[Ne._id],Ye=0,De=Pe[Fe];if(De){for(var Ue=null,ht=De.length-1;ht>=0;ht--)if(De[ht]<Fe){Ue=Ue||Ne.getInteriorPoint();var Tt=ye[De[ht]];if(Tt.contains(Ue)){var o=de[Tt._id];Ye=o.winding,Xe.winding+=Ye,Xe.container=o.exclude?o.container:Tt;break}}}if(ne(Xe.winding)===ne(Ye))Xe.exclude=!0,se[Xe.index]=null;else{var ke=Xe.container;Ne.setClockwise(ke?!ke.isClockwise():X)}}}return se}function Ve(se,ne,X){var ie=ne&&[],de=1e-8,ye=1-de,ge=!1,Pe=X||[],Fe=X&&{},Ne,Xe,Ye;function De(Yt){return Yt._path._id+"."+Yt._segment1._index}for(var Ue=(X&&X.length)-1;Ue>=0;Ue--){var ht=X[Ue];ht._path&&(Fe[De(ht)]=!0)}for(var Ue=se.length-1;Ue>=0;Ue--){var Tt=se[Ue],o=Tt._time,ke=o,ai=ne&&!ne(Tt),ht=Tt._curve,di;if(ht&&(ht!==Xe?(ge=!ht.hasHandles()||Fe&&Fe[De(ht)],Ne=[],Ye=null,Xe=ht):Ye>=de&&(o/=Ye)),ai){Ne&&Ne.push(Tt);continue}else ne&&ie.unshift(Tt);if(Ye=ke,o<de)di=ht._segment1;else if(o>ye)di=ht._segment2;else{var Ai=ht.divideAtTime(o,!0);ge&&Pe.push(ht,Ai),di=Ai._segment1;for(var Kt=Ne.length-1;Kt>=0;Kt--){var oi=Ne[Kt];oi._time=(oi._time-o)/(1-o)}}Tt._setSegment(di);var Ri=di._intersection,vi=Tt._intersection;if(Ri){Qe(Ri,vi);for(var wi=Ri;wi;)Qe(wi._intersection,Ri),wi=wi._next}else di._intersection=vi}return X||He(Pe),ie||se}function ft(se,ne,X,ie,de){var ye=Array.isArray(ne)?ne:ne[X?"hor":"ver"],ge=X?1:0,Pe=ge^1,Fe=[se.x,se.y],Ne=Fe[ge],Xe=Fe[Pe],Ye=1e-9,De=1e-6,Ue=Ne-Ye,ht=Ne+Ye,Tt=0,o=0,ke=0,ai=0,di=!1,Ai=!1,Kt=1,oi=[],Ri,vi;function wi(Qt){var Yi=Qt[Pe+0],Ut=Qt[Pe+6];if(!(Xe<v(Yi,Ut)||Xe>k(Yi,Ut))){var En=Qt[ge+0],ur=Qt[ge+2],Ns=Qt[ge+4],Vr=Qt[ge+6];if(Yi===Ut){(En<ht&&Vr>Ue||Vr<ht&&En>Ue)&&(di=!0);return}var Vt=Xe===Yi?0:Xe===Ut||Ue>k(En,ur,Ns,Vr)||ht<v(En,ur,Ns,Vr)?1:at.solveCubic(Qt,Pe,Xe,oi,0,1)>0?oi[0]:1,cr=Vt===0?En:Vt===1?Vr:at.getPoint(Qt,Vt)[X?"y":"x"],Lt=Yi>Ut?1:-1,Br=Ri[Pe]>Ri[Pe+6]?1:-1,Vs=Ri[ge+6];return Xe!==Yi?(cr<Ue?ke+=Lt:cr>ht?ai+=Lt:di=!0,cr>Ne-De&&cr<Ne+De&&(Kt/=2)):(Lt!==Br?En<Ue?ke+=Lt:En>ht&&(ai+=Lt):En!=Vs&&(Vs<ht&&cr>ht?(ai+=Lt,di=!0):Vs>Ue&&cr<Ue&&(ke+=Lt,di=!0)),Kt/=4),Ri=Qt,!de&&cr>Ue&&cr<ht&&at.getTangent(Qt,Vt)[X?"x":"y"]===0&&ft(se,ne,!X,ie,!0)}}function Yt(Qt){var Yi=Qt[Pe+0],Ut=Qt[Pe+2],En=Qt[Pe+4],ur=Qt[Pe+6];if(Xe<=k(Yi,Ut,En,ur)&&Xe>=v(Yi,Ut,En,ur)){for(var Ns=Qt[ge+0],Vr=Qt[ge+2],Vt=Qt[ge+4],cr=Qt[ge+6],Lt=Ue>k(Ns,Vr,Vt,cr)||ht<v(Ns,Vr,Vt,cr)?[Qt]:at.getMonoCurves(Qt,X),Br,Vs=0,ua=Lt.length;Vs<ua;Vs++)if(Br=wi(Lt[Vs]))return Br}}for(var vn=0,ar=ye.length;vn<ar;vn++){var dn=ye[vn],Vn=dn._path,Hr=dn.getValues(),Hi;if((!vn||ye[vn-1]._path!==Vn)&&(Ri=null,Vn._closed||(vi=at.getValues(Vn.getLastCurve().getSegment2(),dn.getSegment1(),null,!ie),vi[Pe]!==vi[Pe+6]&&(Ri=vi)),!Ri)){Ri=Hr;for(var lr=Vn.getLastCurve();lr&&lr!==dn;){var Fn=lr.getValues();if(Fn[Pe]!==Fn[Pe+6]){Ri=Fn;break}lr=lr.getPrevious()}}if(Hi=Yt(Hr))return Hi;if(vn+1===ar||ye[vn+1]._path!==Vn){if(vi&&(Hi=Yt(vi)))return Hi;di&&!ke&&!ai&&(ke=ai=Vn.isClockwise(ie)^X?1:-1),Tt+=ke,o+=ai,ke=ai=0,di&&(Ai=!0,di=!1),vi=null}}return Tt=V(Tt),o=V(o),{winding:k(Tt,o),windingL:Tt,windingR:o,quality:Kt,onPath:Ai}}function rt(se,ne,X,ie,de){var ye=[],ge=se,Pe=0,Ye;do{var Fe=se.getCurve();if(Fe){var Ne=Fe.getLength();ye.push({segment:se,curve:Fe,length:Ne}),Pe+=Ne}se=se.getNext()}while(se&&!se._intersection&&se!==ge);for(var Xe=[.5,.25,.75],Ye={winding:0,quality:-1},De=.001,Ue=1-De,ht=0;ht<Xe.length&&Ye.quality<.5;ht++)for(var Ne=Pe*Xe[ht],Tt=0,o=ye.length;Tt<o;Tt++){var ke=ye[Tt],ai=ke.length;if(Ne<=ai){var Fe=ke.curve,di=Fe._path,Ai=di._parent,Kt=Ai instanceof ci?Ai:di,oi=oe.clamp(Fe.getTimeAt(Ne),De,Ue),Ri=Fe.getPointAtTime(oi),vi=V(Fe.getTangentAtTime(oi).y)<Math.SQRT1_2,wi=null;if(de.subtract&&X){var Yt=Kt===ne?X:ne,vn=Yt._getWinding(Ri,vi,!0);if(Kt===ne&&vn.winding||Kt===X&&!vn.winding){if(vn.quality<1)continue;wi={winding:0,quality:1}}}wi=wi||ft(Ri,ie[di._id][Fe.getIndex()],vi,!0),wi.quality>Ye.quality&&(Ye=wi);break}Ne-=ai}for(var Tt=ye.length-1;Tt>=0;Tt--)ye[Tt].segment._winding=Ye}function Me(se,ne){var X=[],ie;function de(ar){var dn;return!!(ar&&!ar._visited&&(!ne||ne[(dn=ar._winding||{}).winding]&&!(ne.unite&&dn.winding===2&&dn.windingL&&dn.windingR)))}function ye(ar){if(ar){for(var dn=0,Vn=ie.length;dn<Vn;dn++)if(ar===ie[dn])return!0}return!1}function ge(ar){for(var dn=ar._segments,Vn=0,Hr=dn.length;Vn<Hr;Vn++)dn[Vn]._visited=!0}function Pe(ar,dn){var Vn=ar._intersection,Hr=Vn,Hi=[];dn&&(ie=[ar]);function lr(Fn,Qt){for(;Fn&&Fn!==Qt;){var Yi=Fn._segment,Ut=Yi&&Yi._path;if(Ut){var En=Yi.getNext()||Ut.getFirstSegment(),ur=En._intersection;Yi!==ar&&(ye(Yi)||ye(En)||En&&de(Yi)&&(de(En)||ur&&de(ur._segment)))&&Hi.push(Yi),dn&&ie.push(Yi)}Fn=Fn._next}}if(Vn){for(lr(Vn);Vn&&Vn._previous;)Vn=Vn._previous;lr(Vn,Hr)}return Hi}se.sort(function(ar,dn){var Vn=ar._intersection,Hr=dn._intersection,Hi=!!(Vn&&Vn._overlap),lr=!!(Hr&&Hr._overlap),Fn=ar._path,Qt=dn._path;return Hi^lr?Hi?1:-1:!Vn^!Hr?Vn?1:-1:Fn!==Qt?Fn._id-Qt._id:ar._index-dn._index});for(var Fe=0,Ne=se.length;Fe<Ne;Fe++){var Xe=se[Fe],Ye=de(Xe),De=null,Ue=!1,ht=!0,Tt=[],o,ke,ai;if(Ye&&Xe._path._overlapsOnly){var di=Xe._path,Ai=Xe._intersection._segment._path;di.compare(Ai)&&(di.getArea()&&X.push(di.clone(!1)),ge(di),ge(Ai),Ye=!1)}for(;Ye;){var Kt=!De,oi=Pe(Xe,Kt),Ri=oi.shift(),Ue=!Kt&&(ye(Xe)||ye(Ri)),vi=!Ue&&Ri;if(Kt&&(De=new Dt(Ge.NO_INSERT),o=null),Ue){(Xe.isFirst()||Xe.isLast())&&(ht=Xe._path._closed),Xe._visited=!0;break}if(vi&&o&&(Tt.push(o),o=null),o||(vi&&oi.push(Xe),o={start:De._segments.length,crossings:oi,visited:ke=[],handleIn:ai}),vi&&(Xe=Ri),!de(Xe)){De.removeSegments(o.start);for(var wi=0,Yt=ke.length;wi<Yt;wi++)ke[wi]._visited=!1;ke.length=0;do Xe=o&&o.crossings.shift(),(!Xe||!Xe._path)&&(Xe=null,o=Tt.pop(),o&&(ke=o.visited,ai=o.handleIn));while(o&&!de(Xe));if(!Xe)break}var vn=Xe.getNext();De.add(new nt(Xe._point,ai,vn&&Xe._handleOut)),Xe._visited=!0,ke.push(Xe),Xe=vn||Xe._path.getFirstSegment(),ai=vn&&vn._handleIn}Ue&&(ht&&(De.getFirstSegment().setHandleIn(ai),De.setClosed(ht)),De.getArea()!==0&&X.push(De))}return X}return{_getWinding:function(se,ne,X){return ft(se,this.getCurves(),ne,X)},unite:function(se,ne){return Ee(this,se,"unite",ne)},intersect:function(se,ne){return Ee(this,se,"intersect",ne)},subtract:function(se,ne){return Ee(this,se,"subtract",ne)},exclude:function(se,ne){return Ee(this,se,"exclude",ne)},divide:function(se,ne){return ne&&(ne.trace==!1||ne.stroke)?ze(this,se,"divide"):ve([this.subtract(se,ne),this.intersect(se,ne)],!0,this,se,ne)},resolveCrossings:function(){var se=this._children,ne=se||[this];function X(o,ke){var ai=o&&o._intersection;return ai&&ai._overlap&&ai._path===ke}var ie=!1,de=!1,ye=this.getIntersections(null,function(o){return o.hasOverlap()&&(ie=!0)||o.isCrossing()&&(de=!0)}),ge=ie&&de&&[];if(ye=Nt.expand(ye),ie)for(var Pe=Ve(ye,function(o){return o.hasOverlap()},ge),Fe=Pe.length-1;Fe>=0;Fe--){var Ne=Pe[Fe],Xe=Ne._path,Ye=Ne._segment,De=Ye.getPrevious(),Ue=Ye.getNext();X(De,Xe)&&X(Ue,Xe)&&(Ye.remove(),De._handleOut._set(0,0),Ue._handleIn._set(0,0),De!==Ye&&!De.getCurve().hasLength()&&(Ue._handleIn.set(De._handleIn),De.remove()))}de&&(Ve(ye,ie&&function(o){var ke=o.getCurve(),ai=o.getSegment(),di=o._intersection,Ai=di._curve,Kt=di._segment;if(ke&&Ai&&ke._path&&Ai._path)return!0;ai&&(ai._intersection=null),Kt&&(Kt._intersection=null)},ge),ge&&He(ge),ne=Me(b.each(ne,function(o){b.push(this,o._segments)},[])));var ht=ne.length,Tt;return ht>1&&se?(ne!==se&&this.setChildren(ne),Tt=this):ht===1&&!se&&(ne[0]!==this&&this.setSegments(ne[0].removeSegments()),Tt=this),Tt||(Tt=new ci(Ge.NO_INSERT),Tt.addChildren(ne),Tt=Tt.reduce(),Tt.copyAttributes(this),this.replaceWith(Tt)),Tt},reorient:function(se,ne){var X=this._children;return X&&X.length?this.setChildren(Ze(this.removeChildren(),function(ie){return!!(se?ie:ie&1)},ne)):ne!==n&&this.setClockwise(ne),this},getInteriorPoint:function(){var se=this.getBounds(),ne=se.getCenter(!0);if(!this.contains(ne)){for(var X=this.getCurves(),ie=ne.y,de=[],ye=[],ge=0,Pe=X.length;ge<Pe;ge++){var Fe=X[ge].getValues(),Ne=Fe[1],Xe=Fe[3],Ye=Fe[5],De=Fe[7];if(ie>=v(Ne,Xe,Ye,De)&&ie<=k(Ne,Xe,Ye,De))for(var Ue=at.getMonoCurves(Fe),ht=0,Tt=Ue.length;ht<Tt;ht++){var o=Ue[ht],ke=o[1],ai=o[7];if(ke!==ai&&(ie>=ke&&ie<=ai||ie>=ai&&ie<=ke)){var di=ie===ke?o[0]:ie===ai?o[6]:at.solveCubic(o,1,ie,ye,0,1)===1?at.getPoint(o,ye[0]).x:(o[0]+o[6])/2;de.push(di)}}}de.length>1&&(de.sort(function(Ai,Kt){return Ai-Kt}),ne.x=(de[0]+de[1])/2)}return ne}}});var bi=b.extend({_class:"PathFlattener",initialize:function(v,k,V,$,te){var Ae=[],ve=[],Ie=0,Ee=1/(V||32),ze=v._segments,Qe=ze[0],He;function Ze(Me,se){var ne=at.getValues(Me,se,te);Ae.push(ne),Ve(ne,Me._index,0,1)}function Ve(Me,se,ne,X){if(X-ne>Ee&&!($&&at.isStraight(Me))&&!at.isFlatEnough(Me,k||.25)){var ie=at.subdivide(Me,.5),de=(ne+X)/2;Ve(ie[0],se,ne,de),Ve(ie[1],se,de,X)}else{var ye=Me[6]-Me[0],ge=Me[7]-Me[1],Pe=Math.sqrt(ye*ye+ge*ge);Pe>0&&(Ie+=Pe,ve.push({offset:Ie,curve:Me,index:se,time:X}))}}for(var ft=1,rt=ze.length;ft<rt;ft++)He=ze[ft],Ze(Qe,He),Qe=He;v._closed&&Ze(He||Qe,ze[0]),this.curves=Ae,this.parts=ve,this.length=Ie,this.index=0},_get:function(v){for(var k=this.parts,V=k.length,$,te=this.index;$=te,!(!te||k[--te].offset<v););for(;$<V;$++){var Ae=k[$];if(Ae.offset>=v){this.index=$;var ve=k[$-1],Ie=ve&&ve.index===Ae.index?ve.time:0,Ee=ve?ve.offset:0;return{index:Ae.index,time:Ie+(Ae.time-Ie)*(v-Ee)/(Ae.offset-Ee)}}}return{index:k[V-1].index,time:1}},drawPart:function(v,k,V){for(var $=this._get(k),te=this._get(V),Ae=$.index,ve=te.index;Ae<=ve;Ae++){var Ie=at.getPart(this.curves[Ae],Ae===$.index?$.time:0,Ae===te.index?te.time:1);Ae===$.index&&v.moveTo(Ie[0],Ie[1]),v.bezierCurveTo.apply(v,Ie.slice(2))}}},b.each(at._evaluateMethods,function(v){this[v+"At"]=function(k){var V=this._get(k);return at[v](this.curves[V.index],V.time)}},{})),ki=b.extend({initialize:function(v){for(var k=this.points=[],V=v._segments,$=v._closed,te=0,Ae,ve=V.length;te<ve;te++){var Ie=V[te].point;(!Ae||!Ae.equals(Ie))&&k.push(Ae=Ie.clone())}$&&(k.unshift(k[k.length-1]),k.push(k[1])),this.closed=$},fit:function(v){var k=this.points,V=k.length,$=null;return V>0&&($=[new nt(k[0])],V>1&&(this.fitCubic($,v,0,V-1,k[1].subtract(k[0]),k[V-2].subtract(k[V-1])),this.closed&&($.shift(),$.pop()))),$},fitCubic:function(v,k,V,$,te,Ae){var ve=this.points;if($-V===1){var Ie=ve[V],Ee=ve[$],ze=Ie.getDistance(Ee)/3;this.addCurve(v,[Ie,Ie.add(te.normalize(ze)),Ee.add(Ae.normalize(ze)),Ee]);return}for(var Qe=this.chordLengthParameterize(V,$),He=Math.max(k,k*k),Ze,Ve=!0,ft=0;ft<=4;ft++){var rt=this.generateBezier(V,$,Qe,te,Ae),Me=this.findMaxError(V,$,rt,Qe);if(Me.error<k&&Ve){this.addCurve(v,rt);return}if(Ze=Me.index,Me.error>=He)break;Ve=this.reparameterize(V,$,Qe,rt),He=Me.error}var se=ve[Ze-1].subtract(ve[Ze+1]);this.fitCubic(v,k,V,Ze,te,se),this.fitCubic(v,k,Ze,$,se.negate(),Ae)},addCurve:function(v,k){var V=v[v.length-1];V.setHandleOut(k[1].subtract(k[0])),v.push(new nt(k[3],k[2].subtract(k[3])))},generateBezier:function(v,k,V,$,te){for(var Ae=1e-12,ve=Math.abs,Ie=this.points,Ee=Ie[v],ze=Ie[k],Qe=[[0,0],[0,0]],He=[0,0],Ze=0,Ve=k-v+1;Ze<Ve;Ze++){var ft=V[Ze],rt=1-ft,Me=3*ft*rt,se=rt*rt*rt,ne=Me*rt,X=Me*ft,ie=ft*ft*ft,de=$.normalize(ne),ye=te.normalize(X),ge=Ie[v+Ze].subtract(Ee.multiply(se+ne)).subtract(ze.multiply(X+ie));Qe[0][0]+=de.dot(de),Qe[0][1]+=de.dot(ye),Qe[1][0]=Qe[0][1],Qe[1][1]+=ye.dot(ye),He[0]+=de.dot(ge),He[1]+=ye.dot(ge)}var Pe=Qe[0][0]*Qe[1][1]-Qe[1][0]*Qe[0][1],Fe,Ne;if(ve(Pe)>Ae){var Xe=Qe[0][0]*He[1]-Qe[1][0]*He[0],Ye=He[0]*Qe[1][1]-He[1]*Qe[0][1];Fe=Ye/Pe,Ne=Xe/Pe}else{var De=Qe[0][0]+Qe[0][1],Ue=Qe[1][0]+Qe[1][1];Fe=Ne=ve(De)>Ae?He[0]/De:ve(Ue)>Ae?He[1]/Ue:0}var ht=ze.getDistance(Ee),Tt=Ae*ht,o,ke;if(Fe<Tt||Ne<Tt)Fe=Ne=ht/3;else{var ai=ze.subtract(Ee);o=$.normalize(Fe),ke=te.normalize(Ne),o.dot(ai)-ke.dot(ai)>ht*ht&&(Fe=Ne=ht/3,o=ke=null)}return[Ee,Ee.add(o||$.normalize(Fe)),ze.add(ke||te.normalize(Ne)),ze]},reparameterize:function(v,k,V,$){for(var te=v;te<=k;te++)V[te-v]=this.findRoot($,this.points[te],V[te-v]);for(var te=1,Ae=V.length;te<Ae;te++)if(V[te]<=V[te-1])return!1;return!0},findRoot:function(v,k,V){for(var $=[],te=[],Ae=0;Ae<=2;Ae++)$[Ae]=v[Ae+1].subtract(v[Ae]).multiply(3);for(var Ae=0;Ae<=1;Ae++)te[Ae]=$[Ae+1].subtract($[Ae]).multiply(2);var ve=this.evaluate(3,v,V),Ie=this.evaluate(2,$,V),Ee=this.evaluate(1,te,V),ze=ve.subtract(k),Qe=Ie.dot(Ie)+ze.dot(Ee);return oe.isMachineZero(Qe)?V:V-ze.dot(Ie)/Qe},evaluate:function(v,k,V){for(var $=k.slice(),te=1;te<=v;te++)for(var Ae=0;Ae<=v-te;Ae++)$[Ae]=$[Ae].multiply(1-V).add($[Ae+1].multiply(V));return $[0]},chordLengthParameterize:function(v,k){for(var V=[0],$=v+1;$<=k;$++)V[$-v]=V[$-v-1]+this.points[$].getDistance(this.points[$-1]);for(var $=1,te=k-v;$<=te;$++)V[$]/=V[te];return V},findMaxError:function(v,k,V,$){for(var te=Math.floor((k-v+1)/2),Ae=0,ve=v+1;ve<k;ve++){var Ie=this.evaluate(3,V,$[ve-v]),Ee=Ie.subtract(this.points[ve]),ze=Ee.x*Ee.x+Ee.y*Ee.y;ze>=Ae&&(Ae=ze,te=ve)}return{error:Ae,index:te}}}),Gi=Ge.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(k){this._content="",this._lines=[];var V=k&&b.isPlainObject(k)&&k.x===n&&k.y===n;this._initialize(V&&k,!V&&we.read(arguments))},_equals:function(v){return this._content===v._content},copyContent:function(v){this.setContent(v._content)},getContent:function(){return this._content},setContent:function(v){this._content=""+v,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),rn=Gi.extend({_class:"PointText",initialize:function(){Gi.apply(this,arguments)},getPoint:function(){var v=this._matrix.getTranslation();return new et(v.x,v.y,this,"setPoint")},setPoint:function(){var v=we.read(arguments);this.translate(v.subtract(this._matrix.getTranslation()))},_draw:function(v,k,V){if(this._content){this._setStyles(v,k,V);var $=this._lines,te=this._style,Ae=te.hasFill(),ve=te.hasStroke(),Ie=te.getLeading(),Ee=v.shadowColor;v.font=te.getFontStyle(),v.textAlign=te.getJustification();for(var ze=0,Qe=$.length;ze<Qe;ze++){v.shadowColor=Ee;var He=$[ze];Ae&&(v.fillText(He,0,0),v.shadowColor="rgba(0,0,0,0)"),ve&&v.strokeText(He,0,0),v.translate(0,Ie)}}},_getBounds:function(v,k){var V=this._style,$=this._lines,te=$.length,Ae=V.getJustification(),ve=V.getLeading(),Ie=this.getView().getTextWidth(V.getFontStyle(),$),Ee=0;Ae!=="left"&&(Ee-=Ie/(Ae==="center"?2:1));var ze=new st(Ee,te?-.75*ve:0,Ie,te*ve);return v?v._transformBounds(ze,ze):ze}}),$i=b.extend(new function(){var v={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},k={},V={transparent:[0,0,0,0]},$;function te(Ie){var Ee=Ie.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||Ie.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),ze="rgb",Qe;if(Ee){var He=Ee[4]?4:3;Qe=new Array(He);for(var Ze=0;Ze<He;Ze++){var Ve=Ee[Ze+1];Qe[Ze]=parseInt(Ve.length==1?Ve+Ve:Ve,16)/255}}else if(Ee=Ie.match(/^(rgb|hsl)a?\((.*)\)$/)){ze=Ee[1],Qe=Ee[2].trim().split(/[,\s]+/g);for(var ft=ze==="hsl",Ze=0,rt=Math.min(Qe.length,4);Ze<rt;Ze++){var Me=Qe[Ze],Ve=parseFloat(Me);if(ft)if(Ze===0){var se=Me.match(/([a-z]*)$/)[1];Ve*={turn:360,rad:180/Math.PI,grad:.9}[se]||1}else Ze<3&&(Ve/=100);else Ze<3&&(Ve/=/%$/.test(Me)?100:255);Qe[Ze]=Ve}}else{var ne=V[Ie];if(!ne)if(c){$||($=ln.getContext(1,1,{willReadFrequently:!0}),$.globalCompositeOperation="copy"),$.fillStyle="rgba(0,0,0,0)",$.fillStyle=Ie,$.fillRect(0,0,1,1);var X=$.getImageData(0,0,1,1).data;ne=V[Ie]=[X[0]/255,X[1]/255,X[2]/255]}else ne=[0,0,0];Qe=ne.slice()}return[ze,Qe]}var Ae=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],ve={"rgb-hsb":function(Ie,Ee,ze){var Qe=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Ze=Qe-He,Ve=Ze===0?0:(Qe==Ie?(Ee-ze)/Ze+(Ee<ze?6:0):Qe==Ee?(ze-Ie)/Ze+2:(Ie-Ee)/Ze+4)*60;return[Ve,Qe===0?0:Ze/Qe,Qe]},"hsb-rgb":function(Ie,Ee,ze){Ie=(Ie/60%6+6)%6;var He=Math.floor(Ie),Qe=Ie-He,He=Ae[He],Ze=[ze,ze*(1-Ee),ze*(1-Ee*Qe),ze*(1-Ee*(1-Qe))];return[Ze[He[0]],Ze[He[1]],Ze[He[2]]]},"rgb-hsl":function(Ie,Ee,ze){var Qe=Math.max(Ie,Ee,ze),He=Math.min(Ie,Ee,ze),Ze=Qe-He,Ve=Ze===0,ft=Ve?0:(Qe==Ie?(Ee-ze)/Ze+(Ee<ze?6:0):Qe==Ee?(ze-Ie)/Ze+2:(Ie-Ee)/Ze+4)*60,rt=(Qe+He)/2,Me=Ve?0:rt<.5?Ze/(Qe+He):Ze/(2-Qe-He);return[ft,Me,rt]},"hsl-rgb":function(Ie,Ee,ze){if(Ie=(Ie/360%1+1)%1,Ee===0)return[ze,ze,ze];for(var Qe=[Ie+1/3,Ie,Ie-1/3],He=ze<.5?ze*(1+Ee):ze+Ee-ze*Ee,Ze=2*ze-He,Ve=[],ft=0;ft<3;ft++){var rt=Qe[ft];rt<0&&(rt+=1),rt>1&&(rt-=1),Ve[ft]=6*rt<1?Ze+(He-Ze)*6*rt:2*rt<1?He:3*rt<2?Ze+(He-Ze)*(2/3-rt)*6:Ze}return Ve},"rgb-gray":function(Ie,Ee,ze){return[Ie*.2989+Ee*.587+ze*.114]},"gray-rgb":function(Ie){return[Ie,Ie,Ie]},"gray-hsb":function(Ie){return[0,0,Ie]},"gray-hsl":function(Ie){return[0,0,Ie]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return b.each(v,function(Ie,Ee){k[Ee]=[],b.each(Ie,function(ze,Qe){var He=b.capitalize(ze),Ze=/^(hue|saturation)$/.test(ze),Ve=k[Ee][Qe]=Ee==="gradient"?ze==="gradient"?function(ft){var rt=this._components[0];return ft=qi.read(Array.isArray(ft)?ft:arguments,0,{readNull:!0}),rt!==ft&&(rt&&rt._removeOwner(this),ft&&ft._addOwner(this)),ft}:function(){return we.read(arguments,0,{readNull:ze==="highlight",clone:!0})}:function(ft){return ft==null||isNaN(ft)?0:+ft};this["get"+He]=function(){return this._type===Ee||Ze&&/^hs[bl]$/.test(this._type)?this._components[Qe]:this._convert(Ee)[Qe]},this["set"+He]=function(ft){this._type!==Ee&&!(Ze&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(Ee),this._properties=v[Ee],this._type=Ee),this._components[Qe]=Ve.call(this,ft),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function Ie(Ee){var ze=arguments,Qe=this.__read,He=0,Ze,Ve,ft,rt;Array.isArray(Ee)&&(ze=Ee,Ee=ze[0]);var Me=Ee!=null&&typeof Ee;if(Me==="string"&&Ee in v&&(Ze=Ee,Ee=ze[1],Array.isArray(Ee)?(Ve=Ee,ft=ze[2]):(Qe&&(He=1),ze=b.slice(ze,1),Me=typeof Ee)),!Ve){if(rt=Me==="number"?ze:Me==="object"&&Ee.length!=null?Ee:null,rt){Ze||(Ze=rt.length>=3?"rgb":"gray");var se=v[Ze].length;ft=rt[se],Qe&&(He+=rt===arguments?se+(ft!=null?1:0):1),rt.length>se&&(rt=b.slice(rt,0,se))}else if(Me==="string"){var ne=te(Ee);Ze=ne[0],Ve=ne[1],Ve.length===4&&(ft=Ve[3],Ve.length--)}else if(Me==="object")if(Ee.constructor===Ie){if(Ze=Ee._type,Ve=Ee._components.slice(),ft=Ee._alpha,Ze==="gradient")for(var X=1,ie=Ve.length;X<ie;X++){var de=Ve[X];de&&(Ve[X]=de.clone())}}else if(Ee.constructor===qi)Ze="gradient",rt=ze;else{Ze="hue"in Ee?"lightness"in Ee?"hsl":"hsb":"gradient"in Ee||"stops"in Ee||"radial"in Ee?"gradient":"gray"in Ee?"gray":"rgb";var ye=v[Ze],ge=k[Ze];this._components=Ve=[];for(var X=0,ie=ye.length;X<ie;X++){var Pe=Ee[ye[X]];Pe==null&&!X&&Ze==="gradient"&&"stops"in Ee&&(Pe={stops:Ee.stops,radial:Ee.radial}),Pe=ge[X].call(this,Pe),Pe!=null&&(Ve[X]=Pe)}ft=Ee.alpha}Qe&&Ze&&(He=1)}if(this._type=Ze||"rgb",!Ve){this._components=Ve=[];for(var ge=k[this._type],X=0,ie=ge.length;X<ie;X++){var Pe=ge[X].call(this,rt&&rt[X]);Pe!=null&&(Ve[X]=Pe)}}return this._components=Ve,this._properties=v[this._type],this._alpha=ft,Qe&&(this.__read=He),this},set:"#initialize",_serialize:function(Ie,Ee){var ze=this.getComponents();return b.serialize(/^(gray|rgb)$/.test(this._type)?ze:[this._type].concat(ze),Ie,!0,Ee)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(Ie){var Ee;return this._type===Ie?this._components.slice():(Ee=ve[this._type+"-"+Ie])?Ee.apply(this,this._components):ve["rgb-"+Ie].apply(this,ve[this._type+"-rgb"].apply(this,this._components))},convert:function(Ie){return new $i(Ie,this._convert(Ie),this._alpha)},getType:function(){return this._type},setType:function(Ie){this._components=this._convert(Ie),this._properties=v[Ie],this._type=Ie},getComponents:function(){var Ie=this._components.slice();return this._alpha!=null&&Ie.push(this._alpha),Ie},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(Ie){this._alpha=Ie==null?null:Math.min(Math.max(Ie,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(Ie){var Ee=b.isPlainValue(Ie,!0)?$i.read(arguments):Ie;return Ee===this||Ee&&this._class===Ee._class&&this._type===Ee._type&&this.getAlpha()===Ee.getAlpha()&&b.equals(this._components,Ee._components)||!1},toString:function(){for(var Ie=this._properties,Ee=[],ze=this._type==="gradient",Qe=ce.instance,He=0,Ze=Ie.length;He<Ze;He++){var Ve=this._components[He];Ve!=null&&Ee.push(Ie[He]+": "+(ze?Ve:Qe.number(Ve)))}return this._alpha!=null&&Ee.push("alpha: "+Qe.number(this._alpha)),"{ "+Ee.join(", ")+" }"},toCSS:function(Ie){var Ee=this._convert("rgb"),ze=Ie||this._alpha==null?1:this._alpha;function Qe(He){return Math.round((He<0?0:He>1?1:He)*255)}return Ee=[Qe(Ee[0]),Qe(Ee[1]),Qe(Ee[2])],ze<1&&Ee.push(ze<0?0:ze),Ie?"#"+((1<<24)+(Ee[0]<<16)+(Ee[1]<<8)+Ee[2]).toString(16).slice(1):(Ee.length==4?"rgba(":"rgb(")+Ee.join(",")+")"},toCanvasStyle:function(Ie,Ee){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var ze=this._components,Qe=ze[0],He=Qe._stops,Ze=ze[1],Ve=ze[2],ft=ze[3],rt=Ee&&Ee.inverted(),Me;if(rt&&(Ze=rt._transformPoint(Ze),Ve=rt._transformPoint(Ve),ft&&(ft=rt._transformPoint(ft))),Qe._radial){var se=Ve.getDistance(Ze);if(ft){var ne=ft.subtract(Ze);ne.getLength()>se&&(ft=Ze.add(ne.normalize(se-.1)))}var X=ft||Ze;Me=Ie.createRadialGradient(X.x,X.y,0,Ze.x,Ze.y,se)}else Me=Ie.createLinearGradient(Ze.x,Ze.y,Ve.x,Ve.y);for(var ie=0,de=He.length;ie<de;ie++){var ye=He[ie],ge=ye._offset;Me.addColorStop(ge??ie/(de-1),ye._color.toCanvasStyle())}return this._canvasStyle=Me},transform:function(Ie){if(this._type==="gradient"){for(var Ee=this._components,ze=1,Qe=Ee.length;ze<Qe;ze++){var He=Ee[ze];Ie._transformPoint(He,He,!0)}this._changed()}},statics:{_types:v,random:function(){var Ie=Math.random;return new $i(Ie(),Ie(),Ie())},_setOwner:function(Ie,Ee,ze){return Ie&&(Ie._owner&&Ee&&Ie._owner!==Ee&&(Ie=Ie.clone()),!Ie._owner^!Ee&&(Ie._owner=Ee||null,Ie._setter=ze||null)),Ie}}})},new function(){var v={add:function(k,V){return k+V},subtract:function(k,V){return k-V},multiply:function(k,V){return k*V},divide:function(k,V){return k/V}};return b.each(v,function(k,V){this[V]=function($){$=$i.read(arguments);for(var te=this._type,Ae=this._components,ve=$._convert(te),Ie=0,Ee=Ae.length;Ie<Ee;Ie++)ve[Ie]=k(Ae[Ie],ve[Ie]);return new $i(te,ve,this._alpha!=null?k(this._alpha,$.getAlpha()):null)}},{})}),qi=b.extend({_class:"Gradient",initialize:function(k,V){this._id=fe.get(),k&&b.isPlainObject(k)&&(this.set(k),k=V=null),this._stops==null&&this.setStops(k||["white","black"]),this._radial==null&&this.setRadial(typeof V=="string"&&V==="radial"||V||!1)},_serialize:function(v,k){return k.add(this,function(){return b.serialize([this._stops,this._radial],v,!0,k)})},_changed:function(){for(var v=0,k=this._owners&&this._owners.length;v<k;v++)this._owners[v]._changed()},_addOwner:function(v){this._owners||(this._owners=[]),this._owners.push(v)},_removeOwner:function(v){var k=this._owners?this._owners.indexOf(v):-1;k!=-1&&(this._owners.splice(k,1),this._owners.length||(this._owners=n))},clone:function(){for(var v=[],k=0,V=this._stops.length;k<V;k++)v[k]=this._stops[k].clone();return new qi(v,this._radial)},getStops:function(){return this._stops},setStops:function(v){if(v.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var k=this._stops;if(k)for(var V=0,$=k.length;V<$;V++)k[V]._owner=n;k=this._stops=sn.readList(v,0,{clone:!0});for(var V=0,$=k.length;V<$;V++)k[V]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(v){this._radial=v,this._changed()},equals:function(v){if(v===this)return!0;if(v&&this._class===v._class){var k=this._stops,V=v._stops,$=k.length;if($===V.length){for(var te=0;te<$;te++)if(!k[te].equals(V[te]))return!1;return!0}}return!1}}),sn=b.extend({_class:"GradientStop",initialize:function(k,V){var $=k,te=V;typeof k=="object"&&V===n&&(Array.isArray(k)&&typeof k[0]!="number"?($=k[0],te=k[1]):("color"in k||"offset"in k||"rampPoint"in k)&&($=k.color,te=k.offset||k.rampPoint||0)),this.setColor($),this.setOffset(te)},clone:function(){return new sn(this._color.clone(),this._offset)},_serialize:function(v,k){var V=this._color,$=this._offset;return b.serialize($==null?[V]:[V,$],v,!0,k)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(v){this._offset=v,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){$i._setOwner(this._color,null),this._color=$i._setOwner($i.read(arguments,0),this,"setColor"),this._changed()},equals:function(v){return v===this||v&&this._class===v._class&&this._color.equals(v._color)&&this._offset==v._offset||!1}}),Ti=b.extend(new function(){var v={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new we,selectedColor:null},k=b.set({},v,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),V=b.set({},k,{fillColor:new $i}),$={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},te={beans:!0},Ae={_class:"Style",beans:!0,initialize:function(Ie,Ee,ze){this._values={},this._owner=Ee,this._project=Ee&&Ee._project||ze||wn.project,this._defaults=!Ee||Ee instanceof ni?k:Ee instanceof Gi?V:v,Ie&&this.set(Ie)}};return b.each(k,function(ve,Ie){var Ee=/Color$/.test(Ie),ze=Ie==="shadowOffset",Qe=b.capitalize(Ie),He=$[Ie],Ze="set"+Qe,Ve="get"+Qe;Ae[Ze]=function(ft){var rt=this._owner,Me=rt&&rt._children,se=Me&&Me.length>0&&!(rt instanceof ci);if(se)for(var ne=0,X=Me.length;ne<X;ne++)Me[ne]._style[Ze](ft);if((Ie==="selectedColor"||!se)&&Ie in this._defaults){var ie=this._values[Ie];ie!==ft&&(Ee&&(ie&&($i._setOwner(ie,null),ie._canvasStyle=null),ft&&ft.constructor===$i&&(ft=$i._setOwner(ft,rt,se&&Ze))),this._values[Ie]=ft,rt&&rt._changed(He||129))}},Ae[Ve]=function(ft){var rt=this._owner,Me=rt&&rt._children,se=Me&&Me.length>0&&!(rt instanceof ci),ne;if(se&&!ft)for(var X=0,ie=Me.length;X<ie;X++){var de=Me[X]._style[Ve]();if(!X)ne=de;else if(!b.equals(ne,de))return n}else if(Ie in this._defaults){var ne=this._values[Ie];if(ne===n)ne=this._defaults[Ie],ne&&ne.clone&&(ne=ne.clone());else{var ye=Ee?$i:ze?we:null;ye&&!(ne&&ne.constructor===ye)&&(this._values[Ie]=ne=ye.read([ne],0,{readNull:!0,clone:!0}))}}return ne&&Ee&&(ne=$i._setOwner(ne,rt,se&&Ze)),ne},te[Ve]=function(ft){return this._style[Ve](ft)},te[Ze]=function(ft){this._style[Ze](ft)}}),b.each({Font:"FontFamily",WindingRule:"FillRule"},function(ve,Ie){var Ee="get"+Ie,ze="set"+Ie;Ae[Ee]=te[Ee]="#get"+ve,Ae[ze]=te[ze]="#set"+ve}),Ge.inject(te),Ae},{set:function(v){var k=v instanceof Ti,V=k?v._values:v;if(V){for(var $ in V)if($ in this._defaults){var te=V[$];this[$]=te&&k&&te.clone?te.clone():te}}},equals:function(v){function k(V,$,te){var Ae=V._values,ve=$._values,Ie=$._defaults;for(var Ee in Ae){var ze=Ae[Ee],Qe=ve[Ee];if(!(te&&Ee in ve)&&!b.equals(ze,Qe===n?Ie[Ee]:Qe))return!1}return!0}return v===this||v&&this._class===v._class&&k(this,v)&&k(v,this,!0)||!1},_dispose:function(){var v;v=this.getFillColor(),v&&(v._canvasStyle=null),v=this.getStrokeColor(),v&&(v._canvasStyle=null),v=this.getShadowColor(),v&&(v._canvasStyle=null)},hasFill:function(){var v=this.getFillColor();return!!v&&v.alpha>0},hasStroke:function(){var v=this.getStrokeColor();return!!v&&v.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var v=this.getShadowColor();return!!v&&v.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var v=this.getFontSize();return this.getFontWeight()+" "+v+(/[a-z]/i.test(v+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function v(){var k=v.base.call(this),V=this.getFontSize();return/pt|em|%|px/.test(V)&&(V=this.getView().getPixelSize(V)),k??V*1.2}}),yi=new function(){function v(k,V,$,te){for(var Ae=["","webkit","moz","Moz","ms","o"],ve=V[0].toUpperCase()+V.substring(1),Ie=0;Ie<6;Ie++){var Ee=Ae[Ie],ze=Ee?Ee+ve:V;if(ze in k){if($)k[ze]=te;else return k[ze];break}}}return{getStyles:function(k){var V=k&&k.nodeType!==9?k.ownerDocument:k,$=V&&V.defaultView;return $&&$.getComputedStyle(k,"")},getBounds:function(k,V){var $=k.ownerDocument,te=$.body,Ae=$.documentElement,ve;try{ve=k.getBoundingClientRect()}catch{ve={left:0,top:0,width:0,height:0}}var Ie=ve.left-(Ae.clientLeft||te.clientLeft||0),Ee=ve.top-(Ae.clientTop||te.clientTop||0);if(!V){var ze=$.defaultView;Ie+=ze.pageXOffset||Ae.scrollLeft||te.scrollLeft,Ee+=ze.pageYOffset||Ae.scrollTop||te.scrollTop}return new st(Ie,Ee,ve.width,ve.height)},getViewportBounds:function(k){var V=k.ownerDocument,$=V.defaultView,te=V.documentElement;return new st(0,0,$.innerWidth||te.clientWidth,$.innerHeight||te.clientHeight)},getOffset:function(k,V){return yi.getBounds(k,V).getPoint()},getSize:function(k){return yi.getBounds(k,!0).getSize()},isInvisible:function(k){return yi.getSize(k).equals(new lt(0,0))},isInView:function(k){return!yi.isInvisible(k)&&yi.getViewportBounds(k).intersects(yi.getBounds(k,!0))},isInserted:function(k){return g.body.contains(k)},getPrefixed:function(k,V){return k&&v(k,V)},setPrefixed:function(k,V,$){if(typeof V=="object")for(var te in V)v(k,te,!0,V[te]);else v(k,V,!0,$)}}},hi={add:function(v,k){if(v)for(var V in k)for(var $=k[V],te=V.split(/[\s,]+/g),Ae=0,ve=te.length;Ae<ve;Ae++){var Ie=te[Ae],Ee=v===g&&(Ie==="touchstart"||Ie==="touchmove")?{passive:!1}:!1;v.addEventListener(Ie,$,Ee)}},remove:function(v,k){if(v)for(var V in k)for(var $=k[V],te=V.split(/[\s,]+/g),Ae=0,ve=te.length;Ae<ve;Ae++)v.removeEventListener(te[Ae],$,!1)},getPoint:function(v){var k=v.targetTouches?v.targetTouches.length?v.targetTouches[0]:v.changedTouches[0]:v;return new we(k.pageX||k.clientX+g.documentElement.scrollLeft,k.pageY||k.clientY+g.documentElement.scrollTop)},getTarget:function(v){return v.target||v.srcElement},getRelatedTarget:function(v){return v.relatedTarget||v.toElement},getOffset:function(v,k){return hi.getPoint(v).subtract(yi.getOffset(k||hi.getTarget(v)))}};hi.requestAnimationFrame=new function(){var v=yi.getPrefixed(c,"requestAnimationFrame"),k=!1,V=[],$;function te(){var Ae=V;V=[];for(var ve=0,Ie=Ae.length;ve<Ie;ve++)Ae[ve]();k=v&&V.length,k&&v(te)}return function(Ae){V.push(Ae),v?k||(v(te),k=!0):$||($=setInterval(te,1e3/60))}};var Ei=b.extend(E,{_class:"View",initialize:function v(k,V){function $(He){return V[He]||parseInt(V.getAttribute(He),10)}function te(){var He=yi.getSize(V);return He.isNaN()||He.isZero()?new lt($("width"),$("height")):He}var Ae;if(c&&V){this._id=V.getAttribute("id"),this._id==null&&V.setAttribute("id",this._id="paper-view-"+v._id++),hi.add(V,this._viewEvents);var ve="none";if(yi.setPrefixed(V.style,{userDrag:ve,userSelect:ve,touchCallout:ve,contentZooming:ve,tapHighlightColor:"rgba(0,0,0,0)"}),a.hasAttribute(V,"resize")){var Ie=this;hi.add(c,this._windowEvents={resize:function(){Ie.setViewSize(te())}})}if(Ae=te(),a.hasAttribute(V,"stats")&&typeof Stats<"u"){this._stats=new Stats;var Ee=this._stats.domElement,ze=Ee.style,Qe=yi.getOffset(V);ze.position="absolute",ze.left=Qe.x+"px",ze.top=Qe.y+"px",g.body.appendChild(Ee)}}else Ae=new lt(V),V=null;this._project=k,this._scope=k._scope,this._element=V,this._pixelRatio||(this._pixelRatio=c&&c.devicePixelRatio||1),this._setElementSize(Ae.width,Ae.height),this._viewSize=Ae,v._views.push(this),v._viewsById[this._id]=this,(this._matrix=new kt)._owner=this,v._focused||(v._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!wn.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Ei._focused===this&&(Ei._focused=null),Ei._views.splice(Ei._views.indexOf(this),1),delete Ei._viewsById[this._id];var v=this._project;return v._view===this&&(v._view=null),hi.remove(this._element,this._viewEvents),hi.remove(c,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:b.each(Ge._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(v){this[v]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(v){this._autoUpdate=v,v&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var v=this;hi.requestAnimationFrame(function(){if(v._requested=!1,v._animate){v.requestUpdate();var k=v._element;(!yi.getPrefixed(g,"hidden")||a.getAttribute(k,"keepalive")==="true")&&yi.isInView(k)&&v._handleFrame()}v._autoUpdate&&v.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){wn=this._scope;var v=Date.now()/1e3,k=this._last?v-this._last:0;this._last=v,this.emit("frame",new b({delta:k,time:this._time+=k,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(v,k){var V=this._frameItems;k?(V[v._id]={item:v,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete V[v._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(v){for(var k in this._frameItems){var V=this._frameItems[k];V.item.emit("frame",new b(v,{time:V.time+=v.delta,count:V.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var v=this._viewSize;return new Ke(v.width,v.height,this,"setViewSize")},setViewSize:function(){var v=lt.read(arguments),k=v.subtract(this._viewSize);k.isZero()||(this._setElementSize(v.width,v.height),this._viewSize.set(v),this._changed(),this.emit("resize",{size:v,delta:k}),this._autoUpdate&&this.update())},_setElementSize:function(v,k){var V=this._element;V&&(V.width!==v&&(V.width=v),V.height!==k&&(V.height=k))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new st(new we,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return yi.isInView(this._element)},isInserted:function(){return yi.isInserted(this._element)},getPixelSize:function(v){var k=this._element,V;if(k){var $=k.parentNode,te=g.createElement("div");te.style.fontSize=v,$.appendChild(te),V=parseFloat(yi.getStyles(te).fontSize),$.removeChild(te)}else V=parseFloat(V);return V},getTextWidth:function(v,k){return 0}},b.each(["rotate","scale","shear","skew"],function(v){var k=v==="rotate";this[v]=function(){var V=arguments,$=(k?b:we).read(V),te=we.read(V,0,{readNull:!0});return this.transform(new kt()[v]($,te||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var v=new kt;return this.transform(v.translate.apply(v,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var v=we.read(arguments);this.translate(this.getCenter().subtract(v))},getZoom:function(){var v=this._decompose().scaling;return(v.x+v.y)/2},setZoom:function(v){this.transform(new kt().scale(v/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(v){var k=this.getRotation();k!=null&&v!=null&&this.rotate(v-k)},getScaling:function(){var v=this._decompose().scaling;return new et(v.x,v.y,this,"setScaling")},setScaling:function(){var v=this.getScaling(),k=we.read(arguments,0,{clone:!0,readNull:!0});v&&k&&this.scale(k.x/v.x,k.y/v.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var v=this._matrix;v.set.apply(v,arguments)},transform:function(v){this._matrix.append(v)},scrollBy:function(){this.translate(we.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(we.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(we.read(arguments))},getEventPoint:function(v){return this.viewToProject(hi.getOffset(v,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(v,k){g&&typeof k=="string"&&(k=g.getElementById(k));var V=c?Li:Ei;return new V(v,k)}}},new function(){if(!c)return;var v,k,V=!1,$=!1;function te(Ye){var De=hi.getTarget(Ye);return De.getAttribute&&Ei._viewsById[De.getAttribute("id")]}function Ae(){var Ye=Ei._focused;if(!Ye||!Ye.isVisible()){for(var De=0,Ue=Ei._views.length;De<Ue;De++)if((Ye=Ei._views[De]).isVisible()){Ei._focused=k=Ye;break}}}function ve(Ye,De,Ue){Ye._handleMouseEvent("mousemove",De,Ue)}var Ie=c.navigator,Ee,ze,Qe;Ie.pointerEnabled||Ie.msPointerEnabled?(Ee="pointerdown MSPointerDown",ze="pointermove MSPointerMove",Qe="pointerup pointercancel MSPointerUp MSPointerCancel"):(Ee="touchstart",ze="touchmove",Qe="touchend touchcancel","ontouchstart"in c&&Ie.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(Ee+=" mousedown",ze+=" mousemove",Qe+=" mouseup"));var He={},Ze={mouseout:function(Ye){var De=Ei._focused,Ue=hi.getRelatedTarget(Ye);if(De&&(!Ue||Ue.nodeName==="HTML")){var ht=hi.getOffset(Ye,De._element),Tt=ht.x,o=Math.abs,ke=o(Tt),ai=1<<25,di=ke-ai;ht.x=o(di)<ke?di*(Tt<0?-1:1):Tt,ve(De,Ye,De.viewToProject(ht))}},scroll:Ae};He[Ee]=function(Ye){var De=Ei._focused=te(Ye);V||(V=!0,De._handleMouseEvent("mousedown",Ye))},Ze[ze]=function(Ye){var De=Ei._focused;if(!$){var Ue=te(Ye);Ue?De!==Ue&&(De&&ve(De,Ye),v||(v=De),De=Ei._focused=k=Ue):k&&k===De&&(v&&!v.isInserted()&&(v=null),De=Ei._focused=v,v=null,Ae())}De&&ve(De,Ye)},Ze[Ee]=function(){$=!0},Ze[Qe]=function(Ye){var De=Ei._focused;De&&V&&De._handleMouseEvent("mouseup",Ye),$=V=!1},hi.add(g,Ze),hi.add(c,{load:Ae});var Ve=!1,ft=!1,rt={doubleclick:"click",mousedrag:"mousemove"},Me=!1,se,ne,X,ie,de,ye,ge,Pe;function Fe(Ye,De,Ue,ht,Tt,o,ke){var ai=!1,di;function Ai(Kt,oi){if(Kt.responds(oi)){if(di||(di=new mn(oi,ht,Tt,De||Kt,o?Tt.subtract(o):null)),Kt.emit(oi,di)&&(Ve=!0,di.prevented&&(ft=!0),di.stopped))return ai=!0}else{var Ri=rt[oi];if(Ri)return Ai(Kt,Ri)}}for(;Ye&&Ye!==ke&&!Ai(Ye,Ue);)Ye=Ye._parent;return ai}function Ne(Ye,De,Ue,ht,Tt,o){return Ye._project.removeOn(Ue),ft=Ve=!1,de&&Fe(de,null,Ue,ht,Tt,o)||De&&De!==de&&!De.isDescendant(de)&&Fe(De,null,Ue==="mousedrag"?"mousemove":Ue,ht,Tt,o,de)||Fe(Ye,de||De||Ye,Ue,ht,Tt,o)}var Xe={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:He,_handleMouseEvent:function(Ye,De,Ue){var ht=this._itemEvents,Tt=ht.native[Ye],o=Ye==="mousemove",ke=this._scope.tool,ai=this;function di(Yt){return ht.virtual[Yt]||ai.responds(Yt)||ke&&ke.responds(Yt)}o&&V&&di("mousedrag")&&(Ye="mousedrag"),Ue||(Ue=this.getEventPoint(De));var Ai=this.getBounds().contains(Ue),Kt=Tt&&Ai&&ai._project.hitTest(Ue,{tolerance:0,fill:!0,stroke:!0}),oi=Kt&&Kt.item||null,Ri=!1,vi={};if(vi[Ye.substr(5)]=!0,Tt&&oi!==ie&&(ie&&Fe(ie,null,"mouseleave",De,Ue),oi&&Fe(oi,null,"mouseenter",De,Ue),ie=oi),Me^Ai&&(Fe(this,null,Ai?"mouseenter":"mouseleave",De,Ue),Ri=!0),(Ai||vi.drag)&&!Ue.equals(ne)&&(Ne(this,oi,o?Ye:"mousemove",De,Ue,ne),Ri=!0),Me=Ai,vi.down&&Ai||vi.up&&se){if(Ne(this,oi,Ye,De,Ue,se),vi.down){if(Pe=oi===ye&&Date.now()-ge<300,X=ye=oi,!ft&&oi){for(var wi=oi;wi&&!wi.responds("mousedrag");)wi=wi._parent;wi&&(de=oi)}se=Ue}else vi.up&&(!ft&&oi===X&&(ge=Date.now(),Ne(this,oi,Pe?"doubleclick":"click",De,Ue,se),Pe=!1),X=de=null);Me=!1,Ri=!0}ne=Ue,Ri&&ke&&(Ve=ke._handleMouseEvent(Ye,De,Ue,vi)||Ve),De.cancelable!==!1&&(Ve&&!vi.move||vi.down&&di("mouseup"))&&De.preventDefault()},_handleKeyEvent:function(Ye,De,Ue,ht){var Tt=this._scope,o=Tt.tool,ke;function ai(di){di.responds(Ye)&&(wn=Tt,di.emit(Ye,ke=ke||new _n(Ye,De,Ue,ht)))}this.isVisible()&&(ai(this),o&&o.responds(Ye)&&ai(o))},_countItemEvent:function(Ye,De){var Ue=this._itemEvents,ht=Ue.native,Tt=Ue.virtual;for(var o in Xe)ht[o]=(ht[o]||0)+(Xe[o][Ye]||0)*De;Tt[Ye]=(Tt[Ye]||0)+De},statics:{updateFocus:Ae,_resetState:function(){V=$=Ve=Me=!1,v=k=se=ne=X=ie=de=ye=ge=Pe=null}}}}),Li=Ei.extend({_class:"CanvasView",initialize:function(k,V){if(!(V instanceof c.HTMLCanvasElement)){var $=lt.read(arguments,1);if($.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+b.slice(arguments,1));V=ln.getCanvas($)}var te=this._context=V.getContext("2d");if(te.save(),this._pixelRatio=1,!/^off|false$/.test(a.getAttribute(V,"hidpi"))){var Ae=c.devicePixelRatio||1,ve=yi.getPrefixed(te,"backingStorePixelRatio")||1;this._pixelRatio=Ae/ve}Ei.call(this,k,V),this._needsUpdate=!0},remove:function v(){return this._context.restore(),v.base.call(this)},_setElementSize:function v(k,V){var $=this._pixelRatio;if(v.base.call(this,k*$,V*$),$!==1){var te=this._element,Ae=this._context;if(!a.hasAttribute(te,"resize")){var ve=te.style;ve.width=k+"px",ve.height=V+"px"}Ae.restore(),Ae.save(),Ae.scale($,$)}},getContext:function(){return this._context},getPixelSize:function v(k){var V=wn.agent,$;if(V&&V.firefox)$=v.base.call(this,k);else{var te=this._context,Ae=te.font;te.font=k+" serif",$=parseFloat(te.font),te.font=Ae}return $},getTextWidth:function(v,k){var V=this._context,$=V.font,te=0;V.font=v;for(var Ae=0,ve=k.length;Ae<ve;Ae++)te=Math.max(te,V.measureText(k[Ae]).width);return V.font=$,te},update:function(){if(!this._needsUpdate)return!1;var v=this._project,k=this._context,V=this._viewSize;return k.clearRect(0,0,V.width+1,V.height+1),v&&v.draw(k,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),fn=b.extend({_class:"Event",initialize:function(k){this.event=k,this.type=k&&k.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return gi.modifiers}}),_n=fn.extend({_class:"KeyEvent",initialize:function(k,V,$,te){this.type=k,this.event=V,this.key=$,this.character=te},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),gi=new function(){var v={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},k={tab:"	",space:" ",enter:"\r"},V={},$={},te,Ae,ve=new b({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var ze=wn&&wn.agent;return ze&&ze.mac?this.meta:this.control}}});function Ie(ze){var Qe=ze.key||ze.keyIdentifier;return Qe=/^U\+/.test(Qe)?String.fromCharCode(parseInt(Qe.substr(2),16)):/^Arrow[A-Z]/.test(Qe)?Qe.substr(5):Qe==="Unidentified"||Qe===n?String.fromCharCode(ze.keyCode):Qe,v[Qe]||(Qe.length>1?b.hyphenate(Qe):Qe.toLowerCase())}function Ee(ze,Qe,He,Ze){var Ve=Ei._focused,ft;if(V[Qe]=ze,ze?$[Qe]=He:delete $[Qe],Qe.length>1&&(ft=b.camelize(Qe))in ve){ve[ft]=ze;var rt=wn&&wn.agent;if(ft==="meta"&&rt&&rt.mac)if(ze)te={};else{for(var Me in te)Me in $&&Ee(!1,Me,te[Me],Ze);te=null}}else ze&&te&&(te[Qe]=He);Ve&&Ve._handleKeyEvent(ze?"keydown":"keyup",Ze,Qe,He)}return hi.add(g,{keydown:function(ze){var Qe=Ie(ze),He=wn&&wn.agent;Qe.length>1||He&&He.chrome&&(ze.altKey||He.mac&&ze.metaKey||!He.mac&&ze.ctrlKey)?Ee(!0,Qe,k[Qe]||(Qe.length>1?"":Qe),ze):Ae=Qe},keypress:function(ze){if(Ae){var Qe=Ie(ze),He=ze.charCode,Ze=He>=32?String.fromCharCode(He):Qe.length>1?"":Qe;Qe!==Ae&&(Qe=Ze.toLowerCase()),Ee(!0,Qe,Ze,ze),Ae=null}},keyup:function(ze){var Qe=Ie(ze);Qe in $&&Ee(!1,Qe,$[Qe],ze)}}),hi.add(c,{blur:function(ze){for(var Qe in $)Ee(!1,Qe,$[Qe],ze)}}),{modifiers:ve,isDown:function(ze){return!!V[ze]}}},mn=fn.extend({_class:"MouseEvent",initialize:function(k,V,$,te,Ae){this.type=k,this.event=V,this.point=$,this.target=te,this.delta=Ae},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),ti=fn.extend({_class:"ToolEvent",_item:null,initialize:function(k,V,$){this.tool=k,this.type=V,this.event=$},_choosePoint:function(v,k){return v||(k?k.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(v){this._point=v},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(v){this._lastPoint=v},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(v){this._downPoint=v},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(v){this._middlePoint=v},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(v){this._delta=v},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(v){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=v},getItem:function(){if(!this._item){var v=this.tool._scope.project.hitTest(this.getPoint());if(v){for(var k=v.item,V=k._parent;/^(Group|CompoundPath)$/.test(V._class);)k=V,V=V._parent;this._item=k}}return this._item},setItem:function(v){this._item=v},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Mn=U.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(k){U.call(this),this._moveCount=-1,this._downCount=-1,this.set(k)},getMinDistance:function(){return this._minDistance},setMinDistance:function(v){this._minDistance=v,v!=null&&this._maxDistance!=null&&v>this._maxDistance&&(this._maxDistance=v)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(v){this._maxDistance=v,this._minDistance!=null&&v!=null&&v<this._minDistance&&(this._minDistance=v)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(v){this._minDistance=this._maxDistance=v},_handleMouseEvent:function(v,k,V,$){wn=this._scope,$.drag&&!this.responds(v)&&(v="mousemove");var te=$.move||$.drag,Ae=this.responds(v),ve=this.minDistance,Ie=this.maxDistance,Ee=!1,ze=this;function Qe(Ze,Ve){var ft=V,rt=te?ze._point:ze._downPoint||ft;if(te){if(ze._moveCount>=0&&ft.equals(rt))return!1;if(rt&&(Ze!=null||Ve!=null)){var Me=ft.subtract(rt),se=Me.getLength();if(se<(Ze||0))return!1;Ve&&(ft=rt.add(Me.normalize(Math.min(se,Ve))))}ze._moveCount++}return ze._point=ft,ze._lastPoint=rt||ft,$.down&&(ze._moveCount=-1,ze._downPoint=ft,ze._downCount++),!0}function He(){Ae&&(Ee=ze.emit(v,new ti(ze,v,k))||Ee)}if($.down)Qe(),He();else if($.up)Qe(null,Ie),He();else if(Ae)for(;Qe(ve,Ie);)He();return Ee}}),ns=b.extend(E,{_class:"Tween",statics:{easings:new b({linear:function(v){return v},easeInQuad:function(v){return v*v},easeOutQuad:function(v){return v*(2-v)},easeInOutQuad:function(v){return v<.5?2*v*v:-1+2*(2-v)*v},easeInCubic:function(v){return v*v*v},easeOutCubic:function(v){return--v*v*v+1},easeInOutCubic:function(v){return v<.5?4*v*v*v:(v-1)*(2*v-2)*(2*v-2)+1},easeInQuart:function(v){return v*v*v*v},easeOutQuart:function(v){return 1- --v*v*v*v},easeInOutQuart:function(v){return v<.5?8*v*v*v*v:1-8*--v*v*v*v},easeInQuint:function(v){return v*v*v*v*v},easeOutQuint:function(v){return 1+--v*v*v*v*v},easeInOutQuint:function(v){return v<.5?16*v*v*v*v*v:1+16*--v*v*v*v*v}})},initialize:function v(k,V,$,te,Ae,ve){this.object=k;var Ie=typeof Ae,Ee=Ie==="function";this.type=Ee?Ie:Ie==="string"?Ae:"linear",this.easing=Ee?Ae:v.easings[this.type],this.duration=te,this.running=!1,this._then=null,this._startTime=null;var ze=V||$;this._keys=ze?Object.keys(ze):[],this._parsedKeys=this._parseKeys(this._keys),this._from=ze&&this._getState(V),this._to=ze&&this._getState($),ve!==!1&&this.start()},then:function(v){return this._then=v,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(v){if(this.running){v>=1&&(v=1,this.running=!1);for(var k=this.easing(v),V=this._keys,$=function(Qe){return typeof Qe=="function"?Qe(k,v):Qe},te=0,Ae=V&&V.length;te<Ae;te++){var ve=V[te],Ie=$(this._from[ve]),Ee=$(this._to[ve]),ze=Ie&&Ee&&Ie.__add&&Ee.__add?Ee.__subtract(Ie).__multiply(k).__add(Ie):(Ee-Ie)*k+Ie;this._setProperty(this._parsedKeys[ve],ze)}this.responds("update")&&this.emit("update",new b({progress:v,factor:k})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(v){var k=this._startTime,V=k?(v-k)/this.duration:0;k||(this._startTime=v),this.update(V)},_getState:function(v){for(var k=this._keys,V={},$=0,te=k.length;$<te;$++){var Ae=k[$],ve=this._parsedKeys[Ae],Ie=this._getProperty(ve),Ee;if(v){var ze=this._resolveValue(Ie,v[Ae]);this._setProperty(ve,ze),Ee=this._getProperty(ve),Ee=Ee&&Ee.clone?Ee.clone():Ee,this._setProperty(ve,Ie)}else Ee=Ie&&Ie.clone?Ie.clone():Ie;V[Ae]=Ee}return V},_resolveValue:function(v,k){if(k){if(Array.isArray(k)&&k.length===2){var V=k[0];return V&&V.match&&V.match(/^[+\-\*\/]=/)?this._calculate(v,V[0],k[1]):k}else if(typeof k=="string"){var $=k.match(/^[+\-*/]=(.*)/);if($){var te=JSON.parse($[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(v,k[0],te)}}}return k},_calculate:function(v,k,V){return wn.PaperScript.calculateBinary(v,k,V)},_parseKeys:function(v){for(var k={},V=0,$=v.length;V<$;V++){var te=v[V],Ae=te.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");k[te]=Ae.split("/")}return k},_getProperty:function(v,k){for(var V=this.object,$=0,te=v.length-(k||0);$<te&&V;$++)V=V[v[$]];return V},_setProperty:function(v,k){var V=this._getProperty(v,1);V&&(V[v[v.length-1]]=k)}}),fi={request:function(v){var k=new t.XMLHttpRequest;return k.open((v.method||"get").toUpperCase(),v.url,b.pick(v.async,!0)),v.mimeType&&k.overrideMimeType(v.mimeType),k.onload=function(){var V=k.status;V===0||V===200?v.onLoad&&v.onLoad.call(k,k.responseText):k.onerror()},k.onerror=function(){var V=k.status,$='Could not load "'+v.url+'" (Status: '+V+")";if(v.onError)v.onError($,V);else throw new Error($)},k.send(null)}},ln=b.exports.CanvasProvider={canvases:[],getCanvas:function(v,k,V){if(!c)return null;var $,te=!0;typeof v=="object"&&(k=v.height,v=v.width),this.canvases.length?$=this.canvases.pop():($=g.createElement("canvas"),te=!1);var Ae=$.getContext("2d",V||{});if(!Ae)throw new Error("Canvas "+$+" is unable to provide a 2D context.");return $.width===v&&$.height===k?te&&Ae.clearRect(0,0,v+1,k+1):($.width=v,$.height=k),Ae.save(),$},getContext:function(v,k,V){var $=this.getCanvas(v,k,V);return $?$.getContext("2d",V||{}):null},release:function(v){var k=v&&v.canvas?v.canvas:v;k&&k.getContext&&(k.getContext("2d").restore(),this.canvases.push(k))}},pr=new function(){var v=Math.min,k=Math.max,V=Math.abs,$,te,Ae,ve,Ie,Ee,ze,Qe,He,Ze,Ve;function ft(de,ye,ge){return .2989*de+.587*ye+.114*ge}function rt(de,ye,ge,Ne){var Fe=Ne-ft(de,ye,ge);He=de+Fe,Ze=ye+Fe,Ve=ge+Fe;var Ne=ft(He,Ze,Ve),Xe=v(He,Ze,Ve),Ye=k(He,Ze,Ve);if(Xe<0){var De=Ne-Xe;He=Ne+(He-Ne)*Ne/De,Ze=Ne+(Ze-Ne)*Ne/De,Ve=Ne+(Ve-Ne)*Ne/De}if(Ye>255){var Ue=255-Ne,ht=Ye-Ne;He=Ne+(He-Ne)*Ue/ht,Ze=Ne+(Ze-Ne)*Ue/ht,Ve=Ne+(Ve-Ne)*Ue/ht}}function Me(de,ye,ge){return k(de,ye,ge)-v(de,ye,ge)}function se(de,ye,ge,Pe){var Fe=[de,ye,ge],Ne=k(de,ye,ge),Xe=v(de,ye,ge),Ye;Xe=Xe===de?0:Xe===ye?1:2,Ne=Ne===de?0:Ne===ye?1:2,Ye=v(Xe,Ne)===0?k(Xe,Ne)===1?2:1:0,Fe[Ne]>Fe[Xe]?(Fe[Ye]=(Fe[Ye]-Fe[Xe])*Pe/(Fe[Ne]-Fe[Xe]),Fe[Ne]=Pe):Fe[Ye]=Fe[Ne]=0,Fe[Xe]=0,He=Fe[0],Ze=Fe[1],Ve=Fe[2]}var ne={multiply:function(){He=Ie*$/255,Ze=Ee*te/255,Ve=ze*Ae/255},screen:function(){He=Ie+$-Ie*$/255,Ze=Ee+te-Ee*te/255,Ve=ze+Ae-ze*Ae/255},overlay:function(){He=Ie<128?2*Ie*$/255:255-2*(255-Ie)*(255-$)/255,Ze=Ee<128?2*Ee*te/255:255-2*(255-Ee)*(255-te)/255,Ve=ze<128?2*ze*Ae/255:255-2*(255-ze)*(255-Ae)/255},"soft-light":function(){var de=$*Ie/255;He=de+Ie*(255-(255-Ie)*(255-$)/255-de)/255,de=te*Ee/255,Ze=de+Ee*(255-(255-Ee)*(255-te)/255-de)/255,de=Ae*ze/255,Ve=de+ze*(255-(255-ze)*(255-Ae)/255-de)/255},"hard-light":function(){He=$<128?2*$*Ie/255:255-2*(255-$)*(255-Ie)/255,Ze=te<128?2*te*Ee/255:255-2*(255-te)*(255-Ee)/255,Ve=Ae<128?2*Ae*ze/255:255-2*(255-Ae)*(255-ze)/255},"color-dodge":function(){He=Ie===0?0:$===255?255:v(255,255*Ie/(255-$)),Ze=Ee===0?0:te===255?255:v(255,255*Ee/(255-te)),Ve=ze===0?0:Ae===255?255:v(255,255*ze/(255-Ae))},"color-burn":function(){He=Ie===255?255:$===0?0:k(0,255-(255-Ie)*255/$),Ze=Ee===255?255:te===0?0:k(0,255-(255-Ee)*255/te),Ve=ze===255?255:Ae===0?0:k(0,255-(255-ze)*255/Ae)},darken:function(){He=Ie<$?Ie:$,Ze=Ee<te?Ee:te,Ve=ze<Ae?ze:Ae},lighten:function(){He=Ie>$?Ie:$,Ze=Ee>te?Ee:te,Ve=ze>Ae?ze:Ae},difference:function(){He=Ie-$,He<0&&(He=-He),Ze=Ee-te,Ze<0&&(Ze=-Ze),Ve=ze-Ae,Ve<0&&(Ve=-Ve)},exclusion:function(){He=Ie+$*(255-Ie-Ie)/255,Ze=Ee+te*(255-Ee-Ee)/255,Ve=ze+Ae*(255-ze-ze)/255},hue:function(){se($,te,Ae,Me(Ie,Ee,ze)),rt(He,Ze,Ve,ft(Ie,Ee,ze))},saturation:function(){se(Ie,Ee,ze,Me($,te,Ae)),rt(He,Ze,Ve,ft(Ie,Ee,ze))},luminosity:function(){rt(Ie,Ee,ze,ft($,te,Ae))},color:function(){rt($,te,Ae,ft(Ie,Ee,ze))},add:function(){He=v(Ie+$,255),Ze=v(Ee+te,255),Ve=v(ze+Ae,255)},subtract:function(){He=k(Ie-$,0),Ze=k(Ee-te,0),Ve=k(ze-Ae,0)},average:function(){He=(Ie+$)/2,Ze=(Ee+te)/2,Ve=(ze+Ae)/2},negation:function(){He=255-V(255-$-Ie),Ze=255-V(255-te-Ee),Ve=255-V(255-Ae-ze)}},X=this.nativeModes=b.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(de){this[de]=!0},{}),ie=ln.getContext(1,1,{willReadFrequently:!0});ie&&(b.each(ne,function(de,ye){var ge=ye==="darken",Pe=!1;ie.save();try{ie.fillStyle=ge?"#300":"#a00",ie.fillRect(0,0,1,1),ie.globalCompositeOperation=ye,ie.globalCompositeOperation===ye&&(ie.fillStyle=ge?"#a00":"#300",ie.fillRect(0,0,1,1),Pe=ie.getImageData(0,0,1,1).data[0]!==ge?170:51)}catch{}ie.restore(),X[ye]=Pe}),ln.release(ie)),this.process=function(de,ye,ge,Pe,Fe){var Ne=ye.canvas,Xe=de==="normal";if(Xe||X[de])ge.save(),ge.setTransform(1,0,0,1,0,0),ge.globalAlpha=Pe,Xe||(ge.globalCompositeOperation=de),ge.drawImage(Ne,Fe.x,Fe.y),ge.restore();else{var Ye=ne[de];if(!Ye)return;for(var De=ge.getImageData(Fe.x,Fe.y,Ne.width,Ne.height),Ue=De.data,ht=ye.getImageData(0,0,Ne.width,Ne.height).data,Tt=0,o=Ue.length;Tt<o;Tt+=4){$=ht[Tt],Ie=Ue[Tt],te=ht[Tt+1],Ee=Ue[Tt+1],Ae=ht[Tt+2],ze=Ue[Tt+2],ve=ht[Tt+3],Qe=Ue[Tt+3],Ye();var ke=ve*Pe/255,ai=1-ke;Ue[Tt]=ke*He+ai*Ie,Ue[Tt+1]=ke*Ze+ai*Ee,Ue[Tt+2]=ke*Ve+ai*ze,Ue[Tt+3]=ve*Pe+ai*Qe}ge.putImageData(De,Fe.x,Fe.y)}}},On=new function(){var v="http://www.w3.org/2000/svg",k="http://www.w3.org/2000/xmlns",V="http://www.w3.org/1999/xlink",$={href:V,xlink:k,xmlns:k+"/","xmlns:xlink":k+"/"};function te(Ie,Ee,ze){return ve(g.createElementNS(v,Ie),Ee,ze)}function Ae(Ie,Ee){var ze=$[Ee],Qe=ze?Ie.getAttributeNS(ze,Ee):Ie.getAttribute(Ee);return Qe==="null"?null:Qe}function ve(Ie,Ee,ze){for(var Qe in Ee){var He=Ee[Qe],Ze=$[Qe];typeof He=="number"&&ze&&(He=ze.number(He)),Ze?Ie.setAttributeNS(Ze,Qe,He):Ie.setAttribute(Qe,He)}return Ie}return{svg:v,xmlns:k,xlink:V,create:te,get:Ae,set:ve}},Qn=b.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(v,k){return!k&&(v instanceof Ft||v instanceof xt||v instanceof Gi)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(v,k){var V=b.capitalize(k),$=v[2];this[k]={type:v[1],property:k,attribute:v[0],toSVG:$,fromSVG:$&&b.each($,function(te,Ae){this[te]=Ae},{}),exportFilter:v[3],get:"get"+V,set:"set"+V}},{});new function(){var v;function k(ne,X,ie){var de=new b,ye=ne.getTranslation();if(X){var ge;ne.isInvertible()?(ne=ne._shiftless(),ge=ne._inverseTransform(ye),ye=null):ge=new we,de[ie?"cx":"x"]=ge.x,de[ie?"cy":"y"]=ge.y}if(!ne.isIdentity()){var Pe=ne.decompose();if(Pe){var Fe=[],Ne=Pe.rotation,Xe=Pe.scaling,Ye=Pe.skewing;ye&&!ye.isZero()&&Fe.push("translate("+v.point(ye)+")"),Ne&&Fe.push("rotate("+v.number(Ne)+")"),(!oe.isZero(Xe.x-1)||!oe.isZero(Xe.y-1))&&Fe.push("scale("+v.point(Xe)+")"),Ye.x&&Fe.push("skewX("+v.number(Ye.x)+")"),Ye.y&&Fe.push("skewY("+v.number(Ye.y)+")"),de.transform=Fe.join(" ")}else de.transform="matrix("+ne.getValues().join(",")+")"}return de}function V(ne,X){for(var ie=k(ne._matrix),de=ne._children,ye=On.create("g",ie,v),ge=0,Pe=de.length;ge<Pe;ge++){var Fe=de[ge],Ne=Me(Fe,X);if(Ne)if(Fe.isClipMask()){var Xe=On.create("clipPath");Xe.appendChild(Ne),ft(Fe,Xe,"clip"),On.set(ye,{"clip-path":"url(#"+Xe.id+")"})}else ye.appendChild(Ne)}return ye}function $(ne,X){var ie=k(ne._matrix,!0),de=ne.getSize(),ye=ne.getImage();return ie.x-=de.width/2,ie.y-=de.height/2,ie.width=de.width,ie.height=de.height,ie.href=X.embedImages==!1&&ye&&ye.src||ne.toDataURL(),On.create("image",ie,v)}function te(ne,X){var ie=X.matchShapes;if(ie){var de=ne.toShape(!1);if(de)return Ae(de)}var ye=ne._segments,ge=ye.length,Pe,Fe=k(ne._matrix);if(ie&&ge>=2&&!ne.hasHandles())if(ge>2){Pe=ne._closed?"polygon":"polyline";for(var Ne=[],Xe=0;Xe<ge;Xe++)Ne.push(v.point(ye[Xe]._point));Fe.points=Ne.join(" ")}else{Pe="line";var Ye=ye[0]._point,De=ye[1]._point;Fe.set({x1:Ye.x,y1:Ye.y,x2:De.x,y2:De.y})}else Pe="path",Fe.d=ne.getPathData(null,X.precision);return On.create(Pe,Fe,v)}function Ae(ne){var X=ne._type,ie=ne._radius,de=k(ne._matrix,!0,X!=="rectangle");if(X==="rectangle"){X="rect";var ye=ne._size,ge=ye.width,Pe=ye.height;de.x-=ge/2,de.y-=Pe/2,de.width=ge,de.height=Pe,ie.isZero()&&(ie=null)}return ie&&(X==="circle"?de.r=ie:(de.rx=ie.width,de.ry=ie.height)),On.create(X,de,v)}function ve(ne,X){var ie=k(ne._matrix),de=ne.getPathData(null,X.precision);return de&&(ie.d=de),On.create("path",ie,v)}function Ie(ne,X){var ie=k(ne._matrix,!0),de=ne._definition,ye=Ve(de,"symbol"),ge=de._item,Pe=ge.getStrokeBounds();return ye||(ye=On.create("symbol",{viewBox:v.rectangle(Pe)}),ye.appendChild(Me(ge,X)),ft(de,ye,"symbol")),ie.href="#"+ye.id,ie.x+=Pe.x,ie.y+=Pe.y,ie.width=Pe.width,ie.height=Pe.height,ie.overflow="visible",On.create("use",ie,v)}function Ee(ne){var X=Ve(ne,"color");if(!X){var ie=ne.getGradient(),de=ie._radial,ye=ne.getOrigin(),ge=ne.getDestination(),Pe;if(de){Pe={cx:ye.x,cy:ye.y,r:ye.getDistance(ge)};var Fe=ne.getHighlight();Fe&&(Pe.fx=Fe.x,Pe.fy=Fe.y)}else Pe={x1:ye.x,y1:ye.y,x2:ge.x,y2:ge.y};Pe.gradientUnits="userSpaceOnUse",X=On.create((de?"radial":"linear")+"Gradient",Pe,v);for(var Ne=ie._stops,Xe=0,Ye=Ne.length;Xe<Ye;Xe++){var De=Ne[Xe],Ue=De._color,ht=Ue.getAlpha(),Tt=De._offset;Pe={offset:Tt??Xe/(Ye-1)},Ue&&(Pe["stop-color"]=Ue.toCSS(!0)),ht<1&&(Pe["stop-opacity"]=ht),X.appendChild(On.create("stop",Pe,v))}ft(ne,X,"color")}return"url(#"+X.id+")"}function ze(ne){var X=On.create("text",k(ne._matrix,!0),v);return X.textContent=ne._content,X}var Qe={Group:V,Layer:V,Raster:$,Path:te,Shape:Ae,CompoundPath:ve,SymbolItem:Ie,PointText:ze};function He(ne,X,ie){var de={},ye=!ie&&ne.getParent(),ge=[];return ne._name!=null&&(de.id=ne._name),b.each(Qn,function(Pe){var Fe=Pe.get,Ne=Pe.type,Xe=ne[Fe]();if(Pe.exportFilter?Pe.exportFilter(ne,Xe):!ye||!b.equals(ye[Fe](),Xe)){if(Ne==="color"&&Xe!=null){var Ye=Xe.getAlpha();Ye<1&&(de[Pe.attribute+"-opacity"]=Ye)}Ne==="style"?ge.push(Pe.attribute+": "+Xe):de[Pe.attribute]=Xe==null?"none":Ne==="color"?Xe.gradient?Ee(Xe):Xe.toCSS(!0):Ne==="array"?Xe.join(","):Ne==="lookup"?Pe.toSVG[Xe]:Xe}}),ge.length&&(de.style=ge.join(";")),de.opacity===1&&delete de.opacity,ne._visible||(de.visibility="hidden"),On.set(X,de,v)}var Ze;function Ve(ne,X){return Ze||(Ze={ids:{},svgs:{}}),ne&&Ze.svgs[X+"-"+(ne._id||ne.__id||(ne.__id=fe.get("svg")))]}function ft(ne,X,ie){Ze||Ve();var de=Ze.ids[ie]=(Ze.ids[ie]||0)+1;X.id=ie+"-"+de,Ze.svgs[ie+"-"+(ne._id||ne.__id)]=X}function rt(ne,X){var ie=ne,de=null;if(Ze){ie=ne.nodeName.toLowerCase()==="svg"&&ne;for(var ye in Ze.svgs)de||(ie||(ie=On.create("svg"),ie.appendChild(ne)),de=ie.insertBefore(On.create("defs"),ie.firstChild)),de.appendChild(Ze.svgs[ye]);Ze=null}return X.asString?new t.XMLSerializer().serializeToString(ie):ie}function Me(ne,X,ie){var de=Qe[ne._class],ye=de&&de(ne,X);if(ye){var ge=X.onExport;ge&&(ye=ge(ne,ye,X)||ye);var Pe=JSON.stringify(ne._data);Pe&&Pe!=="{}"&&Pe!=="null"&&ye.setAttribute("data-paper-data",Pe)}return ye&&He(ne,ye,ie)}function se(ne){return ne||(ne={}),v=new ce(ne.precision),ne}Ge.inject({exportSVG:function(ne){return ne=se(ne),rt(Me(this,ne,!0),ne)}}),Rt.inject({exportSVG:function(ne){ne=se(ne);var X=this._children,ie=this.getView(),de=b.pick(ne.bounds,"view"),ye=ne.matrix||de==="view"&&ie._matrix,ge=ye&&kt.read([ye]),Pe=de==="view"?new st([0,0],ie.getViewSize()):de==="content"?Ge._getBounds(X,ge,{stroke:!0}).rect:st.read([de],0,{readNull:!0}),Fe={version:"1.1",xmlns:On.svg,"xmlns:xlink":On.xlink};Pe&&(Fe.width=Pe.width,Fe.height=Pe.height,(Pe.x||Pe.x===0||Pe.y||Pe.y===0)&&(Fe.viewBox=v.rectangle(Pe)));var Ne=On.create("svg",Fe,v),Xe=Ne;ge&&!ge.isIdentity()&&(Xe=Ne.appendChild(On.create("g",k(ge),v)));for(var Ye=0,De=X.length;Ye<De;Ye++)Xe.appendChild(Me(X[Ye],ne,!0));return rt(Ne,ne)}})},new function(){var v={},k;function V(X,ie,de,ye,ge,Pe){var Fe=On.get(X,ie)||Pe,Ne=Fe==null?ye?null:de?"":0:de?Fe:parseFloat(Fe);return/%\s*$/.test(Fe)?Ne/100*(ge?1:k[/x|^width/.test(ie)?"width":"height"]):Ne}function $(X,ie,de,ye,ge,Pe,Fe){return ie=V(X,ie||"x",!1,ye,ge,Pe),de=V(X,de||"y",!1,ye,ge,Fe),ye&&(ie==null||de==null)?null:new we(ie,de)}function te(X,ie,de,ye,ge){return ie=V(X,ie||"width",!1,ye,ge),de=V(X,de||"height",!1,ye,ge),ye&&(ie==null||de==null)?null:new lt(ie,de)}function Ae(X,ie,de){return X==="none"?null:ie==="number"?parseFloat(X):ie==="array"?X?X.split(/[\s,]+/g).map(parseFloat):[]:ie==="color"?Me(X)||X:ie==="lookup"?de[X]:X}function ve(X,ie,de,ye){var ge=X.childNodes,Pe=ie==="clippath",Fe=ie==="defs",Ne=new ni,Xe=Ne._project,Ye=Xe._currentStyle,De=[];if(!Pe&&!Fe&&(Ne=rt(Ne,X,ye),Xe._currentStyle=Ne._style.clone()),ye)for(var Ue=X.querySelectorAll("defs"),ht=0,Tt=Ue.length;ht<Tt;ht++)se(Ue[ht],de,!1);for(var ht=0,Tt=ge.length;ht<Tt;ht++){var o=ge[ht],ke;o.nodeType===1&&!/^defs$/i.test(o.nodeName)&&(ke=se(o,de,!1))&&!(ke instanceof bt)&&De.push(ke)}return Ne.addChildren(De),Pe&&(Ne=rt(Ne.reduce(),X,ye)),Xe._currentStyle=Ye,(Pe||Fe)&&(Ne.remove(),Ne=null),Ne}function Ie(X,ie){for(var de=X.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),ye=[],ge=0,Pe=de.length;ge<Pe;ge+=2)ye.push(new we(parseFloat(de[ge]),parseFloat(de[ge+1])));var Fe=new Dt(ye);return ie==="polygon"&&Fe.closePath(),Fe}function Ee(X){return Ft.create(X.getAttribute("d"))}function ze(X,ie){var de=(V(X,"href",!0)||"").substring(1),ye=ie==="radialgradient",ge;if(de)ge=v[de].getGradient(),ge._radial^ye&&(ge=ge.clone(),ge._radial=ye);else{for(var Pe=X.childNodes,Fe=[],Ne=0,Xe=Pe.length;Ne<Xe;Ne++){var Ye=Pe[Ne];Ye.nodeType===1&&Fe.push(rt(new sn,Ye))}ge=new qi(Fe,ye)}var De,Ue,ht,Tt=V(X,"gradientUnits",!0)!=="userSpaceOnUse";ye?(De=$(X,"cx","cy",!1,Tt,"50%","50%"),Ue=De.add(V(X,"r",!1,!1,Tt,"50%"),0),ht=$(X,"fx","fy",!0,Tt)):(De=$(X,"x1","y1",!1,Tt,"0%","0%"),Ue=$(X,"x2","y2",!1,Tt,"100%","0%"));var o=rt(new $i(ge,De,Ue,ht),X);return o._scaleToBounds=Tt,null}var Qe={"#document":function(X,ie,de,ye){for(var ge=X.childNodes,Pe=0,Fe=ge.length;Pe<Fe;Pe++){var Ne=ge[Pe];if(Ne.nodeType===1)return se(Ne,de,ye)}},g:ve,svg:ve,clippath:ve,polygon:Ie,polyline:Ie,path:Ee,lineargradient:ze,radialgradient:ze,image:function(X){var ie=new _t(V(X,"href",!0));return ie.on("load",function(){var de=te(X);this.setSize(de);var ye=$(X).add(de.divide(2));this._matrix.append(new kt().translate(ye))}),ie},symbol:function(X,ie,de,ye){return new bt(ve(X,ie,de,ye),!0)},defs:ve,use:function(X){var ie=(V(X,"href",!0)||"").substring(1),de=v[ie],ye=$(X);return de?de instanceof bt?de.place(ye):de.clone().translate(ye):null},circle:function(X){return new xt.Circle($(X,"cx","cy"),V(X,"r"))},ellipse:function(X){return new xt.Ellipse({center:$(X,"cx","cy"),radius:te(X,"rx","ry")})},rect:function(X){return new xt.Rectangle(new st($(X),te(X)),te(X,"rx","ry"))},line:function(X){return new Dt.Line($(X,"x1","y1"),$(X,"x2","y2"))},text:function(X){var ie=new rn($(X).add($(X,"dx","dy")));return ie.setContent(X.textContent.trim()||""),ie},switch:ve};function He(X,ie,de,ye){if(X.transform){for(var ge=(ye.getAttribute(de)||"").split(/\)\s*/g),Pe=new kt,Fe=0,Ne=ge.length;Fe<Ne;Fe++){var Xe=ge[Fe];if(!Xe)break;for(var Ye=Xe.split(/\(\s*/),De=Ye[0],Ue=Ye[1].split(/[\s,]+/g),ht=0,Tt=Ue.length;ht<Tt;ht++)Ue[ht]=parseFloat(Ue[ht]);switch(De){case"matrix":Pe.append(new kt(Ue[0],Ue[1],Ue[2],Ue[3],Ue[4],Ue[5]));break;case"rotate":Pe.rotate(Ue[0],Ue[1]||0,Ue[2]||0);break;case"translate":Pe.translate(Ue[0],Ue[1]||0);break;case"scale":Pe.scale(Ue);break;case"skewX":Pe.skew(Ue[0],0);break;case"skewY":Pe.skew(0,Ue[0]);break}}X.transform(Pe)}}function Ze(X,ie,de){var ye=de==="fill-opacity"?"getFillColor":"getStrokeColor",ge=X[ye]&&X[ye]();ge&&ge.setAlpha(parseFloat(ie))}var Ve=b.set(b.each(Qn,function(X){this[X.attribute]=function(ie,de){if(ie[X.set]&&(ie[X.set](Ae(de,X.type,X.fromSVG)),X.type==="color")){var ye=ie[X.get]();if(ye&&ye._scaleToBounds){var ge=ie.getBounds();ye.transform(new kt().translate(ge.getPoint()).scale(ge.getSize()))}}}},{}),{id:function(X,ie){v[ie]=X,X.setName&&X.setName(ie)},"clip-path":function(X,ie){var de=Me(ie);if(de)if(de=de.clone(),de.setClipMask(!0),X instanceof ni)X.insertChild(0,de);else return new ni(de,X)},gradientTransform:He,transform:He,"fill-opacity":Ze,"stroke-opacity":Ze,visibility:function(X,ie){X.setVisible&&X.setVisible(ie==="visible")},display:function(X,ie){X.setVisible&&X.setVisible(ie!==null)},"stop-color":function(X,ie){X.setColor&&X.setColor(ie)},"stop-opacity":function(X,ie){X._color&&X._color.setAlpha(parseFloat(ie))},offset:function(X,ie){if(X.setOffset){var de=ie.match(/(.*)%$/);X.setOffset(de?de[1]/100:parseFloat(ie))}},viewBox:function(X,ie,de,ye,ge){var Pe=new st(Ae(ie,"array")),Fe=te(ye,null,null,!0),Ne,Xe;if(X instanceof ni){var Ye=Fe?Fe.divide(Pe.getSize()):1,Xe=new kt().scale(Ye).translate(Pe.getPoint().negate());Ne=X}else X instanceof bt&&(Fe&&Pe.setSize(Fe),Ne=X._item);if(Ne){if(ft(ye,"overflow",ge)!=="visible"){var De=new xt.Rectangle(Pe);De.setClipMask(!0),Ne.addChild(De)}Xe&&Ne.transform(Xe)}}});function ft(X,ie,de){var ye=X.attributes[ie],ge=ye&&ye.value;if(!ge&&X.style){var Pe=b.camelize(ie);ge=X.style[Pe],!ge&&de.node[Pe]!==de.parent[Pe]&&(ge=de.node[Pe])}return ge?ge==="none"?null:ge:n}function rt(X,ie,de){var ye=ie.parentNode,ge={node:yi.getStyles(ie)||{},parent:!de&&!/^defs$/i.test(ye.tagName)&&yi.getStyles(ye)||{}};return b.each(Ve,function(Pe,Fe){var Ne=ft(ie,Fe,ge);X=Ne!==n&&Pe(X,Ne,Fe,ie,ge)||X}),X}function Me(X){var ie=X&&X.match(/\((?:["'#]*)([^"')]+)/),de=ie&&ie[1],ye=de&&v[c?de.replace(c.location.href.split("#")[0]+"#",""):de];return ye&&ye._scaleToBounds&&(ye=ye.clone(),ye._scaleToBounds=!0),ye}function se(X,ie,de){var ye=X.nodeName.toLowerCase(),ge=ye!=="#document",Pe=g.body,Fe,Ne,Xe;de&&ge&&(k=wn.getView().getSize(),k=te(X,null,null,!0)||k,Fe=On.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),Ne=X.parentNode,Xe=X.nextSibling,Fe.appendChild(X),Pe.appendChild(Fe));var Ye=wn.settings,De=Ye.applyMatrix,Ue=Ye.insertItems;Ye.applyMatrix=!1,Ye.insertItems=!1;var ht=Qe[ye],Tt=ht&&ht(X,ye,ie,de)||null;if(Ye.insertItems=Ue,Ye.applyMatrix=De,Tt){ge&&!(Tt instanceof ni)&&(Tt=rt(Tt,X,de));var o=ie.onImport,ke=ge&&X.getAttribute("data-paper-data");o&&(Tt=o(X,Tt,ie)||Tt),ie.expandShapes&&Tt instanceof xt&&(Tt.remove(),Tt=Tt.toPath()),ke&&(Tt._data=JSON.parse(ke))}return Fe&&(Pe.removeChild(Fe),Ne&&(Xe?Ne.insertBefore(X,Xe):Ne.appendChild(X))),de&&(v={},Tt&&b.pick(ie.applyMatrix,De)&&Tt.matrix.apply(!0,!0)),Tt}function ne(X,ie,de){if(!X)return null;ie=typeof ie=="function"?{onLoad:ie}:ie||{};var ye=wn,ge=null;function Pe(Ye){try{var De=typeof Ye=="object"?Ye:new t.DOMParser().parseFromString(Ye.trim(),"image/svg+xml");if(!De.nodeName)throw De=null,new Error("Unsupported SVG source: "+X);wn=ye,ge=se(De,ie,!0),(!ie||ie.insert!==!1)&&de._insertItem(n,ge);var Ue=ie.onLoad;Ue&&Ue(ge,Ye)}catch(ht){Fe(ht)}}function Fe(Ye,De){var Ue=ie.onError;if(Ue)Ue(Ye,De);else throw new Error(Ye)}if(typeof X=="string"&&!/^[\s\S]*</.test(X)){var Ne=g.getElementById(X);Ne?Pe(Ne):fi.request({url:X,async:!0,onLoad:Pe,onError:Fe})}else if(typeof File<"u"&&X instanceof File){var Xe=new FileReader;return Xe.onload=function(){Pe(Xe.result)},Xe.onerror=function(){Fe(Xe.error)},Xe.readAsText(X)}else Pe(X);return ge}Ge.inject({importSVG:function(X,ie){return ne(X,ie,this)}}),Rt.inject({importSVG:function(X,ie){return this.activate(),ne(X,ie,this)}})},b.exports.PaperScript=(function(){var v=this,k=v.acorn;if(!k&&typeof tT<"u")try{k=rT()}catch{}if(!k){var V,$;k=V=$={},function(rt,Me){if(typeof V=="object"&&typeof $=="object")return Me(V);if(typeof n=="function"&&n.amd)return n(["exports"],Me);Me(rt.acorn||(rt.acorn={}))}(this,function(rt){rt.version="0.5.0";var Me,se,ne,X;rt.parse=function(Ot,ei){return se=String(Ot),ne=se.length,de(ei),pu(),Tl(Me.program)};var ie=rt.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function de(Ot){Me=Ot||{};for(var ei in ie)Object.prototype.hasOwnProperty.call(Me,ei)||(Me[ei]=ie[ei]);X=Me.sourceFile||null}var ye=rt.getLineInfo=function(Ot,ei){for(var xi=1,Oi=0;;){Ha.lastIndex=Oi;var Ln=Ha.exec(Ot);if(Ln&&Ln.index<ei)++xi,Oi=Ln.index+Ln[0].length;else break}return{line:xi,column:ei-Oi}};rt.tokenize=function(Ot,ei){se=String(Ot),ne=se.length,de(ei),pu();var xi={};function Oi(Ln){return ke=Fe,ja(Ln),xi.start=Pe,xi.end=Fe,xi.startLoc=Ne,xi.endLoc=Xe,xi.type=Ye,xi.value=De,xi}return Oi.jumpTo=function(Ln,Un){if(ge=Ln,Me.locations){ht=1,Tt=Ha.lastIndex=0;for(var or;(or=Ha.exec(se))&&or.index<Ln;)++ht,Tt=or.index+or[0].length}Ue=Un,to()},Oi};var ge,Pe,Fe,Ne,Xe,Ye,De,Ue,ht,Tt,o,ke,ai,di,Ai,Kt;function oi(Ot,ei){var xi=ye(se,Ot);ei+=" ("+xi.line+":"+xi.column+")";var Oi=new SyntaxError(ei);throw Oi.pos=Ot,Oi.loc=xi,Oi.raisedAt=ge,Oi}var Ri=[],vi={type:"num"},wi={type:"regexp"},Yt={type:"string"},vn={type:"name"},ar={type:"eof"},dn={keyword:"break"},Vn={keyword:"case",beforeExpr:!0},Hr={keyword:"catch"},Hi={keyword:"continue"},lr={keyword:"debugger"},Fn={keyword:"default"},Qt={keyword:"do",isLoop:!0},Yi={keyword:"else",beforeExpr:!0},Ut={keyword:"finally"},En={keyword:"for",isLoop:!0},ur={keyword:"function"},Ns={keyword:"if"},Vr={keyword:"return",beforeExpr:!0},Vt={keyword:"switch"},cr={keyword:"throw",beforeExpr:!0},Lt={keyword:"try"},Br={keyword:"var"},Vs={keyword:"while",isLoop:!0},ua={keyword:"with"},kr={keyword:"new",beforeExpr:!0},Fa={keyword:"this"},zo={keyword:"null",atomValue:null},Oa={keyword:"true",atomValue:!0},Xs={keyword:"false",atomValue:!1},jn={keyword:"in",binop:7,beforeExpr:!0},aa={break:dn,case:Vn,catch:Hr,continue:Hi,debugger:lr,default:Fn,do:Qt,else:Yi,finally:Ut,for:En,function:ur,if:Ns,return:Vr,switch:Vt,throw:cr,try:Lt,var:Br,while:Vs,with:ua,null:zo,true:Oa,false:Xs,new:kr,in:jn,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Fa,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ls={type:"[",beforeExpr:!0},Na={type:"]"},rl={type:"{",beforeExpr:!0},sl={type:"}"},Ja={type:"(",beforeExpr:!0},Va={type:")"},N={type:",",beforeExpr:!0},xe={type:";",beforeExpr:!0},tt={type:":",beforeExpr:!0},It={type:"."},Wt={type:"?",beforeExpr:!0},Si={binop:10,beforeExpr:!0},Bi={isAssign:!0,beforeExpr:!0},un={isAssign:!0,beforeExpr:!0},An={postfix:!0,prefix:!0,isUpdate:!0},rr={prefix:!0,beforeExpr:!0},hr={binop:1,beforeExpr:!0},zr={binop:2,beforeExpr:!0},Ua={binop:3,beforeExpr:!0},Ga={binop:4,beforeExpr:!0},qa={binop:5,beforeExpr:!0},pl={binop:6,beforeExpr:!0},Ur={binop:7,beforeExpr:!0},ir={binop:8,beforeExpr:!0},wr={binop:9,prefix:!0,beforeExpr:!0},Mr={binop:10,beforeExpr:!0};rt.tokTypes={bracketL:ls,bracketR:Na,braceL:rl,braceR:sl,parenL:Ja,parenR:Va,comma:N,semi:xe,colon:tt,dot:It,question:Wt,slash:Si,eq:Bi,name:vn,eof:ar,num:vi,regexp:wi,string:Yt};for(var js in aa)rt.tokTypes["_"+js]=aa[js];function vr(Ot){Ot=Ot.split(" ");var ei="",xi=[];e:for(var Oi=0;Oi<Ot.length;++Oi){for(var Ln=0;Ln<xi.length;++Ln)if(xi[Ln][0].length==Ot[Oi].length){xi[Ln].push(Ot[Oi]);continue e}xi.push([Ot[Oi]])}function Un(Yn){if(Yn.length==1)return ei+="return str === "+JSON.stringify(Yn[0])+";";ei+="switch(str){";for(var qs=0;qs<Yn.length;++qs)ei+="case "+JSON.stringify(Yn[qs])+":";ei+="return true}return false;"}if(xi.length>3){xi.sort(function(Yn,qs){return qs.length-Yn.length}),ei+="switch(str.length){";for(var Oi=0;Oi<xi.length;++Oi){var or=xi[Oi];ei+="case "+or[0].length+":",Un(or)}ei+="}"}else Un(Ot);return new Function("str",ei)}var Ks=vr("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Pr=vr("class enum extends super const export import"),bo=vr("implements interface let package private protected public static yield"),Ho=vr("eval arguments"),Ls=vr("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Il=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ho="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",jo="------------------------------------------------------------------------------------------------------------------------------------------",ca=new RegExp("["+ho+"]"),Ys=new RegExp("["+ho+jo+"]"),El=/[\n\r\u2028\u2029]/,Ha=/\r\n|[\n\r\u2028\u2029]/g,Ta=rt.isIdentifierStart=function(Ot){return Ot<65?Ot===36:Ot<91?!0:Ot<97?Ot===95:Ot<123?!0:Ot>=170&&ca.test(String.fromCharCode(Ot))},ml=rt.isIdentifierChar=function(Ot){return Ot<48?Ot===36:Ot<58?!0:Ot<65?!1:Ot<91?!0:Ot<97?Ot===95:Ot<123?!0:Ot>=170&&Ys.test(String.fromCharCode(Ot))};function Cl(){this.line=ht,this.column=ge-Tt}function pu(){ht=1,ge=Tt=0,Ue=!0,to()}function us(Ot,ei){Fe=ge,Me.locations&&(Xe=new Cl),Ye=Ot,to(),De=ei,Ue=Ot.beforeExpr}function sc(){var Ot=Me.onComment&&Me.locations&&new Cl,ei=ge,xi=se.indexOf("*/",ge+=2);if(xi===-1&&oi(ge-2,"Unterminated comment"),ge=xi+2,Me.locations){Ha.lastIndex=ei;for(var Oi;(Oi=Ha.exec(se))&&Oi.index<ge;)++ht,Tt=Oi.index+Oi[0].length}Me.onComment&&Me.onComment(!0,se.slice(ei+2,xi),ei,ge,Ot,Me.locations&&new Cl)}function eo(){for(var Ot=ge,ei=Me.onComment&&Me.locations&&new Cl,xi=se.charCodeAt(ge+=2);ge<ne&&xi!==10&&xi!==13&&xi!==8232&&xi!==8233;)++ge,xi=se.charCodeAt(ge);Me.onComment&&Me.onComment(!1,se.slice(Ot+2,ge),Ot,ge,ei,Me.locations&&new Cl)}function to(){for(;ge<ne;){var Ot=se.charCodeAt(ge);if(Ot===32)++ge;else if(Ot===13){++ge;var ei=se.charCodeAt(ge);ei===10&&++ge,Me.locations&&(++ht,Tt=ge)}else if(Ot===10||Ot===8232||Ot===8233)++ge,Me.locations&&(++ht,Tt=ge);else if(Ot>8&&Ot<14)++ge;else if(Ot===47){var ei=se.charCodeAt(ge+1);if(ei===42)sc();else if(ei===47)eo();else break}else if(Ot===160)++ge;else if(Ot>=5760&&Il.test(String.fromCharCode(Ot)))++ge;else break}}function ql(){var Ot=se.charCodeAt(ge+1);return Ot>=48&&Ot<=57?Yo(!0):(++ge,us(It))}function Ro(){var Ot=se.charCodeAt(ge+1);return Ue?(++ge,mu()):Ot===61?Ts(un,2):Ts(Si,1)}function Zo(){var Ot=se.charCodeAt(ge+1);return Ot===61?Ts(un,2):Ts(Mr,1)}function wo(Ot){var ei=se.charCodeAt(ge+1);return ei===Ot?Ts(Ot===124?hr:zr,2):ei===61?Ts(un,2):Ts(Ot===124?Ua:qa,1)}function Us(){var Ot=se.charCodeAt(ge+1);return Ot===61?Ts(un,2):Ts(Ga,1)}function Qo(Ot){var ei=se.charCodeAt(ge+1);return ei===Ot?ei==45&&se.charCodeAt(ge+2)==62&&El.test(se.slice(ke,ge))?(ge+=3,eo(),to(),ja()):Ts(An,2):ei===61?Ts(un,2):Ts(wr,1)}function Wo(Ot){var ei=se.charCodeAt(ge+1),xi=1;return ei===Ot?(xi=Ot===62&&se.charCodeAt(ge+2)===62?3:2,se.charCodeAt(ge+xi)===61?Ts(un,xi+1):Ts(ir,xi)):ei==33&&Ot==60&&se.charCodeAt(ge+2)==45&&se.charCodeAt(ge+3)==45?(ge+=4,eo(),to(),ja()):(ei===61&&(xi=se.charCodeAt(ge+2)===61?3:2),Ts(Ur,xi))}function Xo(Ot){var ei=se.charCodeAt(ge+1);return ei===61?Ts(pl,se.charCodeAt(ge+2)===61?3:2):Ts(Ot===61?Bi:rr,1)}function ba(Ot){switch(Ot){case 46:return ql();case 40:return++ge,us(Ja);case 41:return++ge,us(Va);case 59:return++ge,us(xe);case 44:return++ge,us(N);case 91:return++ge,us(ls);case 93:return++ge,us(Na);case 123:return++ge,us(rl);case 125:return++ge,us(sl);case 58:return++ge,us(tt);case 63:return++ge,us(Wt);case 48:var ei=se.charCodeAt(ge+1);if(ei===120||ei===88)return Xn();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Yo(!1);case 34:case 39:return Dr(Ot);case 47:return Ro();case 37:case 42:return Zo();case 124:case 38:return wo(Ot);case 94:return Us();case 43:case 45:return Qo(Ot);case 60:case 62:return Wo(Ot);case 61:case 33:return Xo(Ot);case 126:return Ts(rr,1)}return!1}function ja(Ot){if(Ot?ge=Pe+1:Pe=ge,Me.locations&&(Ne=new Cl),Ot)return mu();if(ge>=ne)return us(ar);var ei=se.charCodeAt(ge);if(Ta(ei)||ei===92)return So();var xi=ba(ei);if(xi===!1){var Oi=String.fromCharCode(ei);if(Oi==="\\"||ca.test(Oi))return So();oi(ge,"Unexpected character '"+Oi+"'")}return xi}function Ts(Ot,ei){var xi=se.slice(ge,ge+ei);ge+=ei,us(Ot,xi)}function mu(){for(var Ln="",Ot,ei,xi=ge;;){ge>=ne&&oi(xi,"Unterminated regular expression");var Oi=se.charAt(ge);if(El.test(Oi)&&oi(xi,"Unterminated regular expression"),Ot)Ot=!1;else{if(Oi==="[")ei=!0;else if(Oi==="]"&&ei)ei=!1;else if(Oi==="/"&&!ei)break;Ot=Oi==="\\"}++ge}var Ln=se.slice(xi,ge);++ge;var Un=Ar();Un&&!/^[gmsiy]*$/.test(Un)&&oi(xi,"Invalid regexp flag");try{var or=new RegExp(Ln,Un)}catch(Yn){Yn instanceof SyntaxError&&oi(xi,Yn.message),oi(Yn)}return us(wi,or)}function Sr(Ot,ei){for(var xi=ge,Oi=0,Ln=0,Un=ei??1/0;Ln<Un;++Ln){var or=se.charCodeAt(ge),Yn;if(or>=97?Yn=or-97+10:or>=65?Yn=or-65+10:or>=48&&or<=57?Yn=or-48:Yn=1/0,Yn>=Ot)break;++ge,Oi=Oi*Ot+Yn}return ge===xi||ei!=null&&ge-xi!==ei?null:Oi}function Xn(){ge+=2;var Ot=Sr(16);return Ot==null&&oi(Pe+2,"Expected hexadecimal number"),Ta(se.charCodeAt(ge))&&oi(ge,"Identifier directly after number"),us(vi,Ot)}function Yo(Ot){var ei=ge,xi=!1,Oi=se.charCodeAt(ge)===48;!Ot&&Sr(10)===null&&oi(ei,"Invalid number"),se.charCodeAt(ge)===46&&(++ge,Sr(10),xi=!0);var Ln=se.charCodeAt(ge);(Ln===69||Ln===101)&&(Ln=se.charCodeAt(++ge),(Ln===43||Ln===45)&&++ge,Sr(10)===null&&oi(ei,"Invalid number"),xi=!0),Ta(se.charCodeAt(ge))&&oi(ge,"Identifier directly after number");var Un=se.slice(ei,ge),or;return xi?or=parseFloat(Un):!Oi||Un.length===1?or=parseInt(Un,10):/[89]/.test(Un)||Kt?oi(ei,"Invalid number"):or=parseInt(Un,8),us(vi,or)}function Dr(Ot){ge++;for(var ei="";;){ge>=ne&&oi(Pe,"Unterminated string constant");var xi=se.charCodeAt(ge);if(xi===Ot)return++ge,us(Yt,ei);if(xi===92){xi=se.charCodeAt(++ge);var Oi=/^[0-7]+/.exec(se.slice(ge,ge+3));for(Oi&&(Oi=Oi[0]);Oi&&parseInt(Oi,8)>255;)Oi=Oi.slice(0,-1);if(Oi==="0"&&(Oi=null),++ge,Oi)Kt&&oi(ge-2,"Octal literal in strict mode"),ei+=String.fromCharCode(parseInt(Oi,8)),ge+=Oi.length-1;else switch(xi){case 110:ei+=`
`;break;case 114:ei+="\r";break;case 120:ei+=String.fromCharCode(Za(2));break;case 117:ei+=String.fromCharCode(Za(4));break;case 85:ei+=String.fromCharCode(Za(8));break;case 116:ei+="	";break;case 98:ei+="\b";break;case 118:ei+="\v";break;case 102:ei+="\f";break;case 48:ei+="\0";break;case 13:se.charCodeAt(ge)===10&&++ge;case 10:Me.locations&&(Tt=ge,++ht);break;default:ei+=String.fromCharCode(xi);break}}else(xi===13||xi===10||xi===8232||xi===8233)&&oi(Pe,"Unterminated string constant"),ei+=String.fromCharCode(xi),++ge}}function Za(Ot){var ei=Sr(16,Ot);return ei===null&&oi(Pe,"Bad character escape sequence"),ei}var Kr;function Ar(){Kr=!1;for(var Ot,ei=!0,xi=ge;;){var Oi=se.charCodeAt(ge);if(ml(Oi))Kr&&(Ot+=se.charAt(ge)),++ge;else if(Oi===92){Kr||(Ot=se.slice(xi,ge)),Kr=!0,se.charCodeAt(++ge)!=117&&oi(ge,"Expecting Unicode escape sequence \\uXXXX"),++ge;var Ln=Za(4),Un=String.fromCharCode(Ln);Un||oi(ge-1,"Invalid Unicode escape"),(ei?Ta(Ln):ml(Ln))||oi(ge-4,"Invalid Unicode escape"),Ot+=Un}else break;ei=!1}return Kr?Ot:se.slice(xi,ge)}function So(){var Ot=Ar(),ei=vn;return!Kr&&Ls(Ot)&&(ei=aa[Ot]),us(ei,Ot)}function Nn(){o=Pe,ke=Fe,ai=Xe,ja()}function Ol(Ot){if(Kt=Ot,ge=Pe,Me.locations)for(;ge<Tt;)Tt=se.lastIndexOf(`
`,Tt-2)+1,--ht;to(),ja()}function Jr(){this.type=null,this.start=Pe,this.end=null}function jr(){this.start=Ne,this.end=null,X!==null&&(this.source=X)}function ks(){var Ot=new Jr;return Me.locations&&(Ot.loc=new jr),Me.directSourceFile&&(Ot.sourceFile=Me.directSourceFile),Me.ranges&&(Ot.range=[Pe,0]),Ot}function Cr(Ot){var ei=new Jr;return ei.start=Ot.start,Me.locations&&(ei.loc=new jr,ei.loc.start=Ot.loc.start),Me.ranges&&(ei.range=[Ot.range[0],0]),ei}function nr(Ot,ei){return Ot.type=ei,Ot.end=ke,Me.locations&&(Ot.loc.end=ai),Me.ranges&&(Ot.range[1]=ke),Ot}function al(Ot){return Me.ecmaVersion>=5&&Ot.type==="ExpressionStatement"&&Ot.expression.type==="Literal"&&Ot.expression.value==="use strict"}function Xr(Ot){if(Ye===Ot)return Nn(),!0}function Io(){return!Me.strictSemicolons&&(Ye===ar||Ye===sl||El.test(se.slice(ke,Pe)))}function ol(){!Xr(xe)&&!Io()&&hs()}function Zr(Ot){Ye===Ot?Nn():hs()}function hs(){oi(Pe,"Unexpected token")}function wa(Ot){Ot.type!=="Identifier"&&Ot.type!=="MemberExpression"&&oi(Ot.start,"Assigning to rvalue"),Kt&&Ot.type==="Identifier"&&Ho(Ot.name)&&oi(Ot.start,"Assigning to "+Ot.name+" in strict mode")}function Tl(Ot){o=ke=ge,Me.locations&&(ai=new Cl),di=Kt=null,Ai=[],ja();var ei=Ot||ks(),xi=!0;for(Ot||(ei.body=[]);Ye!==ar;){var Oi=Ao();ei.body.push(Oi),xi&&al(Oi)&&Ol(!0),xi=!1}return nr(ei,"Program")}var Eo={kind:"loop"},kl={kind:"switch"};function Ao(){(Ye===Si||Ye===un&&De=="/=")&&ja(!0);var Ot=Ye,ei=ks();switch(Ot){case dn:case Hi:Nn();var xi=Ot===dn;Xr(xe)||Io()?ei.label=null:Ye!==vn?hs():(ei.label=Di(),ol());for(var Oi=0;Oi<Ai.length;++Oi){var Ln=Ai[Oi];if((ei.label==null||Ln.name===ei.label.name)&&(Ln.kind!=null&&(xi||Ln.kind==="loop")||ei.label&&xi))break}return Oi===Ai.length&&oi(ei.start,"Unsyntactic "+Ot.keyword),nr(ei,xi?"BreakStatement":"ContinueStatement");case lr:return Nn(),ol(),nr(ei,"DebuggerStatement");case Qt:return Nn(),Ai.push(Eo),ei.body=Ao(),Ai.pop(),Zr(Vs),ei.test=Js(),ol(),nr(ei,"DoWhileStatement");case En:if(Nn(),Ai.push(Eo),Zr(Ja),Ye===xe)return Qa(ei,null);if(Ye===Br){var Un=ks();return Nn(),Yr(Un,!0),nr(Un,"VariableDeclaration"),Un.declarations.length===1&&Xr(jn)?$o(ei,Un):Qa(ei,Un)}var Un=mr(!1,!0);return Xr(jn)?(wa(Un),$o(ei,Un)):Qa(ei,Un);case ur:return Nn(),mi(ei,!0);case Ns:return Nn(),ei.test=Js(),ei.consequent=Ao(),ei.alternate=Xr(Yi)?Ao():null,nr(ei,"IfStatement");case Vr:return!di&&!Me.allowReturnOutsideFunction&&oi(Pe,"'return' outside of function"),Nn(),Xr(xe)||Io()?ei.argument=null:(ei.argument=mr(),ol()),nr(ei,"ReturnStatement");case Vt:Nn(),ei.discriminant=Js(),ei.cases=[],Zr(rl),Ai.push(kl);for(var or,Yn;Ye!=sl;)if(Ye===Vn||Ye===Fn){var qs=Ye===Vn;or&&nr(or,"SwitchCase"),ei.cases.push(or=ks()),or.consequent=[],Nn(),qs?or.test=mr():(Yn&&oi(o,"Multiple default clauses"),Yn=!0,or.test=null),Zr(tt)}else or||hs(),or.consequent.push(Ao());return or&&nr(or,"SwitchCase"),Nn(),Ai.pop(),nr(ei,"SwitchStatement");case cr:return Nn(),El.test(se.slice(ke,Pe))&&oi(ke,"Illegal newline after throw"),ei.argument=mr(),ol(),nr(ei,"ThrowStatement");case Lt:if(Nn(),ei.block=Gs(),ei.handler=null,Ye===Hr){var Ms=ks();Nn(),Zr(Ja),Ms.param=Di(),Kt&&Ho(Ms.param.name)&&oi(Ms.param.start,"Binding "+Ms.param.name+" in strict mode"),Zr(Va),Ms.guard=null,Ms.body=Gs(),ei.handler=nr(Ms,"CatchClause")}return ei.guardedHandlers=Ri,ei.finalizer=Xr(Ut)?Gs():null,!ei.handler&&!ei.finalizer&&oi(ei.start,"Missing catch or finally clause"),nr(ei,"TryStatement");case Br:return Nn(),Yr(ei),ol(),nr(ei,"VariableDeclaration");case Vs:return Nn(),ei.test=Js(),Ai.push(Eo),ei.body=Ao(),Ai.pop(),nr(ei,"WhileStatement");case ua:return Kt&&oi(Pe,"'with' in strict mode"),Nn(),ei.object=Js(),ei.body=Ao(),nr(ei,"WithStatement");case rl:return Gs();case xe:return Nn(),nr(ei,"EmptyStatement");default:var As=De,Xa=mr();if(Ot===vn&&Xa.type==="Identifier"&&Xr(tt)){for(var Oi=0;Oi<Ai.length;++Oi)Ai[Oi].name===As&&oi(Xa.start,"Label '"+As+"' is already declared");var po=Ye.isLoop?"loop":Ye===Vt?"switch":null;return Ai.push({name:As,kind:po}),ei.body=Ao(),Ai.pop(),ei.label=Xa,nr(ei,"LabeledStatement")}else return ei.expression=Xa,ol(),nr(ei,"ExpressionStatement")}}function Js(){Zr(Ja);var Ot=mr();return Zr(Va),Ot}function Gs(Ot){var ei=ks(),xi=!0,Oi=!1,Ln;for(ei.body=[],Zr(rl);!Xr(sl);){var Un=Ao();ei.body.push(Un),xi&&Ot&&al(Un)&&(Ln=Oi,Ol(Oi=!0)),xi=!1}return Oi&&!Ln&&Ol(!1),nr(ei,"BlockStatement")}function Qa(Ot,ei){return Ot.init=ei,Zr(xe),Ot.test=Ye===xe?null:mr(),Zr(xe),Ot.update=Ye===Va?null:mr(),Zr(Va),Ot.body=Ao(),Ai.pop(),nr(Ot,"ForStatement")}function $o(Ot,ei){return Ot.left=ei,Ot.right=mr(),Zr(Va),Ot.body=Ao(),Ai.pop(),nr(Ot,"ForInStatement")}function Yr(Ot,ei){for(Ot.declarations=[],Ot.kind="var";;){var xi=ks();if(xi.id=Di(),Kt&&Ho(xi.id.name)&&oi(xi.id.start,"Binding "+xi.id.name+" in strict mode"),xi.init=Xr(Bi)?mr(!0,ei):null,Ot.declarations.push(nr(xi,"VariableDeclarator")),!Xr(N))break}return Ot}function mr(Ot,ei){var xi=Rr(ei);if(!Ot&&Ye===N){var Oi=Cr(xi);for(Oi.expressions=[xi];Xr(N);)Oi.expressions.push(Rr(ei));return nr(Oi,"SequenceExpression")}return xi}function Rr(Ot){var ei=ha(Ot);if(Ye.isAssign){var xi=Cr(ei);return xi.operator=De,xi.left=ei,Nn(),xi.right=Rr(Ot),wa(ei),nr(xi,"AssignmentExpression")}return ei}function ha(Ot){var ei=fo(Ot);if(Xr(Wt)){var xi=Cr(ei);return xi.test=ei,xi.consequent=mr(!0),Zr(tt),xi.alternate=mr(!0,Ot),nr(xi,"ConditionalExpression")}return ei}function fo(Ot){return ea(Sa(),-1,Ot)}function ea(Ot,ei,xi){var Oi=Ye.binop;if(Oi!=null&&(!xi||Ye!==jn)&&Oi>ei){var Ln=Cr(Ot);Ln.left=Ot,Ln.operator=De;var Un=Ye;Nn(),Ln.right=ea(Sa(),Oi,xi);var or=nr(Ln,Un===hr||Un===zr?"LogicalExpression":"BinaryExpression");return ea(or,ei,xi)}return Ot}function Sa(){if(Ye.prefix){var Ot=ks(),ei=Ye.isUpdate;return Ot.operator=De,Ot.prefix=!0,Ue=!0,Nn(),Ot.argument=Sa(),ei?wa(Ot.argument):Kt&&Ot.operator==="delete"&&Ot.argument.type==="Identifier"&&oi(Ot.start,"Deleting local variable in strict mode"),nr(Ot,ei?"UpdateExpression":"UnaryExpression")}for(var xi=ka();Ye.postfix&&!Io();){var Ot=Cr(xi);Ot.operator=De,Ot.prefix=!1,Ot.argument=xi,wa(xi),Nn(),xi=nr(Ot,"UpdateExpression")}return xi}function ka(){return Wa(ll())}function Wa(Ot,ei){if(Xr(It)){var xi=Cr(Ot);return xi.object=Ot,xi.property=Di(!0),xi.computed=!1,Wa(nr(xi,"MemberExpression"),ei)}else if(Xr(ls)){var xi=Cr(Ot);return xi.object=Ot,xi.property=mr(),xi.computed=!0,Zr(Na),Wa(nr(xi,"MemberExpression"),ei)}else if(!ei&&Xr(Ja)){var xi=Cr(Ot);return xi.callee=Ot,xi.arguments=Ni(Va,!1),Wa(nr(xi,"CallExpression"),ei)}else return Ot}function ll(){switch(Ye){case Fa:var Oi=ks();return Nn(),nr(Oi,"ThisExpression");case vn:return Di();case vi:case Yt:case wi:var Oi=ks();return Oi.value=De,Oi.raw=se.slice(Pe,Fe),Nn(),nr(Oi,"Literal");case zo:case Oa:case Xs:var Oi=ks();return Oi.value=Ye.atomValue,Oi.raw=Ye.keyword,Nn(),nr(Oi,"Literal");case Ja:var Ot=Ne,ei=Pe;Nn();var xi=mr();return xi.start=ei,xi.end=Fe,Me.locations&&(xi.loc.start=Ot,xi.loc.end=Xe),Me.ranges&&(xi.range=[ei,Fe]),Zr(Va),xi;case ls:var Oi=ks();return Nn(),Oi.elements=Ni(Na,!0,!0),nr(Oi,"ArrayExpression");case rl:return gl();case ur:var Oi=ks();return Nn(),mi(Oi,!1);case kr:return ou();default:hs()}}function ou(){var Ot=ks();return Nn(),Ot.callee=Wa(ll(),!0),Xr(Ja)?Ot.arguments=Ni(Va,!1):Ot.arguments=Ri,nr(Ot,"NewExpression")}function gl(){var Ot=ks(),ei=!0,xi=!1;for(Ot.properties=[],Nn();!Xr(sl);){if(ei)ei=!1;else if(Zr(N),Me.allowTrailingCommas&&Xr(sl))break;var Oi={key:io()},Ln=!1,Un;if(Xr(tt)?(Oi.value=mr(!0),Un=Oi.kind="init"):Me.ecmaVersion>=5&&Oi.key.type==="Identifier"&&(Oi.key.name==="get"||Oi.key.name==="set")?(Ln=xi=!0,Un=Oi.kind=Oi.key.name,Oi.key=io(),Ye!==Ja&&hs(),Oi.value=mi(ks(),!1)):hs(),Oi.key.type==="Identifier"&&(Kt||xi))for(var or=0;or<Ot.properties.length;++or){var Yn=Ot.properties[or];if(Yn.key.name===Oi.key.name){var qs=Un==Yn.kind||Ln&&Yn.kind==="init"||Un==="init"&&(Yn.kind==="get"||Yn.kind==="set");qs&&!Kt&&Un==="init"&&Yn.kind==="init"&&(qs=!1),qs&&oi(Oi.key.start,"Redefinition of property")}}Ot.properties.push(Oi)}return nr(Ot,"ObjectExpression")}function io(){return Ye===vi||Ye===Yt?ll():Di(!0)}function mi(Ot,ei){Ye===vn?Ot.id=Di():ei?hs():Ot.id=null,Ot.params=[];var xi=!0;for(Zr(Ja);!Xr(Va);)xi?xi=!1:Zr(N),Ot.params.push(Di());var Oi=di,Ln=Ai;if(di=!0,Ai=[],Ot.body=Gs(!0),di=Oi,Ai=Ln,Kt||Ot.body.body.length&&al(Ot.body.body[0]))for(var Un=Ot.id?-1:0;Un<Ot.params.length;++Un){var or=Un<0?Ot.id:Ot.params[Un];if((bo(or.name)||Ho(or.name))&&oi(or.start,"Defining '"+or.name+"' in strict mode"),Un>=0)for(var Yn=0;Yn<Un;++Yn)or.name===Ot.params[Yn].name&&oi(or.start,"Argument name clash in strict mode")}return nr(Ot,ei?"FunctionDeclaration":"FunctionExpression")}function Ni(Ot,ei,xi){for(var Oi=[],Ln=!0;!Xr(Ot);){if(Ln)Ln=!1;else if(Zr(N),ei&&Me.allowTrailingCommas&&Xr(Ot))break;xi&&Ye===N?Oi.push(null):Oi.push(mr(!0))}return Oi}function Di(Ot){var ei=ks();return Ot&&Me.forbidReserved=="everywhere"&&(Ot=!1),Ye===vn?(!Ot&&(Me.forbidReserved&&(Me.ecmaVersion===3?Ks:Pr)(De)||Kt&&bo(De))&&se.slice(Pe,Fe).indexOf("\\")==-1&&oi(Pe,"The keyword '"+De+"' is reserved"),ei.name=De):Ot&&Ye.keyword?ei.name=Ye.keyword:hs(),Ue=!1,Nn(),nr(ei,"Identifier")}}),k.version||(k=null)}function te(rt,Me){return(v.acorn||k).parse(rt,Me)}var Ae={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},ve={"-":"__negate","+":"__self"},Ie=b.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(rt){this["__"+rt]="#"+rt},{__self:function(){return this}});we.inject(Ie),lt.inject(Ie),$i.inject(Ie);function Ee(rt,Me,se){var ne=Ae[Me];if(rt&&rt[ne]){var X=rt[ne](se);return Me==="!="?!X:X}switch(Me){case"+":return rt+se;case"-":return rt-se;case"*":return rt*se;case"/":return rt/se;case"%":return rt%se;case"==":return rt==se;case"!=":return rt!=se}}function ze(rt,Me){var se=ve[rt];if(Me&&Me[se])return Me[se]();switch(rt){case"+":return+Me;case"-":return-Me}}function Qe(rt,Me){if(!rt)return"";Me=Me||{};var se=[];function ne(Kt){for(var oi=0,Ri=se.length;oi<Ri;oi++){var vi=se[oi];if(vi[0]>=Kt)break;Kt+=vi[1]}return Kt}function X(Kt){return rt.substring(ne(Kt.range[0]),ne(Kt.range[1]))}function ie(Kt,oi){return rt.substring(ne(Kt.range[1]),ne(oi.range[0]))}function de(Kt,oi){for(var Ri=ne(Kt.range[0]),vi=ne(Kt.range[1]),wi=0,Yt=se.length-1;Yt>=0;Yt--)if(Ri>se[Yt][0]){wi=Yt+1;break}se.splice(wi,0,[Ri,oi.length-vi+Ri]),rt=rt.substring(0,Ri)+oi+rt.substring(vi)}function ye(Kt,oi){switch(Kt.type){case"UnaryExpression":if(Kt.operator in ve&&Kt.argument.type!=="Literal"){var Ri=X(Kt.argument);de(Kt,'$__("'+Kt.operator+'", '+Ri+")")}break;case"BinaryExpression":if(Kt.operator in Ae&&Kt.left.type!=="Literal"){var vi=X(Kt.left),wi=X(Kt.right),Yt=ie(Kt.left,Kt.right),vn=Kt.operator;de(Kt,"__$__("+vi+","+Yt.replace(new RegExp("\\"+vn),'"'+vn+'"')+", "+wi+")")}break;case"UpdateExpression":case"AssignmentExpression":var ar=oi&&oi.type;if(!(ar==="ForStatement"||ar==="BinaryExpression"&&/^[=!<>]/.test(oi.operator)||ar==="MemberExpression"&&oi.computed)){if(Kt.type==="UpdateExpression"){var Ri=X(Kt.argument),dn="__$__("+Ri+', "'+Kt.operator[0]+'", 1)',Vn=Ri+" = "+dn;Kt.prefix?Vn="("+Vn+")":(ar==="AssignmentExpression"||ar==="VariableDeclarator"||ar==="BinaryExpression")&&(X(oi.left||oi.id)===Ri&&(Vn=dn),Vn=Ri+"; "+Vn),de(Kt,Vn)}else if(/^.=$/.test(Kt.operator)&&Kt.left.type!=="Literal"){var vi=X(Kt.left),wi=X(Kt.right),dn=vi+" = __$__("+vi+', "'+Kt.operator[0]+'", '+wi+")";de(Kt,/^\(.*\)$/.test(X(Kt))?"("+dn+")":dn)}}break}}function ge(Kt){switch(Kt.type){case"ExportDefaultDeclaration":de({range:[Kt.start,Kt.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var oi=Kt.declaration,Ri=Kt.specifiers;if(oi){var vi=oi.declarations;vi&&(vi.forEach(function(Yt){de(Yt,"module.exports."+X(Yt))}),de({range:[Kt.start,oi.start+oi.kind.length]},""))}else if(Ri){var wi=Ri.map(function(Yt){var vn=X(Yt);return"module.exports."+vn+" = "+vn+"; "}).join("");wi&&de(Kt,wi)}break}}function Pe(Kt,oi,Ri){if(Kt){for(var vi in Kt)if(vi!=="range"&&vi!=="loc"){var wi=Kt[vi];if(Array.isArray(wi))for(var Yt=0,vn=wi.length;Yt<vn;Yt++)Pe(wi[Yt],Kt,Ri);else wi&&typeof wi=="object"&&Pe(wi,Kt,Ri)}Ri.operatorOverloading!==!1&&ye(Kt,oi),Ri.moduleExports!==!1&&ge(Kt)}}function Fe(Kt){var oi="",Ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Kt=(Math.abs(Kt)<<1)+(Kt<0?1:0);Kt||!oi;){var vi=Kt&31;Kt>>=5,Kt&&(vi|=32),oi+=Ri[vi]}return oi}var Ne=Me.url||"",Xe=Me.sourceMaps,Ye=Me.paperFeatures||{},De=Me.source||rt,Ue=Me.offset||0,ht=wn.agent,Tt=ht.versionNumber,o=!1,ke=/\r\n|\n|\r/mg,ai;if(Xe&&(ht.chrome&&Tt>=30||ht.webkit&&Tt>=537.76||ht.firefox&&Tt>=23||ht.node)){if(ht.node)Ue-=2;else if(c&&Ne&&!c.location.href.indexOf(Ne)){var di=g.getElementsByTagName("html")[0].innerHTML;Ue=di.substr(0,di.indexOf(rt)+1).match(ke).length+1}o=Ue>0&&!(ht.chrome&&Tt>=36||ht.safari&&Tt>=600||ht.firefox&&Tt>=40||ht.node);var Ai=["AA"+Fe(o?0:Ue)+"A"];Ai.length=(rt.match(ke)||[]).length+1+(o?Ue:0),ai={version:3,file:Ne,names:[],mappings:Ai.join(";AACA"),sourceRoot:"",sources:[Ne],sourcesContent:[De]}}return(Ye.operatorOverloading!==!1||Ye.moduleExports!==!1)&&Pe(te(rt,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,Ye),ai&&(o&&(rt=new Array(Ue+1).join(`
`)+rt),/^(inline|both)$/.test(Xe)&&(rt+=`
//# sourceMappingURL=data:application/json;base64,`+t.btoa(unescape(encodeURIComponent(JSON.stringify(ai))))),rt+=`
//# sourceURL=`+(Ne||"paperscript")),{url:Ne,source:De,code:rt,map:ai}}function He(rt,Me,se){wn=Me;var ne=Me.getView(),X=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(rt)&&!/\bnew\s+Tool\b/.test(rt)?new Mn:null,ie=X?X._events:[],de=["onFrame","onResize"].concat(ie),ye=[],ge=[],Pe,Fe=typeof rt=="object"?rt:Qe(rt,se);rt=Fe.code;function Ne(Tt,o){for(var ke in Tt)(o||!/^_/.test(ke))&&new RegExp("([\\b\\s\\W]|^)"+ke.replace(/\$/g,"\\$")+"\\b").test(rt)&&(ye.push(ke),ge.push(Tt[ke]))}Ne({__$__:Ee,$__:ze,paper:Me,tool:X},!0),Ne(Me),rt="var module = { exports: {} }; "+rt;var Ue=b.each(de,function(Tt){new RegExp("\\s+"+Tt+"\\b").test(rt)&&(ye.push(Tt),this.push("module.exports."+Tt+" = "+Tt+";"))},[]).join(`
`);Ue&&(rt+=`
`+Ue),rt+=`
return module.exports;`;var Xe=wn.agent;if(g&&(Xe.chrome||Xe.firefox&&Xe.versionNumber<40)){var Ye=g.createElement("script"),De=g.head||g.getElementsByTagName("head")[0];Xe.firefox&&(rt=`
`+rt),Ye.appendChild(g.createTextNode("document.__paperscript__ = function("+ye+") {"+rt+`
}`)),De.appendChild(Ye),Pe=g.__paperscript__,delete g.__paperscript__,De.removeChild(Ye)}else Pe=Function(ye,rt);var Ue=Pe&&Pe.apply(Me,ge),ht=Ue||{};return b.each(ie,function(Tt){var o=ht[Tt];o&&(X[Tt]=o)}),ne&&(ht.onResize&&ne.setOnResize(ht.onResize),ne.emit("resize",{size:ne.size,delta:new we}),ht.onFrame&&ne.setOnFrame(ht.onFrame),ne.requestUpdate()),Ue}function Ze(rt){if(/^text\/(?:x-|)paperscript$/.test(rt.type)&&a.getAttribute(rt,"ignore")!=="true"){var Me=a.getAttribute(rt,"canvas"),se=g.getElementById(Me),ne=rt.src||rt.getAttribute("data-src"),X=a.hasAttribute(rt,"async"),ie="data-paper-scope";if(!se)throw new Error('Unable to find canvas with id "'+Me+'"');var de=a.get(se.getAttribute(ie))||new a().setup(se);return se.setAttribute(ie,de._id),ne?fi.request({url:ne,async:X,mimeType:"text/plain",onLoad:function(ye){He(ye,de,ne)}}):He(rt.innerHTML,de,rt.baseURI),rt.setAttribute("data-paper-ignore","true"),de}}function Ve(){b.each(g&&g.getElementsByTagName("script"),Ze)}function ft(rt){return rt?Ze(rt):Ve()}return c&&(g.readyState==="complete"?setTimeout(Ve):hi.add(c,{load:Ve})),{compile:Qe,execute:He,load:ft,parse:te,calculateBinary:Ee,calculateUnary:ze}}).call(this);var wn=new(a.inject(b.exports,{Base:b,Numerical:oe,Key:gi,DomEvent:hi,DomElement:yi,document:g,window:c,Symbol:bt,PlacedSymbol:mt}));return wn.agent.node&&gx(wn),typeof n=="function"&&n.amd?n("paper",wn):e&&(e.exports=wn),wn}).call(Kf,typeof self=="object"?self:null)})(o3);var D1=o3.exports;function sT(e){let t,n,c="Click and drag to draw a polygon. Press Escape to exit.",g,b;return{c(){t=qn("div"),n=qn("span"),n.textContent=c,g=Or(),b=qn("canvas"),this.h()},l(E){t=Hn(E,"DIV",{class:!0});var a=Tn(t);n=Hn(a,"SPAN",{class:!0,"data-svelte-h":!0}),ec(n)!=="svelte-1m9xrla"&&(n.textContent=c),g=Nr(a),b=Hn(a,"CANVAS",{class:!0}),Tn(b).forEach(Ci),a.forEach(Ci),this.h()},h(){Fi(n,"class","svelte-jrtjeu"),Fi(b,"class","canvas svelte-jrtjeu"),Fi(t,"class","draw-wrapper svelte-jrtjeu")},m(E,a){Zn(E,t,a),Qi(t,n),Qi(t,g),Qi(t,b),e[5](b)},p:lo,i:lo,o:lo,d(E){E&&Ci(t),e[5](null)}}}function aT(e,t,n){let{path:c}=t,{updatePath:g}=t,{updateIsDrawing:b}=t,{isDrawing:E}=t,a,U;Zc(()=>{D1.setup(U);let ce=new D1.Tool;ce.onMouseDown=function(oe){n(1,c=new D1.Path),n(1,c.strokeColor="white",c),c.add(oe.point)},ce.onMouseDrag=function(oe){a&&c.add(oe.point)},ce.onMouseUp=function(oe){if(!a)return;c.simplify(.5),c.clearHandles(),n(1,c.closed=!0,c);let fe=[];for(let we of c.segments){console.log();let et=we.point;fe.push({x:et.x,y:et.y})}g(fe),b(!1)},ce.onKeyDown=function(oe){console.log(oe),oe.key==="escape"&&b(!1)}});function W(ce){pa[ce?"unshift":"push"](()=>{U=ce,n(0,U)})}return e.$$set=ce=>{"path"in ce&&n(1,c=ce.path),"updatePath"in ce&&n(2,g=ce.updatePath),"updateIsDrawing"in ce&&n(3,b=ce.updateIsDrawing),"isDrawing"in ce&&n(4,E=ce.isDrawing)},e.$$.update=()=>{e.$$.dirty&16&&(a=E)},[U,c,g,b,E,W]}class oT extends Lo{constructor(t){super(),Bo(this,t,aT,sT,co,{path:1,updatePath:2,updateIsDrawing:3,isDrawing:4})}}const p_=["pd","mpd","mntd","tree_sizes"],m_={pd:"phylodiversity",mpd:"mean pairwise phylogenetic distance",mntd:"mean nearest-taxon phylogenetic distance"};function lT(e){if(!e||!p_.includes(e))return;const n=650;let c=new Array(n),g=[0,1];const b=yx[1]/n;let E;switch(e){case"mntd":case"rel_mntd":E=om.mntd;break;case"mpd":case"rel_mpd":E=om.mpd;break;default:case"pd":E=om.pd}let a=E.d,U=E.b,W=E.e,ce=E.c,oe=E.modelHigh,fe=E.modelLow,we=E.minY,et=E.maxY,lt=2;for(let Ke=0;Ke<n;Ke++){let st=(Ke+lt)*b;c[Ke]={x:st,high:oe({x:st,b:U.high,c:ce.high,d:a.high,e:W.high}),low:fe({x:st,b:U.low,c:ce.low,d:a.low,e:W.low})}}return g=[we,et],{confidence:c,yAxis:g,xAxis:yx,xAxisLabel:"Tree Size",yAxisLabel:E.yAxisLabel}}const yx=[0,150],om={pd:{b:{low:-.7043,high:-.6657},c:{low:23.0845,high:240.3973},d:{low:19970.5549,high:19686.1185},e:{low:3792.2577,high:4198.5041},minY:100,maxY:5e3,yAxisLabel:"Phylodiversity (pd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mpd:{b:{low:-.6143,high:.4445},c:{low:6.3176,high:97.3052},d:{low:102.0496,high:150.1521},e:{low:1.9251,high:2.2335},minY:0,maxY:200,yAxisLabel:"Mean pairwise phylogenetic distance (mpd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))},mntd:{b:{low:.9954,high:.8694},c:{low:6.054,high:5.1347},d:{low:33.1945,high:185.9164},e:{low:52.3284,high:7.0013},minY:0,maxY:150,yAxisLabel:"Mean nearest-taxon phylogenetic distance (mntd)",modelHigh:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g)))),modelLow:({x:e,b:t,c:n,d:c,e:g})=>n+(c-n)/(1+Math.exp(t*(Math.log(e)-Math.log(g))))}};function uT(e,t,n){if(t==-1)return 0;let c;switch(e){case"mntd":case"rel_mntd":c=om.mntd;break;case"mpd":case"rel_mpd":c=om.mpd;break;default:case"pd":c=om.pd}let g=c.d,b=c.b,E=c.e,a=c.c,U=c.modelHigh,W=c.modelLow;U({x:n,b:b.high,c:a.high,d:g.high,e:E.high});let ce=W({x:n,b:b.low,c:a.low,d:g.low,e:E.low});return t-ce}function vx(e,t,n){const c=e.slice();return c[5]=t[n],c}function xx(e){let t,n=`${e[5][2]} ${m_[e[0]]??""}`,c;return{c(){t=qn("span"),c=Po(n),this.h()},l(g){t=Hn(g,"SPAN",{class:!0});var b=Tn(t);c=Do(b,n),b.forEach(Ci),this.h()},h(){Fi(t,"class","svelte-1u4zhbe")},m(g,b){Zn(g,t,b),Qi(t,c)},p(g,b){b&3&&n!==(n=`${g[5][2]} ${m_[g[0]]??""}`)&&ju(c,n)},d(g){g&&Ci(t)}}}function bx(e){let t,n=e[5][2]&&xx(e);return{c(){n&&n.c(),t=gs()},l(c){n&&n.l(c),t=gs()},m(c,g){n&&n.m(c,g),Zn(c,t,g)},p(c,g){c[5][2]?n?n.p(c,g):(n=xx(c),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(c){c&&Ci(t),n&&n.d(c)}}}function cT(e){let t,n,c,g,b,E=_c(e[1]),a=[];for(let U=0;U<E.length;U+=1)a[U]=bx(vx(e,E,U));return{c(){t=qn("div"),n=qn("div"),g=Or(),b=qn("div");for(let U=0;U<a.length;U+=1)a[U].c();this.h()},l(U){t=Hn(U,"DIV",{class:!0});var W=Tn(t);n=Hn(W,"DIV",{class:!0,style:!0}),Tn(n).forEach(Ci),g=Nr(W),b=Hn(W,"DIV",{class:!0});var ce=Tn(b);for(let oe=0;oe<a.length;oe+=1)a[oe].l(ce);ce.forEach(Ci),W.forEach(Ci),this.h()},h(){Fi(n,"class","gradient svelte-1u4zhbe"),Fi(n,"style",c=`background-image: url("/phast/SVG/ticks.svg"), ${e[2]}`),Fi(b,"class","label-container svelte-1u4zhbe"),Fi(t,"class","legend-container svelte-1u4zhbe")},m(U,W){Zn(U,t,W),Qi(t,n),Qi(t,g),Qi(t,b);for(let ce=0;ce<a.length;ce+=1)a[ce]&&a[ce].m(b,null)},p(U,[W]){if(W&4&&c!==(c=`background-image: url("/phast/SVG/ticks.svg"), ${U[2]}`)&&Fi(n,"style",c),W&3){E=_c(U[1]);let ce;for(ce=0;ce<E.length;ce+=1){const oe=vx(U,E,ce);a[ce]?a[ce].p(oe,W):(a[ce]=bx(oe),a[ce].c(),a[ce].m(b,null))}for(;ce<a.length;ce+=1)a[ce].d(1);a.length=E.length}},i:lo,o:lo,d(U){U&&Ci(t),U0(a,U)}}}function hT(e,t,n){let c=d_(),g,{colorScheme:b}=t,{metric:E}=t;function a(U){let W=`linear-gradient(${U.map(ce=>ce[1]).flat().reverse()})`;return console.log(W),W}return e.$$set=U=>{"colorScheme"in U&&n(3,b=U.colorScheme),"metric"in U&&n(0,E=U.metric)},e.$$.update=()=>{e.$$.dirty&8&&n(1,c=d_(0,1,b).slice(1)),e.$$.dirty&2&&n(2,g=a(c))},[E,c,g,b,a]}class AT extends Lo{constructor(t){super(),Bo(this,t,hT,cT,co,{colorScheme:3,metric:0,createPaletteGradient:4})}get createPaletteGradient(){return this.$$.ctx[4]}}function fT(e){let t,n,c,g,b,E,a,U,W,ce,oe,fe,we;return{c(){t=Ba("svg"),n=Ba("defs"),c=Ba("style"),g=Po(`.cls-1 {\r
        fill: #29abe2;\r
      }\r
    `),b=Ba("g"),E=Ba("g"),a=Ba("g"),U=Ba("path"),W=Ba("path"),ce=Ba("path"),oe=Ba("path"),fe=Ba("path"),we=Ba("polygon"),this.h()},l(et){t=za(et,"svg",{id:!0,"data-name":!0,xmlns:!0,viewBox:!0});var lt=Tn(t);n=za(lt,"defs",{});var Ke=Tn(n);c=za(Ke,"style",{});var st=Tn(c);g=Do(st,`.cls-1 {\r
        fill: #29abe2;\r
      }\r
    `),st.forEach(Ci),Ke.forEach(Ci),b=za(lt,"g",{id:!0,"data-name":!0});var ut=Tn(b);E=za(ut,"g",{});var kt=Tn(E);a=za(kt,"g",{});var Bt=Tn(a);U=za(Bt,"path",{class:!0,d:!0}),Tn(U).forEach(Ci),W=za(Bt,"path",{class:!0,d:!0}),Tn(W).forEach(Ci),ce=za(Bt,"path",{class:!0,d:!0}),Tn(ce).forEach(Ci),oe=za(Bt,"path",{class:!0,d:!0}),Tn(oe).forEach(Ci),fe=za(Bt,"path",{class:!0,d:!0}),Tn(fe).forEach(Ci),Bt.forEach(Ci),we=za(kt,"polygon",{class:!0,points:!0}),Tn(we).forEach(Ci),kt.forEach(Ci),ut.forEach(Ci),lt.forEach(Ci),this.h()},h(){Fi(U,"class","cls-1"),Fi(U,"d","m9.41.16c1.38,0,2.18.92,1.92,2.28-.33,1.76-1.73,2.88-3.52,2.98l-1.2.06-1.13,3.08-1.68.12L6.91.16h2.5Zm-1.4,1.58l-.8,2.12.87-.03c.93-.03,1.38-.63,1.48-1.19.1-.56-.12-.92-.86-.91h-.68Z"),Fi(W,"class","cls-1"),Fi(W,"d","m14.62,7.9l1.24-3.16-2.79.12-1.25,3.24-1.68.12L13.24.15h1.69s-1.21,3.04-1.21,3.04l2.8-.08,1.21-2.96h1.7s-3.11,7.63-3.11,7.63l-1.7.12Z"),Fi(ce,"class","cls-1"),Fi(ce,"d","m22.82,5.85l-2.81.16-1.15,1.58-1.89.14L22.88.14h1.96s-.36,7.04-.36,7.04l-1.75.13.1-1.46Zm-1.65-1.38l1.75-.08.19-2.47-1.94,2.54Z"),Fi(oe,"class","cls-1"),Fi(oe,"d","m29.21,4.99c.06-.27,0-.48-.4-.63l-.81-.29c-.94-.34-1.26-1.02-1.08-1.84.3-1.36,1.78-2.23,3.24-2.23,2.08,0,2.33,1.22,2.18,1.89l-1.62.26c.04-.19.1-.88-.92-.86-.62,0-1.07.4-1.15.77-.08.34.12.52.39.63l.73.28c1.08.4,1.41,1,1.22,1.82-.23,1.05-1.46,2.18-3.22,2.31-2.15.16-2.61-1.14-2.41-2.06.03-.13.05-.21.08-.27l1.6-.32s-.05.14-.07.23c-.12.58.14,1.13,1.06,1.09.65-.04,1.09-.34,1.18-.77Z"),Fi(fe,"class","cls-1"),Fi(fe,"d","m36.78,1.44l-2.45,5.03-1.69.12,2.44-5.13-2.22.04.67-1.38h6.04s-.67,1.28-.67,1.28l-2.12.03Z"),Fi(we,"class","cls-1"),Fi(we,"points","3.79 .23 1.5 .23 0 2.22 .8 4.21 3.09 4.21 4.59 2.22 3.79 .23"),Fi(b,"id","Layer_1-2"),Fi(b,"data-name","Layer 1"),Fi(t,"id","Layer_2"),Fi(t,"data-name","Layer 2"),Fi(t,"xmlns","http://www.w3.org/2000/svg"),Fi(t,"viewBox","0 0 39.57 8.68")},m(et,lt){Zn(et,t,lt),Qi(t,n),Qi(n,c),Qi(c,g),Qi(t,b),Qi(b,E),Qi(E,a),Qi(a,U),Qi(a,W),Qi(a,ce),Qi(a,oe),Qi(a,fe),Qi(E,we)},p:lo,i:lo,o:lo,d(et){et&&Ci(t)}}}class dT extends Lo{constructor(t){super(),Bo(this,t,null,fT,co,{})}}function Kg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function pT(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function l3(e){let t,n,c;e.length!==2?(t=Kg,n=(a,U)=>Kg(e(a),U),c=(a,U)=>e(a)-U):(t=e===Kg||e===pT?e:mT,n=e,c=e);function g(a,U,W=0,ce=a.length){if(W<ce){if(t(U,U)!==0)return ce;do{const oe=W+ce>>>1;n(a[oe],U)<0?W=oe+1:ce=oe}while(W<ce)}return W}function b(a,U,W=0,ce=a.length){if(W<ce){if(t(U,U)!==0)return ce;do{const oe=W+ce>>>1;n(a[oe],U)<=0?W=oe+1:ce=oe}while(W<ce)}return W}function E(a,U,W=0,ce=a.length){const oe=g(a,U,W,ce-1);return oe>W&&c(a[oe-1],U)>-c(a[oe],U)?oe-1:oe}return{left:g,center:E,right:b}}function mT(){return 0}function gT(e){return e===null?NaN:+e}const _T=l3(Kg),yT=_T.right;l3(gT).center;function wx(e,t){let n,c;if(t===void 0)for(const g of e)g!=null&&(n===void 0?g>=g&&(n=c=g):(n>g&&(n=g),c<g&&(c=g)));else{let g=-1;for(let b of e)(b=t(b,++g,e))!=null&&(n===void 0?b>=b&&(n=c=b):(n>b&&(n=b),c<b&&(c=b)))}return[n,c]}const vT=Math.sqrt(50),xT=Math.sqrt(10),bT=Math.sqrt(2);function g_(e,t,n){const c=(t-e)/Math.max(0,n),g=Math.floor(Math.log10(c)),b=c/Math.pow(10,g),E=b>=vT?10:b>=xT?5:b>=bT?2:1;let a,U,W;return g<0?(W=Math.pow(10,-g)/E,a=Math.round(e*W),U=Math.round(t*W),a/W<e&&++a,U/W>t&&--U,W=-W):(W=Math.pow(10,g)*E,a=Math.round(e/W),U=Math.round(t/W),a*W<e&&++a,U*W>t&&--U),U<a&&.5<=n&&n<2?g_(e,t,n*2):[a,U,W]}function wT(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const c=t<e,[g,b,E]=c?g_(t,e,n):g_(e,t,n);if(!(b>=g))return[];const a=b-g+1,U=new Array(a);if(c)if(E<0)for(let W=0;W<a;++W)U[W]=(b-W)/-E;else for(let W=0;W<a;++W)U[W]=(b-W)*E;else if(E<0)for(let W=0;W<a;++W)U[W]=(g+W)/-E;else for(let W=0;W<a;++W)U[W]=(g+W)*E;return U}function By(e,t,n){return t=+t,e=+e,n=+n,g_(e,t,n)[2]}function ST(e,t,n){t=+t,e=+e,n=+n;const c=t<e,g=c?By(t,e,n):By(e,t,n);return(c?-1:1)*(g<0?1/-g:g)}function IT(e){return e}var L1=1,B1=2,zy=3,ig=4,Sx=1e-6;function ET(e){return"translate("+e+",0)"}function CT(e){return"translate(0,"+e+")"}function TT(e){return t=>+e(t)}function kT(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function MT(){return!this.__axis}function u3(e,t){var n=[],c=null,g=null,b=6,E=6,a=3,U=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===L1||e===ig?-1:1,ce=e===ig||e===B1?"x":"y",oe=e===L1||e===zy?ET:CT;function fe(we){var et=c??(t.ticks?t.ticks.apply(t,n):t.domain()),lt=g??(t.tickFormat?t.tickFormat.apply(t,n):IT),Ke=Math.max(b,0)+a,st=t.range(),ut=+st[0]+U,kt=+st[st.length-1]+U,Bt=(t.bandwidth?kT:TT)(t.copy(),U),Rt=we.selection?we.selection():we,Ge=Rt.selectAll(".domain").data([null]),ni=Rt.selectAll(".tick").data(et,t).order(),it=ni.exit(),xt=ni.enter().append("g").attr("class","tick"),_t=ni.select("line"),mt=ni.select("text");Ge=Ge.merge(Ge.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ni=ni.merge(xt),_t=_t.merge(xt.append("line").attr("stroke","currentColor").attr(ce+"2",W*b)),mt=mt.merge(xt.append("text").attr("fill","currentColor").attr(ce,W*Ke).attr("dy",e===L1?"0em":e===zy?"0.71em":"0.32em")),we!==Rt&&(Ge=Ge.transition(we),ni=ni.transition(we),_t=_t.transition(we),mt=mt.transition(we),it=it.transition(we).attr("opacity",Sx).attr("transform",function(bt){return isFinite(bt=Bt(bt))?oe(bt+U):this.getAttribute("transform")}),xt.attr("opacity",Sx).attr("transform",function(bt){var dt=this.parentNode.__axis;return oe((dt&&isFinite(dt=dt(bt))?dt:Bt(bt))+U)})),it.remove(),Ge.attr("d",e===ig||e===B1?E?"M"+W*E+","+ut+"H"+U+"V"+kt+"H"+W*E:"M"+U+","+ut+"V"+kt:E?"M"+ut+","+W*E+"V"+U+"H"+kt+"V"+W*E:"M"+ut+","+U+"H"+kt),ni.attr("opacity",1).attr("transform",function(bt){return oe(Bt(bt)+U)}),_t.attr(ce+"2",W*b),mt.attr(ce,W*Ke).text(lt),Rt.filter(MT).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===B1?"start":e===ig?"end":"middle"),Rt.each(function(){this.__axis=Bt})}return fe.scale=function(we){return arguments.length?(t=we,fe):t},fe.ticks=function(){return n=Array.from(arguments),fe},fe.tickArguments=function(we){return arguments.length?(n=we==null?[]:Array.from(we),fe):n.slice()},fe.tickValues=function(we){return arguments.length?(c=we==null?null:Array.from(we),fe):c&&c.slice()},fe.tickFormat=function(we){return arguments.length?(g=we,fe):g},fe.tickSize=function(we){return arguments.length?(b=E=+we,fe):b},fe.tickSizeInner=function(we){return arguments.length?(b=+we,fe):b},fe.tickSizeOuter=function(we){return arguments.length?(E=+we,fe):E},fe.tickPadding=function(we){return arguments.length?(a=+we,fe):a},fe.offset=function(we){return arguments.length?(U=+we,fe):U},fe}function PT(e){return u3(zy,e)}function DT(e){return u3(ig,e)}var LT={value:()=>{}};function c3(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new Jg(n)}function Jg(e){this._=e}function BT(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}Jg.prototype=c3.prototype={constructor:Jg,on:function(e,t){var n=this._,c=BT(e+"",n),g,b=-1,E=c.length;if(arguments.length<2){for(;++b<E;)if((g=(e=c[b]).type)&&(g=zT(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++b<E;)if(g=(e=c[b]).type)n[g]=Ix(n[g],e.name,t);else if(t==null)for(g in n)n[g]=Ix(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Jg(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,b;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(b=this._[e],c=0,g=b.length;c<g;++c)b[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,b=c.length;g<b;++g)c[g].value.apply(t,n)}};function zT(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function Ix(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=LT,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ry="http://www.w3.org/1999/xhtml";const Ex={svg:"http://www.w3.org/2000/svg",xhtml:Ry,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function X_(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ex.hasOwnProperty(t)?{space:Ex[t],local:e}:e}function RT(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ry&&t.documentElement.namespaceURI===Ry?t.createElement(e):t.createElementNS(n,e)}}function FT(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function h3(e){var t=X_(e);return(t.local?FT:RT)(t)}function OT(){}function Dv(e){return e==null?OT:function(){return this.querySelector(e)}}function NT(e){typeof e!="function"&&(e=Dv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],E=b.length,a=c[g]=new Array(E),U,W,ce=0;ce<E;++ce)(U=b[ce])&&(W=e.call(U,U.__data__,ce,b))&&("__data__"in U&&(W.__data__=U.__data__),a[ce]=W);return new ph(c,this._parents)}function VT(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function UT(){return[]}function A3(e){return e==null?UT:function(){return this.querySelectorAll(e)}}function GT(e){return function(){return VT(e.apply(this,arguments))}}function qT(e){typeof e=="function"?e=GT(e):e=A3(e);for(var t=this._groups,n=t.length,c=[],g=[],b=0;b<n;++b)for(var E=t[b],a=E.length,U,W=0;W<a;++W)(U=E[W])&&(c.push(e.call(U,U.__data__,W,E)),g.push(U));return new ph(c,g)}function f3(e){return function(){return this.matches(e)}}function d3(e){return function(t){return t.matches(e)}}var HT=Array.prototype.find;function jT(e){return function(){return HT.call(this.children,e)}}function ZT(){return this.firstElementChild}function QT(e){return this.select(e==null?ZT:jT(typeof e=="function"?e:d3(e)))}var WT=Array.prototype.filter;function XT(){return Array.from(this.children)}function YT(e){return function(){return WT.call(this.children,e)}}function $T(e){return this.selectAll(e==null?XT:YT(typeof e=="function"?e:d3(e)))}function KT(e){typeof e!="function"&&(e=f3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],E=b.length,a=c[g]=[],U,W=0;W<E;++W)(U=b[W])&&e.call(U,U.__data__,W,b)&&a.push(U);return new ph(c,this._parents)}function p3(e){return new Array(e.length)}function JT(){return new ph(this._enter||this._groups.map(p3),this._parents)}function __(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}__.prototype={constructor:__,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function e6(e){return function(){return e}}function t6(e,t,n,c,g,b){for(var E=0,a,U=t.length,W=b.length;E<W;++E)(a=t[E])?(a.__data__=b[E],c[E]=a):n[E]=new __(e,b[E]);for(;E<U;++E)(a=t[E])&&(g[E]=a)}function i6(e,t,n,c,g,b,E){var a,U,W=new Map,ce=t.length,oe=b.length,fe=new Array(ce),we;for(a=0;a<ce;++a)(U=t[a])&&(fe[a]=we=E.call(U,U.__data__,a,t)+"",W.has(we)?g[a]=U:W.set(we,U));for(a=0;a<oe;++a)we=E.call(e,b[a],a,b)+"",(U=W.get(we))?(c[a]=U,U.__data__=b[a],W.delete(we)):n[a]=new __(e,b[a]);for(a=0;a<ce;++a)(U=t[a])&&W.get(fe[a])===U&&(g[a]=U)}function n6(e){return e.__data__}function r6(e,t){if(!arguments.length)return Array.from(this,n6);var n=t?i6:t6,c=this._parents,g=this._groups;typeof e!="function"&&(e=e6(e));for(var b=g.length,E=new Array(b),a=new Array(b),U=new Array(b),W=0;W<b;++W){var ce=c[W],oe=g[W],fe=oe.length,we=s6(e.call(ce,ce&&ce.__data__,W,c)),et=we.length,lt=a[W]=new Array(et),Ke=E[W]=new Array(et),st=U[W]=new Array(fe);n(ce,oe,lt,Ke,st,we,t);for(var ut=0,kt=0,Bt,Rt;ut<et;++ut)if(Bt=lt[ut]){for(ut>=kt&&(kt=ut+1);!(Rt=Ke[kt])&&++kt<et;);Bt._next=Rt||null}}return E=new ph(E,c),E._enter=a,E._exit=U,E}function s6(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function a6(){return new ph(this._exit||this._groups.map(p3),this._parents)}function o6(e,t,n){var c=this.enter(),g=this,b=this.exit();return typeof e=="function"?(c=e(c),c&&(c=c.selection())):c=c.append(e+""),t!=null&&(g=t(g),g&&(g=g.selection())),n==null?b.remove():n(b),c&&g?c.merge(g).order():g}function l6(e){for(var t=e.selection?e.selection():e,n=this._groups,c=t._groups,g=n.length,b=c.length,E=Math.min(g,b),a=new Array(g),U=0;U<E;++U)for(var W=n[U],ce=c[U],oe=W.length,fe=a[U]=new Array(oe),we,et=0;et<oe;++et)(we=W[et]||ce[et])&&(fe[et]=we);for(;U<g;++U)a[U]=n[U];return new ph(a,this._parents)}function u6(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,b=c[g],E;--g>=0;)(E=c[g])&&(b&&E.compareDocumentPosition(b)^4&&b.parentNode.insertBefore(E,b),b=E);return this}function c6(e){e||(e=h6);function t(oe,fe){return oe&&fe?e(oe.__data__,fe.__data__):!oe-!fe}for(var n=this._groups,c=n.length,g=new Array(c),b=0;b<c;++b){for(var E=n[b],a=E.length,U=g[b]=new Array(a),W,ce=0;ce<a;++ce)(W=E[ce])&&(U[ce]=W);U.sort(t)}return new ph(g,this._parents).order()}function h6(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function A6(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function f6(){return Array.from(this)}function d6(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length;g<b;++g){var E=c[g];if(E)return E}return null}function p6(){let e=0;for(const t of this)++e;return e}function m6(){return!this.node()}function g6(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],b=0,E=g.length,a;b<E;++b)(a=g[b])&&e.call(a,a.__data__,b,g);return this}function _6(e){return function(){this.removeAttribute(e)}}function y6(e){return function(){this.removeAttributeNS(e.space,e.local)}}function v6(e,t){return function(){this.setAttribute(e,t)}}function x6(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function b6(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function w6(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function S6(e,t){var n=X_(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?y6:_6:typeof t=="function"?n.local?w6:b6:n.local?x6:v6)(n,t))}function m3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function I6(e){return function(){this.style.removeProperty(e)}}function E6(e,t,n){return function(){this.style.setProperty(e,t,n)}}function C6(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function T6(e,t,n){return arguments.length>1?this.each((t==null?I6:typeof t=="function"?C6:E6)(e,t,n??"")):fm(this.node(),e)}function fm(e,t){return e.style.getPropertyValue(t)||m3(e).getComputedStyle(e,null).getPropertyValue(t)}function k6(e){return function(){delete this[e]}}function M6(e,t){return function(){this[e]=t}}function P6(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function D6(e,t){return arguments.length>1?this.each((t==null?k6:typeof t=="function"?P6:M6)(e,t)):this.node()[e]}function g3(e){return e.trim().split(/^|\s+/)}function Lv(e){return e.classList||new _3(e)}function _3(e){this._node=e,this._names=g3(e.getAttribute("class")||"")}_3.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function y3(e,t){for(var n=Lv(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function v3(e,t){for(var n=Lv(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function L6(e){return function(){y3(this,e)}}function B6(e){return function(){v3(this,e)}}function z6(e,t){return function(){(t.apply(this,arguments)?y3:v3)(this,e)}}function R6(e,t){var n=g3(e+"");if(arguments.length<2){for(var c=Lv(this.node()),g=-1,b=n.length;++g<b;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?z6:t?L6:B6)(n,t))}function F6(){this.textContent=""}function O6(e){return function(){this.textContent=e}}function N6(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function V6(e){return arguments.length?this.each(e==null?F6:(typeof e=="function"?N6:O6)(e)):this.node().textContent}function U6(){this.innerHTML=""}function G6(e){return function(){this.innerHTML=e}}function q6(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function H6(e){return arguments.length?this.each(e==null?U6:(typeof e=="function"?q6:G6)(e)):this.node().innerHTML}function j6(){this.nextSibling&&this.parentNode.appendChild(this)}function Z6(){return this.each(j6)}function Q6(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function W6(){return this.each(Q6)}function X6(e){var t=typeof e=="function"?e:h3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Y6(){return null}function $6(e,t){var n=typeof e=="function"?e:h3(e),c=t==null?Y6:typeof t=="function"?t:Dv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function K6(){var e=this.parentNode;e&&e.removeChild(this)}function J6(){return this.each(K6)}function e8(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function t8(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function i8(e){return this.select(e?t8:e8)}function n8(e){return arguments.length?this.property("__data__",e):this.node().__data__}function r8(e){return function(t){e.call(this,t,this.__data__)}}function s8(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function a8(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,b;n<g;++n)b=t[n],(!e.type||b.type===e.type)&&b.name===e.name?this.removeEventListener(b.type,b.listener,b.options):t[++c]=b;++c?t.length=c:delete this.__on}}}function o8(e,t,n){return function(){var c=this.__on,g,b=r8(t);if(c){for(var E=0,a=c.length;E<a;++E)if((g=c[E]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=b,g.options=n),g.value=t;return}}this.addEventListener(e.type,b,n),g={type:e.type,name:e.name,value:t,listener:b,options:n},c?c.push(g):this.__on=[g]}}function l8(e,t,n){var c=s8(e+""),g,b=c.length,E;if(arguments.length<2){var a=this.node().__on;if(a){for(var U=0,W=a.length,ce;U<W;++U)for(g=0,ce=a[U];g<b;++g)if((E=c[g]).type===ce.type&&E.name===ce.name)return ce.value}return}for(a=t?o8:a8,g=0;g<b;++g)this.each(a(c[g],t,n));return this}function x3(e,t,n){var c=m3(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function u8(e,t){return function(){return x3(this,e,t)}}function c8(e,t){return function(){return x3(this,e,t.apply(this,arguments))}}function h8(e,t){return this.each((typeof t=="function"?c8:u8)(e,t))}function*A8(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length,E;g<b;++g)(E=c[g])&&(yield E)}var b3=[null];function ph(e,t){this._groups=e,this._parents=t}function Cg(){return new ph([[document.documentElement]],b3)}function f8(){return this}ph.prototype=Cg.prototype={constructor:ph,select:NT,selectAll:qT,selectChild:QT,selectChildren:$T,filter:KT,data:r6,enter:JT,exit:a6,join:o6,merge:l6,selection:f8,order:u6,sort:c6,call:A6,nodes:f6,node:d6,size:p6,empty:m6,each:g6,attr:S6,style:T6,property:D6,classed:R6,text:V6,html:H6,raise:Z6,lower:W6,append:X6,insert:$6,remove:J6,clone:i8,datum:n8,on:l8,dispatch:h8,[Symbol.iterator]:A8};function e_(e){return typeof e=="string"?new ph([[document.querySelector(e)]],[document.documentElement]):new ph([[e]],b3)}function Bv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function w3(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function Tg(){}var Ag=.7,y_=1/Ag,lm="\\s*([+-]?\\d+)\\s*",fg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",YA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",d8=/^#([0-9a-f]{3,8})$/,p8=new RegExp(`^rgb\\(${lm},${lm},${lm}\\)$`),m8=new RegExp(`^rgb\\(${YA},${YA},${YA}\\)$`),g8=new RegExp(`^rgba\\(${lm},${lm},${lm},${fg}\\)$`),_8=new RegExp(`^rgba\\(${YA},${YA},${YA},${fg}\\)$`),y8=new RegExp(`^hsl\\(${fg},${YA},${YA}\\)$`),v8=new RegExp(`^hsla\\(${fg},${YA},${YA},${fg}\\)$`),Cx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bv(Tg,tp,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Tx,formatHex:Tx,formatHex8:x8,formatHsl:b8,formatRgb:kx,toString:kx});function Tx(){return this.rgb().formatHex()}function x8(){return this.rgb().formatHex8()}function b8(){return S3(this).formatHsl()}function kx(){return this.rgb().formatRgb()}function tp(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=d8.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Mx(t):n===3?new Vc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ug(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ug(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=p8.exec(e))?new Vc(t[1],t[2],t[3],1):(t=m8.exec(e))?new Vc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=g8.exec(e))?Ug(t[1],t[2],t[3],t[4]):(t=_8.exec(e))?Ug(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=y8.exec(e))?Lx(t[1],t[2]/100,t[3]/100,1):(t=v8.exec(e))?Lx(t[1],t[2]/100,t[3]/100,t[4]):Cx.hasOwnProperty(e)?Mx(Cx[e]):e==="transparent"?new Vc(NaN,NaN,NaN,0):null}function Mx(e){return new Vc(e>>16&255,e>>8&255,e&255,1)}function Ug(e,t,n,c){return c<=0&&(e=t=n=NaN),new Vc(e,t,n,c)}function w8(e){return e instanceof Tg||(e=tp(e)),e?(e=e.rgb(),new Vc(e.r,e.g,e.b,e.opacity)):new Vc}function Fy(e,t,n,c){return arguments.length===1?w8(e):new Vc(e,t,n,c??1)}function Vc(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}Bv(Vc,Fy,w3(Tg,{brighter(e){return e=e==null?y_:Math.pow(y_,e),new Vc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ag:Math.pow(Ag,e),new Vc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Vc(Yd(this.r),Yd(this.g),Yd(this.b),v_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Px,formatHex:Px,formatHex8:S8,formatRgb:Dx,toString:Dx}));function Px(){return`#${Qd(this.r)}${Qd(this.g)}${Qd(this.b)}`}function S8(){return`#${Qd(this.r)}${Qd(this.g)}${Qd(this.b)}${Qd((isNaN(this.opacity)?1:this.opacity)*255)}`}function Dx(){const e=v_(this.opacity);return`${e===1?"rgb(":"rgba("}${Yd(this.r)}, ${Yd(this.g)}, ${Yd(this.b)}${e===1?")":`, ${e})`}`}function v_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Yd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qd(e){return e=Yd(e),(e<16?"0":"")+e.toString(16)}function Lx(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new uA(e,t,n,c)}function S3(e){if(e instanceof uA)return new uA(e.h,e.s,e.l,e.opacity);if(e instanceof Tg||(e=tp(e)),!e)return new uA;if(e instanceof uA)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),b=Math.max(t,n,c),E=NaN,a=b-g,U=(b+g)/2;return a?(t===b?E=(n-c)/a+(n<c)*6:n===b?E=(c-t)/a+2:E=(t-n)/a+4,a/=U<.5?b+g:2-b-g,E*=60):a=U>0&&U<1?0:E,new uA(E,a,U,e.opacity)}function I8(e,t,n,c){return arguments.length===1?S3(e):new uA(e,t,n,c??1)}function uA(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}Bv(uA,I8,w3(Tg,{brighter(e){return e=e==null?y_:Math.pow(y_,e),new uA(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ag:Math.pow(Ag,e),new uA(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new Vc(z1(e>=240?e-240:e+120,g,c),z1(e,g,c),z1(e<120?e+240:e-120,g,c),this.opacity)},clamp(){return new uA(Bx(this.h),Gg(this.s),Gg(this.l),v_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=v_(this.opacity);return`${e===1?"hsl(":"hsla("}${Bx(this.h)}, ${Gg(this.s)*100}%, ${Gg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Bx(e){return e=(e||0)%360,e<0?e+360:e}function Gg(e){return Math.max(0,Math.min(1,e||0))}function z1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const zv=e=>()=>e;function E8(e,t){return function(n){return e+n*t}}function C8(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function T8(e){return(e=+e)==1?I3:function(t,n){return n-t?C8(t,n,e):zv(isNaN(t)?n:t)}}function I3(e,t){var n=t-e;return n?E8(e,n):zv(isNaN(e)?t:e)}const x_=function e(t){var n=T8(t);function c(g,b){var E=n((g=Fy(g)).r,(b=Fy(b)).r),a=n(g.g,b.g),U=n(g.b,b.b),W=I3(g.opacity,b.opacity);return function(ce){return g.r=E(ce),g.g=a(ce),g.b=U(ce),g.opacity=W(ce),g+""}}return c.gamma=e,c}(1);function k8(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(b){for(g=0;g<n;++g)c[g]=e[g]*(1-b)+t[g]*b;return c}}function M8(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function P8(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),b=new Array(n),E;for(E=0;E<c;++E)g[E]=Rv(e[E],t[E]);for(;E<n;++E)b[E]=t[E];return function(a){for(E=0;E<c;++E)b[E]=g[E](a);return b}}function D8(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function oA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function L8(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=Rv(e[g],t[g]):c[g]=t[g];return function(b){for(g in n)c[g]=n[g](b);return c}}var Oy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,R1=new RegExp(Oy.source,"g");function B8(e){return function(){return e}}function z8(e){return function(t){return e(t)+""}}function E3(e,t){var n=Oy.lastIndex=R1.lastIndex=0,c,g,b,E=-1,a=[],U=[];for(e=e+"",t=t+"";(c=Oy.exec(e))&&(g=R1.exec(t));)(b=g.index)>n&&(b=t.slice(n,b),a[E]?a[E]+=b:a[++E]=b),(c=c[0])===(g=g[0])?a[E]?a[E]+=g:a[++E]=g:(a[++E]=null,U.push({i:E,x:oA(c,g)})),n=R1.lastIndex;return n<t.length&&(b=t.slice(n),a[E]?a[E]+=b:a[++E]=b),a.length<2?U[0]?z8(U[0].x):B8(t):(t=U.length,function(W){for(var ce=0,oe;ce<t;++ce)a[(oe=U[ce]).i]=oe.x(W);return a.join("")})}function Rv(e,t){var n=typeof t,c;return t==null||n==="boolean"?zv(t):(n==="number"?oA:n==="string"?(c=tp(t))?(t=c,x_):E3:t instanceof tp?x_:t instanceof Date?D8:M8(t)?k8:Array.isArray(t)?P8:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?L8:oA)(e,t)}function R8(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var zx=180/Math.PI,Ny={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function C3(e,t,n,c,g,b){var E,a,U;return(E=Math.sqrt(e*e+t*t))&&(e/=E,t/=E),(U=e*n+t*c)&&(n-=e*U,c-=t*U),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,U/=a),e*c<t*n&&(e=-e,t=-t,U=-U,E=-E),{translateX:g,translateY:b,rotate:Math.atan2(t,e)*zx,skewX:Math.atan(U)*zx,scaleX:E,scaleY:a}}var qg;function F8(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ny:C3(t.a,t.b,t.c,t.d,t.e,t.f)}function O8(e){return e==null||(qg||(qg=document.createElementNS("http://www.w3.org/2000/svg","g")),qg.setAttribute("transform",e),!(e=qg.transform.baseVal.consolidate()))?Ny:(e=e.matrix,C3(e.a,e.b,e.c,e.d,e.e,e.f))}function T3(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function b(W,ce,oe,fe,we,et){if(W!==oe||ce!==fe){var lt=we.push("translate(",null,t,null,n);et.push({i:lt-4,x:oA(W,oe)},{i:lt-2,x:oA(ce,fe)})}else(oe||fe)&&we.push("translate("+oe+t+fe+n)}function E(W,ce,oe,fe){W!==ce?(W-ce>180?ce+=360:ce-W>180&&(W+=360),fe.push({i:oe.push(g(oe)+"rotate(",null,c)-2,x:oA(W,ce)})):ce&&oe.push(g(oe)+"rotate("+ce+c)}function a(W,ce,oe,fe){W!==ce?fe.push({i:oe.push(g(oe)+"skewX(",null,c)-2,x:oA(W,ce)}):ce&&oe.push(g(oe)+"skewX("+ce+c)}function U(W,ce,oe,fe,we,et){if(W!==oe||ce!==fe){var lt=we.push(g(we)+"scale(",null,",",null,")");et.push({i:lt-4,x:oA(W,oe)},{i:lt-2,x:oA(ce,fe)})}else(oe!==1||fe!==1)&&we.push(g(we)+"scale("+oe+","+fe+")")}return function(W,ce){var oe=[],fe=[];return W=e(W),ce=e(ce),b(W.translateX,W.translateY,ce.translateX,ce.translateY,oe,fe),E(W.rotate,ce.rotate,oe,fe),a(W.skewX,ce.skewX,oe,fe),U(W.scaleX,W.scaleY,ce.scaleX,ce.scaleY,oe,fe),W=ce=null,function(we){for(var et=-1,lt=fe.length,Ke;++et<lt;)oe[(Ke=fe[et]).i]=Ke.x(we);return oe.join("")}}}var N8=T3(F8,"px, ","px)","deg)"),V8=T3(O8,", ",")",")"),dm=0,ng=0,jm=0,k3=1e3,b_,rg,w_=0,ip=0,Y_=0,dg=typeof performance=="object"&&performance.now?performance:Date,M3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Fv(){return ip||(M3(U8),ip=dg.now()+Y_)}function U8(){ip=0}function S_(){this._call=this._time=this._next=null}S_.prototype=P3.prototype={constructor:S_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Fv():+n)+(t==null?0:+t),!this._next&&rg!==this&&(rg?rg._next=this:b_=this,rg=this),this._call=e,this._time=n,Vy()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vy())}};function P3(e,t,n){var c=new S_;return c.restart(e,t,n),c}function G8(){Fv(),++dm;for(var e=b_,t;e;)(t=ip-e._time)>=0&&e._call.call(void 0,t),e=e._next;--dm}function Rx(){ip=(w_=dg.now())+Y_,dm=ng=0;try{G8()}finally{dm=0,H8(),ip=0}}function q8(){var e=dg.now(),t=e-w_;t>k3&&(Y_-=t,w_=e)}function H8(){for(var e,t=b_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:b_=n);rg=e,Vy(c)}function Vy(e){if(!dm){ng&&(ng=clearTimeout(ng));var t=e-ip;t>24?(e<1/0&&(ng=setTimeout(Rx,e-dg.now()-Y_)),jm&&(jm=clearInterval(jm))):(jm||(w_=dg.now(),jm=setInterval(q8,k3)),dm=1,M3(Rx))}}function Fx(e,t,n){var c=new S_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var j8=c3("start","end","cancel","interrupt"),Z8=[],D3=0,Ox=1,Uy=2,t_=3,Nx=4,Gy=5,i_=6;function $_(e,t,n,c,g,b){var E=e.__transition;if(!E)e.__transition={};else if(n in E)return;Q8(e,n,{name:t,index:c,group:g,on:j8,tween:Z8,time:b.time,delay:b.delay,duration:b.duration,ease:b.ease,timer:null,state:D3})}function Ov(e,t){var n=cA(e,t);if(n.state>D3)throw new Error("too late; already scheduled");return n}function nf(e,t){var n=cA(e,t);if(n.state>t_)throw new Error("too late; already running");return n}function cA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Q8(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=P3(b,0,n.time);function b(W){n.state=Ox,n.timer.restart(E,n.delay,n.time),n.delay<=W&&E(W-n.delay)}function E(W){var ce,oe,fe,we;if(n.state!==Ox)return U();for(ce in c)if(we=c[ce],we.name===n.name){if(we.state===t_)return Fx(E);we.state===Nx?(we.state=i_,we.timer.stop(),we.on.call("interrupt",e,e.__data__,we.index,we.group),delete c[ce]):+ce<t&&(we.state=i_,we.timer.stop(),we.on.call("cancel",e,e.__data__,we.index,we.group),delete c[ce])}if(Fx(function(){n.state===t_&&(n.state=Nx,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=Uy,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Uy){for(n.state=t_,g=new Array(fe=n.tween.length),ce=0,oe=-1;ce<fe;++ce)(we=n.tween[ce].value.call(e,e.__data__,n.index,n.group))&&(g[++oe]=we);g.length=oe+1}}function a(W){for(var ce=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(U),n.state=Gy,1),oe=-1,fe=g.length;++oe<fe;)g[oe].call(e,ce);n.state===Gy&&(n.on.call("end",e,e.__data__,n.index,n.group),U())}function U(){n.state=i_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function W8(e,t){var n=e.__transition,c,g,b=!0,E;if(n){t=t==null?null:t+"";for(E in n){if((c=n[E]).name!==t){b=!1;continue}g=c.state>Uy&&c.state<Gy,c.state=i_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[E]}b&&delete e.__transition}}function X8(e){return this.each(function(){W8(this,e)})}function Y8(e,t){var n,c;return function(){var g=nf(this,e),b=g.tween;if(b!==n){c=n=b;for(var E=0,a=c.length;E<a;++E)if(c[E].name===t){c=c.slice(),c.splice(E,1);break}}g.tween=c}}function $8(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var b=nf(this,e),E=b.tween;if(E!==c){g=(c=E).slice();for(var a={name:t,value:n},U=0,W=g.length;U<W;++U)if(g[U].name===t){g[U]=a;break}U===W&&g.push(a)}b.tween=g}}function K8(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=cA(this.node(),n).tween,g=0,b=c.length,E;g<b;++g)if((E=c[g]).name===e)return E.value;return null}return this.each((t==null?Y8:$8)(n,e,t))}function Nv(e,t,n){var c=e._id;return e.each(function(){var g=nf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return cA(g,c).value[t]}}function L3(e,t){var n;return(typeof t=="number"?oA:t instanceof tp?x_:(n=tp(t))?(t=n,x_):E3)(e,t)}function J8(e){return function(){this.removeAttribute(e)}}function ek(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tk(e,t,n){var c,g=n+"",b;return function(){var E=this.getAttribute(e);return E===g?null:E===c?b:b=t(c=E,n)}}function ik(e,t,n){var c,g=n+"",b;return function(){var E=this.getAttributeNS(e.space,e.local);return E===g?null:E===c?b:b=t(c=E,n)}}function nk(e,t,n){var c,g,b;return function(){var E,a=n(this),U;return a==null?void this.removeAttribute(e):(E=this.getAttribute(e),U=a+"",E===U?null:E===c&&U===g?b:(g=U,b=t(c=E,a)))}}function rk(e,t,n){var c,g,b;return function(){var E,a=n(this),U;return a==null?void this.removeAttributeNS(e.space,e.local):(E=this.getAttributeNS(e.space,e.local),U=a+"",E===U?null:E===c&&U===g?b:(g=U,b=t(c=E,a)))}}function sk(e,t){var n=X_(e),c=n==="transform"?V8:L3;return this.attrTween(e,typeof t=="function"?(n.local?rk:nk)(n,c,Nv(this,"attr."+e,t)):t==null?(n.local?ek:J8)(n):(n.local?ik:tk)(n,c,t))}function ak(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ok(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function lk(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&ok(e,b)),n}return g._value=t,g}function uk(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&ak(e,b)),n}return g._value=t,g}function ck(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=X_(e);return this.tween(n,(c.local?lk:uk)(c,t))}function hk(e,t){return function(){Ov(this,e).delay=+t.apply(this,arguments)}}function Ak(e,t){return t=+t,function(){Ov(this,e).delay=t}}function fk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hk:Ak)(t,e)):cA(this.node(),t).delay}function dk(e,t){return function(){nf(this,e).duration=+t.apply(this,arguments)}}function pk(e,t){return t=+t,function(){nf(this,e).duration=t}}function mk(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dk:pk)(t,e)):cA(this.node(),t).duration}function gk(e,t){if(typeof t!="function")throw new Error;return function(){nf(this,e).ease=t}}function _k(e){var t=this._id;return arguments.length?this.each(gk(t,e)):cA(this.node(),t).ease}function yk(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;nf(this,e).ease=n}}function vk(e){if(typeof e!="function")throw new Error;return this.each(yk(this._id,e))}function xk(e){typeof e!="function"&&(e=f3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],E=b.length,a=c[g]=[],U,W=0;W<E;++W)(U=b[W])&&e.call(U,U.__data__,W,b)&&a.push(U);return new t0(c,this._parents,this._name,this._id)}function bk(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,b=Math.min(c,g),E=new Array(c),a=0;a<b;++a)for(var U=t[a],W=n[a],ce=U.length,oe=E[a]=new Array(ce),fe,we=0;we<ce;++we)(fe=U[we]||W[we])&&(oe[we]=fe);for(;a<c;++a)E[a]=t[a];return new t0(E,this._parents,this._name,this._id)}function wk(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Sk(e,t,n){var c,g,b=wk(t)?Ov:nf;return function(){var E=b(this,e),a=E.on;a!==c&&(g=(c=a).copy()).on(t,n),E.on=g}}function Ik(e,t){var n=this._id;return arguments.length<2?cA(this.node(),n).on.on(e):this.each(Sk(n,e,t))}function Ek(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Ck(){return this.on("end.remove",Ek(this._id))}function Tk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Dv(e));for(var c=this._groups,g=c.length,b=new Array(g),E=0;E<g;++E)for(var a=c[E],U=a.length,W=b[E]=new Array(U),ce,oe,fe=0;fe<U;++fe)(ce=a[fe])&&(oe=e.call(ce,ce.__data__,fe,a))&&("__data__"in ce&&(oe.__data__=ce.__data__),W[fe]=oe,$_(W[fe],t,n,fe,W,cA(ce,n)));return new t0(b,this._parents,t,n)}function kk(e){var t=this._name,n=this._id;typeof e!="function"&&(e=A3(e));for(var c=this._groups,g=c.length,b=[],E=[],a=0;a<g;++a)for(var U=c[a],W=U.length,ce,oe=0;oe<W;++oe)if(ce=U[oe]){for(var fe=e.call(ce,ce.__data__,oe,U),we,et=cA(ce,n),lt=0,Ke=fe.length;lt<Ke;++lt)(we=fe[lt])&&$_(we,t,n,lt,fe,et);b.push(fe),E.push(ce)}return new t0(b,E,t,n)}var Mk=Cg.prototype.constructor;function Pk(){return new Mk(this._groups,this._parents)}function Dk(e,t){var n,c,g;return function(){var b=fm(this,e),E=(this.style.removeProperty(e),fm(this,e));return b===E?null:b===n&&E===c?g:g=t(n=b,c=E)}}function B3(e){return function(){this.style.removeProperty(e)}}function Lk(e,t,n){var c,g=n+"",b;return function(){var E=fm(this,e);return E===g?null:E===c?b:b=t(c=E,n)}}function Bk(e,t,n){var c,g,b;return function(){var E=fm(this,e),a=n(this),U=a+"";return a==null&&(U=a=(this.style.removeProperty(e),fm(this,e))),E===U?null:E===c&&U===g?b:(g=U,b=t(c=E,a))}}function zk(e,t){var n,c,g,b="style."+t,E="end."+b,a;return function(){var U=nf(this,e),W=U.on,ce=U.value[b]==null?a||(a=B3(t)):void 0;(W!==n||g!==ce)&&(c=(n=W).copy()).on(E,g=ce),U.on=c}}function Rk(e,t,n){var c=(e+="")=="transform"?N8:L3;return t==null?this.styleTween(e,Dk(e,c)).on("end.style."+e,B3(e)):typeof t=="function"?this.styleTween(e,Bk(e,c,Nv(this,"style."+e,t))).each(zk(this._id,e)):this.styleTween(e,Lk(e,c,t),n).on("end.style."+e,null)}function Fk(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function Ok(e,t,n){var c,g;function b(){var E=t.apply(this,arguments);return E!==g&&(c=(g=E)&&Fk(e,E,n)),c}return b._value=t,b}function Nk(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,Ok(e,t,n??""))}function Vk(e){return function(){this.textContent=e}}function Uk(e){return function(){var t=e(this);this.textContent=t??""}}function Gk(e){return this.tween("text",typeof e=="function"?Uk(Nv(this,"text",e)):Vk(e==null?"":e+""))}function qk(e){return function(t){this.textContent=e.call(this,t)}}function Hk(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&qk(g)),t}return c._value=e,c}function jk(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Hk(e))}function Zk(){for(var e=this._name,t=this._id,n=z3(),c=this._groups,g=c.length,b=0;b<g;++b)for(var E=c[b],a=E.length,U,W=0;W<a;++W)if(U=E[W]){var ce=cA(U,t);$_(U,e,n,W,E,{time:ce.time+ce.delay+ce.duration,delay:0,duration:ce.duration,ease:ce.ease})}return new t0(c,this._parents,e,n)}function Qk(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(b,E){var a={value:E},U={value:function(){--g===0&&b()}};n.each(function(){var W=nf(this,c),ce=W.on;ce!==e&&(t=(e=ce).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(U)),W.on=t}),g===0&&b()})}var Wk=0;function t0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function z3(){return++Wk}var Zf=Cg.prototype;t0.prototype={constructor:t0,select:Tk,selectAll:kk,selectChild:Zf.selectChild,selectChildren:Zf.selectChildren,filter:xk,merge:bk,selection:Pk,transition:Zk,call:Zf.call,nodes:Zf.nodes,node:Zf.node,size:Zf.size,empty:Zf.empty,each:Zf.each,on:Ik,attr:sk,attrTween:ck,style:Rk,styleTween:Nk,text:Gk,textTween:jk,remove:Ck,tween:K8,delay:fk,duration:mk,ease:_k,easeVarying:vk,end:Qk,[Symbol.iterator]:Zf[Symbol.iterator]};function Xk(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Yk={time:null,delay:0,duration:250,ease:Xk};function $k(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Kk(e){var t,n;e instanceof t0?(t=e._id,e=e._name):(t=z3(),(n=Yk).time=Fv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,b=0;b<g;++b)for(var E=c[b],a=E.length,U,W=0;W<a;++W)(U=E[W])&&$_(U,e,t,W,E,n||$k(U,t));return new t0(c,this._parents,e,t)}Cg.prototype.interrupt=X8;Cg.prototype.transition=Kk;const qy=Math.PI,Hy=2*qy,jd=1e-6,Jk=Hy-jd;function R3(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function eM(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return R3;const n=10**t;return function(c){this._+=c[0];for(let g=1,b=c.length;g<b;++g)this._+=Math.round(arguments[g]*n)/n+c[g]}}let tM=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?R3:eM(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,c,g){this._append`Q${+t},${+n},${this._x1=+c},${this._y1=+g}`}bezierCurveTo(t,n,c,g,b,E){this._append`C${+t},${+n},${+c},${+g},${this._x1=+b},${this._y1=+E}`}arcTo(t,n,c,g,b){if(t=+t,n=+n,c=+c,g=+g,b=+b,b<0)throw new Error(`negative radius: ${b}`);let E=this._x1,a=this._y1,U=c-t,W=g-n,ce=E-t,oe=a-n,fe=ce*ce+oe*oe;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(fe>jd)if(!(Math.abs(oe*U-W*ce)>jd)||!b)this._append`L${this._x1=t},${this._y1=n}`;else{let we=c-E,et=g-a,lt=U*U+W*W,Ke=we*we+et*et,st=Math.sqrt(lt),ut=Math.sqrt(fe),kt=b*Math.tan((qy-Math.acos((lt+fe-Ke)/(2*st*ut)))/2),Bt=kt/ut,Rt=kt/st;Math.abs(Bt-1)>jd&&this._append`L${t+Bt*ce},${n+Bt*oe}`,this._append`A${b},${b},0,0,${+(oe*we>ce*et)},${this._x1=t+Rt*U},${this._y1=n+Rt*W}`}}arc(t,n,c,g,b,E){if(t=+t,n=+n,c=+c,E=!!E,c<0)throw new Error(`negative radius: ${c}`);let a=c*Math.cos(g),U=c*Math.sin(g),W=t+a,ce=n+U,oe=1^E,fe=E?g-b:b-g;this._x1===null?this._append`M${W},${ce}`:(Math.abs(this._x1-W)>jd||Math.abs(this._y1-ce)>jd)&&this._append`L${W},${ce}`,c&&(fe<0&&(fe=fe%Hy+Hy),fe>Jk?this._append`A${c},${c},0,1,${oe},${t-a},${n-U}A${c},${c},0,1,${oe},${this._x1=W},${this._y1=ce}`:fe>jd&&this._append`A${c},${c},0,${+(fe>=qy)},${oe},${this._x1=t+c*Math.cos(b)},${this._y1=n+c*Math.sin(b)}`)}rect(t,n,c,g){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${c=+c}v${+g}h${-c}Z`}toString(){return this._}};function iM(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function I_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function pm(e){return e=I_(Math.abs(e)),e?e[1]:NaN}function nM(e,t){return function(n,c){for(var g=n.length,b=[],E=0,a=e[0],U=0;g>0&&a>0&&(U+a+1>c&&(a=Math.max(1,c-U)),b.push(n.substring(g-=a,g+a)),!((U+=a+1)>c));)a=e[E=(E+1)%e.length];return b.reverse().join(t)}}function rM(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var sM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function E_(e){if(!(t=sM.exec(e)))throw new Error("invalid format: "+e);var t;return new Vv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}E_.prototype=Vv.prototype;function Vv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Vv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function aM(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var F3;function oM(e,t){var n=I_(e,t);if(!n)return e+"";var c=n[0],g=n[1],b=g-(F3=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,E=c.length;return b===E?c:b>E?c+new Array(b-E+1).join("0"):b>0?c.slice(0,b)+"."+c.slice(b):"0."+new Array(1-b).join("0")+I_(e,Math.max(0,t+b-1))[0]}function Vx(e,t){var n=I_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const Ux={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:iM,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Vx(e*100,t),r:Vx,s:oM,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Gx(e){return e}var qx=Array.prototype.map,Hx=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function lM(e){var t=e.grouping===void 0||e.thousands===void 0?Gx:nM(qx.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",b=e.numerals===void 0?Gx:rM(qx.call(e.numerals,String)),E=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",U=e.nan===void 0?"NaN":e.nan+"";function W(oe){oe=E_(oe);var fe=oe.fill,we=oe.align,et=oe.sign,lt=oe.symbol,Ke=oe.zero,st=oe.width,ut=oe.comma,kt=oe.precision,Bt=oe.trim,Rt=oe.type;Rt==="n"?(ut=!0,Rt="g"):Ux[Rt]||(kt===void 0&&(kt=12),Bt=!0,Rt="g"),(Ke||fe==="0"&&we==="=")&&(Ke=!0,fe="0",we="=");var Ge=lt==="$"?n:lt==="#"&&/[boxX]/.test(Rt)?"0"+Rt.toLowerCase():"",ni=lt==="$"?c:/[%p]/.test(Rt)?E:"",it=Ux[Rt],xt=/[defgprs%]/.test(Rt);kt=kt===void 0?6:/[gprs]/.test(Rt)?Math.max(1,Math.min(21,kt)):Math.max(0,Math.min(20,kt));function _t(mt){var bt=Ge,dt=ni,nt,pt,at;if(Rt==="c")dt=it(mt)+dt,mt="";else{mt=+mt;var Nt=mt<0||1/mt<0;if(mt=isNaN(mt)?U:it(Math.abs(mt),kt),Bt&&(mt=aM(mt)),Nt&&+mt==0&&et!=="+"&&(Nt=!1),bt=(Nt?et==="("?et:a:et==="-"||et==="("?"":et)+bt,dt=(Rt==="s"?Hx[8+F3/3]:"")+dt+(Nt&&et==="("?")":""),xt){for(nt=-1,pt=mt.length;++nt<pt;)if(at=mt.charCodeAt(nt),48>at||at>57){dt=(at===46?g+mt.slice(nt+1):mt.slice(nt))+dt,mt=mt.slice(0,nt);break}}}ut&&!Ke&&(mt=t(mt,1/0));var Ft=bt.length+mt.length+dt.length,Dt=Ft<st?new Array(st-Ft+1).join(fe):"";switch(ut&&Ke&&(mt=t(Dt+mt,Dt.length?st-dt.length:1/0),Dt=""),we){case"<":mt=bt+mt+dt+Dt;break;case"=":mt=bt+Dt+mt+dt;break;case"^":mt=Dt.slice(0,Ft=Dt.length>>1)+bt+mt+dt+Dt.slice(Ft);break;default:mt=Dt+bt+mt+dt;break}return b(mt)}return _t.toString=function(){return oe+""},_t}function ce(oe,fe){var we=W((oe=E_(oe),oe.type="f",oe)),et=Math.max(-8,Math.min(8,Math.floor(pm(fe)/3)))*3,lt=Math.pow(10,-et),Ke=Hx[8+et/3];return function(st){return we(lt*st)+Ke}}return{format:W,formatPrefix:ce}}var Hg,O3,N3;uM({thousands:",",grouping:[3],currency:["$",""]});function uM(e){return Hg=lM(e),O3=Hg.format,N3=Hg.formatPrefix,Hg}function cM(e){return Math.max(0,-pm(Math.abs(e)))}function hM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pm(t)/3)))*3-pm(Math.abs(e)))}function AM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,pm(t)-pm(e))+1}function fM(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function dM(e){return function(){return e}}function pM(e){return+e}var jx=[0,1];function em(e){return e}function jy(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:dM(isNaN(t)?NaN:.5)}function mM(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function gM(e,t,n){var c=e[0],g=e[1],b=t[0],E=t[1];return g<c?(c=jy(g,c),b=n(E,b)):(c=jy(c,g),b=n(b,E)),function(a){return b(c(a))}}function _M(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),b=new Array(c),E=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++E<c;)g[E]=jy(e[E],e[E+1]),b[E]=n(t[E],t[E+1]);return function(a){var U=yT(e,a,1,c)-1;return b[U](g[U](a))}}function yM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function vM(){var e=jx,t=jx,n=Rv,c,g,b,E=em,a,U,W;function ce(){var fe=Math.min(e.length,t.length);return E!==em&&(E=mM(e[0],e[fe-1])),a=fe>2?_M:gM,U=W=null,oe}function oe(fe){return fe==null||isNaN(fe=+fe)?b:(U||(U=a(e.map(c),t,n)))(c(E(fe)))}return oe.invert=function(fe){return E(g((W||(W=a(t,e.map(c),oA)))(fe)))},oe.domain=function(fe){return arguments.length?(e=Array.from(fe,pM),ce()):e.slice()},oe.range=function(fe){return arguments.length?(t=Array.from(fe),ce()):t.slice()},oe.rangeRound=function(fe){return t=Array.from(fe),n=R8,ce()},oe.clamp=function(fe){return arguments.length?(E=fe?!0:em,ce()):E!==em},oe.interpolate=function(fe){return arguments.length?(n=fe,ce()):n},oe.unknown=function(fe){return arguments.length?(b=fe,oe):b},function(fe,we){return c=fe,g=we,ce()}}function xM(){return vM()(em,em)}function bM(e,t,n,c){var g=ST(e,t,n),b;switch(c=E_(c??",f"),c.type){case"s":{var E=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(b=hM(g,E))&&(c.precision=b),N3(c,E)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(b=AM(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=b-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(b=cM(g))&&(c.precision=b-(c.type==="%")*2);break}}return O3(c)}function wM(e){var t=e.domain;return e.ticks=function(n){var c=t();return wT(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return bM(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,b=c.length-1,E=c[g],a=c[b],U,W,ce=10;for(a<E&&(W=E,E=a,a=W,W=g,g=b,b=W);ce-- >0;){if(W=By(E,a,n),W===U)return c[g]=E,c[b]=a,t(c);if(W>0)E=Math.floor(E/W)*W,a=Math.ceil(a/W)*W;else if(W<0)E=Math.ceil(E*W)/W,a=Math.floor(a*W)/W;else break;U=W}return e},e}function Zy(){var e=xM();return e.copy=function(){return yM(e,Zy())},fM.apply(e,arguments),wM(e)}function Du(e){return function(){return e}}function V3(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const c=Math.floor(n);if(!(c>=0))throw new RangeError(`invalid digits: ${n}`);t=c}return e},()=>new tM(t)}function U3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function G3(e){this._context=e}G3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function q3(e){return new G3(e)}function H3(e){return e[0]}function j3(e){return e[1]}function $p(e,t){var n=Du(!0),c=null,g=q3,b=null,E=V3(a);e=typeof e=="function"?e:e===void 0?H3:Du(e),t=typeof t=="function"?t:t===void 0?j3:Du(t);function a(U){var W,ce=(U=U3(U)).length,oe,fe=!1,we;for(c==null&&(b=g(we=E())),W=0;W<=ce;++W)!(W<ce&&n(oe=U[W],W,U))===fe&&((fe=!fe)?b.lineStart():b.lineEnd()),fe&&b.point(+e(oe,W,U),+t(oe,W,U));if(we)return b=null,we+""||null}return a.x=function(U){return arguments.length?(e=typeof U=="function"?U:Du(+U),a):e},a.y=function(U){return arguments.length?(t=typeof U=="function"?U:Du(+U),a):t},a.defined=function(U){return arguments.length?(n=typeof U=="function"?U:Du(!!U),a):n},a.curve=function(U){return arguments.length?(g=U,c!=null&&(b=g(c)),a):g},a.context=function(U){return arguments.length?(U==null?c=b=null:b=g(c=U),a):c},a}function F1(e,t,n){var c=null,g=Du(!0),b=null,E=q3,a=null,U=V3(W);e=typeof e=="function"?e:e===void 0?H3:Du(+e),t=typeof t=="function"?t:Du(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?j3:Du(+n);function W(oe){var fe,we,et,lt=(oe=U3(oe)).length,Ke,st=!1,ut,kt=new Array(lt),Bt=new Array(lt);for(b==null&&(a=E(ut=U())),fe=0;fe<=lt;++fe){if(!(fe<lt&&g(Ke=oe[fe],fe,oe))===st)if(st=!st)we=fe,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),et=fe-1;et>=we;--et)a.point(kt[et],Bt[et]);a.lineEnd(),a.areaEnd()}st&&(kt[fe]=+e(Ke,fe,oe),Bt[fe]=+t(Ke,fe,oe),a.point(c?+c(Ke,fe,oe):kt[fe],n?+n(Ke,fe,oe):Bt[fe]))}if(ut)return a=null,ut+""||null}function ce(){return $p().defined(g).curve(E).context(b)}return W.x=function(oe){return arguments.length?(e=typeof oe=="function"?oe:Du(+oe),c=null,W):e},W.x0=function(oe){return arguments.length?(e=typeof oe=="function"?oe:Du(+oe),W):e},W.x1=function(oe){return arguments.length?(c=oe==null?null:typeof oe=="function"?oe:Du(+oe),W):c},W.y=function(oe){return arguments.length?(t=typeof oe=="function"?oe:Du(+oe),n=null,W):t},W.y0=function(oe){return arguments.length?(t=typeof oe=="function"?oe:Du(+oe),W):t},W.y1=function(oe){return arguments.length?(n=oe==null?null:typeof oe=="function"?oe:Du(+oe),W):n},W.lineX0=W.lineY0=function(){return ce().x(e).y(t)},W.lineY1=function(){return ce().x(e).y(n)},W.lineX1=function(){return ce().x(c).y(t)},W.defined=function(oe){return arguments.length?(g=typeof oe=="function"?oe:Du(!!oe),W):g},W.curve=function(oe){return arguments.length?(E=oe,b!=null&&(a=E(b)),W):E},W.context=function(oe){return arguments.length?(oe==null?b=a=null:a=E(b=oe),W):b},W}function Zx(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Z3(e){this._context=e}Z3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Zx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Zx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function SM(e){return new Z3(e)}function sg(e,t,n){this.k=e,this.x=t,this.y=n}sg.prototype={constructor:sg,scale:function(e){return e===1?this:new sg(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new sg(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};sg.prototype;function Qx(e,t,n){const c=e.slice();return c[34]=t[n],c[36]=n,c}function Wx(e){let t,n,c=m_[e[5]]+"",g,b,E,a,U,W,ce,oe,fe,we,et,lt,Ke,st,ut,kt,Bt,Rt,Ge,ni,it,xt,_t,mt=_c(e[0]),bt=[];for(let dt=0;dt<mt.length;dt+=1)bt[dt]=Xx(Qx(e,mt,dt));return{c(){t=qn("div"),n=qn("h2"),g=Po(c),b=Po(" by tree size"),E=Or(),a=Ba("svg"),U=Ba("defs"),W=Ba("linearGradient"),ce=Ba("stop"),oe=Ba("stop"),fe=Ba("stop"),we=Ba("g"),lt=Ba("g"),st=Ba("path"),kt=Ba("g");for(let dt=0;dt<bt.length;dt+=1)bt[dt].c();Bt=Ba("text"),Rt=Po(e[11]),it=Ba("text"),xt=Po(e[12]),this.h()},l(dt){t=Hn(dt,"DIV",{class:!0});var nt=Tn(t);n=Hn(nt,"H2",{class:!0});var pt=Tn(n);g=Do(pt,c),b=Do(pt," by tree size"),pt.forEach(Ci),E=Nr(nt),a=za(nt,"svg",{id:!0,viewBox:!0,class:!0});var at=Tn(a);U=za(at,"defs",{});var Nt=Tn(U);W=za(Nt,"linearGradient",{id:!0,x1:!0,x2:!0,y1:!0,y2:!0});var Ft=Tn(W);ce=za(Ft,"stop",{class:!0,offset:!0}),Tn(ce).forEach(Ci),oe=za(Ft,"stop",{class:!0,offset:!0}),Tn(oe).forEach(Ci),fe=za(Ft,"stop",{class:!0,offset:!0}),Tn(fe).forEach(Ci),Ft.forEach(Ci),Nt.forEach(Ci),we=za(at,"g",{class:!0,transform:!0}),Tn(we).forEach(Ci),lt=za(at,"g",{class:!0,transform:!0}),Tn(lt).forEach(Ci),st=za(at,"path",{class:!0,fill:!0,stroke:!0,"stroke-width":!0,d:!0}),Tn(st).forEach(Ci),kt=za(at,"g",{class:!0,fill:!0,stroke:!0,"stroke-width":!0});var Dt=Tn(kt);for(let ki=0;ki<bt.length;ki+=1)bt[ki].l(Dt);Dt.forEach(Ci),Bt=za(at,"text",{class:!0,"text-anchor":!0,x:!0,y:!0});var ci=Tn(Bt);Rt=Do(ci,e[11]),ci.forEach(Ci),it=za(at,"text",{class:!0,"text-anchor":!0,transform:!0,x:!0,y:!0});var bi=Tn(it);xt=Do(bi,e[12]),bi.forEach(Ci),at.forEach(Ci),nt.forEach(Ci),this.h()},h(){Fi(n,"class","svelte-6xihfi"),Fi(ce,"class","stop1 svelte-6xihfi"),Fi(ce,"offset","0%"),Fi(oe,"class","stop2 svelte-6xihfi"),Fi(oe,"offset","50%"),Fi(fe,"class","stop3 svelte-6xihfi"),Fi(fe,"offset","100%"),Fi(W,"id","Gradient1"),Fi(W,"x1","0"),Fi(W,"x2","0"),Fi(W,"y1","0"),Fi(W,"y2","0.2"),Fi(we,"class","scale x svelte-6xihfi"),Fi(we,"transform",et="translate(0,"+(e[2]-e[3])+")"),Fi(lt,"class","scale y svelte-6xihfi"),Fi(lt,"transform",Ke="translate("+e[4]+",0)"),Fi(st,"class","area ci svelte-6xihfi"),Fi(st,"fill",Am()[300]),Fi(st,"stroke","currentColor"),Fi(st,"stroke-width","0"),Fi(st,"d",ut=e[14](e[10])),Fi(kt,"class","point"),Fi(kt,"fill",Am[700]),Fi(kt,"stroke","currentColor"),Fi(kt,"stroke-width","1.5"),Fi(Bt,"class","axis-label svelte-6xihfi"),Fi(Bt,"text-anchor","center"),Fi(Bt,"x",Ge=e[1]/2),Fi(Bt,"y",ni=e[2]+12),Fi(it,"class","axis-label svelte-6xihfi"),Fi(it,"text-anchor","center"),Fi(it,"transform","rotate(-90)"),Fi(it,"x",e[13]),Fi(it,"y",-10),Fi(a,"id","viz"),Fi(a,"viewBox",_t=`0 0 ${e[1]} ${e[2]}`),Fi(a,"class","svelte-6xihfi"),Fi(t,"class","graph-container svelte-6xihfi")},m(dt,nt){Zn(dt,t,nt),Qi(t,n),Qi(n,g),Qi(n,b),Qi(t,E),Qi(t,a),Qi(a,U),Qi(U,W),Qi(W,ce),Qi(W,oe),Qi(W,fe),Qi(a,we),e[21](we),Qi(a,lt),e[22](lt),Qi(a,st),Qi(a,kt);for(let pt=0;pt<bt.length;pt+=1)bt[pt]&&bt[pt].m(kt,null);Qi(a,Bt),Qi(Bt,Rt),Qi(a,it),Qi(it,xt)},p(dt,nt){if(nt[0]&32&&c!==(c=m_[dt[5]]+"")&&ju(g,c),nt[0]&12&&et!==(et="translate(0,"+(dt[2]-dt[3])+")")&&Fi(we,"transform",et),nt[0]&16&&Ke!==(Ke="translate("+dt[4]+",0)")&&Fi(lt,"transform",Ke),nt[0]&1024&&ut!==(ut=dt[14](dt[10]))&&Fi(st,"d",ut),nt[0]&769){mt=_c(dt[0]);let pt;for(pt=0;pt<mt.length;pt+=1){const at=Qx(dt,mt,pt);bt[pt]?bt[pt].p(at,nt):(bt[pt]=Xx(at),bt[pt].c(),bt[pt].m(kt,null))}for(;pt<bt.length;pt+=1)bt[pt].d(1);bt.length=mt.length}nt[0]&2048&&ju(Rt,dt[11]),nt[0]&2&&Ge!==(Ge=dt[1]/2)&&Fi(Bt,"x",Ge),nt[0]&4&&ni!==(ni=dt[2]+12)&&Fi(Bt,"y",ni),nt[0]&4096&&ju(xt,dt[12]),nt[0]&8192&&Fi(it,"x",dt[13]),nt[0]&6&&_t!==(_t=`0 0 ${dt[1]} ${dt[2]}`)&&Fi(a,"viewBox",_t)},d(dt){dt&&Ci(t),e[21](null),e[22](null),U0(bt,dt)}}}function Xx(e){let t,n,c;return{c(){t=Ba("circle"),this.h()},l(g){t=za(g,"circle",{key:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),Tn(t).forEach(Ci),this.h()},h(){Fi(t,"key",e[36]),Fi(t,"cx",n=e[8](e[34][0])),Fi(t,"cy",c=e[9](e[34][1])),Fi(t,"r","5"),Fi(t,"fill",Am[700]),Fi(t,"class","anim-point svelte-6xihfi")},m(g,b){Zn(g,t,b)},p(g,b){b[0]&257&&n!==(n=g[8](g[34][0]))&&Fi(t,"cx",n),b[0]&513&&c!==(c=g[9](g[34][1]))&&Fi(t,"cy",c)},d(g){g&&Ci(t)}}}function IM(e){let t,n=e[10]&&e[5]&&Wx(e);return{c(){n&&n.c(),t=gs()},l(c){n&&n.l(c),t=gs()},m(c,g){n&&n.m(c,g),Zn(c,t,g)},p(c,g){c[10]&&c[5]?n?n.p(c,g):(n=Wx(c),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:lo,o:lo,d(c){c&&Ci(t),n&&n.d(c)}}}function EM(e,t,n){let{data:c}=t,{point:g}=t,{width:b=640}=t,{height:E=400}=t,{marginTop:a=20}=t,{marginRight:U=20}=t,{marginBottom:W=30}=t,{marginLeft:ce=40}=t,{metric:oe}=t,fe,we,et=null,lt=[0,10],Ke=[0,10],st="",ut="",kt=0,Bt,Rt,{colorScheme:Ge}=t,ni;function it(dt){ni=lT(dt),console.log(ni),n(10,et=ni.confidence),n(19,lt=ni.yAxis),n(20,Ke=ni.xAxis),n(11,st=ni.xAxisLabel),n(12,ut=ni.yAxisLabel),n(13,kt=xt(ut))}function xt(dt){return console.log("label length:",dt.length),-1*(E/2)-dt.length*2.5}const _t=F1().x(dt=>Bt(dt.x)).y0(dt=>Rt(Math.max(dt.low,lt[0]))).y1(dt=>Rt(Math.min(dt.high,lt[1])));$p(dt=>Bt(dt.x),dt=>Rt(dt.y)),$p(dt=>Bt(dt.x),dt=>Rt(dt.low)),$p(dt=>Bt(dt.x),dt=>Rt(dt.high)),F1().x(dt=>Bt(dt.x)).y0(dt=>Rt(dt.high)).y1(dt=>-1*Rt(lt[1])),F1().x(dt=>Bt(dt.x)).y0(dt=>Rt(lt[0])).y1(dt=>Rt(dt.low)),$p(dt=>Bt(dt.x),dt=>Rt(dt.y)).curve(SM);function mt(dt){pa[dt?"unshift":"push"](()=>{fe=dt,n(6,fe)})}function bt(dt){pa[dt?"unshift":"push"](()=>{we=dt,n(7,we)})}return e.$$set=dt=>{"data"in dt&&n(15,c=dt.data),"point"in dt&&n(0,g=dt.point),"width"in dt&&n(1,b=dt.width),"height"in dt&&n(2,E=dt.height),"marginTop"in dt&&n(16,a=dt.marginTop),"marginRight"in dt&&n(17,U=dt.marginRight),"marginBottom"in dt&&n(3,W=dt.marginBottom),"marginLeft"in dt&&n(4,ce=dt.marginLeft),"metric"in dt&&n(5,oe=dt.metric),"colorScheme"in dt&&n(18,Ge=dt.colorScheme)},e.$$.update=()=>{e.$$.dirty[0]&262144&&$C(Ge),e.$$.dirty[0]&32&&(ni=it(oe)),e.$$.dirty[0]&1179666&&n(8,Bt=Zy(wx(Ke),[ce,b-U])),e.$$.dirty[0]&589836&&n(9,Rt=Zy(wx(lt),[E-W,a])),e.$$.dirty[0]&768&&$p((dt,nt)=>Bt(nt),Rt),e.$$.dirty[0]&640&&e_(we).call(DT(Rt)),e.$$.dirty[0]&320&&e_(fe).call(PT(Bt)),e.$$.dirty[0]&6&&e_("svg").append("div").classed("svg-container",!0).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${b} ${E}`).classed("svg-content-responsive",!0),e.$$.dirty[0]&33&&console.log("relative:",uT(oe,g[0][1],g[0][0]))},[g,b,E,W,ce,oe,fe,we,Bt,Rt,et,st,ut,kt,_t,c,a,U,Ge,lt,Ke,mt,bt]}class CM extends Lo{constructor(t){super(),Bo(this,t,EM,IM,co,{data:15,point:0,width:1,height:2,marginTop:16,marginRight:17,marginBottom:3,marginLeft:4,metric:5,colorScheme:18},null,[-1,-1])}}function Q3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function W3(e){let t=e,n=e;e.length===1&&(t=(E,a)=>e(E)-a,n=TM(e));function c(E,a,U,W){for(U==null&&(U=0),W==null&&(W=E.length);U<W;){const ce=U+W>>>1;n(E[ce],a)<0?U=ce+1:W=ce}return U}function g(E,a,U,W){for(U==null&&(U=0),W==null&&(W=E.length);U<W;){const ce=U+W>>>1;n(E[ce],a)>0?W=ce:U=ce+1}return U}function b(E,a,U,W){U==null&&(U=0),W==null&&(W=E.length);const ce=c(E,a,U,W-1);return ce>U&&t(E[ce-1],a)>-t(E[ce],a)?ce-1:ce}return{left:c,center:b,right:g}}function TM(e){return(t,n)=>Q3(e(t),n)}function kM(e){return e===null?NaN:+e}const MM=W3(Q3),PM=MM.right;W3(kM).center;var Qy=Math.sqrt(50),Wy=Math.sqrt(10),Xy=Math.sqrt(2);function DM(e,t,n){var c,g=-1,b,E,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((c=t<e)&&(b=e,e=t,t=b),(a=X3(e,t,n))===0||!isFinite(a))return[];if(a>0){let U=Math.round(e/a),W=Math.round(t/a);for(U*a<e&&++U,W*a>t&&--W,E=new Array(b=W-U+1);++g<b;)E[g]=(U+g)*a}else{a=-a;let U=Math.round(e*a),W=Math.round(t*a);for(U/a<e&&++U,W/a>t&&--W,E=new Array(b=W-U+1);++g<b;)E[g]=(U+g)/a}return c&&E.reverse(),E}function X3(e,t,n){var c=(t-e)/Math.max(0,n),g=Math.floor(Math.log(c)/Math.LN10),b=c/Math.pow(10,g);return g>=0?(b>=Qy?10:b>=Wy?5:b>=Xy?2:1)*Math.pow(10,g):-Math.pow(10,-g)/(b>=Qy?10:b>=Wy?5:b>=Xy?2:1)}function LM(e,t,n){var c=Math.abs(t-e)/Math.max(0,n),g=Math.pow(10,Math.floor(Math.log(c)/Math.LN10)),b=c/g;return b>=Qy?g*=10:b>=Wy?g*=5:b>=Xy&&(g*=2),t<e?-g:g}function BM(e,t){let n;if(t===void 0)for(const c of e)c!=null&&(n<c||n===void 0&&c>=c)&&(n=c);else{let c=-1;for(let g of e)(g=t(g,++c,e))!=null&&(n<g||n===void 0&&g>=g)&&(n=g)}return n}var O1=Array.prototype.slice;function zM(e){return e}var n_=1,N1=2,Yx=3,jg=4,$x=1e-6;function RM(e){return"translate("+e+",0)"}function FM(e){return"translate(0,"+e+")"}function OM(e){return t=>+e(t)}function NM(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function VM(){return!this.__axis}function UM(e,t){var n=[],c=null,g=null,b=6,E=6,a=3,U=typeof window<"u"&&window.devicePixelRatio>1?0:.5,W=e===n_||e===jg?-1:1,ce=e===jg||e===N1?"x":"y",oe=e===n_||e===Yx?RM:FM;function fe(we){var et=c??(t.ticks?t.ticks.apply(t,n):t.domain()),lt=g??(t.tickFormat?t.tickFormat.apply(t,n):zM),Ke=Math.max(b,0)+a,st=t.range(),ut=+st[0]+U,kt=+st[st.length-1]+U,Bt=(t.bandwidth?NM:OM)(t.copy(),U),Rt=we.selection?we.selection():we,Ge=Rt.selectAll(".domain").data([null]),ni=Rt.selectAll(".tick").data(et,t).order(),it=ni.exit(),xt=ni.enter().append("g").attr("class","tick"),_t=ni.select("line"),mt=ni.select("text");Ge=Ge.merge(Ge.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ni=ni.merge(xt),_t=_t.merge(xt.append("line").attr("stroke","currentColor").attr(ce+"2",W*b)),mt=mt.merge(xt.append("text").attr("fill","currentColor").attr(ce,W*Ke).attr("dy",e===n_?"0em":e===Yx?"0.71em":"0.32em")),we!==Rt&&(Ge=Ge.transition(we),ni=ni.transition(we),_t=_t.transition(we),mt=mt.transition(we),it=it.transition(we).attr("opacity",$x).attr("transform",function(bt){return isFinite(bt=Bt(bt))?oe(bt+U):this.getAttribute("transform")}),xt.attr("opacity",$x).attr("transform",function(bt){var dt=this.parentNode.__axis;return oe((dt&&isFinite(dt=dt(bt))?dt:Bt(bt))+U)})),it.remove(),Ge.attr("d",e===jg||e===N1?E?"M"+W*E+","+ut+"H"+U+"V"+kt+"H"+W*E:"M"+U+","+ut+"V"+kt:E?"M"+ut+","+W*E+"V"+U+"H"+kt+"V"+W*E:"M"+ut+","+U+"H"+kt),ni.attr("opacity",1).attr("transform",function(bt){return oe(Bt(bt)+U)}),_t.attr(ce+"2",W*b),mt.attr(ce,W*Ke).text(lt),Rt.filter(VM).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===N1?"start":e===jg?"end":"middle"),Rt.each(function(){this.__axis=Bt})}return fe.scale=function(we){return arguments.length?(t=we,fe):t},fe.ticks=function(){return n=O1.call(arguments),fe},fe.tickArguments=function(we){return arguments.length?(n=we==null?[]:O1.call(we),fe):n.slice()},fe.tickValues=function(we){return arguments.length?(c=we==null?null:O1.call(we),fe):c&&c.slice()},fe.tickFormat=function(we){return arguments.length?(g=we,fe):g},fe.tickSize=function(we){return arguments.length?(b=E=+we,fe):b},fe.tickSizeInner=function(we){return arguments.length?(b=+we,fe):b},fe.tickSizeOuter=function(we){return arguments.length?(E=+we,fe):E},fe.tickPadding=function(we){return arguments.length?(a=+we,fe):a},fe.offset=function(we){return arguments.length?(U=+we,fe):U},fe}function GM(e){return UM(n_,e)}var qM={value:()=>{}};function K_(){for(var e=0,t=arguments.length,n={},c;e<t;++e){if(!(c=arguments[e]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new r_(n)}function r_(e){this._=e}function HM(e,t){return e.trim().split(/^|\s+/).map(function(n){var c="",g=n.indexOf(".");if(g>=0&&(c=n.slice(g+1),n=n.slice(0,g)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:c}})}r_.prototype=K_.prototype={constructor:r_,on:function(e,t){var n=this._,c=HM(e+"",n),g,b=-1,E=c.length;if(arguments.length<2){for(;++b<E;)if((g=(e=c[b]).type)&&(g=jM(n[g],e.name)))return g;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++b<E;)if(g=(e=c[b]).type)n[g]=Kx(n[g],e.name,t);else if(t==null)for(g in n)n[g]=Kx(n[g],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new r_(e)},call:function(e,t){if((g=arguments.length-2)>0)for(var n=new Array(g),c=0,g,b;c<g;++c)n[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(b=this._[e],c=0,g=b.length;c<g;++c)b[c].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],g=0,b=c.length;g<b;++g)c[g].value.apply(t,n)}};function jM(e,t){for(var n=0,c=e.length,g;n<c;++n)if((g=e[n]).name===t)return g.value}function Kx(e,t,n){for(var c=0,g=e.length;c<g;++c)if(e[c].name===t){e[c]=qM,e=e.slice(0,c).concat(e.slice(c+1));break}return n!=null&&e.push({name:t,value:n}),e}var Yy="http://www.w3.org/1999/xhtml";const Jx={svg:"http://www.w3.org/2000/svg",xhtml:Yy,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function J_(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Jx.hasOwnProperty(t)?{space:Jx[t],local:e}:e}function ZM(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Yy&&t.documentElement.namespaceURI===Yy?t.createElement(e):t.createElementNS(n,e)}}function QM(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Uv(e){var t=J_(e);return(t.local?QM:ZM)(t)}function WM(){}function Gv(e){return e==null?WM:function(){return this.querySelector(e)}}function XM(e){typeof e!="function"&&(e=Gv(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],E=b.length,a=c[g]=new Array(E),U,W,ce=0;ce<E;++ce)(U=b[ce])&&(W=e.call(U,U.__data__,ce,b))&&("__data__"in U&&(W.__data__=U.__data__),a[ce]=W);return new Gc(c,this._parents)}function Y3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function YM(){return[]}function $3(e){return e==null?YM:function(){return this.querySelectorAll(e)}}function $M(e){return function(){var t=e.apply(this,arguments);return t==null?[]:Y3(t)}}function KM(e){typeof e=="function"?e=$M(e):e=$3(e);for(var t=this._groups,n=t.length,c=[],g=[],b=0;b<n;++b)for(var E=t[b],a=E.length,U,W=0;W<a;++W)(U=E[W])&&(c.push(e.call(U,U.__data__,W,E)),g.push(U));return new Gc(c,g)}function K3(e){return function(){return this.matches(e)}}function J3(e){return function(t){return t.matches(e)}}var JM=Array.prototype.find;function eP(e){return function(){return JM.call(this.children,e)}}function tP(){return this.firstElementChild}function iP(e){return this.select(e==null?tP:eP(typeof e=="function"?e:J3(e)))}var nP=Array.prototype.filter;function rP(){return this.children}function sP(e){return function(){return nP.call(this.children,e)}}function aP(e){return this.selectAll(e==null?rP:sP(typeof e=="function"?e:J3(e)))}function oP(e){typeof e!="function"&&(e=K3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],E=b.length,a=c[g]=[],U,W=0;W<E;++W)(U=b[W])&&e.call(U,U.__data__,W,b)&&a.push(U);return new Gc(c,this._parents)}function e4(e){return new Array(e.length)}function lP(){return new Gc(this._enter||this._groups.map(e4),this._parents)}function C_(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}C_.prototype={constructor:C_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function uP(e){return function(){return e}}function cP(e,t,n,c,g,b){for(var E=0,a,U=t.length,W=b.length;E<W;++E)(a=t[E])?(a.__data__=b[E],c[E]=a):n[E]=new C_(e,b[E]);for(;E<U;++E)(a=t[E])&&(g[E]=a)}function hP(e,t,n,c,g,b,E){var a,U,W=new Map,ce=t.length,oe=b.length,fe=new Array(ce),we;for(a=0;a<ce;++a)(U=t[a])&&(fe[a]=we=E.call(U,U.__data__,a,t)+"",W.has(we)?g[a]=U:W.set(we,U));for(a=0;a<oe;++a)we=E.call(e,b[a],a,b)+"",(U=W.get(we))?(c[a]=U,U.__data__=b[a],W.delete(we)):n[a]=new C_(e,b[a]);for(a=0;a<ce;++a)(U=t[a])&&W.get(fe[a])===U&&(g[a]=U)}function AP(e){return e.__data__}function fP(e,t){if(!arguments.length)return Array.from(this,AP);var n=t?hP:cP,c=this._parents,g=this._groups;typeof e!="function"&&(e=uP(e));for(var b=g.length,E=new Array(b),a=new Array(b),U=new Array(b),W=0;W<b;++W){var ce=c[W],oe=g[W],fe=oe.length,we=Y3(e.call(ce,ce&&ce.__data__,W,c)),et=we.length,lt=a[W]=new Array(et),Ke=E[W]=new Array(et),st=U[W]=new Array(fe);n(ce,oe,lt,Ke,st,we,t);for(var ut=0,kt=0,Bt,Rt;ut<et;++ut)if(Bt=lt[ut]){for(ut>=kt&&(kt=ut+1);!(Rt=Ke[kt])&&++kt<et;);Bt._next=Rt||null}}return E=new Gc(E,c),E._enter=a,E._exit=U,E}function dP(){return new Gc(this._exit||this._groups.map(e4),this._parents)}function pP(e,t,n){var c=this.enter(),g=this,b=this.exit();return c=typeof e=="function"?e(c):c.append(e+""),t!=null&&(g=t(g)),n==null?b.remove():n(b),c&&g?c.merge(g).order():g}function mP(e){if(!(e instanceof Gc))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,c=t.length,g=n.length,b=Math.min(c,g),E=new Array(c),a=0;a<b;++a)for(var U=t[a],W=n[a],ce=U.length,oe=E[a]=new Array(ce),fe,we=0;we<ce;++we)(fe=U[we]||W[we])&&(oe[we]=fe);for(;a<c;++a)E[a]=t[a];return new Gc(E,this._parents)}function gP(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var c=e[t],g=c.length-1,b=c[g],E;--g>=0;)(E=c[g])&&(b&&E.compareDocumentPosition(b)^4&&b.parentNode.insertBefore(E,b),b=E);return this}function _P(e){e||(e=yP);function t(oe,fe){return oe&&fe?e(oe.__data__,fe.__data__):!oe-!fe}for(var n=this._groups,c=n.length,g=new Array(c),b=0;b<c;++b){for(var E=n[b],a=E.length,U=g[b]=new Array(a),W,ce=0;ce<a;++ce)(W=E[ce])&&(U[ce]=W);U.sort(t)}return new Gc(g,this._parents).order()}function yP(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function vP(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function xP(){return Array.from(this)}function bP(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length;g<b;++g){var E=c[g];if(E)return E}return null}function wP(){let e=0;for(const t of this)++e;return e}function SP(){return!this.node()}function IP(e){for(var t=this._groups,n=0,c=t.length;n<c;++n)for(var g=t[n],b=0,E=g.length,a;b<E;++b)(a=g[b])&&e.call(a,a.__data__,b,g);return this}function EP(e){return function(){this.removeAttribute(e)}}function CP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function TP(e,t){return function(){this.setAttribute(e,t)}}function kP(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function MP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function PP(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function DP(e,t){var n=J_(e);if(arguments.length<2){var c=this.node();return n.local?c.getAttributeNS(n.space,n.local):c.getAttribute(n)}return this.each((t==null?n.local?CP:EP:typeof t=="function"?n.local?PP:MP:n.local?kP:TP)(n,t))}function t4(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function LP(e){return function(){this.style.removeProperty(e)}}function BP(e,t,n){return function(){this.style.setProperty(e,t,n)}}function zP(e,t,n){return function(){var c=t.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,n)}}function RP(e,t,n){return arguments.length>1?this.each((t==null?LP:typeof t=="function"?zP:BP)(e,t,n??"")):mm(this.node(),e)}function mm(e,t){return e.style.getPropertyValue(t)||t4(e).getComputedStyle(e,null).getPropertyValue(t)}function FP(e){return function(){delete this[e]}}function OP(e,t){return function(){this[e]=t}}function NP(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function VP(e,t){return arguments.length>1?this.each((t==null?FP:typeof t=="function"?NP:OP)(e,t)):this.node()[e]}function i4(e){return e.trim().split(/^|\s+/)}function qv(e){return e.classList||new n4(e)}function n4(e){this._node=e,this._names=i4(e.getAttribute("class")||"")}n4.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function r4(e,t){for(var n=qv(e),c=-1,g=t.length;++c<g;)n.add(t[c])}function s4(e,t){for(var n=qv(e),c=-1,g=t.length;++c<g;)n.remove(t[c])}function UP(e){return function(){r4(this,e)}}function GP(e){return function(){s4(this,e)}}function qP(e,t){return function(){(t.apply(this,arguments)?r4:s4)(this,e)}}function HP(e,t){var n=i4(e+"");if(arguments.length<2){for(var c=qv(this.node()),g=-1,b=n.length;++g<b;)if(!c.contains(n[g]))return!1;return!0}return this.each((typeof t=="function"?qP:t?UP:GP)(n,t))}function jP(){this.textContent=""}function ZP(e){return function(){this.textContent=e}}function QP(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function WP(e){return arguments.length?this.each(e==null?jP:(typeof e=="function"?QP:ZP)(e)):this.node().textContent}function XP(){this.innerHTML=""}function YP(e){return function(){this.innerHTML=e}}function $P(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function KP(e){return arguments.length?this.each(e==null?XP:(typeof e=="function"?$P:YP)(e)):this.node().innerHTML}function JP(){this.nextSibling&&this.parentNode.appendChild(this)}function eD(){return this.each(JP)}function tD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function iD(){return this.each(tD)}function nD(e){var t=typeof e=="function"?e:Uv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function rD(){return null}function sD(e,t){var n=typeof e=="function"?e:Uv(e),c=t==null?rD:typeof t=="function"?t:Gv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),c.apply(this,arguments)||null)})}function aD(){var e=this.parentNode;e&&e.removeChild(this)}function oD(){return this.each(aD)}function lD(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function uD(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function cD(e){return this.select(e?uD:lD)}function hD(e){return arguments.length?this.property("__data__",e):this.node().__data__}function AD(e){return function(t){e.call(this,t,this.__data__)}}function fD(e){return e.trim().split(/^|\s+/).map(function(t){var n="",c=t.indexOf(".");return c>=0&&(n=t.slice(c+1),t=t.slice(0,c)),{type:t,name:n}})}function dD(e){return function(){var t=this.__on;if(t){for(var n=0,c=-1,g=t.length,b;n<g;++n)b=t[n],(!e.type||b.type===e.type)&&b.name===e.name?this.removeEventListener(b.type,b.listener,b.options):t[++c]=b;++c?t.length=c:delete this.__on}}}function pD(e,t,n){return function(){var c=this.__on,g,b=AD(t);if(c){for(var E=0,a=c.length;E<a;++E)if((g=c[E]).type===e.type&&g.name===e.name){this.removeEventListener(g.type,g.listener,g.options),this.addEventListener(g.type,g.listener=b,g.options=n),g.value=t;return}}this.addEventListener(e.type,b,n),g={type:e.type,name:e.name,value:t,listener:b,options:n},c?c.push(g):this.__on=[g]}}function mD(e,t,n){var c=fD(e+""),g,b=c.length,E;if(arguments.length<2){var a=this.node().__on;if(a){for(var U=0,W=a.length,ce;U<W;++U)for(g=0,ce=a[U];g<b;++g)if((E=c[g]).type===ce.type&&E.name===ce.name)return ce.value}return}for(a=t?pD:dD,g=0;g<b;++g)this.each(a(c[g],t,n));return this}function a4(e,t,n){var c=t4(e),g=c.CustomEvent;typeof g=="function"?g=new g(t,n):(g=c.document.createEvent("Event"),n?(g.initEvent(t,n.bubbles,n.cancelable),g.detail=n.detail):g.initEvent(t,!1,!1)),e.dispatchEvent(g)}function gD(e,t){return function(){return a4(this,e,t)}}function _D(e,t){return function(){return a4(this,e,t.apply(this,arguments))}}function yD(e,t){return this.each((typeof t=="function"?_D:gD)(e,t))}function*vD(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var c=e[t],g=0,b=c.length,E;g<b;++g)(E=c[g])&&(yield E)}var o4=[null];function Gc(e,t){this._groups=e,this._parents=t}function kg(){return new Gc([[document.documentElement]],o4)}function xD(){return this}Gc.prototype=kg.prototype={constructor:Gc,select:XM,selectAll:KM,selectChild:iP,selectChildren:aP,filter:oP,data:fP,enter:lP,exit:dP,join:pP,merge:mP,selection:xD,order:gP,sort:_P,call:vP,nodes:xP,node:bP,size:wP,empty:SP,each:IP,attr:DP,style:RP,property:VP,classed:HP,text:WP,html:KP,raise:eD,lower:iD,append:nD,insert:sD,remove:oD,clone:cD,datum:hD,on:mD,dispatch:yD,[Symbol.iterator]:vD};function Al(e){return typeof e=="string"?new Gc([[document.querySelector(e)]],[document.documentElement]):new Gc([[e]],o4)}function bD(e){return Al(Uv(e).call(document.documentElement))}function wD(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Yf(e,t){if(e=wD(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var c=n.createSVGPoint();return c.x=e.clientX,c.y=e.clientY,c=c.matrixTransform(t.getScreenCTM().inverse()),[c.x,c.y]}if(t.getBoundingClientRect){var g=t.getBoundingClientRect();return[e.clientX-g.left-t.clientLeft,e.clientY-g.top-t.clientTop]}}return[e.pageX,e.pageY]}function $y(e){e.preventDefault(),e.stopImmediatePropagation()}function l4(e){var t=e.document.documentElement,n=Al(e).on("dragstart.drag",$y,!0);"onselectstart"in t?n.on("selectstart.drag",$y,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function u4(e,t){var n=e.document.documentElement,c=Al(e).on("dragstart.drag",null);t&&(c.on("click.drag",$y,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in n?c.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Hv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function c4(e,t){var n=Object.create(e.prototype);for(var c in t)n[c]=t[c];return n}function Mg(){}var pg=.7,T_=1/pg,um="\\s*([+-]?\\d+)\\s*",mg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",$A="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",SD=/^#([0-9a-f]{3,8})$/,ID=new RegExp("^rgb\\("+[um,um,um]+"\\)$"),ED=new RegExp("^rgb\\("+[$A,$A,$A]+"\\)$"),CD=new RegExp("^rgba\\("+[um,um,um,mg]+"\\)$"),TD=new RegExp("^rgba\\("+[$A,$A,$A,mg]+"\\)$"),kD=new RegExp("^hsl\\("+[mg,$A,$A]+"\\)$"),MD=new RegExp("^hsla\\("+[mg,$A,$A,mg]+"\\)$"),eb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Hv(Mg,np,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:tb,formatHex:tb,formatHsl:PD,formatRgb:ib,toString:ib});function tb(){return this.rgb().formatHex()}function PD(){return h4(this).formatHsl()}function ib(){return this.rgb().formatRgb()}function np(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=SD.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?nb(t):n===3?new fh(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Zg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Zg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ID.exec(e))?new fh(t[1],t[2],t[3],1):(t=ED.exec(e))?new fh(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=CD.exec(e))?Zg(t[1],t[2],t[3],t[4]):(t=TD.exec(e))?Zg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=kD.exec(e))?ab(t[1],t[2]/100,t[3]/100,1):(t=MD.exec(e))?ab(t[1],t[2]/100,t[3]/100,t[4]):eb.hasOwnProperty(e)?nb(eb[e]):e==="transparent"?new fh(NaN,NaN,NaN,0):null}function nb(e){return new fh(e>>16&255,e>>8&255,e&255,1)}function Zg(e,t,n,c){return c<=0&&(e=t=n=NaN),new fh(e,t,n,c)}function DD(e){return e instanceof Mg||(e=np(e)),e?(e=e.rgb(),new fh(e.r,e.g,e.b,e.opacity)):new fh}function Ky(e,t,n,c){return arguments.length===1?DD(e):new fh(e,t,n,c??1)}function fh(e,t,n,c){this.r=+e,this.g=+t,this.b=+n,this.opacity=+c}Hv(fh,Ky,c4(Mg,{brighter:function(e){return e=e==null?T_:Math.pow(T_,e),new fh(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?pg:Math.pow(pg,e),new fh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rb,formatHex:rb,formatRgb:sb,toString:sb}));function rb(){return"#"+V1(this.r)+V1(this.g)+V1(this.b)}function sb(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function V1(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function ab(e,t,n,c){return c<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new WA(e,t,n,c)}function h4(e){if(e instanceof WA)return new WA(e.h,e.s,e.l,e.opacity);if(e instanceof Mg||(e=np(e)),!e)return new WA;if(e instanceof WA)return e;e=e.rgb();var t=e.r/255,n=e.g/255,c=e.b/255,g=Math.min(t,n,c),b=Math.max(t,n,c),E=NaN,a=b-g,U=(b+g)/2;return a?(t===b?E=(n-c)/a+(n<c)*6:n===b?E=(c-t)/a+2:E=(t-n)/a+4,a/=U<.5?b+g:2-b-g,E*=60):a=U>0&&U<1?0:E,new WA(E,a,U,e.opacity)}function LD(e,t,n,c){return arguments.length===1?h4(e):new WA(e,t,n,c??1)}function WA(e,t,n,c){this.h=+e,this.s=+t,this.l=+n,this.opacity=+c}Hv(WA,LD,c4(Mg,{brighter:function(e){return e=e==null?T_:Math.pow(T_,e),new WA(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?pg:Math.pow(pg,e),new WA(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,c=n+(n<.5?n:1-n)*t,g=2*n-c;return new fh(U1(e>=240?e-240:e+120,g,c),U1(e,g,c),U1(e<120?e+240:e-120,g,c),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function U1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const jv=e=>()=>e;function BD(e,t){return function(n){return e+n*t}}function zD(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(c){return Math.pow(e+c*t,n)}}function RD(e){return(e=+e)==1?A4:function(t,n){return n-t?zD(t,n,e):jv(isNaN(t)?n:t)}}function A4(e,t){var n=t-e;return n?BD(e,n):jv(isNaN(e)?t:e)}const k_=function e(t){var n=RD(t);function c(g,b){var E=n((g=Ky(g)).r,(b=Ky(b)).r),a=n(g.g,b.g),U=n(g.b,b.b),W=A4(g.opacity,b.opacity);return function(ce){return g.r=E(ce),g.g=a(ce),g.b=U(ce),g.opacity=W(ce),g+""}}return c.gamma=e,c}(1);function FD(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,c=t.slice(),g;return function(b){for(g=0;g<n;++g)c[g]=e[g]*(1-b)+t[g]*b;return c}}function OD(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ND(e,t){var n=t?t.length:0,c=e?Math.min(n,e.length):0,g=new Array(c),b=new Array(n),E;for(E=0;E<c;++E)g[E]=e1(e[E],t[E]);for(;E<n;++E)b[E]=t[E];return function(a){for(E=0;E<c;++E)b[E]=g[E](a);return b}}function VD(e,t){var n=new Date;return e=+e,t=+t,function(c){return n.setTime(e*(1-c)+t*c),n}}function lA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function UD(e,t){var n={},c={},g;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(g in t)g in e?n[g]=e1(e[g],t[g]):c[g]=t[g];return function(b){for(g in n)c[g]=n[g](b);return c}}var Jy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,G1=new RegExp(Jy.source,"g");function GD(e){return function(){return e}}function qD(e){return function(t){return e(t)+""}}function f4(e,t){var n=Jy.lastIndex=G1.lastIndex=0,c,g,b,E=-1,a=[],U=[];for(e=e+"",t=t+"";(c=Jy.exec(e))&&(g=G1.exec(t));)(b=g.index)>n&&(b=t.slice(n,b),a[E]?a[E]+=b:a[++E]=b),(c=c[0])===(g=g[0])?a[E]?a[E]+=g:a[++E]=g:(a[++E]=null,U.push({i:E,x:lA(c,g)})),n=G1.lastIndex;return n<t.length&&(b=t.slice(n),a[E]?a[E]+=b:a[++E]=b),a.length<2?U[0]?qD(U[0].x):GD(t):(t=U.length,function(W){for(var ce=0,oe;ce<t;++ce)a[(oe=U[ce]).i]=oe.x(W);return a.join("")})}function e1(e,t){var n=typeof t,c;return t==null||n==="boolean"?jv(t):(n==="number"?lA:n==="string"?(c=np(t))?(t=c,k_):f4:t instanceof np?k_:t instanceof Date?VD:OD(t)?FD:Array.isArray(t)?ND:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?UD:lA)(e,t)}function HD(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var ob=180/Math.PI,ev={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function d4(e,t,n,c,g,b){var E,a,U;return(E=Math.sqrt(e*e+t*t))&&(e/=E,t/=E),(U=e*n+t*c)&&(n-=e*U,c-=t*U),(a=Math.sqrt(n*n+c*c))&&(n/=a,c/=a,U/=a),e*c<t*n&&(e=-e,t=-t,U=-U,E=-E),{translateX:g,translateY:b,rotate:Math.atan2(t,e)*ob,skewX:Math.atan(U)*ob,scaleX:E,scaleY:a}}var Qg;function jD(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ev:d4(t.a,t.b,t.c,t.d,t.e,t.f)}function ZD(e){return e==null||(Qg||(Qg=document.createElementNS("http://www.w3.org/2000/svg","g")),Qg.setAttribute("transform",e),!(e=Qg.transform.baseVal.consolidate()))?ev:(e=e.matrix,d4(e.a,e.b,e.c,e.d,e.e,e.f))}function p4(e,t,n,c){function g(W){return W.length?W.pop()+" ":""}function b(W,ce,oe,fe,we,et){if(W!==oe||ce!==fe){var lt=we.push("translate(",null,t,null,n);et.push({i:lt-4,x:lA(W,oe)},{i:lt-2,x:lA(ce,fe)})}else(oe||fe)&&we.push("translate("+oe+t+fe+n)}function E(W,ce,oe,fe){W!==ce?(W-ce>180?ce+=360:ce-W>180&&(W+=360),fe.push({i:oe.push(g(oe)+"rotate(",null,c)-2,x:lA(W,ce)})):ce&&oe.push(g(oe)+"rotate("+ce+c)}function a(W,ce,oe,fe){W!==ce?fe.push({i:oe.push(g(oe)+"skewX(",null,c)-2,x:lA(W,ce)}):ce&&oe.push(g(oe)+"skewX("+ce+c)}function U(W,ce,oe,fe,we,et){if(W!==oe||ce!==fe){var lt=we.push(g(we)+"scale(",null,",",null,")");et.push({i:lt-4,x:lA(W,oe)},{i:lt-2,x:lA(ce,fe)})}else(oe!==1||fe!==1)&&we.push(g(we)+"scale("+oe+","+fe+")")}return function(W,ce){var oe=[],fe=[];return W=e(W),ce=e(ce),b(W.translateX,W.translateY,ce.translateX,ce.translateY,oe,fe),E(W.rotate,ce.rotate,oe,fe),a(W.skewX,ce.skewX,oe,fe),U(W.scaleX,W.scaleY,ce.scaleX,ce.scaleY,oe,fe),W=ce=null,function(we){for(var et=-1,lt=fe.length,Ke;++et<lt;)oe[(Ke=fe[et]).i]=Ke.x(we);return oe.join("")}}}var QD=p4(jD,"px, ","px)","deg)"),WD=p4(ZD,", ",")",")"),XD=1e-12;function lb(e){return((e=Math.exp(e))+1/e)/2}function YD(e){return((e=Math.exp(e))-1/e)/2}function $D(e){return((e=Math.exp(2*e))-1)/(e+1)}const KD=function e(t,n,c){function g(b,E){var a=b[0],U=b[1],W=b[2],ce=E[0],oe=E[1],fe=E[2],we=ce-a,et=oe-U,lt=we*we+et*et,Ke,st;if(lt<XD)st=Math.log(fe/W)/t,Ke=function(ni){return[a+ni*we,U+ni*et,W*Math.exp(t*ni*st)]};else{var ut=Math.sqrt(lt),kt=(fe*fe-W*W+c*lt)/(2*W*n*ut),Bt=(fe*fe-W*W-c*lt)/(2*fe*n*ut),Rt=Math.log(Math.sqrt(kt*kt+1)-kt),Ge=Math.log(Math.sqrt(Bt*Bt+1)-Bt);st=(Ge-Rt)/t,Ke=function(ni){var it=ni*st,xt=lb(Rt),_t=W/(n*ut)*(xt*$D(t*it+Rt)-YD(Rt));return[a+_t*we,U+_t*et,W*xt/lb(t*it+Rt)]}}return Ke.duration=st*1e3*t/Math.SQRT2,Ke}return g.rho=function(b){var E=Math.max(.001,+b),a=E*E,U=a*a;return e(E,a,U)},g}(Math.SQRT2,2,4);var gm=0,ag=0,Zm=0,m4=1e3,M_,og,P_=0,rp=0,t1=0,gg=typeof performance=="object"&&performance.now?performance:Date,g4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Zv(){return rp||(g4(JD),rp=gg.now()+t1)}function JD(){rp=0}function D_(){this._call=this._time=this._next=null}D_.prototype=_4.prototype={constructor:D_,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Zv():+n)+(t==null?0:+t),!this._next&&og!==this&&(og?og._next=this:M_=this,og=this),this._call=e,this._time=n,tv()},stop:function(){this._call&&(this._call=null,this._time=1/0,tv())}};function _4(e,t,n){var c=new D_;return c.restart(e,t,n),c}function eL(){Zv(),++gm;for(var e=M_,t;e;)(t=rp-e._time)>=0&&e._call.call(null,t),e=e._next;--gm}function ub(){rp=(P_=gg.now())+t1,gm=ag=0;try{eL()}finally{gm=0,iL(),rp=0}}function tL(){var e=gg.now(),t=e-P_;t>m4&&(t1-=t,P_=e)}function iL(){for(var e,t=M_,n,c=1/0;t;)t._call?(c>t._time&&(c=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:M_=n);og=e,tv(c)}function tv(e){if(!gm){ag&&(ag=clearTimeout(ag));var t=e-rp;t>24?(e<1/0&&(ag=setTimeout(ub,e-gg.now()-t1)),Zm&&(Zm=clearInterval(Zm))):(Zm||(P_=gg.now(),Zm=setInterval(tL,m4)),gm=1,g4(ub))}}function cb(e,t,n){var c=new D_;return t=t==null?0:+t,c.restart(g=>{c.stop(),e(g+t)},t,n),c}var nL=K_("start","end","cancel","interrupt"),rL=[],y4=0,hb=1,iv=2,s_=3,Ab=4,nv=5,a_=6;function i1(e,t,n,c,g,b){var E=e.__transition;if(!E)e.__transition={};else if(n in E)return;sL(e,n,{name:t,index:c,group:g,on:nL,tween:rL,time:b.time,delay:b.delay,duration:b.duration,ease:b.ease,timer:null,state:y4})}function Qv(e,t){var n=hA(e,t);if(n.state>y4)throw new Error("too late; already scheduled");return n}function rf(e,t){var n=hA(e,t);if(n.state>s_)throw new Error("too late; already running");return n}function hA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function sL(e,t,n){var c=e.__transition,g;c[t]=n,n.timer=_4(b,0,n.time);function b(W){n.state=hb,n.timer.restart(E,n.delay,n.time),n.delay<=W&&E(W-n.delay)}function E(W){var ce,oe,fe,we;if(n.state!==hb)return U();for(ce in c)if(we=c[ce],we.name===n.name){if(we.state===s_)return cb(E);we.state===Ab?(we.state=a_,we.timer.stop(),we.on.call("interrupt",e,e.__data__,we.index,we.group),delete c[ce]):+ce<t&&(we.state=a_,we.timer.stop(),we.on.call("cancel",e,e.__data__,we.index,we.group),delete c[ce])}if(cb(function(){n.state===s_&&(n.state=Ab,n.timer.restart(a,n.delay,n.time),a(W))}),n.state=iv,n.on.call("start",e,e.__data__,n.index,n.group),n.state===iv){for(n.state=s_,g=new Array(fe=n.tween.length),ce=0,oe=-1;ce<fe;++ce)(we=n.tween[ce].value.call(e,e.__data__,n.index,n.group))&&(g[++oe]=we);g.length=oe+1}}function a(W){for(var ce=W<n.duration?n.ease.call(null,W/n.duration):(n.timer.restart(U),n.state=nv,1),oe=-1,fe=g.length;++oe<fe;)g[oe].call(e,ce);n.state===nv&&(n.on.call("end",e,e.__data__,n.index,n.group),U())}function U(){n.state=a_,n.timer.stop(),delete c[t];for(var W in c)return;delete e.__transition}}function cm(e,t){var n=e.__transition,c,g,b=!0,E;if(n){t=t==null?null:t+"";for(E in n){if((c=n[E]).name!==t){b=!1;continue}g=c.state>iv&&c.state<nv,c.state=a_,c.timer.stop(),c.on.call(g?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete n[E]}b&&delete e.__transition}}function aL(e){return this.each(function(){cm(this,e)})}function oL(e,t){var n,c;return function(){var g=rf(this,e),b=g.tween;if(b!==n){c=n=b;for(var E=0,a=c.length;E<a;++E)if(c[E].name===t){c=c.slice(),c.splice(E,1);break}}g.tween=c}}function lL(e,t,n){var c,g;if(typeof n!="function")throw new Error;return function(){var b=rf(this,e),E=b.tween;if(E!==c){g=(c=E).slice();for(var a={name:t,value:n},U=0,W=g.length;U<W;++U)if(g[U].name===t){g[U]=a;break}U===W&&g.push(a)}b.tween=g}}function uL(e,t){var n=this._id;if(e+="",arguments.length<2){for(var c=hA(this.node(),n).tween,g=0,b=c.length,E;g<b;++g)if((E=c[g]).name===e)return E.value;return null}return this.each((t==null?oL:lL)(n,e,t))}function Wv(e,t,n){var c=e._id;return e.each(function(){var g=rf(this,c);(g.value||(g.value={}))[t]=n.apply(this,arguments)}),function(g){return hA(g,c).value[t]}}function v4(e,t){var n;return(typeof t=="number"?lA:t instanceof np?k_:(n=np(t))?(t=n,k_):f4)(e,t)}function cL(e){return function(){this.removeAttribute(e)}}function hL(e){return function(){this.removeAttributeNS(e.space,e.local)}}function AL(e,t,n){var c,g=n+"",b;return function(){var E=this.getAttribute(e);return E===g?null:E===c?b:b=t(c=E,n)}}function fL(e,t,n){var c,g=n+"",b;return function(){var E=this.getAttributeNS(e.space,e.local);return E===g?null:E===c?b:b=t(c=E,n)}}function dL(e,t,n){var c,g,b;return function(){var E,a=n(this),U;return a==null?void this.removeAttribute(e):(E=this.getAttribute(e),U=a+"",E===U?null:E===c&&U===g?b:(g=U,b=t(c=E,a)))}}function pL(e,t,n){var c,g,b;return function(){var E,a=n(this),U;return a==null?void this.removeAttributeNS(e.space,e.local):(E=this.getAttributeNS(e.space,e.local),U=a+"",E===U?null:E===c&&U===g?b:(g=U,b=t(c=E,a)))}}function mL(e,t){var n=J_(e),c=n==="transform"?WD:v4;return this.attrTween(e,typeof t=="function"?(n.local?pL:dL)(n,c,Wv(this,"attr."+e,t)):t==null?(n.local?hL:cL)(n):(n.local?fL:AL)(n,c,t))}function gL(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function _L(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function yL(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&_L(e,b)),n}return g._value=t,g}function vL(e,t){var n,c;function g(){var b=t.apply(this,arguments);return b!==c&&(n=(c=b)&&gL(e,b)),n}return g._value=t,g}function xL(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var c=J_(e);return this.tween(n,(c.local?yL:vL)(c,t))}function bL(e,t){return function(){Qv(this,e).delay=+t.apply(this,arguments)}}function wL(e,t){return t=+t,function(){Qv(this,e).delay=t}}function SL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?bL:wL)(t,e)):hA(this.node(),t).delay}function IL(e,t){return function(){rf(this,e).duration=+t.apply(this,arguments)}}function EL(e,t){return t=+t,function(){rf(this,e).duration=t}}function CL(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?IL:EL)(t,e)):hA(this.node(),t).duration}function TL(e,t){if(typeof t!="function")throw new Error;return function(){rf(this,e).ease=t}}function kL(e){var t=this._id;return arguments.length?this.each(TL(t,e)):hA(this.node(),t).ease}function ML(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;rf(this,e).ease=n}}function PL(e){if(typeof e!="function")throw new Error;return this.each(ML(this._id,e))}function DL(e){typeof e!="function"&&(e=K3(e));for(var t=this._groups,n=t.length,c=new Array(n),g=0;g<n;++g)for(var b=t[g],E=b.length,a=c[g]=[],U,W=0;W<E;++W)(U=b[W])&&e.call(U,U.__data__,W,b)&&a.push(U);return new i0(c,this._parents,this._name,this._id)}function LL(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,c=t.length,g=n.length,b=Math.min(c,g),E=new Array(c),a=0;a<b;++a)for(var U=t[a],W=n[a],ce=U.length,oe=E[a]=new Array(ce),fe,we=0;we<ce;++we)(fe=U[we]||W[we])&&(oe[we]=fe);for(;a<c;++a)E[a]=t[a];return new i0(E,this._parents,this._name,this._id)}function BL(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function zL(e,t,n){var c,g,b=BL(t)?Qv:rf;return function(){var E=b(this,e),a=E.on;a!==c&&(g=(c=a).copy()).on(t,n),E.on=g}}function RL(e,t){var n=this._id;return arguments.length<2?hA(this.node(),n).on.on(e):this.each(zL(n,e,t))}function FL(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function OL(){return this.on("end.remove",FL(this._id))}function NL(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Gv(e));for(var c=this._groups,g=c.length,b=new Array(g),E=0;E<g;++E)for(var a=c[E],U=a.length,W=b[E]=new Array(U),ce,oe,fe=0;fe<U;++fe)(ce=a[fe])&&(oe=e.call(ce,ce.__data__,fe,a))&&("__data__"in ce&&(oe.__data__=ce.__data__),W[fe]=oe,i1(W[fe],t,n,fe,W,hA(ce,n)));return new i0(b,this._parents,t,n)}function VL(e){var t=this._name,n=this._id;typeof e!="function"&&(e=$3(e));for(var c=this._groups,g=c.length,b=[],E=[],a=0;a<g;++a)for(var U=c[a],W=U.length,ce,oe=0;oe<W;++oe)if(ce=U[oe]){for(var fe=e.call(ce,ce.__data__,oe,U),we,et=hA(ce,n),lt=0,Ke=fe.length;lt<Ke;++lt)(we=fe[lt])&&i1(we,t,n,lt,fe,et);b.push(fe),E.push(ce)}return new i0(b,E,t,n)}var UL=kg.prototype.constructor;function GL(){return new UL(this._groups,this._parents)}function qL(e,t){var n,c,g;return function(){var b=mm(this,e),E=(this.style.removeProperty(e),mm(this,e));return b===E?null:b===n&&E===c?g:g=t(n=b,c=E)}}function x4(e){return function(){this.style.removeProperty(e)}}function HL(e,t,n){var c,g=n+"",b;return function(){var E=mm(this,e);return E===g?null:E===c?b:b=t(c=E,n)}}function jL(e,t,n){var c,g,b;return function(){var E=mm(this,e),a=n(this),U=a+"";return a==null&&(U=a=(this.style.removeProperty(e),mm(this,e))),E===U?null:E===c&&U===g?b:(g=U,b=t(c=E,a))}}function ZL(e,t){var n,c,g,b="style."+t,E="end."+b,a;return function(){var U=rf(this,e),W=U.on,ce=U.value[b]==null?a||(a=x4(t)):void 0;(W!==n||g!==ce)&&(c=(n=W).copy()).on(E,g=ce),U.on=c}}function QL(e,t,n){var c=(e+="")=="transform"?QD:v4;return t==null?this.styleTween(e,qL(e,c)).on("end.style."+e,x4(e)):typeof t=="function"?this.styleTween(e,jL(e,c,Wv(this,"style."+e,t))).each(ZL(this._id,e)):this.styleTween(e,HL(e,c,t),n).on("end.style."+e,null)}function WL(e,t,n){return function(c){this.style.setProperty(e,t.call(this,c),n)}}function XL(e,t,n){var c,g;function b(){var E=t.apply(this,arguments);return E!==g&&(c=(g=E)&&WL(e,E,n)),c}return b._value=t,b}function YL(e,t,n){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(t==null)return this.tween(c,null);if(typeof t!="function")throw new Error;return this.tween(c,XL(e,t,n??""))}function $L(e){return function(){this.textContent=e}}function KL(e){return function(){var t=e(this);this.textContent=t??""}}function JL(e){return this.tween("text",typeof e=="function"?KL(Wv(this,"text",e)):$L(e==null?"":e+""))}function eB(e){return function(t){this.textContent=e.call(this,t)}}function tB(e){var t,n;function c(){var g=e.apply(this,arguments);return g!==n&&(t=(n=g)&&eB(g)),t}return c._value=e,c}function iB(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,tB(e))}function nB(){for(var e=this._name,t=this._id,n=b4(),c=this._groups,g=c.length,b=0;b<g;++b)for(var E=c[b],a=E.length,U,W=0;W<a;++W)if(U=E[W]){var ce=hA(U,t);i1(U,e,n,W,E,{time:ce.time+ce.delay+ce.duration,delay:0,duration:ce.duration,ease:ce.ease})}return new i0(c,this._parents,e,n)}function rB(){var e,t,n=this,c=n._id,g=n.size();return new Promise(function(b,E){var a={value:E},U={value:function(){--g===0&&b()}};n.each(function(){var W=rf(this,c),ce=W.on;ce!==e&&(t=(e=ce).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(U)),W.on=t}),g===0&&b()})}var sB=0;function i0(e,t,n,c){this._groups=e,this._parents=t,this._name=n,this._id=c}function b4(){return++sB}var qd=kg.prototype;i0.prototype={constructor:i0,select:NL,selectAll:VL,filter:DL,merge:LL,selection:GL,transition:nB,call:qd.call,nodes:qd.nodes,node:qd.node,size:qd.size,empty:qd.empty,each:qd.each,on:RL,attr:mL,attrTween:xL,style:QL,styleTween:YL,text:JL,textTween:iB,remove:OL,tween:uL,delay:SL,duration:CL,ease:kL,easeVarying:PL,end:rB,[Symbol.iterator]:qd[Symbol.iterator]};function aB(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var oB={time:null,delay:0,duration:250,ease:aB};function lB(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function uB(e){var t,n;e instanceof i0?(t=e._id,e=e._name):(t=b4(),(n=oB).time=Zv(),e=e==null?null:e+"");for(var c=this._groups,g=c.length,b=0;b<g;++b)for(var E=c[b],a=E.length,U,W=0;W<a;++W)(U=E[W])&&i1(U,e,t,W,E,n||lB(U,t));return new i0(c,this._parents,e,t)}kg.prototype.interrupt=aL;kg.prototype.transition=uB;const q1=e=>()=>e;function cB(e,{sourceEvent:t,target:n,selection:c,mode:g,dispatch:b}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:c,enumerable:!0,configurable:!0},mode:{value:g,enumerable:!0,configurable:!0},_:{value:b}})}function hB(e){e.stopImmediatePropagation()}function H1(e){e.preventDefault(),e.stopImmediatePropagation()}var fb={name:"drag"},j1={name:"space"},Qp={name:"handle"},Wp={name:"center"};const{abs:db,max:$u,min:Ku}=Math;function pb(e){return[+e[0],+e[1]]}function rv(e){return[pb(e[0]),pb(e[1])]}var Z1={name:"x",handles:["w","e"].map(_g),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Q1={name:"y",handles:["n","s"].map(_g),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},AB={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(_g),input:function(e){return e==null?null:rv(e)},output:function(e){return e}},Qf={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},mb={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},gb={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},fB={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},dB={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function _g(e){return{type:e}}function pB(e){return!e.ctrlKey&&!e.button}function mB(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function gB(){return navigator.maxTouchPoints||"ontouchstart"in this}function W1(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function _B(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function yB(){return vB(AB)}function vB(e){var t=mB,n=pB,c=gB,g=!0,b=K_("start","brush","end"),E=6,a;function U(Ke){var st=Ke.property("__brush",lt).selectAll(".overlay").data([_g("overlay")]);st.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Qf.overlay).merge(st).each(function(){var kt=W1(this).extent;Al(this).attr("x",kt[0][0]).attr("y",kt[0][1]).attr("width",kt[1][0]-kt[0][0]).attr("height",kt[1][1]-kt[0][1])}),Ke.selectAll(".selection").data([_g("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Qf.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var ut=Ke.selectAll(".handle").data(e.handles,function(kt){return kt.type});ut.exit().remove(),ut.enter().append("rect").attr("class",function(kt){return"handle handle--"+kt.type}).attr("cursor",function(kt){return Qf[kt.type]}),Ke.each(W).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",fe).filter(c).on("touchstart.brush",fe).on("touchmove.brush",we).on("touchend.brush touchcancel.brush",et).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}U.move=function(Ke,st){Ke.tween?Ke.on("start.brush",function(ut){ce(this,arguments).beforestart().start(ut)}).on("interrupt.brush end.brush",function(ut){ce(this,arguments).end(ut)}).tween("brush",function(){var ut=this,kt=ut.__brush,Bt=ce(ut,arguments),Rt=kt.selection,Ge=e.input(typeof st=="function"?st.apply(this,arguments):st,kt.extent),ni=e1(Rt,Ge);function it(xt){kt.selection=xt===1&&Ge===null?null:ni(xt),W.call(ut),Bt.brush()}return Rt!==null&&Ge!==null?it:it(1)}):Ke.each(function(){var ut=this,kt=arguments,Bt=ut.__brush,Rt=e.input(typeof st=="function"?st.apply(ut,kt):st,Bt.extent),Ge=ce(ut,kt).beforestart();cm(ut),Bt.selection=Rt===null?null:Rt,W.call(ut),Ge.start().brush().end()})},U.clear=function(Ke){U.move(Ke,null)};function W(){var Ke=Al(this),st=W1(this).selection;st?(Ke.selectAll(".selection").style("display",null).attr("x",st[0][0]).attr("y",st[0][1]).attr("width",st[1][0]-st[0][0]).attr("height",st[1][1]-st[0][1]),Ke.selectAll(".handle").style("display",null).attr("x",function(ut){return ut.type[ut.type.length-1]==="e"?st[1][0]-E/2:st[0][0]-E/2}).attr("y",function(ut){return ut.type[0]==="s"?st[1][1]-E/2:st[0][1]-E/2}).attr("width",function(ut){return ut.type==="n"||ut.type==="s"?st[1][0]-st[0][0]+E:E}).attr("height",function(ut){return ut.type==="e"||ut.type==="w"?st[1][1]-st[0][1]+E:E})):Ke.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function ce(Ke,st,ut){var kt=Ke.__brush.emitter;return kt&&(!ut||!kt.clean)?kt:new oe(Ke,st,ut)}function oe(Ke,st,ut){this.that=Ke,this.args=st,this.state=Ke.__brush,this.active=0,this.clean=ut}oe.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(Ke,st){return this.starting?(this.starting=!1,this.emit("start",Ke,st)):this.emit("brush",Ke),this},brush:function(Ke,st){return this.emit("brush",Ke,st),this},end:function(Ke,st){return--this.active===0&&(delete this.state.emitter,this.emit("end",Ke,st)),this},emit:function(Ke,st,ut){var kt=Al(this.that).datum();b.call(Ke,this.that,new cB(Ke,{sourceEvent:st,target:U,selection:e.output(this.state.selection),mode:ut,dispatch:b}),kt)}};function fe(Ke){if(a&&!Ke.touches||!n.apply(this,arguments))return;var st=this,ut=Ke.target.__data__.type,kt=(g&&Ke.metaKey?ut="overlay":ut)==="selection"?fb:g&&Ke.altKey?Wp:Qp,Bt=e===Q1?null:fB[ut],Rt=e===Z1?null:dB[ut],Ge=W1(st),ni=Ge.extent,it=Ge.selection,xt=ni[0][0],_t,mt,bt=ni[0][1],dt,nt,pt=ni[1][0],at,Nt,Ft=ni[1][1],Dt,ci,bi=0,ki=0,Gi,rn=Bt&&Rt&&g&&Ke.shiftKey,$i,qi,sn=Array.from(Ke.touches||[Ke],ti=>{const Mn=ti.identifier;return ti=Yf(ti,st),ti.point0=ti.slice(),ti.identifier=Mn,ti});if(ut==="overlay"){it&&(Gi=!0);const ti=[sn[0],sn[1]||sn[0]];Ge.selection=it=[[_t=e===Q1?xt:Ku(ti[0][0],ti[1][0]),dt=e===Z1?bt:Ku(ti[0][1],ti[1][1])],[at=e===Q1?pt:$u(ti[0][0],ti[1][0]),Dt=e===Z1?Ft:$u(ti[0][1],ti[1][1])]],sn.length>1&&fn()}else _t=it[0][0],dt=it[0][1],at=it[1][0],Dt=it[1][1];mt=_t,nt=dt,Nt=at,ci=Dt;var Ti=Al(st).attr("pointer-events","none"),yi=Ti.selectAll(".overlay").attr("cursor",Qf[ut]);cm(st);var hi=ce(st,arguments,!0).beforestart();if(Ke.touches)hi.moved=Li,hi.ended=_n;else{var Ei=Al(Ke.view).on("mousemove.brush",Li,!0).on("mouseup.brush",_n,!0);g&&Ei.on("keydown.brush",gi,!0).on("keyup.brush",mn,!0),l4(Ke.view)}W.call(st),hi.start(Ke,kt.name);function Li(ti){for(const Mn of ti.changedTouches||[ti])for(const ns of sn)ns.identifier===Mn.identifier&&(ns.cur=Yf(Mn,st));if(rn&&!$i&&!qi&&sn.length===1){const Mn=sn[0];db(Mn.cur[0]-Mn[0])>db(Mn.cur[1]-Mn[1])?qi=!0:$i=!0}for(const Mn of sn)Mn.cur&&(Mn[0]=Mn.cur[0],Mn[1]=Mn.cur[1]);Gi=!0,H1(ti),fn(ti)}function fn(ti){const Mn=sn[0],ns=Mn.point0;var fi;switch(bi=Mn[0]-ns[0],ki=Mn[1]-ns[1],kt){case j1:case fb:{Bt&&(bi=$u(xt-_t,Ku(pt-at,bi)),mt=_t+bi,Nt=at+bi),Rt&&(ki=$u(bt-dt,Ku(Ft-Dt,ki)),nt=dt+ki,ci=Dt+ki);break}case Qp:{sn[1]?(Bt&&(mt=$u(xt,Ku(pt,sn[0][0])),Nt=$u(xt,Ku(pt,sn[1][0])),Bt=1),Rt&&(nt=$u(bt,Ku(Ft,sn[0][1])),ci=$u(bt,Ku(Ft,sn[1][1])),Rt=1)):(Bt<0?(bi=$u(xt-_t,Ku(pt-_t,bi)),mt=_t+bi,Nt=at):Bt>0&&(bi=$u(xt-at,Ku(pt-at,bi)),mt=_t,Nt=at+bi),Rt<0?(ki=$u(bt-dt,Ku(Ft-dt,ki)),nt=dt+ki,ci=Dt):Rt>0&&(ki=$u(bt-Dt,Ku(Ft-Dt,ki)),nt=dt,ci=Dt+ki));break}case Wp:{Bt&&(mt=$u(xt,Ku(pt,_t-bi*Bt)),Nt=$u(xt,Ku(pt,at+bi*Bt))),Rt&&(nt=$u(bt,Ku(Ft,dt-ki*Rt)),ci=$u(bt,Ku(Ft,Dt+ki*Rt)));break}}Nt<mt&&(Bt*=-1,fi=_t,_t=at,at=fi,fi=mt,mt=Nt,Nt=fi,ut in mb&&yi.attr("cursor",Qf[ut=mb[ut]])),ci<nt&&(Rt*=-1,fi=dt,dt=Dt,Dt=fi,fi=nt,nt=ci,ci=fi,ut in gb&&yi.attr("cursor",Qf[ut=gb[ut]])),Ge.selection&&(it=Ge.selection),$i&&(mt=it[0][0],Nt=it[1][0]),qi&&(nt=it[0][1],ci=it[1][1]),(it[0][0]!==mt||it[0][1]!==nt||it[1][0]!==Nt||it[1][1]!==ci)&&(Ge.selection=[[mt,nt],[Nt,ci]],W.call(st),hi.brush(ti,kt.name))}function _n(ti){if(hB(ti),ti.touches){if(ti.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else u4(ti.view,Gi),Ei.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);Ti.attr("pointer-events","all"),yi.attr("cursor",Qf.overlay),Ge.selection&&(it=Ge.selection),_B(it)&&(Ge.selection=null,W.call(st)),hi.end(ti,kt.name)}function gi(ti){switch(ti.keyCode){case 16:{rn=Bt&&Rt;break}case 18:{kt===Qp&&(Bt&&(at=Nt-bi*Bt,_t=mt+bi*Bt),Rt&&(Dt=ci-ki*Rt,dt=nt+ki*Rt),kt=Wp,fn());break}case 32:{(kt===Qp||kt===Wp)&&(Bt<0?at=Nt-bi:Bt>0&&(_t=mt-bi),Rt<0?Dt=ci-ki:Rt>0&&(dt=nt-ki),kt=j1,yi.attr("cursor",Qf.selection),fn());break}default:return}H1(ti)}function mn(ti){switch(ti.keyCode){case 16:{rn&&($i=qi=rn=!1,fn());break}case 18:{kt===Wp&&(Bt<0?at=Nt:Bt>0&&(_t=mt),Rt<0?Dt=ci:Rt>0&&(dt=nt),kt=Qp,fn());break}case 32:{kt===j1&&(ti.altKey?(Bt&&(at=Nt-bi*Bt,_t=mt+bi*Bt),Rt&&(Dt=ci-ki*Rt,dt=nt+ki*Rt),kt=Wp):(Bt<0?at=Nt:Bt>0&&(_t=mt),Rt<0?Dt=ci:Rt>0&&(dt=nt),kt=Qp),yi.attr("cursor",Qf[ut]),fn());break}default:return}H1(ti)}}function we(Ke){ce(this,arguments).moved(Ke)}function et(Ke){ce(this,arguments).ended(Ke)}function lt(){var Ke=this.__brush||{selection:null};return Ke.extent=rv(t.apply(this,arguments)),Ke.dim=e,Ke}return U.extent=function(Ke){return arguments.length?(t=typeof Ke=="function"?Ke:q1(rv(Ke)),U):t},U.filter=function(Ke){return arguments.length?(n=typeof Ke=="function"?Ke:q1(!!Ke),U):n},U.touchable=function(Ke){return arguments.length?(c=typeof Ke=="function"?Ke:q1(!!Ke),U):c},U.handleSize=function(Ke){return arguments.length?(E=+Ke,U):E},U.keyModifiers=function(Ke){return arguments.length?(g=!!Ke,U):g},U.on=function(){var Ke=b.on.apply(b,arguments);return Ke===b?U:Ke},U}const sv=Math.PI,av=2*sv,Zd=1e-6,xB=av-Zd;function ov(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function w4(){return new ov}ov.prototype=w4.prototype={constructor:ov,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,c){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+c)},bezierCurveTo:function(e,t,n,c,g,b){this._+="C"+ +e+","+ +t+","+ +n+","+ +c+","+(this._x1=+g)+","+(this._y1=+b)},arcTo:function(e,t,n,c,g){e=+e,t=+t,n=+n,c=+c,g=+g;var b=this._x1,E=this._y1,a=n-e,U=c-t,W=b-e,ce=E-t,oe=W*W+ce*ce;if(g<0)throw new Error("negative radius: "+g);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(oe>Zd)if(!(Math.abs(ce*a-U*W)>Zd)||!g)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var fe=n-b,we=c-E,et=a*a+U*U,lt=fe*fe+we*we,Ke=Math.sqrt(et),st=Math.sqrt(oe),ut=g*Math.tan((sv-Math.acos((et+oe-lt)/(2*Ke*st)))/2),kt=ut/st,Bt=ut/Ke;Math.abs(kt-1)>Zd&&(this._+="L"+(e+kt*W)+","+(t+kt*ce)),this._+="A"+g+","+g+",0,0,"+ +(ce*fe>W*we)+","+(this._x1=e+Bt*a)+","+(this._y1=t+Bt*U)}},arc:function(e,t,n,c,g,b){e=+e,t=+t,n=+n,b=!!b;var E=n*Math.cos(c),a=n*Math.sin(c),U=e+E,W=t+a,ce=1^b,oe=b?c-g:g-c;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+U+","+W:(Math.abs(this._x1-U)>Zd||Math.abs(this._y1-W)>Zd)&&(this._+="L"+U+","+W),n&&(oe<0&&(oe=oe%av+av),oe>xB?this._+="A"+n+","+n+",0,1,"+ce+","+(e-E)+","+(t-a)+"A"+n+","+n+",0,1,"+ce+","+(this._x1=U)+","+(this._y1=W):oe>Zd&&(this._+="A"+n+","+n+",0,"+ +(oe>=sv)+","+ce+","+(this._x1=e+n*Math.cos(g))+","+(this._y1=t+n*Math.sin(g))))},rect:function(e,t,n,c){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +c+"h"+-n+"Z"},toString:function(){return this._}};function bB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function L_(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,c=e.slice(0,n);return[c.length>1?c[0]+c.slice(2):c,+e.slice(n+1)]}function _m(e){return e=L_(Math.abs(e)),e?e[1]:NaN}function wB(e,t){return function(n,c){for(var g=n.length,b=[],E=0,a=e[0],U=0;g>0&&a>0&&(U+a+1>c&&(a=Math.max(1,c-U)),b.push(n.substring(g-=a,g+a)),!((U+=a+1)>c));)a=e[E=(E+1)%e.length];return b.reverse().join(t)}}function SB(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var IB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B_(e){if(!(t=IB.exec(e)))throw new Error("invalid format: "+e);var t;return new Xv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}B_.prototype=Xv.prototype;function Xv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Xv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function EB(e){e:for(var t=e.length,n=1,c=-1,g;n<t;++n)switch(e[n]){case".":c=g=n;break;case"0":c===0&&(c=n),g=n;break;default:if(!+e[n])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(g+1):e}var S4;function CB(e,t){var n=L_(e,t);if(!n)return e+"";var c=n[0],g=n[1],b=g-(S4=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,E=c.length;return b===E?c:b>E?c+new Array(b-E+1).join("0"):b>0?c.slice(0,b)+"."+c.slice(b):"0."+new Array(1-b).join("0")+L_(e,Math.max(0,t+b-1))[0]}function _b(e,t){var n=L_(e,t);if(!n)return e+"";var c=n[0],g=n[1];return g<0?"0."+new Array(-g).join("0")+c:c.length>g+1?c.slice(0,g+1)+"."+c.slice(g+1):c+new Array(g-c.length+2).join("0")}const yb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:bB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_b(e*100,t),r:_b,s:CB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function vb(e){return e}var xb=Array.prototype.map,bb=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function TB(e){var t=e.grouping===void 0||e.thousands===void 0?vb:wB(xb.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",g=e.decimal===void 0?".":e.decimal+"",b=e.numerals===void 0?vb:SB(xb.call(e.numerals,String)),E=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",U=e.nan===void 0?"NaN":e.nan+"";function W(oe){oe=B_(oe);var fe=oe.fill,we=oe.align,et=oe.sign,lt=oe.symbol,Ke=oe.zero,st=oe.width,ut=oe.comma,kt=oe.precision,Bt=oe.trim,Rt=oe.type;Rt==="n"?(ut=!0,Rt="g"):yb[Rt]||(kt===void 0&&(kt=12),Bt=!0,Rt="g"),(Ke||fe==="0"&&we==="=")&&(Ke=!0,fe="0",we="=");var Ge=lt==="$"?n:lt==="#"&&/[boxX]/.test(Rt)?"0"+Rt.toLowerCase():"",ni=lt==="$"?c:/[%p]/.test(Rt)?E:"",it=yb[Rt],xt=/[defgprs%]/.test(Rt);kt=kt===void 0?6:/[gprs]/.test(Rt)?Math.max(1,Math.min(21,kt)):Math.max(0,Math.min(20,kt));function _t(mt){var bt=Ge,dt=ni,nt,pt,at;if(Rt==="c")dt=it(mt)+dt,mt="";else{mt=+mt;var Nt=mt<0||1/mt<0;if(mt=isNaN(mt)?U:it(Math.abs(mt),kt),Bt&&(mt=EB(mt)),Nt&&+mt==0&&et!=="+"&&(Nt=!1),bt=(Nt?et==="("?et:a:et==="-"||et==="("?"":et)+bt,dt=(Rt==="s"?bb[8+S4/3]:"")+dt+(Nt&&et==="("?")":""),xt){for(nt=-1,pt=mt.length;++nt<pt;)if(at=mt.charCodeAt(nt),48>at||at>57){dt=(at===46?g+mt.slice(nt+1):mt.slice(nt))+dt,mt=mt.slice(0,nt);break}}}ut&&!Ke&&(mt=t(mt,1/0));var Ft=bt.length+mt.length+dt.length,Dt=Ft<st?new Array(st-Ft+1).join(fe):"";switch(ut&&Ke&&(mt=t(Dt+mt,Dt.length?st-dt.length:1/0),Dt=""),we){case"<":mt=bt+mt+dt+Dt;break;case"=":mt=bt+Dt+mt+dt;break;case"^":mt=Dt.slice(0,Ft=Dt.length>>1)+bt+mt+dt+Dt.slice(Ft);break;default:mt=Dt+bt+mt+dt;break}return b(mt)}return _t.toString=function(){return oe+""},_t}function ce(oe,fe){var we=W((oe=B_(oe),oe.type="f",oe)),et=Math.max(-8,Math.min(8,Math.floor(_m(fe)/3)))*3,lt=Math.pow(10,-et),Ke=bb[8+et/3];return function(st){return we(lt*st)+Ke}}return{format:W,formatPrefix:ce}}var Wg,Yv,I4;kB({thousands:",",grouping:[3],currency:["$",""]});function kB(e){return Wg=TB(e),Yv=Wg.format,I4=Wg.formatPrefix,Wg}function MB(e){return Math.max(0,-_m(Math.abs(e)))}function PB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(_m(t)/3)))*3-_m(Math.abs(e)))}function DB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,_m(t)-_m(e))+1}function LB(e){var t=0,n=e.children,c=n&&n.length;if(!c)t=1;else for(;--c>=0;)t+=n[c].value;e.value=t}function BB(){return this.eachAfter(LB)}function zB(e,t){let n=-1;for(const c of this)e.call(t,c,++n,this);return this}function RB(e,t){for(var n=this,c=[n],g,b,E=-1;n=c.pop();)if(e.call(t,n,++E,this),g=n.children)for(b=g.length-1;b>=0;--b)c.push(g[b]);return this}function FB(e,t){for(var n=this,c=[n],g=[],b,E,a,U=-1;n=c.pop();)if(g.push(n),b=n.children)for(E=0,a=b.length;E<a;++E)c.push(b[E]);for(;n=g.pop();)e.call(t,n,++U,this);return this}function OB(e,t){let n=-1;for(const c of this)if(e.call(t,c,++n,this))return c}function NB(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,c=t.children,g=c&&c.length;--g>=0;)n+=c[g].value;t.value=n})}function VB(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function UB(e){for(var t=this,n=GB(t,e),c=[t];t!==n;)t=t.parent,c.push(t);for(var g=c.length;e!==n;)c.splice(g,0,e),e=e.parent;return c}function GB(e,t){if(e===t)return e;var n=e.ancestors(),c=t.ancestors(),g=null;for(e=n.pop(),t=c.pop();e===t;)g=e,e=n.pop(),t=c.pop();return g}function qB(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function HB(){return Array.from(this)}function jB(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function ZB(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*QB(){var e=this,t,n=[e],c,g,b;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,c=e.children)for(g=0,b=c.length;g<b;++g)n.push(c[g]);while(n.length)}function $d(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=YB)):t===void 0&&(t=XB);for(var n=new z_(e),c,g=[n],b,E,a,U;c=g.pop();)if((E=t(c.data))&&(U=(E=Array.from(E)).length))for(c.children=E,a=U-1;a>=0;--a)g.push(b=E[a]=new z_(E[a])),b.parent=c,b.depth=c.depth+1;return n.eachBefore(KB)}function WB(){return $d(this).eachBefore($B)}function XB(e){return e.children}function YB(e){return Array.isArray(e)?e[1]:null}function $B(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function KB(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function z_(e){this.data=e,this.depth=this.height=0,this.parent=null}z_.prototype=$d.prototype={constructor:z_,count:BB,each:zB,eachAfter:FB,eachBefore:RB,find:OB,sum:NB,sort:VB,path:UB,ancestors:qB,descendants:HB,leaves:jB,links:ZB,copy:WB,[Symbol.iterator]:QB};function JB(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function e7(e){return function(){return e}}function t7(e){return+e}var wb=[0,1];function tm(e){return e}function lv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:e7(isNaN(t)?NaN:.5)}function i7(e,t){var n;return e>t&&(n=e,e=t,t=n),function(c){return Math.max(e,Math.min(t,c))}}function n7(e,t,n){var c=e[0],g=e[1],b=t[0],E=t[1];return g<c?(c=lv(g,c),b=n(E,b)):(c=lv(c,g),b=n(b,E)),function(a){return b(c(a))}}function r7(e,t,n){var c=Math.min(e.length,t.length)-1,g=new Array(c),b=new Array(c),E=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++E<c;)g[E]=lv(e[E],e[E+1]),b[E]=n(t[E],t[E+1]);return function(a){var U=PM(e,a,1,c)-1;return b[U](g[U](a))}}function s7(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function a7(){var e=wb,t=wb,n=e1,c,g,b,E=tm,a,U,W;function ce(){var fe=Math.min(e.length,t.length);return E!==tm&&(E=i7(e[0],e[fe-1])),a=fe>2?r7:n7,U=W=null,oe}function oe(fe){return fe==null||isNaN(fe=+fe)?b:(U||(U=a(e.map(c),t,n)))(c(E(fe)))}return oe.invert=function(fe){return E(g((W||(W=a(t,e.map(c),lA)))(fe)))},oe.domain=function(fe){return arguments.length?(e=Array.from(fe,t7),ce()):e.slice()},oe.range=function(fe){return arguments.length?(t=Array.from(fe),ce()):t.slice()},oe.rangeRound=function(fe){return t=Array.from(fe),n=HD,ce()},oe.clamp=function(fe){return arguments.length?(E=fe?!0:tm,ce()):E!==tm},oe.interpolate=function(fe){return arguments.length?(n=fe,ce()):n},oe.unknown=function(fe){return arguments.length?(b=fe,oe):b},function(fe,we){return c=fe,g=we,ce()}}function o7(){return a7()(tm,tm)}function l7(e,t,n,c){var g=LM(e,t,n),b;switch(c=B_(c??",f"),c.type){case"s":{var E=Math.max(Math.abs(e),Math.abs(t));return c.precision==null&&!isNaN(b=PB(g,E))&&(c.precision=b),I4(c,E)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(b=DB(g,Math.max(Math.abs(e),Math.abs(t))))&&(c.precision=b-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(b=MB(g))&&(c.precision=b-(c.type==="%")*2);break}}return Yv(c)}function u7(e){var t=e.domain;return e.ticks=function(n){var c=t();return DM(c[0],c[c.length-1],n??10)},e.tickFormat=function(n,c){var g=t();return l7(g[0],g[g.length-1],n??10,c)},e.nice=function(n){n==null&&(n=10);var c=t(),g=0,b=c.length-1,E=c[g],a=c[b],U,W,ce=10;for(a<E&&(W=E,E=a,a=W,W=g,g=b,b=W);ce-- >0;){if(W=X3(E,a,n),W===U)return c[g]=E,c[b]=a,t(c);if(W>0)E=Math.floor(E/W)*W,a=Math.ceil(a/W)*W;else if(W<0)E=Math.ceil(E*W)/W,a=Math.floor(a*W)/W;else break;U=W}return e},e}function E4(){var e=o7();return e.copy=function(){return s7(e,E4())},JB.apply(e,arguments),u7(e)}var X1=new Date,Y1=new Date;function a0(e,t,n,c){function g(b){return e(b=arguments.length===0?new Date:new Date(+b)),b}return g.floor=function(b){return e(b=new Date(+b)),b},g.ceil=function(b){return e(b=new Date(b-1)),t(b,1),e(b),b},g.round=function(b){var E=g(b),a=g.ceil(b);return b-E<a-b?E:a},g.offset=function(b,E){return t(b=new Date(+b),E==null?1:Math.floor(E)),b},g.range=function(b,E,a){var U=[],W;if(b=g.ceil(b),a=a==null?1:Math.floor(a),!(b<E)||!(a>0))return U;do U.push(W=new Date(+b)),t(b,a),e(b);while(W<b&&b<E);return U},g.filter=function(b){return a0(function(E){if(E>=E)for(;e(E),!b(E);)E.setTime(E-1)},function(E,a){if(E>=E)if(a<0)for(;++a<=0;)for(;t(E,-1),!b(E););else for(;--a>=0;)for(;t(E,1),!b(E););})},n&&(g.count=function(b,E){return X1.setTime(+b),Y1.setTime(+E),e(X1),e(Y1),Math.floor(n(X1,Y1))},g.every=function(b){return b=Math.floor(b),!isFinite(b)||!(b>0)?null:b>1?g.filter(c?function(E){return c(E)%b===0}:function(E){return g.count(0,E)%b===0}):g}),g}const c7=1e3,$v=c7*60,h7=$v*60,Kv=h7*24,C4=Kv*7;var Jv=a0(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*$v)/Kv,e=>e.getDate()-1);Jv.range;function cp(e){return a0(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*$v)/C4})}var T4=cp(0),R_=cp(1),A7=cp(2),f7=cp(3),ym=cp(4),d7=cp(5),p7=cp(6);T4.range;R_.range;A7.range;f7.range;ym.range;d7.range;p7.range;var sp=a0(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});sp.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:a0(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};sp.range;var e2=a0(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Kv},function(e){return e.getUTCDate()-1});e2.range;function hp(e){return a0(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/C4})}var k4=hp(0),F_=hp(1),m7=hp(2),g7=hp(3),vm=hp(4),_7=hp(5),y7=hp(6);k4.range;F_.range;m7.range;g7.range;vm.range;_7.range;y7.range;var ap=a0(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ap.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:a0(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};ap.range;function $1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function K1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Qm(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function v7(e){var t=e.dateTime,n=e.date,c=e.time,g=e.periods,b=e.days,E=e.shortDays,a=e.months,U=e.shortMonths,W=Wm(g),ce=Xm(g),oe=Wm(b),fe=Xm(b),we=Wm(E),et=Xm(E),lt=Wm(a),Ke=Xm(a),st=Wm(U),ut=Xm(U),kt={a:Nt,A:Ft,b:Dt,B:ci,c:null,d:kb,e:kb,f:q7,g:J7,G:tz,H:V7,I:U7,j:G7,L:M4,m:H7,M:j7,p:bi,q:ki,Q:Db,s:Lb,S:Z7,u:Q7,U:W7,V:X7,w:Y7,W:$7,x:null,X:null,y:K7,Y:ez,Z:iz,"%":Pb},Bt={a:Gi,A:rn,b:$i,B:qi,c:null,d:Mb,e:Mb,f:az,g:mz,G:_z,H:nz,I:rz,j:sz,L:D4,m:oz,M:lz,p:sn,q:Ti,Q:Db,s:Lb,S:uz,u:cz,U:hz,V:Az,w:fz,W:dz,x:null,X:null,y:pz,Y:gz,Z:yz,"%":Pb},Rt={a:_t,A:mt,b:bt,B:dt,c:nt,d:Cb,e:Cb,f:R7,g:Eb,G:Ib,H:Tb,I:Tb,j:D7,L:z7,m:P7,M:L7,p:xt,q:M7,Q:O7,s:N7,S:B7,u:I7,U:E7,V:C7,w:S7,W:T7,x:pt,X:at,y:Eb,Y:Ib,Z:k7,"%":F7};kt.x=Ge(n,kt),kt.X=Ge(c,kt),kt.c=Ge(t,kt),Bt.x=Ge(n,Bt),Bt.X=Ge(c,Bt),Bt.c=Ge(t,Bt);function Ge(yi,hi){return function(Ei){var Li=[],fn=-1,_n=0,gi=yi.length,mn,ti,Mn;for(Ei instanceof Date||(Ei=new Date(+Ei));++fn<gi;)yi.charCodeAt(fn)===37&&(Li.push(yi.slice(_n,fn)),(ti=Sb[mn=yi.charAt(++fn)])!=null?mn=yi.charAt(++fn):ti=mn==="e"?" ":"0",(Mn=hi[mn])&&(mn=Mn(Ei,ti)),Li.push(mn),_n=fn+1);return Li.push(yi.slice(_n,fn)),Li.join("")}}function ni(yi,hi){return function(Ei){var Li=Qm(1900,void 0,1),fn=it(Li,yi,Ei+="",0),_n,gi;if(fn!=Ei.length)return null;if("Q"in Li)return new Date(Li.Q);if("s"in Li)return new Date(Li.s*1e3+("L"in Li?Li.L:0));if(hi&&!("Z"in Li)&&(Li.Z=0),"p"in Li&&(Li.H=Li.H%12+Li.p*12),Li.m===void 0&&(Li.m="q"in Li?Li.q:0),"V"in Li){if(Li.V<1||Li.V>53)return null;"w"in Li||(Li.w=1),"Z"in Li?(_n=K1(Qm(Li.y,0,1)),gi=_n.getUTCDay(),_n=gi>4||gi===0?F_.ceil(_n):F_(_n),_n=e2.offset(_n,(Li.V-1)*7),Li.y=_n.getUTCFullYear(),Li.m=_n.getUTCMonth(),Li.d=_n.getUTCDate()+(Li.w+6)%7):(_n=$1(Qm(Li.y,0,1)),gi=_n.getDay(),_n=gi>4||gi===0?R_.ceil(_n):R_(_n),_n=Jv.offset(_n,(Li.V-1)*7),Li.y=_n.getFullYear(),Li.m=_n.getMonth(),Li.d=_n.getDate()+(Li.w+6)%7)}else("W"in Li||"U"in Li)&&("w"in Li||(Li.w="u"in Li?Li.u%7:"W"in Li?1:0),gi="Z"in Li?K1(Qm(Li.y,0,1)).getUTCDay():$1(Qm(Li.y,0,1)).getDay(),Li.m=0,Li.d="W"in Li?(Li.w+6)%7+Li.W*7-(gi+5)%7:Li.w+Li.U*7-(gi+6)%7);return"Z"in Li?(Li.H+=Li.Z/100|0,Li.M+=Li.Z%100,K1(Li)):$1(Li)}}function it(yi,hi,Ei,Li){for(var fn=0,_n=hi.length,gi=Ei.length,mn,ti;fn<_n;){if(Li>=gi)return-1;if(mn=hi.charCodeAt(fn++),mn===37){if(mn=hi.charAt(fn++),ti=Rt[mn in Sb?hi.charAt(fn++):mn],!ti||(Li=ti(yi,Ei,Li))<0)return-1}else if(mn!=Ei.charCodeAt(Li++))return-1}return Li}function xt(yi,hi,Ei){var Li=W.exec(hi.slice(Ei));return Li?(yi.p=ce.get(Li[0].toLowerCase()),Ei+Li[0].length):-1}function _t(yi,hi,Ei){var Li=we.exec(hi.slice(Ei));return Li?(yi.w=et.get(Li[0].toLowerCase()),Ei+Li[0].length):-1}function mt(yi,hi,Ei){var Li=oe.exec(hi.slice(Ei));return Li?(yi.w=fe.get(Li[0].toLowerCase()),Ei+Li[0].length):-1}function bt(yi,hi,Ei){var Li=st.exec(hi.slice(Ei));return Li?(yi.m=ut.get(Li[0].toLowerCase()),Ei+Li[0].length):-1}function dt(yi,hi,Ei){var Li=lt.exec(hi.slice(Ei));return Li?(yi.m=Ke.get(Li[0].toLowerCase()),Ei+Li[0].length):-1}function nt(yi,hi,Ei){return it(yi,t,hi,Ei)}function pt(yi,hi,Ei){return it(yi,n,hi,Ei)}function at(yi,hi,Ei){return it(yi,c,hi,Ei)}function Nt(yi){return E[yi.getDay()]}function Ft(yi){return b[yi.getDay()]}function Dt(yi){return U[yi.getMonth()]}function ci(yi){return a[yi.getMonth()]}function bi(yi){return g[+(yi.getHours()>=12)]}function ki(yi){return 1+~~(yi.getMonth()/3)}function Gi(yi){return E[yi.getUTCDay()]}function rn(yi){return b[yi.getUTCDay()]}function $i(yi){return U[yi.getUTCMonth()]}function qi(yi){return a[yi.getUTCMonth()]}function sn(yi){return g[+(yi.getUTCHours()>=12)]}function Ti(yi){return 1+~~(yi.getUTCMonth()/3)}return{format:function(yi){var hi=Ge(yi+="",kt);return hi.toString=function(){return yi},hi},parse:function(yi){var hi=ni(yi+="",!1);return hi.toString=function(){return yi},hi},utcFormat:function(yi){var hi=Ge(yi+="",Bt);return hi.toString=function(){return yi},hi},utcParse:function(yi){var hi=ni(yi+="",!0);return hi.toString=function(){return yi},hi}}}var Sb={"-":"",_:" ",0:"0"},Lu=/^\s*\d+/,x7=/^%/,b7=/[\\^$*+?|[\]().{}]/g;function Ra(e,t,n){var c=e<0?"-":"",g=(c?-e:e)+"",b=g.length;return c+(b<n?new Array(n-b+1).join(t)+g:g)}function w7(e){return e.replace(b7,"\\$&")}function Wm(e){return new RegExp("^(?:"+e.map(w7).join("|")+")","i")}function Xm(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function S7(e,t,n){var c=Lu.exec(t.slice(n,n+1));return c?(e.w=+c[0],n+c[0].length):-1}function I7(e,t,n){var c=Lu.exec(t.slice(n,n+1));return c?(e.u=+c[0],n+c[0].length):-1}function E7(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.U=+c[0],n+c[0].length):-1}function C7(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.V=+c[0],n+c[0].length):-1}function T7(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.W=+c[0],n+c[0].length):-1}function Ib(e,t,n){var c=Lu.exec(t.slice(n,n+4));return c?(e.y=+c[0],n+c[0].length):-1}function Eb(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.y=+c[0]+(+c[0]>68?1900:2e3),n+c[0].length):-1}function k7(e,t,n){var c=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return c?(e.Z=c[1]?0:-(c[2]+(c[3]||"00")),n+c[0].length):-1}function M7(e,t,n){var c=Lu.exec(t.slice(n,n+1));return c?(e.q=c[0]*3-3,n+c[0].length):-1}function P7(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.m=c[0]-1,n+c[0].length):-1}function Cb(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.d=+c[0],n+c[0].length):-1}function D7(e,t,n){var c=Lu.exec(t.slice(n,n+3));return c?(e.m=0,e.d=+c[0],n+c[0].length):-1}function Tb(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.H=+c[0],n+c[0].length):-1}function L7(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.M=+c[0],n+c[0].length):-1}function B7(e,t,n){var c=Lu.exec(t.slice(n,n+2));return c?(e.S=+c[0],n+c[0].length):-1}function z7(e,t,n){var c=Lu.exec(t.slice(n,n+3));return c?(e.L=+c[0],n+c[0].length):-1}function R7(e,t,n){var c=Lu.exec(t.slice(n,n+6));return c?(e.L=Math.floor(c[0]/1e3),n+c[0].length):-1}function F7(e,t,n){var c=x7.exec(t.slice(n,n+1));return c?n+c[0].length:-1}function O7(e,t,n){var c=Lu.exec(t.slice(n));return c?(e.Q=+c[0],n+c[0].length):-1}function N7(e,t,n){var c=Lu.exec(t.slice(n));return c?(e.s=+c[0],n+c[0].length):-1}function kb(e,t){return Ra(e.getDate(),t,2)}function V7(e,t){return Ra(e.getHours(),t,2)}function U7(e,t){return Ra(e.getHours()%12||12,t,2)}function G7(e,t){return Ra(1+Jv.count(sp(e),e),t,3)}function M4(e,t){return Ra(e.getMilliseconds(),t,3)}function q7(e,t){return M4(e,t)+"000"}function H7(e,t){return Ra(e.getMonth()+1,t,2)}function j7(e,t){return Ra(e.getMinutes(),t,2)}function Z7(e,t){return Ra(e.getSeconds(),t,2)}function Q7(e){var t=e.getDay();return t===0?7:t}function W7(e,t){return Ra(T4.count(sp(e)-1,e),t,2)}function P4(e){var t=e.getDay();return t>=4||t===0?ym(e):ym.ceil(e)}function X7(e,t){return e=P4(e),Ra(ym.count(sp(e),e)+(sp(e).getDay()===4),t,2)}function Y7(e){return e.getDay()}function $7(e,t){return Ra(R_.count(sp(e)-1,e),t,2)}function K7(e,t){return Ra(e.getFullYear()%100,t,2)}function J7(e,t){return e=P4(e),Ra(e.getFullYear()%100,t,2)}function ez(e,t){return Ra(e.getFullYear()%1e4,t,4)}function tz(e,t){var n=e.getDay();return e=n>=4||n===0?ym(e):ym.ceil(e),Ra(e.getFullYear()%1e4,t,4)}function iz(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ra(t/60|0,"0",2)+Ra(t%60,"0",2)}function Mb(e,t){return Ra(e.getUTCDate(),t,2)}function nz(e,t){return Ra(e.getUTCHours(),t,2)}function rz(e,t){return Ra(e.getUTCHours()%12||12,t,2)}function sz(e,t){return Ra(1+e2.count(ap(e),e),t,3)}function D4(e,t){return Ra(e.getUTCMilliseconds(),t,3)}function az(e,t){return D4(e,t)+"000"}function oz(e,t){return Ra(e.getUTCMonth()+1,t,2)}function lz(e,t){return Ra(e.getUTCMinutes(),t,2)}function uz(e,t){return Ra(e.getUTCSeconds(),t,2)}function cz(e){var t=e.getUTCDay();return t===0?7:t}function hz(e,t){return Ra(k4.count(ap(e)-1,e),t,2)}function L4(e){var t=e.getUTCDay();return t>=4||t===0?vm(e):vm.ceil(e)}function Az(e,t){return e=L4(e),Ra(vm.count(ap(e),e)+(ap(e).getUTCDay()===4),t,2)}function fz(e){return e.getUTCDay()}function dz(e,t){return Ra(F_.count(ap(e)-1,e),t,2)}function pz(e,t){return Ra(e.getUTCFullYear()%100,t,2)}function mz(e,t){return e=L4(e),Ra(e.getUTCFullYear()%100,t,2)}function gz(e,t){return Ra(e.getUTCFullYear()%1e4,t,4)}function _z(e,t){var n=e.getUTCDay();return e=n>=4||n===0?vm(e):vm.ceil(e),Ra(e.getUTCFullYear()%1e4,t,4)}function yz(){return"+0000"}function Pb(){return"%"}function Db(e){return+e}function Lb(e){return Math.floor(+e/1e3)}var Xp,B4;vz({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function vz(e){return Xp=v7(e),Xp.format,B4=Xp.parse,Xp.utcFormat,Xp.utcParse,Xp}function Yp(e){return function(){return e}}function xz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function z4(e){this._context=e}z4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function bz(e){return new z4(e)}function wz(e){return e[0]}function Sz(e){return e[1]}function uv(e,t){var n=Yp(!0),c=null,g=bz,b=null;e=typeof e=="function"?e:e===void 0?wz:Yp(e),t=typeof t=="function"?t:t===void 0?Sz:Yp(t);function E(a){var U,W=(a=xz(a)).length,ce,oe=!1,fe;for(c==null&&(b=g(fe=w4())),U=0;U<=W;++U)!(U<W&&n(ce=a[U],U,a))===oe&&((oe=!oe)?b.lineStart():b.lineEnd()),oe&&b.point(+e(ce,U,a),+t(ce,U,a));if(fe)return b=null,fe+""||null}return E.x=function(a){return arguments.length?(e=typeof a=="function"?a:Yp(+a),E):e},E.y=function(a){return arguments.length?(t=typeof a=="function"?a:Yp(+a),E):t},E.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Yp(!!a),E):n},E.curve=function(a){return arguments.length?(g=a,c!=null&&(b=g(c)),E):g},E.context=function(a){return arguments.length?(a==null?c=b=null:b=g(c=a),E):c},E}function Bb(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function R4(e){this._context=e}R4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Bb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Bb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zb(e){return new R4(e)}function F4(e,t){this._context=e,this._t=t}F4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Iz(e){return new F4(e,0)}const Xg=e=>()=>e;function Ez(e,{sourceEvent:t,target:n,transform:c,dispatch:g}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:c,enumerable:!0,configurable:!0},_:{value:g}})}function Jf(e,t,n){this.k=e,this.x=t,this.y=n}Jf.prototype={constructor:Jf,scale:function(e){return e===1?this:new Jf(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Jf(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var O4=new Jf(1,0,0);Jf.prototype;function J1(e){e.stopImmediatePropagation()}function Ym(e){e.preventDefault(),e.stopImmediatePropagation()}function Cz(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Tz(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Rb(){return this.__zoom||O4}function kz(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Mz(){return navigator.maxTouchPoints||"ontouchstart"in this}function Pz(e,t,n){var c=e.invertX(t[0][0])-n[0][0],g=e.invertX(t[1][0])-n[1][0],b=e.invertY(t[0][1])-n[0][1],E=e.invertY(t[1][1])-n[1][1];return e.translate(g>c?(c+g)/2:Math.min(0,c)||Math.max(0,g),E>b?(b+E)/2:Math.min(0,b)||Math.max(0,E))}function Dz(){var e=Cz,t=Tz,n=Pz,c=kz,g=Mz,b=[0,1/0],E=[[-1/0,-1/0],[1/0,1/0]],a=250,U=KD,W=K_("start","zoom","end"),ce,oe,fe,we=500,et=150,lt=0,Ke=10;function st(nt){nt.property("__zoom",Rb).on("wheel.zoom",it).on("mousedown.zoom",xt).on("dblclick.zoom",_t).filter(g).on("touchstart.zoom",mt).on("touchmove.zoom",bt).on("touchend.zoom touchcancel.zoom",dt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}st.transform=function(nt,pt,at,Nt){var Ft=nt.selection?nt.selection():nt;Ft.property("__zoom",Rb),nt!==Ft?Rt(nt,pt,at,Nt):Ft.interrupt().each(function(){Ge(this,arguments).event(Nt).start().zoom(null,typeof pt=="function"?pt.apply(this,arguments):pt).end()})},st.scaleBy=function(nt,pt,at,Nt){st.scaleTo(nt,function(){var Ft=this.__zoom.k,Dt=typeof pt=="function"?pt.apply(this,arguments):pt;return Ft*Dt},at,Nt)},st.scaleTo=function(nt,pt,at,Nt){st.transform(nt,function(){var Ft=t.apply(this,arguments),Dt=this.__zoom,ci=at==null?Bt(Ft):typeof at=="function"?at.apply(this,arguments):at,bi=Dt.invert(ci),ki=typeof pt=="function"?pt.apply(this,arguments):pt;return n(kt(ut(Dt,ki),ci,bi),Ft,E)},at,Nt)},st.translateBy=function(nt,pt,at,Nt){st.transform(nt,function(){return n(this.__zoom.translate(typeof pt=="function"?pt.apply(this,arguments):pt,typeof at=="function"?at.apply(this,arguments):at),t.apply(this,arguments),E)},null,Nt)},st.translateTo=function(nt,pt,at,Nt,Ft){st.transform(nt,function(){var Dt=t.apply(this,arguments),ci=this.__zoom,bi=Nt==null?Bt(Dt):typeof Nt=="function"?Nt.apply(this,arguments):Nt;return n(O4.translate(bi[0],bi[1]).scale(ci.k).translate(typeof pt=="function"?-pt.apply(this,arguments):-pt,typeof at=="function"?-at.apply(this,arguments):-at),Dt,E)},Nt,Ft)};function ut(nt,pt){return pt=Math.max(b[0],Math.min(b[1],pt)),pt===nt.k?nt:new Jf(pt,nt.x,nt.y)}function kt(nt,pt,at){var Nt=pt[0]-at[0]*nt.k,Ft=pt[1]-at[1]*nt.k;return Nt===nt.x&&Ft===nt.y?nt:new Jf(nt.k,Nt,Ft)}function Bt(nt){return[(+nt[0][0]+ +nt[1][0])/2,(+nt[0][1]+ +nt[1][1])/2]}function Rt(nt,pt,at,Nt){nt.on("start.zoom",function(){Ge(this,arguments).event(Nt).start()}).on("interrupt.zoom end.zoom",function(){Ge(this,arguments).event(Nt).end()}).tween("zoom",function(){var Ft=this,Dt=arguments,ci=Ge(Ft,Dt).event(Nt),bi=t.apply(Ft,Dt),ki=at==null?Bt(bi):typeof at=="function"?at.apply(Ft,Dt):at,Gi=Math.max(bi[1][0]-bi[0][0],bi[1][1]-bi[0][1]),rn=Ft.__zoom,$i=typeof pt=="function"?pt.apply(Ft,Dt):pt,qi=U(rn.invert(ki).concat(Gi/rn.k),$i.invert(ki).concat(Gi/$i.k));return function(sn){if(sn===1)sn=$i;else{var Ti=qi(sn),yi=Gi/Ti[2];sn=new Jf(yi,ki[0]-Ti[0]*yi,ki[1]-Ti[1]*yi)}ci.zoom(null,sn)}})}function Ge(nt,pt,at){return!at&&nt.__zooming||new ni(nt,pt)}function ni(nt,pt){this.that=nt,this.args=pt,this.active=0,this.sourceEvent=null,this.extent=t.apply(nt,pt),this.taps=0}ni.prototype={event:function(nt){return nt&&(this.sourceEvent=nt),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(nt,pt){return this.mouse&&nt!=="mouse"&&(this.mouse[1]=pt.invert(this.mouse[0])),this.touch0&&nt!=="touch"&&(this.touch0[1]=pt.invert(this.touch0[0])),this.touch1&&nt!=="touch"&&(this.touch1[1]=pt.invert(this.touch1[0])),this.that.__zoom=pt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(nt){var pt=Al(this.that).datum();W.call(nt,this.that,new Ez(nt,{sourceEvent:this.sourceEvent,target:st,type:nt,transform:this.that.__zoom,dispatch:W}),pt)}};function it(nt,...pt){if(!e.apply(this,arguments))return;var at=Ge(this,pt).event(nt),Nt=this.__zoom,Ft=Math.max(b[0],Math.min(b[1],Nt.k*Math.pow(2,c.apply(this,arguments)))),Dt=Yf(nt);if(at.wheel)(at.mouse[0][0]!==Dt[0]||at.mouse[0][1]!==Dt[1])&&(at.mouse[1]=Nt.invert(at.mouse[0]=Dt)),clearTimeout(at.wheel);else{if(Nt.k===Ft)return;at.mouse=[Dt,Nt.invert(Dt)],cm(this),at.start()}Ym(nt),at.wheel=setTimeout(ci,et),at.zoom("mouse",n(kt(ut(Nt,Ft),at.mouse[0],at.mouse[1]),at.extent,E));function ci(){at.wheel=null,at.end()}}function xt(nt,...pt){if(fe||!e.apply(this,arguments))return;var at=Ge(this,pt,!0).event(nt),Nt=Al(nt.view).on("mousemove.zoom",ki,!0).on("mouseup.zoom",Gi,!0),Ft=Yf(nt,Dt),Dt=nt.currentTarget,ci=nt.clientX,bi=nt.clientY;l4(nt.view),J1(nt),at.mouse=[Ft,this.__zoom.invert(Ft)],cm(this),at.start();function ki(rn){if(Ym(rn),!at.moved){var $i=rn.clientX-ci,qi=rn.clientY-bi;at.moved=$i*$i+qi*qi>lt}at.event(rn).zoom("mouse",n(kt(at.that.__zoom,at.mouse[0]=Yf(rn,Dt),at.mouse[1]),at.extent,E))}function Gi(rn){Nt.on("mousemove.zoom mouseup.zoom",null),u4(rn.view,at.moved),Ym(rn),at.event(rn).end()}}function _t(nt,...pt){if(e.apply(this,arguments)){var at=this.__zoom,Nt=Yf(nt.changedTouches?nt.changedTouches[0]:nt,this),Ft=at.invert(Nt),Dt=at.k*(nt.shiftKey?.5:2),ci=n(kt(ut(at,Dt),Nt,Ft),t.apply(this,pt),E);Ym(nt),a>0?Al(this).transition().duration(a).call(Rt,ci,Nt,nt):Al(this).call(st.transform,ci,Nt,nt)}}function mt(nt,...pt){if(e.apply(this,arguments)){var at=nt.touches,Nt=at.length,Ft=Ge(this,pt,nt.changedTouches.length===Nt).event(nt),Dt,ci,bi,ki;for(J1(nt),ci=0;ci<Nt;++ci)bi=at[ci],ki=Yf(bi,this),ki=[ki,this.__zoom.invert(ki),bi.identifier],Ft.touch0?!Ft.touch1&&Ft.touch0[2]!==ki[2]&&(Ft.touch1=ki,Ft.taps=0):(Ft.touch0=ki,Dt=!0,Ft.taps=1+!!ce);ce&&(ce=clearTimeout(ce)),Dt&&(Ft.taps<2&&(oe=ki[0],ce=setTimeout(function(){ce=null},we)),cm(this),Ft.start())}}function bt(nt,...pt){if(this.__zooming){var at=Ge(this,pt).event(nt),Nt=nt.changedTouches,Ft=Nt.length,Dt,ci,bi,ki;for(Ym(nt),Dt=0;Dt<Ft;++Dt)ci=Nt[Dt],bi=Yf(ci,this),at.touch0&&at.touch0[2]===ci.identifier?at.touch0[0]=bi:at.touch1&&at.touch1[2]===ci.identifier&&(at.touch1[0]=bi);if(ci=at.that.__zoom,at.touch1){var Gi=at.touch0[0],rn=at.touch0[1],$i=at.touch1[0],qi=at.touch1[1],sn=(sn=$i[0]-Gi[0])*sn+(sn=$i[1]-Gi[1])*sn,Ti=(Ti=qi[0]-rn[0])*Ti+(Ti=qi[1]-rn[1])*Ti;ci=ut(ci,Math.sqrt(sn/Ti)),bi=[(Gi[0]+$i[0])/2,(Gi[1]+$i[1])/2],ki=[(rn[0]+qi[0])/2,(rn[1]+qi[1])/2]}else if(at.touch0)bi=at.touch0[0],ki=at.touch0[1];else return;at.zoom("touch",n(kt(ci,bi,ki),at.extent,E))}}function dt(nt,...pt){if(this.__zooming){var at=Ge(this,pt).event(nt),Nt=nt.changedTouches,Ft=Nt.length,Dt,ci;for(J1(nt),fe&&clearTimeout(fe),fe=setTimeout(function(){fe=null},we),Dt=0;Dt<Ft;++Dt)ci=Nt[Dt],at.touch0&&at.touch0[2]===ci.identifier?delete at.touch0:at.touch1&&at.touch1[2]===ci.identifier&&delete at.touch1;if(at.touch1&&!at.touch0&&(at.touch0=at.touch1,delete at.touch1),at.touch0)at.touch0[1]=this.__zoom.invert(at.touch0[0]);else if(at.end(),at.taps===2&&(ci=Yf(ci,this),Math.hypot(oe[0]-ci[0],oe[1]-ci[1])<Ke)){var bi=Al(this).on("dblclick.zoom");bi&&bi.apply(this,arguments)}}}return st.wheelDelta=function(nt){return arguments.length?(c=typeof nt=="function"?nt:Xg(+nt),st):c},st.filter=function(nt){return arguments.length?(e=typeof nt=="function"?nt:Xg(!!nt),st):e},st.touchable=function(nt){return arguments.length?(g=typeof nt=="function"?nt:Xg(!!nt),st):g},st.extent=function(nt){return arguments.length?(t=typeof nt=="function"?nt:Xg([[+nt[0][0],+nt[0][1]],[+nt[1][0],+nt[1][1]]]),st):t},st.scaleExtent=function(nt){return arguments.length?(b[0]=+nt[0],b[1]=+nt[1],st):[b[0],b[1]]},st.translateExtent=function(nt){return arguments.length?(E[0][0]=+nt[0][0],E[1][0]=+nt[1][0],E[0][1]=+nt[0][1],E[1][1]=+nt[1][1],st):[[E[0][0],E[0][1]],[E[1][0],E[1][1]]]},st.constrain=function(nt){return arguments.length?(n=nt,st):n},st.duration=function(nt){return arguments.length?(a=+nt,st):a},st.interpolate=function(nt){return arguments.length?(U=nt,st):U},st.on=function(){var nt=W.on.apply(W,arguments);return nt===W?st:nt},st.clickDistance=function(nt){return arguments.length?(lt=(nt=+nt)*nt,st):Math.sqrt(lt)},st.tapDistance=function(nt){return arguments.length?(Ke=+nt,st):Ke},st}var N4="1.13.6",Fb=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},n1=Array.prototype,t2=Object.prototype,Ob=typeof Symbol<"u"?Symbol.prototype:null,Lz=n1.push,Pg=n1.slice,yg=t2.toString,Bz=t2.hasOwnProperty,V4=typeof ArrayBuffer<"u",zz=typeof DataView<"u",Rz=Array.isArray,Nb=Object.keys,Vb=Object.create,Ub=V4&&ArrayBuffer.isView,Fz=isNaN,Oz=isFinite,U4=!{toString:null}.propertyIsEnumerable("toString"),Gb=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Nz=Math.pow(2,53)-1;function qc(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),c=Array(n),g=0;g<n;g++)c[g]=arguments[g+t];switch(t){case 0:return e.call(this,c);case 1:return e.call(this,arguments[0],c);case 2:return e.call(this,arguments[0],arguments[1],c)}var b=Array(t+1);for(g=0;g<t;g++)b[g]=arguments[g];return b[t]=c,e.apply(this,b)}}function Ap(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function Vz(e){return e===null}function op(e){return e===void 0}function G4(e){return e===!0||e===!1||yg.call(e)==="[object Boolean]"}function Uz(e){return!!(e&&e.nodeType===1)}function rc(e){var t="[object "+e+"]";return function(n){return yg.call(n)===t}}const r1=rc("String"),q4=rc("Number"),Gz=rc("Date"),qz=rc("RegExp"),Hz=rc("Error"),H4=rc("Symbol"),j4=rc("ArrayBuffer");var Z4=rc("Function"),jz=Fb.document&&Fb.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof jz!="function"&&(Z4=function(e){return typeof e=="function"||!1});const ic=Z4,Q4=rc("Object");var W4=zz&&Q4(new DataView(new ArrayBuffer(8))),i2=typeof Map<"u"&&Q4(new Map),Zz=rc("DataView");function Qz(e){return e!=null&&ic(e.getInt8)&&j4(e.buffer)}const O_=W4?Qz:Zz,fp=Rz||rc("Array");function q0(e,t){return e!=null&&Bz.call(e,t)}var cv=rc("Arguments");(function(){cv(arguments)||(cv=function(e){return q0(e,"callee")})})();const n2=cv;function Wz(e){return!H4(e)&&Oz(e)&&!isNaN(parseFloat(e))}function X4(e){return q4(e)&&Fz(e)}function Y4(e){return function(){return e}}function $4(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=Nz}}function K4(e){return function(t){return t==null?void 0:t[e]}}const N_=K4("byteLength"),Xz=$4(N_);var Yz=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function $z(e){return Ub?Ub(e)&&!O_(e):Xz(e)&&Yz.test(yg.call(e))}const J4=V4?$z:Y4(!1),Hc=K4("length");function Kz(e){for(var t={},n=e.length,c=0;c<n;++c)t[e[c]]=!0;return{contains:function(g){return t[g]===!0},push:function(g){return t[g]=!0,e.push(g)}}}function eS(e,t){t=Kz(t);var n=Gb.length,c=e.constructor,g=ic(c)&&c.prototype||t2,b="constructor";for(q0(e,b)&&!t.contains(b)&&t.push(b);n--;)b=Gb[n],b in e&&e[b]!==g[b]&&!t.contains(b)&&t.push(b)}function du(e){if(!Ap(e))return[];if(Nb)return Nb(e);var t=[];for(var n in e)q0(e,n)&&t.push(n);return U4&&eS(e,t),t}function Jz(e){if(e==null)return!0;var t=Hc(e);return typeof t=="number"&&(fp(e)||r1(e)||n2(e))?t===0:Hc(du(e))===0}function tS(e,t){var n=du(t),c=n.length;if(e==null)return!c;for(var g=Object(e),b=0;b<c;b++){var E=n[b];if(t[E]!==g[E]||!(E in g))return!1}return!0}function oo(e){if(e instanceof oo)return e;if(!(this instanceof oo))return new oo(e);this._wrapped=e}oo.VERSION=N4;oo.prototype.value=function(){return this._wrapped};oo.prototype.valueOf=oo.prototype.toJSON=oo.prototype.value;oo.prototype.toString=function(){return String(this._wrapped)};function qb(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,N_(e))}var Hb="[object DataView]";function hv(e,t,n,c){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var g=typeof e;return g!=="function"&&g!=="object"&&typeof t!="object"?!1:iS(e,t,n,c)}function iS(e,t,n,c){e instanceof oo&&(e=e._wrapped),t instanceof oo&&(t=t._wrapped);var g=yg.call(e);if(g!==yg.call(t))return!1;if(W4&&g=="[object Object]"&&O_(e)){if(!O_(t))return!1;g=Hb}switch(g){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return Ob.valueOf.call(e)===Ob.valueOf.call(t);case"[object ArrayBuffer]":case Hb:return iS(qb(e),qb(t),n,c)}var b=g==="[object Array]";if(!b&&J4(e)){var E=N_(e);if(E!==N_(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;b=!0}if(!b){if(typeof e!="object"||typeof t!="object")return!1;var a=e.constructor,U=t.constructor;if(a!==U&&!(ic(a)&&a instanceof a&&ic(U)&&U instanceof U)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],c=c||[];for(var W=n.length;W--;)if(n[W]===e)return c[W]===t;if(n.push(e),c.push(t),b){if(W=e.length,W!==t.length)return!1;for(;W--;)if(!hv(e[W],t[W],n,c))return!1}else{var ce=du(e),oe;if(W=ce.length,du(t).length!==W)return!1;for(;W--;)if(oe=ce[W],!(q0(t,oe)&&hv(e[oe],t[oe],n,c)))return!1}return n.pop(),c.pop(),!0}function e9(e,t){return hv(e,t)}function Dg(e){if(!Ap(e))return[];var t=[];for(var n in e)t.push(n);return U4&&eS(e,t),t}function r2(e){var t=Hc(e);return function(n){if(n==null)return!1;var c=Dg(n);if(Hc(c))return!1;for(var g=0;g<t;g++)if(!ic(n[e[g]]))return!1;return e!==sS||!ic(n[s2])}}var s2="forEach",nS="has",a2=["clear","delete"],rS=["get",nS,"set"],t9=a2.concat(s2,rS),sS=a2.concat(rS),i9=["add"].concat(a2,s2,nS);const n9=i2?r2(t9):rc("Map"),r9=i2?r2(sS):rc("WeakMap"),s9=i2?r2(i9):rc("Set"),a9=rc("WeakSet");function dp(e){for(var t=du(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=e[t[g]];return c}function o9(e){for(var t=du(e),n=t.length,c=Array(n),g=0;g<n;g++)c[g]=[t[g],e[t[g]]];return c}function aS(e){for(var t={},n=du(e),c=0,g=n.length;c<g;c++)t[e[n[c]]]=n[c];return t}function Av(e){var t=[];for(var n in e)ic(e[n])&&t.push(n);return t.sort()}function o2(e,t){return function(n){var c=arguments.length;if(t&&(n=Object(n)),c<2||n==null)return n;for(var g=1;g<c;g++)for(var b=arguments[g],E=e(b),a=E.length,U=0;U<a;U++){var W=E[U];(!t||n[W]===void 0)&&(n[W]=b[W])}return n}}const AA=o2(Dg),vg=o2(du),l2=o2(Dg,!0);function l9(){return function(){}}function oS(e){if(!Ap(e))return{};if(Vb)return Vb(e);var t=l9();t.prototype=e;var n=new t;return t.prototype=null,n}function u9(e,t){var n=oS(e);return t&&vg(n,t),n}function lS(e){return Ap(e)?fp(e)?e.slice():AA({},e):e}function c9(e,t){return t(e),e}function uS(e){return fp(e)?e:[e]}oo.toPath=uS;function Lg(e){return oo.toPath(e)}function u2(e,t){for(var n=t.length,c=0;c<n;c++){if(e==null)return;e=e[t[c]]}return n?e:void 0}function cS(e,t,n){var c=u2(e,Lg(t));return op(c)?n:c}function s1(e,t){t=Lg(t);for(var n=t.length,c=0;c<n;c++){var g=t[c];if(!q0(e,g))return!1;e=e[g]}return!!n}function c2(e){return e}function xg(e){return e=vg({},e),function(t){return tS(t,e)}}function h2(e){return e=Lg(e),function(t){return u2(t,e)}}function Bg(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(c){return e.call(t,c)};case 3:return function(c,g,b){return e.call(t,c,g,b)};case 4:return function(c,g,b,E){return e.call(t,c,g,b,E)}}return function(){return e.apply(t,arguments)}}function hS(e,t,n){return e==null?c2:ic(e)?Bg(e,t,n):Ap(e)&&!fp(e)?xg(e):h2(e)}function A2(e,t){return hS(e,t,1/0)}oo.iteratee=A2;function Wc(e,t,n){return oo.iteratee!==A2?oo.iteratee(e,t):hS(e,t,n)}function AS(e,t,n){t=Wc(t,n);for(var c=du(e),g=c.length,b={},E=0;E<g;E++){var a=c[E];b[a]=t(e[a],a,e)}return b}function fS(){}function h9(e){return e==null?fS:function(t){return cS(e,t)}}function A9(e,t,n){var c=Array(Math.max(0,e));t=Bg(t,n,1);for(var g=0;g<e;g++)c[g]=t(g);return c}function fv(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const bg=Date.now||function(){return new Date().getTime()};function dS(e){var t=function(b){return e[b]},n="(?:"+du(e).join("|")+")",c=RegExp(n),g=RegExp(n,"g");return function(b){return b=b==null?"":""+b,c.test(b)?b.replace(g,t):b}}const pS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},f9=dS(pS),d9=aS(pS),p9=dS(d9),m9=oo.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ey=/(.)^/,g9={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},_9=/\\|'|\r|\n|\u2028|\u2029/g;function y9(e){return"\\"+g9[e]}var v9=/^\s*(\w|\$)+\s*$/;function x9(e,t,n){!t&&n&&(t=n),t=l2({},t,oo.templateSettings);var c=RegExp([(t.escape||ey).source,(t.interpolate||ey).source,(t.evaluate||ey).source].join("|")+"|$","g"),g=0,b="__p+='";e.replace(c,function(W,ce,oe,fe,we){return b+=e.slice(g,we).replace(_9,y9),g=we+W.length,ce?b+=`'+
((__t=(`+ce+`))==null?'':_.escape(__t))+
'`:oe?b+=`'+
((__t=(`+oe+`))==null?'':__t)+
'`:fe&&(b+=`';
`+fe+`
__p+='`),W}),b+=`';
`;var E=t.variable;if(E){if(!v9.test(E))throw new Error("variable is not a bare identifier: "+E)}else b=`with(obj||{}){
`+b+`}
`,E="obj";b=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+b+`return __p;
`;var a;try{a=new Function(E,"_",b)}catch(W){throw W.source=b,W}var U=function(W){return a.call(this,W,oo)};return U.source="function("+E+`){
`+b+"}",U}function b9(e,t,n){t=Lg(t);var c=t.length;if(!c)return ic(n)?n.call(e):n;for(var g=0;g<c;g++){var b=e==null?void 0:e[t[g]];b===void 0&&(b=n,g=c),e=ic(b)?b.call(e):b}return e}var w9=0;function S9(e){var t=++w9+"";return e?e+t:t}function I9(e){var t=oo(e);return t._chain=!0,t}function mS(e,t,n,c,g){if(!(c instanceof t))return e.apply(n,g);var b=oS(e.prototype),E=e.apply(b,g);return Ap(E)?E:b}var tf=qc(function(e,t){var n=tf.placeholder,c=function(){for(var g=0,b=t.length,E=Array(b),a=0;a<b;a++)E[a]=t[a]===n?arguments[g++]:t[a];for(;g<arguments.length;)E.push(arguments[g++]);return mS(e,c,this,this,E)};return c});tf.placeholder=oo;const gS=qc(function(e,t,n){if(!ic(e))throw new TypeError("Bind must be called on a function");var c=qc(function(g){return mS(e,c,t,this,n.concat(g))});return c}),gh=$4(Hc);function pp(e,t,n,c){if(c=c||[],!t&&t!==0)t=1/0;else if(t<=0)return c.concat(e);for(var g=c.length,b=0,E=Hc(e);b<E;b++){var a=e[b];if(gh(a)&&(fp(a)||n2(a)))if(t>1)pp(a,t-1,n,c),g=c.length;else for(var U=0,W=a.length;U<W;)c[g++]=a[U++];else n||(c[g++]=a)}return c}const E9=qc(function(e,t){t=pp(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var c=t[n];e[c]=gS(e[c],e)}return e});function C9(e,t){var n=function(c){var g=n.cache,b=""+(t?t.apply(this,arguments):c);return q0(g,b)||(g[b]=e.apply(this,arguments)),g[b]};return n.cache={},n}const _S=qc(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),T9=tf(_S,oo,1);function k9(e,t,n){var c,g,b,E,a=0;n||(n={});var U=function(){a=n.leading===!1?0:bg(),c=null,E=e.apply(g,b),c||(g=b=null)},W=function(){var ce=bg();!a&&n.leading===!1&&(a=ce);var oe=t-(ce-a);return g=this,b=arguments,oe<=0||oe>t?(c&&(clearTimeout(c),c=null),a=ce,E=e.apply(g,b),c||(g=b=null)):!c&&n.trailing!==!1&&(c=setTimeout(U,oe)),E};return W.cancel=function(){clearTimeout(c),a=0,c=g=b=null},W}function M9(e,t,n){var c,g,b,E,a,U=function(){var ce=bg()-g;t>ce?c=setTimeout(U,t-ce):(c=null,n||(E=e.apply(a,b)),c||(b=a=null))},W=qc(function(ce){return a=this,b=ce,g=bg(),c||(c=setTimeout(U,t),n&&(E=e.apply(a,b))),E});return W.cancel=function(){clearTimeout(c),c=b=a=null},W}function P9(e,t){return tf(t,e)}function f2(e){return function(){return!e.apply(this,arguments)}}function D9(){var e=arguments,t=e.length-1;return function(){for(var n=t,c=e[t].apply(this,arguments);n--;)c=e[n].call(this,c);return c}}function L9(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function yS(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const B9=tf(yS,2);function vS(e,t,n){t=Wc(t,n);for(var c=du(e),g,b=0,E=c.length;b<E;b++)if(g=c[b],t(e[g],g,e))return g}function xS(e){return function(t,n,c){n=Wc(n,c);for(var g=Hc(t),b=e>0?0:g-1;b>=0&&b<g;b+=e)if(n(t[b],b,t))return b;return-1}}const d2=xS(1),bS=xS(-1);function wS(e,t,n,c){n=Wc(n,c,1);for(var g=n(t),b=0,E=Hc(e);b<E;){var a=Math.floor((b+E)/2);n(e[a])<g?b=a+1:E=a}return b}function SS(e,t,n){return function(c,g,b){var E=0,a=Hc(c);if(typeof b=="number")e>0?E=b>=0?b:Math.max(b+a,E):a=b>=0?Math.min(b+1,a):b+a+1;else if(n&&b&&a)return b=n(c,g),c[b]===g?b:-1;if(g!==g)return b=t(Pg.call(c,E,a),X4),b>=0?b+E:-1;for(b=e>0?E:a-1;b>=0&&b<a;b+=e)if(c[b]===g)return b;return-1}}const IS=SS(1,d2,wS),z9=SS(-1,bS);function dv(e,t,n){var c=gh(e)?d2:vS,g=c(e,t,n);if(g!==void 0&&g!==-1)return e[g]}function R9(e,t){return dv(e,xg(t))}function jc(e,t,n){t=Bg(t,n);var c,g;if(gh(e))for(c=0,g=e.length;c<g;c++)t(e[c],c,e);else{var b=du(e);for(c=0,g=b.length;c<g;c++)t(e[b[c]],b[c],e)}return e}function mc(e,t,n){t=Wc(t,n);for(var c=!gh(e)&&du(e),g=(c||e).length,b=Array(g),E=0;E<g;E++){var a=c?c[E]:E;b[E]=t(e[a],a,e)}return b}function ES(e){var t=function(n,c,g,b){var E=!gh(n)&&du(n),a=(E||n).length,U=e>0?0:a-1;for(b||(g=n[E?E[U]:U],U+=e);U>=0&&U<a;U+=e){var W=E?E[U]:U;g=c(g,n[W],W,n)}return g};return function(n,c,g,b){var E=arguments.length>=3;return t(n,Bg(c,b,4),g,E)}}const ty=ES(1),jb=ES(-1);function dh(e,t,n){var c=[];return t=Wc(t,n),jc(e,function(g,b,E){t(g,b,E)&&c.push(g)}),c}function CS(e,t,n){return dh(e,f2(Wc(t)),n)}function pv(e,t,n){t=Wc(t,n);for(var c=!gh(e)&&du(e),g=(c||e).length,b=0;b<g;b++){var E=c?c[b]:b;if(!t(e[E],E,e))return!1}return!0}function V_(e,t,n){t=Wc(t,n);for(var c=!gh(e)&&du(e),g=(c||e).length,b=0;b<g;b++){var E=c?c[b]:b;if(t(e[E],E,e))return!0}return!1}function KA(e,t,n,c){return gh(e)||(e=dp(e)),(typeof n!="number"||c)&&(n=0),IS(e,t,n)>=0}const F9=qc(function(e,t,n){var c,g;return ic(t)?g=t:(t=Lg(t),c=t.slice(0,-1),t=t[t.length-1]),mc(e,function(b){var E=g;if(!E){if(c&&c.length&&(b=u2(b,c)),b==null)return;E=b[t]}return E==null?E:E.apply(b,n)})});function a1(e,t){return mc(e,h2(t))}function O9(e,t){return dh(e,xg(t))}function p2(e,t,n){var c=-1/0,g=-1/0,b,E;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=gh(e)?e:dp(e);for(var a=0,U=e.length;a<U;a++)b=e[a],b!=null&&b>c&&(c=b)}else t=Wc(t,n),jc(e,function(W,ce,oe){E=t(W,ce,oe),(E>g||E===-1/0&&c===-1/0)&&(c=W,g=E)});return c}function TS(e,t,n){var c=1/0,g=1/0,b,E;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=gh(e)?e:dp(e);for(var a=0,U=e.length;a<U;a++)b=e[a],b!=null&&b<c&&(c=b)}else t=Wc(t,n),jc(e,function(W,ce,oe){E=t(W,ce,oe),(E<g||E===1/0&&c===1/0)&&(c=W,g=E)});return c}var N9=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function kS(e){return e?fp(e)?Pg.call(e):r1(e)?e.match(N9):gh(e)?mc(e,c2):dp(e):[]}function MS(e,t,n){if(t==null||n)return gh(e)||(e=dp(e)),e[fv(e.length-1)];var c=kS(e),g=Hc(c);t=Math.max(Math.min(t,g),0);for(var b=g-1,E=0;E<t;E++){var a=fv(E,b),U=c[E];c[E]=c[a],c[a]=U}return c.slice(0,t)}function V9(e){return MS(e,1/0)}function PS(e,t,n){var c=0;return t=Wc(t,n),a1(mc(e,function(g,b,E){return{value:g,index:c++,criteria:t(g,b,E)}}).sort(function(g,b){var E=g.criteria,a=b.criteria;if(E!==a){if(E>a||E===void 0)return 1;if(E<a||a===void 0)return-1}return g.index-b.index}),"value")}function o1(e,t){return function(n,c,g){var b=t?[[],[]]:{};return c=Wc(c,g),jc(n,function(E,a){var U=c(E,a,n);e(b,E,U)}),b}}const U9=o1(function(e,t,n){q0(e,n)?e[n].push(t):e[n]=[t]}),G9=o1(function(e,t,n){e[n]=t}),q9=o1(function(e,t,n){q0(e,n)?e[n]++:e[n]=1}),H9=o1(function(e,t,n){e[n?0:1].push(t)},!0);function j9(e){return e==null?0:gh(e)?e.length:du(e).length}function Z9(e,t,n){return t in n}const m2=qc(function(e,t){var n={},c=t[0];if(e==null)return n;ic(c)?(t.length>1&&(c=Bg(c,t[1])),t=Dg(e)):(c=Z9,t=pp(t,!1,!1),e=Object(e));for(var g=0,b=t.length;g<b;g++){var E=t[g],a=e[E];c(a,E,e)&&(n[E]=a)}return n}),Q9=qc(function(e,t){var n=t[0],c;return ic(n)?(n=f2(n),t.length>1&&(c=t[1])):(t=mc(pp(t,!1,!1),String),n=function(g,b){return!KA(t,b)}),m2(e,n,c)});function DS(e,t,n){return Pg.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function iy(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:DS(e,e.length-t)}function Kd(e,t,n){return Pg.call(e,t==null||n?1:t)}function W9(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:Kd(e,Math.max(0,e.length-t))}function LS(e){return dh(e,Boolean)}function X9(e,t){return pp(e,t,!1)}const BS=qc(function(e,t){return t=pp(t,!0,!0),dh(e,function(n){return!KA(t,n)})}),Y9=qc(function(e,t){return BS(e,t)});function mv(e,t,n,c){G4(t)||(c=n,n=t,t=!1),n!=null&&(n=Wc(n,c));for(var g=[],b=[],E=0,a=Hc(e);E<a;E++){var U=e[E],W=n?n(U,E,e):U;t&&!n?((!E||b!==W)&&g.push(U),b=W):n?KA(b,W)||(b.push(W),g.push(U)):KA(g,U)||g.push(U)}return g}const zS=qc(function(e){return mv(pp(e,!0,!0))});function RS(e){for(var t=[],n=arguments.length,c=0,g=Hc(e);c<g;c++){var b=e[c];if(!KA(t,b)){var E;for(E=1;E<n&&KA(arguments[E],b);E++);E===n&&t.push(b)}}return t}function gv(e){for(var t=e&&p2(e,Hc).length||0,n=Array(t),c=0;c<t;c++)n[c]=a1(e,c);return n}const $9=qc(gv);function o_(e,t){for(var n={},c=0,g=Hc(e);c<g;c++)t?n[e[c]]=t[c]:n[e[c][0]]=e[c][1];return n}function K9(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var c=Math.max(Math.ceil((t-e)/n),0),g=Array(c),b=0;b<c;b++,e+=n)g[b]=e;return g}function J9(e,t){if(t==null||t<1)return[];for(var n=[],c=0,g=e.length;c<g;)n.push(Pg.call(e,c,c+=t));return n}function g2(e,t){return e._chain?oo(t).chain():t}function FS(e){return jc(Av(e),function(t){var n=oo[t]=e[t];oo.prototype[t]=function(){var c=[this._wrapped];return Lz.apply(c,arguments),g2(this,n.apply(oo,c))}}),oo}jc(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n1[e];oo.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),g2(this,n)}});jc(["concat","join","slice"],function(e){var t=n1[e];oo.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),g2(this,n)}});const eR=Object.freeze(Object.defineProperty({__proto__:null,VERSION:N4,after:L9,all:pv,allKeys:Dg,any:V_,assign:vg,before:yS,bind:gS,bindAll:E9,chain:I9,chunk:J9,clone:lS,collect:mc,compact:LS,compose:D9,constant:Y4,contains:KA,countBy:q9,create:u9,debounce:M9,default:oo,defaults:l2,defer:T9,delay:_S,detect:dv,difference:BS,drop:Kd,each:jc,escape:f9,every:pv,extend:AA,extendOwn:vg,filter:dh,find:dv,findIndex:d2,findKey:vS,findLastIndex:bS,findWhere:R9,first:iy,flatten:X9,foldl:ty,foldr:jb,forEach:jc,functions:Av,get:cS,groupBy:U9,has:s1,head:iy,identity:c2,include:KA,includes:KA,indexBy:G9,indexOf:IS,initial:DS,inject:ty,intersection:RS,invert:aS,invoke:F9,isArguments:n2,isArray:fp,isArrayBuffer:j4,isBoolean:G4,isDataView:O_,isDate:Gz,isElement:Uz,isEmpty:Jz,isEqual:e9,isError:Hz,isFinite:Wz,isFunction:ic,isMap:n9,isMatch:tS,isNaN:X4,isNull:Vz,isNumber:q4,isObject:Ap,isRegExp:qz,isSet:s9,isString:r1,isSymbol:H4,isTypedArray:J4,isUndefined:op,isWeakMap:r9,isWeakSet:a9,iteratee:A2,keys:du,last:W9,lastIndexOf:z9,map:mc,mapObject:AS,matcher:xg,matches:xg,max:p2,memoize:C9,methods:Av,min:TS,mixin:FS,negate:f2,noop:fS,now:bg,object:o_,omit:Q9,once:B9,pairs:o9,partial:tf,partition:H9,pick:m2,pluck:a1,property:h2,propertyOf:h9,random:fv,range:K9,reduce:ty,reduceRight:jb,reject:CS,rest:Kd,restArguments:qc,result:b9,sample:MS,select:dh,shuffle:V9,size:j9,some:V_,sortBy:PS,sortedIndex:wS,tail:Kd,take:iy,tap:c9,template:x9,templateSettings:m9,throttle:k9,times:A9,toArray:kS,toPath:uS,transpose:gv,unescape:p9,union:zS,uniq:mv,unique:mv,uniqueId:S9,unzip:gv,values:dp,where:O9,without:Y9,wrap:P9,zip:$9},Symbol.toStringTag,{value:"Module"}));var Zb=FS(eR);Zb._=Zb;var tR=function(e,t){var n;return parseString(e,function(c,g){n=g["nex:nexml"].trees[0].tree.map(function(b){var E=b.node.map(oe=>oe.$),a=E.reduce(function(oe,fe){return fe.edges=[],fe.name=fe.id,oe[fe.id]=fe,oe},{}),U=E.filter(oe=>oe.root),W=U>0?U[0].id:E[0].id;a[W].name="root",b.edge.map(oe=>oe.$).forEach(function(oe){a[oe.source].edges.push(oe)});function ce(oe,fe){if(oe.edges){var we=a1(oe.edges,"target");oe.children=dp(m2(a,we)),oe.children.forEach(function(et,lt){et.attribute=oe.edges[lt].length||""}),oe.children.forEach(ce),oe.annotation=""}}return ce(a[W]),a[W]})}),n};function iR(e,t,n,c){let g=this.nodes.descendants();if(e.parent&&g.indexOf(e)>=0){let E=e.parent.children.indexOf(e),a={name:n,parent:e.parent,attribute:c?c[2]:null,original_child_order:e.original_child_order},U={name:t,parent:a,attribute:c?c[1]:null,original_child_order:2};a.children=[e,U],e.parent.children[E]=a,e.parent=a,e.attribute=c?c[0]:null,e.original_child_order=1}return this}function nR(e,t){return e.children?e.children.push(t):e.children=[t],e}function rR(e,t){return{data:{name:e,attribute:t?t[1]:null},parent:""}}function sR(e){let t=this.nodes.descendants();if(typeof e!="number")return this.deleteANode(t.indexOf(e));if(e>0&&e<t.length){let n=t[e];if(n.parent){let c=n.parent.children.indexOf(n);c>=0&&(t.splice(e,1),n.children&&n.children.forEach(function(g){g.original_child_order=n.parent.children.length,n.parent.children.push(g),g.parent=n.parent}),n.parent.children.length>2?n.parent.children.splice(c,1):n.parent.parent?(n.parent.parent.children[n.parent.parent.children.indexOf(n.parent)]=n.parent.children[1-c],n.parent.children[1-c].parent=n.parent.parent,t.splice(t.indexOf(n.parent),1)):(t.splice(0,1),t.parent=null,delete t.data.attribute,delete t.data.annotation,delete t.data.original_child_order,t.name="root",t.data.name="root"))}}return this}function aR(){return dh(this.nodes.descendants(),e=>!s1(e,"children"))}function oR(){return dh(this.nodes.descendants(),e=>s1(e,"children"))}function lR(){return this.nodes}function uR(){return this.nodes}function cR(e){return dh(this.nodes.descendants(),t=>t.data.name==e)[0]}function hR(e){jc(this.nodes.descendants(),function(t){t.data&&t.data.name in e&&(t.annotations=e[t.data.name])})}function Sl(e){return!s1(e,"children")}function AR(e,t){return this.nodes.each(function(n){e in n&&(t&&(n[t]=n[e]),delete n[e])}),this}function fR(e){e||this.nodes.each(t=>{Sl(t)||(t[this.selection_attribute_name]=!1,t.data.traits||(t.data.traits={}),t.data.traits[this.selection_attribute_name]=t[this.selection_attribute_name])})}function OS(e,t,n){let c=[];function g(b){Sl(b)?t&&b!=e&&c.push(b):(n&&b!=e&&c.push(b),b.children.forEach(g))}return g(e),c}const dR=Object.freeze(Object.defineProperty({__proto__:null,addChild:nR,assignAttributes:hR,clearInternalNodes:fR,createNode:rR,deleteANode:sR,getInternals:oR,getNodeByName:cR,getNodes:uR,getRootNode:lR,getTips:aR,graftANode:iR,isLeafNode:Sl,selectAllDescendants:OS,updateKeyName:AR},Symbol.toStringTag,{value:"Module"}));function wg(e,t={}){const n=/^-?\d+(\.\d+)?$/;let c=t.left_delimiter||"{",g=t.right_delimiter||"}",b=[];function E(){let kt={name:null},Bt=b[b.length-1];"children"in Bt||(Bt.children=[]),b.push(kt),Bt.children.push(b[b.length-1]),b[b.length-1].original_child_order=Bt.children.length}function a(){let kt=b.pop();kt.name=ce,"children"in kt?kt.bootstrap_values=ce:kt.name=ce,kt.attribute=oe,c=="["&&fe.includes("&&NHX")?fe.split(":").slice(1).forEach(Bt=>{const[Rt,Ge]=Bt.split("=");kt[Rt]=n.test(Ge)?+Ge:Ge}):kt.annotation=fe,ce="",oe="",fe=""}function U(kt){return{json:null,error:"Unexpected '"+e[kt]+"' in '"+e.substring(kt-20,kt+1)+"[ERROR HERE]"+e.substring(kt+1,kt+20)+"'"}}let W=0,ce="",oe="",fe="",we=null,et={"'":1,'"':1},lt={name:"root"};b.push(lt);for(var Ke=/\s/,st=0;st<e.length;st++)try{var ut=e[st];switch(W){case 0:{ut=="("&&(E(),W=1);break}case 1:case 3:{if(ut==":")W=3;else if(ut==","||ut==")")try{a(),W=1,ut==","&&E()}catch{return U(st)}else if(ut=="("){if(ce.length>0)return U(st);E()}else if(ut in et){if(W==1&&ce.length===0&&oe.length===0&&fe.length===0){W=2,we=ut;continue}return U(st)}else if(ut==c){if(fe.length)return U(st);W=4}else if(W==3)oe+=ut;else{if(Ke.test(ut))continue;if(ut==";"){st=e.length;break}ce+=ut}break}case 2:{if(ut==we){if(st<e.length-1&&e[st+1]==we){st++,ce+=we;continue}we=0,W=1;continue}else ce+=ut;break}case 4:{if(ut==g)W=3;else{if(ut==c)return U(st);fe+=ut}break}}}catch{return U(st)}return b.length!=1?U(e.length-1):{json:lt,error:null}}function pR(e,t){let n=this;e||(e=b=>"");function c(b){if(b.notshown)return;if(Sl(b)||(g.push("("),b.children.forEach(function(a,U){U&&g.push(","),c(a)}),g.push(")")),b.data.name!=="root"){const a=b.data.name.replaceAll("'","''");/\W/.test(a)?g.push("'"+a+"'"):g.push(a)}g.push(e(b));let E=n.branch_length_accessor(b);E!==void 0&&g.push(":"+E)}let g=[];return e=e||"",c(t||this.nodes),g.join("")+";"}function mR(e){let t=e,n=t.toUpperCase().indexOf("BEGIN DATA;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let g=c.slice(0,n);c=mc(g.split(";"),U=>U.trim());let b=dh(c,U=>U.toUpperCase().startsWith("DIMENSION"));b=b[0].split(" "),b=o_(mc(Kd(b),U=>U.split("=")));let E=dh(c,U=>U.toUpperCase().startsWith("FORMAT"));E=E[0].split(" "),E=o_(mc(Kd(E),U=>U.split("="))),E.symbols=CS(E.symbols.split(""),U=>U=='"');let a=dh(c,U=>U.toUpperCase().startsWith("MATRIX"));return a=a[0].split(`
`),a=o_(mc(Kd(a),U=>LS(U.split(" ")))),a=AS(a,(U,W)=>U=="?"?E.symbols:Array(U)),{dimensions:b,format:E,matrix:a}}function gR(e,t,n){jc(e.getTips(),c=>{c.data.test=n.matrix[c.data.name]})}function NS(e){let t=e,n=t.toUpperCase().indexOf("BEGIN TREES;"),c=t.slice(n);if(c.length<2)return"";n=c.toUpperCase().indexOf("END;");let b=c.slice(0,n).split(`
`);return b=dh(b,E=>E.trim().toUpperCase().startsWith("TREE")),wg(b[0])}const _R=Object.freeze(Object.defineProperty({__proto__:null,default:NS,loadAnnotations:gR,parseAnnotations:mR},Symbol.toStringTag,{value:"Module"}));function _v(e){var t={};if(e.nodeType==1){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var c=e.attributes.item(n);t["@attributes"][c.nodeName]=c.nodeValue}}}else e.nodeType==3&&(t=e.nodeValue);if(e.hasChildNodes()&&e.childNodes.length===1&&e.childNodes[0].nodeType===3)t=e.childNodes[0].nodeValue;else if(e.hasChildNodes())for(var g=0;g<e.childNodes.length;g++){var b=e.childNodes.item(g),E=b.nodeName;if(typeof t[E]>"u")t[E]=_v(b);else{if(typeof t[E].push>"u"){var a=t[E];t[E]=[],t[E].push(a)}t[E].push(_v(b))}}return t}var VS=function(e,t){function n(g,b){g.clade&&(g.clade.forEach(n),g.children=g.clade,delete g.clade),g.annotation=1,g.attribute="0.01",g.branch_length&&(g.attribute=g.branch_length),g.taxonomy&&(g.name=g.taxonomy.scientific_name),g.annotation=""}var c;return e=_v(e),c=e.phyloxml.phylogeny.clade,c.name="root",n(c),{json:c,error:null}};function yR(e,t){t.left_delimiter="[",t.right_delimiter="]";const n=wg(e,t);function c(g){if(g.annotation){g.beast={};const E=g.annotation.split(/=|,|{|}/).filter(a=>a);for(var b=0;b<E.length;b+=2){let a=E[b].replace(/&|%/g,"");/[a-df-zA-DF-Z]+/.test(E[b+2])?g.beast[a]=+E[b+1]:(g.beast[a]=[+E[b+1],+E[b+2]],b++)}}g.annotation=void 0,g.children&&g.children.forEach(c)}return c(n.json),n}var ny={nexml:tR,phyloxml:VS,nexus:NS,nwk:wg,nhx:wg,beast:yR};function vR(){let t=this.getTips(),n=mc(t,c=>({name:c.data.name,length:parseFloat(c.data.attribute)}));return n=PS(n,c=>-c.length),n}function xR(e,t){function n(g,b){if(b.mp=[[0,0],[!1,!1]],Sl(b))b.mp[1][0]=b.mp[1][1]=b[g]||!1,b.mp[0][0]=b.mp[1][0]?1:0,b.mp[0][1]=1-b.mp[0][0];else{b.children.forEach(c);var E=b.children.reduce(function(U,W){return W.mp[0][0]+U},0),a=b.children.reduce(function(U,W){return W.mp[0][1]+U},0);b[g]?(b.mp[0][0]=a+1,b.mp[1][0]=!0,b.mp[0][1]=a,b.mp[1][1]=!0):(E<a+1?(b.mp[0][0]=E,b.mp[1][0]=!1):(b.mp[0][0]=a+1,b.mp[1][0]=!0),a<E+1?(b.mp[0][1]=a,b.mp[1][1]=!0):(b.mp[0][1]=E+1,b.mp[1][1]=!1))}}const c=tf(n,t);c(this.nodes),this.nodes.each(g=>{g.parent?g.mp=g.mp[1][g.parent.mp?1:0]:g.mp=g.mp[1][g.mp[0][0]<g.mp[0][1]?0:1]}),this.display.modifySelection((g,b)=>Sl(g.target)?g.target[t]:g.target.mp)}var U_={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */U_.exports;(function(e,t){(function(){var n,c="4.17.21",g=200,b="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",E="Expected a function",a="Invalid `variable` option passed into `_.template`",U="__lodash_hash_undefined__",W=500,ce="__lodash_placeholder__",oe=1,fe=2,we=4,et=1,lt=2,Ke=1,st=2,ut=4,kt=8,Bt=16,Rt=32,Ge=64,ni=128,it=256,xt=512,_t=30,mt="...",bt=800,dt=16,nt=1,pt=2,at=3,Nt=1/0,Ft=9007199254740991,Dt=17976931348623157e292,ci=NaN,bi=4294967295,ki=bi-1,Gi=bi>>>1,rn=[["ary",ni],["bind",Ke],["bindKey",st],["curry",kt],["curryRight",Bt],["flip",xt],["partial",Rt],["partialRight",Ge],["rearg",it]],$i="[object Arguments]",qi="[object Array]",sn="[object AsyncFunction]",Ti="[object Boolean]",yi="[object Date]",hi="[object DOMException]",Ei="[object Error]",Li="[object Function]",fn="[object GeneratorFunction]",_n="[object Map]",gi="[object Number]",mn="[object Null]",ti="[object Object]",Mn="[object Promise]",ns="[object Proxy]",fi="[object RegExp]",ln="[object Set]",pr="[object String]",On="[object Symbol]",Qn="[object Undefined]",wn="[object WeakMap]",v="[object WeakSet]",k="[object ArrayBuffer]",V="[object DataView]",$="[object Float32Array]",te="[object Float64Array]",Ae="[object Int8Array]",ve="[object Int16Array]",Ie="[object Int32Array]",Ee="[object Uint8Array]",ze="[object Uint8ClampedArray]",Qe="[object Uint16Array]",He="[object Uint32Array]",Ze=/\b__p \+= '';/g,Ve=/\b(__p \+=) '' \+/g,ft=/(__e\(.*?\)|\b__t\)) \+\n'';/g,rt=/&(?:amp|lt|gt|quot|#39);/g,Me=/[&<>"']/g,se=RegExp(rt.source),ne=RegExp(Me.source),X=/<%-([\s\S]+?)%>/g,ie=/<%([\s\S]+?)%>/g,de=/<%=([\s\S]+?)%>/g,ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fe=/[\\^$.*+?()[\]{}|]/g,Ne=RegExp(Fe.source),Xe=/^\s+/,Ye=/\s/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ue=/\{\n\/\* \[wrapped with (.+)\] \*/,ht=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,o=/[()=,{}\[\]\/\s]/,ke=/\\(\\)?/g,ai=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,di=/\w*$/,Ai=/^[-+]0x[0-9a-f]+$/i,Kt=/^0b[01]+$/i,oi=/^\[object .+?Constructor\]$/,Ri=/^0o[0-7]+$/i,vi=/^(?:0|[1-9]\d*)$/,wi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yt=/($^)/,vn=/['\n\r\u2028\u2029\\]/g,ar="\\ud800-\\udfff",dn="\\u0300-\\u036f",Vn="\\ufe20-\\ufe2f",Hr="\\u20d0-\\u20ff",Hi=dn+Vn+Hr,lr="\\u2700-\\u27bf",Fn="a-z\\xdf-\\xf6\\xf8-\\xff",Qt="\\xac\\xb1\\xd7\\xf7",Yi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ut="\\u2000-\\u206f",En=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ur="A-Z\\xc0-\\xd6\\xd8-\\xde",Ns="\\ufe0e\\ufe0f",Vr=Qt+Yi+Ut+En,Vt="[']",cr="["+ar+"]",Lt="["+Vr+"]",Br="["+Hi+"]",Vs="\\d+",ua="["+lr+"]",kr="["+Fn+"]",Fa="[^"+ar+Vr+Vs+lr+Fn+ur+"]",zo="\\ud83c[\\udffb-\\udfff]",Oa="(?:"+Br+"|"+zo+")",Xs="[^"+ar+"]",jn="(?:\\ud83c[\\udde6-\\uddff]){2}",aa="[\\ud800-\\udbff][\\udc00-\\udfff]",ls="["+ur+"]",Na="\\u200d",rl="(?:"+kr+"|"+Fa+")",sl="(?:"+ls+"|"+Fa+")",Ja="(?:"+Vt+"(?:d|ll|m|re|s|t|ve))?",Va="(?:"+Vt+"(?:D|LL|M|RE|S|T|VE))?",N=Oa+"?",xe="["+Ns+"]?",tt="(?:"+Na+"(?:"+[Xs,jn,aa].join("|")+")"+xe+N+")*",It="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Wt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Si=xe+N+tt,Bi="(?:"+[ua,jn,aa].join("|")+")"+Si,un="(?:"+[Xs+Br+"?",Br,jn,aa,cr].join("|")+")",An=RegExp(Vt,"g"),rr=RegExp(Br,"g"),hr=RegExp(zo+"(?="+zo+")|"+un+Si,"g"),zr=RegExp([ls+"?"+kr+"+"+Ja+"(?="+[Lt,ls,"$"].join("|")+")",sl+"+"+Va+"(?="+[Lt,ls+rl,"$"].join("|")+")",ls+"?"+rl+"+"+Ja,ls+"+"+Va,Wt,It,Vs,Bi].join("|"),"g"),Ua=RegExp("["+Na+ar+Hi+Ns+"]"),Ga=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qa=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pl=-1,Ur={};Ur[$]=Ur[te]=Ur[Ae]=Ur[ve]=Ur[Ie]=Ur[Ee]=Ur[ze]=Ur[Qe]=Ur[He]=!0,Ur[$i]=Ur[qi]=Ur[k]=Ur[Ti]=Ur[V]=Ur[yi]=Ur[Ei]=Ur[Li]=Ur[_n]=Ur[gi]=Ur[ti]=Ur[fi]=Ur[ln]=Ur[pr]=Ur[wn]=!1;var ir={};ir[$i]=ir[qi]=ir[k]=ir[V]=ir[Ti]=ir[yi]=ir[$]=ir[te]=ir[Ae]=ir[ve]=ir[Ie]=ir[_n]=ir[gi]=ir[ti]=ir[fi]=ir[ln]=ir[pr]=ir[On]=ir[Ee]=ir[ze]=ir[Qe]=ir[He]=!0,ir[Ei]=ir[Li]=ir[wn]=!1;var wr={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Mr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},js={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ks=parseFloat,Pr=parseInt,bo=typeof Kf=="object"&&Kf&&Kf.Object===Object&&Kf,Ho=typeof self=="object"&&self&&self.Object===Object&&self,Ls=bo||Ho||Function("return this")(),Il=t&&!t.nodeType&&t,ho=Il&&!0&&e&&!e.nodeType&&e,jo=ho&&ho.exports===Il,ca=jo&&bo.process,Ys=function(){try{var mi=ho&&ho.require&&ho.require("util").types;return mi||ca&&ca.binding&&ca.binding("util")}catch{}}(),El=Ys&&Ys.isArrayBuffer,Ha=Ys&&Ys.isDate,Ta=Ys&&Ys.isMap,ml=Ys&&Ys.isRegExp,Cl=Ys&&Ys.isSet,pu=Ys&&Ys.isTypedArray;function us(mi,Ni,Di){switch(Di.length){case 0:return mi.call(Ni);case 1:return mi.call(Ni,Di[0]);case 2:return mi.call(Ni,Di[0],Di[1]);case 3:return mi.call(Ni,Di[0],Di[1],Di[2])}return mi.apply(Ni,Di)}function sc(mi,Ni,Di,Ot){for(var ei=-1,xi=mi==null?0:mi.length;++ei<xi;){var Oi=mi[ei];Ni(Ot,Oi,Di(Oi),mi)}return Ot}function eo(mi,Ni){for(var Di=-1,Ot=mi==null?0:mi.length;++Di<Ot&&Ni(mi[Di],Di,mi)!==!1;);return mi}function to(mi,Ni){for(var Di=mi==null?0:mi.length;Di--&&Ni(mi[Di],Di,mi)!==!1;);return mi}function ql(mi,Ni){for(var Di=-1,Ot=mi==null?0:mi.length;++Di<Ot;)if(!Ni(mi[Di],Di,mi))return!1;return!0}function Ro(mi,Ni){for(var Di=-1,Ot=mi==null?0:mi.length,ei=0,xi=[];++Di<Ot;){var Oi=mi[Di];Ni(Oi,Di,mi)&&(xi[ei++]=Oi)}return xi}function Zo(mi,Ni){var Di=mi==null?0:mi.length;return!!Di&&Yo(mi,Ni,0)>-1}function wo(mi,Ni,Di){for(var Ot=-1,ei=mi==null?0:mi.length;++Ot<ei;)if(Di(Ni,mi[Ot]))return!0;return!1}function Us(mi,Ni){for(var Di=-1,Ot=mi==null?0:mi.length,ei=Array(Ot);++Di<Ot;)ei[Di]=Ni(mi[Di],Di,mi);return ei}function Qo(mi,Ni){for(var Di=-1,Ot=Ni.length,ei=mi.length;++Di<Ot;)mi[ei+Di]=Ni[Di];return mi}function Wo(mi,Ni,Di,Ot){var ei=-1,xi=mi==null?0:mi.length;for(Ot&&xi&&(Di=mi[++ei]);++ei<xi;)Di=Ni(Di,mi[ei],ei,mi);return Di}function Xo(mi,Ni,Di,Ot){var ei=mi==null?0:mi.length;for(Ot&&ei&&(Di=mi[--ei]);ei--;)Di=Ni(Di,mi[ei],ei,mi);return Di}function ba(mi,Ni){for(var Di=-1,Ot=mi==null?0:mi.length;++Di<Ot;)if(Ni(mi[Di],Di,mi))return!0;return!1}var ja=Ar("length");function Ts(mi){return mi.split("")}function mu(mi){return mi.match(Tt)||[]}function Sr(mi,Ni,Di){var Ot;return Di(mi,function(ei,xi,Oi){if(Ni(ei,xi,Oi))return Ot=xi,!1}),Ot}function Xn(mi,Ni,Di,Ot){for(var ei=mi.length,xi=Di+(Ot?1:-1);Ot?xi--:++xi<ei;)if(Ni(mi[xi],xi,mi))return xi;return-1}function Yo(mi,Ni,Di){return Ni===Ni?Rr(mi,Ni,Di):Xn(mi,Za,Di)}function Dr(mi,Ni,Di,Ot){for(var ei=Di-1,xi=mi.length;++ei<xi;)if(Ot(mi[ei],Ni))return ei;return-1}function Za(mi){return mi!==mi}function Kr(mi,Ni){var Di=mi==null?0:mi.length;return Di?Jr(mi,Ni)/Di:ci}function Ar(mi){return function(Ni){return Ni==null?n:Ni[mi]}}function So(mi){return function(Ni){return mi==null?n:mi[Ni]}}function Nn(mi,Ni,Di,Ot,ei){return ei(mi,function(xi,Oi,Ln){Di=Ot?(Ot=!1,xi):Ni(Di,xi,Oi,Ln)}),Di}function Ol(mi,Ni){var Di=mi.length;for(mi.sort(Ni);Di--;)mi[Di]=mi[Di].value;return mi}function Jr(mi,Ni){for(var Di,Ot=-1,ei=mi.length;++Ot<ei;){var xi=Ni(mi[Ot]);xi!==n&&(Di=Di===n?xi:Di+xi)}return Di}function jr(mi,Ni){for(var Di=-1,Ot=Array(mi);++Di<mi;)Ot[Di]=Ni(Di);return Ot}function ks(mi,Ni){return Us(Ni,function(Di){return[Di,mi[Di]]})}function Cr(mi){return mi&&mi.slice(0,Sa(mi)+1).replace(Xe,"")}function nr(mi){return function(Ni){return mi(Ni)}}function al(mi,Ni){return Us(Ni,function(Di){return mi[Di]})}function Xr(mi,Ni){return mi.has(Ni)}function Io(mi,Ni){for(var Di=-1,Ot=mi.length;++Di<Ot&&Yo(Ni,mi[Di],0)>-1;);return Di}function ol(mi,Ni){for(var Di=mi.length;Di--&&Yo(Ni,mi[Di],0)>-1;);return Di}function Zr(mi,Ni){for(var Di=mi.length,Ot=0;Di--;)mi[Di]===Ni&&++Ot;return Ot}var hs=So(wr),wa=So(Mr);function Tl(mi){return"\\"+vr[mi]}function Eo(mi,Ni){return mi==null?n:mi[Ni]}function kl(mi){return Ua.test(mi)}function Ao(mi){return Ga.test(mi)}function Js(mi){for(var Ni,Di=[];!(Ni=mi.next()).done;)Di.push(Ni.value);return Di}function Gs(mi){var Ni=-1,Di=Array(mi.size);return mi.forEach(function(Ot,ei){Di[++Ni]=[ei,Ot]}),Di}function Qa(mi,Ni){return function(Di){return mi(Ni(Di))}}function $o(mi,Ni){for(var Di=-1,Ot=mi.length,ei=0,xi=[];++Di<Ot;){var Oi=mi[Di];(Oi===Ni||Oi===ce)&&(mi[Di]=ce,xi[ei++]=Di)}return xi}function Yr(mi){var Ni=-1,Di=Array(mi.size);return mi.forEach(function(Ot){Di[++Ni]=Ot}),Di}function mr(mi){var Ni=-1,Di=Array(mi.size);return mi.forEach(function(Ot){Di[++Ni]=[Ot,Ot]}),Di}function Rr(mi,Ni,Di){for(var Ot=Di-1,ei=mi.length;++Ot<ei;)if(mi[Ot]===Ni)return Ot;return-1}function ha(mi,Ni,Di){for(var Ot=Di+1;Ot--;)if(mi[Ot]===Ni)return Ot;return Ot}function fo(mi){return kl(mi)?Wa(mi):ja(mi)}function ea(mi){return kl(mi)?ll(mi):Ts(mi)}function Sa(mi){for(var Ni=mi.length;Ni--&&Ye.test(mi.charAt(Ni)););return Ni}var ka=So(js);function Wa(mi){for(var Ni=hr.lastIndex=0;hr.test(mi);)++Ni;return Ni}function ll(mi){return mi.match(hr)||[]}function ou(mi){return mi.match(zr)||[]}var gl=function mi(Ni){Ni=Ni==null?Ls:io.defaults(Ls.Object(),Ni,io.pick(Ls,qa));var Di=Ni.Array,Ot=Ni.Date,ei=Ni.Error,xi=Ni.Function,Oi=Ni.Math,Ln=Ni.Object,Un=Ni.RegExp,or=Ni.String,Yn=Ni.TypeError,qs=Di.prototype,Ms=xi.prototype,As=Ln.prototype,Xa=Ni["__core-js_shared__"],po=Ms.toString,rs=As.hasOwnProperty,Qu=0,zu=function(){var P=/[^.]+$/.exec(Xa&&Xa.keys&&Xa.keys.IE_PROTO||"");return P?"Symbol(src)_1."+P:""}(),mo=As.toString,Ml=po.call(Ln),Pn=Ls._,Ma=Un("^"+po.call(rs).replace(Fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bn=jo?Ni.Buffer:n,Fo=Ni.Symbol,Nl=Ni.Uint8Array,Sn=bn?bn.allocUnsafe:n,Hl=Qa(Ln.getPrototypeOf,Ln),In=Ln.create,_l=As.propertyIsEnumerable,lu=qs.splice,Ru=Fo?Fo.isConcatSpreadable:n,Vl=Fo?Fo.iterator:n,yl=Fo?Fo.toStringTag:n,ta=function(){try{var P=Kh(Ln,"defineProperty");return P({},"",{}),P}catch{}}(),ac=Ni.clearTimeout!==Ls.clearTimeout&&Ni.clearTimeout,Wu=Ot&&Ot.now!==Ls.Date.now&&Ot.now,jl=Ni.setTimeout!==Ls.setTimeout&&Ni.setTimeout,fs=Oi.ceil,_a=Oi.floor,Ko=Ln.getOwnPropertySymbols,gu=bn?bn.isBuffer:n,Fu=Ni.isFinite,uu=qs.join,Ou=Qa(Ln.keys,Ln),_r=Oi.max,ds=Oi.min,pn=Ot.now,Gn=Ni.parseInt,Jn=Oi.random,Jo=qs.reverse,Cu=Kh(Ni,"DataView"),oa=Kh(Ni,"Map"),_u=Kh(Ni,"Promise"),_s=Kh(Ni,"Set"),Co=Kh(Ni,"WeakMap"),Mi=Kh(Ln,"create"),zi=Co&&new Co,ys={},yu=th(Cu),Oo=th(oa),cs=th(_u),ul=th(_s),Ps=th(Co),C=Fo?Fo.prototype:n,D=C?C.valueOf:n,z=C?C.toString:n;function R(P){if(zt(P)&&!f(P)&&!(P instanceof be)){if(P instanceof ae)return P;if(rs.call(P,"__wrapped__"))return hd(P)}return new ae(P)}var ee=function(){function P(){}return function(H){if(!Pt(H))return{};if(In)return In(H);P.prototype=H;var pe=new P;return P.prototype=n,pe}}();function le(){}function ae(P,H){this.__wrapped__=P,this.__actions__=[],this.__chain__=!!H,this.__index__=0,this.__values__=n}R.templateSettings={escape:X,evaluate:ie,interpolate:de,variable:"",imports:{_:R}},R.prototype=le.prototype,R.prototype.constructor=R,ae.prototype=ee(le.prototype),ae.prototype.constructor=ae;function be(P){this.__wrapped__=P,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=bi,this.__views__=[]}function We(){var P=new be(this.__wrapped__);return P.__actions__=xl(this.__actions__),P.__dir__=this.__dir__,P.__filtered__=this.__filtered__,P.__iteratees__=xl(this.__iteratees__),P.__takeCount__=this.__takeCount__,P.__views__=xl(this.__views__),P}function yt(){if(this.__filtered__){var P=new be(this);P.__dir__=-1,P.__filtered__=!0}else P=this.clone(),P.__dir__*=-1;return P}function Ct(){var P=this.__wrapped__.value(),H=this.__dir__,pe=f(P),je=H<0,St=pe?P.length:0,qt=km(0,St,this.__views__),li=qt.start,pi=qt.end,Pi=pi-li,on=je?pi:li-1,cn=this.__iteratees__,yn=cn.length,$n=0,xr=ds(Pi,this.__takeCount__);if(!pe||!je&&St==Pi&&xr==Pi)return h0(P,this.__actions__);var Qr=[];e:for(;Pi--&&$n<xr;){on+=H;for(var Hs=-1,Wr=P[on];++Hs<yn;){var sa=cn[Hs],da=sa.iteratee,hh=sa.type,dc=da(Wr);if(hh==pt)Wr=dc;else if(!dc){if(hh==nt)continue e;break e}}Qr[$n++]=Wr}return Qr}be.prototype=ee(le.prototype),be.prototype.constructor=be;function ii(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function Gt(){this.__data__=Mi?Mi(null):{},this.size=0}function jt(P){var H=this.has(P)&&delete this.__data__[P];return this.size-=H?1:0,H}function Z(P){var H=this.__data__;if(Mi){var pe=H[P];return pe===U?n:pe}return rs.call(H,P)?H[P]:n}function A(P){var H=this.__data__;return Mi?H[P]!==n:rs.call(H,P)}function I(P,H){var pe=this.__data__;return this.size+=this.has(P)?0:1,pe[P]=Mi&&H===n?U:H,this}ii.prototype.clear=Gt,ii.prototype.delete=jt,ii.prototype.get=Z,ii.prototype.has=A,ii.prototype.set=I;function F(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function O(){this.__data__=[],this.size=0}function y(P){var H=this.__data__,pe=Jt(H,P);if(pe<0)return!1;var je=H.length-1;return pe==je?H.pop():lu.call(H,pe,1),--this.size,!0}function s(P){var H=this.__data__,pe=Jt(H,P);return pe<0?n:H[pe][1]}function i(P){return Jt(this.__data__,P)>-1}function r(P,H){var pe=this.__data__,je=Jt(pe,P);return je<0?(++this.size,pe.push([P,H])):pe[je][1]=H,this}F.prototype.clear=O,F.prototype.delete=y,F.prototype.get=s,F.prototype.has=i,F.prototype.set=r;function l(P){var H=-1,pe=P==null?0:P.length;for(this.clear();++H<pe;){var je=P[H];this.set(je[0],je[1])}}function d(){this.size=0,this.__data__={hash:new ii,map:new(oa||F),string:new ii}}function _(P){var H=bf(this,P).delete(P);return this.size-=H?1:0,H}function w(P){return bf(this,P).get(P)}function T(P){return bf(this,P).has(P)}function B(P,H){var pe=bf(this,P),je=pe.size;return pe.set(P,H),this.size+=pe.size==je?0:1,this}l.prototype.clear=d,l.prototype.delete=_,l.prototype.get=w,l.prototype.has=T,l.prototype.set=B;function j(P){var H=-1,pe=P==null?0:P.length;for(this.__data__=new l;++H<pe;)this.add(P[H])}function Y(P){return this.__data__.set(P,U),this}function ue(P){return this.__data__.has(P)}j.prototype.add=j.prototype.push=Y,j.prototype.has=ue;function Se(P){var H=this.__data__=new F(P);this.size=H.size}function Te(){this.__data__=new F,this.size=0}function Re(P){var H=this.__data__,pe=H.delete(P);return this.size=H.size,pe}function Be(P){return this.__data__.get(P)}function $e(P){return this.__data__.has(P)}function vt(P,H){var pe=this.__data__;if(pe instanceof F){var je=pe.__data__;if(!oa||je.length<g-1)return je.push([P,H]),this.size=++pe.size,this;pe=this.__data__=new l(je)}return pe.set(P,H),this.size=pe.size,this}Se.prototype.clear=Te,Se.prototype.delete=Re,Se.prototype.get=Be,Se.prototype.has=$e,Se.prototype.set=vt;function ot(P,H){var pe=f(P),je=!pe&&Oe(P),St=!pe&&!je&&G(P),qt=!pe&&!je&&!St&&Rn(P),li=pe||je||St||qt,pi=li?jr(P.length,or):[],Pi=pi.length;for(var on in P)(H||rs.call(P,on))&&!(li&&(on=="length"||St&&(on=="offset"||on=="parent")||qt&&(on=="buffer"||on=="byteLength"||on=="byteOffset")||kc(on,Pi)))&&pi.push(on);return pi}function ct(P){var H=P.length;return H?P[pA(0,H-1)]:n}function Et(P,H){return Sf(xl(P),Ui(H,0,P.length))}function wt(P){return Sf(xl(P))}function ri(P,H,pe){(pe!==n&&!J(P[H],pe)||pe===n&&!(H in P))&&Ii(P,H,pe)}function Xt(P,H,pe){var je=P[H];(!(rs.call(P,H)&&J(je,pe))||pe===n&&!(H in P))&&Ii(P,H,pe)}function Jt(P,H){for(var pe=P.length;pe--;)if(J(P[pe][0],H))return pe;return-1}function si(P,H,pe,je){return er(P,function(St,qt,li){H(je,St,pe(St),li)}),je}function ji(P,H){return P&&lc(H,ao(H),P)}function Zi(P,H){return P&&lc(H,vo(H),P)}function Ii(P,H,pe){H=="__proto__"&&ta?ta(P,H,{configurable:!0,enumerable:!0,value:pe,writable:!0}):P[H]=pe}function Vi(P,H){for(var pe=-1,je=H.length,St=Di(je),qt=P==null;++pe<je;)St[pe]=qt?n:Xl(P,H[pe]);return St}function Ui(P,H,pe){return P===P&&(pe!==n&&(P=P<=pe?P:pe),H!==n&&(P=P>=H?P:H)),P}function an(P,H,pe,je,St,qt){var li,pi=H&oe,Pi=H&fe,on=H&we;if(pe&&(li=St?pe(P,je,St,qt):pe(P)),li!==n)return li;if(!Pt(P))return P;var cn=f(P);if(cn){if(li=Pm(P),!pi)return xl(P,li)}else{var yn=Ul(P),$n=yn==Li||yn==fn;if(G(P))return X0(P,pi);if(yn==ti||yn==$i||$n&&!St){if(li=Pi||$n?{}:id(P),!pi)return Pi?mf(P,Zi(li,P)):Zh(P,ji(li,P))}else{if(!ir[yn])return St?P:{};li=Jh(P,yn,pi)}}qt||(qt=new Se);var xr=qt.get(P);if(xr)return xr;qt.set(P,li),en(P)?P.forEach(function(Wr){li.add(an(Wr,H,pe,Wr,P,qt))}):$t(P)&&P.forEach(function(Wr,sa){li.set(sa,an(Wr,H,pe,sa,P,qt))});var Qr=on?Pi?xf:Ih:Pi?vo:ao,Hs=cn?n:Qr(P);return eo(Hs||P,function(Wr,sa){Hs&&(sa=Wr,Wr=P[sa]),Xt(li,sa,an(Wr,H,pe,sa,P,qt))}),li}function Bn(P){var H=ao(P);return function(pe){return Ji(pe,P,H)}}function Ji(P,H,pe){var je=pe.length;if(P==null)return!je;for(P=Ln(P);je--;){var St=pe[je],qt=H[St],li=P[St];if(li===n&&!(St in P)||!qt(li))return!1}return!0}function Cn(P,H,pe){if(typeof P!="function")throw new Yn(E);return kA(function(){P.apply(n,pe)},H)}function yr(P,H,pe,je){var St=-1,qt=Zo,li=!0,pi=P.length,Pi=[],on=H.length;if(!pi)return Pi;pe&&(H=Us(H,nr(pe))),je?(qt=wo,li=!1):H.length>=g&&(qt=Xr,li=!1,H=new j(H));e:for(;++St<pi;){var cn=P[St],yn=pe==null?cn:pe(cn);if(cn=je||cn!==0?cn:0,li&&yn===yn){for(var $n=on;$n--;)if(H[$n]===yn)continue e;Pi.push(cn)}else qt(H,yn,je)||Pi.push(cn)}return Pi}var er=A0(_o),Ia=A0(Zs,!0);function Aa(P,H){var pe=!0;return er(P,function(je,St,qt){return pe=!!H(je,St,qt),pe}),pe}function Bs(P,H,pe){for(var je=-1,St=P.length;++je<St;){var qt=P[je],li=H(qt);if(li!=null&&(pi===n?li===li&&!Dn(li):pe(li,pi)))var pi=li,Pi=qt}return Pi}function no(P,H,pe,je){var St=P.length;for(pe=Wn(pe),pe<0&&(pe=-pe>St?0:St+pe),je=je===n||je>St?St:Wn(je),je<0&&(je+=St),je=pe>je?0:xs(je);pe<je;)P[pe++]=H;return P}function ro(P,H){var pe=[];return er(P,function(je,St,qt){H(je,St,qt)&&pe.push(je)}),pe}function Gr(P,H,pe,je,St){var qt=-1,li=P.length;for(pe||(pe=Ip),St||(St=[]);++qt<li;){var pi=P[qt];H>0&&pe(pi)?H>1?Gr(pi,H-1,pe,je,St):Qo(St,pi):je||(St[St.length]=pi)}return St}var ya=gf(),go=gf(!0);function _o(P,H){return P&&ya(P,H,ao)}function Zs(P,H){return P&&go(P,H,ao)}function es(P,H){return Ro(H,function(pe){return At(P[pe])})}function ts(P,H){H=xh(H,P);for(var pe=0,je=H.length;P!=null&&pe<je;)P=P[ms(H[pe++])];return pe&&pe==je?P:n}function Lr(P,H,pe){var je=H(P);return f(P)?je:Qo(je,pe(P))}function vs(P){return P==null?P===n?Qn:mn:yl&&yl in Ln(P)?wf(P):ad(P)}function Qs(P,H){return P>H}function To(P,H){return P!=null&&rs.call(P,H)}function No(P,H){return P!=null&&H in Ln(P)}function Vo(P,H,pe){return P>=ds(H,pe)&&P<_r(H,pe)}function Sc(P,H,pe){for(var je=pe?wo:Zo,St=P[0].length,qt=P.length,li=qt,pi=Di(qt),Pi=1/0,on=[];li--;){var cn=P[li];li&&H&&(cn=Us(cn,nr(H))),Pi=ds(cn.length,Pi),pi[li]=!pe&&(H||St>=120&&cn.length>=120)?new j(li&&cn):n}cn=P[0];var yn=-1,$n=pi[0];e:for(;++yn<St&&on.length<Pi;){var xr=cn[yn],Qr=H?H(xr):xr;if(xr=pe||xr!==0?xr:0,!($n?Xr($n,Qr):je(on,Qr,pe))){for(li=qt;--li;){var Hs=pi[li];if(!(Hs?Xr(Hs,Qr):je(P[li],Qr,pe)))continue e}$n&&$n.push(Qr),on.push(xr)}}return on}function Ws(P,H,pe,je){return _o(P,function(St,qt,li){H(je,pe(St),qt,li)}),je}function Zl(P,H,pe){H=xh(H,P),P=ld(P,H);var je=P==null?P:P[ms(Tu(H))];return je==null?n:us(je,P,pe)}function cu(P){return zt(P)&&vs(P)==$i}function el(P){return zt(P)&&vs(P)==k}function vl(P){return zt(P)&&vs(P)==yi}function Pl(P,H,pe,je,St){return P===H?!0:P==null||H==null||!zt(P)&&!zt(H)?P!==P&&H!==H:hu(P,H,pe,je,Pl,St)}function hu(P,H,pe,je,St,qt){var li=f(P),pi=f(H),Pi=li?qi:Ul(P),on=pi?qi:Ul(H);Pi=Pi==$i?ti:Pi,on=on==$i?ti:on;var cn=Pi==ti,yn=on==ti,$n=Pi==on;if($n&&G(P)){if(!G(H))return!1;li=!0,cn=!1}if($n&&!cn)return qt||(qt=new Se),li||Rn(P)?J0(P,H,pe,je,St,qt):Sh(P,H,Pi,pe,je,St,qt);if(!(pe&et)){var xr=cn&&rs.call(P,"__wrapped__"),Qr=yn&&rs.call(H,"__wrapped__");if(xr||Qr){var Hs=xr?P.value():P,Wr=Qr?H.value():H;return qt||(qt=new Se),St(Hs,Wr,pe,je,qt)}}return $n?(qt||(qt=new Se),Tm(P,H,pe,je,St,qt)):!1}function sf(P){return zt(P)&&Ul(P)==_n}function Nh(P,H,pe,je){var St=pe.length,qt=St,li=!je;if(P==null)return!qt;for(P=Ln(P);St--;){var pi=pe[St];if(li&&pi[2]?pi[1]!==P[pi[0]]:!(pi[0]in P))return!1}for(;++St<qt;){pi=pe[St];var Pi=pi[0],on=P[Pi],cn=pi[1];if(li&&pi[2]){if(on===n&&!(Pi in P))return!1}else{var yn=new Se;if(je)var $n=je(on,cn,Pi,P,H,yn);if(!($n===n?Pl(cn,on,et|lt,je,yn):$n))return!1}}return!0}function Pa(P){if(!Pt(P)||Ep(P))return!1;var H=At(P)?Ma:oi;return H.test(th(P))}function dA(P){return zt(P)&&vs(P)==fi}function _h(P){return zt(P)&&Ul(P)==ln}function Vh(P){return zt(P)&&Mt(P.length)&&!!Ur[vs(P)]}function Ic(P){return typeof P=="function"?P:P==null?Fc:typeof P=="object"?f(P)?af(P[0],P[1]):Gh(P):B2(P)}function Uh(P){if(!CA(P))return Ou(P);var H=[];for(var pe in Ln(P))rs.call(P,pe)&&pe!="constructor"&&H.push(pe);return H}function o0(P){if(!Pt(P))return cl(P);var H=CA(P),pe=[];for(var je in P)je=="constructor"&&(H||!rs.call(P,je))||pe.push(je);return pe}function Xc(P,H){return P<H}function gp(P,H){var pe=-1,je=p(P)?Di(P.length):[];return er(P,function(St,qt,li){je[++pe]=H(St,qt,li)}),je}function Gh(P){var H=ed(P);return H.length==1&&H[0][2]?sd(H[0][0],H[0][1]):function(pe){return pe===P||Nh(pe,P,H)}}function af(P,H){return EA(P)&&p0(H)?sd(ms(P),H):function(pe){var je=Xl(pe,P);return je===n&&je===H?rA(pe,P):Pl(H,je,et|lt)}}function Yc(P,H,pe,je,St){P!==H&&ya(H,function(qt,li){if(St||(St=new Se),Pt(qt))_p(P,H,li,pe,Yc,je,St);else{var pi=je?je(TA(P,li),qt,li+"",P,H,St):n;pi===n&&(pi=qt),ri(P,li,pi)}},vo)}function _p(P,H,pe,je,St,qt,li){var pi=TA(P,pe),Pi=TA(H,pe),on=li.get(Pi);if(on){ri(P,pe,on);return}var cn=qt?qt(pi,Pi,pe+"",P,H,li):n,yn=cn===n;if(yn){var $n=f(Pi),xr=!$n&&G(Pi),Qr=!$n&&!xr&&Rn(Pi);cn=Pi,$n||xr||Qr?f(pi)?cn=pi:S(pi)?cn=xl(pi):xr?(yn=!1,cn=X0(Pi,!0)):Qr?(yn=!1,cn=ko(Pi,!0)):cn=[]:tn(Pi)||Oe(Pi)?(cn=pi,Oe(pi)?cn=na(pi):(!Pt(pi)||At(pi))&&(cn=id(Pi))):yn=!1}yn&&(li.set(Pi,cn),St(cn,Pi,je,qt,li),li.delete(Pi)),ri(P,pe,cn)}function of(P,H){var pe=P.length;if(pe)return H+=H<0?pe:0,kc(H,pe)?P[H]:n}function H0(P,H,pe){H.length?H=Us(H,function(qt){return f(qt)?function(li){return ts(li,qt.length===1?qt[0]:qt)}:qt}):H=[Fc];var je=-1;H=Us(H,nr(Ir()));var St=gp(P,function(qt,li,pi){var Pi=Us(H,function(on){return on(qt)});return{criteria:Pi,index:++je,value:qt}});return Ol(St,function(qt,li){return vp(qt,li,pe)})}function Ql(P,H){return Xu(P,H,function(pe,je){return rA(P,je)})}function Xu(P,H,pe){for(var je=-1,St=H.length,qt={};++je<St;){var li=H[je],pi=ts(P,li);pe(pi,li)&&Hh(qt,xh(li,P),pi)}return qt}function j0(P){return function(H){return ts(H,P)}}function yh(P,H,pe,je){var St=je?Dr:Yo,qt=-1,li=H.length,pi=P;for(P===H&&(H=xl(H)),pe&&(pi=Us(P,nr(pe)));++qt<li;)for(var Pi=0,on=H[qt],cn=pe?pe(on):on;(Pi=St(pi,cn,Pi,je))>-1;)pi!==P&&lu.call(pi,Pi,1),lu.call(P,Pi,1);return P}function $c(P,H){for(var pe=P?H.length:0,je=pe-1;pe--;){var St=H[pe];if(pe==je||St!==qt){var qt=St;kc(St)?lu.call(P,St,1):cf(P,St)}}return P}function pA(P,H){return P+_a(Jn()*(H-P+1))}function lf(P,H,pe,je){for(var St=-1,qt=_r(fs((H-P)/(pe||1)),0),li=Di(qt);qt--;)li[je?qt:++St]=P,P+=pe;return li}function l0(P,H){var pe="";if(!P||H<1||H>Ft)return pe;do H%2&&(pe+=P),H=_a(H/2),H&&(P+=P);while(H);return pe}function ps(P,H){return bu(od(P,H,Fc),P+"")}function Wl(P){return ct(Rc(P))}function qh(P,H){var pe=Rc(P);return Sf(pe,Ui(H,0,pe.length))}function Hh(P,H,pe,je){if(!Pt(P))return P;H=xh(H,P);for(var St=-1,qt=H.length,li=qt-1,pi=P;pi!=null&&++St<qt;){var Pi=ms(H[St]),on=pe;if(Pi==="__proto__"||Pi==="constructor"||Pi==="prototype")return P;if(St!=li){var cn=pi[Pi];on=je?je(cn,Pi,pi):n,on===n&&(on=Pt(cn)?cn:kc(H[St+1])?[]:{})}Xt(pi,Pi,on),pi=pi[Pi]}return P}var uf=zi?function(P,H){return zi.set(P,H),P}:Fc,mA=ta?function(P,H){return ta(P,"toString",{configurable:!0,enumerable:!1,value:b1(H),writable:!0})}:Fc;function Z0(P){return Sf(Rc(P))}function Dl(P,H,pe){var je=-1,St=P.length;H<0&&(H=-H>St?0:St+H),pe=pe>St?St:pe,pe<0&&(pe+=St),St=H>pe?0:pe-H>>>0,H>>>=0;for(var qt=Di(St);++je<St;)qt[je]=P[je+H];return qt}function Nu(P,H){var pe;return er(P,function(je,St,qt){return pe=H(je,St,qt),!pe}),!!pe}function gA(P,H,pe){var je=0,St=P==null?je:P.length;if(typeof H=="number"&&H===H&&St<=Gi){for(;je<St;){var qt=je+St>>>1,li=P[qt];li!==null&&!Dn(li)&&(pe?li<=H:li<H)?je=qt+1:St=qt}return St}return u0(P,H,Fc,pe)}function u0(P,H,pe,je){var St=0,qt=P==null?0:P.length;if(qt===0)return 0;H=pe(H);for(var li=H!==H,pi=H===null,Pi=Dn(H),on=H===n;St<qt;){var cn=_a((St+qt)/2),yn=pe(P[cn]),$n=yn!==n,xr=yn===null,Qr=yn===yn,Hs=Dn(yn);if(li)var Wr=je||Qr;else on?Wr=Qr&&(je||$n):pi?Wr=Qr&&$n&&(je||!xr):Pi?Wr=Qr&&$n&&!xr&&(je||!Hs):xr||Hs?Wr=!1:Wr=je?yn<=H:yn<H;Wr?St=cn+1:qt=cn}return ds(qt,ki)}function c0(P,H){for(var pe=-1,je=P.length,St=0,qt=[];++pe<je;){var li=P[pe],pi=H?H(li):li;if(!pe||!J(pi,Pi)){var Pi=pi;qt[St++]=li===0?0:li}}return qt}function yp(P){return typeof P=="number"?P:Dn(P)?ci:+P}function vu(P){if(typeof P=="string")return P;if(f(P))return Us(P,vu)+"";if(Dn(P))return z?z.call(P):"";var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function Kc(P,H,pe){var je=-1,St=Zo,qt=P.length,li=!0,pi=[],Pi=pi;if(pe)li=!1,St=wo;else if(qt>=g){var on=H?null:K0(P);if(on)return Yr(on);li=!1,St=Xr,Pi=new j}else Pi=H?[]:pi;e:for(;++je<qt;){var cn=P[je],yn=H?H(cn):cn;if(cn=pe||cn!==0?cn:0,li&&yn===yn){for(var $n=Pi.length;$n--;)if(Pi[$n]===yn)continue e;H&&Pi.push(yn),pi.push(cn)}else St(Pi,yn,pe)||(Pi!==pi&&Pi.push(yn),pi.push(cn))}return pi}function cf(P,H){return H=xh(H,P),P=ld(P,H),P==null||delete P[ms(Tu(H))]}function vh(P,H,pe,je){return Hh(P,H,pe(ts(P,H)),je)}function Ll(P,H,pe,je){for(var St=P.length,qt=je?St:-1;(je?qt--:++qt<St)&&H(P[qt],qt,P););return pe?Dl(P,je?0:qt,je?qt+1:St):Dl(P,je?qt+1:0,je?St:qt)}function h0(P,H){var pe=P;return pe instanceof be&&(pe=pe.value()),Wo(H,function(je,St){return St.func.apply(St.thisArg,Qo([je],St.args))},pe)}function Jc(P,H,pe){var je=P.length;if(je<2)return je?Kc(P[0]):[];for(var St=-1,qt=Di(je);++St<je;)for(var li=P[St],pi=-1;++pi<je;)pi!=St&&(qt[St]=yr(qt[St]||li,P[pi],H,pe));return Kc(Gr(qt,1),H,pe)}function jh(P,H,pe){for(var je=-1,St=P.length,qt=H.length,li={};++je<St;){var pi=je<qt?H[je]:n;pe(li,P[je],pi)}return li}function Q0(P){return S(P)?P:[]}function W0(P){return typeof P=="function"?P:Fc}function xh(P,H){return f(P)?P:EA(P,H)?[P]:cd(Kn(P))}var Em=ps;function Ec(P,H,pe){var je=P.length;return pe=pe===n?je:pe,!H&&pe>=je?P:Dl(P,H,pe)}var hf=ac||function(P){return Ls.clearTimeout(P)};function X0(P,H){if(H)return P.slice();var pe=P.length,je=Sn?Sn(pe):new P.constructor(pe);return P.copy(je),je}function oc(P){var H=new P.constructor(P.byteLength);return new Nl(H).set(new Nl(P)),H}function Af(P,H){var pe=H?oc(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.byteLength)}function _A(P){var H=new P.constructor(P.source,di.exec(P));return H.lastIndex=P.lastIndex,H}function Cm(P){return D?Ln(D.call(P)):{}}function ko(P,H){var pe=H?oc(P.buffer):P.buffer;return new P.constructor(pe,P.byteOffset,P.length)}function ff(P,H){if(P!==H){var pe=P!==n,je=P===null,St=P===P,qt=Dn(P),li=H!==n,pi=H===null,Pi=H===H,on=Dn(H);if(!pi&&!on&&!qt&&P>H||qt&&li&&Pi&&!pi&&!on||je&&li&&Pi||!pe&&Pi||!St)return 1;if(!je&&!qt&&!on&&P<H||on&&pe&&St&&!je&&!qt||pi&&pe&&St||!li&&St||!Pi)return-1}return 0}function vp(P,H,pe){for(var je=-1,St=P.criteria,qt=H.criteria,li=St.length,pi=pe.length;++je<li;){var Pi=ff(St[je],qt[je]);if(Pi){if(je>=pi)return Pi;var on=pe[je];return Pi*(on=="desc"?-1:1)}}return P.index-H.index}function df(P,H,pe,je){for(var St=-1,qt=P.length,li=pe.length,pi=-1,Pi=H.length,on=_r(qt-li,0),cn=Di(Pi+on),yn=!je;++pi<Pi;)cn[pi]=H[pi];for(;++St<li;)(yn||St<qt)&&(cn[pe[St]]=P[St]);for(;on--;)cn[pi++]=P[St++];return cn}function pf(P,H,pe,je){for(var St=-1,qt=P.length,li=-1,pi=pe.length,Pi=-1,on=H.length,cn=_r(qt-pi,0),yn=Di(cn+on),$n=!je;++St<cn;)yn[St]=P[St];for(var xr=St;++Pi<on;)yn[xr+Pi]=H[Pi];for(;++li<pi;)($n||St<qt)&&(yn[xr+pe[li]]=P[St++]);return yn}function xl(P,H){var pe=-1,je=P.length;for(H||(H=Di(je));++pe<je;)H[pe]=P[pe];return H}function lc(P,H,pe,je){var St=!pe;pe||(pe={});for(var qt=-1,li=H.length;++qt<li;){var pi=H[qt],Pi=je?je(pe[pi],P[pi],pi,pe,P):n;Pi===n&&(Pi=P[pi]),St?Ii(pe,pi,Pi):Xt(pe,pi,Pi)}return pe}function Zh(P,H){return lc(P,SA(P),H)}function mf(P,H){return lc(P,IA(P),H)}function Da(P,H){return function(pe,je){var St=f(pe)?sc:si,qt=H?H():{};return St(pe,P,Ir(je,2),qt)}}function uc(P){return ps(function(H,pe){var je=-1,St=pe.length,qt=St>1?pe[St-1]:n,li=St>2?pe[2]:n;for(qt=P.length>3&&typeof qt=="function"?(St--,qt):n,li&&xu(pe[0],pe[1],li)&&(qt=St<3?n:qt,St=1),H=Ln(H);++je<St;){var pi=pe[je];pi&&P(H,pi,je,qt)}return H})}function A0(P,H){return function(pe,je){if(pe==null)return pe;if(!p(pe))return P(pe,je);for(var St=pe.length,qt=H?St:-1,li=Ln(pe);(H?qt--:++qt<St)&&je(li[qt],qt,li)!==!1;);return pe}}function gf(P){return function(H,pe,je){for(var St=-1,qt=Ln(H),li=je(H),pi=li.length;pi--;){var Pi=li[P?pi:++St];if(pe(qt[Pi],Pi,qt)===!1)break}return H}}function _f(P,H,pe){var je=H&Ke,St=bh(P);function qt(){var li=this&&this!==Ls&&this instanceof qt?St:P;return li.apply(je?pe:this,arguments)}return qt}function Cc(P){return function(H){H=Kn(H);var pe=kl(H)?ea(H):n,je=pe?pe[0]:H.charAt(0),St=pe?Ec(pe,1).join(""):H.slice(1);return je[P]()+St}}function Qh(P){return function(H){return Wo(D2(P2(H).replace(An,"")),P,"")}}function bh(P){return function(){var H=arguments;switch(H.length){case 0:return new P;case 1:return new P(H[0]);case 2:return new P(H[0],H[1]);case 3:return new P(H[0],H[1],H[2]);case 4:return new P(H[0],H[1],H[2],H[3]);case 5:return new P(H[0],H[1],H[2],H[3],H[4]);case 6:return new P(H[0],H[1],H[2],H[3],H[4],H[5]);case 7:return new P(H[0],H[1],H[2],H[3],H[4],H[5],H[6])}var pe=ee(P.prototype),je=P.apply(pe,H);return Pt(je)?je:pe}}function yf(P,H,pe){var je=bh(P);function St(){for(var qt=arguments.length,li=Di(qt),pi=qt,Pi=$h(St);pi--;)li[pi]=arguments[pi];var on=qt<3&&li[0]!==Pi&&li[qt-1]!==Pi?[]:$o(li,Pi);if(qt-=on.length,qt<pe)return cc(P,H,Wh,St.placeholder,n,li,on,n,n,pe-qt);var cn=this&&this!==Ls&&this instanceof St?je:P;return us(cn,this,li)}return St}function yA(P){return function(H,pe,je){var St=Ln(H);if(!p(H)){var qt=Ir(pe,3);H=ao(H),pe=function(pi){return qt(St[pi],pi,St)}}var li=P(H,pe,je);return li>-1?St[qt?H[li]:li]:n}}function vA(P){return Tc(function(H){var pe=H.length,je=pe,St=ae.prototype.thru;for(P&&H.reverse();je--;){var qt=H[je];if(typeof qt!="function")throw new Yn(E);if(St&&!li&&wA(qt)=="wrapper")var li=new ae([],!0)}for(je=li?je:pe;++je<pe;){qt=H[je];var pi=wA(qt),Pi=pi=="wrapper"?Yh(qt):n;Pi&&d0(Pi[0])&&Pi[1]==(ni|kt|Rt|it)&&!Pi[4].length&&Pi[9]==1?li=li[wA(Pi[0])].apply(li,Pi[3]):li=qt.length==1&&d0(qt)?li[pi]():li.thru(qt)}return function(){var on=arguments,cn=on[0];if(li&&on.length==1&&f(cn))return li.plant(cn).value();for(var yn=0,$n=pe?H[yn].apply(this,on):cn;++yn<pe;)$n=H[yn].call(this,$n);return $n}})}function Wh(P,H,pe,je,St,qt,li,pi,Pi,on){var cn=H&ni,yn=H&Ke,$n=H&st,xr=H&(kt|Bt),Qr=H&xt,Hs=$n?n:bh(P);function Wr(){for(var sa=arguments.length,da=Di(sa),hh=sa;hh--;)da[hh]=arguments[hh];if(xr)var dc=$h(Wr),Ah=Zr(da,dc);if(je&&(da=df(da,je,St,xr)),qt&&(da=pf(da,qt,li,xr)),sa-=Ah,xr&&sa<on){var Kl=$o(da,dc);return cc(P,H,Wh,Wr.placeholder,pe,da,Kl,pi,Pi,on-sa)}var sA=yn?pe:this,qf=$n?sA[P]:P;return sa=da.length,pi?da=fa(da,pi):Qr&&sa>1&&da.reverse(),cn&&Pi<sa&&(da.length=Pi),this&&this!==Ls&&this instanceof Wr&&(qf=Hs||bh(qf)),qf.apply(sA,da)}return Wr}function Y0(P,H){return function(pe,je){return Ws(pe,P,H(je),{})}}function xA(P,H){return function(pe,je){var St;if(pe===n&&je===n)return H;if(pe!==n&&(St=pe),je!==n){if(St===n)return je;typeof pe=="string"||typeof je=="string"?(pe=vu(pe),je=vu(je)):(pe=yp(pe),je=yp(je)),St=P(pe,je)}return St}}function Xh(P){return Tc(function(H){return H=Us(H,nr(Ir())),ps(function(pe){var je=this;return P(H,function(St){return us(St,je,pe)})})})}function f0(P,H){H=H===n?" ":vu(H);var pe=H.length;if(pe<2)return pe?l0(H,P):H;var je=l0(H,fs(P/fo(H)));return kl(H)?Ec(ea(je),0,P).join(""):je.slice(0,P)}function $0(P,H,pe,je){var St=H&Ke,qt=bh(P);function li(){for(var pi=-1,Pi=arguments.length,on=-1,cn=je.length,yn=Di(cn+Pi),$n=this&&this!==Ls&&this instanceof li?qt:P;++on<cn;)yn[on]=je[on];for(;Pi--;)yn[on++]=arguments[++pi];return us($n,St?pe:this,yn)}return li}function xp(P){return function(H,pe,je){return je&&typeof je!="number"&&xu(H,pe,je)&&(pe=je=n),H=is(H),pe===n?(pe=H,H=0):pe=is(pe),je=je===n?H<pe?1:-1:is(je),lf(H,pe,je,P)}}function bA(P){return function(H,pe){return typeof H=="string"&&typeof pe=="string"||(H=tr(H),pe=tr(pe)),P(H,pe)}}function cc(P,H,pe,je,St,qt,li,pi,Pi,on){var cn=H&kt,yn=cn?li:n,$n=cn?n:li,xr=cn?qt:n,Qr=cn?n:qt;H|=cn?Rt:Ge,H&=~(cn?Ge:Rt),H&ut||(H&=~(Ke|st));var Hs=[P,H,St,xr,yn,Qr,$n,pi,Pi,on],Wr=pe.apply(n,Hs);return d0(P)&&ud(Wr,Hs),Wr.placeholder=je,Ya(Wr,P,H)}function vf(P){var H=Oi[P];return function(pe,je){if(pe=tr(pe),je=je==null?0:ds(Wn(je),292),je&&Fu(pe)){var St=(Kn(pe)+"e").split("e"),qt=H(St[0]+"e"+(+St[1]+je));return St=(Kn(qt)+"e").split("e"),+(St[0]+"e"+(+St[1]-je))}return H(pe)}}var K0=_s&&1/Yr(new _s([,-0]))[1]==Nt?function(P){return new _s(P)}:I1;function wh(P){return function(H){var pe=Ul(H);return pe==_n?Gs(H):pe==ln?mr(H):ks(H,P(H))}}function eh(P,H,pe,je,St,qt,li,pi){var Pi=H&st;if(!Pi&&typeof P!="function")throw new Yn(E);var on=je?je.length:0;if(on||(H&=~(Rt|Ge),je=St=n),li=li===n?li:_r(Wn(li),0),pi=pi===n?pi:Wn(pi),on-=St?St.length:0,H&Ge){var cn=je,yn=St;je=St=n}var $n=Pi?n:Yh(P),xr=[P,H,pe,je,St,cn,yn,qt,li,pi];if($n&&Eh(xr,$n),P=xr[0],H=xr[1],pe=xr[2],je=xr[3],St=xr[4],pi=xr[9]=xr[9]===n?Pi?0:P.length:_r(xr[9]-on,0),!pi&&H&(kt|Bt)&&(H&=~(kt|Bt)),!H||H==Ke)var Qr=_f(P,H,pe);else H==kt||H==Bt?Qr=yf(P,H,pi):(H==Rt||H==(Ke|Rt))&&!St.length?Qr=$0(P,H,pe,je):Qr=Wh.apply(n,xr);var Hs=$n?uf:ud;return Ya(Hs(Qr,xr),P,H)}function bp(P,H,pe,je){return P===n||J(P,As[pe])&&!rs.call(je,pe)?H:P}function wp(P,H,pe,je,St,qt){return Pt(P)&&Pt(H)&&(qt.set(H,P),Yc(P,H,n,wp,qt),qt.delete(H)),P}function Sp(P){return tn(P)?n:P}function J0(P,H,pe,je,St,qt){var li=pe&et,pi=P.length,Pi=H.length;if(pi!=Pi&&!(li&&Pi>pi))return!1;var on=qt.get(P),cn=qt.get(H);if(on&&cn)return on==H&&cn==P;var yn=-1,$n=!0,xr=pe&lt?new j:n;for(qt.set(P,H),qt.set(H,P);++yn<pi;){var Qr=P[yn],Hs=H[yn];if(je)var Wr=li?je(Hs,Qr,yn,H,P,qt):je(Qr,Hs,yn,P,H,qt);if(Wr!==n){if(Wr)continue;$n=!1;break}if(xr){if(!ba(H,function(sa,da){if(!Xr(xr,da)&&(Qr===sa||St(Qr,sa,pe,je,qt)))return xr.push(da)})){$n=!1;break}}else if(!(Qr===Hs||St(Qr,Hs,pe,je,qt))){$n=!1;break}}return qt.delete(P),qt.delete(H),$n}function Sh(P,H,pe,je,St,qt,li){switch(pe){case V:if(P.byteLength!=H.byteLength||P.byteOffset!=H.byteOffset)return!1;P=P.buffer,H=H.buffer;case k:return!(P.byteLength!=H.byteLength||!qt(new Nl(P),new Nl(H)));case Ti:case yi:case gi:return J(+P,+H);case Ei:return P.name==H.name&&P.message==H.message;case fi:case pr:return P==H+"";case _n:var pi=Gs;case ln:var Pi=je&et;if(pi||(pi=Yr),P.size!=H.size&&!Pi)return!1;var on=li.get(P);if(on)return on==H;je|=lt,li.set(P,H);var cn=J0(pi(P),pi(H),je,St,qt,li);return li.delete(P),cn;case On:if(D)return D.call(P)==D.call(H)}return!1}function Tm(P,H,pe,je,St,qt){var li=pe&et,pi=Ih(P),Pi=pi.length,on=Ih(H),cn=on.length;if(Pi!=cn&&!li)return!1;for(var yn=Pi;yn--;){var $n=pi[yn];if(!(li?$n in H:rs.call(H,$n)))return!1}var xr=qt.get(P),Qr=qt.get(H);if(xr&&Qr)return xr==H&&Qr==P;var Hs=!0;qt.set(P,H),qt.set(H,P);for(var Wr=li;++yn<Pi;){$n=pi[yn];var sa=P[$n],da=H[$n];if(je)var hh=li?je(da,sa,$n,H,P,qt):je(sa,da,$n,P,H,qt);if(!(hh===n?sa===da||St(sa,da,pe,je,qt):hh)){Hs=!1;break}Wr||(Wr=$n=="constructor")}if(Hs&&!Wr){var dc=P.constructor,Ah=H.constructor;dc!=Ah&&"constructor"in P&&"constructor"in H&&!(typeof dc=="function"&&dc instanceof dc&&typeof Ah=="function"&&Ah instanceof Ah)&&(Hs=!1)}return qt.delete(P),qt.delete(H),Hs}function Tc(P){return bu(od(P,n,hl),P+"")}function Ih(P){return Lr(P,ao,SA)}function xf(P){return Lr(P,vo,IA)}var Yh=zi?function(P){return zi.get(P)}:I1;function wA(P){for(var H=P.name+"",pe=ys[H],je=rs.call(ys,H)?pe.length:0;je--;){var St=pe[je],qt=St.func;if(qt==null||qt==P)return St.name}return H}function $h(P){var H=rs.call(R,"placeholder")?R:P;return H.placeholder}function Ir(){var P=R.iteratee||w1;return P=P===w1?Ic:P,arguments.length?P(arguments[0],arguments[1]):P}function bf(P,H){var pe=P.__data__;return Dm(H)?pe[typeof H=="string"?"string":"hash"]:pe.map}function ed(P){for(var H=ao(P),pe=H.length;pe--;){var je=H[pe],St=P[je];H[pe]=[je,St,p0(St)]}return H}function Kh(P,H){var pe=Eo(P,H);return Pa(pe)?pe:n}function wf(P){var H=rs.call(P,yl),pe=P[yl];try{P[yl]=n;var je=!0}catch{}var St=mo.call(P);return je&&(H?P[yl]=pe:delete P[yl]),St}var SA=Ko?function(P){return P==null?[]:(P=Ln(P),Ro(Ko(P),function(H){return _l.call(P,H)}))}:E1,IA=Ko?function(P){for(var H=[];P;)Qo(H,SA(P)),P=Hl(P);return H}:E1,Ul=vs;(Cu&&Ul(new Cu(new ArrayBuffer(1)))!=V||oa&&Ul(new oa)!=_n||_u&&Ul(_u.resolve())!=Mn||_s&&Ul(new _s)!=ln||Co&&Ul(new Co)!=wn)&&(Ul=function(P){var H=vs(P),pe=H==ti?P.constructor:n,je=pe?th(pe):"";if(je)switch(je){case yu:return V;case Oo:return _n;case cs:return Mn;case ul:return ln;case Ps:return wn}return H});function km(P,H,pe){for(var je=-1,St=pe.length;++je<St;){var qt=pe[je],li=qt.size;switch(qt.type){case"drop":P+=li;break;case"dropRight":H-=li;break;case"take":H=ds(H,P+li);break;case"takeRight":P=_r(P,H-li);break}}return{start:P,end:H}}function Mm(P){var H=P.match(Ue);return H?H[1].split(ht):[]}function td(P,H,pe){H=xh(H,P);for(var je=-1,St=H.length,qt=!1;++je<St;){var li=ms(H[je]);if(!(qt=P!=null&&pe(P,li)))break;P=P[li]}return qt||++je!=St?qt:(St=P==null?0:P.length,!!St&&Mt(St)&&kc(li,St)&&(f(P)||Oe(P)))}function Pm(P){var H=P.length,pe=new P.constructor(H);return H&&typeof P[0]=="string"&&rs.call(P,"index")&&(pe.index=P.index,pe.input=P.input),pe}function id(P){return typeof P.constructor=="function"&&!CA(P)?ee(Hl(P)):{}}function Jh(P,H,pe){var je=P.constructor;switch(H){case k:return oc(P);case Ti:case yi:return new je(+P);case V:return Af(P,pe);case $:case te:case Ae:case ve:case Ie:case Ee:case ze:case Qe:case He:return ko(P,pe);case _n:return new je;case gi:case pr:return new je(P);case fi:return _A(P);case ln:return new je;case On:return Cm(P)}}function nd(P,H){var pe=H.length;if(!pe)return P;var je=pe-1;return H[je]=(pe>1?"& ":"")+H[je],H=H.join(pe>2?", ":" "),P.replace(De,`{
/* [wrapped with `+H+`] */
`)}function Ip(P){return f(P)||Oe(P)||!!(Ru&&P&&P[Ru])}function kc(P,H){var pe=typeof P;return H=H??Ft,!!H&&(pe=="number"||pe!="symbol"&&vi.test(P))&&P>-1&&P%1==0&&P<H}function xu(P,H,pe){if(!Pt(pe))return!1;var je=typeof H;return(je=="number"?p(pe)&&kc(H,pe.length):je=="string"&&H in pe)?J(pe[H],P):!1}function EA(P,H){if(f(P))return!1;var pe=typeof P;return pe=="number"||pe=="symbol"||pe=="boolean"||P==null||Dn(P)?!0:ge.test(P)||!ye.test(P)||H!=null&&P in Ln(H)}function Dm(P){var H=typeof P;return H=="string"||H=="number"||H=="symbol"||H=="boolean"?P!=="__proto__":P===null}function d0(P){var H=wA(P),pe=R[H];if(typeof pe!="function"||!(H in be.prototype))return!1;if(P===pe)return!0;var je=Yh(pe);return!!je&&P===je[0]}function Ep(P){return!!zu&&zu in P}var rd=Xa?At:C1;function CA(P){var H=P&&P.constructor,pe=typeof H=="function"&&H.prototype||As;return P===pe}function p0(P){return P===P&&!Pt(P)}function sd(P,H){return function(pe){return pe==null?!1:pe[P]===H&&(H!==n||P in Ln(pe))}}function Lm(P){var H=kh(P,function(je){return pe.size===W&&pe.clear(),je}),pe=H.cache;return H}function Eh(P,H){var pe=P[1],je=H[1],St=pe|je,qt=St<(Ke|st|ni),li=je==ni&&pe==kt||je==ni&&pe==it&&P[7].length<=H[8]||je==(ni|it)&&H[7].length<=H[8]&&pe==kt;if(!(qt||li))return P;je&Ke&&(P[2]=H[2],St|=pe&Ke?0:ut);var pi=H[3];if(pi){var Pi=P[3];P[3]=Pi?df(Pi,pi,H[4]):pi,P[4]=Pi?$o(P[3],ce):H[4]}return pi=H[5],pi&&(Pi=P[5],P[5]=Pi?pf(Pi,pi,H[6]):pi,P[6]=Pi?$o(P[5],ce):H[6]),pi=H[7],pi&&(P[7]=pi),je&ni&&(P[8]=P[8]==null?H[8]:ds(P[8],H[8])),P[9]==null&&(P[9]=H[9]),P[0]=H[0],P[1]=St,P}function cl(P){var H=[];if(P!=null)for(var pe in Ln(P))H.push(pe);return H}function ad(P){return mo.call(P)}function od(P,H,pe){return H=_r(H===n?P.length-1:H,0),function(){for(var je=arguments,St=-1,qt=_r(je.length-H,0),li=Di(qt);++St<qt;)li[St]=je[H+St];St=-1;for(var pi=Di(H+1);++St<H;)pi[St]=je[St];return pi[H]=pe(li),us(P,this,pi)}}function ld(P,H){return H.length<2?P:ts(P,Dl(H,0,-1))}function fa(P,H){for(var pe=P.length,je=ds(H.length,pe),St=xl(P);je--;){var qt=H[je];P[je]=kc(qt,pe)?St[qt]:n}return P}function TA(P,H){if(!(H==="constructor"&&typeof P[H]=="function")&&H!="__proto__")return P[H]}var ud=m0(uf),kA=jl||function(P,H){return Ls.setTimeout(P,H)},bu=m0(mA);function Ya(P,H,pe){var je=H+"";return bu(P,nd(je,Cp(Mm(je),pe)))}function m0(P){var H=0,pe=0;return function(){var je=pn(),St=dt-(je-pe);if(pe=je,St>0){if(++H>=bt)return arguments[0]}else H=0;return P.apply(n,arguments)}}function Sf(P,H){var pe=-1,je=P.length,St=je-1;for(H=H===n?je:H;++pe<H;){var qt=pA(pe,St),li=P[qt];P[qt]=P[pe],P[pe]=li}return P.length=H,P}var cd=Lm(function(P){var H=[];return P.charCodeAt(0)===46&&H.push(""),P.replace(Pe,function(pe,je,St,qt){H.push(St?qt.replace(ke,"$1"):je||pe)}),H});function ms(P){if(typeof P=="string"||Dn(P))return P;var H=P+"";return H=="0"&&1/P==-Nt?"-0":H}function th(P){if(P!=null){try{return po.call(P)}catch{}try{return P+""}catch{}}return""}function Cp(P,H){return eo(rn,function(pe){var je="_."+pe[0];H&pe[1]&&!Zo(P,je)&&P.push(je)}),P.sort()}function hd(P){if(P instanceof be)return P.clone();var H=new ae(P.__wrapped__,P.__chain__);return H.__actions__=xl(P.__actions__),H.__index__=P.__index__,H.__values__=P.__values__,H}function ih(P,H,pe){(pe?xu(P,H,pe):H===n)?H=1:H=_r(Wn(H),0);var je=P==null?0:P.length;if(!je||H<1)return[];for(var St=0,qt=0,li=Di(fs(je/H));St<je;)li[qt++]=Dl(P,St,St+=H);return li}function MA(P){for(var H=-1,pe=P==null?0:P.length,je=0,St=[];++H<pe;){var qt=P[H];qt&&(St[je++]=qt)}return St}function Tp(){var P=arguments.length;if(!P)return[];for(var H=Di(P-1),pe=arguments[0],je=P;je--;)H[je-1]=arguments[je];return Qo(f(pe)?xl(pe):[pe],Gr(H,1))}var g0=ps(function(P,H){return S(P)?yr(P,Gr(H,1,S,!0)):[]}),PA=ps(function(P,H){var pe=Tu(H);return S(pe)&&(pe=n),S(P)?yr(P,Gr(H,1,S,!0),Ir(pe,2)):[]}),kp=ps(function(P,H){var pe=Tu(H);return S(pe)&&(pe=n),S(P)?yr(P,Gr(H,1,S,!0),n,pe):[]});function Ad(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),Dl(P,H<0?0:H,je)):[]}function fd(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),H=je-H,Dl(P,0,H<0?0:H)):[]}function Bm(P,H){return P&&P.length?Ll(P,Ir(H,3),!0,!0):[]}function zm(P,H){return P&&P.length?Ll(P,Ir(H,3),!0):[]}function Rm(P,H,pe,je){var St=P==null?0:P.length;return St?(pe&&typeof pe!="number"&&xu(P,H,pe)&&(pe=0,je=St),no(P,H,pe,je)):[]}function dd(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=pe==null?0:Wn(pe);return St<0&&(St=_r(je+St,0)),Xn(P,Ir(H,3),St)}function DA(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=je-1;return pe!==n&&(St=Wn(pe),St=pe<0?_r(je+St,0):ds(St,je-1)),Xn(P,Ir(H,3),St,!0)}function hl(P){var H=P==null?0:P.length;return H?Gr(P,1):[]}function _0(P){var H=P==null?0:P.length;return H?Gr(P,Nt):[]}function y0(P,H){var pe=P==null?0:P.length;return pe?(H=H===n?1:Wn(H),Gr(P,H)):[]}function Mc(P){for(var H=-1,pe=P==null?0:P.length,je={};++H<pe;){var St=P[H];je[St[0]]=St[1]}return je}function LA(P){return P&&P.length?P[0]:n}function If(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=pe==null?0:Wn(pe);return St<0&&(St=_r(je+St,0)),Yo(P,H,St)}function BA(P){var H=P==null?0:P.length;return H?Dl(P,0,-1):[]}var Ef=ps(function(P){var H=Us(P,Q0);return H.length&&H[0]===P[0]?Sc(H):[]}),Cf=ps(function(P){var H=Tu(P),pe=Us(P,Q0);return H===Tu(pe)?H=n:pe.pop(),pe.length&&pe[0]===P[0]?Sc(pe,Ir(H,2)):[]}),wu=ps(function(P){var H=Tu(P),pe=Us(P,Q0);return H=typeof H=="function"?H:n,H&&pe.pop(),pe.length&&pe[0]===P[0]?Sc(pe,n,H):[]});function v0(P,H){return P==null?"":uu.call(P,H)}function Tu(P){var H=P==null?0:P.length;return H?P[H-1]:n}function Ch(P,H,pe){var je=P==null?0:P.length;if(!je)return-1;var St=je;return pe!==n&&(St=Wn(pe),St=St<0?_r(je+St,0):ds(St,je-1)),H===H?ha(P,H,St):Xn(P,Za,St,!0)}function zA(P,H){return P&&P.length?of(P,Wn(H)):n}var RA=ps(nh);function nh(P,H){return P&&P.length&&H&&H.length?yh(P,H):P}function FA(P,H,pe){return P&&P.length&&H&&H.length?yh(P,H,Ir(pe,2)):P}function x0(P,H,pe){return P&&P.length&&H&&H.length?yh(P,H,n,pe):P}var Fm=Tc(function(P,H){var pe=P==null?0:P.length,je=Vi(P,H);return $c(P,Us(H,function(St){return kc(St,pe)?+St:St}).sort(ff)),je});function pd(P,H){var pe=[];if(!(P&&P.length))return pe;var je=-1,St=[],qt=P.length;for(H=Ir(H,3);++je<qt;){var li=P[je];H(li,je,P)&&(pe.push(li),St.push(je))}return $c(P,St),pe}function Th(P){return P==null?P:Jo.call(P)}function Pc(P,H,pe){var je=P==null?0:P.length;return je?(pe&&typeof pe!="number"&&xu(P,H,pe)?(H=0,pe=je):(H=H==null?0:Wn(H),pe=pe===n?je:Wn(pe)),Dl(P,H,pe)):[]}function rh(P,H){return gA(P,H)}function md(P,H,pe){return u0(P,H,Ir(pe,2))}function Tf(P,H){var pe=P==null?0:P.length;if(pe){var je=gA(P,H);if(je<pe&&J(P[je],H))return je}return-1}function gd(P,H){return gA(P,H,!0)}function Om(P,H,pe){return u0(P,H,Ir(pe,2),!0)}function b0(P,H){var pe=P==null?0:P.length;if(pe){var je=gA(P,H,!0)-1;if(J(P[je],H))return je}return-1}function w0(P){return P&&P.length?c0(P):[]}function kf(P,H){return P&&P.length?c0(P,Ir(H,2)):[]}function Yu(P){var H=P==null?0:P.length;return H?Dl(P,1,H):[]}function Dc(P,H,pe){return P&&P.length?(H=pe||H===n?1:Wn(H),Dl(P,0,H<0?0:H)):[]}function eA(P,H,pe){var je=P==null?0:P.length;return je?(H=pe||H===n?1:Wn(H),H=je-H,Dl(P,H<0?0:H,je)):[]}function S0(P,H){return P&&P.length?Ll(P,Ir(H,3),!1,!0):[]}function Mp(P,H){return P&&P.length?Ll(P,Ir(H,3)):[]}var _d=ps(function(P){return Kc(Gr(P,1,S,!0))}),Mf=ps(function(P){var H=Tu(P);return S(H)&&(H=n),Kc(Gr(P,1,S,!0),Ir(H,2))}),OA=ps(function(P){var H=Tu(P);return H=typeof H=="function"?H:n,Kc(Gr(P,1,S,!0),n,H)});function Pp(P){return P&&P.length?Kc(P):[]}function yd(P,H){return P&&P.length?Kc(P,Ir(H,2)):[]}function vd(P,H){return H=typeof H=="function"?H:n,P&&P.length?Kc(P,n,H):[]}function sh(P){if(!(P&&P.length))return[];var H=0;return P=Ro(P,function(pe){if(S(pe))return H=_r(pe.length,H),!0}),jr(H,function(pe){return Us(P,Ar(pe))})}function xd(P,H){if(!(P&&P.length))return[];var pe=sh(P);return H==null?pe:Us(pe,function(je){return us(H,n,je)})}var Dp=ps(function(P,H){return S(P)?yr(P,H):[]}),bd=ps(function(P){return Jc(Ro(P,S))}),Lp=ps(function(P){var H=Tu(P);return S(H)&&(H=n),Jc(Ro(P,S),Ir(H,2))}),NA=ps(function(P){var H=Tu(P);return H=typeof H=="function"?H:n,Jc(Ro(P,S),n,H)}),ah=ps(sh);function Bp(P,H){return jh(P||[],H||[],Xt)}function zp(P,H){return jh(P||[],H||[],Hh)}var wd=ps(function(P){var H=P.length,pe=H>1?P[H-1]:n;return pe=typeof pe=="function"?(P.pop(),pe):n,xd(P,pe)});function Sd(P){var H=R(P);return H.__chain__=!0,H}function Rp(P,H){return H(P),P}function VA(P,H){return H(P)}var I0=Tc(function(P){var H=P.length,pe=H?P[0]:0,je=this.__wrapped__,St=function(qt){return Vi(qt,P)};return H>1||this.__actions__.length||!(je instanceof be)||!kc(pe)?this.thru(St):(je=je.slice(pe,+pe+(H?1:0)),je.__actions__.push({func:VA,args:[St],thisArg:n}),new ae(je,this.__chain__).thru(function(qt){return H&&!qt.length&&qt.push(n),qt}))});function E0(){return Sd(this)}function Lc(){return new ae(this.value(),this.__chain__)}function Id(){this.__values__===n&&(this.__values__=ia(this.value()));var P=this.__index__>=this.__values__.length,H=P?n:this.__values__[this.__index__++];return{done:P,value:H}}function ku(){return this}function UA(P){for(var H,pe=this;pe instanceof le;){var je=hd(pe);je.__index__=0,je.__values__=n,H?St.__wrapped__=je:H=je;var St=je;pe=pe.__wrapped__}return St.__wrapped__=P,H}function Ed(){var P=this.__wrapped__;if(P instanceof be){var H=P;return this.__actions__.length&&(H=new be(this)),H=H.reverse(),H.__actions__.push({func:VA,args:[Th],thisArg:n}),new ae(H,this.__chain__)}return this.thru(Th)}function Cd(){return h0(this.__wrapped__,this.__actions__)}var Td=Da(function(P,H,pe){rs.call(P,pe)?++P[pe]:Ii(P,pe,1)});function C0(P,H,pe){var je=f(P)?ql:Aa;return pe&&xu(P,H,pe)&&(H=n),je(P,Ir(H,3))}function Pf(P,H){var pe=f(P)?Ro:ro;return pe(P,Ir(H,3))}var kd=yA(dd),Md=yA(DA);function Pd(P,H){return Gr(oh(P,H),1)}function bl(P,H){return Gr(oh(P,H),Nt)}function GA(P,H,pe){return pe=pe===n?1:Wn(pe),Gr(oh(P,H),pe)}function T0(P,H){var pe=f(P)?eo:er;return pe(P,Ir(H,3))}function k0(P,H){var pe=f(P)?to:Ia;return pe(P,Ir(H,3))}var Dd=Da(function(P,H,pe){rs.call(P,pe)?P[pe].push(H):Ii(P,pe,[H])});function Fp(P,H,pe,je){P=p(P)?P:Rc(P),pe=pe&&!je?Wn(pe):0;var St=P.length;return pe<0&&(pe=_r(St+pe,0)),Wi(P)?pe<=St&&P.indexOf(H,pe)>-1:!!St&&Yo(P,H,pe)>-1}var Op=ps(function(P,H,pe){var je=-1,St=typeof H=="function",qt=p(P)?Di(P.length):[];return er(P,function(li){qt[++je]=St?us(H,li,pe):Zl(li,H,pe)}),qt}),Ld=Da(function(P,H,pe){Ii(P,pe,H)});function oh(P,H){var pe=f(P)?Us:gp;return pe(P,Ir(H,3))}function Bd(P,H,pe,je){return P==null?[]:(f(H)||(H=H==null?[]:[H]),pe=je?n:pe,f(pe)||(pe=pe==null?[]:[pe]),H0(P,H,pe))}var hc=Da(function(P,H,pe){P[pe?0:1].push(H)},function(){return[[],[]]});function zd(P,H,pe){var je=f(P)?Wo:Nn,St=arguments.length<3;return je(P,Ir(H,4),pe,St,er)}function Df(P,H,pe){var je=f(P)?Xo:Nn,St=arguments.length<3;return je(P,Ir(H,4),pe,St,Ia)}function Lf(P,H){var pe=f(P)?Ro:ro;return pe(P,ZA(Ir(H,3)))}function Bf(P){var H=f(P)?ct:Wl;return H(P)}function Nm(P,H,pe){(pe?xu(P,H,pe):H===n)?H=1:H=Wn(H);var je=f(P)?Et:qh;return je(P,H)}function Vm(P){var H=f(P)?wt:Z0;return H(P)}function Np(P){if(P==null)return 0;if(p(P))return Wi(P)?fo(P):P.length;var H=Ul(P);return H==_n||H==ln?P.size:Uh(P).length}function qA(P,H,pe){var je=f(P)?ba:Nu;return pe&&xu(P,H,pe)&&(H=n),je(P,Ir(H,3))}var tA=ps(function(P,H){if(P==null)return[];var pe=H.length;return pe>1&&xu(P,H[0],H[1])?H=[]:pe>2&&xu(H[0],H[1],H[2])&&(H=[H[0]]),H0(P,Gr(H,1),[])}),Mo=Wu||function(){return Ls.Date.now()};function lh(P,H){if(typeof H!="function")throw new Yn(E);return P=Wn(P),function(){if(--P<1)return H.apply(this,arguments)}}function iA(P,H,pe){return H=pe?n:H,H=P&&H==null?P.length:H,eh(P,ni,n,n,n,n,H)}function HA(P,H){var pe;if(typeof H!="function")throw new Yn(E);return P=Wn(P),function(){return--P>0&&(pe=H.apply(this,arguments)),P<=1&&(H=n),pe}}var nA=ps(function(P,H,pe){var je=Ke;if(pe.length){var St=$o(pe,$h(nA));je|=Rt}return eh(P,je,H,pe,St)}),M0=ps(function(P,H,pe){var je=Ke|st;if(pe.length){var St=$o(pe,$h(M0));je|=Rt}return eh(H,je,P,pe,St)});function Vp(P,H,pe){H=pe?n:H;var je=eh(P,kt,n,n,n,n,n,H);return je.placeholder=Vp.placeholder,je}function Rd(P,H,pe){H=pe?n:H;var je=eh(P,Bt,n,n,n,n,n,H);return je.placeholder=Rd.placeholder,je}function Fd(P,H,pe){var je,St,qt,li,pi,Pi,on=0,cn=!1,yn=!1,$n=!0;if(typeof P!="function")throw new Yn(E);H=tr(H)||0,Pt(pe)&&(cn=!!pe.leading,yn="maxWait"in pe,qt=yn?_r(tr(pe.maxWait)||0,H):qt,$n="trailing"in pe?!!pe.trailing:$n);function xr(Kl){var sA=je,qf=St;return je=St=n,on=Kl,li=P.apply(qf,sA),li}function Qr(Kl){return on=Kl,pi=kA(sa,H),cn?xr(Kl):li}function Hs(Kl){var sA=Kl-Pi,qf=Kl-on,z2=H-sA;return yn?ds(z2,qt-qf):z2}function Wr(Kl){var sA=Kl-Pi,qf=Kl-on;return Pi===n||sA>=H||sA<0||yn&&qf>=qt}function sa(){var Kl=Mo();if(Wr(Kl))return da(Kl);pi=kA(sa,Hs(Kl))}function da(Kl){return pi=n,$n&&je?xr(Kl):(je=St=n,li)}function hh(){pi!==n&&hf(pi),on=0,je=Pi=St=pi=n}function dc(){return pi===n?li:da(Mo())}function Ah(){var Kl=Mo(),sA=Wr(Kl);if(je=arguments,St=this,Pi=Kl,sA){if(pi===n)return Qr(Pi);if(yn)return hf(pi),pi=kA(sa,H),xr(Pi)}return pi===n&&(pi=kA(sa,H)),li}return Ah.cancel=hh,Ah.flush=dc,Ah}var jA=ps(function(P,H){return Cn(P,1,H)}),Bl=ps(function(P,H,pe){return Cn(P,tr(H)||0,pe)});function Bc(P){return eh(P,xt)}function kh(P,H){if(typeof P!="function"||H!=null&&typeof H!="function")throw new Yn(E);var pe=function(){var je=arguments,St=H?H.apply(this,je):je[0],qt=pe.cache;if(qt.has(St))return qt.get(St);var li=P.apply(this,je);return pe.cache=qt.set(St,li)||qt,li};return pe.cache=new(kh.Cache||l),pe}kh.Cache=l;function ZA(P){if(typeof P!="function")throw new Yn(E);return function(){var H=arguments;switch(H.length){case 0:return!P.call(this);case 1:return!P.call(this,H[0]);case 2:return!P.call(this,H[0],H[1]);case 3:return!P.call(this,H[0],H[1],H[2])}return!P.apply(this,H)}}function QA(P){return HA(2,P)}var zf=Em(function(P,H){H=H.length==1&&f(H[0])?Us(H[0],nr(Ir())):Us(Gr(H,1),nr(Ir()));var pe=H.length;return ps(function(je){for(var St=-1,qt=ds(je.length,pe);++St<qt;)je[St]=H[St].call(this,je[St]);return us(P,this,je)})}),P0=ps(function(P,H){var pe=$o(H,$h(P0));return eh(P,Rt,n,H,pe)}),Rf=ps(function(P,H){var pe=$o(H,$h(Rf));return eh(P,Ge,n,H,pe)}),Ff=Tc(function(P,H){return eh(P,it,n,n,n,H)});function Of(P,H){if(typeof P!="function")throw new Yn(E);return H=H===n?H:Wn(H),ps(P,H)}function D0(P,H){if(typeof P!="function")throw new Yn(E);return H=H==null?0:_r(Wn(H),0),ps(function(pe){var je=pe[H],St=Ec(pe,0,H);return je&&Qo(St,je),us(P,this,St)})}function Nf(P,H,pe){var je=!0,St=!0;if(typeof P!="function")throw new Yn(E);return Pt(pe)&&(je="leading"in pe?!!pe.leading:je,St="trailing"in pe?!!pe.trailing:St),Fd(P,H,{leading:je,maxWait:H,trailing:St})}function Vf(P){return iA(P,1)}function Up(P,H){return P0(W0(H),P)}function m(){if(!arguments.length)return[];var P=arguments[0];return f(P)?P:[P]}function h(P){return an(P,we)}function x(P,H){return H=typeof H=="function"?H:n,an(P,we,H)}function M(P){return an(P,oe|we)}function q(P,H){return H=typeof H=="function"?H:n,an(P,oe|we,H)}function K(P,H){return H==null||Ji(P,H,ao(H))}function J(P,H){return P===H||P!==P&&H!==H}var me=bA(Qs),Ce=bA(function(P,H){return P>=H}),Oe=cu(function(){return arguments}())?cu:function(P){return zt(P)&&rs.call(P,"callee")&&!_l.call(P,"callee")},f=Di.isArray,u=El?nr(El):el;function p(P){return P!=null&&Mt(P.length)&&!At(P)}function S(P){return zt(P)&&p(P)}function L(P){return P===!0||P===!1||zt(P)&&vs(P)==Ti}var G=gu||C1,Q=Ha?nr(Ha):vl;function re(P){return zt(P)&&P.nodeType===1&&!tn(P)}function he(P){if(P==null)return!0;if(p(P)&&(f(P)||typeof P=="string"||typeof P.splice=="function"||G(P)||Rn(P)||Oe(P)))return!P.length;var H=Ul(P);if(H==_n||H==ln)return!P.size;if(CA(P))return!Uh(P).length;for(var pe in P)if(rs.call(P,pe))return!1;return!0}function _e(P,H){return Pl(P,H)}function Le(P,H,pe){pe=typeof pe=="function"?pe:n;var je=pe?pe(P,H):n;return je===n?Pl(P,H,n,pe):!!je}function qe(P){if(!zt(P))return!1;var H=vs(P);return H==Ei||H==hi||typeof P.message=="string"&&typeof P.name=="string"&&!tn(P)}function Je(P){return typeof P=="number"&&Fu(P)}function At(P){if(!Pt(P))return!1;var H=vs(P);return H==Li||H==fn||H==sn||H==ns}function gt(P){return typeof P=="number"&&P==Wn(P)}function Mt(P){return typeof P=="number"&&P>-1&&P%1==0&&P<=Ft}function Pt(P){var H=typeof P;return P!=null&&(H=="object"||H=="function")}function zt(P){return P!=null&&typeof P=="object"}var $t=Ta?nr(Ta):sf;function Ht(P,H){return P===H||Nh(P,H,ed(H))}function Zt(P,H,pe){return pe=typeof pe=="function"?pe:n,Nh(P,H,ed(H),pe)}function ui(P){return nn(P)&&P!=+P}function _i(P){if(rd(P))throw new ei(b);return Pa(P)}function Xi(P){return P===null}function xn(P){return P==null}function nn(P){return typeof P=="number"||zt(P)&&vs(P)==gi}function tn(P){if(!zt(P)||vs(P)!=ti)return!1;var H=Hl(P);if(H===null)return!0;var pe=rs.call(H,"constructor")&&H.constructor;return typeof pe=="function"&&pe instanceof pe&&po.call(pe)==Ml}var hn=ml?nr(ml):dA;function zn(P){return gt(P)&&P>=-Ft&&P<=Ft}var en=Cl?nr(Cl):_h;function Wi(P){return typeof P=="string"||!f(P)&&zt(P)&&vs(P)==pr}function Dn(P){return typeof P=="symbol"||zt(P)&&vs(P)==On}var Rn=pu?nr(pu):Vh;function dr(P){return P===n}function Fr(P){return zt(P)&&Ul(P)==wn}function qr(P){return zt(P)&&vs(P)==v}var zs=bA(Xc),Ea=bA(function(P,H){return P<=H});function ia(P){if(!P)return[];if(p(P))return Wi(P)?ea(P):xl(P);if(Vl&&P[Vl])return Js(P[Vl]());var H=Ul(P),pe=H==_n?Gs:H==ln?Yr:Rc;return pe(P)}function is(P){if(!P)return P===0?P:0;if(P=tr(P),P===Nt||P===-Nt){var H=P<0?-1:1;return H*Dt}return P===P?P:0}function Wn(P){var H=is(P),pe=H%1;return H===H?pe?H-pe:H:0}function xs(P){return P?Ui(Wn(P),0,bi):0}function tr(P){if(typeof P=="number")return P;if(Dn(P))return ci;if(Pt(P)){var H=typeof P.valueOf=="function"?P.valueOf():P;P=Pt(H)?H+"":H}if(typeof P!="string")return P===0?P:+P;P=Cr(P);var pe=Kt.test(P);return pe||Ri.test(P)?Pr(P.slice(2),pe?2:8):Ai.test(P)?ci:+P}function na(P){return lc(P,vo(P))}function Ds(P){return P?Ui(Wn(P),-Ft,Ft):P===0?P:0}function Kn(P){return P==null?"":vu(P)}var La=uc(function(P,H){if(CA(H)||p(H)){lc(H,ao(H),P);return}for(var pe in H)rs.call(H,pe)&&Xt(P,pe,H[pe])}),$a=uc(function(P,H){lc(H,vo(H),P)}),va=uc(function(P,H,pe,je){lc(H,vo(H),P,je)}),Uo=uc(function(P,H,pe,je){lc(H,ao(H),P,je)}),so=Tc(Vi);function ra(P,H){var pe=ee(P);return H==null?pe:ji(pe,H)}var br=ps(function(P,H){P=Ln(P);var pe=-1,je=H.length,St=je>2?H[2]:n;for(St&&xu(H[0],H[1],St)&&(je=1);++pe<je;)for(var qt=H[pe],li=vo(qt),pi=-1,Pi=li.length;++pi<Pi;){var on=li[pi],cn=P[on];(cn===n||J(cn,As[on])&&!rs.call(P,on))&&(P[on]=qt[on])}return P}),yo=ps(function(P){return P.push(n,wp),us(Hp,n,P)});function tl(P,H){return Sr(P,Ir(H,3),_o)}function il(P,H){return Sr(P,Ir(H,3),Zs)}function Mu(P,H){return P==null?P:ya(P,Ir(H,3),vo)}function Vu(P,H){return P==null?P:go(P,Ir(H,3),vo)}function zl(P,H){return P&&_o(P,Ir(H,3))}function zc(P,H){return P&&Zs(P,Ir(H,3))}function Uu(P){return P==null?[]:es(P,ao(P))}function Gu(P){return P==null?[]:es(P,vo(P))}function Xl(P,H,pe){var je=P==null?n:ts(P,H);return je===n?pe:je}function uh(P,H){return P!=null&&td(P,H,To)}function rA(P,H){return P!=null&&td(P,H,No)}var Gp=Y0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=mo.call(H)),P[H]=pe},b1(Fc)),Od=Y0(function(P,H,pe){H!=null&&typeof H.toString!="function"&&(H=mo.call(H)),rs.call(P,H)?P[H].push(pe):P[H]=[pe]},Ir),Nd=ps(Zl);function ao(P){return p(P)?ot(P):Uh(P)}function vo(P){return p(P)?ot(P,!0):o0(P)}function Uf(P,H){var pe={};return H=Ir(H,3),_o(P,function(je,St,qt){Ii(pe,H(je,St,qt),je)}),pe}function qp(P,H){var pe={};return H=Ir(H,3),_o(P,function(je,St,qt){Ii(pe,St,H(je,St,qt))}),pe}var Um=uc(function(P,H,pe){Yc(P,H,pe)}),Hp=uc(function(P,H,pe,je){Yc(P,H,pe,je)}),Gm=Tc(function(P,H){var pe={};if(P==null)return pe;var je=!1;H=Us(H,function(qt){return qt=xh(qt,P),je||(je=qt.length>1),qt}),lc(P,xf(P),pe),je&&(pe=an(pe,oe|fe|we,Sp));for(var St=H.length;St--;)cf(pe,H[St]);return pe});function Yl(P,H){return Mh(P,ZA(Ir(H)))}var qu=Tc(function(P,H){return P==null?{}:Ql(P,H)});function Mh(P,H){if(P==null)return{};var pe=Us(xf(P),function(je){return[je]});return H=Ir(H),Xu(P,pe,function(je,St){return H(je,St[0])})}function Ac(P,H,pe){H=xh(H,P);var je=-1,St=H.length;for(St||(St=1,P=n);++je<St;){var qt=P==null?n:P[ms(H[je])];qt===n&&(je=St,qt=pe),P=At(qt)?qt.call(P):qt}return P}function $l(P,H,pe){return P==null?P:Hh(P,H,pe)}function Hu(P,H,pe,je){return je=typeof je=="function"?je:n,P==null?P:Hh(P,H,pe,je)}var qm=wh(ao),Rg=wh(vo);function y1(P,H,pe){var je=f(P),St=je||G(P)||Rn(P);if(H=Ir(H,4),pe==null){var qt=P&&P.constructor;St?pe=je?new qt:[]:Pt(P)?pe=At(qt)?ee(Hl(P)):{}:pe={}}return(St?eo:_o)(P,function(li,pi,Pi){return H(pe,li,pi,Pi)}),pe}function v1(P,H){return P==null?!0:cf(P,H)}function Su(P,H,pe){return P==null?P:vh(P,H,W0(pe))}function fc(P,H,pe,je){return je=typeof je=="function"?je:n,P==null?P:vh(P,H,W0(pe),je)}function Rc(P){return P==null?[]:al(P,ao(P))}function ch(P){return P==null?[]:al(P,vo(P))}function Gf(P,H,pe){return pe===n&&(pe=H,H=n),pe!==n&&(pe=tr(pe),pe=pe===pe?pe:0),H!==n&&(H=tr(H),H=H===H?H:0),Ui(tr(P),H,pe)}function Ph(P,H,pe){return H=is(H),pe===n?(pe=H,H=0):pe=is(pe),P=tr(P),Vo(P,H,pe)}function L5(P,H,pe){if(pe&&typeof pe!="boolean"&&xu(P,H,pe)&&(H=pe=n),pe===n&&(typeof H=="boolean"?(pe=H,H=n):typeof P=="boolean"&&(pe=P,P=n)),P===n&&H===n?(P=0,H=1):(P=is(P),H===n?(H=P,P=0):H=is(H)),P>H){var je=P;P=H,H=je}if(pe||P%1||H%1){var St=Jn();return ds(P+St*(H-P+Ks("1e-"+((St+"").length-1))),H)}return pA(P,H)}var B5=Qh(function(P,H,pe){return H=H.toLowerCase(),P+(pe?M2(H):H)});function M2(P){return x1(Kn(P).toLowerCase())}function P2(P){return P=Kn(P),P&&P.replace(wi,hs).replace(rr,"")}function z5(P,H,pe){P=Kn(P),H=vu(H);var je=P.length;pe=pe===n?je:Ui(Wn(pe),0,je);var St=pe;return pe-=H.length,pe>=0&&P.slice(pe,St)==H}function R5(P){return P=Kn(P),P&&ne.test(P)?P.replace(Me,wa):P}function F5(P){return P=Kn(P),P&&Ne.test(P)?P.replace(Fe,"\\$&"):P}var O5=Qh(function(P,H,pe){return P+(pe?"-":"")+H.toLowerCase()}),N5=Qh(function(P,H,pe){return P+(pe?" ":"")+H.toLowerCase()}),V5=Cc("toLowerCase");function U5(P,H,pe){P=Kn(P),H=Wn(H);var je=H?fo(P):0;if(!H||je>=H)return P;var St=(H-je)/2;return f0(_a(St),pe)+P+f0(fs(St),pe)}function G5(P,H,pe){P=Kn(P),H=Wn(H);var je=H?fo(P):0;return H&&je<H?P+f0(H-je,pe):P}function q5(P,H,pe){P=Kn(P),H=Wn(H);var je=H?fo(P):0;return H&&je<H?f0(H-je,pe)+P:P}function H5(P,H,pe){return pe||H==null?H=0:H&&(H=+H),Gn(Kn(P).replace(Xe,""),H||0)}function j5(P,H,pe){return(pe?xu(P,H,pe):H===n)?H=1:H=Wn(H),l0(Kn(P),H)}function Z5(){var P=arguments,H=Kn(P[0]);return P.length<3?H:H.replace(P[1],P[2])}var Q5=Qh(function(P,H,pe){return P+(pe?"_":"")+H.toLowerCase()});function W5(P,H,pe){return pe&&typeof pe!="number"&&xu(P,H,pe)&&(H=pe=n),pe=pe===n?bi:pe>>>0,pe?(P=Kn(P),P&&(typeof H=="string"||H!=null&&!hn(H))&&(H=vu(H),!H&&kl(P))?Ec(ea(P),0,pe):P.split(H,pe)):[]}var X5=Qh(function(P,H,pe){return P+(pe?" ":"")+x1(H)});function Y5(P,H,pe){return P=Kn(P),pe=pe==null?0:Ui(Wn(pe),0,P.length),H=vu(H),P.slice(pe,pe+H.length)==H}function $5(P,H,pe){var je=R.templateSettings;pe&&xu(P,H,pe)&&(H=n),P=Kn(P),H=va({},H,je,bp);var St=va({},H.imports,je.imports,bp),qt=ao(St),li=al(St,qt),pi,Pi,on=0,cn=H.interpolate||Yt,yn="__p += '",$n=Un((H.escape||Yt).source+"|"+cn.source+"|"+(cn===de?ai:Yt).source+"|"+(H.evaluate||Yt).source+"|$","g"),xr="//# sourceURL="+(rs.call(H,"sourceURL")?(H.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pl+"]")+`
`;P.replace($n,function(Wr,sa,da,hh,dc,Ah){return da||(da=hh),yn+=P.slice(on,Ah).replace(vn,Tl),sa&&(pi=!0,yn+=`' +
__e(`+sa+`) +
'`),dc&&(Pi=!0,yn+=`';
`+dc+`;
__p += '`),da&&(yn+=`' +
((__t = (`+da+`)) == null ? '' : __t) +
'`),on=Ah+Wr.length,Wr}),yn+=`';
`;var Qr=rs.call(H,"variable")&&H.variable;if(!Qr)yn=`with (obj) {
`+yn+`
}
`;else if(o.test(Qr))throw new ei(a);yn=(Pi?yn.replace(Ze,""):yn).replace(Ve,"$1").replace(ft,"$1;"),yn="function("+(Qr||"obj")+`) {
`+(Qr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(pi?", __e = _.escape":"")+(Pi?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+yn+`return __p
}`;var Hs=L2(function(){return xi(qt,xr+"return "+yn).apply(n,li)});if(Hs.source=yn,qe(Hs))throw Hs;return Hs}function K5(P){return Kn(P).toLowerCase()}function J5(P){return Kn(P).toUpperCase()}function eI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return Cr(P);if(!P||!(H=vu(H)))return P;var je=ea(P),St=ea(H),qt=Io(je,St),li=ol(je,St)+1;return Ec(je,qt,li).join("")}function tI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.slice(0,Sa(P)+1);if(!P||!(H=vu(H)))return P;var je=ea(P),St=ol(je,ea(H))+1;return Ec(je,0,St).join("")}function iI(P,H,pe){if(P=Kn(P),P&&(pe||H===n))return P.replace(Xe,"");if(!P||!(H=vu(H)))return P;var je=ea(P),St=Io(je,ea(H));return Ec(je,St).join("")}function nI(P,H){var pe=_t,je=mt;if(Pt(H)){var St="separator"in H?H.separator:St;pe="length"in H?Wn(H.length):pe,je="omission"in H?vu(H.omission):je}P=Kn(P);var qt=P.length;if(kl(P)){var li=ea(P);qt=li.length}if(pe>=qt)return P;var pi=pe-fo(je);if(pi<1)return je;var Pi=li?Ec(li,0,pi).join(""):P.slice(0,pi);if(St===n)return Pi+je;if(li&&(pi+=Pi.length-pi),hn(St)){if(P.slice(pi).search(St)){var on,cn=Pi;for(St.global||(St=Un(St.source,Kn(di.exec(St))+"g")),St.lastIndex=0;on=St.exec(cn);)var yn=on.index;Pi=Pi.slice(0,yn===n?pi:yn)}}else if(P.indexOf(vu(St),pi)!=pi){var $n=Pi.lastIndexOf(St);$n>-1&&(Pi=Pi.slice(0,$n))}return Pi+je}function rI(P){return P=Kn(P),P&&se.test(P)?P.replace(rt,ka):P}var sI=Qh(function(P,H,pe){return P+(pe?" ":"")+H.toUpperCase()}),x1=Cc("toUpperCase");function D2(P,H,pe){return P=Kn(P),H=pe?n:H,H===n?Ao(P)?ou(P):mu(P):P.match(H)||[]}var L2=ps(function(P,H){try{return us(P,n,H)}catch(pe){return qe(pe)?pe:new ei(pe)}}),aI=Tc(function(P,H){return eo(H,function(pe){pe=ms(pe),Ii(P,pe,nA(P[pe],P))}),P});function oI(P){var H=P==null?0:P.length,pe=Ir();return P=H?Us(P,function(je){if(typeof je[1]!="function")throw new Yn(E);return[pe(je[0]),je[1]]}):[],ps(function(je){for(var St=-1;++St<H;){var qt=P[St];if(us(qt[0],this,je))return us(qt[1],this,je)}})}function lI(P){return Bn(an(P,oe))}function b1(P){return function(){return P}}function uI(P,H){return P==null||P!==P?H:P}var cI=vA(),hI=vA(!0);function Fc(P){return P}function w1(P){return Ic(typeof P=="function"?P:an(P,oe))}function AI(P){return Gh(an(P,oe))}function fI(P,H){return af(P,an(H,oe))}var dI=ps(function(P,H){return function(pe){return Zl(pe,P,H)}}),pI=ps(function(P,H){return function(pe){return Zl(P,pe,H)}});function S1(P,H,pe){var je=ao(H),St=es(H,je);pe==null&&!(Pt(H)&&(St.length||!je.length))&&(pe=H,H=P,P=this,St=es(H,ao(H)));var qt=!(Pt(pe)&&"chain"in pe)||!!pe.chain,li=At(P);return eo(St,function(pi){var Pi=H[pi];P[pi]=Pi,li&&(P.prototype[pi]=function(){var on=this.__chain__;if(qt||on){var cn=P(this.__wrapped__),yn=cn.__actions__=xl(this.__actions__);return yn.push({func:Pi,args:arguments,thisArg:P}),cn.__chain__=on,cn}return Pi.apply(P,Qo([this.value()],arguments))})}),P}function mI(){return Ls._===this&&(Ls._=Pn),this}function I1(){}function gI(P){return P=Wn(P),ps(function(H){return of(H,P)})}var _I=Xh(Us),yI=Xh(ql),vI=Xh(ba);function B2(P){return EA(P)?Ar(ms(P)):j0(P)}function xI(P){return function(H){return P==null?n:ts(P,H)}}var bI=xp(),wI=xp(!0);function E1(){return[]}function C1(){return!1}function SI(){return{}}function II(){return""}function EI(){return!0}function CI(P,H){if(P=Wn(P),P<1||P>Ft)return[];var pe=bi,je=ds(P,bi);H=Ir(H),P-=bi;for(var St=jr(je,H);++pe<P;)H(pe);return St}function TI(P){return f(P)?Us(P,ms):Dn(P)?[P]:xl(cd(Kn(P)))}function kI(P){var H=++Qu;return Kn(P)+H}var MI=xA(function(P,H){return P+H},0),PI=vf("ceil"),DI=xA(function(P,H){return P/H},1),LI=vf("floor");function BI(P){return P&&P.length?Bs(P,Fc,Qs):n}function zI(P,H){return P&&P.length?Bs(P,Ir(H,2),Qs):n}function RI(P){return Kr(P,Fc)}function FI(P,H){return Kr(P,Ir(H,2))}function OI(P){return P&&P.length?Bs(P,Fc,Xc):n}function NI(P,H){return P&&P.length?Bs(P,Ir(H,2),Xc):n}var VI=xA(function(P,H){return P*H},1),UI=vf("round"),GI=xA(function(P,H){return P-H},0);function qI(P){return P&&P.length?Jr(P,Fc):0}function HI(P,H){return P&&P.length?Jr(P,Ir(H,2)):0}return R.after=lh,R.ary=iA,R.assign=La,R.assignIn=$a,R.assignInWith=va,R.assignWith=Uo,R.at=so,R.before=HA,R.bind=nA,R.bindAll=aI,R.bindKey=M0,R.castArray=m,R.chain=Sd,R.chunk=ih,R.compact=MA,R.concat=Tp,R.cond=oI,R.conforms=lI,R.constant=b1,R.countBy=Td,R.create=ra,R.curry=Vp,R.curryRight=Rd,R.debounce=Fd,R.defaults=br,R.defaultsDeep=yo,R.defer=jA,R.delay=Bl,R.difference=g0,R.differenceBy=PA,R.differenceWith=kp,R.drop=Ad,R.dropRight=fd,R.dropRightWhile=Bm,R.dropWhile=zm,R.fill=Rm,R.filter=Pf,R.flatMap=Pd,R.flatMapDeep=bl,R.flatMapDepth=GA,R.flatten=hl,R.flattenDeep=_0,R.flattenDepth=y0,R.flip=Bc,R.flow=cI,R.flowRight=hI,R.fromPairs=Mc,R.functions=Uu,R.functionsIn=Gu,R.groupBy=Dd,R.initial=BA,R.intersection=Ef,R.intersectionBy=Cf,R.intersectionWith=wu,R.invert=Gp,R.invertBy=Od,R.invokeMap=Op,R.iteratee=w1,R.keyBy=Ld,R.keys=ao,R.keysIn=vo,R.map=oh,R.mapKeys=Uf,R.mapValues=qp,R.matches=AI,R.matchesProperty=fI,R.memoize=kh,R.merge=Um,R.mergeWith=Hp,R.method=dI,R.methodOf=pI,R.mixin=S1,R.negate=ZA,R.nthArg=gI,R.omit=Gm,R.omitBy=Yl,R.once=QA,R.orderBy=Bd,R.over=_I,R.overArgs=zf,R.overEvery=yI,R.overSome=vI,R.partial=P0,R.partialRight=Rf,R.partition=hc,R.pick=qu,R.pickBy=Mh,R.property=B2,R.propertyOf=xI,R.pull=RA,R.pullAll=nh,R.pullAllBy=FA,R.pullAllWith=x0,R.pullAt=Fm,R.range=bI,R.rangeRight=wI,R.rearg=Ff,R.reject=Lf,R.remove=pd,R.rest=Of,R.reverse=Th,R.sampleSize=Nm,R.set=$l,R.setWith=Hu,R.shuffle=Vm,R.slice=Pc,R.sortBy=tA,R.sortedUniq=w0,R.sortedUniqBy=kf,R.split=W5,R.spread=D0,R.tail=Yu,R.take=Dc,R.takeRight=eA,R.takeRightWhile=S0,R.takeWhile=Mp,R.tap=Rp,R.throttle=Nf,R.thru=VA,R.toArray=ia,R.toPairs=qm,R.toPairsIn=Rg,R.toPath=TI,R.toPlainObject=na,R.transform=y1,R.unary=Vf,R.union=_d,R.unionBy=Mf,R.unionWith=OA,R.uniq=Pp,R.uniqBy=yd,R.uniqWith=vd,R.unset=v1,R.unzip=sh,R.unzipWith=xd,R.update=Su,R.updateWith=fc,R.values=Rc,R.valuesIn=ch,R.without=Dp,R.words=D2,R.wrap=Up,R.xor=bd,R.xorBy=Lp,R.xorWith=NA,R.zip=ah,R.zipObject=Bp,R.zipObjectDeep=zp,R.zipWith=wd,R.entries=qm,R.entriesIn=Rg,R.extend=$a,R.extendWith=va,S1(R,R),R.add=MI,R.attempt=L2,R.camelCase=B5,R.capitalize=M2,R.ceil=PI,R.clamp=Gf,R.clone=h,R.cloneDeep=M,R.cloneDeepWith=q,R.cloneWith=x,R.conformsTo=K,R.deburr=P2,R.defaultTo=uI,R.divide=DI,R.endsWith=z5,R.eq=J,R.escape=R5,R.escapeRegExp=F5,R.every=C0,R.find=kd,R.findIndex=dd,R.findKey=tl,R.findLast=Md,R.findLastIndex=DA,R.findLastKey=il,R.floor=LI,R.forEach=T0,R.forEachRight=k0,R.forIn=Mu,R.forInRight=Vu,R.forOwn=zl,R.forOwnRight=zc,R.get=Xl,R.gt=me,R.gte=Ce,R.has=uh,R.hasIn=rA,R.head=LA,R.identity=Fc,R.includes=Fp,R.indexOf=If,R.inRange=Ph,R.invoke=Nd,R.isArguments=Oe,R.isArray=f,R.isArrayBuffer=u,R.isArrayLike=p,R.isArrayLikeObject=S,R.isBoolean=L,R.isBuffer=G,R.isDate=Q,R.isElement=re,R.isEmpty=he,R.isEqual=_e,R.isEqualWith=Le,R.isError=qe,R.isFinite=Je,R.isFunction=At,R.isInteger=gt,R.isLength=Mt,R.isMap=$t,R.isMatch=Ht,R.isMatchWith=Zt,R.isNaN=ui,R.isNative=_i,R.isNil=xn,R.isNull=Xi,R.isNumber=nn,R.isObject=Pt,R.isObjectLike=zt,R.isPlainObject=tn,R.isRegExp=hn,R.isSafeInteger=zn,R.isSet=en,R.isString=Wi,R.isSymbol=Dn,R.isTypedArray=Rn,R.isUndefined=dr,R.isWeakMap=Fr,R.isWeakSet=qr,R.join=v0,R.kebabCase=O5,R.last=Tu,R.lastIndexOf=Ch,R.lowerCase=N5,R.lowerFirst=V5,R.lt=zs,R.lte=Ea,R.max=BI,R.maxBy=zI,R.mean=RI,R.meanBy=FI,R.min=OI,R.minBy=NI,R.stubArray=E1,R.stubFalse=C1,R.stubObject=SI,R.stubString=II,R.stubTrue=EI,R.multiply=VI,R.nth=zA,R.noConflict=mI,R.noop=I1,R.now=Mo,R.pad=U5,R.padEnd=G5,R.padStart=q5,R.parseInt=H5,R.random=L5,R.reduce=zd,R.reduceRight=Df,R.repeat=j5,R.replace=Z5,R.result=Ac,R.round=UI,R.runInContext=mi,R.sample=Bf,R.size=Np,R.snakeCase=Q5,R.some=qA,R.sortedIndex=rh,R.sortedIndexBy=md,R.sortedIndexOf=Tf,R.sortedLastIndex=gd,R.sortedLastIndexBy=Om,R.sortedLastIndexOf=b0,R.startCase=X5,R.startsWith=Y5,R.subtract=GI,R.sum=qI,R.sumBy=HI,R.template=$5,R.times=CI,R.toFinite=is,R.toInteger=Wn,R.toLength=xs,R.toLower=K5,R.toNumber=tr,R.toSafeInteger=Ds,R.toString=Kn,R.toUpper=J5,R.trim=eI,R.trimEnd=tI,R.trimStart=iI,R.truncate=nI,R.unescape=rI,R.uniqueId=kI,R.upperCase=sI,R.upperFirst=x1,R.each=T0,R.eachRight=k0,R.first=LA,S1(R,function(){var P={};return _o(R,function(H,pe){rs.call(R.prototype,pe)||(P[pe]=H)}),P}(),{chain:!1}),R.VERSION=c,eo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(P){R[P].placeholder=R}),eo(["drop","take"],function(P,H){be.prototype[P]=function(pe){pe=pe===n?1:_r(Wn(pe),0);var je=this.__filtered__&&!H?new be(this):this.clone();return je.__filtered__?je.__takeCount__=ds(pe,je.__takeCount__):je.__views__.push({size:ds(pe,bi),type:P+(je.__dir__<0?"Right":"")}),je},be.prototype[P+"Right"]=function(pe){return this.reverse()[P](pe).reverse()}}),eo(["filter","map","takeWhile"],function(P,H){var pe=H+1,je=pe==nt||pe==at;be.prototype[P]=function(St){var qt=this.clone();return qt.__iteratees__.push({iteratee:Ir(St,3),type:pe}),qt.__filtered__=qt.__filtered__||je,qt}}),eo(["head","last"],function(P,H){var pe="take"+(H?"Right":"");be.prototype[P]=function(){return this[pe](1).value()[0]}}),eo(["initial","tail"],function(P,H){var pe="drop"+(H?"":"Right");be.prototype[P]=function(){return this.__filtered__?new be(this):this[pe](1)}}),be.prototype.compact=function(){return this.filter(Fc)},be.prototype.find=function(P){return this.filter(P).head()},be.prototype.findLast=function(P){return this.reverse().find(P)},be.prototype.invokeMap=ps(function(P,H){return typeof P=="function"?new be(this):this.map(function(pe){return Zl(pe,P,H)})}),be.prototype.reject=function(P){return this.filter(ZA(Ir(P)))},be.prototype.slice=function(P,H){P=Wn(P);var pe=this;return pe.__filtered__&&(P>0||H<0)?new be(pe):(P<0?pe=pe.takeRight(-P):P&&(pe=pe.drop(P)),H!==n&&(H=Wn(H),pe=H<0?pe.dropRight(-H):pe.take(H-P)),pe)},be.prototype.takeRightWhile=function(P){return this.reverse().takeWhile(P).reverse()},be.prototype.toArray=function(){return this.take(bi)},_o(be.prototype,function(P,H){var pe=/^(?:filter|find|map|reject)|While$/.test(H),je=/^(?:head|last)$/.test(H),St=R[je?"take"+(H=="last"?"Right":""):H],qt=je||/^find/.test(H);St&&(R.prototype[H]=function(){var li=this.__wrapped__,pi=je?[1]:arguments,Pi=li instanceof be,on=pi[0],cn=Pi||f(li),yn=function(sa){var da=St.apply(R,Qo([sa],pi));return je&&$n?da[0]:da};cn&&pe&&typeof on=="function"&&on.length!=1&&(Pi=cn=!1);var $n=this.__chain__,xr=!!this.__actions__.length,Qr=qt&&!$n,Hs=Pi&&!xr;if(!qt&&cn){li=Hs?li:new be(this);var Wr=P.apply(li,pi);return Wr.__actions__.push({func:VA,args:[yn],thisArg:n}),new ae(Wr,$n)}return Qr&&Hs?P.apply(this,pi):(Wr=this.thru(yn),Qr?je?Wr.value()[0]:Wr.value():Wr)})}),eo(["pop","push","shift","sort","splice","unshift"],function(P){var H=qs[P],pe=/^(?:push|sort|unshift)$/.test(P)?"tap":"thru",je=/^(?:pop|shift)$/.test(P);R.prototype[P]=function(){var St=arguments;if(je&&!this.__chain__){var qt=this.value();return H.apply(f(qt)?qt:[],St)}return this[pe](function(li){return H.apply(f(li)?li:[],St)})}}),_o(be.prototype,function(P,H){var pe=R[H];if(pe){var je=pe.name+"";rs.call(ys,je)||(ys[je]=[]),ys[je].push({name:H,func:pe})}}),ys[Wh(n,st).name]=[{name:"wrapper",func:n}],be.prototype.clone=We,be.prototype.reverse=yt,be.prototype.value=Ct,R.prototype.at=I0,R.prototype.chain=E0,R.prototype.commit=Lc,R.prototype.next=Id,R.prototype.plant=UA,R.prototype.reverse=Ed,R.prototype.toJSON=R.prototype.valueOf=R.prototype.value=Cd,R.prototype.first=R.prototype.head,Vl&&(R.prototype[Vl]=ku),R},io=gl();ho?((ho.exports=io)._=io,Il._=io):Ls._=io}).call(Kf)})(U_,U_.exports);var bR=U_.exports;function US(e,t,n){let c=[e],g=[],b,E,a;for(;e=c.pop();)if(!(n&&n(e))&&(g.push(e),b=e.children,b))for(E=0,a=b.length;E<a;++E)c.push(b[E]);for(;e=g.pop();)t(e);return e}function wR(e,t,n){let c=[e],g,b;for(;e=c.pop();)if(!(n&&n(e))&&(t(e),g=e.children,g))for(b=g.length-1;b>=0;--b)c.push(g[b]);return e}function SR(e,t,n){let c,g=[e],b,E,a;do for(c=g.reverse(),g=[];e=c.pop();)if(!(n&&n(e))&&(t(e),b=e.children,b))for(E=0,a=b.length;E<a;++E)g.push(b[E]);while(g.length);return e}function IR(e){return US(e,function(c){c.children&&(c.children[0].data.multiway_parent=c,c.children[1].data.multiway_parent=c.parent)}),bR.map(e.descendants(),c=>{let g=c.data.multiway_parent,b="unknown";return g&&(b=g.data.name),{source:c.data.multiway_parent,target:c,name:b}})}function ER(){let e=this.branch_length;return e?pv(this.nodes.descendants(),function(t){return!t.parent||!op(e(t))}):!1}function CR(){let e=this.branch_length;return mc(this.nodes.descendants(),t=>e(t))}function yv(e,t){let n=e.data;if("attribute"in n&&n.attribute&&n.attribute.length){t>0&&(n.attribute=String(t));let c=parseFloat(n.attribute);if(!isNaN(c))return Math.max(0,c)}if(n.name=="root")return 0;console.warn("Undefined branch length at "+n.name+"!")}function TR(e){return arguments.length?(this.branch_length_accessor=e||yv,this):this.branch_length_accessor}function kR(e){let t=this.branch_length,n=mc(this.nodes.descendants(),function(E){return t(E)?t(E):null});const c=p2(n),g=TS(n);let b=function(E){return(E-g)/(c-g)};return jc(this.nodes.descendants(),E=>{let a=t(E);a&&t(E,b(a))}),this}function MR(e){let t=this.branch_length;return jc(this.nodes.descendants(),n=>{let c=t(n);c&&t(n,e(c))}),this}function PR(e){return arguments.length?(this.nodeLabel=e,this):this.nodeLabel}function DR(e,t){if(!(e instanceof $d))throw new Error("node needs to be an instance of a d3.hierarchy node!");let n=this.nodes.copy();if(t=t!==void 0?t:.5,e.parent){var c=$d({name:"new_root"});c.children=[e.copy()],c.data.__mapped_bl=void 0,n.each(W=>{W.data.__mapped_bl=this.branch_length_accessor(W)}),this.setBranchLength(W=>W.data.__mapped_bl);let b=e,E=e.parent,a=void 0,U=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl*t;a=E.data.__mapped_bl,E.data.__mapped_bl=e.data.__mapped_bl===void 0?void 0:e.data.__mapped_bl-U,e.data.__mapped_bl=U;var g;if(E.parent){for(c.children.push(E);E.parent;){g=E.children.indexOf(b),E.parent.parent?E.children.splice(g,1,E.parent):E.children.splice(g,1);let W=E.parent.data.__mapped_bl;W!==void 0&&(E.parent.data.__mapped_bl=a,a=W),b=E,E=E.parent}g=E.children.indexOf(b),E.children.splice(g,1)}else g=E.children.indexOf(b),E.children.splice(g,1),a=E.data.__mapped_bl,b=c;if(E.children.length==1)a&&(E.children[0].data.__mapped_bl+=a),b.children=b.children.concat(E.children);else{let W=new $d({name:"__reroot_top_clade",__mapped_bl:a});vg(c.children[0],e),W.data.__mapped_bl=a,W.children=E.children.map(function(ce){return ce.parent=W,ce}),W.parent=b,b.children.push(W)}}if(this.update(c),this.traverse_and_compute(b=>{jc(b.children,E=>{E.parent=b})},"pre-order"),!op(this.display)){let b=this.display.options;Al(this.display.container).select("svg").remove();let E=this.display.selection_attribute_name;delete this.display;let a=this.render(b);a.selectionLabel(E),a.update(),Al(a.container).node().appendChild(a.show()),Al(this.display.container).dispatch("reroot")}return this}function LR(e,t){if(e=e||"attribute",t=t||"y_scaled","parent"in this){let n=parseFloat(this[e]);this[t]=this.parent[t]+(isNaN(n)?.1:n)}else this[t]=0;return this[t]}function BR(e){let t=[];for(;e;)t.push(e),e=e.parent;return t}const zR=Object.freeze(Object.defineProperty({__proto__:null,pathToRoot:BR,reroot:DR,rootpath:LR},Symbol.toStringTag,{value:"Module"}));function e0(e){return e.y}function Jd(e){return e.x}function G_(e,t,n){return{x:n+e*Math.sin(t),y:n+e*Math.cos(t)}}function Qb(e,t,n,c,g,b){e.radius=t*(e.radius+n),e.angle=2*Math.PI*e.x*g[0]/b[0];let E=G_(e.radius,e.angle,c);return e.x=E.x,e.y=E.y,e}function Wb(e,t){var n=G_(t[0].radius,t[0].angle,e),c=G_(t[0].radius,t[1].angle,e);return"M "+e0(n)+","+Jd(n)+" A "+t[0].radius+","+t[0].radius+" 0,0, "+(t[1].angle>t[0].angle?1:0)+" "+e0(c)+","+Jd(c)+" L "+e0(t[1])+","+Jd(t[1])}function RR(e,t,n){var c=G_(e.target.radius+(e.source.radius-e.target.radius)*t,e.target.angle,n);return{x:e0(c),y:Jd(c)}}var Xb=uv().x(function(e){return e0(e)}).y(function(e){return Jd(e)}).curve(Iz);function Yb(e,t){return{x:e0(e.target)+(e0(e.source)-e0(e.target))*t,y:Jd(e.target)}}function _2(e){return e.tag||!1}function y2(e,t){return e[t]||!1}const qo={"tree-container":"phylotree-container","tree-scale-bar":"tree-scale-bar",node:"node","internal-node":"internal-node","tagged-node":"node-tagged","selected-node":"node-selected","collapsed-node":"node-collapsed","root-node":"root-node",branch:"branch","selected-branch":"branch-selected","tagged-branch":"branch-tagged","tree-selection-brush":"tree-selection-brush","branch-tracer":"branch-tracer",clade:"clade",node_text:"phylotree-node-text"};function FR(e){return arguments.length?(this.options["internal-names"]=e,this):this.options["internal-names"]}function OR(e){return arguments.length?(this.options["is-radial"]=e,this):this.options["is-radial"]}function NR(e){return arguments.length?(this.options["align-tips"]=e,this):this.options["align-tips"]}function VR(e){return this.options["draw-size-bubbles"]&&this.options["bubble-styler"]?this.options["bubble-styler"](e):this.options["draw-size-bubbles"]?this.relative_nodeSpan(e)*this.scales[0]*.25:0}function UR(e){return this.options["is-radial"]?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function GR(e){return arguments.length?(this.layout_listener_handler=e,this):this.layout_listener_handler}function qR(e){return arguments.length?(this.selection_attribute_name=e,this.syncEdgeLabels(),this):this.selection_attribute_name}function l_(e){return arguments.length?(typeof e=="string"&&e=="equal"?l_=function(t){return 1}:l_=e,this):l_}var vv={all:e=>!0,none:e=>!1,"all-leaf-nodes":e=>Sl(e.target),"all-internal-nodes":e=>!Sl(e.target)};function HR(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const jR=Object.freeze(Object.defineProperty({__proto__:null,alignTips:NR,css_classes:qo,internalNames:FR,layoutHandler:GR,nodeBubbleSize:VR,get nodeSpan(){return l_},predefined_selecters:vv,radial:OR,selectionCallback:HR,selectionLabel:qR,shiftTip:UR},Symbol.toStringTag,{value:"Module"}));function ZR(e){return this.radial()?[(e.text_align=="end"?-1:1)*(this.radius_pad_for_bubbles-e.radius),0]:this.options["right-to-left"]?[this.right_most_leaf-e.screen_x,0]:[this.right_most_leaf-e.screen_x,0]}function QR(e,t,n){e=Al(e);var c=Sl(t);c&&(e=e.attr("data-node-name",t.data.name));var g=e.selectAll("text").data([t]),b=e.selectAll("line");if(c||this.showInternalName(t)&&!lp(t))if(g=g.enter().append("text").classed(this.css_classes.node_text,!0).merge(g).on("click",a=>{this.handle_node_click(t,a)}).attr("dy",a=>this.shown_font_size*.33).text(a=>this.options["show-labels"]?this._nodeLabel(a):"").style("font-size",a=>this.ensure_size_is_in_px(this.shown_font_size)),this.radial()?g=g.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)+this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)).attr("text-anchor",a=>a.text_align):g=g.attr("text-anchor","start").attr("transform",a=>this.options.layout=="right-to-left"?this.d3PhylotreeSvgTranslate([-20,0]):this.d3PhylotreeSvgTranslate(this.alignTips()?this.shiftTip(a):null)),this.alignTips()?(b=b.data([t]),n?b=b.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(b).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("x2",0).attr("y1",0).attr("y2",0).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)).attr("x2",a=>this.options.layout=="right-to-left"?a.screen_x:this.shiftTip(a)[0]).attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)):(b=b.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(b).attr("x1",a=>(a.text_align=="end"?-1:1)*this.nodeBubbleSize(t)).attr("y2",0).attr("y1",0).attr("x2",a=>this.shiftTip(a)[0]),b.attr("transform",a=>this.d3PhylotreeSvgRotate(a.text_angle)))):b.remove(),this.options["draw-size-bubbles"]){var E=this.nodeBubbleSize(t);e.selectAll("circle").data([E]).enter().append("circle").attr("r",function(U){return U}),this.shown_font_size>=5&&(g=g.attr("dx",U=>(U.text_align=="end"?-1:1)*((this.alignTips()?0:E)+this.shown_font_size*.33)))}else this.shown_font_size>=5&&(g=g.attr("dx",a=>(a.text_align=="end"?-1:1)*this.shown_font_size*.33));if(!c){let a=e.selectAll("circle").data([t]).enter().append("circle"),U=this.node_circle_size()(t);U>0?a.merge(a).attr("r",W=>Math.min(this.shown_font_size*.75,U)).on("click",W=>{this.handle_node_click(t,W)}):a.remove()}return this.node_styler&&this.node_styler(e,t),t}function WR(){let e=this.phylotree.nodes.descendants();for(let t=e.length-1;t>=0;t-=1)Sl(e[t])?e[t].hasHiddenNodes=e[t].notshown:e[t].hasHiddenNodes=e[t].children.reduce(function(n,c){return c.notshown||n},!1);return this}function XR(e){const t=this.internalNames();return t?typeof t=="function"?t(e):t:!1}function YR(e){return arguments.length?(typeof e=="string"&&e=="equal"?this.nodeSpan=function(t){return 1}:this.nodeSpan=e,this):this.nodeSpan}function $R(e){let t=qo[Sl(e)?"node":"internal-node"];return _2(e)&&(t+=" "+qo["tagged-node"]),y2(e,this.selection_attribute_name)&&(t+=" "+qo["selected-node"]),e.parent||(t+=" "+qo["root-node"]),(lp(e)||v2(e))&&(t+=" "+qo["collapsed-node"]),t}function xv(e){return!(e.hidden||e.notshown)}function GS(e){return e.notshown}function v2(e){return e.hasHiddenNodes||!1}function lp(e){return e.collapsed||!1}function qS(e){return[e.node,e["internal-node"],e["collapsed-node"],e["tagged-node"],e["root-node"]].reduce(function(t,n,c,g){return t+="g."+n+(c<g.length-1?",":"")},"")}function KR(e,t){this.phylotree.clearInternalNodes(t);for(var n=this.phylotree.nodes.descendants().length-1;n>=0;n--){var c=this.phylotree.nodes.descendants()[n];Sl(c)||y2(c,this.selection_attribute_name)||(c[this.selection_attribute_name]=e(c.children))}this.modifySelection((g,b)=>Sl(g.target)?g.target[this.selection_attribute_name]:g.target[this.selection_attribute_name])}function HS(e){return e=e.data,Sl(e)?e.name||"":this.showInternalName(e)?e.name:""}function JR(e){return arguments.length?(this._nodeLabel=e||HS,this.update(),this):this._nodeLabel}const eF=Object.freeze(Object.defineProperty({__proto__:null,defNodeLabel:HS,drawNode:QR,hasHiddenNodes:v2,internalLabel:KR,isNodeCollapsed:lp,nodeCssSelectors:qS,nodeLabel:JR,nodeNotshown:GS,nodeSpan:YR,nodeVisible:xv,reclassNode:$R,shiftTip:ZR,showInternalName:XR,updateHasHiddenNodes:WR},Symbol.toStringTag,{value:"Module"}));function jS(e){return[e.clade].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function tF(e){let t=this.svg.selectAll("."+this.css_classes["tree-container"]);var n=0;let c=t.selectAll(jS(this.css_classes)).data(this.phylotree.nodes.descendants().filter(lp),function(E){return E.id||(E.id=++n)}),g=function(){},b=void 0;this.radial()?(g=uv().curve(zb).y(function(E){return E[0]}).x(function(E){return E[1]}),b=function(E,a,U,W,ce){return a?[U.screen_y+(E[0]-W)/50,U.screen_x+(E[1]-ce)/50]:[U.screen_y,U.screen_x]}):(g=uv().y(function(E){return E[0]}).x(function(E){return E[1]}).curve(zb),b=function(E,a,U,W,ce){return a?[U.screen_y+(E[0]-W)/50,U.screen_x+(E[1]-ce)/50]:[U.screen_y,U.screen_x]}),c.exit().each(function(E){E.collapsed_clade=null}).remove(),e?c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(E){if(E.collapsed_clade)return E.collapsed_clade;let a=E.collapsed[0][0],U=E.collapsed[0][1];return g(E.collapsed.map(function(W,ce){return b(W,ce,E,a,U)}))}).attr("d",function(E){return E.collapsed_clade=g(E.collapsed)}):c.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(c).attr("d",function(E){return E.collapsed_clade?E.collapsed_clade:E.collapsed_clade=g(E.collapsed)})}const iF=Object.freeze(Object.defineProperty({__proto__:null,cladeCssSelectors:jS,updateCollapsedClades:tF},Symbol.toStringTag,{value:"Module"}));function nF(e,t,n){e=Al(e),e=e.attr("class",E=>this.reclassEdge(E)).on("click",E=>{this.modifySelection([t.target],this.selection_attribute_name),this.update()});let c=this.draw_branch([t.source,t.target]);n&&e.datum().existing_path&&(e=e.attr("d",function(E){return E.existing_path})),e=e.attr("d",c),t.existing_path=c;var g=this.phylotree.branch_length_accessor(t.target);if(g!==void 0){var b=e.selectAll("title");b.empty()&&(b=e.append("title")),b.text("Length = "+g)}else e.selectAll("title").remove();return this.edge_styler&&this.edge_styler(e,t,n),this.phylotree}function rF(e){let t=qo.branch;return _2(e)&&(t+=" "+qo["tagged-branch"]),y2(e,this.selection_attribute_name)&&(t+=" "+qo["selected-branch"]),t}function sF(){this.links.forEach(e=>{e.target.data.annotation&&(e.target[e.target.data.annotation]=e.target.data.annotation)})}function aF(){if(this.links.forEach(e=>{e[this.selection_attribute_name]=e.target[this.selection_attribute_name]||!1,e.tag=e.target.tag||!1}),this.countHandler()){let e={};e[this.selection_attribute_name]=this.links.reduce((t,n)=>t+(n[this.selection_attribute_name]?1:0),0),e.tagged=this.links.reduce(function(t,n){return t+(_2(n)?1:0)},0),this.countUpdate(this,e,this.countHandler())}}function bv(e){return!(e.target.hidden||e.target.notshown)}function wv(e){return[e.branch,e["selected-branch"],e["tagged-branch"]].reduce(function(t,n,c,g){return t+="path."+n+(c<g.length-1?",":"")},"")}function oF(e,t){return this.edge_placer(e,t)}const lF=Object.freeze(Object.defineProperty({__proto__:null,drawEdge:nF,edgeCssSelectors:wv,edgeVisible:bv,initializeEdgeLabels:sF,placeAlongAnEdge:oF,reclassEdge:rF,syncEdgeLabels:aF},Symbol.toStringTag,{value:"Module"}));let l1="phylotree.event";function uF(e){if(e.collapsed){e.collapsed=!1;let t=function(n){Sl(n)||n.collapsed||n.children.forEach(t),n.hidden=!1};t(e)}else e.collapsed=!0;return this.placenodes(),this}function cF(e,t,n){let c=this.size;if(this.radial()){let g=this.pad_width(),b=this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0;c=[c[1]+2*g,c[0]+2*g+b],t&&t.selectAll("."+qo["tree-container"]).attr("transform","translate ("+g+","+(g+b)+")")}else c=[c[0]+(this.options["top-bottom-spacing"]!="fit-to-size"?this.pad_height():0),c[1]+(this.options["left-right-spacing"]!="fit-to-size"?this.pad_width():0)];return t&&(n&&(t=t.transition(100)),t.attr("height",c[0]).attr("width",c[1])),this.size=c,c}function hF(e,t){t=t||"y_scaled",t in this&&(this[t]*=e)}function Sv(e){var t=new CustomEvent(l1,{detail:["refresh",e]});document.dispatchEvent(t)}function ZS(e,t){var n=new CustomEvent(l1,{detail:["countUpdate",t,e.countHandler()]});document.dispatchEvent(n)}function AF(e){var t=new CustomEvent(l1,{detail:["layout",e,e.layoutHandler()]});document.dispatchEvent(t)}function QS(e){switch(e.detail[0]){case"refresh":e.detail[1].refresh();break;case"countUpdate":e.detail[2](e.detail[1]);break;case"layout":e.detail[2](e.detail[1])}return!0}function WS(){document.addEventListener(l1,QS,!1)}function fF(e){return e&&(e[0]!==null||e[1]!==null)?"translate ("+(e[0]!==null?e[0]:0)+","+(e[1]!==null?e[1]:0)+") ":""}function dF(e){return e!==null?"rotate ("+e+") ":""}const pF=Object.freeze(Object.defineProperty({__proto__:null,countUpdate:ZS,d3PhylotreeAddEventListener:WS,d3PhylotreeEventListener:QS,d3PhylotreeSvgRotate:dF,d3PhylotreeSvgTranslate:fF,d3PhylotreeTriggerLayout:AF,rescale:hF,resizeSvg:cF,toggleCollapse:uF,triggerRefresh:Sv},Symbol.toStringTag,{value:"Module"}));let $b="d3_layout_phylotree_context_menu";function mF(e,t,n,c,g){let b=Al(t).select("#"+$b);if(b.empty()&&(b=Al(t).append("div").attr("id",$b).attr("class","dropdown-menu").attr("role","menu")),b.selectAll("a").remove(),b.selectAll("h6").remove(),b.selectAll("div").remove(),e){if(!V_([!!e.menu_items,c.hide,c.selectable,c.collapsible])||!c["show-menu"])return;Sl(e)||(c.collapsible&&(b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(lp(e)?"Expand Subtree":"Collapse Subtree").on("click",W=>{b.style("display","none"),this.toggleCollapse(e).update()}),c.selectable&&(b.append("div").attr("class","dropdown-divider"),b.append("h6").attr("class","dropdown-header").text("Toggle selection"))),c.selectable&&(b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All descendant branches").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0))}),b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All terminal branches").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!1))}),b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All internal branches").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!1,!0))}))),e.parent&&(c.selectable&&(b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Incident branch").on("click",function(W){b.style("display","none"),n.modifySelection([e])}),b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Path to root").on("click",W=>{b.style("display","none"),this.modifySelection(this.phylotree.pathToRoot(e))}),(c.reroot||c.hide)&&b.append("div").attr("class","dropdown-divider")),c.reroot&&b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Reroot on this node").on("click",W=>{b.style("display","none"),this.phylotree.reroot(e),this.update()}),c.hide&&b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Hide this "+(Sl(e)?"node":"subtree")).on("click",W=>{b.style("display","none"),this.modifySelection([e],"notshown",!0,!0).updateHasHiddenNodes().update()})),v2(e)&&b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Show all descendant nodes").on("click",function(W){b.style("display","none"),n.modifySelection(n.selectAllDescendants(e,!0,!0),"notshown",!0,!0,"false").updateHasHiddenNodes().update()});var E=[];if("menu_items"in e&&typeof e.menu_items=="object"&&e.menu_items.forEach(function(W){W.length==3&&(!W[2]||W[2](e))&&E.push([W[0],W[1]])}),E.length){const W=[c.hide,c.selectable,c.collapsible];V_(W)&&b.append("div").attr("class","dropdown-divider"),E.forEach(function(ce){b.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(ce[0](e)).on("click",tf(ce[1],e))})}let U=document.querySelector(t).getBoundingClientRect();b.style("position","absolute").style("left",""+(g.clientX-U.x+12)+"px").style("top",""+(g.clientY-U.y)+"px").style("display","block")}else b.style("display","none")}function gF(e,t,n,c){"menu_items"in e||(e.menu_items=[]),e.menu_items.some(function(g){return g[0]==t&&g[1]==n&&g[2]==c})||e.menu_items.push([t,n,c])}function _F(e,t,n,c,g){if(t=t||this.selection_attribute_name,g=g||"toggle",this.options["restricted-selectable"].length)if(KA(du(vv),e))e=vv[e];else return;if((this.options["restricted-selectable"]||this.options.selectable)&&!this.options["binary-selectable"]){var b=!1;typeof e=="function"?this.links.forEach(function(a){let U=e(a);a[t]=a[t]||!1,a[t]!=U&&(a[t]=U,b=!0,a.target[t]=U)}):(e.forEach(function(a){var U;switch(g){case"true":U=!0;break;case"false":U=!1;break;default:U=!a[t];break}a[t]!=U&&(a[t]=U,b=!0)}),this.links.forEach(function(a){a[t]=a.target[t]}));var E;b&&(c||Sv(this),this.countHandler&&(E={},E[t]=this.links.reduce(function(a,U){return a+(U[t]?1:0)},0),ZS(this,E,this.countHandler)),n&&this.placenodes())}else this.options["binary-selectable"]&&(typeof e=="function"?this.links.forEach(function(a){var U=e(a);a[t]=a[t]||!1,a[t]!=U&&(a[t]=U,b=!0,a.target[t]=U),this.options["attribute-list"].forEach(function(W){W!=t&&a[t]===!0&&(a[W]=!1,a.target[W]=!1)})}):(e.forEach(function(a){var U;U=!a[t],a[t]!=U&&(a[t]=U,b=!0)}),this.links.forEach(function(a){a[t]=a.target[t],this.options["attribute-list"].forEach(function(U){U!=t&&a[t]!==!0&&(a[U]=!1,a.target[U]=!1)})})),b&&(c||Sv(this),this.countHandler()&&(E={},E[t]=this.links.reduce(function(a,U){return a+(U[t]?1:0)},0),this.countUpdate(this,E,this.countHandler())),n&&this.placenodes()));return this.selectionCallback&&t!="tag"&&this.selectionCallback(this.getSelection()),this.refresh(),this.update(),this}function yF(){return this.nodes.filter(e=>e[this.selection_attribute_name])}function vF(e,t,n){let c=[];function g(b){Sl(b)?t&&b!=e&&c.push(b):(n&&b!=e&&c.push(b),b.children.forEach(g))}return g(e),c}function xF(e){return e?(this.selectionCallback=e,this):this.selectionCallback}const bF=Object.freeze(Object.defineProperty({__proto__:null,addCustomMenu:gF,getSelection:yF,modifySelection:_F,nodeDropdownMenu:mF,selectAllDescendants:vF,selectionCallback:xF},Symbol.toStringTag,{value:"Module"}));function Kb(e){return function(){return e}}class mp{constructor(t,n={}){this.css_classes=qo,this.phylotree=t,this.container=n.container,this.separation=function(g,b){return 0},this._nodeLabel=this.defNodeLabel,this.svg=null,this.selectionCallback=null,this.scales=[1,1],this.size=[1,1],this.fixed_width=[14,30],this.scale_bar_font_size=12,this.draw_branch=Xb,this.draw_scale_bar=null,this.edge_placer=Yb,this.count_listener_handler=function(){},this.layout_listener_handler=function(){},this.node_styler=void 0,this.edge_styler=void 0,this.selection_attribute_name="selected",this.right_most_leaf=0,this.label_width=0,this.radial_center=0,this.radius=1,this.radius_pad_for_bubbles=0,this.rescale_nodeSpan=1,this.relative_nodeSpan=function(g){return this.nodeSpan(g)/this.rescale_nodeSpan};let c={layout:"left-to-right",logger:console,branches:"step",scaling:!0,bootstrap:!1,"color-fill":!0,"font-size":14,"internal-names":!1,selectable:!0,"restricted-selectable":!1,collapsible:!0,"left-right-spacing":"fixed-step","top-bottom-spacing":"fixed-step","left-offset":0,"show-scale":"top","draw-size-bubbles":!1,"bubble-styler":this.radius_pad_for_bubbles,"binary-selectable":!1,"is-radial":!1,"attribute-list":[],"max-radius":768,"annular-limit":.38196601125010515,compression:.2,"align-tips":!1,"maximum-per-node-spacing":100,"minimum-per-node-spacing":2,"maximum-per-level-spacing":100,"minimum-per-level-spacing":10,node_circle_size:Kb(3),transitions:null,brush:!0,reroot:!0,hide:!0,"label-nodes-with-name":!1,zoom:!1,"show-menu":!0,"show-labels":!0,"node-styler":null,"edge-styler":null,"node-span":null};this.ensure_size_is_in_px=function(g){return typeof g=="number"?g+"px":g},this.options=l2(n,c),this.font_size=this.options["font-size"],this.offsets=[0,this.font_size/2],this.shown_font_size=this.font_size,this.width=this.options.width||800,this.height=this.options.height||600,this.node_styler=this.options["node-styler"],this.edge_styler=this.options["edge-styler"],this.nodeSpan=this.options["node-span"],this.nodeSpan||(this.nodeSpan=function(g){return 1}),this.rescale_nodeSpan=this.phylotree.nodes.children.map(g=>{if(Sl(g)||this.showInternalName(g))return this.nodeSpan(g)}).reduce(function(g,b){return Math.min(b,g||1e200)},null)||1,this.initialize_svg(this.container),this.links=this.phylotree.nodes.links(),this.initializeEdgeLabels(),this.update(),WS()}pad_height(){return this.draw_scale_bar?this.scale_bar_font_size+25:0}pad_width(){this.label_width=this._label_width(this.shown_font_size);const t=this.options["show-labels"]?this.label_width:0;return this.offsets[1]+this.options["left-offset"]+t}collapse_node(t){lp(t)||(t.collapsed=!0)}set_size(t){if(!arguments.length)return this.size;let n=t;return this.options["top-bottom-spacing"]!="fixed-step"&&(this.size[0]=n[0]),this.options["left-right-spacing"]!="fixed-step"&&(this.size[1]=n[1]),this}initialize_svg(t){return this.svg!==t&&(Al(t).select("svg").remove(),this.svg=bD("svg").attr("width",this.width).attr("height",this.height),this.set_size([this.height,this.width]),this.css_classes["tree-container"]=="phylotree-container"&&(this.svg.selectAll("*").remove(),this.svg.append("defs")),Al(this.container).on("click",n=>{this.handle_node_click(null)},!0)),this}update_layout(t,n){n&&(this.nodes=$d(t),this.nodes.each(function(c){c.id=null})),this.update(),this.syncEdgeLabels()}update(t){var n=this;this.placenodes(),t=this.transitions(t);let c=0,g=this.svg.selectAll("."+qo["tree-container"]).data([0]);if(g=g.enter().append("g").attr("class",qo["tree-container"]).merge(g).attr("transform",W=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()])),this.draw_scale_bar){let W=this.svg.selectAll("."+qo["tree-scale-bar"]).data([0]);W.enter().append("g").attr("class",qo["tree-scale-bar"]).style("font-size",this.ensure_size_is_in_px(this.scale_bar_font_size)).merge(W).attr("transform",ce=>this.d3PhylotreeSvgTranslate([this.offsets[1]+this.options["left-offset"],this.pad_height()-10])).call(this.draw_scale_bar),W.selectAll("text").style("text-anchor","end")}else this.svg.selectAll("."+qo["tree-scale-bar"]).remove();g=this.svg.selectAll("."+qo["tree-container"]).data([0]),this.updateCollapsedClades(t);let b=g.selectAll(wv(qo)).data(this.links.filter(bv),W=>W.target.id||(W.target.id=++c));b.exit().remove(),b=b.enter().insert("path",":first-child").merge(b).each(function(W){n.drawEdge(this,W,t)});let E=g.selectAll(qS(qo)).data(this.phylotree.nodes.descendants().filter(xv),W=>W.id||(W.id=++c));if(E.exit().remove(),E=E.enter().append("g").attr("class",this.reclassNode).merge(E).attr("transform",W=>{const ce=this.options.layout=="right-to-left"&&Sl(W);return W.screen_x=e0(W),W.screen_y=Jd(W),this.d3PhylotreeSvgTranslate([ce?0:W.screen_x,W.screen_y])}).each(function(W){n.drawNode(this,W,t)}).attr("transform",W=>{if(!op(W.screen_x)&&!op(W.screen_y))return"translate("+W.screen_x+","+W.screen_y+")"}),this.options["label-nodes-with-name"]&&(E=E.attr("id",W=>"node-"+W.name)),this.resizeSvg(this.phylotree,this.svg,t),this.options.brush){var a=g.selectAll("."+qo["tree-selection-brush"]).data([0]).enter().insert("g",":first-child").attr("class",qo["tree-selection-brush"]),U=yB().on("brush",(W,ce)=>{var oe=W.selection,fe=this.links.filter(bv),we=fe.filter((et,lt)=>et.source.screen_x>=oe[0][0]&&et.source.screen_x<=oe[1][0]&&et.source.screen_y>=oe[0][1]&&et.source.screen_y<=oe[1][1]&&et.target.screen_x>=oe[0][0]&&et.target.screen_x<=oe[1][0]&&et.target.screen_y>=oe[0][1]&&et.target.screen_y<=oe[1][1]).map(et=>et.target);this.modifySelection(this.phylotree.links.map(et=>et.target),"tag",!1,we.length>0,"false"),this.modifySelection(we,"tag",!1,!1,"true")}).on("end",()=>{});a.call(U)}if(this.syncEdgeLabels(),this.options.zoom){let W=Dz().scaleExtent([.1,10]).on("zoom",ce=>{Al("."+qo["tree-container"]).attr("transform",oe=>ce.transform),Al("."+qo["tree-scale-bar"]).attr("transform",oe=>{let fe=ce.transform;return fe.y-=10,fe})});this.svg.call(W)}return this}_handle_single_node_layout(t){let n=this.nodeSpan(t)/this.rescale_nodeSpan;this.x=t.x=this.x+this.separation(this.last_node,t)+(this.last_span+n)*.5,this._extents[1][1]=Math.max(this._extents[1][1],t.y),this._extents[1][0]=Math.min(this._extents[1][0],t.y-n*.5),this.is_under_collapsed_parent?this._extents[0][1]=Math.max(this._extents[0][1],this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span+(n*.5+this.separation(this.last_node,t))*this.options.compression):this._extents[0][1]=Math.max(this._extents[0][1],this.x+n*.5+this.separation(this.last_node,t)),this.last_node=t,this.last_span=n}tree_layout(t){if(GS(t))return;let n=Sl(t);t.text_angle=null,t.text_align=null,t.radius=null,t.angle=null;let c=!1;if(t.parent)if(this.do_scaling){if(c)return 0;if(t.y=this.phylotree.branch_length_accessor(t),typeof t.y>"u")return c=!0,0;t.y+=t.parent.y}else t.y=n?this.max_depth:t.depth;else this.x=0,t.y=0,this.last_node=null,this.last_span=0,this._extents=[[0,0],[0,0]];if(n&&this._handle_single_node_layout(t),!n)if(lp(t)&&!this.is_under_collapsed_parent){if(this.save_x=this.x,this.save_span=this.last_span*.5,this.is_under_collapsed_parent=!0,this.process_internal_node(t),this.is_under_collapsed_parent=!1,typeof t.x=="number"){t.x=this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span,t.collapsed=[[t.x,t.y]];var g=b=>{b.hidden=!0,Sl(b)?(this.x=b.x=this.save_x+(b.x-this.save_x)*this.options.compression+this.save_span,t.collapsed.push([b.x,b.y])):b.children.map(g)};this.x=this.save_x,g(t),t.collapsed.splice(1,0,[this.save_x,t.y]),t.collapsed.push([this.x,t.y]),t.collapsed.push([t.x,t.y]),t.hidden=!1}}else this.process_internal_node(t);return t.x}process_internal_node(t){let n=0;if(this.showInternalName(t)){let c=t.children.length/2>>0,g=0,b=!1;for(let E=0;E<t.children.length;E++)typeof this.tree_layout(t.children[E])=="number"&&g++,g>=c&&!b&&(this._handle_single_node_layout(t),b=!0);g==0?(t.notshown=!0,t.x=void 0):b||this._handle_single_node_layout(t)}else t.x=t.children.map(this.tree_layout.bind(this)).reduce((c,g)=>typeof g=="number"?c+g:(n+=1,c),0),n==t.children.length?(t.notshown=!0,t.x=void 0):t.x/=t.children.length-n}do_lr(t){if(this.radial()&&t&&(this.offsets[1]=0),this.options["left-right-spacing"]=="fixed-step")this.size[1]=this.max_depth*this.fixed_width[1],this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"])/this._extents[1][1],this.label_width=this._label_width(this.shown_font_size),this.radial()&&(this.label_width*=2);else{this.label_width=this._label_width(this.shown_font_size),t=!0;let n=this.size[1]-this.offsets[1]-this.options["left-offset"];n*.5<this.label_width&&(this.shown_font_size*=n*.5/this.label_width,this.label_width=n*.5),this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"]-this.label_width)/this._extents[1][1]}}placenodes(){this._extents=[[0,0],[0,0]],this.x=0,this.last_span=0,this.last_node=null,this.last_span=0,this.save_x=this.x,this.save_span=this.last_span*.5,this.do_scaling=this.options.scaling;let t=!1;this.is_under_collapsed_parent=!1,this.max_depth=1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes,this.do_scaling),this.max_depth=BM(this.phylotree.nodes.descendants(),c=>c.depth),this.do_scaling&&t&&(this.do_scaling=!1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes));let n=!1;if(this.draw_scale_bar=this.options["show-scale"]&&this.do_scaling,this.offsets[1]=Math.max(this.font_size,-this._extents[1][0]*this.fixed_width[0]),this.options["top-bottom-spacing"]=="fixed-step"?(this.size[0]=this._extents[0][1]*this.fixed_width[0],this.scales[0]=this.fixed_width[0]):(this.scales[0]=(this.size[0]-this.pad_height())/this._extents[0][1],n=!0),this.shown_font_size=Math.min(this.font_size,this.scales[0]),this.radial()){this.draw_branch=tf(Wb,this.radial_center),this.edge_placer=RR;let c=null,g=null,b=null,E=0,a=this._extents[0][1]*this.scales[0],U=function(fe,we,et,lt,Ke){return Ke=Ke||0,Math.sqrt((we-fe)*(we-fe)+2*(fe+Ke)*(we+Ke)*(1-Math.cos(et-lt)))},W=0;this.phylotree.nodes.each(fe=>{let we=fe.x*this.scales[0];fe.angle=2*Math.PI*we/a,fe.text_angle=fe.angle-Math.PI/2,fe.text_angle=fe.text_angle>0&&fe.text_angle<Math.PI,fe.text_align=fe.text_angle?"end":"start",fe.text_angle=(fe.text_angle?180:0)+fe.angle*180/Math.PI}),this.do_lr(n),this.phylotree.nodes.each(fe=>{fe.radius=fe.y*this.scales[1]/this.size[1],W=Math.max(fe.radius,W)});let ce=0;this.phylotree.nodes.each(fe=>{if(!fe.children){let we=fe.x*this.scales[0];if(c!==null){let et=we-g,lt=U(fe.radius,b,fe.angle,c,ce),Ke=lt>0?et/lt:10*this.options["max-radius"];if(Ke>this.options["max-radius"]){let st=et/this.options["max-radius"],ut=fe.radius+b,kt=fe.radius*b-(st*st-(b-fe.radius)*(b-fe.radius))/2/(1-Math.cos(c-fe.angle)),Bt=Math.sqrt(ut*ut-4*kt);ce=Math.min(this.options["annular-limit"]*W,(-ut+Bt)/2),E=this.options["max-radius"]}else E=Math.max(E,Ke)}c=fe.angle,g=we,b=fe.radius}}),this.radius=Math.min(this.options["max-radius"],Math.max(a/2/Math.PI,E)),n&&(this.radius=Math.min(this.radius,(Math.min(a,this._extents[1][1]*this.scales[1])-this.label_width)*.5-this.radius*ce)),this.radial_center=this.radius_pad_for_bubbles=this.radius,this.draw_branch=tf(Wb,this.radial_center);let oe=1;ce&&(oe=W/(W+ce),this.radius*=oe),this.phylotree.nodes.each(fe=>{if(Qb(fe,this.radius,ce,this.radial_center,this.scales,this.size),W=Math.max(W,fe.radius),this.options["draw-size-bubbles"]?this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,fe.radius+this.nodeBubbleSize(fe)):this.radius_pad_for_bubbles=Math.max(this.radius_pad_for_bubbles,fe.radius),fe.collapsed){fe.collapsed=fe.collapsed.map(et=>{let lt={};return lt.x=et[0],lt.y=et[1],lt=Qb(lt,this.radius,ce,this.radial_center,this.scales,this.size),[lt.x,lt.y]});let we=fe.collapsed[1];fe.collapsed=fe.collapsed.filter(function(et,lt){return lt<3||lt>fe.collapsed.length-4?!0:Math.sqrt(Math.pow(et[0]-we[0],2)+Math.pow(et[1]-we[1],2))>3?(we=et,!0):!1})}}),this.size[0]=this.radial_center+this.radius/oe,this.size[1]=this.radial_center+this.radius/oe}else this.do_lr(),this.draw_branch=Xb,this.edge_placer=Yb,this.right_most_leaf=0,this.phylotree.nodes.each(c=>{if(c.x*=this.scales[0],c.y*=this.scales[1]*.8,this.options.layout=="right-to-left"&&(c.y=this._extents[1][1]*this.scales[1]-c.y),Sl(c)&&(this.right_most_leaf=Math.max(this.right_most_leaf,c.y+this.nodeBubbleSize(c))),c.collapsed){c.collapsed.forEach(b=>{b[0]*=this.scales[0],b[1]*=this.scales[1]*.8});let g=c.collapsed[1][0];c.collapsed=c.collapsed.filter(function(b,E){return E<3||E>c.collapsed.length-4?!0:b[0]-g>3?(g=b[0],!0):!1})}});if(this.draw_scale_bar){let c,g;if(this.radial()){if(g=Math.min(this.radius/5,50),c=Math.pow(10,Math.ceil(Math.log(this._extents[1][1]*g/this.radius)/Math.log(10))),g=c*(this.radius/this._extents[1][1]),g<30){let a=Math.ceil(30/g);g*=a,c*=a}}else c=this._extents[1][1],g=this.size[1]-this.offsets[1]-this.options["left-offset"]-this.shown_font_size;let b=E4().domain([0,c]).range([0,g]),E=Yv(".2f");if(this.draw_scale_bar=GM().scale(b).tickFormat(function(a){return a===0?"":E(a)}),this.radial())this.draw_scale_bar.tickValues([c]);else{let a=function(W,ce){return ce?Math.round(W*(ce=Math.pow(10,ce)))/ce:Math.round(W)},U=b.ticks();U=U.length>1?U[1]:U[0],this.draw_scale_bar.ticks(Math.min(10,a(g/(this.shown_font_size*E(U).length*2),0)))}}else this.draw_scale_bar=null;return this}spacing_x(t,n){return arguments.length?(this.fixed_width[0]!=t&&t>=this.options["minimum-per-node-spacing"]&&t<=this.options["maximum-per-node-spacing"]&&(this.fixed_width[0]=t,n||this.placenodes()),this):this.fixed_width[0]}spacing_y(t,n){return arguments.length?(this.fixed_width[1]!=t&&t>=this.options["minimum-per-level-spacing"]&&t<=this.options["maximum-per-level-spacing"]&&(this.fixed_width[1]=t,n||this.placenodes()),this):this.fixed_width[1]}_label_width(t){t=t||this.shown_font_size;let n=0;return this.phylotree.nodes.descendants().filter(xv).forEach(c=>{let g=12+this._nodeLabel(c).length*t*.8;c.angle!==null&&(g*=Math.max(Math.abs(Math.cos(c.angle)),Math.abs(Math.sin(c.angle)))),n=Math.max(g,n)}),n}font_size(t){return arguments.length?(this.font_size=t===void 0?12:t,this):this.font_size}scale_bar_font_size(t){return arguments.length?(this.scale_bar_font_size=t===void 0?12:t,this):this.scale_bar_font_size}node_circle_size(t,n){return arguments.length?(this.options.node_circle_size=Kb(t===void 0?3:t),this):this.options.node_circle_size}css(t){if(arguments.length===0)return this.css_classes;if(arguments.length>2){var n={};return n[t[0]]=t[1],this.css(n)}for(var c in qo)c in t&&t[c]!=qo[c]&&(qo[c]=t[c]);return this}transitions(t){return t!==void 0?t:this.options.transitions!==null?this.options.transitions:this.phylotree.nodes.descendants().length<=300}css_classes(t,n){if(!arguments.length)return this.css_classes;let c=!1;for(var g in qo)g in t&&t[g]!=this.css_classes[g]&&(c=!0,this.css_classes[g]=t[g]);return n&&c&&this.layout(),this}layout(t){return this.svg?(this.svg.selectAll("."+this.css_classes["tree-container"]+",."+this.css_classes["tree-scale-bar"]+",."+this.css_classes["tree-selection-brush"]),this.d3PhylotreeTriggerLayout(this),this.update()):(this.d3PhylotreeTriggerLayout(this),this)}handle_node_click(t,n){this.nodeDropdownMenu(t,this.container,this,this.options,n)}refresh(){if(this.svg){let n=this.svg.selectAll("."+this.css_classes["tree-container"]).selectAll(wv(this.css_classes)).attr("class",this.reclassEdge.bind(this));this.edge_styler&&n.each(c=>{this.edge_styler(Al(this),c)})}return this}countHandler(t){return arguments.length?(this.count_listener_handler=t,this):this.count_listener_handler}style_nodes(t){return arguments.length?(this.node_styler=t,this):this.node_styler}style_edges(t){return arguments.length?(this.edge_styler=t.bind(this),this):this.edge_styler}itemSelected(t,n){return t[n]||!1}show(){return this.svg.node()}}AA(mp.prototype,iF);AA(mp.prototype,eF);AA(mp.prototype,lF);AA(mp.prototype,pF);AA(mp.prototype,bF);AA(mp.prototype,jR);function wF(e,t,n){return this.nodes.sum(function(c){return c.value}).sort(e),this.display&&(this.display.update_layout(this.nodes),this.display.update()),this}function SF(e){var t;return e=e.map(function(n){return typeof n=="string"?n:n.data.name}),this.traverse_and_compute(function(n){n.children?n.parent?(n.data.mrca=zS(...n.descendants().map(c=>c.data.mrca)),!t&&n.data.mrca.length==e.length&&(t=n)):t||(t=n):n.data.mrca=RS([n.data.name],e)}),t}let Bu=class{constructor(e,t={}){this.newick_string="",this.nodes=[],this.links=[],this.parsed_tags=[],this.partitions=[],this.branch_length_accessor=yv,this.branch_length=yv,this.logger=t.logger||console,this.selection_attribute_name="selected";var n=t.type||void 0,c=[],g=this;if(r1(n))n in ny?c=ny[n](e,t):g.logger.error("type "+n+" not in registry! Available types are "+du(ny));else if(ic(n))try{c=n(e,t)}catch{g.logger.error("Could not parse custom format!")}else e.name=="root"?c={json:e,error:null}:typeof e!="string"?c=e:e.contentType=="application/xml"?c=VS(e):(this.newick_string=e,c=wg(e,t));if(!c.json)g.nodes=[];else{g.nodes=$d(c.json);let b={};g.nodes.each(E=>{E.data.annotation&&(b[E.data.annotation]=!0)}),g.parsed_tags=Object.keys(b)}return g.links=g.nodes.links(),this.hasBranchLengths()||(console.warn("Phylotree User Warning : NO BRANCH LENGTHS DETECTED, SETTING ALL LENGTHS TO 1"),this.setBranchLength(b=>1)),g}json(e){var t=0;this.traverse_and_compute(function(c){c.json_export_index=t++},e);var n=new Array(t);return t=0,this.traverse_and_compute(function(c){let g=lS(c);delete g.json_export_index,c.parent&&(g.parent=c.parent.json_export_index),c.children&&(g.children=mc(c.children,function(b){return b.json_export_index})),n[t++]=g},e),this.traverse_and_compute(function(c){delete c.json_export_index},e),JSON.stringify(n)}traverse_and_compute(e,t,n,c){t=t||"post-order";function g(a){op(a)||US(a,e,c)}function b(a){wR(a,e,c)}function E(a){SR(a,e,c)}return t=="pre-order"?t=b:t=="in-order"?t=E:t=g,t(n||this.nodes),this}get_parsed_tags(){return this.parsed_tags}update(e){this.nodes=e}render(e){return this.display=new mp(this,e),this.display}};Bu.prototype.isLeafNode=Sl;Bu.prototype.selectAllDescendants=OS;Bu.prototype.mrca=SF;Bu.prototype.hasBranchLengths=ER;Bu.prototype.getBranchLengths=CR;Bu.prototype.branchName=PR;Bu.prototype.normalizeBranchLengths=kR;Bu.prototype.scaleBranchLengths=MR;Bu.prototype.getNewick=pR;Bu.prototype.resortChildren=wF;Bu.prototype.setBranchLength=TR;Bu.prototype.maxParsimony=xR;Bu.prototype.getTipLengths=vR;Bu.prototype.leftChildRightSibling=IR;AA(Bu.prototype,dR);AA(Bu.prototype,zR);AA(Bu.prototype,_R);B4("%Y%m%d");function IF(e){let t,n,c="Taxa found in this area",g,b,E,a,U,W,ce;return{c(){t=qn("div"),n=qn("h2"),n.textContent=c,g=Or(),b=qn("div"),E=qn("div"),a=qn("span"),U=Po(e[4]),this.h()},l(oe){t=Hn(oe,"DIV",{class:!0});var fe=Tn(t);n=Hn(fe,"H2",{class:!0,"data-svelte-h":!0}),ec(n)!=="svelte-bg4wlc"&&(n.textContent=c),g=Nr(fe),b=Hn(fe,"DIV",{id:!0,class:!0});var we=Tn(b);E=Hn(we,"DIV",{class:!0,style:!0});var et=Tn(E);a=Hn(et,"SPAN",{class:!0});var lt=Tn(a);U=Do(lt,e[4]),lt.forEach(Ci),et.forEach(Ci),we.forEach(Ci),fe.forEach(Ci),this.h()},h(){Fi(n,"class","svelte-12ehp3f"),Fi(a,"class","svelte-12ehp3f"),Fi(E,"class",W=ep(`tree_tooltip ${e[3]?"shown":"hidden"} ${e[5]?"flip":""}`)+" svelte-12ehp3f"),Fi(E,"style",ce=`margin-top: calc(${e[2]}px - 2rem); left: ${e[1]}px;`),Fi(b,"id","tree_container"),Fi(b,"class","svelte-12ehp3f"),Fi(t,"class","phylo-container svelte-12ehp3f")},m(oe,fe){Zn(oe,t,fe),Qi(t,n),Qi(t,g),Qi(t,b),Qi(b,E),Qi(E,a),Qi(a,U),e[10](b)},p(oe,[fe]){fe&16&&ju(U,oe[4]),fe&40&&W!==(W=ep(`tree_tooltip ${oe[3]?"shown":"hidden"} ${oe[5]?"flip":""}`)+" svelte-12ehp3f")&&Fi(E,"class",W),fe&6&&ce!==(ce=`margin-top: calc(${oe[2]}px - 2rem); left: ${oe[1]}px;`)&&Fi(E,"style",ce)},i:lo,o:lo,d(oe){oe&&Ci(t),e[10](null)}}}let ry=2e3,sy=2e3;function EF(e,t,n){let{newick:c}=t,{hex_id:g}=t,{clade:b}=t,E,a,U,W,ce=!1,oe="",fe=!1;function we(Ke){if(!E)return;let st="((((((((((((((((Tyrannus_melancholicus:0.619902,Tyrannus_couchii:0.619902):0.85678,Tyrannus_crassirostris:1.476682):0.29907,Tyrannus_savana:1.775751):0.825334,(Tyrannus_forficatus:0.749239,Tyrannus_verticalis:0.749239):1.851846):1.400348,(Tyrannus_tyrannus:3.53811,Tyrannus_vociferans:3.53811):0.463323):0.78852,Myiodynastes_luteiventris:4.789953):2.170634,(((Myiarchus_crinitus:1.804538,Myiarchus_cinerascens:1.804538):0.209707,Myiarchus_tyrannulus:2.014245):1.743441,Myiarchus_tuberculifer:3.757685):3.202901):1.597191,(((((((Empidonax_occidentalis:0.327604,Empidonax_difficilis:0.327604):2.426494,Empidonax_flaviventris:2.754098):1.696517,(((((Empidonax_oberholseri:2.161306,Empidonax_hammondii:2.161306):0.842122,Empidonax_minimus:3.003428):0.213631,Empidonax_wrightii:3.217059):0.333535,Empidonax_fulvifrons:3.550594):0.595988,(Empidonax_alnorum:1.979938,Empidonax_traillii:1.979938):2.166644):0.304032):0.148682,((Contopus_sordidulus:2.62665,Contopus_virens:2.626649):0.899922,Contopus_cooperi:3.526571):1.072725):0.325545,(Sayornis_saya:3.781439,(Sayornis_phoebe:1.096253,Sayornis_nigricans:1.096253):2.685186):1.143402):1.218483,Contopus_pertinax:6.143324):1.851513,Pyrocephalus_rubinus:7.994837):0.56294):19.243085,(((((((Zosterops_palpebrosus:11.24656,Chamaea_fasciata:11.246559):0.809274,Pycnonotus_jocosus:12.055832):0.37388,((((Riparia_riparia:6.967223,(Tachycineta_thalassina:4.679356,Tachycineta_bicolor:4.679355):2.287867):0.197341,(Stelgidopteryx_serripennis:6.278306,Progne_subis:6.278307):0.886257):0.999496,((Petrochelidon_pyrrhonota:2.705651,Petrochelidon_fulva:2.705651):4.890525,Hirundo_rustica:7.596175):0.567883):3.908347,(((Phylloscopus_fuscatus:7.144214,Phylloscopus_inornatus:7.144215):1.039892,Phylloscopus_borealis:8.184107):3.386782,Psaltriparus_minimus:11.57089):0.501517):0.357305):3.198033,(Alauda_arvensis:7.291984,Eremophila_alpestris:7.291985):8.33576):0.954938,(((Poecile_rufescens:3.381344,(Poecile_gambeli:2.366328,Poecile_atricapillus:2.366328):1.015016):2.5912,(Baeolophus_inornatus:1.885773,Baeolophus_ridgwayi:1.885773):4.086771):6.604761,Auriparus_flaviceps:12.577305):4.005378):1.204803,(((((((Oenanthe_oenanthe:8.401653,(Tarsiger_cyanurus:7.742944,Ficedula_albicilla:7.742944):0.658707):4.637699,Cinclus_mexicanus:13.03935):1.218385,((((Turdus_migratorius:3.909873,Turdus_obscurus:3.909873):0.383141,Turdus_rufopalliatus:4.293014):5.352109,((((Catharus_guttatus:3.89296,(Catharus_minimus:0.719248,Catharus_fuscescens:0.719248):3.173712):1.217916,Catharus_ustulatus:5.110876):2.898328,Hylocichla_mustelina:8.009204):0.832821,Ixoreus_naevius:8.842026):0.803098):2.400322,(Myadestes_townsendi:11.383646,(Sialia_currucoides:3.141333,Sialia_mexicana:3.141332):8.242315):0.661799):2.21229):0.472993,(Sturnus_vulgaris:11.154101,(((Mimus_polyglottos:5.122579,Oreoscoptes_montanus:5.12258):1.517727,((Toxostoma_curvirostre:4.120545,Toxostoma_rufum:4.120544):1.352213,(Toxostoma_bendirei:4.640856,((Toxostoma_lecontei:2.747447,Toxostoma_crissale:2.747447):0.857103,Toxostoma_redivivum:3.60455):1.036307):0.831901):1.167548):1.301648,Dumetella_carolinensis:7.941955):3.212146):3.576628):2.188836,((((((Campylorhynchus_brunneicapillus:6.585247,Thryomanes_bewickii:6.585247):0.601549,(Troglodytes_aedon:5.644158,(Cistothorus_platensis:4.091648,Cistothorus_palustris:4.091648):1.552511):1.542638):0.934231,(Catherpes_mexicanus:6.20663,Salpinctes_obsoletus:6.20663):1.914396):3.05437,((Polioptila_californica:1.690149,Polioptila_melanura:1.690149):1.702386,Polioptila_caerulea:3.392536):7.782861):2.80982,Certhia_americana:13.985217):1.128942,((Sitta_canadensis:6.561379,Sitta_pygmaea:6.56138):1.810662,Sitta_carolinensis:8.37204):6.742118):1.805406):0.407621,(((Bombycilla_garrulus:3.757978,Bombycilla_cedrorum:3.757978):8.174507,(Ptilogonys_cinereus:8.485107,Phainopepla_nitens:8.485108):3.447377):4.887578,(Regulus_calendula:7.083885,Regulus_satrapa:7.083885):9.736178):0.507124):0.145318,(((((((Sporophila_torqueola:8.419777,(((Spiza_americana:5.82027,(((Passerina_versicolor:1.374144,Passerina_ciris:1.374144):2.404035,(Passerina_caerulea:2.570987,Passerina_amoena:2.570987):1.207191):0.473037,Passerina_cyanea:4.251215):1.569056):1.286765,((((Piranga_ludoviciana:3.489746,Piranga_flava:3.489746):0.442277,Piranga_olivacea:3.932023):0.411935,Piranga_rubra:4.343958):2.254702,(Cardinalis_sinuatus:4.01511,Cardinalis_cardinalis:4.01511):2.583551):0.508374):0.258533,(Pheucticus_ludovicianus:2.914679,Pheucticus_melanocephalus:2.914679):4.450888):1.05421):0.750985,(((((((((Quiscalus_quiscula:1.355442,Quiscalus_mexicanus:1.355442):1.537226,(Euphagus_carolinus:2.263857,Euphagus_cyanocephalus:2.263857):0.628811):1.191256,(Molothrus_aeneus:1.212313,Molothrus_ater:1.212313):2.871611):0.187559,(Agelaius_phoeniceus:3.000792,Agelaius_tricolor:3.000792):1.270691):2.148377,((Icterus_spurius:2.256428,Icterus_cucullatus:2.256428):2.245507,(Icterus_parisorum:3.486088,((Icterus_bullockii:1.296631,Icterus_pustulatus:1.296631):0.372399,Icterus_galbula:1.66903):1.817059):1.015845):1.917926):0.524545,((Sturnella_neglecta:1.887192,Sturnella_magna:1.887192):4.476338,(Xanthocephalus_xanthocephalus:5.394765,Dolichonyx_oryzivorus:5.394765):0.968765):0.580875):0.481912,Icteria_virens:7.426317):0.371308,(Seiurus_aurocapilla:5.3139,((((((((((((((((Setophaga_virens:0.55378,(Setophaga_townsendi:0.205227,Setophaga_occidentalis:0.205227):0.348552):0.601999,(Setophaga_graciae:0.393728,Setophaga_nigrescens:0.393728):0.76205):0.347084,Setophaga_discolor:1.502861):0.578854,((Setophaga_pinus:1.670331,(Setophaga_coronata:1.537147,Setophaga_dominica:1.537147):0.133184):0.165304,Setophaga_palmarum:1.835635):0.246081):0.080749,Setophaga_caerulescens:2.162464):0.069445,((((Setophaga_petechia:1.220713,Setophaga_pensylvanica:1.220713):0.146616,Setophaga_striata:1.367329):0.597451,(Setophaga_castanea:1.781327,Setophaga_fusca:1.781327):0.183453):0.175384,Setophaga_magnolia:2.140164):0.091745):0.054758,Setophaga_cerulea:2.286667):0.160767,(Setophaga_americana:0.422318,Setophaga_pitiayumi:0.422318):2.025116):0.061881,Setophaga_tigrina:2.509315):0.142911,Setophaga_ruticilla:2.652226):0.113792,Setophaga_citrina:2.766018):1.230111,(((Cardellina_rubrifrons:2.573805,Cardellina_pusilla:2.573805):0.271427,Cardellina_canadensis:2.845232):0.450177,Myioborus_pictus:3.295408):0.700721):0.307199,(Geothlypis_trichas:3.17745,(Geothlypis_formosa:2.8138,(Oporornis_agilis:2.076081,(Geothlypis_tolmiei:0.877845,Geothlypis_philadelphia:0.877845):1.198236):0.73772):0.363649):1.125879):0.086537,Helmitheros_vermivorum:4.389866):0.161013,(Protonotaria_citrea:4.303031,((Parkesia_motacilla:2.097399,Parkesia_noveboracensis:2.097399):1.823707,Mniotilta_varia:3.921106):0.381926):0.247847):0.241013,(Vermivora_cyanoptera:1.250469,Vermivora_chrysoptera:1.250469):3.541423):0.522008):2.483725):0.860785,((((Ammodramus_savannarum:5.32378,Peucaea_cassinii:5.323781):1.90225,((((Spizella_pusilla:3.070337,Spizella_atrogularis:3.070337):0.256848,(Spizella_breweri:2.319898,Spizella_passerina:2.319898):1.007287):0.299515,Spizella_pallida:3.6267):3.119963,((Calamospiza_melanocorys:5.462612,Amphispiza_bilineata:5.462613):0.473245,Chondestes_grammacus:5.935857):0.810805):0.479369):0.284235,((((Ammodramus_leconteii:4.163338,Pooecetes_gramineus:4.163338):0.318831,(((Melospiza_lincolnii:1.264886,Melospiza_georgiana:1.264886):0.837596,Melospiza_melodia:2.102483):1.773568,Passerculus_sandwichensis:3.876051):0.606118):1.04583,((Pipilo_maculatus:2.033152,Pipilo_chlorurus:2.033153):2.918452,((Melozone_aberti:0.89701,Melozone_crissalis:0.89701):3.214586,Aimophila_ruficeps:4.111597):0.840007):0.576396):0.208553,((Junco_hyemalis:4.32944,((Zonotrichia_albicollis:1.15955,Zonotrichia_querula:1.15955):0.322813,(Zonotrichia_atricapilla:0.331305,Zonotrichia_leucophrys:0.331305):1.151058):2.847076):0.487674,Passerella_iliaca:4.817114):0.919439):1.773713):0.743769,(Emberiza_pusilla:3.209884,Emberiza_rustica:3.209884):5.04415):0.404376):0.512351):0.561069,(((Calcarius_ornatus:1.735516,Calcarius_pictus:1.735516):4.618411,(Plectrophenax_nivalis:5.426424,Calcarius_lapponicus:5.426425):0.927502):0.908811,Rhynchophanes_mccownii:7.262738):2.469093):1.359019,(((Chloris_sinica:5.358973,(((Spinus_pinus:3.142395,(Spinus_tristis:2.540467,(Spinus_psaltria:1.162173,Spinus_lawrencei:1.162173):1.378294):0.601928):1.090077,Carduelis_carduelis:4.232471):0.540023,((Loxia_leucoptera:1.210478,Loxia_curvirostra:1.210477):2.332016,Acanthis_flammea:3.542493):1.230001):0.586479):2.183821,((Leucosticte_tephrocotis:0.267407,Leucosticte_atrata:0.267407):6.156445,Pinicola_enucleator:6.423852):1.11894):2.79669,Fringilla_montifringilla:10.339483):0.751366):0.547327,((Motacilla_cinerea:3.178243,(Motacilla_alba:2.460116,(Motacilla_tschutschensis:1.809206,Motacilla_citreola:1.809207):0.650909):0.718127):4.53481,(((Anthus_rubescens:3.227962,Anthus_cervinus:3.227962):1.32247,Anthus_hodgsoni:4.550432):1.385479,Anthus_spragueii:5.935912):1.777141):3.925124):0.415079,Passer_domesticus:12.053257):1.148099,((Vidua_macroura:10.518889,(Estrilda_melpoda:6.721624,(Lonchura_punctulata:4.62458,Euodice_malabarica:4.62458):2.097043):3.797268):0.93593,Euplectes_franciscanus:11.454819):1.746534):4.27115):0.314981):2.469957,((((Vireo_flavoviridis:1.321439,Vireo_olivaceus:1.321439):1.199697,(Vireo_philadelphicus:1.956385,Vireo_gilvus:1.956385):0.564752):0.781661,((((Vireo_solitarius:0.707618,(Vireo_cassinii:0.402464,Vireo_plumbeus:0.402464):0.305154):0.801472,Vireo_flavifrons:1.50909):0.835561,(Vireo_vicinior:2.056349,Vireo_huttoni:2.056349):0.288302):0.466454,(Vireo_griseus:1.632751,Vireo_bellii:1.632751):1.178355):0.491692):12.019837,((Lanius_cristatus:5.837545,Lanius_ludovicianus:5.837545):5.571762,(((((Corvus_corax:4.701119,Corvus_brachyrhynchos:4.701119):1.990164,Nucifraga_columbiana:6.691283):1.298672,(Pica_nuttalli:0.392281,Pica_hudsonia:0.392281):7.597672):0.514906,(((Gymnorhinus_cyanocephalus:6.126222,((Aphelocoma_woodhouseii:0.76393,Aphelocoma_californica:0.76393):1.557404,Aphelocoma_insularis:2.321334):3.804888):0.683341,(Cyanocitta_stelleri:4.846486,Cyanocitta_cristata:4.846486):1.963078):0.455185,Calocitta_colliei:7.264749):1.240112):0.40107,Perisoreus_canadensis:8.905929):2.503378):3.913326):4.934811):7.543419):10.368133,(Psittacula_krameri:14.70458,((((Brotogeris_chiriri:1.035507,Brotogeris_versicolurus:1.035507):6.349329,Myiopsitta_monachus:7.384836):2.724171,(Amazona_albifrons:3.384577,((Amazona_autumnalis:2.541056,(Amazona_finschi:1.862114,Amazona_viridigenalis:1.862114):0.678941):0.625662,(Amazona_ochrocephala:1.165411,Amazona_aestiva:1.16541):2.001307):0.217859):6.72443):0.370969,(((Aratinga_acuticaudata:4.733532,Nandayus_nenday:4.733532):0.572154,Cyanoliseus_patagonus:5.305686):0.227193,Aratinga_mitrata:5.532878):4.947097):4.224603):23.464415):0.875789,((Falco_tinnunculus:6.236443,((Falco_mexicanus:3.250519,Falco_peregrinus:3.250519):1.551005,(Falco_columbarius:4.340078,Falco_sparverius:4.340078):0.461445):1.434919):11.560534,Caracara_plancus:17.796978):21.247806):18.167212,(((((Colaptes_auratus:7.439905,Dryocopus_pileatus:7.439906):2.995574,((((Sphyrapicus_ruber:0.691321,(Sphyrapicus_nuchalis:0.686021,Sphyrapicus_varius:0.686021):0.0053):4.673796,Sphyrapicus_thyroideus:5.365118):3.383365,(Melanerpes_uropygialis:7.684308,(Melanerpes_formicivorus:7.035306,(Melanerpes_lewis:6.403656,Melanerpes_erythrocephalus:6.403656):0.63165):0.649002):1.064176):0.729339,Picoides_arcticus:9.477822):0.957657):25.154227,Megaceryle_alcyon:35.589708):21.232651,(((((Megascops_kennicottii:9.535534,(Bubo_scandiacus:4.38794,Bubo_virginianus:4.38794):5.147594):0.399666,Strix_varia:9.935201):0.688896,(Asio_otus:6.154249,Asio_flammeus:6.154249):4.469847):2.862398,(((Glaucidium_gnoma:10.483593,Athene_cunicularia:10.483593):0.73703,Aegolius_acadicus:11.220624):0.978771,Micrathene_whitneyi:12.199394):1.2871):8.747286,Tyto_alba:22.233781):34.588578):0.214221,(((((Aquila_chrysaetos:7.964539,((((Buteogallus_anthracinus:4.536991,((((((Buteo_swainsoni:1.391803,(Buteo_albonotatus:1.258194,(Buteo_regalis:0.408815,Buteo_lagopus:0.408815):0.84938):0.13361):0.246285,Buteo_jamaicensis:1.638089):0.474275,Buteo_platypterus:2.112364):0.127968,Buteo_lineatus:2.240332):0.063671,Buteo_nitidus:2.304003):1.83132,Parabuteo_unicinctus:4.135322):0.401669):0.814523,Ictinia_mississippiensis:5.351515):1.030262,Haliaeetus_leucocephalus:6.381778):0.568816,(Accipiter_striatus:5.309671,(Circus_cyaneus:5.06055,(Accipiter_cooperii:3.903353,Accipiter_gentilis:3.903353):1.157197):0.24912):1.640922):1.013948):1.914107,Elanoides_forficatus:9.878649):1.074487,Elanus_leucurus:10.953135):1.124614,Pandion_haliaetus:12.07775):4.511346,((Coragyps_atratus:3.554197,Gymnogyps_californianus:3.554197):2.188988,Cathartes_aura:5.743185):10.84591):40.447484):0.175416):0.552342,((((((((((((((((Tryngites_subruficollis:3.158973,Calidris_bairdii:3.158973):1.069381,Calidris_melanotos:4.228355):0.721063,(Calidris_pusilla:2.559828,Calidris_mauri:2.559828):2.389589):0.443639,Calidris_himantopus:5.393057):0.153549,(((Calidris_alba:3.699876,Calidris_fuscicollis:3.699876):0.589353,Calidris_minuta:4.289229):0.510028,Calidris_minutilla:4.799257):0.747348):0.500986,Calidris_ferruginea:6.047591):0.427549,((Calidris_maritima:1.198421,Calidris_ptilocnemis:1.198421):3.144061,Calidris_alpina:4.342482):2.132658):0.368787,Calidris_subminuta:6.843928):0.480821,Philomachus_pugnax:7.324748):0.299471,(Calidris_acuminata:6.399253,(Calidris_canutus:5.09979,Aphriza_virgata:5.09979):1.299464):1.224966):3.509313,(Arenaria_interpres:3.533248,Arenaria_melanocephala:3.533248):7.600284):1.234303,((((Scolopax_minor:10.211308,(Gallinago_gallinago:3.83163,Gallinago_delicata:3.831629):6.379678):0.499977,(Limnodromus_griseus:5.529963,Limnodromus_scolopaceus:5.529963):5.181322):0.726366,Lymnocryptes_minimus:11.437651):0.649326,(((Tringa_solitaria:7.846535,((((Tringa_stagnatilis:3.841335,Tringa_glareola:3.841335):1.894987,((Tringa_nebularia:3.640261,Tringa_melanoleuca:3.640261):1.182161,Tringa_erythropus:4.822422):0.913899):0.484985,(Tringa_flavipes:5.250045,Tringa_semipalmata:5.250045):0.971262):0.372349,(Tringa_brevipes:3.111692,Tringa_incana:3.111692):3.481964):1.252879):2.273961,(((Phalaropus_fulicarius:3.166781,Phalaropus_lobatus:3.166781):4.461625,Phalaropus_tricolor:7.628406):1.797383,Xenus_cinereus:9.425789):0.694707):0.508933,Actitis_macularius:10.629429):1.457548):0.280858):0.808214,((Limosa_fedoa:4.758084,Limosa_haemastica:4.758084):2.792013,Limosa_lapponica:7.550097):5.625952):0.875709,(((Numenius_americanus:3.902998,Numenius_minutus:3.902999):3.114172,(Numenius_phaeopus:3.809099,Numenius_tahitiensis:3.809099):3.208071):3.460888,Bartramia_longicauda:10.478058):3.5737):7.503049,((((((((Chlidonias_niger:1.1619,Chlidonias_leucopterus:1.1619):3.555137,(((Sterna_paradisaea:2.604915,Sterna_hirundo:2.604915):1.016325,Sterna_forsteri:3.62124):0.268369,((Thalasseus_sandvicensis:0.607261,Thalasseus_elegans:0.607261):0.62365,Thalasseus_maximus:1.230912):2.658698):0.827428):0.955816,(Gelochelidon_nilotica:4.350884,Hydroprogne_caspia:4.350884):1.321968):1.505717,Sternula_antillarum:7.178569):0.558345,(Onychoprion_anaethetus:3.582945,Onychoprion_fuscatus:3.582945):4.153969):3.975227,Rynchops_niger:11.712141):0.654253,((((Chroicocephalus_ridibundus:1.999968,Chroicocephalus_philadelphia:1.999969):1.479186,((((((((((((Larus_hyperboreus:0.185546,(Larus_schistisagus:0.105983,Larus_glaucoides:0.105983):0.079563):0.003055,Larus_glaucescens:0.188601):0.155986,Larus_argentatus:0.344587):0.107021,Larus_californicus:0.451609):0.012053,Larus_dominicanus:0.463661):0.005221,Larus_fuscus:0.468882):0.150475,Larus_marinus:0.619357):0.206717,Larus_occidentalis:0.826074):0.18028,Larus_delawarensis:1.006355):0.196994,Larus_heermanni:1.203348):0.44514,(Larus_crassirostris:1.024276,Larus_belcheri:1.024276):0.624212):1.18797,(Leucophaeus_atricilla:0.919175,Leucophaeus_pipixcan:0.919175):1.917283):0.642696):0.981991,((Xema_sabini:2.721958,Pagophila_eburnea:2.721958):0.757049,(Rissa_tridactyla:2.551241,Rissa_brevirostris:2.551241):0.927766):0.982139):1.134354,((Hydrocoloeus_minutus:3.254208,Rhodostethia_rosea:3.254208):0.77621,Creagrus_furcatus:4.030417):1.565082):6.770894):0.839622,((((Cerorhinca_monocerata:4.962971,(Fratercula_corniculata:2.833483,Fratercula_cirrhata:2.833483):2.129488):4.069719,((Aethia_pusilla:3.348323,(Aethia_cristatella:2.915151,Aethia_psittacula:2.91515):0.433173):0.992254,Ptychoramphus_aleuticus:4.340578):4.692112):0.727745,((((Uria_lomvia:3.0028,Uria_aalge:3.0028):4.920853,(Synthliboramphus_antiquus:3.720373,(Synthliboramphus_hypoleucus:0.671056,Synthliboramphus_craveri:0.671056):3.049317):4.20328):0.407386,Cepphus_columba:8.331039):0.426139,(Brachyramphus_brevirostris:5.628663,(Brachyramphus_marmoratus:3.830719,Brachyramphus_perdix:3.830719):1.797944):3.128515):1.003257):1.771281,((Stercorarius_parasiticus:2.970954,Stercorarius_pomarinus:2.970954):1.751772,Stercorarius_longicaudus:4.722725):6.80899):1.6743):8.348792):1.743606,((((Charadrius_montanus:5.551928,((Charadrius_leschenaultii:0.169672,Charadrius_mongolus:0.169672):4.612515,Charadrius_wilsonia:4.782187):0.769741):4.443245,(((Charadrius_semipalmatus:5.377763,(Charadrius_melodus:3.821625,Charadrius_hiaticula:3.821625):1.556139):1.15835,Charadrius_vociferus:6.536113):2.319533,Charadrius_morinellus:8.855646):1.139527):1.702327,((Recurvirostra_americana:5.643946,Himantopus_mexicanus:5.643946):2.680725,(Haematopus_palliatus:0.491965,Haematopus_bachmani:0.491965):7.832705):3.37283):0.798071,((Pluvialis_fulva:2.455897,Pluvialis_dominica:2.455897):1.178289,Pluvialis_squatarola:3.634185):8.861386):10.802842):34.465924):0.473736,((((Columbina_inca:3.404918,(Columbina_talpacoti:2.266537,Columbina_passerina:2.266537):1.138381):8.482142,((Zenaida_asiatica:6.129893,Zenaida_macroura:6.129893):3.814154,((Columba_livia:6.40713,(Streptopelia_orientalis:4.04789,(Streptopelia_decaocto:0.772012,Streptopelia_roseogrisea:0.772012):3.275878):2.359239):1.408266,Patagioenas_fasciata:7.815396):2.128651):1.943014):22.893088,((Podilymbus_podiceps:7.533322,((((Podiceps_auritus:3.080437,Podiceps_grisegena:3.080437):1.451611,Podiceps_nigricollis:4.532048):0.835204,(Aechmophorus_clarkii:0.649792,Aechmophorus_occidentalis:0.649792):4.71746):0.982984,Tachybaptus_dominicus:6.350235):1.183087):15.975136,(Phaethon_lepturus:3.683466,Phaethon_aethereus:3.683465):19.824993):11.27169):0.63047,((((Cypseloides_niger:5.980303,Streptoprocne_zonaris:5.980303):4.57189,((Aeronautes_saxatalis:6.888602,Apus_apus:6.888602):0.820048,(Chaetura_vauxi:1.732059,Chaetura_pelagica:1.732059):5.97659):2.843543):21.460899,(((Eugenes_fulgens:10.670111,Lampornis_clemenciae:10.67011):0.56568,((Archilochus_colubris:1.306099,Archilochus_alexandri:1.306099):3.186673,(((Selasphorus_sasin:1.25153,(Selasphorus_calliope:0.828849,Selasphorus_rufus:0.828849):0.422681):0.256848,Selasphorus_platycercus:1.508378):0.915832,(Calypte_anna:1.752307,Calypte_costae:1.752307):0.671904):2.068562):6.743019):2.456092,Colibri_thalassinus:13.691884):18.321209):2.173856,(Phalaenoptilus_nuttallii:9.381208,(Chordeiles_acutipennis:4.827009,Chordeiles_minor:4.827009):4.554198):24.805739):1.223671):22.827456):3.416457,(((((((((Botaurus_lentiginosus:7.844435,Ixobrychus_exilis:7.844434):4.109641,(((((Bubulcus_ibis:5.166884,Ardea_alba:5.166884):0.893851,Ardea_herodias:6.060735):2.16869,Butorides_virescens:8.229425):0.603762,(Nyctanassa_violacea:8.188923,Nycticorax_nycticorax:8.188923):0.644264):0.574409,(((Egretta_rufescens:2.458797,Egretta_tricolor:2.458797):0.831606,Egretta_caerulea:3.290403):0.72769,Egretta_thula:4.018093):5.389502):2.546481):12.342126,(Pelecanus_erythrorhynchos:4.196515,Pelecanus_occidentalis:4.196516):20.099686):1.029739,((Platalea_ajaja:10.269775,(Plegadis_chihi:1.91568,Plegadis_falcinellus:1.915681):8.354095):2.358493,Eudocimus_albus:12.628269):12.697674):23.512005,(((((Phalacrocorax_auritus:1.697021,Phalacrocorax_brasilianus:1.697021):4.515643,Phalacrocorax_pelagicus:6.212664):4.997287,Anhinga_anhinga:11.209951):0.906335,(Morus_bassanus:9.617198,((Sula_leucogaster:2.47621,((Sula_dactylatra:0.004781,Sula_granti:0.004781):1.517391,Sula_nebouxii:1.522171):0.954038):2.140455,Sula_sula:4.616665):5.000533):2.499087):3.324854,((Fregata_magnificens:1.44266,Fregata_minor:1.44266):0.346144,Fregata_ariel:1.788804):13.652335):33.396807):1.031774,Mycteria_americana:49.869719):10.866735,((((((Pterodroma_macroptera:4.865339,((Pterodroma_sandwichensis:2.79345,Pterodroma_inexpectata:2.79345):1.365143,Pterodroma_cookii:4.158592):0.706747):4.068484,(((((Puffinus_newelli:1.381885,Puffinus_opisthomelas:1.381886):0.190289,Puffinus_puffinus:1.572175):3.181206,(Calonectris_leucomelas:1.592278,Calonectris_diomedea:1.592278):3.161103):1.064218,(((((Puffinus_carneipes:0.252926,Puffinus_creatopus:0.252926):0.973591,Puffinus_gravis:1.226516):0.48506,Puffinus_griseus:1.711576):0.09139,Puffinus_tenuirostris:1.802967):0.861427,(Puffinus_pacificus:1.416031,Puffinus_bulleri:1.416031):1.248363):3.153204):2.328164,(Procellaria_aequinoctialis:6.579741,Bulweria_bulwerii:6.579741):1.566021):0.788063):0.331096,Fulmarus_glacialis:9.26492):2.922377,((Oceanodroma_leucorhoa:7.765483,Oceanodroma_furcata:7.765483):0.356616,(Oceanodroma_microsoma:4.768379,Oceanodroma_tethys:4.768379):3.353719):4.065199):0.620175,Oceanites_oceanicus:12.807472):0.306744,(((Phoebastria_immutabilis:1.85668,Phoebastria_nigripes:1.85668):0.562903,Phoebastria_albatrus:2.419582):3.929057,((Thalassarche_cauta:0.262255,Diomedea_exulans:0.262255):0.760039,Thalassarche_eremita:1.022293):5.326347):6.765577):47.622239):0.137649,((((Gavia_adamsii:0.408341,Gavia_immer:0.408341):1.063572,Gavia_pacifica:1.471913):0.976038,Gavia_arctica:2.447951):3.809025,Gavia_stellata:6.256976):54.617128):0.372954,(((Cuculus_canorus:15.46785,(Coccyzus_erythropthalmus:9.696905,Coccyzus_americanus:9.696905):5.770947):5.16665,(Crotophaga_sulcirostris:16.315965,Geococcyx_californianus:16.315966):4.318537):10.43379,((Grus_canadensis:4.416436,(Grus_grus:3.717184,Anthropoides_virgo:3.717186):0.69925):19.831011,(((Fulica_americana:5.83685,Gallinula_chloropus:5.836849):3.314091,Porzana_carolina:9.15094):2.511697,((Coturnicops_noveboracensis:9.425769,Porphyrio_martinica:9.42577):1.910547,Rallus_limicola:11.336317):0.32632):12.584809):6.820845):30.178765):0.407474):2.979476,(((((((((Anas_clypeata:0.896522,(Anas_cyanoptera:0.02564,Anas_discors:0.02564):0.870882):1.980189,Anas_querquedula:2.876711):1.426198,Anas_formosa:4.302908):0.61938,(((Anas_rubripes:0.509299,Anas_platyrhynchos:0.509298):2.714019,(Anas_crecca:2.915976,Anas_acuta:2.915976):0.307342):0.754771,((Anas_falcata:0.775449,Anas_strepera:0.775449):1.386797,(Anas_americana:1.223151,Anas_penelope:1.223151):0.939095):1.815842):0.9442):0.899565,(((Aythya_marila:0.342269,Aythya_affinis:0.342269):0.646013,Aythya_fuligula:0.988282):0.508005,((Aythya_americana:0.805757,Aythya_collaris:0.805757):0.461603,(Aythya_valisineria:0.396165,Aythya_ferina:0.396165):0.871195):0.228926):4.325566):1.213051,((((Aix_sponsa:2.982111,Aix_galericulata:2.982111):1.486653,Cairina_moschata:4.468764):1.560604,Alopochen_aegyptiaca:6.029367):0.673042,((((Bucephala_albeola:3.701376,(Bucephala_clangula:1.11771,Bucephala_islandica:1.11771):2.583666):1.514894,(((Mergus_merganser:1.873201,Mergus_serrator:1.873201):1.916388,Lophodytes_cucullatus:3.789589):0.829361,Mergellus_albellus:4.618949):0.59732):0.502879,(Melanitta_nigra:4.674791,(Melanitta_fusca:2.340277,Melanitta_perspicillata:2.340277):2.334514):1.044358):0.771899,((((Somateria_mollissima:0.295178,Somateria_spectabilis:0.295178):3.689931,Polysticta_stelleri:3.985109):1.109118,Histrionicus_histrionicus:5.094227):0.811149,Clangula_hyemalis:5.905376):0.585672):0.211362):0.332494):2.655406,(((((Branta_hutchinsii:0.999185,Branta_canadensis:0.999184):2.080501,Branta_bernicla:3.079685):1.059406,((Chen_rossii:0.014032,Chen_caerulescens:0.014032):1.252823,((Anser_albifrons:0.492808,Anser_fabalis:0.492808):0.615209,Chen_canagica:1.108017):0.158837):2.872236):2.225437,(Cygnus_olor:4.159087,((Cygnus_cygnus:0.684532,Cygnus_columbianus:0.684532):0.189911,Cygnus_buccinator:0.874443):3.284644):2.205441):2.888657,Oxyura_jamaicensis:9.253185):0.437126):3.174907,(Dendrocygna_bicolor:9.39956,Dendrocygna_autumnalis:9.39956):3.465657):41.141001,((((((Lagopus_leucura:4.060241,Centrocercus_urophasianus:4.06024):1.450073,Bonasa_umbellus:5.510314):1.796859,Meleagris_gallopavo:7.307173):0.657843,Phasianus_colchicus:7.965017):3.942481,Alectoris_chukar:11.907496):3.85599,((Callipepla_californica:0.906981,Callipepla_gambelii:0.906981):6.06878,Oreortyx_pictus:6.975761):8.787725):38.242733):10.627788);",ut=new Bu(st),kt=ut.render({height:sy,width:ry,"left-right-spacing":"fit-to-size","top-bottom-spacing":"fit-to-size","is-radial":!0,brush:!1,collapsible:!1,selectable:!1,reroot:!1,hide:!1,container:"#tree_container"});console.log(kt),console.log(ut.display),a&&kt.style_edges(function(Rt,Ge){a[g].includes(Ge.target.data.name)&&(Rt.style("stroke",Am()[500]),Rt.style("stroke-width","2px"))}),kt.update();let Bt=ut.display.show();if(Bt.querySelectorAll(".node-circle").forEach(Rt=>Rt.attr("r",0)),a)for(let Rt of a[g]){let Ge=Bt.querySelector(`[data-node-name="${Rt}"]`);Ge.firstChild,e_(Ge).append("circle").classed("node-circle",!0).attr("r",3).attr("title",Rt).style("fill",Am()[500])}Bt.setAttribute("width",ry),Bt.setAttribute("height",sy),Bt.setAttribute("viewBox",`0 0 ${ry/4} ${sy/4}`),console.log(Bt),E.appendChild(Bt),console.log(E.querySelectorAll(".node-circle")),E.querySelectorAll(".node-circle").forEach(Rt=>{Rt.addEventListener("mouseover",Ge=>{console.log(Ge),console.log(document.querySelector("#tree_container"));let ni=document.querySelector("#tree_container").clientWidth;n(5,fe=!1),U>ni/2&&n(5,fe=!0),n(3,ce=!0),n(4,oe=Ge.target.attributes.title.value)}),Rt.addEventListener("mouseout",Ge=>{n(3,ce=!1)})}),Bt.addEventListener("mousemove",Rt=>{console.log(Rt),!Rt.target.localName!=="svg"&&(n(1,U=Rt.offsetX),n(2,W=Rt.offsetY))})}async function et(Ke){return fetch(`/phast/data/${Ke}_hex_species.json`).then(st=>st.json()).then(st=>(n(9,a=JSON.parse(st[0])),a))}Zc(async()=>{et(b).then(Ke=>we()).then(()=>console.log("built node map"))});function lt(Ke){pa[Ke?"unshift":"push"](()=>{E=Ke,n(0,E)})}return e.$$set=Ke=>{"newick"in Ke&&n(6,c=Ke.newick),"hex_id"in Ke&&n(7,g=Ke.hex_id),"clade"in Ke&&n(8,b=Ke.clade)},e.$$.update=()=>{e.$$.dirty&321&&c&&E&&we(),e.$$.dirty&768&&b&&!a&&et(b)},[E,U,W,ce,oe,fe,c,g,b,a,lt]}class CF extends Lo{constructor(t){super(),Bo(this,t,EF,IF,co,{newick:6,hex_id:7,clade:8})}}function Jb(e){let t;return{c(){t=qn("div"),this.h()},l(n){t=Hn(n,"DIV",{class:!0}),Tn(t).forEach(Ci),this.h()},h(){Fi(t,"class","mdc-button__touch")},m(n,c){Zn(n,t,c)},d(n){n&&Ci(t)}}}function TF(e){let t,n,c,g;const b=e[28].default,E=nu(b,e,e[30],null);let a=e[6]&&Jb();return{c(){t=qn("div"),n=Or(),E&&E.c(),a&&a.c(),c=gs(),this.h()},l(U){t=Hn(U,"DIV",{class:!0}),Tn(t).forEach(Ci),n=Nr(U),E&&E.l(U),a&&a.l(U),c=gs(),this.h()},h(){Fi(t,"class","mdc-button__ripple")},m(U,W){Zn(U,t,W),Zn(U,n,W),E&&E.m(U,W),a&&a.m(U,W),Zn(U,c,W),g=!0},p(U,W){E&&E.p&&(!g||W[0]&1073741824)&&ru(E,b,U,U[30],g?au(b,U[30],W,null):su(U[30]),null),U[6]?a||(a=Jb(),a.c(),a.m(c.parentNode,c)):a&&(a.d(1),a=null)},i(U){g||(Ki(E,U),g=!0)},o(U){gn(E,U),g=!1},d(U){U&&(Ci(t),Ci(n),Ci(c)),E&&E.d(U),a&&a.d(U)}}}function kF(e){let t,n,c;const g=[{tag:e[10]},{use:[[Xd,{ripple:e[3],unbounded:!1,color:e[4],disabled:!!e[23].disabled,addClass:e[19],removeClass:e[20],addStyle:e[21]}],e[17],...e[0]]},{class:Ss({[e[1]]:!0,"mdc-button":!0,"mdc-button--raised":e[5]==="raised","mdc-button--unelevated":e[5]==="unelevated","mdc-button--outlined":e[5]==="outlined","smui-button--color-secondary":e[4]==="secondary","mdc-button--touch":e[6],"mdc-card__action":e[18]==="card:action","mdc-card__action--button":e[18]==="card:action","mdc-dialog__button":e[18]==="dialog:action","mdc-top-app-bar__navigation-icon":e[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":e[18]==="top-app-bar:action","mdc-snackbar__action":e[18]==="snackbar:actions","mdc-banner__secondary-action":e[18]==="banner"&&e[8],"mdc-banner__primary-action":e[18]==="banner"&&!e[8],"mdc-tooltip__action":e[18]==="tooltip:rich-actions",...e[12]})},{style:Object.entries(e[13]).map(ay).concat([e[2]]).join(" ")},e[16],e[15],e[14],{href:e[7]},e[23]];var b=e[9];function E(a,U){let W={$$slots:{default:[TF]},$$scope:{ctx:a}};if(U!==void 0&&U[0]&12580351)W=ma(g,[U[0]&1024&&{tag:a[10]},U[0]&12189721&&{use:[[Xd,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},U[0]&266610&&{class:Ss({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},U[0]&8196&&{style:Object.entries(a[13]).map(ay).concat([a[2]]).join(" ")},U[0]&65536&&Fs(a[16]),U[0]&32768&&Fs(a[15]),U[0]&16384&&Fs(a[14]),U[0]&128&&{href:a[7]},U[0]&8388608&&Fs(a[23])]);else for(let ce=0;ce<g.length;ce+=1)W=gr(W,g[ce]);return{props:W}}return b&&(t=JA(b,E(e)),e[29](t),t.$on("click",e[22])),{c(){t&&Is(t.$$.fragment),n=gs()},l(a){t&&$s(t.$$.fragment,a),n=gs()},m(a,U){t&&Es(t,a,U),Zn(a,n,U),c=!0},p(a,U){if(U[0]&512&&b!==(b=a[9])){if(t){fl();const W=t;gn(W.$$.fragment,1,0,()=>{Cs(W,1)}),dl()}b?(t=JA(b,E(a,U)),a[29](t),t.$on("click",a[22]),Is(t.$$.fragment),Ki(t.$$.fragment,1),Es(t,n.parentNode,n)):t=null}else if(b){const W=U[0]&12580351?ma(g,[U[0]&1024&&{tag:a[10]},U[0]&12189721&&{use:[[Xd,{ripple:a[3],unbounded:!1,color:a[4],disabled:!!a[23].disabled,addClass:a[19],removeClass:a[20],addStyle:a[21]}],a[17],...a[0]]},U[0]&266610&&{class:Ss({[a[1]]:!0,"mdc-button":!0,"mdc-button--raised":a[5]==="raised","mdc-button--unelevated":a[5]==="unelevated","mdc-button--outlined":a[5]==="outlined","smui-button--color-secondary":a[4]==="secondary","mdc-button--touch":a[6],"mdc-card__action":a[18]==="card:action","mdc-card__action--button":a[18]==="card:action","mdc-dialog__button":a[18]==="dialog:action","mdc-top-app-bar__navigation-icon":a[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":a[18]==="top-app-bar:action","mdc-snackbar__action":a[18]==="snackbar:actions","mdc-banner__secondary-action":a[18]==="banner"&&a[8],"mdc-banner__primary-action":a[18]==="banner"&&!a[8],"mdc-tooltip__action":a[18]==="tooltip:rich-actions",...a[12]})},U[0]&8196&&{style:Object.entries(a[13]).map(ay).concat([a[2]]).join(" ")},U[0]&65536&&Fs(a[16]),U[0]&32768&&Fs(a[15]),U[0]&16384&&Fs(a[14]),U[0]&128&&{href:a[7]},U[0]&8388608&&Fs(a[23])]):{};U[0]&1073741888&&(W.$$scope={dirty:U,ctx:a}),t.$set(W)}},i(a){c||(t&&Ki(t.$$.fragment,a),c=!0)},o(a){t&&gn(t.$$.fragment,a),c=!1},d(a){a&&Ci(n),e[29](null),t&&Cs(t,a)}}}const ay=([e,t])=>`${e}: ${t};`;function MF(e,t,n){let c,g,b;const E=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let a=uo(t,E),{$$slots:U={},$$scope:W}=t;const ce=wc(vc());let{use:oe=[]}=t,{class:fe=""}=t,{style:we=""}=t,{ripple:et=!0}=t,{color:lt="primary"}=t,{variant:Ke="text"}=t,{touch:st=!1}=t,{href:ut=void 0}=t,{action:kt="close"}=t,{defaultAction:Bt=!1}=t,{secondary:Rt=!1}=t,Ge,ni={},it={},xt=Eu("SMUI:button:context"),{component:_t=ef}=t,{tag:mt=_t===ef?ut==null?"button":"a":void 0}=t,bt=a.disabled;fu("SMUI:label:context","button"),fu("SMUI:icon:context","button");function dt(Dt){ni[Dt]||n(12,ni[Dt]=!0,ni)}function nt(Dt){(!(Dt in ni)||ni[Dt])&&n(12,ni[Dt]=!1,ni)}function pt(Dt,ci){it[Dt]!=ci&&(ci===""||ci==null?(delete it[Dt],n(13,it)):n(13,it[Dt]=ci,it))}function at(){xt==="banner"&&tu(Nt(),Rt?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function Nt(){return Ge.getElement()}function Ft(Dt){pa[Dt?"unshift":"push"](()=>{Ge=Dt,n(11,Ge)})}return e.$$set=Dt=>{n(31,t=gr(gr({},t),tc(Dt))),n(23,a=uo(t,E)),"use"in Dt&&n(0,oe=Dt.use),"class"in Dt&&n(1,fe=Dt.class),"style"in Dt&&n(2,we=Dt.style),"ripple"in Dt&&n(3,et=Dt.ripple),"color"in Dt&&n(4,lt=Dt.color),"variant"in Dt&&n(5,Ke=Dt.variant),"touch"in Dt&&n(6,st=Dt.touch),"href"in Dt&&n(7,ut=Dt.href),"action"in Dt&&n(24,kt=Dt.action),"defaultAction"in Dt&&n(25,Bt=Dt.defaultAction),"secondary"in Dt&&n(8,Rt=Dt.secondary),"component"in Dt&&n(9,_t=Dt.component),"tag"in Dt&&n(10,mt=Dt.tag),"$$scope"in Dt&&n(30,W=Dt.$$scope)},e.$$.update=()=>{if(n(16,c=xt==="dialog:action"&&kt!=null?{"data-mdc-dialog-action":kt}:{action:t.action}),n(15,g=xt==="dialog:action"&&Bt?{"data-mdc-dialog-button-default":""}:{default:t.default}),n(14,b=xt==="banner"?{}:{secondary:t.secondary}),bt!==a.disabled){const Dt=Nt();"blur"in Dt&&Dt.blur(),n(27,bt=a.disabled)}},t=tc(t),[oe,fe,we,et,lt,Ke,st,ut,Rt,_t,mt,Ge,ni,it,b,g,c,ce,xt,dt,nt,pt,at,a,kt,Bt,Nt,bt,U,Ft,W]}class PF extends Lo{constructor(t){super(),Bo(this,t,MF,kF,co,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}var XS={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.0/LICENSE.txt
 */(function(e,t){(function(n,c){e.exports=c()})(Kf,function(){var n={},c={};function g(E,a,U){if(c[E]=U,E==="index"){var W="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",ce={};return c.shared(ce),c.index(n,ce),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),n}}g("shared",["exports"],function(E){function a(m,h,x,M){return new(x||(x=Promise))(function(q,K){function J(Oe){try{Ce(M.next(Oe))}catch(f){K(f)}}function me(Oe){try{Ce(M.throw(Oe))}catch(f){K(f)}}function Ce(Oe){var f;Oe.done?q(Oe.value):(f=Oe.value,f instanceof x?f:new x(function(u){u(f)})).then(J,me)}Ce((M=M.apply(m,h||[])).next())})}function U(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}typeof SuppressedError=="function"&&SuppressedError;var W=ce;function ce(m,h){this.x=m,this.y=h}ce.prototype={clone:function(){return new ce(this.x,this.y)},add:function(m){return this.clone()._add(m)},sub:function(m){return this.clone()._sub(m)},multByPoint:function(m){return this.clone()._multByPoint(m)},divByPoint:function(m){return this.clone()._divByPoint(m)},mult:function(m){return this.clone()._mult(m)},div:function(m){return this.clone()._div(m)},rotate:function(m){return this.clone()._rotate(m)},rotateAround:function(m,h){return this.clone()._rotateAround(m,h)},matMult:function(m){return this.clone()._matMult(m)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(m){return this.x===m.x&&this.y===m.y},dist:function(m){return Math.sqrt(this.distSqr(m))},distSqr:function(m){var h=m.x-this.x,x=m.y-this.y;return h*h+x*x},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(m){return Math.atan2(this.y-m.y,this.x-m.x)},angleWith:function(m){return this.angleWithSep(m.x,m.y)},angleWithSep:function(m,h){return Math.atan2(this.x*h-this.y*m,this.x*m+this.y*h)},_matMult:function(m){var h=m[2]*this.x+m[3]*this.y;return this.x=m[0]*this.x+m[1]*this.y,this.y=h,this},_add:function(m){return this.x+=m.x,this.y+=m.y,this},_sub:function(m){return this.x-=m.x,this.y-=m.y,this},_mult:function(m){return this.x*=m,this.y*=m,this},_div:function(m){return this.x/=m,this.y/=m,this},_multByPoint:function(m){return this.x*=m.x,this.y*=m.y,this},_divByPoint:function(m){return this.x/=m.x,this.y/=m.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var m=this.y;return this.y=this.x,this.x=-m,this},_rotate:function(m){var h=Math.cos(m),x=Math.sin(m),M=x*this.x+h*this.y;return this.x=h*this.x-x*this.y,this.y=M,this},_rotateAround:function(m,h){var x=Math.cos(m),M=Math.sin(m),q=h.y+M*(this.x-h.x)+x*(this.y-h.y);return this.x=h.x+x*(this.x-h.x)-M*(this.y-h.y),this.y=q,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ce.convert=function(m){return m instanceof ce?m:Array.isArray(m)?new ce(m[0],m[1]):m};var oe=U(W),fe=we;function we(m,h,x,M){this.cx=3*m,this.bx=3*(x-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=x,this.p2y=M}we.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var x=m,M=0;M<8;M++){var q=this.sampleCurveX(x)-m;if(Math.abs(q)<h)return x;var K=this.sampleCurveDerivativeX(x);if(Math.abs(K)<1e-6)break;x-=q/K}var J=0,me=1;for(x=m,M=0;M<20&&(q=this.sampleCurveX(x),!(Math.abs(q-m)<h));M++)m>q?J=x:me=x,x=.5*(me-J)+J;return x},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var et=U(fe);let lt,Ke;function st(){return lt==null&&(lt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),lt}function ut(){if(Ke==null&&(Ke=!1,st())){const h=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(h){for(let M=0;M<5*5;M++){const q=4*M;h.fillStyle=`rgb(${q},${q+1},${q+2})`,h.fillRect(M%5,Math.floor(M/5),1,1)}const x=h.getImageData(0,0,5,5).data;for(let M=0;M<5*5*4;M++)if(M%4!=3&&x[M]!==M){Ke=!0;break}}}return Ke||!1}function kt(m,h,x,M){const q=new et(m,h,x,M);return function(K){return q.solve(K)}}const Bt=kt(.25,.1,.25,1);function Rt(m,h,x){return Math.min(x,Math.max(h,m))}function Ge(m,h,x){const M=x-h,q=((m-h)%M+M)%M+h;return q===h?x:q}function ni(m,...h){for(const x of h)for(const M in x)m[M]=x[M];return m}let it=1;function xt(m,h,x){const M={};for(const q in m)M[q]=h.call(x||this,m[q],q,m);return M}function _t(m,h,x){const M={};for(const q in m)h.call(x||this,m[q],q,m)&&(M[q]=m[q]);return M}function mt(m){return Array.isArray(m)?m.map(mt):typeof m=="object"&&m?xt(m,mt):m}const bt={};function dt(m){bt[m]||(typeof console<"u"&&console.warn(m),bt[m]=!0)}function nt(m,h,x){return(x.y-m.y)*(h.x-m.x)>(h.y-m.y)*(x.x-m.x)}function pt(m){let h=0;for(let x,M,q=0,K=m.length,J=K-1;q<K;J=q++)x=m[q],M=m[J],h+=(M.x-x.x)*(x.y+M.y);return h}function at(m){return typeof WorkerGlobalScope<"u"&&m!==void 0&&m instanceof WorkerGlobalScope}let Nt=null;function Ft(m){return typeof ImageBitmap<"u"&&m instanceof ImageBitmap}const Dt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ci(m,h,x,M,q){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const K=new VideoFrame(m,{timestamp:0});try{const J=K==null?void 0:K.format;if(!J||!J.startsWith("BGR")&&!J.startsWith("RGB"))throw new Error(`Unrecognized format ${J}`);const me=J.startsWith("BGR"),Ce=new Uint8ClampedArray(M*q*4);if(yield K.copyTo(Ce,function(Oe,f,u,p,S){const L=4*Math.max(-f,0),G=(Math.max(0,u)-u)*p*4+L,Q=4*p,re=Math.max(0,f),he=Math.max(0,u);return{rect:{x:re,y:he,width:Math.min(Oe.width,f+p)-re,height:Math.min(Oe.height,u+S)-he},layout:[{offset:G,stride:Q}]}}(m,h,x,M,q)),me)for(let Oe=0;Oe<Ce.length;Oe+=4){const f=Ce[Oe];Ce[Oe]=Ce[Oe+2],Ce[Oe+2]=f}return Ce}finally{K.close()}})}let bi,ki;const Gi="AbortError";function rn(){return new Error(Gi)}const $i={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function qi(m){return $i.REGISTERED_PROTOCOLS[m.substring(0,m.indexOf("://"))]}const sn="global-dispatcher";class Ti extends Error{constructor(h,x,M,q){super(`AJAXError: ${x} (${h}): ${M}`),this.status=h,this.statusText=x,this.url=M,this.body=q}}const yi=()=>at(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,hi=function(m,h){if(/:\/\//.test(m.url)&&!/^https?:|^file:/.test(m.url)){const M=qi(m.url);if(M)return M(m,h);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,targetMapId:sn},h)}if(!(/^file:/.test(x=m.url)||/^file:/.test(yi())&&!/^\w+:/.test(x))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(M,q){return a(this,void 0,void 0,function*(){const K=new Request(M.url,{method:M.method||"GET",body:M.body,credentials:M.credentials,headers:M.headers,cache:M.cache,referrer:yi(),signal:q.signal});M.type==="json"&&K.headers.set("Accept","application/json");const J=yield fetch(K);if(!J.ok){const Oe=yield J.blob();throw new Ti(J.status,J.statusText,M.url,Oe)}const me=M.type==="arrayBuffer"||M.type==="image"?J.arrayBuffer():M.type==="json"?J.json():J.text(),Ce=yield me;if(q.signal.aborted)throw rn();return{data:Ce,cacheControl:J.headers.get("Cache-Control"),expires:J.headers.get("Expires")}})}(m,h);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:m,mustQueue:!0,targetMapId:sn},h)}var x;return function(M,q){return new Promise((K,J)=>{const me=new XMLHttpRequest;me.open(M.method||"GET",M.url,!0),M.type!=="arrayBuffer"&&M.type!=="image"||(me.responseType="arraybuffer");for(const Ce in M.headers)me.setRequestHeader(Ce,M.headers[Ce]);M.type==="json"&&(me.responseType="text",me.setRequestHeader("Accept","application/json")),me.withCredentials=M.credentials==="include",me.onerror=()=>{J(new Error(me.statusText))},me.onload=()=>{if(!q.signal.aborted)if((me.status>=200&&me.status<300||me.status===0)&&me.response!==null){let Ce=me.response;if(M.type==="json")try{Ce=JSON.parse(me.response)}catch(Oe){return void J(Oe)}K({data:Ce,cacheControl:me.getResponseHeader("Cache-Control"),expires:me.getResponseHeader("Expires")})}else{const Ce=new Blob([me.response],{type:me.getResponseHeader("Content-Type")});J(new Ti(me.status,me.statusText,M.url,Ce))}},q.signal.addEventListener("abort",()=>{me.abort(),J(rn())}),me.send(M.body)})}(m,h)};function Ei(m){if(!m||m.indexOf("://")<=0||m.indexOf("data:image/")===0||m.indexOf("blob:")===0)return!0;const h=new URL(m),x=window.location;return h.protocol===x.protocol&&h.host===x.host}function Li(m,h,x){x[m]&&x[m].indexOf(h)!==-1||(x[m]=x[m]||[],x[m].push(h))}function fn(m,h,x){if(x&&x[m]){const M=x[m].indexOf(h);M!==-1&&x[m].splice(M,1)}}class _n{constructor(h,x={}){ni(this,x),this.type=h}}class gi extends _n{constructor(h,x={}){super("error",ni({error:h},x))}}class mn{on(h,x){return this._listeners=this._listeners||{},Li(h,x,this._listeners),this}off(h,x){return fn(h,x,this._listeners),fn(h,x,this._oneTimeListeners),this}once(h,x){return x?(this._oneTimeListeners=this._oneTimeListeners||{},Li(h,x,this._oneTimeListeners),this):new Promise(M=>this.once(h,M))}fire(h,x){typeof h=="string"&&(h=new _n(h,x||{}));const M=h.type;if(this.listens(M)){h.target=this;const q=this._listeners&&this._listeners[M]?this._listeners[M].slice():[];for(const me of q)me.call(this,h);const K=this._oneTimeListeners&&this._oneTimeListeners[M]?this._oneTimeListeners[M].slice():[];for(const me of K)fn(M,me,this._oneTimeListeners),me.call(this,h);const J=this._eventedParent;J&&(ni(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),J.fire(h))}else h instanceof gi&&console.error(h.error);return this}listens(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)}setEventedParent(h,x){return this._eventedParent=h,this._eventedParentData=x,this}}var ti={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Mn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ns(m,h){const x={};for(const M in m)M!=="ref"&&(x[M]=m[M]);return Mn.forEach(M=>{M in h&&(x[M]=h[M])}),x}function fi(m,h){if(Array.isArray(m)){if(!Array.isArray(h)||m.length!==h.length)return!1;for(let x=0;x<m.length;x++)if(!fi(m[x],h[x]))return!1;return!0}if(typeof m=="object"&&m!==null&&h!==null){if(typeof h!="object"||Object.keys(m).length!==Object.keys(h).length)return!1;for(const x in m)if(!fi(m[x],h[x]))return!1;return!0}return m===h}function ln(m,h){m.push(h)}function pr(m,h,x){ln(x,{command:"addSource",args:[m,h[m]]})}function On(m,h,x){ln(h,{command:"removeSource",args:[m]}),x[m]=!0}function Qn(m,h,x,M){On(m,x,M),pr(m,h,x)}function wn(m,h,x){let M;for(M in m[x])if(Object.prototype.hasOwnProperty.call(m[x],M)&&M!=="data"&&!fi(m[x][M],h[x][M]))return!1;for(M in h[x])if(Object.prototype.hasOwnProperty.call(h[x],M)&&M!=="data"&&!fi(m[x][M],h[x][M]))return!1;return!0}function v(m,h,x,M,q,K){m=m||{},h=h||{};for(const J in m)Object.prototype.hasOwnProperty.call(m,J)&&(fi(m[J],h[J])||x.push({command:K,args:[M,J,h[J],q]}));for(const J in h)Object.prototype.hasOwnProperty.call(h,J)&&!Object.prototype.hasOwnProperty.call(m,J)&&(fi(m[J],h[J])||x.push({command:K,args:[M,J,h[J],q]}))}function k(m){return m.id}function V(m,h){return m[h.id]=h,m}class ${constructor(h,x,M,q){this.message=(h?`${h}: `:"")+M,q&&(this.identifier=q),x!=null&&x.__line__&&(this.line=x.__line__)}}function te(m,...h){for(const x of h)for(const M in x)m[M]=x[M];return m}class Ae extends Error{constructor(h,x){super(x),this.message=x,this.key=h}}class ve{constructor(h,x=[]){this.parent=h,this.bindings={};for(const[M,q]of x)this.bindings[M]=q}concat(h){return new ve(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}const Ie={kind:"null"},Ee={kind:"number"},ze={kind:"string"},Qe={kind:"boolean"},He={kind:"color"},Ze={kind:"object"},Ve={kind:"value"},ft={kind:"collator"},rt={kind:"formatted"},Me={kind:"padding"},se={kind:"resolvedImage"},ne={kind:"variableAnchorOffsetCollection"};function X(m,h){return{kind:"array",itemType:m,N:h}}function ie(m){if(m.kind==="array"){const h=ie(m.itemType);return typeof m.N=="number"?`array<${h}, ${m.N}>`:m.itemType.kind==="value"?"array":`array<${h}>`}return m.kind}const de=[Ie,Ee,ze,Qe,He,rt,Ze,X(Ve),Me,se,ne];function ye(m,h){if(h.kind==="error")return null;if(m.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!ye(m.itemType,h.itemType))&&(typeof m.N!="number"||m.N===h.N))return null}else{if(m.kind===h.kind)return null;if(m.kind==="value"){for(const x of de)if(!ye(x,h))return null}}return`Expected ${ie(m)} but found ${ie(h)} instead.`}function ge(m,h){return h.some(x=>x.kind===m.kind)}function Pe(m,h){return h.some(x=>x==="null"?m===null:x==="array"?Array.isArray(m):x==="object"?m&&!Array.isArray(m)&&typeof m=="object":x===typeof m)}function Fe(m,h){return m.kind==="array"&&h.kind==="array"?m.itemType.kind===h.itemType.kind&&typeof m.N=="number":m.kind===h.kind}const Ne=.96422,Xe=.82521,Ye=4/29,De=6/29,Ue=3*De*De,ht=De*De*De,Tt=Math.PI/180,o=180/Math.PI;function ke(m){return(m%=360)<0&&(m+=360),m}function ai([m,h,x,M]){let q,K;const J=Ai((.2225045*(m=di(m))+.7168786*(h=di(h))+.0606169*(x=di(x)))/1);m===h&&h===x?q=K=J:(q=Ai((.4360747*m+.3850649*h+.1430804*x)/Ne),K=Ai((.0139322*m+.0971045*h+.7141733*x)/Xe));const me=116*J-16;return[me<0?0:me,500*(q-J),200*(J-K),M]}function di(m){return m<=.04045?m/12.92:Math.pow((m+.055)/1.055,2.4)}function Ai(m){return m>ht?Math.pow(m,1/3):m/Ue+Ye}function Kt([m,h,x,M]){let q=(m+16)/116,K=isNaN(h)?q:q+h/500,J=isNaN(x)?q:q-x/200;return q=1*Ri(q),K=Ne*Ri(K),J=Xe*Ri(J),[oi(3.1338561*K-1.6168667*q-.4906146*J),oi(-.9787684*K+1.9161415*q+.033454*J),oi(.0719453*K-.2289914*q+1.4052427*J),M]}function oi(m){return(m=m<=.00304?12.92*m:1.055*Math.pow(m,1/2.4)-.055)<0?0:m>1?1:m}function Ri(m){return m>De?m*m*m:Ue*(m-Ye)}function vi(m){return parseInt(m.padEnd(2,m),16)/255}function wi(m,h){return Yt(h?m/100:m,0,1)}function Yt(m,h,x){return Math.min(Math.max(h,m),x)}function vn(m){return!m.some(Number.isNaN)}const ar={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class dn{constructor(h,x,M,q=1,K=!0){this.r=h,this.g=x,this.b=M,this.a=q,K||(this.r*=q,this.g*=q,this.b*=q,q||this.overwriteGetter("rgb",[h,x,M,q]))}static parse(h){if(h instanceof dn)return h;if(typeof h!="string")return;const x=function(M){if((M=M.toLowerCase().trim())==="transparent")return[0,0,0,0];const q=ar[M];if(q){const[J,me,Ce]=q;return[J/255,me/255,Ce/255,1]}if(M.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(M)){const J=M.length<6?1:2;let me=1;return[vi(M.slice(me,me+=J)),vi(M.slice(me,me+=J)),vi(M.slice(me,me+=J)),vi(M.slice(me,me+J)||"ff")]}if(M.startsWith("rgb")){const J=M.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(J){const[me,Ce,Oe,f,u,p,S,L,G,Q,re,he]=J,_e=[f||" ",S||" ",Q].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const Le=[Oe,p,G].join(""),qe=Le==="%%%"?100:Le===""?255:0;if(qe){const Je=[Yt(+Ce/qe,0,1),Yt(+u/qe,0,1),Yt(+L/qe,0,1),re?wi(+re,he):1];if(vn(Je))return Je}}return}}const K=M.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(K){const[J,me,Ce,Oe,f,u,p,S,L]=K,G=[Ce||" ",f||" ",p].join("");if(G==="  "||G==="  /"||G===",,"||G===",,,"){const Q=[+me,Yt(+Oe,0,100),Yt(+u,0,100),S?wi(+S,L):1];if(vn(Q))return function([re,he,_e,Le]){function qe(Je){const At=(Je+re/30)%12,gt=he*Math.min(_e,1-_e);return _e-gt*Math.max(-1,Math.min(At-3,9-At,1))}return re=ke(re),he/=100,_e/=100,[qe(0),qe(8),qe(4),Le]}(Q)}}}(h);return x?new dn(...x,!1):void 0}get rgb(){const{r:h,g:x,b:M,a:q}=this,K=q||1/0;return this.overwriteGetter("rgb",[h/K,x/K,M/K,q])}get hcl(){return this.overwriteGetter("hcl",function(h){const[x,M,q,K]=ai(h),J=Math.sqrt(M*M+q*q);return[Math.round(1e4*J)?ke(Math.atan2(q,M)*o):NaN,J,x,K]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ai(this.rgb))}overwriteGetter(h,x){return Object.defineProperty(this,h,{value:x}),x}toString(){const[h,x,M,q]=this.rgb;return`rgba(${[h,x,M].map(K=>Math.round(255*K)).join(",")},${q})`}}dn.black=new dn(0,0,0,1),dn.white=new dn(1,1,1,1),dn.transparent=new dn(0,0,0,0),dn.red=new dn(1,0,0,1);class Vn{constructor(h,x,M){this.sensitivity=h?x?"variant":"case":x?"accent":"base",this.locale=M,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,x){return this.collator.compare(h,x)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Hr{constructor(h,x,M,q,K){this.text=h,this.image=x,this.scale=M,this.fontStack=q,this.textColor=K}}class Hi{constructor(h){this.sections=h}static fromString(h){return new Hi([new Hr(h,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(h=>h.text.length!==0||h.image&&h.image.name.length!==0)}static factory(h){return h instanceof Hi?h:Hi.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map(h=>h.text).join("")}}class lr{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof lr)return h;if(typeof h=="number")return new lr([h,h,h,h]);if(Array.isArray(h)&&!(h.length<1||h.length>4)){for(const x of h)if(typeof x!="number")return;switch(h.length){case 1:h=[h[0],h[0],h[0],h[0]];break;case 2:h=[h[0],h[1],h[0],h[1]];break;case 3:h=[h[0],h[1],h[2],h[1]]}return new lr(h)}}toString(){return JSON.stringify(this.values)}}const Fn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Qt{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof Qt)return h;if(Array.isArray(h)&&!(h.length<1)&&h.length%2==0){for(let x=0;x<h.length;x+=2){const M=h[x],q=h[x+1];if(typeof M!="string"||!Fn.has(M)||!Array.isArray(q)||q.length!==2||typeof q[0]!="number"||typeof q[1]!="number")return}return new Qt(h)}}toString(){return JSON.stringify(this.values)}}class Yi{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new Yi({name:h,available:!1}):null}}function Ut(m,h,x,M){return typeof m=="number"&&m>=0&&m<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof x=="number"&&x>=0&&x<=255?M===void 0||typeof M=="number"&&M>=0&&M<=1?null:`Invalid rgba value [${[m,h,x,M].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof M=="number"?[m,h,x,M]:[m,h,x]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function En(m){if(m===null||typeof m=="string"||typeof m=="boolean"||typeof m=="number"||m instanceof dn||m instanceof Vn||m instanceof Hi||m instanceof lr||m instanceof Qt||m instanceof Yi)return!0;if(Array.isArray(m)){for(const h of m)if(!En(h))return!1;return!0}if(typeof m=="object"){for(const h in m)if(!En(m[h]))return!1;return!0}return!1}function ur(m){if(m===null)return Ie;if(typeof m=="string")return ze;if(typeof m=="boolean")return Qe;if(typeof m=="number")return Ee;if(m instanceof dn)return He;if(m instanceof Vn)return ft;if(m instanceof Hi)return rt;if(m instanceof lr)return Me;if(m instanceof Qt)return ne;if(m instanceof Yi)return se;if(Array.isArray(m)){const h=m.length;let x;for(const M of m){const q=ur(M);if(x){if(x===q)continue;x=Ve;break}x=q}return X(x||Ve,h)}return Ze}function Ns(m){const h=typeof m;return m===null?"":h==="string"||h==="number"||h==="boolean"?String(m):m instanceof dn||m instanceof Hi||m instanceof lr||m instanceof Qt||m instanceof Yi?m.toString():JSON.stringify(m)}class Vr{constructor(h,x){this.type=h,this.value=x}static parse(h,x){if(h.length!==2)return x.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!En(h[1]))return x.error("invalid value");const M=h[1];let q=ur(M);const K=x.expectedType;return q.kind!=="array"||q.N!==0||!K||K.kind!=="array"||typeof K.N=="number"&&K.N!==0||(q=K),new Vr(q,M)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Vt{constructor(h){this.name="ExpressionEvaluationError",this.message=h}toJSON(){return this.message}}const cr={string:ze,number:Ee,boolean:Qe,object:Ze};class Lt{constructor(h,x){this.type=h,this.args=x}static parse(h,x){if(h.length<2)return x.error("Expected at least one argument.");let M,q=1;const K=h[0];if(K==="array"){let me,Ce;if(h.length>2){const Oe=h[1];if(typeof Oe!="string"||!(Oe in cr)||Oe==="object")return x.error('The item type argument of "array" must be one of string, number, boolean',1);me=cr[Oe],q++}else me=Ve;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return x.error('The length argument to "array" must be a positive integer literal',2);Ce=h[2],q++}M=X(me,Ce)}else{if(!cr[K])throw new Error(`Types doesn't contain name = ${K}`);M=cr[K]}const J=[];for(;q<h.length;q++){const me=x.parse(h[q],q,Ve);if(!me)return null;J.push(me)}return new Lt(M,J)}evaluate(h){for(let x=0;x<this.args.length;x++){const M=this.args[x].evaluate(h);if(!ye(this.type,ur(M)))return M;if(x===this.args.length-1)throw new Vt(`Expected value to be of type ${ie(this.type)}, but found ${ie(ur(M))} instead.`)}throw new Error}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const Br={"to-boolean":Qe,"to-color":He,"to-number":Ee,"to-string":ze};class Vs{constructor(h,x){this.type=h,this.args=x}static parse(h,x){if(h.length<2)return x.error("Expected at least one argument.");const M=h[0];if(!Br[M])throw new Error(`Can't parse ${M} as it is not part of the known types`);if((M==="to-boolean"||M==="to-string")&&h.length!==2)return x.error("Expected one argument.");const q=Br[M],K=[];for(let J=1;J<h.length;J++){const me=x.parse(h[J],J,Ve);if(!me)return null;K.push(me)}return new Vs(q,K)}evaluate(h){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(h);case"color":{let x,M;for(const q of this.args){if(x=q.evaluate(h),M=null,x instanceof dn)return x;if(typeof x=="string"){const K=h.parseColor(x);if(K)return K}else if(Array.isArray(x)&&(M=x.length<3||x.length>4?`Invalid rbga value ${JSON.stringify(x)}: expected an array containing either three or four numeric values.`:Ut(x[0],x[1],x[2],x[3]),!M))return new dn(x[0]/255,x[1]/255,x[2]/255,x[3])}throw new Vt(M||`Could not parse color from value '${typeof x=="string"?x:JSON.stringify(x)}'`)}case"padding":{let x;for(const M of this.args){x=M.evaluate(h);const q=lr.parse(x);if(q)return q}throw new Vt(`Could not parse padding from value '${typeof x=="string"?x:JSON.stringify(x)}'`)}case"variableAnchorOffsetCollection":{let x;for(const M of this.args){x=M.evaluate(h);const q=Qt.parse(x);if(q)return q}throw new Vt(`Could not parse variableAnchorOffsetCollection from value '${typeof x=="string"?x:JSON.stringify(x)}'`)}case"number":{let x=null;for(const M of this.args){if(x=M.evaluate(h),x===null)return 0;const q=Number(x);if(!isNaN(q))return q}throw new Vt(`Could not convert ${JSON.stringify(x)} to number.`)}case"formatted":return Hi.fromString(Ns(this.args[0].evaluate(h)));case"resolvedImage":return Yi.fromString(Ns(this.args[0].evaluate(h)));default:return Ns(this.args[0].evaluate(h))}}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const ua=["Unknown","Point","LineString","Polygon"];class kr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ua[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(h){let x=this._parseColorCache[h];return x||(x=this._parseColorCache[h]=dn.parse(h)),x}}class Fa{constructor(h,x,M=[],q,K=new ve,J=[]){this.registry=h,this.path=M,this.key=M.map(me=>`[${me}]`).join(""),this.scope=K,this.errors=J,this.expectedType=q,this._isConstant=x}parse(h,x,M,q,K={}){return x?this.concat(x,M,q)._parse(h,K):this._parse(h,K)}_parse(h,x){function M(q,K,J){return J==="assert"?new Lt(K,[q]):J==="coerce"?new Vs(K,[q]):q}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const q=h[0];if(typeof q!="string")return this.error(`Expression name must be a string, but found ${typeof q} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const K=this.registry[q];if(K){let J=K.parse(h,this);if(!J)return null;if(this.expectedType){const me=this.expectedType,Ce=J.type;if(me.kind!=="string"&&me.kind!=="number"&&me.kind!=="boolean"&&me.kind!=="object"&&me.kind!=="array"||Ce.kind!=="value")if(me.kind!=="color"&&me.kind!=="formatted"&&me.kind!=="resolvedImage"||Ce.kind!=="value"&&Ce.kind!=="string")if(me.kind!=="padding"||Ce.kind!=="value"&&Ce.kind!=="number"&&Ce.kind!=="array")if(me.kind!=="variableAnchorOffsetCollection"||Ce.kind!=="value"&&Ce.kind!=="array"){if(this.checkSubtype(me,Ce))return null}else J=M(J,me,x.typeAnnotation||"coerce");else J=M(J,me,x.typeAnnotation||"coerce");else J=M(J,me,x.typeAnnotation||"coerce");else J=M(J,me,x.typeAnnotation||"assert")}if(!(J instanceof Vr)&&J.type.kind!=="resolvedImage"&&this._isConstant(J)){const me=new kr;try{J=new Vr(J.type,J.evaluate(me))}catch(Ce){return this.error(Ce.message),null}}return J}return this.error(`Unknown expression "${q}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,x,M){const q=typeof h=="number"?this.path.concat(h):this.path,K=M?this.scope.concat(M):this.scope;return new Fa(this.registry,this._isConstant,q,x||null,K,this.errors)}error(h,...x){const M=`${this.key}${x.map(q=>`[${q}]`).join("")}`;this.errors.push(new Ae(M,h))}checkSubtype(h,x){const M=ye(h,x);return M&&this.error(M),M}}class zo{constructor(h,x,M){this.type=ft,this.locale=M,this.caseSensitive=h,this.diacriticSensitive=x}static parse(h,x){if(h.length!==2)return x.error("Expected one argument.");const M=h[1];if(typeof M!="object"||Array.isArray(M))return x.error("Collator options argument must be an object.");const q=x.parse(M["case-sensitive"]!==void 0&&M["case-sensitive"],1,Qe);if(!q)return null;const K=x.parse(M["diacritic-sensitive"]!==void 0&&M["diacritic-sensitive"],1,Qe);if(!K)return null;let J=null;return M.locale&&(J=x.parse(M.locale,1,ze),!J)?null:new zo(q,K,J)}evaluate(h){return new Vn(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}}const Oa=8192;function Xs(m,h){m[0]=Math.min(m[0],h[0]),m[1]=Math.min(m[1],h[1]),m[2]=Math.max(m[2],h[0]),m[3]=Math.max(m[3],h[1])}function jn(m,h){return!(m[0]<=h[0]||m[2]>=h[2]||m[1]<=h[1]||m[3]>=h[3])}function aa(m,h){const x=(180+m[0])/360,M=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m[1]*Math.PI/360)))/360,q=Math.pow(2,h.z);return[Math.round(x*q*Oa),Math.round(M*q*Oa)]}function ls(m,h,x){const M=m[0]-h[0],q=m[1]-h[1],K=m[0]-x[0],J=m[1]-x[1];return M*J-K*q==0&&M*K<=0&&q*J<=0}function Na(m,h){let x=!1;for(let J=0,me=h.length;J<me;J++){const Ce=h[J];for(let Oe=0,f=Ce.length;Oe<f-1;Oe++){if(ls(m,Ce[Oe],Ce[Oe+1]))return!1;(q=Ce[Oe])[1]>(M=m)[1]!=(K=Ce[Oe+1])[1]>M[1]&&M[0]<(K[0]-q[0])*(M[1]-q[1])/(K[1]-q[1])+q[0]&&(x=!x)}}var M,q,K;return x}function rl(m,h){for(let x=0;x<h.length;x++)if(Na(m,h[x]))return!0;return!1}function sl(m,h,x,M){const q=M[0]-x[0],K=M[1]-x[1],J=(m[0]-x[0])*K-q*(m[1]-x[1]),me=(h[0]-x[0])*K-q*(h[1]-x[1]);return J>0&&me<0||J<0&&me>0}function Ja(m,h,x){for(const Oe of x)for(let f=0;f<Oe.length-1;++f)if((me=[(J=Oe[f+1])[0]-(K=Oe[f])[0],J[1]-K[1]])[0]*(Ce=[(q=h)[0]-(M=m)[0],q[1]-M[1]])[1]-me[1]*Ce[0]!=0&&sl(M,q,K,J)&&sl(K,J,M,q))return!0;var M,q,K,J,me,Ce;return!1}function Va(m,h){for(let x=0;x<m.length;++x)if(!Na(m[x],h))return!1;for(let x=0;x<m.length-1;++x)if(Ja(m[x],m[x+1],h))return!1;return!0}function N(m,h){for(let x=0;x<h.length;x++)if(Va(m,h[x]))return!0;return!1}function xe(m,h,x){const M=[];for(let q=0;q<m.length;q++){const K=[];for(let J=0;J<m[q].length;J++){const me=aa(m[q][J],x);Xs(h,me),K.push(me)}M.push(K)}return M}function tt(m,h,x){const M=[];for(let q=0;q<m.length;q++){const K=xe(m[q],h,x);M.push(K)}return M}function It(m,h,x,M){if(m[0]<x[0]||m[0]>x[2]){const q=.5*M;let K=m[0]-x[0]>q?-M:x[0]-m[0]>q?M:0;K===0&&(K=m[0]-x[2]>q?-M:x[2]-m[0]>q?M:0),m[0]+=K}Xs(h,m)}function Wt(m,h,x,M){const q=Math.pow(2,M.z)*Oa,K=[M.x*Oa,M.y*Oa],J=[];for(const me of m)for(const Ce of me){const Oe=[Ce.x+K[0],Ce.y+K[1]];It(Oe,h,x,q),J.push(Oe)}return J}function Si(m,h,x,M){const q=Math.pow(2,M.z)*Oa,K=[M.x*Oa,M.y*Oa],J=[];for(const Ce of m){const Oe=[];for(const f of Ce){const u=[f.x+K[0],f.y+K[1]];Xs(h,u),Oe.push(u)}J.push(Oe)}if(h[2]-h[0]<=q/2){(me=h)[0]=me[1]=1/0,me[2]=me[3]=-1/0;for(const Ce of J)for(const Oe of Ce)It(Oe,h,x,q)}var me;return J}class Bi{constructor(h,x){this.type=Qe,this.geojson=h,this.geometries=x}static parse(h,x){if(h.length!==2)return x.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(En(h[1])){const M=h[1];if(M.type==="FeatureCollection"){const q=[];for(const K of M.features){const{type:J,coordinates:me}=K.geometry;J==="Polygon"&&q.push(me),J==="MultiPolygon"&&q.push(...me)}if(q.length)return new Bi(M,{type:"MultiPolygon",coordinates:q})}else if(M.type==="Feature"){const q=M.geometry.type;if(q==="Polygon"||q==="MultiPolygon")return new Bi(M,M.geometry)}else if(M.type==="Polygon"||M.type==="MultiPolygon")return new Bi(M,M)}return x.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(x,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=x.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=Wt(x.geometry(),q,K,J);if(!jn(q,K))return!1;for(const Oe of Ce)if(!Na(Oe,me))return!1}if(M.type==="MultiPolygon"){const me=tt(M.coordinates,K,J),Ce=Wt(x.geometry(),q,K,J);if(!jn(q,K))return!1;for(const Oe of Ce)if(!rl(Oe,me))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(x,M){const q=[1/0,1/0,-1/0,-1/0],K=[1/0,1/0,-1/0,-1/0],J=x.canonicalID();if(M.type==="Polygon"){const me=xe(M.coordinates,K,J),Ce=Si(x.geometry(),q,K,J);if(!jn(q,K))return!1;for(const Oe of Ce)if(!Va(Oe,me))return!1}if(M.type==="MultiPolygon"){const me=tt(M.coordinates,K,J),Ce=Si(x.geometry(),q,K,J);if(!jn(q,K))return!1;for(const Oe of Ce)if(!N(Oe,me))return!1}return!0}(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class un{constructor(h,x){this.type=x.type,this.name=h,this.boundExpression=x}static parse(h,x){if(h.length!==2||typeof h[1]!="string")return x.error("'var' expression requires exactly one string literal argument.");const M=h[1];return x.scope.has(M)?new un(M,x.scope.get(M)):x.error(`Unknown variable "${M}". Make sure "${M}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}}class An{constructor(h,x,M,q){this.name=h,this.type=x,this._evaluate=M,this.args=q}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}static parse(h,x){const M=h[0],q=An.definitions[M];if(!q)return x.error(`Unknown expression "${M}". If you wanted a literal array, use ["literal", [...]].`,0);const K=Array.isArray(q)?q[0]:q.type,J=Array.isArray(q)?[[q[1],q[2]]]:q.overloads,me=J.filter(([Oe])=>!Array.isArray(Oe)||Oe.length===h.length-1);let Ce=null;for(const[Oe,f]of me){Ce=new Fa(x.registry,rr,x.path,null,x.scope);const u=[];let p=!1;for(let S=1;S<h.length;S++){const L=h[S],G=Array.isArray(Oe)?Oe[S-1]:Oe.type,Q=Ce.parse(L,1+u.length,G);if(!Q){p=!0;break}u.push(Q)}if(!p)if(Array.isArray(Oe)&&Oe.length!==u.length)Ce.error(`Expected ${Oe.length} arguments, but found ${u.length} instead.`);else{for(let S=0;S<u.length;S++){const L=Array.isArray(Oe)?Oe[S]:Oe.type,G=u[S];Ce.concat(S+1).checkSubtype(L,G.type)}if(Ce.errors.length===0)return new An(M,K,f,u)}}if(me.length===1)x.errors.push(...Ce.errors);else{const Oe=(me.length?me:J).map(([u])=>{return p=u,Array.isArray(p)?`(${p.map(ie).join(", ")})`:`(${ie(p.type)}...)`;var p}).join(" | "),f=[];for(let u=1;u<h.length;u++){const p=x.parse(h[u],1+f.length);if(!p)return null;f.push(ie(p.type))}x.error(`Expected arguments of type ${Oe}, but found (${f.join(", ")}) instead.`)}return null}static register(h,x){An.definitions=x;for(const M in x)h[M]=An}}function rr(m){if(m instanceof un)return rr(m.boundExpression);if(m instanceof An&&m.name==="error"||m instanceof zo||m instanceof Bi)return!1;const h=m instanceof Vs||m instanceof Lt;let x=!0;return m.eachChild(M=>{x=h?x&&rr(M):x&&M instanceof Vr}),!!x&&hr(m)&&Ua(m,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function hr(m){if(m instanceof An&&(m.name==="get"&&m.args.length===1||m.name==="feature-state"||m.name==="has"&&m.args.length===1||m.name==="properties"||m.name==="geometry-type"||m.name==="id"||/^filter-/.test(m.name))||m instanceof Bi)return!1;let h=!0;return m.eachChild(x=>{h&&!hr(x)&&(h=!1)}),h}function zr(m){if(m instanceof An&&m.name==="feature-state")return!1;let h=!0;return m.eachChild(x=>{h&&!zr(x)&&(h=!1)}),h}function Ua(m,h){if(m instanceof An&&h.indexOf(m.name)>=0)return!1;let x=!0;return m.eachChild(M=>{x&&!Ua(M,h)&&(x=!1)}),x}function Ga(m,h){const x=m.length-1;let M,q,K=0,J=x,me=0;for(;K<=J;)if(me=Math.floor((K+J)/2),M=m[me],q=m[me+1],M<=h){if(me===x||h<q)return me;K=me+1}else{if(!(M>h))throw new Vt("Input is not a number.");J=me-1}return 0}class qa{constructor(h,x,M){this.type=h,this.input=x,this.labels=[],this.outputs=[];for(const[q,K]of M)this.labels.push(q),this.outputs.push(K)}static parse(h,x){if(h.length-1<4)return x.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return x.error("Expected an even number of arguments.");const M=x.parse(h[1],1,Ee);if(!M)return null;const q=[];let K=null;x.expectedType&&x.expectedType.kind!=="value"&&(K=x.expectedType);for(let J=1;J<h.length;J+=2){const me=J===1?-1/0:h[J],Ce=h[J+1],Oe=J,f=J+1;if(typeof me!="number")return x.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Oe);if(q.length&&q[q.length-1][0]>=me)return x.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Oe);const u=x.parse(Ce,f,K);if(!u)return null;K=K||u.type,q.push([me,u])}return new qa(K,M,q)}evaluate(h){const x=this.labels,M=this.outputs;if(x.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=x[0])return M[0].evaluate(h);const K=x.length;return q>=x[K-1]?M[K-1].evaluate(h):M[Ga(x,q)].evaluate(h)}eachChild(h){h(this.input);for(const x of this.outputs)h(x)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function pl(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var Ur=ir;function ir(m,h,x,M){this.cx=3*m,this.bx=3*(x-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(M-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=h,this.p2x=x,this.p2y=M}ir.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,h){if(h===void 0&&(h=1e-6),m<0)return 0;if(m>1)return 1;for(var x=m,M=0;M<8;M++){var q=this.sampleCurveX(x)-m;if(Math.abs(q)<h)return x;var K=this.sampleCurveDerivativeX(x);if(Math.abs(K)<1e-6)break;x-=q/K}var J=0,me=1;for(x=m,M=0;M<20&&(q=this.sampleCurveX(x),!(Math.abs(q-m)<h));M++)m>q?J=x:me=x,x=.5*(me-J)+J;return x},solve:function(m,h){return this.sampleCurveY(this.solveCurveX(m,h))}};var wr=pl(Ur);function Mr(m,h,x){return m+x*(h-m)}function js(m,h,x){return m.map((M,q)=>Mr(M,h[q],x))}const vr={number:Mr,color:function(m,h,x,M="rgb"){switch(M){case"rgb":{const[q,K,J,me]=js(m.rgb,h.rgb,x);return new dn(q,K,J,me,!1)}case"hcl":{const[q,K,J,me]=m.hcl,[Ce,Oe,f,u]=h.hcl;let p,S;if(isNaN(q)||isNaN(Ce))isNaN(q)?isNaN(Ce)?p=NaN:(p=Ce,J!==1&&J!==0||(S=Oe)):(p=q,f!==1&&f!==0||(S=K));else{let he=Ce-q;Ce>q&&he>180?he-=360:Ce<q&&q-Ce>180&&(he+=360),p=q+x*he}const[L,G,Q,re]=function([he,_e,Le,qe]){return he=isNaN(he)?0:he*Tt,Kt([Le,Math.cos(he)*_e,Math.sin(he)*_e,qe])}([p,S??Mr(K,Oe,x),Mr(J,f,x),Mr(me,u,x)]);return new dn(L,G,Q,re,!1)}case"lab":{const[q,K,J,me]=Kt(js(m.lab,h.lab,x));return new dn(q,K,J,me,!1)}}},array:js,padding:function(m,h,x){return new lr(js(m.values,h.values,x))},variableAnchorOffsetCollection:function(m,h,x){const M=m.values,q=h.values;if(M.length!==q.length)throw new Vt(`Cannot interpolate values of different length. from: ${m.toString()}, to: ${h.toString()}`);const K=[];for(let J=0;J<M.length;J+=2){if(M[J]!==q[J])throw new Vt(`Cannot interpolate values containing mismatched anchors. from[${J}]: ${M[J]}, to[${J}]: ${q[J]}`);K.push(M[J]);const[me,Ce]=M[J+1],[Oe,f]=q[J+1];K.push([Mr(me,Oe,x),Mr(Ce,f,x)])}return new Qt(K)}};class Ks{constructor(h,x,M,q,K){this.type=h,this.operator=x,this.interpolation=M,this.input=q,this.labels=[],this.outputs=[];for(const[J,me]of K)this.labels.push(J),this.outputs.push(me)}static interpolationFactor(h,x,M,q){let K=0;if(h.name==="exponential")K=Pr(x,h.base,M,q);else if(h.name==="linear")K=Pr(x,1,M,q);else if(h.name==="cubic-bezier"){const J=h.controlPoints;K=new wr(J[0],J[1],J[2],J[3]).solve(Pr(x,1,M,q))}return K}static parse(h,x){let[M,q,K,...J]=h;if(!Array.isArray(q)||q.length===0)return x.error("Expected an interpolation type expression.",1);if(q[0]==="linear")q={name:"linear"};else if(q[0]==="exponential"){const Oe=q[1];if(typeof Oe!="number")return x.error("Exponential interpolation requires a numeric base.",1,1);q={name:"exponential",base:Oe}}else{if(q[0]!=="cubic-bezier")return x.error(`Unknown interpolation type ${String(q[0])}`,1,0);{const Oe=q.slice(1);if(Oe.length!==4||Oe.some(f=>typeof f!="number"||f<0||f>1))return x.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);q={name:"cubic-bezier",controlPoints:Oe}}}if(h.length-1<4)return x.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return x.error("Expected an even number of arguments.");if(K=x.parse(K,2,Ee),!K)return null;const me=[];let Ce=null;M==="interpolate-hcl"||M==="interpolate-lab"?Ce=He:x.expectedType&&x.expectedType.kind!=="value"&&(Ce=x.expectedType);for(let Oe=0;Oe<J.length;Oe+=2){const f=J[Oe],u=J[Oe+1],p=Oe+3,S=Oe+4;if(typeof f!="number")return x.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(me.length&&me[me.length-1][0]>=f)return x.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);const L=x.parse(u,S,Ce);if(!L)return null;Ce=Ce||L.type,me.push([f,L])}return Fe(Ce,Ee)||Fe(Ce,He)||Fe(Ce,Me)||Fe(Ce,ne)||Fe(Ce,X(Ee))?new Ks(Ce,M,q,K,me):x.error(`Type ${ie(Ce)} is not interpolatable.`)}evaluate(h){const x=this.labels,M=this.outputs;if(x.length===1)return M[0].evaluate(h);const q=this.input.evaluate(h);if(q<=x[0])return M[0].evaluate(h);const K=x.length;if(q>=x[K-1])return M[K-1].evaluate(h);const J=Ga(x,q),me=Ks.interpolationFactor(this.interpolation,q,x[J],x[J+1]),Ce=M[J].evaluate(h),Oe=M[J+1].evaluate(h);switch(this.operator){case"interpolate":return vr[this.type.kind](Ce,Oe,me);case"interpolate-hcl":return vr.color(Ce,Oe,me,"hcl");case"interpolate-lab":return vr.color(Ce,Oe,me,"lab")}}eachChild(h){h(this.input);for(const x of this.outputs)h(x)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function Pr(m,h,x,M){const q=M-x,K=m-x;return q===0?0:h===1?K/q:(Math.pow(h,K)-1)/(Math.pow(h,q)-1)}class bo{constructor(h,x){this.type=h,this.args=x}static parse(h,x){if(h.length<2)return x.error("Expectected at least one argument.");let M=null;const q=x.expectedType;q&&q.kind!=="value"&&(M=q);const K=[];for(const me of h.slice(1)){const Ce=x.parse(me,1+K.length,M,void 0,{typeAnnotation:"omit"});if(!Ce)return null;M=M||Ce.type,K.push(Ce)}if(!M)throw new Error("No output type");const J=q&&K.some(me=>ye(q,me.type));return new bo(J?Ve:M,K)}evaluate(h){let x,M=null,q=0;for(const K of this.args)if(q++,M=K.evaluate(h),M&&M instanceof Yi&&!M.available&&(x||(x=M.name),M=null,q===this.args.length&&(M=x)),M!==null)break;return M}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}class Ho{constructor(h,x){this.type=x.type,this.bindings=[].concat(h),this.result=x}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const x of this.bindings)h(x[1]);h(this.result)}static parse(h,x){if(h.length<4)return x.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const M=[];for(let K=1;K<h.length-1;K+=2){const J=h[K];if(typeof J!="string")return x.error(`Expected string, but found ${typeof J} instead.`,K);if(/[^a-zA-Z0-9_]/.test(J))return x.error("Variable names must contain only alphanumeric characters or '_'.",K);const me=x.parse(h[K+1],K+1);if(!me)return null;M.push([J,me])}const q=x.parse(h[h.length-1],h.length-1,x.expectedType,M);return q?new Ho(M,q):null}outputDefined(){return this.result.outputDefined()}}class Ls{constructor(h,x,M){this.type=h,this.index=x,this.input=M}static parse(h,x){if(h.length!==3)return x.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ee),q=x.parse(h[2],2,X(x.expectedType||Ve));return M&&q?new Ls(q.type.itemType,M,q):null}evaluate(h){const x=this.index.evaluate(h),M=this.input.evaluate(h);if(x<0)throw new Vt(`Array index out of bounds: ${x} < 0.`);if(x>=M.length)throw new Vt(`Array index out of bounds: ${x} > ${M.length-1}.`);if(x!==Math.floor(x))throw new Vt(`Array index must be an integer, but found ${x} instead.`);return M[x]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}}class Il{constructor(h,x){this.type=Qe,this.needle=h,this.haystack=x}static parse(h,x){if(h.length!==3)return x.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ve),q=x.parse(h[2],2,Ve);return M&&q?ge(M.type,[Qe,ze,Ee,Ie,Ve])?new Il(M,q):x.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`):null}evaluate(h){const x=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!M)return!1;if(!Pe(x,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(ur(x))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(ur(M))} instead.`);return M.indexOf(x)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}}class ho{constructor(h,x,M){this.type=Ee,this.needle=h,this.haystack=x,this.fromIndex=M}static parse(h,x){if(h.length<=2||h.length>=5)return x.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ve),q=x.parse(h[2],2,Ve);if(!M||!q)return null;if(!ge(M.type,[Qe,ze,Ee,Ie,Ve]))return x.error(`Expected first argument to be of type boolean, string, number or null, but found ${ie(M.type)} instead`);if(h.length===4){const K=x.parse(h[3],3,Ee);return K?new ho(M,q,K):null}return new ho(M,q)}evaluate(h){const x=this.needle.evaluate(h),M=this.haystack.evaluate(h);if(!Pe(x,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${ie(ur(x))} instead.`);if(!Pe(M,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${ie(ur(M))} instead.`);if(this.fromIndex){const q=this.fromIndex.evaluate(h);return M.indexOf(x,q)}return M.indexOf(x)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}}class jo{constructor(h,x,M,q,K,J){this.inputType=h,this.type=x,this.input=M,this.cases=q,this.outputs=K,this.otherwise=J}static parse(h,x){if(h.length<5)return x.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return x.error("Expected an even number of arguments.");let M,q;x.expectedType&&x.expectedType.kind!=="value"&&(q=x.expectedType);const K={},J=[];for(let Oe=2;Oe<h.length-1;Oe+=2){let f=h[Oe];const u=h[Oe+1];Array.isArray(f)||(f=[f]);const p=x.concat(Oe);if(f.length===0)return p.error("Expected at least one branch label.");for(const L of f){if(typeof L!="number"&&typeof L!="string")return p.error("Branch labels must be numbers or strings.");if(typeof L=="number"&&Math.abs(L)>Number.MAX_SAFE_INTEGER)return p.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof L=="number"&&Math.floor(L)!==L)return p.error("Numeric branch labels must be integer values.");if(M){if(p.checkSubtype(M,ur(L)))return null}else M=ur(L);if(K[String(L)]!==void 0)return p.error("Branch labels must be unique.");K[String(L)]=J.length}const S=x.parse(u,Oe,q);if(!S)return null;q=q||S.type,J.push(S)}const me=x.parse(h[1],1,Ve);if(!me)return null;const Ce=x.parse(h[h.length-1],h.length-1,q);return Ce?me.type.kind!=="value"&&x.concat(1).checkSubtype(M,me.type)?null:new jo(M,q,me,K,J,Ce):null}evaluate(h){const x=this.input.evaluate(h);return(ur(x)===this.inputType&&this.outputs[this.cases[x]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every(h=>h.outputDefined())&&this.otherwise.outputDefined()}}class ca{constructor(h,x,M){this.type=h,this.branches=x,this.otherwise=M}static parse(h,x){if(h.length<4)return x.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return x.error("Expected an odd number of arguments.");let M;x.expectedType&&x.expectedType.kind!=="value"&&(M=x.expectedType);const q=[];for(let J=1;J<h.length-1;J+=2){const me=x.parse(h[J],J,Qe);if(!me)return null;const Ce=x.parse(h[J+1],J+1,M);if(!Ce)return null;q.push([me,Ce]),M=M||Ce.type}const K=x.parse(h[h.length-1],h.length-1,M);if(!K)return null;if(!M)throw new Error("Can't infer output type");return new ca(M,q,K)}evaluate(h){for(const[x,M]of this.branches)if(x.evaluate(h))return M.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[x,M]of this.branches)h(x),h(M);h(this.otherwise)}outputDefined(){return this.branches.every(([h,x])=>x.outputDefined())&&this.otherwise.outputDefined()}}class Ys{constructor(h,x,M,q){this.type=h,this.input=x,this.beginIndex=M,this.endIndex=q}static parse(h,x){if(h.length<=2||h.length>=5)return x.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const M=x.parse(h[1],1,Ve),q=x.parse(h[2],2,Ee);if(!M||!q)return null;if(!ge(M.type,[X(Ve),ze,Ve]))return x.error(`Expected first argument to be of type array or string, but found ${ie(M.type)} instead`);if(h.length===4){const K=x.parse(h[3],3,Ee);return K?new Ys(M.type,M,q,K):null}return new Ys(M.type,M,q)}evaluate(h){const x=this.input.evaluate(h),M=this.beginIndex.evaluate(h);if(!Pe(x,["string","array"]))throw new Vt(`Expected first argument to be of type array or string, but found ${ie(ur(x))} instead.`);if(this.endIndex){const q=this.endIndex.evaluate(h);return x.slice(M,q)}return x.slice(M)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}}function El(m,h){return m==="=="||m==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function Ha(m,h,x,M){return M.compare(h,x)===0}function Ta(m,h,x){const M=m!=="=="&&m!=="!=";return class YS{constructor(K,J,me){this.type=Qe,this.lhs=K,this.rhs=J,this.collator=me,this.hasUntypedArgument=K.type.kind==="value"||J.type.kind==="value"}static parse(K,J){if(K.length!==3&&K.length!==4)return J.error("Expected two or three arguments.");const me=K[0];let Ce=J.parse(K[1],1,Ve);if(!Ce)return null;if(!El(me,Ce.type))return J.concat(1).error(`"${me}" comparisons are not supported for type '${ie(Ce.type)}'.`);let Oe=J.parse(K[2],2,Ve);if(!Oe)return null;if(!El(me,Oe.type))return J.concat(2).error(`"${me}" comparisons are not supported for type '${ie(Oe.type)}'.`);if(Ce.type.kind!==Oe.type.kind&&Ce.type.kind!=="value"&&Oe.type.kind!=="value")return J.error(`Cannot compare types '${ie(Ce.type)}' and '${ie(Oe.type)}'.`);M&&(Ce.type.kind==="value"&&Oe.type.kind!=="value"?Ce=new Lt(Oe.type,[Ce]):Ce.type.kind!=="value"&&Oe.type.kind==="value"&&(Oe=new Lt(Ce.type,[Oe])));let f=null;if(K.length===4){if(Ce.type.kind!=="string"&&Oe.type.kind!=="string"&&Ce.type.kind!=="value"&&Oe.type.kind!=="value")return J.error("Cannot use collator to compare non-string types.");if(f=J.parse(K[3],3,ft),!f)return null}return new YS(Ce,Oe,f)}evaluate(K){const J=this.lhs.evaluate(K),me=this.rhs.evaluate(K);if(M&&this.hasUntypedArgument){const Ce=ur(J),Oe=ur(me);if(Ce.kind!==Oe.kind||Ce.kind!=="string"&&Ce.kind!=="number")throw new Vt(`Expected arguments for "${m}" to be (string, string) or (number, number), but found (${Ce.kind}, ${Oe.kind}) instead.`)}if(this.collator&&!M&&this.hasUntypedArgument){const Ce=ur(J),Oe=ur(me);if(Ce.kind!=="string"||Oe.kind!=="string")return h(K,J,me)}return this.collator?x(K,J,me,this.collator.evaluate(K)):h(K,J,me)}eachChild(K){K(this.lhs),K(this.rhs),this.collator&&K(this.collator)}outputDefined(){return!0}}}const ml=Ta("==",function(m,h,x){return h===x},Ha),Cl=Ta("!=",function(m,h,x){return h!==x},function(m,h,x,M){return!Ha(0,h,x,M)}),pu=Ta("<",function(m,h,x){return h<x},function(m,h,x,M){return M.compare(h,x)<0}),us=Ta(">",function(m,h,x){return h>x},function(m,h,x,M){return M.compare(h,x)>0}),sc=Ta("<=",function(m,h,x){return h<=x},function(m,h,x,M){return M.compare(h,x)<=0}),eo=Ta(">=",function(m,h,x){return h>=x},function(m,h,x,M){return M.compare(h,x)>=0});class to{constructor(h,x,M,q,K){this.type=ze,this.number=h,this.locale=x,this.currency=M,this.minFractionDigits=q,this.maxFractionDigits=K}static parse(h,x){if(h.length!==3)return x.error("Expected two arguments.");const M=x.parse(h[1],1,Ee);if(!M)return null;const q=h[2];if(typeof q!="object"||Array.isArray(q))return x.error("NumberFormat options argument must be an object.");let K=null;if(q.locale&&(K=x.parse(q.locale,1,ze),!K))return null;let J=null;if(q.currency&&(J=x.parse(q.currency,1,ze),!J))return null;let me=null;if(q["min-fraction-digits"]&&(me=x.parse(q["min-fraction-digits"],1,Ee),!me))return null;let Ce=null;return q["max-fraction-digits"]&&(Ce=x.parse(q["max-fraction-digits"],1,Ee),!Ce)?null:new to(M,K,J,me,Ce)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}}class ql{constructor(h){this.type=rt,this.sections=h}static parse(h,x){if(h.length<2)return x.error("Expected at least one argument.");const M=h[1];if(!Array.isArray(M)&&typeof M=="object")return x.error("First argument must be an image or text section.");const q=[];let K=!1;for(let J=1;J<=h.length-1;++J){const me=h[J];if(K&&typeof me=="object"&&!Array.isArray(me)){K=!1;let Ce=null;if(me["font-scale"]&&(Ce=x.parse(me["font-scale"],1,Ee),!Ce))return null;let Oe=null;if(me["text-font"]&&(Oe=x.parse(me["text-font"],1,X(ze)),!Oe))return null;let f=null;if(me["text-color"]&&(f=x.parse(me["text-color"],1,He),!f))return null;const u=q[q.length-1];u.scale=Ce,u.font=Oe,u.textColor=f}else{const Ce=x.parse(h[J],1,Ve);if(!Ce)return null;const Oe=Ce.type.kind;if(Oe!=="string"&&Oe!=="value"&&Oe!=="null"&&Oe!=="resolvedImage")return x.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");K=!0,q.push({content:Ce,scale:null,font:null,textColor:null})}}return new ql(q)}evaluate(h){return new Hi(this.sections.map(x=>{const M=x.content.evaluate(h);return ur(M)===se?new Hr("",M,null,null,null):new Hr(Ns(M),null,x.scale?x.scale.evaluate(h):null,x.font?x.font.evaluate(h).join(","):null,x.textColor?x.textColor.evaluate(h):null)}))}eachChild(h){for(const x of this.sections)h(x.content),x.scale&&h(x.scale),x.font&&h(x.font),x.textColor&&h(x.textColor)}outputDefined(){return!1}}class Ro{constructor(h){this.type=se,this.input=h}static parse(h,x){if(h.length!==2)return x.error("Expected two arguments.");const M=x.parse(h[1],1,ze);return M?new Ro(M):x.error("No image name provided.")}evaluate(h){const x=this.input.evaluate(h),M=Yi.fromString(x);return M&&h.availableImages&&(M.available=h.availableImages.indexOf(x)>-1),M}eachChild(h){h(this.input)}outputDefined(){return!1}}class Zo{constructor(h){this.type=Ee,this.input=h}static parse(h,x){if(h.length!==2)return x.error(`Expected 1 argument, but found ${h.length-1} instead.`);const M=x.parse(h[1],1);return M?M.type.kind!=="array"&&M.type.kind!=="string"&&M.type.kind!=="value"?x.error(`Expected argument of type string or array, but found ${ie(M.type)} instead.`):new Zo(M):null}evaluate(h){const x=this.input.evaluate(h);if(typeof x=="string"||Array.isArray(x))return x.length;throw new Vt(`Expected value to be of type string or array, but found ${ie(ur(x))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}}const wo={"==":ml,"!=":Cl,">":us,"<":pu,">=":eo,"<=":sc,array:Lt,at:Ls,boolean:Lt,case:ca,coalesce:bo,collator:zo,format:ql,image:Ro,in:Il,"index-of":ho,interpolate:Ks,"interpolate-hcl":Ks,"interpolate-lab":Ks,length:Zo,let:Ho,literal:Vr,match:jo,number:Lt,"number-format":to,object:Lt,slice:Ys,step:qa,string:Lt,"to-boolean":Vs,"to-color":Vs,"to-number":Vs,"to-string":Vs,var:un,within:Bi};function Us(m,[h,x,M,q]){h=h.evaluate(m),x=x.evaluate(m),M=M.evaluate(m);const K=q?q.evaluate(m):1,J=Ut(h,x,M,K);if(J)throw new Vt(J);return new dn(h/255,x/255,M/255,K,!1)}function Qo(m,h){return m in h}function Wo(m,h){const x=h[m];return x===void 0?null:x}function Xo(m){return{type:m}}function ba(m){return{result:"success",value:m}}function ja(m){return{result:"error",value:m}}function Ts(m){return m["property-type"]==="data-driven"||m["property-type"]==="cross-faded-data-driven"}function mu(m){return!!m.expression&&m.expression.parameters.indexOf("zoom")>-1}function Sr(m){return!!m.expression&&m.expression.interpolated}function Xn(m){return m instanceof Number?"number":m instanceof String?"string":m instanceof Boolean?"boolean":Array.isArray(m)?"array":m===null?"null":typeof m}function Yo(m){return typeof m=="object"&&m!==null&&!Array.isArray(m)}function Dr(m){return m}function Za(m,h){const x=h.type==="color",M=m.stops&&typeof m.stops[0][0]=="object",q=M||!(M||m.property!==void 0),K=m.type||(Sr(h)?"exponential":"interval");if(x||h.type==="padding"){const f=x?dn.parse:lr.parse;(m=te({},m)).stops&&(m.stops=m.stops.map(u=>[u[0],f(u[1])])),m.default=f(m.default?m.default:h.default)}if(m.colorSpace&&(J=m.colorSpace)!=="rgb"&&J!=="hcl"&&J!=="lab")throw new Error(`Unknown color space: "${m.colorSpace}"`);var J;let me,Ce,Oe;if(K==="exponential")me=Nn;else if(K==="interval")me=So;else if(K==="categorical"){me=Ar,Ce=Object.create(null);for(const f of m.stops)Ce[f[0]]=f[1];Oe=typeof m.stops[0][0]}else{if(K!=="identity")throw new Error(`Unknown function type "${K}"`);me=Ol}if(M){const f={},u=[];for(let L=0;L<m.stops.length;L++){const G=m.stops[L],Q=G[0].zoom;f[Q]===void 0&&(f[Q]={zoom:Q,type:m.type,property:m.property,default:m.default,stops:[]},u.push(Q)),f[Q].stops.push([G[0].value,G[1]])}const p=[];for(const L of u)p.push([f[L].zoom,Za(f[L],h)]);const S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:Ks.interpolationFactor.bind(void 0,S),zoomStops:p.map(L=>L[0]),evaluate:({zoom:L},G)=>Nn({stops:p,base:m.base},h,L).evaluate(L,G)}}if(q){const f=K==="exponential"?{name:"exponential",base:m.base!==void 0?m.base:1}:null;return{kind:"camera",interpolationType:f,interpolationFactor:Ks.interpolationFactor.bind(void 0,f),zoomStops:m.stops.map(u=>u[0]),evaluate:({zoom:u})=>me(m,h,u,Ce,Oe)}}return{kind:"source",evaluate(f,u){const p=u&&u.properties?u.properties[m.property]:void 0;return p===void 0?Kr(m.default,h.default):me(m,h,p,Ce,Oe)}}}function Kr(m,h,x){return m!==void 0?m:h!==void 0?h:x!==void 0?x:void 0}function Ar(m,h,x,M,q){return Kr(typeof x===q?M[x]:void 0,m.default,h.default)}function So(m,h,x){if(Xn(x)!=="number")return Kr(m.default,h.default);const M=m.stops.length;if(M===1||x<=m.stops[0][0])return m.stops[0][1];if(x>=m.stops[M-1][0])return m.stops[M-1][1];const q=Ga(m.stops.map(K=>K[0]),x);return m.stops[q][1]}function Nn(m,h,x){const M=m.base!==void 0?m.base:1;if(Xn(x)!=="number")return Kr(m.default,h.default);const q=m.stops.length;if(q===1||x<=m.stops[0][0])return m.stops[0][1];if(x>=m.stops[q-1][0])return m.stops[q-1][1];const K=Ga(m.stops.map(f=>f[0]),x),J=function(f,u,p,S){const L=S-p,G=f-p;return L===0?0:u===1?G/L:(Math.pow(u,G)-1)/(Math.pow(u,L)-1)}(x,M,m.stops[K][0],m.stops[K+1][0]),me=m.stops[K][1],Ce=m.stops[K+1][1],Oe=vr[h.type]||Dr;return typeof me.evaluate=="function"?{evaluate(...f){const u=me.evaluate.apply(void 0,f),p=Ce.evaluate.apply(void 0,f);if(u!==void 0&&p!==void 0)return Oe(u,p,J,m.colorSpace)}}:Oe(me,Ce,J,m.colorSpace)}function Ol(m,h,x){switch(h.type){case"color":x=dn.parse(x);break;case"formatted":x=Hi.fromString(x.toString());break;case"resolvedImage":x=Yi.fromString(x.toString());break;case"padding":x=lr.parse(x);break;default:Xn(x)===h.type||h.type==="enum"&&h.values[x]||(x=void 0)}return Kr(x,m.default,h.default)}An.register(wo,{error:[{kind:"error"},[ze],(m,[h])=>{throw new Vt(h.evaluate(m))}],typeof:[ze,[Ve],(m,[h])=>ie(ur(h.evaluate(m)))],"to-rgba":[X(Ee,4),[He],(m,[h])=>{const[x,M,q,K]=h.evaluate(m).rgb;return[255*x,255*M,255*q,K]}],rgb:[He,[Ee,Ee,Ee],Us],rgba:[He,[Ee,Ee,Ee,Ee],Us],has:{type:Qe,overloads:[[[ze],(m,[h])=>Qo(h.evaluate(m),m.properties())],[[ze,Ze],(m,[h,x])=>Qo(h.evaluate(m),x.evaluate(m))]]},get:{type:Ve,overloads:[[[ze],(m,[h])=>Wo(h.evaluate(m),m.properties())],[[ze,Ze],(m,[h,x])=>Wo(h.evaluate(m),x.evaluate(m))]]},"feature-state":[Ve,[ze],(m,[h])=>Wo(h.evaluate(m),m.featureState||{})],properties:[Ze,[],m=>m.properties()],"geometry-type":[ze,[],m=>m.geometryType()],id:[Ve,[],m=>m.id()],zoom:[Ee,[],m=>m.globals.zoom],"heatmap-density":[Ee,[],m=>m.globals.heatmapDensity||0],"line-progress":[Ee,[],m=>m.globals.lineProgress||0],accumulated:[Ve,[],m=>m.globals.accumulated===void 0?null:m.globals.accumulated],"+":[Ee,Xo(Ee),(m,h)=>{let x=0;for(const M of h)x+=M.evaluate(m);return x}],"*":[Ee,Xo(Ee),(m,h)=>{let x=1;for(const M of h)x*=M.evaluate(m);return x}],"-":{type:Ee,overloads:[[[Ee,Ee],(m,[h,x])=>h.evaluate(m)-x.evaluate(m)],[[Ee],(m,[h])=>-h.evaluate(m)]]},"/":[Ee,[Ee,Ee],(m,[h,x])=>h.evaluate(m)/x.evaluate(m)],"%":[Ee,[Ee,Ee],(m,[h,x])=>h.evaluate(m)%x.evaluate(m)],ln2:[Ee,[],()=>Math.LN2],pi:[Ee,[],()=>Math.PI],e:[Ee,[],()=>Math.E],"^":[Ee,[Ee,Ee],(m,[h,x])=>Math.pow(h.evaluate(m),x.evaluate(m))],sqrt:[Ee,[Ee],(m,[h])=>Math.sqrt(h.evaluate(m))],log10:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN10],ln:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))],log2:[Ee,[Ee],(m,[h])=>Math.log(h.evaluate(m))/Math.LN2],sin:[Ee,[Ee],(m,[h])=>Math.sin(h.evaluate(m))],cos:[Ee,[Ee],(m,[h])=>Math.cos(h.evaluate(m))],tan:[Ee,[Ee],(m,[h])=>Math.tan(h.evaluate(m))],asin:[Ee,[Ee],(m,[h])=>Math.asin(h.evaluate(m))],acos:[Ee,[Ee],(m,[h])=>Math.acos(h.evaluate(m))],atan:[Ee,[Ee],(m,[h])=>Math.atan(h.evaluate(m))],min:[Ee,Xo(Ee),(m,h)=>Math.min(...h.map(x=>x.evaluate(m)))],max:[Ee,Xo(Ee),(m,h)=>Math.max(...h.map(x=>x.evaluate(m)))],abs:[Ee,[Ee],(m,[h])=>Math.abs(h.evaluate(m))],round:[Ee,[Ee],(m,[h])=>{const x=h.evaluate(m);return x<0?-Math.round(-x):Math.round(x)}],floor:[Ee,[Ee],(m,[h])=>Math.floor(h.evaluate(m))],ceil:[Ee,[Ee],(m,[h])=>Math.ceil(h.evaluate(m))],"filter-==":[Qe,[ze,Ve],(m,[h,x])=>m.properties()[h.value]===x.value],"filter-id-==":[Qe,[Ve],(m,[h])=>m.id()===h.value],"filter-type-==":[Qe,[ze],(m,[h])=>m.geometryType()===h.value],"filter-<":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M<q}],"filter-id-<":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x<M}],"filter->":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M>q}],"filter-id->":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x>M}],"filter-<=":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M<=q}],"filter-id-<=":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x<=M}],"filter->=":[Qe,[ze,Ve],(m,[h,x])=>{const M=m.properties()[h.value],q=x.value;return typeof M==typeof q&&M>=q}],"filter-id->=":[Qe,[Ve],(m,[h])=>{const x=m.id(),M=h.value;return typeof x==typeof M&&x>=M}],"filter-has":[Qe,[Ve],(m,[h])=>h.value in m.properties()],"filter-has-id":[Qe,[],m=>m.id()!==null&&m.id()!==void 0],"filter-type-in":[Qe,[X(ze)],(m,[h])=>h.value.indexOf(m.geometryType())>=0],"filter-id-in":[Qe,[X(Ve)],(m,[h])=>h.value.indexOf(m.id())>=0],"filter-in-small":[Qe,[ze,X(Ve)],(m,[h,x])=>x.value.indexOf(m.properties()[h.value])>=0],"filter-in-large":[Qe,[ze,X(Ve)],(m,[h,x])=>function(M,q,K,J){for(;K<=J;){const me=K+J>>1;if(q[me]===M)return!0;q[me]>M?J=me-1:K=me+1}return!1}(m.properties()[h.value],x.value,0,x.value.length-1)],all:{type:Qe,overloads:[[[Qe,Qe],(m,[h,x])=>h.evaluate(m)&&x.evaluate(m)],[Xo(Qe),(m,h)=>{for(const x of h)if(!x.evaluate(m))return!1;return!0}]]},any:{type:Qe,overloads:[[[Qe,Qe],(m,[h,x])=>h.evaluate(m)||x.evaluate(m)],[Xo(Qe),(m,h)=>{for(const x of h)if(x.evaluate(m))return!0;return!1}]]},"!":[Qe,[Qe],(m,[h])=>!h.evaluate(m)],"is-supported-script":[Qe,[ze],(m,[h])=>{const x=m.globals&&m.globals.isSupportedScript;return!x||x(h.evaluate(m))}],upcase:[ze,[ze],(m,[h])=>h.evaluate(m).toUpperCase()],downcase:[ze,[ze],(m,[h])=>h.evaluate(m).toLowerCase()],concat:[ze,Xo(Ve),(m,h)=>h.map(x=>Ns(x.evaluate(m))).join("")],"resolved-locale":[ze,[ft],(m,[h])=>h.evaluate(m).resolvedLocale()]});class Jr{constructor(h,x){var M;this.expression=h,this._warningHistory={},this._evaluator=new kr,this._defaultValue=x?(M=x).type==="color"&&Yo(M.default)?new dn(0,0,0,0):M.type==="color"?dn.parse(M.default)||null:M.type==="padding"?lr.parse(M.default)||null:M.type==="variableAnchorOffsetCollection"?Qt.parse(M.default)||null:M.default===void 0?null:M.default:null,this._enumValues=x&&x.type==="enum"?x.values:null}evaluateWithoutErrorHandling(h,x,M,q,K,J){return this._evaluator.globals=h,this._evaluator.feature=x,this._evaluator.featureState=M,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J,this.expression.evaluate(this._evaluator)}evaluate(h,x,M,q,K,J){this._evaluator.globals=h,this._evaluator.feature=x||null,this._evaluator.featureState=M||null,this._evaluator.canonical=q,this._evaluator.availableImages=K||null,this._evaluator.formattedSection=J||null;try{const me=this.expression.evaluate(this._evaluator);if(me==null||typeof me=="number"&&me!=me)return this._defaultValue;if(this._enumValues&&!(me in this._enumValues))throw new Vt(`Expected value to be one of ${Object.keys(this._enumValues).map(Ce=>JSON.stringify(Ce)).join(", ")}, but found ${JSON.stringify(me)} instead.`);return me}catch(me){return this._warningHistory[me.message]||(this._warningHistory[me.message]=!0,typeof console<"u"&&console.warn(me.message)),this._defaultValue}}}function jr(m){return Array.isArray(m)&&m.length>0&&typeof m[0]=="string"&&m[0]in wo}function ks(m,h){const x=new Fa(wo,rr,[],h?function(q){const K={color:He,string:ze,number:Ee,enum:ze,boolean:Qe,formatted:rt,padding:Me,resolvedImage:se,variableAnchorOffsetCollection:ne};return q.type==="array"?X(K[q.value]||Ve,q.length):K[q.type]}(h):void 0),M=x.parse(m,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return M?ba(new Jr(M,h)):ja(x.errors)}class Cr{constructor(h,x){this.kind=h,this._styleExpression=x,this.isStateDependent=h!=="constant"&&!zr(x.expression)}evaluateWithoutErrorHandling(h,x,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,x,M,q,K,J)}evaluate(h,x,M,q,K,J){return this._styleExpression.evaluate(h,x,M,q,K,J)}}class nr{constructor(h,x,M,q){this.kind=h,this.zoomStops=M,this._styleExpression=x,this.isStateDependent=h!=="camera"&&!zr(x.expression),this.interpolationType=q}evaluateWithoutErrorHandling(h,x,M,q,K,J){return this._styleExpression.evaluateWithoutErrorHandling(h,x,M,q,K,J)}evaluate(h,x,M,q,K,J){return this._styleExpression.evaluate(h,x,M,q,K,J)}interpolationFactor(h,x,M){return this.interpolationType?Ks.interpolationFactor(this.interpolationType,h,x,M):0}}function al(m,h){const x=ks(m,h);if(x.result==="error")return x;const M=x.value.expression,q=hr(M);if(!q&&!Ts(h))return ja([new Ae("","data expressions not supported")]);const K=Ua(M,["zoom"]);if(!K&&!mu(h))return ja([new Ae("","zoom expressions not supported")]);const J=Io(M);return J||K?J instanceof Ae?ja([J]):J instanceof Ks&&!Sr(h)?ja([new Ae("",'"interpolate" expressions cannot be used with this property')]):ba(J?new nr(q?"camera":"composite",x.value,J.labels,J instanceof Ks?J.interpolation:void 0):new Cr(q?"constant":"source",x.value)):ja([new Ae("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xr{constructor(h,x){this._parameters=h,this._specification=x,te(this,Za(this._parameters,this._specification))}static deserialize(h){return new Xr(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function Io(m){let h=null;if(m instanceof Ho)h=Io(m.result);else if(m instanceof bo){for(const x of m.args)if(h=Io(x),h)break}else(m instanceof qa||m instanceof Ks)&&m.input instanceof An&&m.input.name==="zoom"&&(h=m);return h instanceof Ae||m.eachChild(x=>{const M=Io(x);M instanceof Ae?h=M:!h&&M?h=new Ae("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&M&&h!==M&&(h=new Ae("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),h}function ol(m){if(m===!0||m===!1)return!0;if(!Array.isArray(m)||m.length===0)return!1;switch(m[0]){case"has":return m.length>=2&&m[1]!=="$id"&&m[1]!=="$type";case"in":return m.length>=3&&(typeof m[1]!="string"||Array.isArray(m[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return m.length!==3||Array.isArray(m[1])||Array.isArray(m[2]);case"any":case"all":for(const h of m.slice(1))if(!ol(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}const Zr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hs(m){if(m==null)return{filter:()=>!0,needGeometry:!1};ol(m)||(m=Eo(m));const h=ks(m,Zr);if(h.result==="error")throw new Error(h.value.map(x=>`${x.key}: ${x.message}`).join(", "));return{filter:(x,M,q)=>h.value.evaluate(x,M,{},q),needGeometry:Tl(m)}}function wa(m,h){return m<h?-1:m>h?1:0}function Tl(m){if(!Array.isArray(m))return!1;if(m[0]==="within")return!0;for(let h=1;h<m.length;h++)if(Tl(m[h]))return!0;return!1}function Eo(m){if(!m)return!0;const h=m[0];return m.length<=1?h!=="any":h==="=="?kl(m[1],m[2],"=="):h==="!="?Gs(kl(m[1],m[2],"==")):h==="<"||h===">"||h==="<="||h===">="?kl(m[1],m[2],h):h==="any"?(x=m.slice(1),["any"].concat(x.map(Eo))):h==="all"?["all"].concat(m.slice(1).map(Eo)):h==="none"?["all"].concat(m.slice(1).map(Eo).map(Gs)):h==="in"?Ao(m[1],m.slice(2)):h==="!in"?Gs(Ao(m[1],m.slice(2))):h==="has"?Js(m[1]):h==="!has"?Gs(Js(m[1])):h!=="within"||m;var x}function kl(m,h,x){switch(m){case"$type":return[`filter-type-${x}`,h];case"$id":return[`filter-id-${x}`,h];default:return[`filter-${x}`,m,h]}}function Ao(m,h){if(h.length===0)return!1;switch(m){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some(x=>typeof x!=typeof h[0])?["filter-in-large",m,["literal",h.sort(wa)]]:["filter-in-small",m,["literal",h]]}}function Js(m){switch(m){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",m]}}function Gs(m){return["!",m]}function Qa(m){const h=typeof m;if(h==="number"||h==="boolean"||h==="string"||m==null)return JSON.stringify(m);if(Array.isArray(m)){let q="[";for(const K of m)q+=`${Qa(K)},`;return`${q}]`}const x=Object.keys(m).sort();let M="{";for(let q=0;q<x.length;q++)M+=`${JSON.stringify(x[q])}:${Qa(m[x[q]])},`;return`${M}}`}function $o(m){let h="";for(const x of Mn)h+=`/${Qa(m[x])}`;return h}function Yr(m){const h=m.value;return h?[new $(m.key,h,"constants have been deprecated as of v8")]:[]}function mr(m){return m instanceof Number||m instanceof String||m instanceof Boolean?m.valueOf():m}function Rr(m){if(Array.isArray(m))return m.map(Rr);if(m instanceof Object&&!(m instanceof Number||m instanceof String||m instanceof Boolean)){const h={};for(const x in m)h[x]=Rr(m[x]);return h}return mr(m)}function ha(m){const h=m.key,x=m.value,M=m.valueSpec||{},q=m.objectElementValidators||{},K=m.style,J=m.styleSpec,me=m.validateSpec;let Ce=[];const Oe=Xn(x);if(Oe!=="object")return[new $(h,x,`object expected, ${Oe} found`)];for(const f in x){const u=f.split(".")[0],p=M[u]||M["*"];let S;if(q[u])S=q[u];else if(M[u])S=me;else if(q["*"])S=q["*"];else{if(!M["*"]){Ce.push(new $(h,x[f],`unknown property "${f}"`));continue}S=me}Ce=Ce.concat(S({key:(h&&`${h}.`)+f,value:x[f],valueSpec:p,style:K,styleSpec:J,object:x,objectKey:f,validateSpec:me},x))}for(const f in M)q[f]||M[f].required&&M[f].default===void 0&&x[f]===void 0&&Ce.push(new $(h,x,`missing required property "${f}"`));return Ce}function fo(m){const h=m.value,x=m.valueSpec,M=m.style,q=m.styleSpec,K=m.key,J=m.arrayElementValidator||m.validateSpec;if(Xn(h)!=="array")return[new $(K,h,`array expected, ${Xn(h)} found`)];if(x.length&&h.length!==x.length)return[new $(K,h,`array length ${x.length} expected, length ${h.length} found`)];if(x["min-length"]&&h.length<x["min-length"])return[new $(K,h,`array length at least ${x["min-length"]} expected, length ${h.length} found`)];let me={type:x.value,values:x.values};q.$version<7&&(me.function=x.function),Xn(x.value)==="object"&&(me=x.value);let Ce=[];for(let Oe=0;Oe<h.length;Oe++)Ce=Ce.concat(J({array:h,arrayIndex:Oe,value:h[Oe],valueSpec:me,validateSpec:m.validateSpec,style:M,styleSpec:q,key:`${K}[${Oe}]`}));return Ce}function ea(m){const h=m.key,x=m.value,M=m.valueSpec;let q=Xn(x);return q==="number"&&x!=x&&(q="NaN"),q!=="number"?[new $(h,x,`number expected, ${q} found`)]:"minimum"in M&&x<M.minimum?[new $(h,x,`${x} is less than the minimum value ${M.minimum}`)]:"maximum"in M&&x>M.maximum?[new $(h,x,`${x} is greater than the maximum value ${M.maximum}`)]:[]}function Sa(m){const h=m.valueSpec,x=mr(m.value.type);let M,q,K,J={};const me=x!=="categorical"&&m.value.property===void 0,Ce=!me,Oe=Xn(m.value.stops)==="array"&&Xn(m.value.stops[0])==="array"&&Xn(m.value.stops[0][0])==="object",f=ha({key:m.key,value:m.value,valueSpec:m.styleSpec.function,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(S){if(x==="identity")return[new $(S.key,S.value,'identity function may not have a "stops" property')];let L=[];const G=S.value;return L=L.concat(fo({key:S.key,value:G,valueSpec:S.valueSpec,validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec,arrayElementValidator:u})),Xn(G)==="array"&&G.length===0&&L.push(new $(S.key,G,"array must have at least one stop")),L},default:function(S){return S.validateSpec({key:S.key,value:S.value,valueSpec:h,validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec})}}});return x==="identity"&&me&&f.push(new $(m.key,m.value,'missing required property "property"')),x==="identity"||m.value.stops||f.push(new $(m.key,m.value,'missing required property "stops"')),x==="exponential"&&m.valueSpec.expression&&!Sr(m.valueSpec)&&f.push(new $(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(Ce&&!Ts(m.valueSpec)?f.push(new $(m.key,m.value,"property functions not supported")):me&&!mu(m.valueSpec)&&f.push(new $(m.key,m.value,"zoom functions not supported"))),x!=="categorical"&&!Oe||m.value.property!==void 0||f.push(new $(m.key,m.value,'"property" property is required')),f;function u(S){let L=[];const G=S.value,Q=S.key;if(Xn(G)!=="array")return[new $(Q,G,`array expected, ${Xn(G)} found`)];if(G.length!==2)return[new $(Q,G,`array length 2 expected, length ${G.length} found`)];if(Oe){if(Xn(G[0])!=="object")return[new $(Q,G,`object expected, ${Xn(G[0])} found`)];if(G[0].zoom===void 0)return[new $(Q,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new $(Q,G,"object stop key must have value")];if(K&&K>mr(G[0].zoom))return[new $(Q,G[0].zoom,"stop zoom values must appear in ascending order")];mr(G[0].zoom)!==K&&(K=mr(G[0].zoom),q=void 0,J={}),L=L.concat(ha({key:`${Q}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{zoom:ea,value:p}}))}else L=L.concat(p({key:`${Q}[0]`,value:G[0],valueSpec:{},validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec},G));return jr(Rr(G[1]))?L.concat([new $(`${Q}[1]`,G[1],"expressions are not allowed in function stops.")]):L.concat(S.validateSpec({key:`${Q}[1]`,value:G[1],valueSpec:h,validateSpec:S.validateSpec,style:S.style,styleSpec:S.styleSpec}))}function p(S,L){const G=Xn(S.value),Q=mr(S.value),re=S.value!==null?S.value:L;if(M){if(G!==M)return[new $(S.key,re,`${G} stop domain type must match previous stop domain type ${M}`)]}else M=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new $(S.key,re,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&x!=="categorical"){let he=`number expected, ${G} found`;return Ts(h)&&x===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $(S.key,re,he)]}return x!=="categorical"||G!=="number"||isFinite(Q)&&Math.floor(Q)===Q?x!=="categorical"&&G==="number"&&q!==void 0&&Q<q?[new $(S.key,re,"stop domain values must appear in ascending order")]:(q=Q,x==="categorical"&&Q in J?[new $(S.key,re,"stop domain values must be unique")]:(J[Q]=!0,[])):[new $(S.key,re,`integer expected, found ${Q}`)]}}function ka(m){const h=(m.expressionContext==="property"?al:ks)(Rr(m.value),m.valueSpec);if(h.result==="error")return h.value.map(M=>new $(`${m.key}${M.key}`,m.value,M.message));const x=h.value.expression||h.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!x.outputDefined())return[new $(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!zr(x))return[new $(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter"&&!zr(x))return[new $(m.key,m.value,'"feature-state" data expressions are not supported with filters.')];if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!Ua(x,["zoom","feature-state"]))return[new $(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!hr(x))return[new $(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wa(m){const h=m.key,x=m.value,M=m.valueSpec,q=[];return Array.isArray(M.values)?M.values.indexOf(mr(x))===-1&&q.push(new $(h,x,`expected one of [${M.values.join(", ")}], ${JSON.stringify(x)} found`)):Object.keys(M.values).indexOf(mr(x))===-1&&q.push(new $(h,x,`expected one of [${Object.keys(M.values).join(", ")}], ${JSON.stringify(x)} found`)),q}function ll(m){return ol(Rr(m.value))?ka(te({},m,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ou(m)}function ou(m){const h=m.value,x=m.key;if(Xn(h)!=="array")return[new $(x,h,`array expected, ${Xn(h)} found`)];const M=m.styleSpec;let q,K=[];if(h.length<1)return[new $(x,h,"filter array must have at least 1 element")];switch(K=K.concat(Wa({key:`${x}[0]`,value:h[0],valueSpec:M.filter_operator,style:m.style,styleSpec:m.styleSpec})),mr(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&mr(h[1])==="$type"&&K.push(new $(x,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&K.push(new $(x,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(q=Xn(h[1]),q!=="string"&&K.push(new $(`${x}[1]`,h[1],`string expected, ${q} found`)));for(let J=2;J<h.length;J++)q=Xn(h[J]),mr(h[1])==="$type"?K=K.concat(Wa({key:`${x}[${J}]`,value:h[J],valueSpec:M.geometry_type,style:m.style,styleSpec:m.styleSpec})):q!=="string"&&q!=="number"&&q!=="boolean"&&K.push(new $(`${x}[${J}]`,h[J],`string, number, or boolean expected, ${q} found`));break;case"any":case"all":case"none":for(let J=1;J<h.length;J++)K=K.concat(ou({key:`${x}[${J}]`,value:h[J],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":q=Xn(h[1]),h.length!==2?K.push(new $(x,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="string"&&K.push(new $(`${x}[1]`,h[1],`string expected, ${q} found`));break;case"within":q=Xn(h[1]),h.length!==2?K.push(new $(x,h,`filter array for "${h[0]}" operator must have 2 elements`)):q!=="object"&&K.push(new $(`${x}[1]`,h[1],`object expected, ${q} found`))}return K}function gl(m,h){const x=m.key,M=m.validateSpec,q=m.style,K=m.styleSpec,J=m.value,me=m.objectKey,Ce=K[`${h}_${m.layerType}`];if(!Ce)return[];const Oe=me.match(/^(.*)-transition$/);if(h==="paint"&&Oe&&Ce[Oe[1]]&&Ce[Oe[1]].transition)return M({key:x,value:J,valueSpec:K.transition,style:q,styleSpec:K});const f=m.valueSpec||Ce[me];if(!f)return[new $(x,J,`unknown property "${me}"`)];let u;if(Xn(J)==="string"&&Ts(f)&&!f.tokens&&(u=/^{([^}]+)}$/.exec(J)))return[new $(x,J,`"${me}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const p=[];return m.layerType==="symbol"&&(me==="text-field"&&q&&!q.glyphs&&p.push(new $(x,J,'use of "text-field" requires a style "glyphs" property')),me==="text-font"&&Yo(Rr(J))&&mr(J.type)==="identity"&&p.push(new $(x,J,'"text-font" does not support identity functions'))),p.concat(M({key:m.key,value:J,valueSpec:f,style:q,styleSpec:K,expressionContext:"property",propertyType:h,propertyKey:me}))}function io(m){return gl(m,"paint")}function mi(m){return gl(m,"layout")}function Ni(m){let h=[];const x=m.value,M=m.key,q=m.style,K=m.styleSpec;x.type||x.ref||h.push(new $(M,x,'either "type" or "ref" is required'));let J=mr(x.type);const me=mr(x.ref);if(x.id){const Ce=mr(x.id);for(let Oe=0;Oe<m.arrayIndex;Oe++){const f=q.layers[Oe];mr(f.id)===Ce&&h.push(new $(M,x.id,`duplicate layer id "${x.id}", previously used at line ${f.id.__line__}`))}}if("ref"in x){let Ce;["type","source","source-layer","filter","layout"].forEach(Oe=>{Oe in x&&h.push(new $(M,x[Oe],`"${Oe}" is prohibited for ref layers`))}),q.layers.forEach(Oe=>{mr(Oe.id)===me&&(Ce=Oe)}),Ce?Ce.ref?h.push(new $(M,x.ref,"ref cannot reference another ref layer")):J=mr(Ce.type):h.push(new $(M,x.ref,`ref layer "${me}" not found`))}else if(J!=="background")if(x.source){const Ce=q.sources&&q.sources[x.source],Oe=Ce&&mr(Ce.type);Ce?Oe==="vector"&&J==="raster"?h.push(new $(M,x.source,`layer "${x.id}" requires a raster source`)):Oe!=="raster-dem"&&J==="hillshade"?h.push(new $(M,x.source,`layer "${x.id}" requires a raster-dem source`)):Oe==="raster"&&J!=="raster"?h.push(new $(M,x.source,`layer "${x.id}" requires a vector source`)):Oe!=="vector"||x["source-layer"]?Oe==="raster-dem"&&J!=="hillshade"?h.push(new $(M,x.source,"raster-dem source can only be used with layer type 'hillshade'.")):J!=="line"||!x.paint||!x.paint["line-gradient"]||Oe==="geojson"&&Ce.lineMetrics||h.push(new $(M,x,`layer "${x.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new $(M,x,`layer "${x.id}" must specify a "source-layer"`)):h.push(new $(M,x.source,`source "${x.source}" not found`))}else h.push(new $(M,x,'missing required property "source"'));return h=h.concat(ha({key:M,value:x,valueSpec:K.layer,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,objectElementValidators:{"*":()=>[],type:()=>m.validateSpec({key:`${M}.type`,value:x.type,valueSpec:K.layer.type,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,object:x,objectKey:"type"}),filter:ll,layout:Ce=>ha({layer:x,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Oe=>mi(te({layerType:J},Oe))}}),paint:Ce=>ha({layer:x,key:Ce.key,value:Ce.value,style:Ce.style,styleSpec:Ce.styleSpec,validateSpec:Ce.validateSpec,objectElementValidators:{"*":Oe=>io(te({layerType:J},Oe))}})}})),h}function Di(m){const h=m.value,x=m.key,M=Xn(h);return M!=="string"?[new $(x,h,`string expected, ${M} found`)]:[]}const Ot={promoteId:function({key:m,value:h}){if(Xn(h)==="string")return Di({key:m,value:h});{const x=[];for(const M in h)x.push(...Di({key:`${m}.${M}`,value:h[M]}));return x}}};function ei(m){const h=m.value,x=m.key,M=m.styleSpec,q=m.style,K=m.validateSpec;if(!h.type)return[new $(x,h,'"type" is required')];const J=mr(h.type);let me;switch(J){case"vector":case"raster":return me=ha({key:x,value:h,valueSpec:M[`source_${J.replace("-","_")}`],style:m.style,styleSpec:M,objectElementValidators:Ot,validateSpec:K}),me;case"raster-dem":return me=function(Ce){var Oe;const f=(Oe=Ce.sourceName)!==null&&Oe!==void 0?Oe:"",u=Ce.value,p=Ce.styleSpec,S=p.source_raster_dem,L=Ce.style;let G=[];const Q=Xn(u);if(u===void 0)return G;if(Q!=="object")return G.push(new $("source_raster_dem",u,`object expected, ${Q} found`)),G;const re=mr(u.encoding)==="custom",he=["redFactor","greenFactor","blueFactor","baseShift"],_e=Ce.value.encoding?`"${Ce.value.encoding}"`:"Default";for(const Le in u)!re&&he.includes(Le)?G.push(new $(Le,u[Le],`In "${f}": "${Le}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):S[Le]?G=G.concat(Ce.validateSpec({key:Le,value:u[Le],valueSpec:S[Le],validateSpec:Ce.validateSpec,style:L,styleSpec:p})):G.push(new $(Le,u[Le],`unknown property "${Le}"`));return G}({sourceName:x,value:h,style:m.style,styleSpec:M,validateSpec:K}),me;case"geojson":if(me=ha({key:x,value:h,valueSpec:M.source_geojson,style:q,styleSpec:M,validateSpec:K,objectElementValidators:Ot}),h.cluster)for(const Ce in h.clusterProperties){const[Oe,f]=h.clusterProperties[Ce],u=typeof Oe=="string"?[Oe,["accumulated"],["get",Ce]]:Oe;me.push(...ka({key:`${x}.${Ce}.map`,value:f,validateSpec:K,expressionContext:"cluster-map"})),me.push(...ka({key:`${x}.${Ce}.reduce`,value:u,validateSpec:K,expressionContext:"cluster-reduce"}))}return me;case"video":return ha({key:x,value:h,valueSpec:M.source_video,style:q,validateSpec:K,styleSpec:M});case"image":return ha({key:x,value:h,valueSpec:M.source_image,style:q,validateSpec:K,styleSpec:M});case"canvas":return[new $(x,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wa({key:`${x}.type`,value:h.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:q,validateSpec:K,styleSpec:M})}}function xi(m){const h=m.value,x=m.styleSpec,M=x.light,q=m.style;let K=[];const J=Xn(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new $("light",h,`object expected, ${J} found`)]),K;for(const me in h){const Ce=me.match(/^(.*)-transition$/);K=K.concat(Ce&&M[Ce[1]]&&M[Ce[1]].transition?m.validateSpec({key:me,value:h[me],valueSpec:x.transition,validateSpec:m.validateSpec,style:q,styleSpec:x}):M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:x}):[new $(me,h[me],`unknown property "${me}"`)])}return K}function Oi(m){const h=m.value,x=m.styleSpec,M=x.sky,q=m.style,K=Xn(h);if(h===void 0)return[];if(K!=="object")return[new $("sky",h,`object expected, ${K} found`)];let J=[];for(const me in h)J=J.concat(M[me]?Yn({key:me,value:h[me],valueSpec:M[me],style:q,styleSpec:x}):[new $(me,h[me],`unknown property "${me}"`)]);return J}function Ln(m){const h=m.value,x=m.styleSpec,M=x.terrain,q=m.style;let K=[];const J=Xn(h);if(h===void 0)return K;if(J!=="object")return K=K.concat([new $("terrain",h,`object expected, ${J} found`)]),K;for(const me in h)K=K.concat(M[me]?m.validateSpec({key:me,value:h[me],valueSpec:M[me],validateSpec:m.validateSpec,style:q,styleSpec:x}):[new $(me,h[me],`unknown property "${me}"`)]);return K}function Un(m){let h=[];const x=m.value,M=m.key;if(Array.isArray(x)){const q=[],K=[];for(const J in x)x[J].id&&q.includes(x[J].id)&&h.push(new $(M,x,`all the sprites' ids must be unique, but ${x[J].id} is duplicated`)),q.push(x[J].id),x[J].url&&K.includes(x[J].url)&&h.push(new $(M,x,`all the sprites' URLs must be unique, but ${x[J].url} is duplicated`)),K.push(x[J].url),h=h.concat(ha({key:`${M}[${J}]`,value:x[J],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:m.validateSpec}));return h}return Di({key:M,value:x})}const or={"*":()=>[],array:fo,boolean:function(m){const h=m.value,x=m.key,M=Xn(h);return M!=="boolean"?[new $(x,h,`boolean expected, ${M} found`)]:[]},number:ea,color:function(m){const h=m.key,x=m.value,M=Xn(x);return M!=="string"?[new $(h,x,`color expected, ${M} found`)]:dn.parse(String(x))?[]:[new $(h,x,`color expected, "${x}" found`)]},constants:Yr,enum:Wa,filter:ll,function:Sa,layer:Ni,object:ha,source:ei,light:xi,sky:Oi,terrain:Ln,string:Di,formatted:function(m){return Di(m).length===0?[]:ka(m)},resolvedImage:function(m){return Di(m).length===0?[]:ka(m)},padding:function(m){const h=m.key,x=m.value;if(Xn(x)==="array"){if(x.length<1||x.length>4)return[new $(h,x,`padding requires 1 to 4 values; ${x.length} values found`)];const M={type:"number"};let q=[];for(let K=0;K<x.length;K++)q=q.concat(m.validateSpec({key:`${h}[${K}]`,value:x[K],validateSpec:m.validateSpec,valueSpec:M}));return q}return ea({key:h,value:x,valueSpec:{}})},variableAnchorOffsetCollection:function(m){const h=m.key,x=m.value,M=Xn(x),q=m.styleSpec;if(M!=="array"||x.length<1||x.length%2!=0)return[new $(h,x,"variableAnchorOffsetCollection requires a non-empty array of even length")];let K=[];for(let J=0;J<x.length;J+=2)K=K.concat(Wa({key:`${h}[${J}]`,value:x[J],valueSpec:q.layout_symbol["text-anchor"]})),K=K.concat(fo({key:`${h}[${J+1}]`,value:x[J+1],valueSpec:{length:2,value:"number"},validateSpec:m.validateSpec,style:m.style,styleSpec:q}));return K},sprite:Un};function Yn(m){const h=m.value,x=m.valueSpec,M=m.styleSpec;return m.validateSpec=Yn,x.expression&&Yo(mr(h))?Sa(m):x.expression&&jr(Rr(h))?ka(m):x.type&&or[x.type]?or[x.type](m):ha(te({},m,{valueSpec:x.type?M[x.type]:x}))}function qs(m){const h=m.value,x=m.key,M=Di(m);return M.length||(h.indexOf("{fontstack}")===-1&&M.push(new $(x,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&M.push(new $(x,h,'"glyphs" url must include a "{range}" token'))),M}function Ms(m,h=ti){let x=[];return x=x.concat(Yn({key:"",value:m,valueSpec:h.$root,styleSpec:h,style:m,validateSpec:Yn,objectElementValidators:{glyphs:qs,"*":()=>[]}})),m.constants&&(x=x.concat(Yr({key:"constants",value:m.constants,style:m,styleSpec:h,validateSpec:Yn}))),Xa(x)}function As(m){return function(h){return m({...h,validateSpec:Yn})}}function Xa(m){return[].concat(m).sort((h,x)=>h.line-x.line)}function po(m){return function(...h){return Xa(m.apply(this,h))}}Ms.source=po(As(ei)),Ms.sprite=po(As(Un)),Ms.glyphs=po(As(qs)),Ms.light=po(As(xi)),Ms.sky=po(As(Oi)),Ms.terrain=po(As(Ln)),Ms.layer=po(As(Ni)),Ms.filter=po(As(ll)),Ms.paintProperty=po(As(io)),Ms.layoutProperty=po(As(mi));const rs=Ms,Qu=rs.light,zu=rs.paintProperty,mo=rs.layoutProperty;function Ml(m,h){let x=!1;if(h&&h.length)for(const M of h)m.fire(new gi(new Error(M.message))),x=!0;return x}class Pn{constructor(h,x,M){const q=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;const J=new Int32Array(this.arrayBuffer);h=J[0],this.d=(x=J[1])+2*(M=J[2]);for(let Ce=0;Ce<this.d*this.d;Ce++){const Oe=J[3+Ce],f=J[3+Ce+1];q.push(Oe===f?null:J.subarray(Oe,f))}const me=J[3+q.length+1];this.keys=J.subarray(J[3+q.length],me),this.bboxes=J.subarray(me),this.insert=this._insertReadonly}else{this.d=x+2*M;for(let J=0;J<this.d*this.d;J++)q.push([]);this.keys=[],this.bboxes=[]}this.n=x,this.extent=h,this.padding=M,this.scale=x/h,this.uid=0;const K=M/x*h;this.min=-K,this.max=h+K}insert(h,x,M,q,K){this._forEachCell(x,M,q,K,this._insertCell,this.uid++,void 0,void 0),this.keys.push(h),this.bboxes.push(x),this.bboxes.push(M),this.bboxes.push(q),this.bboxes.push(K)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(h,x,M,q,K,J){this.cells[K].push(J)}query(h,x,M,q,K){const J=this.min,me=this.max;if(h<=J&&x<=J&&me<=M&&me<=q&&!K)return Array.prototype.slice.call(this.keys);{const Ce=[];return this._forEachCell(h,x,M,q,this._queryCell,Ce,{},K),Ce}}_queryCell(h,x,M,q,K,J,me,Ce){const Oe=this.cells[K];if(Oe!==null){const f=this.keys,u=this.bboxes;for(let p=0;p<Oe.length;p++){const S=Oe[p];if(me[S]===void 0){const L=4*S;(Ce?Ce(u[L+0],u[L+1],u[L+2],u[L+3]):h<=u[L+2]&&x<=u[L+3]&&M>=u[L+0]&&q>=u[L+1])?(me[S]=!0,J.push(f[S])):me[S]=!1}}}}_forEachCell(h,x,M,q,K,J,me,Ce){const Oe=this._convertToCellCoord(h),f=this._convertToCellCoord(x),u=this._convertToCellCoord(M),p=this._convertToCellCoord(q);for(let S=Oe;S<=u;S++)for(let L=f;L<=p;L++){const G=this.d*L+S;if((!Ce||Ce(this._convertFromCellCoord(S),this._convertFromCellCoord(L),this._convertFromCellCoord(S+1),this._convertFromCellCoord(L+1)))&&K.call(this,h,x,M,q,G,J,me,Ce))return}}_convertFromCellCoord(h){return(h-this.padding)/this.scale}_convertToCellCoord(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const h=this.cells,x=3+this.cells.length+1+1;let M=0;for(let J=0;J<this.cells.length;J++)M+=this.cells[J].length;const q=new Int32Array(x+M+this.keys.length+this.bboxes.length);q[0]=this.extent,q[1]=this.n,q[2]=this.padding;let K=x;for(let J=0;J<h.length;J++){const me=h[J];q[3+J]=K,q.set(me,K),K+=me.length}return q[3+h.length]=K,q.set(this.keys,K),K+=this.keys.length,q[3+h.length+1]=K,q.set(this.bboxes,K),K+=this.bboxes.length,q.buffer}static serialize(h,x){const M=h.toArrayBuffer();return x&&x.push(M),{buffer:M}}static deserialize(h){return new Pn(h.buffer)}}const Ma={};function bn(m,h,x={}){if(Ma[m])throw new Error(`${m} is already registered.`);Object.defineProperty(h,"_classRegistryKey",{value:m,writeable:!1}),Ma[m]={klass:h,omit:x.omit||[],shallow:x.shallow||[]}}bn("Object",Object),bn("TransferableGridIndex",Pn),bn("Color",dn),bn("Error",Error),bn("AJAXError",Ti),bn("ResolvedImage",Yi),bn("StylePropertyFunction",Xr),bn("StyleExpression",Jr,{omit:["_evaluator"]}),bn("ZoomDependentExpression",nr),bn("ZoomConstantExpression",Cr),bn("CompoundExpression",An,{omit:["_evaluate"]});for(const m in wo)wo[m]._classRegistryKey||bn(`Expression_${m}`,wo[m]);function Fo(m){return m&&typeof ArrayBuffer<"u"&&(m instanceof ArrayBuffer||m.constructor&&m.constructor.name==="ArrayBuffer")}function Nl(m,h){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error)return m;if(Fo(m)||Ft(m))return h&&h.push(m),m;if(ArrayBuffer.isView(m)){const x=m;return h&&h.push(x.buffer),x}if(m instanceof ImageData)return h&&h.push(m.data.buffer),m;if(Array.isArray(m)){const x=[];for(const M of m)x.push(Nl(M,h));return x}if(typeof m=="object"){const x=m.constructor,M=x._classRegistryKey;if(!M)throw new Error(`can't serialize object of unregistered class ${x.name}`);if(!Ma[M])throw new Error(`${M} is not registered.`);const q=x.serialize?x.serialize(m,h):{};if(x.serialize){if(h&&q===h[h.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const K in m){if(!m.hasOwnProperty(K)||Ma[M].omit.indexOf(K)>=0)continue;const J=m[K];q[K]=Ma[M].shallow.indexOf(K)>=0?J:Nl(J,h)}m instanceof Error&&(q.message=m.message)}if(q.$name)throw new Error("$name property is reserved for worker serialization logic.");return M!=="Object"&&(q.$name=M),q}throw new Error("can't serialize object of type "+typeof m)}function Sn(m){if(m==null||typeof m=="boolean"||typeof m=="number"||typeof m=="string"||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error||Fo(m)||Ft(m)||ArrayBuffer.isView(m)||m instanceof ImageData)return m;if(Array.isArray(m))return m.map(Sn);if(typeof m=="object"){const h=m.$name||"Object";if(!Ma[h])throw new Error(`can't deserialize unregistered class ${h}`);const{klass:x}=Ma[h];if(!x)throw new Error(`can't deserialize unregistered class ${h}`);if(x.deserialize)return x.deserialize(m);const M=Object.create(x.prototype);for(const q of Object.keys(m)){if(q==="$name")continue;const K=m[q];M[q]=Ma[h].shallow.indexOf(q)>=0?K:Sn(K)}return M}throw new Error("can't deserialize object of type "+typeof m)}class Hl{constructor(){this.first=!0}update(h,x){const M=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=M,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=M,!0):(this.lastFloorZoom>M?(this.lastIntegerZoom=M+1,this.lastIntegerZoomTime=x):this.lastFloorZoom<M&&(this.lastIntegerZoom=M,this.lastIntegerZoomTime=x),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=M,!0))}}const In={"Latin-1 Supplement":m=>m>=128&&m<=255,Arabic:m=>m>=1536&&m<=1791,"Arabic Supplement":m=>m>=1872&&m<=1919,"Arabic Extended-A":m=>m>=2208&&m<=2303,"Hangul Jamo":m=>m>=4352&&m<=4607,"Unified Canadian Aboriginal Syllabics":m=>m>=5120&&m<=5759,Khmer:m=>m>=6016&&m<=6143,"Unified Canadian Aboriginal Syllabics Extended":m=>m>=6320&&m<=6399,"General Punctuation":m=>m>=8192&&m<=8303,"Letterlike Symbols":m=>m>=8448&&m<=8527,"Number Forms":m=>m>=8528&&m<=8591,"Miscellaneous Technical":m=>m>=8960&&m<=9215,"Control Pictures":m=>m>=9216&&m<=9279,"Optical Character Recognition":m=>m>=9280&&m<=9311,"Enclosed Alphanumerics":m=>m>=9312&&m<=9471,"Geometric Shapes":m=>m>=9632&&m<=9727,"Miscellaneous Symbols":m=>m>=9728&&m<=9983,"Miscellaneous Symbols and Arrows":m=>m>=11008&&m<=11263,"CJK Radicals Supplement":m=>m>=11904&&m<=12031,"Kangxi Radicals":m=>m>=12032&&m<=12255,"Ideographic Description Characters":m=>m>=12272&&m<=12287,"CJK Symbols and Punctuation":m=>m>=12288&&m<=12351,Hiragana:m=>m>=12352&&m<=12447,Katakana:m=>m>=12448&&m<=12543,Bopomofo:m=>m>=12544&&m<=12591,"Hangul Compatibility Jamo":m=>m>=12592&&m<=12687,Kanbun:m=>m>=12688&&m<=12703,"Bopomofo Extended":m=>m>=12704&&m<=12735,"CJK Strokes":m=>m>=12736&&m<=12783,"Katakana Phonetic Extensions":m=>m>=12784&&m<=12799,"Enclosed CJK Letters and Months":m=>m>=12800&&m<=13055,"CJK Compatibility":m=>m>=13056&&m<=13311,"CJK Unified Ideographs Extension A":m=>m>=13312&&m<=19903,"Yijing Hexagram Symbols":m=>m>=19904&&m<=19967,"CJK Unified Ideographs":m=>m>=19968&&m<=40959,"Yi Syllables":m=>m>=40960&&m<=42127,"Yi Radicals":m=>m>=42128&&m<=42191,"Hangul Jamo Extended-A":m=>m>=43360&&m<=43391,"Hangul Syllables":m=>m>=44032&&m<=55215,"Hangul Jamo Extended-B":m=>m>=55216&&m<=55295,"Private Use Area":m=>m>=57344&&m<=63743,"CJK Compatibility Ideographs":m=>m>=63744&&m<=64255,"Arabic Presentation Forms-A":m=>m>=64336&&m<=65023,"Vertical Forms":m=>m>=65040&&m<=65055,"CJK Compatibility Forms":m=>m>=65072&&m<=65103,"Small Form Variants":m=>m>=65104&&m<=65135,"Arabic Presentation Forms-B":m=>m>=65136&&m<=65279,"Halfwidth and Fullwidth Forms":m=>m>=65280&&m<=65519};function _l(m){for(const h of m)if(Vl(h.charCodeAt(0)))return!0;return!1}function lu(m){for(const h of m)if(!Ru(h.charCodeAt(0)))return!1;return!0}function Ru(m){return!(In.Arabic(m)||In["Arabic Supplement"](m)||In["Arabic Extended-A"](m)||In["Arabic Presentation Forms-A"](m)||In["Arabic Presentation Forms-B"](m))}function Vl(m){return!(m!==746&&m!==747&&(m<4352||!(In["Bopomofo Extended"](m)||In.Bopomofo(m)||In["CJK Compatibility Forms"](m)&&!(m>=65097&&m<=65103)||In["CJK Compatibility Ideographs"](m)||In["CJK Compatibility"](m)||In["CJK Radicals Supplement"](m)||In["CJK Strokes"](m)||!(!In["CJK Symbols and Punctuation"](m)||m>=12296&&m<=12305||m>=12308&&m<=12319||m===12336)||In["CJK Unified Ideographs Extension A"](m)||In["CJK Unified Ideographs"](m)||In["Enclosed CJK Letters and Months"](m)||In["Hangul Compatibility Jamo"](m)||In["Hangul Jamo Extended-A"](m)||In["Hangul Jamo Extended-B"](m)||In["Hangul Jamo"](m)||In["Hangul Syllables"](m)||In.Hiragana(m)||In["Ideographic Description Characters"](m)||In.Kanbun(m)||In["Kangxi Radicals"](m)||In["Katakana Phonetic Extensions"](m)||In.Katakana(m)&&m!==12540||!(!In["Halfwidth and Fullwidth Forms"](m)||m===65288||m===65289||m===65293||m>=65306&&m<=65310||m===65339||m===65341||m===65343||m>=65371&&m<=65503||m===65507||m>=65512&&m<=65519)||!(!In["Small Form Variants"](m)||m>=65112&&m<=65118||m>=65123&&m<=65126)||In["Unified Canadian Aboriginal Syllabics"](m)||In["Unified Canadian Aboriginal Syllabics Extended"](m)||In["Vertical Forms"](m)||In["Yijing Hexagram Symbols"](m)||In["Yi Syllables"](m)||In["Yi Radicals"](m))))}function yl(m){return!(Vl(m)||function(h){return!!(In["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||In["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||In["Letterlike Symbols"](h)||In["Number Forms"](h)||In["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||In["Control Pictures"](h)&&h!==9251||In["Optical Character Recognition"](h)||In["Enclosed Alphanumerics"](h)||In["Geometric Shapes"](h)||In["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||In["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||In["CJK Symbols and Punctuation"](h)||In.Katakana(h)||In["Private Use Area"](h)||In["CJK Compatibility Forms"](h)||In["Small Form Variants"](h)||In["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)}(m))}function ta(m){return m>=1424&&m<=2303||In["Arabic Presentation Forms-A"](m)||In["Arabic Presentation Forms-B"](m)}function ac(m,h){return!(!h&&ta(m)||m>=2304&&m<=3583||m>=3840&&m<=4255||In.Khmer(m))}function Wu(m){for(const h of m)if(ta(h.charCodeAt(0)))return!0;return!1}const jl=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(m){this.pluginStatus=m.pluginStatus,this.pluginURL=m.pluginURL}setMethods(m){this.applyArabicShaping=m.applyArabicShaping,this.processBidirectionalText=m.processBidirectionalText,this.processStyledBidirectionalText=m.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class fs{constructor(h,x){this.zoom=h,x?(this.now=x.now,this.fadeDuration=x.fadeDuration,this.zoomHistory=x.zoomHistory,this.transition=x.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Hl,this.transition={})}isSupportedScript(h){return function(x,M){for(const q of x)if(!ac(q.charCodeAt(0),M))return!1;return!0}(h,jl.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const h=this.zoom,x=h-Math.floor(h),M=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:x+(1-x)*M}:{fromScale:.5,toScale:1,t:1-(1-M)*x}}}class _a{constructor(h,x){this.property=h,this.value=x,this.expression=function(M,q){if(Yo(M))return new Xr(M,q);if(jr(M)){const K=al(M,q);if(K.result==="error")throw new Error(K.value.map(J=>`${J.key}: ${J.message}`).join(", "));return K.value}{let K=M;return q.type==="color"&&typeof M=="string"?K=dn.parse(M):q.type!=="padding"||typeof M!="number"&&!Array.isArray(M)?q.type==="variableAnchorOffsetCollection"&&Array.isArray(M)&&(K=Qt.parse(M)):K=lr.parse(M),{kind:"constant",evaluate:()=>K}}}(x===void 0?h.specification.default:x,h.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(h,x,M){return this.property.possiblyEvaluate(this,h,x,M)}}class Ko{constructor(h){this.property=h,this.value=new _a(h,void 0)}transitioned(h,x){return new Fu(this.property,this.value,x,ni({},h.transition,this.transition),h.now)}untransitioned(){return new Fu(this.property,this.value,null,{},0)}}class gu{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)}getValue(h){return mt(this._values[h].value.value)}setValue(h,x){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new Ko(this._values[h].property)),this._values[h].value=new _a(this._values[h].property,x===null?void 0:mt(x))}getTransition(h){return mt(this._values[h].transition)}setTransition(h,x){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new Ko(this._values[h].property)),this._values[h].transition=mt(x)||void 0}serialize(){const h={};for(const x of Object.keys(this._values)){const M=this.getValue(x);M!==void 0&&(h[x]=M);const q=this.getTransition(x);q!==void 0&&(h[`${x}-transition`]=q)}return h}transitioned(h,x){const M=new uu(this._properties);for(const q of Object.keys(this._values))M._values[q]=this._values[q].transitioned(h,x._values[q]);return M}untransitioned(){const h=new uu(this._properties);for(const x of Object.keys(this._values))h._values[x]=this._values[x].untransitioned();return h}}class Fu{constructor(h,x,M,q,K){this.property=h,this.value=x,this.begin=K+q.delay||0,this.end=this.begin+q.duration||0,h.specification.transition&&(q.delay||q.duration)&&(this.prior=M)}possiblyEvaluate(h,x,M){const q=h.now||0,K=this.value.possiblyEvaluate(h,x,M),J=this.prior;if(J){if(q>this.end)return this.prior=null,K;if(this.value.isDataDriven())return this.prior=null,K;if(q<this.begin)return J.possiblyEvaluate(h,x,M);{const me=(q-this.begin)/(this.end-this.begin);return this.property.interpolate(J.possiblyEvaluate(h,x,M),K,function(Ce){if(Ce<=0)return 0;if(Ce>=1)return 1;const Oe=Ce*Ce,f=Oe*Ce;return 4*(Ce<.5?f:3*(Ce-Oe)+f-.75)}(me))}}return K}}class uu{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,x,M){const q=new ds(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,x,M);return q}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class Ou{constructor(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)}hasValue(h){return this._values[h].value!==void 0}getValue(h){return mt(this._values[h].value)}setValue(h,x){this._values[h]=new _a(this._values[h].property,x===null?void 0:mt(x))}serialize(){const h={};for(const x of Object.keys(this._values)){const M=this.getValue(x);M!==void 0&&(h[x]=M)}return h}possiblyEvaluate(h,x,M){const q=new ds(this._properties);for(const K of Object.keys(this._values))q._values[K]=this._values[K].possiblyEvaluate(h,x,M);return q}}class _r{constructor(h,x,M){this.property=h,this.value=x,this.parameters=M}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,x,M,q){return this.property.evaluate(this.value,this.parameters,h,x,M,q)}}class ds{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class pn{constructor(h){this.specification=h}possiblyEvaluate(h,x){if(h.isDataDriven())throw new Error("Value should not be data driven");return h.expression.evaluate(x)}interpolate(h,x,M){const q=vr[this.specification.type];return q?q(h,x,M):h}}class Gn{constructor(h,x){this.specification=h,this.overrides=x}possiblyEvaluate(h,x,M,q){return new _r(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(x,null,{},M,q)}:h.expression,x)}interpolate(h,x,M){if(h.value.kind!=="constant"||x.value.kind!=="constant")return h;if(h.value.value===void 0||x.value.value===void 0)return new _r(this,{kind:"constant",value:void 0},h.parameters);const q=vr[this.specification.type];if(q){const K=q(h.value.value,x.value.value,M);return new _r(this,{kind:"constant",value:K},h.parameters)}return h}evaluate(h,x,M,q,K,J){return h.kind==="constant"?h.value:h.evaluate(x,M,q,K,J)}}class Jn extends Gn{possiblyEvaluate(h,x,M,q){if(h.value===void 0)return new _r(this,{kind:"constant",value:void 0},x);if(h.expression.kind==="constant"){const K=h.expression.evaluate(x,null,{},M,q),J=h.property.specification.type==="resolvedImage"&&typeof K!="string"?K.name:K,me=this._calculate(J,J,J,x);return new _r(this,{kind:"constant",value:me},x)}if(h.expression.kind==="camera"){const K=this._calculate(h.expression.evaluate({zoom:x.zoom-1}),h.expression.evaluate({zoom:x.zoom}),h.expression.evaluate({zoom:x.zoom+1}),x);return new _r(this,{kind:"constant",value:K},x)}return new _r(this,h.expression,x)}evaluate(h,x,M,q,K,J){if(h.kind==="source"){const me=h.evaluate(x,M,q,K,J);return this._calculate(me,me,me,x)}return h.kind==="composite"?this._calculate(h.evaluate({zoom:Math.floor(x.zoom)-1},M,q),h.evaluate({zoom:Math.floor(x.zoom)},M,q),h.evaluate({zoom:Math.floor(x.zoom)+1},M,q),x):h.value}_calculate(h,x,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:x}:{from:M,to:x}}interpolate(h){return h}}class Jo{constructor(h){this.specification=h}possiblyEvaluate(h,x,M,q){if(h.value!==void 0){if(h.expression.kind==="constant"){const K=h.expression.evaluate(x,null,{},M,q);return this._calculate(K,K,K,x)}return this._calculate(h.expression.evaluate(new fs(Math.floor(x.zoom-1),x)),h.expression.evaluate(new fs(Math.floor(x.zoom),x)),h.expression.evaluate(new fs(Math.floor(x.zoom+1),x)),x)}}_calculate(h,x,M,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:h,to:x}:{from:M,to:x}}interpolate(h){return h}}class Cu{constructor(h){this.specification=h}possiblyEvaluate(h,x,M,q){return!!h.expression.evaluate(x,null,{},M,q)}interpolate(){return!1}}class oa{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const x in h){const M=h[x];M.specification.overridable&&this.overridableProperties.push(x);const q=this.defaultPropertyValues[x]=new _a(M,void 0),K=this.defaultTransitionablePropertyValues[x]=new Ko(M);this.defaultTransitioningPropertyValues[x]=K.untransitioned(),this.defaultPossiblyEvaluatedValues[x]=q.possiblyEvaluate({})}}}bn("DataDrivenProperty",Gn),bn("DataConstantProperty",pn),bn("CrossFadedDataDrivenProperty",Jn),bn("CrossFadedProperty",Jo),bn("ColorRampProperty",Cu);const _u="-transition";class _s extends mn{constructor(h,x){if(super(),this.id=h.id,this.type=h.type,this._featureFilter={filter:()=>!0,needGeometry:!1},h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter),x.layout&&(this._unevaluatedLayout=new Ou(x.layout)),x.paint)){this._transitionablePaint=new gu(x.paint);for(const M in h.paint)this.setPaintProperty(M,h.paint[M],{validate:!1});for(const M in h.layout)this.setLayoutProperty(M,h.layout[M],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ds(x.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}setLayoutProperty(h,x,M={}){x!=null&&this._validate(mo,`layers.${this.id}.layout.${h}`,h,x,M)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,x):this.visibility=x)}getPaintProperty(h){return h.endsWith(_u)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,x,M={}){if(x!=null&&this._validate(zu,`layers.${this.id}.paint.${h}`,h,x,M))return!1;if(h.endsWith(_u))return this._transitionablePaint.setTransition(h.slice(0,-11),x||void 0),!1;{const q=this._transitionablePaint._values[h],K=q.property.specification["property-type"]==="cross-faded-data-driven",J=q.value.isDataDriven(),me=q.value;this._transitionablePaint.setValue(h,x),this._handleSpecialPaintPropertyUpdate(h);const Ce=this._transitionablePaint._values[h].value;return Ce.isDataDriven()||J||K||this._handleOverridablePaintPropertyUpdate(h,me,Ce)}}_handleSpecialPaintPropertyUpdate(h){}_handleOverridablePaintPropertyUpdate(h,x,M){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,x){h.getCrossfadeParameters&&(this._crossfadeParameters=h.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,x)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,x)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),_t(h,(x,M)=>!(x===void 0||M==="layout"&&!Object.keys(x).length||M==="paint"&&!Object.keys(x).length))}_validate(h,x,M,q,K={}){return(!K||K.validate!==!1)&&Ml(this,h.call(rs,{key:x,layerType:this.type,objectKey:M,value:q,styleSpec:ti,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const x=this.paint.get(h);if(x instanceof _r&&Ts(x.property.specification)&&(x.value.kind==="source"||x.value.kind==="composite")&&x.value.isStateDependent)return!0}return!1}}const Co={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Mi{constructor(h,x){this._structArray=h,this._pos1=x*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class zi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,x){return h._trim(),x&&(h.isTransferred=!0,x.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const x=Object.create(this.prototype);return x.arrayBuffer=h.arrayBuffer,x.length=h.length,x.capacity=h.arrayBuffer.byteLength/x.bytesPerElement,x._refreshViews(),x}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const x=this.uint8;this._refreshViews(),x&&this.uint8.set(x)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ys(m,h=1){let x=0,M=0;return{members:m.map(q=>{const K=Co[q.type].BYTES_PER_ELEMENT,J=x=yu(x,Math.max(h,K)),me=q.components||1;return M=Math.max(M,K),x+=K*me,{name:q.name,type:q.type,components:me,offset:J}}),size:yu(x,Math.max(M,h)),alignment:h}}function yu(m,h){return Math.ceil(m/h)*h}class Oo extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x){const M=this.length;return this.resize(M+1),this.emplace(M,h,x)}emplace(h,x,M){const q=2*h;return this.int16[q+0]=x,this.int16[q+1]=M,h}}Oo.prototype.bytesPerElement=4,bn("StructArrayLayout2i4",Oo);class cs extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.int16[K+0]=x,this.int16[K+1]=M,this.int16[K+2]=q,h}}cs.prototype.bytesPerElement=6,bn("StructArrayLayout3i6",cs);class ul extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,x,M,q)}emplace(h,x,M,q,K){const J=4*h;return this.int16[J+0]=x,this.int16[J+1]=M,this.int16[J+2]=q,this.int16[J+3]=K,h}}ul.prototype.bytesPerElement=8,bn("StructArrayLayout4i8",ul);class Ps extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,x,M,q,K,J)}emplace(h,x,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=x,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}Ps.prototype.bytesPerElement=12,bn("StructArrayLayout2i4i12",Ps);class C extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,x,M,q,K,J)}emplace(h,x,M,q,K,J,me){const Ce=4*h,Oe=8*h;return this.int16[Ce+0]=x,this.int16[Ce+1]=M,this.uint8[Oe+4]=q,this.uint8[Oe+5]=K,this.uint8[Oe+6]=J,this.uint8[Oe+7]=me,h}}C.prototype.bytesPerElement=8,bn("StructArrayLayout2i4ub8",C);class D extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x){const M=this.length;return this.resize(M+1),this.emplace(M,h,x)}emplace(h,x,M){const q=2*h;return this.float32[q+0]=x,this.float32[q+1]=M,h}}D.prototype.bytesPerElement=8,bn("StructArrayLayout2f8",D);class z extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f){const u=this.length;return this.resize(u+1),this.emplace(u,h,x,M,q,K,J,me,Ce,Oe,f)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u){const p=10*h;return this.uint16[p+0]=x,this.uint16[p+1]=M,this.uint16[p+2]=q,this.uint16[p+3]=K,this.uint16[p+4]=J,this.uint16[p+5]=me,this.uint16[p+6]=Ce,this.uint16[p+7]=Oe,this.uint16[p+8]=f,this.uint16[p+9]=u,h}}z.prototype.bytesPerElement=20,bn("StructArrayLayout10ui20",z);class R extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f,u,p){const S=this.length;return this.resize(S+1),this.emplace(S,h,x,M,q,K,J,me,Ce,Oe,f,u,p)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S){const L=12*h;return this.int16[L+0]=x,this.int16[L+1]=M,this.int16[L+2]=q,this.int16[L+3]=K,this.uint16[L+4]=J,this.uint16[L+5]=me,this.uint16[L+6]=Ce,this.uint16[L+7]=Oe,this.int16[L+8]=f,this.int16[L+9]=u,this.int16[L+10]=p,this.int16[L+11]=S,h}}R.prototype.bytesPerElement=24,bn("StructArrayLayout4i4ui4i24",R);class ee extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.float32[K+0]=x,this.float32[K+1]=M,this.float32[K+2]=q,h}}ee.prototype.bytesPerElement=12,bn("StructArrayLayout3f12",ee);class le extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const x=this.length;return this.resize(x+1),this.emplace(x,h)}emplace(h,x){return this.uint32[1*h+0]=x,h}}le.prototype.bytesPerElement=4,bn("StructArrayLayout1ul4",le);class ae extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe){const f=this.length;return this.resize(f+1),this.emplace(f,h,x,M,q,K,J,me,Ce,Oe)}emplace(h,x,M,q,K,J,me,Ce,Oe,f){const u=10*h,p=5*h;return this.int16[u+0]=x,this.int16[u+1]=M,this.int16[u+2]=q,this.int16[u+3]=K,this.int16[u+4]=J,this.int16[u+5]=me,this.uint32[p+3]=Ce,this.uint16[u+8]=Oe,this.uint16[u+9]=f,h}}ae.prototype.bytesPerElement=20,bn("StructArrayLayout6i1ul2ui20",ae);class be extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J){const me=this.length;return this.resize(me+1),this.emplace(me,h,x,M,q,K,J)}emplace(h,x,M,q,K,J,me){const Ce=6*h;return this.int16[Ce+0]=x,this.int16[Ce+1]=M,this.int16[Ce+2]=q,this.int16[Ce+3]=K,this.int16[Ce+4]=J,this.int16[Ce+5]=me,h}}be.prototype.bytesPerElement=12,bn("StructArrayLayout2i2i2i12",be);class We extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K){const J=this.length;return this.resize(J+1),this.emplace(J,h,x,M,q,K)}emplace(h,x,M,q,K,J){const me=4*h,Ce=8*h;return this.float32[me+0]=x,this.float32[me+1]=M,this.float32[me+2]=q,this.int16[Ce+6]=K,this.int16[Ce+7]=J,h}}We.prototype.bytesPerElement=16,bn("StructArrayLayout2f1f2i16",We);class yt extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,x,M,q)}emplace(h,x,M,q,K){const J=12*h,me=3*h;return this.uint8[J+0]=x,this.uint8[J+1]=M,this.float32[me+1]=q,this.float32[me+2]=K,h}}yt.prototype.bytesPerElement=12,bn("StructArrayLayout2ub2f12",yt);class Ct extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.uint16[K+0]=x,this.uint16[K+1]=M,this.uint16[K+2]=q,h}}Ct.prototype.bytesPerElement=6,bn("StructArrayLayout3ui6",Ct);class ii extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,G,Q,re){const he=this.length;return this.resize(he+1),this.emplace(he,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,G,Q,re)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,G,Q,re,he){const _e=24*h,Le=12*h,qe=48*h;return this.int16[_e+0]=x,this.int16[_e+1]=M,this.uint16[_e+2]=q,this.uint16[_e+3]=K,this.uint32[Le+2]=J,this.uint32[Le+3]=me,this.uint32[Le+4]=Ce,this.uint16[_e+10]=Oe,this.uint16[_e+11]=f,this.uint16[_e+12]=u,this.float32[Le+7]=p,this.float32[Le+8]=S,this.uint8[qe+36]=L,this.uint8[qe+37]=G,this.uint8[qe+38]=Q,this.uint32[Le+10]=re,this.int16[_e+22]=he,h}}ii.prototype.bytesPerElement=48,bn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ii);class Gt extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t){const Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t)}emplace(h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t,Ht){const Zt=32*h,ui=16*h;return this.int16[Zt+0]=x,this.int16[Zt+1]=M,this.int16[Zt+2]=q,this.int16[Zt+3]=K,this.int16[Zt+4]=J,this.int16[Zt+5]=me,this.int16[Zt+6]=Ce,this.int16[Zt+7]=Oe,this.uint16[Zt+8]=f,this.uint16[Zt+9]=u,this.uint16[Zt+10]=p,this.uint16[Zt+11]=S,this.uint16[Zt+12]=L,this.uint16[Zt+13]=G,this.uint16[Zt+14]=Q,this.uint16[Zt+15]=re,this.uint16[Zt+16]=he,this.uint16[Zt+17]=_e,this.uint16[Zt+18]=Le,this.uint16[Zt+19]=qe,this.uint16[Zt+20]=Je,this.uint16[Zt+21]=At,this.uint16[Zt+22]=gt,this.uint32[ui+12]=Mt,this.float32[ui+13]=Pt,this.float32[ui+14]=zt,this.uint16[Zt+30]=$t,this.uint16[Zt+31]=Ht,h}}Gt.prototype.bytesPerElement=64,bn("StructArrayLayout8i15ui1ul2f2ui64",Gt);class jt extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const x=this.length;return this.resize(x+1),this.emplace(x,h)}emplace(h,x){return this.float32[1*h+0]=x,h}}jt.prototype.bytesPerElement=4,bn("StructArrayLayout1f4",jt);class Z extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=3*h;return this.uint16[6*h+0]=x,this.float32[K+1]=M,this.float32[K+2]=q,h}}Z.prototype.bytesPerElement=12,bn("StructArrayLayout1ui2f12",Z);class A extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x,M){const q=this.length;return this.resize(q+1),this.emplace(q,h,x,M)}emplace(h,x,M,q){const K=4*h;return this.uint32[2*h+0]=x,this.uint16[K+2]=M,this.uint16[K+3]=q,h}}A.prototype.bytesPerElement=8,bn("StructArrayLayout1ul2ui8",A);class I extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,x){const M=this.length;return this.resize(M+1),this.emplace(M,h,x)}emplace(h,x,M){const q=2*h;return this.uint16[q+0]=x,this.uint16[q+1]=M,h}}I.prototype.bytesPerElement=4,bn("StructArrayLayout2ui4",I);class F extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const x=this.length;return this.resize(x+1),this.emplace(x,h)}emplace(h,x){return this.uint16[1*h+0]=x,h}}F.prototype.bytesPerElement=2,bn("StructArrayLayout1ui2",F);class O extends zi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,x,M,q){const K=this.length;return this.resize(K+1),this.emplace(K,h,x,M,q)}emplace(h,x,M,q,K){const J=4*h;return this.float32[J+0]=x,this.float32[J+1]=M,this.float32[J+2]=q,this.float32[J+3]=K,h}}O.prototype.bytesPerElement=16,bn("StructArrayLayout4f16",O);class y extends Mi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new oe(this.anchorPointX,this.anchorPointY)}}y.prototype.size=20;class s extends ae{get(h){return new y(this,h)}}bn("CollisionBoxArray",s);class i extends Mi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(h){this._structArray.uint8[this._pos1+37]=h}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(h){this._structArray.uint8[this._pos1+38]=h}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(h){this._structArray.uint32[this._pos4+10]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}i.prototype.size=48;class r extends ii{get(h){return new i(this,h)}}bn("PlacedSymbolArray",r);class l extends Mi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(h){this._structArray.uint32[this._pos4+12]=h}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}l.prototype.size=64;class d extends Gt{get(h){return new l(this,h)}}bn("SymbolInstanceArray",d);class _ extends jt{getoffsetX(h){return this.float32[1*h+0]}}bn("GlyphOffsetArray",_);class w extends cs{getx(h){return this.int16[3*h+0]}gety(h){return this.int16[3*h+1]}gettileUnitDistanceFromAnchor(h){return this.int16[3*h+2]}}bn("SymbolLineVertexArray",w);class T extends Mi{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}T.prototype.size=12;class B extends Z{get(h){return new T(this,h)}}bn("TextAnchorOffsetArray",B);class j extends Mi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}j.prototype.size=8;class Y extends A{get(h){return new j(this,h)}}bn("FeatureIndexArray",Y);class ue extends Oo{}class Se extends Oo{}class Te extends Oo{}class Re extends Ps{}class Be extends C{}class $e extends D{}class vt extends z{}class ot extends R{}class ct extends ee{}class Et extends le{}class wt extends be{}class ri extends yt{}class Xt extends Ct{}class Jt extends I{}const si=ys([{name:"a_pos",components:2,type:"Int16"}],4),{members:ji}=si;class Zi{constructor(h=[]){this.segments=h}prepareSegment(h,x,M,q){let K=this.segments[this.segments.length-1];return h>Zi.MAX_VERTEX_ARRAY_LENGTH&&dt(`Max vertices per segment is ${Zi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}`),(!K||K.vertexLength+h>Zi.MAX_VERTEX_ARRAY_LENGTH||K.sortKey!==q)&&(K={vertexOffset:x.length,primitiveOffset:M.length,vertexLength:0,primitiveLength:0},q!==void 0&&(K.sortKey=q),this.segments.push(K)),K}get(){return this.segments}destroy(){for(const h of this.segments)for(const x in h.vaos)h.vaos[x].destroy()}static simpleSegment(h,x,M,q){return new Zi([{vertexOffset:h,primitiveOffset:x,vertexLength:M,primitiveLength:q,vaos:{},sortKey:0}])}}function Ii(m,h){return 256*(m=Rt(Math.floor(m),0,255))+Rt(Math.floor(h),0,255)}Zi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bn("SegmentVector",Zi);const Vi=ys([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ui={exports:{}},an={exports:{}};an.exports=function(m,h){var x,M,q,K,J,me,Ce,Oe;for(M=m.length-(x=3&m.length),q=h,J=3432918353,me=461845907,Oe=0;Oe<M;)Ce=255&m.charCodeAt(Oe)|(255&m.charCodeAt(++Oe))<<8|(255&m.charCodeAt(++Oe))<<16|(255&m.charCodeAt(++Oe))<<24,++Oe,q=27492+(65535&(K=5*(65535&(q=(q^=Ce=(65535&(Ce=(Ce=(65535&Ce)*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295)<<13|q>>>19))+((5*(q>>>16)&65535)<<16)&4294967295))+((58964+(K>>>16)&65535)<<16);switch(Ce=0,x){case 3:Ce^=(255&m.charCodeAt(Oe+2))<<16;case 2:Ce^=(255&m.charCodeAt(Oe+1))<<8;case 1:q^=Ce=(65535&(Ce=(Ce=(65535&(Ce^=255&m.charCodeAt(Oe)))*J+(((Ce>>>16)*J&65535)<<16)&4294967295)<<15|Ce>>>17))*me+(((Ce>>>16)*me&65535)<<16)&4294967295}return q^=m.length,q=2246822507*(65535&(q^=q>>>16))+((2246822507*(q>>>16)&65535)<<16)&4294967295,q=3266489909*(65535&(q^=q>>>13))+((3266489909*(q>>>16)&65535)<<16)&4294967295,(q^=q>>>16)>>>0};var Bn=an.exports,Ji={exports:{}};Ji.exports=function(m,h){for(var x,M=m.length,q=h^M,K=0;M>=4;)x=1540483477*(65535&(x=255&m.charCodeAt(K)|(255&m.charCodeAt(++K))<<8|(255&m.charCodeAt(++K))<<16|(255&m.charCodeAt(++K))<<24))+((1540483477*(x>>>16)&65535)<<16),q=1540483477*(65535&q)+((1540483477*(q>>>16)&65535)<<16)^(x=1540483477*(65535&(x^=x>>>24))+((1540483477*(x>>>16)&65535)<<16)),M-=4,++K;switch(M){case 3:q^=(255&m.charCodeAt(K+2))<<16;case 2:q^=(255&m.charCodeAt(K+1))<<8;case 1:q=1540483477*(65535&(q^=255&m.charCodeAt(K)))+((1540483477*(q>>>16)&65535)<<16)}return q=1540483477*(65535&(q^=q>>>13))+((1540483477*(q>>>16)&65535)<<16),(q^=q>>>15)>>>0};var Cn=Bn,yr=Ji.exports;Ui.exports=Cn,Ui.exports.murmur3=Cn,Ui.exports.murmur2=yr;var er=U(Ui.exports);class Ia{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,x,M,q){this.ids.push(Aa(h)),this.positions.push(x,M,q)}getPositions(h){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const x=Aa(h);let M=0,q=this.ids.length-1;for(;M<q;){const J=M+q>>1;this.ids[J]>=x?q=J:M=J+1}const K=[];for(;this.ids[M]===x;)K.push({index:this.positions[3*M],start:this.positions[3*M+1],end:this.positions[3*M+2]}),M++;return K}static serialize(h,x){const M=new Float64Array(h.ids),q=new Uint32Array(h.positions);return Bs(M,q,0,M.length-1),x&&x.push(M.buffer,q.buffer),{ids:M,positions:q}}static deserialize(h){const x=new Ia;return x.ids=h.ids,x.positions=h.positions,x.indexed=!0,x}}function Aa(m){const h=+m;return!isNaN(h)&&h<=Number.MAX_SAFE_INTEGER?h:er(String(m))}function Bs(m,h,x,M){for(;x<M;){const q=m[x+M>>1];let K=x-1,J=M+1;for(;;){do K++;while(m[K]<q);do J--;while(m[J]>q);if(K>=J)break;no(m,K,J),no(h,3*K,3*J),no(h,3*K+1,3*J+1),no(h,3*K+2,3*J+2)}J-x<M-J?(Bs(m,h,x,J),x=J+1):(Bs(m,h,J+1,M),M=J)}}function no(m,h,x){const M=m[h];m[h]=m[x],m[x]=M}bn("FeaturePositionMap",Ia);class ro{constructor(h,x){this.gl=h.gl,this.location=x}}class Gr extends ro{constructor(h,x){super(h,x),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class ya extends ro{constructor(h,x){super(h,x),this.current=[0,0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3]))}}class go extends ro{constructor(h,x){super(h,x),this.current=dn.transparent}set(h){h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a))}}const _o=new Float32Array(16);function Zs(m){return[Ii(255*m.r,255*m.g),Ii(255*m.b,255*m.a)]}class es{constructor(h,x,M){this.value=h,this.uniformNames=x.map(q=>`u_${q}`),this.type=M}setUniform(h,x,M){h.set(M.constantOr(this.value))}getBinding(h,x,M){return this.type==="color"?new go(h,x):new Gr(h,x)}}class ts{constructor(h,x){this.uniformNames=x.map(M=>`u_${M}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(h,x){this.pixelRatioFrom=x.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=x.tlbr,this.patternTo=h.tlbr}setUniform(h,x,M,q){const K=q==="u_pattern_to"?this.patternTo:q==="u_pattern_from"?this.patternFrom:q==="u_pixel_ratio_to"?this.pixelRatioTo:q==="u_pixel_ratio_from"?this.pixelRatioFrom:null;K&&h.set(K)}getBinding(h,x,M){return M.substr(0,9)==="u_pattern"?new ya(h,x):new Gr(h,x)}}class Lr{constructor(h,x,M,q){this.expression=h,this.type=M,this.maxValue=0,this.paintVertexAttributes=x.map(K=>({name:`a_${K}`,type:"Float32",components:M==="color"?2:1,offset:0})),this.paintVertexArray=new q}populatePaintArray(h,x,M,q,K){const J=this.paintVertexArray.length,me=this.expression.evaluate(new fs(0),x,{},q,[],K);this.paintVertexArray.resize(h),this._setPaintValue(J,h,me)}updatePaintArray(h,x,M,q){const K=this.expression.evaluate({zoom:0},M,q);this._setPaintValue(h,x,K)}_setPaintValue(h,x,M){if(this.type==="color"){const q=Zs(M);for(let K=h;K<x;K++)this.paintVertexArray.emplace(K,q[0],q[1])}else{for(let q=h;q<x;q++)this.paintVertexArray.emplace(q,M);this.maxValue=Math.max(this.maxValue,Math.abs(M))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class vs{constructor(h,x,M,q,K,J){this.expression=h,this.uniformNames=x.map(me=>`u_${me}_t`),this.type=M,this.useIntegerZoom=q,this.zoom=K,this.maxValue=0,this.paintVertexAttributes=x.map(me=>({name:`a_${me}`,type:"Float32",components:M==="color"?4:2,offset:0})),this.paintVertexArray=new J}populatePaintArray(h,x,M,q,K){const J=this.expression.evaluate(new fs(this.zoom),x,{},q,[],K),me=this.expression.evaluate(new fs(this.zoom+1),x,{},q,[],K),Ce=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(Ce,h,J,me)}updatePaintArray(h,x,M,q){const K=this.expression.evaluate({zoom:this.zoom},M,q),J=this.expression.evaluate({zoom:this.zoom+1},M,q);this._setPaintValue(h,x,K,J)}_setPaintValue(h,x,M,q){if(this.type==="color"){const K=Zs(M),J=Zs(q);for(let me=h;me<x;me++)this.paintVertexArray.emplace(me,K[0],K[1],J[0],J[1])}else{for(let K=h;K<x;K++)this.paintVertexArray.emplace(K,M,q);this.maxValue=Math.max(this.maxValue,Math.abs(M),Math.abs(q))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,x){const M=this.useIntegerZoom?Math.floor(x.zoom):x.zoom,q=Rt(this.expression.interpolationFactor(M,this.zoom,this.zoom+1),0,1);h.set(q)}getBinding(h,x,M){return new Gr(h,x)}}class Qs{constructor(h,x,M,q,K,J){this.expression=h,this.type=x,this.useIntegerZoom=M,this.zoom=q,this.layerId=J,this.zoomInPaintVertexArray=new K,this.zoomOutPaintVertexArray=new K}populatePaintArray(h,x,M){const q=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(q,h,x.patterns&&x.patterns[this.layerId],M)}updatePaintArray(h,x,M,q,K){this._setPaintValues(h,x,M.patterns&&M.patterns[this.layerId],K)}_setPaintValues(h,x,M,q){if(!q||!M)return;const{min:K,mid:J,max:me}=M,Ce=q[K],Oe=q[J],f=q[me];if(Ce&&Oe&&f)for(let u=h;u<x;u++)this.zoomInPaintVertexArray.emplace(u,Oe.tl[0],Oe.tl[1],Oe.br[0],Oe.br[1],Ce.tl[0],Ce.tl[1],Ce.br[0],Ce.br[1],Oe.pixelRatio,Ce.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,Oe.tl[0],Oe.tl[1],Oe.br[0],Oe.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],Oe.pixelRatio,f.pixelRatio)}upload(h){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,Vi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,Vi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class To{constructor(h,x,M){this.binders={},this._buffers=[];const q=[];for(const K in h.paint._values){if(!M(K))continue;const J=h.paint.get(K);if(!(J instanceof _r&&Ts(J.property.specification)))continue;const me=Vo(K,h.type),Ce=J.value,Oe=J.property.specification.type,f=J.property.useIntegerZoom,u=J.property.specification["property-type"],p=u==="cross-faded"||u==="cross-faded-data-driven";if(Ce.kind==="constant")this.binders[K]=p?new ts(Ce.value,me):new es(Ce.value,me,Oe),q.push(`/u_${K}`);else if(Ce.kind==="source"||p){const S=Sc(K,Oe,"source");this.binders[K]=p?new Qs(Ce,Oe,f,x,S,h.id):new Lr(Ce,me,Oe,S),q.push(`/a_${K}`)}else{const S=Sc(K,Oe,"composite");this.binders[K]=new vs(Ce,me,Oe,f,x,S),q.push(`/z_${K}`)}}this.cacheKey=q.sort().join("")}getMaxValue(h){const x=this.binders[h];return x instanceof Lr||x instanceof vs?x.maxValue:0}populatePaintArrays(h,x,M,q,K){for(const J in this.binders){const me=this.binders[J];(me instanceof Lr||me instanceof vs||me instanceof Qs)&&me.populatePaintArray(h,x,M,q,K)}}setConstantPatternPositions(h,x){for(const M in this.binders){const q=this.binders[M];q instanceof ts&&q.setConstantPatternPositions(h,x)}}updatePaintArrays(h,x,M,q,K){let J=!1;for(const me in h){const Ce=x.getPositions(me);for(const Oe of Ce){const f=M.feature(Oe.index);for(const u in this.binders){const p=this.binders[u];if((p instanceof Lr||p instanceof vs||p instanceof Qs)&&p.expression.isStateDependent===!0){const S=q.paint.get(u);p.expression=S.value,p.updatePaintArray(Oe.start,Oe.end,f,h[me],K),J=!0}}}}return J}defines(){const h=[];for(const x in this.binders){const M=this.binders[x];(M instanceof es||M instanceof ts)&&h.push(...M.uniformNames.map(q=>`#define HAS_UNIFORM_${q}`))}return h}getBinderAttributes(){const h=[];for(const x in this.binders){const M=this.binders[x];if(M instanceof Lr||M instanceof vs)for(let q=0;q<M.paintVertexAttributes.length;q++)h.push(M.paintVertexAttributes[q].name);else if(M instanceof Qs)for(let q=0;q<Vi.members.length;q++)h.push(Vi.members[q].name)}return h}getBinderUniforms(){const h=[];for(const x in this.binders){const M=this.binders[x];if(M instanceof es||M instanceof ts||M instanceof vs)for(const q of M.uniformNames)h.push(q)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h,x){const M=[];for(const q in this.binders){const K=this.binders[q];if(K instanceof es||K instanceof ts||K instanceof vs){for(const J of K.uniformNames)if(x[J]){const me=K.getBinding(h,x[J],J);M.push({name:J,property:q,binding:me})}}}return M}setUniforms(h,x,M,q){for(const{name:K,property:J,binding:me}of x)this.binders[J].setUniform(me,q,M.get(J),K)}updatePaintBuffers(h){this._buffers=[];for(const x in this.binders){const M=this.binders[x];if(h&&M instanceof Qs){const q=h.fromScale===2?M.zoomInPaintVertexBuffer:M.zoomOutPaintVertexBuffer;q&&this._buffers.push(q)}else(M instanceof Lr||M instanceof vs)&&M.paintVertexBuffer&&this._buffers.push(M.paintVertexBuffer)}}upload(h){for(const x in this.binders){const M=this.binders[x];(M instanceof Lr||M instanceof vs||M instanceof Qs)&&M.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const x=this.binders[h];(x instanceof Lr||x instanceof vs||x instanceof Qs)&&x.destroy()}}}class No{constructor(h,x,M=()=>!0){this.programConfigurations={};for(const q of h)this.programConfigurations[q.id]=new To(q,x,M);this.needsUpload=!1,this._featureMap=new Ia,this._bufferOffset=0}populatePaintArrays(h,x,M,q,K,J){for(const me in this.programConfigurations)this.programConfigurations[me].populatePaintArrays(h,x,q,K,J);x.id!==void 0&&this._featureMap.add(x.id,M,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,x,M,q){for(const K of M)this.needsUpload=this.programConfigurations[K.id].updatePaintArrays(h,this._featureMap,x,K,q)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const x in this.programConfigurations)this.programConfigurations[x].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}function Vo(m,h){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[m]||[m.replace(`${h}-`,"").replace(/-/g,"_")]}function Sc(m,h,x){const M={color:{source:D,composite:O},number:{source:jt,composite:D}},q=function(K){return{"line-pattern":{source:vt,composite:vt},"fill-pattern":{source:vt,composite:vt},"fill-extrusion-pattern":{source:vt,composite:vt}}[K]}(m);return q&&q[x]||M[h][x]}bn("ConstantBinder",es),bn("CrossFadedConstantBinder",ts),bn("SourceExpressionBinder",Lr),bn("CrossFadedCompositeBinder",Qs),bn("CompositeExpressionBinder",vs),bn("ProgramConfiguration",To,{omit:["_buffers"]}),bn("ProgramConfigurationSet",No);const Ws=8192,Zl=Math.pow(2,14)-1,cu=-Zl-1;function el(m){const h=Ws/m.extent,x=m.loadGeometry();for(let M=0;M<x.length;M++){const q=x[M];for(let K=0;K<q.length;K++){const J=q[K],me=Math.round(J.x*h),Ce=Math.round(J.y*h);J.x=Rt(me,cu,Zl),J.y=Rt(Ce,cu,Zl),(me<J.x||me>J.x+1||Ce<J.y||Ce>J.y+1)&&dt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return x}function vl(m,h){return{type:m.type,id:m.id,properties:m.properties,geometry:h?el(m):[]}}function Pl(m,h,x,M,q){m.emplaceBack(2*h+(M+1)/2,2*x+(q+1)/2)}class hu{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Se,this.indexArray=new Xt,this.segments=new Zi,this.programConfigurations=new No(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){const q=this.layers[0],K=[];let J=null,me=!1;q.type==="circle"&&(J=q.layout.get("circle-sort-key"),me=!J.isConstant());for(const{feature:Ce,id:Oe,index:f,sourceLayerIndex:u}of h){const p=this.layers[0]._featureFilter.needGeometry,S=vl(Ce,p);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),S,M))continue;const L=me?J.evaluate(S,{},M):void 0,G={id:Oe,properties:Ce.properties,type:Ce.type,sourceLayerIndex:u,index:f,geometry:p?S.geometry:el(Ce),patterns:{},sortKey:L};K.push(G)}me&&K.sort((Ce,Oe)=>Ce.sortKey-Oe.sortKey);for(const Ce of K){const{geometry:Oe,index:f,sourceLayerIndex:u}=Ce,p=h[f].feature;this.addFeature(Ce,Oe,f,M),x.featureIndex.insert(p,Oe,f,u,this.index)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,ji),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,x,M,q){for(const K of x)for(const J of K){const me=J.x,Ce=J.y;if(me<0||me>=Ws||Ce<0||Ce>=Ws)continue;const Oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,h.sortKey),f=Oe.vertexLength;Pl(this.layoutVertexArray,me,Ce,-1,-1),Pl(this.layoutVertexArray,me,Ce,1,-1),Pl(this.layoutVertexArray,me,Ce,1,1),Pl(this.layoutVertexArray,me,Ce,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),Oe.vertexLength+=4,Oe.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,{},q)}}function sf(m,h){for(let x=0;x<m.length;x++)if(Xc(h,m[x]))return!0;for(let x=0;x<h.length;x++)if(Xc(m,h[x]))return!0;return!!_h(m,h)}function Nh(m,h,x){return!!Xc(m,h)||!!Ic(h,m,x)}function Pa(m,h){if(m.length===1)return o0(h,m[0]);for(let x=0;x<h.length;x++){const M=h[x];for(let q=0;q<M.length;q++)if(Xc(m,M[q]))return!0}for(let x=0;x<m.length;x++)if(o0(h,m[x]))return!0;for(let x=0;x<h.length;x++)if(_h(m,h[x]))return!0;return!1}function dA(m,h,x){if(m.length>1){if(_h(m,h))return!0;for(let M=0;M<h.length;M++)if(Ic(h[M],m,x))return!0}for(let M=0;M<m.length;M++)if(Ic(m[M],h,x))return!0;return!1}function _h(m,h){if(m.length===0||h.length===0)return!1;for(let x=0;x<m.length-1;x++){const M=m[x],q=m[x+1];for(let K=0;K<h.length-1;K++)if(Vh(M,q,h[K],h[K+1]))return!0}return!1}function Vh(m,h,x,M){return nt(m,x,M)!==nt(h,x,M)&&nt(m,h,x)!==nt(m,h,M)}function Ic(m,h,x){const M=x*x;if(h.length===1)return m.distSqr(h[0])<M;for(let q=1;q<h.length;q++)if(Uh(m,h[q-1],h[q])<M)return!0;return!1}function Uh(m,h,x){const M=h.distSqr(x);if(M===0)return m.distSqr(h);const q=((m.x-h.x)*(x.x-h.x)+(m.y-h.y)*(x.y-h.y))/M;return m.distSqr(q<0?h:q>1?x:x.sub(h)._mult(q)._add(h))}function o0(m,h){let x,M,q,K=!1;for(let J=0;J<m.length;J++){x=m[J];for(let me=0,Ce=x.length-1;me<x.length;Ce=me++)M=x[me],q=x[Ce],M.y>h.y!=q.y>h.y&&h.x<(q.x-M.x)*(h.y-M.y)/(q.y-M.y)+M.x&&(K=!K)}return K}function Xc(m,h){let x=!1;for(let M=0,q=m.length-1;M<m.length;q=M++){const K=m[M],J=m[q];K.y>h.y!=J.y>h.y&&h.x<(J.x-K.x)*(h.y-K.y)/(J.y-K.y)+K.x&&(x=!x)}return x}function gp(m,h,x){const M=x[0],q=x[2];if(m.x<M.x&&h.x<M.x||m.x>q.x&&h.x>q.x||m.y<M.y&&h.y<M.y||m.y>q.y&&h.y>q.y)return!1;const K=nt(m,h,x[0]);return K!==nt(m,h,x[1])||K!==nt(m,h,x[2])||K!==nt(m,h,x[3])}function Gh(m,h,x){const M=h.paint.get(m).value;return M.kind==="constant"?M.value:x.programConfigurations.get(h.id).getMaxValue(m)}function af(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function Yc(m,h,x,M,q){if(!h[0]&&!h[1])return m;const K=oe.convert(h)._mult(q);x==="viewport"&&K._rotate(-M);const J=[];for(let me=0;me<m.length;me++)J.push(m[me].sub(K));return J}let _p,of;bn("CircleBucket",hu,{omit:["layers"]});var H0={get paint(){return of=of||new oa({"circle-radius":new Gn(ti.paint_circle["circle-radius"]),"circle-color":new Gn(ti.paint_circle["circle-color"]),"circle-blur":new Gn(ti.paint_circle["circle-blur"]),"circle-opacity":new Gn(ti.paint_circle["circle-opacity"]),"circle-translate":new pn(ti.paint_circle["circle-translate"]),"circle-translate-anchor":new pn(ti.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pn(ti.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pn(ti.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Gn(ti.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Gn(ti.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Gn(ti.paint_circle["circle-stroke-opacity"])})},get layout(){return _p=_p||new oa({"circle-sort-key":new Gn(ti.layout_circle["circle-sort-key"])})}},Ql=1e-6,Xu=typeof Float32Array<"u"?Float32Array:Array;function j0(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function yh(m,h,x){var M=h[0],q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Oe=h[6],f=h[7],u=h[8],p=h[9],S=h[10],L=h[11],G=h[12],Q=h[13],re=h[14],he=h[15],_e=x[0],Le=x[1],qe=x[2],Je=x[3];return m[0]=_e*M+Le*me+qe*u+Je*G,m[1]=_e*q+Le*Ce+qe*p+Je*Q,m[2]=_e*K+Le*Oe+qe*S+Je*re,m[3]=_e*J+Le*f+qe*L+Je*he,m[4]=(_e=x[4])*M+(Le=x[5])*me+(qe=x[6])*u+(Je=x[7])*G,m[5]=_e*q+Le*Ce+qe*p+Je*Q,m[6]=_e*K+Le*Oe+qe*S+Je*re,m[7]=_e*J+Le*f+qe*L+Je*he,m[8]=(_e=x[8])*M+(Le=x[9])*me+(qe=x[10])*u+(Je=x[11])*G,m[9]=_e*q+Le*Ce+qe*p+Je*Q,m[10]=_e*K+Le*Oe+qe*S+Je*re,m[11]=_e*J+Le*f+qe*L+Je*he,m[12]=(_e=x[12])*M+(Le=x[13])*me+(qe=x[14])*u+(Je=x[15])*G,m[13]=_e*q+Le*Ce+qe*p+Je*Q,m[14]=_e*K+Le*Oe+qe*S+Je*re,m[15]=_e*J+Le*f+qe*L+Je*he,m}Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)});var $c,pA=yh;function lf(m,h,x){var M=h[0],q=h[1],K=h[2],J=h[3];return m[0]=x[0]*M+x[4]*q+x[8]*K+x[12]*J,m[1]=x[1]*M+x[5]*q+x[9]*K+x[13]*J,m[2]=x[2]*M+x[6]*q+x[10]*K+x[14]*J,m[3]=x[3]*M+x[7]*q+x[11]*K+x[15]*J,m}$c=new Xu(4),Xu!=Float32Array&&($c[0]=0,$c[1]=0,$c[2]=0,$c[3]=0);class l0 extends _s{constructor(h){super(h,H0)}createBucket(h){return new hu(h)}queryRadius(h){const x=h;return Gh("circle-radius",this,x)+Gh("circle-stroke-width",this,x)+af(this.paint.get("circle-translate"))}queryIntersectsFeature(h,x,M,q,K,J,me,Ce){const Oe=Yc(h,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),J.angle,me),f=this.paint.get("circle-radius").evaluate(x,M)+this.paint.get("circle-stroke-width").evaluate(x,M),u=this.paint.get("circle-pitch-alignment")==="map",p=u?Oe:function(L,G){return L.map(Q=>ps(Q,G))}(Oe,Ce),S=u?f*me:f;for(const L of q)for(const G of L){const Q=u?G:ps(G,Ce);let re=S;const he=lf([],[G.x,G.y,0,1],Ce);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?re*=he[3]/J.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(re*=J.cameraToCenterDistance/he[3]),Nh(p,Q,re))return!0}return!1}}function ps(m,h){const x=lf([],[m.x,m.y,0,1],h);return new oe(x[0]/x[3],x[1]/x[3])}class Wl extends hu{}let qh;bn("HeatmapBucket",Wl,{omit:["layers"]});var Hh={get paint(){return qh=qh||new oa({"heatmap-radius":new Gn(ti.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Gn(ti.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pn(ti.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Cu(ti.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pn(ti.paint_heatmap["heatmap-opacity"])})}};function uf(m,{width:h,height:x},M,q){if(q){if(q instanceof Uint8ClampedArray)q=new Uint8Array(q.buffer);else if(q.length!==h*x*M)throw new RangeError(`mismatched image size. expected: ${q.length} but got: ${h*x*M}`)}else q=new Uint8Array(h*x*M);return m.width=h,m.height=x,m.data=q,m}function mA(m,{width:h,height:x},M){if(h===m.width&&x===m.height)return;const q=uf({},{width:h,height:x},M);Z0(m,q,{x:0,y:0},{x:0,y:0},{width:Math.min(m.width,h),height:Math.min(m.height,x)},M),m.width=h,m.height=x,m.data=q.data}function Z0(m,h,x,M,q,K){if(q.width===0||q.height===0)return h;if(q.width>m.width||q.height>m.height||x.x>m.width-q.width||x.y>m.height-q.height)throw new RangeError("out of range source coordinates for image copy");if(q.width>h.width||q.height>h.height||M.x>h.width-q.width||M.y>h.height-q.height)throw new RangeError("out of range destination coordinates for image copy");const J=m.data,me=h.data;if(J===me)throw new Error("srcData equals dstData, so image is already copied");for(let Ce=0;Ce<q.height;Ce++){const Oe=((x.y+Ce)*m.width+x.x)*K,f=((M.y+Ce)*h.width+M.x)*K;for(let u=0;u<q.width*K;u++)me[f+u]=J[Oe+u]}return h}class Dl{constructor(h,x){uf(this,h,1,x)}resize(h){mA(this,h,1)}clone(){return new Dl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,x,M,q,K){Z0(h,x,M,q,K,1)}}class Nu{constructor(h,x){uf(this,h,4,x)}resize(h){mA(this,h,4)}replace(h,x){x?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new Nu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,x,M,q,K){Z0(h,x,M,q,K,4)}}function gA(m){const h={},x=m.resolution||256,M=m.clips?m.clips.length:1,q=m.image||new Nu({width:x,height:M});if(Math.log(x)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${x}`);const K=(J,me,Ce)=>{h[m.evaluationKey]=Ce;const Oe=m.expression.evaluate(h);q.data[J+me+0]=Math.floor(255*Oe.r/Oe.a),q.data[J+me+1]=Math.floor(255*Oe.g/Oe.a),q.data[J+me+2]=Math.floor(255*Oe.b/Oe.a),q.data[J+me+3]=Math.floor(255*Oe.a)};if(m.clips)for(let J=0,me=0;J<M;++J,me+=4*x)for(let Ce=0,Oe=0;Ce<x;Ce++,Oe+=4){const f=Ce/(x-1),{start:u,end:p}=m.clips[J];K(me,Oe,u*(1-f)+p*f)}else for(let J=0,me=0;J<x;J++,me+=4)K(0,me,J/(x-1));return q}bn("AlphaImage",Dl),bn("RGBAImage",Nu);class u0 extends _s{createBucket(h){return new Wl(h)}constructor(h){super(h,Hh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=gA({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let c0;var yp={get paint(){return c0=c0||new oa({"hillshade-illumination-direction":new pn(ti.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new pn(ti.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pn(ti.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pn(ti.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pn(ti.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pn(ti.paint_hillshade["hillshade-accent-color"])})}};class vu extends _s{constructor(h){super(h,yp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Kc=ys([{name:"a_pos",components:2,type:"Int16"}],4),{members:cf}=Kc;var vh={exports:{}};function Ll(m,h,x){x=x||2;var M,q,K,J,me,Ce,Oe,f=h&&h.length,u=f?h[0]*x:m.length,p=h0(m,0,u,x,!0),S=[];if(!p||p.next===p.prev)return S;if(f&&(p=function(G,Q,re,he){var _e,Le,qe,Je=[];for(_e=0,Le=Q.length;_e<Le;_e++)(qe=h0(G,Q[_e]*he,_e<Le-1?Q[_e+1]*he:G.length,he,!1))===qe.next&&(qe.steiner=!0),Je.push(Af(qe));for(Je.sort(Ec),_e=0;_e<Je.length;_e++)re=hf(Je[_e],re);return re}(m,h,p,x)),m.length>80*x){M=K=m[0],q=J=m[1];for(var L=x;L<u;L+=x)(me=m[L])<M&&(M=me),(Ce=m[L+1])<q&&(q=Ce),me>K&&(K=me),Ce>J&&(J=Ce);Oe=(Oe=Math.max(K-M,J-q))!==0?32767/Oe:0}return jh(p,S,x,M,q,Oe,0),S}function h0(m,h,x,M,q){var K,J;if(q===uc(m,h,x,M)>0)for(K=h;K<x;K+=M)J=Zh(K,m[K],m[K+1],J);else for(K=x-M;K>=h;K-=M)J=Zh(K,m[K],m[K+1],J);return J&&ff(J,J.next)&&(mf(J),J=J.next),J}function Jc(m,h){if(!m)return m;h||(h=m);var x,M=m;do if(x=!1,M.steiner||!ff(M,M.next)&&ko(M.prev,M,M.next)!==0)M=M.next;else{if(mf(M),(M=h=M.prev)===M.next)break;x=!0}while(x||M!==h);return h}function jh(m,h,x,M,q,K,J){if(m){!J&&K&&function(f,u,p,S){var L=f;do L.z===0&&(L.z=oc(L.x,L.y,u,p,S)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==f);L.prevZ.nextZ=null,L.prevZ=null,function(G){var Q,re,he,_e,Le,qe,Je,At,gt=1;do{for(re=G,G=null,Le=null,qe=0;re;){for(qe++,he=re,Je=0,Q=0;Q<gt&&(Je++,he=he.nextZ);Q++);for(At=gt;Je>0||At>0&&he;)Je!==0&&(At===0||!he||re.z<=he.z)?(_e=re,re=re.nextZ,Je--):(_e=he,he=he.nextZ,At--),Le?Le.nextZ=_e:G=_e,_e.prevZ=Le,Le=_e;re=he}Le.nextZ=null,gt*=2}while(qe>1)}(L)}(m,M,q,K);for(var me,Ce,Oe=m;m.prev!==m.next;)if(me=m.prev,Ce=m.next,K?W0(m,M,q,K):Q0(m))h.push(me.i/x|0),h.push(m.i/x|0),h.push(Ce.i/x|0),mf(m),m=Ce.next,Oe=Ce.next;else if((m=Ce)===Oe){J?J===1?jh(m=xh(Jc(m),h,x),h,x,M,q,K,2):J===2&&Em(m,h,x,M,q,K):jh(Jc(m),h,x,M,q,K,1);break}}}function Q0(m){var h=m.prev,x=m,M=m.next;if(ko(h,x,M)>=0)return!1;for(var q=h.x,K=x.x,J=M.x,me=h.y,Ce=x.y,Oe=M.y,f=q<K?q<J?q:J:K<J?K:J,u=me<Ce?me<Oe?me:Oe:Ce<Oe?Ce:Oe,p=q>K?q>J?q:J:K>J?K:J,S=me>Ce?me>Oe?me:Oe:Ce>Oe?Ce:Oe,L=M.next;L!==h;){if(L.x>=f&&L.x<=p&&L.y>=u&&L.y<=S&&_A(q,me,K,Ce,J,Oe,L.x,L.y)&&ko(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function W0(m,h,x,M){var q=m.prev,K=m,J=m.next;if(ko(q,K,J)>=0)return!1;for(var me=q.x,Ce=K.x,Oe=J.x,f=q.y,u=K.y,p=J.y,S=me<Ce?me<Oe?me:Oe:Ce<Oe?Ce:Oe,L=f<u?f<p?f:p:u<p?u:p,G=me>Ce?me>Oe?me:Oe:Ce>Oe?Ce:Oe,Q=f>u?f>p?f:p:u>p?u:p,re=oc(S,L,h,x,M),he=oc(G,Q,h,x,M),_e=m.prevZ,Le=m.nextZ;_e&&_e.z>=re&&Le&&Le.z<=he;){if(_e.x>=S&&_e.x<=G&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&_A(me,f,Ce,u,Oe,p,_e.x,_e.y)&&ko(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,Le.x>=S&&Le.x<=G&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&_A(me,f,Ce,u,Oe,p,Le.x,Le.y)&&ko(Le.prev,Le,Le.next)>=0))return!1;Le=Le.nextZ}for(;_e&&_e.z>=re;){if(_e.x>=S&&_e.x<=G&&_e.y>=L&&_e.y<=Q&&_e!==q&&_e!==J&&_A(me,f,Ce,u,Oe,p,_e.x,_e.y)&&ko(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Le&&Le.z<=he;){if(Le.x>=S&&Le.x<=G&&Le.y>=L&&Le.y<=Q&&Le!==q&&Le!==J&&_A(me,f,Ce,u,Oe,p,Le.x,Le.y)&&ko(Le.prev,Le,Le.next)>=0)return!1;Le=Le.nextZ}return!0}function xh(m,h,x){var M=m;do{var q=M.prev,K=M.next.next;!ff(q,K)&&vp(q,M,M.next,K)&&xl(q,K)&&xl(K,q)&&(h.push(q.i/x|0),h.push(M.i/x|0),h.push(K.i/x|0),mf(M),mf(M.next),M=m=K),M=M.next}while(M!==m);return Jc(M)}function Em(m,h,x,M,q,K){var J=m;do{for(var me=J.next.next;me!==J.prev;){if(J.i!==me.i&&Cm(J,me)){var Ce=lc(J,me);return J=Jc(J,J.next),Ce=Jc(Ce,Ce.next),jh(J,h,x,M,q,K,0),void jh(Ce,h,x,M,q,K,0)}me=me.next}J=J.next}while(J!==m)}function Ec(m,h){return m.x-h.x}function hf(m,h){var x=function(q,K){var J,me=K,Ce=q.x,Oe=q.y,f=-1/0;do{if(Oe<=me.y&&Oe>=me.next.y&&me.next.y!==me.y){var u=me.x+(Oe-me.y)*(me.next.x-me.x)/(me.next.y-me.y);if(u<=Ce&&u>f&&(f=u,J=me.x<me.next.x?me:me.next,u===Ce))return J}me=me.next}while(me!==K);if(!J)return null;var p,S=J,L=J.x,G=J.y,Q=1/0;me=J;do Ce>=me.x&&me.x>=L&&Ce!==me.x&&_A(Oe<G?Ce:f,Oe,L,G,Oe<G?f:Ce,Oe,me.x,me.y)&&(p=Math.abs(Oe-me.y)/(Ce-me.x),xl(me,q)&&(p<Q||p===Q&&(me.x>J.x||me.x===J.x&&X0(J,me)))&&(J=me,Q=p)),me=me.next;while(me!==S);return J}(m,h);if(!x)return h;var M=lc(x,m);return Jc(M,M.next),Jc(x,x.next)}function X0(m,h){return ko(m.prev,m,h.prev)<0&&ko(h.next,m,m.next)<0}function oc(m,h,x,M,q){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=(m-x)*q|0)|m<<8))|m<<4))|m<<2))|m<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-M)*q|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function Af(m){var h=m,x=m;do(h.x<x.x||h.x===x.x&&h.y<x.y)&&(x=h),h=h.next;while(h!==m);return x}function _A(m,h,x,M,q,K,J,me){return(q-J)*(h-me)>=(m-J)*(K-me)&&(m-J)*(M-me)>=(x-J)*(h-me)&&(x-J)*(K-me)>=(q-J)*(M-me)}function Cm(m,h){return m.next.i!==h.i&&m.prev.i!==h.i&&!function(x,M){var q=x;do{if(q.i!==x.i&&q.next.i!==x.i&&q.i!==M.i&&q.next.i!==M.i&&vp(q,q.next,x,M))return!0;q=q.next}while(q!==x);return!1}(m,h)&&(xl(m,h)&&xl(h,m)&&function(x,M){var q=x,K=!1,J=(x.x+M.x)/2,me=(x.y+M.y)/2;do q.y>me!=q.next.y>me&&q.next.y!==q.y&&J<(q.next.x-q.x)*(me-q.y)/(q.next.y-q.y)+q.x&&(K=!K),q=q.next;while(q!==x);return K}(m,h)&&(ko(m.prev,m,h.prev)||ko(m,h.prev,h))||ff(m,h)&&ko(m.prev,m,m.next)>0&&ko(h.prev,h,h.next)>0)}function ko(m,h,x){return(h.y-m.y)*(x.x-h.x)-(h.x-m.x)*(x.y-h.y)}function ff(m,h){return m.x===h.x&&m.y===h.y}function vp(m,h,x,M){var q=pf(ko(m,h,x)),K=pf(ko(m,h,M)),J=pf(ko(x,M,m)),me=pf(ko(x,M,h));return q!==K&&J!==me||!(q!==0||!df(m,x,h))||!(K!==0||!df(m,M,h))||!(J!==0||!df(x,m,M))||!(me!==0||!df(x,h,M))}function df(m,h,x){return h.x<=Math.max(m.x,x.x)&&h.x>=Math.min(m.x,x.x)&&h.y<=Math.max(m.y,x.y)&&h.y>=Math.min(m.y,x.y)}function pf(m){return m>0?1:m<0?-1:0}function xl(m,h){return ko(m.prev,m,m.next)<0?ko(m,h,m.next)>=0&&ko(m,m.prev,h)>=0:ko(m,h,m.prev)<0||ko(m,m.next,h)<0}function lc(m,h){var x=new Da(m.i,m.x,m.y),M=new Da(h.i,h.x,h.y),q=m.next,K=h.prev;return m.next=h,h.prev=m,x.next=q,q.prev=x,M.next=x,x.prev=M,K.next=M,M.prev=K,M}function Zh(m,h,x,M){var q=new Da(m,h,x);return M?(q.next=M.next,q.prev=M,M.next.prev=q,M.next=q):(q.prev=q,q.next=q),q}function mf(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function Da(m,h,x){this.i=m,this.x=h,this.y=x,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function uc(m,h,x,M){for(var q=0,K=h,J=x-M;K<x;K+=M)q+=(m[J]-m[K])*(m[K+1]+m[J+1]),J=K;return q}vh.exports=Ll,vh.exports.default=Ll,Ll.deviation=function(m,h,x,M){var q=h&&h.length,K=Math.abs(uc(m,0,q?h[0]*x:m.length,x));if(q)for(var J=0,me=h.length;J<me;J++)K-=Math.abs(uc(m,h[J]*x,J<me-1?h[J+1]*x:m.length,x));var Ce=0;for(J=0;J<M.length;J+=3){var Oe=M[J]*x,f=M[J+1]*x,u=M[J+2]*x;Ce+=Math.abs((m[Oe]-m[u])*(m[f+1]-m[Oe+1])-(m[Oe]-m[f])*(m[u+1]-m[Oe+1]))}return K===0&&Ce===0?0:Math.abs((Ce-K)/K)},Ll.flatten=function(m){for(var h=m[0][0].length,x={vertices:[],holes:[],dimensions:h},M=0,q=0;q<m.length;q++){for(var K=0;K<m[q].length;K++)for(var J=0;J<h;J++)x.vertices.push(m[q][K][J]);q>0&&x.holes.push(M+=m[q-1].length)}return x};var A0=U(vh.exports);function gf(m,h,x,M,q){_f(m,h,x||0,M||m.length-1,q||Qh)}function _f(m,h,x,M,q){for(;M>x;){if(M-x>600){var K=M-x+1,J=h-x+1,me=Math.log(K),Ce=.5*Math.exp(2*me/3),Oe=.5*Math.sqrt(me*Ce*(K-Ce)/K)*(J-K/2<0?-1:1);_f(m,h,Math.max(x,Math.floor(h-J*Ce/K+Oe)),Math.min(M,Math.floor(h+(K-J)*Ce/K+Oe)),q)}var f=m[h],u=x,p=M;for(Cc(m,x,h),q(m[M],f)>0&&Cc(m,x,M);u<p;){for(Cc(m,u,p),u++,p--;q(m[u],f)<0;)u++;for(;q(m[p],f)>0;)p--}q(m[x],f)===0?Cc(m,x,p):Cc(m,++p,M),p<=h&&(x=p+1),h<=p&&(M=p-1)}}function Cc(m,h,x){var M=m[h];m[h]=m[x],m[x]=M}function Qh(m,h){return m<h?-1:m>h?1:0}function bh(m,h){const x=m.length;if(x<=1)return[m];const M=[];let q,K;for(let J=0;J<x;J++){const me=pt(m[J]);me!==0&&(m[J].area=Math.abs(me),K===void 0&&(K=me<0),K===me<0?(q&&M.push(q),q=[m[J]]):q.push(m[J]))}if(q&&M.push(q),h>1)for(let J=0;J<M.length;J++)M[J].length<=h||(gf(M[J],h,1,M[J].length-1,yf),M[J]=M[J].slice(0,h));return M}function yf(m,h){return h.area-m.area}function yA(m,h,x){const M=x.patternDependencies;let q=!1;for(const K of h){const J=K.paint.get(`${m}-pattern`);J.isConstant()||(q=!0);const me=J.constantOr(null);me&&(q=!0,M[me.to]=!0,M[me.from]=!0)}return q}function vA(m,h,x,M,q){const K=q.patternDependencies;for(const J of h){const me=J.paint.get(`${m}-pattern`).value;if(me.kind!=="constant"){let Ce=me.evaluate({zoom:M-1},x,{},q.availableImages),Oe=me.evaluate({zoom:M},x,{},q.availableImages),f=me.evaluate({zoom:M+1},x,{},q.availableImages);Ce=Ce&&Ce.name?Ce.name:Ce,Oe=Oe&&Oe.name?Oe.name:Oe,f=f&&f.name?f.name:f,K[Ce]=!0,K[Oe]=!0,K[f]=!0,x.patterns[J.id]={min:Ce,mid:Oe,max:f}}}return x}class Wh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Te,this.indexArray=new Xt,this.indexArray2=new Jt,this.programConfigurations=new No(h.layers,h.zoom),this.segments=new Zi,this.segments2=new Zi,this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){this.hasPattern=yA("fill",this.layers,x);const q=this.layers[0].layout.get("fill-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Oe,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),p,M))continue;const S=K?q.evaluate(p,{},M,x.availableImages):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Oe,geometry:u?p.geometry:el(me),patterns:{},sortKey:S};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Oe,sourceLayerIndex:f}=me;if(this.hasPattern){const u=vA("fill",this.layers,me,this.zoom,x);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Oe,M,{});x.featureIndex.insert(h[Oe].feature,Ce,Oe,f,this.index)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}addFeatures(h,x,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,x,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,cf),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,x,M,q,K){for(const J of bh(x,500)){let me=0;for(const S of J)me+=S.length;const Ce=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray),Oe=Ce.vertexLength,f=[],u=[];for(const S of J){if(S.length===0)continue;S!==J[0]&&u.push(f.length/2);const L=this.segments2.prepareSegment(S.length,this.layoutVertexArray,this.indexArray2),G=L.vertexLength;this.layoutVertexArray.emplaceBack(S[0].x,S[0].y),this.indexArray2.emplaceBack(G+S.length-1,G),f.push(S[0].x),f.push(S[0].y);for(let Q=1;Q<S.length;Q++)this.layoutVertexArray.emplaceBack(S[Q].x,S[Q].y),this.indexArray2.emplaceBack(G+Q-1,G+Q),f.push(S[Q].x),f.push(S[Q].y);L.vertexLength+=S.length,L.primitiveLength+=S.length}const p=A0(f,u);for(let S=0;S<p.length;S+=3)this.indexArray.emplaceBack(Oe+p[S],Oe+p[S+1],Oe+p[S+2]);Ce.vertexLength+=me,Ce.primitiveLength+=p.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}let Y0,xA;bn("FillBucket",Wh,{omit:["layers","patternFeatures"]});var Xh={get paint(){return xA=xA||new oa({"fill-antialias":new pn(ti.paint_fill["fill-antialias"]),"fill-opacity":new Gn(ti.paint_fill["fill-opacity"]),"fill-color":new Gn(ti.paint_fill["fill-color"]),"fill-outline-color":new Gn(ti.paint_fill["fill-outline-color"]),"fill-translate":new pn(ti.paint_fill["fill-translate"]),"fill-translate-anchor":new pn(ti.paint_fill["fill-translate-anchor"]),"fill-pattern":new Jn(ti.paint_fill["fill-pattern"])})},get layout(){return Y0=Y0||new oa({"fill-sort-key":new Gn(ti.layout_fill["fill-sort-key"])})}};class f0 extends _s{constructor(h){super(h,Xh)}recalculate(h,x){super.recalculate(h,x);const M=this.paint._values["fill-outline-color"];M.value.kind==="constant"&&M.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new Wh(h)}queryRadius(){return af(this.paint.get("fill-translate"))}queryIntersectsFeature(h,x,M,q,K,J,me){return Pa(Yc(h,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),J.angle,me),q)}isTileClipped(){return!0}}const $0=ys([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),xp=ys([{name:"a_centroid",components:2,type:"Int16"}],4),{members:bA}=$0;var cc={},vf=W,K0=wh;function wh(m,h,x,M,q){this.properties={},this.extent=x,this.type=0,this._pbf=m,this._geometry=-1,this._keys=M,this._values=q,m.readFields(eh,this,h)}function eh(m,h,x){m==1?h.id=x.readVarint():m==2?function(M,q){for(var K=M.readVarint()+M.pos;M.pos<K;){var J=q._keys[M.readVarint()],me=q._values[M.readVarint()];q.properties[J]=me}}(x,h):m==3?h.type=x.readVarint():m==4&&(h._geometry=x.pos)}function bp(m){for(var h,x,M=0,q=0,K=m.length,J=K-1;q<K;J=q++)M+=((x=m[J]).x-(h=m[q]).x)*(h.y+x.y);return M}wh.types=["Unknown","Point","LineString","Polygon"],wh.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,x=m.readVarint()+m.pos,M=1,q=0,K=0,J=0,me=[];m.pos<x;){if(q<=0){var Ce=m.readVarint();M=7&Ce,q=Ce>>3}if(q--,M===1||M===2)K+=m.readSVarint(),J+=m.readSVarint(),M===1&&(h&&me.push(h),h=[]),h.push(new vf(K,J));else{if(M!==7)throw new Error("unknown command "+M);h&&h.push(h[0].clone())}}return h&&me.push(h),me},wh.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,x=1,M=0,q=0,K=0,J=1/0,me=-1/0,Ce=1/0,Oe=-1/0;m.pos<h;){if(M<=0){var f=m.readVarint();x=7&f,M=f>>3}if(M--,x===1||x===2)(q+=m.readSVarint())<J&&(J=q),q>me&&(me=q),(K+=m.readSVarint())<Ce&&(Ce=K),K>Oe&&(Oe=K);else if(x!==7)throw new Error("unknown command "+x)}return[J,Ce,me,Oe]},wh.prototype.toGeoJSON=function(m,h,x){var M,q,K=this.extent*Math.pow(2,x),J=this.extent*m,me=this.extent*h,Ce=this.loadGeometry(),Oe=wh.types[this.type];function f(S){for(var L=0;L<S.length;L++){var G=S[L];S[L]=[360*(G.x+J)/K-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+me)/K)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(M=0;M<Ce.length;M++)u[M]=Ce[M][0];f(Ce=u);break;case 2:for(M=0;M<Ce.length;M++)f(Ce[M]);break;case 3:for(Ce=function(S){var L=S.length;if(L<=1)return[S];for(var G,Q,re=[],he=0;he<L;he++){var _e=bp(S[he]);_e!==0&&(Q===void 0&&(Q=_e<0),Q===_e<0?(G&&re.push(G),G=[S[he]]):G.push(S[he]))}return G&&re.push(G),re}(Ce),M=0;M<Ce.length;M++)for(q=0;q<Ce[M].length;q++)f(Ce[M][q])}Ce.length===1?Ce=Ce[0]:Oe="Multi"+Oe;var p={type:"Feature",geometry:{type:Oe,coordinates:Ce},properties:this.properties};return"id"in this&&(p.id=this.id),p};var wp=K0,Sp=J0;function J0(m,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=m,this._keys=[],this._values=[],this._features=[],m.readFields(Sh,this,h),this.length=this._features.length}function Sh(m,h,x){m===15?h.version=x.readVarint():m===1?h.name=x.readString():m===5?h.extent=x.readVarint():m===2?h._features.push(x.pos):m===3?h._keys.push(x.readString()):m===4&&h._values.push(function(M){for(var q=null,K=M.readVarint()+M.pos;M.pos<K;){var J=M.readVarint()>>3;q=J===1?M.readString():J===2?M.readFloat():J===3?M.readDouble():J===4?M.readVarint64():J===5?M.readVarint():J===6?M.readSVarint():J===7?M.readBoolean():null}return q}(x))}J0.prototype.feature=function(m){if(m<0||m>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[m];var h=this._pbf.readVarint()+this._pbf.pos;return new wp(this._pbf,h,this.extent,this._keys,this._values)};var Tm=Sp;function Tc(m,h,x){if(m===3){var M=new Tm(x,x.readVarint()+x.pos);M.length&&(h[M.name]=M)}}cc.VectorTile=function(m,h){this.layers=m.readFields(Tc,{},h)},cc.VectorTileFeature=K0,cc.VectorTileLayer=Sp;const Ih=cc.VectorTileFeature.types,xf=Math.pow(2,13);function Yh(m,h,x,M,q,K,J,me){m.emplaceBack(h,x,2*Math.floor(M*xf)+J,q*xf*2,K*xf*2,Math.round(me))}class wA{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new Re,this.centroidVertexArray=new ue,this.indexArray=new Xt,this.programConfigurations=new No(h.layers,h.zoom),this.segments=new Zi,this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){this.features=[],this.hasPattern=yA("fill-extrusion",this.layers,x);for(const{feature:q,id:K,index:J,sourceLayerIndex:me}of h){const Ce=this.layers[0]._featureFilter.needGeometry,Oe=vl(q,Ce);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),Oe,M))continue;const f={id:K,sourceLayerIndex:me,index:J,geometry:Ce?Oe.geometry:el(q),properties:q.properties,type:q.type,patterns:{}};this.hasPattern?this.features.push(vA("fill-extrusion",this.layers,f,this.zoom,x)):this.addFeature(f,f.geometry,J,M,{}),x.featureIndex.insert(q,f.geometry,J,me,this.index,!0)}}addFeatures(h,x,M){for(const q of this.features){const{geometry:K}=q;this.addFeature(q,K,q.index,x,M)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,bA),this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,xp.members,!0),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(h,x,M,q,K){const J={x:0,y:0,vertexCount:0};for(const me of bh(x,500)){let Ce=0;for(const L of me)Ce+=L.length;let Oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const L of me){if(L.length===0||Ir(L))continue;let G=0;for(let Q=0;Q<L.length;Q++){const re=L[Q];if(Q>=1){const he=L[Q-1];if(!$h(re,he)){Oe.vertexLength+4>Zi.MAX_VERTEX_ARRAY_LENGTH&&(Oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const _e=re.sub(he)._perp()._unit(),Le=he.dist(re);G+Le>32768&&(G=0),Yh(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,0,G),Yh(this.layoutVertexArray,re.x,re.y,_e.x,_e.y,0,1,G),J.x+=2*re.x,J.y+=2*re.y,J.vertexCount+=2,G+=Le,Yh(this.layoutVertexArray,he.x,he.y,_e.x,_e.y,0,0,G),Yh(this.layoutVertexArray,he.x,he.y,_e.x,_e.y,0,1,G),J.x+=2*he.x,J.y+=2*he.y,J.vertexCount+=2;const qe=Oe.vertexLength;this.indexArray.emplaceBack(qe,qe+2,qe+1),this.indexArray.emplaceBack(qe+1,qe+2,qe+3),Oe.vertexLength+=4,Oe.primitiveLength+=2}}}}if(Oe.vertexLength+Ce>Zi.MAX_VERTEX_ARRAY_LENGTH&&(Oe=this.segments.prepareSegment(Ce,this.layoutVertexArray,this.indexArray)),Ih[h.type]!=="Polygon")continue;const f=[],u=[],p=Oe.vertexLength;for(const L of me)if(L.length!==0){L!==me[0]&&u.push(f.length/2);for(let G=0;G<L.length;G++){const Q=L[G];Yh(this.layoutVertexArray,Q.x,Q.y,0,0,1,1,0),J.x+=Q.x,J.y+=Q.y,J.vertexCount+=1,f.push(Q.x),f.push(Q.y)}}const S=A0(f,u);for(let L=0;L<S.length;L+=3)this.indexArray.emplaceBack(p+S[L],p+S[L+2],p+S[L+1]);Oe.primitiveLength+=S.length/3,Oe.vertexLength+=Ce}for(let me=0;me<J.vertexCount;me++)this.centroidVertexArray.emplaceBack(Math.floor(J.x/J.vertexCount),Math.floor(J.y/J.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}}function $h(m,h){return m.x===h.x&&(m.x<0||m.x>Ws)||m.y===h.y&&(m.y<0||m.y>Ws)}function Ir(m){return m.every(h=>h.x<0)||m.every(h=>h.x>Ws)||m.every(h=>h.y<0)||m.every(h=>h.y>Ws)}let bf;bn("FillExtrusionBucket",wA,{omit:["layers","features"]});var ed={get paint(){return bf=bf||new oa({"fill-extrusion-opacity":new pn(ti["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Gn(ti["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pn(ti["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pn(ti["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Jn(ti["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Gn(ti["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Gn(ti["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pn(ti["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Kh extends _s{constructor(h){super(h,ed)}createBucket(h){return new wA(h)}queryRadius(){return af(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(h,x,M,q,K,J,me,Ce){const Oe=Yc(h,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),J.angle,me),f=this.paint.get("fill-extrusion-height").evaluate(x,M),u=this.paint.get("fill-extrusion-base").evaluate(x,M),p=function(L,G,Q,re){const he=[];for(const _e of L){const Le=[_e.x,_e.y,0,1];lf(Le,Le,G),he.push(new oe(Le[0]/Le[3],Le[1]/Le[3]))}return he}(Oe,Ce),S=function(L,G,Q,re){const he=[],_e=[],Le=re[8]*G,qe=re[9]*G,Je=re[10]*G,At=re[11]*G,gt=re[8]*Q,Mt=re[9]*Q,Pt=re[10]*Q,zt=re[11]*Q;for(const $t of L){const Ht=[],Zt=[];for(const ui of $t){const _i=ui.x,Xi=ui.y,xn=re[0]*_i+re[4]*Xi+re[12],nn=re[1]*_i+re[5]*Xi+re[13],tn=re[2]*_i+re[6]*Xi+re[14],hn=re[3]*_i+re[7]*Xi+re[15],zn=tn+Je,en=hn+At,Wi=xn+gt,Dn=nn+Mt,Rn=tn+Pt,dr=hn+zt,Fr=new oe((xn+Le)/en,(nn+qe)/en);Fr.z=zn/en,Ht.push(Fr);const qr=new oe(Wi/dr,Dn/dr);qr.z=Rn/dr,Zt.push(qr)}he.push(Ht),_e.push(Zt)}return[he,_e]}(q,u,f,Ce);return function(L,G,Q){let re=1/0;Pa(Q,G)&&(re=SA(Q,G[0]));for(let he=0;he<G.length;he++){const _e=G[he],Le=L[he];for(let qe=0;qe<_e.length-1;qe++){const Je=_e[qe],At=[Je,_e[qe+1],Le[qe+1],Le[qe],Je];sf(Q,At)&&(re=Math.min(re,SA(Q,At)))}}return re!==1/0&&re}(S[0],S[1],p)}}function wf(m,h){return m.x*h.x+m.y*h.y}function SA(m,h){if(m.length===1){let x=0;const M=h[x++];let q;for(;!q||M.equals(q);)if(q=h[x++],!q)return 1/0;for(;x<h.length;x++){const K=h[x],J=m[0],me=q.sub(M),Ce=K.sub(M),Oe=J.sub(M),f=wf(me,me),u=wf(me,Ce),p=wf(Ce,Ce),S=wf(Oe,me),L=wf(Oe,Ce),G=f*p-u*u,Q=(p*S-u*L)/G,re=(f*L-u*S)/G,he=M.z*(1-Q-re)+q.z*Q+K.z*re;if(isFinite(he))return he}return 1/0}{let x=1/0;for(const M of h)x=Math.min(x,M.z);return x}}const IA=ys([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ul}=IA,km=ys([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Mm}=km,td=cc.VectorTileFeature.types,Pm=Math.cos(Math.PI/180*37.5),id=Math.pow(2,14)/.5;class Jh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(x=>x.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(x=>{this.gradients[x.id]={}}),this.layoutVertexArray=new Be,this.layoutVertexArray2=new $e,this.indexArray=new Xt,this.programConfigurations=new No(h.layers,h.zoom),this.segments=new Zi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id)}populate(h,x,M){this.hasPattern=yA("line",this.layers,x);const q=this.layers[0].layout.get("line-sort-key"),K=!q.isConstant(),J=[];for(const{feature:me,id:Ce,index:Oe,sourceLayerIndex:f}of h){const u=this.layers[0]._featureFilter.needGeometry,p=vl(me,u);if(!this.layers[0]._featureFilter.filter(new fs(this.zoom),p,M))continue;const S=K?q.evaluate(p,{},M):void 0,L={id:Ce,properties:me.properties,type:me.type,sourceLayerIndex:f,index:Oe,geometry:u?p.geometry:el(me),patterns:{},sortKey:S};J.push(L)}K&&J.sort((me,Ce)=>me.sortKey-Ce.sortKey);for(const me of J){const{geometry:Ce,index:Oe,sourceLayerIndex:f}=me;if(this.hasPattern){const u=vA("line",this.layers,me,this.zoom,x);this.patternFeatures.push(u)}else this.addFeature(me,Ce,Oe,M,{});x.featureIndex.insert(h[Oe].feature,Ce,Oe,f,this.index)}}update(h,x,M){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,x,this.stateDependentLayers,M)}addFeatures(h,x,M){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,x,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,Mm)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Ul),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,x,M,q,K){const J=this.layers[0].layout,me=J.get("line-join").evaluate(h,{}),Ce=J.get("line-cap"),Oe=J.get("line-miter-limit"),f=J.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const u of x)this.addLine(u,h,me,Ce,Oe,f);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,M,K,q)}addLine(h,x,M,q,K,J){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<h.length-1;re++)this.totalDistance+=h[re].dist(h[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const me=td[x.type]==="Polygon";let Ce=h.length;for(;Ce>=2&&h[Ce-1].equals(h[Ce-2]);)Ce--;let Oe=0;for(;Oe<Ce-1&&h[Oe].equals(h[Oe+1]);)Oe++;if(Ce<(me?3:2))return;M==="bevel"&&(K=1.05);const f=this.overscaling<=16?15*Ws/(512*this.overscaling):0,u=this.segments.prepareSegment(10*Ce,this.layoutVertexArray,this.indexArray);let p,S,L,G,Q;this.e1=this.e2=-1,me&&(p=h[Ce-2],Q=h[Oe].sub(p)._unit()._perp());for(let re=Oe;re<Ce;re++){if(L=re===Ce-1?me?h[Oe+1]:void 0:h[re+1],L&&h[re].equals(L))continue;Q&&(G=Q),p&&(S=p),p=h[re],Q=L?L.sub(p)._unit()._perp():G,G=G||Q;let he=G.add(Q);he.x===0&&he.y===0||he._unit();const _e=G.x*Q.x+G.y*Q.y,Le=he.x*Q.x+he.y*Q.y,qe=Le!==0?1/Le:1/0,Je=2*Math.sqrt(2-2*Le),At=Le<Pm&&S&&L,gt=G.x*Q.y-G.y*Q.x>0;if(At&&re>Oe){const zt=p.dist(S);if(zt>2*f){const $t=p.sub(p.sub(S)._mult(f/zt)._round());this.updateDistance(S,$t),this.addCurrentVertex($t,G,0,0,u),S=$t}}const Mt=S&&L;let Pt=Mt?M:me?"butt":q;if(Mt&&Pt==="round"&&(qe<J?Pt="miter":qe<=2&&(Pt="fakeround")),Pt==="miter"&&qe>K&&(Pt="bevel"),Pt==="bevel"&&(qe>2&&(Pt="flipbevel"),qe<K&&(Pt="miter")),S&&this.updateDistance(S,p),Pt==="miter")he._mult(qe),this.addCurrentVertex(p,he,0,0,u);else if(Pt==="flipbevel"){if(qe>100)he=Q.mult(-1);else{const zt=qe*G.add(Q).mag()/G.sub(Q).mag();he._perp()._mult(zt*(gt?-1:1))}this.addCurrentVertex(p,he,0,0,u),this.addCurrentVertex(p,he.mult(-1),0,0,u)}else if(Pt==="bevel"||Pt==="fakeround"){const zt=-Math.sqrt(qe*qe-1),$t=gt?zt:0,Ht=gt?0:zt;if(S&&this.addCurrentVertex(p,G,$t,Ht,u),Pt==="fakeround"){const Zt=Math.round(180*Je/Math.PI/20);for(let ui=1;ui<Zt;ui++){let _i=ui/Zt;if(_i!==.5){const xn=_i-.5;_i+=_i*xn*(_i-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*xn*xn+(.848013+_e*(.215638*_e-1.06021)))}const Xi=Q.sub(G)._mult(_i)._add(G)._unit()._mult(gt?-1:1);this.addHalfVertex(p,Xi.x,Xi.y,!1,gt,0,u)}}L&&this.addCurrentVertex(p,Q,-$t,-Ht,u)}else if(Pt==="butt")this.addCurrentVertex(p,he,0,0,u);else if(Pt==="square"){const zt=S?1:-1;this.addCurrentVertex(p,he,zt,zt,u)}else Pt==="round"&&(S&&(this.addCurrentVertex(p,G,0,0,u),this.addCurrentVertex(p,G,1,1,u,!0)),L&&(this.addCurrentVertex(p,Q,-1,-1,u,!0),this.addCurrentVertex(p,Q,0,0,u)));if(At&&re<Ce-1){const zt=p.dist(L);if(zt>2*f){const $t=p.add(L.sub(p)._mult(f/zt)._round());this.updateDistance(p,$t),this.addCurrentVertex($t,Q,0,0,u),p=$t}}}}addCurrentVertex(h,x,M,q,K,J=!1){const me=x.y*q-x.x,Ce=-x.y-x.x*q;this.addHalfVertex(h,x.x+x.y*M,x.y-x.x*M,J,!1,M,K),this.addHalfVertex(h,me,Ce,J,!0,-q,K),this.distance>id/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(h,x,M,q,K,J))}addHalfVertex({x:h,y:x},M,q,K,J,me,Ce){const Oe=.5*(this.lineClips?this.scaledDistance*(id-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h<<1)+(K?1:0),(x<<1)+(J?1:0),Math.round(63*M)+128,Math.round(63*q)+128,1+(me===0?0:me<0?-1:1)|(63&Oe)<<2,Oe>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const f=Ce.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,f),Ce.primitiveLength++),J?this.e2=f:this.e1=f}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(h,x){this.distance+=h.dist(x),this.updateScaledDistance()}}let nd,Ip;bn("LineBucket",Jh,{omit:["layers","patternFeatures"]});var kc={get paint(){return Ip=Ip||new oa({"line-opacity":new Gn(ti.paint_line["line-opacity"]),"line-color":new Gn(ti.paint_line["line-color"]),"line-translate":new pn(ti.paint_line["line-translate"]),"line-translate-anchor":new pn(ti.paint_line["line-translate-anchor"]),"line-width":new Gn(ti.paint_line["line-width"]),"line-gap-width":new Gn(ti.paint_line["line-gap-width"]),"line-offset":new Gn(ti.paint_line["line-offset"]),"line-blur":new Gn(ti.paint_line["line-blur"]),"line-dasharray":new Jo(ti.paint_line["line-dasharray"]),"line-pattern":new Jn(ti.paint_line["line-pattern"]),"line-gradient":new Cu(ti.paint_line["line-gradient"])})},get layout(){return nd=nd||new oa({"line-cap":new pn(ti.layout_line["line-cap"]),"line-join":new Gn(ti.layout_line["line-join"]),"line-miter-limit":new pn(ti.layout_line["line-miter-limit"]),"line-round-limit":new pn(ti.layout_line["line-round-limit"]),"line-sort-key":new Gn(ti.layout_line["line-sort-key"])})}};class xu extends Gn{possiblyEvaluate(h,x){return x=new fs(Math.floor(x.zoom),{now:x.now,fadeDuration:x.fadeDuration,zoomHistory:x.zoomHistory,transition:x.transition}),super.possiblyEvaluate(h,x)}evaluate(h,x,M,q){return x=ni({},x,{zoom:Math.floor(x.zoom)}),super.evaluate(h,x,M,q)}}let EA;class Dm extends _s{constructor(h){super(h,kc),this.gradientVersion=0,EA||(EA=new xu(kc.paint.properties["line-width"].specification),EA.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const x=this.gradientExpression();this.stepInterpolant=!!function(M){return M._styleExpression!==void 0}(x)&&x._styleExpression.expression instanceof qa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,x){super.recalculate(h,x),this.paint._values["line-floorwidth"]=EA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new Jh(h)}queryRadius(h){const x=h,M=d0(Gh("line-width",this,x),Gh("line-gap-width",this,x)),q=Gh("line-offset",this,x);return M/2+Math.abs(q)+af(this.paint.get("line-translate"))}queryIntersectsFeature(h,x,M,q,K,J,me){const Ce=Yc(h,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),J.angle,me),Oe=me/2*d0(this.paint.get("line-width").evaluate(x,M),this.paint.get("line-gap-width").evaluate(x,M)),f=this.paint.get("line-offset").evaluate(x,M);return f&&(q=function(u,p){const S=[];for(let L=0;L<u.length;L++){const G=u[L],Q=[];for(let re=0;re<G.length;re++){const he=G[re-1],_e=G[re],Le=G[re+1],qe=re===0?new oe(0,0):_e.sub(he)._unit()._perp(),Je=re===G.length-1?new oe(0,0):Le.sub(_e)._unit()._perp(),At=qe._add(Je)._unit(),gt=At.x*Je.x+At.y*Je.y;gt!==0&&At._mult(1/gt),Q.push(At._mult(p)._add(_e))}S.push(Q)}return S}(q,f*me)),function(u,p,S){for(let L=0;L<p.length;L++){const G=p[L];if(u.length>=3){for(let Q=0;Q<G.length;Q++)if(Xc(u,G[Q]))return!0}if(dA(u,G,S))return!0}return!1}(Ce,q,Oe)}isTileClipped(){return!0}}function d0(m,h){return h>0?h+2*m:m}const Ep=ys([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rd=ys([{name:"a_projected_pos",components:3,type:"Float32"}],4);ys([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const CA=ys([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ys([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const p0=ys([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sd=ys([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Lm(m,h,x){return m.sections.forEach(M=>{M.text=function(q,K,J){const me=K.layout.get("text-transform").evaluate(J,{});return me==="uppercase"?q=q.toLocaleUpperCase():me==="lowercase"&&(q=q.toLocaleLowerCase()),jl.applyArabicShaping&&(q=jl.applyArabicShaping(q)),q}(M.text,h,x)}),m}ys([{name:"triangle",components:3,type:"Uint16"}]),ys([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ys([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ys([{type:"Float32",name:"offsetX"}]),ys([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ys([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Eh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var cl=24,ad=fa,od=function(m,h,x,M,q){var K,J,me=8*q-M-1,Ce=(1<<me)-1,Oe=Ce>>1,f=-7,u=x?q-1:0,p=x?-1:1,S=m[h+u];for(u+=p,K=S&(1<<-f)-1,S>>=-f,f+=me;f>0;K=256*K+m[h+u],u+=p,f-=8);for(J=K&(1<<-f)-1,K>>=-f,f+=M;f>0;J=256*J+m[h+u],u+=p,f-=8);if(K===0)K=1-Oe;else{if(K===Ce)return J?NaN:1/0*(S?-1:1);J+=Math.pow(2,M),K-=Oe}return(S?-1:1)*J*Math.pow(2,K-M)},ld=function(m,h,x,M,q,K){var J,me,Ce,Oe=8*K-q-1,f=(1<<Oe)-1,u=f>>1,p=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=M?0:K-1,L=M?1:-1,G=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(me=isNaN(h)?1:0,J=f):(J=Math.floor(Math.log(h)/Math.LN2),h*(Ce=Math.pow(2,-J))<1&&(J--,Ce*=2),(h+=J+u>=1?p/Ce:p*Math.pow(2,1-u))*Ce>=2&&(J++,Ce/=2),J+u>=f?(me=0,J=f):J+u>=1?(me=(h*Ce-1)*Math.pow(2,q),J+=u):(me=h*Math.pow(2,u-1)*Math.pow(2,q),J=0));q>=8;m[x+S]=255&me,S+=L,me/=256,q-=8);for(J=J<<q|me,Oe+=q;Oe>0;m[x+S]=255&J,S+=L,J/=256,Oe-=8);m[x+S-L]|=128*G};function fa(m){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(m)?m:new Uint8Array(m||0),this.pos=0,this.type=0,this.length=this.buf.length}fa.Varint=0,fa.Fixed64=1,fa.Bytes=2,fa.Fixed32=5;var TA=4294967296,ud=1/TA,kA=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function bu(m){return m.type===fa.Bytes?m.readVarint()+m.pos:m.pos+1}function Ya(m,h,x){return x?4294967296*h+(m>>>0):4294967296*(h>>>0)+(m>>>0)}function m0(m,h,x){var M=h<=16383?1:h<=2097151?2:h<=268435455?3:Math.floor(Math.log(h)/(7*Math.LN2));x.realloc(M);for(var q=x.pos-1;q>=m;q--)x.buf[q+M]=x.buf[q]}function Sf(m,h){for(var x=0;x<m.length;x++)h.writeVarint(m[x])}function cd(m,h){for(var x=0;x<m.length;x++)h.writeSVarint(m[x])}function ms(m,h){for(var x=0;x<m.length;x++)h.writeFloat(m[x])}function th(m,h){for(var x=0;x<m.length;x++)h.writeDouble(m[x])}function Cp(m,h){for(var x=0;x<m.length;x++)h.writeBoolean(m[x])}function hd(m,h){for(var x=0;x<m.length;x++)h.writeFixed32(m[x])}function ih(m,h){for(var x=0;x<m.length;x++)h.writeSFixed32(m[x])}function MA(m,h){for(var x=0;x<m.length;x++)h.writeFixed64(m[x])}function Tp(m,h){for(var x=0;x<m.length;x++)h.writeSFixed64(m[x])}function g0(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+16777216*m[h+3]}function PA(m,h,x){m[x]=h,m[x+1]=h>>>8,m[x+2]=h>>>16,m[x+3]=h>>>24}function kp(m,h){return(m[h]|m[h+1]<<8|m[h+2]<<16)+(m[h+3]<<24)}fa.prototype={destroy:function(){this.buf=null},readFields:function(m,h,x){for(x=x||this.length;this.pos<x;){var M=this.readVarint(),q=M>>3,K=this.pos;this.type=7&M,m(q,h,this),this.pos===K&&this.skip(M)}return h},readMessage:function(m,h){return this.readFields(m,h,this.readVarint()+this.pos)},readFixed32:function(){var m=g0(this.buf,this.pos);return this.pos+=4,m},readSFixed32:function(){var m=kp(this.buf,this.pos);return this.pos+=4,m},readFixed64:function(){var m=g0(this.buf,this.pos)+g0(this.buf,this.pos+4)*TA;return this.pos+=8,m},readSFixed64:function(){var m=g0(this.buf,this.pos)+kp(this.buf,this.pos+4)*TA;return this.pos+=8,m},readFloat:function(){var m=od(this.buf,this.pos,!0,23,4);return this.pos+=4,m},readDouble:function(){var m=od(this.buf,this.pos,!0,52,8);return this.pos+=8,m},readVarint:function(m){var h,x,M=this.buf;return h=127&(x=M[this.pos++]),x<128?h:(h|=(127&(x=M[this.pos++]))<<7,x<128?h:(h|=(127&(x=M[this.pos++]))<<14,x<128?h:(h|=(127&(x=M[this.pos++]))<<21,x<128?h:function(q,K,J){var me,Ce,Oe=J.buf;if(me=(112&(Ce=Oe[J.pos++]))>>4,Ce<128||(me|=(127&(Ce=Oe[J.pos++]))<<3,Ce<128)||(me|=(127&(Ce=Oe[J.pos++]))<<10,Ce<128)||(me|=(127&(Ce=Oe[J.pos++]))<<17,Ce<128)||(me|=(127&(Ce=Oe[J.pos++]))<<24,Ce<128)||(me|=(1&(Ce=Oe[J.pos++]))<<31,Ce<128))return Ya(q,me,K);throw new Error("Expected varint not more than 10 bytes")}(h|=(15&(x=M[this.pos]))<<28,m,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var m=this.readVarint();return m%2==1?(m+1)/-2:m/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var m=this.readVarint()+this.pos,h=this.pos;return this.pos=m,m-h>=12&&kA?function(x,M,q){return kA.decode(x.subarray(M,q))}(this.buf,h,m):function(x,M,q){for(var K="",J=M;J<q;){var me,Ce,Oe,f=x[J],u=null,p=f>239?4:f>223?3:f>191?2:1;if(J+p>q)break;p===1?f<128&&(u=f):p===2?(192&(me=x[J+1]))==128&&(u=(31&f)<<6|63&me)<=127&&(u=null):p===3?(Ce=x[J+2],(192&(me=x[J+1]))==128&&(192&Ce)==128&&((u=(15&f)<<12|(63&me)<<6|63&Ce)<=2047||u>=55296&&u<=57343)&&(u=null)):p===4&&(Ce=x[J+2],Oe=x[J+3],(192&(me=x[J+1]))==128&&(192&Ce)==128&&(192&Oe)==128&&((u=(15&f)<<18|(63&me)<<12|(63&Ce)<<6|63&Oe)<=65535||u>=1114112)&&(u=null)),u===null?(u=65533,p=1):u>65535&&(u-=65536,K+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),K+=String.fromCharCode(u),J+=p}return K}(this.buf,h,m)},readBytes:function(){var m=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,m);return this.pos=m,h},readPackedVarint:function(m,h){if(this.type!==fa.Bytes)return m.push(this.readVarint(h));var x=bu(this);for(m=m||[];this.pos<x;)m.push(this.readVarint(h));return m},readPackedSVarint:function(m){if(this.type!==fa.Bytes)return m.push(this.readSVarint());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readSVarint());return m},readPackedBoolean:function(m){if(this.type!==fa.Bytes)return m.push(this.readBoolean());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readBoolean());return m},readPackedFloat:function(m){if(this.type!==fa.Bytes)return m.push(this.readFloat());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readFloat());return m},readPackedDouble:function(m){if(this.type!==fa.Bytes)return m.push(this.readDouble());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readDouble());return m},readPackedFixed32:function(m){if(this.type!==fa.Bytes)return m.push(this.readFixed32());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed32());return m},readPackedSFixed32:function(m){if(this.type!==fa.Bytes)return m.push(this.readSFixed32());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed32());return m},readPackedFixed64:function(m){if(this.type!==fa.Bytes)return m.push(this.readFixed64());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readFixed64());return m},readPackedSFixed64:function(m){if(this.type!==fa.Bytes)return m.push(this.readSFixed64());var h=bu(this);for(m=m||[];this.pos<h;)m.push(this.readSFixed64());return m},skip:function(m){var h=7&m;if(h===fa.Varint)for(;this.buf[this.pos++]>127;);else if(h===fa.Bytes)this.pos=this.readVarint()+this.pos;else if(h===fa.Fixed32)this.pos+=4;else{if(h!==fa.Fixed64)throw new Error("Unimplemented type: "+h);this.pos+=8}},writeTag:function(m,h){this.writeVarint(m<<3|h)},realloc:function(m){for(var h=this.length||16;h<this.pos+m;)h*=2;if(h!==this.length){var x=new Uint8Array(h);x.set(this.buf),this.buf=x,this.length=h}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(m){this.realloc(4),PA(this.buf,m,this.pos),this.pos+=4},writeSFixed32:function(m){this.realloc(4),PA(this.buf,m,this.pos),this.pos+=4},writeFixed64:function(m){this.realloc(8),PA(this.buf,-1&m,this.pos),PA(this.buf,Math.floor(m*ud),this.pos+4),this.pos+=8},writeSFixed64:function(m){this.realloc(8),PA(this.buf,-1&m,this.pos),PA(this.buf,Math.floor(m*ud),this.pos+4),this.pos+=8},writeVarint:function(m){(m=+m||0)>268435455||m<0?function(h,x){var M,q;if(h>=0?(M=h%4294967296|0,q=h/4294967296|0):(q=~(-h/4294967296),4294967295^(M=~(-h%4294967296))?M=M+1|0:(M=0,q=q+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");x.realloc(10),function(K,J,me){me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,K>>>=7,me.buf[me.pos++]=127&K|128,me.buf[me.pos]=127&(K>>>=7)}(M,0,x),function(K,J){var me=(7&K)<<4;J.buf[J.pos++]|=me|((K>>>=3)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K|((K>>>=7)?128:0),K&&(J.buf[J.pos++]=127&K)))))}(q,x)}(m,this):(this.realloc(4),this.buf[this.pos++]=127&m|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(m>127?128:0),m<=127||(this.buf[this.pos++]=m>>>7&127))))},writeSVarint:function(m){this.writeVarint(m<0?2*-m-1:2*m)},writeBoolean:function(m){this.writeVarint(!!m)},writeString:function(m){m=String(m),this.realloc(4*m.length),this.pos++;var h=this.pos;this.pos=function(M,q,K){for(var J,me,Ce=0;Ce<q.length;Ce++){if((J=q.charCodeAt(Ce))>55295&&J<57344){if(!me){J>56319||Ce+1===q.length?(M[K++]=239,M[K++]=191,M[K++]=189):me=J;continue}if(J<56320){M[K++]=239,M[K++]=191,M[K++]=189,me=J;continue}J=me-55296<<10|J-56320|65536,me=null}else me&&(M[K++]=239,M[K++]=191,M[K++]=189,me=null);J<128?M[K++]=J:(J<2048?M[K++]=J>>6|192:(J<65536?M[K++]=J>>12|224:(M[K++]=J>>18|240,M[K++]=J>>12&63|128),M[K++]=J>>6&63|128),M[K++]=63&J|128)}return K}(this.buf,m,this.pos);var x=this.pos-h;x>=128&&m0(h,x,this),this.pos=h-1,this.writeVarint(x),this.pos+=x},writeFloat:function(m){this.realloc(4),ld(this.buf,m,this.pos,!0,23,4),this.pos+=4},writeDouble:function(m){this.realloc(8),ld(this.buf,m,this.pos,!0,52,8),this.pos+=8},writeBytes:function(m){var h=m.length;this.writeVarint(h),this.realloc(h);for(var x=0;x<h;x++)this.buf[this.pos++]=m[x]},writeRawMessage:function(m,h){this.pos++;var x=this.pos;m(h,this);var M=this.pos-x;M>=128&&m0(x,M,this),this.pos=x-1,this.writeVarint(M),this.pos+=M},writeMessage:function(m,h,x){this.writeTag(m,fa.Bytes),this.writeRawMessage(h,x)},writePackedVarint:function(m,h){h.length&&this.writeMessage(m,Sf,h)},writePackedSVarint:function(m,h){h.length&&this.writeMessage(m,cd,h)},writePackedBoolean:function(m,h){h.length&&this.writeMessage(m,Cp,h)},writePackedFloat:function(m,h){h.length&&this.writeMessage(m,ms,h)},writePackedDouble:function(m,h){h.length&&this.writeMessage(m,th,h)},writePackedFixed32:function(m,h){h.length&&this.writeMessage(m,hd,h)},writePackedSFixed32:function(m,h){h.length&&this.writeMessage(m,ih,h)},writePackedFixed64:function(m,h){h.length&&this.writeMessage(m,MA,h)},writePackedSFixed64:function(m,h){h.length&&this.writeMessage(m,Tp,h)},writeBytesField:function(m,h){this.writeTag(m,fa.Bytes),this.writeBytes(h)},writeFixed32Field:function(m,h){this.writeTag(m,fa.Fixed32),this.writeFixed32(h)},writeSFixed32Field:function(m,h){this.writeTag(m,fa.Fixed32),this.writeSFixed32(h)},writeFixed64Field:function(m,h){this.writeTag(m,fa.Fixed64),this.writeFixed64(h)},writeSFixed64Field:function(m,h){this.writeTag(m,fa.Fixed64),this.writeSFixed64(h)},writeVarintField:function(m,h){this.writeTag(m,fa.Varint),this.writeVarint(h)},writeSVarintField:function(m,h){this.writeTag(m,fa.Varint),this.writeSVarint(h)},writeStringField:function(m,h){this.writeTag(m,fa.Bytes),this.writeString(h)},writeFloatField:function(m,h){this.writeTag(m,fa.Fixed32),this.writeFloat(h)},writeDoubleField:function(m,h){this.writeTag(m,fa.Fixed64),this.writeDouble(h)},writeBooleanField:function(m,h){this.writeVarintField(m,!!h)}};var Ad=U(ad);const fd=3;function Bm(m,h,x){m===1&&x.readMessage(zm,h)}function zm(m,h,x){if(m===3){const{id:M,bitmap:q,width:K,height:J,left:me,top:Ce,advance:Oe}=x.readMessage(Rm,{});h.push({id:M,bitmap:new Dl({width:K+2*fd,height:J+2*fd},q),metrics:{width:K,height:J,left:me,top:Ce,advance:Oe}})}}function Rm(m,h,x){m===1?h.id=x.readVarint():m===2?h.bitmap=x.readBytes():m===3?h.width=x.readVarint():m===4?h.height=x.readVarint():m===5?h.left=x.readSVarint():m===6?h.top=x.readSVarint():m===7&&(h.advance=x.readVarint())}const dd=fd;function DA(m){let h=0,x=0;for(const J of m)h+=J.w*J.h,x=Math.max(x,J.w);m.sort((J,me)=>me.h-J.h);const M=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),x),h:1/0}];let q=0,K=0;for(const J of m)for(let me=M.length-1;me>=0;me--){const Ce=M[me];if(!(J.w>Ce.w||J.h>Ce.h)){if(J.x=Ce.x,J.y=Ce.y,K=Math.max(K,J.y+J.h),q=Math.max(q,J.x+J.w),J.w===Ce.w&&J.h===Ce.h){const Oe=M.pop();me<M.length&&(M[me]=Oe)}else J.h===Ce.h?(Ce.x+=J.w,Ce.w-=J.w):J.w===Ce.w?(Ce.y+=J.h,Ce.h-=J.h):(M.push({x:Ce.x+J.w,y:Ce.y,w:Ce.w-J.w,h:J.h}),Ce.y+=J.h,Ce.h-=J.h);break}}return{w:q,h:K,fill:h/(q*K)||0}}const hl=1;class _0{constructor(h,{pixelRatio:x,version:M,stretchX:q,stretchY:K,content:J}){this.paddedRect=h,this.pixelRatio=x,this.stretchX=q,this.stretchY=K,this.content=J,this.version=M}get tl(){return[this.paddedRect.x+hl,this.paddedRect.y+hl]}get br(){return[this.paddedRect.x+this.paddedRect.w-hl,this.paddedRect.y+this.paddedRect.h-hl]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*hl)/this.pixelRatio,(this.paddedRect.h-2*hl)/this.pixelRatio]}}class y0{constructor(h,x){const M={},q={};this.haveRenderCallbacks=[];const K=[];this.addImages(h,M,K),this.addImages(x,q,K);const{w:J,h:me}=DA(K),Ce=new Nu({width:J||1,height:me||1});for(const Oe in h){const f=h[Oe],u=M[Oe].paddedRect;Nu.copy(f.data,Ce,{x:0,y:0},{x:u.x+hl,y:u.y+hl},f.data)}for(const Oe in x){const f=x[Oe],u=q[Oe].paddedRect,p=u.x+hl,S=u.y+hl,L=f.data.width,G=f.data.height;Nu.copy(f.data,Ce,{x:0,y:0},{x:p,y:S},f.data),Nu.copy(f.data,Ce,{x:0,y:G-1},{x:p,y:S-1},{width:L,height:1}),Nu.copy(f.data,Ce,{x:0,y:0},{x:p,y:S+G},{width:L,height:1}),Nu.copy(f.data,Ce,{x:L-1,y:0},{x:p-1,y:S},{width:1,height:G}),Nu.copy(f.data,Ce,{x:0,y:0},{x:p+L,y:S},{width:1,height:G})}this.image=Ce,this.iconPositions=M,this.patternPositions=q}addImages(h,x,M){for(const q in h){const K=h[q],J={x:0,y:0,w:K.data.width+2*hl,h:K.data.height+2*hl};M.push(J),x[q]=new _0(J,K),K.hasRenderCallback&&this.haveRenderCallbacks.push(q)}}patchUpdatedImages(h,x){h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const M in h.updatedImages)this.patchUpdatedImage(this.iconPositions[M],h.getImage(M),x),this.patchUpdatedImage(this.patternPositions[M],h.getImage(M),x)}patchUpdatedImage(h,x,M){if(!h||!x||h.version===x.version)return;h.version=x.version;const[q,K]=h.tl;M.update(x.data,void 0,{x:q,y:K})}}var Mc;bn("ImagePosition",_0),bn("ImageAtlas",y0),E.ah=void 0,(Mc=E.ah||(E.ah={}))[Mc.none=0]="none",Mc[Mc.horizontal=1]="horizontal",Mc[Mc.vertical=2]="vertical",Mc[Mc.horizontalOnly=3]="horizontalOnly";const LA=-17;class If{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(h,x){const M=new If;return M.scale=h||1,M.fontStack=x,M}static forImage(h){const x=new If;return x.imageName=h,x}}class BA{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,x){const M=new BA;for(let q=0;q<h.sections.length;q++){const K=h.sections[q];K.image?M.addImageSection(K):M.addTextSection(K,x)}return M}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(){this.text=function(h){let x="";for(let M=0;M<h.length;M++){const q=h.charCodeAt(M+1)||null,K=h.charCodeAt(M-1)||null;x+=q&&yl(q)&&!Eh[h[M+1]]||K&&yl(K)&&!Eh[h[M-1]]||!Eh[h[M]]?h[M]:Eh[h[M]]}return x}(this.text)}trim(){let h=0;for(let M=0;M<this.text.length&&Cf[this.text.charCodeAt(M)];M++)h++;let x=this.text.length;for(let M=this.text.length-1;M>=0&&M>=h&&Cf[this.text.charCodeAt(M)];M--)x--;this.text=this.text.substring(h,x),this.sectionIndex=this.sectionIndex.slice(h,x)}substring(h,x){const M=new BA;return M.text=this.text.substring(h,x),M.sectionIndex=this.sectionIndex.slice(h,x),M.sections=this.sections,M}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((h,x)=>Math.max(h,this.sections[x].scale),0)}addTextSection(h,x){this.text+=h.text,this.sections.push(If.forText(h.scale,h.fontStack||x));const M=this.sections.length-1;for(let q=0;q<h.text.length;++q)this.sectionIndex.push(M)}addImageSection(h){const x=h.image?h.image.name:"";if(x.length===0)return void dt("Can't add FormattedSection with an empty image.");const M=this.getNextImageSectionCharCode();M?(this.text+=String.fromCharCode(M),this.sections.push(If.forImage(x)),this.sectionIndex.push(this.sections.length-1)):dt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ef(m,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L,G){const Q=BA.fromFeature(m,q);let re;u===E.ah.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:he,processStyledBidirectionalText:_e}=jl;if(he&&Q.sections.length===1){re=[];const Je=he(Q.toString(),nh(Q,Oe,K,h,M,S,L));for(const At of Je){const gt=new BA;gt.text=At,gt.sections=Q.sections;for(let Mt=0;Mt<At.length;Mt++)gt.sectionIndex.push(0);re.push(gt)}}else if(_e){re=[];const Je=_e(Q.text,Q.sectionIndex,nh(Q,Oe,K,h,M,S,L));for(const At of Je){const gt=new BA;gt.text=At[0],gt.sectionIndex=At[1],gt.sections=Q.sections,re.push(gt)}}else re=function(Je,At){const gt=[],Mt=Je.text;let Pt=0;for(const zt of At)gt.push(Je.substring(Pt,zt)),Pt=zt;return Pt<Mt.length&&gt.push(Je.substring(Pt,Mt.length)),gt}(Q,nh(Q,Oe,K,h,M,S,L));const Le=[],qe={positionedLines:Le,text:Q.toString(),top:f[1],bottom:f[1],left:f[0],right:f[0],writingMode:u,iconsInText:!1,verticalizable:!1};return function(Je,At,gt,Mt,Pt,zt,$t,Ht,Zt,ui,_i,Xi){let xn=0,nn=LA,tn=0,hn=0;const zn=Ht==="right"?1:Ht==="left"?0:.5;let en=0;for(const Fr of Pt){Fr.trim();const qr=Fr.getMaxScale(),zs=(qr-1)*cl,Ea={positionedGlyphs:[],lineOffset:0};Je.positionedLines[en]=Ea;const ia=Ea.positionedGlyphs;let is=0;if(!Fr.length()){nn+=zt,++en;continue}for(let xs=0;xs<Fr.length();xs++){const tr=Fr.getSection(xs),na=Fr.getSectionIndex(xs),Ds=Fr.getCharCode(xs);let Kn=0,La=null,$a=null,va=null,Uo=cl;const so=!(Zt===E.ah.horizontal||!_i&&!Vl(Ds)||_i&&(Cf[Ds]||(Wi=Ds,In.Arabic(Wi)||In["Arabic Supplement"](Wi)||In["Arabic Extended-A"](Wi)||In["Arabic Presentation Forms-A"](Wi)||In["Arabic Presentation Forms-B"](Wi))));if(tr.imageName){const ra=Mt[tr.imageName];if(!ra)continue;va=tr.imageName,Je.iconsInText=Je.iconsInText||!0,$a=ra.paddedRect;const br=ra.displaySize;tr.scale=tr.scale*cl/Xi,La={width:br[0],height:br[1],left:hl,top:-dd,advance:so?br[1]:br[0]},Kn=zs+(cl-br[1]*tr.scale),Uo=La.advance;const yo=so?br[0]*tr.scale-cl*qr:br[1]*tr.scale-cl*qr;yo>0&&yo>is&&(is=yo)}else{const ra=gt[tr.fontStack],br=ra&&ra[Ds];if(br&&br.rect)$a=br.rect,La=br.metrics;else{const yo=At[tr.fontStack],tl=yo&&yo[Ds];if(!tl)continue;La=tl.metrics}Kn=(qr-tr.scale)*cl}so?(Je.verticalizable=!0,ia.push({glyph:Ds,imageName:va,x:xn,y:nn+Kn,vertical:so,scale:tr.scale,fontStack:tr.fontStack,sectionIndex:na,metrics:La,rect:$a}),xn+=Uo*tr.scale+ui):(ia.push({glyph:Ds,imageName:va,x:xn,y:nn+Kn,vertical:so,scale:tr.scale,fontStack:tr.fontStack,sectionIndex:na,metrics:La,rect:$a}),xn+=La.advance*tr.scale+ui)}ia.length!==0&&(tn=Math.max(xn-ui,tn),x0(ia,0,ia.length-1,zn,is)),xn=0;const Wn=zt*qr+is;Ea.lineOffset=Math.max(is,zs),nn+=Wn,hn=Math.max(Wn,hn),++en}var Wi;const Dn=nn-LA,{horizontalAlign:Rn,verticalAlign:dr}=FA($t);(function(Fr,qr,zs,Ea,ia,is,Wn,xs,tr){const na=(qr-zs)*ia;let Ds=0;Ds=is!==Wn?-xs*Ea-LA:(-Ea*tr+.5)*Wn;for(const Kn of Fr)for(const La of Kn.positionedGlyphs)La.x+=na,La.y+=Ds})(Je.positionedLines,zn,Rn,dr,tn,hn,zt,Dn,Pt.length),Je.top+=-dr*Dn,Je.bottom=Je.top+Dn,Je.left+=-Rn*tn,Je.right=Je.left+tn}(qe,h,x,M,re,J,me,Ce,u,Oe,p,G),!function(Je){for(const At of Je)if(At.positionedGlyphs.length!==0)return!1;return!0}(Le)&&qe}const Cf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wu={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function v0(m,h,x,M,q,K){if(h.imageName){const J=M[h.imageName];return J?J.displaySize[0]*h.scale*cl/K+q:0}{const J=x[h.fontStack],me=J&&J[m];return me?me.metrics.advance*h.scale+q:0}}function Tu(m,h,x,M){const q=Math.pow(m-h,2);return M?m<h?q/2:2*q:q+Math.abs(x)*x}function Ch(m,h,x){let M=0;return m===10&&(M-=1e4),x&&(M+=150),m!==40&&m!==65288||(M+=50),h!==41&&h!==65289||(M+=50),M}function zA(m,h,x,M,q,K){let J=null,me=Tu(h,x,q,K);for(const Ce of M){const Oe=Tu(h-Ce.x,x,q,K)+Ce.badness;Oe<=me&&(J=Ce,me=Oe)}return{index:m,x:h,priorBreak:J,badness:me}}function RA(m){return m?RA(m.priorBreak).concat(m.index):[]}function nh(m,h,x,M,q,K,J){if(K!=="point")return[];if(!m)return[];const me=[],Ce=function(p,S,L,G,Q,re){let he=0;for(let _e=0;_e<p.length();_e++){const Le=p.getSection(_e);he+=v0(p.getCharCode(_e),Le,G,Q,S,re)}return he/Math.max(1,Math.ceil(he/L))}(m,h,x,M,q,J),Oe=m.text.indexOf("")>=0;let f=0;for(let p=0;p<m.length();p++){const S=m.getSection(p),L=m.getCharCode(p);if(Cf[L]||(f+=v0(L,S,M,q,h,J)),p<m.length()-1){const G=!((u=L)<11904||!(In["Bopomofo Extended"](u)||In.Bopomofo(u)||In["CJK Compatibility Forms"](u)||In["CJK Compatibility Ideographs"](u)||In["CJK Compatibility"](u)||In["CJK Radicals Supplement"](u)||In["CJK Strokes"](u)||In["CJK Symbols and Punctuation"](u)||In["CJK Unified Ideographs Extension A"](u)||In["CJK Unified Ideographs"](u)||In["Enclosed CJK Letters and Months"](u)||In["Halfwidth and Fullwidth Forms"](u)||In.Hiragana(u)||In["Ideographic Description Characters"](u)||In["Kangxi Radicals"](u)||In["Katakana Phonetic Extensions"](u)||In.Katakana(u)||In["Vertical Forms"](u)||In["Yi Radicals"](u)||In["Yi Syllables"](u)));(wu[L]||G||S.imageName)&&me.push(zA(p+1,f,Ce,me,Ch(L,m.getCharCode(p+1),G&&Oe),!1))}}var u;return RA(zA(m.length(),f,Ce,me,0,!0))}function FA(m){let h=.5,x=.5;switch(m){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(m){case"bottom":case"bottom-right":case"bottom-left":x=1;break;case"top":case"top-right":case"top-left":x=0}return{horizontalAlign:h,verticalAlign:x}}function x0(m,h,x,M,q){if(!M&&!q)return;const K=m[x],J=(m[x].x+K.metrics.advance*K.scale)*M;for(let me=h;me<=x;me++)m[me].x-=J,m[me].y+=q}function Fm(m,h,x){const{horizontalAlign:M,verticalAlign:q}=FA(x),K=h[0]-m.displaySize[0]*M,J=h[1]-m.displaySize[1]*q;return{image:m,top:J,bottom:J+m.displaySize[1],left:K,right:K+m.displaySize[0]}}function pd(m,h,x,M,q,K){const J=m.image;let me;if(J.content){const Q=J.content,re=J.pixelRatio||1;me=[Q[0]/re,Q[1]/re,J.displaySize[0]-Q[2]/re,J.displaySize[1]-Q[3]/re]}const Ce=h.left*K,Oe=h.right*K;let f,u,p,S;x==="width"||x==="both"?(S=q[0]+Ce-M[3],u=q[0]+Oe+M[1]):(S=q[0]+(Ce+Oe-J.displaySize[0])/2,u=S+J.displaySize[0]);const L=h.top*K,G=h.bottom*K;return x==="height"||x==="both"?(f=q[1]+L-M[0],p=q[1]+G+M[2]):(f=q[1]+(L+G-J.displaySize[1])/2,p=f+J.displaySize[1]),{image:J,top:f,right:u,bottom:p,left:S,collisionPadding:me}}const Th=255,Pc=128,rh=Th*Pc;function md(m,h){const{expression:x}=h;if(x.kind==="constant")return{kind:"constant",layoutSize:x.evaluate(new fs(m+1))};if(x.kind==="source")return{kind:"source"};{const{zoomStops:M,interpolationType:q}=x;let K=0;for(;K<M.length&&M[K]<=m;)K++;K=Math.max(0,K-1);let J=K;for(;J<M.length&&M[J]<m+1;)J++;J=Math.min(M.length-1,J);const me=M[K],Ce=M[J];return x.kind==="composite"?{kind:"composite",minZoom:me,maxZoom:Ce,interpolationType:q}:{kind:"camera",minZoom:me,maxZoom:Ce,minSize:x.evaluate(new fs(me)),maxSize:x.evaluate(new fs(Ce)),interpolationType:q}}}function Tf(m,h,x){let M="never";const q=m.get(h);return q?M=q:m.get(x)&&(M="always"),M}const gd=cc.VectorTileFeature.types,Om=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function b0(m,h,x,M,q,K,J,me,Ce,Oe,f,u,p){const S=me?Math.min(rh,Math.round(me[0])):0,L=me?Math.min(rh,Math.round(me[1])):0;m.emplaceBack(h,x,Math.round(32*M),Math.round(32*q),K,J,(S<<1)+(Ce?1:0),L,16*Oe,16*f,256*u,256*p)}function w0(m,h,x){m.emplaceBack(h.x,h.y,x),m.emplaceBack(h.x,h.y,x),m.emplaceBack(h.x,h.y,x),m.emplaceBack(h.x,h.y,x)}function kf(m){for(const h of m.sections)if(Wu(h.text))return!0;return!1}class Yu{constructor(h){this.layoutVertexArray=new ot,this.indexArray=new Xt,this.programConfigurations=h,this.segments=new Zi,this.dynamicLayoutVertexArray=new ct,this.opacityVertexArray=new Et,this.hasVisibleVertices=!1,this.placedSymbolArray=new r}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,x,M,q){this.isEmpty()||(M&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Ep.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,x),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,rd.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,Om,!0),this.opacityVertexBuffer.itemSize=1),(M||q)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}bn("SymbolBuffers",Yu);class Dc{constructor(h,x,M){this.layoutVertexArray=new h,this.layoutAttributes=x,this.indexArray=new M,this.segments=new Zi,this.collisionVertexArray=new ri}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,CA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}bn("CollisionBuffers",Dc);class eA{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(J=>J.id),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=j0([]),this.placementViewportMatrix=j0([]);const x=this.layers[0]._unevaluatedLayout._values;this.textSizeData=md(this.zoom,x["text-size"]),this.iconSizeData=md(this.zoom,x["icon-size"]);const M=this.layers[0].layout,q=M.get("symbol-sort-key"),K=M.get("symbol-z-order");this.canOverlap=Tf(M,"text-overlap","text-allow-overlap")!=="never"||Tf(M,"icon-overlap","icon-allow-overlap")!=="never"||M.get("text-ignore-placement")||M.get("icon-ignore-placement"),this.sortFeaturesByKey=K!=="viewport-y"&&!q.isConstant(),this.sortFeaturesByY=(K==="viewport-y"||K==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,M.get("symbol-placement")==="point"&&(this.writingModes=M.get("text-writing-mode").map(J=>E.ah[J])),this.stateDependentLayerIds=this.layers.filter(J=>J.isStateDependent()).map(J=>J.id),this.sourceID=h.sourceID}createArrays(){this.text=new Yu(new No(this.layers,this.zoom,h=>/^text/.test(h))),this.icon=new Yu(new No(this.layers,this.zoom,h=>/^icon/.test(h))),this.glyphOffsetArray=new _,this.lineVertexArray=new w,this.symbolInstances=new d,this.textAnchorOffsets=new B}calculateGlyphDependencies(h,x,M,q,K){for(let J=0;J<h.length;J++)if(x[h.charCodeAt(J)]=!0,(M||q)&&K){const me=Eh[h.charAt(J)];me&&(x[me.charCodeAt(0)]=!0)}}populate(h,x,M){const q=this.layers[0],K=q.layout,J=K.get("text-font"),me=K.get("text-field"),Ce=K.get("icon-image"),Oe=(me.value.kind!=="constant"||me.value.value instanceof Hi&&!me.value.value.isEmpty()||me.value.value.toString().length>0)&&(J.value.kind!=="constant"||J.value.value.length>0),f=Ce.value.kind!=="constant"||!!Ce.value.value||Object.keys(Ce.parameters).length>0,u=K.get("symbol-sort-key");if(this.features=[],!Oe&&!f)return;const p=x.iconDependencies,S=x.glyphDependencies,L=x.availableImages,G=new fs(this.zoom);for(const{feature:Q,id:re,index:he,sourceLayerIndex:_e}of h){const Le=q._featureFilter.needGeometry,qe=vl(Q,Le);if(!q._featureFilter.filter(G,qe,M))continue;let Je,At;if(Le||(qe.geometry=el(Q)),Oe){const Mt=q.getValueAndResolveTokens("text-field",qe,M,L),Pt=Hi.factory(Mt);kf(Pt)&&(this.hasRTLText=!0),(!this.hasRTLText||jl.getRTLTextPluginStatus()==="unavailable"||this.hasRTLText&&jl.isParsed())&&(Je=Lm(Pt,q,qe))}if(f){const Mt=q.getValueAndResolveTokens("icon-image",qe,M,L);At=Mt instanceof Yi?Mt:Yi.fromString(Mt)}if(!Je&&!At)continue;const gt=this.sortFeaturesByKey?u.evaluate(qe,{},M):void 0;if(this.features.push({id:re,text:Je,icon:At,index:he,sourceLayerIndex:_e,geometry:qe.geometry,properties:Q.properties,type:gd[Q.type],sortKey:gt}),At&&(p[At.name]=!0),Je){const Mt=J.evaluate(qe,{},M).join(","),Pt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ah.vertical)>=0;for(const zt of Je.sections)if(zt.image)p[zt.image.name]=!0;else{const $t=_l(Je.toString()),Ht=zt.fontStack||Mt,Zt=S[Ht]=S[Ht]||{};this.calculateGlyphDependencies(zt.text,Zt,Pt,this.allowVerticalPlacement,$t)}}}K.get("symbol-placement")==="line"&&(this.features=function(Q){const re={},he={},_e=[];let Le=0;function qe(Mt){_e.push(Q[Mt]),Le++}function Je(Mt,Pt,zt){const $t=he[Mt];return delete he[Mt],he[Pt]=$t,_e[$t].geometry[0].pop(),_e[$t].geometry[0]=_e[$t].geometry[0].concat(zt[0]),$t}function At(Mt,Pt,zt){const $t=re[Pt];return delete re[Pt],re[Mt]=$t,_e[$t].geometry[0].shift(),_e[$t].geometry[0]=zt[0].concat(_e[$t].geometry[0]),$t}function gt(Mt,Pt,zt){const $t=zt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${Mt}:${$t.x}:${$t.y}`}for(let Mt=0;Mt<Q.length;Mt++){const Pt=Q[Mt],zt=Pt.geometry,$t=Pt.text?Pt.text.toString():null;if(!$t){qe(Mt);continue}const Ht=gt($t,zt),Zt=gt($t,zt,!0);if(Ht in he&&Zt in re&&he[Ht]!==re[Zt]){const ui=At(Ht,Zt,zt),_i=Je(Ht,Zt,_e[ui].geometry);delete re[Ht],delete he[Zt],he[gt($t,_e[_i].geometry,!0)]=_i,_e[ui].geometry=null}else Ht in he?Je(Ht,Zt,zt):Zt in re?At(Ht,Zt,zt):(qe(Mt),re[Ht]=Le-1,he[Zt]=Le-1)}return _e.filter(Mt=>Mt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,re)=>Q.sortKey-re.sortKey)}update(h,x,M){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,x,this.layers,M),this.icon.programConfigurations.updatePaintArrays(h,x,this.layers,M))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,x){const M=this.lineVertexArray.length;if(h.segment!==void 0){let q=h.dist(x[h.segment+1]),K=h.dist(x[h.segment]);const J={};for(let me=h.segment+1;me<x.length;me++)J[me]={x:x[me].x,y:x[me].y,tileUnitDistanceFromAnchor:q},me<x.length-1&&(q+=x[me+1].dist(x[me]));for(let me=h.segment||0;me>=0;me--)J[me]={x:x[me].x,y:x[me].y,tileUnitDistanceFromAnchor:K},me>0&&(K+=x[me-1].dist(x[me]));for(let me=0;me<x.length;me++){const Ce=J[me];this.lineVertexArray.emplaceBack(Ce.x,Ce.y,Ce.tileUnitDistanceFromAnchor)}}return{lineStartIndex:M,lineLength:this.lineVertexArray.length-M}}addSymbols(h,x,M,q,K,J,me,Ce,Oe,f,u,p){const S=h.indexArray,L=h.layoutVertexArray,G=h.segments.prepareSegment(4*x.length,L,S,this.canOverlap?J.sortKey:void 0),Q=this.glyphOffsetArray.length,re=G.vertexLength,he=this.allowVerticalPlacement&&me===E.ah.vertical?Math.PI/2:0,_e=J.text&&J.text.sections;for(let Le=0;Le<x.length;Le++){const{tl:qe,tr:Je,bl:At,br:gt,tex:Mt,pixelOffsetTL:Pt,pixelOffsetBR:zt,minFontScaleX:$t,minFontScaleY:Ht,glyphOffset:Zt,isSDF:ui,sectionIndex:_i}=x[Le],Xi=G.vertexLength,xn=Zt[1];b0(L,Ce.x,Ce.y,qe.x,xn+qe.y,Mt.x,Mt.y,M,ui,Pt.x,Pt.y,$t,Ht),b0(L,Ce.x,Ce.y,Je.x,xn+Je.y,Mt.x+Mt.w,Mt.y,M,ui,zt.x,Pt.y,$t,Ht),b0(L,Ce.x,Ce.y,At.x,xn+At.y,Mt.x,Mt.y+Mt.h,M,ui,Pt.x,zt.y,$t,Ht),b0(L,Ce.x,Ce.y,gt.x,xn+gt.y,Mt.x+Mt.w,Mt.y+Mt.h,M,ui,zt.x,zt.y,$t,Ht),w0(h.dynamicLayoutVertexArray,Ce,he),S.emplaceBack(Xi,Xi+1,Xi+2),S.emplaceBack(Xi+1,Xi+2,Xi+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Zt[0]),Le!==x.length-1&&_i===x[Le+1].sectionIndex||h.programConfigurations.populatePaintArrays(L.length,J,J.index,{},p,_e&&_e[_i])}h.placedSymbolArray.emplaceBack(Ce.x,Ce.y,Q,this.glyphOffsetArray.length-Q,re,Oe,f,Ce.segment,M?M[0]:0,M?M[1]:0,q[0],q[1],me,0,!1,0,u)}_addCollisionDebugVertex(h,x,M,q,K,J){return x.emplaceBack(0,0),h.emplaceBack(M.x,M.y,q,K,Math.round(J.x),Math.round(J.y))}addCollisionDebugVertices(h,x,M,q,K,J,me){const Ce=K.segments.prepareSegment(4,K.layoutVertexArray,K.indexArray),Oe=Ce.vertexLength,f=K.layoutVertexArray,u=K.collisionVertexArray,p=me.anchorX,S=me.anchorY;this._addCollisionDebugVertex(f,u,J,p,S,new oe(h,x)),this._addCollisionDebugVertex(f,u,J,p,S,new oe(M,x)),this._addCollisionDebugVertex(f,u,J,p,S,new oe(M,q)),this._addCollisionDebugVertex(f,u,J,p,S,new oe(h,q)),Ce.vertexLength+=4;const L=K.indexArray;L.emplaceBack(Oe,Oe+1),L.emplaceBack(Oe+1,Oe+2),L.emplaceBack(Oe+2,Oe+3),L.emplaceBack(Oe+3,Oe),Ce.primitiveLength+=4}addDebugCollisionBoxes(h,x,M,q){for(let K=h;K<x;K++){const J=this.collisionBoxArray.get(K);this.addCollisionDebugVertices(J.x1,J.y1,J.x2,J.y2,q?this.textCollisionBox:this.iconCollisionBox,J.anchorPoint,M)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dc(wt,p0.members,Jt),this.iconCollisionBox=new Dc(wt,p0.members,Jt);for(let h=0;h<this.symbolInstances.length;h++){const x=this.symbolInstances.get(h);this.addDebugCollisionBoxes(x.textBoxStartIndex,x.textBoxEndIndex,x,!0),this.addDebugCollisionBoxes(x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x,!0),this.addDebugCollisionBoxes(x.iconBoxStartIndex,x.iconBoxEndIndex,x,!1),this.addDebugCollisionBoxes(x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x,!1)}}_deserializeCollisionBoxesForSymbol(h,x,M,q,K,J,me,Ce,Oe){const f={};for(let u=x;u<M;u++){const p=h.get(u);f.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.textFeatureIndex=p.featureIndex;break}for(let u=q;u<K;u++){const p=h.get(u);f.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalTextFeatureIndex=p.featureIndex;break}for(let u=J;u<me;u++){const p=h.get(u);f.iconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.iconFeatureIndex=p.featureIndex;break}for(let u=Ce;u<Oe;u++){const p=h.get(u);f.verticalIconBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.verticalIconFeatureIndex=p.featureIndex;break}return f}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let x=0;x<this.symbolInstances.length;x++){const M=this.symbolInstances.get(x);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,M.textBoxStartIndex,M.textBoxEndIndex,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M.iconBoxStartIndex,M.iconBoxEndIndex,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,x){const M=h.placedSymbolArray.get(x),q=M.vertexStartIndex+4*M.numGlyphs;for(let K=M.vertexStartIndex;K<q;K+=4)h.indexArray.emplaceBack(K,K+1,K+2),h.indexArray.emplaceBack(K+1,K+2,K+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const x=Math.sin(h),M=Math.cos(h),q=[],K=[],J=[];for(let me=0;me<this.symbolInstances.length;++me){J.push(me);const Ce=this.symbolInstances.get(me);q.push(0|Math.round(x*Ce.anchorX+M*Ce.anchorY)),K.push(Ce.featureIndex)}return J.sort((me,Ce)=>q[me]-q[Ce]||K[Ce]-K[me]),J}addToSortKeyRanges(h,x){const M=this.sortKeyRanges[this.sortKeyRanges.length-1];M&&M.sortKey===x?M.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:x,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const x of this.symbolInstanceIndexes){const M=this.symbolInstances.get(x);this.featureSortOrder.push(M.featureIndex),[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach((q,K,J)=>{q>=0&&J.indexOf(q)===K&&this.addIndicesForPlacedSymbol(this.text,q)}),M.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,M.verticalPlacedTextSymbolIndex),M.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.placedIconSymbolIndex),M.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let S0,Mp;bn("SymbolBucket",eA,{omit:["layers","collisionBoxArray","features","compareText"]}),eA.MAX_GLYPHS=65535,eA.addDynamicAttributes=w0;var _d={get paint(){return Mp=Mp||new oa({"icon-opacity":new Gn(ti.paint_symbol["icon-opacity"]),"icon-color":new Gn(ti.paint_symbol["icon-color"]),"icon-halo-color":new Gn(ti.paint_symbol["icon-halo-color"]),"icon-halo-width":new Gn(ti.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Gn(ti.paint_symbol["icon-halo-blur"]),"icon-translate":new pn(ti.paint_symbol["icon-translate"]),"icon-translate-anchor":new pn(ti.paint_symbol["icon-translate-anchor"]),"text-opacity":new Gn(ti.paint_symbol["text-opacity"]),"text-color":new Gn(ti.paint_symbol["text-color"],{runtimeType:He,getOverride:m=>m.textColor,hasOverride:m=>!!m.textColor}),"text-halo-color":new Gn(ti.paint_symbol["text-halo-color"]),"text-halo-width":new Gn(ti.paint_symbol["text-halo-width"]),"text-halo-blur":new Gn(ti.paint_symbol["text-halo-blur"]),"text-translate":new pn(ti.paint_symbol["text-translate"]),"text-translate-anchor":new pn(ti.paint_symbol["text-translate-anchor"])})},get layout(){return S0=S0||new oa({"symbol-placement":new pn(ti.layout_symbol["symbol-placement"]),"symbol-spacing":new pn(ti.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pn(ti.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Gn(ti.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pn(ti.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pn(ti.layout_symbol["icon-allow-overlap"]),"icon-overlap":new pn(ti.layout_symbol["icon-overlap"]),"icon-ignore-placement":new pn(ti.layout_symbol["icon-ignore-placement"]),"icon-optional":new pn(ti.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pn(ti.layout_symbol["icon-rotation-alignment"]),"icon-size":new Gn(ti.layout_symbol["icon-size"]),"icon-text-fit":new pn(ti.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pn(ti.layout_symbol["icon-text-fit-padding"]),"icon-image":new Gn(ti.layout_symbol["icon-image"]),"icon-rotate":new Gn(ti.layout_symbol["icon-rotate"]),"icon-padding":new Gn(ti.layout_symbol["icon-padding"]),"icon-keep-upright":new pn(ti.layout_symbol["icon-keep-upright"]),"icon-offset":new Gn(ti.layout_symbol["icon-offset"]),"icon-anchor":new Gn(ti.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pn(ti.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pn(ti.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pn(ti.layout_symbol["text-rotation-alignment"]),"text-field":new Gn(ti.layout_symbol["text-field"]),"text-font":new Gn(ti.layout_symbol["text-font"]),"text-size":new Gn(ti.layout_symbol["text-size"]),"text-max-width":new Gn(ti.layout_symbol["text-max-width"]),"text-line-height":new pn(ti.layout_symbol["text-line-height"]),"text-letter-spacing":new Gn(ti.layout_symbol["text-letter-spacing"]),"text-justify":new Gn(ti.layout_symbol["text-justify"]),"text-radial-offset":new Gn(ti.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pn(ti.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Gn(ti.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Gn(ti.layout_symbol["text-anchor"]),"text-max-angle":new pn(ti.layout_symbol["text-max-angle"]),"text-writing-mode":new pn(ti.layout_symbol["text-writing-mode"]),"text-rotate":new Gn(ti.layout_symbol["text-rotate"]),"text-padding":new pn(ti.layout_symbol["text-padding"]),"text-keep-upright":new pn(ti.layout_symbol["text-keep-upright"]),"text-transform":new Gn(ti.layout_symbol["text-transform"]),"text-offset":new Gn(ti.layout_symbol["text-offset"]),"text-allow-overlap":new pn(ti.layout_symbol["text-allow-overlap"]),"text-overlap":new pn(ti.layout_symbol["text-overlap"]),"text-ignore-placement":new pn(ti.layout_symbol["text-ignore-placement"]),"text-optional":new pn(ti.layout_symbol["text-optional"])})}};class Mf{constructor(h){if(h.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=h.property.overrides?h.property.overrides.runtimeType:Ie,this.defaultValue=h}evaluate(h){if(h.formattedSection){const x=this.defaultValue.property.overrides;if(x&&x.hasOverride(h.formattedSection))return x.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}bn("FormatSectionOverride",Mf,{omit:["defaultValue"]});class OA extends _s{constructor(h){super(h,_d)}recalculate(h,x){if(super.recalculate(h,x),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const M=this.layout.get("text-writing-mode");if(M){const q=[];for(const K of M)q.indexOf(K)<0&&q.push(K);this.layout._values["text-writing-mode"]=q}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(h,x,M,q){const K=this.layout.get(h).evaluate(x,{},M,q),J=this._unevaluatedLayout._values[h];return J.isDataDriven()||jr(J.value)||!K?K:function(me,Ce){return Ce.replace(/{([^{}]+)}/g,(Oe,f)=>me&&f in me?String(me[f]):"")}(x.properties,K)}createBucket(h){return new eA(h)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const h of _d.paint.overridableProperties){if(!OA.hasPaintOverride(this.layout,h))continue;const x=this.paint.get(h),M=new Mf(x),q=new Jr(M,x.property.specification);let K=null;K=x.value.kind==="constant"||x.value.kind==="source"?new Cr("source",q):new nr("composite",q,x.value.zoomStops),this.paint._values[h]=new _r(x.property,K,x.parameters)}}_handleOverridablePaintPropertyUpdate(h,x,M){return!(!this.layout||x.isDataDriven()||M.isDataDriven())&&OA.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,x){const M=h.get("text-field"),q=_d.paint.properties[x];let K=!1;const J=me=>{for(const Ce of me)if(q.overrides&&q.overrides.hasOverride(Ce))return void(K=!0)};if(M.value.kind==="constant"&&M.value.value instanceof Hi)J(M.value.value.sections);else if(M.value.kind==="source"){const me=Oe=>{K||(Oe instanceof Vr&&ur(Oe.value)===rt?J(Oe.value.sections):Oe instanceof ql?J(Oe.sections):Oe.eachChild(me))},Ce=M.value;Ce._styleExpression&&me(Ce._styleExpression.expression)}return K}}let Pp;var yd={get paint(){return Pp=Pp||new oa({"background-color":new pn(ti.paint_background["background-color"]),"background-pattern":new Jo(ti.paint_background["background-pattern"]),"background-opacity":new pn(ti.paint_background["background-opacity"])})}};class vd extends _s{constructor(h){super(h,yd)}}let sh;var xd={get paint(){return sh=sh||new oa({"raster-opacity":new pn(ti.paint_raster["raster-opacity"]),"raster-hue-rotate":new pn(ti.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pn(ti.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pn(ti.paint_raster["raster-brightness-max"]),"raster-saturation":new pn(ti.paint_raster["raster-saturation"]),"raster-contrast":new pn(ti.paint_raster["raster-contrast"]),"raster-resampling":new pn(ti.paint_raster["raster-resampling"]),"raster-fade-duration":new pn(ti.paint_raster["raster-fade-duration"])})}};class Dp extends _s{constructor(h){super(h,xd)}}class bd extends _s{constructor(h){super(h,{}),this.onAdd=x=>{this.implementation.onAdd&&this.implementation.onAdd(x,x.painter.context.gl)},this.onRemove=x=>{this.implementation.onRemove&&this.implementation.onRemove(x,x.painter.context.gl)},this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Lp{constructor(h){this._methodToThrottle=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const NA=63710088e-1;class ah{constructor(h,x){if(isNaN(h)||isNaN(x))throw new Error(`Invalid LngLat object: (${h}, ${x})`);if(this.lng=+h,this.lat=+x,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ah(Ge(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const x=Math.PI/180,M=this.lat*x,q=h.lat*x,K=Math.sin(M)*Math.sin(q)+Math.cos(M)*Math.cos(q)*Math.cos((h.lng-this.lng)*x);return NA*Math.acos(Math.min(K,1))}static convert(h){if(h instanceof ah)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new ah(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new ah(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Bp=2*Math.PI*NA;function zp(m){return Bp*Math.cos(m*Math.PI/180)}function wd(m){return(180+m)/360}function Sd(m){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m*Math.PI/360)))/360}function Rp(m,h){return m/zp(h)}function VA(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}class I0{constructor(h,x,M=0){this.x=+h,this.y=+x,this.z=+M}static fromLngLat(h,x=0){const M=ah.convert(h);return new I0(wd(M.lng),Sd(M.lat),Rp(x,M.lat))}toLngLat(){return new ah(360*this.x-180,VA(this.y))}toAltitude(){return this.z*zp(VA(this.y))}meterInMercatorCoordinateUnits(){return 1/Bp*(h=VA(this.y),1/Math.cos(h*Math.PI/180));var h}}function E0(m,h,x){var M=2*Math.PI*6378137/256/Math.pow(2,x);return[m*M-2*Math.PI*6378137/2,h*M-2*Math.PI*6378137/2]}class Lc{constructor(h,x,M){if(h<0||h>25||M<0||M>=Math.pow(2,h)||x<0||x>=Math.pow(2,h))throw new Error(`x=${x}, y=${M}, z=${h} outside of bounds. 0<=x<${Math.pow(2,h)}, 0<=y<${Math.pow(2,h)} 0<=z<=25 `);this.z=h,this.x=x,this.y=M,this.key=UA(0,h,h,x,M)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,x,M){const q=(J=this.y,me=this.z,Ce=E0(256*(K=this.x),256*(J=Math.pow(2,me)-J-1),me),Oe=E0(256*(K+1),256*(J+1),me),Ce[0]+","+Ce[1]+","+Oe[0]+","+Oe[1]);var K,J,me,Ce,Oe;const f=function(u,p,S){let L,G="";for(let Q=u;Q>0;Q--)L=1<<Q-1,G+=(p&L?1:0)+(S&L?2:0);return G}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(M==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,x>1?"@2x":"").replace(/{quadkey}/g,f).replace(/{bbox-epsg-3857}/g,q)}isChildOf(h){const x=this.z-h.z;return x>0&&h.x===this.x>>x&&h.y===this.y>>x}getTilePoint(h){const x=Math.pow(2,this.z);return new oe((h.x*x-this.x)*Ws,(h.y*x-this.y)*Ws)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Id{constructor(h,x){this.wrap=h,this.canonical=x,this.key=UA(h,x.z,x.z,x.x,x.y)}}class ku{constructor(h,x,M,q,K){if(h<M)throw new Error(`overscaledZ should be >= z; overscaledZ = ${h}; z = ${M}`);this.overscaledZ=h,this.wrap=x,this.canonical=new Lc(M,+q,+K),this.key=UA(x,h,M,q,K)}clone(){return new ku(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const x=this.canonical.z-h;return h>this.canonical.z?new ku(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ku(h,this.wrap,h,this.canonical.x>>x,this.canonical.y>>x)}calculateScaledKey(h,x){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const M=this.canonical.z-h;return h>this.canonical.z?UA(this.wrap*+x,h,this.canonical.z,this.canonical.x,this.canonical.y):UA(this.wrap*+x,h,h,this.canonical.x>>M,this.canonical.y>>M)}isChildOf(h){if(h.wrap!==this.wrap)return!1;const x=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>x&&h.canonical.y===this.canonical.y>>x}children(h){if(this.overscaledZ>=h)return[new ku(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const x=this.canonical.z+1,M=2*this.canonical.x,q=2*this.canonical.y;return[new ku(x,this.wrap,x,M,q),new ku(x,this.wrap,x,M+1,q),new ku(x,this.wrap,x,M,q+1),new ku(x,this.wrap,x,M+1,q+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new ku(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new ku(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Id(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(h){return this.canonical.getTilePoint(new I0(h.x-this.wrap,h.y))}}function UA(m,h,x,M,q){(m*=2)<0&&(m=-1*m-1);const K=1<<x;return(K*K*m+K*q+M).toString(36)+x.toString(36)+h.toString(36)}bn("CanonicalTileID",Lc),bn("OverscaledTileID",ku,{omit:["posMatrix"]});class Ed{constructor(h,x,M,q=1,K=1,J=1,me=0){if(this.uid=h,x.height!==x.width)throw new RangeError("DEM tiles must be square");if(M&&!["mapbox","terrarium","custom"].includes(M))return void dt(`"${M}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=x.height;const Ce=this.dim=x.height-2;switch(this.data=new Uint32Array(x.data.buffer),M){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=q,this.greenFactor=K,this.blueFactor=J,this.baseShift=me;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Oe=0;Oe<Ce;Oe++)this.data[this._idx(-1,Oe)]=this.data[this._idx(0,Oe)],this.data[this._idx(Ce,Oe)]=this.data[this._idx(Ce-1,Oe)],this.data[this._idx(Oe,-1)]=this.data[this._idx(Oe,0)],this.data[this._idx(Oe,Ce)]=this.data[this._idx(Oe,Ce-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Ce,-1)]=this.data[this._idx(Ce-1,0)],this.data[this._idx(-1,Ce)]=this.data[this._idx(0,Ce-1)],this.data[this._idx(Ce,Ce)]=this.data[this._idx(Ce-1,Ce-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Oe=0;Oe<Ce;Oe++)for(let f=0;f<Ce;f++){const u=this.get(Oe,f);u>this.max&&(this.max=u),u<this.min&&(this.min=u)}}get(h,x){const M=new Uint8Array(this.data.buffer),q=4*this._idx(h,x);return this.unpack(M[q],M[q+1],M[q+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(h,x){if(h<-1||h>=this.dim+1||x<-1||x>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(x+1)*this.stride+(h+1)}unpack(h,x,M){return h*this.redFactor+x*this.greenFactor+M*this.blueFactor-this.baseShift}getPixels(){return new Nu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(h,x,M){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let q=x*this.dim,K=x*this.dim+this.dim,J=M*this.dim,me=M*this.dim+this.dim;switch(x){case-1:q=K-1;break;case 1:K=q+1}switch(M){case-1:J=me-1;break;case 1:me=J+1}const Ce=-x*this.dim,Oe=-M*this.dim;for(let f=J;f<me;f++)for(let u=q;u<K;u++)this.data[this._idx(u,f)]=h.data[this._idx(u+Ce,f+Oe)]}}bn("DEMData",Ed);class Cd{constructor(h){this._stringToNumber={},this._numberToString=[];for(let x=0;x<h.length;x++){const M=h[x];this._stringToNumber[M]=x,this._numberToString[x]=M}}encode(h){return this._stringToNumber[h]}decode(h){if(h>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${h} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[h]}}class Td{constructor(h,x,M,q,K){this.type="Feature",this._vectorTileFeature=h,h._z=x,h._x=M,h._y=q,this.properties=h.properties,this.id=K}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={geometry:this.geometry};for(const x in this)x!=="_geometry"&&x!=="_vectorTileFeature"&&(h[x]=this[x]);return h}}class C0{constructor(h,x){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Pn(Ws,16,0),this.grid3D=new Pn(Ws,16,0),this.featureIndexArray=new Y,this.promoteId=x}insert(h,x,M,q,K,J){const me=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(M,q,K);const Ce=J?this.grid3D:this.grid;for(let Oe=0;Oe<x.length;Oe++){const f=x[Oe],u=[1/0,1/0,-1/0,-1/0];for(let p=0;p<f.length;p++){const S=f[p];u[0]=Math.min(u[0],S.x),u[1]=Math.min(u[1],S.y),u[2]=Math.max(u[2],S.x),u[3]=Math.max(u[3],S.y)}u[0]<Ws&&u[1]<Ws&&u[2]>=0&&u[3]>=0&&Ce.insert(me,u[0],u[1],u[2],u[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new cc.VectorTile(new Ad(this.rawTileData)).layers,this.sourceLayerCoder=new Cd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(h,x,M,q){this.loadVTLayers();const K=h.params||{},J=Ws/h.tileSize/h.scale,me=hs(K.filter),Ce=h.queryGeometry,Oe=h.queryPadding*J,f=kd(Ce),u=this.grid.query(f.minX-Oe,f.minY-Oe,f.maxX+Oe,f.maxY+Oe),p=kd(h.cameraQueryGeometry),S=this.grid3D.query(p.minX-Oe,p.minY-Oe,p.maxX+Oe,p.maxY+Oe,(Q,re,he,_e)=>function(Le,qe,Je,At,gt){for(const Pt of Le)if(qe<=Pt.x&&Je<=Pt.y&&At>=Pt.x&&gt>=Pt.y)return!0;const Mt=[new oe(qe,Je),new oe(qe,gt),new oe(At,gt),new oe(At,Je)];if(Le.length>2){for(const Pt of Mt)if(Xc(Le,Pt))return!0}for(let Pt=0;Pt<Le.length-1;Pt++)if(gp(Le[Pt],Le[Pt+1],Mt))return!0;return!1}(h.cameraQueryGeometry,Q-Oe,re-Oe,he+Oe,_e+Oe));for(const Q of S)u.push(Q);u.sort(Md);const L={};let G;for(let Q=0;Q<u.length;Q++){const re=u[Q];if(re===G)continue;G=re;const he=this.featureIndexArray.get(re);let _e=null;this.loadMatchingFeature(L,he.bucketIndex,he.sourceLayerIndex,he.featureIndex,me,K.layers,K.availableImages,x,M,q,(Le,qe,Je)=>(_e||(_e=el(Le)),qe.queryIntersectsFeature(Ce,Le,Je,_e,this.z,h.transform,J,h.pixelPosMatrix)))}return L}loadMatchingFeature(h,x,M,q,K,J,me,Ce,Oe,f,u){const p=this.bucketLayerIDs[x];if(J&&!function(Q,re){for(let he=0;he<Q.length;he++)if(re.indexOf(Q[he])>=0)return!0;return!1}(J,p))return;const S=this.sourceLayerCoder.decode(M),L=this.vtLayers[S].feature(q);if(K.needGeometry){const Q=vl(L,!0);if(!K.filter(new fs(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!K.filter(new fs(this.tileID.overscaledZ),L))return;const G=this.getId(L,S);for(let Q=0;Q<p.length;Q++){const re=p[Q];if(J&&J.indexOf(re)<0)continue;const he=Ce[re];if(!he)continue;let _e={};G&&f&&(_e=f.getState(he.sourceLayer||"_geojsonTileLayer",G));const Le=ni({},Oe[re]);Le.paint=Pf(Le.paint,he.paint,L,_e,me),Le.layout=Pf(Le.layout,he.layout,L,_e,me);const qe=!u||u(L,he,_e);if(!qe)continue;const Je=new Td(L,this.z,this.x,this.y,G);Je.layer=Le;let At=h[re];At===void 0&&(At=h[re]=[]),At.push({featureIndex:q,feature:Je,intersectionZ:qe})}}lookupSymbolFeatures(h,x,M,q,K,J,me,Ce){const Oe={};this.loadVTLayers();const f=hs(K);for(const u of h)this.loadMatchingFeature(Oe,M,q,u,f,J,me,Ce,x);return Oe}hasLayer(h){for(const x of this.bucketLayerIDs)for(const M of x)if(h===M)return!0;return!1}getId(h,x){let M=h.id;return this.promoteId&&(M=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[x]],typeof M=="boolean"&&(M=Number(M))),M}}function Pf(m,h,x,M,q){return xt(m,(K,J)=>{const me=h instanceof ds?h.get(J):null;return me&&me.evaluate?me.evaluate(x,M,q):me})}function kd(m){let h=1/0,x=1/0,M=-1/0,q=-1/0;for(const K of m)h=Math.min(h,K.x),x=Math.min(x,K.y),M=Math.max(M,K.x),q=Math.max(q,K.y);return{minX:h,minY:x,maxX:M,maxY:q}}function Md(m,h){return h-m}function Pd(m,h,x,M,q){const K=[];for(let J=0;J<m.length;J++){const me=m[J];let Ce;for(let Oe=0;Oe<me.length-1;Oe++){let f=me[Oe],u=me[Oe+1];f.x<h&&u.x<h||(f.x<h?f=new oe(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x<h&&(u=new oe(h,f.y+(h-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y<x&&u.y<x||(f.y<x?f=new oe(f.x+(x-f.y)/(u.y-f.y)*(u.x-f.x),x)._round():u.y<x&&(u=new oe(f.x+(x-f.y)/(u.y-f.y)*(u.x-f.x),x)._round()),f.x>=M&&u.x>=M||(f.x>=M?f=new oe(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round():u.x>=M&&(u=new oe(M,f.y+(M-f.x)/(u.x-f.x)*(u.y-f.y))._round()),f.y>=q&&u.y>=q||(f.y>=q?f=new oe(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round():u.y>=q&&(u=new oe(f.x+(q-f.y)/(u.y-f.y)*(u.x-f.x),q)._round()),Ce&&f.equals(Ce[Ce.length-1])||(Ce=[f],K.push(Ce)),Ce.push(u)))))}}return K}bn("FeatureIndex",C0,{omit:["rawTileData","sourceLayerCoder"]});class bl extends oe{constructor(h,x,M,q){super(h,x),this.angle=M,q!==void 0&&(this.segment=q)}clone(){return new bl(this.x,this.y,this.angle,this.segment)}}function GA(m,h,x,M,q){if(h.segment===void 0||x===0)return!0;let K=h,J=h.segment+1,me=0;for(;me>-x/2;){if(J--,J<0)return!1;me-=m[J].dist(K),K=m[J]}me+=m[J].dist(m[J+1]),J++;const Ce=[];let Oe=0;for(;me<x/2;){const f=m[J],u=m[J+1];if(!u)return!1;let p=m[J-1].angleTo(f)-f.angleTo(u);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),Ce.push({distance:me,angleDelta:p}),Oe+=p;me-Ce[0].distance>M;)Oe-=Ce.shift().angleDelta;if(Oe>q)return!1;J++,me+=f.dist(u)}return!0}function T0(m){let h=0;for(let x=0;x<m.length-1;x++)h+=m[x].dist(m[x+1]);return h}function k0(m,h,x){return m?.6*h*x:0}function Dd(m,h){return Math.max(m?m.right-m.left:0,h?h.right-h.left:0)}function Fp(m,h,x,M,q,K){const J=k0(x,q,K),me=Dd(x,M)*K;let Ce=0;const Oe=T0(m)/2;for(let f=0;f<m.length-1;f++){const u=m[f],p=m[f+1],S=u.dist(p);if(Ce+S>Oe){const L=(Oe-Ce)/S,G=vr.number(u.x,p.x,L),Q=vr.number(u.y,p.y,L),re=new bl(G,Q,p.angleTo(u),f);return re._round(),!J||GA(m,re,me,J,h)?re:void 0}Ce+=S}}function Op(m,h,x,M,q,K,J,me,Ce){const Oe=k0(M,K,J),f=Dd(M,q),u=f*J,p=m[0].x===0||m[0].x===Ce||m[0].y===0||m[0].y===Ce;return h-u<h/4&&(h=u+h/4),Ld(m,p?h/2*me%h:(f/2+2*K)*J*me%h,h,Oe,x,u,p,!1,Ce)}function Ld(m,h,x,M,q,K,J,me,Ce){const Oe=K/2,f=T0(m);let u=0,p=h-x,S=[];for(let L=0;L<m.length-1;L++){const G=m[L],Q=m[L+1],re=G.dist(Q),he=Q.angleTo(G);for(;p+x<u+re;){p+=x;const _e=(p-u)/re,Le=vr.number(G.x,Q.x,_e),qe=vr.number(G.y,Q.y,_e);if(Le>=0&&Le<Ce&&qe>=0&&qe<Ce&&p-Oe>=0&&p+Oe<=f){const Je=new bl(Le,qe,he,L);Je._round(),M&&!GA(m,Je,K,M,q)||S.push(Je)}}u+=re}return me||S.length||J||(S=Ld(m,u/2,x,M,q,K,J,!0,Ce)),S}bn("Anchor",bl);const oh=hl;function Bd(m,h,x,M){const q=[],K=m.image,J=K.pixelRatio,me=K.paddedRect.w-2*oh,Ce=K.paddedRect.h-2*oh,Oe=m.right-m.left,f=m.bottom-m.top,u=K.stretchX||[[0,me]],p=K.stretchY||[[0,Ce]],S=(zt,$t)=>zt+$t[1]-$t[0],L=u.reduce(S,0),G=p.reduce(S,0),Q=me-L,re=Ce-G;let he=0,_e=L,Le=0,qe=G,Je=0,At=Q,gt=0,Mt=re;if(K.content&&M){const zt=K.content;he=hc(u,0,zt[0]),Le=hc(p,0,zt[1]),_e=hc(u,zt[0],zt[2]),qe=hc(p,zt[1],zt[3]),Je=zt[0]-he,gt=zt[1]-Le,At=zt[2]-zt[0]-_e,Mt=zt[3]-zt[1]-qe}const Pt=(zt,$t,Ht,Zt)=>{const ui=Df(zt.stretch-he,_e,Oe,m.left),_i=Lf(zt.fixed-Je,At,zt.stretch,L),Xi=Df($t.stretch-Le,qe,f,m.top),xn=Lf($t.fixed-gt,Mt,$t.stretch,G),nn=Df(Ht.stretch-he,_e,Oe,m.left),tn=Lf(Ht.fixed-Je,At,Ht.stretch,L),hn=Df(Zt.stretch-Le,qe,f,m.top),zn=Lf(Zt.fixed-gt,Mt,Zt.stretch,G),en=new oe(ui,Xi),Wi=new oe(nn,Xi),Dn=new oe(nn,hn),Rn=new oe(ui,hn),dr=new oe(_i/J,xn/J),Fr=new oe(tn/J,zn/J),qr=h*Math.PI/180;if(qr){const ia=Math.sin(qr),is=Math.cos(qr),Wn=[is,-ia,ia,is];en._matMult(Wn),Wi._matMult(Wn),Rn._matMult(Wn),Dn._matMult(Wn)}const zs=zt.stretch+zt.fixed,Ea=$t.stretch+$t.fixed;return{tl:en,tr:Wi,bl:Rn,br:Dn,tex:{x:K.paddedRect.x+oh+zs,y:K.paddedRect.y+oh+Ea,w:Ht.stretch+Ht.fixed-zs,h:Zt.stretch+Zt.fixed-Ea},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:dr,pixelOffsetBR:Fr,minFontScaleX:At/J/Oe,minFontScaleY:Mt/J/f,isSDF:x}};if(M&&(K.stretchX||K.stretchY)){const zt=zd(u,Q,L),$t=zd(p,re,G);for(let Ht=0;Ht<zt.length-1;Ht++){const Zt=zt[Ht],ui=zt[Ht+1];for(let _i=0;_i<$t.length-1;_i++)q.push(Pt(Zt,$t[_i],ui,$t[_i+1]))}}else q.push(Pt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:me+1},{fixed:0,stretch:Ce+1}));return q}function hc(m,h,x){let M=0;for(const q of m)M+=Math.max(h,Math.min(x,q[1]))-Math.max(h,Math.min(x,q[0]));return M}function zd(m,h,x){const M=[{fixed:-oh,stretch:0}];for(const[q,K]of m){const J=M[M.length-1];M.push({fixed:q-J.stretch,stretch:J.stretch}),M.push({fixed:q-J.stretch,stretch:J.stretch+(K-q)})}return M.push({fixed:h+oh,stretch:x}),M}function Df(m,h,x,M){return m/h*x+M}function Lf(m,h,x,M){return m-h*x/M}class Bf{constructor(h,x,M,q,K,J,me,Ce,Oe,f){if(this.boxStartIndex=h.length,Oe){let u=J.top,p=J.bottom;const S=J.collisionPadding;S&&(u-=S[1],p+=S[3]);let L=p-u;L>0&&(L=Math.max(10,L),this.circleDiameter=L)}else{let u=J.top*me-Ce[0],p=J.bottom*me+Ce[2],S=J.left*me-Ce[3],L=J.right*me+Ce[1];const G=J.collisionPadding;if(G&&(S-=G[0]*me,u-=G[1]*me,L+=G[2]*me,p+=G[3]*me),f){const Q=new oe(S,u),re=new oe(L,u),he=new oe(S,p),_e=new oe(L,p),Le=f*Math.PI/180;Q._rotate(Le),re._rotate(Le),he._rotate(Le),_e._rotate(Le),S=Math.min(Q.x,re.x,he.x,_e.x),L=Math.max(Q.x,re.x,he.x,_e.x),u=Math.min(Q.y,re.y,he.y,_e.y),p=Math.max(Q.y,re.y,he.y,_e.y)}h.emplaceBack(x.x,x.y,S,u,L,p,M,q,K)}this.boxEndIndex=h.length}}class Nm{constructor(h=[],x=Vm){if(this.data=h,this.length=this.data.length,this.compare=x,this.length>0)for(let M=(this.length>>1)-1;M>=0;M--)this._down(M)}push(h){this.data.push(h),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const h=this.data[0],x=this.data.pop();return this.length--,this.length>0&&(this.data[0]=x,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:x,compare:M}=this,q=x[h];for(;h>0;){const K=h-1>>1,J=x[K];if(M(q,J)>=0)break;x[h]=J,h=K}x[h]=q}_down(h){const{data:x,compare:M}=this,q=this.length>>1,K=x[h];for(;h<q;){let J=1+(h<<1),me=x[J];const Ce=J+1;if(Ce<this.length&&M(x[Ce],me)<0&&(J=Ce,me=x[Ce]),M(me,K)>=0)break;x[h]=me,h=J}x[h]=K}}function Vm(m,h){return m<h?-1:m>h?1:0}function Np(m,h=1,x=!1){let M=1/0,q=1/0,K=-1/0,J=-1/0;const me=m[0];for(let S=0;S<me.length;S++){const L=me[S];(!S||L.x<M)&&(M=L.x),(!S||L.y<q)&&(q=L.y),(!S||L.x>K)&&(K=L.x),(!S||L.y>J)&&(J=L.y)}const Ce=Math.min(K-M,J-q);let Oe=Ce/2;const f=new Nm([],qA);if(Ce===0)return new oe(M,q);for(let S=M;S<K;S+=Ce)for(let L=q;L<J;L+=Ce)f.push(new tA(S+Oe,L+Oe,Oe,m));let u=function(S){let L=0,G=0,Q=0;const re=S[0];for(let he=0,_e=re.length,Le=_e-1;he<_e;Le=he++){const qe=re[he],Je=re[Le],At=qe.x*Je.y-Je.x*qe.y;G+=(qe.x+Je.x)*At,Q+=(qe.y+Je.y)*At,L+=3*At}return new tA(G/L,Q/L,0,S)}(m),p=f.length;for(;f.length;){const S=f.pop();(S.d>u.d||!u.d)&&(u=S,x&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,p)),S.max-u.d<=h||(Oe=S.h/2,f.push(new tA(S.p.x-Oe,S.p.y-Oe,Oe,m)),f.push(new tA(S.p.x+Oe,S.p.y-Oe,Oe,m)),f.push(new tA(S.p.x-Oe,S.p.y+Oe,Oe,m)),f.push(new tA(S.p.x+Oe,S.p.y+Oe,Oe,m)),p+=4)}return x&&(console.log(`num probes: ${p}`),console.log(`best distance: ${u.d}`)),u.p}function qA(m,h){return h.max-m.max}function tA(m,h,x,M){this.p=new oe(m,h),this.h=x,this.d=function(q,K){let J=!1,me=1/0;for(let Ce=0;Ce<K.length;Ce++){const Oe=K[Ce];for(let f=0,u=Oe.length,p=u-1;f<u;p=f++){const S=Oe[f],L=Oe[p];S.y>q.y!=L.y>q.y&&q.x<(L.x-S.x)*(q.y-S.y)/(L.y-S.y)+S.x&&(J=!J),me=Math.min(me,Uh(q,S,L))}}return(J?1:-1)*Math.sqrt(me)}(this.p,M),this.max=this.d+this.h*Math.SQRT2}var Mo;E.ap=void 0,(Mo=E.ap||(E.ap={}))[Mo.center=1]="center",Mo[Mo.left=2]="left",Mo[Mo.right=3]="right",Mo[Mo.top=4]="top",Mo[Mo.bottom=5]="bottom",Mo[Mo["top-left"]=6]="top-left",Mo[Mo["top-right"]=7]="top-right",Mo[Mo["bottom-left"]=8]="bottom-left",Mo[Mo["bottom-right"]=9]="bottom-right";const lh=7,iA=Number.POSITIVE_INFINITY;function HA(m,h){return h[1]!==iA?function(x,M,q){let K=0,J=0;switch(M=Math.abs(M),q=Math.abs(q),x){case"top-right":case"top-left":case"top":J=q-lh;break;case"bottom-right":case"bottom-left":case"bottom":J=-q+lh}switch(x){case"top-right":case"bottom-right":case"right":K=-M;break;case"top-left":case"bottom-left":case"left":K=M}return[K,J]}(m,h[0],h[1]):function(x,M){let q=0,K=0;M<0&&(M=0);const J=M/Math.SQRT2;switch(x){case"top-right":case"top-left":K=J-lh;break;case"bottom-right":case"bottom-left":K=-J+lh;break;case"bottom":K=-M+lh;break;case"top":K=M-lh}switch(x){case"top-right":case"bottom-right":q=-J;break;case"top-left":case"bottom-left":q=J;break;case"left":q=M;break;case"right":q=-M}return[q,K]}(m,h[0])}function nA(m,h,x){var M;const q=m.layout,K=(M=q.get("text-variable-anchor-offset"))===null||M===void 0?void 0:M.evaluate(h,{},x);if(K){const me=K.values,Ce=[];for(let Oe=0;Oe<me.length;Oe+=2){const f=Ce[Oe]=me[Oe],u=me[Oe+1].map(p=>p*cl);f.startsWith("top")?u[1]-=lh:f.startsWith("bottom")&&(u[1]+=lh),Ce[Oe+1]=u}return new Qt(Ce)}const J=q.get("text-variable-anchor");if(J){let me;me=m._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[q.get("text-radial-offset").evaluate(h,{},x)*cl,iA]:q.get("text-offset").evaluate(h,{},x).map(Oe=>Oe*cl);const Ce=[];for(const Oe of J)Ce.push(Oe,HA(Oe,me));return new Qt(Ce)}return null}function M0(m){switch(m){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Vp(m,h,x,M,q,K,J,me,Ce,Oe,f){let u=K.textMaxSize.evaluate(h,{});u===void 0&&(u=J);const p=m.layers[0].layout,S=p.get("icon-offset").evaluate(h,{},f),L=Fd(x.horizontal),G=J/24,Q=m.tilePixelRatio*G,re=m.tilePixelRatio*u/24,he=m.tilePixelRatio*me,_e=m.tilePixelRatio*p.get("symbol-spacing"),Le=p.get("text-padding")*m.tilePixelRatio,qe=function(Zt,ui,_i,Xi=1){const xn=Zt.get("icon-padding").evaluate(ui,{},_i),nn=xn&&xn.values;return[nn[0]*Xi,nn[1]*Xi,nn[2]*Xi,nn[3]*Xi]}(p,h,f,m.tilePixelRatio),Je=p.get("text-max-angle")/180*Math.PI,At=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",gt=p.get("icon-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point",Mt=p.get("symbol-placement"),Pt=_e/2,zt=p.get("icon-text-fit");let $t;M&&zt!=="none"&&(m.allowVerticalPlacement&&x.vertical&&($t=pd(M,x.vertical,zt,p.get("icon-text-fit-padding"),S,G)),L&&(M=pd(M,L,zt,p.get("icon-text-fit-padding"),S,G)));const Ht=(Zt,ui)=>{ui.x<0||ui.x>=Ws||ui.y<0||ui.y>=Ws||function(_i,Xi,xn,nn,tn,hn,zn,en,Wi,Dn,Rn,dr,Fr,qr,zs,Ea,ia,is,Wn,xs,tr,na,Ds,Kn,La){const $a=_i.addToLineVertexArray(Xi,xn);let va,Uo,so,ra,br=0,yo=0,tl=0,il=0,Mu=-1,Vu=-1;const zl={};let zc=er("");if(_i.allowVerticalPlacement&&nn.vertical){const Yl=en.layout.get("text-rotate").evaluate(tr,{},Kn)+90;so=new Bf(Wi,Xi,Dn,Rn,dr,nn.vertical,Fr,qr,zs,Yl),zn&&(ra=new Bf(Wi,Xi,Dn,Rn,dr,zn,ia,is,zs,Yl))}if(tn){const Yl=en.layout.get("icon-rotate").evaluate(tr,{}),qu=en.layout.get("icon-text-fit")!=="none",Mh=Bd(tn,Yl,Ds,qu),Ac=zn?Bd(zn,Yl,Ds,qu):void 0;Uo=new Bf(Wi,Xi,Dn,Rn,dr,tn,ia,is,!1,Yl),br=4*Mh.length;const $l=_i.iconSizeData;let Hu=null;$l.kind==="source"?(Hu=[Pc*en.layout.get("icon-size").evaluate(tr,{})],Hu[0]>rh&&dt(`${_i.layerIds[0]}: Value for "icon-size" is >= ${Th}. Reduce your "icon-size".`)):$l.kind==="composite"&&(Hu=[Pc*na.compositeIconSizes[0].evaluate(tr,{},Kn),Pc*na.compositeIconSizes[1].evaluate(tr,{},Kn)],(Hu[0]>rh||Hu[1]>rh)&&dt(`${_i.layerIds[0]}: Value for "icon-size" is >= ${Th}. Reduce your "icon-size".`)),_i.addSymbols(_i.icon,Mh,Hu,xs,Wn,tr,E.ah.none,Xi,$a.lineStartIndex,$a.lineLength,-1,Kn),Mu=_i.icon.placedSymbolArray.length-1,Ac&&(yo=4*Ac.length,_i.addSymbols(_i.icon,Ac,Hu,xs,Wn,tr,E.ah.vertical,Xi,$a.lineStartIndex,$a.lineLength,-1,Kn),Vu=_i.icon.placedSymbolArray.length-1)}const Uu=Object.keys(nn.horizontal);for(const Yl of Uu){const qu=nn.horizontal[Yl];if(!va){zc=er(qu.text);const Ac=en.layout.get("text-rotate").evaluate(tr,{},Kn);va=new Bf(Wi,Xi,Dn,Rn,dr,qu,Fr,qr,zs,Ac)}const Mh=qu.positionedLines.length===1;if(tl+=Rd(_i,Xi,qu,hn,en,zs,tr,Ea,$a,nn.vertical?E.ah.horizontal:E.ah.horizontalOnly,Mh?Uu:[Yl],zl,Mu,na,Kn),Mh)break}nn.vertical&&(il+=Rd(_i,Xi,nn.vertical,hn,en,zs,tr,Ea,$a,E.ah.vertical,["vertical"],zl,Vu,na,Kn));const Gu=va?va.boxStartIndex:_i.collisionBoxArray.length,Xl=va?va.boxEndIndex:_i.collisionBoxArray.length,uh=so?so.boxStartIndex:_i.collisionBoxArray.length,rA=so?so.boxEndIndex:_i.collisionBoxArray.length,Gp=Uo?Uo.boxStartIndex:_i.collisionBoxArray.length,Od=Uo?Uo.boxEndIndex:_i.collisionBoxArray.length,Nd=ra?ra.boxStartIndex:_i.collisionBoxArray.length,ao=ra?ra.boxEndIndex:_i.collisionBoxArray.length;let vo=-1;const Uf=(Yl,qu)=>Yl&&Yl.circleDiameter?Math.max(Yl.circleDiameter,qu):qu;vo=Uf(va,vo),vo=Uf(so,vo),vo=Uf(Uo,vo),vo=Uf(ra,vo);const qp=vo>-1?1:0;qp&&(vo*=La/cl),_i.glyphOffsetArray.length>=eA.MAX_GLYPHS&&dt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),tr.sortKey!==void 0&&_i.addToSortKeyRanges(_i.symbolInstances.length,tr.sortKey);const Um=nA(en,tr,Kn),[Hp,Gm]=function(Yl,qu){const Mh=Yl.length,Ac=qu==null?void 0:qu.values;if((Ac==null?void 0:Ac.length)>0)for(let $l=0;$l<Ac.length;$l+=2){const Hu=Ac[$l+1];Yl.emplaceBack(E.ap[Ac[$l]],Hu[0],Hu[1])}return[Mh,Yl.length]}(_i.textAnchorOffsets,Um);_i.symbolInstances.emplaceBack(Xi.x,Xi.y,zl.right>=0?zl.right:-1,zl.center>=0?zl.center:-1,zl.left>=0?zl.left:-1,zl.vertical||-1,Mu,Vu,zc,Gu,Xl,uh,rA,Gp,Od,Nd,ao,Dn,tl,il,br,yo,qp,0,Fr,vo,Hp,Gm)}(m,ui,Zt,x,M,q,$t,m.layers[0],m.collisionBoxArray,h.index,h.sourceLayerIndex,m.index,Q,[Le,Le,Le,Le],At,Ce,he,qe,gt,S,h,K,Oe,f,J)};if(Mt==="line")for(const Zt of Pd(h.geometry,0,0,Ws,Ws)){const ui=Op(Zt,_e,Je,x.vertical||L,M,24,re,m.overscaling,Ws);for(const _i of ui)L&&jA(m,L.text,Pt,_i)||Ht(Zt,_i)}else if(Mt==="line-center"){for(const Zt of h.geometry)if(Zt.length>1){const ui=Fp(Zt,Je,x.vertical||L,M,24,re);ui&&Ht(Zt,ui)}}else if(h.type==="Polygon")for(const Zt of bh(h.geometry,0)){const ui=Np(Zt,16);Ht(Zt[0],new bl(ui.x,ui.y,0))}else if(h.type==="LineString")for(const Zt of h.geometry)Ht(Zt,new bl(Zt[0].x,Zt[0].y,0));else if(h.type==="Point")for(const Zt of h.geometry)for(const ui of Zt)Ht([ui],new bl(ui.x,ui.y,0))}function Rd(m,h,x,M,q,K,J,me,Ce,Oe,f,u,p,S,L){const G=function(he,_e,Le,qe,Je,At,gt,Mt){const Pt=qe.layout.get("text-rotate").evaluate(At,{})*Math.PI/180,zt=[];for(const $t of _e.positionedLines)for(const Ht of $t.positionedGlyphs){if(!Ht.rect)continue;const Zt=Ht.rect||{};let ui=dd+1,_i=!0,Xi=1,xn=0;const nn=(Je||Mt)&&Ht.vertical,tn=Ht.metrics.advance*Ht.scale/2;if(Mt&&_e.verticalizable&&(xn=$t.lineOffset/2-(Ht.imageName?-(cl-Ht.metrics.width*Ht.scale)/2:(Ht.scale-1)*cl)),Ht.imageName){const xs=gt[Ht.imageName];_i=xs.sdf,Xi=xs.pixelRatio,ui=hl/Xi}const hn=Je?[Ht.x+tn,Ht.y]:[0,0];let zn=Je?[0,0]:[Ht.x+tn+Le[0],Ht.y+Le[1]-xn],en=[0,0];nn&&(en=zn,zn=[0,0]);const Wi=Ht.metrics.isDoubleResolution?2:1,Dn=(Ht.metrics.left-ui)*Ht.scale-tn+zn[0],Rn=(-Ht.metrics.top-ui)*Ht.scale+zn[1],dr=Dn+Zt.w/Wi*Ht.scale/Xi,Fr=Rn+Zt.h/Wi*Ht.scale/Xi,qr=new oe(Dn,Rn),zs=new oe(dr,Rn),Ea=new oe(Dn,Fr),ia=new oe(dr,Fr);if(nn){const xs=new oe(-tn,tn-LA),tr=-Math.PI/2,na=cl/2-tn,Ds=new oe(5-LA-na,-(Ht.imageName?na:0)),Kn=new oe(...en);qr._rotateAround(tr,xs)._add(Ds)._add(Kn),zs._rotateAround(tr,xs)._add(Ds)._add(Kn),Ea._rotateAround(tr,xs)._add(Ds)._add(Kn),ia._rotateAround(tr,xs)._add(Ds)._add(Kn)}if(Pt){const xs=Math.sin(Pt),tr=Math.cos(Pt),na=[tr,-xs,xs,tr];qr._matMult(na),zs._matMult(na),Ea._matMult(na),ia._matMult(na)}const is=new oe(0,0),Wn=new oe(0,0);zt.push({tl:qr,tr:zs,bl:Ea,br:ia,tex:Zt,writingMode:_e.writingMode,glyphOffset:hn,sectionIndex:Ht.sectionIndex,isSDF:_i,pixelOffsetTL:is,pixelOffsetBR:Wn,minFontScaleX:0,minFontScaleY:0})}return zt}(0,x,me,q,K,J,M,m.allowVerticalPlacement),Q=m.textSizeData;let re=null;Q.kind==="source"?(re=[Pc*q.layout.get("text-size").evaluate(J,{})],re[0]>rh&&dt(`${m.layerIds[0]}: Value for "text-size" is >= ${Th}. Reduce your "text-size".`)):Q.kind==="composite"&&(re=[Pc*S.compositeTextSizes[0].evaluate(J,{},L),Pc*S.compositeTextSizes[1].evaluate(J,{},L)],(re[0]>rh||re[1]>rh)&&dt(`${m.layerIds[0]}: Value for "text-size" is >= ${Th}. Reduce your "text-size".`)),m.addSymbols(m.text,G,re,me,K,J,Oe,h,Ce.lineStartIndex,Ce.lineLength,p,L);for(const he of f)u[he]=m.text.placedSymbolArray.length-1;return 4*G.length}function Fd(m){for(const h in m)return m[h];return null}function jA(m,h,x,M){const q=m.compareText;if(h in q){const K=q[h];for(let J=K.length-1;J>=0;J--)if(M.dist(K[J])<x)return!0}else q[h]=[];return q[h].push(M),!1}const Bl=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Bc{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[x,M]=new Uint8Array(h,0,2);if(x!==219)throw new Error("Data does not appear to be in a KDBush format.");const q=M>>4;if(q!==1)throw new Error(`Got v${q} data when expected v1.`);const K=Bl[15&M];if(!K)throw new Error("Unrecognized array type.");const[J]=new Uint16Array(h,2,1),[me]=new Uint32Array(h,4,1);return new Bc(me,J,K,h)}constructor(h,x=64,M=Float64Array,q){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+x,2),65535),this.ArrayType=M,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const K=Bl.indexOf(this.ArrayType),J=2*h*this.ArrayType.BYTES_PER_ELEMENT,me=h*this.IndexArrayType.BYTES_PER_ELEMENT,Ce=(8-me%8)%8;if(K<0)throw new Error(`Unexpected typed array class: ${M}.`);q&&q instanceof ArrayBuffer?(this.data=q,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+J+me+Ce),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+me+Ce,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+K]),new Uint16Array(this.data,2,1)[0]=x,new Uint32Array(this.data,4,1)[0]=h)}add(h,x){const M=this._pos>>1;return this.ids[M]=M,this.coords[this._pos++]=h,this.coords[this._pos++]=x,M}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return kh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,x,M,q){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:K,coords:J,nodeSize:me}=this,Ce=[0,K.length-1,0],Oe=[];for(;Ce.length;){const f=Ce.pop()||0,u=Ce.pop()||0,p=Ce.pop()||0;if(u-p<=me){for(let Q=p;Q<=u;Q++){const re=J[2*Q],he=J[2*Q+1];re>=h&&re<=M&&he>=x&&he<=q&&Oe.push(K[Q])}continue}const S=p+u>>1,L=J[2*S],G=J[2*S+1];L>=h&&L<=M&&G>=x&&G<=q&&Oe.push(K[S]),(f===0?h<=L:x<=G)&&(Ce.push(p),Ce.push(S-1),Ce.push(1-f)),(f===0?M>=L:q>=G)&&(Ce.push(S+1),Ce.push(u),Ce.push(1-f))}return Oe}within(h,x,M){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:q,coords:K,nodeSize:J}=this,me=[0,q.length-1,0],Ce=[],Oe=M*M;for(;me.length;){const f=me.pop()||0,u=me.pop()||0,p=me.pop()||0;if(u-p<=J){for(let Q=p;Q<=u;Q++)P0(K[2*Q],K[2*Q+1],h,x)<=Oe&&Ce.push(q[Q]);continue}const S=p+u>>1,L=K[2*S],G=K[2*S+1];P0(L,G,h,x)<=Oe&&Ce.push(q[S]),(f===0?h-M<=L:x-M<=G)&&(me.push(p),me.push(S-1),me.push(1-f)),(f===0?h+M>=L:x+M>=G)&&(me.push(S+1),me.push(u),me.push(1-f))}return Ce}}function kh(m,h,x,M,q,K){if(q-M<=x)return;const J=M+q>>1;ZA(m,h,J,M,q,K),kh(m,h,x,M,J-1,1-K),kh(m,h,x,J+1,q,1-K)}function ZA(m,h,x,M,q,K){for(;q>M;){if(q-M>600){const Oe=q-M+1,f=x-M+1,u=Math.log(Oe),p=.5*Math.exp(2*u/3),S=.5*Math.sqrt(u*p*(Oe-p)/Oe)*(f-Oe/2<0?-1:1);ZA(m,h,x,Math.max(M,Math.floor(x-f*p/Oe+S)),Math.min(q,Math.floor(x+(Oe-f)*p/Oe+S)),K)}const J=h[2*x+K];let me=M,Ce=q;for(QA(m,h,M,x),h[2*q+K]>J&&QA(m,h,M,q);me<Ce;){for(QA(m,h,me,Ce),me++,Ce--;h[2*me+K]<J;)me++;for(;h[2*Ce+K]>J;)Ce--}h[2*M+K]===J?QA(m,h,M,Ce):(Ce++,QA(m,h,Ce,q)),Ce<=x&&(M=Ce+1),x<=Ce&&(q=Ce-1)}}function QA(m,h,x,M){zf(m,x,M),zf(h,2*x,2*M),zf(h,2*x+1,2*M+1)}function zf(m,h,x){const M=m[h];m[h]=m[x],m[x]=M}function P0(m,h,x,M){const q=m-x,K=h-M;return q*q+K*K}var Rf;E.bc=void 0,(Rf=E.bc||(E.bc={})).create="create",Rf.load="load",Rf.fullLoad="fullLoad";let Ff=null,Of=[];const D0=1e3/60,Nf="loadTime",Vf="fullLoadTime",Up={mark(m){performance.mark(m)},frame(m){const h=m;Ff!=null&&Of.push(h-Ff),Ff=h},clearMetrics(){Ff=null,Of=[],performance.clearMeasures(Nf),performance.clearMeasures(Vf);for(const m in E.bc)performance.clearMarks(E.bc[m])},getPerformanceMetrics(){performance.measure(Nf,E.bc.create,E.bc.load),performance.measure(Vf,E.bc.create,E.bc.fullLoad);const m=performance.getEntriesByName(Nf)[0].duration,h=performance.getEntriesByName(Vf)[0].duration,x=Of.length,M=1/(Of.reduce((K,J)=>K+J,0)/x/1e3),q=Of.filter(K=>K>D0).reduce((K,J)=>K+(J-D0)/D0,0);return{loadTime:m,fullLoadTime:h,fps:M,percentDroppedFrames:q/(x+q)*100,totalFrames:x}}};E.$=Zi,E.A=Xu,E.B=function(m){if(Nt==null){const h=m.navigator?m.navigator.userAgent:null;Nt=!!m.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Nt},E.C=class{constructor(m,h){this.target=m,this.mapId=h,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Lp(()=>this.process()),this.subscription=function(x,M,q,K){return x.addEventListener(M,q,!1),{unsubscribe:()=>{x.removeEventListener(M,q,!1)}}}(this.target,"message",x=>this.receive(x)),this.globalScope=at(self)?m:window}registerMessageHandler(m,h){this.messageHandlers[m]=h}sendAsync(m,h){return new Promise((x,M)=>{const q=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[q]={resolve:x,reject:M},h&&h.signal.addEventListener("abort",()=>{delete this.resolveRejects[q];const me={id:q,type:"<cancel>",origin:location.origin,targetMapId:m.targetMapId,sourceMapId:this.mapId};this.target.postMessage(me)},{once:!0});const K=[],J=Object.assign(Object.assign({},m),{id:q,sourceMapId:this.mapId,origin:location.origin,data:Nl(m.data,K)});this.target.postMessage(J,{transfer:K})})}receive(m){const h=m.data,x=h.id;if(!(h.origin!=="file://"&&location.origin!=="file://"&&h.origin!==location.origin||h.targetMapId&&this.mapId!==h.targetMapId)){if(h.type==="<cancel>"){delete this.tasks[x];const M=this.abortControllers[x];return delete this.abortControllers[x],void(M&&M.abort())}if(at(self)||h.mustQueue)return this.tasks[x]=h,this.taskQueue.push(x),void this.invoker.trigger();this.processTask(x,h)}}process(){if(this.taskQueue.length===0)return;const m=this.taskQueue.shift(),h=this.tasks[m];delete this.tasks[m],this.taskQueue.length>0&&this.invoker.trigger(),h&&this.processTask(m,h)}processTask(m,h){return a(this,void 0,void 0,function*(){if(h.type==="<response>"){const q=this.resolveRejects[m];return delete this.resolveRejects[m],q?void(h.error?q.reject(Sn(h.error)):q.resolve(Sn(h.data))):void 0}if(!this.messageHandlers[h.type])return void this.completeTask(m,new Error(`Could not find a registered handler for ${h.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const x=Sn(h.data),M=new AbortController;this.abortControllers[m]=M;try{const q=yield this.messageHandlers[h.type](h.sourceMapId,x,M);this.completeTask(m,null,q)}catch(q){this.completeTask(m,q)}})}completeTask(m,h,x){const M=[];delete this.abortControllers[m];const q={id:m,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:h?Nl(h):null,data:Nl(x,M)};this.target.postMessage(q,{transfer:M})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.D=pn,E.E=mn,E.F=function(){var m=new Xu(16);return Xu!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0),m[0]=1,m[5]=1,m[10]=1,m[15]=1,m},E.G=sn,E.H=function(m,h,x){var M,q,K,J,me,Ce,Oe,f,u,p,S,L,G=x[0],Q=x[1],re=x[2];return h===m?(m[12]=h[0]*G+h[4]*Q+h[8]*re+h[12],m[13]=h[1]*G+h[5]*Q+h[9]*re+h[13],m[14]=h[2]*G+h[6]*Q+h[10]*re+h[14],m[15]=h[3]*G+h[7]*Q+h[11]*re+h[15]):(q=h[1],K=h[2],J=h[3],me=h[4],Ce=h[5],Oe=h[6],f=h[7],u=h[8],p=h[9],S=h[10],L=h[11],m[0]=M=h[0],m[1]=q,m[2]=K,m[3]=J,m[4]=me,m[5]=Ce,m[6]=Oe,m[7]=f,m[8]=u,m[9]=p,m[10]=S,m[11]=L,m[12]=M*G+me*Q+u*re+h[12],m[13]=q*G+Ce*Q+p*re+h[13],m[14]=K*G+Oe*Q+S*re+h[14],m[15]=J*G+f*Q+L*re+h[15]),m},E.I=_0,E.J=function(m,h,x){var M=x[0],q=x[1],K=x[2];return m[0]=h[0]*M,m[1]=h[1]*M,m[2]=h[2]*M,m[3]=h[3]*M,m[4]=h[4]*q,m[5]=h[5]*q,m[6]=h[6]*q,m[7]=h[7]*q,m[8]=h[8]*K,m[9]=h[9]*K,m[10]=h[10]*K,m[11]=h[11]*K,m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},E.K=yh,E.L=function(m,h){const x={};for(let M=0;M<h.length;M++){const q=h[M];q in m&&(x[q]=m[q])}return x},E.M=ah,E.N=wd,E.O=Sd,E.P=oe,E.Q=ku,E.R=Nu,E.S=st,E.T=gu,E.U=ut,E.V=ci,E.W=Ws,E.X=ys,E.Y=I0,E.Z=class extends ul{},E._=a,E.a=$i,E.a$=function(m,h){return m[0]*h[0]+m[1]*h[1]+m[2]*h[2]+m[3]*h[3]},E.a0=Lc,E.a1=$,E.a2=m=>{const h=window.document.createElement("video");return h.muted=!0,new Promise(x=>{h.onloadstart=()=>{x(h)};for(const M of m){const q=window.document.createElement("source");Ei(M)||(h.crossOrigin="Anonymous"),q.src=M,h.appendChild(q)}})},E.a3=function(){return it++},E.a4=s,E.a5=eA,E.a6=hs,E.a7=vl,E.a8=fs,E.a9=Td,E.aA=mt,E.aB=function(m,h){if(!m)return[{command:"setStyle",args:[h]}];let x=[];try{if(!fi(m.version,h.version))return[{command:"setStyle",args:[h]}];fi(m.center,h.center)||x.push({command:"setCenter",args:[h.center]}),fi(m.zoom,h.zoom)||x.push({command:"setZoom",args:[h.zoom]}),fi(m.bearing,h.bearing)||x.push({command:"setBearing",args:[h.bearing]}),fi(m.pitch,h.pitch)||x.push({command:"setPitch",args:[h.pitch]}),fi(m.sprite,h.sprite)||x.push({command:"setSprite",args:[h.sprite]}),fi(m.glyphs,h.glyphs)||x.push({command:"setGlyphs",args:[h.glyphs]}),fi(m.transition,h.transition)||x.push({command:"setTransition",args:[h.transition]}),fi(m.light,h.light)||x.push({command:"setLight",args:[h.light]}),fi(m.terrain,h.terrain)||x.push({command:"setTerrain",args:[h.terrain]}),fi(m.sky,h.sky)||x.push({command:"setSky",args:[h.sky]});const M={},q=[];(function(J,me,Ce,Oe){let f;for(f in me=me||{},J=J||{})Object.prototype.hasOwnProperty.call(J,f)&&(Object.prototype.hasOwnProperty.call(me,f)||On(f,Ce,Oe));for(f in me)Object.prototype.hasOwnProperty.call(me,f)&&(Object.prototype.hasOwnProperty.call(J,f)?fi(J[f],me[f])||(J[f].type==="geojson"&&me[f].type==="geojson"&&wn(J,me,f)?ln(Ce,{command:"setGeoJSONSourceData",args:[f,me[f].data]}):Qn(f,me,Ce,Oe)):pr(f,me,Ce))})(m.sources,h.sources,q,M);const K=[];m.layers&&m.layers.forEach(J=>{"source"in J&&M[J.source]?x.push({command:"removeLayer",args:[J.id]}):K.push(J)}),x=x.concat(q),function(J,me,Ce){me=me||[];const Oe=(J=J||[]).map(k),f=me.map(k),u=J.reduce(V,{}),p=me.reduce(V,{}),S=Oe.slice(),L=Object.create(null);let G,Q,re,he,_e;for(let Le=0,qe=0;Le<Oe.length;Le++)G=Oe[Le],Object.prototype.hasOwnProperty.call(p,G)?qe++:(ln(Ce,{command:"removeLayer",args:[G]}),S.splice(S.indexOf(G,qe),1));for(let Le=0,qe=0;Le<f.length;Le++)G=f[f.length-1-Le],S[S.length-1-Le]!==G&&(Object.prototype.hasOwnProperty.call(u,G)?(ln(Ce,{command:"removeLayer",args:[G]}),S.splice(S.lastIndexOf(G,S.length-qe),1)):qe++,he=S[S.length-Le],ln(Ce,{command:"addLayer",args:[p[G],he]}),S.splice(S.length-Le,0,G),L[G]=!0);for(let Le=0;Le<f.length;Le++)if(G=f[Le],Q=u[G],re=p[G],!L[G]&&!fi(Q,re))if(fi(Q.source,re.source)&&fi(Q["source-layer"],re["source-layer"])&&fi(Q.type,re.type)){for(_e in v(Q.layout,re.layout,Ce,G,null,"setLayoutProperty"),v(Q.paint,re.paint,Ce,G,null,"setPaintProperty"),fi(Q.filter,re.filter)||ln(Ce,{command:"setFilter",args:[G,re.filter]}),fi(Q.minzoom,re.minzoom)&&fi(Q.maxzoom,re.maxzoom)||ln(Ce,{command:"setLayerZoomRange",args:[G,re.minzoom,re.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,G,_e.slice(6),"setPaintProperty"):fi(Q[_e],re[_e])||ln(Ce,{command:"setLayerProperty",args:[G,_e,re[_e]]}));for(_e in re)Object.prototype.hasOwnProperty.call(re,_e)&&!Object.prototype.hasOwnProperty.call(Q,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?v(Q[_e],re[_e],Ce,G,_e.slice(6),"setPaintProperty"):fi(Q[_e],re[_e])||ln(Ce,{command:"setLayerProperty",args:[G,_e,re[_e]]}))}else ln(Ce,{command:"removeLayer",args:[G]}),he=S[S.lastIndexOf(G)+1],ln(Ce,{command:"addLayer",args:[re,he]})}(K,h.layers,x)}catch(M){console.warn("Unable to compute style diff:",M),x=[{command:"setStyle",args:[h]}]}return x},E.aC=function(m){const h=[],x=m.id;return x===void 0&&h.push({message:`layers.${x}: missing required property "id"`}),m.render===void 0&&h.push({message:`layers.${x}: missing required method "render"`}),m.renderingMode&&m.renderingMode!=="2d"&&m.renderingMode!=="3d"&&h.push({message:`layers.${x}: property "renderingMode" must be either "2d" or "3d"`}),h},E.aD=function m(h,x){if(Array.isArray(h)){if(!Array.isArray(x)||h.length!==x.length)return!1;for(let M=0;M<h.length;M++)if(!m(h[M],x[M]))return!1;return!0}if(typeof h=="object"&&h!==null&&x!==null){if(typeof x!="object"||Object.keys(h).length!==Object.keys(x).length)return!1;for(const M in h)if(!m(h[M],x[M]))return!1;return!0}return h===x},E.aE=xt,E.aF=_t,E.aG=class extends ro{constructor(m,h){super(m,h),this.current=0}set(m){this.current!==m&&(this.current=m,this.gl.uniform1i(this.location,m))}},E.aH=Gr,E.aI=class extends ro{constructor(m,h){super(m,h),this.current=_o}set(m){if(m[12]!==this.current[12]||m[0]!==this.current[0])return this.current=m,void this.gl.uniformMatrix4fv(this.location,!1,m);for(let h=1;h<16;h++)if(m[h]!==this.current[h]){this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);break}}},E.aJ=ya,E.aK=class extends ro{constructor(m,h){super(m,h),this.current=[0,0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]||(this.current=m,this.gl.uniform3f(this.location,m[0],m[1],m[2]))}},E.aL=class extends ro{constructor(m,h){super(m,h),this.current=[0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]||(this.current=m,this.gl.uniform2f(this.location,m[0],m[1]))}},E.aM=go,E.aN=function(m,h,x,M,q,K,J){var me=1/(h-x),Ce=1/(M-q),Oe=1/(K-J);return m[0]=-2*me,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=-2*Ce,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2*Oe,m[11]=0,m[12]=(h+x)*me,m[13]=(q+M)*Ce,m[14]=(J+K)*Oe,m[15]=1,m},E.aO=dn,E.aP=pA,E.aQ=class extends We{},E.aR=sd,E.aS=class extends Ct{},E.aT=function(m){return m<=1?1:Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))},E.aU=gA,E.aV=ue,E.aW=class extends F{},E.aX=Xt,E.aY=function(m,h){var x=m[0],M=m[1],q=m[2],K=m[3],J=m[4],me=m[5],Ce=m[6],Oe=m[7],f=m[8],u=m[9],p=m[10],S=m[11],L=m[12],G=m[13],Q=m[14],re=m[15],he=h[0],_e=h[1],Le=h[2],qe=h[3],Je=h[4],At=h[5],gt=h[6],Mt=h[7],Pt=h[8],zt=h[9],$t=h[10],Ht=h[11],Zt=h[12],ui=h[13],_i=h[14],Xi=h[15];return Math.abs(x-he)<=Ql*Math.max(1,Math.abs(x),Math.abs(he))&&Math.abs(M-_e)<=Ql*Math.max(1,Math.abs(M),Math.abs(_e))&&Math.abs(q-Le)<=Ql*Math.max(1,Math.abs(q),Math.abs(Le))&&Math.abs(K-qe)<=Ql*Math.max(1,Math.abs(K),Math.abs(qe))&&Math.abs(J-Je)<=Ql*Math.max(1,Math.abs(J),Math.abs(Je))&&Math.abs(me-At)<=Ql*Math.max(1,Math.abs(me),Math.abs(At))&&Math.abs(Ce-gt)<=Ql*Math.max(1,Math.abs(Ce),Math.abs(gt))&&Math.abs(Oe-Mt)<=Ql*Math.max(1,Math.abs(Oe),Math.abs(Mt))&&Math.abs(f-Pt)<=Ql*Math.max(1,Math.abs(f),Math.abs(Pt))&&Math.abs(u-zt)<=Ql*Math.max(1,Math.abs(u),Math.abs(zt))&&Math.abs(p-$t)<=Ql*Math.max(1,Math.abs(p),Math.abs($t))&&Math.abs(S-Ht)<=Ql*Math.max(1,Math.abs(S),Math.abs(Ht))&&Math.abs(L-Zt)<=Ql*Math.max(1,Math.abs(L),Math.abs(Zt))&&Math.abs(G-ui)<=Ql*Math.max(1,Math.abs(G),Math.abs(ui))&&Math.abs(Q-_i)<=Ql*Math.max(1,Math.abs(Q),Math.abs(_i))&&Math.abs(re-Xi)<=Ql*Math.max(1,Math.abs(re),Math.abs(Xi))},E.aZ=function(m,h){return m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[4]=h[4],m[5]=h[5],m[6]=h[6],m[7]=h[7],m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15],m},E.a_=function(m,h,x){return m[0]=h[0]*x[0],m[1]=h[1]*x[1],m[2]=h[2]*x[2],m[3]=h[3]*x[3],m},E.aa=function(m){const h={};if(m.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(x,M,q,K)=>{const J=q||K;return h[M]=!J||J.toLowerCase(),""}),h["max-age"]){const x=parseInt(h["max-age"],10);isNaN(x)?delete h["max-age"]:h["max-age"]=x}return h},E.ab=function(m,h){const x=[];for(const M in m)M in h||x.push(M);return x},E.ac=Rt,E.ad=function(m,h,x){var M=Math.sin(x),q=Math.cos(x),K=h[0],J=h[1],me=h[2],Ce=h[3],Oe=h[4],f=h[5],u=h[6],p=h[7];return h!==m&&(m[8]=h[8],m[9]=h[9],m[10]=h[10],m[11]=h[11],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[0]=K*q+Oe*M,m[1]=J*q+f*M,m[2]=me*q+u*M,m[3]=Ce*q+p*M,m[4]=Oe*q-K*M,m[5]=f*q-J*M,m[6]=u*q-me*M,m[7]=p*q-Ce*M,m},E.ae=function(m){var h=new Xu(16);return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h[6]=m[6],h[7]=m[7],h[8]=m[8],h[9]=m[9],h[10]=m[10],h[11]=m[11],h[12]=m[12],h[13]=m[13],h[14]=m[14],h[15]=m[15],h},E.af=lf,E.ag=function(m,h){let x=0,M=0;if(m.kind==="constant")M=m.layoutSize;else if(m.kind!=="source"){const{interpolationType:q,minZoom:K,maxZoom:J}=m,me=q?Rt(Ks.interpolationFactor(q,h,K,J),0,1):0;m.kind==="camera"?M=vr.number(m.minSize,m.maxSize,me):x=me}return{uSizeT:x,uSize:M}},E.ai=function(m,{uSize:h,uSizeT:x},{lowerSize:M,upperSize:q}){return m.kind==="source"?M/Pc:m.kind==="composite"?vr.number(M/Pc,q/Pc,x):h},E.aj=w0,E.ak=function(m,h,x,M){const q=h.y-m.y,K=h.x-m.x,J=M.y-x.y,me=M.x-x.x,Ce=J*K-me*q;if(Ce===0)return null;const Oe=(me*(m.y-x.y)-J*(m.x-x.x))/Ce;return new oe(m.x+Oe*K,m.y+Oe*q)},E.al=Pd,E.am=sf,E.an=j0,E.ao=cl,E.aq=Tf,E.ar=function(m,h){var x=h[0],M=h[1],q=h[2],K=h[3],J=h[4],me=h[5],Ce=h[6],Oe=h[7],f=h[8],u=h[9],p=h[10],S=h[11],L=h[12],G=h[13],Q=h[14],re=h[15],he=x*me-M*J,_e=x*Ce-q*J,Le=x*Oe-K*J,qe=M*Ce-q*me,Je=M*Oe-K*me,At=q*Oe-K*Ce,gt=f*G-u*L,Mt=f*Q-p*L,Pt=f*re-S*L,zt=u*Q-p*G,$t=u*re-S*G,Ht=p*re-S*Q,Zt=he*Ht-_e*$t+Le*zt+qe*Pt-Je*Mt+At*gt;return Zt?(m[0]=(me*Ht-Ce*$t+Oe*zt)*(Zt=1/Zt),m[1]=(q*$t-M*Ht-K*zt)*Zt,m[2]=(G*At-Q*Je+re*qe)*Zt,m[3]=(p*Je-u*At-S*qe)*Zt,m[4]=(Ce*Pt-J*Ht-Oe*Mt)*Zt,m[5]=(x*Ht-q*Pt+K*Mt)*Zt,m[6]=(Q*Le-L*At-re*_e)*Zt,m[7]=(f*At-p*Le+S*_e)*Zt,m[8]=(J*$t-me*Pt+Oe*gt)*Zt,m[9]=(M*Pt-x*$t-K*gt)*Zt,m[10]=(L*Je-G*Le+re*he)*Zt,m[11]=(u*Le-f*Je-S*he)*Zt,m[12]=(me*Mt-J*zt-Ce*gt)*Zt,m[13]=(x*zt-M*Mt+q*gt)*Zt,m[14]=(G*_e-L*qe-Q*he)*Zt,m[15]=(f*qe-u*_e+p*he)*Zt,m):null},E.as=M0,E.at=FA,E.au=Bc,E.av=function(){const m={},h=ti.$version;for(const x in ti.$root){const M=ti.$root[x];if(M.required){let q=null;q=x==="version"?h:M.type==="array"?[]:{},q!=null&&(m[x]=q)}}return m},E.aw=Hl,E.ax=yi,E.ay=function(m){m=m.slice();const h=Object.create(null);for(let x=0;x<m.length;x++)h[m[x].id]=m[x];for(let x=0;x<m.length;x++)"ref"in m[x]&&(m[x]=ns(m[x],h[m[x].ref]));return m},E.az=function(m){if(m.type==="custom")return new bd(m);switch(m.type){case"background":return new vd(m);case"circle":return new l0(m);case"fill":return new f0(m);case"fill-extrusion":return new Kh(m);case"heatmap":return new u0(m);case"hillshade":return new vu(m);case"line":return new Dm(m);case"raster":return new Dp(m);case"symbol":return new OA(m)}},E.b=Ft,E.b0=Ge,E.b1=Id,E.b2=Rp,E.b3=function(m,h,x,M,q){var K,J=1/Math.tan(h/2);return m[0]=J/x,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=J,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=-1,m[12]=0,m[13]=0,m[15]=0,q!=null&&q!==1/0?(m[10]=(q+M)*(K=1/(M-q)),m[14]=2*q*M*K):(m[10]=-1,m[14]=-2*M),m},E.b4=function(m,h,x){var M=Math.sin(x),q=Math.cos(x),K=h[4],J=h[5],me=h[6],Ce=h[7],Oe=h[8],f=h[9],u=h[10],p=h[11];return h!==m&&(m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[12]=h[12],m[13]=h[13],m[14]=h[14],m[15]=h[15]),m[4]=K*q+Oe*M,m[5]=J*q+f*M,m[6]=me*q+u*M,m[7]=Ce*q+p*M,m[8]=Oe*q-K*M,m[9]=f*q-J*M,m[10]=u*q-me*M,m[11]=p*q-Ce*M,m},E.b5=kt,E.b6=Bt,E.b7=function(m){return m*Math.PI/180},E.b8=function(m,h){return m[0]=h[0],m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=h[1],m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=h[2],m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},E.b9=class extends cs{},E.ba=NA,E.bb=Up,E.bd=Ti,E.be=function(m,h){$i.REGISTERED_PROTOCOLS[m]=h},E.bf=function(m){delete $i.REGISTERED_PROTOCOLS[m]},E.bg=function(m,h){const x={};for(let q=0;q<m.length;q++){const K=h&&h[m[q].id]||$o(m[q]);h&&(h[m[q].id]=K);let J=x[K];J||(J=x[K]=[]),J.push(m[q])}const M=[];for(const q in x)M.push(x[q]);return M},E.bh=bn,E.bi=Cd,E.bj=C0,E.bk=y0,E.bl=function(m){m.bucket.createArrays(),m.bucket.tilePixelRatio=Ws/(512*m.bucket.overscaling),m.bucket.compareText={},m.bucket.iconsNeedLinear=!1;const h=m.bucket.layers[0],x=h.layout,M=h._unevaluatedLayout._values,q={layoutIconSize:M["icon-size"].possiblyEvaluate(new fs(m.bucket.zoom+1),m.canonical),layoutTextSize:M["text-size"].possiblyEvaluate(new fs(m.bucket.zoom+1),m.canonical),textMaxSize:M["text-size"].possiblyEvaluate(new fs(18))};if(m.bucket.textSizeData.kind==="composite"){const{minZoom:Oe,maxZoom:f}=m.bucket.textSizeData;q.compositeTextSizes=[M["text-size"].possiblyEvaluate(new fs(Oe),m.canonical),M["text-size"].possiblyEvaluate(new fs(f),m.canonical)]}if(m.bucket.iconSizeData.kind==="composite"){const{minZoom:Oe,maxZoom:f}=m.bucket.iconSizeData;q.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new fs(Oe),m.canonical),M["icon-size"].possiblyEvaluate(new fs(f),m.canonical)]}const K=x.get("text-line-height")*cl,J=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point",me=x.get("text-keep-upright"),Ce=x.get("text-size");for(const Oe of m.bucket.features){const f=x.get("text-font").evaluate(Oe,{},m.canonical).join(","),u=Ce.evaluate(Oe,{},m.canonical),p=q.layoutTextSize.evaluate(Oe,{},m.canonical),S=q.layoutIconSize.evaluate(Oe,{},m.canonical),L={horizontal:{},vertical:void 0},G=Oe.text;let Q,re=[0,0];if(G){const Le=G.toString(),qe=x.get("text-letter-spacing").evaluate(Oe,{},m.canonical)*cl,Je=lu(Le)?qe:0,At=x.get("text-anchor").evaluate(Oe,{},m.canonical),gt=nA(h,Oe,m.canonical);if(!gt){const Ht=x.get("text-radial-offset").evaluate(Oe,{},m.canonical);re=Ht?HA(At,[Ht*cl,iA]):x.get("text-offset").evaluate(Oe,{},m.canonical).map(Zt=>Zt*cl)}let Mt=J?"center":x.get("text-justify").evaluate(Oe,{},m.canonical);const Pt=x.get("symbol-placement"),zt=Pt==="point"?x.get("text-max-width").evaluate(Oe,{},m.canonical)*cl:0,$t=()=>{m.bucket.allowVerticalPlacement&&_l(Le)&&(L.vertical=Ef(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,zt,K,At,"left",Je,re,E.ah.vertical,!0,Pt,p,u))};if(!J&&gt){const Ht=new Set;if(Mt==="auto")for(let ui=0;ui<gt.values.length;ui+=2)Ht.add(M0(gt.values[ui]));else Ht.add(Mt);let Zt=!1;for(const ui of Ht)if(!L.horizontal[ui])if(Zt)L.horizontal[ui]=L.horizontal[0];else{const _i=Ef(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,zt,K,"center",ui,Je,re,E.ah.horizontal,!1,Pt,p,u);_i&&(L.horizontal[ui]=_i,Zt=_i.positionedLines.length===1)}$t()}else{Mt==="auto"&&(Mt=M0(At));const Ht=Ef(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,zt,K,At,Mt,Je,re,E.ah.horizontal,!1,Pt,p,u);Ht&&(L.horizontal[Mt]=Ht),$t(),_l(Le)&&J&&me&&(L.vertical=Ef(G,m.glyphMap,m.glyphPositions,m.imagePositions,f,zt,K,At,Mt,Je,re,E.ah.vertical,!1,Pt,p,u))}}let he=!1;if(Oe.icon&&Oe.icon.name){const Le=m.imageMap[Oe.icon.name];Le&&(Q=Fm(m.imagePositions[Oe.icon.name],x.get("icon-offset").evaluate(Oe,{},m.canonical),x.get("icon-anchor").evaluate(Oe,{},m.canonical)),he=!!Le.sdf,m.bucket.sdfIcons===void 0?m.bucket.sdfIcons=he:m.bucket.sdfIcons!==he&&dt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==m.bucket.pixelRatio||x.get("icon-rotate").constantOr(1)!==0)&&(m.bucket.iconsNeedLinear=!0))}const _e=Fd(L.horizontal)||L.vertical;m.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||Q)&&Vp(m.bucket,Oe,L,Q,m.imageMap,q,p,S,re,he,m.canonical)}m.showCollisionBoxes&&m.bucket.generateCollisionDebugBuffers()},E.bm=Jh,E.bn=Wh,E.bo=wA,E.bp=cc,E.bq=Ad,E.br=class{constructor(m){this._marks={start:[m.url,"start"].join("#"),end:[m.url,"end"].join("#"),measure:m.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let m=performance.getEntriesByName(this._marks.measure);return m.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),m=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),m}},E.bs=function(m,h,x,M,q){return a(this,void 0,void 0,function*(){if(ut())try{return yield ci(m,h,x,M,q)}catch{}return function(K,J,me,Ce,Oe){const f=K.width,u=K.height;bi&&ki||(bi=new OffscreenCanvas(f,u),ki=bi.getContext("2d",{willReadFrequently:!0})),bi.width=f,bi.height=u,ki.drawImage(K,0,0,f,u);const p=ki.getImageData(J,me,Ce,Oe);return ki.clearRect(0,0,f,u),p.data}(m,h,x,M,q)})},E.bt=Ed,E.bu=U,E.bv=W,E.bw=ad,E.bx=ks,E.by=function(m){return m.message===Gi},E.bz=jl,E.c=rn,E.d=m=>a(void 0,void 0,void 0,function*(){if(m.byteLength===0)return createImageBitmap(new ImageData(1,1));const h=new Blob([new Uint8Array(m)],{type:"image/png"});try{return createImageBitmap(h)}catch(x){throw new Error(`Could not load image because of ${x.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),E.e=ni,E.f=m=>new Promise((h,x)=>{const M=new Image;M.onload=()=>{h(M),URL.revokeObjectURL(M.src),M.onload=null,window.requestAnimationFrame(()=>{M.src=Dt})},M.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(m)],{type:"image/png"});M.src=m.byteLength?URL.createObjectURL(q):Dt}),E.g=qi,E.h=(m,h)=>hi(ni(m,{type:"json"}),h),E.i=at,E.j=gi,E.k=_n,E.l=(m,h)=>hi(ni(m,{type:"arrayBuffer"}),h),E.m=hi,E.n=function(m){return new Ad(m).readFields(Bm,[])},E.o=Dl,E.p=DA,E.q=oa,E.r=Qu,E.s=Ei,E.t=Ml,E.u=In,E.v=ti,E.w=dt,E.x=rs,E.y=function([m,h,x]){return h+=90,h*=Math.PI/180,x*=Math.PI/180,{x:m*Math.cos(h)*Math.sin(x),y:m*Math.sin(h)*Math.sin(x),z:m*Math.cos(x)}},E.z=vr}),g("worker",["./shared"],function(E){class a{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,ne){for(const ie of se){this._layerConfigs[ie.id]=ie;const de=this._layers[ie.id]=E.az(ie);de._featureFilter=E.a6(de.filter),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of ne)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const X=E.bg(Object.values(this._layerConfigs),this.keyCache);for(const ie of X){const de=ie.map(Xe=>this._layers[Xe.id]),ye=de[0];if(ye.visibility==="none")continue;const ge=ye.source||"";let Pe=this.familiesBySource[ge];Pe||(Pe=this.familiesBySource[ge]={});const Fe=ye.sourceLayer||"_geojsonTileLayer";let Ne=Pe[Fe];Ne||(Ne=Pe[Fe]=[]),Ne.push(de)}}}class U{constructor(se){const ne={},X=[];for(const ge in se){const Pe=se[ge],Fe=ne[ge]={};for(const Ne in Pe){const Xe=Pe[+Ne];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Ye={x:0,y:0,w:Xe.bitmap.width+2,h:Xe.bitmap.height+2};X.push(Ye),Fe[Ne]={rect:Ye,metrics:Xe.metrics}}}const{w:ie,h:de}=E.p(X),ye=new E.o({width:ie||1,height:de||1});for(const ge in se){const Pe=se[ge];for(const Fe in Pe){const Ne=Pe[+Fe];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const Xe=ne[ge][Fe].rect;E.o.copy(Ne.bitmap,ye,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},Ne.bitmap)}}this.image=ye,this.positions=ne}}E.bh("GlyphAtlas",U);class W{constructor(se){this.tileID=new E.Q(se.tileID.overscaledZ,se.tileID.wrap,se.tileID.canonical.z,se.tileID.canonical.x,se.tileID.canonical.y),this.uid=se.uid,this.zoom=se.zoom,this.pixelRatio=se.pixelRatio,this.tileSize=se.tileSize,this.source=se.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=se.showCollisionBoxes,this.collectResourceTiming=!!se.collectResourceTiming,this.returnDependencies=!!se.returnDependencies,this.promoteId=se.promoteId,this.inFlightDependencies=[]}parse(se,ne,X,ie){return E._(this,void 0,void 0,function*(){this.status="parsing",this.data=se,this.collisionBoxArray=new E.a4;const de=new E.bi(Object.keys(se.layers).sort()),ye=new E.bj(this.tileID,this.promoteId);ye.bucketLayerIDs=[];const ge={},Pe={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X},Fe=ne.familiesBySource[this.source];for(const Ai in Fe){const Kt=se.layers[Ai];if(!Kt)continue;Kt.version===1&&E.w(`Vector tile source "${this.source}" layer "${Ai}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const oi=de.encode(Ai),Ri=[];for(let vi=0;vi<Kt.length;vi++){const wi=Kt.feature(vi),Yt=ye.getId(wi,Ai);Ri.push({feature:wi,id:Yt,index:vi,sourceLayerIndex:oi})}for(const vi of Fe[Ai]){const wi=vi[0];wi.source!==this.source&&E.w(`layer.source = ${wi.source} does not equal this.source = ${this.source}`),wi.minzoom&&this.zoom<Math.floor(wi.minzoom)||wi.maxzoom&&this.zoom>=wi.maxzoom||wi.visibility!=="none"&&(ce(vi,this.zoom,X),(ge[wi.id]=wi.createBucket({index:ye.bucketLayerIDs.length,layers:vi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:oi,sourceID:this.source})).populate(Ri,Pe,this.tileID.canonical),ye.bucketLayerIDs.push(vi.map(Yt=>Yt.id)))}}const Ne=E.aE(Pe.glyphDependencies,Ai=>Object.keys(Ai).map(Number));this.inFlightDependencies.forEach(Ai=>Ai==null?void 0:Ai.abort()),this.inFlightDependencies=[];let Xe=Promise.resolve({});if(Object.keys(Ne).length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),Xe=ie.sendAsync({type:"getGlyphs",data:{stacks:Ne,source:this.source,tileID:this.tileID,type:"glyphs"}},Ai)}const Ye=Object.keys(Pe.iconDependencies);let De=Promise.resolve({});if(Ye.length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),De=ie.sendAsync({type:"getImages",data:{icons:Ye,source:this.source,tileID:this.tileID,type:"icons"}},Ai)}const Ue=Object.keys(Pe.patternDependencies);let ht=Promise.resolve({});if(Ue.length){const Ai=new AbortController;this.inFlightDependencies.push(Ai),ht=ie.sendAsync({type:"getImages",data:{icons:Ue,source:this.source,tileID:this.tileID,type:"patterns"}},Ai)}const[Tt,o,ke]=yield Promise.all([Xe,De,ht]),ai=new U(Tt),di=new E.bk(o,ke);for(const Ai in ge){const Kt=ge[Ai];Kt instanceof E.a5?(ce(Kt.layers,this.zoom,X),E.bl({bucket:Kt,glyphMap:Tt,glyphPositions:ai.positions,imageMap:o,imagePositions:di.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Kt.hasPattern&&(Kt instanceof E.bm||Kt instanceof E.bn||Kt instanceof E.bo)&&(ce(Kt.layers,this.zoom,X),Kt.addFeatures(Pe,this.tileID.canonical,di.patternPositions))}return this.status="done",{buckets:Object.values(ge).filter(Ai=>!Ai.isEmpty()),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ai.image,imageAtlas:di,glyphMap:this.returnDependencies?Tt:null,iconMap:this.returnDependencies?o:null,glyphPositions:this.returnDependencies?ai.positions:null}})}}function ce(Me,se,ne){const X=new E.a8(se);for(const ie of Me)ie.recalculate(X,ne)}class oe{constructor(se,ne,X){this.actor=se,this.layerIndex=ne,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(se,ne){return E._(this,void 0,void 0,function*(){const X=yield E.l(se.request,ne);try{return{vectorTile:new E.bp.VectorTile(new E.bq(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(ie){const de=new Uint8Array(X.data);let ye=`Unable to parse the tile at ${se.request.url}, `;throw ye+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ie.messge}`,new Error(ye)}})}loadTile(se){return E._(this,void 0,void 0,function*(){const ne=se.uid,X=!!(se&&se.request&&se.request.collectResourceTiming)&&new E.br(se.request),ie=new W(se);this.loading[ne]=ie;const de=new AbortController;ie.abort=de;try{const ye=yield this.loadVectorTile(se,de);if(delete this.loading[ne],!ye)return null;const ge=ye.rawData,Pe={};ye.expires&&(Pe.expires=ye.expires),ye.cacheControl&&(Pe.cacheControl=ye.cacheControl);const Fe={};if(X){const Xe=X.finish();Xe&&(Fe.resourceTiming=JSON.parse(JSON.stringify(Xe)))}ie.vectorTile=ye.vectorTile;const Ne=ie.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[ne]=ie,this.fetching[ne]={rawTileData:ge,cacheControl:Pe,resourceTiming:Fe};try{const Xe=yield Ne;return E.e({rawTileData:ge.slice(0)},Xe,Pe,Fe)}finally{delete this.fetching[ne]}}catch(ye){throw delete this.loading[ne],ie.status="done",this.loaded[ne]=ie,ye}})}reloadTile(se){return E._(this,void 0,void 0,function*(){const ne=se.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[ne];if(X.showCollisionBoxes=se.showCollisionBoxes,X.status==="parsing"){const ie=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor);let de;if(this.fetching[ne]){const{rawTileData:ye,cacheControl:ge,resourceTiming:Pe}=this.fetching[ne];delete this.fetching[ne],de=E.e({rawTileData:ye.slice(0)},ie,ge,Pe)}else de=ie;return de}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(se){return E._(this,void 0,void 0,function*(){const ne=this.loading,X=se.uid;ne&&ne[X]&&ne[X].abort&&(ne[X].abort.abort(),delete ne[X])})}removeTile(se){return E._(this,void 0,void 0,function*(){this.loaded&&this.loaded[se.uid]&&delete this.loaded[se.uid]})}}class fe{constructor(){this.loaded={}}loadTile(se){return E._(this,void 0,void 0,function*(){const{uid:ne,encoding:X,rawImageData:ie,redFactor:de,greenFactor:ye,blueFactor:ge,baseShift:Pe}=se,Fe=ie.width+2,Ne=ie.height+2,Xe=E.b(ie)?new E.R({width:Fe,height:Ne},yield E.bs(ie,-1,-1,Fe,Ne)):ie,Ye=new E.bt(ne,Xe,X,de,ye,ge,Pe);return this.loaded=this.loaded||{},this.loaded[ne]=Ye,Ye})}removeTile(se){const ne=this.loaded,X=se.uid;ne&&ne[X]&&delete ne[X]}}function we(Me,se){if(Me.length!==0){et(Me[0],se);for(var ne=1;ne<Me.length;ne++)et(Me[ne],!se)}}function et(Me,se){for(var ne=0,X=0,ie=0,de=Me.length,ye=de-1;ie<de;ye=ie++){var ge=(Me[ie][0]-Me[ye][0])*(Me[ye][1]+Me[ie][1]),Pe=ne+ge;X+=Math.abs(ne)>=Math.abs(ge)?ne-Pe+ge:ge-Pe+ne,ne=Pe}ne+X>=0!=!!se&&Me.reverse()}var lt=E.bu(function Me(se,ne){var X,ie=se&&se.type;if(ie==="FeatureCollection")for(X=0;X<se.features.length;X++)Me(se.features[X],ne);else if(ie==="GeometryCollection")for(X=0;X<se.geometries.length;X++)Me(se.geometries[X],ne);else if(ie==="Feature")Me(se.geometry,ne);else if(ie==="Polygon")we(se.coordinates,ne);else if(ie==="MultiPolygon")for(X=0;X<se.coordinates.length;X++)we(se.coordinates[X],ne);return se});const Ke=E.bp.VectorTileFeature.prototype.toGeoJSON;var st={exports:{}},ut=E.bv,kt=E.bp.VectorTileFeature,Bt=Rt;function Rt(Me,se){this.options=se||{},this.features=Me,this.length=Me.length}function Ge(Me,se){this.id=typeof Me.id=="number"?Me.id:void 0,this.type=Me.type,this.rawGeometry=Me.type===1?[Me.geometry]:Me.geometry,this.properties=Me.tags,this.extent=se||4096}Rt.prototype.feature=function(Me){return new Ge(this.features[Me],this.options.extent)},Ge.prototype.loadGeometry=function(){var Me=this.rawGeometry;this.geometry=[];for(var se=0;se<Me.length;se++){for(var ne=Me[se],X=[],ie=0;ie<ne.length;ie++)X.push(new ut(ne[ie][0],ne[ie][1]));this.geometry.push(X)}return this.geometry},Ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Me=this.geometry,se=1/0,ne=-1/0,X=1/0,ie=-1/0,de=0;de<Me.length;de++)for(var ye=Me[de],ge=0;ge<ye.length;ge++){var Pe=ye[ge];se=Math.min(se,Pe.x),ne=Math.max(ne,Pe.x),X=Math.min(X,Pe.y),ie=Math.max(ie,Pe.y)}return[se,X,ne,ie]},Ge.prototype.toGeoJSON=kt.prototype.toGeoJSON;var ni=E.bw,it=Bt;function xt(Me){var se=new ni;return function(ne,X){for(var ie in ne.layers)X.writeMessage(3,_t,ne.layers[ie])}(Me,se),se.finish()}function _t(Me,se){var ne;se.writeVarintField(15,Me.version||1),se.writeStringField(1,Me.name||""),se.writeVarintField(5,Me.extent||4096);var X={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<Me.length;ne++)X.feature=Me.feature(ne),se.writeMessage(2,mt,X);var ie=X.keys;for(ne=0;ne<ie.length;ne++)se.writeStringField(3,ie[ne]);var de=X.values;for(ne=0;ne<de.length;ne++)se.writeMessage(4,at,de[ne])}function mt(Me,se){var ne=Me.feature;ne.id!==void 0&&se.writeVarintField(1,ne.id),se.writeMessage(2,bt,Me),se.writeVarintField(3,ne.type),se.writeMessage(4,pt,ne)}function bt(Me,se){var ne=Me.feature,X=Me.keys,ie=Me.values,de=Me.keycache,ye=Me.valuecache;for(var ge in ne.properties){var Pe=ne.properties[ge],Fe=de[ge];if(Pe!==null){Fe===void 0&&(X.push(ge),de[ge]=Fe=X.length-1),se.writeVarint(Fe);var Ne=typeof Pe;Ne!=="string"&&Ne!=="boolean"&&Ne!=="number"&&(Pe=JSON.stringify(Pe));var Xe=Ne+":"+Pe,Ye=ye[Xe];Ye===void 0&&(ie.push(Pe),ye[Xe]=Ye=ie.length-1),se.writeVarint(Ye)}}}function dt(Me,se){return(se<<3)+(7&Me)}function nt(Me){return Me<<1^Me>>31}function pt(Me,se){for(var ne=Me.loadGeometry(),X=Me.type,ie=0,de=0,ye=ne.length,ge=0;ge<ye;ge++){var Pe=ne[ge],Fe=1;X===1&&(Fe=Pe.length),se.writeVarint(dt(1,Fe));for(var Ne=X===3?Pe.length-1:Pe.length,Xe=0;Xe<Ne;Xe++){Xe===1&&X!==1&&se.writeVarint(dt(2,Ne-1));var Ye=Pe[Xe].x-ie,De=Pe[Xe].y-de;se.writeVarint(nt(Ye)),se.writeVarint(nt(De)),ie+=Ye,de+=De}X===3&&se.writeVarint(dt(7,1))}}function at(Me,se){var ne=typeof Me;ne==="string"?se.writeStringField(1,Me):ne==="boolean"?se.writeBooleanField(7,Me):ne==="number"&&(Me%1!=0?se.writeDoubleField(3,Me):Me<0?se.writeSVarintField(6,Me):se.writeVarintField(5,Me))}st.exports=xt,st.exports.fromVectorTileJs=xt,st.exports.fromGeojsonVt=function(Me,se){se=se||{};var ne={};for(var X in Me)ne[X]=new it(Me[X].features,se),ne[X].name=X,ne[X].version=se.version,ne[X].extent=se.extent;return xt({layers:ne})},st.exports.GeoJSONWrapper=it;var Nt=E.bu(st.exports);const Ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Dt=Math.fround||(ci=new Float32Array(1),Me=>(ci[0]=+Me,ci[0]));var ci;const bi=3,ki=5,Gi=6;class rn{constructor(se){this.options=Object.assign(Object.create(Ft),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:ne,minZoom:X,maxZoom:ie}=this.options;ne&&console.time("total time");const de=`prepare ${se.length} points`;ne&&console.time(de),this.points=se;const ye=[];for(let Pe=0;Pe<se.length;Pe++){const Fe=se[Pe];if(!Fe.geometry)continue;const[Ne,Xe]=Fe.geometry.coordinates,Ye=Dt(sn(Ne)),De=Dt(Ti(Xe));ye.push(Ye,De,1/0,Pe,-1,1),this.options.reduce&&ye.push(0)}let ge=this.trees[ie+1]=this._createTree(ye);ne&&console.timeEnd(de);for(let Pe=ie;Pe>=X;Pe--){const Fe=+Date.now();ge=this.trees[Pe]=this._createTree(this._cluster(ge,Pe)),ne&&console.log("z%d: %d clusters in %dms",Pe,ge.numItems,+Date.now()-Fe)}return ne&&console.timeEnd("total time"),this}getClusters(se,ne){let X=((se[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,se[1]));let de=se[2]===180?180:((se[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)X=-180,de=180;else if(X>de){const Xe=this.getClusters([X,ie,180,ye],ne),Ye=this.getClusters([-180,ie,de,ye],ne);return Xe.concat(Ye)}const ge=this.trees[this._limitZoom(ne)],Pe=ge.range(sn(X),Ti(ye),sn(de),Ti(ie)),Fe=ge.data,Ne=[];for(const Xe of Pe){const Ye=this.stride*Xe;Ne.push(Fe[Ye+ki]>1?$i(Fe,Ye,this.clusterProps):this.points[Fe[Ye+bi]])}return Ne}getChildren(se){const ne=this._getOriginId(se),X=this._getOriginZoom(se),ie="No cluster with the specified id.",de=this.trees[X];if(!de)throw new Error(ie);const ye=de.data;if(ne*this.stride>=ye.length)throw new Error(ie);const ge=this.options.radius/(this.options.extent*Math.pow(2,X-1)),Pe=de.within(ye[ne*this.stride],ye[ne*this.stride+1],ge),Fe=[];for(const Ne of Pe){const Xe=Ne*this.stride;ye[Xe+4]===se&&Fe.push(ye[Xe+ki]>1?$i(ye,Xe,this.clusterProps):this.points[ye[Xe+bi]])}if(Fe.length===0)throw new Error(ie);return Fe}getLeaves(se,ne,X){const ie=[];return this._appendLeaves(ie,se,ne=ne||10,X=X||0,0),ie}getTile(se,ne,X){const ie=this.trees[this._limitZoom(se)],de=Math.pow(2,se),{extent:ye,radius:ge}=this.options,Pe=ge/ye,Fe=(X-Pe)/de,Ne=(X+1+Pe)/de,Xe={features:[]};return this._addTileFeatures(ie.range((ne-Pe)/de,Fe,(ne+1+Pe)/de,Ne),ie.data,ne,X,de,Xe),ne===0&&this._addTileFeatures(ie.range(1-Pe/de,Fe,1,Ne),ie.data,de,X,de,Xe),ne===de-1&&this._addTileFeatures(ie.range(0,Fe,Pe/de,Ne),ie.data,-1,X,de,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(se){let ne=this._getOriginZoom(se)-1;for(;ne<=this.options.maxZoom;){const X=this.getChildren(se);if(ne++,X.length!==1)break;se=X[0].properties.cluster_id}return ne}_appendLeaves(se,ne,X,ie,de){const ye=this.getChildren(ne);for(const ge of ye){const Pe=ge.properties;if(Pe&&Pe.cluster?de+Pe.point_count<=ie?de+=Pe.point_count:de=this._appendLeaves(se,Pe.cluster_id,X,ie,de):de<ie?de++:se.push(ge),se.length===X)break}return de}_createTree(se){const ne=new E.au(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<se.length;X+=this.stride)ne.add(se[X],se[X+1]);return ne.finish(),ne.data=se,ne}_addTileFeatures(se,ne,X,ie,de,ye){for(const ge of se){const Pe=ge*this.stride,Fe=ne[Pe+ki]>1;let Ne,Xe,Ye;if(Fe)Ne=qi(ne,Pe,this.clusterProps),Xe=ne[Pe],Ye=ne[Pe+1];else{const ht=this.points[ne[Pe+bi]];Ne=ht.properties;const[Tt,o]=ht.geometry.coordinates;Xe=sn(Tt),Ye=Ti(o)}const De={type:1,geometry:[[Math.round(this.options.extent*(Xe*de-X)),Math.round(this.options.extent*(Ye*de-ie))]],tags:Ne};let Ue;Ue=Fe||this.options.generateId?ne[Pe+bi]:this.points[ne[Pe+bi]].id,Ue!==void 0&&(De.id=Ue),ye.features.push(De)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,ne){const{radius:X,extent:ie,reduce:de,minPoints:ye}=this.options,ge=X/(ie*Math.pow(2,ne)),Pe=se.data,Fe=[],Ne=this.stride;for(let Xe=0;Xe<Pe.length;Xe+=Ne){if(Pe[Xe+2]<=ne)continue;Pe[Xe+2]=ne;const Ye=Pe[Xe],De=Pe[Xe+1],Ue=se.within(Pe[Xe],Pe[Xe+1],ge),ht=Pe[Xe+ki];let Tt=ht;for(const o of Ue){const ke=o*Ne;Pe[ke+2]>ne&&(Tt+=Pe[ke+ki])}if(Tt>ht&&Tt>=ye){let o,ke=Ye*ht,ai=De*ht,di=-1;const Ai=((Xe/Ne|0)<<5)+(ne+1)+this.points.length;for(const Kt of Ue){const oi=Kt*Ne;if(Pe[oi+2]<=ne)continue;Pe[oi+2]=ne;const Ri=Pe[oi+ki];ke+=Pe[oi]*Ri,ai+=Pe[oi+1]*Ri,Pe[oi+4]=Ai,de&&(o||(o=this._map(Pe,Xe,!0),di=this.clusterProps.length,this.clusterProps.push(o)),de(o,this._map(Pe,oi)))}Pe[Xe+4]=Ai,Fe.push(ke/Tt,ai/Tt,1/0,Ai,-1,Tt),de&&Fe.push(di)}else{for(let o=0;o<Ne;o++)Fe.push(Pe[Xe+o]);if(Tt>1)for(const o of Ue){const ke=o*Ne;if(!(Pe[ke+2]<=ne)){Pe[ke+2]=ne;for(let ai=0;ai<Ne;ai++)Fe.push(Pe[ke+ai])}}}}return Fe}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,ne,X){if(se[ne+ki]>1){const ye=this.clusterProps[se[ne+Gi]];return X?Object.assign({},ye):ye}const ie=this.points[se[ne+bi]].properties,de=this.options.map(ie);return X&&de===ie?Object.assign({},de):de}}function $i(Me,se,ne){return{type:"Feature",id:Me[se+bi],properties:qi(Me,se,ne),geometry:{type:"Point",coordinates:[(X=Me[se],360*(X-.5)),yi(Me[se+1])]}};var X}function qi(Me,se,ne){const X=Me[se+ki],ie=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,de=Me[se+Gi],ye=de===-1?{}:Object.assign({},ne[de]);return Object.assign(ye,{cluster:!0,cluster_id:Me[se+bi],point_count:X,point_count_abbreviated:ie})}function sn(Me){return Me/360+.5}function Ti(Me){const se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function yi(Me){const se=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function hi(Me,se,ne,X){for(var ie,de=X,ye=ne-se>>1,ge=ne-se,Pe=Me[se],Fe=Me[se+1],Ne=Me[ne],Xe=Me[ne+1],Ye=se+3;Ye<ne;Ye+=3){var De=Ei(Me[Ye],Me[Ye+1],Pe,Fe,Ne,Xe);if(De>de)ie=Ye,de=De;else if(De===de){var Ue=Math.abs(Ye-ye);Ue<ge&&(ie=Ye,ge=Ue)}}de>X&&(ie-se>3&&hi(Me,se,ie,X),Me[ie+2]=de,ne-ie>3&&hi(Me,ie,ne,X))}function Ei(Me,se,ne,X,ie,de){var ye=ie-ne,ge=de-X;if(ye!==0||ge!==0){var Pe=((Me-ne)*ye+(se-X)*ge)/(ye*ye+ge*ge);Pe>1?(ne=ie,X=de):Pe>0&&(ne+=ye*Pe,X+=ge*Pe)}return(ye=Me-ne)*ye+(ge=se-X)*ge}function Li(Me,se,ne,X){var ie={id:Me===void 0?null:Me,type:se,geometry:ne,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var ye=de.geometry,ge=de.type;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")fn(de,ye);else if(ge==="Polygon"||ge==="MultiLineString")for(var Pe=0;Pe<ye.length;Pe++)fn(de,ye[Pe]);else if(ge==="MultiPolygon")for(Pe=0;Pe<ye.length;Pe++)for(var Fe=0;Fe<ye[Pe].length;Fe++)fn(de,ye[Pe][Fe])}(ie),ie}function fn(Me,se){for(var ne=0;ne<se.length;ne+=3)Me.minX=Math.min(Me.minX,se[ne]),Me.minY=Math.min(Me.minY,se[ne+1]),Me.maxX=Math.max(Me.maxX,se[ne]),Me.maxY=Math.max(Me.maxY,se[ne+1])}function _n(Me,se,ne,X){if(se.geometry){var ie=se.geometry.coordinates,de=se.geometry.type,ye=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),ge=[],Pe=se.id;if(ne.promoteId?Pe=se.properties[ne.promoteId]:ne.generateId&&(Pe=X||0),de==="Point")gi(ie,ge);else if(de==="MultiPoint")for(var Fe=0;Fe<ie.length;Fe++)gi(ie[Fe],ge);else if(de==="LineString")mn(ie,ge,ye,!1);else if(de==="MultiLineString"){if(ne.lineMetrics){for(Fe=0;Fe<ie.length;Fe++)mn(ie[Fe],ge=[],ye,!1),Me.push(Li(Pe,"LineString",ge,se.properties));return}ti(ie,ge,ye,!1)}else if(de==="Polygon")ti(ie,ge,ye,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(Fe=0;Fe<se.geometry.geometries.length;Fe++)_n(Me,{id:Pe,geometry:se.geometry.geometries[Fe],properties:se.properties},ne,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Fe=0;Fe<ie.length;Fe++){var Ne=[];ti(ie[Fe],Ne,ye,!0),ge.push(Ne)}}Me.push(Li(Pe,de,ge,se.properties))}}function gi(Me,se){se.push(Mn(Me[0])),se.push(ns(Me[1])),se.push(0)}function mn(Me,se,ne,X){for(var ie,de,ye=0,ge=0;ge<Me.length;ge++){var Pe=Mn(Me[ge][0]),Fe=ns(Me[ge][1]);se.push(Pe),se.push(Fe),se.push(0),ge>0&&(ye+=X?(ie*Fe-Pe*de)/2:Math.sqrt(Math.pow(Pe-ie,2)+Math.pow(Fe-de,2))),ie=Pe,de=Fe}var Ne=se.length-3;se[2]=1,hi(se,0,Ne,ne),se[Ne+2]=1,se.size=Math.abs(ye),se.start=0,se.end=se.size}function ti(Me,se,ne,X){for(var ie=0;ie<Me.length;ie++){var de=[];mn(Me[ie],de,ne,X),se.push(de)}}function Mn(Me){return Me/360+.5}function ns(Me){var se=Math.sin(Me*Math.PI/180),ne=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return ne<0?0:ne>1?1:ne}function fi(Me,se,ne,X,ie,de,ye,ge){if(X/=se,de>=(ne/=se)&&ye<X)return Me;if(ye<ne||de>=X)return null;for(var Pe=[],Fe=0;Fe<Me.length;Fe++){var Ne=Me[Fe],Xe=Ne.geometry,Ye=Ne.type,De=ie===0?Ne.minX:Ne.minY,Ue=ie===0?Ne.maxX:Ne.maxY;if(De>=ne&&Ue<X)Pe.push(Ne);else if(!(Ue<ne||De>=X)){var ht=[];if(Ye==="Point"||Ye==="MultiPoint")ln(Xe,ht,ne,X,ie);else if(Ye==="LineString")pr(Xe,ht,ne,X,ie,!1,ge.lineMetrics);else if(Ye==="MultiLineString")Qn(Xe,ht,ne,X,ie,!1);else if(Ye==="Polygon")Qn(Xe,ht,ne,X,ie,!0);else if(Ye==="MultiPolygon")for(var Tt=0;Tt<Xe.length;Tt++){var o=[];Qn(Xe[Tt],o,ne,X,ie,!0),o.length&&ht.push(o)}if(ht.length){if(ge.lineMetrics&&Ye==="LineString"){for(Tt=0;Tt<ht.length;Tt++)Pe.push(Li(Ne.id,Ye,ht[Tt],Ne.tags));continue}Ye!=="LineString"&&Ye!=="MultiLineString"||(ht.length===1?(Ye="LineString",ht=ht[0]):Ye="MultiLineString"),Ye!=="Point"&&Ye!=="MultiPoint"||(Ye=ht.length===3?"Point":"MultiPoint"),Pe.push(Li(Ne.id,Ye,ht,Ne.tags))}}}return Pe.length?Pe:null}function ln(Me,se,ne,X,ie){for(var de=0;de<Me.length;de+=3){var ye=Me[de+ie];ye>=ne&&ye<=X&&(se.push(Me[de]),se.push(Me[de+1]),se.push(Me[de+2]))}}function pr(Me,se,ne,X,ie,de,ye){for(var ge,Pe,Fe=On(Me),Ne=ie===0?v:k,Xe=Me.start,Ye=0;Ye<Me.length-3;Ye+=3){var De=Me[Ye],Ue=Me[Ye+1],ht=Me[Ye+2],Tt=Me[Ye+3],o=Me[Ye+4],ke=ie===0?De:Ue,ai=ie===0?Tt:o,di=!1;ye&&(ge=Math.sqrt(Math.pow(De-Tt,2)+Math.pow(Ue-o,2))),ke<ne?ai>ne&&(Pe=Ne(Fe,De,Ue,Tt,o,ne),ye&&(Fe.start=Xe+ge*Pe)):ke>X?ai<X&&(Pe=Ne(Fe,De,Ue,Tt,o,X),ye&&(Fe.start=Xe+ge*Pe)):wn(Fe,De,Ue,ht),ai<ne&&ke>=ne&&(Pe=Ne(Fe,De,Ue,Tt,o,ne),di=!0),ai>X&&ke<=X&&(Pe=Ne(Fe,De,Ue,Tt,o,X),di=!0),!de&&di&&(ye&&(Fe.end=Xe+ge*Pe),se.push(Fe),Fe=On(Me)),ye&&(Xe+=ge)}var Ai=Me.length-3;De=Me[Ai],Ue=Me[Ai+1],ht=Me[Ai+2],(ke=ie===0?De:Ue)>=ne&&ke<=X&&wn(Fe,De,Ue,ht),Ai=Fe.length-3,de&&Ai>=3&&(Fe[Ai]!==Fe[0]||Fe[Ai+1]!==Fe[1])&&wn(Fe,Fe[0],Fe[1],Fe[2]),Fe.length&&se.push(Fe)}function On(Me){var se=[];return se.size=Me.size,se.start=Me.start,se.end=Me.end,se}function Qn(Me,se,ne,X,ie,de){for(var ye=0;ye<Me.length;ye++)pr(Me[ye],se,ne,X,ie,de,!1)}function wn(Me,se,ne,X){Me.push(se),Me.push(ne),Me.push(X)}function v(Me,se,ne,X,ie,de){var ye=(de-se)/(X-se);return Me.push(de),Me.push(ne+(ie-ne)*ye),Me.push(1),ye}function k(Me,se,ne,X,ie,de){var ye=(de-ne)/(ie-ne);return Me.push(se+(X-se)*ye),Me.push(de),Me.push(1),ye}function V(Me,se){for(var ne=[],X=0;X<Me.length;X++){var ie,de=Me[X],ye=de.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")ie=$(de.geometry,se);else if(ye==="MultiLineString"||ye==="Polygon"){ie=[];for(var ge=0;ge<de.geometry.length;ge++)ie.push($(de.geometry[ge],se))}else if(ye==="MultiPolygon")for(ie=[],ge=0;ge<de.geometry.length;ge++){for(var Pe=[],Fe=0;Fe<de.geometry[ge].length;Fe++)Pe.push($(de.geometry[ge][Fe],se));ie.push(Pe)}ne.push(Li(de.id,ye,ie,de.tags))}return ne}function $(Me,se){var ne=[];ne.size=Me.size,Me.start!==void 0&&(ne.start=Me.start,ne.end=Me.end);for(var X=0;X<Me.length;X+=3)ne.push(Me[X]+se,Me[X+1],Me[X+2]);return ne}function te(Me,se){if(Me.transformed)return Me;var ne,X,ie,de=1<<Me.z,ye=Me.x,ge=Me.y;for(ne=0;ne<Me.features.length;ne++){var Pe=Me.features[ne],Fe=Pe.geometry,Ne=Pe.type;if(Pe.geometry=[],Ne===1)for(X=0;X<Fe.length;X+=2)Pe.geometry.push(Ae(Fe[X],Fe[X+1],se,de,ye,ge));else for(X=0;X<Fe.length;X++){var Xe=[];for(ie=0;ie<Fe[X].length;ie+=2)Xe.push(Ae(Fe[X][ie],Fe[X][ie+1],se,de,ye,ge));Pe.geometry.push(Xe)}}return Me.transformed=!0,Me}function Ae(Me,se,ne,X,ie,de){return[Math.round(ne*(Me*X-ie)),Math.round(ne*(se*X-de))]}function ve(Me,se,ne,X,ie){for(var de=se===ie.maxZoom?0:ie.tolerance/((1<<se)*ie.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:X,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ge=0;ge<Me.length;ge++){ye.numFeatures++,Ie(ye,Me[ge],de,ie);var Pe=Me[ge].minX,Fe=Me[ge].minY,Ne=Me[ge].maxX,Xe=Me[ge].maxY;Pe<ye.minX&&(ye.minX=Pe),Fe<ye.minY&&(ye.minY=Fe),Ne>ye.maxX&&(ye.maxX=Ne),Xe>ye.maxY&&(ye.maxY=Xe)}return ye}function Ie(Me,se,ne,X){var ie=se.geometry,de=se.type,ye=[];if(de==="Point"||de==="MultiPoint")for(var ge=0;ge<ie.length;ge+=3)ye.push(ie[ge]),ye.push(ie[ge+1]),Me.numPoints++,Me.numSimplified++;else if(de==="LineString")Ee(ye,ie,Me,ne,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(ge=0;ge<ie.length;ge++)Ee(ye,ie[ge],Me,ne,de==="Polygon",ge===0);else if(de==="MultiPolygon")for(var Pe=0;Pe<ie.length;Pe++){var Fe=ie[Pe];for(ge=0;ge<Fe.length;ge++)Ee(ye,Fe[ge],Me,ne,!0,ge===0)}if(ye.length){var Ne=se.tags||null;if(de==="LineString"&&X.lineMetrics){for(var Xe in Ne={},se.tags)Ne[Xe]=se.tags[Xe];Ne.mapbox_clip_start=ie.start/ie.size,Ne.mapbox_clip_end=ie.end/ie.size}var Ye={geometry:ye,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Ne};se.id!==null&&(Ye.id=se.id),Me.features.push(Ye)}}function Ee(Me,se,ne,X,ie,de){var ye=X*X;if(X>0&&se.size<(ie?ye:X))ne.numPoints+=se.length/3;else{for(var ge=[],Pe=0;Pe<se.length;Pe+=3)(X===0||se[Pe+2]>ye)&&(ne.numSimplified++,ge.push(se[Pe]),ge.push(se[Pe+1])),ne.numPoints++;ie&&function(Fe,Ne){for(var Xe=0,Ye=0,De=Fe.length,Ue=De-2;Ye<De;Ue=Ye,Ye+=2)Xe+=(Fe[Ye]-Fe[Ue])*(Fe[Ye+1]+Fe[Ue+1]);if(Xe>0===Ne)for(Ye=0,De=Fe.length;Ye<De/2;Ye+=2){var ht=Fe[Ye],Tt=Fe[Ye+1];Fe[Ye]=Fe[De-2-Ye],Fe[Ye+1]=Fe[De-1-Ye],Fe[De-2-Ye]=ht,Fe[De-1-Ye]=Tt}}(ge,de),Me.push(ge)}}function ze(Me,se){var ne=(se=this.options=function(ie,de){for(var ye in de)ie[ye]=de[ye];return ie}(Object.create(this.options),se)).debug;if(ne&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var X=function(ie,de){var ye=[];if(ie.type==="FeatureCollection")for(var ge=0;ge<ie.features.length;ge++)_n(ye,ie.features[ge],de,ge);else _n(ye,ie.type==="Feature"?ie:{geometry:ie},de);return ye}(Me,se);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),X=function(ie,de){var ye=de.buffer/de.extent,ge=ie,Pe=fi(ie,1,-1-ye,ye,0,-1,2,de),Fe=fi(ie,1,1-ye,2+ye,0,-1,2,de);return(Pe||Fe)&&(ge=fi(ie,1,-ye,1+ye,0,-1,2,de)||[],Pe&&(ge=V(Pe,1).concat(ge)),Fe&&(ge=ge.concat(V(Fe,-1)))),ge}(X,se),X.length&&this.splitTile(X,0,0,0),ne&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Qe(Me,se,ne){return 32*((1<<Me)*ne+se)+Me}function He(Me,se){return se?Me.properties[se]:Me.id}function Ze(Me,se){if(Me==null)return!0;if(Me.type==="Feature")return He(Me,se)!=null;if(Me.type==="FeatureCollection"){const ne=new Set;for(const X of Me.features){const ie=He(X,se);if(ie==null||ne.has(ie))return!1;ne.add(ie)}return!0}return!1}function Ve(Me,se){const ne=new Map;if(Me!=null)if(Me.type==="Feature")ne.set(He(Me,se),Me);else for(const X of Me.features)ne.set(He(X,se),X);return ne}ze.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ze.prototype.splitTile=function(Me,se,ne,X,ie,de,ye){for(var ge=[Me,se,ne,X],Pe=this.options,Fe=Pe.debug;ge.length;){X=ge.pop(),ne=ge.pop(),se=ge.pop(),Me=ge.pop();var Ne=1<<se,Xe=Qe(se,ne,X),Ye=this.tiles[Xe];if(!Ye&&(Fe>1&&console.time("creation"),Ye=this.tiles[Xe]=ve(Me,se,ne,X,Pe),this.tileCoords.push({z:se,x:ne,y:X}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,ne,X,Ye.numFeatures,Ye.numPoints,Ye.numSimplified),console.timeEnd("creation"));var De="z"+se;this.stats[De]=(this.stats[De]||0)+1,this.total++}if(Ye.source=Me,ie){if(se===Pe.maxZoom||se===ie)continue;var Ue=1<<ie-se;if(ne!==Math.floor(de/Ue)||X!==Math.floor(ye/Ue))continue}else if(se===Pe.indexMaxZoom||Ye.numPoints<=Pe.indexMaxPoints)continue;if(Ye.source=null,Me.length!==0){Fe>1&&console.time("clipping");var ht,Tt,o,ke,ai,di,Ai=.5*Pe.buffer/Pe.extent,Kt=.5-Ai,oi=.5+Ai,Ri=1+Ai;ht=Tt=o=ke=null,ai=fi(Me,Ne,ne-Ai,ne+oi,0,Ye.minX,Ye.maxX,Pe),di=fi(Me,Ne,ne+Kt,ne+Ri,0,Ye.minX,Ye.maxX,Pe),Me=null,ai&&(ht=fi(ai,Ne,X-Ai,X+oi,1,Ye.minY,Ye.maxY,Pe),Tt=fi(ai,Ne,X+Kt,X+Ri,1,Ye.minY,Ye.maxY,Pe),ai=null),di&&(o=fi(di,Ne,X-Ai,X+oi,1,Ye.minY,Ye.maxY,Pe),ke=fi(di,Ne,X+Kt,X+Ri,1,Ye.minY,Ye.maxY,Pe),di=null),Fe>1&&console.timeEnd("clipping"),ge.push(ht||[],se+1,2*ne,2*X),ge.push(Tt||[],se+1,2*ne,2*X+1),ge.push(o||[],se+1,2*ne+1,2*X),ge.push(ke||[],se+1,2*ne+1,2*X+1)}}},ze.prototype.getTile=function(Me,se,ne){var X=this.options,ie=X.extent,de=X.debug;if(Me<0||Me>24)return null;var ye=1<<Me,ge=Qe(Me,se=(se%ye+ye)%ye,ne);if(this.tiles[ge])return te(this.tiles[ge],ie);de>1&&console.log("drilling down to z%d-%d-%d",Me,se,ne);for(var Pe,Fe=Me,Ne=se,Xe=ne;!Pe&&Fe>0;)Fe--,Ne=Math.floor(Ne/2),Xe=Math.floor(Xe/2),Pe=this.tiles[Qe(Fe,Ne,Xe)];return Pe&&Pe.source?(de>1&&console.log("found parent tile z%d-%d-%d",Fe,Ne,Xe),de>1&&console.time("drilling down"),this.splitTile(Pe.source,Fe,Ne,Xe,Me,se,ne),de>1&&console.timeEnd("drilling down"),this.tiles[ge]?te(this.tiles[ge],ie):null):null};class ft extends oe{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(se,ne){return E._(this,void 0,void 0,function*(){const X=se.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ie=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!ie)return null;const de=new class{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.W,this.length=ge.length,this._features=ge}feature(ge){return new class{constructor(Pe){this._feature=Pe,this.extent=E.W,this.type=Pe.type,this.properties=Pe.tags,"id"in Pe&&!isNaN(Pe.id)&&(this.id=parseInt(Pe.id,10))}loadGeometry(){if(this._feature.type===1){const Pe=[];for(const Fe of this._feature.geometry)Pe.push([new E.P(Fe[0],Fe[1])]);return Pe}{const Pe=[];for(const Fe of this._feature.geometry){const Ne=[];for(const Xe of Fe)Ne.push(new E.P(Xe[0],Xe[1]));Pe.push(Ne)}return Pe}}toGeoJSON(Pe,Fe,Ne){return Ke.call(this,Pe,Fe,Ne)}}(this._features[ge])}}(ie.features);let ye=Nt(de);return ye.byteOffset===0&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),{vectorTile:de,rawData:ye.buffer}})}loadData(se){var ne;return E._(this,void 0,void 0,function*(){(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const X=!!(se&&se.request&&se.request.collectResourceTiming)&&new E.br(se.request);this._pendingRequest=new AbortController;try{let ie=yield this.loadGeoJSON(se,this._pendingRequest);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(lt(ie,!0),se.filter){const ye=E.bx(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(Pe=>ye.value.evaluate({zoom:0},Pe))}}this._geoJSONIndex=se.cluster?new rn(function({superclusterOptions:ye,clusterProperties:ge}){if(!ge||!ye)return ye;const Pe={},Fe={},Ne={accumulated:null,zoom:0},Xe={properties:null},Ye=Object.keys(ge);for(const De of Ye){const[Ue,ht]=ge[De],Tt=E.bx(ht),o=E.bx(typeof Ue=="string"?[Ue,["accumulated"],["get",De]]:Ue);Pe[De]=Tt.value,Fe[De]=o.value}return ye.map=De=>{Xe.properties=De;const Ue={};for(const ht of Ye)Ue[ht]=Pe[ht].evaluate(Ne,Xe);return Ue},ye.reduce=(De,Ue)=>{Xe.properties=Ue;for(const ht of Ye)Ne.accumulated=De[ht],De[ht]=Fe[ht].evaluate(Ne,Xe)},ye}(se)).load(ie.features):function(ye,ge){return new ze(ye,ge)}(ie,se.geojsonVtOptions),this.loaded={};const de={};if(X){const ye=X.finish();ye&&(de.resourceTiming={},de.resourceTiming[se.source]=JSON.parse(JSON.stringify(ye)))}return de}catch(ie){if(delete this._pendingRequest,E.by(ie))return{abandoned:!0};throw ie}})}reloadTile(se){const ne=this.loaded;return ne&&ne[se.uid]?super.reloadTile(se):this.loadTile(se)}loadGeoJSON(se,ne){return E._(this,void 0,void 0,function*(){const{promoteId:X}=se;if(se.request){const ie=yield E.h(se.request,ne);return this._dataUpdateable=Ze(ie.data,X)?Ve(ie.data,X):void 0,ie.data}if(typeof se.data=="string")try{const ie=JSON.parse(se.data);return this._dataUpdateable=Ze(ie,X)?Ve(ie,X):void 0,ie}catch{throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`)}if(!se.dataDiff)throw new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${se.source}`);return function(ie,de,ye){var ge,Pe,Fe,Ne;if(de.removeAll&&ie.clear(),de.remove)for(const Xe of de.remove)ie.delete(Xe);if(de.add)for(const Xe of de.add){const Ye=He(Xe,ye);Ye!=null&&ie.set(Ye,Xe)}if(de.update)for(const Xe of de.update){let Ye=ie.get(Xe.id);if(Ye==null)continue;const De=!Xe.removeAllProperties&&(((ge=Xe.removeProperties)===null||ge===void 0?void 0:ge.length)>0||((Pe=Xe.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0);if((Xe.newGeometry||Xe.removeAllProperties||De)&&(Ye=Object.assign({},Ye),ie.set(Xe.id,Ye),De&&(Ye.properties=Object.assign({},Ye.properties))),Xe.newGeometry&&(Ye.geometry=Xe.newGeometry),Xe.removeAllProperties)Ye.properties={};else if(((Fe=Xe.removeProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const Ue of Xe.removeProperties)Object.prototype.hasOwnProperty.call(Ye.properties,Ue)&&delete Ye.properties[Ue];if(((Ne=Xe.addOrUpdateProperties)===null||Ne===void 0?void 0:Ne.length)>0)for(const{key:Ue,value:ht}of Xe.addOrUpdateProperties)Ye.properties[Ue]=ht}}(this._dataUpdateable,se.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(se){return E._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(se){return this._geoJSONIndex.getClusterExpansionZoom(se.clusterId)}getClusterChildren(se){return this._geoJSONIndex.getChildren(se.clusterId)}getClusterLeaves(se){return this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset)}}class rt{constructor(se){this.self=se,this.actor=new E.C(se),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,X)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=X},this.self.addProtocol=E.be,this.self.removeProtocol=E.bf,this.self.registerRTLTextPlugin=ne=>{if(E.bz.isParsed())throw new Error("RTL text plugin already registered.");E.bz.setMethods(ne)},this.actor.registerMessageHandler("loadDEMTile",(ne,X)=>this._getDEMWorkerSource(ne,X.source).loadTile(X)),this.actor.registerMessageHandler("removeDEMTile",(ne,X)=>E._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,X.source).removeTile(X)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(ne,X)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,X.type,X.source).getClusterExpansionZoom(X)})),this.actor.registerMessageHandler("getClusterChildren",(ne,X)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,X.type,X.source).getClusterChildren(X)})),this.actor.registerMessageHandler("getClusterLeaves",(ne,X)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,X.type,X.source).getClusterLeaves(X)})),this.actor.registerMessageHandler("loadData",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).loadData(X)),this.actor.registerMessageHandler("loadTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).loadTile(X)),this.actor.registerMessageHandler("reloadTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).reloadTile(X)),this.actor.registerMessageHandler("abortTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).abortTile(X)),this.actor.registerMessageHandler("removeTile",(ne,X)=>this._getWorkerSource(ne,X.type,X.source).removeTile(X)),this.actor.registerMessageHandler("removeSource",(ne,X)=>E._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][X.type]||!this.workerSources[ne][X.type][X.source])return;const ie=this.workerSources[ne][X.type][X.source];delete this.workerSources[ne][X.type][X.source],ie.removeSource!==void 0&&ie.removeSource(X)})),this.actor.registerMessageHandler("removeMap",ne=>E._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("setReferrer",(ne,X)=>E._(this,void 0,void 0,function*(){this.referrer=X})),this.actor.registerMessageHandler("syncRTLPluginState",(ne,X)=>this._syncRTLPluginState(ne,X)),this.actor.registerMessageHandler("importScript",(ne,X)=>E._(this,void 0,void 0,function*(){this.self.importScripts(X)})),this.actor.registerMessageHandler("setImages",(ne,X)=>this._setImages(ne,X)),this.actor.registerMessageHandler("updateLayers",(ne,X)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(X.layers,X.removedIds)})),this.actor.registerMessageHandler("setLayers",(ne,X)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(X)}))}_setImages(se,ne){return E._(this,void 0,void 0,function*(){this.availableImages[se]=ne;for(const X in this.workerSources[se]){const ie=this.workerSources[se][X];for(const de in ie)ie[de].availableImages=ne}})}_syncRTLPluginState(se,ne){return E._(this,void 0,void 0,function*(){E.bz.setState(ne);const X=E.bz.getPluginURL();if(ne.pluginStatus==="loaded"&&!E.bz.isParsed()&&X!=null){this.self.importScripts(X);const ie=E.bz.isParsed();if(ie)return ie;throw new Error(`RTL Text Plugin failed to import scripts from ${X}`)}return!1})}_getAvailableImages(se){let ne=this.availableImages[se];return ne||(ne=[]),ne}_getLayerIndex(se){let ne=this.layerIndexes[se];return ne||(ne=this.layerIndexes[se]=new a),ne}_getWorkerSource(se,ne,X){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][ne]||(this.workerSources[se][ne]={}),!this.workerSources[se][ne][X]){const ie={sendAsync:(de,ye)=>(de.targetMapId=se,this.actor.sendAsync(de,ye))};switch(ne){case"vector":this.workerSources[se][ne][X]=new oe(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;case"geojson":this.workerSources[se][ne][X]=new ft(ie,this._getLayerIndex(se),this._getAvailableImages(se));break;default:this.workerSources[se][ne][X]=new this.externalWorkerSourceTypes[ne](ie,this._getLayerIndex(se),this._getAvailableImages(se))}}return this.workerSources[se][ne][X]}_getDEMWorkerSource(se,ne){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][ne]||(this.demWorkerSources[se][ne]=new fe),this.demWorkerSources[se][ne]}}return E.i(self)&&(self.worker=new rt(self)),rt}),g("index",["exports","./shared"],function(E,a){var U="4.1.0";let W,ce;const oe={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((s,i)=>{const r=requestAnimationFrame(s);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),i(a.c())})}),getImageData(y,s=0){return this.getImageCanvasContext(y).getImageData(-s,-s,y.width+2*s,y.height+2*s)},getImageCanvasContext(y){const s=window.document.createElement("canvas"),i=s.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return s.width=y.width,s.height=y.height,i.drawImage(y,0,0,y.width,y.height),i},resolveURL:y=>(W||(W=document.createElement("a")),W.href=y,W.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ce==null&&(ce=matchMedia("(prefers-reduced-motion: reduce)")),ce.matches)}};class fe{static testProp(s){if(!fe.docStyle)return s[0];for(let i=0;i<s.length;i++)if(s[i]in fe.docStyle)return s[i];return s[0]}static create(s,i,r){const l=window.document.createElement(s);return i!==void 0&&(l.className=i),r&&r.appendChild(l),l}static createNS(s,i){return window.document.createElementNS(s,i)}static disableDrag(){fe.docStyle&&fe.selectProp&&(fe.userSelect=fe.docStyle[fe.selectProp],fe.docStyle[fe.selectProp]="none")}static enableDrag(){fe.docStyle&&fe.selectProp&&(fe.docStyle[fe.selectProp]=fe.userSelect)}static setTransform(s,i){s.style[fe.transformProp]=i}static addEventListener(s,i,r,l={}){s.addEventListener(i,r,"passive"in l?l:l.capture)}static removeEventListener(s,i,r,l={}){s.removeEventListener(i,r,"passive"in l?l:l.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",fe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",fe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",fe.suppressClickInternal,!0)},0)}static getScale(s){const i=s.getBoundingClientRect();return{x:i.width/s.offsetWidth||1,y:i.height/s.offsetHeight||1,boundingClientRect:i}}static getPoint(s,i,r){const l=i.boundingClientRect;return new a.P((r.clientX-l.left)/i.x-s.clientLeft,(r.clientY-l.top)/i.y-s.clientTop)}static mousePos(s,i){const r=fe.getScale(s);return fe.getPoint(s,r,i)}static touchPos(s,i){const r=[],l=fe.getScale(s);for(let d=0;d<i.length;d++)r.push(fe.getPoint(s,l,i[d]));return r}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}fe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,fe.selectProp=fe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),fe.transformProp=fe.testProp(["transform","WebkitTransform"]);const we={supported:!1,testSupport:function(y){!Ke&&lt&&(st?ut(y):et=y)}};let et,lt,Ke=!1,st=!1;function ut(y){const s=y.createTexture();y.bindTexture(y.TEXTURE_2D,s);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,lt),y.isContextLost())return;we.supported=!0}catch{}y.deleteTexture(s),Ke=!0}var kt,Bt;typeof document<"u"&&(lt=document.createElement("img"),lt.onload=function(){et&&ut(et),et=null,st=!0},lt.onerror=function(){Ke=!0,et=null},lt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let s,i,r,l;y.resetRequestQueue=()=>{s=[],i=0,r=0,l={}},y.addThrottleControl=T=>{const B=r++;return l[B]=T,B},y.removeThrottleControl=T=>{delete l[T],_()},y.getImage=(T,B,j=!0)=>new Promise((Y,ue)=>{we.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),a.e(T,{type:"image"}),s.push({abortController:B,requestParameters:T,supportImageRefresh:j,state:"queued",onError:Se=>{ue(Se)},onSuccess:Se=>{Y(Se)}}),_()});const d=T=>a._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:B,supportImageRefresh:j,onError:Y,onSuccess:ue,abortController:Se}=T,Te=j===!1&&!a.i(self)&&!a.g(B.url)&&(!B.headers||Object.keys(B.headers).reduce(($e,vt)=>$e&&vt==="accept",!0));i++;const Re=Te?w(B,Se):a.m(B,Se);try{const $e=yield Re;delete T.abortController,T.state="completed",$e.data instanceof HTMLImageElement||a.b($e.data)?ue($e):$e.data&&ue({data:yield(Be=$e.data,typeof createImageBitmap=="function"?a.d(Be):a.f(Be)),cacheControl:$e.cacheControl,expires:$e.expires})}catch($e){delete T.abortController,Y($e)}finally{i--,_()}var Be}),_=()=>{const T=(()=>{for(const B of Object.keys(l))if(l[B]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let B=i;B<T&&s.length>0;B++){const j=s.shift();j.abortController.signal.aborted?B--:d(j)}},w=(T,B)=>new Promise((j,Y)=>{const ue=new Image,Se=T.url,Te=T.credentials;Te&&Te==="include"?ue.crossOrigin="use-credentials":(Te&&Te==="same-origin"||!a.s(Se))&&(ue.crossOrigin="anonymous"),B.signal.addEventListener("abort",()=>{ue.src="",Y(a.c())}),ue.fetchPriority="high",ue.onload=()=>{ue.onerror=ue.onload=null,j({data:ue})},ue.onerror=()=>{ue.onerror=ue.onload=null,B.signal.aborted||Y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ue.src=Se})}(kt||(kt={})),kt.resetRequestQueue(),function(y){y.Glyphs="Glyphs",y.Image="Image",y.Source="Source",y.SpriteImage="SpriteImage",y.SpriteJSON="SpriteJSON",y.Style="Style",y.Tile="Tile",y.Unknown="Unknown"}(Bt||(Bt={}));class Rt{constructor(s){this._transformRequestFn=s}transformRequest(s,i){return this._transformRequestFn&&this._transformRequestFn(s,i)||{url:s}}normalizeSpriteURL(s,i,r){const l=function(d){const _=d.match(Ge);if(!_)throw new Error(`Unable to parse URL "${d}"`);return{protocol:_[1],authority:_[2],path:_[3]||"/",params:_[4]?_[4].split("&"):[]}}(s);return l.path+=`${i}${r}`,function(d){const _=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${_}`}(l)}setTransformRequest(s){this._transformRequestFn=s}}const Ge=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ni(y){var s=new a.A(3);return s[0]=y[0],s[1]=y[1],s[2]=y[2],s}var it,xt=function(y,s,i){return y[0]=s[0]-i[0],y[1]=s[1]-i[1],y[2]=s[2]-i[2],y};it=new a.A(3),a.A!=Float32Array&&(it[0]=0,it[1]=0,it[2]=0);var _t=function(y){var s=y[0],i=y[1];return s*s+i*i};function mt(y){const s=[];if(typeof y=="string")s.push({id:"default",url:y});else if(y&&y.length>0){const i=[];for(const{id:r,url:l}of y){const d=`${r}${l}`;i.indexOf(d)===-1&&(i.push(d),s.push({id:r,url:l}))}}return s}(function(){var y=new a.A(2);a.A!=Float32Array&&(y[0]=0,y[1]=0)})();class bt{constructor(s,i,r,l){this.context=s,this.format=r,this.texture=s.gl.createTexture(),this.update(i,l)}update(s,i,r){const{width:l,height:d}=s,_=!(this.size&&this.size[0]===l&&this.size[1]===d||r),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(i&&i.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!i||i.premultiply!==!1)),_)this.size=[l,d],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,s):T.texImage2D(T.TEXTURE_2D,0,this.format,l,d,0,this.format,T.UNSIGNED_BYTE,s.data);else{const{x:B,y:j}=r||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.b(s)?T.texSubImage2D(T.TEXTURE_2D,0,B,j,T.RGBA,T.UNSIGNED_BYTE,s):T.texSubImage2D(T.TEXTURE_2D,0,B,j,l,d,T.RGBA,T.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(s,i,r){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),r!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=d.LINEAR),s!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,r||s),this.filter=s),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function dt(y){const{userImage:s}=y;return!!(s&&s.render&&s.render())&&(y.data.replace(new Uint8Array(s.data.buffer)),!0)}class nt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:i,promiseResolve:r}of this.requestors)r(this._getImagesForIds(i));this.requestors=[]}}getImage(s){const i=this.images[s];if(i&&!i.data&&i.spriteData){const r=i.spriteData;i.data=new a.R({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),i.spriteData=null}return i}addImage(s,i){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,i)&&(this.images[s]=i)}_validate(s,i){let r=!0;const l=i.data||i.spriteData;return this._validateStretch(i.stretchX,l&&l.width)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,l&&l.height)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new a.j(new Error(`Image "${s}" has invalid "content" value`))),r=!1),r}_validateStretch(s,i){if(!s)return!0;let r=0;for(const l of s){if(l[0]<r||l[1]<l[0]||i<l[1])return!1;r=l[1]}return!0}_validateContent(s,i){if(!s)return!0;if(s.length!==4)return!1;const r=i.spriteData,l=r&&r.width||i.data.width,d=r&&r.height||i.data.height;return!(s[0]<0||l<s[0]||s[1]<0||d<s[1]||s[2]<0||l<s[2]||s[3]<0||d<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,i,r=!0){const l=this.getImage(s);if(r&&(l.data.width!==i.data.width||l.data.height!==i.data.height))throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=l.version+1,this.images[s]=i,this.updatedImages[s]=!0}removeImage(s){const i=this.images[s];delete this.images[s],delete this.patterns[s],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s){return new Promise((i,r)=>{let l=!0;if(!this.isLoaded())for(const d of s)this.images[d]||(l=!1);this.isLoaded()||l?i(this._getImagesForIds(s)):this.requestors.push({ids:s,promiseResolve:i})})}_getImagesForIds(s){const i={};for(const r of s){let l=this.getImage(r);l||(this.fire(new a.k("styleimagemissing",{id:r})),l=this.getImage(r)),l?i[r]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:!!(l.userImage&&l.userImage.render)}:a.w(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:s,height:i}=this.atlasImage;return{width:s,height:i}}getPattern(s){const i=this.patterns[s],r=this.getImage(s);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{const l={w:r.data.width+2,h:r.data.height+2,x:0,y:0},d=new a.I(l,r);this.patterns[s]={bin:l,position:d}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const i=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new bt(s,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const d in this.patterns)s.push(this.patterns[d].bin);const{w:i,h:r}=a.p(s),l=this.atlasImage;l.resize({width:i||1,height:r||1});for(const d in this.patterns){const{bin:_}=this.patterns[d],w=_.x+1,T=_.y+1,B=this.getImage(d).data,j=B.width,Y=B.height;a.R.copy(B,l,{x:0,y:0},{x:w,y:T},{width:j,height:Y}),a.R.copy(B,l,{x:0,y:Y-1},{x:w,y:T-1},{width:j,height:1}),a.R.copy(B,l,{x:0,y:0},{x:w,y:T+Y},{width:j,height:1}),a.R.copy(B,l,{x:j-1,y:0},{x:w-1,y:T},{width:1,height:Y}),a.R.copy(B,l,{x:0,y:0},{x:w+j,y:T},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const i of s){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const r=this.getImage(i);r||a.w(`Image with ID: "${i}" was not found`),dt(r)&&this.updateImage(i,r)}}}const pt=1e20;function at(y,s,i,r,l,d,_,w,T){for(let B=s;B<s+r;B++)Nt(y,i*d+B,d,l,_,w,T);for(let B=i;B<i+l;B++)Nt(y,B*d+s,1,r,_,w,T)}function Nt(y,s,i,r,l,d,_){d[0]=0,_[0]=-pt,_[1]=pt,l[0]=y[s];for(let w=1,T=0,B=0;w<r;w++){l[w]=y[s+w*i];const j=w*w;do{const Y=d[T];B=(l[w]-l[Y]+j-Y*Y)/(w-Y)/2}while(B<=_[T]&&--T>-1);T++,d[T]=w,_[T]=B,_[T+1]=pt}for(let w=0,T=0;w<r;w++){for(;_[T+1]<w;)T++;const B=d[T],j=w-B;y[s+w*i]=l[B]+j*j}}class Ft{constructor(s,i){this.requestManager=s,this.localIdeographFontFamily=i,this.entries={}}setURL(s){this.url=s}getGlyphs(s){return a._(this,void 0,void 0,function*(){const i=[];for(const d in s)for(const _ of s[d])i.push(this._getAndCacheGlyphsPromise(d,_));const r=yield Promise.all(i),l={};for(const{stack:d,id:_,glyph:w}of r)l[d]||(l[d]={}),l[d][_]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return l})}_getAndCacheGlyphsPromise(s,i){return a._(this,void 0,void 0,function*(){let r=this.entries[s];r||(r=this.entries[s]={glyphs:{},requests:{},ranges:{}});let l=r.glyphs[i];if(l!==void 0)return{stack:s,id:i,glyph:l};if(l=this._tinySDF(r,s,i),l)return r.glyphs[i]=l,{stack:s,id:i,glyph:l};const d=Math.floor(i/256);if(256*d>65535)throw new Error("glyphs > 65535 not supported");if(r.ranges[d])return{stack:s,id:i,glyph:l};if(!this.url)throw new Error("glyphsUrl is not set");if(!r.requests[d]){const w=Ft.loadGlyphRange(s,d,this.url,this.requestManager);r.requests[d]=w}const _=yield r.requests[d];for(const w in _)this._doesCharSupportLocalGlyph(+w)||(r.glyphs[+w]=_[+w]);return r.ranges[d]=!0,{stack:s,id:i,glyph:_[i]||null}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](s)||a.u["Hangul Syllables"](s)||a.u.Hiragana(s)||a.u.Katakana(s))}_tinySDF(s,i,r){const l=this.localIdeographFontFamily;if(!l||!this._doesCharSupportLocalGlyph(r))return;let d=s.tinySDF;if(!d){let w="400";/bold/i.test(i)?w="900":/medium/i.test(i)?w="500":/light/i.test(i)&&(w="200"),d=s.tinySDF=new Ft.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:w})}const _=d.draw(String.fromCharCode(r));return{id:r,bitmap:new a.o({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ft.loadGlyphRange=function(y,s,i,r){return a._(this,void 0,void 0,function*(){const l=256*s,d=l+255,_=r.transformRequest(i.replace("{fontstack}",y).replace("{range}",`${l}-${d}`),Bt.Glyphs),w=yield a.l(_,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${s}, ${l}-${d}`);const T={};for(const B of a.n(w.data))T[B.id]=B;return T})},Ft.TinySDF=class{constructor({fontSize:y=24,buffer:s=3,radius:i=8,cutoff:r=.25,fontFamily:l="sans-serif",fontWeight:d="normal",fontStyle:_="normal"}={}){this.buffer=s,this.cutoff=r,this.radius=i;const w=this.size=y+4*s,T=this._createCanvas(w),B=this.ctx=T.getContext("2d",{willReadFrequently:!0});B.font=`${_} ${d} ${y}px ${l}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(y){const s=document.createElement("canvas");return s.width=s.height=y,s}draw(y){const{width:s,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:l,actualBoundingBoxRight:d}=this.ctx.measureText(y),_=Math.ceil(i),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-l))),T=Math.min(this.size-this.buffer,_+Math.ceil(r)),B=w+2*this.buffer,j=T+2*this.buffer,Y=Math.max(B*j,0),ue=new Uint8ClampedArray(Y),Se={data:ue,width:B,height:j,glyphWidth:w,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:s};if(w===0||T===0)return Se;const{ctx:Te,buffer:Re,gridInner:Be,gridOuter:$e}=this;Te.clearRect(Re,Re,w,T),Te.fillText(y,Re,Re+_);const vt=Te.getImageData(Re,Re,w,T);$e.fill(pt,0,Y),Be.fill(0,0,Y);for(let ot=0;ot<T;ot++)for(let ct=0;ct<w;ct++){const Et=vt.data[4*(ot*w+ct)+3]/255;if(Et===0)continue;const wt=(ot+Re)*B+ct+Re;if(Et===1)$e[wt]=0,Be[wt]=pt;else{const ri=.5-Et;$e[wt]=ri>0?ri*ri:0,Be[wt]=ri<0?ri*ri:0}}at($e,0,0,B,j,B,this.f,this.v,this.z),at(Be,Re,Re,w,T,B,this.f,this.v,this.z);for(let ot=0;ot<Y;ot++){const ct=Math.sqrt($e[ot])-Math.sqrt(Be[ot]);ue[ot]=Math.round(255-255*(ct/this.radius+this.cutoff))}return Se}};class Dt{constructor(){this.specification=a.v.light.position}possiblyEvaluate(s,i){return a.y(s.expression.evaluate(i))}interpolate(s,i,r){return{x:a.z.number(s.x,i.x,r),y:a.z.number(s.y,i.y,r),z:a.z.number(s.z,i.z,r)}}}let ci;class bi extends a.E{constructor(s){super(),ci=ci||new a.q({anchor:new a.D(a.v.light.anchor),position:new Dt,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(ci),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,i={}){if(!this._validate(a.r,s,i))for(const r in s){const l=s[r];r.endsWith("-transition")?this._transitionable.setTransition(r.slice(0,-11),l):this._transitionable.setValue(r,l)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,i,r){return(!r||r.validate!==!1)&&a.t(this,s.call(a.x,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}class ki{constructor(s,i){this.width=s,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,i){const r=s.join(",")+String(i);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(s,i)),this.dashEntry[r]}getDashRanges(s,i,r){const l=[];let d=s.length%2==1?-s[s.length-1]*r:0,_=s[0]*r,w=!0;l.push({left:d,right:_,isDash:w,zeroLength:s[0]===0});let T=s[0];for(let B=1;B<s.length;B++){w=!w;const j=s[B];d=T*r,T+=j,_=T*r,l.push({left:d,right:_,isDash:w,zeroLength:j===0})}return l}addRoundDash(s,i,r){const l=i/2;for(let d=-r;d<=r;d++){const _=this.width*(this.nextRow+r+d);let w=0,T=s[w];for(let B=0;B<this.width;B++){B/T.right>1&&(T=s[++w]);const j=Math.abs(B-T.left),Y=Math.abs(B-T.right),ue=Math.min(j,Y);let Se;const Te=d/r*(l+1);if(T.isDash){const Re=l-Math.abs(Te);Se=Math.sqrt(ue*ue+Re*Re)}else Se=l-Math.sqrt(ue*ue+Te*Te);this.data[_+B]=Math.max(0,Math.min(255,Se+128))}}}addRegularDash(s){for(let w=s.length-1;w>=0;--w){const T=s[w],B=s[w+1];T.zeroLength?s.splice(w,1):B&&B.isDash===T.isDash&&(B.left=T.left,s.splice(w,1))}const i=s[0],r=s[s.length-1];i.isDash===r.isDash&&(i.left=r.left-this.width,r.right=i.right+this.width);const l=this.width*this.nextRow;let d=0,_=s[d];for(let w=0;w<this.width;w++){w/_.right>1&&(_=s[++d]);const T=Math.abs(w-_.left),B=Math.abs(w-_.right),j=Math.min(T,B);this.data[l+w]=Math.max(0,Math.min(255,(_.isDash?j:-j)+128))}}addDash(s,i){const r=i?7:0,l=2*r+1;if(this.nextRow+l>this.height)return a.w("LineAtlas out of space"),null;let d=0;for(let w=0;w<s.length;w++)d+=s[w];if(d!==0){const w=this.width/d,T=this.getDashRanges(s,this.width,w);i?this.addRoundDash(T,w,r):this.addRegularDash(T)}const _={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:d};return this.nextRow+=l,this.dirty=!0,_}bind(s){const i=s.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const Gi="maplibre_preloaded_worker_pool";class rn{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<rn.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Gi]}numActive(){return Object.keys(this.active).length}}const $i=Math.floor(oe.hardwareConcurrency/2);let qi,sn;function Ti(){return qi||(qi=new rn),qi}rn.workerCount=a.B(globalThis)?Math.max(Math.min($i,3),1):1;class yi{constructor(s,i){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=i;const r=this.workerPool.acquire(i);for(let l=0;l<r.length;l++){const d=new a.C(r[l],i);d.name=`Worker ${l}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,i){const r=[];for(const l of this.actors)r.push(l.sendAsync({type:s,data:i}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}registerMessageHandler(s,i){for(const r of this.actors)r.registerMessageHandler(s,i)}}function hi(){return sn||(sn=new yi(Ti(),a.G),sn.registerMessageHandler("getResource",(y,s,i)=>a.m(s,i))),sn}function Ei(y,s){const i=a.F();return a.H(i,i,[1,1,0]),a.J(i,i,[.5*y.width,.5*y.height,1]),a.K(i,i,y.calculatePosMatrix(s.toUnwrapped()))}function Li(y,s,i,r,l,d){const _=function(Y,ue,Se){if(Y)for(const Te of Y){const Re=ue[Te];if(Re&&Re.source===Se&&Re.type==="fill-extrusion")return!0}else for(const Te in ue){const Re=ue[Te];if(Re.source===Se&&Re.type==="fill-extrusion")return!0}return!1}(l&&l.layers,s,y.id),w=d.maxPitchScaleFactor(),T=y.tilesIn(r,w,_);T.sort(fn);const B=[];for(const Y of T)B.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(s,i,y._state,Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,l,d,w,Ei(y.transform,Y.tileID))});const j=function(Y){const ue={},Se={};for(const Te of Y){const Re=Te.queryResults,Be=Te.wrappedTileID,$e=Se[Be]=Se[Be]||{};for(const vt in Re){const ot=Re[vt],ct=$e[vt]=$e[vt]||{},Et=ue[vt]=ue[vt]||[];for(const wt of ot)ct[wt.featureIndex]||(ct[wt.featureIndex]=!0,Et.push(wt))}}return ue}(B);for(const Y in j)j[Y].forEach(ue=>{const Se=ue.feature,Te=y.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Te});return j}function fn(y,s){const i=y.tileID,r=s.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}function _n(y,s,i){return a._(this,void 0,void 0,function*(){let r=y;if(y.url?r=(yield a.h(s.transformRequest(y.url,Bt.Source),i)).data:yield oe.frameAsync(i),!r)return null;const l=a.L(a.e(r,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(l.vectorLayerIds=r.vector_layers.map(d=>d.id)),l})}class gi{constructor(s,i){s&&(i?this.setSouthWest(s).setNorthEast(i):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}setSouthWest(s){return this._sw=s instanceof a.M?new a.M(s.lng,s.lat):a.M.convert(s),this}extend(s){const i=this._sw,r=this._ne;let l,d;if(s instanceof a.M)l=s,d=s;else{if(!(s instanceof gi))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(gi.convert(s)):this.extend(a.M.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(a.M.convert(s)):this;if(l=s._sw,d=s._ne,!l||!d)return this}return i||r?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),r.lng=Math.max(d.lng,r.lng),r.lat=Math.max(d.lat,r.lat)):(this._sw=new a.M(l.lng,l.lat),this._ne=new a.M(d.lng,d.lat)),this}getCenter(){return new a.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.M(this.getWest(),this.getNorth())}getSouthEast(){return new a.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:i,lat:r}=a.M.convert(s);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&l}static convert(s){return s instanceof gi?s:s&&new gi(s)}static fromLngLat(s,i=0){const r=360*i/40075017,l=r/Math.cos(Math.PI/180*s.lat);return new gi(new a.M(s.lng-l,s.lat-r),new a.M(s.lng+l,s.lat+r))}}class mn{constructor(s,i,r){this.bounds=gi.convert(this.validateBounds(s)),this.minzoom=i||0,this.maxzoom=r||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const i=Math.pow(2,s.z),r=Math.floor(a.N(this.bounds.getWest())*i),l=Math.floor(a.O(this.bounds.getNorth())*i),d=Math.ceil(a.N(this.bounds.getEast())*i),_=Math.ceil(a.O(this.bounds.getSouth())*i);return s.x>=r&&s.x<d&&s.y>=l&&s.y<_}}class ti extends a.E{constructor(s,i,r,l){if(super(),this.id=s,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.L(i,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(l)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield _n(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s&&(a.e(this,s),s.bounds&&(this.tileBounds=new mn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.abort(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(i,Bt.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let l="reloadTile";if(s.actor&&s.state!=="expired"){if(s.state==="loading")return new Promise((d,_)=>{s.reloadPromise={resolve:d,reject:_}})}else s.actor=this.dispatcher.getActor(),l="loadTile";s.abortController=new AbortController;try{const d=yield s.actor.sendAsync({type:l,data:r},s.abortController);if(delete s.abortController,s.aborted)return;this._afterTileLoadWorkerResponse(s,d)}catch(d){if(delete s.abortController,s.aborted)return;if(d&&d.status!==404)throw d;this._afterTileLoadWorkerResponse(s,null)}})}_afterTileLoadWorkerResponse(s,i){if(i&&i.resourceTiming&&(s.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&s.setExpiryData(i),s.loadVectorData(i,this.map.painter),s.reloadPromise){const r=s.reloadPromise;s.reloadPromise=null,this.loadTile(s).then(r.resolve).catch(r.reject)}}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.actor&&(yield s.actor.sendAsync({type:"abortTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),s.actor&&(yield s.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Mn extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.setEventedParent(l),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},i),a.e(this,a.L(i,["url","scheme","tileSize"]))}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield _n(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(a.e(this,s),s.bounds&&(this.tileBounds=new mn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))}catch(s){this._tileJSONRequest=null,this.fire(new a.j(s))}})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}serialize(){return a.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.abortController=new AbortController;try{const r=yield kt.getImage(this.map._requestManager.transformRequest(i,Bt.Tile),s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&s.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const l=this.map.painter.context,d=l.gl,_=r.data;s.texture=this.map.painter.getTileTexture(_.width),s.texture?s.texture.update(_,{useMipmap:!0}):(s.texture=new bt(l,_,d.RGBA,{useMipmap:!0}),s.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax)),s.state="loaded"}}catch(r){if(delete s.abortController,s.aborted)s.state="unloaded";else if(r)throw s.state="errored",r}})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController)})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.texture&&this.map.painter.saveTileTexture(s.texture)})}hasTransition(){return!1}}class ns extends Mn{constructor(s,i,r,l){super(s,i,r,l),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(i,Bt.Tile);s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.abortController=new AbortController;try{const l=yield kt.getImage(r,s.abortController,this.map._refreshExpiredTiles);if(delete s.abortController,s.aborted)return void(s.state="unloaded");if(l&&l.data){const d=l.data;this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&s.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const _=a.b(d)&&a.S()?d:yield this.readImageNow(d),w={type:this.type,uid:s.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!s.actor||s.state==="expired"){s.actor=this.dispatcher.getActor();const T=yield s.actor.sendAsync({type:"loadDEMTile",data:w});s.dem=T,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded"}}}catch(l){if(delete s.abortController,s.aborted)s.state="unloaded";else if(l)throw s.state="errored",l}})}readImageNow(s){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.U()){const i=s.width+2,r=s.height+2;try{return new a.R({width:i,height:r},yield a.V(s,-1,-1,i,r))}catch{}}return oe.getImageData(s,1)})}_getNeighboringTiles(s){const i=s.canonical,r=Math.pow(2,i.z),l=(i.x-1+r)%r,d=i.x===0?s.wrap-1:s.wrap,_=(i.x+1+r)%r,w=i.x+1===r?s.wrap+1:s.wrap,T={};return T[new a.Q(s.overscaledZ,d,i.z,l,i.y).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y).key]={backfilled:!1},i.y>0&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y-1).key]={backfilled:!1}),i.y+1<r&&(T[new a.Q(s.overscaledZ,d,i.z,l,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,s.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},T[new a.Q(s.overscaledZ,w,i.z,_,i.y+1).key]={backfilled:!1}),T}unloadTile(s){return a._(this,void 0,void 0,function*(){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&(yield s.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:s.uid,source:this.id}}))})}}class fi extends a.E{constructor(s,i,r,l){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(l),this._data=i.data,this._options=a.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const d=a.W/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*d,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*d,extent:a.W,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.W,radius:(i.clusterRadius||50)*d,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:s,source:this.id}})}getClusterChildren(s){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:s,source:this.id}})}getClusterLeaves(s,i,r){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:s,limit:i,offset:r}})}_updateWorkerData(s){return a._(this,void 0,void 0,function*(){const i=a.e({type:this.type},this.workerOptions);s?i.dataDiff=s:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(oe.resolveURL(this._data),Bt.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"}));try{const r=yield this.actor.sendAsync({type:"loadData",data:i});if(this._pendingLoads--,this._removed||r.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let l=null;r.resourceTiming&&r.resourceTiming[this.id]&&(l=r.resourceTiming[this.id].slice(0));const d={dataType:"source"};this._collectResourceTiming&&l&&l.length>0&&a.e(d,{resourceTiming:l}),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},d),{sourceDataType:"content"})))}catch(r){if(this._pendingLoads--,this._removed)return void this.fire(new a.k("dataabort",{dataType:"source"}));this.fire(new a.j(r))}})}loaded(){return this._pendingLoads===0}loadTile(s){return a._(this,void 0,void 0,function*(){const i=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const r={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.abortController=new AbortController;const l=yield this.actor.sendAsync({type:i,data:r},s.abortController);delete s.abortController,s.unloadVectorData(),s.aborted||s.loadVectorData(l,this.map.painter,i==="reloadTile")})}abortTile(s){return a._(this,void 0,void 0,function*(){s.abortController&&(s.abortController.abort(),delete s.abortController),s.aborted=!0})}unloadTile(s){return a._(this,void 0,void 0,function*(){s.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:s.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ln=a.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class pr extends a.E{constructor(s,i,r,l){super(),this.id=s,this.dispatcher=r,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(l),this.options=i}load(s){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield kt.getImage(this.map._requestManager.transformRequest(this.url,Bt.Image),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,s&&(this.coordinates=s),this._finishLoading())}catch(i){this._request=null,this.fire(new a.j(i))}})}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=s.url,this.load(s.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(s){this.coordinates=s;const i=s.map(a.Y.fromLngLat);this.tileID=function(l){let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const ue of l)d=Math.min(d,ue.x),_=Math.min(_,ue.y),w=Math.max(w,ue.x),T=Math.max(T,ue.y);const B=Math.max(w-d,T-_),j=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),Y=Math.pow(2,j);return new a.a0(j,Math.floor((d+w)/2*Y),Math.floor((_+T)/2*Y))}(i),this.minzoom=this.maxzoom=this.tileID.z;const r=i.map(l=>this.tileID.getTilePoint(l)._round());return this._boundsArray=new a.Z,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,a.W,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,a.W),this._boundsArray.emplaceBack(r[2].x,r[2].y,a.W,a.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,ln.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new bt(s,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(s){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={}):s.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class On extends pr{constructor(s,i,r,l){super(s,i,r,l),this.roundZoom=!0,this.type="video",this.options=i}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const s=this.options;this.urls=[];for(const i of s.urls)this.urls.push(this.map._requestManager.transformRequest(i,Bt.Source).url);try{const i=yield a.a2(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new a.j(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const i=this.video.seekable;s<i.start(0)||s>i.end(0)?this.fire(new a.j(new a.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,ln.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new bt(s,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Qn extends pr{constructor(s,i,r,l){super(s,i,r,l),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(_=>typeof _!="number"))||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new a.j(new a.a1(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.a1(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.a1(`sources.${s}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,r=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,ln.members)),this.boundsSegments||(this.boundsSegments=a.$.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new bt(i,this.canvas,r.RGBA,{premultiply:!0});let l=!1;for(const d in this.tiles){const _=this.tiles[d];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,l=!0)}l&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const wn={},v=y=>{switch(y){case"geojson":return fi;case"image":return pr;case"raster":return Mn;case"raster-dem":return ns;case"vector":return ti;case"video":return On;case"canvas":return Qn}return wn[y]};class k extends a.E{constructor(){super(...arguments),this.pluginStatus="unavailable",this.pluginURL=null,this.dispatcher=hi(),this.queue=[]}_sendPluginStateToWorker(){return a._(this,void 0,void 0,function*(){yield this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}),this.fire(new a.k("pluginStateChange",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}))})}getRTLTextPluginStatus(){return this.pluginStatus}clearRTLTextPlugin(){this.pluginStatus="unavailable",this.pluginURL=null}setRTLTextPlugin(s,i=!1){return a._(this,void 0,void 0,function*(){if(this.pluginStatus==="deferred"||this.pluginStatus==="loading"||this.pluginStatus==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");this.pluginURL=oe.resolveURL(s),this.pluginStatus="deferred",yield this._sendPluginStateToWorker(),i||(yield this._downloadRTLTextPlugin())})}_downloadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){if(this.pluginStatus!=="deferred"||!this.pluginURL)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");try{this.pluginStatus="loading",yield this._sendPluginStateToWorker(),yield a.l({url:this.pluginURL},new AbortController),this.pluginStatus="loaded"}catch{this.pluginStatus="error"}yield this._sendPluginStateToWorker()})}lazyLoadRTLTextPlugin(){return a._(this,void 0,void 0,function*(){this.pluginStatus==="deferred"&&(yield this._downloadRTLTextPlugin())})}}let V=null;function $(){return V||(V=new k),V}class te{constructor(s,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=a.a3(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const i=s+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,i,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(l,d){const _={};if(!d)return _;for(const w of l){const T=w.layerIds.map(B=>d.getLayer(B)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(B=>T.filter(j=>j.id===B)[0]));for(const B of T)_[B.id]=w}}return _}(s.buckets,i.style),this.hasSymbolBuckets=!1;for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const l in this.buckets){const d=this.buckets[l];if(d instanceof a.a5&&d.hasRTLText){this.hasRTLText=!0,$().lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const l in this.buckets){const d=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(l).queryRadius(d))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new a.a4}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const r in this.buckets){const l=this.buckets[r];l.uploadPending()&&l.upload(s)}const i=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new bt(s,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new bt(s,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,i,r,l,d,_,w,T,B,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:d,scale:_,tileSize:this.tileSize,pixelPosMatrix:j,transform:T,params:w,queryPadding:this.queryPadding*B},s,i,r):{}}querySourceFeatures(s,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const l=r.loadVTLayers(),d=i&&i.sourceLayer?i.sourceLayer:"",_=l._geojsonTileLayer||l[d];if(!_)return;const w=a.a6(i&&i.filter),{z:T,x:B,y:j}=this.tileID.canonical,Y={z:T,x:B,y:j};for(let ue=0;ue<_.length;ue++){const Se=_.feature(ue);if(w.needGeometry){const Be=a.a7(Se,!0);if(!w.filter(new a.a8(this.tileID.overscaledZ),Be,this.tileID.canonical))continue}else if(!w.filter(new a.a8(this.tileID.overscaledZ),Se))continue;const Te=r.getId(Se,d),Re=new a.a9(Se,T,B,j,Te);Re.tile=Y,s.push(Re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const i=this.expirationTime;if(s.cacheControl){const r=a.aa(s.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const r=Date.now();let l=!1;if(this.expirationTime>r)l=!1;else if(i)if(this.expirationTime<i)l=!0;else{const d=this.expirationTime-i;d?this.expirationTime=r+Math.max(d,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const r=this.latestFeatureIndex.loadVTLayers();for(const l in this.buckets){if(!i.style.hasLayer(l))continue;const d=this.buckets[l],_=d.layers[0].sourceLayer||"_geojsonTileLayer",w=r[_],T=s[_];if(!w||!T||Object.keys(T).length===0)continue;d.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const B=i&&i.style&&i.style.getLayer(l);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<oe.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=oe.now()+s}setDependencies(s,i){const r={};for(const l of i)r[l]=!0;this.dependencies[s]=r}hasDependency(s,i){for(const r of s){const l=this.dependencies[r];if(l){for(const d of i)if(l[d])return!0}}return!1}}class Ae{constructor(s,i){this.max=s,this.onRemove=i,this.reset()}reset(){for(const s in this.data)for(const i of this.data[s])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(s,i,r){const l=s.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const d={value:i,timeout:void 0};if(r!==void 0&&(d.timeout=setTimeout(()=>{this.remove(s,d)},r)),this.data[l].push(d),this.order.push(l),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const i=this.data[s].shift();return i.timeout&&clearTimeout(i.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),i.value}getByKey(s){const i=this.data[s];return i?i[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,i){if(!this.has(s))return this;const r=s.wrapped().key,l=i===void 0?0:this.data[r].indexOf(i),d=this.data[r][l];return this.data[r].splice(l,1),d.timeout&&clearTimeout(d.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(d.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(s){const i=[];for(const r in this.data)for(const l of this.data[r])s(l.value)||i.push(l);for(const r of i)this.remove(r.value.tileID,r)}}class ve{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,i,r){const l=String(i);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][l]=this.stateChanges[s][l]||{},a.e(this.stateChanges[s][l],r),this.deletedStates[s]===null){this.deletedStates[s]={};for(const d in this.state[s])d!==l&&(this.deletedStates[s][d]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][l]===null){this.deletedStates[s][l]={};for(const d in this.state[s][l])r[d]||(this.deletedStates[s][l][d]=null)}else for(const d in r)this.deletedStates[s]&&this.deletedStates[s][l]&&this.deletedStates[s][l][d]===null&&delete this.deletedStates[s][l][d]}removeFeatureState(s,i,r){if(this.deletedStates[s]===null)return;const l=String(i);if(this.deletedStates[s]=this.deletedStates[s]||{},r&&i!==void 0)this.deletedStates[s][l]!==null&&(this.deletedStates[s][l]=this.deletedStates[s][l]||{},this.deletedStates[s][l][r]=null);else if(i!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][l])for(r in this.deletedStates[s][l]={},this.stateChanges[s][l])this.deletedStates[s][l][r]=null;else this.deletedStates[s][l]=null;else this.deletedStates[s]=null}getState(s,i){const r=String(i),l=a.e({},(this.state[s]||{})[r],(this.stateChanges[s]||{})[r]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const d=this.deletedStates[s][i];if(d===null)return{};for(const _ in d)delete l[_]}return l}initializeTileState(s,i){s.setFeatureState(this.state,i)}coalesceChanges(s,i){const r={};for(const l in this.stateChanges){this.state[l]=this.state[l]||{};const d={};for(const _ in this.stateChanges[l])this.state[l][_]||(this.state[l][_]={}),a.e(this.state[l][_],this.stateChanges[l][_]),d[_]=this.state[l][_];r[l]=d}for(const l in this.deletedStates){this.state[l]=this.state[l]||{};const d={};if(this.deletedStates[l]===null)for(const _ in this.state[l])d[_]={},this.state[l][_]={};else for(const _ in this.deletedStates[l]){if(this.deletedStates[l][_]===null)this.state[l][_]={};else for(const w of Object.keys(this.deletedStates[l][_]))delete this.state[l][_][w];d[_]=this.state[l][_]}r[l]=r[l]||{},a.e(r[l],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(const l in s)s[l].setFeatureState(r,i)}}class Ie extends a.E{constructor(s,i,r){super(),this.id=s,this.dispatcher=r,this.on("data",l=>{l.dataType==="source"&&l.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&l.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((l,d,_,w)=>{const T=new(v(d.type))(l,d,_,w);if(T.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${T.id}`);return T})(s,i,r,this),this._tiles={},this._cache=new Ae(0,l=>this._unloadTile(l)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ve,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const s in this._tiles){const i=this._tiles[s];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,i,r){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(s),this._tileLoaded(s,i,r)}catch(l){s.state="errored",l.status!==404?this._source.fire(new a.j(l,{tile:s})):this.update(this.transform,this.terrain)}})}_unloadTile(s){this._source.unloadTile&&this._source.unloadTile(s)}_abortTile(s){this._source.abortTile&&this._source.abortTile(s),this._source.fire(new a.k("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const r=this._tiles[i];r.upload(s),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(Ee).map(s=>s.key)}getRenderableIds(s){const i=[];for(const r in this._tiles)this._isIdRenderable(r,s)&&i.push(this._tiles[r]);return s?i.sort((r,l)=>{const d=r.tileID,_=l.tileID,w=new a.P(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),T=new a.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-_.overscaledZ||T.y-w.y||T.x-w.x}).map(r=>r.tileID.key):i.map(r=>r.tileID).sort(Ee).map(r=>r.key)}hasRenderableParent(s){const i=this.findLoadedParent(s,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(s,i){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(i||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(s,i){return a._(this,void 0,void 0,function*(){const r=this._tiles[s];r&&(r.state!=="loading"&&(r.state=i),yield this._loadTile(r,s,i))})}_tileLoaded(s,i,r){s.timeAdded=oe.now(),r==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(i,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const i=this.getRenderableIds();for(let l=0;l<i.length;l++){const d=i[l];if(s.neighboringTiles&&s.neighboringTiles[d]){const _=this.getTileByID(d);r(s,_),r(_,s)}}function r(l,d){l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0;let _=d.tileID.canonical.x-l.tileID.canonical.x;const w=d.tileID.canonical.y-l.tileID.canonical.y,T=Math.pow(2,l.tileID.canonical.z),B=d.tileID.key;_===0&&w===0||Math.abs(w)>1||(Math.abs(_)>1&&(Math.abs(_+T)===1?_+=T:Math.abs(_-T)===1&&(_-=T)),d.dem&&l.dem&&(l.dem.backfillBorder(d.dem,_,w),l.neighboringTiles&&l.neighboringTiles[B]&&(l.neighboringTiles[B].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,i,r,l){for(const d in this._tiles){let _=this._tiles[d];if(l[d]||!_.hasData()||_.tileID.overscaledZ<=i||_.tileID.overscaledZ>r)continue;let w=_.tileID;for(;_&&_.tileID.overscaledZ>i+1;){const B=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[B.key],_&&_.hasData()&&(w=B)}let T=w;for(;T.overscaledZ>i;)if(T=T.scaledTo(T.overscaledZ-1),s[T.key]){l[w.key]=w;break}}}findLoadedParent(s,i){if(s.key in this._loadedParentTiles){const r=this._loadedParentTiles[s.key];return r&&r.tileID.overscaledZ>=i?r:null}for(let r=s.overscaledZ-1;r>=i;r--){const l=s.scaledTo(r),d=this._getLoadedTile(l);if(d)return d}}_getLoadedTile(s){const i=this._tiles[s.key];return i&&i.hasData()?i:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const i=Math.ceil(s.width/this._source.tileSize)+1,r=Math.ceil(s.height/this._source.tileSize)+1,l=Math.floor(i*r*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,l):l;this._cache.setMaxSize(d)}handleWrapJump(s){const i=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,i){const r={};for(const l in this._tiles){const d=this._tiles[l];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+i),r[d.tileID.key]=d}this._tiles=r;for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(l,this._tiles[l])}}update(s,i){if(this.transform=s,this.terrain=i,!this._sourceLoaded||this._paused)return;let r;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new a.Q(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(r=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(r=r.filter(j=>this._source.hasTile(j)))):r=[];const l=s.coveringZoomLevel(this._source),d=Math.max(l-Ie.maxOverzooming,this._source.minzoom),_=Math.max(l+Ie.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const Y of r)if(Y.canonical.z>this._source.minzoom){const ue=Y.scaledTo(Y.canonical.z-1);j[ue.key]=ue;const Se=Y.scaledTo(Math.max(this._source.minzoom,Math.min(Y.canonical.z,5)));j[Se.key]=Se}r=r.concat(Object.values(j))}const w=r.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(r,l);if(ze(this._source.type)){const j={},Y={},ue=Object.keys(T),Se=oe.now();for(const Te of ue){const Re=T[Te],Be=this._tiles[Te];if(!Be||Be.fadeEndTime!==0&&Be.fadeEndTime<=Se)continue;const $e=this.findLoadedParent(Re,d);$e&&(this._addTile($e.tileID),j[$e.tileID.key]=$e.tileID),Y[Te]=Re}this._retainLoadedChildren(Y,l,_,T);for(const Te in j)T[Te]||(this._coveredTiles[Te]=!0,T[Te]=j[Te]);if(i){const Te={},Re={};for(const Be of r)this._tiles[Be.key].hasData()?Te[Be.key]=Be:Re[Be.key]=Be;for(const Be in Re){const $e=Re[Be].children(this._source.maxzoom);this._tiles[$e[0].key]&&this._tiles[$e[1].key]&&this._tiles[$e[2].key]&&this._tiles[$e[3].key]&&(Te[$e[0].key]=T[$e[0].key]=$e[0],Te[$e[1].key]=T[$e[1].key]=$e[1],Te[$e[2].key]=T[$e[2].key]=$e[2],Te[$e[3].key]=T[$e[3].key]=$e[3],delete Re[Be])}for(const Be in Re){const $e=this.findLoadedParent(Re[Be],this._source.minzoom);if($e){Te[$e.tileID.key]=T[$e.tileID.key]=$e.tileID;for(const vt in Te)Te[vt].isChildOf($e.tileID)&&delete Te[vt]}}for(const Be in this._tiles)Te[Be]||(this._coveredTiles[Be]=!0)}}for(const j in T)this._tiles[j].clearFadeHold();const B=a.ab(this._tiles,T);for(const j of B){const Y=this._tiles[j];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,i){const r={},l={},d=Math.max(i-Ie.maxOverzooming,this._source.minzoom),_=Math.max(i+Ie.maxUnderzooming,this._source.minzoom),w={};for(const T of s){const B=this._addTile(T);r[T.key]=T,B.hasData()||i<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,i,_,r);for(const T of s){let B=this._tiles[T.key];if(B.hasData())continue;if(i+1>this._source.maxzoom){const Y=T.children(this._source.maxzoom)[0],ue=this.getTile(Y);if(ue&&ue.hasData()){r[Y.key]=Y;continue}}else{const Y=T.children(this._source.maxzoom);if(r[Y[0].key]&&r[Y[1].key]&&r[Y[2].key]&&r[Y[3].key])continue}let j=B.wasRequested();for(let Y=T.overscaledZ-1;Y>=d;--Y){const ue=T.scaledTo(Y);if(l[ue.key])break;if(l[ue.key]=!0,B=this.getTile(ue),!B&&j&&(B=this._addTile(ue)),B){const Se=B.hasData();if((j||Se)&&(r[ue.key]=ue),j=B.wasRequested(),Se)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const i=[];let r,l=this._tiles[s].tileID;for(;l.overscaledZ>0;){if(l.key in this._loadedParentTiles){r=this._loadedParentTiles[l.key];break}i.push(l.key);const d=l.scaledTo(l.overscaledZ-1);if(r=this._getLoadedTile(d),r)break;l=d}for(const d of i)this._loadedParentTiles[d]=r}}_addTile(s){let i=this._tiles[s.key];if(i)return i;i=this._cache.getAndRemove(s),i&&(this._setTileReloadTimer(s.key,i),i.tileID=s,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,i)));const r=i;return i||(i=new te(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(i,s.key,i.state)),i.uses++,this._tiles[s.key]=i,r||this._source.fire(new a.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(s,i){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const r=i.getExpiryTimeout();r&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},r))}_removeTile(s){const i=this._tiles[s];i&&(i.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,i,r){const l=[],d=this.transform;if(!d)return l;const _=r?d.getCameraQueryGeometry(s):s,w=s.map(Te=>d.pointCoordinate(Te,this.terrain)),T=_.map(Te=>d.pointCoordinate(Te,this.terrain)),B=this.getIds();let j=1/0,Y=1/0,ue=-1/0,Se=-1/0;for(const Te of T)j=Math.min(j,Te.x),Y=Math.min(Y,Te.y),ue=Math.max(ue,Te.x),Se=Math.max(Se,Te.y);for(let Te=0;Te<B.length;Te++){const Re=this._tiles[B[Te]];if(Re.holdingForFade())continue;const Be=Re.tileID,$e=Math.pow(2,d.zoom-Re.tileID.overscaledZ),vt=i*Re.queryPadding*a.W/Re.tileSize/$e,ot=[Be.getTilePoint(new a.Y(j,Y)),Be.getTilePoint(new a.Y(ue,Se))];if(ot[0].x-vt<a.W&&ot[0].y-vt<a.W&&ot[1].x+vt>=0&&ot[1].y+vt>=0){const ct=w.map(wt=>Be.getTilePoint(wt)),Et=T.map(wt=>Be.getTilePoint(wt));l.push({tile:Re,tileID:Be,queryGeometry:ct,cameraQueryGeometry:Et,scale:$e})}}return l}getVisibleCoordinates(s){const i=this.getRenderableIds(s).map(r=>this._tiles[r].tileID);for(const r of i)r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(ze(this._source.type)){const s=oe.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=s)return!0}return!1}setFeatureState(s,i,r){this._state.updateState(s=s||"_geojsonTileLayer",i,r)}removeFeatureState(s,i,r){this._state.removeFeatureState(s=s||"_geojsonTileLayer",i,r)}getFeatureState(s,i){return this._state.getState(s=s||"_geojsonTileLayer",i)}setDependencies(s,i,r){const l=this._tiles[s];l&&l.setDependencies(i,r)}reloadTilesForDependencies(s,i){for(const r in this._tiles)this._tiles[r].hasDependency(s,i)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(s,i))}}function Ee(y,s){const i=Math.abs(2*y.wrap)-+(y.wrap<0),r=Math.abs(2*s.wrap)-+(s.wrap<0);return y.overscaledZ-s.overscaledZ||r-i||s.canonical.y-y.canonical.y||s.canonical.x-y.canonical.x}function ze(y){return y==="raster"||y==="image"||y==="video"}Ie.maxOverzooming=10,Ie.maxUnderzooming=3;class Qe{constructor(s,i){this.reset(s,i)}reset(s,i){this.points=s||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.ac(s,0,1);let i=1,r=this._distances[i];const l=s*this.paddedLength+this.padding;for(;r<l&&i<this._distances.length;)r=this._distances[++i];const d=i-1,_=this._distances[d],w=r-_,T=w>0?(l-_)/w:0;return this.points[d].mult(1-T).add(this.points[i].mult(T))}}function He(y,s){let i=!0;return y==="always"||y!=="never"&&s!=="never"||(i=!1),i}class Ze{constructor(s,i,r){const l=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(s/r),this.yCellCount=Math.ceil(i/r);for(let _=0;_<this.xCellCount*this.yCellCount;_++)l.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=i,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,i,r,l,d){this._forEachCell(i,r,l,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(d)}insertCircle(s,i,r,l){this._forEachCell(i-l,r-l,i+l,r+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(i),this.circles.push(r),this.circles.push(l)}_insertBoxCell(s,i,r,l,d,_){this.boxCells[d].push(_)}_insertCircleCell(s,i,r,l,d,_){this.circleCells[d].push(_)}_query(s,i,r,l,d,_,w){if(r<0||s>this.width||l<0||i>this.height)return[];const T=[];if(s<=0&&i<=0&&this.width<=r&&this.height<=l){if(d)return[{key:null,x1:s,y1:i,x2:r,y2:l}];for(let B=0;B<this.boxKeys.length;B++)T.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const j=this.circles[3*B],Y=this.circles[3*B+1],ue=this.circles[3*B+2];T.push({key:this.circleKeys[B],x1:j-ue,y1:Y-ue,x2:j+ue,y2:Y+ue})}}else this._forEachCell(s,i,r,l,this._queryCell,T,{hitTest:d,overlapMode:_,seenUids:{box:{},circle:{}}},w);return T}query(s,i,r,l){return this._query(s,i,r,l,!1,null)}hitTest(s,i,r,l,d,_){return this._query(s,i,r,l,!0,d,_).length>0}hitTestCircle(s,i,r,l,d){const _=s-r,w=s+r,T=i-r,B=i+r;if(w<0||_>this.width||B<0||T>this.height)return!1;const j=[];return this._forEachCell(_,T,w,B,this._queryCellCircle,j,{hitTest:!0,overlapMode:l,circle:{x:s,y:i,radius:r},seenUids:{box:{},circle:{}}},d),j.length>0}_queryCell(s,i,r,l,d,_,w,T){const{seenUids:B,hitTest:j,overlapMode:Y}=w,ue=this.boxCells[d];if(ue!==null){const Te=this.bboxes;for(const Re of ue)if(!B.box[Re]){B.box[Re]=!0;const Be=4*Re,$e=this.boxKeys[Re];if(s<=Te[Be+2]&&i<=Te[Be+3]&&r>=Te[Be+0]&&l>=Te[Be+1]&&(!T||T($e))&&(!j||!He(Y,$e.overlapMode))&&(_.push({key:$e,x1:Te[Be],y1:Te[Be+1],x2:Te[Be+2],y2:Te[Be+3]}),j))return!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!B.circle[Re]){B.circle[Re]=!0;const Be=3*Re,$e=this.circleKeys[Re];if(this._circleAndRectCollide(Te[Be],Te[Be+1],Te[Be+2],s,i,r,l)&&(!T||T($e))&&(!j||!He(Y,$e.overlapMode))){const vt=Te[Be],ot=Te[Be+1],ct=Te[Be+2];if(_.push({key:$e,x1:vt-ct,y1:ot-ct,x2:vt+ct,y2:ot+ct}),j)return!0}}}return!1}_queryCellCircle(s,i,r,l,d,_,w,T){const{circle:B,seenUids:j,overlapMode:Y}=w,ue=this.boxCells[d];if(ue!==null){const Te=this.bboxes;for(const Re of ue)if(!j.box[Re]){j.box[Re]=!0;const Be=4*Re,$e=this.boxKeys[Re];if(this._circleAndRectCollide(B.x,B.y,B.radius,Te[Be+0],Te[Be+1],Te[Be+2],Te[Be+3])&&(!T||T($e))&&!He(Y,$e.overlapMode))return _.push(!0),!0}}const Se=this.circleCells[d];if(Se!==null){const Te=this.circles;for(const Re of Se)if(!j.circle[Re]){j.circle[Re]=!0;const Be=3*Re,$e=this.circleKeys[Re];if(this._circlesCollide(Te[Be],Te[Be+1],Te[Be+2],B.x,B.y,B.radius)&&(!T||T($e))&&!He(Y,$e.overlapMode))return _.push(!0),!0}}}_forEachCell(s,i,r,l,d,_,w,T){const B=this._convertToXCellCoord(s),j=this._convertToYCellCoord(i),Y=this._convertToXCellCoord(r),ue=this._convertToYCellCoord(l);for(let Se=B;Se<=Y;Se++)for(let Te=j;Te<=ue;Te++)if(d.call(this,s,i,r,l,this.xCellCount*Te+Se,_,w,T))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,i,r,l,d,_){const w=l-s,T=d-i,B=r+_;return B*B>w*w+T*T}_circleAndRectCollide(s,i,r,l,d,_,w){const T=(_-l)/2,B=Math.abs(s-(l+T));if(B>T+r)return!1;const j=(w-d)/2,Y=Math.abs(i-(d+j));if(Y>j+r)return!1;if(B<=T||Y<=j)return!0;const ue=B-T,Se=Y-j;return ue*ue+Se*Se<=r*r}}function Ve(y,s,i,r,l){const d=a.F();return s?(a.J(d,d,[1/l,1/l,1]),i||a.ad(d,d,r.angle)):a.K(d,r.labelPlaneMatrix,y),d}function ft(y,s,i,r,l){if(s){const d=a.ae(y);return a.J(d,d,[l,l,1]),i||a.ad(d,d,-r.angle),d}return r.glCoordMatrix}function rt(y,s,i){let r;i?(r=[y.x,y.y,i(y.x,y.y),1],a.af(r,r,s)):(r=[y.x,y.y,0,1],De(r,r,s));const l=r[3];return{point:new a.P(r[0]/l,r[1]/l),signedDistanceFromCamera:l}}function Me(y,s){return .5+y/s*.5}function se(y,s){const i=y[0]/y[3],r=y[1]/y[3];return i>=-s[0]&&i<=s[0]&&r>=-s[1]&&r<=s[1]}function ne(y,s,i,r,l,d,_,w,T,B){const j=r?y.textSizeData:y.iconSizeData,Y=a.ag(j,i.transform.zoom),ue=[256/i.width*2+1,256/i.height*2+1],Se=r?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;Se.clear();const Te=y.lineVertexArray,Re=r?y.text.placedSymbolArray:y.icon.placedSymbolArray,Be=i.transform.width/i.transform.height;let $e=!1;for(let vt=0;vt<Re.length;vt++){const ot=Re.get(vt);if(ot.hidden||ot.writingMode===a.ah.vertical&&!$e){Ye(ot.numGlyphs,Se);continue}let ct;if($e=!1,B?(ct=[ot.anchorX,ot.anchorY,B(ot.anchorX,ot.anchorY),1],a.af(ct,ct,s)):(ct=[ot.anchorX,ot.anchorY,0,1],De(ct,ct,s)),!se(ct,ue)){Ye(ot.numGlyphs,Se);continue}const Et=Me(i.transform.cameraToCenterDistance,ct[3]),wt=a.ai(j,Y,ot),ri=_?wt/Et:wt*Et,Xt=new a.P(ot.anchorX,ot.anchorY),Jt=rt(Xt,l,B).point,si={projections:{},offsets:{}},ji=de(ot,ri,!1,w,s,l,d,y.glyphOffsetArray,Te,Se,Jt,Xt,si,Be,T,B);$e=ji.useVertical,(ji.notEnoughRoom||$e||ji.needsFlipping&&de(ot,ri,!0,w,s,l,d,y.glyphOffsetArray,Te,Se,Jt,Xt,si,Be,T,B).notEnoughRoom)&&Ye(ot.numGlyphs,Se)}r?y.text.dynamicLayoutVertexBuffer.updateData(Se):y.icon.dynamicLayoutVertexBuffer.updateData(Se)}function X(y,s,i,r,l,d,_,w,T,B,j,Y,ue){const Se=w.glyphStartIndex+w.numGlyphs,Te=w.lineStartIndex,Re=w.lineStartIndex+w.lineLength,Be=s.getoffsetX(w.glyphStartIndex),$e=s.getoffsetX(Se-1),vt=Ne(y*Be,i,r,l,d,_,w.segment,Te,Re,T,B,j,Y,ue);if(!vt)return null;const ot=Ne(y*$e,i,r,l,d,_,w.segment,Te,Re,T,B,j,Y,ue);return ot?{first:vt,last:ot}:null}function ie(y,s,i,r){return y===a.ah.horizontal&&Math.abs(i.y-s.y)>Math.abs(i.x-s.x)*r?{useVertical:!0}:(y===a.ah.vertical?s.y<i.y:s.x>i.x)?{needsFlipping:!0}:null}function de(y,s,i,r,l,d,_,w,T,B,j,Y,ue,Se,Te,Re){const Be=s/24,$e=y.lineOffsetX*Be,vt=y.lineOffsetY*Be;let ot;if(y.numGlyphs>1){const ct=y.glyphStartIndex+y.numGlyphs,Et=y.lineStartIndex,wt=y.lineStartIndex+y.lineLength,ri=X(Be,w,$e,vt,i,j,Y,y,T,d,ue,Te,Re);if(!ri)return{notEnoughRoom:!0};const Xt=rt(ri.first.point,_,Re).point,Jt=rt(ri.last.point,_,Re).point;if(r&&!i){const si=ie(y.writingMode,Xt,Jt,Se);if(si)return si}ot=[ri.first];for(let si=y.glyphStartIndex+1;si<ct-1;si++)ot.push(Ne(Be*w.getoffsetX(si),$e,vt,i,j,Y,y.segment,Et,wt,T,d,ue,Te,Re));ot.push(ri.last)}else{if(r&&!i){const Et=rt(Y,l,Re).point,wt=y.lineStartIndex+y.segment+1,ri=new a.P(T.getx(wt),T.gety(wt)),Xt=rt(ri,l,Re),Jt=Xt.signedDistanceFromCamera>0?Xt.point:ye(Y,ri,Et,1,l,Re),si=ie(y.writingMode,Et,Jt,Se);if(si)return si}const ct=Ne(Be*w.getoffsetX(y.glyphStartIndex),$e,vt,i,j,Y,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,T,d,ue,Te,Re);if(!ct)return{notEnoughRoom:!0};ot=[ct]}for(const ct of ot)a.aj(B,ct.point,ct.angle);return{}}function ye(y,s,i,r,l,d){const _=rt(y.add(y.sub(s)._unit()),l,d).point,w=i.sub(_);return i.add(w._mult(r/w.mag()))}function ge(y,s){const{projectionCache:i,lineVertexArray:r,labelPlaneMatrix:l,tileAnchorPoint:d,distanceFromAnchor:_,getElevation:w,previousVertex:T,direction:B,absOffsetX:j}=s;if(i.projections[y])return i.projections[y];const Y=new a.P(r.getx(y),r.gety(y)),ue=rt(Y,l,w);if(ue.signedDistanceFromCamera>0)return i.projections[y]=ue.point,ue.point;const Se=y-B;return ye(_===0?d:new a.P(r.getx(Se),r.gety(Se)),Y,T,j-_+1,l,w)}function Pe(y,s,i){return y._unit()._perp()._mult(s*i)}function Fe(y,s,i,r,l,d,_,w){const{projectionCache:T,direction:B}=w;if(T.offsets[y])return T.offsets[y];const j=i.add(s);if(y+B<r||y+B>=l)return T.offsets[y]=j,j;const Y=ge(y+B,w),ue=Pe(Y.sub(i),_,B),Se=i.add(ue),Te=Y.add(ue);return T.offsets[y]=a.ak(d,j,Se,Te)||j,T.offsets[y]}function Ne(y,s,i,r,l,d,_,w,T,B,j,Y,ue,Se){const Te=r?y-s:y+s;let Re=Te>0?1:-1,Be=0;r&&(Re*=-1,Be=Math.PI),Re<0&&(Be+=Math.PI);let $e,vt,ot=Re>0?w+_:w+_+1,ct=l,Et=l,wt=0,ri=0;const Xt=Math.abs(Te),Jt=[];let si;for(;wt+ri<=Xt;){if(ot+=Re,ot<w||ot>=T)return null;wt+=ri,Et=ct,vt=$e;const Ii={projectionCache:Y,lineVertexArray:B,labelPlaneMatrix:j,tileAnchorPoint:d,distanceFromAnchor:wt,getElevation:Se,previousVertex:Et,direction:Re,absOffsetX:Xt};if(ct=ge(ot,Ii),i===0)Jt.push(Et),si=ct.sub(Et);else{let Vi;const Ui=ct.sub(Et);Vi=Ui.mag()===0?Pe(ge(ot+Re,Ii).sub(ct),i,Re):Pe(Ui,i,Re),vt||(vt=Et.add(Vi)),$e=Fe(ot,Vi,ct,w,T,vt,i,Ii),Jt.push(vt),si=$e.sub(vt)}ri=si.mag()}const ji=si._mult((Xt-wt)/ri)._add(vt||Et),Zi=Be+Math.atan2(ct.y-Et.y,ct.x-Et.x);return Jt.push(ji),{point:ji,angle:ue?Zi:0,path:Jt}}const Xe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ye(y,s){for(let i=0;i<y;i++){const r=s.length;s.resize(r+4),s.float32.set(Xe,3*r)}}function De(y,s,i){const r=s[0],l=s[1];return y[0]=i[0]*r+i[4]*l+i[12],y[1]=i[1]*r+i[5]*l+i[13],y[3]=i[3]*r+i[7]*l+i[15],y}const Ue=100;class ht{constructor(s,i=new Ze(s.width+200,s.height+200,25),r=new Ze(s.width+200,s.height+200,25)){this.transform=s,this.grid=i,this.ignoredGrid=r,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Ue,this.screenBottomBoundary=s.height+Ue,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,i,r,l,d,_){const w=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY,_),T=r*w.perspectiveRatio,B=s.x1*T+w.point.x,j=s.y1*T+w.point.y,Y=s.x2*T+w.point.x,ue=s.y2*T+w.point.y;return!this.isInsideGrid(B,j,Y,ue)||i!=="always"&&this.grid.hitTest(B,j,Y,ue,i,d)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[B,j,Y,ue],offscreen:this.isOffscreen(B,j,Y,ue)}}placeCollisionCircles(s,i,r,l,d,_,w,T,B,j,Y,ue,Se,Te){const Re=[],Be=new a.P(i.anchorX,i.anchorY),$e=rt(Be,_,Te),vt=Me(this.transform.cameraToCenterDistance,$e.signedDistanceFromCamera),ot=(j?d/vt:d*vt)/a.ao,ct=rt(Be,w,Te).point,Et=X(ot,l,i.lineOffsetX*ot,i.lineOffsetY*ot,!1,ct,Be,i,r,w,{projections:{},offsets:{}},!1,Te);let wt=!1,ri=!1,Xt=!0;if(Et){const Jt=.5*ue*vt+Se,si=new a.P(-100,-100),ji=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Zi=new Qe,Ii=Et.first,Vi=Et.last;let Ui=[];for(let Ji=Ii.path.length-1;Ji>=1;Ji--)Ui.push(Ii.path[Ji]);for(let Ji=1;Ji<Vi.path.length;Ji++)Ui.push(Vi.path[Ji]);const an=2.5*Jt;if(T){const Ji=Ui.map(Cn=>rt(Cn,T,Te));Ui=Ji.some(Cn=>Cn.signedDistanceFromCamera<=0)?[]:Ji.map(Cn=>Cn.point)}let Bn=[];if(Ui.length>0){const Ji=Ui[0].clone(),Cn=Ui[0].clone();for(let yr=1;yr<Ui.length;yr++)Ji.x=Math.min(Ji.x,Ui[yr].x),Ji.y=Math.min(Ji.y,Ui[yr].y),Cn.x=Math.max(Cn.x,Ui[yr].x),Cn.y=Math.max(Cn.y,Ui[yr].y);Bn=Ji.x>=si.x&&Cn.x<=ji.x&&Ji.y>=si.y&&Cn.y<=ji.y?[Ui]:Cn.x<si.x||Ji.x>ji.x||Cn.y<si.y||Ji.y>ji.y?[]:a.al([Ui],si.x,si.y,ji.x,ji.y)}for(const Ji of Bn){Zi.reset(Ji,.25*Jt);let Cn=0;Cn=Zi.length<=.5*Jt?1:Math.ceil(Zi.paddedLength/an)+1;for(let yr=0;yr<Cn;yr++){const er=yr/Math.max(Cn-1,1),Ia=Zi.lerp(er),Aa=Ia.x+Ue,Bs=Ia.y+Ue;Re.push(Aa,Bs,Jt,0);const no=Aa-Jt,ro=Bs-Jt,Gr=Aa+Jt,ya=Bs+Jt;if(Xt=Xt&&this.isOffscreen(no,ro,Gr,ya),ri=ri||this.isInsideGrid(no,ro,Gr,ya),s!=="always"&&this.grid.hitTestCircle(Aa,Bs,Jt,s,Y)&&(wt=!0,!B))return{circles:[],offscreen:!1,collisionDetected:wt}}}}return{circles:!B&&wt||!ri||vt<this.perspectiveRatioCutoff?[]:Re,offscreen:Xt,collisionDetected:wt}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let r=1/0,l=1/0,d=-1/0,_=-1/0;for(const j of s){const Y=new a.P(j.x+Ue,j.y+Ue);r=Math.min(r,Y.x),l=Math.min(l,Y.y),d=Math.max(d,Y.x),_=Math.max(_,Y.y),i.push(Y)}const w=this.grid.query(r,l,d,_).concat(this.ignoredGrid.query(r,l,d,_)),T={},B={};for(const j of w){const Y=j.key;if(T[Y.bucketInstanceId]===void 0&&(T[Y.bucketInstanceId]={}),T[Y.bucketInstanceId][Y.featureIndex])continue;const ue=[new a.P(j.x1,j.y1),new a.P(j.x2,j.y1),new a.P(j.x2,j.y2),new a.P(j.x1,j.y2)];a.am(i,ue)&&(T[Y.bucketInstanceId][Y.featureIndex]=!0,B[Y.bucketInstanceId]===void 0&&(B[Y.bucketInstanceId]=[]),B[Y.bucketInstanceId].push(Y.featureIndex))}return B}insertCollisionBox(s,i,r,l,d,_){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,i,r,l,d,_){const w=r?this.ignoredGrid:this.grid,T={bucketInstanceId:l,featureIndex:d,collisionGroupID:_,overlapMode:i};for(let B=0;B<s.length;B+=4)w.insertCircle(T,s[B],s[B+1],s[B+2])}projectAndGetPerspectiveRatio(s,i,r,l){let d;return l?(d=[i,r,l(i,r),1],a.af(d,d,s)):(d=[i,r,0,1],De(d,d,s)),{point:new a.P((d[0]/d[3]+1)/2*this.transform.width+Ue,(-d[1]/d[3]+1)/2*this.transform.height+Ue),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(s,i,r,l){return r<Ue||s>=this.screenRightBoundary||l<Ue||i>this.screenBottomBoundary}isInsideGrid(s,i,r,l){return r>=0&&s<this.gridRightBoundary&&l>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const s=a.an([]);return a.H(s,s,[-100,-100,0]),s}}function Tt(y,s,i){return s*(a.W/(y.tileSize*Math.pow(2,i-y.tileID.overscaledZ)))}class o{constructor(s,i,r,l){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?i:-i))):l&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}}class ke{constructor(s,i,r,l,d){this.text=new o(s?s.text:null,i,r,d),this.icon=new o(s?s.icon:null,i,l,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ai{constructor(s,i,r){this.text=s,this.icon=i,this.skipFade=r}}class di{constructor(){this.invProjMatrix=a.F(),this.viewportMatrix=a.F(),this.circles=[]}}class Ai{constructor(s,i,r,l,d){this.bucketInstanceId=s,this.featureIndex=i,this.sourceLayerIndex=r,this.bucketIndex=l,this.tileID=d}}class Kt{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const i=++this.maxGroupID;this.collisionGroups[s]={ID:i,predicate:r=>r.collisionGroupID===i}}return this.collisionGroups[s]}}function oi(y,s,i,r,l){const{horizontalAlign:d,verticalAlign:_}=a.at(y);return new a.P(-(d-.5)*s+r[0]*l,-(_-.5)*i+r[1]*l)}function Ri(y,s,i,r,l,d){const{x1:_,x2:w,y1:T,y2:B,anchorPointX:j,anchorPointY:Y}=y,ue=new a.P(s,i);return r&&ue._rotate(l?d:-d),{x1:_+ue.x,y1:T+ue.y,x2:w+ue.x,y2:B+ue.y,anchorPointX:j,anchorPointY:Y}}class vi{constructor(s,i,r,l,d){this.transform=s.clone(),this.terrain=i,this.collisionIndex=new ht(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Kt(l),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,i,r,l){const d=r.getBucket(i),_=r.latestFeatureIndex;if(!d||!_||i.id!==d.layerIds[0])return;const w=r.collisionBoxArray,T=d.layers[0].layout,B=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),j=r.tileSize/a.W,Y=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),ue=T.get("text-pitch-alignment")==="map",Se=T.get("text-rotation-alignment")==="map",Te=Tt(r,1,this.transform.zoom),Re=Ve(Y,ue,Se,this.transform,Te);let Be=null;if(ue){const vt=ft(Y,ue,Se,this.transform,Te);Be=a.K([],this.transform.labelPlaneMatrix,vt)}this.retainedQueryData[d.bucketInstanceId]=new Ai(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,r.tileID);const $e={bucket:d,layout:T,posMatrix:Y,textLabelPlaneMatrix:Re,labelToScreenMatrix:Be,scale:B,textPixelRatio:j,holdingForFade:r.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:a.ag(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(l)for(const vt of d.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:ct,symbolInstanceEnd:Et}=vt;s.push({sortKey:ot,symbolInstanceStart:ct,symbolInstanceEnd:Et,parameters:$e})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:$e})}attemptAnchorPlacement(s,i,r,l,d,_,w,T,B,j,Y,ue,Se,Te,Re,Be){const $e=a.ap[s.textAnchor],vt=[s.textOffset0,s.textOffset1],ot=oi($e,r,l,vt,d),ct=this.collisionIndex.placeCollisionBox(Ri(i,ot.x,ot.y,_,w,this.transform.angle),Y,T,B,j.predicate,Be);if((!Re||this.collisionIndex.placeCollisionBox(Ri(Re,ot.x,ot.y,_,w,this.transform.angle),Y,T,B,j.predicate,Be).box.length!==0)&&ct.box.length>0){let Et;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ue.crossTileID]&&this.prevPlacement.placements[ue.crossTileID]&&this.prevPlacement.placements[ue.crossTileID].text&&(Et=this.prevPlacement.variableOffsets[ue.crossTileID].anchor),ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ue.crossTileID]={textOffset:vt,width:r,height:l,anchor:$e,textBoxScale:d,prevAnchor:Et},this.markUsedJustification(Se,$e,ue,Te),Se.allowVerticalPlacement&&(this.markUsedOrientation(Se,Te,ue),this.placedOrientations[ue.crossTileID]=Te),{shift:ot,placedGlyphBoxes:ct}}}placeLayerBucketPart(s,i,r){const{bucket:l,layout:d,posMatrix:_,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:B,holdingForFade:j,collisionBoxArray:Y,partiallyEvaluatedTextSize:ue,collisionGroup:Se}=s.parameters,Te=d.get("text-optional"),Re=d.get("icon-optional"),Be=a.aq(d,"text-overlap","text-allow-overlap"),$e=Be==="always",vt=a.aq(d,"icon-overlap","icon-allow-overlap"),ot=vt==="always",ct=d.get("text-rotation-alignment")==="map",Et=d.get("text-pitch-alignment")==="map",wt=d.get("icon-text-fit")!=="none",ri=d.get("symbol-z-order")==="viewport-y",Xt=$e&&(ot||!l.hasIconData()||Re),Jt=ot&&($e||!l.hasTextData()||Te);!l.collisionArrays&&Y&&l.deserializeCollisionBoxes(Y);const si=this.retainedQueryData[l.bucketInstanceId].tileID,ji=this.terrain?(Ii,Vi)=>this.terrain.getElevation(si,Ii,Vi):null,Zi=(Ii,Vi)=>{var Ui,an;if(i[Ii.crossTileID])return;if(j)return void(this.placements[Ii.crossTileID]=new ai(!1,!1,!1));let Bn=!1,Ji=!1,Cn=!0,yr=null,er={box:null,offscreen:null},Ia={box:null,offscreen:null},Aa=null,Bs=null,no=null,ro=0,Gr=0,ya=0;Vi.textFeatureIndex?ro=Vi.textFeatureIndex:Ii.useRuntimeCollisionCircles&&(ro=Ii.featureIndex),Vi.verticalTextFeatureIndex&&(Gr=Vi.verticalTextFeatureIndex);const go=Vi.textBox;if(go){const es=Qs=>{let To=a.ah.horizontal;if(l.allowVerticalPlacement&&!Qs&&this.prevPlacement){const No=this.prevPlacement.placedOrientations[Ii.crossTileID];No&&(this.placedOrientations[Ii.crossTileID]=No,To=No,this.markUsedOrientation(l,To,Ii))}return To},ts=(Qs,To)=>{if(l.allowVerticalPlacement&&Ii.numVerticalGlyphVertices>0&&Vi.verticalTextBox){for(const No of l.writingModes)if(No===a.ah.vertical?(er=To(),Ia=er):er=Qs(),er&&er.box&&er.box.length)break}else er=Qs()},Lr=Ii.textAnchorOffsetStartIndex,vs=Ii.textAnchorOffsetEndIndex;if(vs===Lr){const Qs=(To,No)=>{const Vo=this.collisionIndex.placeCollisionBox(To,Be,B,_,Se.predicate,ji);return Vo&&Vo.box&&Vo.box.length&&(this.markUsedOrientation(l,No,Ii),this.placedOrientations[Ii.crossTileID]=No),Vo};ts(()=>Qs(go,a.ah.horizontal),()=>{const To=Vi.verticalTextBox;return l.allowVerticalPlacement&&Ii.numVerticalGlyphVertices>0&&To?Qs(To,a.ah.vertical):{box:null,offscreen:null}}),es(er&&er.box&&er.box.length)}else{let Qs=a.ap[(an=(Ui=this.prevPlacement)===null||Ui===void 0?void 0:Ui.variableOffsets[Ii.crossTileID])===null||an===void 0?void 0:an.anchor];const To=(Vo,Sc,Ws)=>{const Zl=Vo.x2-Vo.x1,cu=Vo.y2-Vo.y1,el=Ii.textBoxScale,vl=wt&&vt==="never"?Sc:null;let Pl={box:[],offscreen:!1},hu=Be==="never"?1:2,sf="never";Qs&&hu++;for(let Nh=0;Nh<hu;Nh++){for(let Pa=Lr;Pa<vs;Pa++){const dA=l.textAnchorOffsets.get(Pa);if(Qs&&dA.textAnchor!==Qs)continue;const _h=this.attemptAnchorPlacement(dA,Vo,Zl,cu,el,ct,Et,B,_,Se,sf,Ii,l,Ws,vl,ji);if(_h&&(Pl=_h.placedGlyphBoxes,Pl&&Pl.box&&Pl.box.length))return Bn=!0,yr=_h.shift,Pl}Qs?Qs=null:sf=Be}return Pl};ts(()=>To(go,Vi.iconBox,a.ah.horizontal),()=>{const Vo=Vi.verticalTextBox;return l.allowVerticalPlacement&&!(er&&er.box&&er.box.length)&&Ii.numVerticalGlyphVertices>0&&Vo?To(Vo,Vi.verticalIconBox,a.ah.vertical):{box:null,offscreen:null}}),er&&(Bn=er.box,Cn=er.offscreen);const No=es(er&&er.box);if(!Bn&&this.prevPlacement){const Vo=this.prevPlacement.variableOffsets[Ii.crossTileID];Vo&&(this.variableOffsets[Ii.crossTileID]=Vo,this.markUsedJustification(l,Vo.anchor,Ii,No))}}}if(Aa=er,Bn=Aa&&Aa.box&&Aa.box.length>0,Cn=Aa&&Aa.offscreen,Ii.useRuntimeCollisionCircles){const es=l.text.placedSymbolArray.get(Ii.centerJustifiedTextSymbolIndex),ts=a.ai(l.textSizeData,ue,es),Lr=d.get("text-padding");Bs=this.collisionIndex.placeCollisionCircles(Be,es,l.lineVertexArray,l.glyphOffsetArray,ts,_,w,T,r,Et,Se.predicate,Ii.collisionCircleDiameter,Lr,ji),Bs.circles.length&&Bs.collisionDetected&&!r&&a.w("Collisions detected, but collision boxes are not shown"),Bn=$e||Bs.circles.length>0&&!Bs.collisionDetected,Cn=Cn&&Bs.offscreen}if(Vi.iconFeatureIndex&&(ya=Vi.iconFeatureIndex),Vi.iconBox){const es=ts=>{const Lr=wt&&yr?Ri(ts,yr.x,yr.y,ct,Et,this.transform.angle):ts;return this.collisionIndex.placeCollisionBox(Lr,vt,B,_,Se.predicate,ji)};Ia&&Ia.box&&Ia.box.length&&Vi.verticalIconBox?(no=es(Vi.verticalIconBox),Ji=no.box.length>0):(no=es(Vi.iconBox),Ji=no.box.length>0),Cn=Cn&&no.offscreen}const _o=Te||Ii.numHorizontalGlyphVertices===0&&Ii.numVerticalGlyphVertices===0,Zs=Re||Ii.numIconVertices===0;if(_o||Zs?Zs?_o||(Ji=Ji&&Bn):Bn=Ji&&Bn:Ji=Bn=Ji&&Bn,Bn&&Aa&&Aa.box&&this.collisionIndex.insertCollisionBox(Aa.box,Be,d.get("text-ignore-placement"),l.bucketInstanceId,Ia&&Ia.box&&Gr?Gr:ro,Se.ID),Ji&&no&&this.collisionIndex.insertCollisionBox(no.box,vt,d.get("icon-ignore-placement"),l.bucketInstanceId,ya,Se.ID),Bs&&(Bn&&this.collisionIndex.insertCollisionCircles(Bs.circles,Be,d.get("text-ignore-placement"),l.bucketInstanceId,ro,Se.ID),r)){const es=l.bucketInstanceId;let ts=this.collisionCircleArrays[es];ts===void 0&&(ts=this.collisionCircleArrays[es]=new di);for(let Lr=0;Lr<Bs.circles.length;Lr+=4)ts.circles.push(Bs.circles[Lr+0]),ts.circles.push(Bs.circles[Lr+1]),ts.circles.push(Bs.circles[Lr+2]),ts.circles.push(Bs.collisionDetected?1:0)}if(Ii.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(l.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ii.crossTileID]=new ai(Bn||Xt,Ji||Jt,Cn||l.justReloaded),i[Ii.crossTileID]=!0};if(ri){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ii=l.getSortedSymbolIndexes(this.transform.angle);for(let Vi=Ii.length-1;Vi>=0;--Vi){const Ui=Ii[Vi];Zi(l.symbolInstances.get(Ui),l.collisionArrays[Ui])}}else for(let Ii=s.symbolInstanceStart;Ii<s.symbolInstanceEnd;Ii++)Zi(l.symbolInstances.get(Ii),l.collisionArrays[Ii]);if(r&&l.bucketInstanceId in this.collisionCircleArrays){const Ii=this.collisionCircleArrays[l.bucketInstanceId];a.ar(Ii.invProjMatrix,_),Ii.viewportMatrix=this.collisionIndex.getViewportMatrix()}l.justReloaded=!1}markUsedJustification(s,i,r,l){let d;d=l===a.ah.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[a.as(i)];const _=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const w of _)w>=0&&(s.text.placedSymbolArray.get(w).crossTileID=d>=0&&w!==d?0:r.crossTileID)}markUsedOrientation(s,i,r){const l=i===a.ah.horizontal||i===a.ah.horizontalOnly?i:0,d=i===a.ah.vertical?i:0,_=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const w of _)s.text.placedSymbolArray.get(w).placedOrientation=l;r.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let r=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const l=i?i.symbolFadeChange(s):1,d=i?i.opacities:{},_=i?i.variableOffsets:{},w=i?i.placedOrientations:{};for(const T in this.placements){const B=this.placements[T],j=d[T];j?(this.opacities[T]=new ke(j,l,B.text,B.icon),r=r||B.text!==j.text.placed||B.icon!==j.icon.placed):(this.opacities[T]=new ke(null,l,B.text,B.icon,B.skipFade),r=r||B.text||B.icon)}for(const T in d){const B=d[T];if(!this.opacities[T]){const j=new ke(B,l,!1,!1);j.isHidden()||(this.opacities[T]=j,r=r||B.text.placed||B.icon.placed)}}for(const T in _)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=_[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:s)}updateLayerOpacities(s,i){const r={};for(const l of i){const d=l.getBucket(s);d&&l.latestFeatureIndex&&s.id===d.layerIds[0]&&this.updateBucketOpacities(d,r,l.collisionBoxArray)}}updateBucketOpacities(s,i,r){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const l=s.layers[0],d=l.layout,_=new ke(null,0,!1,!1,!0),w=d.get("text-allow-overlap"),T=d.get("icon-allow-overlap"),B=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=d.get("text-rotation-alignment")==="map",Y=d.get("text-pitch-alignment")==="map",ue=d.get("icon-text-fit")!=="none",Se=new ke(null,0,w&&(T||!s.hasIconData()||d.get("icon-optional")),T&&(w||!s.hasTextData()||d.get("text-optional")),!0);!s.collisionArrays&&r&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(r);const Te=(Re,Be,$e)=>{for(let vt=0;vt<Be/4;vt++)Re.opacityVertexArray.emplaceBack($e);Re.hasVisibleVertices=Re.hasVisibleVertices||$e!==Fn};for(let Re=0;Re<s.symbolInstances.length;Re++){const Be=s.symbolInstances.get(Re),{numHorizontalGlyphVertices:$e,numVerticalGlyphVertices:vt,crossTileID:ot}=Be;let ct=this.opacities[ot];i[ot]?ct=_:ct||(ct=Se,this.opacities[ot]=ct),i[ot]=!0;const Et=Be.numIconVertices>0,wt=this.placedOrientations[Be.crossTileID],ri=wt===a.ah.vertical,Xt=wt===a.ah.horizontal||wt===a.ah.horizontalOnly;if($e>0||vt>0){const Jt=lr(ct.text);Te(s.text,$e,ri?Fn:Jt),Te(s.text,vt,Xt?Fn:Jt);const si=ct.text.isHidden();[Be.rightJustifiedTextSymbolIndex,Be.centerJustifiedTextSymbolIndex,Be.leftJustifiedTextSymbolIndex].forEach(Ii=>{Ii>=0&&(s.text.placedSymbolArray.get(Ii).hidden=si||ri?1:0)}),Be.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Be.verticalPlacedTextSymbolIndex).hidden=si||Xt?1:0);const ji=this.variableOffsets[Be.crossTileID];ji&&this.markUsedJustification(s,ji.anchor,Be,wt);const Zi=this.placedOrientations[Be.crossTileID];Zi&&(this.markUsedJustification(s,"left",Be,Zi),this.markUsedOrientation(s,Zi,Be))}if(Et){const Jt=lr(ct.icon),si=!(ue&&Be.verticalPlacedIconSymbolIndex&&ri);Be.placedIconSymbolIndex>=0&&(Te(s.icon,Be.numIconVertices,si?Jt:Fn),s.icon.placedSymbolArray.get(Be.placedIconSymbolIndex).hidden=ct.icon.isHidden()),Be.verticalPlacedIconSymbolIndex>=0&&(Te(s.icon,Be.numVerticalIconVertices,si?Fn:Jt),s.icon.placedSymbolArray.get(Be.verticalPlacedIconSymbolIndex).hidden=ct.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Jt=s.collisionArrays[Re];if(Jt){let si=new a.P(0,0);if(Jt.textBox||Jt.verticalTextBox){let Zi=!0;if(B){const Ii=this.variableOffsets[ot];Ii?(si=oi(Ii.anchor,Ii.width,Ii.height,Ii.textOffset,Ii.textBoxScale),j&&si._rotate(Y?this.transform.angle:-this.transform.angle)):Zi=!1}Jt.textBox&&wi(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Zi||ri,si.x,si.y),Jt.verticalTextBox&&wi(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Zi||Xt,si.x,si.y)}const ji=!!(!Xt&&Jt.verticalIconBox);Jt.iconBox&&wi(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,ji,ue?si.x:0,ue?si.y:0),Jt.verticalIconBox&&wi(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,!ji,ue?si.x:0,ue?si.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Re.invProjMatrix,s.placementViewportMatrix=Re.viewportMatrix,s.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,i){const r=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*r>s}setStale(){this.stale=!0}}function wi(y,s,i,r,l){y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0),y.emplaceBack(s?1:0,i?1:0,r||0,l||0)}const Yt=Math.pow(2,25),vn=Math.pow(2,24),ar=Math.pow(2,17),dn=Math.pow(2,16),Vn=Math.pow(2,9),Hr=Math.pow(2,8),Hi=Math.pow(2,1);function lr(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const s=y.placed?1:0,i=Math.floor(127*y.opacity);return i*Yt+s*vn+i*ar+s*dn+i*Vn+s*Hr+i*Hi+s}const Fn=0;class Qt{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,i,r,l,d){const _=this._bucketParts;for(;this._currentTileIndex<s.length;)if(i.getBucketParts(_,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<_.length;)if(i.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,d())return!0;return!1}}class Yi{constructor(s,i,r,l,d,_,w,T){this.placement=new vi(s,i,_,w,T),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(s,i,r){const l=oe.now(),d=()=>!this._forceFullPlacement&&oe.now()-l>2;for(;this._currentPlacementIndex>=0;){const _=i[s[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=w)&&(!_.maxzoom||_.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Qt(_)),this._inProgressLayer.continuePlacement(r[_.source],this.placement,this._showCollisionBoxes,_,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Ut=512/a.W/2;class En{constructor(s,i,r){this.tileID=s,this.bucketInstanceId=r,this._symbolsByKey={};const l=new Map;for(let d=0;d<i.length;d++){const _=i.get(d),w=_.key,T=l.get(w);T?T.push(_):l.set(w,[_])}for(const[d,_]of l){const w={positions:_.map(T=>({x:Math.floor(T.anchorX*Ut),y:Math.floor(T.anchorY*Ut)})),crossTileIDs:_.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new a.au(w.positions.length,16,Uint16Array);for(const{x:B,y:j}of w.positions)T.add(B,j);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[d]=w}}getScaledCoordinates(s,i){const{x:r,y:l,z:d}=this.tileID.canonical,{x:_,y:w,z:T}=i.canonical,B=Ut/Math.pow(2,T-d),j=(w*a.W+s.anchorY)*B,Y=l*a.W*Ut;return{x:Math.floor((_*a.W+s.anchorX)*B-r*a.W*Ut),y:Math.floor(j-Y)}}findMatches(s,i,r){const l=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let d=0;d<s.length;d++){const _=s.get(d);if(_.crossTileID)continue;const w=this._symbolsByKey[_.key];if(!w)continue;const T=this.getScaledCoordinates(_,i);if(w.index){const B=w.index.range(T.x-l,T.y-l,T.x+l,T.y+l).sort();for(const j of B){const Y=w.crossTileIDs[j];if(!r[Y]){r[Y]=!0,_.crossTileID=Y;break}}}else if(w.positions)for(let B=0;B<w.positions.length;B++){const j=w.positions[B],Y=w.crossTileIDs[B];if(Math.abs(j.x-T.x)<=l&&Math.abs(j.y-T.y)<=l&&!r[Y]){r[Y]=!0,_.crossTileID=Y;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class ur{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ns{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const i=Math.round((s-this.lng)/360);if(i!==0)for(const r in this.indexes){const l=this.indexes[r],d={};for(const _ in l){const w=l[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+i),d[w.tileID.key]=w}this.indexes[r]=d}this.lng=s}addBucket(s,i,r){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let d=0;d<i.symbolInstances.length;d++)i.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const l=this.usedCrossTileIDs[s.overscaledZ];for(const d in this.indexes){const _=this.indexes[d];if(Number(d)>s.overscaledZ)for(const w in _){const T=_[w];T.tileID.isChildOf(s)&&T.findMatches(i.symbolInstances,s,l)}else{const w=_[s.scaledTo(Number(d)).key];w&&w.findMatches(i.symbolInstances,s,l)}}for(let d=0;d<i.symbolInstances.length;d++){const _=i.symbolInstances.get(d);_.crossTileID||(_.crossTileID=r.generate(),l[_.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new En(s,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(s,i){for(const r of i.getCrossTileIDsLists())for(const l of r)delete this.usedCrossTileIDs[s][l]}removeStaleBuckets(s){let i=!1;for(const r in this.indexes){const l=this.indexes[r];for(const d in l)s[l[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,l[d]),delete l[d],i=!0)}return i}}class Vr{constructor(){this.layerIndexes={},this.crossTileIDs=new ur,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,i,r){let l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new Ns);let d=!1;const _={};l.handleWrapJump(r);for(const w of i){const T=w.getBucket(s);T&&s.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(w.tileID,T,this.crossTileIDs)&&(d=!0),_[T.bucketInstanceId]=!0)}return l.removeStaleBuckets(_)&&(d=!0),d}pruneUnusedLayers(s){const i={};s.forEach(r=>{i[r]=!0});for(const r in this.layerIndexes)i[r]||delete this.layerIndexes[r]}}const Vt=(y,s)=>a.t(y,s&&s.filter(i=>i.identifier!=="source.canvas")),cr=a.av();class Lt extends a.E{constructor(s,i={}){super(),this._rtlTextPluginStateChange=()=>{for(const r in this.sourceCaches){const l=this.sourceCaches[r].getSource().type;l!=="vector"&&l!=="geojson"||this.sourceCaches[r].reload()}},this.map=s,this.dispatcher=new yi(Ti(),s._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(r,l)=>this.getGlyphs(r,l)),this.dispatcher.registerMessageHandler("getImages",(r,l)=>this.getImages(r,l)),this.imageManager=new nt,this.imageManager.setEventedParent(this),this.glyphManager=new Ft(s._requestManager,i.localIdeographFontFamily),this.lineAtlas=new ki(256,512),this.crossTileSymbolIndex=new Vr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.ax()),$().on("pluginStateChange",this._rtlTextPluginStateChange),this.on("data",r=>{if(r.dataType!=="source"||r.sourceDataType!=="metadata")return;const l=this.sourceCaches[r.sourceId];if(!l)return;const d=l.getSource();if(d&&d.vectorLayerIds)for(const _ in this._layers){const w=this._layers[_];w.source===d.id&&this._validateLayer(w)}})}loadURL(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const l=this.map._requestManager.transformRequest(s,Bt.Style);this._loadStyleRequest=new AbortController,a.h(l,this._loadStyleRequest).then(d=>{this._loadStyleRequest=null,this._load(d.data,i,r)}).catch(d=>{this._loadStyleRequest=null,d&&this.fire(new a.j(d))})}loadJSON(s,i={},r){this.fire(new a.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,oe.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(s,i,r)}).catch(()=>{})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(cr,{validate:!1})}_load(s,i,r){var l;const d=i.transformStyle?i.transformStyle(r,s):s;if(!i.validate||!Vt(this,a.x(d))){this._loaded=!0,this.stylesheet=d;for(const _ in d.sources)this.addSource(_,d.sources[_],{validate:!1});d.sprite?this._loadSprite(d.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(d.glyphs),this._createLayers(),this.light=new bi(this.stylesheet.light),this.map.setTerrain((l=this.stylesheet.terrain)!==null&&l!==void 0?l:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const s=a.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of s){const r=a.az(i);r.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=r}}_loadSprite(s,i=!1,r=void 0){let l;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(d,_,w,T){return a._(this,void 0,void 0,function*(){const B=mt(d),j=w>1?"@2x":"",Y={},ue={};for(const{id:Se,url:Te}of B){const Re=_.transformRequest(_.normalizeSpriteURL(Te,j,".json"),Bt.SpriteJSON);Y[Se]=a.h(Re,T);const Be=_.transformRequest(_.normalizeSpriteURL(Te,j,".png"),Bt.SpriteImage);ue[Se]=kt.getImage(Be,T)}return yield Promise.all([...Object.values(Y),...Object.values(ue)]),function(Se,Te){return a._(this,void 0,void 0,function*(){const Re={};for(const Be in Se){Re[Be]={};const $e=oe.getImageCanvasContext((yield Te[Be]).data),vt=(yield Se[Be]).data;for(const ot in vt){const{width:ct,height:Et,x:wt,y:ri,sdf:Xt,pixelRatio:Jt,stretchX:si,stretchY:ji,content:Zi}=vt[ot];Re[Be][ot]={data:null,pixelRatio:Jt,sdf:Xt,stretchX:si,stretchY:ji,content:Zi,spriteData:{width:ct,height:Et,x:wt,y:ri,context:$e}}}}return Re})}(Y,ue)})}(s,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(d=>{if(this._spriteRequest=null,d)for(const _ in d){this._spritesImagesIds[_]=[];const w=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter(T=>!(T in d)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in d[_]){const B=_==="default"?T:`${_}:${T}`;this._spritesImagesIds[_].push(B),B in this.imageManager.images?this.imageManager.updateImage(B,d[_][T],!1):this.imageManager.addImage(B,d[_][T]),i&&(this._changedImages[B]=!0)}}}).catch(d=>{this._spriteRequest=null,l=d,this.fire(new a.j(l))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),r&&r(l)})}_unloadSprite(){for(const s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(s){const i=this.sourceCaches[s.source];if(!i)return;const r=s.sourceLayer;if(!r)return;const l=i.getSource();(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(r)===-1)&&this.fire(new a.j(new Error(`Source layer "${r}" does not exist on source "${l.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){const i=this._serializedAllLayers();if(!s||s.length===0)return Object.values(i);const r=[];for(const l of s)i[l]&&r.push(i[l]);return r}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};const i=Object.keys(this._layers);for(const r of i){const l=this._layers[r];l.type!=="custom"&&(s[r]=l.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const i=this._changed;if(this._changed){const l=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(l.length||d.length)&&this._updateWorkerLayers(l,d);for(const _ in this._updatedSources){const w=this._updatedSources[_];if(w==="reload")this._reloadSource(_);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const r={};for(const l in this.sourceCaches){const d=this.sourceCaches[l];r[l]=d.used,d.used=!1}for(const l of this._order){const d=this._layers[l];d.recalculate(s,this._availableImages),!d.isHidden(s.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const l in r){const d=this.sourceCaches[l];r[l]!==d.used&&d.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:l}))}this.light.recalculate(s),this.z=s.zoom,i&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,i){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,i={}){var r;this._checkLoaded();const l=this.serialize();if(s=i.transformStyle?i.transformStyle(l,s):s,((r=i.validate)===null||r===void 0||r)&&Vt(this,a.x(s)))return!1;(s=a.aA(s)).layers=a.ay(s.layers);const d=a.aB(l,s),_=this._getOperationsToPerform(d);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const w of _.operations)w();return this.stylesheet=s,this._serializedLayers=null,!0}_getOperationsToPerform(s){const i=[],r=[];for(const l of s)switch(l.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,l.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,l.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,l.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,l.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,l.args));break;case"addSource":i.push(()=>this.addSource.apply(this,l.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,l.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,l.args));break;case"setLight":i.push(()=>this.setLight.apply(this,l.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,l.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,l.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,l.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,l.args));break;case"setTransition":i.push(()=>{});break;default:r.push(l.command)}return{operations:i,unimplemented:r}}addImage(s,i){if(this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,i),this._afterImageUpdated(s)}updateImage(s,i){this.imageManager.updateImage(s,i)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new a.j(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,i,r={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(a.x.source,`sources.${s}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const l=this.sourceCaches[s]=new Ie(s,i,this.dispatcher);l.style=this,l.setEventedParent(this,()=>({isSourceLoaded:l.loaded(),source:l.serialize(),sourceId:s})),l.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===s)return this.fire(new a.j(new Error(`Source "${s}" cannot be removed while layer "${r}" is using it.`)));const i=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],i.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,i){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const r=this.sourceCaches[s].getSource();if(r.type!=="geojson")throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(i),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,i,r={}){this._checkLoaded();const l=s.id;if(this.getLayer(l))return void this.fire(new a.j(new Error(`Layer "${l}" already exists on this map.`)));let d;if(s.type==="custom"){if(Vt(this,a.aC(s)))return;d=a.az(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(l,s.source),s=a.aA(s),s=a.e(s,{source:l})),this._validate(a.x.layer,`layers.${l}`,s,{arrayIndex:-1},r))return;d=a.az(s),this._validateLayer(d),d.setEventedParent(this,{layer:{id:l}})}const _=i?this._order.indexOf(i):this._order.length;if(i&&_===-1)this.fire(new a.j(new Error(`Cannot add layer "${l}" before non-existing layer "${i}".`)));else{if(this._order.splice(_,0,l),this._layerOrderChanged=!0,this._layers[l]=d,this._removedLayers[l]&&d.source&&d.type!=="custom"){const w=this._removedLayers[l];delete this._removedLayers[l],w.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(s,i){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.j(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===i)return;const r=this._order.indexOf(s);this._order.splice(r,1);const l=i?this._order.indexOf(i):this._order.length;i&&l===-1?this.fire(new a.j(new Error(`Cannot move layer "${s}" before non-existing layer "${i}".`))):(this._order.splice(l,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const i=this._layers[s];if(!i)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${s}".`)));i.setEventedParent(null);const r=this._order.indexOf(s);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=i,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],i.onRemove&&i.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,i,r){this._checkLoaded();const l=this.getLayer(s);l?l.minzoom===i&&l.maxzoom===r||(i!=null&&(l.minzoom=i),r!=null&&(l.maxzoom=r),this._updateLayer(l)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,i,r={}){this._checkLoaded();const l=this.getLayer(s);if(l){if(!a.aD(l.filter,i))return i==null?(l.filter=void 0,void this._updateLayer(l)):void(this._validate(a.x.filter,`layers.${l.id}.filter`,i,null,r)||(l.filter=a.aA(i),this._updateLayer(l)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return a.aA(this.getLayer(s).filter)}setLayoutProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getLayoutProperty(i),r)||(d.setLayoutProperty(i,r,l),this._updateLayer(d)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,i){const r=this.getLayer(s);if(r)return r.getLayoutProperty(i);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,i,r,l={}){this._checkLoaded();const d=this.getLayer(s);d?a.aD(d.getPaintProperty(i),r)||(d.setPaintProperty(i,r,l)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,i){return this.getLayer(s).getPaintProperty(i)}setFeatureState(s,i){this._checkLoaded();const r=s.source,l=s.sourceLayer,d=this.sourceCaches[r];if(d===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const _=d.getSource().type;_==="geojson"&&l?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||l?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),d.setFeatureState(l,s.id,i)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,i){this._checkLoaded();const r=s.source,l=this.sourceCaches[r];if(l===void 0)return void this.fire(new a.j(new Error(`The source '${r}' does not exist in the map's style.`)));const d=l.getSource().type,_=d==="vector"?s.sourceLayer:void 0;d!=="vector"||_?i&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):l.removeFeatureState(_,s.id,i):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const i=s.source,r=s.sourceLayer,l=this.sourceCaches[i];if(l!==void 0)return l.getSource().type!=="vector"||r?(s.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),l.getFeatureState(r,s.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const s=a.aE(this.sourceCaches,d=>d.serialize()),i=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,l=this.stylesheet;return a.aF({version:l.version,name:l.name,metadata:l.metadata,light:l.light,center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,sprite:l.sprite,glyphs:l.glyphs,transition:l.transition,sources:s,layers:i,terrain:r},d=>d!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){const i=_=>this._layers[_].type==="fill-extrusion",r={},l=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w)){r[w]=_;for(const T of s){const B=T[w];if(B)for(const j of B)l.push(j)}}}l.sort((_,w)=>w.intersectionZ-_.intersectionZ);const d=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(i(w))for(let T=l.length-1;T>=0;T--){const B=l[T].feature;if(r[B.layer.id]<_)break;d.push(B),l.pop()}else for(const T of s){const B=T[w];if(B)for(const j of B)d.push(j.feature)}}return d}queryRenderedFeatures(s,i,r){i&&i.filter&&this._validate(a.x.filter,"queryRenderedFeatures.filter",i.filter,null,i);const l={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const w of i.layers){const T=this._layers[w];if(!T)return this.fire(new a.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];l[T.source]=!0}}const d=[];i.availableImages=this._availableImages;const _=this._serializedAllLayers();for(const w in this.sourceCaches)i.layers&&!l[w]||d.push(Li(this.sourceCaches[w],this._layers,_,s,i,r));return this.placement&&d.push(function(w,T,B,j,Y,ue,Se){const Te={},Re=ue.queryRenderedSymbols(j),Be=[];for(const $e of Object.keys(Re).map(Number))Be.push(Se[$e]);Be.sort(fn);for(const $e of Be){const vt=$e.featureIndex.lookupSymbolFeatures(Re[$e.bucketInstanceId],T,$e.bucketIndex,$e.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,w);for(const ot in vt){const ct=Te[ot]=Te[ot]||[],Et=vt[ot];Et.sort((wt,ri)=>{const Xt=$e.featureSortOrder;if(Xt){const Jt=Xt.indexOf(wt.featureIndex);return Xt.indexOf(ri.featureIndex)-Jt}return ri.featureIndex-wt.featureIndex});for(const wt of Et)ct.push(wt)}}for(const $e in Te)Te[$e].forEach(vt=>{const ot=vt.feature,ct=B[w[$e].source].getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=ct});return Te}(this._layers,_,this.sourceCaches,s,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(s,i){i&&i.filter&&this._validate(a.x.filter,"querySourceFeatures.filter",i.filter,null,i);const r=this.sourceCaches[s];return r?function(l,d){const _=l.getRenderableIds().map(B=>l.getTileByID(B)),w=[],T={};for(let B=0;B<_.length;B++){const j=_[B],Y=j.tileID.canonical.key;T[Y]||(T[Y]=!0,j.querySourceFeatures(w,d))}return w}(r,i):[]}getLight(){return this.light.getLight()}setLight(s,i={}){this._checkLoaded();const r=this.light.getLight();let l=!1;for(const _ in s)if(!a.aD(s[_],r[_])){l=!0;break}if(!l)return;const d={now:oe.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,i),this.light.updateTransitions(d)}_validate(s,i,r,l,d={}){return(!d||d.validate!==!1)&&Vt(this,s.call(a.x,a.e({key:i,style:this.serialize(),value:r,styleSpec:a.v},l)))}_remove(s=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),$().off("pluginStateChange",this._rtlTextPluginStateChange);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const r=this.sourceCaches[i];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),s&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const i in this.sourceCaches)this.sourceCaches[i].update(s,this.map.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,i,r,l,d=!1){let _=!1,w=!1;const T={};for(const B of this._order){const j=this._layers[B];if(j.type!=="symbol")continue;if(!T[j.source]){const ue=this.sourceCaches[j.source];T[j.source]=ue.getRenderableIds(!0).map(Se=>ue.getTileByID(Se)).sort((Se,Te)=>Te.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(Te.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(j,T[j.source],s.center.lng);_=_||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||r===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(oe.now(),s.zoom))&&(this.pauseablePlacement=new Yi(s,this.map.terrain,this._order,d,i,r,l,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(oe.now()),w=!0),_&&this.pauseablePlacement.placement.setStale()),w||_)for(const B of this._order){const j=this._layers[B];j.type==="symbol"&&this.placement.updateLayerOpacities(j,T[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(oe.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,i.icons),r})}getGlyphs(s,i){return a._(this,void 0,void 0,function*(){const r=yield this.glyphManager.getGlyphs(i.stacks),l=this.sourceCaches[i.source];return l&&l.setDependencies(i.tileID.key,i.type,[""]),r})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,i={}){this._checkLoaded(),s&&this._validate(a.x.glyphs,"glyphs",s,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,i,r={},l){this._checkLoaded();const d=[{id:s,url:i}],_=[...mt(this.stylesheet.sprite),...d];this._validate(a.x.sprite,"sprite",_,null,r)||(this.stylesheet.sprite=_,this._loadSprite(d,!0,l))}removeSprite(s){this._checkLoaded();const i=mt(this.stylesheet.sprite);if(i.find(r=>r.id===s)){if(this._spritesImagesIds[s])for(const r of this._spritesImagesIds[s])this.imageManager.removeImage(r),this._changedImages[r]=!0;i.splice(i.findIndex(r=>r.id===s),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return mt(this.stylesheet.sprite)}setSprite(s,i={},r){this._checkLoaded(),s&&this._validate(a.x.sprite,"sprite",s,null,i)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,r):(this._unloadSprite(),r&&r(null)))}}var Br=a.X([{name:"a_pos",type:"Int16",components:2}]),Vs="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const ua={prelude:kr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:kr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:kr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:kr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:kr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:kr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:kr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:kr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:kr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:kr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:kr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:kr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:kr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:kr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:kr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:kr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:kr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:kr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:kr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:kr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:kr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:kr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:kr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Vs),terrainDepth:kr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Vs),terrainCoords:kr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Vs)};function kr(y,s){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=s.match(/attribute ([\w]+) ([\w]+)/g),l=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=d?d.concat(l):l,w={};return{fragmentSource:y=y.replace(i,(T,B,j,Y,ue)=>(w[ue]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
varying ${j} ${Y} ${ue};
#else
uniform ${j} ${Y} u_${ue};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ue}
    ${j} ${Y} ${ue} = u_${ue};
#endif
`)),vertexSource:s=s.replace(i,(T,B,j,Y,ue)=>{const Se=Y==="float"?"vec2":"vec4",Te=ue.match(/color/)?"color":Se;return w[ue]?B==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
attribute ${j} ${Se} a_${ue};
varying ${j} ${Y} ${ue};
#else
uniform ${j} ${Y} u_${ue};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = a_${ue};
#else
    ${j} ${Y} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = unpack_mix_${Te}(a_${ue}, u_${ue}_t);
#else
    ${j} ${Y} ${ue} = u_${ue};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
attribute ${j} ${Se} a_${ue};
#else
uniform ${j} ${Y} u_${ue};
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${j} ${Y} ${ue} = a_${ue};
#else
    ${j} ${Y} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${j} ${Y} ${ue} = unpack_mix_${Te}(a_${ue}, u_${ue}_t);
#else
    ${j} ${Y} ${ue} = u_${ue};
#endif
`}),staticAttributes:r,staticUniforms:_}}class Fa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,i,r,l,d,_,w,T,B){this.context=s;let j=this.boundPaintVertexBuffers.length!==l.length;for(let Y=0;!j&&Y<l.length;Y++)this.boundPaintVertexBuffers[Y]!==l[Y]&&(j=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==r||j||this.boundIndexBuffer!==d||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==B?this.freshBind(i,r,l,d,_,w,T,B):(s.bindVertexArray.set(this.vao),w&&w.bind(),d&&d.dynamicDraw&&d.bind(),T&&T.bind(),B&&B.bind())}freshBind(s,i,r,l,d,_,w,T){const B=s.numAttributes,j=this.context,Y=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=l,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,i.enableAttributes(Y,s);for(const ue of r)ue.enableAttributes(Y,s);_&&_.enableAttributes(Y,s),w&&w.enableAttributes(Y,s),T&&T.enableAttributes(Y,s),i.bind(),i.setVertexAttribPointers(Y,s,d);for(const ue of r)ue.bind(),ue.setVertexAttribPointers(Y,s,d);_&&(_.bind(),_.setVertexAttribPointers(Y,s,d)),l&&l.bind(),w&&(w.bind(),w.setVertexAttribPointers(Y,s,d)),T&&(T.bind(),T.setVertexAttribPointers(Y,s,d)),j.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function zo(y){const s=[];for(let i=0;i<y.length;i++){if(y[i]===null)continue;const r=y[i].split(" ");s.push(r.pop())}return s}class Oa{constructor(s,i,r,l,d,_){const w=s.gl;this.program=w.createProgram();const T=zo(i.staticAttributes),B=r?r.getBinderAttributes():[],j=T.concat(B),Y=ua.prelude.staticUniforms?zo(ua.prelude.staticUniforms):[],ue=i.staticUniforms?zo(i.staticUniforms):[],Se=r?r.getBinderUniforms():[],Te=Y.concat(ue).concat(Se),Re=[];for(const wt of Te)Re.indexOf(wt)<0&&Re.push(wt);const Be=r?r.defines():[];d&&Be.push("#define OVERDRAW_INSPECTOR;"),_&&Be.push("#define TERRAIN3D;");const $e=Be.concat(ua.prelude.fragmentSource,i.fragmentSource).join(`
`),vt=Be.concat(ua.prelude.vertexSource,i.vertexSource).join(`
`),ot=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ot,$e),w.compileShader(ot),!w.getShaderParameter(ot,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(ot)}`);w.attachShader(this.program,ot);const ct=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ct,vt),w.compileShader(ct),!w.getShaderParameter(ct,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(ct)}`);w.attachShader(this.program,ct),this.attributes={};const Et={};this.numAttributes=j.length;for(let wt=0;wt<this.numAttributes;wt++)j[wt]&&(w.bindAttribLocation(this.program,wt,j[wt]),this.attributes[j[wt]]=wt);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(ct),w.deleteShader(ot);for(let wt=0;wt<Re.length;wt++){const ri=Re[wt];if(ri&&!Et[ri]){const Xt=w.getUniformLocation(this.program,ri);Xt&&(Et[ri]=Xt)}}this.fixedUniforms=l(s,Et),this.terrainUniforms=((wt,ri)=>({u_depth:new a.aG(wt,ri.u_depth),u_terrain:new a.aG(wt,ri.u_terrain),u_terrain_dim:new a.aH(wt,ri.u_terrain_dim),u_terrain_matrix:new a.aI(wt,ri.u_terrain_matrix),u_terrain_unpack:new a.aJ(wt,ri.u_terrain_unpack),u_terrain_exaggeration:new a.aH(wt,ri.u_terrain_exaggeration)}))(s,Et),this.binderUniforms=r?r.getUniforms(s,Et):[]}draw(s,i,r,l,d,_,w,T,B,j,Y,ue,Se,Te,Re,Be,$e,vt){const ot=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(r),s.setStencilMode(l),s.setColorMode(d),s.setCullFace(_),T){s.activeTexture.set(ot.TEXTURE2),ot.bindTexture(ot.TEXTURE_2D,T.depthTexture),s.activeTexture.set(ot.TEXTURE3),ot.bindTexture(ot.TEXTURE_2D,T.texture);for(const Et in this.terrainUniforms)this.terrainUniforms[Et].set(T[Et])}for(const Et in this.fixedUniforms)this.fixedUniforms[Et].set(w[Et]);Re&&Re.setUniforms(s,this.binderUniforms,Se,{zoom:Te});let ct=0;switch(i){case ot.LINES:ct=2;break;case ot.TRIANGLES:ct=3;break;case ot.LINE_STRIP:ct=1}for(const Et of ue.get()){const wt=Et.vaos||(Et.vaos={});(wt[B]||(wt[B]=new Fa)).bind(s,this,j,Re?Re.getPaintVertexBuffers():[],Y,Et.vertexOffset,Be,$e,vt),ot.drawElements(i,Et.primitiveLength*ct,ot.UNSIGNED_SHORT,Et.primitiveOffset*ct*2)}}}function Xs(y,s,i){const r=1/Tt(i,1,s.transform.tileZoom),l=Math.pow(2,i.tileID.overscaledZ),d=i.tileSize*Math.pow(2,s.transform.tileZoom)/l,_=d*(i.tileID.canonical.x+i.tileID.wrap*l),w=d*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[_>>16,w>>16],u_pixel_coord_lower:[65535&_,65535&w]}}const jn=(y,s,i,r)=>{const l=s.style.light,d=l.properties.get("position"),_=[d.x,d.y,d.z],w=function(){var B=new a.A(9);return a.A!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B}();l.properties.get("anchor")==="viewport"&&function(B,j){var Y=Math.sin(j),ue=Math.cos(j);B[0]=ue,B[1]=Y,B[2]=0,B[3]=-Y,B[4]=ue,B[5]=0,B[6]=0,B[7]=0,B[8]=1}(w,-s.transform.angle),function(B,j,Y){var ue=j[0],Se=j[1],Te=j[2];B[0]=ue*Y[0]+Se*Y[3]+Te*Y[6],B[1]=ue*Y[1]+Se*Y[4]+Te*Y[7],B[2]=ue*Y[2]+Se*Y[5]+Te*Y[8]}(_,_,w);const T=l.properties.get("color");return{u_matrix:y,u_lightpos:_,u_lightintensity:l.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+i,u_opacity:r}},aa=(y,s,i,r,l,d,_)=>a.e(jn(y,s,i,r),Xs(d,s,_),{u_height_factor:-Math.pow(2,l.overscaledZ)/_.tileSize/8}),ls=y=>({u_matrix:y}),Na=(y,s,i,r)=>a.e(ls(y),Xs(i,s,r)),rl=(y,s)=>({u_matrix:y,u_world:s}),sl=(y,s,i,r,l)=>a.e(Na(y,s,i,r),{u_world:l}),Ja=(y,s,i,r)=>{const l=y.transform;let d,_;if(r.paint.get("circle-pitch-alignment")==="map"){const w=Tt(i,1,l.zoom);d=!0,_=[w,w]}else d=!1,_=l.pixelsToGLUnits;return{u_camera_to_center_distance:l.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(s.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:_}},Va=(y,s,i)=>{const r=Tt(i,1,s.zoom),l=Math.pow(2,s.zoom-i.tileID.overscaledZ),d=i.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[s.pixelsToGLUnits[0]/(r*l),s.pixelsToGLUnits[1]/(r*l)],u_overscale_factor:d}},N=(y,s,i=1)=>({u_matrix:y,u_color:s,u_overlay:0,u_overlay_scale:i}),xe=y=>({u_matrix:y}),tt=(y,s,i,r)=>({u_matrix:y,u_extrude_scale:Tt(s,1,i),u_intensity:r});function It(y,s){const i=Math.pow(2,s.canonical.z),r=s.canonical.y;return[new a.Y(0,r/i).toLngLat().lat,new a.Y(0,(r+1)/i).toLngLat().lat]}const Wt=(y,s,i,r)=>{const l=y.transform;return{u_matrix:rr(y,s,i,r),u_ratio:1/Tt(s,1,l.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},Si=(y,s,i,r,l)=>a.e(Wt(y,s,i,l),{u_image:0,u_image_height:r}),Bi=(y,s,i,r,l)=>{const d=y.transform,_=An(s,d);return{u_matrix:rr(y,s,i,l),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Tt(s,1,d.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[_,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},un=(y,s,i,r,l,d)=>{const _=y.lineAtlas,w=An(s,y.transform),T=i.layout.get("line-cap")==="round",B=_.getDash(r.from,T),j=_.getDash(r.to,T),Y=B.width*l.fromScale,ue=j.width*l.toScale;return a.e(Wt(y,s,i,d),{u_patternscale_a:[w/Y,-B.height/2],u_patternscale_b:[w/ue,-j.height/2],u_sdfgamma:_.width/(256*Math.min(Y,ue)*y.pixelRatio)/2,u_image:0,u_tex_y_a:B.y,u_tex_y_b:j.y,u_mix:l.t})};function An(y,s){return 1/Tt(y,1,s.tileZoom)}function rr(y,s,i,r){return y.translatePosMatrix(r?r.posMatrix:s.tileID.posMatrix,s,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const hr=(y,s,i,r,l)=>{return{u_matrix:y,u_tl_parent:s,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(d=l.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:zr(l.paint.get("raster-hue-rotate"))};var d,_};function zr(y){y*=Math.PI/180;const s=Math.sin(y),i=Math.cos(y);return[(2*i+1)/3,(-Math.sqrt(3)*s-i+1)/3,(Math.sqrt(3)*s-i+1)/3]}const Ua=(y,s,i,r,l,d,_,w,T,B)=>{const j=l.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:j.width/j.height,u_fade_change:l.options.fadeDuration?l.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:_,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+r,u_texsize:B,u_texture:0}},Ga=(y,s,i,r,l,d,_,w,T,B,j)=>{const Y=l.transform;return a.e(Ua(y,s,i,r,l,d,_,w,T,B),{u_gamma_scale:r?Math.cos(Y._pitch)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:l.pixelRatio,u_is_halo:+j})},qa=(y,s,i,r,l,d,_,w,T,B)=>a.e(Ga(y,s,i,r,l,d,_,w,!0,T,!0),{u_texsize_icon:B,u_texture_icon:1}),pl=(y,s,i)=>({u_matrix:y,u_opacity:s,u_color:i}),Ur=(y,s,i,r,l,d)=>a.e(function(_,w,T,B){const j=T.imageManager.getPattern(_.from.toString()),Y=T.imageManager.getPattern(_.to.toString()),{width:ue,height:Se}=T.imageManager.getPixelSize(),Te=Math.pow(2,B.tileID.overscaledZ),Re=B.tileSize*Math.pow(2,T.transform.tileZoom)/Te,Be=Re*(B.tileID.canonical.x+B.tileID.wrap*Te),$e=Re*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:Y.tl,u_pattern_br_b:Y.br,u_texsize:[ue,Se],u_mix:w.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:Y.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/Tt(B,1,T.transform.tileZoom),u_pixel_coord_upper:[Be>>16,$e>>16],u_pixel_coord_lower:[65535&Be,65535&$e]}}(r,d,i,l),{u_matrix:y,u_opacity:s}),ir={fillExtrusion:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_opacity:new a.aH(y,s.u_opacity)}),fillExtrusionPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_lightpos:new a.aK(y,s.u_lightpos),u_lightintensity:new a.aH(y,s.u_lightintensity),u_lightcolor:new a.aK(y,s.u_lightcolor),u_vertical_gradient:new a.aH(y,s.u_vertical_gradient),u_height_factor:new a.aH(y,s.u_height_factor),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade),u_opacity:new a.aH(y,s.u_opacity)}),fill:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),fillPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),fillOutline:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world)}),fillOutlinePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_texsize:new a.aL(y,s.u_texsize),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),circle:(y,s)=>({u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_scale_with_map:new a.aG(y,s.u_scale_with_map),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_matrix:new a.aI(y,s.u_matrix)}),collisionBox:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aH(y,s.u_pixels_to_tile_units),u_extrude_scale:new a.aL(y,s.u_extrude_scale),u_overscale_factor:new a.aH(y,s.u_overscale_factor)}),collisionCircle:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_inv_matrix:new a.aI(y,s.u_inv_matrix),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_viewport_size:new a.aL(y,s.u_viewport_size)}),debug:(y,s)=>({u_color:new a.aM(y,s.u_color),u_matrix:new a.aI(y,s.u_matrix),u_overlay:new a.aG(y,s.u_overlay),u_overlay_scale:new a.aH(y,s.u_overlay_scale)}),clippingMask:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix)}),heatmap:(y,s)=>({u_extrude_scale:new a.aH(y,s.u_extrude_scale),u_intensity:new a.aH(y,s.u_intensity),u_matrix:new a.aI(y,s.u_matrix)}),heatmapTexture:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_world:new a.aL(y,s.u_world),u_image:new a.aG(y,s.u_image),u_color_ramp:new a.aG(y,s.u_color_ramp),u_opacity:new a.aH(y,s.u_opacity)}),hillshade:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_latrange:new a.aL(y,s.u_latrange),u_light:new a.aL(y,s.u_light),u_shadow:new a.aM(y,s.u_shadow),u_highlight:new a.aM(y,s.u_highlight),u_accent:new a.aM(y,s.u_accent)}),hillshadePrepare:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_image:new a.aG(y,s.u_image),u_dimension:new a.aL(y,s.u_dimension),u_zoom:new a.aH(y,s.u_zoom),u_unpack:new a.aJ(y,s.u_unpack)}),line:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels)}),lineGradient:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_image:new a.aG(y,s.u_image),u_image_height:new a.aH(y,s.u_image_height)}),linePattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texsize:new a.aL(y,s.u_texsize),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_image:new a.aG(y,s.u_image),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_scale:new a.aK(y,s.u_scale),u_fade:new a.aH(y,s.u_fade)}),lineSDF:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ratio:new a.aH(y,s.u_ratio),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_units_to_pixels:new a.aL(y,s.u_units_to_pixels),u_patternscale_a:new a.aL(y,s.u_patternscale_a),u_patternscale_b:new a.aL(y,s.u_patternscale_b),u_sdfgamma:new a.aH(y,s.u_sdfgamma),u_image:new a.aG(y,s.u_image),u_tex_y_a:new a.aH(y,s.u_tex_y_a),u_tex_y_b:new a.aH(y,s.u_tex_y_b),u_mix:new a.aH(y,s.u_mix)}),raster:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_tl_parent:new a.aL(y,s.u_tl_parent),u_scale_parent:new a.aH(y,s.u_scale_parent),u_buffer_scale:new a.aH(y,s.u_buffer_scale),u_fade_t:new a.aH(y,s.u_fade_t),u_opacity:new a.aH(y,s.u_opacity),u_image0:new a.aG(y,s.u_image0),u_image1:new a.aG(y,s.u_image1),u_brightness_low:new a.aH(y,s.u_brightness_low),u_brightness_high:new a.aH(y,s.u_brightness_high),u_saturation_factor:new a.aH(y,s.u_saturation_factor),u_contrast_factor:new a.aH(y,s.u_contrast_factor),u_spin_weights:new a.aK(y,s.u_spin_weights)}),symbolIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture)}),symbolSDF:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texture:new a.aG(y,s.u_texture),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),symbolTextAndIcon:(y,s)=>({u_is_size_zoom_constant:new a.aG(y,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aG(y,s.u_is_size_feature_constant),u_size_t:new a.aH(y,s.u_size_t),u_size:new a.aH(y,s.u_size),u_camera_to_center_distance:new a.aH(y,s.u_camera_to_center_distance),u_pitch:new a.aH(y,s.u_pitch),u_rotate_symbol:new a.aG(y,s.u_rotate_symbol),u_aspect_ratio:new a.aH(y,s.u_aspect_ratio),u_fade_change:new a.aH(y,s.u_fade_change),u_matrix:new a.aI(y,s.u_matrix),u_label_plane_matrix:new a.aI(y,s.u_label_plane_matrix),u_coord_matrix:new a.aI(y,s.u_coord_matrix),u_is_text:new a.aG(y,s.u_is_text),u_pitch_with_map:new a.aG(y,s.u_pitch_with_map),u_texsize:new a.aL(y,s.u_texsize),u_texsize_icon:new a.aL(y,s.u_texsize_icon),u_texture:new a.aG(y,s.u_texture),u_texture_icon:new a.aG(y,s.u_texture_icon),u_gamma_scale:new a.aH(y,s.u_gamma_scale),u_device_pixel_ratio:new a.aH(y,s.u_device_pixel_ratio),u_is_halo:new a.aG(y,s.u_is_halo)}),background:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_color:new a.aM(y,s.u_color)}),backgroundPattern:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_opacity:new a.aH(y,s.u_opacity),u_image:new a.aG(y,s.u_image),u_pattern_tl_a:new a.aL(y,s.u_pattern_tl_a),u_pattern_br_a:new a.aL(y,s.u_pattern_br_a),u_pattern_tl_b:new a.aL(y,s.u_pattern_tl_b),u_pattern_br_b:new a.aL(y,s.u_pattern_br_b),u_texsize:new a.aL(y,s.u_texsize),u_mix:new a.aH(y,s.u_mix),u_pattern_size_a:new a.aL(y,s.u_pattern_size_a),u_pattern_size_b:new a.aL(y,s.u_pattern_size_b),u_scale_a:new a.aH(y,s.u_scale_a),u_scale_b:new a.aH(y,s.u_scale_b),u_pixel_coord_upper:new a.aL(y,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.aL(y,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aH(y,s.u_tile_units_to_pixels)}),terrain:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainDepth:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_ele_delta:new a.aH(y,s.u_ele_delta)}),terrainCoords:(y,s)=>({u_matrix:new a.aI(y,s.u_matrix),u_texture:new a.aG(y,s.u_texture),u_terrain_coords_id:new a.aH(y,s.u_terrain_coords_id),u_ele_delta:new a.aH(y,s.u_ele_delta)})};class wr{constructor(s,i,r){this.context=s;const l=s.gl;this.buffer=l.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Mr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class js{constructor(s,i,r,l){this.length=i.length,this.attributes=r,this.itemSize=i.bytesPerElement,this.dynamicDraw=l,this.context=s;const d=s.gl;this.buffer=d.createBuffer(),s.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,i){for(let r=0;r<this.attributes.length;r++){const l=i.attributes[this.attributes[r].name];l!==void 0&&s.enableVertexAttribArray(l)}}setVertexAttribPointers(s,i,r){for(let l=0;l<this.attributes.length;l++){const d=this.attributes[l],_=i.attributes[d.name];_!==void 0&&s.vertexAttribPointer(_,d.components,s[Mr[d.type]],!1,this.itemSize,d.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vr=new WeakMap;function Ks(y){var s;if(vr.has(y))return vr.get(y);{const i=(s=y.getParameter(y.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return vr.set(y,i),i}}class Pr{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bo extends Pr{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Ho extends Pr{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Ls extends Pr{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Il extends Pr{getDefault(){return[!0,!0,!0,!0]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ho extends Pr{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class jo extends Pr{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class ca extends Pr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const i=this.current;(s.func!==i.func||s.ref!==i.ref||s.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Ys extends Pr{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class El extends Pr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=s,this.dirty=!1}}class Ha extends Pr{getDefault(){return[0,1]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Ta extends Pr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=s,this.dirty=!1}}class ml extends Pr{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Cl extends Pr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.BLEND):i.disable(i.BLEND),this.current=s,this.dirty=!1}}class pu extends Pr{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class us extends Pr{getDefault(){return a.aO.transparent}set(s){const i=this.current;(s.r!==i.r||s.g!==i.g||s.b!==i.b||s.a!==i.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class sc extends Pr{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class eo extends Pr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;s?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=s,this.dirty=!1}}class to extends Pr{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class ql extends Pr{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class Ro extends Pr{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Zo extends Pr{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class wo extends Pr{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const i=this.current;(s[0]!==i[0]||s[1]!==i[1]||s[2]!==i[2]||s[3]!==i[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Us extends Pr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Qo extends Pr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Wo extends Pr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Xo extends Pr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class ba extends Pr{getDefault(){return null}set(s){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class ja extends Pr{getDefault(){return null}set(s){var i;if(s===this.current&&!this.dirty)return;const r=this.gl;Ks(r)?r.bindVertexArray(s):(i=r.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class Ts extends Pr{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class mu extends Pr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Sr extends Pr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Xn extends Pr{constructor(s,i){super(s),this.context=s,this.parent=i}getDefault(){return null}}class Yo extends Xn{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Dr extends Xn{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Za extends Xn{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Kr{constructor(s,i,r,l,d){this.context=s,this.width=i,this.height=r;const _=s.gl,w=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new Yo(s,w),l)this.depthAttachment=d?new Za(s,w):new Dr(s,w);else if(d)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,i=this.colorAttachment.get();if(i&&s.deleteTexture(i),this.depthAttachment){const r=this.depthAttachment.get();r&&s.deleteRenderbuffer(r)}s.deleteFramebuffer(this.framebuffer)}}class Ar{constructor(s,i,r){this.blendFunction=s,this.blendColor=i,this.mask=r}}Ar.Replace=[1,0],Ar.disabled=new Ar(Ar.Replace,a.aO.transparent,[!1,!1,!1,!1]),Ar.unblended=new Ar(Ar.Replace,a.aO.transparent,[!0,!0,!0,!0]),Ar.alphaBlended=new Ar([1,771],a.aO.transparent,[!0,!0,!0,!0]);class So{constructor(s){var i,r;if(this.gl=s,this.clearColor=new bo(this),this.clearDepth=new Ho(this),this.clearStencil=new Ls(this),this.colorMask=new Il(this),this.depthMask=new ho(this),this.stencilMask=new jo(this),this.stencilFunc=new ca(this),this.stencilOp=new Ys(this),this.stencilTest=new El(this),this.depthRange=new Ha(this),this.depthTest=new Ta(this),this.depthFunc=new ml(this),this.blend=new Cl(this),this.blendFunc=new pu(this),this.blendColor=new us(this),this.blendEquation=new sc(this),this.cullFace=new eo(this),this.cullFaceSide=new to(this),this.frontFace=new ql(this),this.program=new Ro(this),this.activeTexture=new Zo(this),this.viewport=new wo(this),this.bindFramebuffer=new Us(this),this.bindRenderbuffer=new Qo(this),this.bindTexture=new Wo(this),this.bindVertexBuffer=new Xo(this),this.bindElementBuffer=new ba(this),this.bindVertexArray=new ja(this),this.pixelStoreUnpack=new Ts(this),this.pixelStoreUnpackPremultiplyAlpha=new mu(this),this.pixelStoreUnpackFlipY=new Sr(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),Ks(s)){this.HALF_FLOAT=s.HALF_FLOAT;const l=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=s.RGBA16F)!==null&&i!==void 0?i:l==null?void 0:l.RGBA16F_EXT,this.RGB16F=(r=s.RGB16F)!==null&&r!==void 0?r:l==null?void 0:l.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");const l=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=l==null?void 0:l.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,i){return new wr(this,s,i)}createVertexBuffer(s,i,r){return new js(this,s,i,r)}createRenderbuffer(s,i,r){const l=this.gl,d=l.createRenderbuffer();return this.bindRenderbuffer.set(d),l.renderbufferStorage(l.RENDERBUFFER,s,i,r),this.bindRenderbuffer.set(null),d}createFramebuffer(s,i,r,l){return new Kr(this,s,i,r,l)}clear({color:s,depth:i,stencil:r}){const l=this.gl;let d=0;s&&(d|=l.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(d|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),r!==void 0&&(d|=l.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),l.clear(d)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){a.aD(s.blendFunction,Ar.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return Ks(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var i;return Ks(this.gl)?this.gl.deleteVertexArray(s):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class Nn{constructor(s,i,r){this.func=s,this.mask=i,this.range=r}}Nn.ReadOnly=!1,Nn.ReadWrite=!0,Nn.disabled=new Nn(519,Nn.ReadOnly,[0,1]);const Ol=7680;class Jr{constructor(s,i,r,l,d,_){this.test=s,this.ref=i,this.mask=r,this.fail=l,this.depthFail=d,this.pass=_}}Jr.disabled=new Jr({func:519,mask:0},0,0,Ol,Ol,Ol);class jr{constructor(s,i,r){this.enable=s,this.mode=i,this.frontFace=r}}let ks;function Cr(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=y.useProgram("collisionBox"),j=[];let Y=0,ue=0;for(let ot=0;ot<r.length;ot++){const ct=r[ot],Et=s.getTile(ct),wt=Et.getBucket(i);if(!wt)continue;let ri=ct.posMatrix;l[0]===0&&l[1]===0||(ri=y.translatePosMatrix(ct.posMatrix,Et,l,d));const Xt=_?wt.textCollisionBox:wt.iconCollisionBox,Jt=wt.collisionCircleArray;if(Jt.length>0){const si=a.F(),ji=ri;a.aP(si,wt.placementInvProjMatrix,y.transform.glCoordMatrix),a.aP(si,si,wt.placementViewportMatrix),j.push({circleArray:Jt,circleOffset:ue,transform:ji,invTransform:si,coord:ct}),Y+=Jt.length/4,ue=Y}Xt&&B.draw(w,T.LINES,Nn.disabled,Jr.disabled,y.colorModeForRenderPass(),jr.disabled,Va(ri,y.transform,Et),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ct),i.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,null,y.transform.zoom,null,null,Xt.collisionVertexBuffer)}if(!_||!j.length)return;const Se=y.useProgram("collisionCircle"),Te=new a.aQ;Te.resize(4*Y),Te._trim();let Re=0;for(const ot of j)for(let ct=0;ct<ot.circleArray.length/4;ct++){const Et=4*ct,wt=ot.circleArray[Et+0],ri=ot.circleArray[Et+1],Xt=ot.circleArray[Et+2],Jt=ot.circleArray[Et+3];Te.emplace(Re++,wt,ri,Xt,Jt,0),Te.emplace(Re++,wt,ri,Xt,Jt,1),Te.emplace(Re++,wt,ri,Xt,Jt,2),Te.emplace(Re++,wt,ri,Xt,Jt,3)}(!ks||ks.length<2*Y)&&(ks=function(ot){const ct=2*ot,Et=new a.aS;Et.resize(ct),Et._trim();for(let wt=0;wt<ct;wt++){const ri=6*wt;Et.uint16[ri+0]=4*wt+0,Et.uint16[ri+1]=4*wt+1,Et.uint16[ri+2]=4*wt+2,Et.uint16[ri+3]=4*wt+2,Et.uint16[ri+4]=4*wt+3,Et.uint16[ri+5]=4*wt+0}return Et}(Y));const Be=w.createIndexBuffer(ks,!0),$e=w.createVertexBuffer(Te,a.aR.members,!0);for(const ot of j){const ct={u_matrix:ot.transform,u_inv_matrix:ot.invTransform,u_camera_to_center_distance:(vt=y.transform).cameraToCenterDistance,u_viewport_size:[vt.width,vt.height]};Se.draw(w,T.TRIANGLES,Nn.disabled,Jr.disabled,y.colorModeForRenderPass(),jr.disabled,ct,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ot.coord),i.id,$e,Be,a.$.simpleSegment(0,2*ot.circleOffset,ot.circleArray.length,ot.circleArray.length/2),null,y.transform.zoom,null,null,null)}var vt;$e.destroy(),Be.destroy()}jr.disabled=new jr(!1,1029,2305),jr.backCCW=new jr(!0,1029,2305);const nr=a.an(new Float32Array(16));function al(y,s,i,r,l,d){const{horizontalAlign:_,verticalAlign:w}=a.at(y);return new a.P((-(_-.5)*s/l+r[0])*d,(-(w-.5)*i/l+r[1])*d)}function Xr(y,s,i,r,l,d,_,w,T,B,j){const Y=y.text.placedSymbolArray,ue=y.text.dynamicLayoutVertexArray,Se=y.icon.dynamicLayoutVertexArray,Te={};ue.clear();for(let Re=0;Re<Y.length;Re++){const Be=Y.get(Re),$e=Be.hidden||!Be.crossTileID||y.allowVerticalPlacement&&!Be.placedOrientation?null:r[Be.crossTileID];if($e){const vt=new a.P(Be.anchorX,Be.anchorY),ot=rt(vt,i?_:d,j),ct=Me(l.cameraToCenterDistance,ot.signedDistanceFromCamera);let Et=a.ai(y.textSizeData,T,Be)*ct/a.ao;i&&(Et*=y.tilePixelRatio/w);const{width:wt,height:ri,anchor:Xt,textOffset:Jt,textBoxScale:si}=$e,ji=al(Xt,wt,ri,Jt,si,Et),Zi=i?rt(vt.add(ji),d,j).point:ot.point.add(s?ji.rotate(-l.angle):ji),Ii=y.allowVerticalPlacement&&Be.placedOrientation===a.ah.vertical?Math.PI/2:0;for(let Vi=0;Vi<Be.numGlyphs;Vi++)a.aj(ue,Zi,Ii);B&&Be.associatedIconIndex>=0&&(Te[Be.associatedIconIndex]={shiftedAnchor:Zi,angle:Ii})}else Ye(Be.numGlyphs,ue)}if(B){Se.clear();const Re=y.icon.placedSymbolArray;for(let Be=0;Be<Re.length;Be++){const $e=Re.get(Be);if($e.hidden)Ye($e.numGlyphs,Se);else{const vt=Te[Be];if(vt)for(let ot=0;ot<$e.numGlyphs;ot++)a.aj(Se,vt.shiftedAnchor,vt.angle);else Ye($e.numGlyphs,Se)}}y.icon.dynamicLayoutVertexBuffer.updateData(Se)}y.text.dynamicLayoutVertexBuffer.updateData(ue)}function Io(y,s,i){return i.iconsInText&&s?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function ol(y,s,i,r,l,d,_,w,T,B,j,Y){const ue=y.context,Se=ue.gl,Te=y.transform,Re=w==="map",Be=T==="map",$e=w!=="viewport"&&i.layout.get("symbol-placement")!=="point",vt=Re&&!Be&&!$e,ot=!i.layout.get("symbol-sort-key").isConstant();let ct=!1;const Et=y.depthModeForSublayer(0,Nn.ReadOnly),wt=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ri=[];for(const Xt of r){const Jt=s.getTile(Xt),si=Jt.getBucket(i);if(!si)continue;const ji=l?si.text:si.icon;if(!ji||!ji.segments.get().length||!ji.hasVisibleVertices)continue;const Zi=ji.programConfigurations.get(i.id),Ii=l||si.sdfIcons,Vi=l?si.textSizeData:si.iconSizeData,Ui=Be||Te.pitch!==0,an=y.useProgram(Io(Ii,l,si),Zi),Bn=a.ag(Vi,Te.zoom),Ji=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Xt);let Cn,yr,er,Ia,Aa=[0,0],Bs=null;if(l)yr=Jt.glyphAtlasTexture,er=Se.LINEAR,Cn=Jt.glyphAtlasTexture.size,si.iconsInText&&(Aa=Jt.imageAtlasTexture.size,Bs=Jt.imageAtlasTexture,Ia=Ui||y.options.rotating||y.options.zooming||Vi.kind==="composite"||Vi.kind==="camera"?Se.LINEAR:Se.NEAREST);else{const Qs=i.layout.get("icon-size").constantOr(0)!==1||si.iconsNeedLinear;yr=Jt.imageAtlasTexture,er=Ii||y.options.rotating||y.options.zooming||Qs||Ui?Se.LINEAR:Se.NEAREST,Cn=Jt.imageAtlasTexture.size}const no=Tt(Jt,1,y.transform.zoom),ro=Ve(Xt.posMatrix,Be,Re,y.transform,no),Gr=ft(Xt.posMatrix,Be,Re,y.transform,no),ya=wt&&si.hasTextData(),go=i.layout.get("icon-text-fit")!=="none"&&ya&&si.hasIconData();if($e){const Qs=y.style.map.terrain?(No,Vo)=>y.style.map.terrain.getElevation(Xt,No,Vo):null,To=i.layout.get("text-rotation-alignment")==="map";ne(si,Xt.posMatrix,y,l,ro,Gr,Be,B,To,Qs)}const _o=y.translatePosMatrix(Xt.posMatrix,Jt,d,_),Zs=$e||l&&wt||go?nr:ro,es=y.translatePosMatrix(Gr,Jt,d,_,!0),ts=Ii&&i.paint.get(l?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Lr;Lr=Ii?si.iconsInText?qa(Vi.kind,Bn,vt,Be,y,_o,Zs,es,Cn,Aa):Ga(Vi.kind,Bn,vt,Be,y,_o,Zs,es,l,Cn,!0):Ua(Vi.kind,Bn,vt,Be,y,_o,Zs,es,l,Cn);const vs={program:an,buffers:ji,uniformValues:Lr,atlasTexture:yr,atlasTextureIcon:Bs,atlasInterpolation:er,atlasInterpolationIcon:Ia,isSDF:Ii,hasHalo:ts};if(ot&&si.canOverlap){ct=!0;const Qs=ji.segments.get();for(const To of Qs)ri.push({segments:new a.$([To]),sortKey:To.sortKey,state:vs,terrainData:Ji})}else ri.push({segments:ji.segments,sortKey:0,state:vs,terrainData:Ji})}ct&&ri.sort((Xt,Jt)=>Xt.sortKey-Jt.sortKey);for(const Xt of ri){const Jt=Xt.state;if(ue.activeTexture.set(Se.TEXTURE0),Jt.atlasTexture.bind(Jt.atlasInterpolation,Se.CLAMP_TO_EDGE),Jt.atlasTextureIcon&&(ue.activeTexture.set(Se.TEXTURE1),Jt.atlasTextureIcon&&Jt.atlasTextureIcon.bind(Jt.atlasInterpolationIcon,Se.CLAMP_TO_EDGE)),Jt.isSDF){const si=Jt.uniformValues;Jt.hasHalo&&(si.u_is_halo=1,Zr(Jt.buffers,Xt.segments,i,y,Jt.program,Et,j,Y,si,Xt.terrainData)),si.u_is_halo=0}Zr(Jt.buffers,Xt.segments,i,y,Jt.program,Et,j,Y,Jt.uniformValues,Xt.terrainData)}}function Zr(y,s,i,r,l,d,_,w,T,B){const j=r.context;l.draw(j,j.gl.TRIANGLES,d,_,w,jr.disabled,T,B,i.id,y.layoutVertexBuffer,y.indexBuffer,s,i.paint,r.transform.zoom,y.programConfigurations.get(i.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function hs(y,s,i,r,l){if(!i||!r||!r.imageAtlas)return;const d=r.imageAtlas.patternPositions;let _=d[i.to.toString()],w=d[i.from.toString()];if(!_&&w&&(_=w),!w&&_&&(w=_),!_||!w){const T=l.getPaintProperty(s);_=d[T],w=d[T]}_&&w&&y.setConstantPatternPositions(_,w)}function wa(y,s,i,r,l,d,_){const w=y.context.gl,T="fill-pattern",B=i.paint.get(T),j=B&&B.constantOr(1),Y=i.getCrossfadeParameters();let ue,Se,Te,Re,Be;_?(Se=j&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ue=w.LINES):(Se=j?"fillPattern":"fill",ue=w.TRIANGLES);const $e=B.constantOr(null);for(const vt of r){const ot=s.getTile(vt);if(j&&!ot.patternsLoaded())continue;const ct=ot.getBucket(i);if(!ct)continue;const Et=ct.programConfigurations.get(i.id),wt=y.useProgram(Se,Et),ri=y.style.map.terrain&&y.style.map.terrain.getTerrainData(vt);j&&(y.context.activeTexture.set(w.TEXTURE0),ot.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),Et.updatePaintBuffers(Y)),hs(Et,T,$e,ot,i);const Xt=ri?vt:null,Jt=y.translatePosMatrix(Xt?Xt.posMatrix:vt.posMatrix,ot,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(_){Re=ct.indexBuffer2,Be=ct.segments2;const si=[w.drawingBufferWidth,w.drawingBufferHeight];Te=Se==="fillOutlinePattern"&&j?sl(Jt,y,Y,ot,si):rl(Jt,si)}else Re=ct.indexBuffer,Be=ct.segments,Te=j?Na(Jt,y,Y,ot):ls(Jt);wt.draw(y.context,ue,l,y.stencilModeForClipping(vt),d,jr.disabled,Te,ri,i.id,ct.layoutVertexBuffer,Re,Be,i.paint,y.transform.zoom,Et)}}function Tl(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B="fill-extrusion-pattern",j=i.paint.get(B),Y=j.constantOr(1),ue=i.getCrossfadeParameters(),Se=i.paint.get("fill-extrusion-opacity"),Te=j.constantOr(null);for(const Re of r){const Be=s.getTile(Re),$e=Be.getBucket(i);if(!$e)continue;const vt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),ot=$e.programConfigurations.get(i.id),ct=y.useProgram(Y?"fillExtrusionPattern":"fillExtrusion",ot);Y&&(y.context.activeTexture.set(T.TEXTURE0),Be.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),ot.updatePaintBuffers(ue)),hs(ot,B,Te,Be,i);const Et=y.translatePosMatrix(Re.posMatrix,Be,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),wt=i.paint.get("fill-extrusion-vertical-gradient"),ri=Y?aa(Et,y,wt,Se,Re,ue,Be):jn(Et,y,wt,Se);ct.draw(w,w.gl.TRIANGLES,l,d,_,jr.backCCW,ri,vt,i.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,i.paint,y.transform.zoom,ot,y.style.map.terrain&&$e.centroidVertexBuffer)}}function Eo(y,s,i,r,l,d,_){const w=y.context,T=w.gl,B=i.fbo;if(!B)return;const j=y.useProgram("hillshade"),Y=y.style.map.terrain&&y.style.map.terrain.getTerrainData(s);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,B.colorAttachment.get()),j.draw(w,T.TRIANGLES,l,d,_,jr.disabled,((ue,Se,Te,Re)=>{const Be=Te.paint.get("hillshade-shadow-color"),$e=Te.paint.get("hillshade-highlight-color"),vt=Te.paint.get("hillshade-accent-color");let ot=Te.paint.get("hillshade-illumination-direction")*(Math.PI/180);Te.paint.get("hillshade-illumination-anchor")==="viewport"&&(ot-=ue.transform.angle);const ct=!ue.options.moving;return{u_matrix:Re?Re.posMatrix:ue.transform.calculatePosMatrix(Se.tileID.toUnwrapped(),ct),u_image:0,u_latrange:It(0,Se.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),ot],u_shadow:Be,u_highlight:$e,u_accent:vt}})(y,i,r,Y?s:null),Y,r.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function kl(y,s,i,r,l,d){const _=y.context,w=_.gl,T=s.dem;if(T&&T.data){const B=T.dim,j=T.stride,Y=T.getPixels();if(_.activeTexture.set(w.TEXTURE1),_.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||y.getTileTexture(j),s.demTexture){const Se=s.demTexture;Se.update(Y,{premultiply:!1}),Se.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else s.demTexture=new bt(_,Y,w.RGBA,{premultiply:!1}),s.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);_.activeTexture.set(w.TEXTURE0);let ue=s.fbo;if(!ue){const Se=new bt(_,{width:B,height:B,data:null},w.RGBA);Se.bind(w.LINEAR,w.CLAMP_TO_EDGE),ue=s.fbo=_.createFramebuffer(B,B,!0,!1),ue.colorAttachment.set(Se.texture)}_.bindFramebuffer.set(ue.framebuffer),_.viewport.set([0,0,B,B]),y.useProgram("hillshadePrepare").draw(_,w.TRIANGLES,r,l,d,jr.disabled,((Se,Te)=>{const Re=Te.stride,Be=a.F();return a.aN(Be,0,a.W,-a.W,0,0,1),a.H(Be,Be,[0,-a.W,0]),{u_matrix:Be,u_image:1,u_dimension:[Re,Re],u_zoom:Se.overscaledZ,u_unpack:Te.getUnpackVector()}})(s.tileID,T),null,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Ao(y,s,i,r,l,d){const _=r.paint.get("raster-fade-duration");if(!d&&_>0){const w=oe.now(),T=(w-y.timeAdded)/_,B=s?(w-s.timeAdded)/_:-1,j=i.getSource(),Y=l.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),ue=!s||Math.abs(s.tileID.overscaledZ-Y)>Math.abs(y.tileID.overscaledZ-Y),Se=ue&&y.refreshedUponExpiration?1:a.ac(ue?T:1-B,0,1);return y.refreshedUponExpiration&&T>=1&&(y.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Se}:{opacity:Se,mix:0}}return{opacity:1,mix:0}}const Js=new a.aO(1,0,0,1),Gs=new a.aO(0,1,0,1),Qa=new a.aO(0,0,1,1),$o=new a.aO(1,0,1,1),Yr=new a.aO(0,1,1,1);function mr(y,s,i,r){ha(y,0,s+i/2,y.transform.width,i,r)}function Rr(y,s,i,r){ha(y,s-i/2,0,i,y.transform.height,r)}function ha(y,s,i,r,l,d){const _=y.context,w=_.gl;w.enable(w.SCISSOR_TEST),w.scissor(s*y.pixelRatio,i*y.pixelRatio,r*y.pixelRatio,l*y.pixelRatio),_.clear({color:d}),w.disable(w.SCISSOR_TEST)}function fo(y,s,i){const r=y.context,l=r.gl,d=i.posMatrix,_=y.useProgram("debug"),w=Nn.disabled,T=Jr.disabled,B=y.colorModeForRenderPass(),j="$debug",Y=y.style.map.terrain&&y.style.map.terrain.getTerrainData(i);r.activeTexture.set(l.TEXTURE0);const ue=s.getTileByID(i.key).latestRawTileData,Se=Math.floor((ue&&ue.byteLength||0)/1024),Te=s.getTile(i).tileSize,Re=512/Math.min(Te,512)*(i.overscaledZ/y.transform.zoom)*.5;let Be=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(Be+=` => ${i.overscaledZ}`),function($e,vt){$e.initDebugOverlayCanvas();const ot=$e.debugOverlayCanvas,ct=$e.context.gl,Et=$e.debugOverlayCanvas.getContext("2d");Et.clearRect(0,0,ot.width,ot.height),Et.shadowColor="white",Et.shadowBlur=2,Et.lineWidth=1.5,Et.strokeStyle="white",Et.textBaseline="top",Et.font="bold 36px Open Sans, sans-serif",Et.fillText(vt,5,5),Et.strokeText(vt,5,5),$e.debugOverlayTexture.update(ot),$e.debugOverlayTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE)}(y,`${Be} ${Se}kB`),_.draw(r,l.TRIANGLES,w,T,Ar.alphaBlended,jr.disabled,N(d,a.aO.transparent,Re),null,j,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),_.draw(r,l.LINE_STRIP,w,T,B,jr.disabled,N(d,a.aO.red),Y,j,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function ea(y,s,i){const r=y.context,l=r.gl,d=y.colorModeForRenderPass(),_=new Nn(l.LEQUAL,Nn.ReadWrite,y.depthRangeFor3D),w=y.useProgram("terrain"),T=s.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,y.width,y.height]);for(const B of i){const j=y.renderToTexture.getTexture(B),Y=s.getTerrainData(B.tileID);r.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,j.texture);const ue={u_matrix:y.transform.calculatePosMatrix(B.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(y.transform.zoom)};w.draw(r,l.TRIANGLES,_,Jr.disabled,d,jr.backCCW,ue,Y,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class Sa{constructor(s,i){this.context=new So(s),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.F(),renderTime:0},this.setup(),this.numSublayers=Ie.maxUnderzooming+Ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vr}resize(s,i,r){if(this.width=Math.floor(s*r),this.height=Math.floor(i*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style._order)this.style._layers[l].resize()}setup(){const s=this.context,i=new a.aV;i.emplaceBack(0,0),i.emplaceBack(a.W,0),i.emplaceBack(0,a.W),i.emplaceBack(a.W,a.W),this.tileExtentBuffer=s.createVertexBuffer(i,Br.members),this.tileExtentSegments=a.$.simpleSegment(0,0,4,2);const r=new a.aV;r.emplaceBack(0,0),r.emplaceBack(a.W,0),r.emplaceBack(0,a.W),r.emplaceBack(a.W,a.W),this.debugBuffer=s.createVertexBuffer(r,Br.members),this.debugSegments=a.$.simpleSegment(0,0,4,5);const l=new a.Z;l.emplaceBack(0,0,0,0),l.emplaceBack(a.W,0,a.W,0),l.emplaceBack(0,a.W,0,a.W),l.emplaceBack(a.W,a.W,a.W,a.W),this.rasterBoundsBuffer=s.createVertexBuffer(l,ln.members),this.rasterBoundsSegments=a.$.simpleSegment(0,0,4,2);const d=new a.aV;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(d,Br.members),this.viewportSegments=a.$.simpleSegment(0,0,4,2);const _=new a.aW;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(_);const w=new a.aX;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new Jr({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const s=this.context,i=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=a.F();a.aN(r,0,this.width,this.height,0,0,1),a.J(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,i.TRIANGLES,Nn.disabled,this.stencilClearMode,Ar.disabled,jr.disabled,xe(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,i){if(this.currentStencilSource===s.source||!s.isTileClipped()||!i||!i.length)return;this.currentStencilSource=s.source;const r=this.context,l=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(Ar.disabled),r.setDepthMode(Nn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const _ of i){const w=this._tileClippingMaskIDs[_.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(_);d.draw(r,l.TRIANGLES,Nn.disabled,new Jr({func:l.ALWAYS,mask:0},w,255,l.KEEP,l.KEEP,l.REPLACE),Ar.disabled,jr.disabled,xe(_.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,i=this.context.gl;return new Jr({func:i.NOTEQUAL,mask:255},s,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(s){const i=this.context.gl;return new Jr({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(s){const i=this.context.gl,r=s.sort((_,w)=>w.overscaledZ-_.overscaledZ),l=r[r.length-1].overscaledZ,d=r[0].overscaledZ-l+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const _={};for(let w=0;w<d;w++)_[w+l]=new Jr({func:i.GEQUAL,mask:255},w+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=d,[_,r]}return[{[l]:Jr.disabled},r]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new Ar([s.CONSTANT_COLOR,s.ONE],new a.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ar.unblended:Ar.alphaBlended}depthModeForSublayer(s,i,r){if(!this.opaquePassEnabledForLayer())return Nn.disabled;const l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Nn(r||this.context.gl.LEQUAL,i,[l,l])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,i){this.style=s,this.options=i,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(oe.now()),this.imageManager.beginFrame();const r=this.style._order,l=this.style.sourceCaches,d={},_={},w={};for(const T in l){const B=l[T];B.used&&B.prepare(this.context),d[T]=B.getVisibleCoordinates(),_[T]=d[T].slice().reverse(),w[T]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<r.length;T++)if(this.style._layers[r[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.aY(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(a.aZ(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,j){const Y=B.context,ue=Y.gl,Se=Ar.unblended,Te=new Nn(ue.LEQUAL,Nn.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.sourceCache.getRenderableTiles(),$e=B.useProgram("terrainDepth");Y.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),Y.clear({color:a.aO.transparent,depth:1});for(const vt of Be){const ot=j.getTerrainData(vt.tileID),ct={u_matrix:B.transform.calculatePosMatrix(vt.tileID.toUnwrapped()),u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};$e.draw(Y,ue.TRIANGLES,Te,Jr.disabled,Se,jr.backCCW,ct,ot,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain),function(B,j){const Y=B.context,ue=Y.gl,Se=Ar.unblended,Te=new Nn(ue.LEQUAL,Nn.ReadWrite,[0,1]),Re=j.getTerrainMesh(),Be=j.getCoordsTexture(),$e=j.sourceCache.getRenderableTiles(),vt=B.useProgram("terrainCoords");Y.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),Y.clear({color:a.aO.transparent,depth:1}),j.coordsIndex=[];for(const ot of $e){const ct=j.getTerrainData(ot.tileID);Y.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,Be.texture);const Et={u_matrix:B.transform.calculatePosMatrix(ot.tileID.toUnwrapped()),u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(B.transform.zoom)};vt.draw(Y,ue.TRIANGLES,Te,Jr.disabled,Se,jr.backCCW,Et,ct,"terrain",Re.vertexBuffer,Re.indexBuffer,Re.segments),j.coordsIndex.push(ot.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of r){const B=this.style._layers[T];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const j=_[B.source];(B.type==="custom"||j.length)&&this.renderLayer(this,l[B.source],B,j)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.aO.black:a.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[r[this.currentLayer]],B=l[T.source],j=d[T.source];this._renderTileClippingMasks(T,j),this.renderLayer(this,B,T,j)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const T=this.style._layers[r[this.currentLayer]],B=l[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const j=(T.type==="symbol"?w:_)[T.source];this._renderTileClippingMasks(T,d[T.source]),this.renderLayer(this,B,T,j)}if(this.options.showTileBoundaries){const T=function(B,j){let Y=null;const ue=Object.values(B._layers).flatMap(Be=>Be.source&&!Be.isHidden(j)?[B.sourceCaches[Be.source]]:[]),Se=ue.filter(Be=>Be.getSource().type==="vector"),Te=ue.filter(Be=>Be.getSource().type!=="vector"),Re=Be=>{(!Y||Y.getSource().maxzoom<Be.getSource().maxzoom)&&(Y=Be)};return Se.forEach(Be=>Re(Be)),Y||Te.forEach(Be=>Re(Be)),Y}(this.style,this.transform.zoom);T&&function(B,j,Y){for(let ue=0;ue<Y.length;ue++)fo(B,j,Y[ue])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const B=T.transform.padding;mr(T,T.transform.height-(B.top||0),3,Js),mr(T,B.bottom||0,3,Gs),Rr(T,B.left||0,3,Qa),Rr(T,T.transform.width-(B.right||0),3,$o);const j=T.transform.centerPoint;(function(Y,ue,Se,Te){ha(Y,ue-1,Se-10,2,20,Te),ha(Y,ue-10,Se-1,20,2,Te)})(T,j.x,T.transform.height-j.y,Yr)}(this),this.context.setDefault()}renderLayer(s,i,r,l){if(!r.isHidden(this.transform.zoom)&&(r.type==="background"||r.type==="custom"||(l||[]).length))switch(this.id=r.id,r.type){case"symbol":(function(d,_,w,T,B){if(d.renderPass!=="translucent")return;const j=Jr.disabled,Y=d.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ue,Se,Te,Re,Be,$e,vt){const ot=Se.transform,ct=Be==="map",Et=$e==="map";for(const wt of ue){const ri=Re.getTile(wt),Xt=ri.getBucket(Te);if(!Xt||!Xt.text||!Xt.text.segments.get().length)continue;const Jt=a.ag(Xt.textSizeData,ot.zoom),si=Tt(ri,1,Se.transform.zoom),ji=Ve(wt.posMatrix,Et,ct,Se.transform,si),Zi=Te.layout.get("icon-text-fit")!=="none"&&Xt.hasIconData();if(Jt){const Ii=Math.pow(2,ot.zoom-ri.tileID.overscaledZ);Xr(Xt,ct,Et,vt,ot,ji,wt.posMatrix,Ii,Jt,Zi,Se.style.map.terrain?(Vi,Ui)=>Se.style.map.terrain.getElevation(wt,Vi,Ui):null)}}}(T,d,w,_,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),B),w.paint.get("icon-opacity").constantOr(1)!==0&&ol(d,_,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),j,Y),w.paint.get("text-opacity").constantOr(1)!==0&&ol(d,_,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),j,Y),_.map.showCollisionBoxes&&(Cr(d,_,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),Cr(d,_,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(s,i,r,l,this.style.placement.variableOffsets);break;case"circle":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("circle-opacity"),j=w.paint.get("circle-stroke-width"),Y=w.paint.get("circle-stroke-opacity"),ue=!w.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(j.constantOr(1)===0||Y.constantOr(1)===0))return;const Se=d.context,Te=Se.gl,Re=d.depthModeForSublayer(0,Nn.ReadOnly),Be=Jr.disabled,$e=d.colorModeForRenderPass(),vt=[];for(let ot=0;ot<T.length;ot++){const ct=T[ot],Et=_.getTile(ct),wt=Et.getBucket(w);if(!wt)continue;const ri=wt.programConfigurations.get(w.id),Xt=d.useProgram("circle",ri),Jt=wt.layoutVertexBuffer,si=wt.indexBuffer,ji=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ct),Zi={programConfiguration:ri,program:Xt,layoutVertexBuffer:Jt,indexBuffer:si,uniformValues:Ja(d,ct,Et,w),terrainData:ji};if(ue){const Ii=wt.segments.get();for(const Vi of Ii)vt.push({segments:new a.$([Vi]),sortKey:Vi.sortKey,state:Zi})}else vt.push({segments:wt.segments,sortKey:0,state:Zi})}ue&&vt.sort((ot,ct)=>ot.sortKey-ct.sortKey);for(const ot of vt){const{programConfiguration:ct,program:Et,layoutVertexBuffer:wt,indexBuffer:ri,uniformValues:Xt,terrainData:Jt}=ot.state;Et.draw(Se,Te.TRIANGLES,Re,Be,$e,jr.disabled,Xt,Jt,w.id,wt,ri,ot.segments,w.paint,d.transform.zoom,ct)}})(s,i,r,l);break;case"heatmap":(function(d,_,w,T){if(w.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const B=d.context,j=B.gl,Y=Jr.disabled,ue=new Ar([j.ONE,j.ONE],a.aO.transparent,[!0,!0,!0,!0]);(function(Se,Te,Re){const Be=Se.gl;Se.activeTexture.set(Be.TEXTURE1),Se.viewport.set([0,0,Te.width/4,Te.height/4]);let $e=Re.heatmapFbo;if($e)Be.bindTexture(Be.TEXTURE_2D,$e.colorAttachment.get()),Se.bindFramebuffer.set($e.framebuffer);else{const vt=Be.createTexture();Be.bindTexture(Be.TEXTURE_2D,vt),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_S,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_T,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MIN_FILTER,Be.LINEAR),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MAG_FILTER,Be.LINEAR),$e=Re.heatmapFbo=Se.createFramebuffer(Te.width/4,Te.height/4,!1,!1),function(ot,ct,Et,wt){var ri,Xt;const Jt=ot.gl,si=(ri=ot.HALF_FLOAT)!==null&&ri!==void 0?ri:Jt.UNSIGNED_BYTE,ji=(Xt=ot.RGBA16F)!==null&&Xt!==void 0?Xt:Jt.RGBA;Jt.texImage2D(Jt.TEXTURE_2D,0,ji,ct.width/4,ct.height/4,0,Jt.RGBA,si,null),wt.colorAttachment.set(Et)}(Se,Te,vt,$e)}})(B,d,w),B.clear({color:a.aO.transparent});for(let Se=0;Se<T.length;Se++){const Te=T[Se];if(_.hasRenderableParent(Te))continue;const Re=_.getTile(Te),Be=Re.getBucket(w);if(!Be)continue;const $e=Be.programConfigurations.get(w.id),vt=d.useProgram("heatmap",$e),{zoom:ot}=d.transform;vt.draw(B,j.TRIANGLES,Nn.disabled,Y,ue,jr.disabled,tt(Te.posMatrix,Re,ot,w.paint.get("heatmap-intensity")),null,w.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,w.paint,d.transform.zoom,$e)}B.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(B,j){const Y=B.context,ue=Y.gl,Se=j.heatmapFbo;if(!Se)return;Y.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_2D,Se.colorAttachment.get()),Y.activeTexture.set(ue.TEXTURE1);let Te=j.colorRampTexture;Te||(Te=j.colorRampTexture=new bt(Y,j.colorRamp,ue.RGBA)),Te.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),B.useProgram("heatmapTexture").draw(Y,ue.TRIANGLES,Nn.disabled,Jr.disabled,B.colorModeForRenderPass(),jr.disabled,((Re,Be,$e,vt)=>{const ot=a.F();a.aN(ot,0,Re.width,Re.height,0,0,1);const ct=Re.context.gl;return{u_matrix:ot,u_world:[ct.drawingBufferWidth,ct.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Be.paint.get("heatmap-opacity")}})(B,j),null,j.id,B.viewportBuffer,B.quadTriangleIndexBuffer,B.viewportSegments,j.paint,B.transform.zoom)}(d,w))})(s,i,r,l);break;case"line":(function(d,_,w,T){if(d.renderPass!=="translucent")return;const B=w.paint.get("line-opacity"),j=w.paint.get("line-width");if(B.constantOr(1)===0||j.constantOr(1)===0)return;const Y=d.depthModeForSublayer(0,Nn.ReadOnly),ue=d.colorModeForRenderPass(),Se=w.paint.get("line-dasharray"),Te=w.paint.get("line-pattern"),Re=Te.constantOr(1),Be=w.paint.get("line-gradient"),$e=w.getCrossfadeParameters(),vt=Re?"linePattern":Se?"lineSDF":Be?"lineGradient":"line",ot=d.context,ct=ot.gl;let Et=!0;for(const wt of T){const ri=_.getTile(wt);if(Re&&!ri.patternsLoaded())continue;const Xt=ri.getBucket(w);if(!Xt)continue;const Jt=Xt.programConfigurations.get(w.id),si=d.context.program.get(),ji=d.useProgram(vt,Jt),Zi=Et||ji.program!==si,Ii=d.style.map.terrain&&d.style.map.terrain.getTerrainData(wt),Vi=Te.constantOr(null);if(Vi&&ri.imageAtlas){const Bn=ri.imageAtlas,Ji=Bn.patternPositions[Vi.to.toString()],Cn=Bn.patternPositions[Vi.from.toString()];Ji&&Cn&&Jt.setConstantPatternPositions(Ji,Cn)}const Ui=Ii?wt:null,an=Re?Bi(d,ri,w,$e,Ui):Se?un(d,ri,w,Se,$e,Ui):Be?Si(d,ri,w,Xt.lineClipsArray.length,Ui):Wt(d,ri,w,Ui);if(Re)ot.activeTexture.set(ct.TEXTURE0),ri.imageAtlasTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),Jt.updatePaintBuffers($e);else if(Se&&(Zi||d.lineAtlas.dirty))ot.activeTexture.set(ct.TEXTURE0),d.lineAtlas.bind(ot);else if(Be){const Bn=Xt.gradients[w.id];let Ji=Bn.texture;if(w.gradientVersion!==Bn.version){let Cn=256;if(w.stepInterpolant){const yr=_.getSource().maxzoom,er=wt.canonical.z===yr?Math.ceil(1<<d.transform.maxZoom-wt.canonical.z):1;Cn=a.ac(a.aT(Xt.maxLineLength/a.W*1024*er),256,ot.maxTextureSize)}Bn.gradient=a.aU({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:Cn,image:Bn.gradient||void 0,clips:Xt.lineClipsArray}),Bn.texture?Bn.texture.update(Bn.gradient):Bn.texture=new bt(ot,Bn.gradient,ct.RGBA),Bn.version=w.gradientVersion,Ji=Bn.texture}ot.activeTexture.set(ct.TEXTURE0),Ji.bind(w.stepInterpolant?ct.NEAREST:ct.LINEAR,ct.CLAMP_TO_EDGE)}ji.draw(ot,ct.TRIANGLES,Y,d.stencilModeForClipping(wt),ue,jr.disabled,an,Ii,w.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,w.paint,d.transform.zoom,Jt,Xt.layoutVertexBuffer2),Et=!1}})(s,i,r,l);break;case"fill":(function(d,_,w,T){const B=w.paint.get("fill-color"),j=w.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const Y=d.colorModeForRenderPass(),ue=w.paint.get("fill-pattern"),Se=d.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&B.constantOr(a.aO.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===Se){const Te=d.depthModeForSublayer(1,d.renderPass==="opaque"?Nn.ReadWrite:Nn.ReadOnly);wa(d,_,w,T,Te,Y,!1)}if(d.renderPass==="translucent"&&w.paint.get("fill-antialias")){const Te=d.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Nn.ReadOnly);wa(d,_,w,T,Te,Y,!0)}})(s,i,r,l);break;case"fill-extrusion":(function(d,_,w,T){const B=w.paint.get("fill-extrusion-opacity");if(B!==0&&d.renderPass==="translucent"){const j=new Nn(d.context.gl.LEQUAL,Nn.ReadWrite,d.depthRangeFor3D);if(B!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))Tl(d,_,w,T,j,Jr.disabled,Ar.disabled),Tl(d,_,w,T,j,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const Y=d.colorModeForRenderPass();Tl(d,_,w,T,j,Jr.disabled,Y)}}})(s,i,r,l);break;case"hillshade":(function(d,_,w,T){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const B=d.context,j=d.depthModeForSublayer(0,Nn.ReadOnly),Y=d.colorModeForRenderPass(),[ue,Se]=d.renderPass==="translucent"?d.stencilConfigForOverlap(T):[{},T];for(const Te of Se){const Re=_.getTile(Te);Re.needsHillshadePrepare!==void 0&&Re.needsHillshadePrepare&&d.renderPass==="offscreen"?kl(d,Re,w,j,Jr.disabled,Y):d.renderPass==="translucent"&&Eo(d,Te,Re,w,j,ue[Te.overscaledZ],Y)}B.viewport.set([0,0,d.width,d.height])})(s,i,r,l);break;case"raster":(function(d,_,w,T){if(d.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const B=d.context,j=B.gl,Y=_.getSource(),ue=d.useProgram("raster"),Se=d.colorModeForRenderPass(),[Te,Re]=Y instanceof pr?[{},T]:d.stencilConfigForOverlap(T),Be=Re[Re.length-1].overscaledZ,$e=!d.options.moving;for(const vt of Re){const ot=d.depthModeForSublayer(vt.overscaledZ-Be,w.paint.get("raster-opacity")===1?Nn.ReadWrite:Nn.ReadOnly,j.LESS),ct=_.getTile(vt);ct.registerFadeDuration(w.paint.get("raster-fade-duration"));const Et=_.findLoadedParent(vt,0),wt=Ao(ct,Et,_,w,d.transform,d.style.map.terrain);let ri,Xt;const Jt=w.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;B.activeTexture.set(j.TEXTURE0),ct.texture.bind(Jt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(j.TEXTURE1),Et?(Et.texture.bind(Jt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),ri=Math.pow(2,Et.tileID.overscaledZ-ct.tileID.overscaledZ),Xt=[ct.tileID.canonical.x*ri%1,ct.tileID.canonical.y*ri%1]):ct.texture.bind(Jt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const si=d.style.map.terrain&&d.style.map.terrain.getTerrainData(vt),ji=si?vt:null,Zi=ji?ji.posMatrix:d.transform.calculatePosMatrix(vt.toUnwrapped(),$e),Ii=hr(Zi,Xt||[0,0],ri||1,wt,w);Y instanceof pr?ue.draw(B,j.TRIANGLES,ot,Jr.disabled,Se,jr.disabled,Ii,si,w.id,Y.boundsBuffer,d.quadTriangleIndexBuffer,Y.boundsSegments):ue.draw(B,j.TRIANGLES,ot,Te[vt.overscaledZ],Se,jr.disabled,Ii,si,w.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}})(s,i,r,l);break;case"background":(function(d,_,w,T){const B=w.paint.get("background-color"),j=w.paint.get("background-opacity");if(j===0)return;const Y=d.context,ue=Y.gl,Se=d.transform,Te=Se.tileSize,Re=w.paint.get("background-pattern");if(d.isPatternMissing(Re))return;const Be=!Re&&B.a===1&&j===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==Be)return;const $e=Jr.disabled,vt=d.depthModeForSublayer(0,Be==="opaque"?Nn.ReadWrite:Nn.ReadOnly),ot=d.colorModeForRenderPass(),ct=d.useProgram(Re?"backgroundPattern":"background"),Et=T||Se.coveringTiles({tileSize:Te,terrain:d.style.map.terrain});Re&&(Y.activeTexture.set(ue.TEXTURE0),d.imageManager.bind(d.context));const wt=w.getCrossfadeParameters();for(const ri of Et){const Xt=T?ri.posMatrix:d.transform.calculatePosMatrix(ri.toUnwrapped()),Jt=Re?Ur(Xt,j,d,Re,{tileID:ri,tileSize:Te},wt):pl(Xt,j,B),si=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ri);ct.draw(Y,ue.TRIANGLES,vt,$e,ot,jr.disabled,Jt,si,w.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}})(s,0,r,l);break;case"custom":(function(d,_,w){const T=d.context,B=w.implementation;if(d.renderPass==="offscreen"){const j=B.prerender;j&&(d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),j.call(B,T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),T.setColorMode(d.colorModeForRenderPass()),T.setStencilMode(Jr.disabled);const j=B.renderingMode==="3d"?new Nn(d.context.gl.LEQUAL,Nn.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,Nn.ReadOnly);T.setDepthMode(j),B.render(T.gl,d.transform.customLayerMatrix()),T.setDirty(),d.setBaseState(),T.bindFramebuffer.set(null)}})(s,0,r)}}translatePosMatrix(s,i,r,l,d){if(!r[0]&&!r[1])return s;const _=d?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(_){const B=Math.sin(_),j=Math.cos(_);r=[r[0]*j-r[1]*B,r[0]*B+r[1]*j]}const w=[d?r[0]:Tt(i,r[0],this.transform.zoom),d?r[1]:Tt(i,r[1],this.transform.zoom),0],T=new Float32Array(16);return a.H(T,s,w),T}saveTileTexture(s){const i=this._tileTextures[s.size[0]];i?i.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const i=this._tileTextures[s];return i&&i.length>0?i.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const i=this.imageManager.getPattern(s.from.toString()),r=this.imageManager.getPattern(s.to.toString());return!i||!r}useProgram(s,i){this.cache=this.cache||{};const r=s+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new Oa(this.context,ua[s],i,ir[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new bt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:s,drawingBufferHeight:i}=this.context.gl;return this.width!==s||this.height!==i}}class ka{constructor(s,i){this.points=s,this.planes=i}static fromInvProjectionMatrix(s,i,r){const l=Math.pow(2,r),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=1/(w=a.af([],w,s))[3]/i*l;return a.a_(w,w,[T,T,1/w[3],T])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=function(ue,Se){var Te=Se[0],Re=Se[1],Be=Se[2],$e=Te*Te+Re*Re+Be*Be;return $e>0&&($e=1/Math.sqrt($e)),ue[0]=Se[0]*$e,ue[1]=Se[1]*$e,ue[2]=Se[2]*$e,ue}([],function(ue,Se,Te){var Re=Se[0],Be=Se[1],$e=Se[2],vt=Te[0],ot=Te[1],ct=Te[2];return ue[0]=Be*ct-$e*ot,ue[1]=$e*vt-Re*ct,ue[2]=Re*ot-Be*vt,ue}([],xt([],d[w[0]],d[w[1]]),xt([],d[w[2]],d[w[1]]))),B=-((j=T)[0]*(Y=d[w[1]])[0]+j[1]*Y[1]+j[2]*Y[2]);var j,Y;return T.concat(B)});return new ka(d,_)}}class Wa{constructor(s,i){this.min=s,this.max=i,this.center=function(r,l,d){return r[0]=.5*l[0],r[1]=.5*l[1],r[2]=.5*l[2],r}([],function(r,l,d){return r[0]=l[0]+d[0],r[1]=l[1]+d[1],r[2]=l[2]+d[2],r}([],this.min,this.max))}quadrant(s){const i=[s%2==0,s<2],r=ni(this.min),l=ni(this.max);for(let d=0;d<i.length;d++)r[d]=i[d]?this.min[d]:this.center[d],l[d]=i[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new Wa(r,l)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let l=0;l<s.planes.length;l++){const d=s.planes[l];let _=0;for(let w=0;w<i.length;w++)a.a$(d,i[w])>=0&&_++;if(_===0)return 0;_!==i.length&&(r=!1)}if(r)return 2;for(let l=0;l<3;l++){let d=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let w=0;w<s.points.length;w++){const T=s.points[w][l]-this.min[l];d=Math.min(d,T),_=Math.max(_,T)}if(_<0||d>this.max[l]-this.min[l])return 0}return 1}}class ll{constructor(s=0,i=0,r=0,l=0){if(isNaN(s)||s<0||isNaN(i)||i<0||isNaN(r)||r<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=i,this.left=r,this.right=l}interpolate(s,i,r){return i.top!=null&&s.top!=null&&(this.top=a.z.number(s.top,i.top,r)),i.bottom!=null&&s.bottom!=null&&(this.bottom=a.z.number(s.bottom,i.bottom,r)),i.left!=null&&s.left!=null&&(this.left=a.z.number(s.left,i.left,r)),i.right!=null&&s.right!=null&&(this.right=a.z.number(s.right,i.right,r)),this}getCenter(s,i){const r=a.ac((this.left+s-this.right)/2,0,s),l=a.ac((this.top+i-this.bottom)/2,0,i);return new a.P(r,l)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new ll(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ou{constructor(s,i,r,l,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=d===void 0||!!d,this._minZoom=s||0,this._maxZoom=i||22,this._minPitch=r??0,this._maxPitch=l??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ll,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const s=new ou(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this.minElevationForCurrentTile=s.minElevationForCurrentTile,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const i=-a.b0(s,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var r=new a.A(4);return a.A!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}(),function(r,l,d){var _=l[0],w=l[1],T=l[2],B=l[3],j=Math.sin(d),Y=Math.cos(d);r[0]=_*Y+T*j,r[1]=w*Y+B*j,r[2]=_*-j+T*Y,r[3]=w*-j+B*Y}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const i=a.ac(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const i=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.tileZoom=Math.max(0,Math.floor(i)),this.scale=this.zoomScale(i),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,i,r){this._unmodified=!1,this._edgeInsets.interpolate(s,i,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const i=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,i)}getVisibleUnwrappedCoordinates(s){const i=[new a.b1(0,s)];if(this._renderWorldCopies){const r=this.pointCoordinate(new a.P(0,0)),l=this.pointCoordinate(new a.P(this.width,0)),d=this.pointCoordinate(new a.P(this.width,this.height)),_=this.pointCoordinate(new a.P(0,this.height)),w=Math.floor(Math.min(r.x,l.x,d.x,_.x)),T=Math.floor(Math.max(r.x,l.x,d.x,_.x)),B=1;for(let j=w-B;j<=T+B;j++)j!==0&&i.push(new a.b1(j,s))}return i}coveringTiles(s){var i,r;let l=this.coveringZoomLevel(s);const d=l;if(s.minzoom!==void 0&&l<s.minzoom)return[];s.maxzoom!==void 0&&l>s.maxzoom&&(l=s.maxzoom);const _=this.pointCoordinate(this.getCameraPoint()),w=a.Y.fromLngLat(this.center),T=Math.pow(2,l),B=[T*_.x,T*_.y,0],j=[T*w.x,T*w.y,0],Y=ka.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l);let ue=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ue=l);const Se=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,Te=ot=>({aabb:new Wa([ot*T,0,0],[(ot+1)*T,T,0]),zoom:0,x:0,y:0,wrap:ot,fullyVisible:!1}),Re=[],Be=[],$e=l,vt=s.reparseOverscaled?d:l;if(this._renderWorldCopies)for(let ot=1;ot<=3;ot++)Re.push(Te(-ot)),Re.push(Te(ot));for(Re.push(Te(0));Re.length>0;){const ot=Re.pop(),ct=ot.x,Et=ot.y;let wt=ot.fullyVisible;if(!wt){const ji=ot.aabb.intersects(Y);if(ji===0)continue;wt=ji===2}const ri=s.terrain?B:j,Xt=ot.aabb.distanceX(ri),Jt=ot.aabb.distanceY(ri),si=Math.max(Math.abs(Xt),Math.abs(Jt));if(ot.zoom===$e||si>Se+(1<<$e-ot.zoom)-2&&ot.zoom>=ue){const ji=$e-ot.zoom,Zi=B[0]-.5-(ct<<ji),Ii=B[1]-.5-(Et<<ji);Be.push({tileID:new a.Q(ot.zoom===$e?vt:ot.zoom,ot.wrap,ot.zoom,ct,Et),distanceSq:_t([j[0]-.5-ct,j[1]-.5-Et]),tileDistanceToCamera:Math.sqrt(Zi*Zi+Ii*Ii)})}else for(let ji=0;ji<4;ji++){const Zi=(ct<<1)+ji%2,Ii=(Et<<1)+(ji>>1),Vi=ot.zoom+1;let Ui=ot.aabb.quadrant(ji);if(s.terrain){const an=new a.Q(Vi,ot.wrap,Vi,Zi,Ii),Bn=s.terrain.getMinMaxElevation(an),Ji=(i=Bn.minElevation)!==null&&i!==void 0?i:this.elevation,Cn=(r=Bn.maxElevation)!==null&&r!==void 0?r:this.elevation;Ui=new Wa([Ui.min[0],Ui.min[1],Ji],[Ui.max[0],Ui.max[1],Cn])}Re.push({aabb:Ui,zoom:Vi,x:Zi,y:Ii,wrap:ot.wrap,fullyVisible:wt})}}return Be.sort((ot,ct)=>ot.distanceSq-ct.distanceSq).map(ot=>ot.tileID)}resize(s,i){this.width=s,this.height=i,this.pixelsToGLUnits=[2/s,-2/i],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const i=a.ac(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.N(s.lng)*this.worldSize,a.O(i)*this.worldSize)}unproject(s){return new a.Y(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const i=this.pointLocation(this.centerPoint,s),r=s.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-r))return;const l=this.getCameraPosition(),d=a.Y.fromLngLat(l.lngLat,l.altitude),_=a.Y.fromLngLat(i,r),w=d.x-_.x,T=d.y-_.y,B=d.z-_.z,j=Math.sqrt(w*w+T*T+B*B),Y=this.scaleZoom(this.cameraToCenterDistance/j/this.tileSize);this._elevation=r,this._center=i,this.zoom=Y}setLocationAtPoint(s,i){const r=this.pointCoordinate(i),l=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(s),_=new a.Y(d.x-(r.x-l.x),d.y-(r.y-l.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,i){return i?this.coordinatePoint(this.locationCoordinate(s),i.getElevationForLngLatZoom(s,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,i){return this.coordinateLocation(this.pointCoordinate(s,i))}locationCoordinate(s){return a.Y.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,i){if(i){const ue=i.pointCoordinate(s);if(ue!=null)return ue}const r=[s.x,s.y,0,1],l=[s.x,s.y,1,1];a.af(r,r,this.pixelMatrixInverse),a.af(l,l,this.pixelMatrixInverse);const d=r[3],_=l[3],w=r[1]/d,T=l[1]/_,B=r[2]/d,j=l[2]/_,Y=B===j?0:(0-B)/(j-B);return new a.Y(a.z.number(r[0]/d,l[0]/_,Y)/this.worldSize,a.z.number(w,T,Y)/this.worldSize)}coordinatePoint(s,i=0,r=this.pixelMatrix){const l=[s.x*this.worldSize,s.y*this.worldSize,i,1];return a.af(l,l,r),new a.P(l[0]/l[3],l[1]/l[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return new gi().extend(this.pointLocation(new a.P(0,s))).extend(this.pointLocation(new a.P(this.width,s))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new gi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,i=!1){const r=s.key,l=i?this._alignedPosMatrixCache:this._posMatrixCache;if(l[r])return l[r];const d=s.canonical,_=this.worldSize/this.zoomScale(d.z),w=d.x+Math.pow(2,d.z)*s.wrap,T=a.an(new Float64Array(16));return a.H(T,T,[w*_,d.y*_,0]),a.J(T,T,[_/a.W,_/a.W,1]),a.K(T,i?this.alignedProjMatrix:this.projMatrix,T),l[r]=new Float32Array(T),l[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;let s=this.lngRange;if(!this._renderWorldCopies&&s===null){const Te=179.9999999999;s=[-Te,Te]}this._constraining=!0;let i,r,l,d,_=-90,w=90,T=-180,B=180;const j=this.size,Y=this._unmodified;if(this.latRange){const Te=this.latRange;_=a.O(Te[1])*this.worldSize,w=a.O(Te[0])*this.worldSize,i=w-_<j.y?j.y/(w-_):0}s&&(T=a.b0(a.N(s[0])*this.worldSize,0,this.worldSize),B=a.b0(a.N(s[1])*this.worldSize,0,this.worldSize),B<T&&(B+=this.worldSize),r=B-T<j.x?j.x/(B-T):0);const ue=this.point,Se=Math.max(r||0,i||0);if(Se)return this.center=this.unproject(new a.P(r?(B+T)/2:ue.x,i?(w+_)/2:ue.y)),this.zoom+=this.scaleZoom(Se),this._unmodified=Y,void(this._constraining=!1);if(this.latRange){const Te=ue.y,Re=j.y/2;Te-Re<_&&(d=_+Re),Te+Re>w&&(d=w-Re)}if(s){const Te=(T+B)/2;let Re=ue.x;this._renderWorldCopies&&(Re=a.b0(ue.x,Te-this.worldSize/2,Te+this.worldSize/2));const Be=j.x/2;Re-Be<T&&(l=T+Be),Re+Be>B&&(l=B-Be)}l===void 0&&d===void 0||(this.center=this.unproject(new a.P(l!==void 0?l:ue.x,d!==void 0?d:ue.y)).wrap()),this._unmodified=Y,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,i=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b2(1,this.center.lat)*this.worldSize;let l=a.an(new Float64Array(16));a.J(l,l,[this.width/2,-this.height/2,1]),a.H(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=a.an(new Float64Array(16)),a.J(l,l,[1,-1,1]),a.H(l,l,[-1,-1,0]),a.J(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l;const d=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),_=Math.min(this.elevation,this.minElevationForCurrentTile),w=d-_*this._pixelPerMeter/Math.cos(this._pitch),T=_<0?w:d,B=Math.PI/2+this._pitch,j=this._fov*(.5+s.y/this.height),Y=Math.sin(j)*T/Math.sin(a.ac(Math.PI-B-j,.01,Math.PI-.01)),ue=this.getHorizon(),Se=2*Math.atan(ue/this.cameraToCenterDistance)*(.5+s.y/(2*ue)),Te=Math.sin(Se)*T/Math.sin(a.ac(Math.PI-B-Se,.01,Math.PI-.01)),Re=Math.min(Y,Te),Be=1.01*(Math.cos(Math.PI/2-this._pitch)*Re+T),$e=this.height/50;l=new Float64Array(16),a.b3(l,this._fov,this.width/this.height,$e,Be),l[8]=2*-s.x/this.width,l[9]=2*s.y/this.height,a.J(l,l,[1,-1,1]),a.H(l,l,[0,0,-this.cameraToCenterDistance]),a.b4(l,l,this._pitch),a.ad(l,l,this.angle),a.H(l,l,[-i,-r,0]),this.mercatorMatrix=a.J([],l,[this.worldSize,this.worldSize,this.worldSize]),a.J(l,l,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.K(new Float64Array(16),this.labelPlaneMatrix,l),a.H(l,l,[0,0,-this.elevation]),this.projMatrix=l,this.invProjMatrix=a.ar([],l),this.pixelMatrix3D=a.K(new Float64Array(16),this.labelPlaneMatrix,l);const vt=this.width%2/2,ot=this.height%2/2,ct=Math.cos(this.angle),Et=Math.sin(this.angle),wt=i-Math.round(i)+ct*vt+Et*ot,ri=r-Math.round(r)+ct*ot+Et*vt,Xt=new Float64Array(l);if(a.H(Xt,Xt,[wt>.5?wt-1:wt,ri>.5?ri-1:ri,0]),this.alignedProjMatrix=Xt,l=a.ar(new Float64Array(16),this.pixelMatrix),!l)throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new a.P(0,0)),i=[s.x*this.worldSize,s.y*this.worldSize,0,1];return a.af(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,s))}getCameraQueryGeometry(s){const i=this.getCameraPoint();if(s.length===1)return[s[0],i];{let r=i.x,l=i.y,d=i.x,_=i.y;for(const w of s)r=Math.min(r,w.x),l=Math.min(l,w.y),d=Math.max(d,w.x),_=Math.max(_,w.y);return[new a.P(r,l),new a.P(d,l),new a.P(d,_),new a.P(r,_),new a.P(r,l)]}}lngLatToCameraDepth(s,i){const r=this.locationCoordinate(s),l=[r.x*this.worldSize,r.y*this.worldSize,i,1];return a.af(l,l,this.projMatrix),l[2]/l[3]}}function gl(y,s){let i,r=!1,l=null,d=null;const _=()=>{l=null,r&&(y.apply(d,i),l=setTimeout(_,s),r=!1)};return(...w)=>(r=!0,d=this,i=w,l||_(),l)}class io{constructor(s){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let r;return i.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(r=l)}),(r&&r[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(i.length>=3&&!i.some(r=>isNaN(r))){const r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:r,pitch:+(i[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch{}},this._updateHash=gl(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const i=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,l=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,l),_=Math.round(i.lng*d)/d,w=Math.round(i.lat*d)/d,T=this._map.getBearing(),B=this._map.getPitch();let j="";if(j+=s?`/${_}/${w}/${r}`:`${r}/${w}/${_}`,(T||B)&&(j+="/"+Math.round(10*T)/10),B&&(j+=`/${Math.round(B)}`),this._hashName){const Y=this._hashName;let ue=!1;const Se=window.location.hash.slice(1).split("&").map(Te=>{const Re=Te.split("=")[0];return Re===Y?(ue=!0,`${Re}=${j}`):Te}).filter(Te=>Te);return ue||Se.push(`${Y}=${j}`),`#${Se.join("&")}`}return`#${j}`}}const mi={linearity:.3,easing:a.b5(0,0,.3,1)},Ni=a.e({deceleration:2500,maxSpeed:1400},mi),Di=a.e({deceleration:20,maxSpeed:1400},mi),Ot=a.e({deceleration:1e3,maxSpeed:360},mi),ei=a.e({deceleration:1e3,maxSpeed:90},mi);class xi{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:oe.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,i=oe.now();for(;s.length>0&&i-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)i.zoom+=d.zoomDelta||0,i.bearing+=d.bearingDelta||0,i.pitch+=d.pitchDelta||0,d.panDelta&&i.pan._add(d.panDelta),d.around&&(i.around=d.around),d.pinchAround&&(i.pinchAround=d.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,l={};if(i.pan.mag()){const d=Ln(i.pan.mag(),r,a.e({},Ni,s||{}));l.offset=i.pan.mult(d.amount/i.pan.mag()),l.center=this._map.transform.center,Oi(l,d)}if(i.zoom){const d=Ln(i.zoom,r,Di);l.zoom=this._map.transform.zoom+d.amount,Oi(l,d)}if(i.bearing){const d=Ln(i.bearing,r,Ot);l.bearing=this._map.transform.bearing+a.ac(d.amount,-179,179),Oi(l,d)}if(i.pitch){const d=Ln(i.pitch,r,ei);l.pitch=this._map.transform.pitch+d.amount,Oi(l,d)}if(l.zoom||l.bearing){const d=i.pinchAround===void 0?i.around:i.pinchAround;l.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),a.e(l,{noMoveStart:!0})}}function Oi(y,s){(!y.duration||y.duration<s.duration)&&(y.duration=s.duration,y.easing=s.easing)}function Ln(y,s,i){const{maxSpeed:r,linearity:l,deceleration:d}=i,_=a.ac(y*l/(s/1e3),-r,r),w=Math.abs(_)/(d*l);return{easing:i.easing,duration:1e3*w,amount:_*(w/2)}}class Un extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r,l={}){const d=fe.mousePos(i.getCanvas(),r),_=i.unproject(d);super(s,a.e({point:d,lngLat:_,originalEvent:r},l)),this._defaultPrevented=!1,this.target=i}}class or extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){const l=s==="touchend"?r.changedTouches:r.touches,d=fe.touchPos(i.getCanvasContainer(),l),_=d.map(T=>i.unproject(T)),w=d.reduce((T,B,j,Y)=>T.add(B.div(Y.length)),new a.P(0,0));super(s,{points:d,point:w,lngLats:_,lngLat:i.unproject(w),originalEvent:r}),this._defaultPrevented=!1}}class Yn extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,i,r){super(s,{originalEvent:r}),this._defaultPrevented=!1}}class qs{constructor(s,i){this._map=s,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Yn(s.type,this._map,s))}mousedown(s,i){return this._mousedownPos=i,this._firePreventable(new Un(s.type,this._map,s))}mouseup(s){this._map.fire(new Un(s.type,this._map,s))}click(s,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new Un(s.type,this._map,s))}dblclick(s){return this._firePreventable(new Un(s.type,this._map,s))}mouseover(s){this._map.fire(new Un(s.type,this._map,s))}mouseout(s){this._map.fire(new Un(s.type,this._map,s))}touchstart(s){return this._firePreventable(new or(s.type,this._map,s))}touchmove(s){this._map.fire(new or(s.type,this._map,s))}touchend(s){this._map.fire(new or(s.type,this._map,s))}touchcancel(s){this._map.fire(new or(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ms{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new Un(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Un("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new Un(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class As{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(a.P.convert(s),this._map.terrain)}}class Xa{constructor(s,i){this._map=s,this._tr=new As(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,i){this.isEnabled()&&s.shiftKey&&s.button===0&&(fe.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(s,i){if(!this._active)return;const r=i;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const l=this._startPos;this._lastPos=r,this._box||(this._box=fe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));const d=Math.min(l.x,r.x),_=Math.max(l.x,r.x),w=Math.min(l.y,r.y),T=Math.max(l.y,r.y);fe.setTransform(this._box,`translate(${d}px,${w}px)`),this._box.style.width=_-d+"px",this._box.style.height=T-w+"px"}mouseupWindow(s,i){if(!this._active||s.button!==0)return;const r=this._startPos,l=i;if(this.reset(),fe.suppressClick(),r.x!==l.x||r.y!==l.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:s})),{cameraAnimation:d=>d.fitScreenCoordinates(r,l,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(fe.remove(this._box),this._box=null),fe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,i){return this._map.fire(new a.k(s,{originalEvent:i}))}}function po(y,s){if(y.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${s.length}`);const i={};for(let r=0;r<y.length;r++)i[y[r].identifier]=s[r];return i}class rs{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),r.length===this.numTouches&&(this.centroid=function(l){const d=new a.P(0,0);for(const _ of l)d._add(_);return d.div(l.length)}(i),this.touches=po(r,i)))}touchmove(s,i,r){if(this.aborted||!this.centroid)return;const l=po(r,i);for(const d in this.touches){const _=l[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}touchend(s,i,r){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),r.length===0){const l=!this.aborted&&this.centroid;if(this.reset(),l)return l}}}class Qu{constructor(s){this.singleTap=new rs(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,i,r){this.singleTap.touchstart(s,i,r)}touchmove(s,i,r){this.singleTap.touchmove(s,i,r)}touchend(s,i,r){const l=this.singleTap.touchend(s,i,r);if(l){const d=s.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(l)<30;if(d&&_||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}}}class zu{constructor(s){this._tr=new As(s),this._zoomIn=new Qu({numTouches:1,numTaps:2}),this._zoomOut=new Qu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,i,r){this._zoomIn.touchstart(s,i,r),this._zoomOut.touchstart(s,i,r)}touchmove(s,i,r){this._zoomIn.touchmove(s,i,r),this._zoomOut.touchmove(s,i,r)}touchend(s,i,r){const l=this._zoomIn.touchend(s,i,r),d=this._zoomOut.touchend(s,i,r),_=this._tr;return l?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(l)},{originalEvent:s})}):d?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(d)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mo{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){const i=this._moveFunction(...s);if(i.bearingDelta||i.pitchDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(s,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=i.length?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,i){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);const l=i.length?i[0]:i;return!this._moved&&l.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=l,this._move(r,l))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&fe.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ml={0:1,2:2};class Pn{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){const i=fe.mouseButton(s);this._eventButton=i}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(i,r){const l=Ml[r];return i.buttons===void 0||(i.buttons&l)!==l}(s,this._eventButton)}isValidEndEvent(s){return fe.mouseButton(s)===this._eventButton}}class Ma{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}const bn=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=function(s){s.preventDefault()}},Fo=({enable:y,clickTolerance:s,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Pn({checkCorrectEvent:l=>fe.mouseButton(l)===0&&l.ctrlKey||fe.mouseButton(l)===2});return new mo({clickTolerance:s,move:(l,d)=>({bearingDelta:(d.x-l.x)*i}),moveStateManager:r,enable:y,assignEvents:bn})},Nl=({enable:y,clickTolerance:s,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Pn({checkCorrectEvent:l=>fe.mouseButton(l)===0&&l.ctrlKey||fe.mouseButton(l)===2});return new mo({clickTolerance:s,move:(l,d)=>({pitchDelta:(d.y-l.y)*i}),moveStateManager:r,enable:y,assignEvents:bn})};class Sn{constructor(s,i){this._clickTolerance=s.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(s,i,r){return this._calculateTransform(s,i,r)}touchmove(s,i,r){if(this._active&&!(r.length<this.minTouchs()))return s.preventDefault(),this._calculateTransform(s,i,r)}touchend(s,i,r){this._calculateTransform(s,i,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,i,r){r.length>0&&(this._active=!0);const l=po(r,i),d=new a.P(0,0),_=new a.P(0,0);let w=0;for(const B in l){const j=l[B],Y=this._touches[B];Y&&(d._add(j),_._add(j.sub(Y)),w++,l[B]=j)}if(this._touches=l,w<this.minTouchs()||!_.mag())return;const T=_.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,i,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([i[0],i[1]]))}touchmove(s,i,r){if(!this._firstTwoTouches)return;s.preventDefault();const[l,d]=this._firstTwoTouches,_=In(r,i,l),w=In(r,i,d);if(!_||!w)return;const T=this._aroundCenter?null:_.add(w).div(2);return this._move([_,w],T,s)}touchend(s,i,r){if(!this._firstTwoTouches)return;const[l,d]=this._firstTwoTouches,_=In(r,i,l),w=In(r,i,d);_&&w||(this._active&&fe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function In(y,s,i){for(let r=0;r<y.length;r++)if(y[r].identifier===i)return s[r]}function _l(y,s){return Math.log(y/s)/Math.LN2}class lu extends Hl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,i){const r=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(_l(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_l(this._distance,r),pinchAround:i}}}function Ru(y,s){return 180*y.angleWith(s)/Math.PI}class Vl extends Hl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,i,r){const l=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ru(this._vector,l),pinchAround:i}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const i=25/(Math.PI*this._minDiameter)*360,r=Ru(s,this._startVector);return Math.abs(r)<i}}function yl(y){return Math.abs(y.y)>Math.abs(y.x)}class ta extends Hl{constructor(s){super(),this._currentTouchCount=0,this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,i,r){super.touchstart(s,i,r),this._currentTouchCount=r.length}_start(s){this._lastPoints=s,yl(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,i,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const l=s[0].sub(this._lastPoints[0]),d=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(l,d,r.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(l.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(s,i,r){if(this._valid!==void 0)return this._valid;const l=s.mag()>=2,d=i.mag()>=2;if(!l&&!d)return;if(!l||!d)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<100&&void 0;const _=s.y>0==i.y>0;return yl(s)&&yl(i)&&_}}const ac={panStep:100,bearingStep:15,pitchStep:10};class Wu{constructor(s){this._tr=new As(s);const i=ac;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let i=0,r=0,l=0,d=0,_=0;switch(s.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:s.shiftKey?r=-1:(s.preventDefault(),d=-1);break;case 39:s.shiftKey?r=1:(s.preventDefault(),d=1);break;case 38:s.shiftKey?l=1:(s.preventDefault(),_=-1);break;case 40:s.shiftKey?l=-1:(s.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(r=0,l=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:jl,zoom:i?Math.round(T.zoom)+i*(s.shiftKey?2:1):T.zoom,bearing:T.bearing+r*this._bearingStep,pitch:T.pitch+l*this._pitchStep,offset:[-d*this._panStep,-_*this._panStep],center:T.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function jl(y){return y*(2-y)}const fs=4.000244140625;class _a{constructor(s,i){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=s,this._tr=new As(s),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!s[this._map.cooperativeGestures._bypassKey])return;let i=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const r=oe.now(),l=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,i!==0&&i%fs==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),s.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=s,this._delta-=i,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=fe.mousePos(this._map.getCanvas(),s),r=this._tr;this._around=i.y>r.transform.height/2-r.transform.getHorizon()?a.M.convert(this._aroundCenter?r.center:r.unproject(i)):a.M.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>fs?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const B=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(B*T))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,r=this._startZoom,l=this._easing;let d,_=!1;if(this._type==="wheel"&&r&&l){const w=Math.min((oe.now()-this._lastWheelEventTime)/200,1),T=l(w);d=a.z.number(r,i,T),w<1?this._frameId||(this._frameId=!0):_=!0}else d=i,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!_,zoomDelta:d-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let i=a.b6;if(this._prevEase){const r=this._prevEase,l=(oe.now()-r.start)/r.duration,d=r.easing(l+.01)-r.easing(l),_=.27/Math.sqrt(d*d+1e-4)*.01,w=Math.sqrt(.0729-_*_);i=a.b5(_,w,.25,1)}return this._prevEase={start:oe.now(),duration:s,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ko{constructor(s,i){this._clickZoom=s,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gu{constructor(s){this._tr=new As(s),this.reset()}reset(){this._active=!1}dblclick(s,i){return s.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fu{constructor(){this._tap=new Qu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,i,r){if(!this._swipePoint)if(this._tapTime){const l=i[0],d=s.timeStamp-this._tapTime<500,_=this._tapPoint.dist(l)<30;d&&_?r.length>0&&(this._swipePoint=l,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(s,i,r)}touchmove(s,i,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const l=i[0],d=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(s,i,r)}touchend(s,i,r){if(this._tapTime)this._swipePoint&&r.length===0&&this.reset();else{const l=this._tap.touchend(s,i,r);l&&(this._tapTime=s.timeStamp,this._tapPoint=l)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uu{constructor(s,i,r){this._el=s,this._mousePan=i,this._touchPan=r}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ou{constructor(s,i,r){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=i,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class _r{constructor(s,i,r,l){this._el=s,this._touchZoom=i,this._touchRotate=r,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ds{constructor(s,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=s,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const s=this._map.getCanvasContainer();s.classList.add("maplibregl-cooperative-gestures"),this._container=fe.create("div","maplibregl-cooperative-gesture-screen",s);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),l=document.createElement("div");l.className="maplibregl-desktop-message",l.textContent=i,this._container.appendChild(l);const d=document.createElement("div");d.className="maplibregl-mobile-message",d.textContent=r,this._container.appendChild(d),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(fe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(s){this._onCooperativeGesture(s.touches.length===1)}wheel(s){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!s[this._bypassKey])}_onCooperativeGesture(s){this._enabled&&s&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const pn=y=>y.zoom||y.drag||y.pitch||y.rotate;class Gn extends a.k{}function Jn(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class Jo{constructor(s,i){this.handleWindowEvent=l=>{this.handleEvent(l,`${l.type}Window`)},this.handleEvent=(l,d)=>{if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=l.type==="renderFrame"?void 0:l,w={needsRenderFrame:!1},T={},B={},j=l.touches,Y=j?this._getMapTouches(j):void 0,ue=Y?fe.touchPos(this._map.getCanvas(),Y):fe.mousePos(this._map.getCanvas(),l);for(const{handlerName:Re,handler:Be,allowed:$e}of this._handlers){if(!Be.isEnabled())continue;let vt;this._blockedByActive(B,$e,Re)?Be.reset():Be[d||l.type]&&(vt=Be[d||l.type](l,ue,Y),this.mergeHandlerResult(w,T,vt,Re,_),vt&&vt.needsRenderFrame&&this._triggerRenderFrame()),(vt||Be.isActive())&&(B[Re]=Be)}const Se={};for(const Re in this._previousActiveHandlers)B[Re]||(Se[Re]=_);this._previousActiveHandlers=B,(Object.keys(Se).length||Jn(w))&&(this._changes.push([w,T,Se]),this._triggerRenderFrame()),(Object.keys(B).length||Jn(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Te}=w;Te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Te(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xi(s),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[l,d,_]of this._listeners)fe.addEventListener(l,d,l===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[s,i,r]of this._listeners)fe.removeEventListener(s,i,s===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(s){const i=this._map,r=i.getCanvasContainer();this._add("mapEvent",new qs(i,s));const l=i.boxZoom=new Xa(i,s);this._add("boxZoom",l),s.interactive&&s.boxZoom&&l.enable();const d=i.cooperativeGestures=new ds(i,s.cooperativeGestures);this._add("cooperativeGestures",d),s.cooperativeGestures&&d.enable();const _=new zu(i),w=new gu(i);i.doubleClickZoom=new Ko(w,_),this._add("tapZoom",_),this._add("clickZoom",w),s.interactive&&s.doubleClickZoom&&i.doubleClickZoom.enable();const T=new Fu;this._add("tapDragZoom",T);const B=i.touchPitch=new ta(i);this._add("touchPitch",B),s.interactive&&s.touchPitch&&i.touchPitch.enable(s.touchPitch);const j=Fo(s),Y=Nl(s);i.dragRotate=new Ou(s,j,Y),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]),s.interactive&&s.dragRotate&&i.dragRotate.enable();const ue=(({enable:vt,clickTolerance:ot})=>{const ct=new Pn({checkCorrectEvent:Et=>fe.mouseButton(Et)===0&&!Et.ctrlKey});return new mo({clickTolerance:ot,move:(Et,wt)=>({around:wt,panDelta:wt.sub(Et)}),activateOnStart:!0,moveStateManager:ct,enable:vt,assignEvents:bn})})(s),Se=new Sn(s,i);i.dragPan=new uu(r,ue,Se),this._add("mousePan",ue),this._add("touchPan",Se,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&i.dragPan.enable(s.dragPan);const Te=new Vl,Re=new lu;i.touchZoomRotate=new _r(r,Re,Te,T),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",Re,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&i.touchZoomRotate.enable(s.touchZoomRotate);const Be=i.scrollZoom=new _a(i,()=>this._triggerRenderFrame());this._add("scrollZoom",Be,["mousePan"]),s.interactive&&s.scrollZoom&&i.scrollZoom.enable(s.scrollZoom);const $e=i.keyboard=new Wu(i);this._add("keyboard",$e),s.interactive&&s.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new Ms(i))}_add(s,i,r){this._handlers.push({handlerName:s,handler:i,allowed:r}),this._handlersById[s]=i}stop(s){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pn(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,i,r){for(const l in s)if(l!==r&&(!i||i.indexOf(l)<0))return!0;return!1}_getMapTouches(s){const i=[];for(const r of s)this._el.contains(r.target)&&i.push(r);return i}mergeHandlerResult(s,i,r,l,d){if(!r)return;a.e(s,r);const _={handlerName:l,originalEvent:r.originalEvent||d};r.zoomDelta!==void 0&&(i.zoom=_),r.panDelta!==void 0&&(i.drag=_),r.pitchDelta!==void 0&&(i.pitch=_),r.bearingDelta!==void 0&&(i.rotate=_)}_applyChanges(){const s={},i={},r={};for(const[l,d,_]of this._changes)l.panDelta&&(s.panDelta=(s.panDelta||new a.P(0,0))._add(l.panDelta)),l.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+l.zoomDelta),l.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+l.bearingDelta),l.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+l.pitchDelta),l.around!==void 0&&(s.around=l.around),l.pinchAround!==void 0&&(s.pinchAround=l.pinchAround),l.noInertia&&(s.noInertia=l.noInertia),a.e(i,d),a.e(r,_);this._updateMapTransform(s,i,r),this._changes=[]}_updateMapTransform(s,i,r){const l=this._map,d=l._getTransformForUpdate(),_=l.terrain;if(!(Jn(s)||_&&this._terrainMovement))return this._fireEvents(i,r,!0);let{panDelta:w,zoomDelta:T,bearingDelta:B,pitchDelta:j,around:Y,pinchAround:ue}=s;ue!==void 0&&(Y=ue),l._stop(!0),Y=Y||l.transform.centerPoint;const Se=d.pointLocation(w?Y.sub(w):Y);B&&(d.bearing+=B),j&&(d.pitch+=j),T&&(d.zoom+=T),_?this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?d.center=d.pointLocation(d.centerPoint.sub(w)):d.setLocationAtPoint(Se,Y):(this._terrainMovement=!0,this._map._elevationFreeze=!0,d.setLocationAtPoint(Se,Y),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,d.recalculateZoom(l.terrain)})):d.setLocationAtPoint(Se,Y),l._applyUpdatedTransform(d),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(i,r,!0)}_fireEvents(s,i,r){const l=pn(this._eventsInProgress),d=pn(s),_={};for(const j in s){const{originalEvent:Y}=s[j];this._eventsInProgress[j]||(_[`${j}start`]=Y),this._eventsInProgress[j]=s[j]}!l&&d&&this._fireEvent("movestart",d.originalEvent);for(const j in _)this._fireEvent(j,_[j]);d&&this._fireEvent("move",d.originalEvent);for(const j in s){const{originalEvent:Y}=s[j];this._fireEvent(j,Y)}const w={};let T;for(const j in this._eventsInProgress){const{handlerName:Y,originalEvent:ue}=this._eventsInProgress[j];this._handlersById[Y].isActive()||(delete this._eventsInProgress[j],T=i[Y]||ue,w[`${j}end`]=T)}for(const j in w)this._fireEvent(j,w[j]);const B=pn(this._eventsInProgress);if(r&&(l||d)&&!B){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=ue=>ue!==0&&-this._bearingSnap<ue&&ue<this._bearingSnap;!j||!j.essential&&oe.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:T})),Y(this._map.getBearing())&&this._map.resetNorth()):(Y(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(s,i){this._map.fire(new a.k(s,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new Gn("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Cu extends a.E{constructor(s,i){super(),this._renderFrameCallback=()=>{const r=Math.min((oe.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=i.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.M(this.transform.center.lng,this.transform.center.lat)}setCenter(s,i){return this.jumpTo({center:s},i)}panBy(s,i,r){return s=a.P.convert(s).mult(-1),this.panTo(this.transform.center,a.e({offset:s},i),r)}panTo(s,i,r){return this.easeTo(a.e({center:s},i),r)}getZoom(){return this.transform.zoom}setZoom(s,i){return this.jumpTo({zoom:s},i),this}zoomTo(s,i,r){return this.easeTo(a.e({zoom:s},i),r)}zoomIn(s,i){return this.zoomTo(this.getZoom()+1,s,i),this}zoomOut(s,i){return this.zoomTo(this.getZoom()-1,s,i),this}getBearing(){return this.transform.bearing}setBearing(s,i){return this.jumpTo({bearing:s},i),this}getPadding(){return this.transform.padding}setPadding(s,i){return this.jumpTo({padding:s},i),this}rotateTo(s,i,r){return this.easeTo(a.e({bearing:s},i),r)}resetNorth(s,i){return this.rotateTo(0,a.e({duration:1e3},s),i),this}resetNorthPitch(s,i){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},s),i),this}snapToNorth(s,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,i):this}getPitch(){return this.transform.pitch}setPitch(s,i){return this.jumpTo({pitch:s},i),this}cameraForBounds(s,i){s=gi.convert(s);const r=i&&i.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),r,i)}_cameraForBoxAndBearing(s,i,r,l){const d={top:0,bottom:0,right:0,left:0};if(typeof(l=a.e({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const ji=l.padding;l.padding={top:ji,bottom:ji,right:ji,left:ji}}l.padding=a.e(d,l.padding);const _=this.transform,w=_.padding,T=new gi(s,i),B=_.project(T.getNorthWest()),j=_.project(T.getNorthEast()),Y=_.project(T.getSouthEast()),ue=_.project(T.getSouthWest()),Se=a.b7(-r),Te=B.rotate(Se),Re=j.rotate(Se),Be=Y.rotate(Se),$e=ue.rotate(Se),vt=new a.P(Math.max(Te.x,Re.x,$e.x,Be.x),Math.max(Te.y,Re.y,$e.y,Be.y)),ot=new a.P(Math.min(Te.x,Re.x,$e.x,Be.x),Math.min(Te.y,Re.y,$e.y,Be.y)),ct=vt.sub(ot),Et=(_.width-(w.left+w.right+l.padding.left+l.padding.right))/ct.x,wt=(_.height-(w.top+w.bottom+l.padding.top+l.padding.bottom))/ct.y;if(wt<0||Et<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ri=Math.min(_.scaleZoom(_.scale*Math.min(Et,wt)),l.maxZoom),Xt=a.P.convert(l.offset),Jt=new a.P((l.padding.left-l.padding.right)/2,(l.padding.top-l.padding.bottom)/2).rotate(a.b7(r)),si=Xt.add(Jt).mult(_.scale/_.zoomScale(ri));return{center:_.unproject(B.add(Y).div(2).sub(si)),zoom:ri,bearing:r}}fitBounds(s,i,r){return this._fitInternal(this.cameraForBounds(s,i),i,r)}fitScreenCoordinates(s,i,r,l,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(s)),this.transform.pointLocation(a.P.convert(i)),r,l),l,d)}_fitInternal(s,i,r){return s?(delete(i=a.e(s,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this}jumpTo(s,i){this.stop();const r=this._getTransformForUpdate();let l=!1,d=!1,_=!1;return"zoom"in s&&r.zoom!==+s.zoom&&(l=!0,r.zoom=+s.zoom),s.center!==void 0&&(r.center=a.M.convert(s.center)),"bearing"in s&&r.bearing!==+s.bearing&&(d=!0,r.bearing=+s.bearing),"pitch"in s&&r.pitch!==+s.pitch&&(_=!0,r.pitch=+s.pitch),s.padding==null||r.isPaddingEqual(s.padding)||(r.padding=s.padding),this._applyUpdatedTransform(r),this.fire(new a.k("movestart",i)).fire(new a.k("move",i)),l&&this.fire(new a.k("zoomstart",i)).fire(new a.k("zoom",i)).fire(new a.k("zoomend",i)),d&&this.fire(new a.k("rotatestart",i)).fire(new a.k("rotate",i)).fire(new a.k("rotateend",i)),_&&this.fire(new a.k("pitchstart",i)).fire(new a.k("pitch",i)).fire(new a.k("pitchend",i)),this.fire(new a.k("moveend",i))}calculateCameraOptionsFromTo(s,i,r,l=0){const d=a.Y.fromLngLat(s,i),_=a.Y.fromLngLat(r,l),w=_.x-d.x,T=_.y-d.y,B=_.z-d.z,j=Math.hypot(w,T,B);if(j===0)throw new Error("Can't calculate camera options with same From and To");const Y=Math.hypot(w,T),ue=this.transform.scaleZoom(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Se=180*Math.atan2(w,-T)/Math.PI;let Te=180*Math.acos(Y/j)/Math.PI;return Te=B<0?90-Te:90+Te,{center:_.toLngLat(),zoom:ue,pitch:Te,bearing:Se}}easeTo(s,i){this._stop(!1,s.easeId),((s=a.e({offset:[0,0],duration:500,easing:a.b6},s)).animate===!1||!s.essential&&oe.prefersReducedMotion)&&(s.duration=0);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?+s.zoom:l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,Y="padding"in s?s.padding:r.padding,ue=a.P.convert(s.offset);let Se=r.centerPoint.add(ue);const Te=r.pointLocation(Se),Re=a.M.convert(s.center||Te);this._normalizeCenter(Re);const Be=r.project(Te),$e=r.project(Re).sub(Be),vt=r.zoomScale(T-l);let ot,ct;s.around&&(ot=a.M.convert(s.around),ct=r.locationPoint(ot));const Et={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==l,this._rotating=this._rotating||d!==B,this._pitching=this._pitching||j!==_,this._padding=!r.isPaddingEqual(Y),this._easeId=s.easeId,this._prepareEase(i,s.noMoveStart,Et),this.terrain&&this._prepareElevation(Re),this._ease(wt=>{if(this._zooming&&(r.zoom=a.z.number(l,T,wt)),this._rotating&&(r.bearing=a.z.number(d,B,wt)),this._pitching&&(r.pitch=a.z.number(_,j,wt)),this._padding&&(r.interpolatePadding(w,Y,wt),Se=r.centerPoint.add(ue)),this.terrain&&!s.freezeElevation&&this._updateElevation(wt),ot)r.setLocationAtPoint(ot,ct);else{const ri=r.zoomScale(r.zoom-l),Xt=T>l?Math.min(2,vt):Math.max(.5,vt),Jt=Math.pow(Xt,1-wt),si=r.unproject(Be.add($e.mult(wt*Jt)).mult(ri));r.setLocationAtPoint(r.renderWorldCopies?si.wrap():si,Se)}this._applyUpdatedTransform(r),this._fireMoveEvents(i)},wt=>{this.terrain&&this._finalizeElevation(),this._afterEase(i,wt)},s),this}_prepareEase(s,i,r={}){this._moving=!0,i||r.moving||this.fire(new a.k("movestart",s)),this._zooming&&!r.zooming&&this.fire(new a.k("zoomstart",s)),this._rotating&&!r.rotating&&this.fire(new a.k("rotatestart",s)),this._pitching&&!r.pitching&&this.fire(new a.k("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&i!==this._elevationTarget){const r=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(r-(i-(r*s+this._elevationStart))/(1-s)),this._elevationTarget=i}this.transform.elevation=a.z.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;const i=s.clone(),{center:r,zoom:l,pitch:d,bearing:_,elevation:w}=this.transformCameraUpdate(i);r&&(i.center=r),l!==void 0&&(i.zoom=l),d!==void 0&&(i.pitch=d),_!==void 0&&(i.bearing=_),w!==void 0&&(i.elevation=w),this.transform.apply(i)}_fireMoveEvents(s){this.fire(new a.k("move",s)),this._zooming&&this.fire(new a.k("zoom",s)),this._rotating&&this.fire(new a.k("rotate",s)),this._pitching&&this.fire(new a.k("pitch",s))}_afterEase(s,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const r=this._zooming,l=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new a.k("zoomend",s)),l&&this.fire(new a.k("rotateend",s)),d&&this.fire(new a.k("pitchend",s)),this.fire(new a.k("moveend",s))}flyTo(s,i){if(!s.essential&&oe.prefersReducedMotion){const Ui=a.L(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ui,i)}this.stop(),s=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.b6},s);const r=this._getTransformForUpdate(),l=this.getZoom(),d=this.getBearing(),_=this.getPitch(),w=this.getPadding(),T="zoom"in s?a.ac(+s.zoom,r.minZoom,r.maxZoom):l,B="bearing"in s?this._normalizeBearing(s.bearing,d):d,j="pitch"in s?+s.pitch:_,Y="padding"in s?s.padding:r.padding,ue=r.zoomScale(T-l),Se=a.P.convert(s.offset);let Te=r.centerPoint.add(Se);const Re=r.pointLocation(Te),Be=a.M.convert(s.center||Re);this._normalizeCenter(Be);const $e=r.project(Re),vt=r.project(Be).sub($e);let ot=s.curve;const ct=Math.max(r.width,r.height),Et=ct/ue,wt=vt.mag();if("minZoom"in s){const Ui=a.ac(Math.min(s.minZoom,l,T),r.minZoom,r.maxZoom),an=ct/r.zoomScale(Ui-l);ot=Math.sqrt(an/wt*2)}const ri=ot*ot;function Xt(Ui){const an=(Et*Et-ct*ct+(Ui?-1:1)*ri*ri*wt*wt)/(2*(Ui?Et:ct)*ri*wt);return Math.log(Math.sqrt(an*an+1)-an)}function Jt(Ui){return(Math.exp(Ui)-Math.exp(-Ui))/2}function si(Ui){return(Math.exp(Ui)+Math.exp(-Ui))/2}const ji=Xt(!1);let Zi=function(Ui){return si(ji)/si(ji+ot*Ui)},Ii=function(Ui){return ct*((si(ji)*(Jt(an=ji+ot*Ui)/si(an))-Jt(ji))/ri)/wt;var an},Vi=(Xt(!0)-ji)/ot;if(Math.abs(wt)<1e-6||!isFinite(Vi)){if(Math.abs(ct-Et)<1e-6)return this.easeTo(s,i);const Ui=Et<ct?-1:1;Vi=Math.abs(Math.log(Et/ct))/ot,Ii=function(){return 0},Zi=function(an){return Math.exp(Ui*ot*an)}}return s.duration="duration"in s?+s.duration:1e3*Vi/("screenSpeed"in s?+s.screenSpeed/ot:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=d!==B,this._pitching=j!==_,this._padding=!r.isPaddingEqual(Y),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(Be),this._ease(Ui=>{const an=Ui*Vi,Bn=1/Zi(an);r.zoom=Ui===1?T:l+r.scaleZoom(Bn),this._rotating&&(r.bearing=a.z.number(d,B,Ui)),this._pitching&&(r.pitch=a.z.number(_,j,Ui)),this._padding&&(r.interpolatePadding(w,Y,Ui),Te=r.centerPoint.add(Se)),this.terrain&&!s.freezeElevation&&this._updateElevation(Ui);const Ji=Ui===1?Be:r.unproject($e.add(vt.mult(Ii(an))).mult(Bn));r.setLocationAtPoint(r.renderWorldCopies?Ji.wrap():Ji,Te),this._applyUpdatedTransform(r),this._fireMoveEvents(i)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(i)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,i){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,i)}if(!s){const r=this.handlers;r&&r.stop(!1)}return this}_ease(s,i,r){r.animate===!1||r.duration===0?(s(1),i()):(this._easeStart=oe.now(),this._easeOptions=r,this._onEaseFrame=s,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,i){s=a.b0(s,-180,180);const r=Math.abs(s-i);return Math.abs(s-360-i)<r&&(s-=360),Math.abs(s+360-i)<r&&(s+=360),s}_normalizeCenter(s){const i=this.transform;if(!i.renderWorldCopies||i.lngRange)return;const r=s.lng-i.center.lng;s.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(a.M.convert(s),this.transform.tileZoom)-this.transform.elevation:null}}const oa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class _u{constructor(s=oa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options.compact,this._container=fe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=fe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=fe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){fe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,i){const r=this._map._getUIString(`AttributionControl.${i}`);s.title=r,s.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(l=>typeof l!="string"?"":l)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const l=this._map.style.stylesheet;this.styleOwner=l.owner,this.styleId=l.id}const i=this._map.style.sourceCaches;for(const l in i){const d=i[l];if(d.used||d.usedForTerrain){const _=d.getSource();_.attribution&&s.indexOf(_.attribution)<0&&s.push(_.attribution)}}s=s.filter(l=>String(l).trim()),s.sort((l,d)=>l.length-d.length),s=s.filter((l,d)=>{for(let _=d+1;_<s.length;_++)if(s[_].indexOf(l)>=0)return!1;return!0});const r=s.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,s.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class _s{constructor(s={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const r=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&r.classList.add("maplibregl-compact"):r.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=fe.create("div","maplibregl-ctrl");const i=fe.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){fe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Co{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const i=++this._id;return this._queue.push({callback:s,id:i,cancelled:!1}),i}remove(s){const i=this._currentlyRunning,r=i?this._queue.concat(i):this._queue;for(const l of r)if(l.id===s)return void(l.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const r of i)if(!r.cancelled&&(r.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Mi=a.X([{name:"a_pos3d",type:"Int16",components:3}]);class zi extends a.E{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,i){this.sourceCache.update(s,i),this._renderableTilesKeys=[];const r={};for(const l of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))r[l.key]=!0,this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),a.aN(l.posMatrix,0,a.W,0,a.W,0,1),this._tiles[l.key]=new te(l,this.tileSize));for(const l in this._tiles)r[l]||delete this._tiles[l]}freeRtt(s){for(const i in this._tiles){const r=this._tiles[i];(!s||r.tileID.equals(s)||r.tileID.isChildOf(s)||s.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const i={};for(const r of this._renderableTilesKeys){const l=this._tiles[r].tileID;if(l.canonical.equals(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16),a.aN(d.posMatrix,0,a.W,0,a.W,0,1),i[r]=d}else if(l.canonical.isChildOf(s.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=l.canonical.z-s.canonical.z,w=l.canonical.x-(l.canonical.x>>_<<_),T=l.canonical.y-(l.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,B,0,B,0,1),a.H(d.posMatrix,d.posMatrix,[-w*B,-T*B,0]),i[r]=d}else if(s.canonical.isChildOf(l.canonical)){const d=s.clone();d.posMatrix=new Float64Array(16);const _=s.canonical.z-l.canonical.z,w=s.canonical.x-(s.canonical.x>>_<<_),T=s.canonical.y-(s.canonical.y>>_<<_),B=a.W>>_;a.aN(d.posMatrix,0,a.W,0,a.W,0,1),a.H(d.posMatrix,d.posMatrix,[w*B,T*B,0]),a.J(d.posMatrix,d.posMatrix,[1/2**_,1/2**_,0]),i[r]=d}}return i}getSourceTile(s,i){const r=this.sourceCache._source;let l=s.overscaledZ-this.deltaZoom;if(l>r.maxzoom&&(l=r.maxzoom),l<r.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(l).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!d||!d.dem)&&i)for(;l>=r.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(s.scaledTo(l--).key);return d}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(i=>i.timeAdded>=s)}}class ys{constructor(s,i,r){this.painter=s,this.sourceCache=new zi(i),this.options=r,this.exaggeration=typeof r.exaggeration=="number"?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,i,r,l=a.W){var d;if(!(i>=0&&i<l&&r>=0&&r<l))return 0;const _=this.getTerrainData(s),w=(d=_.tile)===null||d===void 0?void 0:d.dem;if(!w)return 0;const T=function(Te,Re,Be){var $e=Re[0],vt=Re[1];return Te[0]=Be[0]*$e+Be[4]*vt+Be[12],Te[1]=Be[1]*$e+Be[5]*vt+Be[13],Te}([],[i/l*a.W,r/l*a.W],_.u_terrain_matrix),B=[T[0]*w.dim,T[1]*w.dim],j=Math.floor(B[0]),Y=Math.floor(B[1]),ue=B[0]-j,Se=B[1]-Y;return w.get(j,Y)*(1-ue)*(1-Se)+w.get(j+1,Y)*ue*(1-Se)+w.get(j,Y+1)*(1-ue)*Se+w.get(j+1,Y+1)*ue*Se}getElevationForLngLatZoom(s,i){const{tileID:r,mercatorX:l,mercatorY:d}=this._getOverscaledTileIDFromLngLatZoom(s,i);return this.getElevation(r,l%a.W,d%a.W,a.W)}getElevation(s,i,r,l=a.W){return this.getDEMElevation(s,i,r,l)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const l=this.painter.context,d=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new bt(l,d,l.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new bt(l,new a.R({width:1,height:1}),l.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.an([])}const i=this.sourceCache.getSourceTile(s,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const l=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new bt(l,i.dem.getPixels(),l.gl.RGBA,{premultiply:!1}),i.demTexture.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const r=i&&i+i.tileID.key+s.key;if(r&&!this._demMatrixCache[r]){const l=this.sourceCache.sourceCache._source.maxzoom;let d=s.canonical.z-i.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=l?d=s.canonical.z-l:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=s.canonical.x-(s.canonical.x>>d<<d),w=s.canonical.y-(s.canonical.y>>d<<d),T=a.b8(new Float64Array(16),[1/(a.W<<d),1/(a.W<<d),0]);a.H(T,T,[_*a.W,w*a.W,0]),this._demMatrixCache[s.key]={matrix:T,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(s){const i=this.painter,r=i.width/devicePixelRatio,l=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===l||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new bt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new bt(i.context,{width:r,height:l,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(r,l,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,r,l))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,_=0;d<this._coordsTextureSize;d++)for(let w=0;w<this._coordsTextureSize;w++,_+=4)i[_+0]=255&w,i[_+1]=255&d,i[_+2]=w>>8<<4|d>>8,i[_+3]=0;const r=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),l=new bt(s,r,s.gl.RGBA,{premultiply:!1});return l.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=l,l}pointCoordinate(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null);const d=i[0]+(i[2]>>4<<8),_=i[1]+((15&i[2])<<8),w=this.coordsIndex[255-i[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const B=this._coordsTextureSize,j=(1<<T.tileID.canonical.z)*B;return new a.Y((T.tileID.canonical.x*B+d)/j+T.tileID.wrap,(T.tileID.canonical.y*B+_)/j,this.getElevation(T.tileID,d,_,B))}depthAtPoint(s){const i=new Uint8Array(4),r=this.painter.context,l=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),l.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,l.RGBA,l.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.painter.context,i=new a.b9,r=new a.aX,l=this.meshSize,d=a.W/l,_=l*l;for(let Y=0;Y<=l;Y++)for(let ue=0;ue<=l;ue++)i.emplaceBack(ue*d,Y*d,0);for(let Y=0;Y<_;Y+=l+1)for(let ue=0;ue<l;ue++)r.emplaceBack(ue+Y,l+ue+Y+1,l+ue+Y+2),r.emplaceBack(ue+Y,l+ue+Y+2,ue+Y+1);const w=i.length,T=w+2*(l+1);for(const Y of[0,1])for(let ue=0;ue<=l;ue++)for(const Se of[0,1])i.emplaceBack(ue*d,Y*a.W,Se);for(let Y=0;Y<2*l;Y+=2)r.emplaceBack(T+Y,T+Y+1,T+Y+3),r.emplaceBack(T+Y,T+Y+3,T+Y+2),r.emplaceBack(w+Y,w+Y+3,w+Y+1),r.emplaceBack(w+Y,w+Y+2,w+Y+3);const B=i.length,j=B+2*(l+1);for(const Y of[0,1])for(let ue=0;ue<=l;ue++)for(const Se of[0,1])i.emplaceBack(Y*a.W,ue*d,Se);for(let Y=0;Y<2*l;Y+=2)r.emplaceBack(B+Y,B+Y+1,B+Y+3),r.emplaceBack(B+Y,B+Y+3,B+Y+2),r.emplaceBack(j+Y,j+Y+3,j+Y+1),r.emplaceBack(j+Y,j+Y+2,j+Y+3);return this._mesh={indexBuffer:s.createIndexBuffer(r),vertexBuffer:s.createVertexBuffer(i,Mi.members),segments:a.$.simpleSegment(0,0,i.length,r.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*a.ba/Math.pow(2,s)/5}getMinTileElevationForLngLatZoom(s,i){var r;const{tileID:l}=this._getOverscaledTileIDFromLngLatZoom(s,i);return(r=this.getMinMaxElevation(l).minElevation)!==null&&r!==void 0?r:0}getMinMaxElevation(s){const i=this.getTerrainData(s).tile,r={minElevation:null,maxElevation:null};return i&&i.dem&&(r.minElevation=i.dem.min*this.exaggeration,r.maxElevation=i.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(s,i){const r=a.Y.fromLngLat(s.wrap()),l=(1<<i)*a.W,d=r.x*l,_=r.y*l,w=Math.floor(d/a.W),T=Math.floor(_/a.W);return{tileID:new a.Q(i,0,i,w,T),mercatorX:d,mercatorY:_}}}class yu{constructor(s,i,r){this._context=s,this._size=i,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new bt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(r.texture),{id:s,fbo:i,texture:r,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>s.id!==i),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(const s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}const Oo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class cs{constructor(s,i){this.painter=s,this.terrain=i,this.pool=new yu(s.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(r=>!s._layers[r].isHidden(i)),this._coordsDescendingInv={};for(const r in s.sourceCaches){this._coordsDescendingInv[r]={};const l=s.sourceCaches[r].getVisibleCoordinates();for(const d of l){const _=this.terrain.sourceCache.getTerrainCoords(d);for(const w in _)this._coordsDescendingInv[r][w]||(this._coordsDescendingInv[r][w]=[]),this._coordsDescendingInv[r][w].push(_[w])}}this._coordsDescendingInvStr={};for(const r of s._order){const l=s._layers[r],d=l.source;if(Oo[l.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const _ in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][_]=this._coordsDescendingInv[d][_].map(w=>w.key).sort().join()}}for(const r of this._renderableTiles)for(const l in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[l][r.tileID.key];d&&d!==r.rttCoords[l]&&(r.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;const i=s.type,r=this.painter,l=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(Oo[i]&&(this._prevType&&Oo[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(s.id),!l))return!0;if(Oo[this._prevType]||Oo[i]&&l){this._prevType=i;const d=this._stacks.length-1,_=this._stacks[d]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[d]){const B=this.pool.getObjectForId(w.rtt[d].id);if(B.stamp===w.rtt[d].stamp){this.pool.useObject(B);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[d]={id:T.id,stamp:T.stamp},r.context.bindFramebuffer.set(T.fbo.framebuffer),r.context.clear({color:a.aO.transparent,stencil:0}),r.currentStencilSource=void 0;for(let B=0;B<_.length;B++){const j=r.style._layers[_[B]],Y=j.source?this._coordsDescendingInv[j.source][w.tileID.key]:[w.tileID];r.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),r._renderTileClippingMasks(j,Y),r.renderLayer(r,r.style.sourceCaches[j.source],j,Y),j.source&&(w.rttCoords[j.source]=this._coordsDescendingInvStr[j.source][w.tileID.key])}}return ea(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Oo[i]}return!1}}const ul={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ps=U,C={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:oa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},D=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},z={showCompass:!0,showZoom:!0,visualizePitch:!1};class R{constructor(s,i,r=!1){this.mousedown=_=>{this.startMouse(a.e({},_,{ctrlKey:!0,preventDefault:()=>_.preventDefault()}),fe.mousePos(this.element,_)),fe.addEventListener(window,"mousemove",this.mousemove),fe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.moveMouse(_,fe.mousePos(this.element,_))},this.mouseup=_=>{this.mouseRotate.dragEnd(_),this.mousePitch&&this.mousePitch.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=fe.touchPos(this.element,_.targetTouches)[0],this.startTouch(_,this._startPos),fe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),fe.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=fe.touchPos(this.element,_.targetTouches)[0],this.moveTouch(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const l=s.dragRotate._mouseRotate.getClickTolerance(),d=s.dragRotate._mousePitch.getClickTolerance();this.element=i,this.mouseRotate=Fo({clickTolerance:l,enable:!0}),this.touchRotate=(({enable:_,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const B=new Ma;return new mo({clickTolerance:w,move:(j,Y)=>({bearingDelta:(Y.x-j.x)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:l,enable:!0}),this.map=s,r&&(this.mousePitch=Nl({clickTolerance:d,enable:!0}),this.touchPitch=(({enable:_,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const B=new Ma;return new mo({clickTolerance:w,move:(j,Y)=>({pitchDelta:(Y.y-j.y)*T}),moveStateManager:B,enable:_,assignEvents:D})})({clickTolerance:d,enable:!0})),fe.addEventListener(i,"mousedown",this.mousedown),fe.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),fe.addEventListener(i,"touchcancel",this.reset)}startMouse(s,i){this.mouseRotate.dragStart(s,i),this.mousePitch&&this.mousePitch.dragStart(s,i),fe.disableDrag()}startTouch(s,i){this.touchRotate.dragStart(s,i),this.touchPitch&&this.touchPitch.dragStart(s,i),fe.disableDrag()}moveMouse(s,i){const r=this.map,{bearingDelta:l}=this.mouseRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.mousePitch){const{pitchDelta:d}=this.mousePitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}moveTouch(s,i){const r=this.map,{bearingDelta:l}=this.touchRotate.dragMove(s,i)||{};if(l&&r.setBearing(r.getBearing()+l),this.touchPitch){const{pitchDelta:d}=this.touchPitch.dragMove(s,i)||{};d&&r.setPitch(r.getPitch()+d)}}off(){const s=this.element;fe.removeEventListener(s,"mousedown",this.mousedown),fe.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),fe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),fe.removeEventListener(window,"touchend",this.touchend),fe.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){fe.enableDrag(),fe.removeEventListener(window,"mousemove",this.mousemove),fe.removeEventListener(window,"mouseup",this.mouseup),fe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),fe.removeEventListener(window,"touchend",this.touchend)}}let ee;function le(y,s,i){const r=new a.M(y.lng,y.lat);if(y=new a.M(y.lng,y.lat),s){const l=new a.M(y.lng-360,y.lat),d=new a.M(y.lng+360,y.lat),_=i.locationPoint(y).distSqr(s);i.locationPoint(l).distSqr(s)<_?y=l:i.locationPoint(d).distSqr(s)<_&&(y=d)}for(;Math.abs(y.lng-i.center.lng)>180;){const l=i.locationPoint(y);if(l.x>=0&&l.y>=0&&l.x<=i.width&&l.y<=i.height)break;y.lng>i.center.lng?y.lng-=360:y.lng+=360}return y.lng!==r.lng&&i.locationPoint(y).y>i.height/2-i.getHorizon()?y:r}const ae={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function be(y,s,i){const r=y.classList;for(const l in ae)r.remove(`maplibregl-${i}-anchor-${l}`);r.add(`maplibregl-${i}-anchor-${s}`)}class We extends a.E{constructor(s){if(super(),this._onKeyPress=i=>{const r=i.code,l=i.charCode||i.keyCode;r!=="Space"&&r!=="Enter"&&l!==32&&l!==13||this.togglePopup()},this._onMapClick=i=>{const r=i.originalEvent.target,l=this._element;this._popup&&(r===l||l.contains(r))&&this.togglePopup()},this._update=i=>{var r;if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?le(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),i&&i.type!=="moveend"||(this._pos=this._pos.round()),fe.setTransform(this._element,`${ae[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${d}`),oe.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const r=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(s==null?void 0:s.opacity,s==null?void 0:s.opacityWhenCovered),s&&s.element)this._element=s.element,this._offset=a.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=fe.create("div"),this._element.setAttribute("aria-label","Map marker");const i=fe.createNS("http://www.w3.org/2000/svg","svg"),r=41,l=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${r}px`),i.setAttributeNS(null,"width",`${l}px`),i.setAttributeNS(null,"viewBox",`0 0 ${l} ${r}`);const d=fe.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"stroke","none"),d.setAttributeNS(null,"stroke-width","1"),d.setAttributeNS(null,"fill","none"),d.setAttributeNS(null,"fill-rule","evenodd");const _=fe.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const w=fe.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const $e of T){const vt=fe.createNS("http://www.w3.org/2000/svg","ellipse");vt.setAttributeNS(null,"opacity","0.04"),vt.setAttributeNS(null,"cx","10.5"),vt.setAttributeNS(null,"cy","5.80029008"),vt.setAttributeNS(null,"rx",$e.rx),vt.setAttributeNS(null,"ry",$e.ry),w.appendChild(vt)}const B=fe.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const j=fe.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(j);const Y=fe.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const ue=fe.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(ue);const Se=fe.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Se.setAttributeNS(null,"fill","#FFFFFF");const Te=fe.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Re=fe.createNS("http://www.w3.org/2000/svg","circle");Re.setAttributeNS(null,"fill","#000000"),Re.setAttributeNS(null,"opacity","0.25"),Re.setAttributeNS(null,"cx","5.5"),Re.setAttributeNS(null,"cy","5.5"),Re.setAttributeNS(null,"r","5.4999962");const Be=fe.createNS("http://www.w3.org/2000/svg","circle");Be.setAttributeNS(null,"fill","#FFFFFF"),Be.setAttributeNS(null,"cx","5.5"),Be.setAttributeNS(null,"cy","5.5"),Be.setAttributeNS(null,"r","5.4999962"),Te.appendChild(Re),Te.appendChild(Be),_.appendChild(w),_.appendChild(B),_.appendChild(Y),_.appendChild(Se),_.appendChild(Te),i.appendChild(_),i.setAttributeNS(null,"height",r*this._scale+"px"),i.setAttributeNS(null,"width",l*this._scale+"px"),this._element.appendChild(i),this._offset=a.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),be(this._element,this._anchor,"marker"),s&&s.className)for(const i of s.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),fe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.M.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const l=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(38.1-13.5+l)],"bottom-right":[-l,-1*(38.1-13.5+l)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():(s.setLngLat(this._lngLat),s.addTo(this._map)),this):this}_updateOpacity(s=!1){var i;if(!(!((i=this._map)===null||i===void 0)&&i.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(s)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const r=this._map,l=r.terrain.depthAtPoint(this._pos),d=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom);if(r.transform.lngLatToCameraDepth(this._lngLat,d)-l<.006)return void(this._element.style.opacity=this._opacity);const _=-this._offset.y/r.transform._pixelPerMeter,w=Math.sin(r.getPitch()*Math.PI/180)*_,T=r.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),B=r.transform.lngLatToCameraDepth(this._lngLat,d+w);this._element.style.opacity=B-T>.006?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(s){return this._offset=a.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(s,i){return s===void 0&&i===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),s!==void 0&&(this._opacity=s),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const yt={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ct=0,ii=!1;const Gt={maxWidth:100,unit:"metric"};function jt(y,s,i){const r=i&&i.maxWidth||100,l=y._container.clientHeight/2,d=y.unproject([0,l]),_=y.unproject([r,l]),w=d.distanceTo(_);if(i&&i.unit==="imperial"){const T=3.2808*w;T>5280?Z(s,r,T/5280,y._getUIString("ScaleControl.Miles")):Z(s,r,T,y._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?Z(s,r,w/1852,y._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Z(s,r,w/1e3,y._getUIString("ScaleControl.Kilometers")):Z(s,r,w,y._getUIString("ScaleControl.Meters"))}function Z(y,s,i,r){const l=function(d){const _=Math.pow(10,`${Math.floor(d)}`.length-1);let w=d/_;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const B=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*B)/B}(w),_*w}(i);y.style.width=s*(l/i)+"px",y.innerHTML=`${l}&nbsp;${r}`}const A={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},I=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function F(y){if(y){if(typeof y=="number"){const s=Math.round(Math.abs(y)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,y),"top-left":new a.P(s,s),"top-right":new a.P(-s,s),bottom:new a.P(0,-y),"bottom-left":new a.P(s,-s),"bottom-right":new a.P(-s,-s),left:new a.P(y,0),right:new a.P(-y,0)}}if(y instanceof a.P||Array.isArray(y)){const s=a.P.convert(y);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:a.P.convert(y.center||[0,0]),top:a.P.convert(y.top||[0,0]),"top-left":a.P.convert(y["top-left"]||[0,0]),"top-right":a.P.convert(y["top-right"]||[0,0]),bottom:a.P.convert(y.bottom||[0,0]),"bottom-left":a.P.convert(y["bottom-left"]||[0,0]),"bottom-right":a.P.convert(y["bottom-right"]||[0,0]),left:a.P.convert(y.left||[0,0]),right:a.P.convert(y.right||[0,0])}}return F(new a.P(0,0))}const O=U;E.AJAXError=a.bd,E.Evented=a.E,E.LngLat=a.M,E.MercatorCoordinate=a.Y,E.Point=a.P,E.addProtocol=a.be,E.config=a.a,E.removeProtocol=a.bf,E.AttributionControl=_u,E.BoxZoomHandler=Xa,E.CanvasSource=Qn,E.CooperativeGesturesHandler=ds,E.DoubleClickZoomHandler=Ko,E.DragPanHandler=uu,E.DragRotateHandler=Ou,E.EdgeInsets=ll,E.FullscreenControl=class extends a.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var s;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((s=i==null?void 0:i.shadowRoot)===null||s===void 0)&&s.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){fe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=fe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);fe.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=fi,E.GeolocateControl=class extends a.E{constructor(y){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",s)),this._finish()}},this._updateCamera=s=>{const i=new a.M(s.coords.longitude,s.coords.latitude),r=s.coords.accuracy,l=this._map.getBearing(),d=a.e({bearing:l},this.options.fitBoundsOptions),_=gi.fromLngLat(i,r);this._map.fitBounds(_,d,{geolocateSource:!0})},this._updateMarker=s=>{if(s){const i=new a.M(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(this.options.trackUserLocation)if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&ii)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=s=>{if(this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=fe.create("button","maplibregl-ctrl-geolocate",this._container),fe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",s===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=fe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new We({element:this._dotElement}),this._circleElement=fe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new We({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},yt,y)}onAdd(y){return this._map=y,this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s=!1){return a._(this,void 0,void 0,function*(){if(ee!==void 0&&!s)return ee;if(window.navigator.permissions===void 0)return ee=!!window.navigator.geolocation,ee;try{ee=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ee=!!window.navigator.geolocation}return ee})}().then(s=>this._setupUI(s)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),fe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ct=0,ii=!1}_isOutOfMapMaxBounds(y){const s=this._map.getMaxBounds(),i=y.coords;return s&&(i.longitude<s.getWest()||i.longitude>s.getEast()||i.latitude<s.getSouth()||i.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),s=y.getSouthEast(),i=y.getNorthEast(),r=s.distanceTo(i),l=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ct--,ii=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ct++,Ct>1?(y={maximumAge:6e5,timeout:0},ii=!0):(y=this.options.positionOptions,ii=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.Hash=io,E.ImageSource=pr,E.KeyboardHandler=Wu,E.LngLatBounds=gi,E.LogoControl=_s,E.Map=class extends Cu{constructor(y){if(a.bb.mark(a.bc.create),(y=a.e({},C,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ou(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new Co,this._controls=[],this._mapId=a.a3(),this._locale=a.e({},ul,y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this.transformCameraUpdate=y.transformCameraUpdate,this._imageQueueHandle=kt.addThrottleControl(()=>this.isMoving()),this._requestManager=new Rt(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const i=gl(r=>{this._trackResize&&!this._removed&&this.resize(r)._update()},50);this._resizeObserver=new ResizeObserver(r=>{s?i(r):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Jo(this,y),this._hash=y.hash&&new io(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,a.e({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new _u(typeof y.attributionControl=="boolean"?void 0:y.attributionControl)),y.maplibreLogo&&this.addControl(new _s,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new a.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(y,s){if(s===void 0&&(s=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=y.onAdd(this);this._controls.push(y);const r=this._controlPositions[s];return s.indexOf("bottom")!==-1?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(y);return s>-1&&this._controls.splice(s,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,s,i,r){return r==null&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,s,i,r)}resize(y){var s;const i=this._containerDimensions(),r=i[0],l=i[1],d=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,d),this.painter.resize(r,l,d),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,T),this.painter.resize(r,l,T)}this.transform.resize(r,l),(s=this._requestedCameraState)===null||s===void 0||s.resize(r,l);const _=!this._moving;return _&&(this.stop(),this.fire(new a.k("movestart",y)).fire(new a.k("move",y))),this.fire(new a.k("resize",y)),_&&this.fire(new a.k("moveend",y)),this}_getClampedPixelRatio(y,s){const{0:i,1:r}=this._maxCanvasSize,l=this.getPixelRatio(),d=y*l,_=s*l;return Math.min(d>i?i/d:1,_>r?r/_:1)*l}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(gi.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(a.M.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(a.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,s,i){if(y==="mouseenter"||y==="mouseover"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:d=>{const _=this.getLayer(s)?this.queryRenderedFeatures(d.point,{layers:[s]}):[];_.length?r||(r=!0,i.call(this,new Un(y,this,d.originalEvent,{features:_}))):r=!1},mouseout:()=>{r=!1}}}}if(y==="mouseleave"||y==="mouseout"){let r=!1;return{layer:s,listener:i,delegates:{mousemove:_=>{(this.getLayer(s)?this.queryRenderedFeatures(_.point,{layers:[s]}):[]).length?r=!0:r&&(r=!1,i.call(this,new Un(y,this,_.originalEvent)))},mouseout:_=>{r&&(r=!1,i.call(this,new Un(y,this,_.originalEvent)))}}}}{const r=l=>{const d=this.getLayer(s)?this.queryRenderedFeatures(l.point,{layers:[s]}):[];d.length&&(l.features=d,i.call(this,l),delete l.features)};return{layer:s,listener:i,delegates:{[y]:r}}}}on(y,s,i){if(i===void 0)return super.on(y,s);const r=this._createDelegatedListener(y,s,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(r);for(const l in r.delegates)this.on(l,r.delegates[l]);return this}once(y,s,i){if(i===void 0)return super.once(y,s);const r=this._createDelegatedListener(y,s,i);for(const l in r.delegates)this.once(l,r.delegates[l]);return this}off(y,s,i){return i===void 0?super.off(y,s):(this._delegatedListeners&&this._delegatedListeners[y]&&(r=>{const l=this._delegatedListeners[y];for(let d=0;d<l.length;d++){const _=l[d];if(_.layer===s&&_.listener===i){for(const w in _.delegates)this.off(w,_.delegates[w]);return l.splice(d,1),this}}})(),this)}queryRenderedFeatures(y,s){if(!this.style)return[];let i;const r=y instanceof a.P||Array.isArray(y),l=r?y:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(r?{}:y)||{},l instanceof a.P||typeof l[0]=="number")i=[a.P.convert(l)];else{const d=a.P.convert(l[0]),_=a.P.convert(l[1]);i=[d,new a.P(_.x,d.y),_,new a.P(d.x,_.y),d]}return this.style.queryRenderedFeatures(i,s,this.transform)}querySourceFeatures(y,s){return this.style.querySourceFeatures(y,s)}setStyle(y,s){return(s=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(y,s))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const s=this._locale[y];if(s==null)throw new Error(`Missing UI string '${y}'`);return s}_updateStyle(y,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,s));const i=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Lt(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,s,i):this.style.loadJSON(y,s,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Lt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,s){if(typeof y=="string"){const i=this._requestManager.transformRequest(y,Bt.Style);a.h(i,new AbortController).then(r=>{this._updateDiff(r.data,s)}).catch(r=>{r&&this.fire(new a.j(r))})}else typeof y=="object"&&this._updateDiff(y,s)}_updateDiff(y,s){try{this.style.setState(y,s)&&this._update(!0)}catch(i){a.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(y,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(y,s){return this._lazyInitEmptyStyle(),this.style.addSource(y,s),this._update(!0)}isSourceLoaded(y){const s=this.style&&this.style.sourceCaches[y];if(s!==void 0)return s.loaded();this.fire(new a.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const s=this.style.sourceCaches[y.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&s.reload();for(const i in this.style._layers){const r=this.style._layers[i];r.type==="hillshade"&&r.source===y.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ys(this.painter,s,y),this.painter.renderToTexture=new cs(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:y})),this}getTerrain(){var y,s;return(s=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&s!==void 0?s:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const s in y){const i=y[s]._tiles;for(const r in i){const l=i[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,s,i={}){const{pixelRatio:r=1,sdf:l=!1,stretchX:d,stretchY:_,content:w}=i;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||a.b(s))){if(s.width===void 0||s.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:B,data:j}=s,Y=s;return this.style.addImage(y,{data:new a.R({width:T,height:B},new Uint8Array(j)),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,y),this}}{const{width:T,height:B,data:j}=oe.getImageData(s);this.style.addImage(y,{data:new a.R({width:T,height:B},j),pixelRatio:r,stretchX:d,stretchY:_,content:w,sdf:l,version:0})}}updateImage(y,s){const i=this.style.getImage(y);if(!i)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=s instanceof HTMLImageElement||a.b(s)?oe.getImageData(s):s,{width:l,height:d,data:_}=r;if(l===void 0||d===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(l!==i.data.width||d!==i.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(s instanceof HTMLImageElement||a.b(s));return i.data.replace(_,w),this.style.updateImage(y,i),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return kt.getImage(this._requestManager.transformRequest(y,Bt.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,s){return this._lazyInitEmptyStyle(),this.style.addLayer(y,s),this._update(!0)}moveLayer(y,s){return this.style.moveLayer(y,s),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,s,i){return this.style.setLayerZoomRange(y,s,i),this._update(!0)}setFilter(y,s,i={}){return this.style.setFilter(y,s,i),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,s,i,r={}){return this.style.setPaintProperty(y,s,i,r),this._update(!0)}getPaintProperty(y,s){return this.style.getPaintProperty(y,s)}setLayoutProperty(y,s,i,r={}){return this.style.setLayoutProperty(y,s,i,r),this._update(!0)}getLayoutProperty(y,s){return this.style.getLayoutProperty(y,s)}setGlyphs(y,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,s,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,s,i,r=>{r||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,s,i=>{i||this._update(!0)}),this}setLight(y,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,s){return this.style.setFeatureState(y,s),this._update()}removeFeatureState(y,s){return this.style.removeFeatureState(y,s),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,s=0;return this._container&&(y=this._container.clientWidth||400,s=this._container.clientHeight||300),[y,s]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const s=this._canvasContainer=fe.create("div","maplibregl-canvas-container",y);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=fe.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),r=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],r);const l=this._controlContainer=fe.create("div","maplibregl-control-container",y),d=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{d[_]=fe.create("div",`maplibregl-ctrl-${_} `,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,s,i){this._canvas.width=Math.floor(i*y),this._canvas.height=Math.floor(i*s),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let s=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{s={requestedAttributes:y},r&&(s.statusMessage=r.statusMessage,s.type=r.type)},{once:!0});const i=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!i){const r="Failed to initialize WebGL";throw s?(s.message=r,new Error(JSON.stringify(s))):new Error(r)}this.painter=new Sa(i,this.transform),we.testSupport(i)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const l=this.transform.zoom,d=oe.now();this.style.zoomHistory.update(l,d);const _=new a.a8(l,{now:d,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=_.crossFadingFactor();w===1&&w===this._crossFadingFactor||(i=!0,this._crossFadingFactor=w),this.style.update(_)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bb.mark(a.bc.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,a.bb.mark(a.bc.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),kt.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),fe.remove(this._canvasContainer),fe.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),a.bb.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,oe.frameAsync(this._frameRequest).then(y=>{a.bb.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Ps}getCameraTargetElevation(){return this.transform.elevation}},E.MapMouseEvent=Un,E.MapTouchEvent=or,E.MapWheelEvent=Yn,E.Marker=We,E.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const s=this._map.getZoom(),i=s===this._map.getMaxZoom(),r=s===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=s},this._setButtonTitle=(s,i)=>{const r=this._map._getUIString(`NavigationControl.${i}`);s.title=r,s.setAttribute("aria-label",r)},this.options=a.e({},z,y),this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),fe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),fe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=fe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new R(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){fe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,s){const i=fe.create("button",y,this._container);return i.type="button",i.addEventListener("click",s),i}},E.Popup=class extends a.E{constructor(y){super(),this.remove=()=>(this._content&&fe.remove(this._content),this._container&&(fe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{var i;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=fe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=fe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?le(this._lngLat,this._flatPos,this._map.transform):(i=this._lngLat)===null||i===void 0?void 0:i.wrap(),this._trackPointer&&!s)return;const r=this._flatPos=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&s?s:this._map.transform.locationPoint(this._lngLat));let l=this.options.anchor;const d=F(this.options.offset);if(!l){const w=this._container.offsetWidth,T=this._container.offsetHeight;let B;B=r.y+d.bottom.y<T?["top"]:r.y>this._map.transform.height-T?["bottom"]:[],r.x<w/2?B.push("left"):r.x>this._map.transform.width-w/2&&B.push("right"),l=B.length===0?"bottom":B.join("-")}let _=r.add(d[l]);this.options.subpixelPositioning||(_=_.round()),fe.setTransform(this._container,`${ae[l]} translate(${_.x}px,${_.y}px)`),be(this._container,l,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(A),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=a.M.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const s=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=y;r=i.firstChild,r;)s.appendChild(r);return this.setDOMContent(s)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=fe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=fe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(I);y&&y.focus()}},E.RasterDEMTileSource=ns,E.RasterTileSource=Mn,E.ScaleControl=class{constructor(y){this._onMove=()=>{jt(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,jt(this._map,this._container,this.options)},this.options=a.e({},Gt,y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){fe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=_a,E.Style=Lt,E.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=fe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=fe.create("button","maplibregl-ctrl-terrain",this._container),fe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){fe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=ta,E.TwoFingersTouchRotateHandler=Vl,E.TwoFingersTouchZoomHandler=lu,E.TwoFingersTouchZoomRotateHandler=_r,E.VectorTileSource=ti,E.VideoSource=On,E.addSourceType=(y,s)=>a._(void 0,void 0,void 0,function*(){if(v(y))throw new Error(`A source type called "${y}" already exists.`);((i,r)=>{wn[i]=r})(y,s)}),E.clearPrewarmedResources=function(){const y=qi;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Gi),qi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return $().getRTLTextPluginStatus()},E.getVersion=function(){return O},E.getWorkerCount=function(){return rn.workerCount},E.getWorkerUrl=function(){return a.a.WORKER_URL},E.importScriptInWorkers=function(y){return hi().broadcast("importScript",y)},E.prewarm=function(){Ti().acquire(Gi)},E.setMaxParallelImageRequests=function(y){a.a.MAX_PARALLEL_IMAGE_REQUESTS=y},E.setRTLTextPlugin=function(y,s){return $().setRTLTextPlugin(y,s)},E.setWorkerCount=function(y){rn.workerCount=y},E.setWorkerUrl=function(y){a.a.WORKER_URL=y}});var b=n;return b})})(XS);var ew=XS.exports;const R0=DF();function DF(){const{subscribe:e,set:t,update:n}=Py(new Map);return{subscribe:e,set:t,update:n}}function tw(e,t,n){const c=e.slice();return c[16]=t[n],c}function iw(e,t,n){const c=e.slice();return c[16]=t[n],c}function nw(e,t,n){const c=e.slice();return c[16]=t[n],c}function LF(e){let t=e[16].name+"",n;return{c(){n=Po(t)},l(c){n=Do(c,t)},m(c,g){Zn(c,n,g)},p(c,g){g&16&&t!==(t=c[16].name+"")&&ju(n,t)},d(c){c&&Ci(n)}}}function rw(e){let t,n;return t=new Eg({props:{value:e[16],$$slots:{default:[LF]},$$scope:{ctx:e}}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&16&&(b.value=c[16]),g&8388624&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function BF(e){let t,n,c=_c(e[4]),g=[];for(let E=0;E<c.length;E+=1)g[E]=rw(nw(e,c,E));const b=E=>gn(g[E],1,1,()=>{g[E]=null});return{c(){for(let E=0;E<g.length;E+=1)g[E].c();t=gs()},l(E){for(let a=0;a<g.length;a+=1)g[a].l(E);t=gs()},m(E,a){for(let U=0;U<g.length;U+=1)g[U]&&g[U].m(E,a);Zn(E,t,a),n=!0},p(E,a){if(a&16){c=_c(E[4]);let U;for(U=0;U<c.length;U+=1){const W=nw(E,c,U);g[U]?(g[U].p(W,a),Ki(g[U],1)):(g[U]=rw(W),g[U].c(),Ki(g[U],1),g[U].m(t.parentNode,t))}for(fl(),U=c.length;U<g.length;U+=1)b(U);dl()}},i(E){if(!n){for(let a=0;a<c.length;a+=1)Ki(g[a]);n=!0}},o(E){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)gn(g[a]);n=!1},d(E){E&&Ci(t),U0(g,E)}}}function sw(e){var et,lt;let t,n,c,g=((lt=(et=e[0])==null?void 0:et.next)==null?void 0:lt.name)+"",b,E,a,U,W,ce,oe;function fe(Ke){e[9](Ke)}let we={class:"shaped",variant:"filled",$$slots:{default:[RF]},$$scope:{ctx:e}};return e[1]!==void 0&&(we.value=e[1]),U=new hg({props:we}),pa.push(()=>N0(U,"value",fe)),{c(){t=qn("div"),n=qn("h2"),c=Po("Select which "),b=Po(g),E=Po(" to use"),a=Or(),Is(U.$$.fragment),this.h()},l(Ke){t=Hn(Ke,"DIV",{class:!0});var st=Tn(t);n=Hn(st,"H2",{class:!0});var ut=Tn(n);c=Do(ut,"Select which "),b=Do(ut,g),E=Do(ut," to use"),ut.forEach(Ci),a=Nr(st),$s(U.$$.fragment,st),st.forEach(Ci),this.h()},h(){var Ke;Fi(n,"class","svelte-i88pd2"),Fi(t,"class",ce=ep(`step ${!((Ke=e[0])!=null&&Ke.next)&&"grayed"}`)+" svelte-i88pd2")},m(Ke,st){Zn(Ke,t,st),Qi(t,n),Qi(n,c),Qi(n,b),Qi(n,E),Qi(t,a),Es(U,t,null),oe=!0},p(Ke,st){var kt,Bt,Rt;(!oe||st&1)&&g!==(g=((Bt=(kt=Ke[0])==null?void 0:kt.next)==null?void 0:Bt.name)+"")&&ju(b,g);const ut={};st&8388609&&(ut.$$scope={dirty:st,ctx:Ke}),!W&&st&2&&(W=!0,ut.value=Ke[1],O0(()=>W=!1)),U.$set(ut),(!oe||st&1&&ce!==(ce=ep(`step ${!((Rt=Ke[0])!=null&&Rt.next)&&"grayed"}`)+" svelte-i88pd2"))&&Fi(t,"class",ce)},i(Ke){oe||(Ki(U.$$.fragment,Ke),oe=!0)},o(Ke){gn(U.$$.fragment,Ke),oe=!1},d(Ke){Ke&&Ci(t),Cs(U)}}}function zF(e){let t=e[16].name+"",n;return{c(){n=Po(t)},l(c){n=Do(c,t)},m(c,g){Zn(c,n,g)},p(c,g){g&1&&t!==(t=c[16].name+"")&&ju(n,t)},d(c){c&&Ci(n)}}}function aw(e){let t,n;return t=new Eg({props:{value:e[16],$$slots:{default:[zF]},$$scope:{ctx:e}}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&1&&(b.value=c[16]),g&8388609&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function RF(e){var E,a;let t,n,c=_c((a=(E=e[0])==null?void 0:E.next)==null?void 0:a.options),g=[];for(let U=0;U<c.length;U+=1)g[U]=aw(iw(e,c,U));const b=U=>gn(g[U],1,1,()=>{g[U]=null});return{c(){for(let U=0;U<g.length;U+=1)g[U].c();t=gs()},l(U){for(let W=0;W<g.length;W+=1)g[W].l(U);t=gs()},m(U,W){for(let ce=0;ce<g.length;ce+=1)g[ce]&&g[ce].m(U,W);Zn(U,t,W),n=!0},p(U,W){var ce,oe;if(W&1){c=_c((oe=(ce=U[0])==null?void 0:ce.next)==null?void 0:oe.options);let fe;for(fe=0;fe<c.length;fe+=1){const we=iw(U,c,fe);g[fe]?(g[fe].p(we,W),Ki(g[fe],1)):(g[fe]=aw(we),g[fe].c(),Ki(g[fe],1),g[fe].m(t.parentNode,t))}for(fl(),fe=c.length;fe<g.length;fe+=1)b(fe);dl()}},i(U){if(!n){for(let W=0;W<c.length;W+=1)Ki(g[W]);n=!0}},o(U){g=g.filter(Boolean);for(let W=0;W<g.length;W+=1)gn(g[W]);n=!1},d(U){U&&Ci(t),U0(g,U)}}}function FF(e){let t=e[16]+"",n;return{c(){n=Po(t)},l(c){n=Do(c,t)},m(c,g){Zn(c,n,g)},p:lo,d(c){c&&Ci(n)}}}function ow(e){let t,n;return t=new Eg({props:{value:e[16],$$slots:{default:[FF]},$$scope:{ctx:e}}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&8388608&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function OF(e){let t,n,c=_c(e[5]),g=[];for(let E=0;E<c.length;E+=1)g[E]=ow(tw(e,c,E));const b=E=>gn(g[E],1,1,()=>{g[E]=null});return{c(){for(let E=0;E<g.length;E+=1)g[E].c();t=gs()},l(E){for(let a=0;a<g.length;a+=1)g[a].l(E);t=gs()},m(E,a){for(let U=0;U<g.length;U+=1)g[U]&&g[U].m(E,a);Zn(E,t,a),n=!0},p(E,a){if(a&32){c=_c(E[5]);let U;for(U=0;U<c.length;U+=1){const W=tw(E,c,U);g[U]?(g[U].p(W,a),Ki(g[U],1)):(g[U]=ow(W),g[U].c(),Ki(g[U],1),g[U].m(t.parentNode,t))}for(fl(),U=c.length;U<g.length;U+=1)b(U);dl()}},i(E){if(!n){for(let a=0;a<c.length;a+=1)Ki(g[a]);n=!0}},o(E){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)gn(g[a]);n=!1},d(E){E&&Ci(t),U0(g,E)}}}function NF(e){let t;return{c(){t=Po("Build")},l(n){t=Do(n,"Build")},m(n,c){Zn(n,t,c)},d(n){n&&Ci(t)}}}function VF(e){let t,n;return t=new XE({props:{$$slots:{default:[NF]},$$scope:{ctx:e}}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&8388608&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function UF(e){var Ft;let t,n,c,g,b,E,a,U="Select a null model",W,ce,oe,fe,we,et,lt,Ke="Select a different region to compare",st,ut,kt,Bt,Rt,Ge,ni,it,xt="list layers",_t,mt,bt;c=new dT({});function dt(Dt){e[8](Dt)}let nt={class:"shaped",variant:"filled",$$slots:{default:[BF]},$$scope:{ctx:e}};e[0]!==void 0&&(nt.value=e[0]),ce=new hg({props:nt}),pa.push(()=>N0(ce,"value",dt));let pt=((Ft=e[0])==null?void 0:Ft.next)&&sw(e);function at(Dt){e[10](Dt)}let Nt={class:"shaped",variant:"filled",$$slots:{default:[OF]},$$scope:{ctx:e}};return e[2]!==void 0&&(Nt.value=e[2]),ut=new hg({props:Nt}),pa.push(()=>N0(ut,"value",at)),Ge=new PF({props:{class:"theme-button",variant:"raised",$$slots:{default:[VF]},$$scope:{ctx:e}}}),Ge.$on("click",e[11]),{c(){t=qn("div"),n=qn("div"),Is(c.$$.fragment),g=Or(),b=qn("div"),E=qn("div"),a=qn("h2"),a.textContent=U,W=Or(),Is(ce.$$.fragment),fe=Or(),pt&&pt.c(),we=Or(),et=qn("div"),lt=qn("h2"),lt.textContent=Ke,st=Or(),Is(ut.$$.fragment),Rt=Or(),Is(Ge.$$.fragment),ni=Or(),it=qn("button"),it.textContent=xt,this.h()},l(Dt){t=Hn(Dt,"DIV",{class:!0});var ci=Tn(t);n=Hn(ci,"DIV",{class:!0});var bi=Tn(n);$s(c.$$.fragment,bi),bi.forEach(Ci),g=Nr(ci),b=Hn(ci,"DIV",{class:!0});var ki=Tn(b);E=Hn(ki,"DIV",{class:!0});var Gi=Tn(E);a=Hn(Gi,"H2",{class:!0,"data-svelte-h":!0}),ec(a)!=="svelte-1vw7qz9"&&(a.textContent=U),W=Nr(Gi),$s(ce.$$.fragment,Gi),Gi.forEach(Ci),fe=Nr(ki),pt&&pt.l(ki),we=Nr(ki),et=Hn(ki,"DIV",{class:!0});var rn=Tn(et);lt=Hn(rn,"H2",{class:!0,"data-svelte-h":!0}),ec(lt)!=="svelte-1y5wjwe"&&(lt.textContent=Ke),st=Nr(rn),$s(ut.$$.fragment,rn),rn.forEach(Ci),Rt=Nr(ki),$s(Ge.$$.fragment,ki),ni=Nr(ki),it=Hn(ki,"BUTTON",{"data-svelte-h":!0}),ec(it)!=="svelte-1ocvx8h"&&(it.textContent=xt),ki.forEach(Ci),ci.forEach(Ci),this.h()},h(){Fi(n,"class","logo svelte-i88pd2"),Fi(a,"class","svelte-i88pd2"),Fi(E,"class","step svelte-i88pd2"),Fi(lt,"class","svelte-i88pd2"),Fi(et,"class",Bt=ep(`step ${!e[0]&&"grayed"}`)+" svelte-i88pd2"),Fi(b,"class","steps svelte-i88pd2"),Fi(t,"class","builder svelte-i88pd2")},m(Dt,ci){Zn(Dt,t,ci),Qi(t,n),Es(c,n,null),Qi(t,g),Qi(t,b),Qi(b,E),Qi(E,a),Qi(E,W),Es(ce,E,null),Qi(b,fe),pt&&pt.m(b,null),Qi(b,we),Qi(b,et),Qi(et,lt),Qi(et,st),Es(ut,et,null),Qi(b,Rt),Es(Ge,b,null),Qi(b,ni),Qi(b,it),_t=!0,mt||(bt=Gl(it,"click",e[12]),mt=!0)},p(Dt,[ci]){var rn;const bi={};ci&8388624&&(bi.$$scope={dirty:ci,ctx:Dt}),!oe&&ci&1&&(oe=!0,bi.value=Dt[0],O0(()=>oe=!1)),ce.$set(bi),(rn=Dt[0])!=null&&rn.next?pt?(pt.p(Dt,ci),ci&1&&Ki(pt,1)):(pt=sw(Dt),pt.c(),Ki(pt,1),pt.m(b,we)):pt&&(fl(),gn(pt,1,1,()=>{pt=null}),dl());const ki={};ci&8388608&&(ki.$$scope={dirty:ci,ctx:Dt}),!kt&&ci&4&&(kt=!0,ki.value=Dt[2],O0(()=>kt=!1)),ut.$set(ki),(!_t||ci&1&&Bt!==(Bt=ep(`step ${!Dt[0]&&"grayed"}`)+" svelte-i88pd2"))&&Fi(et,"class",Bt);const Gi={};ci&8388608&&(Gi.$$scope={dirty:ci,ctx:Dt}),Ge.$set(Gi)},i(Dt){_t||(Ki(c.$$.fragment,Dt),Ki(ce.$$.fragment,Dt),Ki(pt),Ki(ut.$$.fragment,Dt),Ki(Ge.$$.fragment,Dt),_t=!0)},o(Dt){gn(c.$$.fragment,Dt),gn(ce.$$.fragment,Dt),gn(pt),gn(ut.$$.fragment,Dt),gn(Ge.$$.fragment,Dt),_t=!1},d(Dt){Dt&&Ci(t),Cs(c),Cs(ce),pt&&pt.d(),Cs(ut),Cs(Ge),mt=!1,bt()}}}function GF(e,t,n){let c;hm(e,R0,ut=>n(13,c=ut));let{showEcoregions:g}=t,{build:b}=t,{nullRegion:E}=t;const a=[{name:"All of California",next:null},{name:"By Ecoregion",next:{name:"ecoregion",options:[{name:"Ecoregion 1"},{name:"Ecoregion 2"},{name:"Ecoregion 3"}]}},{name:"Surface",next:"object"}];let{subNullRegion:U}=t,{altRegion:W}=t;const ce=a;function oe(){let ut=c.querySourceFeatures("ecoregions");console.log(ut);let kt=[];for(let Bt of ut)if(kt.filter(Rt=>Rt.ids.includes(Bt.id)).length==0){let Rt=`${Bt.properties.US_L3NAME}`,Ge=kt.filter(ni=>ni.name===Rt)[0];console.log(Ge),!Ge||(Ge==null?void 0:Ge.length)==0?kt.push({ids:[Bt.id],name:`${Bt.properties.US_L3NAME}`}):Ge.ids=[...Ge.ids,Bt.id]}kt=kt.sort((Bt,Rt)=>Bt.name.localeCompare(Rt.name)),console.log(kt),n(4,a[1].next.options=kt,a)}function fe(ut){if(!ut)return;console.log(ut);let kt=c.querySourceFeatures("ecoregions");for(let Bt of kt)c.setFeatureState({source:"ecoregions",id:Bt.id},{hover:!1});for(let Bt of ut.ids)c.setFeatureState({source:"ecoregions",id:Bt},{hover:!0})}function we(ut){E=ut,n(0,E)}function et(ut){U=ut,n(1,U)}function lt(ut){W=ut,n(2,W)}const Ke=()=>b(),st=()=>oe();return e.$$set=ut=>{"showEcoregions"in ut&&n(7,g=ut.showEcoregions),"build"in ut&&n(3,b=ut.build),"nullRegion"in ut&&n(0,E=ut.nullRegion),"subNullRegion"in ut&&n(1,U=ut.subNullRegion),"altRegion"in ut&&n(2,W=ut.altRegion)},e.$$.update=()=>{var ut;e.$$.dirty&129&&(E&&((ut=E.next)==null?void 0:ut.name)==="ecoregion"?g(!0):g(!1)),e.$$.dirty&2&&fe(U)},[E,U,W,b,a,ce,oe,g,we,et,lt,Ke,st]}class qF extends Lo{constructor(t){super(),Bo(this,t,GF,UF,co,{showEcoregions:7,build:3,nullRegion:0,subNullRegion:1,altRegion:2})}}function HF(e){return e.split(" ").map(t=>/^(lighten|darken|accent)-/.test(t)?`text-${t}`:`${t}-text`)}function lw(e,t){if(/^(#|rgb|hsl|currentColor)/.test(t))return e.style.color=t,!1;if(t.startsWith("--"))return e.style.color=`var(${t})`,!1;const n=HF(t);return e.classList.add(...n),n}const jF=(e,t)=>{let n;return typeof t=="string"&&(n=lw(e,t)),{update(c){n?e.classList.remove(...n):e.style.color=null,typeof c=="string"&&(n=lw(e,c))}}};let uw=36,ZF="";for(;uw--;)ZF+=uw.toString(36);function cw(e){let t,n=[{class:"underlay"},e[9],{"stroke-dashoffset":"0"}],c={};for(let g=0;g<n.length;g+=1)c=gr(c,n[g]);return{c(){t=Ba("circle"),this.h()},l(g){t=za(g,"circle",{class:!0,"stroke-dashoffset":!0}),Tn(t).forEach(Ci),this.h()},h(){A_(t,c),Kp(t,"svelte-kiaiot",!0)},m(g,b){Zn(g,t,b)},p(g,b){Kp(t,"svelte-kiaiot",!0)},d(g){g&&Ci(t)}}}function QF(e){let t,n,c,g,b,E,a,U,W,ce,oe,fe=!e[1]&&cw(e),we=[{class:"overlay"},e[9],{"stroke-dashoffset":e[8]}],et={};for(let st=0;st<we.length;st+=1)et=gr(et,we[st]);const lt=e[12].default,Ke=nu(lt,e,e[11],null);return{c(){t=qn("div"),n=Ba("svg"),fe&&fe.c(),c=Ba("circle"),g=Or(),b=qn("div"),Ke&&Ke.c(),this.h()},l(st){t=Hn(st,"DIV",{role:!0,"aria-valuemin":!0,"aria-valuemax":!0,"aria-valuenow":!0,class:!0,style:!0});var ut=Tn(t);n=za(ut,"svg",{xmlns:!0,viewBox:!0,style:!0,class:!0});var kt=Tn(n);fe&&fe.l(kt),c=za(kt,"circle",{class:!0,"stroke-dashoffset":!0}),Tn(c).forEach(Ci),kt.forEach(Ci),g=Nr(ut),b=Hn(ut,"DIV",{class:!0});var Bt=Tn(b);Ke&&Ke.l(Bt),Bt.forEach(Ci),ut.forEach(Ci),this.h()},h(){A_(c,et),Kp(c,"svelte-kiaiot",!0),Fi(n,"xmlns","http://www.w3.org/2000/svg"),Fi(n,"viewBox",e[7]+`
    `+e[7]+`
    `+2*e[7]+`
    `+2*e[7]),O2(n,"transform","rotate("+e[3]+"deg)"),Fi(n,"class","svelte-kiaiot"),Fi(b,"class","s-progress-circular__content svelte-kiaiot"),Fi(t,"role","progressbar"),Fi(t,"aria-valuemin","0"),Fi(t,"aria-valuemax","100"),Fi(t,"aria-valuenow",e[5]),Fi(t,"class",E="s-progress-circular "+e[0]+" svelte-kiaiot"),Fi(t,"style",a="width:"+e[4]+"px;height:"+e[4]+"px;"+e[6]),Kp(t,"indeterminate",e[1])},m(st,ut){Zn(st,t,ut),Qi(t,n),fe&&fe.m(n,null),Qi(n,c),Qi(t,g),Qi(t,b),Ke&&Ke.m(b,null),W=!0,ce||(oe=xo(U=jF.call(null,t,e[2])),ce=!0)},p(st,[ut]){st[1]?fe&&(fe.d(1),fe=null):fe?fe.p(st,ut):(fe=cw(st),fe.c(),fe.m(n,c)),Kp(c,"svelte-kiaiot",!0),(!W||ut&8)&&O2(n,"transform","rotate("+st[3]+"deg)"),Ke&&Ke.p&&(!W||ut&2048)&&ru(Ke,lt,st,st[11],W?au(lt,st[11],ut,null):su(st[11]),null),(!W||ut&32)&&Fi(t,"aria-valuenow",st[5]),(!W||ut&1&&E!==(E="s-progress-circular "+st[0]+" svelte-kiaiot"))&&Fi(t,"class",E),(!W||ut&80&&a!==(a="width:"+st[4]+"px;height:"+st[4]+"px;"+st[6]))&&Fi(t,"style",a),U&&Iu(U.update)&&ut&4&&U.update.call(null,st[2]),(!W||ut&3)&&Kp(t,"indeterminate",st[1])},i(st){W||(Ki(Ke,st),W=!0)},o(st){gn(Ke,st),W=!1},d(st){st&&Ci(t),fe&&fe.d(),Ke&&Ke.d(st),ce=!1,oe()}}}const oy=20;function WF(e,t,n){let{$$slots:c={},$$scope:g}=t,{class:b=""}=t,{indeterminate:E=!1}=t,{color:a="secondary"}=t,{rotate:U=0}=t,{size:W=32}=t,{value:ce=0}=t,{width:oe=4}=t,{style:fe=""}=t;const we=2*3.1416*oy,et=oy/(1-Number(oe)/+W),lt=Number(oe)/+W*et*2,Ke=(100-ce)/100*we,st={fill:"transparent",cx:2*et,cy:2*et,r:oy,"stroke-width":lt,"stroke-dasharray":we};return e.$$set=ut=>{"class"in ut&&n(0,b=ut.class),"indeterminate"in ut&&n(1,E=ut.indeterminate),"color"in ut&&n(2,a=ut.color),"rotate"in ut&&n(3,U=ut.rotate),"size"in ut&&n(4,W=ut.size),"value"in ut&&n(5,ce=ut.value),"width"in ut&&n(10,oe=ut.width),"style"in ut&&n(6,fe=ut.style),"$$scope"in ut&&n(11,g=ut.$$scope)},[b,E,a,U,W,ce,fe,et,Ke,st,oe,g,c]}class XF extends Lo{constructor(t){super(),Bo(this,t,WF,QF,co,{class:0,indeterminate:1,color:2,rotate:3,size:4,value:5,width:10,style:6})}}function YF(e){let t,n,c,g,b="Building model...",E;return n=new XF({props:{size:50,indeterminate:!0,color:Am()[500]}}),{c(){t=qn("div"),Is(n.$$.fragment),c=Or(),g=qn("h3"),g.textContent=b,this.h()},l(a){t=Hn(a,"DIV",{class:!0});var U=Tn(t);$s(n.$$.fragment,U),c=Nr(U),g=Hn(U,"H3",{class:!0,"data-svelte-h":!0}),ec(g)!=="svelte-1rkckqb"&&(g.textContent=b),U.forEach(Ci),this.h()},h(){Fi(g,"class","svelte-10jlhi"),Fi(t,"class","loading-container svelte-10jlhi")},m(a,U){Zn(a,t,U),Es(n,t,null),Qi(t,c),Qi(t,g),E=!0},p:lo,i(a){E||(Ki(n.$$.fragment,a),E=!0)},o(a){gn(n.$$.fragment,a),E=!1},d(a){a&&Ci(t),Cs(n)}}}class $F extends Lo{constructor(t){super(),Bo(this,t,null,YF,co,{})}}function KF(e){let t,n,c,g='<td class="svelte-9vgn69">Hex</td> <td class="svelte-9vgn69">Tree Size</td> <td class="svelte-9vgn69">PD</td> <td class="svelte-9vgn69">MPD</td> <td class="svelte-9vgn69">MNTD</td>',b,E,a,U=e[0].hex+"",W,ce,oe,fe=e[0].properties.tree_sizes+"",we,et,lt,Ke=e[0].properties.pd+"",st,ut,kt,Bt=e[0].properties.mpd+"",Rt,Ge,ni,it=e[0].properties.mntd+"",xt;return{c(){t=qn("div"),n=qn("table"),c=qn("thead"),c.innerHTML=g,b=Or(),E=qn("tr"),a=qn("td"),W=Po(U),ce=Or(),oe=qn("td"),we=Po(fe),et=Or(),lt=qn("td"),st=Po(Ke),ut=Or(),kt=qn("td"),Rt=Po(Bt),Ge=Or(),ni=qn("td"),xt=Po(it),this.h()},l(_t){t=Hn(_t,"DIV",{class:!0});var mt=Tn(t);n=Hn(mt,"TABLE",{});var bt=Tn(n);c=Hn(bt,"THEAD",{class:!0,"data-svelte-h":!0}),ec(c)!=="svelte-i8fsz9"&&(c.innerHTML=g),b=Nr(bt),E=Hn(bt,"TR",{});var dt=Tn(E);a=Hn(dt,"TD",{class:!0});var nt=Tn(a);W=Do(nt,U),nt.forEach(Ci),ce=Nr(dt),oe=Hn(dt,"TD",{class:!0});var pt=Tn(oe);we=Do(pt,fe),pt.forEach(Ci),et=Nr(dt),lt=Hn(dt,"TD",{class:!0});var at=Tn(lt);st=Do(at,Ke),at.forEach(Ci),ut=Nr(dt),kt=Hn(dt,"TD",{class:!0});var Nt=Tn(kt);Rt=Do(Nt,Bt),Nt.forEach(Ci),Ge=Nr(dt),ni=Hn(dt,"TD",{class:!0});var Ft=Tn(ni);xt=Do(Ft,it),Ft.forEach(Ci),dt.forEach(Ci),bt.forEach(Ci),mt.forEach(Ci),this.h()},h(){Fi(c,"class","svelte-9vgn69"),Fi(a,"class","svelte-9vgn69"),Fi(oe,"class","svelte-9vgn69"),Fi(lt,"class","svelte-9vgn69"),Fi(kt,"class","svelte-9vgn69"),Fi(ni,"class","svelte-9vgn69"),Fi(t,"class","summary-container svelte-9vgn69")},m(_t,mt){Zn(_t,t,mt),Qi(t,n),Qi(n,c),Qi(n,b),Qi(n,E),Qi(E,a),Qi(a,W),Qi(E,ce),Qi(E,oe),Qi(oe,we),Qi(E,et),Qi(E,lt),Qi(lt,st),Qi(E,ut),Qi(E,kt),Qi(kt,Rt),Qi(E,Ge),Qi(E,ni),Qi(ni,xt)},p(_t,[mt]){mt&1&&U!==(U=_t[0].hex+"")&&ju(W,U),mt&1&&fe!==(fe=_t[0].properties.tree_sizes+"")&&ju(we,fe),mt&1&&Ke!==(Ke=_t[0].properties.pd+"")&&ju(st,Ke),mt&1&&Bt!==(Bt=_t[0].properties.mpd+"")&&ju(Rt,Bt),mt&1&&it!==(it=_t[0].properties.mntd+"")&&ju(xt,it)},i:lo,o:lo,d(_t){_t&&Ci(t)}}}function JF(e,t,n){let{data:c}=t;return e.$$set=g=>{"data"in g&&n(0,c=g.data)},[c]}class eO extends Lo{constructor(t){super(),Bo(this,t,JF,KF,co,{data:0})}}function hw(e,t,n){const c=e.slice();return c[17]=t[n],c}function tO(e,t,n){const c=e.slice();return c[17]=t[n],c}function Aw(e){let t,n,c,g,b,E,a,U,W,ce,oe,fe="x",we,et,lt,Ke,st,ut,kt;function Bt(mt){e[13](mt)}let Rt={class:"shaped",variant:"outlined",$$slots:{default:[rO]},$$scope:{ctx:e}};e[0]!==void 0&&(Rt.value=e[0]),g=new hg({props:Rt}),pa.push(()=>N0(g,"value",Bt)),g.$on("change",e[14]);function Ge(mt){e[15](mt)}let ni={class:"shaped",variant:"outlined",$$slots:{default:[aO]},$$scope:{ctx:e}};e[1]!==void 0&&(ni.value=e[1]),a=new hg({props:ni}),pa.push(()=>N0(a,"value",Ge));let it=!e[10]&&dw(),xt=!e[11]&&pw(),_t=e[11]&&mw(e);return{c(){t=qn("div"),n=qn("div"),c=Po(`Testing\r
                `),Is(g.$$.fragment),E=Po(`\r
                of\r
                `),Is(a.$$.fragment),W=Or(),ce=qn("div"),oe=qn("button"),oe.textContent=fe,we=Or(),it&&it.c(),et=Or(),xt&&xt.c(),lt=Or(),_t&&_t.c(),Ke=gs(),this.h()},l(mt){t=Hn(mt,"DIV",{class:!0});var bt=Tn(t);n=Hn(bt,"DIV",{class:!0});var dt=Tn(n);c=Do(dt,`Testing\r
                `),$s(g.$$.fragment,dt),E=Do(dt,`\r
                of\r
                `),$s(a.$$.fragment,dt),dt.forEach(Ci),W=Nr(bt),ce=Hn(bt,"DIV",{class:!0});var nt=Tn(ce);oe=Hn(nt,"BUTTON",{class:!0,"data-svelte-h":!0}),ec(oe)!=="svelte-18oet5b"&&(oe.textContent=fe),nt.forEach(Ci),bt.forEach(Ci),we=Nr(mt),it&&it.l(mt),et=Nr(mt),xt&&xt.l(mt),lt=Nr(mt),_t&&_t.l(mt),Ke=gs(),this.h()},h(){Fi(n,"class","test svelte-1rv3cun"),Fi(oe,"class","svelte-1rv3cun"),Fi(ce,"class","close svelte-1rv3cun"),Fi(t,"class","header svelte-1rv3cun")},m(mt,bt){Zn(mt,t,bt),Qi(t,n),Qi(n,c),Es(g,n,null),Qi(n,E),Es(a,n,null),Qi(t,W),Qi(t,ce),Qi(ce,oe),Zn(mt,we,bt),it&&it.m(mt,bt),Zn(mt,et,bt),xt&&xt.m(mt,bt),Zn(mt,lt,bt),_t&&_t.m(mt,bt),Zn(mt,Ke,bt),st=!0,ut||(kt=Gl(oe,"click",e[16]),ut=!0)},p(mt,bt){const dt={};bt&4194304&&(dt.$$scope={dirty:bt,ctx:mt}),!b&&bt&1&&(b=!0,dt.value=mt[0],O0(()=>b=!1)),g.$set(dt);const nt={};bt&4194368&&(nt.$$scope={dirty:bt,ctx:mt}),!U&&bt&2&&(U=!0,nt.value=mt[1],O0(()=>U=!1)),a.$set(nt),mt[10]?it&&(fl(),gn(it,1,1,()=>{it=null}),dl()):it?bt&1024&&Ki(it,1):(it=dw(),it.c(),Ki(it,1),it.m(et.parentNode,et)),mt[11]?xt&&(xt.d(1),xt=null):xt||(xt=pw(),xt.c(),xt.m(lt.parentNode,lt)),mt[11]?_t?(_t.p(mt,bt),bt&2048&&Ki(_t,1)):(_t=mw(mt),_t.c(),Ki(_t,1),_t.m(Ke.parentNode,Ke)):_t&&(fl(),gn(_t,1,1,()=>{_t=null}),dl())},i(mt){st||(Ki(g.$$.fragment,mt),Ki(a.$$.fragment,mt),Ki(it),Ki(_t),st=!0)},o(mt){gn(g.$$.fragment,mt),gn(a.$$.fragment,mt),gn(it),gn(_t),st=!1},d(mt){mt&&(Ci(t),Ci(we),Ci(et),Ci(lt),Ci(Ke)),Cs(g),Cs(a),it&&it.d(mt),xt&&xt.d(mt),_t&&_t.d(mt),ut=!1,kt()}}}function iO(e){let t;return{c(){t=Po(e[17])},l(n){t=Do(n,e[17])},m(n,c){Zn(n,t,c)},p:lo,d(n){n&&Ci(t)}}}function nO(e){let t,n;return t=new Eg({props:{value:e[17],$$slots:{default:[iO]},$$scope:{ctx:e}}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&4194304&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function rO(e){let t,n,c=_c(p_),g=[];for(let b=0;b<c.length;b+=1)g[b]=nO(tO(e,c,b));return{c(){for(let b=0;b<g.length;b+=1)g[b].c();t=gs()},l(b){for(let E=0;E<g.length;E+=1)g[E].l(b);t=gs()},m(b,E){for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(b,E);Zn(b,t,E),n=!0},p:lo,i(b){if(!n){for(let E=0;E<c.length;E+=1)Ki(g[E]);n=!0}},o(b){g=g.filter(Boolean);for(let E=0;E<g.length;E+=1)gn(g[E]);n=!1},d(b){b&&Ci(t),U0(g,b)}}}function sO(e){let t=e[17]+"",n;return{c(){n=Po(t)},l(c){n=Do(c,t)},m(c,g){Zn(c,n,g)},p(c,g){g&64&&t!==(t=c[17]+"")&&ju(n,t)},d(c){c&&Ci(n)}}}function fw(e){let t,n;return t=new Eg({props:{value:e[17],$$slots:{default:[sO]},$$scope:{ctx:e}}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&64&&(b.value=c[17]),g&4194368&&(b.$$scope={dirty:g,ctx:c}),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function aO(e){let t,n,c=_c(e[6]),g=[];for(let E=0;E<c.length;E+=1)g[E]=fw(hw(e,c,E));const b=E=>gn(g[E],1,1,()=>{g[E]=null});return{c(){for(let E=0;E<g.length;E+=1)g[E].c();t=gs()},l(E){for(let a=0;a<g.length;a+=1)g[a].l(E);t=gs()},m(E,a){for(let U=0;U<g.length;U+=1)g[U]&&g[U].m(E,a);Zn(E,t,a),n=!0},p(E,a){if(a&64){c=_c(E[6]);let U;for(U=0;U<c.length;U+=1){const W=hw(E,c,U);g[U]?(g[U].p(W,a),Ki(g[U],1)):(g[U]=fw(W),g[U].c(),Ki(g[U],1),g[U].m(t.parentNode,t))}for(fl(),U=c.length;U<g.length;U+=1)b(U);dl()}},i(E){if(!n){for(let a=0;a<c.length;a+=1)Ki(g[a]);n=!0}},o(E){g=g.filter(Boolean);for(let a=0;a<g.length;a+=1)gn(g[a]);n=!1},d(E){E&&Ci(t),U0(g,E)}}}function dw(e){let t,n,c;return n=new $F({}),{c(){t=qn("div"),Is(n.$$.fragment),this.h()},l(g){t=Hn(g,"DIV",{class:!0});var b=Tn(t);$s(n.$$.fragment,b),b.forEach(Ci),this.h()},h(){Fi(t,"class","load svelte-1rv3cun")},m(g,b){Zn(g,t,b),Es(n,t,null),c=!0},i(g){c||(Ki(n.$$.fragment,g),c=!0)},o(g){gn(n.$$.fragment,g),c=!1},d(g){g&&Ci(t),Cs(n)}}}function pw(e){let t,n="<p>Click on a hexagon to see phylogenetic statistics.</p>";return{c(){t=qn("div"),t.innerHTML=n},l(c){t=Hn(c,"DIV",{"data-svelte-h":!0}),ec(t)!=="svelte-7krgt3"&&(t.innerHTML=n)},m(c,g){Zn(c,t,g)},d(c){c&&Ci(t)}}}function mw(e){let t,n,c,g,b,E;return t=new eO({props:{data:e[2]}}),c=new CM({props:{colorScheme:e[4],metric:e[0],point:[[e[2].properties.tree_sizes,e[2].properties[e[0]]]]}}),b=new CF({props:{clade:e[1],newick:e[2].properties.tree,hex_id:e[2].properties.id}}),{c(){Is(t.$$.fragment),n=Or(),Is(c.$$.fragment),g=Or(),Is(b.$$.fragment)},l(a){$s(t.$$.fragment,a),n=Nr(a),$s(c.$$.fragment,a),g=Nr(a),$s(b.$$.fragment,a)},m(a,U){Es(t,a,U),Zn(a,n,U),Es(c,a,U),Zn(a,g,U),Es(b,a,U),E=!0},p(a,U){const W={};U&4&&(W.data=a[2]),t.$set(W);const ce={};U&16&&(ce.colorScheme=a[4]),U&1&&(ce.metric=a[0]),U&5&&(ce.point=[[a[2].properties.tree_sizes,a[2].properties[a[0]]]]),c.$set(ce);const oe={};U&2&&(oe.clade=a[1]),U&4&&(oe.newick=a[2].properties.tree),U&4&&(oe.hex_id=a[2].properties.id),b.$set(oe)},i(a){E||(Ki(t.$$.fragment,a),Ki(c.$$.fragment,a),Ki(b.$$.fragment,a),E=!0)},o(a){gn(t.$$.fragment,a),gn(c.$$.fragment,a),gn(b.$$.fragment,a),E=!1},d(a){a&&(Ci(n),Ci(g)),Cs(t,a),Cs(c,a),Cs(b,a)}}}function gw(e){let t,n;return t=new qF({props:{showEcoregions:e[8],build:e[9]}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&256&&(b.showEcoregions=c[8]),g&512&&(b.build=c[9]),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function oO(e){let t,n,c,g=e[7]&&Aw(e),b=!e[7]&&gw(e);return{c(){t=qn("div"),g&&g.c(),n=Or(),b&&b.c(),this.h()},l(E){t=Hn(E,"DIV",{class:!0});var a=Tn(t);g&&g.l(a),n=Nr(a),b&&b.l(a),a.forEach(Ci),this.h()},h(){Fi(t,"class",ep("modal")+" svelte-1rv3cun")},m(E,a){Zn(E,t,a),g&&g.m(t,null),Qi(t,n),b&&b.m(t,null),c=!0},p(E,[a]){E[7]?g?(g.p(E,a),a&128&&Ki(g,1)):(g=Aw(E),g.c(),Ki(g,1),g.m(t,n)):g&&(fl(),gn(g,1,1,()=>{g=null}),dl()),E[7]?b&&(fl(),gn(b,1,1,()=>{b=null}),dl()):b?(b.p(E,a),a&128&&Ki(b,1)):(b=gw(E),b.c(),Ki(b,1),b.m(t,null))},i(E){c||(Ki(g),Ki(b),c=!0)},o(E){gn(g),gn(b),c=!1},d(E){E&&Ci(t),g&&g.d(),b&&b.d()}}}function lO(e,t,n){let{selectionData:c}=t,{metric:g}=t,{updateData:b}=t,{colorScheme:E}=t,{updateMetricLayer:a}=t,{clade:U}=t,{updateClade:W}=t,{clades:ce}=t,{isBuilt:oe}=t,{showEcoregions:fe}=t,{build:we}=t,{isFinishedBuilding:et}=t,lt;function Ke(Bt){g=Bt,n(0,g)}const st=()=>a(g);function ut(Bt){U=Bt,n(1,U)}const kt=()=>b(null);return e.$$set=Bt=>{"selectionData"in Bt&&n(2,c=Bt.selectionData),"metric"in Bt&&n(0,g=Bt.metric),"updateData"in Bt&&n(3,b=Bt.updateData),"colorScheme"in Bt&&n(4,E=Bt.colorScheme),"updateMetricLayer"in Bt&&n(5,a=Bt.updateMetricLayer),"clade"in Bt&&n(1,U=Bt.clade),"updateClade"in Bt&&n(12,W=Bt.updateClade),"clades"in Bt&&n(6,ce=Bt.clades),"isBuilt"in Bt&&n(7,oe=Bt.isBuilt),"showEcoregions"in Bt&&n(8,fe=Bt.showEcoregions),"build"in Bt&&n(9,we=Bt.build),"isFinishedBuilding"in Bt&&n(10,et=Bt.isFinishedBuilding)},e.$$.update=()=>{e.$$.dirty&5&&c&&n(11,lt=c.properties&&c.properties[g]!==-1),e.$$.dirty&4098&&W(U),e.$$.dirty&33&&a(g)},[g,U,c,b,E,a,ce,oe,fe,we,et,lt,W,Ke,st,ut,kt]}class uO extends Lo{constructor(t){super(),Bo(this,t,lO,oO,co,{selectionData:2,metric:0,updateData:3,colorScheme:4,updateMetricLayer:5,clade:1,updateClade:12,clades:6,isBuilt:7,showEcoregions:8,build:9,isFinishedBuilding:10})}}var cO={exports:{}};(function(e,t){(function(n,c){e.exports=c()})(Kf,function(){var n,c,g;function b(a,U){if(!n)n=U;else if(!c)c=U;else{var W="var sharedChunk = {}; ("+n+")(sharedChunk); ("+c+")(sharedChunk);",ce={};n(ce),g=U(ce),typeof window<"u"&&(g.workerUrl=window.URL.createObjectURL(new Blob([W],{type:"text/javascript"})))}}b(["exports"],function(a){function U(f,u,p,S){return new(p||(p=Promise))(function(L,G){function Q(_e){try{he(S.next(_e))}catch(Le){G(Le)}}function re(_e){try{he(S.throw(_e))}catch(Le){G(Le)}}function he(_e){var Le;_e.done?L(_e.value):(Le=_e.value,Le instanceof p?Le:new p(function(qe){qe(Le)})).then(Q,re)}he((S=S.apply(f,u||[])).next())})}function W(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}typeof SuppressedError=="function"&&SuppressedError;var ce=oe;function oe(f,u){this.x=f,this.y=u}oe.prototype={clone:function(){return new oe(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,p=f.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),p=Math.sin(f),S=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=S,this},_rotateAround:function(f,u){var p=Math.cos(f),S=Math.sin(f),L=u.y+S*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-S*(this.y-u.y),this.y=L,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},oe.convert=function(f){return f instanceof oe?f:Array.isArray(f)?new oe(f[0],f[1]):f};var fe=W(ce),we=et;function et(f,u,p,S){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(S-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=p,this.p2y=S}et.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,S=0;S<8;S++){var L=this.sampleCurveX(p)-f;if(Math.abs(L)<u)return p;var G=this.sampleCurveDerivativeX(p);if(Math.abs(G)<1e-6)break;p-=L/G}var Q=0,re=1;for(p=f,S=0;S<20&&(L=this.sampleCurveX(p),!(Math.abs(L-f)<u));S++)f>L?Q=p:re=p,p=.5*(re-Q)+Q;return p},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};var lt=W(we);let Ke,st;function ut(){return Ke==null&&(Ke=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ke}function kt(){if(st==null&&(st=!1,ut())){const u=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(u){for(let S=0;S<5*5;S++){const L=4*S;u.fillStyle=`rgb(${L},${L+1},${L+2})`,u.fillRect(S%5,Math.floor(S/5),1,1)}const p=u.getImageData(0,0,5,5).data;for(let S=0;S<5*5*4;S++)if(S%4!=3&&p[S]!==S){st=!0;break}}}return st||!1}function Bt(f,u,p,S){const L=new lt(f,u,p,S);return function(G){return L.solve(G)}}const Rt=Bt(.25,.1,.25,1);function Ge(f,u,p){return Math.min(p,Math.max(u,f))}function ni(f,u,p){const S=p-u,L=((f-u)%S+S)%S+u;return L===u?p:L}function it(f,...u){for(const p of u)for(const S in p)f[S]=p[S];return f}let xt=1;function _t(f,u,p){const S={};for(const L in f)S[L]=u.call(p||this,f[L],L,f);return S}function mt(f,u,p){const S={};for(const L in f)u.call(p||this,f[L],L,f)&&(S[L]=f[L]);return S}function bt(f){return Array.isArray(f)?f.map(bt):typeof f=="object"&&f?_t(f,bt):f}const dt={};function nt(f){dt[f]||(typeof console<"u"&&console.warn(f),dt[f]=!0)}function pt(f,u,p){return(p.y-f.y)*(u.x-f.x)>(u.y-f.y)*(p.x-f.x)}function at(f){let u=0;for(let p,S,L=0,G=f.length,Q=G-1;L<G;Q=L++)p=f[L],S=f[Q],u+=(S.x-p.x)*(p.y+S.y);return u}function Nt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Ft=null;function Dt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const ci="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function bi(f,u,p,S,L){return U(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const G=new VideoFrame(f,{timestamp:0});try{const Q=G==null?void 0:G.format;if(!Q||!Q.startsWith("BGR")&&!Q.startsWith("RGB"))throw new Error(`Unrecognized format ${Q}`);const re=Q.startsWith("BGR"),he=new Uint8ClampedArray(S*L*4);if(yield G.copyTo(he,function(_e,Le,qe,Je,At){const gt=4*Math.max(-Le,0),Mt=(Math.max(0,qe)-qe)*Je*4+gt,Pt=4*Je,zt=Math.max(0,Le),$t=Math.max(0,qe);return{rect:{x:zt,y:$t,width:Math.min(_e.width,Le+Je)-zt,height:Math.min(_e.height,qe+At)-$t},layout:[{offset:Mt,stride:Pt}]}}(f,u,p,S,L)),re)for(let _e=0;_e<he.length;_e+=4){const Le=he[_e];he[_e]=he[_e+2],he[_e+2]=Le}return he}finally{G.close()}})}let ki,Gi,rn,$i;const qi={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){return this.getImageCanvasContext(f).getImageData(-u,-u,f.width+2*u,f.height+2*u)},getImageCanvasContext(f){const u=window.document.createElement("canvas"),p=u.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return u.width=f.width,u.height=f.height,p.drawImage(f,0,0,f.width,f.height),p},resolveURL:f=>(rn||(rn=document.createElement("a")),rn.href=f,rn.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&($i==null&&($i=matchMedia("(prefers-reduced-motion: reduce)")),$i.matches)}},sn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Ti extends Error{constructor(u,p,S,L){super(`AJAXError: ${p} (${u}): ${S}`),this.status=u,this.statusText=p,this.url=S,this.body=L}}const yi=Nt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,hi=f=>sn.REGISTERED_PROTOCOLS[f.substring(0,f.indexOf("://"))];function Ei(f,u){const p=new AbortController,S=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:yi(),signal:p.signal});let L=!1,G=!1;return f.type==="json"&&S.headers.set("Accept","application/json"),G||fetch(S).then(Q=>Q.ok?(re=>{(f.type==="arrayBuffer"||f.type==="image"?re.arrayBuffer():f.type==="json"?re.json():re.text()).then(he=>{G||(L=!0,u(null,he,re.headers.get("Cache-Control"),re.headers.get("Expires")))}).catch(he=>{G||u(new Error(he.message))})})(Q):Q.blob().then(re=>u(new Ti(Q.status,Q.statusText,f.url,re)))).catch(Q=>{Q.code!==20&&u(new Error(Q.message))}),{cancel:()=>{G=!0,L||p.abort()}}}const Li=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Nt())return(hi(f.url)||Ei)(f,u)}if(!(/^file:/.test(p=f.url)||/^file:/.test(yi())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Ei(f,u);if(Nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var p;return function(S,L){const G=new XMLHttpRequest;G.open(S.method||"GET",S.url,!0),S.type!=="arrayBuffer"&&S.type!=="image"||(G.responseType="arraybuffer");for(const Q in S.headers)G.setRequestHeader(Q,S.headers[Q]);return S.type==="json"&&(G.responseType="text",G.setRequestHeader("Accept","application/json")),G.withCredentials=S.credentials==="include",G.onerror=()=>{L(new Error(G.statusText))},G.onload=()=>{if((G.status>=200&&G.status<300||G.status===0)&&G.response!==null){let Q=G.response;if(S.type==="json")try{Q=JSON.parse(G.response)}catch(re){return L(re)}L(null,Q,G.getResponseHeader("Cache-Control"),G.getResponseHeader("Expires"))}else{const Q=new Blob([G.response],{type:G.getResponseHeader("Content-Type")});L(new Ti(G.status,G.statusText,S.url,Q))}},G.send(S.body),{cancel:()=>G.abort()}}(f,u)},fn=function(f,u){return Li(it(f,{type:"arrayBuffer"}),u)};function _n(f){if(!f||f.indexOf("://")<=0||f.indexOf("data:image/")===0||f.indexOf("blob:")===0)return!0;const u=new URL(f),p=window.location;return u.protocol===p.protocol&&u.host===p.host}function gi(f,u,p){p[f]&&p[f].indexOf(u)!==-1||(p[f]=p[f]||[],p[f].push(u))}function mn(f,u,p){if(p&&p[f]){const S=p[f].indexOf(u);S!==-1&&p[f].splice(S,1)}}class ti{constructor(u,p={}){it(this,p),this.type=u}}class Mn extends ti{constructor(u,p={}){super("error",it({error:u},p))}}class ns{on(u,p){return this._listeners=this._listeners||{},gi(u,p,this._listeners),this}off(u,p){return mn(u,p,this._listeners),mn(u,p,this._oneTimeListeners),this}once(u,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},gi(u,p,this._oneTimeListeners),this):new Promise(S=>this.once(u,S))}fire(u,p){typeof u=="string"&&(u=new ti(u,p||{}));const S=u.type;if(this.listens(S)){u.target=this;const L=this._listeners&&this._listeners[S]?this._listeners[S].slice():[];for(const re of L)re.call(this,u);const G=this._oneTimeListeners&&this._oneTimeListeners[S]?this._oneTimeListeners[S].slice():[];for(const re of G)mn(S,re,this._oneTimeListeners),re.call(this,u);const Q=this._eventedParent;Q&&(it(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Q.fire(u))}else u instanceof Mn&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var fi={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ln=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function pr(f,u){const p={};for(const S in f)S!=="ref"&&(p[S]=f[S]);return ln.forEach(S=>{S in u&&(p[S]=u[S])}),p}function On(f,u){if(Array.isArray(f)){if(!Array.isArray(u)||f.length!==u.length)return!1;for(let p=0;p<f.length;p++)if(!On(f[p],u[p]))return!1;return!0}if(typeof f=="object"&&f!==null&&u!==null){if(typeof u!="object"||Object.keys(f).length!==Object.keys(u).length)return!1;for(const p in f)if(!On(f[p],u[p]))return!1;return!0}return f===u}const Qn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function wn(f,u,p){p.push({command:Qn.addSource,args:[f,u[f]]})}function v(f,u,p){u.push({command:Qn.removeSource,args:[f]}),p[f]=!0}function k(f,u,p,S){v(f,p,S),wn(f,u,p)}function V(f,u,p){let S;for(S in f[p])if(Object.prototype.hasOwnProperty.call(f[p],S)&&S!=="data"&&!On(f[p][S],u[p][S]))return!1;for(S in u[p])if(Object.prototype.hasOwnProperty.call(u[p],S)&&S!=="data"&&!On(f[p][S],u[p][S]))return!1;return!0}function $(f,u,p,S,L,G){let Q;for(Q in u=u||{},f=f||{})Object.prototype.hasOwnProperty.call(f,Q)&&(On(f[Q],u[Q])||p.push({command:G,args:[S,Q,u[Q],L]}));for(Q in u)Object.prototype.hasOwnProperty.call(u,Q)&&!Object.prototype.hasOwnProperty.call(f,Q)&&(On(f[Q],u[Q])||p.push({command:G,args:[S,Q,u[Q],L]}))}function te(f){return f.id}function Ae(f,u){return f[u.id]=u,f}class ve{constructor(u,p,S,L){this.message=(u?`${u}: `:"")+S,L&&(this.identifier=L),p!=null&&p.__line__&&(this.line=p.__line__)}}function Ie(f,...u){for(const p of u)for(const S in p)f[S]=p[S];return f}class Ee extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class ze{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[S,L]of p)this.bindings[S]=L}concat(u){return new ze(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const Qe={kind:"null"},He={kind:"number"},Ze={kind:"string"},Ve={kind:"boolean"},ft={kind:"color"},rt={kind:"object"},Me={kind:"value"},se={kind:"collator"},ne={kind:"formatted"},X={kind:"padding"},ie={kind:"resolvedImage"},de={kind:"variableAnchorOffsetCollection"};function ye(f,u){return{kind:"array",itemType:f,N:u}}function ge(f){if(f.kind==="array"){const u=ge(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Pe=[Qe,He,Ze,Ve,ft,ne,rt,ye(Me),X,ie,de];function Fe(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Fe(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const p of Pe)if(!Fe(p,u))return null}}return`Expected ${ge(f)} but found ${ge(u)} instead.`}function Ne(f,u){return u.some(p=>p.kind===f.kind)}function Xe(f,u){return u.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}function Ye(f,u){return f.kind==="array"&&u.kind==="array"?f.itemType.kind===u.itemType.kind&&typeof f.N=="number":f.kind===u.kind}const De=.96422,Ue=.82521,ht=4/29,Tt=6/29,o=3*Tt*Tt,ke=Tt*Tt*Tt,ai=Math.PI/180,di=180/Math.PI;function Ai(f){return(f%=360)<0&&(f+=360),f}function Kt([f,u,p,S]){let L,G;const Q=Ri((.2225045*(f=oi(f))+.7168786*(u=oi(u))+.0606169*(p=oi(p)))/1);f===u&&u===p?L=G=Q:(L=Ri((.4360747*f+.3850649*u+.1430804*p)/De),G=Ri((.0139322*f+.0971045*u+.7141733*p)/Ue));const re=116*Q-16;return[re<0?0:re,500*(L-Q),200*(Q-G),S]}function oi(f){return f<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Ri(f){return f>ke?Math.pow(f,1/3):f/o+ht}function vi([f,u,p,S]){let L=(f+16)/116,G=isNaN(u)?L:L+u/500,Q=isNaN(p)?L:L-p/200;return L=1*Yt(L),G=De*Yt(G),Q=Ue*Yt(Q),[wi(3.1338561*G-1.6168667*L-.4906146*Q),wi(-.9787684*G+1.9161415*L+.033454*Q),wi(.0719453*G-.2289914*L+1.4052427*Q),S]}function wi(f){return(f=f<=.00304?12.92*f:1.055*Math.pow(f,1/2.4)-.055)<0?0:f>1?1:f}function Yt(f){return f>Tt?f*f*f:o*(f-ht)}function vn(f){return parseInt(f.padEnd(2,f),16)/255}function ar(f,u){return dn(u?f/100:f,0,1)}function dn(f,u,p){return Math.min(Math.max(u,f),p)}function Vn(f){return!f.some(Number.isNaN)}const Hr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Hi{constructor(u,p,S,L=1,G=!0){this.r=u,this.g=p,this.b=S,this.a=L,G||(this.r*=L,this.g*=L,this.b*=L,L||this.overwriteGetter("rgb",[u,p,S,L]))}static parse(u){if(u instanceof Hi)return u;if(typeof u!="string")return;const p=function(S){if((S=S.toLowerCase().trim())==="transparent")return[0,0,0,0];const L=Hr[S];if(L){const[Q,re,he]=L;return[Q/255,re/255,he/255,1]}if(S.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(S)){const Q=S.length<6?1:2;let re=1;return[vn(S.slice(re,re+=Q)),vn(S.slice(re,re+=Q)),vn(S.slice(re,re+=Q)),vn(S.slice(re,re+Q)||"ff")]}if(S.startsWith("rgb")){const Q=S.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(Q){const[re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t]=Q,Ht=[Le||" ",At||" ",Pt].join("");if(Ht==="  "||Ht==="  /"||Ht===",,"||Ht===",,,"){const Zt=[_e,Je,Mt].join(""),ui=Zt==="%%%"?100:Zt===""?255:0;if(ui){const _i=[dn(+he/ui,0,1),dn(+qe/ui,0,1),dn(+gt/ui,0,1),zt?ar(+zt,$t):1];if(Vn(_i))return _i}}return}}const G=S.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(G){const[Q,re,he,_e,Le,qe,Je,At,gt]=G,Mt=[he||" ",Le||" ",Je].join("");if(Mt==="  "||Mt==="  /"||Mt===",,"||Mt===",,,"){const Pt=[+re,dn(+_e,0,100),dn(+qe,0,100),At?ar(+At,gt):1];if(Vn(Pt))return function([zt,$t,Ht,Zt]){function ui(_i){const Xi=(_i+zt/30)%12,xn=$t*Math.min(Ht,1-Ht);return Ht-xn*Math.max(-1,Math.min(Xi-3,9-Xi,1))}return zt=Ai(zt),$t/=100,Ht/=100,[ui(0),ui(8),ui(4),Zt]}(Pt)}}}(u);return p?new Hi(...p,!1):void 0}get rgb(){const{r:u,g:p,b:S,a:L}=this,G=L||1/0;return this.overwriteGetter("rgb",[u/G,p/G,S/G,L])}get hcl(){return this.overwriteGetter("hcl",function(u){const[p,S,L,G]=Kt(u),Q=Math.sqrt(S*S+L*L);return[Math.round(1e4*Q)?Ai(Math.atan2(L,S)*di):NaN,Q,p,G]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Kt(this.rgb))}overwriteGetter(u,p){return Object.defineProperty(this,u,{value:p}),p}toString(){const[u,p,S,L]=this.rgb;return`rgba(${[u,p,S].map(G=>Math.round(255*G)).join(",")},${L})`}}Hi.black=new Hi(0,0,0,1),Hi.white=new Hi(1,1,1,1),Hi.transparent=new Hi(0,0,0,0),Hi.red=new Hi(1,0,0,1);class lr{constructor(u,p,S){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=S,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fn{constructor(u,p,S,L,G){this.text=u,this.image=p,this.scale=S,this.fontStack=L,this.textColor=G}}class Qt{constructor(u){this.sections=u}static fromString(u){return new Qt([new Fn(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Qt?u:Qt.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Yi{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Yi)return u;if(typeof u=="number")return new Yi([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const p of u)if(typeof p!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Yi(u)}}toString(){return JSON.stringify(this.values)}}const Ut=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class En{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof En)return u;if(Array.isArray(u)&&!(u.length<1)&&u.length%2==0){for(let p=0;p<u.length;p+=2){const S=u[p],L=u[p+1];if(typeof S!="string"||!Ut.has(S)||!Array.isArray(L)||L.length!==2||typeof L[0]!="number"||typeof L[1]!="number")return}return new En(u)}}toString(){return JSON.stringify(this.values)}}class ur{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new ur({name:u,available:!1}):null}}function Ns(f,u,p,S){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?S===void 0||typeof S=="number"&&S>=0&&S<=1?null:`Invalid rgba value [${[f,u,p,S].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof S=="number"?[f,u,p,S]:[f,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Vr(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof Hi||f instanceof lr||f instanceof Qt||f instanceof Yi||f instanceof En||f instanceof ur)return!0;if(Array.isArray(f)){for(const u of f)if(!Vr(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!Vr(f[u]))return!1;return!0}return!1}function Vt(f){if(f===null)return Qe;if(typeof f=="string")return Ze;if(typeof f=="boolean")return Ve;if(typeof f=="number")return He;if(f instanceof Hi)return ft;if(f instanceof lr)return se;if(f instanceof Qt)return ne;if(f instanceof Yi)return X;if(f instanceof En)return de;if(f instanceof ur)return ie;if(Array.isArray(f)){const u=f.length;let p;for(const S of f){const L=Vt(S);if(p){if(p===L)continue;p=Me;break}p=L}return ye(p||Me,u)}return rt}function cr(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof Hi||f instanceof Qt||f instanceof Yi||f instanceof En||f instanceof ur?f.toString():JSON.stringify(f)}class Lt{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!Vr(u[1]))return p.error("invalid value");const S=u[1];let L=Vt(S);const G=p.expectedType;return L.kind!=="array"||L.N!==0||!G||G.kind!=="array"||typeof G.N=="number"&&G.N!==0||(L=G),new Lt(L,S)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Br{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const Vs={string:Ze,number:He,boolean:Ve,object:rt};class ua{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let S,L=1;const G=u[0];if(G==="array"){let re,he;if(u.length>2){const _e=u[1];if(typeof _e!="string"||!(_e in Vs)||_e==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);re=Vs[_e],L++}else re=Me;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);he=u[2],L++}S=ye(re,he)}else{if(!Vs[G])throw new Error(`Types doesn't contain name = ${G}`);S=Vs[G]}const Q=[];for(;L<u.length;L++){const re=p.parse(u[L],L,Me);if(!re)return null;Q.push(re)}return new ua(S,Q)}evaluate(u){for(let p=0;p<this.args.length;p++){const S=this.args[p].evaluate(u);if(!Fe(this.type,Vt(S)))return S;if(p===this.args.length-1)throw new Br(`Expected value to be of type ${ge(this.type)}, but found ${ge(Vt(S))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const kr={"to-boolean":Ve,"to-color":ft,"to-number":He,"to-string":Ze};class Fa{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const S=u[0];if(!kr[S])throw new Error(`Can't parse ${S} as it is not part of the known types`);if((S==="to-boolean"||S==="to-string")&&u.length!==2)return p.error("Expected one argument.");const L=kr[S],G=[];for(let Q=1;Q<u.length;Q++){const re=p.parse(u[Q],Q,Me);if(!re)return null;G.push(re)}return new Fa(L,G)}evaluate(u){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(u);case"color":{let p,S;for(const L of this.args){if(p=L.evaluate(u),S=null,p instanceof Hi)return p;if(typeof p=="string"){const G=u.parseColor(p);if(G)return G}else if(Array.isArray(p)&&(S=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:Ns(p[0],p[1],p[2],p[3]),!S))return new Hi(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Br(S||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const S of this.args){p=S.evaluate(u);const L=Yi.parse(p);if(L)return L}throw new Br(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const S of this.args){p=S.evaluate(u);const L=En.parse(p);if(L)return L}throw new Br(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const S of this.args){if(p=S.evaluate(u),p===null)return 0;const L=Number(p);if(!isNaN(L))return L}throw new Br(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return Qt.fromString(cr(this.args[0].evaluate(u)));case"resolvedImage":return ur.fromString(cr(this.args[0].evaluate(u)));default:return cr(this.args[0].evaluate(u))}}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const zo=["Unknown","Point","LineString","Polygon"];class Oa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?zo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=Hi.parse(u)),p}}class Xs{constructor(u,p,S=[],L,G=new ze,Q=[]){this.registry=u,this.path=S,this.key=S.map(re=>`[${re}]`).join(""),this.scope=G,this.errors=Q,this.expectedType=L,this._isConstant=p}parse(u,p,S,L,G={}){return p?this.concat(p,S,L)._parse(u,G):this._parse(u,G)}_parse(u,p){function S(L,G,Q){return Q==="assert"?new ua(G,[L]):Q==="coerce"?new Fa(G,[L]):L}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const L=u[0];if(typeof L!="string")return this.error(`Expression name must be a string, but found ${typeof L} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const G=this.registry[L];if(G){let Q=G.parse(u,this);if(!Q)return null;if(this.expectedType){const re=this.expectedType,he=Q.type;if(re.kind!=="string"&&re.kind!=="number"&&re.kind!=="boolean"&&re.kind!=="object"&&re.kind!=="array"||he.kind!=="value")if(re.kind!=="color"&&re.kind!=="formatted"&&re.kind!=="resolvedImage"||he.kind!=="value"&&he.kind!=="string")if(re.kind!=="padding"||he.kind!=="value"&&he.kind!=="number"&&he.kind!=="array")if(re.kind!=="variableAnchorOffsetCollection"||he.kind!=="value"&&he.kind!=="array"){if(this.checkSubtype(re,he))return null}else Q=S(Q,re,p.typeAnnotation||"coerce");else Q=S(Q,re,p.typeAnnotation||"coerce");else Q=S(Q,re,p.typeAnnotation||"coerce");else Q=S(Q,re,p.typeAnnotation||"assert")}if(!(Q instanceof Lt)&&Q.type.kind!=="resolvedImage"&&this._isConstant(Q)){const re=new Oa;try{Q=new Lt(Q.type,Q.evaluate(re))}catch(he){return this.error(he.message),null}}return Q}return this.error(`Unknown expression "${L}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,S){const L=typeof u=="number"?this.path.concat(u):this.path,G=S?this.scope.concat(S):this.scope;return new Xs(this.registry,this._isConstant,L,p||null,G,this.errors)}error(u,...p){const S=`${this.key}${p.map(L=>`[${L}]`).join("")}`;this.errors.push(new Ee(S,u))}checkSubtype(u,p){const S=Fe(u,p);return S&&this.error(S),S}}class jn{constructor(u,p,S){this.type=se,this.locale=S,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const S=u[1];if(typeof S!="object"||Array.isArray(S))return p.error("Collator options argument must be an object.");const L=p.parse(S["case-sensitive"]!==void 0&&S["case-sensitive"],1,Ve);if(!L)return null;const G=p.parse(S["diacritic-sensitive"]!==void 0&&S["diacritic-sensitive"],1,Ve);if(!G)return null;let Q=null;return S.locale&&(Q=p.parse(S.locale,1,Ze),!Q)?null:new jn(L,G,Q)}evaluate(u){return new lr(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const aa=8192;function ls(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function Na(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function rl(f,u){const p=(180+f[0])/360,S=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,L=Math.pow(2,u.z);return[Math.round(p*L*aa),Math.round(S*L*aa)]}function sl(f,u,p){const S=f[0]-u[0],L=f[1]-u[1],G=f[0]-p[0],Q=f[1]-p[1];return S*Q-G*L==0&&S*G<=0&&L*Q<=0}function Ja(f,u){let p=!1;for(let Q=0,re=u.length;Q<re;Q++){const he=u[Q];for(let _e=0,Le=he.length;_e<Le-1;_e++){if(sl(f,he[_e],he[_e+1]))return!1;(L=he[_e])[1]>(S=f)[1]!=(G=he[_e+1])[1]>S[1]&&S[0]<(G[0]-L[0])*(S[1]-L[1])/(G[1]-L[1])+L[0]&&(p=!p)}}var S,L,G;return p}function Va(f,u){for(let p=0;p<u.length;p++)if(Ja(f,u[p]))return!0;return!1}function N(f,u,p,S){const L=S[0]-p[0],G=S[1]-p[1],Q=(f[0]-p[0])*G-L*(f[1]-p[1]),re=(u[0]-p[0])*G-L*(u[1]-p[1]);return Q>0&&re<0||Q<0&&re>0}function xe(f,u,p){for(const _e of p)for(let Le=0;Le<_e.length-1;++Le)if((re=[(Q=_e[Le+1])[0]-(G=_e[Le])[0],Q[1]-G[1]])[0]*(he=[(L=u)[0]-(S=f)[0],L[1]-S[1]])[1]-re[1]*he[0]!=0&&N(S,L,G,Q)&&N(G,Q,S,L))return!0;var S,L,G,Q,re,he;return!1}function tt(f,u){for(let p=0;p<f.length;++p)if(!Ja(f[p],u))return!1;for(let p=0;p<f.length-1;++p)if(xe(f[p],f[p+1],u))return!1;return!0}function It(f,u){for(let p=0;p<u.length;p++)if(tt(f,u[p]))return!0;return!1}function Wt(f,u,p){const S=[];for(let L=0;L<f.length;L++){const G=[];for(let Q=0;Q<f[L].length;Q++){const re=rl(f[L][Q],p);ls(u,re),G.push(re)}S.push(G)}return S}function Si(f,u,p){const S=[];for(let L=0;L<f.length;L++){const G=Wt(f[L],u,p);S.push(G)}return S}function Bi(f,u,p,S){if(f[0]<p[0]||f[0]>p[2]){const L=.5*S;let G=f[0]-p[0]>L?-S:p[0]-f[0]>L?S:0;G===0&&(G=f[0]-p[2]>L?-S:p[2]-f[0]>L?S:0),f[0]+=G}ls(u,f)}function un(f,u,p,S){const L=Math.pow(2,S.z)*aa,G=[S.x*aa,S.y*aa],Q=[];for(const re of f)for(const he of re){const _e=[he.x+G[0],he.y+G[1]];Bi(_e,u,p,L),Q.push(_e)}return Q}function An(f,u,p,S){const L=Math.pow(2,S.z)*aa,G=[S.x*aa,S.y*aa],Q=[];for(const he of f){const _e=[];for(const Le of he){const qe=[Le.x+G[0],Le.y+G[1]];ls(u,qe),_e.push(qe)}Q.push(_e)}if(u[2]-u[0]<=L/2){(re=u)[0]=re[1]=1/0,re[2]=re[3]=-1/0;for(const he of Q)for(const _e of he)Bi(_e,u,p,L)}var re;return Q}class rr{constructor(u,p){this.type=Ve,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(Vr(u[1])){const S=u[1];if(S.type==="FeatureCollection")for(let L=0;L<S.features.length;++L){const G=S.features[L].geometry.type;if(G==="Polygon"||G==="MultiPolygon")return new rr(S,S.features[L].geometry)}else if(S.type==="Feature"){const L=S.geometry.type;if(L==="Polygon"||L==="MultiPolygon")return new rr(S,S.geometry)}else if(S.type==="Polygon"||S.type==="MultiPolygon")return new rr(S,S)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,S){const L=[1/0,1/0,-1/0,-1/0],G=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(S.type==="Polygon"){const re=Wt(S.coordinates,G,Q),he=un(p.geometry(),L,G,Q);if(!Na(L,G))return!1;for(const _e of he)if(!Ja(_e,re))return!1}if(S.type==="MultiPolygon"){const re=Si(S.coordinates,G,Q),he=un(p.geometry(),L,G,Q);if(!Na(L,G))return!1;for(const _e of he)if(!Va(_e,re))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,S){const L=[1/0,1/0,-1/0,-1/0],G=[1/0,1/0,-1/0,-1/0],Q=p.canonicalID();if(S.type==="Polygon"){const re=Wt(S.coordinates,G,Q),he=An(p.geometry(),L,G,Q);if(!Na(L,G))return!1;for(const _e of he)if(!tt(_e,re))return!1}if(S.type==="MultiPolygon"){const re=Si(S.coordinates,G,Q),he=An(p.geometry(),L,G,Q);if(!Na(L,G))return!1;for(const _e of he)if(!It(_e,re))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class hr{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const S=u[1];return p.scope.has(S)?new hr(S,p.scope.get(S)):p.error(`Unknown variable "${S}". Make sure "${S}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class zr{constructor(u,p,S,L){this.name=u,this.type=p,this._evaluate=S,this.args=L}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,p){const S=u[0],L=zr.definitions[S];if(!L)return p.error(`Unknown expression "${S}". If you wanted a literal array, use ["literal", [...]].`,0);const G=Array.isArray(L)?L[0]:L.type,Q=Array.isArray(L)?[[L[1],L[2]]]:L.overloads,re=Q.filter(([_e])=>!Array.isArray(_e)||_e.length===u.length-1);let he=null;for(const[_e,Le]of re){he=new Xs(p.registry,Ua,p.path,null,p.scope);const qe=[];let Je=!1;for(let At=1;At<u.length;At++){const gt=u[At],Mt=Array.isArray(_e)?_e[At-1]:_e.type,Pt=he.parse(gt,1+qe.length,Mt);if(!Pt){Je=!0;break}qe.push(Pt)}if(!Je)if(Array.isArray(_e)&&_e.length!==qe.length)he.error(`Expected ${_e.length} arguments, but found ${qe.length} instead.`);else{for(let At=0;At<qe.length;At++){const gt=Array.isArray(_e)?_e[At]:_e.type,Mt=qe[At];he.concat(At+1).checkSubtype(gt,Mt.type)}if(he.errors.length===0)return new zr(S,G,Le,qe)}}if(re.length===1)p.errors.push(...he.errors);else{const _e=(re.length?re:Q).map(([qe])=>{return Je=qe,Array.isArray(Je)?`(${Je.map(ge).join(", ")})`:`(${ge(Je.type)}...)`;var Je}).join(" | "),Le=[];for(let qe=1;qe<u.length;qe++){const Je=p.parse(u[qe],1+Le.length);if(!Je)return null;Le.push(ge(Je.type))}p.error(`Expected arguments of type ${_e}, but found (${Le.join(", ")}) instead.`)}return null}static register(u,p){zr.definitions=p;for(const S in p)u[S]=zr}}function Ua(f){if(f instanceof hr)return Ua(f.boundExpression);if(f instanceof zr&&f.name==="error"||f instanceof jn||f instanceof rr)return!1;const u=f instanceof Fa||f instanceof ua;let p=!0;return f.eachChild(S=>{p=u?p&&Ua(S):p&&S instanceof Lt}),!!p&&Ga(f)&&pl(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ga(f){if(f instanceof zr&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof rr)return!1;let u=!0;return f.eachChild(p=>{u&&!Ga(p)&&(u=!1)}),u}function qa(f){if(f instanceof zr&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(p=>{u&&!qa(p)&&(u=!1)}),u}function pl(f,u){if(f instanceof zr&&u.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(S=>{p&&!pl(S,u)&&(p=!1)}),p}function Ur(f,u){const p=f.length-1;let S,L,G=0,Q=p,re=0;for(;G<=Q;)if(re=Math.floor((G+Q)/2),S=f[re],L=f[re+1],S<=u){if(re===p||u<L)return re;G=re+1}else{if(!(S>u))throw new Br("Input is not a number.");Q=re-1}return 0}class ir{constructor(u,p,S){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[L,G]of S)this.labels.push(L),this.outputs.push(G)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const S=p.parse(u[1],1,He);if(!S)return null;const L=[];let G=null;p.expectedType&&p.expectedType.kind!=="value"&&(G=p.expectedType);for(let Q=1;Q<u.length;Q+=2){const re=Q===1?-1/0:u[Q],he=u[Q+1],_e=Q,Le=Q+1;if(typeof re!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_e);if(L.length&&L[L.length-1][0]>=re)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_e);const qe=p.parse(he,Le,G);if(!qe)return null;G=G||qe.type,L.push([re,qe])}return new ir(G,S,L)}evaluate(u){const p=this.labels,S=this.outputs;if(p.length===1)return S[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return S[0].evaluate(u);const G=p.length;return L>=p[G-1]?S[G-1].evaluate(u):S[Ur(p,L)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function wr(f,u,p){return f+p*(u-f)}function Mr(f,u,p){return f.map((S,L)=>wr(S,u[L],p))}const js={number:wr,color:function(f,u,p,S="rgb"){switch(S){case"rgb":{const[L,G,Q,re]=Mr(f.rgb,u.rgb,p);return new Hi(L,G,Q,re,!1)}case"hcl":{const[L,G,Q,re]=f.hcl,[he,_e,Le,qe]=u.hcl;let Je,At;if(isNaN(L)||isNaN(he))isNaN(L)?isNaN(he)?Je=NaN:(Je=he,Q!==1&&Q!==0||(At=_e)):(Je=L,Le!==1&&Le!==0||(At=G));else{let $t=he-L;he>L&&$t>180?$t-=360:he<L&&L-he>180&&($t+=360),Je=L+p*$t}const[gt,Mt,Pt,zt]=function([$t,Ht,Zt,ui]){return $t=isNaN($t)?0:$t*ai,vi([Zt,Math.cos($t)*Ht,Math.sin($t)*Ht,ui])}([Je,At??wr(G,_e,p),wr(Q,Le,p),wr(re,qe,p)]);return new Hi(gt,Mt,Pt,zt,!1)}case"lab":{const[L,G,Q,re]=vi(Mr(f.lab,u.lab,p));return new Hi(L,G,Q,re,!1)}}},array:Mr,padding:function(f,u,p){return new Yi(Mr(f.values,u.values,p))},variableAnchorOffsetCollection:function(f,u,p){const S=f.values,L=u.values;if(S.length!==L.length)throw new Br(`Cannot interpolate values of different length. from: ${f.toString()}, to: ${u.toString()}`);const G=[];for(let Q=0;Q<S.length;Q+=2){if(S[Q]!==L[Q])throw new Br(`Cannot interpolate values containing mismatched anchors. from[${Q}]: ${S[Q]}, to[${Q}]: ${L[Q]}`);G.push(S[Q]);const[re,he]=S[Q+1],[_e,Le]=L[Q+1];G.push([wr(re,_e,p),wr(he,Le,p)])}return new En(G)}};class vr{constructor(u,p,S,L,G){this.type=u,this.operator=p,this.interpolation=S,this.input=L,this.labels=[],this.outputs=[];for(const[Q,re]of G)this.labels.push(Q),this.outputs.push(re)}static interpolationFactor(u,p,S,L){let G=0;if(u.name==="exponential")G=Ks(p,u.base,S,L);else if(u.name==="linear")G=Ks(p,1,S,L);else if(u.name==="cubic-bezier"){const Q=u.controlPoints;G=new lt(Q[0],Q[1],Q[2],Q[3]).solve(Ks(p,1,S,L))}return G}static parse(u,p){let[S,L,G,...Q]=u;if(!Array.isArray(L)||L.length===0)return p.error("Expected an interpolation type expression.",1);if(L[0]==="linear")L={name:"linear"};else if(L[0]==="exponential"){const _e=L[1];if(typeof _e!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);L={name:"exponential",base:_e}}else{if(L[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(L[0])}`,1,0);{const _e=L.slice(1);if(_e.length!==4||_e.some(Le=>typeof Le!="number"||Le<0||Le>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);L={name:"cubic-bezier",controlPoints:_e}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(G=p.parse(G,2,He),!G)return null;const re=[];let he=null;S==="interpolate-hcl"||S==="interpolate-lab"?he=ft:p.expectedType&&p.expectedType.kind!=="value"&&(he=p.expectedType);for(let _e=0;_e<Q.length;_e+=2){const Le=Q[_e],qe=Q[_e+1],Je=_e+3,At=_e+4;if(typeof Le!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Je);if(re.length&&re[re.length-1][0]>=Le)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Je);const gt=p.parse(qe,At,he);if(!gt)return null;he=he||gt.type,re.push([Le,gt])}return Ye(he,He)||Ye(he,ft)||Ye(he,X)||Ye(he,de)||Ye(he,ye(He))?new vr(he,S,L,G,re):p.error(`Type ${ge(he)} is not interpolatable.`)}evaluate(u){const p=this.labels,S=this.outputs;if(p.length===1)return S[0].evaluate(u);const L=this.input.evaluate(u);if(L<=p[0])return S[0].evaluate(u);const G=p.length;if(L>=p[G-1])return S[G-1].evaluate(u);const Q=Ur(p,L),re=vr.interpolationFactor(this.interpolation,L,p[Q],p[Q+1]),he=S[Q].evaluate(u),_e=S[Q+1].evaluate(u);switch(this.operator){case"interpolate":return js[this.type.kind](he,_e,re);case"interpolate-hcl":return js.color(he,_e,re,"hcl");case"interpolate-lab":return js.color(he,_e,re,"lab")}}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ks(f,u,p,S){const L=S-p,G=f-p;return L===0?0:u===1?G/L:(Math.pow(u,G)-1)/(Math.pow(u,L)-1)}class Pr{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let S=null;const L=p.expectedType;L&&L.kind!=="value"&&(S=L);const G=[];for(const re of u.slice(1)){const he=p.parse(re,1+G.length,S,void 0,{typeAnnotation:"omit"});if(!he)return null;S=S||he.type,G.push(he)}if(!S)throw new Error("No output type");const Q=L&&G.some(re=>Fe(L,re.type));return new Pr(Q?Me:S,G)}evaluate(u){let p,S=null,L=0;for(const G of this.args)if(L++,S=G.evaluate(u),S&&S instanceof ur&&!S.available&&(p||(p=S.name),S=null,L===this.args.length&&(S=p)),S!==null)break;return S}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class bo{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const S=[];for(let G=1;G<u.length-1;G+=2){const Q=u[G];if(typeof Q!="string")return p.error(`Expected string, but found ${typeof Q} instead.`,G);if(/[^a-zA-Z0-9_]/.test(Q))return p.error("Variable names must contain only alphanumeric characters or '_'.",G);const re=p.parse(u[G+1],G+1);if(!re)return null;S.push([Q,re])}const L=p.parse(u[u.length-1],u.length-1,p.expectedType,S);return L?new bo(S,L):null}outputDefined(){return this.result.outputDefined()}}class Ho{constructor(u,p,S){this.type=u,this.index=p,this.input=S}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,He),L=p.parse(u[2],2,ye(p.expectedType||Me));return S&&L?new Ho(L.type.itemType,S,L):null}evaluate(u){const p=this.index.evaluate(u),S=this.input.evaluate(u);if(p<0)throw new Br(`Array index out of bounds: ${p} < 0.`);if(p>=S.length)throw new Br(`Array index out of bounds: ${p} > ${S.length-1}.`);if(p!==Math.floor(p))throw new Br(`Array index must be an integer, but found ${p} instead.`);return S[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Ls{constructor(u,p){this.type=Ve,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);return S&&L?Ne(S.type,[Ve,Ze,He,Qe,Me])?new Ls(S,L):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(S.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),S=this.haystack.evaluate(u);if(!S)return!1;if(!Xe(p,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(S,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${ge(Vt(S))} instead.`);return S.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class Il{constructor(u,p,S){this.type=He,this.needle=u,this.haystack=p,this.fromIndex=S}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,Me),L=p.parse(u[2],2,Me);if(!S||!L)return null;if(!Ne(S.type,[Ve,Ze,He,Qe,Me]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${ge(S.type)} instead`);if(u.length===4){const G=p.parse(u[3],3,He);return G?new Il(S,L,G):null}return new Il(S,L)}evaluate(u){const p=this.needle.evaluate(u),S=this.haystack.evaluate(u);if(!Xe(p,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${ge(Vt(p))} instead.`);if(!Xe(S,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${ge(Vt(S))} instead.`);if(this.fromIndex){const L=this.fromIndex.evaluate(u);return S.indexOf(p,L)}return S.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class ho{constructor(u,p,S,L,G,Q){this.inputType=u,this.type=p,this.input=S,this.cases=L,this.outputs=G,this.otherwise=Q}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let S,L;p.expectedType&&p.expectedType.kind!=="value"&&(L=p.expectedType);const G={},Q=[];for(let _e=2;_e<u.length-1;_e+=2){let Le=u[_e];const qe=u[_e+1];Array.isArray(Le)||(Le=[Le]);const Je=p.concat(_e);if(Le.length===0)return Je.error("Expected at least one branch label.");for(const gt of Le){if(typeof gt!="number"&&typeof gt!="string")return Je.error("Branch labels must be numbers or strings.");if(typeof gt=="number"&&Math.abs(gt)>Number.MAX_SAFE_INTEGER)return Je.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof gt=="number"&&Math.floor(gt)!==gt)return Je.error("Numeric branch labels must be integer values.");if(S){if(Je.checkSubtype(S,Vt(gt)))return null}else S=Vt(gt);if(G[String(gt)]!==void 0)return Je.error("Branch labels must be unique.");G[String(gt)]=Q.length}const At=p.parse(qe,_e,L);if(!At)return null;L=L||At.type,Q.push(At)}const re=p.parse(u[1],1,Me);if(!re)return null;const he=p.parse(u[u.length-1],u.length-1,L);return he?re.type.kind!=="value"&&p.concat(1).checkSubtype(S,re.type)?null:new ho(S,L,re,G,Q,he):null}evaluate(u){const p=this.input.evaluate(u);return(Vt(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class jo{constructor(u,p,S){this.type=u,this.branches=p,this.otherwise=S}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let S;p.expectedType&&p.expectedType.kind!=="value"&&(S=p.expectedType);const L=[];for(let Q=1;Q<u.length-1;Q+=2){const re=p.parse(u[Q],Q,Ve);if(!re)return null;const he=p.parse(u[Q+1],Q+1,S);if(!he)return null;L.push([re,he]),S=S||he.type}const G=p.parse(u[u.length-1],u.length-1,S);if(!G)return null;if(!S)throw new Error("Can't infer output type");return new jo(S,L,G)}evaluate(u){for(const[p,S]of this.branches)if(p.evaluate(u))return S.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,S]of this.branches)u(p),u(S);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class ca{constructor(u,p,S,L){this.type=u,this.input=p,this.beginIndex=S,this.endIndex=L}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const S=p.parse(u[1],1,Me),L=p.parse(u[2],2,He);if(!S||!L)return null;if(!Ne(S.type,[ye(Me),Ze,Me]))return p.error(`Expected first argument to be of type array or string, but found ${ge(S.type)} instead`);if(u.length===4){const G=p.parse(u[3],3,He);return G?new ca(S.type,S,L,G):null}return new ca(S.type,S,L)}evaluate(u){const p=this.input.evaluate(u),S=this.beginIndex.evaluate(u);if(!Xe(p,["string","array"]))throw new Br(`Expected first argument to be of type array or string, but found ${ge(Vt(p))} instead.`);if(this.endIndex){const L=this.endIndex.evaluate(u);return p.slice(S,L)}return p.slice(S)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Ys(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function El(f,u,p,S){return S.compare(u,p)===0}function Ha(f,u,p){const S=f!=="=="&&f!=="!=";return class $S{constructor(G,Q,re){this.type=Ve,this.lhs=G,this.rhs=Q,this.collator=re,this.hasUntypedArgument=G.type.kind==="value"||Q.type.kind==="value"}static parse(G,Q){if(G.length!==3&&G.length!==4)return Q.error("Expected two or three arguments.");const re=G[0];let he=Q.parse(G[1],1,Me);if(!he)return null;if(!Ys(re,he.type))return Q.concat(1).error(`"${re}" comparisons are not supported for type '${ge(he.type)}'.`);let _e=Q.parse(G[2],2,Me);if(!_e)return null;if(!Ys(re,_e.type))return Q.concat(2).error(`"${re}" comparisons are not supported for type '${ge(_e.type)}'.`);if(he.type.kind!==_e.type.kind&&he.type.kind!=="value"&&_e.type.kind!=="value")return Q.error(`Cannot compare types '${ge(he.type)}' and '${ge(_e.type)}'.`);S&&(he.type.kind==="value"&&_e.type.kind!=="value"?he=new ua(_e.type,[he]):he.type.kind!=="value"&&_e.type.kind==="value"&&(_e=new ua(he.type,[_e])));let Le=null;if(G.length===4){if(he.type.kind!=="string"&&_e.type.kind!=="string"&&he.type.kind!=="value"&&_e.type.kind!=="value")return Q.error("Cannot use collator to compare non-string types.");if(Le=Q.parse(G[3],3,se),!Le)return null}return new $S(he,_e,Le)}evaluate(G){const Q=this.lhs.evaluate(G),re=this.rhs.evaluate(G);if(S&&this.hasUntypedArgument){const he=Vt(Q),_e=Vt(re);if(he.kind!==_e.kind||he.kind!=="string"&&he.kind!=="number")throw new Br(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${he.kind}, ${_e.kind}) instead.`)}if(this.collator&&!S&&this.hasUntypedArgument){const he=Vt(Q),_e=Vt(re);if(he.kind!=="string"||_e.kind!=="string")return u(G,Q,re)}return this.collator?p(G,Q,re,this.collator.evaluate(G)):u(G,Q,re)}eachChild(G){G(this.lhs),G(this.rhs),this.collator&&G(this.collator)}outputDefined(){return!0}}}const Ta=Ha("==",function(f,u,p){return u===p},El),ml=Ha("!=",function(f,u,p){return u!==p},function(f,u,p,S){return!El(0,u,p,S)}),Cl=Ha("<",function(f,u,p){return u<p},function(f,u,p,S){return S.compare(u,p)<0}),pu=Ha(">",function(f,u,p){return u>p},function(f,u,p,S){return S.compare(u,p)>0}),us=Ha("<=",function(f,u,p){return u<=p},function(f,u,p,S){return S.compare(u,p)<=0}),sc=Ha(">=",function(f,u,p){return u>=p},function(f,u,p,S){return S.compare(u,p)>=0});class eo{constructor(u,p,S,L,G){this.type=Ze,this.number=u,this.locale=p,this.currency=S,this.minFractionDigits=L,this.maxFractionDigits=G}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const S=p.parse(u[1],1,He);if(!S)return null;const L=u[2];if(typeof L!="object"||Array.isArray(L))return p.error("NumberFormat options argument must be an object.");let G=null;if(L.locale&&(G=p.parse(L.locale,1,Ze),!G))return null;let Q=null;if(L.currency&&(Q=p.parse(L.currency,1,Ze),!Q))return null;let re=null;if(L["min-fraction-digits"]&&(re=p.parse(L["min-fraction-digits"],1,He),!re))return null;let he=null;return L["max-fraction-digits"]&&(he=p.parse(L["max-fraction-digits"],1,He),!he)?null:new eo(S,G,Q,re,he)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class to{constructor(u){this.type=ne,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const S=u[1];if(!Array.isArray(S)&&typeof S=="object")return p.error("First argument must be an image or text section.");const L=[];let G=!1;for(let Q=1;Q<=u.length-1;++Q){const re=u[Q];if(G&&typeof re=="object"&&!Array.isArray(re)){G=!1;let he=null;if(re["font-scale"]&&(he=p.parse(re["font-scale"],1,He),!he))return null;let _e=null;if(re["text-font"]&&(_e=p.parse(re["text-font"],1,ye(Ze)),!_e))return null;let Le=null;if(re["text-color"]&&(Le=p.parse(re["text-color"],1,ft),!Le))return null;const qe=L[L.length-1];qe.scale=he,qe.font=_e,qe.textColor=Le}else{const he=p.parse(u[Q],1,Me);if(!he)return null;const _e=he.type.kind;if(_e!=="string"&&_e!=="value"&&_e!=="null"&&_e!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");G=!0,L.push({content:he,scale:null,font:null,textColor:null})}}return new to(L)}evaluate(u){return new Qt(this.sections.map(p=>{const S=p.content.evaluate(u);return Vt(S)===ie?new Fn("",S,null,null,null):new Fn(cr(S),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}}class ql{constructor(u){this.type=ie,this.input=u}static parse(u,p){if(u.length!==2)return p.error("Expected two arguments.");const S=p.parse(u[1],1,Ze);return S?new ql(S):p.error("No image name provided.")}evaluate(u){const p=this.input.evaluate(u),S=ur.fromString(p);return S&&u.availableImages&&(S.available=u.availableImages.indexOf(p)>-1),S}eachChild(u){u(this.input)}outputDefined(){return!1}}class Ro{constructor(u){this.type=He,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const S=p.parse(u[1],1);return S?S.type.kind!=="array"&&S.type.kind!=="string"&&S.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${ge(S.type)} instead.`):new Ro(S):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Br(`Expected value to be of type string or array, but found ${ge(Vt(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Zo={"==":Ta,"!=":ml,">":pu,"<":Cl,">=":sc,"<=":us,array:ua,at:Ho,boolean:ua,case:jo,coalesce:Pr,collator:jn,format:to,image:ql,in:Ls,"index-of":Il,interpolate:vr,"interpolate-hcl":vr,"interpolate-lab":vr,length:Ro,let:bo,literal:Lt,match:ho,number:ua,"number-format":eo,object:ua,slice:ca,step:ir,string:ua,"to-boolean":Fa,"to-color":Fa,"to-number":Fa,"to-string":Fa,var:hr,within:rr};function wo(f,[u,p,S,L]){u=u.evaluate(f),p=p.evaluate(f),S=S.evaluate(f);const G=L?L.evaluate(f):1,Q=Ns(u,p,S,G);if(Q)throw new Br(Q);return new Hi(u/255,p/255,S/255,G,!1)}function Us(f,u){return f in u}function Qo(f,u){const p=u[f];return p===void 0?null:p}function Wo(f){return{type:f}}function Xo(f){return{result:"success",value:f}}function ba(f){return{result:"error",value:f}}function ja(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Ts(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function mu(f){return!!f.expression&&f.expression.interpolated}function Sr(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Xn(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function Yo(f){return f}function Dr(f,u){const p=u.type==="color",S=f.stops&&typeof f.stops[0][0]=="object",L=S||!(S||f.property!==void 0),G=f.type||(mu(u)?"exponential":"interval");if(p||u.type==="padding"){const Le=p?Hi.parse:Yi.parse;(f=Ie({},f)).stops&&(f.stops=f.stops.map(qe=>[qe[0],Le(qe[1])])),f.default=Le(f.default?f.default:u.default)}if(f.colorSpace&&(Q=f.colorSpace)!=="rgb"&&Q!=="hcl"&&Q!=="lab")throw new Error(`Unknown color space: "${f.colorSpace}"`);var Q;let re,he,_e;if(G==="exponential")re=So;else if(G==="interval")re=Ar;else if(G==="categorical"){re=Kr,he=Object.create(null);for(const Le of f.stops)he[Le[0]]=Le[1];_e=typeof f.stops[0][0]}else{if(G!=="identity")throw new Error(`Unknown function type "${G}"`);re=Nn}if(S){const Le={},qe=[];for(let gt=0;gt<f.stops.length;gt++){const Mt=f.stops[gt],Pt=Mt[0].zoom;Le[Pt]===void 0&&(Le[Pt]={zoom:Pt,type:f.type,property:f.property,default:f.default,stops:[]},qe.push(Pt)),Le[Pt].stops.push([Mt[0].value,Mt[1]])}const Je=[];for(const gt of qe)Je.push([Le[gt].zoom,Dr(Le[gt],u)]);const At={name:"linear"};return{kind:"composite",interpolationType:At,interpolationFactor:vr.interpolationFactor.bind(void 0,At),zoomStops:Je.map(gt=>gt[0]),evaluate:({zoom:gt},Mt)=>So({stops:Je,base:f.base},u,gt).evaluate(gt,Mt)}}if(L){const Le=G==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Le,interpolationFactor:vr.interpolationFactor.bind(void 0,Le),zoomStops:f.stops.map(qe=>qe[0]),evaluate:({zoom:qe})=>re(f,u,qe,he,_e)}}return{kind:"source",evaluate(Le,qe){const Je=qe&&qe.properties?qe.properties[f.property]:void 0;return Je===void 0?Za(f.default,u.default):re(f,u,Je,he,_e)}}}function Za(f,u,p){return f!==void 0?f:u!==void 0?u:p!==void 0?p:void 0}function Kr(f,u,p,S,L){return Za(typeof p===L?S[p]:void 0,f.default,u.default)}function Ar(f,u,p){if(Sr(p)!=="number")return Za(f.default,u.default);const S=f.stops.length;if(S===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[S-1][0])return f.stops[S-1][1];const L=Ur(f.stops.map(G=>G[0]),p);return f.stops[L][1]}function So(f,u,p){const S=f.base!==void 0?f.base:1;if(Sr(p)!=="number")return Za(f.default,u.default);const L=f.stops.length;if(L===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[L-1][0])return f.stops[L-1][1];const G=Ur(f.stops.map(Le=>Le[0]),p),Q=function(Le,qe,Je,At){const gt=At-Je,Mt=Le-Je;return gt===0?0:qe===1?Mt/gt:(Math.pow(qe,Mt)-1)/(Math.pow(qe,gt)-1)}(p,S,f.stops[G][0],f.stops[G+1][0]),re=f.stops[G][1],he=f.stops[G+1][1],_e=js[u.type]||Yo;return typeof re.evaluate=="function"?{evaluate(...Le){const qe=re.evaluate.apply(void 0,Le),Je=he.evaluate.apply(void 0,Le);if(qe!==void 0&&Je!==void 0)return _e(qe,Je,Q,f.colorSpace)}}:_e(re,he,Q,f.colorSpace)}function Nn(f,u,p){switch(u.type){case"color":p=Hi.parse(p);break;case"formatted":p=Qt.fromString(p.toString());break;case"resolvedImage":p=ur.fromString(p.toString());break;case"padding":p=Yi.parse(p);break;default:Sr(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0)}return Za(p,f.default,u.default)}zr.register(Zo,{error:[{kind:"error"},[Ze],(f,[u])=>{throw new Br(u.evaluate(f))}],typeof:[Ze,[Me],(f,[u])=>ge(Vt(u.evaluate(f)))],"to-rgba":[ye(He,4),[ft],(f,[u])=>{const[p,S,L,G]=u.evaluate(f).rgb;return[255*p,255*S,255*L,G]}],rgb:[ft,[He,He,He],wo],rgba:[ft,[He,He,He,He],wo],has:{type:Ve,overloads:[[[Ze],(f,[u])=>Us(u.evaluate(f),f.properties())],[[Ze,rt],(f,[u,p])=>Us(u.evaluate(f),p.evaluate(f))]]},get:{type:Me,overloads:[[[Ze],(f,[u])=>Qo(u.evaluate(f),f.properties())],[[Ze,rt],(f,[u,p])=>Qo(u.evaluate(f),p.evaluate(f))]]},"feature-state":[Me,[Ze],(f,[u])=>Qo(u.evaluate(f),f.featureState||{})],properties:[rt,[],f=>f.properties()],"geometry-type":[Ze,[],f=>f.geometryType()],id:[Me,[],f=>f.id()],zoom:[He,[],f=>f.globals.zoom],"heatmap-density":[He,[],f=>f.globals.heatmapDensity||0],"line-progress":[He,[],f=>f.globals.lineProgress||0],accumulated:[Me,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[He,Wo(He),(f,u)=>{let p=0;for(const S of u)p+=S.evaluate(f);return p}],"*":[He,Wo(He),(f,u)=>{let p=1;for(const S of u)p*=S.evaluate(f);return p}],"-":{type:He,overloads:[[[He,He],(f,[u,p])=>u.evaluate(f)-p.evaluate(f)],[[He],(f,[u])=>-u.evaluate(f)]]},"/":[He,[He,He],(f,[u,p])=>u.evaluate(f)/p.evaluate(f)],"%":[He,[He,He],(f,[u,p])=>u.evaluate(f)%p.evaluate(f)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(f,[u,p])=>Math.pow(u.evaluate(f),p.evaluate(f))],sqrt:[He,[He],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[He,[He],(f,[u])=>Math.log(u.evaluate(f))],log2:[He,[He],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[He,[He],(f,[u])=>Math.sin(u.evaluate(f))],cos:[He,[He],(f,[u])=>Math.cos(u.evaluate(f))],tan:[He,[He],(f,[u])=>Math.tan(u.evaluate(f))],asin:[He,[He],(f,[u])=>Math.asin(u.evaluate(f))],acos:[He,[He],(f,[u])=>Math.acos(u.evaluate(f))],atan:[He,[He],(f,[u])=>Math.atan(u.evaluate(f))],min:[He,Wo(He),(f,u)=>Math.min(...u.map(p=>p.evaluate(f)))],max:[He,Wo(He),(f,u)=>Math.max(...u.map(p=>p.evaluate(f)))],abs:[He,[He],(f,[u])=>Math.abs(u.evaluate(f))],round:[He,[He],(f,[u])=>{const p=u.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[He,[He],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[He,[He],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[Ve,[Ze,Me],(f,[u,p])=>f.properties()[u.value]===p.value],"filter-id-==":[Ve,[Me],(f,[u])=>f.id()===u.value],"filter-type-==":[Ve,[Ze],(f,[u])=>f.geometryType()===u.value],"filter-<":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S<L}],"filter-id-<":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p<S}],"filter->":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S>L}],"filter-id->":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p>S}],"filter-<=":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S<=L}],"filter-id-<=":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p<=S}],"filter->=":[Ve,[Ze,Me],(f,[u,p])=>{const S=f.properties()[u.value],L=p.value;return typeof S==typeof L&&S>=L}],"filter-id->=":[Ve,[Me],(f,[u])=>{const p=f.id(),S=u.value;return typeof p==typeof S&&p>=S}],"filter-has":[Ve,[Me],(f,[u])=>u.value in f.properties()],"filter-has-id":[Ve,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[Ve,[ye(Ze)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[Ve,[ye(Me)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[Ve,[Ze,ye(Me)],(f,[u,p])=>p.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[Ve,[Ze,ye(Me)],(f,[u,p])=>function(S,L,G,Q){for(;G<=Q;){const re=G+Q>>1;if(L[re]===S)return!0;L[re]>S?Q=re-1:G=re+1}return!1}(f.properties()[u.value],p.value,0,p.value.length-1)],all:{type:Ve,overloads:[[[Ve,Ve],(f,[u,p])=>u.evaluate(f)&&p.evaluate(f)],[Wo(Ve),(f,u)=>{for(const p of u)if(!p.evaluate(f))return!1;return!0}]]},any:{type:Ve,overloads:[[[Ve,Ve],(f,[u,p])=>u.evaluate(f)||p.evaluate(f)],[Wo(Ve),(f,u)=>{for(const p of u)if(p.evaluate(f))return!0;return!1}]]},"!":[Ve,[Ve],(f,[u])=>!u.evaluate(f)],"is-supported-script":[Ve,[Ze],(f,[u])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(u.evaluate(f))}],upcase:[Ze,[Ze],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Ze,[Ze],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Ze,Wo(Me),(f,u)=>u.map(p=>cr(p.evaluate(f))).join("")],"resolved-locale":[Ze,[se],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Ol{constructor(u,p){var S;this.expression=u,this._warningHistory={},this._evaluator=new Oa,this._defaultValue=p?(S=p).type==="color"&&Xn(S.default)?new Hi(0,0,0,0):S.type==="color"?Hi.parse(S.default)||null:S.type==="padding"?Yi.parse(S.default)||null:S.type==="variableAnchorOffsetCollection"?En.parse(S.default)||null:S.default===void 0?null:S.default:null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,S,L,G,Q){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=S,this._evaluator.canonical=L,this._evaluator.availableImages=G||null,this._evaluator.formattedSection=Q,this.expression.evaluate(this._evaluator)}evaluate(u,p,S,L,G,Q){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=S||null,this._evaluator.canonical=L,this._evaluator.availableImages=G||null,this._evaluator.formattedSection=Q||null;try{const re=this.expression.evaluate(this._evaluator);if(re==null||typeof re=="number"&&re!=re)return this._defaultValue;if(this._enumValues&&!(re in this._enumValues))throw new Br(`Expected value to be one of ${Object.keys(this._enumValues).map(he=>JSON.stringify(he)).join(", ")}, but found ${JSON.stringify(re)} instead.`);return re}catch(re){return this._warningHistory[re.message]||(this._warningHistory[re.message]=!0,typeof console<"u"&&console.warn(re.message)),this._defaultValue}}}function Jr(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Zo}function jr(f,u){const p=new Xs(Zo,Ua,[],u?function(L){const G={color:ft,string:Ze,number:He,enum:Ze,boolean:Ve,formatted:ne,padding:X,resolvedImage:ie,variableAnchorOffsetCollection:de};return L.type==="array"?ye(G[L.value]||Me,L.length):G[L.type]}(u):void 0),S=p.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return S?Xo(new Ol(S,u)):ba(p.errors)}class ks{constructor(u,p){this.kind=u,this._styleExpression=p,this.isStateDependent=u!=="constant"&&!qa(p.expression)}evaluateWithoutErrorHandling(u,p,S,L,G,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,S,L,G,Q)}evaluate(u,p,S,L,G,Q){return this._styleExpression.evaluate(u,p,S,L,G,Q)}}class Cr{constructor(u,p,S,L){this.kind=u,this.zoomStops=S,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!qa(p.expression),this.interpolationType=L}evaluateWithoutErrorHandling(u,p,S,L,G,Q){return this._styleExpression.evaluateWithoutErrorHandling(u,p,S,L,G,Q)}evaluate(u,p,S,L,G,Q){return this._styleExpression.evaluate(u,p,S,L,G,Q)}interpolationFactor(u,p,S){return this.interpolationType?vr.interpolationFactor(this.interpolationType,u,p,S):0}}function nr(f,u){const p=jr(f,u);if(p.result==="error")return p;const S=p.value.expression,L=Ga(S);if(!L&&!ja(u))return ba([new Ee("","data expressions not supported")]);const G=pl(S,["zoom"]);if(!G&&!Ts(u))return ba([new Ee("","zoom expressions not supported")]);const Q=Xr(S);return Q||G?Q instanceof Ee?ba([Q]):Q instanceof vr&&!mu(u)?ba([new Ee("",'"interpolate" expressions cannot be used with this property')]):Xo(Q?new Cr(L?"camera":"composite",p.value,Q.labels,Q instanceof vr?Q.interpolation:void 0):new ks(L?"constant":"source",p.value)):ba([new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class al{constructor(u,p){this._parameters=u,this._specification=p,Ie(this,Dr(this._parameters,this._specification))}static deserialize(u){return new al(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function Xr(f){let u=null;if(f instanceof bo)u=Xr(f.result);else if(f instanceof Pr){for(const p of f.args)if(u=Xr(p),u)break}else(f instanceof ir||f instanceof vr)&&f.input instanceof zr&&f.input.name==="zoom"&&(u=f);return u instanceof Ee||f.eachChild(p=>{const S=Xr(p);S instanceof Ee?u=S:!u&&S?u=new Ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&S&&u!==S&&(u=new Ee("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function Io(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!Io(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const ol={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Zr(f){if(f==null)return{filter:()=>!0,needGeometry:!1};Io(f)||(f=Tl(f));const u=jr(f,ol);if(u.result==="error")throw new Error(u.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,S,L)=>u.value.evaluate(p,S,{},L),needGeometry:wa(f)}}function hs(f,u){return f<u?-1:f>u?1:0}function wa(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(wa(f[u]))return!0;return!1}function Tl(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?Eo(f[1],f[2],"=="):u==="!="?Js(Eo(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Eo(f[1],f[2],u):u==="any"?(p=f.slice(1),["any"].concat(p.map(Tl))):u==="all"?["all"].concat(f.slice(1).map(Tl)):u==="none"?["all"].concat(f.slice(1).map(Tl).map(Js)):u==="in"?kl(f[1],f.slice(2)):u==="!in"?Js(kl(f[1],f.slice(2))):u==="has"?Ao(f[1]):u==="!has"?Js(Ao(f[1])):u!=="within"||f;var p}function Eo(f,u,p){switch(f){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,f,u]}}function kl(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",f,["literal",u.sort(hs)]]:["filter-in-small",f,["literal",u]]}}function Ao(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Js(f){return["!",f]}function Gs(f){const u=typeof f;if(u==="number"||u==="boolean"||u==="string"||f==null)return JSON.stringify(f);if(Array.isArray(f)){let L="[";for(const G of f)L+=`${Gs(G)},`;return`${L}]`}const p=Object.keys(f).sort();let S="{";for(let L=0;L<p.length;L++)S+=`${JSON.stringify(p[L])}:${Gs(f[p[L]])},`;return`${S}}`}function Qa(f){let u="";for(const p of ln)u+=`/${Gs(f[p])}`;return u}function $o(f){const u=f.value;return u?[new ve(f.key,u,"constants have been deprecated as of v8")]:[]}function Yr(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function mr(f){if(Array.isArray(f))return f.map(mr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const p in f)u[p]=mr(f[p]);return u}return Yr(f)}function Rr(f){const u=f.key,p=f.value,S=f.valueSpec||{},L=f.objectElementValidators||{},G=f.style,Q=f.styleSpec,re=f.validateSpec;let he=[];const _e=Sr(p);if(_e!=="object")return[new ve(u,p,`object expected, ${_e} found`)];for(const Le in p){const qe=Le.split(".")[0],Je=S[qe]||S["*"];let At;if(L[qe])At=L[qe];else if(S[qe])At=re;else if(L["*"])At=L["*"];else{if(!S["*"]){he.push(new ve(u,p[Le],`unknown property "${Le}"`));continue}At=re}he=he.concat(At({key:(u&&`${u}.`)+Le,value:p[Le],valueSpec:Je,style:G,styleSpec:Q,object:p,objectKey:Le,validateSpec:re},p))}for(const Le in S)L[Le]||S[Le].required&&S[Le].default===void 0&&p[Le]===void 0&&he.push(new ve(u,p,`missing required property "${Le}"`));return he}function ha(f){const u=f.value,p=f.valueSpec,S=f.style,L=f.styleSpec,G=f.key,Q=f.arrayElementValidator||f.validateSpec;if(Sr(u)!=="array")return[new ve(G,u,`array expected, ${Sr(u)} found`)];if(p.length&&u.length!==p.length)return[new ve(G,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new ve(G,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let re={type:p.value,values:p.values};L.$version<7&&(re.function=p.function),Sr(p.value)==="object"&&(re=p.value);let he=[];for(let _e=0;_e<u.length;_e++)he=he.concat(Q({array:u,arrayIndex:_e,value:u[_e],valueSpec:re,validateSpec:f.validateSpec,style:S,styleSpec:L,key:`${G}[${_e}]`}));return he}function fo(f){const u=f.key,p=f.value,S=f.valueSpec;let L=Sr(p);return L==="number"&&p!=p&&(L="NaN"),L!=="number"?[new ve(u,p,`number expected, ${L} found`)]:"minimum"in S&&p<S.minimum?[new ve(u,p,`${p} is less than the minimum value ${S.minimum}`)]:"maximum"in S&&p>S.maximum?[new ve(u,p,`${p} is greater than the maximum value ${S.maximum}`)]:[]}function ea(f){const u=f.valueSpec,p=Yr(f.value.type);let S,L,G,Q={};const re=p!=="categorical"&&f.value.property===void 0,he=!re,_e=Sr(f.value.stops)==="array"&&Sr(f.value.stops[0])==="array"&&Sr(f.value.stops[0][0])==="object",Le=Rr({key:f.key,value:f.value,valueSpec:f.styleSpec.function,validateSpec:f.validateSpec,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(At){if(p==="identity")return[new ve(At.key,At.value,'identity function may not have a "stops" property')];let gt=[];const Mt=At.value;return gt=gt.concat(ha({key:At.key,value:Mt,valueSpec:At.valueSpec,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec,arrayElementValidator:qe})),Sr(Mt)==="array"&&Mt.length===0&&gt.push(new ve(At.key,Mt,"array must have at least one stop")),gt},default:function(At){return At.validateSpec({key:At.key,value:At.value,valueSpec:u,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec})}}});return p==="identity"&&re&&Le.push(new ve(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Le.push(new ve(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!mu(f.valueSpec)&&Le.push(new ve(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(he&&!ja(f.valueSpec)?Le.push(new ve(f.key,f.value,"property functions not supported")):re&&!Ts(f.valueSpec)&&Le.push(new ve(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!_e||f.value.property!==void 0||Le.push(new ve(f.key,f.value,'"property" property is required')),Le;function qe(At){let gt=[];const Mt=At.value,Pt=At.key;if(Sr(Mt)!=="array")return[new ve(Pt,Mt,`array expected, ${Sr(Mt)} found`)];if(Mt.length!==2)return[new ve(Pt,Mt,`array length 2 expected, length ${Mt.length} found`)];if(_e){if(Sr(Mt[0])!=="object")return[new ve(Pt,Mt,`object expected, ${Sr(Mt[0])} found`)];if(Mt[0].zoom===void 0)return[new ve(Pt,Mt,"object stop key must have zoom")];if(Mt[0].value===void 0)return[new ve(Pt,Mt,"object stop key must have value")];if(G&&G>Yr(Mt[0].zoom))return[new ve(Pt,Mt[0].zoom,"stop zoom values must appear in ascending order")];Yr(Mt[0].zoom)!==G&&(G=Yr(Mt[0].zoom),L=void 0,Q={}),gt=gt.concat(Rr({key:`${Pt}[0]`,value:Mt[0],valueSpec:{zoom:{}},validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec,objectElementValidators:{zoom:fo,value:Je}}))}else gt=gt.concat(Je({key:`${Pt}[0]`,value:Mt[0],valueSpec:{},validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec},Mt));return Jr(mr(Mt[1]))?gt.concat([new ve(`${Pt}[1]`,Mt[1],"expressions are not allowed in function stops.")]):gt.concat(At.validateSpec({key:`${Pt}[1]`,value:Mt[1],valueSpec:u,validateSpec:At.validateSpec,style:At.style,styleSpec:At.styleSpec}))}function Je(At,gt){const Mt=Sr(At.value),Pt=Yr(At.value),zt=At.value!==null?At.value:gt;if(S){if(Mt!==S)return[new ve(At.key,zt,`${Mt} stop domain type must match previous stop domain type ${S}`)]}else S=Mt;if(Mt!=="number"&&Mt!=="string"&&Mt!=="boolean")return[new ve(At.key,zt,"stop domain value must be a number, string, or boolean")];if(Mt!=="number"&&p!=="categorical"){let $t=`number expected, ${Mt} found`;return ja(u)&&p===void 0&&($t+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ve(At.key,zt,$t)]}return p!=="categorical"||Mt!=="number"||isFinite(Pt)&&Math.floor(Pt)===Pt?p!=="categorical"&&Mt==="number"&&L!==void 0&&Pt<L?[new ve(At.key,zt,"stop domain values must appear in ascending order")]:(L=Pt,p==="categorical"&&Pt in Q?[new ve(At.key,zt,"stop domain values must be unique")]:(Q[Pt]=!0,[])):[new ve(At.key,zt,`integer expected, found ${Pt}`)]}}function Sa(f){const u=(f.expressionContext==="property"?nr:jr)(mr(f.value),f.valueSpec);if(u.result==="error")return u.value.map(S=>new ve(`${f.key}${S.key}`,f.value,S.message));const p=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new ve(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!qa(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!qa(p))return[new ve(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!pl(p,["zoom","feature-state"]))return[new ve(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!Ga(p))return[new ve(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ka(f){const u=f.key,p=f.value,S=f.valueSpec,L=[];return Array.isArray(S.values)?S.values.indexOf(Yr(p))===-1&&L.push(new ve(u,p,`expected one of [${S.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(S.values).indexOf(Yr(p))===-1&&L.push(new ve(u,p,`expected one of [${Object.keys(S.values).join(", ")}], ${JSON.stringify(p)} found`)),L}function Wa(f){return Io(mr(f.value))?Sa(Ie({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ll(f)}function ll(f){const u=f.value,p=f.key;if(Sr(u)!=="array")return[new ve(p,u,`array expected, ${Sr(u)} found`)];const S=f.styleSpec;let L,G=[];if(u.length<1)return[new ve(p,u,"filter array must have at least 1 element")];switch(G=G.concat(ka({key:`${p}[0]`,value:u[0],valueSpec:S.filter_operator,style:f.style,styleSpec:f.styleSpec})),Yr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Yr(u[1])==="$type"&&G.push(new ve(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&G.push(new ve(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(L=Sr(u[1]),L!=="string"&&G.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`)));for(let Q=2;Q<u.length;Q++)L=Sr(u[Q]),Yr(u[1])==="$type"?G=G.concat(ka({key:`${p}[${Q}]`,value:u[Q],valueSpec:S.geometry_type,style:f.style,styleSpec:f.styleSpec})):L!=="string"&&L!=="number"&&L!=="boolean"&&G.push(new ve(`${p}[${Q}]`,u[Q],`string, number, or boolean expected, ${L} found`));break;case"any":case"all":case"none":for(let Q=1;Q<u.length;Q++)G=G.concat(ll({key:`${p}[${Q}]`,value:u[Q],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":L=Sr(u[1]),u.length!==2?G.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="string"&&G.push(new ve(`${p}[1]`,u[1],`string expected, ${L} found`));break;case"within":L=Sr(u[1]),u.length!==2?G.push(new ve(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):L!=="object"&&G.push(new ve(`${p}[1]`,u[1],`object expected, ${L} found`))}return G}function ou(f,u){const p=f.key,S=f.validateSpec,L=f.style,G=f.styleSpec,Q=f.value,re=f.objectKey,he=G[`${u}_${f.layerType}`];if(!he)return[];const _e=re.match(/^(.*)-transition$/);if(u==="paint"&&_e&&he[_e[1]]&&he[_e[1]].transition)return S({key:p,value:Q,valueSpec:G.transition,style:L,styleSpec:G});const Le=f.valueSpec||he[re];if(!Le)return[new ve(p,Q,`unknown property "${re}"`)];let qe;if(Sr(Q)==="string"&&ja(Le)&&!Le.tokens&&(qe=/^{([^}]+)}$/.exec(Q)))return[new ve(p,Q,`"${re}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(qe[1])} }\`.`)];const Je=[];return f.layerType==="symbol"&&(re==="text-field"&&L&&!L.glyphs&&Je.push(new ve(p,Q,'use of "text-field" requires a style "glyphs" property')),re==="text-font"&&Xn(mr(Q))&&Yr(Q.type)==="identity"&&Je.push(new ve(p,Q,'"text-font" does not support identity functions'))),Je.concat(S({key:f.key,value:Q,valueSpec:Le,style:L,styleSpec:G,expressionContext:"property",propertyType:u,propertyKey:re}))}function gl(f){return ou(f,"paint")}function io(f){return ou(f,"layout")}function mi(f){let u=[];const p=f.value,S=f.key,L=f.style,G=f.styleSpec;p.type||p.ref||u.push(new ve(S,p,'either "type" or "ref" is required'));let Q=Yr(p.type);const re=Yr(p.ref);if(p.id){const he=Yr(p.id);for(let _e=0;_e<f.arrayIndex;_e++){const Le=L.layers[_e];Yr(Le.id)===he&&u.push(new ve(S,p.id,`duplicate layer id "${p.id}", previously used at line ${Le.id.__line__}`))}}if("ref"in p){let he;["type","source","source-layer","filter","layout"].forEach(_e=>{_e in p&&u.push(new ve(S,p[_e],`"${_e}" is prohibited for ref layers`))}),L.layers.forEach(_e=>{Yr(_e.id)===re&&(he=_e)}),he?he.ref?u.push(new ve(S,p.ref,"ref cannot reference another ref layer")):Q=Yr(he.type):u.push(new ve(S,p.ref,`ref layer "${re}" not found`))}else if(Q!=="background")if(p.source){const he=L.sources&&L.sources[p.source],_e=he&&Yr(he.type);he?_e==="vector"&&Q==="raster"?u.push(new ve(S,p.source,`layer "${p.id}" requires a raster source`)):_e!=="raster-dem"&&Q==="hillshade"?u.push(new ve(S,p.source,`layer "${p.id}" requires a raster-dem source`)):_e==="raster"&&Q!=="raster"?u.push(new ve(S,p.source,`layer "${p.id}" requires a vector source`)):_e!=="vector"||p["source-layer"]?_e==="raster-dem"&&Q!=="hillshade"?u.push(new ve(S,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="line"||!p.paint||!p.paint["line-gradient"]||_e==="geojson"&&he.lineMetrics||u.push(new ve(S,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new ve(S,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new ve(S,p.source,`source "${p.source}" not found`))}else u.push(new ve(S,p,'missing required property "source"'));return u=u.concat(Rr({key:S,value:p,valueSpec:G.layer,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,objectElementValidators:{"*":()=>[],type:()=>f.validateSpec({key:`${S}.type`,value:p.type,valueSpec:G.layer.type,style:f.style,styleSpec:f.styleSpec,validateSpec:f.validateSpec,object:p,objectKey:"type"}),filter:Wa,layout:he=>Rr({layer:p,key:he.key,value:he.value,style:he.style,styleSpec:he.styleSpec,validateSpec:he.validateSpec,objectElementValidators:{"*":_e=>io(Ie({layerType:Q},_e))}}),paint:he=>Rr({layer:p,key:he.key,value:he.value,style:he.style,styleSpec:he.styleSpec,validateSpec:he.validateSpec,objectElementValidators:{"*":_e=>gl(Ie({layerType:Q},_e))}})}})),u}function Ni(f){const u=f.value,p=f.key,S=Sr(u);return S!=="string"?[new ve(p,u,`string expected, ${S} found`)]:[]}const Di={promoteId:function({key:f,value:u}){if(Sr(u)==="string")return Ni({key:f,value:u});{const p=[];for(const S in u)p.push(...Ni({key:`${f}.${S}`,value:u[S]}));return p}}};function Ot(f){const u=f.value,p=f.key,S=f.styleSpec,L=f.style,G=f.validateSpec;if(!u.type)return[new ve(p,u,'"type" is required')];const Q=Yr(u.type);let re;switch(Q){case"vector":case"raster":return re=Rr({key:p,value:u,valueSpec:S[`source_${Q.replace("-","_")}`],style:f.style,styleSpec:S,objectElementValidators:Di,validateSpec:G}),re;case"raster-dem":return re=function(he){var _e;const Le=(_e=he.sourceName)!==null&&_e!==void 0?_e:"",qe=he.value,Je=he.styleSpec,At=Je.source_raster_dem,gt=he.style;let Mt=[];const Pt=Sr(qe);if(qe===void 0)return Mt;if(Pt!=="object")return Mt.push(new ve("source_raster_dem",qe,`object expected, ${Pt} found`)),Mt;const zt=Yr(qe.encoding)==="custom",$t=["redFactor","greenFactor","blueFactor","baseShift"],Ht=he.value.encoding?`"${he.value.encoding}"`:"Default";for(const Zt in qe)!zt&&$t.includes(Zt)?Mt.push(new ve(Zt,qe[Zt],`In "${Le}": "${Zt}" is only valid when "encoding" is set to "custom". ${Ht} encoding found`)):At[Zt]?Mt=Mt.concat(he.validateSpec({key:Zt,value:qe[Zt],valueSpec:At[Zt],validateSpec:he.validateSpec,style:gt,styleSpec:Je})):Mt.push(new ve(Zt,qe[Zt],`unknown property "${Zt}"`));return Mt}({sourceName:p,value:u,style:f.style,styleSpec:S,validateSpec:G}),re;case"geojson":if(re=Rr({key:p,value:u,valueSpec:S.source_geojson,style:L,styleSpec:S,validateSpec:G,objectElementValidators:Di}),u.cluster)for(const he in u.clusterProperties){const[_e,Le]=u.clusterProperties[he],qe=typeof _e=="string"?[_e,["accumulated"],["get",he]]:_e;re.push(...Sa({key:`${p}.${he}.map`,value:Le,validateSpec:G,expressionContext:"cluster-map"})),re.push(...Sa({key:`${p}.${he}.reduce`,value:qe,validateSpec:G,expressionContext:"cluster-reduce"}))}return re;case"video":return Rr({key:p,value:u,valueSpec:S.source_video,style:L,validateSpec:G,styleSpec:S});case"image":return Rr({key:p,value:u,valueSpec:S.source_image,style:L,validateSpec:G,styleSpec:S});case"canvas":return[new ve(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ka({key:`${p}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:L,validateSpec:G,styleSpec:S})}}function ei(f){const u=f.value,p=f.styleSpec,S=p.light,L=f.style;let G=[];const Q=Sr(u);if(u===void 0)return G;if(Q!=="object")return G=G.concat([new ve("light",u,`object expected, ${Q} found`)]),G;for(const re in u){const he=re.match(/^(.*)-transition$/);G=G.concat(he&&S[he[1]]&&S[he[1]].transition?f.validateSpec({key:re,value:u[re],valueSpec:p.transition,validateSpec:f.validateSpec,style:L,styleSpec:p}):S[re]?f.validateSpec({key:re,value:u[re],valueSpec:S[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)])}return G}function xi(f){const u=f.value,p=f.styleSpec,S=p.terrain,L=f.style;let G=[];const Q=Sr(u);if(u===void 0)return G;if(Q!=="object")return G=G.concat([new ve("terrain",u,`object expected, ${Q} found`)]),G;for(const re in u)G=G.concat(S[re]?f.validateSpec({key:re,value:u[re],valueSpec:S[re],validateSpec:f.validateSpec,style:L,styleSpec:p}):[new ve(re,u[re],`unknown property "${re}"`)]);return G}function Oi(f){let u=[];const p=f.value,S=f.key;if(Array.isArray(p)){const L=[],G=[];for(const Q in p)p[Q].id&&L.includes(p[Q].id)&&u.push(new ve(S,p,`all the sprites' ids must be unique, but ${p[Q].id} is duplicated`)),L.push(p[Q].id),p[Q].url&&G.includes(p[Q].url)&&u.push(new ve(S,p,`all the sprites' URLs must be unique, but ${p[Q].url} is duplicated`)),G.push(p[Q].url),u=u.concat(Rr({key:`${S}[${Q}]`,value:p[Q],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:f.validateSpec}));return u}return Ni({key:S,value:p})}const Ln={"*":()=>[],array:ha,boolean:function(f){const u=f.value,p=f.key,S=Sr(u);return S!=="boolean"?[new ve(p,u,`boolean expected, ${S} found`)]:[]},number:fo,color:function(f){const u=f.key,p=f.value,S=Sr(p);return S!=="string"?[new ve(u,p,`color expected, ${S} found`)]:Hi.parse(String(p))?[]:[new ve(u,p,`color expected, "${p}" found`)]},constants:$o,enum:ka,filter:Wa,function:ea,layer:mi,object:Rr,source:Ot,light:ei,terrain:xi,string:Ni,formatted:function(f){return Ni(f).length===0?[]:Sa(f)},resolvedImage:function(f){return Ni(f).length===0?[]:Sa(f)},padding:function(f){const u=f.key,p=f.value;if(Sr(p)==="array"){if(p.length<1||p.length>4)return[new ve(u,p,`padding requires 1 to 4 values; ${p.length} values found`)];const S={type:"number"};let L=[];for(let G=0;G<p.length;G++)L=L.concat(f.validateSpec({key:`${u}[${G}]`,value:p[G],validateSpec:f.validateSpec,valueSpec:S}));return L}return fo({key:u,value:p,valueSpec:{}})},variableAnchorOffsetCollection:function(f){const u=f.key,p=f.value,S=Sr(p),L=f.styleSpec;if(S!=="array"||p.length<1||p.length%2!=0)return[new ve(u,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let G=[];for(let Q=0;Q<p.length;Q+=2)G=G.concat(ka({key:`${u}[${Q}]`,value:p[Q],valueSpec:L.layout_symbol["text-anchor"]})),G=G.concat(ha({key:`${u}[${Q+1}]`,value:p[Q+1],valueSpec:{length:2,value:"number"},validateSpec:f.validateSpec,style:f.style,styleSpec:L}));return G},sprite:Oi};function Un(f){const u=f.value,p=f.valueSpec,S=f.styleSpec;return f.validateSpec=Un,p.expression&&Xn(Yr(u))?ea(f):p.expression&&Jr(mr(u))?Sa(f):p.type&&Ln[p.type]?Ln[p.type](f):Rr(Ie({},f,{valueSpec:p.type?S[p.type]:p}))}function or(f){const u=f.value,p=f.key,S=Ni(f);return S.length||(u.indexOf("{fontstack}")===-1&&S.push(new ve(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&S.push(new ve(p,u,'"glyphs" url must include a "{range}" token'))),S}function Yn(f,u=fi){let p=[];return p=p.concat(Un({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,validateSpec:Un,objectElementValidators:{glyphs:or,"*":()=>[]}})),f.constants&&(p=p.concat($o({key:"constants",value:f.constants,style:f,styleSpec:u,validateSpec:Un}))),Ms(p)}function qs(f){return function(u){return f({...u,validateSpec:Un})}}function Ms(f){return[].concat(f).sort((u,p)=>u.line-p.line)}function As(f){return function(...u){return Ms(f.apply(this,u))}}Yn.source=As(qs(Ot)),Yn.sprite=As(qs(Oi)),Yn.glyphs=As(qs(or)),Yn.light=As(qs(ei)),Yn.terrain=As(qs(xi)),Yn.layer=As(qs(mi)),Yn.filter=As(qs(Wa)),Yn.paintProperty=As(qs(gl)),Yn.layoutProperty=As(qs(io));const Xa=Yn,po=Xa.light,rs=Xa.paintProperty,Qu=Xa.layoutProperty;function zu(f,u){let p=!1;if(u&&u.length)for(const S of u)f.fire(new Mn(new Error(S.message))),p=!0;return p}class mo{constructor(u,p,S){const L=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const Q=new Int32Array(this.arrayBuffer);u=Q[0],this.d=(p=Q[1])+2*(S=Q[2]);for(let he=0;he<this.d*this.d;he++){const _e=Q[3+he],Le=Q[3+he+1];L.push(_e===Le?null:Q.subarray(_e,Le))}const re=Q[3+L.length+1];this.keys=Q.subarray(Q[3+L.length],re),this.bboxes=Q.subarray(re),this.insert=this._insertReadonly}else{this.d=p+2*S;for(let Q=0;Q<this.d*this.d;Q++)L.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=S,this.scale=p/u,this.uid=0;const G=S/p*u;this.min=-G,this.max=u+G}insert(u,p,S,L,G){this._forEachCell(p,S,L,G,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(S),this.bboxes.push(L),this.bboxes.push(G)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,p,S,L,G,Q){this.cells[G].push(Q)}query(u,p,S,L,G){const Q=this.min,re=this.max;if(u<=Q&&p<=Q&&re<=S&&re<=L&&!G)return Array.prototype.slice.call(this.keys);{const he=[];return this._forEachCell(u,p,S,L,this._queryCell,he,{},G),he}}_queryCell(u,p,S,L,G,Q,re,he){const _e=this.cells[G];if(_e!==null){const Le=this.keys,qe=this.bboxes;for(let Je=0;Je<_e.length;Je++){const At=_e[Je];if(re[At]===void 0){const gt=4*At;(he?he(qe[gt+0],qe[gt+1],qe[gt+2],qe[gt+3]):u<=qe[gt+2]&&p<=qe[gt+3]&&S>=qe[gt+0]&&L>=qe[gt+1])?(re[At]=!0,Q.push(Le[At])):re[At]=!1}}}}_forEachCell(u,p,S,L,G,Q,re,he){const _e=this._convertToCellCoord(u),Le=this._convertToCellCoord(p),qe=this._convertToCellCoord(S),Je=this._convertToCellCoord(L);for(let At=_e;At<=qe;At++)for(let gt=Le;gt<=Je;gt++){const Mt=this.d*gt+At;if((!he||he(this._convertFromCellCoord(At),this._convertFromCellCoord(gt),this._convertFromCellCoord(At+1),this._convertFromCellCoord(gt+1)))&&G.call(this,u,p,S,L,Mt,Q,re,he))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,p=3+this.cells.length+1+1;let S=0;for(let Q=0;Q<this.cells.length;Q++)S+=this.cells[Q].length;const L=new Int32Array(p+S+this.keys.length+this.bboxes.length);L[0]=this.extent,L[1]=this.n,L[2]=this.padding;let G=p;for(let Q=0;Q<u.length;Q++){const re=u[Q];L[3+Q]=G,L.set(re,G),G+=re.length}return L[3+u.length]=G,L.set(this.keys,G),G+=this.keys.length,L[3+u.length+1]=G,L.set(this.bboxes,G),G+=this.bboxes.length,L.buffer}static serialize(u,p){const S=u.toArrayBuffer();return p&&p.push(S),{buffer:S}}static deserialize(u){return new mo(u.buffer)}}const Ml={};function Pn(f,u,p={}){if(Ml[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),Ml[f]={klass:u,omit:p.omit||[],shallow:p.shallow||[]}}Pn("Object",Object),Pn("TransferableGridIndex",mo),Pn("Color",Hi),Pn("Error",Error),Pn("AJAXError",Ti),Pn("ResolvedImage",ur),Pn("StylePropertyFunction",al),Pn("StyleExpression",Ol,{omit:["_evaluator"]}),Pn("ZoomDependentExpression",Cr),Pn("ZoomConstantExpression",ks),Pn("CompoundExpression",zr,{omit:["_evaluate"]});for(const f in Zo)Zo[f]._classRegistryKey||Pn(`Expression_${f}`,Zo[f]);function Ma(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function bn(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(Ma(f)||Dt(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return u&&u.push(p.buffer),p}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const S of f)p.push(bn(S,u));return p}if(typeof f=="object"){const p=f.constructor,S=p._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");if(!Ml[S])throw new Error(`${S} is not registered.`);const L=p.serialize?p.serialize(f,u):{};if(p.serialize){if(u&&L===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const G in f){if(!f.hasOwnProperty(G)||Ml[S].omit.indexOf(G)>=0)continue;const Q=f[G];L[G]=Ml[S].shallow.indexOf(G)>=0?Q:bn(Q,u)}f instanceof Error&&(L.message=f.message)}if(L.$name)throw new Error("$name property is reserved for worker serialization logic.");return S!=="Object"&&(L.$name=S),L}throw new Error("can't serialize object of type "+typeof f)}function Fo(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||Ma(f)||Dt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(Fo);if(typeof f=="object"){const u=f.$name||"Object";if(!Ml[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:p}=Ml[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(f);const S=Object.create(p.prototype);for(const L of Object.keys(f)){if(L==="$name")continue;const G=f[L];S[L]=Ml[u].shallow.indexOf(L)>=0?G:Fo(G)}return S}throw new Error("can't deserialize object of type "+typeof f)}class Nl{constructor(){this.first=!0}update(u,p){const S=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=S,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=S,!0):(this.lastFloorZoom>S?(this.lastIntegerZoom=S+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<S&&(this.lastIntegerZoom=S,this.lastIntegerZoomTime=p),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=S,!0))}}const Sn={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function Hl(f){for(const u of f)if(lu(u.charCodeAt(0)))return!0;return!1}function In(f){for(const u of f)if(!_l(u.charCodeAt(0)))return!1;return!0}function _l(f){return!(Sn.Arabic(f)||Sn["Arabic Supplement"](f)||Sn["Arabic Extended-A"](f)||Sn["Arabic Presentation Forms-A"](f)||Sn["Arabic Presentation Forms-B"](f))}function lu(f){return!(f!==746&&f!==747&&(f<4352||!(Sn["Bopomofo Extended"](f)||Sn.Bopomofo(f)||Sn["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Sn["CJK Compatibility Ideographs"](f)||Sn["CJK Compatibility"](f)||Sn["CJK Radicals Supplement"](f)||Sn["CJK Strokes"](f)||!(!Sn["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Sn["CJK Unified Ideographs Extension A"](f)||Sn["CJK Unified Ideographs"](f)||Sn["Enclosed CJK Letters and Months"](f)||Sn["Hangul Compatibility Jamo"](f)||Sn["Hangul Jamo Extended-A"](f)||Sn["Hangul Jamo Extended-B"](f)||Sn["Hangul Jamo"](f)||Sn["Hangul Syllables"](f)||Sn.Hiragana(f)||Sn["Ideographic Description Characters"](f)||Sn.Kanbun(f)||Sn["Kangxi Radicals"](f)||Sn["Katakana Phonetic Extensions"](f)||Sn.Katakana(f)&&f!==12540||!(!Sn["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Sn["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Sn["Unified Canadian Aboriginal Syllabics"](f)||Sn["Unified Canadian Aboriginal Syllabics Extended"](f)||Sn["Vertical Forms"](f)||Sn["Yijing Hexagram Symbols"](f)||Sn["Yi Syllables"](f)||Sn["Yi Radicals"](f))))}function Ru(f){return!(lu(f)||function(u){return!!(Sn["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Sn["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Sn["Letterlike Symbols"](u)||Sn["Number Forms"](u)||Sn["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Sn["Control Pictures"](u)&&u!==9251||Sn["Optical Character Recognition"](u)||Sn["Enclosed Alphanumerics"](u)||Sn["Geometric Shapes"](u)||Sn["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Sn["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Sn["CJK Symbols and Punctuation"](u)||Sn.Katakana(u)||Sn["Private Use Area"](u)||Sn["CJK Compatibility Forms"](u)||Sn["Small Form Variants"](u)||Sn["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function Vl(f){return f>=1424&&f<=2303||Sn["Arabic Presentation Forms-A"](f)||Sn["Arabic Presentation Forms-B"](f)}function yl(f,u){return!(!u&&Vl(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Sn.Khmer(f))}function ta(f){for(const u of f)if(Vl(u.charCodeAt(0)))return!0;return!1}const ac="deferred",Wu="loading",jl="loaded";let fs=null,_a="unavailable",Ko=null;const gu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(_a="error"),fs&&fs(f)};function Fu(){uu.fire(new ti("pluginStateChange",{pluginStatus:_a,pluginURL:Ko}))}const uu=new ns,Ou=function(){return _a},_r=function(){if(_a!==ac||!Ko)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_a=Wu,Fu(),Ko&&fn({url:Ko},f=>{f?gu(f):(_a=jl,Fu())})},ds={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_a===jl||ds.applyArabicShaping!=null,isLoading:()=>_a===Wu,setState(f){if(!Nt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");_a=f.pluginStatus,Ko=f.pluginURL},isParsed(){if(!Nt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ds.applyArabicShaping!=null&&ds.processBidirectionalText!=null&&ds.processStyledBidirectionalText!=null},getPluginURL(){if(!Nt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ko}};class pn{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Nl,this.transition={})}isSupportedScript(u){return function(p,S){for(const L of p)if(!yl(L.charCodeAt(0),S))return!1;return!0}(u,ds.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,p=u-Math.floor(u),S=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*S}:{fromScale:.5,toScale:1,t:1-(1-S)*p}}}class Gn{constructor(u,p){this.property=u,this.value=p,this.expression=function(S,L){if(Xn(S))return new al(S,L);if(Jr(S)){const G=nr(S,L);if(G.result==="error")throw new Error(G.value.map(Q=>`${Q.key}: ${Q.message}`).join(", "));return G.value}{let G=S;return L.type==="color"&&typeof S=="string"?G=Hi.parse(S):L.type!=="padding"||typeof S!="number"&&!Array.isArray(S)?L.type==="variableAnchorOffsetCollection"&&Array.isArray(S)&&(G=En.parse(S)):G=Yi.parse(S),{kind:"constant",evaluate:()=>G}}}(p===void 0?u.specification.default:p,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,S){return this.property.possiblyEvaluate(this,u,p,S)}}class Jn{constructor(u){this.property=u,this.value=new Gn(u,void 0)}transitioned(u,p){return new Cu(this.property,this.value,p,it({},u.transition,this.transition),u.now)}untransitioned(){return new Cu(this.property,this.value,null,{},0)}}class Jo{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return bt(this._values[u].value.value)}setValue(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].value=new Gn(this._values[u].property,p===null?void 0:bt(p))}getTransition(u){return bt(this._values[u].transition)}setTransition(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Jn(this._values[u].property)),this._values[u].transition=bt(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const S=this.getValue(p);S!==void 0&&(u[p]=S);const L=this.getTransition(p);L!==void 0&&(u[`${p}-transition`]=L)}return u}transitioned(u,p){const S=new oa(this._properties);for(const L of Object.keys(this._values))S._values[L]=this._values[L].transitioned(u,p._values[L]);return S}untransitioned(){const u=new oa(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class Cu{constructor(u,p,S,L,G){this.property=u,this.value=p,this.begin=G+L.delay||0,this.end=this.begin+L.duration||0,u.specification.transition&&(L.delay||L.duration)&&(this.prior=S)}possiblyEvaluate(u,p,S){const L=u.now||0,G=this.value.possiblyEvaluate(u,p,S),Q=this.prior;if(Q){if(L>this.end)return this.prior=null,G;if(this.value.isDataDriven())return this.prior=null,G;if(L<this.begin)return Q.possiblyEvaluate(u,p,S);{const re=(L-this.begin)/(this.end-this.begin);return this.property.interpolate(Q.possiblyEvaluate(u,p,S),G,function(he){if(he<=0)return 0;if(he>=1)return 1;const _e=he*he,Le=_e*he;return 4*(he<.5?Le:3*(he-_e)+Le-.75)}(re))}}return G}}class oa{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,S){const L=new Co(this._properties);for(const G of Object.keys(this._values))L._values[G]=this._values[G].possiblyEvaluate(u,p,S);return L}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class _u{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}hasValue(u){return this._values[u].value!==void 0}getValue(u){return bt(this._values[u].value)}setValue(u,p){this._values[u]=new Gn(this._values[u].property,p===null?void 0:bt(p))}serialize(){const u={};for(const p of Object.keys(this._values)){const S=this.getValue(p);S!==void 0&&(u[p]=S)}return u}possiblyEvaluate(u,p,S){const L=new Co(this._properties);for(const G of Object.keys(this._values))L._values[G]=this._values[G].possiblyEvaluate(u,p,S);return L}}class _s{constructor(u,p,S){this.property=u,this.value=p,this.parameters=S}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,S,L){return this.property.evaluate(this.value,this.parameters,u,p,S,L)}}class Co{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Mi{constructor(u){this.specification=u}possiblyEvaluate(u,p){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(p)}interpolate(u,p,S){const L=js[this.specification.type];return L?L(u,p,S):u}}class zi{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,S,L){return new _s(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},S,L)}:u.expression,p)}interpolate(u,p,S){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new _s(this,{kind:"constant",value:void 0},u.parameters);const L=js[this.specification.type];if(L){const G=L(u.value.value,p.value.value,S);return new _s(this,{kind:"constant",value:G},u.parameters)}return u}evaluate(u,p,S,L,G,Q){return u.kind==="constant"?u.value:u.evaluate(p,S,L,G,Q)}}class ys extends zi{possiblyEvaluate(u,p,S,L){if(u.value===void 0)return new _s(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){const G=u.expression.evaluate(p,null,{},S,L),Q=u.property.specification.type==="resolvedImage"&&typeof G!="string"?G.name:G,re=this._calculate(Q,Q,Q,p);return new _s(this,{kind:"constant",value:re},p)}if(u.expression.kind==="camera"){const G=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new _s(this,{kind:"constant",value:G},p)}return new _s(this,u.expression,p)}evaluate(u,p,S,L,G,Q){if(u.kind==="source"){const re=u.evaluate(p,S,L,G,Q);return this._calculate(re,re,re,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},S,L),u.evaluate({zoom:Math.floor(p.zoom)},S,L),u.evaluate({zoom:Math.floor(p.zoom)+1},S,L),p):u.value}_calculate(u,p,S,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:S,to:p}}interpolate(u){return u}}class yu{constructor(u){this.specification=u}possiblyEvaluate(u,p,S,L){if(u.value!==void 0){if(u.expression.kind==="constant"){const G=u.expression.evaluate(p,null,{},S,L);return this._calculate(G,G,G,p)}return this._calculate(u.expression.evaluate(new pn(Math.floor(p.zoom-1),p)),u.expression.evaluate(new pn(Math.floor(p.zoom),p)),u.expression.evaluate(new pn(Math.floor(p.zoom+1),p)),p)}}_calculate(u,p,S,L){return L.zoom>L.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:S,to:p}}interpolate(u){return u}}class Oo{constructor(u){this.specification=u}possiblyEvaluate(u,p,S,L){return!!u.expression.evaluate(p,null,{},S,L)}interpolate(){return!1}}class cs{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in u){const S=u[p];S.specification.overridable&&this.overridableProperties.push(p);const L=this.defaultPropertyValues[p]=new Gn(S,void 0),G=this.defaultTransitionablePropertyValues[p]=new Jn(S);this.defaultTransitioningPropertyValues[p]=G.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=L.possiblyEvaluate({})}}}Pn("DataDrivenProperty",zi),Pn("DataConstantProperty",Mi),Pn("CrossFadedDataDrivenProperty",ys),Pn("CrossFadedProperty",yu),Pn("ColorRampProperty",Oo);const ul="-transition";class Ps extends ns{constructor(u,p){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new _u(p.layout)),p.paint)){this._transitionablePaint=new Jo(p.paint);for(const S in u.paint)this.setPaintProperty(S,u.paint[S],{validate:!1});for(const S in u.layout)this.setLayoutProperty(S,u.layout[S],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Co(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p,S={}){p!=null&&this._validate(Qu,`layers.${this.id}.layout.${u}`,u,p,S)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)}getPaintProperty(u){return u.endsWith(ul)?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p,S={}){if(p!=null&&this._validate(rs,`layers.${this.id}.paint.${u}`,u,p,S))return!1;if(u.endsWith(ul))return this._transitionablePaint.setTransition(u.slice(0,-11),p||void 0),!1;{const L=this._transitionablePaint._values[u],G=L.property.specification["property-type"]==="cross-faded-data-driven",Q=L.value.isDataDriven(),re=L.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);const he=this._transitionablePaint._values[u].value;return he.isDataDriven()||Q||G||this._handleOverridablePaintPropertyUpdate(u,re,he)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,p,S){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),mt(u,(p,S)=>!(p===void 0||S==="layout"&&!Object.keys(p).length||S==="paint"&&!Object.keys(p).length))}_validate(u,p,S,L,G={}){return(!G||G.validate!==!1)&&zu(this,u.call(Xa,{key:p,layerType:this.type,objectKey:S,value:L,styleSpec:fi,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof _s&&ja(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const C={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class D{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class z{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function R(f,u=1){let p=0,S=0;return{members:f.map(L=>{const G=C[L.type].BYTES_PER_ELEMENT,Q=p=ee(p,Math.max(u,G)),re=L.components||1;return S=Math.max(S,G),p+=G*re,{name:L.name,type:L.type,components:re,offset:Q}}),size:ee(p,Math.max(S,u)),alignment:u}}function ee(f,u){return Math.ceil(f/u)*u}class le extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const S=this.length;return this.resize(S+1),this.emplace(S,u,p)}emplace(u,p,S){const L=2*u;return this.int16[L+0]=p,this.int16[L+1]=S,u}}le.prototype.bytesPerElement=4,Pn("StructArrayLayout2i4",le);class ae extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const G=3*u;return this.int16[G+0]=p,this.int16[G+1]=S,this.int16[G+2]=L,u}}ae.prototype.bytesPerElement=6,Pn("StructArrayLayout3i6",ae);class be extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,S,L)}emplace(u,p,S,L,G){const Q=4*u;return this.int16[Q+0]=p,this.int16[Q+1]=S,this.int16[Q+2]=L,this.int16[Q+3]=G,u}}be.prototype.bytesPerElement=8,Pn("StructArrayLayout4i8",be);class We extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,S,L,G,Q)}emplace(u,p,S,L,G,Q,re){const he=6*u;return this.int16[he+0]=p,this.int16[he+1]=S,this.int16[he+2]=L,this.int16[he+3]=G,this.int16[he+4]=Q,this.int16[he+5]=re,u}}We.prototype.bytesPerElement=12,Pn("StructArrayLayout2i4i12",We);class yt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,S,L,G,Q)}emplace(u,p,S,L,G,Q,re){const he=4*u,_e=8*u;return this.int16[he+0]=p,this.int16[he+1]=S,this.uint8[_e+4]=L,this.uint8[_e+5]=G,this.uint8[_e+6]=Q,this.uint8[_e+7]=re,u}}yt.prototype.bytesPerElement=8,Pn("StructArrayLayout2i4ub8",yt);class Ct extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const S=this.length;return this.resize(S+1),this.emplace(S,u,p)}emplace(u,p,S){const L=2*u;return this.float32[L+0]=p,this.float32[L+1]=S,u}}Ct.prototype.bytesPerElement=8,Pn("StructArrayLayout2f8",Ct);class ii extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q,re,he,_e,Le){const qe=this.length;return this.resize(qe+1),this.emplace(qe,u,p,S,L,G,Q,re,he,_e,Le)}emplace(u,p,S,L,G,Q,re,he,_e,Le,qe){const Je=10*u;return this.uint16[Je+0]=p,this.uint16[Je+1]=S,this.uint16[Je+2]=L,this.uint16[Je+3]=G,this.uint16[Je+4]=Q,this.uint16[Je+5]=re,this.uint16[Je+6]=he,this.uint16[Je+7]=_e,this.uint16[Je+8]=Le,this.uint16[Je+9]=qe,u}}ii.prototype.bytesPerElement=20,Pn("StructArrayLayout10ui20",ii);class Gt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q,re,he,_e,Le,qe,Je){const At=this.length;return this.resize(At+1),this.emplace(At,u,p,S,L,G,Q,re,he,_e,Le,qe,Je)}emplace(u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At){const gt=12*u;return this.int16[gt+0]=p,this.int16[gt+1]=S,this.int16[gt+2]=L,this.int16[gt+3]=G,this.uint16[gt+4]=Q,this.uint16[gt+5]=re,this.uint16[gt+6]=he,this.uint16[gt+7]=_e,this.int16[gt+8]=Le,this.int16[gt+9]=qe,this.int16[gt+10]=Je,this.int16[gt+11]=At,u}}Gt.prototype.bytesPerElement=24,Pn("StructArrayLayout4i4ui4i24",Gt);class jt extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const G=3*u;return this.float32[G+0]=p,this.float32[G+1]=S,this.float32[G+2]=L,u}}jt.prototype.bytesPerElement=12,Pn("StructArrayLayout3f12",jt);class Z extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}Z.prototype.bytesPerElement=4,Pn("StructArrayLayout1ul4",Z);class A extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q,re,he,_e){const Le=this.length;return this.resize(Le+1),this.emplace(Le,u,p,S,L,G,Q,re,he,_e)}emplace(u,p,S,L,G,Q,re,he,_e,Le){const qe=10*u,Je=5*u;return this.int16[qe+0]=p,this.int16[qe+1]=S,this.int16[qe+2]=L,this.int16[qe+3]=G,this.int16[qe+4]=Q,this.int16[qe+5]=re,this.uint32[Je+3]=he,this.uint16[qe+8]=_e,this.uint16[qe+9]=Le,u}}A.prototype.bytesPerElement=20,Pn("StructArrayLayout6i1ul2ui20",A);class I extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q){const re=this.length;return this.resize(re+1),this.emplace(re,u,p,S,L,G,Q)}emplace(u,p,S,L,G,Q,re){const he=6*u;return this.int16[he+0]=p,this.int16[he+1]=S,this.int16[he+2]=L,this.int16[he+3]=G,this.int16[he+4]=Q,this.int16[he+5]=re,u}}I.prototype.bytesPerElement=12,Pn("StructArrayLayout2i2i2i12",I);class F extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G){const Q=this.length;return this.resize(Q+1),this.emplace(Q,u,p,S,L,G)}emplace(u,p,S,L,G,Q){const re=4*u,he=8*u;return this.float32[re+0]=p,this.float32[re+1]=S,this.float32[re+2]=L,this.int16[he+6]=G,this.int16[he+7]=Q,u}}F.prototype.bytesPerElement=16,Pn("StructArrayLayout2f1f2i16",F);class O extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,S,L)}emplace(u,p,S,L,G){const Q=12*u,re=3*u;return this.uint8[Q+0]=p,this.uint8[Q+1]=S,this.float32[re+1]=L,this.float32[re+2]=G,u}}O.prototype.bytesPerElement=12,Pn("StructArrayLayout2ub2f12",O);class y extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const G=3*u;return this.uint16[G+0]=p,this.uint16[G+1]=S,this.uint16[G+2]=L,u}}y.prototype.bytesPerElement=6,Pn("StructArrayLayout3ui6",y);class s extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt){const $t=this.length;return this.resize($t+1),this.emplace($t,u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt)}emplace(u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t){const Ht=24*u,Zt=12*u,ui=48*u;return this.int16[Ht+0]=p,this.int16[Ht+1]=S,this.uint16[Ht+2]=L,this.uint16[Ht+3]=G,this.uint32[Zt+2]=Q,this.uint32[Zt+3]=re,this.uint32[Zt+4]=he,this.uint16[Ht+10]=_e,this.uint16[Ht+11]=Le,this.uint16[Ht+12]=qe,this.float32[Zt+7]=Je,this.float32[Zt+8]=At,this.uint8[ui+36]=gt,this.uint8[ui+37]=Mt,this.uint8[ui+38]=Pt,this.uint32[Zt+10]=zt,this.int16[Ht+22]=$t,u}}s.prototype.bytesPerElement=48,Pn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",s);class i extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t,Ht,Zt,ui,_i,Xi,xn,nn,tn,hn,zn){const en=this.length;return this.resize(en+1),this.emplace(en,u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t,Ht,Zt,ui,_i,Xi,xn,nn,tn,hn,zn)}emplace(u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt,Pt,zt,$t,Ht,Zt,ui,_i,Xi,xn,nn,tn,hn,zn,en){const Wi=32*u,Dn=16*u;return this.int16[Wi+0]=p,this.int16[Wi+1]=S,this.int16[Wi+2]=L,this.int16[Wi+3]=G,this.int16[Wi+4]=Q,this.int16[Wi+5]=re,this.int16[Wi+6]=he,this.int16[Wi+7]=_e,this.uint16[Wi+8]=Le,this.uint16[Wi+9]=qe,this.uint16[Wi+10]=Je,this.uint16[Wi+11]=At,this.uint16[Wi+12]=gt,this.uint16[Wi+13]=Mt,this.uint16[Wi+14]=Pt,this.uint16[Wi+15]=zt,this.uint16[Wi+16]=$t,this.uint16[Wi+17]=Ht,this.uint16[Wi+18]=Zt,this.uint16[Wi+19]=ui,this.uint16[Wi+20]=_i,this.uint16[Wi+21]=Xi,this.uint16[Wi+22]=xn,this.uint32[Dn+12]=nn,this.float32[Dn+13]=tn,this.float32[Dn+14]=hn,this.uint16[Wi+30]=zn,this.uint16[Wi+31]=en,u}}i.prototype.bytesPerElement=64,Pn("StructArrayLayout8i15ui1ul2f2ui64",i);class r extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}r.prototype.bytesPerElement=4,Pn("StructArrayLayout1f4",r);class l extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const G=3*u;return this.uint16[6*u+0]=p,this.float32[G+1]=S,this.float32[G+2]=L,u}}l.prototype.bytesPerElement=12,Pn("StructArrayLayout1ui2f12",l);class d extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,S){const L=this.length;return this.resize(L+1),this.emplace(L,u,p,S)}emplace(u,p,S,L){const G=4*u;return this.uint32[2*u+0]=p,this.uint16[G+2]=S,this.uint16[G+3]=L,u}}d.prototype.bytesPerElement=8,Pn("StructArrayLayout1ul2ui8",d);class _ extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const S=this.length;return this.resize(S+1),this.emplace(S,u,p)}emplace(u,p,S){const L=2*u;return this.uint16[L+0]=p,this.uint16[L+1]=S,u}}_.prototype.bytesPerElement=4,Pn("StructArrayLayout2ui4",_);class w extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}w.prototype.bytesPerElement=2,Pn("StructArrayLayout1ui2",w);class T extends z{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,S,L){const G=this.length;return this.resize(G+1),this.emplace(G,u,p,S,L)}emplace(u,p,S,L,G){const Q=4*u;return this.float32[Q+0]=p,this.float32[Q+1]=S,this.float32[Q+2]=L,this.float32[Q+3]=G,u}}T.prototype.bytesPerElement=16,Pn("StructArrayLayout4f16",T);class B extends D{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new fe(this.anchorPointX,this.anchorPointY)}}B.prototype.size=20;class j extends A{get(u){return new B(this,u)}}Pn("CollisionBoxArray",j);class Y extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Y.prototype.size=48;class ue extends s{get(u){return new Y(this,u)}}Pn("PlacedSymbolArray",ue);class Se extends D{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Se.prototype.size=64;class Te extends i{get(u){return new Se(this,u)}}Pn("SymbolInstanceArray",Te);class Re extends r{getoffsetX(u){return this.float32[1*u+0]}}Pn("GlyphOffsetArray",Re);class Be extends ae{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Pn("SymbolLineVertexArray",Be);class $e extends D{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}$e.prototype.size=12;class vt extends l{get(u){return new $e(this,u)}}Pn("TextAnchorOffsetArray",vt);class ot extends D{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ot.prototype.size=8;class ct extends d{get(u){return new ot(this,u)}}Pn("FeatureIndexArray",ct);class Et extends le{}class wt extends le{}class ri extends le{}class Xt extends We{}class Jt extends yt{}class si extends Ct{}class ji extends ii{}class Zi extends Gt{}class Ii extends jt{}class Vi extends Z{}class Ui extends I{}class an extends O{}class Bn extends y{}class Ji extends _{}const Cn=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:yr}=Cn;class er{constructor(u=[]){this.segments=u}prepareSegment(u,p,S,L){let G=this.segments[this.segments.length-1];return u>er.MAX_VERTEX_ARRAY_LENGTH&&nt(`Max vertices per segment is ${er.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!G||G.vertexLength+u>er.MAX_VERTEX_ARRAY_LENGTH||G.sortKey!==L)&&(G={vertexOffset:p.length,primitiveOffset:S.length,vertexLength:0,primitiveLength:0},L!==void 0&&(G.sortKey=L),this.segments.push(G)),G}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,S,L){return new er([{vertexOffset:u,primitiveOffset:p,vertexLength:S,primitiveLength:L,vaos:{},sortKey:0}])}}function Ia(f,u){return 256*(f=Ge(Math.floor(f),0,255))+Ge(Math.floor(u),0,255)}er.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pn("SegmentVector",er);const Aa=R([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Bs={exports:{}},no={exports:{}};no.exports=function(f,u){var p,S,L,G,Q,re,he,_e;for(S=f.length-(p=3&f.length),L=u,Q=3432918353,re=461845907,_e=0;_e<S;)he=255&f.charCodeAt(_e)|(255&f.charCodeAt(++_e))<<8|(255&f.charCodeAt(++_e))<<16|(255&f.charCodeAt(++_e))<<24,++_e,L=27492+(65535&(G=5*(65535&(L=(L^=he=(65535&(he=(he=(65535&he)*Q+(((he>>>16)*Q&65535)<<16)&4294967295)<<15|he>>>17))*re+(((he>>>16)*re&65535)<<16)&4294967295)<<13|L>>>19))+((5*(L>>>16)&65535)<<16)&4294967295))+((58964+(G>>>16)&65535)<<16);switch(he=0,p){case 3:he^=(255&f.charCodeAt(_e+2))<<16;case 2:he^=(255&f.charCodeAt(_e+1))<<8;case 1:L^=he=(65535&(he=(he=(65535&(he^=255&f.charCodeAt(_e)))*Q+(((he>>>16)*Q&65535)<<16)&4294967295)<<15|he>>>17))*re+(((he>>>16)*re&65535)<<16)&4294967295}return L^=f.length,L=2246822507*(65535&(L^=L>>>16))+((2246822507*(L>>>16)&65535)<<16)&4294967295,L=3266489909*(65535&(L^=L>>>13))+((3266489909*(L>>>16)&65535)<<16)&4294967295,(L^=L>>>16)>>>0};var ro=no.exports,Gr={exports:{}};Gr.exports=function(f,u){for(var p,S=f.length,L=u^S,G=0;S>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(G)|(255&f.charCodeAt(++G))<<8|(255&f.charCodeAt(++G))<<16|(255&f.charCodeAt(++G))<<24))+((1540483477*(p>>>16)&65535)<<16),L=1540483477*(65535&L)+((1540483477*(L>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),S-=4,++G;switch(S){case 3:L^=(255&f.charCodeAt(G+2))<<16;case 2:L^=(255&f.charCodeAt(G+1))<<8;case 1:L=1540483477*(65535&(L^=255&f.charCodeAt(G)))+((1540483477*(L>>>16)&65535)<<16)}return L=1540483477*(65535&(L^=L>>>13))+((1540483477*(L>>>16)&65535)<<16),(L^=L>>>15)>>>0};var ya=ro,go=Gr.exports;Bs.exports=ya,Bs.exports.murmur3=ya,Bs.exports.murmur2=go;var _o=W(Bs.exports);class Zs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,p,S,L){this.ids.push(es(u)),this.positions.push(p,S,L)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=es(u);let S=0,L=this.ids.length-1;for(;S<L;){const Q=S+L>>1;this.ids[Q]>=p?L=Q:S=Q+1}const G=[];for(;this.ids[S]===p;)G.push({index:this.positions[3*S],start:this.positions[3*S+1],end:this.positions[3*S+2]}),S++;return G}static serialize(u,p){const S=new Float64Array(u.ids),L=new Uint32Array(u.positions);return ts(S,L,0,S.length-1),p&&p.push(S.buffer,L.buffer),{ids:S,positions:L}}static deserialize(u){const p=new Zs;return p.ids=u.ids,p.positions=u.positions,p.indexed=!0,p}}function es(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:_o(String(f))}function ts(f,u,p,S){for(;p<S;){const L=f[p+S>>1];let G=p-1,Q=S+1;for(;;){do G++;while(f[G]<L);do Q--;while(f[Q]>L);if(G>=Q)break;Lr(f,G,Q),Lr(u,3*G,3*Q),Lr(u,3*G+1,3*Q+1),Lr(u,3*G+2,3*Q+2)}Q-p<S-Q?(ts(f,u,p,Q),p=Q+1):(ts(f,u,Q+1,S),S=Q)}}function Lr(f,u,p){const S=f[u];f[u]=f[p],f[p]=S}Pn("FeaturePositionMap",Zs);class vs{constructor(u,p){this.gl=u.gl,this.location=p}}class Qs extends vs{constructor(u,p){super(u,p),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class To extends vs{constructor(u,p){super(u,p),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class No extends vs{constructor(u,p){super(u,p),this.current=Hi.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const Vo=new Float32Array(16);function Sc(f){return[Ia(255*f.r,255*f.g),Ia(255*f.b,255*f.a)]}class Ws{constructor(u,p,S){this.value=u,this.uniformNames=p.map(L=>`u_${L}`),this.type=S}setUniform(u,p,S){u.set(S.constantOr(this.value))}getBinding(u,p,S){return this.type==="color"?new No(u,p):new Qs(u,p)}}class Zl{constructor(u,p){this.uniformNames=p.map(S=>`u_${S}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=u.tlbr}setUniform(u,p,S,L){const G=L==="u_pattern_to"?this.patternTo:L==="u_pattern_from"?this.patternFrom:L==="u_pixel_ratio_to"?this.pixelRatioTo:L==="u_pixel_ratio_from"?this.pixelRatioFrom:null;G&&u.set(G)}getBinding(u,p,S){return S.substr(0,9)==="u_pattern"?new To(u,p):new Qs(u,p)}}class cu{constructor(u,p,S,L){this.expression=u,this.type=S,this.maxValue=0,this.paintVertexAttributes=p.map(G=>({name:`a_${G}`,type:"Float32",components:S==="color"?2:1,offset:0})),this.paintVertexArray=new L}populatePaintArray(u,p,S,L,G){const Q=this.paintVertexArray.length,re=this.expression.evaluate(new pn(0),p,{},L,[],G);this.paintVertexArray.resize(u),this._setPaintValue(Q,u,re)}updatePaintArray(u,p,S,L){const G=this.expression.evaluate({zoom:0},S,L);this._setPaintValue(u,p,G)}_setPaintValue(u,p,S){if(this.type==="color"){const L=Sc(S);for(let G=u;G<p;G++)this.paintVertexArray.emplace(G,L[0],L[1])}else{for(let L=u;L<p;L++)this.paintVertexArray.emplace(L,S);this.maxValue=Math.max(this.maxValue,Math.abs(S))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class el{constructor(u,p,S,L,G,Q){this.expression=u,this.uniformNames=p.map(re=>`u_${re}_t`),this.type=S,this.useIntegerZoom=L,this.zoom=G,this.maxValue=0,this.paintVertexAttributes=p.map(re=>({name:`a_${re}`,type:"Float32",components:S==="color"?4:2,offset:0})),this.paintVertexArray=new Q}populatePaintArray(u,p,S,L,G){const Q=this.expression.evaluate(new pn(this.zoom),p,{},L,[],G),re=this.expression.evaluate(new pn(this.zoom+1),p,{},L,[],G),he=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(he,u,Q,re)}updatePaintArray(u,p,S,L){const G=this.expression.evaluate({zoom:this.zoom},S,L),Q=this.expression.evaluate({zoom:this.zoom+1},S,L);this._setPaintValue(u,p,G,Q)}_setPaintValue(u,p,S,L){if(this.type==="color"){const G=Sc(S),Q=Sc(L);for(let re=u;re<p;re++)this.paintVertexArray.emplace(re,G[0],G[1],Q[0],Q[1])}else{for(let G=u;G<p;G++)this.paintVertexArray.emplace(G,S,L);this.maxValue=Math.max(this.maxValue,Math.abs(S),Math.abs(L))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p){const S=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,L=Ge(this.expression.interpolationFactor(S,this.zoom,this.zoom+1),0,1);u.set(L)}getBinding(u,p,S){return new Qs(u,p)}}class vl{constructor(u,p,S,L,G,Q){this.expression=u,this.type=p,this.useIntegerZoom=S,this.zoom=L,this.layerId=Q,this.zoomInPaintVertexArray=new G,this.zoomOutPaintVertexArray=new G}populatePaintArray(u,p,S){const L=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(L,u,p.patterns&&p.patterns[this.layerId],S)}updatePaintArray(u,p,S,L,G){this._setPaintValues(u,p,S.patterns&&S.patterns[this.layerId],G)}_setPaintValues(u,p,S,L){if(!L||!S)return;const{min:G,mid:Q,max:re}=S,he=L[G],_e=L[Q],Le=L[re];if(he&&_e&&Le)for(let qe=u;qe<p;qe++)this.zoomInPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],he.tl[0],he.tl[1],he.br[0],he.br[1],_e.pixelRatio,he.pixelRatio),this.zoomOutPaintVertexArray.emplace(qe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Le.tl[0],Le.tl[1],Le.br[0],Le.br[1],_e.pixelRatio,Le.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Aa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Aa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pl{constructor(u,p,S){this.binders={},this._buffers=[];const L=[];for(const G in u.paint._values){if(!S(G))continue;const Q=u.paint.get(G);if(!(Q instanceof _s&&ja(Q.property.specification)))continue;const re=sf(G,u.type),he=Q.value,_e=Q.property.specification.type,Le=Q.property.useIntegerZoom,qe=Q.property.specification["property-type"],Je=qe==="cross-faded"||qe==="cross-faded-data-driven";if(he.kind==="constant")this.binders[G]=Je?new Zl(he.value,re):new Ws(he.value,re,_e),L.push(`/u_${G}`);else if(he.kind==="source"||Je){const At=Nh(G,_e,"source");this.binders[G]=Je?new vl(he,_e,Le,p,At,u.id):new cu(he,re,_e,At),L.push(`/a_${G}`)}else{const At=Nh(G,_e,"composite");this.binders[G]=new el(he,re,_e,Le,p,At),L.push(`/z_${G}`)}}this.cacheKey=L.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof cu||p instanceof el?p.maxValue:0}populatePaintArrays(u,p,S,L,G){for(const Q in this.binders){const re=this.binders[Q];(re instanceof cu||re instanceof el||re instanceof vl)&&re.populatePaintArray(u,p,S,L,G)}}setConstantPatternPositions(u,p){for(const S in this.binders){const L=this.binders[S];L instanceof Zl&&L.setConstantPatternPositions(u,p)}}updatePaintArrays(u,p,S,L,G){let Q=!1;for(const re in u){const he=p.getPositions(re);for(const _e of he){const Le=S.feature(_e.index);for(const qe in this.binders){const Je=this.binders[qe];if((Je instanceof cu||Je instanceof el||Je instanceof vl)&&Je.expression.isStateDependent===!0){const At=L.paint.get(qe);Je.expression=At.value,Je.updatePaintArray(_e.start,_e.end,Le,u[re],G),Q=!0}}}}return Q}defines(){const u=[];for(const p in this.binders){const S=this.binders[p];(S instanceof Ws||S instanceof Zl)&&u.push(...S.uniformNames.map(L=>`#define HAS_UNIFORM_${L}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const S=this.binders[p];if(S instanceof cu||S instanceof el)for(let L=0;L<S.paintVertexAttributes.length;L++)u.push(S.paintVertexAttributes[L].name);else if(S instanceof vl)for(let L=0;L<Aa.members.length;L++)u.push(Aa.members[L].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const S=this.binders[p];if(S instanceof Ws||S instanceof Zl||S instanceof el)for(const L of S.uniformNames)u.push(L)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,p){const S=[];for(const L in this.binders){const G=this.binders[L];if(G instanceof Ws||G instanceof Zl||G instanceof el){for(const Q of G.uniformNames)if(p[Q]){const re=G.getBinding(u,p[Q],Q);S.push({name:Q,property:L,binding:re})}}}return S}setUniforms(u,p,S,L){for(const{name:G,property:Q,binding:re}of p)this.binders[Q].setUniform(re,L,S.get(Q),G)}updatePaintBuffers(u){this._buffers=[];for(const p in this.binders){const S=this.binders[p];if(u&&S instanceof vl){const L=u.fromScale===2?S.zoomInPaintVertexBuffer:S.zoomOutPaintVertexBuffer;L&&this._buffers.push(L)}else(S instanceof cu||S instanceof el)&&S.paintVertexBuffer&&this._buffers.push(S.paintVertexBuffer)}}upload(u){for(const p in this.binders){const S=this.binders[p];(S instanceof cu||S instanceof el||S instanceof vl)&&S.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof cu||p instanceof el||p instanceof vl)&&p.destroy()}}}class hu{constructor(u,p,S=()=>!0){this.programConfigurations={};for(const L of u)this.programConfigurations[L.id]=new Pl(L,p,S);this.needsUpload=!1,this._featureMap=new Zs,this._bufferOffset=0}populatePaintArrays(u,p,S,L,G,Q){for(const re in this.programConfigurations)this.programConfigurations[re].populatePaintArrays(u,p,L,G,Q);p.id!==void 0&&this._featureMap.add(p.id,S,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,S,L){for(const G of S)this.needsUpload=this.programConfigurations[G.id].updatePaintArrays(u,this._featureMap,p,G,L)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function sf(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function Nh(f,u,p){const S={color:{source:Ct,composite:T},number:{source:r,composite:Ct}},L=function(G){return{"line-pattern":{source:ji,composite:ji},"fill-pattern":{source:ji,composite:ji},"fill-extrusion-pattern":{source:ji,composite:ji}}[G]}(f);return L&&L[p]||S[u][p]}Pn("ConstantBinder",Ws),Pn("CrossFadedConstantBinder",Zl),Pn("SourceExpressionBinder",cu),Pn("CrossFadedCompositeBinder",vl),Pn("CompositeExpressionBinder",el),Pn("ProgramConfiguration",Pl,{omit:["_buffers"]}),Pn("ProgramConfigurationSet",hu);const Pa=8192,dA=Math.pow(2,14)-1,_h=-dA-1;function Vh(f){const u=Pa/f.extent,p=f.loadGeometry();for(let S=0;S<p.length;S++){const L=p[S];for(let G=0;G<L.length;G++){const Q=L[G],re=Math.round(Q.x*u),he=Math.round(Q.y*u);Q.x=Ge(re,_h,dA),Q.y=Ge(he,_h,dA),(re<Q.x||re>Q.x+1||he<Q.y||he>Q.y+1)&&nt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function Ic(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Vh(f):[]}}function Uh(f,u,p,S,L){f.emplaceBack(2*u+(S+1)/2,2*p+(L+1)/2)}class o0{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new wt,this.indexArray=new Bn,this.segments=new er,this.programConfigurations=new hu(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){const L=this.layers[0],G=[];let Q=null,re=!1;L.type==="circle"&&(Q=L.layout.get("circle-sort-key"),re=!Q.isConstant());for(const{feature:he,id:_e,index:Le,sourceLayerIndex:qe}of u){const Je=this.layers[0]._featureFilter.needGeometry,At=Ic(he,Je);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),At,S))continue;const gt=re?Q.evaluate(At,{},S):void 0,Mt={id:_e,properties:he.properties,type:he.type,sourceLayerIndex:qe,index:Le,geometry:Je?At.geometry:Vh(he),patterns:{},sortKey:gt};G.push(Mt)}re&&G.sort((he,_e)=>he.sortKey-_e.sortKey);for(const he of G){const{geometry:_e,index:Le,sourceLayerIndex:qe}=he,Je=u[Le].feature;this.addFeature(he,_e,Le,S),p.featureIndex.insert(Je,_e,Le,qe,this.index)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,yr),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,S,L){for(const G of p)for(const Q of G){const re=Q.x,he=Q.y;if(re<0||re>=Pa||he<0||he>=Pa)continue;const _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Le=_e.vertexLength;Uh(this.layoutVertexArray,re,he,-1,-1),Uh(this.layoutVertexArray,re,he,1,-1),Uh(this.layoutVertexArray,re,he,1,1),Uh(this.layoutVertexArray,re,he,-1,1),this.indexArray.emplaceBack(Le,Le+1,Le+2),this.indexArray.emplaceBack(Le,Le+3,Le+2),_e.vertexLength+=4,_e.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,{},L)}}function Xc(f,u){for(let p=0;p<f.length;p++)if(Xu(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Xu(f,u[p]))return!0;return!!Yc(f,u)}function gp(f,u,p){return!!Xu(f,u)||!!of(u,f,p)}function Gh(f,u){if(f.length===1)return Ql(u,f[0]);for(let p=0;p<u.length;p++){const S=u[p];for(let L=0;L<S.length;L++)if(Xu(f,S[L]))return!0}for(let p=0;p<f.length;p++)if(Ql(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Yc(f,u[p]))return!0;return!1}function af(f,u,p){if(f.length>1){if(Yc(f,u))return!0;for(let S=0;S<u.length;S++)if(of(u[S],f,p))return!0}for(let S=0;S<f.length;S++)if(of(f[S],u,p))return!0;return!1}function Yc(f,u){if(f.length===0||u.length===0)return!1;for(let p=0;p<f.length-1;p++){const S=f[p],L=f[p+1];for(let G=0;G<u.length-1;G++)if(_p(S,L,u[G],u[G+1]))return!0}return!1}function _p(f,u,p,S){return pt(f,p,S)!==pt(u,p,S)&&pt(f,u,p)!==pt(f,u,S)}function of(f,u,p){const S=p*p;if(u.length===1)return f.distSqr(u[0])<S;for(let L=1;L<u.length;L++)if(H0(f,u[L-1],u[L])<S)return!0;return!1}function H0(f,u,p){const S=u.distSqr(p);if(S===0)return f.distSqr(u);const L=((f.x-u.x)*(p.x-u.x)+(f.y-u.y)*(p.y-u.y))/S;return f.distSqr(L<0?u:L>1?p:p.sub(u)._mult(L)._add(u))}function Ql(f,u){let p,S,L,G=!1;for(let Q=0;Q<f.length;Q++){p=f[Q];for(let re=0,he=p.length-1;re<p.length;he=re++)S=p[re],L=p[he],S.y>u.y!=L.y>u.y&&u.x<(L.x-S.x)*(u.y-S.y)/(L.y-S.y)+S.x&&(G=!G)}return G}function Xu(f,u){let p=!1;for(let S=0,L=f.length-1;S<f.length;L=S++){const G=f[S],Q=f[L];G.y>u.y!=Q.y>u.y&&u.x<(Q.x-G.x)*(u.y-G.y)/(Q.y-G.y)+G.x&&(p=!p)}return p}function j0(f,u,p){const S=p[0],L=p[2];if(f.x<S.x&&u.x<S.x||f.x>L.x&&u.x>L.x||f.y<S.y&&u.y<S.y||f.y>L.y&&u.y>L.y)return!1;const G=pt(f,u,p[0]);return G!==pt(f,u,p[1])||G!==pt(f,u,p[2])||G!==pt(f,u,p[3])}function yh(f,u,p){const S=u.paint.get(f).value;return S.kind==="constant"?S.value:p.programConfigurations.get(u.id).getMaxValue(f)}function $c(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function pA(f,u,p,S,L){if(!u[0]&&!u[1])return f;const G=fe.convert(u)._mult(L);p==="viewport"&&G._rotate(-S);const Q=[];for(let re=0;re<f.length;re++)Q.push(f[re].sub(G));return Q}let lf,l0;Pn("CircleBucket",o0,{omit:["layers"]});var ps={get paint(){return l0=l0||new cs({"circle-radius":new zi(fi.paint_circle["circle-radius"]),"circle-color":new zi(fi.paint_circle["circle-color"]),"circle-blur":new zi(fi.paint_circle["circle-blur"]),"circle-opacity":new zi(fi.paint_circle["circle-opacity"]),"circle-translate":new Mi(fi.paint_circle["circle-translate"]),"circle-translate-anchor":new Mi(fi.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Mi(fi.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Mi(fi.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new zi(fi.paint_circle["circle-stroke-width"]),"circle-stroke-color":new zi(fi.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new zi(fi.paint_circle["circle-stroke-opacity"])})},get layout(){return lf=lf||new cs({"circle-sort-key":new zi(fi.layout_circle["circle-sort-key"])})}},Wl=1e-6,qh=typeof Float32Array<"u"?Float32Array:Array;function Hh(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function uf(f,u,p){var S=u[0],L=u[1],G=u[2],Q=u[3],re=u[4],he=u[5],_e=u[6],Le=u[7],qe=u[8],Je=u[9],At=u[10],gt=u[11],Mt=u[12],Pt=u[13],zt=u[14],$t=u[15],Ht=p[0],Zt=p[1],ui=p[2],_i=p[3];return f[0]=Ht*S+Zt*re+ui*qe+_i*Mt,f[1]=Ht*L+Zt*he+ui*Je+_i*Pt,f[2]=Ht*G+Zt*_e+ui*At+_i*zt,f[3]=Ht*Q+Zt*Le+ui*gt+_i*$t,f[4]=(Ht=p[4])*S+(Zt=p[5])*re+(ui=p[6])*qe+(_i=p[7])*Mt,f[5]=Ht*L+Zt*he+ui*Je+_i*Pt,f[6]=Ht*G+Zt*_e+ui*At+_i*zt,f[7]=Ht*Q+Zt*Le+ui*gt+_i*$t,f[8]=(Ht=p[8])*S+(Zt=p[9])*re+(ui=p[10])*qe+(_i=p[11])*Mt,f[9]=Ht*L+Zt*he+ui*Je+_i*Pt,f[10]=Ht*G+Zt*_e+ui*At+_i*zt,f[11]=Ht*Q+Zt*Le+ui*gt+_i*$t,f[12]=(Ht=p[12])*S+(Zt=p[13])*re+(ui=p[14])*qe+(_i=p[15])*Mt,f[13]=Ht*L+Zt*he+ui*Je+_i*Pt,f[14]=Ht*G+Zt*_e+ui*At+_i*zt,f[15]=Ht*Q+Zt*Le+ui*gt+_i*$t,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var mA,Z0=uf;function Dl(f,u,p){var S=u[0],L=u[1],G=u[2],Q=u[3];return f[0]=p[0]*S+p[4]*L+p[8]*G+p[12]*Q,f[1]=p[1]*S+p[5]*L+p[9]*G+p[13]*Q,f[2]=p[2]*S+p[6]*L+p[10]*G+p[14]*Q,f[3]=p[3]*S+p[7]*L+p[11]*G+p[15]*Q,f}mA=new qh(4),qh!=Float32Array&&(mA[0]=0,mA[1]=0,mA[2]=0,mA[3]=0);class Nu extends Ps{constructor(u){super(u,ps)}createBucket(u){return new o0(u)}queryRadius(u){const p=u;return yh("circle-radius",this,p)+yh("circle-stroke-width",this,p)+$c(this.paint.get("circle-translate"))}queryIntersectsFeature(u,p,S,L,G,Q,re,he){const _e=pA(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,re),Le=this.paint.get("circle-radius").evaluate(p,S)+this.paint.get("circle-stroke-width").evaluate(p,S),qe=this.paint.get("circle-pitch-alignment")==="map",Je=qe?_e:function(gt,Mt){return gt.map(Pt=>gA(Pt,Mt))}(_e,he),At=qe?Le*re:Le;for(const gt of L)for(const Mt of gt){const Pt=qe?Mt:gA(Mt,he);let zt=At;const $t=Dl([],[Mt.x,Mt.y,0,1],he);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?zt*=$t[3]/Q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(zt*=Q.cameraToCenterDistance/$t[3]),gp(Je,Pt,zt))return!0}return!1}}function gA(f,u){const p=Dl([],[f.x,f.y,0,1],u);return new fe(p[0]/p[3],p[1]/p[3])}class u0 extends o0{}let c0;Pn("HeatmapBucket",u0,{omit:["layers"]});var yp={get paint(){return c0=c0||new cs({"heatmap-radius":new zi(fi.paint_heatmap["heatmap-radius"]),"heatmap-weight":new zi(fi.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Mi(fi.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Oo(fi.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Mi(fi.paint_heatmap["heatmap-opacity"])})}};function vu(f,{width:u,height:p},S,L){if(L){if(L instanceof Uint8ClampedArray)L=new Uint8Array(L.buffer);else if(L.length!==u*p*S)throw new RangeError(`mismatched image size. expected: ${L.length} but got: ${u*p*S}`)}else L=new Uint8Array(u*p*S);return f.width=u,f.height=p,f.data=L,f}function Kc(f,{width:u,height:p},S){if(u===f.width&&p===f.height)return;const L=vu({},{width:u,height:p},S);cf(f,L,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,p)},S),f.width=u,f.height=p,f.data=L.data}function cf(f,u,p,S,L,G){if(L.width===0||L.height===0)return u;if(L.width>f.width||L.height>f.height||p.x>f.width-L.width||p.y>f.height-L.height)throw new RangeError("out of range source coordinates for image copy");if(L.width>u.width||L.height>u.height||S.x>u.width-L.width||S.y>u.height-L.height)throw new RangeError("out of range destination coordinates for image copy");const Q=f.data,re=u.data;if(Q===re)throw new Error("srcData equals dstData, so image is already copied");for(let he=0;he<L.height;he++){const _e=((p.y+he)*f.width+p.x)*G,Le=((S.y+he)*u.width+S.x)*G;for(let qe=0;qe<L.width*G;qe++)re[Le+qe]=Q[_e+qe]}return u}class vh{constructor(u,p){vu(this,u,1,p)}resize(u){Kc(this,u,1)}clone(){return new vh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,S,L,G){cf(u,p,S,L,G,1)}}class Ll{constructor(u,p){vu(this,u,4,p)}resize(u){Kc(this,u,4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Ll({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,S,L,G){cf(u,p,S,L,G,4)}}function h0(f){const u={},p=f.resolution||256,S=f.clips?f.clips.length:1,L=f.image||new Ll({width:p,height:S});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const G=(Q,re,he)=>{u[f.evaluationKey]=he;const _e=f.expression.evaluate(u);L.data[Q+re+0]=Math.floor(255*_e.r/_e.a),L.data[Q+re+1]=Math.floor(255*_e.g/_e.a),L.data[Q+re+2]=Math.floor(255*_e.b/_e.a),L.data[Q+re+3]=Math.floor(255*_e.a)};if(f.clips)for(let Q=0,re=0;Q<S;++Q,re+=4*p)for(let he=0,_e=0;he<p;he++,_e+=4){const Le=he/(p-1),{start:qe,end:Je}=f.clips[Q];G(re,_e,qe*(1-Le)+Je*Le)}else for(let Q=0,re=0;Q<p;Q++,re+=4)G(0,re,Q/(p-1));return L}Pn("AlphaImage",vh),Pn("RGBAImage",Ll);class Jc extends Ps{createBucket(u){return new u0(u)}constructor(u){super(u,yp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=h0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let jh;var Q0={get paint(){return jh=jh||new cs({"hillshade-illumination-direction":new Mi(fi.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Mi(fi.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Mi(fi.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Mi(fi.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Mi(fi.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Mi(fi.paint_hillshade["hillshade-accent-color"])})}};class W0 extends Ps{constructor(u){super(u,Q0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const xh=R([{name:"a_pos",components:2,type:"Int16"}],4),{members:Em}=xh;var Ec={exports:{}};function hf(f,u,p){p=p||2;var S,L,G,Q,re,he,_e,Le=u&&u.length,qe=Le?u[0]*p:f.length,Je=X0(f,0,qe,p,!0),At=[];if(!Je||Je.next===Je.prev)return At;if(Le&&(Je=function(Mt,Pt,zt,$t){var Ht,Zt,ui,_i=[];for(Ht=0,Zt=Pt.length;Ht<Zt;Ht++)(ui=X0(Mt,Pt[Ht]*$t,Ht<Zt-1?Pt[Ht+1]*$t:Mt.length,$t,!1))===ui.next&&(ui.steiner=!0),_i.push(lc(ui));for(_i.sort(vp),Ht=0;Ht<_i.length;Ht++)zt=df(_i[Ht],zt);return zt}(f,u,Je,p)),f.length>80*p){S=G=f[0],L=Q=f[1];for(var gt=p;gt<qe;gt+=p)(re=f[gt])<S&&(S=re),(he=f[gt+1])<L&&(L=he),re>G&&(G=re),he>Q&&(Q=he);_e=(_e=Math.max(G-S,Q-L))!==0?32767/_e:0}return Af(Je,At,p,S,L,_e,0),At}function X0(f,u,p,S,L){var G,Q;if(L===vA(f,u,p,S)>0)for(G=u;G<p;G+=S)Q=bh(G,f[G],f[G+1],Q);else for(G=p-S;G>=u;G-=S)Q=bh(G,f[G],f[G+1],Q);return Q&&uc(Q,Q.next)&&(yf(Q),Q=Q.next),Q}function oc(f,u){if(!f)return f;u||(u=f);var p,S=f;do if(p=!1,S.steiner||!uc(S,S.next)&&Da(S.prev,S,S.next)!==0)S=S.next;else{if(yf(S),(S=u=S.prev)===S.next)break;p=!0}while(p||S!==u);return u}function Af(f,u,p,S,L,G,Q){if(f){!Q&&G&&function(Le,qe,Je,At){var gt=Le;do gt.z===0&&(gt.z=xl(gt.x,gt.y,qe,Je,At)),gt.prevZ=gt.prev,gt.nextZ=gt.next,gt=gt.next;while(gt!==Le);gt.prevZ.nextZ=null,gt.prevZ=null,function(Mt){var Pt,zt,$t,Ht,Zt,ui,_i,Xi,xn=1;do{for(zt=Mt,Mt=null,Zt=null,ui=0;zt;){for(ui++,$t=zt,_i=0,Pt=0;Pt<xn&&(_i++,$t=$t.nextZ);Pt++);for(Xi=xn;_i>0||Xi>0&&$t;)_i!==0&&(Xi===0||!$t||zt.z<=$t.z)?(Ht=zt,zt=zt.nextZ,_i--):(Ht=$t,$t=$t.nextZ,Xi--),Zt?Zt.nextZ=Ht:Mt=Ht,Ht.prevZ=Zt,Zt=Ht;zt=$t}Zt.nextZ=null,xn*=2}while(ui>1)}(gt)}(f,S,L,G);for(var re,he,_e=f;f.prev!==f.next;)if(re=f.prev,he=f.next,G?Cm(f,S,L,G):_A(f))u.push(re.i/p|0),u.push(f.i/p|0),u.push(he.i/p|0),yf(f),f=he.next,_e=he.next;else if((f=he)===_e){Q?Q===1?Af(f=ko(oc(f),u,p),u,p,S,L,G,2):Q===2&&ff(f,u,p,S,L,G):Af(oc(f),u,p,S,L,G,1);break}}}function _A(f){var u=f.prev,p=f,S=f.next;if(Da(u,p,S)>=0)return!1;for(var L=u.x,G=p.x,Q=S.x,re=u.y,he=p.y,_e=S.y,Le=L<G?L<Q?L:Q:G<Q?G:Q,qe=re<he?re<_e?re:_e:he<_e?he:_e,Je=L>G?L>Q?L:Q:G>Q?G:Q,At=re>he?re>_e?re:_e:he>_e?he:_e,gt=S.next;gt!==u;){if(gt.x>=Le&&gt.x<=Je&&gt.y>=qe&&gt.y<=At&&Zh(L,re,G,he,Q,_e,gt.x,gt.y)&&Da(gt.prev,gt,gt.next)>=0)return!1;gt=gt.next}return!0}function Cm(f,u,p,S){var L=f.prev,G=f,Q=f.next;if(Da(L,G,Q)>=0)return!1;for(var re=L.x,he=G.x,_e=Q.x,Le=L.y,qe=G.y,Je=Q.y,At=re<he?re<_e?re:_e:he<_e?he:_e,gt=Le<qe?Le<Je?Le:Je:qe<Je?qe:Je,Mt=re>he?re>_e?re:_e:he>_e?he:_e,Pt=Le>qe?Le>Je?Le:Je:qe>Je?qe:Je,zt=xl(At,gt,u,p,S),$t=xl(Mt,Pt,u,p,S),Ht=f.prevZ,Zt=f.nextZ;Ht&&Ht.z>=zt&&Zt&&Zt.z<=$t;){if(Ht.x>=At&&Ht.x<=Mt&&Ht.y>=gt&&Ht.y<=Pt&&Ht!==L&&Ht!==Q&&Zh(re,Le,he,qe,_e,Je,Ht.x,Ht.y)&&Da(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,Zt.x>=At&&Zt.x<=Mt&&Zt.y>=gt&&Zt.y<=Pt&&Zt!==L&&Zt!==Q&&Zh(re,Le,he,qe,_e,Je,Zt.x,Zt.y)&&Da(Zt.prev,Zt,Zt.next)>=0))return!1;Zt=Zt.nextZ}for(;Ht&&Ht.z>=zt;){if(Ht.x>=At&&Ht.x<=Mt&&Ht.y>=gt&&Ht.y<=Pt&&Ht!==L&&Ht!==Q&&Zh(re,Le,he,qe,_e,Je,Ht.x,Ht.y)&&Da(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;Zt&&Zt.z<=$t;){if(Zt.x>=At&&Zt.x<=Mt&&Zt.y>=gt&&Zt.y<=Pt&&Zt!==L&&Zt!==Q&&Zh(re,Le,he,qe,_e,Je,Zt.x,Zt.y)&&Da(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.nextZ}return!0}function ko(f,u,p){var S=f;do{var L=S.prev,G=S.next.next;!uc(L,G)&&A0(L,S,S.next,G)&&Cc(L,G)&&Cc(G,L)&&(u.push(L.i/p|0),u.push(S.i/p|0),u.push(G.i/p|0),yf(S),yf(S.next),S=f=G),S=S.next}while(S!==f);return oc(S)}function ff(f,u,p,S,L,G){var Q=f;do{for(var re=Q.next.next;re!==Q.prev;){if(Q.i!==re.i&&mf(Q,re)){var he=Qh(Q,re);return Q=oc(Q,Q.next),he=oc(he,he.next),Af(Q,u,p,S,L,G,0),void Af(he,u,p,S,L,G,0)}re=re.next}Q=Q.next}while(Q!==f)}function vp(f,u){return f.x-u.x}function df(f,u){var p=function(L,G){var Q,re=G,he=L.x,_e=L.y,Le=-1/0;do{if(_e<=re.y&&_e>=re.next.y&&re.next.y!==re.y){var qe=re.x+(_e-re.y)*(re.next.x-re.x)/(re.next.y-re.y);if(qe<=he&&qe>Le&&(Le=qe,Q=re.x<re.next.x?re:re.next,qe===he))return Q}re=re.next}while(re!==G);if(!Q)return null;var Je,At=Q,gt=Q.x,Mt=Q.y,Pt=1/0;re=Q;do he>=re.x&&re.x>=gt&&he!==re.x&&Zh(_e<Mt?he:Le,_e,gt,Mt,_e<Mt?Le:he,_e,re.x,re.y)&&(Je=Math.abs(_e-re.y)/(he-re.x),Cc(re,L)&&(Je<Pt||Je===Pt&&(re.x>Q.x||re.x===Q.x&&pf(Q,re)))&&(Q=re,Pt=Je)),re=re.next;while(re!==At);return Q}(f,u);if(!p)return u;var S=Qh(p,f);return oc(S,S.next),oc(p,p.next)}function pf(f,u){return Da(f.prev,f,u.prev)<0&&Da(u.next,f,f.next)<0}function xl(f,u,p,S,L){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*L|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-S)*L|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function lc(f){var u=f,p=f;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==f);return p}function Zh(f,u,p,S,L,G,Q,re){return(L-Q)*(u-re)>=(f-Q)*(G-re)&&(f-Q)*(S-re)>=(p-Q)*(u-re)&&(p-Q)*(G-re)>=(L-Q)*(S-re)}function mf(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(p,S){var L=p;do{if(L.i!==p.i&&L.next.i!==p.i&&L.i!==S.i&&L.next.i!==S.i&&A0(L,L.next,p,S))return!0;L=L.next}while(L!==p);return!1}(f,u)&&(Cc(f,u)&&Cc(u,f)&&function(p,S){var L=p,G=!1,Q=(p.x+S.x)/2,re=(p.y+S.y)/2;do L.y>re!=L.next.y>re&&L.next.y!==L.y&&Q<(L.next.x-L.x)*(re-L.y)/(L.next.y-L.y)+L.x&&(G=!G),L=L.next;while(L!==p);return G}(f,u)&&(Da(f.prev,f,u.prev)||Da(f,u.prev,u))||uc(f,u)&&Da(f.prev,f,f.next)>0&&Da(u.prev,u,u.next)>0)}function Da(f,u,p){return(u.y-f.y)*(p.x-u.x)-(u.x-f.x)*(p.y-u.y)}function uc(f,u){return f.x===u.x&&f.y===u.y}function A0(f,u,p,S){var L=_f(Da(f,u,p)),G=_f(Da(f,u,S)),Q=_f(Da(p,S,f)),re=_f(Da(p,S,u));return L!==G&&Q!==re||!(L!==0||!gf(f,p,u))||!(G!==0||!gf(f,S,u))||!(Q!==0||!gf(p,f,S))||!(re!==0||!gf(p,u,S))}function gf(f,u,p){return u.x<=Math.max(f.x,p.x)&&u.x>=Math.min(f.x,p.x)&&u.y<=Math.max(f.y,p.y)&&u.y>=Math.min(f.y,p.y)}function _f(f){return f>0?1:f<0?-1:0}function Cc(f,u){return Da(f.prev,f,f.next)<0?Da(f,u,f.next)>=0&&Da(f,f.prev,u)>=0:Da(f,u,f.prev)<0||Da(f,f.next,u)<0}function Qh(f,u){var p=new yA(f.i,f.x,f.y),S=new yA(u.i,u.x,u.y),L=f.next,G=u.prev;return f.next=u,u.prev=f,p.next=L,L.prev=p,S.next=p,p.prev=S,G.next=S,S.prev=G,S}function bh(f,u,p,S){var L=new yA(f,u,p);return S?(L.next=S.next,L.prev=S,S.next.prev=L,S.next=L):(L.prev=L,L.next=L),L}function yf(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function yA(f,u,p){this.i=f,this.x=u,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function vA(f,u,p,S){for(var L=0,G=u,Q=p-S;G<p;G+=S)L+=(f[Q]-f[G])*(f[G+1]+f[Q+1]),Q=G;return L}Ec.exports=hf,Ec.exports.default=hf,hf.deviation=function(f,u,p,S){var L=u&&u.length,G=Math.abs(vA(f,0,L?u[0]*p:f.length,p));if(L)for(var Q=0,re=u.length;Q<re;Q++)G-=Math.abs(vA(f,u[Q]*p,Q<re-1?u[Q+1]*p:f.length,p));var he=0;for(Q=0;Q<S.length;Q+=3){var _e=S[Q]*p,Le=S[Q+1]*p,qe=S[Q+2]*p;he+=Math.abs((f[_e]-f[qe])*(f[Le+1]-f[_e+1])-(f[_e]-f[Le])*(f[qe+1]-f[_e+1]))}return G===0&&he===0?0:Math.abs((he-G)/G)},hf.flatten=function(f){for(var u=f[0][0].length,p={vertices:[],holes:[],dimensions:u},S=0,L=0;L<f.length;L++){for(var G=0;G<f[L].length;G++)for(var Q=0;Q<u;Q++)p.vertices.push(f[L][G][Q]);L>0&&p.holes.push(S+=f[L-1].length)}return p};var Wh=W(Ec.exports);function Y0(f,u,p,S,L){xA(f,u,p||0,S||f.length-1,L||f0)}function xA(f,u,p,S,L){for(;S>p;){if(S-p>600){var G=S-p+1,Q=u-p+1,re=Math.log(G),he=.5*Math.exp(2*re/3),_e=.5*Math.sqrt(re*he*(G-he)/G)*(Q-G/2<0?-1:1);xA(f,u,Math.max(p,Math.floor(u-Q*he/G+_e)),Math.min(S,Math.floor(u+(G-Q)*he/G+_e)),L)}var Le=f[u],qe=p,Je=S;for(Xh(f,p,u),L(f[S],Le)>0&&Xh(f,p,S);qe<Je;){for(Xh(f,qe,Je),qe++,Je--;L(f[qe],Le)<0;)qe++;for(;L(f[Je],Le)>0;)Je--}L(f[p],Le)===0?Xh(f,p,Je):Xh(f,++Je,S),Je<=u&&(p=Je+1),u<=Je&&(S=Je-1)}}function Xh(f,u,p){var S=f[u];f[u]=f[p],f[p]=S}function f0(f,u){return f<u?-1:f>u?1:0}function $0(f,u){const p=f.length;if(p<=1)return[f];const S=[];let L,G;for(let Q=0;Q<p;Q++){const re=at(f[Q]);re!==0&&(f[Q].area=Math.abs(re),G===void 0&&(G=re<0),G===re<0?(L&&S.push(L),L=[f[Q]]):L.push(f[Q]))}if(L&&S.push(L),u>1)for(let Q=0;Q<S.length;Q++)S[Q].length<=u||(Y0(S[Q],u,1,S[Q].length-1,xp),S[Q]=S[Q].slice(0,u));return S}function xp(f,u){return u.area-f.area}function bA(f,u,p){const S=p.patternDependencies;let L=!1;for(const G of u){const Q=G.paint.get(`${f}-pattern`);Q.isConstant()||(L=!0);const re=Q.constantOr(null);re&&(L=!0,S[re.to]=!0,S[re.from]=!0)}return L}function cc(f,u,p,S,L){const G=L.patternDependencies;for(const Q of u){const re=Q.paint.get(`${f}-pattern`).value;if(re.kind!=="constant"){let he=re.evaluate({zoom:S-1},p,{},L.availableImages),_e=re.evaluate({zoom:S},p,{},L.availableImages),Le=re.evaluate({zoom:S+1},p,{},L.availableImages);he=he&&he.name?he.name:he,_e=_e&&_e.name?_e.name:_e,Le=Le&&Le.name?Le.name:Le,G[he]=!0,G[_e]=!0,G[Le]=!0,p.patterns[Q.id]={min:he,mid:_e,max:Le}}}return p}class vf{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ri,this.indexArray=new Bn,this.indexArray2=new Ji,this.programConfigurations=new hu(u.layers,u.zoom),this.segments=new er,this.segments2=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){this.hasPattern=bA("fill",this.layers,p);const L=this.layers[0].layout.get("fill-sort-key"),G=!L.isConstant(),Q=[];for(const{feature:re,id:he,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,Je=Ic(re,qe);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),Je,S))continue;const At=G?L.evaluate(Je,{},S,p.availableImages):void 0,gt={id:he,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?Je.geometry:Vh(re),patterns:{},sortKey:At};Q.push(gt)}G&&Q.sort((re,he)=>re.sortKey-he.sortKey);for(const re of Q){const{geometry:he,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=cc("fill",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,he,_e,S,{});p.featureIndex.insert(u[_e].feature,he,_e,Le,this.index)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}addFeatures(u,p,S){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Em),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,S,L,G){for(const Q of $0(p,500)){let re=0;for(const At of Q)re+=At.length;const he=this.segments.prepareSegment(re,this.layoutVertexArray,this.indexArray),_e=he.vertexLength,Le=[],qe=[];for(const At of Q){if(At.length===0)continue;At!==Q[0]&&qe.push(Le.length/2);const gt=this.segments2.prepareSegment(At.length,this.layoutVertexArray,this.indexArray2),Mt=gt.vertexLength;this.layoutVertexArray.emplaceBack(At[0].x,At[0].y),this.indexArray2.emplaceBack(Mt+At.length-1,Mt),Le.push(At[0].x),Le.push(At[0].y);for(let Pt=1;Pt<At.length;Pt++)this.layoutVertexArray.emplaceBack(At[Pt].x,At[Pt].y),this.indexArray2.emplaceBack(Mt+Pt-1,Mt+Pt),Le.push(At[Pt].x),Le.push(At[Pt].y);gt.vertexLength+=At.length,gt.primitiveLength+=At.length}const Je=Wh(Le,qe);for(let At=0;At<Je.length;At+=3)this.indexArray.emplaceBack(_e+Je[At],_e+Je[At+1],_e+Je[At+2]);he.vertexLength+=re,he.primitiveLength+=Je.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,G,L)}}let K0,wh;Pn("FillBucket",vf,{omit:["layers","patternFeatures"]});var eh={get paint(){return wh=wh||new cs({"fill-antialias":new Mi(fi.paint_fill["fill-antialias"]),"fill-opacity":new zi(fi.paint_fill["fill-opacity"]),"fill-color":new zi(fi.paint_fill["fill-color"]),"fill-outline-color":new zi(fi.paint_fill["fill-outline-color"]),"fill-translate":new Mi(fi.paint_fill["fill-translate"]),"fill-translate-anchor":new Mi(fi.paint_fill["fill-translate-anchor"]),"fill-pattern":new ys(fi.paint_fill["fill-pattern"])})},get layout(){return K0=K0||new cs({"fill-sort-key":new zi(fi.layout_fill["fill-sort-key"])})}};class bp extends Ps{constructor(u){super(u,eh)}recalculate(u,p){super.recalculate(u,p);const S=this.paint._values["fill-outline-color"];S.value.kind==="constant"&&S.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new vf(u)}queryRadius(){return $c(this.paint.get("fill-translate"))}queryIntersectsFeature(u,p,S,L,G,Q,re){return Gh(pA(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,re),L)}isTileClipped(){return!0}}const wp=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Sp=R([{name:"a_centroid",components:2,type:"Int16"}],4),{members:J0}=wp;var Sh={},Tm=ce,Tc=Ih;function Ih(f,u,p,S,L){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=S,this._values=L,f.readFields(xf,this,u)}function xf(f,u,p){f==1?u.id=p.readVarint():f==2?function(S,L){for(var G=S.readVarint()+S.pos;S.pos<G;){var Q=L._keys[S.readVarint()],re=L._values[S.readVarint()];L.properties[Q]=re}}(p,u):f==3?u.type=p.readVarint():f==4&&(u._geometry=p.pos)}function Yh(f){for(var u,p,S=0,L=0,G=f.length,Q=G-1;L<G;Q=L++)S+=((p=f[Q]).x-(u=f[L]).x)*(u.y+p.y);return S}Ih.types=["Unknown","Point","LineString","Polygon"],Ih.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,p=f.readVarint()+f.pos,S=1,L=0,G=0,Q=0,re=[];f.pos<p;){if(L<=0){var he=f.readVarint();S=7&he,L=he>>3}if(L--,S===1||S===2)G+=f.readSVarint(),Q+=f.readSVarint(),S===1&&(u&&re.push(u),u=[]),u.push(new Tm(G,Q));else{if(S!==7)throw new Error("unknown command "+S);u&&u.push(u[0].clone())}}return u&&re.push(u),re},Ih.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,p=1,S=0,L=0,G=0,Q=1/0,re=-1/0,he=1/0,_e=-1/0;f.pos<u;){if(S<=0){var Le=f.readVarint();p=7&Le,S=Le>>3}if(S--,p===1||p===2)(L+=f.readSVarint())<Q&&(Q=L),L>re&&(re=L),(G+=f.readSVarint())<he&&(he=G),G>_e&&(_e=G);else if(p!==7)throw new Error("unknown command "+p)}return[Q,he,re,_e]},Ih.prototype.toGeoJSON=function(f,u,p){var S,L,G=this.extent*Math.pow(2,p),Q=this.extent*f,re=this.extent*u,he=this.loadGeometry(),_e=Ih.types[this.type];function Le(At){for(var gt=0;gt<At.length;gt++){var Mt=At[gt];At[gt]=[360*(Mt.x+Q)/G-180,360/Math.PI*Math.atan(Math.exp((180-360*(Mt.y+re)/G)*Math.PI/180))-90]}}switch(this.type){case 1:var qe=[];for(S=0;S<he.length;S++)qe[S]=he[S][0];Le(he=qe);break;case 2:for(S=0;S<he.length;S++)Le(he[S]);break;case 3:for(he=function(At){var gt=At.length;if(gt<=1)return[At];for(var Mt,Pt,zt=[],$t=0;$t<gt;$t++){var Ht=Yh(At[$t]);Ht!==0&&(Pt===void 0&&(Pt=Ht<0),Pt===Ht<0?(Mt&&zt.push(Mt),Mt=[At[$t]]):Mt.push(At[$t]))}return Mt&&zt.push(Mt),zt}(he),S=0;S<he.length;S++)for(L=0;L<he[S].length;L++)Le(he[S][L])}he.length===1?he=he[0]:_e="Multi"+_e;var Je={type:"Feature",geometry:{type:_e,coordinates:he},properties:this.properties};return"id"in this&&(Je.id=this.id),Je};var wA=Tc,$h=Ir;function Ir(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(bf,this,u),this.length=this._features.length}function bf(f,u,p){f===15?u.version=p.readVarint():f===1?u.name=p.readString():f===5?u.extent=p.readVarint():f===2?u._features.push(p.pos):f===3?u._keys.push(p.readString()):f===4&&u._values.push(function(S){for(var L=null,G=S.readVarint()+S.pos;S.pos<G;){var Q=S.readVarint()>>3;L=Q===1?S.readString():Q===2?S.readFloat():Q===3?S.readDouble():Q===4?S.readVarint64():Q===5?S.readVarint():Q===6?S.readSVarint():Q===7?S.readBoolean():null}return L}(p))}Ir.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new wA(this._pbf,u,this.extent,this._keys,this._values)};var ed=$h;function Kh(f,u,p){if(f===3){var S=new ed(p,p.readVarint()+p.pos);S.length&&(u[S.name]=S)}}Sh.VectorTile=function(f,u){this.layers=f.readFields(Kh,{},u)},Sh.VectorTileFeature=Tc,Sh.VectorTileLayer=$h;const wf=Sh.VectorTileFeature.types,SA=Math.pow(2,13);function IA(f,u,p,S,L,G,Q,re){f.emplaceBack(u,p,2*Math.floor(S*SA)+Q,L*SA*2,G*SA*2,Math.round(re))}class Ul{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new Xt,this.centroidVertexArray=new Et,this.indexArray=new Bn,this.programConfigurations=new hu(u.layers,u.zoom),this.segments=new er,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){this.features=[],this.hasPattern=bA("fill-extrusion",this.layers,p);for(const{feature:L,id:G,index:Q,sourceLayerIndex:re}of u){const he=this.layers[0]._featureFilter.needGeometry,_e=Ic(L,he);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),_e,S))continue;const Le={id:G,sourceLayerIndex:re,index:Q,geometry:he?_e.geometry:Vh(L),properties:L.properties,type:L.type,patterns:{}};this.hasPattern?this.features.push(cc("fill-extrusion",this.layers,Le,this.zoom,p)):this.addFeature(Le,Le.geometry,Q,S,{}),p.featureIndex.insert(L,Le.geometry,Q,re,this.index,!0)}}addFeatures(u,p,S){for(const L of this.features){const{geometry:G}=L;this.addFeature(L,G,L.index,p,S)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,J0),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,Sp.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,p,S,L,G){const Q={x:0,y:0,vertexCount:0};for(const re of $0(p,500)){let he=0;for(const gt of re)he+=gt.length;let _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const gt of re){if(gt.length===0||Mm(gt))continue;let Mt=0;for(let Pt=0;Pt<gt.length;Pt++){const zt=gt[Pt];if(Pt>=1){const $t=gt[Pt-1];if(!km(zt,$t)){_e.vertexLength+4>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ht=zt.sub($t)._perp()._unit(),Zt=$t.dist(zt);Mt+Zt>32768&&(Mt=0),IA(this.layoutVertexArray,zt.x,zt.y,Ht.x,Ht.y,0,0,Mt),IA(this.layoutVertexArray,zt.x,zt.y,Ht.x,Ht.y,0,1,Mt),Q.x+=2*zt.x,Q.y+=2*zt.y,Q.vertexCount+=2,Mt+=Zt,IA(this.layoutVertexArray,$t.x,$t.y,Ht.x,Ht.y,0,0,Mt),IA(this.layoutVertexArray,$t.x,$t.y,Ht.x,Ht.y,0,1,Mt),Q.x+=2*$t.x,Q.y+=2*$t.y,Q.vertexCount+=2;const ui=_e.vertexLength;this.indexArray.emplaceBack(ui,ui+2,ui+1),this.indexArray.emplaceBack(ui+1,ui+2,ui+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+he>er.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(he,this.layoutVertexArray,this.indexArray)),wf[u.type]!=="Polygon")continue;const Le=[],qe=[],Je=_e.vertexLength;for(const gt of re)if(gt.length!==0){gt!==re[0]&&qe.push(Le.length/2);for(let Mt=0;Mt<gt.length;Mt++){const Pt=gt[Mt];IA(this.layoutVertexArray,Pt.x,Pt.y,0,0,1,1,0),Q.x+=Pt.x,Q.y+=Pt.y,Q.vertexCount+=1,Le.push(Pt.x),Le.push(Pt.y)}}const At=Wh(Le,qe);for(let gt=0;gt<At.length;gt+=3)this.indexArray.emplaceBack(Je+At[gt],Je+At[gt+2],Je+At[gt+1]);_e.primitiveLength+=At.length/3,_e.vertexLength+=he}for(let re=0;re<Q.vertexCount;re++)this.centroidVertexArray.emplaceBack(Math.floor(Q.x/Q.vertexCount),Math.floor(Q.y/Q.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,G,L)}}function km(f,u){return f.x===u.x&&(f.x<0||f.x>Pa)||f.y===u.y&&(f.y<0||f.y>Pa)}function Mm(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Pa)||f.every(u=>u.y<0)||f.every(u=>u.y>Pa)}let td;Pn("FillExtrusionBucket",Ul,{omit:["layers","features"]});var Pm={get paint(){return td=td||new cs({"fill-extrusion-opacity":new Mi(fi["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new zi(fi["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Mi(fi["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Mi(fi["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ys(fi["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new zi(fi["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new zi(fi["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Mi(fi["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class id extends Ps{constructor(u){super(u,Pm)}createBucket(u){return new Ul(u)}queryRadius(){return $c(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(u,p,S,L,G,Q,re,he){const _e=pA(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,re),Le=this.paint.get("fill-extrusion-height").evaluate(p,S),qe=this.paint.get("fill-extrusion-base").evaluate(p,S),Je=function(gt,Mt,Pt,zt){const $t=[];for(const Ht of gt){const Zt=[Ht.x,Ht.y,0,1];Dl(Zt,Zt,Mt),$t.push(new fe(Zt[0]/Zt[3],Zt[1]/Zt[3]))}return $t}(_e,he),At=function(gt,Mt,Pt,zt){const $t=[],Ht=[],Zt=zt[8]*Mt,ui=zt[9]*Mt,_i=zt[10]*Mt,Xi=zt[11]*Mt,xn=zt[8]*Pt,nn=zt[9]*Pt,tn=zt[10]*Pt,hn=zt[11]*Pt;for(const zn of gt){const en=[],Wi=[];for(const Dn of zn){const Rn=Dn.x,dr=Dn.y,Fr=zt[0]*Rn+zt[4]*dr+zt[12],qr=zt[1]*Rn+zt[5]*dr+zt[13],zs=zt[2]*Rn+zt[6]*dr+zt[14],Ea=zt[3]*Rn+zt[7]*dr+zt[15],ia=zs+_i,is=Ea+Xi,Wn=Fr+xn,xs=qr+nn,tr=zs+tn,na=Ea+hn,Ds=new fe((Fr+Zt)/is,(qr+ui)/is);Ds.z=ia/is,en.push(Ds);const Kn=new fe(Wn/na,xs/na);Kn.z=tr/na,Wi.push(Kn)}$t.push(en),Ht.push(Wi)}return[$t,Ht]}(L,qe,Le,he);return function(gt,Mt,Pt){let zt=1/0;Gh(Pt,Mt)&&(zt=nd(Pt,Mt[0]));for(let $t=0;$t<Mt.length;$t++){const Ht=Mt[$t],Zt=gt[$t];for(let ui=0;ui<Ht.length-1;ui++){const _i=Ht[ui],Xi=[_i,Ht[ui+1],Zt[ui+1],Zt[ui],_i];Xc(Pt,Xi)&&(zt=Math.min(zt,nd(Pt,Xi)))}}return zt!==1/0&&zt}(At[0],At[1],Je)}}function Jh(f,u){return f.x*u.x+f.y*u.y}function nd(f,u){if(f.length===1){let p=0;const S=u[p++];let L;for(;!L||S.equals(L);)if(L=u[p++],!L)return 1/0;for(;p<u.length;p++){const G=u[p],Q=f[0],re=L.sub(S),he=G.sub(S),_e=Q.sub(S),Le=Jh(re,re),qe=Jh(re,he),Je=Jh(he,he),At=Jh(_e,re),gt=Jh(_e,he),Mt=Le*Je-qe*qe,Pt=(Je*At-qe*gt)/Mt,zt=(Le*gt-qe*At)/Mt,$t=S.z*(1-Pt-zt)+L.z*Pt+G.z*zt;if(isFinite($t))return $t}return 1/0}{let p=1/0;for(const S of u)p=Math.min(p,S.z);return p}}const Ip=R([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:kc}=Ip,xu=R([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:EA}=xu,Dm=Sh.VectorTileFeature.types,d0=Math.cos(Math.PI/180*37.5),Ep=Math.pow(2,14)/.5;class rd{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new Jt,this.layoutVertexArray2=new si,this.indexArray=new Bn,this.programConfigurations=new hu(u.layers,u.zoom),this.segments=new er,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,S){this.hasPattern=bA("line",this.layers,p);const L=this.layers[0].layout.get("line-sort-key"),G=!L.isConstant(),Q=[];for(const{feature:re,id:he,index:_e,sourceLayerIndex:Le}of u){const qe=this.layers[0]._featureFilter.needGeometry,Je=Ic(re,qe);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),Je,S))continue;const At=G?L.evaluate(Je,{},S):void 0,gt={id:he,properties:re.properties,type:re.type,sourceLayerIndex:Le,index:_e,geometry:qe?Je.geometry:Vh(re),patterns:{},sortKey:At};Q.push(gt)}G&&Q.sort((re,he)=>re.sortKey-he.sortKey);for(const re of Q){const{geometry:he,index:_e,sourceLayerIndex:Le}=re;if(this.hasPattern){const qe=cc("line",this.layers,re,this.zoom,p);this.patternFeatures.push(qe)}else this.addFeature(re,he,_e,S,{});p.featureIndex.insert(u[_e].feature,he,_e,Le,this.index)}}update(u,p,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,S)}addFeatures(u,p,S){for(const L of this.patternFeatures)this.addFeature(L,L.geometry,L.index,p,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,EA)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,kc),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,S,L,G){const Q=this.layers[0].layout,re=Q.get("line-join").evaluate(u,{}),he=Q.get("line-cap"),_e=Q.get("line-miter-limit"),Le=Q.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const qe of p)this.addLine(qe,u,re,he,_e,Le);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,S,G,L)}addLine(u,p,S,L,G,Q){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let zt=0;zt<u.length-1;zt++)this.totalDistance+=u[zt].dist(u[zt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const re=Dm[p.type]==="Polygon";let he=u.length;for(;he>=2&&u[he-1].equals(u[he-2]);)he--;let _e=0;for(;_e<he-1&&u[_e].equals(u[_e+1]);)_e++;if(he<(re?3:2))return;S==="bevel"&&(G=1.05);const Le=this.overscaling<=16?15*Pa/(512*this.overscaling):0,qe=this.segments.prepareSegment(10*he,this.layoutVertexArray,this.indexArray);let Je,At,gt,Mt,Pt;this.e1=this.e2=-1,re&&(Je=u[he-2],Pt=u[_e].sub(Je)._unit()._perp());for(let zt=_e;zt<he;zt++){if(gt=zt===he-1?re?u[_e+1]:void 0:u[zt+1],gt&&u[zt].equals(gt))continue;Pt&&(Mt=Pt),Je&&(At=Je),Je=u[zt],Pt=gt?gt.sub(Je)._unit()._perp():Mt,Mt=Mt||Pt;let $t=Mt.add(Pt);$t.x===0&&$t.y===0||$t._unit();const Ht=Mt.x*Pt.x+Mt.y*Pt.y,Zt=$t.x*Pt.x+$t.y*Pt.y,ui=Zt!==0?1/Zt:1/0,_i=2*Math.sqrt(2-2*Zt),Xi=Zt<d0&&At&&gt,xn=Mt.x*Pt.y-Mt.y*Pt.x>0;if(Xi&&zt>_e){const hn=Je.dist(At);if(hn>2*Le){const zn=Je.sub(Je.sub(At)._mult(Le/hn)._round());this.updateDistance(At,zn),this.addCurrentVertex(zn,Mt,0,0,qe),At=zn}}const nn=At&&gt;let tn=nn?S:re?"butt":L;if(nn&&tn==="round"&&(ui<Q?tn="miter":ui<=2&&(tn="fakeround")),tn==="miter"&&ui>G&&(tn="bevel"),tn==="bevel"&&(ui>2&&(tn="flipbevel"),ui<G&&(tn="miter")),At&&this.updateDistance(At,Je),tn==="miter")$t._mult(ui),this.addCurrentVertex(Je,$t,0,0,qe);else if(tn==="flipbevel"){if(ui>100)$t=Pt.mult(-1);else{const hn=ui*Mt.add(Pt).mag()/Mt.sub(Pt).mag();$t._perp()._mult(hn*(xn?-1:1))}this.addCurrentVertex(Je,$t,0,0,qe),this.addCurrentVertex(Je,$t.mult(-1),0,0,qe)}else if(tn==="bevel"||tn==="fakeround"){const hn=-Math.sqrt(ui*ui-1),zn=xn?hn:0,en=xn?0:hn;if(At&&this.addCurrentVertex(Je,Mt,zn,en,qe),tn==="fakeround"){const Wi=Math.round(180*_i/Math.PI/20);for(let Dn=1;Dn<Wi;Dn++){let Rn=Dn/Wi;if(Rn!==.5){const Fr=Rn-.5;Rn+=Rn*Fr*(Rn-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*Fr*Fr+(.848013+Ht*(.215638*Ht-1.06021)))}const dr=Pt.sub(Mt)._mult(Rn)._add(Mt)._unit()._mult(xn?-1:1);this.addHalfVertex(Je,dr.x,dr.y,!1,xn,0,qe)}}gt&&this.addCurrentVertex(Je,Pt,-zn,-en,qe)}else if(tn==="butt")this.addCurrentVertex(Je,$t,0,0,qe);else if(tn==="square"){const hn=At?1:-1;this.addCurrentVertex(Je,$t,hn,hn,qe)}else tn==="round"&&(At&&(this.addCurrentVertex(Je,Mt,0,0,qe),this.addCurrentVertex(Je,Mt,1,1,qe,!0)),gt&&(this.addCurrentVertex(Je,Pt,-1,-1,qe,!0),this.addCurrentVertex(Je,Pt,0,0,qe)));if(Xi&&zt<he-1){const hn=Je.dist(gt);if(hn>2*Le){const zn=Je.add(gt.sub(Je)._mult(Le/hn)._round());this.updateDistance(Je,zn),this.addCurrentVertex(zn,Pt,0,0,qe),Je=zn}}}}addCurrentVertex(u,p,S,L,G,Q=!1){const re=p.y*L-p.x,he=-p.y-p.x*L;this.addHalfVertex(u,p.x+p.y*S,p.y-p.x*S,Q,!1,S,G),this.addHalfVertex(u,re,he,Q,!0,-L,G),this.distance>Ep/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(u,p,S,L,G,Q))}addHalfVertex({x:u,y:p},S,L,G,Q,re,he){const _e=.5*(this.lineClips?this.scaledDistance*(Ep-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(G?1:0),(p<<1)+(Q?1:0),Math.round(63*S)+128,Math.round(63*L)+128,1+(re===0?0:re<0?-1:1)|(63&_e)<<2,_e>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Le=he.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Le),he.primitiveLength++),Q?this.e2=Le:this.e1=Le}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}let CA,p0;Pn("LineBucket",rd,{omit:["layers","patternFeatures"]});var sd={get paint(){return p0=p0||new cs({"line-opacity":new zi(fi.paint_line["line-opacity"]),"line-color":new zi(fi.paint_line["line-color"]),"line-translate":new Mi(fi.paint_line["line-translate"]),"line-translate-anchor":new Mi(fi.paint_line["line-translate-anchor"]),"line-width":new zi(fi.paint_line["line-width"]),"line-gap-width":new zi(fi.paint_line["line-gap-width"]),"line-offset":new zi(fi.paint_line["line-offset"]),"line-blur":new zi(fi.paint_line["line-blur"]),"line-dasharray":new yu(fi.paint_line["line-dasharray"]),"line-pattern":new ys(fi.paint_line["line-pattern"]),"line-gradient":new Oo(fi.paint_line["line-gradient"])})},get layout(){return CA=CA||new cs({"line-cap":new Mi(fi.layout_line["line-cap"]),"line-join":new zi(fi.layout_line["line-join"]),"line-miter-limit":new Mi(fi.layout_line["line-miter-limit"]),"line-round-limit":new Mi(fi.layout_line["line-round-limit"]),"line-sort-key":new zi(fi.layout_line["line-sort-key"])})}};class Lm extends zi{possiblyEvaluate(u,p){return p=new pn(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),super.possiblyEvaluate(u,p)}evaluate(u,p,S,L){return p=it({},p,{zoom:Math.floor(p.zoom)}),super.evaluate(u,p,S,L)}}let Eh;class cl extends Ps{constructor(u){super(u,sd),this.gradientVersion=0,Eh||(Eh=new Lm(sd.paint.properties["line-width"].specification),Eh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const p=this.gradientExpression();this.stepInterpolant=!!function(S){return S._styleExpression!==void 0}(p)&&p._styleExpression.expression instanceof ir,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,p){super.recalculate(u,p),this.paint._values["line-floorwidth"]=Eh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new rd(u)}queryRadius(u){const p=u,S=ad(yh("line-width",this,p),yh("line-gap-width",this,p)),L=yh("line-offset",this,p);return S/2+Math.abs(L)+$c(this.paint.get("line-translate"))}queryIntersectsFeature(u,p,S,L,G,Q,re){const he=pA(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,re),_e=re/2*ad(this.paint.get("line-width").evaluate(p,S),this.paint.get("line-gap-width").evaluate(p,S)),Le=this.paint.get("line-offset").evaluate(p,S);return Le&&(L=function(qe,Je){const At=[];for(let gt=0;gt<qe.length;gt++){const Mt=qe[gt],Pt=[];for(let zt=0;zt<Mt.length;zt++){const $t=Mt[zt-1],Ht=Mt[zt],Zt=Mt[zt+1],ui=zt===0?new fe(0,0):Ht.sub($t)._unit()._perp(),_i=zt===Mt.length-1?new fe(0,0):Zt.sub(Ht)._unit()._perp(),Xi=ui._add(_i)._unit(),xn=Xi.x*_i.x+Xi.y*_i.y;xn!==0&&Xi._mult(1/xn),Pt.push(Xi._mult(Je)._add(Ht))}At.push(Pt)}return At}(L,Le*re)),function(qe,Je,At){for(let gt=0;gt<Je.length;gt++){const Mt=Je[gt];if(qe.length>=3){for(let Pt=0;Pt<Mt.length;Pt++)if(Xu(qe,Mt[Pt]))return!0}if(af(qe,Mt,At))return!0}return!1}(he,L,_e)}isTileClipped(){return!0}}function ad(f,u){return u>0?u+2*f:f}const od=R([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ld=R([{name:"a_projected_pos",components:3,type:"Float32"}],4);R([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const fa=R([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);R([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const TA=R([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ud=R([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function kA(f,u,p){return f.sections.forEach(S=>{S.text=function(L,G,Q){const re=G.layout.get("text-transform").evaluate(Q,{});return re==="uppercase"?L=L.toLocaleUpperCase():re==="lowercase"&&(L=L.toLocaleLowerCase()),ds.applyArabicShaping&&(L=ds.applyArabicShaping(L)),L}(S.text,u,p)}),f}R([{name:"triangle",components:3,type:"Uint16"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),R([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),R([{type:"Float32",name:"offsetX"}]),R([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),R([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const bu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ya=24,m0=ms,Sf=function(f,u,p,S,L){var G,Q,re=8*L-S-1,he=(1<<re)-1,_e=he>>1,Le=-7,qe=p?L-1:0,Je=p?-1:1,At=f[u+qe];for(qe+=Je,G=At&(1<<-Le)-1,At>>=-Le,Le+=re;Le>0;G=256*G+f[u+qe],qe+=Je,Le-=8);for(Q=G&(1<<-Le)-1,G>>=-Le,Le+=S;Le>0;Q=256*Q+f[u+qe],qe+=Je,Le-=8);if(G===0)G=1-_e;else{if(G===he)return Q?NaN:1/0*(At?-1:1);Q+=Math.pow(2,S),G-=_e}return(At?-1:1)*Q*Math.pow(2,G-S)},cd=function(f,u,p,S,L,G){var Q,re,he,_e=8*G-L-1,Le=(1<<_e)-1,qe=Le>>1,Je=L===23?Math.pow(2,-24)-Math.pow(2,-77):0,At=S?0:G-1,gt=S?1:-1,Mt=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(re=isNaN(u)?1:0,Q=Le):(Q=Math.floor(Math.log(u)/Math.LN2),u*(he=Math.pow(2,-Q))<1&&(Q--,he*=2),(u+=Q+qe>=1?Je/he:Je*Math.pow(2,1-qe))*he>=2&&(Q++,he/=2),Q+qe>=Le?(re=0,Q=Le):Q+qe>=1?(re=(u*he-1)*Math.pow(2,L),Q+=qe):(re=u*Math.pow(2,qe-1)*Math.pow(2,L),Q=0));L>=8;f[p+At]=255&re,At+=gt,re/=256,L-=8);for(Q=Q<<L|re,_e+=L;_e>0;f[p+At]=255&Q,At+=gt,Q/=256,_e-=8);f[p+At-gt]|=128*Mt};function ms(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}ms.Varint=0,ms.Fixed64=1,ms.Bytes=2,ms.Fixed32=5;var th=4294967296,Cp=1/th,hd=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ih(f){return f.type===ms.Bytes?f.readVarint()+f.pos:f.pos+1}function MA(f,u,p){return p?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function Tp(f,u,p){var S=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));p.realloc(S);for(var L=p.pos-1;L>=f;L--)p.buf[L+S]=p.buf[L]}function g0(f,u){for(var p=0;p<f.length;p++)u.writeVarint(f[p])}function PA(f,u){for(var p=0;p<f.length;p++)u.writeSVarint(f[p])}function kp(f,u){for(var p=0;p<f.length;p++)u.writeFloat(f[p])}function Ad(f,u){for(var p=0;p<f.length;p++)u.writeDouble(f[p])}function fd(f,u){for(var p=0;p<f.length;p++)u.writeBoolean(f[p])}function Bm(f,u){for(var p=0;p<f.length;p++)u.writeFixed32(f[p])}function zm(f,u){for(var p=0;p<f.length;p++)u.writeSFixed32(f[p])}function Rm(f,u){for(var p=0;p<f.length;p++)u.writeFixed64(f[p])}function dd(f,u){for(var p=0;p<f.length;p++)u.writeSFixed64(f[p])}function DA(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function hl(f,u,p){f[p]=u,f[p+1]=u>>>8,f[p+2]=u>>>16,f[p+3]=u>>>24}function _0(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}ms.prototype={destroy:function(){this.buf=null},readFields:function(f,u,p){for(p=p||this.length;this.pos<p;){var S=this.readVarint(),L=S>>3,G=this.pos;this.type=7&S,f(L,u,this),this.pos===G&&this.skip(S)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=DA(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=_0(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=DA(this.buf,this.pos)+DA(this.buf,this.pos+4)*th;return this.pos+=8,f},readSFixed64:function(){var f=DA(this.buf,this.pos)+_0(this.buf,this.pos+4)*th;return this.pos+=8,f},readFloat:function(){var f=Sf(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=Sf(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,p,S=this.buf;return u=127&(p=S[this.pos++]),p<128?u:(u|=(127&(p=S[this.pos++]))<<7,p<128?u:(u|=(127&(p=S[this.pos++]))<<14,p<128?u:(u|=(127&(p=S[this.pos++]))<<21,p<128?u:function(L,G,Q){var re,he,_e=Q.buf;if(re=(112&(he=_e[Q.pos++]))>>4,he<128||(re|=(127&(he=_e[Q.pos++]))<<3,he<128)||(re|=(127&(he=_e[Q.pos++]))<<10,he<128)||(re|=(127&(he=_e[Q.pos++]))<<17,he<128)||(re|=(127&(he=_e[Q.pos++]))<<24,he<128)||(re|=(1&(he=_e[Q.pos++]))<<31,he<128))return MA(L,re,G);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(p=S[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&hd?function(p,S,L){return hd.decode(p.subarray(S,L))}(this.buf,u,f):function(p,S,L){for(var G="",Q=S;Q<L;){var re,he,_e,Le=p[Q],qe=null,Je=Le>239?4:Le>223?3:Le>191?2:1;if(Q+Je>L)break;Je===1?Le<128&&(qe=Le):Je===2?(192&(re=p[Q+1]))==128&&(qe=(31&Le)<<6|63&re)<=127&&(qe=null):Je===3?(he=p[Q+2],(192&(re=p[Q+1]))==128&&(192&he)==128&&((qe=(15&Le)<<12|(63&re)<<6|63&he)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):Je===4&&(he=p[Q+2],_e=p[Q+3],(192&(re=p[Q+1]))==128&&(192&he)==128&&(192&_e)==128&&((qe=(15&Le)<<18|(63&re)<<12|(63&he)<<6|63&_e)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,Je=1):qe>65535&&(qe-=65536,G+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),G+=String.fromCharCode(qe),Q+=Je}return G}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==ms.Bytes)return f.push(this.readVarint(u));var p=ih(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==ms.Bytes)return f.push(this.readSVarint());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==ms.Bytes)return f.push(this.readBoolean());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==ms.Bytes)return f.push(this.readFloat());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==ms.Bytes)return f.push(this.readDouble());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==ms.Bytes)return f.push(this.readFixed32());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==ms.Bytes)return f.push(this.readSFixed32());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==ms.Bytes)return f.push(this.readFixed64());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==ms.Bytes)return f.push(this.readSFixed64());var u=ih(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===ms.Varint)for(;this.buf[this.pos++]>127;);else if(u===ms.Bytes)this.pos=this.readVarint()+this.pos;else if(u===ms.Fixed32)this.pos+=4;else{if(u!==ms.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),hl(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),hl(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),hl(this.buf,-1&f,this.pos),hl(this.buf,Math.floor(f*Cp),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),hl(this.buf,-1&f,this.pos),hl(this.buf,Math.floor(f*Cp),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,p){var S,L;if(u>=0?(S=u%4294967296|0,L=u/4294967296|0):(L=~(-u/4294967296),4294967295^(S=~(-u%4294967296))?S=S+1|0:(S=0,L=L+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(G,Q,re){re.buf[re.pos++]=127&G|128,G>>>=7,re.buf[re.pos++]=127&G|128,G>>>=7,re.buf[re.pos++]=127&G|128,G>>>=7,re.buf[re.pos++]=127&G|128,re.buf[re.pos]=127&(G>>>=7)}(S,0,p),function(G,Q){var re=(7&G)<<4;Q.buf[Q.pos++]|=re|((G>>>=3)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G|((G>>>=7)?128:0),G&&(Q.buf[Q.pos++]=127&G)))))}(L,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(S,L,G){for(var Q,re,he=0;he<L.length;he++){if((Q=L.charCodeAt(he))>55295&&Q<57344){if(!re){Q>56319||he+1===L.length?(S[G++]=239,S[G++]=191,S[G++]=189):re=Q;continue}if(Q<56320){S[G++]=239,S[G++]=191,S[G++]=189,re=Q;continue}Q=re-55296<<10|Q-56320|65536,re=null}else re&&(S[G++]=239,S[G++]=191,S[G++]=189,re=null);Q<128?S[G++]=Q:(Q<2048?S[G++]=Q>>6|192:(Q<65536?S[G++]=Q>>12|224:(S[G++]=Q>>18|240,S[G++]=Q>>12&63|128),S[G++]=Q>>6&63|128),S[G++]=63&Q|128)}return G}(this.buf,f,this.pos);var p=this.pos-u;p>=128&&Tp(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),cd(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),cd(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var p=0;p<u;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,u){this.pos++;var p=this.pos;f(u,this);var S=this.pos-p;S>=128&&Tp(p,S,this),this.pos=p-1,this.writeVarint(S),this.pos+=S},writeMessage:function(f,u,p){this.writeTag(f,ms.Bytes),this.writeRawMessage(u,p)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,g0,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,PA,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,fd,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,kp,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,Ad,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,Bm,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,zm,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,Rm,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,dd,u)},writeBytesField:function(f,u){this.writeTag(f,ms.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,ms.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,ms.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,ms.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,ms.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,ms.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,ms.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,ms.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,ms.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,ms.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};var y0=W(m0);const Mc=3;function LA(f,u,p){f===1&&p.readMessage(If,u)}function If(f,u,p){if(f===3){const{id:S,bitmap:L,width:G,height:Q,left:re,top:he,advance:_e}=p.readMessage(BA,{});u.push({id:S,bitmap:new vh({width:G+2*Mc,height:Q+2*Mc},L),metrics:{width:G,height:Q,left:re,top:he,advance:_e}})}}function BA(f,u,p){f===1?u.id=p.readVarint():f===2?u.bitmap=p.readBytes():f===3?u.width=p.readVarint():f===4?u.height=p.readVarint():f===5?u.left=p.readSVarint():f===6?u.top=p.readSVarint():f===7&&(u.advance=p.readVarint())}const Ef=Mc;function Cf(f){let u=0,p=0;for(const Q of f)u+=Q.w*Q.h,p=Math.max(p,Q.w);f.sort((Q,re)=>re.h-Q.h);const S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let L=0,G=0;for(const Q of f)for(let re=S.length-1;re>=0;re--){const he=S[re];if(!(Q.w>he.w||Q.h>he.h)){if(Q.x=he.x,Q.y=he.y,G=Math.max(G,Q.y+Q.h),L=Math.max(L,Q.x+Q.w),Q.w===he.w&&Q.h===he.h){const _e=S.pop();re<S.length&&(S[re]=_e)}else Q.h===he.h?(he.x+=Q.w,he.w-=Q.w):Q.w===he.w?(he.y+=Q.h,he.h-=Q.h):(S.push({x:he.x+Q.w,y:he.y,w:he.w-Q.w,h:Q.h}),he.y+=Q.h,he.h-=Q.h);break}}return{w:L,h:G,fill:u/(L*G)||0}}const wu=1;class v0{constructor(u,{pixelRatio:p,version:S,stretchX:L,stretchY:G,content:Q}){this.paddedRect=u,this.pixelRatio=p,this.stretchX=L,this.stretchY=G,this.content=Q,this.version=S}get tl(){return[this.paddedRect.x+wu,this.paddedRect.y+wu]}get br(){return[this.paddedRect.x+this.paddedRect.w-wu,this.paddedRect.y+this.paddedRect.h-wu]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*wu)/this.pixelRatio,(this.paddedRect.h-2*wu)/this.pixelRatio]}}class Tu{constructor(u,p){const S={},L={};this.haveRenderCallbacks=[];const G=[];this.addImages(u,S,G),this.addImages(p,L,G);const{w:Q,h:re}=Cf(G),he=new Ll({width:Q||1,height:re||1});for(const _e in u){const Le=u[_e],qe=S[_e].paddedRect;Ll.copy(Le.data,he,{x:0,y:0},{x:qe.x+wu,y:qe.y+wu},Le.data)}for(const _e in p){const Le=p[_e],qe=L[_e].paddedRect,Je=qe.x+wu,At=qe.y+wu,gt=Le.data.width,Mt=Le.data.height;Ll.copy(Le.data,he,{x:0,y:0},{x:Je,y:At},Le.data),Ll.copy(Le.data,he,{x:0,y:Mt-1},{x:Je,y:At-1},{width:gt,height:1}),Ll.copy(Le.data,he,{x:0,y:0},{x:Je,y:At+Mt},{width:gt,height:1}),Ll.copy(Le.data,he,{x:gt-1,y:0},{x:Je-1,y:At},{width:1,height:Mt}),Ll.copy(Le.data,he,{x:0,y:0},{x:Je+gt,y:At},{width:1,height:Mt})}this.image=he,this.iconPositions=S,this.patternPositions=L}addImages(u,p,S){for(const L in u){const G=u[L],Q={x:0,y:0,w:G.data.width+2*wu,h:G.data.height+2*wu};S.push(Q),p[L]=new v0(Q,G),G.hasRenderCallback&&this.haveRenderCallbacks.push(L)}}patchUpdatedImages(u,p){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const S in u.updatedImages)this.patchUpdatedImage(this.iconPositions[S],u.getImage(S),p),this.patchUpdatedImage(this.patternPositions[S],u.getImage(S),p)}patchUpdatedImage(u,p,S){if(!u||!p||u.version===p.version)return;u.version=p.version;const[L,G]=u.tl;S.update(p.data,void 0,{x:L,y:G})}}var Ch;Pn("ImagePosition",v0),Pn("ImageAtlas",Tu),a.ai=void 0,(Ch=a.ai||(a.ai={}))[Ch.none=0]="none",Ch[Ch.horizontal=1]="horizontal",Ch[Ch.vertical=2]="vertical",Ch[Ch.horizontalOnly=3]="horizontalOnly";const zA=-17;class RA{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const S=new RA;return S.scale=u||1,S.fontStack=p,S}static forImage(u){const p=new RA;return p.imageName=u,p}}class nh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const S=new nh;for(let L=0;L<u.sections.length;L++){const G=u.sections[L];G.image?S.addImageSection(G):S.addTextSection(G,p)}return S}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let p="";for(let S=0;S<u.length;S++){const L=u.charCodeAt(S+1)||null,G=u.charCodeAt(S-1)||null;p+=L&&Ru(L)&&!bu[u[S+1]]||G&&Ru(G)&&!bu[u[S-1]]||!bu[u[S]]?u[S]:bu[u[S]]}return p}(this.text)}trim(){let u=0;for(let S=0;S<this.text.length&&x0[this.text.charCodeAt(S)];S++)u++;let p=this.text.length;for(let S=this.text.length-1;S>=0&&S>=u&&x0[this.text.charCodeAt(S)];S--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const S=new nh;return S.text=this.text.substring(u,p),S.sectionIndex=this.sectionIndex.slice(u,p),S.sections=this.sections,S}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(RA.forText(u.scale,u.fontStack||p));const S=this.sections.length-1;for(let L=0;L<u.text.length;++L)this.sectionIndex.push(S)}addImageSection(u){const p=u.image?u.image.name:"";if(p.length===0)return void nt("Can't add FormattedSection with an empty image.");const S=this.getNextImageSectionCharCode();S?(this.text+=String.fromCharCode(S),this.sections.push(RA.forImage(p)),this.sectionIndex.push(this.sections.length-1)):nt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function FA(f,u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt){const Pt=nh.fromFeature(f,L);let zt;qe===a.ai.vertical&&Pt.verticalizePunctuation();const{processBidirectionalText:$t,processStyledBidirectionalText:Ht}=ds;if($t&&Pt.sections.length===1){zt=[];const _i=$t(Pt.toString(),Tf(Pt,_e,G,u,S,At,gt));for(const Xi of _i){const xn=new nh;xn.text=Xi,xn.sections=Pt.sections;for(let nn=0;nn<Xi.length;nn++)xn.sectionIndex.push(0);zt.push(xn)}}else if(Ht){zt=[];const _i=Ht(Pt.text,Pt.sectionIndex,Tf(Pt,_e,G,u,S,At,gt));for(const Xi of _i){const xn=new nh;xn.text=Xi[0],xn.sectionIndex=Xi[1],xn.sections=Pt.sections,zt.push(xn)}}else zt=function(_i,Xi){const xn=[],nn=_i.text;let tn=0;for(const hn of Xi)xn.push(_i.substring(tn,hn)),tn=hn;return tn<nn.length&&xn.push(_i.substring(tn,nn.length)),xn}(Pt,Tf(Pt,_e,G,u,S,At,gt));const Zt=[],ui={positionedLines:Zt,text:Pt.toString(),top:Le[1],bottom:Le[1],left:Le[0],right:Le[0],writingMode:qe,iconsInText:!1,verticalizable:!1};return function(_i,Xi,xn,nn,tn,hn,zn,en,Wi,Dn,Rn,dr){let Fr=0,qr=zA,zs=0,Ea=0;const ia=en==="right"?1:en==="left"?0:.5;let is=0;for(const Ds of tn){Ds.trim();const Kn=Ds.getMaxScale(),La=(Kn-1)*Ya,$a={positionedGlyphs:[],lineOffset:0};_i.positionedLines[is]=$a;const va=$a.positionedGlyphs;let Uo=0;if(!Ds.length()){qr+=hn,++is;continue}for(let ra=0;ra<Ds.length();ra++){const br=Ds.getSection(ra),yo=Ds.getSectionIndex(ra),tl=Ds.getCharCode(ra);let il=0,Mu=null,Vu=null,zl=null,zc=Ya;const Uu=!(Wi===a.ai.horizontal||!Rn&&!lu(tl)||Rn&&(x0[tl]||(Wn=tl,Sn.Arabic(Wn)||Sn["Arabic Supplement"](Wn)||Sn["Arabic Extended-A"](Wn)||Sn["Arabic Presentation Forms-A"](Wn)||Sn["Arabic Presentation Forms-B"](Wn))));if(br.imageName){const Gu=nn[br.imageName];if(!Gu)continue;zl=br.imageName,_i.iconsInText=_i.iconsInText||!0,Vu=Gu.paddedRect;const Xl=Gu.displaySize;br.scale=br.scale*Ya/dr,Mu={width:Xl[0],height:Xl[1],left:wu,top:-Ef,advance:Uu?Xl[1]:Xl[0]},il=La+(Ya-Xl[1]*br.scale),zc=Mu.advance;const uh=Uu?Xl[0]*br.scale-Ya*Kn:Xl[1]*br.scale-Ya*Kn;uh>0&&uh>Uo&&(Uo=uh)}else{const Gu=xn[br.fontStack],Xl=Gu&&Gu[tl];if(Xl&&Xl.rect)Vu=Xl.rect,Mu=Xl.metrics;else{const uh=Xi[br.fontStack],rA=uh&&uh[tl];if(!rA)continue;Mu=rA.metrics}il=(Kn-br.scale)*Ya}Uu?(_i.verticalizable=!0,va.push({glyph:tl,imageName:zl,x:Fr,y:qr+il,vertical:Uu,scale:br.scale,fontStack:br.fontStack,sectionIndex:yo,metrics:Mu,rect:Vu}),Fr+=zc*br.scale+Dn):(va.push({glyph:tl,imageName:zl,x:Fr,y:qr+il,vertical:Uu,scale:br.scale,fontStack:br.fontStack,sectionIndex:yo,metrics:Mu,rect:Vu}),Fr+=Mu.advance*br.scale+Dn)}va.length!==0&&(zs=Math.max(Fr-Dn,zs),Om(va,0,va.length-1,ia,Uo)),Fr=0;const so=hn*Kn+Uo;$a.lineOffset=Math.max(Uo,La),qr+=so,Ea=Math.max(so,Ea),++is}var Wn;const xs=qr-zA,{horizontalAlign:tr,verticalAlign:na}=gd(zn);(function(Ds,Kn,La,$a,va,Uo,so,ra,br){const yo=(Kn-La)*va;let tl=0;tl=Uo!==so?-ra*$a-zA:(-$a*br+.5)*so;for(const il of Ds)for(const Mu of il.positionedGlyphs)Mu.x+=yo,Mu.y+=tl})(_i.positionedLines,ia,tr,na,zs,Ea,hn,xs,tn.length),_i.top+=-na*xs,_i.bottom=_i.top+xs,_i.left+=-tr*zs,_i.right=_i.left+zs}(ui,u,p,S,zt,Q,re,he,qe,_e,Je,Mt),!function(_i){for(const Xi of _i)if(Xi.positionedGlyphs.length!==0)return!1;return!0}(Zt)&&ui}const x0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Fm={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pd(f,u,p,S,L,G){if(u.imageName){const Q=S[u.imageName];return Q?Q.displaySize[0]*u.scale*Ya/G+L:0}{const Q=p[u.fontStack],re=Q&&Q[f];return re?re.metrics.advance*u.scale+L:0}}function Th(f,u,p,S){const L=Math.pow(f-u,2);return S?f<u?L/2:2*L:L+Math.abs(p)*p}function Pc(f,u,p){let S=0;return f===10&&(S-=1e4),p&&(S+=150),f!==40&&f!==65288||(S+=50),u!==41&&u!==65289||(S+=50),S}function rh(f,u,p,S,L,G){let Q=null,re=Th(u,p,L,G);for(const he of S){const _e=Th(u-he.x,p,L,G)+he.badness;_e<=re&&(Q=he,re=_e)}return{index:f,x:u,priorBreak:Q,badness:re}}function md(f){return f?md(f.priorBreak).concat(f.index):[]}function Tf(f,u,p,S,L,G,Q){if(G!=="point")return[];if(!f)return[];const re=[],he=function(Je,At,gt,Mt,Pt,zt){let $t=0;for(let Ht=0;Ht<Je.length();Ht++){const Zt=Je.getSection(Ht);$t+=pd(Je.getCharCode(Ht),Zt,Mt,Pt,At,zt)}return $t/Math.max(1,Math.ceil($t/gt))}(f,u,p,S,L,Q),_e=f.text.indexOf("")>=0;let Le=0;for(let Je=0;Je<f.length();Je++){const At=f.getSection(Je),gt=f.getCharCode(Je);if(x0[gt]||(Le+=pd(gt,At,S,L,u,Q)),Je<f.length()-1){const Mt=!((qe=gt)<11904||!(Sn["Bopomofo Extended"](qe)||Sn.Bopomofo(qe)||Sn["CJK Compatibility Forms"](qe)||Sn["CJK Compatibility Ideographs"](qe)||Sn["CJK Compatibility"](qe)||Sn["CJK Radicals Supplement"](qe)||Sn["CJK Strokes"](qe)||Sn["CJK Symbols and Punctuation"](qe)||Sn["CJK Unified Ideographs Extension A"](qe)||Sn["CJK Unified Ideographs"](qe)||Sn["Enclosed CJK Letters and Months"](qe)||Sn["Halfwidth and Fullwidth Forms"](qe)||Sn.Hiragana(qe)||Sn["Ideographic Description Characters"](qe)||Sn["Kangxi Radicals"](qe)||Sn["Katakana Phonetic Extensions"](qe)||Sn.Katakana(qe)||Sn["Vertical Forms"](qe)||Sn["Yi Radicals"](qe)||Sn["Yi Syllables"](qe)));(Fm[gt]||Mt||At.imageName)&&re.push(rh(Je+1,Le,he,re,Pc(gt,f.getCharCode(Je+1),Mt&&_e),!1))}}var qe;return md(rh(f.length(),Le,he,re,0,!0))}function gd(f){let u=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function Om(f,u,p,S,L){if(!S&&!L)return;const G=f[p],Q=(f[p].x+G.metrics.advance*G.scale)*S;for(let re=u;re<=p;re++)f[re].x-=Q,f[re].y+=L}function b0(f,u,p){const{horizontalAlign:S,verticalAlign:L}=gd(p),G=u[0]-f.displaySize[0]*S,Q=u[1]-f.displaySize[1]*L;return{image:f,top:Q,bottom:Q+f.displaySize[1],left:G,right:G+f.displaySize[0]}}function w0(f,u,p,S,L,G){const Q=f.image;let re;if(Q.content){const Pt=Q.content,zt=Q.pixelRatio||1;re=[Pt[0]/zt,Pt[1]/zt,Q.displaySize[0]-Pt[2]/zt,Q.displaySize[1]-Pt[3]/zt]}const he=u.left*G,_e=u.right*G;let Le,qe,Je,At;p==="width"||p==="both"?(At=L[0]+he-S[3],qe=L[0]+_e+S[1]):(At=L[0]+(he+_e-Q.displaySize[0])/2,qe=At+Q.displaySize[0]);const gt=u.top*G,Mt=u.bottom*G;return p==="height"||p==="both"?(Le=L[1]+gt-S[0],Je=L[1]+Mt+S[2]):(Le=L[1]+(gt+Mt-Q.displaySize[1])/2,Je=Le+Q.displaySize[1]),{image:Q,top:Le,right:qe,bottom:Je,left:At,collisionPadding:re}}const kf=255,Yu=128,Dc=kf*Yu;function eA(f,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new pn(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:S,interpolationType:L}=p;let G=0;for(;G<S.length&&S[G]<=f;)G++;G=Math.max(0,G-1);let Q=G;for(;Q<S.length&&S[Q]<f+1;)Q++;Q=Math.min(S.length-1,Q);const re=S[G],he=S[Q];return p.kind==="composite"?{kind:"composite",minZoom:re,maxZoom:he,interpolationType:L}:{kind:"camera",minZoom:re,maxZoom:he,minSize:p.evaluate(new pn(re)),maxSize:p.evaluate(new pn(he)),interpolationType:L}}}function S0(f,u,p){let S="never";const L=f.get(u);return L?S=L:f.get(p)&&(S="always"),S}const Mp=Sh.VectorTileFeature.types,_d=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Mf(f,u,p,S,L,G,Q,re,he,_e,Le,qe,Je){const At=re?Math.min(Dc,Math.round(re[0])):0,gt=re?Math.min(Dc,Math.round(re[1])):0;f.emplaceBack(u,p,Math.round(32*S),Math.round(32*L),G,Q,(At<<1)+(he?1:0),gt,16*_e,16*Le,256*qe,256*Je)}function OA(f,u,p){f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p)}function Pp(f){for(const u of f.sections)if(ta(u.text))return!0;return!1}class yd{constructor(u){this.layoutVertexArray=new Zi,this.indexArray=new Bn,this.programConfigurations=u,this.segments=new er,this.dynamicLayoutVertexArray=new Ii,this.opacityVertexArray=new Vi,this.hasVisibleVertices=!1,this.placedSymbolArray=new ue}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,p,S,L){this.isEmpty()||(S&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,od.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,ld.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,_d,!0),this.opacityVertexBuffer.itemSize=1),(S||L)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pn("SymbolBuffers",yd);class vd{constructor(u,p,S){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new S,this.segments=new er,this.collisionVertexArray=new an}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,fa.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pn("CollisionBuffers",vd);class sh{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(Q=>Q.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Hh([]),this.placementViewportMatrix=Hh([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=eA(this.zoom,p["text-size"]),this.iconSizeData=eA(this.zoom,p["icon-size"]);const S=this.layers[0].layout,L=S.get("symbol-sort-key"),G=S.get("symbol-z-order");this.canOverlap=S0(S,"text-overlap","text-allow-overlap")!=="never"||S0(S,"icon-overlap","icon-allow-overlap")!=="never"||S.get("text-ignore-placement")||S.get("icon-ignore-placement"),this.sortFeaturesByKey=G!=="viewport-y"&&!L.isConstant(),this.sortFeaturesByY=(G==="viewport-y"||G==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,S.get("symbol-placement")==="point"&&(this.writingModes=S.get("text-writing-mode").map(Q=>a.ai[Q])),this.stateDependentLayerIds=this.layers.filter(Q=>Q.isStateDependent()).map(Q=>Q.id),this.sourceID=u.sourceID}createArrays(){this.text=new yd(new hu(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new yd(new hu(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new Re,this.lineVertexArray=new Be,this.symbolInstances=new Te,this.textAnchorOffsets=new vt}calculateGlyphDependencies(u,p,S,L,G){for(let Q=0;Q<u.length;Q++)if(p[u.charCodeAt(Q)]=!0,(S||L)&&G){const re=bu[u.charAt(Q)];re&&(p[re.charCodeAt(0)]=!0)}}populate(u,p,S){const L=this.layers[0],G=L.layout,Q=G.get("text-font"),re=G.get("text-field"),he=G.get("icon-image"),_e=(re.value.kind!=="constant"||re.value.value instanceof Qt&&!re.value.value.isEmpty()||re.value.value.toString().length>0)&&(Q.value.kind!=="constant"||Q.value.value.length>0),Le=he.value.kind!=="constant"||!!he.value.value||Object.keys(he.parameters).length>0,qe=G.get("symbol-sort-key");if(this.features=[],!_e&&!Le)return;const Je=p.iconDependencies,At=p.glyphDependencies,gt=p.availableImages,Mt=new pn(this.zoom);for(const{feature:Pt,id:zt,index:$t,sourceLayerIndex:Ht}of u){const Zt=L._featureFilter.needGeometry,ui=Ic(Pt,Zt);if(!L._featureFilter.filter(Mt,ui,S))continue;let _i,Xi;if(Zt||(ui.geometry=Vh(Pt)),_e){const nn=L.getValueAndResolveTokens("text-field",ui,S,gt),tn=Qt.factory(nn);Pp(tn)&&(this.hasRTLText=!0),(!this.hasRTLText||Ou()==="unavailable"||this.hasRTLText&&ds.isParsed())&&(_i=kA(tn,L,ui))}if(Le){const nn=L.getValueAndResolveTokens("icon-image",ui,S,gt);Xi=nn instanceof ur?nn:ur.fromString(nn)}if(!_i&&!Xi)continue;const xn=this.sortFeaturesByKey?qe.evaluate(ui,{},S):void 0;if(this.features.push({id:zt,text:_i,icon:Xi,index:$t,sourceLayerIndex:Ht,geometry:ui.geometry,properties:Pt.properties,type:Mp[Pt.type],sortKey:xn}),Xi&&(Je[Xi.name]=!0),_i){const nn=Q.evaluate(ui,{},S).join(","),tn=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ai.vertical)>=0;for(const hn of _i.sections)if(hn.image)Je[hn.image.name]=!0;else{const zn=Hl(_i.toString()),en=hn.fontStack||nn,Wi=At[en]=At[en]||{};this.calculateGlyphDependencies(hn.text,Wi,tn,this.allowVerticalPlacement,zn)}}}G.get("symbol-placement")==="line"&&(this.features=function(Pt){const zt={},$t={},Ht=[];let Zt=0;function ui(nn){Ht.push(Pt[nn]),Zt++}function _i(nn,tn,hn){const zn=$t[nn];return delete $t[nn],$t[tn]=zn,Ht[zn].geometry[0].pop(),Ht[zn].geometry[0]=Ht[zn].geometry[0].concat(hn[0]),zn}function Xi(nn,tn,hn){const zn=zt[tn];return delete zt[tn],zt[nn]=zn,Ht[zn].geometry[0].shift(),Ht[zn].geometry[0]=hn[0].concat(Ht[zn].geometry[0]),zn}function xn(nn,tn,hn){const zn=hn?tn[0][tn[0].length-1]:tn[0][0];return`${nn}:${zn.x}:${zn.y}`}for(let nn=0;nn<Pt.length;nn++){const tn=Pt[nn],hn=tn.geometry,zn=tn.text?tn.text.toString():null;if(!zn){ui(nn);continue}const en=xn(zn,hn),Wi=xn(zn,hn,!0);if(en in $t&&Wi in zt&&$t[en]!==zt[Wi]){const Dn=Xi(en,Wi,hn),Rn=_i(en,Wi,Ht[Dn].geometry);delete zt[en],delete $t[Wi],$t[xn(zn,Ht[Rn].geometry,!0)]=Rn,Ht[Dn].geometry=null}else en in $t?_i(en,Wi,hn):Wi in zt?Xi(en,Wi,hn):(ui(nn),zt[en]=Zt-1,$t[Wi]=Zt-1)}return Ht.filter(nn=>nn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Pt,zt)=>Pt.sortKey-zt.sortKey)}update(u,p,S){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,p,this.layers,S),this.icon.programConfigurations.updatePaintArrays(u,p,this.layers,S))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const S=this.lineVertexArray.length;if(u.segment!==void 0){let L=u.dist(p[u.segment+1]),G=u.dist(p[u.segment]);const Q={};for(let re=u.segment+1;re<p.length;re++)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:L},re<p.length-1&&(L+=p[re+1].dist(p[re]));for(let re=u.segment||0;re>=0;re--)Q[re]={x:p[re].x,y:p[re].y,tileUnitDistanceFromAnchor:G},re>0&&(G+=p[re-1].dist(p[re]));for(let re=0;re<p.length;re++){const he=Q[re];this.lineVertexArray.emplaceBack(he.x,he.y,he.tileUnitDistanceFromAnchor)}}return{lineStartIndex:S,lineLength:this.lineVertexArray.length-S}}addSymbols(u,p,S,L,G,Q,re,he,_e,Le,qe,Je){const At=u.indexArray,gt=u.layoutVertexArray,Mt=u.segments.prepareSegment(4*p.length,gt,At,this.canOverlap?Q.sortKey:void 0),Pt=this.glyphOffsetArray.length,zt=Mt.vertexLength,$t=this.allowVerticalPlacement&&re===a.ai.vertical?Math.PI/2:0,Ht=Q.text&&Q.text.sections;for(let Zt=0;Zt<p.length;Zt++){const{tl:ui,tr:_i,bl:Xi,br:xn,tex:nn,pixelOffsetTL:tn,pixelOffsetBR:hn,minFontScaleX:zn,minFontScaleY:en,glyphOffset:Wi,isSDF:Dn,sectionIndex:Rn}=p[Zt],dr=Mt.vertexLength,Fr=Wi[1];Mf(gt,he.x,he.y,ui.x,Fr+ui.y,nn.x,nn.y,S,Dn,tn.x,tn.y,zn,en),Mf(gt,he.x,he.y,_i.x,Fr+_i.y,nn.x+nn.w,nn.y,S,Dn,hn.x,tn.y,zn,en),Mf(gt,he.x,he.y,Xi.x,Fr+Xi.y,nn.x,nn.y+nn.h,S,Dn,tn.x,hn.y,zn,en),Mf(gt,he.x,he.y,xn.x,Fr+xn.y,nn.x+nn.w,nn.y+nn.h,S,Dn,hn.x,hn.y,zn,en),OA(u.dynamicLayoutVertexArray,he,$t),At.emplaceBack(dr,dr+1,dr+2),At.emplaceBack(dr+1,dr+2,dr+3),Mt.vertexLength+=4,Mt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Wi[0]),Zt!==p.length-1&&Rn===p[Zt+1].sectionIndex||u.programConfigurations.populatePaintArrays(gt.length,Q,Q.index,{},Je,Ht&&Ht[Rn])}u.placedSymbolArray.emplaceBack(he.x,he.y,Pt,this.glyphOffsetArray.length-Pt,zt,_e,Le,he.segment,S?S[0]:0,S?S[1]:0,L[0],L[1],re,0,!1,0,qe)}_addCollisionDebugVertex(u,p,S,L,G,Q){return p.emplaceBack(0,0),u.emplaceBack(S.x,S.y,L,G,Math.round(Q.x),Math.round(Q.y))}addCollisionDebugVertices(u,p,S,L,G,Q,re){const he=G.segments.prepareSegment(4,G.layoutVertexArray,G.indexArray),_e=he.vertexLength,Le=G.layoutVertexArray,qe=G.collisionVertexArray,Je=re.anchorX,At=re.anchorY;this._addCollisionDebugVertex(Le,qe,Q,Je,At,new fe(u,p)),this._addCollisionDebugVertex(Le,qe,Q,Je,At,new fe(S,p)),this._addCollisionDebugVertex(Le,qe,Q,Je,At,new fe(S,L)),this._addCollisionDebugVertex(Le,qe,Q,Je,At,new fe(u,L)),he.vertexLength+=4;const gt=G.indexArray;gt.emplaceBack(_e,_e+1),gt.emplaceBack(_e+1,_e+2),gt.emplaceBack(_e+2,_e+3),gt.emplaceBack(_e+3,_e),he.primitiveLength+=4}addDebugCollisionBoxes(u,p,S,L){for(let G=u;G<p;G++){const Q=this.collisionBoxArray.get(G);this.addCollisionDebugVertices(Q.x1,Q.y1,Q.x2,Q.y2,L?this.textCollisionBox:this.iconCollisionBox,Q.anchorPoint,S)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vd(Ui,TA.members,Ji),this.iconCollisionBox=new vd(Ui,TA.members,Ji);for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(u,p,S,L,G,Q,re,he,_e){const Le={};for(let qe=p;qe<S;qe++){const Je=u.get(qe);Le.textBox={x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,anchorPointX:Je.anchorPointX,anchorPointY:Je.anchorPointY},Le.textFeatureIndex=Je.featureIndex;break}for(let qe=L;qe<G;qe++){const Je=u.get(qe);Le.verticalTextBox={x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,anchorPointX:Je.anchorPointX,anchorPointY:Je.anchorPointY},Le.verticalTextFeatureIndex=Je.featureIndex;break}for(let qe=Q;qe<re;qe++){const Je=u.get(qe);Le.iconBox={x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,anchorPointX:Je.anchorPointX,anchorPointY:Je.anchorPointY},Le.iconFeatureIndex=Je.featureIndex;break}for(let qe=he;qe<_e;qe++){const Je=u.get(qe);Le.verticalIconBox={x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,anchorPointX:Je.anchorPointX,anchorPointY:Je.anchorPointY},Le.verticalIconFeatureIndex=Je.featureIndex;break}return Le}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const S=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,S.textBoxStartIndex,S.textBoxEndIndex,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S.iconBoxStartIndex,S.iconBoxEndIndex,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,p){const S=u.placedSymbolArray.get(p),L=S.vertexStartIndex+4*S.numGlyphs;for(let G=S.vertexStartIndex;G<L;G+=4)u.indexArray.emplaceBack(G,G+1,G+2),u.indexArray.emplaceBack(G+1,G+2,G+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),S=Math.cos(u),L=[],G=[],Q=[];for(let re=0;re<this.symbolInstances.length;++re){Q.push(re);const he=this.symbolInstances.get(re);L.push(0|Math.round(p*he.anchorX+S*he.anchorY)),G.push(he.featureIndex)}return Q.sort((re,he)=>L[re]-L[he]||G[he]-G[re]),Q}addToSortKeyRanges(u,p){const S=this.sortKeyRanges[this.sortKeyRanges.length-1];S&&S.sortKey===p?S.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const S=this.symbolInstances.get(p);this.featureSortOrder.push(S.featureIndex),[S.rightJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.leftJustifiedTextSymbolIndex].forEach((L,G,Q)=>{L>=0&&Q.indexOf(L)===G&&this.addIndicesForPlacedSymbol(this.text,L)}),S.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,S.verticalPlacedTextSymbolIndex),S.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,S.placedIconSymbolIndex),S.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,S.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let xd,Dp;Pn("SymbolBucket",sh,{omit:["layers","collisionBoxArray","features","compareText"]}),sh.MAX_GLYPHS=65535,sh.addDynamicAttributes=OA;var bd={get paint(){return Dp=Dp||new cs({"icon-opacity":new zi(fi.paint_symbol["icon-opacity"]),"icon-color":new zi(fi.paint_symbol["icon-color"]),"icon-halo-color":new zi(fi.paint_symbol["icon-halo-color"]),"icon-halo-width":new zi(fi.paint_symbol["icon-halo-width"]),"icon-halo-blur":new zi(fi.paint_symbol["icon-halo-blur"]),"icon-translate":new Mi(fi.paint_symbol["icon-translate"]),"icon-translate-anchor":new Mi(fi.paint_symbol["icon-translate-anchor"]),"text-opacity":new zi(fi.paint_symbol["text-opacity"]),"text-color":new zi(fi.paint_symbol["text-color"],{runtimeType:ft,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new zi(fi.paint_symbol["text-halo-color"]),"text-halo-width":new zi(fi.paint_symbol["text-halo-width"]),"text-halo-blur":new zi(fi.paint_symbol["text-halo-blur"]),"text-translate":new Mi(fi.paint_symbol["text-translate"]),"text-translate-anchor":new Mi(fi.paint_symbol["text-translate-anchor"])})},get layout(){return xd=xd||new cs({"symbol-placement":new Mi(fi.layout_symbol["symbol-placement"]),"symbol-spacing":new Mi(fi.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Mi(fi.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new zi(fi.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Mi(fi.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Mi(fi.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Mi(fi.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Mi(fi.layout_symbol["icon-ignore-placement"]),"icon-optional":new Mi(fi.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Mi(fi.layout_symbol["icon-rotation-alignment"]),"icon-size":new zi(fi.layout_symbol["icon-size"]),"icon-text-fit":new Mi(fi.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Mi(fi.layout_symbol["icon-text-fit-padding"]),"icon-image":new zi(fi.layout_symbol["icon-image"]),"icon-rotate":new zi(fi.layout_symbol["icon-rotate"]),"icon-padding":new zi(fi.layout_symbol["icon-padding"]),"icon-keep-upright":new Mi(fi.layout_symbol["icon-keep-upright"]),"icon-offset":new zi(fi.layout_symbol["icon-offset"]),"icon-anchor":new zi(fi.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Mi(fi.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Mi(fi.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Mi(fi.layout_symbol["text-rotation-alignment"]),"text-field":new zi(fi.layout_symbol["text-field"]),"text-font":new zi(fi.layout_symbol["text-font"]),"text-size":new zi(fi.layout_symbol["text-size"]),"text-max-width":new zi(fi.layout_symbol["text-max-width"]),"text-line-height":new Mi(fi.layout_symbol["text-line-height"]),"text-letter-spacing":new zi(fi.layout_symbol["text-letter-spacing"]),"text-justify":new zi(fi.layout_symbol["text-justify"]),"text-radial-offset":new zi(fi.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Mi(fi.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new zi(fi.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new zi(fi.layout_symbol["text-anchor"]),"text-max-angle":new Mi(fi.layout_symbol["text-max-angle"]),"text-writing-mode":new Mi(fi.layout_symbol["text-writing-mode"]),"text-rotate":new zi(fi.layout_symbol["text-rotate"]),"text-padding":new Mi(fi.layout_symbol["text-padding"]),"text-keep-upright":new Mi(fi.layout_symbol["text-keep-upright"]),"text-transform":new zi(fi.layout_symbol["text-transform"]),"text-offset":new zi(fi.layout_symbol["text-offset"]),"text-allow-overlap":new Mi(fi.layout_symbol["text-allow-overlap"]),"text-overlap":new Mi(fi.layout_symbol["text-overlap"]),"text-ignore-placement":new Mi(fi.layout_symbol["text-ignore-placement"]),"text-optional":new Mi(fi.layout_symbol["text-optional"])})}};class Lp{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:Qe,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pn("FormatSectionOverride",Lp,{omit:["defaultValue"]});class NA extends Ps{constructor(u){super(u,bd)}recalculate(u,p){if(super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const S=this.layout.get("text-writing-mode");if(S){const L=[];for(const G of S)L.indexOf(G)<0&&L.push(G);this.layout._values["text-writing-mode"]=L}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,p,S,L){const G=this.layout.get(u).evaluate(p,{},S,L),Q=this._unevaluatedLayout._values[u];return Q.isDataDriven()||Jr(Q.value)||!G?G:function(re,he){return he.replace(/{([^{}]+)}/g,(_e,Le)=>re&&Le in re?String(re[Le]):"")}(p.properties,G)}createBucket(u){return new sh(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of bd.paint.overridableProperties){if(!NA.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),S=new Lp(p),L=new Ol(S,p.property.specification);let G=null;G=p.value.kind==="constant"||p.value.kind==="source"?new ks("source",L):new Cr("composite",L,p.value.zoomStops),this.paint._values[u]=new _s(p.property,G,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,S){return!(!this.layout||p.isDataDriven()||S.isDataDriven())&&NA.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const S=u.get("text-field"),L=bd.paint.properties[p];let G=!1;const Q=re=>{for(const he of re)if(L.overrides&&L.overrides.hasOverride(he))return void(G=!0)};if(S.value.kind==="constant"&&S.value.value instanceof Qt)Q(S.value.value.sections);else if(S.value.kind==="source"){const re=_e=>{G||(_e instanceof Lt&&Vt(_e.value)===ne?Q(_e.value.sections):_e instanceof to?Q(_e.sections):_e.eachChild(re))},he=S.value;he._styleExpression&&re(he._styleExpression.expression)}return G}}let ah;var Bp={get paint(){return ah=ah||new cs({"background-color":new Mi(fi.paint_background["background-color"]),"background-pattern":new yu(fi.paint_background["background-pattern"]),"background-opacity":new Mi(fi.paint_background["background-opacity"])})}};class zp extends Ps{constructor(u){super(u,Bp)}}let wd;var Sd={get paint(){return wd=wd||new cs({"raster-opacity":new Mi(fi.paint_raster["raster-opacity"]),"raster-hue-rotate":new Mi(fi.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Mi(fi.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Mi(fi.paint_raster["raster-brightness-max"]),"raster-saturation":new Mi(fi.paint_raster["raster-saturation"]),"raster-contrast":new Mi(fi.paint_raster["raster-contrast"]),"raster-resampling":new Mi(fi.paint_raster["raster-resampling"]),"raster-fade-duration":new Mi(fi.paint_raster["raster-fade-duration"])})}};class Rp extends Ps{constructor(u){super(u,Sd)}}class VA extends Ps{constructor(u){super(u,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class I0{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const E0=63710088e-1;class Lc{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Lc(ni(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,S=this.lat*p,L=u.lat*p,G=Math.sin(S)*Math.sin(L)+Math.cos(S)*Math.cos(L)*Math.cos((u.lng-this.lng)*p);return E0*Math.acos(Math.min(G,1))}static convert(u){if(u instanceof Lc)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new Lc(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new Lc(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Id=2*Math.PI*E0;function ku(f){return Id*Math.cos(f*Math.PI/180)}function UA(f){return(180+f)/360}function Ed(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Cd(f,u){return f/ku(u)}function Td(f){return 360*f-180}function C0(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class Pf{constructor(u,p,S=0){this.x=+u,this.y=+p,this.z=+S}static fromLngLat(u,p=0){const S=Lc.convert(u);return new Pf(UA(S.lng),Ed(S.lat),Cd(p,S.lat))}toLngLat(){return new Lc(Td(this.x),C0(this.y))}toAltitude(){return this.z*ku(C0(this.y))}meterInMercatorCoordinateUnits(){return 1/Id*(u=C0(this.y),1/Math.cos(u*Math.PI/180));var u}}function kd(f,u,p){var S=2*Math.PI*6378137/256/Math.pow(2,p);return[f*S-2*Math.PI*6378137/2,u*S-2*Math.PI*6378137/2]}class Md{constructor(u,p,S){if(u<0||u>25||S<0||S>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))throw new Error(`x=${p}, y=${S}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=p,this.y=S,this.key=GA(0,u,u,p,S)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p,S){const L=(Q=this.y,re=this.z,he=kd(256*(G=this.x),256*(Q=Math.pow(2,re)-Q-1),re),_e=kd(256*(G+1),256*(Q+1),re),he[0]+","+he[1]+","+_e[0]+","+_e[1]);var G,Q,re,he,_e;const Le=function(qe,Je,At){let gt,Mt="";for(let Pt=qe;Pt>0;Pt--)gt=1<<Pt-1,Mt+=(Je&gt?1:0)+(At&gt?2:0);return Mt}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(S==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Le).replace(/{bbox-epsg-3857}/g,L)}isChildOf(u){const p=this.z-u.z;return p>0&&u.x===this.x>>p&&u.y===this.y>>p}getTilePoint(u){const p=Math.pow(2,this.z);return new fe((u.x*p-this.x)*Pa,(u.y*p-this.y)*Pa)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Pd{constructor(u,p){this.wrap=u,this.canonical=p,this.key=GA(u,p.z,p.z,p.x,p.y)}}class bl{constructor(u,p,S,L,G){if(u<S)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${S}`);this.overscaledZ=u,this.wrap=p,this.canonical=new Md(S,+L,+G),this.key=GA(p,u,S,L,G)}clone(){return new bl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-u;return u>this.canonical.z?new bl(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bl(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const S=this.canonical.z-u;return u>this.canonical.z?GA(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y):GA(this.wrap*+p,u,u,this.canonical.x>>S,this.canonical.y>>S)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new bl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,S=2*this.canonical.x,L=2*this.canonical.y;return[new bl(p,this.wrap,p,S,L),new bl(p,this.wrap,p,S+1,L),new bl(p,this.wrap,p,S,L+1),new bl(p,this.wrap,p,S+1,L+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new bl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new bl(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Pd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new Pf(u.x-this.wrap,u.y))}}function GA(f,u,p,S,L){(f*=2)<0&&(f=-1*f-1);const G=1<<p;return(G*G*f+G*L+S).toString(36)+p.toString(36)+u.toString(36)}Pn("CanonicalTileID",Md),Pn("OverscaledTileID",bl,{omit:["posMatrix"]});class T0{constructor(u,p,S,L=1,G=1,Q=1,re=0){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(S&&!["mapbox","terrarium","custom"].includes(S))return void nt(`"${S}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=p.height;const he=this.dim=p.height-2;switch(this.data=new Uint32Array(p.data.buffer),S){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=L,this.greenFactor=G,this.blueFactor=Q,this.baseShift=re;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let _e=0;_e<he;_e++)this.data[this._idx(-1,_e)]=this.data[this._idx(0,_e)],this.data[this._idx(he,_e)]=this.data[this._idx(he-1,_e)],this.data[this._idx(_e,-1)]=this.data[this._idx(_e,0)],this.data[this._idx(_e,he)]=this.data[this._idx(_e,he-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(he,-1)]=this.data[this._idx(he-1,0)],this.data[this._idx(-1,he)]=this.data[this._idx(0,he-1)],this.data[this._idx(he,he)]=this.data[this._idx(he-1,he-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let _e=0;_e<he;_e++)for(let Le=0;Le<he;Le++){const qe=this.get(_e,Le);qe>this.max&&(this.max=qe),qe<this.min&&(this.min=qe)}}get(u,p){const S=new Uint8Array(this.data.buffer),L=4*this._idx(u,p);return this.unpack(S[L],S[L+1],S[L+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}unpack(u,p,S){return u*this.redFactor+p*this.greenFactor+S*this.blueFactor-this.baseShift}getPixels(){return new Ll({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,p,S){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let L=p*this.dim,G=p*this.dim+this.dim,Q=S*this.dim,re=S*this.dim+this.dim;switch(p){case-1:L=G-1;break;case 1:G=L+1}switch(S){case-1:Q=re-1;break;case 1:re=Q+1}const he=-p*this.dim,_e=-S*this.dim;for(let Le=Q;Le<re;Le++)for(let qe=L;qe<G;qe++)this.data[this._idx(qe,Le)]=u.data[this._idx(qe+he,Le+_e)]}}Pn("DEMData",T0);class k0{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const S=u[p];this._stringToNumber[S]=p,this._numberToString[p]=S}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class Dd{constructor(u,p,S,L,G){this.type="Feature",this._vectorTileFeature=u,u._z=p,u._x=S,u._y=L,this.properties=u.properties,this.id=G}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(u[p]=this[p]);return u}}class Fp{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new mo(Pa,16,0),this.grid3D=new mo(Pa,16,0),this.featureIndexArray=new ct,this.promoteId=p}insert(u,p,S,L,G,Q){const re=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(S,L,G);const he=Q?this.grid3D:this.grid;for(let _e=0;_e<p.length;_e++){const Le=p[_e],qe=[1/0,1/0,-1/0,-1/0];for(let Je=0;Je<Le.length;Je++){const At=Le[Je];qe[0]=Math.min(qe[0],At.x),qe[1]=Math.min(qe[1],At.y),qe[2]=Math.max(qe[2],At.x),qe[3]=Math.max(qe[3],At.y)}qe[0]<Pa&&qe[1]<Pa&&qe[2]>=0&&qe[3]>=0&&he.insert(re,qe[0],qe[1],qe[2],qe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Sh.VectorTile(new y0(this.rawTileData)).layers,this.sourceLayerCoder=new k0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,p,S,L){this.loadVTLayers();const G=u.params||{},Q=Pa/u.tileSize/u.scale,re=Zr(G.filter),he=u.queryGeometry,_e=u.queryPadding*Q,Le=Ld(he),qe=this.grid.query(Le.minX-_e,Le.minY-_e,Le.maxX+_e,Le.maxY+_e),Je=Ld(u.cameraQueryGeometry),At=this.grid3D.query(Je.minX-_e,Je.minY-_e,Je.maxX+_e,Je.maxY+_e,(Pt,zt,$t,Ht)=>function(Zt,ui,_i,Xi,xn){for(const tn of Zt)if(ui<=tn.x&&_i<=tn.y&&Xi>=tn.x&&xn>=tn.y)return!0;const nn=[new fe(ui,_i),new fe(ui,xn),new fe(Xi,xn),new fe(Xi,_i)];if(Zt.length>2){for(const tn of nn)if(Xu(Zt,tn))return!0}for(let tn=0;tn<Zt.length-1;tn++)if(j0(Zt[tn],Zt[tn+1],nn))return!0;return!1}(u.cameraQueryGeometry,Pt-_e,zt-_e,$t+_e,Ht+_e));for(const Pt of At)qe.push(Pt);qe.sort(oh);const gt={};let Mt;for(let Pt=0;Pt<qe.length;Pt++){const zt=qe[Pt];if(zt===Mt)continue;Mt=zt;const $t=this.featureIndexArray.get(zt);let Ht=null;this.loadMatchingFeature(gt,$t.bucketIndex,$t.sourceLayerIndex,$t.featureIndex,re,G.layers,G.availableImages,p,S,L,(Zt,ui,_i)=>(Ht||(Ht=Vh(Zt)),ui.queryIntersectsFeature(he,Zt,_i,Ht,this.z,u.transform,Q,u.pixelPosMatrix)))}return gt}loadMatchingFeature(u,p,S,L,G,Q,re,he,_e,Le,qe){const Je=this.bucketLayerIDs[p];if(Q&&!function(Pt,zt){for(let $t=0;$t<Pt.length;$t++)if(zt.indexOf(Pt[$t])>=0)return!0;return!1}(Q,Je))return;const At=this.sourceLayerCoder.decode(S),gt=this.vtLayers[At].feature(L);if(G.needGeometry){const Pt=Ic(gt,!0);if(!G.filter(new pn(this.tileID.overscaledZ),Pt,this.tileID.canonical))return}else if(!G.filter(new pn(this.tileID.overscaledZ),gt))return;const Mt=this.getId(gt,At);for(let Pt=0;Pt<Je.length;Pt++){const zt=Je[Pt];if(Q&&Q.indexOf(zt)<0)continue;const $t=he[zt];if(!$t)continue;let Ht={};Mt&&Le&&(Ht=Le.getState($t.sourceLayer||"_geojsonTileLayer",Mt));const Zt=it({},_e[zt]);Zt.paint=Op(Zt.paint,$t.paint,gt,Ht,re),Zt.layout=Op(Zt.layout,$t.layout,gt,Ht,re);const ui=!qe||qe(gt,$t,Ht);if(!ui)continue;const _i=new Dd(gt,this.z,this.x,this.y,Mt);_i.layer=Zt;let Xi=u[zt];Xi===void 0&&(Xi=u[zt]=[]),Xi.push({featureIndex:L,feature:_i,intersectionZ:ui})}}lookupSymbolFeatures(u,p,S,L,G,Q,re,he){const _e={};this.loadVTLayers();const Le=Zr(G);for(const qe of u)this.loadMatchingFeature(_e,S,L,qe,Le,Q,re,he,p);return _e}hasLayer(u){for(const p of this.bucketLayerIDs)for(const S of p)if(u===S)return!0;return!1}getId(u,p){let S=u.id;return this.promoteId&&(S=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof S=="boolean"&&(S=Number(S))),S}}function Op(f,u,p,S,L){return _t(f,(G,Q)=>{const re=u instanceof Co?u.get(Q):null;return re&&re.evaluate?re.evaluate(p,S,L):re})}function Ld(f){let u=1/0,p=1/0,S=-1/0,L=-1/0;for(const G of f)u=Math.min(u,G.x),p=Math.min(p,G.y),S=Math.max(S,G.x),L=Math.max(L,G.y);return{minX:u,minY:p,maxX:S,maxY:L}}function oh(f,u){return u-f}function Bd(f,u,p,S,L){const G=[];for(let Q=0;Q<f.length;Q++){const re=f[Q];let he;for(let _e=0;_e<re.length-1;_e++){let Le=re[_e],qe=re[_e+1];Le.x<u&&qe.x<u||(Le.x<u?Le=new fe(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x<u&&(qe=new fe(u,Le.y+(u-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y<p&&qe.y<p||(Le.y<p?Le=new fe(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round():qe.y<p&&(qe=new fe(Le.x+(p-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),p)._round()),Le.x>=S&&qe.x>=S||(Le.x>=S?Le=new fe(S,Le.y+(S-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round():qe.x>=S&&(qe=new fe(S,Le.y+(S-Le.x)/(qe.x-Le.x)*(qe.y-Le.y))._round()),Le.y>=L&&qe.y>=L||(Le.y>=L?Le=new fe(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round():qe.y>=L&&(qe=new fe(Le.x+(L-Le.y)/(qe.y-Le.y)*(qe.x-Le.x),L)._round()),he&&Le.equals(he[he.length-1])||(he=[Le],G.push(he)),he.push(qe)))))}}return G}Pn("FeatureIndex",Fp,{omit:["rawTileData","sourceLayerCoder"]});class hc extends fe{constructor(u,p,S,L){super(u,p),this.angle=S,L!==void 0&&(this.segment=L)}clone(){return new hc(this.x,this.y,this.angle,this.segment)}}function zd(f,u,p,S,L){if(u.segment===void 0||p===0)return!0;let G=u,Q=u.segment+1,re=0;for(;re>-p/2;){if(Q--,Q<0)return!1;re-=f[Q].dist(G),G=f[Q]}re+=f[Q].dist(f[Q+1]),Q++;const he=[];let _e=0;for(;re<p/2;){const Le=f[Q],qe=f[Q+1];if(!qe)return!1;let Je=f[Q-1].angleTo(Le)-Le.angleTo(qe);for(Je=Math.abs((Je+3*Math.PI)%(2*Math.PI)-Math.PI),he.push({distance:re,angleDelta:Je}),_e+=Je;re-he[0].distance>S;)_e-=he.shift().angleDelta;if(_e>L)return!1;Q++,re+=Le.dist(qe)}return!0}function Df(f){let u=0;for(let p=0;p<f.length-1;p++)u+=f[p].dist(f[p+1]);return u}function Lf(f,u,p){return f?.6*u*p:0}function Bf(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function Nm(f,u,p,S,L,G){const Q=Lf(p,L,G),re=Bf(p,S)*G;let he=0;const _e=Df(f)/2;for(let Le=0;Le<f.length-1;Le++){const qe=f[Le],Je=f[Le+1],At=qe.dist(Je);if(he+At>_e){const gt=(_e-he)/At,Mt=js.number(qe.x,Je.x,gt),Pt=js.number(qe.y,Je.y,gt),zt=new hc(Mt,Pt,Je.angleTo(qe),Le);return zt._round(),!Q||zd(f,zt,re,Q,u)?zt:void 0}he+=At}}function Vm(f,u,p,S,L,G,Q,re,he){const _e=Lf(S,G,Q),Le=Bf(S,L),qe=Le*Q,Je=f[0].x===0||f[0].x===he||f[0].y===0||f[0].y===he;return u-qe<u/4&&(u=qe+u/4),Np(f,Je?u/2*re%u:(Le/2+2*G)*Q*re%u,u,_e,p,qe,Je,!1,he)}function Np(f,u,p,S,L,G,Q,re,he){const _e=G/2,Le=Df(f);let qe=0,Je=u-p,At=[];for(let gt=0;gt<f.length-1;gt++){const Mt=f[gt],Pt=f[gt+1],zt=Mt.dist(Pt),$t=Pt.angleTo(Mt);for(;Je+p<qe+zt;){Je+=p;const Ht=(Je-qe)/zt,Zt=js.number(Mt.x,Pt.x,Ht),ui=js.number(Mt.y,Pt.y,Ht);if(Zt>=0&&Zt<he&&ui>=0&&ui<he&&Je-_e>=0&&Je+_e<=Le){const _i=new hc(Zt,ui,$t,gt);_i._round(),S&&!zd(f,_i,G,S,L)||At.push(_i)}}qe+=zt}return re||At.length||Q||(At=Np(f,qe/2,p,S,L,G,Q,!0,he)),At}Pn("Anchor",hc);const qA=wu;function tA(f,u,p,S){const L=[],G=f.image,Q=G.pixelRatio,re=G.paddedRect.w-2*qA,he=G.paddedRect.h-2*qA,_e=f.right-f.left,Le=f.bottom-f.top,qe=G.stretchX||[[0,re]],Je=G.stretchY||[[0,he]],At=(hn,zn)=>hn+zn[1]-zn[0],gt=qe.reduce(At,0),Mt=Je.reduce(At,0),Pt=re-gt,zt=he-Mt;let $t=0,Ht=gt,Zt=0,ui=Mt,_i=0,Xi=Pt,xn=0,nn=zt;if(G.content&&S){const hn=G.content;$t=Mo(qe,0,hn[0]),Zt=Mo(Je,0,hn[1]),Ht=Mo(qe,hn[0],hn[2]),ui=Mo(Je,hn[1],hn[3]),_i=hn[0]-$t,xn=hn[1]-Zt,Xi=hn[2]-hn[0]-Ht,nn=hn[3]-hn[1]-ui}const tn=(hn,zn,en,Wi)=>{const Dn=iA(hn.stretch-$t,Ht,_e,f.left),Rn=HA(hn.fixed-_i,Xi,hn.stretch,gt),dr=iA(zn.stretch-Zt,ui,Le,f.top),Fr=HA(zn.fixed-xn,nn,zn.stretch,Mt),qr=iA(en.stretch-$t,Ht,_e,f.left),zs=HA(en.fixed-_i,Xi,en.stretch,gt),Ea=iA(Wi.stretch-Zt,ui,Le,f.top),ia=HA(Wi.fixed-xn,nn,Wi.stretch,Mt),is=new fe(Dn,dr),Wn=new fe(qr,dr),xs=new fe(qr,Ea),tr=new fe(Dn,Ea),na=new fe(Rn/Q,Fr/Q),Ds=new fe(zs/Q,ia/Q),Kn=u*Math.PI/180;if(Kn){const va=Math.sin(Kn),Uo=Math.cos(Kn),so=[Uo,-va,va,Uo];is._matMult(so),Wn._matMult(so),tr._matMult(so),xs._matMult(so)}const La=hn.stretch+hn.fixed,$a=zn.stretch+zn.fixed;return{tl:is,tr:Wn,bl:tr,br:xs,tex:{x:G.paddedRect.x+qA+La,y:G.paddedRect.y+qA+$a,w:en.stretch+en.fixed-La,h:Wi.stretch+Wi.fixed-$a},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:na,pixelOffsetBR:Ds,minFontScaleX:Xi/Q/_e,minFontScaleY:nn/Q/Le,isSDF:p}};if(S&&(G.stretchX||G.stretchY)){const hn=lh(qe,Pt,gt),zn=lh(Je,zt,Mt);for(let en=0;en<hn.length-1;en++){const Wi=hn[en],Dn=hn[en+1];for(let Rn=0;Rn<zn.length-1;Rn++)L.push(tn(Wi,zn[Rn],Dn,zn[Rn+1]))}}else L.push(tn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:re+1},{fixed:0,stretch:he+1}));return L}function Mo(f,u,p){let S=0;for(const L of f)S+=Math.max(u,Math.min(p,L[1]))-Math.max(u,Math.min(p,L[0]));return S}function lh(f,u,p){const S=[{fixed:-qA,stretch:0}];for(const[L,G]of f){const Q=S[S.length-1];S.push({fixed:L-Q.stretch,stretch:Q.stretch}),S.push({fixed:L-Q.stretch,stretch:Q.stretch+(G-L)})}return S.push({fixed:u+qA,stretch:p}),S}function iA(f,u,p,S){return f/u*p+S}function HA(f,u,p,S){return f-u*p/S}class nA{constructor(u,p,S,L,G,Q,re,he,_e,Le){if(this.boxStartIndex=u.length,_e){let qe=Q.top,Je=Q.bottom;const At=Q.collisionPadding;At&&(qe-=At[1],Je+=At[3]);let gt=Je-qe;gt>0&&(gt=Math.max(10,gt),this.circleDiameter=gt)}else{let qe=Q.top*re-he[0],Je=Q.bottom*re+he[2],At=Q.left*re-he[3],gt=Q.right*re+he[1];const Mt=Q.collisionPadding;if(Mt&&(At-=Mt[0]*re,qe-=Mt[1]*re,gt+=Mt[2]*re,Je+=Mt[3]*re),Le){const Pt=new fe(At,qe),zt=new fe(gt,qe),$t=new fe(At,Je),Ht=new fe(gt,Je),Zt=Le*Math.PI/180;Pt._rotate(Zt),zt._rotate(Zt),$t._rotate(Zt),Ht._rotate(Zt),At=Math.min(Pt.x,zt.x,$t.x,Ht.x),gt=Math.max(Pt.x,zt.x,$t.x,Ht.x),qe=Math.min(Pt.y,zt.y,$t.y,Ht.y),Je=Math.max(Pt.y,zt.y,$t.y,Ht.y)}u.emplaceBack(p.x,p.y,At,qe,gt,Je,S,L,G)}this.boxEndIndex=u.length}}class M0{constructor(u=[],p=Vp){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let S=(this.length>>1)-1;S>=0;S--)this._down(S)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:S}=this,L=p[u];for(;u>0;){const G=u-1>>1,Q=p[G];if(S(L,Q)>=0)break;p[u]=Q,u=G}p[u]=L}_down(u){const{data:p,compare:S}=this,L=this.length>>1,G=p[u];for(;u<L;){let Q=1+(u<<1),re=p[Q];const he=Q+1;if(he<this.length&&S(p[he],re)<0&&(Q=he,re=p[he]),S(re,G)>=0)break;p[u]=re,u=Q}p[u]=G}}function Vp(f,u){return f<u?-1:f>u?1:0}function Rd(f,u=1,p=!1){let S=1/0,L=1/0,G=-1/0,Q=-1/0;const re=f[0];for(let At=0;At<re.length;At++){const gt=re[At];(!At||gt.x<S)&&(S=gt.x),(!At||gt.y<L)&&(L=gt.y),(!At||gt.x>G)&&(G=gt.x),(!At||gt.y>Q)&&(Q=gt.y)}const he=Math.min(G-S,Q-L);let _e=he/2;const Le=new M0([],Fd);if(he===0)return new fe(S,L);for(let At=S;At<G;At+=he)for(let gt=L;gt<Q;gt+=he)Le.push(new jA(At+_e,gt+_e,_e,f));let qe=function(At){let gt=0,Mt=0,Pt=0;const zt=At[0];for(let $t=0,Ht=zt.length,Zt=Ht-1;$t<Ht;Zt=$t++){const ui=zt[$t],_i=zt[Zt],Xi=ui.x*_i.y-_i.x*ui.y;Mt+=(ui.x+_i.x)*Xi,Pt+=(ui.y+_i.y)*Xi,gt+=3*Xi}return new jA(Mt/gt,Pt/gt,0,At)}(f),Je=Le.length;for(;Le.length;){const At=Le.pop();(At.d>qe.d||!qe.d)&&(qe=At,p&&console.log("found best %d after %d probes",Math.round(1e4*At.d)/1e4,Je)),At.max-qe.d<=u||(_e=At.h/2,Le.push(new jA(At.p.x-_e,At.p.y-_e,_e,f)),Le.push(new jA(At.p.x+_e,At.p.y-_e,_e,f)),Le.push(new jA(At.p.x-_e,At.p.y+_e,_e,f)),Le.push(new jA(At.p.x+_e,At.p.y+_e,_e,f)),Je+=4)}return p&&(console.log(`num probes: ${Je}`),console.log(`best distance: ${qe.d}`)),qe.p}function Fd(f,u){return u.max-f.max}function jA(f,u,p,S){this.p=new fe(f,u),this.h=p,this.d=function(L,G){let Q=!1,re=1/0;for(let he=0;he<G.length;he++){const _e=G[he];for(let Le=0,qe=_e.length,Je=qe-1;Le<qe;Je=Le++){const At=_e[Le],gt=_e[Je];At.y>L.y!=gt.y>L.y&&L.x<(gt.x-At.x)*(L.y-At.y)/(gt.y-At.y)+At.x&&(Q=!Q),re=Math.min(re,H0(L,At,gt))}}return(Q?1:-1)*Math.sqrt(re)}(this.p,S),this.max=this.d+this.h*Math.SQRT2}var Bl;a.aq=void 0,(Bl=a.aq||(a.aq={}))[Bl.center=1]="center",Bl[Bl.left=2]="left",Bl[Bl.right=3]="right",Bl[Bl.top=4]="top",Bl[Bl.bottom=5]="bottom",Bl[Bl["top-left"]=6]="top-left",Bl[Bl["top-right"]=7]="top-right",Bl[Bl["bottom-left"]=8]="bottom-left",Bl[Bl["bottom-right"]=9]="bottom-right";const Bc=7,kh=Number.POSITIVE_INFINITY;function ZA(f,u){return u[1]!==kh?function(p,S,L){let G=0,Q=0;switch(S=Math.abs(S),L=Math.abs(L),p){case"top-right":case"top-left":case"top":Q=L-Bc;break;case"bottom-right":case"bottom-left":case"bottom":Q=-L+Bc}switch(p){case"top-right":case"bottom-right":case"right":G=-S;break;case"top-left":case"bottom-left":case"left":G=S}return[G,Q]}(f,u[0],u[1]):function(p,S){let L=0,G=0;S<0&&(S=0);const Q=S/Math.SQRT2;switch(p){case"top-right":case"top-left":G=Q-Bc;break;case"bottom-right":case"bottom-left":G=-Q+Bc;break;case"bottom":G=-S+Bc;break;case"top":G=S-Bc}switch(p){case"top-right":case"bottom-right":L=-Q;break;case"top-left":case"bottom-left":L=Q;break;case"left":L=S;break;case"right":L=-S}return[L,G]}(f,u[0])}function QA(f,u,p){var S;const L=f.layout,G=(S=L.get("text-variable-anchor-offset"))===null||S===void 0?void 0:S.evaluate(u,{},p);if(G){const re=G.values,he=[];for(let _e=0;_e<re.length;_e+=2){const Le=he[_e]=re[_e],qe=re[_e+1].map(Je=>Je*Ya);Le.startsWith("top")?qe[1]-=Bc:Le.startsWith("bottom")&&(qe[1]+=Bc),he[_e+1]=qe}return new En(he)}const Q=L.get("text-variable-anchor");if(Q){let re;re=f._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[L.get("text-radial-offset").evaluate(u,{},p)*Ya,kh]:L.get("text-offset").evaluate(u,{},p).map(_e=>_e*Ya);const he=[];for(const _e of Q)he.push(_e,ZA(_e,re));return new En(he)}return null}function zf(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function P0(f,u,p,S,L,G,Q,re,he,_e,Le){let qe=G.textMaxSize.evaluate(u,{});qe===void 0&&(qe=Q);const Je=f.layers[0].layout,At=Je.get("icon-offset").evaluate(u,{},Le),gt=Ff(p.horizontal),Mt=Q/24,Pt=f.tilePixelRatio*Mt,zt=f.tilePixelRatio*qe/24,$t=f.tilePixelRatio*re,Ht=f.tilePixelRatio*Je.get("symbol-spacing"),Zt=Je.get("text-padding")*f.tilePixelRatio,ui=function(Wi,Dn,Rn,dr=1){const Fr=Wi.get("icon-padding").evaluate(Dn,{},Rn),qr=Fr&&Fr.values;return[qr[0]*dr,qr[1]*dr,qr[2]*dr,qr[3]*dr]}(Je,u,Le,f.tilePixelRatio),_i=Je.get("text-max-angle")/180*Math.PI,Xi=Je.get("text-rotation-alignment")!=="viewport"&&Je.get("symbol-placement")!=="point",xn=Je.get("icon-rotation-alignment")==="map"&&Je.get("symbol-placement")!=="point",nn=Je.get("symbol-placement"),tn=Ht/2,hn=Je.get("icon-text-fit");let zn;S&&hn!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(zn=w0(S,p.vertical,hn,Je.get("icon-text-fit-padding"),At,Mt)),gt&&(S=w0(S,gt,hn,Je.get("icon-text-fit-padding"),At,Mt)));const en=(Wi,Dn)=>{Dn.x<0||Dn.x>=Pa||Dn.y<0||Dn.y>=Pa||function(Rn,dr,Fr,qr,zs,Ea,ia,is,Wn,xs,tr,na,Ds,Kn,La,$a,va,Uo,so,ra,br,yo,tl,il,Mu){const Vu=Rn.addToLineVertexArray(dr,Fr);let zl,zc,Uu,Gu,Xl=0,uh=0,rA=0,Gp=0,Od=-1,Nd=-1;const ao={};let vo=_o("");if(Rn.allowVerticalPlacement&&qr.vertical){const Su=is.layout.get("text-rotate").evaluate(br,{},il)+90;Uu=new nA(Wn,dr,xs,tr,na,qr.vertical,Ds,Kn,La,Su),ia&&(Gu=new nA(Wn,dr,xs,tr,na,ia,va,Uo,La,Su))}if(zs){const Su=is.layout.get("icon-rotate").evaluate(br,{}),fc=is.layout.get("icon-text-fit")!=="none",Rc=tA(zs,Su,tl,fc),ch=ia?tA(ia,Su,tl,fc):void 0;zc=new nA(Wn,dr,xs,tr,na,zs,va,Uo,!1,Su),Xl=4*Rc.length;const Gf=Rn.iconSizeData;let Ph=null;Gf.kind==="source"?(Ph=[Yu*is.layout.get("icon-size").evaluate(br,{})],Ph[0]>Dc&&nt(`${Rn.layerIds[0]}: Value for "icon-size" is >= ${kf}. Reduce your "icon-size".`)):Gf.kind==="composite"&&(Ph=[Yu*yo.compositeIconSizes[0].evaluate(br,{},il),Yu*yo.compositeIconSizes[1].evaluate(br,{},il)],(Ph[0]>Dc||Ph[1]>Dc)&&nt(`${Rn.layerIds[0]}: Value for "icon-size" is >= ${kf}. Reduce your "icon-size".`)),Rn.addSymbols(Rn.icon,Rc,Ph,ra,so,br,a.ai.none,dr,Vu.lineStartIndex,Vu.lineLength,-1,il),Od=Rn.icon.placedSymbolArray.length-1,ch&&(uh=4*ch.length,Rn.addSymbols(Rn.icon,ch,Ph,ra,so,br,a.ai.vertical,dr,Vu.lineStartIndex,Vu.lineLength,-1,il),Nd=Rn.icon.placedSymbolArray.length-1)}const Uf=Object.keys(qr.horizontal);for(const Su of Uf){const fc=qr.horizontal[Su];if(!zl){vo=_o(fc.text);const ch=is.layout.get("text-rotate").evaluate(br,{},il);zl=new nA(Wn,dr,xs,tr,na,fc,Ds,Kn,La,ch)}const Rc=fc.positionedLines.length===1;if(rA+=Rf(Rn,dr,fc,Ea,is,La,br,$a,Vu,qr.vertical?a.ai.horizontal:a.ai.horizontalOnly,Rc?Uf:[Su],ao,Od,yo,il),Rc)break}qr.vertical&&(Gp+=Rf(Rn,dr,qr.vertical,Ea,is,La,br,$a,Vu,a.ai.vertical,["vertical"],ao,Nd,yo,il));const qp=zl?zl.boxStartIndex:Rn.collisionBoxArray.length,Um=zl?zl.boxEndIndex:Rn.collisionBoxArray.length,Hp=Uu?Uu.boxStartIndex:Rn.collisionBoxArray.length,Gm=Uu?Uu.boxEndIndex:Rn.collisionBoxArray.length,Yl=zc?zc.boxStartIndex:Rn.collisionBoxArray.length,qu=zc?zc.boxEndIndex:Rn.collisionBoxArray.length,Mh=Gu?Gu.boxStartIndex:Rn.collisionBoxArray.length,Ac=Gu?Gu.boxEndIndex:Rn.collisionBoxArray.length;let $l=-1;const Hu=(Su,fc)=>Su&&Su.circleDiameter?Math.max(Su.circleDiameter,fc):fc;$l=Hu(zl,$l),$l=Hu(Uu,$l),$l=Hu(zc,$l),$l=Hu(Gu,$l);const qm=$l>-1?1:0;qm&&($l*=Mu/Ya),Rn.glyphOffsetArray.length>=sh.MAX_GLYPHS&&nt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),br.sortKey!==void 0&&Rn.addToSortKeyRanges(Rn.symbolInstances.length,br.sortKey);const Rg=QA(is,br,il),[y1,v1]=function(Su,fc){const Rc=Su.length,ch=fc==null?void 0:fc.values;if((ch==null?void 0:ch.length)>0)for(let Gf=0;Gf<ch.length;Gf+=2){const Ph=ch[Gf+1];Su.emplaceBack(a.aq[ch[Gf]],Ph[0],Ph[1])}return[Rc,Su.length]}(Rn.textAnchorOffsets,Rg);Rn.symbolInstances.emplaceBack(dr.x,dr.y,ao.right>=0?ao.right:-1,ao.center>=0?ao.center:-1,ao.left>=0?ao.left:-1,ao.vertical||-1,Od,Nd,vo,qp,Um,Hp,Gm,Yl,qu,Mh,Ac,xs,rA,Gp,Xl,uh,qm,0,Ds,$l,y1,v1)}(f,Dn,Wi,p,S,L,zn,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,Pt,[Zt,Zt,Zt,Zt],Xi,he,$t,ui,xn,At,u,G,_e,Le,Q)};if(nn==="line")for(const Wi of Bd(u.geometry,0,0,Pa,Pa)){const Dn=Vm(Wi,Ht,_i,p.vertical||gt,S,24,zt,f.overscaling,Pa);for(const Rn of Dn)gt&&Of(f,gt.text,tn,Rn)||en(Wi,Rn)}else if(nn==="line-center"){for(const Wi of u.geometry)if(Wi.length>1){const Dn=Nm(Wi,_i,p.vertical||gt,S,24,zt);Dn&&en(Wi,Dn)}}else if(u.type==="Polygon")for(const Wi of $0(u.geometry,0)){const Dn=Rd(Wi,16);en(Wi[0],new hc(Dn.x,Dn.y,0))}else if(u.type==="LineString")for(const Wi of u.geometry)en(Wi,new hc(Wi[0].x,Wi[0].y,0));else if(u.type==="Point")for(const Wi of u.geometry)for(const Dn of Wi)en([Dn],new hc(Dn.x,Dn.y,0))}function Rf(f,u,p,S,L,G,Q,re,he,_e,Le,qe,Je,At,gt){const Mt=function($t,Ht,Zt,ui,_i,Xi,xn,nn){const tn=ui.layout.get("text-rotate").evaluate(Xi,{})*Math.PI/180,hn=[];for(const zn of Ht.positionedLines)for(const en of zn.positionedGlyphs){if(!en.rect)continue;const Wi=en.rect||{};let Dn=Ef+1,Rn=!0,dr=1,Fr=0;const qr=(_i||nn)&&en.vertical,zs=en.metrics.advance*en.scale/2;if(nn&&Ht.verticalizable&&(Fr=zn.lineOffset/2-(en.imageName?-(Ya-en.metrics.width*en.scale)/2:(en.scale-1)*Ya)),en.imageName){const ra=xn[en.imageName];Rn=ra.sdf,dr=ra.pixelRatio,Dn=wu/dr}const Ea=_i?[en.x+zs,en.y]:[0,0];let ia=_i?[0,0]:[en.x+zs+Zt[0],en.y+Zt[1]-Fr],is=[0,0];qr&&(is=ia,ia=[0,0]);const Wn=en.metrics.isDoubleResolution?2:1,xs=(en.metrics.left-Dn)*en.scale-zs+ia[0],tr=(-en.metrics.top-Dn)*en.scale+ia[1],na=xs+Wi.w/Wn*en.scale/dr,Ds=tr+Wi.h/Wn*en.scale/dr,Kn=new fe(xs,tr),La=new fe(na,tr),$a=new fe(xs,Ds),va=new fe(na,Ds);if(qr){const ra=new fe(-zs,zs-zA),br=-Math.PI/2,yo=Ya/2-zs,tl=new fe(5-zA-yo,-(en.imageName?yo:0)),il=new fe(...is);Kn._rotateAround(br,ra)._add(tl)._add(il),La._rotateAround(br,ra)._add(tl)._add(il),$a._rotateAround(br,ra)._add(tl)._add(il),va._rotateAround(br,ra)._add(tl)._add(il)}if(tn){const ra=Math.sin(tn),br=Math.cos(tn),yo=[br,-ra,ra,br];Kn._matMult(yo),La._matMult(yo),$a._matMult(yo),va._matMult(yo)}const Uo=new fe(0,0),so=new fe(0,0);hn.push({tl:Kn,tr:La,bl:$a,br:va,tex:Wi,writingMode:Ht.writingMode,glyphOffset:Ea,sectionIndex:en.sectionIndex,isSDF:Rn,pixelOffsetTL:Uo,pixelOffsetBR:so,minFontScaleX:0,minFontScaleY:0})}return hn}(0,p,re,L,G,Q,S,f.allowVerticalPlacement),Pt=f.textSizeData;let zt=null;Pt.kind==="source"?(zt=[Yu*L.layout.get("text-size").evaluate(Q,{})],zt[0]>Dc&&nt(`${f.layerIds[0]}: Value for "text-size" is >= ${kf}. Reduce your "text-size".`)):Pt.kind==="composite"&&(zt=[Yu*At.compositeTextSizes[0].evaluate(Q,{},gt),Yu*At.compositeTextSizes[1].evaluate(Q,{},gt)],(zt[0]>Dc||zt[1]>Dc)&&nt(`${f.layerIds[0]}: Value for "text-size" is >= ${kf}. Reduce your "text-size".`)),f.addSymbols(f.text,Mt,zt,re,G,Q,_e,u,he.lineStartIndex,he.lineLength,Je,gt);for(const $t of Le)qe[$t]=f.text.placedSymbolArray.length-1;return 4*Mt.length}function Ff(f){for(const u in f)return f[u];return null}function Of(f,u,p,S){const L=f.compareText;if(u in L){const G=L[u];for(let Q=G.length-1;Q>=0;Q--)if(S.dist(G[Q])<p)return!0}else L[u]=[];return L[u].push(S),!1}const D0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Nf{static from(u){if(!(u instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[p,S]=new Uint8Array(u,0,2);if(p!==219)throw new Error("Data does not appear to be in a KDBush format.");const L=S>>4;if(L!==1)throw new Error(`Got v${L} data when expected v1.`);const G=D0[15&S];if(!G)throw new Error("Unrecognized array type.");const[Q]=new Uint16Array(u,2,1),[re]=new Uint32Array(u,4,1);return new Nf(re,Q,G,u)}constructor(u,p=64,S=Float64Array,L){if(isNaN(u)||u<0)throw new Error(`Unpexpected numItems value: ${u}.`);this.numItems=+u,this.nodeSize=Math.min(Math.max(+p,2),65535),this.ArrayType=S,this.IndexArrayType=u<65536?Uint16Array:Uint32Array;const G=D0.indexOf(this.ArrayType),Q=2*u*this.ArrayType.BYTES_PER_ELEMENT,re=u*this.IndexArrayType.BYTES_PER_ELEMENT,he=(8-re%8)%8;if(G<0)throw new Error(`Unexpected typed array class: ${S}.`);L&&L instanceof ArrayBuffer?(this.data=L,this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+he,2*u),this._pos=2*u,this._finished=!0):(this.data=new ArrayBuffer(8+Q+re+he),this.ids=new this.IndexArrayType(this.data,8,u),this.coords=new this.ArrayType(this.data,8+re+he,2*u),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+G]),new Uint16Array(this.data,2,1)[0]=p,new Uint32Array(this.data,4,1)[0]=u)}add(u,p){const S=this._pos>>1;return this.ids[S]=S,this.coords[this._pos++]=u,this.coords[this._pos++]=p,S}finish(){const u=this._pos>>1;if(u!==this.numItems)throw new Error(`Added ${u} items when expected ${this.numItems}.`);return Vf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(u,p,S,L){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:G,coords:Q,nodeSize:re}=this,he=[0,G.length-1,0],_e=[];for(;he.length;){const Le=he.pop()||0,qe=he.pop()||0,Je=he.pop()||0;if(qe-Je<=re){for(let Pt=Je;Pt<=qe;Pt++){const zt=Q[2*Pt],$t=Q[2*Pt+1];zt>=u&&zt<=S&&$t>=p&&$t<=L&&_e.push(G[Pt])}continue}const At=Je+qe>>1,gt=Q[2*At],Mt=Q[2*At+1];gt>=u&&gt<=S&&Mt>=p&&Mt<=L&&_e.push(G[At]),(Le===0?u<=gt:p<=Mt)&&(he.push(Je),he.push(At-1),he.push(1-Le)),(Le===0?S>=gt:L>=Mt)&&(he.push(At+1),he.push(qe),he.push(1-Le))}return _e}within(u,p,S){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:L,coords:G,nodeSize:Q}=this,re=[0,L.length-1,0],he=[],_e=S*S;for(;re.length;){const Le=re.pop()||0,qe=re.pop()||0,Je=re.pop()||0;if(qe-Je<=Q){for(let Pt=Je;Pt<=qe;Pt++)x(G[2*Pt],G[2*Pt+1],u,p)<=_e&&he.push(L[Pt]);continue}const At=Je+qe>>1,gt=G[2*At],Mt=G[2*At+1];x(gt,Mt,u,p)<=_e&&he.push(L[At]),(Le===0?u-S<=gt:p-S<=Mt)&&(re.push(Je),re.push(At-1),re.push(1-Le)),(Le===0?u+S>=gt:p+S>=Mt)&&(re.push(At+1),re.push(qe),re.push(1-Le))}return he}}function Vf(f,u,p,S,L,G){if(L-S<=p)return;const Q=S+L>>1;Up(f,u,Q,S,L,G),Vf(f,u,p,S,Q-1,1-G),Vf(f,u,p,Q+1,L,1-G)}function Up(f,u,p,S,L,G){for(;L>S;){if(L-S>600){const _e=L-S+1,Le=p-S+1,qe=Math.log(_e),Je=.5*Math.exp(2*qe/3),At=.5*Math.sqrt(qe*Je*(_e-Je)/_e)*(Le-_e/2<0?-1:1);Up(f,u,p,Math.max(S,Math.floor(p-Le*Je/_e+At)),Math.min(L,Math.floor(p+(_e-Le)*Je/_e+At)),G)}const Q=u[2*p+G];let re=S,he=L;for(m(f,u,S,p),u[2*L+G]>Q&&m(f,u,S,L);re<he;){for(m(f,u,re,he),re++,he--;u[2*re+G]<Q;)re++;for(;u[2*he+G]>Q;)he--}u[2*S+G]===Q?m(f,u,S,he):(he++,m(f,u,he,L)),he<=p&&(S=he+1),p<=he&&(L=he-1)}}function m(f,u,p,S){h(f,p,S),h(u,2*p,2*S),h(u,2*p+1,2*S+1)}function h(f,u,p){const S=f[u];f[u]=f[p],f[p]=S}function x(f,u,p,S){const L=f-p,G=u-S;return L*L+G*G}var M;a.bh=void 0,(M=a.bh||(a.bh={})).create="create",M.load="load",M.fullLoad="fullLoad";let q=null,K=[];const J=1e3/60,me="loadTime",Ce="fullLoadTime",Oe={mark(f){performance.mark(f)},frame(f){const u=f;q!=null&&K.push(u-q),q=u},clearMetrics(){q=null,K=[],performance.clearMeasures(me),performance.clearMeasures(Ce);for(const f in a.bh)performance.clearMarks(a.bh[f])},getPerformanceMetrics(){performance.measure(me,a.bh.create,a.bh.load),performance.measure(Ce,a.bh.create,a.bh.fullLoad);const f=performance.getEntriesByName(me)[0].duration,u=performance.getEntriesByName(Ce)[0].duration,p=K.length,S=1/(K.reduce((G,Q)=>G+Q,0)/p/1e3),L=K.filter(G=>G>J).reduce((G,Q)=>G+(Q-J)/J,0);return{loadTime:f,fullLoadTime:u,fps:S,percentDroppedFrames:L/(p+L)*100,totalFrames:p}}};a.$=function(f,u,p){var S,L,G,Q,re,he,_e,Le,qe,Je,At,gt,Mt=p[0],Pt=p[1],zt=p[2];return u===f?(f[12]=u[0]*Mt+u[4]*Pt+u[8]*zt+u[12],f[13]=u[1]*Mt+u[5]*Pt+u[9]*zt+u[13],f[14]=u[2]*Mt+u[6]*Pt+u[10]*zt+u[14],f[15]=u[3]*Mt+u[7]*Pt+u[11]*zt+u[15]):(L=u[1],G=u[2],Q=u[3],re=u[4],he=u[5],_e=u[6],Le=u[7],qe=u[8],Je=u[9],At=u[10],gt=u[11],f[0]=S=u[0],f[1]=L,f[2]=G,f[3]=Q,f[4]=re,f[5]=he,f[6]=_e,f[7]=Le,f[8]=qe,f[9]=Je,f[10]=At,f[11]=gt,f[12]=S*Mt+re*Pt+qe*zt+u[12],f[13]=L*Mt+he*Pt+Je*zt+u[13],f[14]=G*Mt+_e*Pt+At*zt+u[14],f[15]=Q*Mt+Le*Pt+gt*zt+u[15]),f},a.A=qh,a.B=js,a.C=class{constructor(f,u,p){this.receive=S=>{const L=S.data,G=L.id;if(G&&(!L.targetMapId||this.mapId===L.targetMapId))if(L.type==="<cancel>"){delete this.tasks[G];const Q=this.cancelCallbacks[G];delete this.cancelCallbacks[G],Q&&Q()}else Nt()||L.mustQueue?(this.tasks[G]=L,this.taskQueue.push(G),this.invoker.trigger()):this.processTask(G,L)},this.process=()=>{if(!this.taskQueue.length)return;const S=this.taskQueue.shift(),L=this.tasks[S];delete this.tasks[S],this.taskQueue.length&&this.invoker.trigger(),L&&this.processTask(S,L)},this.target=f,this.parent=u,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new I0(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Nt()?f:window}send(f,u,p,S,L=!1){const G=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[G]=p);const Q=[],re={id:G,type:f,hasCallback:!!p,targetMapId:S,mustQueue:L,sourceMapId:this.mapId,data:bn(u,Q)};return this.target.postMessage(re,{transfer:Q}),{cancel:()=>{p&&delete this.callbacks[G],this.target.postMessage({id:G,type:"<cancel>",targetMapId:S,sourceMapId:this.mapId})}}}processTask(f,u){if(u.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(u.error?p(Fo(u.error)):p(null,Fo(u.data)))}else{let p=!1;const S=[],L=u.hasCallback?(re,he)=>{p=!0,delete this.cancelCallbacks[f];const _e={id:f,type:"<response>",sourceMapId:this.mapId,error:re?bn(re):null,data:bn(he,S)};this.target.postMessage(_e,{transfer:S})}:re=>{p=!0};let G=null;const Q=Fo(u.data);if(this.parent[u.type])G=this.parent[u.type](u.sourceMapId,Q,L);else if("getWorkerSource"in this.parent){const re=u.type.split(".");G=this.parent.getWorkerSource(u.sourceMapId,re[0],Q.source)[re[1]](Q,L)}else L(new Error(`Could not find function ${u.type}`));!p&&G&&G.cancel&&(this.cancelCallbacks[f]=G.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.D=Mi,a.E=ns,a.F=function(f,u){const p={};for(let S=0;S<u.length;S++){const L=u[S];L in f&&(p[L]=f[L])}return p},a.G=UA,a.H=Ed,a.I=v0,a.J=ut,a.K=kt,a.L=Lc,a.M=bi,a.N=Pa,a.O=bl,a.P=fe,a.Q=R,a.R=Ll,a.S=er,a.T=Jo,a.U=Pf,a.V=class extends be{},a.W=Md,a.X=function(f,u){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let S=0;S<f.length;S++){const L=window.document.createElement("source");_n(f[S])||(p.crossOrigin="Anonymous"),L.src=f[S],p.appendChild(L)}return{cancel:()=>{}}},a.Y=ve,a.Z=function(){var f=new qh(16);return qh!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},a._=U,a.a=Dt,a.a$=class extends w{},a.a0=function(f,u,p){var S=p[0],L=p[1],G=p[2];return f[0]=u[0]*S,f[1]=u[1]*S,f[2]=u[2]*S,f[3]=u[3]*S,f[4]=u[4]*L,f[5]=u[5]*L,f[6]=u[6]*L,f[7]=u[7]*L,f[8]=u[8]*G,f[9]=u[9]*G,f[10]=u[10]*G,f[11]=u[11]*G,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.a1=uf,a.a2=function(){return xt++},a.a3=j,a.a4=sh,a.a5=function(){ds.isLoading()||ds.isLoaded()||Ou()!=="deferred"||_r()},a.a6=Zr,a.a7=Ic,a.a8=pn,a.a9=Dd,a.aA=gu,a.aB=function(f){f=f.slice();const u=Object.create(null);for(let p=0;p<f.length;p++)u[f[p].id]=f[p];for(let p=0;p<f.length;p++)"ref"in f[p]&&(f[p]=pr(f[p],u[f[p].ref]));return f},a.aC=function(f){if(f.type==="custom")return new VA(f);switch(f.type){case"background":return new zp(f);case"circle":return new Nu(f);case"fill":return new bp(f);case"fill-extrusion":return new id(f);case"heatmap":return new Jc(f);case"hillshade":return new W0(f);case"line":return new cl(f);case"raster":return new Rp(f);case"symbol":return new NA(f)}},a.aD=bt,a.aE=function(f,u){if(!f)return[{command:Qn.setStyle,args:[u]}];let p=[];try{if(!On(f.version,u.version))return[{command:Qn.setStyle,args:[u]}];On(f.center,u.center)||p.push({command:Qn.setCenter,args:[u.center]}),On(f.zoom,u.zoom)||p.push({command:Qn.setZoom,args:[u.zoom]}),On(f.bearing,u.bearing)||p.push({command:Qn.setBearing,args:[u.bearing]}),On(f.pitch,u.pitch)||p.push({command:Qn.setPitch,args:[u.pitch]}),On(f.sprite,u.sprite)||p.push({command:Qn.setSprite,args:[u.sprite]}),On(f.glyphs,u.glyphs)||p.push({command:Qn.setGlyphs,args:[u.glyphs]}),On(f.transition,u.transition)||p.push({command:Qn.setTransition,args:[u.transition]}),On(f.light,u.light)||p.push({command:Qn.setLight,args:[u.light]});const S={},L=[];(function(Q,re,he,_e){let Le;for(Le in re=re||{},Q=Q||{})Object.prototype.hasOwnProperty.call(Q,Le)&&(Object.prototype.hasOwnProperty.call(re,Le)||v(Le,he,_e));for(Le in re)Object.prototype.hasOwnProperty.call(re,Le)&&(Object.prototype.hasOwnProperty.call(Q,Le)?On(Q[Le],re[Le])||(Q[Le].type==="geojson"&&re[Le].type==="geojson"&&V(Q,re,Le)?he.push({command:Qn.setGeoJSONSourceData,args:[Le,re[Le].data]}):k(Le,re,he,_e)):wn(Le,re,he))})(f.sources,u.sources,L,S);const G=[];f.layers&&f.layers.forEach(Q=>{S[Q.source]?p.push({command:Qn.removeLayer,args:[Q.id]}):G.push(Q)}),p=p.concat(L),function(Q,re,he){re=re||[];const _e=(Q=Q||[]).map(te),Le=re.map(te),qe=Q.reduce(Ae,{}),Je=re.reduce(Ae,{}),At=_e.slice(),gt=Object.create(null);let Mt,Pt,zt,$t,Ht,Zt,ui;for(Mt=0,Pt=0;Mt<_e.length;Mt++)zt=_e[Mt],Object.prototype.hasOwnProperty.call(Je,zt)?Pt++:(he.push({command:Qn.removeLayer,args:[zt]}),At.splice(At.indexOf(zt,Pt),1));for(Mt=0,Pt=0;Mt<Le.length;Mt++)zt=Le[Le.length-1-Mt],At[At.length-1-Mt]!==zt&&(Object.prototype.hasOwnProperty.call(qe,zt)?(he.push({command:Qn.removeLayer,args:[zt]}),At.splice(At.lastIndexOf(zt,At.length-Pt),1)):Pt++,Zt=At[At.length-Mt],he.push({command:Qn.addLayer,args:[Je[zt],Zt]}),At.splice(At.length-Mt,0,zt),gt[zt]=!0);for(Mt=0;Mt<Le.length;Mt++)if(zt=Le[Mt],$t=qe[zt],Ht=Je[zt],!gt[zt]&&!On($t,Ht))if(On($t.source,Ht.source)&&On($t["source-layer"],Ht["source-layer"])&&On($t.type,Ht.type)){for(ui in $($t.layout,Ht.layout,he,zt,null,Qn.setLayoutProperty),$($t.paint,Ht.paint,he,zt,null,Qn.setPaintProperty),On($t.filter,Ht.filter)||he.push({command:Qn.setFilter,args:[zt,Ht.filter]}),On($t.minzoom,Ht.minzoom)&&On($t.maxzoom,Ht.maxzoom)||he.push({command:Qn.setLayerZoomRange,args:[zt,Ht.minzoom,Ht.maxzoom]}),$t)Object.prototype.hasOwnProperty.call($t,ui)&&ui!=="layout"&&ui!=="paint"&&ui!=="filter"&&ui!=="metadata"&&ui!=="minzoom"&&ui!=="maxzoom"&&(ui.indexOf("paint.")===0?$($t[ui],Ht[ui],he,zt,ui.slice(6),Qn.setPaintProperty):On($t[ui],Ht[ui])||he.push({command:Qn.setLayerProperty,args:[zt,ui,Ht[ui]]}));for(ui in Ht)Object.prototype.hasOwnProperty.call(Ht,ui)&&!Object.prototype.hasOwnProperty.call($t,ui)&&ui!=="layout"&&ui!=="paint"&&ui!=="filter"&&ui!=="metadata"&&ui!=="minzoom"&&ui!=="maxzoom"&&(ui.indexOf("paint.")===0?$($t[ui],Ht[ui],he,zt,ui.slice(6),Qn.setPaintProperty):On($t[ui],Ht[ui])||he.push({command:Qn.setLayerProperty,args:[zt,ui,Ht[ui]]}))}else he.push({command:Qn.removeLayer,args:[zt]}),Zt=At[At.lastIndexOf(zt)+1],he.push({command:Qn.addLayer,args:[Ht,Zt]})}(G,u.layers,p)}catch(S){console.warn("Unable to compute style diff:",S),p=[{command:Qn.setStyle,args:[u]}]}return p},a.aF=function(f){const u=[],p=f.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},a.aG=function f(u,p){if(Array.isArray(u)){if(!Array.isArray(p)||u.length!==p.length)return!1;for(let S=0;S<u.length;S++)if(!f(u[S],p[S]))return!1;return!0}if(typeof u=="object"&&u!==null&&p!==null){if(typeof p!="object"||Object.keys(u).length!==Object.keys(p).length)return!1;for(const S in u)if(!f(u[S],p[S]))return!1;return!0}return u===p},a.aH=_t,a.aI=mt,a.aJ=uu,a.aK=function(f){return f({pluginStatus:_a,pluginURL:Ko}),uu.on("pluginStateChange",f),f},a.aL=class extends vs{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},a.aM=Qs,a.aN=class extends vs{constructor(f,u){super(f,u),this.current=Vo}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},a.aO=To,a.aP=class extends vs{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},a.aQ=class extends vs{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},a.aR=No,a.aS=function(f,u,p,S,L,G,Q){var re=1/(u-p),he=1/(S-L),_e=1/(G-Q);return f[0]=-2*re,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*he,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*_e,f[11]=0,f[12]=(u+p)*re,f[13]=(L+S)*he,f[14]=(Q+G)*_e,f[15]=1,f},a.aT=Hi,a.aU=Z0,a.aV=class extends F{},a.aW=ud,a.aX=class extends y{},a.aY=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},a.aZ=h0,a.a_=Et,a.aa=function(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,S,L,G)=>{const Q=L||G;return u[S]=!Q||Q.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u},a.ab=function(f,u){const p=[];for(const S in f)S in u||p.push(S);return p},a.ac=function(f){if(Ft==null){const u=f.navigator?f.navigator.userAgent:null;Ft=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Ft},a.ad=Ge,a.ae=function(f,u,p){var S=Math.sin(p),L=Math.cos(p),G=u[0],Q=u[1],re=u[2],he=u[3],_e=u[4],Le=u[5],qe=u[6],Je=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=G*L+_e*S,f[1]=Q*L+Le*S,f[2]=re*L+qe*S,f[3]=he*L+Je*S,f[4]=_e*L-G*S,f[5]=Le*L-Q*S,f[6]=qe*L-re*S,f[7]=Je*L-he*S,f},a.af=function(f){var u=new qh(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},a.ag=Dl,a.ah=function(f,u){let p=0,S=0;if(f.kind==="constant")S=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:L,minZoom:G,maxZoom:Q}=f,re=L?Ge(vr.interpolationFactor(L,u,G,Q),0,1):0;f.kind==="camera"?S=js.number(f.minSize,f.maxSize,re):p=re}return{uSizeT:p,uSize:S}},a.aj=function(f,{uSize:u,uSizeT:p},{lowerSize:S,upperSize:L}){return f.kind==="source"?S/Yu:f.kind==="composite"?js.number(S/Yu,L/Yu,p):u},a.ak=OA,a.al=function(f,u,p,S){const L=u.y-f.y,G=u.x-f.x,Q=S.y-p.y,re=S.x-p.x,he=Q*G-re*L;if(he===0)return null;const _e=(re*(f.y-p.y)-Q*(f.x-p.x))/he;return new fe(f.x+_e*G,f.y+_e*L)},a.am=Bd,a.an=Xc,a.ao=Hh,a.ap=Ya,a.ar=S0,a.as=function(f,u){var p=u[0],S=u[1],L=u[2],G=u[3],Q=u[4],re=u[5],he=u[6],_e=u[7],Le=u[8],qe=u[9],Je=u[10],At=u[11],gt=u[12],Mt=u[13],Pt=u[14],zt=u[15],$t=p*re-S*Q,Ht=p*he-L*Q,Zt=p*_e-G*Q,ui=S*he-L*re,_i=S*_e-G*re,Xi=L*_e-G*he,xn=Le*Mt-qe*gt,nn=Le*Pt-Je*gt,tn=Le*zt-At*gt,hn=qe*Pt-Je*Mt,zn=qe*zt-At*Mt,en=Je*zt-At*Pt,Wi=$t*en-Ht*zn+Zt*hn+ui*tn-_i*nn+Xi*xn;return Wi?(f[0]=(re*en-he*zn+_e*hn)*(Wi=1/Wi),f[1]=(L*zn-S*en-G*hn)*Wi,f[2]=(Mt*Xi-Pt*_i+zt*ui)*Wi,f[3]=(Je*_i-qe*Xi-At*ui)*Wi,f[4]=(he*tn-Q*en-_e*nn)*Wi,f[5]=(p*en-L*tn+G*nn)*Wi,f[6]=(Pt*Zt-gt*Xi-zt*Ht)*Wi,f[7]=(Le*Xi-Je*Zt+At*Ht)*Wi,f[8]=(Q*zn-re*tn+_e*xn)*Wi,f[9]=(S*tn-p*zn-G*xn)*Wi,f[10]=(gt*_i-Mt*Zt+zt*$t)*Wi,f[11]=(qe*Zt-Le*_i-At*$t)*Wi,f[12]=(re*nn-Q*hn-he*xn)*Wi,f[13]=(p*hn-S*nn+L*xn)*Wi,f[14]=(Mt*Ht-gt*ui-Pt*$t)*Wi,f[15]=(Le*ui-qe*Ht+Je*$t)*Wi,f):null},a.at=zf,a.au=gd,a.av=Nf,a.aw=function(){const f={},u=fi.$version;for(const p in fi.$root){const S=fi.$root[p];if(S.required){let L=null;L=p==="version"?u:S.type==="array"?[]:{},L!=null&&(f[p]=L)}}return f},a.ax=Qn,a.ay=Nl,a.az=yi,a.b=function(f,u){const p=new Blob([new Uint8Array(f)],{type:"image/png"});createImageBitmap(p).then(S=>{u(null,S)}).catch(S=>{u(new Error(`Could not load image because of ${S.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},a.b0=Bn,a.b1=function(f,u){var p=f[0],S=f[1],L=f[2],G=f[3],Q=f[4],re=f[5],he=f[6],_e=f[7],Le=f[8],qe=f[9],Je=f[10],At=f[11],gt=f[12],Mt=f[13],Pt=f[14],zt=f[15],$t=u[0],Ht=u[1],Zt=u[2],ui=u[3],_i=u[4],Xi=u[5],xn=u[6],nn=u[7],tn=u[8],hn=u[9],zn=u[10],en=u[11],Wi=u[12],Dn=u[13],Rn=u[14],dr=u[15];return Math.abs(p-$t)<=Wl*Math.max(1,Math.abs(p),Math.abs($t))&&Math.abs(S-Ht)<=Wl*Math.max(1,Math.abs(S),Math.abs(Ht))&&Math.abs(L-Zt)<=Wl*Math.max(1,Math.abs(L),Math.abs(Zt))&&Math.abs(G-ui)<=Wl*Math.max(1,Math.abs(G),Math.abs(ui))&&Math.abs(Q-_i)<=Wl*Math.max(1,Math.abs(Q),Math.abs(_i))&&Math.abs(re-Xi)<=Wl*Math.max(1,Math.abs(re),Math.abs(Xi))&&Math.abs(he-xn)<=Wl*Math.max(1,Math.abs(he),Math.abs(xn))&&Math.abs(_e-nn)<=Wl*Math.max(1,Math.abs(_e),Math.abs(nn))&&Math.abs(Le-tn)<=Wl*Math.max(1,Math.abs(Le),Math.abs(tn))&&Math.abs(qe-hn)<=Wl*Math.max(1,Math.abs(qe),Math.abs(hn))&&Math.abs(Je-zn)<=Wl*Math.max(1,Math.abs(Je),Math.abs(zn))&&Math.abs(At-en)<=Wl*Math.max(1,Math.abs(At),Math.abs(en))&&Math.abs(gt-Wi)<=Wl*Math.max(1,Math.abs(gt),Math.abs(Wi))&&Math.abs(Mt-Dn)<=Wl*Math.max(1,Math.abs(Mt),Math.abs(Dn))&&Math.abs(Pt-Rn)<=Wl*Math.max(1,Math.abs(Pt),Math.abs(Rn))&&Math.abs(zt-dr)<=Wl*Math.max(1,Math.abs(zt),Math.abs(dr))},a.b2=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.b3=function(f,u,p){return f[0]=u[0]*p[0],f[1]=u[1]*p[1],f[2]=u[2]*p[2],f[3]=u[3]*p[3],f},a.b4=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},a.b5=ni,a.b6=Pd,a.b7=Cd,a.b8=function(f,u,p,S,L){var G,Q=1/Math.tan(u/2);return f[0]=Q/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=Q,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,L!=null&&L!==1/0?(f[10]=(L+S)*(G=1/(S-L)),f[14]=2*L*S*G):(f[10]=-1,f[14]=-2*S),f},a.b9=function(f,u,p){var S=Math.sin(p),L=Math.cos(p),G=u[4],Q=u[5],re=u[6],he=u[7],_e=u[8],Le=u[9],qe=u[10],Je=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=G*L+_e*S,f[5]=Q*L+Le*S,f[6]=re*L+qe*S,f[7]=he*L+Je*S,f[8]=_e*L-G*S,f[9]=Le*L-Q*S,f[10]=qe*L-re*S,f[11]=Je*L-he*S,f},a.bA=ce,a.bB=m0,a.bC=jr,a.bD=ds,a.ba=Bt,a.bb=Rt,a.bc=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},a.bd=class extends ae{},a.be=E0,a.bf=Td,a.bg=Oe,a.bi=Ti,a.bj=function(f,u,p=!1){if(_a===ac||_a===Wu||_a===jl)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ko=qi.resolveURL(f),_a=ac,fs=u,Fu(),p||_r()},a.bk=Ou,a.bl=function(f,u){const p={};for(let L=0;L<f.length;L++){const G=u&&u[f[L].id]||Qa(f[L]);u&&(u[f[L].id]=G);let Q=p[G];Q||(Q=p[G]=[]),Q.push(f[L])}const S=[];for(const L in p)S.push(p[L]);return S},a.bm=Pn,a.bn=k0,a.bo=Fp,a.bp=Tu,a.bq=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Pa/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0],p=u.layout,S=u._unevaluatedLayout._values,L={layoutIconSize:S["icon-size"].possiblyEvaluate(new pn(f.bucket.zoom+1),f.canonical),layoutTextSize:S["text-size"].possiblyEvaluate(new pn(f.bucket.zoom+1),f.canonical),textMaxSize:S["text-size"].possiblyEvaluate(new pn(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.textSizeData;L.compositeTextSizes=[S["text-size"].possiblyEvaluate(new pn(_e),f.canonical),S["text-size"].possiblyEvaluate(new pn(Le),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Le}=f.bucket.iconSizeData;L.compositeIconSizes=[S["icon-size"].possiblyEvaluate(new pn(_e),f.canonical),S["icon-size"].possiblyEvaluate(new pn(Le),f.canonical)]}const G=p.get("text-line-height")*Ya,Q=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",re=p.get("text-keep-upright"),he=p.get("text-size");for(const _e of f.bucket.features){const Le=p.get("text-font").evaluate(_e,{},f.canonical).join(","),qe=he.evaluate(_e,{},f.canonical),Je=L.layoutTextSize.evaluate(_e,{},f.canonical),At=L.layoutIconSize.evaluate(_e,{},f.canonical),gt={horizontal:{},vertical:void 0},Mt=_e.text;let Pt,zt=[0,0];if(Mt){const Zt=Mt.toString(),ui=p.get("text-letter-spacing").evaluate(_e,{},f.canonical)*Ya,_i=In(Zt)?ui:0,Xi=p.get("text-anchor").evaluate(_e,{},f.canonical),xn=QA(u,_e,f.canonical);if(!xn){const en=p.get("text-radial-offset").evaluate(_e,{},f.canonical);zt=en?ZA(Xi,[en*Ya,kh]):p.get("text-offset").evaluate(_e,{},f.canonical).map(Wi=>Wi*Ya)}let nn=Q?"center":p.get("text-justify").evaluate(_e,{},f.canonical);const tn=p.get("symbol-placement"),hn=tn==="point"?p.get("text-max-width").evaluate(_e,{},f.canonical)*Ya:0,zn=()=>{f.bucket.allowVerticalPlacement&&Hl(Zt)&&(gt.vertical=FA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,hn,G,Xi,"left",_i,zt,a.ai.vertical,!0,tn,Je,qe))};if(!Q&&xn){const en=new Set;if(nn==="auto")for(let Dn=0;Dn<xn.values.length;Dn+=2)en.add(zf(xn.values[Dn]));else en.add(nn);let Wi=!1;for(const Dn of en)if(!gt.horizontal[Dn])if(Wi)gt.horizontal[Dn]=gt.horizontal[0];else{const Rn=FA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,hn,G,"center",Dn,_i,zt,a.ai.horizontal,!1,tn,Je,qe);Rn&&(gt.horizontal[Dn]=Rn,Wi=Rn.positionedLines.length===1)}zn()}else{nn==="auto"&&(nn=zf(Xi));const en=FA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,hn,G,Xi,nn,_i,zt,a.ai.horizontal,!1,tn,Je,qe);en&&(gt.horizontal[nn]=en),zn(),Hl(Zt)&&Q&&re&&(gt.vertical=FA(Mt,f.glyphMap,f.glyphPositions,f.imagePositions,Le,hn,G,Xi,nn,_i,zt,a.ai.vertical,!1,tn,Je,qe))}}let $t=!1;if(_e.icon&&_e.icon.name){const Zt=f.imageMap[_e.icon.name];Zt&&(Pt=b0(f.imagePositions[_e.icon.name],p.get("icon-offset").evaluate(_e,{},f.canonical),p.get("icon-anchor").evaluate(_e,{},f.canonical)),$t=!!Zt.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=$t:f.bucket.sdfIcons!==$t&&nt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Zt.pixelRatio!==f.bucket.pixelRatio||p.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const Ht=Ff(gt.horizontal)||gt.vertical;f.bucket.iconsInText=!!Ht&&Ht.iconsInText,(Ht||Pt)&&P0(f.bucket,_e,gt,Pt,f.imageMap,L,Je,At,zt,$t,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},a.br=rd,a.bs=vf,a.bt=Ul,a.bu=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},a.bv=y0,a.bw=Sh,a.bx=function(f,u,p,S,L){return U(this,void 0,void 0,function*(){if(kt())try{return yield bi(f,u,p,S,L)}catch{}return function(G,Q,re,he,_e){const Le=G.width,qe=G.height;ki&&Gi||(ki=new OffscreenCanvas(Le,qe),Gi=ki.getContext("2d",{willReadFrequently:!0})),ki.width=Le,ki.height=qe,Gi.drawImage(G,0,0,Le,qe);const Je=Gi.getImageData(Q,re,he,_e);return Gi.clearRect(0,0,Le,qe),Je.data}(f,u,p,S,L)})},a.by=T0,a.bz=W,a.c=sn,a.d=function(f,u){const p=new Image;p.onload=()=>{u(null,p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=ci})},p.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const S=new Blob([new Uint8Array(f)],{type:"image/png"});p.src=f.byteLength?URL.createObjectURL(S):ci},a.e=it,a.f=function(f,u){return Li(it(f,{type:"json"}),u)},a.g=hi,a.h=qi,a.i=Nt,a.j=Mn,a.k=ti,a.l=fn,a.m=Li,a.n=function(f){return new y0(f).readFields(LA,[])},a.o=function(f,u,p){if(!f.length)return p(null,[]);let S=f.length;const L=new Array(f.length);let G=null;f.forEach((Q,re)=>{u(Q,(he,_e)=>{he&&(G=he),L[re]=_e,--S==0&&p(G,L)})})},a.p=Cf,a.q=vh,a.r=cs,a.s=_n,a.t=po,a.u=Sn,a.v=fi,a.w=nt,a.x=zu,a.y=Xa,a.z=function([f,u,p]){return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(p),y:f*Math.sin(u)*Math.sin(p),z:f*Math.cos(p)}}}),b(["./shared"],function(a){class U{constructor(X){this.keyCache={},X&&this.replace(X)}replace(X){this._layerConfigs={},this._layers={},this.update(X,[])}update(X,ie){for(const ye of X){this._layerConfigs[ye.id]=ye;const ge=this._layers[ye.id]=a.aC(ye);ge._featureFilter=a.a6(ge.filter),this.keyCache[ye.id]&&delete this.keyCache[ye.id]}for(const ye of ie)delete this.keyCache[ye],delete this._layerConfigs[ye],delete this._layers[ye];this.familiesBySource={};const de=a.bl(Object.values(this._layerConfigs),this.keyCache);for(const ye of de){const ge=ye.map(De=>this._layers[De.id]),Pe=ge[0];if(Pe.visibility==="none")continue;const Fe=Pe.source||"";let Ne=this.familiesBySource[Fe];Ne||(Ne=this.familiesBySource[Fe]={});const Xe=Pe.sourceLayer||"_geojsonTileLayer";let Ye=Ne[Xe];Ye||(Ye=Ne[Xe]=[]),Ye.push(ge)}}}class W{constructor(X){const ie={},de=[];for(const Fe in X){const Ne=X[Fe],Xe=ie[Fe]={};for(const Ye in Ne){const De=Ne[+Ye];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const Ue={x:0,y:0,w:De.bitmap.width+2,h:De.bitmap.height+2};de.push(Ue),Xe[Ye]={rect:Ue,metrics:De.metrics}}}const{w:ye,h:ge}=a.p(de),Pe=new a.q({width:ye||1,height:ge||1});for(const Fe in X){const Ne=X[Fe];for(const Xe in Ne){const Ye=Ne[+Xe];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const De=ie[Fe][Xe].rect;a.q.copy(Ye.bitmap,Pe,{x:0,y:0},{x:De.x+1,y:De.y+1},Ye.bitmap)}}this.image=Pe,this.positions=ie}}a.bm("GlyphAtlas",W);class ce{constructor(X){this.tileID=new a.O(X.tileID.overscaledZ,X.tileID.wrap,X.tileID.canonical.z,X.tileID.canonical.x,X.tileID.canonical.y),this.uid=X.uid,this.zoom=X.zoom,this.pixelRatio=X.pixelRatio,this.tileSize=X.tileSize,this.source=X.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=X.showCollisionBoxes,this.collectResourceTiming=!!X.collectResourceTiming,this.returnDependencies=!!X.returnDependencies,this.promoteId=X.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(X,ie,de,ye,ge){this.status="parsing",this.data=X,this.collisionBoxArray=new a.a3;const Pe=new a.bn(Object.keys(X.layers).sort()),Fe=new a.bo(this.tileID,this.promoteId);Fe.bucketLayerIDs=[];const Ne={},Xe={featureIndex:Fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:de},Ye=ie.familiesBySource[this.source];for(const Kt in Ye){const oi=X.layers[Kt];if(!oi)continue;oi.version===1&&a.w(`Vector tile source "${this.source}" layer "${Kt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ri=Pe.encode(Kt),vi=[];for(let wi=0;wi<oi.length;wi++){const Yt=oi.feature(wi),vn=Fe.getId(Yt,Kt);vi.push({feature:Yt,id:vn,index:wi,sourceLayerIndex:Ri})}for(const wi of Ye[Kt]){const Yt=wi[0];Yt.source!==this.source&&a.w(`layer.source = ${Yt.source} does not equal this.source = ${this.source}`),Yt.minzoom&&this.zoom<Math.floor(Yt.minzoom)||Yt.maxzoom&&this.zoom>=Yt.maxzoom||Yt.visibility!=="none"&&(oe(wi,this.zoom,de),(Ne[Yt.id]=Yt.createBucket({index:Fe.bucketLayerIDs.length,layers:wi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ri,sourceID:this.source})).populate(vi,Xe,this.tileID.canonical),Fe.bucketLayerIDs.push(wi.map(vn=>vn.id)))}}let De,Ue,ht,Tt;const o=a.aH(Xe.glyphDependencies,Kt=>Object.keys(Kt).map(Number));this.inFlightDependencies.forEach(Kt=>Kt==null?void 0:Kt.cancel()),this.inFlightDependencies=[];const ke=++this.dependencySentinel;Object.keys(o).length?this.inFlightDependencies.push(ye.send("getGlyphs",{uid:this.uid,stacks:o,source:this.source,tileID:this.tileID,type:"glyphs"},(Kt,oi)=>{ke===this.dependencySentinel&&(De||(De=Kt,Ue=oi,Ai.call(this)))})):Ue={};const ai=Object.keys(Xe.iconDependencies);ai.length?this.inFlightDependencies.push(ye.send("getImages",{icons:ai,source:this.source,tileID:this.tileID,type:"icons"},(Kt,oi)=>{ke===this.dependencySentinel&&(De||(De=Kt,ht=oi,Ai.call(this)))})):ht={};const di=Object.keys(Xe.patternDependencies);function Ai(){if(De)return ge(De);if(Ue&&ht&&Tt){const Kt=new W(Ue),oi=new a.bp(ht,Tt);for(const Ri in Ne){const vi=Ne[Ri];vi instanceof a.a4?(oe(vi.layers,this.zoom,de),a.bq({bucket:vi,glyphMap:Ue,glyphPositions:Kt.positions,imageMap:ht,imagePositions:oi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):vi.hasPattern&&(vi instanceof a.br||vi instanceof a.bs||vi instanceof a.bt)&&(oe(vi.layers,this.zoom,de),vi.addFeatures(Xe,this.tileID.canonical,oi.patternPositions))}this.status="done",ge(null,{buckets:Object.values(Ne).filter(Ri=>!Ri.isEmpty()),featureIndex:Fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Kt.image,imageAtlas:oi,glyphMap:this.returnDependencies?Ue:null,iconMap:this.returnDependencies?ht:null,glyphPositions:this.returnDependencies?Kt.positions:null})}}di.length?this.inFlightDependencies.push(ye.send("getImages",{icons:di,source:this.source,tileID:this.tileID,type:"patterns"},(Kt,oi)=>{ke===this.dependencySentinel&&(De||(De=Kt,Tt=oi,Ai.call(this)))})):Tt={},Ai.call(this)}}function oe(ne,X,ie){const de=new a.a8(X);for(const ye of ne)ye.recalculate(de,ie)}function fe(ne,X){const ie=a.l(ne.request,(de,ye,ge,Pe)=>{if(de)X(de);else if(ye)try{const Fe=new a.bw.VectorTile(new a.bv(ye));X(null,{vectorTile:Fe,rawData:ye,cacheControl:ge,expires:Pe})}catch(Fe){const Ne=new Uint8Array(ye);let Xe=`Unable to parse the tile at ${ne.request.url}, `;Xe+=Ne[0]===31&&Ne[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Fe.messge}`,X(new Error(Xe))}});return()=>{ie.cancel(),X()}}class we{constructor(X,ie,de,ye){this.actor=X,this.layerIndex=ie,this.availableImages=de,this.loadVectorData=ye||fe,this.fetching={},this.loading={},this.loaded={}}loadTile(X,ie){const de=X.uid;this.loading||(this.loading={});const ye=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bu(X.request),ge=this.loading[de]=new ce(X);ge.abort=this.loadVectorData(X,(Pe,Fe)=>{if(delete this.loading[de],Pe||!Fe)return ge.status="done",this.loaded[de]=ge,ie(Pe);const Ne=Fe.rawData,Xe={};Fe.expires&&(Xe.expires=Fe.expires),Fe.cacheControl&&(Xe.cacheControl=Fe.cacheControl);const Ye={};if(ye){const De=ye.finish();De&&(Ye.resourceTiming=JSON.parse(JSON.stringify(De)))}ge.vectorTile=Fe.vectorTile,ge.parse(Fe.vectorTile,this.layerIndex,this.availableImages,this.actor,(De,Ue)=>{if(delete this.fetching[de],De||!Ue)return ie(De);ie(null,a.e({rawTileData:Ne.slice(0)},Ue,Xe,Ye))}),this.loaded=this.loaded||{},this.loaded[de]=ge,this.fetching[de]={rawTileData:Ne,cacheControl:Xe,resourceTiming:Ye}})}reloadTile(X,ie){const de=this.loaded,ye=X.uid;if(de&&de[ye]){const ge=de[ye];ge.showCollisionBoxes=X.showCollisionBoxes,ge.status==="parsing"?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,(Pe,Fe)=>{if(Pe||!Fe)return ie(Pe,Fe);let Ne;if(this.fetching[ye]){const{rawTileData:Xe,cacheControl:Ye,resourceTiming:De}=this.fetching[ye];delete this.fetching[ye],Ne=a.e({rawTileData:Xe.slice(0)},Fe,Ye,De)}else Ne=Fe;ie(null,Ne)}):ge.status==="done"&&(ge.vectorTile?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,ie):ie())}}abortTile(X,ie){const de=this.loading,ye=X.uid;de&&de[ye]&&de[ye].abort&&(de[ye].abort(),delete de[ye]),ie()}removeTile(X,ie){const de=this.loaded,ye=X.uid;de&&de[ye]&&delete de[ye],ie()}}class et{constructor(){this.loaded={}}loadTile(X,ie){return a._(this,void 0,void 0,function*(){const{uid:de,encoding:ye,rawImageData:ge,redFactor:Pe,greenFactor:Fe,blueFactor:Ne,baseShift:Xe}=X,Ye=ge.width+2,De=ge.height+2,Ue=a.a(ge)?new a.R({width:Ye,height:De},yield a.bx(ge,-1,-1,Ye,De)):ge,ht=new a.by(de,Ue,ye,Pe,Fe,Ne,Xe);this.loaded=this.loaded||{},this.loaded[de]=ht,ie(null,ht)})}removeTile(X){const ie=this.loaded,de=X.uid;ie&&ie[de]&&delete ie[de]}}function lt(ne,X){if(ne.length!==0){Ke(ne[0],X);for(var ie=1;ie<ne.length;ie++)Ke(ne[ie],!X)}}function Ke(ne,X){for(var ie=0,de=0,ye=0,ge=ne.length,Pe=ge-1;ye<ge;Pe=ye++){var Fe=(ne[ye][0]-ne[Pe][0])*(ne[Pe][1]+ne[ye][1]),Ne=ie+Fe;de+=Math.abs(ie)>=Math.abs(Fe)?ie-Ne+Fe:Fe-Ne+ie,ie=Ne}ie+de>=0!=!!X&&ne.reverse()}var st=a.bz(function ne(X,ie){var de,ye=X&&X.type;if(ye==="FeatureCollection")for(de=0;de<X.features.length;de++)ne(X.features[de],ie);else if(ye==="GeometryCollection")for(de=0;de<X.geometries.length;de++)ne(X.geometries[de],ie);else if(ye==="Feature")ne(X.geometry,ie);else if(ye==="Polygon")lt(X.coordinates,ie);else if(ye==="MultiPolygon")for(de=0;de<X.coordinates.length;de++)lt(X.coordinates[de],ie);return X});const ut=a.bw.VectorTileFeature.prototype.toGeoJSON;var kt={exports:{}},Bt=a.bA,Rt=a.bw.VectorTileFeature,Ge=ni;function ni(ne,X){this.options=X||{},this.features=ne,this.length=ne.length}function it(ne,X){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=X||4096}ni.prototype.feature=function(ne){return new it(this.features[ne],this.options.extent)},it.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var X=0;X<ne.length;X++){for(var ie=ne[X],de=[],ye=0;ye<ie.length;ye++)de.push(new Bt(ie[ye][0],ie[ye][1]));this.geometry.push(de)}return this.geometry},it.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,X=1/0,ie=-1/0,de=1/0,ye=-1/0,ge=0;ge<ne.length;ge++)for(var Pe=ne[ge],Fe=0;Fe<Pe.length;Fe++){var Ne=Pe[Fe];X=Math.min(X,Ne.x),ie=Math.max(ie,Ne.x),de=Math.min(de,Ne.y),ye=Math.max(ye,Ne.y)}return[X,de,ie,ye]},it.prototype.toGeoJSON=Rt.prototype.toGeoJSON;var xt=a.bB,_t=Ge;function mt(ne){var X=new xt;return function(ie,de){for(var ye in ie.layers)de.writeMessage(3,bt,ie.layers[ye])}(ne,X),X.finish()}function bt(ne,X){var ie;X.writeVarintField(15,ne.version||1),X.writeStringField(1,ne.name||""),X.writeVarintField(5,ne.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(ie=0;ie<ne.length;ie++)de.feature=ne.feature(ie),X.writeMessage(2,dt,de);var ye=de.keys;for(ie=0;ie<ye.length;ie++)X.writeStringField(3,ye[ie]);var ge=de.values;for(ie=0;ie<ge.length;ie++)X.writeMessage(4,Ft,ge[ie])}function dt(ne,X){var ie=ne.feature;ie.id!==void 0&&X.writeVarintField(1,ie.id),X.writeMessage(2,nt,ne),X.writeVarintField(3,ie.type),X.writeMessage(4,Nt,ie)}function nt(ne,X){var ie=ne.feature,de=ne.keys,ye=ne.values,ge=ne.keycache,Pe=ne.valuecache;for(var Fe in ie.properties){var Ne=ie.properties[Fe],Xe=ge[Fe];if(Ne!==null){Xe===void 0&&(de.push(Fe),ge[Fe]=Xe=de.length-1),X.writeVarint(Xe);var Ye=typeof Ne;Ye!=="string"&&Ye!=="boolean"&&Ye!=="number"&&(Ne=JSON.stringify(Ne));var De=Ye+":"+Ne,Ue=Pe[De];Ue===void 0&&(ye.push(Ne),Pe[De]=Ue=ye.length-1),X.writeVarint(Ue)}}}function pt(ne,X){return(X<<3)+(7&ne)}function at(ne){return ne<<1^ne>>31}function Nt(ne,X){for(var ie=ne.loadGeometry(),de=ne.type,ye=0,ge=0,Pe=ie.length,Fe=0;Fe<Pe;Fe++){var Ne=ie[Fe],Xe=1;de===1&&(Xe=Ne.length),X.writeVarint(pt(1,Xe));for(var Ye=de===3?Ne.length-1:Ne.length,De=0;De<Ye;De++){De===1&&de!==1&&X.writeVarint(pt(2,Ye-1));var Ue=Ne[De].x-ye,ht=Ne[De].y-ge;X.writeVarint(at(Ue)),X.writeVarint(at(ht)),ye+=Ue,ge+=ht}de===3&&X.writeVarint(pt(7,1))}}function Ft(ne,X){var ie=typeof ne;ie==="string"?X.writeStringField(1,ne):ie==="boolean"?X.writeBooleanField(7,ne):ie==="number"&&(ne%1!=0?X.writeDoubleField(3,ne):ne<0?X.writeSVarintField(6,ne):X.writeVarintField(5,ne))}kt.exports=mt,kt.exports.fromVectorTileJs=mt,kt.exports.fromGeojsonVt=function(ne,X){X=X||{};var ie={};for(var de in ne)ie[de]=new _t(ne[de].features,X),ie[de].name=de,ie[de].version=X.version,ie[de].extent=X.extent;return mt({layers:ie})},kt.exports.GeoJSONWrapper=_t;var Dt=a.bz(kt.exports);const ci={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},bi=Math.fround||(ki=new Float32Array(1),ne=>(ki[0]=+ne,ki[0]));var ki;const Gi=3,rn=5,$i=6;class qi{constructor(X){this.options=Object.assign(Object.create(ci),X),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(X){const{log:ie,minZoom:de,maxZoom:ye}=this.options;ie&&console.time("total time");const ge=`prepare ${X.length} points`;ie&&console.time(ge),this.points=X;const Pe=[];for(let Ne=0;Ne<X.length;Ne++){const Xe=X[Ne];if(!Xe.geometry)continue;const[Ye,De]=Xe.geometry.coordinates,Ue=bi(yi(Ye)),ht=bi(hi(De));Pe.push(Ue,ht,1/0,Ne,-1,1),this.options.reduce&&Pe.push(0)}let Fe=this.trees[ye+1]=this._createTree(Pe);ie&&console.timeEnd(ge);for(let Ne=ye;Ne>=de;Ne--){const Xe=+Date.now();Fe=this.trees[Ne]=this._createTree(this._cluster(Fe,Ne)),ie&&console.log("z%d: %d clusters in %dms",Ne,Fe.numItems,+Date.now()-Xe)}return ie&&console.timeEnd("total time"),this}getClusters(X,ie){let de=((X[0]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,X[1]));let ge=X[2]===180?180:((X[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)de=-180,ge=180;else if(de>ge){const De=this.getClusters([de,ye,180,Pe],ie),Ue=this.getClusters([-180,ye,ge,Pe],ie);return De.concat(Ue)}const Fe=this.trees[this._limitZoom(ie)],Ne=Fe.range(yi(de),hi(Pe),yi(ge),hi(ye)),Xe=Fe.data,Ye=[];for(const De of Ne){const Ue=this.stride*De;Ye.push(Xe[Ue+rn]>1?sn(Xe,Ue,this.clusterProps):this.points[Xe[Ue+Gi]])}return Ye}getChildren(X){const ie=this._getOriginId(X),de=this._getOriginZoom(X),ye="No cluster with the specified id.",ge=this.trees[de];if(!ge)throw new Error(ye);const Pe=ge.data;if(ie*this.stride>=Pe.length)throw new Error(ye);const Fe=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Ne=ge.within(Pe[ie*this.stride],Pe[ie*this.stride+1],Fe),Xe=[];for(const Ye of Ne){const De=Ye*this.stride;Pe[De+4]===X&&Xe.push(Pe[De+rn]>1?sn(Pe,De,this.clusterProps):this.points[Pe[De+Gi]])}if(Xe.length===0)throw new Error(ye);return Xe}getLeaves(X,ie,de){const ye=[];return this._appendLeaves(ye,X,ie=ie||10,de=de||0,0),ye}getTile(X,ie,de){const ye=this.trees[this._limitZoom(X)],ge=Math.pow(2,X),{extent:Pe,radius:Fe}=this.options,Ne=Fe/Pe,Xe=(de-Ne)/ge,Ye=(de+1+Ne)/ge,De={features:[]};return this._addTileFeatures(ye.range((ie-Ne)/ge,Xe,(ie+1+Ne)/ge,Ye),ye.data,ie,de,ge,De),ie===0&&this._addTileFeatures(ye.range(1-Ne/ge,Xe,1,Ye),ye.data,ge,de,ge,De),ie===ge-1&&this._addTileFeatures(ye.range(0,Xe,Ne/ge,Ye),ye.data,-1,de,ge,De),De.features.length?De:null}getClusterExpansionZoom(X){let ie=this._getOriginZoom(X)-1;for(;ie<=this.options.maxZoom;){const de=this.getChildren(X);if(ie++,de.length!==1)break;X=de[0].properties.cluster_id}return ie}_appendLeaves(X,ie,de,ye,ge){const Pe=this.getChildren(ie);for(const Fe of Pe){const Ne=Fe.properties;if(Ne&&Ne.cluster?ge+Ne.point_count<=ye?ge+=Ne.point_count:ge=this._appendLeaves(X,Ne.cluster_id,de,ye,ge):ge<ye?ge++:X.push(Fe),X.length===de)break}return ge}_createTree(X){const ie=new a.av(X.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<X.length;de+=this.stride)ie.add(X[de],X[de+1]);return ie.finish(),ie.data=X,ie}_addTileFeatures(X,ie,de,ye,ge,Pe){for(const Fe of X){const Ne=Fe*this.stride,Xe=ie[Ne+rn]>1;let Ye,De,Ue;if(Xe)Ye=Ti(ie,Ne,this.clusterProps),De=ie[Ne],Ue=ie[Ne+1];else{const o=this.points[ie[Ne+Gi]];Ye=o.properties;const[ke,ai]=o.geometry.coordinates;De=yi(ke),Ue=hi(ai)}const ht={type:1,geometry:[[Math.round(this.options.extent*(De*ge-de)),Math.round(this.options.extent*(Ue*ge-ye))]],tags:Ye};let Tt;Tt=Xe||this.options.generateId?ie[Ne+Gi]:this.points[ie[Ne+Gi]].id,Tt!==void 0&&(ht.id=Tt),Pe.features.push(ht)}}_limitZoom(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))}_cluster(X,ie){const{radius:de,extent:ye,reduce:ge,minPoints:Pe}=this.options,Fe=de/(ye*Math.pow(2,ie)),Ne=X.data,Xe=[],Ye=this.stride;for(let De=0;De<Ne.length;De+=Ye){if(Ne[De+2]<=ie)continue;Ne[De+2]=ie;const Ue=Ne[De],ht=Ne[De+1],Tt=X.within(Ne[De],Ne[De+1],Fe),o=Ne[De+rn];let ke=o;for(const ai of Tt){const di=ai*Ye;Ne[di+2]>ie&&(ke+=Ne[di+rn])}if(ke>o&&ke>=Pe){let ai,di=Ue*o,Ai=ht*o,Kt=-1;const oi=((De/Ye|0)<<5)+(ie+1)+this.points.length;for(const Ri of Tt){const vi=Ri*Ye;if(Ne[vi+2]<=ie)continue;Ne[vi+2]=ie;const wi=Ne[vi+rn];di+=Ne[vi]*wi,Ai+=Ne[vi+1]*wi,Ne[vi+4]=oi,ge&&(ai||(ai=this._map(Ne,De,!0),Kt=this.clusterProps.length,this.clusterProps.push(ai)),ge(ai,this._map(Ne,vi)))}Ne[De+4]=oi,Xe.push(di/ke,Ai/ke,1/0,oi,-1,ke),ge&&Xe.push(Kt)}else{for(let ai=0;ai<Ye;ai++)Xe.push(Ne[De+ai]);if(ke>1)for(const ai of Tt){const di=ai*Ye;if(!(Ne[di+2]<=ie)){Ne[di+2]=ie;for(let Ai=0;Ai<Ye;Ai++)Xe.push(Ne[di+Ai])}}}}return Xe}_getOriginId(X){return X-this.points.length>>5}_getOriginZoom(X){return(X-this.points.length)%32}_map(X,ie,de){if(X[ie+rn]>1){const Pe=this.clusterProps[X[ie+$i]];return de?Object.assign({},Pe):Pe}const ye=this.points[X[ie+Gi]].properties,ge=this.options.map(ye);return de&&ge===ye?Object.assign({},ge):ge}}function sn(ne,X,ie){return{type:"Feature",id:ne[X+Gi],properties:Ti(ne,X,ie),geometry:{type:"Point",coordinates:[(de=ne[X],360*(de-.5)),Ei(ne[X+1])]}};var de}function Ti(ne,X,ie){const de=ne[X+rn],ye=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,ge=ne[X+$i],Pe=ge===-1?{}:Object.assign({},ie[ge]);return Object.assign(Pe,{cluster:!0,cluster_id:ne[X+Gi],point_count:de,point_count_abbreviated:ye})}function yi(ne){return ne/360+.5}function hi(ne){const X=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return ie<0?0:ie>1?1:ie}function Ei(ne){const X=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function Li(ne,X,ie,de){for(var ye,ge=de,Pe=ie-X>>1,Fe=ie-X,Ne=ne[X],Xe=ne[X+1],Ye=ne[ie],De=ne[ie+1],Ue=X+3;Ue<ie;Ue+=3){var ht=fn(ne[Ue],ne[Ue+1],Ne,Xe,Ye,De);if(ht>ge)ye=Ue,ge=ht;else if(ht===ge){var Tt=Math.abs(Ue-Pe);Tt<Fe&&(ye=Ue,Fe=Tt)}}ge>de&&(ye-X>3&&Li(ne,X,ye,de),ne[ye+2]=ge,ie-ye>3&&Li(ne,ye,ie,de))}function fn(ne,X,ie,de,ye,ge){var Pe=ye-ie,Fe=ge-de;if(Pe!==0||Fe!==0){var Ne=((ne-ie)*Pe+(X-de)*Fe)/(Pe*Pe+Fe*Fe);Ne>1?(ie=ye,de=ge):Ne>0&&(ie+=Pe*Ne,de+=Fe*Ne)}return(Pe=ne-ie)*Pe+(Fe=X-de)*Fe}function _n(ne,X,ie,de){var ye={id:ne===void 0?null:ne,type:X,geometry:ie,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Pe=ge.geometry,Fe=ge.type;if(Fe==="Point"||Fe==="MultiPoint"||Fe==="LineString")gi(ge,Pe);else if(Fe==="Polygon"||Fe==="MultiLineString")for(var Ne=0;Ne<Pe.length;Ne++)gi(ge,Pe[Ne]);else if(Fe==="MultiPolygon")for(Ne=0;Ne<Pe.length;Ne++)for(var Xe=0;Xe<Pe[Ne].length;Xe++)gi(ge,Pe[Ne][Xe])}(ye),ye}function gi(ne,X){for(var ie=0;ie<X.length;ie+=3)ne.minX=Math.min(ne.minX,X[ie]),ne.minY=Math.min(ne.minY,X[ie+1]),ne.maxX=Math.max(ne.maxX,X[ie]),ne.maxY=Math.max(ne.maxY,X[ie+1])}function mn(ne,X,ie,de){if(X.geometry){var ye=X.geometry.coordinates,ge=X.geometry.type,Pe=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2),Fe=[],Ne=X.id;if(ie.promoteId?Ne=X.properties[ie.promoteId]:ie.generateId&&(Ne=de||0),ge==="Point")ti(ye,Fe);else if(ge==="MultiPoint")for(var Xe=0;Xe<ye.length;Xe++)ti(ye[Xe],Fe);else if(ge==="LineString")Mn(ye,Fe,Pe,!1);else if(ge==="MultiLineString"){if(ie.lineMetrics){for(Xe=0;Xe<ye.length;Xe++)Mn(ye[Xe],Fe=[],Pe,!1),ne.push(_n(Ne,"LineString",Fe,X.properties));return}ns(ye,Fe,Pe,!1)}else if(ge==="Polygon")ns(ye,Fe,Pe,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Xe=0;Xe<X.geometry.geometries.length;Xe++)mn(ne,{id:Ne,geometry:X.geometry.geometries[Xe],properties:X.properties},ie,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Xe=0;Xe<ye.length;Xe++){var Ye=[];ns(ye[Xe],Ye,Pe,!0),Fe.push(Ye)}}ne.push(_n(Ne,ge,Fe,X.properties))}}function ti(ne,X){X.push(fi(ne[0])),X.push(ln(ne[1])),X.push(0)}function Mn(ne,X,ie,de){for(var ye,ge,Pe=0,Fe=0;Fe<ne.length;Fe++){var Ne=fi(ne[Fe][0]),Xe=ln(ne[Fe][1]);X.push(Ne),X.push(Xe),X.push(0),Fe>0&&(Pe+=de?(ye*Xe-Ne*ge)/2:Math.sqrt(Math.pow(Ne-ye,2)+Math.pow(Xe-ge,2))),ye=Ne,ge=Xe}var Ye=X.length-3;X[2]=1,Li(X,0,Ye,ie),X[Ye+2]=1,X.size=Math.abs(Pe),X.start=0,X.end=X.size}function ns(ne,X,ie,de){for(var ye=0;ye<ne.length;ye++){var ge=[];Mn(ne[ye],ge,ie,de),X.push(ge)}}function fi(ne){return ne/360+.5}function ln(ne){var X=Math.sin(ne*Math.PI/180),ie=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return ie<0?0:ie>1?1:ie}function pr(ne,X,ie,de,ye,ge,Pe,Fe){if(de/=X,ge>=(ie/=X)&&Pe<de)return ne;if(Pe<ie||ge>=de)return null;for(var Ne=[],Xe=0;Xe<ne.length;Xe++){var Ye=ne[Xe],De=Ye.geometry,Ue=Ye.type,ht=ye===0?Ye.minX:Ye.minY,Tt=ye===0?Ye.maxX:Ye.maxY;if(ht>=ie&&Tt<de)Ne.push(Ye);else if(!(Tt<ie||ht>=de)){var o=[];if(Ue==="Point"||Ue==="MultiPoint")On(De,o,ie,de,ye);else if(Ue==="LineString")Qn(De,o,ie,de,ye,!1,Fe.lineMetrics);else if(Ue==="MultiLineString")v(De,o,ie,de,ye,!1);else if(Ue==="Polygon")v(De,o,ie,de,ye,!0);else if(Ue==="MultiPolygon")for(var ke=0;ke<De.length;ke++){var ai=[];v(De[ke],ai,ie,de,ye,!0),ai.length&&o.push(ai)}if(o.length){if(Fe.lineMetrics&&Ue==="LineString"){for(ke=0;ke<o.length;ke++)Ne.push(_n(Ye.id,Ue,o[ke],Ye.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(o.length===1?(Ue="LineString",o=o[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=o.length===3?"Point":"MultiPoint"),Ne.push(_n(Ye.id,Ue,o,Ye.tags))}}}return Ne.length?Ne:null}function On(ne,X,ie,de,ye){for(var ge=0;ge<ne.length;ge+=3){var Pe=ne[ge+ye];Pe>=ie&&Pe<=de&&(X.push(ne[ge]),X.push(ne[ge+1]),X.push(ne[ge+2]))}}function Qn(ne,X,ie,de,ye,ge,Pe){for(var Fe,Ne,Xe=wn(ne),Ye=ye===0?V:$,De=ne.start,Ue=0;Ue<ne.length-3;Ue+=3){var ht=ne[Ue],Tt=ne[Ue+1],o=ne[Ue+2],ke=ne[Ue+3],ai=ne[Ue+4],di=ye===0?ht:Tt,Ai=ye===0?ke:ai,Kt=!1;Pe&&(Fe=Math.sqrt(Math.pow(ht-ke,2)+Math.pow(Tt-ai,2))),di<ie?Ai>ie&&(Ne=Ye(Xe,ht,Tt,ke,ai,ie),Pe&&(Xe.start=De+Fe*Ne)):di>de?Ai<de&&(Ne=Ye(Xe,ht,Tt,ke,ai,de),Pe&&(Xe.start=De+Fe*Ne)):k(Xe,ht,Tt,o),Ai<ie&&di>=ie&&(Ne=Ye(Xe,ht,Tt,ke,ai,ie),Kt=!0),Ai>de&&di<=de&&(Ne=Ye(Xe,ht,Tt,ke,ai,de),Kt=!0),!ge&&Kt&&(Pe&&(Xe.end=De+Fe*Ne),X.push(Xe),Xe=wn(ne)),Pe&&(De+=Fe)}var oi=ne.length-3;ht=ne[oi],Tt=ne[oi+1],o=ne[oi+2],(di=ye===0?ht:Tt)>=ie&&di<=de&&k(Xe,ht,Tt,o),oi=Xe.length-3,ge&&oi>=3&&(Xe[oi]!==Xe[0]||Xe[oi+1]!==Xe[1])&&k(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&X.push(Xe)}function wn(ne){var X=[];return X.size=ne.size,X.start=ne.start,X.end=ne.end,X}function v(ne,X,ie,de,ye,ge){for(var Pe=0;Pe<ne.length;Pe++)Qn(ne[Pe],X,ie,de,ye,ge,!1)}function k(ne,X,ie,de){ne.push(X),ne.push(ie),ne.push(de)}function V(ne,X,ie,de,ye,ge){var Pe=(ge-X)/(de-X);return ne.push(ge),ne.push(ie+(ye-ie)*Pe),ne.push(1),Pe}function $(ne,X,ie,de,ye,ge){var Pe=(ge-ie)/(ye-ie);return ne.push(X+(de-X)*Pe),ne.push(ge),ne.push(1),Pe}function te(ne,X){for(var ie=[],de=0;de<ne.length;de++){var ye,ge=ne[de],Pe=ge.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")ye=Ae(ge.geometry,X);else if(Pe==="MultiLineString"||Pe==="Polygon"){ye=[];for(var Fe=0;Fe<ge.geometry.length;Fe++)ye.push(Ae(ge.geometry[Fe],X))}else if(Pe==="MultiPolygon")for(ye=[],Fe=0;Fe<ge.geometry.length;Fe++){for(var Ne=[],Xe=0;Xe<ge.geometry[Fe].length;Xe++)Ne.push(Ae(ge.geometry[Fe][Xe],X));ye.push(Ne)}ie.push(_n(ge.id,Pe,ye,ge.tags))}return ie}function Ae(ne,X){var ie=[];ie.size=ne.size,ne.start!==void 0&&(ie.start=ne.start,ie.end=ne.end);for(var de=0;de<ne.length;de+=3)ie.push(ne[de]+X,ne[de+1],ne[de+2]);return ie}function ve(ne,X){if(ne.transformed)return ne;var ie,de,ye,ge=1<<ne.z,Pe=ne.x,Fe=ne.y;for(ie=0;ie<ne.features.length;ie++){var Ne=ne.features[ie],Xe=Ne.geometry,Ye=Ne.type;if(Ne.geometry=[],Ye===1)for(de=0;de<Xe.length;de+=2)Ne.geometry.push(Ie(Xe[de],Xe[de+1],X,ge,Pe,Fe));else for(de=0;de<Xe.length;de++){var De=[];for(ye=0;ye<Xe[de].length;ye+=2)De.push(Ie(Xe[de][ye],Xe[de][ye+1],X,ge,Pe,Fe));Ne.geometry.push(De)}}return ne.transformed=!0,ne}function Ie(ne,X,ie,de,ye,ge){return[Math.round(ie*(ne*de-ye)),Math.round(ie*(X*de-ge))]}function Ee(ne,X,ie,de,ye){for(var ge=X===ye.maxZoom?0:ye.tolerance/((1<<X)*ye.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ie,y:de,z:X,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Fe=0;Fe<ne.length;Fe++){Pe.numFeatures++,ze(Pe,ne[Fe],ge,ye);var Ne=ne[Fe].minX,Xe=ne[Fe].minY,Ye=ne[Fe].maxX,De=ne[Fe].maxY;Ne<Pe.minX&&(Pe.minX=Ne),Xe<Pe.minY&&(Pe.minY=Xe),Ye>Pe.maxX&&(Pe.maxX=Ye),De>Pe.maxY&&(Pe.maxY=De)}return Pe}function ze(ne,X,ie,de){var ye=X.geometry,ge=X.type,Pe=[];if(ge==="Point"||ge==="MultiPoint")for(var Fe=0;Fe<ye.length;Fe+=3)Pe.push(ye[Fe]),Pe.push(ye[Fe+1]),ne.numPoints++,ne.numSimplified++;else if(ge==="LineString")Qe(Pe,ye,ne,ie,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(Fe=0;Fe<ye.length;Fe++)Qe(Pe,ye[Fe],ne,ie,ge==="Polygon",Fe===0);else if(ge==="MultiPolygon")for(var Ne=0;Ne<ye.length;Ne++){var Xe=ye[Ne];for(Fe=0;Fe<Xe.length;Fe++)Qe(Pe,Xe[Fe],ne,ie,!0,Fe===0)}if(Pe.length){var Ye=X.tags||null;if(ge==="LineString"&&de.lineMetrics){for(var De in Ye={},X.tags)Ye[De]=X.tags[De];Ye.mapbox_clip_start=ye.start/ye.size,Ye.mapbox_clip_end=ye.end/ye.size}var Ue={geometry:Pe,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:Ye};X.id!==null&&(Ue.id=X.id),ne.features.push(Ue)}}function Qe(ne,X,ie,de,ye,ge){var Pe=de*de;if(de>0&&X.size<(ye?Pe:de))ie.numPoints+=X.length/3;else{for(var Fe=[],Ne=0;Ne<X.length;Ne+=3)(de===0||X[Ne+2]>Pe)&&(ie.numSimplified++,Fe.push(X[Ne]),Fe.push(X[Ne+1])),ie.numPoints++;ye&&function(Xe,Ye){for(var De=0,Ue=0,ht=Xe.length,Tt=ht-2;Ue<ht;Tt=Ue,Ue+=2)De+=(Xe[Ue]-Xe[Tt])*(Xe[Ue+1]+Xe[Tt+1]);if(De>0===Ye)for(Ue=0,ht=Xe.length;Ue<ht/2;Ue+=2){var o=Xe[Ue],ke=Xe[Ue+1];Xe[Ue]=Xe[ht-2-Ue],Xe[Ue+1]=Xe[ht-1-Ue],Xe[ht-2-Ue]=o,Xe[ht-1-Ue]=ke}}(Fe,ge),ne.push(Fe)}}function He(ne,X){var ie=(X=this.options=function(ye,ge){for(var Pe in ge)ye[Pe]=ge[Pe];return ye}(Object.create(this.options),X)).debug;if(ie&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");var de=function(ye,ge){var Pe=[];if(ye.type==="FeatureCollection")for(var Fe=0;Fe<ye.features.length;Fe++)mn(Pe,ye.features[Fe],ge,Fe);else mn(Pe,ye.type==="Feature"?ye:{geometry:ye},ge);return Pe}(ne,X);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(ye,ge){var Pe=ge.buffer/ge.extent,Fe=ye,Ne=pr(ye,1,-1-Pe,Pe,0,-1,2,ge),Xe=pr(ye,1,1-Pe,2+Pe,0,-1,2,ge);return(Ne||Xe)&&(Fe=pr(ye,1,-Pe,1+Pe,0,-1,2,ge)||[],Ne&&(Fe=te(Ne,1).concat(Fe)),Xe&&(Fe=Fe.concat(te(Xe,-1)))),Fe}(de,X),de.length&&this.splitTile(de,0,0,0),ie&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ze(ne,X,ie){return 32*((1<<ne)*ie+X)+ne}function Ve(ne,X){return X?ne.properties[X]:ne.id}function ft(ne,X){if(ne==null)return!0;if(ne.type==="Feature")return Ve(ne,X)!=null;if(ne.type==="FeatureCollection"){const ie=new Set;for(const de of ne.features){const ye=Ve(de,X);if(ye==null||ie.has(ye))return!1;ie.add(ye)}return!0}return!1}function rt(ne,X){const ie=new Map;if(ne!=null)if(ne.type==="Feature")ie.set(Ve(ne,X),ne);else for(const de of ne.features)ie.set(Ve(de,X),de);return ie}He.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},He.prototype.splitTile=function(ne,X,ie,de,ye,ge,Pe){for(var Fe=[ne,X,ie,de],Ne=this.options,Xe=Ne.debug;Fe.length;){de=Fe.pop(),ie=Fe.pop(),X=Fe.pop(),ne=Fe.pop();var Ye=1<<X,De=Ze(X,ie,de),Ue=this.tiles[De];if(!Ue&&(Xe>1&&console.time("creation"),Ue=this.tiles[De]=Ee(ne,X,ie,de,Ne),this.tileCoords.push({z:X,x:ie,y:de}),Xe)){Xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,ie,de,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var ht="z"+X;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if(Ue.source=ne,ye){if(X===Ne.maxZoom||X===ye)continue;var Tt=1<<ye-X;if(ie!==Math.floor(ge/Tt)||de!==Math.floor(Pe/Tt))continue}else if(X===Ne.indexMaxZoom||Ue.numPoints<=Ne.indexMaxPoints)continue;if(Ue.source=null,ne.length!==0){Xe>1&&console.time("clipping");var o,ke,ai,di,Ai,Kt,oi=.5*Ne.buffer/Ne.extent,Ri=.5-oi,vi=.5+oi,wi=1+oi;o=ke=ai=di=null,Ai=pr(ne,Ye,ie-oi,ie+vi,0,Ue.minX,Ue.maxX,Ne),Kt=pr(ne,Ye,ie+Ri,ie+wi,0,Ue.minX,Ue.maxX,Ne),ne=null,Ai&&(o=pr(Ai,Ye,de-oi,de+vi,1,Ue.minY,Ue.maxY,Ne),ke=pr(Ai,Ye,de+Ri,de+wi,1,Ue.minY,Ue.maxY,Ne),Ai=null),Kt&&(ai=pr(Kt,Ye,de-oi,de+vi,1,Ue.minY,Ue.maxY,Ne),di=pr(Kt,Ye,de+Ri,de+wi,1,Ue.minY,Ue.maxY,Ne),Kt=null),Xe>1&&console.timeEnd("clipping"),Fe.push(o||[],X+1,2*ie,2*de),Fe.push(ke||[],X+1,2*ie,2*de+1),Fe.push(ai||[],X+1,2*ie+1,2*de),Fe.push(di||[],X+1,2*ie+1,2*de+1)}}},He.prototype.getTile=function(ne,X,ie){var de=this.options,ye=de.extent,ge=de.debug;if(ne<0||ne>24)return null;var Pe=1<<ne,Fe=Ze(ne,X=(X%Pe+Pe)%Pe,ie);if(this.tiles[Fe])return ve(this.tiles[Fe],ye);ge>1&&console.log("drilling down to z%d-%d-%d",ne,X,ie);for(var Ne,Xe=ne,Ye=X,De=ie;!Ne&&Xe>0;)Xe--,Ye=Math.floor(Ye/2),De=Math.floor(De/2),Ne=this.tiles[Ze(Xe,Ye,De)];return Ne&&Ne.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Xe,Ye,De),ge>1&&console.time("drilling down"),this.splitTile(Ne.source,Xe,Ye,De,ne,X,ie),ge>1&&console.timeEnd("drilling down"),this.tiles[Fe]?ve(this.tiles[Fe],ye):null):null};class Me extends we{constructor(X,ie,de,ye){super(X,ie,de),this._dataUpdateable=new Map,this.loadGeoJSON=(ge,Pe)=>{const{promoteId:Fe}=ge;if(ge.request)return a.f(ge.request,(Ne,Xe,Ye,De)=>{this._dataUpdateable=ft(Xe,Fe)?rt(Xe,Fe):void 0,Pe(Ne,Xe,Ye,De)});if(typeof ge.data=="string")try{const Ne=JSON.parse(ge.data);this._dataUpdateable=ft(Ne,Fe)?rt(Ne,Fe):void 0,Pe(null,Ne)}catch{Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}else ge.dataDiff?this._dataUpdateable?(function(Ne,Xe,Ye){var De,Ue,ht,Tt;if(Xe.removeAll&&Ne.clear(),Xe.remove)for(const o of Xe.remove)Ne.delete(o);if(Xe.add)for(const o of Xe.add){const ke=Ve(o,Ye);ke!=null&&Ne.set(ke,o)}if(Xe.update)for(const o of Xe.update){let ke=Ne.get(o.id);if(ke==null)continue;const ai=!o.removeAllProperties&&(((De=o.removeProperties)===null||De===void 0?void 0:De.length)>0||((Ue=o.addOrUpdateProperties)===null||Ue===void 0?void 0:Ue.length)>0);if((o.newGeometry||o.removeAllProperties||ai)&&(ke=Object.assign({},ke),Ne.set(o.id,ke),ai&&(ke.properties=Object.assign({},ke.properties))),o.newGeometry&&(ke.geometry=o.newGeometry),o.removeAllProperties)ke.properties={};else if(((ht=o.removeProperties)===null||ht===void 0?void 0:ht.length)>0)for(const di of o.removeProperties)Object.prototype.hasOwnProperty.call(ke.properties,di)&&delete ke.properties[di];if(((Tt=o.addOrUpdateProperties)===null||Tt===void 0?void 0:Tt.length)>0)for(const{key:di,value:Ai}of o.addOrUpdateProperties)ke.properties[di]=Ai}}(this._dataUpdateable,ge.dataDiff,Fe),Pe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Pe(new Error(`Cannot update existing geojson data in ${ge.source}`)):Pe(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,ye&&(this.loadGeoJSON=ye)}loadGeoJSONTile(X,ie){const de=X.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);const ye=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!ye)return ie(null,null);const ge=new class{constructor(Fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.N,this.length=Fe.length,this._features=Fe}feature(Fe){return new class{constructor(Ne){this._feature=Ne,this.extent=a.N,this.type=Ne.type,this.properties=Ne.tags,"id"in Ne&&!isNaN(Ne.id)&&(this.id=parseInt(Ne.id,10))}loadGeometry(){if(this._feature.type===1){const Ne=[];for(const Xe of this._feature.geometry)Ne.push([new a.P(Xe[0],Xe[1])]);return Ne}{const Ne=[];for(const Xe of this._feature.geometry){const Ye=[];for(const De of Xe)Ye.push(new a.P(De[0],De[1]));Ne.push(Ye)}return Ne}}toGeoJSON(Ne,Xe,Ye){return ut.call(this,Ne,Xe,Ye)}}(this._features[Fe])}}(ye.features);let Pe=Dt(ge);Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),ie(null,{vectorTile:ge,rawData:Pe.buffer})}loadData(X,ie){var de;(de=this._pendingRequest)===null||de===void 0||de.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ye=!!(X&&X.request&&X.request.collectResourceTiming)&&new a.bu(X.request);this._pendingCallback=ie,this._pendingRequest=this.loadGeoJSON(X,(ge,Pe)=>{if(delete this._pendingCallback,delete this._pendingRequest,ge||!Pe)return ie(ge);if(typeof Pe!="object")return ie(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));{st(Pe,!0);try{if(X.filter){const Ne=a.bC(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ne.result==="error")throw new Error(Ne.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));Pe={type:"FeatureCollection",features:Pe.features.filter(Ye=>Ne.value.evaluate({zoom:0},Ye))}}this._geoJSONIndex=X.cluster?new qi(function({superclusterOptions:Ne,clusterProperties:Xe}){if(!Xe||!Ne)return Ne;const Ye={},De={},Ue={accumulated:null,zoom:0},ht={properties:null},Tt=Object.keys(Xe);for(const o of Tt){const[ke,ai]=Xe[o],di=a.bC(ai),Ai=a.bC(typeof ke=="string"?[ke,["accumulated"],["get",o]]:ke);Ye[o]=di.value,De[o]=Ai.value}return Ne.map=o=>{ht.properties=o;const ke={};for(const ai of Tt)ke[ai]=Ye[ai].evaluate(Ue,ht);return ke},Ne.reduce=(o,ke)=>{ht.properties=ke;for(const ai of Tt)Ue.accumulated=o[ai],o[ai]=De[ai].evaluate(Ue,ht)},Ne}(X)).load(Pe.features):function(Ne,Xe){return new He(Ne,Xe)}(Pe,X.geojsonVtOptions)}catch(Ne){return ie(Ne)}this.loaded={};const Fe={};if(ye){const Ne=ye.finish();Ne&&(Fe.resourceTiming={},Fe.resourceTiming[X.source]=JSON.parse(JSON.stringify(Ne)))}ie(null,Fe)}})}reloadTile(X,ie){const de=this.loaded;return de&&de[X.uid]?super.reloadTile(X,ie):this.loadTile(X,ie)}removeSource(X,ie){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ie()}getClusterExpansionZoom(X,ie){try{ie(null,this._geoJSONIndex.getClusterExpansionZoom(X.clusterId))}catch(de){ie(de)}}getClusterChildren(X,ie){try{ie(null,this._geoJSONIndex.getChildren(X.clusterId))}catch(de){ie(de)}}getClusterLeaves(X,ie){try{ie(null,this._geoJSONIndex.getLeaves(X.clusterId,X.limit,X.offset))}catch(de){ie(de)}}}class se{constructor(X){this.self=X,this.actor=new a.C(X,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:we,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ie,de)=>{if(this.workerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.workerSourceTypes[ie]=de},this.self.registerRTLTextPlugin=ie=>{if(a.bD.isParsed())throw new Error("RTL text plugin already registered.");a.bD.applyArabicShaping=ie.applyArabicShaping,a.bD.processBidirectionalText=ie.processBidirectionalText,a.bD.processStyledBidirectionalText=ie.processStyledBidirectionalText}}setReferrer(X,ie){this.referrer=ie}setImages(X,ie,de){this.availableImages[X]=ie;for(const ye in this.workerSources[X]){const ge=this.workerSources[X][ye];for(const Pe in ge)ge[Pe].availableImages=ie}de()}setLayers(X,ie,de){this.getLayerIndex(X).replace(ie),de()}updateLayers(X,ie,de){this.getLayerIndex(X).update(ie.layers,ie.removedIds),de()}loadTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).loadTile(ie,de)}loadDEMTile(X,ie,de){this.getDEMWorkerSource(X,ie.source).loadTile(ie,de)}reloadTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).reloadTile(ie,de)}abortTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).abortTile(ie,de)}removeTile(X,ie,de){this.getWorkerSource(X,ie.type,ie.source).removeTile(ie,de)}removeDEMTile(X,ie){this.getDEMWorkerSource(X,ie.source).removeTile(ie)}removeSource(X,ie,de){if(!this.workerSources[X]||!this.workerSources[X][ie.type]||!this.workerSources[X][ie.type][ie.source])return;const ye=this.workerSources[X][ie.type][ie.source];delete this.workerSources[X][ie.type][ie.source],ye.removeSource!==void 0?ye.removeSource(ie,de):de()}loadWorkerSource(X,ie,de){try{this.self.importScripts(ie.url),de()}catch(ye){de(ye.toString())}}syncRTLPluginState(X,ie,de){try{a.bD.setState(ie);const ye=a.bD.getPluginURL();if(a.bD.isLoaded()&&!a.bD.isParsed()&&ye!=null){this.self.importScripts(ye);const ge=a.bD.isParsed();de(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ye}`),ge)}}catch(ye){de(ye.toString())}}getAvailableImages(X){let ie=this.availableImages[X];return ie||(ie=[]),ie}getLayerIndex(X){let ie=this.layerIndexes[X];return ie||(ie=this.layerIndexes[X]=new U),ie}getWorkerSource(X,ie,de){return this.workerSources[X]||(this.workerSources[X]={}),this.workerSources[X][ie]||(this.workerSources[X][ie]={}),this.workerSources[X][ie][de]||(this.workerSources[X][ie][de]=new this.workerSourceTypes[ie]({send:(ye,ge,Pe)=>{this.actor.send(ye,ge,Pe,X)}},this.getLayerIndex(X),this.getAvailableImages(X))),this.workerSources[X][ie][de]}getDEMWorkerSource(X,ie){return this.demWorkerSources[X]||(this.demWorkerSources[X]={}),this.demWorkerSources[X][ie]||(this.demWorkerSources[X][ie]=new et),this.demWorkerSources[X][ie]}}return a.i()&&(self.worker=new se(self)),se}),b(["./shared"],function(a){var U="3.6.2";class W{static testProp(A){if(!W.docStyle)return A[0];for(let I=0;I<A.length;I++)if(A[I]in W.docStyle)return A[I];return A[0]}static create(A,I,F){const O=window.document.createElement(A);return I!==void 0&&(O.className=I),F&&F.appendChild(O),O}static createNS(A,I){return window.document.createElementNS(A,I)}static disableDrag(){W.docStyle&&W.selectProp&&(W.userSelect=W.docStyle[W.selectProp],W.docStyle[W.selectProp]="none")}static enableDrag(){W.docStyle&&W.selectProp&&(W.docStyle[W.selectProp]=W.userSelect)}static setTransform(A,I){A.style[W.transformProp]=I}static addEventListener(A,I,F,O={}){A.addEventListener(I,F,"passive"in O?O:O.capture)}static removeEventListener(A,I,F,O={}){A.removeEventListener(I,F,"passive"in O?O:O.capture)}static suppressClickInternal(A){A.preventDefault(),A.stopPropagation(),window.removeEventListener("click",W.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",W.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",W.suppressClickInternal,!0)},0)}static mousePos(A,I){const F=A.getBoundingClientRect();return new a.P(I.clientX-F.left-A.clientLeft,I.clientY-F.top-A.clientTop)}static touchPos(A,I){const F=A.getBoundingClientRect(),O=[];for(let y=0;y<I.length;y++)O.push(new a.P(I[y].clientX-F.left-A.clientLeft,I[y].clientY-F.top-A.clientTop));return O}static mouseButton(A){return A.button}static remove(A){A.parentNode&&A.parentNode.removeChild(A)}}W.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,W.selectProp=W.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),W.transformProp=W.testProp(["transform","WebkitTransform"]);const ce={supported:!1,testSupport:function(Z){!we&&fe&&(et?lt(Z):oe=Z)}};let oe,fe,we=!1,et=!1;function lt(Z){const A=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,A);try{if(Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,Z.RGBA,Z.UNSIGNED_BYTE,fe),Z.isContextLost())return;ce.supported=!0}catch{}Z.deleteTexture(A),we=!0}var Ke,st;typeof document<"u"&&(fe=document.createElement("img"),fe.onload=function(){oe&&lt(oe),oe=null,et=!0},fe.onerror=function(){we=!0,oe=null},fe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(Z){let A,I,F,O;Z.resetRequestQueue=()=>{A=[],I=0,F=0,O={}},Z.addThrottleControl=l=>{const d=F++;return O[d]=l,d},Z.removeThrottleControl=l=>{delete O[l],i()},Z.getImage=(l,d,_=!0)=>{ce.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*");const w={requestParameters:l,supportImageRefresh:_,callback:d,cancelled:!1,completed:!1,cancel:()=>{w.completed||w.cancelled||(w.cancelled=!0,w.innerRequest&&(w.innerRequest.cancel(),I--),i())}};return A.push(w),i(),w};const y=l=>{const{requestParameters:d,supportImageRefresh:_,callback:w}=l;return a.e(d,{type:"image"}),(_!==!1||a.i()||a.g(d.url)||d.headers&&!Object.keys(d.headers).reduce((T,B)=>T&&B==="accept",!0)?a.m:r)(d,(T,B,j,Y)=>{s(l,w,T,B,j,Y)})},s=(l,d,_,w,T,B)=>{_?d(_):w instanceof HTMLImageElement||a.a(w)?d(null,w):w&&((j,Y)=>{typeof createImageBitmap=="function"?a.b(j,Y):a.d(j,Y)})(w,(j,Y)=>{j!=null?d(j):Y!=null&&d(null,Y,{cacheControl:T,expires:B})}),l.cancelled||(l.completed=!0,I--,i())},i=()=>{const l=(()=>{const d=Object.keys(O);let _=!1;if(d.length>0){for(const w of d)if(_=O[w](),_)break}return _})()?a.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let d=I;d<l&&A.length>0;d++){const _=A.shift();if(_.cancelled){d--;continue}const w=y(_);I++,_.innerRequest=w}},r=(l,d)=>{const _=new Image,w=l.url;let T=!1;const B=l.credentials;return B&&B==="include"?_.crossOrigin="use-credentials":(B&&B==="same-origin"||!a.s(w))&&(_.crossOrigin="anonymous"),_.fetchPriority="high",_.onload=()=>{d(null,_),_.onerror=_.onload=null},_.onerror=()=>{T||d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),_.onerror=_.onload=null},_.src=w,{cancel:()=>{T=!0,_.src=""}}}}(Ke||(Ke={})),Ke.resetRequestQueue(),function(Z){Z.Glyphs="Glyphs",Z.Image="Image",Z.Source="Source",Z.SpriteImage="SpriteImage",Z.SpriteJSON="SpriteJSON",Z.Style="Style",Z.Tile="Tile",Z.Unknown="Unknown"}(st||(st={}));class ut{constructor(A){this._transformRequestFn=A}transformRequest(A,I){return this._transformRequestFn&&this._transformRequestFn(A,I)||{url:A}}normalizeSpriteURL(A,I,F){const O=function(y){const s=y.match(kt);if(!s)throw new Error(`Unable to parse URL "${y}"`);return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}(A);return O.path+=`${I}${F}`,function(y){const s=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${s}`}(O)}setTransformRequest(A){this._transformRequestFn=A}}const kt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Bt(Z){var A=new a.A(3);return A[0]=Z[0],A[1]=Z[1],A[2]=Z[2],A}var Rt,Ge=function(Z,A,I){return Z[0]=A[0]-I[0],Z[1]=A[1]-I[1],Z[2]=A[2]-I[2],Z};Rt=new a.A(3),a.A!=Float32Array&&(Rt[0]=0,Rt[1]=0,Rt[2]=0);var ni=function(Z){var A=Z[0],I=Z[1];return A*A+I*I};function it(Z){const A=[];if(typeof Z=="string")A.push({id:"default",url:Z});else if(Z&&Z.length>0){const I=[];for(const{id:F,url:O}of Z){const y=`${F}${O}`;I.indexOf(y)===-1&&(I.push(y),A.push({id:F,url:O}))}}return A}function xt(Z,A,I,F,O){if(F)return void Z(F);if(O!==Object.values(A).length||O!==Object.values(I).length)return;const y={};for(const s in A){y[s]={};const i=a.h.getImageCanvasContext(I[s]),r=A[s];for(const l in r){const{width:d,height:_,x:w,y:T,sdf:B,pixelRatio:j,stretchX:Y,stretchY:ue,content:Se}=r[l];y[s][l]={data:null,pixelRatio:j,sdf:B,stretchX:Y,stretchY:ue,content:Se,spriteData:{width:d,height:_,x:w,y:T,context:i}}}}Z(null,y)}(function(){var Z=new a.A(2);a.A!=Float32Array&&(Z[0]=0,Z[1]=0)})();class _t{constructor(A,I,F,O){this.context=A,this.format=F,this.texture=A.gl.createTexture(),this.update(I,O)}update(A,I,F){const{width:O,height:y}=A,s=!(this.size&&this.size[0]===O&&this.size[1]===y||F),{context:i}=this,{gl:r}=i;if(this.useMipmap=!!(I&&I.useMipmap),r.bindTexture(r.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===r.RGBA&&(!I||I.premultiply!==!1)),s)this.size=[O,y],A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texImage2D(r.TEXTURE_2D,0,this.format,this.format,r.UNSIGNED_BYTE,A):r.texImage2D(r.TEXTURE_2D,0,this.format,O,y,0,this.format,r.UNSIGNED_BYTE,A.data);else{const{x:l,y:d}=F||{x:0,y:0};A instanceof HTMLImageElement||A instanceof HTMLCanvasElement||A instanceof HTMLVideoElement||A instanceof ImageData||a.a(A)?r.texSubImage2D(r.TEXTURE_2D,0,l,d,r.RGBA,r.UNSIGNED_BYTE,A):r.texSubImage2D(r.TEXTURE_2D,0,l,d,O,y,r.RGBA,r.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&r.generateMipmap(r.TEXTURE_2D)}bind(A,I,F){const{context:O}=this,{gl:y}=O;y.bindTexture(y.TEXTURE_2D,this.texture),F!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(F=y.LINEAR),A!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,A),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,F||A),this.filter=A),I!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,I),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,I),this.wrap=I)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:A}=this.context;A.deleteTexture(this.texture),this.texture=null}}function mt(Z){const{userImage:A}=Z;return!!(A&&A.render&&A.render())&&(Z.data.replace(new Uint8Array(A.data.buffer)),!0)}class bt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(A){if(this.loaded!==A&&(this.loaded=A,A)){for(const{ids:I,callback:F}of this.requestors)this._notify(I,F);this.requestors=[]}}getImage(A){const I=this.images[A];if(I&&!I.data&&I.spriteData){const F=I.spriteData;I.data=new a.R({width:F.width,height:F.height},F.context.getImageData(F.x,F.y,F.width,F.height).data),I.spriteData=null}return I}addImage(A,I){if(this.images[A])throw new Error(`Image id ${A} already exist, use updateImage instead`);this._validate(A,I)&&(this.images[A]=I)}_validate(A,I){let F=!0;const O=I.data||I.spriteData;return this._validateStretch(I.stretchX,O&&O.width)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchX" value`))),F=!1),this._validateStretch(I.stretchY,O&&O.height)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "stretchY" value`))),F=!1),this._validateContent(I.content,I)||(this.fire(new a.j(new Error(`Image "${A}" has invalid "content" value`))),F=!1),F}_validateStretch(A,I){if(!A)return!0;let F=0;for(const O of A){if(O[0]<F||O[1]<O[0]||I<O[1])return!1;F=O[1]}return!0}_validateContent(A,I){if(!A)return!0;if(A.length!==4)return!1;const F=I.spriteData,O=F&&F.width||I.data.width,y=F&&F.height||I.data.height;return!(A[0]<0||O<A[0]||A[1]<0||y<A[1]||A[2]<0||O<A[2]||A[3]<0||y<A[3]||A[2]<A[0]||A[3]<A[1])}updateImage(A,I,F=!0){const O=this.getImage(A);if(F&&(O.data.width!==I.data.width||O.data.height!==I.data.height))throw new Error(`size mismatch between old image (${O.data.width}x${O.data.height}) and new image (${I.data.width}x${I.data.height}).`);I.version=O.version+1,this.images[A]=I,this.updatedImages[A]=!0}removeImage(A){const I=this.images[A];delete this.images[A],delete this.patterns[A],I.userImage&&I.userImage.onRemove&&I.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(A,I){let F=!0;if(!this.isLoaded())for(const O of A)this.images[O]||(F=!1);this.isLoaded()||F?this._notify(A,I):this.requestors.push({ids:A,callback:I})}_notify(A,I){const F={};for(const O of A){let y=this.getImage(O);y||(this.fire(new a.k("styleimagemissing",{id:O})),y=this.getImage(O)),y?F[O]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:a.w(`Image "${O}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}I(null,F)}getPixelSize(){const{width:A,height:I}=this.atlasImage;return{width:A,height:I}}getPattern(A){const I=this.patterns[A],F=this.getImage(A);if(!F)return null;if(I&&I.position.version===F.version)return I.position;if(I)I.position.version=F.version;else{const O={w:F.data.width+2,h:F.data.height+2,x:0,y:0},y=new a.I(O,F);this.patterns[A]={bin:O,position:y}}return this._updatePatternAtlas(),this.patterns[A].position}bind(A){const I=A.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _t(A,this.atlasImage,I.RGBA),this.atlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE)}_updatePatternAtlas(){const A=[];for(const y in this.patterns)A.push(this.patterns[y].bin);const{w:I,h:F}=a.p(A),O=this.atlasImage;O.resize({width:I||1,height:F||1});for(const y in this.patterns){const{bin:s}=this.patterns[y],i=s.x+1,r=s.y+1,l=this.getImage(y).data,d=l.width,_=l.height;a.R.copy(l,O,{x:0,y:0},{x:i,y:r},{width:d,height:_}),a.R.copy(l,O,{x:0,y:_-1},{x:i,y:r-1},{width:d,height:1}),a.R.copy(l,O,{x:0,y:0},{x:i,y:r+_},{width:d,height:1}),a.R.copy(l,O,{x:d-1,y:0},{x:i-1,y:r},{width:1,height:_}),a.R.copy(l,O,{x:0,y:0},{x:i+d,y:r},{width:1,height:_})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(A){for(const I of A){if(this.callbackDispatchedThisFrame[I])continue;this.callbackDispatchedThisFrame[I]=!0;const F=this.getImage(I);F||a.w(`Image with ID: "${I}" was not found`),mt(F)&&this.updateImage(I,F)}}}const dt=1e20;function nt(Z,A,I,F,O,y,s,i,r){for(let l=A;l<A+F;l++)pt(Z,I*y+l,y,O,s,i,r);for(let l=I;l<I+O;l++)pt(Z,l*y+A,1,F,s,i,r)}function pt(Z,A,I,F,O,y,s){y[0]=0,s[0]=-dt,s[1]=dt,O[0]=Z[A];for(let i=1,r=0,l=0;i<F;i++){O[i]=Z[A+i*I];const d=i*i;do{const _=y[r];l=(O[i]-O[_]+d-_*_)/(i-_)/2}while(l<=s[r]&&--r>-1);r++,y[r]=i,s[r]=l,s[r+1]=dt}for(let i=0,r=0;i<F;i++){for(;s[r+1]<i;)r++;const l=y[r],d=i-l;Z[A+i*I]=O[l]+d*d}}class at{constructor(A,I){this.requestManager=A,this.localIdeographFontFamily=I,this.entries={}}setURL(A){this.url=A}getGlyphs(A,I){const F=[];for(const O in A)for(const y of A[O])F.push({stack:O,id:y});a.o(F,({stack:O,id:y},s)=>{let i=this.entries[O];i||(i=this.entries[O]={glyphs:{},requests:{},ranges:{}});let r=i.glyphs[y];if(r!==void 0)return void s(null,{stack:O,id:y,glyph:r});if(r=this._tinySDF(i,O,y),r)return i.glyphs[y]=r,void s(null,{stack:O,id:y,glyph:r});const l=Math.floor(y/256);if(256*l>65535)return void s(new Error("glyphs > 65535 not supported"));if(i.ranges[l])return void s(null,{stack:O,id:y,glyph:r});if(!this.url)return void s(new Error("glyphsUrl is not set"));let d=i.requests[l];d||(d=i.requests[l]=[],at.loadGlyphRange(O,l,this.url,this.requestManager,(_,w)=>{if(w){for(const T in w)this._doesCharSupportLocalGlyph(+T)||(i.glyphs[+T]=w[+T]);i.ranges[l]=!0}for(const T of d)T(_,w);delete i.requests[l]})),d.push((_,w)=>{_?s(_):w&&s(null,{stack:O,id:y,glyph:w[y]||null})})},(O,y)=>{if(O)I(O);else if(y){const s={};for(const{stack:i,id:r,glyph:l}of y)(s[i]||(s[i]={}))[r]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics};I(null,s)}})}_doesCharSupportLocalGlyph(A){return!!this.localIdeographFontFamily&&(a.u["CJK Unified Ideographs"](A)||a.u["Hangul Syllables"](A)||a.u.Hiragana(A)||a.u.Katakana(A))}_tinySDF(A,I,F){const O=this.localIdeographFontFamily;if(!O||!this._doesCharSupportLocalGlyph(F))return;let y=A.tinySDF;if(!y){let i="400";/bold/i.test(I)?i="900":/medium/i.test(I)?i="500":/light/i.test(I)&&(i="200"),y=A.tinySDF=new at.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:O,fontWeight:i})}const s=y.draw(String.fromCharCode(F));return{id:F,bitmap:new a.q({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}at.loadGlyphRange=function(Z,A,I,F,O){const y=256*A,s=y+255,i=F.transformRequest(I.replace("{fontstack}",Z).replace("{range}",`${y}-${s}`),st.Glyphs);a.l(i,(r,l)=>{if(r)O(r);else if(l){const d={};for(const _ of a.n(l))d[_.id]=_;O(null,d)}})},at.TinySDF=class{constructor({fontSize:Z=24,buffer:A=3,radius:I=8,cutoff:F=.25,fontFamily:O="sans-serif",fontWeight:y="normal",fontStyle:s="normal"}={}){this.buffer=A,this.cutoff=F,this.radius=I;const i=this.size=Z+4*A,r=this._createCanvas(i),l=this.ctx=r.getContext("2d",{willReadFrequently:!0});l.font=`${s} ${y} ${Z}px ${O}`,l.textBaseline="alphabetic",l.textAlign="left",l.fillStyle="black",this.gridOuter=new Float64Array(i*i),this.gridInner=new Float64Array(i*i),this.f=new Float64Array(i),this.z=new Float64Array(i+1),this.v=new Uint16Array(i)}_createCanvas(Z){const A=document.createElement("canvas");return A.width=A.height=Z,A}draw(Z){const{width:A,actualBoundingBoxAscent:I,actualBoundingBoxDescent:F,actualBoundingBoxLeft:O,actualBoundingBoxRight:y}=this.ctx.measureText(Z),s=Math.ceil(I),i=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-O))),r=Math.min(this.size-this.buffer,s+Math.ceil(F)),l=i+2*this.buffer,d=r+2*this.buffer,_=Math.max(l*d,0),w=new Uint8ClampedArray(_),T={data:w,width:l,height:d,glyphWidth:i,glyphHeight:r,glyphTop:s,glyphLeft:0,glyphAdvance:A};if(i===0||r===0)return T;const{ctx:B,buffer:j,gridInner:Y,gridOuter:ue}=this;B.clearRect(j,j,i,r),B.fillText(Z,j,j+s);const Se=B.getImageData(j,j,i,r);ue.fill(dt,0,_),Y.fill(0,0,_);for(let Te=0;Te<r;Te++)for(let Re=0;Re<i;Re++){const Be=Se.data[4*(Te*i+Re)+3]/255;if(Be===0)continue;const $e=(Te+j)*l+Re+j;if(Be===1)ue[$e]=0,Y[$e]=dt;else{const vt=.5-Be;ue[$e]=vt>0?vt*vt:0,Y[$e]=vt<0?vt*vt:0}}nt(ue,0,0,l,d,l,this.f,this.v,this.z),nt(Y,j,j,i,r,l,this.f,this.v,this.z);for(let Te=0;Te<_;Te++){const Re=Math.sqrt(ue[Te])-Math.sqrt(Y[Te]);w[Te]=Math.round(255-255*(Re/this.radius+this.cutoff))}return T}};class Nt{constructor(){this.specification=a.v.light.position}possiblyEvaluate(A,I){return a.z(A.expression.evaluate(I))}interpolate(A,I,F){return{x:a.B.number(A.x,I.x,F),y:a.B.number(A.y,I.y,F),z:a.B.number(A.z,I.z,F)}}}let Ft;class Dt extends a.E{constructor(A){super(),Ft=Ft||new a.r({anchor:new a.D(a.v.light.anchor),position:new Nt,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(Ft),this.setLight(A),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(A,I={}){if(!this._validate(a.t,A,I))for(const F in A){const O=A[F];F.endsWith("-transition")?this._transitionable.setTransition(F.slice(0,-11),O):this._transitionable.setValue(F,O)}}updateTransitions(A){this._transitioning=this._transitionable.transitioned(A,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(A){this.properties=this._transitioning.possiblyEvaluate(A)}_validate(A,I,F){return(!F||F.validate!==!1)&&a.x(this,A.call(a.y,a.e({value:I,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}}class ci{constructor(A,I){this.width=A,this.height=I,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(A,I){const F=A.join(",")+String(I);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(A,I)),this.dashEntry[F]}getDashRanges(A,I,F){const O=[];let y=A.length%2==1?-A[A.length-1]*F:0,s=A[0]*F,i=!0;O.push({left:y,right:s,isDash:i,zeroLength:A[0]===0});let r=A[0];for(let l=1;l<A.length;l++){i=!i;const d=A[l];y=r*F,r+=d,s=r*F,O.push({left:y,right:s,isDash:i,zeroLength:d===0})}return O}addRoundDash(A,I,F){const O=I/2;for(let y=-F;y<=F;y++){const s=this.width*(this.nextRow+F+y);let i=0,r=A[i];for(let l=0;l<this.width;l++){l/r.right>1&&(r=A[++i]);const d=Math.abs(l-r.left),_=Math.abs(l-r.right),w=Math.min(d,_);let T;const B=y/F*(O+1);if(r.isDash){const j=O-Math.abs(B);T=Math.sqrt(w*w+j*j)}else T=O-Math.sqrt(w*w+B*B);this.data[s+l]=Math.max(0,Math.min(255,T+128))}}}addRegularDash(A){for(let i=A.length-1;i>=0;--i){const r=A[i],l=A[i+1];r.zeroLength?A.splice(i,1):l&&l.isDash===r.isDash&&(l.left=r.left,A.splice(i,1))}const I=A[0],F=A[A.length-1];I.isDash===F.isDash&&(I.left=F.left-this.width,F.right=I.right+this.width);const O=this.width*this.nextRow;let y=0,s=A[y];for(let i=0;i<this.width;i++){i/s.right>1&&(s=A[++y]);const r=Math.abs(i-s.left),l=Math.abs(i-s.right),d=Math.min(r,l);this.data[O+i]=Math.max(0,Math.min(255,(s.isDash?d:-d)+128))}}addDash(A,I){const F=I?7:0,O=2*F+1;if(this.nextRow+O>this.height)return a.w("LineAtlas out of space"),null;let y=0;for(let i=0;i<A.length;i++)y+=A[i];if(y!==0){const i=this.width/y,r=this.getDashRanges(A,this.width,i);I?this.addRoundDash(r,i,F):this.addRegularDash(r)}const s={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:y};return this.nextRow+=O,this.dirty=!0,s}bind(A){const I=A.gl;this.texture?(I.bindTexture(I.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,I.texSubImage2D(I.TEXTURE_2D,0,0,0,this.width,this.height,I.ALPHA,I.UNSIGNED_BYTE,this.data))):(this.texture=I.createTexture(),I.bindTexture(I.TEXTURE_2D,this.texture),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,I.REPEAT),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,I.REPEAT),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.LINEAR),I.texImage2D(I.TEXTURE_2D,0,I.ALPHA,this.width,this.height,0,I.ALPHA,I.UNSIGNED_BYTE,this.data))}}class bi{constructor(A,I,F){this.workerPool=A,this.actors=[],this.currentActor=0,this.id=F;const O=this.workerPool.acquire(F);for(let y=0;y<O.length;y++){const s=new a.C(O[y],I,F);s.name=`Worker ${y}`,this.actors.push(s)}if(!this.actors.length)throw new Error("No actors found")}broadcast(A,I,F){a.o(this.actors,(O,y)=>{O.send(A,I,y)},F=F||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(A=!0){this.actors.forEach(I=>{I.remove()}),this.actors=[],A&&this.workerPool.release(this.id)}}function ki(Z,A,I){const F=function(O,y){if(O)return I(O);if(y){const s=a.F(a.e(y,Z),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(s.vectorLayers=y.vector_layers,s.vectorLayerIds=s.vectorLayers.map(i=>i.id)),I(null,s)}};return Z.url?a.f(A.transformRequest(Z.url,st.Source),F):a.h.frame(()=>F(null,Z))}class Gi{constructor(A,I){A&&(I?this.setSouthWest(A).setNorthEast(I):Array.isArray(A)&&(A.length===4?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1])))}setNorthEast(A){return this._ne=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}setSouthWest(A){return this._sw=A instanceof a.L?new a.L(A.lng,A.lat):a.L.convert(A),this}extend(A){const I=this._sw,F=this._ne;let O,y;if(A instanceof a.L)O=A,y=A;else{if(!(A instanceof Gi))return Array.isArray(A)?A.length===4||A.every(Array.isArray)?this.extend(Gi.convert(A)):this.extend(a.L.convert(A)):A&&("lng"in A||"lon"in A)&&"lat"in A?this.extend(a.L.convert(A)):this;if(O=A._sw,y=A._ne,!O||!y)return this}return I||F?(I.lng=Math.min(O.lng,I.lng),I.lat=Math.min(O.lat,I.lat),F.lng=Math.max(y.lng,F.lng),F.lat=Math.max(y.lat,F.lat)):(this._sw=new a.L(O.lng,O.lat),this._ne=new a.L(y.lng,y.lat)),this}getCenter(){return new a.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.L(this.getWest(),this.getNorth())}getSouthEast(){return new a.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(A){const{lng:I,lat:F}=a.L.convert(A);let O=this._sw.lng<=I&&I<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=I&&I>=this._ne.lng),this._sw.lat<=F&&F<=this._ne.lat&&O}static convert(A){return A instanceof Gi?A:A&&new Gi(A)}static fromLngLat(A,I=0){const F=360*I/40075017,O=F/Math.cos(Math.PI/180*A.lat);return new Gi(new a.L(A.lng-O,A.lat-F),new a.L(A.lng+O,A.lat+F))}}class rn{constructor(A,I,F){this.bounds=Gi.convert(this.validateBounds(A)),this.minzoom=I||0,this.maxzoom=F||24}validateBounds(A){return Array.isArray(A)&&A.length===4?[Math.max(-180,A[0]),Math.max(-90,A[1]),Math.min(180,A[2]),Math.min(90,A[3])]:[-180,-90,180,90]}contains(A){const I=Math.pow(2,A.z),F=Math.floor(a.G(this.bounds.getWest())*I),O=Math.floor(a.H(this.bounds.getNorth())*I),y=Math.ceil(a.G(this.bounds.getEast())*I),s=Math.ceil(a.H(this.bounds.getSouth())*I);return A.x>=F&&A.x<y&&A.y>=O&&A.y<s}}class $i extends a.E{constructor(A,I,F,O){if(super(),this.load=()=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ki(this._options,this.map._requestManager,(y,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),y?this.fire(new a.j(y)):s&&(a.e(this,s),s.bounds&&(this.tileBounds=new rn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>a.e({},this._options),this.id=A,this.dispatcher=F,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.F(I,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},I),this._collectResourceTiming=I.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}loaded(){return this._loaded}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}onAdd(A){this.map=A,this.load()}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}setUrl(A){return this.setSourceProperty(()=>{this.url=A,this._options.url=A}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(A,I){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O={request:this.map._requestManager.transformRequest(F,st.Tile),uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,tileSize:this.tileSize*A.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(s,i){return delete A.request,A.aborted?I(null):s&&s.status!==404?I(s):(i&&i.resourceTiming&&(A.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&A.setExpiryData(i),A.loadVectorData(i,this.map.painter),I(null),void(A.reloadCallback&&(this.loadTile(A,A.reloadCallback),A.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,A.actor&&A.state!=="expired"?A.state==="loading"?A.reloadCallback=I:A.request=A.actor.send("reloadTile",O,y.bind(this)):(A.actor=this.dispatcher.getActor(),A.request=A.actor.send("loadTile",O,y.bind(this)))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.actor&&A.actor.send("abortTile",{uid:A.uid,type:this.type,source:this.id},void 0)}unloadTile(A){A.unloadVectorData(),A.actor&&A.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class qi extends a.E{constructor(A,I,F,O){super(),this.id=A,this.dispatcher=F,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},I),a.e(this,a.F(I,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ki(this._options,this.map._requestManager,(A,I)=>{this._tileJSONRequest=null,this._loaded=!0,A?this.fire(new a.j(A)):I&&(a.e(this,I),I.bounds&&(this.tileBounds=new rn(I.bounds,this.minzoom,this.maxzoom)),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(A){this.map=A,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.load()}setTiles(A){return this.setSourceProperty(()=>{this._options.tiles=A}),this}serialize(){return a.e({},this._options)}hasTile(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)}loadTile(A,I){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);A.request=Ke.getImage(this.map._requestManager.transformRequest(F,st.Tile),(O,y,s)=>{if(delete A.request,A.aborted)A.state="unloaded",I(null);else if(O)A.state="errored",I(O);else if(y){this.map._refreshExpiredTiles&&s&&A.setExpiryData(s);const i=this.map.painter.context,r=i.gl;A.texture=this.map.painter.getTileTexture(y.width),A.texture?A.texture.update(y,{useMipmap:!0}):(A.texture=new _t(i,y,r.RGBA,{useMipmap:!0}),A.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),A.state="loaded",I(null)}},this.map._refreshExpiredTiles)}abortTile(A,I){A.request&&(A.request.cancel(),delete A.request),I()}unloadTile(A,I){A.texture&&this.map.painter.saveTileTexture(A.texture),I()}hasTransition(){return!1}}class sn extends qi{constructor(A,I,F,O){super(A,I,F,O),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},I),this.encoding=I.encoding||"mapbox",this.redFactor=I.redFactor,this.greenFactor=I.greenFactor,this.blueFactor=I.blueFactor,this.baseShift=I.baseShift}loadTile(A,I){const F=A.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O=this.map._requestManager.transformRequest(F,st.Tile);function y(s,i){s&&(A.state="errored",I(s)),i&&(A.dem=i,A.needsHillshadePrepare=!0,A.needsTerrainPrepare=!0,A.state="loaded",I(null))}A.neighboringTiles=this._getNeighboringTiles(A.tileID),A.request=Ke.getImage(O,(s,i,r)=>a._(this,void 0,void 0,function*(){if(delete A.request,A.aborted)A.state="unloaded",I(null);else if(s)A.state="errored",I(s);else if(i){this.map._refreshExpiredTiles&&A.setExpiryData(r);const l=a.a(i)&&a.J()?i:yield function(_){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.K()){const w=_.width+2,T=_.height+2;try{return new a.R({width:w,height:T},yield a.M(_,-1,-1,w,T))}catch{}}return a.h.getImageData(_,1)})}(i),d={uid:A.uid,coord:A.tileID,source:this.id,rawImageData:l,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};A.actor&&A.state!=="expired"||(A.actor=this.dispatcher.getActor(),A.actor.send("loadDEMTile",d,y))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(A){const I=A.canonical,F=Math.pow(2,I.z),O=(I.x-1+F)%F,y=I.x===0?A.wrap-1:A.wrap,s=(I.x+1+F)%F,i=I.x+1===F?A.wrap+1:A.wrap,r={};return r[new a.O(A.overscaledZ,y,I.z,O,I.y).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,I.z,s,I.y).key]={backfilled:!1},I.y>0&&(r[new a.O(A.overscaledZ,y,I.z,O,I.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,I.z,I.x,I.y-1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,I.z,s,I.y-1).key]={backfilled:!1}),I.y+1<F&&(r[new a.O(A.overscaledZ,y,I.z,O,I.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,A.wrap,I.z,I.x,I.y+1).key]={backfilled:!1},r[new a.O(A.overscaledZ,i,I.z,s,I.y+1).key]={backfilled:!1}),r}unloadTile(A){A.demTexture&&this.map.painter.saveTileTexture(A.demTexture),A.fbo&&(A.fbo.destroy(),delete A.fbo),A.dem&&delete A.dem,delete A.neighboringTiles,A.state="unloaded",A.actor&&A.actor.send("removeDEMTile",{uid:A.uid,source:this.id})}}class Ti extends a.E{constructor(A,I,F,O){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>a.e({},this._options,{type:this.type,data:this._data}),this.id=A,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=F.getActor(),this.setEventedParent(O),this._data=I.data,this._options=a.e({},I),this._collectResourceTiming=I.collectResourceTiming,I.maxzoom!==void 0&&(this.maxzoom=I.maxzoom),I.type&&(this.type=I.type),I.attribution&&(this.attribution=I.attribution),this.promoteId=I.promoteId;const y=a.N/this.tileSize;this.workerOptions=a.e({source:this.id,cluster:I.cluster||!1,geojsonVtOptions:{buffer:(I.buffer!==void 0?I.buffer:128)*y,tolerance:(I.tolerance!==void 0?I.tolerance:.375)*y,extent:a.N,maxZoom:this.maxzoom,lineMetrics:I.lineMetrics||!1,generateId:I.generateId||!1},superclusterOptions:{maxZoom:I.clusterMaxZoom!==void 0?I.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,I.clusterMinPoints||2),extent:a.N,radius:(I.clusterRadius||50)*y,log:!1,generateId:I.generateId||!1},clusterProperties:I.clusterProperties,filter:I.filter},I.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(A){this.map=A,this.load()}setData(A){return this._data=A,this._updateWorkerData(),this}updateData(A){return this._updateWorkerData(A),this}setClusterOptions(A){return this.workerOptions.cluster=A.cluster,A&&(A.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=A.clusterRadius),A.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=A.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(A,I){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:A,source:this.id},I),this}getClusterChildren(A,I){return this.actor.send("geojson.getClusterChildren",{clusterId:A,source:this.id},I),this}getClusterLeaves(A,I,F,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:A,limit:I,offset:F},O),this}_updateWorkerData(A){const I=a.e({},this.workerOptions);A?I.dataDiff=A:typeof this._data=="string"?(I.request=this.map._requestManager.transformRequest(a.h.resolveURL(this._data),st.Source),I.request.collectResourceTiming=this._collectResourceTiming):I.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,I,(F,O)=>{if(this._pendingLoads--,this._removed||O&&O.abandoned)return void this.fire(new a.k("dataabort",{dataType:"source"}));let y=null;if(O&&O.resourceTiming&&O.resourceTiming[this.id]&&(y=O.resourceTiming[this.id].slice(0)),F)return void this.fire(new a.j(F));const s={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&a.e(s,{resourceTiming:y}),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"metadata"}))),this.fire(new a.k("data",Object.assign(Object.assign({},s),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(A,I){const F=A.actor?"reloadTile":"loadTile";A.actor=this.actor;const O={type:this.type,uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};A.request=this.actor.send(F,O,(y,s)=>(delete A.request,A.unloadVectorData(),A.aborted?I(null):y?I(y):(A.loadVectorData(s,this.map.painter,F==="reloadTile"),I(null))))}abortTile(A){A.request&&(A.request.cancel(),delete A.request),A.aborted=!0}unloadTile(A){A.unloadVectorData(),this.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var yi=a.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class hi extends a.E{constructor(A,I,F,O){super(),this.load=(y,s)=>{this._loaded=!1,this.fire(new a.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Ke.getImage(this.map._requestManager.transformRequest(this.url,st.Image),(i,r)=>{this._request=null,this._loaded=!0,i?this.fire(new a.j(i)):r&&(this.image=r,y&&(this.coordinates=y),s&&s(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,yi.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new _t(y,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=A,this.dispatcher=F,this.coordinates=I.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=I}loaded(){return this._loaded}updateImage(A){return A.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=A.url,this.load(A.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(A){this.map=A,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(A){this.coordinates=A;const I=A.map(a.U.fromLngLat);this.tileID=function(O){let y=1/0,s=1/0,i=-1/0,r=-1/0;for(const w of O)y=Math.min(y,w.x),s=Math.min(s,w.y),i=Math.max(i,w.x),r=Math.max(r,w.y);const l=Math.max(i-y,r-s),d=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),_=Math.pow(2,d);return new a.W(d,Math.floor((y+i)/2*_),Math.floor((s+r)/2*_))}(I),this.minzoom=this.maxzoom=this.tileID.z;const F=I.map(O=>this.tileID.getTilePoint(O)._round());return this._boundsArray=new a.V,this._boundsArray.emplaceBack(F[0].x,F[0].y,0,0),this._boundsArray.emplaceBack(F[1].x,F[1].y,a.N,0),this._boundsArray.emplaceBack(F[3].x,F[3].y,0,a.N),this._boundsArray.emplaceBack(F[2].x,F[2].y,a.N,a.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(A,I){this.tileID&&this.tileID.equals(A.tileID.canonical)?(this.tiles[String(A.tileID.wrap)]=A,A.buckets={},I(null)):(A.state="errored",I(null))}hasTransition(){return!1}}class Ei extends hi{constructor(A,I,F,O){super(A,I,F,O),this.load=()=>{this._loaded=!1;const y=this.options;this.urls=[];for(const s of y.urls)this.urls.push(this.map._requestManager.transformRequest(s,st.Source).url);a.X(this.urls,(s,i)=>{this._loaded=!0,s?this.fire(new a.j(s)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,s=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,yi.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new _t(y,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let i=!1;for(const r in this.tiles){const l=this.tiles[r];l.state!=="loaded"&&(l.state="loaded",l.texture=this.texture,i=!0)}i&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=I}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(A){if(this.video){const I=this.video.seekable;A<I.start(0)||A>I.end(0)?this.fire(new a.j(new a.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${I.start(0)} and ${I.end(0)}-second mark.`))):this.video.currentTime=A}}getVideo(){return this.video}onAdd(A){this.map||(this.map=A,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Li extends hi{constructor(A,I,F,O){super(A,I,F,O),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,i=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,yi.members)),this.boundsSegments||(this.boundsSegments=a.S.simpleSegment(0,0,4,2)),this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _t(s,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const l in this.tiles){const d=this.tiles[l];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture,r=!0)}r&&this.fire(new a.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),I.coordinates?Array.isArray(I.coordinates)&&I.coordinates.length===4&&!I.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(s=>typeof s!="number"))||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "coordinates"'))),I.animate&&typeof I.animate!="boolean"&&this.fire(new a.j(new a.Y(`sources.${A}`,null,'optional "animate" property must be a boolean value'))),I.canvas?typeof I.canvas=="string"||I.canvas instanceof HTMLCanvasElement||this.fire(new a.j(new a.Y(`sources.${A}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.j(new a.Y(`sources.${A}`,null,'missing required property "canvas"'))),this.options=I,this.animate=I.animate===void 0||I.animate}getCanvas(){return this.canvas}onAdd(A){this.map=A,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const A of[this.canvas.width,this.canvas.height])if(isNaN(A)||A<=0)return!0;return!1}}const fn={},_n=Z=>{switch(Z){case"geojson":return Ti;case"image":return hi;case"raster":return qi;case"raster-dem":return sn;case"vector":return $i;case"video":return Ei;case"canvas":return Li}return fn[Z]};function gi(Z,A){const I=a.Z();return a.$(I,I,[1,1,0]),a.a0(I,I,[.5*Z.width,.5*Z.height,1]),a.a1(I,I,Z.calculatePosMatrix(A.toUnwrapped()))}function mn(Z,A,I,F,O,y){const s=function(_,w,T){if(_)for(const B of _){const j=w[B];if(j&&j.source===T&&j.type==="fill-extrusion")return!0}else for(const B in w){const j=w[B];if(j.source===T&&j.type==="fill-extrusion")return!0}return!1}(O&&O.layers,A,Z.id),i=y.maxPitchScaleFactor(),r=Z.tilesIn(F,i,s);r.sort(ti);const l=[];for(const _ of r)l.push({wrappedTileID:_.tileID.wrapped().key,queryResults:_.tile.queryRenderedFeatures(A,I,Z._state,_.queryGeometry,_.cameraQueryGeometry,_.scale,O,y,i,gi(Z.transform,_.tileID))});const d=function(_){const w={},T={};for(const B of _){const j=B.queryResults,Y=B.wrappedTileID,ue=T[Y]=T[Y]||{};for(const Se in j){const Te=j[Se],Re=ue[Se]=ue[Se]||{},Be=w[Se]=w[Se]||[];for(const $e of Te)Re[$e.featureIndex]||(Re[$e.featureIndex]=!0,Be.push($e))}}return w}(l);for(const _ in d)d[_].forEach(w=>{const T=w.feature,B=Z.getFeatureState(T.layer["source-layer"],T.id);T.source=T.layer.source,T.layer["source-layer"]&&(T.sourceLayer=T.layer["source-layer"]),T.state=B});return d}function ti(Z,A){const I=Z.tileID,F=A.tileID;return I.overscaledZ-F.overscaledZ||I.canonical.y-F.canonical.y||I.wrap-F.wrap||I.canonical.x-F.canonical.x}class Mn{constructor(A,I){this.timeAdded=0,this.fadeEndTime=0,this.tileID=A,this.uid=a.a2(),this.uses=0,this.tileSize=I,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(A){const I=A+this.timeAdded;I<this.fadeEndTime||(this.fadeEndTime=I)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(A){this.demTexture&&A.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(A,I,F){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(O,y){const s={};if(!y)return s;for(const i of O){const r=i.layerIds.map(l=>y.getLayer(l)).filter(Boolean);if(r.length!==0){i.layers=r,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(l=>r.filter(d=>d.id===l)[0]));for(const l of r)s[l.id]=i}}return s}(A.buckets,I.style),this.hasSymbolBuckets=!1;for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4){if(this.hasSymbolBuckets=!0,!F)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const O in this.buckets){const y=this.buckets[O];if(y instanceof a.a4&&y.hasRTLText){this.hasRTLText=!0,a.a5();break}}this.queryPadding=0;for(const O in this.buckets){const y=this.buckets[O];this.queryPadding=Math.max(this.queryPadding,I.style.getLayer(O).queryRadius(y))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new a.a3}unloadVectorData(){for(const A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(A){return this.buckets[A.id]}upload(A){for(const F in this.buckets){const O=this.buckets[F];O.uploadPending()&&O.upload(A)}const I=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _t(A,this.imageAtlas.image,I.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _t(A,this.glyphAtlasImage,I.ALPHA),this.glyphAtlasImage=null)}prepare(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)}queryRenderedFeatures(A,I,F,O,y,s,i,r,l,d){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:O,cameraQueryGeometry:y,scale:s,tileSize:this.tileSize,pixelPosMatrix:d,transform:r,params:i,queryPadding:this.queryPadding*l},A,I,F):{}}querySourceFeatures(A,I){const F=this.latestFeatureIndex;if(!F||!F.rawTileData)return;const O=F.loadVTLayers(),y=I&&I.sourceLayer?I.sourceLayer:"",s=O._geojsonTileLayer||O[y];if(!s)return;const i=a.a6(I&&I.filter),{z:r,x:l,y:d}=this.tileID.canonical,_={z:r,x:l,y:d};for(let w=0;w<s.length;w++){const T=s.feature(w);if(i.needGeometry){const Y=a.a7(T,!0);if(!i.filter(new a.a8(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!i.filter(new a.a8(this.tileID.overscaledZ),T))continue;const B=F.getId(T,y),j=new a.a9(T,r,l,d,B);j.tile=_,A.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(A){const I=this.expirationTime;if(A.cacheControl){const F=a.aa(A.cacheControl);F["max-age"]&&(this.expirationTime=Date.now()+1e3*F["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){const F=Date.now();let O=!1;if(this.expirationTime>F)O=!1;else if(I)if(this.expirationTime<I)O=!0;else{const y=this.expirationTime-I;y?this.expirationTime=F+Math.max(y,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(A,I){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(A).length===0)return;const F=this.latestFeatureIndex.loadVTLayers();for(const O in this.buckets){if(!I.style.hasLayer(O))continue;const y=this.buckets[O],s=y.layers[0].sourceLayer||"_geojsonTileLayer",i=F[s],r=A[s];if(!i||!r||Object.keys(r).length===0)continue;y.update(r,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=I&&I.style&&I.style.getLayer(O);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(A){this.symbolFadeHoldUntil=a.h.now()+A}setDependencies(A,I){const F={};for(const O of I)F[O]=!0;this.dependencies[A]=F}hasDependency(A,I){for(const F of A){const O=this.dependencies[F];if(O){for(const y of I)if(O[y])return!0}}return!1}}class ns{constructor(A,I){this.max=A,this.onRemove=I,this.reset()}reset(){for(const A in this.data)for(const I of this.data[A])I.timeout&&clearTimeout(I.timeout),this.onRemove(I.value);return this.data={},this.order=[],this}add(A,I,F){const O=A.wrapped().key;this.data[O]===void 0&&(this.data[O]=[]);const y={value:I,timeout:void 0};if(F!==void 0&&(y.timeout=setTimeout(()=>{this.remove(A,y)},F)),this.data[O].push(y),this.order.push(O),this.order.length>this.max){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}has(A){return A.wrapped().key in this.data}getAndRemove(A){return this.has(A)?this._getAndRemoveByKey(A.wrapped().key):null}_getAndRemoveByKey(A){const I=this.data[A].shift();return I.timeout&&clearTimeout(I.timeout),this.data[A].length===0&&delete this.data[A],this.order.splice(this.order.indexOf(A),1),I.value}getByKey(A){const I=this.data[A];return I?I[0].value:null}get(A){return this.has(A)?this.data[A.wrapped().key][0].value:null}remove(A,I){if(!this.has(A))return this;const F=A.wrapped().key,O=I===void 0?0:this.data[F].indexOf(I),y=this.data[F][O];return this.data[F].splice(O,1),y.timeout&&clearTimeout(y.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(y.value),this.order.splice(this.order.indexOf(F),1),this}setMaxSize(A){for(this.max=A;this.order.length>this.max;){const I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this}filter(A){const I=[];for(const F in this.data)for(const O of this.data[F])A(O.value)||I.push(O);for(const F of I)this.remove(F.value.tileID,F)}}class fi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(A,I,F){const O=String(I);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][O]=this.stateChanges[A][O]||{},a.e(this.stateChanges[A][O],F),this.deletedStates[A]===null){this.deletedStates[A]={};for(const y in this.state[A])y!==O&&(this.deletedStates[A][y]=null)}else if(this.deletedStates[A]&&this.deletedStates[A][O]===null){this.deletedStates[A][O]={};for(const y in this.state[A][O])F[y]||(this.deletedStates[A][O][y]=null)}else for(const y in F)this.deletedStates[A]&&this.deletedStates[A][O]&&this.deletedStates[A][O][y]===null&&delete this.deletedStates[A][O][y]}removeFeatureState(A,I,F){if(this.deletedStates[A]===null)return;const O=String(I);if(this.deletedStates[A]=this.deletedStates[A]||{},F&&I!==void 0)this.deletedStates[A][O]!==null&&(this.deletedStates[A][O]=this.deletedStates[A][O]||{},this.deletedStates[A][O][F]=null);else if(I!==void 0)if(this.stateChanges[A]&&this.stateChanges[A][O])for(F in this.deletedStates[A][O]={},this.stateChanges[A][O])this.deletedStates[A][O][F]=null;else this.deletedStates[A][O]=null;else this.deletedStates[A]=null}getState(A,I){const F=String(I),O=a.e({},(this.state[A]||{})[F],(this.stateChanges[A]||{})[F]);if(this.deletedStates[A]===null)return{};if(this.deletedStates[A]){const y=this.deletedStates[A][I];if(y===null)return{};for(const s in y)delete O[s]}return O}initializeTileState(A,I){A.setFeatureState(this.state,I)}coalesceChanges(A,I){const F={};for(const O in this.stateChanges){this.state[O]=this.state[O]||{};const y={};for(const s in this.stateChanges[O])this.state[O][s]||(this.state[O][s]={}),a.e(this.state[O][s],this.stateChanges[O][s]),y[s]=this.state[O][s];F[O]=y}for(const O in this.deletedStates){this.state[O]=this.state[O]||{};const y={};if(this.deletedStates[O]===null)for(const s in this.state[O])y[s]={},this.state[O][s]={};else for(const s in this.deletedStates[O]){if(this.deletedStates[O][s]===null)this.state[O][s]={};else for(const i of Object.keys(this.deletedStates[O][s]))delete this.state[O][s][i];y[s]=this.state[O][s]}F[O]=F[O]||{},a.e(F[O],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(F).length!==0)for(const O in A)A[O].setFeatureState(F,I)}}class ln extends a.E{constructor(A,I,F){super(),this.id=A,this.dispatcher=F,this.on("data",O=>{O.dataType==="source"&&O.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&O.dataType==="source"&&O.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((O,y,s,i)=>{const r=new(_n(y.type))(O,y,s,i);if(r.id!==O)throw new Error(`Expected Source id to be ${O} instead of ${r.id}`);return r})(A,I,F,this),this._tiles={},this._cache=new ns(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new fi,this._didEmitContent=!1,this._updated=!1}onAdd(A){this.map=A,this._maxTileCacheSize=A?A._maxTileCacheSize:null,this._maxTileCacheZoomLevels=A?A._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(A)}onRemove(A){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(A)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const A in this._tiles){const I=this._tiles[A];if(I.state!=="loaded"&&I.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const A=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,A&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(A,I){return this._source.loadTile(A,I)}_unloadTile(A){if(this._source.unloadTile)return this._source.unloadTile(A,()=>{})}_abortTile(A){this._source.abortTile&&this._source.abortTile(A,()=>{}),this._source.fire(new a.k("dataabort",{tile:A,coord:A.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(A){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const I in this._tiles){const F=this._tiles[I];F.upload(A),F.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(A=>A.tileID).sort(pr).map(A=>A.key)}getRenderableIds(A){const I=[];for(const F in this._tiles)this._isIdRenderable(F,A)&&I.push(this._tiles[F]);return A?I.sort((F,O)=>{const y=F.tileID,s=O.tileID,i=new a.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),r=new a.P(s.canonical.x,s.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-s.overscaledZ||r.y-i.y||r.x-i.x}).map(F=>F.tileID.key):I.map(F=>F.tileID).sort(pr).map(F=>F.key)}hasRenderableParent(A){const I=this.findLoadedParent(A,0);return!!I&&this._isIdRenderable(I.tileID.key)}_isIdRenderable(A,I){return this._tiles[A]&&this._tiles[A].hasData()&&!this._coveredTiles[A]&&(I||!this._tiles[A].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const A in this._tiles)this._tiles[A].state!=="errored"&&this._reloadTile(A,"reloading")}}_reloadTile(A,I){const F=this._tiles[A];F&&(F.state!=="loading"&&(F.state=I),this._loadTile(F,this._tileLoaded.bind(this,F,A,I)))}_tileLoaded(A,I,F,O){if(O)return A.state="errored",void(O.status!==404?this._source.fire(new a.j(O,{tile:A})):this.update(this.transform,this.terrain));A.timeAdded=a.h.now(),F==="expired"&&(A.refreshedUponExpiration=!0),this._setTileReloadTimer(I,A),this.getSource().type==="raster-dem"&&A.dem&&this._backfillDEM(A),this._state.initializeTileState(A,this.map?this.map.painter:null),A.aborted||this._source.fire(new a.k("data",{dataType:"source",tile:A,coord:A.tileID}))}_backfillDEM(A){const I=this.getRenderableIds();for(let O=0;O<I.length;O++){const y=I[O];if(A.neighboringTiles&&A.neighboringTiles[y]){const s=this.getTileByID(y);F(A,s),F(s,A)}}function F(O,y){O.needsHillshadePrepare=!0,O.needsTerrainPrepare=!0;let s=y.tileID.canonical.x-O.tileID.canonical.x;const i=y.tileID.canonical.y-O.tileID.canonical.y,r=Math.pow(2,O.tileID.canonical.z),l=y.tileID.key;s===0&&i===0||Math.abs(i)>1||(Math.abs(s)>1&&(Math.abs(s+r)===1?s+=r:Math.abs(s-r)===1&&(s-=r)),y.dem&&O.dem&&(O.dem.backfillBorder(y.dem,s,i),O.neighboringTiles&&O.neighboringTiles[l]&&(O.neighboringTiles[l].backfilled=!0)))}}getTile(A){return this.getTileByID(A.key)}getTileByID(A){return this._tiles[A]}_retainLoadedChildren(A,I,F,O){for(const y in this._tiles){let s=this._tiles[y];if(O[y]||!s.hasData()||s.tileID.overscaledZ<=I||s.tileID.overscaledZ>F)continue;let i=s.tileID;for(;s&&s.tileID.overscaledZ>I+1;){const l=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[l.key],s&&s.hasData()&&(i=l)}let r=i;for(;r.overscaledZ>I;)if(r=r.scaledTo(r.overscaledZ-1),A[r.key]){O[i.key]=i;break}}}findLoadedParent(A,I){if(A.key in this._loadedParentTiles){const F=this._loadedParentTiles[A.key];return F&&F.tileID.overscaledZ>=I?F:null}for(let F=A.overscaledZ-1;F>=I;F--){const O=A.scaledTo(F),y=this._getLoadedTile(O);if(y)return y}}_getLoadedTile(A){const I=this._tiles[A.key];return I&&I.hasData()?I:this._cache.getByKey(A.wrapped().key)}updateCacheSize(A){const I=Math.ceil(A.width/this._source.tileSize)+1,F=Math.ceil(A.height/this._source.tileSize)+1,O=Math.floor(I*F*(this._maxTileCacheZoomLevels===null?a.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(y)}handleWrapJump(A){const I=Math.round((A-(this._prevLng===void 0?A:this._prevLng))/360);if(this._prevLng=A,I){const F={};for(const O in this._tiles){const y=this._tiles[O];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+I),F[y.tileID.key]=y}this._tiles=F;for(const O in this._timers)clearTimeout(this._timers[O]),delete this._timers[O];for(const O in this._tiles)this._setTileReloadTimer(O,this._tiles[O])}}update(A,I){if(this.transform=A,this.terrain=I,!this._sourceLoaded||this._paused)return;let F;this.updateCacheSize(A),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?F=A.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new a.O(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(F=A.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:I}),this._source.hasTile&&(F=F.filter(d=>this._source.hasTile(d)))):F=[];const O=A.coveringZoomLevel(this._source),y=Math.max(O-ln.maxOverzooming,this._source.minzoom),s=Math.max(O+ln.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const d={};for(const _ of F)if(_.canonical.z>this._source.minzoom){const w=_.scaledTo(_.canonical.z-1);d[w.key]=w;const T=_.scaledTo(Math.max(this._source.minzoom,Math.min(_.canonical.z,5)));d[T.key]=T}F=F.concat(Object.values(d))}const i=F.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,i&&this.fire(new a.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const r=this._updateRetainedTiles(F,O);if(On(this._source.type)){const d={},_={},w=Object.keys(r),T=a.h.now();for(const B of w){const j=r[B],Y=this._tiles[B];if(!Y||Y.fadeEndTime!==0&&Y.fadeEndTime<=T)continue;const ue=this.findLoadedParent(j,y);ue&&(this._addTile(ue.tileID),d[ue.tileID.key]=ue.tileID),_[B]=j}this._retainLoadedChildren(_,O,s,r);for(const B in d)r[B]||(this._coveredTiles[B]=!0,r[B]=d[B]);if(I){const B={},j={};for(const Y of F)this._tiles[Y.key].hasData()?B[Y.key]=Y:j[Y.key]=Y;for(const Y in j){const ue=j[Y].children(this._source.maxzoom);this._tiles[ue[0].key]&&this._tiles[ue[1].key]&&this._tiles[ue[2].key]&&this._tiles[ue[3].key]&&(B[ue[0].key]=r[ue[0].key]=ue[0],B[ue[1].key]=r[ue[1].key]=ue[1],B[ue[2].key]=r[ue[2].key]=ue[2],B[ue[3].key]=r[ue[3].key]=ue[3],delete j[Y])}for(const Y in j){const ue=this.findLoadedParent(j[Y],this._source.minzoom);if(ue){B[ue.tileID.key]=r[ue.tileID.key]=ue.tileID;for(const Se in B)B[Se].isChildOf(ue.tileID)&&delete B[Se]}}for(const Y in this._tiles)B[Y]||(this._coveredTiles[Y]=!0)}}for(const d in r)this._tiles[d].clearFadeHold();const l=a.ab(this._tiles,r);for(const d of l){const _=this._tiles[d];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(d)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const A in this._tiles)this._tiles[A].holdingForFade()&&this._removeTile(A)}_updateRetainedTiles(A,I){const F={},O={},y=Math.max(I-ln.maxOverzooming,this._source.minzoom),s=Math.max(I+ln.maxUnderzooming,this._source.minzoom),i={};for(const r of A){const l=this._addTile(r);F[r.key]=r,l.hasData()||I<this._source.maxzoom&&(i[r.key]=r)}this._retainLoadedChildren(i,I,s,F);for(const r of A){let l=this._tiles[r.key];if(l.hasData())continue;if(I+1>this._source.maxzoom){const _=r.children(this._source.maxzoom)[0],w=this.getTile(_);if(w&&w.hasData()){F[_.key]=_;continue}}else{const _=r.children(this._source.maxzoom);if(F[_[0].key]&&F[_[1].key]&&F[_[2].key]&&F[_[3].key])continue}let d=l.wasRequested();for(let _=r.overscaledZ-1;_>=y;--_){const w=r.scaledTo(_);if(O[w.key])break;if(O[w.key]=!0,l=this.getTile(w),!l&&d&&(l=this._addTile(w)),l){const T=l.hasData();if((d||T)&&(F[w.key]=w),d=l.wasRequested(),T)break}}}return F}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const A in this._tiles){const I=[];let F,O=this._tiles[A].tileID;for(;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){F=this._loadedParentTiles[O.key];break}I.push(O.key);const y=O.scaledTo(O.overscaledZ-1);if(F=this._getLoadedTile(y),F)break;O=y}for(const y of I)this._loadedParentTiles[y]=F}}_addTile(A){let I=this._tiles[A.key];if(I)return I;I=this._cache.getAndRemove(A),I&&(this._setTileReloadTimer(A.key,I),I.tileID=A,this._state.initializeTileState(I,this.map?this.map.painter:null),this._cacheTimers[A.key]&&(clearTimeout(this._cacheTimers[A.key]),delete this._cacheTimers[A.key],this._setTileReloadTimer(A.key,I)));const F=I;return I||(I=new Mn(A,this._source.tileSize*A.overscaleFactor()),this._loadTile(I,this._tileLoaded.bind(this,I,A.key,I.state))),I.uses++,this._tiles[A.key]=I,F||this._source.fire(new a.k("dataloading",{tile:I,coord:I.tileID,dataType:"source"})),I}_setTileReloadTimer(A,I){A in this._timers&&(clearTimeout(this._timers[A]),delete this._timers[A]);const F=I.getExpiryTimeout();F&&(this._timers[A]=setTimeout(()=>{this._reloadTile(A,"expired"),delete this._timers[A]},F))}_removeTile(A){const I=this._tiles[A];I&&(I.uses--,delete this._tiles[A],this._timers[A]&&(clearTimeout(this._timers[A]),delete this._timers[A]),I.uses>0||(I.hasData()&&I.state!=="reloading"?this._cache.add(I.tileID,I,I.getExpiryTimeout()):(I.aborted=!0,this._abortTile(I),this._unloadTile(I))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const A in this._tiles)this._removeTile(A);this._cache.reset()}tilesIn(A,I,F){const O=[],y=this.transform;if(!y)return O;const s=F?y.getCameraQueryGeometry(A):A,i=A.map(B=>y.pointCoordinate(B,this.terrain)),r=s.map(B=>y.pointCoordinate(B,this.terrain)),l=this.getIds();let d=1/0,_=1/0,w=-1/0,T=-1/0;for(const B of r)d=Math.min(d,B.x),_=Math.min(_,B.y),w=Math.max(w,B.x),T=Math.max(T,B.y);for(let B=0;B<l.length;B++){const j=this._tiles[l[B]];if(j.holdingForFade())continue;const Y=j.tileID,ue=Math.pow(2,y.zoom-j.tileID.overscaledZ),Se=I*j.queryPadding*a.N/j.tileSize/ue,Te=[Y.getTilePoint(new a.U(d,_)),Y.getTilePoint(new a.U(w,T))];if(Te[0].x-Se<a.N&&Te[0].y-Se<a.N&&Te[1].x+Se>=0&&Te[1].y+Se>=0){const Re=i.map($e=>Y.getTilePoint($e)),Be=r.map($e=>Y.getTilePoint($e));O.push({tile:j,tileID:Y,queryGeometry:Re,cameraQueryGeometry:Be,scale:ue})}}return O}getVisibleCoordinates(A){const I=this.getRenderableIds(A).map(F=>this._tiles[F].tileID);for(const F of I)F.posMatrix=this.transform.calculatePosMatrix(F.toUnwrapped());return I}hasTransition(){if(this._source.hasTransition())return!0;if(On(this._source.type)){const A=a.h.now();for(const I in this._tiles)if(this._tiles[I].fadeEndTime>=A)return!0}return!1}setFeatureState(A,I,F){this._state.updateState(A=A||"_geojsonTileLayer",I,F)}removeFeatureState(A,I,F){this._state.removeFeatureState(A=A||"_geojsonTileLayer",I,F)}getFeatureState(A,I){return this._state.getState(A=A||"_geojsonTileLayer",I)}setDependencies(A,I,F){const O=this._tiles[A];O&&O.setDependencies(I,F)}reloadTilesForDependencies(A,I){for(const F in this._tiles)this._tiles[F].hasDependency(A,I)&&this._reloadTile(F,"reloading");this._cache.filter(F=>!F.hasDependency(A,I))}}function pr(Z,A){const I=Math.abs(2*Z.wrap)-+(Z.wrap<0),F=Math.abs(2*A.wrap)-+(A.wrap<0);return Z.overscaledZ-A.overscaledZ||F-I||A.canonical.y-Z.canonical.y||A.canonical.x-Z.canonical.x}function On(Z){return Z==="raster"||Z==="image"||Z==="video"}ln.maxOverzooming=10,ln.maxUnderzooming=3;const Qn="mapboxgl_preloaded_worker_pool";class wn{constructor(){this.active={}}acquire(A){if(!this.workers)for(this.workers=[];this.workers.length<wn.workerCount;)this.workers.push(new Worker(a.c.WORKER_URL));return this.active[A]=!0,this.workers.slice()}release(A){delete this.active[A],this.numActive()===0&&(this.workers.forEach(I=>{I.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qn]}numActive(){return Object.keys(this.active).length}}const v=Math.floor(a.h.hardwareConcurrency/2);let k;function V(){return k||(k=new wn),k}wn.workerCount=a.ac(globalThis)?Math.max(Math.min(v,3),1):1;class ${constructor(A,I){this.reset(A,I)}reset(A,I){this.points=A||[],this._distances=[0];for(let F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(I||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(A){if(this.points.length===1)return this.points[0];A=a.ad(A,0,1);let I=1,F=this._distances[I];const O=A*this.paddedLength+this.padding;for(;F<O&&I<this._distances.length;)F=this._distances[++I];const y=I-1,s=this._distances[y],i=F-s,r=i>0?(O-s)/i:0;return this.points[y].mult(1-r).add(this.points[I].mult(r))}}function te(Z,A){let I=!0;return Z==="always"||Z!=="never"&&A!=="never"||(I=!1),I}class Ae{constructor(A,I,F){const O=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(A/F),this.yCellCount=Math.ceil(I/F);for(let s=0;s<this.xCellCount*this.yCellCount;s++)O.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=A,this.height=I,this.xScale=this.xCellCount/A,this.yScale=this.yCellCount/I,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(A,I,F,O,y){this._forEachCell(I,F,O,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(A),this.bboxes.push(I),this.bboxes.push(F),this.bboxes.push(O),this.bboxes.push(y)}insertCircle(A,I,F,O){this._forEachCell(I-O,F-O,I+O,F+O,this._insertCircleCell,this.circleUid++),this.circleKeys.push(A),this.circles.push(I),this.circles.push(F),this.circles.push(O)}_insertBoxCell(A,I,F,O,y,s){this.boxCells[y].push(s)}_insertCircleCell(A,I,F,O,y,s){this.circleCells[y].push(s)}_query(A,I,F,O,y,s,i){if(F<0||A>this.width||O<0||I>this.height)return[];const r=[];if(A<=0&&I<=0&&this.width<=F&&this.height<=O){if(y)return[{key:null,x1:A,y1:I,x2:F,y2:O}];for(let l=0;l<this.boxKeys.length;l++)r.push({key:this.boxKeys[l],x1:this.bboxes[4*l],y1:this.bboxes[4*l+1],x2:this.bboxes[4*l+2],y2:this.bboxes[4*l+3]});for(let l=0;l<this.circleKeys.length;l++){const d=this.circles[3*l],_=this.circles[3*l+1],w=this.circles[3*l+2];r.push({key:this.circleKeys[l],x1:d-w,y1:_-w,x2:d+w,y2:_+w})}}else this._forEachCell(A,I,F,O,this._queryCell,r,{hitTest:y,overlapMode:s,seenUids:{box:{},circle:{}}},i);return r}query(A,I,F,O){return this._query(A,I,F,O,!1,null)}hitTest(A,I,F,O,y,s){return this._query(A,I,F,O,!0,y,s).length>0}hitTestCircle(A,I,F,O,y){const s=A-F,i=A+F,r=I-F,l=I+F;if(i<0||s>this.width||l<0||r>this.height)return!1;const d=[];return this._forEachCell(s,r,i,l,this._queryCellCircle,d,{hitTest:!0,overlapMode:O,circle:{x:A,y:I,radius:F},seenUids:{box:{},circle:{}}},y),d.length>0}_queryCell(A,I,F,O,y,s,i,r){const{seenUids:l,hitTest:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!l.box[j]){l.box[j]=!0;const Y=4*j,ue=this.boxKeys[j];if(A<=B[Y+2]&&I<=B[Y+3]&&F>=B[Y+0]&&O>=B[Y+1]&&(!r||r(ue))&&(!d||!te(_,ue.overlapMode))&&(s.push({key:ue,x1:B[Y],y1:B[Y+1],x2:B[Y+2],y2:B[Y+3]}),d))return!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!l.circle[j]){l.circle[j]=!0;const Y=3*j,ue=this.circleKeys[j];if(this._circleAndRectCollide(B[Y],B[Y+1],B[Y+2],A,I,F,O)&&(!r||r(ue))&&(!d||!te(_,ue.overlapMode))){const Se=B[Y],Te=B[Y+1],Re=B[Y+2];if(s.push({key:ue,x1:Se-Re,y1:Te-Re,x2:Se+Re,y2:Te+Re}),d)return!0}}}return!1}_queryCellCircle(A,I,F,O,y,s,i,r){const{circle:l,seenUids:d,overlapMode:_}=i,w=this.boxCells[y];if(w!==null){const B=this.bboxes;for(const j of w)if(!d.box[j]){d.box[j]=!0;const Y=4*j,ue=this.boxKeys[j];if(this._circleAndRectCollide(l.x,l.y,l.radius,B[Y+0],B[Y+1],B[Y+2],B[Y+3])&&(!r||r(ue))&&!te(_,ue.overlapMode))return s.push(!0),!0}}const T=this.circleCells[y];if(T!==null){const B=this.circles;for(const j of T)if(!d.circle[j]){d.circle[j]=!0;const Y=3*j,ue=this.circleKeys[j];if(this._circlesCollide(B[Y],B[Y+1],B[Y+2],l.x,l.y,l.radius)&&(!r||r(ue))&&!te(_,ue.overlapMode))return s.push(!0),!0}}}_forEachCell(A,I,F,O,y,s,i,r){const l=this._convertToXCellCoord(A),d=this._convertToYCellCoord(I),_=this._convertToXCellCoord(F),w=this._convertToYCellCoord(O);for(let T=l;T<=_;T++)for(let B=d;B<=w;B++)if(y.call(this,A,I,F,O,this.xCellCount*B+T,s,i,r))return}_convertToXCellCoord(A){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(A*this.xScale)))}_convertToYCellCoord(A){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(A*this.yScale)))}_circlesCollide(A,I,F,O,y,s){const i=O-A,r=y-I,l=F+s;return l*l>i*i+r*r}_circleAndRectCollide(A,I,F,O,y,s,i){const r=(s-O)/2,l=Math.abs(A-(O+r));if(l>r+F)return!1;const d=(i-y)/2,_=Math.abs(I-(y+d));if(_>d+F)return!1;if(l<=r||_<=d)return!0;const w=l-r,T=_-d;return w*w+T*T<=F*F}}function ve(Z,A,I,F,O){const y=a.Z();return A?(a.a0(y,y,[1/O,1/O,1]),I||a.ae(y,y,F.angle)):a.a1(y,F.labelPlaneMatrix,Z),y}function Ie(Z,A,I,F,O){if(A){const y=a.af(Z);return a.a0(y,y,[O,O,1]),I||a.ae(y,y,-F.angle),y}return F.glCoordMatrix}function Ee(Z,A,I){let F;I?(F=[Z.x,Z.y,I(Z.x,Z.y),1],a.ag(F,F,A)):(F=[Z.x,Z.y,0,1],ye(F,F,A));const O=F[3];return{point:new a.P(F[0]/O,F[1]/O),signedDistanceFromCamera:O}}function ze(Z,A){return .5+Z/A*.5}function Qe(Z,A){const I=Z[0]/Z[3],F=Z[1]/Z[3];return I>=-A[0]&&I<=A[0]&&F>=-A[1]&&F<=A[1]}function He(Z,A,I,F,O,y,s,i,r,l){const d=F?Z.textSizeData:Z.iconSizeData,_=a.ah(d,I.transform.zoom),w=[256/I.width*2+1,256/I.height*2+1],T=F?Z.text.dynamicLayoutVertexArray:Z.icon.dynamicLayoutVertexArray;T.clear();const B=Z.lineVertexArray,j=F?Z.text.placedSymbolArray:Z.icon.placedSymbolArray,Y=I.transform.width/I.transform.height;let ue=!1;for(let Se=0;Se<j.length;Se++){const Te=j.get(Se);if(Te.hidden||Te.writingMode===a.ai.vertical&&!ue){de(Te.numGlyphs,T);continue}let Re;if(ue=!1,l?(Re=[Te.anchorX,Te.anchorY,l(Te.anchorX,Te.anchorY),1],a.ag(Re,Re,A)):(Re=[Te.anchorX,Te.anchorY,0,1],ye(Re,Re,A)),!Qe(Re,w)){de(Te.numGlyphs,T);continue}const Be=ze(I.transform.cameraToCenterDistance,Re[3]),$e=a.aj(d,_,Te),vt=s?$e/Be:$e*Be,ot=new a.P(Te.anchorX,Te.anchorY),ct=Ee(ot,O,l).point,Et={projections:{},offsets:{}},wt=ft(Te,vt,!1,i,A,O,y,Z.glyphOffsetArray,B,T,ct,ot,Et,Y,r,l);ue=wt.useVertical,(wt.notEnoughRoom||ue||wt.needsFlipping&&ft(Te,vt,!0,i,A,O,y,Z.glyphOffsetArray,B,T,ct,ot,Et,Y,r,l).notEnoughRoom)&&de(Te.numGlyphs,T)}F?Z.text.dynamicLayoutVertexBuffer.updateData(T):Z.icon.dynamicLayoutVertexBuffer.updateData(T)}function Ze(Z,A,I,F,O,y,s,i,r,l,d,_,w){const T=i.glyphStartIndex+i.numGlyphs,B=i.lineStartIndex,j=i.lineStartIndex+i.lineLength,Y=A.getoffsetX(i.glyphStartIndex),ue=A.getoffsetX(T-1),Se=X(Z*Y,I,F,O,y,s,i.segment,B,j,r,l,d,_,w);if(!Se)return null;const Te=X(Z*ue,I,F,O,y,s,i.segment,B,j,r,l,d,_,w);return Te?{first:Se,last:Te}:null}function Ve(Z,A,I,F){return Z===a.ai.horizontal&&Math.abs(I.y-A.y)>Math.abs(I.x-A.x)*F?{useVertical:!0}:(Z===a.ai.vertical?A.y<I.y:A.x>I.x)?{needsFlipping:!0}:null}function ft(Z,A,I,F,O,y,s,i,r,l,d,_,w,T,B,j){const Y=A/24,ue=Z.lineOffsetX*Y,Se=Z.lineOffsetY*Y;let Te;if(Z.numGlyphs>1){const Re=Z.glyphStartIndex+Z.numGlyphs,Be=Z.lineStartIndex,$e=Z.lineStartIndex+Z.lineLength,vt=Ze(Y,i,ue,Se,I,d,_,Z,r,y,w,B,j);if(!vt)return{notEnoughRoom:!0};const ot=Ee(vt.first.point,s,j).point,ct=Ee(vt.last.point,s,j).point;if(F&&!I){const Et=Ve(Z.writingMode,ot,ct,T);if(Et)return Et}Te=[vt.first];for(let Et=Z.glyphStartIndex+1;Et<Re-1;Et++)Te.push(X(Y*i.getoffsetX(Et),ue,Se,I,d,_,Z.segment,Be,$e,r,y,w,B,j));Te.push(vt.last)}else{if(F&&!I){const Be=Ee(_,O,j).point,$e=Z.lineStartIndex+Z.segment+1,vt=new a.P(r.getx($e),r.gety($e)),ot=Ee(vt,O,j),ct=ot.signedDistanceFromCamera>0?ot.point:rt(_,vt,Be,1,O,j),Et=Ve(Z.writingMode,Be,ct,T);if(Et)return Et}const Re=X(Y*i.getoffsetX(Z.glyphStartIndex),ue,Se,I,d,_,Z.segment,Z.lineStartIndex,Z.lineStartIndex+Z.lineLength,r,y,w,B,j);if(!Re)return{notEnoughRoom:!0};Te=[Re]}for(const Re of Te)a.ak(l,Re.point,Re.angle);return{}}function rt(Z,A,I,F,O,y){const s=Ee(Z.add(Z.sub(A)._unit()),O,y).point,i=I.sub(s);return I.add(i._mult(F/i.mag()))}function Me(Z,A){const{projectionCache:I,lineVertexArray:F,labelPlaneMatrix:O,tileAnchorPoint:y,distanceFromAnchor:s,getElevation:i,previousVertex:r,direction:l,absOffsetX:d}=A;if(I.projections[Z])return I.projections[Z];const _=new a.P(F.getx(Z),F.gety(Z)),w=Ee(_,O,i);if(w.signedDistanceFromCamera>0)return I.projections[Z]=w.point,w.point;const T=Z-l;return rt(s===0?y:new a.P(F.getx(T),F.gety(T)),_,r,d-s+1,O,i)}function se(Z,A,I){return Z._unit()._perp()._mult(A*I)}function ne(Z,A,I,F,O,y,s,i){const{projectionCache:r,direction:l}=i;if(r.offsets[Z])return r.offsets[Z];const d=I.add(A);if(Z+l<F||Z+l>=O)return r.offsets[Z]=d,d;const _=Me(Z+l,i),w=se(_.sub(I),s,l),T=I.add(w),B=_.add(w);return r.offsets[Z]=a.al(y,d,T,B)||d,r.offsets[Z]}function X(Z,A,I,F,O,y,s,i,r,l,d,_,w,T){const B=F?Z-A:Z+A;let j=B>0?1:-1,Y=0;F&&(j*=-1,Y=Math.PI),j<0&&(Y+=Math.PI);let ue,Se,Te=j>0?i+s:i+s+1,Re=O,Be=O,$e=0,vt=0;const ot=Math.abs(B),ct=[];let Et;for(;$e+vt<=ot;){if(Te+=j,Te<i||Te>=r)return null;$e+=vt,Be=Re,Se=ue;const Xt={projectionCache:_,lineVertexArray:l,labelPlaneMatrix:d,tileAnchorPoint:y,distanceFromAnchor:$e,getElevation:T,previousVertex:Be,direction:j,absOffsetX:ot};if(Re=Me(Te,Xt),I===0)ct.push(Be),Et=Re.sub(Be);else{let Jt;const si=Re.sub(Be);Jt=si.mag()===0?se(Me(Te+j,Xt).sub(Re),I,j):se(si,I,j),Se||(Se=Be.add(Jt)),ue=ne(Te,Jt,Re,i,r,Se,I,Xt),ct.push(Se),Et=ue.sub(Se)}vt=Et.mag()}const wt=Et._mult((ot-$e)/vt)._add(Se||Be),ri=Y+Math.atan2(Re.y-Be.y,Re.x-Be.x);return ct.push(wt),{point:wt,angle:w?ri:0,path:ct}}const ie=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function de(Z,A){for(let I=0;I<Z;I++){const F=A.length;A.resize(F+4),A.float32.set(ie,3*F)}}function ye(Z,A,I){const F=A[0],O=A[1];return Z[0]=I[0]*F+I[4]*O+I[12],Z[1]=I[1]*F+I[5]*O+I[13],Z[3]=I[3]*F+I[7]*O+I[15],Z}const ge=100;class Pe{constructor(A,I=new Ae(A.width+200,A.height+200,25),F=new Ae(A.width+200,A.height+200,25)){this.transform=A,this.grid=I,this.ignoredGrid=F,this.pitchfactor=Math.cos(A._pitch)*A.cameraToCenterDistance,this.screenRightBoundary=A.width+ge,this.screenBottomBoundary=A.height+ge,this.gridRightBoundary=A.width+200,this.gridBottomBoundary=A.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(A,I,F,O,y,s){const i=this.projectAndGetPerspectiveRatio(O,A.anchorPointX,A.anchorPointY,s),r=F*i.perspectiveRatio,l=A.x1*r+i.point.x,d=A.y1*r+i.point.y,_=A.x2*r+i.point.x,w=A.y2*r+i.point.y;return!this.isInsideGrid(l,d,_,w)||I!=="always"&&this.grid.hitTest(l,d,_,w,I,y)||i.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,d,_,w],offscreen:this.isOffscreen(l,d,_,w)}}placeCollisionCircles(A,I,F,O,y,s,i,r,l,d,_,w,T,B){const j=[],Y=new a.P(I.anchorX,I.anchorY),ue=Ee(Y,s,B),Se=ze(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),Te=(d?y/Se:y*Se)/a.ap,Re=Ee(Y,i,B).point,Be=Ze(Te,O,I.lineOffsetX*Te,I.lineOffsetY*Te,!1,Re,Y,I,F,i,{projections:{},offsets:{}},!1,B);let $e=!1,vt=!1,ot=!0;if(Be){const ct=.5*w*Se+T,Et=new a.P(-100,-100),wt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),ri=new $,Xt=Be.first,Jt=Be.last;let si=[];for(let Ii=Xt.path.length-1;Ii>=1;Ii--)si.push(Xt.path[Ii]);for(let Ii=1;Ii<Jt.path.length;Ii++)si.push(Jt.path[Ii]);const ji=2.5*ct;if(r){const Ii=si.map(Vi=>Ee(Vi,r,B));si=Ii.some(Vi=>Vi.signedDistanceFromCamera<=0)?[]:Ii.map(Vi=>Vi.point)}let Zi=[];if(si.length>0){const Ii=si[0].clone(),Vi=si[0].clone();for(let Ui=1;Ui<si.length;Ui++)Ii.x=Math.min(Ii.x,si[Ui].x),Ii.y=Math.min(Ii.y,si[Ui].y),Vi.x=Math.max(Vi.x,si[Ui].x),Vi.y=Math.max(Vi.y,si[Ui].y);Zi=Ii.x>=Et.x&&Vi.x<=wt.x&&Ii.y>=Et.y&&Vi.y<=wt.y?[si]:Vi.x<Et.x||Ii.x>wt.x||Vi.y<Et.y||Ii.y>wt.y?[]:a.am([si],Et.x,Et.y,wt.x,wt.y)}for(const Ii of Zi){ri.reset(Ii,.25*ct);let Vi=0;Vi=ri.length<=.5*ct?1:Math.ceil(ri.paddedLength/ji)+1;for(let Ui=0;Ui<Vi;Ui++){const an=Ui/Math.max(Vi-1,1),Bn=ri.lerp(an),Ji=Bn.x+ge,Cn=Bn.y+ge;j.push(Ji,Cn,ct,0);const yr=Ji-ct,er=Cn-ct,Ia=Ji+ct,Aa=Cn+ct;if(ot=ot&&this.isOffscreen(yr,er,Ia,Aa),vt=vt||this.isInsideGrid(yr,er,Ia,Aa),A!=="always"&&this.grid.hitTestCircle(Ji,Cn,ct,A,_)&&($e=!0,!l))return{circles:[],offscreen:!1,collisionDetected:$e}}}}return{circles:!l&&$e||!vt||Se<this.perspectiveRatioCutoff?[]:j,offscreen:ot,collisionDetected:$e}}queryRenderedSymbols(A){if(A.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const I=[];let F=1/0,O=1/0,y=-1/0,s=-1/0;for(const d of A){const _=new a.P(d.x+ge,d.y+ge);F=Math.min(F,_.x),O=Math.min(O,_.y),y=Math.max(y,_.x),s=Math.max(s,_.y),I.push(_)}const i=this.grid.query(F,O,y,s).concat(this.ignoredGrid.query(F,O,y,s)),r={},l={};for(const d of i){const _=d.key;if(r[_.bucketInstanceId]===void 0&&(r[_.bucketInstanceId]={}),r[_.bucketInstanceId][_.featureIndex])continue;const w=[new a.P(d.x1,d.y1),new a.P(d.x2,d.y1),new a.P(d.x2,d.y2),new a.P(d.x1,d.y2)];a.an(I,w)&&(r[_.bucketInstanceId][_.featureIndex]=!0,l[_.bucketInstanceId]===void 0&&(l[_.bucketInstanceId]=[]),l[_.bucketInstanceId].push(_.featureIndex))}return l}insertCollisionBox(A,I,F,O,y,s){(F?this.ignoredGrid:this.grid).insert({bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:I},A[0],A[1],A[2],A[3])}insertCollisionCircles(A,I,F,O,y,s){const i=F?this.ignoredGrid:this.grid,r={bucketInstanceId:O,featureIndex:y,collisionGroupID:s,overlapMode:I};for(let l=0;l<A.length;l+=4)i.insertCircle(r,A[l],A[l+1],A[l+2])}projectAndGetPerspectiveRatio(A,I,F,O){let y;return O?(y=[I,F,O(I,F),1],a.ag(y,y,A)):(y=[I,F,0,1],ye(y,y,A)),{point:new a.P((y[0]/y[3]+1)/2*this.transform.width+ge,(-y[1]/y[3]+1)/2*this.transform.height+ge),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}}isOffscreen(A,I,F,O){return F<ge||A>=this.screenRightBoundary||O<ge||I>this.screenBottomBoundary}isInsideGrid(A,I,F,O){return F>=0&&A<this.gridRightBoundary&&O>=0&&I<this.gridBottomBoundary}getViewportMatrix(){const A=a.ao([]);return a.$(A,A,[-100,-100,0]),A}}function Fe(Z,A,I){return A*(a.N/(Z.tileSize*Math.pow(2,I-Z.tileID.overscaledZ)))}class Ne{constructor(A,I,F,O){this.opacity=A?Math.max(0,Math.min(1,A.opacity+(A.placed?I:-I))):O&&F?1:0,this.placed=F}isHidden(){return this.opacity===0&&!this.placed}}class Xe{constructor(A,I,F,O,y){this.text=new Ne(A?A.text:null,I,F,y),this.icon=new Ne(A?A.icon:null,I,O,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ye{constructor(A,I,F){this.text=A,this.icon=I,this.skipFade=F}}class De{constructor(){this.invProjMatrix=a.Z(),this.viewportMatrix=a.Z(),this.circles=[]}}class Ue{constructor(A,I,F,O,y){this.bucketInstanceId=A,this.featureIndex=I,this.sourceLayerIndex=F,this.bucketIndex=O,this.tileID=y}}class ht{constructor(A){this.crossSourceCollisions=A,this.maxGroupID=0,this.collisionGroups={}}get(A){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[A]){const I=++this.maxGroupID;this.collisionGroups[A]={ID:I,predicate:F=>F.collisionGroupID===I}}return this.collisionGroups[A]}}function Tt(Z,A,I,F,O){const{horizontalAlign:y,verticalAlign:s}=a.au(Z);return new a.P(-(y-.5)*A+F[0]*O,-(s-.5)*I+F[1]*O)}function o(Z,A,I,F,O,y){const{x1:s,x2:i,y1:r,y2:l,anchorPointX:d,anchorPointY:_}=Z,w=new a.P(A,I);return F&&w._rotate(O?y:-y),{x1:s+w.x,y1:r+w.y,x2:i+w.x,y2:l+w.y,anchorPointX:d,anchorPointY:_}}class ke{constructor(A,I,F,O,y){this.transform=A.clone(),this.terrain=I,this.collisionIndex=new Pe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=F,this.retainedQueryData={},this.collisionGroups=new ht(O),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(A,I,F,O){const y=F.getBucket(I),s=F.latestFeatureIndex;if(!y||!s||I.id!==y.layerIds[0])return;const i=F.collisionBoxArray,r=y.layers[0].layout,l=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),d=F.tileSize/a.N,_=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),w=r.get("text-pitch-alignment")==="map",T=r.get("text-rotation-alignment")==="map",B=Fe(F,1,this.transform.zoom),j=ve(_,w,T,this.transform,B);let Y=null;if(w){const Se=Ie(_,w,T,this.transform,B);Y=a.a1([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[y.bucketInstanceId]=new Ue(y.bucketInstanceId,s,y.sourceLayerIndex,y.index,F.tileID);const ue={bucket:y,layout:r,posMatrix:_,textLabelPlaneMatrix:j,labelToScreenMatrix:Y,scale:l,textPixelRatio:d,holdingForFade:F.holdingForFade(),collisionBoxArray:i,partiallyEvaluatedTextSize:a.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(O)for(const Se of y.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be}=Se;A.push({sortKey:Te,symbolInstanceStart:Re,symbolInstanceEnd:Be,parameters:ue})}else A.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ue})}attemptAnchorPlacement(A,I,F,O,y,s,i,r,l,d,_,w,T,B,j,Y){const ue=a.aq[A.textAnchor],Se=[A.textOffset0,A.textOffset1],Te=Tt(ue,F,O,Se,y),Re=this.collisionIndex.placeCollisionBox(o(I,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,Y);if((!j||this.collisionIndex.placeCollisionBox(o(j,Te.x,Te.y,s,i,this.transform.angle),_,r,l,d.predicate,Y).box.length!==0)&&Re.box.length>0){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID]&&this.prevPlacement.placements[w.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[w.crossTileID].anchor),w.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[w.crossTileID]={textOffset:Se,width:F,height:O,anchor:ue,textBoxScale:y,prevAnchor:Be},this.markUsedJustification(T,ue,w,B),T.allowVerticalPlacement&&(this.markUsedOrientation(T,B,w),this.placedOrientations[w.crossTileID]=B),{shift:Te,placedGlyphBoxes:Re}}}placeLayerBucketPart(A,I,F){const{bucket:O,layout:y,posMatrix:s,textLabelPlaneMatrix:i,labelToScreenMatrix:r,textPixelRatio:l,holdingForFade:d,collisionBoxArray:_,partiallyEvaluatedTextSize:w,collisionGroup:T}=A.parameters,B=y.get("text-optional"),j=y.get("icon-optional"),Y=a.ar(y,"text-overlap","text-allow-overlap"),ue=Y==="always",Se=a.ar(y,"icon-overlap","icon-allow-overlap"),Te=Se==="always",Re=y.get("text-rotation-alignment")==="map",Be=y.get("text-pitch-alignment")==="map",$e=y.get("icon-text-fit")!=="none",vt=y.get("symbol-z-order")==="viewport-y",ot=ue&&(Te||!O.hasIconData()||j),ct=Te&&(ue||!O.hasTextData()||B);!O.collisionArrays&&_&&O.deserializeCollisionBoxes(_);const Et=this.retainedQueryData[O.bucketInstanceId].tileID,wt=this.terrain?(Xt,Jt)=>this.terrain.getElevation(Et,Xt,Jt):null,ri=(Xt,Jt)=>{var si,ji;if(I[Xt.crossTileID])return;if(d)return void(this.placements[Xt.crossTileID]=new Ye(!1,!1,!1));let Zi=!1,Ii=!1,Vi=!0,Ui=null,an={box:null,offscreen:null},Bn={box:null,offscreen:null},Ji=null,Cn=null,yr=null,er=0,Ia=0,Aa=0;Jt.textFeatureIndex?er=Jt.textFeatureIndex:Xt.useRuntimeCollisionCircles&&(er=Xt.featureIndex),Jt.verticalTextFeatureIndex&&(Ia=Jt.verticalTextFeatureIndex);const Bs=Jt.textBox;if(Bs){const Gr=Zs=>{let es=a.ai.horizontal;if(O.allowVerticalPlacement&&!Zs&&this.prevPlacement){const ts=this.prevPlacement.placedOrientations[Xt.crossTileID];ts&&(this.placedOrientations[Xt.crossTileID]=ts,es=ts,this.markUsedOrientation(O,es,Xt))}return es},ya=(Zs,es)=>{if(O.allowVerticalPlacement&&Xt.numVerticalGlyphVertices>0&&Jt.verticalTextBox){for(const ts of O.writingModes)if(ts===a.ai.vertical?(an=es(),Bn=an):an=Zs(),an&&an.box&&an.box.length)break}else an=Zs()},go=Xt.textAnchorOffsetStartIndex,_o=Xt.textAnchorOffsetEndIndex;if(_o===go){const Zs=(es,ts)=>{const Lr=this.collisionIndex.placeCollisionBox(es,Y,l,s,T.predicate,wt);return Lr&&Lr.box&&Lr.box.length&&(this.markUsedOrientation(O,ts,Xt),this.placedOrientations[Xt.crossTileID]=ts),Lr};ya(()=>Zs(Bs,a.ai.horizontal),()=>{const es=Jt.verticalTextBox;return O.allowVerticalPlacement&&Xt.numVerticalGlyphVertices>0&&es?Zs(es,a.ai.vertical):{box:null,offscreen:null}}),Gr(an&&an.box&&an.box.length)}else{let Zs=a.aq[(ji=(si=this.prevPlacement)===null||si===void 0?void 0:si.variableOffsets[Xt.crossTileID])===null||ji===void 0?void 0:ji.anchor];const es=(Lr,vs,Qs)=>{const To=Lr.x2-Lr.x1,No=Lr.y2-Lr.y1,Vo=Xt.textBoxScale,Sc=$e&&Se==="never"?vs:null;let Ws={box:[],offscreen:!1},Zl=Y==="never"?1:2,cu="never";Zs&&Zl++;for(let el=0;el<Zl;el++){for(let vl=go;vl<_o;vl++){const Pl=O.textAnchorOffsets.get(vl);if(Zs&&Pl.textAnchor!==Zs)continue;const hu=this.attemptAnchorPlacement(Pl,Lr,To,No,Vo,Re,Be,l,s,T,cu,Xt,O,Qs,Sc,wt);if(hu&&(Ws=hu.placedGlyphBoxes,Ws&&Ws.box&&Ws.box.length))return Zi=!0,Ui=hu.shift,Ws}Zs?Zs=null:cu=Y}return Ws};ya(()=>es(Bs,Jt.iconBox,a.ai.horizontal),()=>{const Lr=Jt.verticalTextBox;return O.allowVerticalPlacement&&!(an&&an.box&&an.box.length)&&Xt.numVerticalGlyphVertices>0&&Lr?es(Lr,Jt.verticalIconBox,a.ai.vertical):{box:null,offscreen:null}}),an&&(Zi=an.box,Vi=an.offscreen);const ts=Gr(an&&an.box);if(!Zi&&this.prevPlacement){const Lr=this.prevPlacement.variableOffsets[Xt.crossTileID];Lr&&(this.variableOffsets[Xt.crossTileID]=Lr,this.markUsedJustification(O,Lr.anchor,Xt,ts))}}}if(Ji=an,Zi=Ji&&Ji.box&&Ji.box.length>0,Vi=Ji&&Ji.offscreen,Xt.useRuntimeCollisionCircles){const Gr=O.text.placedSymbolArray.get(Xt.centerJustifiedTextSymbolIndex),ya=a.aj(O.textSizeData,w,Gr),go=y.get("text-padding");Cn=this.collisionIndex.placeCollisionCircles(Y,Gr,O.lineVertexArray,O.glyphOffsetArray,ya,s,i,r,F,Be,T.predicate,Xt.collisionCircleDiameter,go,wt),Cn.circles.length&&Cn.collisionDetected&&!F&&a.w("Collisions detected, but collision boxes are not shown"),Zi=ue||Cn.circles.length>0&&!Cn.collisionDetected,Vi=Vi&&Cn.offscreen}if(Jt.iconFeatureIndex&&(Aa=Jt.iconFeatureIndex),Jt.iconBox){const Gr=ya=>{const go=$e&&Ui?o(ya,Ui.x,Ui.y,Re,Be,this.transform.angle):ya;return this.collisionIndex.placeCollisionBox(go,Se,l,s,T.predicate,wt)};Bn&&Bn.box&&Bn.box.length&&Jt.verticalIconBox?(yr=Gr(Jt.verticalIconBox),Ii=yr.box.length>0):(yr=Gr(Jt.iconBox),Ii=yr.box.length>0),Vi=Vi&&yr.offscreen}const no=B||Xt.numHorizontalGlyphVertices===0&&Xt.numVerticalGlyphVertices===0,ro=j||Xt.numIconVertices===0;if(no||ro?ro?no||(Ii=Ii&&Zi):Zi=Ii&&Zi:Ii=Zi=Ii&&Zi,Zi&&Ji&&Ji.box&&this.collisionIndex.insertCollisionBox(Ji.box,Y,y.get("text-ignore-placement"),O.bucketInstanceId,Bn&&Bn.box&&Ia?Ia:er,T.ID),Ii&&yr&&this.collisionIndex.insertCollisionBox(yr.box,Se,y.get("icon-ignore-placement"),O.bucketInstanceId,Aa,T.ID),Cn&&(Zi&&this.collisionIndex.insertCollisionCircles(Cn.circles,Y,y.get("text-ignore-placement"),O.bucketInstanceId,er,T.ID),F)){const Gr=O.bucketInstanceId;let ya=this.collisionCircleArrays[Gr];ya===void 0&&(ya=this.collisionCircleArrays[Gr]=new De);for(let go=0;go<Cn.circles.length;go+=4)ya.circles.push(Cn.circles[go+0]),ya.circles.push(Cn.circles[go+1]),ya.circles.push(Cn.circles[go+2]),ya.circles.push(Cn.collisionDetected?1:0)}if(Xt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(O.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Xt.crossTileID]=new Ye(Zi||ot,Ii||ct,Vi||O.justReloaded),I[Xt.crossTileID]=!0};if(vt){if(A.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Xt=O.getSortedSymbolIndexes(this.transform.angle);for(let Jt=Xt.length-1;Jt>=0;--Jt){const si=Xt[Jt];ri(O.symbolInstances.get(si),O.collisionArrays[si])}}else for(let Xt=A.symbolInstanceStart;Xt<A.symbolInstanceEnd;Xt++)ri(O.symbolInstances.get(Xt),O.collisionArrays[Xt]);if(F&&O.bucketInstanceId in this.collisionCircleArrays){const Xt=this.collisionCircleArrays[O.bucketInstanceId];a.as(Xt.invProjMatrix,s),Xt.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1}markUsedJustification(A,I,F,O){let y;y=O===a.ai.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[a.at(I)];const s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];for(const i of s)i>=0&&(A.text.placedSymbolArray.get(i).crossTileID=y>=0&&i!==y?0:F.crossTileID)}markUsedOrientation(A,I,F){const O=I===a.ai.horizontal||I===a.ai.horizontalOnly?I:0,y=I===a.ai.vertical?I:0,s=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];for(const i of s)A.text.placedSymbolArray.get(i).placedOrientation=O;F.verticalPlacedTextSymbolIndex&&(A.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(A){this.commitTime=A,this.zoomAtLastRecencyCheck=this.transform.zoom;const I=this.prevPlacement;let F=!1;this.prevZoomAdjustment=I?I.zoomAdjustment(this.transform.zoom):0;const O=I?I.symbolFadeChange(A):1,y=I?I.opacities:{},s=I?I.variableOffsets:{},i=I?I.placedOrientations:{};for(const r in this.placements){const l=this.placements[r],d=y[r];d?(this.opacities[r]=new Xe(d,O,l.text,l.icon),F=F||l.text!==d.text.placed||l.icon!==d.icon.placed):(this.opacities[r]=new Xe(null,O,l.text,l.icon,l.skipFade),F=F||l.text||l.icon)}for(const r in y){const l=y[r];if(!this.opacities[r]){const d=new Xe(l,O,!1,!1);d.isHidden()||(this.opacities[r]=d,F=F||l.text.placed||l.icon.placed)}}for(const r in s)this.variableOffsets[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.variableOffsets[r]=s[r]);for(const r in i)this.placedOrientations[r]||!this.opacities[r]||this.opacities[r].isHidden()||(this.placedOrientations[r]=i[r]);if(I&&I.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");F?this.lastPlacementChangeTime=A:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=I?I.lastPlacementChangeTime:A)}updateLayerOpacities(A,I){const F={};for(const O of I){const y=O.getBucket(A);y&&O.latestFeatureIndex&&A.id===y.layerIds[0]&&this.updateBucketOpacities(y,F,O.collisionBoxArray)}}updateBucketOpacities(A,I,F){A.hasTextData()&&(A.text.opacityVertexArray.clear(),A.text.hasVisibleVertices=!1),A.hasIconData()&&(A.icon.opacityVertexArray.clear(),A.icon.hasVisibleVertices=!1),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexArray.clear(),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexArray.clear();const O=A.layers[0],y=O.layout,s=new Xe(null,0,!1,!1,!0),i=y.get("text-allow-overlap"),r=y.get("icon-allow-overlap"),l=O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"),d=y.get("text-rotation-alignment")==="map",_=y.get("text-pitch-alignment")==="map",w=y.get("icon-text-fit")!=="none",T=new Xe(null,0,i&&(r||!A.hasIconData()||y.get("icon-optional")),r&&(i||!A.hasTextData()||y.get("text-optional")),!0);!A.collisionArrays&&F&&(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData())&&A.deserializeCollisionBoxes(F);const B=(j,Y,ue)=>{for(let Se=0;Se<Y/4;Se++)j.opacityVertexArray.emplaceBack(ue);j.hasVisibleVertices=j.hasVisibleVertices||ue!==vn};for(let j=0;j<A.symbolInstances.length;j++){const Y=A.symbolInstances.get(j),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:Se,crossTileID:Te}=Y;let Re=this.opacities[Te];I[Te]?Re=s:Re||(Re=T,this.opacities[Te]=Re),I[Te]=!0;const Be=Y.numIconVertices>0,$e=this.placedOrientations[Y.crossTileID],vt=$e===a.ai.vertical,ot=$e===a.ai.horizontal||$e===a.ai.horizontalOnly;if(ue>0||Se>0){const ct=Yt(Re.text);B(A.text,ue,vt?vn:ct),B(A.text,Se,ot?vn:ct);const Et=Re.text.isHidden();[Y.rightJustifiedTextSymbolIndex,Y.centerJustifiedTextSymbolIndex,Y.leftJustifiedTextSymbolIndex].forEach(Xt=>{Xt>=0&&(A.text.placedSymbolArray.get(Xt).hidden=Et||vt?1:0)}),Y.verticalPlacedTextSymbolIndex>=0&&(A.text.placedSymbolArray.get(Y.verticalPlacedTextSymbolIndex).hidden=Et||ot?1:0);const wt=this.variableOffsets[Y.crossTileID];wt&&this.markUsedJustification(A,wt.anchor,Y,$e);const ri=this.placedOrientations[Y.crossTileID];ri&&(this.markUsedJustification(A,"left",Y,ri),this.markUsedOrientation(A,ri,Y))}if(Be){const ct=Yt(Re.icon),Et=!(w&&Y.verticalPlacedIconSymbolIndex&&vt);Y.placedIconSymbolIndex>=0&&(B(A.icon,Y.numIconVertices,Et?ct:vn),A.icon.placedSymbolArray.get(Y.placedIconSymbolIndex).hidden=Re.icon.isHidden()),Y.verticalPlacedIconSymbolIndex>=0&&(B(A.icon,Y.numVerticalIconVertices,Et?vn:ct),A.icon.placedSymbolArray.get(Y.verticalPlacedIconSymbolIndex).hidden=Re.icon.isHidden())}if(A.hasIconCollisionBoxData()||A.hasTextCollisionBoxData()){const ct=A.collisionArrays[j];if(ct){let Et=new a.P(0,0);if(ct.textBox||ct.verticalTextBox){let ri=!0;if(l){const Xt=this.variableOffsets[Te];Xt?(Et=Tt(Xt.anchor,Xt.width,Xt.height,Xt.textOffset,Xt.textBoxScale),d&&Et._rotate(_?this.transform.angle:-this.transform.angle)):ri=!1}ct.textBox&&ai(A.textCollisionBox.collisionVertexArray,Re.text.placed,!ri||vt,Et.x,Et.y),ct.verticalTextBox&&ai(A.textCollisionBox.collisionVertexArray,Re.text.placed,!ri||ot,Et.x,Et.y)}const wt=!!(!ot&&ct.verticalIconBox);ct.iconBox&&ai(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,wt,w?Et.x:0,w?Et.y:0),ct.verticalIconBox&&ai(A.iconCollisionBox.collisionVertexArray,Re.icon.placed,!wt,w?Et.x:0,w?Et.y:0)}}}if(A.sortFeatures(this.transform.angle),this.retainedQueryData[A.bucketInstanceId]&&(this.retainedQueryData[A.bucketInstanceId].featureSortOrder=A.featureSortOrder),A.hasTextData()&&A.text.opacityVertexBuffer&&A.text.opacityVertexBuffer.updateData(A.text.opacityVertexArray),A.hasIconData()&&A.icon.opacityVertexBuffer&&A.icon.opacityVertexBuffer.updateData(A.icon.opacityVertexArray),A.hasIconCollisionBoxData()&&A.iconCollisionBox.collisionVertexBuffer&&A.iconCollisionBox.collisionVertexBuffer.updateData(A.iconCollisionBox.collisionVertexArray),A.hasTextCollisionBoxData()&&A.textCollisionBox.collisionVertexBuffer&&A.textCollisionBox.collisionVertexBuffer.updateData(A.textCollisionBox.collisionVertexArray),A.text.opacityVertexArray.length!==A.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${A.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${A.text.layoutVertexArray.length}) / 4`);if(A.icon.opacityVertexArray.length!==A.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${A.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${A.icon.layoutVertexArray.length}) / 4`);if(A.bucketInstanceId in this.collisionCircleArrays){const j=this.collisionCircleArrays[A.bucketInstanceId];A.placementInvProjMatrix=j.invProjMatrix,A.placementViewportMatrix=j.viewportMatrix,A.collisionCircleArray=j.circles,delete this.collisionCircleArrays[A.bucketInstanceId]}}symbolFadeChange(A){return this.fadeDuration===0?1:(A-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(A){return Math.max(0,(this.transform.zoom-A)/1.5)}hasTransitions(A){return this.stale||A-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(A,I){const F=this.zoomAtLastRecencyCheck===I?1-this.zoomAdjustment(I):1;return this.zoomAtLastRecencyCheck=I,this.commitTime+this.fadeDuration*F>A}setStale(){this.stale=!0}}function ai(Z,A,I,F,O){Z.emplaceBack(A?1:0,I?1:0,F||0,O||0),Z.emplaceBack(A?1:0,I?1:0,F||0,O||0),Z.emplaceBack(A?1:0,I?1:0,F||0,O||0),Z.emplaceBack(A?1:0,I?1:0,F||0,O||0)}const di=Math.pow(2,25),Ai=Math.pow(2,24),Kt=Math.pow(2,17),oi=Math.pow(2,16),Ri=Math.pow(2,9),vi=Math.pow(2,8),wi=Math.pow(2,1);function Yt(Z){if(Z.opacity===0&&!Z.placed)return 0;if(Z.opacity===1&&Z.placed)return 4294967295;const A=Z.placed?1:0,I=Math.floor(127*Z.opacity);return I*di+A*Ai+I*Kt+A*oi+I*Ri+A*vi+I*wi+A}const vn=0;class ar{constructor(A){this._sortAcrossTiles=A.layout.get("symbol-z-order")!=="viewport-y"&&!A.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(A,I,F,O,y){const s=this._bucketParts;for(;this._currentTileIndex<A.length;)if(I.getBucketParts(s,O,A[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((i,r)=>i.sortKey-r.sortKey));this._currentPartIndex<s.length;)if(I.placeLayerBucketPart(s[this._currentPartIndex],this._seenCrossTileIDs,F),this._currentPartIndex++,y())return!0;return!1}}class dn{constructor(A,I,F,O,y,s,i,r){this.placement=new ke(A,I,s,i,r),this._currentPlacementIndex=F.length-1,this._forceFullPlacement=O,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(A,I,F){const O=a.h.now(),y=()=>!this._forceFullPlacement&&a.h.now()-O>2;for(;this._currentPlacementIndex>=0;){const s=I[A[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=i)&&(!s.maxzoom||s.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new ar(s)),this._inProgressLayer.continuePlacement(F[s.source],this.placement,this._showCollisionBoxes,s,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(A){return this.placement.commit(A),this.placement}}const Vn=512/a.N/2;class Hr{constructor(A,I,F){this.tileID=A,this.bucketInstanceId=F,this._symbolsByKey={};const O=new Map;for(let y=0;y<I.length;y++){const s=I.get(y),i=s.key,r=O.get(i);r?r.push(s):O.set(i,[s])}for(const[y,s]of O){const i={positions:s.map(r=>({x:Math.floor(r.anchorX*Vn),y:Math.floor(r.anchorY*Vn)})),crossTileIDs:s.map(r=>r.crossTileID)};if(i.positions.length>128){const r=new a.av(i.positions.length,16,Uint16Array);for(const{x:l,y:d}of i.positions)r.add(l,d);r.finish(),delete i.positions,i.index=r}this._symbolsByKey[y]=i}}getScaledCoordinates(A,I){const{x:F,y:O,z:y}=this.tileID.canonical,{x:s,y:i,z:r}=I.canonical,l=Vn/Math.pow(2,r-y),d=(i*a.N+A.anchorY)*l,_=O*a.N*Vn;return{x:Math.floor((s*a.N+A.anchorX)*l-F*a.N*Vn),y:Math.floor(d-_)}}findMatches(A,I,F){const O=this.tileID.canonical.z<I.canonical.z?1:Math.pow(2,this.tileID.canonical.z-I.canonical.z);for(let y=0;y<A.length;y++){const s=A.get(y);if(s.crossTileID)continue;const i=this._symbolsByKey[s.key];if(!i)continue;const r=this.getScaledCoordinates(s,I);if(i.index){const l=i.index.range(r.x-O,r.y-O,r.x+O,r.y+O).sort();for(const d of l){const _=i.crossTileIDs[d];if(!F[_]){F[_]=!0,s.crossTileID=_;break}}}else if(i.positions)for(let l=0;l<i.positions.length;l++){const d=i.positions[l],_=i.crossTileIDs[l];if(Math.abs(d.x-r.x)<=O&&Math.abs(d.y-r.y)<=O&&!F[_]){F[_]=!0,s.crossTileID=_;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:A})=>A)}}class Hi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class lr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(A){const I=Math.round((A-this.lng)/360);if(I!==0)for(const F in this.indexes){const O=this.indexes[F],y={};for(const s in O){const i=O[s];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+I),y[i.tileID.key]=i}this.indexes[F]=y}this.lng=A}addBucket(A,I,F){if(this.indexes[A.overscaledZ]&&this.indexes[A.overscaledZ][A.key]){if(this.indexes[A.overscaledZ][A.key].bucketInstanceId===I.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(A.overscaledZ,this.indexes[A.overscaledZ][A.key])}for(let y=0;y<I.symbolInstances.length;y++)I.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[A.overscaledZ]||(this.usedCrossTileIDs[A.overscaledZ]={});const O=this.usedCrossTileIDs[A.overscaledZ];for(const y in this.indexes){const s=this.indexes[y];if(Number(y)>A.overscaledZ)for(const i in s){const r=s[i];r.tileID.isChildOf(A)&&r.findMatches(I.symbolInstances,A,O)}else{const i=s[A.scaledTo(Number(y)).key];i&&i.findMatches(I.symbolInstances,A,O)}}for(let y=0;y<I.symbolInstances.length;y++){const s=I.symbolInstances.get(y);s.crossTileID||(s.crossTileID=F.generate(),O[s.crossTileID]=!0)}return this.indexes[A.overscaledZ]===void 0&&(this.indexes[A.overscaledZ]={}),this.indexes[A.overscaledZ][A.key]=new Hr(A,I.symbolInstances,I.bucketInstanceId),!0}removeBucketCrossTileIDs(A,I){for(const F of I.getCrossTileIDsLists())for(const O of F)delete this.usedCrossTileIDs[A][O]}removeStaleBuckets(A){let I=!1;for(const F in this.indexes){const O=this.indexes[F];for(const y in O)A[O[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,O[y]),delete O[y],I=!0)}return I}}class Fn{constructor(){this.layerIndexes={},this.crossTileIDs=new Hi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(A,I,F){let O=this.layerIndexes[A.id];O===void 0&&(O=this.layerIndexes[A.id]=new lr);let y=!1;const s={};O.handleWrapJump(F);for(const i of I){const r=i.getBucket(A);r&&A.id===r.layerIds[0]&&(r.bucketInstanceId||(r.bucketInstanceId=++this.maxBucketInstanceId),O.addBucket(i.tileID,r,this.crossTileIDs)&&(y=!0),s[r.bucketInstanceId]=!0)}return O.removeStaleBuckets(s)&&(y=!0),y}pruneUnusedLayers(A){const I={};A.forEach(F=>{I[F]=!0});for(const F in this.layerIndexes)I[F]||delete this.layerIndexes[F]}}const Qt=(Z,A)=>a.x(Z,A&&A.filter(I=>I.identifier!=="source.canvas")),Yi=a.F(a.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Ut=a.F(a.ax,["setCenter","setZoom","setBearing","setPitch"]),En=a.aw();class ur extends a.E{constructor(A,I={}){super(),this.map=A,this.dispatcher=new bi(V(),this,A._getMapId()),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new at(A._requestManager,I.localIdeographFontFamily),this.lineAtlas=new ci(256,512),this.crossTileSymbolIndex=new Fn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.az());const F=this;this._rtlTextPluginCallback=ur.registerForPluginStateChange(O=>{F.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:O.pluginStatus,pluginURL:O.pluginURL},(y,s)=>{if(a.aA(y),s&&s.every(i=>i))for(const i in F.sourceCaches){const r=F.sourceCaches[i].getSource().type;r!=="vector"&&r!=="geojson"||F.sourceCaches[i].reload()}})}),this.on("data",O=>{if(O.dataType!=="source"||O.sourceDataType!=="metadata")return;const y=this.sourceCaches[O.sourceId];if(!y)return;const s=y.getSource();if(s&&s.vectorLayerIds)for(const i in this._layers){const r=this._layers[i];r.source===s.id&&this._validateLayer(r)}})}loadURL(A,I={},F){this.fire(new a.k("dataloading",{dataType:"style"})),I.validate=typeof I.validate!="boolean"||I.validate;const O=this.map._requestManager.transformRequest(A,st.Style);this._request=a.f(O,(y,s)=>{this._request=null,y?this.fire(new a.j(y)):s&&this._load(s,I,F)})}loadJSON(A,I={},F){this.fire(new a.k("dataloading",{dataType:"style"})),this._request=a.h.frame(()=>{this._request=null,I.validate=I.validate!==!1,this._load(A,I,F)})}loadEmpty(){this.fire(new a.k("dataloading",{dataType:"style"})),this._load(En,{validate:!1})}_load(A,I,F){var O;const y=I.transformStyle?I.transformStyle(F,A):A;if(!I.validate||!Qt(this,a.y(y))){this._loaded=!0,this.stylesheet=y;for(const s in y.sources)this.addSource(s,y.sources[s],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new Dt(this.stylesheet.light),this.map.setTerrain((O=this.stylesheet.terrain)!==null&&O!==void 0?O:null),this.fire(new a.k("data",{dataType:"style"})),this.fire(new a.k("style.load"))}}_createLayers(){const A=a.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",A),this._order=A.map(I=>I.id),this._layers={},this._serializedLayers=null;for(const I of A){const F=a.aC(I);F.setEventedParent(this,{layer:{id:I.id}}),this._layers[I.id]=F}}_loadSprite(A,I=!1,F=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(O,y,s,i){const r=it(O),l=r.length,d=s>1?"@2x":"",_={},w={},T={};for(const{id:B,url:j}of r){const Y=y.transformRequest(y.normalizeSpriteURL(j,d,".json"),st.SpriteJSON),ue=`${B}_${Y.url}`;_[ue]=a.f(Y,(Re,Be)=>{delete _[ue],w[B]=Be,xt(i,w,T,Re,l)});const Se=y.transformRequest(y.normalizeSpriteURL(j,d,".png"),st.SpriteImage),Te=`${B}_${Se.url}`;_[Te]=Ke.getImage(Se,(Re,Be)=>{delete _[Te],T[B]=Be,xt(i,w,T,Re,l)})}return{cancel(){for(const B of Object.values(_))B.cancel()}}}(A,this.map._requestManager,this.map.getPixelRatio(),(O,y)=>{if(this._spriteRequest=null,O)this.fire(new a.j(O));else if(y)for(const s in y){this._spritesImagesIds[s]=[];const i=this._spritesImagesIds[s]?this._spritesImagesIds[s].filter(r=>!(r in y)):[];for(const r of i)this.imageManager.removeImage(r),this._changedImages[r]=!0;for(const r in y[s]){const l=s==="default"?r:`${s}:${r}`;this._spritesImagesIds[s].push(l),l in this.imageManager.images?this.imageManager.updateImage(l,y[s][r],!1):this.imageManager.addImage(l,y[s][r]),I&&(this._changedImages[l]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),I&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"})),F&&F(O)})}_unloadSprite(){for(const A of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(A),this._changedImages[A]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}_validateLayer(A){const I=this.sourceCaches[A.source];if(!I)return;const F=A.sourceLayer;if(!F)return;const O=I.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(F)===-1)&&this.fire(new a.j(new Error(`Source layer "${F}" does not exist on source "${O.id}" as specified by style layer "${A.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const A in this.sourceCaches)if(!this.sourceCaches[A].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(A){const I=this._serializedAllLayers();if(!A||A.length===0)return Object.values(I);const F=[];for(const O of A)I[O]&&F.push(I[O]);return F}_serializedAllLayers(){let A=this._serializedLayers;if(A)return A;A=this._serializedLayers={};const I=Object.keys(this._layers);for(const F of I){const O=this._layers[F];O.type!=="custom"&&(A[F]=O.serialize())}return A}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const A in this.sourceCaches)if(this.sourceCaches[A].hasTransition())return!0;for(const A in this._layers)if(this._layers[A].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(A){if(!this._loaded)return;const I=this._changed;if(this._changed){const O=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(O.length||y.length)&&this._updateWorkerLayers(O,y);for(const s in this._updatedSources){const i=this._updatedSources[s];if(i==="reload")this._reloadSource(s);else{if(i!=="clear")throw new Error(`Invalid action ${i}`);this._clearSource(s)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const s in this._updatedPaintProps)this._layers[s].updateTransitions(A);this.light.updateTransitions(A),this._resetUpdates()}const F={};for(const O in this.sourceCaches){const y=this.sourceCaches[O];F[O]=y.used,y.used=!1}for(const O of this._order){const y=this._layers[O];y.recalculate(A,this._availableImages),!y.isHidden(A.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const O in F){const y=this.sourceCaches[O];F[O]!==y.used&&y.fire(new a.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:O}))}this.light.recalculate(A),this.z=A.zoom,I&&this.fire(new a.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const A=Object.keys(this._changedImages);if(A.length){for(const I in this.sourceCaches)this.sourceCaches[I].reloadTilesForDependencies(["icons","patterns"],A);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(A,I){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(A),removedIds:I})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(A,I={}){this._checkLoaded();const F=this.serialize();if(A=I.transformStyle?I.transformStyle(F,A):A,Qt(this,a.y(A)))return!1;(A=a.aD(A)).layers=a.aB(A.layers);const O=a.aE(F,A).filter(s=>!(s.command in Ut));if(O.length===0)return!1;const y=O.filter(s=>!(s.command in Yi));if(y.length>0)throw new Error(`Unimplemented: ${y.map(s=>s.command).join(", ")}.`);for(const s of O)s.command!=="setTransition"&&this[s.command].apply(this,s.args);return this.stylesheet=A,this._serializedLayers=null,!0}addImage(A,I){if(this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" already exists.`)));this.imageManager.addImage(A,I),this._afterImageUpdated(A)}updateImage(A,I){this.imageManager.updateImage(A,I)}getImage(A){return this.imageManager.getImage(A)}removeImage(A){if(!this.getImage(A))return this.fire(new a.j(new Error(`An image named "${A}" does not exist.`)));this.imageManager.removeImage(A),this._afterImageUpdated(A)}_afterImageUpdated(A){this._availableImages=this.imageManager.listImages(),this._changedImages[A]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(A,I,F={}){if(this._checkLoaded(),this.sourceCaches[A]!==void 0)throw new Error(`Source "${A}" already exists.`);if(!I.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(I).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(I.type)>=0&&this._validate(a.y.source,`sources.${A}`,I,null,F))return;this.map&&this.map._collectResourceTiming&&(I.collectResourceTiming=!0);const O=this.sourceCaches[A]=new ln(A,I,this.dispatcher);O.style=this,O.setEventedParent(this,()=>({isSourceLoaded:O.loaded(),source:O.serialize(),sourceId:A})),O.onAdd(this.map),this._changed=!0}removeSource(A){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error("There is no source with this ID");for(const F in this._layers)if(this._layers[F].source===A)return this.fire(new a.j(new Error(`Source "${A}" cannot be removed while layer "${F}" is using it.`)));const I=this.sourceCaches[A];delete this.sourceCaches[A],delete this._updatedSources[A],I.fire(new a.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:A})),I.setEventedParent(null),I.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(A,I){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error(`There is no source with this ID=${A}`);const F=this.sourceCaches[A].getSource();if(F.type!=="geojson")throw new Error(`geojsonSource.type is ${F.type}, which is !== 'geojson`);F.setData(I),this._changed=!0}getSource(A){return this.sourceCaches[A]&&this.sourceCaches[A].getSource()}addLayer(A,I,F={}){this._checkLoaded();const O=A.id;if(this.getLayer(O))return void this.fire(new a.j(new Error(`Layer "${O}" already exists on this map.`)));let y;if(A.type==="custom"){if(Qt(this,a.aF(A)))return;y=a.aC(A)}else{if("source"in A&&typeof A.source=="object"&&(this.addSource(O,A.source),A=a.aD(A),A=a.e(A,{source:O})),this._validate(a.y.layer,`layers.${O}`,A,{arrayIndex:-1},F))return;y=a.aC(A),this._validateLayer(y),y.setEventedParent(this,{layer:{id:O}})}const s=I?this._order.indexOf(I):this._order.length;if(I&&s===-1)this.fire(new a.j(new Error(`Cannot add layer "${O}" before non-existing layer "${I}".`)));else{if(this._order.splice(s,0,O),this._layerOrderChanged=!0,this._layers[O]=y,this._removedLayers[O]&&y.source&&y.type!=="custom"){const i=this._removedLayers[O];delete this._removedLayers[O],i.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(A,I){if(this._checkLoaded(),this._changed=!0,!this._layers[A])return void this.fire(new a.j(new Error(`The layer '${A}' does not exist in the map's style and cannot be moved.`)));if(A===I)return;const F=this._order.indexOf(A);this._order.splice(F,1);const O=I?this._order.indexOf(I):this._order.length;I&&O===-1?this.fire(new a.j(new Error(`Cannot move layer "${A}" before non-existing layer "${I}".`))):(this._order.splice(O,0,A),this._layerOrderChanged=!0)}removeLayer(A){this._checkLoaded();const I=this._layers[A];if(!I)return void this.fire(new a.j(new Error(`Cannot remove non-existing layer "${A}".`)));I.setEventedParent(null);const F=this._order.indexOf(A);this._order.splice(F,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[A]=I,delete this._layers[A],this._serializedLayers&&delete this._serializedLayers[A],delete this._updatedLayers[A],delete this._updatedPaintProps[A],I.onRemove&&I.onRemove(this.map)}getLayer(A){return this._layers[A]}getLayersOrder(){return[...this._order]}hasLayer(A){return A in this._layers}setLayerZoomRange(A,I,F){this._checkLoaded();const O=this.getLayer(A);O?O.minzoom===I&&O.maxzoom===F||(I!=null&&(O.minzoom=I),F!=null&&(O.maxzoom=F),this._updateLayer(O)):this.fire(new a.j(new Error(`Cannot set the zoom range of non-existing layer "${A}".`)))}setFilter(A,I,F={}){this._checkLoaded();const O=this.getLayer(A);if(O){if(!a.aG(O.filter,I))return I==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(a.y.filter,`layers.${O.id}.filter`,I,null,F)||(O.filter=a.aD(I),this._updateLayer(O)))}else this.fire(new a.j(new Error(`Cannot filter non-existing layer "${A}".`)))}getFilter(A){return a.aD(this.getLayer(A).filter)}setLayoutProperty(A,I,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getLayoutProperty(I),F)||(y.setLayoutProperty(I,F,O),this._updateLayer(y)):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getLayoutProperty(A,I){const F=this.getLayer(A);if(F)return F.getLayoutProperty(I);this.fire(new a.j(new Error(`Cannot get style of non-existing layer "${A}".`)))}setPaintProperty(A,I,F,O={}){this._checkLoaded();const y=this.getLayer(A);y?a.aG(y.getPaintProperty(I),F)||(y.setPaintProperty(I,F,O)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[A]=!0):this.fire(new a.j(new Error(`Cannot style non-existing layer "${A}".`)))}getPaintProperty(A,I){return this.getLayer(A).getPaintProperty(I)}setFeatureState(A,I){this._checkLoaded();const F=A.source,O=A.sourceLayer,y=this.sourceCaches[F];if(y===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const s=y.getSource().type;s==="geojson"&&O?this.fire(new a.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):s!=="vector"||O?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(O,A.id,I)):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(A,I){this._checkLoaded();const F=A.source,O=this.sourceCaches[F];if(O===void 0)return void this.fire(new a.j(new Error(`The source '${F}' does not exist in the map's style.`)));const y=O.getSource().type,s=y==="vector"?A.sourceLayer:void 0;y!=="vector"||s?I&&typeof A.id!="string"&&typeof A.id!="number"?this.fire(new a.j(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(s,A.id,I):this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(A){this._checkLoaded();const I=A.source,F=A.sourceLayer,O=this.sourceCaches[I];if(O!==void 0)return O.getSource().type!=="vector"||F?(A.id===void 0&&this.fire(new a.j(new Error("The feature id parameter must be provided."))),O.getFeatureState(F,A.id)):void this.fire(new a.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.j(new Error(`The source '${I}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const A=a.aH(this.sourceCaches,y=>y.serialize()),I=this._serializeByIds(this._order),F=this.map.getTerrain()||void 0,O=this.stylesheet;return a.aI({version:O.version,name:O.name,metadata:O.metadata,light:O.light,center:O.center,zoom:O.zoom,bearing:O.bearing,pitch:O.pitch,sprite:O.sprite,glyphs:O.glyphs,transition:O.transition,sources:A,layers:I,terrain:F},y=>y!==void 0)}_updateLayer(A){this._updatedLayers[A.id]=!0,A.source&&!this._updatedSources[A.source]&&this.sourceCaches[A.source].getSource().type!=="raster"&&(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(A){const I=s=>this._layers[s].type==="fill-extrusion",F={},O=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(I(i)){F[i]=s;for(const r of A){const l=r[i];if(l)for(const d of l)O.push(d)}}}O.sort((s,i)=>i.intersectionZ-s.intersectionZ);const y=[];for(let s=this._order.length-1;s>=0;s--){const i=this._order[s];if(I(i))for(let r=O.length-1;r>=0;r--){const l=O[r].feature;if(F[l.layer.id]<s)break;y.push(l),O.pop()}else for(const r of A){const l=r[i];if(l)for(const d of l)y.push(d.feature)}}return y}queryRenderedFeatures(A,I,F){I&&I.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",I.filter,null,I);const O={};if(I&&I.layers){if(!Array.isArray(I.layers))return this.fire(new a.j(new Error("parameters.layers must be an Array."))),[];for(const i of I.layers){const r=this._layers[i];if(!r)return this.fire(new a.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be queried for features.`))),[];O[r.source]=!0}}const y=[];I.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const i in this.sourceCaches)I.layers&&!O[i]||y.push(mn(this.sourceCaches[i],this._layers,s,A,I,F));return this.placement&&y.push(function(i,r,l,d,_,w,T){const B={},j=w.queryRenderedSymbols(d),Y=[];for(const ue of Object.keys(j).map(Number))Y.push(T[ue]);Y.sort(ti);for(const ue of Y){const Se=ue.featureIndex.lookupSymbolFeatures(j[ue.bucketInstanceId],r,ue.bucketIndex,ue.sourceLayerIndex,_.filter,_.layers,_.availableImages,i);for(const Te in Se){const Re=B[Te]=B[Te]||[],Be=Se[Te];Be.sort(($e,vt)=>{const ot=ue.featureSortOrder;if(ot){const ct=ot.indexOf($e.featureIndex);return ot.indexOf(vt.featureIndex)-ct}return vt.featureIndex-$e.featureIndex});for(const $e of Be)Re.push($e)}}for(const ue in B)B[ue].forEach(Se=>{const Te=Se.feature,Re=l[i[ue].source].getFeatureState(Te.layer["source-layer"],Te.id);Te.source=Te.layer.source,Te.layer["source-layer"]&&(Te.sourceLayer=Te.layer["source-layer"]),Te.state=Re});return B}(this._layers,s,this.sourceCaches,A,I,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(A,I){I&&I.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",I.filter,null,I);const F=this.sourceCaches[A];return F?function(O,y){const s=O.getRenderableIds().map(l=>O.getTileByID(l)),i=[],r={};for(let l=0;l<s.length;l++){const d=s[l],_=d.tileID.canonical.key;r[_]||(r[_]=!0,d.querySourceFeatures(i,y))}return i}(F,I):[]}addSourceType(A,I,F){return _n(A)?F(new Error(`A source type called "${A}" already exists.`)):(((O,y)=>{fn[O]=y})(A,I),I.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:A,url:I.workerSourceURL},F):F(null,null))}getLight(){return this.light.getLight()}setLight(A,I={}){this._checkLoaded();const F=this.light.getLight();let O=!1;for(const s in A)if(!a.aG(A[s],F[s])){O=!0;break}if(!O)return;const y={now:a.h.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(A,I),this.light.updateTransitions(y)}_validate(A,I,F,O,y={}){return(!y||y.validate!==!1)&&Qt(this,A.call(a.y,a.e({key:I,style:this.serialize(),value:F,styleSpec:a.v},O)))}_remove(A=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const I in this._layers)this._layers[I].setEventedParent(null);for(const I in this.sourceCaches){const F=this.sourceCaches[I];F.setEventedParent(null),F.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(A)}_clearSource(A){this.sourceCaches[A].clearTiles()}_reloadSource(A){this.sourceCaches[A].resume(),this.sourceCaches[A].reload()}_updateSources(A){for(const I in this.sourceCaches)this.sourceCaches[I].update(A,this.map.terrain)}_generateCollisionBoxes(){for(const A in this.sourceCaches)this._reloadSource(A)}_updatePlacement(A,I,F,O,y=!1){let s=!1,i=!1;const r={};for(const l of this._order){const d=this._layers[l];if(d.type!=="symbol")continue;if(!r[d.source]){const w=this.sourceCaches[d.source];r[d.source]=w.getRenderableIds(!0).map(T=>w.getTileByID(T)).sort((T,B)=>B.tileID.overscaledZ-T.tileID.overscaledZ||(T.tileID.isLessThan(B.tileID)?-1:1))}const _=this.crossTileSymbolIndex.addLayer(d,r[d.source],A.center.lng);s=s||_}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||F===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.h.now(),A.zoom))&&(this.pauseablePlacement=new dn(A,this.map.terrain,this._order,y,I,F,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,r),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.h.now()),i=!0),s&&this.pauseablePlacement.placement.setStale()),i||s)for(const l of this._order){const d=this._layers[l];d.type==="symbol"&&this.placement.updateLayerOpacities(d,r[d.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.h.now())}_releaseSymbolFadeTiles(){for(const A in this.sourceCaches)this.sourceCaches[A].releaseSymbolFadeTiles()}getImages(A,I,F){this.imageManager.getImages(I.icons,F),this._updateTilesForChangedImages();const O=this.sourceCaches[I.source];O&&O.setDependencies(I.tileID.key,I.type,I.icons)}getGlyphs(A,I,F){this.glyphManager.getGlyphs(I.stacks,F);const O=this.sourceCaches[I.source];O&&O.setDependencies(I.tileID.key,I.type,[""])}getResource(A,I,F){return a.m(I,F)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(A,I={}){this._checkLoaded(),A&&this._validate(a.y.glyphs,"glyphs",A,null,I)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=A,this.glyphManager.entries={},this.glyphManager.setURL(A))}addSprite(A,I,F={},O){this._checkLoaded();const y=[{id:A,url:I}],s=[...it(this.stylesheet.sprite),...y];this._validate(a.y.sprite,"sprite",s,null,F)||(this.stylesheet.sprite=s,this._loadSprite(y,!0,O))}removeSprite(A){this._checkLoaded();const I=it(this.stylesheet.sprite);if(I.find(F=>F.id===A)){if(this._spritesImagesIds[A])for(const F of this._spritesImagesIds[A])this.imageManager.removeImage(F),this._changedImages[F]=!0;I.splice(I.findIndex(F=>F.id===A),1),this.stylesheet.sprite=I.length>0?I:void 0,delete this._spritesImagesIds[A],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.k("data",{dataType:"style"}))}else this.fire(new a.j(new Error(`Sprite "${A}" doesn't exists on this map.`)))}getSprite(){return it(this.stylesheet.sprite)}setSprite(A,I={},F){this._checkLoaded(),A&&this._validate(a.y.sprite,"sprite",A,null,I)||(this.stylesheet.sprite=A,A?this._loadSprite(A,!0,F):(this._unloadSprite(),F&&F(null)))}}ur.registerForPluginStateChange=a.aK;var Ns=a.Q([{name:"a_pos",type:"Int16",components:2}]),Vr="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Vt={prelude:cr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:cr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:cr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:cr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:cr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:cr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:cr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:cr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:cr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:cr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:cr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:cr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:cr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:cr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:cr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:cr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:cr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:cr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:cr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:cr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:cr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:cr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:cr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:cr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:cr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Vr),terrainDepth:cr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Vr),terrainCoords:cr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Vr)};function cr(Z,A){const I=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,F=A.match(/attribute ([\w]+) ([\w]+)/g),O=Z.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=A.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=y?y.concat(O):O,i={};return{fragmentSource:Z=Z.replace(I,(r,l,d,_,w)=>(i[w]=!0,l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:`
#ifdef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = u_${w};
#endif
`)),vertexSource:A=A.replace(I,(r,l,d,_,w)=>{const T=_==="float"?"vec2":"vec4",B=w.match(/color/)?"color":T;return i[w]?l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
varying ${d} ${_} ${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:l==="define"?`
#ifndef HAS_UNIFORM_u_${w}
uniform lowp float u_${w}_t;
attribute ${d} ${T} a_${w};
#else
uniform ${d} ${_} u_${w};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = a_${w};
#else
    ${d} ${_} ${w} = u_${w};
#endif
`:`
#ifndef HAS_UNIFORM_u_${w}
    ${d} ${_} ${w} = unpack_mix_${B}(a_${w}, u_${w}_t);
#else
    ${d} ${_} ${w} = u_${w};
#endif
`}),staticAttributes:F,staticUniforms:s}}class Lt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(A,I,F,O,y,s,i,r,l){this.context=A;let d=this.boundPaintVertexBuffers.length!==O.length;for(let _=0;!d&&_<O.length;_++)this.boundPaintVertexBuffers[_]!==O[_]&&(d=!0);!this.vao||this.boundProgram!==I||this.boundLayoutVertexBuffer!==F||d||this.boundIndexBuffer!==y||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==i||this.boundDynamicVertexBuffer2!==r||this.boundDynamicVertexBuffer3!==l?this.freshBind(I,F,O,y,s,i,r,l):(A.bindVertexArray.set(this.vao),i&&i.bind(),y&&y.dynamicDraw&&y.bind(),r&&r.bind(),l&&l.bind())}freshBind(A,I,F,O,y,s,i,r){const l=A.numAttributes,d=this.context,_=d.gl;this.vao&&this.destroy(),this.vao=d.createVertexArray(),d.bindVertexArray.set(this.vao),this.boundProgram=A,this.boundLayoutVertexBuffer=I,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=O,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=i,this.boundDynamicVertexBuffer3=r,I.enableAttributes(_,A);for(const w of F)w.enableAttributes(_,A);s&&s.enableAttributes(_,A),i&&i.enableAttributes(_,A),r&&r.enableAttributes(_,A),I.bind(),I.setVertexAttribPointers(_,A,y);for(const w of F)w.bind(),w.setVertexAttribPointers(_,A,y);s&&(s.bind(),s.setVertexAttribPointers(_,A,y)),O&&O.bind(),i&&(i.bind(),i.setVertexAttribPointers(_,A,y)),r&&(r.bind(),r.setVertexAttribPointers(_,A,y)),d.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Br(Z){const A=[];for(let I=0;I<Z.length;I++){if(Z[I]===null)continue;const F=Z[I].split(" ");A.push(F.pop())}return A}class Vs{constructor(A,I,F,O,y,s){const i=A.gl;this.program=i.createProgram();const r=Br(I.staticAttributes),l=F?F.getBinderAttributes():[],d=r.concat(l),_=Vt.prelude.staticUniforms?Br(Vt.prelude.staticUniforms):[],w=I.staticUniforms?Br(I.staticUniforms):[],T=F?F.getBinderUniforms():[],B=_.concat(w).concat(T),j=[];for(const $e of B)j.indexOf($e)<0&&j.push($e);const Y=F?F.defines():[];y&&Y.push("#define OVERDRAW_INSPECTOR;"),s&&Y.push("#define TERRAIN3D;");const ue=Y.concat(Vt.prelude.fragmentSource,I.fragmentSource).join(`
`),Se=Y.concat(Vt.prelude.vertexSource,I.vertexSource).join(`
`),Te=i.createShader(i.FRAGMENT_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Te,ue),i.compileShader(Te),!i.getShaderParameter(Te,i.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${i.getShaderInfoLog(Te)}`);i.attachShader(this.program,Te);const Re=i.createShader(i.VERTEX_SHADER);if(i.isContextLost())return void(this.failedToCreate=!0);if(i.shaderSource(Re,Se),i.compileShader(Re),!i.getShaderParameter(Re,i.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${i.getShaderInfoLog(Re)}`);i.attachShader(this.program,Re),this.attributes={};const Be={};this.numAttributes=d.length;for(let $e=0;$e<this.numAttributes;$e++)d[$e]&&(i.bindAttribLocation(this.program,$e,d[$e]),this.attributes[d[$e]]=$e);if(i.linkProgram(this.program),!i.getProgramParameter(this.program,i.LINK_STATUS))throw new Error(`Program failed to link: ${i.getProgramInfoLog(this.program)}`);i.deleteShader(Re),i.deleteShader(Te);for(let $e=0;$e<j.length;$e++){const vt=j[$e];if(vt&&!Be[vt]){const ot=i.getUniformLocation(this.program,vt);ot&&(Be[vt]=ot)}}this.fixedUniforms=O(A,Be),this.terrainUniforms=(($e,vt)=>({u_depth:new a.aL($e,vt.u_depth),u_terrain:new a.aL($e,vt.u_terrain),u_terrain_dim:new a.aM($e,vt.u_terrain_dim),u_terrain_matrix:new a.aN($e,vt.u_terrain_matrix),u_terrain_unpack:new a.aO($e,vt.u_terrain_unpack),u_terrain_exaggeration:new a.aM($e,vt.u_terrain_exaggeration)}))(A,Be),this.binderUniforms=F?F.getUniforms(A,Be):[]}draw(A,I,F,O,y,s,i,r,l,d,_,w,T,B,j,Y,ue,Se){const Te=A.gl;if(this.failedToCreate)return;if(A.program.set(this.program),A.setDepthMode(F),A.setStencilMode(O),A.setColorMode(y),A.setCullFace(s),r){A.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,r.depthTexture),A.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,r.texture);for(const Be in this.terrainUniforms)this.terrainUniforms[Be].set(r[Be])}for(const Be in this.fixedUniforms)this.fixedUniforms[Be].set(i[Be]);j&&j.setUniforms(A,this.binderUniforms,T,{zoom:B});let Re=0;switch(I){case Te.LINES:Re=2;break;case Te.TRIANGLES:Re=3;break;case Te.LINE_STRIP:Re=1}for(const Be of w.get()){const $e=Be.vaos||(Be.vaos={});($e[l]||($e[l]=new Lt)).bind(A,this,d,j?j.getPaintVertexBuffers():[],_,Be.vertexOffset,Y,ue,Se),Te.drawElements(I,Be.primitiveLength*Re,Te.UNSIGNED_SHORT,Be.primitiveOffset*Re*2)}}}function ua(Z,A,I){const F=1/Fe(I,1,A.transform.tileZoom),O=Math.pow(2,I.tileID.overscaledZ),y=I.tileSize*Math.pow(2,A.transform.tileZoom)/O,s=y*(I.tileID.canonical.x+I.tileID.wrap*O),i=y*I.tileID.canonical.y;return{u_image:0,u_texsize:I.imageAtlasTexture.size,u_scale:[F,Z.fromScale,Z.toScale],u_fade:Z.t,u_pixel_coord_upper:[s>>16,i>>16],u_pixel_coord_lower:[65535&s,65535&i]}}const kr=(Z,A,I,F)=>{const O=A.style.light,y=O.properties.get("position"),s=[y.x,y.y,y.z],i=function(){var l=new a.A(9);return a.A!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}();O.properties.get("anchor")==="viewport"&&function(l,d){var _=Math.sin(d),w=Math.cos(d);l[0]=w,l[1]=_,l[2]=0,l[3]=-_,l[4]=w,l[5]=0,l[6]=0,l[7]=0,l[8]=1}(i,-A.transform.angle),function(l,d,_){var w=d[0],T=d[1],B=d[2];l[0]=w*_[0]+T*_[3]+B*_[6],l[1]=w*_[1]+T*_[4]+B*_[7],l[2]=w*_[2]+T*_[5]+B*_[8]}(s,s,i);const r=O.properties.get("color");return{u_matrix:Z,u_lightpos:s,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[r.r,r.g,r.b],u_vertical_gradient:+I,u_opacity:F}},Fa=(Z,A,I,F,O,y,s)=>a.e(kr(Z,A,I,F),ua(y,A,s),{u_height_factor:-Math.pow(2,O.overscaledZ)/s.tileSize/8}),zo=Z=>({u_matrix:Z}),Oa=(Z,A,I,F)=>a.e(zo(Z),ua(I,A,F)),Xs=(Z,A)=>({u_matrix:Z,u_world:A}),jn=(Z,A,I,F,O)=>a.e(Oa(Z,A,I,F),{u_world:O}),aa=(Z,A,I,F)=>{const O=Z.transform;let y,s;if(F.paint.get("circle-pitch-alignment")==="map"){const i=Fe(I,1,O.zoom);y=!0,s=[i,i]}else y=!1,s=O.pixelsToGLUnits;return{u_camera_to_center_distance:O.cameraToCenterDistance,u_scale_with_map:+(F.paint.get("circle-pitch-scale")==="map"),u_matrix:Z.translatePosMatrix(A.posMatrix,I,F.paint.get("circle-translate"),F.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:Z.pixelRatio,u_extrude_scale:s}},ls=(Z,A,I)=>{const F=Fe(I,1,A.zoom),O=Math.pow(2,A.zoom-I.tileID.overscaledZ),y=I.tileID.overscaleFactor();return{u_matrix:Z,u_camera_to_center_distance:A.cameraToCenterDistance,u_pixels_to_tile_units:F,u_extrude_scale:[A.pixelsToGLUnits[0]/(F*O),A.pixelsToGLUnits[1]/(F*O)],u_overscale_factor:y}},Na=(Z,A,I=1)=>({u_matrix:Z,u_color:A,u_overlay:0,u_overlay_scale:I}),rl=Z=>({u_matrix:Z}),sl=(Z,A,I,F)=>({u_matrix:Z,u_extrude_scale:Fe(A,1,I),u_intensity:F});function Ja(Z,A){const I=Math.pow(2,A.canonical.z),F=A.canonical.y;return[new a.U(0,F/I).toLngLat().lat,new a.U(0,(F+1)/I).toLngLat().lat]}const Va=(Z,A,I,F)=>{const O=Z.transform;return{u_matrix:Wt(Z,A,I,F),u_ratio:1/Fe(A,1,O.zoom),u_device_pixel_ratio:Z.pixelRatio,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},N=(Z,A,I,F,O)=>a.e(Va(Z,A,I,O),{u_image:0,u_image_height:F}),xe=(Z,A,I,F,O)=>{const y=Z.transform,s=It(A,y);return{u_matrix:Wt(Z,A,I,O),u_texsize:A.imageAtlasTexture.size,u_ratio:1/Fe(A,1,y.zoom),u_device_pixel_ratio:Z.pixelRatio,u_image:0,u_scale:[s,F.fromScale,F.toScale],u_fade:F.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},tt=(Z,A,I,F,O,y)=>{const s=Z.lineAtlas,i=It(A,Z.transform),r=I.layout.get("line-cap")==="round",l=s.getDash(F.from,r),d=s.getDash(F.to,r),_=l.width*O.fromScale,w=d.width*O.toScale;return a.e(Va(Z,A,I,y),{u_patternscale_a:[i/_,-l.height/2],u_patternscale_b:[i/w,-d.height/2],u_sdfgamma:s.width/(256*Math.min(_,w)*Z.pixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:d.y,u_mix:O.t})};function It(Z,A){return 1/Fe(Z,1,A.tileZoom)}function Wt(Z,A,I,F){return Z.translatePosMatrix(F?F.posMatrix:A.tileID.posMatrix,A,I.paint.get("line-translate"),I.paint.get("line-translate-anchor"))}const Si=(Z,A,I,F,O)=>{return{u_matrix:Z,u_tl_parent:A,u_scale_parent:I,u_buffer_scale:1,u_fade_t:F.mix,u_opacity:F.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(s=O.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(y=O.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Bi(O.paint.get("raster-hue-rotate"))};var y,s};function Bi(Z){Z*=Math.PI/180;const A=Math.sin(Z),I=Math.cos(Z);return[(2*I+1)/3,(-Math.sqrt(3)*A-I+1)/3,(Math.sqrt(3)*A-I+1)/3]}const un=(Z,A,I,F,O,y,s,i,r,l)=>{const d=O.transform;return{u_is_size_zoom_constant:+(Z==="constant"||Z==="source"),u_is_size_feature_constant:+(Z==="constant"||Z==="camera"),u_size_t:A?A.uSizeT:0,u_size:A?A.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+I,u_aspect_ratio:d.width/d.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:s,u_coord_matrix:i,u_is_text:+r,u_pitch_with_map:+F,u_texsize:l,u_texture:0}},An=(Z,A,I,F,O,y,s,i,r,l,d)=>{const _=O.transform;return a.e(un(Z,A,I,F,O,y,s,i,r,l),{u_gamma_scale:F?Math.cos(_._pitch)*_.cameraToCenterDistance:1,u_device_pixel_ratio:O.pixelRatio,u_is_halo:+d})},rr=(Z,A,I,F,O,y,s,i,r,l)=>a.e(An(Z,A,I,F,O,y,s,i,!0,r,!0),{u_texsize_icon:l,u_texture_icon:1}),hr=(Z,A,I)=>({u_matrix:Z,u_opacity:A,u_color:I}),zr=(Z,A,I,F,O,y)=>a.e(function(s,i,r,l){const d=r.imageManager.getPattern(s.from.toString()),_=r.imageManager.getPattern(s.to.toString()),{width:w,height:T}=r.imageManager.getPixelSize(),B=Math.pow(2,l.tileID.overscaledZ),j=l.tileSize*Math.pow(2,r.transform.tileZoom)/B,Y=j*(l.tileID.canonical.x+l.tileID.wrap*B),ue=j*l.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:d.tl,u_pattern_br_a:d.br,u_pattern_tl_b:_.tl,u_pattern_br_b:_.br,u_texsize:[w,T],u_mix:i.t,u_pattern_size_a:d.displaySize,u_pattern_size_b:_.displaySize,u_scale_a:i.fromScale,u_scale_b:i.toScale,u_tile_units_to_pixels:1/Fe(l,1,r.transform.tileZoom),u_pixel_coord_upper:[Y>>16,ue>>16],u_pixel_coord_lower:[65535&Y,65535&ue]}}(F,y,I,O),{u_matrix:Z,u_opacity:A}),Ua={fillExtrusion:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_opacity:new a.aM(Z,A.u_opacity)}),fillExtrusionPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_lightpos:new a.aP(Z,A.u_lightpos),u_lightintensity:new a.aM(Z,A.u_lightintensity),u_lightcolor:new a.aP(Z,A.u_lightcolor),u_vertical_gradient:new a.aM(Z,A.u_vertical_gradient),u_height_factor:new a.aM(Z,A.u_height_factor),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade),u_opacity:new a.aM(Z,A.u_opacity)}),fill:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),fillPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),fillOutline:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world)}),fillOutlinePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_texsize:new a.aQ(Z,A.u_texsize),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),circle:(Z,A)=>({u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_scale_with_map:new a.aL(Z,A.u_scale_with_map),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_matrix:new a.aN(Z,A.u_matrix)}),collisionBox:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pixels_to_tile_units:new a.aM(Z,A.u_pixels_to_tile_units),u_extrude_scale:new a.aQ(Z,A.u_extrude_scale),u_overscale_factor:new a.aM(Z,A.u_overscale_factor)}),collisionCircle:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_inv_matrix:new a.aN(Z,A.u_inv_matrix),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_viewport_size:new a.aQ(Z,A.u_viewport_size)}),debug:(Z,A)=>({u_color:new a.aR(Z,A.u_color),u_matrix:new a.aN(Z,A.u_matrix),u_overlay:new a.aL(Z,A.u_overlay),u_overlay_scale:new a.aM(Z,A.u_overlay_scale)}),clippingMask:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix)}),heatmap:(Z,A)=>({u_extrude_scale:new a.aM(Z,A.u_extrude_scale),u_intensity:new a.aM(Z,A.u_intensity),u_matrix:new a.aN(Z,A.u_matrix)}),heatmapTexture:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_world:new a.aQ(Z,A.u_world),u_image:new a.aL(Z,A.u_image),u_color_ramp:new a.aL(Z,A.u_color_ramp),u_opacity:new a.aM(Z,A.u_opacity)}),hillshade:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_latrange:new a.aQ(Z,A.u_latrange),u_light:new a.aQ(Z,A.u_light),u_shadow:new a.aR(Z,A.u_shadow),u_highlight:new a.aR(Z,A.u_highlight),u_accent:new a.aR(Z,A.u_accent)}),hillshadePrepare:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_image:new a.aL(Z,A.u_image),u_dimension:new a.aQ(Z,A.u_dimension),u_zoom:new a.aM(Z,A.u_zoom),u_unpack:new a.aO(Z,A.u_unpack)}),line:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels)}),lineGradient:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_image:new a.aL(Z,A.u_image),u_image_height:new a.aM(Z,A.u_image_height)}),linePattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texsize:new a.aQ(Z,A.u_texsize),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_image:new a.aL(Z,A.u_image),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_scale:new a.aP(Z,A.u_scale),u_fade:new a.aM(Z,A.u_fade)}),lineSDF:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ratio:new a.aM(Z,A.u_ratio),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_units_to_pixels:new a.aQ(Z,A.u_units_to_pixels),u_patternscale_a:new a.aQ(Z,A.u_patternscale_a),u_patternscale_b:new a.aQ(Z,A.u_patternscale_b),u_sdfgamma:new a.aM(Z,A.u_sdfgamma),u_image:new a.aL(Z,A.u_image),u_tex_y_a:new a.aM(Z,A.u_tex_y_a),u_tex_y_b:new a.aM(Z,A.u_tex_y_b),u_mix:new a.aM(Z,A.u_mix)}),raster:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_tl_parent:new a.aQ(Z,A.u_tl_parent),u_scale_parent:new a.aM(Z,A.u_scale_parent),u_buffer_scale:new a.aM(Z,A.u_buffer_scale),u_fade_t:new a.aM(Z,A.u_fade_t),u_opacity:new a.aM(Z,A.u_opacity),u_image0:new a.aL(Z,A.u_image0),u_image1:new a.aL(Z,A.u_image1),u_brightness_low:new a.aM(Z,A.u_brightness_low),u_brightness_high:new a.aM(Z,A.u_brightness_high),u_saturation_factor:new a.aM(Z,A.u_saturation_factor),u_contrast_factor:new a.aM(Z,A.u_contrast_factor),u_spin_weights:new a.aP(Z,A.u_spin_weights)}),symbolIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture)}),symbolSDF:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texture:new a.aL(Z,A.u_texture),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),symbolTextAndIcon:(Z,A)=>({u_is_size_zoom_constant:new a.aL(Z,A.u_is_size_zoom_constant),u_is_size_feature_constant:new a.aL(Z,A.u_is_size_feature_constant),u_size_t:new a.aM(Z,A.u_size_t),u_size:new a.aM(Z,A.u_size),u_camera_to_center_distance:new a.aM(Z,A.u_camera_to_center_distance),u_pitch:new a.aM(Z,A.u_pitch),u_rotate_symbol:new a.aL(Z,A.u_rotate_symbol),u_aspect_ratio:new a.aM(Z,A.u_aspect_ratio),u_fade_change:new a.aM(Z,A.u_fade_change),u_matrix:new a.aN(Z,A.u_matrix),u_label_plane_matrix:new a.aN(Z,A.u_label_plane_matrix),u_coord_matrix:new a.aN(Z,A.u_coord_matrix),u_is_text:new a.aL(Z,A.u_is_text),u_pitch_with_map:new a.aL(Z,A.u_pitch_with_map),u_texsize:new a.aQ(Z,A.u_texsize),u_texsize_icon:new a.aQ(Z,A.u_texsize_icon),u_texture:new a.aL(Z,A.u_texture),u_texture_icon:new a.aL(Z,A.u_texture_icon),u_gamma_scale:new a.aM(Z,A.u_gamma_scale),u_device_pixel_ratio:new a.aM(Z,A.u_device_pixel_ratio),u_is_halo:new a.aL(Z,A.u_is_halo)}),background:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_color:new a.aR(Z,A.u_color)}),backgroundPattern:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_opacity:new a.aM(Z,A.u_opacity),u_image:new a.aL(Z,A.u_image),u_pattern_tl_a:new a.aQ(Z,A.u_pattern_tl_a),u_pattern_br_a:new a.aQ(Z,A.u_pattern_br_a),u_pattern_tl_b:new a.aQ(Z,A.u_pattern_tl_b),u_pattern_br_b:new a.aQ(Z,A.u_pattern_br_b),u_texsize:new a.aQ(Z,A.u_texsize),u_mix:new a.aM(Z,A.u_mix),u_pattern_size_a:new a.aQ(Z,A.u_pattern_size_a),u_pattern_size_b:new a.aQ(Z,A.u_pattern_size_b),u_scale_a:new a.aM(Z,A.u_scale_a),u_scale_b:new a.aM(Z,A.u_scale_b),u_pixel_coord_upper:new a.aQ(Z,A.u_pixel_coord_upper),u_pixel_coord_lower:new a.aQ(Z,A.u_pixel_coord_lower),u_tile_units_to_pixels:new a.aM(Z,A.u_tile_units_to_pixels)}),terrain:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainDepth:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_ele_delta:new a.aM(Z,A.u_ele_delta)}),terrainCoords:(Z,A)=>({u_matrix:new a.aN(Z,A.u_matrix),u_texture:new a.aL(Z,A.u_texture),u_terrain_coords_id:new a.aM(Z,A.u_terrain_coords_id),u_ele_delta:new a.aM(Z,A.u_ele_delta)})};class Ga{constructor(A,I,F){this.context=A;const O=A.gl;this.buffer=O.createBuffer(),this.dynamicDraw=!!F,this.context.unbindVAO(),A.bindElementBuffer.set(this.buffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,I.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete I.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(A){const I=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),I.bufferSubData(I.ELEMENT_ARRAY_BUFFER,0,A.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pl{constructor(A,I,F,O){this.length=I.length,this.attributes=F,this.itemSize=I.bytesPerElement,this.dynamicDraw=O,this.context=A;const y=A.gl;this.buffer=y.createBuffer(),A.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,I.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete I.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(A){if(A.length!==this.length)throw new Error(`Length of new data is ${A.length}, which doesn't match current length of ${this.length}`);const I=this.context.gl;this.bind(),I.bufferSubData(I.ARRAY_BUFFER,0,A.arrayBuffer)}enableAttributes(A,I){for(let F=0;F<this.attributes.length;F++){const O=I.attributes[this.attributes[F].name];O!==void 0&&A.enableVertexAttribArray(O)}}setVertexAttribPointers(A,I,F){for(let O=0;O<this.attributes.length;O++){const y=this.attributes[O],s=I.attributes[y.name];s!==void 0&&A.vertexAttribPointer(s,y.components,A[qa[y.type]],!1,this.itemSize,y.offset+this.itemSize*(F||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ur=new WeakMap;function ir(Z){var A;if(Ur.has(Z))return Ur.get(Z);{const I=(A=Z.getParameter(Z.VERSION))===null||A===void 0?void 0:A.startsWith("WebGL 2.0");return Ur.set(Z,I),I}}class wr{constructor(A){this.gl=A.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(A){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Mr extends wr{getDefault(){return a.aT.transparent}set(A){const I=this.current;(A.r!==I.r||A.g!==I.g||A.b!==I.b||A.a!==I.a||this.dirty)&&(this.gl.clearColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class js extends wr{getDefault(){return 1}set(A){(A!==this.current||this.dirty)&&(this.gl.clearDepth(A),this.current=A,this.dirty=!1)}}class vr extends wr{getDefault(){return 0}set(A){(A!==this.current||this.dirty)&&(this.gl.clearStencil(A),this.current=A,this.dirty=!1)}}class Ks extends wr{getDefault(){return[!0,!0,!0,!0]}set(A){const I=this.current;(A[0]!==I[0]||A[1]!==I[1]||A[2]!==I[2]||A[3]!==I[3]||this.dirty)&&(this.gl.colorMask(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class Pr extends wr{getDefault(){return!0}set(A){(A!==this.current||this.dirty)&&(this.gl.depthMask(A),this.current=A,this.dirty=!1)}}class bo extends wr{getDefault(){return 255}set(A){(A!==this.current||this.dirty)&&(this.gl.stencilMask(A),this.current=A,this.dirty=!1)}}class Ho extends wr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(A){const I=this.current;(A.func!==I.func||A.ref!==I.ref||A.mask!==I.mask||this.dirty)&&(this.gl.stencilFunc(A.func,A.ref,A.mask),this.current=A,this.dirty=!1)}}class Ls extends wr{getDefault(){const A=this.gl;return[A.KEEP,A.KEEP,A.KEEP]}set(A){const I=this.current;(A[0]!==I[0]||A[1]!==I[1]||A[2]!==I[2]||this.dirty)&&(this.gl.stencilOp(A[0],A[1],A[2]),this.current=A,this.dirty=!1)}}class Il extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;A?I.enable(I.STENCIL_TEST):I.disable(I.STENCIL_TEST),this.current=A,this.dirty=!1}}class ho extends wr{getDefault(){return[0,1]}set(A){const I=this.current;(A[0]!==I[0]||A[1]!==I[1]||this.dirty)&&(this.gl.depthRange(A[0],A[1]),this.current=A,this.dirty=!1)}}class jo extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;A?I.enable(I.DEPTH_TEST):I.disable(I.DEPTH_TEST),this.current=A,this.dirty=!1}}class ca extends wr{getDefault(){return this.gl.LESS}set(A){(A!==this.current||this.dirty)&&(this.gl.depthFunc(A),this.current=A,this.dirty=!1)}}class Ys extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;A?I.enable(I.BLEND):I.disable(I.BLEND),this.current=A,this.dirty=!1}}class El extends wr{getDefault(){const A=this.gl;return[A.ONE,A.ZERO]}set(A){const I=this.current;(A[0]!==I[0]||A[1]!==I[1]||this.dirty)&&(this.gl.blendFunc(A[0],A[1]),this.current=A,this.dirty=!1)}}class Ha extends wr{getDefault(){return a.aT.transparent}set(A){const I=this.current;(A.r!==I.r||A.g!==I.g||A.b!==I.b||A.a!==I.a||this.dirty)&&(this.gl.blendColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)}}class Ta extends wr{getDefault(){return this.gl.FUNC_ADD}set(A){(A!==this.current||this.dirty)&&(this.gl.blendEquation(A),this.current=A,this.dirty=!1)}}class ml extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;A?I.enable(I.CULL_FACE):I.disable(I.CULL_FACE),this.current=A,this.dirty=!1}}class Cl extends wr{getDefault(){return this.gl.BACK}set(A){(A!==this.current||this.dirty)&&(this.gl.cullFace(A),this.current=A,this.dirty=!1)}}class pu extends wr{getDefault(){return this.gl.CCW}set(A){(A!==this.current||this.dirty)&&(this.gl.frontFace(A),this.current=A,this.dirty=!1)}}class us extends wr{getDefault(){return null}set(A){(A!==this.current||this.dirty)&&(this.gl.useProgram(A),this.current=A,this.dirty=!1)}}class sc extends wr{getDefault(){return this.gl.TEXTURE0}set(A){(A!==this.current||this.dirty)&&(this.gl.activeTexture(A),this.current=A,this.dirty=!1)}}class eo extends wr{getDefault(){const A=this.gl;return[0,0,A.drawingBufferWidth,A.drawingBufferHeight]}set(A){const I=this.current;(A[0]!==I[0]||A[1]!==I[1]||A[2]!==I[2]||A[3]!==I[3]||this.dirty)&&(this.gl.viewport(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)}}class to extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;I.bindFramebuffer(I.FRAMEBUFFER,A),this.current=A,this.dirty=!1}}class ql extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;I.bindRenderbuffer(I.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Ro extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;I.bindTexture(I.TEXTURE_2D,A),this.current=A,this.dirty=!1}}class Zo extends wr{getDefault(){return null}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;I.bindBuffer(I.ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class wo extends wr{getDefault(){return null}set(A){const I=this.gl;I.bindBuffer(I.ELEMENT_ARRAY_BUFFER,A),this.current=A,this.dirty=!1}}class Us extends wr{getDefault(){return null}set(A){var I;if(A===this.current&&!this.dirty)return;const F=this.gl;ir(F)?F.bindVertexArray(A):(I=F.getExtension("OES_vertex_array_object"))===null||I===void 0||I.bindVertexArrayOES(A),this.current=A,this.dirty=!1}}class Qo extends wr{getDefault(){return 4}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;I.pixelStorei(I.UNPACK_ALIGNMENT,A),this.current=A,this.dirty=!1}}class Wo extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;I.pixelStorei(I.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),this.current=A,this.dirty=!1}}class Xo extends wr{getDefault(){return!1}set(A){if(A===this.current&&!this.dirty)return;const I=this.gl;I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,A),this.current=A,this.dirty=!1}}class ba extends wr{constructor(A,I){super(A),this.context=A,this.parent=I}getDefault(){return null}}class ja extends ba{setDirty(){this.dirty=!0}set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const I=this.gl;I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,A,0),this.current=A,this.dirty=!1}}class Ts extends ba{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const I=this.gl;I.framebufferRenderbuffer(I.FRAMEBUFFER,I.DEPTH_ATTACHMENT,I.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class mu extends ba{set(A){if(A===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const I=this.gl;I.framebufferRenderbuffer(I.FRAMEBUFFER,I.DEPTH_STENCIL_ATTACHMENT,I.RENDERBUFFER,A),this.current=A,this.dirty=!1}}class Sr{constructor(A,I,F,O,y){this.context=A,this.width=I,this.height=F;const s=A.gl,i=this.framebuffer=s.createFramebuffer();if(this.colorAttachment=new ja(A,i),O)this.depthAttachment=y?new mu(A,i):new Ts(A,i);else if(y)throw new Error("Stencil cannot be setted without depth");if(s.checkFramebufferStatus(s.FRAMEBUFFER)!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const A=this.context.gl,I=this.colorAttachment.get();if(I&&A.deleteTexture(I),this.depthAttachment){const F=this.depthAttachment.get();F&&A.deleteRenderbuffer(F)}A.deleteFramebuffer(this.framebuffer)}}class Xn{constructor(A,I,F){this.blendFunction=A,this.blendColor=I,this.mask=F}}Xn.Replace=[1,0],Xn.disabled=new Xn(Xn.Replace,a.aT.transparent,[!1,!1,!1,!1]),Xn.unblended=new Xn(Xn.Replace,a.aT.transparent,[!0,!0,!0,!0]),Xn.alphaBlended=new Xn([1,771],a.aT.transparent,[!0,!0,!0,!0]);class Yo{constructor(A){var I,F;if(this.gl=A,this.clearColor=new Mr(this),this.clearDepth=new js(this),this.clearStencil=new vr(this),this.colorMask=new Ks(this),this.depthMask=new Pr(this),this.stencilMask=new bo(this),this.stencilFunc=new Ho(this),this.stencilOp=new Ls(this),this.stencilTest=new Il(this),this.depthRange=new ho(this),this.depthTest=new jo(this),this.depthFunc=new ca(this),this.blend=new Ys(this),this.blendFunc=new El(this),this.blendColor=new Ha(this),this.blendEquation=new Ta(this),this.cullFace=new ml(this),this.cullFaceSide=new Cl(this),this.frontFace=new pu(this),this.program=new us(this),this.activeTexture=new sc(this),this.viewport=new eo(this),this.bindFramebuffer=new to(this),this.bindRenderbuffer=new ql(this),this.bindTexture=new Ro(this),this.bindVertexBuffer=new Zo(this),this.bindElementBuffer=new wo(this),this.bindVertexArray=new Us(this),this.pixelStoreUnpack=new Qo(this),this.pixelStoreUnpackPremultiplyAlpha=new Wo(this),this.pixelStoreUnpackFlipY=new Xo(this),this.extTextureFilterAnisotropic=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=A.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=A.getParameter(A.MAX_TEXTURE_SIZE),ir(A)){this.HALF_FLOAT=A.HALF_FLOAT;const O=A.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(I=A.RGBA16F)!==null&&I!==void 0?I:O==null?void 0:O.RGBA16F_EXT,this.RGB16F=(F=A.RGB16F)!==null&&F!==void 0?F:O==null?void 0:O.RGB16F_EXT,A.getExtension("EXT_color_buffer_float")}else{A.getExtension("EXT_color_buffer_half_float"),A.getExtension("OES_texture_half_float_linear");const O=A.getExtension("OES_texture_half_float");this.HALF_FLOAT=O==null?void 0:O.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(A,I){return new Ga(this,A,I)}createVertexBuffer(A,I,F){return new pl(this,A,I,F)}createRenderbuffer(A,I,F){const O=this.gl,y=O.createRenderbuffer();return this.bindRenderbuffer.set(y),O.renderbufferStorage(O.RENDERBUFFER,A,I,F),this.bindRenderbuffer.set(null),y}createFramebuffer(A,I,F,O){return new Sr(this,A,I,F,O)}clear({color:A,depth:I,stencil:F}){const O=this.gl;let y=0;A&&(y|=O.COLOR_BUFFER_BIT,this.clearColor.set(A),this.colorMask.set([!0,!0,!0,!0])),I!==void 0&&(y|=O.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(I),this.depthMask.set(!0)),F!==void 0&&(y|=O.STENCIL_BUFFER_BIT,this.clearStencil.set(F),this.stencilMask.set(255)),O.clear(y)}setCullFace(A){A.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(A.mode),this.frontFace.set(A.frontFace))}setDepthMode(A){A.func!==this.gl.ALWAYS||A.mask?(this.depthTest.set(!0),this.depthFunc.set(A.func),this.depthMask.set(A.mask),this.depthRange.set(A.range)):this.depthTest.set(!1)}setStencilMode(A){A.test.func!==this.gl.ALWAYS||A.mask?(this.stencilTest.set(!0),this.stencilMask.set(A.mask),this.stencilOp.set([A.fail,A.depthFail,A.pass]),this.stencilFunc.set({func:A.test.func,ref:A.ref,mask:A.test.mask})):this.stencilTest.set(!1)}setColorMode(A){a.aG(A.blendFunction,Xn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(A.blendFunction),this.blendColor.set(A.blendColor)),this.colorMask.set(A.mask)}createVertexArray(){var A;return ir(this.gl)?this.gl.createVertexArray():(A=this.gl.getExtension("OES_vertex_array_object"))===null||A===void 0?void 0:A.createVertexArrayOES()}deleteVertexArray(A){var I;return ir(this.gl)?this.gl.deleteVertexArray(A):(I=this.gl.getExtension("OES_vertex_array_object"))===null||I===void 0?void 0:I.deleteVertexArrayOES(A)}unbindVAO(){this.bindVertexArray.set(null)}}class Dr{constructor(A,I,F){this.func=A,this.mask=I,this.range=F}}Dr.ReadOnly=!1,Dr.ReadWrite=!0,Dr.disabled=new Dr(519,Dr.ReadOnly,[0,1]);const Za=7680;class Kr{constructor(A,I,F,O,y,s){this.test=A,this.ref=I,this.mask=F,this.fail=O,this.depthFail=y,this.pass=s}}Kr.disabled=new Kr({func:519,mask:0},0,0,Za,Za,Za);class Ar{constructor(A,I,F){this.enable=A,this.mode=I,this.frontFace=F}}let So;function Nn(Z,A,I,F,O,y,s){const i=Z.context,r=i.gl,l=Z.useProgram("collisionBox"),d=[];let _=0,w=0;for(let Te=0;Te<F.length;Te++){const Re=F[Te],Be=A.getTile(Re),$e=Be.getBucket(I);if(!$e)continue;let vt=Re.posMatrix;O[0]===0&&O[1]===0||(vt=Z.translatePosMatrix(Re.posMatrix,Be,O,y));const ot=s?$e.textCollisionBox:$e.iconCollisionBox,ct=$e.collisionCircleArray;if(ct.length>0){const Et=a.Z(),wt=vt;a.aU(Et,$e.placementInvProjMatrix,Z.transform.glCoordMatrix),a.aU(Et,Et,$e.placementViewportMatrix),d.push({circleArray:ct,circleOffset:w,transform:wt,invTransform:Et,coord:Re}),_+=ct.length/4,w=_}ot&&l.draw(i,r.LINES,Dr.disabled,Kr.disabled,Z.colorModeForRenderPass(),Ar.disabled,ls(vt,Z.transform,Be),Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Re),I.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,null,Z.transform.zoom,null,null,ot.collisionVertexBuffer)}if(!s||!d.length)return;const T=Z.useProgram("collisionCircle"),B=new a.aV;B.resize(4*_),B._trim();let j=0;for(const Te of d)for(let Re=0;Re<Te.circleArray.length/4;Re++){const Be=4*Re,$e=Te.circleArray[Be+0],vt=Te.circleArray[Be+1],ot=Te.circleArray[Be+2],ct=Te.circleArray[Be+3];B.emplace(j++,$e,vt,ot,ct,0),B.emplace(j++,$e,vt,ot,ct,1),B.emplace(j++,$e,vt,ot,ct,2),B.emplace(j++,$e,vt,ot,ct,3)}(!So||So.length<2*_)&&(So=function(Te){const Re=2*Te,Be=new a.aX;Be.resize(Re),Be._trim();for(let $e=0;$e<Re;$e++){const vt=6*$e;Be.uint16[vt+0]=4*$e+0,Be.uint16[vt+1]=4*$e+1,Be.uint16[vt+2]=4*$e+2,Be.uint16[vt+3]=4*$e+2,Be.uint16[vt+4]=4*$e+3,Be.uint16[vt+5]=4*$e+0}return Be}(_));const Y=i.createIndexBuffer(So,!0),ue=i.createVertexBuffer(B,a.aW.members,!0);for(const Te of d){const Re={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Se=Z.transform).cameraToCenterDistance,u_viewport_size:[Se.width,Se.height]};T.draw(i,r.TRIANGLES,Dr.disabled,Kr.disabled,Z.colorModeForRenderPass(),Ar.disabled,Re,Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Te.coord),I.id,ue,Y,a.S.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,Z.transform.zoom,null,null,null)}var Se;ue.destroy(),Y.destroy()}Ar.disabled=new Ar(!1,1029,2305),Ar.backCCW=new Ar(!0,1029,2305);const Ol=a.ao(new Float32Array(16));function Jr(Z,A,I,F,O,y){const{horizontalAlign:s,verticalAlign:i}=a.au(Z);return new a.P((-(s-.5)*A/O+F[0])*y,(-(i-.5)*I/O+F[1])*y)}function jr(Z,A,I,F,O,y,s,i,r,l,d){const _=Z.text.placedSymbolArray,w=Z.text.dynamicLayoutVertexArray,T=Z.icon.dynamicLayoutVertexArray,B={};w.clear();for(let j=0;j<_.length;j++){const Y=_.get(j),ue=Y.hidden||!Y.crossTileID||Z.allowVerticalPlacement&&!Y.placedOrientation?null:F[Y.crossTileID];if(ue){const Se=new a.P(Y.anchorX,Y.anchorY),Te=Ee(Se,I?s:y,d),Re=ze(O.cameraToCenterDistance,Te.signedDistanceFromCamera);let Be=a.aj(Z.textSizeData,r,Y)*Re/a.ap;I&&(Be*=Z.tilePixelRatio/i);const{width:$e,height:vt,anchor:ot,textOffset:ct,textBoxScale:Et}=ue,wt=Jr(ot,$e,vt,ct,Et,Be),ri=I?Ee(Se.add(wt),y,d).point:Te.point.add(A?wt.rotate(-O.angle):wt),Xt=Z.allowVerticalPlacement&&Y.placedOrientation===a.ai.vertical?Math.PI/2:0;for(let Jt=0;Jt<Y.numGlyphs;Jt++)a.ak(w,ri,Xt);l&&Y.associatedIconIndex>=0&&(B[Y.associatedIconIndex]={shiftedAnchor:ri,angle:Xt})}else de(Y.numGlyphs,w)}if(l){T.clear();const j=Z.icon.placedSymbolArray;for(let Y=0;Y<j.length;Y++){const ue=j.get(Y);if(ue.hidden)de(ue.numGlyphs,T);else{const Se=B[Y];if(Se)for(let Te=0;Te<ue.numGlyphs;Te++)a.ak(T,Se.shiftedAnchor,Se.angle);else de(ue.numGlyphs,T)}}Z.icon.dynamicLayoutVertexBuffer.updateData(T)}Z.text.dynamicLayoutVertexBuffer.updateData(w)}function ks(Z,A,I){return I.iconsInText&&A?"symbolTextAndIcon":Z?"symbolSDF":"symbolIcon"}function Cr(Z,A,I,F,O,y,s,i,r,l,d,_){const w=Z.context,T=w.gl,B=Z.transform,j=i==="map",Y=r==="map",ue=i!=="viewport"&&I.layout.get("symbol-placement")!=="point",Se=j&&!Y&&!ue,Te=!I.layout.get("symbol-sort-key").isConstant();let Re=!1;const Be=Z.depthModeForSublayer(0,Dr.ReadOnly),$e=I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"),vt=[];for(const ot of F){const ct=A.getTile(ot),Et=ct.getBucket(I);if(!Et)continue;const wt=O?Et.text:Et.icon;if(!wt||!wt.segments.get().length||!wt.hasVisibleVertices)continue;const ri=wt.programConfigurations.get(I.id),Xt=O||Et.sdfIcons,Jt=O?Et.textSizeData:Et.iconSizeData,si=Y||B.pitch!==0,ji=Z.useProgram(ks(Xt,O,Et),ri),Zi=a.ah(Jt,B.zoom),Ii=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(ot);let Vi,Ui,an,Bn,Ji=[0,0],Cn=null;if(O)Ui=ct.glyphAtlasTexture,an=T.LINEAR,Vi=ct.glyphAtlasTexture.size,Et.iconsInText&&(Ji=ct.imageAtlasTexture.size,Cn=ct.imageAtlasTexture,Bn=si||Z.options.rotating||Z.options.zooming||Jt.kind==="composite"||Jt.kind==="camera"?T.LINEAR:T.NEAREST);else{const Zs=I.layout.get("icon-size").constantOr(0)!==1||Et.iconsNeedLinear;Ui=ct.imageAtlasTexture,an=Xt||Z.options.rotating||Z.options.zooming||Zs||si?T.LINEAR:T.NEAREST,Vi=ct.imageAtlasTexture.size}const yr=Fe(ct,1,Z.transform.zoom),er=ve(ot.posMatrix,Y,j,Z.transform,yr),Ia=Ie(ot.posMatrix,Y,j,Z.transform,yr),Aa=$e&&Et.hasTextData(),Bs=I.layout.get("icon-text-fit")!=="none"&&Aa&&Et.hasIconData();if(ue){const Zs=Z.style.map.terrain?(ts,Lr)=>Z.style.map.terrain.getElevation(ot,ts,Lr):null,es=I.layout.get("text-rotation-alignment")==="map";He(Et,ot.posMatrix,Z,O,er,Ia,Y,l,es,Zs)}const no=Z.translatePosMatrix(ot.posMatrix,ct,y,s),ro=ue||O&&$e||Bs?Ol:er,Gr=Z.translatePosMatrix(Ia,ct,y,s,!0),ya=Xt&&I.paint.get(O?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let go;go=Xt?Et.iconsInText?rr(Jt.kind,Zi,Se,Y,Z,no,ro,Gr,Vi,Ji):An(Jt.kind,Zi,Se,Y,Z,no,ro,Gr,O,Vi,!0):un(Jt.kind,Zi,Se,Y,Z,no,ro,Gr,O,Vi);const _o={program:ji,buffers:wt,uniformValues:go,atlasTexture:Ui,atlasTextureIcon:Cn,atlasInterpolation:an,atlasInterpolationIcon:Bn,isSDF:Xt,hasHalo:ya};if(Te&&Et.canOverlap){Re=!0;const Zs=wt.segments.get();for(const es of Zs)vt.push({segments:new a.S([es]),sortKey:es.sortKey,state:_o,terrainData:Ii})}else vt.push({segments:wt.segments,sortKey:0,state:_o,terrainData:Ii})}Re&&vt.sort((ot,ct)=>ot.sortKey-ct.sortKey);for(const ot of vt){const ct=ot.state;if(w.activeTexture.set(T.TEXTURE0),ct.atlasTexture.bind(ct.atlasInterpolation,T.CLAMP_TO_EDGE),ct.atlasTextureIcon&&(w.activeTexture.set(T.TEXTURE1),ct.atlasTextureIcon&&ct.atlasTextureIcon.bind(ct.atlasInterpolationIcon,T.CLAMP_TO_EDGE)),ct.isSDF){const Et=ct.uniformValues;ct.hasHalo&&(Et.u_is_halo=1,nr(ct.buffers,ot.segments,I,Z,ct.program,Be,d,_,Et,ot.terrainData)),Et.u_is_halo=0}nr(ct.buffers,ot.segments,I,Z,ct.program,Be,d,_,ct.uniformValues,ot.terrainData)}}function nr(Z,A,I,F,O,y,s,i,r,l){const d=F.context;O.draw(d,d.gl.TRIANGLES,y,s,i,Ar.disabled,r,l,I.id,Z.layoutVertexBuffer,Z.indexBuffer,A,I.paint,F.transform.zoom,Z.programConfigurations.get(I.id),Z.dynamicLayoutVertexBuffer,Z.opacityVertexBuffer)}function al(Z,A,I,F,O){if(!I||!F||!F.imageAtlas)return;const y=F.imageAtlas.patternPositions;let s=y[I.to.toString()],i=y[I.from.toString()];if(!s&&i&&(s=i),!i&&s&&(i=s),!s||!i){const r=O.getPaintProperty(A);s=y[r],i=y[r]}s&&i&&Z.setConstantPatternPositions(s,i)}function Xr(Z,A,I,F,O,y,s){const i=Z.context.gl,r="fill-pattern",l=I.paint.get(r),d=l&&l.constantOr(1),_=I.getCrossfadeParameters();let w,T,B,j,Y;s?(T=d&&!I.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=i.LINES):(T=d?"fillPattern":"fill",w=i.TRIANGLES);const ue=l.constantOr(null);for(const Se of F){const Te=A.getTile(Se);if(d&&!Te.patternsLoaded())continue;const Re=Te.getBucket(I);if(!Re)continue;const Be=Re.programConfigurations.get(I.id),$e=Z.useProgram(T,Be),vt=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(Se);d&&(Z.context.activeTexture.set(i.TEXTURE0),Te.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),Be.updatePaintBuffers(_)),al(Be,r,ue,Te,I);const ot=vt?Se:null,ct=Z.translatePosMatrix(ot?ot.posMatrix:Se.posMatrix,Te,I.paint.get("fill-translate"),I.paint.get("fill-translate-anchor"));if(s){j=Re.indexBuffer2,Y=Re.segments2;const Et=[i.drawingBufferWidth,i.drawingBufferHeight];B=T==="fillOutlinePattern"&&d?jn(ct,Z,_,Te,Et):Xs(ct,Et)}else j=Re.indexBuffer,Y=Re.segments,B=d?Oa(ct,Z,_,Te):zo(ct);$e.draw(Z.context,w,O,Z.stencilModeForClipping(Se),y,Ar.disabled,B,vt,I.id,Re.layoutVertexBuffer,j,Y,I.paint,Z.transform.zoom,Be)}}function Io(Z,A,I,F,O,y,s){const i=Z.context,r=i.gl,l="fill-extrusion-pattern",d=I.paint.get(l),_=d.constantOr(1),w=I.getCrossfadeParameters(),T=I.paint.get("fill-extrusion-opacity"),B=d.constantOr(null);for(const j of F){const Y=A.getTile(j),ue=Y.getBucket(I);if(!ue)continue;const Se=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(j),Te=ue.programConfigurations.get(I.id),Re=Z.useProgram(_?"fillExtrusionPattern":"fillExtrusion",Te);_&&(Z.context.activeTexture.set(r.TEXTURE0),Y.imageAtlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE),Te.updatePaintBuffers(w)),al(Te,l,B,Y,I);const Be=Z.translatePosMatrix(j.posMatrix,Y,I.paint.get("fill-extrusion-translate"),I.paint.get("fill-extrusion-translate-anchor")),$e=I.paint.get("fill-extrusion-vertical-gradient"),vt=_?Fa(Be,Z,$e,T,j,w,Y):kr(Be,Z,$e,T);Re.draw(i,i.gl.TRIANGLES,O,y,s,Ar.backCCW,vt,Se,I.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,I.paint,Z.transform.zoom,Te,Z.style.map.terrain&&ue.centroidVertexBuffer)}}function ol(Z,A,I,F,O,y,s){const i=Z.context,r=i.gl,l=I.fbo;if(!l)return;const d=Z.useProgram("hillshade"),_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(A);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.colorAttachment.get()),d.draw(i,r.TRIANGLES,O,y,s,Ar.disabled,((w,T,B,j)=>{const Y=B.paint.get("hillshade-shadow-color"),ue=B.paint.get("hillshade-highlight-color"),Se=B.paint.get("hillshade-accent-color");let Te=B.paint.get("hillshade-illumination-direction")*(Math.PI/180);B.paint.get("hillshade-illumination-anchor")==="viewport"&&(Te-=w.transform.angle);const Re=!w.options.moving;return{u_matrix:j?j.posMatrix:w.transform.calculatePosMatrix(T.tileID.toUnwrapped(),Re),u_image:0,u_latrange:Ja(0,T.tileID),u_light:[B.paint.get("hillshade-exaggeration"),Te],u_shadow:Y,u_highlight:ue,u_accent:Se}})(Z,I,F,_?A:null),_,F.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments)}function Zr(Z,A,I,F,O,y){const s=Z.context,i=s.gl,r=A.dem;if(r&&r.data){const l=r.dim,d=r.stride,_=r.getPixels();if(s.activeTexture.set(i.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),A.demTexture=A.demTexture||Z.getTileTexture(d),A.demTexture){const T=A.demTexture;T.update(_,{premultiply:!1}),T.bind(i.NEAREST,i.CLAMP_TO_EDGE)}else A.demTexture=new _t(s,_,i.RGBA,{premultiply:!1}),A.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE);s.activeTexture.set(i.TEXTURE0);let w=A.fbo;if(!w){const T=new _t(s,{width:l,height:l,data:null},i.RGBA);T.bind(i.LINEAR,i.CLAMP_TO_EDGE),w=A.fbo=s.createFramebuffer(l,l,!0,!1),w.colorAttachment.set(T.texture)}s.bindFramebuffer.set(w.framebuffer),s.viewport.set([0,0,l,l]),Z.useProgram("hillshadePrepare").draw(s,i.TRIANGLES,F,O,y,Ar.disabled,((T,B)=>{const j=B.stride,Y=a.Z();return a.aS(Y,0,a.N,-a.N,0,0,1),a.$(Y,Y,[0,-a.N,0]),{u_matrix:Y,u_image:1,u_dimension:[j,j],u_zoom:T.overscaledZ,u_unpack:B.getUnpackVector()}})(A.tileID,r),null,I.id,Z.rasterBoundsBuffer,Z.quadTriangleIndexBuffer,Z.rasterBoundsSegments),A.needsHillshadePrepare=!1}}function hs(Z,A,I,F,O,y){const s=F.paint.get("raster-fade-duration");if(!y&&s>0){const i=a.h.now(),r=(i-Z.timeAdded)/s,l=A?(i-A.timeAdded)/s:-1,d=I.getSource(),_=O.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),w=!A||Math.abs(A.tileID.overscaledZ-_)>Math.abs(Z.tileID.overscaledZ-_),T=w&&Z.refreshedUponExpiration?1:a.ad(w?r:1-l,0,1);return Z.refreshedUponExpiration&&r>=1&&(Z.refreshedUponExpiration=!1),A?{opacity:1,mix:1-T}:{opacity:T,mix:0}}return{opacity:1,mix:0}}const wa=new a.aT(1,0,0,1),Tl=new a.aT(0,1,0,1),Eo=new a.aT(0,0,1,1),kl=new a.aT(1,0,1,1),Ao=new a.aT(0,1,1,1);function Js(Z,A,I,F){Qa(Z,0,A+I/2,Z.transform.width,I,F)}function Gs(Z,A,I,F){Qa(Z,A-I/2,0,I,Z.transform.height,F)}function Qa(Z,A,I,F,O,y){const s=Z.context,i=s.gl;i.enable(i.SCISSOR_TEST),i.scissor(A*Z.pixelRatio,I*Z.pixelRatio,F*Z.pixelRatio,O*Z.pixelRatio),s.clear({color:y}),i.disable(i.SCISSOR_TEST)}function $o(Z,A,I){const F=Z.context,O=F.gl,y=I.posMatrix,s=Z.useProgram("debug"),i=Dr.disabled,r=Kr.disabled,l=Z.colorModeForRenderPass(),d="$debug",_=Z.style.map.terrain&&Z.style.map.terrain.getTerrainData(I);F.activeTexture.set(O.TEXTURE0);const w=A.getTileByID(I.key).latestRawTileData,T=Math.floor((w&&w.byteLength||0)/1024),B=A.getTile(I).tileSize,j=512/Math.min(B,512)*(I.overscaledZ/Z.transform.zoom)*.5;let Y=I.canonical.toString();I.overscaledZ!==I.canonical.z&&(Y+=` => ${I.overscaledZ}`),function(ue,Se){ue.initDebugOverlayCanvas();const Te=ue.debugOverlayCanvas,Re=ue.context.gl,Be=ue.debugOverlayCanvas.getContext("2d");Be.clearRect(0,0,Te.width,Te.height),Be.shadowColor="white",Be.shadowBlur=2,Be.lineWidth=1.5,Be.strokeStyle="white",Be.textBaseline="top",Be.font="bold 36px Open Sans, sans-serif",Be.fillText(Se,5,5),Be.strokeText(Se,5,5),ue.debugOverlayTexture.update(Te),ue.debugOverlayTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE)}(Z,`${Y} ${T}kB`),s.draw(F,O.TRIANGLES,i,r,Xn.alphaBlended,Ar.disabled,Na(y,a.aT.transparent,j),null,d,Z.debugBuffer,Z.quadTriangleIndexBuffer,Z.debugSegments),s.draw(F,O.LINE_STRIP,i,r,l,Ar.disabled,Na(y,a.aT.red),_,d,Z.debugBuffer,Z.tileBorderIndexBuffer,Z.debugSegments)}function Yr(Z,A,I){const F=Z.context,O=F.gl,y=Z.colorModeForRenderPass(),s=new Dr(O.LEQUAL,Dr.ReadWrite,Z.depthRangeFor3D),i=Z.useProgram("terrain"),r=A.getTerrainMesh();F.bindFramebuffer.set(null),F.viewport.set([0,0,Z.width,Z.height]);for(const l of I){const d=Z.renderToTexture.getTexture(l),_=A.getTerrainData(l.tileID);F.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,d.texture);const w={u_matrix:Z.transform.calculatePosMatrix(l.tileID.toUnwrapped()),u_texture:0,u_ele_delta:A.getMeshFrameDelta(Z.transform.zoom)};i.draw(F,O.TRIANGLES,s,Kr.disabled,y,Ar.backCCW,w,_,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}class mr{constructor(A,I){this.context=new Yo(A),this.transform=I,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.Z(),renderTime:0},this.setup(),this.numSublayers=ln.maxUnderzooming+ln.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Fn}resize(A,I,F){if(this.width=Math.floor(A*F),this.height=Math.floor(I*F),this.pixelRatio=F,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const O of this.style._order)this.style._layers[O].resize()}setup(){const A=this.context,I=new a.a_;I.emplaceBack(0,0),I.emplaceBack(a.N,0),I.emplaceBack(0,a.N),I.emplaceBack(a.N,a.N),this.tileExtentBuffer=A.createVertexBuffer(I,Ns.members),this.tileExtentSegments=a.S.simpleSegment(0,0,4,2);const F=new a.a_;F.emplaceBack(0,0),F.emplaceBack(a.N,0),F.emplaceBack(0,a.N),F.emplaceBack(a.N,a.N),this.debugBuffer=A.createVertexBuffer(F,Ns.members),this.debugSegments=a.S.simpleSegment(0,0,4,5);const O=new a.V;O.emplaceBack(0,0,0,0),O.emplaceBack(a.N,0,a.N,0),O.emplaceBack(0,a.N,0,a.N),O.emplaceBack(a.N,a.N,a.N,a.N),this.rasterBoundsBuffer=A.createVertexBuffer(O,yi.members),this.rasterBoundsSegments=a.S.simpleSegment(0,0,4,2);const y=new a.a_;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=A.createVertexBuffer(y,Ns.members),this.viewportSegments=a.S.simpleSegment(0,0,4,2);const s=new a.a$;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=A.createIndexBuffer(s);const i=new a.b0;i.emplaceBack(0,1,2),i.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=A.createIndexBuffer(i);const r=this.context.gl;this.stencilClearMode=new Kr({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO)}clearStencil(){const A=this.context,I=A.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const F=a.Z();a.aS(F,0,this.width,this.height,0,0,1),a.a0(F,F,[I.drawingBufferWidth,I.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(A,I.TRIANGLES,Dr.disabled,this.stencilClearMode,Xn.disabled,Ar.disabled,rl(F),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(A,I){if(this.currentStencilSource===A.source||!A.isTileClipped()||!I||!I.length)return;this.currentStencilSource=A.source;const F=this.context,O=F.gl;this.nextStencilID+I.length>256&&this.clearStencil(),F.setColorMode(Xn.disabled),F.setDepthMode(Dr.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const s of I){const i=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,r=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s);y.draw(F,O.TRIANGLES,Dr.disabled,new Kr({func:O.ALWAYS,mask:0},i,255,O.KEEP,O.KEEP,O.REPLACE),Xn.disabled,Ar.disabled,rl(s.posMatrix),r,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const A=this.nextStencilID++,I=this.context.gl;return new Kr({func:I.NOTEQUAL,mask:255},A,255,I.KEEP,I.KEEP,I.REPLACE)}stencilModeForClipping(A){const I=this.context.gl;return new Kr({func:I.EQUAL,mask:255},this._tileClippingMaskIDs[A.key],0,I.KEEP,I.KEEP,I.REPLACE)}stencilConfigForOverlap(A){const I=this.context.gl,F=A.sort((s,i)=>i.overscaledZ-s.overscaledZ),O=F[F.length-1].overscaledZ,y=F[0].overscaledZ-O+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const s={};for(let i=0;i<y;i++)s[i+O]=new Kr({func:I.GEQUAL,mask:255},i+this.nextStencilID,255,I.KEEP,I.KEEP,I.REPLACE);return this.nextStencilID+=y,[s,F]}return[{[O]:Kr.disabled},F]}colorModeForRenderPass(){const A=this.context.gl;return this._showOverdrawInspector?new Xn([A.CONSTANT_COLOR,A.ONE],new a.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xn.unblended:Xn.alphaBlended}depthModeForSublayer(A,I,F){if(!this.opaquePassEnabledForLayer())return Dr.disabled;const O=1-((1+this.currentLayer)*this.numSublayers+A)*this.depthEpsilon;return new Dr(F||this.context.gl.LEQUAL,I,[O,O])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(A,I){this.style=A,this.options=I,this.lineAtlas=A.lineAtlas,this.imageManager=A.imageManager,this.glyphManager=A.glyphManager,this.symbolFadeChange=A.placement.symbolFadeChange(a.h.now()),this.imageManager.beginFrame();const F=this.style._order,O=this.style.sourceCaches,y={},s={},i={};for(const r in O){const l=O[r];l.used&&l.prepare(this.context),y[r]=l.getVisibleCoordinates(),s[r]=y[r].slice().reverse(),i[r]=l.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let r=0;r<F.length;r++)if(this.style._layers[F[r]].is3D()){this.opaquePassCutoff=r;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||r.length)&&(a.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(l,d){const _=l.context,w=_.gl,T=Xn.unblended,B=new Dr(w.LEQUAL,Dr.ReadWrite,[0,1]),j=d.getTerrainMesh(),Y=d.sourceCache.getRenderableTiles(),ue=l.useProgram("terrainDepth");_.bindFramebuffer.set(d.getFramebuffer("depth").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1});for(const Se of Y){const Te=d.getTerrainData(Se.tileID),Re={u_matrix:l.transform.calculatePosMatrix(Se.tileID.toUnwrapped()),u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};ue.draw(_,w.TRIANGLES,B,Kr.disabled,T,Ar.backCCW,Re,Te,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain),function(l,d){const _=l.context,w=_.gl,T=Xn.unblended,B=new Dr(w.LEQUAL,Dr.ReadWrite,[0,1]),j=d.getTerrainMesh(),Y=d.getCoordsTexture(),ue=d.sourceCache.getRenderableTiles(),Se=l.useProgram("terrainCoords");_.bindFramebuffer.set(d.getFramebuffer("coords").framebuffer),_.viewport.set([0,0,l.width/devicePixelRatio,l.height/devicePixelRatio]),_.clear({color:a.aT.transparent,depth:1}),d.coordsIndex=[];for(const Te of ue){const Re=d.getTerrainData(Te.tileID);_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,Y.texture);const Be={u_matrix:l.transform.calculatePosMatrix(Te.tileID.toUnwrapped()),u_terrain_coords_id:(255-d.coordsIndex.length)/255,u_texture:0,u_ele_delta:d.getMeshFrameDelta(l.transform.zoom)};Se.draw(_,w.TRIANGLES,B,Kr.disabled,T,Ar.backCCW,Be,Re,"terrain",j.vertexBuffer,j.indexBuffer,j.segments),d.coordsIndex.push(Te.tileID.key)}_.bindFramebuffer.set(null),_.viewport.set([0,0,l.width,l.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const r of F){const l=this.style._layers[r];if(!l.hasOffscreenPass()||l.isHidden(this.transform.zoom))continue;const d=s[l.source];(l.type==="custom"||d.length)&&this.renderLayer(this,O[l.source],l,d)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:I.showOverdrawInspector?a.aT.black:a.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=I.showOverdrawInspector,this.depthRangeFor3D=[0,1-(A._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=F.length-1;this.currentLayer>=0;this.currentLayer--){const r=this.style._layers[F[this.currentLayer]],l=O[r.source],d=y[r.source];this._renderTileClippingMasks(r,d),this.renderLayer(this,l,r,d)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const r=this.style._layers[F[this.currentLayer]],l=O[r.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(r))continue;const d=(r.type==="symbol"?i:s)[r.source];this._renderTileClippingMasks(r,y[r.source]),this.renderLayer(this,l,r,d)}if(this.options.showTileBoundaries){const r=function(l,d){let _=null;const w=Object.values(l._layers).flatMap(Y=>Y.source&&!Y.isHidden(d)?[l.sourceCaches[Y.source]]:[]),T=w.filter(Y=>Y.getSource().type==="vector"),B=w.filter(Y=>Y.getSource().type!=="vector"),j=Y=>{(!_||_.getSource().maxzoom<Y.getSource().maxzoom)&&(_=Y)};return T.forEach(Y=>j(Y)),_||B.forEach(Y=>j(Y)),_}(this.style,this.transform.zoom);r&&function(l,d,_){for(let w=0;w<_.length;w++)$o(l,d,_[w])}(this,r,r.getVisibleCoordinates())}this.options.showPadding&&function(r){const l=r.transform.padding;Js(r,r.transform.height-(l.top||0),3,wa),Js(r,l.bottom||0,3,Tl),Gs(r,l.left||0,3,Eo),Gs(r,r.transform.width-(l.right||0),3,kl);const d=r.transform.centerPoint;(function(_,w,T,B){Qa(_,w-1,T-10,2,20,B),Qa(_,w-10,T-1,20,2,B)})(r,d.x,r.transform.height-d.y,Ao)}(this),this.context.setDefault()}renderLayer(A,I,F,O){if(!F.isHidden(this.transform.zoom)&&(F.type==="background"||F.type==="custom"||(O||[]).length))switch(this.id=F.id,F.type){case"symbol":(function(y,s,i,r,l){if(y.renderPass!=="translucent")return;const d=Kr.disabled,_=y.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(w,T,B,j,Y,ue,Se){const Te=T.transform,Re=Y==="map",Be=ue==="map";for(const $e of w){const vt=j.getTile($e),ot=vt.getBucket(B);if(!ot||!ot.text||!ot.text.segments.get().length)continue;const ct=a.ah(ot.textSizeData,Te.zoom),Et=Fe(vt,1,T.transform.zoom),wt=ve($e.posMatrix,Be,Re,T.transform,Et),ri=B.layout.get("icon-text-fit")!=="none"&&ot.hasIconData();if(ct){const Xt=Math.pow(2,Te.zoom-vt.tileID.overscaledZ);jr(ot,Re,Be,Se,Te,wt,$e.posMatrix,Xt,ct,ri,T.style.map.terrain?(Jt,si)=>T.style.map.terrain.getElevation($e,Jt,si):null)}}}(r,y,i,s,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),l),i.paint.get("icon-opacity").constantOr(1)!==0&&Cr(y,s,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),d,_),i.paint.get("text-opacity").constantOr(1)!==0&&Cr(y,s,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),d,_),s.map.showCollisionBoxes&&(Nn(y,s,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Nn(y,s,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))})(A,I,F,O,this.style.placement.variableOffsets);break;case"circle":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("circle-opacity"),d=i.paint.get("circle-stroke-width"),_=i.paint.get("circle-stroke-opacity"),w=!i.layout.get("circle-sort-key").isConstant();if(l.constantOr(1)===0&&(d.constantOr(1)===0||_.constantOr(1)===0))return;const T=y.context,B=T.gl,j=y.depthModeForSublayer(0,Dr.ReadOnly),Y=Kr.disabled,ue=y.colorModeForRenderPass(),Se=[];for(let Te=0;Te<r.length;Te++){const Re=r[Te],Be=s.getTile(Re),$e=Be.getBucket(i);if(!$e)continue;const vt=$e.programConfigurations.get(i.id),ot=y.useProgram("circle",vt),ct=$e.layoutVertexBuffer,Et=$e.indexBuffer,wt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),ri={programConfiguration:vt,program:ot,layoutVertexBuffer:ct,indexBuffer:Et,uniformValues:aa(y,Re,Be,i),terrainData:wt};if(w){const Xt=$e.segments.get();for(const Jt of Xt)Se.push({segments:new a.S([Jt]),sortKey:Jt.sortKey,state:ri})}else Se.push({segments:$e.segments,sortKey:0,state:ri})}w&&Se.sort((Te,Re)=>Te.sortKey-Re.sortKey);for(const Te of Se){const{programConfiguration:Re,program:Be,layoutVertexBuffer:$e,indexBuffer:vt,uniformValues:ot,terrainData:ct}=Te.state;Be.draw(T,B.TRIANGLES,j,Y,ue,Ar.disabled,ot,ct,i.id,$e,vt,Te.segments,i.paint,y.transform.zoom,Re)}})(A,I,F,O);break;case"heatmap":(function(y,s,i,r){if(i.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const l=y.context,d=l.gl,_=Kr.disabled,w=new Xn([d.ONE,d.ONE],a.aT.transparent,[!0,!0,!0,!0]);(function(T,B,j){const Y=T.gl;T.activeTexture.set(Y.TEXTURE1),T.viewport.set([0,0,B.width/4,B.height/4]);let ue=j.heatmapFbo;if(ue)Y.bindTexture(Y.TEXTURE_2D,ue.colorAttachment.get()),T.bindFramebuffer.set(ue.framebuffer);else{const Se=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,Se),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),ue=j.heatmapFbo=T.createFramebuffer(B.width/4,B.height/4,!1,!1),function(Te,Re,Be,$e){var vt,ot;const ct=Te.gl,Et=(vt=Te.HALF_FLOAT)!==null&&vt!==void 0?vt:ct.UNSIGNED_BYTE,wt=(ot=Te.RGBA16F)!==null&&ot!==void 0?ot:ct.RGBA;ct.texImage2D(ct.TEXTURE_2D,0,wt,Re.width/4,Re.height/4,0,ct.RGBA,Et,null),$e.colorAttachment.set(Be)}(T,B,Se,ue)}})(l,y,i),l.clear({color:a.aT.transparent});for(let T=0;T<r.length;T++){const B=r[T];if(s.hasRenderableParent(B))continue;const j=s.getTile(B),Y=j.getBucket(i);if(!Y)continue;const ue=Y.programConfigurations.get(i.id),Se=y.useProgram("heatmap",ue),{zoom:Te}=y.transform;Se.draw(l,d.TRIANGLES,Dr.disabled,_,w,Ar.disabled,sl(B.posMatrix,j,Te,i.paint.get("heatmap-intensity")),null,i.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,i.paint,y.transform.zoom,ue)}l.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(l,d){const _=l.context,w=_.gl,T=d.heatmapFbo;if(!T)return;_.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,T.colorAttachment.get()),_.activeTexture.set(w.TEXTURE1);let B=d.colorRampTexture;B||(B=d.colorRampTexture=new _t(_,d.colorRamp,w.RGBA)),B.bind(w.LINEAR,w.CLAMP_TO_EDGE),l.useProgram("heatmapTexture").draw(_,w.TRIANGLES,Dr.disabled,Kr.disabled,l.colorModeForRenderPass(),Ar.disabled,((j,Y,ue,Se)=>{const Te=a.Z();a.aS(Te,0,j.width,j.height,0,0,1);const Re=j.context.gl;return{u_matrix:Te,u_world:[Re.drawingBufferWidth,Re.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}})(l,d),null,d.id,l.viewportBuffer,l.quadTriangleIndexBuffer,l.viewportSegments,d.paint,l.transform.zoom)}(y,i))})(A,I,F,O);break;case"line":(function(y,s,i,r){if(y.renderPass!=="translucent")return;const l=i.paint.get("line-opacity"),d=i.paint.get("line-width");if(l.constantOr(1)===0||d.constantOr(1)===0)return;const _=y.depthModeForSublayer(0,Dr.ReadOnly),w=y.colorModeForRenderPass(),T=i.paint.get("line-dasharray"),B=i.paint.get("line-pattern"),j=B.constantOr(1),Y=i.paint.get("line-gradient"),ue=i.getCrossfadeParameters(),Se=j?"linePattern":T?"lineSDF":Y?"lineGradient":"line",Te=y.context,Re=Te.gl;let Be=!0;for(const $e of r){const vt=s.getTile($e);if(j&&!vt.patternsLoaded())continue;const ot=vt.getBucket(i);if(!ot)continue;const ct=ot.programConfigurations.get(i.id),Et=y.context.program.get(),wt=y.useProgram(Se,ct),ri=Be||wt.program!==Et,Xt=y.style.map.terrain&&y.style.map.terrain.getTerrainData($e),Jt=B.constantOr(null);if(Jt&&vt.imageAtlas){const Zi=vt.imageAtlas,Ii=Zi.patternPositions[Jt.to.toString()],Vi=Zi.patternPositions[Jt.from.toString()];Ii&&Vi&&ct.setConstantPatternPositions(Ii,Vi)}const si=Xt?$e:null,ji=j?xe(y,vt,i,ue,si):T?tt(y,vt,i,T,ue,si):Y?N(y,vt,i,ot.lineClipsArray.length,si):Va(y,vt,i,si);if(j)Te.activeTexture.set(Re.TEXTURE0),vt.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),ct.updatePaintBuffers(ue);else if(T&&(ri||y.lineAtlas.dirty))Te.activeTexture.set(Re.TEXTURE0),y.lineAtlas.bind(Te);else if(Y){const Zi=ot.gradients[i.id];let Ii=Zi.texture;if(i.gradientVersion!==Zi.version){let Vi=256;if(i.stepInterpolant){const Ui=s.getSource().maxzoom,an=$e.canonical.z===Ui?Math.ceil(1<<y.transform.maxZoom-$e.canonical.z):1;Vi=a.ad(a.aY(ot.maxLineLength/a.N*1024*an),256,Te.maxTextureSize)}Zi.gradient=a.aZ({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Vi,image:Zi.gradient||void 0,clips:ot.lineClipsArray}),Zi.texture?Zi.texture.update(Zi.gradient):Zi.texture=new _t(Te,Zi.gradient,Re.RGBA),Zi.version=i.gradientVersion,Ii=Zi.texture}Te.activeTexture.set(Re.TEXTURE0),Ii.bind(i.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}wt.draw(Te,Re.TRIANGLES,_,y.stencilModeForClipping($e),w,Ar.disabled,ji,Xt,i.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,i.paint,y.transform.zoom,ct,ot.layoutVertexBuffer2),Be=!1}})(A,I,F,O);break;case"fill":(function(y,s,i,r){const l=i.paint.get("fill-color"),d=i.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const _=y.colorModeForRenderPass(),w=i.paint.get("fill-pattern"),T=y.opaquePassEnabledForLayer()&&!w.constantOr(1)&&l.constantOr(a.aT.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===T){const B=y.depthModeForSublayer(1,y.renderPass==="opaque"?Dr.ReadWrite:Dr.ReadOnly);Xr(y,s,i,r,B,_,!1)}if(y.renderPass==="translucent"&&i.paint.get("fill-antialias")){const B=y.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Dr.ReadOnly);Xr(y,s,i,r,B,_,!0)}})(A,I,F,O);break;case"fill-extrusion":(function(y,s,i,r){const l=i.paint.get("fill-extrusion-opacity");if(l!==0&&y.renderPass==="translucent"){const d=new Dr(y.context.gl.LEQUAL,Dr.ReadWrite,y.depthRangeFor3D);if(l!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))Io(y,s,i,r,d,Kr.disabled,Xn.disabled),Io(y,s,i,r,d,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const _=y.colorModeForRenderPass();Io(y,s,i,r,d,Kr.disabled,_)}}})(A,I,F,O);break;case"hillshade":(function(y,s,i,r){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const l=y.context,d=y.depthModeForSublayer(0,Dr.ReadOnly),_=y.colorModeForRenderPass(),[w,T]=y.renderPass==="translucent"?y.stencilConfigForOverlap(r):[{},r];for(const B of T){const j=s.getTile(B);j.needsHillshadePrepare!==void 0&&j.needsHillshadePrepare&&y.renderPass==="offscreen"?Zr(y,j,i,d,Kr.disabled,_):y.renderPass==="translucent"&&ol(y,B,j,i,d,w[B.overscaledZ],_)}l.viewport.set([0,0,y.width,y.height])})(A,I,F,O);break;case"raster":(function(y,s,i,r){if(y.renderPass!=="translucent"||i.paint.get("raster-opacity")===0||!r.length)return;const l=y.context,d=l.gl,_=s.getSource(),w=y.useProgram("raster"),T=y.colorModeForRenderPass(),[B,j]=_ instanceof hi?[{},r]:y.stencilConfigForOverlap(r),Y=j[j.length-1].overscaledZ,ue=!y.options.moving;for(const Se of j){const Te=y.depthModeForSublayer(Se.overscaledZ-Y,i.paint.get("raster-opacity")===1?Dr.ReadWrite:Dr.ReadOnly,d.LESS),Re=s.getTile(Se);Re.registerFadeDuration(i.paint.get("raster-fade-duration"));const Be=s.findLoadedParent(Se,0),$e=hs(Re,Be,s,i,y.transform,y.style.map.terrain);let vt,ot;const ct=i.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;l.activeTexture.set(d.TEXTURE0),Re.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),l.activeTexture.set(d.TEXTURE1),Be?(Be.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),vt=Math.pow(2,Be.tileID.overscaledZ-Re.tileID.overscaledZ),ot=[Re.tileID.canonical.x*vt%1,Re.tileID.canonical.y*vt%1]):Re.texture.bind(ct,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Et=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Se),wt=Et?Se:null,ri=wt?wt.posMatrix:y.transform.calculatePosMatrix(Se.toUnwrapped(),ue),Xt=Si(ri,ot||[0,0],vt||1,$e,i);_ instanceof hi?w.draw(l,d.TRIANGLES,Te,Kr.disabled,T,Ar.disabled,Xt,Et,i.id,_.boundsBuffer,y.quadTriangleIndexBuffer,_.boundsSegments):w.draw(l,d.TRIANGLES,Te,B[Se.overscaledZ],T,Ar.disabled,Xt,Et,i.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(A,I,F,O);break;case"background":(function(y,s,i,r){const l=i.paint.get("background-color"),d=i.paint.get("background-opacity");if(d===0)return;const _=y.context,w=_.gl,T=y.transform,B=T.tileSize,j=i.paint.get("background-pattern");if(y.isPatternMissing(j))return;const Y=!j&&l.a===1&&d===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==Y)return;const ue=Kr.disabled,Se=y.depthModeForSublayer(0,Y==="opaque"?Dr.ReadWrite:Dr.ReadOnly),Te=y.colorModeForRenderPass(),Re=y.useProgram(j?"backgroundPattern":"background"),Be=r||T.coveringTiles({tileSize:B,terrain:y.style.map.terrain});j&&(_.activeTexture.set(w.TEXTURE0),y.imageManager.bind(y.context));const $e=i.getCrossfadeParameters();for(const vt of Be){const ot=r?vt.posMatrix:y.transform.calculatePosMatrix(vt.toUnwrapped()),ct=j?zr(ot,d,y,j,{tileID:vt,tileSize:B},$e):hr(ot,d,l),Et=y.style.map.terrain&&y.style.map.terrain.getTerrainData(vt);Re.draw(_,w.TRIANGLES,Se,ue,Te,Ar.disabled,ct,Et,i.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(A,0,F,O);break;case"custom":(function(y,s,i){const r=y.context,l=i.implementation;if(y.renderPass==="offscreen"){const d=l.prerender;d&&(y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),d.call(l,r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),r.setColorMode(y.colorModeForRenderPass()),r.setStencilMode(Kr.disabled);const d=l.renderingMode==="3d"?new Dr(y.context.gl.LEQUAL,Dr.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Dr.ReadOnly);r.setDepthMode(d),l.render(r.gl,y.transform.customLayerMatrix()),r.setDirty(),y.setBaseState(),r.bindFramebuffer.set(null)}})(A,0,F)}}translatePosMatrix(A,I,F,O,y){if(!F[0]&&!F[1])return A;const s=y?O==="map"?this.transform.angle:0:O==="viewport"?-this.transform.angle:0;if(s){const l=Math.sin(s),d=Math.cos(s);F=[F[0]*d-F[1]*l,F[0]*l+F[1]*d]}const i=[y?F[0]:Fe(I,F[0],this.transform.zoom),y?F[1]:Fe(I,F[1],this.transform.zoom),0],r=new Float32Array(16);return a.$(r,A,i),r}saveTileTexture(A){const I=this._tileTextures[A.size[0]];I?I.push(A):this._tileTextures[A.size[0]]=[A]}getTileTexture(A){const I=this._tileTextures[A];return I&&I.length>0?I.pop():null}isPatternMissing(A){if(!A)return!1;if(!A.from||!A.to)return!0;const I=this.imageManager.getPattern(A.from.toString()),F=this.imageManager.getPattern(A.to.toString());return!I||!F}useProgram(A,I){this.cache=this.cache||{};const F=A+(I?I.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[F]||(this.cache[F]=new Vs(this.context,Vt[A],I,Ua[A],this._showOverdrawInspector,this.style.map.terrain)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const A=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(A.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _t(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:A,drawingBufferHeight:I}=this.context.gl;return this.width!==A||this.height!==I}}class Rr{constructor(A,I){this.points=A,this.planes=I}static fromInvProjectionMatrix(A,I,F){const O=Math.pow(2,F),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const r=1/(i=a.ag([],i,A))[3]/I*O;return a.b3(i,i,[r,r,1/i[3],r])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(i=>{const r=function(w,T){var B=T[0],j=T[1],Y=T[2],ue=B*B+j*j+Y*Y;return ue>0&&(ue=1/Math.sqrt(ue)),w[0]=T[0]*ue,w[1]=T[1]*ue,w[2]=T[2]*ue,w}([],function(w,T,B){var j=T[0],Y=T[1],ue=T[2],Se=B[0],Te=B[1],Re=B[2];return w[0]=Y*Re-ue*Te,w[1]=ue*Se-j*Re,w[2]=j*Te-Y*Se,w}([],Ge([],y[i[0]],y[i[1]]),Ge([],y[i[2]],y[i[1]]))),l=-((d=r)[0]*(_=y[i[1]])[0]+d[1]*_[1]+d[2]*_[2]);var d,_;return r.concat(l)});return new Rr(y,s)}}class ha{constructor(A,I){this.min=A,this.max=I,this.center=function(F,O,y){return F[0]=.5*O[0],F[1]=.5*O[1],F[2]=.5*O[2],F}([],function(F,O,y){return F[0]=O[0]+y[0],F[1]=O[1]+y[1],F[2]=O[2]+y[2],F}([],this.min,this.max))}quadrant(A){const I=[A%2==0,A<2],F=Bt(this.min),O=Bt(this.max);for(let y=0;y<I.length;y++)F[y]=I[y]?this.min[y]:this.center[y],O[y]=I[y]?this.center[y]:this.max[y];return O[2]=this.max[2],new ha(F,O)}distanceX(A){return Math.max(Math.min(this.max[0],A[0]),this.min[0])-A[0]}distanceY(A){return Math.max(Math.min(this.max[1],A[1]),this.min[1])-A[1]}intersects(A){const I=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let F=!0;for(let O=0;O<A.planes.length;O++){const y=A.planes[O];let s=0;for(let i=0;i<I.length;i++)a.b4(y,I[i])>=0&&s++;if(s===0)return 0;s!==I.length&&(F=!1)}if(F)return 2;for(let O=0;O<3;O++){let y=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let i=0;i<A.points.length;i++){const r=A.points[i][O]-this.min[O];y=Math.min(y,r),s=Math.max(s,r)}if(s<0||y>this.max[O]-this.min[O])return 0}return 1}}class fo{constructor(A=0,I=0,F=0,O=0){if(isNaN(A)||A<0||isNaN(I)||I<0||isNaN(F)||F<0||isNaN(O)||O<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=A,this.bottom=I,this.left=F,this.right=O}interpolate(A,I,F){return I.top!=null&&A.top!=null&&(this.top=a.B.number(A.top,I.top,F)),I.bottom!=null&&A.bottom!=null&&(this.bottom=a.B.number(A.bottom,I.bottom,F)),I.left!=null&&A.left!=null&&(this.left=a.B.number(A.left,I.left,F)),I.right!=null&&A.right!=null&&(this.right=a.B.number(A.right,I.right,F)),this}getCenter(A,I){const F=a.ad((this.left+A-this.right)/2,0,A),O=a.ad((this.top+I-this.bottom)/2,0,I);return new a.P(F,O)}equals(A){return this.top===A.top&&this.bottom===A.bottom&&this.left===A.left&&this.right===A.right}clone(){return new fo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ea{constructor(A,I,F,O,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||!!y,this._minZoom=A||0,this._maxZoom=I||22,this._minPitch=F??0,this._maxPitch=O??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fo,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const A=new ea(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return A.apply(this),A}apply(A){this.tileSize=A.tileSize,this.latRange=A.latRange,this.width=A.width,this.height=A.height,this._center=A._center,this._elevation=A._elevation,this._minEleveationForCurrentTile=A._minEleveationForCurrentTile,this.zoom=A.zoom,this.angle=A.angle,this._fov=A._fov,this._pitch=A._pitch,this._unmodified=A._unmodified,this._edgeInsets=A._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(A){this._minZoom!==A&&(this._minZoom=A,this.zoom=Math.max(this.zoom,A))}get maxZoom(){return this._maxZoom}set maxZoom(A){this._maxZoom!==A&&(this._maxZoom=A,this.zoom=Math.min(this.zoom,A))}get minPitch(){return this._minPitch}set minPitch(A){this._minPitch!==A&&(this._minPitch=A,this.pitch=Math.max(this.pitch,A))}get maxPitch(){return this._maxPitch}set maxPitch(A){this._maxPitch!==A&&(this._maxPitch=A,this.pitch=Math.min(this.pitch,A))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(A){A===void 0?A=!0:A===null&&(A=!1),this._renderWorldCopies=A}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(A){const I=-a.b5(A,-180,180)*Math.PI/180;this.angle!==I&&(this._unmodified=!1,this.angle=I,this._calcMatrices(),this.rotationMatrix=function(){var F=new a.A(4);return a.A!=Float32Array&&(F[1]=0,F[2]=0),F[0]=1,F[3]=1,F}(),function(F,O,y){var s=O[0],i=O[1],r=O[2],l=O[3],d=Math.sin(y),_=Math.cos(y);F[0]=s*_+r*d,F[1]=i*_+l*d,F[2]=s*-d+r*_,F[3]=i*-d+l*_}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(A){const I=a.ad(A,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==I&&(this._unmodified=!1,this._pitch=I,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(A){A=Math.max(.01,Math.min(60,A)),this._fov!==A&&(this._unmodified=!1,this._fov=A/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(A){const I=Math.min(Math.max(A,this.minZoom),this.maxZoom);this._zoom!==I&&(this._unmodified=!1,this._zoom=I,this.tileZoom=Math.max(0,Math.floor(I)),this.scale=this.zoomScale(I),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(A){A.lat===this._center.lat&&A.lng===this._center.lng||(this._unmodified=!1,this._center=A,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(A){A!==this._elevation&&(this._elevation=A,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(A){this._edgeInsets.equals(A)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,A,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(A){return this._edgeInsets.equals(A)}interpolatePadding(A,I,F){this._unmodified=!1,this._edgeInsets.interpolate(A,I,F),this._constrain(),this._calcMatrices()}coveringZoomLevel(A){const I=(A.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/A.tileSize));return Math.max(0,I)}getVisibleUnwrappedCoordinates(A){const I=[new a.b6(0,A)];if(this._renderWorldCopies){const F=this.pointCoordinate(new a.P(0,0)),O=this.pointCoordinate(new a.P(this.width,0)),y=this.pointCoordinate(new a.P(this.width,this.height)),s=this.pointCoordinate(new a.P(0,this.height)),i=Math.floor(Math.min(F.x,O.x,y.x,s.x)),r=Math.floor(Math.max(F.x,O.x,y.x,s.x)),l=1;for(let d=i-l;d<=r+l;d++)d!==0&&I.push(new a.b6(d,A))}return I}coveringTiles(A){var I,F;let O=this.coveringZoomLevel(A);const y=O;if(A.minzoom!==void 0&&O<A.minzoom)return[];A.maxzoom!==void 0&&O>A.maxzoom&&(O=A.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),i=a.U.fromLngLat(this.center),r=Math.pow(2,O),l=[r*s.x,r*s.y,0],d=[r*i.x,r*i.y,0],_=Rr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,O);let w=A.minzoom||0;!A.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(w=O);const T=A.terrain?2/Math.min(this.tileSize,A.tileSize)*this.tileSize:3,B=Te=>({aabb:new ha([Te*r,0,0],[(Te+1)*r,r,0]),zoom:0,x:0,y:0,wrap:Te,fullyVisible:!1}),j=[],Y=[],ue=O,Se=A.reparseOverscaled?y:O;if(this._renderWorldCopies)for(let Te=1;Te<=3;Te++)j.push(B(-Te)),j.push(B(Te));for(j.push(B(0));j.length>0;){const Te=j.pop(),Re=Te.x,Be=Te.y;let $e=Te.fullyVisible;if(!$e){const wt=Te.aabb.intersects(_);if(wt===0)continue;$e=wt===2}const vt=A.terrain?l:d,ot=Te.aabb.distanceX(vt),ct=Te.aabb.distanceY(vt),Et=Math.max(Math.abs(ot),Math.abs(ct));if(Te.zoom===ue||Et>T+(1<<ue-Te.zoom)-2&&Te.zoom>=w){const wt=ue-Te.zoom,ri=l[0]-.5-(Re<<wt),Xt=l[1]-.5-(Be<<wt);Y.push({tileID:new a.O(Te.zoom===ue?Se:Te.zoom,Te.wrap,Te.zoom,Re,Be),distanceSq:ni([d[0]-.5-Re,d[1]-.5-Be]),tileDistanceToCamera:Math.sqrt(ri*ri+Xt*Xt)})}else for(let wt=0;wt<4;wt++){const ri=(Re<<1)+wt%2,Xt=(Be<<1)+(wt>>1),Jt=Te.zoom+1;let si=Te.aabb.quadrant(wt);if(A.terrain){const ji=new a.O(Jt,Te.wrap,Jt,ri,Xt),Zi=A.terrain.getMinMaxElevation(ji),Ii=(I=Zi.minElevation)!==null&&I!==void 0?I:this.elevation,Vi=(F=Zi.maxElevation)!==null&&F!==void 0?F:this.elevation;si=new ha([si.min[0],si.min[1],Ii],[si.max[0],si.max[1],Vi])}j.push({aabb:si,zoom:Jt,x:ri,y:Xt,wrap:Te.wrap,fullyVisible:$e})}}return Y.sort((Te,Re)=>Te.distanceSq-Re.distanceSq).map(Te=>Te.tileID)}resize(A,I){this.width=A,this.height=I,this.pixelsToGLUnits=[2/A,-2/I],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(A){return Math.pow(2,A)}scaleZoom(A){return Math.log(A)/Math.LN2}project(A){const I=a.ad(A.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.P(a.G(A.lng)*this.worldSize,a.H(I)*this.worldSize)}unproject(A){return new a.U(A.x/this.worldSize,A.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(A){const I=this.pointLocation(this.centerPoint,A),F=A.getElevationForLngLatZoom(I,this.tileZoom);if(!(this.elevation-F))return;const O=this.getCameraPosition(),y=a.U.fromLngLat(O.lngLat,O.altitude),s=a.U.fromLngLat(I,F),i=y.x-s.x,r=y.y-s.y,l=y.z-s.z,d=Math.sqrt(i*i+r*r+l*l),_=this.scaleZoom(this.cameraToCenterDistance/d/this.tileSize);this._elevation=F,this._center=I,this.zoom=_}setLocationAtPoint(A,I){const F=this.pointCoordinate(I),O=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(A),s=new a.U(y.x-(F.x-O.x),y.y-(F.y-O.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(A,I){return I?this.coordinatePoint(this.locationCoordinate(A),I.getElevationForLngLatZoom(A,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(A))}pointLocation(A,I){return this.coordinateLocation(this.pointCoordinate(A,I))}locationCoordinate(A){return a.U.fromLngLat(A)}coordinateLocation(A){return A&&A.toLngLat()}pointCoordinate(A,I){if(I){const w=I.pointCoordinate(A);if(w!=null)return w}const F=[A.x,A.y,0,1],O=[A.x,A.y,1,1];a.ag(F,F,this.pixelMatrixInverse),a.ag(O,O,this.pixelMatrixInverse);const y=F[3],s=O[3],i=F[1]/y,r=O[1]/s,l=F[2]/y,d=O[2]/s,_=l===d?0:(0-l)/(d-l);return new a.U(a.B.number(F[0]/y,O[0]/s,_)/this.worldSize,a.B.number(i,r,_)/this.worldSize)}coordinatePoint(A,I=0,F=this.pixelMatrix){const O=[A.x*this.worldSize,A.y*this.worldSize,I,1];return a.ag(O,O,F),new a.P(O[0]/O[3],O[1]/O[3])}getBounds(){const A=Math.max(0,this.height/2-this.getHorizon());return new Gi().extend(this.pointLocation(new a.P(0,A))).extend(this.pointLocation(new a.P(this.width,A))).extend(this.pointLocation(new a.P(this.width,this.height))).extend(this.pointLocation(new a.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Gi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(A){A?(this.lngRange=[A.getWest(),A.getEast()],this.latRange=[A.getSouth(),A.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(A,I=!1){const F=A.key,O=I?this._alignedPosMatrixCache:this._posMatrixCache;if(O[F])return O[F];const y=A.canonical,s=this.worldSize/this.zoomScale(y.z),i=y.x+Math.pow(2,y.z)*A.wrap,r=a.ao(new Float64Array(16));return a.$(r,r,[i*s,y.y*s,0]),a.a0(r,r,[s/a.N,s/a.N,1]),a.a1(r,I?this.alignedProjMatrix:this.projMatrix,r),O[F]=new Float32Array(r),O[F]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let A,I,F,O,y=-90,s=90,i=-180,r=180;const l=this.size,d=this._unmodified;if(this.latRange){const T=this.latRange;y=a.H(T[1])*this.worldSize,s=a.H(T[0])*this.worldSize,A=s-y<l.y?l.y/(s-y):0}if(this.lngRange){const T=this.lngRange;i=a.b5(a.G(T[0])*this.worldSize,0,this.worldSize),r=a.b5(a.G(T[1])*this.worldSize,0,this.worldSize),r<i&&(r+=this.worldSize),I=r-i<l.x?l.x/(r-i):0}const _=this.point,w=Math.max(I||0,A||0);if(w)return this.center=this.unproject(new a.P(I?(r+i)/2:_.x,A?(s+y)/2:_.y)),this.zoom+=this.scaleZoom(w),this._unmodified=d,void(this._constraining=!1);if(this.latRange){const T=_.y,B=l.y/2;T-B<y&&(O=y+B),T+B>s&&(O=s-B)}if(this.lngRange){const T=(i+r)/2,B=a.b5(_.x,T-this.worldSize/2,T+this.worldSize/2),j=l.x/2;B-j<i&&(F=i+j),B+j>r&&(F=r-j)}F===void 0&&O===void 0||(this.center=this.unproject(new a.P(F!==void 0?F:_.x,O!==void 0?O:_.y)).wrap()),this._unmodified=d,this._constraining=!1}_calcMatrices(){if(!this.height)return;const A=this.centerOffset,I=this.point.x,F=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.b7(1,this.center.lat)*this.worldSize;let O=a.ao(new Float64Array(16));a.a0(O,O,[this.width/2,-this.height/2,1]),a.$(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=a.ao(new Float64Array(16)),a.a0(O,O,[1,-1,1]),a.$(O,O,[-1,-1,0]),a.a0(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this._minEleveationForCurrentTile),i=y-s*this._pixelPerMeter/Math.cos(this._pitch),r=s<0?i:y,l=Math.PI/2+this._pitch,d=this._fov*(.5+A.y/this.height),_=Math.sin(d)*r/Math.sin(a.ad(Math.PI-l-d,.01,Math.PI-.01)),w=this.getHorizon(),T=2*Math.atan(w/this.cameraToCenterDistance)*(.5+A.y/(2*w)),B=Math.sin(T)*r/Math.sin(a.ad(Math.PI-l-T,.01,Math.PI-.01)),j=Math.min(_,B),Y=1.01*(Math.cos(Math.PI/2-this._pitch)*j+r),ue=this.height/50;O=new Float64Array(16),a.b8(O,this._fov,this.width/this.height,ue,Y),O[8]=2*-A.x/this.width,O[9]=2*A.y/this.height,a.a0(O,O,[1,-1,1]),a.$(O,O,[0,0,-this.cameraToCenterDistance]),a.b9(O,O,this._pitch),a.ae(O,O,this.angle),a.$(O,O,[-I,-F,0]),this.mercatorMatrix=a.a0([],O,[this.worldSize,this.worldSize,this.worldSize]),a.a0(O,O,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.a1(new Float64Array(16),this.labelPlaneMatrix,O),a.$(O,O,[0,0,-this.elevation]),this.projMatrix=O,this.invProjMatrix=a.as([],O),this.pixelMatrix3D=a.a1(new Float64Array(16),this.labelPlaneMatrix,O);const Se=this.width%2/2,Te=this.height%2/2,Re=Math.cos(this.angle),Be=Math.sin(this.angle),$e=I-Math.round(I)+Re*Se+Be*Te,vt=F-Math.round(F)+Re*Te+Be*Se,ot=new Float64Array(O);if(a.$(ot,ot,[$e>.5?$e-1:$e,vt>.5?vt-1:vt,0]),this.alignedProjMatrix=ot,O=a.as(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const A=this.pointCoordinate(new a.P(0,0)),I=[A.x*this.worldSize,A.y*this.worldSize,0,1];return a.ag(I,I,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const A=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,A))}getCameraQueryGeometry(A){const I=this.getCameraPoint();if(A.length===1)return[A[0],I];{let F=I.x,O=I.y,y=I.x,s=I.y;for(const i of A)F=Math.min(F,i.x),O=Math.min(O,i.y),y=Math.max(y,i.x),s=Math.max(s,i.y);return[new a.P(F,O),new a.P(y,O),new a.P(y,s),new a.P(F,s),new a.P(F,O)]}}}function Sa(Z,A){let I,F=!1,O=null,y=null;const s=()=>{O=null,F&&(Z.apply(y,I),O=setTimeout(s,A),F=!1)};return(...i)=>(F=!0,y=this,I=i,O||s(),O)}class ka{constructor(A){this._getCurrentHash=()=>{const I=window.location.hash.replace("#","");if(this._hashName){let F;return I.split("&").map(O=>O.split("=")).forEach(O=>{O[0]===this._hashName&&(F=O)}),(F&&F[1]||"").split("/")}return I.split("/")},this._onHashChange=()=>{const I=this._getCurrentHash();if(I.length>=3&&!I.some(F=>isNaN(F))){const F=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(I[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+I[2],+I[1]],zoom:+I[0],bearing:F,pitch:+(I[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const I=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,I)}catch{}},this._updateHash=Sa(this._updateHashUnthrottled,300),this._hashName=A&&encodeURIComponent(A)}addTo(A){return this._map=A,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(A){const I=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,O=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,O),s=Math.round(I.lng*y)/y,i=Math.round(I.lat*y)/y,r=this._map.getBearing(),l=this._map.getPitch();let d="";if(d+=A?`/${s}/${i}/${F}`:`${F}/${i}/${s}`,(r||l)&&(d+="/"+Math.round(10*r)/10),l&&(d+=`/${Math.round(l)}`),this._hashName){const _=this._hashName;let w=!1;const T=window.location.hash.slice(1).split("&").map(B=>{const j=B.split("=")[0];return j===_?(w=!0,`${j}=${d}`):B}).filter(B=>B);return w||T.push(`${_}=${d}`),`#${T.join("&")}`}return`#${d}`}}const Wa={linearity:.3,easing:a.ba(0,0,.3,1)},ll=a.e({deceleration:2500,maxSpeed:1400},Wa),ou=a.e({deceleration:20,maxSpeed:1400},Wa),gl=a.e({deceleration:1e3,maxSpeed:360},Wa),io=a.e({deceleration:1e3,maxSpeed:90},Wa);class mi{constructor(A){this._map=A,this.clear()}clear(){this._inertiaBuffer=[]}record(A){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.h.now(),settings:A})}_drainInertiaBuffer(){const A=this._inertiaBuffer,I=a.h.now();for(;A.length>0&&I-A[0].time>160;)A.shift()}_onMoveEnd(A){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const I={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)I.zoom+=y.zoomDelta||0,I.bearing+=y.bearingDelta||0,I.pitch+=y.pitchDelta||0,y.panDelta&&I.pan._add(y.panDelta),y.around&&(I.around=y.around),y.pinchAround&&(I.pinchAround=y.pinchAround);const F=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,O={};if(I.pan.mag()){const y=Di(I.pan.mag(),F,a.e({},ll,A||{}));O.offset=I.pan.mult(y.amount/I.pan.mag()),O.center=this._map.transform.center,Ni(O,y)}if(I.zoom){const y=Di(I.zoom,F,ou);O.zoom=this._map.transform.zoom+y.amount,Ni(O,y)}if(I.bearing){const y=Di(I.bearing,F,gl);O.bearing=this._map.transform.bearing+a.ad(y.amount,-179,179),Ni(O,y)}if(I.pitch){const y=Di(I.pitch,F,io);O.pitch=this._map.transform.pitch+y.amount,Ni(O,y)}if(O.zoom||O.bearing){const y=I.pinchAround===void 0?I.around:I.pinchAround;O.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),a.e(O,{noMoveStart:!0})}}function Ni(Z,A){(!Z.duration||Z.duration<A.duration)&&(Z.duration=A.duration,Z.easing=A.easing)}function Di(Z,A,I){const{maxSpeed:F,linearity:O,deceleration:y}=I,s=a.ad(Z*O/(A/1e3),-F,F),i=Math.abs(s)/(y*O);return{easing:I.easing,duration:1e3*i,amount:s*(i/2)}}class Ot extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,I,F,O={}){const y=W.mousePos(I.getCanvasContainer(),F),s=I.unproject(y);super(A,a.e({point:y,lngLat:s,originalEvent:F},O)),this._defaultPrevented=!1,this.target=I}}class ei extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,I,F){const O=A==="touchend"?F.changedTouches:F.touches,y=W.touchPos(I.getCanvasContainer(),O),s=y.map(r=>I.unproject(r)),i=y.reduce((r,l,d,_)=>r.add(l.div(_.length)),new a.P(0,0));super(A,{points:y,point:i,lngLats:s,lngLat:I.unproject(i),originalEvent:F}),this._defaultPrevented=!1}}class xi extends a.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(A,I,F){super(A,{originalEvent:F}),this._defaultPrevented=!1}}class Oi{constructor(A,I){this._map=A,this._clickTolerance=I.clickTolerance}reset(){delete this._mousedownPos}wheel(A){return this._firePreventable(new xi(A.type,this._map,A))}mousedown(A,I){return this._mousedownPos=I,this._firePreventable(new Ot(A.type,this._map,A))}mouseup(A){this._map.fire(new Ot(A.type,this._map,A))}click(A,I){this._mousedownPos&&this._mousedownPos.dist(I)>=this._clickTolerance||this._map.fire(new Ot(A.type,this._map,A))}dblclick(A){return this._firePreventable(new Ot(A.type,this._map,A))}mouseover(A){this._map.fire(new Ot(A.type,this._map,A))}mouseout(A){this._map.fire(new Ot(A.type,this._map,A))}touchstart(A){return this._firePreventable(new ei(A.type,this._map,A))}touchmove(A){this._map.fire(new ei(A.type,this._map,A))}touchend(A){this._map.fire(new ei(A.type,this._map,A))}touchcancel(A){this._map.fire(new ei(A.type,this._map,A))}_firePreventable(A){if(this._map.fire(A),A.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ln{constructor(A){this._map=A}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(A){this._map.fire(new Ot(A.type,this._map,A))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ot("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(A){this._delayContextMenu?this._contextMenuEvent=A:this._ignoreContextMenu||this._map.fire(new Ot(A.type,this._map,A)),this._map.listens("contextmenu")&&A.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Un{constructor(A){this._map=A}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(A){return this.transform.pointLocation(a.P.convert(A),this._map.terrain)}}class or{constructor(A,I){this._map=A,this._tr=new Un(A),this._el=A.getCanvasContainer(),this._container=A.getContainer(),this._clickTolerance=I.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(A,I){this.isEnabled()&&A.shiftKey&&A.button===0&&(W.disableDrag(),this._startPos=this._lastPos=I,this._active=!0)}mousemoveWindow(A,I){if(!this._active)return;const F=I;if(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)return;const O=this._startPos;this._lastPos=F,this._box||(this._box=W.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",A));const y=Math.min(O.x,F.x),s=Math.max(O.x,F.x),i=Math.min(O.y,F.y),r=Math.max(O.y,F.y);W.setTransform(this._box,`translate(${y}px,${i}px)`),this._box.style.width=s-y+"px",this._box.style.height=r-i+"px"}mouseupWindow(A,I){if(!this._active||A.button!==0)return;const F=this._startPos,O=I;if(this.reset(),W.suppressClick(),F.x!==O.x||F.y!==O.y)return this._map.fire(new a.k("boxzoomend",{originalEvent:A})),{cameraAnimation:y=>y.fitScreenCoordinates(F,O,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",A)}keydown(A){this._active&&A.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",A))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(W.remove(this._box),this._box=null),W.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(A,I){return this._map.fire(new a.k(A,{originalEvent:I}))}}function Yn(Z,A){if(Z.length!==A.length)throw new Error(`The number of touches and points are not equal - touches ${Z.length}, points ${A.length}`);const I={};for(let F=0;F<Z.length;F++)I[Z[F].identifier]=A[F];return I}class qs{constructor(A){this.reset(),this.numTouches=A.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(A,I,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=A.timeStamp),F.length===this.numTouches&&(this.centroid=function(O){const y=new a.P(0,0);for(const s of O)y._add(s);return y.div(O.length)}(I),this.touches=Yn(F,I)))}touchmove(A,I,F){if(this.aborted||!this.centroid)return;const O=Yn(F,I);for(const y in this.touches){const s=O[y];(!s||s.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(A,I,F){if((!this.centroid||A.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){const O=!this.aborted&&this.centroid;if(this.reset(),O)return O}}}class Ms{constructor(A){this.singleTap=new qs(A),this.numTaps=A.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(A,I,F){this.singleTap.touchstart(A,I,F)}touchmove(A,I,F){this.singleTap.touchmove(A,I,F)}touchend(A,I,F){const O=this.singleTap.touchend(A,I,F);if(O){const y=A.timeStamp-this.lastTime<500,s=!this.lastTap||this.lastTap.dist(O)<30;if(y&&s||this.reset(),this.count++,this.lastTime=A.timeStamp,this.lastTap=O,this.count===this.numTaps)return this.reset(),O}}}class As{constructor(A){this._tr=new Un(A),this._zoomIn=new Ms({numTouches:1,numTaps:2}),this._zoomOut=new Ms({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(A,I,F){this._zoomIn.touchstart(A,I,F),this._zoomOut.touchstart(A,I,F)}touchmove(A,I,F){this._zoomIn.touchmove(A,I,F),this._zoomOut.touchmove(A,I,F)}touchend(A,I,F){const O=this._zoomIn.touchend(A,I,F),y=this._zoomOut.touchend(A,I,F),s=this._tr;return O?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom+1,around:s.unproject(O)},{originalEvent:A})}):y?(this._active=!0,A.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:i=>i.easeTo({duration:300,zoom:s.zoom-1,around:s.unproject(y)},{originalEvent:A})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xa{constructor(A){this._enabled=!!A.enable,this._moveStateManager=A.moveStateManager,this._clickTolerance=A.clickTolerance||1,this._moveFunction=A.move,this._activateOnStart=!!A.activateOnStart,A.assignEvents(this),this.reset()}reset(A){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(A)}_move(...A){const I=this._moveFunction(...A);if(I.bearingDelta||I.pitchDelta||I.around||I.panDelta)return this._active=!0,I}dragStart(A,I){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(A)&&(this._moveStateManager.startMove(A),this._lastPoint=I.length?I[0]:I,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(A,I){if(!this.isEnabled())return;const F=this._lastPoint;if(!F)return;if(A.preventDefault(),!this._moveStateManager.isValidMoveEvent(A))return void this.reset(A);const O=I.length?I[0]:I;return!this._moved&&O.dist(F)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=O,this._move(F,O))}dragEnd(A){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(A)&&(this._moved&&W.suppressClick(),this.reset(A))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const po={0:1,2:2};class rs{constructor(A){this._correctEvent=A.checkCorrectEvent}startMove(A){const I=W.mouseButton(A);this._eventButton=I}endMove(A){delete this._eventButton}isValidStartEvent(A){return this._correctEvent(A)}isValidMoveEvent(A){return!function(I,F){const O=po[F];return I.buttons===void 0||(I.buttons&O)!==O}(A,this._eventButton)}isValidEndEvent(A){return W.mouseButton(A)===this._eventButton}}class Qu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(A){return A.targetTouches.length===1}_isSameTouchEvent(A){return A.targetTouches[0].identifier===this._firstTouch}startMove(A){this._firstTouch=A.targetTouches[0].identifier}endMove(A){delete this._firstTouch}isValidStartEvent(A){return this._isOneFingerTouch(A)}isValidMoveEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}isValidEndEvent(A){return this._isOneFingerTouch(A)&&this._isSameTouchEvent(A)}}const zu=Z=>{Z.mousedown=Z.dragStart,Z.mousemoveWindow=Z.dragMove,Z.mouseup=Z.dragEnd,Z.contextmenu=function(A){A.preventDefault()}},mo=({enable:Z,clickTolerance:A,bearingDegreesPerPixelMoved:I=.8})=>{const F=new rs({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Xa({clickTolerance:A,move:(O,y)=>({bearingDelta:(y.x-O.x)*I}),moveStateManager:F,enable:Z,assignEvents:zu})},Ml=({enable:Z,clickTolerance:A,pitchDegreesPerPixelMoved:I=-.5})=>{const F=new rs({checkCorrectEvent:O=>W.mouseButton(O)===0&&O.ctrlKey||W.mouseButton(O)===2});return new Xa({clickTolerance:A,move:(O,y)=>({pitchDelta:(y.y-O.y)*I}),moveStateManager:F,enable:Z,assignEvents:zu})};class Pn{constructor(A,I){this._minTouches=A.cooperativeGestures?2:1,this._clickTolerance=A.clickTolerance||1,this._map=I,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(A,I,F){return this._calculateTransform(A,I,F)}touchmove(A,I,F){if(this._map._cooperativeGestures&&(this._minTouches===2&&F.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(A,!1,F.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(F.length<this._minTouches))return A.preventDefault(),this._calculateTransform(A,I,F)}touchend(A,I,F){this._calculateTransform(A,I,F),this._active&&F.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(A,I,F){F.length>0&&(this._active=!0);const O=Yn(F,I),y=new a.P(0,0),s=new a.P(0,0);let i=0;for(const l in O){const d=O[l],_=this._touches[l];_&&(y._add(d),s._add(d.sub(_)),i++,O[l]=d)}if(this._touches=O,i<this._minTouches||!s.mag())return;const r=s.div(i);return this._sum._add(r),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(i),panDelta:r}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ma{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(A,I,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([I[0],I[1]]))}touchmove(A,I,F){if(!this._firstTwoTouches)return;A.preventDefault();const[O,y]=this._firstTwoTouches,s=bn(F,I,O),i=bn(F,I,y);if(!s||!i)return;const r=this._aroundCenter?null:s.add(i).div(2);return this._move([s,i],r,A)}touchend(A,I,F){if(!this._firstTwoTouches)return;const[O,y]=this._firstTwoTouches,s=bn(F,I,O),i=bn(F,I,y);s&&i||(this._active&&W.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(A){this._enabled=!0,this._aroundCenter=!!A&&A.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function bn(Z,A,I){for(let F=0;F<Z.length;F++)if(Z[F].identifier===I)return A[F]}function Fo(Z,A){return Math.log(Z/A)/Math.LN2}class Nl extends Ma{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(A){this._startDistance=this._distance=A[0].dist(A[1])}_move(A,I){const F=this._distance;if(this._distance=A[0].dist(A[1]),this._active||!(Math.abs(Fo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fo(this._distance,F),pinchAround:I}}}function Sn(Z,A){return 180*Z.angleWith(A)/Math.PI}class Hl extends Ma{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(A){this._startVector=this._vector=A[0].sub(A[1]),this._minDiameter=A[0].dist(A[1])}_move(A,I){const F=this._vector;if(this._vector=A[0].sub(A[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Sn(this._vector,F),pinchAround:I}}_isBelowThreshold(A){this._minDiameter=Math.min(this._minDiameter,A.mag());const I=25/(Math.PI*this._minDiameter)*360,F=Sn(A,this._startVector);return Math.abs(F)<I}}function In(Z){return Math.abs(Z.y)>Math.abs(Z.x)}class _l extends Ma{constructor(A){super(),this._map=A}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(A,I,F){super.touchstart(A,I,F),this._currentTouchCount=F.length}_start(A){this._lastPoints=A,In(A[0].sub(A[1]))&&(this._valid=!1)}_move(A,I,F){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const O=A[0].sub(this._lastPoints[0]),y=A[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(O,y,F.timeStamp),this._valid?(this._lastPoints=A,this._active=!0,{pitchDelta:(O.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(A,I,F){if(this._valid!==void 0)return this._valid;const O=A.mag()>=2,y=I.mag()>=2;if(!O&&!y)return;if(!O||!y)return this._firstMove===void 0&&(this._firstMove=F),F-this._firstMove<100&&void 0;const s=A.y>0==I.y>0;return In(A)&&In(I)&&s}}const lu={panStep:100,bearingStep:15,pitchStep:10};class Ru{constructor(A){this._tr=new Un(A);const I=lu;this._panStep=I.panStep,this._bearingStep=I.bearingStep,this._pitchStep=I.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(A){if(A.altKey||A.ctrlKey||A.metaKey)return;let I=0,F=0,O=0,y=0,s=0;switch(A.keyCode){case 61:case 107:case 171:case 187:I=1;break;case 189:case 109:case 173:I=-1;break;case 37:A.shiftKey?F=-1:(A.preventDefault(),y=-1);break;case 39:A.shiftKey?F=1:(A.preventDefault(),y=1);break;case 38:A.shiftKey?O=1:(A.preventDefault(),s=-1);break;case 40:A.shiftKey?O=-1:(A.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(F=0,O=0),{cameraAnimation:i=>{const r=this._tr;i.easeTo({duration:300,easeId:"keyboardHandler",easing:Vl,zoom:I?Math.round(r.zoom)+I*(A.shiftKey?2:1):r.zoom,bearing:r.bearing+F*this._bearingStep,pitch:r.pitch+O*this._pitchStep,offset:[-y*this._panStep,-s*this._panStep],center:r.center},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Vl(Z){return Z*(2-Z)}const yl=4.000244140625;class ta{constructor(A,I){this._onTimeout=F=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(F)},this._map=A,this._tr=new Un(A),this._el=A.getCanvasContainer(),this._triggerRenderFrame=I,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(A){this._defaultZoomRate=A}setWheelZoomRate(A){this._wheelZoomRate=A}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(A){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!A&&A.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(A){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!A[this._map._metaKey])return;A.preventDefault()}let I=A.deltaMode===WheelEvent.DOM_DELTA_LINE?40*A.deltaY:A.deltaY;const F=a.h.now(),O=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,I!==0&&I%yl==0?this._type="wheel":I!==0&&Math.abs(I)<4?this._type="trackpad":O>400?(this._type=null,this._lastValue=I,this._timeout=setTimeout(this._onTimeout,40,A)):this._type||(this._type=Math.abs(O*I)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,I+=this._lastValue)),A.shiftKey&&I&&(I/=4),this._type&&(this._lastWheelEvent=A,this._delta-=I,this._active||this._start(A)),A.preventDefault()}_start(A){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const I=W.mousePos(this._el,A),F=this._tr;this._around=a.L.convert(this._aroundCenter?F.center:F.unproject(I)),this._aroundPoint=F.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const A=this._tr.transform;if(this._delta!==0){const i=this._type==="wheel"&&Math.abs(this._delta)>yl?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&r!==0&&(r=1/r);const l=typeof this._targetZoom=="number"?A.zoomScale(this._targetZoom):A.scale;this._targetZoom=Math.min(A.maxZoom,Math.max(A.minZoom,A.scaleZoom(l*r))),this._type==="wheel"&&(this._startZoom=A.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const I=typeof this._targetZoom=="number"?this._targetZoom:A.zoom,F=this._startZoom,O=this._easing;let y,s=!1;if(this._type==="wheel"&&F&&O){const i=Math.min((a.h.now()-this._lastWheelEventTime)/200,1),r=O(i);y=a.B.number(F,I,r),i<1?this._frameId||(this._frameId=!0):s=!0}else y=I,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:y-A.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(A){let I=a.bb;if(this._prevEase){const F=this._prevEase,O=(a.h.now()-F.start)/F.duration,y=F.easing(O+.01)-F.easing(O),s=.27/Math.sqrt(y*y+1e-4)*.01,i=Math.sqrt(.0729-s*s);I=a.ba(s,i,.25,1)}return this._prevEase={start:a.h.now(),duration:A,easing:I},I}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ac{constructor(A,I){this._clickZoom=A,this._tapZoom=I}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wu{constructor(A){this._tr=new Un(A),this.reset()}reset(){this._active=!1}dblclick(A,I){return A.preventDefault(),{cameraAnimation:F=>{F.easeTo({duration:300,zoom:this._tr.zoom+(A.shiftKey?-1:1),around:this._tr.unproject(I)},{originalEvent:A})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jl{constructor(){this._tap=new Ms({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(A,I,F){if(!this._swipePoint)if(this._tapTime){const O=I[0],y=A.timeStamp-this._tapTime<500,s=this._tapPoint.dist(O)<30;y&&s?F.length>0&&(this._swipePoint=O,this._swipeTouch=F[0].identifier):this.reset()}else this._tap.touchstart(A,I,F)}touchmove(A,I,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;const O=I[0],y=O.y-this._swipePoint.y;return this._swipePoint=O,A.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(A,I,F)}touchend(A,I,F){if(this._tapTime)this._swipePoint&&F.length===0&&this.reset();else{const O=this._tap.touchend(A,I,F);O&&(this._tapTime=A.timeStamp,this._tapPoint=O)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fs{constructor(A,I,F){this._el=A,this._mousePan=I,this._touchPan=F}enable(A){this._inertiaOptions=A||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _a{constructor(A,I,F){this._pitchWithRotate=A.pitchWithRotate,this._mouseRotate=I,this._mousePitch=F}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ko{constructor(A,I,F,O){this._el=A,this._touchZoom=I,this._touchRotate=F,this._tapDragZoom=O,this._rotationDisabled=!1,this._enabled=!0}enable(A){this._touchZoom.enable(A),this._rotationDisabled||this._touchRotate.enable(A),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const gu=Z=>Z.zoom||Z.drag||Z.pitch||Z.rotate;class Fu extends a.k{}function uu(Z){return Z.panDelta&&Z.panDelta.mag()||Z.zoomDelta||Z.bearingDelta||Z.pitchDelta}class Ou{constructor(A,I){this.handleWindowEvent=O=>{this.handleEvent(O,`${O.type}Window`)},this.handleEvent=(O,y)=>{if(O.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const s=O.type==="renderFrame"?void 0:O,i={needsRenderFrame:!1},r={},l={},d=O.touches,_=d?this._getMapTouches(d):void 0,w=_?W.touchPos(this._el,_):W.mousePos(this._el,O);for(const{handlerName:j,handler:Y,allowed:ue}of this._handlers){if(!Y.isEnabled())continue;let Se;this._blockedByActive(l,ue,j)?Y.reset():Y[y||O.type]&&(Se=Y[y||O.type](O,w,_),this.mergeHandlerResult(i,r,Se,j,s),Se&&Se.needsRenderFrame&&this._triggerRenderFrame()),(Se||Y.isActive())&&(l[j]=Y)}const T={};for(const j in this._previousActiveHandlers)l[j]||(T[j]=s);this._previousActiveHandlers=l,(Object.keys(T).length||uu(i))&&(this._changes.push([i,r,T]),this._triggerRenderFrame()),(Object.keys(l).length||uu(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=i;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))},this._map=A,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mi(A),this._bearingSnap=I.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(I);const F=this._el;this._listeners=[[F,"touchstart",{passive:!0}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[window,"blur",void 0]];for(const[O,y,s]of this._listeners)W.addEventListener(O,y,O===document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[A,I,F]of this._listeners)W.removeEventListener(A,I,A===document?this.handleWindowEvent:this.handleEvent,F)}_addDefaultHandlers(A){const I=this._map,F=I.getCanvasContainer();this._add("mapEvent",new Oi(I,A));const O=I.boxZoom=new or(I,A);this._add("boxZoom",O),A.interactive&&A.boxZoom&&O.enable();const y=new As(I),s=new Wu(I);I.doubleClickZoom=new ac(s,y),this._add("tapZoom",y),this._add("clickZoom",s),A.interactive&&A.doubleClickZoom&&I.doubleClickZoom.enable();const i=new jl;this._add("tapDragZoom",i);const r=I.touchPitch=new _l(I);this._add("touchPitch",r),A.interactive&&A.touchPitch&&I.touchPitch.enable(A.touchPitch);const l=mo(A),d=Ml(A);I.dragRotate=new _a(A,l,d),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",d,["mouseRotate"]),A.interactive&&A.dragRotate&&I.dragRotate.enable();const _=(({enable:ue,clickTolerance:Se})=>{const Te=new rs({checkCorrectEvent:Re=>W.mouseButton(Re)===0&&!Re.ctrlKey});return new Xa({clickTolerance:Se,move:(Re,Be)=>({around:Be,panDelta:Be.sub(Re)}),activateOnStart:!0,moveStateManager:Te,enable:ue,assignEvents:zu})})(A),w=new Pn(A,I);I.dragPan=new fs(F,_,w),this._add("mousePan",_),this._add("touchPan",w,["touchZoom","touchRotate"]),A.interactive&&A.dragPan&&I.dragPan.enable(A.dragPan);const T=new Hl,B=new Nl;I.touchZoomRotate=new Ko(F,B,T,i),this._add("touchRotate",T,["touchPan","touchZoom"]),this._add("touchZoom",B,["touchPan","touchRotate"]),A.interactive&&A.touchZoomRotate&&I.touchZoomRotate.enable(A.touchZoomRotate);const j=I.scrollZoom=new ta(I,()=>this._triggerRenderFrame());this._add("scrollZoom",j,["mousePan"]),A.interactive&&A.scrollZoom&&I.scrollZoom.enable(A.scrollZoom);const Y=I.keyboard=new Ru(I);this._add("keyboard",Y),A.interactive&&A.keyboard&&I.keyboard.enable(),this._add("blockableMapEvent",new Ln(I))}_add(A,I,F){this._handlers.push({handlerName:A,handler:I,allowed:F}),this._handlersById[A]=I}stop(A){if(!this._updatingCamera){for(const{handler:I}of this._handlers)I.reset();this._inertia.clear(),this._fireEvents({},{},A),this._changes=[]}}isActive(){for(const{handler:A}of this._handlers)if(A.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!gu(this._eventsInProgress)||this.isZooming()}_blockedByActive(A,I,F){for(const O in A)if(O!==F&&(!I||I.indexOf(O)<0))return!0;return!1}_getMapTouches(A){const I=[];for(const F of A)this._el.contains(F.target)&&I.push(F);return I}mergeHandlerResult(A,I,F,O,y){if(!F)return;a.e(A,F);const s={handlerName:O,originalEvent:F.originalEvent||y};F.zoomDelta!==void 0&&(I.zoom=s),F.panDelta!==void 0&&(I.drag=s),F.pitchDelta!==void 0&&(I.pitch=s),F.bearingDelta!==void 0&&(I.rotate=s)}_applyChanges(){const A={},I={},F={};for(const[O,y,s]of this._changes)O.panDelta&&(A.panDelta=(A.panDelta||new a.P(0,0))._add(O.panDelta)),O.zoomDelta&&(A.zoomDelta=(A.zoomDelta||0)+O.zoomDelta),O.bearingDelta&&(A.bearingDelta=(A.bearingDelta||0)+O.bearingDelta),O.pitchDelta&&(A.pitchDelta=(A.pitchDelta||0)+O.pitchDelta),O.around!==void 0&&(A.around=O.around),O.pinchAround!==void 0&&(A.pinchAround=O.pinchAround),O.noInertia&&(A.noInertia=O.noInertia),a.e(I,y),a.e(F,s);this._updateMapTransform(A,I,F),this._changes=[]}_updateMapTransform(A,I,F){const O=this._map,y=O._getTransformForUpdate(),s=O.terrain;if(!(uu(A)||s&&this._terrainMovement))return this._fireEvents(I,F,!0);let{panDelta:i,zoomDelta:r,bearingDelta:l,pitchDelta:d,around:_,pinchAround:w}=A;w!==void 0&&(_=w),O._stop(!0),_=_||O.transform.centerPoint;const T=y.pointLocation(i?_.sub(i):_);l&&(y.bearing+=l),d&&(y.pitch+=d),r&&(y.zoom+=r),s?this._terrainMovement||!I.drag&&!I.zoom?I.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(i)):y.setLocationAtPoint(T,_):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(T,_),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,y.recalculateZoom(O.terrain)})):y.setLocationAtPoint(T,_),O._applyUpdatedTransform(y),this._map._update(),A.noInertia||this._inertia.record(A),this._fireEvents(I,F,!0)}_fireEvents(A,I,F){const O=gu(this._eventsInProgress),y=gu(A),s={};for(const d in A){const{originalEvent:_}=A[d];this._eventsInProgress[d]||(s[`${d}start`]=_),this._eventsInProgress[d]=A[d]}!O&&y&&this._fireEvent("movestart",y.originalEvent);for(const d in s)this._fireEvent(d,s[d]);y&&this._fireEvent("move",y.originalEvent);for(const d in A){const{originalEvent:_}=A[d];this._fireEvent(d,_)}const i={};let r;for(const d in this._eventsInProgress){const{handlerName:_,originalEvent:w}=this._eventsInProgress[d];this._handlersById[_].isActive()||(delete this._eventsInProgress[d],r=I[_]||w,i[`${d}end`]=r)}for(const d in i)this._fireEvent(d,i[d]);const l=gu(this._eventsInProgress);if(F&&(O||y)&&!l){this._updatingCamera=!0;const d=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=w=>w!==0&&-this._bearingSnap<w&&w<this._bearingSnap;!d||!d.essential&&a.h.prefersReducedMotion?(this._map.fire(new a.k("moveend",{originalEvent:r})),_(this._map.getBearing())&&this._map.resetNorth()):(_(d.bearing||this._map.getBearing())&&(d.bearing=0),d.freezeElevation=!0,this._map.easeTo(d,{originalEvent:r})),this._updatingCamera=!1}}_fireEvent(A,I){this._map.fire(new a.k(A,I?{originalEvent:I}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(A=>{delete this._frameId,this.handleEvent(new Fu("renderFrame",{timeStamp:A})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class _r extends a.E{constructor(A,I){super(),this._renderFrameCallback=()=>{const F=Math.min((a.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=A,this._bearingSnap=I.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.L(this.transform.center.lng,this.transform.center.lat)}setCenter(A,I){return this.jumpTo({center:A},I)}panBy(A,I,F){return A=a.P.convert(A).mult(-1),this.panTo(this.transform.center,a.e({offset:A},I),F)}panTo(A,I,F){return this.easeTo(a.e({center:A},I),F)}getZoom(){return this.transform.zoom}setZoom(A,I){return this.jumpTo({zoom:A},I),this}zoomTo(A,I,F){return this.easeTo(a.e({zoom:A},I),F)}zoomIn(A,I){return this.zoomTo(this.getZoom()+1,A,I),this}zoomOut(A,I){return this.zoomTo(this.getZoom()-1,A,I),this}getBearing(){return this.transform.bearing}setBearing(A,I){return this.jumpTo({bearing:A},I),this}getPadding(){return this.transform.padding}setPadding(A,I){return this.jumpTo({padding:A},I),this}rotateTo(A,I,F){return this.easeTo(a.e({bearing:A},I),F)}resetNorth(A,I){return this.rotateTo(0,a.e({duration:1e3},A),I),this}resetNorthPitch(A,I){return this.easeTo(a.e({bearing:0,pitch:0,duration:1e3},A),I),this}snapToNorth(A,I){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(A,I):this}getPitch(){return this.transform.pitch}setPitch(A,I){return this.jumpTo({pitch:A},I),this}cameraForBounds(A,I){A=Gi.convert(A);const F=I&&I.bearing||0;return this._cameraForBoxAndBearing(A.getNorthWest(),A.getSouthEast(),F,I)}_cameraForBoxAndBearing(A,I,F,O){const y={top:0,bottom:0,right:0,left:0};if(typeof(O=a.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){const Be=O.padding;O.padding={top:Be,bottom:Be,right:Be,left:Be}}O.padding=a.e(y,O.padding);const s=this.transform,i=s.padding,r=s.project(a.L.convert(A)),l=s.project(a.L.convert(I)),d=r.rotate(-F*Math.PI/180),_=l.rotate(-F*Math.PI/180),w=new a.P(Math.max(d.x,_.x),Math.max(d.y,_.y)),T=new a.P(Math.min(d.x,_.x),Math.min(d.y,_.y)),B=w.sub(T),j=(s.width-(i.left+i.right+O.padding.left+O.padding.right))/B.x,Y=(s.height-(i.top+i.bottom+O.padding.top+O.padding.bottom))/B.y;if(Y<0||j<0)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ue=Math.min(s.scaleZoom(s.scale*Math.min(j,Y)),O.maxZoom),Se=a.P.convert(O.offset),Te=new a.P((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(F*Math.PI/180),Re=Se.add(Te).mult(s.scale/s.zoomScale(ue));return{center:s.unproject(r.add(l).div(2).sub(Re)),zoom:ue,bearing:F}}fitBounds(A,I,F){return this._fitInternal(this.cameraForBounds(A,I),I,F)}fitScreenCoordinates(A,I,F,O,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.P.convert(A)),this.transform.pointLocation(a.P.convert(I)),F,O),O,y)}_fitInternal(A,I,F){return A?(delete(I=a.e(A,I)).padding,I.linear?this.easeTo(I,F):this.flyTo(I,F)):this}jumpTo(A,I){this.stop();const F=this._getTransformForUpdate();let O=!1,y=!1,s=!1;return"zoom"in A&&F.zoom!==+A.zoom&&(O=!0,F.zoom=+A.zoom),A.center!==void 0&&(F.center=a.L.convert(A.center)),"bearing"in A&&F.bearing!==+A.bearing&&(y=!0,F.bearing=+A.bearing),"pitch"in A&&F.pitch!==+A.pitch&&(s=!0,F.pitch=+A.pitch),A.padding==null||F.isPaddingEqual(A.padding)||(F.padding=A.padding),this._applyUpdatedTransform(F),this.fire(new a.k("movestart",I)).fire(new a.k("move",I)),O&&this.fire(new a.k("zoomstart",I)).fire(new a.k("zoom",I)).fire(new a.k("zoomend",I)),y&&this.fire(new a.k("rotatestart",I)).fire(new a.k("rotate",I)).fire(new a.k("rotateend",I)),s&&this.fire(new a.k("pitchstart",I)).fire(new a.k("pitch",I)).fire(new a.k("pitchend",I)),this.fire(new a.k("moveend",I))}calculateCameraOptionsFromTo(A,I,F,O=0){const y=a.U.fromLngLat(A,I),s=a.U.fromLngLat(F,O),i=s.x-y.x,r=s.y-y.y,l=s.z-y.z,d=Math.hypot(i,r,l);if(d===0)throw new Error("Can't calculate camera options with same From and To");const _=Math.hypot(i,r),w=this.transform.scaleZoom(this.transform.cameraToCenterDistance/d/this.transform.tileSize),T=180*Math.atan2(i,-r)/Math.PI;let B=180*Math.acos(_/d)/Math.PI;return B=l<0?90-B:90+B,{center:s.toLngLat(),zoom:w,pitch:B,bearing:T}}easeTo(A,I){this._stop(!1,A.easeId),((A=a.e({offset:[0,0],duration:500,easing:a.bb},A)).animate===!1||!A.essential&&a.h.prefersReducedMotion)&&(A.duration=0);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?+A.zoom:O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=a.P.convert(A.offset);let T=F.centerPoint.add(w);const B=F.pointLocation(T),j=a.L.convert(A.center||B);this._normalizeCenter(j);const Y=F.project(B),ue=F.project(j).sub(Y),Se=F.zoomScale(r-O);let Te,Re;A.around&&(Te=a.L.convert(A.around),Re=F.locationPoint(Te));const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||r!==O,this._rotating=this._rotating||y!==l,this._pitching=this._pitching||d!==s,this._padding=!F.isPaddingEqual(_),this._easeId=A.easeId,this._prepareEase(I,A.noMoveStart,Be),this.terrain&&this._prepareElevation(j),this._ease($e=>{if(this._zooming&&(F.zoom=a.B.number(O,r,$e)),this._rotating&&(F.bearing=a.B.number(y,l,$e)),this._pitching&&(F.pitch=a.B.number(s,d,$e)),this._padding&&(F.interpolatePadding(i,_,$e),T=F.centerPoint.add(w)),this.terrain&&!A.freezeElevation&&this._updateElevation($e),Te)F.setLocationAtPoint(Te,Re);else{const vt=F.zoomScale(F.zoom-O),ot=r>O?Math.min(2,Se):Math.max(.5,Se),ct=Math.pow(ot,1-$e),Et=F.unproject(Y.add(ue.mult($e*ct)).mult(vt));F.setLocationAtPoint(F.renderWorldCopies?Et.wrap():Et,T)}this._applyUpdatedTransform(F),this._fireMoveEvents(I)},$e=>{this.terrain&&this._finalizeElevation(),this._afterEase(I,$e)},A),this}_prepareEase(A,I,F={}){this._moving=!0,I||F.moving||this.fire(new a.k("movestart",A)),this._zooming&&!F.zooming&&this.fire(new a.k("zoomstart",A)),this._rotating&&!F.rotating&&this.fire(new a.k("rotatestart",A)),this._pitching&&!F.pitching&&this.fire(new a.k("pitchstart",A))}_prepareElevation(A){this._elevationCenter=A,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(A,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(A){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const I=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(A<1&&I!==this._elevationTarget){const F=this._elevationTarget-this._elevationStart;this._elevationStart+=A*(F-(I-(F*A+this._elevationStart))/(1-A)),this._elevationTarget=I}this.transform.elevation=a.B.number(this._elevationStart,this._elevationTarget,A)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(A){if(!this.transformCameraUpdate)return;const I=A.clone(),{center:F,zoom:O,pitch:y,bearing:s,elevation:i}=this.transformCameraUpdate(I);F&&(I.center=F),O!==void 0&&(I.zoom=O),y!==void 0&&(I.pitch=y),s!==void 0&&(I.bearing=s),i!==void 0&&(I.elevation=i),this.transform.apply(I)}_fireMoveEvents(A){this.fire(new a.k("move",A)),this._zooming&&this.fire(new a.k("zoom",A)),this._rotating&&this.fire(new a.k("rotate",A)),this._pitching&&this.fire(new a.k("pitch",A))}_afterEase(A,I){if(this._easeId&&I&&this._easeId===I)return;delete this._easeId;const F=this._zooming,O=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,F&&this.fire(new a.k("zoomend",A)),O&&this.fire(new a.k("rotateend",A)),y&&this.fire(new a.k("pitchend",A)),this.fire(new a.k("moveend",A))}flyTo(A,I){if(!A.essential&&a.h.prefersReducedMotion){const si=a.F(A,["center","zoom","bearing","pitch","around"]);return this.jumpTo(si,I)}this.stop(),A=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.bb},A);const F=this._getTransformForUpdate(),O=this.getZoom(),y=this.getBearing(),s=this.getPitch(),i=this.getPadding(),r="zoom"in A?a.ad(+A.zoom,F.minZoom,F.maxZoom):O,l="bearing"in A?this._normalizeBearing(A.bearing,y):y,d="pitch"in A?+A.pitch:s,_="padding"in A?A.padding:F.padding,w=F.zoomScale(r-O),T=a.P.convert(A.offset);let B=F.centerPoint.add(T);const j=F.pointLocation(B),Y=a.L.convert(A.center||j);this._normalizeCenter(Y);const ue=F.project(j),Se=F.project(Y).sub(ue);let Te=A.curve;const Re=Math.max(F.width,F.height),Be=Re/w,$e=Se.mag();if("minZoom"in A){const si=a.ad(Math.min(A.minZoom,O,r),F.minZoom,F.maxZoom),ji=Re/F.zoomScale(si-O);Te=Math.sqrt(ji/$e*2)}const vt=Te*Te;function ot(si){const ji=(Be*Be-Re*Re+(si?-1:1)*vt*vt*$e*$e)/(2*(si?Be:Re)*vt*$e);return Math.log(Math.sqrt(ji*ji+1)-ji)}function ct(si){return(Math.exp(si)-Math.exp(-si))/2}function Et(si){return(Math.exp(si)+Math.exp(-si))/2}const wt=ot(!1);let ri=function(si){return Et(wt)/Et(wt+Te*si)},Xt=function(si){return Re*((Et(wt)*(ct(ji=wt+Te*si)/Et(ji))-ct(wt))/vt)/$e;var ji},Jt=(ot(!0)-wt)/Te;if(Math.abs($e)<1e-6||!isFinite(Jt)){if(Math.abs(Re-Be)<1e-6)return this.easeTo(A,I);const si=Be<Re?-1:1;Jt=Math.abs(Math.log(Be/Re))/Te,Xt=function(){return 0},ri=function(ji){return Math.exp(si*Te*ji)}}return A.duration="duration"in A?+A.duration:1e3*Jt/("screenSpeed"in A?+A.screenSpeed/Te:+A.speed),A.maxDuration&&A.duration>A.maxDuration&&(A.duration=0),this._zooming=!0,this._rotating=y!==l,this._pitching=d!==s,this._padding=!F.isPaddingEqual(_),this._prepareEase(I,!1),this.terrain&&this._prepareElevation(Y),this._ease(si=>{const ji=si*Jt,Zi=1/ri(ji);F.zoom=si===1?r:O+F.scaleZoom(Zi),this._rotating&&(F.bearing=a.B.number(y,l,si)),this._pitching&&(F.pitch=a.B.number(s,d,si)),this._padding&&(F.interpolatePadding(i,_,si),B=F.centerPoint.add(T)),this.terrain&&!A.freezeElevation&&this._updateElevation(si);const Ii=si===1?Y:F.unproject(ue.add(Se.mult(Xt(ji))).mult(Zi));F.setLocationAtPoint(F.renderWorldCopies?Ii.wrap():Ii,B),this._applyUpdatedTransform(F),this._fireMoveEvents(I)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(I)},A),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(A,I){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const F=this._onEaseEnd;delete this._onEaseEnd,F.call(this,I)}if(!A){const F=this.handlers;F&&F.stop(!1)}return this}_ease(A,I,F){F.animate===!1||F.duration===0?(A(1),I()):(this._easeStart=a.h.now(),this._easeOptions=F,this._onEaseFrame=A,this._onEaseEnd=I,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(A,I){A=a.b5(A,-180,180);const F=Math.abs(A-I);return Math.abs(A-360-I)<F&&(A-=360),Math.abs(A+360-I)<F&&(A+=360),A}_normalizeCenter(A){const I=this.transform;if(!I.renderWorldCopies||I.lngRange)return;const F=A.lng-I.center.lng;A.lng+=F>180?-360:F<-180?360:0}queryTerrainElevation(A){return this.terrain?this.terrain.getElevationForLngLatZoom(a.L.convert(A),this.transform.tileZoom)-this.transform.elevation:null}}class ds{constructor(A={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=I=>{!I||I.sourceDataType!=="metadata"&&I.sourceDataType!=="visibility"&&I.dataType!=="style"&&I.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=A}getDefaultPosition(){return"bottom-right"}onAdd(A){return this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=W.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=W.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){W.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(A,I){const F=this._map._getUIString(`AttributionControl.${I}`);A.title=F,A.setAttribute("aria-label",F)}_updateAttributions(){if(!this._map.style)return;let A=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?A=A.concat(this.options.customAttribution.map(O=>typeof O!="string"?"":O)):typeof this.options.customAttribution=="string"&&A.push(this.options.customAttribution)),this._map.style.stylesheet){const O=this._map.style.stylesheet;this.styleOwner=O.owner,this.styleId=O.id}const I=this._map.style.sourceCaches;for(const O in I){const y=I[O];if(y.used||y.usedForTerrain){const s=y.getSource();s.attribution&&A.indexOf(s.attribution)<0&&A.push(s.attribution)}}A=A.filter(O=>String(O).trim()),A.sort((O,y)=>O.length-y.length),A=A.filter((O,y)=>{for(let s=y+1;s<A.length;s++)if(A[s].indexOf(O)>=0)return!1;return!0});const F=A.join(" | ");F!==this._attribHTML&&(this._attribHTML=F,A.length?(this._innerContainer.innerHTML=F,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class pn{constructor(A={}){this._updateCompact=()=>{const I=this._container.children;if(I.length){const F=I[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&F.classList.add("maplibregl-compact"):F.classList.remove("maplibregl-compact")}},this.options=A}getDefaultPosition(){return"bottom-left"}onAdd(A){this._map=A,this._compact=this.options&&this.options.compact,this._container=W.create("div","maplibregl-ctrl");const I=W.create("a","maplibregl-ctrl-logo");return I.target="_blank",I.rel="noopener nofollow",I.href="https://maplibre.org/",I.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),I.setAttribute("rel","noopener nofollow"),this._container.appendChild(I),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){W.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Gn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(A){const I=++this._id;return this._queue.push({callback:A,id:I,cancelled:!1}),I}remove(A){const I=this._currentlyRunning,F=I?this._queue.concat(I):this._queue;for(const O of F)if(O.id===A)return void(O.cancelled=!0)}run(A=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const I=this._currentlyRunning=this._queue;this._queue=[];for(const F of I)if(!F.cancelled&&(F.callback(A),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Jn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Jo=a.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Cu extends a.E{constructor(A){super(),this.sourceCache=A,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,A.usedForTerrain=!0,A.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(A,I){this.sourceCache.update(A,I),this._renderableTilesKeys=[];const F={};for(const O of A.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:I}))F[O.key]=!0,this._renderableTilesKeys.push(O.key),this._tiles[O.key]||(O.posMatrix=new Float64Array(16),a.aS(O.posMatrix,0,a.N,0,a.N,0,1),this._tiles[O.key]=new Mn(O,this.tileSize));for(const O in this._tiles)F[O]||delete this._tiles[O]}freeRtt(A){for(const I in this._tiles){const F=this._tiles[I];(!A||F.tileID.equals(A)||F.tileID.isChildOf(A)||A.isChildOf(F.tileID))&&(F.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(A=>this.getTileByID(A))}getTileByID(A){return this._tiles[A]}getTerrainCoords(A){const I={};for(const F of this._renderableTilesKeys){const O=this._tiles[F].tileID;if(O.canonical.equals(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16),a.aS(y.posMatrix,0,a.N,0,a.N,0,1),I[F]=y}else if(O.canonical.isChildOf(A.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=O.canonical.z-A.canonical.z,i=O.canonical.x-(O.canonical.x>>s<<s),r=O.canonical.y-(O.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,l,0,l,0,1),a.$(y.posMatrix,y.posMatrix,[-i*l,-r*l,0]),I[F]=y}else if(A.canonical.isChildOf(O.canonical)){const y=A.clone();y.posMatrix=new Float64Array(16);const s=A.canonical.z-O.canonical.z,i=A.canonical.x-(A.canonical.x>>s<<s),r=A.canonical.y-(A.canonical.y>>s<<s),l=a.N>>s;a.aS(y.posMatrix,0,a.N,0,a.N,0,1),a.$(y.posMatrix,y.posMatrix,[i*l,r*l,0]),a.a0(y.posMatrix,y.posMatrix,[1/2**s,1/2**s,0]),I[F]=y}}return I}getSourceTile(A,I){const F=this.sourceCache._source;let O=A.overscaledZ-this.deltaZoom;if(O>F.maxzoom&&(O=F.maxzoom),O<F.minzoom)return null;this._sourceTileCache[A.key]||(this._sourceTileCache[A.key]=A.scaledTo(O).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[A.key]);if((!y||!y.dem)&&I)for(;O>=F.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(A.scaledTo(O--).key);return y}tilesAfterTime(A=Date.now()){return Object.values(this._tiles).filter(I=>I.timeAdded>=A)}}class oa{constructor(A,I,F){this.painter=A,this.sourceCache=new Cu(I),this.options=F,this.exaggeration=typeof F.exaggeration=="number"?F.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(A,I,F,O=a.N){var y;if(!(I>=0&&I<O&&F>=0&&F<O))return 0;const s=this.getTerrainData(A),i=(y=s.tile)===null||y===void 0?void 0:y.dem;if(!i)return 0;const r=function(B,j,Y){var ue=j[0],Se=j[1];return B[0]=Y[0]*ue+Y[4]*Se+Y[12],B[1]=Y[1]*ue+Y[5]*Se+Y[13],B}([],[I/O*a.N,F/O*a.N],s.u_terrain_matrix),l=[r[0]*i.dim,r[1]*i.dim],d=Math.floor(l[0]),_=Math.floor(l[1]),w=l[0]-d,T=l[1]-_;return i.get(d,_)*(1-w)*(1-T)+i.get(d+1,_)*w*(1-T)+i.get(d,_+1)*(1-w)*T+i.get(d+1,_+1)*w*T}getElevationForLngLatZoom(A,I){const{tileID:F,mercatorX:O,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(A,I);return this.getElevation(F,O%a.N,y%a.N,a.N)}getElevation(A,I,F,O=a.N){return this.getDEMElevation(A,I,F,O)*this.exaggeration}getTerrainData(A){if(!this._emptyDemTexture){const O=this.painter.context,y=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new _t(O,y,O.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new _t(O,new a.R({width:1,height:1}),O.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ao([])}const I=this.sourceCache.getSourceTile(A,!0);if(I&&I.dem&&(!I.demTexture||I.needsTerrainPrepare)){const O=this.painter.context;I.demTexture=this.painter.getTileTexture(I.dem.stride),I.demTexture?I.demTexture.update(I.dem.getPixels(),{premultiply:!1}):I.demTexture=new _t(O,I.dem.getPixels(),O.gl.RGBA,{premultiply:!1}),I.demTexture.bind(O.gl.NEAREST,O.gl.CLAMP_TO_EDGE),I.needsTerrainPrepare=!1}const F=I&&I+I.tileID.key+A.key;if(F&&!this._demMatrixCache[F]){const O=this.sourceCache.sourceCache._source.maxzoom;let y=A.canonical.z-I.tileID.canonical.z;A.overscaledZ>A.canonical.z&&(A.canonical.z>=O?y=A.canonical.z-O:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const s=A.canonical.x-(A.canonical.x>>y<<y),i=A.canonical.y-(A.canonical.y>>y<<y),r=a.bc(new Float64Array(16),[1/(a.N<<y),1/(a.N<<y),0]);a.$(r,r,[s*a.N,i*a.N,0]),this._demMatrixCache[A.key]={matrix:r,coord:A}}return{u_depth:2,u_terrain:3,u_terrain_dim:I&&I.dem&&I.dem.dim||1,u_terrain_matrix:F?this._demMatrixCache[A.key].matrix:this._emptyDemMatrix,u_terrain_unpack:I&&I.dem&&I.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(I&&I.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:I}}getFramebuffer(A){const I=this.painter,F=I.width/devicePixelRatio,O=I.height/devicePixelRatio;return!this._fbo||this._fbo.width===F&&this._fbo.height===O||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new _t(I.context,{width:F,height:O,data:null},I.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(I.context.gl.NEAREST,I.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new _t(I.context,{width:F,height:O,data:null},I.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(I.context.gl.NEAREST,I.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=I.context.createFramebuffer(F,O,!0,!1),this._fbo.depthAttachment.set(I.context.createRenderbuffer(I.context.gl.DEPTH_COMPONENT16,F,O))),this._fbo.colorAttachment.set(A==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const A=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const I=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,s=0;y<this._coordsTextureSize;y++)for(let i=0;i<this._coordsTextureSize;i++,s+=4)I[s+0]=255&i,I[s+1]=255&y,I[s+2]=i>>8<<4|y>>8,I[s+3]=0;const F=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(I.buffer)),O=new _t(A,F,A.gl.RGBA,{premultiply:!1});return O.bind(A.gl.NEAREST,A.gl.CLAMP_TO_EDGE),this._coordsTexture=O,O}pointCoordinate(A){const I=new Uint8Array(4),F=this.painter.context,O=F.gl;F.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),O.readPixels(A.x,this.painter.height/devicePixelRatio-A.y-1,1,1,O.RGBA,O.UNSIGNED_BYTE,I),F.bindFramebuffer.set(null);const y=I[0]+(I[2]>>4<<8),s=I[1]+((15&I[2])<<8),i=this.coordsIndex[255-I[3]],r=i&&this.sourceCache.getTileByID(i);if(!r)return null;const l=this._coordsTextureSize,d=(1<<r.tileID.canonical.z)*l;return new a.U(this._allowMercatorOverflow(A,(r.tileID.canonical.x*l+y)/d),(r.tileID.canonical.y*l+s)/d,this.getElevation(r.tileID,y,s,l))}getTerrainMesh(){if(this._mesh)return this._mesh;const A=this.painter.context,I=new a.bd,F=new a.b0,O=this.meshSize,y=a.N/O,s=O*O;for(let _=0;_<=O;_++)for(let w=0;w<=O;w++)I.emplaceBack(w*y,_*y,0);for(let _=0;_<s;_+=O+1)for(let w=0;w<O;w++)F.emplaceBack(w+_,O+w+_+1,O+w+_+2),F.emplaceBack(w+_,O+w+_+2,w+_+1);const i=I.length,r=i+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])I.emplaceBack(w*y,_*a.N,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(r+_,r+_+1,r+_+3),F.emplaceBack(r+_,r+_+3,r+_+2),F.emplaceBack(i+_,i+_+3,i+_+1),F.emplaceBack(i+_,i+_+2,i+_+3);const l=I.length,d=l+2*(O+1);for(const _ of[0,1])for(let w=0;w<=O;w++)for(const T of[0,1])I.emplaceBack(_*a.N,w*y,T);for(let _=0;_<2*O;_+=2)F.emplaceBack(l+_,l+_+1,l+_+3),F.emplaceBack(l+_,l+_+3,l+_+2),F.emplaceBack(d+_,d+_+3,d+_+1),F.emplaceBack(d+_,d+_+2,d+_+3);return this._mesh={indexBuffer:A.createIndexBuffer(F),vertexBuffer:A.createVertexBuffer(I,Jo.members),segments:a.S.simpleSegment(0,0,I.length,F.length)},this._mesh}getMeshFrameDelta(A){return 2*Math.PI*a.be/Math.pow(2,A)/5}getMinTileElevationForLngLatZoom(A,I){var F;const{tileID:O}=this._getOverscaledTileIDFromLngLatZoom(A,I);return(F=this.getMinMaxElevation(O).minElevation)!==null&&F!==void 0?F:0}getMinMaxElevation(A){const I=this.getTerrainData(A).tile,F={minElevation:null,maxElevation:null};return I&&I.dem&&(F.minElevation=I.dem.min*this.exaggeration,F.maxElevation=I.dem.max*this.exaggeration),F}_getOverscaledTileIDFromLngLatZoom(A,I){const F=a.U.fromLngLat(A.wrap()),O=(1<<I)*a.N,y=F.x*O,s=F.y*O,i=Math.floor(y/a.N),r=Math.floor(s/a.N);return{tileID:new a.O(I,0,I,i,r),mercatorX:y,mercatorY:s}}_allowMercatorOverflow(A,I){const F=A.x<this.painter.width/2;let O=a.bf(I);const y=this.painter.transform.center.lng;return F&&Math.sign(O)>0&&Math.sign(y)<0||!F&&Math.sign(O)<0&&Math.sign(y)>0?(O=360*Math.sign(y)+O,a.G(O)):I}}class _u{constructor(A,I,F){this._context=A,this._size=I,this._tileSize=F,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const A of this._objects)A.texture.destroy(),A.fbo.destroy()}_createObject(A){const I=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),F=new _t(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return F.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),I.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),I.colorAttachment.set(F.texture),{id:A,fbo:I,texture:F,stamp:-1,inUse:!1}}getObjectForId(A){return this._objects[A]}useObject(A){A.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(I=>A.id!==I),this._recentlyUsed.push(A.id)}stampObject(A){A.stamp=++this._stamp}getOrCreateFreeObject(){for(const I of this._recentlyUsed)if(!this._objects[I].inUse)return this._objects[I];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const A=this._createObject(this._objects.length);return this._objects.push(A),A}freeObject(A){A.inUse=!1}freeAllObjects(){for(const A of this._objects)this.freeObject(A)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(A=>!A.inUse)===!1}}const _s={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Co{constructor(A,I){this.painter=A,this.terrain=I,this.pool=new _u(A.context,30,I.sourceCache.tileSize*I.qualityFactor)}destruct(){this.pool.destruct()}getTexture(A){return this.pool.getObjectForId(A.rtt[this._stacks.length-1].id).texture}prepareForRender(A,I){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=A._order.filter(F=>!A._layers[F].isHidden(I)),this._coordsDescendingInv={};for(const F in A.sourceCaches){this._coordsDescendingInv[F]={};const O=A.sourceCaches[F].getVisibleCoordinates();for(const y of O){const s=this.terrain.sourceCache.getTerrainCoords(y);for(const i in s)this._coordsDescendingInv[F][i]||(this._coordsDescendingInv[F][i]=[]),this._coordsDescendingInv[F][i].push(s[i])}}this._coordsDescendingInvStr={};for(const F of A._order){const O=A._layers[F],y=O.source;if(_s[O.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const s in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][s]=this._coordsDescendingInv[y][s].map(i=>i.key).sort().join()}}for(const F of this._renderableTiles)for(const O in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[O][F.tileID.key];y&&y!==F.rttCoords[O]&&(F.rtt=[])}}renderLayer(A){if(A.isHidden(this.painter.transform.zoom))return!1;const I=A.type,F=this.painter,O=this._renderableLayerIds[this._renderableLayerIds.length-1]===A.id;if(_s[I]&&(this._prevType&&_s[this._prevType]||this._stacks.push([]),this._prevType=I,this._stacks[this._stacks.length-1].push(A.id),!O))return!0;if(_s[this._prevType]||_s[I]&&O){this._prevType=I;const y=this._stacks.length-1,s=this._stacks[y]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(Yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[y]){const l=this.pool.getObjectForId(i.rtt[y].id);if(l.stamp===i.rtt[y].stamp){this.pool.useObject(l);continue}}const r=this.pool.getOrCreateFreeObject();this.pool.useObject(r),this.pool.stampObject(r),i.rtt[y]={id:r.id,stamp:r.stamp},F.context.bindFramebuffer.set(r.fbo.framebuffer),F.context.clear({color:a.aT.transparent,stencil:0}),F.currentStencilSource=void 0;for(let l=0;l<s.length;l++){const d=F.style._layers[s[l]],_=d.source?this._coordsDescendingInv[d.source][i.tileID.key]:[i.tileID];F.context.viewport.set([0,0,r.fbo.width,r.fbo.height]),F._renderTileClippingMasks(d,_),F.renderLayer(F,F.style.sourceCaches[d.source],d,_),d.source&&(i.rttCoords[d.source]=this._coordsDescendingInvStr[d.source][i.tileID.key])}}return Yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),_s[I]}return!1}}const Mi=U,zi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},ys=Z=>{Z.touchstart=Z.dragStart,Z.touchmoveWindow=Z.dragMove,Z.touchend=Z.dragEnd},yu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Oo{constructor(A,I,F=!1){this.mousedown=s=>{this.startMouse(a.e({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),W.mousePos(this.element,s)),W.addEventListener(window,"mousemove",this.mousemove),W.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=s=>{this.moveMouse(s,W.mousePos(this.element,s))},this.mouseup=s=>{this.mouseRotate.dragEnd(s),this.mousePitch&&this.mousePitch.dragEnd(s),this.offTemp()},this.touchstart=s=>{s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.startTouch(s,this._startPos),W.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.addEventListener(window,"touchend",this.touchend))},this.touchmove=s=>{s.targetTouches.length!==1?this.reset():(this._lastPos=W.touchPos(this.element,s.targetTouches)[0],this.moveTouch(s,this._lastPos))},this.touchend=s=>{s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const O=A.dragRotate._mouseRotate.getClickTolerance(),y=A.dragRotate._mousePitch.getClickTolerance();this.element=I,this.mouseRotate=mo({clickTolerance:O,enable:!0}),this.touchRotate=(({enable:s,clickTolerance:i,bearingDegreesPerPixelMoved:r=.8})=>{const l=new Qu;return new Xa({clickTolerance:i,move:(d,_)=>({bearingDelta:(_.x-d.x)*r}),moveStateManager:l,enable:s,assignEvents:ys})})({clickTolerance:O,enable:!0}),this.map=A,F&&(this.mousePitch=Ml({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:s,clickTolerance:i,pitchDegreesPerPixelMoved:r=-.5})=>{const l=new Qu;return new Xa({clickTolerance:i,move:(d,_)=>({pitchDelta:(_.y-d.y)*r}),moveStateManager:l,enable:s,assignEvents:ys})})({clickTolerance:y,enable:!0})),W.addEventListener(I,"mousedown",this.mousedown),W.addEventListener(I,"touchstart",this.touchstart,{passive:!1}),W.addEventListener(I,"touchcancel",this.reset)}startMouse(A,I){this.mouseRotate.dragStart(A,I),this.mousePitch&&this.mousePitch.dragStart(A,I),W.disableDrag()}startTouch(A,I){this.touchRotate.dragStart(A,I),this.touchPitch&&this.touchPitch.dragStart(A,I),W.disableDrag()}moveMouse(A,I){const F=this.map,{bearingDelta:O}=this.mouseRotate.dragMove(A,I)||{};if(O&&F.setBearing(F.getBearing()+O),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(A,I)||{};y&&F.setPitch(F.getPitch()+y)}}moveTouch(A,I){const F=this.map,{bearingDelta:O}=this.touchRotate.dragMove(A,I)||{};if(O&&F.setBearing(F.getBearing()+O),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(A,I)||{};y&&F.setPitch(F.getPitch()+y)}}off(){const A=this.element;W.removeEventListener(A,"mousedown",this.mousedown),W.removeEventListener(A,"touchstart",this.touchstart,{passive:!1}),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend),W.removeEventListener(A,"touchcancel",this.reset),this.offTemp()}offTemp(){W.enableDrag(),W.removeEventListener(window,"mousemove",this.mousemove),W.removeEventListener(window,"mouseup",this.mouseup),W.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),W.removeEventListener(window,"touchend",this.touchend)}}let cs;function ul(Z,A,I){if(Z=new a.L(Z.lng,Z.lat),A){const F=new a.L(Z.lng-360,Z.lat),O=new a.L(Z.lng+360,Z.lat),y=I.locationPoint(Z).distSqr(A);I.locationPoint(F).distSqr(A)<y?Z=F:I.locationPoint(O).distSqr(A)<y&&(Z=O)}for(;Math.abs(Z.lng-I.center.lng)>180;){const F=I.locationPoint(Z);if(F.x>=0&&F.y>=0&&F.x<=I.width&&F.y<=I.height)break;Z.lng>I.center.lng?Z.lng-=360:Z.lng+=360}return Z}const Ps={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function C(Z,A,I){const F=Z.classList;for(const O in Ps)F.remove(`maplibregl-${I}-anchor-${O}`);F.add(`maplibregl-${I}-anchor-${A}`)}class D extends a.E{constructor(A){if(super(),this._onKeyPress=I=>{const F=I.code,O=I.charCode||I.keyCode;F!=="Space"&&F!=="Enter"&&O!==32&&O!==13||this.togglePopup()},this._onMapClick=I=>{const F=I.originalEvent.target,O=this._element;this._popup&&(F===O||O.contains(F))&&this.togglePopup()},this._update=I=>{if(!this._map)return;const F=this._map.loaded()&&!this._map.isMoving();((I==null?void 0:I.type)==="terrain"||(I==null?void 0:I.type)==="render"&&!F)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=ul(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let O="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?O=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(O=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),I&&I.type!=="moveend"||(this._pos=this._pos.round()),W.setTransform(this._element,`${Ps[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${O}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const s=this._map.unproject(this._pos),i=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=s.distanceTo(this._lngLat)>20*i?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=I=>{if(!this._isDragging){const F=this._clickTolerance||this._map._clickTolerance;this._isDragging=I.point.dist(this._pointerdownPos)>=F}this._isDragging&&(this._pos=I.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.k("dragstart"))),this.fire(new a.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.k("dragend")),this._state="inactive"},this._addDragHandler=I=>{this._element.contains(I.originalEvent.target)&&(I.preventDefault(),this._positionDelta=I.point.sub(this._pos).add(this._offset),this._pointerdownPos=I.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=A&&A.anchor||"center",this._color=A&&A.color||"#3FB1CE",this._scale=A&&A.scale||1,this._draggable=A&&A.draggable||!1,this._clickTolerance=A&&A.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=A&&A.rotation||0,this._rotationAlignment=A&&A.rotationAlignment||"auto",this._pitchAlignment=A&&A.pitchAlignment&&A.pitchAlignment!=="auto"?A.pitchAlignment:this._rotationAlignment,A&&A.element)this._element=A.element,this._offset=a.P.convert(A&&A.offset||[0,0]);else{this._defaultMarker=!0,this._element=W.create("div"),this._element.setAttribute("aria-label","Map marker");const I=W.createNS("http://www.w3.org/2000/svg","svg"),F=41,O=27;I.setAttributeNS(null,"display","block"),I.setAttributeNS(null,"height",`${F}px`),I.setAttributeNS(null,"width",`${O}px`),I.setAttributeNS(null,"viewBox",`0 0 ${O} ${F}`);const y=W.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const s=W.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const i=W.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"transform","translate(3.0, 29.0)"),i.setAttributeNS(null,"fill","#000000");const r=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of r){const Se=W.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",ue.rx),Se.setAttributeNS(null,"ry",ue.ry),i.appendChild(Se)}const l=W.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill",this._color);const d=W.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),l.appendChild(d);const _=W.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"fill","#000000");const w=W.createNS("http://www.w3.org/2000/svg","path");w.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),_.appendChild(w);const T=W.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(6.0, 7.0)"),T.setAttributeNS(null,"fill","#FFFFFF");const B=W.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(8.0, 8.0)");const j=W.createNS("http://www.w3.org/2000/svg","circle");j.setAttributeNS(null,"fill","#000000"),j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"cx","5.5"),j.setAttributeNS(null,"cy","5.5"),j.setAttributeNS(null,"r","5.4999962");const Y=W.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),B.appendChild(j),B.appendChild(Y),s.appendChild(i),s.appendChild(l),s.appendChild(_),s.appendChild(T),s.appendChild(B),I.appendChild(s),I.setAttributeNS(null,"height",F*this._scale+"px"),I.setAttributeNS(null,"width",O*this._scale+"px"),this._element.appendChild(I),this._offset=a.P.convert(A&&A.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",I=>{I.preventDefault()}),this._element.addEventListener("mousedown",I=>{I.preventDefault()}),C(this._element,this._anchor,"marker"),A&&A.className)for(const I of A.className.split(" "))this._element.classList.add(I);this._popup=null}addTo(A){return this.remove(),this._map=A,A.getCanvasContainer().appendChild(this._element),A.on("move",this._update),A.on("moveend",this._update),A.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),W.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(A){return this._lngLat=a.L.convert(A),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(A){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),A){if(!("offset"in A.options)){const O=Math.abs(13.5)/Math.SQRT2;A.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[O,-1*(38.1-13.5+O)],"bottom-right":[-O,-1*(38.1-13.5+O)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=A,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const A=this._popup;return A?(A.isOpen()?A.remove():A.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(A){return this._offset=a.P.convert(A),this._update(),this}addClassName(A){this._element.classList.add(A)}removeClassName(A){this._element.classList.remove(A)}toggleClassName(A){return this._element.classList.toggle(A)}setDraggable(A){return this._draggable=!!A,this._map&&(A?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(A){return this._rotation=A||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(A){return this._rotationAlignment=A||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(A){return this._pitchAlignment=A&&A!=="auto"?A:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const z={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let R=0,ee=!1;const le={maxWidth:100,unit:"metric"};function ae(Z,A,I){const F=I&&I.maxWidth||100,O=Z._container.clientHeight/2,y=Z.unproject([0,O]),s=Z.unproject([F,O]),i=y.distanceTo(s);if(I&&I.unit==="imperial"){const r=3.2808*i;r>5280?be(A,F,r/5280,Z._getUIString("ScaleControl.Miles")):be(A,F,r,Z._getUIString("ScaleControl.Feet"))}else I&&I.unit==="nautical"?be(A,F,i/1852,Z._getUIString("ScaleControl.NauticalMiles")):i>=1e3?be(A,F,i/1e3,Z._getUIString("ScaleControl.Kilometers")):be(A,F,i,Z._getUIString("ScaleControl.Meters"))}function be(Z,A,I,F){const O=function(y){const s=Math.pow(10,`${Math.floor(y)}`.length-1);let i=y/s;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(r){const l=Math.pow(10,Math.ceil(-Math.log(r)/Math.LN10));return Math.round(r*l)/l}(i),s*i}(I);Z.style.width=A*(O/I)+"px",Z.innerHTML=`${O}&nbsp;${F}`}const We={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},yt=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ct(Z){if(Z){if(typeof Z=="number"){const A=Math.round(Math.abs(Z)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,Z),"top-left":new a.P(A,A),"top-right":new a.P(-A,A),bottom:new a.P(0,-Z),"bottom-left":new a.P(A,-A),"bottom-right":new a.P(-A,-A),left:new a.P(Z,0),right:new a.P(-Z,0)}}if(Z instanceof a.P||Array.isArray(Z)){const A=a.P.convert(Z);return{center:A,top:A,"top-left":A,"top-right":A,bottom:A,"bottom-left":A,"bottom-right":A,left:A,right:A}}return{center:a.P.convert(Z.center||[0,0]),top:a.P.convert(Z.top||[0,0]),"top-left":a.P.convert(Z["top-left"]||[0,0]),"top-right":a.P.convert(Z["top-right"]||[0,0]),bottom:a.P.convert(Z.bottom||[0,0]),"bottom-left":a.P.convert(Z["bottom-left"]||[0,0]),"bottom-right":a.P.convert(Z["bottom-right"]||[0,0]),left:a.P.convert(Z.left||[0,0]),right:a.P.convert(Z.right||[0,0])}}return Ct(new a.P(0,0))}const ii={extend:(Z,...A)=>a.e(Z,...A),run(Z){Z()},logToElement(Z,A=!1,I="log"){const F=window.document.getElementById(I);F&&(A&&(F.innerHTML=""),F.innerHTML+=`<br>${Z}`)}},Gt=U;class jt{static get version(){return Gt}static get workerCount(){return wn.workerCount}static set workerCount(A){wn.workerCount=A}static get maxParallelImageRequests(){return a.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(A){a.c.MAX_PARALLEL_IMAGE_REQUESTS=A}static get workerUrl(){return a.c.WORKER_URL}static set workerUrl(A){a.c.WORKER_URL=A}static addProtocol(A,I){a.c.REGISTERED_PROTOCOLS[A]=I}static removeProtocol(A){delete a.c.REGISTERED_PROTOCOLS[A]}}return jt.Map=class extends _r{constructor(Z){if(a.bg.mark(a.bh.create),(Z=a.e({},zi,Z)).minZoom!=null&&Z.maxZoom!=null&&Z.minZoom>Z.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Z.minPitch!=null&&Z.maxPitch!=null&&Z.minPitch>Z.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Z.minPitch!=null&&Z.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(Z.maxPitch!=null&&Z.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ea(Z.minZoom,Z.maxZoom,Z.minPitch,Z.maxPitch,Z.renderWorldCopies),{bearingSnap:Z.bearingSnap}),this._cooperativeGesturesOnWheel=A=>{this._onCooperativeGesture(A,A[this._metaKey],1)},this._contextLost=A=>{A.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.k("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.k("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=Z.interactive,this._cooperativeGestures=Z.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=Z.maxTileCacheSize,this._maxTileCacheZoomLevels=Z.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=Z.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Z.preserveDrawingBuffer,this._antialias=Z.antialias,this._trackResize=Z.trackResize,this._bearingSnap=Z.bearingSnap,this._refreshExpiredTiles=Z.refreshExpiredTiles,this._fadeDuration=Z.fadeDuration,this._crossSourceCollisions=Z.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Z.collectResourceTiming,this._renderTaskQueue=new Gn,this._controls=[],this._mapId=a.a2(),this._locale=a.e({},Jn,Z.locale),this._clickTolerance=Z.clickTolerance,this._overridePixelRatio=Z.pixelRatio,this._maxCanvasSize=Z.maxCanvasSize,this.transformCameraUpdate=Z.transformCameraUpdate,this._imageQueueHandle=Ke.addThrottleControl(()=>this.isMoving()),this._requestManager=new ut(Z.transformRequest),typeof Z.container=="string"){if(this._container=document.getElementById(Z.container),!this._container)throw new Error(`Container '${Z.container}' not found.`)}else{if(!(Z.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Z.container}if(Z.maxBounds&&this.setMaxBounds(Z.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const I=Sa(F=>{this._trackResize&&!this._removed&&this.resize(F)._update()},50);this._resizeObserver=new ResizeObserver(F=>{A?I(F):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ou(this,Z),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=Z.hash&&new ka(typeof Z.hash=="string"&&Z.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}),Z.bounds&&(this.resize(),this.fitBounds(Z.bounds,a.e({},Z.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Z.localIdeographFontFamily,this._validateStyle=Z.validateStyle,Z.style&&this.setStyle(Z.style,{localIdeographFontFamily:Z.localIdeographFontFamily}),Z.attributionControl&&this.addControl(new ds({customAttribution:Z.customAttribution})),Z.maplibreLogo&&this.addControl(new pn,Z.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new a.k(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new a.k(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new a.k("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(Z,A){if(A===void 0&&(A=Z.getDefaultPosition?Z.getDefaultPosition():"top-right"),!Z||!Z.onAdd)return this.fire(new a.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const I=Z.onAdd(this);this._controls.push(Z);const F=this._controlPositions[A];return A.indexOf("bottom")!==-1?F.insertBefore(I,F.firstChild):F.appendChild(I),this}removeControl(Z){if(!Z||!Z.onRemove)return this.fire(new a.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const A=this._controls.indexOf(Z);return A>-1&&this._controls.splice(A,1),Z.onRemove(this),this}hasControl(Z){return this._controls.indexOf(Z)>-1}calculateCameraOptionsFromTo(Z,A,I,F){return F==null&&this.terrain&&(F=this.terrain.getElevationForLngLatZoom(I,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(Z,A,I,F)}resize(Z){var A;const I=this._containerDimensions(),F=I[0],O=I[1],y=this._getClampedPixelRatio(F,O);if(this._resizeCanvas(F,O,y),this.painter.resize(F,O,y),this.painter.overLimit()){const i=this.painter.context.gl;this._maxCanvasSize=[i.drawingBufferWidth,i.drawingBufferHeight];const r=this._getClampedPixelRatio(F,O);this._resizeCanvas(F,O,r),this.painter.resize(F,O,r)}this.transform.resize(F,O),(A=this._requestedCameraState)===null||A===void 0||A.resize(F,O);const s=!this._moving;return s&&(this.stop(),this.fire(new a.k("movestart",Z)).fire(new a.k("move",Z))),this.fire(new a.k("resize",Z)),s&&this.fire(new a.k("moveend",Z)),this}_getClampedPixelRatio(Z,A){const{0:I,1:F}=this._maxCanvasSize,O=this.getPixelRatio(),y=Z*O,s=A*O;return Math.min(y>I?I/y:1,s>F?F/s:1)*O}getPixelRatio(){var Z;return(Z=this._overridePixelRatio)!==null&&Z!==void 0?Z:devicePixelRatio}setPixelRatio(Z){this._overridePixelRatio=Z,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(Z){return this.transform.setMaxBounds(Gi.convert(Z)),this._update()}setMinZoom(Z){if((Z=Z??-2)>=-2&&Z<=this.transform.maxZoom)return this.transform.minZoom=Z,this._update(),this.getZoom()<Z&&this.setZoom(Z),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(Z){if((Z=Z??22)>=this.transform.minZoom)return this.transform.maxZoom=Z,this._update(),this.getZoom()>Z&&this.setZoom(Z),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(Z){if((Z=Z??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(Z>=0&&Z<=this.transform.maxPitch)return this.transform.minPitch=Z,this._update(),this.getPitch()<Z&&this.setPitch(Z),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(Z){if((Z=Z??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(Z>=this.transform.minPitch)return this.transform.maxPitch=Z,this._update(),this.getPitch()>Z&&this.setPitch(Z),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(Z){return this.transform.renderWorldCopies=Z,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(Z){return this._cooperativeGestures=Z,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(Z){return this.transform.locationPoint(a.L.convert(Z),this.style&&this.terrain)}unproject(Z){return this.transform.pointLocation(a.P.convert(Z),this.terrain)}isMoving(){var Z;return this._moving||((Z=this.handlers)===null||Z===void 0?void 0:Z.isMoving())}isZooming(){var Z;return this._zooming||((Z=this.handlers)===null||Z===void 0?void 0:Z.isZooming())}isRotating(){var Z;return this._rotating||((Z=this.handlers)===null||Z===void 0?void 0:Z.isRotating())}_createDelegatedListener(Z,A,I){if(Z==="mouseenter"||Z==="mouseover"){let F=!1;return{layer:A,listener:I,delegates:{mousemove:y=>{const s=this.getLayer(A)?this.queryRenderedFeatures(y.point,{layers:[A]}):[];s.length?F||(F=!0,I.call(this,new Ot(Z,this,y.originalEvent,{features:s}))):F=!1},mouseout:()=>{F=!1}}}}if(Z==="mouseleave"||Z==="mouseout"){let F=!1;return{layer:A,listener:I,delegates:{mousemove:s=>{(this.getLayer(A)?this.queryRenderedFeatures(s.point,{layers:[A]}):[]).length?F=!0:F&&(F=!1,I.call(this,new Ot(Z,this,s.originalEvent)))},mouseout:s=>{F&&(F=!1,I.call(this,new Ot(Z,this,s.originalEvent)))}}}}{const F=O=>{const y=this.getLayer(A)?this.queryRenderedFeatures(O.point,{layers:[A]}):[];y.length&&(O.features=y,I.call(this,O),delete O.features)};return{layer:A,listener:I,delegates:{[Z]:F}}}}on(Z,A,I){if(I===void 0)return super.on(Z,A);const F=this._createDelegatedListener(Z,A,I);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Z]=this._delegatedListeners[Z]||[],this._delegatedListeners[Z].push(F);for(const O in F.delegates)this.on(O,F.delegates[O]);return this}once(Z,A,I){if(I===void 0)return super.once(Z,A);const F=this._createDelegatedListener(Z,A,I);for(const O in F.delegates)this.once(O,F.delegates[O]);return this}off(Z,A,I){return I===void 0?super.off(Z,A):(this._delegatedListeners&&this._delegatedListeners[Z]&&(F=>{const O=this._delegatedListeners[Z];for(let y=0;y<O.length;y++){const s=O[y];if(s.layer===A&&s.listener===I){for(const i in s.delegates)this.off(i,s.delegates[i]);return O.splice(y,1),this}}})(),this)}queryRenderedFeatures(Z,A){if(!this.style)return[];let I;const F=Z instanceof a.P||Array.isArray(Z),O=F?Z:[[0,0],[this.transform.width,this.transform.height]];if(A=A||(F?{}:Z)||{},O instanceof a.P||typeof O[0]=="number")I=[a.P.convert(O)];else{const y=a.P.convert(O[0]),s=a.P.convert(O[1]);I=[y,new a.P(s.x,y.y),s,new a.P(y.x,s.y),y]}return this.style.queryRenderedFeatures(I,A,this.transform)}querySourceFeatures(Z,A){return this.style.querySourceFeatures(Z,A)}setStyle(Z,A){return(A=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},A)).diff!==!1&&A.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&Z?(this._diffStyle(Z,A),this):(this._localIdeographFontFamily=A.localIdeographFontFamily,this._updateStyle(Z,A))}setTransformRequest(Z){return this._requestManager.setTransformRequest(Z),this}_getUIString(Z){const A=this._locale[Z];if(A==null)throw new Error(`Missing UI string '${Z}'`);return A}_updateStyle(Z,A){if(A.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(Z,A));const I=this.style&&A.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!Z)),Z?(this.style=new ur(this,A||{}),this.style.setEventedParent(this,{style:this.style}),typeof Z=="string"?this.style.loadURL(Z,A,I):this.style.loadJSON(Z,A,I),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ur(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(Z,A){if(typeof Z=="string"){const I=this._requestManager.transformRequest(Z,st.Style);a.f(I,(F,O)=>{F?this.fire(new a.j(F)):O&&this._updateDiff(O,A)})}else typeof Z=="object"&&this._updateDiff(Z,A)}_updateDiff(Z,A){try{this.style.setState(Z,A)&&this._update(!0)}catch(I){a.w(`Unable to perform style diff: ${I.message||I.error||I}.  Rebuilding the style from scratch.`),this._updateStyle(Z,A)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(Z,A){return this._lazyInitEmptyStyle(),this.style.addSource(Z,A),this._update(!0)}isSourceLoaded(Z){const A=this.style&&this.style.sourceCaches[Z];if(A!==void 0)return A.loaded();this.fire(new a.j(new Error(`There is no source with ID '${Z}'`)))}setTerrain(Z){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),Z){const A=this.style.sourceCaches[Z.source];if(!A)throw new Error(`cannot load terrain, because there exists no source with ID: ${Z.source}`);for(const I in this.style._layers){const F=this.style._layers[I];F.type==="hillshade"&&F.source===Z.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new oa(this.painter,A,Z),this.painter.renderToTexture=new Co(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=I=>{I.dataType==="style"?this.terrain.sourceCache.freeRtt():I.dataType==="source"&&I.tile&&(I.sourceId!==Z.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(I.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new a.k("terrain",{terrain:Z})),this}getTerrain(){var Z,A;return(A=(Z=this.terrain)===null||Z===void 0?void 0:Z.options)!==null&&A!==void 0?A:null}areTilesLoaded(){const Z=this.style&&this.style.sourceCaches;for(const A in Z){const I=Z[A]._tiles;for(const F in I){const O=I[F];if(O.state!=="loaded"&&O.state!=="errored")return!1}}return!0}addSourceType(Z,A,I){return this._lazyInitEmptyStyle(),this.style.addSourceType(Z,A,I)}removeSource(Z){return this.style.removeSource(Z),this._update(!0)}getSource(Z){return this.style.getSource(Z)}addImage(Z,A,I={}){const{pixelRatio:F=1,sdf:O=!1,stretchX:y,stretchY:s,content:i}=I;if(this._lazyInitEmptyStyle(),!(A instanceof HTMLImageElement||a.a(A))){if(A.width===void 0||A.height===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:l,data:d}=A,_=A;return this.style.addImage(Z,{data:new a.R({width:r,height:l},new Uint8Array(d)),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0,userImage:_}),_.onAdd&&_.onAdd(this,Z),this}}{const{width:r,height:l,data:d}=a.h.getImageData(A);this.style.addImage(Z,{data:new a.R({width:r,height:l},d),pixelRatio:F,stretchX:y,stretchY:s,content:i,sdf:O,version:0})}}updateImage(Z,A){const I=this.style.getImage(Z);if(!I)return this.fire(new a.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const F=A instanceof HTMLImageElement||a.a(A)?a.h.getImageData(A):A,{width:O,height:y,data:s}=F;if(O===void 0||y===void 0)return this.fire(new a.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(O!==I.data.width||y!==I.data.height)return this.fire(new a.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const i=!(A instanceof HTMLImageElement||a.a(A));return I.data.replace(s,i),this.style.updateImage(Z,I),this}getImage(Z){return this.style.getImage(Z)}hasImage(Z){return Z?!!this.style.getImage(Z):(this.fire(new a.j(new Error("Missing required image id"))),!1)}removeImage(Z){this.style.removeImage(Z)}loadImage(Z,A){Ke.getImage(this._requestManager.transformRequest(Z,st.Image),A)}listImages(){return this.style.listImages()}addLayer(Z,A){return this._lazyInitEmptyStyle(),this.style.addLayer(Z,A),this._update(!0)}moveLayer(Z,A){return this.style.moveLayer(Z,A),this._update(!0)}removeLayer(Z){return this.style.removeLayer(Z),this._update(!0)}getLayer(Z){return this.style.getLayer(Z)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(Z,A,I){return this.style.setLayerZoomRange(Z,A,I),this._update(!0)}setFilter(Z,A,I={}){return this.style.setFilter(Z,A,I),this._update(!0)}getFilter(Z){return this.style.getFilter(Z)}setPaintProperty(Z,A,I,F={}){return this.style.setPaintProperty(Z,A,I,F),this._update(!0)}getPaintProperty(Z,A){return this.style.getPaintProperty(Z,A)}setLayoutProperty(Z,A,I,F={}){return this.style.setLayoutProperty(Z,A,I,F),this._update(!0)}getLayoutProperty(Z,A){return this.style.getLayoutProperty(Z,A)}setGlyphs(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(Z,A),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(Z,A,I={}){return this._lazyInitEmptyStyle(),this.style.addSprite(Z,A,I,F=>{F||this._update(!0)}),this}removeSprite(Z){return this._lazyInitEmptyStyle(),this.style.removeSprite(Z),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setSprite(Z,A,I=>{I||this._update(!0)}),this}setLight(Z,A={}){return this._lazyInitEmptyStyle(),this.style.setLight(Z,A),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(Z,A){return this.style.setFeatureState(Z,A),this._update()}removeFeatureState(Z,A){return this.style.removeFeatureState(Z,A),this._update()}getFeatureState(Z){return this.style.getFeatureState(Z)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let Z=0,A=0;return this._container&&(Z=this._container.clientWidth||400,A=this._container.clientHeight||300),[Z,A]}_setupContainer(){const Z=this._container;Z.classList.add("maplibregl-map");const A=this._canvasContainer=W.create("div","maplibregl-canvas-container",Z);this._interactive&&A.classList.add("maplibregl-interactive"),this._canvas=W.create("canvas","maplibregl-canvas",A),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const I=this._containerDimensions(),F=this._getClampedPixelRatio(I[0],I[1]);this._resizeCanvas(I[0],I[1],F);const O=this._controlContainer=W.create("div","maplibregl-control-container",Z),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{y[s]=W.create("div",`maplibregl-ctrl-${s} `,O)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=W.create("div","maplibregl-cooperative-gesture-screen",this._container);let Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(Z=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${Z}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){W.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(Z,A,I){this._canvas.width=Math.floor(I*Z),this._canvas.height=Math.floor(I*A),this._canvas.style.width=`${Z}px`,this._canvas.style.height=`${A}px`}_setupPainter(){const Z={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let A=null;this._canvas.addEventListener("webglcontextcreationerror",F=>{A={requestedAttributes:Z},F&&(A.statusMessage=F.statusMessage,A.type=F.type)},{once:!0});const I=this._canvas.getContext("webgl2",Z)||this._canvas.getContext("webgl",Z);if(!I){const F="Failed to initialize WebGL";throw A?(A.message=F,new Error(JSON.stringify(A))):new Error(F)}this.painter=new mr(I,this.transform),ce.testSupport(I)}_onCooperativeGesture(Z,A,I){return!A&&I<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(Z){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||Z,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(Z){return this._update(),this._renderTaskQueue.add(Z)}_cancelRenderFrame(Z){this._renderTaskQueue.remove(Z)}_render(Z){const A=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(Z),this._removed)return;let I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,y=a.h.now();this.style.zoomHistory.update(O,y);const s=new a.a8(O,{now:y,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=s.crossFadingFactor();i===1&&i===this._crossFadingFactor||(I=!0,this._crossFadingFactor=i),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new a.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.bg.mark(a.bh.load),this.fire(new a.k("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.k("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,a.bg.mark(a.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var Z;this._hash&&this._hash.remove();for(const I of this._controls)I.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ke.removeThrottleControl(this._imageQueueHandle),(Z=this._resizeObserver)===null||Z===void 0||Z.disconnect();const A=this.painter.context.gl.getExtension("WEBGL_lose_context");A&&A.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),W.remove(this._canvasContainer),W.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),a.bg.clearMetrics(),this._removed=!0,this.fire(new a.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.h.frame(Z=>{a.bg.frame(Z),this._frame=null,this._render(Z)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(Z){this._showTileBoundaries!==Z&&(this._showTileBoundaries=Z,this._update())}get showPadding(){return!!this._showPadding}set showPadding(Z){this._showPadding!==Z&&(this._showPadding=Z,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(Z){this._showCollisionBoxes!==Z&&(this._showCollisionBoxes=Z,Z?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(Z){this._showOverdrawInspector!==Z&&(this._showOverdrawInspector=Z,this._update())}get repaint(){return!!this._repaint}set repaint(Z){this._repaint!==Z&&(this._repaint=Z,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(Z){this._vertices=Z,this._update()}get version(){return Mi}getCameraTargetElevation(){return this.transform.elevation}},jt.NavigationControl=class{constructor(Z){this._updateZoomButtons=()=>{const A=this._map.getZoom(),I=A===this._map.getMaxZoom(),F=A===this._map.getMinZoom();this._zoomInButton.disabled=I,this._zoomOutButton.disabled=F,this._zoomInButton.setAttribute("aria-disabled",I.toString()),this._zoomOutButton.setAttribute("aria-disabled",F.toString())},this._rotateCompassArrow=()=>{const A=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=A},this._setButtonTitle=(A,I)=>{const F=this._map._getUIString(`NavigationControl.${I}`);A.title=F,A.setAttribute("aria-label",F)},this.options=a.e({},yu,Z),this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",A=>A.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",A=>this._map.zoomIn({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",A=>this._map.zoomOut({},{originalEvent:A})),W.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",A=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:A}):this._map.resetNorth({},{originalEvent:A})}),this._compassIcon=W.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(Z){return this._map=Z,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Oo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){W.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(Z,A){const I=W.create("button",Z,this._container);return I.type="button",I.addEventListener("click",A),I}},jt.GeolocateControl=class extends a.E{constructor(Z){super(),this._onSuccess=A=>{if(this._map){if(this._isOutOfMapMaxBounds(A))return this._setErrorState(),this.fire(new a.k("outofmaxbounds",A)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=A,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(A),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(A),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.k("geolocate",A)),this._finish()}},this._updateCamera=A=>{const I=new a.L(A.coords.longitude,A.coords.latitude),F=A.coords.accuracy,O=this._map.getBearing(),y=a.e({bearing:O},this.options.fitBoundsOptions),s=Gi.fromLngLat(I,F);this._map.fitBounds(s,y,{geolocateSource:!0})},this._updateMarker=A=>{if(A){const I=new a.L(A.coords.longitude,A.coords.latitude);this._accuracyCircleMarker.setLngLat(I).addTo(this._map),this._userLocationDotMarker.setLngLat(I).addTo(this._map),this._accuracy=A.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=A=>{if(this._map){if(this.options.trackUserLocation)if(A.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const I=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=I,this._geolocateButton.setAttribute("aria-label",I),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(A.code===3&&ee)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.k("error",A)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=A=>{if(this._map){if(this._container.addEventListener("contextmenu",I=>I.preventDefault()),this._geolocateButton=W.create("button","maplibregl-ctrl-geolocate",this._container),W.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",A===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const I=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=I,this._geolocateButton.setAttribute("aria-label",I)}else{const I=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=I,this._geolocateButton.setAttribute("aria-label",I)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new D({element:this._dotElement}),this._circleElement=W.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new D({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",I=>{I.geolocateSource||this._watchState!=="ACTIVE_LOCK"||I.originalEvent&&I.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.k("trackuserlocationend")))})}},this.options=a.e({},z,Z)}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(A,I=!1){cs===void 0||I?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(F=>{cs=F.state!=="denied",A(cs)}).catch(()=>{cs=!!window.navigator.geolocation,A(cs)}):(cs=!!window.navigator.geolocation,A(cs)):A(cs)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),W.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,R=0,ee=!1}_isOutOfMapMaxBounds(Z){const A=this._map.getMaxBounds(),I=Z.coords;return A&&(I.longitude<A.getWest()||I.longitude>A.getEast()||I.latitude<A.getSouth()||I.latitude>A.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const Z=this._map.getBounds(),A=Z.getSouthEast(),I=Z.getNorthEast(),F=A.distanceTo(I),O=Math.ceil(this._accuracy/(F/this._map._container.clientHeight)*2);this._circleElement.style.width=`${O}px`,this._circleElement.style.height=`${O}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":R--,ee=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let Z;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),R++,R>1?(Z={maximumAge:6e5,timeout:0},ee=!0):(Z=this.options.positionOptions,ee=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Z)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},jt.AttributionControl=ds,jt.LogoControl=pn,jt.ScaleControl=class{constructor(Z){this._onMove=()=>{ae(this._map,this._container,this.options)},this.setUnit=A=>{this.options.unit=A,ae(this._map,this._container,this.options)},this.options=a.e({},le,Z)}getDefaultPosition(){return"bottom-left"}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-scale",Z.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){W.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},jt.FullscreenControl=class extends a.E{constructor(Z={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,Z&&Z.container&&(Z.container instanceof HTMLElement?this._container=Z.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(Z){return this._map=Z,this._container||(this._container=this._map.getContainer()),this._controlContainer=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){W.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const Z=this._fullscreenButton=W.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);W.create("span","maplibregl-ctrl-icon",Z).setAttribute("aria-hidden","true"),Z.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const Z=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Z),this._fullscreenButton.title=Z}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new a.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},jt.TerrainControl=class{constructor(Z){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=Z}onAdd(Z){return this._map=Z,this._container=W.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=W.create("button","maplibregl-ctrl-terrain",this._container),W.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){W.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},jt.Popup=class extends a.E{constructor(Z){super(),this.remove=()=>(this._content&&W.remove(this._content),this._container&&(W.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.k("close")),this),this._onMouseUp=A=>{this._update(A.point)},this._onMouseMove=A=>{this._update(A.point)},this._onDrag=A=>{this._update(A.point)},this._update=A=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=W.create("div","maplibregl-popup",this._map.getContainer()),this._tip=W.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const s of this.options.className.split(" "))this._container.classList.add(s);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ul(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!A)return;const I=this._pos=this._trackPointer&&A?A:this._map.project(this._lngLat);let F=this.options.anchor;const O=Ct(this.options.offset);if(!F){const s=this._container.offsetWidth,i=this._container.offsetHeight;let r;r=I.y+O.bottom.y<i?["top"]:I.y>this._map.transform.height-i?["bottom"]:[],I.x<s/2?r.push("left"):I.x>this._map.transform.width-s/2&&r.push("right"),F=r.length===0?"bottom":r.join("-")}const y=I.add(O[F]).round();W.setTransform(this._container,`${Ps[F]} translate(${y.x}px,${y.y}px)`),C(this._container,F,"popup")},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(We),Z)}addTo(Z){return this._map&&this.remove(),this._map=Z,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(Z){return this._lngLat=a.L.convert(Z),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(Z){return this.setDOMContent(document.createTextNode(Z))}setHTML(Z){const A=document.createDocumentFragment(),I=document.createElement("body");let F;for(I.innerHTML=Z;F=I.firstChild,F;)A.appendChild(F);return this.setDOMContent(A)}getMaxWidth(){var Z;return(Z=this._container)===null||Z===void 0?void 0:Z.style.maxWidth}setMaxWidth(Z){return this.options.maxWidth=Z,this._update(),this}setDOMContent(Z){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=W.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(Z),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(Z){this._container&&this._container.classList.add(Z)}removeClassName(Z){this._container&&this._container.classList.remove(Z)}setOffset(Z){return this.options.offset=Z,this._update(),this}toggleClassName(Z){if(this._container)return this._container.classList.toggle(Z)}_createCloseButton(){this.options.closeButton&&(this._closeButton=W.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const Z=this._container.querySelector(yt);Z&&Z.focus()}},jt.Marker=D,jt.Style=ur,jt.LngLat=a.L,jt.LngLatBounds=Gi,jt.Point=a.P,jt.MercatorCoordinate=a.U,jt.Evented=a.E,jt.AJAXError=a.bi,jt.config=a.c,jt.CanvasSource=Li,jt.GeoJSONSource=Ti,jt.ImageSource=hi,jt.RasterDEMTileSource=sn,jt.RasterTileSource=qi,jt.VectorTileSource=$i,jt.VideoSource=Ei,jt.setRTLTextPlugin=a.bj,jt.getRTLTextPluginStatus=a.bk,jt.prewarm=function(){V().acquire(Qn)},jt.clearPrewarmedResources=function(){const Z=k;Z&&(Z.isPreloaded()&&Z.numActive()===1?(Z.release(Qn),k=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},ii.extend(jt,{isSafari:a.ac,getPerformanceMetrics:a.bg.getPerformanceMetrics}),jt});var E=g;return E})})(cO);var zg=Uint8Array,KS=Uint16Array,hO=Int32Array,AO=new zg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fO=new zg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),JS=function(e,t){for(var n=new KS(31),c=0;c<31;++c)n[c]=t+=1<<e[c-1];for(var g=new hO(n[30]),c=1;c<30;++c)for(var b=n[c];b<n[c+1];++b)g[b]=b-n[c]<<5|c;return{b:n,r:g}},e5=JS(AO,2),dO=e5.b,pO=e5.r;dO[28]=258,pO[258]=28;JS(fO,0);var mO=new KS(32768);for(Ka=0;Ka<32768;++Ka)Wf=(Ka&43690)>>1|(Ka&21845)<<1,Wf=(Wf&52428)>>2|(Wf&13107)<<2,Wf=(Wf&61680)>>4|(Wf&3855)<<4,mO[Ka]=((Wf&65280)>>8|(Wf&255)<<8)>>1;var Wf,Ka,u1=new zg(288);for(Ka=0;Ka<144;++Ka)u1[Ka]=8;var Ka;for(Ka=144;Ka<256;++Ka)u1[Ka]=9;var Ka;for(Ka=256;Ka<280;++Ka)u1[Ka]=7;var Ka;for(Ka=280;Ka<288;++Ka)u1[Ka]=8;var Ka,gO=new zg(32);for(Ka=0;Ka<32;++Ka)gO[Ka]=5;var Ka,_O=new zg(0),yO=typeof TextDecoder<"u"&&new TextDecoder,vO=0;try{yO.decode(_O,{stream:!0}),vO=1}catch{}var x2={exports:{}},xO=wO,bO={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function wO(e){if(!e||!e.type)return null;var t=bO[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}function u_(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,n){return t.concat(u_(n))},[]),e;case"Feature":return e.geometry?u_(e.geometry).map(function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return e.id!==void 0&&(n.id=e.id),n}):[e];case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries.map(u_).reduce(function(t,n){return t.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[e]}}const SO=Object.freeze(Object.defineProperty({__proto__:null,default:u_},Symbol.toStringTag,{value:"Module"})),IO=Pv(SO);var EO=function(t){return n(t);function n(c){return Array.isArray(c)&&c.length&&typeof c[0]=="number"?[c]:c.reduce(function(g,b){return Array.isArray(b)&&Array.isArray(b[0])?g.concat(n(b)):(g.push(b),g)},[])}},CO=xO,c_=IO,TO=EO;c_ instanceof Function||(c_=c_.default);var kO=function(e){if(!e)return[];var t=c_(CO(e)),n=[];return t.features.forEach(function(c){c.geometry&&(n=n.concat(TO(c.geometry.coordinates)))}),n};function wm(e){return Object.prototype.toString.call(e)}function MO(e){return wm(e)==="[object Date]"}function PO(e){return wm(e)==="[object RegExp]"}function DO(e){return wm(e)==="[object Error]"}function LO(e){return wm(e)==="[object Boolean]"}function BO(e){return wm(e)==="[object Number]"}function zO(e){return wm(e)==="[object String]"}var t5=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function c1(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)}var RO=Object.keys||function(t){var n=[];for(var c in t)n.push(c);return n},FO=Object.prototype.propertyIsEnumerable,_w=Object.getOwnPropertySymbols;function h1(e){var t=RO(e);if(_w)for(var n=_w(e),c=0;c<n.length;c++)FO.call(e,n[c])&&t.push(n[c]);return t}var A1=Object.prototype.hasOwnProperty||function(e,t){return t in e};function i5(e){if(typeof e=="object"&&e!==null){var t;if(t5(e))t=[];else if(MO(e))t=new Date(e.getTime?e.getTime():e);else if(PO(e))t=new RegExp(e);else if(DO(e))t={message:e.message};else if(LO(e)||BO(e)||zO(e))t=Object(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},c=function(){};c.prototype=n,t=new c}return c1(h1(e),function(g){t[g]=e[g]}),t}return e}function n5(e,t,n){var c=[],g=[],b=!0;return function E(a){var U=n?i5(a):a,W={},ce=!0,oe={node:U,node_:a,path:[].concat(c),parent:g[g.length-1],parents:g,key:c[c.length-1],isRoot:c.length===0,level:c.length,circular:null,update:function(et,lt){oe.isRoot||(oe.parent.node[oe.key]=et),oe.node=et,lt&&(ce=!1)},delete:function(et){delete oe.parent.node[oe.key],et&&(ce=!1)},remove:function(et){t5(oe.parent.node)?oe.parent.node.splice(oe.key,1):delete oe.parent.node[oe.key],et&&(ce=!1)},keys:null,before:function(et){W.before=et},after:function(et){W.after=et},pre:function(et){W.pre=et},post:function(et){W.post=et},stop:function(){b=!1},block:function(){ce=!1}};if(!b)return oe;function fe(){if(typeof oe.node=="object"&&oe.node!==null){(!oe.keys||oe.node_!==oe.node)&&(oe.keys=h1(oe.node)),oe.isLeaf=oe.keys.length===0;for(var et=0;et<g.length;et++)if(g[et].node_===a){oe.circular=g[et];break}}else oe.isLeaf=!0,oe.keys=null;oe.notLeaf=!oe.isLeaf,oe.notRoot=!oe.isRoot}fe();var we=t.call(oe,oe.node);return we!==void 0&&oe.update&&oe.update(we),W.before&&W.before.call(oe,oe.node),ce&&(typeof oe.node=="object"&&oe.node!==null&&!oe.circular&&(g.push(oe),fe(),c1(oe.keys,function(et,lt){c.push(et),W.pre&&W.pre.call(oe,oe.node[et],et);var Ke=E(oe.node[et]);n&&A1.call(oe.node,et)&&(oe.node[et]=Ke.node),Ke.isLast=lt===oe.keys.length-1,Ke.isFirst=lt===0,W.post&&W.post.call(oe,Ke),c.pop()}),g.pop()),W.after&&W.after.call(oe,oe.node)),oe}(e).node}function Fh(e){this.value=e}Fh.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!A1.call(t,c))return;t=t[c]}return t};Fh.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var c=e[n];if(!t||!A1.call(t,c))return!1;t=t[c]}return!0};Fh.prototype.set=function(e,t){for(var n=this.value,c=0;c<e.length-1;c++){var g=e[c];A1.call(n,g)||(n[g]={}),n=n[g]}return n[e[c]]=t,t};Fh.prototype.map=function(e){return n5(this.value,e,!0)};Fh.prototype.forEach=function(e){return this.value=n5(this.value,e,!1),this.value};Fh.prototype.reduce=function(e,t){var n=arguments.length===1,c=n?this.value:t;return this.forEach(function(g){(!this.isRoot||!n)&&(c=e.call(this,c,g))}),c};Fh.prototype.paths=function(){var e=[];return this.forEach(function(){e.push(this.path)}),e};Fh.prototype.nodes=function(){var e=[];return this.forEach(function(){e.push(this.node)}),e};Fh.prototype.clone=function(){var e=[],t=[];return function n(c){for(var g=0;g<e.length;g++)if(e[g]===c)return t[g];if(typeof c=="object"&&c!==null){var b=i5(c);return e.push(c),t.push(b),c1(h1(c),function(E){b[E]=n(c[E])}),e.pop(),t.pop(),b}return c}(this.value)};function r5(e){return new Fh(e)}c1(h1(Fh.prototype),function(e){r5[e]=function(t){var n=[].slice.call(arguments,1),c=new Fh(t);return c[e].apply(c,n)}});var OO=r5,NO=yc;function yc(e){if(!(this instanceof yc))return new yc(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}yc.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};yc.prototype.equals=function(e){var t;return e instanceof yc?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};yc.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};yc.prototype.union=function(e){this._valid=!0;var t;return e instanceof yc?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};yc.prototype.bbox=function(){return this._valid?this._bbox:null};yc.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],n=e[1];return this._bbox[0]<=t&&this._bbox[1]<=n&&this._bbox[2]>=t&&this._bbox[3]>=n};yc.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof yc?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};yc.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};yc.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var VO=kO,UO=OO,GO=NO,s5={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},qO=Object.keys(s5);x2.exports=function(e){return b2(e).bbox()};x2.exports.polygon=function(e){return b2(e).polygon()};x2.exports.bboxify=function(e){return UO(e).map(function(t){if(t){var n=qO.some(function(c){return t[c]?s5[c].indexOf(t.type)!==-1:!1});n&&(t.bbox=b2(t).bbox(),this.update(t))}})};function b2(e){for(var t=GO(),n=VO(e),c=0;c<n.length;c++)t.include(n[c]);return t}var kn=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function b(De){return t.locateFile?t.locateFile(De,g):g+De}var E;document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",E=function(Ue,ht,Tt){var o=new XMLHttpRequest;o.open("GET",Ue,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ht(o.response);return}var ai=ft(Ue);if(ai){ht(ai.buffer);return}Tt()},o.onerror=Tt,o.send(null)};var a=t.print||console.log.bind(console),U=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,ce=function(De){W=De},oe=function(){return W},fe=8;function we(De,Ue,ht,Tt){switch(ht=ht||"i8",ht.charAt(ht.length-1)==="*"&&(ht="i32"),ht){case"i1":bt[De>>0]=Ue;break;case"i8":bt[De>>0]=Ue;break;case"i16":nt[De>>1]=Ue;break;case"i32":pt[De>>2]=Ue;break;case"i64":wn=[Ue>>>0,(Qn=Ue,+fn(Qn)>=1?Qn>0?(mn(+gi(Qn/4294967296),4294967295)|0)>>>0:~~+_n((Qn-+(~~Qn>>>0))/4294967296)>>>0:0)],pt[De>>2]=wn[0],pt[De+4>>2]=wn[1];break;case"float":at[De>>2]=Ue;break;case"double":Nt[De>>3]=Ue;break;default:Ye("invalid type for setValue: "+ht)}}function et(De,Ue,ht){switch(Ue=Ue||"i8",Ue.charAt(Ue.length-1)==="*"&&(Ue="i32"),Ue){case"i1":return bt[De>>0];case"i8":return bt[De>>0];case"i16":return nt[De>>1];case"i32":return pt[De>>2];case"i64":return pt[De>>2];case"float":return at[De>>2];case"double":return Nt[De>>3];default:Ye("invalid type for getValue: "+Ue)}return null}var lt=!1;function Ke(De,Ue){De||Ye("Assertion failed: "+Ue)}function st(De){var Ue=t["_"+De];return Ke(Ue,"Cannot call unknown function "+De+", make sure it is exported"),Ue}function ut(De,Ue,ht,Tt,o){var ke={string:function(wi){var Yt=0;if(wi!=null&&wi!==0){var vn=(wi.length<<2)+1;Yt=X(vn),it(wi,Yt,vn)}return Yt},array:function(wi){var Yt=X(wi.length);return xt(wi,Yt),Yt}};function ai(wi){return Ue==="string"?Ge(wi):Ue==="boolean"?!!wi:wi}var di=st(De),Ai=[],Kt=0;if(Tt)for(var oi=0;oi<Tt.length;oi++){var Ri=ke[ht[oi]];Ri?(Kt===0&&(Kt=de()),Ai[oi]=Ri(Tt[oi])):Ai[oi]=Tt[oi]}var vi=di.apply(null,Ai);return vi=ai(vi),Kt!==0&&ie(Kt),vi}function kt(De,Ue,ht,Tt){ht=ht||[];var o=ht.every(function(ai){return ai==="number"}),ke=Ue!=="string";return ke&&o&&!Tt?st(De):function(){return ut(De,Ue,ht,arguments)}}var Bt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Rt(De,Ue,ht){for(var Tt=Ue+ht,o=Ue;De[o]&&!(o>=Tt);)++o;if(o-Ue>16&&De.subarray&&Bt)return Bt.decode(De.subarray(Ue,o));for(var ke="";Ue<o;){var ai=De[Ue++];if(!(ai&128)){ke+=String.fromCharCode(ai);continue}var di=De[Ue++]&63;if((ai&224)==192){ke+=String.fromCharCode((ai&31)<<6|di);continue}var Ai=De[Ue++]&63;if((ai&240)==224?ai=(ai&15)<<12|di<<6|Ai:ai=(ai&7)<<18|di<<12|Ai<<6|De[Ue++]&63,ai<65536)ke+=String.fromCharCode(ai);else{var Kt=ai-65536;ke+=String.fromCharCode(55296|Kt>>10,56320|Kt&1023)}}return ke}function Ge(De,Ue){return De?Rt(dt,De,Ue):""}function ni(De,Ue,ht,Tt){if(!(Tt>0))return 0;for(var o=ht,ke=ht+Tt-1,ai=0;ai<De.length;++ai){var di=De.charCodeAt(ai);if(di>=55296&&di<=57343){var Ai=De.charCodeAt(++ai);di=65536+((di&1023)<<10)|Ai&1023}if(di<=127){if(ht>=ke)break;Ue[ht++]=di}else if(di<=2047){if(ht+1>=ke)break;Ue[ht++]=192|di>>6,Ue[ht++]=128|di&63}else if(di<=65535){if(ht+2>=ke)break;Ue[ht++]=224|di>>12,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}else{if(ht+3>=ke)break;Ue[ht++]=240|di>>18,Ue[ht++]=128|di>>12&63,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}}return Ue[ht]=0,ht-o}function it(De,Ue,ht){return ni(De,dt,Ue,ht)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function xt(De,Ue){bt.set(De,Ue)}function _t(De,Ue){return De%Ue>0&&(De+=Ue-De%Ue),De}var mt,bt,dt,nt,pt,at,Nt;function Ft(De){mt=De,t.HEAP8=bt=new Int8Array(De),t.HEAP16=nt=new Int16Array(De),t.HEAP32=pt=new Int32Array(De),t.HEAPU8=dt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=at=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Dt=5266928,ci=24016,bi=t.TOTAL_MEMORY||33554432;t.buffer?mt=t.buffer:mt=new ArrayBuffer(bi),bi=mt.byteLength,Ft(mt),pt[ci>>2]=Dt;function ki(De){for(;De.length>0;){var Ue=De.shift();if(typeof Ue=="function"){Ue();continue}var ht=Ue.func;typeof ht=="number"?Ue.arg===void 0?t.dynCall_v(ht):t.dynCall_vi(ht,Ue.arg):ht(Ue.arg===void 0?null:Ue.arg)}}var Gi=[],rn=[],$i=[],qi=[];function sn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ei(t.preRun.shift());ki(Gi)}function Ti(){ki(rn)}function yi(){ki($i)}function hi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Li(t.postRun.shift());ki(qi)}function Ei(De){Gi.unshift(De)}function Li(De){qi.unshift(De)}var fn=Math.abs,_n=Math.ceil,gi=Math.floor,mn=Math.min,ti=0,Mn=null;function ns(De){ti++,t.monitorRunDependencies&&t.monitorRunDependencies(ti)}function fi(De){if(ti--,t.monitorRunDependencies&&t.monitorRunDependencies(ti),ti==0&&Mn){var Ue=Mn;Mn=null,Ue()}}t.preloadedImages={},t.preloadedAudios={};var ln=null,pr="data:application/octet-stream;base64,";function On(De){return String.prototype.startsWith?De.startsWith(pr):De.indexOf(pr)===0}var Qn,wn;ln="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var v=24032;function k(De){return De}function V(De){var Ue=/\b__Z[\w\d_]+/g;return De.replace(Ue,function(ht){var Tt=ht;return ht===Tt?ht:Tt+" ["+ht+"]"})}function $(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ue){De=Ue}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=$();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function Ae(De,Ue,ht,Tt){Ye("Assertion failed: "+Ge(De)+", at: "+[Ue?Ge(Ue):"unknown filename",ht,Tt?Ge(Tt):"unknown function"])}function ve(){return bt.length}function Ie(De,Ue,ht){dt.set(dt.subarray(Ue,Ue+ht),De)}function Ee(De){return t.___errno_location&&(pt[t.___errno_location()>>2]=De),De}function ze(De){Ye("OOM")}function Qe(De){try{var Ue=new ArrayBuffer(De);return Ue.byteLength!=De?void 0:(new Int8Array(Ue).set(bt),ne(Ue),Ft(Ue),1)}catch{}}function He(De){var Ue=ve(),ht=16777216,Tt=2147483648-ht;if(De>Tt)return!1;for(var o=16777216,ke=Math.max(Ue,o);ke<De;)ke<=536870912?ke=_t(2*ke,ht):ke=Math.min(_t((3*ke+2147483648)/4,ht),Tt);var ai=Qe(ke);return!!ai}var Ze=typeof atob=="function"?atob:function(De){var Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ht="",Tt,o,ke,ai,di,Ai,Kt,oi=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ai=Ue.indexOf(De.charAt(oi++)),di=Ue.indexOf(De.charAt(oi++)),Ai=Ue.indexOf(De.charAt(oi++)),Kt=Ue.indexOf(De.charAt(oi++)),Tt=ai<<2|di>>4,o=(di&15)<<4|Ai>>2,ke=(Ai&3)<<6|Kt,ht=ht+String.fromCharCode(Tt),Ai!==64&&(ht=ht+String.fromCharCode(o)),Kt!==64&&(ht=ht+String.fromCharCode(ke));while(oi<De.length);return ht};function Ve(De){try{for(var Ue=Ze(De),ht=new Uint8Array(Ue.length),Tt=0;Tt<Ue.length;++Tt)ht[Tt]=Ue.charCodeAt(Tt);return ht}catch{throw new Error("Converting base64 string to bytes failed.")}}function ft(De){if(On(De))return Ve(De.slice(pr.length))}var rt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ye,b:ce,c:oe,d:Ae,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:Qe,m:$,n:te,o:v,p:ci},se=function(De,Ue,ht){"almost asm";var Tt=new De.Int8Array(ht),o=new De.Int32Array(ht);new De.Uint8Array(ht),new De.Float32Array(ht);var ke=new De.Float64Array(ht),ai=Ue.p|0,di=De.Math.floor,Ai=De.Math.abs,Kt=De.Math.sqrt,oi=De.Math.pow,Ri=De.Math.cos,vi=De.Math.sin,wi=De.Math.tan,Yt=De.Math.acos,vn=De.Math.asin,ar=De.Math.atan,dn=De.Math.atan2,Vn=De.Math.ceil,Hr=De.Math.imul,Hi=De.Math.min,lr=De.Math.clz32,Fn=Ue.b,Qt=Ue.c,Yi=Ue.d,Ut=Ue.e,En=Ue.f,ur=Ue.g,Ns=Ue.h,Vr=Ue.i,Vt=24048;function cr(C){return Tt=new Int8Array(C),o=new Int32Array(C),ke=new Float64Array(C),ht=C,!0}function Lt(C){C=C|0;var D=0;return D=Vt,Vt=Vt+C|0,Vt=Vt+15&-16,D|0}function Br(){return Vt|0}function Vs(C){C=C|0,Vt=C}function ua(C,D){C=C|0,Vt=C}function kr(C){return C=C|0,(Hr(C*3|0,C+1|0)|0)+1|0}function Fa(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;Oa(C,D,z,R,0)|0&&(le=(Hr(z*3|0,z+1|0)|0)+1|0,cs(R|0,0,le<<3|0)|0,ee=Jo(le,4)|0,ee&&(Xs(C,D,z,R,ee,le,0),Jn(ee)))}function zo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0;if(Oa(C,D,z,R,ee)|0){if(le=(Hr(z*3|0,z+1|0)|0)+1|0,cs(R|0,0,le<<3|0)|0,ee|0){cs(ee|0,0,le<<2|0)|0,Xs(C,D,z,R,ee,le,0);return}ee=Jo(le,4)|0,ee&&(Xs(C,D,z,R,ee,le,0),Jn(ee))}}function Oa(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0;if(jt=Vt,Vt=Vt+16|0,Gt=jt,le=R,o[le>>2]=C,o[le+4>>2]=D,le=(ee|0)!=0,le&&(o[ee>>2]=0),hs(C,D)|0)return Gt=1,Vt=jt,Gt|0;o[Gt>>2]=0;e:do if((z|0)>=1)if(le)for(yt=0,Ct=1,ii=1,ae=0,le=C;;){if(!(ae|yt)){if(le=jn(le,D,4,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(hs(le,D)|0){le=1;break e}}if(le=jn(le,D,o[16+(yt<<2)>>2]|0,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ii<<3)|0,o[C>>2]=le,o[C+4>>2]=D,o[ee+(ii<<2)>>2]=Ct,ae=ae+1|0,C=(ae|0)==(Ct|0),be=yt+1|0,We=(be|0)==6,hs(le,D)|0){le=1;break e}if(Ct=Ct+(We&C&1)|0,(Ct|0)>(z|0)){le=0;break}else yt=C?We?0:be:yt,ii=ii+1|0,ae=C?0:ae}else for(yt=0,Ct=1,ii=1,ae=0,le=C;;){if(!(ae|yt)){if(le=jn(le,D,4,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(hs(le,D)|0){le=1;break e}}if(le=jn(le,D,o[16+(yt<<2)>>2]|0,Gt)|0,D=Qt()|0,(le|0)==0&(D|0)==0){le=2;break e}if(C=R+(ii<<3)|0,o[C>>2]=le,o[C+4>>2]=D,ae=ae+1|0,C=(ae|0)==(Ct|0),be=yt+1|0,We=(be|0)==6,hs(le,D)|0){le=1;break e}if(Ct=Ct+(We&C&1)|0,(Ct|0)>(z|0)){le=0;break}else yt=C?We?0:be:yt,ii=ii+1|0,ae=C?0:ae}else le=0;while(!1);return Gt=le,Vt=jt,Gt|0}function Xs(C,D,z,R,ee,le,ae){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0,ae=ae|0;var be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0;if(ii=Vt,Vt=Vt+16|0,Ct=ii,(C|0)==0&(D|0)==0){Vt=ii;return}if(be=Co(C|0,D|0,le|0,((le|0)<0)<<31>>31|0)|0,Qt()|0,We=R+(be<<3)|0,Gt=We,jt=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,yt=(jt|0)==(C|0)&(Gt|0)==(D|0),!((jt|0)==0&(Gt|0)==0|yt))do be=(be+1|0)%(le|0)|0,We=R+(be<<3)|0,jt=We,Gt=o[jt>>2]|0,jt=o[jt+4>>2]|0,yt=(Gt|0)==(C|0)&(jt|0)==(D|0);while(!((Gt|0)==0&(jt|0)==0|yt));if(be=ee+(be<<2)|0,yt&&(o[be>>2]|0)<=(ae|0)){Vt=ii;return}if(jt=We,o[jt>>2]=C,o[jt+4>>2]=D,o[be>>2]=ae,(ae|0)>=(z|0)){Vt=ii;return}jt=ae+1|0,o[Ct>>2]=0,Gt=jn(C,D,2,Ct)|0,Xs(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=jn(C,D,3,Ct)|0,Xs(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=jn(C,D,1,Ct)|0,Xs(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=jn(C,D,5,Ct)|0,Xs(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=jn(C,D,4,Ct)|0,Xs(Gt,Qt()|0,z,R,ee,le,jt),o[Ct>>2]=0,Gt=jn(C,D,6,Ct)|0,Xs(Gt,Qt()|0,z,R,ee,le,jt),Vt=ii}function jn(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0;if((o[R>>2]|0)>0){ee=0;do z=ca(z)|0,ee=ee+1|0;while((ee|0)<(o[R>>2]|0))}be=Mi(C|0,D|0,45)|0,Qt()|0,We=be&127,le=Js(C,D)|0,ee=Mi(C|0,D|0,52)|0,Qt()|0,ee=ee&15;e:do if(!ee)ae=6;else for(;;){if(ii=(15-ee|0)*3|0,Gt=Mi(C|0,D|0,ii|0)|0,Qt()|0,Gt=Gt&7,jt=(Rr(ee)|0)==0,ee=ee+-1|0,Ct=zi(7,0,ii|0)|0,D=D&~(Qt()|0),ii=zi(o[(jt?464:48)+(Gt*28|0)+(z<<2)>>2]|0,0,ii|0)|0,yt=Qt()|0,z=o[(jt?672:256)+(Gt*28|0)+(z<<2)>>2]|0,C=ii|C&~Ct,D=yt|D,!z){z=0;break e}if(!ee){ae=6;break}}while(!1);(ae|0)==6&&(jt=o[880+(We*28|0)+(z<<2)>>2]|0,Gt=zi(jt|0,0,45)|0,C=Gt|C,D=Qt()|0|D&-1040385,z=o[4304+(We*28|0)+(z<<2)>>2]|0,(jt&127|0)==127&&(jt=zi(o[880+(We*28|0)+20>>2]|0,0,45)|0,D=Qt()|0|D&-1040385,z=o[4304+(We*28|0)+20>>2]|0,C=Qa(jt|C,D)|0,D=Qt()|0,o[R>>2]=(o[R>>2]|0)+1)),ae=Mi(C|0,D|0,45)|0,Qt()|0,ae=ae&127;e:do if(N(ae)|0){t:do if((Js(C,D)|0)==1){if((We|0)!=(ae|0))if(Bi(ae,o[7728+(We*28|0)>>2]|0)|0){C=Yr(C,D)|0,le=1,D=Qt()|0;break}else{C=Qa(C,D)|0,le=1,D=Qt()|0;break}switch(le|0){case 5:{C=Yr(C,D)|0,D=Qt()|0,o[R>>2]=(o[R>>2]|0)+5,le=0;break t}case 3:{C=Qa(C,D)|0,D=Qt()|0,o[R>>2]=(o[R>>2]|0)+1,le=0;break t}default:return Gt=0,jt=0,Fn(Gt|0),jt|0}}else le=0;while(!1);if((z|0)>0){ee=0;do C=Gs(C,D)|0,D=Qt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}if((We|0)!=(ae|0)){if(!(xe(ae)|0)){if((le|0)!=0|(Js(C,D)|0)!=5)break;o[R>>2]=(o[R>>2]|0)+1;break}switch(be&127){case 8:case 118:break e}(Js(C,D)|0)!=3&&(o[R>>2]=(o[R>>2]|0)+1)}}else if((z|0)>0){ee=0;do C=Qa(C,D)|0,D=Qt()|0,ee=ee+1|0;while((ee|0)!=(z|0))}while(!1);return o[R>>2]=((o[R>>2]|0)+z|0)%6|0,Gt=D,jt=C,Fn(Gt|0),jt|0}function aa(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0;if(ii=Vt,Vt=Vt+16|0,Ct=ii,!z)return Ct=R,o[Ct>>2]=C,o[Ct+4>>2]=D,Ct=0,Vt=ii,Ct|0;o[Ct>>2]=0;e:do if(hs(C,D)|0)C=1;else{if(le=(z|0)>0,le){ee=0,yt=C;do{if(yt=jn(yt,D,4,Ct)|0,D=Qt()|0,(yt|0)==0&(D|0)==0){C=2;break e}if(ee=ee+1|0,hs(yt,D)|0){C=1;break e}}while((ee|0)<(z|0));if(We=R,o[We>>2]=yt,o[We+4>>2]=D,We=z+-1|0,le){le=0,ae=1,ee=yt,C=D;do{if(ee=jn(ee,C,2,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(be=R+(ae<<3)|0,o[be>>2]=ee,o[be+4>>2]=C,ae=ae+1|0,hs(ee,C)|0){C=1;break e}le=le+1|0}while((le|0)<(z|0));be=0,le=ae;do{if(ee=jn(ee,C,3,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(ae=R+(le<<3)|0,o[ae>>2]=ee,o[ae+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}be=be+1|0}while((be|0)<(z|0));ae=0;do{if(ee=jn(ee,C,1,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(be=R+(le<<3)|0,o[be>>2]=ee,o[be+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}ae=ae+1|0}while((ae|0)<(z|0));ae=0;do{if(ee=jn(ee,C,5,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(be=R+(le<<3)|0,o[be>>2]=ee,o[be+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}ae=ae+1|0}while((ae|0)<(z|0));ae=0;do{if(ee=jn(ee,C,4,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if(be=R+(le<<3)|0,o[be>>2]=ee,o[be+4>>2]=C,le=le+1|0,hs(ee,C)|0){C=1;break e}ae=ae+1|0}while((ae|0)<(z|0));for(ae=0;;){if(ee=jn(ee,C,6,Ct)|0,C=Qt()|0,(ee|0)==0&(C|0)==0){C=2;break e}if((ae|0)!=(We|0))if(be=R+(le<<3)|0,o[be>>2]=ee,o[be+4>>2]=C,!(hs(ee,C)|0))le=le+1|0;else{C=1;break e}if(ae=ae+1|0,(ae|0)>=(z|0)){ae=yt,le=D;break}}}else ae=yt,ee=yt,le=D,C=D}else ae=R,o[ae>>2]=C,o[ae+4>>2]=D,ae=C,ee=C,le=D,C=D;C=((ae|0)!=(ee|0)|(le|0)!=(C|0))&1}while(!1);return Ct=C,Vt=ii,Ct|0}function ls(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0;if(le=Vt,Vt=Vt+48|0,ee=le+8|0,R=le,be=C,ae=o[be+4>>2]|0,z=R,o[z>>2]=o[be>>2],o[z+4>>2]=ae,Pn(R,ee),ee=Ga(ee,D)|0,D=o[R>>2]|0,R=o[C+8>>2]|0,(R|0)<=0)return be=D,ae=(ee|0)<(be|0),be=ae?be:ee,be=be+12|0,Vt=le,be|0;z=o[C+12>>2]|0,C=0;do D=(o[z+(C<<3)>>2]|0)+D|0,C=C+1|0;while((C|0)<(R|0));return be=(ee|0)<(D|0),be=be?D:ee,be=be+12|0,Vt=le,be|0}function Na(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0;if(be=Vt,Vt=Vt+48|0,R=be+8|0,ee=be,!(rl(C,D,z)|0)){Vt=be;return}if(We=C,le=o[We+4>>2]|0,ae=ee,o[ae>>2]=o[We>>2],o[ae+4>>2]=le,Pn(ee,R),ae=Ga(R,D)|0,D=o[ee>>2]|0,le=o[C+8>>2]|0,(le|0)>0){ee=o[C+12>>2]|0,R=0;do D=(o[ee+(R<<3)>>2]|0)+D|0,R=R+1|0;while((R|0)!=(le|0))}if(D=(ae|0)<(D|0)?D:ae,(D|0)<=-12){Vt=be;return}We=D+11|0,cs(z|0,0,(((We|0)>0?We:0)<<3)+8|0)|0,Vt=be}function rl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0;if(Se=Vt,Vt=Vt+112|0,B=Se+80|0,We=Se+72|0,j=Se,Y=Se+56|0,yt=C+8|0,ue=Gn((o[yt>>2]<<5)+32|0)|0,ue||Yi(22848,22448,800,22456),Ma(C,ue),le=C,R=o[le+4>>2]|0,be=We,o[be>>2]=o[le>>2],o[be+4>>2]=R,Pn(We,B),be=Ga(B,D)|0,R=o[We>>2]|0,le=o[yt>>2]|0,(le|0)>0){ae=o[C+12>>2]|0,ee=0;do R=(o[ae+(ee<<3)>>2]|0)+R|0,ee=ee+1|0;while((ee|0)!=(le|0))}if(be=(be|0)<(R|0)?R:be,T=be+12|0,ee=Jo(T,8)|0,Ct=Jo(T,8)|0,o[B>>2]=0,_=C,w=o[_+4>>2]|0,R=We,o[R>>2]=o[_>>2],o[R+4>>2]=w,R=sl(We,T,D,B,ee,Ct)|0,R|0)return Jn(ee),Jn(Ct),Jn(ue),ue=R,Vt=Se,ue|0;e:do if((o[yt>>2]|0)>0){for(le=C+12|0,R=0;ae=sl((o[le>>2]|0)+(R<<3)|0,T,D,B,ee,Ct)|0,R=R+1|0,!(ae|0);)if((R|0)>=(o[yt>>2]|0))break e;return Jn(ee),Jn(Ct),Jn(ue),ue=ae,Vt=Se,ue|0}while(!1);(be|0)>-12&&cs(Ct|0,0,((T|0)>1?T:1)<<3|0)|0;e:do if((o[B>>2]|0)>0){w=((T|0)<0)<<31>>31,s=ee,i=Ct,r=ee,l=ee,d=Ct,_=ee,R=ee,I=ee,F=Ct,O=Ct,y=Ct,ee=Ct;t:for(;;){for(A=o[B>>2]|0,jt=0,Z=0,le=0;;){ae=j,be=ae+56|0;do o[ae>>2]=0,ae=ae+4|0;while((ae|0)<(be|0));if(D=s+(jt<<3)|0,We=o[D>>2]|0,D=o[D+4>>2]|0,Oa(We,D,1,j,0)|0){ae=j,be=ae+56|0;do o[ae>>2]=0,ae=ae+4|0;while((ae|0)<(be|0));ae=Jo(7,4)|0,ae|0&&(Xs(We,D,1,j,ae,7,0),Jn(ae))}Gt=0;do{ii=j+(Gt<<3)|0,Ct=o[ii>>2]|0,ii=o[ii+4>>2]|0;i:do if(!((Ct|0)==0&(ii|0)==0)){if(We=Co(Ct|0,ii|0,T|0,w|0)|0,Qt()|0,ae=z+(We<<3)|0,be=ae,D=o[be>>2]|0,be=o[be+4>>2]|0,!((D|0)==0&(be|0)==0))for(yt=0;;){if((yt|0)>(T|0))break t;if((D|0)==(Ct|0)&(be|0)==(ii|0))break i;if(We=(We+1|0)%(T|0)|0,ae=z+(We<<3)|0,be=ae,D=o[be>>2]|0,be=o[be+4>>2]|0,(D|0)==0&(be|0)==0)break;yt=yt+1|0}(Ct|0)==0&(ii|0)==0||(Sa(Ct,ii,Y),bn(C,ue,Y)|0&&(yt=ae,o[yt>>2]=Ct,o[yt+4>>2]=ii,yt=i+(le<<3)|0,o[yt>>2]=Ct,o[yt+4>>2]=ii,le=le+1|0))}while(!1);Gt=Gt+1|0}while(Gt>>>0<7);if(Z=Z+1|0,(Z|0)>=(A|0))break;jt=jt+1|0}if((A|0)>0&&cs(r|0,0,A<<3|0)|0,o[B>>2]=le,(le|0)>0)Ct=ee,ii=y,Gt=_,jt=O,Z=F,A=i,ee=I,y=R,O=l,F=r,I=Ct,R=ii,_=d,d=Gt,l=jt,r=Z,i=s,s=A;else break e}return Jn(l),Jn(d),Jn(ue),ue=-1,Vt=Se,ue|0}else R=Ct;while(!1);return Jn(ue),Jn(ee),Jn(R),ue=0,Vt=Se,ue|0}function sl(C,D,z,R,ee,le){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0,le=le|0;var ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0;if(w=Vt,Vt=Vt+48|0,r=w+32|0,l=w+16|0,d=w,ae=o[C>>2]|0,(ae|0)<=0)return _=0,Vt=w,_|0;F=C+4|0,O=r+8|0,y=l+8|0,s=d+8|0,i=((D|0)<0)<<31>>31,I=0;e:for(;;){be=o[F>>2]|0,Z=be+(I<<4)|0,o[r>>2]=o[Z>>2],o[r+4>>2]=o[Z+4>>2],o[r+8>>2]=o[Z+8>>2],o[r+12>>2]=o[Z+12>>2],(I|0)==(ae+-1|0)?(o[l>>2]=o[be>>2],o[l+4>>2]=o[be+4>>2],o[l+8>>2]=o[be+8>>2],o[l+12>>2]=o[be+12>>2]):(Z=be+(I+1<<4)|0,o[l>>2]=o[Z>>2],o[l+4>>2]=o[Z+4>>2],o[l+8>>2]=o[Z+8>>2],o[l+12>>2]=o[Z+12>>2]),Z=qa(r,l,z)|0;t:do if((Z|0)>0){A=+(Z|0),jt=0;i:for(;;){B=+(Z-jt|0),T=+(jt|0),ke[d>>3]=+ke[r>>3]*B/A+ +ke[l>>3]*T/A,ke[s>>3]=+ke[O>>3]*B/A+ +ke[y>>3]*T/A,ii=ha(d,z)|0,Gt=Qt()|0,be=Co(ii|0,Gt|0,D|0,i|0)|0,Qt()|0,ae=le+(be<<3)|0,We=ae,yt=o[We>>2]|0,We=o[We+4>>2]|0;n:do if((yt|0)==0&(We|0)==0)_=14;else for(Ct=0;;){if((Ct|0)>(D|0)){ae=1;break n}if((yt|0)==(ii|0)&(We|0)==(Gt|0)){ae=7;break n}if(be=(be+1|0)%(D|0)|0,ae=le+(be<<3)|0,We=ae,yt=o[We>>2]|0,We=o[We+4>>2]|0,(yt|0)==0&(We|0)==0){_=14;break}else Ct=Ct+1|0}while(!1);switch((_|0)==14&&(_=0,(ii|0)==0&(Gt|0)==0?ae=7:(o[ae>>2]=ii,o[ae+4>>2]=Gt,ae=o[R>>2]|0,Ct=ee+(ae<<3)|0,o[Ct>>2]=ii,o[Ct+4>>2]=Gt,o[R>>2]=ae+1,ae=0)),ae&7){case 7:case 0:break;default:break i}if(jt=jt+1|0,(Z|0)<=(jt|0)){_=8;break t}}if(ae|0){ae=-1,_=20;break e}}else _=8;while(!1);if((_|0)==8&&(_=0),I=I+1|0,ae=o[C>>2]|0,(I|0)>=(ae|0)){ae=0,_=20;break}}return(_|0)==20?(Vt=w,ae|0):0}function Ja(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0;if(yt=Vt,Vt=Vt+176|0,We=yt,(D|0)<1){fs(z,0,0),Vt=yt;return}ae=C,ae=Mi(o[ae>>2]|0,o[ae+4>>2]|0,52)|0,Qt()|0,fs(z,(D|0)>6?D:6,ae&15),ae=0;do{if(R=C+(ae<<3)|0,ka(o[R>>2]|0,o[R+4>>2]|0,We),R=o[We>>2]|0,(R|0)>0){be=0;do le=We+8+(be<<4)|0,be=be+1|0,R=We+8+(((be|0)%(R|0)|0)<<4)|0,ee=uu(z,R,le)|0,ee?gu(z,ee)|0:Fu(z,le,R)|0,R=o[We>>2]|0;while((be|0)<(R|0))}ae=ae+1|0}while((ae|0)!=(D|0));Vt=yt}function Va(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0;if(le=Vt,Vt=Vt+32|0,R=le,ee=le+16|0,Ja(C,D,ee),o[z>>2]=0,o[z+4>>2]=0,o[z+8>>2]=0,C=Ko(ee)|0,!C){Yn(z)|0,_a(ee),Vt=le;return}do{D=Ln(z)|0;do Un(D,C)|0,ae=C+16|0,o[R>>2]=o[ae>>2],o[R+4>>2]=o[ae+4>>2],o[R+8>>2]=o[ae+8>>2],o[R+12>>2]=o[ae+12>>2],gu(ee,C)|0,C=Ou(ee,R)|0;while(C|0);C=Ko(ee)|0}while(C|0);Yn(z)|0,_a(ee),Vt=le}function N(C){return C=C|0,o[7728+(C*28|0)+16>>2]|0}function xe(C){return C=C|0,(C|0)==4|(C|0)==117|0}function tt(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)>>2]|0}function It(C){return C=C|0,o[11152+((o[C>>2]|0)*216|0)+((o[C+4>>2]|0)*72|0)+((o[C+8>>2]|0)*24|0)+(o[C+12>>2]<<3)+4>>2]|0}function Wt(C,D){C=C|0,D=D|0,C=7728+(C*28|0)|0,o[D>>2]=o[C>>2],o[D+4>>2]=o[C+4>>2],o[D+8>>2]=o[C+8>>2],o[D+12>>2]=o[C+12>>2]}function Si(C,D){C=C|0,D=D|0;var z=0,R=0;if(D>>>0>20)return D=-1,D|0;do if((o[11152+(D*216|0)>>2]|0)!=(C|0))if((o[11152+(D*216|0)+8>>2]|0)!=(C|0))if((o[11152+(D*216|0)+16>>2]|0)!=(C|0))if((o[11152+(D*216|0)+24>>2]|0)!=(C|0))if((o[11152+(D*216|0)+32>>2]|0)!=(C|0))if((o[11152+(D*216|0)+40>>2]|0)!=(C|0))if((o[11152+(D*216|0)+48>>2]|0)!=(C|0))if((o[11152+(D*216|0)+56>>2]|0)!=(C|0))if((o[11152+(D*216|0)+64>>2]|0)!=(C|0))if((o[11152+(D*216|0)+72>>2]|0)!=(C|0))if((o[11152+(D*216|0)+80>>2]|0)!=(C|0))if((o[11152+(D*216|0)+88>>2]|0)!=(C|0))if((o[11152+(D*216|0)+96>>2]|0)!=(C|0))if((o[11152+(D*216|0)+104>>2]|0)!=(C|0))if((o[11152+(D*216|0)+112>>2]|0)!=(C|0))if((o[11152+(D*216|0)+120>>2]|0)!=(C|0))if((o[11152+(D*216|0)+128>>2]|0)!=(C|0))if((o[11152+(D*216|0)+136>>2]|0)==(C|0))C=2,z=1,R=2;else{if((o[11152+(D*216|0)+144>>2]|0)==(C|0)){C=0,z=2,R=0;break}if((o[11152+(D*216|0)+152>>2]|0)==(C|0)){C=0,z=2,R=1;break}if((o[11152+(D*216|0)+160>>2]|0)==(C|0)){C=0,z=2,R=2;break}if((o[11152+(D*216|0)+168>>2]|0)==(C|0)){C=1,z=2,R=0;break}if((o[11152+(D*216|0)+176>>2]|0)==(C|0)){C=1,z=2,R=1;break}if((o[11152+(D*216|0)+184>>2]|0)==(C|0)){C=1,z=2,R=2;break}if((o[11152+(D*216|0)+192>>2]|0)==(C|0)){C=2,z=2,R=0;break}if((o[11152+(D*216|0)+200>>2]|0)==(C|0)){C=2,z=2,R=1;break}if((o[11152+(D*216|0)+208>>2]|0)==(C|0)){C=2,z=2,R=2;break}else C=-1;return C|0}else C=2,z=1,R=1;else C=2,z=1,R=0;else C=1,z=1,R=2;else C=1,z=1,R=1;else C=1,z=1,R=0;else C=0,z=1,R=2;else C=0,z=1,R=1;else C=0,z=1,R=0;else C=2,z=0,R=2;else C=2,z=0,R=1;else C=2,z=0,R=0;else C=1,z=0,R=2;else C=1,z=0,R=1;else C=1,z=0,R=0;else C=0,z=0,R=2;else C=0,z=0,R=1;else C=0,z=0,R=0;while(!1);return D=o[11152+(D*216|0)+(z*72|0)+(C*24|0)+(R<<3)+4>>2]|0,D|0}function Bi(C,D){return C=C|0,D=D|0,(o[7728+(C*28|0)+20>>2]|0)==(D|0)?(D=1,D|0):(D=(o[7728+(C*28|0)+24>>2]|0)==(D|0),D|0)}function un(C,D){return C=C|0,D=D|0,o[880+(C*28|0)+(D<<2)>>2]|0}function An(C,D){return C=C|0,D=D|0,(o[880+(C*28|0)>>2]|0)==(D|0)?(D=0,D|0):(o[880+(C*28|0)+4>>2]|0)==(D|0)?(D=1,D|0):(o[880+(C*28|0)+8>>2]|0)==(D|0)?(D=2,D|0):(o[880+(C*28|0)+12>>2]|0)==(D|0)?(D=3,D|0):(o[880+(C*28|0)+16>>2]|0)==(D|0)?(D=4,D|0):(o[880+(C*28|0)+20>>2]|0)==(D|0)?(D=5,D|0):((o[880+(C*28|0)+24>>2]|0)==(D|0)?6:7)|0}function rr(){return 122}function hr(C){C=C|0;var D=0,z=0,R=0;D=0;do zi(D|0,0,45)|0,R=Qt()|0|134225919,z=C+(D<<3)|0,o[z>>2]=-1,o[z+4>>2]=R,D=D+1|0;while((D|0)!=122)}function zr(C){return C=C|0,+ke[C+16>>3]<+ke[C+24>>3]|0}function Ua(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return z=+ke[D>>3],!(z>=+ke[C+8>>3])||!(z<=+ke[C>>3])?(D=0,D|0):(R=+ke[C+16>>3],z=+ke[C+24>>3],ee=+ke[D+8>>3],D=ee>=z,C=ee<=R&1,R<z?D&&(C=1):D||(C=0),D=(C|0)!=0,D|0)}function Ga(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0;ae=Vt,Vt=Vt+288|0,z=ae+264|0,R=ae+96|0,ee=ae,le=ee,be=le+96|0;do o[le>>2]=0,le=le+4|0;while((le|0)<(be|0));return gl(D,ee),le=ee,be=o[le>>2]|0,le=o[le+4>>2]|0,Sa(be,le,z),ka(be,le,R),We=+Ts(z,R+8|0),ke[z>>3]=+ke[C>>3],le=z+8|0,ke[le>>3]=+ke[C+16>>3],ke[R>>3]=+ke[C+8>>3],be=R+8|0,ke[be>>3]=+ke[C+24>>3],yt=+Ts(z,R),be=~~+Vn(+(yt*yt/+ys(+ +Ai(+((+ke[le>>3]-+ke[be>>3])/(+ke[z>>3]-+ke[R>>3]))),3)/(We*(We*2.59807621135)*.8))),Vt=ae,(be|0?be:1)|0}function qa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0;be=Vt,Vt=Vt+288|0,R=be+264|0,ee=be+96|0,le=be,ae=le,We=ae+96|0;do o[ae>>2]=0,ae=ae+4|0;while((ae|0)<(We|0));return gl(z,le),We=le,ae=o[We>>2]|0,We=o[We+4>>2]|0,Sa(ae,We,R),ka(ae,We,ee),yt=+Ts(R,ee+8|0),We=~~+Vn(+(+Ts(C,D)/(yt*2))),Vt=be,(We|0?We:1)|0}function pl(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0,o[C>>2]=D,o[C+4>>2]=z,o[C+8>>2]=R}function Ur(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0;ii=D+8|0,o[ii>>2]=0,We=+ke[C>>3],ae=+Ai(+We),yt=+ke[C+8>>3],be=+Ai(+yt)/.8660254037844386,ae=ae+be*.5,z=~~ae,C=~~be,ae=ae-+(z|0),be=be-+(C|0);do if(ae<.5)if(ae<.3333333333333333)if(o[D>>2]=z,be<(ae+1)*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}else if(Gt=1-ae,C=(!(be<Gt)&1)+C|0,o[D+4>>2]=C,Gt<=be&be<ae*2){z=z+1|0,o[D>>2]=z;break}else{o[D>>2]=z;break}else{if(!(ae<.6666666666666666))if(z=z+1|0,o[D>>2]=z,be<ae*.5){o[D+4>>2]=C;break}else{C=C+1|0,o[D+4>>2]=C;break}if(be<1-ae){if(o[D+4>>2]=C,ae*2+-1<be){o[D>>2]=z;break}}else C=C+1|0,o[D+4>>2]=C;z=z+1|0,o[D>>2]=z}while(!1);do if(We<0)if(C&1){Ct=(C+1|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-((+(Ct>>>0)+4294967296*+(Qt()|0))*2+1)),o[D>>2]=z;break}else{Ct=(C|0)/2|0,Ct=oa(z|0,((z|0)<0)<<31>>31|0,Ct|0,((Ct|0)<0)<<31>>31|0)|0,z=~~(+(z|0)-(+(Ct>>>0)+4294967296*+(Qt()|0))*2),o[D>>2]=z;break}while(!1);Ct=D+4|0,yt<0&&(z=z-((C<<1|1|0)/2|0)|0,o[D>>2]=z,C=0-C|0,o[Ct>>2]=C),R=C-z|0,(z|0)<0?(ee=0-z|0,o[Ct>>2]=R,o[ii>>2]=ee,o[D>>2]=0,C=R,z=0):ee=0,(C|0)<0&&(z=z-C|0,o[D>>2]=z,ee=ee-C|0,o[ii>>2]=ee,o[Ct>>2]=0,C=0),le=z-ee|0,R=C-ee|0,(ee|0)<0&&(o[D>>2]=le,o[Ct>>2]=R,o[ii>>2]=0,C=R,z=le,ee=0),R=(C|0)<(z|0)?C:z,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[D>>2]=z-R,o[Ct>>2]=C-R,o[ii>>2]=ee-R)}function ir(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0;D=o[C>>2]|0,ae=C+4|0,z=o[ae>>2]|0,(D|0)<0&&(z=z-D|0,o[ae>>2]=z,le=C+8|0,o[le>>2]=(o[le>>2]|0)-D,o[C>>2]=0,D=0),(z|0)<0?(D=D-z|0,o[C>>2]=D,le=C+8|0,ee=(o[le>>2]|0)-z|0,o[le>>2]=ee,o[ae>>2]=0,z=0):(ee=C+8|0,le=ee,ee=o[ee>>2]|0),(ee|0)<0&&(D=D-ee|0,o[C>>2]=D,z=z-ee|0,o[ae>>2]=z,o[le>>2]=0,ee=0),R=(z|0)<(D|0)?z:D,R=(ee|0)<(R|0)?ee:R,!((R|0)<=0)&&(o[C>>2]=D-R,o[ae>>2]=z-R,o[le>>2]=ee-R)}function wr(C,D){C=C|0,D=D|0;var z=0,R=0;R=o[C+8>>2]|0,z=+((o[C+4>>2]|0)-R|0),ke[D>>3]=+((o[C>>2]|0)-R|0)-z*.5,ke[D+8>>3]=z*.8660254037844386}function Mr(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[D>>2]|0)+(o[C>>2]|0),o[z+4>>2]=(o[D+4>>2]|0)+(o[C+4>>2]|0),o[z+8>>2]=(o[D+8>>2]|0)+(o[C+8>>2]|0)}function js(C,D,z){C=C|0,D=D|0,z=z|0,o[z>>2]=(o[C>>2]|0)-(o[D>>2]|0),o[z+4>>2]=(o[C+4>>2]|0)-(o[D+4>>2]|0),o[z+8>>2]=(o[C+8>>2]|0)-(o[D+8>>2]|0)}function vr(C,D){C=C|0,D=D|0;var z=0,R=0;z=Hr(o[C>>2]|0,D)|0,o[C>>2]=z,z=C+4|0,R=Hr(o[z>>2]|0,D)|0,o[z>>2]=R,C=C+8|0,D=Hr(o[C>>2]|0,D)|0,o[C>>2]=D}function Ks(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;ae=o[C>>2]|0,be=(ae|0)<0,R=(o[C+4>>2]|0)-(be?ae:0)|0,le=(R|0)<0,ee=(le?0-R|0:0)+((o[C+8>>2]|0)-(be?ae:0))|0,z=(ee|0)<0,C=z?0:ee,D=(le?0:R)-(z?ee:0)|0,ee=(be?0:ae)-(le?R:0)-(z?ee:0)|0,z=(D|0)<(ee|0)?D:ee,z=(C|0)<(z|0)?C:z,R=(z|0)>0,C=C-(R?z:0)|0,D=D-(R?z:0)|0;e:do switch(ee-(R?z:0)|0){case 0:switch(D|0){case 0:return be=C|0?(C|0)==1?1:7:0,be|0;case 1:return be=C|0?(C|0)==1?3:7:2,be|0;default:break e}case 1:switch(D|0){case 0:return be=C|0?(C|0)==1?5:7:4,be|0;case 1:{if(!C)C=6;else break e;return C|0}default:break e}}while(!1);return be=7,be|0}function Pr(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;ae=C+8|0,z=o[ae>>2]|0,D=(o[C>>2]|0)-z|0,be=C+4|0,z=(o[be>>2]|0)-z|0,R=pn(+((D*3|0)-z|0)/7)|0,o[C>>2]=R,D=pn(+((z<<1)+D|0)/7)|0,o[be>>2]=D,o[ae>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[be>>2]=z,o[ae>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[ae>>2]=z,o[be>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[be>>2]=ee,o[ae>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[be>>2]=D-R,o[ae>>2]=z-R)}function bo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;ae=C+8|0,z=o[ae>>2]|0,D=(o[C>>2]|0)-z|0,be=C+4|0,z=(o[be>>2]|0)-z|0,R=pn(+((D<<1)+z|0)/7)|0,o[C>>2]=R,D=pn(+((z*3|0)-D|0)/7)|0,o[be>>2]=D,o[ae>>2]=0,z=D-R|0,(R|0)<0?(le=0-R|0,o[be>>2]=z,o[ae>>2]=le,o[C>>2]=0,D=z,R=0,z=le):z=0,(D|0)<0&&(R=R-D|0,o[C>>2]=R,z=z-D|0,o[ae>>2]=z,o[be>>2]=0,D=0),le=R-z|0,ee=D-z|0,(z|0)<0?(o[C>>2]=le,o[be>>2]=ee,o[ae>>2]=0,D=ee,ee=le,z=0):ee=R,R=(D|0)<(ee|0)?D:ee,R=(z|0)<(R|0)?z:R,!((R|0)<=0)&&(o[C>>2]=ee-R,o[be>>2]=D-R,o[ae>>2]=z-R)}function Ho(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;D=o[C>>2]|0,ae=C+4|0,z=o[ae>>2]|0,be=C+8|0,R=o[be>>2]|0,ee=z+(D*3|0)|0,o[C>>2]=ee,z=R+(z*3|0)|0,o[ae>>2]=z,D=(R*3|0)+D|0,o[be>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[ae>>2]=R,o[be>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[be>>2]=D,o[ae>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[ae>>2]=ee,o[be>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[ae>>2]=ee-z,o[be>>2]=D-z)}function Ls(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;ee=o[C>>2]|0,ae=C+4|0,D=o[ae>>2]|0,be=C+8|0,z=o[be>>2]|0,R=(D*3|0)+ee|0,ee=z+(ee*3|0)|0,o[C>>2]=ee,o[ae>>2]=R,D=(z*3|0)+D|0,o[be>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[ae>>2]=z,o[be>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[be>>2]=D,o[ae>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[ae>>2]=R,o[be>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[ae>>2]=R-z,o[be>>2]=D-z)}function Il(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0;(D+-1|0)>>>0>=6||(ee=(o[15472+(D*12|0)>>2]|0)+(o[C>>2]|0)|0,o[C>>2]=ee,be=C+4|0,R=(o[15472+(D*12|0)+4>>2]|0)+(o[be>>2]|0)|0,o[be>>2]=R,ae=C+8|0,D=(o[15472+(D*12|0)+8>>2]|0)+(o[ae>>2]|0)|0,o[ae>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[be>>2]=z,o[ae>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[ae>>2]=D,o[be>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[be>>2]=ee,o[ae>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[be>>2]=ee-z,o[ae>>2]=D-z))}function ho(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;ee=o[C>>2]|0,ae=C+4|0,D=o[ae>>2]|0,be=C+8|0,z=o[be>>2]|0,R=D+ee|0,ee=z+ee|0,o[C>>2]=ee,o[ae>>2]=R,D=z+D|0,o[be>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[ae>>2]=z,o[be>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[be>>2]=D,o[ae>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[ae>>2]=ee,o[be>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[ae>>2]=ee-z,o[be>>2]=D-z)}function jo(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;D=o[C>>2]|0,ae=C+4|0,R=o[ae>>2]|0,be=C+8|0,z=o[be>>2]|0,ee=R+D|0,o[C>>2]=ee,R=z+R|0,o[ae>>2]=R,D=z+D|0,o[be>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[ae>>2]=z,o[be>>2]=D,o[C>>2]=0,R=0):(z=R,R=ee),(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[be>>2]=D,o[ae>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[ae>>2]=ee,o[be>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[ae>>2]=ee-z,o[be>>2]=D-z)}function ca(C){switch(C=C|0,C|0){case 1:{C=5;break}case 5:{C=4;break}case 4:{C=6;break}case 6:{C=2;break}case 2:{C=3;break}case 3:{C=1;break}}return C|0}function Ys(C){switch(C=C|0,C|0){case 1:{C=3;break}case 3:{C=2;break}case 2:{C=6;break}case 6:{C=4;break}case 4:{C=5;break}case 5:{C=1;break}}return C|0}function El(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;D=o[C>>2]|0,ae=C+4|0,z=o[ae>>2]|0,be=C+8|0,R=o[be>>2]|0,ee=z+(D<<1)|0,o[C>>2]=ee,z=R+(z<<1)|0,o[ae>>2]=z,D=(R<<1)+D|0,o[be>>2]=D,R=z-ee|0,(ee|0)<0?(D=D-ee|0,o[ae>>2]=R,o[be>>2]=D,o[C>>2]=0,z=R,R=0):R=ee,(z|0)<0&&(R=R-z|0,o[C>>2]=R,D=D-z|0,o[be>>2]=D,o[ae>>2]=0,z=0),le=R-D|0,ee=z-D|0,(D|0)<0?(o[C>>2]=le,o[ae>>2]=ee,o[be>>2]=0,R=le,D=0):ee=z,z=(ee|0)<(R|0)?ee:R,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=R-z,o[ae>>2]=ee-z,o[be>>2]=D-z)}function Ha(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;ee=o[C>>2]|0,ae=C+4|0,D=o[ae>>2]|0,be=C+8|0,z=o[be>>2]|0,R=(D<<1)+ee|0,ee=z+(ee<<1)|0,o[C>>2]=ee,o[ae>>2]=R,D=(z<<1)+D|0,o[be>>2]=D,z=R-ee|0,(ee|0)<0?(D=D-ee|0,o[ae>>2]=z,o[be>>2]=D,o[C>>2]=0,ee=0):z=R,(z|0)<0&&(ee=ee-z|0,o[C>>2]=ee,D=D-z|0,o[be>>2]=D,o[ae>>2]=0,z=0),le=ee-D|0,R=z-D|0,(D|0)<0?(o[C>>2]=le,o[ae>>2]=R,o[be>>2]=0,ee=le,D=0):R=z,z=(R|0)<(ee|0)?R:ee,z=(D|0)<(z|0)?D:z,!((z|0)<=0)&&(o[C>>2]=ee-z,o[ae>>2]=R-z,o[be>>2]=D-z)}function Ta(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0;return ae=(o[C>>2]|0)-(o[D>>2]|0)|0,be=(ae|0)<0,R=(o[C+4>>2]|0)-(o[D+4>>2]|0)-(be?ae:0)|0,le=(R|0)<0,ee=(be?0-ae|0:0)+(o[C+8>>2]|0)-(o[D+8>>2]|0)+(le?0-R|0:0)|0,C=(ee|0)<0,D=C?0:ee,z=(le?0:R)-(C?ee:0)|0,ee=(be?0:ae)-(le?R:0)-(C?ee:0)|0,C=(z|0)<(ee|0)?z:ee,C=(D|0)<(C|0)?D:C,R=(C|0)>0,D=D-(R?C:0)|0,z=z-(R?C:0)|0,C=ee-(R?C:0)|0,C=(C|0)>-1?C:0-C|0,z=(z|0)>-1?z:0-z|0,D=(D|0)>-1?D:0-D|0,D=(z|0)>(D|0)?z:D,((C|0)>(D|0)?C:D)|0}function ml(C,D){C=C|0,D=D|0;var z=0;z=o[C+8>>2]|0,o[D>>2]=(o[C>>2]|0)-z,o[D+4>>2]=(o[C+4>>2]|0)-z}function Cl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0;R=o[C>>2]|0,o[D>>2]=R,C=o[C+4>>2]|0,ae=D+4|0,o[ae>>2]=C,be=D+8|0,o[be>>2]=0,z=C-R|0,(R|0)<0?(C=0-R|0,o[ae>>2]=z,o[be>>2]=C,o[D>>2]=0,R=0):(z=C,C=0),(z|0)<0&&(R=R-z|0,o[D>>2]=R,C=C-z|0,o[be>>2]=C,o[ae>>2]=0,z=0),le=R-C|0,ee=z-C|0,(C|0)<0?(o[D>>2]=le,o[ae>>2]=ee,o[be>>2]=0,z=ee,ee=le,C=0):ee=R,R=(z|0)<(ee|0)?z:ee,R=(C|0)<(R|0)?C:R,!((R|0)<=0)&&(o[D>>2]=ee-R,o[ae>>2]=z-R,o[be>>2]=C-R)}function pu(C){C=C|0;var D=0,z=0,R=0,ee=0;D=C+8|0,ee=o[D>>2]|0,z=ee-(o[C>>2]|0)|0,o[C>>2]=z,R=C+4|0,C=(o[R>>2]|0)-ee|0,o[R>>2]=C,o[D>>2]=0-(C+z)}function us(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;z=o[C>>2]|0,D=0-z|0,o[C>>2]=D,ae=C+8|0,o[ae>>2]=0,be=C+4|0,R=o[be>>2]|0,ee=R+z|0,(z|0)>0?(o[be>>2]=ee,o[ae>>2]=z,o[C>>2]=0,D=0,R=ee):z=0,(R|0)<0?(le=D-R|0,o[C>>2]=le,z=z-R|0,o[ae>>2]=z,o[be>>2]=0,ee=le-z|0,D=0-z|0,(z|0)<0?(o[C>>2]=ee,o[be>>2]=D,o[ae>>2]=0,R=D,z=0):(R=0,ee=le)):ee=D,D=(R|0)<(ee|0)?R:ee,D=(z|0)<(D|0)?z:D,!((D|0)<=0)&&(o[C>>2]=ee-D,o[be>>2]=R-D,o[ae>>2]=z-D)}function sc(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,eo(C,D,z,ee),Ur(ee,z+4|0),Vt=R}function eo(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0;if(We=Vt,Vt=Vt+32|0,le=We,ac(C,le),o[z>>2]=0,ee=+ta(15888,le),ae=+ta(15912,le),ae<ee&&(o[z>>2]=1,ee=ae),ae=+ta(15936,le),ae<ee&&(o[z>>2]=2,ee=ae),ae=+ta(15960,le),ae<ee&&(o[z>>2]=3,ee=ae),ae=+ta(15984,le),ae<ee&&(o[z>>2]=4,ee=ae),ae=+ta(16008,le),ae<ee&&(o[z>>2]=5,ee=ae),ae=+ta(16032,le),ae<ee&&(o[z>>2]=6,ee=ae),ae=+ta(16056,le),ae<ee&&(o[z>>2]=7,ee=ae),ae=+ta(16080,le),ae<ee&&(o[z>>2]=8,ee=ae),ae=+ta(16104,le),ae<ee&&(o[z>>2]=9,ee=ae),ae=+ta(16128,le),ae<ee&&(o[z>>2]=10,ee=ae),ae=+ta(16152,le),ae<ee&&(o[z>>2]=11,ee=ae),ae=+ta(16176,le),ae<ee&&(o[z>>2]=12,ee=ae),ae=+ta(16200,le),ae<ee&&(o[z>>2]=13,ee=ae),ae=+ta(16224,le),ae<ee&&(o[z>>2]=14,ee=ae),ae=+ta(16248,le),ae<ee&&(o[z>>2]=15,ee=ae),ae=+ta(16272,le),ae<ee&&(o[z>>2]=16,ee=ae),ae=+ta(16296,le),ae<ee&&(o[z>>2]=17,ee=ae),ae=+ta(16320,le),ae<ee&&(o[z>>2]=18,ee=ae),ae=+ta(16344,le),ae<ee&&(o[z>>2]=19,ee=ae),ae=+Yt(+(1-ee*.5)),ae<1e-16){o[R>>2]=0,o[R+4>>2]=0,o[R+8>>2]=0,o[R+12>>2]=0,Vt=We;return}if(z=o[z>>2]|0,ee=+ke[16368+(z*24|0)>>3],ee=+Xo(ee-+Xo(+Sr(15568+(z<<4)|0,C))),Rr(D)|0?be=+Xo(ee+-.3334731722518321):be=ee,ee=+wi(+ae)/.381966011250105,(D|0)>0){le=0;do ee=ee*2.6457513110645907,le=le+1|0;while((le|0)!=(D|0))}ae=+Ri(+be)*ee,ke[R>>3]=ae,be=+vi(+be)*ee,ke[R+8>>3]=be,Vt=We}function to(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0;if(le=+Ru(C),le<1e-16){D=15568+(D<<4)|0,o[ee>>2]=o[D>>2],o[ee+4>>2]=o[D+4>>2],o[ee+8>>2]=o[D+8>>2],o[ee+12>>2]=o[D+12>>2];return}if(ae=+dn(+ +ke[C+8>>3],+ +ke[C>>3]),(z|0)>0){C=0;do le=le/2.6457513110645907,C=C+1|0;while((C|0)!=(z|0))}R?(le=le/3,z=(Rr(z)|0)==0,le=+ar(+((z?le:le/2.6457513110645907)*.381966011250105))):(le=+ar(+(le*.381966011250105)),Rr(z)|0&&(ae=+Xo(ae+.3334731722518321))),Xn(15568+(D<<4)|0,+Xo(+ke[16368+(D*24|0)>>3]-ae),le,ee)}function ql(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,wr(C+4|0,ee),to(ee,o[C>>2]|0,D,0,z),Vt=R}function Ro(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0;if(Y=Vt,Vt=Vt+272|0,le=Y+256|0,O=Y+240|0,T=Y,B=Y+224|0,j=Y+208|0,y=Y+176|0,s=Y+160|0,i=Y+192|0,r=Y+144|0,l=Y+128|0,d=Y+112|0,_=Y+96|0,w=Y+80|0,o[le>>2]=D,o[O>>2]=o[C>>2],o[O+4>>2]=o[C+4>>2],o[O+8>>2]=o[C+8>>2],o[O+12>>2]=o[C+12>>2],Zo(O,le,T),o[ee>>2]=0,O=R+z+((R|0)==5&1)|0,(O|0)<=(z|0)){Vt=Y;return}We=o[le>>2]|0,yt=B+4|0,Ct=y+4|0,ii=z+5|0,Gt=16848+(We<<2)|0,jt=16928+(We<<2)|0,Z=l+8|0,A=d+8|0,I=_+8|0,F=j+4|0,be=z;e:for(;;){ae=T+(((be|0)%5|0)<<4)|0,o[j>>2]=o[ae>>2],o[j+4>>2]=o[ae+4>>2],o[j+8>>2]=o[ae+8>>2],o[j+12>>2]=o[ae+12>>2];do;while((wo(j,We,0,1)|0)==2);if((be|0)>(z|0)&(Rr(D)|0)!=0){if(o[y>>2]=o[j>>2],o[y+4>>2]=o[j+4>>2],o[y+8>>2]=o[j+8>>2],o[y+12>>2]=o[j+12>>2],wr(yt,s),R=o[y>>2]|0,le=o[17008+(R*80|0)+(o[B>>2]<<2)>>2]|0,o[y>>2]=o[18608+(R*80|0)+(le*20|0)>>2],ae=o[18608+(R*80|0)+(le*20|0)+16>>2]|0,(ae|0)>0){C=0;do ho(Ct),C=C+1|0;while((C|0)<(ae|0))}switch(ae=18608+(R*80|0)+(le*20|0)+4|0,o[i>>2]=o[ae>>2],o[i+4>>2]=o[ae+4>>2],o[i+8>>2]=o[ae+8>>2],vr(i,(o[Gt>>2]|0)*3|0),Mr(Ct,i,Ct),ir(Ct),wr(Ct,r),ue=+(o[jt>>2]|0),ke[l>>3]=ue*3,ke[Z>>3]=0,Se=ue*-1.5,ke[d>>3]=Se,ke[A>>3]=ue*2.598076211353316,ke[_>>3]=Se,ke[I>>3]=ue*-2.598076211353316,o[17008+((o[y>>2]|0)*80|0)+(o[j>>2]<<2)>>2]|0){case 1:{C=d,R=l;break}case 3:{C=_,R=d;break}case 2:{C=l,R=_;break}default:{C=12;break e}}Vl(s,r,R,C,w),to(w,o[y>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1}if((be|0)<(ii|0)&&(wr(F,y),to(y,o[j>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),o[B>>2]=o[j>>2],o[B+4>>2]=o[j+4>>2],o[B+8>>2]=o[j+8>>2],o[B+12>>2]=o[j+12>>2],be=be+1|0,(be|0)>=(O|0)){C=3;break}}if((C|0)==3){Vt=Y;return}else(C|0)==12&&Yi(22474,22521,581,22531)}function Zo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0;We=Vt,Vt=Vt+128|0,R=We+64|0,ee=We,le=R,ae=20208,be=le+60|0;do o[le>>2]=o[ae>>2],le=le+4|0,ae=ae+4|0;while((le|0)<(be|0));le=ee,ae=20272,be=le+60|0;do o[le>>2]=o[ae>>2],le=le+4|0,ae=ae+4|0;while((le|0)<(be|0));be=(Rr(o[D>>2]|0)|0)==0,R=be?R:ee,ee=C+4|0,El(ee),Ha(ee),Rr(o[D>>2]|0)|0&&(Ls(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Mr(ee,R,D),ir(D),o[z+16>>2]=o[C>>2],D=z+20|0,Mr(ee,R+12|0,D),ir(D),o[z+32>>2]=o[C>>2],D=z+36|0,Mr(ee,R+24|0,D),ir(D),o[z+48>>2]=o[C>>2],D=z+52|0,Mr(ee,R+36|0,D),ir(D),o[z+64>>2]=o[C>>2],z=z+68|0,Mr(ee,R+48|0,z),ir(z),Vt=We}function wo(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0;if(Z=Vt,Vt=Vt+32|0,Gt=Z+12|0,be=Z,jt=C+4|0,ii=o[16928+(D<<2)>>2]|0,Ct=(R|0)!=0,ii=Ct?ii*3|0:ii,ee=o[jt>>2]|0,yt=C+8|0,ae=o[yt>>2]|0,Ct){if(le=C+12|0,R=o[le>>2]|0,ee=ae+ee+R|0,(ee|0)==(ii|0))return jt=1,Vt=Z,jt|0;We=le}else We=C+12|0,R=o[We>>2]|0,ee=ae+ee+R|0;if((ee|0)<=(ii|0))return jt=0,Vt=Z,jt|0;do if((R|0)>0){if(R=o[C>>2]|0,(ae|0)>0){le=18608+(R*80|0)+60|0,R=C;break}R=18608+(R*80|0)+40|0,z?(pl(Gt,ii,0,0),js(jt,Gt,be),jo(be),Mr(be,Gt,jt),le=R,R=C):(le=R,R=C)}else le=18608+((o[C>>2]|0)*80|0)+20|0,R=C;while(!1);if(o[R>>2]=o[le>>2],ee=le+16|0,(o[ee>>2]|0)>0){R=0;do ho(jt),R=R+1|0;while((R|0)<(o[ee>>2]|0))}return C=le+4|0,o[Gt>>2]=o[C>>2],o[Gt+4>>2]=o[C+4>>2],o[Gt+8>>2]=o[C+8>>2],D=o[16848+(D<<2)>>2]|0,vr(Gt,Ct?D*3|0:D),Mr(jt,Gt,jt),ir(jt),Ct?R=((o[yt>>2]|0)+(o[jt>>2]|0)+(o[We>>2]|0)|0)==(ii|0)?1:2:R=2,jt=R,Vt=Z,jt|0}function Us(C,D){C=C|0,D=D|0;var z=0;do z=wo(C,D,0,1)|0;while((z|0)==2);return z|0}function Qo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0;if(_=Vt,Vt=Vt+240|0,le=_+224|0,i=_+208|0,r=_,l=_+192|0,d=_+176|0,I=_+160|0,F=_+144|0,O=_+128|0,y=_+112|0,s=_+96|0,o[le>>2]=D,o[i>>2]=o[C>>2],o[i+4>>2]=o[C+4>>2],o[i+8>>2]=o[C+8>>2],o[i+12>>2]=o[C+12>>2],Wo(i,le,r),o[ee>>2]=0,A=R+z+((R|0)==6&1)|0,(A|0)<=(z|0)){Vt=_;return}We=o[le>>2]|0,yt=z+6|0,Ct=16928+(We<<2)|0,ii=F+8|0,Gt=O+8|0,jt=y+8|0,Z=l+4|0,ae=0,be=z,R=-1;e:for(;;){if(le=(be|0)%6|0,C=r+(le<<4)|0,o[l>>2]=o[C>>2],o[l+4>>2]=o[C+4>>2],o[l+8>>2]=o[C+8>>2],o[l+12>>2]=o[C+12>>2],C=ae,ae=wo(l,We,0,1)|0,(be|0)>(z|0)&(Rr(D)|0)!=0&&(C|0)!=1&&(o[l>>2]|0)!=(R|0)){switch(wr(r+(((le+5|0)%6|0)<<4)+4|0,d),wr(r+(le<<4)+4|0,I),w=+(o[Ct>>2]|0),ke[F>>3]=w*3,ke[ii>>3]=0,T=w*-1.5,ke[O>>3]=T,ke[Gt>>3]=w*2.598076211353316,ke[y>>3]=T,ke[jt>>3]=w*-2.598076211353316,le=o[i>>2]|0,o[17008+(le*80|0)+(((R|0)==(le|0)?o[l>>2]|0:R)<<2)>>2]|0){case 1:{C=O,R=F;break}case 3:{C=y,R=O;break}case 2:{C=F,R=y;break}default:{C=8;break e}}Vl(d,I,R,C,s),!(yl(d,s)|0)&&!(yl(I,s)|0)&&(to(s,o[i>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1)}if((be|0)<(yt|0)&&(wr(Z,d),to(d,o[l>>2]|0,We,1,ee+8+(o[ee>>2]<<4)|0),o[ee>>2]=(o[ee>>2]|0)+1),be=be+1|0,(be|0)>=(A|0)){C=3;break}else R=o[l>>2]|0}if((C|0)==3){Vt=_;return}else(C|0)==8&&Yi(22557,22521,746,22602)}function Wo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0;We=Vt,Vt=Vt+160|0,R=We+80|0,ee=We,le=R,ae=20336,be=le+72|0;do o[le>>2]=o[ae>>2],le=le+4|0,ae=ae+4|0;while((le|0)<(be|0));le=ee,ae=20416,be=le+72|0;do o[le>>2]=o[ae>>2],le=le+4|0,ae=ae+4|0;while((le|0)<(be|0));be=(Rr(o[D>>2]|0)|0)==0,R=be?R:ee,ee=C+4|0,El(ee),Ha(ee),Rr(o[D>>2]|0)|0&&(Ls(ee),o[D>>2]=(o[D>>2]|0)+1),o[z>>2]=o[C>>2],D=z+4|0,Mr(ee,R,D),ir(D),o[z+16>>2]=o[C>>2],D=z+20|0,Mr(ee,R+12|0,D),ir(D),o[z+32>>2]=o[C>>2],D=z+36|0,Mr(ee,R+24|0,D),ir(D),o[z+48>>2]=o[C>>2],D=z+52|0,Mr(ee,R+36|0,D),ir(D),o[z+64>>2]=o[C>>2],D=z+68|0,Mr(ee,R+48|0,D),ir(D),o[z+80>>2]=o[C>>2],z=z+84|0,Mr(ee,R+60|0,z),ir(z),Vt=We}function Xo(C){C=+C;var D=0;return D=C<0?C+6.283185307179586:C,+(C>=6.283185307179586?D+-6.283185307179586:D)}function ba(C,D){return C=C|0,D=D|0,+Ai(+(+ke[C>>3]-+ke[D>>3]))<17453292519943298e-27?(D=+Ai(+(+ke[C+8>>3]-+ke[D+8>>3]))<17453292519943298e-27,D|0):(D=0,D|0)}function ja(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+Ri(+ee)*+Ri(+R)*z),+(+dn(+ +Kt(+z),+ +Kt(+(1-z)))*2)}function Ts(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+Ri(+ee)*+Ri(+R)*z),+(+dn(+ +Kt(+z),+ +Kt(+(1-z)))*2*6371.007180918475)}function mu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;return ee=+ke[D>>3],R=+ke[C>>3],le=+vi(+((ee-R)*.5)),z=+vi(+((+ke[D+8>>3]-+ke[C+8>>3])*.5)),z=le*le+z*(+Ri(+ee)*+Ri(+R)*z),+(+dn(+ +Kt(+z),+ +Kt(+(1-z)))*2*6371.007180918475*1e3)}function Sr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0;return le=+ke[D>>3],R=+Ri(+le),ee=+ke[D+8>>3]-+ke[C+8>>3],ae=R*+vi(+ee),z=+ke[C>>3],+ +dn(+ae,+(+vi(+le)*+Ri(+z)-+Ri(+ee)*(R*+vi(+z))))}function Xn(C,D,z,R){C=C|0,D=+D,z=+z,R=R|0;var ee=0,le=0,ae=0,be=0;if(z<1e-16){o[R>>2]=o[C>>2],o[R+4>>2]=o[C+4>>2],o[R+8>>2]=o[C+8>>2],o[R+12>>2]=o[C+12>>2];return}le=D<0?D+6.283185307179586:D,le=D>=6.283185307179586?le+-6.283185307179586:le;do if(le<1e-16)D=+ke[C>>3]+z,ke[R>>3]=D,ee=R;else{if(ee=+Ai(+(le+-3.141592653589793))<1e-16,D=+ke[C>>3],ee){D=D-z,ke[R>>3]=D,ee=R;break}if(ae=+Ri(+z),z=+vi(+z),D=ae*+vi(+D)+ +Ri(+le)*(z*+Ri(+D)),D=D>1?1:D,D=+vn(+(D<-1?-1:D)),ke[R>>3]=D,+Ai(+(D+-1.5707963267948966))<1e-16){ke[R>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+Ai(+(D+1.5707963267948966))<1e-16){ke[R>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(be=+Ri(+D),le=z*+vi(+le)/be,z=+ke[C>>3],D=(ae-+vi(+D)*+vi(+z))/+Ri(+z)/be,ae=le>1?1:le,D=D>1?1:D,D=+ke[C+8>>3]+ +dn(+(ae<-1?-1:ae),+(D<-1?-1:D)),D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D;return}while(!1);if(+Ai(+(D+-1.5707963267948966))<1e-16){ke[ee>>3]=1.5707963267948966,ke[R+8>>3]=0;return}if(+Ai(+(D+1.5707963267948966))<1e-16){ke[ee>>3]=-1.5707963267948966,ke[R+8>>3]=0;return}if(D=+ke[C+8>>3],D>3.141592653589793)do D=D+-6.283185307179586;while(D>3.141592653589793);if(D<-3.141592653589793)do D=D+6.283185307179586;while(D<-3.141592653589793);ke[R+8>>3]=D}function Yo(C){return C=C|0,+ +ke[20496+(C<<3)>>3]}function Dr(C){return C=C|0,+ +ke[20624+(C<<3)>>3]}function Za(C){return C=C|0,+ +ke[20752+(C<<3)>>3]}function Kr(C){return C=C|0,+ +ke[20880+(C<<3)>>3]}function Ar(C){C=C|0;var D=0;return D=21008+(C<<3)|0,C=o[D>>2]|0,Fn(o[D+4>>2]|0),C|0}function So(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0;return Gt=+ke[D>>3],Ct=+ke[C>>3],We=+vi(+((Gt-Ct)*.5)),le=+ke[D+8>>3],yt=+ke[C+8>>3],ae=+vi(+((le-yt)*.5)),be=+Ri(+Ct),ii=+Ri(+Gt),ae=We*We+ae*(ii*be*ae),ae=+dn(+ +Kt(+ae),+ +Kt(+(1-ae)))*2,We=+ke[z>>3],Gt=+vi(+((We-Gt)*.5)),R=+ke[z+8>>3],le=+vi(+((R-le)*.5)),ee=+Ri(+We),le=Gt*Gt+le*(ii*ee*le),le=+dn(+ +Kt(+le),+ +Kt(+(1-le)))*2,We=+vi(+((Ct-We)*.5)),R=+vi(+((yt-R)*.5)),R=We*We+R*(be*ee*R),R=+dn(+ +Kt(+R),+ +Kt(+(1-R)))*2,ee=(ae+le+R)*.5,+(+ar(+ +Kt(+(+wi(+(ee*.5))*+wi(+((ee-ae)*.5))*+wi(+((ee-le)*.5))*+wi(+((ee-R)*.5)))))*4)}function Nn(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)<=0)return z=0,Vt=le,+z;if(z=+So(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)==1)return Vt=le,+z;C=1;do ae=C,C=C+1|0,z=z+ +So(ee+8+(ae<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0));return Vt=le,+z}function Ol(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+So(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do ae=C,C=C+1|0,z=z+ +So(ee+8+(ae<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475)}function Jr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0;if(le=Vt,Vt=Vt+192|0,R=le+168|0,ee=le,Sa(C,D,R),ka(C,D,ee),D=o[ee>>2]|0,(D|0)>0){if(z=+So(ee+8|0,ee+8+(((D|0)!=1&1)<<4)|0,R)+0,(D|0)!=1){C=1;do ae=C,C=C+1|0,z=z+ +So(ee+8+(ae<<4)|0,ee+8+(((C|0)%(D|0)|0)<<4)|0,R);while((C|0)<(D|0))}}else z=0;return Vt=le,+(z*6371.007180918475*6371.007180918475*1e3*1e3)}function jr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0;if(ae=Vt,Vt=Vt+176|0,le=ae,Oi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=ae,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],yt=+vi(+((R-We)*.5)),be=ee,ee=+ke[le+8+(C<<4)+8>>3],be=+vi(+((ee-be)*.5)),be=yt*yt+be*(+Ri(+R)*+Ri(+We)*be),z=z+ +dn(+ +Kt(+be),+ +Kt(+(1-be)))*2;while((C|0)<(D|0));return Vt=ae,+z}function ks(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0;if(ae=Vt,Vt=Vt+176|0,le=ae,Oi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=ae,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],yt=+vi(+((R-We)*.5)),be=ee,ee=+ke[le+8+(C<<4)+8>>3],be=+vi(+((ee-be)*.5)),be=yt*yt+be*(+Ri(+We)*+Ri(+R)*be),z=z+ +dn(+ +Kt(+be),+ +Kt(+(1-be)))*2;while((C|0)!=(D|0));return yt=z*6371.007180918475,Vt=ae,+yt}function Cr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0;if(ae=Vt,Vt=Vt+176|0,le=ae,Oi(C,D,le),C=o[le>>2]|0,(C|0)<=1)return ee=0,Vt=ae,+ee;D=C+-1|0,C=0,z=0,R=+ke[le+8>>3],ee=+ke[le+16>>3];do C=C+1|0,We=R,R=+ke[le+8+(C<<4)>>3],yt=+vi(+((R-We)*.5)),be=ee,ee=+ke[le+8+(C<<4)+8>>3],be=+vi(+((ee-be)*.5)),be=yt*yt+be*(+Ri(+We)*+Ri(+R)*be),z=z+ +dn(+ +Kt(+be),+ +Kt(+(1-be)))*2;while((C|0)!=(D|0));return yt=z*6371.007180918475*1e3,Vt=ae,+yt}function nr(C,D){return C=C|0,D=D|0,D=Mi(C|0,D|0,52)|0,Qt()|0,D&15|0}function al(C,D){return C=C|0,D=D|0,D=Mi(C|0,D|0,45)|0,Qt()|0,D&127|0}function Xr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0;if(!(!0&(D&-16777216|0)==134217728)||(ae=Mi(C|0,D|0,45)|0,Qt()|0,ae=ae&127,ae>>>0>121))return D=0,D|0;z=Mi(C|0,D|0,52)|0,Qt()|0,z=z&15;do if(z|0){for(ee=1,R=0;;){if(le=Mi(C|0,D|0,(15-ee|0)*3|0)|0,Qt()|0,le=le&7,(le|0)!=0&(R^1))if((le|0)==1&(N(ae)|0)!=0){be=0,R=13;break}else R=1;if((le|0)==7){be=0,R=13;break}if(ee>>>0<z>>>0)ee=ee+1|0;else{R=9;break}}if((R|0)==9){if((z|0)==15)be=1;else break;return be|0}else if((R|0)==13)return be|0}while(!1);for(;;){if(be=Mi(C|0,D|0,(14-z|0)*3|0)|0,Qt()|0,!((be&7|0)==7&!0)){be=0,R=13;break}if(z>>>0<14)z=z+1|0;else{be=1,R=13;break}}return(R|0)==13?be|0:0}function Io(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=Mi(C|0,D|0,52)|0,Qt()|0,R=R&15,(R|0)>=(z|0)){if((R|0)!=(z|0))if(z>>>0<=15){if(ee=zi(z|0,0,52)|0,C=ee|C,D=Qt()|0|D&-15728641,(R|0)>(z|0))do ee=zi(7,0,(14-z|0)*3|0)|0,z=z+1|0,C=ee|C,D=Qt()|0|D;while((z|0)<(R|0))}else D=0,C=0}else D=0,C=0;return Fn(D|0),C|0}function ol(C,D,z){return C=C|0,D=D|0,z=z|0,C=Mi(C|0,D|0,52)|0,Qt()|0,C=C&15,(z|0)<16&(C|0)<=(z|0)?(z=mo(7,z-C|0)|0,z|0):(z=0,z|0)}function Zr(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0;if(ae=Mi(C|0,D|0,52)|0,Qt()|0,ae=ae&15,!!((z|0)<16&(ae|0)<=(z|0))){if((ae|0)==(z|0)){z=R,o[z>>2]=C,o[z+4>>2]=D;return}if(We=mo(7,z-ae|0)|0,yt=(We|0)/7|0,be=Mi(C|0,D|0,45)|0,Qt()|0,!(N(be&127)|0))le=0;else{e:do if(!ae)ee=0;else for(le=1;;){if(ee=Mi(C|0,D|0,(15-le|0)*3|0)|0,Qt()|0,ee=ee&7,ee|0)break e;if(le>>>0<ae>>>0)le=le+1|0;else{ee=0;break}}while(!1);le=(ee|0)==0}if(Ct=zi(ae+1|0,0,52)|0,ee=Qt()|0|D&-15728641,be=(14-ae|0)*3|0,D=zi(7,0,be|0)|0,D=(Ct|C)&~D,ae=ee&~(Qt()|0),Zr(D,ae,z,R),ee=R+(yt<<3)|0,!le){Ct=zi(1,0,be|0)|0,Zr(Ct|D,Qt()|0|ae,z,ee),Ct=ee+(yt<<3)|0,We=zi(2,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct),Ct=Ct+(yt<<3)|0,We=zi(3,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct),Ct=Ct+(yt<<3)|0,We=zi(4,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct),Ct=Ct+(yt<<3)|0,We=zi(5,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct),We=zi(6,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct+(yt<<3)|0);return}le=ee+(yt<<3)|0,(We|0)>6&&(We=ee+8|0,Ct=(le>>>0>We>>>0?le:We)+-1+(0-ee)|0,cs(ee|0,0,Ct+8&-8|0)|0,ee=We+(Ct>>>3<<3)|0),Ct=zi(2,0,be|0)|0,Zr(Ct|D,Qt()|0|ae,z,ee),Ct=ee+(yt<<3)|0,We=zi(3,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct),Ct=Ct+(yt<<3)|0,We=zi(4,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct),Ct=Ct+(yt<<3)|0,We=zi(5,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct),We=zi(6,0,be|0)|0,Zr(We|D,Qt()|0|ae,z,Ct+(yt<<3)|0)}}function hs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=Mi(C|0,D|0,45)|0,Qt()|0,!(N(ee&127)|0))return ee=0,ee|0;ee=Mi(C|0,D|0,52)|0,Qt()|0,ee=ee&15;e:do if(!ee)z=0;else for(R=1;;){if(z=Mi(C|0,D|0,(15-R|0)*3|0)|0,Qt()|0,z=z&7,z|0)break e;if(R>>>0<ee>>>0)R=R+1|0;else{z=0;break}}while(!1);return ee=(z|0)==0&1,ee|0}function wa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(R=Mi(C|0,D|0,52)|0,Qt()|0,R=R&15,(z|0)<16&(R|0)<=(z|0)){if((R|0)!=(z|0)&&(ee=zi(z|0,0,52)|0,C=ee|C,D=Qt()|0|D&-15728641,(R|0)<(z|0)))do ee=zi(7,0,(14-R|0)*3|0)|0,R=R+1|0,C=C&~ee,D=D&~(Qt()|0);while((R|0)<(z|0))}else D=0,C=0;return Fn(D|0),C|0}function Tl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0;if(!z)return l=0,l|0;if(ee=C,R=o[ee>>2]|0,ee=o[ee+4>>2]|0,!0&(ee&15728640|0)==0){if((z|0)<=0||(l=D,o[l>>2]=R,o[l+4>>2]=ee,(z|0)==1))return l=0,l|0;R=1;do i=C+(R<<3)|0,r=o[i+4>>2]|0,l=D+(R<<3)|0,o[l>>2]=o[i>>2],o[l+4>>2]=r,R=R+1|0;while((R|0)!=(z|0));return R=0,R|0}if(i=z<<3,r=Gn(i)|0,!r)return l=-3,l|0;if(Oo(r|0,C|0,i|0)|0,s=Jo(z,8)|0,!s)return Jn(r),l=-3,l|0;R=z;e:for(;;){ae=r,Ct=o[ae>>2]|0,ae=o[ae+4>>2]|0,O=Mi(Ct|0,ae|0,52)|0,Qt()|0,O=O&15,y=O+-1|0,F=(R|0)>0;t:do if(F){if(I=((R|0)<0)<<31>>31,Z=zi(y|0,0,52)|0,A=Qt()|0,y>>>0>15)for(ee=0,C=Ct,z=ae;;){if(!((C|0)==0&(z|0)==0)){if(le=Mi(C|0,z|0,52)|0,Qt()|0,le=le&15,be=(le|0)<(y|0),le=(le|0)==(y|0),yt=be?0:le?C:0,C=be?0:le?z:0,z=Co(yt|0,C|0,R|0,I|0)|0,Qt()|0,le=s+(z<<3)|0,be=le,We=o[be>>2]|0,be=o[be+4>>2]|0,(We|0)==0&(be|0)==0)z=yt;else for(Z=0,jt=z,Gt=be,z=yt;;){if((Z|0)>(R|0)){l=41;break e}if((We|0)==(z|0)&(Gt&-117440513|0)==(C|0)){yt=Mi(We|0,Gt|0,56)|0,Qt()|0,yt=yt&7,ii=yt+1|0,A=Mi(We|0,Gt|0,45)|0,Qt()|0;i:do if(!(N(A&127)|0))be=7;else{if(We=Mi(We|0,Gt|0,52)|0,Qt()|0,We=We&15,!We){be=6;break}for(be=1;;){if(A=zi(7,0,(15-be|0)*3|0)|0,!((A&z|0)==0&((Qt()|0)&C|0)==0)){be=7;break i}if(be>>>0<We>>>0)be=be+1|0;else{be=6;break}}}while(!1);if((yt+2|0)>>>0>be>>>0){l=51;break e}A=zi(ii|0,0,56)|0,C=Qt()|0|C&-117440513,be=le,o[be>>2]=0,o[be+4>>2]=0,be=jt,z=A|z}else be=(jt+1|0)%(R|0)|0;if(le=s+(be<<3)|0,Gt=le,We=o[Gt>>2]|0,Gt=o[Gt+4>>2]|0,(We|0)==0&(Gt|0)==0)break;Z=Z+1|0,jt=be}A=le,o[A>>2]=z,o[A+4>>2]=C}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}for(ee=0,C=Ct,z=ae;;){if(!((C|0)==0&(z|0)==0)){if(be=Mi(C|0,z|0,52)|0,Qt()|0,be=be&15,(be|0)>=(y|0)){if((be|0)!=(y|0)&&(C=C|Z,z=z&-15728641|A,be>>>0>=O>>>0)){le=y;do jt=zi(7,0,(14-le|0)*3|0)|0,le=le+1|0,C=jt|C,z=Qt()|0|z;while(le>>>0<be>>>0)}}else C=0,z=0;if(be=Co(C|0,z|0,R|0,I|0)|0,Qt()|0,le=s+(be<<3)|0,We=le,yt=o[We>>2]|0,We=o[We+4>>2]|0,!((yt|0)==0&(We|0)==0))for(jt=0;;){if((jt|0)>(R|0)){l=41;break e}if((yt|0)==(C|0)&(We&-117440513|0)==(z|0)){ii=Mi(yt|0,We|0,56)|0,Qt()|0,ii=ii&7,Gt=ii+1|0,d=Mi(yt|0,We|0,45)|0,Qt()|0;i:do if(!(N(d&127)|0))We=7;else{if(yt=Mi(yt|0,We|0,52)|0,Qt()|0,yt=yt&15,!yt){We=6;break}for(We=1;;){if(d=zi(7,0,(15-We|0)*3|0)|0,!((d&C|0)==0&((Qt()|0)&z|0)==0)){We=7;break i}if(We>>>0<yt>>>0)We=We+1|0;else{We=6;break}}}while(!1);if((ii+2|0)>>>0>We>>>0){l=51;break e}d=zi(Gt|0,0,56)|0,z=Qt()|0|z&-117440513,Gt=le,o[Gt>>2]=0,o[Gt+4>>2]=0,C=d|C}else be=(be+1|0)%(R|0)|0;if(le=s+(be<<3)|0,We=le,yt=o[We>>2]|0,We=o[We+4>>2]|0,(yt|0)==0&(We|0)==0)break;jt=jt+1|0}d=le,o[d>>2]=C,o[d+4>>2]=z}if(ee=ee+1|0,(ee|0)>=(R|0))break t;z=r+(ee<<3)|0,C=o[z>>2]|0,z=o[z+4>>2]|0}}while(!1);if((R+5|0)>>>0<11){l=99;break}if(A=Jo((R|0)/6|0,8)|0,!A){l=58;break}t:do if(F){jt=0,Gt=0;do{if(be=s+(jt<<3)|0,C=be,ee=o[C>>2]|0,C=o[C+4>>2]|0,!((ee|0)==0&(C|0)==0)){We=Mi(ee|0,C|0,56)|0,Qt()|0,We=We&7,z=We+1|0,yt=C&-117440513,d=Mi(ee|0,C|0,45)|0,Qt()|0;i:do if(N(d&127)|0){if(ii=Mi(ee|0,C|0,52)|0,Qt()|0,ii=ii&15,ii|0)for(le=1;;){if(d=zi(7,0,(15-le|0)*3|0)|0,!((ee&d|0)==0&(yt&(Qt()|0)|0)==0))break i;if(le>>>0<ii>>>0)le=le+1|0;else break}C=zi(z|0,0,56)|0,ee=C|ee,C=Qt()|0|yt,z=be,o[z>>2]=ee,o[z+4>>2]=C,z=We+2|0}while(!1);(z|0)==7&&(d=A+(Gt<<3)|0,o[d>>2]=ee,o[d+4>>2]=C&-117440513,Gt=Gt+1|0)}jt=jt+1|0}while((jt|0)!=(R|0));if(F){if(Z=((R|0)<0)<<31>>31,ii=zi(y|0,0,52)|0,jt=Qt()|0,y>>>0>15)for(C=0,ee=0;;){do if(!((Ct|0)==0&(ae|0)==0)){for(We=Mi(Ct|0,ae|0,52)|0,Qt()|0,We=We&15,le=(We|0)<(y|0),We=(We|0)==(y|0),be=le?0:We?Ct:0,We=le?0:We?ae:0,le=Co(be|0,We|0,R|0,Z|0)|0,Qt()|0,z=0;;){if((z|0)>(R|0)){l=98;break e}if(d=s+(le<<3)|0,yt=o[d+4>>2]|0,(yt&-117440513|0)==(We|0)&&(o[d>>2]|0)==(be|0)){l=70;break}if(le=(le+1|0)%(R|0)|0,d=s+(le<<3)|0,(o[d>>2]|0)==(be|0)&&(o[d+4>>2]|0)==(We|0))break;z=z+1|0}if((l|0)==70&&(l=0,!0&(yt&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=ae,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}ae=r+(C<<3)|0,Ct=o[ae>>2]|0,ae=o[ae+4>>2]|0}for(C=0,ee=0;;){do if(!((Ct|0)==0&(ae|0)==0)){if(We=Mi(Ct|0,ae|0,52)|0,Qt()|0,We=We&15,(We|0)>=(y|0))if((We|0)!=(y|0))if(z=Ct|ii,le=ae&-15728641|jt,We>>>0<O>>>0)We=le;else{be=y;do d=zi(7,0,(14-be|0)*3|0)|0,be=be+1|0,z=d|z,le=Qt()|0|le;while(be>>>0<We>>>0);We=le}else z=Ct,We=ae;else z=0,We=0;for(be=Co(z|0,We|0,R|0,Z|0)|0,Qt()|0,le=0;;){if((le|0)>(R|0)){l=98;break e}if(d=s+(be<<3)|0,yt=o[d+4>>2]|0,(yt&-117440513|0)==(We|0)&&(o[d>>2]|0)==(z|0)){l=93;break}if(be=(be+1|0)%(R|0)|0,d=s+(be<<3)|0,(o[d>>2]|0)==(z|0)&&(o[d+4>>2]|0)==(We|0))break;le=le+1|0}if((l|0)==93&&(l=0,!0&(yt&117440512|0)==100663296))break;d=D+(ee<<3)|0,o[d>>2]=Ct,o[d+4>>2]=ae,ee=ee+1|0}while(!1);if(C=C+1|0,(C|0)>=(R|0)){R=Gt;break t}ae=r+(C<<3)|0,Ct=o[ae>>2]|0,ae=o[ae+4>>2]|0}}else ee=0,R=Gt}else ee=0,R=0;while(!1);if(cs(s|0,0,i|0)|0,Oo(r|0,A|0,R<<3|0)|0,Jn(A),R)D=D+(ee<<3)|0;else break}return(l|0)==41?(Jn(r),Jn(s),d=-1,d|0):(l|0)==51?(Jn(r),Jn(s),d=-2,d|0):(l|0)==58?(Jn(r),Jn(s),d=-3,d|0):(l|0)==98?(Jn(A),Jn(r),Jn(s),d=-1,d|0):((l|0)==99&&Oo(D|0,r|0,R<<3|0)|0,Jn(r),Jn(s),d=0,d|0)}function Eo(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0;if((D|0)<=0)return ee=0,ee|0;if((ee|0)>=16){for(le=0;;){if(Ct=C+(le<<3)|0,!((o[Ct>>2]|0)==0&(o[Ct+4>>2]|0)==0)){le=14;break}if(le=le+1|0,(le|0)>=(D|0)){ae=0,le=16;break}}if((le|0)==14)return((R|0)>0?-2:-1)|0;if((le|0)==16)return ae|0}le=0,Ct=0;e:for(;;){yt=C+(Ct<<3)|0,be=yt,ae=o[be>>2]|0,be=o[be+4>>2]|0;do if(!((ae|0)==0&(be|0)==0)){if((le|0)>=(R|0)){ae=-1,le=16;break e}if(We=Mi(ae|0,be|0,52)|0,Qt()|0,We=We&15,(We|0)>(ee|0)){ae=-2,le=16;break e}if((We|0)==(ee|0)){yt=z+(le<<3)|0,o[yt>>2]=ae,o[yt+4>>2]=be,le=le+1|0;break}if(ae=(mo(7,ee-We|0)|0)+le|0,(ae|0)>(R|0)){ae=-1,le=16;break e}Zr(o[yt>>2]|0,o[yt+4>>2]|0,ee,z+(le<<3)|0),le=ae}while(!1);if(Ct=Ct+1|0,(Ct|0)>=(D|0)){ae=0,le=16;break}}return(le|0)==16?ae|0:0}function kl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0;if((D|0)<=0)return z=0,z|0;if((z|0)>=16){for(R=0;;){if(ae=C+(R<<3)|0,!((o[ae>>2]|0)==0&(o[ae+4>>2]|0)==0)){R=-1,ee=13;break}if(R=R+1|0,(R|0)>=(D|0)){R=0,ee=13;break}}if((ee|0)==13)return R|0}R=0,ae=0;e:for(;;){ee=C+(ae<<3)|0,le=o[ee>>2]|0,ee=o[ee+4>>2]|0;do if(!((le|0)==0&(ee|0)==0)){if(ee=Mi(le|0,ee|0,52)|0,Qt()|0,ee=ee&15,(ee|0)>(z|0)){R=-1,ee=13;break e}if((ee|0)==(z|0)){R=R+1|0;break}else{R=(mo(7,z-ee|0)|0)+R|0;break}}while(!1);if(ae=ae+1|0,(ae|0)>=(D|0)){ee=13;break}}return(ee|0)==13?R|0:0}function Ao(C,D){return C=C|0,D=D|0,D=Mi(C|0,D|0,52)|0,Qt()|0,D&1|0}function Js(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(ee=Mi(C|0,D|0,52)|0,Qt()|0,ee=ee&15,!ee)return ee=0,ee|0;for(R=1;;){if(z=Mi(C|0,D|0,(15-R|0)*3|0)|0,Qt()|0,z=z&7,z|0){R=5;break}if(R>>>0<ee>>>0)R=R+1|0;else{z=0,R=5;break}}return(R|0)==5?z|0:0}function Gs(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0;if(We=Mi(C|0,D|0,52)|0,Qt()|0,We=We&15,!We)return be=D,We=C,Fn(be|0),We|0;for(be=1,z=0;;){le=(15-be|0)*3|0,R=zi(7,0,le|0)|0,ee=Qt()|0,ae=Mi(C|0,D|0,le|0)|0,Qt()|0,le=zi(ca(ae&7)|0,0,le|0)|0,ae=Qt()|0,C=le|C&~R,D=ae|D&~ee;e:do if(!z)if((le&R|0)==0&(ae&ee|0)==0)z=0;else if(R=Mi(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(ae=Mi(C|0,D|0,(15-z|0)*3|0)|0,Qt()|0,ae&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(ae=(15-z|0)*3|0,ee=Mi(C|0,D|0,ae|0)|0,Qt()|0,le=zi(7,0,ae|0)|0,D=D&~(Qt()|0),ae=zi(ca(ee&7)|0,0,ae|0)|0,C=C&~le|ae,D=D|(Qt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(be>>>0<We>>>0)be=be+1|0;else break}return Fn(D|0),C|0}function Qa(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0;if(R=Mi(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)return z=D,R=C,Fn(z|0),R|0;for(z=1;le=(15-z|0)*3|0,ae=Mi(C|0,D|0,le|0)|0,Qt()|0,ee=zi(7,0,le|0)|0,D=D&~(Qt()|0),le=zi(ca(ae&7)|0,0,le|0)|0,C=le|C&~ee,D=Qt()|0|D,z>>>0<R>>>0;)z=z+1|0;return Fn(D|0),C|0}function $o(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0;if(We=Mi(C|0,D|0,52)|0,Qt()|0,We=We&15,!We)return be=D,We=C,Fn(be|0),We|0;for(be=1,z=0;;){le=(15-be|0)*3|0,R=zi(7,0,le|0)|0,ee=Qt()|0,ae=Mi(C|0,D|0,le|0)|0,Qt()|0,le=zi(Ys(ae&7)|0,0,le|0)|0,ae=Qt()|0,C=le|C&~R,D=ae|D&~ee;e:do if(!z)if((le&R|0)==0&(ae&ee|0)==0)z=0;else if(R=Mi(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)z=1;else{z=1;t:for(;;){switch(ae=Mi(C|0,D|0,(15-z|0)*3|0)|0,Qt()|0,ae&7){case 1:break t;case 0:break;default:{z=1;break e}}if(z>>>0<R>>>0)z=z+1|0;else{z=1;break e}}for(z=1;;)if(ee=(15-z|0)*3|0,le=zi(7,0,ee|0)|0,ae=D&~(Qt()|0),D=Mi(C|0,D|0,ee|0)|0,Qt()|0,D=zi(Ys(D&7)|0,0,ee|0)|0,C=C&~le|D,D=ae|(Qt()|0),z>>>0<R>>>0)z=z+1|0;else{z=1;break}}while(!1);if(be>>>0<We>>>0)be=be+1|0;else break}return Fn(D|0),C|0}function Yr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0;if(R=Mi(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)return z=D,R=C,Fn(z|0),R|0;for(z=1;ae=(15-z|0)*3|0,le=zi(7,0,ae|0)|0,ee=D&~(Qt()|0),D=Mi(C|0,D|0,ae|0)|0,Qt()|0,D=zi(Ys(D&7)|0,0,ae|0)|0,C=D|C&~le,D=Qt()|0|ee,z>>>0<R>>>0;)z=z+1|0;return Fn(D|0),C|0}function mr(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0;if(We=Vt,Vt=Vt+64|0,be=We+40|0,R=We+24|0,ee=We+12|0,le=We,zi(D|0,0,52)|0,z=Qt()|0|134225919,!D)return(o[C+4>>2]|0)>2||(o[C+8>>2]|0)>2||(o[C+12>>2]|0)>2?(ae=0,be=0,Fn(ae|0),Vt=We,be|0):(zi(tt(C)|0,0,45)|0,ae=Qt()|0|z,be=-1,Fn(ae|0),Vt=We,be|0);if(o[be>>2]=o[C>>2],o[be+4>>2]=o[C+4>>2],o[be+8>>2]=o[C+8>>2],o[be+12>>2]=o[C+12>>2],ae=be+4|0,(D|0)>0)for(C=-1;o[R>>2]=o[ae>>2],o[R+4>>2]=o[ae+4>>2],o[R+8>>2]=o[ae+8>>2],D&1?(Pr(ae),o[ee>>2]=o[ae>>2],o[ee+4>>2]=o[ae+4>>2],o[ee+8>>2]=o[ae+8>>2],Ho(ee)):(bo(ae),o[ee>>2]=o[ae>>2],o[ee+4>>2]=o[ae+4>>2],o[ee+8>>2]=o[ae+8>>2],Ls(ee)),js(R,ee,le),ir(le),Ct=(15-D|0)*3|0,yt=zi(7,0,Ct|0)|0,z=z&~(Qt()|0),Ct=zi(Ks(le)|0,0,Ct|0)|0,C=Ct|C&~yt,z=Qt()|0|z,(D|0)>1;)D=D+-1|0;else C=-1;e:do if((o[ae>>2]|0)<=2&&(o[be+8>>2]|0)<=2&&(o[be+12>>2]|0)<=2){if(R=tt(be)|0,D=zi(R|0,0,45)|0,D=D|C,C=Qt()|0|z&-1040385,le=It(be)|0,!(N(R)|0)){if((le|0)<=0)break;for(ee=0;;){if(R=Mi(D|0,C|0,52)|0,Qt()|0,R=R&15,R)for(z=1;Ct=(15-z|0)*3|0,be=Mi(D|0,C|0,Ct|0)|0,Qt()|0,yt=zi(7,0,Ct|0)|0,C=C&~(Qt()|0),Ct=zi(ca(be&7)|0,0,Ct|0)|0,D=D&~yt|Ct,C=C|(Qt()|0),z>>>0<R>>>0;)z=z+1|0;if(ee=ee+1|0,(ee|0)==(le|0))break e}}ee=Mi(D|0,C|0,52)|0,Qt()|0,ee=ee&15;t:do if(ee){z=1;i:for(;;){switch(Ct=Mi(D|0,C|0,(15-z|0)*3|0)|0,Qt()|0,Ct&7){case 1:break i;case 0:break;default:break t}if(z>>>0<ee>>>0)z=z+1|0;else break t}if(Bi(R,o[be>>2]|0)|0)for(z=1;be=(15-z|0)*3|0,yt=zi(7,0,be|0)|0,Ct=C&~(Qt()|0),C=Mi(D|0,C|0,be|0)|0,Qt()|0,C=zi(Ys(C&7)|0,0,be|0)|0,D=D&~yt|C,C=Ct|(Qt()|0),z>>>0<ee>>>0;)z=z+1|0;else for(z=1;Ct=(15-z|0)*3|0,be=Mi(D|0,C|0,Ct|0)|0,Qt()|0,yt=zi(7,0,Ct|0)|0,C=C&~(Qt()|0),Ct=zi(ca(be&7)|0,0,Ct|0)|0,D=D&~yt|Ct,C=C|(Qt()|0),z>>>0<ee>>>0;)z=z+1|0}while(!1);if((le|0)>0){z=0;do D=Gs(D,C)|0,C=Qt()|0,z=z+1|0;while((z|0)!=(le|0))}}else D=0,C=0;while(!1);return yt=C,Ct=D,Fn(yt|0),Vt=We,Ct|0}function Rr(C){return C=C|0,(C|0)%2|0|0}function ha(C,D){C=C|0,D=D|0;var z=0,R=0;return R=Vt,Vt=Vt+16|0,z=R,D>>>0<=15&&(o[C+4>>2]&2146435072|0)!=2146435072&&(o[C+8+4>>2]&2146435072|0)!=2146435072?(sc(C,D,z),D=mr(z,D)|0,C=Qt()|0):(C=0,D=0),Fn(C|0),Vt=R,D|0}function fo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0;if(ee=z+4|0,le=Mi(C|0,D|0,52)|0,Qt()|0,le=le&15,ae=Mi(C|0,D|0,45)|0,Qt()|0,R=(le|0)==0,N(ae&127)|0){if(R)return ae=1,ae|0;R=1}else{if(R)return ae=0,ae|0;!(o[ee>>2]|0)&&!(o[z+8>>2]|0)?R=(o[z+12>>2]|0)!=0&1:R=1}for(z=1;z&1?Ho(ee):Ls(ee),ae=Mi(C|0,D|0,(15-z|0)*3|0)|0,Qt()|0,Il(ee,ae&7),z>>>0<le>>>0;)z=z+1|0;return R|0}function ea(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0;Ct=Vt,Vt=Vt+16|0,We=Ct,yt=Mi(C|0,D|0,45)|0,Qt()|0,yt=yt&127;e:do if(N(yt)|0&&(le=Mi(C|0,D|0,52)|0,Qt()|0,le=le&15,(le|0)!=0)){R=1;t:for(;;){switch(be=Mi(C|0,D|0,(15-R|0)*3|0)|0,Qt()|0,be&7){case 5:break t;case 0:break;default:{R=D;break e}}if(R>>>0<le>>>0)R=R+1|0;else{R=D;break e}}for(ee=1,R=D;D=(15-ee|0)*3|0,ae=zi(7,0,D|0)|0,be=R&~(Qt()|0),R=Mi(C|0,R|0,D|0)|0,Qt()|0,R=zi(Ys(R&7)|0,0,D|0)|0,C=C&~ae|R,R=be|(Qt()|0),ee>>>0<le>>>0;)ee=ee+1|0}else R=D;while(!1);if(be=7728+(yt*28|0)|0,o[z>>2]=o[be>>2],o[z+4>>2]=o[be+4>>2],o[z+8>>2]=o[be+8>>2],o[z+12>>2]=o[be+12>>2],!(fo(C,R,z)|0)){Vt=Ct;return}if(ae=z+4|0,o[We>>2]=o[ae>>2],o[We+4>>2]=o[ae+4>>2],o[We+8>>2]=o[ae+8>>2],le=Mi(C|0,R|0,52)|0,Qt()|0,be=le&15,le&1?(Ls(ae),le=be+1|0):le=be,!(N(yt)|0))R=0;else{e:do if(!be)R=0;else for(D=1;;){if(ee=Mi(C|0,R|0,(15-D|0)*3|0)|0,Qt()|0,ee=ee&7,ee|0){R=ee;break e}if(D>>>0<be>>>0)D=D+1|0;else{R=0;break}}while(!1);R=(R|0)==4&1}if(!(wo(z,le,R,0)|0))(le|0)!=(be|0)&&(o[ae>>2]=o[We>>2],o[ae+4>>2]=o[We+4>>2],o[ae+8>>2]=o[We+8>>2]);else{if(N(yt)|0)do;while(wo(z,le,0,0)|0);(le|0)!=(be|0)&&bo(ae)}Vt=Ct}function Sa(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;R=Vt,Vt=Vt+16|0,ee=R,ea(C,D,ee),D=Mi(C|0,D|0,52)|0,Qt()|0,ql(ee,D&15,z),Vt=R}function ka(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0;ae=Vt,Vt=Vt+16|0,le=ae,ea(C,D,le),R=Mi(C|0,D|0,45)|0,Qt()|0,R=(N(R&127)|0)==0,ee=Mi(C|0,D|0,52)|0,Qt()|0,ee=ee&15;e:do if(!R){if(ee|0)for(R=1;;){if(be=zi(7,0,(15-R|0)*3|0)|0,!((be&C|0)==0&((Qt()|0)&D|0)==0))break e;if(R>>>0<ee>>>0)R=R+1|0;else break}Ro(le,ee,0,5,z),Vt=ae;return}while(!1);Qo(le,ee,0,6,z),Vt=ae}function Wa(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;if(R=Mi(C|0,D|0,45)|0,Qt()|0,!(N(R&127)|0))return R=2,R|0;if(R=Mi(C|0,D|0,52)|0,Qt()|0,R=R&15,!R)return R=5,R|0;for(z=1;;){if(ee=zi(7,0,(15-z|0)*3|0)|0,!((ee&C|0)==0&((Qt()|0)&D|0)==0)){z=2,C=6;break}if(z>>>0<R>>>0)z=z+1|0;else{z=5,C=6;break}}return(C|0)==6?z|0:0}function ll(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0;ii=Vt,Vt=Vt+128|0,yt=ii+112|0,le=ii+96|0,Ct=ii,ee=Mi(C|0,D|0,52)|0,Qt()|0,be=ee&15,o[yt>>2]=be,ae=Mi(C|0,D|0,45)|0,Qt()|0,ae=ae&127;e:do if(N(ae)|0){if(be|0)for(R=1;;){if(We=zi(7,0,(15-R|0)*3|0)|0,!((We&C|0)==0&((Qt()|0)&D|0)==0)){ee=0;break e}if(R>>>0<be>>>0)R=R+1|0;else break}if(ee&1)ee=1;else{We=zi(be+1|0,0,52)|0,Ct=Qt()|0|D&-15728641,yt=zi(7,0,(14-be|0)*3|0)|0,ll((We|C)&~yt,Ct&~(Qt()|0),z),Vt=ii;return}}else ee=0;while(!1);ea(C,D,le),ee?(Zo(le,yt,Ct),We=5):(Wo(le,yt,Ct),We=6);e:do if(N(ae)|0)if(!be)R=20;else for(R=1;;){if(ae=zi(7,0,(15-R|0)*3|0)|0,!((ae&C|0)==0&((Qt()|0)&D|0)==0)){R=8;break e}if(R>>>0<be>>>0)R=R+1|0;else{R=20;break}}else R=8;while(!1);if(cs(z|0,-1,R|0)|0,ee){ee=0;do{for(le=Ct+(ee<<4)|0,Us(le,o[yt>>2]|0)|0,le=o[le>>2]|0,R=0;ae=z+(R<<2)|0,be=o[ae>>2]|0,!((be|0)==-1|(be|0)==(le|0));)R=R+1|0;o[ae>>2]=le,ee=ee+1|0}while((ee|0)!=(We|0))}else{ee=0;do{for(le=Ct+(ee<<4)|0,wo(le,o[yt>>2]|0,0,1)|0,le=o[le>>2]|0,R=0;ae=z+(R<<2)|0,be=o[ae>>2]|0,!((be|0)==-1|(be|0)==(le|0));)R=R+1|0;o[ae>>2]=le,ee=ee+1|0}while((ee|0)!=(We|0))}Vt=ii}function ou(){return 12}function gl(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0;if(zi(C|0,0,52)|0,be=Qt()|0|134225919,(C|0)<1){R=0,z=0;do N(R)|0&&(zi(R|0,0,45)|0,ae=be|(Qt()|0),C=D+(z<<3)|0,o[C>>2]=-1,o[C+4>>2]=ae,z=z+1|0),R=R+1|0;while((R|0)!=122);return}ae=0,z=0;do{if(N(ae)|0){for(zi(ae|0,0,45)|0,R=1,ee=-1,le=be|(Qt()|0);We=zi(7,0,(15-R|0)*3|0)|0,ee=ee&~We,le=le&~(Qt()|0),(R|0)!=(C|0);)R=R+1|0;We=D+(z<<3)|0,o[We>>2]=ee,o[We+4>>2]=le,z=z+1|0}ae=ae+1|0}while((ae|0)!=122)}function io(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0,yt=0;if(be=Vt,Vt=Vt+64|0,ae=be,(C|0)==(z|0)&(D|0)==(R|0)|(!1|(D&2013265920|0)!=134217728|(!1|(R&2013265920|0)!=134217728))||(ee=Mi(C|0,D|0,52)|0,Qt()|0,ee=ee&15,le=Mi(z|0,R|0,52)|0,Qt()|0,(ee|0)!=(le&15|0)))return ae=0,Vt=be,ae|0;if(le=ee+-1|0,ee>>>0>1&&(yt=Io(C,D,le)|0,We=Qt()|0,le=Io(z,R,le)|0,(yt|0)==(le|0)&(We|0)==(Qt()|0))&&(le=(ee^15)*3|0,ee=Mi(C|0,D|0,le|0)|0,Qt()|0,ee=ee&7,le=Mi(z|0,R|0,le|0)|0,Qt()|0,le=le&7,(ee|0)==0|(le|0)==0||(o[21136+(ee<<2)>>2]|0)==(le|0)||(o[21168+(ee<<2)>>2]|0)==(le|0)))return yt=1,Vt=be,yt|0;ee=ae,le=ee+56|0;do o[ee>>2]=0,ee=ee+4|0;while((ee|0)<(le|0));return Fa(C,D,1,ae),yt=ae,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0))&&(yt=ae+8|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=ae+16|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=ae+24|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=ae+32|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))&&(yt=ae+40|0,!((o[yt>>2]|0)==(z|0)&&(o[yt+4>>2]|0)==(R|0)))?(ee=ae+48|0,ee=((o[ee>>2]|0)==(z|0)?(o[ee+4>>2]|0)==(R|0):0)&1):ee=1,yt=ee,Vt=be,yt|0}function mi(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0;if(yt=Vt,Vt=Vt+16|0,ae=yt,!(io(C,D,z,R)|0))return be=0,We=0,Fn(be|0),Vt=yt,We|0;for(be=D&-2130706433,ee=(hs(C,D)|0)==0,ee=ee?1:2;o[ae>>2]=0,Ct=jn(C,D,ee,ae)|0,le=ee+1|0,!((Ct|0)==(z|0)&(Qt()|0)==(R|0));)if(le>>>0<7)ee=le;else{ee=0,C=0,We=6;break}return(We|0)==6?(Fn(ee|0),Vt=yt,C|0):(Ct=zi(ee|0,0,56)|0,We=be|(Qt()|0)|268435456,Ct=C|Ct,Fn(We|0),Vt=yt,Ct|0)}function Ni(C,D){C=C|0,D=D|0;var z=0;return z=!0&(D&2013265920|0)==268435456,Fn((z?D&-2130706433|134217728:0)|0),(z?C:0)|0}function Di(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return R=Vt,Vt=Vt+16|0,z=R,!0&(D&2013265920|0)==268435456?(ee=Mi(C|0,D|0,56)|0,Qt()|0,o[z>>2]=0,z=jn(C,D&-2130706433|134217728,ee&7,z)|0,D=Qt()|0,Fn(D|0),Vt=R,z|0):(D=0,z=0,Fn(D|0),Vt=R,z|0)}function Ot(C,D){C=C|0,D=D|0;var z=0;if(!(!0&(D&2013265920|0)==268435456))return z=0,z|0;switch(z=Mi(C|0,D|0,56)|0,Qt()|0,z&7){case 0:case 7:return z=0,z|0}return z=D&-2130706433|134217728,!0&(D&117440512|0)==16777216&(hs(C,z)|0)!=0?(z=0,z|0):(z=Xr(C,z)|0,z|0)}function ei(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0;le=Vt,Vt=Vt+16|0,R=le,ae=!0&(D&2013265920|0)==268435456,ee=D&-2130706433|134217728,be=z,o[be>>2]=ae?C:0,o[be+4>>2]=ae?ee:0,ae?(D=Mi(C|0,D|0,56)|0,Qt()|0,o[R>>2]=0,C=jn(C,ee,D&7,R)|0,D=Qt()|0):(C=0,D=0),be=z+8|0,o[be>>2]=C,o[be+4>>2]=D,Vt=le}function xi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;ee=(hs(C,D)|0)==0,D=D&-2130706433,R=z,o[R>>2]=ee?C:0,o[R+4>>2]=ee?D|285212672:0,R=z+8|0,o[R>>2]=C,o[R+4>>2]=D|301989888,R=z+16|0,o[R>>2]=C,o[R+4>>2]=D|318767104,R=z+24|0,o[R>>2]=C,o[R+4>>2]=D|335544320,R=z+32|0,o[R>>2]=C,o[R+4>>2]=D|352321536,z=z+40|0,o[z>>2]=C,o[z+4>>2]=D|369098752}function Oi(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0;if(ae=Vt,Vt=Vt+16|0,le=ae,R=Mi(C|0,D|0,56)|0,Qt()|0,be=!0&(D&2013265920|0)==268435456,ee=be?C:0,C=be?D&-2130706433|134217728:0,D=jl(ee,C,R&7)|0,(D|0)==-1){o[z>>2]=0,Vt=ae;return}ea(ee,C,le),R=Mi(ee|0,C|0,52)|0,Qt()|0,R=R&15,hs(ee,C)|0?Ro(le,R,D,2,z):Qo(le,R,D,2,z),Vt=ae}function Ln(C){C=C|0;var D=0,z=0,R=0;return D=Jo(1,12)|0,D||Yi(22691,22646,49,22704),z=C+4|0,R=o[z>>2]|0,R|0?(R=R+8|0,o[R>>2]=D,o[z>>2]=D,D|0):(o[C>>2]|0&&Yi(22721,22646,61,22744),R=C,o[R>>2]=D,o[z>>2]=D,D|0)}function Un(C,D){C=C|0,D=D|0;var z=0,R=0;return R=Gn(24)|0,R||Yi(22758,22646,78,22772),o[R>>2]=o[D>>2],o[R+4>>2]=o[D+4>>2],o[R+8>>2]=o[D+8>>2],o[R+12>>2]=o[D+12>>2],o[R+16>>2]=0,D=C+4|0,z=o[D>>2]|0,z|0?(o[z+16>>2]=R,o[D>>2]=R,R|0):(o[C>>2]|0&&Yi(22787,22646,82,22772),o[C>>2]=R,o[D>>2]=R,R|0)}function or(C){C=C|0;var D=0,z=0,R=0,ee=0;if(C)for(R=1;;){if(D=o[C>>2]|0,D|0)do{if(z=o[D>>2]|0,z|0)do ee=z,z=o[z+16>>2]|0,Jn(ee);while(z|0);ee=D,D=o[D+8>>2]|0,Jn(ee)}while(D|0);if(D=C,C=o[C+8>>2]|0,R||Jn(D),C)R=0;else break}}function Yn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0;if(ee=C+8|0,o[ee>>2]|0)return Se=1,Se|0;if(R=o[C>>2]|0,!R)return Se=0,Se|0;D=R,z=0;do z=z+1|0,D=o[D+8>>2]|0;while(D|0);if(z>>>0<2)return Se=0,Se|0;Y=Gn(z<<2)|0,Y||Yi(22807,22646,317,22826),j=Gn(z<<5)|0,j||Yi(22848,22646,321,22826),o[C>>2]=0,r=C+4|0,o[r>>2]=0,o[ee>>2]=0,z=0,B=0,i=0,ii=0;e:for(;;){if(Ct=o[R>>2]|0,Ct){le=0,ae=Ct;do{if(We=+ke[ae+8>>3],D=ae,ae=o[ae+16>>2]|0,yt=(ae|0)==0,ee=yt?Ct:ae,be=+ke[ee+8>>3],+Ai(+(We-be))>3.141592653589793){Se=14;break}le=le+(be-We)*(+ke[D>>3]+ +ke[ee>>3])}while(!yt);if((Se|0)==14){Se=0,le=0,D=Ct;do s=+ke[D+8>>3],T=D+16|0,w=o[T>>2]|0,w=w|0?w:Ct,y=+ke[w+8>>3],le=le+(+ke[D>>3]+ +ke[w>>3])*((y<0?y+6.283185307179586:y)-(s<0?s+6.283185307179586:s)),D=o[(D|0?T:R)>>2]|0;while(D|0)}le>0?(o[Y+(B<<2)>>2]=R,B=B+1|0,ee=i,D=ii):Se=19}else Se=19;if((Se|0)==19){Se=0;do if(z){if(D=z+8|0,o[D>>2]|0){Se=21;break e}if(z=Jo(1,12)|0,!z){Se=23;break e}o[D>>2]=z,ee=z+4|0,ae=z,D=ii}else if(ii){ee=r,ae=ii+8|0,D=R,z=C;break}else if(o[C>>2]|0){Se=27;break e}else{ee=r,ae=C,D=R,z=C;break}while(!1);if(o[ae>>2]=R,o[ee>>2]=R,ae=j+(i<<5)|0,yt=o[R>>2]|0,yt){for(Ct=j+(i<<5)+8|0,ke[Ct>>3]=17976931348623157e292,ii=j+(i<<5)+24|0,ke[ii>>3]=17976931348623157e292,ke[ae>>3]=-17976931348623157e292,Gt=j+(i<<5)+16|0,ke[Gt>>3]=-17976931348623157e292,F=17976931348623157e292,O=-17976931348623157e292,ee=0,jt=yt,We=17976931348623157e292,A=17976931348623157e292,I=-17976931348623157e292,be=-17976931348623157e292;le=+ke[jt>>3],s=+ke[jt+8>>3],jt=o[jt+16>>2]|0,Z=(jt|0)==0,y=+ke[(Z?yt:jt)+8>>3],le<We&&(ke[Ct>>3]=le,We=le),s<A&&(ke[ii>>3]=s,A=s),le>I?ke[ae>>3]=le:le=I,s>be&&(ke[Gt>>3]=s,be=s),F=s>0&s<F?s:F,O=s<0&s>O?s:O,ee=ee|+Ai(+(s-y))>3.141592653589793,!Z;)I=le;ee&&(ke[Gt>>3]=O,ke[ii>>3]=F)}else o[ae>>2]=0,o[ae+4>>2]=0,o[ae+8>>2]=0,o[ae+12>>2]=0,o[ae+16>>2]=0,o[ae+20>>2]=0,o[ae+24>>2]=0,o[ae+28>>2]=0;ee=i+1|0}if(T=R+8|0,R=o[T>>2]|0,o[T>>2]=0,R)i=ee,ii=D;else{Se=45;break}}if((Se|0)==21)Yi(22624,22646,35,22658);else if((Se|0)==23)Yi(22678,22646,37,22658);else if((Se|0)==27)Yi(22721,22646,61,22744);else if((Se|0)==45){e:do if((B|0)>0){for(T=(ee|0)==0,_=ee<<2,w=(C|0)==0,d=0,D=0;;){if(l=o[Y+(d<<2)>>2]|0,T)Se=73;else{if(i=Gn(_)|0,!i){Se=50;break}if(r=Gn(_)|0,!r){Se=52;break}t:do if(w)z=0;else{for(ee=0,z=0,ae=C;R=j+(ee<<5)|0,qs(o[ae>>2]|0,R,o[l>>2]|0)|0?(o[i+(z<<2)>>2]=ae,o[r+(z<<2)>>2]=R,Z=z+1|0):Z=z,ae=o[ae+8>>2]|0,ae;)ee=ee+1|0,z=Z;if((Z|0)>0)if(R=o[i>>2]|0,(Z|0)==1)z=R;else for(Gt=0,jt=-1,z=R,ii=R;;){for(yt=o[ii>>2]|0,R=0,ae=0;ee=o[o[i+(ae<<2)>>2]>>2]|0,(ee|0)==(yt|0)?Ct=R:Ct=R+((qs(ee,o[r+(ae<<2)>>2]|0,o[yt>>2]|0)|0)&1)|0,ae=ae+1|0,(ae|0)!=(Z|0);)R=Ct;if(ee=(Ct|0)>(jt|0),z=ee?ii:z,R=Gt+1|0,(R|0)==(Z|0))break t;Gt=R,jt=ee?Ct:jt,ii=o[i+(R<<2)>>2]|0}else z=0}while(!1);if(Jn(i),Jn(r),z){if(ee=z+4|0,R=o[ee>>2]|0,R)z=R+8|0;else if(o[z>>2]|0){Se=70;break}o[z>>2]=l,o[ee>>2]=l}else Se=73}if((Se|0)==73){if(Se=0,D=o[l>>2]|0,D|0)do r=D,D=o[D+16>>2]|0,Jn(r);while(D|0);Jn(l),D=2}if(d=d+1|0,(d|0)>=(B|0)){ue=D;break e}}(Se|0)==50?Yi(22863,22646,249,22882):(Se|0)==52?Yi(22901,22646,252,22882):(Se|0)==70&&Yi(22721,22646,61,22744)}else ue=0;while(!1);return Jn(Y),Jn(j),Se=ue,Se|0}return 0}function qs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0;if(!(Ua(D,z)|0)||(D=zr(D)|0,yt=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,C=o[C>>2]|0,!C))return C=0,C|0;if(D){D=0,z=C;e:for(;;){for(;ae=+ke[z>>3],We=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],ae>le?(be=ae,ae=We):(be=le,le=ae,ae=ee,ee=We),!!(yt<le|yt>be);)if(z=o[z>>2]|0,!z){z=22;break e}if(We=ee<0?ee+6.283185307179586:ee,ae=ae<0?ae+6.283185307179586:ae,R=ae==R|We==R?R+-2220446049250313e-31:R,We=We+(yt-le)/(be-le)*(ae-We),(We<0?We+6.283185307179586:We)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}else{D=0,z=C;e:for(;;){for(;ae=+ke[z>>3],We=+ke[z+8>>3],z=z+16|0,Ct=o[z>>2]|0,Ct=Ct|0?Ct:C,le=+ke[Ct>>3],ee=+ke[Ct+8>>3],ae>le?(be=ae,ae=We):(be=le,le=ae,ae=ee,ee=We),!!(yt<le|yt>be);)if(z=o[z>>2]|0,!z){z=22;break e}if(R=ae==R|ee==R?R+-2220446049250313e-31:R,ee+(yt-le)/(be-le)*(ae-ee)>R&&(D=D^1),z=o[z>>2]|0,!z){z=22;break}}if((z|0)==22)return D|0}return 0}function Ms(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0;if(O=Vt,Vt=Vt+32|0,F=O+16|0,I=O,le=Mi(C|0,D|0,52)|0,Qt()|0,le=le&15,jt=Mi(z|0,R|0,52)|0,Qt()|0,(le|0)!=(jt&15|0))return F=1,Vt=O,F|0;if(yt=Mi(C|0,D|0,45)|0,Qt()|0,yt=yt&127,Ct=Mi(z|0,R|0,45)|0,Qt()|0,Ct=Ct&127,jt=(yt|0)!=(Ct|0),jt){if(be=An(yt,Ct)|0,(be|0)==7)return F=2,Vt=O,F|0;We=An(Ct,yt)|0,(We|0)==7?Yi(22925,22949,151,22959):(Z=be,ae=We)}else Z=0,ae=0;ii=N(yt)|0,Gt=N(Ct)|0,o[F>>2]=0,o[F+4>>2]=0,o[F+8>>2]=0,o[F+12>>2]=0;do if(Z){if(Ct=o[4304+(yt*28|0)+(Z<<2)>>2]|0,be=(Ct|0)>0,Gt)if(be){yt=0,We=z,be=R;do We=$o(We,be)|0,be=Qt()|0,ae=Ys(ae)|0,(ae|0)==1&&(ae=Ys(1)|0),yt=yt+1|0;while((yt|0)!=(Ct|0));Ct=ae,yt=We,We=be}else Ct=ae,yt=z,We=R;else if(be){yt=0,We=z,be=R;do We=Yr(We,be)|0,be=Qt()|0,ae=Ys(ae)|0,yt=yt+1|0;while((yt|0)!=(Ct|0));Ct=ae,yt=We,We=be}else Ct=ae,yt=z,We=R;if(fo(yt,We,F)|0,jt||Yi(22972,22949,181,22959),be=(ii|0)!=0,ae=(Gt|0)!=0,be&ae&&Yi(22999,22949,182,22959),be){if(ae=Js(C,D)|0,Tt[22032+(ae*7|0)+Z>>0]|0){le=3;break}We=o[21200+(ae*28|0)+(Z<<2)>>2]|0,yt=We,A=26}else if(ae){if(ae=Js(yt,We)|0,Tt[22032+(ae*7|0)+Ct>>0]|0){le=4;break}yt=0,We=o[21200+(Ct*28|0)+(ae<<2)>>2]|0,A=26}else ae=0;if((A|0)==26)if((We|0)<=-1&&Yi(23030,22949,212,22959),(yt|0)<=-1&&Yi(23053,22949,213,22959),(We|0)>0){be=F+4|0,ae=0;do jo(be),ae=ae+1|0;while((ae|0)!=(We|0));ae=yt}else ae=yt;if(o[I>>2]=0,o[I+4>>2]=0,o[I+8>>2]=0,Il(I,Z),le|0)for(;Rr(le)|0?Ho(I):Ls(I),(le|0)>1;)le=le+-1|0;if((ae|0)>0){le=0;do jo(I),le=le+1|0;while((le|0)!=(ae|0))}A=F+4|0,Mr(A,I,A),ir(A),A=50}else if(fo(z,R,F)|0,(ii|0)!=0&(Gt|0)!=0)if((Ct|0)!=(yt|0)&&Yi(23077,22949,243,22959),ae=Js(C,D)|0,le=Js(z,R)|0,Tt[22032+(ae*7|0)+le>>0]|0)le=5;else if(ae=o[21200+(ae*28|0)+(le<<2)>>2]|0,(ae|0)>0){be=F+4|0,le=0;do jo(be),le=le+1|0;while((le|0)!=(ae|0));A=50}else A=50;else A=50;while(!1);return(A|0)==50&&(le=F+4|0,o[ee>>2]=o[le>>2],o[ee+4>>2]=o[le+4>>2],o[ee+8>>2]=o[le+8>>2],le=0),F=le,Vt=O,F|0}function As(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0;if(Z=Vt,Vt=Vt+48|0,ae=Z+36|0,be=Z+24|0,We=Z+12|0,yt=Z,le=Mi(C|0,D|0,52)|0,Qt()|0,le=le&15,Gt=Mi(C|0,D|0,45)|0,Qt()|0,Gt=Gt&127,Ct=N(Gt)|0,zi(le|0,0,52)|0,I=Qt()|0|134225919,A=R,o[A>>2]=-1,o[A+4>>2]=I,!le)return(o[z>>2]|0)>1||(o[z+4>>2]|0)>1||(o[z+8>>2]|0)>1||(ee=un(Gt,Ks(z)|0)|0,(ee|0)==127)?(I=1,Vt=Z,I|0):(jt=zi(ee|0,0,45)|0,A=Qt()|0,Gt=R,A=o[Gt+4>>2]&-1040385|A,I=R,o[I>>2]=o[Gt>>2]|jt,o[I+4>>2]=A,I=0,Vt=Z,I|0);for(o[ae>>2]=o[z>>2],o[ae+4>>2]=o[z+4>>2],o[ae+8>>2]=o[z+8>>2];o[be>>2]=o[ae>>2],o[be+4>>2]=o[ae+4>>2],o[be+8>>2]=o[ae+8>>2],Rr(le)|0?(Pr(ae),o[We>>2]=o[ae>>2],o[We+4>>2]=o[ae+4>>2],o[We+8>>2]=o[ae+8>>2],Ho(We)):(bo(ae),o[We>>2]=o[ae>>2],o[We+4>>2]=o[ae+4>>2],o[We+8>>2]=o[ae+8>>2],Ls(We)),js(be,We,yt),ir(yt),A=R,F=o[A>>2]|0,A=o[A+4>>2]|0,O=(15-le|0)*3|0,z=zi(7,0,O|0)|0,A=A&~(Qt()|0),O=zi(Ks(yt)|0,0,O|0)|0,A=Qt()|0|A,I=R,o[I>>2]=O|F&~z,o[I+4>>2]=A,(le|0)>1;)le=le+-1|0;e:do if((o[ae>>2]|0)<=1&&(o[ae+4>>2]|0)<=1&&(o[ae+8>>2]|0)<=1){le=Ks(ae)|0,be=un(Gt,le)|0,(be|0)==127?yt=0:yt=N(be)|0;t:do if(le){if(Ct){if(ae=21408+((Js(C,D)|0)*28|0)+(le<<2)|0,ae=o[ae>>2]|0,(ae|0)>0){z=0;do le=ca(le)|0,z=z+1|0;while((z|0)!=(ae|0))}if((le|0)==1){ee=3;break e}z=un(Gt,le)|0,(z|0)==127&&Yi(23104,22949,376,23134),N(z)|0?Yi(23147,22949,377,23134):(jt=ae,ii=le,ee=z)}else jt=0,ii=le,ee=be;if(We=o[4304+(Gt*28|0)+(ii<<2)>>2]|0,(We|0)<=-1&&Yi(23178,22949,384,23134),!yt){if((jt|0)<=-1&&Yi(23030,22949,417,23134),jt|0){ae=R,le=0,z=o[ae>>2]|0,ae=o[ae+4>>2]|0;do z=Qa(z,ae)|0,ae=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=ae,le=le+1|0;while((le|0)<(jt|0))}if((We|0)<=0){le=54;break}for(ae=R,le=0,z=o[ae>>2]|0,ae=o[ae+4>>2]|0;;)if(z=Qa(z,ae)|0,ae=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=ae,le=le+1|0,(le|0)==(We|0)){le=54;break t}}if(be=An(ee,Gt)|0,(be|0)==7&&Yi(22925,22949,393,23134),le=R,z=o[le>>2]|0,le=o[le+4>>2]|0,(We|0)>0){ae=0;do z=Qa(z,le)|0,le=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=le,ae=ae+1|0;while((ae|0)!=(We|0))}if(z=Js(z,le)|0,O=xe(ee)|0,z=o[(O?21824:21616)+(be*28|0)+(z<<2)>>2]|0,(z|0)<=-1&&Yi(23030,22949,412,23134),!z)le=54;else{be=R,le=0,ae=o[be>>2]|0,be=o[be+4>>2]|0;do ae=Gs(ae,be)|0,be=Qt()|0,O=R,o[O>>2]=ae,o[O+4>>2]=be,le=le+1|0;while((le|0)<(z|0));le=54}}else if((Ct|0)!=0&(yt|0)!=0)if(O=Js(C,D)|0,le=R,le=21408+(O*28|0)+((Js(o[le>>2]|0,o[le+4>>2]|0)|0)<<2)|0,le=o[le>>2]|0,(le|0)<=-1&&Yi(23201,22949,433,23134),!le)ee=be,le=55;else{ae=R,ee=0,z=o[ae>>2]|0,ae=o[ae+4>>2]|0;do z=Qa(z,ae)|0,ae=Qt()|0,O=R,o[O>>2]=z,o[O+4>>2]=ae,ee=ee+1|0;while((ee|0)<(le|0));ee=be,le=54}else ee=be,le=54;while(!1);if((le|0)==54&&yt&&(le=55),(le|0)==55&&(O=R,(Js(o[O>>2]|0,o[O+4>>2]|0)|0)==1)){ee=4;break}O=R,I=o[O>>2]|0,O=o[O+4>>2]&-1040385,F=zi(ee|0,0,45)|0,O=O|(Qt()|0),ee=R,o[ee>>2]=I|F,o[ee+4>>2]=O,ee=0}else ee=2;while(!1);return O=ee,Vt=Z,O|0}function Xa(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0;return ae=Vt,Vt=Vt+16|0,le=ae,C=Ms(C,D,z,R,le)|0,C||(ml(le,ee),C=0),Vt=ae,C|0}function po(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return ee=Vt,Vt=Vt+16|0,le=ee,Cl(z,le),R=As(C,D,le,R)|0,Vt=ee,R|0}function rs(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0;return ae=Vt,Vt=Vt+32|0,ee=ae+12|0,le=ae,!(Ms(C,D,C,D,ee)|0)&&!(Ms(C,D,z,R,le)|0)?C=Ta(ee,le)|0:C=-1,Vt=ae,C|0}function Qu(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0,ae=0;return ae=Vt,Vt=Vt+32|0,ee=ae+12|0,le=ae,!(Ms(C,D,C,D,ee)|0)&&!(Ms(C,D,z,R,le)|0)?C=Ta(ee,le)|0:C=-1,Vt=ae,(C>>>31^1)+C|0}function zu(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0;if(i=Vt,Vt=Vt+48|0,le=i+24|0,ae=i+12|0,s=i,!(Ms(C,D,C,D,le)|0)&&!(Ms(C,D,z,R,ae)|0)){if(y=Ta(le,ae)|0,(y|0)<0)return s=y,Vt=i,s|0;for(o[le>>2]=0,o[le+4>>2]=0,o[le+8>>2]=0,o[ae>>2]=0,o[ae+4>>2]=0,o[ae+8>>2]=0,Ms(C,D,C,D,le)|0,Ms(C,D,z,R,ae)|0,pu(le),pu(ae),y?(Ct=o[le>>2]|0,jt=+(y|0),I=le+4|0,ii=o[I>>2]|0,F=le+8|0,Gt=o[F>>2]|0,O=le,z=Ct,R=ii,le=Gt,Z=+((o[ae>>2]|0)-Ct|0)/jt,A=+((o[ae+4>>2]|0)-ii|0)/jt,jt=+((o[ae+8>>2]|0)-Gt|0)/jt):(R=le+4|0,Gt=le+8|0,I=R,F=Gt,O=le,z=o[le>>2]|0,R=o[R>>2]|0,le=o[Gt>>2]|0,Z=0,A=0,jt=0),o[s>>2]=z,Gt=s+4|0,o[Gt>>2]=R,ii=s+8|0,o[ii>>2]=le,Ct=0;;){We=+(Ct|0),r=Z*We+ +(z|0),be=A*We+ +(o[I>>2]|0),We=jt*We+ +(o[F>>2]|0),R=~~+yu(+r),ae=~~+yu(+be),z=~~+yu(+We),r=+Ai(+(+(R|0)-r)),be=+Ai(+(+(ae|0)-be)),We=+Ai(+(+(z|0)-We));do if(r>be&r>We)R=0-(ae+z)|0,le=ae;else if(yt=0-R|0,be>We){le=yt-z|0;break}else{le=ae,z=yt-ae|0;break}while(!1);if(o[s>>2]=R,o[Gt>>2]=le,o[ii>>2]=z,us(s),As(C,D,s,ee+(Ct<<3)|0)|0,(Ct|0)==(y|0))break;Ct=Ct+1|0,z=o[O>>2]|0}return s=0,Vt=i,s|0}return s=-1,Vt=i,s|0}function mo(C,D){C=C|0,D=D|0;var z=0;if(!D)return z=1,z|0;z=C,C=1;do C=Hr(D&1|0?z:1,C)|0,D=D>>1,z=Hr(z,z)|0;while(D|0);return C|0}function Ml(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0;if(!(Ua(D,z)|0)||(D=zr(D)|0,Gt=+ke[z>>3],R=+ke[z+8>>3],R=D&R<0?R+6.283185307179586:R,ii=o[C>>2]|0,(ii|0)<=0))return ii=0,ii|0;if(Ct=o[C+4>>2]|0,D){D=0,z=-1,C=0;e:for(;;){for(yt=C;ae=+ke[Ct+(yt<<4)>>3],We=+ke[Ct+(yt<<4)+8>>3],C=(z+2|0)%(ii|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],ae>le?(be=ae,ae=We):(be=le,le=ae,ae=ee,ee=We),!!(Gt<le|Gt>be);)if(z=yt+1|0,(z|0)<(ii|0))C=yt,yt=z,z=C;else{z=22;break e}if(We=ee<0?ee+6.283185307179586:ee,ae=ae<0?ae+6.283185307179586:ae,R=ae==R|We==R?R+-2220446049250313e-31:R,We=We+(Gt-le)/(be-le)*(ae-We),(We<0?We+6.283185307179586:We)>R&&(D=D^1),C=yt+1|0,(C|0)>=(ii|0)){z=22;break}else z=yt}if((z|0)==22)return D|0}else{D=0,z=-1,C=0;e:for(;;){for(yt=C;ae=+ke[Ct+(yt<<4)>>3],We=+ke[Ct+(yt<<4)+8>>3],C=(z+2|0)%(ii|0)|0,le=+ke[Ct+(C<<4)>>3],ee=+ke[Ct+(C<<4)+8>>3],ae>le?(be=ae,ae=We):(be=le,le=ae,ae=ee,ee=We),!!(Gt<le|Gt>be);)if(z=yt+1|0,(z|0)<(ii|0))C=yt,yt=z,z=C;else{z=22;break e}if(R=ae==R|ee==R?R+-2220446049250313e-31:R,ee+(Gt-le)/(be-le)*(ae-ee)>R&&(D=D^1),C=yt+1|0,(C|0)>=(ii|0)){z=22;break}else z=yt}if((z|0)==22)return D|0}return 0}function Pn(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0;if(Z=o[C>>2]|0,!Z){o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;return}if(A=D+8|0,ke[A>>3]=17976931348623157e292,I=D+24|0,ke[I>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,!((Z|0)<=0)){for(Gt=o[C+4>>2]|0,yt=17976931348623157e292,Ct=-17976931348623157e292,ii=0,C=-1,le=17976931348623157e292,ae=17976931348623157e292,We=-17976931348623157e292,R=-17976931348623157e292,jt=0;z=+ke[Gt+(jt<<4)>>3],be=+ke[Gt+(jt<<4)+8>>3],C=C+2|0,ee=+ke[Gt+(((C|0)==(Z|0)?0:C)<<4)+8>>3],z<le&&(ke[A>>3]=z,le=z),be<ae&&(ke[I>>3]=be,ae=be),z>We?ke[D>>3]=z:z=We,be>R&&(ke[F>>3]=be,R=be),yt=be>0&be<yt?be:yt,Ct=be<0&be>Ct?be:Ct,ii=ii|+Ai(+(be-ee))>3.141592653589793,C=jt+1|0,(C|0)!=(Z|0);)O=jt,We=z,jt=C,C=O;ii&&(ke[F>>3]=Ct,ke[I>>3]=yt)}}function Ma(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0,r=0,l=0;if(Z=o[C>>2]|0,Z){if(A=D+8|0,ke[A>>3]=17976931348623157e292,I=D+24|0,ke[I>>3]=17976931348623157e292,ke[D>>3]=-17976931348623157e292,F=D+16|0,ke[F>>3]=-17976931348623157e292,(Z|0)>0){for(ee=o[C+4>>2]|0,Gt=17976931348623157e292,jt=-17976931348623157e292,R=0,z=-1,We=17976931348623157e292,yt=17976931348623157e292,ii=-17976931348623157e292,ae=-17976931348623157e292,O=0;le=+ke[ee+(O<<4)>>3],Ct=+ke[ee+(O<<4)+8>>3],r=z+2|0,be=+ke[ee+(((r|0)==(Z|0)?0:r)<<4)+8>>3],le<We&&(ke[A>>3]=le,We=le),Ct<yt&&(ke[I>>3]=Ct,yt=Ct),le>ii?ke[D>>3]=le:le=ii,Ct>ae&&(ke[F>>3]=Ct,ae=Ct),Gt=Ct>0&Ct<Gt?Ct:Gt,jt=Ct<0&Ct>jt?Ct:jt,R=R|+Ai(+(Ct-be))>3.141592653589793,z=O+1|0,(z|0)!=(Z|0);)r=O,ii=le,O=z,z=r;R&&(ke[F>>3]=jt,ke[I>>3]=Gt)}}else o[D>>2]=0,o[D+4>>2]=0,o[D+8>>2]=0,o[D+12>>2]=0,o[D+16>>2]=0,o[D+20>>2]=0,o[D+24>>2]=0,o[D+28>>2]=0;if(r=C+8|0,z=o[r>>2]|0,!((z|0)<=0)){i=C+12|0,s=0;do if(ee=o[i>>2]|0,R=s,s=s+1|0,I=D+(s<<5)|0,F=o[ee+(R<<3)>>2]|0,F){if(O=D+(s<<5)+8|0,ke[O>>3]=17976931348623157e292,C=D+(s<<5)+24|0,ke[C>>3]=17976931348623157e292,ke[I>>3]=-17976931348623157e292,y=D+(s<<5)+16|0,ke[y>>3]=-17976931348623157e292,(F|0)>0){for(Z=o[ee+(R<<3)+4>>2]|0,Gt=17976931348623157e292,jt=-17976931348623157e292,ee=0,R=-1,A=0,We=17976931348623157e292,yt=17976931348623157e292,Ct=-17976931348623157e292,ae=-17976931348623157e292;le=+ke[Z+(A<<4)>>3],ii=+ke[Z+(A<<4)+8>>3],R=R+2|0,be=+ke[Z+(((R|0)==(F|0)?0:R)<<4)+8>>3],le<We&&(ke[O>>3]=le,We=le),ii<yt&&(ke[C>>3]=ii,yt=ii),le>Ct?ke[I>>3]=le:le=Ct,ii>ae&&(ke[y>>3]=ii,ae=ii),Gt=ii>0&ii<Gt?ii:Gt,jt=ii<0&ii>jt?ii:jt,ee=ee|+Ai(+(ii-be))>3.141592653589793,R=A+1|0,(R|0)!=(F|0);)l=A,A=R,Ct=le,R=l;ee&&(ke[y>>3]=jt,ke[C>>3]=Gt)}}else o[I>>2]=0,o[I+4>>2]=0,o[I+8>>2]=0,o[I+12>>2]=0,o[I+16>>2]=0,o[I+20>>2]=0,o[I+24>>2]=0,o[I+28>>2]=0,z=o[r>>2]|0;while((s|0)<(z|0))}}function bn(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if(!(Ml(C,D,z)|0))return ee=0,ee|0;if(ee=C+8|0,(o[ee>>2]|0)<=0)return ee=1,ee|0;for(R=C+12|0,C=0;;){if(le=C,C=C+1|0,Ml((o[R>>2]|0)+(le<<3)|0,D+(C<<5)|0,z)|0){C=0,R=6;break}if((C|0)>=(o[ee>>2]|0)){C=1,R=6;break}}return(R|0)==6?C|0:0}function Fo(){return 8}function Nl(){return 16}function Sn(){return 168}function Hl(){return 8}function In(){return 16}function _l(){return 12}function lu(){return 8}function Ru(C){C=C|0;var D=0,z=0;return z=+ke[C>>3],D=+ke[C+8>>3],+ +Kt(+(z*z+D*D))}function Vl(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0;yt=+ke[C>>3],We=+ke[D>>3]-yt,be=+ke[C+8>>3],ae=+ke[D+8>>3]-be,ii=+ke[z>>3],le=+ke[R>>3]-ii,Gt=+ke[z+8>>3],Ct=+ke[R+8>>3]-Gt,le=(le*(be-Gt)-(yt-ii)*Ct)/(We*Ct-ae*le),ke[ee>>3]=yt+We*le,ke[ee+8>>3]=be+ae*le}function yl(C,D){return C=C|0,D=D|0,+ke[C>>3]!=+ke[D>>3]?(D=0,D|0):(D=+ke[C+8>>3]==+ke[D+8>>3],D|0)}function ta(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;return ee=+ke[C>>3]-+ke[D>>3],R=+ke[C+8>>3]-+ke[D+8>>3],z=+ke[C+16>>3]-+ke[D+16>>3],+(ee*ee+R*R+z*z)}function ac(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0;z=+ke[C>>3],R=+Ri(+z),z=+vi(+z),ke[D+16>>3]=z,z=+ke[C+8>>3],ee=R*+Ri(+z),ke[D>>3]=ee,z=R*+vi(+z),ke[D+8>>3]=z}function Wu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0;if(yt=Vt,Vt=Vt+32|0,ee=yt+16|0,le=yt,ea(C,D,ee),ae=al(C,D)|0,We=Js(C,D)|0,Wt(ae,le),D=Si(ae,o[ee>>2]|0)|0,!(N(ae)|0))return We=D,Vt=yt,We|0;do switch(ae|0){case 4:{C=0,z=14;break}case 14:{C=1,z=14;break}case 24:{C=2,z=14;break}case 38:{C=3,z=14;break}case 49:{C=4,z=14;break}case 58:{C=5,z=14;break}case 63:{C=6,z=14;break}case 72:{C=7,z=14;break}case 83:{C=8,z=14;break}case 97:{C=9,z=14;break}case 107:{C=10,z=14;break}case 117:{C=11,z=14;break}default:be=0,R=0}while(!1);return(z|0)==14&&(be=o[22096+(C*24|0)+8>>2]|0,R=o[22096+(C*24|0)+16>>2]|0),C=o[ee>>2]|0,(C|0)!=(o[le>>2]|0)&&(ae=xe(ae)|0,C=o[ee>>2]|0,ae|(C|0)==(R|0)&&(D=(D+1|0)%6|0)),(We|0)==3&(C|0)==(R|0)?(We=(D+5|0)%6|0,Vt=yt,We|0):(We|0)==5&(C|0)==(be|0)?(We=(D+1|0)%6|0,Vt=yt,We|0):(We=D,Vt=yt,We|0)}function jl(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;return R=hs(C,D)|0,(z+-1|0)>>>0>5||(ee=(R|0)!=0,(z|0)==1&ee)?(z=-1,z|0):(R=Wu(C,D)|0,ee?(z=(5-R+(o[22384+(z<<2)>>2]|0)|0)%5|0,z|0):(z=(6-R+(o[22416+(z<<2)>>2]|0)|0)%6|0,z|0))}function fs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0;(D|0)>0?(R=Jo(D,4)|0,o[C>>2]=R,R||Yi(23230,23253,40,23267)):o[C>>2]=0,o[C+4>>2]=D,o[C+8>>2]=0,o[C+12>>2]=z}function _a(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0;ee=C+4|0,le=C+12|0,ae=C+8|0;e:for(;;){for(z=o[ee>>2]|0,D=0;;){if((D|0)>=(z|0))break e;if(R=o[C>>2]|0,be=o[R+(D<<2)>>2]|0,!be)D=D+1|0;else break}D=R+(~~(+Ai(+(+oi(10,+ +(15-(o[le>>2]|0)|0))*(+ke[be>>3]+ +ke[be+8>>3])))%+(z|0))>>>0<<2)|0,z=o[D>>2]|0;t:do if(z|0){if(R=be+32|0,(z|0)==(be|0))o[D>>2]=o[R>>2];else{if(z=z+32|0,D=o[z>>2]|0,!D)break;for(;(D|0)!=(be|0);)if(z=D+32|0,D=o[z>>2]|0,!D)break t;o[z>>2]=o[R>>2]}Jn(be),o[ae>>2]=(o[ae>>2]|0)+-1}while(!1)}Jn(o[C>>2]|0)}function Ko(C){C=C|0;var D=0,z=0,R=0;for(R=o[C+4>>2]|0,z=0;;){if((z|0)>=(R|0)){D=0,z=4;break}if(D=o[(o[C>>2]|0)+(z<<2)>>2]|0,!D)z=z+1|0;else{z=4;break}}return(z|0)==4?D|0:0}function gu(C,D){C=C|0,D=D|0;var z=0,R=0,ee=0,le=0;if(z=~~(+Ai(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,z=(o[C>>2]|0)+(z<<2)|0,R=o[z>>2]|0,!R)return le=1,le|0;le=D+32|0;do if((R|0)!=(D|0)){if(z=o[R+32>>2]|0,!z)return le=1,le|0;for(ee=z;;){if((ee|0)==(D|0)){ee=8;break}if(z=o[ee+32>>2]|0,z)R=ee,ee=z;else{z=1,ee=10;break}}if((ee|0)==8){o[R+32>>2]=o[le>>2];break}else if((ee|0)==10)return z|0}else o[z>>2]=o[le>>2];while(!1);return Jn(D),le=C+8|0,o[le>>2]=(o[le>>2]|0)+-1,le=0,le|0}function Fu(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0;le=Gn(40)|0,le||Yi(23283,23253,98,23296),o[le>>2]=o[D>>2],o[le+4>>2]=o[D+4>>2],o[le+8>>2]=o[D+8>>2],o[le+12>>2]=o[D+12>>2],ee=le+16|0,o[ee>>2]=o[z>>2],o[ee+4>>2]=o[z+4>>2],o[ee+8>>2]=o[z+8>>2],o[ee+12>>2]=o[z+12>>2],o[le+32>>2]=0,ee=~~(+Ai(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=(o[C>>2]|0)+(ee<<2)|0,R=o[ee>>2]|0;do if(!R)o[ee>>2]=le;else{for(;!(ba(R,D)|0&&ba(R+16|0,z)|0);)if(ee=o[R+32>>2]|0,R=ee|0?ee:R,!(o[R+32>>2]|0)){ae=10;break}if((ae|0)==10){o[R+32>>2]=le;break}return Jn(le),ae=R,ae|0}while(!1);return ae=C+8|0,o[ae>>2]=(o[ae>>2]|0)+1,ae=le,ae|0}function uu(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0;if(ee=~~(+Ai(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,ee=o[(o[C>>2]|0)+(ee<<2)>>2]|0,!ee)return z=0,z|0;if(!z){for(C=ee;;){if(ba(C,D)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}if((R|0)==10)return C|0}for(C=ee;;){if(ba(C,D)|0&&ba(C+16|0,z)|0){R=10;break}if(C=o[C+32>>2]|0,!C){C=0,R=10;break}}return(R|0)==10?C|0:0}function Ou(C,D){C=C|0,D=D|0;var z=0;if(z=~~(+Ai(+(+oi(10,+ +(15-(o[C+12>>2]|0)|0))*(+ke[D>>3]+ +ke[D+8>>3])))%+(o[C+4>>2]|0))>>>0,C=o[(o[C>>2]|0)+(z<<2)>>2]|0,!C)return z=0,z|0;for(;;){if(ba(C,D)|0){D=5;break}if(C=o[C+32>>2]|0,!C){C=0,D=5;break}}return(D|0)==5?C|0:0}function _r(){return 23312}function ds(C){return C=+C,+ +ul(+C)}function pn(C){return C=+C,~~+ds(C)|0}function Gn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0,A=0,I=0,F=0,O=0,y=0,s=0,i=0;i=Vt,Vt=Vt+16|0,Gt=i;do if(C>>>0<245){if(yt=C>>>0<11?16:C+11&-8,C=yt>>>3,ii=o[5829]|0,z=ii>>>C,z&3|0)return D=(z&1^1)+C|0,C=23356+(D<<1<<2)|0,z=C+8|0,R=o[z>>2]|0,ee=R+8|0,le=o[ee>>2]|0,(le|0)==(C|0)?o[5829]=ii&~(1<<D):(o[le+12>>2]=C,o[z>>2]=le),s=D<<3,o[R+4>>2]=s|3,s=R+s+4|0,o[s>>2]=o[s>>2]|1,s=ee,Vt=i,s|0;if(Ct=o[5831]|0,yt>>>0>Ct>>>0){if(z|0)return D=2<<C,D=z<<C&(D|0-D),D=(D&0-D)+-1|0,be=D>>>12&16,D=D>>>be,z=D>>>5&8,D=D>>>z,le=D>>>2&4,D=D>>>le,C=D>>>1&2,D=D>>>C,R=D>>>1&1,R=(z|be|le|C|R)+(D>>>R)|0,D=23356+(R<<1<<2)|0,C=D+8|0,le=o[C>>2]|0,be=le+8|0,z=o[be>>2]|0,(z|0)==(D|0)?(C=ii&~(1<<R),o[5829]=C):(o[z+12>>2]=D,o[C>>2]=z,C=ii),s=R<<3,ae=s-yt|0,o[le+4>>2]=yt|3,ee=le+yt|0,o[ee+4>>2]=ae|1,o[le+s>>2]=ae,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=ae,o[5834]=ee,s=be,Vt=i,s|0;if(le=o[5830]|0,le){for(z=(le&0-le)+-1|0,ee=z>>>12&16,z=z>>>ee,R=z>>>5&8,z=z>>>R,ae=z>>>2&4,z=z>>>ae,be=z>>>1&2,z=z>>>be,We=z>>>1&1,We=o[23620+((R|ee|ae|be|We)+(z>>>We)<<2)>>2]|0,z=We,be=We,We=(o[We+4>>2]&-8)-yt|0;C=o[z+16>>2]|0,!(!C&&(C=o[z+20>>2]|0,!C));)ae=(o[C+4>>2]&-8)-yt|0,ee=ae>>>0<We>>>0,z=C,be=ee?C:be,We=ee?ae:We;if(ae=be+yt|0,ae>>>0>be>>>0){ee=o[be+24>>2]|0,D=o[be+12>>2]|0;do if((D|0)==(be|0)){if(C=be+20|0,D=o[C>>2]|0,!D&&(C=be+16|0,D=o[C>>2]|0,!D)){z=0;break}for(;;)if(R=D+20|0,z=o[R>>2]|0,z)D=z,C=R;else if(R=D+16|0,z=o[R>>2]|0,z)D=z,C=R;else break;o[C>>2]=0,z=D}else z=o[be+8>>2]|0,o[z+12>>2]=D,o[D+8>>2]=z,z=D;while(!1);do if(ee|0){if(D=o[be+28>>2]|0,C=23620+(D<<2)|0,(be|0)==(o[C>>2]|0)){if(o[C>>2]=z,!z){o[5830]=le&~(1<<D);break}}else if(s=ee+16|0,o[((o[s>>2]|0)==(be|0)?s:ee+20|0)>>2]=z,!z)break;o[z+24>>2]=ee,D=o[be+16>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),D=o[be+20>>2]|0,D|0&&(o[z+20>>2]=D,o[D+24>>2]=z)}while(!1);return We>>>0<16?(s=We+yt|0,o[be+4>>2]=s|3,s=be+s+4|0,o[s>>2]=o[s>>2]|1):(o[be+4>>2]=yt|3,o[ae+4>>2]=We|1,o[ae+We>>2]=We,Ct|0&&(R=o[5834]|0,D=Ct>>>3,z=23356+(D<<1<<2)|0,D=1<<D,D&ii?(C=z+8|0,D=o[C>>2]|0):(o[5829]=D|ii,D=z,C=z+8|0),o[C>>2]=R,o[D+12>>2]=R,o[R+8>>2]=D,o[R+12>>2]=z),o[5831]=We,o[5834]=ae),s=be+8|0,Vt=i,s|0}else ii=yt}else ii=yt}else ii=yt}else if(C>>>0<=4294967231)if(C=C+11|0,yt=C&-8,R=o[5830]|0,R){ee=0-yt|0,C=C>>>8,C?yt>>>0>16777215?We=31:(ii=(C+1048320|0)>>>16&8,A=C<<ii,be=(A+520192|0)>>>16&4,A=A<<be,We=(A+245760|0)>>>16&2,We=14-(be|ii|We)+(A<<We>>>15)|0,We=yt>>>(We+7|0)&1|We<<1):We=0,z=o[23620+(We<<2)>>2]|0;e:do if(!z)z=0,C=0,A=61;else for(C=0,be=yt<<((We|0)==31?0:25-(We>>>1)|0),le=0;;){if(ae=(o[z+4>>2]&-8)-yt|0,ae>>>0<ee>>>0)if(ae)C=z,ee=ae;else{C=z,ee=0,A=65;break e}if(A=o[z+20>>2]|0,z=o[z+16+(be>>>31<<2)>>2]|0,le=(A|0)==0|(A|0)==(z|0)?le:A,z)be=be<<1;else{z=le,A=61;break}}while(!1);if((A|0)==61){if((z|0)==0&(C|0)==0){if(C=2<<We,C=(C|0-C)&R,!C){ii=yt;break}ii=(C&0-C)+-1|0,ae=ii>>>12&16,ii=ii>>>ae,le=ii>>>5&8,ii=ii>>>le,be=ii>>>2&4,ii=ii>>>be,We=ii>>>1&2,ii=ii>>>We,z=ii>>>1&1,C=0,z=o[23620+((le|ae|be|We|z)+(ii>>>z)<<2)>>2]|0}z?A=65:(be=C,ae=ee)}if((A|0)==65)for(le=z;;)if(ii=(o[le+4>>2]&-8)-yt|0,z=ii>>>0<ee>>>0,ee=z?ii:ee,C=z?le:C,z=o[le+16>>2]|0,z||(z=o[le+20>>2]|0),z)le=z;else{be=C,ae=ee;break}if(be|0&&ae>>>0<((o[5831]|0)-yt|0)>>>0&&(Ct=be+yt|0,Ct>>>0>be>>>0)){le=o[be+24>>2]|0,D=o[be+12>>2]|0;do if((D|0)==(be|0)){if(C=be+20|0,D=o[C>>2]|0,!D&&(C=be+16|0,D=o[C>>2]|0,!D)){D=0;break}for(;;)if(ee=D+20|0,z=o[ee>>2]|0,z)D=z,C=ee;else if(ee=D+16|0,z=o[ee>>2]|0,z)D=z,C=ee;else break;o[C>>2]=0}else s=o[be+8>>2]|0,o[s+12>>2]=D,o[D+8>>2]=s;while(!1);do if(le){if(C=o[be+28>>2]|0,z=23620+(C<<2)|0,(be|0)==(o[z>>2]|0)){if(o[z>>2]=D,!D){R=R&~(1<<C),o[5830]=R;break}}else if(s=le+16|0,o[((o[s>>2]|0)==(be|0)?s:le+20|0)>>2]=D,!D)break;o[D+24>>2]=le,C=o[be+16>>2]|0,C|0&&(o[D+16>>2]=C,o[C+24>>2]=D),C=o[be+20>>2]|0,C&&(o[D+20>>2]=C,o[C+24>>2]=D)}while(!1);e:do if(ae>>>0<16)s=ae+yt|0,o[be+4>>2]=s|3,s=be+s+4|0,o[s>>2]=o[s>>2]|1;else{if(o[be+4>>2]=yt|3,o[Ct+4>>2]=ae|1,o[Ct+ae>>2]=ae,D=ae>>>3,ae>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=Ct,o[D+12>>2]=Ct,o[Ct+8>>2]=D,o[Ct+12>>2]=z;break}if(D=ae>>>8,D?ae>>>0>16777215?z=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,z=(s+245760|0)>>>16&2,z=14-(O|y|z)+(s<<z>>>15)|0,z=ae>>>(z+7|0)&1|z<<1):z=0,D=23620+(z<<2)|0,o[Ct+28>>2]=z,C=Ct+16|0,o[C+4>>2]=0,o[C>>2]=0,C=1<<z,!(R&C)){o[5830]=R|C,o[D>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break}D=o[D>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(ae|0)){for(R=ae<<((z|0)==31?0:25-(z>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(ae|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=Ct,o[Ct+24>>2]=D,o[Ct+12>>2]=Ct,o[Ct+8>>2]=Ct;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=Ct,o[y>>2]=Ct,o[Ct+8>>2]=s,o[Ct+12>>2]=D,o[Ct+24>>2]=0}while(!1);return s=be+8|0,Vt=i,s|0}else ii=yt}else ii=yt;else ii=-1;while(!1);if(z=o[5831]|0,z>>>0>=ii>>>0)return D=z-ii|0,C=o[5834]|0,D>>>0>15?(s=C+ii|0,o[5834]=s,o[5831]=D,o[s+4>>2]=D|1,o[C+z>>2]=D,o[C+4>>2]=ii|3):(o[5831]=0,o[5834]=0,o[C+4>>2]=z|3,s=C+z+4|0,o[s>>2]=o[s>>2]|1),s=C+8|0,Vt=i,s|0;if(ae=o[5832]|0,ae>>>0>ii>>>0)return O=ae-ii|0,o[5832]=O,s=o[5835]|0,y=s+ii|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ii|3,s=s+8|0,Vt=i,s|0;if(o[5947]|0?C=o[5949]|0:(o[5949]=4096,o[5948]=4096,o[5950]=-1,o[5951]=-1,o[5952]=0,o[5940]=0,o[5947]=Gt&-16^1431655768,C=4096),be=ii+48|0,We=ii+47|0,le=C+We|0,ee=0-C|0,yt=le&ee,yt>>>0<=ii>>>0||(C=o[5939]|0,C|0&&(Ct=o[5937]|0,Gt=Ct+yt|0,Gt>>>0<=Ct>>>0|Gt>>>0>C>>>0)))return s=0,Vt=i,s|0;e:do if(o[5940]&4)D=0,A=143;else{z=o[5835]|0;t:do if(z){for(R=23764;Gt=o[R>>2]|0,!(Gt>>>0<=z>>>0&&(Gt+(o[R+4>>2]|0)|0)>>>0>z>>>0);)if(C=o[R+8>>2]|0,C)R=C;else{A=128;break t}if(D=le-ae&ee,D>>>0<2147483647)if(C=Ps(D|0)|0,(C|0)==((o[R>>2]|0)+(o[R+4>>2]|0)|0)){if((C|0)!=-1){ae=D,le=C,A=145;break e}}else R=C,A=136;else D=0}else A=128;while(!1);do if((A|0)==128)if(z=Ps(0)|0,(z|0)!=-1&&(D=z,jt=o[5948]|0,Z=jt+-1|0,D=(Z&D|0?(Z+D&0-jt)-D|0:0)+yt|0,jt=o[5937]|0,Z=D+jt|0,D>>>0>ii>>>0&D>>>0<2147483647)){if(Gt=o[5939]|0,Gt|0&&Z>>>0<=jt>>>0|Z>>>0>Gt>>>0){D=0;break}if(C=Ps(D|0)|0,(C|0)==(z|0)){ae=D,le=z,A=145;break e}else R=C,A=136}else D=0;while(!1);do if((A|0)==136){if(z=0-D|0,!(be>>>0>D>>>0&(D>>>0<2147483647&(R|0)!=-1)))if((R|0)==-1){D=0;break}else{ae=D,le=R,A=145;break e}if(C=o[5949]|0,C=We-D+C&0-C,C>>>0>=2147483647){ae=D,le=R,A=145;break e}if((Ps(C|0)|0)==-1){Ps(z|0)|0,D=0;break}else{ae=C+D|0,le=R,A=145;break e}}while(!1);o[5940]=o[5940]|4,A=143}while(!1);if((A|0)==143&&yt>>>0<2147483647&&(O=Ps(yt|0)|0,Z=Ps(0)|0,I=Z-O|0,F=I>>>0>(ii+40|0)>>>0,!((O|0)==-1|F^1|O>>>0<Z>>>0&((O|0)!=-1&(Z|0)!=-1)^1))&&(ae=F?I:D,le=O,A=145),(A|0)==145){D=(o[5937]|0)+ae|0,o[5937]=D,D>>>0>(o[5938]|0)>>>0&&(o[5938]=D),We=o[5835]|0;e:do if(We){for(D=23764;;){if(C=o[D>>2]|0,z=o[D+4>>2]|0,(le|0)==(C+z|0)){A=154;break}if(R=o[D+8>>2]|0,R)D=R;else break}if((A|0)==154&&(y=D+4|0,(o[D+12>>2]&8|0)==0)&&le>>>0>We>>>0&C>>>0<=We>>>0){o[y>>2]=z+ae,s=(o[5832]|0)+ae|0,O=We+8|0,O=O&7|0?0-O&7:0,y=We+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[We+s+4>>2]=40,o[5836]=o[5951];break}for(le>>>0<(o[5833]|0)>>>0&&(o[5833]=le),z=le+ae|0,D=23764;;){if((o[D>>2]|0)==(z|0)){A=162;break}if(C=o[D+8>>2]|0,C)D=C;else break}if((A|0)==162&&!(o[D+12>>2]&8|0)){o[D>>2]=le,Ct=D+4|0,o[Ct>>2]=(o[Ct>>2]|0)+ae,Ct=le+8|0,Ct=le+(Ct&7|0?0-Ct&7:0)|0,D=z+8|0,D=z+(D&7|0?0-D&7:0)|0,yt=Ct+ii|0,be=D-Ct-ii|0,o[Ct+4>>2]=ii|3;t:do if((We|0)==(D|0))s=(o[5832]|0)+be|0,o[5832]=s,o[5835]=yt,o[yt+4>>2]=s|1;else{if((o[5834]|0)==(D|0)){s=(o[5831]|0)+be|0,o[5831]=s,o[5834]=yt,o[yt+4>>2]=s|1,o[yt+s>>2]=s;break}if(C=o[D+4>>2]|0,(C&3|0)==1){ae=C&-8,R=C>>>3;i:do if(C>>>0<256)if(C=o[D+8>>2]|0,z=o[D+12>>2]|0,(z|0)==(C|0)){o[5829]=o[5829]&~(1<<R);break}else{o[C+12>>2]=z,o[z+8>>2]=C;break}else{le=o[D+24>>2]|0,C=o[D+12>>2]|0;do if((C|0)==(D|0)){if(z=D+16|0,R=z+4|0,C=o[R>>2]|0,C)z=R;else if(C=o[z>>2]|0,!C){C=0;break}for(;;)if(ee=C+20|0,R=o[ee>>2]|0,R)C=R,z=ee;else if(ee=C+16|0,R=o[ee>>2]|0,R)C=R,z=ee;else break;o[z>>2]=0}else s=o[D+8>>2]|0,o[s+12>>2]=C,o[C+8>>2]=s;while(!1);if(!le)break;z=o[D+28>>2]|0,R=23620+(z<<2)|0;do if((o[R>>2]|0)!=(D|0)){if(s=le+16|0,o[((o[s>>2]|0)==(D|0)?s:le+20|0)>>2]=C,!C)break i}else{if(o[R>>2]=C,C|0)break;o[5830]=o[5830]&~(1<<z);break i}while(!1);if(o[C+24>>2]=le,z=D+16|0,R=o[z>>2]|0,R|0&&(o[C+16>>2]=R,o[R+24>>2]=C),z=o[z+4>>2]|0,!z)break;o[C+20>>2]=z,o[z+24>>2]=C}while(!1);D=D+ae|0,ee=ae+be|0}else ee=be;if(D=D+4|0,o[D>>2]=o[D>>2]&-2,o[yt+4>>2]=ee|1,o[yt+ee>>2]=ee,D=ee>>>3,ee>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=yt,o[D+12>>2]=yt,o[yt+8>>2]=D,o[yt+12>>2]=z;break}D=ee>>>8;do if(!D)R=0;else{if(ee>>>0>16777215){R=31;break}y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1}while(!1);if(D=23620+(R<<2)|0,o[yt+28>>2]=R,C=yt+16|0,o[C+4>>2]=0,o[C>>2]=0,C=o[5830]|0,z=1<<R,!(C&z)){o[5830]=C|z,o[D>>2]=yt,o[yt+24>>2]=D,o[yt+12>>2]=yt,o[yt+8>>2]=yt;break}D=o[D>>2]|0;i:do if((o[D+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(ee|0)){D=C;break i}else R=R<<1,D=C;o[z>>2]=yt,o[yt+24>>2]=D,o[yt+12>>2]=yt,o[yt+8>>2]=yt;break t}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=yt,o[y>>2]=yt,o[yt+8>>2]=s,o[yt+12>>2]=D,o[yt+24>>2]=0}while(!1);return s=Ct+8|0,Vt=i,s|0}for(D=23764;C=o[D>>2]|0,!(C>>>0<=We>>>0&&(s=C+(o[D+4>>2]|0)|0,s>>>0>We>>>0));)D=o[D+8>>2]|0;ee=s+-47|0,C=ee+8|0,C=ee+(C&7|0?0-C&7:0)|0,ee=We+16|0,C=C>>>0<ee>>>0?We:C,D=C+8|0,z=ae+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=z-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+z+4>>2]=40,o[5836]=o[5951],z=C+4|0,o[z>>2]=27,o[D>>2]=o[5941],o[D+4>>2]=o[5942],o[D+8>>2]=o[5943],o[D+12>>2]=o[5944],o[5941]=le,o[5942]=ae,o[5944]=0,o[5943]=D,D=C+24|0;do y=D,D=D+4|0,o[D>>2]=7;while((y+8|0)>>>0<s>>>0);if((C|0)!=(We|0)){if(le=C-We|0,o[z>>2]=o[z>>2]&-2,o[We+4>>2]=le|1,o[C>>2]=le,D=le>>>3,le>>>0<256){z=23356+(D<<1<<2)|0,C=o[5829]|0,D=1<<D,C&D?(C=z+8|0,D=o[C>>2]|0):(o[5829]=C|D,D=z,C=z+8|0),o[C>>2]=We,o[D+12>>2]=We,o[We+8>>2]=D,o[We+12>>2]=z;break}if(D=le>>>8,D?le>>>0>16777215?R=31:(y=(D+1048320|0)>>>16&8,s=D<<y,O=(s+520192|0)>>>16&4,s=s<<O,R=(s+245760|0)>>>16&2,R=14-(O|y|R)+(s<<R>>>15)|0,R=le>>>(R+7|0)&1|R<<1):R=0,z=23620+(R<<2)|0,o[We+28>>2]=R,o[We+20>>2]=0,o[ee>>2]=0,D=o[5830]|0,C=1<<R,!(D&C)){o[5830]=D|C,o[z>>2]=We,o[We+24>>2]=z,o[We+12>>2]=We,o[We+8>>2]=We;break}D=o[z>>2]|0;t:do if((o[D+4>>2]&-8|0)!=(le|0)){for(R=le<<((R|0)==31?0:25-(R>>>1)|0);z=D+16+(R>>>31<<2)|0,C=o[z>>2]|0,!!C;)if((o[C+4>>2]&-8|0)==(le|0)){D=C;break t}else R=R<<1,D=C;o[z>>2]=We,o[We+24>>2]=D,o[We+12>>2]=We,o[We+8>>2]=We;break e}while(!1);y=D+8|0,s=o[y>>2]|0,o[s+12>>2]=We,o[y>>2]=We,o[We+8>>2]=s,o[We+12>>2]=D,o[We+24>>2]=0}}else s=o[5833]|0,(s|0)==0|le>>>0<s>>>0&&(o[5833]=le),o[5941]=le,o[5942]=ae,o[5944]=0,o[5838]=o[5947],o[5837]=-1,o[5842]=23356,o[5841]=23356,o[5844]=23364,o[5843]=23364,o[5846]=23372,o[5845]=23372,o[5848]=23380,o[5847]=23380,o[5850]=23388,o[5849]=23388,o[5852]=23396,o[5851]=23396,o[5854]=23404,o[5853]=23404,o[5856]=23412,o[5855]=23412,o[5858]=23420,o[5857]=23420,o[5860]=23428,o[5859]=23428,o[5862]=23436,o[5861]=23436,o[5864]=23444,o[5863]=23444,o[5866]=23452,o[5865]=23452,o[5868]=23460,o[5867]=23460,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,s=ae+-40|0,O=le+8|0,O=O&7|0?0-O&7:0,y=le+O|0,O=s-O|0,o[5835]=y,o[5832]=O,o[y+4>>2]=O|1,o[le+s+4>>2]=40,o[5836]=o[5951];while(!1);if(D=o[5832]|0,D>>>0>ii>>>0)return O=D-ii|0,o[5832]=O,s=o[5835]|0,y=s+ii|0,o[5835]=y,o[y+4>>2]=O|1,o[s+4>>2]=ii|3,s=s+8|0,Vt=i,s|0}return s=_r()|0,o[s>>2]=12,s=0,Vt=i,s|0}function Jn(C){C=C|0;var D=0,z=0,R=0,ee=0,le=0,ae=0,be=0,We=0;if(C){z=C+-8|0,ee=o[5833]|0,C=o[C+-4>>2]|0,D=C&-8,We=z+D|0;do if(C&1)be=z,ae=z;else{if(R=o[z>>2]|0,!(C&3)||(ae=z+(0-R)|0,le=R+D|0,ae>>>0<ee>>>0))return;if((o[5834]|0)==(ae|0)){if(C=We+4|0,D=o[C>>2]|0,(D&3|0)!=3){be=ae,D=le;break}o[5831]=le,o[C>>2]=D&-2,o[ae+4>>2]=le|1,o[ae+le>>2]=le;return}if(z=R>>>3,R>>>0<256)if(C=o[ae+8>>2]|0,D=o[ae+12>>2]|0,(D|0)==(C|0)){o[5829]=o[5829]&~(1<<z),be=ae,D=le;break}else{o[C+12>>2]=D,o[D+8>>2]=C,be=ae,D=le;break}ee=o[ae+24>>2]|0,C=o[ae+12>>2]|0;do if((C|0)==(ae|0)){if(D=ae+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){C=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0}else be=o[ae+8>>2]|0,o[be+12>>2]=C,o[C+8>>2]=be;while(!1);if(ee){if(D=o[ae+28>>2]|0,z=23620+(D<<2)|0,(o[z>>2]|0)==(ae|0)){if(o[z>>2]=C,!C){o[5830]=o[5830]&~(1<<D),be=ae,D=le;break}}else if(be=ee+16|0,o[((o[be>>2]|0)==(ae|0)?be:ee+20|0)>>2]=C,!C){be=ae,D=le;break}o[C+24>>2]=ee,D=ae+16|0,z=o[D>>2]|0,z|0&&(o[C+16>>2]=z,o[z+24>>2]=C),D=o[D+4>>2]|0,D?(o[C+20>>2]=D,o[D+24>>2]=C,be=ae,D=le):(be=ae,D=le)}else be=ae,D=le}while(!1);if(!(ae>>>0>=We>>>0)&&(C=We+4|0,R=o[C>>2]|0,!!(R&1))){if(R&2)o[C>>2]=R&-2,o[be+4>>2]=D|1,o[ae+D>>2]=D,ee=D;else{if((o[5835]|0)==(We|0)){if(We=(o[5832]|0)+D|0,o[5832]=We,o[5835]=be,o[be+4>>2]=We|1,(be|0)!=(o[5834]|0))return;o[5834]=0,o[5831]=0;return}if((o[5834]|0)==(We|0)){We=(o[5831]|0)+D|0,o[5831]=We,o[5834]=ae,o[be+4>>2]=We|1,o[ae+We>>2]=We;return}ee=(R&-8)+D|0,z=R>>>3;do if(R>>>0<256)if(D=o[We+8>>2]|0,C=o[We+12>>2]|0,(C|0)==(D|0)){o[5829]=o[5829]&~(1<<z);break}else{o[D+12>>2]=C,o[C+8>>2]=D;break}else{le=o[We+24>>2]|0,C=o[We+12>>2]|0;do if((C|0)==(We|0)){if(D=We+16|0,z=D+4|0,C=o[z>>2]|0,C)D=z;else if(C=o[D>>2]|0,!C){z=0;break}for(;;)if(R=C+20|0,z=o[R>>2]|0,z)C=z,D=R;else if(R=C+16|0,z=o[R>>2]|0,z)C=z,D=R;else break;o[D>>2]=0,z=C}else z=o[We+8>>2]|0,o[z+12>>2]=C,o[C+8>>2]=z,z=C;while(!1);if(le|0){if(C=o[We+28>>2]|0,D=23620+(C<<2)|0,(o[D>>2]|0)==(We|0)){if(o[D>>2]=z,!z){o[5830]=o[5830]&~(1<<C);break}}else if(R=le+16|0,o[((o[R>>2]|0)==(We|0)?R:le+20|0)>>2]=z,!z)break;o[z+24>>2]=le,C=We+16|0,D=o[C>>2]|0,D|0&&(o[z+16>>2]=D,o[D+24>>2]=z),C=o[C+4>>2]|0,C|0&&(o[z+20>>2]=C,o[C+24>>2]=z)}}while(!1);if(o[be+4>>2]=ee|1,o[ae+ee>>2]=ee,(be|0)==(o[5834]|0)){o[5831]=ee;return}}if(C=ee>>>3,ee>>>0<256){z=23356+(C<<1<<2)|0,D=o[5829]|0,C=1<<C,D&C?(D=z+8|0,C=o[D>>2]|0):(o[5829]=D|C,C=z,D=z+8|0),o[D>>2]=be,o[C+12>>2]=be,o[be+8>>2]=C,o[be+12>>2]=z;return}C=ee>>>8,C?ee>>>0>16777215?R=31:(ae=(C+1048320|0)>>>16&8,We=C<<ae,le=(We+520192|0)>>>16&4,We=We<<le,R=(We+245760|0)>>>16&2,R=14-(le|ae|R)+(We<<R>>>15)|0,R=ee>>>(R+7|0)&1|R<<1):R=0,C=23620+(R<<2)|0,o[be+28>>2]=R,o[be+20>>2]=0,o[be+16>>2]=0,D=o[5830]|0,z=1<<R;e:do if(!(D&z))o[5830]=D|z,o[C>>2]=be,o[be+24>>2]=C,o[be+12>>2]=be,o[be+8>>2]=be;else{C=o[C>>2]|0;t:do if((o[C+4>>2]&-8|0)!=(ee|0)){for(R=ee<<((R|0)==31?0:25-(R>>>1)|0);z=C+16+(R>>>31<<2)|0,D=o[z>>2]|0,!!D;)if((o[D+4>>2]&-8|0)==(ee|0)){C=D;break t}else R=R<<1,C=D;o[z>>2]=be,o[be+24>>2]=C,o[be+12>>2]=be,o[be+8>>2]=be;break e}while(!1);ae=C+8|0,We=o[ae>>2]|0,o[We+12>>2]=be,o[ae>>2]=be,o[be+8>>2]=We,o[be+12>>2]=C,o[be+24>>2]=0}while(!1);if(We=(o[5837]|0)+-1|0,o[5837]=We,!(We|0)){for(C=23772;C=o[C>>2]|0,C;)C=C+8|0;o[5837]=-1}}}}function Jo(C,D){C=C|0,D=D|0;var z=0;return C?(z=Hr(D,C)|0,(D|C)>>>0>65535&&(z=((z>>>0)/(C>>>0)|0|0)==(D|0)?z:-1)):z=0,C=Gn(z)|0,!C||!(o[C+-4>>2]&3)||cs(C|0,0,z|0)|0,C|0}function Cu(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,z=C+z>>>0,Fn(D+R+(z>>>0<C>>>0|0)>>>0|0),z|0|0}function oa(C,D,z,R){return C=C|0,D=D|0,z=z|0,R=R|0,R=D-R-(z>>>0>C>>>0|0)>>>0,Fn(R|0),C-z>>>0|0|0}function _u(C){return C=C|0,(C?31-(lr(C^C-1)|0)|0:32)|0}function _s(C,D,z,R,ee){C=C|0,D=D|0,z=z|0,R=R|0,ee=ee|0;var le=0,ae=0,be=0,We=0,yt=0,Ct=0,ii=0,Gt=0,jt=0,Z=0;if(Ct=C,We=D,yt=We,ae=z,Gt=R,be=Gt,!yt)return le=(ee|0)!=0,be?le?(o[ee>>2]=C|0,o[ee+4>>2]=D&0,Gt=0,ee=0,Fn(Gt|0),ee|0):(Gt=0,ee=0,Fn(Gt|0),ee|0):(le&&(o[ee>>2]=(Ct>>>0)%(ae>>>0),o[ee+4>>2]=0),Gt=0,ee=(Ct>>>0)/(ae>>>0)>>>0,Fn(Gt|0),ee|0);le=(be|0)==0;do if(ae){if(!le){if(le=(lr(be|0)|0)-(lr(yt|0)|0)|0,le>>>0<=31){ii=le+1|0,be=31-le|0,D=le-31>>31,ae=ii,C=Ct>>>(ii>>>0)&D|yt<<be,D=yt>>>(ii>>>0)&D,le=0,be=Ct<<be;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=We|D&0,Gt=0,ee=0,Fn(Gt|0),ee|0):(Gt=0,ee=0,Fn(Gt|0),ee|0)}if(le=ae-1|0,le&ae|0){be=(lr(ae|0)|0)+33-(lr(yt|0)|0)|0,Z=64-be|0,ii=32-be|0,We=ii>>31,jt=be-32|0,D=jt>>31,ae=be,C=ii-1>>31&yt>>>(jt>>>0)|(yt<<ii|Ct>>>(be>>>0))&D,D=D&yt>>>(be>>>0),le=Ct<<Z&We,be=(yt<<Z|Ct>>>(jt>>>0))&We|Ct<<ii&be-33>>31;break}return ee|0&&(o[ee>>2]=le&Ct,o[ee+4>>2]=0),(ae|0)==1?(jt=We|D&0,Z=C|0|0,Fn(jt|0),Z|0):(Z=_u(ae|0)|0,jt=yt>>>(Z>>>0)|0,Z=yt<<32-Z|Ct>>>(Z>>>0)|0,Fn(jt|0),Z|0)}else{if(le)return ee|0&&(o[ee>>2]=(yt>>>0)%(ae>>>0),o[ee+4>>2]=0),jt=0,Z=(yt>>>0)/(ae>>>0)>>>0,Fn(jt|0),Z|0;if(!Ct)return ee|0&&(o[ee>>2]=0,o[ee+4>>2]=(yt>>>0)%(be>>>0)),jt=0,Z=(yt>>>0)/(be>>>0)>>>0,Fn(jt|0),Z|0;if(le=be-1|0,!(le&be))return ee|0&&(o[ee>>2]=C|0,o[ee+4>>2]=le&yt|D&0),jt=0,Z=yt>>>((_u(be|0)|0)>>>0),Fn(jt|0),Z|0;if(le=(lr(be|0)|0)-(lr(yt|0)|0)|0,le>>>0<=30){D=le+1|0,be=31-le|0,ae=D,C=yt<<be|Ct>>>(D>>>0),D=yt>>>(D>>>0),le=0,be=Ct<<be;break}return ee?(o[ee>>2]=C|0,o[ee+4>>2]=We|D&0,jt=0,Z=0,Fn(jt|0),Z|0):(jt=0,Z=0,Fn(jt|0),Z|0)}while(!1);if(!ae)yt=be,We=0,be=0;else{ii=z|0|0,Ct=Gt|R&0,yt=Cu(ii|0,Ct|0,-1,-1)|0,z=Qt()|0,We=be,be=0;do R=We,We=le>>>31|We<<1,le=be|le<<1,R=C<<1|R>>>31|0,Gt=C>>>31|D<<1|0,oa(yt|0,z|0,R|0,Gt|0)|0,Z=Qt()|0,jt=Z>>31|((Z|0)<0?-1:0)<<1,be=jt&1,C=oa(R|0,Gt|0,jt&ii|0,(((Z|0)<0?-1:0)>>31|((Z|0)<0?-1:0)<<1)&Ct|0)|0,D=Qt()|0,ae=ae-1|0;while(ae|0);yt=We,We=0}return ae=0,ee|0&&(o[ee>>2]=C,o[ee+4>>2]=D),jt=(le|0)>>>31|(yt|ae)<<1|(ae<<1|le>>>31)&0|We,Z=(le<<1|0)&-2|be,Fn(jt|0),Z|0}function Co(C,D,z,R){C=C|0,D=D|0,z=z|0,R=R|0;var ee=0,le=0;return le=Vt,Vt=Vt+16|0,ee=le|0,_s(C,D,z,R,ee)|0,Vt=le,Fn(o[ee+4>>2]|0),o[ee>>2]|0|0}function Mi(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(Fn(D>>>z|0),C>>>z|(D&(1<<z)-1)<<32-z):(Fn(0),D>>>z-32|0)}function zi(C,D,z){return C=C|0,D=D|0,z=z|0,(z|0)<32?(Fn(D<<z|(C&(1<<z)-1<<32-z)>>>32-z|0),C<<z):(Fn(C<<z-32|0),0)}function ys(C,D){return C=+C,D=+D,C!=C?+D:D!=D?+C:+Hi(+C,+D)}function yu(C){return C=+C,C>=0?+di(C+.5):+Vn(C-.5)}function Oo(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0;if((z|0)>=8192)return ur(C|0,D|0,z|0)|0,C|0;if(le=C|0,ee=C+z|0,(C&3)==(D&3)){for(;C&3;){if(!z)return le|0;Tt[C>>0]=Tt[D>>0]|0,C=C+1|0,D=D+1|0,z=z-1|0}for(z=ee&-4|0,R=z-64|0;(C|0)<=(R|0);)o[C>>2]=o[D>>2],o[C+4>>2]=o[D+4>>2],o[C+8>>2]=o[D+8>>2],o[C+12>>2]=o[D+12>>2],o[C+16>>2]=o[D+16>>2],o[C+20>>2]=o[D+20>>2],o[C+24>>2]=o[D+24>>2],o[C+28>>2]=o[D+28>>2],o[C+32>>2]=o[D+32>>2],o[C+36>>2]=o[D+36>>2],o[C+40>>2]=o[D+40>>2],o[C+44>>2]=o[D+44>>2],o[C+48>>2]=o[D+48>>2],o[C+52>>2]=o[D+52>>2],o[C+56>>2]=o[D+56>>2],o[C+60>>2]=o[D+60>>2],C=C+64|0,D=D+64|0;for(;(C|0)<(z|0);)o[C>>2]=o[D>>2],C=C+4|0,D=D+4|0}else for(z=ee-4|0;(C|0)<(z|0);)Tt[C>>0]=Tt[D>>0]|0,Tt[C+1>>0]=Tt[D+1>>0]|0,Tt[C+2>>0]=Tt[D+2>>0]|0,Tt[C+3>>0]=Tt[D+3>>0]|0,C=C+4|0,D=D+4|0;for(;(C|0)<(ee|0);)Tt[C>>0]=Tt[D>>0]|0,C=C+1|0,D=D+1|0;return le|0}function cs(C,D,z){C=C|0,D=D|0,z=z|0;var R=0,ee=0,le=0,ae=0;if(le=C+z|0,D=D&255,(z|0)>=67){for(;C&3;)Tt[C>>0]=D,C=C+1|0;for(R=le&-4|0,ae=D|D<<8|D<<16|D<<24,ee=R-64|0;(C|0)<=(ee|0);)o[C>>2]=ae,o[C+4>>2]=ae,o[C+8>>2]=ae,o[C+12>>2]=ae,o[C+16>>2]=ae,o[C+20>>2]=ae,o[C+24>>2]=ae,o[C+28>>2]=ae,o[C+32>>2]=ae,o[C+36>>2]=ae,o[C+40>>2]=ae,o[C+44>>2]=ae,o[C+48>>2]=ae,o[C+52>>2]=ae,o[C+56>>2]=ae,o[C+60>>2]=ae,C=C+64|0;for(;(C|0)<(R|0);)o[C>>2]=ae,C=C+4|0}for(;(C|0)<(le|0);)Tt[C>>0]=D,C=C+1|0;return le-z|0}function ul(C){return C=+C,C>=0?+di(C+.5):+Vn(C-.5)}function Ps(C){C=C|0;var D=0,z=0,R=0;return R=En()|0,z=o[ai>>2]|0,D=z+C|0,(C|0)>0&(D|0)<(z|0)|(D|0)<0?(Vr(D|0)|0,Ut(12),-1):(D|0)>(R|0)&&!(Ns(D|0)|0)?(Ut(12),-1):(o[ai>>2]=D,z|0)}return{___uremdi3:Co,_bitshift64Lshr:Mi,_bitshift64Shl:zi,_calloc:Jo,_cellAreaKm2:Ol,_cellAreaM2:Jr,_cellAreaRads2:Nn,_compact:Tl,_destroyLinkedPolygon:or,_edgeLengthKm:Za,_edgeLengthM:Kr,_emscripten_replace_memory:cr,_exactEdgeLengthKm:ks,_exactEdgeLengthM:Cr,_exactEdgeLengthRads:jr,_experimentalH3ToLocalIj:Xa,_experimentalLocalIjToH3:po,_free:Jn,_geoToH3:ha,_getDestinationH3IndexFromUnidirectionalEdge:Di,_getH3IndexesFromUnidirectionalEdge:ei,_getH3UnidirectionalEdge:mi,_getH3UnidirectionalEdgeBoundary:Oi,_getH3UnidirectionalEdgesFromHexagon:xi,_getOriginH3IndexFromUnidirectionalEdge:Ni,_getPentagonIndexes:gl,_getRes0Indexes:hr,_h3Distance:rs,_h3GetBaseCell:al,_h3GetFaces:ll,_h3GetResolution:nr,_h3IndexesAreNeighbors:io,_h3IsPentagon:hs,_h3IsResClassIII:Ao,_h3IsValid:Xr,_h3Line:zu,_h3LineSize:Qu,_h3SetToLinkedGeo:Va,_h3ToCenterChild:wa,_h3ToChildren:Zr,_h3ToGeo:Sa,_h3ToGeoBoundary:ka,_h3ToParent:Io,_h3UnidirectionalEdgeIsValid:Ot,_hexAreaKm2:Yo,_hexAreaM2:Dr,_hexRing:aa,_i64Subtract:oa,_kRing:Fa,_kRingDistances:zo,_llvm_minnum_f64:ys,_llvm_round_f64:yu,_malloc:Gn,_maxFaceCount:Wa,_maxH3ToChildrenSize:ol,_maxKringSize:kr,_maxPolyfillSize:ls,_maxUncompactSize:kl,_memcpy:Oo,_memset:cs,_numHexagons:Ar,_pentagonIndexCount:ou,_pointDistKm:Ts,_pointDistM:mu,_pointDistRads:ja,_polyfill:Na,_res0IndexCount:rr,_round:ul,_sbrk:Ps,_sizeOfCoordIJ:lu,_sizeOfGeoBoundary:Sn,_sizeOfGeoCoord:Nl,_sizeOfGeoPolygon:In,_sizeOfGeofence:Hl,_sizeOfH3Index:Fo,_sizeOfLinkedGeoPolygon:_l,_uncompact:Eo,establishStackSpace:ua,stackAlloc:Lt,stackRestore:Vs,stackSave:Br}}(rt,Me,mt);t.___uremdi3=se.___uremdi3,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._compact=se._compact,t._destroyLinkedPolygon=se._destroyLinkedPolygon,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._exactEdgeLengthKm=se._exactEdgeLengthKm,t._exactEdgeLengthM=se._exactEdgeLengthM,t._exactEdgeLengthRads=se._exactEdgeLengthRads,t._experimentalH3ToLocalIj=se._experimentalH3ToLocalIj,t._experimentalLocalIjToH3=se._experimentalLocalIjToH3,t._free=se._free,t._geoToH3=se._geoToH3,t._getDestinationH3IndexFromUnidirectionalEdge=se._getDestinationH3IndexFromUnidirectionalEdge,t._getH3IndexesFromUnidirectionalEdge=se._getH3IndexesFromUnidirectionalEdge,t._getH3UnidirectionalEdge=se._getH3UnidirectionalEdge,t._getH3UnidirectionalEdgeBoundary=se._getH3UnidirectionalEdgeBoundary,t._getH3UnidirectionalEdgesFromHexagon=se._getH3UnidirectionalEdgesFromHexagon,t._getOriginH3IndexFromUnidirectionalEdge=se._getOriginH3IndexFromUnidirectionalEdge,t._getPentagonIndexes=se._getPentagonIndexes,t._getRes0Indexes=se._getRes0Indexes,t._h3Distance=se._h3Distance,t._h3GetBaseCell=se._h3GetBaseCell,t._h3GetFaces=se._h3GetFaces,t._h3GetResolution=se._h3GetResolution,t._h3IndexesAreNeighbors=se._h3IndexesAreNeighbors,t._h3IsPentagon=se._h3IsPentagon,t._h3IsResClassIII=se._h3IsResClassIII,t._h3IsValid=se._h3IsValid,t._h3Line=se._h3Line,t._h3LineSize=se._h3LineSize,t._h3SetToLinkedGeo=se._h3SetToLinkedGeo,t._h3ToCenterChild=se._h3ToCenterChild,t._h3ToChildren=se._h3ToChildren,t._h3ToGeo=se._h3ToGeo,t._h3ToGeoBoundary=se._h3ToGeoBoundary,t._h3ToParent=se._h3ToParent,t._h3UnidirectionalEdgeIsValid=se._h3UnidirectionalEdgeIsValid,t._hexAreaKm2=se._hexAreaKm2,t._hexAreaM2=se._hexAreaM2,t._hexRing=se._hexRing,t._i64Subtract=se._i64Subtract,t._kRing=se._kRing,t._kRingDistances=se._kRingDistances,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxH3ToChildrenSize=se._maxH3ToChildrenSize,t._maxKringSize=se._maxKringSize,t._maxPolyfillSize=se._maxPolyfillSize,t._maxUncompactSize=se._maxUncompactSize,t._memcpy=se._memcpy,t._memset=se._memset,t._numHexagons=se._numHexagons,t._pentagonIndexCount=se._pentagonIndexCount,t._pointDistKm=se._pointDistKm,t._pointDistM=se._pointDistM,t._pointDistRads=se._pointDistRads,t._polyfill=se._polyfill,t._res0IndexCount=se._res0IndexCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoBoundary=se._sizeOfGeoBoundary,t._sizeOfGeoCoord=se._sizeOfGeoCoord,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfGeofence=se._sizeOfGeofence,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompact=se._uncompact,t.establishStackSpace=se.establishStackSpace;var X=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=kt,t.setValue=we,t.getValue=et,t.getTempRet0=oe,ln){On(ln)||(ln=b(ln));{ns();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),dt.set(De,fe),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,fi()},ge=function(){E(ln,ye,function(){throw"could not load memory initializer "+ln})},Pe=ft(ln);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ue=De.response;if(De.status!==200&&De.status!==0){var ht=ft(t.memoryInitializerRequestURL);if(ht)Ue=ht.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+ln),ge();return}}ye(Ue)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ne;Mn=function De(){Ne||Xe(),Ne||(Mn=De)};function Xe(De){if(ti>0||(sn(),ti>0))return;function Ue(){Ne||(Ne=!0,!lt&&(Ti(),yi(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),hi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ue()},1)):Ue()}t.run=Xe;function Ye(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),U(De),lt=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ye,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof kn=="object"?kn:{}),Tr="number",$m=Tr,ss=Tr,Rs=Tr,Oc=Tr,xa=Tr,HO=[["sizeOfH3Index",Tr],["sizeOfGeoCoord",Tr],["sizeOfGeoBoundary",Tr],["sizeOfGeoPolygon",Tr],["sizeOfGeofence",Tr],["sizeOfLinkedGeoPolygon",Tr],["sizeOfCoordIJ",Tr],["h3IsValid",$m,[ss,Rs]],["geoToH3",ss,[Tr,Tr,Oc]],["h3ToGeo",null,[ss,Rs,xa]],["h3ToGeoBoundary",null,[ss,Rs,xa]],["maxKringSize",Tr,[Tr]],["kRing",null,[ss,Rs,Tr,xa]],["kRingDistances",null,[ss,Rs,Tr,xa,xa]],["hexRing",null,[ss,Rs,Tr,xa]],["maxPolyfillSize",Tr,[xa,Oc]],["polyfill",null,[xa,Oc,xa]],["h3SetToLinkedGeo",null,[xa,Tr,xa]],["destroyLinkedPolygon",null,[xa]],["compact",Tr,[xa,xa,Tr]],["uncompact",Tr,[xa,Tr,xa,Tr,Oc]],["maxUncompactSize",Tr,[xa,Tr,Oc]],["h3IsPentagon",$m,[ss,Rs]],["h3IsResClassIII",$m,[ss,Rs]],["h3GetBaseCell",Tr,[ss,Rs]],["h3GetResolution",Tr,[ss,Rs]],["maxFaceCount",Tr,[ss,Rs]],["h3GetFaces",null,[ss,Rs,xa]],["h3ToParent",ss,[ss,Rs,Oc]],["h3ToChildren",null,[ss,Rs,Oc,xa]],["h3ToCenterChild",ss,[ss,Rs,Oc]],["maxH3ToChildrenSize",Tr,[ss,Rs,Oc]],["h3IndexesAreNeighbors",$m,[ss,Rs,ss,Rs]],["getH3UnidirectionalEdge",ss,[ss,Rs,ss,Rs]],["getOriginH3IndexFromUnidirectionalEdge",ss,[ss,Rs]],["getDestinationH3IndexFromUnidirectionalEdge",ss,[ss,Rs]],["h3UnidirectionalEdgeIsValid",$m,[ss,Rs]],["getH3IndexesFromUnidirectionalEdge",null,[ss,Rs,xa]],["getH3UnidirectionalEdgesFromHexagon",null,[ss,Rs,xa]],["getH3UnidirectionalEdgeBoundary",null,[ss,Rs,xa]],["h3Distance",Tr,[ss,Rs,ss,Rs]],["h3Line",Tr,[ss,Rs,ss,Rs,xa]],["h3LineSize",Tr,[ss,Rs,ss,Rs]],["experimentalH3ToLocalIj",Tr,[ss,Rs,ss,Rs,xa]],["experimentalLocalIjToH3",Tr,[ss,Rs,xa,xa]],["hexAreaM2",Tr,[Oc]],["hexAreaKm2",Tr,[Oc]],["edgeLengthM",Tr,[Oc]],["edgeLengthKm",Tr,[Oc]],["pointDistM",Tr,[xa,xa]],["pointDistKm",Tr,[xa,xa]],["pointDistRads",Tr,[xa,xa]],["cellAreaM2",Tr,[ss,Rs]],["cellAreaKm2",Tr,[ss,Rs]],["cellAreaRads2",Tr,[ss,Rs]],["exactEdgeLengthM",Tr,[ss,Rs]],["exactEdgeLengthKm",Tr,[ss,Rs]],["exactEdgeLengthRads",Tr,[ss,Rs]],["numHexagons",Tr,[Oc]],["getRes0Indexes",null,[xa]],["res0IndexCount",Tr],["getPentagonIndexes",null,[Tr,xa]],["pentagonIndexCount",Tr]],sr={};HO.forEach(function(t){sr[t[0]]=kn.cwrap.apply(kn,t)});var im=16,gc=4,yw=4,V0=8,nc=sr.sizeOfH3Index(),f1=sr.sizeOfGeoCoord(),a5=sr.sizeOfGeoBoundary(),jO=sr.sizeOfGeoPolygon(),ug=sr.sizeOfGeofence(),ZO=sr.sizeOfLinkedGeoPolygon(),o5=sr.sizeOfCoordIJ(),Uc={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Sm(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw new Error("Invalid resolution: "+e)}var QO=/[^0-9a-fA-F]/;function ga(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||QO.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),im),n=parseInt(e.substring(e.length-8),im);return[n,t]}function vw(e){if(e>=0)return e.toString(im);e=e&2147483647;var t=l5(8,e.toString(im)),n=(parseInt(t[0],im)+8).toString(im);return t=n+t.substring(1),t}function d1(e,t){return vw(t)+l5(8,vw(e))}function l5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function xw(e,t,n){for(var c=e.length,g=kn._calloc(c,f1),b=n?1:0,E=n?0:1,a=0;a<c*2;a+=2)kn.HEAPF64.set([e[a/2][b],e[a/2][E]].map(p1),g/V0+a);return kn.HEAPU32.set([c,g],t/gc),t}function WO(e,t){var n=e.length-1,c=kn._calloc(jO),g=0,b=g+ug,E=b+gc;xw(e[0],c+g,t);var a;if(n>0){a=kn._calloc(n,ug);for(var U=0;U<n;U++)xw(e[U+1],a+ug*U,t)}return kn.setValue(c+b,n,"i32"),kn.setValue(c+E,a,"i32"),c}function XO(e){var t=0,n=t+ug,c=n+gc,g=gc;kn._free(kn.getValue(e+t+g,"i8*"));var b=kn.getValue(e+n,"i32");if(b>0){for(var E=kn.getValue(e+c,"i32"),a=0;a<b;a++)kn._free(kn.getValue(E+ug*a+g,"i8*"));kn._free(E)}kn._free(e)}function u5(e){var t=kn.getTempRet0();return[e,t]}function Im(e){var t=u5(e),n=t[0],c=t[1];return c?d1(n,c):null}function c5(e,t){t===void 0&&(t=0);var n=kn.getValue(e+gc*t*2,"i32"),c=kn.getValue(e+gc*(t*2+1),"i32");return c?d1(n,c):null}function YO(e,t,n){kn.HEAPU32.set(ga(e),t/gc+2*n)}function fA(e,t){for(var n=[],c=0;c<t;c++){var g=c5(e,c);g!==null&&n.push(g)}return n}function w2(e,t){for(var n=t.length,c=0;c<n;c++)YO(t[c],e,c)}function bw(e,t){var n=kn._calloc(1,f1);return kn.HEAPF64.set([e,t].map(p1),n/V0),n}function q_(e){return d5(kn.getValue(e,"double"))}function S2(e){return[q_(e),q_(e+V0)]}function h5(e){return[q_(e+V0),q_(e)]}function A5(e,t,n){for(var c=kn.getValue(e,"i32"),g=e+V0,b=[],E=t?h5:S2,a=0;a<c*2;a+=2)b.push(E(g+V0*a));return n&&b.push(b[0]),b}function $O(e,t){for(var n=[],c=t?h5:S2,g,b,E,a;e;){for(n.push(g=[]),b=kn.getValue(e,"i8*");b;){for(g.push(E=[]),a=kn.getValue(b,"i8*");a;)E.push(c(a)),a=kn.getValue(a+V0*2,"i8*");t&&E.push(E[0]),b=kn.getValue(b+yw*2,"i8*")}e=kn.getValue(e+yw*2,"i8*")}return n}function KO(e){return{i:kn.getValue(e,"i32"),j:kn.getValue(e+gc,"i32")}}function JO(e,t){var n=t.i,c=t.j;kn.setValue(e,n,"i32"),kn.setValue(e+gc,c,"i32")}function eN(e,t){for(var n=[],c=0;c<t;c++){var g=kn.getValue(e+gc*c,"i32");g>=0&&n.push(g)}return n}function f5(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3IsValid(n,c)}function tN(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3IsPentagon(n,c)}function iN(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3IsResClassIII(n,c)}function nN(e){var t=ga(e),n=t[0],c=t[1];return sr.h3GetBaseCell(n,c)}function rN(e){var t=ga(e),n=t[0],c=t[1],g=sr.maxFaceCount(n,c),b=kn._malloc(gc*g);sr.h3GetFaces(n,c,b);var E=eN(b,g);return kn._free(b),E}function sN(e){var t=ga(e),n=t[0],c=t[1];return sr.h3IsValid(n,c)?sr.h3GetResolution(n,c):-1}function aN(e,t,n){var c=kn._malloc(f1);kn.HEAPF64.set([e,t].map(p1),c/V0);var g=Im(sr.geoToH3(c,n));return kn._free(c),g}function oN(e){var t=kn._malloc(f1),n=ga(e),c=n[0],g=n[1];sr.h3ToGeo(c,g,t);var b=S2(t);return kn._free(t),b}function lN(e,t){var n=kn._malloc(a5),c=ga(e),g=c[0],b=c[1];sr.h3ToGeoBoundary(g,b,n);var E=A5(n,t,t);return kn._free(n),E}function uN(e,t){var n=ga(e),c=n[0],g=n[1];return Im(sr.h3ToParent(c,g,t))}function cN(e,t){if(!f5(e))return[];var n=ga(e),c=n[0],g=n[1],b=sr.maxH3ToChildrenSize(c,g,t),E=kn._calloc(b,nc);sr.h3ToChildren(c,g,t,E);var a=fA(E,b);return kn._free(E),a}function hN(e,t){var n=ga(e),c=n[0],g=n[1];return Im(sr.h3ToCenterChild(c,g,t))}function AN(e,t){var n=ga(e),c=n[0],g=n[1],b=sr.maxKringSize(t),E=kn._calloc(b,nc);sr.kRing(c,g,t,E);var a=fA(E,b);return kn._free(E),a}function fN(e,t){var n=ga(e),c=n[0],g=n[1],b=sr.maxKringSize(t),E=kn._calloc(b,nc),a=kn._calloc(b,gc);sr.kRingDistances(c,g,t,E,a);for(var U=[],W=0;W<t+1;W++)U.push([]);for(var ce=0;ce<b*2;ce+=2){var oe=kn.getValue(E+gc*ce,"i32"),fe=kn.getValue(E+gc*(ce+1),"i32"),we=kn.getValue(a+gc*(ce/2),"i32");(oe!==0||fe!==0)&&U[we].push(d1(oe,fe))}return kn._free(E),kn._free(a),U}function dN(e,t){var n=t===0?1:6*t,c=kn._calloc(n,nc),g=sr.hexRing.apply(sr,ga(e).concat([t],[c]));if(g!==0)throw kn._free(c),new Error("Failed to get hexRing (encountered a pentagon?)");var b=fA(c,n);return kn._free(c),b}function pN(e,t,n){if(Sm(t),n=!!n,e.length===0||e[0].length===0)return[];typeof e[0][0]=="number"&&(e=[e]);var c=WO(e,n),g=sr.maxPolyfillSize(c,t),b=kn._calloc(g,nc);sr.polyfill(c,t,b);var E=fA(b,g);return kn._free(b),XO(c),E}function mN(e,t){if(!e||!e.length)return[];var n=e.length,c=kn._calloc(n,nc);w2(c,e);var g=kn._calloc(ZO),b=g;sr.h3SetToLinkedGeo(c,n,g);var E=$O(g,t);return sr.destroyLinkedPolygon(b),kn._free(b),kn._free(c),E}function gN(e){if(!e||!e.length)return[];var t=e.length,n=kn._calloc(t,nc);w2(n,e);var c=kn._calloc(t,nc),g=sr.compact(n,c,t);if(g!==0)throw kn._free(n),kn._free(c),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var b=fA(c,t);return kn._free(n),kn._free(c),b}function _N(e,t){if(Sm(t),!e||!e.length)return[];var n=e.length,c=kn._calloc(n,nc);w2(c,e);var g=sr.maxUncompactSize(c,n,t),b=kn._calloc(g,nc),E=sr.uncompact(c,n,b,g,t);if(E!==0)throw kn._free(c),kn._free(b),new Error("Failed to uncompact (bad resolution?)");var a=fA(b,g);return kn._free(c),kn._free(b),a}function yN(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),E=b[0],a=b[1];return!!sr.h3IndexesAreNeighbors(c,g,E,a)}function vN(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),E=b[0],a=b[1];return Im(sr.getH3UnidirectionalEdge(c,g,E,a))}function xN(e){var t=ga(e),n=t[0],c=t[1];return Im(sr.getOriginH3IndexFromUnidirectionalEdge(n,c))}function bN(e){var t=ga(e),n=t[0],c=t[1];return Im(sr.getDestinationH3IndexFromUnidirectionalEdge(n,c))}function wN(e){var t=ga(e),n=t[0],c=t[1];return!!sr.h3UnidirectionalEdgeIsValid(n,c)}function SN(e){var t=ga(e),n=t[0],c=t[1],g=2,b=kn._calloc(g,nc);sr.getH3IndexesFromUnidirectionalEdge(n,c,b);var E=fA(b,g);return kn._free(b),E}function IN(e){var t=ga(e),n=t[0],c=t[1],g=6,b=kn._calloc(g,nc);sr.getH3UnidirectionalEdgesFromHexagon(n,c,b);var E=fA(b,g);return kn._free(b),E}function EN(e,t){var n=kn._malloc(a5),c=ga(e),g=c[0],b=c[1];sr.getH3UnidirectionalEdgeBoundary(g,b,n);var E=A5(n,t);return kn._free(n),E}function CN(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),E=b[0],a=b[1];return sr.h3Distance(c,g,E,a)}function TN(e,t){var n=ga(e),c=n[0],g=n[1],b=ga(t),E=b[0],a=b[1],U=sr.h3LineSize(c,g,E,a);if(U<0)throw new Error("Line cannot be calculated");var W=kn._calloc(U,nc);sr.h3Line(c,g,E,a,W);var ce=fA(W,U);return kn._free(W),ce}function kN(e,t){var n=kn._malloc(o5),c=sr.experimentalH3ToLocalIj.apply(sr,ga(e).concat(ga(t),[n])),g=KO(n);switch(kn._free(n),c){case 0:return g;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function MN(e,t){if(!t||typeof t.i!="number"||typeof t.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=kn._malloc(o5),c=kn._malloc(nc);JO(n,t);var g=sr.experimentalLocalIjToH3.apply(sr,ga(e).concat([n],[c])),b=c5(c);if(kn._free(n),kn._free(c),g!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return b}function PN(e,t,n){var c=bw(e[0],e[1]),g=bw(t[0],t[1]),b;switch(n){case Uc.m:b=sr.pointDistM(c,g);break;case Uc.km:b=sr.pointDistKm(c,g);break;case Uc.rads:b=sr.pointDistRads(c,g);break;default:b=null}if(kn._free(c),kn._free(g),b===null)throw new Error("Unknown unit: "+n);return b}function DN(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case Uc.m2:return sr.cellAreaM2(c,g);case Uc.km2:return sr.cellAreaKm2(c,g);case Uc.rads2:return sr.cellAreaRads2(c,g);default:throw new Error("Unknown unit: "+t)}}function LN(e,t){var n=ga(e),c=n[0],g=n[1];switch(t){case Uc.m:return sr.exactEdgeLengthM(c,g);case Uc.km:return sr.exactEdgeLengthKm(c,g);case Uc.rads:return sr.exactEdgeLengthRads(c,g);default:throw new Error("Unknown unit: "+t)}}function BN(e,t){switch(Sm(e),t){case Uc.m2:return sr.hexAreaM2(e);case Uc.km2:return sr.hexAreaKm2(e);default:throw new Error("Unknown unit: "+t)}}function zN(e,t){switch(Sm(e),t){case Uc.m:return sr.edgeLengthM(e);case Uc.km:return sr.edgeLengthKm(e);default:throw new Error("Unknown unit: "+t)}}function RN(e){Sm(e);var t=u5(sr.numHexagons(e)),n=t[0],c=t[1];return c?c*Math.pow(2,32)+n:n}function FN(){var e=sr.res0IndexCount(),t=kn._malloc(nc*e);sr.getRes0Indexes(t);var n=fA(t,e);return kn._free(t),n}function ON(e){Sm(e);var t=sr.pentagonIndexCount(),n=kn._malloc(nc*t);sr.getPentagonIndexes(e,n);var c=fA(n,t);return kn._free(n),c}function p1(e){return e*Math.PI/180}function d5(e){return e*180/Math.PI}const NN=Object.freeze(Object.defineProperty({__proto__:null,UNITS:Uc,cellArea:DN,compact:gN,degsToRads:p1,edgeLength:zN,exactEdgeLength:LN,experimentalH3ToLocalIj:kN,experimentalLocalIjToH3:MN,geoToH3:aN,getDestinationH3IndexFromUnidirectionalEdge:bN,getH3IndexesFromUnidirectionalEdge:SN,getH3UnidirectionalEdge:vN,getH3UnidirectionalEdgeBoundary:EN,getH3UnidirectionalEdgesFromHexagon:IN,getOriginH3IndexFromUnidirectionalEdge:xN,getPentagonIndexes:ON,getRes0Indexes:FN,h3Distance:CN,h3GetBaseCell:nN,h3GetFaces:rN,h3GetResolution:sN,h3IndexToSplitLong:ga,h3IndexesAreNeighbors:yN,h3IsPentagon:tN,h3IsResClassIII:iN,h3IsValid:f5,h3Line:TN,h3SetToMultiPolygon:mN,h3ToCenterChild:hN,h3ToChildren:cN,h3ToGeo:oN,h3ToGeoBoundary:lN,h3ToParent:uN,h3UnidirectionalEdgeIsValid:wN,hexArea:BN,hexRing:dN,kRing:AN,kRingDistances:fN,numHexagons:RN,pointDist:PN,polyfill:pN,radsToDegs:d5,splitLongToh3Index:d1,uncompact:_N},Symbol.toStringTag,{value:"Module"})),VN=Pv(NN);var Sg=VN,m1="Feature",p5="FeatureCollection",H_="Polygon",I2="MultiPolygon";function m5(e){for(var t=null,n=0;n<e.length;n++)if(t!==null)for(var c=0;c<e[n].length;c++)t.push(e[n][c]);else t=e[n];return Array.from(new Set(t))}function UN(e){for(var t=0,n=0,c=0,g=e[0],b=0;b<g.length;b++)t+=g[b][0],n+=g[b][1],c++;return[t/c,n/c]}function GN(e,t){var n=e.features;if(!n)throw new Error("No features found");return m5(n.map(function(c){return g5(c,t)}))}function g5(e,t,n){n===void 0&&(n={});var c=e.type,g=e.geometry,b=g&&g.type;if(c===p5)return GN(e,t);if(c!==m1)throw new Error("Unhandled type: "+c);if(b!==H_&&b!==I2)throw new Error("Unhandled geometry type: "+b);var E=b===H_?[g.coordinates]:g.coordinates;return m5(E.map(function(a){var U=Sg.polyfill(a,t,!0);if(U.length||!n.ensureOutput)return U;var W=UN(a),ce=W[0],oe=W[1];return[Sg.geoToH3(oe,ce,t)]}))}function _5(e,t){t===void 0&&(t={});var n=[Sg.h3ToGeoBoundary(e,!0)];return{type:m1,id:e,properties:t,geometry:{type:H_,coordinates:n}}}function qN(e,t){t===void 0&&(t={});var n=Sg.h3SetToMultiPolygon(e,!0),c=n.length>1,g=c?I2:H_,b=c?n:n[0]||[];return{type:m1,properties:t,geometry:{type:g,coordinates:b}}}function HN(e,t){t===void 0&&(t={});var n=e.map(function(c){return[Sg.h3ToGeoBoundary(c,{geoJson:!0})]});return{type:m1,properties:t,geometry:{type:I2,coordinates:n}}}function jN(e,t){for(var n=[],c=0;c<e.length;c++){var g=e[c],b=t?t(g):{};n.push(_5(g,b))}return{type:p5,features:n}}var ZN={featureToH3Set:g5,h3ToFeature:_5,h3SetToFeature:qN,h3SetToMultiPolygonFeature:HN,h3SetToFeatureCollection:jN},QN=ZN,Ca=function(e){e=e||{};var t=typeof e<"u"?e:{},n={},c;for(c in t)t.hasOwnProperty(c)&&(n[c]=t[c]);var g="";function b(De){return t.locateFile?t.locateFile(De,g):g+De}var E;typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),g.indexOf("blob:")!==0?g=g.substr(0,g.lastIndexOf("/")+1):g="",E=function(Ue,ht,Tt){var o=new XMLHttpRequest;o.open("GET",Ue,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ht(o.response);return}var ai=ft(Ue);if(ai){ht(ai.buffer);return}Tt()},o.onerror=Tt,o.send(null)};var a=t.print||console.log.bind(console),U=t.printErr||console.warn.bind(console);for(c in n)n.hasOwnProperty(c)&&(t[c]=n[c]);n=null,t.arguments&&t.arguments;var W=0,ce=function(De){W=De},oe=function(){return W},fe=8;function we(De,Ue,ht,Tt){switch(ht=ht||"i8",ht.charAt(ht.length-1)==="*"&&(ht="i32"),ht){case"i1":bt[De>>0]=Ue;break;case"i8":bt[De>>0]=Ue;break;case"i16":nt[De>>1]=Ue;break;case"i32":pt[De>>2]=Ue;break;case"i64":wn=[Ue>>>0,(Qn=Ue,+fn(Qn)>=1?Qn>0?(mn(+gi(Qn/4294967296),4294967295)|0)>>>0:~~+_n((Qn-+(~~Qn>>>0))/4294967296)>>>0:0)],pt[De>>2]=wn[0],pt[De+4>>2]=wn[1];break;case"float":at[De>>2]=Ue;break;case"double":Nt[De>>3]=Ue;break;default:Ye("invalid type for setValue: "+ht)}}function et(De,Ue,ht){switch(Ue=Ue||"i8",Ue.charAt(Ue.length-1)==="*"&&(Ue="i32"),Ue){case"i1":return bt[De>>0];case"i8":return bt[De>>0];case"i16":return nt[De>>1];case"i32":return pt[De>>2];case"i64":return pt[De>>2];case"float":return at[De>>2];case"double":return Nt[De>>3];default:Ye("invalid type for getValue: "+Ue)}return null}var lt=!1;function Ke(De,Ue){De||Ye("Assertion failed: "+Ue)}function st(De){var Ue=t["_"+De];return Ke(Ue,"Cannot call unknown function "+De+", make sure it is exported"),Ue}function ut(De,Ue,ht,Tt,o){var ke={string:function(wi){var Yt=0;if(wi!=null&&wi!==0){var vn=(wi.length<<2)+1;Yt=X(vn),it(wi,Yt,vn)}return Yt},array:function(wi){var Yt=X(wi.length);return xt(wi,Yt),Yt}};function ai(wi){return Ue==="string"?Ge(wi):Ue==="boolean"?!!wi:wi}var di=st(De),Ai=[],Kt=0;if(Tt)for(var oi=0;oi<Tt.length;oi++){var Ri=ke[ht[oi]];Ri?(Kt===0&&(Kt=de()),Ai[oi]=Ri(Tt[oi])):Ai[oi]=Tt[oi]}var vi=di.apply(null,Ai);return vi=ai(vi),Kt!==0&&ie(Kt),vi}function kt(De,Ue,ht,Tt){ht=ht||[];var o=ht.every(function(ai){return ai==="number"}),ke=Ue!=="string";return ke&&o&&!Tt?st(De):function(){return ut(De,Ue,ht,arguments)}}var Bt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Rt(De,Ue,ht){for(var Tt=Ue+ht,o=Ue;De[o]&&!(o>=Tt);)++o;if(o-Ue>16&&De.subarray&&Bt)return Bt.decode(De.subarray(Ue,o));for(var ke="";Ue<o;){var ai=De[Ue++];if(!(ai&128)){ke+=String.fromCharCode(ai);continue}var di=De[Ue++]&63;if((ai&224)==192){ke+=String.fromCharCode((ai&31)<<6|di);continue}var Ai=De[Ue++]&63;if((ai&240)==224?ai=(ai&15)<<12|di<<6|Ai:ai=(ai&7)<<18|di<<12|Ai<<6|De[Ue++]&63,ai<65536)ke+=String.fromCharCode(ai);else{var Kt=ai-65536;ke+=String.fromCharCode(55296|Kt>>10,56320|Kt&1023)}}return ke}function Ge(De,Ue){return De?Rt(dt,De,Ue):""}function ni(De,Ue,ht,Tt){if(!(Tt>0))return 0;for(var o=ht,ke=ht+Tt-1,ai=0;ai<De.length;++ai){var di=De.charCodeAt(ai);if(di>=55296&&di<=57343){var Ai=De.charCodeAt(++ai);di=65536+((di&1023)<<10)|Ai&1023}if(di<=127){if(ht>=ke)break;Ue[ht++]=di}else if(di<=2047){if(ht+1>=ke)break;Ue[ht++]=192|di>>6,Ue[ht++]=128|di&63}else if(di<=65535){if(ht+2>=ke)break;Ue[ht++]=224|di>>12,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}else{if(ht+3>=ke)break;Ue[ht++]=240|di>>18,Ue[ht++]=128|di>>12&63,Ue[ht++]=128|di>>6&63,Ue[ht++]=128|di&63}}return Ue[ht]=0,ht-o}function it(De,Ue,ht){return ni(De,dt,Ue,ht)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function xt(De,Ue){bt.set(De,Ue)}function _t(De,Ue){return De%Ue>0&&(De+=Ue-De%Ue),De}var mt,bt,dt,nt,pt,at,Nt;function Ft(De){mt=De,t.HEAP8=bt=new Int8Array(De),t.HEAP16=nt=new Int16Array(De),t.HEAP32=pt=new Int32Array(De),t.HEAPU8=dt=new Uint8Array(De),t.HEAPU16=new Uint16Array(De),t.HEAPU32=new Uint32Array(De),t.HEAPF32=at=new Float32Array(De),t.HEAPF64=Nt=new Float64Array(De)}var Dt=5267040,ci=24128,bi=t.TOTAL_MEMORY||33554432;t.buffer?mt=t.buffer:mt=new ArrayBuffer(bi),bi=mt.byteLength,Ft(mt),pt[ci>>2]=Dt;function ki(De){for(;De.length>0;){var Ue=De.shift();if(typeof Ue=="function"){Ue();continue}var ht=Ue.func;typeof ht=="number"?Ue.arg===void 0?t.dynCall_v(ht):t.dynCall_vi(ht,Ue.arg):ht(Ue.arg===void 0?null:Ue.arg)}}var Gi=[],rn=[],$i=[],qi=[];function sn(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ei(t.preRun.shift());ki(Gi)}function Ti(){ki(rn)}function yi(){ki($i)}function hi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Li(t.postRun.shift());ki(qi)}function Ei(De){Gi.unshift(De)}function Li(De){qi.unshift(De)}var fn=Math.abs,_n=Math.ceil,gi=Math.floor,mn=Math.min,ti=0,Mn=null;function ns(De){ti++,t.monitorRunDependencies&&t.monitorRunDependencies(ti)}function fi(De){if(ti--,t.monitorRunDependencies&&t.monitorRunDependencies(ti),ti==0&&Mn){var Ue=Mn;Mn=null,Ue()}}t.preloadedImages={},t.preloadedAudios={};var ln=null,pr="data:application/octet-stream;base64,";function On(De){return String.prototype.startsWith?De.startsWith(pr):De.indexOf(pr)===0}var Qn,wn;ln="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var v=24144;function k(De){return De}function V(De){var Ue=/\b__Z[\w\d_]+/g;return De.replace(Ue,function(ht){var Tt=ht;return ht===Tt?ht:Tt+" ["+ht+"]"})}function $(){var De=new Error;if(!De.stack){try{throw new Error(0)}catch(Ue){De=Ue}if(!De.stack)return"(no stack trace available)"}return De.stack.toString()}function te(){var De=$();return t.extraStackTrace&&(De+=`
`+t.extraStackTrace()),V(De)}function Ae(De,Ue,ht,Tt){Ye("Assertion failed: "+Ge(De)+", at: "+[Ue?Ge(Ue):"unknown filename",ht,Tt?Ge(Tt):"unknown function"])}function ve(){return bt.length}function Ie(De,Ue,ht){dt.set(dt.subarray(Ue,Ue+ht),De)}function Ee(De){return t.___errno_location&&(pt[t.___errno_location()>>2]=De),De}function ze(De){Ye("OOM")}function Qe(De){try{var Ue=new ArrayBuffer(De);return Ue.byteLength!=De?void 0:(new Int8Array(Ue).set(bt),ne(Ue),Ft(Ue),1)}catch{}}function He(De){var Ue=ve(),ht=16777216,Tt=2147483648-ht;if(De>Tt)return!1;for(var o=16777216,ke=Math.max(Ue,o);ke<De;)ke<=536870912?ke=_t(2*ke,ht):ke=Math.min(_t((3*ke+2147483648)/4,ht),Tt);var ai=Qe(ke);return!!ai}var Ze=typeof atob=="function"?atob:function(De){var Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ht="",Tt,o,ke,ai,di,Ai,Kt,oi=0;De=De.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ai=Ue.indexOf(De.charAt(oi++)),di=Ue.indexOf(De.charAt(oi++)),Ai=Ue.indexOf(De.charAt(oi++)),Kt=Ue.indexOf(De.charAt(oi++)),Tt=ai<<2|di>>4,o=(di&15)<<4|Ai>>2,ke=(Ai&3)<<6|Kt,ht=ht+String.fromCharCode(Tt),Ai!==64&&(ht=ht+String.fromCharCode(o)),Kt!==64&&(ht=ht+String.fromCharCode(ke));while(oi<De.length);return ht};function Ve(De){try{for(var Ue=Ze(De),ht=new Uint8Array(Ue.length),Tt=0;Tt<Ue.length;++Tt)ht[Tt]=Ue.charCodeAt(Tt);return ht}catch{throw new Error("Converting base64 string to bytes failed.")}}function ft(De){if(On(De))return Ve(De.slice(pr.length))}var rt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Me={a:Ye,b:ce,c:oe,d:Ae,e:Ee,f:ve,g:Ie,h:He,i:ze,j:k,k:V,l:Qe,m:$,n:te,o:v,p:ci},se=function(De,Ue,ht){"almost asm";var Tt=new De.Int8Array(ht),o=new De.Int32Array(ht);new De.Uint8Array(ht),new De.Float32Array(ht);var ke=new De.Float64Array(ht),ai=Ue.o|0,di=Ue.p|0,Ai=De.Math.floor,Kt=De.Math.abs,oi=De.Math.sqrt,Ri=De.Math.pow,vi=De.Math.cos,wi=De.Math.sin,Yt=De.Math.tan,vn=De.Math.acos,ar=De.Math.asin,dn=De.Math.atan,Vn=De.Math.atan2,Hr=De.Math.ceil,Hi=De.Math.imul,lr=De.Math.min,Fn=De.Math.max,Qt=De.Math.clz32,Yi=Ue.b,Ut=Ue.c,En=Ue.d,ur=Ue.e,Ns=Ue.f,Vr=Ue.g,Vt=Ue.h,cr=Ue.i,Lt=24160;function Br(i){return Tt=new Int8Array(i),o=new Int32Array(i),ke=new Float64Array(i),ht=i,!0}function Vs(i){i=i|0;var r=0;return r=Lt,Lt=Lt+i|0,Lt=Lt+15&-16,r|0}function ua(){return Lt|0}function kr(i){i=i|0,Lt=i}function Fa(i,r){i=i|0,Lt=i}function zo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return(i|0)<0?(r=2,r|0):(i|0)>13780509?(r=or(15,r)|0,r|0):(l=((i|0)<0)<<31>>31,_=We(i|0,l|0,3,0)|0,d=Ut()|0,l=z(i|0,l|0,1,0)|0,l=We(_|0,d|0,l|0,Ut()|0)|0,l=z(l|0,Ut()|0,1,0)|0,i=Ut()|0,o[r>>2]=l,o[r+4>>2]=i,r=0,r|0)}function Oa(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,Xs(i,r,l,d,0)|0}function Xs(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0;if(j=Lt,Lt=Lt+16|0,T=j,!(jn(i,r,l,d,_)|0))return d=0,Lt=j,d|0;do if((l|0)>=0){if((l|0)>13780509){if(w=or(15,T)|0,w|0)break;B=T,T=o[B>>2]|0,B=o[B+4>>2]|0}else w=((l|0)<0)<<31>>31,Y=We(l|0,w|0,3,0)|0,B=Ut()|0,w=z(l|0,w|0,1,0)|0,w=We(Y|0,B|0,w|0,Ut()|0)|0,w=z(w|0,Ut()|0,1,0)|0,B=Ut()|0,o[T>>2]=w,o[T+4>>2]=B,T=w;if(O(d|0,0,T<<3|0)|0,_|0){O(_|0,0,T<<2|0)|0,w=aa(i,r,l,d,_,T,B,0)|0;break}w=D(T,4)|0,w?(Y=aa(i,r,l,d,w,T,B,0)|0,C(w),w=Y):w=13}else w=2;while(!1);return Y=w,Lt=j,Y|0}function jn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0;if($e=Lt,Lt=Lt+16|0,Re=$e,Be=$e+8|0,Te=Re,o[Te>>2]=i,o[Te+4>>2]=r,(l|0)<0)return Be=2,Lt=$e,Be|0;if(w=d,o[w>>2]=i,o[w+4>>2]=r,w=(_|0)!=0,w&&(o[_>>2]=0),Cr(i,r)|0)return Be=9,Lt=$e,Be|0;o[Be>>2]=0;e:do if((l|0)>=1)if(w)for(ue=1,Y=0,Se=0,Te=1,w=i;;){if(!(Y|Se)){if(w=ls(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,Cr(w,r)|0){w=9;break e}}if(w=ls(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ue<<3)|0,o[i>>2]=w,o[i+4>>2]=r,o[_+(ue<<2)>>2]=Te,i=Y+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,Cr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ue=ue+1|0,Y=T?0:i,Se=T?j?0:B:Se}else for(ue=1,Y=0,Se=0,Te=1,w=i;;){if(!(Y|Se)){if(w=ls(w,r,4,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,Cr(w,r)|0){w=9;break e}}if(w=ls(w,r,o[22384+(Se<<2)>>2]|0,Be,Re)|0,w|0)break e;if(r=Re,w=o[r>>2]|0,r=o[r+4>>2]|0,i=d+(ue<<3)|0,o[i>>2]=w,o[i+4>>2]=r,i=Y+1|0,T=(i|0)==(Te|0),B=Se+1|0,j=(B|0)==6,Cr(w,r)|0){w=9;break e}if(Te=Te+(j&T&1)|0,(Te|0)>(l|0)){w=0;break}else ue=ue+1|0,Y=T?0:i,Se=T?j?0:B:Se}else w=0;while(!1);return Be=w,Lt=$e,Be|0}function aa(i,r,l,d,_,w,T,B){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0,B=B|0;var j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0;if($e=Lt,Lt=Lt+16|0,Re=$e+8|0,Be=$e,j=Ct(i|0,r|0,w|0,T|0)|0,ue=Ut()|0,Se=d+(j<<3)|0,vt=Se,ot=o[vt>>2]|0,vt=o[vt+4>>2]|0,Y=(ot|0)==(i|0)&(vt|0)==(r|0),!((ot|0)==0&(vt|0)==0|Y))do j=z(j|0,ue|0,1,0)|0,j=yt(j|0,Ut()|0,w|0,T|0)|0,ue=Ut()|0,Se=d+(j<<3)|0,ot=Se,vt=o[ot>>2]|0,ot=o[ot+4>>2]|0,Y=(vt|0)==(i|0)&(ot|0)==(r|0);while(!((vt|0)==0&(ot|0)==0|Y));if(j=_+(j<<2)|0,Y&&(o[j>>2]|0)<=(B|0)||(ot=Se,o[ot>>2]=i,o[ot+4>>2]=r,o[j>>2]=B,(B|0)>=(l|0)))return ot=0,Lt=$e,ot|0;switch(Y=B+1|0,o[Re>>2]=0,j=ls(i,r,2,Re,Be)|0,j|0){case 9:{Te=9;break}case 0:{j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j||(Te=9);break}}e:do if((Te|0)==9){switch(o[Re>>2]=0,j=ls(i,r,3,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,1,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,5,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,4,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}switch(o[Re>>2]=0,j=ls(i,r,6,Re,Be)|0,j|0){case 9:break;case 0:{if(j=Be,j=aa(o[j>>2]|0,o[j+4>>2]|0,l,d,_,w,T,Y)|0,j|0)break e;break}default:break e}return ot=0,Lt=$e,ot|0}while(!1);return ot=j,Lt=$e,ot|0}function ls(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(l>>>0>6)return _=1,_|0;if(Se=(o[d>>2]|0)%6|0,o[d>>2]=Se,(Se|0)>0){w=0;do l=Ta(l)|0,w=w+1|0;while((w|0)<(o[d>>2]|0))}if(Se=Gt(i|0,r|0,45)|0,Ut()|0,ue=Se&127,ue>>>0>121)return _=5,_|0;j=wa(i,r)|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15;e:do if(!w)Y=8;else{for(;;){if(T=(15-w|0)*3|0,B=Gt(i|0,r|0,T|0)|0,Ut()|0,B=B&7,(B|0)==7){r=5;break}if(Be=(Gs(w)|0)==0,w=w+-1|0,Te=jt(7,0,T|0)|0,r=r&~(Ut()|0),Re=jt(o[(Be?432:16)+(B*28|0)+(l<<2)>>2]|0,0,T|0)|0,T=Ut()|0,l=o[(Be?640:224)+(B*28|0)+(l<<2)>>2]|0,i=Re|i&~Te,r=T|r,!l){l=0;break e}if(!w){Y=8;break e}}return r|0}while(!1);(Y|0)==8&&(Be=o[848+(ue*28|0)+(l<<2)>>2]|0,Re=jt(Be|0,0,45)|0,i=Re|i,r=Ut()|0|r&-1040385,l=o[4272+(ue*28|0)+(l<<2)>>2]|0,(Be&127|0)==127&&(Be=jt(o[848+(ue*28|0)+20>>2]|0,0,45)|0,r=Ut()|0|r&-1040385,l=o[4272+(ue*28|0)+20>>2]|0,i=Eo(Be|i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1)),B=Gt(i|0,r|0,45)|0,Ut()|0,B=B&127;e:do if(tt(B)|0){t:do if((wa(i,r)|0)==1){if((ue|0)!=(B|0))if(An(B,o[7696+(ue*28|0)>>2]|0)|0){i=Ao(i,r)|0,T=1,r=Ut()|0;break}else En(23313,22416,436,22424);switch(j|0){case 3:{i=Eo(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+1,T=0;break t}case 5:{i=Ao(i,r)|0,r=Ut()|0,o[d>>2]=(o[d>>2]|0)+5,T=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else T=0;while(!1);if((l|0)>0){w=0;do i=Tl(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}if((ue|0)!=(B|0)){if(!(It(B)|0)){if((T|0)!=0|(wa(i,r)|0)!=5)break;o[d>>2]=(o[d>>2]|0)+1;break}switch(Se&127){case 8:case 118:break e}(wa(i,r)|0)!=3&&(o[d>>2]=(o[d>>2]|0)+1)}}else if((l|0)>0){w=0;do i=Eo(i,r)|0,r=Ut()|0,w=w+1|0;while((w|0)!=(l|0))}while(!1);return o[d>>2]=((o[d>>2]|0)+l|0)%6|0,Be=_,o[Be>>2]=i,o[Be+4>>2]=r,Be=0,Be|0}function Na(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;for(B=Lt,Lt=Lt+16|0,w=B,T=B+8|0,_=(Cr(i,r)|0)==0,_=_?1:2;;){if(o[T>>2]=0,Y=(ls(i,r,_,T,w)|0)==0,j=w,Y&((o[j>>2]|0)==(l|0)?(o[j+4>>2]|0)==(d|0):0)){i=4;break}if(_=_+1|0,_>>>0>=7){_=7,i=4;break}}return(i|0)==4?(Lt=B,_|0):0}function rl(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(Be=Lt,Lt=Lt+16|0,Te=Be,Re=Be+8|0,Se=Te,o[Se>>2]=i,o[Se+4>>2]=r,!l)return Re=d,o[Re>>2]=i,o[Re+4>>2]=r,Re=0,Lt=Be,Re|0;o[Re>>2]=0;e:do if(Cr(i,r)|0)i=9;else{if(w=(l|0)>0,w){_=0,Se=i;do{if(i=ls(Se,r,4,Re,Te)|0,i|0)break e;if(r=Te,Se=o[r>>2]|0,r=o[r+4>>2]|0,_=_+1|0,Cr(Se,r)|0){i=9;break e}}while((_|0)<(l|0));if(ue=d,o[ue>>2]=Se,o[ue+4>>2]=r,ue=l+-1|0,w){Y=0,i=1;do{if(_=22384+(Y<<2)|0,(Y|0)==5)for(T=o[_>>2]|0,w=0,_=i;;){if(i=Te,i=ls(o[i>>2]|0,o[i+4>>2]|0,T,Re,Te)|0,i|0)break e;if((w|0)!=(ue|0))if(j=Te,B=o[j>>2]|0,j=o[j+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=B,o[i+4>>2]=j,!(Cr(B,j)|0))i=_+1|0;else{i=9;break e}else i=_;if(w=w+1|0,(w|0)>=(l|0))break;_=i}else for(T=Te,j=o[_>>2]|0,B=0,_=i,w=o[T>>2]|0,T=o[T+4>>2]|0;;){if(i=ls(w,T,j,Re,Te)|0,i|0)break e;if(T=Te,w=o[T>>2]|0,T=o[T+4>>2]|0,i=d+(_<<3)|0,o[i>>2]=w,o[i+4>>2]=T,i=_+1|0,Cr(w,T)|0){i=9;break e}if(B=B+1|0,(B|0)>=(l|0))break;_=i}Y=Y+1|0}while(Y>>>0<6);i=Te,T=Se,_=o[i>>2]|0,w=r,i=o[i+4>>2]|0}else T=Se,_=Se,w=r,i=r}else T=d,o[T>>2]=i,o[T+4>>2]=r,T=i,_=i,w=r,i=r;i=(T|0)==(_|0)&(w|0)==(i|0)?0:9}while(!1);return Re=i,Lt=Be,Re|0}function sl(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;if(B=Lt,Lt=Lt+48|0,_=B+16|0,w=B+8|0,T=B,l|0)return T=15,Lt=B,T|0;if(Y=i,j=o[Y+4>>2]|0,l=w,o[l>>2]=o[Y>>2],o[l+4>>2]=j,Ru(w,_),r=pl(_,r,T)|0,!r){if(l=o[w>>2]|0,w=o[i+8>>2]|0,(w|0)>0){_=o[i+12>>2]|0,r=0;do l=(o[_+(r<<3)>>2]|0)+l|0,r=r+1|0;while((r|0)<(w|0))}r=T,_=o[r>>2]|0,r=o[r+4>>2]|0,w=((l|0)<0)<<31>>31,(r|0)<(w|0)|(r|0)==(w|0)&_>>>0<l>>>0?(r=T,o[r>>2]=l,o[r+4>>2]=w,r=w):l=_,j=z(l|0,r|0,12,0)|0,Y=Ut()|0,r=T,o[r>>2]=j,o[r+4>>2]=Y,r=d,o[r>>2]=j,o[r+4>>2]=Y,r=0}return Y=r,Lt=B,Y|0}function Ja(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0,si=0,ji=0,Zi=0,Ii=0,Vi=0,Ui=0,an=0,Bn=0,Ji=0,Cn=0,yr=0,er=0;if(Bn=Lt,Lt=Lt+64|0,Ii=Bn+48|0,Vi=Bn+32|0,Ui=Bn+24|0,ri=Bn+8|0,Xt=Bn,j=o[i>>2]|0,(j|0)<=0)return an=0,Lt=Bn,an|0;for(Jt=i+4|0,si=Ii+8|0,ji=Vi+8|0,Zi=ri+8|0,B=0,Et=0;;){Y=o[Jt>>2]|0,ct=Y+(Et<<4)|0,o[Ii>>2]=o[ct>>2],o[Ii+4>>2]=o[ct+4>>2],o[Ii+8>>2]=o[ct+8>>2],o[Ii+12>>2]=o[ct+12>>2],(Et|0)==(j+-1|0)?(o[Vi>>2]=o[Y>>2],o[Vi+4>>2]=o[Y+4>>2],o[Vi+8>>2]=o[Y+8>>2],o[Vi+12>>2]=o[Y+12>>2]):(ct=Y+(Et+1<<4)|0,o[Vi>>2]=o[ct>>2],o[Vi+4>>2]=o[ct+4>>2],o[Vi+8>>2]=o[ct+8>>2],o[Vi+12>>2]=o[ct+12>>2]),j=Ur(Ii,Vi,d,Ui)|0;e:do if(j)Y=0,B=j;else if(Y=Ui,j=o[Y>>2]|0,Y=o[Y+4>>2]|0,(Y|0)>0|(Y|0)==0&j>>>0>0){ot=0,ct=0;t:for(;;){if(er=+ke[Ii>>3],vt=R(j|0,Y|0,ot|0,ct|0)|0,yr=+(vt>>>0)+4294967296*+(Ut()|0),Ji=+(j>>>0)+4294967296*+(Y|0),Cn=+(ot>>>0)+4294967296*+(ct|0),ke[ri>>3]=er*yr/Ji+ +ke[Vi>>3]*Cn/Ji,ke[Zi>>3]=+ke[si>>3]*yr/Ji+ +ke[ji>>3]*Cn/Ji,j=Qa(ri,d,Xt)|0,j|0){B=j;break}vt=Xt,$e=o[vt>>2]|0,vt=o[vt+4>>2]|0,Te=Ct($e|0,vt|0,r|0,l|0)|0,ue=Ut()|0,j=T+(Te<<3)|0,Se=j,Y=o[Se>>2]|0,Se=o[Se+4>>2]|0;i:do if((Y|0)==0&(Se|0)==0)wt=j,an=16;else for(Re=0,Be=0;;){if((Re|0)>(l|0)|(Re|0)==(l|0)&Be>>>0>r>>>0){B=1;break t}if((Y|0)==($e|0)&(Se|0)==(vt|0))break i;if(j=z(Te|0,ue|0,1,0)|0,Te=yt(j|0,Ut()|0,r|0,l|0)|0,ue=Ut()|0,Be=z(Be|0,Re|0,1,0)|0,Re=Ut()|0,j=T+(Te<<3)|0,Se=j,Y=o[Se>>2]|0,Se=o[Se+4>>2]|0,(Y|0)==0&(Se|0)==0){wt=j,an=16;break}}while(!1);if((an|0)==16&&(an=0,!(($e|0)==0&(vt|0)==0))&&(Be=wt,o[Be>>2]=$e,o[Be+4>>2]=vt,Be=w+(o[_>>2]<<3)|0,o[Be>>2]=$e,o[Be+4>>2]=vt,Be=_,Be=z(o[Be>>2]|0,o[Be+4>>2]|0,1,0)|0,$e=Ut()|0,vt=_,o[vt>>2]=Be,o[vt+4>>2]=$e),ot=z(ot|0,ct|0,1,0)|0,ct=Ut()|0,Y=Ui,j=o[Y>>2]|0,Y=o[Y+4>>2]|0,!((Y|0)>(ct|0)|(Y|0)==(ct|0)&j>>>0>ot>>>0)){Y=1;break e}}Y=0}else Y=1;while(!1);if(Et=Et+1|0,!Y){an=21;break}if(j=o[i>>2]|0,(Et|0)>=(j|0)){B=0,an=21;break}}return(an|0)==21?(Lt=Bn,B|0):0}function Va(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0,si=0,ji=0,Zi=0,Ii=0,Vi=0,Ui=0,an=0,Bn=0,Ji=0,Cn=0,yr=0;if(yr=Lt,Lt=Lt+112|0,an=yr+80|0,j=yr+72|0,Bn=yr,Ji=yr+56|0,l|0)return Cn=15,Lt=yr,Cn|0;if(Y=i+8|0,Cn=Ps((o[Y>>2]<<5)+32|0)|0,!Cn)return Cn=13,Lt=yr,Cn|0;if(Vl(i,Cn),Vi=i,Ui=o[Vi+4>>2]|0,l=j,o[l>>2]=o[Vi>>2],o[l+4>>2]=Ui,Ru(j,an),l=pl(an,r,Bn)|0,l)Vi=0,Ui=0;else{if(l=o[j>>2]|0,w=o[Y>>2]|0,(w|0)>0){T=o[i+12>>2]|0,_=0;do l=(o[T+(_<<3)>>2]|0)+l|0,_=_+1|0;while((_|0)!=(w|0));_=l}else _=l;l=Bn,w=o[l>>2]|0,l=o[l+4>>2]|0,T=((_|0)<0)<<31>>31,(l|0)<(T|0)|(l|0)==(T|0)&w>>>0<_>>>0?(l=Bn,o[l>>2]=_,o[l+4>>2]=T,l=T):_=w,Vi=z(_|0,l|0,12,0)|0,Ui=Ut()|0,l=Bn,o[l>>2]=Vi,o[l+4>>2]=Ui,l=0}if(l|0)return C(Cn),Cn=l,Lt=yr,Cn|0;if(_=D(Vi,8)|0,!_)return C(Cn),Cn=13,Lt=yr,Cn|0;if(B=D(Vi,8)|0,!B)return C(Cn),C(_),Cn=13,Lt=yr,Cn|0;Zi=an,o[Zi>>2]=0,o[Zi+4>>2]=0,Zi=i,Ii=o[Zi+4>>2]|0,l=j,o[l>>2]=o[Zi>>2],o[l+4>>2]=Ii,l=Ja(j,Vi,Ui,r,an,_,B)|0;e:do if(l)C(_),C(B),C(Cn);else{t:do if((o[Y>>2]|0)>0){for(T=i+12|0,w=0;l=Ja((o[T>>2]|0)+(w<<3)|0,Vi,Ui,r,an,_,B)|0,w=w+1|0,!(l|0);)if((w|0)>=(o[Y>>2]|0))break t;C(_),C(B),C(Cn);break e}while(!1);(Ui|0)>0|(Ui|0)==0&Vi>>>0>0&&O(B|0,0,Vi<<3|0)|0,Ii=an,Zi=o[Ii+4>>2]|0;t:do if((Zi|0)>0|(Zi|0)==0&(o[Ii>>2]|0)>>>0>0){Jt=_,si=B,ji=_,Zi=B,Ii=_,l=_,wt=_,ri=B,Xt=B,_=B;i:for(;;){for(vt=0,ot=0,ct=0,Et=0,w=0,T=0;;){B=Bn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));if(r=Jt+(vt<<3)|0,Y=o[r>>2]|0,r=o[r+4>>2]|0,jn(Y,r,1,Bn,0)|0){B=Bn,j=B+56|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));B=D(7,4)|0,B|0&&(aa(Y,r,1,Bn,B,7,0,0)|0,C(B))}for($e=0;;){Be=Bn+($e<<3)|0,Re=o[Be>>2]|0,Be=o[Be+4>>2]|0;n:do if((Re|0)==0&(Be|0)==0)B=w,j=T;else{if(ue=Ct(Re|0,Be|0,Vi|0,Ui|0)|0,Y=Ut()|0,B=d+(ue<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0,!((j|0)==0&(r|0)==0)){Se=0,Te=0;do{if((Se|0)>(Ui|0)|(Se|0)==(Ui|0)&Te>>>0>Vi>>>0)break i;if((j|0)==(Re|0)&(r|0)==(Be|0)){B=w,j=T;break n}B=z(ue|0,Y|0,1,0)|0,ue=yt(B|0,Ut()|0,Vi|0,Ui|0)|0,Y=Ut()|0,Te=z(Te|0,Se|0,1,0)|0,Se=Ut()|0,B=d+(ue<<3)|0,r=B,j=o[r>>2]|0,r=o[r+4>>2]|0}while(!((j|0)==0&(r|0)==0))}(Re|0)==0&(Be|0)==0?(B=w,j=T):(mr(Re,Be,Ji)|0,yl(i,Cn,Ji)|0&&(Te=z(w|0,T|0,1,0)|0,T=Ut()|0,Se=B,o[Se>>2]=Re,o[Se+4>>2]=Be,w=si+(w<<3)|0,o[w>>2]=Re,o[w+4>>2]=Be,w=Te),B=w,j=T)}while(!1);if($e=$e+1|0,$e>>>0>=7)break;w=B,T=j}if(vt=z(vt|0,ot|0,1,0)|0,ot=Ut()|0,ct=z(ct|0,Et|0,1,0)|0,Et=Ut()|0,T=an,w=o[T>>2]|0,T=o[T+4>>2]|0,(Et|0)<(T|0)|(Et|0)==(T|0)&ct>>>0<w>>>0)w=B,T=j;else break}if((T|0)>0|(T|0)==0&w>>>0>0){w=0,T=0;do Et=Jt+(w<<3)|0,o[Et>>2]=0,o[Et+4>>2]=0,w=z(w|0,T|0,1,0)|0,T=Ut()|0,Et=an,ct=o[Et+4>>2]|0;while((T|0)<(ct|0)|((T|0)==(ct|0)?w>>>0<(o[Et>>2]|0)>>>0:0))}if(Et=an,o[Et>>2]=B,o[Et+4>>2]=j,(j|0)>0|(j|0)==0&B>>>0>0)$e=_,vt=Xt,ot=Ii,ct=ri,Et=si,_=wt,Xt=l,ri=ji,wt=$e,l=vt,Ii=Zi,Zi=ot,ji=ct,si=Jt,Jt=Et;else break t}C(ji),C(Zi),C(Cn),l=1;break e}else l=B;while(!1);C(Cn),C(_),C(l),l=0}while(!1);return Cn=l,Lt=yr,Cn|0}function N(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0;if(ue=Lt,Lt=Lt+176|0,j=ue,(r|0)<1)return _u(l,0,0),Y=0,Lt=ue,Y|0;for(B=i,B=Gt(o[B>>2]|0,o[B+4>>2]|0,52)|0,Ut()|0,_u(l,(r|0)>6?r:6,B&15),B=0;d=i+(B<<3)|0,d=Rr(o[d>>2]|0,o[d+4>>2]|0,j)|0,!(d|0);){if(d=o[j>>2]|0,(d|0)>0){T=0;do w=j+8+(T<<4)|0,T=T+1|0,d=j+8+(((T|0)%(d|0)|0)<<4)|0,_=ys(l,d,w)|0,_?Mi(l,_)|0:zi(l,w,d)|0,d=o[j>>2]|0;while((T|0)<(d|0))}if(B=B+1|0,(B|0)>=(r|0)){d=0,Y=13;break}}return(Y|0)==13?(Lt=ue,d|0):(_s(l),Y=d,Lt=ue,Y|0)}function xe(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=Lt,Lt=Lt+32|0,d=w,_=w+16|0,i=N(i,r,_)|0,i|0)return l=i,Lt=w,l|0;if(o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,i=Co(_)|0,i|0)do{r=Qu(l)|0;do zu(r,i)|0,T=i+16|0,o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],o[d+12>>2]=o[T+12>>2],Mi(_,i)|0,i=yu(_,d)|0;while(i|0);i=Co(_)|0}while(i|0);return _s(_),i=Ml(l)|0,i?(mo(l),T=i,Lt=w,T|0):(T=0,Lt=w,T|0)}function tt(i){return i=i|0,i>>>0>121?(i=0,i|0):(i=o[7696+(i*28|0)+16>>2]|0,i|0)}function It(i){return i=i|0,(i|0)==4|(i|0)==117|0}function Wt(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)>>2]|0}function Si(i){return i=i|0,o[11120+((o[i>>2]|0)*216|0)+((o[i+4>>2]|0)*72|0)+((o[i+8>>2]|0)*24|0)+(o[i+12>>2]<<3)+4>>2]|0}function Bi(i,r){i=i|0,r=r|0,i=7696+(i*28|0)|0,o[r>>2]=o[i>>2],o[r+4>>2]=o[i+4>>2],o[r+8>>2]=o[i+8>>2],o[r+12>>2]=o[i+12>>2]}function un(i,r){i=i|0,r=r|0;var l=0,d=0;if(r>>>0>20)return r=-1,r|0;do if((o[11120+(r*216|0)>>2]|0)!=(i|0))if((o[11120+(r*216|0)+8>>2]|0)!=(i|0))if((o[11120+(r*216|0)+16>>2]|0)!=(i|0))if((o[11120+(r*216|0)+24>>2]|0)!=(i|0))if((o[11120+(r*216|0)+32>>2]|0)!=(i|0))if((o[11120+(r*216|0)+40>>2]|0)!=(i|0))if((o[11120+(r*216|0)+48>>2]|0)!=(i|0))if((o[11120+(r*216|0)+56>>2]|0)!=(i|0))if((o[11120+(r*216|0)+64>>2]|0)!=(i|0))if((o[11120+(r*216|0)+72>>2]|0)!=(i|0))if((o[11120+(r*216|0)+80>>2]|0)!=(i|0))if((o[11120+(r*216|0)+88>>2]|0)!=(i|0))if((o[11120+(r*216|0)+96>>2]|0)!=(i|0))if((o[11120+(r*216|0)+104>>2]|0)!=(i|0))if((o[11120+(r*216|0)+112>>2]|0)!=(i|0))if((o[11120+(r*216|0)+120>>2]|0)!=(i|0))if((o[11120+(r*216|0)+128>>2]|0)!=(i|0))if((o[11120+(r*216|0)+136>>2]|0)==(i|0))i=2,l=1,d=2;else{if((o[11120+(r*216|0)+144>>2]|0)==(i|0)){i=0,l=2,d=0;break}if((o[11120+(r*216|0)+152>>2]|0)==(i|0)){i=0,l=2,d=1;break}if((o[11120+(r*216|0)+160>>2]|0)==(i|0)){i=0,l=2,d=2;break}if((o[11120+(r*216|0)+168>>2]|0)==(i|0)){i=1,l=2,d=0;break}if((o[11120+(r*216|0)+176>>2]|0)==(i|0)){i=1,l=2,d=1;break}if((o[11120+(r*216|0)+184>>2]|0)==(i|0)){i=1,l=2,d=2;break}if((o[11120+(r*216|0)+192>>2]|0)==(i|0)){i=2,l=2,d=0;break}if((o[11120+(r*216|0)+200>>2]|0)==(i|0)){i=2,l=2,d=1;break}if((o[11120+(r*216|0)+208>>2]|0)==(i|0)){i=2,l=2,d=2;break}else i=-1;return i|0}else i=2,l=1,d=1;else i=2,l=1,d=0;else i=1,l=1,d=2;else i=1,l=1,d=1;else i=1,l=1,d=0;else i=0,l=1,d=2;else i=0,l=1,d=1;else i=0,l=1,d=0;else i=2,l=0,d=2;else i=2,l=0,d=1;else i=2,l=0,d=0;else i=1,l=0,d=2;else i=1,l=0,d=1;else i=1,l=0,d=0;else i=0,l=0,d=2;else i=0,l=0,d=1;else i=0,l=0,d=0;while(!1);return r=o[11120+(r*216|0)+(l*72|0)+(i*24|0)+(d<<3)+4>>2]|0,r|0}function An(i,r){return i=i|0,r=r|0,(o[7696+(i*28|0)+20>>2]|0)==(r|0)?(r=1,r|0):(r=(o[7696+(i*28|0)+24>>2]|0)==(r|0),r|0)}function rr(i,r){return i=i|0,r=r|0,o[848+(i*28|0)+(r<<2)>>2]|0}function hr(i,r){return i=i|0,r=r|0,(o[848+(i*28|0)>>2]|0)==(r|0)?(r=0,r|0):(o[848+(i*28|0)+4>>2]|0)==(r|0)?(r=1,r|0):(o[848+(i*28|0)+8>>2]|0)==(r|0)?(r=2,r|0):(o[848+(i*28|0)+12>>2]|0)==(r|0)?(r=3,r|0):(o[848+(i*28|0)+16>>2]|0)==(r|0)?(r=4,r|0):(o[848+(i*28|0)+20>>2]|0)==(r|0)?(r=5,r|0):((o[848+(i*28|0)+24>>2]|0)==(r|0)?6:7)|0}function zr(){return 122}function Ua(i){i=i|0;var r=0,l=0,d=0;r=0;do jt(r|0,0,45)|0,d=Ut()|0|134225919,l=i+(r<<3)|0,o[l>>2]=-1,o[l+4>>2]=d,r=r+1|0;while((r|0)!=122);return 0}function Ga(i){return i=i|0,+ke[i+16>>3]<+ke[i+24>>3]|0}function qa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return l=+ke[r>>3],!(l>=+ke[i+8>>3])||!(l<=+ke[i>>3])?(r=0,r|0):(d=+ke[i+16>>3],l=+ke[i+24>>3],_=+ke[r+8>>3],r=_>=l,i=_<=d&1,d<l?r&&(i=1):r||(i=0),r=(i|0)!=0,r|0)}function pl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0;Be=Lt,Lt=Lt+288|0,ue=Be+264|0,Se=Be+96|0,Y=Be,B=Y,j=B+96|0;do o[B>>2]=0,B=B+4|0;while((B|0)<(j|0));return r=Sa(r,Y)|0,r|0?(Re=r,Lt=Be,Re|0):(j=Y,Y=o[j>>2]|0,j=o[j+4>>2]|0,mr(Y,j,ue)|0,Rr(Y,j,Se)|0,T=+Ni(ue,Se+8|0),ke[ue>>3]=+ke[i>>3],j=ue+8|0,ke[j>>3]=+ke[i+16>>3],ke[Se>>3]=+ke[i+8>>3],Y=Se+8|0,ke[Y>>3]=+ke[i+24>>3],_=+Ni(ue,Se),vt=+ke[j>>3]-+ke[Y>>3],w=+Kt(+vt),$e=+ke[ue>>3]-+ke[Se>>3],d=+Kt(+$e),!(vt==0|$e==0)&&(vt=+Z(+w,+d),vt=+Hr(+(_*_/+A(+(vt/+A(+w,+d)),3)/(T*(T*2.59807621135)*.8))),ke[ai>>3]=vt,Te=~~vt>>>0,Re=+Kt(vt)>=1?vt>0?~~+lr(+Ai(vt/4294967296),4294967295)>>>0:~~+Hr((vt-+(~~vt>>>0))/4294967296)>>>0:0,(o[ai+4>>2]&2146435072|0)!=2146435072)?(Se=(Te|0)==0&(Re|0)==0,r=l,o[r>>2]=Se?1:Te,o[r+4>>2]=Se?0:Re,r=0):r=1,Re=r,Lt=Be,Re|0)}function Ur(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0;Y=Lt,Lt=Lt+288|0,T=Y+264|0,B=Y+96|0,j=Y,_=j,w=_+96|0;do o[_>>2]=0,_=_+4|0;while((_|0)<(w|0));return l=Sa(l,j)|0,l|0?(d=l,Lt=Y,d|0):(l=j,_=o[l>>2]|0,l=o[l+4>>2]|0,mr(_,l,T)|0,Rr(_,l,B)|0,ue=+Ni(T,B+8|0),ue=+Hr(+(+Ni(i,r)/(ue*2))),ke[ai>>3]=ue,l=~~ue>>>0,_=+Kt(ue)>=1?ue>0?~~+lr(+Ai(ue/4294967296),4294967295)>>>0:~~+Hr((ue-+(~~ue>>>0))/4294967296)>>>0:0,(o[ai+4>>2]&2146435072|0)==2146435072?(d=1,Lt=Y,d|0):(j=(l|0)==0&(_|0)==0,o[d>>2]=j?1:l,o[d+4>>2]=j?0:_,d=0,Lt=Y,d|0))}function ir(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0,o[i>>2]=r,o[i+4>>2]=l,o[i+8>>2]=d}function wr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0;Se=r+8|0,o[Se>>2]=0,j=+ke[i>>3],T=+Kt(+j),Y=+ke[i+8>>3],B=+Kt(+Y)/.8660254037844386,T=T+B*.5,l=~~T,i=~~B,T=T-+(l|0),B=B-+(i|0);do if(T<.5)if(T<.3333333333333333)if(o[r>>2]=l,B<(T+1)*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}else if(Te=1-T,i=(!(B<Te)&1)+i|0,o[r+4>>2]=i,Te<=B&B<T*2){l=l+1|0,o[r>>2]=l;break}else{o[r>>2]=l;break}else{if(!(T<.6666666666666666))if(l=l+1|0,o[r>>2]=l,B<T*.5){o[r+4>>2]=i;break}else{i=i+1|0,o[r+4>>2]=i;break}if(B<1-T){if(o[r+4>>2]=i,T*2+-1<B){o[r>>2]=l;break}}else i=i+1|0,o[r+4>>2]=i;l=l+1|0,o[r>>2]=l}while(!1);do if(j<0)if(i&1){ue=(i+1|0)/2|0,ue=R(l|0,((l|0)<0)<<31>>31|0,ue|0,((ue|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-((+(ue>>>0)+4294967296*+(Ut()|0))*2+1)),o[r>>2]=l;break}else{ue=(i|0)/2|0,ue=R(l|0,((l|0)<0)<<31>>31|0,ue|0,((ue|0)<0)<<31>>31|0)|0,l=~~(+(l|0)-(+(ue>>>0)+4294967296*+(Ut()|0))*2),o[r>>2]=l;break}while(!1);ue=r+4|0,Y<0&&(l=l-((i<<1|1|0)/2|0)|0,o[r>>2]=l,i=0-i|0,o[ue>>2]=i),d=i-l|0,(l|0)<0?(_=0-l|0,o[ue>>2]=d,o[Se>>2]=_,o[r>>2]=0,i=d,l=0):_=0,(i|0)<0&&(l=l-i|0,o[r>>2]=l,_=_-i|0,o[Se>>2]=_,o[ue>>2]=0,i=0),w=l-_|0,d=i-_|0,(_|0)<0&&(o[r>>2]=w,o[ue>>2]=d,o[Se>>2]=0,i=d,l=w,_=0),d=(i|0)<(l|0)?i:l,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[r>>2]=l-d,o[ue>>2]=i-d,o[Se>>2]=_-d)}function Mr(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,(r|0)<0&&(l=l-r|0,o[T>>2]=l,w=i+8|0,o[w>>2]=(o[w>>2]|0)-r,o[i>>2]=0,r=0),(l|0)<0?(r=r-l|0,o[i>>2]=r,w=i+8|0,_=(o[w>>2]|0)-l|0,o[w>>2]=_,o[T>>2]=0,l=0):(_=i+8|0,w=_,_=o[_>>2]|0),(_|0)<0&&(r=r-_|0,o[i>>2]=r,l=l-_|0,o[T>>2]=l,o[w>>2]=0,_=0),d=(l|0)<(r|0)?l:r,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(o[i>>2]=r-d,o[T>>2]=l-d,o[w>>2]=_-d)}function js(i,r){i=i|0,r=r|0;var l=0,d=0;d=o[i+8>>2]|0,l=+((o[i+4>>2]|0)-d|0),ke[r>>3]=+((o[i>>2]|0)-d|0)-l*.5,ke[r+8>>3]=l*.8660254037844386}function vr(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[r>>2]|0)+(o[i>>2]|0),o[l+4>>2]=(o[r+4>>2]|0)+(o[i+4>>2]|0),o[l+8>>2]=(o[r+8>>2]|0)+(o[i+8>>2]|0)}function Ks(i,r,l){i=i|0,r=r|0,l=l|0,o[l>>2]=(o[i>>2]|0)-(o[r>>2]|0),o[l+4>>2]=(o[i+4>>2]|0)-(o[r+4>>2]|0),o[l+8>>2]=(o[i+8>>2]|0)-(o[r+8>>2]|0)}function Pr(i,r){i=i|0,r=r|0;var l=0,d=0;l=Hi(o[i>>2]|0,r)|0,o[i>>2]=l,l=i+4|0,d=Hi(o[l>>2]|0,r)|0,o[l>>2]=d,i=i+8|0,r=Hi(o[i>>2]|0,r)|0,o[i>>2]=r}function bo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=o[i>>2]|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(w?0-d|0:0)+((o[i+8>>2]|0)-(B?T:0))|0,l=(_|0)<0,i=l?0:_,r=(w?0:d)-(l?_:0)|0,_=(B?0:T)-(w?d:0)-(l?_:0)|0,l=(r|0)<(_|0)?r:_,l=(i|0)<(l|0)?i:l,d=(l|0)>0,i=i-(d?l:0)|0,r=r-(d?l:0)|0;e:do switch(_-(d?l:0)|0){case 0:switch(r|0){case 0:return B=i|0?(i|0)==1?1:7:0,B|0;case 1:return B=i|0?(i|0)==1?3:7:2,B|0;default:break e}case 1:switch(r|0){case 0:return B=i|0?(i|0)==1?5:7:4,B|0;case 1:{if(!i)i=6;else break e;return i|0}default:break e}}while(!1);return B=7,B|0}function Ho(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0)||(2147483647-(w<<1)|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0)||(-2147483648-(w<<1)|0)>(w|0))return B=1,B|0;if(r=w*3|0,(_|0)>0){if((2147483647-_|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0))return B=1,B|0;if(d=_<<1,(w|0)>-1){if((r|-2147483648|0)>=(_|0))return B=1,B|0}else if((r^-2147483648|0)<(_|0))return B=1,B|0;if(l){if((2147483647-w|0)<(d|0))r=1;else{l=d;break}return r|0}else{if((-2147483648-w|0)>(d|0))r=1;else{l=d;break}return r|0}}else l=_<<1,r=w*3|0;while(!1);d=ul(+(r-_|0)/7)|0,o[i>>2]=d,_=ul(+(l+w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;En(23313,22444,355,22455)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&En(23313,22444,355,22455),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;En(23313,22444,355,22455)}else{if((r^-2147483648|0)>=(l|0))break;En(23313,22444,355,22455)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Ls(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,_=o[T>>2]|0,w=(o[i>>2]|0)-_|0,B=i+4|0,_=(o[B>>2]|0)-_|0;do if(w>>>0>715827881|_>>>0>715827881){if(l=(w|0)>0,l){if((2147483647-w|0)<(w|0))return B=1,B|0}else if((-2147483648-w|0)>(w|0))return B=1,B|0;if(r=w<<1,(_|0)>0){if((2147483647-_|0)<(_|0)||(2147483647-(_<<1)|0)<(_|0))return B=1,B|0}else if((-2147483648-_|0)>(_|0)||(-2147483648-(_<<1)|0)>(_|0))return B=1,B|0;if(d=_*3|0,l){if((2147483647-r|0)<(_|0))return B=1,B|0}else if((-2147483648-r|0)>(_|0))return B=1,B|0;if((_|0)>-1){if((d|-2147483648|0)<(w|0)){l=d;break}else r=1;return r|0}else{if((d^-2147483648|0)<(w|0))r=1;else{l=d;break}return r|0}}else l=_*3|0,r=w<<1;while(!1);d=ul(+(r+_|0)/7)|0,o[i>>2]=d,_=ul(+(l-w|0)/7)|0,o[B>>2]=_,o[T>>2]=0,l=(_|0)<(d|0),r=l?d:_,l=l?_:d;do if((l|0)<0){if((r|0)>0){if((r|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-r|0)>=(l|0)))break;En(23313,22444,404,22469)}if((l|0)==-2147483648|(-2147483648-r|0)>(l|0)&&En(23313,22444,404,22469),(r|0)>-1){if((r|-2147483648|0)<(l|0))break;En(23313,22444,404,22469)}else{if((r^-2147483648|0)>=(l|0))break;En(23313,22444,404,22469)}}while(!1);return r=_-d|0,(d|0)<0?(l=0-d|0,o[B>>2]=r,o[T>>2]=l,o[i>>2]=0,d=0):(r=_,l=0),(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(B=0,B|0):(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d,B=0,B|0)}function Il(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=ul(+((r*3|0)-l|0)/7)|0,o[i>>2]=d,r=ul(+((l<<1)+r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function ho(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;T=i+8|0,l=o[T>>2]|0,r=(o[i>>2]|0)-l|0,B=i+4|0,l=(o[B>>2]|0)-l|0,d=ul(+((r<<1)+l|0)/7)|0,o[i>>2]=d,r=ul(+((l*3|0)-r|0)/7)|0,o[B>>2]=r,o[T>>2]=0,l=r-d|0,(d|0)<0?(w=0-d|0,o[B>>2]=l,o[T>>2]=w,o[i>>2]=0,r=l,d=0,l=w):l=0,(r|0)<0&&(d=d-r|0,o[i>>2]=d,l=l-r|0,o[T>>2]=l,o[B>>2]=0,r=0),w=d-l|0,_=r-l|0,(l|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,r=_,_=w,l=0):_=d,d=(r|0)<(_|0)?r:_,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(o[i>>2]=_-d,o[B>>2]=r-d,o[T>>2]=l-d)}function jo(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r*3|0)|0,o[i>>2]=_,l=d+(l*3|0)|0,o[T>>2]=l,r=(d*3|0)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function ca(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r*3|0)+_|0,_=l+(_*3|0)|0,o[i>>2]=_,o[T>>2]=d,r=(l*3|0)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function Ys(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;(r+-1|0)>>>0>=6||(_=(o[15440+(r*12|0)>>2]|0)+(o[i>>2]|0)|0,o[i>>2]=_,B=i+4|0,d=(o[15440+(r*12|0)+4>>2]|0)+(o[B>>2]|0)|0,o[B>>2]=d,T=i+8|0,r=(o[15440+(r*12|0)+8>>2]|0)+(o[T>>2]|0)|0,o[T>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[B>>2]=l,o[T>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[T>>2]=r,o[B>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[B>>2]=_,o[T>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[B>>2]=_-l,o[T>>2]=r-l))}function El(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=r+_|0,_=l+_|0,o[i>>2]=_,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Ha(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,d=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,_=d+r|0,o[i>>2]=_,d=l+d|0,o[T>>2]=d,r=l+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,d=0):(l=d,d=_),(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function Ta(i){switch(i=i|0,i|0){case 1:{i=5;break}case 5:{i=4;break}case 4:{i=6;break}case 6:{i=2;break}case 2:{i=3;break}case 3:{i=1;break}}return i|0}function ml(i){switch(i=i|0,i|0){case 1:{i=3;break}case 3:{i=2;break}case 2:{i=6;break}case 6:{i=4;break}case 4:{i=5;break}case 5:{i=1;break}}return i|0}function Cl(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;r=o[i>>2]|0,T=i+4|0,l=o[T>>2]|0,B=i+8|0,d=o[B>>2]|0,_=l+(r<<1)|0,o[i>>2]=_,l=d+(l<<1)|0,o[T>>2]=l,r=(d<<1)+r|0,o[B>>2]=r,d=l-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=d,o[B>>2]=r,o[i>>2]=0,l=d,d=0):d=_,(l|0)<0&&(d=d-l|0,o[i>>2]=d,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=d-r|0,_=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=_,o[B>>2]=0,d=w,r=0):_=l,l=(_|0)<(d|0)?_:d,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=d-l,o[T>>2]=_-l,o[B>>2]=r-l)}function pu(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=o[i>>2]|0,T=i+4|0,r=o[T>>2]|0,B=i+8|0,l=o[B>>2]|0,d=(r<<1)+_|0,_=l+(_<<1)|0,o[i>>2]=_,o[T>>2]=d,r=(l<<1)+r|0,o[B>>2]=r,l=d-_|0,(_|0)<0?(r=r-_|0,o[T>>2]=l,o[B>>2]=r,o[i>>2]=0,_=0):l=d,(l|0)<0&&(_=_-l|0,o[i>>2]=_,r=r-l|0,o[B>>2]=r,o[T>>2]=0,l=0),w=_-r|0,d=l-r|0,(r|0)<0?(o[i>>2]=w,o[T>>2]=d,o[B>>2]=0,_=w,r=0):d=l,l=(d|0)<(_|0)?d:_,l=(r|0)<(l|0)?r:l,!((l|0)<=0)&&(o[i>>2]=_-l,o[T>>2]=d-l,o[B>>2]=r-l)}function us(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;return T=(o[i>>2]|0)-(o[r>>2]|0)|0,B=(T|0)<0,d=(o[i+4>>2]|0)-(o[r+4>>2]|0)-(B?T:0)|0,w=(d|0)<0,_=(B?0-T|0:0)+(o[i+8>>2]|0)-(o[r+8>>2]|0)+(w?0-d|0:0)|0,i=(_|0)<0,r=i?0:_,l=(w?0:d)-(i?_:0)|0,_=(B?0:T)-(w?d:0)-(i?_:0)|0,i=(l|0)<(_|0)?l:_,i=(r|0)<(i|0)?r:i,d=(i|0)>0,r=r-(d?i:0)|0,l=l-(d?i:0)|0,i=_-(d?i:0)|0,i=(i|0)>-1?i:0-i|0,l=(l|0)>-1?l:0-l|0,r=(r|0)>-1?r:0-r|0,r=(l|0)>(r|0)?l:r,((i|0)>(r|0)?i:r)|0}function sc(i,r){i=i|0,r=r|0;var l=0;l=o[i+8>>2]|0,o[r>>2]=(o[i>>2]|0)-l,o[r+4>>2]=(o[i+4>>2]|0)-l}function eo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;d=o[i>>2]|0,o[r>>2]=d,_=o[i+4>>2]|0,T=r+4|0,o[T>>2]=_,B=r+8|0,o[B>>2]=0,l=(_|0)<(d|0),i=l?d:_,l=l?_:d;do if((l|0)<0){if((i|0)>0){if((i|-2147483648|0)<(l|0)&((l|0)!=-2147483648&(2147483647-i|0)>=(l|0)))break;return i=1,i|0}if((l|0)==-2147483648|(-2147483648-i|0)>(l|0))return r=1,r|0;if((i|0)>-1){if((i|-2147483648|0)<(l|0))break;return i=1,i|0}else{if((i^-2147483648|0)<(l|0))i=1;else break;return i|0}}while(!1);return i=_-d|0,(d|0)<0?(l=0-d|0,o[T>>2]=i,o[B>>2]=l,o[r>>2]=0,d=0):(i=_,l=0),(i|0)<0&&(d=d-i|0,o[r>>2]=d,l=l-i|0,o[B>>2]=l,o[T>>2]=0,i=0),w=d-l|0,_=i-l|0,(l|0)<0?(o[r>>2]=w,o[T>>2]=_,o[B>>2]=0,i=_,_=w,l=0):_=d,d=(i|0)<(_|0)?i:_,d=(l|0)<(d|0)?l:d,(d|0)<=0?(r=0,r|0):(o[r>>2]=_-d,o[T>>2]=i-d,o[B>>2]=l-d,r=0,r|0)}function to(i){i=i|0;var r=0,l=0,d=0,_=0;r=i+8|0,_=o[r>>2]|0,l=_-(o[i>>2]|0)|0,o[i>>2]=l,d=i+4|0,i=(o[d>>2]|0)-_|0,o[d>>2]=i,o[r>>2]=0-(i+l)}function ql(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;l=o[i>>2]|0,r=0-l|0,o[i>>2]=r,T=i+8|0,o[T>>2]=0,B=i+4|0,d=o[B>>2]|0,_=d+l|0,(l|0)>0?(o[B>>2]=_,o[T>>2]=l,o[i>>2]=0,r=0,d=_):l=0,(d|0)<0?(w=r-d|0,o[i>>2]=w,l=l-d|0,o[T>>2]=l,o[B>>2]=0,_=w-l|0,r=0-l|0,(l|0)<0?(o[i>>2]=_,o[B>>2]=r,o[T>>2]=0,d=r,l=0):(d=0,_=w)):_=r,r=(d|0)<(_|0)?d:_,r=(l|0)<(r|0)?l:r,!((r|0)<=0)&&(o[i>>2]=_-r,o[B>>2]=d-r,o[T>>2]=l-r)}function Ro(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0;if(Se=Lt,Lt=Lt+64|0,ue=Se,B=Se+56|0,!(!0&(r&2013265920|0)==134217728&(!0&(d&2013265920|0)==134217728)))return _=5,Lt=Se,_|0;if((i|0)==(l|0)&(r|0)==(d|0))return o[_>>2]=0,_=0,Lt=Se,_|0;if(T=Gt(i|0,r|0,52)|0,Ut()|0,T=T&15,Y=Gt(l|0,d|0,52)|0,Ut()|0,(T|0)!=(Y&15|0))return _=12,Lt=Se,_|0;if(w=T+-1|0,T>>>0>1){jr(i,r,w,ue)|0,jr(l,d,w,B)|0,Y=ue,j=o[Y>>2]|0,Y=o[Y+4>>2]|0;e:do if((j|0)==(o[B>>2]|0)&&(Y|0)==(o[B+4>>2]|0)){T=(T^15)*3|0,w=Gt(i|0,r|0,T|0)|0,Ut()|0,w=w&7,T=Gt(l|0,d|0,T|0)|0,Ut()|0,T=T&7;do if((w|0)==0|(T|0)==0)o[_>>2]=1,w=0;else if((w|0)==7)w=5;else{if((w|0)==1|(T|0)==1&&Cr(j,Y)|0){w=5;break}if((o[15536+(w<<2)>>2]|0)!=(T|0)&&(o[15568+(w<<2)>>2]|0)!=(T|0))break e;o[_>>2]=1,w=0}while(!1);return _=w,Lt=Se,_|0}while(!1)}w=ue,T=w+56|0;do o[w>>2]=0,w=w+4|0;while((w|0)<(T|0));return Oa(i,r,1,ue)|0,r=ue,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0))&&(r=ue+8|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+16|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+24|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+32|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))&&(r=ue+40|0,!((o[r>>2]|0)==(l|0)&&(o[r+4>>2]|0)==(d|0)))?(w=ue+48|0,w=((o[w>>2]|0)==(l|0)?(o[w+4>>2]|0)==(d|0):0)&1):w=1,o[_>>2]=w,_=0,Lt=Se,_|0}function Zo(i,r,l,d,_){return i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,l=Na(i,r,l,d)|0,(l|0)==7?(_=11,_|0):(d=jt(l|0,0,56)|0,r=r&-2130706433|(Ut()|0)|268435456,o[_>>2]=i|d,o[_+4>>2]=r,_=0,_|0)}function wo(i,r,l){return i=i|0,r=r|0,l=l|0,!0&(r&2013265920|0)==268435456?(o[l>>2]=i,o[l+4>>2]=r&-2130706433|134217728,l=0,l|0):(l=6,l|0)}function Us(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return _=Lt,Lt=Lt+16|0,d=_,o[d>>2]=0,!0&(r&2013265920|0)==268435456?(w=Gt(i|0,r|0,56)|0,Ut()|0,d=ls(i,r&-2130706433|134217728,w&7,d,l)|0,Lt=_,d|0):(d=6,Lt=_,d|0)}function Qo(i,r){i=i|0,r=r|0;var l=0;switch(l=Gt(i|0,r|0,56)|0,Ut()|0,l&7){case 0:case 7:return l=0,l|0}return l=r&-2130706433|134217728,!(!0&(r&2013265920|0)==268435456)||!0&(r&117440512|0)==16777216&(Cr(i,l)|0)!=0?(l=0,l|0):(l=Jr(i,l)|0,l|0)}function Wo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return _=Lt,Lt=Lt+16|0,d=_,!0&(r&2013265920|0)==268435456?(w=r&-2130706433|134217728,T=l,o[T>>2]=i,o[T+4>>2]=w,o[d>>2]=0,r=Gt(i|0,r|0,56)|0,Ut()|0,d=ls(i,w,r&7,d,l+8|0)|0,Lt=_,d|0):(d=6,Lt=_,d|0)}function Xo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=(Cr(i,r)|0)==0,r=r&-2130706433,d=l,o[d>>2]=_?i:0,o[d+4>>2]=_?r|285212672:0,d=l+8|0,o[d>>2]=i,o[d+4>>2]=r|301989888,d=l+16|0,o[d>>2]=i,o[d+4>>2]=r|318767104,d=l+24|0,o[d>>2]=i,o[d+4>>2]=r|335544320,d=l+32|0,o[d>>2]=i,o[d+4>>2]=r|352321536,l=l+40|0,o[l>>2]=i,o[l+4>>2]=r|369098752,0}function ba(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;return T=Lt,Lt=Lt+16|0,_=T,w=r&-2130706433|134217728,!0&(r&2013265920|0)==268435456?(d=Gt(i|0,r|0,56)|0,Ut()|0,d=pn(i,w,d&7)|0,(d|0)==-1?(o[l>>2]=0,w=6,Lt=T,w|0):(Yr(i,w,_)|0&&En(23313,22484,282,22499),r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,Cr(i,w)|0?Yo(_,r,d,2,l):Ar(_,r,d,2,l),w=0,Lt=T,w|0)):(w=6,Lt=T,w|0)}function ja(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Lt,Lt=Lt+16|0,_=d,Ts(i,r,l,_),wr(_,l+4|0),Lt=d}function Ts(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0;if(B=Lt,Lt=Lt+16|0,j=B,mu(i,l,j),w=+vn(+(1-+ke[j>>3]*.5)),w<1e-16){o[d>>2]=0,o[d+4>>2]=0,o[d+8>>2]=0,o[d+12>>2]=0,Lt=B;return}if(j=o[l>>2]|0,_=+ke[15920+(j*24|0)>>3],_=+gl(_-+gl(+Ot(15600+(j<<4)|0,i))),Gs(r)|0?T=+gl(_+-.3334731722518321):T=_,_=+Yt(+w)/.381966011250105,(r|0)>0){i=0;do _=_*2.6457513110645907,i=i+1|0;while((i|0)!=(r|0))}w=+vi(+T)*_,ke[d>>3]=w,T=+wi(+T)*_,ke[d+8>>3]=T,Lt=B}function mu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Lt,Lt=Lt+32|0,_=w,ds(i,_),o[r>>2]=0,ke[l>>3]=5,d=+_r(16400,_),d<+ke[l>>3]&&(o[r>>2]=0,ke[l>>3]=d),d=+_r(16424,_),d<+ke[l>>3]&&(o[r>>2]=1,ke[l>>3]=d),d=+_r(16448,_),d<+ke[l>>3]&&(o[r>>2]=2,ke[l>>3]=d),d=+_r(16472,_),d<+ke[l>>3]&&(o[r>>2]=3,ke[l>>3]=d),d=+_r(16496,_),d<+ke[l>>3]&&(o[r>>2]=4,ke[l>>3]=d),d=+_r(16520,_),d<+ke[l>>3]&&(o[r>>2]=5,ke[l>>3]=d),d=+_r(16544,_),d<+ke[l>>3]&&(o[r>>2]=6,ke[l>>3]=d),d=+_r(16568,_),d<+ke[l>>3]&&(o[r>>2]=7,ke[l>>3]=d),d=+_r(16592,_),d<+ke[l>>3]&&(o[r>>2]=8,ke[l>>3]=d),d=+_r(16616,_),d<+ke[l>>3]&&(o[r>>2]=9,ke[l>>3]=d),d=+_r(16640,_),d<+ke[l>>3]&&(o[r>>2]=10,ke[l>>3]=d),d=+_r(16664,_),d<+ke[l>>3]&&(o[r>>2]=11,ke[l>>3]=d),d=+_r(16688,_),d<+ke[l>>3]&&(o[r>>2]=12,ke[l>>3]=d),d=+_r(16712,_),d<+ke[l>>3]&&(o[r>>2]=13,ke[l>>3]=d),d=+_r(16736,_),d<+ke[l>>3]&&(o[r>>2]=14,ke[l>>3]=d),d=+_r(16760,_),d<+ke[l>>3]&&(o[r>>2]=15,ke[l>>3]=d),d=+_r(16784,_),d<+ke[l>>3]&&(o[r>>2]=16,ke[l>>3]=d),d=+_r(16808,_),d<+ke[l>>3]&&(o[r>>2]=17,ke[l>>3]=d),d=+_r(16832,_),d<+ke[l>>3]&&(o[r>>2]=18,ke[l>>3]=d),d=+_r(16856,_),!(d<+ke[l>>3])){Lt=w;return}o[r>>2]=19,ke[l>>3]=d,Lt=w}function Sr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;if(w=+Fu(i),w<1e-16){r=15600+(r<<4)|0,o[_>>2]=o[r>>2],o[_+4>>2]=o[r+4>>2],o[_+8>>2]=o[r+8>>2],o[_+12>>2]=o[r+12>>2];return}if(T=+Vn(+ +ke[i+8>>3],+ +ke[i>>3]),(l|0)>0){i=0;do w=w/2.6457513110645907,i=i+1|0;while((i|0)!=(l|0))}d?(w=w/3,l=(Gs(l)|0)==0,w=+dn(+((l?w:w/2.6457513110645907)*.381966011250105))):(w=+dn(+(w*.381966011250105)),Gs(l)|0&&(T=+gl(T+.3334731722518321))),ei(15600+(r<<4)|0,+gl(+ke[15920+(r*24|0)>>3]-T),w,_)}function Xn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;d=Lt,Lt=Lt+16|0,_=d,js(i+4|0,_),Sr(_,o[i>>2]|0,r,0,l),Lt=d}function Yo(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0,si=0,ji=0,Zi=0,Ii=0,Vi=0,Ui=0,an=0,Bn=0,Ji=0;if(an=Lt,Lt=Lt+272|0,w=an+256|0,ct=an+240|0,Ii=an,Vi=an+224|0,Ui=an+208|0,Et=an+176|0,wt=an+160|0,ri=an+192|0,Xt=an+144|0,Jt=an+128|0,si=an+112|0,ji=an+96|0,Zi=an+80|0,o[w>>2]=r,o[ct>>2]=o[i>>2],o[ct+4>>2]=o[i+4>>2],o[ct+8>>2]=o[i+8>>2],o[ct+12>>2]=o[i+12>>2],Dr(ct,w,Ii),o[_>>2]=0,ct=d+l+((d|0)==5&1)|0,(ct|0)<=(l|0)){Lt=an;return}j=o[w>>2]|0,Y=Vi+4|0,ue=Et+4|0,Se=l+5|0,Te=16880+(j<<2)|0,Re=16960+(j<<2)|0,Be=Jt+8|0,$e=si+8|0,vt=ji+8|0,ot=Ui+4|0,B=l;e:for(;;){T=Ii+(((B|0)%5|0)<<4)|0,o[Ui>>2]=o[T>>2],o[Ui+4>>2]=o[T+4>>2],o[Ui+8>>2]=o[T+8>>2],o[Ui+12>>2]=o[T+12>>2];do;while((Za(Ui,j,0,1)|0)==2);if((B|0)>(l|0)&(Gs(r)|0)!=0){if(o[Et>>2]=o[Ui>>2],o[Et+4>>2]=o[Ui+4>>2],o[Et+8>>2]=o[Ui+8>>2],o[Et+12>>2]=o[Ui+12>>2],js(Y,wt),d=o[Et>>2]|0,w=o[17040+(d*80|0)+(o[Vi>>2]<<2)>>2]|0,o[Et>>2]=o[18640+(d*80|0)+(w*20|0)>>2],T=o[18640+(d*80|0)+(w*20|0)+16>>2]|0,(T|0)>0){i=0;do El(ue),i=i+1|0;while((i|0)<(T|0))}switch(T=18640+(d*80|0)+(w*20|0)+4|0,o[ri>>2]=o[T>>2],o[ri+4>>2]=o[T+4>>2],o[ri+8>>2]=o[T+8>>2],Pr(ri,(o[Te>>2]|0)*3|0),vr(ue,ri,ue),Mr(ue),js(ue,Xt),Bn=+(o[Re>>2]|0),ke[Jt>>3]=Bn*3,ke[Be>>3]=0,Ji=Bn*-1.5,ke[si>>3]=Ji,ke[$e>>3]=Bn*2.598076211353316,ke[ji>>3]=Ji,ke[vt>>3]=Bn*-2.598076211353316,o[17040+((o[Et>>2]|0)*80|0)+(o[Ui>>2]<<2)>>2]|0){case 1:{i=si,d=Jt;break}case 3:{i=ji,d=si;break}case 2:{i=Jt,d=ji;break}default:{i=12;break e}}uu(wt,Xt,d,i,Zi),Sr(Zi,o[Et>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1}if((B|0)<(Se|0)&&(js(ot,Et),Sr(Et,o[Ui>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),o[Vi>>2]=o[Ui>>2],o[Vi+4>>2]=o[Ui+4>>2],o[Vi+8>>2]=o[Ui+8>>2],o[Vi+12>>2]=o[Ui+12>>2],B=B+1|0,(B|0)>=(ct|0)){i=3;break}}if((i|0)==3){Lt=an;return}else(i|0)==12&&En(22522,22569,571,22579)}function Dr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Lt,Lt=Lt+128|0,d=j+64|0,_=j,w=d,T=20240,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20304,B=w+60|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(Gs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),pu(_),Gs(o[r>>2]|0)|0&&(ca(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,vr(_,d,r),Mr(r),o[l+16>>2]=o[i>>2],r=l+20|0,vr(_,d+12|0,r),Mr(r),o[l+32>>2]=o[i>>2],r=l+36|0,vr(_,d+24|0,r),Mr(r),o[l+48>>2]=o[i>>2],r=l+52|0,vr(_,d+36|0,r),Mr(r),o[l+64>>2]=o[i>>2],l=l+68|0,vr(_,d+48|0,l),Mr(l),Lt=j}function Za(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(Be=Lt,Lt=Lt+32|0,Te=Be+12|0,B=Be,Re=i+4|0,Se=o[16960+(r<<2)>>2]|0,ue=(d|0)!=0,Se=ue?Se*3|0:Se,_=o[Re>>2]|0,Y=i+8|0,T=o[Y>>2]|0,ue){if(w=i+12|0,d=o[w>>2]|0,_=T+_+d|0,(_|0)==(Se|0))return Re=1,Lt=Be,Re|0;j=w}else j=i+12|0,d=o[j>>2]|0,_=T+_+d|0;if((_|0)<=(Se|0))return Re=0,Lt=Be,Re|0;do if((d|0)>0){if(d=o[i>>2]|0,(T|0)>0){w=18640+(d*80|0)+60|0,d=i;break}d=18640+(d*80|0)+40|0,l?(ir(Te,Se,0,0),Ks(Re,Te,B),Ha(B),vr(B,Te,Re),w=d,d=i):(w=d,d=i)}else w=18640+((o[i>>2]|0)*80|0)+20|0,d=i;while(!1);if(o[d>>2]=o[w>>2],_=w+16|0,(o[_>>2]|0)>0){d=0;do El(Re),d=d+1|0;while((d|0)<(o[_>>2]|0))}return i=w+4|0,o[Te>>2]=o[i>>2],o[Te+4>>2]=o[i+4>>2],o[Te+8>>2]=o[i+8>>2],r=o[16880+(r<<2)>>2]|0,Pr(Te,ue?r*3|0:r),vr(Re,Te,Re),Mr(Re),ue?d=((o[Y>>2]|0)+(o[Re>>2]|0)+(o[j>>2]|0)|0)==(Se|0)?1:2:d=2,Re=d,Lt=Be,Re|0}function Kr(i,r){i=i|0,r=r|0;var l=0;do l=Za(i,r,0,1)|0;while((l|0)==2);return l|0}function Ar(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0,si=0,ji=0,Zi=0,Ii=0;if(ji=Lt,Lt=Lt+240|0,w=ji+224|0,ri=ji+208|0,Xt=ji,Jt=ji+192|0,si=ji+176|0,vt=ji+160|0,ot=ji+144|0,ct=ji+128|0,Et=ji+112|0,wt=ji+96|0,o[w>>2]=r,o[ri>>2]=o[i>>2],o[ri+4>>2]=o[i+4>>2],o[ri+8>>2]=o[i+8>>2],o[ri+12>>2]=o[i+12>>2],So(ri,w,Xt),o[_>>2]=0,$e=d+l+((d|0)==6&1)|0,($e|0)<=(l|0)){Lt=ji;return}j=o[w>>2]|0,Y=l+6|0,ue=16960+(j<<2)|0,Se=ot+8|0,Te=ct+8|0,Re=Et+8|0,Be=Jt+4|0,T=0,B=l,d=-1;e:for(;;){if(w=(B|0)%6|0,i=Xt+(w<<4)|0,o[Jt>>2]=o[i>>2],o[Jt+4>>2]=o[i+4>>2],o[Jt+8>>2]=o[i+8>>2],o[Jt+12>>2]=o[i+12>>2],i=T,T=Za(Jt,j,0,1)|0,(B|0)>(l|0)&(Gs(r)|0)!=0&&(i|0)!=1&&(o[Jt>>2]|0)!=(d|0)){switch(js(Xt+(((w+5|0)%6|0)<<4)+4|0,si),js(Xt+(w<<4)+4|0,vt),Zi=+(o[ue>>2]|0),ke[ot>>3]=Zi*3,ke[Se>>3]=0,Ii=Zi*-1.5,ke[ct>>3]=Ii,ke[Te>>3]=Zi*2.598076211353316,ke[Et>>3]=Ii,ke[Re>>3]=Zi*-2.598076211353316,w=o[ri>>2]|0,o[17040+(w*80|0)+(((d|0)==(w|0)?o[Jt>>2]|0:d)<<2)>>2]|0){case 1:{i=ct,d=ot;break}case 3:{i=Et,d=ct;break}case 2:{i=ot,d=Et;break}default:{i=8;break e}}uu(si,vt,d,i,wt),!(Ou(si,wt)|0)&&!(Ou(vt,wt)|0)&&(Sr(wt,o[ri>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1)}if((B|0)<(Y|0)&&(js(Be,si),Sr(si,o[Jt>>2]|0,j,1,_+8+(o[_>>2]<<4)|0),o[_>>2]=(o[_>>2]|0)+1),B=B+1|0,(B|0)>=($e|0)){i=3;break}else d=o[Jt>>2]|0}if((i|0)==3){Lt=ji;return}else(i|0)==8&&En(22606,22569,736,22651)}function So(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;j=Lt,Lt=Lt+160|0,d=j+80|0,_=j,w=d,T=20368,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));w=_,T=20448,B=w+72|0;do o[w>>2]=o[T>>2],w=w+4|0,T=T+4|0;while((w|0)<(B|0));B=(Gs(o[r>>2]|0)|0)==0,d=B?d:_,_=i+4|0,Cl(_),pu(_),Gs(o[r>>2]|0)|0&&(ca(_),o[r>>2]=(o[r>>2]|0)+1),o[l>>2]=o[i>>2],r=l+4|0,vr(_,d,r),Mr(r),o[l+16>>2]=o[i>>2],r=l+20|0,vr(_,d+12|0,r),Mr(r),o[l+32>>2]=o[i>>2],r=l+36|0,vr(_,d+24|0,r),Mr(r),o[l+48>>2]=o[i>>2],r=l+52|0,vr(_,d+36|0,r),Mr(r),o[l+64>>2]=o[i>>2],r=l+68|0,vr(_,d+48|0,r),Mr(r),o[l+80>>2]=o[i>>2],l=l+84|0,vr(_,d+60|0,l),Mr(l),Lt=j}function Nn(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&15|0}function Ol(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,45)|0,Ut()|0,r&127|0}function Jr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0;if(!(!0&(r&-16777216|0)==134217728)||(T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127,T>>>0>121))return r=0,r|0;l=Gt(i|0,r|0,52)|0,Ut()|0,l=l&15;do if(l|0){for(_=1,d=0;;){if(w=Gt(i|0,r|0,(15-_|0)*3|0)|0,Ut()|0,w=w&7,(w|0)!=0&(d^1))if((w|0)==1&(tt(T)|0)!=0){B=0,d=13;break}else d=1;if((w|0)==7){B=0,d=13;break}if(_>>>0<l>>>0)_=_+1|0;else{d=9;break}}if((d|0)==9){if((l|0)==15)B=1;else break;return B|0}else if((d|0)==13)return B|0}while(!1);for(;;){if(B=Gt(i|0,r|0,(14-l|0)*3|0)|0,Ut()|0,!((B&7|0)==7&!0)){B=0,d=13;break}if(l>>>0<14)l=l+1|0;else{B=1,d=13;break}}return(d|0)==13?B|0:0}function jr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,l>>>0>15)return d=4,d|0;if((w|0)<(l|0))return d=12,d|0;if((w|0)==(l|0))return o[d>>2]=i,o[d+4>>2]=r,d=0,d|0;if(_=jt(l|0,0,52)|0,_=_|i,i=Ut()|0|r&-15728641,(w|0)>(l|0))do r=jt(7,0,(14-l|0)*3|0)|0,l=l+1|0,_=r|_,i=Ut()|0|i;while((l|0)<(w|0));return o[d>>2]=_,o[d+4>>2]=i,d=0,d|0}function ks(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,!((l|0)<16&(w|0)<=(l|0)))return d=4,d|0;_=l-w|0,l=Gt(i|0,r|0,45)|0,Ut()|0;e:do if(!(tt(l&127)|0))l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;else{t:do if(w|0){for(l=1;T=jt(7,0,(15-l|0)*3|0)|0,!!((T&i|0)==0&((Ut()|0)&r|0)==0);)if(l>>>0<w>>>0)l=l+1|0;else break t;l=_l(7,0,_,((_|0)<0)<<31>>31)|0,_=Ut()|0;break e}while(!1);l=_l(7,0,_,((_|0)<0)<<31>>31)|0,l=We(l|0,Ut()|0,5,0)|0,l=z(l|0,Ut()|0,-5,-1)|0,l=ae(l|0,Ut()|0,6,0)|0,l=z(l|0,Ut()|0,1,0)|0,_=Ut()|0}while(!1);return T=d,o[T>>2]=l,o[T+4>>2]=_,T=0,T|0}function Cr(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(tt(_&127)|0))return _=0,_|0;_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!_)l=0;else for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0)break e;if(d>>>0<_>>>0)d=d+1|0;else{l=0;break}}while(!1);return _=(l|0)==0&1,_|0}function nr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0;if(T=Lt,Lt=Lt+16|0,w=T,ll(w,i,r,l),r=w,i=o[r>>2]|0,r=o[r+4>>2]|0,(i|0)==0&(r|0)==0)return Lt=T,0;_=0,l=0;do B=d+(_<<3)|0,o[B>>2]=i,o[B+4>>2]=r,_=z(_|0,l|0,1,0)|0,l=Ut()|0,ou(w),B=w,i=o[B>>2]|0,r=o[B+4>>2]|0;while(!((i|0)==0&(r|0)==0));return Lt=T,0}function al(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,(d|0)<(l|0)?(l=r,d=i,Yi(l|0),d|0):(l=jt(-1,-1,((d-l|0)*3|0)+3|0)|0,d=jt(~l|0,~(Ut()|0)|0,(15-d|0)*3|0)|0,l=~(Ut()|0)&r,d=~d&i,Yi(l|0),d|0)}function Xr(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0;return _=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,(l|0)<16&(_|0)<=(l|0)?((_|0)<(l|0)&&(_=jt(-1,-1,((l+-1-_|0)*3|0)+3|0)|0,_=jt(~_|0,~(Ut()|0)|0,(15-l|0)*3|0)|0,r=~(Ut()|0)&r,i=~_&i),_=jt(l|0,0,52)|0,l=r&-15728641|(Ut()|0),o[d>>2]=i|_,o[d+4>>2]=l,d=0,d|0):(d=4,d|0)}function Io(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0,si=0;if((l|0)==0&(d|0)==0)return Jt=0,Jt|0;if(_=i,w=o[_>>2]|0,_=o[_+4>>2]|0,!0&(_&15728640|0)==0){if(!((d|0)>0|(d|0)==0&l>>>0>0)||(Jt=r,o[Jt>>2]=w,o[Jt+4>>2]=_,(l|0)==1&(d|0)==0))return Jt=0,Jt|0;_=1;do ri=i+(_<<3)|0,Xt=o[ri+4>>2]|0,Jt=r+(_<<3)|0,o[Jt>>2]=o[ri>>2],o[Jt+4>>2]=Xt,_=_+1|0;while(0<(d|0)|(d|0)==0&_>>>0<l>>>0);return _=0,_|0}if(wt=l<<3,Xt=Ps(wt)|0,!Xt)return Jt=13,Jt|0;if(F(Xt|0,i|0,wt|0)|0,ri=D(l,8)|0,!ri)return C(Xt),Jt=13,Jt|0;e:do if(l|0){t:for(;;){_=Xt,ot=o[_>>2]|0,_=o[_+4>>2]|0,ct=Gt(ot|0,_|0,52)|0,Ut()|0,ct=ct&15,Et=ct+-1|0,vt=(l|0)>0;i:do if((ct|0)!=0&vt){if(Re=((l|0)<0)<<31>>31,Be=jt(Et|0,0,52)|0,$e=Ut()|0,Et>>>0>15){if(!((ot|0)==0&(_|0)==0)){Jt=17;break t}for(w=0;;){if(w=w+1|0,(w|0)>=(l|0))break i;if(d=Xt+(w<<3)|0,$e=o[d>>2]|0,d=o[d+4>>2]|0,!(($e|0)==0&(d|0)==0)){_=d,Jt=17;break t}}}for(w=0,i=ot,d=_;;){if(!((i|0)==0&(d|0)==0)){if(!(!0&(d&117440512|0)==0)){Jt=22;break t}if(B=Gt(i|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)<(Et|0)){_=12,Jt=28;break t}if((B|0)!=(Et|0)&&(i=i|Be,d=d&-15728641|$e,B>>>0>=ct>>>0)){T=Et;do Te=jt(7,0,(14-T|0)*3|0)|0,T=T+1|0,i=Te|i,d=Ut()|0|d;while(T>>>0<B>>>0)}if(T=Ct(i|0,d|0,l|0,Re|0)|0,Ut()|0,Y=ri+(T<<3)|0,B=Y,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0)T=Y;else for(Te=0;;){if((Te|0)>(l|0)){Jt=32;break t}if((j|0)==(i|0)&(B&-117440513|0)==(d|0)){ue=Gt(j|0,B|0,56)|0,Ut()|0,ue=ue&7,Se=ue+1|0,si=Gt(j|0,B|0,45)|0,Ut()|0;n:do if(!(tt(si&127)|0))B=7;else{if(j=Gt(j|0,B|0,52)|0,Ut()|0,j=j&15,!j){B=6;break}for(B=1;;){if(si=jt(7,0,(15-B|0)*3|0)|0,!((si&i|0)==0&((Ut()|0)&d|0)==0)){B=7;break n}if(B>>>0<j>>>0)B=B+1|0;else{B=6;break}}}while(!1);if((ue+2|0)>>>0>B>>>0){Jt=42;break t}si=jt(Se|0,0,56)|0,d=Ut()|0|d&-117440513,Se=Y,o[Se>>2]=0,o[Se+4>>2]=0,i=si|i}else T=(T+1|0)%(l|0)|0;if(Y=ri+(T<<3)|0,B=Y,j=o[B>>2]|0,B=o[B+4>>2]|0,(j|0)==0&(B|0)==0){T=Y;break}else Te=Te+1|0}si=T,o[si>>2]=i,o[si+4>>2]=d}if(w=w+1|0,(w|0)>=(l|0))break i;d=Xt+(w<<3)|0,i=o[d>>2]|0,d=o[d+4>>2]|0}}while(!1);if((l+5|0)>>>0<11){Jt=85;break}if($e=D((l|0)/6|0,8)|0,!$e){Jt=49;break}i:do if(vt){Te=0,Se=0;do{if(B=ri+(Te<<3)|0,d=B,w=o[d>>2]|0,d=o[d+4>>2]|0,!((w|0)==0&(d|0)==0)){j=Gt(w|0,d|0,56)|0,Ut()|0,j=j&7,i=j+1|0,Y=d&-117440513,si=Gt(w|0,d|0,45)|0,Ut()|0;n:do if(tt(si&127)|0){if(ue=Gt(w|0,d|0,52)|0,Ut()|0,ue=ue&15,ue|0)for(T=1;;){if(si=jt(7,0,(15-T|0)*3|0)|0,!((w&si|0)==0&(Y&(Ut()|0)|0)==0))break n;if(T>>>0<ue>>>0)T=T+1|0;else break}d=jt(i|0,0,56)|0,w=d|w,d=Ut()|0|Y,i=B,o[i>>2]=w,o[i+4>>2]=d,i=j+2|0}while(!1);(i|0)==7&&(si=$e+(Se<<3)|0,o[si>>2]=w,o[si+4>>2]=d&-117440513,Se=Se+1|0)}Te=Te+1|0}while((Te|0)!=(l|0));if(vt){if(Te=((l|0)<0)<<31>>31,Re=jt(Et|0,0,52)|0,Be=Ut()|0,Et>>>0>15){if(!((ot|0)==0&(_|0)==0)){_=4,Jt=84;break t}for(_=0;;){if(_=_+1|0,(_|0)>=(l|0)){w=0,_=Se;break i}if(si=Xt+(_<<3)|0,!((o[si>>2]|0)==0&(o[si+4>>2]|0)==0)){_=4,Jt=84;break t}}}for(ue=0,w=0,Y=ot;;){do if(!((Y|0)==0&(_|0)==0)){if(B=Gt(Y|0,_|0,52)|0,Ut()|0,B=B&15,(B|0)<(Et|0)){_=12,Jt=84;break t}do if((B|0)==(Et|0))d=Y,B=_;else{if(d=Y|Re,i=_&-15728641|Be,B>>>0<ct>>>0){B=i;break}T=Et;do si=jt(7,0,(14-T|0)*3|0)|0,T=T+1|0,d=si|d,i=Ut()|0|i;while(T>>>0<B>>>0);B=i}while(!1);for(T=Ct(d|0,B|0,l|0,Te|0)|0,Ut()|0,i=0;;){if((i|0)>(l|0)){Jt=77;break t}if(si=ri+(T<<3)|0,j=o[si+4>>2]|0,(j&-117440513|0)==(B|0)&&(o[si>>2]|0)==(d|0)){Jt=79;break}if(T=(T+1|0)%(l|0)|0,si=ri+(T<<3)|0,(o[si>>2]|0)==(d|0)&&(o[si+4>>2]|0)==(B|0))break;i=i+1|0}if((Jt|0)==79&&(Jt=0,!0&(j&117440512|0)==100663296))break;si=r+(w<<3)|0,o[si>>2]=Y,o[si+4>>2]=_,w=w+1|0}while(!1);if(_=ue+1|0,(_|0)>=(l|0)){_=Se;break i}si=Xt+(_<<3)|0,ue=_,Y=o[si>>2]|0,_=o[si+4>>2]|0}}else w=0,_=Se}else w=0,_=0;while(!1);if(O(ri|0,0,wt|0)|0,F(Xt|0,$e|0,_<<3|0)|0,C($e),_)r=r+(w<<3)|0,l=_;else break e}if((Jt|0)==17)!0&(_&117440512|0)==0?(_=4,Jt=28):Jt=22;else if((Jt|0)==32)En(23313,22674,362,22684);else{if((Jt|0)==42)return C(Xt),C(ri),si=10,si|0;if((Jt|0)==49)return C(Xt),C(ri),si=13,si|0;if((Jt|0)==77)En(23313,22674,462,22684);else{if((Jt|0)==84)return C($e),C(Xt),C(ri),si=_,si|0;if((Jt|0)==85){F(r|0,Xt|0,l<<3|0)|0;break}}}if((Jt|0)==22)return C(Xt),C(ri),si=5,si|0;if((Jt|0)==28)return C(Xt),C(ri),si=_,si|0}while(!1);return C(Xt),C(ri),si=0,si|0}function ol(i,r,l,d,_,w,T){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0,T=T|0;var B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0;if($e=Lt,Lt=Lt+16|0,Be=$e,!((l|0)>0|(l|0)==0&r>>>0>0))return Be=0,Lt=$e,Be|0;if((T|0)>=16)return Be=12,Lt=$e,Be|0;Te=0,Re=0,Se=0,B=0;e:for(;;){if(Y=i+(Te<<3)|0,j=o[Y>>2]|0,Y=o[Y+4>>2]|0,ue=Gt(j|0,Y|0,52)|0,Ut()|0,(ue&15|0)>(T|0)){B=12,j=11;break}if(ll(Be,j,Y,T),ue=Be,Y=o[ue>>2]|0,ue=o[ue+4>>2]|0,(Y|0)==0&(ue|0)==0)j=Se;else{j=Se;do{if(!((B|0)<(w|0)|(B|0)==(w|0)&j>>>0<_>>>0)){j=10;break e}Se=d+(j<<3)|0,o[Se>>2]=Y,o[Se+4>>2]=ue,j=z(j|0,B|0,1,0)|0,B=Ut()|0,ou(Be),Se=Be,Y=o[Se>>2]|0,ue=o[Se+4>>2]|0}while(!((Y|0)==0&(ue|0)==0))}if(Te=z(Te|0,Re|0,1,0)|0,Re=Ut()|0,(Re|0)<(l|0)|(Re|0)==(l|0)&Te>>>0<r>>>0)Se=j;else{B=0,j=11;break}}return(j|0)==10?(Be=14,Lt=$e,Be|0):(j|0)==11?(Lt=$e,B|0):0}function Zr(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0;Te=Lt,Lt=Lt+16|0,Se=Te;e:do if((l|0)>0|(l|0)==0&r>>>0>0){for(Y=0,T=0,w=0,ue=0;;){if(j=i+(Y<<3)|0,B=o[j>>2]|0,j=o[j+4>>2]|0,!((B|0)==0&(j|0)==0)&&(j=(ks(B,j,d,Se)|0)==0,B=Se,T=z(o[B>>2]|0,o[B+4>>2]|0,T|0,w|0)|0,w=Ut()|0,!j)){w=12;break}if(Y=z(Y|0,ue|0,1,0)|0,ue=Ut()|0,!((ue|0)<(l|0)|(ue|0)==(l|0)&Y>>>0<r>>>0))break e}return Lt=Te,w|0}else T=0,w=0;while(!1);return o[_>>2]=T,o[_+4>>2]=w,_=0,Lt=Te,_|0}function hs(i,r){return i=i|0,r=r|0,r=Gt(i|0,r|0,52)|0,Ut()|0,r&1|0}function wa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=0,_|0;for(d=1;;){if(l=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,l=l&7,l|0){d=5;break}if(d>>>0<_>>>0)d=d+1|0;else{l=0,d=5;break}}return(d|0)==5?l|0:0}function Tl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Yi(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=jt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=jt(Ta(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(T=(15-l|0)*3|0,_=Gt(i|0,r|0,T|0)|0,Ut()|0,w=jt(7,0,T|0)|0,r=r&~(Ut()|0),T=jt(Ta(_&7)|0,0,T|0)|0,i=i&~w|T,r=r|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Yi(r|0),i|0}function Eo(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Yi(l|0),d|0;for(l=1;w=(15-l|0)*3|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,_=jt(7,0,w|0)|0,r=r&~(Ut()|0),w=jt(Ta(T&7)|0,0,w|0)|0,i=w|i&~_,r=Ut()|0|r,l>>>0<d>>>0;)l=l+1|0;return Yi(r|0),i|0}function kl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(j=Gt(i|0,r|0,52)|0,Ut()|0,j=j&15,!j)return B=r,j=i,Yi(B|0),j|0;for(B=1,l=0;;){w=(15-B|0)*3|0,d=jt(7,0,w|0)|0,_=Ut()|0,T=Gt(i|0,r|0,w|0)|0,Ut()|0,w=jt(ml(T&7)|0,0,w|0)|0,T=Ut()|0,i=w|i&~d,r=T|r&~_;e:do if(!l)if((w&d|0)==0&(T&_|0)==0)l=0;else if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)l=1;else{l=1;t:for(;;){switch(T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,T&7){case 1:break t;case 0:break;default:{l=1;break e}}if(l>>>0<d>>>0)l=l+1|0;else{l=1;break e}}for(l=1;;)if(_=(15-l|0)*3|0,w=jt(7,0,_|0)|0,T=r&~(Ut()|0),r=Gt(i|0,r|0,_|0)|0,Ut()|0,r=jt(ml(r&7)|0,0,_|0)|0,i=i&~w|r,r=T|(Ut()|0),l>>>0<d>>>0)l=l+1|0;else{l=1;break}}while(!1);if(B>>>0<j>>>0)B=B+1|0;else break}return Yi(r|0),i|0}function Ao(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;if(d=Gt(i|0,r|0,52)|0,Ut()|0,d=d&15,!d)return l=r,d=i,Yi(l|0),d|0;for(l=1;T=(15-l|0)*3|0,w=jt(7,0,T|0)|0,_=r&~(Ut()|0),r=Gt(i|0,r|0,T|0)|0,Ut()|0,r=jt(ml(r&7)|0,0,T|0)|0,i=r|i&~w,r=Ut()|0|_,l>>>0<d>>>0;)l=l+1|0;return Yi(r|0),i|0}function Js(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0;if(j=Lt,Lt=Lt+64|0,B=j+40|0,d=j+24|0,_=j+12|0,w=j,jt(r|0,0,52)|0,l=Ut()|0|134225919,!r)return(o[i+4>>2]|0)>2||(o[i+8>>2]|0)>2||(o[i+12>>2]|0)>2?(T=0,B=0,Yi(T|0),Lt=j,B|0):(jt(Wt(i)|0,0,45)|0,T=Ut()|0|l,B=-1,Yi(T|0),Lt=j,B|0);if(o[B>>2]=o[i>>2],o[B+4>>2]=o[i+4>>2],o[B+8>>2]=o[i+8>>2],o[B+12>>2]=o[i+12>>2],T=B+4|0,(r|0)>0)for(i=-1;o[d>>2]=o[T>>2],o[d+4>>2]=o[T+4>>2],o[d+8>>2]=o[T+8>>2],r&1?(Il(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],jo(_)):(ho(T),o[_>>2]=o[T>>2],o[_+4>>2]=o[T+4>>2],o[_+8>>2]=o[T+8>>2],ca(_)),Ks(d,_,w),Mr(w),ue=(15-r|0)*3|0,Y=jt(7,0,ue|0)|0,l=l&~(Ut()|0),ue=jt(bo(w)|0,0,ue|0)|0,i=ue|i&~Y,l=Ut()|0|l,(r|0)>1;)r=r+-1|0;else i=-1;e:do if((o[T>>2]|0)<=2&&(o[B+8>>2]|0)<=2&&(o[B+12>>2]|0)<=2){if(d=Wt(B)|0,r=jt(d|0,0,45)|0,r=r|i,i=Ut()|0|l&-1040385,w=Si(B)|0,!(tt(d)|0)){if((w|0)<=0)break;for(_=0;;){if(d=Gt(r|0,i|0,52)|0,Ut()|0,d=d&15,d)for(l=1;ue=(15-l|0)*3|0,B=Gt(r|0,i|0,ue|0)|0,Ut()|0,Y=jt(7,0,ue|0)|0,i=i&~(Ut()|0),ue=jt(Ta(B&7)|0,0,ue|0)|0,r=r&~Y|ue,i=i|(Ut()|0),l>>>0<d>>>0;)l=l+1|0;if(_=_+1|0,(_|0)==(w|0))break e}}_=Gt(r|0,i|0,52)|0,Ut()|0,_=_&15;t:do if(_){l=1;i:for(;;){switch(ue=Gt(r|0,i|0,(15-l|0)*3|0)|0,Ut()|0,ue&7){case 1:break i;case 0:break;default:break t}if(l>>>0<_>>>0)l=l+1|0;else break t}if(An(d,o[B>>2]|0)|0)for(l=1;B=(15-l|0)*3|0,Y=jt(7,0,B|0)|0,ue=i&~(Ut()|0),i=Gt(r|0,i|0,B|0)|0,Ut()|0,i=jt(ml(i&7)|0,0,B|0)|0,r=r&~Y|i,i=ue|(Ut()|0),l>>>0<_>>>0;)l=l+1|0;else for(l=1;ue=(15-l|0)*3|0,B=Gt(r|0,i|0,ue|0)|0,Ut()|0,Y=jt(7,0,ue|0)|0,i=i&~(Ut()|0),ue=jt(Ta(B&7)|0,0,ue|0)|0,r=r&~Y|ue,i=i|(Ut()|0),l>>>0<_>>>0;)l=l+1|0}while(!1);if((w|0)>0){l=0;do r=Tl(r,i)|0,i=Ut()|0,l=l+1|0;while((l|0)!=(w|0))}}else r=0,i=0;while(!1);return Y=i,ue=r,Yi(Y|0),Lt=j,ue|0}function Gs(i){return i=i|0,(i|0)%2|0|0}function Qa(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;return _=Lt,Lt=Lt+16|0,d=_,r>>>0>15?(d=4,Lt=_,d|0):(o[i+4>>2]&2146435072|0)==2146435072||(o[i+8+4>>2]&2146435072|0)==2146435072?(d=3,Lt=_,d|0):(ja(i,r,d),r=Js(d,r)|0,d=Ut()|0,o[l>>2]=r,o[l+4>>2]=d,(r|0)==0&(d|0)==0&&En(23313,22674,786,22697),d=0,Lt=_,d|0)}function $o(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(_=l+4|0,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,T=Gt(i|0,r|0,45)|0,Ut()|0,d=(w|0)==0,tt(T&127)|0){if(d)return T=1,T|0;d=1}else{if(d)return T=0,T|0;!(o[_>>2]|0)&&!(o[l+8>>2]|0)?d=(o[l+12>>2]|0)!=0&1:d=1}for(l=1;l&1?jo(_):ca(_),T=Gt(i|0,r|0,(15-l|0)*3|0)|0,Ut()|0,Ys(_,T&7),l>>>0<w>>>0;)l=l+1|0;return d|0}function Yr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0;if(ue=Lt,Lt=Lt+16|0,j=ue,Y=Gt(i|0,r|0,45)|0,Ut()|0,Y=Y&127,Y>>>0>121)return o[l>>2]=0,o[l+4>>2]=0,o[l+8>>2]=0,o[l+12>>2]=0,Y=5,Lt=ue,Y|0;e:do if(tt(Y)|0&&(w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,(w|0)!=0)){d=1;t:for(;;){switch(B=Gt(i|0,r|0,(15-d|0)*3|0)|0,Ut()|0,B&7){case 5:break t;case 0:break;default:{d=r;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=r;break e}}for(_=1,d=r;r=(15-_|0)*3|0,T=jt(7,0,r|0)|0,B=d&~(Ut()|0),d=Gt(i|0,d|0,r|0)|0,Ut()|0,d=jt(ml(d&7)|0,0,r|0)|0,i=i&~T|d,d=B|(Ut()|0),_>>>0<w>>>0;)_=_+1|0}else d=r;while(!1);if(B=7696+(Y*28|0)|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],!($o(i,d,l)|0))return Y=0,Lt=ue,Y|0;if(T=l+4|0,o[j>>2]=o[T>>2],o[j+4>>2]=o[T+4>>2],o[j+8>>2]=o[T+8>>2],w=Gt(i|0,d|0,52)|0,Ut()|0,B=w&15,w&1?(ca(T),w=B+1|0):w=B,!(tt(Y)|0))d=0;else{e:do if(!B)d=0;else for(r=1;;){if(_=Gt(i|0,d|0,(15-r|0)*3|0)|0,Ut()|0,_=_&7,_|0){d=_;break e}if(r>>>0<B>>>0)r=r+1|0;else{d=0;break}}while(!1);d=(d|0)==4&1}if(!(Za(l,w,d,0)|0))(w|0)!=(B|0)&&(o[T>>2]=o[j>>2],o[T+4>>2]=o[j+4>>2],o[T+8>>2]=o[j+8>>2]);else{if(tt(Y)|0)do;while(Za(l,w,0,0)|0);(w|0)!=(B|0)&&ho(T)}return Y=0,Lt=ue,Y|0}function mr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=Lt,Lt=Lt+16|0,d=w,_=Yr(i,r,d)|0,_|0?(Lt=w,_|0):(_=Gt(i|0,r|0,52)|0,Ut()|0,Xn(d,_&15,l),_=0,Lt=w,_|0)}function Rr(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(T=Lt,Lt=Lt+16|0,w=T,d=Yr(i,r,w)|0,d|0)return w=d,Lt=T,w|0;d=Gt(i|0,r|0,45)|0,Ut()|0,d=(tt(d&127)|0)==0,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15;e:do if(!d){if(_|0)for(d=1;;){if(B=jt(7,0,(15-d|0)*3|0)|0,!((B&i|0)==0&((Ut()|0)&r|0)==0))break e;if(d>>>0<_>>>0)d=d+1|0;else break}return Yo(w,_,0,5,l),B=0,Lt=T,B|0}while(!1);return Ar(w,_,0,6,l),B=0,Lt=T,B|0}function ha(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(_=Gt(i|0,r|0,45)|0,Ut()|0,!(tt(_&127)|0))return _=2,o[l>>2]=_,0;if(_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,!_)return _=5,o[l>>2]=_,0;for(d=1;;){if(w=jt(7,0,(15-d|0)*3|0)|0,!((w&i|0)==0&((Ut()|0)&r|0)==0)){d=2,i=6;break}if(d>>>0<_>>>0)d=d+1|0;else{d=5,i=6;break}}return(i|0)==6&&(o[l>>2]=d),0}function fo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0;Se=Lt,Lt=Lt+128|0,Y=Se+112|0,w=Se+96|0,ue=Se,_=Gt(i|0,r|0,52)|0,Ut()|0,B=_&15,o[Y>>2]=B,T=Gt(i|0,r|0,45)|0,Ut()|0,T=T&127;e:do if(tt(T)|0){if(B|0)for(d=1;;){if(j=jt(7,0,(15-d|0)*3|0)|0,!((j&i|0)==0&((Ut()|0)&r|0)==0)){_=0;break e}if(d>>>0<B>>>0)d=d+1|0;else break}if(_&1)_=1;else return j=jt(B+1|0,0,52)|0,ue=Ut()|0|r&-15728641,Y=jt(7,0,(14-B|0)*3|0)|0,ue=fo((j|i)&~Y,ue&~(Ut()|0),l)|0,Lt=Se,ue|0}else _=0;while(!1);if(d=Yr(i,r,w)|0,!d){_?(Dr(w,Y,ue),j=5):(So(w,Y,ue),j=6);e:do if(tt(T)|0)if(!B)i=5;else for(d=1;;){if(T=jt(7,0,(15-d|0)*3|0)|0,!((T&i|0)==0&((Ut()|0)&r|0)==0)){i=2;break e}if(d>>>0<B>>>0)d=d+1|0;else{i=5;break}}else i=2;while(!1);O(l|0,-1,i<<2|0)|0;e:do if(_)for(w=0;;){if(T=ue+(w<<4)|0,Kr(T,o[Y>>2]|0)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}else for(w=0;;){if(T=ue+(w<<4)|0,Za(T,o[Y>>2]|0,0,1)|0,T=o[T>>2]|0,B=o[l>>2]|0,(B|0)==-1|(B|0)==(T|0))d=l;else{_=0;do{if(_=_+1|0,_>>>0>=i>>>0){d=1;break e}d=l+(_<<2)|0,B=o[d>>2]|0}while(!((B|0)==-1|(B|0)==(T|0)))}if(o[d>>2]=T,w=w+1|0,w>>>0>=j>>>0){d=0;break}}while(!1)}return ue=d,Lt=Se,ue|0}function ea(){return 12}function Sa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i>>>0>15)return B=4,B|0;if(jt(i|0,0,52)|0,B=Ut()|0|134225919,!i){l=0,d=0;do tt(d)|0&&(jt(d|0,0,45)|0,T=B|(Ut()|0),i=r+(l<<3)|0,o[i>>2]=-1,o[i+4>>2]=T,l=l+1|0),d=d+1|0;while((d|0)!=122);return l=0,l|0}l=0,T=0;do{if(tt(T)|0){for(jt(T|0,0,45)|0,d=1,_=-1,w=B|(Ut()|0);j=jt(7,0,(15-d|0)*3|0)|0,_=_&~j,w=w&~(Ut()|0),(d|0)!=(i|0);)d=d+1|0;j=r+(l<<3)|0,o[j>>2]=_,o[j+4>>2]=w,l=l+1|0}T=T+1|0}while((T|0)!=122);return l=0,l|0}function ka(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0;if(ct=Lt,Lt=Lt+16|0,vt=ct,ot=Gt(i|0,r|0,52)|0,Ut()|0,ot=ot&15,l>>>0>15)return ot=4,Lt=ct,ot|0;if((ot|0)<(l|0))return ot=12,Lt=ct,ot|0;if((ot|0)!=(l|0))if(w=jt(l|0,0,52)|0,w=w|i,B=Ut()|0|r&-15728641,(ot|0)>(l|0)){j=l;do $e=jt(7,0,(14-j|0)*3|0)|0,j=j+1|0,w=$e|w,B=Ut()|0|B;while((j|0)<(ot|0));$e=w}else $e=w;else $e=i,B=r;Be=Gt($e|0,B|0,45)|0,Ut()|0;e:do if(tt(Be&127)|0){if(j=Gt($e|0,B|0,52)|0,Ut()|0,j=j&15,j|0)for(w=1;;){if(Be=jt(7,0,(15-w|0)*3|0)|0,!((Be&$e|0)==0&((Ut()|0)&B|0)==0)){Y=33;break e}if(w>>>0<j>>>0)w=w+1|0;else break}if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(ot|0)>(l|0)){for(Be=r&-15728641,Re=ot;;){if(Te=Re,Re=Re+-1|0,Re>>>0>15|(ot|0)<(Re|0)){Y=19;break}if((ot|0)!=(Re|0))if(w=jt(Re|0,0,52)|0,w=w|i,j=Ut()|0|Be,(ot|0)<(Te|0))Se=w;else{Y=Re;do Se=jt(7,0,(14-Y|0)*3|0)|0,Y=Y+1|0,w=Se|w,j=Ut()|0|j;while((Y|0)<(ot|0));Se=w}else Se=i,j=r;if(ue=Gt(Se|0,j|0,45)|0,Ut()|0,!(tt(ue&127)|0))w=0;else{ue=Gt(Se|0,j|0,52)|0,Ut()|0,ue=ue&15;t:do if(!ue)w=0;else for(Y=1;;){if(w=Gt(Se|0,j|0,(15-Y|0)*3|0)|0,Ut()|0,w=w&7,w|0)break t;if(Y>>>0<ue>>>0)Y=Y+1|0;else{w=0;break}}while(!1);w=(w|0)==0&1}if(j=Gt(i|0,r|0,(15-Te|0)*3|0)|0,Ut()|0,j=j&7,(j|0)==7){_=5,Y=42;break}if(w=(w|0)!=0,(j|0)==1&w){_=5,Y=42;break}if(Se=j+(((j|0)!=0&w)<<31>>31)|0,Se|0&&(Y=ot-Te|0,Y=_l(7,0,Y,((Y|0)<0)<<31>>31)|0,ue=Ut()|0,w?(w=We(Y|0,ue|0,5,0)|0,w=z(w|0,Ut()|0,-5,-1)|0,w=ae(w|0,Ut()|0,6,0)|0,w=z(w|0,Ut()|0,1,0)|0,j=Ut()|0):(w=Y,j=ue),Te=Se+-1|0,Te=We(Y|0,ue|0,Te|0,((Te|0)<0)<<31>>31|0)|0,Te=z(w|0,j|0,Te|0,Ut()|0)|0,Se=Ut()|0,ue=d,ue=z(Te|0,Se|0,o[ue>>2]|0,o[ue+4>>2]|0)|0,Se=Ut()|0,Te=d,o[Te>>2]=ue,o[Te+4>>2]=Se),(Re|0)<=(l|0)){Y=37;break}}if((Y|0)==19)En(23313,22674,1099,22710);else if((Y|0)==37){T=d,_=o[T+4>>2]|0,T=o[T>>2]|0;break}else if((Y|0)==42)return Lt=ct,_|0}else _=0,T=0}else Y=33;while(!1);e:do if((Y|0)==33)if(Be=d,o[Be>>2]=0,o[Be+4>>2]=0,(ot|0)>(l|0)){for(w=ot;;){if(_=Gt(i|0,r|0,(15-w|0)*3|0)|0,Ut()|0,_=_&7,(_|0)==7){_=5;break}if(T=ot-w|0,T=_l(7,0,T,((T|0)<0)<<31>>31)|0,_=We(T|0,Ut()|0,_|0,0)|0,T=Ut()|0,Be=d,T=z(o[Be>>2]|0,o[Be+4>>2]|0,_|0,T|0)|0,_=Ut()|0,Be=d,o[Be>>2]=T,o[Be+4>>2]=_,w=w+-1|0,(w|0)<=(l|0))break e}return Lt=ct,_|0}else _=0,T=0;while(!1);return ks($e,B,ot,vt)|0&&En(23313,22674,1063,22725),ot=vt,vt=o[ot+4>>2]|0,((_|0)>-1|(_|0)==-1&T>>>0>4294967295)&((vt|0)>(_|0)|((vt|0)==(_|0)?(o[ot>>2]|0)>>>0>T>>>0:0))?(ot=0,Lt=ct,ot|0):(En(23313,22674,1139,22710),0)}function Wa(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0;if(Se=Lt,Lt=Lt+16|0,T=Se,_>>>0>15)return w=4,Lt=Se,w|0;if(B=Gt(l|0,d|0,52)|0,Ut()|0,B=B&15,(B|0)>(_|0))return w=12,Lt=Se,w|0;if(ks(l,d,_,T)|0&&En(23313,22674,1063,22725),ue=T,Y=o[ue+4>>2]|0,!(((r|0)>-1|(r|0)==-1&i>>>0>4294967295)&((Y|0)>(r|0)|((Y|0)==(r|0)?(o[ue>>2]|0)>>>0>i>>>0:0))))return w=2,Lt=Se,w|0;ue=_-B|0,_=jt(_|0,0,52)|0,j=Ut()|0|d&-15728641,Y=w,o[Y>>2]=_|l,o[Y+4>>2]=j,Y=Gt(l|0,d|0,45)|0,Ut()|0;e:do if(tt(Y&127)|0){if(B|0)for(T=1;;){if(Y=jt(7,0,(15-T|0)*3|0)|0,!((Y&l|0)==0&((Ut()|0)&d|0)==0))break e;if(T>>>0<B>>>0)T=T+1|0;else break}if((ue|0)<1)return w=0,Lt=Se,w|0;for(Y=B^15,d=-1,j=1,T=1;;){B=ue-j|0,B=_l(7,0,B,((B|0)<0)<<31>>31)|0,l=Ut()|0;do if(T)if(T=We(B|0,l|0,5,0)|0,T=z(T|0,Ut()|0,-5,-1)|0,T=ae(T|0,Ut()|0,6,0)|0,_=Ut()|0,(r|0)>(_|0)|(r|0)==(_|0)&i>>>0>T>>>0){r=z(i|0,r|0,-1,-1)|0,r=R(r|0,Ut()|0,T|0,_|0)|0,T=Ut()|0,Te=w,Be=o[Te>>2]|0,Te=o[Te+4>>2]|0,$e=(Y+d|0)*3|0,Re=jt(7,0,$e|0)|0,Te=Te&~(Ut()|0),d=ae(r|0,T|0,B|0,l|0)|0,i=Ut()|0,_=z(d|0,i|0,2,0)|0,$e=jt(_|0,Ut()|0,$e|0)|0,Te=Ut()|0|Te,_=w,o[_>>2]=$e|Be&~Re,o[_+4>>2]=Te,i=We(d|0,i|0,B|0,l|0)|0,i=R(r|0,T|0,i|0,Ut()|0)|0,T=0,r=Ut()|0;break}else{$e=w,Re=o[$e>>2]|0,$e=o[$e+4>>2]|0,Be=jt(7,0,(Y+d|0)*3|0)|0,$e=$e&~(Ut()|0),T=w,o[T>>2]=Re&~Be,o[T+4>>2]=$e,T=1;break}else Re=w,_=o[Re>>2]|0,Re=o[Re+4>>2]|0,d=(Y+d|0)*3|0,Te=jt(7,0,d|0)|0,Re=Re&~(Ut()|0),$e=ae(i|0,r|0,B|0,l|0)|0,T=Ut()|0,d=jt($e|0,T|0,d|0)|0,Re=Ut()|0|Re,Be=w,o[Be>>2]=d|_&~Te,o[Be+4>>2]=Re,T=We($e|0,T|0,B|0,l|0)|0,i=R(i|0,r|0,T|0,Ut()|0)|0,T=0,r=Ut()|0;while(!1);if((ue|0)>(j|0))d=~j,j=j+1|0;else{r=0;break}}return Lt=Se,r|0}while(!1);if((ue|0)<1)return $e=0,Lt=Se,$e|0;for(_=B^15,T=1;;)if(Be=ue-T|0,Be=_l(7,0,Be,((Be|0)<0)<<31>>31)|0,$e=Ut()|0,j=w,l=o[j>>2]|0,j=o[j+4>>2]|0,B=(_-T|0)*3|0,d=jt(7,0,B|0)|0,j=j&~(Ut()|0),Te=ae(i|0,r|0,Be|0,$e|0)|0,Re=Ut()|0,B=jt(Te|0,Re|0,B|0)|0,j=Ut()|0|j,Y=w,o[Y>>2]=B|l&~d,o[Y+4>>2]=j,$e=We(Te|0,Re|0,Be|0,$e|0)|0,i=R(i|0,r|0,$e|0,Ut()|0)|0,r=Ut()|0,(ue|0)<=(T|0)){r=0;break}else T=T+1|0;return Lt=Se,r|0}function ll(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;_=Gt(r|0,l|0,52)|0,Ut()|0,_=_&15,(r|0)==0&(l|0)==0|((d|0)>15|(_|0)>(d|0))?(d=-1,_=-1,r=0,l=0):(w=al(r,l,_+1|0,d)|0,l=(Ut()|0)&-15728641,r=jt(d|0,0,52)|0,r=w|r,l=l|(Ut()|0),w=(Cr(r,l)|0)==0,d=w?-1:d),w=i,o[w>>2]=r,o[w+4>>2]=l,o[i+8>>2]=_,o[i+12>>2]=d}function ou(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0;if(l=i,r=o[l>>2]|0,l=o[l+4>>2]|0,!((r|0)==0&(l|0)==0)&&(d=Gt(r|0,l|0,52)|0,Ut()|0,d=d&15,B=jt(1,0,(d^15)*3|0)|0,r=z(B|0,Ut()|0,r|0,l|0)|0,l=Ut()|0,B=i,o[B>>2]=r,o[B+4>>2]=l,B=i+8|0,T=o[B>>2]|0,!((d|0)<(T|0)))){for(j=i+12|0,w=d;;){if((w|0)==(T|0)){d=5;break}if(Y=(w|0)==(o[j>>2]|0),_=(15-w|0)*3|0,d=Gt(r|0,l|0,_|0)|0,Ut()|0,d=d&7,Y&((d|0)==1&!0)){d=7;break}if(!((d|0)==7&!0)){d=10;break}if(Y=jt(1,0,_|0)|0,r=z(r|0,l|0,Y|0,Ut()|0)|0,l=Ut()|0,Y=i,o[Y>>2]=r,o[Y+4>>2]=l,(w|0)>(T|0))w=w+-1|0;else{d=10;break}}if((d|0)==5){Y=i,o[Y>>2]=0,o[Y+4>>2]=0,o[B>>2]=-1,o[j>>2]=-1;return}else if((d|0)==7){T=jt(1,0,_|0)|0,T=z(r|0,l|0,T|0,Ut()|0)|0,B=Ut()|0,Y=i,o[Y>>2]=T,o[Y+4>>2]=B,o[j>>2]=w+-1;return}else if((d|0)==10)return}}function gl(i){i=+i;var r=0;return r=i<0?i+6.283185307179586:i,+(i>=6.283185307179586?r+-6.283185307179586:r)}function io(i,r){return i=i|0,r=r|0,+Kt(+(+ke[i>>3]-+ke[r>>3]))<17453292519943298e-27?(r=+Kt(+(+ke[i+8>>3]-+ke[r+8>>3]))<17453292519943298e-27,r|0):(r=0,r|0)}function mi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+wi(+((_-d)*.5)),l=+wi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+Vn(+ +oi(+l),+ +oi(+(1-l)))*2)}function Ni(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+wi(+((_-d)*.5)),l=+wi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+Vn(+ +oi(+l),+ +oi(+(1-l)))*2*6371.007180918475)}function Di(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=+ke[r>>3],d=+ke[i>>3],w=+wi(+((_-d)*.5)),l=+wi(+((+ke[r+8>>3]-+ke[i+8>>3])*.5)),l=w*w+l*(+vi(+_)*+vi(+d)*l),+(+Vn(+ +oi(+l),+ +oi(+(1-l)))*2*6371.007180918475*1e3)}function Ot(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0;return w=+ke[r>>3],d=+vi(+w),_=+ke[r+8>>3]-+ke[i+8>>3],T=d*+wi(+_),l=+ke[i>>3],+ +Vn(+T,+(+wi(+w)*+vi(+l)-+vi(+_)*(d*+wi(+l))))}function ei(i,r,l,d){i=i|0,r=+r,l=+l,d=d|0;var _=0,w=0,T=0,B=0;if(l<1e-16){o[d>>2]=o[i>>2],o[d+4>>2]=o[i+4>>2],o[d+8>>2]=o[i+8>>2],o[d+12>>2]=o[i+12>>2];return}w=r<0?r+6.283185307179586:r,w=r>=6.283185307179586?w+-6.283185307179586:w;do if(w<1e-16)r=+ke[i>>3]+l,ke[d>>3]=r,_=d;else{if(_=+Kt(+(w+-3.141592653589793))<1e-16,r=+ke[i>>3],_){r=r-l,ke[d>>3]=r,_=d;break}if(T=+vi(+l),l=+wi(+l),r=T*+wi(+r)+ +vi(+w)*(l*+vi(+r)),r=r>1?1:r,r=+ar(+(r<-1?-1:r)),ke[d>>3]=r,+Kt(+(r+-1.5707963267948966))<1e-16){ke[d>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+Kt(+(r+1.5707963267948966))<1e-16){ke[d>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(B=+vi(+r),w=l*+wi(+w)/B,l=+ke[i>>3],r=(T-+wi(+r)*+wi(+l))/+vi(+l)/B,T=w>1?1:w,r=r>1?1:r,r=+ke[i+8>>3]+ +Vn(+(T<-1?-1:T),+(r<-1?-1:r)),r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r;return}while(!1);if(+Kt(+(r+-1.5707963267948966))<1e-16){ke[_>>3]=1.5707963267948966,ke[d+8>>3]=0;return}if(+Kt(+(r+1.5707963267948966))<1e-16){ke[_>>3]=-1.5707963267948966,ke[d+8>>3]=0;return}if(r=+ke[i+8>>3],r>3.141592653589793)do r=r+-6.283185307179586;while(r>3.141592653589793);if(r<-3.141592653589793)do r=r+6.283185307179586;while(r<-3.141592653589793);ke[d+8>>3]=r}function xi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20528+(i<<3)>>3],r=0,r|0)}function Oi(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20656+(i<<3)>>3],r=0,r|0)}function Ln(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20784+(i<<3)>>3],r=0,r|0)}function Un(i,r){return i=i|0,r=r|0,i>>>0>15?(r=4,r|0):(ke[r>>3]=+ke[20912+(i<<3)>>3],r=0,r|0)}function or(i,r){i=i|0,r=r|0;var l=0;return i>>>0>15?(r=4,r|0):(l=_l(7,0,i,((i|0)<0)<<31>>31)|0,l=We(l|0,Ut()|0,120,0)|0,i=Ut()|0,o[r>>2]=l|2,o[r+4>>2]=i,r=0,r|0)}function Yn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0;return Te=+ke[r>>3],ue=+ke[i>>3],j=+wi(+((Te-ue)*.5)),w=+ke[r+8>>3],Y=+ke[i+8>>3],T=+wi(+((w-Y)*.5)),B=+vi(+ue),Se=+vi(+Te),T=j*j+T*(Se*B*T),T=+Vn(+ +oi(+T),+ +oi(+(1-T)))*2,j=+ke[l>>3],Te=+wi(+((j-Te)*.5)),d=+ke[l+8>>3],w=+wi(+((d-w)*.5)),_=+vi(+j),w=Te*Te+w*(Se*_*w),w=+Vn(+ +oi(+w),+ +oi(+(1-w)))*2,j=+wi(+((ue-j)*.5)),d=+wi(+((Y-d)*.5)),d=j*j+d*(B*_*d),d=+Vn(+ +oi(+d),+ +oi(+(1-d)))*2,_=(T+w+d)*.5,+(+dn(+ +oi(+(+Yt(+(_*.5))*+Yt(+((_-T)*.5))*+Yt(+((_-w)*.5))*+Yt(+((_-d)*.5)))))*4)}function qs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0;if(B=Lt,Lt=Lt+192|0,w=B+168|0,T=B,_=mr(i,r,w)|0,_|0)return l=_,Lt=B,l|0;if(Rr(i,r,T)|0&&En(23313,22742,386,22751),r=o[T>>2]|0,(r|0)>0){if(d=+Yn(T+8|0,T+8+(((r|0)!=1&1)<<4)|0,w)+0,(r|0)!=1){i=1;do _=i,i=i+1|0,d=d+ +Yn(T+8+(_<<4)|0,T+8+(((i|0)%(r|0)|0)<<4)|0,w);while((i|0)<(r|0))}}else d=0;return ke[l>>3]=d,l=0,Lt=B,l|0}function Ms(i,r,l){return i=i|0,r=r|0,l=l|0,i=qs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475),i|0}function As(i,r,l){return i=i|0,r=r|0,l=l|0,i=qs(i,r,l)|0,i|0||(ke[l>>3]=+ke[l>>3]*6371.007180918475*6371.007180918475*1e3*1e3),i|0}function Xa(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0;if(B=Lt,Lt=Lt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,Lt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,Lt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,Y=d,d=+ke[T+8+(i<<4)>>3],ue=+wi(+((d-Y)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+wi(+((_-j)*.5)),j=ue*ue+j*(+vi(+d)*+vi(+Y)*j),w=w+ +Vn(+ +oi(+j),+ +oi(+(1-j)))*2;while((i|0)<(r|0));return ke[l>>3]=w,T=0,Lt=B,T|0}function po(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0;if(B=Lt,Lt=Lt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,ke[l>>3]=w,Lt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,ke[l>>3]=w,Lt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,Y=d,d=+ke[T+8+(i<<4)>>3],ue=+wi(+((d-Y)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+wi(+((_-j)*.5)),j=ue*ue+j*(+vi(+Y)*+vi(+d)*j),w=w+ +Vn(+ +oi(+j),+ +oi(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ue=w,ue=ue*6371.007180918475,ke[l>>3]=ue,Lt=B,T|0}function rs(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0;if(B=Lt,Lt=Lt+176|0,T=B,i=ba(i,r,T)|0,i|0)return T=i,w=+ke[l>>3],w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Lt=B,T|0;if(ke[l>>3]=0,i=o[T>>2]|0,(i|0)<=1)return T=0,w=0,w=w*6371.007180918475,w=w*1e3,ke[l>>3]=w,Lt=B,T|0;r=i+-1|0,i=0,d=+ke[T+8>>3],_=+ke[T+16>>3],w=0;do i=i+1|0,Y=d,d=+ke[T+8+(i<<4)>>3],ue=+wi(+((d-Y)*.5)),j=_,_=+ke[T+8+(i<<4)+8>>3],j=+wi(+((_-j)*.5)),j=ue*ue+j*(+vi(+Y)*+vi(+d)*j),w=w+ +Vn(+ +oi(+j),+ +oi(+(1-j)))*2;while((i|0)!=(r|0));return ke[l>>3]=w,T=0,ue=w,ue=ue*6371.007180918475,ue=ue*1e3,ke[l>>3]=ue,Lt=B,T|0}function Qu(i){i=i|0;var r=0,l=0,d=0;return r=D(1,12)|0,r||En(22832,22787,49,22845),l=i+4|0,d=o[l>>2]|0,d|0?(d=d+8|0,o[d>>2]=r,o[l>>2]=r,r|0):(o[i>>2]|0&&En(22862,22787,61,22885),d=i,o[d>>2]=r,o[l>>2]=r,r|0)}function zu(i,r){i=i|0,r=r|0;var l=0,d=0;return d=Ps(24)|0,d||En(22899,22787,78,22913),o[d>>2]=o[r>>2],o[d+4>>2]=o[r+4>>2],o[d+8>>2]=o[r+8>>2],o[d+12>>2]=o[r+12>>2],o[d+16>>2]=0,r=i+4|0,l=o[r>>2]|0,l|0?(o[l+16>>2]=d,o[r>>2]=d,d|0):(o[i>>2]|0&&En(22928,22787,82,22913),o[i>>2]=d,o[r>>2]=d,d|0)}function mo(i){i=i|0;var r=0,l=0,d=0,_=0;if(i)for(d=1;;){if(r=o[i>>2]|0,r|0)do{if(l=o[r>>2]|0,l|0)do _=l,l=o[l+16>>2]|0,C(_);while(l|0);_=r,r=o[r+8>>2]|0,C(_)}while(r|0);if(r=i,i=o[i+8>>2]|0,d||C(r),i)d=0;else break}}function Ml(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0,si=0,ji=0,Zi=0,Ii=0,Vi=0,Ui=0,an=0,Bn=0,Ji=0;if(_=i+8|0,o[_>>2]|0)return Ji=1,Ji|0;if(d=o[i>>2]|0,!d)return Ji=0,Ji|0;r=d,l=0;do l=l+1|0,r=o[r+8>>2]|0;while(r|0);if(l>>>0<2)return Ji=0,Ji|0;an=Ps(l<<2)|0,an||En(22948,22787,317,22967),Ui=Ps(l<<5)|0,Ui||En(22989,22787,321,22967),o[i>>2]=0,Xt=i+4|0,o[Xt>>2]=0,o[_>>2]=0,l=0,Vi=0,ri=0,Se=0;e:for(;;){if(ue=o[d>>2]|0,ue){w=0,T=ue;do{if(j=+ke[T+8>>3],r=T,T=o[T+16>>2]|0,Y=(T|0)==0,_=Y?ue:T,B=+ke[_+8>>3],+Kt(+(j-B))>3.141592653589793){Ji=14;break}w=w+(B-j)*(+ke[r>>3]+ +ke[_>>3])}while(!Y);if((Ji|0)==14){Ji=0,w=0,r=ue;do wt=+ke[r+8>>3],Ii=r+16|0,Zi=o[Ii>>2]|0,Zi=Zi|0?Zi:ue,Et=+ke[Zi+8>>3],w=w+(+ke[r>>3]+ +ke[Zi>>3])*((Et<0?Et+6.283185307179586:Et)-(wt<0?wt+6.283185307179586:wt)),r=o[(r|0?Ii:d)>>2]|0;while(r|0)}w>0?(o[an+(Vi<<2)>>2]=d,Vi=Vi+1|0,_=ri,r=Se):Ji=19}else Ji=19;if((Ji|0)==19){Ji=0;do if(l){if(r=l+8|0,o[r>>2]|0){Ji=21;break e}if(l=D(1,12)|0,!l){Ji=23;break e}o[r>>2]=l,_=l+4|0,T=l,r=Se}else if(Se){_=Xt,T=Se+8|0,r=d,l=i;break}else if(o[i>>2]|0){Ji=27;break e}else{_=Xt,T=i,r=d,l=i;break}while(!1);if(o[T>>2]=d,o[_>>2]=d,T=Ui+(ri<<5)|0,Y=o[d>>2]|0,Y){for(ue=Ui+(ri<<5)+8|0,ke[ue>>3]=17976931348623157e292,Se=Ui+(ri<<5)+24|0,ke[Se>>3]=17976931348623157e292,ke[T>>3]=-17976931348623157e292,Te=Ui+(ri<<5)+16|0,ke[Te>>3]=-17976931348623157e292,ot=17976931348623157e292,ct=-17976931348623157e292,_=0,Re=Y,j=17976931348623157e292,$e=17976931348623157e292,vt=-17976931348623157e292,B=-17976931348623157e292;w=+ke[Re>>3],wt=+ke[Re+8>>3],Re=o[Re+16>>2]|0,Be=(Re|0)==0,Et=+ke[(Be?Y:Re)+8>>3],w<j&&(ke[ue>>3]=w,j=w),wt<$e&&(ke[Se>>3]=wt,$e=wt),w>vt?ke[T>>3]=w:w=vt,wt>B&&(ke[Te>>3]=wt,B=wt),ot=wt>0&wt<ot?wt:ot,ct=wt<0&wt>ct?wt:ct,_=_|+Kt(+(wt-Et))>3.141592653589793,!Be;)vt=w;_&&(ke[Te>>3]=ct,ke[Se>>3]=ot)}else o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[T+12>>2]=0,o[T+16>>2]=0,o[T+20>>2]=0,o[T+24>>2]=0,o[T+28>>2]=0;_=ri+1|0}if(Ii=d+8|0,d=o[Ii>>2]|0,o[Ii>>2]=0,d)ri=_,Se=r;else{Ji=45;break}}if((Ji|0)==21)En(22765,22787,35,22799);else if((Ji|0)==23)En(22819,22787,37,22799);else if((Ji|0)==27)En(22862,22787,61,22885);else if((Ji|0)==45){e:do if((Vi|0)>0){for(Ii=(_|0)==0,ji=_<<2,Zi=(i|0)==0,si=0,r=0;;){if(Jt=o[an+(si<<2)>>2]|0,Ii)Ji=73;else{if(ri=Ps(ji)|0,!ri){Ji=50;break}if(Xt=Ps(ji)|0,!Xt){Ji=52;break}t:do if(Zi)l=0;else{for(_=0,l=0,T=i;d=Ui+(_<<5)|0,Pn(o[T>>2]|0,d,o[Jt>>2]|0)|0?(o[ri+(l<<2)>>2]=T,o[Xt+(l<<2)>>2]=d,Be=l+1|0):Be=l,T=o[T+8>>2]|0,T;)_=_+1|0,l=Be;if((Be|0)>0)if(d=o[ri>>2]|0,(Be|0)==1)l=d;else for(Te=0,Re=-1,l=d,Se=d;;){for(Y=o[Se>>2]|0,d=0,T=0;_=o[o[ri+(T<<2)>>2]>>2]|0,(_|0)==(Y|0)?ue=d:ue=d+((Pn(_,o[Xt+(T<<2)>>2]|0,o[Y>>2]|0)|0)&1)|0,T=T+1|0,(T|0)!=(Be|0);)d=ue;if(_=(ue|0)>(Re|0),l=_?Se:l,d=Te+1|0,(d|0)==(Be|0))break t;Te=d,Re=_?ue:Re,Se=o[ri+(d<<2)>>2]|0}else l=0}while(!1);if(C(ri),C(Xt),l){if(_=l+4|0,d=o[_>>2]|0,d)l=d+8|0;else if(o[l>>2]|0){Ji=70;break}o[l>>2]=Jt,o[_>>2]=Jt}else Ji=73}if((Ji|0)==73){if(Ji=0,r=o[Jt>>2]|0,r|0)do Xt=r,r=o[r+16>>2]|0,C(Xt);while(r|0);C(Jt),r=1}if(si=si+1|0,(si|0)>=(Vi|0)){Bn=r;break e}}(Ji|0)==50?En(23004,22787,249,23023):(Ji|0)==52?En(23042,22787,252,23023):(Ji|0)==70&&En(22862,22787,61,22885)}else Bn=0;while(!1);return C(an),C(Ui),Ji=Bn,Ji|0}return 0}function Pn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0;if(!(qa(r,l)|0)||(r=Ga(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,i=o[i>>2]|0,!i))return i=0,i|0;if(r){r=0,Y=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ue=o[l>>2]|0,ue=ue|0?ue:i,w=+ke[ue>>3],B=+ke[ue+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,Y=B==Y|T==Y?Y+-2220446049250313e-31:Y,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>Y&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}else{r=0,Y=_,l=i;e:for(;;){for(;T=+ke[l>>3],_=+ke[l+8>>3],l=l+16|0,ue=o[l>>2]|0,ue=ue|0?ue:i,w=+ke[ue>>3],B=+ke[ue+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=o[l>>2]|0,!l){l=22;break e}if(Y=T==Y|_==Y?Y+-2220446049250313e-31:Y,T+(_-T)*((d-w)/(j-w))>Y&&(r=r^1),l=o[l>>2]|0,!l){l=22;break}}if((l|0)==22)return r|0}return 0}function Ma(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0;if(ct=Lt,Lt=Lt+32|0,ot=ct+16|0,vt=ct,w=Gt(i|0,r|0,52)|0,Ut()|0,w=w&15,Re=Gt(l|0,d|0,52)|0,Ut()|0,(w|0)!=(Re&15|0))return ot=12,Lt=ct,ot|0;if(Y=Gt(i|0,r|0,45)|0,Ut()|0,Y=Y&127,ue=Gt(l|0,d|0,45)|0,Ut()|0,ue=ue&127,Y>>>0>121|ue>>>0>121)return ot=5,Lt=ct,ot|0;if(Re=(Y|0)!=(ue|0),Re){if(B=hr(Y,ue)|0,(B|0)==7)return ot=1,Lt=ct,ot|0;j=hr(ue,Y)|0,(j|0)==7?En(23066,23090,161,23100):(Be=B,T=j)}else Be=0,T=0;Se=tt(Y)|0,Te=tt(ue)|0,o[ot>>2]=0,o[ot+4>>2]=0,o[ot+8>>2]=0,o[ot+12>>2]=0;do if(Be){if(ue=o[4272+(Y*28|0)+(Be<<2)>>2]|0,B=(ue|0)>0,Te)if(B){Y=0,j=l,B=d;do j=kl(j,B)|0,B=Ut()|0,T=ml(T)|0,(T|0)==1&&(T=ml(1)|0),Y=Y+1|0;while((Y|0)!=(ue|0));ue=T,Y=j,j=B}else ue=T,Y=l,j=d;else if(B){Y=0,j=l,B=d;do j=Ao(j,B)|0,B=Ut()|0,T=ml(T)|0,Y=Y+1|0;while((Y|0)!=(ue|0));ue=T,Y=j,j=B}else ue=T,Y=l,j=d;if($o(Y,j,ot)|0,Re||En(23115,23090,191,23100),B=(Se|0)!=0,T=(Te|0)!=0,B&T&&En(23142,23090,192,23100),B){if(T=wa(i,r)|0,(T|0)==7){w=5;break}if(Tt[21872+(T*7|0)+Be>>0]|0){w=1;break}j=o[21040+(T*28|0)+(Be<<2)>>2]|0,Y=j}else if(T){if(T=wa(Y,j)|0,(T|0)==7){w=5;break}if(Tt[21872+(T*7|0)+ue>>0]|0){w=1;break}Y=0,j=o[21040+(ue*28|0)+(T<<2)>>2]|0}else Y=0,j=0;if((Y|j|0)<0)w=5;else{if((j|0)>0){B=ot+4|0,T=0;do Ha(B),T=T+1|0;while((T|0)!=(j|0))}if(o[vt>>2]=0,o[vt+4>>2]=0,o[vt+8>>2]=0,Ys(vt,Be),w|0)for(;Gs(w)|0?jo(vt):ca(vt),(w|0)>1;)w=w+-1|0;if((Y|0)>0){w=0;do Ha(vt),w=w+1|0;while((w|0)!=(Y|0))}$e=ot+4|0,vr($e,vt,$e),Mr($e),$e=51}}else if($o(l,d,ot)|0,(Se|0)!=0&(Te|0)!=0)if((ue|0)!=(Y|0)&&En(23173,23090,261,23100),T=wa(i,r)|0,w=wa(l,d)|0,(T|0)==7|(w|0)==7)w=5;else if(Tt[21872+(T*7|0)+w>>0]|0)w=1;else if(T=o[21040+(T*28|0)+(w<<2)>>2]|0,(T|0)>0){B=ot+4|0,w=0;do Ha(B),w=w+1|0;while((w|0)!=(T|0));$e=51}else $e=51;else $e=51;while(!1);return($e|0)==51&&(w=ot+4|0,o[_>>2]=o[w>>2],o[_+4>>2]=o[w+4>>2],o[_+8>>2]=o[w+8>>2],w=0),ot=w,Lt=ct,ot|0}function bn(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0;if($e=Lt,Lt=Lt+48|0,Y=$e+36|0,T=$e+24|0,B=$e+12|0,j=$e,_=Gt(i|0,r|0,52)|0,Ut()|0,_=_&15,Te=Gt(i|0,r|0,45)|0,Ut()|0,Te=Te&127,Te>>>0>121)return d=5,Lt=$e,d|0;if(ue=tt(Te)|0,jt(_|0,0,52)|0,vt=Ut()|0|134225919,w=d,o[w>>2]=-1,o[w+4>>2]=vt,!_)return _=bo(l)|0,(_|0)==7||(_=rr(Te,_)|0,(_|0)==127)?(vt=1,Lt=$e,vt|0):(Re=jt(_|0,0,45)|0,Be=Ut()|0,Te=d,Be=o[Te+4>>2]&-1040385|Be,vt=d,o[vt>>2]=o[Te>>2]|Re,o[vt+4>>2]=Be,vt=0,Lt=$e,vt|0);for(o[Y>>2]=o[l>>2],o[Y+4>>2]=o[l+4>>2],o[Y+8>>2]=o[l+8>>2],l=_;;){if(w=l,l=l+-1|0,o[T>>2]=o[Y>>2],o[T+4>>2]=o[Y+4>>2],o[T+8>>2]=o[Y+8>>2],Gs(w)|0){if(_=Ho(Y)|0,_|0){l=13;break}o[B>>2]=o[Y>>2],o[B+4>>2]=o[Y+4>>2],o[B+8>>2]=o[Y+8>>2],jo(B)}else{if(_=Ls(Y)|0,_|0){l=13;break}o[B>>2]=o[Y>>2],o[B+4>>2]=o[Y+4>>2],o[B+8>>2]=o[Y+8>>2],ca(B)}if(Ks(T,B,j),Mr(j),_=d,ct=o[_>>2]|0,_=o[_+4>>2]|0,Et=(15-w|0)*3|0,ot=jt(7,0,Et|0)|0,_=_&~(Ut()|0),Et=jt(bo(j)|0,0,Et|0)|0,_=Ut()|0|_,vt=d,o[vt>>2]=Et|ct&~ot,o[vt+4>>2]=_,(w|0)<=1){l=14;break}}e:do if((l|0)!=13&&(l|0)==14)if((o[Y>>2]|0)<=1&&(o[Y+4>>2]|0)<=1&&(o[Y+8>>2]|0)<=1){l=bo(Y)|0,_=rr(Te,l)|0,(_|0)==127?j=0:j=tt(_)|0;t:do if(l){if(ue){if(_=wa(i,r)|0,(_|0)==7){_=5;break e}if(w=o[21248+(_*28|0)+(l<<2)>>2]|0,(w|0)>0){_=l,l=0;do _=Ta(_)|0,l=l+1|0;while((l|0)!=(w|0))}else _=l;if((_|0)==1){_=9;break e}l=rr(Te,_)|0,(l|0)==127&&En(23200,23090,411,23230),tt(l)|0?En(23245,23090,412,23230):(Be=l,Re=w,Se=_)}else Be=_,Re=0,Se=l;if(B=o[4272+(Te*28|0)+(Se<<2)>>2]|0,(B|0)<=-1&&En(23276,23090,419,23230),!j){if((Re|0)<0){_=5;break e}if(Re|0){w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;do l=Eo(l,w)|0,w=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=w,_=_+1|0;while((_|0)<(Re|0))}if((B|0)<=0){_=Be,l=58;break}for(w=d,_=0,l=o[w>>2]|0,w=o[w+4>>2]|0;;)if(l=Eo(l,w)|0,w=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=w,_=_+1|0,(_|0)==(B|0)){_=Be,l=58;break t}}if(T=hr(Be,Te)|0,(T|0)==7&&En(23066,23090,428,23230),_=d,l=o[_>>2]|0,_=o[_+4>>2]|0,(B|0)>0){w=0;do l=Eo(l,_)|0,_=Ut()|0,Et=d,o[Et>>2]=l,o[Et+4>>2]=_,w=w+1|0;while((w|0)!=(B|0))}if(_=wa(l,_)|0,(_|0)==7&&En(23313,23090,440,23230),l=It(Be)|0,l=o[(l?21664:21456)+(T*28|0)+(_<<2)>>2]|0,(l|0)<0&&En(23313,23090,454,23230),!l)_=Be,l=58;else{T=d,_=0,w=o[T>>2]|0,T=o[T+4>>2]|0;do w=Tl(w,T)|0,T=Ut()|0,Et=d,o[Et>>2]=w,o[Et+4>>2]=T,_=_+1|0;while((_|0)<(l|0));_=Be,l=58}}else if((ue|0)!=0&(j|0)!=0){if(l=wa(i,r)|0,w=d,w=wa(o[w>>2]|0,o[w+4>>2]|0)|0,(l|0)==7|(w|0)==7){_=5;break e}if(w=o[21248+(l*28|0)+(w<<2)>>2]|0,(w|0)<0){_=5;break e}if(!w)l=59;else{B=d,l=0,T=o[B>>2]|0,B=o[B+4>>2]|0;do T=Eo(T,B)|0,B=Ut()|0,Et=d,o[Et>>2]=T,o[Et+4>>2]=B,l=l+1|0;while((l|0)<(w|0));l=58}}else l=58;while(!1);if((l|0)==58&&j&&(l=59),(l|0)==59&&(Et=d,(wa(o[Et>>2]|0,o[Et+4>>2]|0)|0)==1)){_=9;break}Et=d,ot=o[Et>>2]|0,Et=o[Et+4>>2]&-1040385,ct=jt(_|0,0,45)|0,Et=Et|(Ut()|0),_=d,o[_>>2]=ot|ct,o[_+4>>2]=Et,_=0}else _=1;while(!1);return Et=_,Lt=$e,Et|0}function Fo(i,r,l,d,_,w){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0,w=w|0;var T=0,B=0;return B=Lt,Lt=Lt+16|0,T=B,_?i=15:(i=Ma(i,r,l,d,T)|0,i||(sc(T,w),i=0)),Lt=B,i|0}function Nl(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0;return T=Lt,Lt=Lt+16|0,w=T,d?l=15:(l=eo(l,w)|0,l||(l=bn(i,r,w,_)|0)),Lt=T,l|0}function Sn(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Lt,Lt=Lt+32|0,T=j+12|0,B=j,w=Ma(i,r,i,r,T)|0,w|0?(B=w,Lt=j,B|0):(i=Ma(i,r,l,d,B)|0,i|0?(B=i,Lt=j,B|0):(T=us(T,B)|0,B=_,o[B>>2]=T,o[B+4>>2]=((T|0)<0)<<31>>31,B=0,Lt=j,B|0))}function Hl(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0;return j=Lt,Lt=Lt+32|0,T=j+12|0,B=j,w=Ma(i,r,i,r,T)|0,!w&&(w=Ma(i,r,l,d,B)|0,!w)?(d=us(T,B)|0,d=z(d|0,((d|0)<0)<<31>>31|0,1,0)|0,T=Ut()|0,B=_,o[B>>2]=d,o[B+4>>2]=T,B=0,Lt=j,B|0):(B=w,Lt=j,B|0)}function In(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0,si=0;if(Jt=Lt,Lt=Lt+48|0,T=Jt+24|0,B=Jt+12|0,Xt=Jt,w=Ma(i,r,i,r,T)|0,!w&&(w=Ma(i,r,l,d,B)|0,!w)){wt=us(T,B)|0,ri=((wt|0)<0)<<31>>31,o[T>>2]=0,o[T+4>>2]=0,o[T+8>>2]=0,o[B>>2]=0,o[B+4>>2]=0,o[B+8>>2]=0,Ma(i,r,i,r,T)|0&&En(23313,23090,691,23299),Ma(i,r,l,d,B)|0&&En(23313,23090,696,23299),to(T),to(B),wt?(Se=o[T>>2]|0,Be=+(wt|0),ot=T+4|0,Te=o[ot>>2]|0,ct=T+8|0,Re=o[ct>>2]|0,Et=T,d=Se,w=Te,l=Re,$e=+((o[B>>2]|0)-Se|0)/Be,vt=+((o[B+4>>2]|0)-Te|0)/Be,Be=+((o[B+8>>2]|0)-Re|0)/Be):(w=T+4|0,l=T+8|0,ot=w,ct=l,Et=T,d=o[T>>2]|0,w=o[w>>2]|0,l=o[l>>2]|0,$e=0,vt=0,Be=0),o[Xt>>2]=d,Re=Xt+4|0,o[Re>>2]=w,Te=Xt+8|0,o[Te>>2]=l;e:do if((wt|0)<0)w=0;else for(ue=0,Se=0,w=d;;){Y=+(Se>>>0)+4294967296*+(ue|0),si=$e*Y+ +(w|0),j=vt*Y+ +(o[ot>>2]|0),Y=Be*Y+ +(o[ct>>2]|0),l=~~+I(+si),T=~~+I(+j),w=~~+I(+Y),si=+Kt(+(+(l|0)-si)),j=+Kt(+(+(T|0)-j)),Y=+Kt(+(+(w|0)-Y));do if(si>j&si>Y)l=0-(T+w)|0,d=T;else if(B=0-l|0,j>Y){d=B-w|0;break}else{d=T,w=B-T|0;break}while(!1);if(o[Xt>>2]=l,o[Re>>2]=d,o[Te>>2]=w,ql(Xt),w=bn(i,r,Xt,_+(Se<<3)|0)|0,w|0)break e;if(!((ue|0)<(ri|0)|(ue|0)==(ri|0)&Se>>>0<wt>>>0)){w=0;break e}w=z(Se|0,ue|0,1,0)|0,B=Ut()|0,ue=B,Se=w,w=o[Et>>2]|0}while(!1);return Xt=w,Lt=Jt,Xt|0}return Xt=w,Lt=Jt,Xt|0}function _l(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0;if((l|0)==0&(d|0)==0)return _=0,w=1,Yi(_|0),w|0;w=i,_=r,i=1,r=0;do T=(l&1|0)==0&!0,i=We((T?1:w)|0,(T?0:_)|0,i|0,r|0)|0,r=Ut()|0,l=ii(l|0,d|0,1)|0,d=Ut()|0,w=We(w|0,_|0,w|0,_|0)|0,_=Ut()|0;while(!((l|0)==0&(d|0)==0));return Yi(r|0),i|0}function lu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0;if(!(qa(r,l)|0)||(r=Ga(r)|0,d=+ke[l>>3],_=+ke[l+8>>3],_=r&_<0?_+6.283185307179586:_,Te=o[i>>2]|0,(Te|0)<=0))return Te=0,Te|0;if(Se=o[i+4>>2]|0,r){r=0,ue=_,l=-1,i=0;e:for(;;){for(Y=i;T=+ke[Se+(Y<<4)>>3],_=+ke[Se+(Y<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=Y+1|0,(l|0)>=(Te|0)){l=22;break e}else i=Y,Y=l,l=i;if(B=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,ue=B==ue|T==ue?ue+-2220446049250313e-31:ue,j=B+(T-B)*((d-w)/(j-w)),(j<0?j+6.283185307179586:j)>ue&&(r=r^1),i=Y+1|0,(i|0)>=(Te|0)){l=22;break}else l=Y}if((l|0)==22)return r|0}else{r=0,ue=_,l=-1,i=0;e:for(;;){for(Y=i;T=+ke[Se+(Y<<4)>>3],_=+ke[Se+(Y<<4)+8>>3],i=(l+2|0)%(Te|0)|0,w=+ke[Se+(i<<4)>>3],B=+ke[Se+(i<<4)+8>>3],T>w?(j=T,T=B):(j=w,w=T,T=_,_=B),d=d==w|d==j?d+2220446049250313e-31:d,!!(d<w|d>j);)if(l=Y+1|0,(l|0)>=(Te|0)){l=22;break e}else i=Y,Y=l,l=i;if(ue=T==ue|_==ue?ue+-2220446049250313e-31:ue,T+(_-T)*((d-w)/(j-w))>ue&&(r=r^1),i=Y+1|0,(i|0)>=(Te|0)){l=22;break}else l=Y}if((l|0)==22)return r|0}return 0}function Ru(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0;if(Be=o[i>>2]|0,!Be){o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;return}if($e=r+8|0,ke[$e>>3]=17976931348623157e292,vt=r+24|0,ke[vt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,ot=r+16|0,ke[ot>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Te=o[i+4>>2]|0,Y=17976931348623157e292,ue=-17976931348623157e292,Se=0,i=-1,w=17976931348623157e292,T=17976931348623157e292,j=-17976931348623157e292,d=-17976931348623157e292,Re=0;l=+ke[Te+(Re<<4)>>3],B=+ke[Te+(Re<<4)+8>>3],i=i+2|0,_=+ke[Te+(((i|0)==(Be|0)?0:i)<<4)+8>>3],l<w&&(ke[$e>>3]=l,w=l),B<T&&(ke[vt>>3]=B,T=B),l>j?ke[r>>3]=l:l=j,B>d&&(ke[ot>>3]=B,d=B),Y=B>0&B<Y?B:Y,ue=B<0&B>ue?B:ue,Se=Se|+Kt(+(B-_))>3.141592653589793,i=Re+1|0,(i|0)!=(Be|0);)ct=Re,j=l,Re=i,i=ct;Se&&(ke[ot>>3]=ue,ke[vt>>3]=Y)}}function Vl(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0,Xt=0,Jt=0;if(Be=o[i>>2]|0,Be){if($e=r+8|0,ke[$e>>3]=17976931348623157e292,vt=r+24|0,ke[vt>>3]=17976931348623157e292,ke[r>>3]=-17976931348623157e292,ot=r+16|0,ke[ot>>3]=-17976931348623157e292,(Be|0)>0){for(_=o[i+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,d=0,l=-1,j=17976931348623157e292,Y=17976931348623157e292,Se=-17976931348623157e292,T=-17976931348623157e292,ct=0;w=+ke[_+(ct<<4)>>3],ue=+ke[_+(ct<<4)+8>>3],Xt=l+2|0,B=+ke[_+(((Xt|0)==(Be|0)?0:Xt)<<4)+8>>3],w<j&&(ke[$e>>3]=w,j=w),ue<Y&&(ke[vt>>3]=ue,Y=ue),w>Se?ke[r>>3]=w:w=Se,ue>T&&(ke[ot>>3]=ue,T=ue),Te=ue>0&ue<Te?ue:Te,Re=ue<0&ue>Re?ue:Re,d=d|+Kt(+(ue-B))>3.141592653589793,l=ct+1|0,(l|0)!=(Be|0);)Xt=ct,Se=w,ct=l,l=Xt;d&&(ke[ot>>3]=Re,ke[vt>>3]=Te)}}else o[r>>2]=0,o[r+4>>2]=0,o[r+8>>2]=0,o[r+12>>2]=0,o[r+16>>2]=0,o[r+20>>2]=0,o[r+24>>2]=0,o[r+28>>2]=0;if(Xt=i+8|0,l=o[Xt>>2]|0,!((l|0)<=0)){ri=i+12|0,wt=0;do if(_=o[ri>>2]|0,d=wt,wt=wt+1|0,vt=r+(wt<<5)|0,ot=o[_+(d<<3)>>2]|0,ot){if(ct=r+(wt<<5)+8|0,ke[ct>>3]=17976931348623157e292,i=r+(wt<<5)+24|0,ke[i>>3]=17976931348623157e292,ke[vt>>3]=-17976931348623157e292,Et=r+(wt<<5)+16|0,ke[Et>>3]=-17976931348623157e292,(ot|0)>0){for(Be=o[_+(d<<3)+4>>2]|0,Te=17976931348623157e292,Re=-17976931348623157e292,_=0,d=-1,$e=0,j=17976931348623157e292,Y=17976931348623157e292,ue=-17976931348623157e292,T=-17976931348623157e292;w=+ke[Be+($e<<4)>>3],Se=+ke[Be+($e<<4)+8>>3],d=d+2|0,B=+ke[Be+(((d|0)==(ot|0)?0:d)<<4)+8>>3],w<j&&(ke[ct>>3]=w,j=w),Se<Y&&(ke[i>>3]=Se,Y=Se),w>ue?ke[vt>>3]=w:w=ue,Se>T&&(ke[Et>>3]=Se,T=Se),Te=Se>0&Se<Te?Se:Te,Re=Se<0&Se>Re?Se:Re,_=_|+Kt(+(Se-B))>3.141592653589793,d=$e+1|0,(d|0)!=(ot|0);)Jt=$e,$e=d,ue=w,d=Jt;_&&(ke[Et>>3]=Re,ke[i>>3]=Te)}}else o[vt>>2]=0,o[vt+4>>2]=0,o[vt+8>>2]=0,o[vt+12>>2]=0,o[vt+16>>2]=0,o[vt+20>>2]=0,o[vt+24>>2]=0,o[vt+28>>2]=0,l=o[Xt>>2]|0;while((wt|0)<(l|0))}}function yl(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(!(lu(i,r,l)|0))return _=0,_|0;if(_=i+8|0,(o[_>>2]|0)<=0)return _=1,_|0;for(d=i+12|0,i=0;;){if(w=i,i=i+1|0,lu((o[d>>2]|0)+(w<<3)|0,r+(i<<5)|0,l)|0){i=0,d=6;break}if((i|0)>=(o[_>>2]|0)){i=1,d=6;break}}return(d|0)==6?i|0:0}function ta(){return 8}function ac(){return 16}function Wu(){return 168}function jl(){return 8}function fs(){return 16}function _a(){return 12}function Ko(){return 8}function gu(i){return i=i|0,+(+((o[i>>2]|0)>>>0)+4294967296*+(o[i+4>>2]|0))}function Fu(i){i=i|0;var r=0,l=0;return l=+ke[i>>3],r=+ke[i+8>>3],+ +oi(+(l*l+r*r))}function uu(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0;Y=+ke[i>>3],j=+ke[r>>3]-Y,B=+ke[i+8>>3],T=+ke[r+8>>3]-B,Se=+ke[l>>3],w=+ke[d>>3]-Se,Te=+ke[l+8>>3],ue=+ke[d+8>>3]-Te,w=(w*(B-Te)-(Y-Se)*ue)/(j*ue-T*w),ke[_>>3]=Y+j*w,ke[_+8>>3]=B+T*w}function Ou(i,r){return i=i|0,r=r|0,+Kt(+(+ke[i>>3]-+ke[r>>3]))<11920928955078125e-23?(r=+Kt(+(+ke[i+8>>3]-+ke[r+8>>3]))<11920928955078125e-23,r|0):(r=0,r|0)}function _r(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;return _=+ke[i>>3]-+ke[r>>3],d=+ke[i+8>>3]-+ke[r+8>>3],l=+ke[i+16>>3]-+ke[r+16>>3],+(_*_+d*d+l*l)}function ds(i,r){i=i|0,r=r|0;var l=0,d=0,_=0;l=+ke[i>>3],d=+vi(+l),l=+wi(+l),ke[r+16>>3]=l,l=+ke[i+8>>3],_=d*+vi(+l),ke[r>>3]=_,l=d*+wi(+l),ke[r+8>>3]=l}function pn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if(w=Lt,Lt=Lt+16|0,_=w,d=Cr(i,r)|0,(l+-1|0)>>>0>5||(d=(d|0)!=0,(l|0)==1&d))return _=-1,Lt=w,_|0;do if(Gn(i,r,_)|0)d=-1;else if(d){d=((o[21936+(l<<2)>>2]|0)+5-(o[_>>2]|0)|0)%5|0;break}else{d=((o[21968+(l<<2)>>2]|0)+6-(o[_>>2]|0)|0)%6|0;break}while(!1);return _=d,Lt=w,_|0}function Gn(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0,Y=0;if(Y=Lt,Lt=Lt+32|0,T=Y+16|0,B=Y,d=Yr(i,r,T)|0,d|0)return l=d,Lt=Y,l|0;w=Ol(i,r)|0,j=wa(i,r)|0,Bi(w,B),d=un(w,o[T>>2]|0)|0;e:do if(tt(w)|0){do switch(w|0){case 4:{i=0;break}case 14:{i=1;break}case 24:{i=2;break}case 38:{i=3;break}case 49:{i=4;break}case 58:{i=5;break}case 63:{i=6;break}case 72:{i=7;break}case 83:{i=8;break}case 97:{i=9;break}case 107:{i=10;break}case 117:{i=11;break}default:{d=1;break e}}while(!1);if(_=o[22e3+(i*24|0)+8>>2]|0,r=o[22e3+(i*24|0)+16>>2]|0,i=o[T>>2]|0,(i|0)!=(o[B>>2]|0)&&(B=It(w)|0,i=o[T>>2]|0,B|(i|0)==(r|0)&&(d=(d+1|0)%6|0)),(j|0)==3&(i|0)==(r|0)){d=(d+5|0)%6|0,_=22;break}(j|0)==5&(i|0)==(_|0)&&(d=(d+1|0)%6|0),_=22}else _=22;while(!1);return(_|0)==22&&(o[l>>2]=d,d=0),l=d,Lt=Y,l|0}function Jn(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0;if(Et=Lt,Lt=Lt+32|0,ct=Et+24|0,vt=Et+20|0,Be=Et+8|0,Re=Et+16|0,Te=Et,j=(Cr(i,r)|0)==0,j=j?6:5,ue=Gt(i|0,r|0,52)|0,Ut()|0,ue=ue&15,j>>>0<=l>>>0)return d=2,Lt=Et,d|0;Se=(ue|0)==0,!Se&&($e=jt(7,0,(ue^15)*3|0)|0,($e&i|0)==0&((Ut()|0)&r|0)==0)?_=l:w=4;e:do if((w|0)==4){if(_=(Cr(i,r)|0)!=0,((_?4:5)|0)<(l|0)||Gn(i,r,ct)|0||(w=(o[ct>>2]|0)+l|0,_?_=22288+(((w|0)%5|0)<<2)|0:_=22320+(((w|0)%6|0)<<2)|0,$e=o[_>>2]|0,($e|0)==7))return d=1,Lt=Et,d|0;o[vt>>2]=0,_=ls(i,r,$e,vt,Be)|0;do if(!_){if(B=Be,Y=o[B>>2]|0,B=o[B+4>>2]|0,T=B>>>0<r>>>0|(B|0)==(r|0)&Y>>>0<i>>>0,w=T?Y:i,T=T?B:r,!Se&&(Se=jt(7,0,(ue^15)*3|0)|0,(Y&Se|0)==0&(B&(Ut()|0)|0)==0))_=l;else{if(B=(l+-1+j|0)%(j|0)|0,_=Cr(i,r)|0,(B|0)<0&&En(23313,23315,245,23324),j=(_|0)!=0,((j?4:5)|0)<(B|0)&&En(23313,23315,245,23324),Gn(i,r,ct)|0&&En(23313,23315,245,23324),_=(o[ct>>2]|0)+B|0,j?_=22288+(((_|0)%5|0)<<2)|0:_=22320+(((_|0)%6|0)<<2)|0,B=o[_>>2]|0,(B|0)==7&&En(23313,23315,245,23324),o[Re>>2]=0,_=ls(i,r,B,Re,Te)|0,_|0)break;Y=Te,j=o[Y>>2]|0,Y=o[Y+4>>2]|0;do if(Y>>>0<T>>>0|(Y|0)==(T|0)&j>>>0<w>>>0){if(Cr(j,Y)|0?w=Na(j,Y,i,r)|0:w=o[22384+((((o[Re>>2]|0)+(o[22352+(B<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=Cr(j,Y)|0,(w+-1|0)>>>0>5){_=-1,w=j,T=Y;break}if(_=(_|0)!=0,(w|0)==1&_){_=-1,w=j,T=Y;break}do if(Gn(j,Y,ct)|0)_=-1;else if(_){_=((o[21936+(w<<2)>>2]|0)+5-(o[ct>>2]|0)|0)%5|0;break}else{_=((o[21968+(w<<2)>>2]|0)+6-(o[ct>>2]|0)|0)%6|0;break}while(!1);w=j,T=Y}else _=l;while(!1);B=Be,Y=o[B>>2]|0,B=o[B+4>>2]|0}if((w|0)==(Y|0)&(T|0)==(B|0)){if(j=(Cr(Y,B)|0)!=0,j?i=Na(Y,B,i,r)|0:i=o[22384+((((o[vt>>2]|0)+(o[22352+($e<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=Cr(Y,B)|0,(i+-1|0)>>>0<=5&&(ot=(_|0)!=0,!((i|0)==1&ot)))do if(Gn(Y,B,ct)|0)_=-1;else if(ot){_=((o[21936+(i<<2)>>2]|0)+5-(o[ct>>2]|0)|0)%5|0;break}else{_=((o[21968+(i<<2)>>2]|0)+6-(o[ct>>2]|0)|0)%6|0;break}while(!1);else _=-1;_=_+1|0,_=(_|0)==6|j&(_|0)==5?0:_}r=T,i=w;break e}while(!1);return d=_,Lt=Et,d|0}while(!1);return ot=jt(_|0,0,56)|0,ct=Ut()|0|r&-2130706433|536870912,o[d>>2]=ot|i,o[d+4>>2]=ct,d=0,Lt=Et,d|0}function Jo(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;return w=(Cr(i,r)|0)==0,d=Jn(i,r,0,l)|0,_=(d|0)==0,w?!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d)?(w=d,w|0):Jn(i,r,5,l+40|0)|0:!_||(d=Jn(i,r,1,l+8|0)|0,d|0)||(d=Jn(i,r,2,l+16|0)|0,d|0)||(d=Jn(i,r,3,l+24|0)|0,d|0)||(d=Jn(i,r,4,l+32|0)|0,d|0)?(w=d,w|0):(w=l+40|0,o[w>>2]=0,o[w+4>>2]=0,w=0,w|0)}function Cu(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0,B=0,j=0;return j=Lt,Lt=Lt+192|0,_=j,w=j+168|0,T=Gt(i|0,r|0,56)|0,Ut()|0,T=T&7,B=r&-2130706433|134217728,d=Yr(i,B,w)|0,d|0?(B=d,Lt=j,B|0):(r=Gt(i|0,r|0,52)|0,Ut()|0,r=r&15,Cr(i,B)|0?Yo(w,r,T,1,_):Ar(w,r,T,1,_),B=_+8|0,o[l>>2]=o[B>>2],o[l+4>>2]=o[B+4>>2],o[l+8>>2]=o[B+8>>2],o[l+12>>2]=o[B+12>>2],B=0,Lt=j,B|0)}function oa(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return _=Lt,Lt=Lt+16|0,l=_,!(!0&(r&2013265920|0)==536870912)||(d=r&-2130706433|134217728,!(Jr(i,d)|0))?(d=0,Lt=_,d|0):(w=Gt(i|0,r|0,56)|0,Ut()|0,w=(Jn(i,d,w&7,l)|0)==0,d=l,d=w&((o[d>>2]|0)==(i|0)?(o[d+4>>2]|0)==(r|0):0)&1,Lt=_,d|0)}function _u(i,r,l){i=i|0,r=r|0,l=l|0;var d=0;(r|0)>0?(d=D(r,4)|0,o[i>>2]=d,d||En(23337,23360,40,23374)):o[i>>2]=0,o[i+4>>2]=r,o[i+8>>2]=0,o[i+12>>2]=l}function _s(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0;_=i+4|0,w=i+12|0,T=i+8|0;e:for(;;){for(l=o[_>>2]|0,r=0;;){if((r|0)>=(l|0))break e;if(d=o[i>>2]|0,B=o[d+(r<<2)>>2]|0,!B)r=r+1|0;else break}r=d+(~~(+Kt(+(+Ri(10,+ +(15-(o[w>>2]|0)|0))*(+ke[B>>3]+ +ke[B+8>>3])))%+(l|0))>>>0<<2)|0,l=o[r>>2]|0;t:do if(l|0){if(d=B+32|0,(l|0)==(B|0))o[r>>2]=o[d>>2];else{if(l=l+32|0,r=o[l>>2]|0,!r)break;for(;(r|0)!=(B|0);)if(l=r+32|0,r=o[l>>2]|0,!r)break t;o[l>>2]=o[d>>2]}C(B),o[T>>2]=(o[T>>2]|0)+-1}while(!1)}C(o[i>>2]|0)}function Co(i){i=i|0;var r=0,l=0,d=0;for(d=o[i+4>>2]|0,l=0;;){if((l|0)>=(d|0)){r=0,l=4;break}if(r=o[(o[i>>2]|0)+(l<<2)>>2]|0,!r)l=l+1|0;else{l=4;break}}return(l|0)==4?r|0:0}function Mi(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;if(l=~~(+Kt(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,l=(o[i>>2]|0)+(l<<2)|0,d=o[l>>2]|0,!d)return w=1,w|0;w=r+32|0;do if((d|0)!=(r|0)){if(l=o[d+32>>2]|0,!l)return w=1,w|0;for(_=l;;){if((_|0)==(r|0)){_=8;break}if(l=o[_+32>>2]|0,l)d=_,_=l;else{l=1,_=10;break}}if((_|0)==8){o[d+32>>2]=o[w>>2];break}else if((_|0)==10)return l|0}else o[l>>2]=o[w>>2];while(!1);return C(r),w=i+8|0,o[w>>2]=(o[w>>2]|0)+-1,w=0,w|0}function zi(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;w=Ps(40)|0,w||En(23390,23360,98,23403),o[w>>2]=o[r>>2],o[w+4>>2]=o[r+4>>2],o[w+8>>2]=o[r+8>>2],o[w+12>>2]=o[r+12>>2],_=w+16|0,o[_>>2]=o[l>>2],o[_+4>>2]=o[l+4>>2],o[_+8>>2]=o[l+8>>2],o[_+12>>2]=o[l+12>>2],o[w+32>>2]=0,_=~~(+Kt(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=(o[i>>2]|0)+(_<<2)|0,d=o[_>>2]|0;do if(!d)o[_>>2]=w;else{for(;!(io(d,r)|0&&io(d+16|0,l)|0);)if(_=o[d+32>>2]|0,d=_|0?_:d,!(o[d+32>>2]|0)){T=10;break}if((T|0)==10){o[d+32>>2]=w;break}return C(w),T=d,T|0}while(!1);return T=i+8|0,o[T>>2]=(o[T>>2]|0)+1,T=w,T|0}function ys(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0;if(_=~~(+Kt(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,_=o[(o[i>>2]|0)+(_<<2)>>2]|0,!_)return l=0,l|0;if(!l){for(i=_;;){if(io(i,r)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}if((d|0)==10)return i|0}for(i=_;;){if(io(i,r)|0&&io(i+16|0,l)|0){d=10;break}if(i=o[i+32>>2]|0,!i){i=0,d=10;break}}return(d|0)==10?i|0:0}function yu(i,r){i=i|0,r=r|0;var l=0;if(l=~~(+Kt(+(+Ri(10,+ +(15-(o[i+12>>2]|0)|0))*(+ke[r>>3]+ +ke[r+8>>3])))%+(o[i+4>>2]|0))>>>0,i=o[(o[i>>2]|0)+(l<<2)>>2]|0,!i)return l=0,l|0;for(;;){if(io(i,r)|0){r=5;break}if(i=o[i+32>>2]|0,!i){i=0,r=5;break}}return(r|0)==5?i|0:0}function Oo(){return 23424}function cs(i){return i=+i,+ +y(+i)}function ul(i){return i=+i,~~+cs(i)|0}function Ps(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0,$e=0,vt=0,ot=0,ct=0,Et=0,wt=0,ri=0;ri=Lt,Lt=Lt+16|0,Te=ri;do if(i>>>0<245){if(Y=i>>>0<11?16:i+11&-8,i=Y>>>3,Se=o[5857]|0,l=Se>>>i,l&3|0)return r=(l&1^1)+i|0,i=23468+(r<<1<<2)|0,l=i+8|0,d=o[l>>2]|0,_=d+8|0,w=o[_>>2]|0,(w|0)==(i|0)?o[5857]=Se&~(1<<r):(o[w+12>>2]=i,o[l>>2]=w),wt=r<<3,o[d+4>>2]=wt|3,wt=d+wt+4|0,o[wt>>2]=o[wt>>2]|1,wt=_,Lt=ri,wt|0;if(ue=o[5859]|0,Y>>>0>ue>>>0){if(l|0)return r=2<<i,r=l<<i&(r|0-r),r=(r&0-r)+-1|0,B=r>>>12&16,r=r>>>B,l=r>>>5&8,r=r>>>l,w=r>>>2&4,r=r>>>w,i=r>>>1&2,r=r>>>i,d=r>>>1&1,d=(l|B|w|i|d)+(r>>>d)|0,r=23468+(d<<1<<2)|0,i=r+8|0,w=o[i>>2]|0,B=w+8|0,l=o[B>>2]|0,(l|0)==(r|0)?(i=Se&~(1<<d),o[5857]=i):(o[l+12>>2]=r,o[i>>2]=l,i=Se),wt=d<<3,T=wt-Y|0,o[w+4>>2]=Y|3,_=w+Y|0,o[_+4>>2]=T|1,o[w+wt>>2]=T,ue|0&&(d=o[5862]|0,r=ue>>>3,l=23468+(r<<1<<2)|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=T,o[5862]=_,wt=B,Lt=ri,wt|0;if(w=o[5858]|0,w){for(l=(w&0-w)+-1|0,_=l>>>12&16,l=l>>>_,d=l>>>5&8,l=l>>>d,T=l>>>2&4,l=l>>>T,B=l>>>1&2,l=l>>>B,j=l>>>1&1,j=o[23732+((d|_|T|B|j)+(l>>>j)<<2)>>2]|0,l=j,B=j,j=(o[j+4>>2]&-8)-Y|0;i=o[l+16>>2]|0,!(!i&&(i=o[l+20>>2]|0,!i));)T=(o[i+4>>2]&-8)-Y|0,_=T>>>0<j>>>0,l=i,B=_?i:B,j=_?T:j;if(T=B+Y|0,T>>>0>B>>>0){_=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){l=0;break}for(;;)if(d=r+20|0,l=o[d>>2]|0,l)r=l,i=d;else if(d=r+16|0,l=o[d>>2]|0,l)r=l,i=d;else break;o[i>>2]=0,l=r}else l=o[B+8>>2]|0,o[l+12>>2]=r,o[r+8>>2]=l,l=r;while(!1);do if(_|0){if(r=o[B+28>>2]|0,i=23732+(r<<2)|0,(B|0)==(o[i>>2]|0)){if(o[i>>2]=l,!l){o[5858]=w&~(1<<r);break}}else if(wt=_+16|0,o[((o[wt>>2]|0)==(B|0)?wt:_+20|0)>>2]=l,!l)break;o[l+24>>2]=_,r=o[B+16>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),r=o[B+20>>2]|0,r|0&&(o[l+20>>2]=r,o[r+24>>2]=l)}while(!1);return j>>>0<16?(wt=j+Y|0,o[B+4>>2]=wt|3,wt=B+wt+4|0,o[wt>>2]=o[wt>>2]|1):(o[B+4>>2]=Y|3,o[T+4>>2]=j|1,o[T+j>>2]=j,ue|0&&(d=o[5862]|0,r=ue>>>3,l=23468+(r<<1<<2)|0,r=1<<r,r&Se?(i=l+8|0,r=o[i>>2]|0):(o[5857]=r|Se,r=l,i=l+8|0),o[i>>2]=d,o[r+12>>2]=d,o[d+8>>2]=r,o[d+12>>2]=l),o[5859]=j,o[5862]=T),wt=B+8|0,Lt=ri,wt|0}else Se=Y}else Se=Y}else Se=Y}else if(i>>>0<=4294967231)if(i=i+11|0,Y=i&-8,d=o[5858]|0,d){_=0-Y|0,i=i>>>8,i?Y>>>0>16777215?j=31:(Se=(i+1048320|0)>>>16&8,$e=i<<Se,B=($e+520192|0)>>>16&4,$e=$e<<B,j=($e+245760|0)>>>16&2,j=14-(B|Se|j)+($e<<j>>>15)|0,j=Y>>>(j+7|0)&1|j<<1):j=0,l=o[23732+(j<<2)>>2]|0;e:do if(!l)l=0,i=0,$e=61;else for(i=0,B=Y<<((j|0)==31?0:25-(j>>>1)|0),w=0;;){if(T=(o[l+4>>2]&-8)-Y|0,T>>>0<_>>>0)if(T)i=l,_=T;else{i=l,_=0,$e=65;break e}if($e=o[l+20>>2]|0,l=o[l+16+(B>>>31<<2)>>2]|0,w=($e|0)==0|($e|0)==(l|0)?w:$e,l)B=B<<1;else{l=w,$e=61;break}}while(!1);if(($e|0)==61){if((l|0)==0&(i|0)==0){if(i=2<<j,i=(i|0-i)&d,!i){Se=Y;break}Se=(i&0-i)+-1|0,T=Se>>>12&16,Se=Se>>>T,w=Se>>>5&8,Se=Se>>>w,B=Se>>>2&4,Se=Se>>>B,j=Se>>>1&2,Se=Se>>>j,l=Se>>>1&1,i=0,l=o[23732+((w|T|B|j|l)+(Se>>>l)<<2)>>2]|0}l?$e=65:(B=i,T=_)}if(($e|0)==65)for(w=l;;)if(Se=(o[w+4>>2]&-8)-Y|0,l=Se>>>0<_>>>0,_=l?Se:_,i=l?w:i,l=o[w+16>>2]|0,l||(l=o[w+20>>2]|0),l)w=l;else{B=i,T=_;break}if(B|0&&T>>>0<((o[5859]|0)-Y|0)>>>0&&(ue=B+Y|0,ue>>>0>B>>>0)){w=o[B+24>>2]|0,r=o[B+12>>2]|0;do if((r|0)==(B|0)){if(i=B+20|0,r=o[i>>2]|0,!r&&(i=B+16|0,r=o[i>>2]|0,!r)){r=0;break}for(;;)if(_=r+20|0,l=o[_>>2]|0,l)r=l,i=_;else if(_=r+16|0,l=o[_>>2]|0,l)r=l,i=_;else break;o[i>>2]=0}else wt=o[B+8>>2]|0,o[wt+12>>2]=r,o[r+8>>2]=wt;while(!1);do if(w){if(i=o[B+28>>2]|0,l=23732+(i<<2)|0,(B|0)==(o[l>>2]|0)){if(o[l>>2]=r,!r){d=d&~(1<<i),o[5858]=d;break}}else if(wt=w+16|0,o[((o[wt>>2]|0)==(B|0)?wt:w+20|0)>>2]=r,!r)break;o[r+24>>2]=w,i=o[B+16>>2]|0,i|0&&(o[r+16>>2]=i,o[i+24>>2]=r),i=o[B+20>>2]|0,i&&(o[r+20>>2]=i,o[i+24>>2]=r)}while(!1);e:do if(T>>>0<16)wt=T+Y|0,o[B+4>>2]=wt|3,wt=B+wt+4|0,o[wt>>2]=o[wt>>2]|1;else{if(o[B+4>>2]=Y|3,o[ue+4>>2]=T|1,o[ue+T>>2]=T,r=T>>>3,T>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=ue,o[r+12>>2]=ue,o[ue+8>>2]=r,o[ue+12>>2]=l;break}if(r=T>>>8,r?T>>>0>16777215?l=31:(Et=(r+1048320|0)>>>16&8,wt=r<<Et,ct=(wt+520192|0)>>>16&4,wt=wt<<ct,l=(wt+245760|0)>>>16&2,l=14-(ct|Et|l)+(wt<<l>>>15)|0,l=T>>>(l+7|0)&1|l<<1):l=0,r=23732+(l<<2)|0,o[ue+28>>2]=l,i=ue+16|0,o[i+4>>2]=0,o[i>>2]=0,i=1<<l,!(d&i)){o[5858]=d|i,o[r>>2]=ue,o[ue+24>>2]=r,o[ue+12>>2]=ue,o[ue+8>>2]=ue;break}r=o[r>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(T|0)){for(d=T<<((l|0)==31?0:25-(l>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(T|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=ue,o[ue+24>>2]=r,o[ue+12>>2]=ue,o[ue+8>>2]=ue;break e}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=ue,o[Et>>2]=ue,o[ue+8>>2]=wt,o[ue+12>>2]=r,o[ue+24>>2]=0}while(!1);return wt=B+8|0,Lt=ri,wt|0}else Se=Y}else Se=Y;else Se=-1;while(!1);if(l=o[5859]|0,l>>>0>=Se>>>0)return r=l-Se|0,i=o[5862]|0,r>>>0>15?(wt=i+Se|0,o[5862]=wt,o[5859]=r,o[wt+4>>2]=r|1,o[i+l>>2]=r,o[i+4>>2]=Se|3):(o[5859]=0,o[5862]=0,o[i+4>>2]=l|3,wt=i+l+4|0,o[wt>>2]=o[wt>>2]|1),wt=i+8|0,Lt=ri,wt|0;if(T=o[5860]|0,T>>>0>Se>>>0)return ct=T-Se|0,o[5860]=ct,wt=o[5863]|0,Et=wt+Se|0,o[5863]=Et,o[Et+4>>2]=ct|1,o[wt+4>>2]=Se|3,wt=wt+8|0,Lt=ri,wt|0;if(o[5975]|0?i=o[5977]|0:(o[5977]=4096,o[5976]=4096,o[5978]=-1,o[5979]=-1,o[5980]=0,o[5968]=0,o[5975]=Te&-16^1431655768,i=4096),B=Se+48|0,j=Se+47|0,w=i+j|0,_=0-i|0,Y=w&_,Y>>>0<=Se>>>0||(i=o[5967]|0,i|0&&(ue=o[5965]|0,Te=ue+Y|0,Te>>>0<=ue>>>0|Te>>>0>i>>>0)))return wt=0,Lt=ri,wt|0;e:do if(o[5968]&4)r=0,$e=143;else{l=o[5863]|0;t:do if(l){for(d=23876;Te=o[d>>2]|0,!(Te>>>0<=l>>>0&&(Te+(o[d+4>>2]|0)|0)>>>0>l>>>0);)if(i=o[d+8>>2]|0,i)d=i;else{$e=128;break t}if(r=w-T&_,r>>>0<2147483647)if(i=s(r|0)|0,(i|0)==((o[d>>2]|0)+(o[d+4>>2]|0)|0)){if((i|0)!=-1){T=r,w=i,$e=145;break e}}else d=i,$e=136;else r=0}else $e=128;while(!1);do if(($e|0)==128)if(l=s(0)|0,(l|0)!=-1&&(r=l,Re=o[5976]|0,Be=Re+-1|0,r=(Be&r|0?(Be+r&0-Re)-r|0:0)+Y|0,Re=o[5965]|0,Be=r+Re|0,r>>>0>Se>>>0&r>>>0<2147483647)){if(Te=o[5967]|0,Te|0&&Be>>>0<=Re>>>0|Be>>>0>Te>>>0){r=0;break}if(i=s(r|0)|0,(i|0)==(l|0)){T=r,w=l,$e=145;break e}else d=i,$e=136}else r=0;while(!1);do if(($e|0)==136){if(l=0-r|0,!(B>>>0>r>>>0&(r>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){r=0;break}else{T=r,w=d,$e=145;break e}if(i=o[5977]|0,i=j-r+i&0-i,i>>>0>=2147483647){T=r,w=d,$e=145;break e}if((s(i|0)|0)==-1){s(l|0)|0,r=0;break}else{T=i+r|0,w=d,$e=145;break e}}while(!1);o[5968]=o[5968]|4,$e=143}while(!1);if(($e|0)==143&&Y>>>0<2147483647&&(ct=s(Y|0)|0,Be=s(0)|0,vt=Be-ct|0,ot=vt>>>0>(Se+40|0)>>>0,!((ct|0)==-1|ot^1|ct>>>0<Be>>>0&((ct|0)!=-1&(Be|0)!=-1)^1))&&(T=ot?vt:r,w=ct,$e=145),($e|0)==145){r=(o[5965]|0)+T|0,o[5965]=r,r>>>0>(o[5966]|0)>>>0&&(o[5966]=r),j=o[5863]|0;e:do if(j){for(r=23876;;){if(i=o[r>>2]|0,l=o[r+4>>2]|0,(w|0)==(i+l|0)){$e=154;break}if(d=o[r+8>>2]|0,d)r=d;else break}if(($e|0)==154&&(Et=r+4|0,(o[r+12>>2]&8|0)==0)&&w>>>0>j>>>0&i>>>0<=j>>>0){o[Et>>2]=l+T,wt=(o[5860]|0)+T|0,ct=j+8|0,ct=ct&7|0?0-ct&7:0,Et=j+ct|0,ct=wt-ct|0,o[5863]=Et,o[5860]=ct,o[Et+4>>2]=ct|1,o[j+wt+4>>2]=40,o[5864]=o[5979];break}for(w>>>0<(o[5861]|0)>>>0&&(o[5861]=w),l=w+T|0,r=23876;;){if((o[r>>2]|0)==(l|0)){$e=162;break}if(i=o[r+8>>2]|0,i)r=i;else break}if(($e|0)==162&&!(o[r+12>>2]&8|0)){o[r>>2]=w,ue=r+4|0,o[ue>>2]=(o[ue>>2]|0)+T,ue=w+8|0,ue=w+(ue&7|0?0-ue&7:0)|0,r=l+8|0,r=l+(r&7|0?0-r&7:0)|0,Y=ue+Se|0,B=r-ue-Se|0,o[ue+4>>2]=Se|3;t:do if((j|0)==(r|0))wt=(o[5860]|0)+B|0,o[5860]=wt,o[5863]=Y,o[Y+4>>2]=wt|1;else{if((o[5862]|0)==(r|0)){wt=(o[5859]|0)+B|0,o[5859]=wt,o[5862]=Y,o[Y+4>>2]=wt|1,o[Y+wt>>2]=wt;break}if(i=o[r+4>>2]|0,(i&3|0)==1){T=i&-8,d=i>>>3;i:do if(i>>>0<256)if(i=o[r+8>>2]|0,l=o[r+12>>2]|0,(l|0)==(i|0)){o[5857]=o[5857]&~(1<<d);break}else{o[i+12>>2]=l,o[l+8>>2]=i;break}else{w=o[r+24>>2]|0,i=o[r+12>>2]|0;do if((i|0)==(r|0)){if(l=r+16|0,d=l+4|0,i=o[d>>2]|0,i)l=d;else if(i=o[l>>2]|0,!i){i=0;break}for(;;)if(_=i+20|0,d=o[_>>2]|0,d)i=d,l=_;else if(_=i+16|0,d=o[_>>2]|0,d)i=d,l=_;else break;o[l>>2]=0}else wt=o[r+8>>2]|0,o[wt+12>>2]=i,o[i+8>>2]=wt;while(!1);if(!w)break;l=o[r+28>>2]|0,d=23732+(l<<2)|0;do if((o[d>>2]|0)!=(r|0)){if(wt=w+16|0,o[((o[wt>>2]|0)==(r|0)?wt:w+20|0)>>2]=i,!i)break i}else{if(o[d>>2]=i,i|0)break;o[5858]=o[5858]&~(1<<l);break i}while(!1);if(o[i+24>>2]=w,l=r+16|0,d=o[l>>2]|0,d|0&&(o[i+16>>2]=d,o[d+24>>2]=i),l=o[l+4>>2]|0,!l)break;o[i+20>>2]=l,o[l+24>>2]=i}while(!1);r=r+T|0,_=T+B|0}else _=B;if(r=r+4|0,o[r>>2]=o[r>>2]&-2,o[Y+4>>2]=_|1,o[Y+_>>2]=_,r=_>>>3,_>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=Y,o[r+12>>2]=Y,o[Y+8>>2]=r,o[Y+12>>2]=l;break}r=_>>>8;do if(!r)d=0;else{if(_>>>0>16777215){d=31;break}Et=(r+1048320|0)>>>16&8,wt=r<<Et,ct=(wt+520192|0)>>>16&4,wt=wt<<ct,d=(wt+245760|0)>>>16&2,d=14-(ct|Et|d)+(wt<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1}while(!1);if(r=23732+(d<<2)|0,o[Y+28>>2]=d,i=Y+16|0,o[i+4>>2]=0,o[i>>2]=0,i=o[5858]|0,l=1<<d,!(i&l)){o[5858]=i|l,o[r>>2]=Y,o[Y+24>>2]=r,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break}r=o[r>>2]|0;i:do if((o[r+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(_|0)){r=i;break i}else d=d<<1,r=i;o[l>>2]=Y,o[Y+24>>2]=r,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break t}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=Y,o[Et>>2]=Y,o[Y+8>>2]=wt,o[Y+12>>2]=r,o[Y+24>>2]=0}while(!1);return wt=ue+8|0,Lt=ri,wt|0}for(r=23876;i=o[r>>2]|0,!(i>>>0<=j>>>0&&(wt=i+(o[r+4>>2]|0)|0,wt>>>0>j>>>0));)r=o[r+8>>2]|0;_=wt+-47|0,i=_+8|0,i=_+(i&7|0?0-i&7:0)|0,_=j+16|0,i=i>>>0<_>>>0?j:i,r=i+8|0,l=T+-40|0,ct=w+8|0,ct=ct&7|0?0-ct&7:0,Et=w+ct|0,ct=l-ct|0,o[5863]=Et,o[5860]=ct,o[Et+4>>2]=ct|1,o[w+l+4>>2]=40,o[5864]=o[5979],l=i+4|0,o[l>>2]=27,o[r>>2]=o[5969],o[r+4>>2]=o[5970],o[r+8>>2]=o[5971],o[r+12>>2]=o[5972],o[5969]=w,o[5970]=T,o[5972]=0,o[5971]=r,r=i+24|0;do Et=r,r=r+4|0,o[r>>2]=7;while((Et+8|0)>>>0<wt>>>0);if((i|0)!=(j|0)){if(w=i-j|0,o[l>>2]=o[l>>2]&-2,o[j+4>>2]=w|1,o[i>>2]=w,r=w>>>3,w>>>0<256){l=23468+(r<<1<<2)|0,i=o[5857]|0,r=1<<r,i&r?(i=l+8|0,r=o[i>>2]|0):(o[5857]=i|r,r=l,i=l+8|0),o[i>>2]=j,o[r+12>>2]=j,o[j+8>>2]=r,o[j+12>>2]=l;break}if(r=w>>>8,r?w>>>0>16777215?d=31:(Et=(r+1048320|0)>>>16&8,wt=r<<Et,ct=(wt+520192|0)>>>16&4,wt=wt<<ct,d=(wt+245760|0)>>>16&2,d=14-(ct|Et|d)+(wt<<d>>>15)|0,d=w>>>(d+7|0)&1|d<<1):d=0,l=23732+(d<<2)|0,o[j+28>>2]=d,o[j+20>>2]=0,o[_>>2]=0,r=o[5858]|0,i=1<<d,!(r&i)){o[5858]=r|i,o[l>>2]=j,o[j+24>>2]=l,o[j+12>>2]=j,o[j+8>>2]=j;break}r=o[l>>2]|0;t:do if((o[r+4>>2]&-8|0)!=(w|0)){for(d=w<<((d|0)==31?0:25-(d>>>1)|0);l=r+16+(d>>>31<<2)|0,i=o[l>>2]|0,!!i;)if((o[i+4>>2]&-8|0)==(w|0)){r=i;break t}else d=d<<1,r=i;o[l>>2]=j,o[j+24>>2]=r,o[j+12>>2]=j,o[j+8>>2]=j;break e}while(!1);Et=r+8|0,wt=o[Et>>2]|0,o[wt+12>>2]=j,o[Et>>2]=j,o[j+8>>2]=wt,o[j+12>>2]=r,o[j+24>>2]=0}}else wt=o[5861]|0,(wt|0)==0|w>>>0<wt>>>0&&(o[5861]=w),o[5969]=w,o[5970]=T,o[5972]=0,o[5866]=o[5975],o[5865]=-1,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,o[5906]=23612,o[5905]=23612,o[5908]=23620,o[5907]=23620,o[5910]=23628,o[5909]=23628,o[5912]=23636,o[5911]=23636,o[5914]=23644,o[5913]=23644,o[5916]=23652,o[5915]=23652,o[5918]=23660,o[5917]=23660,o[5920]=23668,o[5919]=23668,o[5922]=23676,o[5921]=23676,o[5924]=23684,o[5923]=23684,o[5926]=23692,o[5925]=23692,o[5928]=23700,o[5927]=23700,o[5930]=23708,o[5929]=23708,o[5932]=23716,o[5931]=23716,wt=T+-40|0,ct=w+8|0,ct=ct&7|0?0-ct&7:0,Et=w+ct|0,ct=wt-ct|0,o[5863]=Et,o[5860]=ct,o[Et+4>>2]=ct|1,o[w+wt+4>>2]=40,o[5864]=o[5979];while(!1);if(r=o[5860]|0,r>>>0>Se>>>0)return ct=r-Se|0,o[5860]=ct,wt=o[5863]|0,Et=wt+Se|0,o[5863]=Et,o[Et+4>>2]=ct|1,o[wt+4>>2]=Se|3,wt=wt+8|0,Lt=ri,wt|0}return wt=Oo()|0,o[wt>>2]=12,wt=0,Lt=ri,wt|0}function C(i){i=i|0;var r=0,l=0,d=0,_=0,w=0,T=0,B=0,j=0;if(i){l=i+-8|0,_=o[5861]|0,i=o[i+-4>>2]|0,r=i&-8,j=l+r|0;do if(i&1)B=l,T=l;else{if(d=o[l>>2]|0,!(i&3)||(T=l+(0-d)|0,w=d+r|0,T>>>0<_>>>0))return;if((o[5862]|0)==(T|0)){if(i=j+4|0,r=o[i>>2]|0,(r&3|0)!=3){B=T,r=w;break}o[5859]=w,o[i>>2]=r&-2,o[T+4>>2]=w|1,o[T+w>>2]=w;return}if(l=d>>>3,d>>>0<256)if(i=o[T+8>>2]|0,r=o[T+12>>2]|0,(r|0)==(i|0)){o[5857]=o[5857]&~(1<<l),B=T,r=w;break}else{o[i+12>>2]=r,o[r+8>>2]=i,B=T,r=w;break}_=o[T+24>>2]|0,i=o[T+12>>2]|0;do if((i|0)==(T|0)){if(r=T+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){i=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0}else B=o[T+8>>2]|0,o[B+12>>2]=i,o[i+8>>2]=B;while(!1);if(_){if(r=o[T+28>>2]|0,l=23732+(r<<2)|0,(o[l>>2]|0)==(T|0)){if(o[l>>2]=i,!i){o[5858]=o[5858]&~(1<<r),B=T,r=w;break}}else if(B=_+16|0,o[((o[B>>2]|0)==(T|0)?B:_+20|0)>>2]=i,!i){B=T,r=w;break}o[i+24>>2]=_,r=T+16|0,l=o[r>>2]|0,l|0&&(o[i+16>>2]=l,o[l+24>>2]=i),r=o[r+4>>2]|0,r?(o[i+20>>2]=r,o[r+24>>2]=i,B=T,r=w):(B=T,r=w)}else B=T,r=w}while(!1);if(!(T>>>0>=j>>>0)&&(i=j+4|0,d=o[i>>2]|0,!!(d&1))){if(d&2)o[i>>2]=d&-2,o[B+4>>2]=r|1,o[T+r>>2]=r,_=r;else{if((o[5863]|0)==(j|0)){if(j=(o[5860]|0)+r|0,o[5860]=j,o[5863]=B,o[B+4>>2]=j|1,(B|0)!=(o[5862]|0))return;o[5862]=0,o[5859]=0;return}if((o[5862]|0)==(j|0)){j=(o[5859]|0)+r|0,o[5859]=j,o[5862]=T,o[B+4>>2]=j|1,o[T+j>>2]=j;return}_=(d&-8)+r|0,l=d>>>3;do if(d>>>0<256)if(r=o[j+8>>2]|0,i=o[j+12>>2]|0,(i|0)==(r|0)){o[5857]=o[5857]&~(1<<l);break}else{o[r+12>>2]=i,o[i+8>>2]=r;break}else{w=o[j+24>>2]|0,i=o[j+12>>2]|0;do if((i|0)==(j|0)){if(r=j+16|0,l=r+4|0,i=o[l>>2]|0,i)r=l;else if(i=o[r>>2]|0,!i){l=0;break}for(;;)if(d=i+20|0,l=o[d>>2]|0,l)i=l,r=d;else if(d=i+16|0,l=o[d>>2]|0,l)i=l,r=d;else break;o[r>>2]=0,l=i}else l=o[j+8>>2]|0,o[l+12>>2]=i,o[i+8>>2]=l,l=i;while(!1);if(w|0){if(i=o[j+28>>2]|0,r=23732+(i<<2)|0,(o[r>>2]|0)==(j|0)){if(o[r>>2]=l,!l){o[5858]=o[5858]&~(1<<i);break}}else if(d=w+16|0,o[((o[d>>2]|0)==(j|0)?d:w+20|0)>>2]=l,!l)break;o[l+24>>2]=w,i=j+16|0,r=o[i>>2]|0,r|0&&(o[l+16>>2]=r,o[r+24>>2]=l),i=o[i+4>>2]|0,i|0&&(o[l+20>>2]=i,o[i+24>>2]=l)}}while(!1);if(o[B+4>>2]=_|1,o[T+_>>2]=_,(B|0)==(o[5862]|0)){o[5859]=_;return}}if(i=_>>>3,_>>>0<256){l=23468+(i<<1<<2)|0,r=o[5857]|0,i=1<<i,r&i?(r=l+8|0,i=o[r>>2]|0):(o[5857]=r|i,i=l,r=l+8|0),o[r>>2]=B,o[i+12>>2]=B,o[B+8>>2]=i,o[B+12>>2]=l;return}i=_>>>8,i?_>>>0>16777215?d=31:(T=(i+1048320|0)>>>16&8,j=i<<T,w=(j+520192|0)>>>16&4,j=j<<w,d=(j+245760|0)>>>16&2,d=14-(w|T|d)+(j<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1):d=0,i=23732+(d<<2)|0,o[B+28>>2]=d,o[B+20>>2]=0,o[B+16>>2]=0,r=o[5858]|0,l=1<<d;e:do if(!(r&l))o[5858]=r|l,o[i>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;else{i=o[i>>2]|0;t:do if((o[i+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);l=i+16+(d>>>31<<2)|0,r=o[l>>2]|0,!!r;)if((o[r+4>>2]&-8|0)==(_|0)){i=r;break t}else d=d<<1,i=r;o[l>>2]=B,o[B+24>>2]=i,o[B+12>>2]=B,o[B+8>>2]=B;break e}while(!1);T=i+8|0,j=o[T>>2]|0,o[j+12>>2]=B,o[T>>2]=B,o[B+8>>2]=j,o[B+12>>2]=i,o[B+24>>2]=0}while(!1);if(j=(o[5865]|0)+-1|0,o[5865]=j,!(j|0)){for(i=23884;i=o[i>>2]|0,i;)i=i+8|0;o[5865]=-1}}}}function D(i,r){i=i|0,r=r|0;var l=0;return i?(l=Hi(r,i)|0,(r|i)>>>0>65535&&(l=((l>>>0)/(i>>>0)|0|0)==(r|0)?l:-1)):l=0,i=Ps(l)|0,!i||!(o[i+-4>>2]&3)||O(i|0,0,l|0)|0,i|0}function z(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,l=i+l>>>0,Yi(r+d+(l>>>0<i>>>0|0)>>>0|0),l|0|0}function R(i,r,l,d){return i=i|0,r=r|0,l=l|0,d=d|0,d=r-d-(l>>>0>i>>>0|0)>>>0,Yi(d|0),i-l>>>0|0|0}function ee(i){return i=i|0,(i?31-(Qt(i^i-1)|0)|0:32)|0}function le(i,r,l,d,_){i=i|0,r=r|0,l=l|0,d=d|0,_=_|0;var w=0,T=0,B=0,j=0,Y=0,ue=0,Se=0,Te=0,Re=0,Be=0;if(ue=i,j=r,Y=j,T=l,Te=d,B=Te,!Y)return w=(_|0)!=0,B?w?(o[_>>2]=i|0,o[_+4>>2]=r&0,Te=0,_=0,Yi(Te|0),_|0):(Te=0,_=0,Yi(Te|0),_|0):(w&&(o[_>>2]=(ue>>>0)%(T>>>0),o[_+4>>2]=0),Te=0,_=(ue>>>0)/(T>>>0)>>>0,Yi(Te|0),_|0);w=(B|0)==0;do if(T){if(!w){if(w=(Qt(B|0)|0)-(Qt(Y|0)|0)|0,w>>>0<=31){Se=w+1|0,B=31-w|0,r=w-31>>31,T=Se,i=ue>>>(Se>>>0)&r|Y<<B,r=Y>>>(Se>>>0)&r,w=0,B=ue<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Te=0,_=0,Yi(Te|0),_|0):(Te=0,_=0,Yi(Te|0),_|0)}if(w=T-1|0,w&T|0){B=(Qt(T|0)|0)+33-(Qt(Y|0)|0)|0,Be=64-B|0,Se=32-B|0,j=Se>>31,Re=B-32|0,r=Re>>31,T=B,i=Se-1>>31&Y>>>(Re>>>0)|(Y<<Se|ue>>>(B>>>0))&r,r=r&Y>>>(B>>>0),w=ue<<Be&j,B=(Y<<Be|ue>>>(Re>>>0))&j|ue<<Se&B-33>>31;break}return _|0&&(o[_>>2]=w&ue,o[_+4>>2]=0),(T|0)==1?(Re=j|r&0,Be=i|0|0,Yi(Re|0),Be|0):(Be=ee(T|0)|0,Re=Y>>>(Be>>>0)|0,Be=Y<<32-Be|ue>>>(Be>>>0)|0,Yi(Re|0),Be|0)}else{if(w)return _|0&&(o[_>>2]=(Y>>>0)%(T>>>0),o[_+4>>2]=0),Re=0,Be=(Y>>>0)/(T>>>0)>>>0,Yi(Re|0),Be|0;if(!ue)return _|0&&(o[_>>2]=0,o[_+4>>2]=(Y>>>0)%(B>>>0)),Re=0,Be=(Y>>>0)/(B>>>0)>>>0,Yi(Re|0),Be|0;if(w=B-1|0,!(w&B))return _|0&&(o[_>>2]=i|0,o[_+4>>2]=w&Y|r&0),Re=0,Be=Y>>>((ee(B|0)|0)>>>0),Yi(Re|0),Be|0;if(w=(Qt(B|0)|0)-(Qt(Y|0)|0)|0,w>>>0<=30){r=w+1|0,B=31-w|0,T=r,i=Y<<B|ue>>>(r>>>0),r=Y>>>(r>>>0),w=0,B=ue<<B;break}return _?(o[_>>2]=i|0,o[_+4>>2]=j|r&0,Re=0,Be=0,Yi(Re|0),Be|0):(Re=0,Be=0,Yi(Re|0),Be|0)}while(!1);if(!T)Y=B,j=0,B=0;else{Se=l|0|0,ue=Te|d&0,Y=z(Se|0,ue|0,-1,-1)|0,l=Ut()|0,j=B,B=0;do d=j,j=w>>>31|j<<1,w=B|w<<1,d=i<<1|d>>>31|0,Te=i>>>31|r<<1|0,R(Y|0,l|0,d|0,Te|0)|0,Be=Ut()|0,Re=Be>>31|((Be|0)<0?-1:0)<<1,B=Re&1,i=R(d|0,Te|0,Re&Se|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&ue|0)|0,r=Ut()|0,T=T-1|0;while(T|0);Y=j,j=0}return T=0,_|0&&(o[_>>2]=i,o[_+4>>2]=r),Re=(w|0)>>>31|(Y|T)<<1|(T<<1|w>>>31)&0|j,Be=(w<<1|0)&-2|B,Yi(Re|0),Be|0}function ae(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;return Y=r>>31|((r|0)<0?-1:0)<<1,j=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,w=d>>31|((d|0)<0?-1:0)<<1,_=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,B=R(Y^i|0,j^r|0,Y|0,j|0)|0,T=Ut()|0,i=w^Y,r=_^j,R((le(B,T,R(w^l|0,_^d|0,w|0,_|0)|0,Ut()|0,0)|0)^i|0,(Ut()|0)^r|0,i|0,r|0)|0}function be(i,r){i=i|0,r=r|0;var l=0,d=0,_=0,w=0;return w=i&65535,_=r&65535,l=Hi(_,w)|0,d=i>>>16,i=(l>>>16)+(Hi(_,d)|0)|0,_=r>>>16,r=Hi(_,w)|0,Yi((i>>>16)+(Hi(_,d)|0)+(((i&65535)+r|0)>>>16)|0),i+r<<16|l&65535|0|0}function We(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return _=i,w=l,l=be(_,w)|0,i=Ut()|0,Yi((Hi(r,w)|0)+(Hi(d,_)|0)+i|i&0|0),l|0|0|0}function yt(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0,T=0,B=0,j=0,Y=0;return _=Lt,Lt=Lt+16|0,B=_|0,T=r>>31|((r|0)<0?-1:0)<<1,w=((r|0)<0?-1:0)>>31|((r|0)<0?-1:0)<<1,Y=d>>31|((d|0)<0?-1:0)<<1,j=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,i=R(T^i|0,w^r|0,T|0,w|0)|0,r=Ut()|0,le(i,r,R(Y^l|0,j^d|0,Y|0,j|0)|0,Ut()|0,B)|0,d=R(o[B>>2]^T|0,o[B+4>>2]^w|0,T|0,w|0)|0,l=Ut()|0,Lt=_,Yi(l|0),d|0}function Ct(i,r,l,d){i=i|0,r=r|0,l=l|0,d=d|0;var _=0,w=0;return w=Lt,Lt=Lt+16|0,_=w|0,le(i,r,l,d,_)|0,Lt=w,Yi(o[_+4>>2]|0),o[_>>2]|0|0}function ii(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Yi(((r|0)<0?-1:0)|0),r>>l-32|0)}function Gt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r>>>l|0),i>>>l|(r&(1<<l)-1)<<32-l):(Yi(0),r>>>l-32|0)}function jt(i,r,l){return i=i|0,r=r|0,l=l|0,(l|0)<32?(Yi(r<<l|(i&(1<<l)-1<<32-l)>>>32-l|0),i<<l):(Yi(i<<l-32|0),0)}function Z(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+Fn(+i,+r)}function A(i,r){return i=+i,r=+r,i!=i?+r:r!=r?+i:+lr(+i,+r)}function I(i){return i=+i,i>=0?+Ai(i+.5):+Hr(i-.5)}function F(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0;if((l|0)>=8192)return Vr(i|0,r|0,l|0)|0,i|0;if(w=i|0,_=i+l|0,(i&3)==(r&3)){for(;i&3;){if(!l)return w|0;Tt[i>>0]=Tt[r>>0]|0,i=i+1|0,r=r+1|0,l=l-1|0}for(l=_&-4|0,d=l-64|0;(i|0)<=(d|0);)o[i>>2]=o[r>>2],o[i+4>>2]=o[r+4>>2],o[i+8>>2]=o[r+8>>2],o[i+12>>2]=o[r+12>>2],o[i+16>>2]=o[r+16>>2],o[i+20>>2]=o[r+20>>2],o[i+24>>2]=o[r+24>>2],o[i+28>>2]=o[r+28>>2],o[i+32>>2]=o[r+32>>2],o[i+36>>2]=o[r+36>>2],o[i+40>>2]=o[r+40>>2],o[i+44>>2]=o[r+44>>2],o[i+48>>2]=o[r+48>>2],o[i+52>>2]=o[r+52>>2],o[i+56>>2]=o[r+56>>2],o[i+60>>2]=o[r+60>>2],i=i+64|0,r=r+64|0;for(;(i|0)<(l|0);)o[i>>2]=o[r>>2],i=i+4|0,r=r+4|0}else for(l=_-4|0;(i|0)<(l|0);)Tt[i>>0]=Tt[r>>0]|0,Tt[i+1>>0]=Tt[r+1>>0]|0,Tt[i+2>>0]=Tt[r+2>>0]|0,Tt[i+3>>0]=Tt[r+3>>0]|0,i=i+4|0,r=r+4|0;for(;(i|0)<(_|0);)Tt[i>>0]=Tt[r>>0]|0,i=i+1|0,r=r+1|0;return w|0}function O(i,r,l){i=i|0,r=r|0,l=l|0;var d=0,_=0,w=0,T=0;if(w=i+l|0,r=r&255,(l|0)>=67){for(;i&3;)Tt[i>>0]=r,i=i+1|0;for(d=w&-4|0,T=r|r<<8|r<<16|r<<24,_=d-64|0;(i|0)<=(_|0);)o[i>>2]=T,o[i+4>>2]=T,o[i+8>>2]=T,o[i+12>>2]=T,o[i+16>>2]=T,o[i+20>>2]=T,o[i+24>>2]=T,o[i+28>>2]=T,o[i+32>>2]=T,o[i+36>>2]=T,o[i+40>>2]=T,o[i+44>>2]=T,o[i+48>>2]=T,o[i+52>>2]=T,o[i+56>>2]=T,o[i+60>>2]=T,i=i+64|0;for(;(i|0)<(d|0);)o[i>>2]=T,i=i+4|0}for(;(i|0)<(w|0);)Tt[i>>0]=r,i=i+1|0;return w-l|0}function y(i){return i=+i,i>=0?+Ai(i+.5):+Hr(i-.5)}function s(i){i=i|0;var r=0,l=0,d=0;return d=Ns()|0,l=o[di>>2]|0,r=l+i|0,(i|0)>0&(r|0)<(l|0)|(r|0)<0?(cr(r|0)|0,ur(12),-1):(r|0)>(d|0)&&!(Vt(r|0)|0)?(ur(12),-1):(o[di>>2]=r,l|0)}return{___divdi3:ae,___muldi3:We,___remdi3:yt,___uremdi3:Ct,_areNeighborCells:Ro,_bitshift64Ashr:ii,_bitshift64Lshr:Gt,_bitshift64Shl:jt,_calloc:D,_cellAreaKm2:Ms,_cellAreaM2:As,_cellAreaRads2:qs,_cellToBoundary:Rr,_cellToCenterChild:Xr,_cellToChildPos:ka,_cellToChildren:nr,_cellToChildrenSize:ks,_cellToLatLng:mr,_cellToLocalIj:Fo,_cellToParent:jr,_cellToVertex:Jn,_cellToVertexes:Jo,_cellsToDirectedEdge:Zo,_cellsToLinkedMultiPolygon:xe,_childPosToCell:Wa,_compactCells:Io,_destroyLinkedMultiPolygon:mo,_directedEdgeToBoundary:ba,_directedEdgeToCells:Wo,_edgeLengthKm:po,_edgeLengthM:rs,_edgeLengthRads:Xa,_emscripten_replace_memory:Br,_free:C,_getBaseCellNumber:Ol,_getDirectedEdgeDestination:Us,_getDirectedEdgeOrigin:wo,_getHexagonAreaAvgKm2:xi,_getHexagonAreaAvgM2:Oi,_getHexagonEdgeLengthAvgKm:Ln,_getHexagonEdgeLengthAvgM:Un,_getIcosahedronFaces:fo,_getNumCells:or,_getPentagons:Sa,_getRes0Cells:Ua,_getResolution:Nn,_greatCircleDistanceKm:Ni,_greatCircleDistanceM:Di,_greatCircleDistanceRads:mi,_gridDisk:Oa,_gridDiskDistances:Xs,_gridDistance:Sn,_gridPathCells:In,_gridPathCellsSize:Hl,_gridRingUnsafe:rl,_i64Add:z,_i64Subtract:R,_isPentagon:Cr,_isResClassIII:hs,_isValidCell:Jr,_isValidDirectedEdge:Qo,_isValidVertex:oa,_latLngToCell:Qa,_llvm_maxnum_f64:Z,_llvm_minnum_f64:A,_llvm_round_f64:I,_localIjToCell:Nl,_malloc:Ps,_maxFaceCount:ha,_maxGridDiskSize:zo,_maxPolygonToCellsSize:sl,_memcpy:F,_memset:O,_originToDirectedEdges:Xo,_pentagonCount:ea,_polygonToCells:Va,_readInt64AsDoubleFromPointer:gu,_res0CellCount:zr,_round:y,_sbrk:s,_sizeOfCellBoundary:Wu,_sizeOfCoordIJ:Ko,_sizeOfGeoLoop:jl,_sizeOfGeoPolygon:fs,_sizeOfH3Index:ta,_sizeOfLatLng:ac,_sizeOfLinkedGeoPolygon:_a,_uncompactCells:ol,_uncompactCellsSize:Zr,_vertexToLatLng:Cu,establishStackSpace:Fa,stackAlloc:Vs,stackRestore:kr,stackSave:ua}}(rt,Me,mt);t.___divdi3=se.___divdi3,t.___muldi3=se.___muldi3,t.___remdi3=se.___remdi3,t.___uremdi3=se.___uremdi3,t._areNeighborCells=se._areNeighborCells,t._bitshift64Ashr=se._bitshift64Ashr,t._bitshift64Lshr=se._bitshift64Lshr,t._bitshift64Shl=se._bitshift64Shl,t._calloc=se._calloc,t._cellAreaKm2=se._cellAreaKm2,t._cellAreaM2=se._cellAreaM2,t._cellAreaRads2=se._cellAreaRads2,t._cellToBoundary=se._cellToBoundary,t._cellToCenterChild=se._cellToCenterChild,t._cellToChildPos=se._cellToChildPos,t._cellToChildren=se._cellToChildren,t._cellToChildrenSize=se._cellToChildrenSize,t._cellToLatLng=se._cellToLatLng,t._cellToLocalIj=se._cellToLocalIj,t._cellToParent=se._cellToParent,t._cellToVertex=se._cellToVertex,t._cellToVertexes=se._cellToVertexes,t._cellsToDirectedEdge=se._cellsToDirectedEdge,t._cellsToLinkedMultiPolygon=se._cellsToLinkedMultiPolygon,t._childPosToCell=se._childPosToCell,t._compactCells=se._compactCells,t._destroyLinkedMultiPolygon=se._destroyLinkedMultiPolygon,t._directedEdgeToBoundary=se._directedEdgeToBoundary,t._directedEdgeToCells=se._directedEdgeToCells,t._edgeLengthKm=se._edgeLengthKm,t._edgeLengthM=se._edgeLengthM,t._edgeLengthRads=se._edgeLengthRads;var ne=t._emscripten_replace_memory=se._emscripten_replace_memory;t._free=se._free,t._getBaseCellNumber=se._getBaseCellNumber,t._getDirectedEdgeDestination=se._getDirectedEdgeDestination,t._getDirectedEdgeOrigin=se._getDirectedEdgeOrigin,t._getHexagonAreaAvgKm2=se._getHexagonAreaAvgKm2,t._getHexagonAreaAvgM2=se._getHexagonAreaAvgM2,t._getHexagonEdgeLengthAvgKm=se._getHexagonEdgeLengthAvgKm,t._getHexagonEdgeLengthAvgM=se._getHexagonEdgeLengthAvgM,t._getIcosahedronFaces=se._getIcosahedronFaces,t._getNumCells=se._getNumCells,t._getPentagons=se._getPentagons,t._getRes0Cells=se._getRes0Cells,t._getResolution=se._getResolution,t._greatCircleDistanceKm=se._greatCircleDistanceKm,t._greatCircleDistanceM=se._greatCircleDistanceM,t._greatCircleDistanceRads=se._greatCircleDistanceRads,t._gridDisk=se._gridDisk,t._gridDiskDistances=se._gridDiskDistances,t._gridDistance=se._gridDistance,t._gridPathCells=se._gridPathCells,t._gridPathCellsSize=se._gridPathCellsSize,t._gridRingUnsafe=se._gridRingUnsafe,t._i64Add=se._i64Add,t._i64Subtract=se._i64Subtract,t._isPentagon=se._isPentagon,t._isResClassIII=se._isResClassIII,t._isValidCell=se._isValidCell,t._isValidDirectedEdge=se._isValidDirectedEdge,t._isValidVertex=se._isValidVertex,t._latLngToCell=se._latLngToCell,t._llvm_maxnum_f64=se._llvm_maxnum_f64,t._llvm_minnum_f64=se._llvm_minnum_f64,t._llvm_round_f64=se._llvm_round_f64,t._localIjToCell=se._localIjToCell,t._malloc=se._malloc,t._maxFaceCount=se._maxFaceCount,t._maxGridDiskSize=se._maxGridDiskSize,t._maxPolygonToCellsSize=se._maxPolygonToCellsSize,t._memcpy=se._memcpy,t._memset=se._memset,t._originToDirectedEdges=se._originToDirectedEdges,t._pentagonCount=se._pentagonCount,t._polygonToCells=se._polygonToCells,t._readInt64AsDoubleFromPointer=se._readInt64AsDoubleFromPointer,t._res0CellCount=se._res0CellCount,t._round=se._round,t._sbrk=se._sbrk,t._sizeOfCellBoundary=se._sizeOfCellBoundary,t._sizeOfCoordIJ=se._sizeOfCoordIJ,t._sizeOfGeoLoop=se._sizeOfGeoLoop,t._sizeOfGeoPolygon=se._sizeOfGeoPolygon,t._sizeOfH3Index=se._sizeOfH3Index,t._sizeOfLatLng=se._sizeOfLatLng,t._sizeOfLinkedGeoPolygon=se._sizeOfLinkedGeoPolygon,t._uncompactCells=se._uncompactCells,t._uncompactCellsSize=se._uncompactCellsSize,t._vertexToLatLng=se._vertexToLatLng,t.establishStackSpace=se.establishStackSpace;var X=t.stackAlloc=se.stackAlloc,ie=t.stackRestore=se.stackRestore,de=t.stackSave=se.stackSave;if(t.asm=se,t.cwrap=kt,t.setValue=we,t.getValue=et,ln){On(ln)||(ln=b(ln));{ns();var ye=function(De){De.byteLength&&(De=new Uint8Array(De)),dt.set(De,fe),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,fi()},ge=function(){E(ln,ye,function(){throw"could not load memory initializer "+ln})},Pe=ft(ln);if(Pe)ye(Pe.buffer);else if(t.memoryInitializerRequest){var Fe=function(){var De=t.memoryInitializerRequest,Ue=De.response;if(De.status!==200&&De.status!==0){var ht=ft(t.memoryInitializerRequestURL);if(ht)Ue=ht.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+De.status+", retrying "+ln),ge();return}}ye(Ue)};t.memoryInitializerRequest.response?setTimeout(Fe,0):t.memoryInitializerRequest.addEventListener("load",Fe)}else ge()}}var Ne;Mn=function De(){Ne||Xe(),Ne||(Mn=De)};function Xe(De){if(ti>0||(sn(),ti>0))return;function Ue(){Ne||(Ne=!0,!lt&&(Ti(),yi(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),hi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ue()},1)):Ue()}t.run=Xe;function Ye(De){throw t.onAbort&&t.onAbort(De),De+="",a(De),U(De),lt=!0,"abort("+De+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Ye,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Xe(),e}(typeof Ca=="object"?Ca:{}),ws="number",$r=ws,Km=ws,as=ws,os=ws,Ju=ws,fr=ws,WN=[["sizeOfH3Index",ws],["sizeOfLatLng",ws],["sizeOfCellBoundary",ws],["sizeOfGeoLoop",ws],["sizeOfGeoPolygon",ws],["sizeOfLinkedGeoPolygon",ws],["sizeOfCoordIJ",ws],["readInt64AsDoubleFromPointer",ws],["isValidCell",Km,[as,os]],["latLngToCell",$r,[ws,ws,Ju,fr]],["cellToLatLng",$r,[as,os,fr]],["cellToBoundary",$r,[as,os,fr]],["maxGridDiskSize",$r,[ws,fr]],["gridDisk",$r,[as,os,ws,fr]],["gridDiskDistances",$r,[as,os,ws,fr,fr]],["gridRingUnsafe",$r,[as,os,ws,fr]],["maxPolygonToCellsSize",$r,[fr,Ju,ws,fr]],["polygonToCells",$r,[fr,Ju,ws,fr]],["cellsToLinkedMultiPolygon",$r,[fr,ws,fr]],["destroyLinkedMultiPolygon",null,[fr]],["compactCells",$r,[fr,fr,ws,ws]],["uncompactCells",$r,[fr,ws,ws,fr,ws,Ju]],["uncompactCellsSize",$r,[fr,ws,ws,Ju,fr]],["isPentagon",Km,[as,os]],["isResClassIII",Km,[as,os]],["getBaseCellNumber",ws,[as,os]],["getResolution",ws,[as,os]],["maxFaceCount",$r,[as,os,fr]],["getIcosahedronFaces",$r,[as,os,fr]],["cellToParent",$r,[as,os,Ju,fr]],["cellToChildren",$r,[as,os,Ju,fr]],["cellToCenterChild",$r,[as,os,Ju,fr]],["cellToChildrenSize",$r,[as,os,Ju,fr]],["cellToChildPos",$r,[as,os,Ju,fr]],["childPosToCell",$r,[ws,ws,as,os,Ju,fr]],["areNeighborCells",$r,[as,os,as,os,fr]],["cellsToDirectedEdge",$r,[as,os,as,os,fr]],["getDirectedEdgeOrigin",$r,[as,os,fr]],["getDirectedEdgeDestination",$r,[as,os,fr]],["isValidDirectedEdge",Km,[as,os]],["directedEdgeToCells",$r,[as,os,fr]],["originToDirectedEdges",$r,[as,os,fr]],["directedEdgeToBoundary",$r,[as,os,fr]],["gridDistance",$r,[as,os,as,os,fr]],["gridPathCells",$r,[as,os,as,os,fr]],["gridPathCellsSize",$r,[as,os,as,os,fr]],["cellToLocalIj",$r,[as,os,as,os,ws,fr]],["localIjToCell",$r,[as,os,fr,ws,fr]],["getHexagonAreaAvgM2",$r,[Ju,fr]],["getHexagonAreaAvgKm2",$r,[Ju,fr]],["getHexagonEdgeLengthAvgM",$r,[Ju,fr]],["getHexagonEdgeLengthAvgKm",$r,[Ju,fr]],["greatCircleDistanceM",ws,[fr,fr]],["greatCircleDistanceKm",ws,[fr,fr]],["greatCircleDistanceRads",ws,[fr,fr]],["cellAreaM2",$r,[as,os,fr]],["cellAreaKm2",$r,[as,os,fr]],["cellAreaRads2",$r,[as,os,fr]],["edgeLengthM",$r,[as,os,fr]],["edgeLengthKm",$r,[as,os,fr]],["edgeLengthRads",$r,[as,os,fr]],["getNumCells",$r,[Ju,fr]],["getRes0Cells",$r,[fr]],["res0CellCount",ws],["getPentagons",$r,[ws,fr]],["pentagonCount",ws],["cellToVertex",$r,[as,os,ws,fr]],["cellToVertexes",$r,[as,os,fr]],["vertexToLatLng",$r,[as,os,fr]],["isValidVertex",Km,[as,os]]],XN=0,YN=1,$N=2,KN=3,y5=4,JN=5,eV=6,tV=7,iV=8,nV=9,rV=10,sV=11,aV=12,oV=13,lV=14,uV=15,Zu={};Zu[XN]="Success";Zu[YN]="The operation failed but a more specific error is not available";Zu[$N]="Argument was outside of acceptable range";Zu[KN]="Latitude or longitude arguments were outside of acceptable range";Zu[y5]="Resolution argument was outside of acceptable range";Zu[JN]="Cell argument was not valid";Zu[eV]="Directed edge argument was not valid";Zu[tV]="Undirected edge argument was not valid";Zu[iV]="Vertex argument was not valid";Zu[nV]="Pentagon distortion was encountered";Zu[rV]="Duplicate input";Zu[sV]="Cell arguments were not neighbors";Zu[aV]="Cell arguments had incompatible resolutions";Zu[oV]="Memory allocation failed";Zu[lV]="Bounds of provided memory were insufficient";Zu[uV]="Mode or flags argument was not valid";var cV=1e3,v5=1001,x5=1002,g1={};g1[cV]="Unknown unit";g1[v5]="Array length out of bounds";g1[x5]="Got unexpected null value for H3 index";var hV="Unknown error";function b5(e,t,n){var c=n&&"value"in n,g=new Error((e[t]||hV)+" (code: "+t+(c?", value: "+n.value:"")+")");return g.code=t,g}function w5(e,t){var n=arguments.length===2?{value:t}:{};return b5(Zu,e,n)}function S5(e,t){var n=arguments.length===2?{value:t}:{};return b5(g1,e,n)}function j_(e){if(e!==0)throw w5(e)}var mh={};WN.forEach(function(t){mh[t[0]]=Ca.cwrap.apply(Ca,t)});var nm=16,Ig=4,E2=8,AV=8,Z_=mh.sizeOfH3Index(),C2=mh.sizeOfLatLng();mh.sizeOfCellBoundary();var fV=mh.sizeOfGeoPolygon(),cg=mh.sizeOfGeoLoop();mh.sizeOfLinkedGeoPolygon();mh.sizeOfCoordIJ();function dV(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw w5(y5,e);return e}function pV(e){if(!e)throw S5(x5);return e}var mV=Math.pow(2,32)-1;function gV(e){if(e>mV)throw S5(v5,e);return e}var _V=/[^0-9a-fA-F]/;function yV(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||_V.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),nm),n=parseInt(e.substring(e.length-8),nm);return[n,t]}function ww(e){if(e>=0)return e.toString(nm);e=e&2147483647;var t=I5(8,e.toString(nm)),n=(parseInt(t[0],nm)+8).toString(nm);return t=n+t.substring(1),t}function vV(e,t){return ww(t)+I5(8,ww(e))}function I5(e,t){for(var n=e-t.length,c="",g=0;g<n;g++)c+="0";return c=c+t,c}function Sw(e,t,n){for(var c=e.length,g=Ca._calloc(c,C2),b=n?1:0,E=n?0:1,a=0;a<c*2;a+=2)Ca.HEAPF64.set([e[a/2][b],e[a/2][E]].map(C5),g/E2+a);return Ca.HEAPU32.set([c,g],t/Ig),t}function xV(e,t){var n=e.length-1,c=Ca._calloc(fV),g=0,b=g+cg,E=b+Ig;Sw(e[0],c+g,t);var a;if(n>0){a=Ca._calloc(n,cg);for(var U=0;U<n;U++)Sw(e[U+1],a+cg*U,t)}return Ca.setValue(c+b,n,"i32"),Ca.setValue(c+E,a,"i32"),c}function bV(e){var t=0,n=t+cg,c=n+Ig,g=Ig;Ca._free(Ca.getValue(e+t+g,"i8*"));var b=Ca.getValue(e+n,"i32");if(b>0){for(var E=Ca.getValue(e+c,"i32"),a=0;a<b;a++)Ca._free(Ca.getValue(E+cg*a+g,"i8*"));Ca._free(E)}Ca._free(e)}function E5(e,t){t===void 0&&(t=0);var n=Ca.getValue(e+Z_*t,"i32"),c=Ca.getValue(e+Z_*t+Ig,"i32");return c?vV(n,c):null}function wV(e){return mh.readInt64AsDoubleFromPointer(e)}function SV(e,t){for(var n=[],c=0;c<t;c++){var g=E5(e,c);g!==null&&n.push(g)}return n}function Iw(e){return TV(Ca.getValue(e,"double"))}function IV(e){return[Iw(e),Iw(e+E2)]}function EV(e,t,n){var c=Ca._malloc(C2);Ca.HEAPF64.set([e,t].map(C5),c/E2);var g=Ca._malloc(Z_);try{return j_(mh.latLngToCell(c,n,g)),pV(E5(g))}finally{Ca._free(g),Ca._free(c)}}function Ew(e){var t=Ca._malloc(C2),n=yV(e),c=n[0],g=n[1];try{return j_(mh.cellToLatLng(c,g,t)),IV(t)}finally{Ca._free(t)}}function CV(e,t,n){if(dV(t),n=!!n,e.length===0||e[0].length===0)return[];var c=typeof e[0][0]=="number"?[e]:e,g=xV(c,n),b=Ca._malloc(AV);try{j_(mh.maxPolygonToCellsSize(g,t,0,b));var E=gV(wV(b)),a=Ca._calloc(E,Z_);try{return j_(mh.polygonToCells(g,t,0,a)),SV(a,E)}finally{Ca._free(a)}}finally{Ca._free(b),bV(g)}}function C5(e){return e*Math.PI/180}function TV(e){return e*180/Math.PI}function kV(e,t,n){n===void 0&&(n={});var c={type:"Feature"};return(n.id===0||n.id)&&(c.id=n.id),n.bbox&&(c.bbox=n.bbox),c.properties=t||{},c.geometry=e,c}function MV(e,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function PV(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length&&t(e.features[n],n)!==!1;n++);}function DV(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return PV(e,function(n){var c,g,b,E;switch((E=n.geometry)===null||E===void 0?void 0:E.type){case"Point":t.MultiPoint.coordinates.push(n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"MultiPoint":(c=t.MultiPoint.coordinates).push.apply(c,n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"LineString":t.MultiLineString.coordinates.push(n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"MultiLineString":(g=t.MultiLineString.coordinates).push.apply(g,n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break;case"MultiPolygon":(b=t.MultiPolygon.coordinates).push.apply(b,n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break}}),MV(Object.keys(t).filter(function(n){return t[n].coordinates.length}).sort().map(function(n){var c={type:n,coordinates:t[n].coordinates},g={collectedProperties:t[n].properties};return kV(c,g)}))}const T5=e=>()=>e,Iv=e=>{const t=e?(n,c)=>c.minus(n).abs().isLessThanOrEqualTo(e):T5(!1);return(n,c)=>t(n,c)?0:n.comparedTo(c)};function LV(e){const t=e?(n,c,g,b,E)=>n.exponentiatedBy(2).isLessThanOrEqualTo(b.minus(c).exponentiatedBy(2).plus(E.minus(g).exponentiatedBy(2)).times(e)):T5(!1);return(n,c,g)=>{const b=n.x,E=n.y,a=g.x,U=g.y,W=E.minus(U).times(c.x.minus(a)).minus(b.minus(a).times(c.y.minus(U)));return t(W,b,E,a,U)?0:W.comparedTo(0)}}var BV=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ly=Math.ceil,Lh=Math.floor,Nc="[BigNumber Error] ",Cw=Nc+"Number primitive has more than 15 significant digits: ",aA=1e14,bs=14,uy=9007199254740991,cy=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],z0=1e7,Pu=1e9;function k5(e){var t,n,c,g=ut.prototype={constructor:ut,toString:null,valueOf:null},b=new ut(1),E=20,a=4,U=-7,W=21,ce=-1e7,oe=1e7,fe=!1,we=1,et=0,lt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Ke="0123456789abcdefghijklmnopqrstuvwxyz",st=!0;function ut(it,xt){var _t,mt,bt,dt,nt,pt,at,Nt,Ft=this;if(!(Ft instanceof ut))return new ut(it,xt);if(xt==null){if(it&&it._isBigNumber===!0){Ft.s=it.s,!it.c||it.e>oe?Ft.c=Ft.e=null:it.e<ce?Ft.c=[Ft.e=0]:(Ft.e=it.e,Ft.c=it.c.slice());return}if((pt=typeof it=="number")&&it*0==0){if(Ft.s=1/it<0?(it=-it,-1):1,it===~~it){for(dt=0,nt=it;nt>=10;nt/=10,dt++);dt>oe?Ft.c=Ft.e=null:(Ft.e=dt,Ft.c=[it]);return}Nt=String(it)}else{if(!BV.test(Nt=String(it)))return c(Ft,Nt,pt);Ft.s=Nt.charCodeAt(0)==45?(Nt=Nt.slice(1),-1):1}(dt=Nt.indexOf("."))>-1&&(Nt=Nt.replace(".","")),(nt=Nt.search(/e/i))>0?(dt<0&&(dt=nt),dt+=+Nt.slice(nt+1),Nt=Nt.substring(0,nt)):dt<0&&(dt=Nt.length)}else{if(Fl(xt,2,Ke.length,"Base"),xt==10&&st)return Ft=new ut(it),Ge(Ft,E+Ft.e+1,a);if(Nt=String(it),pt=typeof it=="number"){if(it*0!=0)return c(Ft,Nt,pt,xt);if(Ft.s=1/it<0?(Nt=Nt.slice(1),-1):1,ut.DEBUG&&Nt.replace(/^0\.0*|\./,"").length>15)throw Error(Cw+it)}else Ft.s=Nt.charCodeAt(0)===45?(Nt=Nt.slice(1),-1):1;for(_t=Ke.slice(0,xt),dt=nt=0,at=Nt.length;nt<at;nt++)if(_t.indexOf(mt=Nt.charAt(nt))<0){if(mt=="."){if(nt>dt){dt=at;continue}}else if(!bt&&(Nt==Nt.toUpperCase()&&(Nt=Nt.toLowerCase())||Nt==Nt.toLowerCase()&&(Nt=Nt.toUpperCase()))){bt=!0,nt=-1,dt=0;continue}return c(Ft,String(it),pt,xt)}pt=!1,Nt=n(Nt,xt,10,Ft.s),(dt=Nt.indexOf("."))>-1?Nt=Nt.replace(".",""):dt=Nt.length}for(nt=0;Nt.charCodeAt(nt)===48;nt++);for(at=Nt.length;Nt.charCodeAt(--at)===48;);if(Nt=Nt.slice(nt,++at)){if(at-=nt,pt&&ut.DEBUG&&at>15&&(it>uy||it!==Lh(it)))throw Error(Cw+Ft.s*it);if((dt=dt-nt-1)>oe)Ft.c=Ft.e=null;else if(dt<ce)Ft.c=[Ft.e=0];else{if(Ft.e=dt,Ft.c=[],nt=(dt+1)%bs,dt<0&&(nt+=bs),nt<at){for(nt&&Ft.c.push(+Nt.slice(0,nt)),at-=bs;nt<at;)Ft.c.push(+Nt.slice(nt,nt+=bs));nt=bs-(Nt=Nt.slice(nt)).length}else nt-=at;for(;nt--;Nt+="0");Ft.c.push(+Nt)}}else Ft.c=[Ft.e=0]}ut.clone=k5,ut.ROUND_UP=0,ut.ROUND_DOWN=1,ut.ROUND_CEIL=2,ut.ROUND_FLOOR=3,ut.ROUND_HALF_UP=4,ut.ROUND_HALF_DOWN=5,ut.ROUND_HALF_EVEN=6,ut.ROUND_HALF_CEIL=7,ut.ROUND_HALF_FLOOR=8,ut.EUCLID=9,ut.config=ut.set=function(it){var xt,_t;if(it!=null)if(typeof it=="object"){if(it.hasOwnProperty(xt="DECIMAL_PLACES")&&(_t=it[xt],Fl(_t,0,Pu,xt),E=_t),it.hasOwnProperty(xt="ROUNDING_MODE")&&(_t=it[xt],Fl(_t,0,8,xt),a=_t),it.hasOwnProperty(xt="EXPONENTIAL_AT")&&(_t=it[xt],_t&&_t.pop?(Fl(_t[0],-Pu,0,xt),Fl(_t[1],0,Pu,xt),U=_t[0],W=_t[1]):(Fl(_t,-Pu,Pu,xt),U=-(W=_t<0?-_t:_t))),it.hasOwnProperty(xt="RANGE"))if(_t=it[xt],_t&&_t.pop)Fl(_t[0],-Pu,-1,xt),Fl(_t[1],1,Pu,xt),ce=_t[0],oe=_t[1];else if(Fl(_t,-Pu,Pu,xt),_t)ce=-(oe=_t<0?-_t:_t);else throw Error(Nc+xt+" cannot be zero: "+_t);if(it.hasOwnProperty(xt="CRYPTO"))if(_t=it[xt],_t===!!_t)if(_t)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))fe=_t;else throw fe=!_t,Error(Nc+"crypto unavailable");else fe=_t;else throw Error(Nc+xt+" not true or false: "+_t);if(it.hasOwnProperty(xt="MODULO_MODE")&&(_t=it[xt],Fl(_t,0,9,xt),we=_t),it.hasOwnProperty(xt="POW_PRECISION")&&(_t=it[xt],Fl(_t,0,Pu,xt),et=_t),it.hasOwnProperty(xt="FORMAT"))if(_t=it[xt],typeof _t=="object")lt=_t;else throw Error(Nc+xt+" not an object: "+_t);if(it.hasOwnProperty(xt="ALPHABET"))if(_t=it[xt],typeof _t=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(_t))st=_t.slice(0,10)=="0123456789",Ke=_t;else throw Error(Nc+xt+" invalid: "+_t)}else throw Error(Nc+"Object expected: "+it);return{DECIMAL_PLACES:E,ROUNDING_MODE:a,EXPONENTIAL_AT:[U,W],RANGE:[ce,oe],CRYPTO:fe,MODULO_MODE:we,POW_PRECISION:et,FORMAT:lt,ALPHABET:Ke}},ut.isBigNumber=function(it){if(!it||it._isBigNumber!==!0)return!1;if(!ut.DEBUG)return!0;var xt,_t,mt=it.c,bt=it.e,dt=it.s;e:if({}.toString.call(mt)=="[object Array]"){if((dt===1||dt===-1)&&bt>=-Pu&&bt<=Pu&&bt===Lh(bt)){if(mt[0]===0){if(bt===0&&mt.length===1)return!0;break e}if(xt=(bt+1)%bs,xt<1&&(xt+=bs),String(mt[0]).length==xt){for(xt=0;xt<mt.length;xt++)if(_t=mt[xt],_t<0||_t>=aA||_t!==Lh(_t))break e;if(_t!==0)return!0}}}else if(mt===null&&bt===null&&(dt===null||dt===1||dt===-1))return!0;throw Error(Nc+"Invalid BigNumber: "+it)},ut.maximum=ut.max=function(){return Bt(arguments,-1)},ut.minimum=ut.min=function(){return Bt(arguments,1)},ut.random=function(){var it=9007199254740992,xt=Math.random()*it&2097151?function(){return Lh(Math.random()*it)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(_t){var mt,bt,dt,nt,pt,at=0,Nt=[],Ft=new ut(b);if(_t==null?_t=E:Fl(_t,0,Pu),nt=ly(_t/bs),fe)if(crypto.getRandomValues){for(mt=crypto.getRandomValues(new Uint32Array(nt*=2));at<nt;)pt=mt[at]*131072+(mt[at+1]>>>11),pt>=9e15?(bt=crypto.getRandomValues(new Uint32Array(2)),mt[at]=bt[0],mt[at+1]=bt[1]):(Nt.push(pt%1e14),at+=2);at=nt/2}else if(crypto.randomBytes){for(mt=crypto.randomBytes(nt*=7);at<nt;)pt=(mt[at]&31)*281474976710656+mt[at+1]*1099511627776+mt[at+2]*4294967296+mt[at+3]*16777216+(mt[at+4]<<16)+(mt[at+5]<<8)+mt[at+6],pt>=9e15?crypto.randomBytes(7).copy(mt,at):(Nt.push(pt%1e14),at+=7);at=nt/7}else throw fe=!1,Error(Nc+"crypto unavailable");if(!fe)for(;at<nt;)pt=xt(),pt<9e15&&(Nt[at++]=pt%1e14);for(nt=Nt[--at],_t%=bs,nt&&_t&&(pt=cy[bs-_t],Nt[at]=Lh(nt/pt)*pt);Nt[at]===0;Nt.pop(),at--);if(at<0)Nt=[dt=0];else{for(dt=-1;Nt[0]===0;Nt.splice(0,1),dt-=bs);for(at=1,pt=Nt[0];pt>=10;pt/=10,at++);at<bs&&(dt-=bs-at)}return Ft.e=dt,Ft.c=Nt,Ft}}(),ut.sum=function(){for(var it=1,xt=arguments,_t=new ut(xt[0]);it<xt.length;)_t=_t.plus(xt[it++]);return _t},n=function(){var it="0123456789";function xt(_t,mt,bt,dt){for(var nt,pt=[0],at,Nt=0,Ft=_t.length;Nt<Ft;){for(at=pt.length;at--;pt[at]*=mt);for(pt[0]+=dt.indexOf(_t.charAt(Nt++)),nt=0;nt<pt.length;nt++)pt[nt]>bt-1&&(pt[nt+1]==null&&(pt[nt+1]=0),pt[nt+1]+=pt[nt]/bt|0,pt[nt]%=bt)}return pt.reverse()}return function(_t,mt,bt,dt,nt){var pt,at,Nt,Ft,Dt,ci,bi,ki,Gi=_t.indexOf("."),rn=E,$i=a;for(Gi>=0&&(Ft=et,et=0,_t=_t.replace(".",""),ki=new ut(mt),ci=ki.pow(_t.length-Gi),et=Ft,ki.c=xt(Xf(Dh(ci.c),ci.e,"0"),10,bt,it),ki.e=ki.c.length),bi=xt(_t,mt,bt,nt?(pt=Ke,it):(pt=it,Ke)),Nt=Ft=bi.length;bi[--Ft]==0;bi.pop());if(!bi[0])return pt.charAt(0);if(Gi<0?--Nt:(ci.c=bi,ci.e=Nt,ci.s=dt,ci=t(ci,ki,rn,$i,bt),bi=ci.c,Dt=ci.r,Nt=ci.e),at=Nt+rn+1,Gi=bi[at],Ft=bt/2,Dt=Dt||at<0||bi[at+1]!=null,Dt=$i<4?(Gi!=null||Dt)&&($i==0||$i==(ci.s<0?3:2)):Gi>Ft||Gi==Ft&&($i==4||Dt||$i==6&&bi[at-1]&1||$i==(ci.s<0?8:7)),at<1||!bi[0])_t=Dt?Xf(pt.charAt(1),-rn,pt.charAt(0)):pt.charAt(0);else{if(bi.length=at,Dt)for(--bt;++bi[--at]>bt;)bi[at]=0,at||(++Nt,bi=[1].concat(bi));for(Ft=bi.length;!bi[--Ft];);for(Gi=0,_t="";Gi<=Ft;_t+=pt.charAt(bi[Gi++]));_t=Xf(_t,Nt,pt.charAt(0))}return _t}}(),t=function(){function it(mt,bt,dt){var nt,pt,at,Nt,Ft=0,Dt=mt.length,ci=bt%z0,bi=bt/z0|0;for(mt=mt.slice();Dt--;)at=mt[Dt]%z0,Nt=mt[Dt]/z0|0,nt=bi*at+Nt*ci,pt=ci*at+nt%z0*z0+Ft,Ft=(pt/dt|0)+(nt/z0|0)+bi*Nt,mt[Dt]=pt%dt;return Ft&&(mt=[Ft].concat(mt)),mt}function xt(mt,bt,dt,nt){var pt,at;if(dt!=nt)at=dt>nt?1:-1;else for(pt=at=0;pt<dt;pt++)if(mt[pt]!=bt[pt]){at=mt[pt]>bt[pt]?1:-1;break}return at}function _t(mt,bt,dt,nt){for(var pt=0;dt--;)mt[dt]-=pt,pt=mt[dt]<bt[dt]?1:0,mt[dt]=pt*nt+mt[dt]-bt[dt];for(;!mt[0]&&mt.length>1;mt.splice(0,1));}return function(mt,bt,dt,nt,pt){var at,Nt,Ft,Dt,ci,bi,ki,Gi,rn,$i,qi,sn,Ti,yi,hi,Ei,Li,fn=mt.s==bt.s?1:-1,_n=mt.c,gi=bt.c;if(!_n||!_n[0]||!gi||!gi[0])return new ut(!mt.s||!bt.s||(_n?gi&&_n[0]==gi[0]:!gi)?NaN:_n&&_n[0]==0||!gi?fn*0:fn/0);for(Gi=new ut(fn),rn=Gi.c=[],Nt=mt.e-bt.e,fn=dt+Nt+1,pt||(pt=aA,Nt=Bh(mt.e/bs)-Bh(bt.e/bs),fn=fn/bs|0),Ft=0;gi[Ft]==(_n[Ft]||0);Ft++);if(gi[Ft]>(_n[Ft]||0)&&Nt--,fn<0)rn.push(1),Dt=!0;else{for(yi=_n.length,Ei=gi.length,Ft=0,fn+=2,ci=Lh(pt/(gi[0]+1)),ci>1&&(gi=it(gi,ci,pt),_n=it(_n,ci,pt),Ei=gi.length,yi=_n.length),Ti=Ei,$i=_n.slice(0,Ei),qi=$i.length;qi<Ei;$i[qi++]=0);Li=gi.slice(),Li=[0].concat(Li),hi=gi[0],gi[1]>=pt/2&&hi++;do{if(ci=0,at=xt(gi,$i,Ei,qi),at<0){if(sn=$i[0],Ei!=qi&&(sn=sn*pt+($i[1]||0)),ci=Lh(sn/hi),ci>1)for(ci>=pt&&(ci=pt-1),bi=it(gi,ci,pt),ki=bi.length,qi=$i.length;xt(bi,$i,ki,qi)==1;)ci--,_t(bi,Ei<ki?Li:gi,ki,pt),ki=bi.length,at=1;else ci==0&&(at=ci=1),bi=gi.slice(),ki=bi.length;if(ki<qi&&(bi=[0].concat(bi)),_t($i,bi,qi,pt),qi=$i.length,at==-1)for(;xt(gi,$i,Ei,qi)<1;)ci++,_t($i,Ei<qi?Li:gi,qi,pt),qi=$i.length}else at===0&&(ci++,$i=[0]);rn[Ft++]=ci,$i[0]?$i[qi++]=_n[Ti]||0:($i=[_n[Ti]],qi=1)}while((Ti++<yi||$i[0]!=null)&&fn--);Dt=$i[0]!=null,rn[0]||rn.splice(0,1)}if(pt==aA){for(Ft=1,fn=rn[0];fn>=10;fn/=10,Ft++);Ge(Gi,dt+(Gi.e=Ft+Nt*bs-1)+1,nt,Dt)}else Gi.e=Nt,Gi.r=+Dt;return Gi}}();function kt(it,xt,_t,mt){var bt,dt,nt,pt,at;if(_t==null?_t=a:Fl(_t,0,8),!it.c)return it.toString();if(bt=it.c[0],nt=it.e,xt==null)at=Dh(it.c),at=mt==1||mt==2&&(nt<=U||nt>=W)?$g(at,nt):Xf(at,nt,"0");else if(it=Ge(new ut(it),xt,_t),dt=it.e,at=Dh(it.c),pt=at.length,mt==1||mt==2&&(xt<=dt||dt<=U)){for(;pt<xt;at+="0",pt++);at=$g(at,dt)}else if(xt-=nt,at=Xf(at,dt,"0"),dt+1>pt){if(--xt>0)for(at+=".";xt--;at+="0");}else if(xt+=dt-pt,xt>0)for(dt+1==pt&&(at+=".");xt--;at+="0");return it.s<0&&bt?"-"+at:at}function Bt(it,xt){for(var _t,mt,bt=1,dt=new ut(it[0]);bt<it.length;bt++)mt=new ut(it[bt]),(!mt.s||(_t=Hd(dt,mt))===xt||_t===0&&dt.s===xt)&&(dt=mt);return dt}function Rt(it,xt,_t){for(var mt=1,bt=xt.length;!xt[--bt];xt.pop());for(bt=xt[0];bt>=10;bt/=10,mt++);return(_t=mt+_t*bs-1)>oe?it.c=it.e=null:_t<ce?it.c=[it.e=0]:(it.e=_t,it.c=xt),it}c=function(){var it=/^(-?)0([xbo])(?=\w[\w.]*$)/i,xt=/^([^.]+)\.$/,_t=/^\.([^.]+)$/,mt=/^-?(Infinity|NaN)$/,bt=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(dt,nt,pt,at){var Nt,Ft=pt?nt:nt.replace(bt,"");if(mt.test(Ft))dt.s=isNaN(Ft)?null:Ft<0?-1:1;else{if(!pt&&(Ft=Ft.replace(it,function(Dt,ci,bi){return Nt=(bi=bi.toLowerCase())=="x"?16:bi=="b"?2:8,!at||at==Nt?ci:Dt}),at&&(Nt=at,Ft=Ft.replace(xt,"$1").replace(_t,"0.$1")),nt!=Ft))return new ut(Ft,Nt);if(ut.DEBUG)throw Error(Nc+"Not a"+(at?" base "+at:"")+" number: "+nt);dt.s=null}dt.c=dt.e=null}}();function Ge(it,xt,_t,mt){var bt,dt,nt,pt,at,Nt,Ft,Dt=it.c,ci=cy;if(Dt){e:{for(bt=1,pt=Dt[0];pt>=10;pt/=10,bt++);if(dt=xt-bt,dt<0)dt+=bs,nt=xt,at=Dt[Nt=0],Ft=Lh(at/ci[bt-nt-1]%10);else if(Nt=ly((dt+1)/bs),Nt>=Dt.length)if(mt){for(;Dt.length<=Nt;Dt.push(0));at=Ft=0,bt=1,dt%=bs,nt=dt-bs+1}else break e;else{for(at=pt=Dt[Nt],bt=1;pt>=10;pt/=10,bt++);dt%=bs,nt=dt-bs+bt,Ft=nt<0?0:Lh(at/ci[bt-nt-1]%10)}if(mt=mt||xt<0||Dt[Nt+1]!=null||(nt<0?at:at%ci[bt-nt-1]),mt=_t<4?(Ft||mt)&&(_t==0||_t==(it.s<0?3:2)):Ft>5||Ft==5&&(_t==4||mt||_t==6&&(dt>0?nt>0?at/ci[bt-nt]:0:Dt[Nt-1])%10&1||_t==(it.s<0?8:7)),xt<1||!Dt[0])return Dt.length=0,mt?(xt-=it.e+1,Dt[0]=ci[(bs-xt%bs)%bs],it.e=-xt||0):Dt[0]=it.e=0,it;if(dt==0?(Dt.length=Nt,pt=1,Nt--):(Dt.length=Nt+1,pt=ci[bs-dt],Dt[Nt]=nt>0?Lh(at/ci[bt-nt]%ci[nt])*pt:0),mt)for(;;)if(Nt==0){for(dt=1,nt=Dt[0];nt>=10;nt/=10,dt++);for(nt=Dt[0]+=pt,pt=1;nt>=10;nt/=10,pt++);dt!=pt&&(it.e++,Dt[0]==aA&&(Dt[0]=1));break}else{if(Dt[Nt]+=pt,Dt[Nt]!=aA)break;Dt[Nt--]=0,pt=1}for(dt=Dt.length;Dt[--dt]===0;Dt.pop());}it.e>oe?it.c=it.e=null:it.e<ce&&(it.c=[it.e=0])}return it}function ni(it){var xt,_t=it.e;return _t===null?it.toString():(xt=Dh(it.c),xt=_t<=U||_t>=W?$g(xt,_t):Xf(xt,_t,"0"),it.s<0?"-"+xt:xt)}return g.absoluteValue=g.abs=function(){var it=new ut(this);return it.s<0&&(it.s=1),it},g.comparedTo=function(it,xt){return Hd(this,new ut(it,xt))},g.decimalPlaces=g.dp=function(it,xt){var _t,mt,bt,dt=this;if(it!=null)return Fl(it,0,Pu),xt==null?xt=a:Fl(xt,0,8),Ge(new ut(dt),it+dt.e+1,xt);if(!(_t=dt.c))return null;if(mt=((bt=_t.length-1)-Bh(this.e/bs))*bs,bt=_t[bt])for(;bt%10==0;bt/=10,mt--);return mt<0&&(mt=0),mt},g.dividedBy=g.div=function(it,xt){return t(this,new ut(it,xt),E,a)},g.dividedToIntegerBy=g.idiv=function(it,xt){return t(this,new ut(it,xt),0,1)},g.exponentiatedBy=g.pow=function(it,xt){var _t,mt,bt,dt,nt,pt,at,Nt,Ft,Dt=this;if(it=new ut(it),it.c&&!it.isInteger())throw Error(Nc+"Exponent not an integer: "+ni(it));if(xt!=null&&(xt=new ut(xt)),pt=it.e>14,!Dt.c||!Dt.c[0]||Dt.c[0]==1&&!Dt.e&&Dt.c.length==1||!it.c||!it.c[0])return Ft=new ut(Math.pow(+ni(Dt),pt?it.s*(2-Yg(it)):+ni(it))),xt?Ft.mod(xt):Ft;if(at=it.s<0,xt){if(xt.c?!xt.c[0]:!xt.s)return new ut(NaN);mt=!at&&Dt.isInteger()&&xt.isInteger(),mt&&(Dt=Dt.mod(xt))}else{if(it.e>9&&(Dt.e>0||Dt.e<-1||(Dt.e==0?Dt.c[0]>1||pt&&Dt.c[1]>=24e7:Dt.c[0]<8e13||pt&&Dt.c[0]<=9999975e7)))return dt=Dt.s<0&&Yg(it)?-0:0,Dt.e>-1&&(dt=1/dt),new ut(at?1/dt:dt);et&&(dt=ly(et/bs+2))}for(pt?(_t=new ut(.5),at&&(it.s=1),Nt=Yg(it)):(bt=Math.abs(+ni(it)),Nt=bt%2),Ft=new ut(b);;){if(Nt){if(Ft=Ft.times(Dt),!Ft.c)break;dt?Ft.c.length>dt&&(Ft.c.length=dt):mt&&(Ft=Ft.mod(xt))}if(bt){if(bt=Lh(bt/2),bt===0)break;Nt=bt%2}else if(it=it.times(_t),Ge(it,it.e+1,1),it.e>14)Nt=Yg(it);else{if(bt=+ni(it),bt===0)break;Nt=bt%2}Dt=Dt.times(Dt),dt?Dt.c&&Dt.c.length>dt&&(Dt.c.length=dt):mt&&(Dt=Dt.mod(xt))}return mt?Ft:(at&&(Ft=b.div(Ft)),xt?Ft.mod(xt):dt?Ge(Ft,et,a,nt):Ft)},g.integerValue=function(it){var xt=new ut(this);return it==null?it=a:Fl(it,0,8),Ge(xt,xt.e+1,it)},g.isEqualTo=g.eq=function(it,xt){return Hd(this,new ut(it,xt))===0},g.isFinite=function(){return!!this.c},g.isGreaterThan=g.gt=function(it,xt){return Hd(this,new ut(it,xt))>0},g.isGreaterThanOrEqualTo=g.gte=function(it,xt){return(xt=Hd(this,new ut(it,xt)))===1||xt===0},g.isInteger=function(){return!!this.c&&Bh(this.e/bs)>this.c.length-2},g.isLessThan=g.lt=function(it,xt){return Hd(this,new ut(it,xt))<0},g.isLessThanOrEqualTo=g.lte=function(it,xt){return(xt=Hd(this,new ut(it,xt)))===-1||xt===0},g.isNaN=function(){return!this.s},g.isNegative=function(){return this.s<0},g.isPositive=function(){return this.s>0},g.isZero=function(){return!!this.c&&this.c[0]==0},g.minus=function(it,xt){var _t,mt,bt,dt,nt=this,pt=nt.s;if(it=new ut(it,xt),xt=it.s,!pt||!xt)return new ut(NaN);if(pt!=xt)return it.s=-xt,nt.plus(it);var at=nt.e/bs,Nt=it.e/bs,Ft=nt.c,Dt=it.c;if(!at||!Nt){if(!Ft||!Dt)return Ft?(it.s=-xt,it):new ut(Dt?nt:NaN);if(!Ft[0]||!Dt[0])return Dt[0]?(it.s=-xt,it):new ut(Ft[0]?nt:a==3?-0:0)}if(at=Bh(at),Nt=Bh(Nt),Ft=Ft.slice(),pt=at-Nt){for((dt=pt<0)?(pt=-pt,bt=Ft):(Nt=at,bt=Dt),bt.reverse(),xt=pt;xt--;bt.push(0));bt.reverse()}else for(mt=(dt=(pt=Ft.length)<(xt=Dt.length))?pt:xt,pt=xt=0;xt<mt;xt++)if(Ft[xt]!=Dt[xt]){dt=Ft[xt]<Dt[xt];break}if(dt&&(bt=Ft,Ft=Dt,Dt=bt,it.s=-it.s),xt=(mt=Dt.length)-(_t=Ft.length),xt>0)for(;xt--;Ft[_t++]=0);for(xt=aA-1;mt>pt;){if(Ft[--mt]<Dt[mt]){for(_t=mt;_t&&!Ft[--_t];Ft[_t]=xt);--Ft[_t],Ft[mt]+=aA}Ft[mt]-=Dt[mt]}for(;Ft[0]==0;Ft.splice(0,1),--Nt);return Ft[0]?Rt(it,Ft,Nt):(it.s=a==3?-1:1,it.c=[it.e=0],it)},g.modulo=g.mod=function(it,xt){var _t,mt,bt=this;return it=new ut(it,xt),!bt.c||!it.s||it.c&&!it.c[0]?new ut(NaN):!it.c||bt.c&&!bt.c[0]?new ut(bt):(we==9?(mt=it.s,it.s=1,_t=t(bt,it,0,3),it.s=mt,_t.s*=mt):_t=t(bt,it,0,we),it=bt.minus(_t.times(it)),!it.c[0]&&we==1&&(it.s=bt.s),it)},g.multipliedBy=g.times=function(it,xt){var _t,mt,bt,dt,nt,pt,at,Nt,Ft,Dt,ci,bi,ki,Gi,rn,$i=this,qi=$i.c,sn=(it=new ut(it,xt)).c;if(!qi||!sn||!qi[0]||!sn[0])return!$i.s||!it.s||qi&&!qi[0]&&!sn||sn&&!sn[0]&&!qi?it.c=it.e=it.s=null:(it.s*=$i.s,!qi||!sn?it.c=it.e=null:(it.c=[0],it.e=0)),it;for(mt=Bh($i.e/bs)+Bh(it.e/bs),it.s*=$i.s,at=qi.length,Dt=sn.length,at<Dt&&(ki=qi,qi=sn,sn=ki,bt=at,at=Dt,Dt=bt),bt=at+Dt,ki=[];bt--;ki.push(0));for(Gi=aA,rn=z0,bt=Dt;--bt>=0;){for(_t=0,ci=sn[bt]%rn,bi=sn[bt]/rn|0,nt=at,dt=bt+nt;dt>bt;)Nt=qi[--nt]%rn,Ft=qi[nt]/rn|0,pt=bi*Nt+Ft*ci,Nt=ci*Nt+pt%rn*rn+ki[dt]+_t,_t=(Nt/Gi|0)+(pt/rn|0)+bi*Ft,ki[dt--]=Nt%Gi;ki[dt]=_t}return _t?++mt:ki.splice(0,1),Rt(it,ki,mt)},g.negated=function(){var it=new ut(this);return it.s=-it.s||null,it},g.plus=function(it,xt){var _t,mt=this,bt=mt.s;if(it=new ut(it,xt),xt=it.s,!bt||!xt)return new ut(NaN);if(bt!=xt)return it.s=-xt,mt.minus(it);var dt=mt.e/bs,nt=it.e/bs,pt=mt.c,at=it.c;if(!dt||!nt){if(!pt||!at)return new ut(bt/0);if(!pt[0]||!at[0])return at[0]?it:new ut(pt[0]?mt:bt*0)}if(dt=Bh(dt),nt=Bh(nt),pt=pt.slice(),bt=dt-nt){for(bt>0?(nt=dt,_t=at):(bt=-bt,_t=pt),_t.reverse();bt--;_t.push(0));_t.reverse()}for(bt=pt.length,xt=at.length,bt-xt<0&&(_t=at,at=pt,pt=_t,xt=bt),bt=0;xt;)bt=(pt[--xt]=pt[xt]+at[xt]+bt)/aA|0,pt[xt]=aA===pt[xt]?0:pt[xt]%aA;return bt&&(pt=[bt].concat(pt),++nt),Rt(it,pt,nt)},g.precision=g.sd=function(it,xt){var _t,mt,bt,dt=this;if(it!=null&&it!==!!it)return Fl(it,1,Pu),xt==null?xt=a:Fl(xt,0,8),Ge(new ut(dt),it,xt);if(!(_t=dt.c))return null;if(bt=_t.length-1,mt=bt*bs+1,bt=_t[bt]){for(;bt%10==0;bt/=10,mt--);for(bt=_t[0];bt>=10;bt/=10,mt++);}return it&&dt.e+1>mt&&(mt=dt.e+1),mt},g.shiftedBy=function(it){return Fl(it,-uy,uy),this.times("1e"+it)},g.squareRoot=g.sqrt=function(){var it,xt,_t,mt,bt,dt=this,nt=dt.c,pt=dt.s,at=dt.e,Nt=E+4,Ft=new ut("0.5");if(pt!==1||!nt||!nt[0])return new ut(!pt||pt<0&&(!nt||nt[0])?NaN:nt?dt:1/0);if(pt=Math.sqrt(+ni(dt)),pt==0||pt==1/0?(xt=Dh(nt),(xt.length+at)%2==0&&(xt+="0"),pt=Math.sqrt(+xt),at=Bh((at+1)/2)-(at<0||at%2),pt==1/0?xt="5e"+at:(xt=pt.toExponential(),xt=xt.slice(0,xt.indexOf("e")+1)+at),_t=new ut(xt)):_t=new ut(pt+""),_t.c[0]){for(at=_t.e,pt=at+Nt,pt<3&&(pt=0);;)if(bt=_t,_t=Ft.times(bt.plus(t(dt,bt,Nt,1))),Dh(bt.c).slice(0,pt)===(xt=Dh(_t.c)).slice(0,pt))if(_t.e<at&&--pt,xt=xt.slice(pt-3,pt+1),xt=="9999"||!mt&&xt=="4999"){if(!mt&&(Ge(bt,bt.e+E+2,0),bt.times(bt).eq(dt))){_t=bt;break}Nt+=4,pt+=4,mt=1}else{(!+xt||!+xt.slice(1)&&xt.charAt(0)=="5")&&(Ge(_t,_t.e+E+2,1),it=!_t.times(_t).eq(dt));break}}return Ge(_t,_t.e+E+1,a,it)},g.toExponential=function(it,xt){return it!=null&&(Fl(it,0,Pu),it++),kt(this,it,xt,1)},g.toFixed=function(it,xt){return it!=null&&(Fl(it,0,Pu),it=it+this.e+1),kt(this,it,xt)},g.toFormat=function(it,xt,_t){var mt,bt=this;if(_t==null)it!=null&&xt&&typeof xt=="object"?(_t=xt,xt=null):it&&typeof it=="object"?(_t=it,it=xt=null):_t=lt;else if(typeof _t!="object")throw Error(Nc+"Argument not an object: "+_t);if(mt=bt.toFixed(it,xt),bt.c){var dt,nt=mt.split("."),pt=+_t.groupSize,at=+_t.secondaryGroupSize,Nt=_t.groupSeparator||"",Ft=nt[0],Dt=nt[1],ci=bt.s<0,bi=ci?Ft.slice(1):Ft,ki=bi.length;if(at&&(dt=pt,pt=at,at=dt,ki-=dt),pt>0&&ki>0){for(dt=ki%pt||pt,Ft=bi.substr(0,dt);dt<ki;dt+=pt)Ft+=Nt+bi.substr(dt,pt);at>0&&(Ft+=Nt+bi.slice(dt)),ci&&(Ft="-"+Ft)}mt=Dt?Ft+(_t.decimalSeparator||"")+((at=+_t.fractionGroupSize)?Dt.replace(new RegExp("\\d{"+at+"}\\B","g"),"$&"+(_t.fractionGroupSeparator||"")):Dt):Ft}return(_t.prefix||"")+mt+(_t.suffix||"")},g.toFraction=function(it){var xt,_t,mt,bt,dt,nt,pt,at,Nt,Ft,Dt,ci,bi=this,ki=bi.c;if(it!=null&&(pt=new ut(it),!pt.isInteger()&&(pt.c||pt.s!==1)||pt.lt(b)))throw Error(Nc+"Argument "+(pt.isInteger()?"out of range: ":"not an integer: ")+ni(pt));if(!ki)return new ut(bi);for(xt=new ut(b),Nt=_t=new ut(b),mt=at=new ut(b),ci=Dh(ki),dt=xt.e=ci.length-bi.e-1,xt.c[0]=cy[(nt=dt%bs)<0?bs+nt:nt],it=!it||pt.comparedTo(xt)>0?dt>0?xt:Nt:pt,nt=oe,oe=1/0,pt=new ut(ci),at.c[0]=0;Ft=t(pt,xt,0,1),bt=_t.plus(Ft.times(mt)),bt.comparedTo(it)!=1;)_t=mt,mt=bt,Nt=at.plus(Ft.times(bt=Nt)),at=bt,xt=pt.minus(Ft.times(bt=xt)),pt=bt;return bt=t(it.minus(_t),mt,0,1),at=at.plus(bt.times(Nt)),_t=_t.plus(bt.times(mt)),at.s=Nt.s=bi.s,dt=dt*2,Dt=t(Nt,mt,dt,a).minus(bi).abs().comparedTo(t(at,_t,dt,a).minus(bi).abs())<1?[Nt,mt]:[at,_t],oe=nt,Dt},g.toNumber=function(){return+ni(this)},g.toPrecision=function(it,xt){return it!=null&&Fl(it,1,Pu),kt(this,it,xt,2)},g.toString=function(it){var xt,_t=this,mt=_t.s,bt=_t.e;return bt===null?mt?(xt="Infinity",mt<0&&(xt="-"+xt)):xt="NaN":(it==null?xt=bt<=U||bt>=W?$g(Dh(_t.c),bt):Xf(Dh(_t.c),bt,"0"):it===10&&st?(_t=Ge(new ut(_t),E+bt+1,a),xt=Xf(Dh(_t.c),_t.e,"0")):(Fl(it,2,Ke.length,"Base"),xt=n(Xf(Dh(_t.c),bt,"0"),10,it,mt,!0)),mt<0&&_t.c[0]&&(xt="-"+xt)),xt},g.valueOf=g.toJSON=function(){return ni(this)},g._isBigNumber=!0,g[Symbol.toStringTag]="BigNumber",g[Symbol.for("nodejs.util.inspect.custom")]=g.valueOf,e!=null&&ut.set(e),ut}function Bh(e){var t=e|0;return e>0||e===t?t:t-1}function Dh(e){for(var t,n,c=1,g=e.length,b=e[0]+"";c<g;){for(t=e[c++]+"",n=bs-t.length;n--;t="0"+t);b+=t}for(g=b.length;b.charCodeAt(--g)===48;);return b.slice(0,g+1||1)}function Hd(e,t){var n,c,g=e.c,b=t.c,E=e.s,a=t.s,U=e.e,W=t.e;if(!E||!a)return null;if(n=g&&!g[0],c=b&&!b[0],n||c)return n?c?0:-a:E;if(E!=a)return E;if(n=E<0,c=U==W,!g||!b)return c?0:!g^n?1:-1;if(!c)return U>W^n?1:-1;for(a=(U=g.length)<(W=b.length)?U:W,E=0;E<a;E++)if(g[E]!=b[E])return g[E]>b[E]^n?1:-1;return U==W?0:U>W^n?1:-1}function Fl(e,t,n,c){if(e<t||e>n||e!==Lh(e))throw Error(Nc+(c||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Yg(e){var t=e.c.length-1;return Bh(e.e/bs)==t&&e.c[t]%2!=0}function $g(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Xf(e,t,n){var c,g;if(t<0){for(g=n+".";++t;g+=n);e=g+e}else if(c=e.length,++t>c){for(g=n,t-=c;--t;g+=n);e+=g}else t<c&&(e=e.slice(0,t)+"."+e.slice(t));return e}var XA=k5();class zV{constructor(t){Er(this,"key");Er(this,"left",null);Er(this,"right",null);this.key=t}}class Jm extends zV{constructor(t){super(t)}}class RV{constructor(){Er(this,"size",0);Er(this,"modificationCount",0);Er(this,"splayCount",0)}splay(t){const n=this.root;if(n==null)return this.compare(t,t),-1;let c=null,g=null,b=null,E=null,a=n;const U=this.compare;let W;for(;;)if(W=U(a.key,t),W>0){let ce=a.left;if(ce==null||(W=U(ce.key,t),W>0&&(a.left=ce.right,ce.right=a,a=ce,ce=a.left,ce==null)))break;c==null?g=a:c.left=a,c=a,a=ce}else if(W<0){let ce=a.right;if(ce==null||(W=U(ce.key,t),W<0&&(a.right=ce.left,ce.left=a,a=ce,ce=a.right,ce==null)))break;b==null?E=a:b.right=a,b=a,a=ce}else break;return b!=null&&(b.right=a.left,a.left=E),c!=null&&(c.left=a.right,a.right=g),this.root!==a&&(this.root=a,this.splayCount++),W}splayMin(t){let n=t,c=n.left;for(;c!=null;){const g=c;n.left=g.right,g.right=n,n=g,c=n.left}return n}splayMax(t){let n=t,c=n.right;for(;c!=null;){const g=c;n.right=g.left,g.left=n,n=g,c=n.right}return n}_delete(t){if(this.root==null||this.splay(t)!=0)return null;let c=this.root;const g=c,b=c.left;if(this.size--,b==null)this.root=c.right;else{const E=c.right;c=this.splayMax(b),c.right=E,this.root=c}return this.modificationCount++,g}addNewRoot(t,n){this.size++,this.modificationCount++;const c=this.root;if(c==null){this.root=t;return}n<0?(t.left=c,t.right=c.right,c.right=null):(t.right=c,t.left=c.left,c.left=null),this.root=t}_first(){const t=this.root;return t==null?null:(this.root=this.splayMin(t),this.root)}_last(){const t=this.root;return t==null?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&this.splay(t)==0}defaultCompare(){return(t,n)=>t<n?-1:t>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}}var vU;const rm=class rm extends RV{constructor(n,c){super();Er(this,"root",null);Er(this,"compare");Er(this,"validKey");Er(this,vU,"[object Set]");this.compare=n??this.defaultCompare(),this.validKey=c??(g=>g!=null&&g!=null)}delete(n){return this.validKey(n)?this._delete(n)!=null:!1}deleteAll(n){for(const c of n)this.delete(c)}forEach(n){const c=this[Symbol.iterator]();let g;for(;g=c.next(),!g.done;)n(g.value,g.value,this)}add(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new Jm(n),c),this}addAndReturn(n){const c=this.splay(n);return c!=0&&this.addNewRoot(new Jm(n),c),this.root.key}addAll(n){for(const c of n)this.add(c)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)<0)return this.root.key;let g=this.root.left;if(g==null)return null;let b=g.right;for(;b!=null;)g=b,b=g.right;return g.key}firstAfter(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)>0)return this.root.key;let g=this.root.right;if(g==null)return null;let b=g.left;for(;b!=null;)g=b,b=g.left;return g.key}retainAll(n){const c=new rm(this.compare,this.validKey),g=this.modificationCount;for(const b of n){if(g!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(b)&&this.splay(b)==0&&c.add(this.root.key)}c.size!=this.size&&(this.root=c.root,this.size=c.size,this.modificationCount++)}lookup(n){return!this.validKey(n)||this.splay(n)!=0?null:this.root.key}intersection(n){const c=new rm(this.compare,this.validKey);for(const g of this)n.has(g)&&c.add(g);return c}difference(n){const c=new rm(this.compare,this.validKey);for(const g of this)n.has(g)||c.add(g);return c}union(n){const c=this.clone();return c.addAll(n),c}clone(){const n=new rm(this.compare,this.validKey);return n.size=this.size,n.root=this.copyNode(this.root),n}copyNode(n){if(n==null)return null;function c(b,E){let a,U;do{if(a=b.left,U=b.right,a!=null){const W=new Jm(a.key);E.left=W,c(a,W)}if(U!=null){const W=new Jm(U.key);E.right=W,b=U,E=W}}while(U!=null)}const g=new Jm(n.key);return c(n,g),g}toSet(){return this.clone()}entries(){return new OV(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new FV(this.wrap())}};vU=Symbol.toStringTag;let xm=rm;class M5{constructor(t){Er(this,"tree");Er(this,"path",new Array);Er(this,"modificationCount",null);Er(this,"splayCount");this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;t!=null;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let c=this.tree.getRoot();for(;c!=null;)this.path.push(c),c=c.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],n=t.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}}class FV extends M5{getValue(t){return t.key}}class OV extends M5{getValue(t){return[t.key,t.key]}}const NV=e=>e,VV=e=>{if(e){const t=new xm(Iv(e)),n=new xm(Iv(e)),c=(b,E)=>E.addAndReturn(b),g=b=>({x:c(b.x,t),y:c(b.y,n)});return g({x:new XA(0),y:new XA(0)}),g}return NV},Ev=e=>({set:t=>{n0=Ev(t)},reset:()=>Ev(e),compare:Iv(e),snap:VV(e),orient:LV(e)});let n0=Ev();const eg=(e,t)=>e.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(e.ur.y),Cv=(e,t)=>{if(t.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(t.ll.y))return null;const n=e.ll.x.isLessThan(t.ll.x)?t.ll.x:e.ll.x,c=e.ur.x.isLessThan(t.ur.x)?e.ur.x:t.ur.x,g=e.ll.y.isLessThan(t.ll.y)?t.ll.y:e.ll.y,b=e.ur.y.isLessThan(t.ur.y)?e.ur.y:t.ur.y;return{ll:{x:n,y:g},ur:{x:c,y:b}}},h_=(e,t)=>e.x.times(t.y).minus(e.y.times(t.x)),P5=(e,t)=>e.x.times(t.x).plus(e.y.times(t.y)),Q_=e=>P5(e,e).sqrt(),UV=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return h_(g,c).div(Q_(g)).div(Q_(c))},GV=(e,t,n)=>{const c={x:t.x.minus(e.x),y:t.y.minus(e.y)},g={x:n.x.minus(e.x),y:n.y.minus(e.y)};return P5(g,c).div(Q_(g)).div(Q_(c))},Tw=(e,t,n)=>t.y.isZero()?null:{x:e.x.plus(t.x.div(t.y).times(n.minus(e.y))),y:n},kw=(e,t,n)=>t.x.isZero()?null:{x:n,y:e.y.plus(t.y.div(t.x).times(n.minus(e.x)))},qV=(e,t,n,c)=>{if(t.x.isZero())return kw(n,c,e.x);if(c.x.isZero())return kw(e,t,n.x);if(t.y.isZero())return Tw(n,c,e.y);if(c.y.isZero())return Tw(e,t,n.y);const g=h_(t,c);if(g.isZero())return null;const b={x:n.x.minus(e.x),y:n.y.minus(e.y)},E=h_(b,t).div(g),a=h_(b,c).div(g),U=e.x.plus(a.times(t.x)),W=n.x.plus(E.times(c.x)),ce=e.y.plus(a.times(t.y)),oe=n.y.plus(E.times(c.y)),fe=U.plus(W).div(2),we=ce.plus(oe).div(2);return{x:fe,y:we}};class Rh{constructor(t,n){Er(this,"point");Er(this,"isLeft");Er(this,"segment");Er(this,"otherSE");Er(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=n}static compare(t,n){const c=Rh.comparePoints(t.point,n.point);return c!==0?c:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:F0.compare(t.segment,n.segment))}static comparePoints(t,n){return t.x.isLessThan(n.x)?-1:t.x.isGreaterThan(n.x)?1:t.y.isLessThan(n.y)?-1:t.y.isGreaterThan(n.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const n=t.point.events;for(let c=0,g=n.length;c<g;c++){const b=n[c];this.point.events.push(b),b.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let n=0;n<t;n++){const c=this.point.events[n];if(c.segment.consumedBy===void 0)for(let g=n+1;g<t;g++){const b=this.point.events[g];b.consumedBy===void 0&&c.otherSE.point.events===b.otherSE.point.events&&c.segment.consume(b.segment)}}}getAvailableLinkedEvents(){const t=[];for(let n=0,c=this.point.events.length;n<c;n++){const g=this.point.events[n];g!==this&&!g.segment.ringOut&&g.segment.isInResult()&&t.push(g)}return t}getLeftmostComparator(t){const n=new Map,c=g=>{const b=g.otherSE;n.set(g,{sine:UV(this.point,t.point,b.point),cosine:GV(this.point,t.point,b.point)})};return(g,b)=>{n.has(g)||c(g),n.has(b)||c(b);const{sine:E,cosine:a}=n.get(g),{sine:U,cosine:W}=n.get(b);return E.isGreaterThanOrEqualTo(0)&&U.isGreaterThanOrEqualTo(0)?a.isLessThan(W)?1:a.isGreaterThan(W)?-1:0:E.isLessThan(0)&&U.isLessThan(0)?a.isLessThan(W)?-1:a.isGreaterThan(W)?1:0:U.isLessThan(E)?-1:U.isGreaterThan(E)?1:0}}}let HV=0;class F0{constructor(t,n,c,g){Er(this,"id");Er(this,"leftSE");Er(this,"rightSE");Er(this,"rings");Er(this,"windings");Er(this,"ringOut");Er(this,"consumedBy");Er(this,"prev");Er(this,"_prevInResult");Er(this,"_beforeState");Er(this,"_afterState");Er(this,"_isInResult");this.id=++HV,this.leftSE=t,t.segment=this,t.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=t,this.rings=c,this.windings=g}static compare(t,n){const c=t.leftSE.point.x,g=n.leftSE.point.x,b=t.rightSE.point.x,E=n.rightSE.point.x;if(E.isLessThan(c))return 1;if(b.isLessThan(g))return-1;const a=t.leftSE.point.y,U=n.leftSE.point.y,W=t.rightSE.point.y,ce=n.rightSE.point.y;if(c.isLessThan(g)){if(U.isLessThan(a)&&U.isLessThan(W))return 1;if(U.isGreaterThan(a)&&U.isGreaterThan(W))return-1;const oe=t.comparePoint(n.leftSE.point);if(oe<0)return 1;if(oe>0)return-1;const fe=n.comparePoint(t.rightSE.point);return fe!==0?fe:-1}if(c.isGreaterThan(g)){if(a.isLessThan(U)&&a.isLessThan(ce))return-1;if(a.isGreaterThan(U)&&a.isGreaterThan(ce))return 1;const oe=n.comparePoint(t.leftSE.point);if(oe!==0)return oe;const fe=t.comparePoint(n.rightSE.point);return fe<0?1:fe>0?-1:1}if(a.isLessThan(U))return-1;if(a.isGreaterThan(U))return 1;if(b.isLessThan(E)){const oe=n.comparePoint(t.rightSE.point);if(oe!==0)return oe}if(b.isGreaterThan(E)){const oe=t.comparePoint(n.rightSE.point);if(oe<0)return 1;if(oe>0)return-1}if(!b.eq(E)){const oe=W.minus(a),fe=b.minus(c),we=ce.minus(U),et=E.minus(g);if(oe.isGreaterThan(fe)&&we.isLessThan(et))return 1;if(oe.isLessThan(fe)&&we.isGreaterThan(et))return-1}return b.isGreaterThan(E)?1:b.isLessThan(E)||W.isLessThan(ce)?-1:W.isGreaterThan(ce)?1:t.id<n.id?-1:t.id>n.id?1:0}static fromRing(t,n,c){let g,b,E;const a=Rh.comparePoints(t,n);if(a<0)g=t,b=n,E=1;else if(a>0)g=n,b=t,E=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const U=new Rh(g,!0),W=new Rh(b,!1);return new F0(U,W,[c],[E])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(n)?t:n},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(n)?t:n}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return n0.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const n=this.bbox(),c=t.bbox(),g=Cv(n,c);if(g===null)return null;const b=this.leftSE.point,E=this.rightSE.point,a=t.leftSE.point,U=t.rightSE.point,W=eg(n,a)&&this.comparePoint(a)===0,ce=eg(c,b)&&t.comparePoint(b)===0,oe=eg(n,U)&&this.comparePoint(U)===0,fe=eg(c,E)&&t.comparePoint(E)===0;if(ce&&W)return fe&&!oe?E:!fe&&oe?U:null;if(ce)return oe&&b.x.eq(U.x)&&b.y.eq(U.y)?null:b;if(W)return fe&&E.x.eq(a.x)&&E.y.eq(a.y)?null:a;if(fe&&oe)return null;if(fe)return E;if(oe)return U;const we=qV(b,this.vector(),a,t.vector());return we===null||!eg(g,we)?null:n0.snap(we)}split(t){const n=[],c=t.events!==void 0,g=new Rh(t,!0),b=new Rh(t,!1),E=this.rightSE;this.replaceRightSE(b),n.push(b),n.push(g);const a=new F0(g,E,this.rings.slice(),this.windings.slice());return Rh.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Rh.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(g.checkForConsuming(),b.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,c=this.windings.length;n<c;n++)this.windings[n]*=-1}consume(t){let n=this,c=t;for(;n.consumedBy;)n=n.consumedBy;for(;c.consumedBy;)c=c.consumedBy;const g=F0.compare(n,c);if(g!==0){if(g>0){const b=n;n=c,c=b}if(n.prev===c){const b=n;n=c,c=b}for(let b=0,E=c.rings.length;b<E;b++){const a=c.rings[b],U=c.windings[b],W=n.rings.indexOf(a);W===-1?(n.rings.push(a),n.windings.push(U)):n.windings[W]+=U}c.rings=null,c.windings=null,c.consumedBy=n,c.leftSE.consumedBy=n.leftSE,c.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,c=this._afterState.windings,g=this._afterState.multiPolys;for(let a=0,U=this.rings.length;a<U;a++){const W=this.rings[a],ce=this.windings[a],oe=n.indexOf(W);oe===-1?(n.push(W),c.push(ce)):c[oe]+=ce}const b=[],E=[];for(let a=0,U=n.length;a<U;a++){if(c[a]===0)continue;const W=n[a],ce=W.poly;if(E.indexOf(ce)===-1)if(W.isExterior)b.push(ce);else{E.indexOf(ce)===-1&&E.push(ce);const oe=b.indexOf(W.poly);oe!==-1&&b.splice(oe,1)}}for(let a=0,U=b.length;a<U;a++){const W=b[a].multiPoly;g.indexOf(W)===-1&&g.push(W)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Tv.type){case"union":{const c=t.length===0,g=n.length===0;this._isInResult=c!==g;break}case"intersection":{let c,g;t.length<n.length?(c=t.length,g=n.length):(c=n.length,g=t.length),this._isInResult=g===Tv.numMultiPolys&&c<g;break}case"xor":{const c=Math.abs(t.length-n.length);this._isInResult=c%2===1;break}case"difference":{const c=g=>g.length===1&&g[0].isSubject;this._isInResult=c(t)!==c(n);break}}return this._isInResult}}class Mw{constructor(t,n,c){Er(this,"poly");Er(this,"isExterior");Er(this,"segments");Er(this,"bbox");if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=c,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const g=n0.snap({x:new XA(t[0][0]),y:new XA(t[0][1])});this.bbox={ll:{x:g.x,y:g.y},ur:{x:g.x,y:g.y}};let b=g;for(let E=1,a=t.length;E<a;E++){if(typeof t[E][0]!="number"||typeof t[E][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const U=n0.snap({x:new XA(t[E][0]),y:new XA(t[E][1])});U.x.eq(b.x)&&U.y.eq(b.y)||(this.segments.push(F0.fromRing(b,U,this)),U.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=U.x),U.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=U.y),U.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=U.x),U.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=U.y),b=U)}(!g.x.eq(b.x)||!g.y.eq(b.y))&&this.segments.push(F0.fromRing(b,g,this))}getSweepEvents(){const t=[];for(let n=0,c=this.segments.length;n<c;n++){const g=this.segments[n];t.push(g.leftSE),t.push(g.rightSE)}return t}}class jV{constructor(t,n){Er(this,"multiPoly");Er(this,"exteriorRing");Er(this,"interiorRings");Er(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Mw(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let c=1,g=t.length;c<g;c++){const b=new Mw(t[c],this,!1);b.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=b.bbox.ll.x),b.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=b.bbox.ll.y),b.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=b.bbox.ur.x),b.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=b.bbox.ur.y),this.interiorRings.push(b)}this.multiPoly=n}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getSweepEvents();for(let b=0,E=g.length;b<E;b++)t.push(g[b])}return t}}class Pw{constructor(t,n){Er(this,"isSubject");Er(this,"polys");Er(this,"bbox");if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:new XA(Number.POSITIVE_INFINITY),y:new XA(Number.POSITIVE_INFINITY)},ur:{x:new XA(Number.NEGATIVE_INFINITY),y:new XA(Number.NEGATIVE_INFINITY)}};for(let c=0,g=t.length;c<g;c++){const b=new jV(t[c],this);b.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=b.bbox.ll.x),b.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=b.bbox.ll.y),b.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=b.bbox.ur.x),b.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=b.bbox.ur.y),this.polys.push(b)}this.isSubject=n}getSweepEvents(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getSweepEvents();for(let b=0,E=g.length;b<E;b++)t.push(g[b])}return t}}class W_{constructor(t){Er(this,"events");Er(this,"poly");Er(this,"_isExteriorRing");Er(this,"_enclosingRing");this.events=t;for(let n=0,c=t.length;n<c;n++)t[n].segment.ringOut=this;this.poly=null}static factory(t){const n=[];for(let c=0,g=t.length;c<g;c++){const b=t[c];if(!b.isInResult()||b.ringOut)continue;let E=null,a=b.leftSE,U=b.rightSE;const W=[a],ce=a.point,oe=[];for(;E=a,a=U,W.push(a),a.point!==ce;)for(;;){const fe=a.getAvailableLinkedEvents();if(fe.length===0){const lt=W[0].point,Ke=W[W.length-1].point;throw new Error(`Unable to complete output ring starting at [${lt.x}, ${lt.y}]. Last matching segment found ends at [${Ke.x}, ${Ke.y}].`)}if(fe.length===1){U=fe[0].otherSE;break}let we=null;for(let lt=0,Ke=oe.length;lt<Ke;lt++)if(oe[lt].point===a.point){we=lt;break}if(we!==null){const lt=oe.splice(we)[0],Ke=W.splice(lt.index);Ke.unshift(Ke[0].otherSE),n.push(new W_(Ke.reverse()));continue}oe.push({index:W.length,point:a.point});const et=a.getLeftmostComparator(E);U=fe.sort(et)[0].otherSE;break}n.push(new W_(W))}return n}getGeom(){let t=this.events[0].point;const n=[t];for(let W=1,ce=this.events.length-1;W<ce;W++){const oe=this.events[W].point,fe=this.events[W+1].point;n0.orient(oe,t,fe)!==0&&(n.push(oe),t=oe)}if(n.length===1)return null;const c=n[0],g=n[1];n0.orient(c,t,g)===0&&n.shift(),n.push(n[0]);const b=this.isExteriorRing()?1:-1,E=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,U=[];for(let W=E;W!=a;W+=b)U.push([n[W].x.toNumber(),n[W].y.toNumber()]);return U}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var g,b;let t=this.events[0];for(let E=1,a=this.events.length;E<a;E++){const U=this.events[E];Rh.compare(t,U)>0&&(t=U)}let n=t.segment.prevInResult(),c=n?n.prevInResult():null;for(;;){if(!n)return null;if(!c)return n.ringOut;if(c.ringOut!==n.ringOut)return((g=c.ringOut)==null?void 0:g.enclosingRing())!==n.ringOut?n.ringOut:(b=n.ringOut)==null?void 0:b.enclosingRing();n=c.prevInResult(),c=n?n.prevInResult():null}}}class Dw{constructor(t){Er(this,"exteriorRing");Er(this,"interiorRings");this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let n=0,c=this.interiorRings.length;n<c;n++){const g=this.interiorRings[n].getGeom();g!==null&&t.push(g)}return t}}class ZV{constructor(t){Er(this,"rings");Er(this,"polys");this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let n=0,c=this.polys.length;n<c;n++){const g=this.polys[n].getGeom();g!==null&&t.push(g)}return t}_composePolys(t){var c;const n=[];for(let g=0,b=t.length;g<b;g++){const E=t[g];if(!E.poly)if(E.isExteriorRing())n.push(new Dw(E));else{const a=E.enclosingRing();a!=null&&a.poly||n.push(new Dw(a)),(c=a==null?void 0:a.poly)==null||c.addInterior(E)}}return n}}class QV{constructor(t,n=F0.compare){Er(this,"queue");Er(this,"tree");Er(this,"segments");this.queue=t,this.tree=new xm(n),this.segments=[]}process(t){const n=t.segment,c=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(n),c;t.isLeft&&this.tree.add(n);let g=n,b=n;do g=this.tree.lastBefore(g);while(g!=null&&g.consumedBy!=null);do b=this.tree.firstAfter(b);while(b!=null&&b.consumedBy!=null);if(t.isLeft){let E=null;if(g){const U=g.getIntersection(n);if(U!==null&&(n.isAnEndpoint(U)||(E=U),!g.isAnEndpoint(U))){const W=this._splitSafely(g,U);for(let ce=0,oe=W.length;ce<oe;ce++)c.push(W[ce])}}let a=null;if(b){const U=b.getIntersection(n);if(U!==null&&(n.isAnEndpoint(U)||(a=U),!b.isAnEndpoint(U))){const W=this._splitSafely(b,U);for(let ce=0,oe=W.length;ce<oe;ce++)c.push(W[ce])}}if(E!==null||a!==null){let U=null;E===null?U=a:a===null?U=E:U=Rh.comparePoints(E,a)<=0?E:a,this.queue.delete(n.rightSE),c.push(n.rightSE);const W=n.split(U);for(let ce=0,oe=W.length;ce<oe;ce++)c.push(W[ce])}c.length>0?(this.tree.delete(n),c.push(t)):(this.segments.push(n),n.prev=g)}else{if(g&&b){const E=g.getIntersection(b);if(E!==null){if(!g.isAnEndpoint(E)){const a=this._splitSafely(g,E);for(let U=0,W=a.length;U<W;U++)c.push(a[U])}if(!b.isAnEndpoint(E)){const a=this._splitSafely(b,E);for(let U=0,W=a.length;U<W;U++)c.push(a[U])}}}this.tree.delete(n)}return c}_splitSafely(t,n){this.tree.delete(t);const c=t.rightSE;this.queue.delete(c);const g=t.split(n);return g.push(c),t.consumedBy===void 0&&this.tree.add(t),g}}class WV{constructor(){Er(this,"type");Er(this,"numMultiPolys")}run(t,n,c){lg.type=t;const g=[new Pw(n,!0)];for(let ce=0,oe=c.length;ce<oe;ce++)g.push(new Pw(c[ce],!1));if(lg.numMultiPolys=g.length,lg.type==="difference"){const ce=g[0];let oe=1;for(;oe<g.length;)Cv(g[oe].bbox,ce.bbox)!==null?oe++:g.splice(oe,1)}if(lg.type==="intersection")for(let ce=0,oe=g.length;ce<oe;ce++){const fe=g[ce];for(let we=ce+1,et=g.length;we<et;we++)if(Cv(fe.bbox,g[we].bbox)===null)return[]}const b=new xm(Rh.compare);for(let ce=0,oe=g.length;ce<oe;ce++){const fe=g[ce].getSweepEvents();for(let we=0,et=fe.length;we<et;we++)b.add(fe[we])}const E=new QV(b);let a=null;for(b.size!=0&&(a=b.first(),b.delete(a));a;){const ce=E.process(a);for(let oe=0,fe=ce.length;oe<fe;oe++){const we=ce[oe];we.consumedBy===void 0&&b.add(we)}b.size!=0?(a=b.first(),b.delete(a)):a=null}n0.reset();const U=W_.factory(E.segments);return new ZV(U).getGeom()}}const lg=new WV,Tv=lg,XV=(e,...t)=>Tv.run("intersection",e,t);n0.set;var YV={exports:{}},hy,Lw;function $V(){return Lw||(Lw=1,hy=function(t){return function n(c){return arguments.length===0||c!=null&&c["@@functional/placeholder"]===!0?n:t.apply(this,arguments)}}),hy}var Ay,Bw;function KV(){if(Bw)return Ay;Bw=1;var e=$V();return Ay=e(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),Ay}var fy,zw;function T2(){if(zw)return fy;zw=1;function e(t){var n=typeof t;return!!t&&(n=="object"||n=="function")}return fy=e,fy}var dy,Rw;function JV(){if(Rw)return dy;Rw=1;var e=T2();function t(n){return e(n)?n:Object(n)}return dy=t,dy}var py,Fw;function eU(){if(Fw)return py;Fw=1;var e=JV();function t(n){return function(c,g,b){for(var E=e(c),a=b(c),U=a.length,W=n?U:-1;n?W--:++W<U;){var ce=a[W];if(g(E[ce],ce,E)===!1)break}return c}}return py=t,py}var my,Ow;function tU(){if(Ow)return my;Ow=1;var e=eU(),t=e();return my=t,my}var gy,Nw;function iU(){if(Nw)return gy;Nw=1;function e(t){return function(n){return n==null?void 0:n[t]}}return gy=e,gy}var _y,Vw;function nU(){if(Vw)return _y;Vw=1;var e=iU(),t=e("length");return _y=t,_y}var yy,Uw;function k2(){if(Uw)return yy;Uw=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return yy=t,yy}var vy,Gw;function rU(){if(Gw)return vy;Gw=1;var e=nU(),t=k2();function n(c){return c!=null&&t(e(c))}return vy=n,vy}var xy,qw;function _1(){if(qw)return xy;qw=1;function e(t){return!!t&&typeof t=="object"}return xy=e,xy}var by,Hw;function D5(){if(Hw)return by;Hw=1;var e=rU(),t=_1(),n=Object.prototype,c=n.hasOwnProperty,g=n.propertyIsEnumerable;function b(E){return t(E)&&e(E)&&c.call(E,"callee")&&!g.call(E,"callee")}return by=b,by}var wy,jw;function sU(){if(jw)return wy;jw=1;var e=T2(),t="[object Function]",n=Object.prototype,c=n.toString;function g(b){return e(b)&&c.call(b)==t}return wy=g,wy}var Sy,Zw;function aU(){if(Zw)return Sy;Zw=1;var e=sU(),t=_1(),n=/^\[object .+?Constructor\]$/,c=Object.prototype,g=Function.prototype.toString,b=c.hasOwnProperty,E=RegExp("^"+g.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function a(U){return U==null?!1:e(U)?E.test(g.call(U)):t(U)&&n.test(U)}return Sy=a,Sy}var Iy,Qw;function oU(){if(Qw)return Iy;Qw=1;var e=aU();function t(n,c){var g=n==null?void 0:n[c];return e(g)?g:void 0}return Iy=t,Iy}var Ey,Ww;function lU(){if(Ww)return Ey;Ww=1;var e=oU(),t=k2(),n=_1(),c="[object Array]",g=Object.prototype,b=g.toString,E=e(Array,"isArray"),a=E||function(U){return n(U)&&t(U.length)&&b.call(U)==c};return Ey=a,Ey}var Cy,Xw;function uU(){if(Xw)return Cy;Xw=1;var e=/^\d+$/,t=9007199254740991;function n(c,g){return c=typeof c=="number"||e.test(c)?+c:-1,g=g??t,c>-1&&c%1==0&&c<g}return Cy=n,Cy}var Ty,Yw;function cU(){if(Yw)return Ty;Yw=1;var e=D5(),t=lU(),n=uU(),c=k2(),g=T2(),b=Object.prototype,E=b.hasOwnProperty;function a(U){if(U==null)return[];g(U)||(U=Object(U));var W=U.length;W=W&&c(W)&&(t(U)||e(U))&&W||0;for(var ce=U.constructor,oe=-1,fe=typeof ce=="function"&&ce.prototype===U,we=Array(W),et=W>0;++oe<W;)we[oe]=oe+"";for(var lt in U)!(et&&n(lt,W))&&!(lt=="constructor"&&(fe||!E.call(U,lt)))&&we.push(lt);return we}return Ty=a,Ty}var ky,$w;function hU(){if($w)return ky;$w=1;var e=tU(),t=cU();function n(c,g){return e(c,g,t)}return ky=n,ky}var My,Kw;function AU(){if(Kw)return My;Kw=1;var e=hU(),t=D5(),n=_1(),c="[object Object]",g=Object.prototype,b=g.hasOwnProperty,E=g.toString;function a(U){var W;if(!(n(U)&&E.call(U)==c&&!t(U))||!b.call(U,"constructor")&&(W=U.constructor,typeof W=="function"&&!(W instanceof W)))return!1;var ce;return e(U,function(oe,fe){ce=fe}),ce===void 0||b.call(U,ce)}return My=a,My}(function(e){e.exports=function(t){var n={};function c(g){if(n[g])return n[g].exports;var b=n[g]={exports:{},id:g,loaded:!1};return t[g].call(b.exports,b,b.exports,c),b.loaded=!0,b.exports}return c.m=t,c.c=n,c.p="/lib/",c(0)}([function(t,n,c){t.exports=c(1)},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.union=c(2).default,n.any=c(12).default,n.nil=c(14).default,n.mapOf=c(16).default,n.arrayOf=c(18).default,n.record=c(20).default,n.optional=c(23).default,n.validate=c(25).default,n.deferred=c(26).default,n.createValidator=c(4).default,n.isValid=c(28).default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(3),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(){for(var U=arguments.length,W=Array(U),ce=0;ce<U;ce++)W[ce]=arguments[ce];return new b.default(W)}},function(t,n,c){var g=function(){function ce(oe,fe){for(var we=0;we<fe.length;we++){var et=fe[we];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty(oe,et.key,et)}}return function(oe,fe,we){return fe&&ce(oe.prototype,fe),we&&ce(oe,we),oe}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(4),E=a(b);c(5),c(6);function a(ce){return ce&&ce.__esModule?ce:{default:ce}}function U(ce,oe){if(!(ce instanceof oe))throw new TypeError("Cannot call a class as a function")}var W=function(){function ce(oe){U(this,ce),this.validators=[];var fe=!0,we=!1,et=void 0;try{for(var lt=oe[Symbol.iterator](),Ke;!(fe=(Ke=lt.next()).done);fe=!0){var st=Ke.value;this.validators.push((0,E.default)(st))}}catch(ut){we=!0,et=ut}finally{try{!fe&&lt.return&&lt.return()}finally{if(we)throw et}}}return g(ce,[{key:"isValid",value:function(fe){var we=!0,et=!1,lt=void 0;try{for(var Ke=this.validators[Symbol.iterator](),st;!(we=(st=Ke.next()).done);we=!0){var ut=st.value;if(ut.isValid(fe))return!0}}catch(kt){et=!0,lt=kt}finally{try{!we&&Ke.return&&Ke.return()}finally{if(et)throw lt}}return!1}},{key:"getValidationResult",value:function(fe){if(this.isValid(fe))return{isValid:"true"};var we=this._getValidationDetails(fe);return{isValid:"false",message:`Value doesn't match any of the expected variants.
Value: `+JSON.stringify(fe)+`
Details: 
`+we.message,score:we.score}}},{key:"_getValidationDetails",value:function(fe){var we=[],et=!0,lt=!1,Ke=void 0;try{for(var st=this.validators[Symbol.iterator](),ut;!(et=(ut=st.next()).done);et=!0){var kt=ut.value;we.push(kt.getValidationResult(fe))}}catch(Rt){lt=!0,Ke=Rt}finally{try{!et&&st.return&&st.return()}finally{if(lt)throw Ke}}we.sort(function(Rt,Ge){return Rt.score<Ge.score?1:Rt.score>Ge.score?-1:0}),we.length>3&&(we.length=3);var Bt=we.map(function(Rt){return Rt.message}).join(`
`);return{message:Bt,score:we[0].score}}}]),ce}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=lt,c(5);var g=c(7),b=we(g),E=c(9),a=we(E),U=c(10),W=we(U),ce=c(3);we(ce);var oe=c(11),fe=we(oe);function we(Ke){return Ke&&Ke.__esModule?Ke:{default:Ke}}function et(Ke){return Ke&&typeof Symbol<"u"&&Ke.constructor===Symbol?"symbol":typeof Ke}function lt(Ke){if(Ke==null)throw Error("Null cannot be a valid validation descriptor");if(Ke===String)return b.default;if(Ke===Number)return a.default;if(Ke===Boolean)return W.default;if((typeof Ke>"u"?"undefined":et(Ke))==="object"&&Ke&&typeof Ke.isValid=="function"&&typeof Ke.getValidationResult=="function")return Ke;if(typeof Ke=="string"||typeof Ke=="number"||typeof Ke=="boolean")return new fe.default(Ke);throw new Error("Can't recognize this descriptor: "+Ke)}},function(t,n,c){c(6)},function(t,n){},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=E(g);c(6),c(5);function E(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return typeof W=="string"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"String expected, "+(0,b.default)(W)+" given.",score:0}}};n.default=a},function(t,n){t.exports=KV()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=E(g);c(6),c(5);function E(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return typeof W=="number"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Number expected. '"+(0,b.default)(W)+"' given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=E(g);c(6),c(5);function E(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return typeof W=="boolean"},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Boolean expected. "+(0,b.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){var g=function(){function W(ce,oe){for(var fe=0;fe<oe.length;fe++){var we=oe[fe];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(ce,we.key,we)}}return function(ce,oe,fe){return oe&&W(ce.prototype,oe),fe&&W(ce,fe),ce}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(4);E(b),c(5),c(6);function E(W){return W&&W.__esModule?W:{default:W}}function a(W,ce){if(!(W instanceof ce))throw new TypeError("Cannot call a class as a function")}var U=function(){function W(ce){a(this,W),this.expectedValue=ce}return g(W,[{key:"isValid",value:function(oe){return oe===this.expectedValue}},{key:"getValidationResult",value:function(oe){return this.isValid(oe)?{isValid:"true"}:{isValid:"false",message:"Expected: "+JSON.stringify(this.expectedValue)+". Given: "+oe,score:0}}}]),W}();n.default=U},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(13),b=E(g);function E(a){return a&&a.__esModule?a:{default:a}}n.default=b.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8);b(g),c(6),c(5);function b(a){return a&&a.__esModule?a:{default:a}}var E={isValid:function(U){return!0},getValidationResult:function(U){return{isValid:"true"}}};n.default=E},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(15),b=E(g);function E(a){return a&&a.__esModule?a:{default:a}}n.default=b.default},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0});var g=c(8),b=E(g);c(6),c(5);function E(U){return U&&U.__esModule?U:{default:U}}var a={isValid:function(W){return W==null},getValidationResult:function(W){return a.isValid(W)?{isValid:"true"}:{isValid:"false",message:"Null expected. "+(0,b.default)(W)+" given.",score:0}}};n.default=a},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(17),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(U){return new b.default(U)}},function(t,n,c){var g=function(){function we(et,lt){for(var Ke=0;Ke<lt.length;Ke++){var st=lt[Ke];st.enumerable=st.enumerable||!1,st.configurable=!0,"value"in st&&(st.writable=!0),Object.defineProperty(et,st.key,st)}}return function(et,lt,Ke){return lt&&we(et.prototype,lt),Ke&&we(et,Ke),et}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),E=W(b),a=c(4),U=W(a);c(6),c(5);function W(we){return we&&we.__esModule?we:{default:we}}function ce(we,et){if(!(we instanceof et))throw new TypeError("Cannot call a class as a function")}function oe(we){return we&&typeof Symbol<"u"&&we.constructor===Symbol?"symbol":typeof we}var fe=function(){function we(et){ce(this,we),this.validator=(0,U.default)(et)}return g(we,[{key:"isValid",value:function(lt){if(!((typeof lt>"u"?"undefined":oe(lt))==="object"&&lt))return!1;var Ke=Object.keys(lt),st=!0,ut=!1,kt=void 0;try{for(var Bt=Ke[Symbol.iterator](),Rt;!(st=(Rt=Bt.next()).done);st=!0){var Ge=Rt.value,ni=lt[Ge];if(this.validator.isValid(ni)===!1)return!1}}catch(it){ut=!0,kt=it}finally{try{!st&&Bt.return&&Bt.return()}finally{if(ut)throw kt}}return!0}},{key:"getValidationResult",value:function(lt){if(!((typeof lt>"u"?"undefined":oe(lt))==="object"&&lt))return{isValid:"false",message:"Object expected. "+(0,E.default)(lt)+" given.",score:0};var Ke=Object.keys(lt),st=!0,ut=!1,kt=void 0;try{for(var Bt=Ke[Symbol.iterator](),Rt;!(st=(Rt=Bt.next()).done);st=!0){var Ge=Rt.value,ni=lt[Ge],it=this.validator.getValidationResult(ni);if(it.isValid==="false")return{isValid:"false",message:"Validation failed for key '"+Ge+"': "+it.message,score:1}}}catch(xt){ut=!0,kt=xt}finally{try{!st&&Bt.return&&Bt.return()}finally{if(ut)throw kt}}return{isValid:"true"}}}]),we}();n.default=fe},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(19),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(U){return new b.default(U)}},function(t,n,c){var g=function(){function fe(we,et){for(var lt=0;lt<et.length;lt++){var Ke=et[lt];Ke.enumerable=Ke.enumerable||!1,Ke.configurable=!0,"value"in Ke&&(Ke.writable=!0),Object.defineProperty(we,Ke.key,Ke)}}return function(we,et,lt){return et&&fe(we.prototype,et),lt&&fe(we,lt),we}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),E=W(b),a=c(4),U=W(a);c(6),c(5);function W(fe){return fe&&fe.__esModule?fe:{default:fe}}function ce(fe,we){if(!(fe instanceof we))throw new TypeError("Cannot call a class as a function")}var oe=function(){function fe(we){ce(this,fe),this.validator=(0,U.default)(we)}return g(fe,[{key:"isValid",value:function(et){if(!Array.isArray(et))return!1;var lt=!0,Ke=!1,st=void 0;try{for(var ut=et[Symbol.iterator](),kt;!(lt=(kt=ut.next()).done);lt=!0){var Bt=kt.value;if(this.validator.isValid(Bt)===!1)return!1}}catch(Rt){Ke=!0,st=Rt}finally{try{!lt&&ut.return&&ut.return()}finally{if(Ke)throw st}}return!0}},{key:"getValidationResult",value:function(et){if(!Array.isArray(et))return{isValid:"false",message:"Array expected. "+(0,E.default)(et)+" given.",score:0};for(var lt=0;lt<et.length;lt++){var Ke=et[lt],st=this.validator.getValidationResult(Ke);if(st.isValid==="false")return{isValid:"false",message:"Validation failed on item #"+lt+": "+st.message,score:1}}return{isValid:"true"}}}]),fe}();n.default=oe},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(21),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(U){return new b.default(U)}},function(t,n,c){var g=function(){function lt(Ke,st){for(var ut=0;ut<st.length;ut++){var kt=st[ut];kt.enumerable=kt.enumerable||!1,kt.configurable=!0,"value"in kt&&(kt.writable=!0),Object.defineProperty(Ke,kt.key,kt)}}return function(Ke,st,ut){return st&&lt(Ke.prototype,st),ut&&lt(Ke,ut),Ke}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),E=oe(b),a=c(22),U=oe(a),W=c(4),ce=oe(W);c(5),c(6);function oe(lt){return lt&&lt.__esModule?lt:{default:lt}}function fe(lt,Ke){if(!(lt instanceof Ke))throw new TypeError("Cannot call a class as a function")}function we(lt){return lt&&typeof Symbol<"u"&&lt.constructor===Symbol?"symbol":typeof lt}var et=function(){function lt(Ke){if(fe(this,lt),!((typeof Ke>"u"?"undefined":we(Ke))==="object"&&Ke&&(0,U.default)(Ke)))throw Error("A record must be defined by an object.");this.shape={};var st=!0,ut=!1,kt=void 0;try{for(var Bt=Object.getOwnPropertyNames(Ke)[Symbol.iterator](),Rt;!(st=(Rt=Bt.next()).done);st=!0){var Ge=Rt.value;try{this.shape[Ge]=(0,ce.default)(Ke[Ge])}catch(xt){var ni=Ge,it=xt.stack;throw xt.originalStack?(it=xt.originalStack,ni+="."+xt.propertyName,xt.propertyName=ni):xt.originalStack=xt.stack,xt.stack="Error defining prop '"+ni+"': "+xt.originalStack,xt}}}catch(xt){ut=!0,kt=xt}finally{try{!st&&Bt.return&&Bt.return()}finally{if(ut)throw kt}}}return g(lt,[{key:"isValid",value:function(st){if(!((typeof st>"u"?"undefined":we(st))==="object"&&st))return!1;var ut=!0,kt=!1,Bt=void 0;try{for(var Rt=Object.keys(this.shape)[Symbol.iterator](),Ge;!(ut=(Ge=Rt.next()).done);ut=!0){var ni=Ge.value,it=this.shape[ni];if(it.isValid(st[ni])===!1)return!1}}catch(xt){kt=!0,Bt=xt}finally{try{!ut&&Rt.return&&Rt.return()}finally{if(kt)throw Bt}}return!0}},{key:"getValidationResult",value:function(st){if(!((typeof st>"u"?"undefined":we(st))==="object"&&st))return{isValid:"false",message:"Object expected, "+(0,E.default)(st)+" given.",score:0};var ut=0,kt=!0,Bt=!1,Rt=void 0;try{for(var Ge=Object.keys(this.shape)[Symbol.iterator](),ni;!(kt=(ni=Ge.next()).done);kt=!0){var it=ni.value,xt=this.shape[it],_t=xt.getValidationResult(st[it]);if(_t.isValid==="false")return{isValid:"false",message:"Error validating prop "+it+`:
 `+_t.message,score:1+ut};ut++}}catch(mt){Bt=!0,Rt=mt}finally{try{!kt&&Ge.return&&Ge.return()}finally{if(Bt)throw Rt}}return{isValid:"true"}}}]),lt}();n.default=et},function(t,n){t.exports=AU()},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(24),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(U){return new b.default(U)}},function(t,n,c){var g=function(){function ce(oe,fe){for(var we=0;we<fe.length;we++){var et=fe[we];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty(oe,et.key,et)}}return function(oe,fe,we){return fe&&ce(oe.prototype,fe),we&&ce(oe,we),oe}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(4),E=a(b);c(6),c(5);function a(ce){return ce&&ce.__esModule?ce:{default:ce}}function U(ce,oe){if(!(ce instanceof oe))throw new TypeError("Cannot call a class as a function")}var W=function(){function ce(oe){U(this,ce),this.validator=(0,E.default)(oe)}return g(ce,[{key:"isValid",value:function(fe){return fe?this.validator.isValid(fe):!0}},{key:"getValidationResult",value:function(fe){return fe?this.validator.getValidationResult(fe):{isValid:"true"}}}]),ce}();n.default=W},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(U,W){var ce=(0,b.default)(U),oe=ce.getValidationResult(W);if(oe.isValid==="false")throw Error(oe.message);return W}},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(27),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(U){return new b.default(U)}},function(t,n,c){var g=function(){function oe(fe,we){for(var et=0;et<we.length;et++){var lt=we[et];lt.enumerable=lt.enumerable||!1,lt.configurable=!0,"value"in lt&&(lt.writable=!0),Object.defineProperty(fe,lt.key,lt)}}return function(fe,we,et){return we&&oe(fe.prototype,we),et&&oe(fe,et),fe}}();Object.defineProperty(n,"__esModule",{value:!0});var b=c(8),E=U(b),a=c(4);U(a),c(6),c(5);function U(oe){return oe&&oe.__esModule?oe:{default:oe}}function W(oe,fe){if(!(oe instanceof fe))throw new TypeError("Cannot call a class as a function")}var ce=function(){function oe(fe){if(W(this,oe),typeof fe!="function")throw Error("Deferred validator only accepts a function. "+(0,E.default)(fe)+" given");this.deferredValidator=fe}return g(oe,[{key:"isValid",value:function(we){return this._getValidator().isValid(we)}},{key:"getValidationResult",value:function(we){return this._getValidator().getValidationResult(we)}},{key:"_getValidator",value:function(){return this.validator||(this.validator=this.deferredValidator()),this.validator}}]),oe}();n.default=ce},function(t,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var g=c(4),b=E(g);function E(U){return U&&U.__esModule?U:{default:U}}function a(U,W){var ce=(0,b.default)(U);return ce.isValid(W)}}])})(YV);function fU(e){let t,n,c,g=`<svg class="marker-svg" id="Layer_2" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70.46 62.88"><defs><style>.fill {
                fill: #000;
                stroke: solid 1px red;
            }
            .stroke {
                stroke: #fff;
            }
        </style></defs><g id="Layer_1-2" data-name="Layer 1"><g><path class="fill" d="m35.23,60.88c-1.81,0-3.43-.93-4.33-2.5L2.68,9.5c-.9-1.57-.9-3.44,0-5,.9-1.57,2.52-2.5,4.33-2.5h56.44c1.81,0,3.43.93,4.33,2.5.9,1.56.9,3.43,0,5l-28.22,48.88c-.9,1.57-2.52,2.5-4.33,2.5Z"></path><path d="m63.45,4c1.56,0,2.34,1.05,2.6,1.5.26.45.78,1.65,0,3l-28.22,48.88c-.78,1.35-2.08,1.5-2.6,1.5s-1.82-.15-2.6-1.5L4.41,8.5c-.78-1.35-.26-2.55,0-3,.26-.45,1.03-1.5,2.6-1.5h56.44m0-4H7.01C1.62,0-1.75,5.83.95,10.5l28.22,48.88c1.35,2.33,3.7,3.5,6.06,3.5s4.72-1.17,6.06-3.5l28.22-48.88c2.69-4.67-.67-10.5-6.06-10.5h0Z"></path></g></g></svg>`;return{c(){t=qn("div"),n=Or(),c=qn("div"),c.innerHTML=g,this.h()},l(b){t=Hn(b,"DIV",{id:!0,class:!0}),Tn(t).forEach(Ci),n=Nr(b),c=Hn(b,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),ec(c)!=="svelte-tytvfo"&&(c.innerHTML=g),this.h()},h(){Fi(t,"id","map"),Fi(t,"class","map"),Fi(c,"id","marker-template"),Fi(c,"class","hex-marker")},m(b,E){Zn(b,t,E),Zn(b,n,E),Zn(b,c,E)},p:lo,i:lo,o:lo,d(b){b&&(Ci(t),Ci(n),Ci(c))}}}let Jw=6;const dU=500;let pU=!1;function mU(e,t,n){let c;hm(e,R0,Ti=>n(14,c=Ti));const g=[-119.449444,37.166111];let{metric:b}=t,{colorScheme:E}=t,{selectionData:a}=t,{showCounties:U}=t,{showEcoregions:W}=t,{drawnPath:ce}=t,{clade:oe}=t,{clades:fe}=t,{finishBuilding:we}=t;const et=[-124.40971816218747,32.534154544948464,-114.13120909272375,42.009518182466415];let lt,Ke,st,ut=[-119.449444,37.166111],{built:kt}=t;function Bt(Ti){if(!c.getStyle)return;console.log(c.getStyle().layers);let yi=c.getStyle().layers.filter(hi=>{var Li;let Ei=(Li=hi.source)==null?void 0:Li.split("-");return Ei&&Ei[0]==="hexlayer"&&Ei[1]!==Ti});for(let hi of yi)c.setPaintProperty(hi.id,"fill-opacity",0)}async function Rt(Ti){if(!dt||!c.getLayer)return;if(Ti===null){c.getLayer("drawLayer")&&R0.removeLayer("drawnPolygon"),c.getSource("drawnPolygon")&&R0.removeSource("drawnPolygon");return}console.log(c.transform),console.log(Ti[0]),console.log(c.transform.pointLocation({x:10,y:10})),console.log(c.transform.pointLocation(Ti[0]));let yi=[];for(let gi of Ti){let mn=c.transform.pointLocation(gi);yi.push([mn.lat,mn.lng])}let hi=CV(yi,Jw),Ei=QN.h3SetToMultiPolygonFeature(hi);console.log(Ei),console.log(dt);let Li=DV(dt);console.log(Li),console.log(Ei.geometry),console.log(Li.features[0].geometry);let fn=XV(Ei.geometry.coordinates,Li.features[0].geometry.coordinates);console.log(fn);let _n={type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:fn}};try{c.removeLayer("drawLayer"),c.removeSource("drawnPolygon")}catch(gi){console.log(gi)}c.addSource("drawnPolygon",{type:"geojson",data:_n}),c.addLayer({id:"drawLayer",type:"fill",source:"drawnPolygon",layout:{},paint:{"fill-color":"#00ffff","fill-opacity":.75,"fill-color-transition":{duration:500,delay:0}}},Ke)}function Ge(Ti,yi){if(console.log(Ti),!c.moveLayer)return;let hi=`hex-${Ti}-${yi}`;console.log(Ti),c.moveLayer(hi,"place_hamlet"),setTimeout(()=>{ni([hi])},dU/4),c.setPaintProperty(hi,"fill-opacity",1)}function ni(Ti=[]){if(!c.getStyle)return;let yi=c.getStyle().layers.filter(hi=>{var Ei;return((Ei=hi.source)==null?void 0:Ei.includes("hexlayer"))&&!Ti.includes(hi.id)});for(let hi of yi)c.setPaintProperty(hi.id,"fill-opacity",0)}function it(Ti){if(!c.getStyle)return;let yi=c.getStyle().layers.filter(hi=>hi.source===`hexlayer-${oe}`);for(let hi of yi){let Ei=hi.id.split("-")[1],Li=Nt(Ei,Ti,!0);console.log("palette:",Li),c.setPaintProperty(hi.id,"fill-color",Li)}}function xt(Ti){c.setPaintProperty&&(Ti?c.setPaintProperty("counties","line-opacity",1):c.setPaintProperty("counties","line-opacity",0))}function _t(Ti){c.setPaintProperty&&(console.log("ecoregions",Ti),Ti?(c.setPaintProperty("ecoregions-line","line-opacity",1),c.setPaintProperty("ecoregions-fill","fill-opacity",.75)):(c.setPaintProperty("ecoregions-line","line-opacity",0),c.setPaintProperty("ecoregions-fill","fill-opacity",0)))}function mt(Ti){Ti?(c.setPaintProperty("california-line","line-opacity",1),c.setPaintProperty("california-fill","fill-opacity",.75)):(c.setPaintProperty("california-line","line-opacity",0),c.setPaintProperty("california-fill","fill-opacity",0))}let bt,dt,nt,pt,at=d_(0,5e3,E);function Nt(Ti,yi,hi=!0){if(!(!nt||!pt))if(console.log("generating for ",Ti),hi){at=d_(pt[Ti],nt[Ti],yi),console.log(at),at.length;let Ei=at.map((Li,fn)=>[Li[0],Li[1]]);return Ei=Ei.flat(),console.log(Ei),["interpolate",["linear"],["get",Ti],...Ei]}else return["step",["get",Ti],"#ccc",0,"#fc4e2a",600,"#00E676",1300,"#2a4e9b"]}let{update:Ft}=t;async function Dt(Ti,yi){var hi;if(console.log(Ti),!(c&&((hi=c==null?void 0:c.getStyle())!=null&&hi.sources[`hexlayer-${Ti}`])))return fetch(`/phast/${Ti}_hex.json`).then(Ei=>Ei.json()).then(Ei=>dt=Ei).then(()=>{var _n,gi;nt=(_n=dt.properties)==null?void 0:_n.maxes,pt=(gi=dt.properties)==null?void 0:gi.mins;let Li=c.getStyle().layers[71].id;c.getSource(`hexlayer-${Ti}`)||c.addSource(`hexlayer-${Ti}`,{type:"geojson",data:dt});for(let mn of p_){let ti=`hex-${mn}-${Ti}`;c.addLayer({id:ti,type:"fill",source:`hexlayer-${Ti}`,layout:{},paint:{"fill-color":Nt(mn,E,!0),"fill-opacity":.75,"fill-color-transition":{duration:500,delay:0}}},Li),console.log("added layer ",ti)}let fn=`hex-${p_[0]}-${Ti}`;return c.on("click",fn,mn=>{console.log(mn);let ti=EV(mn.lngLat.lat,mn.lngLat.lng,yi);if(rn(ti),ti===(a==null?void 0:a.hex)){Ft(null);return}console.log(c.getStyle().layers);let Mn=Ew(ti);ut={lng:Mn[1],lat:Mn[0]},console.log(ti),Ft({latlng:mn.lngLat,hex:ti,properties:mn.features[0].properties})}),c.on("mouseenter",fn,()=>{c.getCanvas().style.cursor="pointer"}),c.on("mouseleave",fn,()=>{c.getCanvas().style.cursor=""}),c.on("dragstart",fn,()=>{c.getCanvas().style.cursor="grabbing"}),c.on("dragend",fn,()=>{c.getCanvas().style.cursor="pointer"}),!0})}async function ci(){fetch("/phast/data/ecoregions.geojson").then(Ti=>Ti.json()).then(Ti=>{console.log(Ti),c.addSource("ecoregions",{type:"geojson",data:Ti,generateId:!0}),c.addLayer({id:"ecoregions-fill",type:"fill",source:"ecoregions",layout:{},paint:{"fill-opacity":0,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"ecoregions-line",type:"line",source:"ecoregions",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":0}}),console.log("added ecoregions")})}async function bi(){R0&&fetch("/phast/data/california.geojson").then(Ti=>Ti.json()).then(Ti=>{console.log(Ti),c.addSource("california",{type:"geojson",data:Ti,generateId:!0}),c.addLayer({id:"california-fill",type:"fill",source:"california",layout:{},paint:{"fill-opacity":.75,"fill-color":["case",["boolean",["feature-state","hover"],!1],"#29abe2","#e9f6fb"],"fill-color-transition":{duration:500,delay:0}}}),c.addLayer({id:"california-line",type:"line",source:"california",layout:{},paint:{"line-color":"#555555","line-width":.25,"line-opacity":1}})})}function ki(Ti){if(!Ti)return;console.log("started building");let yi=Date.now();Dt("Birds",Jw).then(()=>{we(),Ge(b,oe),console.log(`finished building in ${Date.now()-yi}ms`)}),_t(!1),mt(!1)}Zc(()=>{sm(R0,c=new ew.Map({container:"map",style:`https://basemaps.cartocdn.com/gl/${sn}-gl-style/style.json`,center:g,zoom:4}),c),c.on("load",()=>{ci(),bi(),console.log("loaded"),Gi()}),setTimeout(()=>{console.log("no load on timeout"),sm(R0,c._canvas.style.filter="none",c),Gi()},3e3)});async function Gi(){let Ti=et;bt=window.innerWidth/3,c.fitBounds(Ti,{padding:{top:50,left:10,bottom:50,right:bt}}),sm(R0,c._canvas.style.filter="none",c)}function rn(Ti){st||$i();let yi=Ew(Ti);console.log(yi),bt=2*window.innerWidth/5,qi([yi[1],yi[0]]),c.flyTo({center:[yi[1],yi[0]],essential:!0,padding:{right:bt},duration:750})}function $i(){let Ti=document.getElementById("marker-template");st=new ew.Marker({element:Ti}).setLngLat(ut).addTo(c)}function qi(Ti){st.setLngLat(Ti)}let sn="positron";return e.$$set=Ti=>{"metric"in Ti&&n(0,b=Ti.metric),"colorScheme"in Ti&&n(1,E=Ti.colorScheme),"selectionData"in Ti&&n(2,a=Ti.selectionData),"showCounties"in Ti&&n(3,U=Ti.showCounties),"showEcoregions"in Ti&&n(4,W=Ti.showEcoregions),"drawnPath"in Ti&&n(5,ce=Ti.drawnPath),"clade"in Ti&&n(6,oe=Ti.clade),"clades"in Ti&&n(7,fe=Ti.clades),"finishBuilding"in Ti&&n(8,we=Ti.finishBuilding),"built"in Ti&&n(9,kt=Ti.built),"update"in Ti&&n(12,Ft=Ti.update)},e.$$.update=()=>{e.$$.dirty[0]&24576&&c&&pU&&(n(13,lt=c.getStyle().layers.filter(Ti=>Ti["source-layer"]==="place")),console.log(lt)),e.$$.dirty[0]&65&&Ge(b,oe),e.$$.dirty[0]&2&&it(E),e.$$.dirty[0]&8&&xt(U),e.$$.dirty[0]&16&&_t(W),e.$$.dirty[0]&32&&Rt(ce),e.$$.dirty[0]&64&&Bt(oe),e.$$.dirty[0]&512&&ki(kt)},[b,E,a,U,W,ce,oe,fe,we,kt,_t,mt,Ft,lt,c]}let gU=class extends Lo{constructor(t){super(),Bo(this,t,mU,fU,co,{metric:0,colorScheme:1,selectionData:2,showCounties:3,showEcoregions:4,drawnPath:5,clade:6,clades:7,finishBuilding:8,built:9,updateShowEcoregions:10,updateShowCalifornia:11,update:12},null,[-1,-1])}get updateShowEcoregions(){return this.$$.ctx[10]}get updateShowCalifornia(){return this.$$.ctx[11]}};function e3(e){let t,n,c,g,b;return n=new eT({props:{updateColorScheme:e[12],updateShowCounties:e[13],updateShowEcoregions:e[14],updateDrawing:e[15],drawing:e[5],updateDrawnPath:e[16]}}),g=new AT({props:{colorScheme:e[2],metric:e[1]}}),{c(){t=qn("div"),Is(n.$$.fragment),c=Or(),Is(g.$$.fragment),this.h()},l(E){t=Hn(E,"DIV",{class:!0});var a=Tn(t);$s(n.$$.fragment,a),c=Nr(a),$s(g.$$.fragment,a),a.forEach(Ci),this.h()},h(){Fi(t,"class","control-container svelte-1q0na86")},m(E,a){Zn(E,t,a),Es(n,t,null),Qi(t,c),Es(g,t,null),b=!0},p(E,a){const U={};a&32&&(U.drawing=E[5]),n.$set(U);const W={};a&4&&(W.colorScheme=E[2]),a&2&&(W.metric=E[1]),g.$set(W)},i(E){b||(Ki(n.$$.fragment,E),Ki(g.$$.fragment,E),b=!0)},o(E){gn(n.$$.fragment,E),gn(g.$$.fragment,E),b=!1},d(E){E&&Ci(t),Cs(n),Cs(g)}}}function t3(e){let t,n;return t=new oT({props:{updatePath:e[16],updateIsDrawing:e[15],isDrawing:e[5]}}),{c(){Is(t.$$.fragment)},l(c){$s(t.$$.fragment,c)},m(c,g){Es(t,c,g),n=!0},p(c,g){const b={};g&32&&(b.isDrawing=c[5]),t.$set(b)},i(c){n||(Ki(t.$$.fragment,c),n=!0)},o(c){gn(t.$$.fragment,c),n=!1},d(c){Cs(t,c)}}}function _U(e){let t,n,c,g,b,E,a,U;n=new gU({props:{built:e[8],finishBuilding:e[20],update:e[10],metric:e[1],colorScheme:e[2],selectionData:e[0],showCounties:e[3],showEcoregions:e[4],drawnPath:e[6],clade:e[7],clades:e[18]}}),g=new uO({props:{isBuilt:e[8],isFinishedBuilding:e[9],updateMetricLayer:e[11],build:e[19],showEcoregions:e[14],colorScheme:e[2],selectionData:e[0],metric:e[1],updateData:e[10],clade:e[7],clades:e[18],updateClade:e[17]}});let W=e[8]&&e3(e),ce=e[5]&&t3(e);return{c(){t=qn("main"),Is(n.$$.fragment),c=Or(),Is(g.$$.fragment),b=Or(),W&&W.c(),E=Or(),ce&&ce.c(),a=gs(),this.h()},l(oe){t=Hn(oe,"MAIN",{class:!0});var fe=Tn(t);$s(n.$$.fragment,fe),c=Nr(fe),$s(g.$$.fragment,fe),fe.forEach(Ci),b=Nr(oe),W&&W.l(oe),E=Nr(oe),ce&&ce.l(oe),a=gs(),this.h()},h(){Fi(t,"class","svelte-1q0na86")},m(oe,fe){Zn(oe,t,fe),Es(n,t,null),Qi(t,c),Es(g,t,null),Zn(oe,b,fe),W&&W.m(oe,fe),Zn(oe,E,fe),ce&&ce.m(oe,fe),Zn(oe,a,fe),U=!0},p(oe,[fe]){const we={};fe&256&&(we.built=oe[8]),fe&2&&(we.metric=oe[1]),fe&4&&(we.colorScheme=oe[2]),fe&1&&(we.selectionData=oe[0]),fe&8&&(we.showCounties=oe[3]),fe&16&&(we.showEcoregions=oe[4]),fe&64&&(we.drawnPath=oe[6]),fe&128&&(we.clade=oe[7]),n.$set(we);const et={};fe&256&&(et.isBuilt=oe[8]),fe&512&&(et.isFinishedBuilding=oe[9]),fe&4&&(et.colorScheme=oe[2]),fe&1&&(et.selectionData=oe[0]),fe&2&&(et.metric=oe[1]),fe&128&&(et.clade=oe[7]),g.$set(et),oe[8]?W?(W.p(oe,fe),fe&256&&Ki(W,1)):(W=e3(oe),W.c(),Ki(W,1),W.m(E.parentNode,E)):W&&(fl(),gn(W,1,1,()=>{W=null}),dl()),oe[5]?ce?(ce.p(oe,fe),fe&32&&Ki(ce,1)):(ce=t3(oe),ce.c(),Ki(ce,1),ce.m(a.parentNode,a)):ce&&(fl(),gn(ce,1,1,()=>{ce=null}),dl())},i(oe){U||(Ki(n.$$.fragment,oe),Ki(g.$$.fragment,oe),Ki(W),Ki(ce),U=!0)},o(oe){gn(n.$$.fragment,oe),gn(g.$$.fragment,oe),gn(W),gn(ce),U=!1},d(oe){oe&&(Ci(t),Ci(b),Ci(E),Ci(a)),Cs(n),Cs(g),W&&W.d(oe),ce&&ce.d(oe)}}}function yU(e,t,n){let c=null;function g(it){console.log("updating!!"),n(0,c=it)}let b="pd";function E(it){n(1,b=it)}let a="*ibm_flip";function U(it){n(2,a=it)}let W=!1;function ce(it){n(3,W=it)}let oe=!1;function fe(it){n(4,oe=it)}let we=!1;function et(it){n(5,we=it)}let lt=null;function Ke(it){n(6,lt=it)}let st="Birds";function ut(it){n(7,st=it)}const kt=["Birds","Plants"];let Bt=!1;function Rt(){n(8,Bt=!0)}let Ge=!1;function ni(){n(9,Ge=!0)}return[c,b,a,W,oe,we,lt,st,Bt,Ge,g,E,U,ce,fe,et,Ke,ut,kt,Rt,ni]}class CU extends Lo{constructor(t){super(),Bo(this,t,yU,_U,co,{})}}export{CU as component};
